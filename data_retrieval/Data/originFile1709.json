{"items":[{"tags":["java","integer","calculation"],"comments":[{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":2,"creation_date":1641407228,"post_id":70597820,"comment_id":124799280,"body_markdown":"Well then better ask the author. By my calculation, `1262 / 5000.0 = 0.2524`, i.e. 25.24%.","body":"Well then better ask the author. By my calculation, <code>1262 &#47; 5000.0 = 0.2524</code>, i.e. 25.24%."},{"owner":{"account_id":11675360,"reputation":158,"user_id":14076061,"display_name":"Ray Ronnaret"},"score":0,"creation_date":1641407463,"post_id":70597820,"comment_id":124799370,"body_markdown":"Need more input, how many level from 0 to 5000.","body":"Need more input, how many level from 0 to 5000."},{"owner":{"account_id":2127682,"reputation":236,"user_id":6903028,"display_name":"augur"},"score":0,"creation_date":1641407592,"post_id":70597820,"comment_id":124799421,"body_markdown":"Assuming that you start from 0 experience on each subsequent level, just divide `current_experience` / `total_experience_to_level_up`. The result fraction is percentage.","body":"Assuming that you start from 0 experience on each subsequent level, just divide <code>current_experience</code> / <code>total_experience_to_level_up</code>. The result fraction is percentage."},{"owner":{"account_id":3035523,"reputation":354,"user_id":2573717,"display_name":"Mauricio Guzinski"},"score":0,"creation_date":1641408140,"post_id":70597820,"comment_id":124799631,"body_markdown":"Please, review your question. It sounds confuse to me. First you write &quot;I want to calculate the remaining percentage&quot;, and then you write an exemple that seems current percentage, not remaining. Additionally your exemple does not match the calculation, as noticed by @Turing85","body":"Please, review your question. It sounds confuse to me. First you write &quot;I want to calculate the remaining percentage&quot;, and then you write an exemple that seems current percentage, not remaining. Additionally your exemple does not match the calculation, as noticed by @Turing85"},{"owner":{"account_id":238684,"reputation":22543,"user_id":507738,"accept_rate":71,"display_name":"MC Emperor"},"score":0,"creation_date":1641408307,"post_id":70597820,"comment_id":124799694,"body_markdown":"26,2% would be the correct percentage if the prevous level was reached at 1000 XP and the next one is at 2000 XP.","body":"26,2% would be the correct percentage if the prevous level was reached at 1000 XP and the next one is at 2000 XP."},{"owner":{"account_id":23386636,"reputation":15,"user_id":17451881,"display_name":"Ricardo"},"score":0,"creation_date":1641424801,"post_id":70597820,"comment_id":124804667,"body_markdown":"Sorry for the bad explanation, I will try to improve next time! \nThanks to all!","body":"Sorry for the bad explanation, I will try to improve next time!  Thanks to all!"}],"answers":[{"tags":[],"owner":{"account_id":18796965,"reputation":84,"user_id":13708200,"display_name":"Nick Kotte"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1641407617,"creation_date":1641407617,"answer_id":70597923,"question_id":70597820,"body_markdown":"    percentage_completed = current_exp / required_exp * 100\r\n\r\n    precentage_missing = (1 - current_exp / required_exp) * 100\r\n\r\n","title":"Calculate percent","body":"<pre><code>percentage_completed = current_exp / required_exp * 100\n\nprecentage_missing = (1 - current_exp / required_exp) * 100\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3763024,"reputation":349,"user_id":3127379,"display_name":"Jurrian Fahner"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1641408116,"creation_date":1641408116,"answer_id":70598021,"question_id":70597820,"body_markdown":"When performing calculations with [real numbers](https://en.wikipedia.org/wiki/Real_number), I would recommend to use double in case of Java. \r\n\r\nIf you need to be precise (for instance with money involved), I would handle the numbers after the decimal point myself. \r\n\r\nIn your case you could calculate it in the following way (remaining percentage):\r\n```java\r\ndouble percent = (level_two_experience - current_exp) / Double.valueOf(level_two_experience) * 100\r\n```\r\n\r\nIf you want to calculate the percentage it currently has achieved it could be calculated this way: \r\n```java\r\ndouble percent = current_exp / Double.valueOf(level_two_experience) * 100\r\n```\r\n","title":"Calculate percent","body":"<p>When performing calculations with <a href=\"https://en.wikipedia.org/wiki/Real_number\" rel=\"nofollow noreferrer\">real numbers</a>, I would recommend to use double in case of Java.</p>\n<p>If you need to be precise (for instance with money involved), I would handle the numbers after the decimal point myself.</p>\n<p>In your case you could calculate it in the following way (remaining percentage):</p>\n<pre class=\"lang-java prettyprint-override\"><code>double percent = (level_two_experience - current_exp) / Double.valueOf(level_two_experience) * 100\n</code></pre>\n<p>If you want to calculate the percentage it currently has achieved it could be calculated this way:</p>\n<pre class=\"lang-java prettyprint-override\"><code>double percent = current_exp / Double.valueOf(level_two_experience) * 100\n</code></pre>\n"}],"owner":{"account_id":23386636,"reputation":15,"user_id":17451881,"display_name":"Ricardo"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":116,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1641410786,"accepted_answer_id":70598021,"answer_count":2,"score":0,"last_activity_date":1641409686,"creation_date":1641407058,"question_id":70597820,"body_markdown":"I was wondering how to calculate the percentage in a level system, let me explain better:\r\nThe user has his experience and this represents the level where the user is, i.e. if he has 0 experience he is level 1 and he needs 2000 experience for level 2.\r\n\r\nThen I want to calculate the remaining percentage of how much is missing to reach 2000 experience.\r\n\r\nExample:\r\n\r\n    int current_exp = 500;\r\n    int required_exp = 1500; // The remaining difference between the current experience and the required experience for level 2.\r\n    int level_two_experience = 2000;\r\n    float percent = ...\r\n\r\n\r\n**I found an example on the internet where the user has 1,262 experience and needs 5000 for the next level so the percentage is 26.2%.**","title":"Calculate percent","body":"<p>I was wondering how to calculate the percentage in a level system, let me explain better:\nThe user has his experience and this represents the level where the user is, i.e. if he has 0 experience he is level 1 and he needs 2000 experience for level 2.</p>\n<p>Then I want to calculate the remaining percentage of how much is missing to reach 2000 experience.</p>\n<p>Example:</p>\n<pre><code>int current_exp = 500;\nint required_exp = 1500; // The remaining difference between the current experience and the required experience for level 2.\nint level_two_experience = 2000;\nfloat percent = ...\n</code></pre>\n<p><strong>I found an example on the internet where the user has 1,262 experience and needs 5000 for the next level so the percentage is 26.2%.</strong></p>\n"},{"tags":["java","spring","spring-boot","testing","mockmvc"],"answers":[{"tags":[],"owner":{"account_id":3618847,"reputation":867,"user_id":17695211,"display_name":"Alexey Veleshko"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1641409682,"creation_date":1641409682,"answer_id":70598353,"question_id":70597755,"body_markdown":"There is no `DATE_FORMAT` function in H2. H2 has [`FORMATDATETIME`](http://www.h2database.com/html/functions.html#formatdatetime) function, however I can&#39;t say if it works exactly the same. As you&#39;ve noticed, `DATE_FORMAT` isn&#39;t a standard JPA function either, so the JPA provider is not required to translate this name into database-specific dialects of SQL.\r\n\r\nI&#39;d recommend to restructure your code so that `InkUsageDto` stores the date itself. Move date formatting to Java in places where the `InkUsageDto` objects are used. This will save you from dealing with peculiarities of different database vendors. ","title":"Validation failed for query in tests but not in production","body":"<p>There is no <code>DATE_FORMAT</code> function in H2. H2 has <a href=\"http://www.h2database.com/html/functions.html#formatdatetime\" rel=\"nofollow noreferrer\"><code>FORMATDATETIME</code></a> function, however I can't say if it works exactly the same. As you've noticed, <code>DATE_FORMAT</code> isn't a standard JPA function either, so the JPA provider is not required to translate this name into database-specific dialects of SQL.</p>\n<p>I'd recommend to restructure your code so that <code>InkUsageDto</code> stores the date itself. Move date formatting to Java in places where the <code>InkUsageDto</code> objects are used. This will save you from dealing with peculiarities of different database vendors.</p>\n"}],"owner":{"account_id":13229986,"reputation":167,"user_id":9553927,"display_name":"S. Kostadinov"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":721,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":70598353,"answer_count":1,"score":0,"last_activity_date":1641409682,"creation_date":1641406765,"question_id":70597755,"body_markdown":"# Problem description #\r\nI have the following test class with a few tests. The `setUp()` method executes insert statements from a file. The first test simply makes a post request and expects an array of JSON objects in return with a 200(OK) status:\r\n```java\r\n@SpringBootTest\r\n@AutoConfigureMockMvc\r\n@ExtendWith(MockitoExtension.class)\r\n@TestInstance(TestInstance.Lifecycle.PER_CLASS)\r\nclass InkUsageControllerTest {\r\n    @Autowired\r\n    private MockMvc mockMvc;\r\n\r\n    SimpleDateFormat formatter = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;, Locale.ENGLISH);\r\n\r\n    @BeforeAll\r\n    public void setUp(@Autowired DataSource dataSource) throws Exception {\r\n        Connection conn = dataSource.getConnection();\r\n        ScriptUtils.executeSqlScript(conn, new ClassPathResource(&quot;sql/inkUsageTestData.sql&quot;));\r\n    }\r\n\r\n    @Test\r\n    @DisplayName(&quot;UNIT: POST /InkUsage?aggregated=true works.&quot;)\r\n    void getAllAggregated() throws Exception {\r\n        mockMvc.perform(post(&quot;/InkUsage?aggregated=true&quot;))\r\n                .andExpect(status().isOk())\r\n                .andExpect(content().json(&quot;[{&#39;Date&#39;:&#39;2021/Dec/01&#39;,&#39;Cyan&#39;:5.5,&#39;Magenta&#39;:9.5,&#39;Yellow&#39;:9.0,&#39;Black&#39;:12.0},{&#39;Date&#39;:&#39;2021/Dec/02&#39;,&#39;Cyan&#39;:11.5,&#39;Magenta&#39;:4.0,&#39;Yellow&#39;:14.5,&#39;Black&#39;:7.0},{&#39;Date&#39;:&#39;2021/Dec/03&#39;,&#39;Cyan&#39;:11.0,&#39;Magenta&#39;:8.0,&#39;Yellow&#39;:2.0,&#39;Black&#39;:2.5}]&quot;))\r\n                .andReturn();\r\n    }\r\n\r\n    ...\r\n}\r\n```\r\nUpon running the first test I get the following error:\r\n```\r\nFailed to load ApplicationContext\r\njava.lang.IllegalStateException: Failed to load ApplicationContext\r\n\tat org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:132)\r\n\tat org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:124)\r\n\tat org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:190)\r\n\tat org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:132)\r\n\tat org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:248)\r\n\tat org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:138)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$6(ClassBasedTestDescriptor.java:350)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:355)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$7(ClassBasedTestDescriptor.java:350)\r\n\tat java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)\r\n\tat java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:177)\r\n\tat java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1655)\r\n\tat java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)\r\n\tat java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)\r\n\tat java.base/java.util.stream.StreamSpliterators$WrappingSpliterator.forEachRemaining(StreamSpliterators.java:312)\r\n\tat java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:735)\r\n\tat java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:658)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:349)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$4(ClassBasedTestDescriptor.java:270)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:269)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$2(ClassBasedTestDescriptor.java:259)\r\n\tat java.base/java.util.Optional.orElseGet(Optional.java:369)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$3(ClassBasedTestDescriptor.java:258)\r\n\tat org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$before$0(ClassBasedTestDescriptor.java:184)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.before(ClassBasedTestDescriptor.java:183)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.before(ClassBasedTestDescriptor.java:78)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:136)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)\r\n\tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)\r\n\tat java.base/java.util.ArrayList.forEach(ArrayList.java:1541)\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)\r\n\tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)\r\n\tat org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)\r\n\tat org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:99)\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:79)\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:75)\r\n\tat org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:61)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n\tat org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n\tat org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n\tat com.sun.proxy.$Proxy2.stop(Unknown Source)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:193)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n\tat org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n\tat org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n\tat org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n\tat worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n\tat worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;inkUsageController&#39; defined in file [/media/stoyank/Elements/University/Semester 3/group-project-cannon/API/build/classes/java/main/api/coloradodashboard/controller/InkUsageController.class]: Unsatisfied dependency expressed through constructor parameter 1; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;inkUsageRepository&#39; defined in api.coloradodashboard.repository.InkUsageRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Invocation of init method failed; nested exception is org.springframework.data.repository.query.QueryCreationException: Could not create query for public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)! Reason: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!; nested exception is java.lang.IllegalArgumentException: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!\r\n\tat app//org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800)\r\n\tat app//org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229)\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372)\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222)\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582)\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)\r\n\tat app//org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\r\n\tat app//org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\r\n\tat app//org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\r\n\tat app//org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)\r\n\tat app//org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:944)\r\n\tat app//org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)\r\n\tat app//org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583)\r\n\tat app//org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)\r\n\tat app//org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:434)\r\n\tat app//org.springframework.boot.SpringApplication.run(SpringApplication.java:338)\r\n\tat app//org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:123)\r\n\tat app//org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:99)\r\n\tat app//org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)\r\n\t... 78 more\r\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;inkUsageRepository&#39; defined in api.coloradodashboard.repository.InkUsageRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Invocation of init method failed; nested exception is org.springframework.data.repository.query.QueryCreationException: Could not create query for public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)! Reason: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!; nested exception is java.lang.IllegalArgumentException: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1804)\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:620)\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)\r\n\tat app//org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\r\n\tat app//org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\r\n\tat app//org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\r\n\tat app//org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)\r\n\tat app//org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276)\r\n\tat app//org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1380)\r\n\tat app//org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1300)\r\n\tat app//org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887)\r\n\tat app//org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791)\r\n\t... 96 more\r\nCaused by: org.springframework.data.repository.query.QueryCreationException: Could not create query for public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)! Reason: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!; nested exception is java.lang.IllegalArgumentException: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!\r\n\tat app//org.springframework.data.repository.query.QueryCreationException.create(QueryCreationException.java:101)\r\n\tat app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lookupQuery(QueryExecutorMethodInterceptor.java:106)\r\n\tat app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lambda$mapMethodsToQuery$1(QueryExecutorMethodInterceptor.java:94)\r\n\tat java.base@11.0.13/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)\r\n\tat java.base@11.0.13/java.util.Iterator.forEachRemaining(Iterator.java:133)\r\n\tat java.base@11.0.13/java.util.Collections$UnmodifiableCollection$1.forEachRemaining(Collections.java:1054)\r\n\tat java.base@11.0.13/java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)\r\n\tat java.base@11.0.13/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)\r\n\tat java.base@11.0.13/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)\r\n\tat java.base@11.0.13/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:913)\r\n\tat java.base@11.0.13/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\r\n\tat java.base@11.0.13/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:578)\r\n\tat app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.mapMethodsToQuery(QueryExecutorMethodInterceptor.java:96)\r\n\tat app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lambda$new$0(QueryExecutorMethodInterceptor.java:86)\r\n\tat java.base@11.0.13/java.util.Optional.map(Optional.java:265)\r\n\tat app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.&lt;init&gt;(QueryExecutorMethodInterceptor.java:86)\r\n\tat app//org.springframework.data.repository.core.support.RepositoryFactorySupport.getRepository(RepositoryFactorySupport.java:360)\r\n\tat app//org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.lambda$afterPropertiesSet$5(RepositoryFactoryBeanSupport.java:323)\r\n\tat app//org.springframework.data.util.Lazy.getNullable(Lazy.java:230)\r\n\tat app//org.springframework.data.util.Lazy.get(Lazy.java:114)\r\n\tat app//org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.afterPropertiesSet(RepositoryFactoryBeanSupport.java:329)\r\n\tat app//org.springframework.data.jpa.repository.support.JpaRepositoryFactoryBean.afterPropertiesSet(JpaRepositoryFactoryBean.java:144)\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1863)\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1800)\r\n\t... 107 more\r\nCaused by: java.lang.IllegalArgumentException: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!\r\n\tat org.springframework.data.jpa.repository.query.SimpleJpaQuery.validateQuery(SimpleJpaQuery.java:93)\r\n\tat org.springframework.data.jpa.repository.query.SimpleJpaQuery.&lt;init&gt;(SimpleJpaQuery.java:63)\r\n\tat org.springframework.data.jpa.repository.query.JpaQueryFactory.fromMethodWithQueryString(JpaQueryFactory.java:76)\r\n\tat org.springframework.data.jpa.repository.query.JpaQueryFactory.fromQueryAnnotation(JpaQueryFactory.java:56)\r\n\tat org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$DeclaredQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:146)\r\n\tat org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$CreateIfNotFoundQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:216)\r\n\tat org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$AbstractQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:81)\r\n\tat org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lookupQuery(QueryExecutorMethodInterceptor.java:102)\r\n\t... 129 more\r\nCaused by: java.lang.NullPointerException\r\n\tat org.hibernate.hql.internal.NameGenerator.generateColumnNames(NameGenerator.java:27)\r\n\tat org.hibernate.hql.internal.ast.util.SessionFactoryHelper.generateColumnNames(SessionFactoryHelper.java:434)\r\n\tat org.hibernate.hql.internal.ast.tree.SelectClause.initializeColumnNames(SelectClause.java:268)\r\n\tat org.hibernate.hql.internal.ast.tree.SelectClause.finishInitialization(SelectClause.java:258)\r\n\tat org.hibernate.hql.internal.ast.tree.SelectClause.initializeExplicitSelectClause(SelectClause.java:253)\r\n\tat org.hibernate.hql.internal.ast.HqlSqlWalker.useSelectClause(HqlSqlWalker.java:1028)\r\n\tat org.hibernate.hql.internal.ast.HqlSqlWalker.processQuery(HqlSqlWalker.java:796)\r\n\tat org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.query(HqlSqlBaseWalker.java:694)\r\n\tat org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.selectStatement(HqlSqlBaseWalker.java:330)\r\n\tat org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.statement(HqlSqlBaseWalker.java:278)\r\n\tat org.hibernate.hql.internal.ast.QueryTranslatorImpl.analyze(QueryTranslatorImpl.java:276)\r\n\tat org.hibernate.hql.internal.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:192)\r\n\tat org.hibernate.hql.internal.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:144)\r\n\tat org.hibernate.engine.query.spi.HQLQueryPlan.&lt;init&gt;(HQLQueryPlan.java:113)\r\n\tat org.hibernate.engine.query.spi.HQLQueryPlan.&lt;init&gt;(HQLQueryPlan.java:73)\r\n\tat org.hibernate.engine.query.spi.QueryPlanCache.getHQLQueryPlan(QueryPlanCache.java:162)\r\n\tat org.hibernate.internal.AbstractSharedSessionContract.getQueryPlan(AbstractSharedSessionContract.java:613)\r\n\tat org.hibernate.internal.AbstractSharedSessionContract.createQuery(AbstractSharedSessionContract.java:725)\r\n\tat org.hibernate.internal.AbstractSharedSessionContract.createQuery(AbstractSharedSessionContract.java:114)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:362)\r\n\tat com.sun.proxy.$Proxy96.createQuery(Unknown Source)\r\n\tat org.springframework.data.jpa.repository.query.SimpleJpaQuery.validateQuery(SimpleJpaQuery.java:87)\r\n\t... 136 more\r\n\r\n\r\nInkUsageControllerTest &gt; initializationError FAILED\r\n    java.lang.IllegalStateException at DefaultCacheAwareContextLoaderDelegate.java:132\r\n        Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException at ConstructorResolver.java:800\r\n            Caused by: org.springframework.beans.factory.BeanCreationException at AbstractAutowireCapableBeanFactory.java:1804\r\n                Caused by: org.springframework.data.repository.query.QueryCreationException at QueryCreationException.java:101\r\n                    Caused by: java.lang.IllegalArgumentException at SimpleJpaQuery.java:93\r\n                        Caused by: java.lang.NullPointerException at NameGenerator.java:27\r\n```\r\n# What I Tried #\r\nSpring obviously does not like the query - `Validation failed for query for method public..`.\r\n\r\nMany other users have stumpled upon the same error and often the accepted solution would be to mark the query in the repository as a native query: `@Query(value=&quot;&quot;, native=true)`. Below is how the query that fails looks like. It is a mix of JPQL(because of the `new api.coloradodashboard...`) and SQL(because of the `DATE_FORMAT` function).\r\n```\r\n@Query(&quot;SELECT new api.coloradodashboard.dto.InkUsageDto(DATE_FORMAT(i.date, :dateFormat) AS formatted_date, sum(i.cyanLitresUsed), sum(i.magentaLitresUsed), sum(i.yellowLitresUsed), sum(i.blackLitresUsed)) &quot; +\r\n            &quot;FROM InkUsageEntity i &quot; +\r\n            &quot;WHERE i.printerId IN :printerIds &quot; +\r\n            &quot;GROUP BY formatted_date &quot; +\r\n            &quot;ORDER BY formatted_date ASC&quot;)\r\n    List&lt;InkUsageDto&gt; getAllForPrintersAggregated(String dateFormat,\r\n                                                  List&lt;String&gt; printerIds);\r\n```\r\n**The application runs perfectly when I start it and make a request to the same endpoint with Postman**. The above stated problem occurs only when running the test.\r\n\r\nI tried disabling hibernate validation by adding `spring.jpa.properties.javax.persistence.validation.mode=none` in the `application.properties`, but that does not help.\r\n# Question #\r\n**Is there any annotation or setting to disable the query validation that I am missing or is it simply not possible and the only solution is converting all queries to native ones?**\r\n\r\nI think it is important to mention that **the application runs with MySQL** and the tests are **run with H2**:\r\n```properties\r\nspring.datasource.url=jdbc:h2:mem:companyTestdb;DB_CLOSE_DELAY=-1\r\nspring.datasource.driverClassName=org.h2.Driver\r\nspring.datasource.username=sa\r\nspring.datasource.password=sa\r\nspring.jpa.hibernate.ddl-auto=create-drop\r\nspring.jpa.database-platform=org.hibernate.dialect.H2Dialect\r\nspring.jpa.properties.hibernate.format_sql=true\r\nspring.jpa.properties.hibernate.jdbc.time_zone=UTC\r\nspring.h2.console.enabled=true\r\nspring.jpa.properties.javax.persistence.validation.mode=none\r\n```","title":"Validation failed for query in tests but not in production","body":"<h1>Problem description</h1>\n<p>I have the following test class with a few tests. The <code>setUp()</code> method executes insert statements from a file. The first test simply makes a post request and expects an array of JSON objects in return with a 200(OK) status:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@SpringBootTest\n@AutoConfigureMockMvc\n@ExtendWith(MockitoExtension.class)\n@TestInstance(TestInstance.Lifecycle.PER_CLASS)\nclass InkUsageControllerTest {\n    @Autowired\n    private MockMvc mockMvc;\n\n    SimpleDateFormat formatter = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;, Locale.ENGLISH);\n\n    @BeforeAll\n    public void setUp(@Autowired DataSource dataSource) throws Exception {\n        Connection conn = dataSource.getConnection();\n        ScriptUtils.executeSqlScript(conn, new ClassPathResource(&quot;sql/inkUsageTestData.sql&quot;));\n    }\n\n    @Test\n    @DisplayName(&quot;UNIT: POST /InkUsage?aggregated=true works.&quot;)\n    void getAllAggregated() throws Exception {\n        mockMvc.perform(post(&quot;/InkUsage?aggregated=true&quot;))\n                .andExpect(status().isOk())\n                .andExpect(content().json(&quot;[{'Date':'2021/Dec/01','Cyan':5.5,'Magenta':9.5,'Yellow':9.0,'Black':12.0},{'Date':'2021/Dec/02','Cyan':11.5,'Magenta':4.0,'Yellow':14.5,'Black':7.0},{'Date':'2021/Dec/03','Cyan':11.0,'Magenta':8.0,'Yellow':2.0,'Black':2.5}]&quot;))\n                .andReturn();\n    }\n\n    ...\n}\n</code></pre>\n<p>Upon running the first test I get the following error:</p>\n<pre><code>Failed to load ApplicationContext\njava.lang.IllegalStateException: Failed to load ApplicationContext\n    at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:132)\n    at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:124)\n    at org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:190)\n    at org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:132)\n    at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:248)\n    at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:138)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$6(ClassBasedTestDescriptor.java:350)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:355)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$7(ClassBasedTestDescriptor.java:350)\n    at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)\n    at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:177)\n    at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1655)\n    at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)\n    at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)\n    at java.base/java.util.stream.StreamSpliterators$WrappingSpliterator.forEachRemaining(StreamSpliterators.java:312)\n    at java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:735)\n    at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:658)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:349)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$4(ClassBasedTestDescriptor.java:270)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:269)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$2(ClassBasedTestDescriptor.java:259)\n    at java.base/java.util.Optional.orElseGet(Optional.java:369)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$3(ClassBasedTestDescriptor.java:258)\n    at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$before$0(ClassBasedTestDescriptor.java:184)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.before(ClassBasedTestDescriptor.java:183)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.before(ClassBasedTestDescriptor.java:78)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:136)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)\n    at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)\n    at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:99)\n    at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:79)\n    at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:75)\n    at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:61)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:566)\n    at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\n    at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\n    at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\n    at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\n    at com.sun.proxy.$Proxy2.stop(Unknown Source)\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:193)\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\n    at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\n    at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\n    at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\n    at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\n    at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'inkUsageController' defined in file [/media/stoyank/Elements/University/Semester 3/group-project-cannon/API/build/classes/java/main/api/coloradodashboard/controller/InkUsageController.class]: Unsatisfied dependency expressed through constructor parameter 1; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'inkUsageRepository' defined in api.coloradodashboard.repository.InkUsageRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Invocation of init method failed; nested exception is org.springframework.data.repository.query.QueryCreationException: Could not create query for public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)! Reason: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!; nested exception is java.lang.IllegalArgumentException: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!\n    at app//org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800)\n    at app//org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\n    at app//org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)\n    at app//org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:944)\n    at app//org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)\n    at app//org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583)\n    at app//org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)\n    at app//org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:434)\n    at app//org.springframework.boot.SpringApplication.run(SpringApplication.java:338)\n    at app//org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:123)\n    at app//org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:99)\n    at app//org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)\n    ... 78 more\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'inkUsageRepository' defined in api.coloradodashboard.repository.InkUsageRepository defined in @EnableJpaRepositories declared on JpaRepositoriesRegistrar.EnableJpaRepositoriesConfiguration: Invocation of init method failed; nested exception is org.springframework.data.repository.query.QueryCreationException: Could not create query for public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)! Reason: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!; nested exception is java.lang.IllegalArgumentException: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1804)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:620)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\n    at app//org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)\n    at app//org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276)\n    at app//org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1380)\n    at app//org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1300)\n    at app//org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887)\n    at app//org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791)\n    ... 96 more\nCaused by: org.springframework.data.repository.query.QueryCreationException: Could not create query for public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)! Reason: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!; nested exception is java.lang.IllegalArgumentException: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!\n    at app//org.springframework.data.repository.query.QueryCreationException.create(QueryCreationException.java:101)\n    at app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lookupQuery(QueryExecutorMethodInterceptor.java:106)\n    at app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lambda$mapMethodsToQuery$1(QueryExecutorMethodInterceptor.java:94)\n    at java.base@11.0.13/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)\n    at java.base@11.0.13/java.util.Iterator.forEachRemaining(Iterator.java:133)\n    at java.base@11.0.13/java.util.Collections$UnmodifiableCollection$1.forEachRemaining(Collections.java:1054)\n    at java.base@11.0.13/java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)\n    at java.base@11.0.13/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)\n    at java.base@11.0.13/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)\n    at java.base@11.0.13/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:913)\n    at java.base@11.0.13/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\n    at java.base@11.0.13/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:578)\n    at app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.mapMethodsToQuery(QueryExecutorMethodInterceptor.java:96)\n    at app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lambda$new$0(QueryExecutorMethodInterceptor.java:86)\n    at java.base@11.0.13/java.util.Optional.map(Optional.java:265)\n    at app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.&lt;init&gt;(QueryExecutorMethodInterceptor.java:86)\n    at app//org.springframework.data.repository.core.support.RepositoryFactorySupport.getRepository(RepositoryFactorySupport.java:360)\n    at app//org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.lambda$afterPropertiesSet$5(RepositoryFactoryBeanSupport.java:323)\n    at app//org.springframework.data.util.Lazy.getNullable(Lazy.java:230)\n    at app//org.springframework.data.util.Lazy.get(Lazy.java:114)\n    at app//org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.afterPropertiesSet(RepositoryFactoryBeanSupport.java:329)\n    at app//org.springframework.data.jpa.repository.support.JpaRepositoryFactoryBean.afterPropertiesSet(JpaRepositoryFactoryBean.java:144)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1863)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1800)\n    ... 107 more\nCaused by: java.lang.IllegalArgumentException: Validation failed for query for method public abstract java.util.List api.coloradodashboard.repository.InkUsageRepository.getAllForPrintersAggregated(java.lang.String,java.util.List)!\n    at org.springframework.data.jpa.repository.query.SimpleJpaQuery.validateQuery(SimpleJpaQuery.java:93)\n    at org.springframework.data.jpa.repository.query.SimpleJpaQuery.&lt;init&gt;(SimpleJpaQuery.java:63)\n    at org.springframework.data.jpa.repository.query.JpaQueryFactory.fromMethodWithQueryString(JpaQueryFactory.java:76)\n    at org.springframework.data.jpa.repository.query.JpaQueryFactory.fromQueryAnnotation(JpaQueryFactory.java:56)\n    at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$DeclaredQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:146)\n    at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$CreateIfNotFoundQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:216)\n    at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$AbstractQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:81)\n    at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lookupQuery(QueryExecutorMethodInterceptor.java:102)\n    ... 129 more\nCaused by: java.lang.NullPointerException\n    at org.hibernate.hql.internal.NameGenerator.generateColumnNames(NameGenerator.java:27)\n    at org.hibernate.hql.internal.ast.util.SessionFactoryHelper.generateColumnNames(SessionFactoryHelper.java:434)\n    at org.hibernate.hql.internal.ast.tree.SelectClause.initializeColumnNames(SelectClause.java:268)\n    at org.hibernate.hql.internal.ast.tree.SelectClause.finishInitialization(SelectClause.java:258)\n    at org.hibernate.hql.internal.ast.tree.SelectClause.initializeExplicitSelectClause(SelectClause.java:253)\n    at org.hibernate.hql.internal.ast.HqlSqlWalker.useSelectClause(HqlSqlWalker.java:1028)\n    at org.hibernate.hql.internal.ast.HqlSqlWalker.processQuery(HqlSqlWalker.java:796)\n    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.query(HqlSqlBaseWalker.java:694)\n    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.selectStatement(HqlSqlBaseWalker.java:330)\n    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.statement(HqlSqlBaseWalker.java:278)\n    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.analyze(QueryTranslatorImpl.java:276)\n    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:192)\n    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:144)\n    at org.hibernate.engine.query.spi.HQLQueryPlan.&lt;init&gt;(HQLQueryPlan.java:113)\n    at org.hibernate.engine.query.spi.HQLQueryPlan.&lt;init&gt;(HQLQueryPlan.java:73)\n    at org.hibernate.engine.query.spi.QueryPlanCache.getHQLQueryPlan(QueryPlanCache.java:162)\n    at org.hibernate.internal.AbstractSharedSessionContract.getQueryPlan(AbstractSharedSessionContract.java:613)\n    at org.hibernate.internal.AbstractSharedSessionContract.createQuery(AbstractSharedSessionContract.java:725)\n    at org.hibernate.internal.AbstractSharedSessionContract.createQuery(AbstractSharedSessionContract.java:114)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:566)\n    at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:362)\n    at com.sun.proxy.$Proxy96.createQuery(Unknown Source)\n    at org.springframework.data.jpa.repository.query.SimpleJpaQuery.validateQuery(SimpleJpaQuery.java:87)\n    ... 136 more\n\n\nInkUsageControllerTest &gt; initializationError FAILED\n    java.lang.IllegalStateException at DefaultCacheAwareContextLoaderDelegate.java:132\n        Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException at ConstructorResolver.java:800\n            Caused by: org.springframework.beans.factory.BeanCreationException at AbstractAutowireCapableBeanFactory.java:1804\n                Caused by: org.springframework.data.repository.query.QueryCreationException at QueryCreationException.java:101\n                    Caused by: java.lang.IllegalArgumentException at SimpleJpaQuery.java:93\n                        Caused by: java.lang.NullPointerException at NameGenerator.java:27\n</code></pre>\n<h1>What I Tried</h1>\n<p>Spring obviously does not like the query - <code>Validation failed for query for method public..</code>.</p>\n<p>Many other users have stumpled upon the same error and often the accepted solution would be to mark the query in the repository as a native query: <code>@Query(value=&quot;&quot;, native=true)</code>. Below is how the query that fails looks like. It is a mix of JPQL(because of the <code>new api.coloradodashboard...</code>) and SQL(because of the <code>DATE_FORMAT</code> function).</p>\n<pre><code>@Query(&quot;SELECT new api.coloradodashboard.dto.InkUsageDto(DATE_FORMAT(i.date, :dateFormat) AS formatted_date, sum(i.cyanLitresUsed), sum(i.magentaLitresUsed), sum(i.yellowLitresUsed), sum(i.blackLitresUsed)) &quot; +\n            &quot;FROM InkUsageEntity i &quot; +\n            &quot;WHERE i.printerId IN :printerIds &quot; +\n            &quot;GROUP BY formatted_date &quot; +\n            &quot;ORDER BY formatted_date ASC&quot;)\n    List&lt;InkUsageDto&gt; getAllForPrintersAggregated(String dateFormat,\n                                                  List&lt;String&gt; printerIds);\n</code></pre>\n<p><strong>The application runs perfectly when I start it and make a request to the same endpoint with Postman</strong>. The above stated problem occurs only when running the test.</p>\n<p>I tried disabling hibernate validation by adding <code>spring.jpa.properties.javax.persistence.validation.mode=none</code> in the <code>application.properties</code>, but that does not help.</p>\n<h1>Question</h1>\n<p><strong>Is there any annotation or setting to disable the query validation that I am missing or is it simply not possible and the only solution is converting all queries to native ones?</strong></p>\n<p>I think it is important to mention that <strong>the application runs with MySQL</strong> and the tests are <strong>run with H2</strong>:</p>\n<pre><code>spring.datasource.url=jdbc:h2:mem:companyTestdb;DB_CLOSE_DELAY=-1\nspring.datasource.driverClassName=org.h2.Driver\nspring.datasource.username=sa\nspring.datasource.password=sa\nspring.jpa.hibernate.ddl-auto=create-drop\nspring.jpa.database-platform=org.hibernate.dialect.H2Dialect\nspring.jpa.properties.hibernate.format_sql=true\nspring.jpa.properties.hibernate.jdbc.time_zone=UTC\nspring.h2.console.enabled=true\nspring.jpa.properties.javax.persistence.validation.mode=none\n</code></pre>\n"},{"tags":["java","android"],"answers":[{"tags":[],"owner":{"account_id":1790714,"reputation":91128,"user_id":1631193,"accept_rate":71,"display_name":"Gabe Sechan"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1641409468,"creation_date":1641409468,"answer_id":70598301,"question_id":70598267,"body_markdown":"You can&#39;t.  That&#39;s part of the samsung keyboard.  The keyboard itself gets to decide whether to show it or not.  At best you can try to find an input type that gives it a hint to do so, but that may screw up other keyboards, and may not work on other versions of they keyboard. ","title":"Hide black bar under Samsung keyboard when user types on EditText","body":"<p>You can't.  That's part of the samsung keyboard.  The keyboard itself gets to decide whether to show it or not.  At best you can try to find an input type that gives it a hint to do so, but that may screw up other keyboards, and may not work on other versions of they keyboard.</p>\n"}],"owner":{"account_id":19206689,"reputation":150,"user_id":14033398,"display_name":"Estevanbs"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":74,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":70598301,"answer_count":1,"score":0,"last_activity_date":1641409468,"creation_date":1641409301,"question_id":70598267,"body_markdown":"How to hide the keyboard black bar on Samsung smartphones when user types in edit text on android. I tried it with `android:inputType=&quot;textNoSuggestions|textVisiblePassword&quot;`, but it only hides the suggestions.\r\n\r\n[This black bar.][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/xVgxd.jpg","title":"Hide black bar under Samsung keyboard when user types on EditText","body":"<p>How to hide the keyboard black bar on Samsung smartphones when user types in edit text on android. I tried it with <code>android:inputType=&quot;textNoSuggestions|textVisiblePassword&quot;</code>, but it only hides the suggestions.</p>\n<p><a href=\"https://i.stack.imgur.com/xVgxd.jpg\" rel=\"nofollow noreferrer\">This black bar.</a></p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":384206,"reputation":50386,"user_id":740553,"accept_rate":46,"display_name":"Mike &#39;Pomax&#39; Kamermans"},"score":5,"creation_date":1641409038,"post_id":70598186,"comment_id":124799977,"body_markdown":"Note that that documentation link literally explains this: &quot;_Local variables are slightly different; the compiler never assigns a default value to an uninitialized local variable. If you cannot initialize your local variable where it is declared, make sure to assign it a value before you attempt to use it. Accessing an uninitialized local variable will result in a compile-time error_&quot;.","body":"Note that that documentation link literally explains this: &quot;<i>Local variables are slightly different; the compiler never assigns a default value to an uninitialized local variable. If you cannot initialize your local variable where it is declared, make sure to assign it a value before you attempt to use it. Accessing an uninitialized local variable will result in a compile-time error</i>&quot;."},{"owner":{"account_id":23519216,"reputation":65,"user_id":17836321,"display_name":"Philipp Crosman"},"score":0,"creation_date":1641409262,"post_id":70598186,"comment_id":124800050,"body_markdown":"Thanks @Mike&#39;Pomax&#39;Kamermans","body":"Thanks @Mike&#39;Pomax&#39;Kamermans"}],"owner":{"account_id":23519216,"reputation":65,"user_id":17836321,"display_name":"Philipp Crosman"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":29,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1641408983,"answer_count":0,"score":0,"last_activity_date":1641408845,"creation_date":1641408845,"question_id":70598186,"body_markdown":"The Java Tutorial website writes: &quot;It&#39;s not always necessary to assign a value when a field is declared. Fields that are declared but not initialized will be set to a reasonable default by the compiler. Generally speaking, this default will be zero or null, depending on the data type. Relying on such default values, however, is generally considered bad programming style.&quot;\r\n\r\nBut if I write something like \r\n```\r\nint i;\r\nSystem.out.println(i);\r\n```\r\nI get a compile-time exception: *variable i might not have been initialized*\r\n\r\nSo what does it mean for a data type like *int* to have a default value if it doesn&#39;t mean an automatic assignment of the variable to the default value (0)?\r\n\r\n&lt;https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html&gt;","title":"Why is it not possible to use a declared but uninitialized variable in Java?","body":"<p>The Java Tutorial website writes: &quot;It's not always necessary to assign a value when a field is declared. Fields that are declared but not initialized will be set to a reasonable default by the compiler. Generally speaking, this default will be zero or null, depending on the data type. Relying on such default values, however, is generally considered bad programming style.&quot;</p>\n<p>But if I write something like</p>\n<pre><code>int i;\nSystem.out.println(i);\n</code></pre>\n<p>I get a compile-time exception: <em>variable i might not have been initialized</em></p>\n<p>So what does it mean for a data type like <em>int</em> to have a default value if it doesn't mean an automatic assignment of the variable to the default value (0)?</p>\n<p><a href=\"https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html</a></p>\n"},{"tags":["java","eclipse","gson"],"comments":[{"owner":{"account_id":2485939,"reputation":19426,"user_id":2164365,"accept_rate":40,"display_name":"Abra"},"score":0,"creation_date":1641408901,"post_id":70598120,"comment_id":124799922,"body_markdown":"It appears that GSON JAR file is not included in the classpath in the run configuration in Eclipse. Or are you using Maven or Gradle to run your code?","body":"It appears that GSON JAR file is not included in the classpath in the run configuration in Eclipse. Or are you using Maven or Gradle to run your code?"},{"owner":{"account_id":22704835,"reputation":1,"user_id":17843763,"display_name":"UnInformaticoAburrido"},"score":0,"creation_date":1641411429,"post_id":70598120,"comment_id":124800782,"body_markdown":"how could i do it","body":"how could i do it"},{"owner":{"account_id":2485939,"reputation":19426,"user_id":2164365,"accept_rate":40,"display_name":"Abra"},"score":0,"creation_date":1641413287,"post_id":70598120,"comment_id":124801416,"body_markdown":"Search for **eclipse run configuration**.","body":"Search for <b>eclipse run configuration</b>."}],"owner":{"account_id":22704835,"reputation":1,"user_id":17843763,"display_name":"UnInformaticoAburrido"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":418,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1641408617,"creation_date":1641408617,"question_id":70598120,"body_markdown":"I don&#39;t know if someone can help me but it turns out that I have a problem with the following code:\r\n```\r\nimport com.google.gson.*;\r\nimport java.io.BufferedReader;\r\nimport java.io.FileNotFoundException;\r\nimport java.io.FileReader;\r\nimport java.io.IOException;\r\nimport java.util.logging.Level;\r\nimport java.util.logging.Logger;\r\npublic class Juego {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\tString json = &quot;&quot;;\r\n\t\ttry {\r\n\t\t\tBufferedReader br = new BufferedReader(new FileReader(&quot;ejemplo.json&quot;));\r\n\t\t\tString linea =&quot;&quot;;\r\n\t\t\twhile ( (linea = br.readLine()) != null) {\r\n\t\t\t\tjson += linea;\r\n\t\t\t}\r\n\t\tbr.close();\r\n\t\t//\r\n\t\t} catch (FileNotFoundException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t} catch (IOException e) {\r\n\t\t\tLogger.getLogger(Juego.class.getName()).log(Level.SEVERE, null, e);\r\n\t\t}\r\n\tSystem.out.println(json);\r\n\tGson gson = new Gson();\r\n\tLector p = gson.fromJson(json, Lector.class);\r\n\tSystem.out.println(p);\r\n\t}\r\n}\r\n```\r\nBut when compiling I get the following errors:\r\n```\r\nException in thread &quot;main&quot; java.lang.NoClassDefFoundError: com/google/gson/Gson\r\n\tat Juego.main(Juego.java:28)\r\nCaused by: java.lang.ClassNotFoundException: com.google.gson.Gson\r\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)\r\n\tat java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\r\n\tat java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:520)\r\n\t... 1 more\r\n```\r\nI don&#39;t know how to fix it\r\n\r\nI have already tried many things, including inserting the library in various ways (directly, as a user library), changing the location of the .jar in case the compiler did not have access to the directory where it was but I cannot find any solution","title":"java.lang.NoClassDefFoundError:com/google/gson/Gson","body":"<p>I don't know if someone can help me but it turns out that I have a problem with the following code:</p>\n<pre><code>import com.google.gson.*;\nimport java.io.BufferedReader;\nimport java.io.FileNotFoundException;\nimport java.io.FileReader;\nimport java.io.IOException;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\npublic class Juego {\n\n    public static void main(String[] args) {\n        String json = &quot;&quot;;\n        try {\n            BufferedReader br = new BufferedReader(new FileReader(&quot;ejemplo.json&quot;));\n            String linea =&quot;&quot;;\n            while ( (linea = br.readLine()) != null) {\n                json += linea;\n            }\n        br.close();\n        //\n        } catch (FileNotFoundException e) {\n            e.printStackTrace();\n        } catch (IOException e) {\n            Logger.getLogger(Juego.class.getName()).log(Level.SEVERE, null, e);\n        }\n    System.out.println(json);\n    Gson gson = new Gson();\n    Lector p = gson.fromJson(json, Lector.class);\n    System.out.println(p);\n    }\n}\n</code></pre>\n<p>But when compiling I get the following errors:</p>\n<pre><code>Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: com/google/gson/Gson\n    at Juego.main(Juego.java:28)\nCaused by: java.lang.ClassNotFoundException: com.google.gson.Gson\n    at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)\n    at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\n    at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:520)\n    ... 1 more\n</code></pre>\n<p>I don't know how to fix it</p>\n<p>I have already tried many things, including inserting the library in various ways (directly, as a user library), changing the location of the .jar in case the compiler did not have access to the directory where it was but I cannot find any solution</p>\n"},{"tags":["java","sql","spring-boot","hibernate","jpa"],"comments":[{"owner":{"account_id":4668137,"reputation":6228,"user_id":9681755,"display_name":"Dirk Deyne"},"score":0,"creation_date":1641407709,"post_id":70597708,"comment_id":124799462,"body_markdown":"see documentation [howto.data-initialization](https://docs.spring.io/spring-boot/docs/current/reference/html/howto.html#howto.data-initialization)","body":"see documentation <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/howto.html#howto.data-initialization\" rel=\"nofollow noreferrer\">howto.data-initialization</a>"}],"answers":[{"tags":[],"owner":{"account_id":13229986,"reputation":167,"user_id":9553927,"display_name":"S. Kostadinov"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641408330,"creation_date":1641408330,"answer_id":70598073,"question_id":70597708,"body_markdown":"Yes, you can.\r\n\r\nFirst, you need to create a class from your object and pass it the `@Entity` annotation like so:\r\n```java\r\n@Entity\r\npublic class DemoEntity {\r\n    @Id\r\n    private Long id;\r\n    private String demoStringProperty;\r\n    private Double demoDoubleProperty;\r\n}\r\n```\r\nThen let hibernate know that it should create the entity from the class by adding this to the `application.properties` file:\r\n```\r\n... database url, username, pass ...\r\nspring.jpa.hibernate.ddl-auto=update\r\n```\r\n`create-drop` insead of `update` would accomplish the same thing in your case but there is a difference which you can read more in the [community documentation][1].\r\n\r\n\r\n  [1]: https://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html#configurations-hbmddl","title":"Is there a way to create a database with the entity first aproach in spring boot?","body":"<p>Yes, you can.</p>\n<p>First, you need to create a class from your object and pass it the <code>@Entity</code> annotation like so:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Entity\npublic class DemoEntity {\n    @Id\n    private Long id;\n    private String demoStringProperty;\n    private Double demoDoubleProperty;\n}\n</code></pre>\n<p>Then let hibernate know that it should create the entity from the class by adding this to the <code>application.properties</code> file:</p>\n<pre><code>... database url, username, pass ...\nspring.jpa.hibernate.ddl-auto=update\n</code></pre>\n<p><code>create-drop</code> insead of <code>update</code> would accomplish the same thing in your case but there is a difference which you can read more in the <a href=\"https://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html#configurations-hbmddl\" rel=\"nofollow noreferrer\">community documentation</a>.</p>\n"}],"owner":{"account_id":15950651,"reputation":59,"user_id":11510084,"display_name":"manta"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":151,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":1,"score":0,"last_activity_date":1641408330,"creation_date":1641406514,"question_id":70597708,"body_markdown":"I want to create the tables of a Microsoft SQL DB from objects, in Spring Boot. Is there a way to do that? If it is, can someone tell me at least the steps on how i should do that?","title":"Is there a way to create a database with the entity first aproach in spring boot?","body":"<p>I want to create the tables of a Microsoft SQL DB from objects, in Spring Boot. Is there a way to do that? If it is, can someone tell me at least the steps on how i should do that?</p>\n"},{"tags":["java","hibernate","spring-boot","spring-boot-jpa"],"comments":[{"owner":{"account_id":26485,"reputation":58926,"user_id":68939,"display_name":"ax."},"score":1,"creation_date":1641330843,"post_id":61102607,"comment_id":124776740,"body_markdown":"A suggestion from experience: don&#39;t bother with Hibernate for performant inserts and auto-ids, but use something more low level like [JdbcTemplate](https://docs.spring.io/spring-framework/docs/current/reference/html/data-access.html#jdbc-advanced-jdbc) or [jOOQ](https://www.jooq.org/doc/latest/manual/sql-execution/importing/). You will save yourself many wasted hours.","body":"A suggestion from experience: don&#39;t bother with Hibernate for performant inserts and auto-ids, but use something more low level like <a href=\"https://docs.spring.io/spring-framework/docs/current/reference/html/data-access.html#jdbc-advanced-jdbc\" rel=\"nofollow noreferrer\">JdbcTemplate</a> or <a href=\"https://www.jooq.org/doc/latest/manual/sql-execution/importing/\" rel=\"nofollow noreferrer\">jOOQ</a>. You will save yourself many wasted hours."},{"owner":{"account_id":2740481,"reputation":539,"user_id":2362206,"display_name":"Noman ali abbasi"},"score":0,"creation_date":1641370996,"post_id":61102607,"comment_id":124784543,"body_markdown":"Did you try the following properties in your hibernate.cfg.xml file:\n\nhibernate.jdbc.batch_size=5\nhibernate.order_inserts=true\n\nOther trick that you could apply, define a batch size app.properties and iterate your collection if it reaches to the batch size flush hibernate session.","body":"Did you try the following properties in your hibernate.cfg.xml file:  hibernate.jdbc.batch_size=5 hibernate.order_inserts=true  Other trick that you could apply, define a batch size app.properties and iterate your collection if it reaches to the batch size flush hibernate session."},{"owner":{"account_id":3618847,"reputation":867,"user_id":17695211,"display_name":"Alexey Veleshko"},"score":0,"creation_date":1641402926,"post_id":61102607,"comment_id":124797603,"body_markdown":"It batches with the latest MariaDB. I&#39;ll test with MySQL shortly.","body":"It batches with the latest MariaDB. I&#39;ll test with MySQL shortly."}],"answers":[{"tags":[],"owner":{"account_id":468677,"reputation":7486,"user_id":874814,"display_name":"Babl"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1641395211,"creation_date":1641373144,"answer_id":70590134,"question_id":61102607,"body_markdown":"Basically, seem hibernate will not help with ```@ElementCollection```  batching but you can use the SQL [bulk inserts][1].\r\nSeems you are on MySQL which does support the bulk inserts and its JDBC driver can automatically modify / rewrite the individual insert statements into one bulk statement if you enable the  ```rewriteBatchedStatements``` property.\r\n\r\nSo in your case what you need to do is tell hibernate to enable batching and order the batch inserts and updates.\r\n\r\n    hibernate.jdbc.batch_size=100\r\n    hibernate.order_inserts=true\r\n    hibernate.order_updates=true\r\nThis will ensure that when inserting the data into DB the inserts statements generated by Hibernate will be executed in a batch and they will be ordered.\r\n\r\nSo the SQL generated by Hibernate will be something like this:\r\n\r\n    insert into student_languages (student_id, languages) values (1,1)\r\n    insert into student_languages (student_id, languages) values (1,2)\r\n    insert into student_languages (student_id, languages) values (1,3)\r\n    insert into student_languages (student_id, languages) values (1,4)\r\n\r\nNext, you will need to tell the JDBC driver to rewrite the individual inserts into the bulk insert by setting the ```rewriteBatchedStatements=true```\r\n\r\n    jdbc:mysql://db:3306/stack?useSSL=false&amp;rewriteBatchedStatements=true\r\n\r\nSo this will instruct the driver to rewrite the inserts into bulk form, so the above several SQL statements will be rewritten into something like this\r\n\r\n    insert into student_languages (student_id, languages) values (1,1),(1,2),(1,3),(1,4)\r\n\r\n\r\nJust as an info this may not work if you are using old versions of the MySQL driver and Hibernate.\r\n\r\n\r\n  [1]: https://en.wikipedia.org/wiki/Insert_(SQL)#Multirow_inserts","title":"Why doesn&#39;t Hibernate batch inserts of fields annotated with @ElementCollection?","body":"<p>Basically, seem hibernate will not help with <code>@ElementCollection</code>  batching but you can use the SQL <a href=\"https://en.wikipedia.org/wiki/Insert_(SQL)#Multirow_inserts\" rel=\"nofollow noreferrer\">bulk inserts</a>.\nSeems you are on MySQL which does support the bulk inserts and its JDBC driver can automatically modify / rewrite the individual insert statements into one bulk statement if you enable the  <code>rewriteBatchedStatements</code> property.</p>\n<p>So in your case what you need to do is tell hibernate to enable batching and order the batch inserts and updates.</p>\n<pre><code>hibernate.jdbc.batch_size=100\nhibernate.order_inserts=true\nhibernate.order_updates=true\n</code></pre>\n<p>This will ensure that when inserting the data into DB the inserts statements generated by Hibernate will be executed in a batch and they will be ordered.</p>\n<p>So the SQL generated by Hibernate will be something like this:</p>\n<pre><code>insert into student_languages (student_id, languages) values (1,1)\ninsert into student_languages (student_id, languages) values (1,2)\ninsert into student_languages (student_id, languages) values (1,3)\ninsert into student_languages (student_id, languages) values (1,4)\n</code></pre>\n<p>Next, you will need to tell the JDBC driver to rewrite the individual inserts into the bulk insert by setting the <code>rewriteBatchedStatements=true</code></p>\n<pre><code>jdbc:mysql://db:3306/stack?useSSL=false&amp;rewriteBatchedStatements=true\n</code></pre>\n<p>So this will instruct the driver to rewrite the inserts into bulk form, so the above several SQL statements will be rewritten into something like this</p>\n<pre><code>insert into student_languages (student_id, languages) values (1,1),(1,2),(1,3),(1,4)\n</code></pre>\n<p>Just as an info this may not work if you are using old versions of the MySQL driver and Hibernate.</p>\n"},{"tags":[],"owner":{"account_id":3618847,"reputation":867,"user_id":17695211,"display_name":"Alexey Veleshko"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641408237,"creation_date":1641406413,"answer_id":70597688,"question_id":61102607,"body_markdown":"I tested this both with MySQL and MariaDB and actually Hibernate does batch inserts into the collection table. But it&#39;s not visible to the naked eye, you have to use [DataSource-Proxy](https://vladmihalcea.com/log-sql-spring-boot/) to see it:\r\n\r\n    INFO  com.example.jpa.AddStudents - Adding students\r\n    DEBUG n.t.d.l.l.SLF4JQueryLoggingListener - \r\n    Name:dataSource, Connection:3, Time:1, Success:True\r\n    Type:Prepared, Batch:False, QuerySize:1, BatchSize:0\r\n    Query:[&quot;insert into student (name) values (?)&quot;]\r\n    Params:[(Smith)]\r\n    DEBUG n.t.d.l.l.SLF4JQueryLoggingListener - \r\n    Name:dataSource, Connection:3, Time:1, Success:True\r\n    Type:Prepared, Batch:False, QuerySize:1, BatchSize:0\r\n    Query:[&quot;insert into student (name) values (?)&quot;]\r\n    Params:[(Snow)]\r\n    DEBUG n.t.d.l.l.SLF4JQueryLoggingListener - \r\n    Name:dataSource, Connection:3, Time:78, Success:True\r\n    Type:Prepared, Batch:True, QuerySize:1, BatchSize:6\r\n    Query:[&quot;insert into student_languages (student_id, language) values (?, ?)&quot;]\r\n    Params:[(6,2),(6,0),(6,1),(7,0),(7,4),(7,3)]\r\n    INFO  com.example.jpa.AddStudents - Added\r\n\r\nThe `SEQUENCE` ID generator is [considered](https://vladmihalcea.com/why-you-should-never-use-the-table-identifier-generator-with-jpa-and-hibernate/) the best for Hibernate. It doesn&#39;t create lock contention as the `TABLE` generator does and allows for batching. It is unfortunate that MySQL doesn&#39;t support sequences still (MariaDB does).\r\n\r\n&gt; Am I doing something wrong?\r\n\r\nHibernate is optimized for small-scale changes in the database. It maintains a first-level cache and also supports a second-level cache which will only hinder performance for large-scale operations. Therefore, indeed, you might be better off using JDBC or jOOQ for this particular operation as was suggested in the comments.\r\n\r\n----------\r\n\r\nI used MySQL 8.0.3, MariaDB 10.5.13 and Hibernate 5.6.3.Final.\r\n","title":"Why doesn&#39;t Hibernate batch inserts of fields annotated with @ElementCollection?","body":"<p>I tested this both with MySQL and MariaDB and actually Hibernate does batch inserts into the collection table. But it's not visible to the naked eye, you have to use <a href=\"https://vladmihalcea.com/log-sql-spring-boot/\" rel=\"nofollow noreferrer\">DataSource-Proxy</a> to see it:</p>\n<pre><code>INFO  com.example.jpa.AddStudents - Adding students\nDEBUG n.t.d.l.l.SLF4JQueryLoggingListener - \nName:dataSource, Connection:3, Time:1, Success:True\nType:Prepared, Batch:False, QuerySize:1, BatchSize:0\nQuery:[&quot;insert into student (name) values (?)&quot;]\nParams:[(Smith)]\nDEBUG n.t.d.l.l.SLF4JQueryLoggingListener - \nName:dataSource, Connection:3, Time:1, Success:True\nType:Prepared, Batch:False, QuerySize:1, BatchSize:0\nQuery:[&quot;insert into student (name) values (?)&quot;]\nParams:[(Snow)]\nDEBUG n.t.d.l.l.SLF4JQueryLoggingListener - \nName:dataSource, Connection:3, Time:78, Success:True\nType:Prepared, Batch:True, QuerySize:1, BatchSize:6\nQuery:[&quot;insert into student_languages (student_id, language) values (?, ?)&quot;]\nParams:[(6,2),(6,0),(6,1),(7,0),(7,4),(7,3)]\nINFO  com.example.jpa.AddStudents - Added\n</code></pre>\n<p>The <code>SEQUENCE</code> ID generator is <a href=\"https://vladmihalcea.com/why-you-should-never-use-the-table-identifier-generator-with-jpa-and-hibernate/\" rel=\"nofollow noreferrer\">considered</a> the best for Hibernate. It doesn't create lock contention as the <code>TABLE</code> generator does and allows for batching. It is unfortunate that MySQL doesn't support sequences still (MariaDB does).</p>\n<blockquote>\n<p>Am I doing something wrong?</p>\n</blockquote>\n<p>Hibernate is optimized for small-scale changes in the database. It maintains a first-level cache and also supports a second-level cache which will only hinder performance for large-scale operations. Therefore, indeed, you might be better off using JDBC or jOOQ for this particular operation as was suggested in the comments.</p>\n<hr />\n<p>I used MySQL 8.0.3, MariaDB 10.5.13 and Hibernate 5.6.3.Final.</p>\n"}],"owner":{"account_id":290535,"reputation":2402,"user_id":592138,"accept_rate":78,"display_name":"Michele Palmia"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1018,"favorite_count":0,"down_vote_count":0,"up_vote_count":6,"answer_count":2,"score":6,"last_activity_date":1641408237,"creation_date":1586354627,"question_id":61102607,"body_markdown":"I have an `@Entity` containing a few `@OneToMany` relationships, but since they consist of collections of `Enum`s, I&#39;m using `@ElementCollection`. The entity has an id that gets generated at the database level (MySQL).\r\n\r\nHere is a small example I just made up that corresponds to the structure of my entity.\r\n\r\n```java\r\n@Entity\r\npublic class Student {\r\n\r\n  @Id @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n  private Integer id;\r\n\r\n  @ElementCollection(targetClass = Language.class)\r\n  @CollectionTable(name=&quot;student_languages&quot;, joinColumns=@JoinColumn(name=&quot;student_id&quot;))\r\n  private Set&lt;Language&gt; languages;\r\n\r\n  @ElementCollection(targetClass = Module.class)\r\n  @CollectionTable(name=&quot;student_modules&quot;, joinColumns=@JoinColumn(name=&quot;student_id&quot;))\r\n  private Set&lt;Module&gt; modules;\r\n\r\n  @ElementCollection(targetClass = SeatPreference.class)\r\n  @CollectionTable(name=&quot;student_seats&quot;, joinColumns=@JoinColumn(name=&quot;student_id&quot;))\r\n  private Set&lt;SeatPreference&gt; seatPreference;\r\n\r\n[...]\r\n}\r\n```\r\n\r\nI know that `GenerationType.IDENTITY` deactivates batching, but I thought that would be the case **for the main entity only**, not for the single properties too. I&#39;m havin to bulk import a few entities (~20k), each with a handful of properties, but Hibernate seems to be generating one insert for each property in the sets, making the import impossibly slow (between 10 and 20 inserts for each record).\r\n\r\nI have now spent so long trying to make this faster, that I&#39;m considering just generating an SQL file that I can manually import in the database.\r\n\r\nIs there no way to instruct Hibernate to batch inserts the `@ElementCollection` fields? Am I doing something wrong?\r\n\r\n","title":"Why doesn&#39;t Hibernate batch inserts of fields annotated with @ElementCollection?","body":"<p>I have an <code>@Entity</code> containing a few <code>@OneToMany</code> relationships, but since they consist of collections of <code>Enum</code>s, I'm using <code>@ElementCollection</code>. The entity has an id that gets generated at the database level (MySQL).</p>\n\n<p>Here is a small example I just made up that corresponds to the structure of my entity.</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>@Entity\npublic class Student {\n\n  @Id @GeneratedValue(strategy = GenerationType.IDENTITY)\n  private Integer id;\n\n  @ElementCollection(targetClass = Language.class)\n  @CollectionTable(name=\"student_languages\", joinColumns=@JoinColumn(name=\"student_id\"))\n  private Set&lt;Language&gt; languages;\n\n  @ElementCollection(targetClass = Module.class)\n  @CollectionTable(name=\"student_modules\", joinColumns=@JoinColumn(name=\"student_id\"))\n  private Set&lt;Module&gt; modules;\n\n  @ElementCollection(targetClass = SeatPreference.class)\n  @CollectionTable(name=\"student_seats\", joinColumns=@JoinColumn(name=\"student_id\"))\n  private Set&lt;SeatPreference&gt; seatPreference;\n\n[...]\n}\n</code></pre>\n\n<p>I know that <code>GenerationType.IDENTITY</code> deactivates batching, but I thought that would be the case <strong>for the main entity only</strong>, not for the single properties too. I'm havin to bulk import a few entities (~20k), each with a handful of properties, but Hibernate seems to be generating one insert for each property in the sets, making the import impossibly slow (between 10 and 20 inserts for each record).</p>\n\n<p>I have now spent so long trying to make this faster, that I'm considering just generating an SQL file that I can manually import in the database.</p>\n\n<p>Is there no way to instruct Hibernate to batch inserts the <code>@ElementCollection</code> fields? Am I doing something wrong?</p>\n"},{"tags":["java","double","rounding"],"answers":[{"tags":[],"owner":{"account_id":7369804,"reputation":1147,"user_id":5610358,"display_name":"rhowell"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641393729,"creation_date":1641393729,"answer_id":70594783,"question_id":70594646,"body_markdown":"You can use the [DecimalFormat][1] class to format your doubles.\r\n```\r\nNumberFormat formatter = new DecimalFormat(&quot;#0.00&quot;);  \r\nSystem.out.println(formatter.format(10));\r\n&gt;10.00\r\n```\r\n\r\nThis will also round values if they exceed the amount of decimals you specified\r\n```\r\nNumberFormat formatter = new DecimalFormat(&quot;#0.00&quot;);  \r\nSystem.out.println(formatter.format(19.657));\r\n&gt;19.66\r\n```\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/7/docs/api/java/text/DecimalFormat.html","title":"Change double decimal spaces depending on int value","body":"<p>You can use the <a href=\"https://docs.oracle.com/javase/7/docs/api/java/text/DecimalFormat.html\" rel=\"nofollow noreferrer\">DecimalFormat</a> class to format your doubles.</p>\n<pre><code>NumberFormat formatter = new DecimalFormat(&quot;#0.00&quot;);  \nSystem.out.println(formatter.format(10));\n&gt;10.00\n</code></pre>\n<p>This will also round values if they exceed the amount of decimals you specified</p>\n<pre><code>NumberFormat formatter = new DecimalFormat(&quot;#0.00&quot;);  \nSystem.out.println(formatter.format(19.657));\n&gt;19.66\n</code></pre>\n"},{"tags":[],"owner":{"account_id":7881804,"reputation":51,"user_id":5955497,"display_name":"Jinadee Yasiruka"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641396035,"creation_date":1641396035,"answer_id":70595333,"question_id":70594646,"body_markdown":"You can use Decimal Formate to format double value\r\n\r\nExample:\r\n\r\n    private static final DecimalFormat df = new DecimalFormat(&quot;0.00&quot;);\r\n    \r\n    public static void main(String[] args) {\r\n    \r\n        double input = 3.14159265359;\r\n    \r\n        System.out.println(&quot;double : &quot; + input);\r\n        System.out.println(&quot;double : &quot; + df.format(input));    //3.14\r\n    \r\n        // DecimalFormat, default is RoundingMode.HALF_EVEN\r\n        df.setRoundingMode(RoundingMode.DOWN);\r\n        System.out.println(&quot;\\ndouble (RoundingMode.DOWN) : &quot; + df.format(input));  //3.14\r\n    \r\n        df.setRoundingMode(RoundingMode.UP);\r\n        System.out.println(&quot;double (RoundingMode.UP)  : &quot; + df.format(input));    //3.15\r\n    \r\n    }\r\n\r\nOutput :\r\n\r\n    double : 3.14159265359\r\n    double : 3.14\r\n    \r\n    double (RoundingMode.DOWN) : 3.14\r\n    double (RoundingMode.UP)  : 3.15","title":"Change double decimal spaces depending on int value","body":"<p>You can use Decimal Formate to format double value</p>\n<p>Example:</p>\n<pre><code>private static final DecimalFormat df = new DecimalFormat(&quot;0.00&quot;);\n\npublic static void main(String[] args) {\n\n    double input = 3.14159265359;\n\n    System.out.println(&quot;double : &quot; + input);\n    System.out.println(&quot;double : &quot; + df.format(input));    //3.14\n\n    // DecimalFormat, default is RoundingMode.HALF_EVEN\n    df.setRoundingMode(RoundingMode.DOWN);\n    System.out.println(&quot;\\ndouble (RoundingMode.DOWN) : &quot; + df.format(input));  //3.14\n\n    df.setRoundingMode(RoundingMode.UP);\n    System.out.println(&quot;double (RoundingMode.UP)  : &quot; + df.format(input));    //3.15\n\n}\n</code></pre>\n<p>Output :</p>\n<pre><code>double : 3.14159265359\ndouble : 3.14\n\ndouble (RoundingMode.DOWN) : 3.14\ndouble (RoundingMode.UP)  : 3.15\n</code></pre>\n"},{"tags":[],"owner":{"account_id":22057425,"reputation":135,"user_id":16320675,"display_name":"user16320675"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641408216,"creation_date":1641407795,"answer_id":70597959,"question_id":70594646,"body_markdown":"Variable number of digits after decimal. Basically same idea as code in question, just using `Math` methods, calculating the multiplier as needed (`10` or `1000` in question):\r\n````java\r\npublic static double round(double value, int digits) {\r\n    if (digits &lt; 0) \r\n        throw new IllegalArgumentException(&quot;digits must be non-negative: &quot; + digits);\r\n\r\n    var mult = Math.pow(10, digits);\r\n    return Math.rint(value * mult) / mult;\r\n}\r\n````\r\n\r\nIf not allowed to use `Math` (standard lib, no `import` needed), we can calculate the multiplier in a loop and use an offset of `0.5` to round to the nearest integer (negative for negative numbers):\r\n````java\r\npublic static double round(double value, int digits) {\r\n    if (digits &lt; 0) \r\n        throw new IllegalArgumentException(&quot;digits must be non-negative: &quot; + digits);\r\n\r\n    var mult = 1.0;\r\n    for (var i = 0; i &lt; digits; i++) {\r\n        mult *= 10;\r\n    }\r\n   \r\n    var offset = value&gt;0 ? 0.5 : -0.5;\r\n    return (int) (value * mult + offset) / mult;\r\n}\r\n````\r\n\r\nBe warned that these methods will only work for small number of digits (intermediate results eventually exceeding the integer or even the double value range)  \r\n&lt;sub&gt;not tested - please test code before using&lt;/sub&gt;","title":"Change double decimal spaces depending on int value","body":"<p>Variable number of digits after decimal. Basically same idea as code in question, just using <code>Math</code> methods, calculating the multiplier as needed (<code>10</code> or <code>1000</code> in question):</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static double round(double value, int digits) {\n    if (digits &lt; 0) \n        throw new IllegalArgumentException(&quot;digits must be non-negative: &quot; + digits);\n\n    var mult = Math.pow(10, digits);\n    return Math.rint(value * mult) / mult;\n}\n</code></pre>\n<p>If not allowed to use <code>Math</code> (standard lib, no <code>import</code> needed), we can calculate the multiplier in a loop and use an offset of <code>0.5</code> to round to the nearest integer (negative for negative numbers):</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static double round(double value, int digits) {\n    if (digits &lt; 0) \n        throw new IllegalArgumentException(&quot;digits must be non-negative: &quot; + digits);\n\n    var mult = 1.0;\n    for (var i = 0; i &lt; digits; i++) {\n        mult *= 10;\n    }\n   \n    var offset = value&gt;0 ? 0.5 : -0.5;\n    return (int) (value * mult + offset) / mult;\n}\n</code></pre>\n<p>Be warned that these methods will only work for small number of digits (intermediate results eventually exceeding the integer or even the double value range)<br />\n<sub>not tested - please test code before using</sub></p>\n"}],"owner":{"account_id":23492502,"reputation":13,"user_id":17543363,"display_name":"user17543363"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":38,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":3,"score":1,"last_activity_date":1641408216,"creation_date":1641393163,"question_id":70594646,"body_markdown":"i want to change the decimal spaces of an double, depending on the int value that i use. I Figured out, that i can change the decimal spaces &quot;manually&quot; by changing to 10 or 1000 and so on, but i dont know how to accomplish this, other than changing said values in the code. \r\n\r\nMy second quest is  how to round double values for example 19.657 up to 19.66, or 19.652 down to 19.65 .\r\n\r\nNote :  \r\n- WITHOUT the use of imports and only the default package\r\n        \r\n- I use Java with Eclipse as my IDE\r\n\r\nThank you in advance for your effort  :) \r\n\r\n \r\n\r\n    \tdouble x = 19.657821456;\r\n        int y = 3;  \r\n \r\n    \t\tx = x*10; \r\n    \t\tx = (double)((int) x);\r\n    \t\tx = x /10;\r\n    \t\t\t\t \r\n    \t\t\t\r\n\r\n","title":"Change double decimal spaces depending on int value","body":"<p>i want to change the decimal spaces of an double, depending on the int value that i use. I Figured out, that i can change the decimal spaces &quot;manually&quot; by changing to 10 or 1000 and so on, but i dont know how to accomplish this, other than changing said values in the code.</p>\n<p>My second quest is  how to round double values for example 19.657 up to 19.66, or 19.652 down to 19.65 .</p>\n<p>Note :</p>\n<ul>\n<li><p>WITHOUT the use of imports and only the default package</p>\n</li>\n<li><p>I use Java with Eclipse as my IDE</p>\n</li>\n</ul>\n<p>Thank you in advance for your effort  :)</p>\n<pre><code>    double x = 19.657821456;\n    int y = 3;  \n\n        x = x*10; \n        x = (double)((int) x);\n        x = x /10;\n                 \n            \n</code></pre>\n"},{"tags":["java","selenium-webdriver"],"answers":[{"tags":[],"owner":{"account_id":460481,"reputation":5813,"user_id":861594,"display_name":"user861594"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641408111,"creation_date":1641408111,"answer_id":70598019,"question_id":70594536,"body_markdown":"In the statement\r\n\r\n    driver.findElement(By.linkText(&quot;//input[@name=&#39;q&#39;]&quot;)).click(); \r\nproblem is with your locator. You are using link text [locator strategy][1] with xpath value. It should be as below:\r\n\r\n    driver.findElement(By.xpath(&quot;//input[@name=&#39;q&#39;]&quot;)).click(); \r\nYou also can use `name` as locator strategy for this case as below:\r\n\r\n    driver.findElement(By.name(&quot;q&quot;)).click(); \r\n\r\n\r\n  [1]: https://www.selenium.dev/documentation/webdriver/elements/locators/#traditional-locators","title":"How to run google search script and getting error message script is in body","body":"<p>In the statement</p>\n<pre><code>driver.findElement(By.linkText(&quot;//input[@name='q']&quot;)).click(); \n</code></pre>\n<p>problem is with your locator. You are using link text <a href=\"https://www.selenium.dev/documentation/webdriver/elements/locators/#traditional-locators\" rel=\"nofollow noreferrer\">locator strategy</a> with xpath value. It should be as below:</p>\n<pre><code>driver.findElement(By.xpath(&quot;//input[@name='q']&quot;)).click(); \n</code></pre>\n<p>You also can use <code>name</code> as locator strategy for this case as below:</p>\n<pre><code>driver.findElement(By.name(&quot;q&quot;)).click(); \n</code></pre>\n"}],"owner":{"account_id":23776064,"reputation":1,"user_id":17789511,"display_name":"surendra yarlagadda"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":27,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641408111,"creation_date":1641392723,"question_id":70594536,"body_markdown":"```\r\n@Test\r\n\t\r\n\tpublic void googlesearch() {\r\n\t\r\n\tWebDriver driver=new ChromeDriver();\r\n\tdriver.get(&quot;https://www.google.co.in&quot;);\r\n\t driver.manage().window().maximize();\r\n\tdriver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);\r\n\tdriver.findElement(By.linkText(&quot;//input[@name=&#39;q&#39;]&quot;)).click(); \r\n```\r\nand this is code and error in console report Error occurred during initialization of boot layer\r\n&gt;java.lang.module.FindException: Unable to derive module descriptor for E:\\seleniumwebdriversoftwares\\org.testng.eclipse.updatesite\\plugins\\org.testng.source-6.14.2.r201802161450.jar\r\nCaused by: java.lang.module.InvalidModuleDescriptorException: Provider class org.testng.internal.YamlParser not in module........\r\n\r\n how to resolve the issue?","title":"How to run google search script and getting error message script is in body","body":"<pre><code>@Test\n    \n    public void googlesearch() {\n    \n    WebDriver driver=new ChromeDriver();\n    driver.get(&quot;https://www.google.co.in&quot;);\n     driver.manage().window().maximize();\n    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);\n    driver.findElement(By.linkText(&quot;//input[@name='q']&quot;)).click(); \n</code></pre>\n<p>and this is code and error in console report Error occurred during initialization of boot layer</p>\n<blockquote>\n<p>java.lang.module.FindException: Unable to derive module descriptor for E:\\seleniumwebdriversoftwares\\org.testng.eclipse.updatesite\\plugins\\org.testng.source-6.14.2.r201802161450.jar\nCaused by: java.lang.module.InvalidModuleDescriptorException: Provider class org.testng.internal.YamlParser not in module........</p>\n</blockquote>\n<p>how to resolve the issue?</p>\n"},{"tags":["java","mongodb","mongo-java-driver","mongo-java"],"answers":[{"tags":[],"owner":{"account_id":13210543,"reputation":13760,"user_id":9540925,"display_name":"D. SM"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1619482301,"creation_date":1619448201,"answer_id":67268759,"question_id":67266882,"body_markdown":"Your documents are 1 mb large, hence no more than 16 of them fit into a single command. The driver does split the full set of documents into batches automatically but you appear to be reading ids from one batch at a time, therefore the problem is likely one of the following:\r\n\r\n- There is a driver issue where it doesn&#39;t merge the batch results together prior to returning the results to your application\r\n- The driver is giving you the results one batch at a time, hence you do get all of the ids but not in the segments you were expecting (in which case there is no bug but you do need to work with batches as they are provided by the driver)\r\n\r\nThe following test in Ruby works as expected, producing 100 ids:\r\n\r\n```ruby\r\nc = Mongo::Client.new([&#39;localhost:14920&#39;])\r\n\r\ndocs = [{a: &#39;x&#39;*1_000_000}]*100\r\nres = c[&#39;foo&#39;].insert_many(docs)\r\n\r\np res.inserted_ids.length\r\npp res.inserted_ids\r\n```\r\n","title":"MongoDB 4.4, Java driver 4.2.3 - InsertManyResult.getInsertedIds() not returning IDs for all inserted documents","body":"<p>Your documents are 1 mb large, hence no more than 16 of them fit into a single command. The driver does split the full set of documents into batches automatically but you appear to be reading ids from one batch at a time, therefore the problem is likely one of the following:</p>\n<ul>\n<li>There is a driver issue where it doesn't merge the batch results together prior to returning the results to your application</li>\n<li>The driver is giving you the results one batch at a time, hence you do get all of the ids but not in the segments you were expecting (in which case there is no bug but you do need to work with batches as they are provided by the driver)</li>\n</ul>\n<p>The following test in Ruby works as expected, producing 100 ids:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>c = Mongo::Client.new(['localhost:14920'])\n\ndocs = [{a: 'x'*1_000_000}]*100\nres = c['foo'].insert_many(docs)\n\np res.inserted_ids.length\npp res.inserted_ids\n</code></pre>\n"},{"tags":[],"owner":{"account_id":962967,"reputation":3773,"user_id":986903,"display_name":"jyemin"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1641407538,"creation_date":1641402034,"answer_id":70596710,"question_id":67266882,"body_markdown":"This is a bug in the Java driver, and it&#39;s being tracked in https://jira.mongodb.org/browse/JAVA-4436 (reported on January 5, 2022).","title":"MongoDB 4.4, Java driver 4.2.3 - InsertManyResult.getInsertedIds() not returning IDs for all inserted documents","body":"<p>This is a bug in the Java driver, and it's being tracked in <a href=\"https://jira.mongodb.org/browse/JAVA-4436\" rel=\"nofollow noreferrer\">https://jira.mongodb.org/browse/JAVA-4436</a> (reported on January 5, 2022).</p>\n"}],"owner":{"account_id":21405376,"reputation":3,"user_id":15766693,"display_name":"Miroslav Vacek"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":540,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":70596710,"answer_count":2,"score":0,"last_activity_date":1641407538,"creation_date":1619441103,"question_id":67266882,"body_markdown":"I am trying to retrieve values of `_id` for inserted documents after successful `InsertMany` operation. To achieve this I am using `InsertManyResult.getInsertedIds()`. While this approach works most of the time there are cases where not all `_id` values are retrieved.&lt;br/&gt;\r\n&lt;br/&gt;\r\nI am not sure if I am doing something wrong but I would assume that `InsertManyResult.getInsertedIds()` returns `_id` for *all* the documents inserted.&lt;br/&gt;\r\n\r\n### Problem details ###\r\nI am inserting 1000 documents in MongoDB in two batches of 500 documents. Each document is approx 1 MB in size.&lt;br/&gt;\r\n&lt;br/&gt;\r\nAfter batch is inserted using `InsertMany` I attempt to read values of `_id` via `InsertManyResult.getInsertedIds()` and save it to a collection for later use.&lt;br/&gt;\r\n&lt;br/&gt;\r\nI would assume that after inserting _500_ documents via `InsertMany` the `InsertManyResult.getInsertedIds()` would return _500_ `_id` values. It is however returning only _16_ `_id` values out of _500_.&lt;br/&gt;\r\n&lt;br/&gt;\r\nWhen I check the Mongo collection directly via Mongo Shell I see that all records were successfully inserted. There is _1000_ documents in my test collection. I am just unable to get the `_id` of all the inserted document via `InsertManyResult.getInsertedIds()`. I only get _32_ `_id` for 1000 documents inserted.\r\n\r\n### JSON structure ###\r\nTo replicate the issue I have exactly **one** JSON which is approx 1 MB in size which looks like this.\r\n```\r\n{\r\n  &quot;textVal&quot; : &quot;RmKHtEMMzJDXgEApmWeoZGRdZJZerIj1&quot;,\r\n  &quot;intVal&quot; : 161390623,\r\n  &quot;longVal&quot; : &quot;98213019054010317&quot;,\r\n  &quot;timestampVal&quot; : &quot;2020-12-31 23:59:59.999&quot;,\r\n  &quot;numericVal&quot; : -401277306,\r\n  &quot;largeArrayVal&quot; : [ &quot;MMzJDXg&quot;, &quot;ApmWeoZGRdZJZerI&quot;, &quot;1LhTxQ&quot;, &quot;adprPSb1ZT&quot;, ..., &quot;QNLkBZuXenmYE77&quot;]\r\n\r\n}\r\n```\r\nNote that key `largeArrayVal` is holding almost all the data. I have omitted most of the values for readability.\r\n\r\n### Sample code ###\r\nThe code below parses JSON shown above into a `Document` which is then inserted to MongoDB via `InsertMany`. After that is done I try to get inserted `_id` using `InsertManyResult.getInsertedIds()`.\r\n\r\n```\r\nprivate static final int MAX_DOCUMENTS = 1000;\r\nprivate static final int BULK_SIZE = 500;\r\n\r\nprivate static List&lt;ObjectId&gt; insertBatchReturnIds(List&lt;Document&gt; insertBatch)\r\n{\r\n  List&lt;ObjectId&gt; insertedIds = new ArrayList&lt;ObjectId&gt;();\r\n  InsertManyResult insertManyResult;\r\n\r\n  insertManyResult = mongoClient.getDatabase(MONGO_DATABASE).getCollection(MONGO_COLLECTION).insertMany(insertBatch);\r\n  insertManyResult.getInsertedIds().forEach((k,v) -&gt; insertedIds.add(v.asObjectId().getValue()));\r\n\r\n  System.out.println(&quot;Batch inseted:&quot;);\r\n  System.out.println(&quot; - Was acknowladged: &quot; + Boolean.toString(insertManyResult.wasAcknowledged()).toUpperCase());\r\n  System.out.println(&quot; - InsertManyResult.getInsertedIds().size(): &quot; + insertManyResult.getInsertedIds().size());\r\n\r\n  return insertedIds;\r\n}\r\n\r\nprivate static void insertDocuments()\r\n{\r\n  int documentsInserted = 0;\r\n  List&lt;Document&gt; insertBatch = new ArrayList&lt;Document&gt;();\r\n  List&lt;ObjectId&gt; insertedIds = new ArrayList&lt;ObjectId&gt;();\r\n  final String largeJson = loadLargeJsonFromFile(&quot;d:\\\\test-sample.json&quot;);\r\n\r\n  System.out.println(&quot;Starting INSERT test...&quot;);\r\n  while (documentsInserted &lt; MAX_DOCUMENTS)\r\n  {\r\n    insertBatch.add(Document.parse(largeJson));\r\n    documentsInserted++;\r\n\r\n    if (documentsInserted % BULK_SIZE == 0)\r\n    {\r\n     insertedIds.addAll(insertBatchReturnIds(insertBatch));\r\n     insertBatch.clear();\r\n    }\r\n  }\r\n  if (insertBatch.size() &gt; 0)\r\n    insertedIds.addAll(insertBatchReturnIds(insertBatch));\r\n  System.out.println(&quot;INSERT test finished&quot;);\r\n\r\n  System.out.println(String.format(&quot;Expected IDs retrieved: %d. Actual IDs retrieved: %d.&quot;, MAX_DOCUMENTS, insertedIds.size()));\r\n  if (insertedIds.size() != MAX_DOCUMENTS)\r\n    throw new IllegalStateException(&quot;Not all _ID were returned for each document in batch&quot;);\r\n}\r\n\r\n```\r\n\r\nSample output\r\n--------------\r\n```\r\nStarting INSERT test...\r\nBatch inseted:\r\n - Was acknowladged: TRUE\r\n - InsertManyResult.getInsertedIds().size(): 16\r\nBatch inseted:\r\n - Was acknowladged: TRUE\r\n - InsertManyResult.getInsertedIds().size(): 16\r\nINSERT test finished\r\nExpected IDs retrieved: 1000. Actual IDs retrieved: 32.\r\nException in thread &quot;main&quot; java.lang.IllegalStateException: Not all _ID were returned for each document in batch\r\n```\r\n\r\n### My questions ###\r\n1. Is `InsertManyResult.getInsertedIds()` meant to return `_id` for *all* documents inserted?\r\n2. Is the way I am using `InsertManyResult.getInsertedIds()` correct?\r\n3. Could size of the inserted JSON be a factor here?\r\n4. How should I use `InsertManyResult` to get `_id` for inserted documents?\r\n\r\nNote\r\n-------\r\nI am aware that I can either read `_id` after `Document.parse` as it is the driver that generates this or I can select `_id` after documents were inserted.&lt;br/&gt;\r\nI would like to know how can this be achieved using `InsertManyResult.getInsertedIds()` as it seems to be made to fit this purpose.","title":"MongoDB 4.4, Java driver 4.2.3 - InsertManyResult.getInsertedIds() not returning IDs for all inserted documents","body":"<p>I am trying to retrieve values of <code>_id</code> for inserted documents after successful <code>InsertMany</code> operation. To achieve this I am using <code>InsertManyResult.getInsertedIds()</code>. While this approach works most of the time there are cases where not all <code>_id</code> values are retrieved.<br/>\n<br/>\nI am not sure if I am doing something wrong but I would assume that <code>InsertManyResult.getInsertedIds()</code> returns <code>_id</code> for <em>all</em> the documents inserted.<br/></p>\n<h3>Problem details</h3>\n<p>I am inserting 1000 documents in MongoDB in two batches of 500 documents. Each document is approx 1 MB in size.<br/>\n<br/>\nAfter batch is inserted using <code>InsertMany</code> I attempt to read values of <code>_id</code> via <code>InsertManyResult.getInsertedIds()</code> and save it to a collection for later use.<br/>\n<br/>\nI would assume that after inserting <em>500</em> documents via <code>InsertMany</code> the <code>InsertManyResult.getInsertedIds()</code> would return <em>500</em> <code>_id</code> values. It is however returning only <em>16</em> <code>_id</code> values out of <em>500</em>.<br/>\n<br/>\nWhen I check the Mongo collection directly via Mongo Shell I see that all records were successfully inserted. There is <em>1000</em> documents in my test collection. I am just unable to get the <code>_id</code> of all the inserted document via <code>InsertManyResult.getInsertedIds()</code>. I only get <em>32</em> <code>_id</code> for 1000 documents inserted.</p>\n<h3>JSON structure</h3>\n<p>To replicate the issue I have exactly <strong>one</strong> JSON which is approx 1 MB in size which looks like this.</p>\n<pre><code>{\n  &quot;textVal&quot; : &quot;RmKHtEMMzJDXgEApmWeoZGRdZJZerIj1&quot;,\n  &quot;intVal&quot; : 161390623,\n  &quot;longVal&quot; : &quot;98213019054010317&quot;,\n  &quot;timestampVal&quot; : &quot;2020-12-31 23:59:59.999&quot;,\n  &quot;numericVal&quot; : -401277306,\n  &quot;largeArrayVal&quot; : [ &quot;MMzJDXg&quot;, &quot;ApmWeoZGRdZJZerI&quot;, &quot;1LhTxQ&quot;, &quot;adprPSb1ZT&quot;, ..., &quot;QNLkBZuXenmYE77&quot;]\n\n}\n</code></pre>\n<p>Note that key <code>largeArrayVal</code> is holding almost all the data. I have omitted most of the values for readability.</p>\n<h3>Sample code</h3>\n<p>The code below parses JSON shown above into a <code>Document</code> which is then inserted to MongoDB via <code>InsertMany</code>. After that is done I try to get inserted <code>_id</code> using <code>InsertManyResult.getInsertedIds()</code>.</p>\n<pre><code>private static final int MAX_DOCUMENTS = 1000;\nprivate static final int BULK_SIZE = 500;\n\nprivate static List&lt;ObjectId&gt; insertBatchReturnIds(List&lt;Document&gt; insertBatch)\n{\n  List&lt;ObjectId&gt; insertedIds = new ArrayList&lt;ObjectId&gt;();\n  InsertManyResult insertManyResult;\n\n  insertManyResult = mongoClient.getDatabase(MONGO_DATABASE).getCollection(MONGO_COLLECTION).insertMany(insertBatch);\n  insertManyResult.getInsertedIds().forEach((k,v) -&gt; insertedIds.add(v.asObjectId().getValue()));\n\n  System.out.println(&quot;Batch inseted:&quot;);\n  System.out.println(&quot; - Was acknowladged: &quot; + Boolean.toString(insertManyResult.wasAcknowledged()).toUpperCase());\n  System.out.println(&quot; - InsertManyResult.getInsertedIds().size(): &quot; + insertManyResult.getInsertedIds().size());\n\n  return insertedIds;\n}\n\nprivate static void insertDocuments()\n{\n  int documentsInserted = 0;\n  List&lt;Document&gt; insertBatch = new ArrayList&lt;Document&gt;();\n  List&lt;ObjectId&gt; insertedIds = new ArrayList&lt;ObjectId&gt;();\n  final String largeJson = loadLargeJsonFromFile(&quot;d:\\\\test-sample.json&quot;);\n\n  System.out.println(&quot;Starting INSERT test...&quot;);\n  while (documentsInserted &lt; MAX_DOCUMENTS)\n  {\n    insertBatch.add(Document.parse(largeJson));\n    documentsInserted++;\n\n    if (documentsInserted % BULK_SIZE == 0)\n    {\n     insertedIds.addAll(insertBatchReturnIds(insertBatch));\n     insertBatch.clear();\n    }\n  }\n  if (insertBatch.size() &gt; 0)\n    insertedIds.addAll(insertBatchReturnIds(insertBatch));\n  System.out.println(&quot;INSERT test finished&quot;);\n\n  System.out.println(String.format(&quot;Expected IDs retrieved: %d. Actual IDs retrieved: %d.&quot;, MAX_DOCUMENTS, insertedIds.size()));\n  if (insertedIds.size() != MAX_DOCUMENTS)\n    throw new IllegalStateException(&quot;Not all _ID were returned for each document in batch&quot;);\n}\n\n</code></pre>\n<h2>Sample output</h2>\n<pre><code>Starting INSERT test...\nBatch inseted:\n - Was acknowladged: TRUE\n - InsertManyResult.getInsertedIds().size(): 16\nBatch inseted:\n - Was acknowladged: TRUE\n - InsertManyResult.getInsertedIds().size(): 16\nINSERT test finished\nExpected IDs retrieved: 1000. Actual IDs retrieved: 32.\nException in thread &quot;main&quot; java.lang.IllegalStateException: Not all _ID were returned for each document in batch\n</code></pre>\n<h3>My questions</h3>\n<ol>\n<li>Is <code>InsertManyResult.getInsertedIds()</code> meant to return <code>_id</code> for <em>all</em> documents inserted?</li>\n<li>Is the way I am using <code>InsertManyResult.getInsertedIds()</code> correct?</li>\n<li>Could size of the inserted JSON be a factor here?</li>\n<li>How should I use <code>InsertManyResult</code> to get <code>_id</code> for inserted documents?</li>\n</ol>\n<h2>Note</h2>\n<p>I am aware that I can either read <code>_id</code> after <code>Document.parse</code> as it is the driver that generates this or I can select <code>_id</code> after documents were inserted.<br/>\nI would like to know how can this be achieved using <code>InsertManyResult.getInsertedIds()</code> as it seems to be made to fit this purpose.</p>\n"},{"tags":["java","android","dex"],"comments":[{"owner":{"account_id":252759,"reputation":19874,"user_id":531021,"display_name":"JesusFreke"},"score":0,"creation_date":1641410460,"post_id":70597839,"comment_id":124800475,"body_markdown":"I suspect that DexFile.loadDex will check what type of file it has been given, and will load the default classes.dex in the root, if it&#39;s an apk (or zip, rather).","body":"I suspect that DexFile.loadDex will check what type of file it has been given, and will load the default classes.dex in the root, if it&#39;s an apk (or zip, rather)."}],"owner":{"account_id":23303237,"reputation":43,"user_id":17383572,"display_name":"Brad Lendon"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":419,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1641407158,"creation_date":1641407158,"question_id":70597839,"body_markdown":"Recently I came across this app known as Warden that reads the classes.dex file of all apps installed in your phone and compares it to a list of trackers/loggers to determine the trackers installed in each app. After digging around the source code I found the following code snippet.\r\n\r\n```\r\nfinal Uri uri = Uri.fromFile(new File(packageInfo.applicationInfo.sourceDir));\r\nFile classFile = null;\r\nFile optimizedFile = null;\r\n\r\n        try {\r\n            final InputStream inputStream = context.getContentResolver().openInputStream(uri);\r\n\r\n            classFile = File.createTempFile(&quot;classes&quot; + Thread.currentThread().getId(),\r\n                    &quot;.dex&quot;,\r\n                    context.getCacheDir());\r\n\r\n            optimizedFile = File.createTempFile(&quot;opt&quot; + Thread.currentThread().getId(),\r\n                    &quot;.dex&quot;,\r\n                    context.getCacheDir());\r\n\r\n            FileUtils.copyInputStreamToFile(inputStream, classFile);\r\n\r\n            final DexFile dexFile = DexFile.loadDex(classFile.getPath(), optimizedFile.getPath(), 0);\r\n\r\n            for (Enumeration&lt;String&gt; classNames = dexFile.entries(); classNames.hasMoreElements(); ) {\r\n                final String className = classNames.nextElement();\r\n                if (className.length() &gt;= 8 &amp;&amp; className.contains(&quot;.&quot;))\r\n                    classNameList.add(className);\r\n            }\r\n\r\n```\r\n(code snippet taken from https://github.com/whyorean/Warden) \r\n\r\nFrom what I understand, the app creates a temproary dex file and reads it using the LoadDex method. \r\n\r\n**What I don&#39;t understand is that the inputstream (1st line of the try block) is of the entire apk file, which (as far as I know) contains other files along with the classes.dex file, if that is the case how is the apk file directly being copied to a .dex file ?**\r\n\r\nI tried googling a bit and found that most answers use zipping and manually loading the &quot;classes.dex&quot; file, so it would be helpful if someone can point to some documentation/reference which explains the above approach in a detailed manner","title":"Reading classes present in an android app from its apk file","body":"<p>Recently I came across this app known as Warden that reads the classes.dex file of all apps installed in your phone and compares it to a list of trackers/loggers to determine the trackers installed in each app. After digging around the source code I found the following code snippet.</p>\n<pre><code>final Uri uri = Uri.fromFile(new File(packageInfo.applicationInfo.sourceDir));\nFile classFile = null;\nFile optimizedFile = null;\n\n        try {\n            final InputStream inputStream = context.getContentResolver().openInputStream(uri);\n\n            classFile = File.createTempFile(&quot;classes&quot; + Thread.currentThread().getId(),\n                    &quot;.dex&quot;,\n                    context.getCacheDir());\n\n            optimizedFile = File.createTempFile(&quot;opt&quot; + Thread.currentThread().getId(),\n                    &quot;.dex&quot;,\n                    context.getCacheDir());\n\n            FileUtils.copyInputStreamToFile(inputStream, classFile);\n\n            final DexFile dexFile = DexFile.loadDex(classFile.getPath(), optimizedFile.getPath(), 0);\n\n            for (Enumeration&lt;String&gt; classNames = dexFile.entries(); classNames.hasMoreElements(); ) {\n                final String className = classNames.nextElement();\n                if (className.length() &gt;= 8 &amp;&amp; className.contains(&quot;.&quot;))\n                    classNameList.add(className);\n            }\n\n</code></pre>\n<p>(code snippet taken from <a href=\"https://github.com/whyorean/Warden\" rel=\"nofollow noreferrer\">https://github.com/whyorean/Warden</a>)</p>\n<p>From what I understand, the app creates a temproary dex file and reads it using the LoadDex method.</p>\n<p><strong>What I don't understand is that the inputstream (1st line of the try block) is of the entire apk file, which (as far as I know) contains other files along with the classes.dex file, if that is the case how is the apk file directly being copied to a .dex file ?</strong></p>\n<p>I tried googling a bit and found that most answers use zipping and manually loading the &quot;classes.dex&quot; file, so it would be helpful if someone can point to some documentation/reference which explains the above approach in a detailed manner</p>\n"},{"tags":["java","android","kotlin","fragment","fragmentmanager"],"answers":[{"tags":[],"owner":{"account_id":3195669,"reputation":31,"user_id":2698893,"display_name":"Vineed Gangadharan"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641406738,"creation_date":1640778293,"answer_id":70518939,"question_id":70510772,"body_markdown":"You could either pop/remove riskfragment in onHiddenChanged callback of investmentfragment, or you could listen for page change event using:\r\n\r\n     viewPager2.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {\r\n                @Override\r\n                public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {\r\n                    \r\n                }\r\n\r\n                @Override\r\n                public void onPageSelected(int position){\r\n                   //when 2nd fragment is selected pop/remove riskfragment\r\n                }\r\n            });\r\n\r\nMore help on doc: [link][1]\r\n\r\n\r\n  [1]: https://developer.android.com/reference/androidx/viewpager2/widget/ViewPager2.OnPageChangeCallback","title":"Fragment in TabView issue in Android","body":"<p>You could either pop/remove riskfragment in onHiddenChanged callback of investmentfragment, or you could listen for page change event using:</p>\n<pre><code> viewPager2.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {\n            @Override\n            public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {\n                \n            }\n\n            @Override\n            public void onPageSelected(int position){\n               //when 2nd fragment is selected pop/remove riskfragment\n            }\n        });\n</code></pre>\n<p>More help on doc: <a href=\"https://developer.android.com/reference/androidx/viewpager2/widget/ViewPager2.OnPageChangeCallback\" rel=\"nofollow noreferrer\">link</a></p>\n"}],"owner":{"account_id":11939380,"reputation":581,"user_id":11696949,"display_name":"F_Z"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":30,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641406738,"creation_date":1640714248,"question_id":70510772,"body_markdown":"I have Pager which has two Fragments,\r\n\r\n    class eTransactionPager(fm: FragmentManager) : FragmentStatePagerAdapter(fm) {\r\n    \r\n        override fun getCount(): Int = 2\r\n    \r\n        override fun getItem(position: Int): Fragment {\r\n            when (position) {\r\n                0 -&gt; {\r\n                    return investmentFragment()\r\n                }\r\n                1 -&gt; {\r\n                    return redemptionFragment()\r\n                }\r\n                \r\n    \r\n            }\r\n            return investmentFragment()\r\n        }\r\n    }\r\n\r\nSuppose I call riskFragment() from investmentFragment() and stay on the riskFragment(), after that I change tab to redemptionFragment() and then change tab again to investmentFragment() and it is showing riskFragment(). But I want here investmentFragment(). I want to destroy the riskFragment() when I had changed the tab to redemptionFragment().\r\n\r\nCode:\r\n\r\nCalling riskFragment() from investmentFragment():\r\n\r\n        val fragment2 = riskFragment()\r\n        val fragmentManager: FragmentManager = parentFragmentManager\r\n        val fragmentTransaction: FragmentTransaction = fragmentManager.beginTransaction()\r\n        fragmentTransaction.replace(R.id.root_view, fragment2, null)\r\n        fragmentTransaction.addToBackStack(null)\r\n        fragmentTransaction.commit()","title":"Fragment in TabView issue in Android","body":"<p>I have Pager which has two Fragments,</p>\n<pre><code>class eTransactionPager(fm: FragmentManager) : FragmentStatePagerAdapter(fm) {\n\n    override fun getCount(): Int = 2\n\n    override fun getItem(position: Int): Fragment {\n        when (position) {\n            0 -&gt; {\n                return investmentFragment()\n            }\n            1 -&gt; {\n                return redemptionFragment()\n            }\n            \n\n        }\n        return investmentFragment()\n    }\n}\n</code></pre>\n<p>Suppose I call riskFragment() from investmentFragment() and stay on the riskFragment(), after that I change tab to redemptionFragment() and then change tab again to investmentFragment() and it is showing riskFragment(). But I want here investmentFragment(). I want to destroy the riskFragment() when I had changed the tab to redemptionFragment().</p>\n<p>Code:</p>\n<p>Calling riskFragment() from investmentFragment():</p>\n<pre><code>    val fragment2 = riskFragment()\n    val fragmentManager: FragmentManager = parentFragmentManager\n    val fragmentTransaction: FragmentTransaction = fragmentManager.beginTransaction()\n    fragmentTransaction.replace(R.id.root_view, fragment2, null)\n    fragmentTransaction.addToBackStack(null)\n    fragmentTransaction.commit()\n</code></pre>\n"},{"tags":["java","unix","ssh","automation","jsch"],"answers":[{"tags":[],"owner":{"account_id":453710,"reputation":192093,"user_id":850848,"accept_rate":80,"display_name":"Martin Prikryl"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1640719170,"creation_date":1640719170,"answer_id":70511565,"question_id":70511275,"body_markdown":"Do not execute commands in &quot;shell&quot; channel in the first place. The &quot;shell&quot; is a black box with an input and output only. See https://stackoverflow.com/q/6770206/850848#56713547\r\n\r\n\r\nUse the &quot;exec&quot; channel. In the &quot;exec&quot; channel, the [`Channel.getExitStatus`](https://epaul.github.io/jsch-documentation/javadoc/com/jcraft/jsch/Channel.html#getExitStatus--) works.\r\n\r\nFor a code example, see:  https://stackoverflow.com/q/6902386/850848\r\n\r\n---\r\n\r\n*Obligatory warning: Do not use `StrictHostKeyChecking=no` to blindly accept all host keys. That is a security flaw. You lose a protection against [MITM attacks](https://en.wikipedia.org/wiki/Man-in-the-middle_attack). For the correct (and secure) approach, see: https://stackoverflow.com/q/32852906/850848*","title":"JSch Channel.getExitStatus does not return status of command executed in &quot;shell&quot; channel","body":"<p>Do not execute commands in &quot;shell&quot; channel in the first place. The &quot;shell&quot; is a black box with an input and output only. See <a href=\"https://stackoverflow.com/q/6770206/850848#56713547\">What is the difference between the &#39;shell&#39; channel and the &#39;exec&#39; channel in JSch</a></p>\n<p>Use the &quot;exec&quot; channel. In the &quot;exec&quot; channel, the <a href=\"https://epaul.github.io/jsch-documentation/javadoc/com/jcraft/jsch/Channel.html#getExitStatus--\" rel=\"nofollow noreferrer\"><code>Channel.getExitStatus</code></a> works.</p>\n<p>For a code example, see:  <a href=\"https://stackoverflow.com/q/6902386/850848\">How to read JSch command output?</a></p>\n<hr />\n<p><em>Obligatory warning: Do not use <code>StrictHostKeyChecking=no</code> to blindly accept all host keys. That is a security flaw. You lose a protection against <a href=\"https://en.wikipedia.org/wiki/Man-in-the-middle_attack\" rel=\"nofollow noreferrer\">MITM attacks</a>. For the correct (and secure) approach, see: <a href=\"https://stackoverflow.com/q/32852906/850848\">How to resolve Java UnknownHostKey, while using JSch SFTP library?</a></em></p>\n"}],"owner":{"account_id":23755941,"reputation":13,"user_id":17772063,"display_name":"Faigy Saberski"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":410,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":70511565,"answer_count":1,"score":1,"last_activity_date":1641406587,"creation_date":1640717269,"question_id":70511275,"body_markdown":"I&#39;m trying to compare file by JSch  `diff` command.\r\nI want to get the status by Java code to know if the file equals or not i.e. `echo $status`.\r\nHow can I do that in java?\r\n\r\nThis is my class to run SSH commands\r\n```\r\npublic class SSH {\r\n\r\n\tstatic Logger logger = LogManager.getLogger(&quot;sshLogger&quot;);\r\n\tstatic Process p;\r\n\tstatic String s;\r\n\tint exitStatus = -1;\r\n\tString user;\r\n\tString pass;\r\n\tString server;\r\n\tString command;\r\n\tpublic Channel channel;\r\n\tpublic Session session;\r\n\tpublic InputStream in;\r\n\r\n\tpublic SSH(String user, String pass, String server) {\r\n\t\tthis.user = user;\r\n\t\tthis.pass = pass;\r\n\t\tthis.server = server;\r\n\t\tlogger.debug(&quot;instance: &quot; + user + &quot;@&quot; + server);\r\n\t}\r\n\r\n\tprivate Session getConnectedSession(String user, String pass, String server) throws JSchException {\r\n\r\n\t\tsession = new JSch().getSession(user, server, 22);\r\n\t\tjava.util.Properties config = new java.util.Properties();\r\n\t\tsession.setPassword(pass);\r\n\t\tconfig.put(&quot;StrictHostKeyChecking&quot;, &quot;no&quot;);\r\n\t\tconfig.put(&quot;PreferredAuthentications&quot;,&quot;publickey,keyboard-interactive,password&quot;);\r\n\t\tsession.setConfig(config);\r\n\r\n\t\tlogger.debug(&quot;get connected session at: &quot; + server);\r\n\t\tsession.connect();\r\n\t\tlogger.debug(&quot;connected to session&quot;);\r\n\r\n\t\treturn session;\r\n\r\n\t}\r\n\r\n\tpublic Channel getChannel() {\r\n\r\n\t\t// ByteArrayOutputStream byteArrOutSt = new ByteArrayOutputStream();\r\n\r\n\t\ttry {\r\n\t\t\tsession = getConnectedSession(user, pass, server);\r\n\t\t\tlogger.debug(&quot;opening channel at: &quot; + server);\r\n\t\t\tchannel = session.openChannel(&quot;shell&quot;);\r\n\t\t} catch (JSchException e) {\r\n\t\t\tlogger.error(&quot;failed to connect to: &quot;+ user + &quot;@&quot;+ server);\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t\t// channel.setOutputStream(baos);\r\n\t\tchannel.setOutputStream(System.out);\r\n\t\tchannel.setExtOutputStream(System.out, true);\r\n\t\t// channel.setPty(Boolean.FALSE);\r\n\r\n\t\treturn channel;\r\n\r\n\t}\r\n\r\n\tpublic String commandBuilder(String... commands)  {\r\n\r\n\t\tStringBuilder commandString = new StringBuilder();\r\n\t\tfor (String command : commands) {\r\n\t\t\tlogger.debug(&quot;adding command: &quot; + command);\r\n\t\t\tcommandString.append(command + &quot;\\\\n&quot;);\r\n\t\t}\r\n\t\tlogger.debug(&quot;adding command: exit&quot;);\r\n\t\tcommandString.append(&quot;exit\\\\n&quot;);\r\n\t\tString myCommand = commandString.toString().replace(&quot;\\\\n&quot;, &quot;\\n&quot;);\r\n\t\treturn myCommand;\r\n\t}\r\n\t\r\n\t\r\n\tpublic String executeCommand(String myCommand) {\r\n\t\tchannel = getChannel();\r\n\t\t//String finishedCommand = commandBuilder(myCommand);\r\n\t\tlogger.debug(myCommand);\r\n\t\r\n\t\tStringBuilder outBuff = new StringBuilder();\r\n\t\tString outComm = null;\r\n\t\tchannel.setInputStream(new ByteArrayInputStream(myCommand.getBytes(StandardCharsets.UTF_8)));\r\n\t\ttry {\r\n\t\t\tin = channel.getInputStream();\r\n\t\t\tchannel.connect();\r\n\t\t\t// read from the output\r\n\t\t\tSystem.out.println(&quot;printing&quot;);\r\n\t\t\twhile (true) {\r\n\t\t\t\tfor (int c; ((c = in.read()) &gt;= 0);) {\r\n\t\t\t\t\toutBuff.append((char) c);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (channel.isClosed()) {\r\n\t\t\t\t\tif (in.available() &gt; 0)\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\texitStatus = channel.getExitStatus();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (IOException e) {\r\n\t\t\tlogger.error(&quot;failed while running or reading output of command: &quot; + myCommand);\r\n\t\t} catch (JSchException e) {\r\n\t\t\t\r\n\t\t\tlogger.error(&quot;failed to connect to server while running command: &quot; + myCommand);\r\n\t\t}\r\n\t\t\r\n\r\n\t\tlogger.info(outBuff.toString());\r\n\t\treturn outBuff.toString();\r\n\t}\r\n\r\n\t\r\n\tpublic void endSession() {\r\n\r\n\t\tlogger.debug(&quot;ending session&quot;);\r\n\t\tchannel.disconnect();\r\n\t\tsession.disconnect();\r\n\t\tlogger.debug(&quot;disconnected channel and session&quot;);\r\n\r\n\t\t// print exit status\r\n\t\tlogger.debug(&quot;Exit status of the execution: &quot; + exitStatus);\r\n\t\tif (exitStatus == 0) {\r\n\t\t\tlogger.debug(&quot; (OK)\\n&quot;);\r\n\t\t} else {\r\n\t\t\tlogger.debug(&quot; (NOK)\\n&quot;);\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic String runCommand(String... commands) {\r\n\t\t\r\n\t\t// many commands as you want\r\n\t\t\r\n\t\t\r\n\t\tString output = null;\r\n\t\tString myCommands;\r\n\t\tmyCommands = commandBuilder(commands);\r\n\t\ttry {\r\n\t\t\toutput = executeCommand(myCommands);\r\n\t\t\tendSession();\r\n\t\t} catch (Exception e) {\r\n\t\t\tlogger.error(&quot;failed to run ssh comands: &quot;+ commands);\r\n\t\t\te.printStackTrace();\r\n\t\t} \r\n\t\treturn output;\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n```\r\n\r\nusing SSH for `diff` example:\r\n```\r\nSSH session = new SSH(user, pass, server);\r\nsession.runCommand(&quot;diff file1.xml file2.xml&quot;);\r\n```","title":"JSch Channel.getExitStatus does not return status of command executed in &quot;shell&quot; channel","body":"<p>I'm trying to compare file by JSch  <code>diff</code> command.\nI want to get the status by Java code to know if the file equals or not i.e. <code>echo $status</code>.\nHow can I do that in java?</p>\n<p>This is my class to run SSH commands</p>\n<pre><code>public class SSH {\n\n    static Logger logger = LogManager.getLogger(&quot;sshLogger&quot;);\n    static Process p;\n    static String s;\n    int exitStatus = -1;\n    String user;\n    String pass;\n    String server;\n    String command;\n    public Channel channel;\n    public Session session;\n    public InputStream in;\n\n    public SSH(String user, String pass, String server) {\n        this.user = user;\n        this.pass = pass;\n        this.server = server;\n        logger.debug(&quot;instance: &quot; + user + &quot;@&quot; + server);\n    }\n\n    private Session getConnectedSession(String user, String pass, String server) throws JSchException {\n\n        session = new JSch().getSession(user, server, 22);\n        java.util.Properties config = new java.util.Properties();\n        session.setPassword(pass);\n        config.put(&quot;StrictHostKeyChecking&quot;, &quot;no&quot;);\n        config.put(&quot;PreferredAuthentications&quot;,&quot;publickey,keyboard-interactive,password&quot;);\n        session.setConfig(config);\n\n        logger.debug(&quot;get connected session at: &quot; + server);\n        session.connect();\n        logger.debug(&quot;connected to session&quot;);\n\n        return session;\n\n    }\n\n    public Channel getChannel() {\n\n        // ByteArrayOutputStream byteArrOutSt = new ByteArrayOutputStream();\n\n        try {\n            session = getConnectedSession(user, pass, server);\n            logger.debug(&quot;opening channel at: &quot; + server);\n            channel = session.openChannel(&quot;shell&quot;);\n        } catch (JSchException e) {\n            logger.error(&quot;failed to connect to: &quot;+ user + &quot;@&quot;+ server);\n            e.printStackTrace();\n        }\n        // channel.setOutputStream(baos);\n        channel.setOutputStream(System.out);\n        channel.setExtOutputStream(System.out, true);\n        // channel.setPty(Boolean.FALSE);\n\n        return channel;\n\n    }\n\n    public String commandBuilder(String... commands)  {\n\n        StringBuilder commandString = new StringBuilder();\n        for (String command : commands) {\n            logger.debug(&quot;adding command: &quot; + command);\n            commandString.append(command + &quot;\\\\n&quot;);\n        }\n        logger.debug(&quot;adding command: exit&quot;);\n        commandString.append(&quot;exit\\\\n&quot;);\n        String myCommand = commandString.toString().replace(&quot;\\\\n&quot;, &quot;\\n&quot;);\n        return myCommand;\n    }\n    \n    \n    public String executeCommand(String myCommand) {\n        channel = getChannel();\n        //String finishedCommand = commandBuilder(myCommand);\n        logger.debug(myCommand);\n    \n        StringBuilder outBuff = new StringBuilder();\n        String outComm = null;\n        channel.setInputStream(new ByteArrayInputStream(myCommand.getBytes(StandardCharsets.UTF_8)));\n        try {\n            in = channel.getInputStream();\n            channel.connect();\n            // read from the output\n            System.out.println(&quot;printing&quot;);\n            while (true) {\n                for (int c; ((c = in.read()) &gt;= 0);) {\n                    outBuff.append((char) c);\n                }\n\n                if (channel.isClosed()) {\n                    if (in.available() &gt; 0)\n                        continue;\n                    exitStatus = channel.getExitStatus();\n                    break;\n                }\n            }\n        } catch (IOException e) {\n            logger.error(&quot;failed while running or reading output of command: &quot; + myCommand);\n        } catch (JSchException e) {\n            \n            logger.error(&quot;failed to connect to server while running command: &quot; + myCommand);\n        }\n        \n\n        logger.info(outBuff.toString());\n        return outBuff.toString();\n    }\n\n    \n    public void endSession() {\n\n        logger.debug(&quot;ending session&quot;);\n        channel.disconnect();\n        session.disconnect();\n        logger.debug(&quot;disconnected channel and session&quot;);\n\n        // print exit status\n        logger.debug(&quot;Exit status of the execution: &quot; + exitStatus);\n        if (exitStatus == 0) {\n            logger.debug(&quot; (OK)\\n&quot;);\n        } else {\n            logger.debug(&quot; (NOK)\\n&quot;);\n        }\n    }\n    \n    public String runCommand(String... commands) {\n        \n        // many commands as you want\n        \n        \n        String output = null;\n        String myCommands;\n        myCommands = commandBuilder(commands);\n        try {\n            output = executeCommand(myCommands);\n            endSession();\n        } catch (Exception e) {\n            logger.error(&quot;failed to run ssh comands: &quot;+ commands);\n            e.printStackTrace();\n        } \n        return output;\n        \n    }\n    \n}\n</code></pre>\n<p>using SSH for <code>diff</code> example:</p>\n<pre><code>SSH session = new SSH(user, pass, server);\nsession.runCommand(&quot;diff file1.xml file2.xml&quot;);\n</code></pre>\n"},{"tags":["java","spring-boot","rest","asynchronous"],"comments":[{"owner":{"account_id":1718670,"reputation":4778,"user_id":1575188,"display_name":"fantaghirocco"},"score":0,"creation_date":1602144415,"post_id":64258253,"comment_id":113628827,"body_markdown":"don&#39;t call the service at all or call it using a thread","body":"don&#39;t call the service at all or call it using a thread"},{"owner":{"account_id":3837785,"reputation":277,"user_id":3181718,"display_name":"jr593"},"score":0,"creation_date":1602146653,"post_id":64258253,"comment_id":113629840,"body_markdown":"Use an async call","body":"Use an async call"}],"answers":[{"tags":[],"owner":{"account_id":3995853,"reputation":540,"user_id":3293436,"display_name":"MauroB"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1602147954,"creation_date":1602147954,"answer_id":64259232,"question_id":64258253,"body_markdown":"You should not use RestTemplate to call REST API.\r\n\r\n&quot;Please, consider using the org.springframework.web.reactive.client.WebClient which has a more modern API and supports sync, async, and streaming scenarios.&quot;\r\n\r\n\r\nhttps://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html","title":"How to call rest api and do not wait any response","body":"<p>You should not use RestTemplate to call REST API.</p>\n<p>&quot;Please, consider using the org.springframework.web.reactive.client.WebClient which has a more modern API and supports sync, async, and streaming scenarios.&quot;</p>\n<p><a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html\" rel=\"nofollow noreferrer\">https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html</a></p>\n"},{"tags":[],"owner":{"account_id":18858438,"reputation":2538,"user_id":13755857,"display_name":"Shawrup"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1602180305,"creation_date":1602180305,"answer_id":64268278,"question_id":64258253,"body_markdown":"You can make the `sync` method call asynchronous. Spring provides easy way to do that. Add `@EnableAsync` in any of you Configuration class (i.e. Classes annotated with `@Configuration`). If you don&#39;t find any configuration class then add `@EnableAsync` in the class with `@SpringBootApplication`.\r\n```\r\n@SpringBootApplication\r\n@EnableAsync\r\npublic class SpringbootApplication{\r\n\tpublic static void main(String[] args) {\r\n\t\tSpringApplication.run(SpringbootApplication.class, args);\r\n\t}\r\n}\r\n```\r\n\r\nThen add `@Async` to your `sync` method. Your code will look like this.\r\n```\r\n@Async\r\npublic void sync() {\r\n    RestTemplate restTemplate = restTemplate();\r\n    restTemplate.exchange(batchHost, HttpMethod.GET, header(), String.class);\r\n}\r\n```\r\nTo make `@Async` work, this `sync` method need to be called from another class file. If you call `sync` from same class then sync method will not be asynchronous.","title":"How to call rest api and do not wait any response","body":"<p>You can make the <code>sync</code> method call asynchronous. Spring provides easy way to do that. Add <code>@EnableAsync</code> in any of you Configuration class (i.e. Classes annotated with <code>@Configuration</code>). If you don't find any configuration class then add <code>@EnableAsync</code> in the class with <code>@SpringBootApplication</code>.</p>\n<pre><code>@SpringBootApplication\n@EnableAsync\npublic class SpringbootApplication{\n    public static void main(String[] args) {\n        SpringApplication.run(SpringbootApplication.class, args);\n    }\n}\n</code></pre>\n<p>Then add <code>@Async</code> to your <code>sync</code> method. Your code will look like this.</p>\n<pre><code>@Async\npublic void sync() {\n    RestTemplate restTemplate = restTemplate();\n    restTemplate.exchange(batchHost, HttpMethod.GET, header(), String.class);\n}\n</code></pre>\n<p>To make <code>@Async</code> work, this <code>sync</code> method need to be called from another class file. If you call <code>sync</code> from same class then sync method will not be asynchronous.</p>\n"},{"tags":[],"owner":{"account_id":20676330,"reputation":1,"user_id":17841899,"display_name":"Alia"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641406573,"creation_date":1641393832,"answer_id":70594804,"question_id":64258253,"body_markdown":"If you dont want a response from the methods you run async, then You can simply do the async portion inside `completableFuture` lambda method as follows, directly in your triggering endpoint and return 200 ok immediately.  Note, if internal method may throw exceptions, you need to swallow that too in a try/catch to ensure it happens asynch. as well.\r\n\r\n&lt;!-- language: java --&gt;\r\n\r\n    @GetMapping(value = &quot;/trigger&quot;)\r\n    \tpublic ResponseEntity&lt;String&gt; triggerMethod() throws Exception {\r\n    \t\t\r\n\r\n    \t\t  CompletableFuture.runAsync(() -&gt; {\r\n    \t\t\t  try {\r\n    \t\t\t\t\r\n    \t\t\t\tthis.dosomething();\r\n\r\n    \t\t\t  } catch(Exception e) {e.printStackTrace();}\r\n\r\n    \t\t  });\r\n    \t\t  \r\n    \t\treturn new ResponseEntity&lt;String&gt;(HttpStatus.OK);\r\n    \t\t\r\n    \t\t\r\n    \t}\r\n\r\nHowever, if you require a response through other methods run asynchronously, then you will need to implement something like [this example](https://howtodoinjava.com/spring-boot2/rest/enableasync-async-controller/)\r\n\r\n","title":"How to call rest api and do not wait any response","body":"<p>If you dont want a response from the methods you run async, then You can simply do the async portion inside <code>completableFuture</code> lambda method as follows, directly in your triggering endpoint and return 200 ok immediately.  Note, if internal method may throw exceptions, you need to swallow that too in a try/catch to ensure it happens asynch. as well.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@GetMapping(value = &quot;/trigger&quot;)\n    public ResponseEntity&lt;String&gt; triggerMethod() throws Exception {\n        \n\n          CompletableFuture.runAsync(() -&gt; {\n              try {\n                \n                this.dosomething();\n\n              } catch(Exception e) {e.printStackTrace();}\n\n          });\n          \n        return new ResponseEntity&lt;String&gt;(HttpStatus.OK);\n        \n        \n    }\n</code></pre>\n<p>However, if you require a response through other methods run asynchronously, then you will need to implement something like <a href=\"https://howtodoinjava.com/spring-boot2/rest/enableasync-async-controller/\" rel=\"nofollow noreferrer\">this example</a></p>\n"},{"tags":[],"owner":{"account_id":1593091,"reputation":898,"user_id":1476031,"display_name":"Sharad"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641406236,"creation_date":1641406236,"answer_id":70597647,"question_id":64258253,"body_markdown":"You can use ***Spring WebFlux*** to build or consume API&#39;s in reactive and non-blocking manners.\r\nHere is the official documentation which explains this in detail:\r\nhttps://docs.spring.io/spring-framework/docs/current/reference/html/web-reactive.html\r\n","title":"How to call rest api and do not wait any response","body":"<p>You can use <em><strong>Spring WebFlux</strong></em> to build or consume API's in reactive and non-blocking manners.\nHere is the official documentation which explains this in detail:\n<a href=\"https://docs.spring.io/spring-framework/docs/current/reference/html/web-reactive.html\" rel=\"nofollow noreferrer\">https://docs.spring.io/spring-framework/docs/current/reference/html/web-reactive.html</a></p>\n"}],"owner":{"account_id":6601303,"reputation":187,"user_id":5099514,"accept_rate":89,"display_name":"Florian"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":8500,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"accepted_answer_id":64268278,"answer_count":4,"score":1,"last_activity_date":1641406573,"creation_date":1602144139,"question_id":64258253,"body_markdown":"I have this code\r\n\r\n\r\n    private Boolean doSomething() {\r\n        // SOME CODE\r\n        this.sync();\r\n        return true;\r\n    }\r\n\r\n    public void sync() {\r\n        RestTemplate restTemplate = restTemplate();\r\n        restTemplate.exchange(batchHost, HttpMethod.GET, header(), String.class);\r\n    }\r\n\r\nI don&#39;t need data from the rest call. it&#39;s batch execution service he take times. but for my `doSomething` function i don&#39;t need a response from `sync` to continue.\r\n\r\nToday, when the rest call not working, not available... my function doSomething .... do nothing...\r\n\r\nHow to call rest service but continue without error `doSomething()` without errors ??\r\n\r\nThanks\r\n\r\nI use java 11","title":"How to call rest api and do not wait any response","body":"<p>I have this code</p>\n<pre><code>private Boolean doSomething() {\n    // SOME CODE\n    this.sync();\n    return true;\n}\n\npublic void sync() {\n    RestTemplate restTemplate = restTemplate();\n    restTemplate.exchange(batchHost, HttpMethod.GET, header(), String.class);\n}\n</code></pre>\n<p>I don't need data from the rest call. it's batch execution service he take times. but for my <code>doSomething</code> function i don't need a response from <code>sync</code> to continue.</p>\n<p>Today, when the rest call not working, not available... my function doSomething .... do nothing...</p>\n<p>How to call rest service but continue without error <code>doSomething()</code> without errors ??</p>\n<p>Thanks</p>\n<p>I use java 11</p>\n"},{"tags":["java","spring-boot","hibernate","jpa"],"comments":[{"owner":{"account_id":231721,"reputation":20460,"user_id":496099,"display_name":"Chris"},"score":0,"creation_date":1641489178,"post_id":70597715,"comment_id":124822526,"body_markdown":"The stack trace might help you, but for something like this, it could be anywhere in the existing context - at some point within in it, something that is managed is made to reference something that isn&#39;t referenced. Anything read from the context is managed and discovered when a transaction commits, so check that you haven&#39;t called a set method on something while still in a transaction ie: ServicingModule.setServicing calls.","body":"The stack trace might help you, but for something like this, it could be anywhere in the existing context - at some point within in it, something that is managed is made to reference something that isn&#39;t referenced. Anything read from the context is managed and discovered when a transaction commits, so check that you haven&#39;t called a set method on something while still in a transaction ie: ServicingModule.setServicing calls."}],"owner":{"account_id":23838143,"reputation":11,"user_id":17843611,"display_name":"Astarte"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":170,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1641406547,"creation_date":1641406547,"question_id":70597715,"body_markdown":"I&#39;m getting \r\n\r\n&gt; detached entity passed to persist\r\n\r\n  when I call findAll Method of my repository.\r\nI&#39;m not even trying to persist anything , yet hibernate tells me that i passed a detached object to persist.\r\n\r\nHere are my classes :\r\n\r\n\r\n\r\n\r\n    @Entity(name = &quot;servicing_module&quot;)\r\n    @org.hibernate.annotations.Cache(usage = CacheConcurrencyStrategy.READ_WRITE)\r\n    @Audited\r\n    @Getter\r\n    @Setter\r\n    public class ServicingModule extends AbstractAuditedEntity implements Serializable {\r\n    \r\n      \r\n    \r\n      @ManyToOne(optional = false, fetch = FetchType.LAZY)\r\n      @JoinColumn(name=&quot;servicing_id&quot;)\r\n      @EqualsAndHashCode.Exclude\r\n      @JsonIgnore\r\n      private Servicing servicing;\r\n    \r\n    \r\n      @Basic\r\n      private String name;\r\n    \r\n      @Column(unique = true)\r\n      private String ins;\r\n    \r\n      @Enumerated(EnumType.STRING)\r\n      private ServicingModuleStateEnum state = ServicingModuleStateEnum.ACTIVE;\r\n    \r\n      @Basic\r\n      private String description;\r\n    \r\n      @ElementCollection\r\n      @Column(nullable = false)\r\n      Set&lt;String&gt; contacts = new HashSet&lt;&gt;();\r\n    \r\n      @Override\r\n      public boolean equals(Object o) {\r\n        if (this == o) return true;\r\n        if (o == null || getClass() != o.getClass()) return false;\r\n        if (!super.equals(o)) return false;\r\n        ServicingModule that = (ServicingModule) o;\r\n        return name.equals(that.name) &amp;&amp; ins.equals(that.ins) &amp;&amp; state == that.state &amp;&amp; description.equals(that.description);\r\n      }\r\n    \r\n      @Override\r\n      public int hashCode() {\r\n        return Objects.hash(super.hashCode(), name, ins, state, description);\r\n      }\r\n    \r\n    }\r\n\r\nThe parent class :\r\n\r\n */\r\n\r\n    @Entity(name = &quot;servicing&quot;)\r\n    @org.hibernate.annotations.Cache(usage = CacheConcurrencyStrategy.READ_WRITE)\r\n    @Audited\r\n    public class Servicing extends AbstractAuditedEntity {\r\n    \r\n    @org.hibernate.annotations.Cache(usage = CacheConcurrencyStrategy.READ_WRITE)\r\n    @OneToMany(mappedBy = &quot;servicing&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\r\n    private List&lt;ServicingModule&gt; modules = new ArrayList&lt;&gt;();\r\n    }\r\n\r\n\r\nThe repo\r\n\r\n    public interface ServicingModuleRepository extends AbstractEntityRepository&lt;ServicingModule&gt; {\r\n    \r\n    \r\n      int countByInsStartingWithIgnoreCase(String partIns);\r\n\r\n}\r\n\r\nThanks for your help","title":"detached entity passed to persist on findAll call","body":"<p>I'm getting</p>\n<blockquote>\n<p>detached entity passed to persist</p>\n</blockquote>\n<p>when I call findAll Method of my repository.\nI'm not even trying to persist anything , yet hibernate tells me that i passed a detached object to persist.</p>\n<p>Here are my classes :</p>\n<pre><code>@Entity(name = &quot;servicing_module&quot;)\n@org.hibernate.annotations.Cache(usage = CacheConcurrencyStrategy.READ_WRITE)\n@Audited\n@Getter\n@Setter\npublic class ServicingModule extends AbstractAuditedEntity implements Serializable {\n\n  \n\n  @ManyToOne(optional = false, fetch = FetchType.LAZY)\n  @JoinColumn(name=&quot;servicing_id&quot;)\n  @EqualsAndHashCode.Exclude\n  @JsonIgnore\n  private Servicing servicing;\n\n\n  @Basic\n  private String name;\n\n  @Column(unique = true)\n  private String ins;\n\n  @Enumerated(EnumType.STRING)\n  private ServicingModuleStateEnum state = ServicingModuleStateEnum.ACTIVE;\n\n  @Basic\n  private String description;\n\n  @ElementCollection\n  @Column(nullable = false)\n  Set&lt;String&gt; contacts = new HashSet&lt;&gt;();\n\n  @Override\n  public boolean equals(Object o) {\n    if (this == o) return true;\n    if (o == null || getClass() != o.getClass()) return false;\n    if (!super.equals(o)) return false;\n    ServicingModule that = (ServicingModule) o;\n    return name.equals(that.name) &amp;&amp; ins.equals(that.ins) &amp;&amp; state == that.state &amp;&amp; description.equals(that.description);\n  }\n\n  @Override\n  public int hashCode() {\n    return Objects.hash(super.hashCode(), name, ins, state, description);\n  }\n\n}\n</code></pre>\n<p>The parent class :</p>\n<p>*/</p>\n<pre><code>@Entity(name = &quot;servicing&quot;)\n@org.hibernate.annotations.Cache(usage = CacheConcurrencyStrategy.READ_WRITE)\n@Audited\npublic class Servicing extends AbstractAuditedEntity {\n\n@org.hibernate.annotations.Cache(usage = CacheConcurrencyStrategy.READ_WRITE)\n@OneToMany(mappedBy = &quot;servicing&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\nprivate List&lt;ServicingModule&gt; modules = new ArrayList&lt;&gt;();\n}\n</code></pre>\n<p>The repo</p>\n<pre><code>public interface ServicingModuleRepository extends AbstractEntityRepository&lt;ServicingModule&gt; {\n\n\n  int countByInsStartingWithIgnoreCase(String partIns);\n</code></pre>\n<p>}</p>\n<p>Thanks for your help</p>\n"},{"tags":["java","spring-boot"],"comments":[{"owner":{"account_id":10346755,"reputation":21971,"user_id":7631480,"display_name":"CryptoFool"},"score":1,"creation_date":1612109089,"post_id":65980516,"comment_id":116657961,"body_markdown":"What behavior do you expect?  How can one not run before the other?","body":"What behavior do you expect?  How can one not run before the other?"},{"owner":{"account_id":1289397,"reputation":35,"user_id":9320386,"display_name":"JavaFun"},"score":0,"creation_date":1613112776,"post_id":65980516,"comment_id":116980790,"body_markdown":"Curiously, just I want to know this behavior","body":"Curiously, just I want to know this behavior"}],"answers":[{"tags":[],"owner":{"account_id":7778530,"reputation":3138,"user_id":9860374,"display_name":"Matheus"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1612108502,"creation_date":1612108502,"answer_id":65981147,"question_id":65980516,"body_markdown":"Well, I don&#39;t think it&#39;s needed in any case to implement both of these interfaces at the same time.\r\n\r\nBoth, when implemented, indicate that the `run` method should be invoked at the application startup.\r\n\r\nThe difference between `ApplicationRunner` and `CommandLineRunner` is that, on `ApplicationRunner`, instead of raw string arguments passed to the `run` method, we have an instance of `ApplicationArguments` so that you can access the bootstrap arguments passed when initializing the application.\r\n\r\nWith `CommandLineRunner` you can access them as well, but as raw string arguments, so you&#39;ll have to parse them yourself.\r\n\r\nYou could test it yourself:\r\n\r\nRunning the application with the argument `--my-config=xyz` will provide the bellow result when implementing `ApplicationRunner` or `CommandLineRunner`:\r\n\r\nUsing `CommandLineRunner`:\r\n\r\n    @Component\r\n    public class CLIRunner implements CommandLineRunner {\r\n    \r\n    \t@Override\r\n    \tpublic void run(String...args) throws Exception {\r\n    \t\tSystem.out.println(&quot;Arguments passed when bootstraping the app: &quot; + Arrays.asList(args));\r\n    \t}\r\n    }\r\n\r\nOutput:\r\n\r\n    Arguments passed when bootstraping the app: [--my-config=xyz]\r\n\r\nUsing `ApplicationRunner`:\r\n\r\n    @Component\r\n    public class AppRunner implements ApplicationRunner {\r\n    \r\n    \t@Override\r\n    \tpublic void run(ApplicationArguments args) throws Exception {\r\n    \t\tSystem.out.println(&quot;Arguments passed when bootstraping the app: &quot; + args.getOptionNames());\r\n    \t}\r\n    }\r\n\r\nOutput:\r\n\r\n    Arguments passed when bootstraping the app: [my-config]\r\n\r\n\r\nAs you saw, both of them provide, almost, the same functionality. I would suggest always to use `ApplicationRunner`, because then you don&#39;t have to parse the arguments yourself, since Spring already did and made it available to you within the `ApplicationArguments` object.","title":"ApplicationRunner VS CommandLineRunner","body":"<p>Well, I don't think it's needed in any case to implement both of these interfaces at the same time.</p>\n<p>Both, when implemented, indicate that the <code>run</code> method should be invoked at the application startup.</p>\n<p>The difference between <code>ApplicationRunner</code> and <code>CommandLineRunner</code> is that, on <code>ApplicationRunner</code>, instead of raw string arguments passed to the <code>run</code> method, we have an instance of <code>ApplicationArguments</code> so that you can access the bootstrap arguments passed when initializing the application.</p>\n<p>With <code>CommandLineRunner</code> you can access them as well, but as raw string arguments, so you'll have to parse them yourself.</p>\n<p>You could test it yourself:</p>\n<p>Running the application with the argument <code>--my-config=xyz</code> will provide the bellow result when implementing <code>ApplicationRunner</code> or <code>CommandLineRunner</code>:</p>\n<p>Using <code>CommandLineRunner</code>:</p>\n<pre><code>@Component\npublic class CLIRunner implements CommandLineRunner {\n\n    @Override\n    public void run(String...args) throws Exception {\n        System.out.println(&quot;Arguments passed when bootstraping the app: &quot; + Arrays.asList(args));\n    }\n}\n</code></pre>\n<p>Output:</p>\n<pre><code>Arguments passed when bootstraping the app: [--my-config=xyz]\n</code></pre>\n<p>Using <code>ApplicationRunner</code>:</p>\n<pre><code>@Component\npublic class AppRunner implements ApplicationRunner {\n\n    @Override\n    public void run(ApplicationArguments args) throws Exception {\n        System.out.println(&quot;Arguments passed when bootstraping the app: &quot; + args.getOptionNames());\n    }\n}\n</code></pre>\n<p>Output:</p>\n<pre><code>Arguments passed when bootstraping the app: [my-config]\n</code></pre>\n<p>As you saw, both of them provide, almost, the same functionality. I would suggest always to use <code>ApplicationRunner</code>, because then you don't have to parse the arguments yourself, since Spring already did and made it available to you within the <code>ApplicationArguments</code> object.</p>\n"},{"tags":[],"owner":{"account_id":7559454,"reputation":213,"user_id":5737611,"display_name":"Ganesh C"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1612108685,"creation_date":1612108685,"answer_id":65981176,"question_id":65980516,"body_markdown":"The difference between&#160;CommandLineRunner&#160;and&#160;ApplicationRunner&#160;is that the&#160;run()&#160;method of&#160;CommandLineRunner&#160;accepts array of&#160;String&#160;as an argument and&#160;run()&#160;method of&#160;ApplicationRunner&#160;accepts spring&#160;ApplicationArguments&#160;as an argument.\r\n\r\nTo execute them in an order, you can use spring&#160;@Order&#160;annotation or&#160;Ordered&#160;interface.","title":"ApplicationRunner VS CommandLineRunner","body":"<p>The difference betweenCommandLineRunnerandApplicationRunneris that therun()method ofCommandLineRunneraccepts array ofStringas an argument andrun()method ofApplicationRunneraccepts springApplicationArgumentsas an argument.</p>\n<p>To execute them in an order, you can use spring@Orderannotation orOrderedinterface.</p>\n"},{"tags":[],"owner":{"account_id":10346755,"reputation":21971,"user_id":7631480,"display_name":"CryptoFool"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1613118111,"creation_date":1613118111,"answer_id":66168434,"question_id":65980516,"body_markdown":"Here&#39;s a real answer to your question, obtained by looking at the Spring code.  All runners are run by the main thread at the end of startup, via this method:\r\n\r\n\tprivate void callRunners(ApplicationContext context, ApplicationArguments args) {\r\n\t\tList&lt;Object&gt; runners = new ArrayList&lt;&gt;();\r\n\t\trunners.addAll(context.getBeansOfType(ApplicationRunner.class).values());\r\n\t\trunners.addAll(context.getBeansOfType(CommandLineRunner.class).values());\r\n\t\tAnnotationAwareOrderComparator.sort(runners);\r\n\t\tfor (Object runner : new LinkedHashSet&lt;&gt;(runners)) {\r\n\t\t\tif (runner instanceof ApplicationRunner) {\r\n\t\t\t\tcallRunner((ApplicationRunner) runner, args);\r\n\t\t\t}\r\n\t\t\tif (runner instanceof CommandLineRunner) {\r\n\t\t\t\tcallRunner((CommandLineRunner) runner, args);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\nIt sounded to me like what you were doing was implementing both runner interfaces on the same object.  When you do that, the above code shows that the `ApplicationRunner` method is run first, and then the `CommandLineRunner` method.  But you seem to say that you see the opposite behavior.  I implemented a single class that implemented both runners, and I saw the two methods executed in the order I expected per the above code.\r\n\r\nSo you must be implementing these interfaces in two different classes. In that case, the order is determined by how the `AnnotationAwareOrderComparator.sort` method chooses to order your two runner classes, because this method is used, per the above code, to sort the list of all runners to determine the order in which they are called.\r\n\r\nThe description of the `AnnotationAwareOrderComparator` is:\r\n\r\n&gt; AnnotationAwareOrderComparator is an extension of OrderComparator that supports Spring&#39;s Ordered interface as well as the @Order and @Priority annotations, with an order value provided by an Ordered instance overriding a statically defined annotation value (if any).\r\n\r\nAnd the sort method&#39;s description is:\r\n\r\n&gt; Sort the given list with a default AnnotationAwareOrderComparator.\r\n\r\nSo apparently, if you wanted to force a particular order of execution of your runners, you could use @order or @Priority annotations to accomplish that.\r\n\r\nSo there you have it.  If you need more detail than this, you&#39;ll need to dig into the details of how the `AnnotationAwareOrderComparator` chooses how to order your two classes.\r\n","title":"ApplicationRunner VS CommandLineRunner","body":"<p>Here's a real answer to your question, obtained by looking at the Spring code.  All runners are run by the main thread at the end of startup, via this method:</p>\n<pre><code>private void callRunners(ApplicationContext context, ApplicationArguments args) {\n    List&lt;Object&gt; runners = new ArrayList&lt;&gt;();\n    runners.addAll(context.getBeansOfType(ApplicationRunner.class).values());\n    runners.addAll(context.getBeansOfType(CommandLineRunner.class).values());\n    AnnotationAwareOrderComparator.sort(runners);\n    for (Object runner : new LinkedHashSet&lt;&gt;(runners)) {\n        if (runner instanceof ApplicationRunner) {\n            callRunner((ApplicationRunner) runner, args);\n        }\n        if (runner instanceof CommandLineRunner) {\n            callRunner((CommandLineRunner) runner, args);\n        }\n    }\n}\n</code></pre>\n<p>It sounded to me like what you were doing was implementing both runner interfaces on the same object.  When you do that, the above code shows that the <code>ApplicationRunner</code> method is run first, and then the <code>CommandLineRunner</code> method.  But you seem to say that you see the opposite behavior.  I implemented a single class that implemented both runners, and I saw the two methods executed in the order I expected per the above code.</p>\n<p>So you must be implementing these interfaces in two different classes. In that case, the order is determined by how the <code>AnnotationAwareOrderComparator.sort</code> method chooses to order your two runner classes, because this method is used, per the above code, to sort the list of all runners to determine the order in which they are called.</p>\n<p>The description of the <code>AnnotationAwareOrderComparator</code> is:</p>\n<blockquote>\n<p>AnnotationAwareOrderComparator is an extension of OrderComparator that supports Spring's Ordered interface as well as the @Order and @Priority annotations, with an order value provided by an Ordered instance overriding a statically defined annotation value (if any).</p>\n</blockquote>\n<p>And the sort method's description is:</p>\n<blockquote>\n<p>Sort the given list with a default AnnotationAwareOrderComparator.</p>\n</blockquote>\n<p>So apparently, if you wanted to force a particular order of execution of your runners, you could use @order or @Priority annotations to accomplish that.</p>\n<p>So there you have it.  If you need more detail than this, you'll need to dig into the details of how the <code>AnnotationAwareOrderComparator</code> chooses how to order your two classes.</p>\n"}],"owner":{"account_id":1289397,"reputation":35,"user_id":9320386,"display_name":"JavaFun"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3524,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":3,"score":2,"last_activity_date":1641406251,"creation_date":1612104879,"question_id":65980516,"body_markdown":"I am new to Spring boot and read about the **ApplicationRunner** and **CommandLineRunner**. Both are functioning same. When I implement both interfaces at the same time, always **CommandLineRunner&#39;s** method runs first then **ApplicationRunner&#39;s** method.\r\n\r\nAnyone can help, why **CommandLineRunner&#39;s** method getting preference over **ApplicationRunner&#39;s** method.\r\n\r\n","title":"ApplicationRunner VS CommandLineRunner","body":"<p>I am new to Spring boot and read about the <strong>ApplicationRunner</strong> and <strong>CommandLineRunner</strong>. Both are functioning same. When I implement both interfaces at the same time, always <strong>CommandLineRunner's</strong> method runs first then <strong>ApplicationRunner's</strong> method.</p>\n<p>Anyone can help, why <strong>CommandLineRunner's</strong> method getting preference over <strong>ApplicationRunner's</strong> method.</p>\n"},{"tags":["java","java-8"],"answers":[{"tags":[],"owner":{"account_id":13459822,"reputation":1807,"user_id":9712270,"display_name":"magicmn"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1641384276,"creation_date":1641384276,"answer_id":70592578,"question_id":70588034,"body_markdown":"Using a `Map` instead will make your live much easier. However your example is missing some data so it&#39;s a bit hard to understand what is actually happening in your code. So I can give you only a simple example for the usage.\r\n\r\n    Map&lt;String, FeaturedItems&gt; resultMap = new HashMap&lt;&gt;();\r\n    // Get the FeaturedItems for the given type. If none is present create a new one.\r\n    FeaturedItems items = resultMap.computeIfAbsent(type, k -&gt; FeaturedItems.builder().type(k).items(new ArrayList&lt;&gt;()).build());\r\n    // Add your item to the list\r\n    Sale newItem // Obtain new item\r\n    items.getItems().add(newItem);\r\n","title":"avoid adding the same element if exist in the list instead just add the elements inside the existing list","body":"<p>Using a <code>Map</code> instead will make your live much easier. However your example is missing some data so it's a bit hard to understand what is actually happening in your code. So I can give you only a simple example for the usage.</p>\n<pre><code>Map&lt;String, FeaturedItems&gt; resultMap = new HashMap&lt;&gt;();\n// Get the FeaturedItems for the given type. If none is present create a new one.\nFeaturedItems items = resultMap.computeIfAbsent(type, k -&gt; FeaturedItems.builder().type(k).items(new ArrayList&lt;&gt;()).build());\n// Add your item to the list\nSale newItem // Obtain new item\nitems.getItems().add(newItem);\n</code></pre>\n"}],"owner":{"account_id":11884292,"reputation":43,"user_id":8697117,"display_name":"user8697117"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":578,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1641384766,"accepted_answer_id":70592578,"answer_count":1,"score":0,"last_activity_date":1641406200,"creation_date":1641359240,"question_id":70588034,"body_markdown":"Below is the sample code \r\n\r\n\r\n                    String jsonString = &quot;{\\n&quot; +\r\n                            &quot;   \\&quot;models\\&quot;:[\\n&quot; +\r\n                            &quot;      {\\n&quot; +\r\n                            &quot;         \\&quot;model\\&quot;:{\\n&quot; +\r\n                            &quot;            \\&quot;code\\&quot;:\\&quot;ALL\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;type\\&quot;:null,\\n&quot; +\r\n                            &quot;            \\&quot;name\\&quot;:\\&quot;ALL\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;feature_types\\&quot;:null\\n&quot; +\r\n                            &quot;         }\\n&quot; +\r\n                            &quot;      },\\n&quot; +\r\n                            &quot;      {\\n&quot; +\r\n                            &quot;         \\&quot;model\\&quot;:{\\n&quot; +\r\n                            &quot;            \\&quot;code\\&quot;:\\&quot;102e\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;defaultLookup\\&quot;:\\&quot;false\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;type\\&quot;:\\&quot;SIT\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;name\\&quot;:\\&quot;MUSTANG\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;feature_types\\&quot;:[\\n&quot; +\r\n                            &quot;               {\\n&quot; +\r\n                            &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\r\n                            &quot;                     \\&quot;code\\&quot;:\\&quot;A\\&quot;,\\n&quot; +\r\n                            &quot;                     \\&quot;desc\\&quot;:\\&quot;All feature types\\&quot;\\n&quot; +\r\n                            &quot;                  }\\n&quot; +\r\n                            &quot;               },\\n&quot; +\r\n                            &quot;               {\\n&quot; +\r\n                            &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\r\n                            &quot;                     \\&quot;code\\&quot;:\\&quot;B\\&quot;,\\n&quot; +\r\n                            &quot;                     \\&quot;desc\\&quot;:\\&quot;Series\\&quot;\\n&quot; +\r\n                            &quot;                  }\\n&quot; +\r\n                            &quot;               },\\n&quot; +\r\n                            &quot;               {\\n&quot; +\r\n                            &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\r\n                            &quot;                     \\&quot;code\\&quot;:\\&quot;C\\&quot;,\\n&quot; +\r\n                            &quot;                     \\&quot;desc\\&quot;:\\&quot;BodyStyle\\&quot;\\n&quot; +\r\n                            &quot;                  }\\n&quot; +\r\n                            &quot;               }\\n&quot; +\r\n                            &quot;            ]\\n&quot; +\r\n                            &quot;         }\\n&quot; +\r\n                            &quot;      },\\n&quot; +\r\n                            &quot;      {\\n&quot; +\r\n                            &quot;         \\&quot;model\\&quot;:{\\n&quot; +\r\n                            &quot;            \\&quot;code\\&quot;:\\&quot;980p\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;defaultLookup\\&quot;:\\&quot;false\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;type\\&quot;:\\&quot;SIT\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;name\\&quot;:\\&quot;Ranger\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;feature_types\\&quot;:[\\n&quot; +\r\n                            &quot;               {\\n&quot; +\r\n                            &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\r\n                            &quot;                     \\&quot;code\\&quot;:\\&quot;C\\&quot;,\\n&quot; +\r\n                            &quot;                     \\&quot;desc\\&quot;:\\&quot;All feature types\\&quot;\\n&quot; +\r\n                            &quot;                  }\\n&quot; +\r\n                            &quot;               },\\n&quot; +\r\n                            &quot;               {\\n&quot; +\r\n                            &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\r\n                            &quot;                     \\&quot;code\\&quot;:\\&quot;D\\&quot;,\\n&quot; +\r\n                            &quot;                     \\&quot;desc\\&quot;:\\&quot;Series\\&quot;\\n&quot; +\r\n                            &quot;                  }\\n&quot; +\r\n                            &quot;               } \\n&quot; +\r\n                            &quot;            ]\\n&quot; +\r\n                            &quot;         }\\n&quot; +\r\n                            &quot;      },\\n&quot; +\r\n                            &quot;      {\\n&quot; +\r\n                            &quot;         \\&quot;model\\&quot;:{\\n&quot; +\r\n                            &quot;            \\&quot;code\\&quot;:\\&quot;kkpou\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;defaultLookup\\&quot;:\\&quot;false\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;type\\&quot;:\\&quot;UAT\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;name\\&quot;:\\&quot;Transit Custom\\&quot;,\\n&quot; +\r\n                            &quot;            \\&quot;feature_types\\&quot;:[\\n&quot; +\r\n                            &quot;               {\\n&quot; +\r\n                            &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\r\n                            &quot;                     \\&quot;code\\&quot;:\\&quot;F\\&quot;,\\n&quot; +\r\n                            &quot;                     \\&quot;desc\\&quot;:\\&quot;All feature types\\&quot;\\n&quot; +\r\n                            &quot;                  }\\n&quot; +\r\n                            &quot;               },\\n&quot; +\r\n                            &quot;               {\\n&quot; +\r\n                            &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\r\n                            &quot;                     \\&quot;code\\&quot;:\\&quot;G\\&quot;,\\n&quot; +\r\n                            &quot;                     \\&quot;desc\\&quot;:\\&quot;Series\\&quot;\\n&quot; +\r\n                            &quot;                  }\\n&quot; +\r\n                            &quot;               },\\n&quot; +\r\n                            &quot;               {\\n&quot; +\r\n                            &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\r\n                            &quot;                     \\&quot;code\\&quot;:\\&quot;H\\&quot;,\\n&quot; +\r\n                            &quot;                     \\&quot;desc\\&quot;:\\&quot;Payload\\&quot;\\n&quot; +\r\n                            &quot;                  }\\n&quot; +\r\n                            &quot;               }\\n&quot; +\r\n                            &quot;            ]\\n&quot; +\r\n                            &quot;         }\\n&quot; +\r\n                            &quot;      }\\n&quot; +\r\n                            &quot;   ]\\n&quot; +\r\n                            &quot;}&quot;;\r\n        \r\n        for(int i = 0; i&lt;myData.size();i++)\r\n            {\r\n                String type = &quot;SIT&quot;;\r\n    \t\t\tFeaturedItems item = resultList.stream().filter(featureItem -&gt; type != null &amp;&amp; type.equals(featureItem.getType())).findFirst().orElse(null);\r\n                if (type != null) {\r\n                    item = FeaturedItems.builder().type(type).items(new ArrayList&lt;&gt;()).build();\r\n                    resultList.add(item);//if the item already exists in the list don&#39;t add the new item, instead just add the elements in the exisiting item.\r\n     //tried the below commented code to add the item if it doesn&#39;t contain in the list -- start\r\n                      /*boolean flagFound = false;\r\n                        for (FeaturedItems featureItem : resultList) {\r\n                            if (featureItem.getType().equalsIgnoreCase(type)) {\r\n                                flagFound = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                      if(!flagFound) resultList.add(item);*/\r\n     //tried the above commented code to add the item if it doesn&#39;t contain in the list -- End\r\n                    for (int count = 0; count &lt; features.size(); count++) {\r\n                        String id = getFid(count);\r\n                        MyDataBuild build = ....//logic to set values in the properties\r\n                        item.getItems().add(build);\r\n                    }\r\n                }    \r\n            }\r\n          lookUpData.setFeatureGroups(resultList);\r\n        }   \r\n        }\r\n    \t\r\n\r\nIf the **type** value is already defined in the defined **featureItems**, then instead of creating the new object in the featureItems list, i need to add the **unique** items(desc,id) to the existing items element for the matching ***type***. The code snippet mentioned above doesn&#39;t add the elements to the existing items if the type is matching in the featureItems list, instead it is creating the new element as shown in the output json sample.","title":"avoid adding the same element if exist in the list instead just add the elements inside the existing list","body":"<p>Below is the sample code</p>\n<pre><code>                String jsonString = &quot;{\\n&quot; +\n                        &quot;   \\&quot;models\\&quot;:[\\n&quot; +\n                        &quot;      {\\n&quot; +\n                        &quot;         \\&quot;model\\&quot;:{\\n&quot; +\n                        &quot;            \\&quot;code\\&quot;:\\&quot;ALL\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;type\\&quot;:null,\\n&quot; +\n                        &quot;            \\&quot;name\\&quot;:\\&quot;ALL\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;feature_types\\&quot;:null\\n&quot; +\n                        &quot;         }\\n&quot; +\n                        &quot;      },\\n&quot; +\n                        &quot;      {\\n&quot; +\n                        &quot;         \\&quot;model\\&quot;:{\\n&quot; +\n                        &quot;            \\&quot;code\\&quot;:\\&quot;102e\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;defaultLookup\\&quot;:\\&quot;false\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;type\\&quot;:\\&quot;SIT\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;name\\&quot;:\\&quot;MUSTANG\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;feature_types\\&quot;:[\\n&quot; +\n                        &quot;               {\\n&quot; +\n                        &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\n                        &quot;                     \\&quot;code\\&quot;:\\&quot;A\\&quot;,\\n&quot; +\n                        &quot;                     \\&quot;desc\\&quot;:\\&quot;All feature types\\&quot;\\n&quot; +\n                        &quot;                  }\\n&quot; +\n                        &quot;               },\\n&quot; +\n                        &quot;               {\\n&quot; +\n                        &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\n                        &quot;                     \\&quot;code\\&quot;:\\&quot;B\\&quot;,\\n&quot; +\n                        &quot;                     \\&quot;desc\\&quot;:\\&quot;Series\\&quot;\\n&quot; +\n                        &quot;                  }\\n&quot; +\n                        &quot;               },\\n&quot; +\n                        &quot;               {\\n&quot; +\n                        &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\n                        &quot;                     \\&quot;code\\&quot;:\\&quot;C\\&quot;,\\n&quot; +\n                        &quot;                     \\&quot;desc\\&quot;:\\&quot;BodyStyle\\&quot;\\n&quot; +\n                        &quot;                  }\\n&quot; +\n                        &quot;               }\\n&quot; +\n                        &quot;            ]\\n&quot; +\n                        &quot;         }\\n&quot; +\n                        &quot;      },\\n&quot; +\n                        &quot;      {\\n&quot; +\n                        &quot;         \\&quot;model\\&quot;:{\\n&quot; +\n                        &quot;            \\&quot;code\\&quot;:\\&quot;980p\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;defaultLookup\\&quot;:\\&quot;false\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;type\\&quot;:\\&quot;SIT\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;name\\&quot;:\\&quot;Ranger\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;feature_types\\&quot;:[\\n&quot; +\n                        &quot;               {\\n&quot; +\n                        &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\n                        &quot;                     \\&quot;code\\&quot;:\\&quot;C\\&quot;,\\n&quot; +\n                        &quot;                     \\&quot;desc\\&quot;:\\&quot;All feature types\\&quot;\\n&quot; +\n                        &quot;                  }\\n&quot; +\n                        &quot;               },\\n&quot; +\n                        &quot;               {\\n&quot; +\n                        &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\n                        &quot;                     \\&quot;code\\&quot;:\\&quot;D\\&quot;,\\n&quot; +\n                        &quot;                     \\&quot;desc\\&quot;:\\&quot;Series\\&quot;\\n&quot; +\n                        &quot;                  }\\n&quot; +\n                        &quot;               } \\n&quot; +\n                        &quot;            ]\\n&quot; +\n                        &quot;         }\\n&quot; +\n                        &quot;      },\\n&quot; +\n                        &quot;      {\\n&quot; +\n                        &quot;         \\&quot;model\\&quot;:{\\n&quot; +\n                        &quot;            \\&quot;code\\&quot;:\\&quot;kkpou\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;defaultLookup\\&quot;:\\&quot;false\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;type\\&quot;:\\&quot;UAT\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;name\\&quot;:\\&quot;Transit Custom\\&quot;,\\n&quot; +\n                        &quot;            \\&quot;feature_types\\&quot;:[\\n&quot; +\n                        &quot;               {\\n&quot; +\n                        &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\n                        &quot;                     \\&quot;code\\&quot;:\\&quot;F\\&quot;,\\n&quot; +\n                        &quot;                     \\&quot;desc\\&quot;:\\&quot;All feature types\\&quot;\\n&quot; +\n                        &quot;                  }\\n&quot; +\n                        &quot;               },\\n&quot; +\n                        &quot;               {\\n&quot; +\n                        &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\n                        &quot;                     \\&quot;code\\&quot;:\\&quot;G\\&quot;,\\n&quot; +\n                        &quot;                     \\&quot;desc\\&quot;:\\&quot;Series\\&quot;\\n&quot; +\n                        &quot;                  }\\n&quot; +\n                        &quot;               },\\n&quot; +\n                        &quot;               {\\n&quot; +\n                        &quot;                  \\&quot;feature_type\\&quot;:{\\n&quot; +\n                        &quot;                     \\&quot;code\\&quot;:\\&quot;H\\&quot;,\\n&quot; +\n                        &quot;                     \\&quot;desc\\&quot;:\\&quot;Payload\\&quot;\\n&quot; +\n                        &quot;                  }\\n&quot; +\n                        &quot;               }\\n&quot; +\n                        &quot;            ]\\n&quot; +\n                        &quot;         }\\n&quot; +\n                        &quot;      }\\n&quot; +\n                        &quot;   ]\\n&quot; +\n                        &quot;}&quot;;\n    \n    for(int i = 0; i&lt;myData.size();i++)\n        {\n            String type = &quot;SIT&quot;;\n            FeaturedItems item = resultList.stream().filter(featureItem -&gt; type != null &amp;&amp; type.equals(featureItem.getType())).findFirst().orElse(null);\n            if (type != null) {\n                item = FeaturedItems.builder().type(type).items(new ArrayList&lt;&gt;()).build();\n                resultList.add(item);//if the item already exists in the list don't add the new item, instead just add the elements in the exisiting item.\n //tried the below commented code to add the item if it doesn't contain in the list -- start\n                  /*boolean flagFound = false;\n                    for (FeaturedItems featureItem : resultList) {\n                        if (featureItem.getType().equalsIgnoreCase(type)) {\n                            flagFound = true;\n                            break;\n                        }\n                    }\n                  if(!flagFound) resultList.add(item);*/\n //tried the above commented code to add the item if it doesn't contain in the list -- End\n                for (int count = 0; count &lt; features.size(); count++) {\n                    String id = getFid(count);\n                    MyDataBuild build = ....//logic to set values in the properties\n                    item.getItems().add(build);\n                }\n            }    \n        }\n      lookUpData.setFeatureGroups(resultList);\n    }   \n    }\n    \n</code></pre>\n<p>If the <strong>type</strong> value is already defined in the defined <strong>featureItems</strong>, then instead of creating the new object in the featureItems list, i need to add the <strong>unique</strong> items(desc,id) to the existing items element for the matching <em><strong>type</strong></em>. The code snippet mentioned above doesn't add the elements to the existing items if the type is matching in the featureItems list, instead it is creating the new element as shown in the output json sample.</p>\n"},{"tags":["java","selenium"],"answers":[{"tags":[],"owner":{"account_id":22886030,"reputation":1849,"user_id":17026900,"display_name":"Oussama ZAGHDOUD"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1640784154,"creation_date":1640774443,"answer_id":70518266,"question_id":70518025,"body_markdown":"If the `&quot;- Saved&quot;` is constant there, you can just replace it with `&quot;&quot;` :\r\n\r\n\r\n    protected String getCertID() {\r\n      String certIDKey = &quot;certID&quot;;\r\n      TestAction action = new TestAction(ActionType.SET_ELEMENT_TEXT,springContext);\r\n\r\n      action.setIdentifierType(&quot;xpath&quot;);\r\n      action.setIdentifierValue(&quot;//h1[contains(@data-id,&#39;header_title&#39;)]&quot;);\r\n      action.setValue(certIDKey);\r\n\r\n      action.perform(driverFactory,testContext);\r\n\r\n      log.info(&quot;CertID: &quot; + testContext.getVariable(certIDKey));\r\n    return testContext.getVariable(certIDKey).replace(&quot;- Saved&quot;, &quot;&quot;);\r\n    }\r\n","title":"Using Selenium and Java How to ignore part of an element in xpath","body":"<p>If the <code>&quot;- Saved&quot;</code> is constant there, you can just replace it with <code>&quot;&quot;</code> :</p>\n<pre><code>protected String getCertID() {\n  String certIDKey = &quot;certID&quot;;\n  TestAction action = new TestAction(ActionType.SET_ELEMENT_TEXT,springContext);\n\n  action.setIdentifierType(&quot;xpath&quot;);\n  action.setIdentifierValue(&quot;//h1[contains(@data-id,'header_title')]&quot;);\n  action.setValue(certIDKey);\n\n  action.perform(driverFactory,testContext);\n\n  log.info(&quot;CertID: &quot; + testContext.getVariable(certIDKey));\nreturn testContext.getVariable(certIDKey).replace(&quot;- Saved&quot;, &quot;&quot;);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6788662,"reputation":2778,"user_id":5226491,"display_name":"Max Daroshchanka"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641405935,"creation_date":1640774574,"answer_id":70518286,"question_id":70518025,"body_markdown":"If `h1` contain child elements, e.g. some `span` elements, and the exact text you want to get placed in some child element, like:\r\n\r\n```\r\n&lt;h1 data-id=&quot;header_title&quot;&gt;\r\n    &lt;span id=&quot;date&quot;&gt;21/2/467092&lt;/span&gt;\r\n    &lt;span&gt;- Saved&lt;/span&gt;\r\n&lt;/h1&gt;\r\n```\r\n\r\nyou can use\r\n\r\n```\r\n&quot;//h1[contains(@data-id,&#39;header_title&#39;)]/span[1]&quot;\r\n```\r\nor\r\n```\r\n&quot;//h1[contains(@data-id,&#39;header_title&#39;)]/span[@id=&#39;date&#39;]&quot;\r\n```\r\n\r\nOtherwise, for case:\r\n```\r\n&lt;h1 data-id=&quot;header_title&quot;&gt;21/2/467092- Saved&lt;/h1&gt;\r\n```\r\nor\r\n```\r\n&lt;h1 data-id=&quot;header_title&quot;&gt;\r\n    21/2/467092\r\n    &lt;span&gt;- Saved&lt;/span&gt;\r\n&lt;/h1&gt;\r\n```\r\nyou can only adjust the result text of `h1`\r\n```\r\n...\r\nString roughText = testContext.getVariable(certIDKey);\r\nreturn roughText.split(&quot;-&quot;)[0].trim();\r\n```","title":"Using Selenium and Java How to ignore part of an element in xpath","body":"<p>If <code>h1</code> contain child elements, e.g. some <code>span</code> elements, and the exact text you want to get placed in some child element, like:</p>\n<pre><code>&lt;h1 data-id=&quot;header_title&quot;&gt;\n    &lt;span id=&quot;date&quot;&gt;21/2/467092&lt;/span&gt;\n    &lt;span&gt;- Saved&lt;/span&gt;\n&lt;/h1&gt;\n</code></pre>\n<p>you can use</p>\n<pre><code>&quot;//h1[contains(@data-id,'header_title')]/span[1]&quot;\n</code></pre>\n<p>or</p>\n<pre><code>&quot;//h1[contains(@data-id,'header_title')]/span[@id='date']&quot;\n</code></pre>\n<p>Otherwise, for case:</p>\n<pre><code>&lt;h1 data-id=&quot;header_title&quot;&gt;21/2/467092- Saved&lt;/h1&gt;\n</code></pre>\n<p>or</p>\n<pre><code>&lt;h1 data-id=&quot;header_title&quot;&gt;\n    21/2/467092\n    &lt;span&gt;- Saved&lt;/span&gt;\n&lt;/h1&gt;\n</code></pre>\n<p>you can only adjust the result text of <code>h1</code></p>\n<pre><code>...\nString roughText = testContext.getVariable(certIDKey);\nreturn roughText.split(&quot;-&quot;)[0].trim();\n</code></pre>\n"}],"owner":{"account_id":6337970,"reputation":75,"user_id":4920850,"accept_rate":75,"display_name":"Steve"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":342,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1641405935,"creation_date":1640773028,"question_id":70518025,"body_markdown":"I have the method below:\r\n\r\n    protected String getCertID() {\r\n        String certIDKey = &quot;certID&quot;;\r\n        TestAction action = new TestAction(ActionType.SET_ELEMENT_TEXT,springContext);\r\n\r\n        action.setIdentifierType(&quot;xpath&quot;);\r\n        action.setIdentifierValue(&quot;//h1[contains(@data-id,&#39;header_title&#39;)]&quot;);\r\n        action.setValue(certIDKey);\r\n\r\n        action.perform(driverFactory,testContext);\r\n\r\n        log.info(&quot;CertID: &quot; + testContext.getVariable(certIDKey));\r\n        return testContext.getVariable(certIDKey);\r\n    }\r\n\r\nOutput of this method : 21/2/467092- Saved\r\n\r\nI require the method to return only: 21/2/467092 and ignore the - Saved part of element returned\r\n\r\n","title":"Using Selenium and Java How to ignore part of an element in xpath","body":"<p>I have the method below:</p>\n<pre><code>protected String getCertID() {\n    String certIDKey = &quot;certID&quot;;\n    TestAction action = new TestAction(ActionType.SET_ELEMENT_TEXT,springContext);\n\n    action.setIdentifierType(&quot;xpath&quot;);\n    action.setIdentifierValue(&quot;//h1[contains(@data-id,'header_title')]&quot;);\n    action.setValue(certIDKey);\n\n    action.perform(driverFactory,testContext);\n\n    log.info(&quot;CertID: &quot; + testContext.getVariable(certIDKey));\n    return testContext.getVariable(certIDKey);\n}\n</code></pre>\n<p>Output of this method : 21/2/467092- Saved</p>\n<p>I require the method to return only: 21/2/467092 and ignore the - Saved part of element returned</p>\n"},{"tags":["java","spring","spring-boot","transactions","microservices"],"answers":[{"tags":[],"owner":{"account_id":15464461,"reputation":161,"user_id":11156237,"display_name":"Serhat Ylmaz"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641394727,"creation_date":1641394727,"answer_id":70595025,"question_id":70594639,"body_markdown":"You can use a message queue like Kafka or RabbitMQ. Because you faced an issue known as two-phase commit. You can use [transactional outbox pattern][1] that is widely used in projects which consist of microservices.\r\n\r\n\r\n  [1]: https://microservices.io/patterns/data/transactional-outbox.html","title":"Update database using events in Springboot","body":"<p>You can use a message queue like Kafka or RabbitMQ. Because you faced an issue known as two-phase commit. You can use <a href=\"https://microservices.io/patterns/data/transactional-outbox.html\" rel=\"nofollow noreferrer\">transactional outbox pattern</a> that is widely used in projects which consist of microservices.</p>\n"},{"tags":[],"owner":{"account_id":1593091,"reputation":898,"user_id":1476031,"display_name":"Sharad"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641405836,"creation_date":1641405836,"answer_id":70597552,"question_id":70594639,"body_markdown":"Spring already provides a consistent programming model for transactions. You can use \r\n\r\n&gt; @Transactional\r\n\r\n to achieve this.\r\n\r\nYou can read more about transactional annotation in the official documentation \r\nhttps://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/transaction/annotation/Transactional.html\r\n","title":"Update database using events in Springboot","body":"<p>Spring already provides a consistent programming model for transactions. You can use</p>\n<blockquote>\n<p>@Transactional</p>\n</blockquote>\n<p>to achieve this.</p>\n<p>You can read more about transactional annotation in the official documentation\n<a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/transaction/annotation/Transactional.html\" rel=\"nofollow noreferrer\">https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/transaction/annotation/Transactional.html</a></p>\n"}],"owner":{"account_id":3412797,"reputation":305,"user_id":2862385,"display_name":"maverickabhi"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":481,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1641405836,"creation_date":1641393112,"question_id":70594639,"body_markdown":"I have a requirement to update a database using events in Springboot microservice. Each microservice has its own persistent layer. Microservices are communicating with each other using REST API&#39;s.\r\n\r\n**Scenario:** \r\n\r\n\r\nI have two microservices - **Vendor microservice** with **vendor DB** and **Order microservice** with **order DB**. When a request is received by the vendor microservice, it will update the vendor Db and also add an order in the order DB and all this should be done in one transaction. \r\n\r\nI cannot use a REST API for calling the vendor service to update the order. If any transaction fails, everything should be rolled back. How can I achieve this using events or something similar?","title":"Update database using events in Springboot","body":"<p>I have a requirement to update a database using events in Springboot microservice. Each microservice has its own persistent layer. Microservices are communicating with each other using REST API's.</p>\n<p><strong>Scenario:</strong></p>\n<p>I have two microservices - <strong>Vendor microservice</strong> with <strong>vendor DB</strong> and <strong>Order microservice</strong> with <strong>order DB</strong>. When a request is received by the vendor microservice, it will update the vendor Db and also add an order in the order DB and all this should be done in one transaction.</p>\n<p>I cannot use a REST API for calling the vendor service to update the order. If any transaction fails, everything should be rolled back. How can I achieve this using events or something similar?</p>\n"},{"tags":["java","visual-studio-code"],"answers":[{"tags":[],"owner":{"account_id":22574869,"reputation":163,"user_id":16760536,"display_name":"bibu3344"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1641405740,"creation_date":1641405740,"answer_id":70597537,"question_id":70596679,"body_markdown":"This feature is not supported at the moment. \r\nhttps://github.com/redhat-developer/vscode-java/issues/2274","title":"How to sort members in VSCode (java)?","body":"<p>This feature is not supported at the moment.\n<a href=\"https://github.com/redhat-developer/vscode-java/issues/2274\" rel=\"nofollow noreferrer\">https://github.com/redhat-developer/vscode-java/issues/2274</a></p>\n"}],"owner":{"account_id":22574869,"reputation":163,"user_id":16760536,"display_name":"bibu3344"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":911,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":70597537,"answer_count":1,"score":0,"last_activity_date":1641405740,"creation_date":1641401916,"question_id":70596679,"body_markdown":"In Eclipse there is an option that sorts the code automatically `source &gt; sort members &gt; all members`.\r\n\r\n[![enter image description here][1]][1]\r\n\r\nBe careful not to be confused with refactoring. I am not looking to indent the code but to reorder the methods. \r\n\r\nDoes anyone know how I can do the same in VSCode?\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/4QUJk.png","title":"How to sort members in VSCode (java)?","body":"<p>In Eclipse there is an option that sorts the code automatically <code>source &gt; sort members &gt; all members</code>.</p>\n<p><a href=\"https://i.stack.imgur.com/4QUJk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4QUJk.png\" alt=\"enter image description here\" /></a></p>\n<p>Be careful not to be confused with refactoring. I am not looking to indent the code but to reorder the methods.</p>\n<p>Does anyone know how I can do the same in VSCode?</p>\n"},{"tags":["java","jvm","jvm-hotspot"],"comments":[{"owner":{"account_id":11834,"reputation":10018,"user_id":23023,"accept_rate":75,"display_name":"conny"},"score":1,"creation_date":1629452539,"post_id":198577,"comment_id":121696122,"body_markdown":"Short answer: if you&#39;re reading this today, using 64-bit &gt;= Java 8 in some cloud ... nah.","body":"Short answer: if you&#39;re reading this today, using 64-bit &gt;= Java 8 in some cloud ... nah."}],"answers":[{"tags":[],"owner":{"account_id":8655,"reputation":20729,"user_id":15689,"accept_rate":91,"display_name":"Brian Knoblauch"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1223923507,"creation_date":1223923507,"answer_id":198598,"question_id":198577,"body_markdown":"I&#39;ve not noticed any difference in startup time between the 2, but clocked a very minimal improvement in application performance with &quot;-server&quot; (Solaris server, everyone using SunRays to run the app).  That was under 1.5.","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>I've not noticed any difference in startup time between the 2, but clocked a very minimal improvement in application performance with \"-server\" (Solaris server, everyone using SunRays to run the app).  That was under 1.5.</p>\n"},{"tags":[],"owner":{"account_id":9331,"reputation":12049,"user_id":17188,"accept_rate":77,"display_name":"Mike Akers"},"down_vote_count":1,"up_vote_count":16,"is_accepted":false,"score":15,"last_activity_date":1223923738,"creation_date":1223923738,"answer_id":198616,"question_id":198577,"body_markdown":"IIRC the server VM does more hotspot optimizations at startup so it runs faster but takes a little longer to start and uses more memory. The client VM defers most of the optimization to allow faster startup.\r\n\r\nEdit to add: [Here&#39;s some info][1] from Sun, it&#39;s not very specific but will give you some ideas.\r\n\r\n\r\n  [1]: http://java.sun.com/docs/hotspot/HotSpotFAQ.html#compiler_types","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>IIRC the server VM does more hotspot optimizations at startup so it runs faster but takes a little longer to start and uses more memory. The client VM defers most of the optimization to allow faster startup.</p>\n\n<p>Edit to add: <a href=\"http://java.sun.com/docs/hotspot/HotSpotFAQ.html#compiler_types\" rel=\"noreferrer\">Here's some info</a> from Sun, it's not very specific but will give you some ideas.</p>\n"},{"tags":[],"owner":{"account_id":7332,"reputation":23983,"user_id":12704,"accept_rate":75,"display_name":"Michael Easter"},"down_vote_count":1,"up_vote_count":6,"is_accepted":false,"score":5,"last_activity_date":1223924246,"creation_date":1223924246,"answer_id":198649,"question_id":198577,"body_markdown":"\r\nIIRC, it involves garbage collection strategies.  The theory is that a client and server will be different in terms of short-lived objects, which is important for modern GC algorithms.\r\n\r\n[Here is a link][1] on server mode.  Alas, they don&#39;t mention client mode.\r\n\r\n[Here is a very thorough link][2] on GC in general; this is a [more basic article][3]. Not sure if either address -server vs -client but this is relevant material.\r\n\r\nAt No Fluff Just Stuff, both Ken Sipe and Glenn Vandenburg do great talks on this kind of thing.\r\n\r\n\r\n  [1]: http://www.jivesoftware.com/community/docs/DOC-1486\r\n  [2]: http://www.artima.com/insidejvm/ed2/gc.html\r\n  [3]: http://chaoticjava.com/posts/how-does-garbage-collection-work/","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>IIRC, it involves garbage collection strategies.  The theory is that a client and server will be different in terms of short-lived objects, which is important for modern GC algorithms.</p>\n\n<p><a href=\"http://www.jivesoftware.com/community/docs/DOC-1486\" rel=\"noreferrer\">Here is a link</a> on server mode.  Alas, they don't mention client mode.</p>\n\n<p><a href=\"http://www.artima.com/insidejvm/ed2/gc.html\" rel=\"noreferrer\">Here is a very thorough link</a> on GC in general; this is a <a href=\"http://chaoticjava.com/posts/how-does-garbage-collection-work/\" rel=\"noreferrer\">more basic article</a>. Not sure if either address -server vs -client but this is relevant material.</p>\n\n<p>At No Fluff Just Stuff, both Ken Sipe and Glenn Vandenburg do great talks on this kind of thing.</p>\n"},{"tags":[],"owner":{"account_id":4243,"reputation":1301840,"user_id":6309,"accept_rate":100,"display_name":"VonC"},"down_vote_count":0,"up_vote_count":397,"is_accepted":true,"score":397,"last_activity_date":1641405460,"creation_date":1223924265,"answer_id":198651,"question_id":198577,"body_markdown":"This is really linked to *HotSpot* and the default *option values* ([Java HotSpot VM Options][1]) which differ between client and server configuration.\r\n\r\nFrom [Chapter 2][2] of the whitepaper ([The Java HotSpot Performance Engine Architecture][3]):\r\n\r\n&gt; The JDK includes two flavors of the VM -- a client-side offering, and a VM tuned for server applications. These two solutions share the Java HotSpot runtime environment code base, but use different compilers that are suited to the distinctly unique performance characteristics of clients and servers. These differences include the compilation inlining policy and heap defaults. \r\n&gt;\r\n&gt; Although the Server and the Client VMs are similar, the Server VM has been specially tuned to maximize peak operating speed. It is intended for executing long-running server applications, which need the fastest possible operating speed more than a fast start-up time or smaller runtime memory footprint.\r\n&gt;\r\n&gt; The Client VM compiler serves as an upgrade for both the Classic VM and the just-in-time (JIT) compilers used by previous versions of the JDK. The Client VM offers improved run time performance for applications and applets. The Java HotSpot Client VM has been specially tuned to reduce application start-up time and memory footprint, making it particularly well suited for client environments. In general, the client system is better for GUIs. \r\n\r\nSo the real difference is also on the compiler level:\r\n\r\n&gt; The Client VM compiler does not try to execute many of the more complex optimizations performed by the compiler in the Server VM, but in exchange, it requires less time to analyze and compile a piece of code. This means the Client VM can start up faster and requires a smaller memory footprint.\r\n&gt;\r\n&gt; The Server VM contains an advanced adaptive compiler that supports many of the same types of optimizations performed by optimizing C++ compilers, as well as some optimizations that cannot be done by traditional compilers, such as aggressive inlining across virtual method invocations. This is a competitive and performance advantage over static compilers. Adaptive optimization technology is very flexible in its approach, and typically outperforms even advanced static analysis and compilation techniques. \r\n\r\nNote: The release of *jdk6 update 10* (see [Update Release Notes:Changes in 1.6.0_10][4]) tried to improve startup time, but for a different reason than the hotspot options, being packaged differently with a much smaller kernel.\r\n\r\n-----\r\n\r\n[G. Demecki][5] points out [in the comments][6] that in 64-bit versions of JDK, the `-client` option is ignored for many years.  \r\nSee [Windows `java` command][7]:\r\n\r\n    -client\r\n\r\n\r\n&gt; Selects the Java HotSpot Client VM.  \r\n**A 64-bit capable JDK currently ignores this option and instead uses the Java Hotspot Server VM**.\r\n\r\n----\r\n\r\n2022: [Holger][8] references in [the comments][9] the [JavaSE6 / Server-Class Machine Detection][10], adding:\r\n\r\n&gt;  Only on 32 bit Windows systems, `-client` was ever chosen unconditionally.  \r\nOther systems checked whether the machine was server class which was fulfilled when having at least 2 cores and at least 2GiB of memory. \r\n&gt;\r\n&gt; Which explains why almost everything uses `-server` for quite some time now. Even the cheapest computers you can find, are server class machines. The Sun/Oracle 64 builds did not even ship with a client JVM.\r\n\r\n\r\n  [1]: http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html\r\n  [2]: http://www.oracle.com/technetwork/java/whitepaper-135217.html#2\r\n  [3]: http://www.oracle.com/technetwork/java/whitepaper-135217.html\r\n  [4]: http://www.oracle.com/technetwork/java/javase/6u10-142936.html\r\n  [5]: https://stackoverflow.com/users/1037316/g-demecki\r\n  [6]: https://stackoverflow.com/questions/198577/real-differences-between-java-server-and-java-client/198651?noredirect=1#comment59707599_198651\r\n  [7]: https://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html\r\n  [8]: https://stackoverflow.com/users/2711488/holger\r\n  [9]: https://stackoverflow.com/questions/198577/real-differences-between-java-server-and-java-client/198651?noredirect=1#comment124789844_198651\r\n  [10]: https://docs.oracle.com/javase/6/docs/technotes/guides/vm/server-class.html","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>This is really linked to <em>HotSpot</em> and the default <em>option values</em> (<a href=\"http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html\" rel=\"noreferrer\">Java HotSpot VM Options</a>) which differ between client and server configuration.</p>\n<p>From <a href=\"http://www.oracle.com/technetwork/java/whitepaper-135217.html#2\" rel=\"noreferrer\">Chapter 2</a> of the whitepaper (<a href=\"http://www.oracle.com/technetwork/java/whitepaper-135217.html\" rel=\"noreferrer\">The Java HotSpot Performance Engine Architecture</a>):</p>\n<blockquote>\n<p>The JDK includes two flavors of the VM -- a client-side offering, and a VM tuned for server applications. These two solutions share the Java HotSpot runtime environment code base, but use different compilers that are suited to the distinctly unique performance characteristics of clients and servers. These differences include the compilation inlining policy and heap defaults.</p>\n<p>Although the Server and the Client VMs are similar, the Server VM has been specially tuned to maximize peak operating speed. It is intended for executing long-running server applications, which need the fastest possible operating speed more than a fast start-up time or smaller runtime memory footprint.</p>\n<p>The Client VM compiler serves as an upgrade for both the Classic VM and the just-in-time (JIT) compilers used by previous versions of the JDK. The Client VM offers improved run time performance for applications and applets. The Java HotSpot Client VM has been specially tuned to reduce application start-up time and memory footprint, making it particularly well suited for client environments. In general, the client system is better for GUIs.</p>\n</blockquote>\n<p>So the real difference is also on the compiler level:</p>\n<blockquote>\n<p>The Client VM compiler does not try to execute many of the more complex optimizations performed by the compiler in the Server VM, but in exchange, it requires less time to analyze and compile a piece of code. This means the Client VM can start up faster and requires a smaller memory footprint.</p>\n<p>The Server VM contains an advanced adaptive compiler that supports many of the same types of optimizations performed by optimizing C++ compilers, as well as some optimizations that cannot be done by traditional compilers, such as aggressive inlining across virtual method invocations. This is a competitive and performance advantage over static compilers. Adaptive optimization technology is very flexible in its approach, and typically outperforms even advanced static analysis and compilation techniques.</p>\n</blockquote>\n<p>Note: The release of <em>jdk6 update 10</em> (see <a href=\"http://www.oracle.com/technetwork/java/javase/6u10-142936.html\" rel=\"noreferrer\">Update Release Notes:Changes in 1.6.0_10</a>) tried to improve startup time, but for a different reason than the hotspot options, being packaged differently with a much smaller kernel.</p>\n<hr />\n<p><a href=\"https://stackoverflow.com/users/1037316/g-demecki\">G. Demecki</a> points out <a href=\"https://stackoverflow.com/questions/198577/real-differences-between-java-server-and-java-client/198651?noredirect=1#comment59707599_198651\">in the comments</a> that in 64-bit versions of JDK, the <code>-client</code> option is ignored for many years.<br />\nSee <a href=\"https://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html\" rel=\"noreferrer\">Windows <code>java</code> command</a>:</p>\n<pre><code>-client\n</code></pre>\n<blockquote>\n<p>Selects the Java HotSpot Client VM.<br />\n<strong>A 64-bit capable JDK currently ignores this option and instead uses the Java Hotspot Server VM</strong>.</p>\n</blockquote>\n<hr />\n<p>2022: <a href=\"https://stackoverflow.com/users/2711488/holger\">Holger</a> references in <a href=\"https://stackoverflow.com/questions/198577/real-differences-between-java-server-and-java-client/198651?noredirect=1#comment124789844_198651\">the comments</a> the <a href=\"https://docs.oracle.com/javase/6/docs/technotes/guides/vm/server-class.html\" rel=\"noreferrer\">JavaSE6 / Server-Class Machine Detection</a>, adding:</p>\n<blockquote>\n<p>Only on 32 bit Windows systems, <code>-client</code> was ever chosen unconditionally.<br />\nOther systems checked whether the machine was server class which was fulfilled when having at least 2 cores and at least 2GiB of memory.</p>\n<p>Which explains why almost everything uses <code>-server</code> for quite some time now. Even the cheapest computers you can find, are server class machines. The Sun/Oracle 64 builds did not even ship with a client JVM.</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":10659,"reputation":2546,"user_id":20242,"accept_rate":33,"display_name":"prule"},"down_vote_count":0,"up_vote_count":34,"is_accepted":false,"score":34,"last_activity_date":1553327042,"creation_date":1285222298,"answer_id":3775811,"question_id":198577,"body_markdown":"One difference I&#39;ve just noticed is that in &quot;client&quot; mode, it seems the JVM actually gives some unused memory back to the operating system, whereas with &quot;server&quot; mode, once the JVM grabs the memory, it won&#39;t give it back. Thats how it appears on Solaris with Java6 anyway (using `prstat -Z` to see the amount of memory allocated to a process).","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>One difference I've just noticed is that in \"client\" mode, it seems the JVM actually gives some unused memory back to the operating system, whereas with \"server\" mode, once the JVM grabs the memory, it won't give it back. Thats how it appears on Solaris with Java6 anyway (using <code>prstat -Z</code> to see the amount of memory allocated to a process).</p>\n"},{"tags":[],"owner":{"account_id":18514,"reputation":7704,"user_id":42473,"accept_rate":52,"display_name":"Mark Booth"},"down_vote_count":0,"up_vote_count":94,"is_accepted":false,"score":94,"last_activity_date":1578318931,"creation_date":1345198659,"answer_id":12003938,"question_id":198577,"body_markdown":"The most visible immediate difference in older versions of Java would be the memory allocated to a `-client` as opposed to a `-server` application. For instance, on my Linux system, I get:\r\n\r\n    $ java -XX:+PrintFlagsFinal -version 2&gt;&amp;1 | grep -i -E &#39;heapsize|permsize|version&#39;\r\n    uintx AdaptivePermSizeWeight               = 20               {product}\r\n    uintx ErgoHeapSizeLimit                    = 0                {product}\r\n    uintx InitialHeapSize                     := 66328448         {product}\r\n    uintx LargePageHeapSizeThreshold           = 134217728        {product}\r\n    uintx MaxHeapSize                         := 1063256064       {product}\r\n    uintx MaxPermSize                          = 67108864         {pd product}\r\n    uintx PermSize                             = 16777216         {pd product}\r\n    java version &quot;1.6.0_24&quot;\r\n\r\nas it defaults to `-server`, but with the `-client` option I get:\r\n\r\n    $ java -client -XX:+PrintFlagsFinal -version 2&gt;&amp;1 | grep -i -E &#39;heapsize|permsize|version&#39;\r\n    uintx AdaptivePermSizeWeight               = 20               {product}\r\n    uintx ErgoHeapSizeLimit                    = 0                {product}\r\n    uintx InitialHeapSize                     := 16777216         {product}\r\n    uintx LargePageHeapSizeThreshold           = 134217728        {product}\r\n    uintx MaxHeapSize                         := 268435456        {product}\r\n    uintx MaxPermSize                          = 67108864         {pd product}\r\n    uintx PermSize                             = 12582912         {pd product}\r\n    java version &quot;1.6.0_24&quot;\r\n\r\nso with `-server` most of the memory limits and initial allocations are much higher for this `java` version.\r\n\r\nThese values can change for different combinations of architecture, operating system and jvm version however. Recent versions of the jvm have removed flags and re-moved many of the distinctions between server and client.\r\n\r\nRemember too that you can see all the details of a running `jvm` using `jvisualvm`. This is useful if you have users who or modules which set `JAVA_OPTS` or use scripts which change command line options. This will also let you monitor, in real time, _heap_ and _permgen_ space usage along with lots of other stats.","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>The most visible immediate difference in older versions of Java would be the memory allocated to a <code>-client</code> as opposed to a <code>-server</code> application. For instance, on my Linux system, I get:</p>\n\n<pre><code>$ java -XX:+PrintFlagsFinal -version 2&gt;&amp;1 | grep -i -E 'heapsize|permsize|version'\nuintx AdaptivePermSizeWeight               = 20               {product}\nuintx ErgoHeapSizeLimit                    = 0                {product}\nuintx InitialHeapSize                     := 66328448         {product}\nuintx LargePageHeapSizeThreshold           = 134217728        {product}\nuintx MaxHeapSize                         := 1063256064       {product}\nuintx MaxPermSize                          = 67108864         {pd product}\nuintx PermSize                             = 16777216         {pd product}\njava version \"1.6.0_24\"\n</code></pre>\n\n<p>as it defaults to <code>-server</code>, but with the <code>-client</code> option I get:</p>\n\n<pre><code>$ java -client -XX:+PrintFlagsFinal -version 2&gt;&amp;1 | grep -i -E 'heapsize|permsize|version'\nuintx AdaptivePermSizeWeight               = 20               {product}\nuintx ErgoHeapSizeLimit                    = 0                {product}\nuintx InitialHeapSize                     := 16777216         {product}\nuintx LargePageHeapSizeThreshold           = 134217728        {product}\nuintx MaxHeapSize                         := 268435456        {product}\nuintx MaxPermSize                          = 67108864         {pd product}\nuintx PermSize                             = 12582912         {pd product}\njava version \"1.6.0_24\"\n</code></pre>\n\n<p>so with <code>-server</code> most of the memory limits and initial allocations are much higher for this <code>java</code> version.</p>\n\n<p>These values can change for different combinations of architecture, operating system and jvm version however. Recent versions of the jvm have removed flags and re-moved many of the distinctions between server and client.</p>\n\n<p>Remember too that you can see all the details of a running <code>jvm</code> using <code>jvisualvm</code>. This is useful if you have users who or modules which set <code>JAVA_OPTS</code> or use scripts which change command line options. This will also let you monitor, in real time, <em>heap</em> and <em>permgen</em> space usage along with lots of other stats.</p>\n"},{"tags":[],"owner":{"account_id":60800,"reputation":1229,"user_id":181506,"accept_rate":60,"display_name":"pharsicle"},"down_vote_count":0,"up_vote_count":24,"is_accepted":false,"score":24,"last_activity_date":1363590906,"creation_date":1363590906,"answer_id":15471505,"question_id":198577,"body_markdown":"Oracles online documentation provides some information for Java SE 7.\r\n\r\nOn the [java  the Java application launcher][java] page for Windows, the `-client` option is ignored in a 64-bit JDK:\r\n\r\n&gt; Select the Java HotSpot Client VM. A 64-bit capable jdk currently ignores this option and instead uses the Java HotSpot Server VM. \r\n\r\nHowever (to make things interesting), under `-server` it states:\r\n\r\n&gt; Select the Java HotSpot Server VM. On a 64-bit capable jdk only the Java HotSpot Server VM is supported so the -server option is implicit. This is subject to change in a future release. \r\n\r\nThe [Server-Class Machine Detection][server-class] page gives information on which VM is selected by OS and architecture.\r\n\r\nI dont know how much of this applies to JDK 6.\r\n\r\n[java]: http://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html\r\n[server-class]: http://docs.oracle.com/javase/7/docs/technotes/guides/vm/server-class.html","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>Oracles online documentation provides some information for Java SE 7.</p>\n\n<p>On the <a href=\"http://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html\">java  the Java application launcher</a> page for Windows, the <code>-client</code> option is ignored in a 64-bit JDK:</p>\n\n<blockquote>\n  <p>Select the Java HotSpot Client VM. A 64-bit capable jdk currently ignores this option and instead uses the Java HotSpot Server VM. </p>\n</blockquote>\n\n<p>However (to make things interesting), under <code>-server</code> it states:</p>\n\n<blockquote>\n  <p>Select the Java HotSpot Server VM. On a 64-bit capable jdk only the Java HotSpot Server VM is supported so the -server option is implicit. This is subject to change in a future release. </p>\n</blockquote>\n\n<p>The <a href=\"http://docs.oracle.com/javase/7/docs/technotes/guides/vm/server-class.html\">Server-Class Machine Detection</a> page gives information on which VM is selected by OS and architecture.</p>\n\n<p>I dont know how much of this applies to JDK 6.</p>\n"},{"tags":[],"owner":{"account_id":47370,"reputation":24537,"user_id":140264,"accept_rate":82,"display_name":"brice"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1363973221,"creation_date":1363964003,"answer_id":15573364,"question_id":198577,"body_markdown":"Last time I had a look at this, (and admittedly it was a while back) the biggest difference I noticed was in the garbage collection. \r\n\r\nIIRC:\r\n\r\n * The server heap VM has a differnt number of generations than the Client VM, and a different garbage collection algorithm. **This may not be true anymore**\r\n * The server VM will allocate memory and not release it to the OS\r\n * The server VM will use more sophisticated optimisation algorithms, and hence have bigger time and memory requirements for optimisation\r\n\r\n&lt;s&gt;If you can compare two java VMs, one client, one server using the [jvisualvm](http://visualvm.java.net/) tool, you should see a difference in the frequency and effect of the garbage collection, as well as in the number of generations. \r\n\r\nI had a pair of screenshots that showed the difference really well, but I can&#39;t reproduce as I have a 64 bit JVM which only implements the server VM. (And I can&#39;t be bothered to download and wrangle the 32 bit version on my system as well.)&lt;/s&gt;\r\n\r\nThis doesn&#39;t seem to be the case anymore, having tried running some code on windows with both server and client VMs, I seem to get the same generation model for both...","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>Last time I had a look at this, (and admittedly it was a while back) the biggest difference I noticed was in the garbage collection. </p>\n\n<p>IIRC:</p>\n\n<ul>\n<li>The server heap VM has a differnt number of generations than the Client VM, and a different garbage collection algorithm. <strong>This may not be true anymore</strong></li>\n<li>The server VM will allocate memory and not release it to the OS</li>\n<li>The server VM will use more sophisticated optimisation algorithms, and hence have bigger time and memory requirements for optimisation</li>\n</ul>\n\n<p><s>If you can compare two java VMs, one client, one server using the <a href=\"http://visualvm.java.net/\" rel=\"nofollow\">jvisualvm</a> tool, you should see a difference in the frequency and effect of the garbage collection, as well as in the number of generations. </p>\n\n<p>I had a pair of screenshots that showed the difference really well, but I can't reproduce as I have a 64 bit JVM which only implements the server VM. (And I can't be bothered to download and wrangle the 32 bit version on my system as well.)</s></p>\n\n<p>This doesn't seem to be the case anymore, having tried running some code on windows with both server and client VMs, I seem to get the same generation model for both...</p>\n"},{"tags":[],"owner":{"account_id":278213,"reputation":693,"user_id":572675,"accept_rate":0,"display_name":"Nuwan Arambage"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1553327098,"creation_date":1427010405,"answer_id":29192128,"question_id":198577,"body_markdown":"When doing a migration from 1.4 to 1.7(&quot;1.7.0_55&quot;) version.The thing that we observed here is, there is no such differences in default values assigned to heapsize|permsize|ThreadStackSize parameters in client &amp; server mode. \r\n\r\nBy the way, (http://www.oracle.com/technetwork/java/ergo5-140223.html). This is the snippet taken from above link.\r\n\r\n    initial heap size of 1/64 of physical memory up to 1Gbyte\r\n    maximum heap size of &#188; of physical memory up to 1Gbyte\r\n\r\nThreadStackSize is higher in 1.7, while going through Open JDK forum,there are discussions which stated frame size is somewhat higher in 1.7 version.\r\nIt is believed real difference could be possible to measure at run time based on your behavior of your application","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>When doing a migration from 1.4 to 1.7(\"1.7.0_55\") version.The thing that we observed here is, there is no such differences in default values assigned to heapsize|permsize|ThreadStackSize parameters in client &amp; server mode. </p>\n\n<p>By the way, (<a href=\"http://www.oracle.com/technetwork/java/ergo5-140223.html\" rel=\"nofollow noreferrer\">http://www.oracle.com/technetwork/java/ergo5-140223.html</a>). This is the snippet taken from above link.</p>\n\n<pre><code>initial heap size of 1/64 of physical memory up to 1Gbyte\nmaximum heap size of  of physical memory up to 1Gbyte\n</code></pre>\n\n<p>ThreadStackSize is higher in 1.7, while going through Open JDK forum,there are discussions which stated frame size is somewhat higher in 1.7 version.\nIt is believed real difference could be possible to measure at run time based on your behavior of your application</p>\n"},{"tags":[],"owner":{"account_id":1875874,"reputation":71911,"user_id":1697099,"accept_rate":100,"display_name":"Premraj"},"down_vote_count":0,"up_vote_count":40,"is_accepted":false,"score":40,"last_activity_date":1438964098,"creation_date":1438948476,"answer_id":31877125,"question_id":198577,"body_markdown":" the -client and -server systems are different binaries. They are essentially two different compilers (JITs) interfacing to the same runtime system. The client system is optimal for applications which need fast startup times or small footprints, the server system is optimal for applications where the overall performance is most important. In general the client system is better suited for interactive applications such as GUIs  \r\n\r\n[![enter image description here][1]][1]\r\n\r\nWe run the following code with both switches:\r\n\r\n\r\n    package com.blogspot.sdoulger;\r\n    \r\n    public class LoopTest {\r\n        public LoopTest() {\r\n            super();\r\n        }\r\n    \r\n        public static void main(String[] args) {\r\n            long start = System.currentTimeMillis();\r\n            spendTime();\r\n            long end = System.currentTimeMillis();\r\n            System.out.println(&quot;Time spent: &quot;+ (end-start));\r\n            \r\n            LoopTest loopTest = new LoopTest();\r\n        }\r\n    \r\n        private static void spendTime() {\r\n            for (int i =500000000;i&gt;0;i--) {\r\n            }\r\n        }\r\n    }\r\n\r\n**Note:** The code is been compiled only once! The classes are the same in both runs!\r\n\r\n**With -client:**  \r\n java.exe -client -classpath C:\\mywork\\classes com.blogspot.sdoulger.LoopTest  \r\n Time spent: 766  \r\n\r\n**With -server:**  \r\n java.exe -server -classpath C:\\mywork\\classes com.blogspot.sdoulger.LoopTest  \r\n Time spent: 0  \r\n\r\nIt seems that the more aggressive optimazation of the server system, remove the loop as it understands that it does not perform any action!\r\n\r\n\r\n[Reference][2]\r\n\r\n\r\n  [1]: http://i.stack.imgur.com/zkWjn.gif\r\n  [2]: http://www.javacodegeeks.com/2011/07/jvm-options-client-vs-server.html","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>the -client and -server systems are different binaries. They are essentially two different compilers (JITs) interfacing to the same runtime system. The client system is optimal for applications which need fast startup times or small footprints, the server system is optimal for applications where the overall performance is most important. In general the client system is better suited for interactive applications such as GUIs  </p>\n\n<p><a href=\"https://i.stack.imgur.com/zkWjn.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/zkWjn.gif\" alt=\"enter image description here\"></a></p>\n\n<p>We run the following code with both switches:</p>\n\n<pre><code>package com.blogspot.sdoulger;\n\npublic class LoopTest {\n    public LoopTest() {\n        super();\n    }\n\n    public static void main(String[] args) {\n        long start = System.currentTimeMillis();\n        spendTime();\n        long end = System.currentTimeMillis();\n        System.out.println(\"Time spent: \"+ (end-start));\n\n        LoopTest loopTest = new LoopTest();\n    }\n\n    private static void spendTime() {\n        for (int i =500000000;i&gt;0;i--) {\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Note:</strong> The code is been compiled only once! The classes are the same in both runs!</p>\n\n<p><strong>With -client:</strong><br>\n java.exe -client -classpath C:\\mywork\\classes com.blogspot.sdoulger.LoopTest<br>\n Time spent: 766  </p>\n\n<p><strong>With -server:</strong><br>\n java.exe -server -classpath C:\\mywork\\classes com.blogspot.sdoulger.LoopTest<br>\n Time spent: 0  </p>\n\n<p>It seems that the more aggressive optimazation of the server system, remove the loop as it understands that it does not perform any action!</p>\n\n<p><a href=\"http://www.javacodegeeks.com/2011/07/jvm-options-client-vs-server.html\" rel=\"noreferrer\">Reference</a></p>\n"},{"tags":[],"owner":{"account_id":1474388,"reputation":5265,"user_id":1385174,"accept_rate":60,"display_name":"Adam"},"down_vote_count":0,"up_vote_count":18,"is_accepted":false,"score":18,"last_activity_date":1640171246,"creation_date":1457605783,"answer_id":35913837,"question_id":198577,"body_markdown":"From Goetz - Java Concurrency in Practice:\r\n\r\n&gt; 6. Debugging tip: For server applications, be sure to always specify the `-server` JVM command line switch when invoking the JVM, **even for\r\n&gt; development and testing**. The server JVM performs more optimization\r\n&gt; than the client JVM, such as hoisting variables out of a loop that are\r\n&gt; not modified in the loop; code that might appear to work in the\r\n&gt; development environment (client JVM) can break in the deployment\r\n&gt; environment (server JVM). For example, had we forgotten to declare\r\n&gt; the variable asleep as volatile in Listing 3.4, **the server JVM could\r\n&gt; hoist the test out of the loop (turning it into an infinite loop), but\r\n&gt; the client JVM would not**. An infinite loop that shows up in\r\n&gt; development is far less costly than one that only shows up in\r\n&gt; production.\r\n\r\n&gt; Listing 3.4. Counting sheep.\r\n&gt;\r\n&gt; ```java\r\n&gt; volatile boolean asleep;\r\n&gt; ...\r\n&gt; while (!asleep)\r\n&gt;    countSomeSheep();\r\n&gt; ```\r\n\r\nMy emphasis. YMMV","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>From Goetz - Java Concurrency in Practice:</p>\n<blockquote>\n<ol start=\"6\">\n<li>Debugging tip: For server applications, be sure to always specify the <code>-server</code> JVM command line switch when invoking the JVM, <strong>even for\ndevelopment and testing</strong>. The server JVM performs more optimization\nthan the client JVM, such as hoisting variables out of a loop that are\nnot modified in the loop; code that might appear to work in the\ndevelopment environment (client JVM) can break in the deployment\nenvironment (server JVM). For example, had we forgotten to declare\nthe variable asleep as volatile in Listing 3.4, <strong>the server JVM could\nhoist the test out of the loop (turning it into an infinite loop), but\nthe client JVM would not</strong>. An infinite loop that shows up in\ndevelopment is far less costly than one that only shows up in\nproduction.</li>\n</ol>\n</blockquote>\n<blockquote>\n<p>Listing 3.4. Counting sheep.</p>\n<pre class=\"lang-java prettyprint-override\"><code>volatile boolean asleep;\n...\nwhile (!asleep)\n   countSomeSheep();\n</code></pre>\n</blockquote>\n<p>My emphasis. YMMV</p>\n"}],"owner":{"account_id":2397,"reputation":179869,"user_id":3333,"accept_rate":80,"display_name":"Paul Tomblin"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":265850,"favorite_count":0,"down_vote_count":3,"up_vote_count":426,"accepted_answer_id":198651,"answer_count":11,"score":423,"last_activity_date":1641405460,"creation_date":1223923213,"question_id":198577,"body_markdown":"Is there any real practical difference between &quot;java -server&quot; and &quot;java -client&quot;?  \r\n\r\nAll I can find on Sun&#39;s site is a vague \r\n\r\n&gt; &quot;-server starts slower but should run faster&quot;.  \r\n\r\nWhat are the real differences?  (Using JDK 1.6.0_07 currently.)","title":"Real differences between &quot;java -server&quot; and &quot;java -client&quot;?","body":"<p>Is there any real practical difference between \"java -server\" and \"java -client\"?  </p>\n\n<p>All I can find on Sun's site is a vague </p>\n\n<blockquote>\n  <p>\"-server starts slower but should run faster\".  </p>\n</blockquote>\n\n<p>What are the real differences?  (Using JDK 1.6.0_07 currently.)</p>\n"},{"tags":["java","hibernate","jpa","spring-data-jpa","hibernate-criteria"],"answers":[{"tags":[],"owner":{"account_id":1038596,"reputation":34548,"user_id":1045142,"accept_rate":67,"display_name":"Simon Martinelli"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641397374,"creation_date":1641397374,"answer_id":70595683,"question_id":70593275,"body_markdown":"JPA generates and SQL statement and ORDER BY is done in memory by the database AFTER the data has been selected.\r\n\r\nSo you can ONLY sort by a column that is present in the result.","title":"How to sort on column not part of select statement in spring JPA specification","body":"<p>JPA generates and SQL statement and ORDER BY is done in memory by the database AFTER the data has been selected.</p>\n<p>So you can ONLY sort by a column that is present in the result.</p>\n"}],"owner":{"account_id":2701966,"reputation":629,"user_id":2332505,"accept_rate":100,"display_name":"user2332505"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1024,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641405410,"creation_date":1641387517,"question_id":70593275,"body_markdown":"My table structure is as follows: \r\n\r\n    TractorEntity {\r\n      List&lt;SegmentEntity&gt;\r\n    }\r\n\r\n    SegmentEntity {\r\n      List&lt;SegmentTrailerEntity&gt;\r\n    }\r\n\r\n    SegmentTrailerEntity {\r\n      TrailerNumber\r\n    }\r\n\r\nI need to sort TractorEntity based on trailerNumber stored in segmentTrailerEntity, using spring JPA specifications.\r\n\r\nDue to one to many relation, the data gets duplicated several times. Issue is, if I add a **DISTINCT** clause , then its expect the column trailerNumber to be part of **SELECT** statement. \r\n\r\n&gt; Error : expression #1 of order by clause is not in select list\r\n\r\nSo I removed the distinct keyword and just used joins to pull the data : \r\n\r\n\r\n    Path trailerPath = root.join(TractorEntity_.segmentEntities, JoinType.LEFT)\r\n                                    .join(SegmentEntity_.segmentTrailers, JoinType.LEFT)\r\n                                    .get(SegmentTrailerEntity_.trailer.getName());\r\n\r\nIssue with this approach is, the total count value also considers duplicate records, like there are 20 unique records and 6 duplicate records, which leads to incorrect total count. I can remove the duplicates in java, but total count is still incorrect.\r\n\r\nThen as per research on Google, I tried to select the columns ( using fetch) on joined table, which works upto 1 level : \r\n\r\n    Fetch bFetch = root.fetch(TractorEntity_.segmentEntities, JoinType.INNER);\r\n    Join&lt;TractorEntity_, SegmentEntity_&gt; bJoin = (Join&lt;TractorEntity_, SegmentEntity_&gt;) bFetch;\r\n    orders.add(criteriaBuilder.asc(bJoin.get(SegmentEntity_.trip.getName())));\r\n    //works\r\n\r\nBut when I tried this approach for current problem , it failed : \r\n\r\n    orders.add(root.fetch(TractorEntity_.segmentEntities, JoinType.INNER).fetch(SegmentEntity.segmentTrailers, JoinType.INNER).get(SegmentTrailer_.trailerNumber)));\r\n\r\nError : \r\n\r\n&gt; &quot;MultipleBagFetchException: cannot simultaneously fetch multiple bags&quot;\r\n\r\nThen I tried to join two tables and try fetch only on the last table : \r\n\r\n    ListJoin segmentEntityJoin = root.join(TractorEntity_.segmentEntities, JoinType.INNER);\r\n    Fetch bFetch = segmentEntityJoin.fetch(SegmentEntity_.segmentTrailers, JoinType.INNER);\r\n    Join&lt;SegmentEntity_, SegmentTrailerEntity_&gt; bJoin = (Join&lt;SegmentEntity_, SegmentTrailerEntity_&gt;) bFetch;\r\n    \r\n    orders.add(criteriaBuilder.asc(bJoin.get(SegmentTrailerEntity_.trailer.getName())));\r\n\r\nThis approach also failed with error : \r\n\r\nError : \r\n&gt; query specified join fetching, but the owner of the fetched\r\n&gt; association was not present in the select list\r\n\r\n\r\nPlease let me know, if anything else can be tried to fix this issue?","title":"How to sort on column not part of select statement in spring JPA specification","body":"<p>My table structure is as follows:</p>\n<pre><code>TractorEntity {\n  List&lt;SegmentEntity&gt;\n}\n\nSegmentEntity {\n  List&lt;SegmentTrailerEntity&gt;\n}\n\nSegmentTrailerEntity {\n  TrailerNumber\n}\n</code></pre>\n<p>I need to sort TractorEntity based on trailerNumber stored in segmentTrailerEntity, using spring JPA specifications.</p>\n<p>Due to one to many relation, the data gets duplicated several times. Issue is, if I add a <strong>DISTINCT</strong> clause , then its expect the column trailerNumber to be part of <strong>SELECT</strong> statement.</p>\n<blockquote>\n<p>Error : expression #1 of order by clause is not in select list</p>\n</blockquote>\n<p>So I removed the distinct keyword and just used joins to pull the data :</p>\n<pre><code>Path trailerPath = root.join(TractorEntity_.segmentEntities, JoinType.LEFT)\n                                .join(SegmentEntity_.segmentTrailers, JoinType.LEFT)\n                                .get(SegmentTrailerEntity_.trailer.getName());\n</code></pre>\n<p>Issue with this approach is, the total count value also considers duplicate records, like there are 20 unique records and 6 duplicate records, which leads to incorrect total count. I can remove the duplicates in java, but total count is still incorrect.</p>\n<p>Then as per research on Google, I tried to select the columns ( using fetch) on joined table, which works upto 1 level :</p>\n<pre><code>Fetch bFetch = root.fetch(TractorEntity_.segmentEntities, JoinType.INNER);\nJoin&lt;TractorEntity_, SegmentEntity_&gt; bJoin = (Join&lt;TractorEntity_, SegmentEntity_&gt;) bFetch;\norders.add(criteriaBuilder.asc(bJoin.get(SegmentEntity_.trip.getName())));\n//works\n</code></pre>\n<p>But when I tried this approach for current problem , it failed :</p>\n<pre><code>orders.add(root.fetch(TractorEntity_.segmentEntities, JoinType.INNER).fetch(SegmentEntity.segmentTrailers, JoinType.INNER).get(SegmentTrailer_.trailerNumber)));\n</code></pre>\n<p>Error :</p>\n<blockquote>\n<p>&quot;MultipleBagFetchException: cannot simultaneously fetch multiple bags&quot;</p>\n</blockquote>\n<p>Then I tried to join two tables and try fetch only on the last table :</p>\n<pre><code>ListJoin segmentEntityJoin = root.join(TractorEntity_.segmentEntities, JoinType.INNER);\nFetch bFetch = segmentEntityJoin.fetch(SegmentEntity_.segmentTrailers, JoinType.INNER);\nJoin&lt;SegmentEntity_, SegmentTrailerEntity_&gt; bJoin = (Join&lt;SegmentEntity_, SegmentTrailerEntity_&gt;) bFetch;\n\norders.add(criteriaBuilder.asc(bJoin.get(SegmentTrailerEntity_.trailer.getName())));\n</code></pre>\n<p>This approach also failed with error :</p>\n<p>Error :</p>\n<blockquote>\n<p>query specified join fetching, but the owner of the fetched\nassociation was not present in the select list</p>\n</blockquote>\n<p>Please let me know, if anything else can be tried to fix this issue?</p>\n"},{"tags":["java","multithreading","sockets","aws-lambda","file-descriptor"],"owner":{"account_id":3101854,"reputation":4107,"user_id":2625772,"accept_rate":54,"display_name":"AnOldSoul"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":355,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1641405363,"creation_date":1641405363,"question_id":70597456,"body_markdown":"I have a Java service that invokes a lambda to get stuff done. When the service keeps running for a while, it seems to throw the below shown exception. However I do not open files in the flow of the code. My service is running in an ECS container in AWS.\r\n\r\n    java.io.IOException: Too many open files\r\n    2021-11-25T11:17:30.850-08:00\tat sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method) ~[?:1.8.0_302]\r\n    2021-11-25T11:17:30.850-08:00\tat sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:421) ~[?:1.8.0_302]\r\n    2021-11-25T11:17:30.850-08:00\tat sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:249) ~[?:1.8.0_302]\r\n    2021-11-25T11:17:30.850-08:00\tat org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept(NioEndpoint.java:540) ~[tomcat-coyote.jar:9.0.52]\r\n    2021-11-25T11:17:30.850-08:00\tat org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept(NioEndpoint.java:78) ~[tomcat-coyote.jar:9.0.52]\r\n    2021-11-25T11:17:30.850-08:00\tat org.apache.tomcat.util.net.Acceptor.run(Acceptor.java:106) ~[tomcat-coyote.jar:9.0.52]\r\n    2021-11-25T11:17:30.850-08:00\tat java.lang.Thread.run(Thread.java:749) [?:1.8.0_302]\r\n    2021-11-25T11:17:31.412-08:00\tjava.io.FileNotFoundException: /proc/stat (Too many open files)\r\n\r\nI tried increasing the ulimit of the container but that didn&#39;t help. I don&#39;t want to further increase it without understanding the root cause. One thing I noticed is that as this exception happens, number of open threads and file descriptor use are at their highest.\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/FHFeg.png\r\n\r\nI have the below logic in the code, where I launch a few threads from ExecutorService.newFixedThreadPool of size 10, and invoke lambda in each of them using CompletableFutures. I&#39;m doubting if this could be a problem.\r\n\r\n    public void createAdditionalTestDataForFuture(TestDataInput inputType, int existingTestDataCount)\r\n                throws JsonProcessingException {\r\n            for (int i = 0; i &lt; additionalTestDataAmount - existingTestDataCount; i++) {\r\n                String payload = this.prepareAdditionalTestData(inputType);\r\n                CompletableFuture.supplyAsync(() -&gt; persistenceManager.invokeLambda(payload), executorService)\r\n                        .thenAccept(this::indexCreatedTestData);\r\n            }\r\n        }\r\n\r\nThe above method is called when a request reaches my service.\r\n\r\n    public O searchAndCreateTestDataIfNotFound(I inputType) throws IOException {\r\n            Map&lt;String, String&gt; searchDocumentResults = persistenceManager.searchData(inputType).searchResults();\r\n            Map&lt;String, String&gt; cleanSearchResults = this.getSearchResultsWithoutOverUsedData(searchDocumentResults);\r\n            int existingValidTestDataCount = cleanSearchResults.size();\r\n    \r\n            if (existingValidTestDataCount &gt; additionalTestDataAmount) {\r\n                return getDocumentToReturnAndUpdateUsage(cleanSearchResults);\r\n            } else if (existingValidTestDataCount == 0) {\r\n                testDataGenerator\r\n                        .createAdditionalTestDataForFuture(inputType, EXISTING_TEST_DATA_COUNT_FOR_LAMBDA_OUTPUT);\r\n                return persistenceManager\r\n                        .invokeLambdaAndIndexData(inputType);\r\n            } else {\r\n                testDataGenerator.createAdditionalTestDataForFuture(inputType, existingValidTestDataCount);\r\n                return getDocumentToReturnAndUpdateUsage(cleanSearchResults);\r\n            }\r\n        }\r\n\r\nBelow is how I invoke my lambda.\r\n\r\n    public Map&lt;String, String&gt; invokeLambda(final String payload) {\r\n    \r\n            final InvokeRequest invokeRequest = new InvokeRequest()\r\n                    .withFunctionName(dataGeneratorAttributes.getLambdaArn())\r\n                    .withPayload(payload);\r\n    \r\n                final InvokeResult invokeResult = awsLambda.invoke(invokeRequest);\r\n    \r\n                if (!StringUtils.isEmpty(invokeResult.getFunctionError())) {\r\n                    throw new RuntimeException(invokeResult.getFunctionError());\r\n                }\r\n    \r\n                final String output = new String(invokeResult.getPayload().array(), StandardCharsets.UTF_8);\r\n    \r\n                return GSON.fromJson(output, HashMap.class);\r\n    \r\n        }\r\n\r\nIs there something wrong about the way I have handled the completable futures or invoking the lambda that could cause these too many open files? any ideas or suggestions to go about investigating this would be greatly appreciated. Thanks in advance.","title":"Too many open files Exception in ECS Cloudwatch logs for a Java Service calling Lambda","body":"<p>I have a Java service that invokes a lambda to get stuff done. When the service keeps running for a while, it seems to throw the below shown exception. However I do not open files in the flow of the code. My service is running in an ECS container in AWS.</p>\n<pre><code>java.io.IOException: Too many open files\n2021-11-25T11:17:30.850-08:00   at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method) ~[?:1.8.0_302]\n2021-11-25T11:17:30.850-08:00   at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:421) ~[?:1.8.0_302]\n2021-11-25T11:17:30.850-08:00   at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:249) ~[?:1.8.0_302]\n2021-11-25T11:17:30.850-08:00   at org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept(NioEndpoint.java:540) ~[tomcat-coyote.jar:9.0.52]\n2021-11-25T11:17:30.850-08:00   at org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept(NioEndpoint.java:78) ~[tomcat-coyote.jar:9.0.52]\n2021-11-25T11:17:30.850-08:00   at org.apache.tomcat.util.net.Acceptor.run(Acceptor.java:106) ~[tomcat-coyote.jar:9.0.52]\n2021-11-25T11:17:30.850-08:00   at java.lang.Thread.run(Thread.java:749) [?:1.8.0_302]\n2021-11-25T11:17:31.412-08:00   java.io.FileNotFoundException: /proc/stat (Too many open files)\n</code></pre>\n<p>I tried increasing the ulimit of the container but that didn't help. I don't want to further increase it without understanding the root cause. One thing I noticed is that as this exception happens, number of open threads and file descriptor use are at their highest.</p>\n<p><a href=\"https://i.stack.imgur.com/FHFeg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FHFeg.png\" alt=\"enter image description here\" /></a></p>\n<p>I have the below logic in the code, where I launch a few threads from ExecutorService.newFixedThreadPool of size 10, and invoke lambda in each of them using CompletableFutures. I'm doubting if this could be a problem.</p>\n<pre><code>public void createAdditionalTestDataForFuture(TestDataInput inputType, int existingTestDataCount)\n            throws JsonProcessingException {\n        for (int i = 0; i &lt; additionalTestDataAmount - existingTestDataCount; i++) {\n            String payload = this.prepareAdditionalTestData(inputType);\n            CompletableFuture.supplyAsync(() -&gt; persistenceManager.invokeLambda(payload), executorService)\n                    .thenAccept(this::indexCreatedTestData);\n        }\n    }\n</code></pre>\n<p>The above method is called when a request reaches my service.</p>\n<pre><code>public O searchAndCreateTestDataIfNotFound(I inputType) throws IOException {\n        Map&lt;String, String&gt; searchDocumentResults = persistenceManager.searchData(inputType).searchResults();\n        Map&lt;String, String&gt; cleanSearchResults = this.getSearchResultsWithoutOverUsedData(searchDocumentResults);\n        int existingValidTestDataCount = cleanSearchResults.size();\n\n        if (existingValidTestDataCount &gt; additionalTestDataAmount) {\n            return getDocumentToReturnAndUpdateUsage(cleanSearchResults);\n        } else if (existingValidTestDataCount == 0) {\n            testDataGenerator\n                    .createAdditionalTestDataForFuture(inputType, EXISTING_TEST_DATA_COUNT_FOR_LAMBDA_OUTPUT);\n            return persistenceManager\n                    .invokeLambdaAndIndexData(inputType);\n        } else {\n            testDataGenerator.createAdditionalTestDataForFuture(inputType, existingValidTestDataCount);\n            return getDocumentToReturnAndUpdateUsage(cleanSearchResults);\n        }\n    }\n</code></pre>\n<p>Below is how I invoke my lambda.</p>\n<pre><code>public Map&lt;String, String&gt; invokeLambda(final String payload) {\n\n        final InvokeRequest invokeRequest = new InvokeRequest()\n                .withFunctionName(dataGeneratorAttributes.getLambdaArn())\n                .withPayload(payload);\n\n            final InvokeResult invokeResult = awsLambda.invoke(invokeRequest);\n\n            if (!StringUtils.isEmpty(invokeResult.getFunctionError())) {\n                throw new RuntimeException(invokeResult.getFunctionError());\n            }\n\n            final String output = new String(invokeResult.getPayload().array(), StandardCharsets.UTF_8);\n\n            return GSON.fromJson(output, HashMap.class);\n\n    }\n</code></pre>\n<p>Is there something wrong about the way I have handled the completable futures or invoking the lambda that could cause these too many open files? any ideas or suggestions to go about investigating this would be greatly appreciated. Thanks in advance.</p>\n"},{"tags":["java","c++","java-native-interface"],"comments":[{"owner":{"account_id":69443,"reputation":85343,"user_id":202009,"accept_rate":79,"display_name":"Andy Thomas"},"score":1,"creation_date":1641405625,"post_id":70596599,"comment_id":124798651,"body_markdown":"If you control the source to the C++ application, you could build a library from the same source code for use from a Java application with JNI. However, it might be simpler to launch it as a child process from your Java application, and read the messages it receives from its stdout.","body":"If you control the source to the C++ application, you could build a library from the same source code for use from a Java application with JNI. However, it might be simpler to launch it as a child process from your Java application, and read the messages it receives from its stdout."},{"owner":{"account_id":14055054,"reputation":1521,"user_id":10152674,"display_name":"BZKN"},"score":0,"creation_date":1641411173,"post_id":70596599,"comment_id":124800702,"body_markdown":"You may need to read the following SO posts for better understanding:\n\n- [Is it possible to implement a Java Interface in C or C++ using JNI?](https://stackoverflow.com/questions/18903964/is-it-possible-to-implement-a-java-interface-in-c-or-c-using-jni) and [Java Interface in C++](https://stackoverflow.com/questions/25851296/java-interface-in-c/25851449#25851449)\n\nAnd since you have mentioned you have C++ application, may be following can also help:\n\n- [How do you declare an interface in C++?](https://stackoverflow.com/questions/318064/how-do-you-declare-an-interface-in-c)","body":"You may need to read the following SO posts for better understanding:  - <a href=\"https://stackoverflow.com/questions/18903964/is-it-possible-to-implement-a-java-interface-in-c-or-c-using-jni\">Is it possible to implement a Java Interface in C or C++ using JNI?</a> and <a href=\"https://stackoverflow.com/questions/25851296/java-interface-in-c/25851449#25851449\">Java Interface in C++</a>  And since you have mentioned you have C++ application, may be following can also help:  - <a href=\"https://stackoverflow.com/questions/318064/how-do-you-declare-an-interface-in-c\">How do you declare an interface in C++?</a>"},{"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1641561864,"post_id":70596599,"comment_id":124842276,"body_markdown":"You can consider an applications `main` function to be a function like any library function, but when you build the application as an executable, you can not *load* it like a library on most systems. The literature youve used was imprecise, at best. JNI can only call dedicated functions, handling the invocation from Java. To call other native functions, you need a stub function handling the JNI invocation conventions and delegating to the actual function. The upcoming [Foreign API](https://docs.oracle.com/en/java/javase/17/docs/api/jdk.incubator.foreign/module-summary.html) may change this.","body":"You can consider an applications <code>main</code> function to be a function like any library function, but when you build the application as an executable, you can not <i>load</i> it like a library on most systems. The literature youve used was imprecise, at best. JNI can only call dedicated functions, handling the invocation from Java. To call other native functions, you need a stub function handling the JNI invocation conventions and delegating to the actual function. The upcoming <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/jdk.incubator.foreign/module-summary.html\" rel=\"nofollow noreferrer\">Foreign API</a> may change this."}],"answers":[{"tags":[],"owner":{"account_id":4327054,"reputation":26992,"user_id":3533584,"display_name":"Jeff Scott Brown"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1641401895,"creation_date":1641401895,"answer_id":70596675,"question_id":70596599,"body_markdown":"&gt; The literature says JNI is used for invoking c/c++ libraries from java\r\n&gt; but can the above c++ application be considered a library?\r\n\r\nYes, it can.\r\n\r\n&gt; Or is JNI just used for calling c++ native functions where in a call\r\n&gt; from java is made and the control passes to c++ and then back to java?\r\n\r\nIt isn&#39;t clear what distinction is being made, but yes JNI can be used to call native functions written in C++ and after that call control would return back to Java.","title":"Can JNI be used to invoke c++ application (call main method of the c++)","body":"<blockquote>\n<p>The literature says JNI is used for invoking c/c++ libraries from java\nbut can the above c++ application be considered a library?</p>\n</blockquote>\n<p>Yes, it can.</p>\n<blockquote>\n<p>Or is JNI just used for calling c++ native functions where in a call\nfrom java is made and the control passes to c++ and then back to java?</p>\n</blockquote>\n<p>It isn't clear what distinction is being made, but yes JNI can be used to call native functions written in C++ and after that call control would return back to Java.</p>\n"}],"owner":{"account_id":17135381,"reputation":9,"user_id":12400547,"display_name":"ugadi"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":162,"favorite_count":0,"down_vote_count":4,"up_vote_count":1,"answer_count":1,"score":-3,"last_activity_date":1641405332,"creation_date":1641401514,"question_id":70596599,"body_markdown":"I have a c++ application which in essence makes a connection to a server blocks on it to listen and when it gets a message from the server, dispatches the message received to a thread and then blocks on listen again (forever). \r\n\r\nThe question here is can I use JNI to invoke the c++ application (call the main function of the c++ code) and get the message back to the java layer and process it? The literature says JNI is used for invoking c/c++ libraries from java but can the above c++ application be considered a library? Or is JNI just used for calling c++ native functions where in a call from java is made and the control passes to c++ and then back to java? \r\n\r\nThe c++ application above use pthreads and blocks on listen and the control would pass only to java layer when a message which was processed from c++ layer is passed to java layer. Any pointer for clarification on the above would be much appreciated.","title":"Can JNI be used to invoke c++ application (call main method of the c++)","body":"<p>I have a c++ application which in essence makes a connection to a server blocks on it to listen and when it gets a message from the server, dispatches the message received to a thread and then blocks on listen again (forever).</p>\n<p>The question here is can I use JNI to invoke the c++ application (call the main function of the c++ code) and get the message back to the java layer and process it? The literature says JNI is used for invoking c/c++ libraries from java but can the above c++ application be considered a library? Or is JNI just used for calling c++ native functions where in a call from java is made and the control passes to c++ and then back to java?</p>\n<p>The c++ application above use pthreads and blocks on listen and the control would pass only to java layer when a message which was processed from c++ layer is passed to java layer. Any pointer for clarification on the above would be much appreciated.</p>\n"},{"tags":["java","android","sharedpreferences","countdowntimer"],"comments":[{"owner":{"account_id":18100127,"reputation":183,"user_id":13158065,"display_name":"Josi Whitlock"},"score":0,"creation_date":1641403786,"post_id":70596891,"comment_id":124797943,"body_markdown":"SharedPreferences is used to save data. This data will be preserved, but it won&#39;t keep your code running when the activity is closed. Check out services (https://guides.codepath.com/android/starting-background-services) which aren&#39;t bound to an activity&#39;s lifecycle.","body":"SharedPreferences is used to save data. This data will be preserved, but it won&#39;t keep your code running when the activity is closed. Check out services (<a href=\"https://guides.codepath.com/android/starting-background-services\" rel=\"nofollow noreferrer\">guides.codepath.com/android/starting-background-services</a>) which aren&#39;t bound to an activity&#39;s lifecycle."},{"owner":{"account_id":5791964,"reputation":694,"user_id":4569103,"display_name":"masoomyf"},"score":0,"creation_date":1642002563,"post_id":70596891,"comment_id":124957661,"body_markdown":"As mentioned by @Josie, SharedPreferences used for save data only. When your app is finishing and countdown is running save the last countdown to shared preference and also the current time. When you start the app again, fetch last countdown time and current time, calculate elapsed countdown, and start the countdown again.","body":"As mentioned by @Josie, SharedPreferences used for save data only. When your app is finishing and countdown is running save the last countdown to shared preference and also the current time. When you start the app again, fetch last countdown time and current time, calculate elapsed countdown, and start the countdown again."}],"answers":[{"tags":[],"owner":{"account_id":22046978,"reputation":3,"user_id":17817594,"display_name":"kotlin_noob"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641405181,"creation_date":1641405181,"answer_id":70597418,"question_id":70596891,"body_markdown":"Short Answer : \r\nUse Broadcast Receiver : https://stackoverflow.com/questions/22496863/how-to-run-countdowntimer-in-a-service-in-android\r\n\r\nYou are creating countdown timer in your Activity. Generally at a time only one Activity could run in foreground(*). Which means as soon as your phone receives a call or you press home-screen button your activity would go in paused state and timer would stop. Not only that, once you rotate you screen the timer would be reset because by rotation onCreate() is called again.\r\nIf you close your app then all its activities would be destroyed - again no chance for timer to run.\r\nHence its a bad idea to use Activity for a timer like app.\r\n\r\n*(its possible to run more than one though : https://collaborate.pega.com/question/it-possible-run-2-activities-same-time)\r\n\r\n","title":"Sharedpreferences in countdown timer app - How to get my countdown timer to run when the app is closed?","body":"<p>Short Answer :\nUse Broadcast Receiver : <a href=\"https://stackoverflow.com/questions/22496863/how-to-run-countdowntimer-in-a-service-in-android\">How to run CountDownTimer in a Service in Android?</a></p>\n<p>You are creating countdown timer in your Activity. Generally at a time only one Activity could run in foreground(*). Which means as soon as your phone receives a call or you press home-screen button your activity would go in paused state and timer would stop. Not only that, once you rotate you screen the timer would be reset because by rotation onCreate() is called again.\nIf you close your app then all its activities would be destroyed - again no chance for timer to run.\nHence its a bad idea to use Activity for a timer like app.</p>\n<p>*(its possible to run more than one though : <a href=\"https://collaborate.pega.com/question/it-possible-run-2-activities-same-time\" rel=\"nofollow noreferrer\">https://collaborate.pega.com/question/it-possible-run-2-activities-same-time</a>)</p>\n"}],"owner":{"account_id":23837605,"reputation":3,"user_id":17843137,"display_name":"Castino"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":290,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641405181,"creation_date":1641402741,"question_id":70596891,"body_markdown":"I have a countdown timer app, but I need it to be able to run and count down even if the app is closed. I have been trying to learn SharedPreferences from youtube tutorials but I can&#39;t figure out how to get it to work. Are there easier options than SharedPreferences or could someone help me out with it?\r\nI&#39;ve put my countdown timer code down below.\r\n\r\n\r\n```\r\n&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\r\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;\r\n    android:layout_width=&quot;match_parent&quot;\r\n    android:layout_height=&quot;match_parent&quot;\r\n    tools:context=&quot;.MainActivity&quot;&gt;\r\n\r\n    &lt;TextView\r\n        android:id=&quot;@+id/textView&quot;\r\n        android:layout_width=&quot;wrap_content&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:text=&quot;TextView&quot;\r\n        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;\r\n        app:layout_constraintEnd_toEndOf=&quot;parent&quot;\r\n        app:layout_constraintStart_toStartOf=&quot;parent&quot;\r\n        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\r\n\r\n    &lt;EditText\r\n        android:id=&quot;@+id/editText&quot;\r\n        android:layout_width=&quot;wrap_content&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:layout_marginTop=&quot;100dp&quot;\r\n        android:ems=&quot;10&quot;\r\n        android:hint=&quot;Aeg&quot;\r\n        android:inputType=&quot;number&quot;\r\n        app:layout_constraintEnd_toEndOf=&quot;parent&quot;\r\n        app:layout_constraintStart_toStartOf=&quot;parent&quot;\r\n        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\r\n\r\n    &lt;Button\r\n        android:id=&quot;@+id/button&quot;\r\n        android:layout_width=&quot;wrap_content&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:text=&quot;Button&quot;\r\n        app:layout_constraintBottom_toTopOf=&quot;@+id/textView&quot;\r\n        app:layout_constraintEnd_toEndOf=&quot;parent&quot;\r\n        app:layout_constraintStart_toStartOf=&quot;parent&quot;\r\n        app:layout_constraintTop_toBottomOf=&quot;@+id/editText&quot; /&gt;\r\n\r\n&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;\r\n```\r\n\r\n\r\n```\r\npackage com.example.countdowntimerproov1;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport android.content.SharedPreferences;\r\nimport android.os.Bundle;\r\nimport android.os.CountDownTimer;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.TextView;\r\n\r\nimport java.text.DecimalFormat;\r\nimport java.text.NumberFormat;\r\n\r\npublic class MainActivity extends AppCompatActivity {\r\n\r\n    TextView textView;\r\n    Button button;\r\n    EditText editText;\r\n    long millisUntilFinished;\r\n    int finalValue;\r\n\r\n\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n\r\n        textView = findViewById(R.id.textView);\r\n        button = findViewById(R.id.button);\r\n        editText = findViewById(R.id.editText);\r\n\r\n        button.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                String value = editText.getText().toString();\r\n                int finalValue = Integer.parseInt(value);\r\n\r\n\r\n                new CountDownTimer(finalValue, 1000) {\r\n                    public void onTick(long millisUntilFinished) {\r\n                        NumberFormat f = new DecimalFormat(&quot;00&quot;);\r\n                        long hour = (millisUntilFinished / 3600000) % 24;\r\n                        long min = (millisUntilFinished / 60000) % 60;\r\n                        long sec = (millisUntilFinished / 1000) % 60;\r\n                        textView.setText(f.format(hour) + &quot;:&quot; + f.format(min) + &quot;:&quot; + f.format(sec));\r\n                    }\r\n                    public void onFinish() {\r\n                        textView.setText(&quot;00:00:00&quot;);\r\n                    }\r\n                }.start();\r\n\r\n\r\n            }\r\n        });\r\n\r\n    }\r\n}\r\n```\r\n\r\n\r\n","title":"Sharedpreferences in countdown timer app - How to get my countdown timer to run when the app is closed?","body":"<p>I have a countdown timer app, but I need it to be able to run and count down even if the app is closed. I have been trying to learn SharedPreferences from youtube tutorials but I can't figure out how to get it to work. Are there easier options than SharedPreferences or could someone help me out with it?\nI've put my countdown timer code down below.</p>\n<pre><code>&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    tools:context=&quot;.MainActivity&quot;&gt;\n\n    &lt;TextView\n        android:id=&quot;@+id/textView&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:text=&quot;TextView&quot;\n        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;\n        app:layout_constraintEnd_toEndOf=&quot;parent&quot;\n        app:layout_constraintStart_toStartOf=&quot;parent&quot;\n        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\n\n    &lt;EditText\n        android:id=&quot;@+id/editText&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:layout_marginTop=&quot;100dp&quot;\n        android:ems=&quot;10&quot;\n        android:hint=&quot;Aeg&quot;\n        android:inputType=&quot;number&quot;\n        app:layout_constraintEnd_toEndOf=&quot;parent&quot;\n        app:layout_constraintStart_toStartOf=&quot;parent&quot;\n        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\n\n    &lt;Button\n        android:id=&quot;@+id/button&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:text=&quot;Button&quot;\n        app:layout_constraintBottom_toTopOf=&quot;@+id/textView&quot;\n        app:layout_constraintEnd_toEndOf=&quot;parent&quot;\n        app:layout_constraintStart_toStartOf=&quot;parent&quot;\n        app:layout_constraintTop_toBottomOf=&quot;@+id/editText&quot; /&gt;\n\n&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;\n</code></pre>\n<pre><code>package com.example.countdowntimerproov1;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.content.SharedPreferences;\nimport android.os.Bundle;\nimport android.os.CountDownTimer;\nimport android.view.View;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.TextView;\n\nimport java.text.DecimalFormat;\nimport java.text.NumberFormat;\n\npublic class MainActivity extends AppCompatActivity {\n\n    TextView textView;\n    Button button;\n    EditText editText;\n    long millisUntilFinished;\n    int finalValue;\n\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        textView = findViewById(R.id.textView);\n        button = findViewById(R.id.button);\n        editText = findViewById(R.id.editText);\n\n        button.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View view) {\n                String value = editText.getText().toString();\n                int finalValue = Integer.parseInt(value);\n\n\n                new CountDownTimer(finalValue, 1000) {\n                    public void onTick(long millisUntilFinished) {\n                        NumberFormat f = new DecimalFormat(&quot;00&quot;);\n                        long hour = (millisUntilFinished / 3600000) % 24;\n                        long min = (millisUntilFinished / 60000) % 60;\n                        long sec = (millisUntilFinished / 1000) % 60;\n                        textView.setText(f.format(hour) + &quot;:&quot; + f.format(min) + &quot;:&quot; + f.format(sec));\n                    }\n                    public void onFinish() {\n                        textView.setText(&quot;00:00:00&quot;);\n                    }\n                }.start();\n\n\n            }\n        });\n\n    }\n}\n</code></pre>\n"},{"tags":["java","android","android-studio","kotlin","build"],"comments":[{"owner":{"account_id":15396644,"reputation":25755,"user_id":11107541,"display_name":"starball"},"score":0,"creation_date":1682290499,"post_id":59438157,"comment_id":134187702,"body_markdown":"related: https://stackoverflow.com/questions/13811020/error-class-x-is-public-should-be-declared-in-a-file-named-x-java","body":"related: <a href=\"https://stackoverflow.com/questions/13811020/error-class-x-is-public-should-be-declared-in-a-file-named-x-java\" title=\"error class x is public should be declared in a file named x java\">stackoverflow.com/questions/13811020/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":19397125,"reputation":91,"user_id":14184551,"display_name":"Allen M."},"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1598644482,"creation_date":1598644482,"answer_id":63640143,"question_id":59438157,"body_markdown":"Try\r\nBuild -&gt; Clean Project\r\nThen\r\nBuild -&gt; Make Project","title":"BuildConfig is public, should be declared in a file named BuildConfig.java","body":"<p>Try\nBuild -&gt; Clean Project\nThen\nBuild -&gt; Make Project</p>\n"},{"tags":[],"owner":{"account_id":6832354,"reputation":763,"user_id":5255819,"display_name":"Sunil KV"},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1601904491,"creation_date":1601904491,"answer_id":64209578,"question_id":59438157,"body_markdown":"Faced the same issue when ever tried to install the App,\r\n\r\n    Build -&gt; Clean Project Then Build -&gt; Make Project\r\n\r\neven though problem arises again and again then go with the below steps.\r\n\r\n\r\n\r\n    Delete .gradle Folder within android Directory\r\n\r\nNow, click Run it works fine.\r\n\r\n\r\n","title":"BuildConfig is public, should be declared in a file named BuildConfig.java","body":"<p>Faced the same issue when ever tried to install the App,</p>\n<pre><code>Build -&gt; Clean Project Then Build -&gt; Make Project\n</code></pre>\n<p>even though problem arises again and again then go with the below steps.</p>\n<pre><code>Delete .gradle Folder within android Directory\n</code></pre>\n<p>Now, click Run it works fine.</p>\n"},{"tags":[],"owner":{"account_id":12800050,"reputation":1146,"user_id":11909003,"display_name":"Priyansh jain"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1641226915,"creation_date":1641226915,"answer_id":70568628,"question_id":59438157,"body_markdown":"For Flutter users,\r\n1. Execute Flutter Clean in terminal of your project folder.\r\n2. Run flutter pub get to get all packages.\r\n3. Run your project.\r\n\r\nAlthough, the problem arises everytime I try to run the project. This problems arises after I added a package in my project. So, that package might be causing some problem.","title":"BuildConfig is public, should be declared in a file named BuildConfig.java","body":"<p>For Flutter users,</p>\n<ol>\n<li>Execute Flutter Clean in terminal of your project folder.</li>\n<li>Run flutter pub get to get all packages.</li>\n<li>Run your project.</li>\n</ol>\n<p>Although, the problem arises everytime I try to run the project. This problems arises after I added a package in my project. So, that package might be causing some problem.</p>\n"},{"tags":[],"owner":{"account_id":487538,"reputation":2233,"user_id":1025019,"accept_rate":86,"display_name":"M Jesse"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641405005,"creation_date":1641405005,"answer_id":70597383,"question_id":59438157,"body_markdown":"Under your Project view in Android Studio navigate to the `.gradle` folder.\r\n\r\nIn that folder, if you see more than one version of gradle, such as, for example, 7.0.2 and 6.1.0. \r\n\r\nDelete one of the versions, preferably the lower version. \r\n\r\nClean, build, and you run. \r\n\r\nIt should run each time without the error, or the necessity to clean and build.\r\n","title":"BuildConfig is public, should be declared in a file named BuildConfig.java","body":"<p>Under your Project view in Android Studio navigate to the <code>.gradle</code> folder.</p>\n<p>In that folder, if you see more than one version of gradle, such as, for example, 7.0.2 and 6.1.0.</p>\n<p>Delete one of the versions, preferably the lower version.</p>\n<p>Clean, build, and you run.</p>\n<p>It should run each time without the error, or the necessity to clean and build.</p>\n"}],"owner":{"account_id":8635281,"reputation":796,"user_id":6465703,"display_name":"dave o grady"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":7918,"favorite_count":0,"down_vote_count":0,"up_vote_count":12,"answer_count":4,"score":12,"last_activity_date":1641405005,"creation_date":1576947801,"question_id":59438157,"body_markdown":"Seem to be getting this occurring error whenever I run my android application.\r\n\r\nThe only way to get around it is by rebuilding the project and runs normally again.\r\n\r\nIf anyone knows the reason for this will be much appreciated\r\n\r\n","title":"BuildConfig is public, should be declared in a file named BuildConfig.java","body":"<p>Seem to be getting this occurring error whenever I run my android application.</p>\n\n<p>The only way to get around it is by rebuilding the project and runs normally again.</p>\n\n<p>If anyone knows the reason for this will be much appreciated</p>\n"},{"tags":["java","jena"],"answers":[{"tags":[],"owner":{"account_id":394579,"reputation":16420,"user_id":757100,"display_name":"AndyS"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641404736,"creation_date":1641404736,"answer_id":70597333,"question_id":70595126,"body_markdown":"Apache Jena 4.3.x has switched to using the JDK provided java.net.http for HTTP requests.\r\n\r\nhttps://jena.apache.org/documentation/sparql-apis/http-auth.html\r\n\r\nThose two classes were part of the support for the previous use of a different HttpClient library.\r\n\r\nThe `&lt;dependency&gt;` shown have is enough.\r\n","title":"How to migrate code using Apache Jena HttpAuthenticator to Jena 4.3.2?","body":"<p>Apache Jena 4.3.x has switched to using the JDK provided java.net.http for HTTP requests.</p>\n<p><a href=\"https://jena.apache.org/documentation/sparql-apis/http-auth.html\" rel=\"nofollow noreferrer\">https://jena.apache.org/documentation/sparql-apis/http-auth.html</a></p>\n<p>Those two classes were part of the support for the previous use of a different HttpClient library.</p>\n<p>The <code>&lt;dependency&gt;</code> shown have is enough.</p>\n"}],"owner":{"account_id":171499,"reputation":11291,"user_id":398963,"accept_rate":60,"display_name":"Konrad H&#246;ffner"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":85,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641404736,"creation_date":1641395189,"question_id":70595126,"body_markdown":"I want to migrate code using Apache Jena 2.13.0 to 4.3.2.\r\nUsing Maven, I changed the dependency to:\r\n\r\n    &lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.apache.jena&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;apache-jena-libs&lt;/artifactId&gt;\r\n\t\t\t&lt;type&gt;pom&lt;/type&gt;\r\n\t\t\t&lt;version&gt;4.3.2&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nFollowing &lt;https://jena.apache.org/documentation/migrate_jena2_jena3.html&gt;, I also replaced all occurrences of `import com.hp.hpl.jena` with `import org.apache.jena.`. While this got rid of the majority of compiler errors, the following classes are not available:\r\n\r\n```java\r\norg.apache.jena.atlas.web.auth.HttpAuthenticator\r\norg.apache.jena.atlas.web.auth.SimpleAuthenticator\r\n```\r\n\r\nHow should I deal with those two classes? Are they under a different path now or are they gone altogether? Or do I need another dependency?\r\n\r\nThe classes are only used in this code block:\r\n\r\n```\r\nHttpAuthenticator auth = null;\r\nif (conf.getAuthPassword() != null &amp;&amp; !conf.getAuthPassword().equals(&quot;&quot;)) {\r\n\tauth = new SimpleAuthenticator(conf.getAuthUsername(),\r\n                conf.getAuthPassword().toCharArray());\r\n}\r\n```","title":"How to migrate code using Apache Jena HttpAuthenticator to Jena 4.3.2?","body":"<p>I want to migrate code using Apache Jena 2.13.0 to 4.3.2.\nUsing Maven, I changed the dependency to:</p>\n<pre><code>&lt;dependency&gt;\n        &lt;groupId&gt;org.apache.jena&lt;/groupId&gt;\n        &lt;artifactId&gt;apache-jena-libs&lt;/artifactId&gt;\n        &lt;type&gt;pom&lt;/type&gt;\n        &lt;version&gt;4.3.2&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Following <a href=\"https://jena.apache.org/documentation/migrate_jena2_jena3.html\" rel=\"nofollow noreferrer\">https://jena.apache.org/documentation/migrate_jena2_jena3.html</a>, I also replaced all occurrences of <code>import com.hp.hpl.jena</code> with <code>import org.apache.jena.</code>. While this got rid of the majority of compiler errors, the following classes are not available:</p>\n<pre class=\"lang-java prettyprint-override\"><code>org.apache.jena.atlas.web.auth.HttpAuthenticator\norg.apache.jena.atlas.web.auth.SimpleAuthenticator\n</code></pre>\n<p>How should I deal with those two classes? Are they under a different path now or are they gone altogether? Or do I need another dependency?</p>\n<p>The classes are only used in this code block:</p>\n<pre><code>HttpAuthenticator auth = null;\nif (conf.getAuthPassword() != null &amp;&amp; !conf.getAuthPassword().equals(&quot;&quot;)) {\n    auth = new SimpleAuthenticator(conf.getAuthUsername(),\n                conf.getAuthPassword().toCharArray());\n}\n</code></pre>\n"},{"tags":["java","gradle","junit","remote-debugging"],"answers":[{"tags":[],"owner":{"account_id":1641449,"reputation":1237,"user_id":1513795,"accept_rate":60,"display_name":"Austin"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641404673,"creation_date":1641142690,"answer_id":70557915,"question_id":70529957,"body_markdown":"The--debug-jvm option is designed to allow remote debugging but has broken since JDK 9. Refer to this: https://github.com/gradle/gradle/issues/7496.\r\n\r\nOne workaround is to use jvmArgs in Gradle&#39;s **test** task to give it the exact debug arguments you want. This worked for me (you may replace 30069 with any free port).\r\n\r\nExmaple:\r\n\r\n    jvmArgs &#39;-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=*:30069&#39;","title":"Remote debug a JUnit test executed using Gradle","body":"<p>The--debug-jvm option is designed to allow remote debugging but has broken since JDK 9. Refer to this: <a href=\"https://github.com/gradle/gradle/issues/7496\" rel=\"nofollow noreferrer\">https://github.com/gradle/gradle/issues/7496</a>.</p>\n<p>One workaround is to use jvmArgs in Gradle's <strong>test</strong> task to give it the exact debug arguments you want. This worked for me (you may replace 30069 with any free port).</p>\n<p>Exmaple:</p>\n<pre><code>jvmArgs '-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=*:30069'\n</code></pre>\n"}],"owner":{"account_id":1641449,"reputation":1237,"user_id":1513795,"accept_rate":60,"display_name":"Austin"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":754,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641404673,"creation_date":1640857928,"question_id":70529957,"body_markdown":"I have the following scenario:\r\n\r\nMachine A: Executing a JUnit test using Gradle:\r\n\r\n    ./gradlew :&lt;directory&gt; --tests &lt;ClassName&gt; --info\r\n\r\nMachine B: I have an IDE (like IntelliJ). I want to create a remote Java debug configuration to machine A and debug the test.\r\n\r\nI came across &quot;**--debug-jvm**&quot; option for gradlew for remote debug. Using this parameter, the Gradle test runner is getting suspended on port 5005 by default. I can connect to this process only from the same machine (machine A) but not from machine B. \r\n\r\nI followed the steps mentioned at https://www.thomaskeller.biz/blog/2020/11/17/debugging-with-gradle/\r\nBut even with this configuration, I am unable to debug from machine B. I always get &quot;Connection refused&quot; error from the IDE in machine B. \r\n\r\nWith Gradle&#39;s --info option, I can see the following parameters added to JVM started for running the tests:\r\n\r\n    -agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=5005\r\n\r\nFor remote debugging I believe address should have &quot;*:&quot; before the port number. For example:\r\n\r\n    -agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=*:5005\r\n\r\nBut the &quot;--debug-jvm&quot; is not adding &quot;*:&quot; to the parameters. \r\n\r\nAlso tried the following things:\r\n\r\n1) Adding &quot;debugOptions&quot; to the Gradle&#39;s &quot;test&quot; task:\r\n\r\n    **debugOptions {\r\n    \tenabled = true\r\n    \tport = 8166\r\n    \tserver = true\r\n    \tsuspend = true\r\n    }**\r\n\r\n The result is the same. Not able to connect from machine B and results in &quot;Connection refused&quot; error in IDE. \r\n\r\n2) Adding following properties to gradle.proprties:\r\n\r\n``` org.gradle.daemon=false```\r\n\r\n    org.gradle.jvmargs=-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=*:10999\r\n\r\nGradle&#39;s daemon thread is suspended with the above properties but not the test executor thread. \r\n\r\nGradle version: **5.6.2**     \r\nJava version: **JDK 11** \r\n\r\nThings are working if everything (running the tests and IDE) is on a single machine. \r\n\r\nSo the question is, how to really &quot;remote&quot; debug a JUnit test that is executed using Gradle? \r\n\r\nThanks for your help!\r\n","title":"Remote debug a JUnit test executed using Gradle","body":"<p>I have the following scenario:</p>\n<p>Machine A: Executing a JUnit test using Gradle:</p>\n<pre><code>./gradlew :&lt;directory&gt; --tests &lt;ClassName&gt; --info\n</code></pre>\n<p>Machine B: I have an IDE (like IntelliJ). I want to create a remote Java debug configuration to machine A and debug the test.</p>\n<p>I came across &quot;<strong>--debug-jvm</strong>&quot; option for gradlew for remote debug. Using this parameter, the Gradle test runner is getting suspended on port 5005 by default. I can connect to this process only from the same machine (machine A) but not from machine B.</p>\n<p>I followed the steps mentioned at <a href=\"https://www.thomaskeller.biz/blog/2020/11/17/debugging-with-gradle/\" rel=\"nofollow noreferrer\">https://www.thomaskeller.biz/blog/2020/11/17/debugging-with-gradle/</a>\nBut even with this configuration, I am unable to debug from machine B. I always get &quot;Connection refused&quot; error from the IDE in machine B.</p>\n<p>With Gradle's --info option, I can see the following parameters added to JVM started for running the tests:</p>\n<pre><code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=5005\n</code></pre>\n<p>For remote debugging I believe address should have &quot;*:&quot; before the port number. For example:</p>\n<pre><code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=*:5005\n</code></pre>\n<p>But the &quot;--debug-jvm&quot; is not adding &quot;*:&quot; to the parameters.</p>\n<p>Also tried the following things:</p>\n<ol>\n<li><p>Adding &quot;debugOptions&quot; to the Gradle's &quot;test&quot; task:</p>\n<p><strong>debugOptions {\nenabled = true\nport = 8166\nserver = true\nsuspend = true\n}</strong></p>\n</li>\n</ol>\n<p>The result is the same. Not able to connect from machine B and results in &quot;Connection refused&quot; error in IDE.</p>\n<ol start=\"2\">\n<li>Adding following properties to gradle.proprties:</li>\n</ol>\n<p><code> org.gradle.daemon=false</code></p>\n<pre><code>org.gradle.jvmargs=-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=*:10999\n</code></pre>\n<p>Gradle's daemon thread is suspended with the above properties but not the test executor thread.</p>\n<p>Gradle version: <strong>5.6.2</strong><br />\nJava version: <strong>JDK 11</strong></p>\n<p>Things are working if everything (running the tests and IDE) is on a single machine.</p>\n<p>So the question is, how to really &quot;remote&quot; debug a JUnit test that is executed using Gradle?</p>\n<p>Thanks for your help!</p>\n"},{"tags":["java","spring","spring-boot"],"answers":[{"tags":[],"owner":{"account_id":10847880,"reputation":31,"user_id":7976725,"display_name":"Eilon Benami"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641404235,"creation_date":1641404235,"answer_id":70597224,"question_id":70594800,"body_markdown":"I executed the code above and got this response:\r\n```\r\n{API=AdoptAPet, Description=Resource to help get pets adopted, Auth=apiKey, HTTPS=true, Cors=yes, Link=https://www.adoptapet.com/public/apis/pet_list.html, Category=Animals}\r\n1417\r\n```\r\nI used spring-web:5.3.8 for the RestTemplate, java version 15. Perhaps you are using an outdated RestTemplate?","title":"Reading a list in another object from a restTemplate response","body":"<p>I executed the code above and got this response:</p>\n<pre><code>{API=AdoptAPet, Description=Resource to help get pets adopted, Auth=apiKey, HTTPS=true, Cors=yes, Link=https://www.adoptapet.com/public/apis/pet_list.html, Category=Animals}\n1417\n</code></pre>\n<p>I used spring-web:5.3.8 for the RestTemplate, java version 15. Perhaps you are using an outdated RestTemplate?</p>\n"}],"owner":{"account_id":16265472,"reputation":53,"user_id":12653752,"display_name":"Ninety5"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":126,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641404235,"creation_date":1641393818,"question_id":70594800,"body_markdown":"I have gone through some of the questions here and their answers like this [one][1] which tells us how to extract a list of objects from a restTemplate response. It does not, however, solve my problem which is, I have an Entry class \r\n```\r\n@JsonIgnoreProperties(ignoreUnknown = true)\r\npublic class Entry {\r\n\r\n\r\n    private String API;\r\n    private String Description;\r\n    private String Auth;\r\n    private boolean HTTPS;\r\n    private String Cors;\r\n    private String Link;\r\n    private String Category;\r\n//    getters and setters\r\n}\r\n```\r\n\r\nthen I have an Entry implementation class which has\r\n```\r\n@JsonIgnoreProperties(ignoreUnknown = true)\r\npublic class EntryImpl {\r\n    private Long count;\r\n    private ArrayList&lt;Entry&gt; entries;\r\n\r\n\r\n    public EntryImpl () {\r\n\r\n    }\r\n//  getters and setters\r\n}\r\n```\r\n\r\nand here is my request implementation to consume this [api][2]\r\n\r\n```\r\npublic class RestConsump {\r\n    public static void main (String [] args) {\r\n        RestTemplate restTemplate = new RestTemplate();\r\n        String url = &quot;https://api.publicapis.org/entries&quot;;\r\n        EntryImpl entries = restTemplate.getForObject(url, EntryImpl.class);\r\n        System.out.println(entries.getEntries().get(0)); // returns null for all entries \r\n        System.out.println(entries.getCount()); // prints the numbers of entries\r\n    }\r\n}\r\n```\r\nMy question is, how do I implement it so that EntryImpl returns the list of entries and the count.\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/23674046/get-list-of-json-objects-with-spring-resttemplate?rq=1\r\n  [2]: https://api.publicapis.org/entries","title":"Reading a list in another object from a restTemplate response","body":"<p>I have gone through some of the questions here and their answers like this <a href=\"https://stackoverflow.com/questions/23674046/get-list-of-json-objects-with-spring-resttemplate?rq=1\">one</a> which tells us how to extract a list of objects from a restTemplate response. It does not, however, solve my problem which is, I have an Entry class</p>\n<pre><code>@JsonIgnoreProperties(ignoreUnknown = true)\npublic class Entry {\n\n\n    private String API;\n    private String Description;\n    private String Auth;\n    private boolean HTTPS;\n    private String Cors;\n    private String Link;\n    private String Category;\n//    getters and setters\n}\n</code></pre>\n<p>then I have an Entry implementation class which has</p>\n<pre><code>@JsonIgnoreProperties(ignoreUnknown = true)\npublic class EntryImpl {\n    private Long count;\n    private ArrayList&lt;Entry&gt; entries;\n\n\n    public EntryImpl () {\n\n    }\n//  getters and setters\n}\n</code></pre>\n<p>and here is my request implementation to consume this <a href=\"https://api.publicapis.org/entries\" rel=\"nofollow noreferrer\">api</a></p>\n<pre><code>public class RestConsump {\n    public static void main (String [] args) {\n        RestTemplate restTemplate = new RestTemplate();\n        String url = &quot;https://api.publicapis.org/entries&quot;;\n        EntryImpl entries = restTemplate.getForObject(url, EntryImpl.class);\n        System.out.println(entries.getEntries().get(0)); // returns null for all entries \n        System.out.println(entries.getCount()); // prints the numbers of entries\n    }\n}\n</code></pre>\n<p>My question is, how do I implement it so that EntryImpl returns the list of entries and the count.</p>\n"},{"tags":["java","azure","azure-functions"],"comments":[{"owner":{"account_id":3894930,"reputation":4026,"user_id":3224238,"display_name":"Paizo"},"score":0,"creation_date":1643796330,"post_id":70452834,"comment_id":125432010,"body_markdown":"I&#39;m using the same with a queue instead of a topic, these are the commands i used to install the core tools `brew tap azure/functions\nbrew install azure-functions-core-tools@3\n# if upgrading on a machine that has 2.x installed\nbrew link --overwrite azure-functions-core-tools@3\n\n#Install extensions\nfunc extensions install`","body":"I&#39;m using the same with a queue instead of a topic, these are the commands i used to install the core tools <code>brew tap azure&#47;functions brew install azure-functions-core-tools@3 # if upgrading on a machine that has 2.x installed brew link --overwrite azure-functions-core-tools@3  #Install extensions func extensions install</code>"}],"answers":[{"tags":[],"owner":{"display_name":"anon"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641299353,"creation_date":1641299353,"answer_id":70578824,"question_id":70452834,"body_markdown":"I tried to reproduce the issue by following steps:\r\n1. Created Azure Functions (***Stack: Java***) in VS Code with Queue Trigger example.\r\n2. By default, version is `3.*, 4.0.0` in ***host.json*** and the messages are pulling successfully.\r\n\r\n![enter image description here](https://i.stack.imgur.com/5FeUU.png)\r\n\r\nAfter downgrading to version `2.*, 3.0.0` of azure functions extension bundles in ***host.json***, the messages are pulling off successfully.\r\n\r\n![enter image description here](https://i.stack.imgur.com/HqsLd.png)\r\n\r\nWhen running the azure functions (java), the runtime takes latest version mentioned in the `host.json` automatically and with which version it is running can be seen in the output terminal when in it is running.","title":"Azure Functions Extension Bundle Version Issue for Local Development","body":"<p>I tried to reproduce the issue by following steps:</p>\n<ol>\n<li>Created Azure Functions (<em><strong>Stack: Java</strong></em>) in VS Code with Queue Trigger example.</li>\n<li>By default, version is <code>3.*, 4.0.0</code> in <em><strong>host.json</strong></em> and the messages are pulling successfully.</li>\n</ol>\n<p><img src=\"https://i.stack.imgur.com/5FeUU.png\" alt=\"enter image description here\" /></p>\n<p>After downgrading to version <code>2.*, 3.0.0</code> of azure functions extension bundles in <em><strong>host.json</strong></em>, the messages are pulling off successfully.</p>\n<p><img src=\"https://i.stack.imgur.com/HqsLd.png\" alt=\"enter image description here\" /></p>\n<p>When running the azure functions (java), the runtime takes latest version mentioned in the <code>host.json</code> automatically and with which version it is running can be seen in the output terminal when in it is running.</p>\n"}],"owner":{"account_id":5396458,"reputation":1476,"user_id":4297541,"display_name":"PoorInRichfield"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":6753,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1641404160,"creation_date":1640193817,"question_id":70452834,"body_markdown":"I have a Java 11 Azure Function with a queue trigger that works as expected when deployed to Azure and properly pulls messages off of the defined service bus topic.   However, running the same function *locally* does not work unless I rollback the version of the [Azure Functions binding extensions][1].  If I don&#39;t revert the version back, the function starts locally but never pulls messages off the service bus topic.\r\n\r\nThe variable is the `host.json` file in the project that defines the extension bundle version.  For the function deployed to Azure, the following `host.json` file is used which is configured for the latest version of the extension bundle: \r\n\r\n    {\r\n      &quot;version&quot;: &quot;2.0&quot;,\r\n      &quot;extensionBundle&quot;: {\r\n        &quot;id&quot;: &quot;Microsoft.Azure.Functions.ExtensionBundle&quot;,\r\n        &quot;version&quot;: &quot;[3.3.0, 4.0.0)&quot;\r\n      }\r\n    }\r\n\r\nThe version that works locally is this:\r\n\r\n    {\r\n      &quot;version&quot;: &quot;2.0&quot;,\r\n      &quot;extensionBundle&quot;: {\r\n        &quot;id&quot;: &quot;Microsoft.Azure.Functions.ExtensionBundle&quot;,\r\n        &quot;version&quot;: &quot;[2.*, 3.0.0)&quot;\r\n      }\r\n    }\r\n\r\nThe Azure function itself doesn&#39;t do anything special.  When setting a breakpoint in the function, it is never called if I don&#39;t revert the Extension Bundle version back to the 2/3 version.\r\n\r\n     public class QueueTrigger {\r\n    \r\n      private DatabaseProvider database;\r\n    \r\n      @FunctionName(Constants.FunctionNames.RUN_CHANGE_HISTORY_TRIGGER)\r\n      public void run(\r\n        @ServiceBusTopicTrigger(name = &quot;msg&quot;,\r\n          topicName = &quot;%SERVICE_BUS_TOPIC_NAME%&quot;,\r\n          subscriptionName = &quot;%SERVICE_BUS_SUBSCRIPTION_NAME%&quot;,\r\n          connection = &quot;ServiceBusConnection&quot;) String message,\r\n        final ExecutionContext context) {\r\n    \r\n        Logger logger = context.getLogger();\r\n    \r\n        try {\r\n          logger.log(Level.INFO, String.format(&quot;Queue Trigger START (%s)&quot;, message));\r\n    \r\n          database = new CosmosDatabaseProvider(logger);\r\n    \r\n          ChangeHistoryService service = new ChangeHistoryService(database, logger);\r\n          service.processChanges(message);\r\n    \r\n          this.database.close();\r\n    \r\n          logger.log(Level.INFO, &quot;Queue Trigger DONE&quot;);\r\n    \r\n        } catch (Exception ex) {\r\n          logger.log(Level.SEVERE, ex.getMessage());\r\n          throw new ServiceResponseException(ex.getMessage(), ex);\r\n        }\r\n      }\r\n    }\r\n\r\nI have the [Azure Function Core Tools][2] v4.0.3971 (latest version) installed on my PC, as do the rest of my team members that all have this same issue.  \r\n\r\nWhat am I missing in my local environment that is preventing the latest version of the extension bundle from working?\r\n\r\n\r\n  [1]: https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-register\r\n  [2]: https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=v4%2Cwindows%2Ccsharp%2Cportal%2Cbash%2Ckeda","title":"Azure Functions Extension Bundle Version Issue for Local Development","body":"<p>I have a Java 11 Azure Function with a queue trigger that works as expected when deployed to Azure and properly pulls messages off of the defined service bus topic.   However, running the same function <em>locally</em> does not work unless I rollback the version of the <a href=\"https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-register\" rel=\"nofollow noreferrer\">Azure Functions binding extensions</a>.  If I don't revert the version back, the function starts locally but never pulls messages off the service bus topic.</p>\n<p>The variable is the <code>host.json</code> file in the project that defines the extension bundle version.  For the function deployed to Azure, the following <code>host.json</code> file is used which is configured for the latest version of the extension bundle:</p>\n<pre><code>{\n  &quot;version&quot;: &quot;2.0&quot;,\n  &quot;extensionBundle&quot;: {\n    &quot;id&quot;: &quot;Microsoft.Azure.Functions.ExtensionBundle&quot;,\n    &quot;version&quot;: &quot;[3.3.0, 4.0.0)&quot;\n  }\n}\n</code></pre>\n<p>The version that works locally is this:</p>\n<pre><code>{\n  &quot;version&quot;: &quot;2.0&quot;,\n  &quot;extensionBundle&quot;: {\n    &quot;id&quot;: &quot;Microsoft.Azure.Functions.ExtensionBundle&quot;,\n    &quot;version&quot;: &quot;[2.*, 3.0.0)&quot;\n  }\n}\n</code></pre>\n<p>The Azure function itself doesn't do anything special.  When setting a breakpoint in the function, it is never called if I don't revert the Extension Bundle version back to the 2/3 version.</p>\n<pre><code> public class QueueTrigger {\n\n  private DatabaseProvider database;\n\n  @FunctionName(Constants.FunctionNames.RUN_CHANGE_HISTORY_TRIGGER)\n  public void run(\n    @ServiceBusTopicTrigger(name = &quot;msg&quot;,\n      topicName = &quot;%SERVICE_BUS_TOPIC_NAME%&quot;,\n      subscriptionName = &quot;%SERVICE_BUS_SUBSCRIPTION_NAME%&quot;,\n      connection = &quot;ServiceBusConnection&quot;) String message,\n    final ExecutionContext context) {\n\n    Logger logger = context.getLogger();\n\n    try {\n      logger.log(Level.INFO, String.format(&quot;Queue Trigger START (%s)&quot;, message));\n\n      database = new CosmosDatabaseProvider(logger);\n\n      ChangeHistoryService service = new ChangeHistoryService(database, logger);\n      service.processChanges(message);\n\n      this.database.close();\n\n      logger.log(Level.INFO, &quot;Queue Trigger DONE&quot;);\n\n    } catch (Exception ex) {\n      logger.log(Level.SEVERE, ex.getMessage());\n      throw new ServiceResponseException(ex.getMessage(), ex);\n    }\n  }\n}\n</code></pre>\n<p>I have the <a href=\"https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=v4%2Cwindows%2Ccsharp%2Cportal%2Cbash%2Ckeda\" rel=\"nofollow noreferrer\">Azure Function Core Tools</a> v4.0.3971 (latest version) installed on my PC, as do the rest of my team members that all have this same issue.</p>\n<p>What am I missing in my local environment that is preventing the latest version of the extension bundle from working?</p>\n"},{"tags":["java","collections","hashmap","immutability","pass-by-value"],"answers":[{"tags":[],"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1641403429,"creation_date":1641402901,"answer_id":70596923,"question_id":70596781,"body_markdown":"First of: [`Arrays::asList`][ArraysAsListApi] creates a fixed-sized list.  \r\nSecond this line \r\n\r\n    obj = Arrays.asList(4,5,6);\r\n\r\ncreates **a new list object**. \r\n\r\nTo test your hypothesis, we need to create a modifiable list, add it to the map, then modify the list:\r\n\r\n    public static void main(String[] args) {\r\n      List&lt;Integer&gt; obj = new ArrayList&lt;&gt;(Arrays.asList(1,2,3));\r\n      Map&lt;Integer, List&lt;Integer&gt;&gt; a = new HashMap&lt;&gt;();\r\n      a.put(0, obj);\r\n      a.get(0).forEach(System.out::print);\r\n      obj.clear();\r\n      obj.add(4);\r\n      obj.add(5);\r\n      obj.add(6);\r\n      System.out.println();\r\n      a.get(0).forEach(System.out::print);\r\n    }\r\n\r\n[&lt;kbd&gt;Ideone demo&lt;/kbd&gt;][Ideone]\r\n\r\nWe see the following output:\r\n\r\n    123\r\n    456\r\n\r\nwhich confirms that the map does not copy the list, but only holds a reference to it.\r\n\r\n[ArraysAsListApi]: https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Arrays.html#asList(T...)\r\n\r\n[Ideone]: https://ideone.com/tW2iHg","title":"Does Map store copy of the reference variable or copy of the object?","body":"<p>First of: <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Arrays.html#asList(T...)\" rel=\"nofollow noreferrer\"><code>Arrays::asList</code></a> creates a fixed-sized list.<br />\nSecond this line</p>\n<pre><code>obj = Arrays.asList(4,5,6);\n</code></pre>\n<p>creates <strong>a new list object</strong>.</p>\n<p>To test your hypothesis, we need to create a modifiable list, add it to the map, then modify the list:</p>\n<pre><code>public static void main(String[] args) {\n  List&lt;Integer&gt; obj = new ArrayList&lt;&gt;(Arrays.asList(1,2,3));\n  Map&lt;Integer, List&lt;Integer&gt;&gt; a = new HashMap&lt;&gt;();\n  a.put(0, obj);\n  a.get(0).forEach(System.out::print);\n  obj.clear();\n  obj.add(4);\n  obj.add(5);\n  obj.add(6);\n  System.out.println();\n  a.get(0).forEach(System.out::print);\n}\n</code></pre>\n<p><a href=\"https://ideone.com/tW2iHg\" rel=\"nofollow noreferrer\"><kbd>Ideone demo</kbd></a></p>\n<p>We see the following output:</p>\n<pre><code>123\n456\n</code></pre>\n<p>which confirms that the map does not copy the list, but only holds a reference to it.</p>\n"},{"tags":[],"owner":{"account_id":22978237,"reputation":486,"user_id":17105581,"display_name":"ferrouskid"},"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1641402953,"creation_date":1641402953,"answer_id":70596934,"question_id":70596781,"body_markdown":"I think there might be a little misunderstanding here. When you do initially `List&lt;Integer&gt; obj = Arrays.asList(1,2,3);`, the objected referenced by `obj` is a list containing 1,2,3. This very list is put in the map. \r\n\r\nHowever, when you do `obj = Arrays.asList(4,5,6);`, you are assigning a new object to the reference `obj`. \r\n\r\nTry this instead: \r\n\r\n    public static void main(String[] args){\r\n            List&lt;Integer&gt; obj = new ArrayList&lt;&gt;();\r\n            obj.add(1);\r\n            Map&lt;Integer, List&lt;Integer&gt;&gt; a = new HashMap&lt;&gt;();\r\n            a.put(0, obj);\r\n            a.get(0).forEach(System.out::println);\r\n            obj.add(2);\r\n            System.out.println();\r\n            a.get(0).forEach(System.out::println);\r\n        }","title":"Does Map store copy of the reference variable or copy of the object?","body":"<p>I think there might be a little misunderstanding here. When you do initially <code>List&lt;Integer&gt; obj = Arrays.asList(1,2,3);</code>, the objected referenced by <code>obj</code> is a list containing 1,2,3. This very list is put in the map.</p>\n<p>However, when you do <code>obj = Arrays.asList(4,5,6);</code>, you are assigning a new object to the reference <code>obj</code>.</p>\n<p>Try this instead:</p>\n<pre><code>public static void main(String[] args){\n        List&lt;Integer&gt; obj = new ArrayList&lt;&gt;();\n        obj.add(1);\n        Map&lt;Integer, List&lt;Integer&gt;&gt; a = new HashMap&lt;&gt;();\n        a.put(0, obj);\n        a.get(0).forEach(System.out::println);\n        obj.add(2);\n        System.out.println();\n        a.get(0).forEach(System.out::println);\n    }\n</code></pre>\n"}],"owner":{"account_id":23160917,"reputation":147,"user_id":17261574,"display_name":"BeastMaster64"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":825,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":70596934,"answer_count":2,"score":0,"last_activity_date":1641403429,"creation_date":1641402322,"question_id":70596781,"body_markdown":"I have this small code snippet and want to know whether the implementations of `java.Util.Map` store of copy of reference variable or the copy of the object.\r\n```java\r\npublic static void main(String[] args) {\r\n    List&lt;Integer&gt; obj = Arrays.asList(1,2,3);\r\n    Map&lt;Integer, List&lt;Integer&gt;&gt; a = new HashMap&lt;&gt;();\r\n    a.put(0, obj);\r\n    a.get(0).forEach(System.out::print);\r\n    obj = Arrays.asList(4,5,6);\r\n    System.out.println();\r\n    a.get(0).forEach(System.out::print);\r\n}\r\n```\r\nOutput\r\n```\r\n123\r\n123\r\n```\r\nI had a feeling that the answer to this must exist already (Ok, it may already exist but I couldn&#39;t find it), I read the following answers but couldn&#39;t get much about my problem\r\n\r\nhttps://stackoverflow.com/questions/7297937/does-java-return-by-reference-or-by-value\r\n\r\nThis answer says that it could have happened if `Integer` was mutable, but `ArrayList` is mutable (https://stackoverflow.com/questions/40438544/is-java-util-list-mutable) so why isn&#39;t it happening?","title":"Does Map store copy of the reference variable or copy of the object?","body":"<p>I have this small code snippet and want to know whether the implementations of <code>java.Util.Map</code> store of copy of reference variable or the copy of the object.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static void main(String[] args) {\n    List&lt;Integer&gt; obj = Arrays.asList(1,2,3);\n    Map&lt;Integer, List&lt;Integer&gt;&gt; a = new HashMap&lt;&gt;();\n    a.put(0, obj);\n    a.get(0).forEach(System.out::print);\n    obj = Arrays.asList(4,5,6);\n    System.out.println();\n    a.get(0).forEach(System.out::print);\n}\n</code></pre>\n<p>Output</p>\n<pre><code>123\n123\n</code></pre>\n<p>I had a feeling that the answer to this must exist already (Ok, it may already exist but I couldn't find it), I read the following answers but couldn't get much about my problem</p>\n<p><a href=\"https://stackoverflow.com/questions/7297937/does-java-return-by-reference-or-by-value\">Does Java return by reference or by value</a></p>\n<p>This answer says that it could have happened if <code>Integer</code> was mutable, but <code>ArrayList</code> is mutable (<a href=\"https://stackoverflow.com/questions/40438544/is-java-util-list-mutable\">Is java.util.List mutable?</a>) so why isn't it happening?</p>\n"},{"tags":["java","mongodb","spring-boot","embedded-database"],"comments":[{"owner":{"account_id":181514,"reputation":9905,"user_id":415559,"accept_rate":73,"display_name":"barrypicker"},"score":0,"creation_date":1576088995,"post_id":59290536,"comment_id":104788719,"body_markdown":"The authors of the MongoDB Java driver have implemented an upgraded client stack (but left the original also) which includes many new components with different namespaces but similar names.  This has cause a great deal of confusion about what is the proper component to use.  Further they did not deprecate every component in the old chain.  This change occurred between the 2.X and 3.X branches of the Java driver.  See https://stackoverflow.com/questions/29364787/mongocollection-versus-dbcollection-java for more details.","body":"The authors of the MongoDB Java driver have implemented an upgraded client stack (but left the original also) which includes many new components with different namespaces but similar names.  This has cause a great deal of confusion about what is the proper component to use.  Further they did not deprecate every component in the old chain.  This change occurred between the 2.X and 3.X branches of the Java driver.  See <a href=\"https://stackoverflow.com/questions/29364787/mongocollection-versus-dbcollection-java\" title=\"mongocollection versus dbcollection java\">stackoverflow.com/questions/29364787/&hellip;</a> for more details."},{"owner":{"account_id":181514,"reputation":9905,"user_id":415559,"accept_rate":73,"display_name":"barrypicker"},"score":0,"creation_date":1576089031,"post_id":59290536,"comment_id":104788733,"body_markdown":"I have found it helpful to fully qualify my objects by their full namespace instead of using import statements.  This helps me keep track of the old vs. new stuff in the driver.","body":"I have found it helpful to fully qualify my objects by their full namespace instead of using import statements.  This helps me keep track of the old vs. new stuff in the driver."},{"owner":{"account_id":17287355,"reputation":51,"user_id":12519670,"display_name":"Zejuho"},"score":0,"creation_date":1576254568,"post_id":59290536,"comment_id":104852129,"body_markdown":"Thanks for your replies, but i&#39;m not sure it concerns my pb. I improve my analisys. We were using Spring class new MongoClientFactory(mongoProperties, env).createMongoClient(null) which in fact detect we are in test environment from an property set in spring environment by EmbeddedMongoAutoConfiguration  class. There is no class in Spring to do the same for client.MongoClient, so i suspect srping to not offer full support","body":"Thanks for your replies, but i&#39;m not sure it concerns my pb. I improve my analisys. We were using Spring class new MongoClientFactory(mongoProperties, env).createMongoClient(null) which in fact detect we are in test environment from an property set in spring environment by EmbeddedMongoAutoConfiguration  class. There is no class in Spring to do the same for client.MongoClient, so i suspect srping to not offer full support"},{"owner":{"account_id":2177142,"reputation":2654,"user_id":1927543,"accept_rate":74,"display_name":"Karthikeyan"},"score":0,"creation_date":1588749398,"post_id":59290536,"comment_id":109014426,"body_markdown":"@Zejuho were you able to fix this issue ?","body":"@Zejuho were you able to fix this issue ?"},{"owner":{"account_id":17287355,"reputation":51,"user_id":12519670,"display_name":"Zejuho"},"score":1,"creation_date":1589144908,"post_id":59290536,"comment_id":109170623,"body_markdown":"@Karthikeyan, last time i worked on the project, we revert to deprecated MongoClient to be able to use  EmbeddedMongoAutoConfiguration. I&#39;m pretty sure we follow spring boot release, i&#39;ll check about the current situation this week on latest spring boot 2.2.","body":"@Karthikeyan, last time i worked on the project, we revert to deprecated MongoClient to be able to use  EmbeddedMongoAutoConfiguration. I&#39;m pretty sure we follow spring boot release, i&#39;ll check about the current situation this week on latest spring boot 2.2."}],"answers":[{"tags":[],"owner":{"account_id":12579163,"reputation":21,"user_id":12461583,"display_name":"mynameiszx"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1610665411,"creation_date":1610665411,"answer_id":65728160,"question_id":59290536,"body_markdown":"Try the new API for mongoDB: SimpleMongoClientDatabaseFactory ","title":"Fixing deprecated SimpleMongoDbFactory to SimpleMongoClientDbFactory break Embedded Mongo tests","body":"<p>Try the new API for mongoDB: SimpleMongoClientDatabaseFactory</p>\n"}],"owner":{"account_id":17287355,"reputation":51,"user_id":12519670,"display_name":"Zejuho"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":8825,"favorite_count":0,"down_vote_count":0,"up_vote_count":5,"answer_count":1,"score":5,"last_activity_date":1641403238,"creation_date":1576083115,"question_id":59290536,"body_markdown":"I work on a project which was extending SimpleMongoFactory to enable multi tenancy \r\n\r\n    public class MultiTenantMongoFactory extends SimpleMongoDbFactory {\r\n\r\nAfter migrating from Spring boot **2.1.10** to **2.2.1**, we tried to fix deprecation warning by using recommended class \r\n\r\n**SimpleMongoClientDbFactory**\r\n\r\nCompilation and application runs fine, but integration tests are broken.\r\n\r\nMy analysis is that autoconfiguration class EmbeddedMongoAutoConfiguration code :\r\n\r\n    @ConditionalOnClass({ MongoClient.class, MongoClientFactoryBean.class })\r\n\tstatic class EmbeddedMongoClientDependsOnBeanFactoryPostProcessor\r\n\t\t\textends MongoClientDependsOnBeanFactoryPostProcessor {\r\n\r\n\t\tEmbeddedMongoClientDependsOnBeanFactoryPostProcessor() {\r\n\t\t\tsuper(MongodExecutable.class);\r\n\t\t}\r\n\r\n\t}\r\n\r\nWhich will call :\r\n\r\n    super(MongoClient.class, MongoClientFactoryBean.class, dependsOn);\r\n\r\nWork only with deprecated **com.mongodb.MongoClient** and not recommended **com.mongodb.client.MongoClient**\r\n\r\nIsn&#39;t that an issue that **EmbeddedMongoAutoConfiguration** may be compatible with recommended class.","title":"Fixing deprecated SimpleMongoDbFactory to SimpleMongoClientDbFactory break Embedded Mongo tests","body":"<p>I work on a project which was extending SimpleMongoFactory to enable multi tenancy</p>\n<pre><code>public class MultiTenantMongoFactory extends SimpleMongoDbFactory {\n</code></pre>\n<p>After migrating from Spring boot <strong>2.1.10</strong> to <strong>2.2.1</strong>, we tried to fix deprecation warning by using recommended class</p>\n<p><strong>SimpleMongoClientDbFactory</strong></p>\n<p>Compilation and application runs fine, but integration tests are broken.</p>\n<p>My analysis is that autoconfiguration class EmbeddedMongoAutoConfiguration code :</p>\n<pre><code>@ConditionalOnClass({ MongoClient.class, MongoClientFactoryBean.class })\nstatic class EmbeddedMongoClientDependsOnBeanFactoryPostProcessor\n        extends MongoClientDependsOnBeanFactoryPostProcessor {\n\n    EmbeddedMongoClientDependsOnBeanFactoryPostProcessor() {\n        super(MongodExecutable.class);\n    }\n\n}\n</code></pre>\n<p>Which will call :</p>\n<pre><code>super(MongoClient.class, MongoClientFactoryBean.class, dependsOn);\n</code></pre>\n<p>Work only with deprecated <strong>com.mongodb.MongoClient</strong> and not recommended <strong>com.mongodb.client.MongoClient</strong></p>\n<p>Isn't that an issue that <strong>EmbeddedMongoAutoConfiguration</strong> may be compatible with recommended class.</p>\n"},{"tags":["java","jmeter"],"comments":[{"owner":{"account_id":1146245,"reputation":580,"user_id":1128925,"accept_rate":78,"display_name":"cliff2310"},"score":0,"creation_date":1641402665,"post_id":70596787,"comment_id":124797504,"body_markdown":"Show us the code.","body":"Show us the code."}],"answers":[{"tags":[],"owner":{"account_id":3460456,"reputation":162728,"user_id":2897748,"display_name":"Dmitri T"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1641403165,"creation_date":1641403165,"answer_id":70596982,"question_id":70596787,"body_markdown":" 1. [Since JMeter 3.1 it&#39;s recommended to use JSR223 test elements and Groovy language for scripting][1] so consider migrating\r\n 2. Unless you have a very specific use case it would be a better idea to move samplers into a single Thread Group, this way you won&#39;t have to pass the token between thread groups at all, moreover each thread (virtual user) would have its own token as [JMeter Variables are local to the threads][2]\r\n 3. You may find [Inter-Thread Communication plugin][3] easier to use, in this case the 2nd thread group will &quot;wait&quot; until the token becomes available\r\n\r\n\r\n  [1]: https://jmeter.apache.org/usermanual/best-practices.html#bsh_scripting\r\n  [2]: https://jmeter.apache.org/usermanual/functions.html\r\n  [3]: https://www.blazemeter.com/blog/how-to-use-the-inter-thread-communication-plugin-in-jmeter/","title":"JMeter does not pass token when executed in non-gui mode","body":"<ol>\n<li><a href=\"https://jmeter.apache.org/usermanual/best-practices.html#bsh_scripting\" rel=\"nofollow noreferrer\">Since JMeter 3.1 it's recommended to use JSR223 test elements and Groovy language for scripting</a> so consider migrating</li>\n<li>Unless you have a very specific use case it would be a better idea to move samplers into a single Thread Group, this way you won't have to pass the token between thread groups at all, moreover each thread (virtual user) would have its own token as <a href=\"https://jmeter.apache.org/usermanual/functions.html\" rel=\"nofollow noreferrer\">JMeter Variables are local to the threads</a></li>\n<li>You may find <a href=\"https://www.blazemeter.com/blog/how-to-use-the-inter-thread-communication-plugin-in-jmeter/\" rel=\"nofollow noreferrer\">Inter-Thread Communication plugin</a> easier to use, in this case the 2nd thread group will &quot;wait&quot; until the token becomes available</li>\n</ol>\n"}],"owner":{"account_id":16045246,"reputation":127,"user_id":11580549,"display_name":"Laplace&#39;sDemon"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":118,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":70596982,"answer_count":1,"score":1,"last_activity_date":1641403165,"creation_date":1641402334,"question_id":70596787,"body_markdown":"I have two threads groups. The first one generate a token that is passed to the second thread group. I use a json extractor and a beanshell assertion in the first group to make the token visible for the second thread. It works perfectly in gui mode but in non-gui mode   the token always is generated correctly but is not passed to the second thread so it fails, returns status 401.\r\n\r\nDo you have any idea why this happen and a solution?\r\n\r\nEdit:\r\nI have a global user defined variable element. There I have a var called token_type with the value global_token.\r\nThen in the second thread I have a http header manager where I have a header called Authorization with the value Bearer ${__V(${token_type})}","title":"JMeter does not pass token when executed in non-gui mode","body":"<p>I have two threads groups. The first one generate a token that is passed to the second thread group. I use a json extractor and a beanshell assertion in the first group to make the token visible for the second thread. It works perfectly in gui mode but in non-gui mode   the token always is generated correctly but is not passed to the second thread so it fails, returns status 401.</p>\n<p>Do you have any idea why this happen and a solution?</p>\n<p>Edit:\nI have a global user defined variable element. There I have a var called token_type with the value global_token.\nThen in the second thread I have a http header manager where I have a header called Authorization with the value Bearer ${__V(${token_type})}</p>\n"},{"tags":["java","postgresql","jdbc","prepared-statement"],"comments":[{"owner":{"account_id":229080,"reputation":5949,"user_id":491790,"accept_rate":74,"display_name":"maks"},"score":0,"creation_date":1352497462,"post_id":13315846,"comment_id":18164538,"body_markdown":"seems it treats to those params as array of bytes","body":"seems it treats to those params as array of bytes"},{"owner":{"account_id":229080,"reputation":5949,"user_id":491790,"accept_rate":74,"display_name":"maks"},"score":0,"creation_date":1352498235,"post_id":13315846,"comment_id":18164808,"body_markdown":"can you log the query params before the query?","body":"can you log the query params before the query?"},{"owner":{"account_id":957259,"reputation":29625,"user_id":982341,"display_name":"GreyBeardedGeek"},"score":3,"creation_date":1352498571,"post_id":13315846,"comment_id":18164900,"body_markdown":"as far as I know, you should not expect a readable sql statement as the result of Statement.toString() (which is what you get when you do System.out.println(stmt). The question is - does the sql statement do what&#39;s intended? If so, then don&#39;t worry about it.","body":"as far as I know, you should not expect a readable sql statement as the result of Statement.toString() (which is what you get when you do System.out.println(stmt). The question is - does the sql statement do what&#39;s intended? If so, then don&#39;t worry about it."},{"owner":{"account_id":2029107,"reputation":63,"user_id":1813345,"display_name":"Diego Boy Rz"},"score":0,"creation_date":1352710797,"post_id":13315846,"comment_id":18204818,"body_markdown":"In the end, the problem was somewhere else, but as I could log the params correctly, got the Strings right in the printed Statement, and found nothing about what GreyBeardedGeek mentioned about Statements being non-readable, I thought there was something wrong there. Thank you for your help and that info!","body":"In the end, the problem was somewhere else, but as I could log the params correctly, got the Strings right in the printed Statement, and found nothing about what GreyBeardedGeek mentioned about Statements being non-readable, I thought there was something wrong there. Thank you for your help and that info!"},{"owner":{"account_id":5715690,"reputation":2296,"user_id":4515989,"accept_rate":78,"display_name":"Felix"},"score":0,"creation_date":1641403548,"post_id":13315846,"comment_id":124797841,"body_markdown":"On another note, you should almost never instantiate a `ArrayList` with an inital capacity of `0`. Since you&#39;re given a `limit` here, use `limit` as the initial capacity for your `ArrayList`","body":"On another note, you should almost never instantiate a <code>ArrayList</code> with an inital capacity of <code>0</code>. Since you&#39;re given a <code>limit</code> here, use <code>limit</code> as the initial capacity for your <code>ArrayList</code>"}],"answers":[{"tags":[],"owner":{"account_id":163609,"reputation":2000,"user_id":385868,"display_name":"Zagrev"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1352503924,"creation_date":1352503924,"answer_id":13317540,"question_id":13315846,"body_markdown":"Two quick thoughts on this.\r\n\r\n1. The string you are seeing is the Integer object converted to a string.\r\n2. Why are you trying to order the result by an Integer?\r\n\r\nI think you have the number of parameters wrong. You have to order by a field of the tables included in the query, therefore you should not be giving the 4th parameter as an integer. In fact, you should probably have a fixed ordering. ","title":"PreparedStatement&#39;s setInt() not working on PostgreSQL","body":"<p>Two quick thoughts on this.</p>\n\n<ol>\n<li>The string you are seeing is the Integer object converted to a string.</li>\n<li>Why are you trying to order the result by an Integer?</li>\n</ol>\n\n<p>I think you have the number of parameters wrong. You have to order by a field of the tables included in the query, therefore you should not be giving the 4th parameter as an integer. In fact, you should probably have a fixed ordering. </p>\n"},{"tags":[],"owner":{"account_id":2134585,"reputation":231,"user_id":1894680,"display_name":"Rija Ramampiandra"},"down_vote_count":2,"up_vote_count":1,"is_accepted":false,"score":-1,"last_activity_date":1641395788,"creation_date":1355233072,"answer_id":13821632,"question_id":13315846,"body_markdown":"    public User_DTO[] select(User_DTO params, int order, int limit, int offset)\r\n    {\r\n        User_DTO result = null;\r\n        ArrayList&lt;User_DTO&gt; result_arr = new ArrayList&lt;User_DTO&gt;(0);\r\n\t\t\r\n\t\tStringBuffer queryBuffer = new StringBuffer(&quot;SELECT id, name, role FROM Usuario WHERE name LIKE &quot;);\r\n\t\tqueryBuffer.append(&quot;%&quot;);\r\n\t\tqueryBuffer.append(params.getName());\r\n\t\tqueryBuffer.append(&quot;%&quot;);\r\n\t\tqueryBuffer.append(&quot; AND role LIKE &quot;);\r\n\t\tqueryBuffer.append(&quot;%&quot;);\r\n\t\tqueryBuffer.append(params.getRole());\r\n\t\tqueryBuffer.append(&quot;%&quot;);\r\n\t\tqueryBuffer.append(&quot; AND id != &quot;);\r\n\t\tqueryBuffer.append(params.getId());\r\n\t\tqueryBuffer.append(&quot; ORDER BY &quot;);\r\n\t\tqueryBuffer.append(order);\r\n\r\n\t\tif (limit != -1)\r\n\t\t{\r\n\t\t\tqueryBuffer.append(&quot; LIMIT &quot;);\r\n\t\t\tqueryBuffer.append(limit);\r\n\t\t}\r\n\r\n\t\tqueryBuffer.append(&quot; OFFSET &quot;);\r\n\t\tqueryBuffer.append(offset);\r\n\t\t\r\n        try\r\n        {\r\n            conn = Pool.getConnection();\r\n            stmt = conn.prepareStatement(queryBuffer.toString());\r\n\r\n            rs = stmt.executeQuery();\r\n\r\n            while (rs.next())\r\n            {\r\n                result = new User_DTO();\r\n\r\n                result.setId(rs.getString(&quot;id&quot;));\r\n                result.setName(rs.getString(&quot;name&quot;));\r\n                result.setRole(rs.getString(&quot;role&quot;));\r\n\r\n                result_arr.add(result);\r\n            }\r\n        }\r\n        catch(SQLException sql_e)\r\n        {\r\n            sql_e.printStackTrace();\r\n        }\r\n        finally\r\n        {\r\n            Pool.close(conn, stmt, rs);\r\n        }\r\n\r\n        return (result != null) ? result_arr.toArray(new User_DTO[result_arr.size()]) : null;\r\n    }\r\n\r\nUse `StringBuffer` instead of the `setInt` or `setString`","title":"PreparedStatement&#39;s setInt() not working on PostgreSQL","body":"<pre><code>public User_DTO[] select(User_DTO params, int order, int limit, int offset)\n{\n    User_DTO result = null;\n    ArrayList&lt;User_DTO&gt; result_arr = new ArrayList&lt;User_DTO&gt;(0);\n    \n    StringBuffer queryBuffer = new StringBuffer(&quot;SELECT id, name, role FROM Usuario WHERE name LIKE &quot;);\n    queryBuffer.append(&quot;%&quot;);\n    queryBuffer.append(params.getName());\n    queryBuffer.append(&quot;%&quot;);\n    queryBuffer.append(&quot; AND role LIKE &quot;);\n    queryBuffer.append(&quot;%&quot;);\n    queryBuffer.append(params.getRole());\n    queryBuffer.append(&quot;%&quot;);\n    queryBuffer.append(&quot; AND id != &quot;);\n    queryBuffer.append(params.getId());\n    queryBuffer.append(&quot; ORDER BY &quot;);\n    queryBuffer.append(order);\n\n    if (limit != -1)\n    {\n        queryBuffer.append(&quot; LIMIT &quot;);\n        queryBuffer.append(limit);\n    }\n\n    queryBuffer.append(&quot; OFFSET &quot;);\n    queryBuffer.append(offset);\n    \n    try\n    {\n        conn = Pool.getConnection();\n        stmt = conn.prepareStatement(queryBuffer.toString());\n\n        rs = stmt.executeQuery();\n\n        while (rs.next())\n        {\n            result = new User_DTO();\n\n            result.setId(rs.getString(&quot;id&quot;));\n            result.setName(rs.getString(&quot;name&quot;));\n            result.setRole(rs.getString(&quot;role&quot;));\n\n            result_arr.add(result);\n        }\n    }\n    catch(SQLException sql_e)\n    {\n        sql_e.printStackTrace();\n    }\n    finally\n    {\n        Pool.close(conn, stmt, rs);\n    }\n\n    return (result != null) ? result_arr.toArray(new User_DTO[result_arr.size()]) : null;\n}\n</code></pre>\n<p>Use <code>StringBuffer</code> instead of the <code>setInt</code> or <code>setString</code></p>\n"}],"owner":{"account_id":2029107,"reputation":63,"user_id":1813345,"display_name":"Diego Boy Rz"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2879,"favorite_count":0,"down_vote_count":0,"up_vote_count":5,"answer_count":2,"score":5,"last_activity_date":1641403022,"creation_date":1352494394,"question_id":13315846,"body_markdown":"I&#39;m using PostgreSQL 9.1 with Tomcat 7 on Eclipse. The connection is made through a connection pool. When I use the `setInt()` method for the `PreparedStatement`, nothing is returned. When printing the prepared statement, the &#39;?&#39; is replaced by some weird String I suppose is a reference to the object. When I use the method `setObject()` with the appropriate `Type.INTEGER`, the printed statement contains the correct value, but as a String, and forcefully an Int is required.\r\n\r\nHere&#39;s the code:\r\n\r\n    public User_DTO[] select(User_DTO params, int order, int limit, int offset)\r\n    {\r\n       \tUser_DTO result = null;\r\n\t    ArrayList&lt;User_DTO&gt; result_arr = new ArrayList&lt;User_DTO&gt;(0);\r\n\t\r\n\t    String query = &quot;SELECT id, name, role FROM Usuario WHERE name LIKE ? AND role LIKE ? AND id != ? ORDER BY ? LIMIT ? OFFSET ?&quot;;\r\n\t\r\n    \tString name = params.getName();\r\n    \tString role = params.getRole();\r\n    \tString id = params.getId();\r\n\t\r\n    \ttry\r\n    \t{\r\n    \t\tconn = Pool.getConnection();\r\n    \t\tstmt = conn.prepareStatement(query);\r\n\t\t\r\n    \t\tstmt.setString(1, &quot;%&quot; + name + &quot;%&quot;);\r\n    \t\tstmt.setString(2, &quot;%&quot; + role + &quot;%&quot;);\r\n    \t\tstmt.setString(3, id);\r\n\r\n                    // Using setInt()\r\n                    // stmt.setInt(4, order);\r\n\r\n                    // Using setObject\r\n    \t\tstmt.setObject(4, order, Types.INTEGER);\r\n    \t\tSystem.out.println(order);\r\n\t\t\r\n    \t\tif(limit == -1)\r\n    \t\t{\r\n    \t\t\tstmt.setNull(5, Types.NULL);\r\n    \t\t}\r\n    \t\telse\r\n        \t{\r\n\t    \t\tstmt.setInt(5, limit);\r\n\t    \t}\r\n\t\t\r\n\t    \tstmt.setInt(6, offset);\r\n\r\n\t    \t//\r\n\t    \tSystem.out.println(stmt);\r\n\t\t\r\n\t    \trs = stmt.executeQuery();\r\n\t\t\r\n\t    \twhile(rs.next())\r\n\t    \t{\r\n\t    \t\tresult = new User_DTO();\r\n\t\t\t\r\n\t    \t\tresult.setId(rs.getString(&quot;id&quot;));\r\n\t    \t\tresult.setName(rs.getString(&quot;name&quot;));\r\n\t    \t\tresult.setRole(rs.getString(&quot;role&quot;));\r\n\t\t\t\r\n\t    \t\tresult_arr.add(result);\r\n\t    \t}\r\n\t    }\r\n\t    catch(SQLException sql_e)\r\n\t    {\r\n\t    \tsql_e.printStackTrace();\r\n\t    }\r\n\t    finally\r\n\t    {\r\n\t    \tPool.close(conn, stmt, rs);\r\n\t    }\r\n\t\r\n\t    return (result != null) ? result_arr.toArray(new User_DTO[result_arr.size()]) : null;\r\n\t}\r\n\r\n\r\nThe printed statement using `setInt()` is this:\r\n\r\n    SELECT id, name, role FROM Usuario WHERE name LIKE &#39;%%&#39; AND role LIKE &#39;%%&#39; AND id != &#39;13253cc9&#39; ORDER BY &#39;[B@65adcbab&#39; LIMIT &#39;[B@75167bb3&#39; OFFSET &#39;[B@171360d3&#39;\r\n\r\n\r\nAnd the one printed using `setObject()`:\r\n\r\n    SELECT id, name, role FROM Usuario WHERE name LIKE &#39;%%&#39; AND role LIKE &#39;%%&#39; AND id != &#39;13253cc9&#39; ORDER BY &#39;1&#39; LIMIT &#39;[B@75167bb3&#39; OFFSET &#39;[B@171360d3&#39;\r\n\r\nAny idea why this might be happening?\r\n","title":"PreparedStatement&#39;s setInt() not working on PostgreSQL","body":"<p>I'm using PostgreSQL 9.1 with Tomcat 7 on Eclipse. The connection is made through a connection pool. When I use the <code>setInt()</code> method for the <code>PreparedStatement</code>, nothing is returned. When printing the prepared statement, the '?' is replaced by some weird String I suppose is a reference to the object. When I use the method <code>setObject()</code> with the appropriate <code>Type.INTEGER</code>, the printed statement contains the correct value, but as a String, and forcefully an Int is required.</p>\n<p>Here's the code:</p>\n<pre><code>public User_DTO[] select(User_DTO params, int order, int limit, int offset)\n{\n    User_DTO result = null;\n    ArrayList&lt;User_DTO&gt; result_arr = new ArrayList&lt;User_DTO&gt;(0);\n\n    String query = &quot;SELECT id, name, role FROM Usuario WHERE name LIKE ? AND role LIKE ? AND id != ? ORDER BY ? LIMIT ? OFFSET ?&quot;;\n\n    String name = params.getName();\n    String role = params.getRole();\n    String id = params.getId();\n\n    try\n    {\n        conn = Pool.getConnection();\n        stmt = conn.prepareStatement(query);\n    \n        stmt.setString(1, &quot;%&quot; + name + &quot;%&quot;);\n        stmt.setString(2, &quot;%&quot; + role + &quot;%&quot;);\n        stmt.setString(3, id);\n\n                // Using setInt()\n                // stmt.setInt(4, order);\n\n                // Using setObject\n        stmt.setObject(4, order, Types.INTEGER);\n        System.out.println(order);\n    \n        if(limit == -1)\n        {\n            stmt.setNull(5, Types.NULL);\n        }\n        else\n        {\n            stmt.setInt(5, limit);\n        }\n    \n        stmt.setInt(6, offset);\n\n        //\n        System.out.println(stmt);\n    \n        rs = stmt.executeQuery();\n    \n        while(rs.next())\n        {\n            result = new User_DTO();\n        \n            result.setId(rs.getString(&quot;id&quot;));\n            result.setName(rs.getString(&quot;name&quot;));\n            result.setRole(rs.getString(&quot;role&quot;));\n        \n            result_arr.add(result);\n        }\n    }\n    catch(SQLException sql_e)\n    {\n        sql_e.printStackTrace();\n    }\n    finally\n    {\n        Pool.close(conn, stmt, rs);\n    }\n\n    return (result != null) ? result_arr.toArray(new User_DTO[result_arr.size()]) : null;\n}\n</code></pre>\n<p>The printed statement using <code>setInt()</code> is this:</p>\n<pre><code>SELECT id, name, role FROM Usuario WHERE name LIKE '%%' AND role LIKE '%%' AND id != '13253cc9' ORDER BY '[B@65adcbab' LIMIT '[B@75167bb3' OFFSET '[B@171360d3'\n</code></pre>\n<p>And the one printed using <code>setObject()</code>:</p>\n<pre><code>SELECT id, name, role FROM Usuario WHERE name LIKE '%%' AND role LIKE '%%' AND id != '13253cc9' ORDER BY '1' LIMIT '[B@75167bb3' OFFSET '[B@171360d3'\n</code></pre>\n<p>Any idea why this might be happening?</p>\n"},{"tags":["java","methods","enums","field","dry"],"answers":[{"tags":[],"owner":{"account_id":7595189,"reputation":44576,"user_id":5761558,"display_name":"ernest_k"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1641239877,"creation_date":1641239877,"answer_id":70570794,"question_id":70570084,"body_markdown":"This is probably one of the cases where you need to pick one between being DRY and using enums. \r\n\r\nEnums don&#39;t go very far as far as code reuse is concerned, in Java at least; and the main reason for this is that primary benefits of using enums are reaped in static code - I mean *static* as in &quot;not dynamic&quot;/&quot;runtime&quot;, rather than `static` :). Although you can &quot;reduce&quot; code duplication, you can hardly do much of that without introducing dependency (yes, that applies to adding a common API/interface, extracting the implementation of `asListString` to a utility class). And that&#39;s still an undesirable trade-off. \r\n\r\nFurthermore, if you **must** use an enum (for such reasons as built-in support for serialization, database mapping, JSON binding, or, well, because it&#39;s data enumeration, etc.), you have no choice but to duplicate method declarations to an extent, even if you can share the implementation: static methods just can&#39;t be inherited, and interface methods (of which `getMessage` would be one) shall need an implementation everywhere. I mean this way of being &quot;DRY&quot; will have many ways of being inelegant.\r\n\r\nIf I were you, I would simply make this data completely dynamic\r\n\r\n    final class MenuOption {\r\n    \tprivate final String category; //MAIN_MENU, HOT_SELECTION\r\n    \tprivate final String message; //Exit, View Reservation By Host, etc.\r\n    \tpublic static MenuOption of(String key, String message) {\r\n    \t\treturn new MenuOption(key, message);\r\n    \t}\r\n    }\r\n\r\nThis is very scalable, although it introduces the need to validate data where enums would statically prevent bad options, and possibly custom code where an enum would offer built-in support.\r\n\r\nIt can be improved with a &quot;category&quot; enum, which gives static access to menu lists, and a single place for `asListString()`:\r\n\r\n\tenum MenuCategory {\r\n\t\tMAIN_MENU(\r\n\t\t\tMenuOption.of(&quot;Exit&quot;), \r\n\t\t\tMenuOption.of(&quot;View Reservations By Host&quot;)\r\n\t\t),\r\n\t\tHOT_SELECTION(\r\n\t\t\tMenuOption.of(&quot;Find All&quot;)\r\n\t\t);\r\n\t\t\r\n\t\tprivate final List&lt;MenuOption&gt; menuOptions;\r\n\t\t\r\n\t\tMenuCategory(MenuOption... options) {\r\n\t\t\tthis.menuOptions = List.of(options); //unmodifiable\r\n\t\t}\r\n\t\t\r\n\t\tpublic List&lt;String&gt;asListString() {\r\n\t\t\treturn this.menuOptions.stream()\r\n\t\t\t\t\t   .map(MenuOption::getMessage)\r\n\t\t\t\t\t   .collect(Collectors.toList());\r\n\t\t}\r\n\t}\r\n\r\nIt should be clear that you can replace `class MenuOption` with a bunch of enums implementing a common interface, which should change little to nothing in `MenuCategory`. I wouldn&#39;t do that, but it&#39;s an option.","title":"Code reuse: returning lists of enum fields with common getter methods","body":"<p>This is probably one of the cases where you need to pick one between being DRY and using enums.</p>\n<p>Enums don't go very far as far as code reuse is concerned, in Java at least; and the main reason for this is that primary benefits of using enums are reaped in static code - I mean <em>static</em> as in &quot;not dynamic&quot;/&quot;runtime&quot;, rather than <code>static</code> :). Although you can &quot;reduce&quot; code duplication, you can hardly do much of that without introducing dependency (yes, that applies to adding a common API/interface, extracting the implementation of <code>asListString</code> to a utility class). And that's still an undesirable trade-off.</p>\n<p>Furthermore, if you <strong>must</strong> use an enum (for such reasons as built-in support for serialization, database mapping, JSON binding, or, well, because it's data enumeration, etc.), you have no choice but to duplicate method declarations to an extent, even if you can share the implementation: static methods just can't be inherited, and interface methods (of which <code>getMessage</code> would be one) shall need an implementation everywhere. I mean this way of being &quot;DRY&quot; will have many ways of being inelegant.</p>\n<p>If I were you, I would simply make this data completely dynamic</p>\n<pre><code>final class MenuOption {\n    private final String category; //MAIN_MENU, HOT_SELECTION\n    private final String message; //Exit, View Reservation By Host, etc.\n    public static MenuOption of(String key, String message) {\n        return new MenuOption(key, message);\n    }\n}\n</code></pre>\n<p>This is very scalable, although it introduces the need to validate data where enums would statically prevent bad options, and possibly custom code where an enum would offer built-in support.</p>\n<p>It can be improved with a &quot;category&quot; enum, which gives static access to menu lists, and a single place for <code>asListString()</code>:</p>\n<pre><code>enum MenuCategory {\n    MAIN_MENU(\n        MenuOption.of(&quot;Exit&quot;), \n        MenuOption.of(&quot;View Reservations By Host&quot;)\n    ),\n    HOT_SELECTION(\n        MenuOption.of(&quot;Find All&quot;)\n    );\n    \n    private final List&lt;MenuOption&gt; menuOptions;\n    \n    MenuCategory(MenuOption... options) {\n        this.menuOptions = List.of(options); //unmodifiable\n    }\n    \n    public List&lt;String&gt;asListString() {\n        return this.menuOptions.stream()\n                   .map(MenuOption::getMessage)\n                   .collect(Collectors.toList());\n    }\n}\n</code></pre>\n<p>It should be clear that you can replace <code>class MenuOption</code> with a bunch of enums implementing a common interface, which should change little to nothing in <code>MenuCategory</code>. I wouldn't do that, but it's an option.</p>\n"},{"tags":[],"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641396921,"creation_date":1641396921,"answer_id":70595547,"question_id":70570084,"body_markdown":"You can DRY it a little.\r\n\r\n**Utils.java**\r\n```\r\nimport java.util.Arrays;\r\nimport java.util.List;\r\nimport java.util.stream.Collectors;\r\n\r\npublic interface Utils&lt;T&gt;\r\n{\r\n\r\n   public String getMessage();\r\n\r\n   public static &lt;T extends Utils&lt;T&gt;&gt; List&lt;String&gt; asListString(Class&lt;T&gt; clazz)\r\n   {\r\n   \r\n      return Arrays.stream(clazz.getEnumConstants())\r\n                .map(T::getMessage)\r\n                .collect(Collectors.toList());\r\n   \r\n   }\r\n   \r\n}\r\n```\r\n\r\n**HostSelectionMethodOptions.java**\r\n```\r\npublic enum HostSelectionMethodOptions implements Utils&lt;HostSelectionMethodOptions&gt; {\r\n   \r\n   FIND_ALL(&quot;Find all&quot;),\r\n   FIND_BY_LASTNAME_PREFIX(&quot;Find by last name prefix&quot;),\r\n   FIND_BY_CITY_STATE(&quot;Find by city &amp; state&quot;);\r\n   \r\n   private final String message;\r\n   \r\n   HostSelectionMethodOptions(String message) {\r\n      this.message = message;\r\n   }\r\n   \r\n   public String getMessage() {\r\n      return message;\r\n   }\r\n   \r\n}\r\n```\r\n\r\nThen just do this - `Utils.asListString(HostSelectionMethodOptions.class);`","title":"Code reuse: returning lists of enum fields with common getter methods","body":"<p>You can DRY it a little.</p>\n<p><strong>Utils.java</strong></p>\n<pre><code>import java.util.Arrays;\nimport java.util.List;\nimport java.util.stream.Collectors;\n\npublic interface Utils&lt;T&gt;\n{\n\n   public String getMessage();\n\n   public static &lt;T extends Utils&lt;T&gt;&gt; List&lt;String&gt; asListString(Class&lt;T&gt; clazz)\n   {\n   \n      return Arrays.stream(clazz.getEnumConstants())\n                .map(T::getMessage)\n                .collect(Collectors.toList());\n   \n   }\n   \n}\n</code></pre>\n<p><strong>HostSelectionMethodOptions.java</strong></p>\n<pre><code>public enum HostSelectionMethodOptions implements Utils&lt;HostSelectionMethodOptions&gt; {\n   \n   FIND_ALL(&quot;Find all&quot;),\n   FIND_BY_LASTNAME_PREFIX(&quot;Find by last name prefix&quot;),\n   FIND_BY_CITY_STATE(&quot;Find by city &amp; state&quot;);\n   \n   private final String message;\n   \n   HostSelectionMethodOptions(String message) {\n      this.message = message;\n   }\n   \n   public String getMessage() {\n      return message;\n   }\n   \n}\n</code></pre>\n<p>Then just do this - <code>Utils.asListString(HostSelectionMethodOptions.class);</code></p>\n"},{"tags":[],"owner":{"account_id":238684,"reputation":22543,"user_id":507738,"accept_rate":71,"display_name":"MC Emperor"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1641400718,"creation_date":1641400718,"answer_id":70596442,"question_id":70570084,"body_markdown":"I basically had the same idea as davidalayachew.\r\n\r\nAn enum can implement an interface. So if you create a common `asListString` which accepts an `enum` type, you could get the desired result.\r\n\r\nFirst, create an `Options` interface and let both `enum`s implement it:\r\n\r\n```java\r\ninterface Options {\r\n    String getMessage();\r\n}\r\n```\r\n\r\n```java\r\nenum HostSelectionMethodOptions implements Options { ... }\r\nenum MainMenuOptions implements Options { ... }\r\n```\r\n\r\nNow create a method like this:\r\n\r\n```java\r\npublic static &lt;T extends Enum&lt;T&gt; &amp; Options&gt; List&lt;String&gt; asListString(Class&lt;T&gt; type) {\r\n    return Arrays.stream(type.getEnumConstants())\r\n        .map(T::getMessage)\r\n        .collect(Collectors.toList());\r\n}\r\n```\r\n\r\nThe method declares a type argument: `&lt;T extends Enum&lt;T&gt; &amp; Options&gt;`. Here, `T` is an *intersection type*, so it extends both `Enum` and the `Options` interface. You can call it like this:\r\n\r\n```java\r\nasListString(MainMenuOptions.class);\r\n```","title":"Code reuse: returning lists of enum fields with common getter methods","body":"<p>I basically had the same idea as davidalayachew.</p>\n<p>An enum can implement an interface. So if you create a common <code>asListString</code> which accepts an <code>enum</code> type, you could get the desired result.</p>\n<p>First, create an <code>Options</code> interface and let both <code>enum</code>s implement it:</p>\n<pre class=\"lang-java prettyprint-override\"><code>interface Options {\n    String getMessage();\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>enum HostSelectionMethodOptions implements Options { ... }\nenum MainMenuOptions implements Options { ... }\n</code></pre>\n<p>Now create a method like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static &lt;T extends Enum&lt;T&gt; &amp; Options&gt; List&lt;String&gt; asListString(Class&lt;T&gt; type) {\n    return Arrays.stream(type.getEnumConstants())\n        .map(T::getMessage)\n        .collect(Collectors.toList());\n}\n</code></pre>\n<p>The method declares a type argument: <code>&lt;T extends Enum&lt;T&gt; &amp; Options&gt;</code>. Here, <code>T</code> is an <em>intersection type</em>, so it extends both <code>Enum</code> and the <code>Options</code> interface. You can call it like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>asListString(MainMenuOptions.class);\n</code></pre>\n"}],"owner":{"account_id":22794075,"reputation":87,"user_id":16947902,"display_name":"friend.code"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":219,"favorite_count":0,"down_vote_count":0,"up_vote_count":6,"accepted_answer_id":70570794,"answer_count":3,"score":6,"last_activity_date":1641402394,"creation_date":1641235212,"question_id":70570084,"body_markdown":"I have two enums:\r\n\r\n### Main Menu Options\r\n\r\n    public enum MainMenuOptions {\r\n        \r\n        EXIT(&quot;Exit&quot;),\r\n        VIEW_RESERVATIONS(&quot;View Reservations By Host&quot;),\r\n        CREATE_RESERVATION(&quot;Create A Reservation&quot;),\r\n        EDIT_RESERVATION(&quot;Edit A Reservation&quot;),\r\n        CANCEL_RESERVATION(&quot;Cancel A Reservation&quot;);\r\n        \r\n        private final String message;\r\n        \r\n        MainMenuOptions(String message) {\r\n            this.message = message;\r\n        }\r\n        \r\n        public String getMessage() {\r\n            return message;\r\n        }\r\n        \r\n        public static List&lt;String&gt; asListString() {\r\n            return Arrays.stream(MainMenuOptions.values())\r\n                    .map(MainMenuOptions::getMessage)\r\n                    .collect(Collectors.toList());\r\n        }\r\n    }\r\n\r\n### Host Selection Method Options\r\n\r\n    public enum HostSelectionMethodOptions {\r\n        \r\n        FIND_ALL(&quot;Find all&quot;),\r\n        FIND_BY_LASTNAME_PREFIX(&quot;Find by last name prefix&quot;),\r\n        FIND_BY_CITY_STATE(&quot;Find by city &amp; state&quot;);\r\n        \r\n        String message;\r\n        \r\n        HostSelectionMethod(String message) {\r\n            this.message = message;\r\n        }\r\n        \r\n        public String getMessage() {\r\n            return message;\r\n        }\r\n        \r\n        public static List&lt;String&gt; asListString() {\r\n            return Arrays.stream(HostSelectionMethod.values())\r\n                    .map(HostSelectionMethod::getMessage)\r\n                    .collect(Collectors.toList());\r\n        }\r\n    }\r\n\r\nBoth enums share the same field\r\n\r\n    private final String message;\r\n\r\nThe same getter\r\n\r\n    public String getMessage() {\r\n        return message;\r\n    }\r\n\r\nAnd the same asListString() method\r\n\r\n    public static List&lt;String&gt; asListString() {\r\n        return Arrays.stream(MainMenuOptions.values())\r\n                .map(MainMenuOptions::getMessage)\r\n                .collect(Collectors.toList());\r\n    }\r\n\r\n### How can I DRY out these enums?\r\n\r\nI expect to have more enums with the same fields and methods, and it seems silly to write out the same thing over and over again for each one.\r\n\r\n* I tried making both of the enums extend a superclass, but enums cannot have extends clauses\r\n* I can create an interface that specifies the contract for the asListString() method, but that doesn&#39;t allow me to actually reuse any code.\r\n\r\nThe flavor I was hoping the code could have is something like this:\r\n\r\n    public class Utils {\r\n        \r\n        public static List&lt;String&gt; enumAsListString(Enum e) {\r\n            return e.values().stream.map(e::getMessage).collect(Collectors.toList());\r\n        }\r\n    }","title":"Code reuse: returning lists of enum fields with common getter methods","body":"<p>I have two enums:</p>\n<h3>Main Menu Options</h3>\n<pre><code>public enum MainMenuOptions {\n    \n    EXIT(&quot;Exit&quot;),\n    VIEW_RESERVATIONS(&quot;View Reservations By Host&quot;),\n    CREATE_RESERVATION(&quot;Create A Reservation&quot;),\n    EDIT_RESERVATION(&quot;Edit A Reservation&quot;),\n    CANCEL_RESERVATION(&quot;Cancel A Reservation&quot;);\n    \n    private final String message;\n    \n    MainMenuOptions(String message) {\n        this.message = message;\n    }\n    \n    public String getMessage() {\n        return message;\n    }\n    \n    public static List&lt;String&gt; asListString() {\n        return Arrays.stream(MainMenuOptions.values())\n                .map(MainMenuOptions::getMessage)\n                .collect(Collectors.toList());\n    }\n}\n</code></pre>\n<h3>Host Selection Method Options</h3>\n<pre><code>public enum HostSelectionMethodOptions {\n    \n    FIND_ALL(&quot;Find all&quot;),\n    FIND_BY_LASTNAME_PREFIX(&quot;Find by last name prefix&quot;),\n    FIND_BY_CITY_STATE(&quot;Find by city &amp; state&quot;);\n    \n    String message;\n    \n    HostSelectionMethod(String message) {\n        this.message = message;\n    }\n    \n    public String getMessage() {\n        return message;\n    }\n    \n    public static List&lt;String&gt; asListString() {\n        return Arrays.stream(HostSelectionMethod.values())\n                .map(HostSelectionMethod::getMessage)\n                .collect(Collectors.toList());\n    }\n}\n</code></pre>\n<p>Both enums share the same field</p>\n<pre><code>private final String message;\n</code></pre>\n<p>The same getter</p>\n<pre><code>public String getMessage() {\n    return message;\n}\n</code></pre>\n<p>And the same asListString() method</p>\n<pre><code>public static List&lt;String&gt; asListString() {\n    return Arrays.stream(MainMenuOptions.values())\n            .map(MainMenuOptions::getMessage)\n            .collect(Collectors.toList());\n}\n</code></pre>\n<h3>How can I DRY out these enums?</h3>\n<p>I expect to have more enums with the same fields and methods, and it seems silly to write out the same thing over and over again for each one.</p>\n<ul>\n<li>I tried making both of the enums extend a superclass, but enums cannot have extends clauses</li>\n<li>I can create an interface that specifies the contract for the asListString() method, but that doesn't allow me to actually reuse any code.</li>\n</ul>\n<p>The flavor I was hoping the code could have is something like this:</p>\n<pre><code>public class Utils {\n    \n    public static List&lt;String&gt; enumAsListString(Enum e) {\n        return e.values().stream.map(e::getMessage).collect(Collectors.toList());\n    }\n}\n</code></pre>\n"},{"tags":["java","testng","testng-eclipse"],"comments":[{"owner":{"account_id":8469754,"reputation":61,"user_id":7742878,"display_name":"swngstack"},"score":0,"creation_date":1640319682,"post_id":59860033,"comment_id":124569177,"body_markdown":"This answer might be useful to solve your issue https://stackoverflow.com/a/70469498/7742878","body":"This answer might be useful to solve your issue <a href=\"https://stackoverflow.com/a/70469498/7742878\">stackoverflow.com/a/70469498/7742878</a>"}],"answers":[{"tags":[],"owner":{"account_id":2091389,"reputation":790,"user_id":1914293,"accept_rate":83,"display_name":"user176692"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1579711060,"creation_date":1579710389,"answer_id":59864155,"question_id":59860033,"body_markdown":"Have you tried putting them in the same package? That&#39;s usually how you set up JUnit Tests. This is a JUnit5 example, but using the JUnit Platform Launcher, discovering tests by selecting the package works:\r\n\r\n\r\nhttps://github.com/doenn/sentences/tree/master/src\r\nhttps://github.com/doenn/sentences/blob/master/src/test/java/sentences/SentencesTest.java\r\nhttps://github.com/doenn/sentences/blob/master/src/main/java/sentences/SentenceTests.java\r\n\r\n\r\nOn the testNG side, yes should be able to put tests in src/test also. See [this answer][1] on example folder layouts with testNG.\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/24298447/run-test-classes-from-other-path-in-testng-xml-file","title":"can&#39;t able to call code inside src/test/java from src/main/java?","body":"<p>Have you tried putting them in the same package? That's usually how you set up JUnit Tests. This is a JUnit5 example, but using the JUnit Platform Launcher, discovering tests by selecting the package works:</p>\n\n<p><a href=\"https://github.com/doenn/sentences/tree/master/src\" rel=\"nofollow noreferrer\">https://github.com/doenn/sentences/tree/master/src</a>\n<a href=\"https://github.com/doenn/sentences/blob/master/src/test/java/sentences/SentencesTest.java\" rel=\"nofollow noreferrer\">https://github.com/doenn/sentences/blob/master/src/test/java/sentences/SentencesTest.java</a>\n<a href=\"https://github.com/doenn/sentences/blob/master/src/main/java/sentences/SentenceTests.java\" rel=\"nofollow noreferrer\">https://github.com/doenn/sentences/blob/master/src/main/java/sentences/SentenceTests.java</a></p>\n\n<p>On the testNG side, yes should be able to put tests in src/test also. See <a href=\"https://stackoverflow.com/questions/24298447/run-test-classes-from-other-path-in-testng-xml-file\">this answer</a> on example folder layouts with testNG.</p>\n"},{"tags":[],"owner":{"account_id":23770913,"reputation":24,"user_id":17784990,"display_name":"Austngmnz"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641401763,"creation_date":1641401763,"answer_id":70596643,"question_id":59860033,"body_markdown":"It might depend on how your project is set up, but I know for all of my projects, anything in the test folder IntelliJ will not let you call from the main folder, only the other way around. idk if this is a java thing or specifically from the IDE, but usually you wouldn&#39;t want to rely on anything from your test packages in your actual build. \r\n\r\nTo add, I&#39;m pretty sure the test package of your projects are designed specifically to test your code outside of it being built, and arent included in the actual build of the program when it&#39;s running. So any calls to the classes within would not actually have anything to call to during the program running. If you are trying to create some form of test that is ran during the programs runtime, I&#39;d create it in src/main/ then create a package for your verification tests there, where they will be included in the build. Just keep in mind that these tests will not run in any CICD style building check by default, so if all your tests are in there, you might get a bugged out program with failing tests past the checks without failing. ","title":"can&#39;t able to call code inside src/test/java from src/main/java?","body":"<p>It might depend on how your project is set up, but I know for all of my projects, anything in the test folder IntelliJ will not let you call from the main folder, only the other way around. idk if this is a java thing or specifically from the IDE, but usually you wouldn't want to rely on anything from your test packages in your actual build.</p>\n<p>To add, I'm pretty sure the test package of your projects are designed specifically to test your code outside of it being built, and arent included in the actual build of the program when it's running. So any calls to the classes within would not actually have anything to call to during the program running. If you are trying to create some form of test that is ran during the programs runtime, I'd create it in src/main/ then create a package for your verification tests there, where they will be included in the build. Just keep in mind that these tests will not run in any CICD style building check by default, so if all your tests are in there, you might get a bugged out program with failing tests past the checks without failing.</p>\n"}],"owner":{"account_id":13694632,"reputation":411,"user_id":9881640,"display_name":"Vipul Gupta"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1244,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1641401763,"creation_date":1579696991,"question_id":59860033,"body_markdown":"I am using testNG for writing test cases, all testcase code is inside src/test/java folder, now i want to run testcases inside this folder from a class inside src/main/java after deployment of the application,will it be possible?\r\n\r\nfile under src/main/java-&gt; TestNGRun\r\n\r\n``` lang-java\r\npublic class TestNGRun {\r\n\tpublic static void runTestNg() {\r\n\t\tTestListenerAdapter tla = new TestListenerAdapter();\r\n\t\tTestNG testNG = new TestNG();\r\n\t\ttestNG.addListener(tla);\r\n\t\tList&lt;String&gt; suites = new ArrayList&lt;String&gt;();\r\n\t\tURL filePathUrl = TestNGRun.class.getClassLoader().getResource(&quot;/testng.xml&quot;);\r\n\t\tsuites.add(filePathUrl.getPath());\r\n\t\ttestNG.setTestSuites(suites);\r\n\t\ttestNG.run();\r\n\t}\r\n}\r\n```\r\nfile under src/main/resources--&gt; testng.xml\r\n\r\n``` lang-xml\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;!DOCTYPE suite SYSTEM &quot;https://testng.org/testng-1.0.dtd&quot;&gt;\r\n&lt;suite name=&quot;Suite&quot;&gt;\r\n\t&lt;listeners&gt;\r\n\t\t&lt;listener\r\n\t\t\tclass-name=&quot;com.cypress.prodService.testNG.CustomisedReports&quot;&gt;&lt;/listener&gt;\r\n\t&lt;/listeners&gt;\r\n\t&lt;test name=&quot;ProductServiceImplTest&quot;&gt;\r\n\t\t&lt;classes&gt;\r\n\t\t\t&lt;class\r\n\t\t\t\tname=&quot;com.cypress.prodService.testNG.ProductServiceImplTest&quot;&gt;&lt;/class&gt;\r\n\t\t&lt;/classes&gt;\r\n\t&lt;/test&gt;\r\n&lt;/suite&gt;\r\n```\r\n\r\n\r\n file under src/test/java --&gt; ProductServiceImplTest.java\r\n\r\n``` lang-java\r\n@Test\r\npublic class ProductServiceImplTest {\r\n\t@Test\r\n\t\tpublic void addProduct() {`enter code here`\r\n\t\t\tString value=&quot;GoodMorning&quot;;\r\n\t\t\tassertEquals(&quot;Hello&quot;, value);\r\n\t\t}\r\n}\r\n```\r\n\r\n","title":"can&#39;t able to call code inside src/test/java from src/main/java?","body":"<p>I am using testNG for writing test cases, all testcase code is inside src/test/java folder, now i want to run testcases inside this folder from a class inside src/main/java after deployment of the application,will it be possible?</p>\n\n<p>file under src/main/java-> TestNGRun</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public class TestNGRun {\n    public static void runTestNg() {\n        TestListenerAdapter tla = new TestListenerAdapter();\n        TestNG testNG = new TestNG();\n        testNG.addListener(tla);\n        List&lt;String&gt; suites = new ArrayList&lt;String&gt;();\n        URL filePathUrl = TestNGRun.class.getClassLoader().getResource(\"/testng.xml\");\n        suites.add(filePathUrl.getPath());\n        testNG.setTestSuites(suites);\n        testNG.run();\n    }\n}\n</code></pre>\n\n<p>file under src/main/resources--> testng.xml</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE suite SYSTEM \"https://testng.org/testng-1.0.dtd\"&gt;\n&lt;suite name=\"Suite\"&gt;\n    &lt;listeners&gt;\n        &lt;listener\n            class-name=\"com.cypress.prodService.testNG.CustomisedReports\"&gt;&lt;/listener&gt;\n    &lt;/listeners&gt;\n    &lt;test name=\"ProductServiceImplTest\"&gt;\n        &lt;classes&gt;\n            &lt;class\n                name=\"com.cypress.prodService.testNG.ProductServiceImplTest\"&gt;&lt;/class&gt;\n        &lt;/classes&gt;\n    &lt;/test&gt;\n&lt;/suite&gt;\n</code></pre>\n\n<p>file under src/test/java --> ProductServiceImplTest.java</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>@Test\npublic class ProductServiceImplTest {\n    @Test\n        public void addProduct() {`enter code here`\n            String value=\"GoodMorning\";\n            assertEquals(\"Hello\", value);\n        }\n}\n</code></pre>\n"},{"tags":["java","spring","spring-boot"],"comments":[{"owner":{"account_id":1632105,"reputation":6968,"user_id":1506440,"display_name":"MattR"},"score":1,"creation_date":1591662134,"post_id":62270318,"comment_id":110135140,"body_markdown":"Spring can bind to class properties like that (&quot;relaxed binding&quot;) but in your case it&#39;s a map key so &quot;name-with-dashes&quot; is just a string - Spring can&#39;t know you want dashes in there... Using simple lower-case property names will make your life easier :-)","body":"Spring can bind to class properties like that (&quot;relaxed binding&quot;) but in your case it&#39;s a map key so &quot;name-with-dashes&quot; is just a string - Spring can&#39;t know you want dashes in there... Using simple lower-case property names will make your life easier :-)"},{"owner":{"account_id":2885021,"reputation":351,"user_id":2475137,"display_name":"EaterOfFromage"},"score":0,"creation_date":1591676377,"post_id":62270318,"comment_id":110138233,"body_markdown":"Indeed it would. I suppose that makes sense. I was planning on making the change anyways, since it will likely work smoother, but I was curious as to whether this was a bug or not. Your answer makes sense though - though I wish it could resolve the name by just... you know... comparing it to the on in the configs that it is overriding. Seems odd that it both sets the new one AND overrides the old one.","body":"Indeed it would. I suppose that makes sense. I was planning on making the change anyways, since it will likely work smoother, but I was curious as to whether this was a bug or not. Your answer makes sense though - though I wish it could resolve the name by just... you know... comparing it to the on in the configs that it is overriding. Seems odd that it both sets the new one AND overrides the old one."}],"answers":[{"tags":[],"owner":{"account_id":9968365,"reputation":160,"user_id":7375343,"display_name":"Luyang Du"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641401724,"creation_date":1641401724,"answer_id":70596630,"question_id":62270318,"body_markdown":"Recently, I ran into a similar problem with &quot;relaxed binding&quot;. My problem was that my internal config didn&#39;t get overwritten by the external config, where the internal config is an exact match and the external config is not. So there is a similarity here but not exactly as yours. However, **when I change the external config to be the exact match, it overwrites.**\r\n\r\nI haven&#39;t found any documentation about this yet but I&#39;m fairly sure **this is a priority issue** and how &quot;relaxed&quot; the binding actually is. In my case, it totally makes sense that the **internal exact matching took priority and the &quot;relaxed&quot; external one (an old typo) is discarded.** \r\n\r\nTo answer your question, since your object is a map, where the pairs don&#39;t start with strict keys. That makes it even fuzzier (if not impossible) to overwrite. My thoughts are that it couldn&#39;t differentiate between the new keys and the keys to overwrite unless it&#39;s an exact match. Thus, it makes sense for the new system env-vars to be inserted as new keys.\r\n\r\nNow you probably will ask how would you make it exact in this case. Well, you can&#39;t, unless you change your internal config to follow the system properties naming rules. Or you can have external config file that has the exact naming.\r\n\r\nOverall, I think &quot;relaxed binding&quot; is more like a fall back option. It shouldn&#39;t be your first choice. **Try using exact naming when you can.** I&#39;d say that this feature is probably more helpful when an old project upgrading to a new version and the devs wouldn&#39;t have to go through tons of config files to change names.","title":"Springboot relaxed binding with maps is duplicating properties","body":"<p>Recently, I ran into a similar problem with &quot;relaxed binding&quot;. My problem was that my internal config didn't get overwritten by the external config, where the internal config is an exact match and the external config is not. So there is a similarity here but not exactly as yours. However, <strong>when I change the external config to be the exact match, it overwrites.</strong></p>\n<p>I haven't found any documentation about this yet but I'm fairly sure <strong>this is a priority issue</strong> and how &quot;relaxed&quot; the binding actually is. In my case, it totally makes sense that the <strong>internal exact matching took priority and the &quot;relaxed&quot; external one (an old typo) is discarded.</strong></p>\n<p>To answer your question, since your object is a map, where the pairs don't start with strict keys. That makes it even fuzzier (if not impossible) to overwrite. My thoughts are that it couldn't differentiate between the new keys and the keys to overwrite unless it's an exact match. Thus, it makes sense for the new system env-vars to be inserted as new keys.</p>\n<p>Now you probably will ask how would you make it exact in this case. Well, you can't, unless you change your internal config to follow the system properties naming rules. Or you can have external config file that has the exact naming.</p>\n<p>Overall, I think &quot;relaxed binding&quot; is more like a fall back option. It shouldn't be your first choice. <strong>Try using exact naming when you can.</strong> I'd say that this feature is probably more helpful when an old project upgrading to a new version and the devs wouldn't have to go through tons of config files to change names.</p>\n"}],"owner":{"account_id":2885021,"reputation":351,"user_id":2475137,"display_name":"EaterOfFromage"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":636,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":1,"score":3,"last_activity_date":1641401724,"creation_date":1591646533,"question_id":62270318,"body_markdown":"I&#39;ve got an application.yml that looks something like this:\r\n\r\n```\r\nroot:\r\n  mapkey:\r\n    name-with-dashes:\r\n      vara: some value 1\r\n      varb: 1\r\n    different-name-with-dashes:\r\n      vara: some value 2\r\n      varb: 2\r\n```\r\n\r\nI am using the `@ConfigurationProperties` annotation to inject a config POJO that matches this structure. It looks basically like this (removed constructors etc. for readability, but just know that it works):\r\n\r\n```\r\n@Configuration\r\n@ConfigurationProperties(&quot;root&quot;)\r\npublic class ParentConfig {\r\n    private Map&lt;String, ChildConfig&gt; mapkey;\r\n}\r\n```\r\n\r\n```\r\npublic class ChildConfig {\r\n    private String vara;\r\n    private Integer varb;\r\n}\r\n```\r\n\r\nLocally when testing this, I have no issues and the injection works fine.\r\n\r\nHowever, I run into an issue when trying to deploy and override these fields with system variables. From the [Springboot Documentation][1], it says that the system properties should be created by converting the periods to underscores, removing the dashes, and converting to uppercase. In my case then I end up with variables like this:\r\n\r\n```\r\nROOT_MAPKEY_NAMEWITHDASHES_VARA: deployment value 1\r\nROOT_MAPKEY_NAMEWITHDASHES_VARB: 6\r\nROOT_MAPKEY_DIFFERENTNAMEWITHDASHES_VARA: deployment value 2\r\nROOT_MAPKEY_DIFFERENTNAMEWITHDASHES_VARB: 12\r\n```\r\n\r\nHowever, when I run the application with these variables and inspect the `ParentConfig` object, the map looks like this:\r\n\r\n```\r\n{\r\n    mapkey: {\r\n        name-with-dashes: {\r\n            vara: deployment value 1\r\n            varb: 6\r\n        }, \r\n        namewithdashes: {\r\n            vara: deployment value 1\r\n            varb: 6\r\n        }, \r\n        different-name-with-dashes: {\r\n            vara: deployment value 2\r\n            varb: 12\r\n        }, \r\n        differentnamewithdashes: {\r\n            vara: deployment value 2\r\n            varb: 12\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nIt&#39;s duplicating the properties with and without dashes and I have no idea why. And not just that, but all of the values have the deployment values, not the application.yml values. Very confusing.\r\n\r\n  [1]: https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-external-config-relaxed-binding-from-environment-variables","title":"Springboot relaxed binding with maps is duplicating properties","body":"<p>I've got an application.yml that looks something like this:</p>\n\n<pre><code>root:\n  mapkey:\n    name-with-dashes:\n      vara: some value 1\n      varb: 1\n    different-name-with-dashes:\n      vara: some value 2\n      varb: 2\n</code></pre>\n\n<p>I am using the <code>@ConfigurationProperties</code> annotation to inject a config POJO that matches this structure. It looks basically like this (removed constructors etc. for readability, but just know that it works):</p>\n\n<pre><code>@Configuration\n@ConfigurationProperties(\"root\")\npublic class ParentConfig {\n    private Map&lt;String, ChildConfig&gt; mapkey;\n}\n</code></pre>\n\n<pre><code>public class ChildConfig {\n    private String vara;\n    private Integer varb;\n}\n</code></pre>\n\n<p>Locally when testing this, I have no issues and the injection works fine.</p>\n\n<p>However, I run into an issue when trying to deploy and override these fields with system variables. From the <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-external-config-relaxed-binding-from-environment-variables\" rel=\"nofollow noreferrer\">Springboot Documentation</a>, it says that the system properties should be created by converting the periods to underscores, removing the dashes, and converting to uppercase. In my case then I end up with variables like this:</p>\n\n<pre><code>ROOT_MAPKEY_NAMEWITHDASHES_VARA: deployment value 1\nROOT_MAPKEY_NAMEWITHDASHES_VARB: 6\nROOT_MAPKEY_DIFFERENTNAMEWITHDASHES_VARA: deployment value 2\nROOT_MAPKEY_DIFFERENTNAMEWITHDASHES_VARB: 12\n</code></pre>\n\n<p>However, when I run the application with these variables and inspect the <code>ParentConfig</code> object, the map looks like this:</p>\n\n<pre><code>{\n    mapkey: {\n        name-with-dashes: {\n            vara: deployment value 1\n            varb: 6\n        }, \n        namewithdashes: {\n            vara: deployment value 1\n            varb: 6\n        }, \n        different-name-with-dashes: {\n            vara: deployment value 2\n            varb: 12\n        }, \n        differentnamewithdashes: {\n            vara: deployment value 2\n            varb: 12\n        }\n    }\n}\n</code></pre>\n\n<p>It's duplicating the properties with and without dashes and I have no idea why. And not just that, but all of the values have the deployment values, not the application.yml values. Very confusing.</p>\n"},{"tags":["java","hibernate","jpa","sqlite"],"comments":[{"owner":{"account_id":150404,"reputation":42109,"user_id":363573,"accept_rate":97,"display_name":"Stephan"},"score":0,"creation_date":1451759542,"post_id":13891006,"comment_id":56882874,"body_markdown":"Possible duplicate of [SQLITE\\_BUSY The database file is locked (database is locked) in wicket](http://stackoverflow.com/questions/8559623/sqlite-busy-the-database-file-is-locked-database-is-locked-in-wicket)","body":"Possible duplicate of <a href=\"http://stackoverflow.com/questions/8559623/sqlite-busy-the-database-file-is-locked-database-is-locked-in-wicket\">SQLITE_BUSY The database file is locked (database is locked) in wicket</a>"}],"answers":[{"tags":[],"owner":{"account_id":1988170,"reputation":2527,"user_id":1782868,"accept_rate":100,"display_name":"sorencito"},"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1462248436,"creation_date":1355563848,"answer_id":13891054,"question_id":13891006,"body_markdown":"Try `@Transactional(readonly=true)` for those methods that only do reads. Maybe that works for you.","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>Try <code>@Transactional(readonly=true)</code> for those methods that only do reads. Maybe that works for you.</p>\n"},{"tags":[],"owner":{"account_id":1988170,"reputation":2527,"user_id":1782868,"accept_rate":100,"display_name":"sorencito"},"down_vote_count":0,"up_vote_count":32,"is_accepted":true,"score":32,"last_activity_date":1355572116,"creation_date":1355572116,"answer_id":13891889,"question_id":13891006,"body_markdown":"After some googling I found that it is a bad practice to use multiple connections when connecting to SQLite. See\r\n\r\n http://touchlabblog.tumblr.com/post/24474398246/android-sqlite-locking\r\n\r\nSet your poolsize maxactive to 1 and try out.","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>After some googling I found that it is a bad practice to use multiple connections when connecting to SQLite. See</p>\n\n<p><a href=\"http://touchlabblog.tumblr.com/post/24474398246/android-sqlite-locking\" rel=\"noreferrer\">http://touchlabblog.tumblr.com/post/24474398246/android-sqlite-locking</a></p>\n\n<p>Set your poolsize maxactive to 1 and try out.</p>\n"},{"tags":[],"owner":{"account_id":235670,"reputation":1095,"user_id":502648,"display_name":"bowman han"},"down_vote_count":0,"up_vote_count":13,"is_accepted":false,"score":13,"last_activity_date":1402856847,"creation_date":1402856847,"answer_id":24232742,"question_id":13891006,"body_markdown":"There should be only ONE connection with your application.\r\nyou can use this to ensure.\r\n\r\n    public class SqliteHelper {\r\n    private static Connection c = null;\r\n    public static Connection getConn() throws Exception {\r\n        if(c == null){\r\n        Class.forName(&quot;org.sqlite.JDBC&quot;);\r\n        c = DriverManager.getConnection(&quot;jdbc:sqlite:D:/test.db&quot;);\r\n        }\r\n        return c;\r\n        }\r\n    }\r\n\r\n","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>There should be only ONE connection with your application.\nyou can use this to ensure.</p>\n\n<pre><code>public class SqliteHelper {\nprivate static Connection c = null;\npublic static Connection getConn() throws Exception {\n    if(c == null){\n    Class.forName(\"org.sqlite.JDBC\");\n    c = DriverManager.getConnection(\"jdbc:sqlite:D:/test.db\");\n    }\n    return c;\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3140002,"reputation":892,"user_id":2655624,"display_name":"johanwannheden"},"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1413925379,"creation_date":1413922352,"answer_id":26495432,"question_id":13891006,"body_markdown":"Note also that this may happen if you accidentally forget to close your connection:\r\n\r\n    Connection connection;\r\n    try {\r\n      Statement statement = connection.createStatement();\r\n      ResultSet resultSet = statement.executeQuery(QUERY);\r\n      if (resultSet.next()) { /* do something */ }\r\n    catch (SQLException e) { /* handle exception */ }\r\n    finally {\r\n      if (connection != null) {\r\n        try {\r\n          connection.close(); // &lt;-- This is important\r\n        } catch (SQLException e) {\r\n          /* handle exception */\r\n        }\r\n      }\r\n    }\r\n\r\nWhile the first database connection may work well once the server is started, subsequent queries may not, depending on how the connection pool is configured.","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>Note also that this may happen if you accidentally forget to close your connection:</p>\n\n<pre><code>Connection connection;\ntry {\n  Statement statement = connection.createStatement();\n  ResultSet resultSet = statement.executeQuery(QUERY);\n  if (resultSet.next()) { /* do something */ }\ncatch (SQLException e) { /* handle exception */ }\nfinally {\n  if (connection != null) {\n    try {\n      connection.close(); // &lt;-- This is important\n    } catch (SQLException e) {\n      /* handle exception */\n    }\n  }\n}\n</code></pre>\n\n<p>While the first database connection may work well once the server is started, subsequent queries may not, depending on how the connection pool is configured.</p>\n"},{"tags":[],"owner":{"account_id":11253033,"reputation":17915,"user_id":8253662,"display_name":"Mahesh Jamdade"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1525151748,"creation_date":1525151748,"answer_id":50111637,"question_id":13891006,"body_markdown":"Everytime you establish a connection make sure to close it after the work is done, It worked for me\r\nlike if you are using\r\n\r\n    Connection con = null;\r\n    PreparedStatement pst = con.prepareStatement(&quot;...query... &quot;); \r\n    /*\r\n     do some stuff \r\n    */\r\n    pst.executeQuery();\r\n    pst.close();\r\n    con.close();\r\n                \r\n\r\n    ","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>Everytime you establish a connection make sure to close it after the work is done, It worked for me\nlike if you are using</p>\n\n<pre><code>Connection con = null;\nPreparedStatement pst = con.prepareStatement(\"...query... \"); \n/*\n do some stuff \n*/\npst.executeQuery();\npst.close();\ncon.close();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":14045720,"reputation":96,"user_id":10146036,"display_name":"Soundous Bahri"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1544201379,"creation_date":1544201379,"answer_id":53673734,"question_id":13891006,"body_markdown":"For me the problem was that I was opening too much Sessions\r\nSo I made the session field in my DAO class static \r\n","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>For me the problem was that I was opening too much Sessions\nSo I made the session field in my DAO class static </p>\n"},{"tags":[],"owner":{"account_id":6010717,"reputation":1844,"user_id":4721265,"accept_rate":51,"display_name":"ParisaN"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1573298482,"creation_date":1573298482,"answer_id":58778745,"question_id":13891006,"body_markdown":"Thanks from bowman han, I added a piece of code to his solution and it worked for me.\r\n\r\n    private static Connection c = null;\r\n    public static Connection connect() throws Exception {\r\n\r\n        if (c == null) {\r\n            c = (Connection) DriverManager.getConnection(url);\r\n        } else {\r\n            c.close();\r\n            c = (Connection) DriverManager.getConnection(url);\r\n        }\r\n        return c;\r\n    }","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>Thanks from bowman han, I added a piece of code to his solution and it worked for me.</p>\n\n<pre><code>private static Connection c = null;\npublic static Connection connect() throws Exception {\n\n    if (c == null) {\n        c = (Connection) DriverManager.getConnection(url);\n    } else {\n        c.close();\n        c = (Connection) DriverManager.getConnection(url);\n    }\n    return c;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":16543491,"reputation":11,"user_id":11953649,"display_name":"picc"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1604994773,"creation_date":1604994773,"answer_id":64764825,"question_id":13891006,"body_markdown":"I experienced the same problem, even though all connections, resulsets and statements were closed, I still had the error.\r\nThe problem for me was using the DB browser plugin in Intellij to visualize and manage tables. Disconnecting the database from this tool solved the problem.\r\nSo make sure that no external tool is connecting to the database and locking tables.\r\n","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>I experienced the same problem, even though all connections, resulsets and statements were closed, I still had the error.\nThe problem for me was using the DB browser plugin in Intellij to visualize and manage tables. Disconnecting the database from this tool solved the problem.\nSo make sure that no external tool is connecting to the database and locking tables.</p>\n"},{"tags":[],"owner":{"account_id":200189,"reputation":20266,"user_id":445908,"accept_rate":79,"display_name":"Siwei"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1618746062,"creation_date":1618746062,"answer_id":67148104,"question_id":13891006,"body_markdown":"In my case, there are thread using sqlite connection in the background, which caused this error. \r\n\r\n1. close sqlitebrowser\r\n2. close electron app ( maybe need restart)\r\n3. re-run your program.\r\n\r\n","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>In my case, there are thread using sqlite connection in the background, which caused this error.</p>\n<ol>\n<li>close sqlitebrowser</li>\n<li>close electron app ( maybe need restart)</li>\n<li>re-run your program.</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":22357103,"reputation":1,"user_id":16574181,"display_name":"N&#224;&#241;&#224; Y&#225;w S&#231;r&#236;pt&#251;r&#233;s"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1630020192,"creation_date":1630020192,"answer_id":68946358,"question_id":13891006,"body_markdown":"You have opened another application containing the database,\r\nTry to close that application and run your program again. This worked for me  ","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>You have opened another application containing the database,\nTry to close that application and run your program again. This worked for me</p>\n"},{"tags":[],"owner":{"account_id":2090615,"reputation":10946,"user_id":1860540,"accept_rate":62,"display_name":"Eliya Cohen"},"down_vote_count":0,"up_vote_count":23,"is_accepted":false,"score":23,"last_activity_date":1641401486,"creation_date":1641401486,"answer_id":70596592,"question_id":13891006,"body_markdown":"For anyone who&#39;s having issues with it in WSL2:\r\n\r\nHappened to me when I was using WSL2 &amp; Datagrip, even tho the database wasn&#39;t busy.\r\n\r\nIt turns out that Datagrip has tried to connect to the database file that existed inside WSL2 via Windows&#39; sqlite3.\r\n\r\nMoving the file from WSL2 to a Windows file directory seems to solve this issue","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>For anyone who's having issues with it in WSL2:</p>\n<p>Happened to me when I was using WSL2 &amp; Datagrip, even tho the database wasn't busy.</p>\n<p>It turns out that Datagrip has tried to connect to the database file that existed inside WSL2 via Windows' sqlite3.</p>\n<p>Moving the file from WSL2 to a Windows file directory seems to solve this issue</p>\n"}],"owner":{"account_id":1659739,"reputation":3561,"user_id":1528246,"accept_rate":39,"display_name":"rogergl"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":95403,"favorite_count":0,"down_vote_count":0,"up_vote_count":41,"accepted_answer_id":13891889,"answer_count":11,"score":41,"last_activity_date":1641401486,"creation_date":1355563446,"question_id":13891006,"body_markdown":"If I run multiple threads against my web app I get:\r\n\r\n    java.sql.SQLException: [SQLITE_BUSY]  The database file is locked (database is locked)\r\n    \tat org.sqlite.DB.newSQLException(DB.java:383)\r\n    \tat org.sqlite.DB.newSQLException(DB.java:387)\r\n    \tat org.sqlite.DB.execute(DB.java:339)\r\n    \tat org.sqlite.PrepStmt.executeQuery(PrepStmt.java:75)\r\n    \tat org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)\r\n\r\nI do know that only one thread can write to a sqlite database but I&#39;m only reading from the database. So why do I get this error message ?\r\n\r\nBTW: My connection pool looks like this:\r\n\r\n    &lt;bean class=&quot;org.apache.commons.dbcp.BasicDataSource&quot;\r\n    \t\tdestroy-method=&quot;close&quot; id=&quot;dataSource&quot;&gt;\r\n    \t&lt;property name=&quot;driverClassName&quot; value=&quot;${database.driverClassName}&quot; /&gt;\r\n    \t&lt;property name=&quot;url&quot; value=&quot;${database.url}&quot; /&gt;\r\n    \t&lt;property name=&quot;username&quot; value=&quot;${database.username}&quot; /&gt;\r\n    \t&lt;property name=&quot;password&quot; value=&quot;${database.password}&quot; /&gt;\r\n    \t&lt;property name=&quot;initialSize&quot; value=&quot;1&quot; /&gt;\r\n    \t&lt;property name=&quot;maxActive&quot; value=&quot;2&quot; /&gt;\r\n    \t&lt;property name=&quot;maxIdle&quot; value=&quot;1&quot; /&gt;\r\n    \t&lt;property name=&quot;poolPreparedStatements&quot; value=&quot;true&quot; /&gt;\r\n    &lt;/bean&gt;\r\n\r\nThe setup is: Java 1.6, Tomcat 7.0.34, Spring 3.2, Hibernate 3.6.9 and sqlite3 3.7.2 \r\n\r\nRegards\r\n  Roger","title":"Getting [SQLITE_BUSY] database file is locked with select statements","body":"<p>If I run multiple threads against my web app I get:</p>\n\n<pre><code>java.sql.SQLException: [SQLITE_BUSY]  The database file is locked (database is locked)\n    at org.sqlite.DB.newSQLException(DB.java:383)\n    at org.sqlite.DB.newSQLException(DB.java:387)\n    at org.sqlite.DB.execute(DB.java:339)\n    at org.sqlite.PrepStmt.executeQuery(PrepStmt.java:75)\n    at org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)\n</code></pre>\n\n<p>I do know that only one thread can write to a sqlite database but I'm only reading from the database. So why do I get this error message ?</p>\n\n<p>BTW: My connection pool looks like this:</p>\n\n<pre><code>&lt;bean class=\"org.apache.commons.dbcp.BasicDataSource\"\n        destroy-method=\"close\" id=\"dataSource\"&gt;\n    &lt;property name=\"driverClassName\" value=\"${database.driverClassName}\" /&gt;\n    &lt;property name=\"url\" value=\"${database.url}\" /&gt;\n    &lt;property name=\"username\" value=\"${database.username}\" /&gt;\n    &lt;property name=\"password\" value=\"${database.password}\" /&gt;\n    &lt;property name=\"initialSize\" value=\"1\" /&gt;\n    &lt;property name=\"maxActive\" value=\"2\" /&gt;\n    &lt;property name=\"maxIdle\" value=\"1\" /&gt;\n    &lt;property name=\"poolPreparedStatements\" value=\"true\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>The setup is: Java 1.6, Tomcat 7.0.34, Spring 3.2, Hibernate 3.6.9 and sqlite3 3.7.2 </p>\n\n<p>Regards\n  Roger</p>\n"},{"tags":["java","multithreading","asynchronous","completable-future","completion-stage"],"comments":[{"owner":{"account_id":2053598,"reputation":41316,"user_id":1831987,"display_name":"VGR"},"score":0,"creation_date":1641398511,"post_id":70593564,"comment_id":124795754,"body_markdown":"Interesting.  Looks like JIT optimization is smart enough to know that returning a constant value takes essentially no time at all, so the overhead of a new thread isnt worth it.","body":"Interesting.  Looks like JIT optimization is smart enough to know that returning a constant value takes essentially no time at all, so the overhead of a new thread isnt worth it."},{"owner":{"account_id":249169,"reputation":19388,"user_id":525036,"accept_rate":25,"display_name":"Didier L"},"score":0,"creation_date":1641400326,"post_id":70593564,"comment_id":124796496,"body_markdown":"@VGR very unlikely to be related to JIT optimization. Its just that by the time `thenApply()` is called, the first future is already completed. In that case, the next stage will be executed on the current thread  there is no other thread/executor it could use. If you dont want that you need to use the `then*Async()` methods, as mentioned by OP at the end of the question.","body":"@VGR very unlikely to be related to JIT optimization. Its just that by the time <code>thenApply()</code> is called, the first future is already completed. In that case, the next stage will be executed on the current thread  there is no other thread/executor it could use. If you dont want that you need to use the <code>then*Async()</code> methods, as mentioned by OP at the end of the question."},{"owner":{"account_id":249169,"reputation":19388,"user_id":525036,"accept_rate":25,"display_name":"Didier L"},"score":0,"creation_date":1641400864,"post_id":70593564,"comment_id":124796762,"body_markdown":"_I want to avoid passing the data []_: what do you mean by that? Do you mean data stored in `ThreadLocal`? The `CompletableFuture` API does not make any guarantee on the thread that will be used, nor does it expose any context that would be passed between stages. In fact, it wouldnt work really well for operations that combine multiple stages like `thenCombine()`, `thenCompose()` or `allOf()`. See also [Does CompletableFuture have a corresponding Local context?](https://stackoverflow.com/q/37933713/525036)","body":"<i>I want to avoid passing the data []</i>: what do you mean by that? Do you mean data stored in <code>ThreadLocal</code>? The <code>CompletableFuture</code> API does not make any guarantee on the thread that will be used, nor does it expose any context that would be passed between stages. In fact, it wouldnt work really well for operations that combine multiple stages like <code>thenCombine()</code>, <code>thenCompose()</code> or <code>allOf()</code>. See also <a href=\"https://stackoverflow.com/q/37933713/525036\">Does CompletableFuture have a corresponding Local context?</a>"},{"owner":{"account_id":2053598,"reputation":41316,"user_id":1831987,"display_name":"VGR"},"score":0,"creation_date":1641401054,"post_id":70593564,"comment_id":124796855,"body_markdown":"@DidierL I dont think `thenApply` places new tasks on a queue; it merely appends actions to an existing task.  So Im not sure why it would matter whether any other thread/executor is available.  Even if that did matter, CompletableFuture methods use the common ForkJoinPool if no explicit Executor is given.","body":"@DidierL I dont think <code>thenApply</code> places new tasks on a queue; it merely appends actions to an existing task.  So Im not sure why it would matter whether any other thread/executor is available.  Even if that did matter, CompletableFuture methods use the common ForkJoinPool if no explicit Executor is given."},{"owner":{"account_id":249169,"reputation":19388,"user_id":525036,"accept_rate":25,"display_name":"Didier L"},"score":0,"creation_date":1641401342,"post_id":70593564,"comment_id":124796986,"body_markdown":"@VGR The common ForkJoinPool is only used as default for the `*Async()` methods when no executor is provided. It does not apply for any other method. If a future is already completed and you chain a non-async call on it, it will always be executed on the current thread.","body":"@VGR The common ForkJoinPool is only used as default for the <code>*Async()</code> methods when no executor is provided. It does not apply for any other method. If a future is already completed and you chain a non-async call on it, it will always be executed on the current thread."},{"owner":{"account_id":1056871,"reputation":117729,"user_id":1059372,"accept_rate":97,"display_name":"Eugene"},"score":1,"creation_date":1641412310,"post_id":70593564,"comment_id":124801078,"body_markdown":"[related](https://stackoverflow.com/questions/65685715/will-a-chain-of-method-calls-completablefuture-api-execute-asynchronously-if-t/65691463#65691463)","body":"<a href=\"https://stackoverflow.com/questions/65685715/will-a-chain-of-method-calls-completablefuture-api-execute-asynchronously-if-t/65691463#65691463\">related</a>"}],"answers":[{"tags":[],"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"down_vote_count":0,"up_vote_count":8,"is_accepted":true,"score":8,"last_activity_date":1641401281,"creation_date":1641401281,"answer_id":70596543,"question_id":70593564,"body_markdown":"The method `thenApply` evaluates the function in the callers thread because the future has been completed already. Of course, when you insert a `sleep` into the supplier, the future has not been completed by the time, `thenApply` is called. Even a print statement might slow down the supplier enough to have the main thread invoke `thenApply` and `thenAccept` first. But this is not reliable behavior, you may get different results when running the code repeatedly.\r\n\r\nNot only does the future not remember which thread completed it, there is no way to tell an arbitrary thread to execute a particular code. The thread might be busy with something else, being entirely uncooperative, or even have terminated in the meanwhile.\r\n\r\nJust consider\r\n\r\n```java\r\nExecutorService s = Executors.newSingleThreadExecutor();\r\nCompletableFuture&lt;Integer&gt; cf = CompletableFuture.supplyAsync(() -&gt; {\r\n    System.out.println(&quot;supplyAsync: &quot; + Thread.currentThread().getName());\r\n    return 1;\r\n}, s);\r\ns.shutdown();\r\ns.awaitTermination(1, TimeUnit.DAYS);\r\ncf.thenApply(i -&gt; {\r\n    System.out.println(&quot;apply: &quot; + Thread.currentThread().getName());\r\n    return i + 1;\r\n})\r\n.thenAccept((i) -&gt; {\r\n    System.out.println(&quot;accept: &quot; + Thread.currentThread().getName());\r\n    System.out.println(&quot;result: &quot; + i);\r\n}).join();\r\n```\r\n\r\nHow could we expect the functions passed to `thenApply` and `thenAccept` to be executed in the already terminated pools worker thread?\r\n\r\nWe could also write\r\n\r\n```java\r\nCompletableFuture&lt;Integer&gt; cf = new CompletableFuture&lt;&gt;();\r\n\r\nThread t = new Thread(() -&gt; {\r\n    System.out.println(&quot;completing: &quot; + Thread.currentThread().getName());\r\n    cf.complete(1);\r\n});\r\nt.start();\r\nt.join();\r\n\r\nSystem.out.println(&quot;completer: &quot; + t.getName() + &quot; &quot; + t.getState());\r\ncf.thenApply(i -&gt; {\r\n    System.out.println(&quot;apply: &quot; + Thread.currentThread().getName());\r\n    return i + 1;\r\n})\r\n.thenAccept((i) -&gt; {\r\n    System.out.println(&quot;accept: &quot; + Thread.currentThread().getName());\r\n    System.out.println(&quot;result: &quot; + i);\r\n}).join();\r\n```\r\n\r\nwhich will print something alike\r\n\r\n```none\r\ncompleting: Thread-0\r\ncompleter: Thread-0 TERMINATED\r\napply: main\r\naccept: main\r\nresult: 2\r\n```\r\n\r\nObviously, we cant insist on this thread processing the subsequent stages.\r\n\r\nBut even when the thread is a still alive worker thread of a pool, it doesnt know that it has completed a future nor has it a notion of processing subsequent stages. Following the `Executor` abstraction, it just has received an arbitrary `Runnable` from the queue and after processing it, it proceeds with its main loop, fetching the next `Runnable` from the queue.\r\n\r\nSo once the first future has been completed, the only way to tell it to do the work of completing other futures, is by enqueuing the tasks. This is what happens when using `thenApplyAsync` specifying the same pool or performing all actions with the `Async` methods without an executor, i.e. using the default pool.\r\n\r\nWhen you use a [single threaded executor] for all `Async` methods, you can be sure that all actions are executed by the same thread, but they will still get through the pools queue. Since even then, its the main thread actually enqueuing the dependent actions in case of an already completed future, a thread safe queue and hence, synchronization overhead, is unavoidable.\r\n\r\nBut note that even if you manage to create the chain of dependent actions first, before a single worker thread processes them all sequentially, this overhead is still there. Each futures completion is done by storing the new state in a thread safe way, making the result potentially visible to all other threads, and atomically checking whether a concurrent completion (e.g. a cancelation) has happened in the meanwhile. Then, the dependent action(s) chained by other threads will be fetched, of course, in a thread safe way, before they are executed.\r\n\r\nAll these actions with synchronization semantics make it unlikely that there are benefits of processing the data by the same thread when having a chain of dependent `CompletableFuture`s.\r\n\r\nThe only way to have an actual local processing potentially with performance benefits is by using\r\n\r\n```java\r\nCompletableFuture.runAsync(() -&gt; {\r\n    System.out.println(&quot;supplyAsync: &quot; + Thread.currentThread().getName());\r\n    int i = 1;\r\n\r\n    System.out.println(&quot;apply: &quot; + Thread.currentThread().getName());\r\n    i = i + 1;\r\n\r\n    System.out.println(&quot;accept: &quot; + Thread.currentThread().getName());\r\n    System.out.println(&quot;result: &quot; + i);\r\n}).join();\r\n```\r\nOr, in other words, if you dont want detached processing, dont create detached processing stages in the first place.\r\n\r\n[single threaded executor]: https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/Executors.html#newSingleThreadExecutor()","title":"How to force CompletableFuture.thenApply() to run on the same thread that ran the previous stage?","body":"<p>The method <code>thenApply</code> evaluates the function in the callers thread because the future has been completed already. Of course, when you insert a <code>sleep</code> into the supplier, the future has not been completed by the time, <code>thenApply</code> is called. Even a print statement might slow down the supplier enough to have the main thread invoke <code>thenApply</code> and <code>thenAccept</code> first. But this is not reliable behavior, you may get different results when running the code repeatedly.</p>\n<p>Not only does the future not remember which thread completed it, there is no way to tell an arbitrary thread to execute a particular code. The thread might be busy with something else, being entirely uncooperative, or even have terminated in the meanwhile.</p>\n<p>Just consider</p>\n<pre class=\"lang-java prettyprint-override\"><code>ExecutorService s = Executors.newSingleThreadExecutor();\nCompletableFuture&lt;Integer&gt; cf = CompletableFuture.supplyAsync(() -&gt; {\n    System.out.println(&quot;supplyAsync: &quot; + Thread.currentThread().getName());\n    return 1;\n}, s);\ns.shutdown();\ns.awaitTermination(1, TimeUnit.DAYS);\ncf.thenApply(i -&gt; {\n    System.out.println(&quot;apply: &quot; + Thread.currentThread().getName());\n    return i + 1;\n})\n.thenAccept((i) -&gt; {\n    System.out.println(&quot;accept: &quot; + Thread.currentThread().getName());\n    System.out.println(&quot;result: &quot; + i);\n}).join();\n</code></pre>\n<p>How could we expect the functions passed to <code>thenApply</code> and <code>thenAccept</code> to be executed in the already terminated pools worker thread?</p>\n<p>We could also write</p>\n<pre class=\"lang-java prettyprint-override\"><code>CompletableFuture&lt;Integer&gt; cf = new CompletableFuture&lt;&gt;();\n\nThread t = new Thread(() -&gt; {\n    System.out.println(&quot;completing: &quot; + Thread.currentThread().getName());\n    cf.complete(1);\n});\nt.start();\nt.join();\n\nSystem.out.println(&quot;completer: &quot; + t.getName() + &quot; &quot; + t.getState());\ncf.thenApply(i -&gt; {\n    System.out.println(&quot;apply: &quot; + Thread.currentThread().getName());\n    return i + 1;\n})\n.thenAccept((i) -&gt; {\n    System.out.println(&quot;accept: &quot; + Thread.currentThread().getName());\n    System.out.println(&quot;result: &quot; + i);\n}).join();\n</code></pre>\n<p>which will print something alike</p>\n<pre class=\"lang-none prettyprint-override\"><code>completing: Thread-0\ncompleter: Thread-0 TERMINATED\napply: main\naccept: main\nresult: 2\n</code></pre>\n<p>Obviously, we cant insist on this thread processing the subsequent stages.</p>\n<p>But even when the thread is a still alive worker thread of a pool, it doesnt know that it has completed a future nor has it a notion of processing subsequent stages. Following the <code>Executor</code> abstraction, it just has received an arbitrary <code>Runnable</code> from the queue and after processing it, it proceeds with its main loop, fetching the next <code>Runnable</code> from the queue.</p>\n<p>So once the first future has been completed, the only way to tell it to do the work of completing other futures, is by enqueuing the tasks. This is what happens when using <code>thenApplyAsync</code> specifying the same pool or performing all actions with the <code>Async</code> methods without an executor, i.e. using the default pool.</p>\n<p>When you use a <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/Executors.html#newSingleThreadExecutor()\" rel=\"noreferrer\">single threaded executor</a> for all <code>Async</code> methods, you can be sure that all actions are executed by the same thread, but they will still get through the pools queue. Since even then, its the main thread actually enqueuing the dependent actions in case of an already completed future, a thread safe queue and hence, synchronization overhead, is unavoidable.</p>\n<p>But note that even if you manage to create the chain of dependent actions first, before a single worker thread processes them all sequentially, this overhead is still there. Each futures completion is done by storing the new state in a thread safe way, making the result potentially visible to all other threads, and atomically checking whether a concurrent completion (e.g. a cancelation) has happened in the meanwhile. Then, the dependent action(s) chained by other threads will be fetched, of course, in a thread safe way, before they are executed.</p>\n<p>All these actions with synchronization semantics make it unlikely that there are benefits of processing the data by the same thread when having a chain of dependent <code>CompletableFuture</code>s.</p>\n<p>The only way to have an actual local processing potentially with performance benefits is by using</p>\n<pre class=\"lang-java prettyprint-override\"><code>CompletableFuture.runAsync(() -&gt; {\n    System.out.println(&quot;supplyAsync: &quot; + Thread.currentThread().getName());\n    int i = 1;\n\n    System.out.println(&quot;apply: &quot; + Thread.currentThread().getName());\n    i = i + 1;\n\n    System.out.println(&quot;accept: &quot; + Thread.currentThread().getName());\n    System.out.println(&quot;result: &quot; + i);\n}).join();\n</code></pre>\n<p>Or, in other words, if you dont want detached processing, dont create detached processing stages in the first place.</p>\n"}],"owner":{"account_id":4705,"reputation":11890,"user_id":7205,"accept_rate":95,"display_name":"Srikanth"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2571,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"accepted_answer_id":70596543,"answer_count":1,"score":4,"last_activity_date":1641401281,"creation_date":1641388793,"question_id":70593564,"body_markdown":"Here&#39;s a short code version of the problem I&#39;m facing:\r\n\r\n    public static void main(String[] args) {\r\n        CompletableFuture.supplyAsync(() -&gt; {\r\n                    /*\r\n                    try {\r\n                        Thread.sleep(2000);\r\n                    } catch (InterruptedException ignored) {}\r\n                    */\r\n                    //System.out.println(&quot;supplyAsync: &quot; + Thread.currentThread().getName());\r\n                    return 1;\r\n                })\r\n                .thenApply(i -&gt; {\r\n                    System.out.println(&quot;apply: &quot; + Thread.currentThread().getName());\r\n                    return i + 1;\r\n                })\r\n                .thenAccept((i) -&gt; {\r\n                    System.out.println(&quot;accept: &quot; + Thread.currentThread().getName());\r\n                    System.out.println(&quot;result: &quot; + i);\r\n                }).join();\r\n    }\r\n\r\nThis is the output that I get:\r\n\r\n    apply: main\r\n    accept: main\r\n    result: 2\r\n\r\nI&#39;m surprised to see `main` there! I expected something like this which happens when I uncomment the `Thread.sleep()` call or even as much as uncomment the single `sysout` statement there:\r\n\r\n    supplyAsync: ForkJoinPool.commonPool-worker-1\r\n    apply: ForkJoinPool.commonPool-worker-1\r\n    accept: ForkJoinPool.commonPool-worker-1\r\n    result: 2\r\n\r\nI understand `thenApplyAsync()` will make sure it won&#39;t run on the `main` thread, but I want to avoid passing the data returned by the supplier from the thread that ran `supplyAsync` to the thread that&#39;s going to run `thenApply` and the other subsequent `then`s in the chain.\r\n","title":"How to force CompletableFuture.thenApply() to run on the same thread that ran the previous stage?","body":"<p>Here's a short code version of the problem I'm facing:</p>\n<pre><code>public static void main(String[] args) {\n    CompletableFuture.supplyAsync(() -&gt; {\n                /*\n                try {\n                    Thread.sleep(2000);\n                } catch (InterruptedException ignored) {}\n                */\n                //System.out.println(&quot;supplyAsync: &quot; + Thread.currentThread().getName());\n                return 1;\n            })\n            .thenApply(i -&gt; {\n                System.out.println(&quot;apply: &quot; + Thread.currentThread().getName());\n                return i + 1;\n            })\n            .thenAccept((i) -&gt; {\n                System.out.println(&quot;accept: &quot; + Thread.currentThread().getName());\n                System.out.println(&quot;result: &quot; + i);\n            }).join();\n}\n</code></pre>\n<p>This is the output that I get:</p>\n<pre><code>apply: main\naccept: main\nresult: 2\n</code></pre>\n<p>I'm surprised to see <code>main</code> there! I expected something like this which happens when I uncomment the <code>Thread.sleep()</code> call or even as much as uncomment the single <code>sysout</code> statement there:</p>\n<pre><code>supplyAsync: ForkJoinPool.commonPool-worker-1\napply: ForkJoinPool.commonPool-worker-1\naccept: ForkJoinPool.commonPool-worker-1\nresult: 2\n</code></pre>\n<p>I understand <code>thenApplyAsync()</code> will make sure it won't run on the <code>main</code> thread, but I want to avoid passing the data returned by the supplier from the thread that ran <code>supplyAsync</code> to the thread that's going to run <code>thenApply</code> and the other subsequent <code>then</code>s in the chain.</p>\n"},{"tags":["java","lambda","option-type"],"comments":[{"owner":{"account_id":162699,"reputation":138060,"user_id":3788176,"accept_rate":54,"display_name":"Andy Turner"},"score":0,"creation_date":1641400784,"post_id":70596383,"comment_id":124796727,"body_markdown":"`methodA()` and `methodB()` return fixed values here. Do you really need to use `flatMap`, `ifPresent` and `containsKey`?","body":"<code>methodA()</code> and <code>methodB()</code> return fixed values here. Do you really need to use <code>flatMap</code>, <code>ifPresent</code> and <code>containsKey</code>?"}],"answers":[{"tags":[],"owner":{"account_id":2139538,"reputation":42511,"user_id":1898563,"accept_rate":78,"display_name":"Michael"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1641400772,"creation_date":1641400772,"answer_id":70596460,"question_id":70596383,"body_markdown":"This is equivalent\r\n\r\n    Map methodC() throws SomeException {\r\n        Map&lt;String, String&gt; map = new HashMap&lt;&gt;(2);\r\n        map.put(&quot;A&quot;, methodA().orElseThrow(SomeException::new));\r\n        methodB().ifPresent(s -&gt; map.put(&quot;B&quot;, s));\r\n        return map;\r\n    }","title":"How to throw an exception in lambdas operating on methods which returns optional","body":"<p>This is equivalent</p>\n<pre><code>Map methodC() throws SomeException {\n    Map&lt;String, String&gt; map = new HashMap&lt;&gt;(2);\n    map.put(&quot;A&quot;, methodA().orElseThrow(SomeException::new));\n    methodB().ifPresent(s -&gt; map.put(&quot;B&quot;, s));\n    return map;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4482164,"reputation":6664,"user_id":3645944,"accept_rate":90,"display_name":"Pablo Matias Gomez"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641400782,"creation_date":1641400782,"answer_id":70596461,"question_id":70596383,"body_markdown":"Yes, you can use `orElseThrow`, like this:\r\n\r\n```\r\nmap.put(&quot;A&quot;, methodA().orElseThrow(() -&gt; new SomeExpection()));\r\n```","title":"How to throw an exception in lambdas operating on methods which returns optional","body":"<p>Yes, you can use <code>orElseThrow</code>, like this:</p>\n<pre><code>map.put(&quot;A&quot;, methodA().orElseThrow(() -&gt; new SomeExpection()));\n</code></pre>\n"}],"owner":{"account_id":303781,"reputation":3824,"user_id":612925,"accept_rate":67,"display_name":"tomasz-mer"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":242,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":70596460,"answer_count":2,"score":0,"last_activity_date":1641400782,"creation_date":1641400505,"question_id":70596383,"body_markdown":"I wrote some lambda expression which adds some values to the map based on methods which return optionals. I would like to throw some specyfic exception when there is no value under key &quot;A&quot;. I&#39;m checking the map using contains But it looks terrible :| I was trying to use orElseThrow but without good results. \r\n\r\nAny hints?\r\n\r\nHere is some sample code:\r\n\r\n    package com.aa;\r\n\r\n    import java.util.HashMap;\r\n    import java.util.Map;\r\n    import java.util.Optional;\r\n    \r\n    import com.aa.SomeExpection;\r\n    \r\n    public class SomeCLass\r\n    {\r\n        Optional&lt;String&gt; methodA()\r\n        {\r\n            return Optional.empty();\r\n        }\r\n    \r\n        Optional&lt;String&gt; methodB() {\r\n            return Optional.of(&quot;example&quot;);\r\n        }\r\n    \r\n        Map methodC() throws SomeExpection {\r\n            Map&lt;String, String&gt; map = new HashMap&lt;&gt;(2);\r\n            methodA().flatMap(s -&gt; {\r\n                map.put(&quot;A&quot;, s);\r\n                return methodB();\r\n            }).ifPresent(s -&gt; map.put(&quot;B&quot;, s));\r\n    \r\n    \r\n            if (map.containsKey(&quot;A&quot;)) {\r\n                return map;\r\n            }\r\n            throw new SomeExpection();\r\n        }\r\n    }\r\n\r\n\r\n","title":"How to throw an exception in lambdas operating on methods which returns optional","body":"<p>I wrote some lambda expression which adds some values to the map based on methods which return optionals. I would like to throw some specyfic exception when there is no value under key &quot;A&quot;. I'm checking the map using contains But it looks terrible :| I was trying to use orElseThrow but without good results.</p>\n<p>Any hints?</p>\n<p>Here is some sample code:</p>\n<pre><code>package com.aa;\n\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.Optional;\n\nimport com.aa.SomeExpection;\n\npublic class SomeCLass\n{\n    Optional&lt;String&gt; methodA()\n    {\n        return Optional.empty();\n    }\n\n    Optional&lt;String&gt; methodB() {\n        return Optional.of(&quot;example&quot;);\n    }\n\n    Map methodC() throws SomeExpection {\n        Map&lt;String, String&gt; map = new HashMap&lt;&gt;(2);\n        methodA().flatMap(s -&gt; {\n            map.put(&quot;A&quot;, s);\n            return methodB();\n        }).ifPresent(s -&gt; map.put(&quot;B&quot;, s));\n\n\n        if (map.containsKey(&quot;A&quot;)) {\n            return map;\n        }\n        throw new SomeExpection();\n    }\n}\n</code></pre>\n"},{"tags":["java","string","trim","spaces","remove-if"],"comments":[{"owner":{"account_id":2094057,"reputation":506072,"user_id":1863229,"accept_rate":58,"display_name":"Tim Biegeleisen"},"score":1,"creation_date":1641376067,"post_id":70590760,"comment_id":124786303,"body_markdown":"Can you give an example which actually has more than one leading/trailing whitespace character?","body":"Can you give an example which actually has more than one leading/trailing whitespace character?"},{"owner":{"account_id":18565410,"reputation":1,"user_id":13528479,"display_name":"ItsWhoYouThinkItIs"},"score":0,"creation_date":1641376216,"post_id":70590760,"comment_id":124786354,"body_markdown":"&quot;     XXXX    &quot; . If I use the trim() method it gives me &quot;XXXX&quot; but I only want &quot;   XXXX  &quot;. I want to remove exactly one whitespace at the end","body":"&quot;     XXXX    &quot; . If I use the trim() method it gives me &quot;XXXX&quot; but I only want &quot;   XXXX  &quot;. I want to remove exactly one whitespace at the end"},{"owner":{"account_id":1041463,"reputation":3845,"user_id":1047418,"display_name":"Torben"},"score":1,"creation_date":1641376987,"post_id":70590760,"comment_id":124786655,"body_markdown":"Note that &quot;white space&quot; means the category of characters that represent some kind of empty space. If you wish to remove specifically space characters (Unicode U+0020) and nothing else, then use the term &quot;space character&quot;.","body":"Note that &quot;white space&quot; means the category of characters that represent some kind of empty space. If you wish to remove specifically space characters (Unicode U+0020) and nothing else, then use the term &quot;space character&quot;."}],"answers":[{"tags":[],"owner":{"account_id":2094057,"reputation":506072,"user_id":1863229,"accept_rate":58,"display_name":"Tim Biegeleisen"},"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1641376317,"creation_date":1641376317,"answer_id":70590820,"question_id":70590760,"body_markdown":"If you just want to trim whitespace at the end, use `String#replaceAll()` with an appropriate regex:\r\n\r\n&lt;!-- language: java --&gt;\r\n\r\n    String input = &quot; XXXX &quot;;\r\n    String output = input.replaceAll(&quot;\\\\s+$&quot;, &quot;&quot;);\r\n    System.out.println(&quot;***&quot; + input + &quot;***&quot;);   // *** XXXX ***\r\n    System.out.println(&quot;***&quot; + output + &quot;***&quot;);  // *** XXXX***\r\n\r\nIf you really want to replace just _one_ whitespace character at the end, then replace on `\\s$` instead of `\\s+$`.","title":"How to remove a white space at the end of a string in java?","body":"<p>If you just want to trim whitespace at the end, use <code>String#replaceAll()</code> with an appropriate regex:</p>\n<pre class=\"lang-java prettyprint-override\"><code>String input = &quot; XXXX &quot;;\nString output = input.replaceAll(&quot;\\\\s+$&quot;, &quot;&quot;);\nSystem.out.println(&quot;***&quot; + input + &quot;***&quot;);   // *** XXXX ***\nSystem.out.println(&quot;***&quot; + output + &quot;***&quot;);  // *** XXXX***\n</code></pre>\n<p>If you really want to replace just <em>one</em> whitespace character at the end, then replace on <code>\\s$</code> instead of <code>\\s+$</code>.</p>\n"},{"tags":[],"owner":{"account_id":10192070,"reputation":2256,"user_id":7525132,"display_name":"Izruo"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1641400733,"creation_date":1641376677,"answer_id":70590917,"question_id":70590760,"body_markdown":"# `String#stripTrailing()`\r\n\r\nSince Java 11, `String` has a built-in method to to this: [`String#stripTrailing()`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html#stripTrailing())\r\n\r\nIt can be used like\r\n\r\n    String input = &quot; XXX &quot;;\r\n    String output = input.stripTrailing();\r\n\r\nNote that, other than `String.trim()`, this method removes any [whitespace][1] at the end of the string, not just spaces.\r\n\r\n\r\n  [1]: https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Character.html#isWhitespace(int)","title":"How to remove a white space at the end of a string in java?","body":"<h1><code>String#stripTrailing()</code></h1>\n<p>Since Java 11, <code>String</code> has a built-in method to to this: <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html#stripTrailing()\" rel=\"nofollow noreferrer\"><code>String#stripTrailing()</code></a></p>\n<p>It can be used like</p>\n<pre><code>String input = &quot; XXX &quot;;\nString output = input.stripTrailing();\n</code></pre>\n<p>Note that, other than <code>String.trim()</code>, this method removes any <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Character.html#isWhitespace(int)\" rel=\"nofollow noreferrer\">whitespace</a> at the end of the string, not just spaces.</p>\n"},{"tags":[],"owner":{"account_id":9685031,"reputation":1,"user_id":7185190,"display_name":""},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641377341,"creation_date":1641377341,"answer_id":70591062,"question_id":70590760,"body_markdown":"try this solution:\r\n\r\n    public String trim(String str) { \r\n     int len = str.length(); \r\n     int st = 0; \r\n\r\n     char[] val = str.toCharArray(); \r\n\r\n     while ((st &lt; len) &amp;&amp; (val[len - 1] &lt;= &#39; &#39;)) { \r\n      len--; \r\n     } \r\n     return str.substring(st, len); \r\n    }","title":"How to remove a white space at the end of a string in java?","body":"<p>try this solution:</p>\n<pre><code>public String trim(String str) { \n int len = str.length(); \n int st = 0; \n\n char[] val = str.toCharArray(); \n\n while ((st &lt; len) &amp;&amp; (val[len - 1] &lt;= ' ')) { \n  len--; \n } \n return str.substring(st, len); \n}\n</code></pre>\n"}],"owner":{"account_id":18565410,"reputation":1,"user_id":13528479,"display_name":"ItsWhoYouThinkItIs"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4681,"favorite_count":0,"down_vote_count":3,"up_vote_count":0,"accepted_answer_id":70590820,"answer_count":3,"score":-3,"last_activity_date":1641400733,"creation_date":1641375983,"question_id":70590760,"body_markdown":"I am trying to remove exactly one white space at the end of a string.\r\neg.\r\nI want &quot;   XXXX &quot; to be &quot;   XXXX&quot;.\r\nThe trim() method in java removes all leading and trailing whitespaces.\r\n\r\nAny help will be appreciated :)","title":"How to remove a white space at the end of a string in java?","body":"<p>I am trying to remove exactly one white space at the end of a string.\neg.\nI want &quot;   XXXX &quot; to be &quot;   XXXX&quot;.\nThe trim() method in java removes all leading and trailing whitespaces.</p>\n<p>Any help will be appreciated :)</p>\n"},{"tags":["java","string","android-studio","android-edittext","android-alertdialog"],"comments":[{"owner":{"account_id":3397419,"reputation":38710,"user_id":2850651,"display_name":"Mike M."},"score":0,"creation_date":1641417675,"post_id":70596433,"comment_id":124802827,"body_markdown":"`Log.d(TAG,&quot;commento1&quot;+commento);`  That is implicitly calling `toString()` directly on the `EditText`, which is why you get that weird result. You forgot to call `getText()` on `commento` first. `builder.setView(inflater.inflate(R.layout.new_post, null));`  That `inflate()` call is creating a new instance of that layout that is completely separate from the instance created and assigned to `dialogView`, which is never shown on-screen anywhere. I&#39;m not sure what the comment immediately above is trying to say, but you can change that line to `builder.setView(dialogView);` instead.","body":"<code>Log.d(TAG,&quot;commento1&quot;+commento);</code>  That is implicitly calling <code>toString()</code> directly on the <code>EditText</code>, which is why you get that weird result. You forgot to call <code>getText()</code> on <code>commento</code> first. <code>builder.setView(inflater.inflate(R.layout.new_post, null));</code>  That <code>inflate()</code> call is creating a new instance of that layout that is completely separate from the instance created and assigned to <code>dialogView</code>, which is never shown on-screen anywhere. I&#39;m not sure what the comment immediately above is trying to say, but you can change that line to <code>builder.setView(dialogView);</code> instead."},{"owner":{"account_id":3397419,"reputation":38710,"user_id":2850651,"display_name":"Mike M."},"score":0,"creation_date":1641417679,"post_id":70596433,"comment_id":124802830,"body_markdown":"Also, make sure to call `findViewById()` on `dialogView` for `stato` and `ritardo`, too, like you&#39;re doing for `commento`.","body":"Also, make sure to call <code>findViewById()</code> on <code>dialogView</code> for <code>stato</code> and <code>ritardo</code>, too, like you&#39;re doing for <code>commento</code>."}],"owner":{"account_id":22679571,"reputation":21,"user_id":16850093,"display_name":"Sara"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":374,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1641400679,"creation_date":1641400679,"question_id":70596433,"body_markdown":"I need to create an AlertDialog where the user can complete 3 fields and then store them in String variables (and I would also like to print them to log). The problem is that once you enter a value and click on &quot;Add&quot; to log Comment1 **androidx.appcompat.widget.AppCompatEditText {c6c367 VFED..CL is printed. ......THE. 0,0-0,0 # 7f080078 app: id / comment}** and instead comment2 remains empty.\r\n\r\nActivity\r\n\r\n       @Override\r\n        protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_post); //set layout\r\n        CommunicationController cc = new CommunicationController(this);\r\n        SID = getIntent().getStringExtra(&quot;SESSION_ID&quot;);\r\n        did = getIntent().getStringExtra(&quot;did&quot;);\r\n\r\n        //Aggiunta POST\r\n        FloatingActionButton addPost = findViewById(R.id.addPost);\r\n        addPost.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                Log.d(&quot;FAB&quot;,&quot;clickato&quot;);\r\n                AlertDialog.Builder builder = new AlertDialog.Builder(PostActivity.this);\r\n                LayoutInflater inflater = PostActivity.this.getLayoutInflater();\r\n                View dialogView = inflater.inflate(R.layout. new_post, null);\r\n                builder.setTitle(&quot;Nuovo Post&quot;);\r\n                builder.setMessage(&quot;Crea il tuo Post:&quot;);\r\n                builder.setView(R.layout.new_post);\r\n\r\n                //In case it gives you an error for setView(View) try\r\n                builder.setView(inflater.inflate(R.layout.new_post, null));\r\n                builder.setPositiveButton(&quot;Aggiungi&quot;, new DialogInterface.OnClickListener() {\r\n                    @Override\r\n                    public void onClick(DialogInterface dialog, int which) {\r\n                        EditText commento= (EditText)dialogView.findViewById(R.id.comment);\r\n                        Log.d(TAG,&quot;commento1&quot;+commento);\r\n                        EditText  stato= (EditText)findViewById(R.id.status);\r\n                        EditText  ritardo= (EditText)findViewById(R.id.delay);\r\n\r\n                        String comment = commento.getText().toString();\r\n                        String status = stato.getText().toString();\r\n                        String delay = ritardo.getText().toString();\r\n                        Log.d(TAG,&quot;commento2&quot;+comment);\r\n                        dialog.cancel();\r\n                    }\r\n                });\r\n                builder.show();\r\n            }\r\n        });\r\n    }\r\n\r\n\r\nAlertDialog.xml\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n    &lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    android:orientation=&quot;vertical&quot; android:layout_width=&quot;match_parent&quot;\r\n    android:layout_height=&quot;match_parent&quot;&gt;\r\n\r\n    &lt;EditText\r\n        android:layout_width=&quot;match_parent&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:hint=&quot;Commento..&quot;\r\n        android:inputType=&quot;text&quot;\r\n        android:id=&quot;@+id/comment&quot; /&gt;\r\n\r\n    &lt;EditText\r\n        android:layout_width=&quot;match_parent&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:hint=&quot;Status..&quot;\r\n        android:id=&quot;@+id/status&quot; /&gt;\r\n\r\n    &lt;EditText\r\n        android:layout_width=&quot;match_parent&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:hint=&quot;Delay..&quot;\r\n        android:id=&quot;@+id/delay&quot;\r\n        android:layout_gravity=&quot;center_horizontal&quot; /&gt;\r\n    &lt;/LinearLayout&gt;\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/c7WA2.png","title":"how can I print a text inserted in an editText","body":"<p>I need to create an AlertDialog where the user can complete 3 fields and then store them in String variables (and I would also like to print them to log). The problem is that once you enter a value and click on &quot;Add&quot; to log Comment1 <strong>androidx.appcompat.widget.AppCompatEditText {c6c367 VFED..CL is printed. ......THE. 0,0-0,0 # 7f080078 app: id / comment}</strong> and instead comment2 remains empty.</p>\n<p>Activity</p>\n<pre><code>   @Override\n    protected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_post); //set layout\n    CommunicationController cc = new CommunicationController(this);\n    SID = getIntent().getStringExtra(&quot;SESSION_ID&quot;);\n    did = getIntent().getStringExtra(&quot;did&quot;);\n\n    //Aggiunta POST\n    FloatingActionButton addPost = findViewById(R.id.addPost);\n    addPost.setOnClickListener(new View.OnClickListener() {\n        @Override\n        public void onClick(View view) {\n            Log.d(&quot;FAB&quot;,&quot;clickato&quot;);\n            AlertDialog.Builder builder = new AlertDialog.Builder(PostActivity.this);\n            LayoutInflater inflater = PostActivity.this.getLayoutInflater();\n            View dialogView = inflater.inflate(R.layout. new_post, null);\n            builder.setTitle(&quot;Nuovo Post&quot;);\n            builder.setMessage(&quot;Crea il tuo Post:&quot;);\n            builder.setView(R.layout.new_post);\n\n            //In case it gives you an error for setView(View) try\n            builder.setView(inflater.inflate(R.layout.new_post, null));\n            builder.setPositiveButton(&quot;Aggiungi&quot;, new DialogInterface.OnClickListener() {\n                @Override\n                public void onClick(DialogInterface dialog, int which) {\n                    EditText commento= (EditText)dialogView.findViewById(R.id.comment);\n                    Log.d(TAG,&quot;commento1&quot;+commento);\n                    EditText  stato= (EditText)findViewById(R.id.status);\n                    EditText  ritardo= (EditText)findViewById(R.id.delay);\n\n                    String comment = commento.getText().toString();\n                    String status = stato.getText().toString();\n                    String delay = ritardo.getText().toString();\n                    Log.d(TAG,&quot;commento2&quot;+comment);\n                    dialog.cancel();\n                }\n            });\n            builder.show();\n        }\n    });\n}\n</code></pre>\n<p>AlertDialog.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\nandroid:orientation=&quot;vertical&quot; android:layout_width=&quot;match_parent&quot;\nandroid:layout_height=&quot;match_parent&quot;&gt;\n\n&lt;EditText\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;wrap_content&quot;\n    android:hint=&quot;Commento..&quot;\n    android:inputType=&quot;text&quot;\n    android:id=&quot;@+id/comment&quot; /&gt;\n\n&lt;EditText\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;wrap_content&quot;\n    android:hint=&quot;Status..&quot;\n    android:id=&quot;@+id/status&quot; /&gt;\n\n&lt;EditText\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;wrap_content&quot;\n    android:hint=&quot;Delay..&quot;\n    android:id=&quot;@+id/delay&quot;\n    android:layout_gravity=&quot;center_horizontal&quot; /&gt;\n&lt;/LinearLayout&gt;\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/c7WA2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c7WA2.png\" alt=\"enter image description here\" /></a></p>\n"},{"tags":["java","javafx","coderunner"],"comments":[{"owner":{"account_id":1180113,"reputation":152325,"user_id":1155209,"display_name":"jewelsea"},"score":0,"creation_date":1636573737,"post_id":69918313,"comment_id":123596409,"body_markdown":"I don&#39;t know anything about CodeRunner or how it works.  But you could create a [custom java runtime using jlink](https://www.baeldung.com/jlink) which does not include awt/swing modules, but does include JavaFX modules, and use that.   Then, think it is unlikely that CodeRunner would find awt/swing classes to populate imports instead of JavaFX classes.","body":"I don&#39;t know anything about CodeRunner or how it works.  But you could create a <a href=\"https://www.baeldung.com/jlink\" rel=\"nofollow noreferrer\">custom java runtime using jlink</a> which does not include awt/swing modules, but does include JavaFX modules, and use that.   Then, think it is unlikely that CodeRunner would find awt/swing classes to populate imports instead of JavaFX classes."},{"owner":{"account_id":8532578,"reputation":39898,"user_id":6395627,"display_name":"Slaw"},"score":0,"creation_date":1636582519,"post_id":69918313,"comment_id":123599298,"body_markdown":"@jewelsea I&#39;m not sure that&#39;s possible, as I believe even `javafx.base` has a dependency on `java.desktop` (unfortunately).","body":"@jewelsea I&#39;m not sure that&#39;s possible, as I believe even <code>javafx.base</code> has a dependency on <code>java.desktop</code> (unfortunately)."},{"owner":{"account_id":1180113,"reputation":152325,"user_id":1155209,"display_name":"jewelsea"},"score":0,"creation_date":1636584406,"post_id":69918313,"comment_id":123599834,"body_markdown":"@Slaw yes you are correct.  I didn&#39;t realize that.  That&#39;s a shame.  It means that the base JavaFX code has a required dependency on all of the legacy AWT/Swing code.  So you can&#39;t build a JavaFX app without including AWT/Swing.  The [javafx.base](https://openjfx.io/javadoc/17/javafx.base/module-summary.html) module [requires](https://github.com/openjdk/jfx/blob/6749ab60b7673a0838d55fbd09cabf4232d5da60/modules/javafx.base/src/main/java/module-info.java#L34) the [java.desktop](https://docs.oracle.com/en/java/javase/17/docs/api/java.desktop/module-summary.html).","body":"@Slaw yes you are correct.  I didn&#39;t realize that.  That&#39;s a shame.  It means that the base JavaFX code has a required dependency on all of the legacy AWT/Swing code.  So you can&#39;t build a JavaFX app without including AWT/Swing.  The <a href=\"https://openjfx.io/javadoc/17/javafx.base/module-summary.html\" rel=\"nofollow noreferrer\">javafx.base</a> module <a href=\"https://github.com/openjdk/jfx/blob/6749ab60b7673a0838d55fbd09cabf4232d5da60/modules/javafx.base/src/main/java/module-info.java#L34\" rel=\"nofollow noreferrer\">requires</a> the <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.desktop/module-summary.html\" rel=\"nofollow noreferrer\">java.desktop</a>."},{"owner":{"account_id":1180113,"reputation":152325,"user_id":1155209,"display_name":"jewelsea"},"score":0,"creation_date":1636584547,"post_id":69918313,"comment_id":123599867,"body_markdown":"It also means my proposed solution won&#39;t work, as it is impossible to use jlink to build a custom runtime for java + JavaFX which does not also include awt + swing (at least as far as I can tell).","body":"It also means my proposed solution won&#39;t work, as it is impossible to use jlink to build a custom runtime for java + JavaFX which does not also include awt + swing (at least as far as I can tell)."},{"owner":{"account_id":1180113,"reputation":152325,"user_id":1155209,"display_name":"jewelsea"},"score":0,"creation_date":1636584755,"post_id":69918313,"comment_id":123599917,"body_markdown":"Not that it helps you, but the feature you request is available in Intellij Idea: [Exclude classes and packages from auto import](https://www.jetbrains.com/help/idea/creating-and-optimizing-imports.html#exclude-from-auto-import)","body":"Not that it helps you, but the feature you request is available in Intellij Idea: <a href=\"https://www.jetbrains.com/help/idea/creating-and-optimizing-imports.html#exclude-from-auto-import\" rel=\"nofollow noreferrer\">Exclude classes and packages from auto import</a>"},{"owner":{"account_id":8532578,"reputation":39898,"user_id":6395627,"display_name":"Slaw"},"score":0,"creation_date":1636585225,"post_id":69918313,"comment_id":123600019,"body_markdown":"@jewelsea Yup, and it really is unfortunate. As far as I can tell, the only bit in `javafx.base` that is dependent on code in `java.desktop` is the `javafx.beans.property.adapter` classes. Ideally, the only module that should have been dependent on `java.desktop` is the `javafx.swing` module. Honestly, they should have put the `javafx.beans.property.adapter` classes either in `javafx.swing` or in their own module. And I realize they probably wanted to avoid having too many modules, but there should have been separate `java.beans`, `java.awt`, and `java.swing` modules, at least in my opinion.","body":"@jewelsea Yup, and it really is unfortunate. As far as I can tell, the only bit in <code>javafx.base</code> that is dependent on code in <code>java.desktop</code> is the <code>javafx.beans.property.adapter</code> classes. Ideally, the only module that should have been dependent on <code>java.desktop</code> is the <code>javafx.swing</code> module. Honestly, they should have put the <code>javafx.beans.property.adapter</code> classes either in <code>javafx.swing</code> or in their own module. And I realize they probably wanted to avoid having too many modules, but there should have been separate <code>java.beans</code>, <code>java.awt</code>, and <code>java.swing</code> modules, at least in my opinion."},{"owner":{"account_id":23278394,"reputation":23,"user_id":17362179,"display_name":"Dallen Corry"},"score":0,"creation_date":1636585791,"post_id":69918313,"comment_id":123600148,"body_markdown":"@jewelsea that actually is very useful, as I was considering switching my main IDE anyway. But thank you both for the insights!","body":"@jewelsea that actually is very useful, as I was considering switching my main IDE anyway. But thank you both for the insights!"},{"owner":{"account_id":1180113,"reputation":152325,"user_id":1155209,"display_name":"jewelsea"},"score":0,"creation_date":1636589706,"post_id":69918313,"comment_id":123600986,"body_markdown":"@Slaw there are some cases and [dev discussion](https://www.mail-archive.com/openjfx-dev@openjdk.java.net/msg22337.html) to update the module dependencies for javafx-base and further [split it up](https://bugs.openjdk.java.net/browse/JDK-8239853), as you suggest, so the [base JavaFX system doesn&#39;t have a hard dependency on AWT/Swing](https://bugs.openjdk.java.net/browse/JDK-8240844).  Also for javafx-graphics which is the core JavaFX framework code and depends on AWT/Swing internally for printing support.  Hopefully, the hard dependencies will be removed in future releases.","body":"@Slaw there are some cases and <a href=\"https://www.mail-archive.com/openjfx-dev@openjdk.java.net/msg22337.html\" rel=\"nofollow noreferrer\">dev discussion</a> to update the module dependencies for javafx-base and further <a href=\"https://bugs.openjdk.java.net/browse/JDK-8239853\" rel=\"nofollow noreferrer\">split it up</a>, as you suggest, so the <a href=\"https://bugs.openjdk.java.net/browse/JDK-8240844\" rel=\"nofollow noreferrer\">base JavaFX system doesn&#39;t have a hard dependency on AWT/Swing</a>.  Also for javafx-graphics which is the core JavaFX framework code and depends on AWT/Swing internally for printing support.  Hopefully, the hard dependencies will be removed in future releases."}],"owner":{"account_id":23278394,"reputation":23,"user_id":17362179,"display_name":"Dallen Corry"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":100,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1641400647,"creation_date":1636568349,"question_id":69918313,"body_markdown":"I am currently writing a JavaFX program in Code Runner on my Mac. When I type in new elements, such as buttons or panes, code runner automatically puts in an import for awt like this\r\n\r\n    import java.awt.*;\r\n\r\nIt does this even if I have already imported the correct statement from javafx, for example \r\n\r\n    import javafx.scene.control.Button;\r\n\r\nWhen I type in `Button bt = new Button(&quot;hello&quot;);` Code Runner automatically puts in the `import java.awt.*;`\r\n\r\nIs there a way to turn this off? I have looked in all of the settings for Code Runner and my preferences for java, but I can&#39;t see anything.","title":"How can I disable Code Runner adding JavaFX imports?","body":"<p>I am currently writing a JavaFX program in Code Runner on my Mac. When I type in new elements, such as buttons or panes, code runner automatically puts in an import for awt like this</p>\n<pre><code>import java.awt.*;\n</code></pre>\n<p>It does this even if I have already imported the correct statement from javafx, for example</p>\n<pre><code>import javafx.scene.control.Button;\n</code></pre>\n<p>When I type in <code>Button bt = new Button(&quot;hello&quot;);</code> Code Runner automatically puts in the <code>import java.awt.*;</code></p>\n<p>Is there a way to turn this off? I have looked in all of the settings for Code Runner and my preferences for java, but I can't see anything.</p>\n"},{"tags":["java","ssh","proxy","routes","sftp"],"comments":[{"owner":{"account_id":453710,"reputation":192093,"user_id":850848,"accept_rate":80,"display_name":"Martin Prikryl"},"score":0,"creation_date":1641409180,"post_id":70596418,"comment_id":124800025,"body_markdown":"This is not really a programming question. This might help you (combined with `Match user` directive): [Seamless SFTP tunneling / jump box](https://unix.stackexchange.com/q/510258/119732).","body":"This is not really a programming question. This might help you (combined with <code>Match user</code> directive): <a href=\"https://unix.stackexchange.com/q/510258/119732\">Seamless SFTP tunneling / jump box</a>."},{"owner":{"account_id":1297601,"reputation":1110,"user_id":1248254,"accept_rate":64,"display_name":"PetrS"},"score":0,"creation_date":1641461812,"post_id":70596418,"comment_id":124811910,"body_markdown":"You are right, it&#39;s not a programming question. Maybe I was &quot;blind&quot; because we developed the exact same solution for FTP, so our first direction was to try the same for sFTP. I did not know about the possibility you mentioned. Thanks for that, I&#39;ll check that!","body":"You are right, it&#39;s not a programming question. Maybe I was &quot;blind&quot; because we developed the exact same solution for FTP, so our first direction was to try the same for sFTP. I did not know about the possibility you mentioned. Thanks for that, I&#39;ll check that!"}],"owner":{"account_id":1297601,"reputation":1110,"user_id":1248254,"accept_rate":64,"display_name":"PetrS"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":751,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1641400632,"creation_date":1641400632,"question_id":70596418,"body_markdown":"We have two SFTP servers, let&#39;s say *Server A* and *Server B*. At this moment our users use only *Server A* to upload/download the data. Our goal is to slowly start moving the users to *Server B*, but the requirement is that users should not be aware of this. So what we need is some kind of &quot;proxy&quot; or &quot;router&quot;, let me describe how it should work.\r\n\r\nWe need to develop the application, that will be sitting in front of these two servers and users will access only this application via SFTP, not *Server A* or *Server B* directly. \r\nFrom clients/users point of view this application has to behave as a normal SFTP server, but under the hood is has to do the following:\r\n\r\n 1. Read the username and password provided by user\r\n 2. Based on the credentials we will know whether we should connect with Server A or Server B\r\n 3. Establish SFTP connection with the correct server and route all the communication to the correct server\r\n\r\nThis way we can slightly migrate users from *Server A* to *Server B* and users will not be aware of that, they do not have to change their connection details. \r\n\r\nWe had to do exactly the same exercise with FTP servers, which was pretty easy because it is easy to read FTP communication. We have implemented that in Java, simply with two instances of `Socket`, one between the client and our application, the second between our application and FTP server. *(It wasn&#39;t so easy, we had to also do a proxy for the data channel, but there was no issue with that.)*\r\n\r\nDo you have any idea how we can achieve the same with SFTP? I am not asking for a specific code example, it&#39;s a more generic question, what should be the best approach. \r\n\r\n","title":"SFTP proxy with routing to correct SFTP server","body":"<p>We have two SFTP servers, let's say <em>Server A</em> and <em>Server B</em>. At this moment our users use only <em>Server A</em> to upload/download the data. Our goal is to slowly start moving the users to <em>Server B</em>, but the requirement is that users should not be aware of this. So what we need is some kind of &quot;proxy&quot; or &quot;router&quot;, let me describe how it should work.</p>\n<p>We need to develop the application, that will be sitting in front of these two servers and users will access only this application via SFTP, not <em>Server A</em> or <em>Server B</em> directly.\nFrom clients/users point of view this application has to behave as a normal SFTP server, but under the hood is has to do the following:</p>\n<ol>\n<li>Read the username and password provided by user</li>\n<li>Based on the credentials we will know whether we should connect with Server A or Server B</li>\n<li>Establish SFTP connection with the correct server and route all the communication to the correct server</li>\n</ol>\n<p>This way we can slightly migrate users from <em>Server A</em> to <em>Server B</em> and users will not be aware of that, they do not have to change their connection details.</p>\n<p>We had to do exactly the same exercise with FTP servers, which was pretty easy because it is easy to read FTP communication. We have implemented that in Java, simply with two instances of <code>Socket</code>, one between the client and our application, the second between our application and FTP server. <em>(It wasn't so easy, we had to also do a proxy for the data channel, but there was no issue with that.)</em></p>\n<p>Do you have any idea how we can achieve the same with SFTP? I am not asking for a specific code example, it's a more generic question, what should be the best approach.</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":2799929,"reputation":8527,"user_id":2408342,"accept_rate":90,"display_name":"Roshana Pitigala"},"score":3,"creation_date":1641383397,"post_id":70592264,"comment_id":124789246,"body_markdown":"Does this answer your question? [Check if application is installed - Android](https://stackoverflow.com/questions/18752202/check-if-application-is-installed-android)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/18752202/check-if-application-is-installed-android\">Check if application is installed - Android</a>"},{"owner":{"account_id":10186817,"reputation":73,"user_id":7521432,"display_name":"amol junghare"},"score":0,"creation_date":1641387628,"post_id":70592264,"comment_id":124790801,"body_markdown":"private boolean isPackageInstalled(String packageName, PackageManager packageManager) {\n        try {\n            packageManager.getPackageInfo(packageName, 0);\n            return true;\n        } catch (PackageManager.NameNotFoundException e) {\n            return false;\n        }\n    }\nIt checked whether it is present or not but it will not redirect to the playstore link.","body":"private boolean isPackageInstalled(String packageName, PackageManager packageManager) {         try {             packageManager.getPackageInfo(packageName, 0);             return true;         } catch (PackageManager.NameNotFoundException e) {             return false;         }     } It checked whether it is present or not but it will not redirect to the playstore link."},{"owner":{"account_id":2799929,"reputation":8527,"user_id":2408342,"accept_rate":90,"display_name":"Roshana Pitigala"},"score":0,"creation_date":1641391045,"post_id":70592264,"comment_id":124792278,"body_markdown":"Search search search...\n[How to open the Google Play Store directly from my Android application?](https://stackoverflow.com/a/11753070/2408342)","body":"Search search search... <a href=\"https://stackoverflow.com/a/11753070/2408342\">How to open the Google Play Store directly from my Android application?</a>"}],"answers":[{"tags":[],"owner":{"account_id":23247379,"reputation":337,"user_id":17335765,"display_name":"Marina"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641400260,"creation_date":1641400260,"answer_id":70596334,"question_id":70592264,"body_markdown":"Checking if app is installed having package name:\r\n\r\n    public static final String PACKAGE_NAME = &quot;com.__.__&quot;;\r\n    \r\n        public static boolean isAppInstalled(Context context) {\r\n            PackageManager packageManager = context.getPackageManager();\r\n            Intent intent = new Intent(Intent.ACTION_VIEW);\r\n            if (intent.resolveActivity(packageManager) != null) {\r\n                try {\r\n                    packageManager.getPackageInfo(PACKAGE_NAME, PackageManager.GET_ACTIVITIES);\r\n                    return true;\r\n                } catch (PackageManager.NameNotFoundException ignore) {\r\n    \r\n                }\r\n            }\r\n            return false;\r\n        }\r\n\r\nOpen Play Market having package name:\r\n\r\n    try {\r\n        startActivity(new Intent(Intent.ACTION_VIEW, \r\n             Uri.parse(&quot;market://details?id=&quot; + appPackageName)));\r\n    } catch (android.content.ActivityNotFoundException anfe) {\r\n        startActivity(new Intent(Intent.ACTION_VIEW, \r\n            Uri.parse(&quot;https://play.google.com/store/apps/details?id=&quot; + appPackageName)));\r\n    }","title":"In Android how to check app is installed in your phone or not","body":"<p>Checking if app is installed having package name:</p>\n<pre><code>public static final String PACKAGE_NAME = &quot;com.__.__&quot;;\n\n    public static boolean isAppInstalled(Context context) {\n        PackageManager packageManager = context.getPackageManager();\n        Intent intent = new Intent(Intent.ACTION_VIEW);\n        if (intent.resolveActivity(packageManager) != null) {\n            try {\n                packageManager.getPackageInfo(PACKAGE_NAME, PackageManager.GET_ACTIVITIES);\n                return true;\n            } catch (PackageManager.NameNotFoundException ignore) {\n\n            }\n        }\n        return false;\n    }\n</code></pre>\n<p>Open Play Market having package name:</p>\n<pre><code>try {\n    startActivity(new Intent(Intent.ACTION_VIEW, \n         Uri.parse(&quot;market://details?id=&quot; + appPackageName)));\n} catch (android.content.ActivityNotFoundException anfe) {\n    startActivity(new Intent(Intent.ACTION_VIEW, \n        Uri.parse(&quot;https://play.google.com/store/apps/details?id=&quot; + appPackageName)));\n}\n</code></pre>\n"}],"owner":{"account_id":10186817,"reputation":73,"user_id":7521432,"display_name":"amol junghare"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":243,"favorite_count":0,"down_vote_count":4,"up_vote_count":0,"answer_count":1,"score":-4,"last_activity_date":1641400260,"creation_date":1641382910,"question_id":70592264,"body_markdown":"How to check if app is installed or not on phone. If the app is installed, open the app, otherwise open the appstore link to download the app.\r\nIf the app is already there, I used the following code.\r\n \r\n\r\n    Intent LaunchIntent = getPackageManager().getLaunchIntentForPackage(&quot;package name&quot;);\r\n    startActivity(LaunchIntent);","title":"In Android how to check app is installed in your phone or not","body":"<p>How to check if app is installed or not on phone. If the app is installed, open the app, otherwise open the appstore link to download the app.\nIf the app is already there, I used the following code.</p>\n<pre><code>Intent LaunchIntent = getPackageManager().getLaunchIntentForPackage(&quot;package name&quot;);\nstartActivity(LaunchIntent);\n</code></pre>\n"},{"tags":["java","ssl","jenkins","https","docker-compose"],"answers":[{"tags":[],"owner":{"account_id":9722890,"reputation":824,"user_id":7211014,"display_name":"Dave"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1641400127,"creation_date":1641400127,"answer_id":70596296,"question_id":70594103,"body_markdown":"I found [this docker hub image][1] jenkins-ssl\r\nLooking at [the github][1] I found how they configured their certs and added the &quot;JENKINS_OPTS&quot; statement to actually change the parameters I needed.\r\nI edited the following lines in the Dockerfile to use my custom certs to get this to finally work!\r\n\r\n\r\n```bash\r\n#Commenting this out\r\n#ENV JENKINS_OPTS --httpPort=-1 --httpsPort=8443 --httpsCertificate=&quot;$CERT_FOLDER/jenkins.pem&quot; --httpsPrivateKey=&quot;$CERT_FOLDER/jenkins.key&quot;\r\n\r\n#Copy over custom certs change permissions to jenkins:jenkins\r\nCOPY [&quot;./certs/&quot;, &quot;/var/jenkins_certs&quot;]\r\nRUN chown -R jenkins:jenkins &quot;/var/jenkins_certs&quot;\r\n\r\n#Update root ca with custom trust chain (For web only)\r\nRUN cp /var/jenkins_certs/attrootchain.cer /usr/local/share/ca-certificates &amp;&amp; update-ca-certificates\r\n\r\n#Update root ca with custom trust chain (for java env)\r\nRUN keytool -keystore /opt/java/openjdk/lib/security/cacerts -storepass changeit -noprompt -trustcacerts -importcert -alias ourrootchain -file /var/jenkins_certs/ourrootchain.cer\r\n\r\n#run Jenkins options using the custom cert and key\r\nENV JENKINS_OPTS --httpPort=-1 --httpsPort=8443 --httpsCertificate=&quot;/var/jenkins_certs/jenkins.crt&quot; --httpsPrivateKey=&quot;/var/jenkins_certs/jenkins.key&quot;\r\n```\r\n\r\nThen ran `docker build -t jenkins-ssl ./`\r\n\r\nNow I can use this image in my docker-compose file. Or run as a simple docker run statement like this:\r\n\r\n`docker run --name jenkins-ssl -p 443:8443 -p 50000:50000 jenkins-ssl`\r\n\r\n\r\n  [1]: https://github.com/t4skforce/jenkins-ssl","title":"How do I deploy HTTPS enabled Jenkins container using docker-compose WITHOUT a reverse proxy container?","body":"<p>I found <a href=\"https://github.com/t4skforce/jenkins-ssl\" rel=\"nofollow noreferrer\">this docker hub image</a> jenkins-ssl\nLooking at <a href=\"https://github.com/t4skforce/jenkins-ssl\" rel=\"nofollow noreferrer\">the github</a> I found how they configured their certs and added the &quot;JENKINS_OPTS&quot; statement to actually change the parameters I needed.\nI edited the following lines in the Dockerfile to use my custom certs to get this to finally work!</p>\n<pre class=\"lang-sh prettyprint-override\"><code>#Commenting this out\n#ENV JENKINS_OPTS --httpPort=-1 --httpsPort=8443 --httpsCertificate=&quot;$CERT_FOLDER/jenkins.pem&quot; --httpsPrivateKey=&quot;$CERT_FOLDER/jenkins.key&quot;\n\n#Copy over custom certs change permissions to jenkins:jenkins\nCOPY [&quot;./certs/&quot;, &quot;/var/jenkins_certs&quot;]\nRUN chown -R jenkins:jenkins &quot;/var/jenkins_certs&quot;\n\n#Update root ca with custom trust chain (For web only)\nRUN cp /var/jenkins_certs/attrootchain.cer /usr/local/share/ca-certificates &amp;&amp; update-ca-certificates\n\n#Update root ca with custom trust chain (for java env)\nRUN keytool -keystore /opt/java/openjdk/lib/security/cacerts -storepass changeit -noprompt -trustcacerts -importcert -alias ourrootchain -file /var/jenkins_certs/ourrootchain.cer\n\n#run Jenkins options using the custom cert and key\nENV JENKINS_OPTS --httpPort=-1 --httpsPort=8443 --httpsCertificate=&quot;/var/jenkins_certs/jenkins.crt&quot; --httpsPrivateKey=&quot;/var/jenkins_certs/jenkins.key&quot;\n</code></pre>\n<p>Then ran <code>docker build -t jenkins-ssl ./</code></p>\n<p>Now I can use this image in my docker-compose file. Or run as a simple docker run statement like this:</p>\n<p><code>docker run --name jenkins-ssl -p 443:8443 -p 50000:50000 jenkins-ssl</code></p>\n"}],"owner":{"account_id":9722890,"reputation":824,"user_id":7211014,"display_name":"Dave"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2822,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":70596296,"answer_count":1,"score":3,"last_activity_date":1641400127,"creation_date":1641390972,"question_id":70594103,"body_markdown":"I need to deploy a Jenkins container with https enabled using docker-compose without using a reverse-proxy like Nginx, how can I accomplish this?\r\n\r\nI have read [this post][1], [this blog post][2], and [this blog post][3] all of witch require me to deploy the .war file with java parameters like `--httpPort` and `--httpsPort`. \r\n\r\nWhere do I put these options in my docker-compose file? I also have a Dockerfile where I run some commands post install, is it possible to put these options there? \r\n\r\nHere is my current docker-compose file, which works. Note I am not trying to adjust the http or https ports in this file:\r\n\r\n```\r\nversion: &#39;3.7&#39;\r\nservices:\r\n  jenkins:\r\n    #image: jenkins/jenkins:lts\r\n    build:\r\n        context: ./\r\n        dockerfile: jenkins.Dockerfile\r\n    privileged: true\r\n    user: root\r\n    expose:\r\n      - 8080\r\n    ports:\r\n      - 50000:50000\r\n    container_name: jenkins\r\n    volumes:\r\n      - ./jenkins_data:/var/jenkins_home\r\n      - /var/run/docker.sock:/var/run/docker.sock\r\n    environment:\r\n      DOCKER_SOCKET: /var/run/docker.sock\r\n    privileged: true\r\n    networks:\r\n      - jenkins_nw\r\n    restart: unless-stopped\r\n\r\nnetworks:\r\n  jenkins_nw:\r\n    driver: bridge\r\n```\r\n\r\nHere is my jenkins.Dockerfile:\r\n\r\n```\r\nFROM jenkins/jenkins:lts\r\n\r\nENV http_proxy http://our.proxy.com:2222\r\nENV https_proxy http://our.proxy.com:2222\r\n\r\nUSER root\r\n\r\n\r\nCOPY [&quot;./certs/ourrootchain.cer&quot;, &quot;/var/jenkins_home&quot;]\r\nRUN \\\r\n    cd /tmp \\\r\n    &amp;&amp; keytool -keystore /opt/java/openjdk/lib/security/cacerts -storepass changeit -noprompt -trustcacerts -importcert -alias ourrootchain -file /var/jenkins_home/ourrootchain.cer\r\n\r\n\r\nRUN apt-get update &amp;&amp; apt-get install tcpdump procps net-tools -y\r\n```\r\n\r\n**Troubleshooting**\r\n\r\n - I installed procps and checked the java command being run to start jenkins in the conatiner. The output is the following. I still yet to figure out how to adjust the parameters this command runs, is there a way?\r\n   ```\r\n   java -Duser.home=/var/jenkins_home -Djenkins.model.Jenkins.slaveAgentPort=50000 -jar /usr/share/jenkins/jenkins.war\r\n   ```\r\n - I tried using `JAVA_OPTS: &quot;--httpsPort:8443&quot;` as well as `https_port: 8443` in my `environment:` section in docker-compose file. using `JAVA_OPTS: --httpsPort:8443` gave errors, and the container existed as the command was not recognized. `https_port: 8443` did nothing and netstat inside of the container after deployment shows the server is not listening on on https nor did the java command change from a grep on `ps -aux`.\r\n\r\nI believe I need to import my pkcs12 file into the keystore. All the guides I read online state I need to create a new keystore. Is it possible to import my pkcs12 into an existing keystore? \r\n\r\nIs there a place I can define the java command that is being run?\r\n\r\n**UPDATE:**\r\n\r\nI am no java expert so I did not know that &quot;-D&quot; was used for virtual machine options. I adjusted the &quot;JAVA_OPTS&quot; to look like the following now\r\n`JAVA_OPTS: &quot;-DhttpsPort=8443 -DhttpsCertificate=/var/jenkins_certs/jenkins.crt -DhttpsPrivateKey=/var/jenkins_certs/jenkins.key`. I also adjusted my Dockerfile to create the /var/jenkins_certs directory, and copy over the actual cert and private key. The container deploys successfully, and using a `ps -aux | grep java` I can see my options are actually being used. However `netstat -tulpn` still shows only &quot;8080&quot; is open. Why does the Jenkins container refuses to use HTTPS or open up the HTTPS port I configured? \r\n\r\n  [1]: https://stackoverflow.com/questions/40126736/enable-https-in-jenkins\r\n  [2]: http://balodeamit.blogspot.com/2014/03/jenkins-switch-to-ssl-https-mode.html\r\n  [3]: https://code.haleby.se/2016/01/22/enable-ssl-in-jenkins-in-docker/","title":"How do I deploy HTTPS enabled Jenkins container using docker-compose WITHOUT a reverse proxy container?","body":"<p>I need to deploy a Jenkins container with https enabled using docker-compose without using a reverse-proxy like Nginx, how can I accomplish this?</p>\n<p>I have read <a href=\"https://stackoverflow.com/questions/40126736/enable-https-in-jenkins\">this post</a>, <a href=\"http://balodeamit.blogspot.com/2014/03/jenkins-switch-to-ssl-https-mode.html\" rel=\"nofollow noreferrer\">this blog post</a>, and <a href=\"https://code.haleby.se/2016/01/22/enable-ssl-in-jenkins-in-docker/\" rel=\"nofollow noreferrer\">this blog post</a> all of witch require me to deploy the .war file with java parameters like <code>--httpPort</code> and <code>--httpsPort</code>.</p>\n<p>Where do I put these options in my docker-compose file? I also have a Dockerfile where I run some commands post install, is it possible to put these options there?</p>\n<p>Here is my current docker-compose file, which works. Note I am not trying to adjust the http or https ports in this file:</p>\n<pre><code>version: '3.7'\nservices:\n  jenkins:\n    #image: jenkins/jenkins:lts\n    build:\n        context: ./\n        dockerfile: jenkins.Dockerfile\n    privileged: true\n    user: root\n    expose:\n      - 8080\n    ports:\n      - 50000:50000\n    container_name: jenkins\n    volumes:\n      - ./jenkins_data:/var/jenkins_home\n      - /var/run/docker.sock:/var/run/docker.sock\n    environment:\n      DOCKER_SOCKET: /var/run/docker.sock\n    privileged: true\n    networks:\n      - jenkins_nw\n    restart: unless-stopped\n\nnetworks:\n  jenkins_nw:\n    driver: bridge\n</code></pre>\n<p>Here is my jenkins.Dockerfile:</p>\n<pre><code>FROM jenkins/jenkins:lts\n\nENV http_proxy http://our.proxy.com:2222\nENV https_proxy http://our.proxy.com:2222\n\nUSER root\n\n\nCOPY [&quot;./certs/ourrootchain.cer&quot;, &quot;/var/jenkins_home&quot;]\nRUN \\\n    cd /tmp \\\n    &amp;&amp; keytool -keystore /opt/java/openjdk/lib/security/cacerts -storepass changeit -noprompt -trustcacerts -importcert -alias ourrootchain -file /var/jenkins_home/ourrootchain.cer\n\n\nRUN apt-get update &amp;&amp; apt-get install tcpdump procps net-tools -y\n</code></pre>\n<p><strong>Troubleshooting</strong></p>\n<ul>\n<li>I installed procps and checked the java command being run to start jenkins in the conatiner. The output is the following. I still yet to figure out how to adjust the parameters this command runs, is there a way?\n<pre><code>java -Duser.home=/var/jenkins_home -Djenkins.model.Jenkins.slaveAgentPort=50000 -jar /usr/share/jenkins/jenkins.war\n</code></pre>\n</li>\n<li>I tried using <code>JAVA_OPTS: &quot;--httpsPort:8443&quot;</code> as well as <code>https_port: 8443</code> in my <code>environment:</code> section in docker-compose file. using <code>JAVA_OPTS: --httpsPort:8443</code> gave errors, and the container existed as the command was not recognized. <code>https_port: 8443</code> did nothing and netstat inside of the container after deployment shows the server is not listening on on https nor did the java command change from a grep on <code>ps -aux</code>.</li>\n</ul>\n<p>I believe I need to import my pkcs12 file into the keystore. All the guides I read online state I need to create a new keystore. Is it possible to import my pkcs12 into an existing keystore?</p>\n<p>Is there a place I can define the java command that is being run?</p>\n<p><strong>UPDATE:</strong></p>\n<p>I am no java expert so I did not know that &quot;-D&quot; was used for virtual machine options. I adjusted the &quot;JAVA_OPTS&quot; to look like the following now\n<code>JAVA_OPTS: &quot;-DhttpsPort=8443 -DhttpsCertificate=/var/jenkins_certs/jenkins.crt -DhttpsPrivateKey=/var/jenkins_certs/jenkins.key</code>. I also adjusted my Dockerfile to create the /var/jenkins_certs directory, and copy over the actual cert and private key. The container deploys successfully, and using a <code>ps -aux | grep java</code> I can see my options are actually being used. However <code>netstat -tulpn</code> still shows only &quot;8080&quot; is open. Why does the Jenkins container refuses to use HTTPS or open up the HTTPS port I configured?</p>\n"},{"tags":["java","multithreading"],"comments":[{"owner":{"account_id":1658807,"reputation":31819,"user_id":1527544,"accept_rate":54,"display_name":"Antoniossss"},"score":0,"creation_date":1641199416,"post_id":70563282,"comment_id":124736767,"body_markdown":"Try semaphore/reentrant lock","body":"Try semaphore/reentrant lock"}],"answers":[{"tags":[],"owner":{"account_id":2818342,"reputation":299856,"user_id":2422776,"display_name":"Mureinik"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641199632,"creation_date":1641199632,"answer_id":70563342,"question_id":70563282,"body_markdown":"This is a classic double-checking problem:\r\n\r\n```java\r\n// Note: the method isn&#39;t synchronized\r\npublic boolean readCache(int id) {\r\n  // First check - quick check outside the lock.\r\n  // If the cache isn&#39;t expired, no need to acquire a lock\r\n  if (cache.hasExpired()) {\r\n    // This thread may have to update the cache, so acquire the lock:\r\n    synchronized (someSharedLock) {\r\n      // Under the lock, double-check a different thread didn&#39;t update the cache\r\n      // while we were waiting for the lock\r\n      if (cache.hasExpired()) {\r\n        updateCache();\r\n      }\r\n    }\r\n  }\r\n\r\n  // The cache is now definitely not expired, use it\r\n  return cache.get(id);\r\n}\r\n```","title":"Allow only first thread to update cache while other threads read","body":"<p>This is a classic double-checking problem:</p>\n<pre class=\"lang-java prettyprint-override\"><code>// Note: the method isn't synchronized\npublic boolean readCache(int id) {\n  // First check - quick check outside the lock.\n  // If the cache isn't expired, no need to acquire a lock\n  if (cache.hasExpired()) {\n    // This thread may have to update the cache, so acquire the lock:\n    synchronized (someSharedLock) {\n      // Under the lock, double-check a different thread didn't update the cache\n      // while we were waiting for the lock\n      if (cache.hasExpired()) {\n        updateCache();\n      }\n    }\n  }\n\n  // The cache is now definitely not expired, use it\n  return cache.get(id);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":60171,"reputation":115485,"user_id":179850,"accept_rate":100,"display_name":"Gray"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1641400119,"creation_date":1641238817,"answer_id":70570646,"question_id":70563282,"body_markdown":"&gt; I have multiple threads reading an in memory cache. The behavior I want is to refresh the cache every 5min. The problem is I don&#39;t know how to solve is how to force only one thread to update the cache while multiple threads still can read the cache.\r\n\r\nThere are a couple of ways you can do this.\r\n\r\n* You could use the `ReentrantReadWriteLock` and have each thread get a read-lock on the cache and but then attempt to get a write-lock if the cache needs to be updated  only one thread will get the write-lock.  It is important to note that when the cache is being updated, no threads can be reading the cache.  This may or may not be what you want.\r\n* Another mechanism could be to use the atomic classes `compareAndSet(...)` method so that if multiple threads determine that the cache needs to be updated, only one thread would win.  The pseudo code would be:\r\n\r\n      get cache value\r\n      see if cache needs updating\r\n      try to update the atomic field with our thread-id (or other unique)\r\n      if it worked then update the cache\r\n      else some other thread is updating the cache, return stale value for now\r\n\r\nIn terms of race conditions between the cache being stale or not, you will either need something as heavy as a `synchronized` lock or you are going to have to put up with some stale data around the time the cache needs to be updated.  This may depend on how long it takes to update the cache.  Either a thread requests the value a nanosecond before it expires or it doesn&#39;t.  If the value _must_ be updated every 5 minutes then and you don&#39;t want to use `synchronized` then you should probably update the cache more frequently  like every 4 minutes and 50 seconds  so that the chance of stale data is reduced.\r\n\r\nIt is important to note that however you update the cache, the cache itself will need to have its memory synchronized.  The cache will need to be something like a `ConcurrentHashMap` or a `volatile` object so that the threads can read the updated cache values and one of them can update the value when appropriate and have the updates seen by the other threads.\r\n","title":"Allow only first thread to update cache while other threads read","body":"<blockquote>\n<p>I have multiple threads reading an in memory cache. The behavior I want is to refresh the cache every 5min. The problem is I don't know how to solve is how to force only one thread to update the cache while multiple threads still can read the cache.</p>\n</blockquote>\n<p>There are a couple of ways you can do this.</p>\n<ul>\n<li><p>You could use the <code>ReentrantReadWriteLock</code> and have each thread get a read-lock on the cache and but then attempt to get a write-lock if the cache needs to be updated  only one thread will get the write-lock.  It is important to note that when the cache is being updated, no threads can be reading the cache.  This may or may not be what you want.</p>\n</li>\n<li><p>Another mechanism could be to use the atomic classes <code>compareAndSet(...)</code> method so that if multiple threads determine that the cache needs to be updated, only one thread would win.  The pseudo code would be:</p>\n<pre><code>get cache value\nsee if cache needs updating\ntry to update the atomic field with our thread-id (or other unique)\nif it worked then update the cache\nelse some other thread is updating the cache, return stale value for now\n</code></pre>\n</li>\n</ul>\n<p>In terms of race conditions between the cache being stale or not, you will either need something as heavy as a <code>synchronized</code> lock or you are going to have to put up with some stale data around the time the cache needs to be updated.  This may depend on how long it takes to update the cache.  Either a thread requests the value a nanosecond before it expires or it doesn't.  If the value <em>must</em> be updated every 5 minutes then and you don't want to use <code>synchronized</code> then you should probably update the cache more frequently  like every 4 minutes and 50 seconds  so that the chance of stale data is reduced.</p>\n<p>It is important to note that however you update the cache, the cache itself will need to have its memory synchronized.  The cache will need to be something like a <code>ConcurrentHashMap</code> or a <code>volatile</code> object so that the threads can read the updated cache values and one of them can update the value when appropriate and have the updates seen by the other threads.</p>\n"}],"owner":{"account_id":3779712,"reputation":7022,"user_id":3139545,"accept_rate":62,"display_name":"user3139545"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":611,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":70570646,"answer_count":2,"score":1,"last_activity_date":1641400119,"creation_date":1641199193,"question_id":70563282,"body_markdown":"I have multiple threads reading an in-memory cache. The behavior I want is to refresh the cache every 5min. The problem is I don&#39;t know how to solve is how to force only one thread to update the cache while multiple threads still can read the cache.\r\n\r\nThis is a rough example of the code I have:\r\n\r\n```\r\npublic synchronized boolean readCache(int id) {\r\n  if (cache.hasExpired()) {\r\n    updateCache();\r\n  }\r\n  return cache.get(id);\r\n}\r\n```\r\n\r\nThis works. However, it limits the implementation that only a single thread can read the cache at any instance. Is there a better way to do this?","title":"Allow only first thread to update cache while other threads read","body":"<p>I have multiple threads reading an in-memory cache. The behavior I want is to refresh the cache every 5min. The problem is I don't know how to solve is how to force only one thread to update the cache while multiple threads still can read the cache.</p>\n<p>This is a rough example of the code I have:</p>\n<pre><code>public synchronized boolean readCache(int id) {\n  if (cache.hasExpired()) {\n    updateCache();\n  }\n  return cache.get(id);\n}\n</code></pre>\n<p>This works. However, it limits the implementation that only a single thread can read the cache at any instance. Is there a better way to do this?</p>\n"},{"tags":["python","java","windows","ipc","shared-memory"],"comments":[{"owner":{"account_id":9169814,"reputation":13746,"user_id":6817835,"accept_rate":87,"display_name":"gold_cy"},"score":0,"creation_date":1641398971,"post_id":70595826,"comment_id":124795956,"body_markdown":"https://www.py4j.org/ is what you are looking for probably","body":"<a href=\"https://www.py4j.org/\" rel=\"nofollow noreferrer\">py4j.org</a> is what you are looking for probably"},{"owner":{"account_id":2127644,"reputation":48133,"user_id":1889329,"accept_rate":71,"display_name":"IInspectable"},"score":0,"creation_date":1641400480,"post_id":70595826,"comment_id":124796586,"body_markdown":"Presumably, you don&#39;t care half as much about raw performance as you do about guaranteed response times. Using two languages and runtimes that neither have predictable performance characteristics isn&#39;t going to get you there.","body":"Presumably, you don&#39;t care half as much about raw performance as you do about guaranteed response times. Using two languages and runtimes that neither have predictable performance characteristics isn&#39;t going to get you there."},{"owner":{"account_id":1553950,"reputation":1291,"user_id":1445660,"accept_rate":38,"display_name":"Rony Tesler"},"score":0,"creation_date":1641400971,"post_id":70595826,"comment_id":124796803,"body_markdown":"@IInspectable Which response times exactly? The data that is received every 100ms is something that already happens.","body":"@IInspectable Which response times exactly? The data that is received every 100ms is something that already happens."},{"owner":{"account_id":1553950,"reputation":1291,"user_id":1445660,"accept_rate":38,"display_name":"Rony Tesler"},"score":0,"creation_date":1641401004,"post_id":70595826,"comment_id":124796833,"body_markdown":"@gold_cy Isn&#39;t it much slower than shared memory?","body":"@gold_cy Isn&#39;t it much slower than shared memory?"},{"owner":{"account_id":2127644,"reputation":48133,"user_id":1889329,"accept_rate":71,"display_name":"IInspectable"},"score":0,"creation_date":1641401138,"post_id":70595826,"comment_id":124796891,"body_markdown":"If the data arrives at a steady pace of 100 bytes/100 ms, then surely you wish to have that processed in a timely fashion. Non-deterministic garbage collection won&#39;t allow you to make any promises with respect to response times.","body":"If the data arrives at a steady pace of 100 bytes/100 ms, then surely you wish to have that processed in a timely fashion. Non-deterministic garbage collection won&#39;t allow you to make any promises with respect to response times."},{"owner":{"account_id":9169814,"reputation":13746,"user_id":6817835,"accept_rate":87,"display_name":"gold_cy"},"score":1,"creation_date":1641401357,"post_id":70595826,"comment_id":124796990,"body_markdown":"@RonyTesler https://www.py4j.org/about.html#alternatives-to-py4j","body":"@RonyTesler <a href=\"https://www.py4j.org/about.html#alternatives-to-py4j\" rel=\"nofollow noreferrer\">py4j.org/about.html#alternatives-to-py4j</a>"},{"owner":{"account_id":1553950,"reputation":1291,"user_id":1445660,"accept_rate":38,"display_name":"Rony Tesler"},"score":0,"creation_date":1641590711,"post_id":70595826,"comment_id":124852974,"body_markdown":"@IInspectable Do I need to synchronize the writes in one process with the reads from the other process, or the write operation is atomic?","body":"@IInspectable Do I need to synchronize the writes in one process with the reads from the other process, or the write operation is atomic?"},{"owner":{"account_id":2127644,"reputation":48133,"user_id":1889329,"accept_rate":71,"display_name":"IInspectable"},"score":1,"creation_date":1641633202,"post_id":70595826,"comment_id":124859102,"body_markdown":"Atomicity is a property of the implementation. Since you haven&#39;t decided on an implementation that question cannot be answered.","body":"Atomicity is a property of the implementation. Since you haven&#39;t decided on an implementation that question cannot be answered."},{"owner":{"account_id":1553950,"reputation":1291,"user_id":1445660,"accept_rate":38,"display_name":"Rony Tesler"},"score":0,"creation_date":1641650154,"post_id":70595826,"comment_id":124862520,"body_markdown":"@IInspectable I thought maybe the operation system prevents it.","body":"@IInspectable I thought maybe the operation system prevents it."}],"owner":{"account_id":1553950,"reputation":1291,"user_id":1445660,"accept_rate":38,"display_name":"Rony Tesler"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":338,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1641399946,"creation_date":1641398092,"question_id":70595826,"body_markdown":"I have a java process that gets about 100B of data each 100ms from some other machine. I want to pass this 100B message to another process on the same machine which is written in python. After the python process processes this message I want to pass the processed message back to the java process. The processes run on Windows.\r\nIs using shared memory the best way?","title":"fastest way to communicate between two processes on Windows - java and python","body":"<p>I have a java process that gets about 100B of data each 100ms from some other machine. I want to pass this 100B message to another process on the same machine which is written in python. After the python process processes this message I want to pass the processed message back to the java process. The processes run on Windows.\nIs using shared memory the best way?</p>\n"},{"tags":["java","unit-testing","option-type"],"comments":[{"owner":{"account_id":7612423,"reputation":82486,"user_id":5772882,"display_name":"Anonymous"},"score":5,"creation_date":1471264559,"post_id":38954742,"comment_id":65264105,"body_markdown":"Id simply use `assertEquals(&quot;actual value&quot;, testedMethod().get());` It will fail with an exception if the optional is empty, which is enough for your unit test to fail,so you really need nothing more.","body":"Id simply use <code>assertEquals(&quot;actual value&quot;, testedMethod().get());</code> It will fail with an exception if the optional is empty, which is enough for your unit test to fail,so you really need nothing more."}],"answers":[{"tags":[],"owner":{"account_id":406441,"reputation":32619,"user_id":775954,"accept_rate":85,"display_name":"Matthias Braun"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1471262645,"creation_date":1471262645,"answer_id":38954743,"question_id":38954742,"body_markdown":"I use [Hamcrest Optional][1] for that:\r\n\r\n    import static com.github.npathai.hamcrestopt.OptionalMatchers.hasValue;\r\n    import org.junit.Test;\r\n\r\n    public class MyUnitTests {\r\n\r\n      @Test\r\n      public void testThatOptionalHasValue(){\r\n        String expectedValue = &quot;actual value&quot;;\r\n        assertThat(testedMethod(), hasValue(expectedValue));\r\n      }\r\n    }\r\n\r\nYou can add Hamcrest Optional to your dependencies by including it in your `build.gradle`:\r\n\r\n    dependencies {\r\n      testCompile &#39;junit:junit:4.12&#39;\r\n      testCompile &#39;com.github.npathai:hamcrest-optional:1.0&#39;\r\n    }\r\n\r\n\r\n  [1]: https://github.com/npathai/hamcrest-optional","title":"Assert that Optional has certain value","body":"<p>I use <a href=\"https://github.com/npathai/hamcrest-optional\" rel=\"nofollow\">Hamcrest Optional</a> for that:</p>\n\n<pre><code>import static com.github.npathai.hamcrestopt.OptionalMatchers.hasValue;\nimport org.junit.Test;\n\npublic class MyUnitTests {\n\n  @Test\n  public void testThatOptionalHasValue(){\n    String expectedValue = \"actual value\";\n    assertThat(testedMethod(), hasValue(expectedValue));\n  }\n}\n</code></pre>\n\n<p>You can add Hamcrest Optional to your dependencies by including it in your <code>build.gradle</code>:</p>\n\n<pre><code>dependencies {\n  testCompile 'junit:junit:4.12'\n  testCompile 'com.github.npathai:hamcrest-optional:1.0'\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8986268,"reputation":31,"user_id":6699757,"display_name":"mzq"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1471262954,"creation_date":1471262954,"answer_id":38954802,"question_id":38954742,"body_markdown":"Why dont you use `isPresent()` and `get()`?","title":"Assert that Optional has certain value","body":"<p>Why dont you use <code>isPresent()</code> and <code>get()</code>?</p>\n"},{"tags":[],"owner":{"account_id":5501406,"reputation":4041,"user_id":4370629,"accept_rate":67,"display_name":"Spotted"},"down_vote_count":0,"up_vote_count":59,"is_accepted":true,"score":59,"last_activity_date":1471263813,"creation_date":1471263259,"answer_id":38954876,"question_id":38954742,"body_markdown":"You can also use [AssertJ][1] for fluent assertions\r\n\r\n\t@Test\r\n\tpublic void testThatOptionalIsNotEmpty() {\r\n\t\tassertThat(testedMethod()).isNotEmpty();\r\n\t}\r\n\r\n\t@Test\r\n\tpublic void testThatOptionalHasValue() {\r\n\t\tassertThat(testedMethod()).hasValue(&quot;hello&quot;);\r\n\t}\r\n\r\n\r\n  [1]: http://joel-costigliola.github.io/assertj/index.html","title":"Assert that Optional has certain value","body":"<p>You can also use <a href=\"http://joel-costigliola.github.io/assertj/index.html\" rel=\"noreferrer\">AssertJ</a> for fluent assertions</p>\n\n<pre><code>@Test\npublic void testThatOptionalIsNotEmpty() {\n    assertThat(testedMethod()).isNotEmpty();\n}\n\n@Test\npublic void testThatOptionalHasValue() {\n    assertThat(testedMethod()).hasValue(\"hello\");\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2256418,"reputation":3983,"user_id":1987514,"accept_rate":86,"display_name":"Ben Green"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1471263540,"creation_date":1471263540,"answer_id":38954948,"question_id":38954742,"body_markdown":"The below approach uses the fact that you can specify a default return for an optional. So your test method could be something like this:\r\n\r\n    @test\r\n    public void testThatOptionalHasValue() {\r\n        String expectedValue = &quot;actual value&quot;;\r\n        String actualValue = Optional.ofNullable(testedMethod()).orElse(&quot;not &quot; + expectedValue);\r\n        assertEquals(&quot;The values are not the same&quot;, expectedValue, actualValue);\r\n    }\r\n\r\nThis guarentees that if your method returns null, then the result can not be the same as the expected value.","title":"Assert that Optional has certain value","body":"<p>The below approach uses the fact that you can specify a default return for an optional. So your test method could be something like this:</p>\n\n<pre><code>@test\npublic void testThatOptionalHasValue() {\n    String expectedValue = \"actual value\";\n    String actualValue = Optional.ofNullable(testedMethod()).orElse(\"not \" + expectedValue);\n    assertEquals(\"The values are not the same\", expectedValue, actualValue);\n}\n</code></pre>\n\n<p>This guarentees that if your method returns null, then the result can not be the same as the expected value.</p>\n"},{"tags":[],"owner":{"account_id":1548079,"reputation":128727,"user_id":1441122,"display_name":"Stuart Marks"},"down_vote_count":4,"up_vote_count":46,"is_accepted":false,"score":42,"last_activity_date":1522528495,"creation_date":1471276440,"answer_id":38958484,"question_id":38954742,"body_markdown":"TL;DR the best overall approach was suggested by Ole V. V.:\r\n\r\n    assertEquals(Optional.of(&quot;expected&quot;), opt);\r\n\r\nOther alternatives are discussed below.\r\n\r\nThere are several different ways to do this, depending on your taste for clarity of test results vs. conciseness of test writing. For this answer I&#39;ll stick to &quot;stock&quot; Java 8 and JUnit 4 with no additional dependencies.\r\n\r\nOne way, as suggested in a [comment by Ole V.V.][1], is simply to write\r\n\r\n    assertEquals(&quot;expected&quot;, opt.get());\r\n\r\nThis mostly works but if the Optional is empty, then `get()` will throw `NoSuchElementException`. This in turn causes JUnit to signal an error instead of a failure, which might not be what you want. It&#39;s also not very clear what&#39;s going on unless you already know that `get()` throws NSEE in this case.\r\n\r\nAn alternative is\r\n\r\n    assertTrue(opt.isPresent() &amp;&amp; &quot;expected&quot;.equals(opt.get()));\r\n\r\nThis also mostly works but it doesn&#39;t report the actual value if there&#39;s a mismatch, which might make debugging inconvenient.\r\n\r\nAnother alternative is\r\n\r\n    assertEquals(&quot;expected&quot;, opt.orElseThrow(AssertionFailedError::new));\r\n\r\nThis gives the right failures and reports the actual value when there&#39;s a mismatch, but it&#39;s not very explicit about why `AssertionFailedError` is thrown. You might have to stare at it a while until you realize that AFE gets thrown when the Optional is empty.\r\n\r\nStill another alternative is\r\n\r\n    assertEquals(&quot;expected&quot;, opt.orElseThrow(() -&gt; new AssertionFailedError(&quot;empty&quot;)));\r\n\r\nbut this is starting to get verbose.\r\n\r\nYou could split this into two assertions,\r\n\r\n    assertTrue(opt.isPresent());\r\n    assertEquals(&quot;expected&quot;, opt.get());\r\n\r\nbut you had previously objected to [this suggestion][2] because of verbosity. This isn&#39;t really terribly verbose in my opinion, but it does have some cognitive overhead since there are two separate assertions, and it relies on the second only being checked if the first succeeds. This is not incorrect but it is a bit subtle.\r\n\r\nFinally, if you&#39;re willing to create a bit of your own infrastructure, you could create a suitably-named subclass of `AssertionFailedError` and use it like this:\r\n\r\n    assertEquals(&quot;expected&quot;, opt.orElseThrow(UnexpectedEmptyOptional::new));\r\n\r\nFinally, in another comment, Ole V. V. suggested\r\n\r\n    assertEquals(Optional.of(&quot;correct&quot;), opt);\r\n\r\nThis works quite well, and in fact this might be the best of all.\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/38954742/assert-that-optional-has-certain-value#comment65264105_38954742\r\n  [2]: https://stackoverflow.com/a/38954802/1441122","title":"Assert that Optional has certain value","body":"<p>TL;DR the best overall approach was suggested by Ole V. V.:</p>\n\n<pre><code>assertEquals(Optional.of(\"expected\"), opt);\n</code></pre>\n\n<p>Other alternatives are discussed below.</p>\n\n<p>There are several different ways to do this, depending on your taste for clarity of test results vs. conciseness of test writing. For this answer I'll stick to \"stock\" Java 8 and JUnit 4 with no additional dependencies.</p>\n\n<p>One way, as suggested in a <a href=\"https://stackoverflow.com/questions/38954742/assert-that-optional-has-certain-value#comment65264105_38954742\">comment by Ole V.V.</a>, is simply to write</p>\n\n<pre><code>assertEquals(\"expected\", opt.get());\n</code></pre>\n\n<p>This mostly works but if the Optional is empty, then <code>get()</code> will throw <code>NoSuchElementException</code>. This in turn causes JUnit to signal an error instead of a failure, which might not be what you want. It's also not very clear what's going on unless you already know that <code>get()</code> throws NSEE in this case.</p>\n\n<p>An alternative is</p>\n\n<pre><code>assertTrue(opt.isPresent() &amp;&amp; \"expected\".equals(opt.get()));\n</code></pre>\n\n<p>This also mostly works but it doesn't report the actual value if there's a mismatch, which might make debugging inconvenient.</p>\n\n<p>Another alternative is</p>\n\n<pre><code>assertEquals(\"expected\", opt.orElseThrow(AssertionFailedError::new));\n</code></pre>\n\n<p>This gives the right failures and reports the actual value when there's a mismatch, but it's not very explicit about why <code>AssertionFailedError</code> is thrown. You might have to stare at it a while until you realize that AFE gets thrown when the Optional is empty.</p>\n\n<p>Still another alternative is</p>\n\n<pre><code>assertEquals(\"expected\", opt.orElseThrow(() -&gt; new AssertionFailedError(\"empty\")));\n</code></pre>\n\n<p>but this is starting to get verbose.</p>\n\n<p>You could split this into two assertions,</p>\n\n<pre><code>assertTrue(opt.isPresent());\nassertEquals(\"expected\", opt.get());\n</code></pre>\n\n<p>but you had previously objected to <a href=\"https://stackoverflow.com/a/38954802/1441122\">this suggestion</a> because of verbosity. This isn't really terribly verbose in my opinion, but it does have some cognitive overhead since there are two separate assertions, and it relies on the second only being checked if the first succeeds. This is not incorrect but it is a bit subtle.</p>\n\n<p>Finally, if you're willing to create a bit of your own infrastructure, you could create a suitably-named subclass of <code>AssertionFailedError</code> and use it like this:</p>\n\n<pre><code>assertEquals(\"expected\", opt.orElseThrow(UnexpectedEmptyOptional::new));\n</code></pre>\n\n<p>Finally, in another comment, Ole V. V. suggested</p>\n\n<pre><code>assertEquals(Optional.of(\"correct\"), opt);\n</code></pre>\n\n<p>This works quite well, and in fact this might be the best of all.</p>\n"},{"tags":[],"owner":{"account_id":3659251,"reputation":859,"user_id":3049500,"display_name":"Stefan Mondelaers"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641399655,"creation_date":1641399655,"answer_id":70596188,"question_id":38954742,"body_markdown":"I prefer applying .orElse(null) to the returned Optional before asserting it.\r\n\r\nThe method assertEquals can be used with an Optional containing the expected value  (or assertThat(result).isEqualTo(expected) when using FEST assertions).\r\n\r\nBut using .orElse has the benefit that the result has the correct type and that allows to do all checks that you might want to do also if the method wasn&#39;t an optional:\r\n\r\n - == operator (or isSame method when using FEST)\r\n - compareTo and methods using compareTo\r\n - startsWith, endsWith, contains, length in case of a String\r\n - ...\r\n\r\nUsing an Optional of the expected value doesn&#39;t allow all those things.","title":"Assert that Optional has certain value","body":"<p>I prefer applying .orElse(null) to the returned Optional before asserting it.</p>\n<p>The method assertEquals can be used with an Optional containing the expected value  (or assertThat(result).isEqualTo(expected) when using FEST assertions).</p>\n<p>But using .orElse has the benefit that the result has the correct type and that allows to do all checks that you might want to do also if the method wasn't an optional:</p>\n<ul>\n<li>== operator (or isSame method when using FEST)</li>\n<li>compareTo and methods using compareTo</li>\n<li>startsWith, endsWith, contains, length in case of a String</li>\n<li>...</li>\n</ul>\n<p>Using an Optional of the expected value doesn't allow all those things.</p>\n"}],"owner":{"account_id":406441,"reputation":32619,"user_id":775954,"accept_rate":85,"display_name":"Matthias Braun"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":97908,"favorite_count":0,"down_vote_count":0,"up_vote_count":52,"accepted_answer_id":38954876,"answer_count":6,"score":52,"last_activity_date":1641399655,"creation_date":1471262645,"question_id":38954742,"body_markdown":"I have a Java method that returns an [Optional][1].\r\nI&#39;d like to write an easy-to-read unit test for it that asserts that\r\n\r\n 1. the returned Optional has a value (i.e., the Optional is not empty) and that\r\n\r\n 2. the returned value is equal to an expected value.\r\n\r\n\r\nLet&#39;s say my tested method is\r\n\r\n    Optional&lt;String&gt; testedMethod(){\r\n      return Optional.of(&quot;actual value&quot;);\r\n    }\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html","title":"Assert that Optional has certain value","body":"<p>I have a Java method that returns an <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html\" rel=\"noreferrer\">Optional</a>.\nI'd like to write an easy-to-read unit test for it that asserts that</p>\n\n<ol>\n<li><p>the returned Optional has a value (i.e., the Optional is not empty) and that</p></li>\n<li><p>the returned value is equal to an expected value.</p></li>\n</ol>\n\n<p>Let's say my tested method is</p>\n\n<pre><code>Optional&lt;String&gt; testedMethod(){\n  return Optional.of(\"actual value\");\n}\n</code></pre>\n"},{"tags":["java","list","arraylist"],"comments":[{"owner":{"account_id":74704,"reputation":11534,"user_id":214525,"accept_rate":100,"display_name":"f1sh"},"score":0,"creation_date":1641396923,"post_id":70595527,"comment_id":124795000,"body_markdown":"Your data type is wrong. The title even says &quot;List within a list&quot;, yet nothing like that is happening in the code. `listToReturn` needs to be a `List&lt;List&lt;Integer&gt;&gt;`.","body":"Your data type is wrong. The title even says &quot;List within a list&quot;, yet nothing like that is happening in the code. <code>listToReturn</code> needs to be a <code>List&lt;List&lt;Integer&gt;&gt;</code>."}],"answers":[{"tags":[],"owner":{"account_id":15064163,"reputation":13519,"user_id":10871900,"display_name":"dan1st is crying"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1641399570,"creation_date":1641397027,"answer_id":70595577,"question_id":70595527,"body_markdown":"`List&lt;Integer&gt;` is a `List` of `Integer`s. You want a `List&lt;List&lt;Integer&gt;&gt;`, a list of lists of integers. This works like the following:\r\n\r\n```java\r\nList&lt;List&lt;Integer&gt;&gt; finalList = fetchStuff();\r\nlog.info(desiredList);\r\n\r\nprivate List&lt;List&lt;Integer&gt;&gt; fetchStuff() {\r\n  List&lt;List&lt;Integer&gt;&gt; listToReturn = new ArrayList&lt;&gt;();\r\n  List&lt;NameOfClass&gt; desiredList = desiredListRepo.findAll();\r\n  for (NameOfClass nameOfClass : desiredList) {\r\n       List&lt;Integer&gt; inner=new ArrayList&lt;&gt;();\r\n       inner.add(nameOfClass.getNumber());\r\n       inner.add(nameOfClass.getSquaredNumber());\r\n       listToReturn.add(inner);\r\n  }\r\n  return listToReturn;\r\n} \r\n```\r\n\r\nIf you want to have a `List` of pairs of numbers, you can use `Map.Entry`:\r\n\r\n```java\r\nList&lt;Map.Entry&lt;Integer&gt;&gt; finalList = fetchStuff();\r\nlog.info(desiredList);\r\n\r\nprivate List&lt;Map.Entry&lt;Integer, Integer&gt;&gt; fetchStuff() {\r\n  List&lt;Map.Entry&lt;Integer&gt;&gt; listToReturn = new ArrayList&lt;&gt;();\r\n  List&lt;NameOfClass&gt; desiredList = desiredListRepo.findAll();\r\n  for (NameOfClass nameOfClass : desiredList) {\r\n       inner.add(nameOfClass.getNumber());\r\n       inner.add(nameOfClass.getSquaredNumber());\r\n       listToReturn.add(Map.entry(desiredList.getNumber(), desiredList. getSquaredNumber()));\r\n  }\r\n  return listToReturn;\r\n} \r\n```","title":"How do I make a List within a list in it in Java?","body":"<p><code>List&lt;Integer&gt;</code> is a <code>List</code> of <code>Integer</code>s. You want a <code>List&lt;List&lt;Integer&gt;&gt;</code>, a list of lists of integers. This works like the following:</p>\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;List&lt;Integer&gt;&gt; finalList = fetchStuff();\nlog.info(desiredList);\n\nprivate List&lt;List&lt;Integer&gt;&gt; fetchStuff() {\n  List&lt;List&lt;Integer&gt;&gt; listToReturn = new ArrayList&lt;&gt;();\n  List&lt;NameOfClass&gt; desiredList = desiredListRepo.findAll();\n  for (NameOfClass nameOfClass : desiredList) {\n       List&lt;Integer&gt; inner=new ArrayList&lt;&gt;();\n       inner.add(nameOfClass.getNumber());\n       inner.add(nameOfClass.getSquaredNumber());\n       listToReturn.add(inner);\n  }\n  return listToReturn;\n} \n</code></pre>\n<p>If you want to have a <code>List</code> of pairs of numbers, you can use <code>Map.Entry</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;Map.Entry&lt;Integer&gt;&gt; finalList = fetchStuff();\nlog.info(desiredList);\n\nprivate List&lt;Map.Entry&lt;Integer, Integer&gt;&gt; fetchStuff() {\n  List&lt;Map.Entry&lt;Integer&gt;&gt; listToReturn = new ArrayList&lt;&gt;();\n  List&lt;NameOfClass&gt; desiredList = desiredListRepo.findAll();\n  for (NameOfClass nameOfClass : desiredList) {\n       inner.add(nameOfClass.getNumber());\n       inner.add(nameOfClass.getSquaredNumber());\n       listToReturn.add(Map.entry(desiredList.getNumber(), desiredList. getSquaredNumber()));\n  }\n  return listToReturn;\n} \n</code></pre>\n"}],"owner":{"account_id":23836437,"reputation":13,"user_id":17842121,"display_name":"learningcoder"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":435,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":70595577,"answer_count":1,"score":1,"last_activity_date":1641399570,"creation_date":1641396817,"question_id":70595527,"body_markdown":"Lets assume I have a MySql table:\r\n\r\n`Number  |  Squared`\r\n\r\n`2       |     4`\r\n\r\n`3       |     9`\r\n\r\n`4       |     16`\r\n\r\n`5       |     25`\r\n\r\n\r\nIn my Java application, this is what I have so far:\r\n\r\n    List&lt;Integer&gt; finalList = fetchStuff();\r\n    log.info(desiredList);\r\n\r\n    private List&lt;Integer&gt; fetchStuff() {\r\n      List&lt;Integer&gt; listToReturn = new ArrayList&lt;Integer&gt;();\r\n      List&lt;NameOfClass&gt; desiredList = desiredListRepo.findAll();\r\n      for (NameOfClass nameOfClass : desiredList) {\r\n           listToReturn.add(nameOfClass.getNumber());\r\n           listToReturn.add(nameOfClass.getSquaredNumber());\r\n      }\r\n      return listToReturn;\r\n    }\r\n\r\n\r\n\r\nWhen I print desiredList, this is the output that I want to see:\r\n`[[2, 4], [3, 9], [4, 16], [5, 25]]`\r\nBut currently, I&#39;m seeing:\r\n`[2,4,3,9,4,16,5,25]`. What am I doing wrong?\r\n","title":"How do I make a List within a list in it in Java?","body":"<p>Lets assume I have a MySql table:</p>\n<p><code>Number  |  Squared</code></p>\n<p><code>2       |     4</code></p>\n<p><code>3       |     9</code></p>\n<p><code>4       |     16</code></p>\n<p><code>5       |     25</code></p>\n<p>In my Java application, this is what I have so far:</p>\n<pre><code>List&lt;Integer&gt; finalList = fetchStuff();\nlog.info(desiredList);\n\nprivate List&lt;Integer&gt; fetchStuff() {\n  List&lt;Integer&gt; listToReturn = new ArrayList&lt;Integer&gt;();\n  List&lt;NameOfClass&gt; desiredList = desiredListRepo.findAll();\n  for (NameOfClass nameOfClass : desiredList) {\n       listToReturn.add(nameOfClass.getNumber());\n       listToReturn.add(nameOfClass.getSquaredNumber());\n  }\n  return listToReturn;\n}\n</code></pre>\n<p>When I print desiredList, this is the output that I want to see:\n<code>[[2, 4], [3, 9], [4, 16], [5, 25]]</code>\nBut currently, I'm seeing:\n<code>[2,4,3,9,4,16,5,25]</code>. What am I doing wrong?</p>\n"},{"tags":["java","google-cloud-platform","google-cloud-run","stackdriver"],"comments":[{"owner":{"account_id":18115205,"reputation":1150,"user_id":13171940,"display_name":"Rogelio Monter"},"score":0,"creation_date":1640799173,"post_id":70521661,"comment_id":124662908,"body_markdown":"You should clarify your question with more details. [This article](https://stackoverflow.com/help/how-to-ask) could help you to improve your question.","body":"You should clarify your question with more details. <a href=\"https://stackoverflow.com/help/how-to-ask\">This article</a> could help you to improve your question."},{"owner":{"account_id":1504303,"reputation":105,"user_id":1408076,"display_name":"Victor Buldakov"},"score":0,"creation_date":1640803003,"post_id":70521661,"comment_id":124664111,"body_markdown":"@RogelioMonter what is unclear?","body":"@RogelioMonter what is unclear?"}],"answers":[{"tags":[],"owner":{"account_id":301516,"reputation":34141,"user_id":609290,"accept_rate":62,"display_name":"DazWilkin"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1640813042,"creation_date":1640812688,"answer_id":70525119,"question_id":70521661,"body_markdown":"I&#39;m unfamiliar with JMX but familiar with GCP including Cloud Run. \r\n\r\n&gt; I&#39;ve implemented something similar(ish) using Prometheus (and Cloud Endpoints for app security), multiplexing the app and metrics on 8080.\r\n\r\nIIUC the monitoring agent (based on collectd):\r\n\r\n1. collects metrics uses a predefined port\r\n1. ships these to Cloud Monitoring (formerly Stackdriver)\r\n\r\nAs you know, Cloud Run is container-based and only permits a single port (`8080`).\r\n\r\nI suspect it would be messy (and likely not supported by Google) to try to bundle the agent in the app&#39;s container but that the agent would be able to call home (Cloud Monitoring) though still, though perhaps with some IAM tweaking.\r\n\r\n&gt; It would be great if Cloud Run permitted multiple containers per service\r\n\r\nPotentially, you can multiplex JMX and your app traffic over 8080.\r\n\r\n&gt; It would be great if Cloud Run permitted multiple ports per service\r\n\r\nThen, your regular users could access the app and the monitoring agent (running elsewhere) could ping the JMX metrics on the same service port and ship these to Cloud Monitoring.\r\n\r\nYou&#39;d need to be more mindful of security. You can craft JWTs to authenticate to Cloud Run though these are more &quot;prickly&quot; with Cloud Run because each service requires a specific JWT using the service&#39;s endpoint to form its audience.\r\n\r\nYou&#39;d likely want to prohibit authenticated app users from capturing your JMX metrics too.\r\n\r\nI&#39;m assuming there&#39;s no restriction on routing JMX traffic through Google&#39;s frontend to Cloud Run services.\r\n","title":"Is there a way to monitor to Java app running in Docker container in Google Cloud Run with Java JMX Stackdriver plugin?","body":"<p>I'm unfamiliar with JMX but familiar with GCP including Cloud Run.</p>\n<blockquote>\n<p>I've implemented something similar(ish) using Prometheus (and Cloud Endpoints for app security), multiplexing the app and metrics on 8080.</p>\n</blockquote>\n<p>IIUC the monitoring agent (based on collectd):</p>\n<ol>\n<li>collects metrics uses a predefined port</li>\n<li>ships these to Cloud Monitoring (formerly Stackdriver)</li>\n</ol>\n<p>As you know, Cloud Run is container-based and only permits a single port (<code>8080</code>).</p>\n<p>I suspect it would be messy (and likely not supported by Google) to try to bundle the agent in the app's container but that the agent would be able to call home (Cloud Monitoring) though still, though perhaps with some IAM tweaking.</p>\n<blockquote>\n<p>It would be great if Cloud Run permitted multiple containers per service</p>\n</blockquote>\n<p>Potentially, you can multiplex JMX and your app traffic over 8080.</p>\n<blockquote>\n<p>It would be great if Cloud Run permitted multiple ports per service</p>\n</blockquote>\n<p>Then, your regular users could access the app and the monitoring agent (running elsewhere) could ping the JMX metrics on the same service port and ship these to Cloud Monitoring.</p>\n<p>You'd need to be more mindful of security. You can craft JWTs to authenticate to Cloud Run though these are more &quot;prickly&quot; with Cloud Run because each service requires a specific JWT using the service's endpoint to form its audience.</p>\n<p>You'd likely want to prohibit authenticated app users from capturing your JMX metrics too.</p>\n<p>I'm assuming there's no restriction on routing JMX traffic through Google's frontend to Cloud Run services.</p>\n"},{"tags":[],"owner":{"account_id":1504303,"reputation":105,"user_id":1408076,"display_name":"Victor Buldakov"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641399280,"creation_date":1641385592,"answer_id":70592861,"question_id":70521661,"body_markdown":"Apparently much better option is to instrument Java code in Cloud Run is to use OpenCensus library.\r\n\r\nOpenCensus library can easily work with DropWizard and it has implementation of Stackdriver exporter.\r\n\r\nSome pointers here:\r\nhttps://opencensus.io/exporters/supported-exporters/java/stackdriver-stats/\r\nhttps://cloud.google.com/monitoring/custom-metrics/open-census\r\n\r\n","title":"Is there a way to monitor to Java app running in Docker container in Google Cloud Run with Java JMX Stackdriver plugin?","body":"<p>Apparently much better option is to instrument Java code in Cloud Run is to use OpenCensus library.</p>\n<p>OpenCensus library can easily work with DropWizard and it has implementation of Stackdriver exporter.</p>\n<p>Some pointers here:\n<a href=\"https://opencensus.io/exporters/supported-exporters/java/stackdriver-stats/\" rel=\"nofollow noreferrer\">https://opencensus.io/exporters/supported-exporters/java/stackdriver-stats/</a>\n<a href=\"https://cloud.google.com/monitoring/custom-metrics/open-census\" rel=\"nofollow noreferrer\">https://cloud.google.com/monitoring/custom-metrics/open-census</a></p>\n"}],"owner":{"account_id":1504303,"reputation":105,"user_id":1408076,"display_name":"Victor Buldakov"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":473,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":70525119,"answer_count":2,"score":1,"last_activity_date":1641399280,"creation_date":1640792407,"question_id":70521661,"body_markdown":"I&#39;m trying to collect metrics with DropWizard metrics library and export them through JMX.\r\n\r\nOn Google Cloud Engine it&#39;s easy to export these metrics with JMX plugin for Stackdriver (https://cloud.google.com/monitoring/agent/plugins/jvm#configuring)\r\n\r\nHowever I need to do similar thing using Cloud Run, is there a known way to do that? \r\n\r\nThanks!","title":"Is there a way to monitor to Java app running in Docker container in Google Cloud Run with Java JMX Stackdriver plugin?","body":"<p>I'm trying to collect metrics with DropWizard metrics library and export them through JMX.</p>\n<p>On Google Cloud Engine it's easy to export these metrics with JMX plugin for Stackdriver (<a href=\"https://cloud.google.com/monitoring/agent/plugins/jvm#configuring\" rel=\"nofollow noreferrer\">https://cloud.google.com/monitoring/agent/plugins/jvm#configuring</a>)</p>\n<p>However I need to do similar thing using Cloud Run, is there a known way to do that?</p>\n<p>Thanks!</p>\n"},{"tags":["java","jpeg","apache-commons-imaging"],"comments":[{"owner":{"account_id":11386,"reputation":119180,"user_id":21926,"display_name":"Sean Bright"},"score":0,"creation_date":1492708071,"post_id":43525655,"comment_id":74104793,"body_markdown":"Can you show the code that extracts the fields?","body":"Can you show the code that extracts the fields?"},{"owner":{"account_id":11386,"reputation":119180,"user_id":21926,"display_name":"Sean Bright"},"score":0,"creation_date":1492708285,"post_id":43525655,"comment_id":74104900,"body_markdown":"[This example code](https://commons.apache.org/proper/commons-imaging/xref-test/org/apache/commons/imaging/examples/WriteExifMetadataExample.html) shows how to read/write EXIF metadata. Is that what you want?","body":"<a href=\"https://commons.apache.org/proper/commons-imaging/xref-test/org/apache/commons/imaging/examples/WriteExifMetadataExample.html\" rel=\"nofollow noreferrer\">This example code</a> shows how to read/write EXIF metadata. Is that what you want?"},{"owner":{"account_id":7877749,"reputation":17,"user_id":5952982,"display_name":"Duke Jake Morgan"},"score":0,"creation_date":1492708424,"post_id":43525655,"comment_id":74104982,"body_markdown":"In the official docs or in the program, I am writing? If it is the program then here is the snippet of code that extracts the metadata from the photo file.\n https://gist.github.com/TheMasteredPanda/548a0fcc222d3b4a83eb586c3d7e7660","body":"In the official docs or in the program, I am writing? If it is the program then here is the snippet of code that extracts the metadata from the photo file.  <a href=\"https://gist.github.com/TheMasteredPanda/548a0fcc222d3b4a83eb586c3d7e7660\" rel=\"nofollow noreferrer\">gist.github.com/TheMasteredPanda/&hellip;</a>"},{"owner":{"account_id":11386,"reputation":119180,"user_id":21926,"display_name":"Sean Bright"},"score":0,"creation_date":1492708664,"post_id":43525655,"comment_id":74105125,"body_markdown":"Look at the link from my previous comment. There is a method named `setExifGPSTag` that shows how to write the `TiffOutputSet` to a new file.","body":"Look at the link from my previous comment. There is a method named <code>setExifGPSTag</code> that shows how to write the <code>TiffOutputSet</code> to a new file."},{"owner":{"account_id":7877749,"reputation":17,"user_id":5952982,"display_name":"Duke Jake Morgan"},"score":0,"creation_date":1492710820,"post_id":43525655,"comment_id":74106365,"body_markdown":"Alright, I understand how to write to a new file. But my problem is I don&#39;t know how to write a new image title and add tags to the image. So where TITLETITLE~ and HELLO~ are is the fields I want to alter. https://gyazo.com/b6509feb342b10a213c80c805541866d\n\nAm I missing something blatantly obvious?","body":"Alright, I understand how to write to a new file. But my problem is I don&#39;t know how to write a new image title and add tags to the image. So where TITLETITLE~ and HELLO~ are is the fields I want to alter. <a href=\"https://gyazo.com/b6509feb342b10a213c80c805541866d\" rel=\"nofollow noreferrer\">gyazo.com/b6509feb342b10a213c80c805541866d</a>  Am I missing something blatantly obvious?"}],"answers":[{"tags":[],"owner":{"account_id":16188128,"reputation":13,"user_id":11687639,"display_name":"Ted Carroll"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641398680,"creation_date":1641398680,"answer_id":70595971,"question_id":43525655,"body_markdown":"Here is an example using Apache Imaging (building on some of the code samples), where we are updating the common Windows fields such as Title, Subject, Comment, Rating, Keywords.  There is one issue that the title does not get updated if it already has a value - if it is blank, it gets written successfully.  I know this is a bit late but I was trying to do the same thing - the complexity is understanding which tag constants to use, as there are so many of them!  It is necessary to remove the field before adding (as a replacement).\r\n\r\n   \r\n    public static boolean updateWindowsFields(final File jpegImageFile, final File dst)\r\n            throws IOException, ImageReadException, ImageWriteException {\r\n\r\n        try (FileOutputStream fos = new FileOutputStream(dst);\r\n             OutputStream os = new BufferedOutputStream(fos)) {\r\n            TiffOutputSet outputSet = null;\r\n            // note that metadata might be null if no metadata is found.\r\n            final ImageMetadata metadata = Imaging.getMetadata(jpegImageFile);\r\n            final JpegImageMetadata jpegMetadata = (JpegImageMetadata) metadata;\r\n            if (null != jpegMetadata) {\r\n                // note that exif might be null if no Exif metadata is found.\r\n                final TiffImageMetadata exif = jpegMetadata.getExif();\r\n                if (null != exif) {\r\n                    outputSet = exif.getOutputSet();\r\n                }\r\n            }\r\n            // if file does not contain any exif metadata, we create an empty\r\n            // set of exif metadata. Otherwise, we keep all of the other\r\n            // existing tags.\r\n            if (null == outputSet) {\r\n                outputSet = new TiffOutputSet();\r\n            }\r\n\r\n            final TiffOutputDirectory rootDir = outputSet.getOrCreateRootDirectory();\r\n            rootDir.removeField(MicrosoftTagConstants.EXIF_TAG_XPTITLE);\r\n            rootDir.add(MicrosoftTagConstants.EXIF_TAG_XPTITLE, &quot;new title&quot;);\r\n\r\n            rootDir.removeField(MicrosoftTagConstants.EXIF_TAG_XPSUBJECT);\r\n            rootDir.add(MicrosoftTagConstants.EXIF_TAG_XPSUBJECT, &quot;new subject&quot;);\r\n            //\r\n            rootDir.removeField(MicrosoftTagConstants.EXIF_TAG_XPCOMMENT);\r\n            rootDir.add(MicrosoftTagConstants.EXIF_TAG_XPCOMMENT, &quot;new comment&quot;);\r\n            //\r\n            rootDir.removeField(MicrosoftTagConstants.EXIF_TAG_XPKEYWORDS);\r\n            rootDir.add(MicrosoftTagConstants.EXIF_TAG_XPKEYWORDS, &quot;key1;key2&quot;);\r\n            //\r\n            rootDir.removeField(MicrosoftTagConstants.EXIF_TAG_RATING);\r\n            rootDir.add(MicrosoftTagConstants.EXIF_TAG_RATING, (short) 4);\r\n\r\n            new ExifRewriter().updateExifMetadataLossless(jpegImageFile, os,\r\n                    outputSet);\r\n            return true;\r\n        }\r\n        catch(Exception e)\r\n        {\r\n            return false;\r\n        }\r\n\r\n    }\r\n  ","title":"Editing both jpg tag and title using Apache Imaging Library","body":"<p>Here is an example using Apache Imaging (building on some of the code samples), where we are updating the common Windows fields such as Title, Subject, Comment, Rating, Keywords.  There is one issue that the title does not get updated if it already has a value - if it is blank, it gets written successfully.  I know this is a bit late but I was trying to do the same thing - the complexity is understanding which tag constants to use, as there are so many of them!  It is necessary to remove the field before adding (as a replacement).</p>\n<pre><code>public static boolean updateWindowsFields(final File jpegImageFile, final File dst)\n        throws IOException, ImageReadException, ImageWriteException {\n\n    try (FileOutputStream fos = new FileOutputStream(dst);\n         OutputStream os = new BufferedOutputStream(fos)) {\n        TiffOutputSet outputSet = null;\n        // note that metadata might be null if no metadata is found.\n        final ImageMetadata metadata = Imaging.getMetadata(jpegImageFile);\n        final JpegImageMetadata jpegMetadata = (JpegImageMetadata) metadata;\n        if (null != jpegMetadata) {\n            // note that exif might be null if no Exif metadata is found.\n            final TiffImageMetadata exif = jpegMetadata.getExif();\n            if (null != exif) {\n                outputSet = exif.getOutputSet();\n            }\n        }\n        // if file does not contain any exif metadata, we create an empty\n        // set of exif metadata. Otherwise, we keep all of the other\n        // existing tags.\n        if (null == outputSet) {\n            outputSet = new TiffOutputSet();\n        }\n\n        final TiffOutputDirectory rootDir = outputSet.getOrCreateRootDirectory();\n        rootDir.removeField(MicrosoftTagConstants.EXIF_TAG_XPTITLE);\n        rootDir.add(MicrosoftTagConstants.EXIF_TAG_XPTITLE, &quot;new title&quot;);\n\n        rootDir.removeField(MicrosoftTagConstants.EXIF_TAG_XPSUBJECT);\n        rootDir.add(MicrosoftTagConstants.EXIF_TAG_XPSUBJECT, &quot;new subject&quot;);\n        //\n        rootDir.removeField(MicrosoftTagConstants.EXIF_TAG_XPCOMMENT);\n        rootDir.add(MicrosoftTagConstants.EXIF_TAG_XPCOMMENT, &quot;new comment&quot;);\n        //\n        rootDir.removeField(MicrosoftTagConstants.EXIF_TAG_XPKEYWORDS);\n        rootDir.add(MicrosoftTagConstants.EXIF_TAG_XPKEYWORDS, &quot;key1;key2&quot;);\n        //\n        rootDir.removeField(MicrosoftTagConstants.EXIF_TAG_RATING);\n        rootDir.add(MicrosoftTagConstants.EXIF_TAG_RATING, (short) 4);\n\n        new ExifRewriter().updateExifMetadataLossless(jpegImageFile, os,\n                outputSet);\n        return true;\n    }\n    catch(Exception e)\n    {\n        return false;\n    }\n\n}\n</code></pre>\n"}],"owner":{"account_id":7877749,"reputation":17,"user_id":5952982,"display_name":"Duke Jake Morgan"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":555,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641398680,"creation_date":1492707685,"question_id":43525655,"body_markdown":"I am trying to bulk edit over 2000 jpg photos with a title and tag. I can easily get both the ImageDescription (tag) and Title fields but I cannot find a way to insert a new title and new tags. \r\n\r\nAre there any examples on how to insert new titles and tags using the Apache Imaging Lib (or another library that is better than Apaches?\r\n\r\nHere is how I am extracting the data now:\r\n\r\n    JpegImageMetadata metadata = (JpegImageMetadata) Imaging.getMetadata(image);\r\n    TiffImageMetadata tiffMetadataItem = metadata.getExif();\r\n    TiffOutputSet tiffOutputSet = tiffMetadataItem.getOutputSet();\r\n    \r\n    if (tiffOutputSet == null) {\r\n    \ttiffOutputSet = new TiffOutputSet();\r\n    }\r\n    \r\n    TiffOutputDirectory tiffOutputDirectory = tiffOutputSet.getOrCreateExifDirectory();\r\n    \r\n    System.out.println(tiffOutputDirectory.getFields());\r\n\r\nEDIT: This is as far as I have currently gotten in terms of editing the field &#39;XPTitle&#39;\r\n\r\nhttps://gist.github.com/TheMasteredPanda/08fe51447fc6de47293bf1b34758e692","title":"Editing both jpg tag and title using Apache Imaging Library","body":"<p>I am trying to bulk edit over 2000 jpg photos with a title and tag. I can easily get both the ImageDescription (tag) and Title fields but I cannot find a way to insert a new title and new tags. </p>\n\n<p>Are there any examples on how to insert new titles and tags using the Apache Imaging Lib (or another library that is better than Apaches?</p>\n\n<p>Here is how I am extracting the data now:</p>\n\n<pre><code>JpegImageMetadata metadata = (JpegImageMetadata) Imaging.getMetadata(image);\nTiffImageMetadata tiffMetadataItem = metadata.getExif();\nTiffOutputSet tiffOutputSet = tiffMetadataItem.getOutputSet();\n\nif (tiffOutputSet == null) {\n    tiffOutputSet = new TiffOutputSet();\n}\n\nTiffOutputDirectory tiffOutputDirectory = tiffOutputSet.getOrCreateExifDirectory();\n\nSystem.out.println(tiffOutputDirectory.getFields());\n</code></pre>\n\n<p>EDIT: This is as far as I have currently gotten in terms of editing the field 'XPTitle'</p>\n\n<p><a href=\"https://gist.github.com/TheMasteredPanda/08fe51447fc6de47293bf1b34758e692\" rel=\"nofollow noreferrer\">https://gist.github.com/TheMasteredPanda/08fe51447fc6de47293bf1b34758e692</a></p>\n"},{"tags":["java","workflow","activiti","camunda","flowable"],"comments":[{"owner":{"account_id":2120498,"reputation":3230,"user_id":1883842,"display_name":"Greg Harley"},"score":1,"creation_date":1640271992,"post_id":70457998,"comment_id":124559029,"body_markdown":"What is the &quot;scenario&quot;. Meaning what is the business scenario that needs 1000 tasks created simultaneously?","body":"What is the &quot;scenario&quot;. Meaning what is the business scenario that needs 1000 tasks created simultaneously?"},{"owner":{"account_id":9725157,"reputation":2553,"user_id":7212399,"accept_rate":100,"display_name":"Pratik Ambani"},"score":0,"creation_date":1641104515,"post_id":70457998,"comment_id":124720014,"body_markdown":"@GregHarley There is a business usecase where upon certain conditions X individual tasks should get generated","body":"@GregHarley There is a business usecase where upon certain conditions X individual tasks should get generated"},{"owner":{"account_id":2120498,"reputation":3230,"user_id":1883842,"display_name":"Greg Harley"},"score":0,"creation_date":1641836869,"post_id":70457998,"comment_id":124906210,"body_markdown":"Hi Pratik, \nMy question really is. You say they service is taking too long to create these tasks. How long is too long and why do the tasks have to be created exactly at the same time?\nIn a scenario like this the problem is more usually a poorly modeled process. Often you need to think about the problem differently. Also often you can use parallel execution (although Activiti parallel execution is still serialized - you should look at Flowable as it no includes true parallel execution).","body":"Hi Pratik,  My question really is. You say they service is taking too long to create these tasks. How long is too long and why do the tasks have to be created exactly at the same time? In a scenario like this the problem is more usually a poorly modeled process. Often you need to think about the problem differently. Also often you can use parallel execution (although Activiti parallel execution is still serialized - you should look at Flowable as it no includes true parallel execution)."}],"answers":[{"tags":[],"owner":{"account_id":2449170,"reputation":1315,"user_id":2135838,"display_name":"Sascha"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641398544,"creation_date":1641398544,"answer_id":70595935,"question_id":70457998,"body_markdown":"You could use multiple Threads to create the tasks.\r\n\r\n   \tExecutorService pool = Executors.newFixedThreadPool(1000);\r\n\tfor(int i=0;i&lt;1000;i++)\r\n\t{\r\n\t\tpool.execute(()-&gt;\r\n\t\t{\r\n\t\t\tTask task = taskService.newTask();\r\n\t\t    task.setName(taskName);\r\n\t\t    task.setParentTaskId(taskParentId);\r\n\t\t    task.setDescription(taskDescription);\r\n\t\t    task.setCategory(taskCategory);\r\n\t\t    taskService.saveTask(task);\r\n\t\t});\r\n\t}\r\n","title":"Activiti: How to create multiple tasks at once","body":"<p>You could use multiple Threads to create the tasks.</p>\n<pre><code>ExecutorService pool = Executors.newFixedThreadPool(1000);\nfor(int i=0;i&lt;1000;i++)\n{\n    pool.execute(()-&gt;\n    {\n        Task task = taskService.newTask();\n        task.setName(taskName);\n        task.setParentTaskId(taskParentId);\n        task.setDescription(taskDescription);\n        task.setCategory(taskCategory);\n        taskService.saveTask(task);\n    });\n}\n</code></pre>\n"}],"owner":{"account_id":9725157,"reputation":2553,"user_id":7212399,"accept_rate":100,"display_name":"Pratik Ambani"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":350,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1641398544,"creation_date":1640237286,"question_id":70457998,"body_markdown":"I&#39;m creating task using TaskService using below snippet.\r\n\r\n        Task task = taskService.newTask();\r\n        task.setName(taskName);\r\n        task.setParentTaskId(taskParentId);\r\n        task.setDescription(taskDescription);\r\n        task.setCategory(taskCategory);\r\n        taskService.saveTask(task);\r\n\r\nI have got a requirement where I need to create multiple tasks(1000) but taskService.saveTask() is taking too much time to create these many tasks. Tried exploring the Activiti APIs but couldn&#39;t find any API related to bulk task creation. Does Activiti support bulk task creation? If not, can someone share an alternate to handle this scenario?","title":"Activiti: How to create multiple tasks at once","body":"<p>I'm creating task using TaskService using below snippet.</p>\n<pre><code>    Task task = taskService.newTask();\n    task.setName(taskName);\n    task.setParentTaskId(taskParentId);\n    task.setDescription(taskDescription);\n    task.setCategory(taskCategory);\n    taskService.saveTask(task);\n</code></pre>\n<p>I have got a requirement where I need to create multiple tasks(1000) but taskService.saveTask() is taking too much time to create these many tasks. Tried exploring the Activiti APIs but couldn't find any API related to bulk task creation. Does Activiti support bulk task creation? If not, can someone share an alternate to handle this scenario?</p>\n"},{"tags":["java","ssl","apache-zookeeper"],"comments":[{"owner":{"account_id":4874313,"reputation":819,"user_id":3929893,"display_name":"Quentin Geff"},"score":1,"creation_date":1641398879,"post_id":70595888,"comment_id":124795911,"body_markdown":"Do you have ssl enabled like follow : https://cwiki.apache.org/confluence/display/ZOOKEEPER/ZooKeeper+SSL+User+Guide\nIf yes, could it be the certificate expiration date reached ? As it&#39;s commonly defined to 1 year","body":"Do you have ssl enabled like follow : <a href=\"https://cwiki.apache.org/confluence/display/ZOOKEEPER/ZooKeeper+SSL+User+Guide\" rel=\"nofollow noreferrer\">cwiki.apache.org/confluence/display/ZOOKEEPER/&hellip;</a> If yes, could it be the certificate expiration date reached ? As it&#39;s commonly defined to 1 year"},{"owner":{"account_id":4870803,"reputation":425,"user_id":3927415,"display_name":"user3927415"},"score":0,"creation_date":1641400638,"post_id":70595888,"comment_id":124796645,"body_markdown":"our certificate expiration date is in 4 of january 2024 but the creation date of the certificate is in 4 of januery 2021. Do you think that after 1 year from the creation date the zookeeper reject the cartificate although the cartificate is still valid?","body":"our certificate expiration date is in 4 of january 2024 but the creation date of the certificate is in 4 of januery 2021. Do you think that after 1 year from the creation date the zookeeper reject the cartificate although the cartificate is still valid?"},{"owner":{"account_id":4874313,"reputation":819,"user_id":3929893,"display_name":"Quentin Geff"},"score":1,"creation_date":1641400852,"post_id":70595888,"comment_id":124796757,"body_markdown":"are you sure that the whole chains is still valid or only the CA ?","body":"are you sure that the whole chains is still valid or only the CA ?"},{"owner":{"account_id":4870803,"reputation":425,"user_id":3927415,"display_name":"user3927415"},"score":0,"creation_date":1641400986,"post_id":70595888,"comment_id":124796817,"body_markdown":"what do you mean by all the chains?","body":"what do you mean by all the chains?"},{"owner":{"account_id":4870803,"reputation":425,"user_id":3927415,"display_name":"user3927415"},"score":0,"creation_date":1641455877,"post_id":70595888,"comment_id":124810151,"body_markdown":"we fixed it by running `chmod 777` on the zookeeper folder, and now we are facing a different exception. I opened a new question if you can check it out :) https://stackoverflow.com/questions/70604009/getting-cannot-open-channel-to-2-at-election-address-x-x-x-x3888-in-zookeepe @QuentinGeff","body":"we fixed it by running <code>chmod 777</code> on the zookeeper folder, and now we are facing a different exception. I opened a new question if you can check it out :) <a href=\"https://stackoverflow.com/questions/70604009/getting-cannot-open-channel-to-2-at-election-address-x-x-x-x3888-in-zookeepe\" title=\"getting cannot open channel to 2 at election address x x x x3888 in zookeepe\">stackoverflow.com/questions/70604009/&hellip;</a> @QuentinGeff"}],"owner":{"account_id":4870803,"reputation":425,"user_id":3927415,"display_name":"user3927415"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":886,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1641398330,"creation_date":1641398330,"question_id":70595888,"body_markdown":"I have a cluster with 3 instances of zookeeper for about a year (The zookeeper version is 3.5.8). The zookeeper has worked until yesterday, and it suddenly fails, and does not start up anymore. in all 3 instances.\r\n\r\nThe exception that is raised when starting the zookeeper is:\r\n\r\n    java.lang.UnsupportedOperationException: SSL isn&#39;t supported in NIOServerCnxn\r\n      at org.apache.zookeeper.server.NIOServerCnxnFactory.configure(NIOServerCnxnFactory.java:644)\r\n      at org.apache.zookeeper.server.quorum.QuorumPeerMain.runFromConfig(QuorumPeerMain.java:155)\r\n      at org.apache.zookeeper.server.quorum.QuorumPeerMain.initializeAndRun(QuorumPeerMain.java:123)\r\n      at org.apache.zookeeper.server.quorum.QuorumPeerMain.main(QuorumPeerMain.java:82)\r\n\r\n  \r\nthis is the zookeeper config in all the 3 instances:\r\n\r\n    clientPrt=2181\r\n    syncLimit=2\r\n    autopurge.purgeInterval=1\r\n    maxClientCnxns=10\r\n    initLimit=5\r\n    dataDir=/var/lib/zookeeper/\r\n    tickTime=2000\r\n    autopurge.snapRetainCount=10\r\n    \r\n    secureClientPort=2281\r\n    \r\n    server.1=X.X.X.X:2888:3888;2181\r\n    server.2=X.X.X.X:2888:3888;2181\r\n    server.3=X.X.X.X:2888:3888;2181\r\n\r\n\r\n \r\n\r\n","title":"Getting SSL is&#39;nt supported in NIOServerCnxn in zookeeper","body":"<p>I have a cluster with 3 instances of zookeeper for about a year (The zookeeper version is 3.5.8). The zookeeper has worked until yesterday, and it suddenly fails, and does not start up anymore. in all 3 instances.</p>\n<p>The exception that is raised when starting the zookeeper is:</p>\n<pre><code>java.lang.UnsupportedOperationException: SSL isn't supported in NIOServerCnxn\n  at org.apache.zookeeper.server.NIOServerCnxnFactory.configure(NIOServerCnxnFactory.java:644)\n  at org.apache.zookeeper.server.quorum.QuorumPeerMain.runFromConfig(QuorumPeerMain.java:155)\n  at org.apache.zookeeper.server.quorum.QuorumPeerMain.initializeAndRun(QuorumPeerMain.java:123)\n  at org.apache.zookeeper.server.quorum.QuorumPeerMain.main(QuorumPeerMain.java:82)\n</code></pre>\n<p>this is the zookeeper config in all the 3 instances:</p>\n<pre><code>clientPrt=2181\nsyncLimit=2\nautopurge.purgeInterval=1\nmaxClientCnxns=10\ninitLimit=5\ndataDir=/var/lib/zookeeper/\ntickTime=2000\nautopurge.snapRetainCount=10\n\nsecureClientPort=2281\n\nserver.1=X.X.X.X:2888:3888;2181\nserver.2=X.X.X.X:2888:3888;2181\nserver.3=X.X.X.X:2888:3888;2181\n</code></pre>\n"},{"tags":["java","spring","apache-zookeeper","apache-dubbo"],"answers":[{"tags":[],"owner":{"account_id":11399033,"reputation":1,"user_id":8356490,"display_name":"goolnen"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1567585923,"creation_date":1567584500,"answer_id":57784082,"question_id":57767645,"body_markdown":"The error is because the zookeeper connection is abnormal:\r\n\r\n 1. check your registry address(ip, port)\r\n 2. check zk-client and zk-server version.\r\n","title":"Dubbo service startup error:Error creating bean with name &#39;userServiceImpl&#39; nested exception is org.I0Itec.zkclient.exception.ZkTimeoutException","body":"<p>The error is because the zookeeper connection is abnormal:</p>\n\n<ol>\n<li>check your registry address(ip, port)</li>\n<li>check zk-client and zk-server version.</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":3566245,"reputation":786,"user_id":2977686,"display_name":"0xTang"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1569738238,"creation_date":1569738238,"answer_id":58152826,"question_id":57767645,"body_markdown":"It should be the zookeeper connection problem, use below command to check:\r\n```\r\nping 192.168.25.128\r\n```\r\n\r\nIf zookeeper and dubbo service are at the same machine, you can use `localhost` or `127.0.0.1`.","title":"Dubbo service startup error:Error creating bean with name &#39;userServiceImpl&#39; nested exception is org.I0Itec.zkclient.exception.ZkTimeoutException","body":"<p>It should be the zookeeper connection problem, use below command to check:</p>\n\n<pre><code>ping 192.168.25.128\n</code></pre>\n\n<p>If zookeeper and dubbo service are at the same machine, you can use <code>localhost</code> or <code>127.0.0.1</code>.</p>\n"},{"tags":[],"owner":{"account_id":22518605,"reputation":1,"user_id":16712519,"display_name":"permanentby"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641397603,"creation_date":1641397194,"answer_id":70595637,"question_id":57767645,"body_markdown":"it may really because of the timeout&#39;s config is too short. i resolved it by set this:\r\n``` \r\n    spring:\r\n      dubbo:\r\n        application:\r\n          logger: log4j\r\n        protocol:\r\n          name: dubbo\r\n          port: 20881\r\n        registry:\r\n          timeout: 20000\r\n","title":"Dubbo service startup error:Error creating bean with name &#39;userServiceImpl&#39; nested exception is org.I0Itec.zkclient.exception.ZkTimeoutException","body":"<p>it may really because of the timeout's config is too short. i resolved it by set this:</p>\n<pre><code>    spring:\n      dubbo:\n        application:\n          logger: log4j\n        protocol:\n          name: dubbo\n          port: 20881\n        registry:\n          timeout: 20000\n</code></pre>\n"}],"owner":{"account_id":16623402,"reputation":1,"user_id":12013071,"display_name":"jkwgq"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":401,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":3,"score":0,"last_activity_date":1641397603,"creation_date":1567498579,"question_id":57767645,"body_markdown":"I configured dubbo, using the registry zookeeper, when I start the service, I get an error.\n=\n\n\n1. I modified the timeout to 10000 and the error has not changed.\n2. I turned off the firewall in the virtual machine and the error has not changed.\n3. I checked the dubbo and zookeeper and they are all running.\n\n\n```\n###This is the code I configured for the dubbo service.###\n\n&lt;dubbo:application name=&quot;pinyougou-user-service&quot; /&gt;\n&lt;dubbo:registry address=&quot;zookeeper://192.168.25.128:2181&quot; /&gt;\n&lt;dubbo:annotation package=&quot;com.pinyougou.user.service.impl&quot; /&gt;\n```\n\n```\n###This is the configuration of the service###\n\npackage com.pinyougou.user.service.impl;\nimport com.alibaba.dubbo.config.annotation.Service;\n@Service(interfaceName=&quot;com.pinyougou.user.service.UserService&quot;)\npublic class UserServiceImpl implements UserService {\n...\n}\n```\n\n```\n###Zookeeper service starts normally###\n\nJMX enabled by default\nUsing config: /root/zookeeper-3.4.6/bin/../conf/zoo.cfg\nStarting zookeeper ... STARTED\n```\n```\n###The firewall is not turned on either.###\niptables: Firewall is not running.\n```\n\n\n### Wrong content ###\n```\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;userServiceImpl&#39; defined in file [D:\\Java\\JavaCode\\pinyougou\\pinyougou-itcast\\pinyougou-parent\\pinyougou-user-service\\target\\classes\\com\\pinyougou\\user\\service\\impl\\UserServiceImpl.class]: Initialization of bean failed; nested exception is org.I0Itec.zkclient.exception.ZkTimeoutException: Unable to connect to zookeeper server within timeout: 5000\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:553)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)\n    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:446)\n    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:328)\n    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:107)\n    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4939)\n    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5434)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)\n    at java.util.concurrent.FutureTask.run(Unknown Source)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: org.I0Itec.zkclient.exception.ZkTimeoutException: Unable to connect to zookeeper server within timeout: 5000\n    at org.I0Itec.zkclient.ZkClient.connect(ZkClient.java:1223)\n    at org.I0Itec.zkclient.ZkClient.&lt;init&gt;(ZkClient.java:155)\n    at org.I0Itec.zkclient.ZkClient.&lt;init&gt;(ZkClient.java:129)\n    at org.I0Itec.zkclient.ZkClient.&lt;init&gt;(ZkClient.java:125)\n    at org.I0Itec.zkclient.ZkClient.&lt;init&gt;(ZkClient.java:92)\n    at com.alibaba.dubbo.remoting.zookeeper.zkclient.ZkclientZookeeperClient.&lt;init&gt;(ZkclientZookeeperClient.java:26)\n    at com.alibaba.dubbo.remoting.zookeeper.zkclient.ZkclientZookeeperTransporter.connect(ZkclientZookeeperTransporter.java:10)\n    at com.alibaba.dubbo.remoting.zookeeper.ZookeeperTransporter$Adpative.connect(ZookeeperTransporter$Adpative.java)\n    at com.alibaba.dubbo.registry.zookeeper.ZookeeperRegistry.&lt;init&gt;(ZookeeperRegistry.java:69)\n    at com.alibaba.dubbo.registry.zookeeper.ZookeeperRegistryFactory.createRegistry(ZookeeperRegistryFactory.java:37)\n    at com.alibaba.dubbo.registry.support.AbstractRegistryFactory.getRegistry(AbstractRegistryFactory.java:94)\n    at com.alibaba.dubbo.registry.RegistryFactory$Adpative.getRegistry(RegistryFactory$Adpative.java)\n    at com.alibaba.dubbo.registry.integration.RegistryProtocol.getRegistry(RegistryProtocol.java:190)\n    at com.alibaba.dubbo.registry.integration.RegistryProtocol.export(RegistryProtocol.java:109)\n    at com.alibaba.dubbo.rpc.protocol.ProtocolListenerWrapper.export(ProtocolListenerWrapper.java:54)\n    at com.alibaba.dubbo.rpc.protocol.ProtocolFilterWrapper.export(ProtocolFilterWrapper.java:53)\n    at com.alibaba.dubbo.rpc.Protocol$Adpative.export(Protocol$Adpative.java)\n    at com.alibaba.dubbo.config.ServiceConfig.doExportUrlsFor1Protocol(ServiceConfig.java:489)\n    at com.alibaba.dubbo.config.ServiceConfig.doExportUrls(ServiceConfig.java:285)\n    at com.alibaba.dubbo.config.ServiceConfig.doExport(ServiceConfig.java:246)\n    at com.alibaba.dubbo.config.ServiceConfig.export(ServiceConfig.java:145)\n    at com.alibaba.dubbo.config.spring.AnnotationBean.postProcessAfterInitialization(AnnotationBean.java:202)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsAfterInitialization(AbstractAutowireCapableBeanFactory.java:422)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1583)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)\n    ... 20 more\n```","title":"Dubbo service startup error:Error creating bean with name &#39;userServiceImpl&#39; nested exception is org.I0Itec.zkclient.exception.ZkTimeoutException","body":"<h1>I configured dubbo, using the registry zookeeper, when I start the service, I get an error.</h1>\n<ol>\n<li>I modified the timeout to 10000 and the error has not changed.</li>\n<li>I turned off the firewall in the virtual machine and the error has not changed.</li>\n<li>I checked the dubbo and zookeeper and they are all running.</li>\n</ol>\n<pre><code>###This is the code I configured for the dubbo service.###\n\n&lt;dubbo:application name=&quot;pinyougou-user-service&quot; /&gt;\n&lt;dubbo:registry address=&quot;zookeeper://192.168.25.128:2181&quot; /&gt;\n&lt;dubbo:annotation package=&quot;com.pinyougou.user.service.impl&quot; /&gt;\n</code></pre>\n<pre><code>###This is the configuration of the service###\n\npackage com.pinyougou.user.service.impl;\nimport com.alibaba.dubbo.config.annotation.Service;\n@Service(interfaceName=&quot;com.pinyougou.user.service.UserService&quot;)\npublic class UserServiceImpl implements UserService {\n...\n}\n</code></pre>\n<pre><code>###Zookeeper service starts normally###\n\nJMX enabled by default\nUsing config: /root/zookeeper-3.4.6/bin/../conf/zoo.cfg\nStarting zookeeper ... STARTED\n</code></pre>\n<pre><code>###The firewall is not turned on either.###\niptables: Firewall is not running.\n</code></pre>\n<h3>Wrong content</h3>\n<pre><code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userServiceImpl' defined in file [D:\\Java\\JavaCode\\pinyougou\\pinyougou-itcast\\pinyougou-parent\\pinyougou-user-service\\target\\classes\\com\\pinyougou\\user\\service\\impl\\UserServiceImpl.class]: Initialization of bean failed; nested exception is org.I0Itec.zkclient.exception.ZkTimeoutException: Unable to connect to zookeeper server within timeout: 5000\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:553)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)\n    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:446)\n    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:328)\n    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:107)\n    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4939)\n    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5434)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)\n    at java.util.concurrent.FutureTask.run(Unknown Source)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: org.I0Itec.zkclient.exception.ZkTimeoutException: Unable to connect to zookeeper server within timeout: 5000\n    at org.I0Itec.zkclient.ZkClient.connect(ZkClient.java:1223)\n    at org.I0Itec.zkclient.ZkClient.&lt;init&gt;(ZkClient.java:155)\n    at org.I0Itec.zkclient.ZkClient.&lt;init&gt;(ZkClient.java:129)\n    at org.I0Itec.zkclient.ZkClient.&lt;init&gt;(ZkClient.java:125)\n    at org.I0Itec.zkclient.ZkClient.&lt;init&gt;(ZkClient.java:92)\n    at com.alibaba.dubbo.remoting.zookeeper.zkclient.ZkclientZookeeperClient.&lt;init&gt;(ZkclientZookeeperClient.java:26)\n    at com.alibaba.dubbo.remoting.zookeeper.zkclient.ZkclientZookeeperTransporter.connect(ZkclientZookeeperTransporter.java:10)\n    at com.alibaba.dubbo.remoting.zookeeper.ZookeeperTransporter$Adpative.connect(ZookeeperTransporter$Adpative.java)\n    at com.alibaba.dubbo.registry.zookeeper.ZookeeperRegistry.&lt;init&gt;(ZookeeperRegistry.java:69)\n    at com.alibaba.dubbo.registry.zookeeper.ZookeeperRegistryFactory.createRegistry(ZookeeperRegistryFactory.java:37)\n    at com.alibaba.dubbo.registry.support.AbstractRegistryFactory.getRegistry(AbstractRegistryFactory.java:94)\n    at com.alibaba.dubbo.registry.RegistryFactory$Adpative.getRegistry(RegistryFactory$Adpative.java)\n    at com.alibaba.dubbo.registry.integration.RegistryProtocol.getRegistry(RegistryProtocol.java:190)\n    at com.alibaba.dubbo.registry.integration.RegistryProtocol.export(RegistryProtocol.java:109)\n    at com.alibaba.dubbo.rpc.protocol.ProtocolListenerWrapper.export(ProtocolListenerWrapper.java:54)\n    at com.alibaba.dubbo.rpc.protocol.ProtocolFilterWrapper.export(ProtocolFilterWrapper.java:53)\n    at com.alibaba.dubbo.rpc.Protocol$Adpative.export(Protocol$Adpative.java)\n    at com.alibaba.dubbo.config.ServiceConfig.doExportUrlsFor1Protocol(ServiceConfig.java:489)\n    at com.alibaba.dubbo.config.ServiceConfig.doExportUrls(ServiceConfig.java:285)\n    at com.alibaba.dubbo.config.ServiceConfig.doExport(ServiceConfig.java:246)\n    at com.alibaba.dubbo.config.ServiceConfig.export(ServiceConfig.java:145)\n    at com.alibaba.dubbo.config.spring.AnnotationBean.postProcessAfterInitialization(AnnotationBean.java:202)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsAfterInitialization(AbstractAutowireCapableBeanFactory.java:422)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1583)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:545)\n    ... 20 more\n</code></pre>\n"},{"tags":["java","try-catch","refactoring","pmd"],"comments":[{"owner":{"account_id":7369804,"reputation":1147,"user_id":5610358,"display_name":"rhowell"},"score":0,"creation_date":1641396532,"post_id":70595417,"comment_id":124794806,"body_markdown":"are you using apache HttpClient?","body":"are you using apache HttpClient?"},{"owner":{"account_id":22865433,"reputation":13,"user_id":17008868,"display_name":"Snopek1337"},"score":0,"creation_date":1641397904,"post_id":70595417,"comment_id":124795468,"body_markdown":"No, it it not httpClient definition of Response is my own class.","body":"No, it it not httpClient definition of Response is my own class."},{"owner":{"account_id":1663234,"reputation":138406,"user_id":1531124,"accept_rate":96,"display_name":"GhostCat"},"score":2,"creation_date":1641397911,"post_id":70595417,"comment_id":124795472,"body_markdown":"A) consider to only use `final` where it really improves your code, as in: it doesn&#39;t add any value in your catch blocks B) The answer sounds good, if that doesn&#39;t work for you ... you could put the whole thing in a `while retryCounter &gt; 0` loop. `return` when there is no exception, count down `retryCounter` in the catch block. Then you don&#39;t have any need for &quot;nested&quot; try/catch.","body":"A) consider to only use <code>final</code> where it really improves your code, as in: it doesn&#39;t add any value in your catch blocks B) The answer sounds good, if that doesn&#39;t work for you ... you could put the whole thing in a <code>while retryCounter &gt; 0</code> loop. <code>return</code> when there is no exception, count down <code>retryCounter</code> in the catch block. Then you don&#39;t have any need for &quot;nested&quot; try/catch."},{"owner":{"account_id":22865433,"reputation":13,"user_id":17008868,"display_name":"Snopek1337"},"score":0,"creation_date":1641398500,"post_id":70595417,"comment_id":124795752,"body_markdown":"Sounds reasonable, i will try it","body":"Sounds reasonable, i will try it"}],"answers":[{"tags":[],"owner":{"account_id":7369804,"reputation":1147,"user_id":5610358,"display_name":"rhowell"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641397582,"creation_date":1641397582,"answer_id":70595724,"question_id":70595417,"body_markdown":"I&#39;m assuming you are using the Apache HttpClient because I recognize the execute method. \r\n\r\nYou can use the HttpRequestRetryHandler to configure retry behavior instead of handling with that catch block.\r\n```\r\nHttpRequestRetryHandler retryHandler = new HttpRequestRetryHandler() {\r\n    @Override\r\n    public boolean retryRequest(IOException exception, int executionCount, HttpContext context) {\r\n        return executionCount &lt; 5;\r\n    }\r\n};\r\n```\r\n```\r\nHttpClient client = HttpClientBuilder.create()\r\n        .setRetryHandler(retryHandler)\r\n        .build();\r\n```\r\nAlso I should also mention, HttpClient will retry a failed request 3 times **by default** and I notice in your exceptions it says first/second attempt, in reality it is the first 4 attempts and the first 7 attempts, so you can consider how many retries you really need.","title":"Nested try/catch inside block and PMD rule","body":"<p>I'm assuming you are using the Apache HttpClient because I recognize the execute method.</p>\n<p>You can use the HttpRequestRetryHandler to configure retry behavior instead of handling with that catch block.</p>\n<pre><code>HttpRequestRetryHandler retryHandler = new HttpRequestRetryHandler() {\n    @Override\n    public boolean retryRequest(IOException exception, int executionCount, HttpContext context) {\n        return executionCount &lt; 5;\n    }\n};\n</code></pre>\n<pre><code>HttpClient client = HttpClientBuilder.create()\n        .setRetryHandler(retryHandler)\n        .build();\n</code></pre>\n<p>Also I should also mention, HttpClient will retry a failed request 3 times <strong>by default</strong> and I notice in your exceptions it says first/second attempt, in reality it is the first 4 attempts and the first 7 attempts, so you can consider how many retries you really need.</p>\n"}],"owner":{"account_id":22865433,"reputation":13,"user_id":17008868,"display_name":"Snopek1337"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":270,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641397582,"creation_date":1641396365,"question_id":70595417,"body_markdown":"I&#39;m trying to refactor this code cause PMD throwing Failure:PreserveStackTrace:3, the main problem is how I can collapse exception e1 into e2, is it anti-pattern right now?\r\nI thinking about extract second try or put it into finally but it might cause problems with bussiness logic.\r\n\r\nCode:\r\n```        Response response;\r\n        try {\r\n            try {\r\n                response = paypal.execute(params);\r\n            } catch (final FailedConnectionAttempException e1) {\r\n                log.warn(&quot;The first attempt is failed &quot; + &quot; Tryin again &quot;, e1);\r\n\r\n                try {\r\n                    response = paypal.execute(params);\r\n                } catch (final FailedConnectionAttempException e2) {\r\n                    throw new PaymentException(&quot;The second attempt failed &quot;, e2);\r\n                }\r\n            }\r\n        } catch (final IntegrationException e) {\r\n            throw new PaymentException(&quot;Unable to execute &quot;, e);\r\n        }\r\n    }\r\n","title":"Nested try/catch inside block and PMD rule","body":"<p>I'm trying to refactor this code cause PMD throwing Failure:PreserveStackTrace:3, the main problem is how I can collapse exception e1 into e2, is it anti-pattern right now?\nI thinking about extract second try or put it into finally but it might cause problems with bussiness logic.</p>\n<p>Code:</p>\n<pre><code>        try {\n            try {\n                response = paypal.execute(params);\n            } catch (final FailedConnectionAttempException e1) {\n                log.warn(&quot;The first attempt is failed &quot; + &quot; Tryin again &quot;, e1);\n\n                try {\n                    response = paypal.execute(params);\n                } catch (final FailedConnectionAttempException e2) {\n                    throw new PaymentException(&quot;The second attempt failed &quot;, e2);\n                }\n            }\n        } catch (final IntegrationException e) {\n            throw new PaymentException(&quot;Unable to execute &quot;, e);\n        }\n    }\n</code></pre>\n"},{"tags":["java","spring","spring-boot","linkageerror"],"owner":{"account_id":3356191,"reputation":25,"user_id":2819052,"display_name":"engg"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":906,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1641397498,"creation_date":1641397498,"question_id":70595708,"body_markdown":"I am using a jar as a dependency in my Gradle Java sprint boot project. Get this error \r\n\r\n    Unexpected handler method invocation error; nested exception is java.lang.LinkageError: loader org.springframework.boot.loader.LaunchedURLClassLoader @7fb9f71f attempted duplicate class definition for xxx.class. (xxx.class is in unnamed module of loader org.springframework.boot.loader.LaunchedURLClassLoader @7fb9f71f, parent loader &#39;app&#39;)\r\n\r\nthis looks like the class is being loaded twice. first on the sprint boot app start up and then again when the a method is invoked which then uses that xxx.class.\r\n\r\nThe LaunchedURLClassLoader works as a url class loader which loades classes/jar at startup i assume. why it tries to load a class again?","title":"org.springframework.boot.loader.LaunchedURLClassLoader attempted duplicate class definition for {class} is in unnamed module of loader","body":"<p>I am using a jar as a dependency in my Gradle Java sprint boot project. Get this error</p>\n<pre><code>Unexpected handler method invocation error; nested exception is java.lang.LinkageError: loader org.springframework.boot.loader.LaunchedURLClassLoader @7fb9f71f attempted duplicate class definition for xxx.class. (xxx.class is in unnamed module of loader org.springframework.boot.loader.LaunchedURLClassLoader @7fb9f71f, parent loader 'app')\n</code></pre>\n<p>this looks like the class is being loaded twice. first on the sprint boot app start up and then again when the a method is invoked which then uses that xxx.class.</p>\n<p>The LaunchedURLClassLoader works as a url class loader which loades classes/jar at startup i assume. why it tries to load a class again?</p>\n"},{"tags":["java","excel","spring","servlets","xlsx"],"answers":[{"tags":[],"owner":{"account_id":11348355,"reputation":303,"user_id":8328176,"display_name":"Souhail HARRATI"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641397305,"creation_date":1641397305,"answer_id":70595667,"question_id":70592596,"body_markdown":"You can use this solution:\r\n\r\n1- Service:\r\n```\r\n public static ByteArrayInputStream prepareData()  {\r\n            try(Workbook workbook = new XSSFWorkbook()){\r\n                Sheet sheet = workbook.createSheet(&quot;data&quot;);\r\n\r\n                Row row = sheet.createRow(0);\r\n                CellStyle headerCellStyle = workbook.createCellStyle();\r\n                headerCellStyle.setFillForegroundColor(IndexedColors.AQUA.getIndex());\r\n                headerCellStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);\r\n                // Creating header\r\n                Cell cell = row.createCell(0);\r\n                cell.setCellValue(&quot;First Name&quot;);\r\n                cell.setCellStyle(headerCellStyle);\r\n\r\n                cell = row.createCell(1);\r\n                cell.setCellValue(&quot;Last Name&quot;);\r\n                cell.setCellStyle(headerCellStyle);\r\n\r\n                cell = row.createCell(2);\r\n                cell.setCellValue(&quot;Mobile&quot;);\r\n                cell.setCellStyle(headerCellStyle);\r\n\r\n                cell = row.createCell(3);\r\n                cell.setCellValue(&quot;Email&quot;);\r\n                cell.setCellStyle(headerCellStyle);\r\n\r\n                // Creating data rows for each customer\r\n                for(int i = 0; i &lt; 8; i++) {\r\n                    Row dataRow = sheet.createRow(i + 1);\r\n                    dataRow.createCell(0).setCellValue(&quot;FirstName &quot; + i);\r\n                    dataRow.createCell(1).setCellValue(&quot;LastName &quot; + i);\r\n                    dataRow.createCell(2).setCellValue(&quot;Mobile &quot; + i);\r\n                    dataRow.createCell(3).setCellValue(&quot;Email &quot; + i);\r\n                }\r\n\r\n                // Making size of column auto resize to fit with data\r\n                sheet.autoSizeColumn(0);\r\n                sheet.autoSizeColumn(1);\r\n                sheet.autoSizeColumn(2);\r\n                sheet.autoSizeColumn(3);\r\n\r\n                ByteArrayOutputStream outputStream = new ByteArrayOutputStream();\r\n                workbook.write(outputStream);\r\n                return new ByteArrayInputStream(outputStream.toByteArray());\r\n            } catch (IOException ex) {\r\n                ex.printStackTrace();\r\n                return null;\r\n            }\r\n        }\r\n\r\n```\r\n\r\n2- Controller:\r\n\r\n```\r\n    @PostMapping(&quot;/export&quot;)\r\n    public void exportExcelFile(\r\n            HttpServletResponse response) throws IOException {\r\n        response.setContentType(&quot;application/octet-stream&quot;);\r\n        response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename=data.xlsx&quot;);\r\n        ByteArrayInputStream stream = ServiceXLS.prepareData();\r\n        IOUtils.copy(stream, response.getOutputStream());\r\n    }\r\n```","title":"Receiving corrupted response when writing xlsx file to HttpServletResponse","body":"<p>You can use this solution:</p>\n<p>1- Service:</p>\n<pre><code> public static ByteArrayInputStream prepareData()  {\n            try(Workbook workbook = new XSSFWorkbook()){\n                Sheet sheet = workbook.createSheet(&quot;data&quot;);\n\n                Row row = sheet.createRow(0);\n                CellStyle headerCellStyle = workbook.createCellStyle();\n                headerCellStyle.setFillForegroundColor(IndexedColors.AQUA.getIndex());\n                headerCellStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);\n                // Creating header\n                Cell cell = row.createCell(0);\n                cell.setCellValue(&quot;First Name&quot;);\n                cell.setCellStyle(headerCellStyle);\n\n                cell = row.createCell(1);\n                cell.setCellValue(&quot;Last Name&quot;);\n                cell.setCellStyle(headerCellStyle);\n\n                cell = row.createCell(2);\n                cell.setCellValue(&quot;Mobile&quot;);\n                cell.setCellStyle(headerCellStyle);\n\n                cell = row.createCell(3);\n                cell.setCellValue(&quot;Email&quot;);\n                cell.setCellStyle(headerCellStyle);\n\n                // Creating data rows for each customer\n                for(int i = 0; i &lt; 8; i++) {\n                    Row dataRow = sheet.createRow(i + 1);\n                    dataRow.createCell(0).setCellValue(&quot;FirstName &quot; + i);\n                    dataRow.createCell(1).setCellValue(&quot;LastName &quot; + i);\n                    dataRow.createCell(2).setCellValue(&quot;Mobile &quot; + i);\n                    dataRow.createCell(3).setCellValue(&quot;Email &quot; + i);\n                }\n\n                // Making size of column auto resize to fit with data\n                sheet.autoSizeColumn(0);\n                sheet.autoSizeColumn(1);\n                sheet.autoSizeColumn(2);\n                sheet.autoSizeColumn(3);\n\n                ByteArrayOutputStream outputStream = new ByteArrayOutputStream();\n                workbook.write(outputStream);\n                return new ByteArrayInputStream(outputStream.toByteArray());\n            } catch (IOException ex) {\n                ex.printStackTrace();\n                return null;\n            }\n        }\n\n</code></pre>\n<p>2- Controller:</p>\n<pre><code>    @PostMapping(&quot;/export&quot;)\n    public void exportExcelFile(\n            HttpServletResponse response) throws IOException {\n        response.setContentType(&quot;application/octet-stream&quot;);\n        response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename=data.xlsx&quot;);\n        ByteArrayInputStream stream = ServiceXLS.prepareData();\n        IOUtils.copy(stream, response.getOutputStream());\n    }\n</code></pre>\n"}],"owner":{"account_id":16600034,"reputation":15,"user_id":11995975,"display_name":"Mykhailo Bormashenko"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":520,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641397305,"creation_date":1641384386,"question_id":70592596,"body_markdown":"I have a Spring controller that should return xlsx file: \r\n&lt;!-- language: java --&gt;\r\n\r\n    @PostMapping(&quot;/export&quot;)\r\n    public void exportExcelFile(\r\n            HttpServletResponse response) {\r\n           myService.exportExcel(response);\r\n    }\r\n\r\n(using Post as I also need some data in request body to generate the file - I guess it is not related to the question).\r\n\r\nHere is how I create file (using Apache POI 4.1.0) and write it to response: \r\n&lt;!-- language: java --&gt;\r\n\r\n    public void exportExcel(HttpServletResponse response) throws IOException {\r\n        response.setContentType(&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;);\r\n        response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename=test.xlsx&quot;);\r\n\r\n        Workbook workbook = new XSSFWorkbook();\r\n        Sheet sheet = workbook.createSheet(&quot;My Sheet&quot;);\r\n        Row row = sheet.createRow(0);\r\n        Cell cell = row.createCell(0);\r\n        cell.setCellValue(&quot;abc&quot;);\r\n\r\n        OutputStream outputStream = response.getOutputStream();\r\n        workbook.write(outputStream);\r\n        outputStream.flush();\r\n        workbook.close();\r\n    }\r\n\r\nHowever as a response body I&#39;m receiving smth weird:\r\n\r\n        PK\u0003\u0004\u0014\b\b\bl%T\u0013[Content_Types].xmlSn0\u0010*6PU\u0015C\u001F\u0016\u0003\\{X%]\u00078R\r\n    qcfgfWdqZCB\u0013||**h},^{Va^K\u001B\r\n    &lt;4\u00076N\u0016\bXQ9\u0007!P$\u0010\u0013dcDj);\u0010PgEM&#39;OH7LhRG^&#39;\u0003\u0007{\u0013\bz\u001BB3\u001C\u000Bh.hWF\u000EjCQ}LU:\u0012\u0014D\u0013%,B[\t\u001E ;\t{N~Xp\u001CykOL\u0004\u0018kNVBZ~q\u0018\u000F a\u0019\u001Fr{O\u0001PK\u0007\bzq;\u0001\u001C\u0004PK\u0003\u0004\u0014\b\b\bl%T\u000B_rels/.relsj0\f_8`Q2m\u00014[ILb.[K\r\n    \u001B($}\u0007v?IQ.uh\u001Bx&gt;=@\u0015pH\u0006&quot;~}\tn*&quot;\u0016\u0003H\u0002\u00138\u0007Z^&#39;#7m{O\u00063\u0019G\u0006u\u0018&#39;y|a\u001ED\t\u000El_\u0003EYvql\u001F3MLeh\u0016*\u0004\\3Y0oJ\u0003\t:\u0014^\b\u001F}\u0002PK\u0007\bzI\u0002PK\u0003\u0004\u0014\b\b\bl%T\u0010docProps/app.xmlM\r\n    0\u0010D~EAD\bA? 6lBJ?0)@\u0014H6V&gt;\u001F$;SC\r\n    \u0011\u0013;\u001C(ragl\u0017&amp;eL!y%\u001949`_\u001E4GF\u001C\u0005J\u0018Wg\r\n    \u0017\u0007GSb\u0014\r\n    ~\u000E\u0003PK\u0007\b|wPK\u0003\u0004\u0014\b\b\bl%T\u0011docProps/core.xmlmJ0\u0014E=I\u0017BA\u0001Aq\u0011\u001Cbs!v{:VPu\u0016&#39;\u001C\u000F5\r\n    a\u0005%\u0019\u001Ai`&lt;9B\u0014F\u001Aldqi=u!K\u001A\u0013t\r\n    ct\u001C \u001E\bE&quot;L\r\n    _&quot;\t*:S\u0018\u0012Q,j$Gq\u0011(\t8F\u0013\u0003\u000F\u001B!\f+5MS1U\u000B6bt{s,\u000FfDG5\u001EED%\u0001\u001F.5\r\n        &lt;VW-iKZ9e9=33^\u001A~&#175;E*lww=ss\r\n    jn?\u0001PK\u0007\bm\u0005\u0001\u0001PK\u0003\u0004\u0014\b\b\bl%T\u0014xl/sharedStrings.xml=1\u000E0\f\u0005SD\u000B\u0003B(M\u0007$N\u0007\bi#5N\u001B\u0013\u0016?i6o*\u00123wphZ0!\u000F\u000E\u001E\fY\u00115!o\u0003fntnt0.\u0017D\t\u0013%/M^k%y,#R\u000F2\u0011i&#39;L&gt;28+Yu\u0019,#S\u0005PK\u0007\b?1\u001FPK\u0003\u0004\u0014\b\b\bl%T\r\n    xl/styles.xmln \u0010&gt;\u0005bop2TQP)URWb6*\u001C\u0016\u0017SNws3\u000B\u001Dt(\u0001lx!N\u0006\u000E=@$}3cr\u0003`:i2w,\f\u001E\r\n    d\r\n    T\u0013R#\u0015\u001Cvoc ;ciE&#219;E\u0010&lt;|4I\u0019F\u0005#nBzFyj3\u0015yyjt&gt;2L!6\b\u000F2FO\u0005Y4@M!\u0014G1typ&quot;\tnu\u0018aDi9&amp;#%I\u00069}cK\u000ET$?`J7ofM|\u0003PK\u0007\b1X@C\u0001\u0002PK\u0003\u0004\u0014\b\b\bl%T\u000Fxl/workbook.xmlN0\f\r\n            &lt;E;K\r\n    \bAtMH!4gFk\t\u001BO?\u001C\u0005\r\n    Ju}r\u0004\u0010\u000ED&#39;Q4\f9Z\r\n    MZQP6=7D&gt;\u0014\u0019M\u0003bSQz\u0002\\\r\n    5A}:R1q4M\tf,X=\u0007\r\n    \u0019\u0013li~)\r\n    ew9hP\u0013&#39;se`\r\n                &lt;j\u000B\r\n    #q\u0006\u001AxgAj,r~\u0003PK\u0007\b9pb\u0001PK\u0003\u0004\u0014\b\b\bl%T\u001Axl/_rels/workbook.xml.relsMk0\f@}q\u0018n/cc+qh&quot;\u0019K@\u0007;${\u000F~y&quot;#i \u0005#\r\n    \u000E^O7`D=E?1\u0003bn8y?$YLE8HZ\t\tg/\r\n    g^\f6p\u0003Ur%\u001D/\u0003\u0003I`|R:f~\fmF\u000Bv\u001C:p9HBSy\u001DK~\u0004\u0018\u000BPK\u0007\b\u0003;3\u0002PK\u0003\u0004\u0014\b\b\bl%T\u0018xl/worksheets/sheet1.xmleP]K@\u0010|W\u001Cn.U&quot;I E\u001F\u0004lm\b&gt;,3\u0016o?\u0003Pt\u0018Jr 4c{y7E1#J!z`\f&#39;\bre8\u0011v\u0011\\\u0005]\u0015\u0010&quot;J*\u00169U\u0011w\t&lt;xlw\u0018a\u00106%+\u0016:\u001F\r\n    &#39;pr-5OmU\u0010&quot;H&amp;%(P9E##Q8\u001E^,.DU#3z\t\u0010\u0019(k\u0006y\u0019qBW?PK\u0007\b\f\u0001\u0001PK\u0001\u0002\u0014\u0014\b\b\bl%Tzq;\u0001\u001C\u0004\u0013[Content_Types].xmlPK\u0001\u0002\u0014\u0014\b\b\bl%TzI\u0002\u000B|\u0001_rels/.relsPK\u0001\u0002\u0014\u0014\b\b\bl%T|w\u0010\u0002docProps/app.xmlPK\u0001\u0002\u0014\u0014\b\b\bl%Tm\u0005\u0001\u0001\u0011g\u0003docProps/core.xmlPK\u0001\u0002\u0014\u0014\b\b\bl%T?1\u001F\u0014\u0004xl/sharedStrings.xmlPK\u0001\u0002\u0014\u0014\b\b\bl%T1X@C\u0001\u0002\r\n    u\u0005xl/styles.xmlPK\u0001\u0002\u0014\u0014\b\b\bl%T9pb\u0001\u000F\u0006xl/workbook.xmlPK\u0001\u0002\u0014\u0014\b\b\bl%T\u0003;3\u0002\u001A\r\n    \bxl/_rels/workbook.xml.relsPK\u0001\u0002\u0014\u0014\b\b\bl%T\f\u0001\u0001\u0018)\txl/worksheets/sheet1.xmlPK\u0005\u0006\t\t?\u0002{\r\n\r\n    \r\nThe question is how to receive a non-corrupted response? As I checked, if I write the workbook into file (e.g. \r\n&lt;!-- language: java --&gt;\r\n\r\n    File file = new File(&quot;test.xlsx&quot;);\r\n    workbook.write(new FileOutputStream(file));\r\n    workbook.close();\r\n\r\n), the file looks well. However if I copy the content of the file to response:\r\n\r\n&lt;!-- language: java --&gt;\r\n\r\n    IOUtils.copy(new FileInputStream(file), response.getOutputStream());\r\n    response.flushBuffer();\r\n\r\nI receive the same corrupted response. Any ideas?","title":"Receiving corrupted response when writing xlsx file to HttpServletResponse","body":"<p>I have a Spring controller that should return xlsx file:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@PostMapping(&quot;/export&quot;)\npublic void exportExcelFile(\n        HttpServletResponse response) {\n       myService.exportExcel(response);\n}\n</code></pre>\n<p>(using Post as I also need some data in request body to generate the file - I guess it is not related to the question).</p>\n<p>Here is how I create file (using Apache POI 4.1.0) and write it to response:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public void exportExcel(HttpServletResponse response) throws IOException {\n    response.setContentType(&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;);\n    response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename=test.xlsx&quot;);\n\n    Workbook workbook = new XSSFWorkbook();\n    Sheet sheet = workbook.createSheet(&quot;My Sheet&quot;);\n    Row row = sheet.createRow(0);\n    Cell cell = row.createCell(0);\n    cell.setCellValue(&quot;abc&quot;);\n\n    OutputStream outputStream = response.getOutputStream();\n    workbook.write(outputStream);\n    outputStream.flush();\n    workbook.close();\n}\n</code></pre>\n<p>However as a response body I'm receiving smth weird:</p>\n<pre><code>    PKl%T\u0013[Content_Types].xmlSn0\u0010*6PUC\\{X%]8R\nqcfgfWdqZCB\u0013||**h},^{Va^K\n&lt;46NXQ9!P$\u0010\u0013dcDj);\u0010PgEM'OH7LhRG^'{\u0013zB3\u000Bh.hWF\u000EjCQ}LU:D\u0013%,B[  ; {N~XpykOLkNVBZ~q\u000F ar{OPKzq;PKl%T\u000B_rels/.relsj0\f_8`Q2m4[ILb.[K\n($}v?IQ.uhx&gt;=@pH&quot;~}   n*&quot;H\u00138Z^'#7m{O3Gu'y|aD    \u000El_EYvql3MLeh*\\3Y0oJ  :^}PKzIPKl%T\u0010docProps/app.xmlM\n0\u0010D~EADA? 6lBJ?0)@H6V&gt;$;SC\n\u0013;(ragl&amp;eL!y%49`_4GFJWg\nGSb\n~\u000EPK|wPKl%TdocProps/core.xmlmJ0E=IBAAqbs!v{:VPu'\u000F5\na%i`&lt;9BFldqi=u!K\u0013t\nct E&quot;L\n_&quot;    *:SQ,j$Gq( 8F\u0013\u000F!\f+5MS1U\u000B6bt{s,\u000FfDG5ED%.5\n    &lt;VW-iKZ9e9=33^~E*lww=ss\njn?PKmPKl%Txl/sharedStrings.xml=1\u000E0\fSD\u000BB(M$Ni#5N\u0013?i6o*3wphZ0!\u000F\u000E\fY5!ofntnt0.D \u0013%/M^k%y,#R\u000F2i'L&gt;28+Yu,#SPK?1PKl%T\nxl/styles.xmln \u0010&gt;bop2TQP)URWb6*SNws3\u000Bt(lx!N\u000E=@$}3cr`:i2w,\f\nd\nT\u0013R#voc ;ciEE\u0010&lt;|4IF#nBzFyj3yyjt&gt;2L!6\u000F2FOY4@M!G1typ&quot; nuaDi9&amp;#%I9}cK\u000ET$?`J7ofM|PK1X@CPKl%T\u000Fxl/workbook.xmlN0\f\n        &lt;E;K\nAtMH!4gFk  O?\nJu}r\u0010\u000ED'Q4\f9Z\nMZQP6=7D&gt;MbSQz\\\n5A}:R1q4M    f,X=\n\u0013li~)\new9hP\u0013'se`\n            &lt;j\u000B\n#qxgAj,r~PK9pbPKl%Txl/_rels/workbook.xml.relsMk0\f@}qn/cc+qh&quot;K@;${\u000F~y&quot;#i #\n\u000E^O7`D=E?1bn8y?$YLE8HZ     g/\ng^\f6pUr%/I`|R:f~\fmF\u000Bv:p9HBSyK~\u000BPK;3PKl%Txl/worksheets/sheet1.xmleP]K@\u0010|Wn.U&quot;I Elm&gt;,3o?PtJr 4c{y7E1#J!z`\f're8v\\]\u0010&quot;J*9Uw &lt;xlwa\u00106%+:\n'pr-5OmU\u0010&quot;H&amp;%(P9E##Q8^,.DU#3z   \u0010(kyqBW?PK\fPKl%Tzq;\u0013[Content_Types].xmlPKl%TzI\u000B|_rels/.relsPKl%T|w\u0010docProps/app.xmlPKl%TmgdocProps/core.xmlPKl%T?1xl/sharedStrings.xmlPKl%T1X@C\nuxl/styles.xmlPKl%T9pb\u000Fxl/workbook.xmlPKl%T;3\nxl/_rels/workbook.xml.relsPKl%T\f)    xl/worksheets/sheet1.xmlPK        ?{\n</code></pre>\n<p>The question is how to receive a non-corrupted response? As I checked, if I write the workbook into file (e.g.</p>\n<pre class=\"lang-java prettyprint-override\"><code>File file = new File(&quot;test.xlsx&quot;);\nworkbook.write(new FileOutputStream(file));\nworkbook.close();\n</code></pre>\n<p>), the file looks well. However if I copy the content of the file to response:</p>\n<pre class=\"lang-java prettyprint-override\"><code>IOUtils.copy(new FileInputStream(file), response.getOutputStream());\nresponse.flushBuffer();\n</code></pre>\n<p>I receive the same corrupted response. Any ideas?</p>\n"},{"tags":["java","jsp","servlets","jakarta-ee"],"answers":[{"tags":[],"owner":{"account_id":18025193,"reputation":55,"user_id":13101375,"display_name":"Nikolay Grigoryev"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641397035,"creation_date":1641397035,"answer_id":70595580,"question_id":70585359,"body_markdown":"You need to put a slash before the WEB-INF ```request.getRequestDispatcher(&quot;/WEB-INF/sample.jsp&quot;```\r\n\r\n\r\n Strange, if the pattern is like ```urlPatterns = {&quot;/sample&quot;}``` it works without a slash ```request.getRequestDispatcher(&quot;WEB-INF/sample.jsp&quot;```","title":"jakarta.servlet.ServletException: Exceeded maximum depth for nested request dispatches: 20","body":"<p>You need to put a slash before the WEB-INF <code>request.getRequestDispatcher(&quot;/WEB-INF/sample.jsp&quot;</code></p>\n<p>Strange, if the pattern is like <code>urlPatterns = {&quot;/sample&quot;}</code> it works without a slash <code>request.getRequestDispatcher(&quot;WEB-INF/sample.jsp&quot;</code></p>\n"}],"owner":{"account_id":18025193,"reputation":55,"user_id":13101375,"display_name":"Nikolay Grigoryev"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":203,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641397035,"creation_date":1641332242,"question_id":70585359,"body_markdown":"My application uses Servlet 5.0 and JSP. Everything was fine as long as I used the url template ```urlPatterns = {&quot;/sample&quot;}``` (without (*)) and was catching this url ```/sample?col=20```\r\n\r\nbut when i changed it ```urlPatterns = {&quot;/sample/*&quot;}``` and changed the url ```/sample/Tom-Sawyer?col=20```\r\nI get exception &quot;Exceeded maximum depth for nested request dispatches: 20&quot;\r\n\r\nMy Servlet\r\n\r\n```\r\n@WebServlet(name = &quot;Sample&quot;,  urlPatterns = {&quot;/sample/*&quot;})\r\npublic class SampleController extends HttpServlet {\r\n   @Override\r\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\r\n\r\n        long col =Integer.parseInt(request.getParameter(&quot;col&quot;));\r\n\r\n    ... some Business logic ...\r\n\r\n       RequestDispatcher requestDispatcher = request.getRequestDispatcher(&quot;WEB-INF/sample.jsp&quot;);\r\n        requestDispatcher.forward(request, response);\r\n    }\r\n}\r\n```\r\n\r\nPossible conflict with my filter\r\n\r\n```\r\n\r\n@WebFilter(filterName = &quot;EndsWith&quot;, urlPatterns = {&quot;/*&quot;})\r\npublic class TypeFilter implements Filter {\r\n\r\n    @Override\r\n    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws ServletException, IOException {\r\n\r\n        HttpServletRequest request = (HttpServletRequest) req;\r\n        HttpServletResponse response = (HttpServletResponse) res;\r\n\r\n        if (request.getRequestURI().endsWith(&quot;/book&quot;)) {\r\n            request.getRequestDispatcher(&quot;/book&quot;).forward(request, response);\r\n        }\r\n        else {\r\n            chain.doFilter(request, response);\r\n        }\r\n    }\r\n}\r\n```","title":"jakarta.servlet.ServletException: Exceeded maximum depth for nested request dispatches: 20","body":"<p>My application uses Servlet 5.0 and JSP. Everything was fine as long as I used the url template <code>urlPatterns = {&quot;/sample&quot;}</code> (without (*)) and was catching this url <code>/sample?col=20</code></p>\n<p>but when i changed it <code>urlPatterns = {&quot;/sample/*&quot;}</code> and changed the url <code>/sample/Tom-Sawyer?col=20</code>\nI get exception &quot;Exceeded maximum depth for nested request dispatches: 20&quot;</p>\n<p>My Servlet</p>\n<pre><code>@WebServlet(name = &quot;Sample&quot;,  urlPatterns = {&quot;/sample/*&quot;})\npublic class SampleController extends HttpServlet {\n   @Override\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n\n        long col =Integer.parseInt(request.getParameter(&quot;col&quot;));\n\n    ... some Business logic ...\n\n       RequestDispatcher requestDispatcher = request.getRequestDispatcher(&quot;WEB-INF/sample.jsp&quot;);\n        requestDispatcher.forward(request, response);\n    }\n}\n</code></pre>\n<p>Possible conflict with my filter</p>\n<pre><code>\n@WebFilter(filterName = &quot;EndsWith&quot;, urlPatterns = {&quot;/*&quot;})\npublic class TypeFilter implements Filter {\n\n    @Override\n    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws ServletException, IOException {\n\n        HttpServletRequest request = (HttpServletRequest) req;\n        HttpServletResponse response = (HttpServletResponse) res;\n\n        if (request.getRequestURI().endsWith(&quot;/book&quot;)) {\n            request.getRequestDispatcher(&quot;/book&quot;).forward(request, response);\n        }\n        else {\n            chain.doFilter(request, response);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["java","android","firebase","firebase-realtime-database"],"comments":[{"owner":{"account_id":6819231,"reputation":132841,"user_id":5246885,"accept_rate":78,"display_name":"Alex Mamo"},"score":1,"creation_date":1641379331,"post_id":70591343,"comment_id":124787636,"body_markdown":"Please edit your question and add your database structure as a JSON file. You can simply get it by clicking the Export JSON in the overflow menu () in your [Firebase Console](https://console.firebase.google.com/u/0/project/_/database/data).","body":"Please edit your question and add your database structure as a JSON file. You can simply get it by clicking the Export JSON in the overflow menu () in your <a href=\"https://console.firebase.google.com/u/0/project/_/database/data\" rel=\"nofollow noreferrer\">Firebase Console</a>."},{"owner":{"account_id":16492194,"reputation":125,"user_id":11915666,"display_name":"Vivek M Fauzdar"},"score":0,"creation_date":1641379916,"post_id":70591343,"comment_id":124787909,"body_markdown":"Sir I m doing that but it is saying &quot;It looks like your post is mostly code; please add some more details.&quot;  while I have remove unnecessary code","body":"Sir I m doing that but it is saying &quot;It looks like your post is mostly code; please add some more details.&quot;  while I have remove unnecessary code"},{"owner":{"account_id":6819231,"reputation":132841,"user_id":5246885,"accept_rate":78,"display_name":"Alex Mamo"},"score":0,"creation_date":1641380300,"post_id":70591343,"comment_id":124788058,"body_markdown":"Then try to add some explications to that code.","body":"Then try to add some explications to that code."},{"owner":{"account_id":16492194,"reputation":125,"user_id":11915666,"display_name":"Vivek M Fauzdar"},"score":0,"creation_date":1641381515,"post_id":70591343,"comment_id":124788543,"body_markdown":"Pleasee Check Sir","body":"Pleasee Check Sir"},{"owner":{"account_id":6819231,"reputation":132841,"user_id":5246885,"accept_rate":78,"display_name":"Alex Mamo"},"score":0,"creation_date":1641385236,"post_id":70591343,"comment_id":124789918,"body_markdown":"Please also add the content of your `Message` class.","body":"Please also add the content of your <code>Message</code> class."},{"owner":{"account_id":16492194,"reputation":125,"user_id":11915666,"display_name":"Vivek M Fauzdar"},"score":0,"creation_date":1641386165,"post_id":70591343,"comment_id":124790267,"body_markdown":"Done Sir Please Check","body":"Done Sir Please Check"},{"owner":{"account_id":6819231,"reputation":132841,"user_id":5246885,"accept_rate":78,"display_name":"Alex Mamo"},"score":0,"creation_date":1641389035,"post_id":70591343,"comment_id":124791393,"body_markdown":"At which particular line of code are you getting the error?","body":"At which particular line of code are you getting the error?"}],"answers":[{"tags":[],"owner":{"account_id":72426,"reputation":573714,"user_id":209103,"accept_rate":73,"display_name":"Frank van Puffelen"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1641396805,"creation_date":1641396805,"answer_id":70595524,"question_id":70591343,"body_markdown":"The problem is in the second room in the JSON you shared:\r\n```\r\n&quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L27JyFKNV0k6e4cwM8zNOb1coANfg1&quot; : {\r\n  &quot;messages&quot; : {\r\n    &quot;-MsW6Lem6hq_hxZjeOQA&quot; : {\r\n      &quot;feeling&quot; : 0,\r\n      &quot;message&quot; : &quot;helloo&quot;,\r\n      &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\r\n      &quot;timeStamp&quot; : 1641233081867\r\n    },\r\n    &quot;feeling&quot; : 0,\r\n    &quot;message&quot; : &quot;hi&quot;,\r\n    &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\r\n    &quot;timeStamp&quot; : 1641231670227\r\n  }\r\n},\r\n```\r\n\r\nHere you first have a message with key `-MsW6Lem6hq_hxZjeOQA` that looks fine, but then you have the properties of another message right under the `messages` node, so without a parent key. \r\n\r\nSo in your `onDataChange` when you loop over the results with `DataSnapshot snapshot1: snapshot.getChildren()`, you first get the `-MsW6Lem6hq_hxZjeOQA` node and that goes fine. But next `snapshot1` becomes `&quot;feeling&quot; : 0` and when you then call `snapshot1.getValue(Message.class)` that throws the error.\r\n\r\nThe solution is ensure your message properties are always stored under a push key. I recommend enforcing that in [security rules](https://firebase.google.com/docs/database/security/rules-conditions#validaterules).","title":"com.google.firebase.database.DatabaseException: Can&#39;t convert object of type java.lang.Long to type com.example.whatsappback.Models.Message","body":"<p>The problem is in the second room in the JSON you shared:</p>\n<pre><code>&quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L27JyFKNV0k6e4cwM8zNOb1coANfg1&quot; : {\n  &quot;messages&quot; : {\n    &quot;-MsW6Lem6hq_hxZjeOQA&quot; : {\n      &quot;feeling&quot; : 0,\n      &quot;message&quot; : &quot;helloo&quot;,\n      &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\n      &quot;timeStamp&quot; : 1641233081867\n    },\n    &quot;feeling&quot; : 0,\n    &quot;message&quot; : &quot;hi&quot;,\n    &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\n    &quot;timeStamp&quot; : 1641231670227\n  }\n},\n</code></pre>\n<p>Here you first have a message with key <code>-MsW6Lem6hq_hxZjeOQA</code> that looks fine, but then you have the properties of another message right under the <code>messages</code> node, so without a parent key.</p>\n<p>So in your <code>onDataChange</code> when you loop over the results with <code>DataSnapshot snapshot1: snapshot.getChildren()</code>, you first get the <code>-MsW6Lem6hq_hxZjeOQA</code> node and that goes fine. But next <code>snapshot1</code> becomes <code>&quot;feeling&quot; : 0</code> and when you then call <code>snapshot1.getValue(Message.class)</code> that throws the error.</p>\n<p>The solution is ensure your message properties are always stored under a push key. I recommend enforcing that in <a href=\"https://firebase.google.com/docs/database/security/rules-conditions#validaterules\" rel=\"nofollow noreferrer\">security rules</a>.</p>\n"}],"owner":{"account_id":16492194,"reputation":125,"user_id":11915666,"display_name":"Vivek M Fauzdar"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1057,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":70595524,"answer_count":1,"score":1,"last_activity_date":1641396805,"creation_date":1641378518,"question_id":70591343,"body_markdown":"I am getting this Error, **App is crashing every time when I try to send messages**\r\n\r\n&gt; com.google.firebase.database.DatabaseException: Can&#39;t convert object of type java.lang.Long to type com.example.whatsappback.Models.Message\r\n&gt;\r\n&gt;\r\n&gt;at com.example.whatsappback.Activities.ChatActivity$1.onDataChange(ChatActivity.java:63)\r\n\r\nWhich is:\r\n``` \r\nMessage message = snapshot1.getValue(Message.class);\r\n```\r\n\r\n**This is My ChatActivity**\r\nHere I am getting the Error \r\n\r\n    public class ChatActivity extends AppCompatActivity {\r\n\r\n    ActivityChatBinding binding;\r\n    MessagesAdapter adapter;\r\n    ArrayList&lt;Message&gt;messages;\r\n    FirebaseDatabase database;\r\n\r\n    String senderRoom, receiverRoom;\r\n\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n\r\n        binding = ActivityChatBinding.inflate(getLayoutInflater());\r\n        setContentView(binding.getRoot());\r\n\r\n        messages = new ArrayList&lt;&gt;();\r\n        adapter = new MessagesAdapter(this, messages);\r\n\r\n        binding.recyclerView.setLayoutManager(new LinearLayoutManager(this));\r\n        binding.recyclerView.setAdapter(adapter);\r\n\r\n        String name = getIntent().getStringExtra(&quot;name&quot;);\r\n        String receiverUid = getIntent().getStringExtra(&quot;uid&quot;);\r\n        String senderUid = FirebaseAuth.getInstance().getUid();\r\n\r\n\r\n        senderRoom = senderUid+receiverUid;\r\n        receiverRoom = receiverUid+senderUid;\r\n\r\n        database = FirebaseDatabase.getInstance();\r\n\r\n\r\n        database.getReference().child(&quot;chats&quot;)\r\n                .child(senderRoom)\r\n                .child(&quot;messages&quot;)\r\n                .addValueEventListener(new ValueEventListener() {\r\n                    @Override\r\n                    public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                    messages.clear();\r\n                    for (DataSnapshot snapshot1: snapshot.getChildren())\r\n                    {\r\n                        Message message = snapshot1.getValue(Message.class);\r\n                        messages.add(message);\r\n\r\n                    }\r\n                    adapter.notifyDataSetChanged();\r\n                    }\r\n\r\n                    @Override\r\n                    public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n                    }\r\n                });\r\n\r\n\r\n        binding.sendBtn.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                String messageTxt = binding.messageBox.getText().toString();\r\n                Date date = new Date();\r\n                Message message = new Message(messageTxt, senderUid, date.getTime());\r\n                binding.messageBox.setText(&quot;&quot;);\r\n\r\n\r\n                database.getReference().child(&quot;chats&quot;)\r\n                        .child(senderRoom)\r\n                        .child(&quot;messages&quot;)\r\n                        .push()\r\n                        .setValue(message).addOnSuccessListener(new OnSuccessListener&lt;Void&gt;() {\r\n                    @Override\r\n                    public void onSuccess(Void unused) {\r\n                        database.getReference().child(&quot;chats&quot;)\r\n                                .child(receiverRoom)\r\n                                .child(&quot;messages&quot;)\r\n                                .push()\r\n                                .setValue(message).addOnSuccessListener(new OnSuccessListener&lt;Void&gt;() {\r\n                            @Override\r\n                            public void onSuccess(Void unused) {\r\n\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n\r\n            }\r\n        });\r\n   \r\n\r\n    }\r\n\r\n    @Override\r\n    public boolean onSupportNavigateUp() {\r\n        finish();\r\n        return super.onSupportNavigateUp();\r\n    }}\r\n\r\n\r\n**This is The Model Class Message.java**\r\n\r\n    public class Message {\r\n\r\n    private String messageId, message, senderId;\r\n    private long timeStamp;\r\n    private int feeling;\r\n\r\n    public Message() {\r\n    }\r\n\r\n    public Message(String message, String senderId, long timeStamp) {\r\n        this.message = message;\r\n        this.senderId = senderId;\r\n        this.timeStamp = timeStamp;\r\n    }\r\n\r\n    public String getMessageId() {\r\n        return messageId;\r\n    }\r\n\r\n    public void setMessageId(String messageId) {\r\n        this.messageId = messageId;\r\n    }\r\n\r\n    public String getMessage() {\r\n        return message;\r\n    }\r\n\r\n    public void setMessage(String message) {\r\n        this.message = message;\r\n    }\r\n\r\n    public String getSenderId() {\r\n        return senderId;\r\n    }\r\n\r\n    public void setSenderId(String senderId) {\r\n        this.senderId = senderId;\r\n    }\r\n\r\n    public long getTimeStamp() {\r\n        return timeStamp;\r\n    }\r\n\r\n    public void setTimeStamp(long timeStamp) {\r\n        this.timeStamp = timeStamp;\r\n    }\r\n\r\n    public int getFeeling() {\r\n        return feeling;\r\n    }\r\n\r\n    public void setFeeling(int feeling) {\r\n        this.feeling = feeling;\r\n    }\r\n}\r\n\r\n\r\n**My JSON FILE** where I the first one is Chats Database and Second One is Users who login in the App\r\n\r\n    {&quot;chats&quot; : {\r\n    &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L23GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot; : {\r\n      &quot;messages&quot; : {\r\n        &quot;-MsW3CCOLw1CRDYWahl4&quot; : {\r\n          &quot;feeling&quot; : 0,\r\n          &quot;message&quot; : &quot;hi&quot;,\r\n          &quot;senderId&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;,\r\n          &quot;timeStamp&quot; : 1641232243332\r\n        },\r\n        &quot;-MsYWOVMOe17EMptWwlS&quot; : {\r\n          &quot;feeling&quot; : 0,\r\n          &quot;message&quot; : &quot;hhhhh&quot;,\r\n          &quot;senderId&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;\r\n        }}},\r\n    &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L27JyFKNV0k6e4cwM8zNOb1coANfg1&quot; : {\r\n      &quot;messages&quot; : {\r\n        &quot;-MsW6Lem6hq_hxZjeOQA&quot; : {\r\n          &quot;feeling&quot; : 0,\r\n          &quot;message&quot; : &quot;helloo&quot;,\r\n          &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\r\n          &quot;timeStamp&quot; : 1641233081867\r\n        },\r\n        &quot;feeling&quot; : 0,\r\n        &quot;message&quot; : &quot;hi&quot;,\r\n        &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\r\n        &quot;timeStamp&quot; : 1641231670227\r\n      }\r\n    },\r\n    &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2AYha5pt6tGgzPa0e4WJLr8wSakk2&quot; : {\r\n      &quot;messages&quot; : {\r\n        &quot;-MsYtwRyavktJc8hwonR&quot; : {\r\n          &quot;feeling&quot; : 0,\r\n          &quot;message&quot; : &quot;&quot;,\r\n          &quot;senderId&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;\r\n        },\r\n        &quot;-MsYtwwvlBe0Ocdvlggu&quot; : {\r\n          &quot;feeling&quot; : 0,\r\n          &quot;message&quot; : &quot;&quot;,\r\n          &quot;senderId&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;\r\n        },\r\n      }\r\n    },\r\n    &quot;7JyFKNV0k6e4cwM8zNOb1coANfg13GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot; : {\r\n      &quot;messages&quot; : {\r\n        &quot;-MsW6L_AmpIryN0DBjyt&quot; : {\r\n          &quot;feeling&quot; : 0,\r\n          &quot;message&quot; : &quot;helloo&quot;,\r\n          &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\r\n          &quot;timeStamp&quot; : 1641233081867\r\n        },\r\n        &quot;-MsW8eU0KN4Ge8bC1ktq&quot; : {\r\n          &quot;feeling&quot; : 0,\r\n          &quot;message&quot; : &quot;hi&quot;,\r\n          &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\r\n          &quot;timeStamp&quot; : 1641233687661\r\n        },\r\n        &quot;feeling&quot; : 0,\r\n        &quot;message&quot; : &quot;hi&quot;,\r\n        &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\r\n        &quot;timeStamp&quot; : 1641231670227\r\n      }\r\n    },\r\n    &quot;AYha5pt6tGgzPa0e4WJLr8wSakk23GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot; : {\r\n      &quot;messages&quot; : {\r\n        &quot;-MsYtw_o0dnh8meRwdI9&quot; : {\r\n          &quot;feeling&quot; : 0,\r\n          &quot;message&quot; : &quot;&quot;,\r\n          &quot;senderId&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;\r\n        },\r\n      }\r\n    }\r\n\r\nThis one is Users DataBase\r\n\r\n    &quot;users&quot; : {\r\n    &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot; : {\r\n      &quot;name&quot; : &quot;Om Swami&quot;,\r\n      &quot;phoneNumber&quot; : &quot;+919887012345&quot;,\r\n      &quot;profileImage&quot; : &quot;https://firebasestorage.googleapis.com/v0/b/whatsapp-back.appspot.com/o/Profiles%2F3GJBWzyjbVfAJQkhMIFzrr2KG2L2?alt=media&amp;token=be73d814-99cf-4fb4-8d9c-78aa1144a8e7&quot;,\r\n      &quot;uid&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;\r\n    },\r\n    &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot; : {\r\n      &quot;name&quot; : &quot;Prinshu&quot;,\r\n      &quot;phoneNumber&quot; : &quot;+9197864110&quot;,\r\n      &quot;profileImage&quot; : &quot;https://firebasestorage.googleapis.com/v0/b/whatsapp-back.appspot.com/o/Profiles%2F7JyFKNV0k6e4cwM8zNOb1coANfg1?alt=media&amp;token=2fb22085-3644-4703-b782-f3500dcce2b1&quot;,\r\n      &quot;uid&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;\r\n    },\r\n    &quot;AYha5pt6tGgzPa0e4WJLr8wSakk2&quot; : {\r\n      &quot;name&quot; : &quot;Ishmita Om&quot;,\r\n      &quot;phoneNumber&quot; : &quot;+91988782409&quot;,\r\n      &quot;profileImage&quot; : &quot;https://firebasestorage.googleapis.com/v0/b/whatsapp-back.appspot.com/o/Profiles%2FAYha5pt6tGgzPa0e4WJLr8wSakk2?alt=media&amp;token=63ff351c-f2d0-485f-9dfa-e396e94ebbc7&quot;,\r\n      &quot;uid&quot; : &quot;AYha5pt6tGgzPa0e4WJLr8wSakk2&quot;\r\n    }\r\n  }\r\n}","title":"com.google.firebase.database.DatabaseException: Can&#39;t convert object of type java.lang.Long to type com.example.whatsappback.Models.Message","body":"<p>I am getting this Error, <strong>App is crashing every time when I try to send messages</strong></p>\n<blockquote>\n<p>com.google.firebase.database.DatabaseException: Can't convert object of type java.lang.Long to type com.example.whatsappback.Models.Message</p>\n<p>at com.example.whatsappback.Activities.ChatActivity$1.onDataChange(ChatActivity.java:63)</p>\n</blockquote>\n<p>Which is:</p>\n<pre><code>Message message = snapshot1.getValue(Message.class);\n</code></pre>\n<p><strong>This is My ChatActivity</strong>\nHere I am getting the Error</p>\n<pre><code>public class ChatActivity extends AppCompatActivity {\n\nActivityChatBinding binding;\nMessagesAdapter adapter;\nArrayList&lt;Message&gt;messages;\nFirebaseDatabase database;\n\nString senderRoom, receiverRoom;\n\n\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n\n    binding = ActivityChatBinding.inflate(getLayoutInflater());\n    setContentView(binding.getRoot());\n\n    messages = new ArrayList&lt;&gt;();\n    adapter = new MessagesAdapter(this, messages);\n\n    binding.recyclerView.setLayoutManager(new LinearLayoutManager(this));\n    binding.recyclerView.setAdapter(adapter);\n\n    String name = getIntent().getStringExtra(&quot;name&quot;);\n    String receiverUid = getIntent().getStringExtra(&quot;uid&quot;);\n    String senderUid = FirebaseAuth.getInstance().getUid();\n\n\n    senderRoom = senderUid+receiverUid;\n    receiverRoom = receiverUid+senderUid;\n\n    database = FirebaseDatabase.getInstance();\n\n\n    database.getReference().child(&quot;chats&quot;)\n            .child(senderRoom)\n            .child(&quot;messages&quot;)\n            .addValueEventListener(new ValueEventListener() {\n                @Override\n                public void onDataChange(@NonNull DataSnapshot snapshot) {\n                messages.clear();\n                for (DataSnapshot snapshot1: snapshot.getChildren())\n                {\n                    Message message = snapshot1.getValue(Message.class);\n                    messages.add(message);\n\n                }\n                adapter.notifyDataSetChanged();\n                }\n\n                @Override\n                public void onCancelled(@NonNull DatabaseError error) {\n\n                }\n            });\n\n\n    binding.sendBtn.setOnClickListener(new View.OnClickListener() {\n        @Override\n        public void onClick(View view) {\n            String messageTxt = binding.messageBox.getText().toString();\n            Date date = new Date();\n            Message message = new Message(messageTxt, senderUid, date.getTime());\n            binding.messageBox.setText(&quot;&quot;);\n\n\n            database.getReference().child(&quot;chats&quot;)\n                    .child(senderRoom)\n                    .child(&quot;messages&quot;)\n                    .push()\n                    .setValue(message).addOnSuccessListener(new OnSuccessListener&lt;Void&gt;() {\n                @Override\n                public void onSuccess(Void unused) {\n                    database.getReference().child(&quot;chats&quot;)\n                            .child(receiverRoom)\n                            .child(&quot;messages&quot;)\n                            .push()\n                            .setValue(message).addOnSuccessListener(new OnSuccessListener&lt;Void&gt;() {\n                        @Override\n                        public void onSuccess(Void unused) {\n\n                        }\n                    });\n                }\n            });\n\n        }\n    });\n\n\n}\n\n@Override\npublic boolean onSupportNavigateUp() {\n    finish();\n    return super.onSupportNavigateUp();\n}}\n</code></pre>\n<p><strong>This is The Model Class Message.java</strong></p>\n<pre><code>public class Message {\n\nprivate String messageId, message, senderId;\nprivate long timeStamp;\nprivate int feeling;\n\npublic Message() {\n}\n\npublic Message(String message, String senderId, long timeStamp) {\n    this.message = message;\n    this.senderId = senderId;\n    this.timeStamp = timeStamp;\n}\n\npublic String getMessageId() {\n    return messageId;\n}\n\npublic void setMessageId(String messageId) {\n    this.messageId = messageId;\n}\n\npublic String getMessage() {\n    return message;\n}\n\npublic void setMessage(String message) {\n    this.message = message;\n}\n\npublic String getSenderId() {\n    return senderId;\n}\n\npublic void setSenderId(String senderId) {\n    this.senderId = senderId;\n}\n\npublic long getTimeStamp() {\n    return timeStamp;\n}\n\npublic void setTimeStamp(long timeStamp) {\n    this.timeStamp = timeStamp;\n}\n\npublic int getFeeling() {\n    return feeling;\n}\n\npublic void setFeeling(int feeling) {\n    this.feeling = feeling;\n}\n</code></pre>\n<p>}</p>\n<p><strong>My JSON FILE</strong> where I the first one is Chats Database and Second One is Users who login in the App</p>\n<pre><code>{&quot;chats&quot; : {\n&quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L23GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot; : {\n  &quot;messages&quot; : {\n    &quot;-MsW3CCOLw1CRDYWahl4&quot; : {\n      &quot;feeling&quot; : 0,\n      &quot;message&quot; : &quot;hi&quot;,\n      &quot;senderId&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;,\n      &quot;timeStamp&quot; : 1641232243332\n    },\n    &quot;-MsYWOVMOe17EMptWwlS&quot; : {\n      &quot;feeling&quot; : 0,\n      &quot;message&quot; : &quot;hhhhh&quot;,\n      &quot;senderId&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;\n    }}},\n&quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L27JyFKNV0k6e4cwM8zNOb1coANfg1&quot; : {\n  &quot;messages&quot; : {\n    &quot;-MsW6Lem6hq_hxZjeOQA&quot; : {\n      &quot;feeling&quot; : 0,\n      &quot;message&quot; : &quot;helloo&quot;,\n      &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\n      &quot;timeStamp&quot; : 1641233081867\n    },\n    &quot;feeling&quot; : 0,\n    &quot;message&quot; : &quot;hi&quot;,\n    &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\n    &quot;timeStamp&quot; : 1641231670227\n  }\n},\n&quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2AYha5pt6tGgzPa0e4WJLr8wSakk2&quot; : {\n  &quot;messages&quot; : {\n    &quot;-MsYtwRyavktJc8hwonR&quot; : {\n      &quot;feeling&quot; : 0,\n      &quot;message&quot; : &quot;&quot;,\n      &quot;senderId&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;\n    },\n    &quot;-MsYtwwvlBe0Ocdvlggu&quot; : {\n      &quot;feeling&quot; : 0,\n      &quot;message&quot; : &quot;&quot;,\n      &quot;senderId&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;\n    },\n  }\n},\n&quot;7JyFKNV0k6e4cwM8zNOb1coANfg13GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot; : {\n  &quot;messages&quot; : {\n    &quot;-MsW6L_AmpIryN0DBjyt&quot; : {\n      &quot;feeling&quot; : 0,\n      &quot;message&quot; : &quot;helloo&quot;,\n      &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\n      &quot;timeStamp&quot; : 1641233081867\n    },\n    &quot;-MsW8eU0KN4Ge8bC1ktq&quot; : {\n      &quot;feeling&quot; : 0,\n      &quot;message&quot; : &quot;hi&quot;,\n      &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\n      &quot;timeStamp&quot; : 1641233687661\n    },\n    &quot;feeling&quot; : 0,\n    &quot;message&quot; : &quot;hi&quot;,\n    &quot;senderId&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;,\n    &quot;timeStamp&quot; : 1641231670227\n  }\n},\n&quot;AYha5pt6tGgzPa0e4WJLr8wSakk23GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot; : {\n  &quot;messages&quot; : {\n    &quot;-MsYtw_o0dnh8meRwdI9&quot; : {\n      &quot;feeling&quot; : 0,\n      &quot;message&quot; : &quot;&quot;,\n      &quot;senderId&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;\n    },\n  }\n}\n</code></pre>\n<p>This one is Users DataBase</p>\n<pre><code>&quot;users&quot; : {\n&quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot; : {\n  &quot;name&quot; : &quot;Om Swami&quot;,\n  &quot;phoneNumber&quot; : &quot;+919887012345&quot;,\n  &quot;profileImage&quot; : &quot;https://firebasestorage.googleapis.com/v0/b/whatsapp-back.appspot.com/o/Profiles%2F3GJBWzyjbVfAJQkhMIFzrr2KG2L2?alt=media&amp;token=be73d814-99cf-4fb4-8d9c-78aa1144a8e7&quot;,\n  &quot;uid&quot; : &quot;3GJBWzyjbVfAJQkhMIFzrr2KG2L2&quot;\n},\n&quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot; : {\n  &quot;name&quot; : &quot;Prinshu&quot;,\n  &quot;phoneNumber&quot; : &quot;+9197864110&quot;,\n  &quot;profileImage&quot; : &quot;https://firebasestorage.googleapis.com/v0/b/whatsapp-back.appspot.com/o/Profiles%2F7JyFKNV0k6e4cwM8zNOb1coANfg1?alt=media&amp;token=2fb22085-3644-4703-b782-f3500dcce2b1&quot;,\n  &quot;uid&quot; : &quot;7JyFKNV0k6e4cwM8zNOb1coANfg1&quot;\n},\n&quot;AYha5pt6tGgzPa0e4WJLr8wSakk2&quot; : {\n  &quot;name&quot; : &quot;Ishmita Om&quot;,\n  &quot;phoneNumber&quot; : &quot;+91988782409&quot;,\n  &quot;profileImage&quot; : &quot;https://firebasestorage.googleapis.com/v0/b/whatsapp-back.appspot.com/o/Profiles%2FAYha5pt6tGgzPa0e4WJLr8wSakk2?alt=media&amp;token=63ff351c-f2d0-485f-9dfa-e396e94ebbc7&quot;,\n  &quot;uid&quot; : &quot;AYha5pt6tGgzPa0e4WJLr8wSakk2&quot;\n}\n</code></pre>\n<p>}\n}</p>\n"},{"tags":["java","graphics","rendering"],"comments":[{"owner":{"account_id":44852,"reputation":322224,"user_id":131872,"accept_rate":100,"display_name":"camickr"},"score":1,"creation_date":1641396953,"post_id":70594489,"comment_id":124795012,"body_markdown":"*Is there a way to remove the rendering of the old positions of the object?* - you need to clear the background of your painting area. You don&#39;t show your painting code so we cant&#39; suggest exactly what you need to do. Check out: https://stackoverflow.com/questions/54028090/get-width-and-height-of-jpanel-outside-of-the-class/54028681#54028681. Change the number of balls from 5 to 100 to see if it does what you want.","body":"<i>Is there a way to remove the rendering of the old positions of the object?</i> - you need to clear the background of your painting area. You don&#39;t show your painting code so we cant&#39; suggest exactly what you need to do. Check out: <a href=\"https://stackoverflow.com/questions/54028090/get-width-and-height-of-jpanel-outside-of-the-class/54028681#54028681\" title=\"get width and height of jpanel outside of the class\">stackoverflow.com/questions/54028090/&hellip;</a>. Change the number of balls from 5 to 100 to see if it does what you want."},{"owner":{"account_id":23835757,"reputation":21,"user_id":17841504,"display_name":"Jill Jessurun"},"score":1,"creation_date":1641404889,"post_id":70594489,"comment_id":124798364,"body_markdown":"Ayy thanks @camickr. After a few hours i finally got it, my program was already quite big which made it a lot harder. I looked at the link you highlighted and used the override paintComponent which (after changing my whole code completely) worked haha.","body":"Ayy thanks @camickr. After a few hours i finally got it, my program was already quite big which made it a lot harder. I looked at the link you highlighted and used the override paintComponent which (after changing my whole code completely) worked haha."}],"owner":{"account_id":23835757,"reputation":21,"user_id":17841504,"display_name":"Jill Jessurun"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":62,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":0,"score":2,"last_activity_date":1641396717,"creation_date":1641392558,"question_id":70594489,"body_markdown":"I built a small game in java in which i use a game loop. I add gameobjects which i render using render() and tick() methods. However, now the program gets bigger i encounterted a problem.\r\nHow do you solve that when i use velocity to move a picture, the object keeps rendering on old positions? For small programs this aint a problem, but when you get like 100 objects in the screen the FPS keeps dropping to the point the program doesnt work properly anymore. This is just because there are so many objects to render. Is there a way to remove the rendering of the old positions of the object? Here below is some code i have written. \r\n\r\nThe game loop i used:\r\n\r\n    public void run() {\r\n        this.requestFocus();\r\n        long lastTime = System.nanoTime();\r\n        double amountOfTicks = 60.0;\r\n        double ns = 1000000000 / amountOfTicks;\r\n        double delta = 0;\r\n        long timer = System.currentTimeMillis();\r\n        int frames = 0;\r\n        while (running) {\r\n            long now = System.nanoTime();\r\n            delta += (now - lastTime) / ns;\r\n            lastTime = now;\r\n            while (delta &gt;= 1) {\r\n                tick();\r\n                delta--;\r\n            }\r\n            if (running) {\r\n                try {\r\n                    render();\r\n                } catch (IOException e) {\r\n                    e.printStackTrace();\r\n                } catch (FontFormatException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }\r\n            frames++;\r\n\r\n            if (System.currentTimeMillis() - timer &gt; 1000) {\r\n                timer += 1000;\r\n                System.out.println(&quot;FPS: &quot; + frames);\r\n                frames = 0;\r\n            }\r\n        }\r\n        stop();\r\n    }\r\n\r\n\r\nI used the Graphics class in Java to draw the images/strings/rectangles/etc. on the JFrame.  \r\n\r\nHere below is a picture of the problem. You can see that the object began all the way to the right. I changed the x-axis every tick of the game loop which made the object go to the left. Unfortunately, the object leaves a trace behind it and keeps rendering that, while i want it to only render the newest position.\r\n\r\nObject rendering problem picture:\r\n\r\n[![https://i.stack.imgur.com/iUPH2.png][1]][1]\r\n\r\nHow can i solve this? Thanks in advance.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/iUPH2.png","title":"How to stop rendering old positions when moving a picture in Java?","body":"<p>I built a small game in java in which i use a game loop. I add gameobjects which i render using render() and tick() methods. However, now the program gets bigger i encounterted a problem.\nHow do you solve that when i use velocity to move a picture, the object keeps rendering on old positions? For small programs this aint a problem, but when you get like 100 objects in the screen the FPS keeps dropping to the point the program doesnt work properly anymore. This is just because there are so many objects to render. Is there a way to remove the rendering of the old positions of the object? Here below is some code i have written.</p>\n<p>The game loop i used:</p>\n<pre><code>public void run() {\n    this.requestFocus();\n    long lastTime = System.nanoTime();\n    double amountOfTicks = 60.0;\n    double ns = 1000000000 / amountOfTicks;\n    double delta = 0;\n    long timer = System.currentTimeMillis();\n    int frames = 0;\n    while (running) {\n        long now = System.nanoTime();\n        delta += (now - lastTime) / ns;\n        lastTime = now;\n        while (delta &gt;= 1) {\n            tick();\n            delta--;\n        }\n        if (running) {\n            try {\n                render();\n            } catch (IOException e) {\n                e.printStackTrace();\n            } catch (FontFormatException e) {\n                e.printStackTrace();\n            }\n        }\n        frames++;\n\n        if (System.currentTimeMillis() - timer &gt; 1000) {\n            timer += 1000;\n            System.out.println(&quot;FPS: &quot; + frames);\n            frames = 0;\n        }\n    }\n    stop();\n}\n</code></pre>\n<p>I used the Graphics class in Java to draw the images/strings/rectangles/etc. on the JFrame.</p>\n<p>Here below is a picture of the problem. You can see that the object began all the way to the right. I changed the x-axis every tick of the game loop which made the object go to the left. Unfortunately, the object leaves a trace behind it and keeps rendering that, while i want it to only render the newest position.</p>\n<p>Object rendering problem picture:</p>\n<p><a href=\"https://i.stack.imgur.com/iUPH2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iUPH2.png\" alt=\"https://i.stack.imgur.com/iUPH2.png\" /></a></p>\n<p>How can i solve this? Thanks in advance.</p>\n"},{"tags":["java","sql-server","hibernate","grails"],"comments":[{"owner":{"account_id":18111921,"reputation":1037,"user_id":13168911,"display_name":"Andrew Corrigan"},"score":0,"creation_date":1641396077,"post_id":70595292,"comment_id":124794592,"body_markdown":"Break it down into chunks of 500 or so?","body":"Break it down into chunks of 500 or so?"},{"owner":{"account_id":16704880,"reputation":525,"user_id":12073621,"display_name":"Adam"},"score":0,"creation_date":1641396341,"post_id":70595292,"comment_id":124794716,"body_markdown":"And how to do it?","body":"And how to do it?"},{"owner":{"account_id":16704880,"reputation":525,"user_id":12073621,"display_name":"Adam"},"score":0,"creation_date":1641396377,"post_id":70595292,"comment_id":124794734,"body_markdown":"final Set&lt;CatalogUser&gt; unavailableUsers = ctx.delegationService.getUnavailableUserVariants()\n\n    List&lt;Set&lt;CatalogUser&gt;&gt; output = new ArrayList&lt;&gt;()\n    Set&lt;CatalogUser&gt; currSet = null\n    for (CatalogUser value : unavailableUsers) {\n        if (currSet == null || currSet.size() == 1000)\n            output.add(currSet = new HashSet&lt;CatalogUser&gt;());\n        currSet.add(value);\n    }\n\n    output.each {it -&gt;\n        if (it) {\n            inList &#39;key&#39;, it*.key\n        }\n    }","body":"final Set&lt;CatalogUser&gt; unavailableUsers = ctx.delegationService.getUnavailableUserVariants()      List&lt;Set&lt;CatalogUser&gt;&gt; output = new ArrayList&lt;&gt;()     Set&lt;CatalogUser&gt; currSet = null     for (CatalogUser value : unavailableUsers) {         if (currSet == null || currSet.size() == 1000)             output.add(currSet = new HashSet&lt;CatalogUser&gt;());         currSet.add(value);     }      output.each {it -&gt;         if (it) {             inList &#39;key&#39;, it*.key         }     }"},{"owner":{"account_id":16704880,"reputation":525,"user_id":12073621,"display_name":"Adam"},"score":0,"creation_date":1641396399,"post_id":70595292,"comment_id":124794743,"body_markdown":"I try to do it, but it doesn&#39;t help","body":"I try to do it, but it doesn&#39;t help"},{"owner":{"account_id":24165,"reputation":274971,"user_id":61305,"display_name":"Aaron Bertrand"},"score":1,"creation_date":1641396515,"post_id":70595292,"comment_id":124794800,"body_markdown":"If you&#39;re using JDBC &gt;= 6 you can use [table-valued parameters](https://learn.microsoft.com/en-us/sql/connect/jdbc/using-table-valued-parameters), by far the most efficient way to pass a set to SQL Server. Failing that (or if your Hibernate thing can&#39;t support it) you can build a single CSV and parse it on the other side using `STRING_SPLIT()`. But that won&#39;t work well for 2500 values either.","body":"If you&#39;re using JDBC &gt;= 6 you can use <a href=\"https://learn.microsoft.com/en-us/sql/connect/jdbc/using-table-valued-parameters\" rel=\"nofollow noreferrer\">table-valued parameters</a>, by far the most efficient way to pass a set to SQL Server. Failing that (or if your Hibernate thing can&#39;t support it) you can build a single CSV and parse it on the other side using <code>STRING_SPLIT()</code>. But that won&#39;t work well for 2500 values either."},{"owner":{"account_id":8794729,"reputation":15297,"user_id":6572971,"display_name":"Alien"},"score":0,"creation_date":1641403403,"post_id":70595292,"comment_id":124797796,"body_markdown":"https://stackoverflow.com/a/64104377/6572971 have a look at it might help you.","body":"<a href=\"https://stackoverflow.com/a/64104377/6572971\">stackoverflow.com/a/64104377/6572971</a> have a look at it might help you."},{"owner":{"account_id":4327054,"reputation":26992,"user_id":3533584,"display_name":"Jeff Scott Brown"},"score":1,"creation_date":1641427755,"post_id":70595292,"comment_id":124805252,"body_markdown":"&quot;Break it down into chunks of 500 or so?&quot; - @AndrewCorrigan I am not sure that will help. From the code in the question, I _think_ the issue is with the criteria, not the results.","body":"&quot;Break it down into chunks of 500 or so?&quot; - @AndrewCorrigan I am not sure that will help. From the code in the question, I <i>think</i> the issue is with the criteria, not the results."}],"owner":{"account_id":16704880,"reputation":525,"user_id":12073621,"display_name":"Adam"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":403,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1641396590,"creation_date":1641395886,"question_id":70595292,"body_markdown":"I use MSSQL witch has constaints. And I get error:\r\n\r\nClass\r\ncom.microsoft.sqlserver.jdbc.SQLServerException\r\nMessage\r\nThe incoming request has too many parameters. The server supports a maximum of 2100 parameters. Reduce the number of parameters and resend the request.\r\n \r\nIn this plase:\r\n\r\n    final Set&lt;User&gt; unavailableUsers = ctx.delegationService.getUnavailableUserVariants()\r\n        \r\n    if (unavailableUsers) {\r\n        inList &#39;key&#39;, unavailableUsers*.key\r\n    }\r\n\r\nunavailableUsers has many Users about 2500.\r\n\r\nHow to solve this problem?\r\n\r\nI try to do chunks of array\r\n\r\n    final Set&lt;User&gt; unavailableUsers = ctx.delegationService.getUnavailableUserVariants()\r\n    \r\n    List&lt;Set&lt;User&gt;&gt; output = new ArrayList&lt;&gt;()\r\n    Set&lt;User&gt; currSet = null\r\n    for (CatalogUser value : unavailableUsers) {\r\n        if (currSet == null || currSet.size() == 1000)\r\n            output.add(currSet = new HashSet&lt;User&gt;());\r\n        currSet.add(value);\r\n    }\r\n    \r\n    output.each {it -&gt;\r\n        if (it) {\r\n            inList &#39;key&#39;, it*.key\r\n        }\r\n    }\r\n\r\nBut it doesn&#39;t help","title":"The incoming request has too many parameters. The server supports a maximum of 2100 parameters in Grails","body":"<p>I use MSSQL witch has constaints. And I get error:</p>\n<p>Class\ncom.microsoft.sqlserver.jdbc.SQLServerException\nMessage\nThe incoming request has too many parameters. The server supports a maximum of 2100 parameters. Reduce the number of parameters and resend the request.</p>\n<p>In this plase:</p>\n<pre><code>final Set&lt;User&gt; unavailableUsers = ctx.delegationService.getUnavailableUserVariants()\n    \nif (unavailableUsers) {\n    inList 'key', unavailableUsers*.key\n}\n</code></pre>\n<p>unavailableUsers has many Users about 2500.</p>\n<p>How to solve this problem?</p>\n<p>I try to do chunks of array</p>\n<pre><code>final Set&lt;User&gt; unavailableUsers = ctx.delegationService.getUnavailableUserVariants()\n\nList&lt;Set&lt;User&gt;&gt; output = new ArrayList&lt;&gt;()\nSet&lt;User&gt; currSet = null\nfor (CatalogUser value : unavailableUsers) {\n    if (currSet == null || currSet.size() == 1000)\n        output.add(currSet = new HashSet&lt;User&gt;());\n    currSet.add(value);\n}\n\noutput.each {it -&gt;\n    if (it) {\n        inList 'key', it*.key\n    }\n}\n</code></pre>\n<p>But it doesn't help</p>\n"},{"tags":["java","mysql","kotlin","kotlin-exposed"],"comments":[{"owner":{"account_id":277416,"reputation":681848,"user_id":571407,"accept_rate":100,"display_name":"JB Nizet"},"score":6,"creation_date":1555948050,"post_id":55797013,"comment_id":98263092,"body_markdown":"I&#39;ve never used exposed. But the message says: &quot;No transaction in context&quot;. And the call to firstOrNull(), which throws the exception, is *outside* of the transaction block. My logical deduction would be that it needs to be *inside* the transaction block.","body":"I&#39;ve never used exposed. But the message says: &quot;No transaction in context&quot;. And the call to firstOrNull(), which throws the exception, is <i>outside</i> of the transaction block. My logical deduction would be that it needs to be <i>inside</i> the transaction block."},{"owner":{"account_id":7796812,"reputation":6568,"user_id":5897602,"accept_rate":92,"display_name":"Jaquarh"},"score":0,"creation_date":1555948360,"post_id":55797013,"comment_id":98263238,"body_markdown":"That solved my issue! There documentation is so confusing sometimes. Thanks @JBNizet","body":"That solved my issue! There documentation is so confusing sometimes. Thanks @JBNizet"}],"answers":[{"tags":[],"owner":{"account_id":7796812,"reputation":6568,"user_id":5897602,"accept_rate":92,"display_name":"Jaquarh"},"down_vote_count":0,"up_vote_count":6,"is_accepted":true,"score":6,"last_activity_date":1641396336,"creation_date":1641396336,"answer_id":70595407,"question_id":55797013,"body_markdown":"For future viewers, this was resolved in the comments simply by moving the `firstOrNull()` inside the `transaction` blocks scope.\r\n\r\n    fun loadPlayer(client: Client): PlayerLoadResult {\r\n        var player = transaction {\r\n            PlayerModel.select {\r\n                PlayerModel.username eq client.loginUsername\r\n            }.firstOrNull() ?: return PlayerLoadResult.NEW_ACCOUNT\r\n        }\r\n    \r\n        // ...\r\n    \r\n        return PlayerLoadResult.LOAD_ACCOUNT\r\n    }","title":"JetBrains Exposed throwing an error when trying to access first row of select query","body":"<p>For future viewers, this was resolved in the comments simply by moving the <code>firstOrNull()</code> inside the <code>transaction</code> blocks scope.</p>\n<pre><code>fun loadPlayer(client: Client): PlayerLoadResult {\n    var player = transaction {\n        PlayerModel.select {\n            PlayerModel.username eq client.loginUsername\n        }.firstOrNull() ?: return PlayerLoadResult.NEW_ACCOUNT\n    }\n\n    // ...\n\n    return PlayerLoadResult.LOAD_ACCOUNT\n}\n</code></pre>\n"}],"owner":{"account_id":7796812,"reputation":6568,"user_id":5897602,"accept_rate":92,"display_name":"Jaquarh"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4839,"favorite_count":0,"down_vote_count":0,"up_vote_count":5,"accepted_answer_id":70595407,"answer_count":1,"score":5,"last_activity_date":1641396336,"creation_date":1555947756,"question_id":55797013,"body_markdown":"When trying to fetch the first row from my `transaction`, I receive an error:\r\n\r\n&gt; java.lang.IllegalStateException: No transaction in context.\r\n\r\nMy code looks like this:\r\n\r\n    fun loadPlayer(client: Client): PlayerLoadResult {\r\n        var player = transaction {\r\n            PlayerModel.select {\r\n                PlayerModel.username eq client.loginUsername\r\n            }\r\n        }.firstOrNull() ?: return PlayerLoadResult.NEW_ACCOUNT\r\n\r\n        // ...\r\n\r\n        return PlayerLoadResult.LOAD_ACCOUNT\r\n    }\r\n\r\nMy `PlayerModel` looks like this:\r\n\r\n    object PlayerModel : Table(&quot;Players&quot;) {\r\n        val id = integer(&quot;id&quot;).autoIncrement().primaryKey()\r\n        val username = varchar(&quot;username&quot;, 60).uniqueIndex()\r\n        val displayName = varchar(&quot;display_name&quot;, 60).uniqueIndex()\r\n        val x = integer(&quot;position_x&quot;)\r\n        val height = integer(&quot;position_y&quot;)\r\n        val z = integer(&quot;position_z&quot;)\r\n        val privilege = integer(&quot;privilege&quot;).default(1)\r\n        val runEnergy = float(&quot;run_energy&quot;).default(100.toFloat())\r\n        val displayMode = integer(&quot;display_mode&quot;).default(0)\r\n        val hash = varchar(&quot;password_hash&quot;, 60)\r\n        val xteaKeyOne = integer(&quot;xtea_one&quot;)\r\n        val xteaKeyTwo = integer(&quot;xtea_two&quot;)\r\n        val xteaKeyThree = integer(&quot;xtea_three&quot;)\r\n        val xteaKeyFour = integer(&quot;xtea_four&quot;)\r\n    }\r\n\r\nMy full stack trace looks like this:\r\n\r\n    java.lang.IllegalStateException: No transaction in context.\r\n    \tat org.jetbrains.exposed.sql.transactions.TransactionManager$Companion.current(TransactionApi.kt:89) ~[exposed-0.13.6.jar:?]\r\n    \tat org.jetbrains.exposed.sql.Query.getTransaction(Query.kt:93) ~[exposed-0.13.6.jar:?]\r\n    \tat org.jetbrains.exposed.sql.Query.flushEntities(Query.kt:299) ~[exposed-0.13.6.jar:?]\r\n    \tat org.jetbrains.exposed.sql.Query.iterator(Query.kt:303) ~[exposed-0.13.6.jar:?]\r\n    \tat kotlin.collections.CollectionsKt___CollectionsKt.firstOrNull(_Collections.kt:219) ~[kotlin-stdlib-1.3.21.jar:1.3.21-release-158 (1.3.21)]\r\n    \tat gg.rsmod.plugins.service.sql.controllers.PlayerLoadController.loadPlayer(PlayerLoadController.kt:38) ~[plugins-0.0.4.jar:?]\r\n    \tat gg.rsmod.plugins.service.sql.SQLService.loadClientData(SQLService.kt:104) ~[plugins-0.0.4.jar:?]\r\n    \tat gg.rsmod.game.service.login.LoginWorker.run(LoginWorker.kt:28) [main/:?]\r\n    \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_211]\r\n    \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_211]\r\n    \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_211]\r\n\r\nWhat seems to be the issue with fetching the first row? This query should only return a single row, not multiple.","title":"JetBrains Exposed throwing an error when trying to access first row of select query","body":"<p>When trying to fetch the first row from my <code>transaction</code>, I receive an error:</p>\n\n<blockquote>\n  <p>java.lang.IllegalStateException: No transaction in context.</p>\n</blockquote>\n\n<p>My code looks like this:</p>\n\n<pre><code>fun loadPlayer(client: Client): PlayerLoadResult {\n    var player = transaction {\n        PlayerModel.select {\n            PlayerModel.username eq client.loginUsername\n        }\n    }.firstOrNull() ?: return PlayerLoadResult.NEW_ACCOUNT\n\n    // ...\n\n    return PlayerLoadResult.LOAD_ACCOUNT\n}\n</code></pre>\n\n<p>My <code>PlayerModel</code> looks like this:</p>\n\n<pre><code>object PlayerModel : Table(\"Players\") {\n    val id = integer(\"id\").autoIncrement().primaryKey()\n    val username = varchar(\"username\", 60).uniqueIndex()\n    val displayName = varchar(\"display_name\", 60).uniqueIndex()\n    val x = integer(\"position_x\")\n    val height = integer(\"position_y\")\n    val z = integer(\"position_z\")\n    val privilege = integer(\"privilege\").default(1)\n    val runEnergy = float(\"run_energy\").default(100.toFloat())\n    val displayMode = integer(\"display_mode\").default(0)\n    val hash = varchar(\"password_hash\", 60)\n    val xteaKeyOne = integer(\"xtea_one\")\n    val xteaKeyTwo = integer(\"xtea_two\")\n    val xteaKeyThree = integer(\"xtea_three\")\n    val xteaKeyFour = integer(\"xtea_four\")\n}\n</code></pre>\n\n<p>My full stack trace looks like this:</p>\n\n<pre><code>java.lang.IllegalStateException: No transaction in context.\n    at org.jetbrains.exposed.sql.transactions.TransactionManager$Companion.current(TransactionApi.kt:89) ~[exposed-0.13.6.jar:?]\n    at org.jetbrains.exposed.sql.Query.getTransaction(Query.kt:93) ~[exposed-0.13.6.jar:?]\n    at org.jetbrains.exposed.sql.Query.flushEntities(Query.kt:299) ~[exposed-0.13.6.jar:?]\n    at org.jetbrains.exposed.sql.Query.iterator(Query.kt:303) ~[exposed-0.13.6.jar:?]\n    at kotlin.collections.CollectionsKt___CollectionsKt.firstOrNull(_Collections.kt:219) ~[kotlin-stdlib-1.3.21.jar:1.3.21-release-158 (1.3.21)]\n    at gg.rsmod.plugins.service.sql.controllers.PlayerLoadController.loadPlayer(PlayerLoadController.kt:38) ~[plugins-0.0.4.jar:?]\n    at gg.rsmod.plugins.service.sql.SQLService.loadClientData(SQLService.kt:104) ~[plugins-0.0.4.jar:?]\n    at gg.rsmod.game.service.login.LoginWorker.run(LoginWorker.kt:28) [main/:?]\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_211]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_211]\n    at java.lang.Thread.run(Thread.java:748) [?:1.8.0_211]\n</code></pre>\n\n<p>What seems to be the issue with fetching the first row? This query should only return a single row, not multiple.</p>\n"},{"tags":["java","fork-join","forkjoinpool"],"comments":[{"owner":{"account_id":12278867,"reputation":803,"user_id":8961170,"display_name":"AlirezaAsadi"},"score":0,"creation_date":1641294598,"post_id":70577588,"comment_id":124762413,"body_markdown":"Did you try: `System.out.println(task.number);` ? After doing `ForkJoinPool fjp = new ForkJoinPool(); int n = 13; ForkJoinFibonacci task = new ForkJoinFibonacci(n); fjp.invoke(task);`","body":"Did you try: <code>System.out.println(task.number);</code> ? After doing <code>ForkJoinPool fjp = new ForkJoinPool(); int n = 13; ForkJoinFibonacci task = new ForkJoinFibonacci(n); fjp.invoke(task);</code>"}],"answers":[{"tags":[],"owner":{"account_id":75804,"reputation":94815,"user_id":217324,"accept_rate":96,"display_name":"Nathan Hughes"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641396278,"creation_date":1641308588,"answer_id":70580833,"question_id":70577588,"body_markdown":"The summing is in the compute method.\r\n\r\nEach recursive action stores its own calculation in number. the compute method either finishes the calculation if it&#39;s small enough, storing it in the number field, or farms the work out to two more recursive actions, in which case it gets their results from their number field, sums them, and stores them in its own number field. the topmost recursive action exposes number through a getter.\r\n\r\nIt probably isn&#39;t clear how compute gets called on both f1 and f2. The documentation for invokeAll says each of the tasks gets forked, that puts them in the work queue for the current task, and they&#39;re eligible for stealing by other threads. The important thing is that both f1 and f2 get processed and have compute run on them before control returns from invokeAll. Each time compute is called it retrieves the number fields from the completed forked tasks, sums them, and stores the result in its own number field.\r\n\r\nOne more thing making this confusing to read is that it&#39;s using number to store 2 different things, the number identifying which fibonacci number we&#39;re trying to calculate and also the result of the calculation. \r\n\r\nThe posted code does look like it should work, but it does not make the best use of its threads. An alternative way to write this is to replace the invokeAll with\r\n\r\n    f1.fork();\r\n    f2.compute();\r\n    f1.join();\r\n\r\nThat way the current thread is directly computing one branch of the subproblem instead of forking both of them. \r\n\r\n","title":"How does RecursiveAction work with Fibonacci?","body":"<p>The summing is in the compute method.</p>\n<p>Each recursive action stores its own calculation in number. the compute method either finishes the calculation if it's small enough, storing it in the number field, or farms the work out to two more recursive actions, in which case it gets their results from their number field, sums them, and stores them in its own number field. the topmost recursive action exposes number through a getter.</p>\n<p>It probably isn't clear how compute gets called on both f1 and f2. The documentation for invokeAll says each of the tasks gets forked, that puts them in the work queue for the current task, and they're eligible for stealing by other threads. The important thing is that both f1 and f2 get processed and have compute run on them before control returns from invokeAll. Each time compute is called it retrieves the number fields from the completed forked tasks, sums them, and stores the result in its own number field.</p>\n<p>One more thing making this confusing to read is that it's using number to store 2 different things, the number identifying which fibonacci number we're trying to calculate and also the result of the calculation.</p>\n<p>The posted code does look like it should work, but it does not make the best use of its threads. An alternative way to write this is to replace the invokeAll with</p>\n<pre><code>f1.fork();\nf2.compute();\nf1.join();\n</code></pre>\n<p>That way the current thread is directly computing one branch of the subproblem instead of forking both of them.</p>\n"}],"owner":{"account_id":21805279,"reputation":501,"user_id":16103555,"display_name":"Toni26"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":180,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"answer_count":1,"score":1,"last_activity_date":1641396278,"creation_date":1641293344,"question_id":70577588,"body_markdown":"How does recursion work in case of Fibonacci. The below example uses RecursiveAction which does not return any value. But still it is possible to calculate Fibonacci numbers. I mean for example in case of Fibonacci(15). The threshold in below example is 10. So Fibonacci(15) cannot be calculated directly. So 2 other tasks will be created . ForkJoinFibonacci(n - 1) and ForkJoinFibonacci(n - 2). So in the below example only the member variable &quot;number&quot; stores the calculated Fibonacci number. But it is never returned. Only stored locally in each ForkJoinFibonacci class.So how can all the calculated numbers be summed up ? \r\n\r\n    public class ForkJoinFibonacci extends RecursiveAction {\r\n        \r\n            private static final long threshold = 10;\r\n            private volatile long number;\r\n        \r\n            public ForkJoinFibonacci(long number) {\r\n                this.number = number;\r\n            }\r\n        \r\n            public long getNumber() {\r\n                return number;\r\n            }\r\n        \r\n            @Override\r\n            protected void compute() {\r\n                long n = number;\r\n                if (n &lt;= threshold) {\r\n                    number = fib(n);\r\n                } else {\r\n                    ForkJoinFibonacci f1 = new ForkJoinFibonacci(n - 1);\r\n                    ForkJoinFibonacci f2 = new ForkJoinFibonacci(n - 2);\r\n                    ForkJoinTask.invokeAll(f1, f2);\r\n                    number = f1.number + f2.number;\r\n                }\r\n            }\r\n        \r\n            private static long fib(long n) {\r\n                if (n &lt;= 1) return n;\r\n                else return fib(n - 1) + fib(n - 2);\r\n            }\r\n        }\r\n\r\nTo make it clear. It works. But I just do not know why it works.","title":"How does RecursiveAction work with Fibonacci?","body":"<p>How does recursion work in case of Fibonacci. The below example uses RecursiveAction which does not return any value. But still it is possible to calculate Fibonacci numbers. I mean for example in case of Fibonacci(15). The threshold in below example is 10. So Fibonacci(15) cannot be calculated directly. So 2 other tasks will be created . ForkJoinFibonacci(n - 1) and ForkJoinFibonacci(n - 2). So in the below example only the member variable &quot;number&quot; stores the calculated Fibonacci number. But it is never returned. Only stored locally in each ForkJoinFibonacci class.So how can all the calculated numbers be summed up ?</p>\n<pre><code>public class ForkJoinFibonacci extends RecursiveAction {\n    \n        private static final long threshold = 10;\n        private volatile long number;\n    \n        public ForkJoinFibonacci(long number) {\n            this.number = number;\n        }\n    \n        public long getNumber() {\n            return number;\n        }\n    \n        @Override\n        protected void compute() {\n            long n = number;\n            if (n &lt;= threshold) {\n                number = fib(n);\n            } else {\n                ForkJoinFibonacci f1 = new ForkJoinFibonacci(n - 1);\n                ForkJoinFibonacci f2 = new ForkJoinFibonacci(n - 2);\n                ForkJoinTask.invokeAll(f1, f2);\n                number = f1.number + f2.number;\n            }\n        }\n    \n        private static long fib(long n) {\n            if (n &lt;= 1) return n;\n            else return fib(n - 1) + fib(n - 2);\n        }\n    }\n</code></pre>\n<p>To make it clear. It works. But I just do not know why it works.</p>\n"},{"tags":["java","generics","inheritance","design-patterns","builder-pattern"],"answers":[{"tags":[],"owner":{"account_id":2417248,"reputation":1196,"user_id":2111039,"display_name":"Dmitry Pisklov"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1641396225,"creation_date":1584456145,"answer_id":60724647,"question_id":60719895,"body_markdown":"You need to use generics on the class level, not on the method level, in your CarBuilder:\r\n\r\n    package Builders;\r\n    \r\n    public abstract class CarBuilder&lt;B extends CarBuilder&lt;B, C&gt;, C extends Car&gt; {\r\n        int tyre;\r\n        int seat;\r\n    \r\n        public abstract B self();\r\n    \r\n        public abstract C typeOfCar();\r\n    \r\n        public B setTyre(int tyre) {\r\n            this.tyre = tyre;\r\n            return self();\r\n        }\r\n    \r\n        public B setSeat(int seat) {\r\n            this.seat = seat;\r\n            return self();\r\n        }\r\n    \r\n        public C build() {\r\n            C car = this.typeOfCar();\r\n            car.setSeat(seat);\r\n            car.setTyre(tyre);\r\n            return car;\r\n        }\r\n    \r\n    }\r\n\r\nAnd then you define your SwiftBuilder:\r\n\r\n    package Builders;\r\n    \r\n    public class SwiftBuilder extends CarBuilder&lt;SwiftBuilder, Swift&gt; {\r\n        String engine;\r\n    \r\n        @Override\r\n        public SwiftBuilder self() {\r\n    \r\n            return this;\r\n        }\r\n    \r\n        @Override\r\n        public Swift typeOfCar() {\r\n    \r\n            return new Swift();\r\n        }\r\n    \r\n        public SwiftBuilder setEngine(String string) {\r\n            this.engine = string;\r\n            return this;\r\n        }\r\n    \r\n        public Swift build() {\r\n            Swift s = super.build();\r\n            s.setEngine(engine);\r\n            return s;\r\n        }\r\n    \r\n    }\r\n\r\nAnd it works.","title":"Implementation of Hierarchical Builder pattern","body":"<p>You need to use generics on the class level, not on the method level, in your CarBuilder:</p>\n<pre><code>package Builders;\n\npublic abstract class CarBuilder&lt;B extends CarBuilder&lt;B, C&gt;, C extends Car&gt; {\n    int tyre;\n    int seat;\n\n    public abstract B self();\n\n    public abstract C typeOfCar();\n\n    public B setTyre(int tyre) {\n        this.tyre = tyre;\n        return self();\n    }\n\n    public B setSeat(int seat) {\n        this.seat = seat;\n        return self();\n    }\n\n    public C build() {\n        C car = this.typeOfCar();\n        car.setSeat(seat);\n        car.setTyre(tyre);\n        return car;\n    }\n\n}\n</code></pre>\n<p>And then you define your SwiftBuilder:</p>\n<pre><code>package Builders;\n\npublic class SwiftBuilder extends CarBuilder&lt;SwiftBuilder, Swift&gt; {\n    String engine;\n\n    @Override\n    public SwiftBuilder self() {\n\n        return this;\n    }\n\n    @Override\n    public Swift typeOfCar() {\n\n        return new Swift();\n    }\n\n    public SwiftBuilder setEngine(String string) {\n        this.engine = string;\n        return this;\n    }\n\n    public Swift build() {\n        Swift s = super.build();\n        s.setEngine(engine);\n        return s;\n    }\n\n}\n</code></pre>\n<p>And it works.</p>\n"}],"owner":{"account_id":9216495,"reputation":2575,"user_id":6847435,"accept_rate":100,"display_name":"coderzzz18"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":205,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":60724647,"answer_count":1,"score":1,"last_activity_date":1641396225,"creation_date":1584438811,"question_id":60719895,"body_markdown":"I am implementing Hierarchical Builder Pattern. I have used generics to make return type of my Parent Builder setter as that for child. Still I am facing problem when I use the child setter method after calling parent setter method. I don&#39;t want to define my child specific method (setEngine(String) here) in my Parent Builder. Is there any other way around for this problem?\n\nI have made an example snippet for the mentioned problem, identical to this case.\n \n **CarFactory -&gt;** It returns the object of specific car that user wants \n\n **Car -&gt;** Parent for all Car types, Swift, Duster etc\n \n **Swift -&gt;** Specific car\n\n\n\n\n **Parent-&gt;Child Hierarchy**\n\n   Car -&gt; Swift\n\n CarBuilder -&gt; SwiftBuilder\n\n **Car.java**\n ```\n  package Builders;\n\n  public class Car {\n    int tyre;\n    int seat;\n    public int getTyre() {\n        return tyre;\n    }\n    public void setTyre(int tyre) {\n        this.tyre = tyre;\n    }\n    public int getSeat() {\n        return seat;\n    }\n    public void setSeat(int seat) {\n        this.seat = seat;\n        \n    }\n    \n}\n```\n\n**Swift.java**\n\n```\npackage Builders;\n\npublic class Swift extends Car {\n    boolean safetyAirbag;\n    String engine;\n    \n    public boolean isSafetyAirbag() {\n        return safetyAirbag;\n    }\n\n    public String getEngine() {\n        return engine;\n    }\n\n    public void setSafetyAirbag(boolean safetyAirbag) {\n        this.safetyAirbag = safetyAirbag;\n    }\n\n    public void setEngine(String engine) {\n        this.engine = engine;\n    }\n\n\n}\n```\n**CarBuilder.java**\n```\npackage Builders;\n\npublic abstract class CarBuilder {\n        int tyre;\n        int seat;\n         \n        public abstract &lt;B extends CarBuilder&gt;B self();\n        public abstract &lt;T extends Car&gt;T typeOfCar();\n            \n        public &lt;B extends CarBuilder&gt;B setTyre(int tyre) {\n            this.tyre = tyre;\n            return self();\n        }\n        \n        public  &lt;B extends CarBuilder&gt; B setSeat(int seat) {\n            this.seat = seat;\n            return self();\n        }\n        public &lt;C extends Car&gt;C build()\n        {   C car=this.typeOfCar();\n            car.setSeat(seat);\n            car.setTyre(tyre);\n            return car;\n        }\n    \n        \n}\n```\n**SwiftBuilder.java**\n```\npackage Builders;\n\npublic class SwiftBuilder extends CarBuilder {\n    String engine;\n    @Override\n    public\n    SwiftBuilder self() {\n        \n        return this;\n    }\n\n    @Override\n    public\n    Swift typeOfCar() {\n        \n        return new Swift();\n    }\n\n    public SwiftBuilder setEngine(String string) {\n        this.engine=string;\n        return this;\n    }\n    public Swift build()\n    {   Swift s=(Swift)super.build();\n        return s;\n    }\n\n}\n```\n**CarFactory.java**\n```\npackage Builders;\n\npublic class CarFactory {\n    public SwiftBuilder getSwiftDesire()\n    {\n        return new SwiftBuilder();\n    }\n}\n \n```\n**Drivers.java**  \n```\npackage Builders;\n\npublic class Drivers {\n    Swift getMyCar() {\n        Swift s= this.factory().getSwiftDesire().setSeat(4).setEngine(&quot;CC&quot;).build();\n        return s;\n    }\n    CarFactory factory() {\n        return new CarFactory();\n    }\n}\n\n```\n\nIn Drivers.java class I am not able to use setEngine() method after setSeat() method,\nthis.factory().getSwiftDesire().setSeat(4).setEngine(&quot;CC&quot;).build();\nI don&#39;t want to declare setEngine in parent class, is there any way around for same? \n\nThank you in advance!\n","title":"Implementation of Hierarchical Builder pattern","body":"<p>I am implementing Hierarchical Builder Pattern. I have used generics to make return type of my Parent Builder setter as that for child. Still I am facing problem when I use the child setter method after calling parent setter method. I don't want to define my child specific method (setEngine(String) here) in my Parent Builder. Is there any other way around for this problem?</p>\n<p>I have made an example snippet for the mentioned problem, identical to this case.</p>\n<p><strong>CarFactory -&gt;</strong> It returns the object of specific car that user wants</p>\n<p><strong>Car -&gt;</strong> Parent for all Car types, Swift, Duster etc</p>\n<p><strong>Swift -&gt;</strong> Specific car</p>\n<p><strong>Parent-&gt;Child Hierarchy</strong></p>\n<p>Car -&gt; Swift</p>\n<p>CarBuilder -&gt; SwiftBuilder</p>\n<p><strong>Car.java</strong></p>\n<pre><code> package Builders;\n\n public class Car {\n   int tyre;\n   int seat;\n   public int getTyre() {\n       return tyre;\n   }\n   public void setTyre(int tyre) {\n       this.tyre = tyre;\n   }\n   public int getSeat() {\n       return seat;\n   }\n   public void setSeat(int seat) {\n       this.seat = seat;\n       \n   }\n   \n}\n</code></pre>\n<p><strong>Swift.java</strong></p>\n<pre><code>package Builders;\n\npublic class Swift extends Car {\n    boolean safetyAirbag;\n    String engine;\n    \n    public boolean isSafetyAirbag() {\n        return safetyAirbag;\n    }\n\n    public String getEngine() {\n        return engine;\n    }\n\n    public void setSafetyAirbag(boolean safetyAirbag) {\n        this.safetyAirbag = safetyAirbag;\n    }\n\n    public void setEngine(String engine) {\n        this.engine = engine;\n    }\n\n\n}\n</code></pre>\n<p><strong>CarBuilder.java</strong></p>\n<pre><code>package Builders;\n\npublic abstract class CarBuilder {\n        int tyre;\n        int seat;\n         \n        public abstract &lt;B extends CarBuilder&gt;B self();\n        public abstract &lt;T extends Car&gt;T typeOfCar();\n            \n        public &lt;B extends CarBuilder&gt;B setTyre(int tyre) {\n            this.tyre = tyre;\n            return self();\n        }\n        \n        public  &lt;B extends CarBuilder&gt; B setSeat(int seat) {\n            this.seat = seat;\n            return self();\n        }\n        public &lt;C extends Car&gt;C build()\n        {   C car=this.typeOfCar();\n            car.setSeat(seat);\n            car.setTyre(tyre);\n            return car;\n        }\n    \n        \n}\n</code></pre>\n<p><strong>SwiftBuilder.java</strong></p>\n<pre><code>package Builders;\n\npublic class SwiftBuilder extends CarBuilder {\n    String engine;\n    @Override\n    public\n    SwiftBuilder self() {\n        \n        return this;\n    }\n\n    @Override\n    public\n    Swift typeOfCar() {\n        \n        return new Swift();\n    }\n\n    public SwiftBuilder setEngine(String string) {\n        this.engine=string;\n        return this;\n    }\n    public Swift build()\n    {   Swift s=(Swift)super.build();\n        return s;\n    }\n\n}\n</code></pre>\n<p><strong>CarFactory.java</strong></p>\n<pre><code>package Builders;\n\npublic class CarFactory {\n    public SwiftBuilder getSwiftDesire()\n    {\n        return new SwiftBuilder();\n    }\n}\n \n</code></pre>\n<p><strong>Drivers.java</strong></p>\n<pre><code>package Builders;\n\npublic class Drivers {\n    Swift getMyCar() {\n        Swift s= this.factory().getSwiftDesire().setSeat(4).setEngine(&quot;CC&quot;).build();\n        return s;\n    }\n    CarFactory factory() {\n        return new CarFactory();\n    }\n}\n\n</code></pre>\n<p>In Drivers.java class I am not able to use setEngine() method after setSeat() method,\nthis.factory().getSwiftDesire().setSeat(4).setEngine(&quot;CC&quot;).build();\nI don't want to declare setEngine in parent class, is there any way around for same?</p>\n<p>Thank you in advance!</p>\n"},{"tags":["java","android","testing","mocking","mockito"],"comments":[{"owner":{"account_id":7589390,"reputation":1131,"user_id":5757486,"accept_rate":57,"display_name":"P S M"},"score":0,"creation_date":1479820053,"post_id":40742572,"comment_id":68711053,"body_markdown":"check require dependency and its scope","body":"check require dependency and its scope"},{"owner":{"account_id":9443335,"reputation":15252,"user_id":7023245,"accept_rate":25,"display_name":"Timothy Truckle"},"score":0,"creation_date":1479820158,"post_id":40742572,"comment_id":68711116,"body_markdown":"is your test comlipable? did you already trying to clean the project?","body":"is your test comlipable? did you already trying to clean the project?"},{"owner":{"account_id":7378264,"reputation":4782,"user_id":5709159,"accept_rate":58,"display_name":"Sirop4ik"},"score":0,"creation_date":1479820924,"post_id":40742572,"comment_id":68711569,"body_markdown":"@PSM what do you mean? as I mentioned in question I have already added this dependency...","body":"@PSM what do you mean? as I mentioned in question I have already added this dependency..."},{"owner":{"account_id":7378264,"reputation":4782,"user_id":5709159,"accept_rate":58,"display_name":"Sirop4ik"},"score":0,"creation_date":1479821002,"post_id":40742572,"comment_id":68711622,"body_markdown":"@TimothyTruckle no... I got this error during compilation... What does it mean?","body":"@TimothyTruckle no... I got this error during compilation... What does it mean?"},{"owner":{"account_id":7589390,"reputation":1131,"user_id":5757486,"accept_rate":57,"display_name":"P S M"},"score":0,"creation_date":1479821090,"post_id":40742572,"comment_id":68711688,"body_markdown":"Try replacing testCompile with androidTestCompile","body":"Try replacing testCompile with androidTestCompile"},{"owner":{"account_id":7589390,"reputation":1131,"user_id":5757486,"accept_rate":57,"display_name":"P S M"},"score":0,"creation_date":1479821104,"post_id":40742572,"comment_id":68711697,"body_markdown":"androidTestCompile &quot;org.mockito:mockito-core:1.10.19&quot;","body":"androidTestCompile &quot;org.mockito:mockito-core:1.10.19&quot;"},{"owner":{"account_id":7378264,"reputation":4782,"user_id":5709159,"accept_rate":58,"display_name":"Sirop4ik"},"score":0,"creation_date":1479821557,"post_id":40742572,"comment_id":68712007,"body_markdown":"@PSM no with this way androidStudio even can&#39;t recognize this import `import org.mockito.runners.MockitoJUnitRunner;`","body":"@PSM no with this way androidStudio even can&#39;t recognize this import <code>import org.mockito.runners.MockitoJUnitRunner;</code>"},{"owner":{"account_id":7589390,"reputation":1131,"user_id":5757486,"accept_rate":57,"display_name":"P S M"},"score":0,"creation_date":1479821698,"post_id":40742572,"comment_id":68712114,"body_markdown":"It looks like Gradle is not doing it&#39;s job.\n\nManually adding the jars fixed the problem.","body":"It looks like Gradle is not doing it&#39;s job.  Manually adding the jars fixed the problem."},{"owner":{"account_id":7378264,"reputation":4782,"user_id":5709159,"accept_rate":58,"display_name":"Sirop4ik"},"score":0,"creation_date":1479822077,"post_id":40742572,"comment_id":68712340,"body_markdown":"@PSM Yes! You are right! Thanks a lot! If you publish answer I will approve it","body":"@PSM Yes! You are right! Thanks a lot! If you publish answer I will approve it"},{"owner":{"account_id":7589390,"reputation":1131,"user_id":5757486,"accept_rate":57,"display_name":"P S M"},"score":0,"creation_date":1479823198,"post_id":40742572,"comment_id":68713131,"body_markdown":"approve my answer","body":"approve my answer"},{"owner":{"account_id":9443335,"reputation":15252,"user_id":7023245,"accept_rate":25,"display_name":"Timothy Truckle"},"score":0,"creation_date":1479840739,"post_id":40742572,"comment_id":68724878,"body_markdown":"@AlekseyTimoshchenko is it a multi project configuration?","body":"@AlekseyTimoshchenko is it a multi project configuration?"},{"owner":{"account_id":7378264,"reputation":4782,"user_id":5709159,"accept_rate":58,"display_name":"Sirop4ik"},"score":0,"creation_date":1479845112,"post_id":40742572,"comment_id":68727262,"body_markdown":"@TimothyTruckle what does it mean multi project configuration?","body":"@TimothyTruckle what does it mean multi project configuration?"},{"owner":{"account_id":9443335,"reputation":15252,"user_id":7023245,"accept_rate":25,"display_name":"Timothy Truckle"},"score":0,"creation_date":1479845766,"post_id":40742572,"comment_id":68727645,"body_markdown":"@AlekseyTimoshchenko *&quot;what does it mean multi project configuration&quot;* If you have to ask you probably don&#39;t have it... ;o) https://docs.gradle.org/current/userguide/multi_project_builds.html","body":"@AlekseyTimoshchenko <i>&quot;what does it mean multi project configuration&quot;</i> If you have to ask you probably don&#39;t have it... ;o) <a href=\"https://docs.gradle.org/current/userguide/multi_project_builds.html\" rel=\"nofollow noreferrer\">docs.gradle.org/current/userguide/multi_project_builds.html</a>"},{"owner":{"account_id":4706161,"reputation":3091,"user_id":3808228,"accept_rate":60,"display_name":"Chisko"},"score":0,"creation_date":1479852538,"post_id":40742572,"comment_id":68731213,"body_markdown":"I think Instant Run has some guilt on this.","body":"I think Instant Run has some guilt on this."},{"owner":{"account_id":7378264,"reputation":4782,"user_id":5709159,"accept_rate":58,"display_name":"Sirop4ik"},"score":0,"creation_date":1479886100,"post_id":40742572,"comment_id":68741601,"body_markdown":"@Chisko what do you mean?","body":"@Chisko what do you mean?"},{"owner":{"account_id":9443335,"reputation":15252,"user_id":7023245,"accept_rate":25,"display_name":"Timothy Truckle"},"score":0,"creation_date":1479893192,"post_id":40742572,"comment_id":68745674,"body_markdown":"@AlekseyTimoshchenko did you add the dependency later in the project? did you run &quot;gradle-&gt;update project&quot; after adding mockito?","body":"@AlekseyTimoshchenko did you add the dependency later in the project? did you run &quot;gradle-&gt;update project&quot; after adding mockito?"},{"owner":{"account_id":7378264,"reputation":4782,"user_id":5709159,"accept_rate":58,"display_name":"Sirop4ik"},"score":0,"creation_date":1479894054,"post_id":40742572,"comment_id":68746243,"body_markdown":"@TimothyTruckle sorry, but where this button `gradle-&gt;update project` placed?","body":"@TimothyTruckle sorry, but where this button <code>gradle-&gt;update project</code> placed?"},{"owner":{"account_id":9443335,"reputation":15252,"user_id":7023245,"accept_rate":25,"display_name":"Timothy Truckle"},"score":0,"creation_date":1479897078,"post_id":40742572,"comment_id":68748318,"body_markdown":"@AlekseyTimoshchenko *&quot;where this button&quot;* its in the context menu of the project.","body":"@AlekseyTimoshchenko <i>&quot;where this button&quot;</i> its in the context menu of the project."},{"owner":{"account_id":7378264,"reputation":4782,"user_id":5709159,"accept_rate":58,"display_name":"Sirop4ik"},"score":0,"creation_date":1479897691,"post_id":40742572,"comment_id":68748750,"body_markdown":"@TimothyTruckle unfurtunately I don&#39;t have such button( I have looked through all studio components and eventually have not found any ....","body":"@TimothyTruckle unfurtunately I don&#39;t have such button( I have looked through all studio components and eventually have not found any ...."},{"owner":{"account_id":9443335,"reputation":15252,"user_id":7023245,"accept_rate":25,"display_name":"Timothy Truckle"},"score":0,"creation_date":1479903576,"post_id":40742572,"comment_id":68752995,"body_markdown":"@AlekseyTimoshchenko: OK, one step back: do you get the error at the command line or in your IDE?","body":"@AlekseyTimoshchenko: OK, one step back: do you get the error at the command line or in your IDE?"},{"owner":{"account_id":7378264,"reputation":4782,"user_id":5709159,"accept_rate":58,"display_name":"Sirop4ik"},"score":0,"creation_date":1479904017,"post_id":40742572,"comment_id":68753282,"body_markdown":"@TimothyTruckle eventually I have alredy solved this issue, but I am very wondering with your point of view... I got error during compilition process in IDE","body":"@TimothyTruckle eventually I have alredy solved this issue, but I am very wondering with your point of view... I got error during compilition process in IDE"},{"owner":{"account_id":3756387,"reputation":802,"user_id":3122668,"display_name":"capo11"},"score":0,"creation_date":1608652670,"post_id":40742572,"comment_id":115645342,"body_markdown":"it&#39;s incredible!! After 4 years this is still an issue!!!","body":"it&#39;s incredible!! After 4 years this is still an issue!!!"}],"answers":[{"tags":[],"owner":{"account_id":7589390,"reputation":1131,"user_id":5757486,"accept_rate":57,"display_name":"P S M"},"down_vote_count":0,"up_vote_count":7,"is_accepted":true,"score":7,"last_activity_date":1479851891,"creation_date":1479823177,"answer_id":40743833,"question_id":40742572,"body_markdown":"It looks like Gradle is not doing it&#39;s job.\r\nManually adding the jars may fixed the problem.\r\n[How to Download and Install jar go here .][1]\r\n\r\nand for download mockito use this link\r\n\r\nhttps://mvnrepository.com/artifact/org.mockito/mockito-core/1.10.19\r\n\r\n  [1]: https://github.com/junit-team/junit4/wiki/Download-and-Install","title":"Why do I get an error &quot;package org.mockito.runners does not exist&quot;?","body":"<p>It looks like Gradle is not doing it's job.\nManually adding the jars may fixed the problem.\n<a href=\"https://github.com/junit-team/junit4/wiki/Download-and-Install\" rel=\"noreferrer\">How to Download and Install jar go here .</a></p>\n\n<p>and for download mockito use this link</p>\n\n<p><a href=\"https://mvnrepository.com/artifact/org.mockito/mockito-core/1.10.19\" rel=\"noreferrer\">https://mvnrepository.com/artifact/org.mockito/mockito-core/1.10.19</a></p>\n"},{"tags":[],"owner":{"account_id":9443335,"reputation":15252,"user_id":7023245,"accept_rate":25,"display_name":"Timothy Truckle"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1479912742,"creation_date":1479912742,"answer_id":40767634,"question_id":40742572,"body_markdown":"does your project look like this?:\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/NebXk.png","title":"Why do I get an error &quot;package org.mockito.runners does not exist&quot;?","body":"<p>does your project look like this?:\n<a href=\"https://i.stack.imgur.com/NebXk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NebXk.png\" alt=\"enter image description here\"></a></p>\n"},{"tags":[],"owner":{"account_id":2316211,"reputation":2578,"user_id":2033223,"accept_rate":100,"display_name":"Javatar"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1517836963,"creation_date":1517836963,"answer_id":48623579,"question_id":40742572,"body_markdown":"Open **File** &gt; **Project Structure...**\r\n\r\nand then add it manually as *library dependency*:\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/mGNTq.png","title":"Why do I get an error &quot;package org.mockito.runners does not exist&quot;?","body":"<p>Open <strong>File</strong> > <strong>Project Structure...</strong></p>\n\n<p>and then add it manually as <em>library dependency</em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mGNTq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mGNTq.png\" alt=\"enter image description here\"></a></p>\n"},{"tags":[],"owner":{"account_id":6974943,"reputation":568,"user_id":6935910,"display_name":"Ustin"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1529591951,"creation_date":1529585154,"answer_id":50968929,"question_id":40742572,"body_markdown":"I also got this exception when I tried to write `instrumentalTests` in `src/androidTest/java/` but by default mockito&#39;s scope in dependencies is set as **Unit Test implementation** (you can see that in `File` =&gt; `Project Structure` =&gt; `Modules` =&gt; `Dependencies`). I&#39;ve just changed this parameter to **Test implementation** and it works!\r\n\r\n[![enter image description here][1]][1]\r\n\r\n  [1]: https://i.stack.imgur.com/wVdsF.png","title":"Why do I get an error &quot;package org.mockito.runners does not exist&quot;?","body":"<p>I also got this exception when I tried to write <code>instrumentalTests</code> in <code>src/androidTest/java/</code> but by default mockito's scope in dependencies is set as <strong>Unit Test implementation</strong> (you can see that in <code>File</code> => <code>Project Structure</code> => <code>Modules</code> => <code>Dependencies</code>). I've just changed this parameter to <strong>Test implementation</strong> and it works!</p>\n\n<p><a href=\"https://i.stack.imgur.com/wVdsF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wVdsF.png\" alt=\"enter image description here\"></a></p>\n"},{"tags":[],"owner":{"account_id":5574327,"reputation":29,"user_id":4418301,"display_name":"Michael  Sizonenko"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1588585004,"creation_date":1588585004,"answer_id":61589168,"question_id":40742572,"body_markdown":"Got the same issue. Attempted to implement the developer.android documentation example.\r\n\r\nFixed by changed org.mockito version to the recent at the time in build.gradle :\r\n\r\n    dependencies {\r\n        testImplementation &#39;org.mockito:mockito-core:2.28.2&#39;\r\n    }","title":"Why do I get an error &quot;package org.mockito.runners does not exist&quot;?","body":"<p>Got the same issue. Attempted to implement the developer.android documentation example.</p>\n\n<p>Fixed by changed org.mockito version to the recent at the time in build.gradle :</p>\n\n<pre><code>dependencies {\n    testImplementation 'org.mockito:mockito-core:2.28.2'\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1535921,"reputation":3060,"user_id":1431979,"display_name":"Pierre C"},"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1641396214,"creation_date":1641396214,"answer_id":70595384,"question_id":40742572,"body_markdown":"As stated in [Baeldung&#39;s article](https://www.baeldung.com/mockito-deprecated-mockitojunitrunner), starting from Mockito version `2.2.20`, the package for `MockitoJUnitRunner` has changed. So change :\r\n\r\n```java\r\nimport org.mockito.runners.MockitoJUnitRunner;\r\n```\r\nTo :\r\n\r\n    import org.mockito.junit.MockitoJUnitRunner;\r\n\r\nAs usual, you have to import the `mockito-core` library in your `build.gradle` :\r\n\r\n    dependencies {\r\n        testImplementation &#39;org.mockito:mockito-core:4.2.0&#39;\r\n    }\r\n\r\nAs a side note, you will also need to change import for `Matchers` if you use them. For instance :\r\n\r\nFrom :\r\n\r\n    import static org.mockito.Matchers.any;\r\n\r\nTo :\r\n\r\n    import static org.mockito.Mockito.any;","title":"Why do I get an error &quot;package org.mockito.runners does not exist&quot;?","body":"<p>As stated in <a href=\"https://www.baeldung.com/mockito-deprecated-mockitojunitrunner\" rel=\"noreferrer\">Baeldung's article</a>, starting from Mockito version <code>2.2.20</code>, the package for <code>MockitoJUnitRunner</code> has changed. So change :</p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.mockito.runners.MockitoJUnitRunner;\n</code></pre>\n<p>To :</p>\n<pre><code>import org.mockito.junit.MockitoJUnitRunner;\n</code></pre>\n<p>As usual, you have to import the <code>mockito-core</code> library in your <code>build.gradle</code> :</p>\n<pre><code>dependencies {\n    testImplementation 'org.mockito:mockito-core:4.2.0'\n}\n</code></pre>\n<p>As a side note, you will also need to change import for <code>Matchers</code> if you use them. For instance :</p>\n<p>From :</p>\n<pre><code>import static org.mockito.Matchers.any;\n</code></pre>\n<p>To :</p>\n<pre><code>import static org.mockito.Mockito.any;\n</code></pre>\n"}],"owner":{"account_id":7378264,"reputation":4782,"user_id":5709159,"accept_rate":58,"display_name":"Sirop4ik"},"comment_count":22,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":29552,"favorite_count":0,"down_vote_count":0,"up_vote_count":14,"accepted_answer_id":40743833,"answer_count":6,"score":14,"last_activity_date":1641396214,"creation_date":1479819694,"question_id":40742572,"body_markdown":"I have pluged up require dependency\r\n\r\n    testCompile &#39;org.mockito:mockito-core:1.10.19&#39;\r\n\r\nThen I put my test code to `/src/test/java/` directory \r\n\r\nthen I have tried launch such test\r\n\r\n    import org.junit.Test;\r\n    import static org.hamcrest.CoreMatchers.is;\r\n    import static org.hamcrest.MatcherAssert.assertThat;\r\n\r\n    public class PresenterActivityAcceptNotAcceptTest {\r\n\r\n    @Test\r\n    public void emailValidator_CorrectEmailSimple_ReturnsTrue() {\r\n        boolean dd = true;\r\n        assertThat(dd, is(true));\r\n    } \r\n\r\nit works properly, but if I add anything witch associated with `Mock` lib \r\n\r\nfor example `@RunWith`\r\n\r\n        import org.junit.Test;\r\n        import org.junit.runner.RunWith;\r\n        import org.mockito.runners.MockitoJUnitRunner;\r\n    \r\n        import static org.hamcrest.CoreMatchers.is;\r\n        import static org.hamcrest.MatcherAssert.assertThat;\r\n    \r\n    @RunWith(MockitoJUnitRunner.class)\r\n    public class PresenterActivityAcceptNotAcceptTest {\r\n    \r\n    \r\n        @Test\r\n        public void emailValidator_CorrectEmailSimple_ReturnsTrue() {\r\n            boolean dd = true;\r\n            assertThat(dd, is(true));\r\n        }\r\n\r\nI got such error\r\n\r\n    Error:Execution failed for task   &#39;:Application:compileDebugJavaWithJavac&#39;.\r\n    &gt; Compilation failed; see the compiler error output for details.\r\n    Error:(10, 10) error: cannot find symbol class MockitoJUnitRunner\r\n    Error:(5, 27) error: package org.mockito.runners does not exist\r\n    /home/aleksey/Downloads/NTZ/FittingRoom/Application/src/test/java/com/fittingroom/newtimezone/presenters/PresenterActivityAcceptNotAcceptTest.java\r\n\r\nWhat am I doing wrong? \r\n\r\nIf I forger about something feel free to ask\r\n\r\nThanks in advance!\r\n\r\n\r\n","title":"Why do I get an error &quot;package org.mockito.runners does not exist&quot;?","body":"<p>I have pluged up require dependency</p>\n\n<pre><code>testCompile 'org.mockito:mockito-core:1.10.19'\n</code></pre>\n\n<p>Then I put my test code to <code>/src/test/java/</code> directory </p>\n\n<p>then I have tried launch such test</p>\n\n<pre><code>import org.junit.Test;\nimport static org.hamcrest.CoreMatchers.is;\nimport static org.hamcrest.MatcherAssert.assertThat;\n\npublic class PresenterActivityAcceptNotAcceptTest {\n\n@Test\npublic void emailValidator_CorrectEmailSimple_ReturnsTrue() {\n    boolean dd = true;\n    assertThat(dd, is(true));\n} \n</code></pre>\n\n<p>it works properly, but if I add anything witch associated with <code>Mock</code> lib </p>\n\n<p>for example <code>@RunWith</code></p>\n\n<pre><code>    import org.junit.Test;\n    import org.junit.runner.RunWith;\n    import org.mockito.runners.MockitoJUnitRunner;\n\n    import static org.hamcrest.CoreMatchers.is;\n    import static org.hamcrest.MatcherAssert.assertThat;\n\n@RunWith(MockitoJUnitRunner.class)\npublic class PresenterActivityAcceptNotAcceptTest {\n\n\n    @Test\n    public void emailValidator_CorrectEmailSimple_ReturnsTrue() {\n        boolean dd = true;\n        assertThat(dd, is(true));\n    }\n</code></pre>\n\n<p>I got such error</p>\n\n<pre><code>Error:Execution failed for task   ':Application:compileDebugJavaWithJavac'.\n&gt; Compilation failed; see the compiler error output for details.\nError:(10, 10) error: cannot find symbol class MockitoJUnitRunner\nError:(5, 27) error: package org.mockito.runners does not exist\n/home/aleksey/Downloads/NTZ/FittingRoom/Application/src/test/java/com/fittingroom/newtimezone/presenters/PresenterActivityAcceptNotAcceptTest.java\n</code></pre>\n\n<p>What am I doing wrong? </p>\n\n<p>If I forger about something feel free to ask</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["java","apache-kafka","spring-cloud-stream"],"comments":[{"owner":{"account_id":2671330,"reputation":183376,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":1,"creation_date":1641395731,"post_id":70595164,"comment_id":124794441,"body_markdown":"Yes, frequent rebalances cause poor performance. Ideally, Kafka Connect is used to write to databases","body":"Yes, frequent rebalances cause poor performance. Ideally, Kafka Connect is used to write to databases"}],"answers":[{"tags":[],"owner":{"account_id":1288095,"reputation":169326,"user_id":1240763,"display_name":"Gary Russell"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1641395950,"creation_date":1641395950,"answer_id":70595304,"question_id":70595164,"body_markdown":"Increase `max.poll.interval` and/or decrease `max.poll.records` (Kafka consumer properties).","title":"Spring-cloud-stream-kafka -- Getting frequent &quot;Attempt to heartbeat failed since group is rebalancing&quot;","body":"<p>Increase <code>max.poll.interval</code> and/or decrease <code>max.poll.records</code> (Kafka consumer properties).</p>\n"}],"owner":{"account_id":16362432,"reputation":155,"user_id":11817672,"display_name":"APK"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1657,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":70595304,"answer_count":1,"score":1,"last_activity_date":1641395950,"creation_date":1641395371,"question_id":70595164,"body_markdown":"I have a spring boot application, running with 25 instances, have 25 partitions.\r\nIt consume the message and do some calculation by getting the data from cache and put the resultant value into database.\r\n\r\nBut the performance is very poor for that app, even with these many instances, **CPU usages are very high.**\r\nMax time taken per transaction is 6-8s, average time --&gt; 700ms\r\n\r\nIn Splunk, IN A MINUTE, I see this `message: [Consumer clientId=consumer-2, groupId=TEST] Attempt to heartbeat failed since group is rebalancing\r\n     thread_name: kafka-coordinator-heartbeat-thread | CG.LOGICALINVENTORY-TEST` around 200 times. \r\n\r\nMy question is, Why do I get this message frequently??\r\nand can this(getting frequent rebalance) cause the poor performance.\r\n\r\nAny thoughts??  ","title":"Spring-cloud-stream-kafka -- Getting frequent &quot;Attempt to heartbeat failed since group is rebalancing&quot;","body":"<p>I have a spring boot application, running with 25 instances, have 25 partitions.\nIt consume the message and do some calculation by getting the data from cache and put the resultant value into database.</p>\n<p>But the performance is very poor for that app, even with these many instances, <strong>CPU usages are very high.</strong>\nMax time taken per transaction is 6-8s, average time --&gt; 700ms</p>\n<p>In Splunk, IN A MINUTE, I see this <code>message: [Consumer clientId=consumer-2, groupId=TEST] Attempt to heartbeat failed since group is rebalancing thread_name: kafka-coordinator-heartbeat-thread | CG.LOGICALINVENTORY-TEST</code> around 200 times.</p>\n<p>My question is, Why do I get this message frequently??\nand can this(getting frequent rebalance) cause the poor performance.</p>\n<p>Any thoughts??</p>\n"},{"tags":["java","android","firebase","firebase-realtime-database"],"comments":[{"owner":{"account_id":2671330,"reputation":183376,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":0,"creation_date":1641393974,"post_id":70594787,"comment_id":124793637,"body_markdown":"Where is `user` variable defined? Why is the child data you&#39;re trying to set static for all users?","body":"Where is <code>user</code> variable defined? Why is the child data you&#39;re trying to set static for all users?"},{"owner":{"account_id":23420907,"reputation":64,"user_id":17481130,"display_name":"VondeTaconadis"},"score":0,"creation_date":1641394020,"post_id":70594787,"comment_id":124793656,"body_markdown":"It&#39;s a parameter of this function. It&#39;s a class that contains email,password,username,uid","body":"It&#39;s a parameter of this function. It&#39;s a class that contains email,password,username,uid"},{"owner":{"account_id":2671330,"reputation":183376,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":0,"creation_date":1641394200,"post_id":70594787,"comment_id":124793736,"body_markdown":"You should ideally define `mDatabase` outside of the user creation callback. Besides that, `mDatabase.child(&quot;users&quot;).child(&quot;test&quot;).setValue` has nothing to do with user creation, so you should debug that in isolation. For example, does it correctly write the value on just a button click?","body":"You should ideally define <code>mDatabase</code> outside of the user creation callback. Besides that, <code>mDatabase.child(&quot;users&quot;).child(&quot;test&quot;).setValue</code> has nothing to do with user creation, so you should debug that in isolation. For example, does it correctly write the value on just a button click?"},{"owner":{"account_id":23420907,"reputation":64,"user_id":17481130,"display_name":"VondeTaconadis"},"score":1,"creation_date":1641394813,"post_id":70594787,"comment_id":124794018,"body_markdown":"@OneCricketeer so I&#39;ve tried it and it has the same previous behaviour. I&#39;ve added a failure listener and it does nothing","body":"@OneCricketeer so I&#39;ve tried it and it has the same previous behaviour. I&#39;ve added a failure listener and it does nothing"},{"owner":{"account_id":2671330,"reputation":183376,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":0,"creation_date":1641394902,"post_id":70594787,"comment_id":124794051,"body_markdown":"Does `users/test`path exist in the database?","body":"Does <code>users&#47;test</code>path exist in the database?"},{"owner":{"account_id":23420907,"reputation":64,"user_id":17481130,"display_name":"VondeTaconadis"},"score":0,"creation_date":1641395139,"post_id":70594787,"comment_id":124794157,"body_markdown":"@OneCricketeer No, I can&#39;t add empty field in realtime database. Does it work like firestore database where you can put the path and if it doesen&#39;t exist, it will make the missing folders?","body":"@OneCricketeer No, I can&#39;t add empty field in realtime database. Does it work like firestore database where you can put the path and if it doesen&#39;t exist, it will make the missing folders?"},{"owner":{"account_id":2671330,"reputation":183376,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":0,"creation_date":1641395545,"post_id":70594787,"comment_id":124794357,"body_markdown":"Paths are overwritten, if they exist, but if there&#39;s nothing there, shouldn&#39;t be a problem. Is there a specific reason you&#39;re using `&quot;test&quot;` rather than the user ID, as shown in the docs? https://firebase.google.com/docs/database/android/read-and-write","body":"Paths are overwritten, if they exist, but if there&#39;s nothing there, shouldn&#39;t be a problem. Is there a specific reason you&#39;re using <code>&quot;test&quot;</code> rather than the user ID, as shown in the docs? <a href=\"https://firebase.google.com/docs/database/android/read-and-write\" rel=\"nofollow noreferrer\">firebase.google.com/docs/database/android/read-and-write</a>"},{"owner":{"account_id":23420907,"reputation":64,"user_id":17481130,"display_name":"VondeTaconadis"},"score":1,"creation_date":1641395766,"post_id":70594787,"comment_id":124794458,"body_markdown":"@OneCricketeer yes because at first I was using uid but it didn&#39;t work and for trying to see what was wrong I tryied a static path for check if it was the writing on Realtime database the problem","body":"@OneCricketeer yes because at first I was using uid but it didn&#39;t work and for trying to see what was wrong I tryied a static path for check if it was the writing on Realtime database the problem"},{"owner":{"account_id":72426,"reputation":573714,"user_id":209103,"accept_rate":73,"display_name":"Frank van Puffelen"},"score":1,"creation_date":1641395912,"post_id":70594787,"comment_id":124794522,"body_markdown":"If neither of the callbacks fires, it typically means the client is not connected to the database server. Can you check the logcat output for messages when you call `setValue` (or otherwise when you first access the database)?","body":"If neither of the callbacks fires, it typically means the client is not connected to the database server. Can you check the logcat output for messages when you call <code>setValue</code> (or otherwise when you first access the database)?"},{"owner":{"account_id":23420907,"reputation":64,"user_id":17481130,"display_name":"VondeTaconadis"},"score":0,"creation_date":1641396495,"post_id":70594787,"comment_id":124794790,"body_markdown":"@FrankvanPuffelen I&#39;ve cheked the logcat when pressing the button but I don&#39;t see any message regarding the setValue or firebase","body":"@FrankvanPuffelen I&#39;ve cheked the logcat when pressing the button but I don&#39;t see any message regarding the setValue or firebase"},{"owner":{"account_id":6819231,"reputation":132841,"user_id":5246885,"accept_rate":78,"display_name":"Alex Mamo"},"score":0,"creation_date":1641396556,"post_id":70594787,"comment_id":124794814,"body_markdown":"Is any of the Toast messages displayed?","body":"Is any of the Toast messages displayed?"},{"owner":{"account_id":23420907,"reputation":64,"user_id":17481130,"display_name":"VondeTaconadis"},"score":0,"creation_date":1641397665,"post_id":70594787,"comment_id":124795345,"body_markdown":"@FrankvanPuffelen so I added a value on the database manually and I tried to read it. I get this error: E/firebase: Error getting data\n    java.lang.Exception: Client is offline . But I can create accounts on firestore so I don&#39;t know why it gives this error","body":"@FrankvanPuffelen so I added a value on the database manually and I tried to read it. I get this error: E/firebase: Error getting data     java.lang.Exception: Client is offline . But I can create accounts on firestore so I don&#39;t know why it gives this error"},{"owner":{"account_id":72426,"reputation":573714,"user_id":209103,"accept_rate":73,"display_name":"Frank van Puffelen"},"score":1,"creation_date":1641398463,"post_id":70594787,"comment_id":124795733,"body_markdown":"My guess is that you downloaded the `google-services.json` file before the database was created, which means the database URL that the SDK uses is incorrect. If that is indeed the cause, download the updated `google-services.json` and add it to your project, **or** put the database URL in your code in `FirebaseDatabase.getInstance(&quot;URL to your databse here&quot;).getReference()`. Also see: https://stackoverflow.com/a/69198094","body":"My guess is that you downloaded the <code>google-services.json</code> file before the database was created, which means the database URL that the SDK uses is incorrect. If that is indeed the cause, download the updated <code>google-services.json</code> and add it to your project, <b>or</b> put the database URL in your code in <code>FirebaseDatabase.getInstance(&quot;URL to your databse here&quot;).getReference()</code>. Also see: <a href=\"https://stackoverflow.com/a/69198094\">stackoverflow.com/a/69198094</a>"},{"owner":{"account_id":23420907,"reputation":64,"user_id":17481130,"display_name":"VondeTaconadis"},"score":0,"creation_date":1641399494,"post_id":70594787,"comment_id":124796162,"body_markdown":"@FrankvanPuffelen yes, now I&#39;ve changed the google-services.json with the new and inside the file I see the correct url to the database, but when in my application I try to log print it, it is still the previous one","body":"@FrankvanPuffelen yes, now I&#39;ve changed the google-services.json with the new and inside the file I see the correct url to the database, but when in my application I try to log print it, it is still the previous one"},{"owner":{"account_id":23420907,"reputation":64,"user_id":17481130,"display_name":"VondeTaconadis"},"score":2,"creation_date":1641399946,"post_id":70594787,"comment_id":124796343,"body_markdown":"EDIT: I&#39;ve cleaned and rebuilt my Android project and now it gives me the correct url. Now it works thanks","body":"EDIT: I&#39;ve cleaned and rebuilt my Android project and now it gives me the correct url. Now it works thanks"}],"owner":{"account_id":23420907,"reputation":64,"user_id":17481130,"display_name":"VondeTaconadis"},"comment_count":15,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":43,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1641400498,"answer_count":0,"score":0,"last_activity_date":1641395789,"creation_date":1641393742,"question_id":70594787,"body_markdown":"I&#39;m trying to write some data on my Realtime Database on Android Studio with Java.\r\nMy goal is to create and user and then add user information in Realtime Database.\r\nI can create the User but when I&#39;m trying to write on the Realtime Database nothing happen.\r\nI&#39;ve add a onSuccess and onFailure listener to the function that set the data, but both of th listener doesen&#39;t run.\r\n\r\nCode:\r\n\r\n    mAuth.createUserWithEmailAndPassword(user.getEmail(), user.getPassword())\r\n        .addOnCompleteListener(this, new OnCompleteListener&lt;AuthResult&gt;() {\r\n            @Override\r\n            public void onComplete(@NonNull Task&lt;AuthResult&gt; task) {\r\n                if (task.isSuccessful()) {\r\n                    Toast.makeText(RegisterActivity.this, &quot;Account creato!&quot;,\r\n                            Toast.LENGTH_SHORT).show();\r\n\r\n\r\n                    FirebaseUser currentUser = mAuth.getCurrentUser();\r\n                    user.setUid(currentUser.getUid());\r\n                    //I add to RealTime Databse other User data\r\n                    DatabaseReference mDatabase = FirebaseDatabase.getInstance().getReference();\r\n                    mDatabase.child(&quot;users&quot;).child(&quot;test&quot;).setValue(&quot;hey&quot;).addOnSuccessListener(new OnSuccessListener&lt;Void&gt;() {\r\n                        @Override\r\n                        public void onSuccess(Void aVoid) {\r\n                            Log.i(&quot;Works&quot;,&quot;Yes&quot;);\r\n                            Toast.makeText(RegisterActivity.this,&quot;It orks&quot;,Toast.LENGTH_LONG).show();\r\n\r\n                        }\r\n                    }).addOnFailureListener(new OnFailureListener() {\r\n                        @Override\r\n                        public void onFailure(@NonNull Exception e) {\r\n                            // Write failed\r\n                            Log.e(&quot;ErrorAdding&quot;,e.getMessage());\r\n                            Toast.makeText(RegisterActivity.this,e.getMessage(),Toast.LENGTH_LONG).show();\r\n                        }\r\n                    });\r\n\r\n                    //finish();\r\n\r\n                } else {\r\n                    // If sign in fails, display a message to the user.\r\n                    Log.w(&quot;CREATEUSER&quot;, &quot;createUserWithEmail:failure&quot;, task.getException());\r\n                    Toast.makeText(RegisterActivity.this, &quot;Authentication failed.&quot;,\r\n                            Toast.LENGTH_SHORT).show();\r\n\r\n                }\r\n            }\r\n        });\r\n\r\nI&#39;m sure the user is created because the toast with &quot;Account creato&quot; shows up and in firebase I can see the account added.\r\n\r\nThis is my Realtime database rules:\r\n\r\n    \r\n\r\n        {\r\n      &quot;rules&quot;: {\r\n        &quot;.read&quot;: &quot;true&quot;,  // 2022-2-4\r\n        &quot;.write&quot;: &quot;true&quot;,  // 2022-2-4\r\n      }\r\n    }\r\n\r\nThanks for your help!\r\n","title":"Can&#39;t write on Realtime Database","body":"<p>I'm trying to write some data on my Realtime Database on Android Studio with Java.\nMy goal is to create and user and then add user information in Realtime Database.\nI can create the User but when I'm trying to write on the Realtime Database nothing happen.\nI've add a onSuccess and onFailure listener to the function that set the data, but both of th listener doesen't run.</p>\n<p>Code:</p>\n<pre><code>mAuth.createUserWithEmailAndPassword(user.getEmail(), user.getPassword())\n    .addOnCompleteListener(this, new OnCompleteListener&lt;AuthResult&gt;() {\n        @Override\n        public void onComplete(@NonNull Task&lt;AuthResult&gt; task) {\n            if (task.isSuccessful()) {\n                Toast.makeText(RegisterActivity.this, &quot;Account creato!&quot;,\n                        Toast.LENGTH_SHORT).show();\n\n\n                FirebaseUser currentUser = mAuth.getCurrentUser();\n                user.setUid(currentUser.getUid());\n                //I add to RealTime Databse other User data\n                DatabaseReference mDatabase = FirebaseDatabase.getInstance().getReference();\n                mDatabase.child(&quot;users&quot;).child(&quot;test&quot;).setValue(&quot;hey&quot;).addOnSuccessListener(new OnSuccessListener&lt;Void&gt;() {\n                    @Override\n                    public void onSuccess(Void aVoid) {\n                        Log.i(&quot;Works&quot;,&quot;Yes&quot;);\n                        Toast.makeText(RegisterActivity.this,&quot;It orks&quot;,Toast.LENGTH_LONG).show();\n\n                    }\n                }).addOnFailureListener(new OnFailureListener() {\n                    @Override\n                    public void onFailure(@NonNull Exception e) {\n                        // Write failed\n                        Log.e(&quot;ErrorAdding&quot;,e.getMessage());\n                        Toast.makeText(RegisterActivity.this,e.getMessage(),Toast.LENGTH_LONG).show();\n                    }\n                });\n\n                //finish();\n\n            } else {\n                // If sign in fails, display a message to the user.\n                Log.w(&quot;CREATEUSER&quot;, &quot;createUserWithEmail:failure&quot;, task.getException());\n                Toast.makeText(RegisterActivity.this, &quot;Authentication failed.&quot;,\n                        Toast.LENGTH_SHORT).show();\n\n            }\n        }\n    });\n</code></pre>\n<p>I'm sure the user is created because the toast with &quot;Account creato&quot; shows up and in firebase I can see the account added.</p>\n<p>This is my Realtime database rules:</p>\n<pre><code>    {\n  &quot;rules&quot;: {\n    &quot;.read&quot;: &quot;true&quot;,  // 2022-2-4\n    &quot;.write&quot;: &quot;true&quot;,  // 2022-2-4\n  }\n}\n</code></pre>\n<p>Thanks for your help!</p>\n"},{"tags":["java","spring","inheritance","spring-restcontroller","request-mapping"],"answers":[{"tags":[],"owner":{"account_id":4668137,"reputation":6228,"user_id":9681755,"display_name":"Dirk Deyne"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1641395768,"creation_date":1641392123,"answer_id":70594378,"question_id":70594053,"body_markdown":"Yes, that is possible\r\n\r\n```java\r\n@RestController\r\n@RequestMapping(&quot;/a/{a}/b/{b}&quot;)\r\nclass Parent{\r\n}\r\n\r\n@RestController\r\nclass Child extends Parent{\r\n \r\n // take over pathvariables from parent\r\n @GetMapping(&quot;/c/{c}&quot;)\r\n public String abc(@PathVariable String a,@PathVariable String b, @PathVariable String c) {\r\n\t\treturn a+b+c;\r\n }\r\n \r\n // ignore pathvariables from parent\r\n @GetMapping(&quot;/d/{d}&quot;)\r\n public String d(@PathVariable String d){\r\n  return d;\r\n }\r\n\r\n}\r\n\r\n```\r\n\r\nJust take over the `@Pathvaribles` of the Parent-class\r\n\r\nThen a request like http://localhost:8080/a/x/b/y/c/z\r\nwill return &quot;xyz&quot;\r\n\r\nAnd a request like http://localhost:8080/a/ignore-a/b/ignore-b/d/capure-d\r\nwill return &quot;capure-d&quot;","title":"Access @PathVariables from parent&#39;s @RequestMapping","body":"<p>Yes, that is possible</p>\n<pre class=\"lang-java prettyprint-override\"><code>@RestController\n@RequestMapping(&quot;/a/{a}/b/{b}&quot;)\nclass Parent{\n}\n\n@RestController\nclass Child extends Parent{\n \n // take over pathvariables from parent\n @GetMapping(&quot;/c/{c}&quot;)\n public String abc(@PathVariable String a,@PathVariable String b, @PathVariable String c) {\n        return a+b+c;\n }\n \n // ignore pathvariables from parent\n @GetMapping(&quot;/d/{d}&quot;)\n public String d(@PathVariable String d){\n  return d;\n }\n\n}\n\n</code></pre>\n<p>Just take over the <code>@Pathvaribles</code> of the Parent-class</p>\n<p>Then a request like http://localhost:8080/a/x/b/y/c/z\nwill return &quot;xyz&quot;</p>\n<p>And a request like http://localhost:8080/a/ignore-a/b/ignore-b/d/capure-d\nwill return &quot;capure-d&quot;</p>\n"}],"owner":{"account_id":3201670,"reputation":91,"user_id":2703609,"accept_rate":100,"display_name":"just_do_IT"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":192,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":70594378,"answer_count":1,"score":1,"last_activity_date":1641395768,"creation_date":1641390797,"question_id":70594053,"body_markdown":"I&#39;m trying to access the @PathVariables defined in &quot;MyClass&quot;&#39;s @RequestMapping parent. \r\nSimplified screnario:\r\n\r\n    @RestController\r\n    @RequestMapping(value = &quot;some/path/{with}/{multiple}/{variables}&quot;)\r\n    public class ParentClass {...}\r\n\r\nThis class is sort of a product&#39;s base class and should not be edited. Therefore I&#39;m extending &#39;ParentClass&#39;. In &#39;MyClass&#39; I want to do something like this:\r\n\r\n    @GetMapping(&quot;/{another}&quot;)\r\n    public Object get(@PathVariable(&quot;another&quot;) String another) {...}\r\n\r\nI think this is allowed (didn&#39;t test yet), but I don&#39;t see how I would get all PathVariables that are already defined with &#39;ParentClass&#39;.\r\n\r\nAny idea/ RTFM reference on that is very much appreciated.\r\n\r\n","title":"Access @PathVariables from parent&#39;s @RequestMapping","body":"<p>I'm trying to access the @PathVariables defined in &quot;MyClass&quot;'s @RequestMapping parent.\nSimplified screnario:</p>\n<pre><code>@RestController\n@RequestMapping(value = &quot;some/path/{with}/{multiple}/{variables}&quot;)\npublic class ParentClass {...}\n</code></pre>\n<p>This class is sort of a product's base class and should not be edited. Therefore I'm extending 'ParentClass'. In 'MyClass' I want to do something like this:</p>\n<pre><code>@GetMapping(&quot;/{another}&quot;)\npublic Object get(@PathVariable(&quot;another&quot;) String another) {...}\n</code></pre>\n<p>I think this is allowed (didn't test yet), but I don't see how I would get all PathVariables that are already defined with 'ParentClass'.</p>\n<p>Any idea/ RTFM reference on that is very much appreciated.</p>\n"},{"tags":["java","talend"],"comments":[{"owner":{"account_id":2070005,"reputation":1845,"user_id":1844706,"accept_rate":79,"display_name":"Andreas Hartmann"},"score":0,"creation_date":1640255989,"post_id":70460862,"comment_id":124553701,"body_markdown":"What do you mean by &quot;yesterday&#39;s date files&quot;? You mean files created yesterday?","body":"What do you mean by &quot;yesterday&#39;s date files&quot;? You mean files created yesterday?"},{"owner":{"account_id":22287500,"reputation":11,"user_id":16514897,"display_name":"Kavya Chowdary"},"score":0,"creation_date":1640256315,"post_id":70460862,"comment_id":124553828,"body_markdown":"Yes files created yesterday..","body":"Yes files created yesterday.."},{"owner":{"account_id":2070005,"reputation":1845,"user_id":1844706,"accept_rate":79,"display_name":"Andreas Hartmann"},"score":0,"creation_date":1640256441,"post_id":70460862,"comment_id":124553863,"body_markdown":"Are they named or arranged in a certain way, or is the only indicator you have that they were created yesterday their creation timestamp of the file system?\nYou can get yesterdays date itself with LocalDate.now().minusDays(1).format(DateTimeFormatter.ISO_DATE)","body":"Are they named or arranged in a certain way, or is the only indicator you have that they were created yesterday their creation timestamp of the file system? You can get yesterdays date itself with LocalDate.now().minusDays(1).format(DateTimeFormatter.ISO_DA&zwnj;&#8203;TE)"}],"answers":[{"tags":[],"owner":{"account_id":4009589,"reputation":1,"user_id":3303392,"display_name":"ChicagoTang"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641387023,"creation_date":1641387023,"answer_id":70593159,"question_id":70460862,"body_markdown":"Use tFileExist and tFlowToIterate to check and loop all the files.","title":"How to get yesterday&#39;s date all files by using Talend?","body":"<p>Use tFileExist and tFlowToIterate to check and loop all the files.</p>\n"}],"owner":{"account_id":22287500,"reputation":11,"user_id":16514897,"display_name":"Kavya Chowdary"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":225,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641395582,"creation_date":1640255588,"question_id":70460862,"body_markdown":"I have tried like this, I&#39;m adding \r\n\r\n```\r\nTalendDate.compareDate(row1.filepath, context.myStartDate, &#39;yyyy-Mm-dd&#39;)&gt;0 &amp;&amp; TalendDate.comparDate(row1.filepath, context.EndDate, &#39;yyyy-Mm-dd&#39;)&lt;3\r\n```\r\n\r\nAdding like this in `tMap`\r\n\r\nCan anyone help me to get yesterday&#39;s date files by using `Talend`?\r\n\r\nIs there any other way to do this ?\r\n\r\n  [1]: https://i.stack.imgur.com/GObqB.jpg","title":"How to get yesterday&#39;s date all files by using Talend?","body":"<p>I have tried like this, I'm adding</p>\n<pre><code>TalendDate.compareDate(row1.filepath, context.myStartDate, 'yyyy-Mm-dd')&gt;0 &amp;&amp; TalendDate.comparDate(row1.filepath, context.EndDate, 'yyyy-Mm-dd')&lt;3\n</code></pre>\n<p>Adding like this in <code>tMap</code></p>\n<p>Can anyone help me to get yesterday's date files by using <code>Talend</code>?</p>\n<p>Is there any other way to do this ?</p>\n"},{"tags":["java","precision"],"comments":[{"owner":{"account_id":162699,"reputation":138060,"user_id":3788176,"accept_rate":54,"display_name":"Andy Turner"},"score":0,"creation_date":1574753944,"post_id":59045859,"comment_id":104332999,"body_markdown":"Practically, unless you are comparing dates 2 billion years in the past or the future, this isn&#39;t an actual issue. If you must, use `toIntExact`, but otherwise just suppress it.","body":"Practically, unless you are comparing dates 2 billion years in the past or the future, this isn&#39;t an actual issue. If you must, use <code>toIntExact</code>, but otherwise just suppress it."}],"answers":[{"tags":[],"owner":{"account_id":8536015,"reputation":2201,"user_id":6397798,"accept_rate":60,"display_name":"bracco23"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1574756400,"creation_date":1574756400,"answer_id":59046495,"question_id":59045859,"body_markdown":"As expressed by @AndyTurner in the comment, the problem is in the cast from `long` to `int`, which could result in an erroneous calculation.\r\n\r\nPossible workarounds are changing the return type to `long`, which could lead to just moving the cast in a different place, or using `toIntExact`.\r\n\r\nThe different with a plain old cast is that, if the `long` does not actually fit into an `int`, `toIntExact` raises a `ArithmeticException`","title":"CWE-681: Avoid numerical data corruption during incompatible mutation in Java","body":"<p>As expressed by @AndyTurner in the comment, the problem is in the cast from <code>long</code> to <code>int</code>, which could result in an erroneous calculation.</p>\n\n<p>Possible workarounds are changing the return type to <code>long</code>, which could lead to just moving the cast in a different place, or using <code>toIntExact</code>.</p>\n\n<p>The different with a plain old cast is that, if the <code>long</code> does not actually fit into an <code>int</code>, <code>toIntExact</code> raises a <code>ArithmeticException</code></p>\n"}],"owner":{"account_id":17180072,"reputation":393,"user_id":12435623,"display_name":"not-a-bug"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":824,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":59046495,"answer_count":1,"score":0,"last_activity_date":1641395445,"creation_date":1574753727,"question_id":59045859,"body_markdown":"I am getting an error called &quot;Avoid numerical data corruption during incompatible mutation&quot; according to CISQ standard and CAST scan tools. Below is the sample code. Any idea how to avoid this??\r\n\r\n```\r\n public int getage() {\r\n\t  return (int) ChronoUnit.YEARS.between(getdob(), LocalDate.now());\r\n}\r\n```\r\n`I tried using JAVA 8 toIntExact of java.Math.toIntExact but I am not sure how different is this.`\r\n\r\n```\r\nreturn toIntExact(ChronoUnit.YEARS.between(LocalDate.of(2014,1, 1), LocalDate.now()));\r\n```","title":"CWE-681: Avoid numerical data corruption during incompatible mutation in Java","body":"<p>I am getting an error called &quot;Avoid numerical data corruption during incompatible mutation&quot; according to CISQ standard and CAST scan tools. Below is the sample code. Any idea how to avoid this??</p>\n<pre><code> public int getage() {\n      return (int) ChronoUnit.YEARS.between(getdob(), LocalDate.now());\n}\n</code></pre>\n<p><code>I tried using JAVA 8 toIntExact of java.Math.toIntExact but I am not sure how different is this.</code></p>\n<pre><code>return toIntExact(ChronoUnit.YEARS.between(LocalDate.of(2014,1, 1), LocalDate.now()));\n</code></pre>\n"},{"tags":["java","logging","log4j"],"comments":[{"owner":{"account_id":7946,"reputation":5117,"user_id":14009,"display_name":"Arthur Thomas"},"score":0,"creation_date":1221680850,"post_id":86878,"comment_id":11728,"body_markdown":"can you show what you have done so far so people can review?","body":"can you show what you have done so far so people can review?"},{"owner":{"account_id":327,"reputation":5871,"user_id":410,"display_name":"cynicalman"},"score":0,"creation_date":1221680883,"post_id":86878,"comment_id":7294084,"body_markdown":"This can&#39;t be answered without seeing the contents of the classpath including the configuration file you think is being used.","body":"This can&#39;t be answered without seeing the contents of the classpath including the configuration file you think is being used."},{"owner":{"account_id":8365,"reputation":1493,"user_id":15045,"accept_rate":29,"display_name":"Petr Macek"},"score":0,"creation_date":1221681297,"post_id":86878,"comment_id":11746,"body_markdown":"Yep, I will. But in the morning (now I am too tired)","body":"Yep, I will. But in the morning (now I am too tired)"}],"answers":[{"tags":[],"owner":{"account_id":8810,"reputation":1137,"user_id":16023,"accept_rate":50,"display_name":"Asgeir S. Nilsen"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1221681034,"creation_date":1221681034,"answer_id":86928,"question_id":86878,"body_markdown":"Two things:  Check additivity and decide whether you want log events captured by more detailed levels of logging to propagate to the root logger.\r\n\r\nSecondly, check the level for the root logger.  In addition you can also add filtering on the appender itself, but this should normally not be necessary.","title":"Why is the root logger collecting all log types regardless the configuration?","body":"<p>Two things:  Check additivity and decide whether you want log events captured by more detailed levels of logging to propagate to the root logger.</p>\n\n<p>Secondly, check the level for the root logger.  In addition you can also add filtering on the appender itself, but this should normally not be necessary.</p>\n"},{"tags":[],"owner":{"account_id":4487,"reputation":2649,"user_id":6770,"accept_rate":26,"display_name":"James A. N. Stauffer"},"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1221682357,"creation_date":1221682357,"answer_id":87123,"question_id":86878,"body_markdown":"Run your program with -Dlog4j.debug so that standard out gets info about how log4j is configured -- I suspected that it isn&#39;t configured the way that you think it is.","title":"Why is the root logger collecting all log types regardless the configuration?","body":"<p>Run your program with -Dlog4j.debug so that standard out gets info about how log4j is configured -- I suspected that it isn't configured the way that you think it is.</p>\n"},{"tags":[],"owner":{"account_id":3001,"reputation":138707,"user_id":4249,"accept_rate":84,"display_name":"matt b"},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1221682563,"creation_date":1221682563,"answer_id":87151,"question_id":86878,"body_markdown":"To add on to what James A. N. Stauffer and cynicalman said - I would bet that there is another log4j.xml / log4j.properties on your classpath other than the one you wish to be used that is causing log4j to configure itself the way it is.\r\n\r\n`-Dlog4j.debug` is an absolute killer way to troubleshoot any log4j issues.","title":"Why is the root logger collecting all log types regardless the configuration?","body":"<p>To add on to what James A. N. Stauffer and cynicalman said - I would bet that there is another log4j.xml / log4j.properties on your classpath other than the one you wish to be used that is causing log4j to configure itself the way it is.</p>\n\n<p><code>-Dlog4j.debug</code> is an absolute killer way to troubleshoot any log4j issues.</p>\n"},{"tags":[],"owner":{"account_id":7670,"reputation":34993,"user_id":13379,"accept_rate":86,"display_name":"Michael"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1221685413,"creation_date":1221685413,"answer_id":87644,"question_id":86878,"body_markdown":"If you are using a `log4j.properties` file, this file is typically expected to be in the root of your classpath, so make sure it&#39;s there.","title":"Why is the root logger collecting all log types regardless the configuration?","body":"<p>If you are using a <code>log4j.properties</code> file, this file is typically expected to be in the root of your classpath, so make sure it's there.</p>\n"},{"tags":[],"owner":{"account_id":131470,"reputation":51,"user_id":331498,"display_name":"JCaptain"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1272898709,"creation_date":1272898709,"answer_id":2758952,"question_id":86878,"body_markdown":"This is correct behavior. The root logger is like the default behavior. So if you don&#39;t specify any logger it will take root logger level as the default level but this does not mean that root logger level is the level for all your logs.\r\n\r\nAny of your code which logs using &#39;TraceLogger&#39;logger or &#39;org.springframework.ws.server.endpoint.interceptor&#39; logger will log messages using TRACE and DEBUG level respectively any other code will use root logger to log message using level, which is in your case ERROR.\r\n\r\nSo if you use logger other than root, root log level will be overridden by that logger&#39;s log level. To get the desired output change the other two log level to ERROR.\r\n\r\nI hope this is helpful. ","title":"Why is the root logger collecting all log types regardless the configuration?","body":"<p>This is correct behavior. The root logger is like the default behavior. So if you don't specify any logger it will take root logger level as the default level but this does not mean that root logger level is the level for all your logs.</p>\n\n<p>Any of your code which logs using 'TraceLogger'logger or 'org.springframework.ws.server.endpoint.interceptor' logger will log messages using TRACE and DEBUG level respectively any other code will use root logger to log message using level, which is in your case ERROR.</p>\n\n<p>So if you use logger other than root, root log level will be overridden by that logger's log level. To get the desired output change the other two log level to ERROR.</p>\n\n<p>I hope this is helpful. </p>\n"},{"tags":[],"owner":{"account_id":41200,"reputation":3669,"user_id":119693,"accept_rate":50,"display_name":"monzonj"},"down_vote_count":0,"up_vote_count":76,"is_accepted":false,"score":76,"last_activity_date":1374024529,"creation_date":1281687785,"answer_id":3475120,"question_id":86878,"body_markdown":"The root logger resides at the top of the logger hierarchy. It is exceptional in three ways:\r\n\r\n - it always exists,\r\n - its level cannot be set to null\r\n - it cannot be retrieved by name.\r\n\r\n**The rootLogger is the father of all appenders. Each enabled logging request for a given logger will be forwarded to all the appenders in that logger as well as the appenders higher in the hierarchy (including rootLogger)**\r\n\r\nFor example, if the `console` appender is added to the `root logger`, then all enabled logging requests will **at least** print on the console. If in addition a file appender is added to a logger, say `L`, then enabled logging requests for `L` and `L&#39;s` children will print on a file **and** on the `console`. It is possible to override this default behavior so that appender accumulation is no longer additive **by setting the additivity flag to false**.\r\n\r\n*From the log4j manual*\r\n\r\n\r\n\r\nTo sum up:\r\n\r\nIf you want not to propagate a logging event to the parents loggers (say rootLogger) then add the additivity flag to false in those loggers. In your case:\r\n\r\n&lt;!-- language: xml --&gt;\r\n\r\n    &lt;logger name=&quot;org.springframework.ws.server.endpoint.interceptor&quot;\r\n            additivity=&quot;false&quot;&gt;\r\n            &lt;level value=&quot;DEBUG&quot; /&gt;\r\n            &lt;appender-ref ref=&quot;payloadAppender&quot; /&gt;\r\n    &lt;/logger&gt;\r\n\r\nIn standard log4j config style (which I prefer to XML):\r\n\r\n    log4j.logger.org.springframework.ws.server.endpoint.interceptor = INFO, payloadAppender\r\n    log4j.additivity.org.springframework.ws.server.endpoint.interceptor = false\r\n\r\n\r\nHope this helps.\r\n\r\n\r\n","title":"Why is the root logger collecting all log types regardless the configuration?","body":"<p>The root logger resides at the top of the logger hierarchy. It is exceptional in three ways:</p>\n\n<ul>\n<li>it always exists,</li>\n<li>its level cannot be set to null</li>\n<li>it cannot be retrieved by name.</li>\n</ul>\n\n<p><strong>The rootLogger is the father of all appenders. Each enabled logging request for a given logger will be forwarded to all the appenders in that logger as well as the appenders higher in the hierarchy (including rootLogger)</strong></p>\n\n<p>For example, if the <code>console</code> appender is added to the <code>root logger</code>, then all enabled logging requests will <strong>at least</strong> print on the console. If in addition a file appender is added to a logger, say <code>L</code>, then enabled logging requests for <code>L</code> and <code>L's</code> children will print on a file <strong>and</strong> on the <code>console</code>. It is possible to override this default behavior so that appender accumulation is no longer additive <strong>by setting the additivity flag to false</strong>.</p>\n\n<p><em>From the log4j manual</em></p>\n\n<p>To sum up:</p>\n\n<p>If you want not to propagate a logging event to the parents loggers (say rootLogger) then add the additivity flag to false in those loggers. In your case:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;logger name=\"org.springframework.ws.server.endpoint.interceptor\"\n        additivity=\"false\"&gt;\n        &lt;level value=\"DEBUG\" /&gt;\n        &lt;appender-ref ref=\"payloadAppender\" /&gt;\n&lt;/logger&gt;\n</code></pre>\n\n<p>In standard log4j config style (which I prefer to XML):</p>\n\n<pre><code>log4j.logger.org.springframework.ws.server.endpoint.interceptor = INFO, payloadAppender\nlog4j.additivity.org.springframework.ws.server.endpoint.interceptor = false\n</code></pre>\n\n<p>Hope this helps.</p>\n"}],"owner":{"account_id":8365,"reputation":1493,"user_id":15045,"accept_rate":29,"display_name":"Petr Macek"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":74201,"favorite_count":0,"down_vote_count":0,"up_vote_count":41,"answer_count":6,"score":41,"last_activity_date":1641395184,"creation_date":1221680748,"question_id":86878,"body_markdown":"I am having problem that even though I specify the level to ERROR in the root tag, the specified appender logs all levels (debug, info, warn) to the file regardless the settings. I am not a Log4j expert so any help is appreciated.\r\n\r\nI have checked the classpath for log4j.properties (there is none) except the log4j.xml.\r\n\r\nHere is the log4j.xml file:\r\n\r\n&lt;!-- language: xml --&gt;\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;\r\n    &lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&gt;\r\n    &lt;log4j:configuration xmlns:log4j=&#39;http://jakarta.apache.org/log4j/&#39;&gt;\r\n    \r\n    \r\n    \t&lt;!-- ============================== --&gt;\r\n    \t&lt;!-- Append messages to the console --&gt;\r\n    \t&lt;!-- ============================== --&gt;\r\n    \r\n    \r\n    \t&lt;appender name=&quot;console&quot; class=&quot;org.apache.log4j.ConsoleAppender&quot;&gt;\r\n    \t\t&lt;param name=&quot;Target&quot; value=&quot;System.out&quot; /&gt;\r\n    \r\n    \t\t&lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;\r\n    \t\t\t&lt;!-- The default pattern: Date Priority [Category] Message\\n --&gt;\r\n    \t\t\t&lt;param name=&quot;ConversionPattern&quot; value=&quot;[AC - %5p] [%d{ISO8601}] [%t] [%c{1} - %L] %m%n&quot; /&gt;\r\n    \t\t&lt;/layout&gt;\r\n    \t&lt;/appender&gt;\r\n    \r\n    \t&lt;appender name=&quot;logfile&quot; class=&quot;org.apache.log4j.RollingFileAppender&quot;&gt;\r\n    \t\t&lt;param name=&quot;File&quot; value=&quot;./logs/server.log&quot; /&gt;\r\n    \t\t&lt;param name=&quot;MaxFileSize&quot; value=&quot;1000KB&quot; /&gt;\r\n    \t\t&lt;param name=&quot;MaxBackupIndex&quot; value=&quot;2&quot; /&gt;\r\n    \t\t&lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;\r\n    \t\t\t&lt;param name=&quot;ConversionPattern&quot; value=&quot;[AC - %-5p] {%d{dd.MM.yyyy - HH.mm.ss}} %m%n&quot; /&gt;\r\n    \t\t&lt;/layout&gt;\r\n    \t&lt;/appender&gt;\r\n    \r\n    \t&lt;appender name=&quot;payloadAppender&quot; class=&quot;org.apache.log4j.RollingFileAppender&quot;&gt;\r\n    \t\t&lt;param name=&quot;File&quot; value=&quot;./logs/payload.log&quot; /&gt;\r\n    \t\t&lt;param name=&quot;MaxFileSize&quot; value=&quot;1000KB&quot; /&gt;\r\n    \t\t&lt;param name=&quot;MaxBackupIndex&quot; value=&quot;10&quot; /&gt;\r\n    \t\t&lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;\r\n    \t\t\t&lt;param name=&quot;ConversionPattern&quot; value=&quot;[AC - %-5p] {%d{dd.MM.yyyy - HH.mm.ss}} %m%n&quot; /&gt;\r\n    \t\t&lt;/layout&gt;\r\n    \t&lt;/appender&gt;\r\n    \r\n    \t&lt;appender name=&quot;errorLog&quot; class=&quot;org.apache.log4j.RollingFileAppender&quot;&gt;\r\n    \t\t&lt;param name=&quot;File&quot; value=&quot;./logs/error.log&quot; /&gt;\r\n    \t\t&lt;param name=&quot;MaxFileSize&quot; value=&quot;1000KB&quot; /&gt;\r\n    \t\t&lt;param name=&quot;MaxBackupIndex&quot; value=&quot;10&quot; /&gt;\r\n    \t\t&lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;\r\n    \t\t\t&lt;param name=&quot;ConversionPattern&quot; value=&quot;[AC - %-5p] {%d{dd.MM.yyyy - HH.mm.ss}} %m%n&quot; /&gt;\r\n    \t\t&lt;/layout&gt;\r\n    \t&lt;/appender&gt;\r\n    \r\n    \t&lt;appender name=&quot;traceLog&quot;\r\n    \t\tclass=&quot;org.apache.log4j.RollingFileAppender&quot;&gt;\r\n    \t\t&lt;param name=&quot;File&quot; value=&quot;./logs/trace.log&quot; /&gt;\r\n    \t\t&lt;param name=&quot;MaxFileSize&quot; value=&quot;1000KB&quot; /&gt;\r\n    \t\t&lt;param name=&quot;MaxBackupIndex&quot; value=&quot;20&quot; /&gt;\r\n    \r\n    \t\t&lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;\r\n    \t\t\t&lt;param name=&quot;ConversionPattern&quot;\r\n    \t\t\t\tvalue=&quot;[AccessControl - %-5p] {%t: %d{dd.MM.yyyy - HH.mm.ss,SSS}} %m%n&quot; /&gt;\r\n    \t\t&lt;/layout&gt;\r\n    \t&lt;/appender&gt;\r\n    \r\n    \t&lt;appender name=&quot;traceSocketAppender&quot; class=&quot;org.apache.log4j.net.SocketAppender&quot;&gt;\r\n    \t\t&lt;param name=&quot;remoteHost&quot; value=&quot;localhost&quot; /&gt;\r\n    \t\t&lt;param name=&quot;port&quot; value=&quot;4445&quot; /&gt;\r\n    \t\t&lt;param name=&quot;locationInfo&quot; value=&quot;true&quot; /&gt;\r\n    \t&lt;/appender&gt;\r\n    \r\n    \t&lt;logger name=&quot;TraceLogger&quot;&gt;\r\n    \t\t&lt;level value=&quot;trace&quot; /&gt; &lt;!-- Set level to trace to activate tracing --&gt;\r\n    \t\t&lt;appender-ref ref=&quot;traceLog&quot; /&gt;\t\t\r\n    \t&lt;/logger&gt;\r\n    \r\n    \t&lt;logger name=&quot;org.springframework.ws.server.endpoint.interceptor&quot;&gt;\r\n    \t\t&lt;level value=&quot;DEBUG&quot; /&gt;\r\n    \t\t&lt;appender-ref ref=&quot;payloadAppender&quot; /&gt;\r\n    \t&lt;/logger&gt;\r\n    \r\n    \t&lt;root&gt;\r\n    \t\t&lt;level value=&quot;error&quot; /&gt;\r\n    \t\t&lt;appender-ref ref=&quot;errorLog&quot; /&gt;\r\n    \t&lt;/root&gt;\r\n    \r\n    &lt;/log4j:configuration&gt;\r\n\r\nIf I replace the root with another logger, then nothing gets logged at all to the specified appender.\r\n\r\n&lt;!-- language: xml --&gt;\r\n\r\n    &lt;logger name=&quot;com.mydomain.logic&quot;&gt;\r\n        &lt;level value=&quot;error&quot; /&gt;\r\n        &lt;appender-ref ref=&quot;errorLog&quot; /&gt;\r\n    &lt;/logger&gt;\r\n\r\n\r\n\r\n","title":"Why is the root logger collecting all log types regardless the configuration?","body":"<p>I am having problem that even though I specify the level to ERROR in the root tag, the specified appender logs all levels (debug, info, warn) to the file regardless the settings. I am not a Log4j expert so any help is appreciated.</p>\n<p>I have checked the classpath for log4j.properties (there is none) except the log4j.xml.</p>\n<p>Here is the log4j.xml file:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;\n&lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&gt;\n&lt;log4j:configuration xmlns:log4j='http://jakarta.apache.org/log4j/'&gt;\n\n\n    &lt;!-- ============================== --&gt;\n    &lt;!-- Append messages to the console --&gt;\n    &lt;!-- ============================== --&gt;\n\n\n    &lt;appender name=&quot;console&quot; class=&quot;org.apache.log4j.ConsoleAppender&quot;&gt;\n        &lt;param name=&quot;Target&quot; value=&quot;System.out&quot; /&gt;\n\n        &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;\n            &lt;!-- The default pattern: Date Priority [Category] Message\\n --&gt;\n            &lt;param name=&quot;ConversionPattern&quot; value=&quot;[AC - %5p] [%d{ISO8601}] [%t] [%c{1} - %L] %m%n&quot; /&gt;\n        &lt;/layout&gt;\n    &lt;/appender&gt;\n\n    &lt;appender name=&quot;logfile&quot; class=&quot;org.apache.log4j.RollingFileAppender&quot;&gt;\n        &lt;param name=&quot;File&quot; value=&quot;./logs/server.log&quot; /&gt;\n        &lt;param name=&quot;MaxFileSize&quot; value=&quot;1000KB&quot; /&gt;\n        &lt;param name=&quot;MaxBackupIndex&quot; value=&quot;2&quot; /&gt;\n        &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;\n            &lt;param name=&quot;ConversionPattern&quot; value=&quot;[AC - %-5p] {%d{dd.MM.yyyy - HH.mm.ss}} %m%n&quot; /&gt;\n        &lt;/layout&gt;\n    &lt;/appender&gt;\n\n    &lt;appender name=&quot;payloadAppender&quot; class=&quot;org.apache.log4j.RollingFileAppender&quot;&gt;\n        &lt;param name=&quot;File&quot; value=&quot;./logs/payload.log&quot; /&gt;\n        &lt;param name=&quot;MaxFileSize&quot; value=&quot;1000KB&quot; /&gt;\n        &lt;param name=&quot;MaxBackupIndex&quot; value=&quot;10&quot; /&gt;\n        &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;\n            &lt;param name=&quot;ConversionPattern&quot; value=&quot;[AC - %-5p] {%d{dd.MM.yyyy - HH.mm.ss}} %m%n&quot; /&gt;\n        &lt;/layout&gt;\n    &lt;/appender&gt;\n\n    &lt;appender name=&quot;errorLog&quot; class=&quot;org.apache.log4j.RollingFileAppender&quot;&gt;\n        &lt;param name=&quot;File&quot; value=&quot;./logs/error.log&quot; /&gt;\n        &lt;param name=&quot;MaxFileSize&quot; value=&quot;1000KB&quot; /&gt;\n        &lt;param name=&quot;MaxBackupIndex&quot; value=&quot;10&quot; /&gt;\n        &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;\n            &lt;param name=&quot;ConversionPattern&quot; value=&quot;[AC - %-5p] {%d{dd.MM.yyyy - HH.mm.ss}} %m%n&quot; /&gt;\n        &lt;/layout&gt;\n    &lt;/appender&gt;\n\n    &lt;appender name=&quot;traceLog&quot;\n        class=&quot;org.apache.log4j.RollingFileAppender&quot;&gt;\n        &lt;param name=&quot;File&quot; value=&quot;./logs/trace.log&quot; /&gt;\n        &lt;param name=&quot;MaxFileSize&quot; value=&quot;1000KB&quot; /&gt;\n        &lt;param name=&quot;MaxBackupIndex&quot; value=&quot;20&quot; /&gt;\n\n        &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;\n            &lt;param name=&quot;ConversionPattern&quot;\n                value=&quot;[AccessControl - %-5p] {%t: %d{dd.MM.yyyy - HH.mm.ss,SSS}} %m%n&quot; /&gt;\n        &lt;/layout&gt;\n    &lt;/appender&gt;\n\n    &lt;appender name=&quot;traceSocketAppender&quot; class=&quot;org.apache.log4j.net.SocketAppender&quot;&gt;\n        &lt;param name=&quot;remoteHost&quot; value=&quot;localhost&quot; /&gt;\n        &lt;param name=&quot;port&quot; value=&quot;4445&quot; /&gt;\n        &lt;param name=&quot;locationInfo&quot; value=&quot;true&quot; /&gt;\n    &lt;/appender&gt;\n\n    &lt;logger name=&quot;TraceLogger&quot;&gt;\n        &lt;level value=&quot;trace&quot; /&gt; &lt;!-- Set level to trace to activate tracing --&gt;\n        &lt;appender-ref ref=&quot;traceLog&quot; /&gt;     \n    &lt;/logger&gt;\n\n    &lt;logger name=&quot;org.springframework.ws.server.endpoint.interceptor&quot;&gt;\n        &lt;level value=&quot;DEBUG&quot; /&gt;\n        &lt;appender-ref ref=&quot;payloadAppender&quot; /&gt;\n    &lt;/logger&gt;\n\n    &lt;root&gt;\n        &lt;level value=&quot;error&quot; /&gt;\n        &lt;appender-ref ref=&quot;errorLog&quot; /&gt;\n    &lt;/root&gt;\n\n&lt;/log4j:configuration&gt;\n</code></pre>\n<p>If I replace the root with another logger, then nothing gets logged at all to the specified appender.</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;logger name=&quot;com.mydomain.logic&quot;&gt;\n    &lt;level value=&quot;error&quot; /&gt;\n    &lt;appender-ref ref=&quot;errorLog&quot; /&gt;\n&lt;/logger&gt;\n</code></pre>\n"},{"tags":["java","apache-kafka","kafka-consumer-api","kafka-topic"],"answers":[{"tags":[],"owner":{"account_id":2671330,"reputation":183376,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1641395046,"creation_date":1641394697,"answer_id":70595017,"question_id":70594911,"body_markdown":"It does alert; in the logs you&#39;ll see info messages including `UNKNOWN_TOPIC_OR_PARTITION`\r\n\r\nIt&#39;s not a fatal exception. The consumer will continue to fetch cluster metadata and wait until the topic exists, and then poll it when it does.\r\n\r\nIf you&#39;d like to have spring create the topic, make a NewTopic bean for it.\r\n\r\nIf you&#39;d like to check for topic existence, and throw your own exception, use an AdminClient and the describeTopics method ","title":"Why doesn&#39;t a KafkaConsumer throw an error when a non-existing topic is assigned?","body":"<p>It does alert; in the logs you'll see info messages including <code>UNKNOWN_TOPIC_OR_PARTITION</code></p>\n<p>It's not a fatal exception. The consumer will continue to fetch cluster metadata and wait until the topic exists, and then poll it when it does.</p>\n<p>If you'd like to have spring create the topic, make a NewTopic bean for it.</p>\n<p>If you'd like to check for topic existence, and throw your own exception, use an AdminClient and the describeTopics method</p>\n"}],"owner":{"account_id":3682527,"reputation":8791,"user_id":3067148,"accept_rate":74,"display_name":"Harold L. Brown"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1087,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":70595017,"answer_count":1,"score":1,"last_activity_date":1641395046,"creation_date":1641394251,"question_id":70594911,"body_markdown":"I have written a `KafkaConsumer`. The configuration looks like this:\r\n\r\n      @Bean\r\n      Map&lt;String, Object&gt; consumerConfig(\r\n          @Value(&quot;${spring.kafka.bootstrap-servers}&quot;) String bootstrapServers) {\r\n        return Map.of(\r\n            ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG,\r\n            bootstrapServers,\r\n            ConsumerConfig.AUTO_OFFSET_RESET_CONFIG,\r\n            &quot;earliest&quot;,\r\n            ConsumerConfig.ALLOW_AUTO_CREATE_TOPICS_CONFIG,\r\n            false,\r\n            ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG,\r\n            StringDeserializer.class,\r\n            ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG,\r\n            StringDeserializer.class);\r\n      }\r\n\r\nWhen I assign a topic that does not exist to the `KafkaConsumer`, no error is thrown. This is the code:\r\n\r\n    var topicPartition = new TopicPartition(&quot;75757584959595943&quot;, key);\r\n    var partitions = Set.of(topicPartition);\r\n    consumer.assign(partitions);\r\n    for (var records = consumer.poll(Duration.ZERO); !records.isEmpty(); ) {\r\n      // ...\r\n\r\n\r\nWhy does the `KafkaConsumer` not alert me about a non-existing topic? Wouldn&#39;t this be helpful?\r\n\r\n","title":"Why doesn&#39;t a KafkaConsumer throw an error when a non-existing topic is assigned?","body":"<p>I have written a <code>KafkaConsumer</code>. The configuration looks like this:</p>\n<pre><code>  @Bean\n  Map&lt;String, Object&gt; consumerConfig(\n      @Value(&quot;${spring.kafka.bootstrap-servers}&quot;) String bootstrapServers) {\n    return Map.of(\n        ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG,\n        bootstrapServers,\n        ConsumerConfig.AUTO_OFFSET_RESET_CONFIG,\n        &quot;earliest&quot;,\n        ConsumerConfig.ALLOW_AUTO_CREATE_TOPICS_CONFIG,\n        false,\n        ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG,\n        StringDeserializer.class,\n        ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG,\n        StringDeserializer.class);\n  }\n</code></pre>\n<p>When I assign a topic that does not exist to the <code>KafkaConsumer</code>, no error is thrown. This is the code:</p>\n<pre><code>var topicPartition = new TopicPartition(&quot;75757584959595943&quot;, key);\nvar partitions = Set.of(topicPartition);\nconsumer.assign(partitions);\nfor (var records = consumer.poll(Duration.ZERO); !records.isEmpty(); ) {\n  // ...\n</code></pre>\n<p>Why does the <code>KafkaConsumer</code> not alert me about a non-existing topic? Wouldn't this be helpful?</p>\n"},{"tags":["java","spring-boot","groovy","spring-cloud-contract"],"answers":[{"tags":[],"owner":{"account_id":1976110,"reputation":10792,"user_id":1773866,"display_name":"Marcin Grzejszczak"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1619604395,"creation_date":1619604395,"answer_id":67298115,"question_id":67295698,"body_markdown":"&gt; I call the getResponseForFindTeamRolesByFilters() at the response in order to generate a dynamic response from the server. \r\n\r\nYou should not do it. Contract tests should not access the database.\r\n\r\nFor the consumer you should do\r\n\r\n    request {\r\n            method &quot;POST&quot;\r\n            url &quot;api/team/findTeamRolesByFilters&quot;\r\n            headers {\r\n                contentType applicationJson()\r\n                accept applicationJson()\r\n                header&quot;Authorization&quot;, execute(&#39;bearerOfAccessToken()&#39;)\r\n            }\r\n            body $(producer(execute(&#39;getRequestForFindTeamRolesByFilters()&#39;)), consumer(&quot;some value to be put on the consumer side&quot;))\r\n        }\r\n\r\n\r\nFor the producer\r\n\r\n    response {\r\n        status OK()\r\n        headers {\r\n            contentType applicationJson()\r\n        }\r\n        body $(producer(execute(&#39;getResponseForFindTeamRolesByFilters()&#39;)), consumer(&quot;something in the stub&quot;))\r\n    }\r\n\r\n\r\n\r\n","title":"Spring Cloud Contract, body and execute method is not validating the response","body":"<blockquote>\n<p>I call the getResponseForFindTeamRolesByFilters() at the response in order to generate a dynamic response from the server.</p>\n</blockquote>\n<p>You should not do it. Contract tests should not access the database.</p>\n<p>For the consumer you should do</p>\n<pre><code>request {\n        method &quot;POST&quot;\n        url &quot;api/team/findTeamRolesByFilters&quot;\n        headers {\n            contentType applicationJson()\n            accept applicationJson()\n            header&quot;Authorization&quot;, execute('bearerOfAccessToken()')\n        }\n        body $(producer(execute('getRequestForFindTeamRolesByFilters()')), consumer(&quot;some value to be put on the consumer side&quot;))\n    }\n</code></pre>\n<p>For the producer</p>\n<pre><code>response {\n    status OK()\n    headers {\n        contentType applicationJson()\n    }\n    body $(producer(execute('getResponseForFindTeamRolesByFilters()')), consumer(&quot;something in the stub&quot;))\n}\n</code></pre>\n"}],"owner":{"account_id":5708667,"reputation":1501,"user_id":4511375,"accept_rate":100,"display_name":"Investigator"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":972,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":67298115,"answer_count":1,"score":0,"last_activity_date":1641394872,"creation_date":1619594983,"question_id":67295698,"body_markdown":"I have the following spring cloud contract:\r\n\r\n    package contracts.teams\r\n    \r\n    import org.springframework.cloud.contract.spec.Contract\r\n    \r\n    Contract.make {\r\n        name&quot;d Find team roles by filters&quot;\r\n        description &quot;Find team roles by filters&quot;\r\n    \r\n        request {\r\n            method &quot;POST&quot;\r\n            url &quot;api/team/findTeamRolesByFilters&quot;\r\n            headers {\r\n                contentType applicationJson()\r\n                accept applicationJson()\r\n                header&quot;Authorization&quot;, execute(&#39;bearerOfAccessToken()&#39;)\r\n            }\r\n            body execute(&#39;getRequestForFindTeamRolesByFilters()&#39;)\r\n        }\r\n    \r\n        response {\r\n            status OK()\r\n            headers {\r\n                contentType applicationJson()\r\n            }\r\n            body execute(&#39;getResponseForFindTeamRolesByFilters()&#39;)\r\n        }\r\n    }\r\n\r\nI call the **getResponseForFindTeamRolesByFilters()** at the response in order to generate a dynamic response from the server. The reason could for example be an auto generated id that is coming from the DB.\r\nThe generated string from the **getResponseForFindTeamRolesByFilters()** is a valid JSON that unfortunately is ignored and returns always true when the test run.\r\n\r\nI have noticed this when I replace the execute method with a static response like the following one:\r\n\r\n    &quot;&quot;&quot;\r\n    {\r\n       &quot;success&quot;: &quot;false&quot;\r\n    }\r\n    &quot;&quot;&quot;\r\n\r\nIn this case the response is being validated correctly and fails the test in case it does not match.\r\nWhat I said is being confirmed by the test generated code as it can be seen here:\r\n\r\n    // then:\r\n    \t\t\tassertThat(response.statusCode()).isEqualTo(200);\r\n    \t\t\tassertThat(response.header(&quot;Content-Type&quot;)).matches(&quot;application/json.*&quot;);\r\n    \r\n    \t\t// and:\r\n    \t\t\tDocumentContext parsedJson = JsonPath.parse(response.getBody().asString());\r\n    \t\t\tgetResponseForFindTeamRolesByFilters();\r\n\r\nAs you can see there is no assertion. It simply calls the method that generates the json.\r\n\r\nHow am I supposed to make the test check the dynamic json response?\r\nThank you!","title":"Spring Cloud Contract, body and execute method is not validating the response","body":"<p>I have the following spring cloud contract:</p>\n<pre><code>package contracts.teams\n\nimport org.springframework.cloud.contract.spec.Contract\n\nContract.make {\n    name&quot;d Find team roles by filters&quot;\n    description &quot;Find team roles by filters&quot;\n\n    request {\n        method &quot;POST&quot;\n        url &quot;api/team/findTeamRolesByFilters&quot;\n        headers {\n            contentType applicationJson()\n            accept applicationJson()\n            header&quot;Authorization&quot;, execute('bearerOfAccessToken()')\n        }\n        body execute('getRequestForFindTeamRolesByFilters()')\n    }\n\n    response {\n        status OK()\n        headers {\n            contentType applicationJson()\n        }\n        body execute('getResponseForFindTeamRolesByFilters()')\n    }\n}\n</code></pre>\n<p>I call the <strong>getResponseForFindTeamRolesByFilters()</strong> at the response in order to generate a dynamic response from the server. The reason could for example be an auto generated id that is coming from the DB.\nThe generated string from the <strong>getResponseForFindTeamRolesByFilters()</strong> is a valid JSON that unfortunately is ignored and returns always true when the test run.</p>\n<p>I have noticed this when I replace the execute method with a static response like the following one:</p>\n<pre><code>&quot;&quot;&quot;\n{\n   &quot;success&quot;: &quot;false&quot;\n}\n&quot;&quot;&quot;\n</code></pre>\n<p>In this case the response is being validated correctly and fails the test in case it does not match.\nWhat I said is being confirmed by the test generated code as it can be seen here:</p>\n<pre><code>// then:\n            assertThat(response.statusCode()).isEqualTo(200);\n            assertThat(response.header(&quot;Content-Type&quot;)).matches(&quot;application/json.*&quot;);\n\n        // and:\n            DocumentContext parsedJson = JsonPath.parse(response.getBody().asString());\n            getResponseForFindTeamRolesByFilters();\n</code></pre>\n<p>As you can see there is no assertion. It simply calls the method that generates the json.</p>\n<p>How am I supposed to make the test check the dynamic json response?\nThank you!</p>\n"},{"tags":["java","discord-jda"],"answers":[{"tags":[],"owner":{"account_id":14719989,"reputation":5877,"user_id":10630900,"display_name":"Minn"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1641394611,"creation_date":1641394611,"answer_id":70594995,"question_id":70592656,"body_markdown":"GuildMessageReceiveEvent has been removed and replaced by `MessageReceivedEvent` in JDA 5+. To only handle guild messages you just check `event.isFromGuild()` in your event:\r\n\r\n```java\r\npublic void onMessageReceived(MessageReceivedEvent event) {\r\n  if (!event.isFromGuild()) return;\r\n  ...\r\n}\r\n```","title":"Why i don&#39;t have GuildMessageReceivedEvent?","body":"<p>GuildMessageReceiveEvent has been removed and replaced by <code>MessageReceivedEvent</code> in JDA 5+. To only handle guild messages you just check <code>event.isFromGuild()</code> in your event:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public void onMessageReceived(MessageReceivedEvent event) {\n  if (!event.isFromGuild()) return;\n  ...\n}\n</code></pre>\n"}],"owner":{"account_id":23828069,"reputation":23,"user_id":17840582,"display_name":"Del"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1274,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":70594995,"answer_count":1,"score":2,"last_activity_date":1641394871,"creation_date":1641384634,"question_id":70592656,"body_markdown":"I&#39;m making discord bot and i need make a commands like &quot;kick&quot; but JDA has only MessageReceiveEvent. I checked in docs and its says in jda has GuildMessageReceiveEvent but code only says about MessageReceivedEvent.","title":"Why i don&#39;t have GuildMessageReceivedEvent?","body":"<p>I'm making discord bot and i need make a commands like &quot;kick&quot; but JDA has only MessageReceiveEvent. I checked in docs and its says in jda has GuildMessageReceiveEvent but code only says about MessageReceivedEvent.</p>\n"},{"tags":["javascript","java","reactjs","spring-boot","upload"],"answers":[{"tags":[],"owner":{"account_id":7952557,"reputation":926,"user_id":7060976,"display_name":"Vishnu Sajeev"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1641394869,"creation_date":1641394869,"answer_id":70595059,"question_id":70594513,"body_markdown":"In your `onFileChangeHandler` function you are setting the file to the `selectedFile` state and then immediately access it again like \r\n\r\n    formData.append(&#39;file&#39;, this.state.selectedFile);\r\nYou cannot set something to the react state and access it again on the next line, this is because `setState` works asynchronously in react. Which means if you want to get the latest set value from react state, you need to wait for the next re-render to happen. Otherwise you will only get the previously set value from the state, and in your case its `undefined`. So in you function, pass the file data directly to the `formData`. Try the below code\r\n\r\n    onFileChangeHandler = (e) =&gt; {\r\n        e.preventDefault();\r\n        const fileData = e.target.files[0];\r\n        this.setState({\r\n            selectedFile: fileData\r\n        });\r\n        const formData = new FormData();\r\n        formData.append(&#39;file&#39;, fileData);\r\n        const USER_UPLOAD_FILE_URL = UPLOAD_FILE_URL + &quot;/&quot; + this.state.username;\r\n        fetch(USER_UPLOAD_FILE_URL, {\r\n            method: &#39;POST&#39;,\r\n            headers: {\r\n                &quot;Authorization&quot;: localStorage.getItem(&quot;token&quot;)\r\n            },\r\n            body: formData\r\n        }).then(res =&gt; {\r\n            if(res.ok) {\r\n                console.log(res.data);\r\n                alert(&quot;File uploaded successfully.&quot;)\r\n            }\r\n        });\r\n\r\n    };","title":"React - 1st file upload to Spring API doesn&#39;t work, try again and it works fine on second try?","body":"<p>In your <code>onFileChangeHandler</code> function you are setting the file to the <code>selectedFile</code> state and then immediately access it again like</p>\n<pre><code>formData.append('file', this.state.selectedFile);\n</code></pre>\n<p>You cannot set something to the react state and access it again on the next line, this is because <code>setState</code> works asynchronously in react. Which means if you want to get the latest set value from react state, you need to wait for the next re-render to happen. Otherwise you will only get the previously set value from the state, and in your case its <code>undefined</code>. So in you function, pass the file data directly to the <code>formData</code>. Try the below code</p>\n<pre><code>onFileChangeHandler = (e) =&gt; {\n    e.preventDefault();\n    const fileData = e.target.files[0];\n    this.setState({\n        selectedFile: fileData\n    });\n    const formData = new FormData();\n    formData.append('file', fileData);\n    const USER_UPLOAD_FILE_URL = UPLOAD_FILE_URL + &quot;/&quot; + this.state.username;\n    fetch(USER_UPLOAD_FILE_URL, {\n        method: 'POST',\n        headers: {\n            &quot;Authorization&quot;: localStorage.getItem(&quot;token&quot;)\n        },\n        body: formData\n    }).then(res =&gt; {\n        if(res.ok) {\n            console.log(res.data);\n            alert(&quot;File uploaded successfully.&quot;)\n        }\n    });\n\n};\n</code></pre>\n"}],"owner":{"account_id":21382966,"reputation":219,"user_id":15748566,"display_name":"devo9191"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":442,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":70595059,"answer_count":1,"score":0,"last_activity_date":1641394869,"creation_date":1641392649,"question_id":70594513,"body_markdown":"[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/L1fcg.png\r\n\r\nHello\r\n\r\nI have developed a frontend React project which requests resources and logic to a SpringBoot REST API. I recently implemented file upload, and the form I have created using React always fails on the first try, but when I click it again and upload a different file (which file is irrelevant, it&#39;s not the file causing this), it successfully uploads the file via POST with a Binary file as a payload.\r\n\r\nThe first request has a payload of &#39;undefined&#39;.\r\n\r\nReact Form:\r\n\r\n\r\n    const UPDATE_USER_URL = &#39;http://localhost:8080/users/update-user-details&#39;;\r\n    const UPLOAD_FILE_URL = &#39;http://localhost:8080/image-files&#39;;\r\n    class UpdateUserForm extends React.Component {\r\n    \r\n        constructor(props) {\r\n            super(props);\r\n            this.state = {\r\n                username: localStorage.getItem(&quot;username&quot;),\r\n                location: &quot;&quot;,\r\n                bio: &quot;&quot;\r\n            };\r\n            this.onSubmit = this.onSubmit.bind(this);\r\n    \r\n            this.handleInputChange = this.handleInputChange.bind(this);\r\n        }\r\n    \r\n        handleInputChange(event) {\r\n            const target = event.target;\r\n            const value = target.value;\r\n            const name = target.name;\r\n    \r\n            this.setState({\r\n                [name]: value\r\n            });\r\n        }\r\n    \r\n        onFileChangeHandler = (e) =&gt; {\r\n            e.preventDefault();\r\n            this.setState({\r\n                selectedFile: e.target.files[0]\r\n            });\r\n            const formData = new FormData();\r\n            formData.append(&#39;file&#39;, this.state.selectedFile);\r\n            const USER_UPLOAD_FILE_URL = UPLOAD_FILE_URL + &quot;/&quot; + this.state.username;\r\n            fetch(USER_UPLOAD_FILE_URL, {\r\n                method: &#39;POST&#39;,\r\n                headers: {\r\n                    &quot;Authorization&quot;: localStorage.getItem(&quot;token&quot;)\r\n                },\r\n                body: formData\r\n            }).then(res =&gt; {\r\n                if(res.ok) {\r\n                    console.log(res.data);\r\n                    alert(&quot;File uploaded successfully.&quot;)\r\n                }\r\n            });\r\n    \r\n        };\r\n    \r\n        onSubmit(event) {\r\n            event.preventDefault();\r\n            const payload = {\r\n                &quot;username&quot;: this.state.username,\r\n                &quot;location&quot;: this.capital_letter(this.state.location),\r\n                &quot;bio&quot;: this.state.bio\r\n            };\r\n    \r\n            fetch(UPDATE_USER_URL, {\r\n                method: &#39;PUT&#39;,\r\n                headers: {\r\n                    &quot;Accept&quot;: &quot;application/json&quot;,\r\n                    &quot;Content-Type&quot;: &quot;application/json&quot;,\r\n                    &quot;Authorization&quot;: localStorage.getItem(&quot;token&quot;)\r\n                },\r\n                body: JSON.stringify(payload)\r\n            })\r\n                .then(response =&gt; response.json())\r\n                .then((data) =&gt; {\r\n                    console.log(data);\r\n                });\r\n        }\r\n        //https://www.w3resource.com/javascript-exercises/javascript-basic-exercise-50.php\r\n        capital_letter(str) {\r\n    \r\n            str = str.split(&quot; &quot;);\r\n    \r\n            for (var i = 0, x = str.length; i &lt; x; i++) {\r\n                str[i] = str[i][0].toUpperCase() + str[i].substr(1);\r\n            }\r\n            console.log(str)\r\n            return str.join(&quot; &quot;);\r\n        }\r\n    \r\n        generateUploadUrl(username) {\r\n    \r\n        }\r\n    \r\n        render() {\r\n            return (\r\n                &lt;div className=&quot;outer-div-container&quot;&gt;\r\n                    &lt;div&gt;\r\n                &lt;AppNavbar/&gt;\r\n                &lt;div id=&quot;form-container&quot;&gt;\r\n                    &lt;div id=&quot;form-div&quot;&gt;\r\n    \r\n                        &lt;h5 id=&quot;form-heading&quot;&gt;Update Details&lt;/h5&gt;\r\n                        &lt;br /&gt;\r\n                &lt;div className=&quot;outer-div-container&quot;&gt;\r\n                &lt;form onSubmit={this.onSubmit}&gt;\r\n                    &lt;label className=&quot;form-label&quot; id=&quot;top-form-label&quot;&gt;\r\n                        Location:\r\n                        &lt;br /&gt;\r\n                        &lt;input\r\n                            className=&quot;form-input&quot;\r\n                            //Taumatawhakatangihangakoauauotamateaturipukakapikimaungahoronukupokaiwhen\r\n                            maxLength=&quot;85&quot;\r\n                            //No min length as places with 1 letter e.g: A, S.\r\n                            name=&quot;location&quot;\r\n                            type=&quot;text&quot;\r\n                            value={this.state.location}\r\n                            onChange={this.handleInputChange} /&gt;\r\n                    &lt;/label&gt;\r\n                    &lt;br /&gt;\r\n                    &lt;label className=&quot;form-label&quot;&gt;\r\n                        Bio:\r\n                        &lt;br /&gt;\r\n                        &lt;input\r\n                            className=&quot;form-input&quot;\r\n                            minLength=&quot;3&quot;\r\n                            name=&quot;bio&quot;\r\n                            type=&quot;text&quot;\r\n                            value={this.state.bio}\r\n                            onChange={this.handleInputChange} /&gt;\r\n                    &lt;/label&gt;\r\n                    &lt;label&gt;Upload Your File &lt;/label&gt;\r\n                    &lt;input type=&quot;file&quot; className=&quot;form-control&quot; name=&quot;file&quot; onChange={this.onFileChangeHandler}/&gt;\r\n    \r\n                    &lt;br /&gt;\r\n                    &lt;input id=&quot;form-submit&quot; type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;\r\n    \r\n                &lt;/form&gt;\r\n                    &lt;div className=&quot;form-group files color&quot;&gt;\r\n                            &lt;label&gt;Upload Your File &lt;/label&gt;\r\n                            &lt;input type=&quot;file&quot; className=&quot;form-control&quot; name=&quot;file&quot; onChange={this.onFileChangeHandler}/&gt;\r\n                    &lt;/div&gt;\r\n                &lt;/div&gt;\r\n                &lt;/div&gt;\r\n                    &lt;/div&gt;\r\n                &lt;/div&gt;\r\n                &lt;/div&gt;\r\n            );\r\n        }\r\n    }\r\n    export default UpdateUserForm;\r\n\r\nController:\r\n\r\n    @RestController\r\n    @RequestMapping(&quot;image-files&quot;)\r\n    @AllArgsConstructor\r\n    @CrossOrigin(&quot;*&quot;)\r\n    public class ImageFileController {\r\n        ImageFileService service;\r\n    \r\n    \r\n        @GetMapping(value = &quot;/{username}&quot;)\r\n        public byte[] downloadImageFile(@PathVariable String username) {\r\n            return service.downloadImageFile(username);\r\n        }\r\n    }\r\n\r\nAny help would be greatly appreciated, I am completely stumped, thanks.","title":"React - 1st file upload to Spring API doesn&#39;t work, try again and it works fine on second try?","body":"<p><a href=\"https://i.stack.imgur.com/L1fcg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L1fcg.png\" alt=\"enter image description here\" /></a></p>\n<p>Hello</p>\n<p>I have developed a frontend React project which requests resources and logic to a SpringBoot REST API. I recently implemented file upload, and the form I have created using React always fails on the first try, but when I click it again and upload a different file (which file is irrelevant, it's not the file causing this), it successfully uploads the file via POST with a Binary file as a payload.</p>\n<p>The first request has a payload of 'undefined'.</p>\n<p>React Form:</p>\n<pre><code>const UPDATE_USER_URL = 'http://localhost:8080/users/update-user-details';\nconst UPLOAD_FILE_URL = 'http://localhost:8080/image-files';\nclass UpdateUserForm extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            username: localStorage.getItem(&quot;username&quot;),\n            location: &quot;&quot;,\n            bio: &quot;&quot;\n        };\n        this.onSubmit = this.onSubmit.bind(this);\n\n        this.handleInputChange = this.handleInputChange.bind(this);\n    }\n\n    handleInputChange(event) {\n        const target = event.target;\n        const value = target.value;\n        const name = target.name;\n\n        this.setState({\n            [name]: value\n        });\n    }\n\n    onFileChangeHandler = (e) =&gt; {\n        e.preventDefault();\n        this.setState({\n            selectedFile: e.target.files[0]\n        });\n        const formData = new FormData();\n        formData.append('file', this.state.selectedFile);\n        const USER_UPLOAD_FILE_URL = UPLOAD_FILE_URL + &quot;/&quot; + this.state.username;\n        fetch(USER_UPLOAD_FILE_URL, {\n            method: 'POST',\n            headers: {\n                &quot;Authorization&quot;: localStorage.getItem(&quot;token&quot;)\n            },\n            body: formData\n        }).then(res =&gt; {\n            if(res.ok) {\n                console.log(res.data);\n                alert(&quot;File uploaded successfully.&quot;)\n            }\n        });\n\n    };\n\n    onSubmit(event) {\n        event.preventDefault();\n        const payload = {\n            &quot;username&quot;: this.state.username,\n            &quot;location&quot;: this.capital_letter(this.state.location),\n            &quot;bio&quot;: this.state.bio\n        };\n\n        fetch(UPDATE_USER_URL, {\n            method: 'PUT',\n            headers: {\n                &quot;Accept&quot;: &quot;application/json&quot;,\n                &quot;Content-Type&quot;: &quot;application/json&quot;,\n                &quot;Authorization&quot;: localStorage.getItem(&quot;token&quot;)\n            },\n            body: JSON.stringify(payload)\n        })\n            .then(response =&gt; response.json())\n            .then((data) =&gt; {\n                console.log(data);\n            });\n    }\n    //https://www.w3resource.com/javascript-exercises/javascript-basic-exercise-50.php\n    capital_letter(str) {\n\n        str = str.split(&quot; &quot;);\n\n        for (var i = 0, x = str.length; i &lt; x; i++) {\n            str[i] = str[i][0].toUpperCase() + str[i].substr(1);\n        }\n        console.log(str)\n        return str.join(&quot; &quot;);\n    }\n\n    generateUploadUrl(username) {\n\n    }\n\n    render() {\n        return (\n            &lt;div className=&quot;outer-div-container&quot;&gt;\n                &lt;div&gt;\n            &lt;AppNavbar/&gt;\n            &lt;div id=&quot;form-container&quot;&gt;\n                &lt;div id=&quot;form-div&quot;&gt;\n\n                    &lt;h5 id=&quot;form-heading&quot;&gt;Update Details&lt;/h5&gt;\n                    &lt;br /&gt;\n            &lt;div className=&quot;outer-div-container&quot;&gt;\n            &lt;form onSubmit={this.onSubmit}&gt;\n                &lt;label className=&quot;form-label&quot; id=&quot;top-form-label&quot;&gt;\n                    Location:\n                    &lt;br /&gt;\n                    &lt;input\n                        className=&quot;form-input&quot;\n                        //Taumatawhakatangihangakoauauotamateaturipukakapikimaungahoronukupokaiwhen\n                        maxLength=&quot;85&quot;\n                        //No min length as places with 1 letter e.g: A, S.\n                        name=&quot;location&quot;\n                        type=&quot;text&quot;\n                        value={this.state.location}\n                        onChange={this.handleInputChange} /&gt;\n                &lt;/label&gt;\n                &lt;br /&gt;\n                &lt;label className=&quot;form-label&quot;&gt;\n                    Bio:\n                    &lt;br /&gt;\n                    &lt;input\n                        className=&quot;form-input&quot;\n                        minLength=&quot;3&quot;\n                        name=&quot;bio&quot;\n                        type=&quot;text&quot;\n                        value={this.state.bio}\n                        onChange={this.handleInputChange} /&gt;\n                &lt;/label&gt;\n                &lt;label&gt;Upload Your File &lt;/label&gt;\n                &lt;input type=&quot;file&quot; className=&quot;form-control&quot; name=&quot;file&quot; onChange={this.onFileChangeHandler}/&gt;\n\n                &lt;br /&gt;\n                &lt;input id=&quot;form-submit&quot; type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;\n\n            &lt;/form&gt;\n                &lt;div className=&quot;form-group files color&quot;&gt;\n                        &lt;label&gt;Upload Your File &lt;/label&gt;\n                        &lt;input type=&quot;file&quot; className=&quot;form-control&quot; name=&quot;file&quot; onChange={this.onFileChangeHandler}/&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n            &lt;/div&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n            &lt;/div&gt;\n        );\n    }\n}\nexport default UpdateUserForm;\n</code></pre>\n<p>Controller:</p>\n<pre><code>@RestController\n@RequestMapping(&quot;image-files&quot;)\n@AllArgsConstructor\n@CrossOrigin(&quot;*&quot;)\npublic class ImageFileController {\n    ImageFileService service;\n\n\n    @GetMapping(value = &quot;/{username}&quot;)\n    public byte[] downloadImageFile(@PathVariable String username) {\n        return service.downloadImageFile(username);\n    }\n}\n</code></pre>\n<p>Any help would be greatly appreciated, I am completely stumped, thanks.</p>\n"},{"tags":["java","discord","discord-jda"],"answers":[{"tags":[],"owner":{"account_id":14719989,"reputation":5877,"user_id":10630900,"display_name":"Minn"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1641394854,"creation_date":1641394854,"answer_id":70595055,"question_id":70593897,"body_markdown":"This response means that the Discord client tried to use an old version of the command that it had cached. If you simply retype the command, it should use the updated command instead.\r\n\r\nThe cause of this behavior is from calling `upsertCommand` when you start your bot. This will *replace* the existing command and make the client cache invalid.\r\n\r\nYou can use `updateCommands().addCommands(allOfYourCommands).queue()` instead, to prevent this from happening. However, keep in mind you need to put all your commands in `addCommands(...)`, not just one at a time!","title":"Invalid command for interaction application","body":"<p>This response means that the Discord client tried to use an old version of the command that it had cached. If you simply retype the command, it should use the updated command instead.</p>\n<p>The cause of this behavior is from calling <code>upsertCommand</code> when you start your bot. This will <em>replace</em> the existing command and make the client cache invalid.</p>\n<p>You can use <code>updateCommands().addCommands(allOfYourCommands).queue()</code> instead, to prevent this from happening. However, keep in mind you need to put all your commands in <code>addCommands(...)</code>, not just one at a time!</p>\n"}],"owner":{"account_id":23637796,"reputation":79,"user_id":17668557,"display_name":"michel929"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":996,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":70595055,"answer_count":1,"score":1,"last_activity_date":1641394854,"creation_date":1641390230,"question_id":70593897,"body_markdown":"I register an SlashCommand... but it answered &quot;Invalid command for interaction application&quot; Can somebody help...\r\n\r\n```\r\n @Override\r\n    public void onSlashCommand(SlashCommandEvent event) {\r\n\r\n        if (event.getName().equals(&quot;login&quot;)) {\r\n\r\n            EmbedBuilder buil = new EmbedBuilder();\r\n            buil.setColor(Color.RED);\r\n            buil.appendDescription(&quot;Du hast deinen DiscordAccount noch nicht mit dem TurnierSystem verkn&#252;pft... Benutze ?connect um die Accounts zu verkn&#252;pfen.&quot;);\r\n            buil.setAuthor(&quot;TurnierSystem&quot;);\r\n            buil.setTitle(&quot;Discord Login (Fehler)&quot;);\r\n\r\n           event.replyEmbeds(buil.build()).queue();\r\n\r\n        }\r\n```","title":"Invalid command for interaction application","body":"<p>I register an SlashCommand... but it answered &quot;Invalid command for interaction application&quot; Can somebody help...</p>\n<pre><code> @Override\n    public void onSlashCommand(SlashCommandEvent event) {\n\n        if (event.getName().equals(&quot;login&quot;)) {\n\n            EmbedBuilder buil = new EmbedBuilder();\n            buil.setColor(Color.RED);\n            buil.appendDescription(&quot;Du hast deinen DiscordAccount noch nicht mit dem TurnierSystem verknpft... Benutze ?connect um die Accounts zu verknpfen.&quot;);\n            buil.setAuthor(&quot;TurnierSystem&quot;);\n            buil.setTitle(&quot;Discord Login (Fehler)&quot;);\n\n           event.replyEmbeds(buil.build()).queue();\n\n        }\n</code></pre>\n"},{"tags":["java"],"comments":[{"owner":{"display_name":"user6073886"},"score":1,"creation_date":1641394900,"post_id":70595031,"comment_id":124794048,"body_markdown":"Does this answer your question? [What causes a java.lang.ArrayIndexOutOfBoundsException and how do I prevent it?](https://stackoverflow.com/questions/5554734/what-causes-a-java-lang-arrayindexoutofboundsexception-and-how-do-i-prevent-it)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/5554734/what-causes-a-java-lang-arrayindexoutofboundsexception-and-how-do-i-prevent-it\">What causes a java.lang.ArrayIndexOutOfBoundsException and how do I prevent it?</a>"},{"owner":{"display_name":"user6073886"},"score":0,"creation_date":1641395401,"post_id":70595031,"comment_id":124794291,"body_markdown":"fyi, you have `i &lt; Vektor[i].length;` as a condition in your second loop, which should probably be `j &lt; Vektor[i].length;`. (You are using the wrong counter variable in other words)","body":"fyi, you have <code>i &lt; Vektor[i].length;</code> as a condition in your second loop, which should probably be <code>j &lt; Vektor[i].length;</code>. (You are using the wrong counter variable in other words)"}],"owner":{"account_id":23836352,"reputation":1,"user_id":17842042,"display_name":"playtime"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":29,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1641394944,"answer_count":0,"score":0,"last_activity_date":1641394771,"creation_date":1641394771,"question_id":70595031,"body_markdown":"import java.util.Scanner;\r\n\r\npublic class MehrdimensionaleArrays {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\t\r\n\t\tSystem.out.println(&quot;Wie gro&#223; soll ihr Vektor sein?&quot;);\r\n\t\t\r\n\t\tint Line;\r\n\t\tint Column;\r\n\t\t\r\n\t\tScanner sc = new Scanner(System.in);\t\t\r\n\t\t\r\n\t\tLine  = sc.nextInt();\r\n\t\tColumn = sc.nextInt();\r\n\t\t\r\n\t\tint[][] Vektor = new int[Line][Column];\r\n\t\t\r\n\t\tfor(int i = 0; i &lt; Vektor.length; i++) {\r\n\t\t\tfor(int j = 0; i &lt; Vektor[i].length; j++) {\r\n\t\t\t\t\r\n\t\t\t\tVektor[i][j] = (int) (Math.random()*100);\r\n\t\t\t\tSystem.out.print(Vektor[i][j] + &quot;, &quot; );\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tSystem.out.println();\r\n\t\t\t\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\nI am getting an error that says Index X out of bounds for length X and i&#39;m not sure what that means.","title":"Exception in thread &quot;main&quot; 50, java.lang.ArrayIndexOutOfBoundsException: Index 4 out of bounds for length 4?","body":"<p>import java.util.Scanner;</p>\n<p>public class MehrdimensionaleArrays {</p>\n<pre><code>public static void main(String[] args) {\n    \n    System.out.println(&quot;Wie gro soll ihr Vektor sein?&quot;);\n    \n    int Line;\n    int Column;\n    \n    Scanner sc = new Scanner(System.in);        \n    \n    Line  = sc.nextInt();\n    Column = sc.nextInt();\n    \n    int[][] Vektor = new int[Line][Column];\n    \n    for(int i = 0; i &lt; Vektor.length; i++) {\n        for(int j = 0; i &lt; Vektor[i].length; j++) {\n            \n            Vektor[i][j] = (int) (Math.random()*100);\n            System.out.print(Vektor[i][j] + &quot;, &quot; );\n        }\n        \n        System.out.println();\n        \n    }\n\n}\n</code></pre>\n<p>}\nI am getting an error that says Index X out of bounds for length X and i'm not sure what that means.</p>\n"},{"tags":["java","apache-spark","cluster-computing","hadoop-yarn"],"answers":[{"tags":[],"owner":{"account_id":17389536,"reputation":141,"user_id":12600300,"display_name":"ankush1377"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1640778837,"creation_date":1640778837,"answer_id":70519041,"question_id":70502932,"body_markdown":"Need some clarity with regards to the usage of this config file here. \r\n\r\nIn case it is just needed as an argument to the main method, &amp; the content is being used for spark session initialisation, then there should be no need to copy it onto any of the worker nodes.\r\n\r\nIn case the file is needed in the driver or the executors, then you should be passing it using the `--files` argument.\r\n\r\nCopying to hdfs from local can be done using https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/FileSystemShell.html#copyFromLocal\r\n\r\n ","title":"Spark submit on Yarn Cluster mode with config file put into HDFS issue","body":"<p>Need some clarity with regards to the usage of this config file here.</p>\n<p>In case it is just needed as an argument to the main method, &amp; the content is being used for spark session initialisation, then there should be no need to copy it onto any of the worker nodes.</p>\n<p>In case the file is needed in the driver or the executors, then you should be passing it using the <code>--files</code> argument.</p>\n<p>Copying to hdfs from local can be done using <a href=\"https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/FileSystemShell.html#copyFromLocal\" rel=\"nofollow noreferrer\">https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/FileSystemShell.html#copyFromLocal</a></p>\n"}],"owner":{"account_id":23734711,"reputation":13,"user_id":17753518,"display_name":"Delevin Zhong"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":423,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641394738,"creation_date":1640667393,"question_id":70502932,"body_markdown":"I have a spark program that needs to be passed a config file as a parameter for the main method. Currently when I submit the job in yarn cluster mode, I need to put the config file in all worker nodes so that the program can find it. However, I want to put it into HDFS path but will get the file not found error. Below is the command I use:\r\n\r\n    spark-submit --master yarn\\\r\n    --name StreamingApp \\\r\n    --deploy-mode cluster \\\r\n    --class com.test.streaming.App \\\r\n    --driver-java-options &quot;-Djava.security.auth.login=/home/spark/auth.conf&quot; \\\r\n    --conf &quot;spark.executor.extraJavaOptions=-Djava.security.auth.login.config=/home/spark/auth.conf&quot; \\\r\n    --conf &quot;spark.driver.extraJavaOptions=-Djava.security.auth.login.config=/home/spark/auth.conf&quot; \\\r\n    --conf &quot;spark.driver.extraClassPath=/etc/hbase/conf/&quot; \\\r\n    /home/spark/StreamingFramework-0.0.1-SNAPSHTO-jar-with-dependencies.jar /home/spark/config.json\r\n\r\nHow can I put the last parameter (**/home/spark/config.json**) into HDFS so it works?","title":"Spark submit on Yarn Cluster mode with config file put into HDFS issue","body":"<p>I have a spark program that needs to be passed a config file as a parameter for the main method. Currently when I submit the job in yarn cluster mode, I need to put the config file in all worker nodes so that the program can find it. However, I want to put it into HDFS path but will get the file not found error. Below is the command I use:</p>\n<pre><code>spark-submit --master yarn\\\n--name StreamingApp \\\n--deploy-mode cluster \\\n--class com.test.streaming.App \\\n--driver-java-options &quot;-Djava.security.auth.login=/home/spark/auth.conf&quot; \\\n--conf &quot;spark.executor.extraJavaOptions=-Djava.security.auth.login.config=/home/spark/auth.conf&quot; \\\n--conf &quot;spark.driver.extraJavaOptions=-Djava.security.auth.login.config=/home/spark/auth.conf&quot; \\\n--conf &quot;spark.driver.extraClassPath=/etc/hbase/conf/&quot; \\\n/home/spark/StreamingFramework-0.0.1-SNAPSHTO-jar-with-dependencies.jar /home/spark/config.json\n</code></pre>\n<p>How can I put the last parameter (<strong>/home/spark/config.json</strong>) into HDFS so it works?</p>\n"},{"tags":["java","spring-batch","spring-jms"],"answers":[{"tags":[],"owner":{"account_id":1288095,"reputation":169326,"user_id":1240763,"display_name":"Gary Russell"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641394704,"creation_date":1641394704,"answer_id":70595020,"question_id":70585403,"body_markdown":"See https://docs.spring.io/spring-batch/docs/4.1.x/api/org/springframework/batch/container/jms/BatchMessageListenerContainer.html\r\n\r\nThere&#39;s not much documentation aside from the JavaDocs but there is a test case here https://github.com/spring-projects/spring-batch/blob/5dc17b190e95c87463f96bc27d8d5292c46006ff/spring-batch-infrastructure/src/test/java/org/springframework/batch/container/jms/BatchMessageListenerContainerTests.java","title":"How to implement Spring JMS Window processing?","body":"<p>See <a href=\"https://docs.spring.io/spring-batch/docs/4.1.x/api/org/springframework/batch/container/jms/BatchMessageListenerContainer.html\" rel=\"nofollow noreferrer\">https://docs.spring.io/spring-batch/docs/4.1.x/api/org/springframework/batch/container/jms/BatchMessageListenerContainer.html</a></p>\n<p>There's not much documentation aside from the JavaDocs but there is a test case here <a href=\"https://github.com/spring-projects/spring-batch/blob/5dc17b190e95c87463f96bc27d8d5292c46006ff/spring-batch-infrastructure/src/test/java/org/springframework/batch/container/jms/BatchMessageListenerContainerTests.java\" rel=\"nofollow noreferrer\">https://github.com/spring-projects/spring-batch/blob/5dc17b190e95c87463f96bc27d8d5292c46006ff/spring-batch-infrastructure/src/test/java/org/springframework/batch/container/jms/BatchMessageListenerContainerTests.java</a></p>\n"}],"owner":{"account_id":2293970,"reputation":1122,"user_id":2015948,"accept_rate":79,"display_name":"Boris Mitioglov"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":120,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641394704,"creation_date":1641332615,"question_id":70585403,"body_markdown":"I need to read messages from the JMS queue by batches (I have max number of records and time window parameters, whichever comes first). \r\n\r\nThen I need to process the messages and do bulk updates &amp; inserts into the DB. \r\n\r\nHow to implement this using Spring? \r\n\r\nI was thinking about combining Spring Batch and JMS, but I am not sure if Spring Batch can work without stopping, I need to listen the queue indefinitely. I have the impression that Spring Batch is not for this streaming use case.\r\n\r\nI know that in Kafka there is `ConcurrentKafkaListenerContainerFactory` where you can set batch processing to true, but unfortunately we don&#39;t use Kafka for now.","title":"How to implement Spring JMS Window processing?","body":"<p>I need to read messages from the JMS queue by batches (I have max number of records and time window parameters, whichever comes first).</p>\n<p>Then I need to process the messages and do bulk updates &amp; inserts into the DB.</p>\n<p>How to implement this using Spring?</p>\n<p>I was thinking about combining Spring Batch and JMS, but I am not sure if Spring Batch can work without stopping, I need to listen the queue indefinitely. I have the impression that Spring Batch is not for this streaming use case.</p>\n<p>I know that in Kafka there is <code>ConcurrentKafkaListenerContainerFactory</code> where you can set batch processing to true, but unfortunately we don't use Kafka for now.</p>\n"},{"tags":["java","hazelcast"],"owner":{"account_id":17359208,"reputation":75,"user_id":12575898,"display_name":"luka_roves"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":370,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1641394279,"creation_date":1641393668,"question_id":70594772,"body_markdown":"I have entry expired listener registered on a IMap.\r\nI insert ~1 000 000 records into the map with ttl of 10 minutes.\r\n\r\nData is inserted over the range of 5 minutes:\r\n\r\n10:00 - 10:05 -&gt; all records are inserted\r\n\r\nI expect first record to expire at 10:00 + 10 minutes ttl = 10:10\r\n\r\nI expect last record to expire at 10:05 + 10 minutes ttl = 10:15\r\n\r\nFirst record expires roughly at the proper time (~30 seconds more or less), but last record expires 10:25 which is way later than expected.\r\nI ran more similar tests, results are the same.\r\n\r\nFor this test entry expired listener code just counts expired records and logs each 500th record.\r\nI tried using more threads to make sure there is no issue with throughput, behavior was completely the same.\r\n\r\n\r\nI found this answer:\r\nhttps://stackoverflow.com/questions/53156762/hazelcast-expiration-listener-delay\r\n\r\nIs this behavior expected from entry expired listener?\r\nSmall delay would be acceptable.\r\n\r\n\r\nAlso, suggestions to do this differently are welcome.\r\nI am using cache as a buffer and need to process entries on buffer expiry.\r\nBuffer would hold a maximum of ~4 000 000 records at a time.\r\n\r\n\r\nHazelcast version 4.2.1 | Java version 1.8.0_301\r\n\r\nRunning in client-server architecture","title":"Hazelcast entry expiry delay","body":"<p>I have entry expired listener registered on a IMap.\nI insert ~1 000 000 records into the map with ttl of 10 minutes.</p>\n<p>Data is inserted over the range of 5 minutes:</p>\n<p>10:00 - 10:05 -&gt; all records are inserted</p>\n<p>I expect first record to expire at 10:00 + 10 minutes ttl = 10:10</p>\n<p>I expect last record to expire at 10:05 + 10 minutes ttl = 10:15</p>\n<p>First record expires roughly at the proper time (~30 seconds more or less), but last record expires 10:25 which is way later than expected.\nI ran more similar tests, results are the same.</p>\n<p>For this test entry expired listener code just counts expired records and logs each 500th record.\nI tried using more threads to make sure there is no issue with throughput, behavior was completely the same.</p>\n<p>I found this answer:\n<a href=\"https://stackoverflow.com/questions/53156762/hazelcast-expiration-listener-delay\">HazelCast - Expiration listener delay</a></p>\n<p>Is this behavior expected from entry expired listener?\nSmall delay would be acceptable.</p>\n<p>Also, suggestions to do this differently are welcome.\nI am using cache as a buffer and need to process entries on buffer expiry.\nBuffer would hold a maximum of ~4 000 000 records at a time.</p>\n<p>Hazelcast version 4.2.1 | Java version 1.8.0_301</p>\n<p>Running in client-server architecture</p>\n"},{"tags":["java","log4j"],"owner":{"account_id":15378546,"reputation":105,"user_id":11094576,"display_name":"icecream notebook"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":123,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1641394135,"creation_date":1641392805,"question_id":70594557,"body_markdown":"At any given time I want my log files like: **mylog.log, mylog.log.1, mylog.log.2**, reflecting today&#39;s logs, yesterday&#39;s log, and the day before yesterday&#39;s log, respectively. This has to be achieved via Apache log4j/log4j-extras (v1.2.17), through code (no xml config).  \r\n\r\nThe logger initialized below, however, seems to overwrite every day mylog.log. What am I doing wrong?\r\n\r\n    private static Logger fileLogger() {\r\n        TimeBasedRollingPolicy trigPolicy = new TimeBasedRollingPolicy();\r\n        trigPolicy.setFileNamePattern(&quot;mylog.log&quot; + &quot;.%d&quot;);\r\n        trigPolicy.setActiveFileName(&quot;mylog.log&quot; );\r\n        trigPolicy.activateOptions();\r\n        FixedWindowRollingPolicy rollPolicy = new FixedWindowRollingPolicy();\r\n        rollPolicy.setFileNamePattern(&quot;mylog.log&quot; + &quot;.%i&quot;);\r\n        rollPolicy.setActiveFileName(&quot;mylog.log&quot; );\r\n        rollPolicy.setMaxIndex(3);\r\n        rollPolicy.setMinIndex(1);\r\n        rollPolicy.activateOptions();\r\n        RollingFileAppender appender = new RollingFileAppender();\r\n        appender.setFile(&quot;./mylog.log&quot;);\r\n        appender.setLayout(new PatternLayout(&quot;[%d{yyyy.MM.dd::HH:mm:ss}] %-5p: %m%n&quot;));\r\n        appender.setThreshold(Level.DEBUG);\r\n        appender.setAppend(true);\r\n        appender.setRollingPolicy(rollPolicy);\r\n        appender.setTriggeringPolicy(trigPolicy);\r\n        appender.activateOptions();\r\n        Logger logger = LogManager.getLogger(Foo.class);\r\n        logger.addAppender(appender);\r\n        return logger;\r\n    }\r\n\r\n","title":"apache log4j: 3 day log retention with daily rolling","body":"<p>At any given time I want my log files like: <strong>mylog.log, mylog.log.1, mylog.log.2</strong>, reflecting today's logs, yesterday's log, and the day before yesterday's log, respectively. This has to be achieved via Apache log4j/log4j-extras (v1.2.17), through code (no xml config).</p>\n<p>The logger initialized below, however, seems to overwrite every day mylog.log. What am I doing wrong?</p>\n<pre><code>private static Logger fileLogger() {\n    TimeBasedRollingPolicy trigPolicy = new TimeBasedRollingPolicy();\n    trigPolicy.setFileNamePattern(&quot;mylog.log&quot; + &quot;.%d&quot;);\n    trigPolicy.setActiveFileName(&quot;mylog.log&quot; );\n    trigPolicy.activateOptions();\n    FixedWindowRollingPolicy rollPolicy = new FixedWindowRollingPolicy();\n    rollPolicy.setFileNamePattern(&quot;mylog.log&quot; + &quot;.%i&quot;);\n    rollPolicy.setActiveFileName(&quot;mylog.log&quot; );\n    rollPolicy.setMaxIndex(3);\n    rollPolicy.setMinIndex(1);\n    rollPolicy.activateOptions();\n    RollingFileAppender appender = new RollingFileAppender();\n    appender.setFile(&quot;./mylog.log&quot;);\n    appender.setLayout(new PatternLayout(&quot;[%d{yyyy.MM.dd::HH:mm:ss}] %-5p: %m%n&quot;));\n    appender.setThreshold(Level.DEBUG);\n    appender.setAppend(true);\n    appender.setRollingPolicy(rollPolicy);\n    appender.setTriggeringPolicy(trigPolicy);\n    appender.activateOptions();\n    Logger logger = LogManager.getLogger(Foo.class);\n    logger.addAppender(appender);\n    return logger;\n}\n</code></pre>\n"},{"tags":["java","unit-testing","amazon-s3","mockito"],"comments":[{"owner":{"account_id":6520,"reputation":10523,"user_id":11002,"accept_rate":75,"display_name":"tgdavies"},"score":0,"creation_date":1608292047,"post_id":65355896,"comment_id":115544822,"body_markdown":"I don&#39;t see where you&#39;re mocking getPayload()","body":"I don&#39;t see where you&#39;re mocking getPayload()"},{"owner":{"account_id":10527169,"reputation":53,"user_id":7757836,"display_name":"Mrmartyn"},"score":0,"creation_date":1608297137,"post_id":65355896,"comment_id":115546879,"body_markdown":"@tgdavies whoops, updated example test.","body":"@tgdavies whoops, updated example test."}],"answers":[{"tags":[],"owner":{"account_id":5258616,"reputation":11,"user_id":4200769,"display_name":"Trevor Ross"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641394076,"creation_date":1641394076,"answer_id":70594865,"question_id":65355896,"body_markdown":"This may not be exactly what you are looking for but here&#39;s how I implemented unit testing for S3 Select:\r\n\r\n**Production Code**:\r\n\r\n```java\r\nList&lt;StockAvailability&gt; stockList = Collections.emptyList();\r\n\r\nSelectObjectContentResult result = s3Client.selectObjectContent(query);\r\n\r\ntry (SelectRecordsInputStream resultInputStream = result.getPayload().getRecordsInputStream()) {\r\n   stockList = transformResponse(resultInputStream.getDelegateStream());\r\n}\r\ncatch (IOException e) {\r\n   LOG.error(&quot;Unable to parse stock availability response: {}&quot;, e.getMessage());\r\n}\r\n```\r\n\r\n_Note the call to `getDelegateStream()`_\r\n\r\n**Unit test**:\r\n\r\n```java\r\n   @Test\r\n   void test1()  {\r\n        SelectObjectContentResult mockSelectObjectContentResult = mock(SelectObjectContentResult.class);\r\n        SelectObjectContentEventStream mockSelectObjectContentEventStream = mock(SelectObjectContentEventStream.class);\r\n        SelectRecordsInputStream mockSelectRecordsInputStream = mock(SelectRecordsInputStream.class);\r\n\r\n        when(mockS3.selectObjectContent(any())).thenReturn(mockSelectObjectContentResult);\r\n        when(mockSelectObjectContentResult.getPayload()).thenReturn(mockSelectObjectContentEventStream);\r\n        when(mockSelectObjectContentEventStream.getRecordsInputStream()).thenReturn(mockSelectRecordsInputStream);\r\n\r\n        final InputStream output = IOUtils.toInputStream(&quot;some string&quot;, StandardCharsets.UTF_8);\r\n        when(mockSelectRecordsInputStream.getDelegateStream()).thenReturn(output);\r\n  }\r\n```","title":"Mocking out/replacing return from S3 library SelectObjectContentEventStream.getRecordsInputStream()","body":"<p>This may not be exactly what you are looking for but here's how I implemented unit testing for S3 Select:</p>\n<p><strong>Production Code</strong>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;StockAvailability&gt; stockList = Collections.emptyList();\n\nSelectObjectContentResult result = s3Client.selectObjectContent(query);\n\ntry (SelectRecordsInputStream resultInputStream = result.getPayload().getRecordsInputStream()) {\n   stockList = transformResponse(resultInputStream.getDelegateStream());\n}\ncatch (IOException e) {\n   LOG.error(&quot;Unable to parse stock availability response: {}&quot;, e.getMessage());\n}\n</code></pre>\n<p><em>Note the call to <code>getDelegateStream()</code></em></p>\n<p><strong>Unit test</strong>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>   @Test\n   void test1()  {\n        SelectObjectContentResult mockSelectObjectContentResult = mock(SelectObjectContentResult.class);\n        SelectObjectContentEventStream mockSelectObjectContentEventStream = mock(SelectObjectContentEventStream.class);\n        SelectRecordsInputStream mockSelectRecordsInputStream = mock(SelectRecordsInputStream.class);\n\n        when(mockS3.selectObjectContent(any())).thenReturn(mockSelectObjectContentResult);\n        when(mockSelectObjectContentResult.getPayload()).thenReturn(mockSelectObjectContentEventStream);\n        when(mockSelectObjectContentEventStream.getRecordsInputStream()).thenReturn(mockSelectRecordsInputStream);\n\n        final InputStream output = IOUtils.toInputStream(&quot;some string&quot;, StandardCharsets.UTF_8);\n        when(mockSelectRecordsInputStream.getDelegateStream()).thenReturn(output);\n  }\n</code></pre>\n"}],"owner":{"account_id":10527169,"reputation":53,"user_id":7757836,"display_name":"Mrmartyn"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1000,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1641394076,"creation_date":1608289446,"question_id":65355896,"body_markdown":"Im trying to create some unit tests around a call to AWS S3 Select and having trouble mocking out the SelectRecordsInputStream returned from getRecordsInputStream(). Im unable to instantiate my own SelectRecordsInputStream as the class is package private and Im unable to return an instance of InputStream from Mockitos .thenReturn() as its expecting an instance of SelectRecordsInputStream (this confuses me as SelectRecordsInputStream extends InputStream and youre able to specify this Type as the return in the try with resources)\r\n\r\nIs there anything I can do (without bringing in another testing framework) to return my own instance of InputStream or SelectRecordsInputStream? It also cannot be a mock instance as the testing revolves around processing the InputStream.\r\n\r\nProduction Code:\r\n\r\n\r\n    List&lt;StockAvailability&gt; stockList = Collections.emptyList();\r\n\r\n    SelectObjectContentResult result = s3Client.selectObjectContent(query);\r\n\r\n    try (InputStream resultInputStream = result.getPayload().getRecordsInputStream()) {\r\n       stockList = transformResponse(resultInputStream);\r\n    }\r\n    catch (IOException e) {\r\n       LOG.error(&quot;Unable to parse stock availability response: {}&quot;, e.getMessage());\r\n    }\r\n\r\n\r\n\r\nUnit test:\r\n\r\n       @Test\r\n         void test1()  {\r\n         final Query query = new Query.QueryBuilder().query(SELECT_QUERY)\r\n                                                   .bucket(BUCKET)\r\n                                                   .objectKey(KEY)\r\n                                                   .build();\r\n\r\n         when(s3Client.selectObjectContent (query)).thenReturn(selectObjectContentResult);\r\n\r\n         byte[] string = &quot;Any String you want&quot;.getBytes();\r\n    \r\n         InputStream inputStream = new ByteArrayInputStream(string);\r\n    when(selectObjectContentResult.getPayload()).thenReturn(selectObjectContentEventStream);\r\n       \r\n         //Does not compile and cannot cast to SelectRecordsInputStream       \r\n         when(selectObjectContentEventStream.getRecordsInputStream()).thenReturn(inputStream);\r\n    \r\n         final List&lt;StockAvailability&gt; result = stockService.queryStockData(query);\r\n      }\r\n\r\n\r\n\r\n","title":"Mocking out/replacing return from S3 library SelectObjectContentEventStream.getRecordsInputStream()","body":"<p>Im trying to create some unit tests around a call to AWS S3 Select and having trouble mocking out the SelectRecordsInputStream returned from getRecordsInputStream(). Im unable to instantiate my own SelectRecordsInputStream as the class is package private and Im unable to return an instance of InputStream from Mockitos .thenReturn() as its expecting an instance of SelectRecordsInputStream (this confuses me as SelectRecordsInputStream extends InputStream and youre able to specify this Type as the return in the try with resources)</p>\n<p>Is there anything I can do (without bringing in another testing framework) to return my own instance of InputStream or SelectRecordsInputStream? It also cannot be a mock instance as the testing revolves around processing the InputStream.</p>\n<p>Production Code:</p>\n<pre><code>List&lt;StockAvailability&gt; stockList = Collections.emptyList();\n\nSelectObjectContentResult result = s3Client.selectObjectContent(query);\n\ntry (InputStream resultInputStream = result.getPayload().getRecordsInputStream()) {\n   stockList = transformResponse(resultInputStream);\n}\ncatch (IOException e) {\n   LOG.error(&quot;Unable to parse stock availability response: {}&quot;, e.getMessage());\n}\n</code></pre>\n<p>Unit test:</p>\n<pre><code>   @Test\n     void test1()  {\n     final Query query = new Query.QueryBuilder().query(SELECT_QUERY)\n                                               .bucket(BUCKET)\n                                               .objectKey(KEY)\n                                               .build();\n\n     when(s3Client.selectObjectContent (query)).thenReturn(selectObjectContentResult);\n\n     byte[] string = &quot;Any String you want&quot;.getBytes();\n\n     InputStream inputStream = new ByteArrayInputStream(string);\nwhen(selectObjectContentResult.getPayload()).thenReturn(selectObjectContentEventStream);\n   \n     //Does not compile and cannot cast to SelectRecordsInputStream       \n     when(selectObjectContentEventStream.getRecordsInputStream()).thenReturn(inputStream);\n\n     final List&lt;StockAvailability&gt; result = stockService.queryStockData(query);\n  }\n</code></pre>\n"},{"tags":["java","date","java-8","java-time"],"comments":[{"owner":{"account_id":10025166,"reputation":73,"user_id":7413530,"accept_rate":29,"display_name":"Abhinay Pandey"},"score":0,"creation_date":1486036677,"post_id":42001475,"comment_id":71179466,"body_markdown":"you mean getting current date using YearMonth.of(int year, int month) ?","body":"you mean getting current date using YearMonth.of(int year, int month) ?"},{"owner":{"account_id":440158,"reputation":323231,"user_id":829571,"accept_rate":94,"display_name":"assylias"},"score":1,"creation_date":1486036813,"post_id":42001475,"comment_id":71179567,"body_markdown":"29/12/2014 was a Monday - why do you expect 28/12/2014? Also note that it would be clearer to use `DayOfWeek.MONDAY.getValue()` instead of `1`.","body":"29/12/2014 was a Monday - why do you expect 28/12/2014? Also note that it would be clearer to use <code>DayOfWeek.MONDAY.getValue()</code> instead of <code>1</code>."},{"owner":{"account_id":1852014,"reputation":24139,"user_id":1678362,"display_name":"Aaron"},"score":1,"creation_date":1486036830,"post_id":42001475,"comment_id":71179585,"body_markdown":"You don&#39;t need any information of the current date, no need to start with that. You can set the week and year with `YearMonth.of(int year, int month)`, then set the day of the week","body":"You don&#39;t need any information of the current date, no need to start with that. You can set the week and year with <code>YearMonth.of(int year, int month)</code>, then set the day of the week"},{"owner":{"account_id":10025166,"reputation":73,"user_id":7413530,"accept_rate":29,"display_name":"Abhinay Pandey"},"score":0,"creation_date":1486037285,"post_id":42001475,"comment_id":71179906,"body_markdown":"I guess it&#39;s converting 53rd week of 2015 to 1st week of 2015 as in 2015 only 52 weeks are there. Solved the issue","body":"I guess it&#39;s converting 53rd week of 2015 to 1st week of 2015 as in 2015 only 52 weeks are there. Solved the issue"},{"owner":{"account_id":322981,"reputation":310745,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":1,"creation_date":1486053228,"post_id":42001475,"comment_id":71190768,"body_markdown":"@AbhinayPandey What is your definition of week number? I can think of at least four definitions. Did you intend the [ISO 8601 standard definition](https://en.m.wikipedia.org/wiki/ISO_week_date)?","body":"@AbhinayPandey What is your definition of week number? I can think of at least four definitions. Did you intend the <a href=\"https://en.m.wikipedia.org/wiki/ISO_week_date\" rel=\"nofollow noreferrer\">ISO 8601 standard definition</a>?"},{"owner":{"account_id":2906108,"reputation":42988,"user_id":2491410,"accept_rate":100,"display_name":"Meno Hochschild"},"score":1,"creation_date":1486100764,"post_id":42001475,"comment_id":71209675,"body_markdown":"@AbhinayPandey No your issue is still not solved. You have applied the wrong order of manipulations in your helper method, see my answer.","body":"@AbhinayPandey No your issue is still not solved. You have applied the wrong order of manipulations in your helper method, see my answer."}],"answers":[{"tags":[],"owner":{"account_id":3619169,"reputation":9458,"user_id":3018377,"accept_rate":64,"display_name":"LHA"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1486066039,"creation_date":1486065168,"answer_id":42011143,"question_id":42001475,"body_markdown":"First, you need to calculate the first Monday of the first week of the year,\r\nthen simply plus multi of 7 to the date.\r\n\r\n\r\n\tpublic static LocalDate firstMonday(int week, int year) {\r\n\t\t\r\n\t\tLocalDate firstMonOfFirstWeek = LocalDate.now()\r\n\t\t\t\t.with(IsoFields.WEEK_BASED_YEAR, year) // year\r\n\t\t\t\t.with(IsoFields.WEEK_OF_WEEK_BASED_YEAR, 1) // First week of the year\r\n\t\t\t\t.with(ChronoField.DAY_OF_WEEK, 1); // Monday\r\n\t\t\r\n        // Plus multi of 7\r\n\t\treturn firstMonOfFirstWeek.plusDays( (week - 1) * 7);\r\n\t}\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\tSystem.out.println(firstMonday(1, 2013)); // 2012-12-31\r\n\t\tSystem.out.println(firstMonday(53 ,2015 )); // 2015-12-28\r\n\t}","title":"getting Monday date from given week and year using java.time package","body":"<p>First, you need to calculate the first Monday of the first week of the year,\nthen simply plus multi of 7 to the date.</p>\n\n<pre><code>public static LocalDate firstMonday(int week, int year) {\n\n    LocalDate firstMonOfFirstWeek = LocalDate.now()\n            .with(IsoFields.WEEK_BASED_YEAR, year) // year\n            .with(IsoFields.WEEK_OF_WEEK_BASED_YEAR, 1) // First week of the year\n            .with(ChronoField.DAY_OF_WEEK, 1); // Monday\n\n    // Plus multi of 7\n    return firstMonOfFirstWeek.plusDays( (week - 1) * 7);\n}\n\npublic static void main(String[] args) {\n    System.out.println(firstMonday(1, 2013)); // 2012-12-31\n    System.out.println(firstMonday(53 ,2015 )); // 2015-12-28\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":322981,"reputation":310745,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1486150741,"creation_date":1486066691,"answer_id":42011560,"question_id":42001475,"body_markdown":"# tl;dr\r\n\r\n    YearWeek.of ( 2013 , 1 ).atDay ( DayOfWeek.MONDAY )\r\n\r\n# Incorrect expectations\r\n\r\nYour expectations are not correct. The Monday of `2015-W53` is `2015-12-28`, not `2014-12-28`, year 2015 rather than 2014. There is no reason to expect 2014. Please edit your Question to explain your thoughts, if you need more explanation.\r\n\r\nYou may be confused about a calendar-year versus a week-based year. In the [ISO 8601 definition of a week based year][1], **week number one contains the first Thursday of the calendar-year**. This means we have some overlap between the years. The last few days of a calendar-year may reside in the following week-based-year. And vice-versa, the first few days of a calendar-year may reside in the previous week-based-year.\r\n\r\nAs an example, you can see in the screenshot below, the last day of calendar 2012 (December 31) falls in week one of the following week-based-year of 2013 at week number 1. And in the other screen shot, we have the opposite, where the first three days of calendar 2016 (January 1, 2, &amp; 3) land in the week-based-year of 2015 at week number 53.\r\n\r\n - The Monday of `2013-W01` is `2012-12-31`.\r\n - The Monday of `2015-W53` is `2015-12-28`. \r\n\r\n[![2013-W01 calendar screen shot][2]][2]\r\n\r\n[![2015-W53 calendar screen shot][3]][3]\r\n\r\n\r\n# `YearWeek`\r\n\r\nI suggest adding the [ThreeTen-Extra][4] library to your project to make use of of the [`YearWeek`][5] class. Rather than pass around mere integer numbers for year and week, pass around objects of this class. Doing so makes your code more self-documenting, provides type-safety, and ensures valid values.\r\n\r\n    // Pass ( week-based-year-number, week-number ). *Not* calendar year! See the ISO 8601 standard.\r\n    YearWeek yw = YearWeek.of( 2013 , 1 ); \r\n\r\nYou can pull any day from that week.\r\n\r\n    LocalDate ld = yw.atDay( DayOfWeek.MONDAY );\r\n\r\nLet&#39;s try this kind of code. \r\n\r\n    YearWeek yw1 = YearWeek.of ( 2013 , 1 );\r\n    LocalDate ld1 = yw1.atDay ( DayOfWeek.MONDAY );\r\n\r\n    YearWeek yw2 = YearWeek.of ( 2015 , 53 );\r\n    LocalDate ld2 = yw2.atDay ( DayOfWeek.MONDAY );\r\n\r\n    System.out.println ( &quot;yw1: &quot; + yw1 + &quot; Monday: &quot; + ld1 );\r\n    System.out.println ( &quot;yw2: &quot; + yw2 + &quot; Monday: &quot; + ld2 );\r\n    \r\n&gt;yw1: 2013-W01 Monday: 2012-12-31\r\n\r\n&gt;yw2: 2015-W53 Monday: 2015-12-28\r\n\r\n\r\n----------\r\n\r\nTip: To see those [ISO 8601 standard week][1] numbers on a Mac in Calendar.app, set `System Preferences` &gt; `Language &amp; Region` &gt; `Calendar` &gt; `ISO 8601`. Then in Calendar.app, set `Preferences` &gt; `Advanced` &gt; `Show week numbers`. \r\n\r\n\r\n  [1]: https://en.wikipedia.org/wiki/ISO_week_date\r\n  [2]: https://i.stack.imgur.com/EgK7n.png\r\n  [3]: https://i.stack.imgur.com/6bTTx.png\r\n  [4]: http://www.threeten.org/threeten-extra/\r\n  [5]: http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/YearWeek.html","title":"getting Monday date from given week and year using java.time package","body":"<h1>tl;dr</h1>\n\n<pre><code>YearWeek.of ( 2013 , 1 ).atDay ( DayOfWeek.MONDAY )\n</code></pre>\n\n<h1>Incorrect expectations</h1>\n\n<p>Your expectations are not correct. The Monday of <code>2015-W53</code> is <code>2015-12-28</code>, not <code>2014-12-28</code>, year 2015 rather than 2014. There is no reason to expect 2014. Please edit your Question to explain your thoughts, if you need more explanation.</p>\n\n<p>You may be confused about a calendar-year versus a week-based year. In the <a href=\"https://en.wikipedia.org/wiki/ISO_week_date\" rel=\"nofollow noreferrer\">ISO 8601 definition of a week based year</a>, <strong>week number one contains the first Thursday of the calendar-year</strong>. This means we have some overlap between the years. The last few days of a calendar-year may reside in the following week-based-year. And vice-versa, the first few days of a calendar-year may reside in the previous week-based-year.</p>\n\n<p>As an example, you can see in the screenshot below, the last day of calendar 2012 (December 31) falls in week one of the following week-based-year of 2013 at week number 1. And in the other screen shot, we have the opposite, where the first three days of calendar 2016 (January 1, 2, &amp; 3) land in the week-based-year of 2015 at week number 53.</p>\n\n<ul>\n<li>The Monday of <code>2013-W01</code> is <code>2012-12-31</code>.</li>\n<li>The Monday of <code>2015-W53</code> is <code>2015-12-28</code>. </li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/EgK7n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EgK7n.png\" alt=\"2013-W01 calendar screen shot\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/6bTTx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6bTTx.png\" alt=\"2015-W53 calendar screen shot\"></a></p>\n\n<h1><code>YearWeek</code></h1>\n\n<p>I suggest adding the <a href=\"http://www.threeten.org/threeten-extra/\" rel=\"nofollow noreferrer\">ThreeTen-Extra</a> library to your project to make use of of the <a href=\"http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/YearWeek.html\" rel=\"nofollow noreferrer\"><code>YearWeek</code></a> class. Rather than pass around mere integer numbers for year and week, pass around objects of this class. Doing so makes your code more self-documenting, provides type-safety, and ensures valid values.</p>\n\n<pre><code>// Pass ( week-based-year-number, week-number ). *Not* calendar year! See the ISO 8601 standard.\nYearWeek yw = YearWeek.of( 2013 , 1 ); \n</code></pre>\n\n<p>You can pull any day from that week.</p>\n\n<pre><code>LocalDate ld = yw.atDay( DayOfWeek.MONDAY );\n</code></pre>\n\n<p>Let's try this kind of code. </p>\n\n<pre><code>YearWeek yw1 = YearWeek.of ( 2013 , 1 );\nLocalDate ld1 = yw1.atDay ( DayOfWeek.MONDAY );\n\nYearWeek yw2 = YearWeek.of ( 2015 , 53 );\nLocalDate ld2 = yw2.atDay ( DayOfWeek.MONDAY );\n\nSystem.out.println ( \"yw1: \" + yw1 + \" Monday: \" + ld1 );\nSystem.out.println ( \"yw2: \" + yw2 + \" Monday: \" + ld2 );\n</code></pre>\n\n<blockquote>\n  <p>yw1: 2013-W01 Monday: 2012-12-31</p>\n  \n  <p>yw2: 2015-W53 Monday: 2015-12-28</p>\n</blockquote>\n\n<hr>\n\n<p>Tip: To see those <a href=\"https://en.wikipedia.org/wiki/ISO_week_date\" rel=\"nofollow noreferrer\">ISO 8601 standard week</a> numbers on a Mac in Calendar.app, set <code>System Preferences</code> > <code>Language &amp; Region</code> > <code>Calendar</code> > <code>ISO 8601</code>. Then in Calendar.app, set <code>Preferences</code> > <code>Advanced</code> > <code>Show week numbers</code>. </p>\n"},{"tags":[],"owner":{"account_id":2906108,"reputation":42988,"user_id":2491410,"accept_rate":100,"display_name":"Meno Hochschild"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1486109367,"creation_date":1486100402,"answer_id":42017495,"question_id":42001475,"body_markdown":"This is astonishingly more difficult than the partially invalid expectations of OP and most answers show.\r\n\r\n**First to say: It is very important to define the correct order of week-based-manipulations.** The OP has first applied day-manipulation, then year-based manipulation. The correct approach is in reverse! I will show the right helper method implementation:\r\n\r\n    public static void main(String... args) {\r\n        System.out.println(\r\n          getDateFromWeekAndYear(&quot;53&quot;, &quot;2015&quot;)); // 2015-12-28, NOT 2014-12-28\r\n        System.out.println(\r\n          getDateFromWeekAndYear(&quot;53&quot;, &quot;2015&quot;).get(WeekFields.ISO.weekOfWeekBasedYear())); // 53\r\n        System.out.println(\r\n          getDateFromWeekAndYear(&quot;53&quot;, &quot;2014&quot;)); // 2014-12-29\r\n        System.out.println(\r\n          getDateFromWeekAndYear(&quot;53&quot;, &quot;2014&quot;).get(WeekFields.ISO.weekOfWeekBasedYear())); // 1\r\n    }\r\n\r\n    private static LocalDate getDateFromWeekAndYear(final String week,final String year) {\r\n        int y = Integer.parseInt(year);\r\n        LocalDate date = LocalDate.of(y, 7, 1); // safer than choosing current date\r\n        // date = date.with(WeekFields.ISO.weekBasedYear(), y); // no longer necessary\r\n        date = date.with(WeekFields.ISO.weekOfWeekBasedYear(), Long.parseLong(week));\r\n        date = date.with(WeekFields.ISO.dayOfWeek(), 1);\r\n\r\n        return date;\r\n    }\r\n\r\nIf you don&#39;t respect this specific order then you will indeed get sometimes a 2014-date for the input 2015-W53 (depending on the current date). \r\n\r\nSecond problem: **I have also avoided to start with current date in order to be not near start or end of calendar year** (calendar year != week-based-year) and instead chosen midth of year as starting point.\r\n\r\n**The third problem is lenient handling of week 53 in (week-based)-year 2014.** It does not exist because 2014 had only 52 weeks!!! A strict algorithm should recognize and reject such an input. Therefore I advise against using `YearWeek.of(2014, 53)` (in the external library Threeten-Extra) resulting in the first week of 2015, see also its [javadoc][1]. Better than such lenient handling would have been \r\n\r\n    YearWeek yw = YearWeek.of(2014, 52);\r\n    if (yw.is53WeekYear()) {\r\n      yw = YearWeek.of(2014, 53);\r\n    }\r\n\r\nor using this code from my own time library [Time4J][2] (whose class [CalendarWeek][3] has extra i18n-features and extra week arithmetic in comparison with `YearWeek`):\r\n\r\n    CalendarWeek.of(2014, 53); // throws an exception\r\n    System.out.println(CalendarWeek.of(2014, 1).withLastWeekOfYear()); // 2014-W52\r\n\r\n**Only using `java.time`-package:**\r\n\r\nUsing such external libraries would at least have helped to solve the first problem in a transparent way. If you are not willing to add an extra dependency then you can do this to handle week 53 if invalid:\r\n\r\nIf the expression `WeekFields.ISO.weekOfWeekBasedYear()` applied on the result of your helper method yields the value 1 then you know that week 53 was invalid. And then you can decide if you want to accept lenient handling or to throw an exception. But silent adjusting such an invalid input is IMHO bad design.\r\n\r\n\r\n  [1]: http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/YearWeek.html#of-int-int-\r\n  [2]: https://github.com/MenoData/Time4J\r\n  [3]: http://time4j.net/javadoc-en/net/time4j/range/CalendarWeek.html","title":"getting Monday date from given week and year using java.time package","body":"<p>This is astonishingly more difficult than the partially invalid expectations of OP and most answers show.</p>\n\n<p><strong>First to say: It is very important to define the correct order of week-based-manipulations.</strong> The OP has first applied day-manipulation, then year-based manipulation. The correct approach is in reverse! I will show the right helper method implementation:</p>\n\n<pre><code>public static void main(String... args) {\n    System.out.println(\n      getDateFromWeekAndYear(\"53\", \"2015\")); // 2015-12-28, NOT 2014-12-28\n    System.out.println(\n      getDateFromWeekAndYear(\"53\", \"2015\").get(WeekFields.ISO.weekOfWeekBasedYear())); // 53\n    System.out.println(\n      getDateFromWeekAndYear(\"53\", \"2014\")); // 2014-12-29\n    System.out.println(\n      getDateFromWeekAndYear(\"53\", \"2014\").get(WeekFields.ISO.weekOfWeekBasedYear())); // 1\n}\n\nprivate static LocalDate getDateFromWeekAndYear(final String week,final String year) {\n    int y = Integer.parseInt(year);\n    LocalDate date = LocalDate.of(y, 7, 1); // safer than choosing current date\n    // date = date.with(WeekFields.ISO.weekBasedYear(), y); // no longer necessary\n    date = date.with(WeekFields.ISO.weekOfWeekBasedYear(), Long.parseLong(week));\n    date = date.with(WeekFields.ISO.dayOfWeek(), 1);\n\n    return date;\n}\n</code></pre>\n\n<p>If you don't respect this specific order then you will indeed get sometimes a 2014-date for the input 2015-W53 (depending on the current date). </p>\n\n<p>Second problem: <strong>I have also avoided to start with current date in order to be not near start or end of calendar year</strong> (calendar year != week-based-year) and instead chosen midth of year as starting point.</p>\n\n<p><strong>The third problem is lenient handling of week 53 in (week-based)-year 2014.</strong> It does not exist because 2014 had only 52 weeks!!! A strict algorithm should recognize and reject such an input. Therefore I advise against using <code>YearWeek.of(2014, 53)</code> (in the external library Threeten-Extra) resulting in the first week of 2015, see also its <a href=\"http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/YearWeek.html#of-int-int-\" rel=\"nofollow noreferrer\">javadoc</a>. Better than such lenient handling would have been </p>\n\n<pre><code>YearWeek yw = YearWeek.of(2014, 52);\nif (yw.is53WeekYear()) {\n  yw = YearWeek.of(2014, 53);\n}\n</code></pre>\n\n<p>or using this code from my own time library <a href=\"https://github.com/MenoData/Time4J\" rel=\"nofollow noreferrer\">Time4J</a> (whose class <a href=\"http://time4j.net/javadoc-en/net/time4j/range/CalendarWeek.html\" rel=\"nofollow noreferrer\">CalendarWeek</a> has extra i18n-features and extra week arithmetic in comparison with <code>YearWeek</code>):</p>\n\n<pre><code>CalendarWeek.of(2014, 53); // throws an exception\nSystem.out.println(CalendarWeek.of(2014, 1).withLastWeekOfYear()); // 2014-W52\n</code></pre>\n\n<p><strong>Only using <code>java.time</code>-package:</strong></p>\n\n<p>Using such external libraries would at least have helped to solve the first problem in a transparent way. If you are not willing to add an extra dependency then you can do this to handle week 53 if invalid:</p>\n\n<p>If the expression <code>WeekFields.ISO.weekOfWeekBasedYear()</code> applied on the result of your helper method yields the value 1 then you know that week 53 was invalid. And then you can decide if you want to accept lenient handling or to throw an exception. But silent adjusting such an invalid input is IMHO bad design.</p>\n"},{"tags":[],"owner":{"account_id":5033128,"reputation":1,"user_id":4042752,"display_name":"Angelina"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641393726,"creation_date":1641374469,"answer_id":70590411,"question_id":42001475,"body_markdown":"I wanted Monday of a week about 6 month ago - to be specific 26 weeks ago.. below code gave me the required date:\r\n\r\n    LocalDate.now().minusWeeks(26).with(WeekFields.ISO.dayOfWeek(), DayOfWeek.MONDAY.getValue())","title":"getting Monday date from given week and year using java.time package","body":"<p>I wanted Monday of a week about 6 month ago - to be specific 26 weeks ago.. below code gave me the required date:</p>\n<pre><code>LocalDate.now().minusWeeks(26).with(WeekFields.ISO.dayOfWeek(), DayOfWeek.MONDAY.getValue())\n</code></pre>\n"}],"owner":{"account_id":10025166,"reputation":73,"user_id":7413530,"accept_rate":29,"display_name":"Abhinay Pandey"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1589,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":42017495,"answer_count":4,"score":2,"last_activity_date":1641393726,"creation_date":1486036110,"question_id":42001475,"body_markdown":"I want to get Monday date from given week and year using Java 8 package java.time. \r\nBut at some point I am facing issue as it&#39;s not returning proper date. \r\n\r\n    private LocalDate getDateFromWeekAndYear(final String week,final String year){\r\n\t\tLocalDate date = LocalDate.now();\r\n\t\tdate = date.with(WeekFields.ISO.dayOfWeek(), 1);\r\n\t\tdate = date.with(WeekFields.ISO.weekOfWeekBasedYear(), Long.parseLong(week));\r\n\t\tdate = date.with(WeekFields.ISO.weekBasedYear(), Long.parseLong(year));\r\n\t\t\r\n\t\treturn date;\r\n\t}\r\n\r\nFor example:\r\n\r\n - If I pass week=1 and year=2013 then date is : 2012-12-31.\r\n - But if I pass week=53 and year=2015 then date is : 2014-12-29. I expected 2014-12-28.\r\n\r\nIs there any logical mistake I am making or some other issue ?","title":"getting Monday date from given week and year using java.time package","body":"<p>I want to get Monday date from given week and year using Java 8 package java.time. \nBut at some point I am facing issue as it's not returning proper date. </p>\n\n<pre><code>private LocalDate getDateFromWeekAndYear(final String week,final String year){\n    LocalDate date = LocalDate.now();\n    date = date.with(WeekFields.ISO.dayOfWeek(), 1);\n    date = date.with(WeekFields.ISO.weekOfWeekBasedYear(), Long.parseLong(week));\n    date = date.with(WeekFields.ISO.weekBasedYear(), Long.parseLong(year));\n\n    return date;\n}\n</code></pre>\n\n<p>For example:</p>\n\n<ul>\n<li>If I pass week=1 and year=2013 then date is : 2012-12-31.</li>\n<li>But if I pass week=53 and year=2015 then date is : 2014-12-29. I expected 2014-12-28.</li>\n</ul>\n\n<p>Is there any logical mistake I am making or some other issue ?</p>\n"},{"tags":["java","android","charset"],"comments":[{"owner":{"account_id":300897,"reputation":7589,"user_id":608312,"accept_rate":91,"display_name":"Jake Lee"},"score":0,"creation_date":1641157364,"post_id":70542979,"comment_id":124730224,"body_markdown":"Android Studio is an IDE, what do you mean by converting charset? Where is it `Predajn` but should be `Predaja`?","body":"Android Studio is an IDE, what do you mean by converting charset? Where is it <code>Predajn</code> but should be <code>Predaja</code>?"},{"owner":{"account_id":23778662,"reputation":3,"user_id":17791705,"display_name":"Barni156"},"score":0,"creation_date":1641290736,"post_id":70542979,"comment_id":124761083,"body_markdown":"&quot;Predajn&quot; is in txt file and i want to convert it Predaja (UTF-8)","body":"&quot;Predajn&quot; is in txt file and i want to convert it Predaja (UTF-8)"},{"owner":{"account_id":300897,"reputation":7589,"user_id":608312,"accept_rate":91,"display_name":"Jake Lee"},"score":0,"creation_date":1641293836,"post_id":70542979,"comment_id":124762150,"body_markdown":"https://stackoverflow.com/questions/3018653/java-how-to-convert-a-file-to-utf8","body":"<a href=\"https://stackoverflow.com/questions/3018653/java-how-to-convert-a-file-to-utf8\" title=\"java how to convert a file to utf8\">stackoverflow.com/questions/3018653/&hellip;</a>"},{"owner":{"account_id":23778662,"reputation":3,"user_id":17791705,"display_name":"Barni156"},"score":0,"creation_date":1641296557,"post_id":70542979,"comment_id":124763089,"body_markdown":"I tested it but when i  put there String charset = &quot;UTF-8&quot;; then the text remains the same &quot;Predajn&quot;","body":"I tested it but when i  put there String charset = &quot;UTF-8&quot;; then the text remains the same &quot;Predajn&quot;"}],"owner":{"account_id":23778662,"reputation":3,"user_id":17791705,"display_name":"Barni156"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":65,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1641393677,"creation_date":1640959103,"question_id":70542979,"body_markdown":"How can I convert this &quot;Predajn&quot; (Windows-1250) to &quot;Predaja&quot; (UTF-8) or fix &quot;Predajn&quot; to &quot;Predaja&quot; in android. \r\n\r\nI am using Java as programming language and Android Studio as an IDE to do this. \r\n\r\nI didn&#39;t find anything so can someone help me to do this?","title":"Android convert charset","body":"<p>How can I convert this &quot;Predajn&quot; (Windows-1250) to &quot;Predaja&quot; (UTF-8) or fix &quot;Predajn&quot; to &quot;Predaja&quot; in android.</p>\n<p>I am using Java as programming language and Android Studio as an IDE to do this.</p>\n<p>I didn't find anything so can someone help me to do this?</p>\n"},{"tags":["java","jsonpath","jayway"],"owner":{"account_id":8146395,"reputation":17,"user_id":6134938,"display_name":"David"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":44,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"closed_date":1641436121,"answer_count":0,"score":1,"last_activity_date":1641393392,"creation_date":1641382128,"question_id":70592107,"body_markdown":"This is my JSON data\r\n\r\n```json\r\n{\r\n    &quot;code&quot;: 0,\r\n    &quot;message&quot;: &quot;success&quot;,\r\n    &quot;data&quot;: {\r\n        &quot;logFrom&quot;: &quot;{\\&quot;date_as_long\\&quot;: 1411455611975}&quot;\r\n    }\r\n}\r\n```\r\nThe logFrom object is still a JSON.\r\n\r\nIn this case, how can I use JSONPath expression to locate `date_as_long`?\r\n\r\n","title":"How to get the Value in the element of JSON by JSONPath?","body":"<p>This is my JSON data</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n    &quot;code&quot;: 0,\n    &quot;message&quot;: &quot;success&quot;,\n    &quot;data&quot;: {\n        &quot;logFrom&quot;: &quot;{\\&quot;date_as_long\\&quot;: 1411455611975}&quot;\n    }\n}\n</code></pre>\n<p>The logFrom object is still a JSON.</p>\n<p>In this case, how can I use JSONPath expression to locate <code>date_as_long</code>?</p>\n"},{"tags":["java","hibernate","orm","lazy-loading","fetch"],"comments":[{"owner":{"account_id":6106038,"reputation":1680,"user_id":4763733,"accept_rate":25,"display_name":"Fran Montero"},"score":0,"creation_date":1438601750,"post_id":31785604,"comment_id":51501024,"body_markdown":"I believe thats not possible, but the opposite yes, make it lazy an trigger its initialization when needed.","body":"I believe thats not possible, but the opposite yes, make it lazy an trigger its initialization when needed."},{"owner":{"account_id":6409722,"reputation":2936,"user_id":4969870,"display_name":"Pawe Gowacz"},"score":0,"creation_date":1438602191,"post_id":31785604,"comment_id":51501297,"body_markdown":"In your `Person` entity add to field `age` annotation `@Basic(fetch=FetchType.LAZY)`. At least give a shot.","body":"In your <code>Person</code> entity add to field <code>age</code> annotation <code>@Basic(fetch=FetchType.LAZY)</code>. At least give a shot."},{"owner":{"account_id":449256,"reputation":2122,"user_id":843943,"accept_rate":75,"display_name":"Grim"},"score":0,"creation_date":1438603076,"post_id":31785604,"comment_id":51501830,"body_markdown":"@PaweGowacz I know this style, and i dont like it. It should be part of the criteria, not of the implementation of the Entity.","body":"@PaweGowacz I know this style, and i dont like it. It should be part of the criteria, not of the implementation of the Entity."},{"owner":{"account_id":4304651,"reputation":9315,"user_id":3517383,"accept_rate":41,"display_name":"gabrielgiussi"},"score":0,"creation_date":1439382530,"post_id":31785604,"comment_id":51837416,"body_markdown":"What is the sense of not retrieving the age? Less bytes in the wire?","body":"What is the sense of not retrieving the age? Less bytes in the wire?"},{"owner":{"account_id":449256,"reputation":2122,"user_id":843943,"accept_rate":75,"display_name":"Grim"},"score":0,"creation_date":1439383195,"post_id":31785604,"comment_id":51837950,"body_markdown":"@gabrielgiussi its because of performance. The age is calculated by timezone, daylight-saving-time, location... let us say, it takes seconds to calculate the age.","body":"@gabrielgiussi its because of performance. The age is calculated by timezone, daylight-saving-time, location... let us say, it takes seconds to calculate the age."},{"owner":{"account_id":4304651,"reputation":9315,"user_id":3517383,"accept_rate":41,"display_name":"gabrielgiussi"},"score":0,"creation_date":1439383372,"post_id":31785604,"comment_id":51838076,"body_markdown":"So, if it&#39;s calculated what are you persisting in the age field?","body":"So, if it&#39;s calculated what are you persisting in the age field?"},{"owner":{"account_id":449256,"reputation":2122,"user_id":843943,"accept_rate":75,"display_name":"Grim"},"score":0,"creation_date":1439385065,"post_id":31785604,"comment_id":51839542,"body_markdown":"A update-trigger causes a chain of processes... does it realy matter?","body":"A update-trigger causes a chain of processes... does it realy matter?"},{"owner":{"account_id":4304651,"reputation":9315,"user_id":3517383,"accept_rate":41,"display_name":"gabrielgiussi"},"score":0,"creation_date":1439484236,"post_id":31785604,"comment_id":51892143,"body_markdown":"I can&#39;t fully understand the requirement behind your question. If the age is calculated with a update-trigger, why it would hurt performance retrieve the age in the query if the saved value is already calculated?","body":"I can&#39;t fully understand the requirement behind your question. If the age is calculated with a update-trigger, why it would hurt performance retrieve the age in the query if the saved value is already calculated?"}],"answers":[{"tags":[],"owner":{"account_id":3063445,"reputation":3948,"user_id":2595658,"accept_rate":64,"display_name":"Paco Abato"},"down_vote_count":1,"up_vote_count":12,"is_accepted":false,"score":11,"last_activity_date":1439378693,"creation_date":1439361586,"answer_id":31957727,"question_id":31785604,"body_markdown":"I think that lazy mode only makes sense with associations. If you are accessing a plain table it will load all the fields.\r\n\r\nIf you want the `age` field not to appear in the SQL and so not being loaded into memory then use projections:\r\n\r\n    Criteria crit = session.createCriteria(Person.class);\r\n    ProjectionList projList = Projections.projectionList();\r\n    projList.add(Projections.property(&quot;name&quot;));\r\n    projList.add(Projections.property(&quot;firstname&quot;));\r\n    crit.setProjection(projList);","title":"How to fetch a field lazily with Hibernate Criteria","body":"<p>I think that lazy mode only makes sense with associations. If you are accessing a plain table it will load all the fields.</p>\n\n<p>If you want the <code>age</code> field not to appear in the SQL and so not being loaded into memory then use projections:</p>\n\n<pre><code>Criteria crit = session.createCriteria(Person.class);\nProjectionList projList = Projections.projectionList();\nprojList.add(Projections.property(\"name\"));\nprojList.add(Projections.property(\"firstname\"));\ncrit.setProjection(projList);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2432741,"reputation":2413,"user_id":2123306,"accept_rate":83,"display_name":"Mathias Begert"},"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1439867613,"creation_date":1439367565,"answer_id":31959716,"question_id":31785604,"body_markdown":"Setting the FetchMode of the &quot;age&quot; property on a criteria has no effect because the fetching strategy at this point is for associated objects only but not for properties. See section [20.1. Fetching strategies][1] of the hibernate docs.\r\n\r\n&gt; Hibernate uses a fetching strategy to retrieve **associated objects**\r\n&gt; if the application needs to navigate the association. Fetch strategies\r\n&gt; can be declared in the O/R mapping metadata, or over-ridden by a\r\n&gt; particular HQL or Criteria query.\r\n\r\nThe only way for lazy loading of a property is the `@Basic` annotation set to `FetchType.LAZY`. See [here][2], or if you use .hbm.xml files for mapping use `lazy=true`, see [this][3] section of the hibernate docs.\r\n\r\n&gt; The @Basic annotation allows you to declare the **fetching strategy for\r\n&gt; a property**. If set to LAZY, specifies that this property should be\r\n&gt; fetched lazily when the instance variable is first accessed. It\r\n&gt; requires build-time bytecode instrumentation, if your classes are not\r\n&gt; instrumented, property level lazy loading is silently ignored. \r\n\r\nLazy loading of properties also use **buildtime bytecode instumentation** (hibernate is changing the entity classes after compilation to allow lazy loading of properties). Read [20.1.8. Using lazy property fetching][4]\r\n\r\n\r\nAn other possible solution (except for all the other solutions) to your problem is to make a simpler Person class and use a [constructor query][5] like:\r\n\r\n    public class PersonDTO {\r\n        private String name;\r\n        private String firstname;\r\n\r\n        private Person(String name, String firstname) {\r\n            this.name = name;\r\n            this.firstname = firstname;\r\n        }\r\n        // getters &amp; setters\r\n    }\r\n\r\n    Query q = session.createQuery(&quot;select new your.package.name.PersonDTO(&quot;\r\n        + &quot;p.name, p.firstname) from Person p&quot;);\r\n    q.list();\r\n\r\nYou could even use your existing Person class, just extend it with an appropriate constructor, but I would prefer explicitness. \r\n\r\nBut all the solutions presented here do not implement a lazy loading of the `age` attribute. The only way to do this is the `@Basic`annotation, or you have to implement your own lazy loading.\r\n    \r\n  [1]: http://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch20.html#performance-fetching\r\n  [2]: http://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch05.html#mapping-declaration-property\r\n  [3]: http://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch05.html#d5e3233\r\n  [4]: http://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch20.html#performance-fetching-lazyproperties\r\n  [5]: http://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch16.html#queryhql-select","title":"How to fetch a field lazily with Hibernate Criteria","body":"<p>Setting the FetchMode of the \"age\" property on a criteria has no effect because the fetching strategy at this point is for associated objects only but not for properties. See section <a href=\"http://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch20.html#performance-fetching\">20.1. Fetching strategies</a> of the hibernate docs.</p>\n\n<blockquote>\n  <p>Hibernate uses a fetching strategy to retrieve <strong>associated objects</strong>\n  if the application needs to navigate the association. Fetch strategies\n  can be declared in the O/R mapping metadata, or over-ridden by a\n  particular HQL or Criteria query.</p>\n</blockquote>\n\n<p>The only way for lazy loading of a property is the <code>@Basic</code> annotation set to <code>FetchType.LAZY</code>. See <a href=\"http://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch05.html#mapping-declaration-property\">here</a>, or if you use .hbm.xml files for mapping use <code>lazy=true</code>, see <a href=\"http://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch05.html#d5e3233\">this</a> section of the hibernate docs.</p>\n\n<blockquote>\n  <p>The @Basic annotation allows you to declare the <strong>fetching strategy for\n  a property</strong>. If set to LAZY, specifies that this property should be\n  fetched lazily when the instance variable is first accessed. It\n  requires build-time bytecode instrumentation, if your classes are not\n  instrumented, property level lazy loading is silently ignored. </p>\n</blockquote>\n\n<p>Lazy loading of properties also use <strong>buildtime bytecode instumentation</strong> (hibernate is changing the entity classes after compilation to allow lazy loading of properties). Read <a href=\"http://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch20.html#performance-fetching-lazyproperties\">20.1.8. Using lazy property fetching</a></p>\n\n<p>An other possible solution (except for all the other solutions) to your problem is to make a simpler Person class and use a <a href=\"http://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch16.html#queryhql-select\">constructor query</a> like:</p>\n\n<pre><code>public class PersonDTO {\n    private String name;\n    private String firstname;\n\n    private Person(String name, String firstname) {\n        this.name = name;\n        this.firstname = firstname;\n    }\n    // getters &amp; setters\n}\n\nQuery q = session.createQuery(\"select new your.package.name.PersonDTO(\"\n    + \"p.name, p.firstname) from Person p\");\nq.list();\n</code></pre>\n\n<p>You could even use your existing Person class, just extend it with an appropriate constructor, but I would prefer explicitness. </p>\n\n<p>But all the solutions presented here do not implement a lazy loading of the <code>age</code> attribute. The only way to do this is the <code>@Basic</code>annotation, or you have to implement your own lazy loading.</p>\n"},{"tags":[],"owner":{"account_id":6093107,"reputation":23152,"user_id":4754790,"accept_rate":94,"display_name":"Dragan Bozanovic"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1439893368,"creation_date":1439379414,"answer_id":31964104,"question_id":31785604,"body_markdown":"Your reasoning is valid (in general; we can however argue about the specific example of the `age` field), but unfortunately there is no straight-forward solution for this. Actually, Hibernate has the concept of [fetch profiles][1], but it is currently very limited (you can override the default fetch plan/strategy only with the join-style fetch profiles).\r\n\r\nSo, the possible workaround to your issue could be as follows.\r\n\r\n1) Move `age` to a separate entity and associate the `Person` entity with it with a lazy one-to-one relationship:\r\n\r\n    @Entity\r\n    class PersonAge {\r\n       private Integer age;\r\n    }\r\n    \r\n    @Entity\r\n    class Person {\r\n       @OneToOne(cascade = CascadeType.ALL, fetch = FetchType.LAZY, orphanRemoval = true, optional = false)\r\n       @JoinColumn(name = &quot;PERSON_AGE_ID&quot;)\r\n       private PersonAge personAge;\r\n       \r\n       public Integer getAge() {\r\n          return personAge.getAge();\r\n       }\r\n\r\n       public void setAge(Integer age) {\r\n          personAge.setAge(age);\r\n       }\r\n    }\r\n\r\n2) Define a fetch profile which overrides the default one:\r\n\r\n    @FetchProfile(name = &quot;person-with-age&quot;, fetchOverrides = {\r\n       @FetchProfile.FetchOverride(entity = Person.class, association = &quot;personAge&quot;, mode = FetchMode.JOIN)\r\n    })\r\n\r\n3) Enable this profile for *each* session in the application:\r\n\r\n    session.enableFetchProfile(&quot;person-with-age&quot;);\r\n\r\nDepending on the framework you use, there should be an easy hook/interceptor which you will use to enable the profile for each session (transaction) that is craeted. For example, an approach in Spring could be to override [AbstractPlatformTransactionManager.doBegin][2] of the transaction manager in use.\r\n\r\nThis way the `personAge` will be eagerly loaded in all the sessions in the application, unless the fetch profile is explicitly disabled.\r\n\r\n4) *Disable* the fetch profile in the session in which you use the desired Criteria query:\r\n\r\n    session.disableFetchProfile(&quot;person-with-age&quot;);\r\n\r\nThis way the default fetch plan/strategy is used (specified in the entity mappings), which is the lazy loading of the `PersonAge`.\r\n\r\n  [1]: https://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch20.html#performance-fetching-profiles\r\n  [2]: http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/transaction/support/AbstractPlatformTransactionManager.html#doBegin-java.lang.Object-org.springframework.transaction.TransactionDefinition-","title":"How to fetch a field lazily with Hibernate Criteria","body":"<p>Your reasoning is valid (in general; we can however argue about the specific example of the <code>age</code> field), but unfortunately there is no straight-forward solution for this. Actually, Hibernate has the concept of <a href=\"https://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch20.html#performance-fetching-profiles\" rel=\"nofollow\">fetch profiles</a>, but it is currently very limited (you can override the default fetch plan/strategy only with the join-style fetch profiles).</p>\n\n<p>So, the possible workaround to your issue could be as follows.</p>\n\n<p>1) Move <code>age</code> to a separate entity and associate the <code>Person</code> entity with it with a lazy one-to-one relationship:</p>\n\n<pre><code>@Entity\nclass PersonAge {\n   private Integer age;\n}\n\n@Entity\nclass Person {\n   @OneToOne(cascade = CascadeType.ALL, fetch = FetchType.LAZY, orphanRemoval = true, optional = false)\n   @JoinColumn(name = \"PERSON_AGE_ID\")\n   private PersonAge personAge;\n\n   public Integer getAge() {\n      return personAge.getAge();\n   }\n\n   public void setAge(Integer age) {\n      personAge.setAge(age);\n   }\n}\n</code></pre>\n\n<p>2) Define a fetch profile which overrides the default one:</p>\n\n<pre><code>@FetchProfile(name = \"person-with-age\", fetchOverrides = {\n   @FetchProfile.FetchOverride(entity = Person.class, association = \"personAge\", mode = FetchMode.JOIN)\n})\n</code></pre>\n\n<p>3) Enable this profile for <em>each</em> session in the application:</p>\n\n<pre><code>session.enableFetchProfile(\"person-with-age\");\n</code></pre>\n\n<p>Depending on the framework you use, there should be an easy hook/interceptor which you will use to enable the profile for each session (transaction) that is craeted. For example, an approach in Spring could be to override <a href=\"http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/transaction/support/AbstractPlatformTransactionManager.html#doBegin-java.lang.Object-org.springframework.transaction.TransactionDefinition-\" rel=\"nofollow\">AbstractPlatformTransactionManager.doBegin</a> of the transaction manager in use.</p>\n\n<p>This way the <code>personAge</code> will be eagerly loaded in all the sessions in the application, unless the fetch profile is explicitly disabled.</p>\n\n<p>4) <em>Disable</em> the fetch profile in the session in which you use the desired Criteria query:</p>\n\n<pre><code>session.disableFetchProfile(\"person-with-age\");\n</code></pre>\n\n<p>This way the default fetch plan/strategy is used (specified in the entity mappings), which is the lazy loading of the <code>PersonAge</code>.</p>\n"},{"tags":[],"owner":{"account_id":4304651,"reputation":9315,"user_id":3517383,"accept_rate":41,"display_name":"gabrielgiussi"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1439383313,"creation_date":1439382280,"answer_id":31965162,"question_id":31785604,"body_markdown":"If your age is an object like the PersonAge of @Dragan you could associate the fecth mode with the criteria rather than the entity like you do.\r\n\r\nSo, I think you have three options:\r\n\r\n 1. age as primitive and projection like @Paco says (Person.age will be null and not a Proxy, you lose the lazyness that you want)\r\n 2. age as primitive without projection (more bytes in the wire)\r\n 3. age as PersonAge + criteria.setFetchMode (you will get the lazyness that you want at the cost of an extra object/table/mapping)\r\n\r\nFor Projection you could use ResultTransformer to\r\n\r\n    Criteria crit = session.createCriteria(Person.class);\r\n    ProjectionList projList = Projections.projectionList();\r\n    projList.add(Projections.property(&quot;name&quot;));\r\n    projList.add(Projections.property(&quot;firstname&quot;));\r\n    crit.setProjection(projList);\r\n    crit.setResultTransformer(new ResultTransformer() {\r\n\r\n          @Override\r\n          public Object transformTuple(Object[] tuple, String[] aliases) {\r\n            String name = (Long) tuple[0];\r\n            String firstName = (String) tuple[1];\r\n            return new Person(name , firstName);\r\n          }\r\n\r\n          @Override\r\n          public List&lt;Reference&gt; transformList(List collection) {\r\n            return collection;\r\n          }\r\n        });\r\n\r\nI think you could create a PersonProxy on your own that triggers a query for retrieve the age but this is kind of awful.\r\n\r\n      @Override\r\n      public Object transformTuple(Object[] tuple, String[] aliases) {\r\n        String name = (Long) tuple[0];\r\n        String firstName = (String) tuple[1];\r\n        return new PersonProxy(name , firstName);\r\n      }\r\n\r\n      class PersonProxy {\r\n        Person realPerson;\r\n        \r\n        public getAge(){\r\n           // create a query with realPerson.id for retrieve the age. \r\n        }\r\n      }","title":"How to fetch a field lazily with Hibernate Criteria","body":"<p>If your age is an object like the PersonAge of @Dragan you could associate the fecth mode with the criteria rather than the entity like you do.</p>\n\n<p>So, I think you have three options:</p>\n\n<ol>\n<li>age as primitive and projection like @Paco says (Person.age will be null and not a Proxy, you lose the lazyness that you want)</li>\n<li>age as primitive without projection (more bytes in the wire)</li>\n<li>age as PersonAge + criteria.setFetchMode (you will get the lazyness that you want at the cost of an extra object/table/mapping)</li>\n</ol>\n\n<p>For Projection you could use ResultTransformer to</p>\n\n<pre><code>Criteria crit = session.createCriteria(Person.class);\nProjectionList projList = Projections.projectionList();\nprojList.add(Projections.property(\"name\"));\nprojList.add(Projections.property(\"firstname\"));\ncrit.setProjection(projList);\ncrit.setResultTransformer(new ResultTransformer() {\n\n      @Override\n      public Object transformTuple(Object[] tuple, String[] aliases) {\n        String name = (Long) tuple[0];\n        String firstName = (String) tuple[1];\n        return new Person(name , firstName);\n      }\n\n      @Override\n      public List&lt;Reference&gt; transformList(List collection) {\n        return collection;\n      }\n    });\n</code></pre>\n\n<p>I think you could create a PersonProxy on your own that triggers a query for retrieve the age but this is kind of awful.</p>\n\n<pre><code>  @Override\n  public Object transformTuple(Object[] tuple, String[] aliases) {\n    String name = (Long) tuple[0];\n    String firstName = (String) tuple[1];\n    return new PersonProxy(name , firstName);\n  }\n\n  class PersonProxy {\n    Person realPerson;\n\n    public getAge(){\n       // create a query with realPerson.id for retrieve the age. \n    }\n  }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1012936,"reputation":145168,"user_id":1025118,"accept_rate":100,"display_name":"Vlad Mihalcea"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1515091985,"creation_date":1439567193,"answer_id":32013940,"question_id":31785604,"body_markdown":"You can simply define a new entity `SimplePerson` mapped to the same `persons` database table which contains only the following attributes:\r\n\r\n- id\r\n- name\r\n- firstName\r\n\r\nThis way, when selecting a `SimplePerson` with both Criteria and HQL, the age column will not be retrieved.\r\n\r\nAnother alternative is to use [lazy loading for basic attributes][1], but mapping multiple subentities to the same database table is much more flexible.\r\n\r\n\r\n  [1]: https://vladmihalcea.com/the-best-way-to-lazy-load-entity-attributes-using-jpa-and-hibernate/","title":"How to fetch a field lazily with Hibernate Criteria","body":"<p>You can simply define a new entity <code>SimplePerson</code> mapped to the same <code>persons</code> database table which contains only the following attributes:</p>\n\n<ul>\n<li>id</li>\n<li>name</li>\n<li>firstName</li>\n</ul>\n\n<p>This way, when selecting a <code>SimplePerson</code> with both Criteria and HQL, the age column will not be retrieved.</p>\n\n<p>Another alternative is to use <a href=\"https://vladmihalcea.com/the-best-way-to-lazy-load-entity-attributes-using-jpa-and-hibernate/\" rel=\"nofollow noreferrer\">lazy loading for basic attributes</a>, but mapping multiple subentities to the same database table is much more flexible.</p>\n"},{"tags":[],"owner":{"account_id":5988641,"reputation":121,"user_id":4705385,"display_name":"Rusli Usman"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641393245,"creation_date":1641366690,"answer_id":70589015,"question_id":31785604,"body_markdown":"I would like to add (or maybe clarify) the followings.  Given the main class (Settlement) with an attribute class (Customer):\r\n\r\n    @Entity\r\n    @Table(name = &quot;settlement&quot;) \r\n    public class Settlement extends IdBasedObject {\r\n    \r\n    ...\r\n    \r\n    \t@OneToOne(fetch=FetchType.LAZY)\r\n    \t@JoinColumn(name = &quot;customer_id_fk&quot;)\r\n    \tprivate Customer customer;\r\n    }\r\n\r\n    @Entity\r\n    @Table(name = &quot;customer&quot;, schema = SchemaUtil.SCHEMA_COMMON)\r\n    public class Customer extends IdBasedObject {\r\n    \t@Column(name = &quot;organization_type&quot;)\r\n    \t@Enumerated(EnumType.ORDINAL)\r\n    \tprivate CompanyType companyType;\r\n    \r\n    \t@Column(name = &quot;organization_legal_name&quot;)\r\n    \tprivate String companyLegalName;\r\n    \r\n        ...\r\n    }\r\n\r\nIf you would like to get all the distinct customers from the Settlement, you would use the Projections **distinct** on the &#39;customer&#39; property and followed by creating an alias from the Settlement class:\r\n\r\n    \tpublic List&lt;Customer&gt; findUniqueCustomer() throws Exception {\r\n    \t\tSession session = super.getSessionFactory().openSession();\r\n    \r\n    \t\tProjectionList projectionList = Projections.projectionList();\r\n    \t\tprojectionList.add(Projections.distinct(Projections.property(&quot;customer&quot;)));\r\n    \r\n    \t\tCriteria criteria = session.createCriteria(Settlement.class);\r\n            criteria.setProjection(projectionList);\r\n    \t\tcriteria.createAlias(&quot;customer&quot;, &quot;customer&quot;);\r\n    \r\n    return criteria.list();\r\n    }\r\n\r\nNow, if you do that, you will get back a list of non-proxy error &#39;could not initialize proxy - no Session&#39; for each of the customer object.\r\n\r\nFortunately, criteria provides the setResultTransformer function that will &#39;re-shape&#39; the return.\r\n\r\n    \t\tcriteria.setResultTransformer(new ResultTransformer() {\r\n    \t\t\t\r\n    \t\t\t@Override\r\n    \t\t\tpublic Object transformTuple(Object[] tuple, String[] aliases) {\r\n    \t\t\t\tCustomer customerObject = (Customer) tuple[0];\r\n    \t\t\t\t\r\n    \t\t\t\tCustomer customer = new Customer();\r\n    \t\t\t\tcustomer.setId(customerObject.getId());\r\n    \t\t\t\tcustomer.setVersion(customerObject.getVersion());\r\n    \t\t\t\tcustomer.setCompanyType(customerObject.getCompanyType());\r\n    \t\t\t\t \r\n                 customer.setCompanyLegalName(customerObject.getCompanyLegalName());\r\n                 return customer;\r\n                 ...\r\n              }\r\n    \r\n    \t\t\t@SuppressWarnings(&quot;rawtypes&quot;)\r\n    \t\t\t@Override\r\n    \t\t\tpublic List&lt;Customer&gt; transformList(List collection) {\r\n    \r\n    \t\t\t\treturn collection;\r\n    \t\t\t}\r\n    });\r\n\r\nThe tuple[0] essentially contains the customer object value, since the customer object is not proxied, you will get the error.  In the transformTuple function, you have a chance to &#39;re-create&#39; each of the customer object thereby avoiding the &#39;non-proxied&#39; error.\r\n\r\nPlease give a try.\r\n\r\n","title":"How to fetch a field lazily with Hibernate Criteria","body":"<p>I would like to add (or maybe clarify) the followings.  Given the main class (Settlement) with an attribute class (Customer):</p>\n<pre><code>@Entity\n@Table(name = &quot;settlement&quot;) \npublic class Settlement extends IdBasedObject {\n\n...\n\n    @OneToOne(fetch=FetchType.LAZY)\n    @JoinColumn(name = &quot;customer_id_fk&quot;)\n    private Customer customer;\n}\n\n@Entity\n@Table(name = &quot;customer&quot;, schema = SchemaUtil.SCHEMA_COMMON)\npublic class Customer extends IdBasedObject {\n    @Column(name = &quot;organization_type&quot;)\n    @Enumerated(EnumType.ORDINAL)\n    private CompanyType companyType;\n\n    @Column(name = &quot;organization_legal_name&quot;)\n    private String companyLegalName;\n\n    ...\n}\n</code></pre>\n<p>If you would like to get all the distinct customers from the Settlement, you would use the Projections <strong>distinct</strong> on the 'customer' property and followed by creating an alias from the Settlement class:</p>\n<pre><code>    public List&lt;Customer&gt; findUniqueCustomer() throws Exception {\n        Session session = super.getSessionFactory().openSession();\n\n        ProjectionList projectionList = Projections.projectionList();\n        projectionList.add(Projections.distinct(Projections.property(&quot;customer&quot;)));\n\n        Criteria criteria = session.createCriteria(Settlement.class);\n        criteria.setProjection(projectionList);\n        criteria.createAlias(&quot;customer&quot;, &quot;customer&quot;);\n\nreturn criteria.list();\n}\n</code></pre>\n<p>Now, if you do that, you will get back a list of non-proxy error 'could not initialize proxy - no Session' for each of the customer object.</p>\n<p>Fortunately, criteria provides the setResultTransformer function that will 're-shape' the return.</p>\n<pre><code>        criteria.setResultTransformer(new ResultTransformer() {\n            \n            @Override\n            public Object transformTuple(Object[] tuple, String[] aliases) {\n                Customer customerObject = (Customer) tuple[0];\n                \n                Customer customer = new Customer();\n                customer.setId(customerObject.getId());\n                customer.setVersion(customerObject.getVersion());\n                customer.setCompanyType(customerObject.getCompanyType());\n                 \n             customer.setCompanyLegalName(customerObject.getCompanyLegalName());\n             return customer;\n             ...\n          }\n\n            @SuppressWarnings(&quot;rawtypes&quot;)\n            @Override\n            public List&lt;Customer&gt; transformList(List collection) {\n\n                return collection;\n            }\n});\n</code></pre>\n<p>The tuple[0] essentially contains the customer object value, since the customer object is not proxied, you will get the error.  In the transformTuple function, you have a chance to 're-create' each of the customer object thereby avoiding the 'non-proxied' error.</p>\n<p>Please give a try.</p>\n"}],"owner":{"account_id":449256,"reputation":2122,"user_id":843943,"accept_rate":75,"display_name":"Grim"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":9538,"favorite_count":0,"down_vote_count":2,"up_vote_count":17,"answer_count":6,"score":15,"last_activity_date":1641393245,"creation_date":1438599864,"question_id":31785604,"body_markdown":"Each row of the table `Person` (having `name`, `firstname` and `age`) shall be read.\r\n\r\n    EntityManager em = emf.createEntityManager();\r\n    Session s = (Session) em.getDelegate();\r\n    Criteria criteria = s.createCriteria(Person.class);\r\n    criteria.setFetchMode(&quot;age&quot;, FetchMode.SELECT);\r\n\r\nBut the SQL shows\r\n\r\n    Hibernate:\r\n        select\r\n            person0_.name,\r\n            person0_.firstname,\r\n            person0_.age\r\n        from \r\n            SCOPE.PERSON person0_\r\n\r\nHow to let the age be lazy **ONLY** for the Criteria??","title":"How to fetch a field lazily with Hibernate Criteria","body":"<p>Each row of the table <code>Person</code> (having <code>name</code>, <code>firstname</code> and <code>age</code>) shall be read.</p>\n\n<pre><code>EntityManager em = emf.createEntityManager();\nSession s = (Session) em.getDelegate();\nCriteria criteria = s.createCriteria(Person.class);\ncriteria.setFetchMode(\"age\", FetchMode.SELECT);\n</code></pre>\n\n<p>But the SQL shows</p>\n\n<pre><code>Hibernate:\n    select\n        person0_.name,\n        person0_.firstname,\n        person0_.age\n    from \n        SCOPE.PERSON person0_\n</code></pre>\n\n<p>How to let the age be lazy <strong>ONLY</strong> for the Criteria??</p>\n"},{"tags":["java","arraylist"],"comments":[{"owner":{"account_id":15591203,"reputation":66,"user_id":11248197,"display_name":"ErayZaxy"},"score":0,"creation_date":1641327466,"post_id":70584478,"comment_id":124775636,"body_markdown":"You first need to create an object inside main(), and then call initializeSkillList() on that object","body":"You first need to create an object inside main(), and then call initializeSkillList() on that object"},{"owner":{"account_id":14357,"reputation":9128,"user_id":29470,"display_name":"Tim Moore"},"score":0,"creation_date":1641327713,"post_id":70584478,"comment_id":124775726,"body_markdown":"Please include the definition of `charCreation`","body":"Please include the definition of <code>charCreation</code>"},{"owner":{"account_id":15591203,"reputation":66,"user_id":11248197,"display_name":"ErayZaxy"},"score":1,"creation_date":1641327755,"post_id":70584478,"comment_id":124775737,"body_markdown":"Why create those object inside of the class, why not create them in main and then name each type of skill when creating a new Skill using its constructor. Making a list &quot;skillList &quot; inside the clas &quot;Skill&quot; breaks the whole concept of OOP. It is maybe better to have another class playerSkills and then have a list of Skill there, it would make much more sense","body":"Why create those object inside of the class, why not create them in main and then name each type of skill when creating a new Skill using its constructor. Making a list &quot;skillList &quot; inside the clas &quot;Skill&quot; breaks the whole concept of OOP. It is maybe better to have another class playerSkills and then have a list of Skill there, it would make much more sense"},{"owner":{"account_id":23828160,"reputation":1,"user_id":17834869,"display_name":"Christopher McLernon"},"score":0,"creation_date":1641335552,"post_id":70584478,"comment_id":124778031,"body_markdown":"I initially had the initializeSkillList() method and &quot;skillList&quot; list in a different Character class but it wouldn&#39;t work so I tried moving it but that didn&#39;t fix it but even the print statement in the method doesn&#39;t print the correct values it only gives null or 0","body":"I initially had the initializeSkillList() method and &quot;skillList&quot; list in a different Character class but it wouldn&#39;t work so I tried moving it but that didn&#39;t fix it but even the print statement in the method doesn&#39;t print the correct values it only gives null or 0"},{"owner":{"account_id":18243171,"reputation":19300,"user_id":13279831,"display_name":"Nowhere Man"},"score":0,"creation_date":1641342848,"post_id":70584478,"comment_id":124779511,"body_markdown":"_What_ is printed as null, which line?","body":"<i>What</i> is printed as null, which line?"},{"owner":{"account_id":23828160,"reputation":1,"user_id":17834869,"display_name":"Christopher McLernon"},"score":0,"creation_date":1641345868,"post_id":70584478,"comment_id":124780025,"body_markdown":"The debug statement inside of the initializeSkillList() method that is meant to print the skillValue but it prints 0 and when I ask for the skillName it gives null but I checked and the list is the correct size its like it&#39;s filled with empty Skill objects","body":"The debug statement inside of the initializeSkillList() method that is meant to print the skillValue but it prints 0 and when I ask for the skillName it gives null but I checked and the list is the correct size its like it&#39;s filled with empty Skill objects"}],"answers":[{"tags":[],"owner":{"account_id":15591203,"reputation":66,"user_id":11248197,"display_name":"ErayZaxy"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641328429,"creation_date":1641328429,"answer_id":70584723,"question_id":70584478,"body_markdown":"If you create a getter for &quot;skillList&quot; then you can just say\r\n\r\n    Skill.getSkillList();\r\nAnd then do whatever you want with this list.\r\nTo make your code a little better, change this\r\n\r\n    public static ArrayList&lt;Skill&gt; skillList = new ArrayList&lt;&gt;();\r\nto this\r\n\r\n    public static List&lt;Skill&gt; skillList = new ArrayList&lt;&gt;();","title":"An ArrayList that should have objects from a created class but print as null","body":"<p>If you create a getter for &quot;skillList&quot; then you can just say</p>\n<pre><code>Skill.getSkillList();\n</code></pre>\n<p>And then do whatever you want with this list.\nTo make your code a little better, change this</p>\n<pre><code>public static ArrayList&lt;Skill&gt; skillList = new ArrayList&lt;&gt;();\n</code></pre>\n<p>to this</p>\n<pre><code>public static List&lt;Skill&gt; skillList = new ArrayList&lt;&gt;();\n</code></pre>\n"}],"owner":{"account_id":23828160,"reputation":1,"user_id":17834869,"display_name":"Christopher McLernon"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":78,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1641393037,"creation_date":1641326870,"question_id":70584478,"body_markdown":"My first class that creates the ArrayList and populates it with the Skill objects\r\n```\r\nimport java.util.ArrayList;\r\n\r\npublic class Skill {\r\n    String skillName;\r\n    int skillValue;\r\n    public static ArrayList&lt;Skill&gt; skillList = new ArrayList&lt;Skill&gt;();\r\n\r\n    public Skill(String newSkillName, int newSkillValue){\r\n        setSkillName(newSkillName);\r\n        setSkillValue(newSkillValue);\r\n    }\r\n\r\n    public static void initializeSkillList(){\r\n        //Creating the Skill obj&#39;s\r\n        Skill str = new Skill(&quot;Str&quot;, 1);\r\n        Skill dex = new Skill(&quot;Dex&quot;, 1);\r\n        Skill intl = new Skill(&quot;Int&quot;, 1);\r\n        Skill con = new Skill(&quot;Con&quot;, 3);\r\n\r\n        //Adding them to the Skill ArrayList\r\n        skillList.add(str);\r\n        skillList.add(dex);\r\n        skillList.add(intl);\r\n        skillList.add(con);\r\n\r\n        //Debug statement to check if the values are correct\r\n        System.out.println(skillList.get(1).skillValue);\r\n    }\r\n}\r\n```\r\nI am attempting to access the objects skillValue and skillName from the ArrayList in my Main.java class. I have setters and getters.\r\nThis is the Main class\r\n```\r\nimport java.util.Scanner;\r\n\r\npublic class Main {\r\n    static Character playerCharacter;\r\n    static boolean charCreationComplete = false;\r\n    static boolean endGame = false;\r\n    static Scanner scnr = new Scanner(System.in);\r\n\r\n    public static void main(String[] args){\r\n        System.out.println(&quot;\\n\\nWelcome to Garterra!\\n\\n&quot;);\r\n        Archetype.initializeArchetypeList();\r\n        Skill.initializeSkillList();\r\n\r\n        if (!charCreationComplete){\r\n            charCreation(scnr);\r\n            charCreationComplete = true;\r\n        }\r\n```\r\n`charCreation(scnr);` then accesses the skillList through getters and setters\r\n\r\ncharCreation() Method:\r\n```\r\nprivate static void charCreation(Scanner scnr){\r\n\r\n    System.out.println(&quot;\\nEnter player name:\\n\\n&quot;);\r\n    String newName = scnr.nextLine();\r\n    System.out.println(&quot;You Entered &quot; + newName + &quot; for your name!\\n&quot;);\r\n    System.out.println(&quot;Next, Choose your Archetype: 0 = Ranger\\n&quot;);\r\n    int archetypeIndex = scnr.nextInt();\r\n    Character.currArchetype = Archetype.archetypeList.get(archetypeIndex);\r\n    Character.archetypeName = Archetype.archetypeList.get(archetypeIndex).getArchetypeName();\r\n    System.out.println(&quot;You have chosen &quot; + Character.archetypeName + &quot;.\\nThis gives you &quot; + Character.currArchetype.totalSpendableSkillPoints + &quot; total spendable skill points!\\n&quot;);\r\n    System.out.println(&quot;Now, spend those skill points.\\n&quot;);\r\n    if (Character.currArchetype.getArchetypeName().contains(&quot;Ranger&quot;)){\r\n        Ranger.dexModifierCalc(1);\r\n        Ranger.conModifierCalc(1);\r\n    }\r\n    while (Character.currArchetype.totalSpendableSkillPoints &gt; 0){\r\n        System.out.println(&quot;How many points would you like to put into Strength?\\nThis impacts your melee weapon damage and carry weight.\\n&quot;);\r\n        int strAddPoints = scnr.nextInt();\r\n        Skill.skillList.get(0).setSkillValue(Skill.skillList.get(0).getSkillValue() + strAddPoints);\r\n        Character.currArchetype.setTotalSpendableSkillPoints(Character.currArchetype.totalSpendableSkillPoints - strAddPoints);\r\n        strAddPoints = 0;\r\n        System.out.println(&quot;You now have &quot; + Skill.skillList.get(0).getSkillValue() + &quot;\\n&quot;);\r\n        if (Character.currArchetype.totalSpendableSkillPoints == 0){\r\n            break;\r\n        }\r\n        if (Character.currArchetype.totalSpendableSkillPoints &gt; 0){\r\n            System.out.println(&quot;How many points would you like to put into Dexterity?\\nThis impacts your ranged weapon damage.\\n&quot;);\r\n            int dexAddPoints = scnr.nextInt();\r\n            Skill.skillList.get(1).setSkillValue(Skill.skillList.get(1).getSkillValue() + dexAddPoints);\r\n            Character.currArchetype.setTotalSpendableSkillPoints(Character.currArchetype.totalSpendableSkillPoints - dexAddPoints);\r\n            dexAddPoints = 0;\r\n            System.out.println(&quot;You now have &quot; + Skill.skillList.get(1).getSkillValue() + &quot;\\n&quot;);\r\n        }\r\n            if (Character.currArchetype.totalSpendableSkillPoints == 0){\r\n            break;\r\n        }\r\n        if (Character.currArchetype.totalSpendableSkillPoints &gt; 0){\r\n            System.out.println(&quot;How many points would you like to put into Intelligence?\\nThis impacts your magic damage.\\n&quot;);\r\n            int intAddPoints = scnr.nextInt();\r\n            Skill.skillList.get(2).setSkillValue(Skill.skillList.get(2).getSkillValue() + intAddPoints);\r\n            Character.currArchetype.setTotalSpendableSkillPoints(Character.currArchetype.totalSpendableSkillPoints - intAddPoints);\r\n            intAddPoints = 0;\r\n            System.out.println(&quot;You now have &quot; + Skill.skillList.get(2).getSkillValue() + &quot;\\n&quot;);\r\n        }\r\n            if (Character.currArchetype.totalSpendableSkillPoints == 0){\r\n            break;\r\n        }\r\n        if (Character.currArchetype.totalSpendableSkillPoints &gt; 0){\r\n            System.out.println(&quot;How many points would you like to put into Strength?\\nThis impacts your melee weapon damage and carry weight.\\n&quot;);\r\n            int conAddPoints = scnr.nextInt();\r\n            Skill.skillList.get(3).setSkillValue(Skill.skillList.get(3).getSkillValue() + conAddPoints);\r\n            Character.currArchetype.setTotalSpendableSkillPoints(Character.currArchetype.totalSpendableSkillPoints - conAddPoints);\r\n            conAddPoints = 0;\r\n            System.out.println(&quot;You now have &quot; + Skill.skillList.get(3).getSkillValue() + &quot;\\n&quot;);\r\n        }\r\n    }\r\n    int newHealthPoints = Character.healthPointsCalc();\r\n    System.out.println(&quot;You have &quot; + newHealthPoints + &quot; health points!\\n\\n&quot;);\r\n    int newTotalCarryWeight = Character.carryWeightCalc(Character.currArchetype.getLevel());\r\n    System.out.println(&quot;Your total carry weight is &quot; + newTotalCarryWeight + &quot;.\\n&quot;);\r\n    int newExperince = 0;\r\n    playerCharacter = new Character(newName, newHealthPoints, newExperince, 1, Archetype.archetypeList.get(archetypeIndex), newTotalCarryWeight);\r\n}\r\n```\r\n","title":"An ArrayList that should have objects from a created class but print as null","body":"<p>My first class that creates the ArrayList and populates it with the Skill objects</p>\n<pre><code>import java.util.ArrayList;\n\npublic class Skill {\n    String skillName;\n    int skillValue;\n    public static ArrayList&lt;Skill&gt; skillList = new ArrayList&lt;Skill&gt;();\n\n    public Skill(String newSkillName, int newSkillValue){\n        setSkillName(newSkillName);\n        setSkillValue(newSkillValue);\n    }\n\n    public static void initializeSkillList(){\n        //Creating the Skill obj's\n        Skill str = new Skill(&quot;Str&quot;, 1);\n        Skill dex = new Skill(&quot;Dex&quot;, 1);\n        Skill intl = new Skill(&quot;Int&quot;, 1);\n        Skill con = new Skill(&quot;Con&quot;, 3);\n\n        //Adding them to the Skill ArrayList\n        skillList.add(str);\n        skillList.add(dex);\n        skillList.add(intl);\n        skillList.add(con);\n\n        //Debug statement to check if the values are correct\n        System.out.println(skillList.get(1).skillValue);\n    }\n}\n</code></pre>\n<p>I am attempting to access the objects skillValue and skillName from the ArrayList in my Main.java class. I have setters and getters.\nThis is the Main class</p>\n<pre><code>import java.util.Scanner;\n\npublic class Main {\n    static Character playerCharacter;\n    static boolean charCreationComplete = false;\n    static boolean endGame = false;\n    static Scanner scnr = new Scanner(System.in);\n\n    public static void main(String[] args){\n        System.out.println(&quot;\\n\\nWelcome to Garterra!\\n\\n&quot;);\n        Archetype.initializeArchetypeList();\n        Skill.initializeSkillList();\n\n        if (!charCreationComplete){\n            charCreation(scnr);\n            charCreationComplete = true;\n        }\n</code></pre>\n<p><code>charCreation(scnr);</code> then accesses the skillList through getters and setters</p>\n<p>charCreation() Method:</p>\n<pre><code>private static void charCreation(Scanner scnr){\n\n    System.out.println(&quot;\\nEnter player name:\\n\\n&quot;);\n    String newName = scnr.nextLine();\n    System.out.println(&quot;You Entered &quot; + newName + &quot; for your name!\\n&quot;);\n    System.out.println(&quot;Next, Choose your Archetype: 0 = Ranger\\n&quot;);\n    int archetypeIndex = scnr.nextInt();\n    Character.currArchetype = Archetype.archetypeList.get(archetypeIndex);\n    Character.archetypeName = Archetype.archetypeList.get(archetypeIndex).getArchetypeName();\n    System.out.println(&quot;You have chosen &quot; + Character.archetypeName + &quot;.\\nThis gives you &quot; + Character.currArchetype.totalSpendableSkillPoints + &quot; total spendable skill points!\\n&quot;);\n    System.out.println(&quot;Now, spend those skill points.\\n&quot;);\n    if (Character.currArchetype.getArchetypeName().contains(&quot;Ranger&quot;)){\n        Ranger.dexModifierCalc(1);\n        Ranger.conModifierCalc(1);\n    }\n    while (Character.currArchetype.totalSpendableSkillPoints &gt; 0){\n        System.out.println(&quot;How many points would you like to put into Strength?\\nThis impacts your melee weapon damage and carry weight.\\n&quot;);\n        int strAddPoints = scnr.nextInt();\n        Skill.skillList.get(0).setSkillValue(Skill.skillList.get(0).getSkillValue() + strAddPoints);\n        Character.currArchetype.setTotalSpendableSkillPoints(Character.currArchetype.totalSpendableSkillPoints - strAddPoints);\n        strAddPoints = 0;\n        System.out.println(&quot;You now have &quot; + Skill.skillList.get(0).getSkillValue() + &quot;\\n&quot;);\n        if (Character.currArchetype.totalSpendableSkillPoints == 0){\n            break;\n        }\n        if (Character.currArchetype.totalSpendableSkillPoints &gt; 0){\n            System.out.println(&quot;How many points would you like to put into Dexterity?\\nThis impacts your ranged weapon damage.\\n&quot;);\n            int dexAddPoints = scnr.nextInt();\n            Skill.skillList.get(1).setSkillValue(Skill.skillList.get(1).getSkillValue() + dexAddPoints);\n            Character.currArchetype.setTotalSpendableSkillPoints(Character.currArchetype.totalSpendableSkillPoints - dexAddPoints);\n            dexAddPoints = 0;\n            System.out.println(&quot;You now have &quot; + Skill.skillList.get(1).getSkillValue() + &quot;\\n&quot;);\n        }\n            if (Character.currArchetype.totalSpendableSkillPoints == 0){\n            break;\n        }\n        if (Character.currArchetype.totalSpendableSkillPoints &gt; 0){\n            System.out.println(&quot;How many points would you like to put into Intelligence?\\nThis impacts your magic damage.\\n&quot;);\n            int intAddPoints = scnr.nextInt();\n            Skill.skillList.get(2).setSkillValue(Skill.skillList.get(2).getSkillValue() + intAddPoints);\n            Character.currArchetype.setTotalSpendableSkillPoints(Character.currArchetype.totalSpendableSkillPoints - intAddPoints);\n            intAddPoints = 0;\n            System.out.println(&quot;You now have &quot; + Skill.skillList.get(2).getSkillValue() + &quot;\\n&quot;);\n        }\n            if (Character.currArchetype.totalSpendableSkillPoints == 0){\n            break;\n        }\n        if (Character.currArchetype.totalSpendableSkillPoints &gt; 0){\n            System.out.println(&quot;How many points would you like to put into Strength?\\nThis impacts your melee weapon damage and carry weight.\\n&quot;);\n            int conAddPoints = scnr.nextInt();\n            Skill.skillList.get(3).setSkillValue(Skill.skillList.get(3).getSkillValue() + conAddPoints);\n            Character.currArchetype.setTotalSpendableSkillPoints(Character.currArchetype.totalSpendableSkillPoints - conAddPoints);\n            conAddPoints = 0;\n            System.out.println(&quot;You now have &quot; + Skill.skillList.get(3).getSkillValue() + &quot;\\n&quot;);\n        }\n    }\n    int newHealthPoints = Character.healthPointsCalc();\n    System.out.println(&quot;You have &quot; + newHealthPoints + &quot; health points!\\n\\n&quot;);\n    int newTotalCarryWeight = Character.carryWeightCalc(Character.currArchetype.getLevel());\n    System.out.println(&quot;Your total carry weight is &quot; + newTotalCarryWeight + &quot;.\\n&quot;);\n    int newExperince = 0;\n    playerCharacter = new Character(newName, newHealthPoints, newExperince, 1, Archetype.archetypeList.get(archetypeIndex), newTotalCarryWeight);\n}\n</code></pre>\n"},{"tags":["java","mysql","postgresql","quarkus","entitymanager"],"comments":[{"owner":{"display_name":"user330315"},"score":0,"creation_date":1640907855,"post_id":70532075,"comment_id":124689984,"body_markdown":"As a side note: the &quot;short name&quot; of PostgreSQL is Postgre**s** not &quot;Postgre&quot;","body":"As a side note: the &quot;short name&quot; of PostgreSQL is Postgre<b>s</b> not &quot;Postgre&quot;"},{"owner":{"account_id":3048966,"reputation":11,"user_id":15868520,"display_name":"Luiz Sergio Pinheiro Bernardo"},"score":0,"creation_date":1641003188,"post_id":70532075,"comment_id":124706752,"body_markdown":"@a_horse_with_no_name thanks for the advice. Just put this example to show I want **singleton** instances accessing 2 different databases.","body":"@a_horse_with_no_name thanks for the advice. Just put this example to show I want <b>singleton</b> instances accessing 2 different databases."}],"answers":[{"tags":[],"owner":{"account_id":6518696,"reputation":10106,"user_id":5043585,"display_name":"Guillaume Smet"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1640906251,"creation_date":1640906251,"answer_id":70537618,"question_id":70532075,"body_markdown":"Your pattern is extremely weird.\r\n\r\nIf you want a singleton DAO, just use `@ApplicationScoped` for the scope of your DAO. Don&#39;t make it `@RequestScoped` and then have a static instance, it&#39;s going to be broken.\r\n\r\nThen, with Quarkus, you shouldn&#39;t create the `EntityManagerFactory` yourself. You can just inject an `EntityManager` with:\r\n\r\n```\r\n@Inject\r\n@PersistenceUnit(&quot;postgre&quot;)\r\nEntityManager entityManager;\r\n```\r\n\r\nand you&#39;re done.","title":"EntityManager and createEntityManagerFactory with application.properties","body":"<p>Your pattern is extremely weird.</p>\n<p>If you want a singleton DAO, just use <code>@ApplicationScoped</code> for the scope of your DAO. Don't make it <code>@RequestScoped</code> and then have a static instance, it's going to be broken.</p>\n<p>Then, with Quarkus, you shouldn't create the <code>EntityManagerFactory</code> yourself. You can just inject an <code>EntityManager</code> with:</p>\n<pre><code>@Inject\n@PersistenceUnit(&quot;postgre&quot;)\nEntityManager entityManager;\n</code></pre>\n<p>and you're done.</p>\n"},{"tags":[],"owner":{"account_id":3048966,"reputation":11,"user_id":15868520,"display_name":"Luiz Sergio Pinheiro Bernardo"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641393036,"creation_date":1641393036,"answer_id":70594616,"question_id":70532075,"body_markdown":"**Finally found a solution to this issue**, after searching lots here and googling for any answer.\r\n\r\nInstead of manually creating `instance` field on those classes, to make singleton classes within [Quarkus](https://quarkus.io/) you shall use `@Singleton` annotation.\r\n\r\nFixed **ReadSubjectDao.java**:\r\n```java\r\npackage com.luiz.teste.dao.postgres;\r\n\r\nimport com.luiz.teste.exceptions.postgres.ReadSubjectDaoFindException;\r\n\r\nimport org.eclipse.microprofile.opentracing.Traced;\r\nimport javax.inject.Singleton;\r\nimport javax.inject.Inject;\r\nimport io.quarkus.hibernate.orm.PersistenceUnit;\r\nimport javax.persistence.EntityManager;\r\nimport javax.persistence.NoResultException;\r\nimport javax.persistence.PersistenceException;\r\n\r\n@Traced\r\n@Singleton\r\npublic class ReadSubjectDao {\r\n    @Inject\r\n    @PersistenceUnit(&quot;postgres&quot;)\r\n    EntityManager em;\r\n\r\n    public ReadSubject findById(int id) throws ReadSubjectDaoFindException {\r\n        try {    \r\n            return em.find(ReadSubject.class, id);\r\n        }\r\n        catch (NoResultException e) {\r\n            return null;\r\n        }\r\n        catch (PersistenceException e) {\r\n            throw new ReadSubjectDaoFindException(e);\r\n        }\r\n    }\r\n}\r\n```\r\nFixed **WriteSubjectDao.java**:\r\n```java\r\npackage com.luiz.teste.dao.mysql;\r\n\r\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoFindException;\r\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoPersistException;\r\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoMergeException;\r\n\r\nimport org.eclipse.microprofile.opentracing.Traced;\r\nimport javax.inject.Singleton;\r\nimport javax.inject.Inject;\r\nimport io.quarkus.hibernate.orm.PersistenceUnit;\r\nimport javax.persistence.EntityManager;\r\nimport javax.persistence.NoResultException;\r\nimport javax.persistence.PersistenceException;\r\nimport javax.transaction.Transactional;\r\n\r\n@Traced\r\n@Singleton\r\npublic class WriteSubjectDao {\r\n    @Inject\r\n    @PersistenceUnit(&quot;mysql&quot;)\r\n    EntityManager em;\r\n\r\n    public WriteSubject findById(int id) throws WriteSubjectDaoFindException {\r\n        try {    \r\n            return em.find(WriteSubject.class, id);\r\n        }\r\n        catch (NoResultException e) {\r\n            return null;\r\n        }\r\n        catch (PersistenceException e) {\r\n            throw new WriteSubjectDaoFindException(e);\r\n        }\r\n    }\r\n\r\n    @Transactional\r\n    public void persist(WriteSubject writeSubject) throws WriteSubjectDaoPersistException {\r\n        try {\r\n            em.persist(writeSubject);\r\n        }\r\n        catch (Exception e) {            \r\n            throw new WriteSubjectDaoPersistException(e);\r\n        }\r\n    }\r\n\r\n    @Transactional\r\n    public void merge(WriteSubject writeSubject) throws WriteSubjectDaoMergeException {\r\n        try {\r\n            em.merge(writeSubject);\r\n        }\r\n        catch (Exception e) {\r\n            throw new WriteSubjectDaoMergeException(e);\r\n        }\r\n    }\r\n}\r\n```\r\nThe **application.properties** remain unchanged.&lt;br/&gt;\r\nTo call any of those 2 singleton DAO classes, just use `@Inject` annotation on caller classes, as usual.","title":"EntityManager and createEntityManagerFactory with application.properties","body":"<p><strong>Finally found a solution to this issue</strong>, after searching lots here and googling for any answer.</p>\n<p>Instead of manually creating <code>instance</code> field on those classes, to make singleton classes within <a href=\"https://quarkus.io/\" rel=\"nofollow noreferrer\">Quarkus</a> you shall use <code>@Singleton</code> annotation.</p>\n<p>Fixed <strong>ReadSubjectDao.java</strong>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.luiz.teste.dao.postgres;\n\nimport com.luiz.teste.exceptions.postgres.ReadSubjectDaoFindException;\n\nimport org.eclipse.microprofile.opentracing.Traced;\nimport javax.inject.Singleton;\nimport javax.inject.Inject;\nimport io.quarkus.hibernate.orm.PersistenceUnit;\nimport javax.persistence.EntityManager;\nimport javax.persistence.NoResultException;\nimport javax.persistence.PersistenceException;\n\n@Traced\n@Singleton\npublic class ReadSubjectDao {\n    @Inject\n    @PersistenceUnit(&quot;postgres&quot;)\n    EntityManager em;\n\n    public ReadSubject findById(int id) throws ReadSubjectDaoFindException {\n        try {    \n            return em.find(ReadSubject.class, id);\n        }\n        catch (NoResultException e) {\n            return null;\n        }\n        catch (PersistenceException e) {\n            throw new ReadSubjectDaoFindException(e);\n        }\n    }\n}\n</code></pre>\n<p>Fixed <strong>WriteSubjectDao.java</strong>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.luiz.teste.dao.mysql;\n\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoFindException;\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoPersistException;\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoMergeException;\n\nimport org.eclipse.microprofile.opentracing.Traced;\nimport javax.inject.Singleton;\nimport javax.inject.Inject;\nimport io.quarkus.hibernate.orm.PersistenceUnit;\nimport javax.persistence.EntityManager;\nimport javax.persistence.NoResultException;\nimport javax.persistence.PersistenceException;\nimport javax.transaction.Transactional;\n\n@Traced\n@Singleton\npublic class WriteSubjectDao {\n    @Inject\n    @PersistenceUnit(&quot;mysql&quot;)\n    EntityManager em;\n\n    public WriteSubject findById(int id) throws WriteSubjectDaoFindException {\n        try {    \n            return em.find(WriteSubject.class, id);\n        }\n        catch (NoResultException e) {\n            return null;\n        }\n        catch (PersistenceException e) {\n            throw new WriteSubjectDaoFindException(e);\n        }\n    }\n\n    @Transactional\n    public void persist(WriteSubject writeSubject) throws WriteSubjectDaoPersistException {\n        try {\n            em.persist(writeSubject);\n        }\n        catch (Exception e) {            \n            throw new WriteSubjectDaoPersistException(e);\n        }\n    }\n\n    @Transactional\n    public void merge(WriteSubject writeSubject) throws WriteSubjectDaoMergeException {\n        try {\n            em.merge(writeSubject);\n        }\n        catch (Exception e) {\n            throw new WriteSubjectDaoMergeException(e);\n        }\n    }\n}\n</code></pre>\n<p>The <strong>application.properties</strong> remain unchanged.<br/>\nTo call any of those 2 singleton DAO classes, just use <code>@Inject</code> annotation on caller classes, as usual.</p>\n"}],"owner":{"account_id":3048966,"reputation":11,"user_id":15868520,"display_name":"Luiz Sergio Pinheiro Bernardo"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":675,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1641393036,"creation_date":1640869450,"question_id":70532075,"body_markdown":"I have to create singleton classes using DAO classes.\r\n\r\nFollowing is a DAO reading class example:\r\n```java\r\npackage com.luiz.teste.dao;\r\n\r\nimport com.luiz.teste.exceptions.postgres.ReadSubjectDaoFindException;\r\n\r\nimport org.eclipse.microprofile.opentracing.Traced;\r\nimport javax.enterprise.context.RequestScoped;\r\nimport javax.persistence.EntityManager;\r\nimport javax.persistence.EntityTransaction;\r\nimport javax.persistence.NoResultException;\r\nimport javax.persistence.Persistence;\r\nimport javax.persistence.PersistenceException;\r\n\r\n@Traced\r\n@ApplicationScoped\r\npublic class ReadSubjectDao {\r\n    private static ReadSubjectDao instance = new ReadSubjectDao();\r\n    protected EntityManager em;\r\n    \r\n    public static ReadSubjectDao getInstance() {\r\n        return instance;\r\n    }\r\n    \r\n    private ReadSubjectDao() {\r\n        if (em == null) {\r\n            em = Persistence.createEntityManagerFactory(&quot;postgres&quot;).createEntityManager();\r\n        }\r\n    }\r\n\r\n    public ReadSubject findById(int id) throws ReadSubjectDaoFindException {\r\n        try {    \r\n            return em.find(ReadSubject.class, id);\r\n        }\r\n        catch (NoResultException e) {\r\n            return null;\r\n        }\r\n        catch (PersistenceException e) {\r\n            throw new ReadSubjectDaoFindException(e);\r\n        }\r\n    }\r\n}\r\n```\r\nFollowing is a DAO writing class example:\r\n```java\r\npackage com.luiz.teste.dao;\r\n\r\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoFindException;\r\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoPersistException;\r\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoMergeException;\r\n\r\nimport org.eclipse.microprofile.opentracing.Traced;\r\nimport javax.enterprise.context.RequestScoped;\r\nimport javax.persistence.EntityManager;\r\nimport javax.persistence.EntityTransaction;\r\nimport javax.persistence.NoResultException;\r\nimport javax.persistence.Persistence;\r\nimport javax.persistence.PersistenceException;\r\n\r\n@Traced\r\n@ApplicationScoped\r\npublic class WriteSubjectDao {\r\n    private static WriteSubjectDao instance = new WriteSubjectDao();\r\n    protected EntityManager em;\r\n    \r\n    public static WriteSubjectDao getInstance() {\r\n        return instance;\r\n    }\r\n    \r\n    private WriteSubjectDao() {\r\n        if (em == null) {\r\n            em = Persistence.createEntityManagerFactory(&quot;mysql&quot;).createEntityManager();\r\n        }\r\n    }\r\n\r\n    public WriteSubject findById(int id) throws WriteSubjectDaoFindException {\r\n        try {    \r\n            return em.find(WriteSubject.class, id);\r\n        }\r\n        catch (NoResultException e) {\r\n            return null;\r\n        }\r\n        catch (PersistenceException e) {\r\n            throw new WriteSubjectDaoFindException(e);\r\n        }\r\n    }\r\n    \r\n    public void persist(WriteSubject writeSubject) throws WriteSubjectDaoPersistException {\r\n        EntityTransaction et = em.getTransaction();\r\n        try {\r\n            et.begin();\r\n            em.persist(writeSubject);\r\n            et.commit();\r\n        }\r\n        catch (Exception e) {            \r\n            if (et.isActive())\r\n                et.rollback();\r\n            throw new WriteSubjectDaoPersistException(e);\r\n        }\r\n    }\r\n\r\n    public void merge(WriteSubject writeSubject) throws WriteSubjectDaoMergeException {\r\n        EntityTransaction et = em.getTransaction();\r\n        try {\r\n            et.begin();\r\n            em.merge(writeSubject);\r\n            et.commit();\r\n        }\r\n        catch (Exception e) {\r\n            if (et.isActive())\r\n                et.rollback();\r\n            throw new WriteSubjectDaoMergeException(e);\r\n        }\r\n    }\r\n}\r\n```\r\nFollowing is **application.properties**:\r\n```\r\n# Configuration file\r\n# key = value\r\nquarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %X{requestID} %s%e%n\r\n\r\nmp.metrics.tags=app=${quarkus.application.name},version=${quarkus.application.version}\r\n%test.mp.metrics.tags=app=app-test,version=1.0.0\r\n\r\nmp.openapi.filter=com.luiz.teste.dev.ext.filters.OpenApiFilter\r\n\r\nquarkus.swagger-ui.path=/api-docs\r\nquarkus.smallrye-openapi.path=/api-docs-json\r\nquarkus.swagger-ui.always-include=true\r\n\r\nquarkus.http.test-port=8083\r\nquarkus.http.test-ssl-port=8446\r\n\r\nquarkus.datasource.jdbc.enable-metrics=true\r\n\r\n# Postgre - Build time\r\nquarkus.datasource.&quot;postgres&quot;.db-kind=db2\r\nquarkus.datasource.&quot;postgres&quot;.jdbc.url=${POSTGRE_JDBC}\r\nquarkus.datasource.&quot;postgres&quot;.username=${POSTGRE_USER}\r\nquarkus.datasource.&quot;postgres&quot;.password=${POSTGRE_PASSWORD}\r\nquarkus.hibernate-orm.&quot;postgres&quot;.datasource=postgres\r\nquarkus.hibernate-orm.&quot;postgres&quot;.packages=com.luiz.teste.models.postgres\r\nquarkus.hibernate-orm.&quot;postgres&quot;.log.jdbc-warnings=false\r\nquarkus.hibernate-orm.&quot;postgres&quot;.log.sql=true\r\n\r\n# MySQL - Build time\r\nquarkus.datasource.&quot;mysql&quot;.db-kind=mysql\r\nquarkus.datasource.&quot;mysql&quot;.jdbc.url=${MYSQL_JDBC}\r\nquarkus.datasource.&quot;mysql&quot;.username=${MYSQL_USER}\r\nquarkus.datasource.&quot;mysql&quot;.password=${MYSQL_PASSWORD}\r\nquarkus.hibernate-orm.&quot;mysql&quot;.datasource=mysql\r\nquarkus.hibernate-orm.&quot;mysql&quot;.packages=com.luiz.teste.models.mysql\r\nquarkus.hibernate-orm.&quot;mysql&quot;.log.jdbc-warnings=false\r\nquarkus.hibernate-orm.&quot;mysql&quot;.log.sql=true\r\n```\r\nAs far as I&#39;ve searched through this site (and through https://www.google.com too), I know so far only by using `persistence.xml`.\r\n\r\nHow to achieve the same result using only the `application.properties` when calling `createEntityManagerFactory`?\r\n\r\n**UPDATE (2022-01-03)**: As requested, changed from `@RequestScoped` to `@ApplicationScoped` and changed from *postgre* to *postgres*.","title":"EntityManager and createEntityManagerFactory with application.properties","body":"<p>I have to create singleton classes using DAO classes.</p>\n<p>Following is a DAO reading class example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.luiz.teste.dao;\n\nimport com.luiz.teste.exceptions.postgres.ReadSubjectDaoFindException;\n\nimport org.eclipse.microprofile.opentracing.Traced;\nimport javax.enterprise.context.RequestScoped;\nimport javax.persistence.EntityManager;\nimport javax.persistence.EntityTransaction;\nimport javax.persistence.NoResultException;\nimport javax.persistence.Persistence;\nimport javax.persistence.PersistenceException;\n\n@Traced\n@ApplicationScoped\npublic class ReadSubjectDao {\n    private static ReadSubjectDao instance = new ReadSubjectDao();\n    protected EntityManager em;\n    \n    public static ReadSubjectDao getInstance() {\n        return instance;\n    }\n    \n    private ReadSubjectDao() {\n        if (em == null) {\n            em = Persistence.createEntityManagerFactory(&quot;postgres&quot;).createEntityManager();\n        }\n    }\n\n    public ReadSubject findById(int id) throws ReadSubjectDaoFindException {\n        try {    \n            return em.find(ReadSubject.class, id);\n        }\n        catch (NoResultException e) {\n            return null;\n        }\n        catch (PersistenceException e) {\n            throw new ReadSubjectDaoFindException(e);\n        }\n    }\n}\n</code></pre>\n<p>Following is a DAO writing class example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.luiz.teste.dao;\n\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoFindException;\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoPersistException;\nimport com.luiz.teste.exceptions.mysql.WriteSubjectDaoMergeException;\n\nimport org.eclipse.microprofile.opentracing.Traced;\nimport javax.enterprise.context.RequestScoped;\nimport javax.persistence.EntityManager;\nimport javax.persistence.EntityTransaction;\nimport javax.persistence.NoResultException;\nimport javax.persistence.Persistence;\nimport javax.persistence.PersistenceException;\n\n@Traced\n@ApplicationScoped\npublic class WriteSubjectDao {\n    private static WriteSubjectDao instance = new WriteSubjectDao();\n    protected EntityManager em;\n    \n    public static WriteSubjectDao getInstance() {\n        return instance;\n    }\n    \n    private WriteSubjectDao() {\n        if (em == null) {\n            em = Persistence.createEntityManagerFactory(&quot;mysql&quot;).createEntityManager();\n        }\n    }\n\n    public WriteSubject findById(int id) throws WriteSubjectDaoFindException {\n        try {    \n            return em.find(WriteSubject.class, id);\n        }\n        catch (NoResultException e) {\n            return null;\n        }\n        catch (PersistenceException e) {\n            throw new WriteSubjectDaoFindException(e);\n        }\n    }\n    \n    public void persist(WriteSubject writeSubject) throws WriteSubjectDaoPersistException {\n        EntityTransaction et = em.getTransaction();\n        try {\n            et.begin();\n            em.persist(writeSubject);\n            et.commit();\n        }\n        catch (Exception e) {            \n            if (et.isActive())\n                et.rollback();\n            throw new WriteSubjectDaoPersistException(e);\n        }\n    }\n\n    public void merge(WriteSubject writeSubject) throws WriteSubjectDaoMergeException {\n        EntityTransaction et = em.getTransaction();\n        try {\n            et.begin();\n            em.merge(writeSubject);\n            et.commit();\n        }\n        catch (Exception e) {\n            if (et.isActive())\n                et.rollback();\n            throw new WriteSubjectDaoMergeException(e);\n        }\n    }\n}\n</code></pre>\n<p>Following is <strong>application.properties</strong>:</p>\n<pre><code># Configuration file\n# key = value\nquarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %X{requestID} %s%e%n\n\nmp.metrics.tags=app=${quarkus.application.name},version=${quarkus.application.version}\n%test.mp.metrics.tags=app=app-test,version=1.0.0\n\nmp.openapi.filter=com.luiz.teste.dev.ext.filters.OpenApiFilter\n\nquarkus.swagger-ui.path=/api-docs\nquarkus.smallrye-openapi.path=/api-docs-json\nquarkus.swagger-ui.always-include=true\n\nquarkus.http.test-port=8083\nquarkus.http.test-ssl-port=8446\n\nquarkus.datasource.jdbc.enable-metrics=true\n\n# Postgre - Build time\nquarkus.datasource.&quot;postgres&quot;.db-kind=db2\nquarkus.datasource.&quot;postgres&quot;.jdbc.url=${POSTGRE_JDBC}\nquarkus.datasource.&quot;postgres&quot;.username=${POSTGRE_USER}\nquarkus.datasource.&quot;postgres&quot;.password=${POSTGRE_PASSWORD}\nquarkus.hibernate-orm.&quot;postgres&quot;.datasource=postgres\nquarkus.hibernate-orm.&quot;postgres&quot;.packages=com.luiz.teste.models.postgres\nquarkus.hibernate-orm.&quot;postgres&quot;.log.jdbc-warnings=false\nquarkus.hibernate-orm.&quot;postgres&quot;.log.sql=true\n\n# MySQL - Build time\nquarkus.datasource.&quot;mysql&quot;.db-kind=mysql\nquarkus.datasource.&quot;mysql&quot;.jdbc.url=${MYSQL_JDBC}\nquarkus.datasource.&quot;mysql&quot;.username=${MYSQL_USER}\nquarkus.datasource.&quot;mysql&quot;.password=${MYSQL_PASSWORD}\nquarkus.hibernate-orm.&quot;mysql&quot;.datasource=mysql\nquarkus.hibernate-orm.&quot;mysql&quot;.packages=com.luiz.teste.models.mysql\nquarkus.hibernate-orm.&quot;mysql&quot;.log.jdbc-warnings=false\nquarkus.hibernate-orm.&quot;mysql&quot;.log.sql=true\n</code></pre>\n<p>As far as I've searched through this site (and through <a href=\"https://www.google.com\" rel=\"nofollow noreferrer\">https://www.google.com</a> too), I know so far only by using <code>persistence.xml</code>.</p>\n<p>How to achieve the same result using only the <code>application.properties</code> when calling <code>createEntityManagerFactory</code>?</p>\n<p><strong>UPDATE (2022-01-03)</strong>: As requested, changed from <code>@RequestScoped</code> to <code>@ApplicationScoped</code> and changed from <em>postgre</em> to <em>postgres</em>.</p>\n"},{"tags":["java","junit","mocking"],"comments":[{"owner":{"account_id":9767945,"reputation":1563,"user_id":7240806,"display_name":"Stephan Hogenboom"},"score":0,"creation_date":1641393534,"post_id":70594477,"comment_id":124793435,"body_markdown":"What is it exactly that you try to accomplish here? Do wnat to return an emptylist once the entire pipeline has ran its course?","body":"What is it exactly that you try to accomplish here? Do wnat to return an emptylist once the entire pipeline has ran its course?"},{"owner":{"account_id":10478972,"reputation":170,"user_id":7724568,"display_name":"ZottoSL"},"score":0,"creation_date":1641393877,"post_id":70594477,"comment_id":124793589,"body_markdown":"Yes, exactly that","body":"Yes, exactly that"},{"owner":{"account_id":9767945,"reputation":1563,"user_id":7240806,"display_name":"Stephan Hogenboom"},"score":0,"creation_date":1641395351,"post_id":70594477,"comment_id":124794261,"body_markdown":"Can you post the surrounding code?","body":"Can you post the surrounding code?"}],"owner":{"account_id":10478972,"reputation":170,"user_id":7724568,"display_name":"ZottoSL"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":197,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1641392508,"creation_date":1641392508,"question_id":70594477,"body_markdown":"I&#39;m having a problem wanting to mock the return of a list with JUnit. I tried this:\r\n\r\n    given(loan.getExternalReferences().stream()\r\n       .filter(er -&gt; er.getType() == ReferenceType.ORIGINATION_PLATFORM_FUND)\r\n       .collect(Collectors.toList())).willReturn(anyList());\r\n\r\nBut I get the following error:\r\n\r\n    org.mockito.exceptions.misusing.MissingMethodInvocationException: \r\n    when() requires an argument which has to be &#39;a method call on a mock&#39;.\r\n    For example:\r\n        when(mock.getArticles()).thenReturn(articles);\r\n\r\n    Also, this error might show up because:\r\n    1. you stub either of: final/private/equals()/hashCode() methods.\r\n    Those methods *cannot* be stubbed/verified.\r\n    Mocking methods declared on non-public parent classes is not supported.\r\n    2. inside when() you don&#39;t call method on mock but on some other object.\r\n\r\nThanks!","title":"Return mock list on given JUnit","body":"<p>I'm having a problem wanting to mock the return of a list with JUnit. I tried this:</p>\n<pre><code>given(loan.getExternalReferences().stream()\n   .filter(er -&gt; er.getType() == ReferenceType.ORIGINATION_PLATFORM_FUND)\n   .collect(Collectors.toList())).willReturn(anyList());\n</code></pre>\n<p>But I get the following error:</p>\n<pre><code>org.mockito.exceptions.misusing.MissingMethodInvocationException: \nwhen() requires an argument which has to be 'a method call on a mock'.\nFor example:\n    when(mock.getArticles()).thenReturn(articles);\n\nAlso, this error might show up because:\n1. you stub either of: final/private/equals()/hashCode() methods.\nThose methods *cannot* be stubbed/verified.\nMocking methods declared on non-public parent classes is not supported.\n2. inside when() you don't call method on mock but on some other object.\n</code></pre>\n<p>Thanks!</p>\n"},{"tags":["java","spring-boot","reactive-programming","spring-webflux","project-reactor"],"comments":[{"owner":{"account_id":12206189,"reputation":5872,"user_id":8909235,"display_name":"lkatiforis"},"score":0,"creation_date":1641289401,"post_id":70573375,"comment_id":124760642,"body_markdown":"The first snippet does cause a compilation error because  `Throwable` is a checked exception in Java.","body":"The first snippet does cause a compilation error because  <code>Throwable</code> is a checked exception in Java."},{"owner":{"account_id":106565,"reputation":18790,"user_id":283837,"accept_rate":70,"display_name":"Simeon Leyzerzon"},"score":0,"creation_date":1641307790,"post_id":70573375,"comment_id":124767950,"body_markdown":"Are you saying that the overloaded `subscribe()` can only be used for handling the `RuntimeException`s even though its signature explicitly states that the parameter inherits from `Throwable`?","body":"Are you saying that the overloaded <code>subscribe()</code> can only be used for handling the <code>RuntimeException</code>s even though its signature explicitly states that the parameter inherits from <code>Throwable</code>?"}],"answers":[{"tags":[],"owner":{"account_id":12206189,"reputation":5872,"user_id":8909235,"display_name":"lkatiforis"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1641316546,"creation_date":1641316546,"answer_id":70582627,"question_id":70573375,"body_markdown":"You cannot throw checked exceptions(such as `Throwable` or`IOException`) from the subscriber. The `subscribe()` method takes a `Consumer` function, without any exception declarations. However, Reactor provides the [`Exceptions`][1] utility class  which can wrap any checked exception into an unchecked exception, as follows:\r\n\r\n```java\r\nMono.just(&quot;test&quot;)\r\n    .subscribe(x -&gt; {\r\n        try {\r\n            throw new Throwable(&quot;Error occurred:&quot;);\r\n        } catch (Throwable e) {\r\n            throw Exceptions.propagate(e);\r\n        }\r\n    }, e -&gt; log.error(&quot;Error occurred: &quot;, Exceptions.unwrap(e)));\r\n```\r\n\r\nThe `Exception.unwrap` is used to get the original checked exception.\r\n\r\n\r\n  [1]: https://projectreactor.io/docs/core/release/api/index.html?reactor/core/Exceptions.html","title":"Exception Handling in WebFlux publisher","body":"<p>You cannot throw checked exceptions(such as <code>Throwable</code> or<code>IOException</code>) from the subscriber. The <code>subscribe()</code> method takes a <code>Consumer</code> function, without any exception declarations. However, Reactor provides the <a href=\"https://projectreactor.io/docs/core/release/api/index.html?reactor/core/Exceptions.html\" rel=\"nofollow noreferrer\"><code>Exceptions</code></a> utility class  which can wrap any checked exception into an unchecked exception, as follows:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Mono.just(&quot;test&quot;)\n    .subscribe(x -&gt; {\n        try {\n            throw new Throwable(&quot;Error occurred:&quot;);\n        } catch (Throwable e) {\n            throw Exceptions.propagate(e);\n        }\n    }, e -&gt; log.error(&quot;Error occurred: &quot;, Exceptions.unwrap(e)));\n</code></pre>\n<p>The <code>Exception.unwrap</code> is used to get the original checked exception.</p>\n"}],"owner":{"account_id":106565,"reputation":18790,"user_id":283837,"accept_rate":70,"display_name":"Simeon Leyzerzon"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1232,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641392385,"creation_date":1641261988,"question_id":70573375,"body_markdown":"I&#39;m wondering why the following way of WebFlux subscription DOESN&#39;T cause a compilation error:\r\n\r\n    @Test public void handlingSubscriberError() {\r\n    \t\t\r\n    List l = new ArrayList();\r\n    l.add(&quot;a&quot;);\r\n        Mono.just(l)\r\n              .subscribe(x -&gt; {\r\n               throw new Throwable();\r\n               }, e -&gt; log.error(&quot;Error occurred:&quot;, e));\r\n    }\r\n\r\n\r\nwhereas this one DOES, and suggests surrounding with a try/catch block:\r\n\r\n\r\n\r\n        @Autowired private PersistenceService writer;\r\n    \r\n        @Test public void handlingSubscriberError() {\r\n        \t\t\r\n        List l = new ArrayList();\r\n        l.add(&quot;A&quot;);\r\n        Mono.just(l)\r\n           .subscribe(x -&gt; {\r\n           writer.persistTo(x, &quot;B&quot;, &quot;C&quot;);  &lt;== Unhandled exception type Throwable. \r\n          }, e -&gt; log.error(&quot;Error occurred:&quot;, e));\r\n       }\r\n\r\nWhat&#39;s the point of having an overloaded `subscribe()` with the error consumer as a second parameter when one is still forced to add a try-catch by the Java compiler?  Or am I missing something?  Is there a proper idiom for this in WebFlux?\r\n\r\n","title":"Exception Handling in WebFlux publisher","body":"<p>I'm wondering why the following way of WebFlux subscription DOESN'T cause a compilation error:</p>\n<pre><code>@Test public void handlingSubscriberError() {\n        \nList l = new ArrayList();\nl.add(&quot;a&quot;);\n    Mono.just(l)\n          .subscribe(x -&gt; {\n           throw new Throwable();\n           }, e -&gt; log.error(&quot;Error occurred:&quot;, e));\n}\n</code></pre>\n<p>whereas this one DOES, and suggests surrounding with a try/catch block:</p>\n<pre><code>    @Autowired private PersistenceService writer;\n\n    @Test public void handlingSubscriberError() {\n            \n    List l = new ArrayList();\n    l.add(&quot;A&quot;);\n    Mono.just(l)\n       .subscribe(x -&gt; {\n       writer.persistTo(x, &quot;B&quot;, &quot;C&quot;);  &lt;== Unhandled exception type Throwable. \n      }, e -&gt; log.error(&quot;Error occurred:&quot;, e));\n   }\n</code></pre>\n<p>What's the point of having an overloaded <code>subscribe()</code> with the error consumer as a second parameter when one is still forced to add a try-catch by the Java compiler?  Or am I missing something?  Is there a proper idiom for this in WebFlux?</p>\n"},{"tags":["java","spring","hibernate","hql"],"comments":[{"owner":{"account_id":1004882,"reputation":2184,"user_id":1018903,"display_name":"Andr&#233;"},"score":0,"creation_date":1375215198,"post_id":17955682,"comment_id":26244075,"body_markdown":"The SQL equivalent would be a Union statement right? JPQL doesn&#39;t support such, although some JPA provider does. Why the queries need to be merged into one TypedQuery? Can&#39;t you execute both and return a Set&lt;Long&gt; wrapping into another method?","body":"The SQL equivalent would be a Union statement right? JPQL doesn&#39;t support such, although some JPA provider does. Why the queries need to be merged into one TypedQuery? Can&#39;t you execute both and return a Set&lt;Long&gt; wrapping into another method?"},{"owner":{"account_id":891554,"reputation":8848,"user_id":929701,"accept_rate":79,"display_name":"hrishikeshp19"},"score":0,"creation_date":1375215529,"post_id":17955682,"comment_id":26244248,"body_markdown":"How can I use SQL equivalent to return TypedQuery? Will following work? TypedQuery q = em.createQuery(&quot;SELECT user.id FROM TableOne AS user WHERE ... UNION SELECT link.user_id FROM TableTwo AS link WHERE ...&quot;, Long.class);","body":"How can I use SQL equivalent to return TypedQuery? Will following work? TypedQuery q = em.createQuery(&quot;SELECT user.id FROM TableOne AS user WHERE ... UNION SELECT link.user_id FROM TableTwo AS link WHERE ...&quot;, Long.class);"}],"answers":[{"tags":[],"owner":{"account_id":891554,"reputation":8848,"user_id":929701,"accept_rate":79,"display_name":"hrishikeshp19"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1641392346,"creation_date":1375216412,"answer_id":17956825,"question_id":17955682,"body_markdown":"Completely copying answer from https://stackoverflow.com/a/3940445/929701:\r\n\r\nYou could use id in (select id from ...) or id in (select id from ...)\r\n\r\ne.g. instead of non-working\r\n\r\n    from Person p where p.name=&quot;Joe&quot;\r\n    union\r\n    from Person p join p.children c where c.name=&quot;Joe&quot;\r\n\r\nyou could do\r\n\r\n    from Person p \r\n      where p.id in (select p1.id from Person p1 where p1.name=&quot;Joe&quot;) \r\n        or p.id in (select p2.id from Person p2 join p2.children c where c.name=&quot;Joe&quot;);\r\n\r\nAt least using MySQL, you will run into performance problems with the later though. It&#39;s sometimes easier to do a poor man&#39;s join on two queries instead:\r\n```java\r\n// use set for uniqueness\r\nSet&lt;Person&gt; people = new HashSet&lt;Person&gt;((List&lt;Person&gt;) query1.list());\r\npeople.addAll((List&lt;Person&gt;) query2.list());\r\nreturn new ArrayList&lt;Person&gt;(people);\r\n```\r\nIt&#39;s often better to do two simple queries than one complex one.\r\n\r\n","title":"HQL merge two typedqueries","body":"<p>Completely copying answer from <a href=\"https://stackoverflow.com/a/3940445/929701\">https://stackoverflow.com/a/3940445/929701</a>:</p>\n<p>You could use id in (select id from ...) or id in (select id from ...)</p>\n<p>e.g. instead of non-working</p>\n<pre><code>from Person p where p.name=&quot;Joe&quot;\nunion\nfrom Person p join p.children c where c.name=&quot;Joe&quot;\n</code></pre>\n<p>you could do</p>\n<pre><code>from Person p \n  where p.id in (select p1.id from Person p1 where p1.name=&quot;Joe&quot;) \n    or p.id in (select p2.id from Person p2 join p2.children c where c.name=&quot;Joe&quot;);\n</code></pre>\n<p>At least using MySQL, you will run into performance problems with the later though. It's sometimes easier to do a poor man's join on two queries instead:</p>\n<pre class=\"lang-java prettyprint-override\"><code>// use set for uniqueness\nSet&lt;Person&gt; people = new HashSet&lt;Person&gt;((List&lt;Person&gt;) query1.list());\npeople.addAll((List&lt;Person&gt;) query2.list());\nreturn new ArrayList&lt;Person&gt;(people);\n</code></pre>\n<p>It's often better to do two simple queries than one complex one.</p>\n"},{"tags":[],"owner":{"account_id":3040588,"reputation":15226,"user_id":2577734,"accept_rate":91,"display_name":"Joe Taras"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1375219510,"creation_date":1375219510,"answer_id":17957690,"question_id":17955682,"body_markdown":"the UNION statement not work on Hibernate.\r\n\r\nSo you can:\r\n\r\nExecute first query and put in a list;\r\n\r\nExecute second query and put in a list;\r\n\r\nPut the result of first and second list in a unique list.\r\n\r\nIf you want to delete the duplicated value, you must do programmatically.","title":"HQL merge two typedqueries","body":"<p>the UNION statement not work on Hibernate.</p>\n\n<p>So you can:</p>\n\n<p>Execute first query and put in a list;</p>\n\n<p>Execute second query and put in a list;</p>\n\n<p>Put the result of first and second list in a unique list.</p>\n\n<p>If you want to delete the duplicated value, you must do programmatically.</p>\n"}],"owner":{"account_id":891554,"reputation":8848,"user_id":929701,"accept_rate":79,"display_name":"hrishikeshp19"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3257,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":17956825,"answer_count":2,"score":2,"last_activity_date":1641392346,"creation_date":1375212412,"question_id":17955682,"body_markdown":"I have written two hibernate queries:\r\n\r\n1. TypedQuery&lt;Long&gt; q = em.createQuery(&quot;SELECT user.id FROM TableOne AS user WHERE ...&quot;, Long.class);        \r\n1. TypedQuery&lt;Long&gt; q = em.createQuery(&quot;SELECT link.user_id FROM TableTwo AS link WHERE ...&quot;, Long.class);\r\n\r\nNow, how do I merge these two queries? My return type has to be TypedQuery&lt;Long&gt;","title":"HQL merge two typedqueries","body":"<p>I have written two hibernate queries:</p>\n\n<ol>\n<li>TypedQuery q = em.createQuery(\"SELECT user.id FROM TableOne AS user WHERE ...\", Long.class);        </li>\n<li>TypedQuery q = em.createQuery(\"SELECT link.user_id FROM TableTwo AS link WHERE ...\", Long.class);</li>\n</ol>\n\n<p>Now, how do I merge these two queries? My return type has to be TypedQuery</p>\n"},{"tags":["java","namespaces","xhtml","presentation"],"owner":{"account_id":23219099,"reputation":21,"user_id":17311606,"display_name":"bee"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":334,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":0,"score":2,"last_activity_date":1641392133,"creation_date":1641376140,"question_id":70590788,"body_markdown":"Currently I am working on a presentation layer for a software project in java. In the skeleton project we were provided with, there already were a bunch of namespaces included. \r\n```\r\n&lt;ui:composition xmlns=&quot;http://www.w3c.org/1999/xhtml&quot;\r\n                xmlns:f=&quot;http://java.sun.com/jsf/core&quot;\r\n                xmlns:h=&quot;http://java.sun.com/jsf/html&quot;\r\n                xmlns:ui=&quot;http://java.sun.com/jsf/facelets&quot;\r\n                xmlns:ng=&quot;http://xmlns.jcp.org/jsf/passthrough&quot;\r\n                xmlns:p=&quot;http://primefaces.org/ui&quot;\r\n```\r\nThese are the ones that are included in almost every .xhtml file in the project. I have spent some time already sorting the maven dependencies out in the pom.xml file, but still the project can&#39;t seem to get the external resources. I have tried to invalidate the caches, but the urls are still displayed in red and when I try to display my page on a localhost, stuff like buttons and boxes are just not shown, just plain text. \r\n\r\nWhat else could I try to get the project to recognize the external resources? \r\n\r\nAppearantly its also only my intellij that can&#39;t handle the resources, one of my teammates could load everything just fine.","title":"xmlns in intellij project are not recognized?","body":"<p>Currently I am working on a presentation layer for a software project in java. In the skeleton project we were provided with, there already were a bunch of namespaces included.</p>\n<pre><code>&lt;ui:composition xmlns=&quot;http://www.w3c.org/1999/xhtml&quot;\n                xmlns:f=&quot;http://java.sun.com/jsf/core&quot;\n                xmlns:h=&quot;http://java.sun.com/jsf/html&quot;\n                xmlns:ui=&quot;http://java.sun.com/jsf/facelets&quot;\n                xmlns:ng=&quot;http://xmlns.jcp.org/jsf/passthrough&quot;\n                xmlns:p=&quot;http://primefaces.org/ui&quot;\n</code></pre>\n<p>These are the ones that are included in almost every .xhtml file in the project. I have spent some time already sorting the maven dependencies out in the pom.xml file, but still the project can't seem to get the external resources. I have tried to invalidate the caches, but the urls are still displayed in red and when I try to display my page on a localhost, stuff like buttons and boxes are just not shown, just plain text.</p>\n<p>What else could I try to get the project to recognize the external resources?</p>\n<p>Appearantly its also only my intellij that can't handle the resources, one of my teammates could load everything just fine.</p>\n"},{"tags":["java","android","zip","compression"],"comments":[{"owner":{"account_id":50585,"reputation":39940,"user_id":150978,"accept_rate":78,"display_name":"Robert"},"score":0,"creation_date":1641392040,"post_id":70590848,"comment_id":124792724,"body_markdown":"Where does the `classes.dex` file come from that you hash? You are hashing the file before and after the compression. Are bith hashes different or just the one after compression? How do you install the app on both devices (is it the same APK file)?","body":"Where does the <code>classes.dex</code> file come from that you hash? You are hashing the file before and after the compression. Are bith hashes different or just the one after compression? How do you install the app on both devices (is it the same APK file)?"},{"owner":{"account_id":1136690,"reputation":104411,"user_id":1180620,"accept_rate":83,"display_name":"Mark Adler"},"score":0,"creation_date":1641409828,"post_id":70590848,"comment_id":124800246,"body_markdown":"Does the compressed data from both decompress correctly? If so, then it does not matter if the compressed data is different.","body":"Does the compressed data from both decompress correctly? If so, then it does not matter if the compressed data is different."},{"owner":{"account_id":23833501,"reputation":11,"user_id":17839504,"display_name":"superH1991"},"score":0,"creation_date":1641433853,"post_id":70590848,"comment_id":124806382,"body_markdown":"The classdex file comes from the release version of Apk. After the APK is decompressed on the PC (Windows 10), the dex file is pushed to the phone for compression testing of different Android versions. It is found that the compressed files of the Android12 version are different. This release version of Apk can be installed normally in each Android version and can be used normally @Robert","body":"The classdex file comes from the release version of Apk. After the APK is decompressed on the PC (Windows 10), the dex file is pushed to the phone for compression testing of different Android versions. It is found that the compressed files of the Android12 version are different. This release version of Apk can be installed normally in each Android version and can be used normally @Robert"},{"owner":{"account_id":23833501,"reputation":11,"user_id":17839504,"display_name":"superH1991"},"score":0,"creation_date":1641434725,"post_id":70590848,"comment_id":124806545,"body_markdown":"The decompressed class.dex file is the same, and it is different on Android12 and Android10 after compression. The decompression operation is performed on the pc (windows10), decompressed from the release version APK, and then push the decompressed dex file to the phone @MarkAdler","body":"The decompressed class.dex file is the same, and it is different on Android12 and Android10 after compression. The decompression operation is performed on the pc (windows10), decompressed from the release version APK, and then push the decompressed dex file to the phone @MarkAdler"},{"owner":{"account_id":23833501,"reputation":11,"user_id":17839504,"display_name":"superH1991"},"score":0,"creation_date":1641438124,"post_id":70590848,"comment_id":124806993,"body_markdown":"release APK link: \nhttps://dldir1.qq.com/weixin/android/weixin8016android2040_arm64.apk   , After decompressing the APK, push the class.dex file to the phone","body":"release APK link:  <a href=\"https://dldir1.qq.com/weixin/android/weixin8016android2040_arm64.apk\" rel=\"nofollow noreferrer\">dldir1.qq.com/weixin/android/weixin8016android2040_arm64.apk</a>   , After decompressing the APK, push the class.dex file to the phone"},{"owner":{"account_id":50585,"reputation":39940,"user_id":150978,"accept_rate":78,"display_name":"Robert"},"score":0,"creation_date":1641462119,"post_id":70590848,"comment_id":124812016,"body_markdown":"I still don&#39;t see the point in this question. If the output is different so what (nobody has defined that compressing a file creates a deterministic result). Does that has any disadvantages (can not be read/decompressed by older devices or something like that). Most likely Google has simply changed the deflate implementation to use https://github.com/google/zopfli instead as it provides better compression rates but is compatible with deflate.","body":"I still don&#39;t see the point in this question. If the output is different so what (nobody has defined that compressing a file creates a deterministic result). Does that has any disadvantages (can not be read/decompressed by older devices or something like that). Most likely Google has simply changed the deflate implementation to use <a href=\"https://github.com/google/zopfli\" rel=\"nofollow noreferrer\">github.com/google/zopfli</a> instead as it provides better compression rates but is compatible with deflate."},{"owner":{"account_id":23833501,"reputation":11,"user_id":17839504,"display_name":"superH1991"},"score":0,"creation_date":1641470123,"post_id":70590848,"comment_id":124814785,"body_markdown":"The same file is compressed using the same compression parameters on different Android devices, and the results obtained are not the same. This will cause the decompression to fail after uploading the file to the server in the app, and it is impossible to verify whether the file uploaded by the user is correct","body":"The same file is compressed using the same compression parameters on different Android devices, and the results obtained are not the same. This will cause the decompression to fail after uploading the file to the server in the app, and it is impossible to verify whether the file uploaded by the user is correct"},{"owner":{"account_id":23833501,"reputation":11,"user_id":17839504,"display_name":"superH1991"},"score":0,"creation_date":1641470588,"post_id":70590848,"comment_id":124814959,"body_markdown":"We expect that the hash value of the uploaded file after compression is 1234567. This is expected to be correct on Android10 devices, but the hash value is not 1234567 on Android12 devices, so our upload verification function will fail on Android12 devices.","body":"We expect that the hash value of the uploaded file after compression is 1234567. This is expected to be correct on Android10 devices, but the hash value is not 1234567 on Android12 devices, so our upload verification function will fail on Android12 devices."},{"owner":{"account_id":23833501,"reputation":11,"user_id":17839504,"display_name":"superH1991"},"score":0,"creation_date":1641885818,"post_id":70590848,"comment_id":124917535,"body_markdown":"If I want to use the deflate api to compress files and keep the same results as other Android versions, how is it compatible?\n@Robert","body":"If I want to use the deflate api to compress files and keep the same results as other Android versions, how is it compatible? @Robert"}],"owner":{"account_id":23833501,"reputation":11,"user_id":17839504,"display_name":"superH1991"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":146,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1641391963,"creation_date":1641376400,"question_id":70590848,"body_markdown":"test code:\r\n\r\n```\r\nFile dir = new File(Environment.getExternalStorageDirectory(), &quot;patchTest&quot;);\r\n        File dex = new File(dir, &quot;classes.dex&quot;);\r\n        File compressDex = new File(dir, &quot;compressDex&quot;);\r\n        Deflater compressor = new Deflater(9, true);\r\n        compressor.setStrategy(0);\r\n        try {\r\n            Log.i(&quot;hc&quot;, &quot;compress start &quot; + Sha256Utils.getHash(dex));\r\n            DeflaterOutputStream compressedPatchOut =\r\n                    new DeflaterOutputStream(new FileOutputStream(compressDex), compressor, true);\r\n            FileInputStream fin = new FileInputStream(dex);\r\n            byte[] bytes = new byte[1024 * 2];\r\n            int index;\r\n            while ((index = fin.read(bytes)) != -1) {\r\n                compressedPatchOut.write(bytes, 0, index);\r\n            }\r\n            compressedPatchOut.finish();\r\n            compressedPatchOut.flush();\r\n            fin.close();\r\n            Log.i(&quot;hc&quot;, &quot;compress finish &quot; + Sha256Utils.getHash(compressDex));\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        } finally {\r\n            compressor.end();\r\n        }\r\n```\r\n\r\nFinally, the Hash value of the compressed file is different between Android 12 and Android 10.\r\nIs there any modification to the Deflater of Android12?\r\n","title":"Use Deflater to compressor file, The compressed file is different under Android 12 and Android 10","body":"<p>test code:</p>\n<pre><code>File dir = new File(Environment.getExternalStorageDirectory(), &quot;patchTest&quot;);\n        File dex = new File(dir, &quot;classes.dex&quot;);\n        File compressDex = new File(dir, &quot;compressDex&quot;);\n        Deflater compressor = new Deflater(9, true);\n        compressor.setStrategy(0);\n        try {\n            Log.i(&quot;hc&quot;, &quot;compress start &quot; + Sha256Utils.getHash(dex));\n            DeflaterOutputStream compressedPatchOut =\n                    new DeflaterOutputStream(new FileOutputStream(compressDex), compressor, true);\n            FileInputStream fin = new FileInputStream(dex);\n            byte[] bytes = new byte[1024 * 2];\n            int index;\n            while ((index = fin.read(bytes)) != -1) {\n                compressedPatchOut.write(bytes, 0, index);\n            }\n            compressedPatchOut.finish();\n            compressedPatchOut.flush();\n            fin.close();\n            Log.i(&quot;hc&quot;, &quot;compress finish &quot; + Sha256Utils.getHash(compressDex));\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            compressor.end();\n        }\n</code></pre>\n<p>Finally, the Hash value of the compressed file is different between Android 12 and Android 10.\nIs there any modification to the Deflater of Android12?</p>\n"},{"tags":["java","hibernate","jpa"],"comments":[{"owner":{"account_id":2921854,"reputation":1946,"user_id":2503916,"accept_rate":50,"display_name":"Siva"},"score":0,"creation_date":1379311867,"post_id":18821266,"comment_id":27761977,"body_markdown":"Possible duplicate http://stackoverflow.com/questions/12420457/associationoverride-and-attributeoverride-in-new-doctrine-2-3","body":"Possible duplicate <a href=\"http://stackoverflow.com/questions/12420457/associationoverride-and-attributeoverride-in-new-doctrine-2-3\" title=\"associationoverride and attributeoverride in new doctrine 2 3\">stackoverflow.com/questions/12420457/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":3052937,"reputation":17914,"user_id":2587166,"accept_rate":83,"display_name":"Luca Basso Ricci"},"down_vote_count":1,"up_vote_count":8,"is_accepted":false,"score":7,"last_activity_date":1379315909,"creation_date":1379315909,"answer_id":18822363,"question_id":18821266,"body_markdown":"From official documentation:\r\n\r\n[@AssociationOverride](http://docs.oracle.com/javaee/7/api/javax/persistence/AssociationOverride.html)\r\n&gt; Used to override a mapping for an entity\r\n&gt; relationship\r\n\r\n[@AttributeOverride](http://docs.oracle.com/javaee/7/api/javax/persistence/AttributeOverride.html)\r\n\r\n&gt; Used to override the mapping of a Basic (whether explicit or default)\r\n&gt; property or field or Id property or field.\r\n\r\nRead official javadoc: is well explained with some example.","title":"Different between @AttributeOverride and @AssociationOverride in JPA","body":"<p>From official documentation:</p>\n\n<p><a href=\"http://docs.oracle.com/javaee/7/api/javax/persistence/AssociationOverride.html\" rel=\"noreferrer\">@AssociationOverride</a></p>\n\n<blockquote>\n  <p>Used to override a mapping for an entity\n  relationship</p>\n</blockquote>\n\n<p><a href=\"http://docs.oracle.com/javaee/7/api/javax/persistence/AttributeOverride.html\" rel=\"noreferrer\">@AttributeOverride</a></p>\n\n<blockquote>\n  <p>Used to override the mapping of a Basic (whether explicit or default)\n  property or field or Id property or field.</p>\n</blockquote>\n\n<p>Read official javadoc: is well explained with some example.</p>\n"},{"tags":[],"owner":{"account_id":23835805,"reputation":21,"user_id":17841550,"display_name":"Alexey Lukyanenko"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1641391830,"creation_date":1641391517,"answer_id":70594230,"question_id":18821266,"body_markdown":"May be that is a bit more simple:\r\n\r\nThe @AttributeOverride annotation is used to override the mapping of property or field or Id property or field.\r\n\r\nThe @AssociationOverride annotation is used to override a many-to-one or one-to-one mapping of property or field for an entity relationship.\r\n\r\nhttps://javabeat.net/eclipselink-jpa-annotations-attributeoverride-associationoverride/\r\n","title":"Different between @AttributeOverride and @AssociationOverride in JPA","body":"<p>May be that is a bit more simple:</p>\n<p>The @AttributeOverride annotation is used to override the mapping of property or field or Id property or field.</p>\n<p>The @AssociationOverride annotation is used to override a many-to-one or one-to-one mapping of property or field for an entity relationship.</p>\n<p><a href=\"https://javabeat.net/eclipselink-jpa-annotations-attributeoverride-associationoverride/\" rel=\"nofollow noreferrer\">https://javabeat.net/eclipselink-jpa-annotations-attributeoverride-associationoverride/</a></p>\n"}],"owner":{"account_id":1689738,"reputation":1307,"user_id":1552348,"accept_rate":9,"display_name":"Ashwin Patil"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":9888,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"answer_count":2,"score":4,"last_activity_date":1641391830,"creation_date":1379311177,"question_id":18821266,"body_markdown":"What is the difference between @AttributeOverride and @AssociationOverride. Please explain me with the simple example.","title":"Different between @AttributeOverride and @AssociationOverride in JPA","body":"<p>What is the difference between @AttributeOverride and @AssociationOverride. Please explain me with the simple example.</p>\n"},{"tags":["java","mockito","powermockito","mockrunner"],"comments":[{"owner":{"account_id":1713236,"reputation":22836,"user_id":1570854,"accept_rate":71,"display_name":"Lesiak"},"score":0,"creation_date":1641381872,"post_id":70591569,"comment_id":124788682,"body_markdown":"You mocked `Util`, so `Util.CommitToDB()` does nothing.","body":"You mocked <code>Util</code>, so <code>Util.CommitToDB()</code> does nothing."},{"owner":{"account_id":6360189,"reputation":21,"user_id":4935917,"display_name":"Ramesh Gupta"},"score":0,"creation_date":1641384832,"post_id":70591569,"comment_id":124789766,"body_markdown":"I have tried removing the Util mock too. Still I get the same error. I have also tried combination where Util and CustomLogger is mocked or not. All the combination gave same result.","body":"I have tried removing the Util mock too. Still I get the same error. I have also tried combination where Util and CustomLogger is mocked or not. All the combination gave same result."},{"owner":{"account_id":1713236,"reputation":22836,"user_id":1570854,"accept_rate":71,"display_name":"Lesiak"},"score":0,"creation_date":1641385053,"post_id":70591569,"comment_id":124789849,"body_markdown":"You get same error, but the reason is different - you now enter `CommitToDB` while you haven&#39;t previously. Now your problem is equality of exceptions.","body":"You get same error, but the reason is different - you now enter <code>CommitToDB</code> while you haven&#39;t previously. Now your problem is equality of exceptions."},{"owner":{"account_id":6360189,"reputation":21,"user_id":4935917,"display_name":"Ramesh Gupta"},"score":0,"creation_date":1641385092,"post_id":70591569,"comment_id":124789868,"body_markdown":"**Method threw &#39;org.mockito2.exceptions.base.MockitoException&#39; exception. Cannot evaluate Util$MockitoMock$639069902.toString()** This exception message is availabel if I debug it via IDE.","body":"<b>Method threw &#39;org.mockito2.exceptions.base.MockitoException&#39; exception. Cannot evaluate Util$MockitoMock$639069902.toString()</b> This exception message is availabel if I debug it via IDE."},{"owner":{"account_id":6360189,"reputation":21,"user_id":4935917,"display_name":"Ramesh Gupta"},"score":0,"creation_date":1641385186,"post_id":70591569,"comment_id":124789898,"body_markdown":"@Lesiak I do enter the CommitToDB method. But I get the same exception each Time. When I debug via IDE the Logger line is definetly executed.","body":"@Lesiak I do enter the CommitToDB method. But I get the same exception each Time. When I debug via IDE the Logger line is definetly executed."},{"owner":{"account_id":1713236,"reputation":22836,"user_id":1570854,"accept_rate":71,"display_name":"Lesiak"},"score":0,"creation_date":1641385747,"post_id":70591569,"comment_id":124790112,"body_markdown":"For debugger output - see https://stackoverflow.com/questions/69626405/mockito-unfinished-stubbing-exception-detected-only-in-intellij-debugger/69628236#69628236. For actual error - compare 2 instances of identical exceptions and think about consequences","body":"For debugger output - see <a href=\"https://stackoverflow.com/questions/69626405/mockito-unfinished-stubbing-exception-detected-only-in-intellij-debugger/69628236#69628236\" title=\"mockito unfinished stubbing exception detected only in intellij debugger\">stackoverflow.com/questions/69626405/&hellip;</a>. For actual error - compare 2 instances of identical exceptions and think about consequences"}],"answers":[{"tags":[],"owner":{"account_id":6360189,"reputation":21,"user_id":4935917,"display_name":"Ramesh Gupta"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1641391683,"creation_date":1641391683,"answer_id":70594272,"question_id":70591569,"body_markdown":"Adding the below line in the test method solve the problem:\r\n\r\n     Whitebox.setInternalState(Util.class , &quot;LOGGER&quot; , logger);\r\n\r\nAfter debugging , it appears that the Logger instance in the Util class and UtilTest class were different. \r\n\r\nThe reason mock was throwing an error &quot;Wanted but not invoked&quot; is because the logger instance invoking the method and the one used to verify in the unit test were different.\r\n\r\n","title":"Mockito unable to invoke Logger instance - &quot;Actually, there were zero interactions with this mock.&quot; Wanted but not invoked","body":"<p>Adding the below line in the test method solve the problem:</p>\n<pre><code> Whitebox.setInternalState(Util.class , &quot;LOGGER&quot; , logger);\n</code></pre>\n<p>After debugging , it appears that the Logger instance in the Util class and UtilTest class were different.</p>\n<p>The reason mock was throwing an error &quot;Wanted but not invoked&quot; is because the logger instance invoking the method and the one used to verify in the unit test were different.</p>\n"}],"owner":{"account_id":6360189,"reputation":21,"user_id":4935917,"display_name":"Ramesh Gupta"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":434,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1641391683,"creation_date":1641379564,"question_id":70591569,"body_markdown":"My Class:\r\n\r\n    public class Util {\r\n        private static final CustomLogger LOGGER = new CustomLogger(Util.class);\r\n    \r\n        public static void commitToDB() {\r\n            try {\r\n                CommitToDB();\r\n            } catch (SQLException sqlException) {\r\n                 LOGGER.error(&quot;Exception in DB Commit&quot;, sqlException.getMessage(), sqlException);\r\n            }\r\n        }\r\n    }\r\n\r\nMy Unit Test Case Class:\r\n\r\n    @RunWith(PowerMockRunner.class)\r\n    @PrepareForTest({\r\n            CustomLogger.class\r\n    })\r\n    public class UtilTest {\r\n        @Mock\r\n        private Util util;\r\n    \r\n        @Mock\r\n        private CustomLogger CustomLogger;\r\n    \r\n        public void verifyFailedCommitRecords() throws SQLException {\r\n            SQLException sqlException = new SQLException(&quot;Exception in DB Commit&quot;);\r\n            doThrow(sqlException).when(protectedConn).commit();\r\n            CustomLogger logger = PowerMockito.mock(CustomLogger.class);\r\n            Util.CommitToDB();\r\n            verify(logger, times(1)).error(&quot;Exception in DB Commit&quot;, sqlException.getMessage(), sqlException);\r\n        }\r\n    }\r\n\r\nI am getting error stating &quot;Actually, there were zero interactions with this mock.&quot;\r\nWanted but not invoked:\r\n\r\nPS: Util.commitToDB calls an internal class protectedConnection which throws the SQLexception.","title":"Mockito unable to invoke Logger instance - &quot;Actually, there were zero interactions with this mock.&quot; Wanted but not invoked","body":"<p>My Class:</p>\n<pre><code>public class Util {\n    private static final CustomLogger LOGGER = new CustomLogger(Util.class);\n\n    public static void commitToDB() {\n        try {\n            CommitToDB();\n        } catch (SQLException sqlException) {\n             LOGGER.error(&quot;Exception in DB Commit&quot;, sqlException.getMessage(), sqlException);\n        }\n    }\n}\n</code></pre>\n<p>My Unit Test Case Class:</p>\n<pre><code>@RunWith(PowerMockRunner.class)\n@PrepareForTest({\n        CustomLogger.class\n})\npublic class UtilTest {\n    @Mock\n    private Util util;\n\n    @Mock\n    private CustomLogger CustomLogger;\n\n    public void verifyFailedCommitRecords() throws SQLException {\n        SQLException sqlException = new SQLException(&quot;Exception in DB Commit&quot;);\n        doThrow(sqlException).when(protectedConn).commit();\n        CustomLogger logger = PowerMockito.mock(CustomLogger.class);\n        Util.CommitToDB();\n        verify(logger, times(1)).error(&quot;Exception in DB Commit&quot;, sqlException.getMessage(), sqlException);\n    }\n}\n</code></pre>\n<p>I am getting error stating &quot;Actually, there were zero interactions with this mock.&quot;\nWanted but not invoked:</p>\n<p>PS: Util.commitToDB calls an internal class protectedConnection which throws the SQLexception.</p>\n"},{"tags":["java","spring","spring-boot"],"comments":[{"owner":{"account_id":15464461,"reputation":161,"user_id":11156237,"display_name":"Serhat Ylmaz"},"score":0,"creation_date":1641394180,"post_id":70594252,"comment_id":124793725,"body_markdown":"Does this answer your question? [Download Multiple files Java Spring](https://stackoverflow.com/questions/36886141/download-multiple-files-java-spring)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/36886141/download-multiple-files-java-spring\">Download Multiple files Java Spring</a>"},{"owner":{"account_id":7819979,"reputation":1197,"user_id":5913407,"accept_rate":57,"display_name":"LowCool"},"score":0,"creation_date":1641407967,"post_id":70594252,"comment_id":124799562,"body_markdown":"but all are returning null or void, but I want to pass that to my UI, how would I do that?","body":"but all are returning null or void, but I want to pass that to my UI, how would I do that?"}],"owner":{"account_id":7819979,"reputation":1197,"user_id":5913407,"accept_rate":57,"display_name":"LowCool"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1652,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1641391625,"creation_date":1641391625,"question_id":70594252,"body_markdown":"I need to send multiple files to UI from db, \r\nI saw couple of post like [this][1] and [here][2], it suggest that I need to zip multiple files and send to client, but my client is front end angular code which unable to handle zip file.\r\nI\r\n\r\n  tried code like below\r\n    \r\n    public ResponseEntity&lt;List&lt;ByteArrayResouse&gt;&gt; downloaFile(){\r\n     List&lt;ByteArrayResource&gt; listOfFiles = fileServices.getFiles();\r\n    return ResponseEntity.ok()\r\n           .contentType(MdiaType.MULTIPART_FORM_DATA)\r\n           .header(HttpHeaders.CONTENT_DISPOSITION, &quot;attachment; filename=somefile&quot;)\r\n           .body(listOfFiles);\r\n    }\r\n\r\nbut I got error saying 406 could not find acceptable representation \r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/36886141/download-multiple-files-java-spring\r\n  [2]: https://www.devglan.com/spring-boot/spring-boot-file-upload-download","title":"Download multiple file from spring boot service","body":"<p>I need to send multiple files to UI from db,\nI saw couple of post like <a href=\"https://stackoverflow.com/questions/36886141/download-multiple-files-java-spring\">this</a> and <a href=\"https://www.devglan.com/spring-boot/spring-boot-file-upload-download\" rel=\"nofollow noreferrer\">here</a>, it suggest that I need to zip multiple files and send to client, but my client is front end angular code which unable to handle zip file.\nI</p>\n<p>tried code like below</p>\n<pre><code>public ResponseEntity&lt;List&lt;ByteArrayResouse&gt;&gt; downloaFile(){\n List&lt;ByteArrayResource&gt; listOfFiles = fileServices.getFiles();\nreturn ResponseEntity.ok()\n       .contentType(MdiaType.MULTIPART_FORM_DATA)\n       .header(HttpHeaders.CONTENT_DISPOSITION, &quot;attachment; filename=somefile&quot;)\n       .body(listOfFiles);\n}\n</code></pre>\n<p>but I got error saying 406 could not find acceptable representation</p>\n"},{"tags":["java","spring-boot"],"owner":{"account_id":23794203,"reputation":11,"user_id":17805298,"display_name":"Popipe"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":361,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1641390977,"creation_date":1641206068,"question_id":70564469,"body_markdown":"I am using Java and Spring Boot to create an REST API for a database.\r\n\r\nI have been trying to find a way to dynamically filter serialized java nested objects. I have seen filter solutions with @JsonFilter but I can&#39;t manage to get it working with nested objects.\r\n\r\nHere the object to be serialized:\r\n```\r\npackage org.safetynet.p5safetynetalert.dbapi.model.dto;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonFilter;\r\nimport lombok.Data;\r\n\r\nimport java.util.Collection;\r\n\r\n@Data\r\npublic class ChildFromAddressDTO {\r\n  private String title = &quot;List of child at selected address&quot;;\r\n\r\n  @JsonFilter(&quot;childrenAtAddressDynamicFilter&quot;)\r\n  private Collection&lt;PersonDTO&gt; childrenAtAddress;\r\n\r\n  @JsonFilter(&quot;otherAdultsAtAddressDynamicFilter&quot;)\r\n  private Collection&lt;PersonDTO&gt; otherAdultsAtAddress;\r\n}\r\n```\r\nAs you can see, I have tried to filter the two different objects contained into ```ChildFromAddressDTO```. Indeed, I want to filter their properties dynamically when ```ChildFromAddressDTO``` is being serialized.\r\n\r\nTo be more specific, here is the ```PersonDTO``` object:\r\n```\r\npackage org.safetynet.p5safetynetalert.dbapi.model.dto;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonFilter;\r\nimport lombok.Data;\r\nimport org.safetynet.p5safetynetalert.dbapi.service.AgeService;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\n\r\n@Data\r\n@JsonFilter(&quot;PersonDTODynamicFilter&quot;)\r\npublic class PersonDTO {\r\n\r\n  @Autowired\r\n  private AgeService ageService;\r\n\r\n  private String firstName;\r\n  private String lastName;\r\n  private String phone;\r\n  private String birthDate;\r\n  private Integer age;\r\n  private String email;\r\n  private AddressDTO address;\r\n\r\n  public PersonDTO() {\r\n\r\n  }\r\n}\r\n```\r\nI would like to hide everything except ```firstName```, ```lastName```, and ```age```, but only for the collection named ```childrenAtAddress```.\r\n\r\nSo far, I have tried this code in the service linked to my controller service:\r\n```\r\n@Service\r\npublic class ChildAlertService {\r\n\r\n  @Autowired\r\n  private AddressService addressService;\r\n  @Autowired\r\n  private PersonService personService;\r\n\r\npublic MappingJacksonValue getChildrenFromAddress(String road) throws Exception {\r\n    ChildFromAddressDTO childFromAddressDTO = new ChildFromAddressDTO();\r\n    Collection&lt;PersonDTO&gt; childrenToAdd = new ArrayList&lt;&gt;();\r\n    Collection&lt;PersonDTO&gt; adultToAdd = new ArrayList&lt;&gt;();\r\n\r\n    Address address = addressService.getByRoad(road);\r\n    Collection&lt;PersonDTO&gt; personDTOCollection = addressService.getPersonDTOsFromAddress(address);\r\n\r\n    for (PersonDTO personDTO : personDTOCollection) {\r\n      if (personDTO.getAge() &lt; 19) {\r\n        childrenToAdd.add(personDTO);\r\n      } else {\r\n        adultToAdd.add(personDTO);\r\n      }\r\n    }\r\n}\r\n\r\n    childFromAddressDTO.setChildrenAtAddress(childrenToAdd);\r\n    childFromAddressDTO.setOtherAdultsAtAddress(adultToAdd);\r\n\r\n    SimpleBeanPropertyFilter myFilter = SimpleBeanPropertyFilter\r\n      .serializeAllExcept(&quot;phone&quot;, &quot;birthdate&quot;, &quot;email&quot;, &quot;address&quot;);\r\n\r\n    FilterProvider filters = new SimpleFilterProvider()\r\n      .addFilter(&quot;childrenAtAddressDynamicFilter&quot;, myFilter);\r\n\r\n    MappingJacksonValue personsDTOtoChildren = new MappingJacksonValue(childFromAddressDTO);\r\n    personsDTOtoChildren.setFilters(filters);\r\n\r\n\r\n    return personsDTOtoChildren;\r\n  }\r\n```\r\n\r\nIs there a way to do so using @JsonFilter dynamically?\r\n\r\nBecause with this code, I get an 500 internal server error and I cannot manage to understand why.\r\n\r\n","title":"How to filter only specific nested objects during serialization for REST API","body":"<p>I am using Java and Spring Boot to create an REST API for a database.</p>\n<p>I have been trying to find a way to dynamically filter serialized java nested objects. I have seen filter solutions with @JsonFilter but I can't manage to get it working with nested objects.</p>\n<p>Here the object to be serialized:</p>\n<pre><code>package org.safetynet.p5safetynetalert.dbapi.model.dto;\n\nimport com.fasterxml.jackson.annotation.JsonFilter;\nimport lombok.Data;\n\nimport java.util.Collection;\n\n@Data\npublic class ChildFromAddressDTO {\n  private String title = &quot;List of child at selected address&quot;;\n\n  @JsonFilter(&quot;childrenAtAddressDynamicFilter&quot;)\n  private Collection&lt;PersonDTO&gt; childrenAtAddress;\n\n  @JsonFilter(&quot;otherAdultsAtAddressDynamicFilter&quot;)\n  private Collection&lt;PersonDTO&gt; otherAdultsAtAddress;\n}\n</code></pre>\n<p>As you can see, I have tried to filter the two different objects contained into <code>ChildFromAddressDTO</code>. Indeed, I want to filter their properties dynamically when <code>ChildFromAddressDTO</code> is being serialized.</p>\n<p>To be more specific, here is the <code>PersonDTO</code> object:</p>\n<pre><code>package org.safetynet.p5safetynetalert.dbapi.model.dto;\n\nimport com.fasterxml.jackson.annotation.JsonFilter;\nimport lombok.Data;\nimport org.safetynet.p5safetynetalert.dbapi.service.AgeService;\nimport org.springframework.beans.factory.annotation.Autowired;\n\n@Data\n@JsonFilter(&quot;PersonDTODynamicFilter&quot;)\npublic class PersonDTO {\n\n  @Autowired\n  private AgeService ageService;\n\n  private String firstName;\n  private String lastName;\n  private String phone;\n  private String birthDate;\n  private Integer age;\n  private String email;\n  private AddressDTO address;\n\n  public PersonDTO() {\n\n  }\n}\n</code></pre>\n<p>I would like to hide everything except <code>firstName</code>, <code>lastName</code>, and <code>age</code>, but only for the collection named <code>childrenAtAddress</code>.</p>\n<p>So far, I have tried this code in the service linked to my controller service:</p>\n<pre><code>@Service\npublic class ChildAlertService {\n\n  @Autowired\n  private AddressService addressService;\n  @Autowired\n  private PersonService personService;\n\npublic MappingJacksonValue getChildrenFromAddress(String road) throws Exception {\n    ChildFromAddressDTO childFromAddressDTO = new ChildFromAddressDTO();\n    Collection&lt;PersonDTO&gt; childrenToAdd = new ArrayList&lt;&gt;();\n    Collection&lt;PersonDTO&gt; adultToAdd = new ArrayList&lt;&gt;();\n\n    Address address = addressService.getByRoad(road);\n    Collection&lt;PersonDTO&gt; personDTOCollection = addressService.getPersonDTOsFromAddress(address);\n\n    for (PersonDTO personDTO : personDTOCollection) {\n      if (personDTO.getAge() &lt; 19) {\n        childrenToAdd.add(personDTO);\n      } else {\n        adultToAdd.add(personDTO);\n      }\n    }\n}\n\n    childFromAddressDTO.setChildrenAtAddress(childrenToAdd);\n    childFromAddressDTO.setOtherAdultsAtAddress(adultToAdd);\n\n    SimpleBeanPropertyFilter myFilter = SimpleBeanPropertyFilter\n      .serializeAllExcept(&quot;phone&quot;, &quot;birthdate&quot;, &quot;email&quot;, &quot;address&quot;);\n\n    FilterProvider filters = new SimpleFilterProvider()\n      .addFilter(&quot;childrenAtAddressDynamicFilter&quot;, myFilter);\n\n    MappingJacksonValue personsDTOtoChildren = new MappingJacksonValue(childFromAddressDTO);\n    personsDTOtoChildren.setFilters(filters);\n\n\n    return personsDTOtoChildren;\n  }\n</code></pre>\n<p>Is there a way to do so using @JsonFilter dynamically?</p>\n<p>Because with this code, I get an 500 internal server error and I cannot manage to understand why.</p>\n"},{"tags":["java","charts","jfreechart","candlestick-chart","jfreechart-fx"],"comments":[{"owner":{"account_id":81822,"reputation":204250,"user_id":230513,"accept_rate":100,"display_name":"trashgod"},"score":0,"creation_date":1641423093,"post_id":70593986,"comment_id":124804290,"body_markdown":"Maybe an `XYItemLabelGenerator`, seen [here](https://stackoverflow.com/search?tab=votes&amp;q=%5bjfreechart%5d%20XYItemLabelGenerator)?","body":"Maybe an <code>XYItemLabelGenerator</code>, seen <a href=\"https://stackoverflow.com/search?tab=votes&amp;q=%5bjfreechart%5d%20XYItemLabelGenerator\">here</a>?"},{"owner":{"account_id":81822,"reputation":204250,"user_id":230513,"accept_rate":100,"display_name":"trashgod"},"score":0,"creation_date":1641578668,"post_id":70593986,"comment_id":124849411,"body_markdown":"Also consider an annotation such as`XYTextAnnotation`.","body":"Also consider an annotation such as<code>XYTextAnnotation</code>."}],"owner":{"account_id":21369436,"reputation":11,"user_id":15737194,"display_name":"hassnain ali"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":161,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1641390937,"creation_date":1641390548,"question_id":70593986,"body_markdown":"Currently I&#39;m working on charts and want to achieve an output.\r\nI wanted to achieve two things.\r\n\r\n1. To display candle stick chart of stocks data. [done]\r\n2. To display the stock split log above or below the candle. [pending]\r\n\r\nI&#39;m using JFreeChart SDK to build the charts.\r\nI&#39;m using OHLCDataItem[] to build data for daily high/low etc of stock. unfortunately jfreechart does not have any extension of OHLCDataItem to show additional information (logo + text metadata) on the candle. \r\n\r\nSample code:\r\n\r\n\tTimeSeries timeSeriesDailyMovingAverage = new TimeSeries(&quot;day moving average&quot;);\r\n\tList&lt;OHLCDataItem&gt; dataItems = new ArrayList&lt;OHLCDataItem&gt;(); //to collect High low close prices\r\n\r\n    OHLCDataItem item = new OHLCDataItem(date, open, high, low, adjClose, volume);//this code is in loop with do that more data can be added for each day\r\n\tdataItems.add(item);\r\n\r\n    OHLCDataItem[] data = dataItems.toArray(new OHLCDataItem[dataItems.size()]);\r\n\tOHLCDataset dataset = new DefaultOHLCDataset(symbol, data);\r\n\r\n    //now initializing the candleStickRanderer and setting its properties series strock + paint\r\n\tCandlestickRenderer CandleStickRenderer = new CandlestickRenderer();\r\n    \r\n    XYLineAndShapeRenderer LineRenderer = new XYLineAndShapeRenderer(true, false);\r\n    HighLowRenderer OHLCRenderer = new HighLowRenderer();\r\n    DateAxis domainAxis = new DateAxis();\r\n    \r\n    NumberAxis rangeAxis = new NumberAxis();\r\n\trangeAxis.setStandardTickUnits(NumberAxis.createStandardTickUnits());\r\n\t\t\r\n    XYPlot plot = new XYPlot(dataset, domainAxis, rangeAxis, LineRenderer);//set other properties\r\n    JFreeChart chart = new JFreeChart(info, new Font(&quot;SansSerif&quot;, Font.PLAIN, 15), plot, false);\r\n\tChartPanel chartPanel = new ChartPanel(chart);\r\n\r\n    JPanel panel = new JPanel(new BorderLayout());\r\n\tpanel.add(chartPanel, BorderLayout.CENTER);\r\n\tgetContentPane().add(panel);\r\n\r\n\tXYPlot xyplot = (XYPlot) chart.getPlot();\r\n\txyplot.setRenderer(CandleStickRenderer);\r\n\r\nThis is some rough code which is working fine. I&#39;m getting the desired out of Candle chart.\r\n[current output of candle stick][1]\r\nBut I cannot figure out how can I add text/logo on XYPlot based on dataset.\r\n\r\n**What I want to achieve is that, add text/or shape containing text information at the bottom/top of a particular candle. \r\nIt would be a great help if someone can guide me how I can do it based on the dataset.** \r\n\r\nThe desired output is like this chart. \r\n [desired output][2]\r\n\r\nOr\r\n[desired output][4]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/eAhdu.png\r\n  [2]: https://i.stack.imgur.com/PXuAf.png\r\n  [4]: https://i.stack.imgur.com/5mt6B.png","title":"Show stock split in candle chart jfreechart","body":"<p>Currently I'm working on charts and want to achieve an output.\nI wanted to achieve two things.</p>\n<ol>\n<li>To display candle stick chart of stocks data. [done]</li>\n<li>To display the stock split log above or below the candle. [pending]</li>\n</ol>\n<p>I'm using JFreeChart SDK to build the charts.\nI'm using OHLCDataItem[] to build data for daily high/low etc of stock. unfortunately jfreechart does not have any extension of OHLCDataItem to show additional information (logo + text metadata) on the candle.</p>\n<p>Sample code:</p>\n<pre><code>TimeSeries timeSeriesDailyMovingAverage = new TimeSeries(&quot;day moving average&quot;);\nList&lt;OHLCDataItem&gt; dataItems = new ArrayList&lt;OHLCDataItem&gt;(); //to collect High low close prices\n\nOHLCDataItem item = new OHLCDataItem(date, open, high, low, adjClose, volume);//this code is in loop with do that more data can be added for each day\ndataItems.add(item);\n\nOHLCDataItem[] data = dataItems.toArray(new OHLCDataItem[dataItems.size()]);\nOHLCDataset dataset = new DefaultOHLCDataset(symbol, data);\n\n//now initializing the candleStickRanderer and setting its properties series strock + paint\nCandlestickRenderer CandleStickRenderer = new CandlestickRenderer();\n\nXYLineAndShapeRenderer LineRenderer = new XYLineAndShapeRenderer(true, false);\nHighLowRenderer OHLCRenderer = new HighLowRenderer();\nDateAxis domainAxis = new DateAxis();\n\nNumberAxis rangeAxis = new NumberAxis();\nrangeAxis.setStandardTickUnits(NumberAxis.createStandardTickUnits());\n    \nXYPlot plot = new XYPlot(dataset, domainAxis, rangeAxis, LineRenderer);//set other properties\nJFreeChart chart = new JFreeChart(info, new Font(&quot;SansSerif&quot;, Font.PLAIN, 15), plot, false);\nChartPanel chartPanel = new ChartPanel(chart);\n\nJPanel panel = new JPanel(new BorderLayout());\npanel.add(chartPanel, BorderLayout.CENTER);\ngetContentPane().add(panel);\n\nXYPlot xyplot = (XYPlot) chart.getPlot();\nxyplot.setRenderer(CandleStickRenderer);\n</code></pre>\n<p>This is some rough code which is working fine. I'm getting the desired out of Candle chart.\n<a href=\"https://i.stack.imgur.com/eAhdu.png\" rel=\"nofollow noreferrer\">current output of candle stick</a>\nBut I cannot figure out how can I add text/logo on XYPlot based on dataset.</p>\n<p><strong>What I want to achieve is that, add text/or shape containing text information at the bottom/top of a particular candle.\nIt would be a great help if someone can guide me how I can do it based on the dataset.</strong></p>\n<p>The desired output is like this chart.\n<a href=\"https://i.stack.imgur.com/PXuAf.png\" rel=\"nofollow noreferrer\">desired output</a></p>\n<p>Or\n<a href=\"https://i.stack.imgur.com/5mt6B.png\" rel=\"nofollow noreferrer\">desired output</a></p>\n"},{"tags":["java","regex"],"comments":[{"owner":{"account_id":6946971,"reputation":10284,"user_id":5331061,"accept_rate":75,"display_name":"Gurmanjot Singh"},"score":0,"creation_date":1641388979,"post_id":70593551,"comment_id":124791364,"body_markdown":"You can try [`(?&lt;=\\(\\/)[^)]+(?=\\))`](https://regex101.com/r/5bjDff/1).","body":"You can try <a href=\"https://regex101.com/r/5bjDff/1\" rel=\"nofollow noreferrer\"><code>(?&lt;=\\(\\&#47;)[^)]+(?=\\))</code></a>."},{"owner":{"account_id":4739783,"reputation":612585,"user_id":3832970,"display_name":"Wiktor Stribiew"},"score":0,"creation_date":1641517218,"post_id":70593551,"comment_id":124831138,"body_markdown":"I suggest adjusting the title of the question. So far, the accepted answer has no solution for &quot;Text extraction into an array list&quot;, only a regex that can be used to do that. Maybe it should sound as &quot;Extraction of string between parentheses excluding the first underscore&quot;, or something similar.","body":"I suggest adjusting the title of the question. So far, the accepted answer has no solution for &quot;Text extraction into an array list&quot;, only a regex that can be used to do that. Maybe it should sound as &quot;Extraction of string between parentheses excluding the first underscore&quot;, or something similar."}],"answers":[{"tags":[],"owner":{"account_id":6946971,"reputation":10284,"user_id":5331061,"accept_rate":75,"display_name":"Gurmanjot Singh"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1641390894,"creation_date":1641389142,"answer_id":70593638,"question_id":70593551,"body_markdown":"\r\nTry this regex:\r\n\r\n    (?&lt;=\\\\(/)[^)]+(?=\\\\))\r\n\r\n**[Click for Demo][1]**\r\n\r\n**Explanation**\r\n\r\n - `(?&lt;=\\\\(/)` - positive lookbehind to make sure that the current position is preceded by a `(/`\r\n - `[^)]+` - matches 1 or more occurences(as many as possible) of any character that is not a `)`\r\n\r\n - `(?=\\\\))` - positive lookahead to make sure that the current position is followed by a `)`\r\n\r\nWith the regex you are using, `\\\\((.+?)\\\\)`, the following happens:\r\n\r\n - `\\\\(` - matches the opening parenthesis `(`\r\n - `(.+?)` - matches any character(except a new line character) 1 or more times, as few as possible. This subpattern will keep on expanding the match until it reaches the `)`. That&#39;s why it is matching everything between the parenthesis(even the `/`)\r\n - `\\\\)` - matches the closing parenthesis `)`\r\n\r\n  [1]: https://regex101.com/r/dQbWMq/1","title":"Java Regex: Text extraction into an array list","body":"<p>Try this regex:</p>\n<pre><code>(?&lt;=\\\\(/)[^)]+(?=\\\\))\n</code></pre>\n<p><strong><a href=\"https://regex101.com/r/dQbWMq/1\" rel=\"nofollow noreferrer\">Click for Demo</a></strong></p>\n<p><strong>Explanation</strong></p>\n<ul>\n<li><p><code>(?&lt;=\\\\(/)</code> - positive lookbehind to make sure that the current position is preceded by a <code>(/</code></p>\n</li>\n<li><p><code>[^)]+</code> - matches 1 or more occurences(as many as possible) of any character that is not a <code>)</code></p>\n</li>\n<li><p><code>(?=\\\\))</code> - positive lookahead to make sure that the current position is followed by a <code>)</code></p>\n</li>\n</ul>\n<p>With the regex you are using, <code>\\\\((.+?)\\\\)</code>, the following happens:</p>\n<ul>\n<li><code>\\\\(</code> - matches the opening parenthesis <code>(</code></li>\n<li><code>(.+?)</code> - matches any character(except a new line character) 1 or more times, as few as possible. This subpattern will keep on expanding the match until it reaches the <code>)</code>. That's why it is matching everything between the parenthesis(even the <code>/</code>)</li>\n<li><code>\\\\)</code> - matches the closing parenthesis <code>)</code></li>\n</ul>\n"},{"tags":[],"owner":{"account_id":7089168,"reputation":157118,"user_id":5424988,"display_name":"The fourth bird"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641390559,"creation_date":1641389789,"answer_id":70593796,"question_id":70593551,"body_markdown":"You can use a capture group, and match the outer parenthesis/square brackets:\r\n\r\n    \\(/([^\\s()]+)\\)\r\n\r\n- `\\(/` Match `(/`\r\n- `(` Capture **group 1**\r\n  - `[^\\s()]+` Match 1+ chars other than a whitespace char or `(` `)`\r\n- `)` Close group 1\r\n- `\\)` Match `)`\r\n\r\n[Regex demo](https://regex101.com/r/3GZ90M/1)\r\n\r\n    List&lt;String&gt; matches = Pattern.compile(&quot;\\\\(/([^\\\\s()]+)\\\\)&quot;)\r\n        .matcher(&quot;This comment is great **[@madeUpUser1](/madeUpUser1)** You said something similar did you mate? **[@madeUpUser2](/madeUpUser2)**&quot;)\r\n        .results()\r\n        .map(m -&gt; m.group(1))\r\n        .collect(Collectors.toList());\r\n    \r\n    for (String s : matches)\r\n        System.out.println(s);\r\n\r\nOutput\r\n\r\n    madeUpUser1\r\n    madeUpUser2\r\n\r\nOr in the example, the string between the square brackets seems to be the same, so another option using the same code could be:\r\n\r\n    \\[@([^\\s\\]\\[]+)]\r\n\r\n- `\\[@` match `[@`\r\n- `(` Capture **group 1**\r\n  - `[^\\s\\]\\[]+` Match 1+ chars other than a whitespace char or `[` `]`\r\n- `)` Close group 1\r\n- `]` Match `]`\r\n\r\n[Regex demo](https://regex101.com/r/gt1LgO/1) | [Java demo](https://ideone.com/O5Uixq)","title":"Java Regex: Text extraction into an array list","body":"<p>You can use a capture group, and match the outer parenthesis/square brackets:</p>\n<pre><code>\\(/([^\\s()]+)\\)\n</code></pre>\n<ul>\n<li><code>\\(/</code> Match <code>(/</code></li>\n<li><code>(</code> Capture <strong>group 1</strong>\n<ul>\n<li><code>[^\\s()]+</code> Match 1+ chars other than a whitespace char or <code>(</code> <code>)</code></li>\n</ul>\n</li>\n<li><code>)</code> Close group 1</li>\n<li><code>\\)</code> Match <code>)</code></li>\n</ul>\n<p><a href=\"https://regex101.com/r/3GZ90M/1\" rel=\"nofollow noreferrer\">Regex demo</a></p>\n<pre><code>List&lt;String&gt; matches = Pattern.compile(&quot;\\\\(/([^\\\\s()]+)\\\\)&quot;)\n    .matcher(&quot;This comment is great **[@madeUpUser1](/madeUpUser1)** You said something similar did you mate? **[@madeUpUser2](/madeUpUser2)**&quot;)\n    .results()\n    .map(m -&gt; m.group(1))\n    .collect(Collectors.toList());\n\nfor (String s : matches)\n    System.out.println(s);\n</code></pre>\n<p>Output</p>\n<pre><code>madeUpUser1\nmadeUpUser2\n</code></pre>\n<p>Or in the example, the string between the square brackets seems to be the same, so another option using the same code could be:</p>\n<pre><code>\\[@([^\\s\\]\\[]+)]\n</code></pre>\n<ul>\n<li><code>\\[@</code> match <code>[@</code></li>\n<li><code>(</code> Capture <strong>group 1</strong>\n<ul>\n<li><code>[^\\s\\]\\[]+</code> Match 1+ chars other than a whitespace char or <code>[</code> <code>]</code></li>\n</ul>\n</li>\n<li><code>)</code> Close group 1</li>\n<li><code>]</code> Match <code>]</code></li>\n</ul>\n<p><a href=\"https://regex101.com/r/gt1LgO/1\" rel=\"nofollow noreferrer\">Regex demo</a> | <a href=\"https://ideone.com/O5Uixq\" rel=\"nofollow noreferrer\">Java demo</a></p>\n"},{"tags":[],"owner":{"account_id":4739783,"reputation":612585,"user_id":3832970,"display_name":"Wiktor Stribiew"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1641390173,"creation_date":1641389791,"answer_id":70593797,"question_id":70593551,"body_markdown":"You can match `](/` and then *capture* any zero or more chars other than `(` and `)` till the next `)`, and collect Group 1 matches only:\r\n```java\r\nimport java.util.*;\r\nimport java.util.regex.*;\r\nimport java.util.stream.Collectors;\r\n\r\n\r\nclass Test\r\n{\r\n\tpublic static void main (String[] args) throws java.lang.Exception\r\n\t{\r\n\t\tString text = &quot;This comment is great **[@madeUpUser1](/madeUpUser1)** You said something similar did you mate? **[@madeUpUser2](/madeUpUser2)**&quot;;\r\n\r\n\t\tPattern p = Pattern.compile(&quot;]\\\\(/([^()]*)\\\\)&quot;);\r\n\t\tList&lt;String&gt; results = p.matcher(text)\r\n            .results()\r\n        \t.map(mr -&gt; mr.group(1))\r\n        \t.collect(Collectors.toList());\r\n        \r\n        // Or, to get a string array:\r\n        // String[] results = p.matcher(text).results().map(mr -&gt; mr.group(1)).toArray(String[]::new);\r\n\r\n\t\tfor (String x: results) {\r\n\t\t\tSystem.out.println(x);\r\n\t\t}\r\n\t}\r\n}\r\n```\r\nSee the [online demo][1]. Output:\r\n```\r\nmadeUpUser1\r\nmadeUpUser2\r\n```\r\nSee the [regex demo][2]. *Details*:\r\n\r\n - `]\\(/` - a `])/` string\r\n - `([^()]*)` - Capturing group 1: any zero or more chars other than `)` and `(`\r\n - `\\)` -  a `)` char.\r\n\r\n\r\n  [1]: https://ideone.com/VUw5K5\r\n  [2]: https://regex101.com/r/iXt7Wa/1","title":"Java Regex: Text extraction into an array list","body":"<p>You can match <code>](/</code> and then <em>capture</em> any zero or more chars other than <code>(</code> and <code>)</code> till the next <code>)</code>, and collect Group 1 matches only:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.*;\nimport java.util.regex.*;\nimport java.util.stream.Collectors;\n\n\nclass Test\n{\n    public static void main (String[] args) throws java.lang.Exception\n    {\n        String text = &quot;This comment is great **[@madeUpUser1](/madeUpUser1)** You said something similar did you mate? **[@madeUpUser2](/madeUpUser2)**&quot;;\n\n        Pattern p = Pattern.compile(&quot;]\\\\(/([^()]*)\\\\)&quot;);\n        List&lt;String&gt; results = p.matcher(text)\n            .results()\n            .map(mr -&gt; mr.group(1))\n            .collect(Collectors.toList());\n        \n        // Or, to get a string array:\n        // String[] results = p.matcher(text).results().map(mr -&gt; mr.group(1)).toArray(String[]::new);\n\n        for (String x: results) {\n            System.out.println(x);\n        }\n    }\n}\n</code></pre>\n<p>See the <a href=\"https://ideone.com/VUw5K5\" rel=\"nofollow noreferrer\">online demo</a>. Output:</p>\n<pre><code>madeUpUser1\nmadeUpUser2\n</code></pre>\n<p>See the <a href=\"https://regex101.com/r/iXt7Wa/1\" rel=\"nofollow noreferrer\">regex demo</a>. <em>Details</em>:</p>\n<ul>\n<li><code>]\\(/</code> - a <code>])/</code> string</li>\n<li><code>([^()]*)</code> - Capturing group 1: any zero or more chars other than <code>)</code> and <code>(</code></li>\n<li><code>\\)</code> -  a <code>)</code> char.</li>\n</ul>\n"}],"owner":{"account_id":1972832,"reputation":378,"user_id":1771344,"accept_rate":75,"display_name":"MetaCoder"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":65,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":70593638,"answer_count":3,"score":0,"last_activity_date":1641390894,"creation_date":1641388746,"question_id":70593551,"body_markdown":"I&#39;m struggling with a simple regex, for which I can&#39;t seem to get right.\r\n\r\nI have some text like so:\r\n\r\n```\r\nThis comment is great **[@madeUpUser1](/madeUpUser1)** You said something similar did you mate? **[@madeUpUser2](/madeUpUser2)**\r\n```\r\n\r\nWhat I would like to end up with is an array list containing the usernames inbetween the parentheses i.e.:\r\n\r\n```\r\n0.madeUpUser1\r\n1.madeUpUser2\r\n```\r\n\r\nAnd here is the code I have so far:\r\n\r\n```\r\nList&lt;String&gt; matches = Pattern.compile(&quot;\\\\((.+?)\\\\)&quot;)\r\n        .matcher(&quot;This comment is great **[@madeUpUser1](/madeUpUser1)** You said something similar did you mate? **[@madeUpUser2](/madeUpUser2)**&quot;)\r\n        .results()\r\n        .map(MatchResult::group)\r\n        .collect(Collectors.toList());\r\n```\r\n\r\nHowever what I&#39;m getting back is this:\r\n\r\n```\r\n0.&quot;(/madeUpUser1)&quot;\r\n1.&quot;(/madeUpUser2)&quot;\r\n```\r\n\r\nAgain, where I want:\r\n```\r\n0.madeUpUser1\r\n1.madeUpUser2\r\n```\r\ni.e. without the parentheses and without the forwardslash\r\n\r\nCan anyone shed any light on what I&#39;m doing wrong with my regex please?","title":"Java Regex: Text extraction into an array list","body":"<p>I'm struggling with a simple regex, for which I can't seem to get right.</p>\n<p>I have some text like so:</p>\n<pre><code>This comment is great **[@madeUpUser1](/madeUpUser1)** You said something similar did you mate? **[@madeUpUser2](/madeUpUser2)**\n</code></pre>\n<p>What I would like to end up with is an array list containing the usernames inbetween the parentheses i.e.:</p>\n<pre><code>0.madeUpUser1\n1.madeUpUser2\n</code></pre>\n<p>And here is the code I have so far:</p>\n<pre><code>List&lt;String&gt; matches = Pattern.compile(&quot;\\\\((.+?)\\\\)&quot;)\n        .matcher(&quot;This comment is great **[@madeUpUser1](/madeUpUser1)** You said something similar did you mate? **[@madeUpUser2](/madeUpUser2)**&quot;)\n        .results()\n        .map(MatchResult::group)\n        .collect(Collectors.toList());\n</code></pre>\n<p>However what I'm getting back is this:</p>\n<pre><code>0.&quot;(/madeUpUser1)&quot;\n1.&quot;(/madeUpUser2)&quot;\n</code></pre>\n<p>Again, where I want:</p>\n<pre><code>0.madeUpUser1\n1.madeUpUser2\n</code></pre>\n<p>i.e. without the parentheses and without the forwardslash</p>\n<p>Can anyone shed any light on what I'm doing wrong with my regex please?</p>\n"}],"has_more":true,"quota_max":10000,"quota_remaining":8283,"page":1709,"page_size":100}
