{"items":[{"tags":["java","spring","spring-boot","http-status-codes"],"answers":[{"comments":[{"owner":{"account_id":25989163,"reputation":37,"user_id":19701675,"display_name":"shiningStar"},"score":0,"creation_date":1694370548,"post_id":77077334,"comment_id":135879068,"body_markdown":"Greatful for the clear explanation.","body":"Greatful for the clear explanation."}],"tags":[],"owner":{"account_id":28104689,"reputation":512,"user_id":21473475,"display_name":"Arfur Narf"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694368710,"creation_date":1694368710,"answer_id":77077334,"question_id":77077277,"body_markdown":"Follow the [specification](https://www.rfc-editor.org/rfc/rfc2616#page-63).\r\n\r\n\r\n&gt; 10.3.5 304 Not Modified\r\n&gt; \r\n&gt;    If the client has performed a conditional GET request and access is\r\n&gt; allowed, but the document has not been modified, the server SHOULD   \r\n&gt; respond with this status code. The 304 response MUST NOT contain a   \r\n&gt; message-body, and thus is always terminated by the first empty line   \r\n&gt; after the header fields.\r\n\r\nYou might, for example, do a &#39;conditional GET&#39; on a large document; there&#39;s no point in getting it again if you already have it and it hasn&#39;t been changed since.  The efficiency of not transferring the document should be obvious; you need to trade that off against the work of maintaining a local copy.","title":"When and Why Should I Use the HTTP 304 Not Modified Status Code in a Spring Application?","body":"<p>Follow the <a href=\"https://www.rfc-editor.org/rfc/rfc2616#page-63\" rel=\"nofollow noreferrer\">specification</a>.</p>\n<blockquote>\n<p>10.3.5 304 Not Modified</p>\n<p>If the client has performed a conditional GET request and access is\nallowed, but the document has not been modified, the server SHOULD<br />\nrespond with this status code. The 304 response MUST NOT contain a<br />\nmessage-body, and thus is always terminated by the first empty line<br />\nafter the header fields.</p>\n</blockquote>\n<p>You might, for example, do a 'conditional GET' on a large document; there's no point in getting it again if you already have it and it hasn't been changed since.  The efficiency of not transferring the document should be obvious; you need to trade that off against the work of maintaining a local copy.</p>\n"}],"owner":{"account_id":25989163,"reputation":37,"user_id":19701675,"display_name":"shiningStar"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":41,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":77077334,"answer_count":1,"score":0,"last_activity_date":1694368710,"creation_date":1694367984,"question_id":77077277,"body_markdown":"I&#39;m currently working on a Spring application and I&#39;ve come across the HTTP 304 Not Modified status code. While I understand its basic purpose, I&#39;m struggling to grasp real-life scenarios where it would be particularly beneficial.\r\n\r\nCould someone please provide some concrete examples or use cases where using the 304 status code would be a good practice?\r\n\r\nAdditionally, I&#39;d appreciate any insights on how this status code can enhance performance or efficiency in a web application.\r\n\r\nThank you for shedding light on this topic!","title":"When and Why Should I Use the HTTP 304 Not Modified Status Code in a Spring Application?","body":"<p>I'm currently working on a Spring application and I've come across the HTTP 304 Not Modified status code. While I understand its basic purpose, I'm struggling to grasp real-life scenarios where it would be particularly beneficial.</p>\n<p>Could someone please provide some concrete examples or use cases where using the 304 status code would be a good practice?</p>\n<p>Additionally, I'd appreciate any insights on how this status code can enhance performance or efficiency in a web application.</p>\n<p>Thank you for shedding light on this topic!</p>\n"},{"tags":["java","eclipse","selenium","testng"],"comments":[{"owner":{"account_id":17295469,"reputation":137,"user_id":12526239,"display_name":"Yasin Bekar"},"score":0,"creation_date":1631039464,"post_id":51688951,"comment_id":122114799,"body_markdown":"As the log states, there is a null pointer exception\nCaused by: java.lang.NullPointerException at java.base/java.io.FileInputStream...\nIt means that the FilePath is not coming through the execution or is not provided.","body":"As the log states, there is a null pointer exception Caused by: java.lang.NullPointerException at java.base/java.io.FileInputStream... It means that the FilePath is not coming through the execution or is not provided."}],"answers":[{"comments":[{"owner":{"account_id":14093375,"reputation":3,"user_id":10180974,"display_name":"Pranjal Saxena"},"score":0,"creation_date":1533461932,"post_id":51689357,"comment_id":90347677,"body_markdown":"Thanks a Lot !! I removed the sytem.getproperty and it works fine.","body":"Thanks a Lot !! I removed the sytem.getproperty and it works fine."}],"tags":[],"owner":{"account_id":4994171,"reputation":2831,"user_id":4015372,"display_name":"OhleC"},"comment_count":1,"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1533414814,"creation_date":1533414814,"answer_id":51689357,"question_id":51688951,"body_markdown":"The lowest &#39;caused by&#39; section points you to the underlying exception in your base class constructor: you are calling `System.getProperty` with a file path; that will probably return null. To me it looks like the whole call shouldn&#39;t be there, and you just want to pass the file path to the `FileInputStream` constructor (or read it from a system property with some key)","title":"org.testng.TestNGException : Cannot instantiate class","body":"<p>The lowest 'caused by' section points you to the underlying exception in your base class constructor: you are calling <code>System.getProperty</code> with a file path; that will probably return null. To me it looks like the whole call shouldn't be there, and you just want to pass the file path to the <code>FileInputStream</code> constructor (or read it from a system property with some key)</p>\n"},{"comments":[{"owner":{"account_id":14093375,"reputation":3,"user_id":10180974,"display_name":"Pranjal Saxena"},"score":0,"creation_date":1533462061,"post_id":51690049,"comment_id":90347705,"body_markdown":"Thanks !! Yes I am using config.property file and the problem was that I am using sytem.getproperty. I removed it and now working fine.","body":"Thanks !! Yes I am using config.property file and the problem was that I am using sytem.getproperty. I removed it and now working fine."},{"owner":{"account_id":14092429,"reputation":67,"user_id":10180321,"display_name":"sette"},"score":0,"creation_date":1533485027,"post_id":51690049,"comment_id":90353308,"body_markdown":"Glad it helped. Please vote up if my response is useful.","body":"Glad it helped. Please vote up if my response is useful."}],"tags":[],"owner":{"account_id":14092429,"reputation":67,"user_id":10180321,"display_name":"sette"},"comment_count":2,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1533422312,"creation_date":1533422312,"answer_id":51690049,"question_id":51688951,"body_markdown":"Looking at the code, I understand the issue is in the constructor of the base class.\r\nLoginPageTest calls super() which invokes TestBase. \r\n\r\nFileInputStream needs a file path. I suspect FileInputSteam object created is coming as null.\r\n\r\nWhy are you calling System.getProperty? Is the config.properties file available?","title":"org.testng.TestNGException : Cannot instantiate class","body":"<p>Looking at the code, I understand the issue is in the constructor of the base class.\nLoginPageTest calls super() which invokes TestBase. </p>\n\n<p>FileInputStream needs a file path. I suspect FileInputSteam object created is coming as null.</p>\n\n<p>Why are you calling System.getProperty? Is the config.properties file available?</p>\n"},{"tags":[],"owner":{"account_id":18094041,"reputation":1,"user_id":13152781,"display_name":"Rajeev Ranjan"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1588279084,"creation_date":1588243248,"answer_id":61521531,"question_id":51688951,"body_markdown":"Just Remove `System.getproperty` from your base class. Use this lines of code \r\n\r\n     prop = new Properties();\r\n     \r\n    FileInputStream ip = new FileInputStream((&quot;C:\\\\Users\\\\RxLogix\\\\eclipse-workspace\\\\PviIntake\\\\src\\\\main\\\\java\\\\com\\\\pvi\\\\qa\\\\config\\\\config.properties&quot;));\r\n      \r\n    prop.load(ip);","title":"org.testng.TestNGException : Cannot instantiate class","body":"<p>Just Remove <code>System.getproperty</code> from your base class. Use this lines of code </p>\n\n<pre><code> prop = new Properties();\n\nFileInputStream ip = new FileInputStream((\"C:\\\\Users\\\\RxLogix\\\\eclipse-workspace\\\\PviIntake\\\\src\\\\main\\\\java\\\\com\\\\pvi\\\\qa\\\\config\\\\config.properties\"));\n\nprop.load(ip);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":25867958,"reputation":3,"user_id":19599273,"display_name":"Chandan Dash"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684052879,"creation_date":1683872351,"answer_id":76233598,"question_id":51688951,"body_markdown":"**If you use Jdk_1.8 for your automation suite, It might be one of the following two errors :-**\r\n\r\n    \r\n\r\n     1. java.lang.AbstractMethodError: org.openqa.selenium.remote.service.DriverService$Builder.loadSystemProperties()V\r\n    \r\n     2. org.testng.TestNGException:&#160;\r\n    Cannot instantiate class tests.mobiquityPayX.payXUAT.channelApp.BillPayChannelTest\r\n\r\n\r\n\r\n&gt; **Solution:** Try to upgrade your the latest java-client dependencies. It may be\r\n&gt; resolve your issues..\r\n&gt; \r\n&gt; \r\n\r\n ","title":"org.testng.TestNGException : Cannot instantiate class","body":"<p><strong>If you use Jdk_1.8 for your automation suite, It might be one of the following two errors :-</strong></p>\n<pre><code> 1. java.lang.AbstractMethodError: org.openqa.selenium.remote.service.DriverService$Builder.loadSystemProperties()V\n\n 2. org.testng.TestNGException: \nCannot instantiate class tests.mobiquityPayX.payXUAT.channelApp.BillPayChannelTest\n</code></pre>\n<blockquote>\n<p><strong>Solution:</strong> Try to upgrade your the latest java-client dependencies. It may be\nresolve your issues..</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":28640639,"reputation":1,"user_id":21929840,"display_name":"Jaibir singh"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684564197,"creation_date":1684564197,"answer_id":76293823,"question_id":51688951,"body_markdown":"i think you dont want to write the whole system path so thats why u are using system.get but with system.get you are also giving whole path instead of that use system.get(&quot;user.dir&quot;)+&quot;\\\\src\\\\main\\\\java\\\\com\\\\pvi\\\\qa\\\\config\\\\config.properties&quot;   the user.dir will return the system path where your file is stored this will help us and we dont have to write the long path of file. ","title":"org.testng.TestNGException : Cannot instantiate class","body":"<p>i think you dont want to write the whole system path so thats why u are using system.get but with system.get you are also giving whole path instead of that use system.get(&quot;user.dir&quot;)+&quot;\\src\\main\\java\\com\\pvi\\qa\\config\\config.properties&quot;   the user.dir will return the system path where your file is stored this will help us and we dont have to write the long path of file.</p>\n"}],"owner":{"account_id":14093375,"reputation":3,"user_id":10180974,"display_name":"Pranjal Saxena"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":42700,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":51689357,"answer_count":5,"score":0,"last_activity_date":1694368031,"creation_date":1533411004,"question_id":51688951,"body_markdown":"I am facing this &#39;Cannot insantiate class&#39; error on running one of my test cases in selenium webdriver using java(Using Maven project).\r\n\r\nBelow is the parent class where I defined driver and properties\r\n\r\n \r\n\r\n    package com.pvi.qa.base;\r\n    \r\n    import java.io.FileInputStream;\r\n    import java.io.FileNotFoundException;\r\n    import java.io.IOException;\r\n    import java.util.Properties;\r\n    import java.util.concurrent.TimeUnit;\r\n    \r\n    import org.openqa.selenium.WebDriver;\r\n    import org.openqa.selenium.chrome.ChromeDriver;\r\n    \r\n    public class TestBase {\r\n    \t\r\n    \tpublic static WebDriver driver;\r\n    \tpublic static Properties prop ;\r\n    \t\r\n    \tpublic TestBase() {\r\n    \t\ttry {\r\n    \t\t\tprop = new Properties();\r\n    \t\t\tFileInputStream ip = new FileInputStream(System.getProperty(&quot;C:\\\\Users\\\\RxLogix\\\\eclipse-workspace\\\\PviIntake\\\\src\\\\main\\\\java\\\\com\\\\pvi\\\\qa\\\\config\\\\config.properties&quot;));\r\n    \t\tprop.load(ip);\r\n    \t\t\r\n    \t\t}\r\n    \t\tcatch(FileNotFoundException e) {\r\n    \t\t\te.printStackTrace();\r\n    \t\t}\r\n    \t\tcatch(IOException e) {\r\n    \t\t\te.printStackTrace();\r\n    \t\t}\r\n    \t}\r\n    \r\n    public static void initialization () {\r\n    String BrowserName = prop.getProperty(&quot;browser&quot;);\t\r\n    if(BrowserName.equals(&quot;chrome&quot;)) {\r\n    \tSystem.setProperty(&quot;webdriver.chrome.driver&quot;, &quot;D:\\\\Softwares\\\\chromedriver_win32 (1)\\\\chromedriver.exe&quot;);\r\n    \tdriver = new ChromeDriver();}\r\n    driver.manage().window().maximize();\r\n    driver.manage().deleteAllCookies();\r\n    driver.manage().timeouts().pageLoadTimeout(20, TimeUnit.SECONDS);\r\n    driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);\r\n    driver.get(prop.getProperty(&quot;url&quot;));\r\n    }\r\n    }\r\n\r\nBelow is the test cases class which I am running through TestNG\r\n\r\n    package com.pvi.qa.testcases;\r\n    \r\n    import org.testng.annotations.AfterMethod;\r\n    import org.testng.annotations.BeforeMethod;\r\n    import org.testng.annotations.Test;\r\n    \r\n    import com.pvi.qa.base.TestBase;\r\n    import com.pvi.qa.pages.HomePage;\r\n    import com.pvi.qa.pages.LoginPage;\r\n    \r\n    public class LoginPageTest extends TestBase{\r\n    \tLoginPage loginPage;\r\n    \tHomePage homePage;\r\n    \t\r\n    \t\r\n    \tpublic LoginPageTest() {\r\n    \t\tsuper();\r\n    \t\t}\r\n    \t\r\n    \t@BeforeMethod\r\n    \tpublic void setUp() {\r\n    \t\tinitialization();\r\n    \t\tloginPage = new LoginPage();\r\n    \t}\r\n    \r\n    \r\n    \t@Test\r\n    \tpublic void logintest() {\r\n    \t\thomePage = loginPage.login(prop.getProperty(&quot;username&quot;), prop.getProperty(&quot;password&quot;));\r\n    \t}\r\n    \t\r\n    \t@AfterMethod\r\n    \tpublic void tearDown() {\r\n    \t\tdriver.quit();\r\n    \t}\r\n    \t\r\n    }\r\n\r\nAnd below is the error I am getting - \r\n\r\n    [RemoteTestNG] detected TestNG version 6.14.3\r\n    org.testng.TestNGException: \r\n    Cannot instantiate class com.pvi.qa.testcases.LoginPageTest\r\n    \tat org.testng.internal.ObjectFactoryImpl.newInstance(ObjectFactoryImpl.java:30)\r\n    \tat org.testng.internal.ClassHelper.createInstance1(ClassHelper.java:423)\r\n    \tat org.testng.internal.ClassHelper.createInstance(ClassHelper.java:336)\r\n    \tat org.testng.internal.ClassImpl.getDefaultInstance(ClassImpl.java:125)\r\n    \tat org.testng.internal.ClassImpl.getInstances(ClassImpl.java:190)\r\n    \tat org.testng.TestClass.getInstances(TestClass.java:95)\r\n    \tat org.testng.TestClass.initTestClassesAndInstances(TestClass.java:81)\r\n    \tat org.testng.TestClass.init(TestClass.java:73)\r\n    \tat org.testng.TestClass.&lt;init&gt;(TestClass.java:38)\r\n    \tat org.testng.TestRunner.initMethods(TestRunner.java:389)\r\n    \tat org.testng.TestRunner.init(TestRunner.java:271)\r\n    \tat org.testng.TestRunner.init(TestRunner.java:241)\r\n    \tat org.testng.TestRunner.&lt;init&gt;(TestRunner.java:192)\r\n    \tat org.testng.remote.support.RemoteTestNG6_12$1.newTestRunner(RemoteTestNG6_12.java:33)\r\n    \tat org.testng.remote.support.RemoteTestNG6_12$DelegatingTestRunnerFactory.newTestRunner(RemoteTestNG6_12.java:66)\r\n    \tat org.testng.SuiteRunner$ProxyTestRunnerFactory.newTestRunner(SuiteRunner.java:713)\r\n    \tat org.testng.SuiteRunner.init(SuiteRunner.java:260)\r\n    \tat org.testng.SuiteRunner.&lt;init&gt;(SuiteRunner.java:198)\r\n    \tat org.testng.TestNG.createSuiteRunner(TestNG.java:1295)\r\n    \tat org.testng.TestNG.createSuiteRunners(TestNG.java:1273)\r\n    \tat org.testng.TestNG.runSuitesLocally(TestNG.java:1128)\r\n    \tat org.testng.TestNG.runSuites(TestNG.java:1049)\r\n    \tat org.testng.TestNG.run(TestNG.java:1017)\r\n    \tat org.testng.remote.AbstractRemoteTestNG.run(AbstractRemoteTestNG.java:114)\r\n    \tat org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:251)\r\n    \tat org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:77)\r\n    Caused by: java.lang.reflect.InvocationTargetException\r\n    \tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n    \tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\r\n    \tat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\r\n    \tat java.base/java.lang.reflect.Constructor.newInstance(Unknown Source)\r\n    \tat org.testng.internal.ObjectFactoryImpl.newInstance(ObjectFactoryImpl.java:24)\r\n    \t... 25 more\r\n    Caused by: java.lang.NullPointerException\r\n    \tat java.base/java.io.FileInputStream.&lt;init&gt;(Unknown Source)\r\n    \tat java.base/java.io.FileInputStream.&lt;init&gt;(Unknown Source)\r\n    \tat com.pvi.qa.base.TestBase.&lt;init&gt;(TestBase.java:20)\r\n    \tat com.pvi.qa.testcases.LoginPageTest.&lt;init&gt;(LoginPageTest.java:17)\r\n    \t... 30 more\r\n\r\nI have tried everything but not worked for me, Please let me know why I am getting this error. Thanks ","title":"org.testng.TestNGException : Cannot instantiate class","body":"<p>I am facing this 'Cannot insantiate class' error on running one of my test cases in selenium webdriver using java(Using Maven project).</p>\n\n<p>Below is the parent class where I defined driver and properties</p>\n\n<pre><code>package com.pvi.qa.base;\n\nimport java.io.FileInputStream;\nimport java.io.FileNotFoundException;\nimport java.io.IOException;\nimport java.util.Properties;\nimport java.util.concurrent.TimeUnit;\n\nimport org.openqa.selenium.WebDriver;\nimport org.openqa.selenium.chrome.ChromeDriver;\n\npublic class TestBase {\n\n    public static WebDriver driver;\n    public static Properties prop ;\n\n    public TestBase() {\n        try {\n            prop = new Properties();\n            FileInputStream ip = new FileInputStream(System.getProperty(\"C:\\\\Users\\\\RxLogix\\\\eclipse-workspace\\\\PviIntake\\\\src\\\\main\\\\java\\\\com\\\\pvi\\\\qa\\\\config\\\\config.properties\"));\n        prop.load(ip);\n\n        }\n        catch(FileNotFoundException e) {\n            e.printStackTrace();\n        }\n        catch(IOException e) {\n            e.printStackTrace();\n        }\n    }\n\npublic static void initialization () {\nString BrowserName = prop.getProperty(\"browser\");   \nif(BrowserName.equals(\"chrome\")) {\n    System.setProperty(\"webdriver.chrome.driver\", \"D:\\\\Softwares\\\\chromedriver_win32 (1)\\\\chromedriver.exe\");\n    driver = new ChromeDriver();}\ndriver.manage().window().maximize();\ndriver.manage().deleteAllCookies();\ndriver.manage().timeouts().pageLoadTimeout(20, TimeUnit.SECONDS);\ndriver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);\ndriver.get(prop.getProperty(\"url\"));\n}\n}\n</code></pre>\n\n<p>Below is the test cases class which I am running through TestNG</p>\n\n<pre><code>package com.pvi.qa.testcases;\n\nimport org.testng.annotations.AfterMethod;\nimport org.testng.annotations.BeforeMethod;\nimport org.testng.annotations.Test;\n\nimport com.pvi.qa.base.TestBase;\nimport com.pvi.qa.pages.HomePage;\nimport com.pvi.qa.pages.LoginPage;\n\npublic class LoginPageTest extends TestBase{\n    LoginPage loginPage;\n    HomePage homePage;\n\n\n    public LoginPageTest() {\n        super();\n        }\n\n    @BeforeMethod\n    public void setUp() {\n        initialization();\n        loginPage = new LoginPage();\n    }\n\n\n    @Test\n    public void logintest() {\n        homePage = loginPage.login(prop.getProperty(\"username\"), prop.getProperty(\"password\"));\n    }\n\n    @AfterMethod\n    public void tearDown() {\n        driver.quit();\n    }\n\n}\n</code></pre>\n\n<p>And below is the error I am getting - </p>\n\n<pre><code>[RemoteTestNG] detected TestNG version 6.14.3\norg.testng.TestNGException: \nCannot instantiate class com.pvi.qa.testcases.LoginPageTest\n    at org.testng.internal.ObjectFactoryImpl.newInstance(ObjectFactoryImpl.java:30)\n    at org.testng.internal.ClassHelper.createInstance1(ClassHelper.java:423)\n    at org.testng.internal.ClassHelper.createInstance(ClassHelper.java:336)\n    at org.testng.internal.ClassImpl.getDefaultInstance(ClassImpl.java:125)\n    at org.testng.internal.ClassImpl.getInstances(ClassImpl.java:190)\n    at org.testng.TestClass.getInstances(TestClass.java:95)\n    at org.testng.TestClass.initTestClassesAndInstances(TestClass.java:81)\n    at org.testng.TestClass.init(TestClass.java:73)\n    at org.testng.TestClass.&lt;init&gt;(TestClass.java:38)\n    at org.testng.TestRunner.initMethods(TestRunner.java:389)\n    at org.testng.TestRunner.init(TestRunner.java:271)\n    at org.testng.TestRunner.init(TestRunner.java:241)\n    at org.testng.TestRunner.&lt;init&gt;(TestRunner.java:192)\n    at org.testng.remote.support.RemoteTestNG6_12$1.newTestRunner(RemoteTestNG6_12.java:33)\n    at org.testng.remote.support.RemoteTestNG6_12$DelegatingTestRunnerFactory.newTestRunner(RemoteTestNG6_12.java:66)\n    at org.testng.SuiteRunner$ProxyTestRunnerFactory.newTestRunner(SuiteRunner.java:713)\n    at org.testng.SuiteRunner.init(SuiteRunner.java:260)\n    at org.testng.SuiteRunner.&lt;init&gt;(SuiteRunner.java:198)\n    at org.testng.TestNG.createSuiteRunner(TestNG.java:1295)\n    at org.testng.TestNG.createSuiteRunners(TestNG.java:1273)\n    at org.testng.TestNG.runSuitesLocally(TestNG.java:1128)\n    at org.testng.TestNG.runSuites(TestNG.java:1049)\n    at org.testng.TestNG.run(TestNG.java:1017)\n    at org.testng.remote.AbstractRemoteTestNG.run(AbstractRemoteTestNG.java:114)\n    at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:251)\n    at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:77)\nCaused by: java.lang.reflect.InvocationTargetException\n    at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n    at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n    at java.base/java.lang.reflect.Constructor.newInstance(Unknown Source)\n    at org.testng.internal.ObjectFactoryImpl.newInstance(ObjectFactoryImpl.java:24)\n    ... 25 more\nCaused by: java.lang.NullPointerException\n    at java.base/java.io.FileInputStream.&lt;init&gt;(Unknown Source)\n    at java.base/java.io.FileInputStream.&lt;init&gt;(Unknown Source)\n    at com.pvi.qa.base.TestBase.&lt;init&gt;(TestBase.java:20)\n    at com.pvi.qa.testcases.LoginPageTest.&lt;init&gt;(LoginPageTest.java:17)\n    ... 30 more\n</code></pre>\n\n<p>I have tried everything but not worked for me, Please let me know why I am getting this error. Thanks </p>\n"},{"tags":["java","android-studio","webview","android-webview"],"answers":[{"tags":[],"owner":{"account_id":20088006,"reputation":5,"user_id":14729168,"display_name":"Meeo Meo"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694366448,"creation_date":1613051649,"answer_id":66156088,"question_id":66152355,"body_markdown":"Ok, I got to solve it. If anybody runs into the same issue at some point in time:\r\n\r\n```\r\nimport java.lang.reflect.Method;\r\nimport java.lang.reflect.InvocationTargetException;\r\n```\r\n\r\n```\r\nwebView = new WebView(this);\r\n        webView = (WebView)findViewById(R.id.webview);\r\n        webView.getSettings().setLoadsImagesAutomatically(true);\r\n        webView.getSettings().setJavaScriptEnabled(true);\r\n        webView.getSettings().setBuiltInZoomControls(true);\r\n        webView.setInitialScale(65);\r\n        try {\r\n            Method m = webView.getClass().getMethod(&quot;setIsCacheDrawBitmap&quot;, boolean.class);\r\n            if (m != null) {\r\n                m.invoke(webView, false);\r\n                webView.getSettings().setLayoutAlgorithm(WebSettings.LayoutAlgorithm.NORMAL);\r\n            }\r\n        } catch (NoSuchMethodException e) {\r\n        } catch (IllegalAccessException e) {\r\n        } catch (InvocationTargetException e) {\r\n        }\r\n\r\n        webView.loadUrl(&quot;https://duckduckgo.com/&quot;);\r\n```\r\n\r\nFound the solution in here: \r\nhttps://stackoverflow.com/q/3025657/","title":"setInitialScale for older devices?","body":"<p>Ok, I got to solve it. If anybody runs into the same issue at some point in time:</p>\n<pre><code>import java.lang.reflect.Method;\nimport java.lang.reflect.InvocationTargetException;\n</code></pre>\n<pre><code>webView = new WebView(this);\n        webView = (WebView)findViewById(R.id.webview);\n        webView.getSettings().setLoadsImagesAutomatically(true);\n        webView.getSettings().setJavaScriptEnabled(true);\n        webView.getSettings().setBuiltInZoomControls(true);\n        webView.setInitialScale(65);\n        try {\n            Method m = webView.getClass().getMethod(&quot;setIsCacheDrawBitmap&quot;, boolean.class);\n            if (m != null) {\n                m.invoke(webView, false);\n                webView.getSettings().setLayoutAlgorithm(WebSettings.LayoutAlgorithm.NORMAL);\n            }\n        } catch (NoSuchMethodException e) {\n        } catch (IllegalAccessException e) {\n        } catch (InvocationTargetException e) {\n        }\n\n        webView.loadUrl(&quot;https://duckduckgo.com/&quot;);\n</code></pre>\n<p>Found the solution in here:\n<a href=\"https://stackoverflow.com/q/3025657/\">Android WebView not respecting scaling percentage</a></p>\n"}],"owner":{"account_id":20088006,"reputation":5,"user_id":14729168,"display_name":"Meeo Meo"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":110,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694366448,"creation_date":1613037254,"question_id":66152355,"body_markdown":"I&#39;m currently working on a webView application,\r\nbut I just can&#39;t get the initial zoom to work out, which should be at 150% when starting the app.\r\n\r\n```\r\nprivate static final int zoom = 150;\r\nwebView.setInitialScale(zoom);\r\n```\r\n\r\nThis seems to be working fine on newer devices, but is there an alternative to older devices as well?","title":"setInitialScale for older devices?","body":"<p>I'm currently working on a webView application,\nbut I just can't get the initial zoom to work out, which should be at 150% when starting the app.</p>\n<pre><code>private static final int zoom = 150;\nwebView.setInitialScale(zoom);\n</code></pre>\n<p>This seems to be working fine on newer devices, but is there an alternative to older devices as well?</p>\n"},{"tags":["java","weblogic","weblogic12c","wlst"],"comments":[{"owner":{"account_id":8415430,"reputation":2566,"user_id":6316044,"display_name":"Emmanuel Collin"},"score":0,"creation_date":1615554866,"post_id":66599606,"comment_id":117733548,"body_markdown":"Your JAR file must be added to WLST&#39;s classpath. \n$DOMAIN_HOME/lib is used by servers start scripts and not with WLST.","body":"Your JAR file must be added to WLST&#39;s classpath.  $DOMAIN_HOME/lib is used by servers start scripts and not with WLST."},{"owner":{"account_id":2492679,"reputation":20748,"user_id":2169845,"accept_rate":91,"display_name":"zappee"},"score":1,"creation_date":1615561142,"post_id":66599606,"comment_id":117736681,"body_markdown":"The JAR is on the server classpath. Otherwise, my custom security provider just does not appear on the WL console.","body":"The JAR is on the server classpath. Otherwise, my custom security provider just does not appear on the WL console."},{"owner":{"account_id":2492679,"reputation":20748,"user_id":2169845,"accept_rate":91,"display_name":"zappee"},"score":0,"creation_date":1615562001,"post_id":66599606,"comment_id":117737133,"body_markdown":"But please, correct me if I am wrong!","body":"But please, correct me if I am wrong!"},{"owner":{"account_id":8415430,"reputation":2566,"user_id":6316044,"display_name":"Emmanuel Collin"},"score":1,"creation_date":1615562289,"post_id":66599606,"comment_id":117737288,"body_markdown":"the server classpath is not wlst classpath.\nYour lib in the server classpath, so the console is able to deploy your custom security provider.\nIf you want to do so with WLST, you have to update your WLST script and update the classpath.","body":"the server classpath is not wlst classpath. Your lib in the server classpath, so the console is able to deploy your custom security provider. If you want to do so with WLST, you have to update your WLST script and update the classpath."}],"answers":[{"tags":[],"owner":{"account_id":2492679,"reputation":20748,"user_id":2169845,"accept_rate":91,"display_name":"zappee"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1615890753,"creation_date":1615890753,"answer_id":66653419,"question_id":66599606,"body_markdown":"I added my JAR to the WLST classpath, but this did not help.\r\n\r\n - I changed the `CLASSPATH` variable because the `wlst.sh` executes a java command in the background so this standard variable must be considered. It did not work.\r\n - I added the `-cp` JVM param manually to the java command that starts the WlST. It did not work.\r\n\r\n**The only workaround that worked for me is that the following:**\r\n\r\n - **for WL console**: copy the JAR that contains the custom authentication provider under `$ORACLE_HOME/user_projects/domains/$DOMAIN_NAME/lib/` directory\r\n - **for WLST**: copy the JAR to `$ORACLE_HOME/wlserver/server/lib/mbeantypes/`\r\n\r\nThe 2nd copy solved the `class not found issue` thrown by the WLST.\r\n\r\nIf you know a better, more standard way, please let me know.\r\n","title":"WebLogic: add a new custom authentication-providers via WLST throws a ClassNotFoundException","body":"<p>I added my JAR to the WLST classpath, but this did not help.</p>\n<ul>\n<li>I changed the <code>CLASSPATH</code> variable because the <code>wlst.sh</code> executes a java command in the background so this standard variable must be considered. It did not work.</li>\n<li>I added the <code>-cp</code> JVM param manually to the java command that starts the WlST. It did not work.</li>\n</ul>\n<p><strong>The only workaround that worked for me is that the following:</strong></p>\n<ul>\n<li><strong>for WL console</strong>: copy the JAR that contains the custom authentication provider under <code>$ORACLE_HOME/user_projects/domains/$DOMAIN_NAME/lib/</code> directory</li>\n<li><strong>for WLST</strong>: copy the JAR to <code>$ORACLE_HOME/wlserver/server/lib/mbeantypes/</code></li>\n</ul>\n<p>The 2nd copy solved the <code>class not found issue</code> thrown by the WLST.</p>\n<p>If you know a better, more standard way, please let me know.</p>\n"},{"tags":[],"owner":{"account_id":13616554,"reputation":109,"user_id":9822309,"display_name":"Sam"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1621305844,"creation_date":1621305844,"answer_id":67579271,"question_id":66599606,"body_markdown":"At some point oracle has changed from using `CLASSPATH` to `WLST_EXT_CLASSPATH` to set the classpath for WLST. Oracle doesn&#39;t seem to have done a great job of documenting that this is the right env variable to use though. I found it by digging through the various sh scripts that wlst.sh calls, but [this](https://docs.oracle.com/middleware/12213/wls/DEVSP/aud.htm#DEVSP418) document for 12c refers to it, but seems to be the only place that it&#39;s mentioned.\r\n\r\nI&#39;ve tested this using 14.1.1 and a custom provider in the DOMAIN/lib/mbeantypes dir and it works (i.e. I can use WLST to configure a custom security provider as long as I set WLST_EXT_CLASSPATH first) but don&#39;t have 12c to test that it works there.\r\n","title":"WebLogic: add a new custom authentication-providers via WLST throws a ClassNotFoundException","body":"<p>At some point oracle has changed from using <code>CLASSPATH</code> to <code>WLST_EXT_CLASSPATH</code> to set the classpath for WLST. Oracle doesn't seem to have done a great job of documenting that this is the right env variable to use though. I found it by digging through the various sh scripts that wlst.sh calls, but <a href=\"https://docs.oracle.com/middleware/12213/wls/DEVSP/aud.htm#DEVSP418\" rel=\"nofollow noreferrer\">this</a> document for 12c refers to it, but seems to be the only place that it's mentioned.</p>\n<p>I've tested this using 14.1.1 and a custom provider in the DOMAIN/lib/mbeantypes dir and it works (i.e. I can use WLST to configure a custom security provider as long as I set WLST_EXT_CLASSPATH first) but don't have 12c to test that it works there.</p>\n"}],"owner":{"account_id":2492679,"reputation":20748,"user_id":2169845,"accept_rate":91,"display_name":"zappee"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1008,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":67579271,"answer_count":2,"score":0,"last_activity_date":1694366405,"creation_date":1615550725,"question_id":66599606,"body_markdown":"I am trying to add a new custom authentication-provider with a WLST online-mode script but I get a class not found exception despite I can see my provider on the WL console.\r\n\r\n**This is the situation:**\r\n\r\n 1. I have a JAR file, it contains a custom WebLogic authentication-provider.\r\n 1. The JAR is copied under the `user_projects/domains/$DOMAIN_NAME/lib/` directory.\r\n 1. I can see the custom auth provider on the WL console, appears in the list: `Home &gt; Security Realms &gt; myrealm &gt; Providers &gt; new&gt; Type`\r\n 1. I can add this custom provider by hand via WL Console.\r\n\r\nBut I need to automate this step so I have created a WLST script for this. The relevant part of the WLST is this:\r\n\r\n    # add a new authentication provider with name of MyCustomAuthProvider\r\n    cd(&#39;/SecurityConfiguration/&#39; + _domainName + &#39;/Realms/myrealm&#39;)\r\n    cmo.createAuthenticationProvider(&#39;MyCustomAuthProvider&#39;, &#39;aa.bb.cc.MyCustomAuthProvider&#39;)\r\n    \r\n    cd(&#39;/SecurityConfiguration/&#39; + _domainName + &#39;/Realms/myrealm/AuthenticationProviders/MyCustomAuthProvider&#39;)\r\n    cmo.setControlFlag(&#39;OPTIONAL&#39;)\r\n        \r\n    # reorder authentication providers\r\n    ...\r\n\r\n**But this WLST throws the following exception:**\r\n\r\n    java.lang.RuntimeException: java.lang.RuntimeException: java.lang.ClassNotFoundException: aa.bb.cc.MyCustomAuthProvider\r\n\r\n\r\n**So I did double-check to see whether the WL sees my custom auth provider:**\r\n\r\n    wls:/offline&gt; connect(&#39;weblogic&#39;, &#39;weblogic12&#39;, &#39;t3://localhost:7001&#39;)\r\n    cd(&#39;/SecurityConfiguration/myDomain/Realms/myrealm&#39;)\r\n    ls()\r\n\r\nThe list I got is exactly the same as I expected: my class is on the list. This is the reason why I can add it using the web console.\r\n\r\n**This is the value of the AuthenticationProviderTypes:**\r\n\r\n    java.lang.String[com.bea.security.saml2.providers.SAML2IdentityAsserter,\r\n    aa.bb.cc.MyCustomAuthProvider,\r\n    eblogic.security.providers.authentication.ActiveDirectoryAuthenticator,\r\n    weblogic.security.providers.authentication.CustomDBMSAuthenticator,\r\n    eblogic.security.providers.authentication.DefaultAuthenticator,\r\n    weblogic.security.providers.authentication.DefaultIdentityAsserter, \r\n    eblogic.security.providers.authentication.IPlanetAuthenticator,\r\n    weblogic.security.providers.authentication.LDAPAuthenticator,\r\n    weblogic.security.providers.authentication.LDAPX509IdentityAsserter,\r\n    weblogic.security.providers.authentication.NegotiateIdentityAsserter,\r\n    weblogic.security.providers.authentication.NovellAuthenticator,\r\n    weblogic.security.providers.authentication.OpenLDAPAuthenticator,\r\n    weblogic.security.providers.authentication.OracleIdentityCloudIntegrator,\r\n    weblogic.security.providers.authentication.OracleInternetDirectoryAuthenticator,\r\n    weblogic.security.providers.authentication.OracleUnifiedDirectoryAuthenticator,\r\n    weblogic.security.providers.authentication.OracleVirtualDirectoryAuthenticator,\r\n    weblogic.security.providers.authentication.ReadOnlySQLAuthenticator,\r\n    weblogic.security.providers.authentication.SQLAuthenticator,\r\n    weblogic.security.providers.authentication.VirtualUserAuthenticator,\r\n    weblogic.security.providers.saml.SAMLAuthenticator,\r\n    weblogic.security.providers.saml.SAMLIdentityAsserterV2]\r\n\r\n\r\nEverything looks perfect. But then why WLST throws a `class not found` exception while trying to create it?\r\nThis is crazy.\r\n\r\nI have googled for this, but only the same issues I have found without a solution.\r\n\r\n - [here][1]\r\n\r\nWhat I missed?\r\n\r\n\r\n  [1]: https://github.com/biemond/puppet/issues/57\r\n","title":"WebLogic: add a new custom authentication-providers via WLST throws a ClassNotFoundException","body":"<p>I am trying to add a new custom authentication-provider with a WLST online-mode script but I get a class not found exception despite I can see my provider on the WL console.</p>\n<p><strong>This is the situation:</strong></p>\n<ol>\n<li>I have a JAR file, it contains a custom WebLogic authentication-provider.</li>\n<li>The JAR is copied under the <code>user_projects/domains/$DOMAIN_NAME/lib/</code> directory.</li>\n<li>I can see the custom auth provider on the WL console, appears in the list: <code>Home &gt; Security Realms &gt; myrealm &gt; Providers &gt; new&gt; Type</code></li>\n<li>I can add this custom provider by hand via WL Console.</li>\n</ol>\n<p>But I need to automate this step so I have created a WLST script for this. The relevant part of the WLST is this:</p>\n<pre><code># add a new authentication provider with name of MyCustomAuthProvider\ncd('/SecurityConfiguration/' + _domainName + '/Realms/myrealm')\ncmo.createAuthenticationProvider('MyCustomAuthProvider', 'aa.bb.cc.MyCustomAuthProvider')\n\ncd('/SecurityConfiguration/' + _domainName + '/Realms/myrealm/AuthenticationProviders/MyCustomAuthProvider')\ncmo.setControlFlag('OPTIONAL')\n    \n# reorder authentication providers\n...\n</code></pre>\n<p><strong>But this WLST throws the following exception:</strong></p>\n<pre><code>java.lang.RuntimeException: java.lang.RuntimeException: java.lang.ClassNotFoundException: aa.bb.cc.MyCustomAuthProvider\n</code></pre>\n<p><strong>So I did double-check to see whether the WL sees my custom auth provider:</strong></p>\n<pre><code>wls:/offline&gt; connect('weblogic', 'weblogic12', 't3://localhost:7001')\ncd('/SecurityConfiguration/myDomain/Realms/myrealm')\nls()\n</code></pre>\n<p>The list I got is exactly the same as I expected: my class is on the list. This is the reason why I can add it using the web console.</p>\n<p><strong>This is the value of the AuthenticationProviderTypes:</strong></p>\n<pre><code>java.lang.String[com.bea.security.saml2.providers.SAML2IdentityAsserter,\naa.bb.cc.MyCustomAuthProvider,\neblogic.security.providers.authentication.ActiveDirectoryAuthenticator,\nweblogic.security.providers.authentication.CustomDBMSAuthenticator,\neblogic.security.providers.authentication.DefaultAuthenticator,\nweblogic.security.providers.authentication.DefaultIdentityAsserter, \neblogic.security.providers.authentication.IPlanetAuthenticator,\nweblogic.security.providers.authentication.LDAPAuthenticator,\nweblogic.security.providers.authentication.LDAPX509IdentityAsserter,\nweblogic.security.providers.authentication.NegotiateIdentityAsserter,\nweblogic.security.providers.authentication.NovellAuthenticator,\nweblogic.security.providers.authentication.OpenLDAPAuthenticator,\nweblogic.security.providers.authentication.OracleIdentityCloudIntegrator,\nweblogic.security.providers.authentication.OracleInternetDirectoryAuthenticator,\nweblogic.security.providers.authentication.OracleUnifiedDirectoryAuthenticator,\nweblogic.security.providers.authentication.OracleVirtualDirectoryAuthenticator,\nweblogic.security.providers.authentication.ReadOnlySQLAuthenticator,\nweblogic.security.providers.authentication.SQLAuthenticator,\nweblogic.security.providers.authentication.VirtualUserAuthenticator,\nweblogic.security.providers.saml.SAMLAuthenticator,\nweblogic.security.providers.saml.SAMLIdentityAsserterV2]\n</code></pre>\n<p>Everything looks perfect. But then why WLST throws a <code>class not found</code> exception while trying to create it?\nThis is crazy.</p>\n<p>I have googled for this, but only the same issues I have found without a solution.</p>\n<ul>\n<li><a href=\"https://github.com/biemond/puppet/issues/57\" rel=\"nofollow noreferrer\">here</a></li>\n</ul>\n<p>What I missed?</p>\n"},{"tags":["java","spring","spring-boot","file-upload","multipartform-data"],"comments":[{"owner":{"account_id":6615151,"reputation":7343,"user_id":5108695,"display_name":"Dupinder Singh"},"score":0,"creation_date":1600271233,"post_id":61320431,"comment_id":113037242,"body_markdown":"hi @Tina. I am also facing the same issue. Are you using Spring Auth in your project also? Because Without SpringAuth my Multipart Request works fine, but When I start using Auth then is Request returns 400 error","body":"hi @Tina. I am also facing the same issue. Are you using Spring Auth in your project also? Because Without SpringAuth my Multipart Request works fine, but When I start using Auth then is Request returns 400 error"}],"answers":[{"comments":[{"owner":{"account_id":18346052,"reputation":11,"user_id":13361223,"display_name":"Tina"},"score":0,"creation_date":1587390786,"post_id":61321385,"comment_id":108485222,"body_markdown":"Thanks @nbalodi,\nWhen I setup logging.level.org.springframework.web=DEBUG. I got the error log now. Logs attached as below:\nHttpEntityMethodProcessor : No match for [application/json;charset=UTF-8], supported: []\nExceptionHandlerExceptionResolver : Resolved [org.springframework.web.multipart.support.MissingServletRequestPartException: Required request part &#39;file&#39; is not present]\nDispatcherServlet : Completed 400 BAD_REQUEST\nThe weird part is this error situation is only happen when we use the ssl settings as I described above.","body":"Thanks @nbalodi, When I setup logging.level.org.springframework.web=DEBUG. I got the error log now. Logs attached as below: HttpEntityMethodProcessor : No match for [application/json;charset=UTF-8], supported: [] ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.multipart.support.MissingServletReq&zwnj;&#8203;uestPartException: Required request part &#39;file&#39; is not present] DispatcherServlet : Completed 400 BAD_REQUEST The weird part is this error situation is only happen when we use the ssl settings as I described above."},{"owner":{"account_id":10988855,"reputation":84,"user_id":8073567,"display_name":"nbalodi"},"score":0,"creation_date":1587448407,"post_id":61321385,"comment_id":108507595,"body_markdown":"@Tina visit this thread, it seems to have same problem you are facing. https://stackoverflow.com/questions/31178160/spring-boot-doesnt-use-commonsmultipartresolver","body":"@Tina visit this thread, it seems to have same problem you are facing. <a href=\"https://stackoverflow.com/questions/31178160/spring-boot-doesnt-use-commonsmultipartresolver\" title=\"spring boot doesnt use commonsmultipartresolver\">stackoverflow.com/questions/31178160/&hellip;</a>"}],"tags":[],"owner":{"account_id":10988855,"reputation":84,"user_id":8073567,"display_name":"nbalodi"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1587382103,"creation_date":1587382103,"answer_id":61321385,"question_id":61320431,"body_markdown":"Is it possible to change your log level to DEBUG? i.e. logging.level.org.springframework.web=DEBUG.","title":"Got almost 50% http 400 bad request error on Spring Boot 2.1 MultipartFile - file upload when enable SSL(https)","body":"<p>Is it possible to change your log level to DEBUG? i.e. logging.level.org.springframework.web=DEBUG.</p>\n"},{"tags":[],"owner":{"account_id":15126163,"reputation":2731,"user_id":10915384,"display_name":"Kunal Vohra"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1587383836,"creation_date":1587383836,"answer_id":61321946,"question_id":61320431,"body_markdown":"Try thism may help. Unable to see any other issue with your code.   \r\n\r\n   \r\n\r\n    @RequestBody MultipartFile[] submissions\r\n\r\nshould be \r\n    \r\n    @RequestParam(&quot;file&quot;) MultipartFile[] submissions\r\n\r\nThe files are not the request body, they are part of it and there is no built-in `HttpMessageConverter` that can convert the request to an array of `MultiPartFile`.\r\n\r\nYou can also use `MultipartHttpServletRequest`, which gives you access to the headers of the individual parts.","title":"Got almost 50% http 400 bad request error on Spring Boot 2.1 MultipartFile - file upload when enable SSL(https)","body":"<p>Try thism may help. Unable to see any other issue with your code.   </p>\n\n<pre><code>@RequestBody MultipartFile[] submissions\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>@RequestParam(\"file\") MultipartFile[] submissions\n</code></pre>\n\n<p>The files are not the request body, they are part of it and there is no built-in <code>HttpMessageConverter</code> that can convert the request to an array of <code>MultiPartFile</code>.</p>\n\n<p>You can also use <code>MultipartHttpServletRequest</code>, which gives you access to the headers of the individual parts.</p>\n"},{"tags":[],"owner":{"account_id":18346052,"reputation":11,"user_id":13361223,"display_name":"Tina"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694366145,"creation_date":1591769764,"answer_id":62296999,"question_id":61320431,"body_markdown":"Thanks everyone&#39;s reply.\r\nI think this is the bug of SpringBoot or its embed Tomcat bug in SpringBoot v2.1.x version.\r\nWhen SpringBoot v2.3.0 formal vesion released. I use the same code to upgrade to v2.3.0\r\nEverything is workable now. I use bulk test or called pressure test in file upload.\r\nIt&#39;s 100% successful now.\r\n\r\n**Update:**\r\nThe root cause is Tomcat component is not stable with Spring framework - Multipart under the https and/or http2 or Spring security (such like OAuth2) enabled.\r\n\r\nIn most cases in Spring Boot 2.3.0 - 2.3.2, the fail rate of file upload is 4 ~ 14 ~ 50%.\r\nAfter Spring Boot 2.3.5 to 2.4.0 version, the fail rate of file upload is near 50%.\r\nThe key different is the Tomcat version and Spring Security version is different among these Spring Boot version.\r\n\r\nAnother problem is the http2 protocol supported by Tomcat is not stable.\r\nIf you enable the http2 (such like setup the server.http2.enabled=true in your properties file) and use Multipart or HttpServletRequest for your file upload, the fail rate is rise to near 90% and get connection .\r\n\r\n**Conclusion:**\r\nFor anyone which face the file upload unstable problem and get ERR_CONNECTION_CLOSED and find error log about\r\n\r\norg.apache.catalina.connector.ClientAbortException: org.apache.coyote.CloseNowException: Connection [{0}], Stream [{1}], This stream is not writable\r\n\r\nCaused by: org.apache.coyote.CloseNowException: Connection [{0}], Stream [{1}], This stream is not writable\r\n\r\nCaused by: org.apache.coyote.http2.StreamException: Connection [{0}], Stream [{1}], This stream is not writable\r\n\r\nYou can try to upgrade to Spring Boot 2.4.0 and disable http2 support of Tomcat in Spring Boot by setup the server.http2.enabled=false in your properties file\r\n\r\nYou may find the stability is improved even to 100% success rate. (I tried and implemented to all my clients)\r\n\r\nIf the disable http2 support is not workable for you.\r\nYou may try to downgrade to Spring Boot 2.3.0 - 2.3.2 version or implement your file upload by HttpServletRequest (remember to disable the Multipart in Spring Boot first)\r\n\r\nYou may find related developing document [here][1]\r\nand [there][2]\r\n\r\n  [1]: https://stackoverflow.com/q/32782026/\r\n  [2]: https://stackoverflow.com/q/54813440/","title":"Got almost 50% http 400 bad request error on Spring Boot 2.1 MultipartFile - file upload when enable SSL(https)","body":"<p>Thanks everyone's reply.\nI think this is the bug of SpringBoot or its embed Tomcat bug in SpringBoot v2.1.x version.\nWhen SpringBoot v2.3.0 formal vesion released. I use the same code to upgrade to v2.3.0\nEverything is workable now. I use bulk test or called pressure test in file upload.\nIt's 100% successful now.</p>\n<p><strong>Update:</strong>\nThe root cause is Tomcat component is not stable with Spring framework - Multipart under the https and/or http2 or Spring security (such like OAuth2) enabled.</p>\n<p>In most cases in Spring Boot 2.3.0 - 2.3.2, the fail rate of file upload is 4 ~ 14 ~ 50%.\nAfter Spring Boot 2.3.5 to 2.4.0 version, the fail rate of file upload is near 50%.\nThe key different is the Tomcat version and Spring Security version is different among these Spring Boot version.</p>\n<p>Another problem is the http2 protocol supported by Tomcat is not stable.\nIf you enable the http2 (such like setup the server.http2.enabled=true in your properties file) and use Multipart or HttpServletRequest for your file upload, the fail rate is rise to near 90% and get connection .</p>\n<p><strong>Conclusion:</strong>\nFor anyone which face the file upload unstable problem and get ERR_CONNECTION_CLOSED and find error log about</p>\n<p>org.apache.catalina.connector.ClientAbortException: org.apache.coyote.CloseNowException: Connection [{0}], Stream [{1}], This stream is not writable</p>\n<p>Caused by: org.apache.coyote.CloseNowException: Connection [{0}], Stream [{1}], This stream is not writable</p>\n<p>Caused by: org.apache.coyote.http2.StreamException: Connection [{0}], Stream [{1}], This stream is not writable</p>\n<p>You can try to upgrade to Spring Boot 2.4.0 and disable http2 support of Tomcat in Spring Boot by setup the server.http2.enabled=false in your properties file</p>\n<p>You may find the stability is improved even to 100% success rate. (I tried and implemented to all my clients)</p>\n<p>If the disable http2 support is not workable for you.\nYou may try to downgrade to Spring Boot 2.3.0 - 2.3.2 version or implement your file upload by HttpServletRequest (remember to disable the Multipart in Spring Boot first)</p>\n<p>You may find related developing document <a href=\"https://stackoverflow.com/q/32782026/\">here</a>\nand <a href=\"https://stackoverflow.com/q/54813440/\">there</a></p>\n"}],"owner":{"account_id":18346052,"reputation":11,"user_id":13361223,"display_name":"Tina"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2119,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":62296999,"answer_count":3,"score":0,"last_activity_date":1694366145,"creation_date":1587379068,"question_id":61320431,"body_markdown":"I have a API server which built with Spring Boot 2.1 on public domain which serve APIs and file upload as well.\r\n\r\nIn recent days, we wants to upgrade this Spring Boot server to use SSL (https).\r\nBefore we setup the SSL settings in Spring Boot. The API for file upload is workable very well (100% upload successful).\r\n\r\nAfter we setup the SSL settings in Spring Boot. The API for file upload is work but only 50% upload successful other 50% got http 400 bad request. (We sure that the problem is not related to front-end web, because we use the Swagger which bundled with Spring Boot to test can get the same result)\r\n\r\nAnd we lookup the server logs of Spring Boot. When the http 400 bad request happens, there were not have any logs about the http 400 bad request.\r\nWe study many days and survey on internet but still cannot solve this problem. Please give helps.\r\n\r\nWe already try to disable csrf (either in properties file or via config class) and many other solutions which provided on internet but still not work.\r\n\r\nEnvironment: Spring Boot 2.1.13 (which is the latest version of Spring Boot 2.1)\r\n\r\nSettings in properties file: (only added SSL setup section in properties file, and the SSL (https) is successfully on)\r\n\r\n```\r\n# SSL setup\r\nserver.ssl.key-store=classpath:keystore.p12\r\nserver.ssl.key-store-password=abcdef\r\nserver.ssl.key-store-type=PKCS12\r\nserver.ssl.key-alias=tomcat\r\nserver.ssl.enabled-protocols=TLSv1.1,TLSv1.2\r\nserver.http2.enabled=true\r\nsecurity.basic.enabled=false\r\nsecurity.enable-csrf=false\r\n\r\n## MULTIPART (MultipartProperties)\r\n# Enable multipart uploads\r\nspring.servlet.multipart.enabled = true\r\n# Threshold after which files are written to disk.\r\nspring.servlet.multipart.file-size-threshold=2KB\r\n# Max file size.\r\nspring.servlet.multipart.max-file-size=100MB\r\n# Max Request Size\r\nspring.servlet.multipart.max-request-size=115MB\r\n```\r\n\r\nMy controller for file upload:\r\n\r\n```\r\nimport io.swagger.annotations.Api;\r\nimport io.swagger.annotations.ApiOperation;\r\nimport io.swagger.annotations.SwaggerDefinition;\r\nimport io.swagger.annotations.Tag;\r\nimport java.util.Collections;\r\nimport java.util.Map;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.http.MediaType;\r\nimport org.springframework.http.ResponseEntity;\r\nimport org.springframework.web.bind.annotation.RequestMapping;\r\nimport org.springframework.web.bind.annotation.RequestMethod;\r\nimport org.springframework.web.bind.annotation.RequestParam;\r\nimport org.springframework.web.bind.annotation.RestController;\r\nimport org.springframework.web.multipart.MultipartFile;\r\n\r\n@Slf4j\r\n@RestController\r\n@RequestMapping(value = &quot;/v1/fileupload&quot;)\r\n@Api(tags = {&quot;fileupload api&quot;}, value = &quot;fileupload&quot;)\r\n@SwaggerDefinition(tags = {\r\n    @Tag(name = &quot;fileupload api&quot;, description = &quot;apis for file upload&quot;)\r\n})\r\npublic class FileUploadController {\r\n\t\r\n\t@Autowired\r\n\tprivate FileUploadService fileUploadService;\r\n\t\r\n\tprivate ApiUtilHelper helper = new ApiUtilHelper();\r\n\t\r\n\t@ApiOperation(value = &quot;upload single data import file&quot;)\r\n\t@RequestMapping(\r\n\t\tvalue = &quot;/dataimport&quot;,\r\n\t\tmethod = RequestMethod.POST,,\r\n\t\tconsumes = { MediaType.MULTIPART_FORM_DATA_VALUE },\r\n\t\tproduces = { MediaType.APPLICATION_JSON_UTF8_VALUE }\r\n\t)\r\n\tpublic ResponseEntity&lt;?&gt; uploadSingleFileForDataImport(@RequestParam(&quot;file&quot;) MultipartFile file) throws FileStorageException {\r\n\t\tlog.info(&quot;Enter into uploadSingleFileForDataImport&quot;);\r\n\t\tFileUploadResponse fileUploadResponse = fileUploadService.storeFile(file, &quot;dataImport&quot;);\r\n\t\tMap&lt;String, Object&gt; additionals = Collections.singletonMap(&quot;filupload&quot;, fileUploadResponse);\r\n\t\tBasicResponse br = helper.createSuccessBaseResponse(ApiSuccessCode.CreateSuccess, additionals);\r\n\t\treturn new ResponseEntity&lt;BasicResponse&gt;(br, ApiSuccessCode.CreateSuccess.getHttpStatus());\r\n\t}\r\n```\r\n\r\nSwagger test result:\r\n\r\n```\r\nRequest URL: https://example.com:8443/v1/fileupload/dataimport\r\nRequest Method: POST\r\nStatus Code: 400 \r\nRemote Address: 111.222.111.222:8443\r\nReferrer Policy: no-referrer-when-downgrade\r\n\r\n**Response http header from Spring Boot**\r\nConnection: close\r\nContent-Length: 0\r\nDate: Mon, 20 Apr 2020 13:13:02 GMT\r\n\r\n**Request http header from Swagger**\r\naccept: application/json;charset=UTF-8\r\nAccept-Encoding: gzip, deflate, br\r\nAccept-Language: zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-CN;q=0.6,ja;q=0.5\r\nConnection: keep-alive\r\nContent-Length: 484098\r\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryiXmuHnaNthhXowmb\r\nCookie: _ga=GA1.2.1299976434.1580821082; JSESSIONID=2C157019D6560405CC75A5F5083DE0AE\r\nHost: example.com:8443\r\nOrigin: https://example.com:8443\r\nReferer: https://example.com:8443/swagger-ui.html\r\nSec-Fetch-Dest: empty\r\nSec-Fetch-Mode: cors\r\nSec-Fetch-Site: same-origin\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36\r\n\r\n```\r\n\r\n2020.04.20 13:44 (UTC time) supplement info as below:\r\nThanks @nbalodi,\r\nWhen I setup logging.level.org.springframework.web=DEBUG. I got the error log now. Logs attached as below:\r\n```\r\nHttpEntityMethodProcessor : No match for [application/json;charset=UTF-8], supported: []\r\nExceptionHandlerExceptionResolver : Resolved [org.springframework.web.multipart.support.MissingServletRequestPartException: Required request part &#39;file&#39; is not present]\r\nDispatcherServlet : Completed 400 BAD_REQUEST\r\n```\r\nThe weird part is this error situation is only happen when we use the ssl settings as I described above.","title":"Got almost 50% http 400 bad request error on Spring Boot 2.1 MultipartFile - file upload when enable SSL(https)","body":"<p>I have a API server which built with Spring Boot 2.1 on public domain which serve APIs and file upload as well.</p>\n\n<p>In recent days, we wants to upgrade this Spring Boot server to use SSL (https).\nBefore we setup the SSL settings in Spring Boot. The API for file upload is workable very well (100% upload successful).</p>\n\n<p>After we setup the SSL settings in Spring Boot. The API for file upload is work but only 50% upload successful other 50% got http 400 bad request. (We sure that the problem is not related to front-end web, because we use the Swagger which bundled with Spring Boot to test can get the same result)</p>\n\n<p>And we lookup the server logs of Spring Boot. When the http 400 bad request happens, there were not have any logs about the http 400 bad request.\nWe study many days and survey on internet but still cannot solve this problem. Please give helps.</p>\n\n<p>We already try to disable csrf (either in properties file or via config class) and many other solutions which provided on internet but still not work.</p>\n\n<p>Environment: Spring Boot 2.1.13 (which is the latest version of Spring Boot 2.1)</p>\n\n<p>Settings in properties file: (only added SSL setup section in properties file, and the SSL (https) is successfully on)</p>\n\n<pre><code># SSL setup\nserver.ssl.key-store=classpath:keystore.p12\nserver.ssl.key-store-password=abcdef\nserver.ssl.key-store-type=PKCS12\nserver.ssl.key-alias=tomcat\nserver.ssl.enabled-protocols=TLSv1.1,TLSv1.2\nserver.http2.enabled=true\nsecurity.basic.enabled=false\nsecurity.enable-csrf=false\n\n## MULTIPART (MultipartProperties)\n# Enable multipart uploads\nspring.servlet.multipart.enabled = true\n# Threshold after which files are written to disk.\nspring.servlet.multipart.file-size-threshold=2KB\n# Max file size.\nspring.servlet.multipart.max-file-size=100MB\n# Max Request Size\nspring.servlet.multipart.max-request-size=115MB\n</code></pre>\n\n<p>My controller for file upload:</p>\n\n<pre><code>import io.swagger.annotations.Api;\nimport io.swagger.annotations.ApiOperation;\nimport io.swagger.annotations.SwaggerDefinition;\nimport io.swagger.annotations.Tag;\nimport java.util.Collections;\nimport java.util.Map;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.http.MediaType;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RequestMethod;\nimport org.springframework.web.bind.annotation.RequestParam;\nimport org.springframework.web.bind.annotation.RestController;\nimport org.springframework.web.multipart.MultipartFile;\n\n@Slf4j\n@RestController\n@RequestMapping(value = \"/v1/fileupload\")\n@Api(tags = {\"fileupload api\"}, value = \"fileupload\")\n@SwaggerDefinition(tags = {\n    @Tag(name = \"fileupload api\", description = \"apis for file upload\")\n})\npublic class FileUploadController {\n\n    @Autowired\n    private FileUploadService fileUploadService;\n\n    private ApiUtilHelper helper = new ApiUtilHelper();\n\n    @ApiOperation(value = \"upload single data import file\")\n    @RequestMapping(\n        value = \"/dataimport\",\n        method = RequestMethod.POST,,\n        consumes = { MediaType.MULTIPART_FORM_DATA_VALUE },\n        produces = { MediaType.APPLICATION_JSON_UTF8_VALUE }\n    )\n    public ResponseEntity&lt;?&gt; uploadSingleFileForDataImport(@RequestParam(\"file\") MultipartFile file) throws FileStorageException {\n        log.info(\"Enter into uploadSingleFileForDataImport\");\n        FileUploadResponse fileUploadResponse = fileUploadService.storeFile(file, \"dataImport\");\n        Map&lt;String, Object&gt; additionals = Collections.singletonMap(\"filupload\", fileUploadResponse);\n        BasicResponse br = helper.createSuccessBaseResponse(ApiSuccessCode.CreateSuccess, additionals);\n        return new ResponseEntity&lt;BasicResponse&gt;(br, ApiSuccessCode.CreateSuccess.getHttpStatus());\n    }\n</code></pre>\n\n<p>Swagger test result:</p>\n\n<pre><code>Request URL: https://example.com:8443/v1/fileupload/dataimport\nRequest Method: POST\nStatus Code: 400 \nRemote Address: 111.222.111.222:8443\nReferrer Policy: no-referrer-when-downgrade\n\n**Response http header from Spring Boot**\nConnection: close\nContent-Length: 0\nDate: Mon, 20 Apr 2020 13:13:02 GMT\n\n**Request http header from Swagger**\naccept: application/json;charset=UTF-8\nAccept-Encoding: gzip, deflate, br\nAccept-Language: zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-CN;q=0.6,ja;q=0.5\nConnection: keep-alive\nContent-Length: 484098\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryiXmuHnaNthhXowmb\nCookie: _ga=GA1.2.1299976434.1580821082; JSESSIONID=2C157019D6560405CC75A5F5083DE0AE\nHost: example.com:8443\nOrigin: https://example.com:8443\nReferer: https://example.com:8443/swagger-ui.html\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36\n\n</code></pre>\n\n<p>2020.04.20 13:44 (UTC time) supplement info as below:\nThanks @nbalodi,\nWhen I setup logging.level.org.springframework.web=DEBUG. I got the error log now. Logs attached as below:</p>\n\n<pre><code>HttpEntityMethodProcessor : No match for [application/json;charset=UTF-8], supported: []\nExceptionHandlerExceptionResolver : Resolved [org.springframework.web.multipart.support.MissingServletRequestPartException: Required request part 'file' is not present]\nDispatcherServlet : Completed 400 BAD_REQUEST\n</code></pre>\n\n<p>The weird part is this error situation is only happen when we use the ssl settings as I described above.</p>\n"},{"tags":["java","android","kotlin","android-viewmodel"],"comments":[{"owner":{"account_id":5442381,"reputation":16756,"user_id":4409113,"accept_rate":88,"display_name":"ʍѳђઽ૯ท"},"score":1,"creation_date":1537304049,"post_id":52394416,"comment_id":91734012,"body_markdown":"Would you paste the logcat which crash occured? Not just a line of error? Thanks. However I&#39;m suspecting that this might cause the issue: `public WordViewModel(Application application)`","body":"Would you paste the logcat which crash occured? Not just a line of error? Thanks. However I&#39;m suspecting that this might cause the issue: <code>public WordViewModel(Application application)</code>"},{"owner":{"account_id":10856877,"reputation":103,"user_id":7982964,"display_name":"Mwen Rele"},"score":0,"creation_date":1537305020,"post_id":52394416,"comment_id":91734369,"body_markdown":"Posted the whole error.","body":"Posted the whole error."},{"owner":{"account_id":1849514,"reputation":193878,"user_id":1676363,"accept_rate":100,"display_name":"ianhanniballake"},"score":0,"creation_date":1537305209,"post_id":52394416,"comment_id":91734452,"body_markdown":"The error seems unrelated to ViewModels: `Caused by: java.lang.RuntimeException: cannot find implementation for com.meme.archcompwordlist.room.WordRoomDatabase. WordRoomDatabase_Impl`","body":"The error seems unrelated to ViewModels: <code>Caused by: java.lang.RuntimeException: cannot find implementation for com.meme.archcompwordlist.room.WordRoomDatabase. WordRoomDatabase_Impl</code>"},{"owner":{"account_id":10856877,"reputation":103,"user_id":7982964,"display_name":"Mwen Rele"},"score":0,"creation_date":1537307722,"post_id":52394416,"comment_id":91735315,"body_markdown":"Yeah, thanks. I was curious why you asked for the whole trace and so look deeper into the scary stuff and found that I needed some gradle dependencies to start: \n    **annotationProcessor  &quot;android.arch.persistence.room:compiler:$lifecycle_version&quot;\n    kapt &quot;android.arch.persistence.room:compiler:$lifecycle_version&quot;** My code is in a better state now","body":"Yeah, thanks. I was curious why you asked for the whole trace and so look deeper into the scary stuff and found that I needed some gradle dependencies to start:      <b>annotationProcessor  &quot;android.arch.persistence.room:compiler:$lifecycle_version&quot;     kapt &quot;android.arch.persistence.room:compiler:$lifecycle_version&quot;</b> My code is in a better state now"}],"answers":[{"tags":[],"owner":{"account_id":7916116,"reputation":263,"user_id":5978486,"display_name":"humanheima"},"comment_count":0,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1694365870,"creation_date":1583993556,"answer_id":60648506,"question_id":52394416,"body_markdown":"I met the same problem and find resolution from https://stackoverflow.com/q/56412140/\r\n\r\nYou should pass a `ViewModelProvider.AndroidViewModelFactory` to `ViewModelProvider` as follow:\r\n\r\n```\r\nWordViewModel model = new ViewModelProvider(this, new ViewModelProvider.AndroidViewModelFactory(getApplication())).get(WordViewModel.class);\r\n```","title":"Cannot create an instance of subclass of AndroidViewModel","body":"<p>I met the same problem and find resolution from <a href=\"https://stackoverflow.com/q/56412140/\">How to fix &#39;Cannot create an instance of ViewModel class&#39;?</a></p>\n<p>You should pass a <code>ViewModelProvider.AndroidViewModelFactory</code> to <code>ViewModelProvider</code> as follow:</p>\n<pre><code>WordViewModel model = new ViewModelProvider(this, new ViewModelProvider.AndroidViewModelFactory(getApplication())).get(WordViewModel.class);\n</code></pre>\n"}],"owner":{"account_id":10856877,"reputation":103,"user_id":7982964,"display_name":"Mwen Rele"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1074,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":1,"score":3,"last_activity_date":1694365870,"creation_date":1537303746,"question_id":52394416,"body_markdown":"My ViewModel class is in Java and my Activity class is in Kotlin. I am getting the error \r\n\r\n&gt; 09-18 14:01:32.737 14082-14082/com.meme.archcompwordlist\r\n&gt; E/AndroidRuntime: FATAL EXCEPTION: main Process:\r\n&gt; com.meme.archcompwordlist, PID: 14082 java.lang.RuntimeException:\r\n&gt; Unable to start activity\r\n&gt; ComponentInfo{com.meme.archcompwordlist/com.meme.archcompwordlist.MainActivity}:\r\n&gt; java.lang.RuntimeException: Cannot create an instance of class\r\n&gt; com.meme.archcompwordlist.WordViewModel\r\n&gt;     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2665)\r\n&gt;     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2726)\r\n&gt;     at android.app.ActivityThread.-wrap12(ActivityThread.java)\r\n&gt;     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1477)\r\n&gt;     at android.os.Handler.dispatchMessage(Handler.java:102)\r\n&gt;     at android.os.Looper.loop(Looper.java:154)\r\n&gt;     at android.app.ActivityThread.main(ActivityThread.java:6119)\r\n&gt;     at java.lang.reflect.Method.invoke(Native Method)\r\n&gt;     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:886)\r\n&gt;     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:776)  Caused by: java.lang.RuntimeException: Cannot create an instance of\r\n&gt; class com.meme.archcompwordlist.WordViewModel\r\n&gt;     at android.arch.lifecycle.ViewModelProvider$AndroidViewModelFactory.create(ViewModelProvider.java:207)\r\n&gt;     at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:134)\r\n&gt;     at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:102)\r\n&gt;     at com.meme.archcompwordlist.MainActivity.onCreate(MainActivity.kt:37)\r\n&gt;     at android.app.Activity.performCreate(Activity.java:6679)\r\n&gt;     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1118)\r\n&gt;     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2618)\r\n&gt;     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2726)&#160;\r\n&gt;     at android.app.ActivityThread.-wrap12(ActivityThread.java)&#160;\r\n&gt;     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1477)&#160;\r\n&gt;     at android.os.Handler.dispatchMessage(Handler.java:102)&#160;\r\n&gt;     at android.os.Looper.loop(Looper.java:154)&#160;\r\n&gt;     at android.app.ActivityThread.main(ActivityThread.java:6119)&#160;\r\n&gt;     at java.lang.reflect.Method.invoke(Native Method)&#160;\r\n&gt;     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:886)&#160;\r\n&gt;     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:776)&#160;  Caused by: java.lang.reflect.InvocationTargetException\r\n&gt;     at java.lang.reflect.Constructor.newInstance0(Native Method)\r\n&gt;     at java.lang.reflect.Constructor.newInstance(Constructor.java:430)\r\n&gt;     at android.arch.lifecycle.ViewModelProvider$AndroidViewModelFactory.create(ViewModelProvider.java:199)\r\n&gt;     at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:134)&#160;\r\n&gt;     at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:102)&#160;\r\n&gt;     at com.meme.archcompwordlist.MainActivity.onCreate(MainActivity.kt:37)&#160;\r\n&gt;     at android.app.Activity.performCreate(Activity.java:6679)&#160;\r\n&gt;     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1118)&#160;\r\n&gt;     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2618)&#160;\r\n&gt;     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2726)&#160;\r\n&gt;     at android.app.ActivityThread.-wrap12(ActivityThread.java)&#160;\r\n&gt;     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1477)&#160;\r\n&gt;     at android.os.Handler.dispatchMessage(Handler.java:102)&#160;\r\n&gt;     at android.os.Looper.loop(Looper.java:154)&#160;\r\n&gt;     at android.app.ActivityThread.main(ActivityThread.java:6119)&#160;\r\n&gt;     at java.lang.reflect.Method.invoke(Native Method)&#160;\r\n&gt;     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:886)&#160;\r\n&gt;     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:776)&#160;  Caused by: java.lang.RuntimeException: cannot find implementation for\r\n&gt; com.meme.archcompwordlist.room.WordRoomDatabase. WordRoomDatabase_Impl\r\n&gt; does not exist\r\n&gt;     at android.arch.persistence.room.Room.getGeneratedImplementation(Room.java:93)\r\n&gt;     at android.arch.persistence.room.RoomDatabase$Builder.build(RoomDatabase.java:630)\r\n&gt;     at com.meme.archcompwordlist.room.WordRoomDatabase.getRoomDatabase(WordRoomDatabase.java:22)\r\n&gt;     at com.meme.archcompwordlist.WordRepository.&lt;init&gt;(WordRepository.java:21)\r\n&gt;     at com.meme.archcompwordlist.WordViewModel.&lt;init&gt;(WordViewModel.java:22)\r\n&gt;     at java.lang.reflect.Constructor.newInstance0(Native Method)&#160;\r\n&gt;     at java.lang.reflect.Constructor.newInstance(Constructor.java:430)&#160;\r\n&gt;     at android.arch.lifecycle.ViewModelProvider$AndroidViewModelFactory.create(ViewModelProvider.java:199)&#160;\r\n&gt;     at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:134)&#160;\r\n&gt;     at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:102)&#160;\r\n&gt;     at com.meme.archcompwordlist.MainActivity.onCreate(MainActivity.kt:37)&#160;\r\n&gt;     at android.app.Activity.performCreate(Activity.java:6679)&#160;\r\n&gt;     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1118)&#160;\r\n&gt;     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2618)&#160;\r\n&gt;     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2726)&#160;\r\n&gt;     at android.app.ActivityThread.-wrap12(ActivityThread.java)&#160;\r\n&gt;     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1477)&#160;\r\n&gt;     at android.os.Handler.dispatchMessage(Handler.java:102)&#160;\r\n&gt;     at android.os.Looper.loop(Looper.java:154)&#160;\r\n&gt;     at android.app.ActivityThread.main(ActivityThread.java:6119)&#160;\r\n&gt;     at java.lang.reflect.Method.invoke(Native Method)&#160;\r\n&gt;     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:886)&#160;\r\n&gt;     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:776)\r\n\r\n\r\nHere is my AndroidViewModel class\r\n\r\n    public class WordViewModel extends AndroidViewModel {\r\n    \r\n        private WordRepository repository;\r\n    \r\n        private LiveData&lt;List&lt;WordEntity&gt;&gt; allWords;\r\n    \r\n        public WordViewModel(Application application){\r\n            super(application);\r\n            repository = new WordRepository(application);\r\n            allWords = repository.getAllWords();\r\n        }\r\n    \r\n        public LiveData&lt;List&lt;WordEntity&gt;&gt; getAllWords(){\r\n            return allWords;\r\n        }\r\n    \r\n        public void insert(WordEntity word){\r\n            repository.insert(word);\r\n        }\r\n    \r\n        public void deleteAllWords() {\r\n            repository.deleteAllWords();\r\n        }\r\n    }\r\n\r\nAnd here is my activity class\r\n\r\n    class MainActivity : AppCompatActivity() {\r\n    \r\n        private lateinit var wordViewModel:WordViewModel\r\n        private lateinit var newWord:EditText\r\n        private lateinit var recyclerView:RecyclerView\r\n        private lateinit var adapter:WordAdapter\r\n    \r\n    \r\n        override fun onCreate(savedInstanceState: Bundle?) {\r\n            super.onCreate(savedInstanceState)\r\n            setContentView(R.layout.activity_main)\r\n            setSupportActionBar(toolbar)\r\n    \r\n            adapter= WordAdapter()\r\n            recyclerView= findViewById&lt;RecyclerView&gt;(R.id.wordList)\r\n            recyclerView.adapter=adapter\r\n    \r\n            //establish a connection to the current ViewModel\r\n            wordViewModel= ViewModelProviders.of(this).get(WordViewModel::class.java)\r\n    \r\n            newWord = findViewById&lt;EditText&gt;(R.id.insertWord);\r\n            findViewById&lt;Button&gt;(R.id.submitWord).setOnClickListener {\r\n                 fun onClick(v:View?){\r\n                    if(!TextUtils.isEmpty(newWord.getText())){\r\n                        wordViewModel.insert(WordEntity(newWord.getText().toString()))\r\n                    }\r\n                }\r\n            }\r\n            findViewById&lt;Button&gt;(R.id.deleteWords).setOnClickListener{\r\n                fun onClick(v:View?){\r\n                    wordViewModel.deleteAllWords()\r\n                }\r\n            }\r\n    \r\n    \r\n            wordViewModel.getAllWords().observe(this,Observer&lt;List&lt;WordEntity&gt;&gt;(){\r\n                fun onChanged(words:List&lt;WordEntity&gt;){\r\n                adapter.setWords(words)\r\n            }\r\n            })\r\n    \r\n        }\r\n    \r\n    }\r\n\r\nCould someone please help me identify what I am doing wrong? I am trying to pick-up Architecture Components after a long time away from Android. I am not entirely clear how to proceed.","title":"Cannot create an instance of subclass of AndroidViewModel","body":"<p>My ViewModel class is in Java and my Activity class is in Kotlin. I am getting the error </p>\n\n<blockquote>\n  <p>09-18 14:01:32.737 14082-14082/com.meme.archcompwordlist\n  E/AndroidRuntime: FATAL EXCEPTION: main Process:\n  com.meme.archcompwordlist, PID: 14082 java.lang.RuntimeException:\n  Unable to start activity\n  ComponentInfo{com.meme.archcompwordlist/com.meme.archcompwordlist.MainActivity}:\n  java.lang.RuntimeException: Cannot create an instance of class\n  com.meme.archcompwordlist.WordViewModel\n      at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2665)\n      at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2726)\n      at android.app.ActivityThread.-wrap12(ActivityThread.java)\n      at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1477)\n      at android.os.Handler.dispatchMessage(Handler.java:102)\n      at android.os.Looper.loop(Looper.java:154)\n      at android.app.ActivityThread.main(ActivityThread.java:6119)\n      at java.lang.reflect.Method.invoke(Native Method)\n      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:886)\n      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:776)  Caused by: java.lang.RuntimeException: Cannot create an instance of\n  class com.meme.archcompwordlist.WordViewModel\n      at android.arch.lifecycle.ViewModelProvider$AndroidViewModelFactory.create(ViewModelProvider.java:207)\n      at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:134)\n      at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:102)\n      at com.meme.archcompwordlist.MainActivity.onCreate(MainActivity.kt:37)\n      at android.app.Activity.performCreate(Activity.java:6679)\n      at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1118)\n      at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2618)\n      at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2726) \n      at android.app.ActivityThread.-wrap12(ActivityThread.java) \n      at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1477) \n      at android.os.Handler.dispatchMessage(Handler.java:102) \n      at android.os.Looper.loop(Looper.java:154) \n      at android.app.ActivityThread.main(ActivityThread.java:6119) \n      at java.lang.reflect.Method.invoke(Native Method) \n      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:886) \n      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:776)   Caused by: java.lang.reflect.InvocationTargetException\n      at java.lang.reflect.Constructor.newInstance0(Native Method)\n      at java.lang.reflect.Constructor.newInstance(Constructor.java:430)\n      at android.arch.lifecycle.ViewModelProvider$AndroidViewModelFactory.create(ViewModelProvider.java:199)\n      at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:134) \n      at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:102) \n      at com.meme.archcompwordlist.MainActivity.onCreate(MainActivity.kt:37) \n      at android.app.Activity.performCreate(Activity.java:6679) \n      at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1118) \n      at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2618) \n      at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2726) \n      at android.app.ActivityThread.-wrap12(ActivityThread.java) \n      at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1477) \n      at android.os.Handler.dispatchMessage(Handler.java:102) \n      at android.os.Looper.loop(Looper.java:154) \n      at android.app.ActivityThread.main(ActivityThread.java:6119) \n      at java.lang.reflect.Method.invoke(Native Method) \n      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:886) \n      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:776)   Caused by: java.lang.RuntimeException: cannot find implementation for\n  com.meme.archcompwordlist.room.WordRoomDatabase. WordRoomDatabase_Impl\n  does not exist\n      at android.arch.persistence.room.Room.getGeneratedImplementation(Room.java:93)\n      at android.arch.persistence.room.RoomDatabase$Builder.build(RoomDatabase.java:630)\n      at com.meme.archcompwordlist.room.WordRoomDatabase.getRoomDatabase(WordRoomDatabase.java:22)\n      at com.meme.archcompwordlist.WordRepository.(WordRepository.java:21)\n      at com.meme.archcompwordlist.WordViewModel.(WordViewModel.java:22)\n      at java.lang.reflect.Constructor.newInstance0(Native Method) \n      at java.lang.reflect.Constructor.newInstance(Constructor.java:430) \n      at android.arch.lifecycle.ViewModelProvider$AndroidViewModelFactory.create(ViewModelProvider.java:199) \n      at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:134) \n      at android.arch.lifecycle.ViewModelProvider.get(ViewModelProvider.java:102) \n      at com.meme.archcompwordlist.MainActivity.onCreate(MainActivity.kt:37) \n      at android.app.Activity.performCreate(Activity.java:6679) \n      at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1118) \n      at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2618) \n      at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2726) \n      at android.app.ActivityThread.-wrap12(ActivityThread.java) \n      at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1477) \n      at android.os.Handler.dispatchMessage(Handler.java:102) \n      at android.os.Looper.loop(Looper.java:154) \n      at android.app.ActivityThread.main(ActivityThread.java:6119) \n      at java.lang.reflect.Method.invoke(Native Method) \n      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:886) \n      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:776)</p>\n</blockquote>\n\n<p>Here is my AndroidViewModel class</p>\n\n<pre><code>public class WordViewModel extends AndroidViewModel {\n\n    private WordRepository repository;\n\n    private LiveData&lt;List&lt;WordEntity&gt;&gt; allWords;\n\n    public WordViewModel(Application application){\n        super(application);\n        repository = new WordRepository(application);\n        allWords = repository.getAllWords();\n    }\n\n    public LiveData&lt;List&lt;WordEntity&gt;&gt; getAllWords(){\n        return allWords;\n    }\n\n    public void insert(WordEntity word){\n        repository.insert(word);\n    }\n\n    public void deleteAllWords() {\n        repository.deleteAllWords();\n    }\n}\n</code></pre>\n\n<p>And here is my activity class</p>\n\n<pre><code>class MainActivity : AppCompatActivity() {\n\n    private lateinit var wordViewModel:WordViewModel\n    private lateinit var newWord:EditText\n    private lateinit var recyclerView:RecyclerView\n    private lateinit var adapter:WordAdapter\n\n\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        setContentView(R.layout.activity_main)\n        setSupportActionBar(toolbar)\n\n        adapter= WordAdapter()\n        recyclerView= findViewById&lt;RecyclerView&gt;(R.id.wordList)\n        recyclerView.adapter=adapter\n\n        //establish a connection to the current ViewModel\n        wordViewModel= ViewModelProviders.of(this).get(WordViewModel::class.java)\n\n        newWord = findViewById&lt;EditText&gt;(R.id.insertWord);\n        findViewById&lt;Button&gt;(R.id.submitWord).setOnClickListener {\n             fun onClick(v:View?){\n                if(!TextUtils.isEmpty(newWord.getText())){\n                    wordViewModel.insert(WordEntity(newWord.getText().toString()))\n                }\n            }\n        }\n        findViewById&lt;Button&gt;(R.id.deleteWords).setOnClickListener{\n            fun onClick(v:View?){\n                wordViewModel.deleteAllWords()\n            }\n        }\n\n\n        wordViewModel.getAllWords().observe(this,Observer&lt;List&lt;WordEntity&gt;&gt;(){\n            fun onChanged(words:List&lt;WordEntity&gt;){\n            adapter.setWords(words)\n        }\n        })\n\n    }\n\n}\n</code></pre>\n\n<p>Could someone please help me identify what I am doing wrong? I am trying to pick-up Architecture Components after a long time away from Android. I am not entirely clear how to proceed.</p>\n"},{"tags":["java","spring-boot","resttemplate"],"answers":[{"tags":[],"owner":{"account_id":153343,"reputation":1086,"user_id":368532,"accept_rate":70,"display_name":"Boris"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694365678,"creation_date":1694365678,"answer_id":77077153,"question_id":77068917,"body_markdown":"Configure the following property ([source][1])\r\n\r\n    server.tomcat.max-http-form-post-size\r\n\r\n\r\n\r\n\r\n  [1]: https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html#application-properties.server.server.tomcat.max-http-form-post-size","title":"How to set up max post size for Tomcat in Spring boot","body":"<p>Configure the following property (<a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html#application-properties.server.server.tomcat.max-http-form-post-size\" rel=\"nofollow noreferrer\">source</a>)</p>\n<pre><code>server.tomcat.max-http-form-post-size\n</code></pre>\n"}],"owner":{"account_id":19170500,"reputation":165,"user_id":14004337,"display_name":"Raman"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":51,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694365678,"creation_date":1694194713,"question_id":77068917,"body_markdown":"I have a client server application using Spring Shell on the client side and Spring boot(2.5.7) on the server side. We use Tomcat server and use TomcatServletWebServerFactory to create it. I want to provide a specific value for max post size to the server programmatically. I read some articles and can see that Connector class can be used to customize the server. However I am not finding a suitable code. Can someone please guide?","title":"How to set up max post size for Tomcat in Spring boot","body":"<p>I have a client server application using Spring Shell on the client side and Spring boot(2.5.7) on the server side. We use Tomcat server and use TomcatServletWebServerFactory to create it. I want to provide a specific value for max post size to the server programmatically. I read some articles and can see that Connector class can be used to customize the server. However I am not finding a suitable code. Can someone please guide?</p>\n"},{"tags":["java","executable-jar","owl-api"],"comments":[{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1694122770,"post_id":77062343,"comment_id":135853723,"body_markdown":"Looks like the fat jar classloading is having difficulties. My guess would be that you omitted some necessary item(s) when creating it","body":"Looks like the fat jar classloading is having difficulties. My guess would be that you omitted some necessary item(s) when creating it"},{"owner":{"account_id":529247,"reputation":10544,"user_id":1197045,"display_name":"Ignazio"},"score":0,"creation_date":1694189181,"post_id":77062343,"comment_id":135863225,"body_markdown":"Please share how you&#39;re combining the jars. The error is related to missing resources that are part of the OWLAPI jar files (not their dependencies). Similarly, there are resource files with the same names but different content in different OWLAPI jars, so merging them requires the tool to be aware.","body":"Please share how you&#39;re combining the jars. The error is related to missing resources that are part of the OWLAPI jar files (not their dependencies). Similarly, there are resource files with the same names but different content in different OWLAPI jars, so merging them requires the tool to be aware."},{"owner":{"account_id":27849015,"reputation":1,"user_id":21263885,"display_name":"Basma Moukhtar Hussein"},"score":0,"creation_date":1694526923,"post_id":77062343,"comment_id":135900609,"body_markdown":"I extract the project from eclipse as a runnable jar file and choose to &quot;package the required libraries into jar&quot; option","body":"I extract the project from eclipse as a runnable jar file and choose to &quot;package the required libraries into jar&quot; option"},{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1694527221,"post_id":77062343,"comment_id":135900701,"body_markdown":"If this isn&#39;t working, I&#39;d be inclined to make it into a Maven project (assuming it isn&#39;t already - please say if I&#39;m wrong) and then you have various options to make at *somewhat* less proprietary way of making fat jars","body":"If this isn&#39;t working, I&#39;d be inclined to make it into a Maven project (assuming it isn&#39;t already - please say if I&#39;m wrong) and then you have various options to make at <i>somewhat</i> less proprietary way of making fat jars"},{"owner":{"account_id":27849015,"reputation":1,"user_id":21263885,"display_name":"Basma Moukhtar Hussein"},"score":0,"creation_date":1694617338,"post_id":77062343,"comment_id":135915467,"body_markdown":"It&#39;s not a maven project actually. I will give it a try.  Thanks a lot.","body":"It&#39;s not a maven project actually. I will give it a try.  Thanks a lot."},{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1694617509,"post_id":77062343,"comment_id":135915510,"body_markdown":"OK. I use Maven Shade personally","body":"OK. I use Maven Shade personally"}],"owner":{"account_id":27849015,"reputation":1,"user_id":21263885,"display_name":"Basma Moukhtar Hussein"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":34,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694365379,"creation_date":1694114854,"question_id":77062343,"body_markdown":"I am developing a java application that uses the owl api (v 5.1.19). Everything works fine when I run the app from eclipse.\r\n\r\n\r\nI need to extract the app as an executable jar file. But when I do so and run the jar file, the owl api throws the following exception.\r\nNote that all the dependencies needed by the owl api are extracted in the jar file.\r\n\r\n```\r\nException in thread &quot;main&quot; java.lang.reflect.InvocationTargetException\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\r\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\r\n        at java.base/java.lang.reflect.Method.invoke(Unknown Source)\r\n        at org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader.main(JarRsrcLoader.java:61)\r\n    Caused by: java.lang.NullPointerException\r\n        at java.base/java.util.Objects.requireNonNull(Unknown Source)\r\n        at java.base/java.util.Optional.&lt;init&gt;(Unknown Source)\r\n        at java.base/java.util.Optional.of(Unknown Source)\r\n        at java.base/java.util.stream.FindOps$FindSink$OfRef.get(Unknown Source)\r\n        at java.base/java.util.stream.FindOps$FindSink$OfRef.get(Unknown Source)\r\n        at java.base/java.util.stream.FindOps$FindOp.evaluateSequential(Unknown Source)\r\n        at java.base/java.util.stream.AbstractPipeline.evaluate(Unknown Source)\r\n        at java.base/java.util.stream.ReferencePipeline.findAny(Unknown Source)\r\n       at org.semanticweb.owlapi.utilities.Injector.getImplementation(Injector.java:246)\r\n        at org.semanticweb.owlapi.apibinding.OWLManager.createOWLOntologyManager(OWLManager.java:119)\r\n        at utils.OntologyUtils.loadOntology(OntologyUtils.java:251)\r\n        at persistence.OntologyDAO.loadWholeOntology(OntologyDAO.java:31)\r\n        at application.OntologyHandler.&lt;init&gt;(OntologyHandler.java:21)\r\n        at application.RecommendationAlgorithm.&lt;init&gt;(RecommendationAlgorithm.java:42)\r\n        at ui.MainPage.&lt;init&gt;(MainPage.java:37)\r\n        at ui.TestUI.main(TestUI.java:9)\r\n```","title":"include owl api jar files into an executable jar file","body":"<p>I am developing a java application that uses the owl api (v 5.1.19). Everything works fine when I run the app from eclipse.</p>\n<p>I need to extract the app as an executable jar file. But when I do so and run the jar file, the owl api throws the following exception.\nNote that all the dependencies needed by the owl api are extracted in the jar file.</p>\n<pre><code>Exception in thread &quot;main&quot; java.lang.reflect.InvocationTargetException\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n        at java.base/java.lang.reflect.Method.invoke(Unknown Source)\n        at org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader.main(JarRsrcLoader.java:61)\n    Caused by: java.lang.NullPointerException\n        at java.base/java.util.Objects.requireNonNull(Unknown Source)\n        at java.base/java.util.Optional.&lt;init&gt;(Unknown Source)\n        at java.base/java.util.Optional.of(Unknown Source)\n        at java.base/java.util.stream.FindOps$FindSink$OfRef.get(Unknown Source)\n        at java.base/java.util.stream.FindOps$FindSink$OfRef.get(Unknown Source)\n        at java.base/java.util.stream.FindOps$FindOp.evaluateSequential(Unknown Source)\n        at java.base/java.util.stream.AbstractPipeline.evaluate(Unknown Source)\n        at java.base/java.util.stream.ReferencePipeline.findAny(Unknown Source)\n       at org.semanticweb.owlapi.utilities.Injector.getImplementation(Injector.java:246)\n        at org.semanticweb.owlapi.apibinding.OWLManager.createOWLOntologyManager(OWLManager.java:119)\n        at utils.OntologyUtils.loadOntology(OntologyUtils.java:251)\n        at persistence.OntologyDAO.loadWholeOntology(OntologyDAO.java:31)\n        at application.OntologyHandler.&lt;init&gt;(OntologyHandler.java:21)\n        at application.RecommendationAlgorithm.&lt;init&gt;(RecommendationAlgorithm.java:42)\n        at ui.MainPage.&lt;init&gt;(MainPage.java:37)\n        at ui.TestUI.main(TestUI.java:9)\n</code></pre>\n"},{"tags":["java","spring-boot","jpa","spring-data-jpa"],"answers":[{"tags":[],"owner":{"account_id":153343,"reputation":1086,"user_id":368532,"accept_rate":70,"display_name":"Boris"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694364990,"creation_date":1694364990,"answer_id":77077110,"question_id":77076292,"body_markdown":"You can&#39;t use subqueries in select clause of jpql expression (see [this][1]), this explains the error.\r\n\r\nYou have to declare one to many relation anyway if you wish to achieve this result, but you can mark it as lazy, so it will not be fetched unless explicitly requested.\r\n\r\n  [1]: https://openjpa.apache.org/builds/2.4.2/apache-openjpa/docs/jpa_langref.html#jpa_langref_select_clause","title":"Is it possible to get all child entites without using @OneToMany annotation in one query?","body":"<p>You can't use subqueries in select clause of jpql expression (see <a href=\"https://openjpa.apache.org/builds/2.4.2/apache-openjpa/docs/jpa_langref.html#jpa_langref_select_clause\" rel=\"nofollow noreferrer\">this</a>), this explains the error.</p>\n<p>You have to declare one to many relation anyway if you wish to achieve this result, but you can mark it as lazy, so it will not be fetched unless explicitly requested.</p>\n"}],"owner":{"account_id":12206881,"reputation":840,"user_id":8909722,"display_name":"monstereo"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":30,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694364990,"creation_date":1694352237,"question_id":77076292,"body_markdown":"Let&#39;s assume that I have following entities:\r\n\r\n- **UserEntities**:\r\n\r\n```java\r\n@Embeddable\r\n@Data\r\npublic class ContactInformation implements Serializable {\r\n\r\n    @Column()\r\n    private String name;\r\n\r\n    @Column()\r\n    private String surname;\r\n\r\n}\r\n\r\npublic class UserEntity {\r\n    @Embedded\r\n    private ContactInformation contactInformation;\r\n\r\n    @Column()\r\n    @NotEmpty\r\n    private String email;\r\n\r\n    @Column()\r\n    @NotEmpty\r\n    private String password;\r\n}\r\n```\r\n\r\n- And **UserHobbyEntity**:\r\n\r\n```java\r\npublic class UserHobbyEntity extends BaseEntity {\r\n\r\n    @Column(name = )\r\n    @NotEmpty\r\n    private String hobbyName;\r\n\r\n    @ManyToOne(fetch = FetchType.LAZY)\r\n    @JoinColumn(name = &quot;user_id&quot;, referencedColumnName = &quot;id&quot;)\r\n    @OnDelete(action = OnDeleteAction.CASCADE)\r\n    private UserEntity userEntity;\r\n}\r\n```\r\n\r\nNow I want to get all users (using paginate) with his/her hobbies without using `@OneToMany` and map to new class called `SearchUserModel`:\r\n\r\n```java\r\npublic class SearchUserModel {\r\n    private String userId;\r\n    private String name;\r\n    private String surname;\r\n    private List&lt;String&gt; hobbies;\r\n    public SearchUserModel(String userId,\r\n                           String name, String surname,\r\n                           List&lt;String&gt; hobbies) {\r\n        this.userId = userId;\r\n        this.name = name;\r\n        this.surname = surname;\r\n        this.hobbies = hobbies;\r\n    }\r\n}\r\n```\r\n\r\nWhen I call the following repository method, spring boot says that **&quot; Could not determine appropriate instantiation strategy - no matching constructor found and one or more arguments did not define alias for bean-injection&quot;**:\r\n\r\n```java\r\n@Repository\r\npublic interface UserRepository extends JpaRepository&lt;UserEntity, String&gt; {\r\n    @Query(&quot;&quot;&quot;\r\n            SELECT new com.package.to.SearchUserModel(\r\n              user.id,\r\n              user.contactInformation.name,\r\n              user.contactInformation.surname,\r\n              (SELECT uh.hobbyName FROM UserHobbyEntity uh WHERE uh.userEntity.id = user.id)\r\n            )\r\n            FROM UserEntity user\r\n            WHERE user.id != :userId\r\n            &quot;&quot;&quot;)\r\n    Page&lt;SearchUserModel&gt; getUsersForUser(String userId, Pageable pageable);\r\n}\r\n```\r\n\r\nWhen i changed `List&lt;String&gt; hobbies` to `String hobby`, it works but I want to get all hobbies:\r\n\r\n```java\r\npublic class SearchUserModel {\r\n    private String userId;\r\n    private String name;\r\n    private String surname;\r\n    \r\n    // this is working but i want to get all hobbies for each user\r\n    public SearchUserModel(String userId,\r\n                           String name, String surname,\r\n                           String hobby) {\r\n        this.userId = userId;\r\n        this.name = name;\r\n        this.surname = surname;\r\n        \r\n    }\r\n}\r\n```","title":"Is it possible to get all child entites without using @OneToMany annotation in one query?","body":"<p>Let's assume that I have following entities:</p>\n<ul>\n<li><strong>UserEntities</strong>:</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>@Embeddable\n@Data\npublic class ContactInformation implements Serializable {\n\n    @Column()\n    private String name;\n\n    @Column()\n    private String surname;\n\n}\n\npublic class UserEntity {\n    @Embedded\n    private ContactInformation contactInformation;\n\n    @Column()\n    @NotEmpty\n    private String email;\n\n    @Column()\n    @NotEmpty\n    private String password;\n}\n</code></pre>\n<ul>\n<li>And <strong>UserHobbyEntity</strong>:</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>public class UserHobbyEntity extends BaseEntity {\n\n    @Column(name = )\n    @NotEmpty\n    private String hobbyName;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = &quot;user_id&quot;, referencedColumnName = &quot;id&quot;)\n    @OnDelete(action = OnDeleteAction.CASCADE)\n    private UserEntity userEntity;\n}\n</code></pre>\n<p>Now I want to get all users (using paginate) with his/her hobbies without using <code>@OneToMany</code> and map to new class called <code>SearchUserModel</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class SearchUserModel {\n    private String userId;\n    private String name;\n    private String surname;\n    private List&lt;String&gt; hobbies;\n    public SearchUserModel(String userId,\n                           String name, String surname,\n                           List&lt;String&gt; hobbies) {\n        this.userId = userId;\n        this.name = name;\n        this.surname = surname;\n        this.hobbies = hobbies;\n    }\n}\n</code></pre>\n<p>When I call the following repository method, spring boot says that <strong>&quot; Could not determine appropriate instantiation strategy - no matching constructor found and one or more arguments did not define alias for bean-injection&quot;</strong>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Repository\npublic interface UserRepository extends JpaRepository&lt;UserEntity, String&gt; {\n    @Query(&quot;&quot;&quot;\n            SELECT new com.package.to.SearchUserModel(\n              user.id,\n              user.contactInformation.name,\n              user.contactInformation.surname,\n              (SELECT uh.hobbyName FROM UserHobbyEntity uh WHERE uh.userEntity.id = user.id)\n            )\n            FROM UserEntity user\n            WHERE user.id != :userId\n            &quot;&quot;&quot;)\n    Page&lt;SearchUserModel&gt; getUsersForUser(String userId, Pageable pageable);\n}\n</code></pre>\n<p>When i changed <code>List&lt;String&gt; hobbies</code> to <code>String hobby</code>, it works but I want to get all hobbies:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class SearchUserModel {\n    private String userId;\n    private String name;\n    private String surname;\n    \n    // this is working but i want to get all hobbies for each user\n    public SearchUserModel(String userId,\n                           String name, String surname,\n                           String hobby) {\n        this.userId = userId;\n        this.name = name;\n        this.surname = surname;\n        \n    }\n}\n</code></pre>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":32380,"reputation":134957,"user_id":89806,"accept_rate":58,"display_name":"moinudin"},"score":1,"creation_date":1294190682,"post_id":4600034,"comment_id":5054433,"body_markdown":"http://joda-time.sourceforge.net/","body":"<a href=\"http://joda-time.sourceforge.net/\" rel=\"nofollow noreferrer\">joda-time.sourceforge.net</a>"},{"owner":{"account_id":238684,"reputation":22543,"user_id":507738,"accept_rate":71,"display_name":"MC Emperor"},"score":3,"creation_date":1605092086,"post_id":4600034,"comment_id":114544355,"body_markdown":"**To future readers**: this question was asked in 2011, before Java 8 existed, which ships with an implementation of [JSR 310](https://jcp.org/aboutJava/communityprocess/pfd/jsr310/JSR-310-guide.html). Many answers here use the `Calendar` class – but this class is obsolete. Use classes from the [`java.time`](https://docs.oracle.com/en/java/javase/14/docs/api/java.base/java/time/package-summary.html) package instead.  [This answer is an elegant solution](https://stackoverflow.com/a/51010738/507738) using `java.time`.","body":"<b>To future readers</b>: this question was asked in 2011, before Java 8 existed, which ships with an implementation of <a href=\"https://jcp.org/aboutJava/communityprocess/pfd/jsr310/JSR-310-guide.html\" rel=\"nofollow noreferrer\">JSR 310</a>. Many answers here use the <code>Calendar</code> class – but this class is obsolete. Use classes from the <a href=\"https://docs.oracle.com/en/java/javase/14/docs/api/java.base/java/time/package-summary.html\" rel=\"nofollow noreferrer\"><code>java.time</code></a> package instead.  <a href=\"https://stackoverflow.com/a/51010738/507738\">This answer is an elegant solution</a> using <code>java.time</code>."}],"answers":[{"comments":[{"owner":{"account_id":1309,"reputation":2352,"user_id":1741,"display_name":"Joseph Gordon"},"score":0,"creation_date":1294267434,"post_id":4600057,"comment_id":5067342,"body_markdown":"Got some strange answers if startDate is on or after endDate. If startDate is 1970-01-01 21:27:00 and endDate is 1970-01-01 18:00:00, the function returns 1 instead of 0 days between the same date. Also if startDate is 2011-01-05 21:27:00 and endDate is 2011-01-04 00:00:00 the function returns 2 instead of -1 or 1 (if absolute values are expected).","body":"Got some strange answers if startDate is on or after endDate. If startDate is 1970-01-01 21:27:00 and endDate is 1970-01-01 18:00:00, the function returns 1 instead of 0 days between the same date. Also if startDate is 2011-01-05 21:27:00 and endDate is 2011-01-04 00:00:00 the function returns 2 instead of -1 or 1 (if absolute values are expected)."},{"owner":{"account_id":65096,"reputation":15647,"user_id":191797,"accept_rate":100,"display_name":"Piyush Mattoo"},"score":1,"creation_date":1294288009,"post_id":4600057,"comment_id":5069596,"body_markdown":"The above code snippet is meant for calculating working days between two dates without time.","body":"The above code snippet is meant for calculating working days between two dates without time."},{"owner":{"account_id":261678,"reputation":2513,"user_id":546016,"accept_rate":69,"display_name":"ymajoros"},"score":7,"creation_date":1329293851,"post_id":4600057,"comment_id":11714938,"body_markdown":"It works, but execution time depends on the number of days :-/","body":"It works, but execution time depends on the number of days :-/"},{"owner":{"account_id":907322,"reputation":3132,"user_id":941930,"accept_rate":67,"display_name":"Harish"},"score":2,"creation_date":1448606964,"post_id":4600057,"comment_id":55661536,"body_markdown":"To include startdate place the startCal.add(Calendar.DAY_OF_MONTH,1) after the if  condition.","body":"To include startdate place the startCal.add(Calendar.DAY_OF_MONTH,1) after the if  condition."},{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":0,"creation_date":1529959167,"post_id":4600057,"comment_id":89055300,"body_markdown":"FYI, the troublesome old date-time classes such as [`java.util.Date`](https://docs.oracle.com/javase/10/docs/api/java/util/Date.html), [`java.util.Calendar`](https://docs.oracle.com/javase/10/docs/api/java/util/Calendar.html), and `java.text.SimpleDateFormat` are now [legacy](https://en.wikipedia.org/wiki/Legacy_system), supplanted by the [*java.time*](https://docs.oracle.com/javase/10/docs/api/java/time/package-summary.html) classes built into Java 8 and later. See [*Tutorial* by Oracle](https://docs.oracle.com/javase/tutorial/datetime/TOC.html).","body":"FYI, the troublesome old date-time classes such as <a href=\"https://docs.oracle.com/javase/10/docs/api/java/util/Date.html\" rel=\"nofollow noreferrer\"><code>java.util.Date</code></a>, <a href=\"https://docs.oracle.com/javase/10/docs/api/java/util/Calendar.html\" rel=\"nofollow noreferrer\"><code>java.util.Calendar</code></a>, and <code>java.text.SimpleDateFormat</code> are now <a href=\"https://en.wikipedia.org/wiki/Legacy_system\" rel=\"nofollow noreferrer\">legacy</a>, supplanted by the <a href=\"https://docs.oracle.com/javase/10/docs/api/java/time/package-summary.html\" rel=\"nofollow noreferrer\"><i>java.time</i></a> classes built into Java 8 and later. See <a href=\"https://docs.oracle.com/javase/tutorial/datetime/TOC.html\" rel=\"nofollow noreferrer\"><i>Tutorial</i> by Oracle</a>."}],"tags":[],"owner":{"account_id":65096,"reputation":15647,"user_id":191797,"accept_rate":100,"display_name":"Piyush Mattoo"},"comment_count":5,"down_vote_count":5,"up_vote_count":58,"is_accepted":true,"score":53,"last_activity_date":1391842914,"creation_date":1294190420,"answer_id":4600057,"question_id":4600034,"body_markdown":"    public static int getWorkingDaysBetweenTwoDates(Date startDate, Date endDate) {\r\n        Calendar startCal = Calendar.getInstance();\r\n\t\tstartCal.setTime(startDate);\t\t\r\n\t\t\r\n\t\tCalendar endCal = Calendar.getInstance();\r\n\t\tendCal.setTime(endDate);\r\n\r\n        int workDays = 0;\r\n\r\n        //Return 0 if start and end are the same\r\n        if (startCal.getTimeInMillis() == endCal.getTimeInMillis()) {\r\n            return 0;\r\n        }\r\n        \r\n        if (startCal.getTimeInMillis() &gt; endCal.getTimeInMillis()) {\r\n            startCal.setTime(endDate);\r\n            endCal.setTime(startDate);\r\n        }\r\n\r\n        do {\r\n           //excluding start date\r\n            startCal.add(Calendar.DAY_OF_MONTH, 1);\r\n            if (startCal.get(Calendar.DAY_OF_WEEK) != Calendar.SATURDAY &amp;&amp; startCal.get(Calendar.DAY_OF_WEEK) != Calendar.SUNDAY) {\r\n                ++workDays;\r\n            }\r\n        } while (startCal.getTimeInMillis() &lt; endCal.getTimeInMillis()); //excluding end date\r\n\r\n        return workDays;\r\n    }\r\n\r\n&gt; Start date and end date are exclusive, Only the days between given\r\n&gt; dates will be counted. Start date and end date will not be included.","title":"Calculate number of weekdays between two dates in Java","body":"<pre><code>public static int getWorkingDaysBetweenTwoDates(Date startDate, Date endDate) {\n    Calendar startCal = Calendar.getInstance();\n    startCal.setTime(startDate);        \n\n    Calendar endCal = Calendar.getInstance();\n    endCal.setTime(endDate);\n\n    int workDays = 0;\n\n    //Return 0 if start and end are the same\n    if (startCal.getTimeInMillis() == endCal.getTimeInMillis()) {\n        return 0;\n    }\n\n    if (startCal.getTimeInMillis() &gt; endCal.getTimeInMillis()) {\n        startCal.setTime(endDate);\n        endCal.setTime(startDate);\n    }\n\n    do {\n       //excluding start date\n        startCal.add(Calendar.DAY_OF_MONTH, 1);\n        if (startCal.get(Calendar.DAY_OF_WEEK) != Calendar.SATURDAY &amp;&amp; startCal.get(Calendar.DAY_OF_WEEK) != Calendar.SUNDAY) {\n            ++workDays;\n        }\n    } while (startCal.getTimeInMillis() &lt; endCal.getTimeInMillis()); //excluding end date\n\n    return workDays;\n}\n</code></pre>\n\n<blockquote>\n  <p>Start date and end date are exclusive, Only the days between given\n  dates will be counted. Start date and end date will not be included.</p>\n</blockquote>\n"},{"comments":[{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":1,"creation_date":1529959583,"post_id":4600059,"comment_id":89055479,"body_markdown":"Generally expected that you post in the same language as the Question, or something close such as Groovy &lt;-&gt; Java.","body":"Generally expected that you post in the same language as the Question, or something close such as Groovy &lt;-&gt; Java."}],"tags":[],"owner":{"account_id":111785,"reputation":3170,"user_id":295103,"accept_rate":100,"display_name":"Andre"},"comment_count":1,"down_vote_count":4,"up_vote_count":7,"is_accepted":false,"score":3,"last_activity_date":1294190453,"creation_date":1294190453,"answer_id":4600059,"question_id":4600034,"body_markdown":"I don&#39;t have a Java based solution, but have a PHP one, hope it helps:\r\n\r\n    function getDate($days) {\t\r\n        for ($i = 0; $i &lt; $days; $i ++) {                                      \r\n\t\t    if (date(&#39;N&#39; , strtotime(&#39;+&#39; . ($i + 1) . &#39; days&#39;)) &gt; 5) {  \r\n\t\t\t    $days++;                                                        \r\n\t\t    }                                                                   \r\n\t    }                                                                       \r\n\t                                                                            \r\n\t    return date(&#39;l, F jS&#39;, strtotime(&#39;+&#39; . $days . &#39; days&#39;, time()));\r\n    }","title":"Calculate number of weekdays between two dates in Java","body":"<p>I don't have a Java based solution, but have a PHP one, hope it helps:</p>\n\n<pre><code>function getDate($days) {   \n    for ($i = 0; $i &lt; $days; $i ++) {                                      \n        if (date('N' , strtotime('+' . ($i + 1) . ' days')) &gt; 5) {  \n            $days++;                                                        \n        }                                                                   \n    }                                                                       \n\n    return date('l, F jS', strtotime('+' . $days . ' days', time()));\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":1309,"reputation":2352,"user_id":1741,"display_name":"Joseph Gordon"},"score":0,"creation_date":1294205481,"post_id":4600534,"comment_id":5055773,"body_markdown":"Really impressed with your solution. I was trying to accomplish the same thing but wound up with switches to catch the beginning and end dates on the weekend instead of doing the date shifting. This is much more elegant.","body":"Really impressed with your solution. I was trying to accomplish the same thing but wound up with switches to catch the beginning and end dates on the weekend instead of doing the date shifting. This is much more elegant."},{"owner":{"account_id":1051195,"reputation":2783,"user_id":1055089,"accept_rate":64,"display_name":"Vrushank"},"score":0,"creation_date":1338098759,"post_id":4600534,"comment_id":14006065,"body_markdown":"@Shengyuan : I know it&#39;s a bit late now, but could you please explain the last 2 lines:\n`long days = (c2.getTimeInMillis()-c1.getTimeInMillis())/(1000*60*60*24);`\n    `long daysWithoutSunday = days-(days*2/7);`","body":"@Shengyuan : I know it&#39;s a bit late now, but could you please explain the last 2 lines: <code>long days = (c2.getTimeInMillis()-c1.getTimeInMillis())&#47;(1000*60*60*24);</code>     <code>long daysWithoutSunday = days-(days*2&#47;7);</code>"},{"owner":{"account_id":1542378,"reputation":1951,"user_id":1436703,"accept_rate":60,"display_name":"iceberg"},"score":0,"creation_date":1444398972,"post_id":4600534,"comment_id":53900990,"body_markdown":"First line is total date count between start date and end date.\nSecond line is total date count minus weekend count.","body":"First line is total date count between start date and end date. Second line is total date count minus weekend count."},{"owner":{"account_id":222360,"reputation":7615,"user_id":480894,"accept_rate":72,"display_name":"Roland"},"score":0,"creation_date":1520090329,"post_id":4600534,"comment_id":85176701,"body_markdown":"Inconsistent results:\nBetween 2018-03-09 and 2018-03-10 (Friday and Saturday) yields 0 days.\nBetween 2018-03-09 and 2018-03-11 (Friday and Sunday) yields 1 days.","body":"Inconsistent results: Between 2018-03-09 and 2018-03-10 (Friday and Saturday) yields 0 days. Between 2018-03-09 and 2018-03-11 (Friday and Sunday) yields 1 days."},{"owner":{"account_id":15041640,"reputation":145,"user_id":10856025,"display_name":"justarandomguy"},"score":0,"creation_date":1591338199,"post_id":4600534,"comment_id":110022640,"body_markdown":"What if i want to count weekend instead of weekdays?","body":"What if i want to count weekend instead of weekdays?"}],"tags":[],"owner":{"account_id":109733,"reputation":31428,"user_id":290629,"accept_rate":88,"display_name":"卢声远 Shengyuan Lu"},"comment_count":5,"down_vote_count":1,"up_vote_count":50,"is_accepted":false,"score":49,"last_activity_date":1442412137,"creation_date":1294197447,"answer_id":4600534,"question_id":4600034,"body_markdown":"Solution **without loop**:\r\n\r\n\tstatic long days(Date start, Date end){\r\n\t\t//Ignore argument check\r\n\t\t\r\n\t\tCalendar c1 = Calendar.getInstance();\r\n\t\tc1.setTime(start);\r\n\t\tint w1 = c1.get(Calendar.DAY_OF_WEEK);\r\n\t\tc1.add(Calendar.DAY_OF_WEEK, -w1);\r\n\t  \r\n\t\tCalendar c2 = Calendar.getInstance();\r\n\t\tc2.setTime(end);\r\n\t\tint w2 = c2.get(Calendar.DAY_OF_WEEK);\r\n\t\tc2.add(Calendar.DAY_OF_WEEK, -w2);\r\n   \r\n\t\t//end Saturday to start Saturday \r\n\t\tlong days = (c2.getTimeInMillis()-c1.getTimeInMillis())/(1000*60*60*24);\r\n\t\tlong daysWithoutWeekendDays = days-(days*2/7);\r\n\r\n        // Adjust days to add on (w2) and days to subtract (w1) so that Saturday\r\n        // and Sunday are not included\r\n        if (w1 == Calendar.SUNDAY &amp;&amp; w2 != Calendar.SATURDAY) {\r\n            w1 = Calendar.MONDAY;\r\n        } else if (w1 == Calendar.SATURDAY &amp;&amp; w2 != Calendar.SUNDAY) {\r\n            w1 = Calendar.FRIDAY;\r\n        } \r\n        \r\n        if (w2 == Calendar.SUNDAY) {\r\n            w2 = Calendar.MONDAY;\r\n        } else if (w2 == Calendar.SATURDAY) {\r\n            w2 = Calendar.FRIDAY;\r\n        }\r\n\t\t\r\n\t\treturn daysWithoutWeekendDays-w1+w2;\r\n\t}","title":"Calculate number of weekdays between two dates in Java","body":"<p>Solution <strong>without loop</strong>:</p>\n\n<pre><code>static long days(Date start, Date end){\n    //Ignore argument check\n\n    Calendar c1 = Calendar.getInstance();\n    c1.setTime(start);\n    int w1 = c1.get(Calendar.DAY_OF_WEEK);\n    c1.add(Calendar.DAY_OF_WEEK, -w1);\n\n    Calendar c2 = Calendar.getInstance();\n    c2.setTime(end);\n    int w2 = c2.get(Calendar.DAY_OF_WEEK);\n    c2.add(Calendar.DAY_OF_WEEK, -w2);\n\n    //end Saturday to start Saturday \n    long days = (c2.getTimeInMillis()-c1.getTimeInMillis())/(1000*60*60*24);\n    long daysWithoutWeekendDays = days-(days*2/7);\n\n    // Adjust days to add on (w2) and days to subtract (w1) so that Saturday\n    // and Sunday are not included\n    if (w1 == Calendar.SUNDAY &amp;&amp; w2 != Calendar.SATURDAY) {\n        w1 = Calendar.MONDAY;\n    } else if (w1 == Calendar.SATURDAY &amp;&amp; w2 != Calendar.SUNDAY) {\n        w1 = Calendar.FRIDAY;\n    } \n\n    if (w2 == Calendar.SUNDAY) {\n        w2 = Calendar.MONDAY;\n    } else if (w2 == Calendar.SATURDAY) {\n        w2 = Calendar.FRIDAY;\n    }\n\n    return daysWithoutWeekendDays-w1+w2;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":409306,"reputation":347,"user_id":780490,"display_name":"Levi"},"comment_count":0,"down_vote_count":2,"up_vote_count":13,"is_accepted":false,"score":11,"last_activity_date":1320362033,"creation_date":1320362033,"answer_id":8003104,"question_id":4600034,"body_markdown":"I used Shengyuan Lu&#39;s solution, but I needed to make a fix for the case where the method is called when one of the dates is on a Saturday and the other a Sunday - otherwise the answer is off by a day:\r\n\r\n    static long days(Date start, Date end){\r\n        //Ignore argument check\r\n    \r\n        Calendar c1 = GregorianCalendar.getInstance();\r\n        c1.setTime(start);\r\n        int w1 = c1.get(Calendar.DAY_OF_WEEK);\r\n        c1.add(Calendar.DAY_OF_WEEK, -w1 + 1);\r\n    \r\n        Calendar c2 = GregorianCalendar.getInstance();\r\n        c2.setTime(end);\r\n        int w2 = c2.get(Calendar.DAY_OF_WEEK);\r\n        c2.add(Calendar.DAY_OF_WEEK, -w2 + 1);\r\n    \r\n        //end Saturday to start Saturday \r\n        long days = (c2.getTimeInMillis()-c1.getTimeInMillis())/(1000*60*60*24);\r\n        long daysWithoutSunday = days-(days*2/7);\r\n    \r\n        if (w1 == Calendar.SUNDAY) {\r\n            w1 = Calendar.MONDAY;\r\n        }\r\n        if (w2 == Calendar.SUNDAY) {\r\n            w2 = Calendar.MONDAY;\r\n        }\r\n        return daysWithoutSunday-w1+w2;\r\n    }\r\n\r\n","title":"Calculate number of weekdays between two dates in Java","body":"<p>I used Shengyuan Lu's solution, but I needed to make a fix for the case where the method is called when one of the dates is on a Saturday and the other a Sunday - otherwise the answer is off by a day:</p>\n\n<pre><code>static long days(Date start, Date end){\n    //Ignore argument check\n\n    Calendar c1 = GregorianCalendar.getInstance();\n    c1.setTime(start);\n    int w1 = c1.get(Calendar.DAY_OF_WEEK);\n    c1.add(Calendar.DAY_OF_WEEK, -w1 + 1);\n\n    Calendar c2 = GregorianCalendar.getInstance();\n    c2.setTime(end);\n    int w2 = c2.get(Calendar.DAY_OF_WEEK);\n    c2.add(Calendar.DAY_OF_WEEK, -w2 + 1);\n\n    //end Saturday to start Saturday \n    long days = (c2.getTimeInMillis()-c1.getTimeInMillis())/(1000*60*60*24);\n    long daysWithoutSunday = days-(days*2/7);\n\n    if (w1 == Calendar.SUNDAY) {\n        w1 = Calendar.MONDAY;\n    }\n    if (w2 == Calendar.SUNDAY) {\n        w2 = Calendar.MONDAY;\n    }\n    return daysWithoutSunday-w1+w2;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2550410,"reputation":101,"user_id":2214277,"display_name":"Ivi"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1364370891,"creation_date":1364360175,"answer_id":15652184,"question_id":4600034,"body_markdown":"The `do` `while` in the solution of Piyush is wrong, it should be : \r\n\r\n    do {\r\n        if (startCal.get(Calendar.DAY_OF_WEEK) != Calendar.SATURDAY &amp;&amp; startCal.get(Calendar.DAY_OF_WEEK) != Calendar.SUNDAY) {\r\n            ++workDays;\r\n        }\r\n        startCal.add(Calendar.DAY_OF_MONTH, 1);\r\n    } while (startCal.getTimeInMillis() &lt; endCal.getTimeInMillis());\r\n\r\n","title":"Calculate number of weekdays between two dates in Java","body":"<p>The <code>do</code> <code>while</code> in the solution of Piyush is wrong, it should be : </p>\n\n<pre><code>do {\n    if (startCal.get(Calendar.DAY_OF_WEEK) != Calendar.SATURDAY &amp;&amp; startCal.get(Calendar.DAY_OF_WEEK) != Calendar.SUNDAY) {\n        ++workDays;\n    }\n    startCal.add(Calendar.DAY_OF_MONTH, 1);\n} while (startCal.getTimeInMillis() &lt; endCal.getTimeInMillis());\n</code></pre>\n"},{"comments":[{"owner":{"account_id":1003184,"reputation":852,"user_id":1017571,"accept_rate":75,"display_name":"mbosecke"},"score":0,"creation_date":1428000065,"post_id":18481090,"comment_id":47012021,"body_markdown":"I don&#39;t think that&#39;s true, Calendar.DATE is a synonym for Calendar.DAY_OF_MONTH","body":"I don&#39;t think that&#39;s true, Calendar.DATE is a synonym for Calendar.DAY_OF_MONTH"}],"tags":[],"owner":{"account_id":1352505,"reputation":2704,"user_id":1291714,"display_name":"riggaroo"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1377672450,"creation_date":1377672450,"answer_id":18481090,"question_id":4600034,"body_markdown":"The `startCal.add` should add onto the `Calendar.DATE` field, not the `Calendar.DAY_OF_MONTH`, I was getting weird results with over Decemeber / January period.","title":"Calculate number of weekdays between two dates in Java","body":"<p>The <code>startCal.add</code> should add onto the <code>Calendar.DATE</code> field, not the <code>Calendar.DAY_OF_MONTH</code>, I was getting weird results with over Decemeber / January period.</p>\n"},{"comments":[{"owner":{"account_id":1966171,"reputation":5909,"user_id":1766382,"accept_rate":67,"display_name":"Daniel Langdon"},"score":0,"creation_date":1438903193,"post_id":31866985,"comment_id":51653761,"body_markdown":"This code is very error prone. You don&#39;t take leap seconds, leap years, etc into consideration. I would suggest you remove this answer, there are good libraries out there for Java (i.e. JodaTime) that get this right. Nice try though :-)","body":"This code is very error prone. You don&#39;t take leap seconds, leap years, etc into consideration. I would suggest you remove this answer, there are good libraries out there for Java (i.e. JodaTime) that get this right. Nice try though :-)"},{"owner":{"account_id":1428147,"reputation":667,"user_id":1351175,"accept_rate":100,"display_name":"betatester07"},"score":0,"creation_date":1463040938,"post_id":31866985,"comment_id":61895486,"body_markdown":"How is this not taking leap years into consideration?","body":"How is this not taking leap years into consideration?"}],"tags":[],"owner":{"account_id":6749592,"reputation":11,"user_id":5200049,"display_name":"Peter Harrison"},"comment_count":2,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1438901008,"creation_date":1438901008,"answer_id":31866985,"question_id":4600034,"body_markdown":"This is my example without looping. It is a class in this example because I serialize it in some JSON output. Basically I work out the number of days between the two dates, divide by 7 and assign to a long to have a integer value for the number of weeks. Take the original number of days and subtract the number of weekends*2. This isn&#39;t quite perfect - you need to work out if there is a &#39;hangover&#39; where the start is close to the end of the week and goes over the weekend. To correct for this I find the day of the week at the start and find the remainder of the number of days, and add those together to find the &#39;hangover&#39; - and if it is more than 5 it is a weekend. It isn&#39;t quite perfect, and does not account for holidays at all. And no Joda in sight. That said there is also a issue with timezones.\r\n\r\n\timport java.io.Serializable;\r\n\timport java.util.Date;\r\n\r\n\tpublic class BusinessDayCalculator implements Serializable {\r\n\t\r\n\t\tprivate static long DAY = 86400000l;\r\n\t\r\n\t\tprivate Date startTime;\r\n\t\tprivate Date endTime;\r\n\t\t\r\n\t\tpublic void setStartTime(Date startTime) {\r\n\t\t\tthis.startTime = startTime;\r\n\t\t}\r\n\t\r\n\t\tpublic Date getStartTime() {\r\n\t\t\treturn startTime;\r\n\t\t}\r\n\t\r\n\t\tpublic void setEndTime(Date endTime) {\r\n\t\t\tthis.endTime = endTime;\r\n\t\t}\r\n\t\r\n\t\tpublic Date getEndTime() {\r\n\t\t\treturn endTime;\r\n\t\t}\r\n\t\t\r\n\t\tpublic long getHours() {\r\n\t\t\treturn (this.endTime.getTime() - this.startTime.getTime())/(1000*60*60);\r\n\t\t}\r\n\t\r\n\t\tpublic long getBusinessDays(){\r\n\t\t\r\n\t\t\tlong startDay = getDayFromDate(this.startTime);\r\n\t\t\tlong endDay = getDayFromDate(this.endTime);\r\n\t\t\r\n\t\t\tlong totalDays = endDay-startDay;\r\n\t\t\tlong totalWeekends = totalDays/7;\r\n\t\t\r\n\t\t\tlong day = getDay(this.startTime);\r\n\t\t\r\n\t\t\tlong hangover = totalDays % 7;\r\n\t\t\r\n\t\t\tlong intoWeekend = day + hangover;\r\n\t\t\tif(intoWeekend&gt;5){\r\n\t\t\t\ttotalWeekends++;\r\n\t\t\t}\r\n\t\t\r\n\t\t\tlong totalBusinessDays = totalDays - (totalWeekends *2);\r\n\t\t\r\n\t\t\t/*\r\n\t\t\tSystem.out.println(&quot;Days = &quot; + day );\r\n\t\t\tSystem.out.println(&quot;Hangover = &quot; + hangover );\r\n\t\t\tSystem.out.println(&quot;Total Days = &quot; + totalDays);\r\n\t\t\tSystem.out.println(&quot;Total Weekends = &quot; + totalWeekends);\r\n\t\t\tSystem.out.println(&quot;Total Business Days = &quot; + totalBusinessDays);\r\n\t\t\t*/\r\n\t\t\r\n\t\t\treturn totalBusinessDays;\r\n\t\t}\r\n\t\r\n\t\tprivate long getDayFromDate( Date date ){\r\n\t\t\tlong d = date.getTime() / DAY;\r\n\t\t\treturn d;\r\n\t\t}\r\n\t\r\n\t\tprivate long getDay( Date date ){\r\n\t\t\tlong daysSinceEpoc = getDayFromDate(date);\r\n\t\t\tlong day = daysSinceEpoc % 7;\r\n\t\t\tday = day + 4;\r\n\t\t\tif(day&gt;6) day = day - 7;\r\n\t\t\treturn day;\r\n\t\t}\r\n\r\n\t}\r\n","title":"Calculate number of weekdays between two dates in Java","body":"<p>This is my example without looping. It is a class in this example because I serialize it in some JSON output. Basically I work out the number of days between the two dates, divide by 7 and assign to a long to have a integer value for the number of weeks. Take the original number of days and subtract the number of weekends*2. This isn't quite perfect - you need to work out if there is a 'hangover' where the start is close to the end of the week and goes over the weekend. To correct for this I find the day of the week at the start and find the remainder of the number of days, and add those together to find the 'hangover' - and if it is more than 5 it is a weekend. It isn't quite perfect, and does not account for holidays at all. And no Joda in sight. That said there is also a issue with timezones.</p>\n\n<pre><code>import java.io.Serializable;\nimport java.util.Date;\n\npublic class BusinessDayCalculator implements Serializable {\n\n    private static long DAY = 86400000l;\n\n    private Date startTime;\n    private Date endTime;\n\n    public void setStartTime(Date startTime) {\n        this.startTime = startTime;\n    }\n\n    public Date getStartTime() {\n        return startTime;\n    }\n\n    public void setEndTime(Date endTime) {\n        this.endTime = endTime;\n    }\n\n    public Date getEndTime() {\n        return endTime;\n    }\n\n    public long getHours() {\n        return (this.endTime.getTime() - this.startTime.getTime())/(1000*60*60);\n    }\n\n    public long getBusinessDays(){\n\n        long startDay = getDayFromDate(this.startTime);\n        long endDay = getDayFromDate(this.endTime);\n\n        long totalDays = endDay-startDay;\n        long totalWeekends = totalDays/7;\n\n        long day = getDay(this.startTime);\n\n        long hangover = totalDays % 7;\n\n        long intoWeekend = day + hangover;\n        if(intoWeekend&gt;5){\n            totalWeekends++;\n        }\n\n        long totalBusinessDays = totalDays - (totalWeekends *2);\n\n        /*\n        System.out.println(\"Days = \" + day );\n        System.out.println(\"Hangover = \" + hangover );\n        System.out.println(\"Total Days = \" + totalDays);\n        System.out.println(\"Total Weekends = \" + totalWeekends);\n        System.out.println(\"Total Business Days = \" + totalBusinessDays);\n        */\n\n        return totalBusinessDays;\n    }\n\n    private long getDayFromDate( Date date ){\n        long d = date.getTime() / DAY;\n        return d;\n    }\n\n    private long getDay( Date date ){\n        long daysSinceEpoc = getDayFromDate(date);\n        long day = daysSinceEpoc % 7;\n        day = day + 4;\n        if(day&gt;6) day = day - 7;\n        return day;\n    }\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4875051,"reputation":4665,"user_id":3930424,"accept_rate":78,"display_name":"GROX13"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1469604185,"creation_date":1469604185,"answer_id":38606400,"question_id":4600034,"body_markdown":"This is my example without looping. Algorithm is same as [卢声远 Shengyuan Lus][1] one but I used some features of JodaTime.\r\n\r\n    public static int getNumberOfBusinessDays(@Nonnull LocalDate from, @Nonnull LocalDate to) {\r\n\t\tint fromDateDayOfWeek = from.getDayOfWeek();\r\n\t\tint toDateDayOfWeek = to.getDayOfWeek();\r\n\r\n\t\tint daysWithoutWeekends = 5 * Weeks.weeksBetween(\r\n\t\t\t\tfrom.withDayOfWeek(DateTimeConstants.MONDAY), to).getWeeks();\r\n\r\n\t\tif (fromDateDayOfWeek == DateTimeConstants.SUNDAY) {\r\n\t\t\tfromDateDayOfWeek = DateTimeConstants.SATURDAY;\r\n\t\t}\r\n\t\tif (toDateDayOfWeek == DateTimeConstants.SUNDAY) {\r\n\t\t\ttoDateDayOfWeek = DateTimeConstants.SATURDAY;\r\n\t\t}\r\n\r\n\t\treturn daysWithoutWeekends - (fromDateDayOfWeek - toDateDayOfWeek);\r\n\t}\r\n\r\n\r\n  [1]: https://stackoverflow.com/users/290629/%E5%8D%A2%E5%A3%B0%E8%BF%9C-shengyuan-lu","title":"Calculate number of weekdays between two dates in Java","body":"<p>This is my example without looping. Algorithm is same as <a href=\"https://stackoverflow.com/users/290629/%E5%8D%A2%E5%A3%B0%E8%BF%9C-shengyuan-lu\">卢声远 Shengyuan Lus</a> one but I used some features of JodaTime.</p>\n\n<pre><code>public static int getNumberOfBusinessDays(@Nonnull LocalDate from, @Nonnull LocalDate to) {\n    int fromDateDayOfWeek = from.getDayOfWeek();\n    int toDateDayOfWeek = to.getDayOfWeek();\n\n    int daysWithoutWeekends = 5 * Weeks.weeksBetween(\n            from.withDayOfWeek(DateTimeConstants.MONDAY), to).getWeeks();\n\n    if (fromDateDayOfWeek == DateTimeConstants.SUNDAY) {\n        fromDateDayOfWeek = DateTimeConstants.SATURDAY;\n    }\n    if (toDateDayOfWeek == DateTimeConstants.SUNDAY) {\n        toDateDayOfWeek = DateTimeConstants.SATURDAY;\n    }\n\n    return daysWithoutWeekends - (fromDateDayOfWeek - toDateDayOfWeek);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3217290,"reputation":193,"user_id":2715625,"accept_rate":25,"display_name":"Harshal"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1472314829,"creation_date":1472314020,"answer_id":39183119,"question_id":4600034,"body_markdown":"This program considers loop approach but consider activities happened on after work hours to next working day office start hour\r\n \r\n\r\n  \r\npublic class BusinessDayCalculator {\r\n\r\n\tprivate final String DATE_FORMAT = &quot;dd/MM/yyyy HH:mm:ss&quot;;\r\n\tprivate final int OFFICE_START_HOUR = 9;\r\n\tprivate final int OFFICE_CLOSE_HOUR = 17;\r\n\tprivate final int TOTAL_MINS_IN_BUSINESS_DAY = (OFFICE_CLOSE_HOUR - OFFICE_START_HOUR)*60;\r\n\r\n\tpublic void dateDifference(String start, String end){\r\n\t\tDate startDate = validateStringToDate(start);\r\n\t\tDate endDate = validateStringToDate(end);\r\n\t\tSystem.out.println(startDate);\r\n\t\tSystem.out.println(endDate);\r\n\t\tCalendar startDay = convertDateToCalendar(startDate);\r\n\t\tCalendar tempDay = (Calendar) startDay.clone();\r\n\t\tCalendar endDay = convertDateToCalendar(endDate);\r\n\r\n\t\tSystem.out.println(startDay.getTime());\r\n\t\tSystem.out.println(endDay.getTime());\r\n\t\tint workDays = -1;\r\n\r\n\t\tint startDayDifference = 0;\r\n\t\tint endDayDifference = 0;\r\n        int hours = 0;\r\n\t\tint minsRemainder = 0;\r\n\r\n\t\tif(!(startDay.get(Calendar.DAY_OF_YEAR) == endDay.get(Calendar.DAY_OF_YEAR)\r\n\t\t\t\t&amp;&amp; startDay.get(Calendar.YEAR) == endDay.get(Calendar.YEAR))){\r\n\r\n\t\t\tdo{\r\n\t\t\t\ttempDay.add(Calendar.DAY_OF_MONTH, 1);\r\n\t\t\t\tif(tempDay.get(Calendar.DAY_OF_WEEK) != Calendar.SATURDAY \r\n\t\t\t\t\t\t&amp;&amp; tempDay.get(Calendar.DAY_OF_WEEK) != Calendar.SUNDAY){\r\n\t\t\t\t\tworkDays++;\r\n\t\t\t\t}\r\n\t\t\t}while(tempDay.getTimeInMillis() &lt;= endDay.getTimeInMillis());\r\n\r\n\t\t\tif(workDays &gt; 0){\r\n\t\t\t\tworkDays = workDays - 1;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tstartDayDifference = hourDifferenceInMinutesOfStartDay(startDay);\r\n\t\tendDayDifference = hourDifferenceInMinutesOfEndDay(endDay);\r\n\r\n\t\tminsRemainder = (startDayDifference + endDayDifference) % TOTAL_MINS_IN_BUSINESS_DAY;\r\n\t\tworkDays = workDays + ((startDayDifference + endDayDifference) / TOTAL_MINS_IN_BUSINESS_DAY);\r\n\r\n\t\thours = minsRemainder/60;\r\n\t\tminsRemainder = minsRemainder % 60;\r\n\r\n\t\tSystem.out.println(workDays + &quot;d &quot;+ hours + &quot;hrs &quot; + minsRemainder + &quot; mins&quot;);\r\n\r\n\t}\r\n\r\n\r\n\tprivate int hourDifferenceInMinutesOfEndDay(Calendar endDay) {\r\n\t\tlong endTimestamp = endDay.getTimeInMillis();\r\n\t\tSystem.out.println(endTimestamp);\r\n\t\tendDay.set(Calendar.HOUR_OF_DAY, OFFICE_START_HOUR);\r\n\t\tendDay.set(Calendar.MINUTE,0);\r\n\t\tlong endDayOfficeStartTimestamp = endDay.getTimeInMillis();\r\n\t\tSystem.out.println(endDayOfficeStartTimestamp);\r\n\t\tint difference = (int)((endTimestamp - endDayOfficeStartTimestamp) / 1000) / 60;\r\n\t\tSystem.out.println(difference);\r\n\t\treturn difference;\r\n\t}\r\n\r\n\r\n\tprivate int hourDifferenceInMinutesOfStartDay(Calendar startDay) {\r\n\t\tlong starttimestamp = startDay.getTimeInMillis();\r\n\t\tSystem.out.println(starttimestamp);\r\n\t\tstartDay.set(Calendar.HOUR_OF_DAY, OFFICE_CLOSE_HOUR);\r\n\t\tstartDay.set(Calendar.MINUTE,0);\r\n\t\tlong startDayOfficeCloseTimestamp = startDay.getTimeInMillis();\r\n\t\tSystem.out.println(startDayOfficeCloseTimestamp);\r\n\t\tint difference = (int)((startDayOfficeCloseTimestamp - starttimestamp) / 1000) / 60;\r\n\t\tSystem.out.println(difference);\r\n\t\treturn difference;\r\n\t}\r\n\r\n\tpublic Calendar convertDateToCalendar(Date date){\r\n\t\tCalendar calendar = Calendar.getInstance();\r\n\t\tcalendar.setTime(date);\r\n\r\n\t\tif(calendar.get(Calendar.DAY_OF_WEEK) == Calendar.SATURDAY \r\n\t\t\t\t|| calendar.get(Calendar.DAY_OF_WEEK) == Calendar.SUNDAY){\r\n\t\t\tcalendar = handleActivityOnAfterWorkHoursOrWeekendOrHolidays(calendar);\r\n\t\t}\r\n\r\n\t\tif(calendar.get(Calendar.HOUR_OF_DAY) &gt;= OFFICE_CLOSE_HOUR \r\n\t\t\t\t&amp;&amp; calendar.get(Calendar.MINUTE) &gt; 0){\r\n\t\t\tcalendar = handleActivityOnAfterWorkHoursOrWeekendOrHolidays(calendar);\r\n\t\t}\r\n\r\n\t\tif(calendar.get(Calendar.HOUR_OF_DAY) &lt; OFFICE_START_HOUR){\r\n\t\t\tcalendar.set(Calendar.HOUR_OF_DAY, OFFICE_START_HOUR);\r\n\t\t\tcalendar.set(Calendar.MINUTE,0);\r\n\t\t}\r\n\r\n\t\treturn calendar;\r\n\t}\r\n\r\n\tprivate Calendar handleActivityOnAfterWorkHoursOrWeekendOrHolidays(Calendar calendar) {\r\n\t\tdo{\r\n\t\t\tcalendar.add(Calendar.DAY_OF_MONTH, 1);\r\n\t\t}while(isHoliday(calendar));\r\n\t\tcalendar.set(Calendar.HOUR_OF_DAY, OFFICE_START_HOUR);\r\n\t\tcalendar.set(Calendar.MINUTE,0);\r\n\t\treturn calendar;\r\n\t}\r\n\r\n\tprivate boolean isHoliday(Calendar calendar) {\r\n\t\tif(calendar.get(Calendar.DAY_OF_WEEK) == Calendar.SATURDAY \r\n\t\t\t\t|| calendar.get(Calendar.DAY_OF_WEEK) == Calendar.SUNDAY){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic Date validateStringToDate(String input){\r\n\t\tSimpleDateFormat dateFormat = new SimpleDateFormat(DATE_FORMAT);\r\n\t\tDate date = null;\r\n\t\ttry{\r\n\t\t\tdate = dateFormat.parse(input);\r\n\t\t}catch(ParseException exception){\r\n\t\t\tSystem.out.println(&quot;invalid date format&quot;);\r\n\t\t\tthrow new RuntimeException(&quot;invalid date format&quot;);\r\n\t\t}\r\n\t\treturn date;\r\n\t}\r\n\r\n\tpublic static void main(String[] args){\r\n\t\tBusinessDayCalculator calc = new BusinessDayCalculator();\r\n\t\tString startDate = &quot;27/12/2016 11:38:00&quot;;\r\n\t\tString endDate = &quot;04/01/2017 12:38:00&quot;;\r\n\t\tcalc.dateDifference(startDate, endDate);\r\n\t}\r\n\r\n\r\n}\r\n    \r\n","title":"Calculate number of weekdays between two dates in Java","body":"<p>This program considers loop approach but consider activities happened on after work hours to next working day office start hour</p>\n\n<p>public class BusinessDayCalculator {</p>\n\n<pre><code>private final String DATE_FORMAT = \"dd/MM/yyyy HH:mm:ss\";\nprivate final int OFFICE_START_HOUR = 9;\nprivate final int OFFICE_CLOSE_HOUR = 17;\nprivate final int TOTAL_MINS_IN_BUSINESS_DAY = (OFFICE_CLOSE_HOUR - OFFICE_START_HOUR)*60;\n\npublic void dateDifference(String start, String end){\n    Date startDate = validateStringToDate(start);\n    Date endDate = validateStringToDate(end);\n    System.out.println(startDate);\n    System.out.println(endDate);\n    Calendar startDay = convertDateToCalendar(startDate);\n    Calendar tempDay = (Calendar) startDay.clone();\n    Calendar endDay = convertDateToCalendar(endDate);\n\n    System.out.println(startDay.getTime());\n    System.out.println(endDay.getTime());\n    int workDays = -1;\n\n    int startDayDifference = 0;\n    int endDayDifference = 0;\n    int hours = 0;\n    int minsRemainder = 0;\n\n    if(!(startDay.get(Calendar.DAY_OF_YEAR) == endDay.get(Calendar.DAY_OF_YEAR)\n            &amp;&amp; startDay.get(Calendar.YEAR) == endDay.get(Calendar.YEAR))){\n\n        do{\n            tempDay.add(Calendar.DAY_OF_MONTH, 1);\n            if(tempDay.get(Calendar.DAY_OF_WEEK) != Calendar.SATURDAY \n                    &amp;&amp; tempDay.get(Calendar.DAY_OF_WEEK) != Calendar.SUNDAY){\n                workDays++;\n            }\n        }while(tempDay.getTimeInMillis() &lt;= endDay.getTimeInMillis());\n\n        if(workDays &gt; 0){\n            workDays = workDays - 1;\n        }\n\n    }\n\n    startDayDifference = hourDifferenceInMinutesOfStartDay(startDay);\n    endDayDifference = hourDifferenceInMinutesOfEndDay(endDay);\n\n    minsRemainder = (startDayDifference + endDayDifference) % TOTAL_MINS_IN_BUSINESS_DAY;\n    workDays = workDays + ((startDayDifference + endDayDifference) / TOTAL_MINS_IN_BUSINESS_DAY);\n\n    hours = minsRemainder/60;\n    minsRemainder = minsRemainder % 60;\n\n    System.out.println(workDays + \"d \"+ hours + \"hrs \" + minsRemainder + \" mins\");\n\n}\n\n\nprivate int hourDifferenceInMinutesOfEndDay(Calendar endDay) {\n    long endTimestamp = endDay.getTimeInMillis();\n    System.out.println(endTimestamp);\n    endDay.set(Calendar.HOUR_OF_DAY, OFFICE_START_HOUR);\n    endDay.set(Calendar.MINUTE,0);\n    long endDayOfficeStartTimestamp = endDay.getTimeInMillis();\n    System.out.println(endDayOfficeStartTimestamp);\n    int difference = (int)((endTimestamp - endDayOfficeStartTimestamp) / 1000) / 60;\n    System.out.println(difference);\n    return difference;\n}\n\n\nprivate int hourDifferenceInMinutesOfStartDay(Calendar startDay) {\n    long starttimestamp = startDay.getTimeInMillis();\n    System.out.println(starttimestamp);\n    startDay.set(Calendar.HOUR_OF_DAY, OFFICE_CLOSE_HOUR);\n    startDay.set(Calendar.MINUTE,0);\n    long startDayOfficeCloseTimestamp = startDay.getTimeInMillis();\n    System.out.println(startDayOfficeCloseTimestamp);\n    int difference = (int)((startDayOfficeCloseTimestamp - starttimestamp) / 1000) / 60;\n    System.out.println(difference);\n    return difference;\n}\n\npublic Calendar convertDateToCalendar(Date date){\n    Calendar calendar = Calendar.getInstance();\n    calendar.setTime(date);\n\n    if(calendar.get(Calendar.DAY_OF_WEEK) == Calendar.SATURDAY \n            || calendar.get(Calendar.DAY_OF_WEEK) == Calendar.SUNDAY){\n        calendar = handleActivityOnAfterWorkHoursOrWeekendOrHolidays(calendar);\n    }\n\n    if(calendar.get(Calendar.HOUR_OF_DAY) &gt;= OFFICE_CLOSE_HOUR \n            &amp;&amp; calendar.get(Calendar.MINUTE) &gt; 0){\n        calendar = handleActivityOnAfterWorkHoursOrWeekendOrHolidays(calendar);\n    }\n\n    if(calendar.get(Calendar.HOUR_OF_DAY) &lt; OFFICE_START_HOUR){\n        calendar.set(Calendar.HOUR_OF_DAY, OFFICE_START_HOUR);\n        calendar.set(Calendar.MINUTE,0);\n    }\n\n    return calendar;\n}\n\nprivate Calendar handleActivityOnAfterWorkHoursOrWeekendOrHolidays(Calendar calendar) {\n    do{\n        calendar.add(Calendar.DAY_OF_MONTH, 1);\n    }while(isHoliday(calendar));\n    calendar.set(Calendar.HOUR_OF_DAY, OFFICE_START_HOUR);\n    calendar.set(Calendar.MINUTE,0);\n    return calendar;\n}\n\nprivate boolean isHoliday(Calendar calendar) {\n    if(calendar.get(Calendar.DAY_OF_WEEK) == Calendar.SATURDAY \n            || calendar.get(Calendar.DAY_OF_WEEK) == Calendar.SUNDAY){\n        return true;\n    }\n    return false;\n}\n\npublic Date validateStringToDate(String input){\n    SimpleDateFormat dateFormat = new SimpleDateFormat(DATE_FORMAT);\n    Date date = null;\n    try{\n        date = dateFormat.parse(input);\n    }catch(ParseException exception){\n        System.out.println(\"invalid date format\");\n        throw new RuntimeException(\"invalid date format\");\n    }\n    return date;\n}\n\npublic static void main(String[] args){\n    BusinessDayCalculator calc = new BusinessDayCalculator();\n    String startDate = \"27/12/2016 11:38:00\";\n    String endDate = \"04/01/2017 12:38:00\";\n    calc.dateDifference(startDate, endDate);\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":[],"owner":{"account_id":7170330,"reputation":81,"user_id":5478011,"display_name":"Amir Kadić"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1612439655,"creation_date":1477425502,"answer_id":40248655,"question_id":4600034,"body_markdown":"Here is a set-based solution that completes in constant time for any given subset of weekdays, not just Monday-Friday. It splits the problem into counting full weeks and counting the days in the residual week. If you are interested, [here&#39;s a detailed explanation and a formal proof][1] that the algorithm is correct. Note that the intervals are *inclusive*, i.e. startDate and endDate are counted in. If startDate is after endDate, the result is zero rather than negative.\r\n\r\n    long countWeekDays(LocalDate startDate, LocalDate endDate, Set&lt;DayOfWeek&gt; daysOfWeek) {\r\n\r\n        long periodLength = Math.max(0, ChronoUnit.DAYS.between(startDate, endDate) + 1);\r\n        long fullWeeks = periodLength / 7;\r\n        long residualWeekLength = periodLength % 7;\r\n\r\n        Set&lt;DayOfWeek&gt; residualWeekDays = LongStream.range(0, residualWeekLength)\r\n            .mapToObj(offset -&gt; startDate.plusDays(offset).getDayOfWeek())\r\n            .collect(Collectors.toSet());\r\n        residualWeekDays.retainAll(daysOfWeek);\r\n\r\n        return fullWeeks * daysOfWeek.size() + residualWeekDays.size();\r\n    }\r\n\r\nFor the original problem (Monday-Friday) it is called e.g. with:\r\n\r\n    countWeekDays(\r\n        LocalDate.of(2016, 2, 8),\r\n        LocalDate.of(2016, 2, 26),\r\n        new HashSet(Arrays.asList(\r\n            DayOfWeek.MONDAY,\r\n            DayOfWeek.TUESDAY,\r\n            DayOfWeek.WEDNESDAY,\r\n            DayOfWeek.THURSDAY,\r\n            DayOfWeek.FRIDAY\r\n            )\r\n        )\r\n    )\r\n\r\nThis assumes you are working with inclusive intervals. If you want to skip the first day of the interval, just add one day to the first parameter:\r\n\r\n    countWeekDays(\r\n        LocalDate.of(2016, 2, 8).plusDays(1),\r\n        LocalDate.of(2016, 2, 26),\r\n        new HashSet(Arrays.asList(\r\n            DayOfWeek.MONDAY,\r\n            DayOfWeek.TUESDAY,\r\n            DayOfWeek.WEDNESDAY,\r\n            DayOfWeek.THURSDAY,\r\n            DayOfWeek.FRIDAY\r\n            )\r\n        )\r\n    )\r\n\r\nLikewise, if you want to skip the last day of the inclusive interval, subtract one day from the second parameter:\r\n\r\n    countWeekDays(\r\n        LocalDate.of(2016, 2, 8),\r\n        LocalDate.of(2016, 2, 26).minusDays(1),\r\n        new HashSet(Arrays.asList(\r\n            DayOfWeek.MONDAY,\r\n            DayOfWeek.TUESDAY,\r\n            DayOfWeek.WEDNESDAY,\r\n            DayOfWeek.THURSDAY,\r\n            DayOfWeek.FRIDAY\r\n            )\r\n        )\r\n    )\r\n\r\nFinally, if you need to skip both interval-delimiting days, combine the two previous modifications:\r\n\r\n    countWeekDays(\r\n        LocalDate.of(2016, 2, 8).plusDays(1),\r\n        LocalDate.of(2016, 2, 26).minusDays(1),\r\n        new HashSet(Arrays.asList(\r\n            DayOfWeek.MONDAY,\r\n            DayOfWeek.TUESDAY,\r\n            DayOfWeek.WEDNESDAY,\r\n            DayOfWeek.THURSDAY,\r\n            DayOfWeek.FRIDAY\r\n            )\r\n        )\r\n    )\r\n\r\n\r\n  [1]: https://amir.a-ware.dev/calculating-the-number-of-specific-weekdays-between-two-dates.html#calculating-the-number-of-specific-weekdays-between-two-dates","title":"Calculate number of weekdays between two dates in Java","body":"<p>Here is a set-based solution that completes in constant time for any given subset of weekdays, not just Monday-Friday. It splits the problem into counting full weeks and counting the days in the residual week. If you are interested, <a href=\"https://amir.a-ware.dev/calculating-the-number-of-specific-weekdays-between-two-dates.html#calculating-the-number-of-specific-weekdays-between-two-dates\" rel=\"nofollow noreferrer\">here's a detailed explanation and a formal proof</a> that the algorithm is correct. Note that the intervals are <em>inclusive</em>, i.e. startDate and endDate are counted in. If startDate is after endDate, the result is zero rather than negative.</p>\n<pre><code>long countWeekDays(LocalDate startDate, LocalDate endDate, Set&lt;DayOfWeek&gt; daysOfWeek) {\n\n    long periodLength = Math.max(0, ChronoUnit.DAYS.between(startDate, endDate) + 1);\n    long fullWeeks = periodLength / 7;\n    long residualWeekLength = periodLength % 7;\n\n    Set&lt;DayOfWeek&gt; residualWeekDays = LongStream.range(0, residualWeekLength)\n        .mapToObj(offset -&gt; startDate.plusDays(offset).getDayOfWeek())\n        .collect(Collectors.toSet());\n    residualWeekDays.retainAll(daysOfWeek);\n\n    return fullWeeks * daysOfWeek.size() + residualWeekDays.size();\n}\n</code></pre>\n<p>For the original problem (Monday-Friday) it is called e.g. with:</p>\n<pre><code>countWeekDays(\n    LocalDate.of(2016, 2, 8),\n    LocalDate.of(2016, 2, 26),\n    new HashSet(Arrays.asList(\n        DayOfWeek.MONDAY,\n        DayOfWeek.TUESDAY,\n        DayOfWeek.WEDNESDAY,\n        DayOfWeek.THURSDAY,\n        DayOfWeek.FRIDAY\n        )\n    )\n)\n</code></pre>\n<p>This assumes you are working with inclusive intervals. If you want to skip the first day of the interval, just add one day to the first parameter:</p>\n<pre><code>countWeekDays(\n    LocalDate.of(2016, 2, 8).plusDays(1),\n    LocalDate.of(2016, 2, 26),\n    new HashSet(Arrays.asList(\n        DayOfWeek.MONDAY,\n        DayOfWeek.TUESDAY,\n        DayOfWeek.WEDNESDAY,\n        DayOfWeek.THURSDAY,\n        DayOfWeek.FRIDAY\n        )\n    )\n)\n</code></pre>\n<p>Likewise, if you want to skip the last day of the inclusive interval, subtract one day from the second parameter:</p>\n<pre><code>countWeekDays(\n    LocalDate.of(2016, 2, 8),\n    LocalDate.of(2016, 2, 26).minusDays(1),\n    new HashSet(Arrays.asList(\n        DayOfWeek.MONDAY,\n        DayOfWeek.TUESDAY,\n        DayOfWeek.WEDNESDAY,\n        DayOfWeek.THURSDAY,\n        DayOfWeek.FRIDAY\n        )\n    )\n)\n</code></pre>\n<p>Finally, if you need to skip both interval-delimiting days, combine the two previous modifications:</p>\n<pre><code>countWeekDays(\n    LocalDate.of(2016, 2, 8).plusDays(1),\n    LocalDate.of(2016, 2, 26).minusDays(1),\n    new HashSet(Arrays.asList(\n        DayOfWeek.MONDAY,\n        DayOfWeek.TUESDAY,\n        DayOfWeek.WEDNESDAY,\n        DayOfWeek.THURSDAY,\n        DayOfWeek.FRIDAY\n        )\n    )\n)\n</code></pre>\n"},{"comments":[{"owner":{"account_id":3100362,"reputation":1711,"user_id":2624644,"accept_rate":40,"display_name":"Simon"},"score":0,"creation_date":1525883780,"post_id":40369140,"comment_id":87534244,"body_markdown":"instead of `LocalDate date = start ;`, why not `LocalDate date = LocalDate.from(start)` to avoid mutating the argument?","body":"instead of <code>LocalDate date = start ;</code>, why not <code>LocalDate date = LocalDate.from(start)</code> to avoid mutating the argument?"},{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":1,"creation_date":1525891828,"post_id":40369140,"comment_id":87538356,"body_markdown":"@Simon The *java.time* classes are [immutable](https://en.m.wikipedia.org/wiki/Immutable_object), by design.","body":"@Simon The <i>java.time</i> classes are <a href=\"https://en.m.wikipedia.org/wiki/Immutable_object\" rel=\"nofollow noreferrer\">immutable</a>, by design."},{"owner":{"account_id":11059478,"reputation":305,"user_id":8121295,"accept_rate":85,"display_name":"Bartek Spitza"},"score":0,"creation_date":1561041746,"post_id":40369140,"comment_id":99942396,"body_markdown":"Feel like this answer deserves more recognition. The first approach is more readable than the accepted answer and works just as well.","body":"Feel like this answer deserves more recognition. The first approach is more readable than the accepted answer and works just as well."}],"tags":[],"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"comment_count":3,"down_vote_count":1,"up_vote_count":15,"is_accepted":false,"score":14,"last_activity_date":1605090854,"creation_date":1478036677,"answer_id":40369140,"question_id":4600034,"body_markdown":"# java.time\r\n\r\nThe modern way is with the java.time classes. \r\n\r\n## `LocalDate`\r\n\r\nThe [`LocalDate`](https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html) class represents a date-only value without time-of-day and without time zone.\r\n\r\n    LocalDate start = LocalDate.of( 2016 , 1 , 23 );\r\n    LocalDate stop = start.plusMonths( 1 );\r\n\r\n## `DayOfWeek` enum\r\n\r\nThe [`DayOfWeek`](http://docs.oracle.com/javase/8/docs/api/java/time/DayOfWeek.html) [enum](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html) provides a [singleton](https://en.wikipedia.org/wiki/Singleton_pattern) instance for each of the sever days of the week.\r\n\r\n    DayOfWeek dow = start.getDayOfWeek();\r\n    if( dow.equals( DayOfWeek.SATURDAY ) || dow.equals( DayOfWeek.SUNDAY ) ) …\r\n\r\nWe can collect the desired dates in a `List`.\r\n\r\n    int initialCapacity = Duration.between( start , stop ).toDays() ;\r\n    List&lt;LocalDate&gt; dates = new ArrayList&lt;&gt;( initialCapacity );\r\n    …\r\n    if( dow.equals( DayOfWeek.SATURDAY ) || dow.equals( DayOfWeek.SUNDAY ) ) {\r\n        dates.add( date );\r\n        …\r\n\r\nAn [`EnumSet`][1] is an extremely efficient, fast and low-memory, implementation of [`Set`][2]. We can use an `EnumSet` instead of the `if` statement seen above.\r\n\r\n    Set&lt;DayOfWeek&gt; weekend = EnumSet.of( DayOfWeek.SATURDAY , DayOfWeek.SUNDAY ) ;\r\n    …\r\n    if( weekend.contains( dayOfWeek ) ) …\r\n\r\nPut that all together.\r\n\r\n    LocalDate date = start ;\r\n    while( date.isBefore( stop ) ) {\r\n        if( ! weekend.contains( date.getDayOfWeek() ) ) { // If not weekend, collect this LocalDate.\r\n            dates.add( date ) ;\r\n        }\r\n        // Prepare for next loop.\r\n        date = date.plusDays( 1 ); // Increment to next day.\r\n    }\r\n\r\n# `nextWorkingDay` TemporalAdjuster\r\n\r\nAnother approach uses the [ThreeTen-Extra][3] project to add classes that work with java.time.\r\n\r\nThe [`Temporals`][4] class adds additional implementations of [`TemporalAdjuster`](http://docs.oracle.com/javase/8/docs/api/java/time/temporal/TemporalAdjuster.html) for manipulating date-time values. We want the [`nextWorkingDay`][5] adjuster to increment the date while skipping over Saturday &amp; Sunday.\r\n\r\n    LocalDate start = LocalDate.of( 2016 , 1 , 23 );\r\n    LocalDate stop = start.plusMonths( 1 );\r\n\r\n    int initialCapacity = Duration.between( start , stop ).toDays() ;\r\n    List&lt;LocalDate&gt; dates = new ArrayList&lt;&gt;( initialCapacity );\r\n\r\n    LocalDate date = start.minusDays( 1 );  // Start a day ahead.\r\n    while( date.isBefore( stop ) ) {\r\n        date = date.with( org.threeten.extra.Temporals.nextWorkingDay() );\r\n        // Double-check ending date as the `nextWorkingDay` adjuster could move us past the stop date.\r\n        if( date.isBefore( stop ) ) { \r\n            dates.add( date ) ;\r\n        }\r\n    }\r\n\r\n# Performance\r\n\r\nI am curious about the performance of the various approach in various Answers on this page. I am considering only the modern *java.time* code, not the code using troublesome legacy `Date`/`Calendar` classes.\r\n\r\nHere are four methods that each return the number of days elapsed. \r\n\r\nOne uses the clever math-based approach seen in the [Answer by Roland](https://stackoverflow.com/a/44942039/642706). \r\n\r\n    private long countWeekDaysMath ( LocalDate start , LocalDate stop ) {\r\n        // Code taken from Answer by Roland.\r\n        // https://stackoverflow.com/a/44942039/642706\r\n        long count = 0;\r\n        final DayOfWeek startW = start.getDayOfWeek();\r\n        final DayOfWeek stopW = stop.getDayOfWeek();\r\n\r\n        final long days = ChronoUnit.DAYS.between( start , stop );\r\n        final long daysWithoutWeekends = days - 2 * ( ( days + startW.getValue() ) / 7 );\r\n\r\n        //adjust for starting and ending on a Sunday:\r\n        count = daysWithoutWeekends + ( startW == DayOfWeek.SUNDAY ? 1 : 0 ) + ( stopW == DayOfWeek.SUNDAY ? 1 : 0 );\r\n\r\n        return count;\r\n    }\r\n\r\nTwo use approaches seen in this Answer of mine: (a) Visit each date, incrementing one-by-one in a conventional loop.\r\n\r\n    private long countWeekDaysVisit ( LocalDate start , LocalDate stop ) {\r\n        // Code taken from Answer by Basil Bourque.\r\n        // https://stackoverflow.com/a/40369140/642706\r\n        long count = 0;\r\n        Set &lt; DayOfWeek &gt; weekend = EnumSet.of( DayOfWeek.SATURDAY , DayOfWeek.SUNDAY );\r\n        LocalDate ld = start;\r\n        while ( ld.isBefore( stop ) ) {\r\n            if ( ! weekend.contains( ld.getDayOfWeek() ) ) { // If not weekend, collect this LocalDate.\r\n                count++;\r\n            }\r\n            // Prepare for next loop.\r\n            ld = ld.plusDays( 1 ); // Increment to next day.\r\n        }\r\n        return count;\r\n    }\r\n\r\n…and, (b) Using the `TemporalAdjuster` implementation `org.threeten.extra.Temporals.nextWorkingDay()`.\r\n\r\n    private long countWeekDaysAdjuster ( LocalDate start , LocalDate stop ) {\r\n        // Code taken from Answer by Basil Bourque.\r\n        // https://stackoverflow.com/a/40369140/642706\r\n        long count = 0;\r\n        Set &lt; DayOfWeek &gt; weekend = EnumSet.of( DayOfWeek.SATURDAY , DayOfWeek.SUNDAY );\r\n        TemporalAdjuster nextWorkingDayTA = org.threeten.extra.Temporals.nextWorkingDay();\r\n        LocalDate ld = start;\r\n        if ( weekend.contains( ld.getDayOfWeek() ) ) {\r\n            ld = ld.with( nextWorkingDayTA );\r\n        }\r\n        while ( ld.isBefore( stop ) ) {\r\n            count++;\r\n            // Prepare for next loop.\r\n            ld = ld.with( nextWorkingDayTA ); // Increment to next working day (non-weekend day).\r\n        }\r\n        return count;\r\n    }\r\n\r\n The last uses Java Streams approach seen in the [Answer by Ravindra Ranwala](https://stackoverflow.com/a/51010738/642706).\r\n\r\n    private long countWeekDaysStream ( LocalDate start , LocalDate stop ) {\r\n        // Code taken from the Answer by Ravindra Ranwala.\r\n        // https://stackoverflow.com/a/51010738/642706\r\n        long count = 0;\r\n        Set &lt; DayOfWeek &gt; weekend = EnumSet.of( DayOfWeek.SATURDAY , DayOfWeek.SUNDAY );\r\n        final long weekDaysBetween = start.datesUntil( stop )\r\n                                         .filter( d -&gt; ! weekend.contains( d.getDayOfWeek() ) )\r\n                                         .count();\r\n        return count;\r\n    }\r\n\r\n\r\nAnd the test harness. \r\n\r\n**Caveats:** \r\n\r\n - Well, the usual caveats about micro-benchmarking being untrustworthy, prone to unjustified or unrealistic conclusions. \r\n - I wish I&#39;d learned to use the [*JMH* micro-benchmarking framework][6].\r\n - I have not bothered to try optimizing any of this code. For example, in real work, the `TemporalAdjuster` could be cached outside our method.\r\n\r\nTest harness.\r\n\r\n    LocalDate start = LocalDate.of( 2018 , Month.JANUARY , 1 );\r\n    LocalDate stop = start.plusYears( 1 );\r\n\r\n    int runs = 100_000;\r\n\r\n    long go = System.nanoTime();\r\n    for ( int i = 1 ; i &lt;= runs ; i++ ) {\r\n        long count = this.countWeekDaysMath( start , stop );\r\n    }\r\n    long elapsedMath = ( System.nanoTime() - go );\r\n\r\n    go = System.nanoTime();\r\n    for ( int i = 1 ; i &lt;= runs ; i++ ) {\r\n        long count = this.countWeekDaysVisit( start , stop );\r\n    }\r\n    long elapsedVisit = ( System.nanoTime() - go );\r\n\r\n    go = System.nanoTime();\r\n    for ( int i = 1 ; i &lt;= runs ; i++ ) {\r\n        long count = this.countWeekDaysStream( start , stop );\r\n    }\r\n    long elapsedAdjuster = ( System.nanoTime() - go );\r\n\r\n    go = System.nanoTime();\r\n    for ( int i = 1 ; i &lt;= runs ; i++ ) {\r\n        long count = this.countWeekDaysStream( start , stop );\r\n    }\r\n    long elapsedStream = ( System.nanoTime() - go );\r\n\r\n    System.out.println( &quot;math: &quot; + elapsedMath + &quot; each: &quot; + ( elapsedMath / runs ) );\r\n    System.out.println( &quot;visit: &quot; + elapsedVisit + &quot; each: &quot; + ( elapsedVisit / runs ) );\r\n    System.out.println( &quot;adjuster: &quot; + elapsedAdjuster + &quot; each: &quot; + ( elapsedAdjuster / runs ) );\r\n    System.out.println( &quot;stream: &quot; + elapsedStream + &quot; each: &quot; + ( elapsedStream / runs ) );\r\n\r\nWhen run on my MacBook Pro (Sierra) with Oracle JDK 10.0.1 and *ThreeTen-Extra* version 1.3.2, I get results consistently close to the following. The **math solution is a tiny fraction of the others** at a couple hundred nanos versus several thousand, as we would expect obviously. Of the other three, the **`TemporalAdjuster` is the longest**, always over 10,000 nanos each. The visit and stream both come in well under that 10,000 nanos each, with visit being noticeably faster than streams. As seen in other examples around the internets, **Java Streams usually make for nifty short code while often running significantly longer**, about 20% longer in this case.\r\n\r\n&gt;math: 18313309 each: 183\r\n\r\n&gt;visit: 708420626 each: 7084\r\n\r\n&gt;adjuster: 1002157240 each: 10021\r\n\r\n&gt;stream: 924724750 each: 9247\r\n\r\n\r\n\r\n\r\n----------\r\n\r\n# About java.time\r\n\r\nThe [java.time](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html) framework is built into Java 8 and later. These classes supplant the troublesome old [legacy](https://en.wikipedia.org/wiki/Legacy_system) date-time classes such as [`java.util.Date`](https://docs.oracle.com/javase/8/docs/api/java/util/Date.html), [`Calendar`](https://docs.oracle.com/javase/8/docs/api/java/util/Calendar.html), &amp; [`SimpleDateFormat`](http://docs.oracle.com/javase/8/docs/api/java/text/SimpleDateFormat.html).\r\n\r\nThe [Joda-Time](http://www.joda.org/joda-time/) project, now in [maintenance mode](https://en.wikipedia.org/wiki/Maintenance_mode), advises migration to java.time.\r\n\r\nTo learn more, see the [Oracle Tutorial](http://docs.oracle.com/javase/tutorial/datetime/TOC.html). And search Stack Overflow for many examples and explanations. Specification is [JSR 310](https://jcp.org/en/jsr/detail?id=310).\r\n\r\nWhere to obtain the java.time classes? \r\n\r\n - [**Java SE 8**](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_8) and [**SE 9**](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_9) and later\r\n  - Built-in. \r\n  - Part of the standard Java API with a bundled implementation.\r\n  - Java 9 adds some minor features and fixes.\r\n - [**Java SE 6**](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_6) and [**SE 7**](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_7)\r\n  - Much of the java.time functionality is back-ported to Java 6 &amp; 7 in [***ThreeTen-Backport***](http://www.threeten.org/threetenbp/).\r\n - [**Android**](https://en.wikipedia.org/wiki/Android_(operating_system))\r\n  - The [*ThreeTenABP*](https://github.com/JakeWharton/ThreeTenABP) project adapts ***ThreeTen-Backport*** (mentioned above) for Android specifically.\r\n  - See [*How to use…*](https://stackoverflow.com/q/38922754/642706).\r\n\r\nThe [ThreeTen-Extra](http://www.threeten.org/threeten-extra/) project extends java.time with additional classes. This project is a proving ground for possible future additions to java.time. You may find some useful classes here such as [`Interval`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html), [`YearWeek`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/YearWeek.html), [`YearQuarter`](http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/YearQuarter.html), and [more](http://www.threeten.org/threeten-extra/apidocs/index.html).\r\n\r\n\r\n  [1]: http://docs.oracle.com/javase/8/docs/api/java/util/EnumSet.html\r\n  [2]: https://docs.oracle.com/javase/8/docs/api/java/util/Set.html\r\n  [3]: http://www.threeten.org/threeten-extra/\r\n  [4]: http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Temporals.html\r\n  [5]: http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Temporals.html#nextWorkingDay--\r\n  [6]: http://openjdk.java.net/projects/code-tools/jmh/","title":"Calculate number of weekdays between two dates in Java","body":"<h1>java.time</h1>\n<p>The modern way is with the java.time classes.</p>\n<h2><code>LocalDate</code></h2>\n<p>The <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html\" rel=\"noreferrer\"><code>LocalDate</code></a> class represents a date-only value without time-of-day and without time zone.</p>\n<pre><code>LocalDate start = LocalDate.of( 2016 , 1 , 23 );\nLocalDate stop = start.plusMonths( 1 );\n</code></pre>\n<h2><code>DayOfWeek</code> enum</h2>\n<p>The <a href=\"http://docs.oracle.com/javase/8/docs/api/java/time/DayOfWeek.html\" rel=\"noreferrer\"><code>DayOfWeek</code></a> <a href=\"http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html\" rel=\"noreferrer\">enum</a> provides a <a href=\"https://en.wikipedia.org/wiki/Singleton_pattern\" rel=\"noreferrer\">singleton</a> instance for each of the sever days of the week.</p>\n<pre><code>DayOfWeek dow = start.getDayOfWeek();\nif( dow.equals( DayOfWeek.SATURDAY ) || dow.equals( DayOfWeek.SUNDAY ) ) …\n</code></pre>\n<p>We can collect the desired dates in a <code>List</code>.</p>\n<pre><code>int initialCapacity = Duration.between( start , stop ).toDays() ;\nList&lt;LocalDate&gt; dates = new ArrayList&lt;&gt;( initialCapacity );\n…\nif( dow.equals( DayOfWeek.SATURDAY ) || dow.equals( DayOfWeek.SUNDAY ) ) {\n    dates.add( date );\n    …\n</code></pre>\n<p>An <a href=\"http://docs.oracle.com/javase/8/docs/api/java/util/EnumSet.html\" rel=\"noreferrer\"><code>EnumSet</code></a> is an extremely efficient, fast and low-memory, implementation of <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Set.html\" rel=\"noreferrer\"><code>Set</code></a>. We can use an <code>EnumSet</code> instead of the <code>if</code> statement seen above.</p>\n<pre><code>Set&lt;DayOfWeek&gt; weekend = EnumSet.of( DayOfWeek.SATURDAY , DayOfWeek.SUNDAY ) ;\n…\nif( weekend.contains( dayOfWeek ) ) …\n</code></pre>\n<p>Put that all together.</p>\n<pre><code>LocalDate date = start ;\nwhile( date.isBefore( stop ) ) {\n    if( ! weekend.contains( date.getDayOfWeek() ) ) { // If not weekend, collect this LocalDate.\n        dates.add( date ) ;\n    }\n    // Prepare for next loop.\n    date = date.plusDays( 1 ); // Increment to next day.\n}\n</code></pre>\n<h1><code>nextWorkingDay</code> TemporalAdjuster</h1>\n<p>Another approach uses the <a href=\"http://www.threeten.org/threeten-extra/\" rel=\"noreferrer\">ThreeTen-Extra</a> project to add classes that work with java.time.</p>\n<p>The <a href=\"http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Temporals.html\" rel=\"noreferrer\"><code>Temporals</code></a> class adds additional implementations of <a href=\"http://docs.oracle.com/javase/8/docs/api/java/time/temporal/TemporalAdjuster.html\" rel=\"noreferrer\"><code>TemporalAdjuster</code></a> for manipulating date-time values. We want the <a href=\"http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Temporals.html#nextWorkingDay--\" rel=\"noreferrer\"><code>nextWorkingDay</code></a> adjuster to increment the date while skipping over Saturday &amp; Sunday.</p>\n<pre><code>LocalDate start = LocalDate.of( 2016 , 1 , 23 );\nLocalDate stop = start.plusMonths( 1 );\n\nint initialCapacity = Duration.between( start , stop ).toDays() ;\nList&lt;LocalDate&gt; dates = new ArrayList&lt;&gt;( initialCapacity );\n\nLocalDate date = start.minusDays( 1 );  // Start a day ahead.\nwhile( date.isBefore( stop ) ) {\n    date = date.with( org.threeten.extra.Temporals.nextWorkingDay() );\n    // Double-check ending date as the `nextWorkingDay` adjuster could move us past the stop date.\n    if( date.isBefore( stop ) ) { \n        dates.add( date ) ;\n    }\n}\n</code></pre>\n<h1>Performance</h1>\n<p>I am curious about the performance of the various approach in various Answers on this page. I am considering only the modern <em>java.time</em> code, not the code using troublesome legacy <code>Date</code>/<code>Calendar</code> classes.</p>\n<p>Here are four methods that each return the number of days elapsed.</p>\n<p>One uses the clever math-based approach seen in the <a href=\"https://stackoverflow.com/a/44942039/642706\">Answer by Roland</a>.</p>\n<pre><code>private long countWeekDaysMath ( LocalDate start , LocalDate stop ) {\n    // Code taken from Answer by Roland.\n    // https://stackoverflow.com/a/44942039/642706\n    long count = 0;\n    final DayOfWeek startW = start.getDayOfWeek();\n    final DayOfWeek stopW = stop.getDayOfWeek();\n\n    final long days = ChronoUnit.DAYS.between( start , stop );\n    final long daysWithoutWeekends = days - 2 * ( ( days + startW.getValue() ) / 7 );\n\n    //adjust for starting and ending on a Sunday:\n    count = daysWithoutWeekends + ( startW == DayOfWeek.SUNDAY ? 1 : 0 ) + ( stopW == DayOfWeek.SUNDAY ? 1 : 0 );\n\n    return count;\n}\n</code></pre>\n<p>Two use approaches seen in this Answer of mine: (a) Visit each date, incrementing one-by-one in a conventional loop.</p>\n<pre><code>private long countWeekDaysVisit ( LocalDate start , LocalDate stop ) {\n    // Code taken from Answer by Basil Bourque.\n    // https://stackoverflow.com/a/40369140/642706\n    long count = 0;\n    Set &lt; DayOfWeek &gt; weekend = EnumSet.of( DayOfWeek.SATURDAY , DayOfWeek.SUNDAY );\n    LocalDate ld = start;\n    while ( ld.isBefore( stop ) ) {\n        if ( ! weekend.contains( ld.getDayOfWeek() ) ) { // If not weekend, collect this LocalDate.\n            count++;\n        }\n        // Prepare for next loop.\n        ld = ld.plusDays( 1 ); // Increment to next day.\n    }\n    return count;\n}\n</code></pre>\n<p>…and, (b) Using the <code>TemporalAdjuster</code> implementation <code>org.threeten.extra.Temporals.nextWorkingDay()</code>.</p>\n<pre><code>private long countWeekDaysAdjuster ( LocalDate start , LocalDate stop ) {\n    // Code taken from Answer by Basil Bourque.\n    // https://stackoverflow.com/a/40369140/642706\n    long count = 0;\n    Set &lt; DayOfWeek &gt; weekend = EnumSet.of( DayOfWeek.SATURDAY , DayOfWeek.SUNDAY );\n    TemporalAdjuster nextWorkingDayTA = org.threeten.extra.Temporals.nextWorkingDay();\n    LocalDate ld = start;\n    if ( weekend.contains( ld.getDayOfWeek() ) ) {\n        ld = ld.with( nextWorkingDayTA );\n    }\n    while ( ld.isBefore( stop ) ) {\n        count++;\n        // Prepare for next loop.\n        ld = ld.with( nextWorkingDayTA ); // Increment to next working day (non-weekend day).\n    }\n    return count;\n}\n</code></pre>\n<p>The last uses Java Streams approach seen in the <a href=\"https://stackoverflow.com/a/51010738/642706\">Answer by Ravindra Ranwala</a>.</p>\n<pre><code>private long countWeekDaysStream ( LocalDate start , LocalDate stop ) {\n    // Code taken from the Answer by Ravindra Ranwala.\n    // https://stackoverflow.com/a/51010738/642706\n    long count = 0;\n    Set &lt; DayOfWeek &gt; weekend = EnumSet.of( DayOfWeek.SATURDAY , DayOfWeek.SUNDAY );\n    final long weekDaysBetween = start.datesUntil( stop )\n                                     .filter( d -&gt; ! weekend.contains( d.getDayOfWeek() ) )\n                                     .count();\n    return count;\n}\n</code></pre>\n<p>And the test harness.</p>\n<p><strong>Caveats:</strong></p>\n<ul>\n<li>Well, the usual caveats about micro-benchmarking being untrustworthy, prone to unjustified or unrealistic conclusions.</li>\n<li>I wish I'd learned to use the <a href=\"http://openjdk.java.net/projects/code-tools/jmh/\" rel=\"noreferrer\"><em>JMH</em> micro-benchmarking framework</a>.</li>\n<li>I have not bothered to try optimizing any of this code. For example, in real work, the <code>TemporalAdjuster</code> could be cached outside our method.</li>\n</ul>\n<p>Test harness.</p>\n<pre><code>LocalDate start = LocalDate.of( 2018 , Month.JANUARY , 1 );\nLocalDate stop = start.plusYears( 1 );\n\nint runs = 100_000;\n\nlong go = System.nanoTime();\nfor ( int i = 1 ; i &lt;= runs ; i++ ) {\n    long count = this.countWeekDaysMath( start , stop );\n}\nlong elapsedMath = ( System.nanoTime() - go );\n\ngo = System.nanoTime();\nfor ( int i = 1 ; i &lt;= runs ; i++ ) {\n    long count = this.countWeekDaysVisit( start , stop );\n}\nlong elapsedVisit = ( System.nanoTime() - go );\n\ngo = System.nanoTime();\nfor ( int i = 1 ; i &lt;= runs ; i++ ) {\n    long count = this.countWeekDaysStream( start , stop );\n}\nlong elapsedAdjuster = ( System.nanoTime() - go );\n\ngo = System.nanoTime();\nfor ( int i = 1 ; i &lt;= runs ; i++ ) {\n    long count = this.countWeekDaysStream( start , stop );\n}\nlong elapsedStream = ( System.nanoTime() - go );\n\nSystem.out.println( &quot;math: &quot; + elapsedMath + &quot; each: &quot; + ( elapsedMath / runs ) );\nSystem.out.println( &quot;visit: &quot; + elapsedVisit + &quot; each: &quot; + ( elapsedVisit / runs ) );\nSystem.out.println( &quot;adjuster: &quot; + elapsedAdjuster + &quot; each: &quot; + ( elapsedAdjuster / runs ) );\nSystem.out.println( &quot;stream: &quot; + elapsedStream + &quot; each: &quot; + ( elapsedStream / runs ) );\n</code></pre>\n<p>When run on my MacBook Pro (Sierra) with Oracle JDK 10.0.1 and <em>ThreeTen-Extra</em> version 1.3.2, I get results consistently close to the following. The <strong>math solution is a tiny fraction of the others</strong> at a couple hundred nanos versus several thousand, as we would expect obviously. Of the other three, the <strong><code>TemporalAdjuster</code> is the longest</strong>, always over 10,000 nanos each. The visit and stream both come in well under that 10,000 nanos each, with visit being noticeably faster than streams. As seen in other examples around the internets, <strong>Java Streams usually make for nifty short code while often running significantly longer</strong>, about 20% longer in this case.</p>\n<blockquote>\n<p>math: 18313309 each: 183</p>\n</blockquote>\n<blockquote>\n<p>visit: 708420626 each: 7084</p>\n</blockquote>\n<blockquote>\n<p>adjuster: 1002157240 each: 10021</p>\n</blockquote>\n<blockquote>\n<p>stream: 924724750 each: 9247</p>\n</blockquote>\n<hr />\n<h1>About java.time</h1>\n<p>The <a href=\"http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html\" rel=\"noreferrer\">java.time</a> framework is built into Java 8 and later. These classes supplant the troublesome old <a href=\"https://en.wikipedia.org/wiki/Legacy_system\" rel=\"noreferrer\">legacy</a> date-time classes such as <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Date.html\" rel=\"noreferrer\"><code>java.util.Date</code></a>, <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Calendar.html\" rel=\"noreferrer\"><code>Calendar</code></a>, &amp; <a href=\"http://docs.oracle.com/javase/8/docs/api/java/text/SimpleDateFormat.html\" rel=\"noreferrer\"><code>SimpleDateFormat</code></a>.</p>\n<p>The <a href=\"http://www.joda.org/joda-time/\" rel=\"noreferrer\">Joda-Time</a> project, now in <a href=\"https://en.wikipedia.org/wiki/Maintenance_mode\" rel=\"noreferrer\">maintenance mode</a>, advises migration to java.time.</p>\n<p>To learn more, see the <a href=\"http://docs.oracle.com/javase/tutorial/datetime/TOC.html\" rel=\"noreferrer\">Oracle Tutorial</a>. And search Stack Overflow for many examples and explanations. Specification is <a href=\"https://jcp.org/en/jsr/detail?id=310\" rel=\"noreferrer\">JSR 310</a>.</p>\n<p>Where to obtain the java.time classes?</p>\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Java_version_history#Java_SE_8\" rel=\"noreferrer\"><strong>Java SE 8</strong></a> and <a href=\"https://en.wikipedia.org/wiki/Java_version_history#Java_SE_9\" rel=\"noreferrer\"><strong>SE 9</strong></a> and later</li>\n<li>Built-in.</li>\n<li>Part of the standard Java API with a bundled implementation.</li>\n<li>Java 9 adds some minor features and fixes.</li>\n<li><a href=\"https://en.wikipedia.org/wiki/Java_version_history#Java_SE_6\" rel=\"noreferrer\"><strong>Java SE 6</strong></a> and <a href=\"https://en.wikipedia.org/wiki/Java_version_history#Java_SE_7\" rel=\"noreferrer\"><strong>SE 7</strong></a></li>\n<li>Much of the java.time functionality is back-ported to Java 6 &amp; 7 in <a href=\"http://www.threeten.org/threetenbp/\" rel=\"noreferrer\"><em><strong>ThreeTen-Backport</strong></em></a>.</li>\n<li><a href=\"https://en.wikipedia.org/wiki/Android_(operating_system)\" rel=\"noreferrer\"><strong>Android</strong></a></li>\n<li>The <a href=\"https://github.com/JakeWharton/ThreeTenABP\" rel=\"noreferrer\"><em>ThreeTenABP</em></a> project adapts <em><strong>ThreeTen-Backport</strong></em> (mentioned above) for Android specifically.</li>\n<li>See <a href=\"https://stackoverflow.com/q/38922754/642706\"><em>How to use…</em></a>.</li>\n</ul>\n<p>The <a href=\"http://www.threeten.org/threeten-extra/\" rel=\"noreferrer\">ThreeTen-Extra</a> project extends java.time with additional classes. This project is a proving ground for possible future additions to java.time. You may find some useful classes here such as <a href=\"http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/Interval.html\" rel=\"noreferrer\"><code>Interval</code></a>, <a href=\"http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/YearWeek.html\" rel=\"noreferrer\"><code>YearWeek</code></a>, <a href=\"http://www.threeten.org/threeten-extra/apidocs/org/threeten/extra/YearQuarter.html\" rel=\"noreferrer\"><code>YearQuarter</code></a>, and <a href=\"http://www.threeten.org/threeten-extra/apidocs/index.html\" rel=\"noreferrer\">more</a>.</p>\n"},{"tags":[],"owner":{"account_id":4474787,"reputation":7719,"user_id":3640161,"accept_rate":61,"display_name":"Tiago Lopo"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1490112885,"creation_date":1490112885,"answer_id":42932622,"question_id":4600034,"body_markdown":"In groovy: \r\n\r\n      public static int getWorkingDaysBetweenDates (Date start, Date end) {\r\n        def totalDays = (Integer) (end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)\r\n        def int workingDays = 0\r\n    \r\n        (0..totalDays).each { def dow = (start + it)[Calendar.DAY_OF_WEEK]; if(dow != Calendar.SATURDAY &amp;&amp; dow != Calendar.SUNDAY){workingDays++} }\r\n     \r\n        workingDays\r\n      }","title":"Calculate number of weekdays between two dates in Java","body":"<p>In groovy: </p>\n\n<pre><code>  public static int getWorkingDaysBetweenDates (Date start, Date end) {\n    def totalDays = (Integer) (end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)\n    def int workingDays = 0\n\n    (0..totalDays).each { def dow = (start + it)[Calendar.DAY_OF_WEEK]; if(dow != Calendar.SATURDAY &amp;&amp; dow != Calendar.SUNDAY){workingDays++} }\n\n    workingDays\n  }\n</code></pre>\n"},{"comments":[{"owner":{"account_id":6388428,"reputation":290,"user_id":4955513,"accept_rate":73,"display_name":"shanti"},"score":2,"creation_date":1519563234,"post_id":44942039,"comment_id":84952124,"body_markdown":"If both start and end date falls on Saturday, or both on Sunday, then it gives wrong result.","body":"If both start and end date falls on Saturday, or both on Sunday, then it gives wrong result."},{"owner":{"account_id":222360,"reputation":7615,"user_id":480894,"accept_rate":72,"display_name":"Roland"},"score":2,"creation_date":1519990000,"post_id":44942039,"comment_id":85141209,"body_markdown":"@shanti it should be fixed now. Thanks again for pointing this out.","body":"@shanti it should be fixed now. Thanks again for pointing this out."},{"owner":{"account_id":1253772,"reputation":1206,"user_id":1213655,"display_name":"Pratyush"},"score":1,"creation_date":1550170065,"post_id":44942039,"comment_id":96181490,"body_markdown":"@Roland Thanks for the answer, I&#39;ve used it to calculate weekend days between dates in PHP  - https://stackoverflow.com/a/54697180/1213655","body":"@Roland Thanks for the answer, I&#39;ve used it to calculate weekend days between dates in PHP  - <a href=\"https://stackoverflow.com/a/54697180/1213655\">stackoverflow.com/a/54697180/1213655</a>"},{"owner":{"account_id":3726872,"reputation":641,"user_id":3100538,"accept_rate":59,"display_name":"PentiumPro200"},"score":0,"creation_date":1601235721,"post_id":44942039,"comment_id":113336768,"body_markdown":"Does the first solution give the right result if start day is Friday and end day is Sunday?","body":"Does the first solution give the right result if start day is Friday and end day is Sunday?"},{"owner":{"account_id":222360,"reputation":7615,"user_id":480894,"accept_rate":72,"display_name":"Roland"},"score":0,"creation_date":1601289833,"post_id":44942039,"comment_id":113351272,"body_markdown":"@PentiumPro200 try it.","body":"@PentiumPro200 try it."},{"owner":{"account_id":3726872,"reputation":641,"user_id":3100538,"accept_rate":59,"display_name":"PentiumPro200"},"score":0,"creation_date":1601492771,"post_id":44942039,"comment_id":113428666,"body_markdown":"@Roland - It gives 1.  I guess that is correct based on ChronoUnit&#39;s definition of between.  I was earlier thinking that days between excludes both the start and end day.  For example, the number of days between Monday and Wednesday would be 1, not 2.  But I guess it&#39;s actually 2 according to ChronoUnit&#39;s definition.","body":"@Roland - It gives 1.  I guess that is correct based on ChronoUnit&#39;s definition of between.  I was earlier thinking that days between excludes both the start and end day.  For example, the number of days between Monday and Wednesday would be 1, not 2.  But I guess it&#39;s actually 2 according to ChronoUnit&#39;s definition."}],"tags":[],"owner":{"account_id":222360,"reputation":7615,"user_id":480894,"accept_rate":72,"display_name":"Roland"},"comment_count":6,"down_vote_count":0,"up_vote_count":25,"is_accepted":false,"score":25,"last_activity_date":1533277958,"creation_date":1499325055,"answer_id":44942039,"question_id":4600034,"body_markdown":"Solution without loop in 5 lines of code\r\n========================================\r\n\r\nDays between are defined in the same way as `ChronoUnit.DAYS.between(start, end)` which means there are `4` days between Monday and Friday. Since we are only interested in weekdays we have to subtract weekends, therefore from Friday until Tuesday there will be `2` weekdays(just compute `endDay - startDay` and subtract `2` for the weekend). Add `1` to the result if you want an *inclusive* result, i.e. not days between.\r\n\r\nI present two solutions.\r\n\r\n**First solution (5-liner, short and cryptic):**\r\n\r\n    import java.time.*;\r\n    import java.time.temporal.*;\r\n\r\n    public static long calcWeekDays1(final LocalDate start, final LocalDate end) {\r\n        final DayOfWeek startW = start.getDayOfWeek();\r\n        final DayOfWeek endW = end.getDayOfWeek();\r\n    \r\n        final long days = ChronoUnit.DAYS.between(start, end);\r\n        final long daysWithoutWeekends = days - 2 * ((days + startW.getValue())/7);\r\n    \r\n        //adjust for starting and ending on a Sunday:\r\n        return daysWithoutWeekends + (startW == DayOfWeek.SUNDAY ? 1 : 0) + (endW == DayOfWeek.SUNDAY ? 1 : 0);\r\n    }\r\n\r\n**Second solution:**\r\n\r\n    public static long calcWeekDays2(final LocalDate start, final LocalDate end) {\r\n        final int startW = start.getDayOfWeek().getValue();\r\n        final int endW = end.getDayOfWeek().getValue();\r\n\r\n        final long days = ChronoUnit.DAYS.between(start, end);\r\n        long result = days - 2*(days/7); //remove weekends\r\n\r\n        if (days % 7 != 0) { //deal with the rest days\r\n            if (startW == 7) {\r\n                result -= 1;\r\n            } else if (endW == 7) {  //they can&#39;t both be Sunday, otherwise rest would be zero\r\n                result -= 1;\r\n            } else if (endW &lt; startW) { //another weekend is included\r\n                result -= 2;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n","title":"Calculate number of weekdays between two dates in Java","body":"<h1>Solution without loop in 5 lines of code</h1>\n\n<p>Days between are defined in the same way as <code>ChronoUnit.DAYS.between(start, end)</code> which means there are <code>4</code> days between Monday and Friday. Since we are only interested in weekdays we have to subtract weekends, therefore from Friday until Tuesday there will be <code>2</code> weekdays(just compute <code>endDay - startDay</code> and subtract <code>2</code> for the weekend). Add <code>1</code> to the result if you want an <em>inclusive</em> result, i.e. not days between.</p>\n\n<p>I present two solutions.</p>\n\n<p><strong>First solution (5-liner, short and cryptic):</strong></p>\n\n<pre><code>import java.time.*;\nimport java.time.temporal.*;\n\npublic static long calcWeekDays1(final LocalDate start, final LocalDate end) {\n    final DayOfWeek startW = start.getDayOfWeek();\n    final DayOfWeek endW = end.getDayOfWeek();\n\n    final long days = ChronoUnit.DAYS.between(start, end);\n    final long daysWithoutWeekends = days - 2 * ((days + startW.getValue())/7);\n\n    //adjust for starting and ending on a Sunday:\n    return daysWithoutWeekends + (startW == DayOfWeek.SUNDAY ? 1 : 0) + (endW == DayOfWeek.SUNDAY ? 1 : 0);\n}\n</code></pre>\n\n<p><strong>Second solution:</strong></p>\n\n<pre><code>public static long calcWeekDays2(final LocalDate start, final LocalDate end) {\n    final int startW = start.getDayOfWeek().getValue();\n    final int endW = end.getDayOfWeek().getValue();\n\n    final long days = ChronoUnit.DAYS.between(start, end);\n    long result = days - 2*(days/7); //remove weekends\n\n    if (days % 7 != 0) { //deal with the rest days\n        if (startW == 7) {\n            result -= 1;\n        } else if (endW == 7) {  //they can't both be Sunday, otherwise rest would be zero\n            result -= 1;\n        } else if (endW &lt; startW) { //another weekend is included\n            result -= 2;\n        }\n    }\n\n    return result;\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":1,"creation_date":1529866540,"post_id":51010738,"comment_id":89018716,"body_markdown":"I like this Answer for the simplest and shortest code. But this is likely the slowest: (A) every date is being considered, whereas some other Answers were trying to be clever in calculating the total without visiting each date. (B) Java Steams are often slower than alternate code, sometimes by many fold. So if using large amounts of data or running often, test for performance. Otherwise I would use this approach for small amounts of data ran less often.","body":"I like this Answer for the simplest and shortest code. But this is likely the slowest: (A) every date is being considered, whereas some other Answers were trying to be clever in calculating the total without visiting each date. (B) Java Steams are often slower than alternate code, sometimes by many fold. So if using large amounts of data or running often, test for performance. Otherwise I would use this approach for small amounts of data ran less often."},{"owner":{"account_id":5126886,"reputation":20904,"user_id":4108590,"accept_rate":57,"display_name":"Ravindra Ranwala"},"score":0,"creation_date":1529892887,"post_id":51010738,"comment_id":89023695,"body_markdown":"@BasilBourque I agree with you up to certain extent. Yes this solution considers every date. But this approach is much more parallel friendly. So, we can gain the parallel speedup by executing it in parallel if needed.","body":"@BasilBourque I agree with you up to certain extent. Yes this solution considers every date. But this approach is much more parallel friendly. So, we can gain the parallel speedup by executing it in parallel if needed."},{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":1,"creation_date":1529962049,"post_id":51010738,"comment_id":89056378,"body_markdown":"Parallelizing across cores shortens elapsed time of execution (wall-clock time) but does *not* reduce the burden on the CPU, assuming you have cores available at runtime. Indeed, parallelizing *adds* to CPU burden, for the overhead of coordinating the parallel work.","body":"Parallelizing across cores shortens elapsed time of execution (wall-clock time) but does <i>not</i> reduce the burden on the CPU, assuming you have cores available at runtime. Indeed, parallelizing <i>adds</i> to CPU burden, for the overhead of coordinating the parallel work."},{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":1,"creation_date":1529962070,"post_id":51010738,"comment_id":89056382,"body_markdown":"This thread caught my curiosity. So I tried out your Java Streams approach against Roland’s math-based approach, and my two approaches visiting each date and using a `TemporalAdjuster`. Roland&#39;s math wins by a long shot, of course, without comparison. Your Streams approach is about 20% slower than visiting each date in a conventional loop. But my `TemporalAdjuster` approach was always the slowest. See all my code and results in &quot;Performance&quot; section added to [my Answer](https://stackoverflow.com/a/40369140/642706).","body":"This thread caught my curiosity. So I tried out your Java Streams approach against Roland’s math-based approach, and my two approaches visiting each date and using a <code>TemporalAdjuster</code>. Roland&#39;s math wins by a long shot, of course, without comparison. Your Streams approach is about 20% slower than visiting each date in a conventional loop. But my <code>TemporalAdjuster</code> approach was always the slowest. See all my code and results in &quot;Performance&quot; section added to <a href=\"https://stackoverflow.com/a/40369140/642706\">my Answer</a>."},{"owner":{"account_id":5126886,"reputation":20904,"user_id":4108590,"accept_rate":57,"display_name":"Ravindra Ranwala"},"score":0,"creation_date":1529979069,"post_id":51010738,"comment_id":89060022,"body_markdown":"@BasilBourque Yes, parallel execution takes more CPU cycles to compute the result faster. However that was a great benchmark.","body":"@BasilBourque Yes, parallel execution takes more CPU cycles to compute the result faster. However that was a great benchmark."},{"owner":{"account_id":5126886,"reputation":20904,"user_id":4108590,"accept_rate":57,"display_name":"Ravindra Ranwala"},"score":0,"creation_date":1614228830,"post_id":51010738,"comment_id":117323325,"body_markdown":"What is the asymptotic complexity of that math based approach? Mine is `Θ(n)`.","body":"What is the asymptotic complexity of that math based approach? Mine is <code>Θ(n)</code>."}],"tags":[],"owner":{"account_id":5126886,"reputation":20904,"user_id":4108590,"accept_rate":57,"display_name":"Ravindra Ranwala"},"comment_count":6,"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1529893029,"creation_date":1529849702,"answer_id":51010738,"question_id":4600034,"body_markdown":"Almost all the solutions are pretty much obsoleted and narrative. However here&#39;s a much condensed and readable solution. \r\n\r\nThis approach uses a [Java Stream](https://docs.oracle.com/javase/tutorial/collections/streams/#pipelines) provided by the [`LocalDate::datesUntil`](https://docs.oracle.com/../../java/time/LocalDate.html#datesUntil-java.time.LocalDate-) method built into in Java 9 and later. \r\n\r\n    LocalDate startDate = LocalDate.of(2018, 5, 2);\r\n    LocalDate endDate = LocalDate.now();\r\n    Set&lt;DayOfWeek&gt; weekend = EnumSet.of(DayOfWeek.SATURDAY, DayOfWeek.SUNDAY);\r\n    final long weekDaysBetween = startDate.datesUntil(endDate)\r\n    \t\t.filter(d -&gt; !weekend.contains(d.getDayOfWeek()))\r\n    \t\t.count();\r\n\r\n\r\n&gt; `.datesUntil` returns a sequential ordered stream of dates. The\r\n&gt; returned stream starts from this date (inclusive) and goes to\r\n&gt; endExclusive (exclusive) by an incremental step of 1 day.\r\n\r\nThen all the Saturdays and Sundays are filtered out. Final step is to get the count of the remaining week days.\r\n\r\nJava-9 has been released one year ago, since using it now seems reasonable to me.","title":"Calculate number of weekdays between two dates in Java","body":"<p>Almost all the solutions are pretty much obsoleted and narrative. However here's a much condensed and readable solution. </p>\n\n<p>This approach uses a <a href=\"https://docs.oracle.com/javase/tutorial/collections/streams/#pipelines\" rel=\"noreferrer\">Java Stream</a> provided by the <a href=\"https://docs.oracle.com/../../java/time/LocalDate.html#datesUntil-java.time.LocalDate-\" rel=\"noreferrer\"><code>LocalDate::datesUntil</code></a> method built into in Java 9 and later. </p>\n\n<pre><code>LocalDate startDate = LocalDate.of(2018, 5, 2);\nLocalDate endDate = LocalDate.now();\nSet&lt;DayOfWeek&gt; weekend = EnumSet.of(DayOfWeek.SATURDAY, DayOfWeek.SUNDAY);\nfinal long weekDaysBetween = startDate.datesUntil(endDate)\n        .filter(d -&gt; !weekend.contains(d.getDayOfWeek()))\n        .count();\n</code></pre>\n\n<blockquote>\n  <p><code>.datesUntil</code> returns a sequential ordered stream of dates. The\n  returned stream starts from this date (inclusive) and goes to\n  endExclusive (exclusive) by an incremental step of 1 day.</p>\n</blockquote>\n\n<p>Then all the Saturdays and Sundays are filtered out. Final step is to get the count of the remaining week days.</p>\n\n<p>Java-9 has been released one year ago, since using it now seems reasonable to me.</p>\n"},{"tags":[],"owner":{"account_id":1476930,"reputation":9005,"user_id":1387113,"accept_rate":100,"display_name":"hd84335"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1532959169,"creation_date":1532959169,"answer_id":51595686,"question_id":4600034,"body_markdown":"Using `java 8` it can be easily done, example function:\r\n\r\n    long getBusinessDaysDifference(LocalDate startDate, LocalDate endDate) { \r\n\r\n        EnumSet&lt;DayOfWeek&gt; weekend = EnumSet.of(DayOfWeek.SATURDAY, DayOfWeek.SUNDAY);\r\n\t    List&lt;LocalDate&gt; list = Lists.newArrayList();\r\n    \r\n\t    LocalDate start = startDate; \t\t\r\n        while (start.isBefore(endDate)) {\r\n \t\t\tlist.add(start);\r\n \t\t\tstart = start.plus(1, ChronoUnit.DAYS);\r\n\t    }\r\n    \r\n        long numberOfDays = list.stream().filter(d -&gt; !weekend.contains(d.getDayOfWeek())).count();\r\n    \r\n        return numberOfDays;\r\n    }\r\n\r\nDescription:\r\n\r\n1. Define your `off-days` in an `EnumSet` (*weekends* in this case).\r\n2. Create a list holding all the days between the *startDate* and *endDate*.\r\n3. Reduce the outcome list by removing any occurrence of a day from the `EnumSet`.\r\n4. Then finally count the size of this reduced list.\r\n\r\n\r\n*Note: this function can be optimized, but might be helpful as a starting point*.\r\n","title":"Calculate number of weekdays between two dates in Java","body":"<p>Using <code>java 8</code> it can be easily done, example function:</p>\n\n<pre><code>long getBusinessDaysDifference(LocalDate startDate, LocalDate endDate) { \n\n    EnumSet&lt;DayOfWeek&gt; weekend = EnumSet.of(DayOfWeek.SATURDAY, DayOfWeek.SUNDAY);\n    List&lt;LocalDate&gt; list = Lists.newArrayList();\n\n    LocalDate start = startDate;        \n    while (start.isBefore(endDate)) {\n        list.add(start);\n        start = start.plus(1, ChronoUnit.DAYS);\n    }\n\n    long numberOfDays = list.stream().filter(d -&gt; !weekend.contains(d.getDayOfWeek())).count();\n\n    return numberOfDays;\n}\n</code></pre>\n\n<p>Description:</p>\n\n<ol>\n<li>Define your <code>off-days</code> in an <code>EnumSet</code> (<em>weekends</em> in this case).</li>\n<li>Create a list holding all the days between the <em>startDate</em> and <em>endDate</em>.</li>\n<li>Reduce the outcome list by removing any occurrence of a day from the <code>EnumSet</code>.</li>\n<li>Then finally count the size of this reduced list.</li>\n</ol>\n\n<p><em>Note: this function can be optimized, but might be helpful as a starting point</em>.</p>\n"},{"comments":[{"owner":{"account_id":16678546,"reputation":470,"user_id":12054309,"display_name":"Kosonome"},"score":0,"creation_date":1577730874,"post_id":52100097,"comment_id":105240263,"body_markdown":"Like you said, any other code have some strange fails. I rewrote this code using java 7 and this algorithm worked, thanks.","body":"Like you said, any other code have some strange fails. I rewrote this code using java 7 and this algorithm worked, thanks."},{"owner":{"account_id":7170330,"reputation":81,"user_id":5478011,"display_name":"Amir Kadić"},"score":0,"creation_date":1611754581,"post_id":52100097,"comment_id":116551873,"body_markdown":"I went ahead and added these tests to my suite and they (as well as many others) all work. The algorithm expects inclusive date intervals though, e.g. there are 5 days &quot;between&quot; Monday and Friday. Also, here&#39;s a formal proof that the algorithm works: https://amir.a-ware.dev/calculating-the-number-of-specific-weekdays-between-two-dates.html#calculating-the-number-of-specific-weekdays-between-two-dates.","body":"I went ahead and added these tests to my suite and they (as well as many others) all work. The algorithm expects inclusive date intervals though, e.g. there are 5 days &quot;between&quot; Monday and Friday. Also, here&#39;s a formal proof that the algorithm works: <a href=\"https://amir.a-ware.dev/calculating-the-number-of-specific-weekdays-between-two-dates.html#calculating-the-number-of-specific-weekdays-between-two-dates\" rel=\"nofollow noreferrer\">amir.a-ware.dev/&hellip;</a>."},{"owner":{"account_id":5686042,"reputation":73,"user_id":4495583,"display_name":"Guillaume Deshors"},"score":0,"creation_date":1612171229,"post_id":52100097,"comment_id":116673315,"body_markdown":"Hi @AmirKadić, thanks for your input. I went ahead too and tested again your code, with the same results : these tests don&#39;t pass. They all yield one more than my code, except the two tests after &quot;start on saturday&quot; and &quot;start on sunday&quot; which yield 0 like my code. This may be the result of this &quot;inclusive date intervals&quot; logic you insist on, and if you&#39;ve proven it it certainly is coherent and right, I&#39;ve not read your proof, but it is not what I needed at the time, and my logic seems coherent to me. But I don&#39;t get how you can say that these tests work for you.","body":"Hi @AmirKadić, thanks for your input. I went ahead too and tested again your code, with the same results : these tests don&#39;t pass. They all yield one more than my code, except the two tests after &quot;start on saturday&quot; and &quot;start on sunday&quot; which yield 0 like my code. This may be the result of this &quot;inclusive date intervals&quot; logic you insist on, and if you&#39;ve proven it it certainly is coherent and right, I&#39;ve not read your proof, but it is not what I needed at the time, and my logic seems coherent to me. But I don&#39;t get how you can say that these tests work for you."},{"owner":{"account_id":7170330,"reputation":81,"user_id":5478011,"display_name":"Amir Kadić"},"score":0,"creation_date":1612292570,"post_id":52100097,"comment_id":116719888,"body_markdown":"Inclusive intervals inherently contain one or two days more than exclusive ones, depending on the definition of the interval. There are at least 3 ways to define an interval. 1) Fully exclusive. There are 3 days (TU, WE, TH) between Monday and Friday. 2) Semi-inclusive. There are 4 days (MO, TU, WE, TH or TU, WE, TH, FR) 3) Fully inclusive There are 5 days. The implementation I&#39;ve provided is fully inclusive so test expectations need to be changed accordingly. If you need different intervals, let me know which one. The nice thing about this algorithm is that it completes in constant time.","body":"Inclusive intervals inherently contain one or two days more than exclusive ones, depending on the definition of the interval. There are at least 3 ways to define an interval. 1) Fully exclusive. There are 3 days (TU, WE, TH) between Monday and Friday. 2) Semi-inclusive. There are 4 days (MO, TU, WE, TH or TU, WE, TH, FR) 3) Fully inclusive There are 5 days. The implementation I&#39;ve provided is fully inclusive so test expectations need to be changed accordingly. If you need different intervals, let me know which one. The nice thing about this algorithm is that it completes in constant time."},{"owner":{"account_id":5686042,"reputation":73,"user_id":4495583,"display_name":"Guillaume Deshors"},"score":0,"creation_date":1612355580,"post_id":52100097,"comment_id":116739854,"body_markdown":"I see, so these tests I wrote would be qualified semi-inclusive, I guess. And that&#39;s probably the root cause for misunderstanding along this thread, the problem wasn&#39;t specified enough.","body":"I see, so these tests I wrote would be qualified semi-inclusive, I guess. And that&#39;s probably the root cause for misunderstanding along this thread, the problem wasn&#39;t specified enough."},{"owner":{"account_id":7170330,"reputation":81,"user_id":5478011,"display_name":"Amir Kadić"},"score":0,"creation_date":1612376208,"post_id":52100097,"comment_id":116750339,"body_markdown":"Yes, the original problem is insufficiently specified. I&#39;ve added examples of how to work with all 4 types of intervals to my answer. Most of your test cases work for semi-inclusive intervals that skip the last day but the cases #4 and #5 (the ones that end on a weekend) expect that the first day of the interval is skipped or both the first and the last day - otherwise you&#39;d have to expect 3 working days, not 2. This inconsistency may be the sign of a bug. Does your implementation still work when you consistently use the same kind of interval?","body":"Yes, the original problem is insufficiently specified. I&#39;ve added examples of how to work with all 4 types of intervals to my answer. Most of your test cases work for semi-inclusive intervals that skip the last day but the cases #4 and #5 (the ones that end on a weekend) expect that the first day of the interval is skipped or both the first and the last day - otherwise you&#39;d have to expect 3 working days, not 2. This inconsistency may be the sign of a bug. Does your implementation still work when you consistently use the same kind of interval?"}],"tags":[],"owner":{"account_id":5686042,"reputation":73,"user_id":4495583,"display_name":"Guillaume Deshors"},"comment_count":6,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1535641097,"creation_date":1535641097,"answer_id":52100097,"question_id":4600034,"body_markdown":"This thread is filled with failing solutions... I started by writing a little test file which met my needs, and saw that Roland&#39;s both solutions fails, Amir&#39;s too. I wanted a solution that uses java 8 and that *does not uses loops* because, do I have to say why ?\r\n\r\nSo here&#39;s the test file : \r\n\r\n    @Test\r\n\tpublic void test() {\r\n\t\tLocalDate d1 = LocalDate.of(2018, 8, 1);\r\n\t\tLocalDate d2 = LocalDate.of(2018, 8, 2);\r\n\t\tLocalDate d3 = LocalDate.of(2018, 8, 3);\r\n\t\tLocalDate d4 = LocalDate.of(2018, 8, 4);\r\n\t\tLocalDate d5 = LocalDate.of(2018, 8, 5);\r\n\t\tLocalDate d6 = LocalDate.of(2018, 8, 6);\r\n\t\tLocalDate d7 = LocalDate.of(2018, 8, 7);\r\n\t\tLocalDate d8 = LocalDate.of(2018, 8, 8);\r\n\t\tLocalDate d9 = LocalDate.of(2018, 8, 9);\r\n\t\tLocalDate d10 = LocalDate.of(2018, 8, 10);\r\n\t\tLocalDate d15 = LocalDate.of(2018, 8, 15);\r\n\t\tLocalDate dsep = LocalDate.of(2018, 9, 5);\r\n\r\n\t\t// same day : 0 days between\r\n\t\tAssert.assertEquals(0, DateUtils.calcWeekDays1(d1, d1));\r\n\t\tAssert.assertEquals(1, DateUtils.calcWeekDays1(d1, d2));\r\n\t\tAssert.assertEquals(2, DateUtils.calcWeekDays1(d1, d3));\r\n\t\t// end on week-end \r\n\t\tAssert.assertEquals(2, DateUtils.calcWeekDays1(d1, d4));\r\n\t\tAssert.assertEquals(2, DateUtils.calcWeekDays1(d1, d5));\r\n\t\t// next week\r\n\t\tAssert.assertEquals(3, DateUtils.calcWeekDays1(d1, d6));\r\n\t\tAssert.assertEquals(4, DateUtils.calcWeekDays1(d1, d7));\r\n\t\tAssert.assertEquals(5, DateUtils.calcWeekDays1(d1, d8));\r\n\t\tAssert.assertEquals(6, DateUtils.calcWeekDays1(d1, d9));\r\n\t\tAssert.assertEquals(7, DateUtils.calcWeekDays1(d1, d10));\r\n\t\t// start on saturday\r\n\t\tAssert.assertEquals(0, DateUtils.calcWeekDays1(d4, d5));\r\n\t\tAssert.assertEquals(0, DateUtils.calcWeekDays1(d4, d6));\r\n\t\tAssert.assertEquals(1, DateUtils.calcWeekDays1(d4, d7));\r\n\t\t// start on sunday\r\n\t\tAssert.assertEquals(0, DateUtils.calcWeekDays1(d5, d5));\r\n\t\tAssert.assertEquals(0, DateUtils.calcWeekDays1(d5, d6));\r\n\t\tAssert.assertEquals(1, DateUtils.calcWeekDays1(d5, d7));\r\n\t\t// go to next week\r\n\t\tAssert.assertEquals(10, DateUtils.calcWeekDays1(d1, d15));\r\n\t\t// next month\r\n\t\tAssert.assertEquals(25, DateUtils.calcWeekDays1(d1, dsep));\r\n\t\t// start sat, go to next month\r\n\t\tAssert.assertEquals(22, DateUtils.calcWeekDays1(d4, dsep));\r\n\r\n\t}\r\n\r\nAnd here is my proposed solution, quite simple. Just let java count the number of weeks, multiply by five, and add the number of days needed to compensate the difference ; the only trick is adjusting the start and end to avoid week-ends :\r\n\r\n    public static long calcWeekDays1(LocalDate start, LocalDate end) {\r\n\t\tif (start.getDayOfWeek().getValue() &gt; 5) {\r\n\t\t\tstart = start.with(TemporalAdjusters.next(DayOfWeek.MONDAY));\r\n\t\t}\r\n\t\tif (end.getDayOfWeek().getValue() &gt; 5) {\r\n\t\t\tend = end.with(TemporalAdjusters.previous(DayOfWeek.FRIDAY));\r\n\t\t}\r\n\t\tif (start.isAfter(end)) { // may happen if you start sat. and end sunday\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tlong weeks = ChronoUnit.WEEKS.between(start, end);\r\n\t\tif (start.getDayOfWeek().getValue() &gt; end.getDayOfWeek().getValue()) {\r\n\t\t\tweeks += 1;\r\n\t\t}\r\n\t\treturn 5 * weeks + end.getDayOfWeek().getValue() - start.getDayOfWeek().getValue();\r\n\t}\r\n\r\nAnd now I will look stupid if my code fails too :)","title":"Calculate number of weekdays between two dates in Java","body":"<p>This thread is filled with failing solutions... I started by writing a little test file which met my needs, and saw that Roland's both solutions fails, Amir's too. I wanted a solution that uses java 8 and that <em>does not uses loops</em> because, do I have to say why ?</p>\n\n<p>So here's the test file : </p>\n\n<pre><code>@Test\npublic void test() {\n    LocalDate d1 = LocalDate.of(2018, 8, 1);\n    LocalDate d2 = LocalDate.of(2018, 8, 2);\n    LocalDate d3 = LocalDate.of(2018, 8, 3);\n    LocalDate d4 = LocalDate.of(2018, 8, 4);\n    LocalDate d5 = LocalDate.of(2018, 8, 5);\n    LocalDate d6 = LocalDate.of(2018, 8, 6);\n    LocalDate d7 = LocalDate.of(2018, 8, 7);\n    LocalDate d8 = LocalDate.of(2018, 8, 8);\n    LocalDate d9 = LocalDate.of(2018, 8, 9);\n    LocalDate d10 = LocalDate.of(2018, 8, 10);\n    LocalDate d15 = LocalDate.of(2018, 8, 15);\n    LocalDate dsep = LocalDate.of(2018, 9, 5);\n\n    // same day : 0 days between\n    Assert.assertEquals(0, DateUtils.calcWeekDays1(d1, d1));\n    Assert.assertEquals(1, DateUtils.calcWeekDays1(d1, d2));\n    Assert.assertEquals(2, DateUtils.calcWeekDays1(d1, d3));\n    // end on week-end \n    Assert.assertEquals(2, DateUtils.calcWeekDays1(d1, d4));\n    Assert.assertEquals(2, DateUtils.calcWeekDays1(d1, d5));\n    // next week\n    Assert.assertEquals(3, DateUtils.calcWeekDays1(d1, d6));\n    Assert.assertEquals(4, DateUtils.calcWeekDays1(d1, d7));\n    Assert.assertEquals(5, DateUtils.calcWeekDays1(d1, d8));\n    Assert.assertEquals(6, DateUtils.calcWeekDays1(d1, d9));\n    Assert.assertEquals(7, DateUtils.calcWeekDays1(d1, d10));\n    // start on saturday\n    Assert.assertEquals(0, DateUtils.calcWeekDays1(d4, d5));\n    Assert.assertEquals(0, DateUtils.calcWeekDays1(d4, d6));\n    Assert.assertEquals(1, DateUtils.calcWeekDays1(d4, d7));\n    // start on sunday\n    Assert.assertEquals(0, DateUtils.calcWeekDays1(d5, d5));\n    Assert.assertEquals(0, DateUtils.calcWeekDays1(d5, d6));\n    Assert.assertEquals(1, DateUtils.calcWeekDays1(d5, d7));\n    // go to next week\n    Assert.assertEquals(10, DateUtils.calcWeekDays1(d1, d15));\n    // next month\n    Assert.assertEquals(25, DateUtils.calcWeekDays1(d1, dsep));\n    // start sat, go to next month\n    Assert.assertEquals(22, DateUtils.calcWeekDays1(d4, dsep));\n\n}\n</code></pre>\n\n<p>And here is my proposed solution, quite simple. Just let java count the number of weeks, multiply by five, and add the number of days needed to compensate the difference ; the only trick is adjusting the start and end to avoid week-ends :</p>\n\n<pre><code>public static long calcWeekDays1(LocalDate start, LocalDate end) {\n    if (start.getDayOfWeek().getValue() &gt; 5) {\n        start = start.with(TemporalAdjusters.next(DayOfWeek.MONDAY));\n    }\n    if (end.getDayOfWeek().getValue() &gt; 5) {\n        end = end.with(TemporalAdjusters.previous(DayOfWeek.FRIDAY));\n    }\n    if (start.isAfter(end)) { // may happen if you start sat. and end sunday\n        return 0;\n    }\n    long weeks = ChronoUnit.WEEKS.between(start, end);\n    if (start.getDayOfWeek().getValue() &gt; end.getDayOfWeek().getValue()) {\n        weeks += 1;\n    }\n    return 5 * weeks + end.getDayOfWeek().getValue() - start.getDayOfWeek().getValue();\n}\n</code></pre>\n\n<p>And now I will look stupid if my code fails too :)</p>\n"},{"tags":[],"owner":{"account_id":11311035,"reputation":1860,"user_id":8294118,"accept_rate":100,"display_name":"user666"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1565952134,"creation_date":1551363862,"answer_id":54927860,"question_id":4600034,"body_markdown":"    public long getNumberOfWeekDayBetweenDates(LocalDate startDate, LocalDate endDate, String dayOfWeek) {\r\n            long result = -1;\r\n            if (startDate != null &amp;&amp; endDate != null &amp;&amp; dayOfWeek != null &amp;&amp; (startDate.isBefore(endDate) || startDate.isEqual(endDate))) {\r\n                java.time.DayOfWeek givenDayOfWeek = java.time.DayOfWeek.valueOf(dayOfWeek);\r\n                // find the first given day of week in the interval\r\n                LocalDate firstOccurrence = startDate.with(TemporalAdjusters.nextOrSame(givenDayOfWeek));\r\n                // similarly find last Monday\r\n                LocalDate lastOccurrence = endDate.with(TemporalAdjusters.previousOrSame(givenDayOfWeek));\r\n                if (firstOccurrence != null &amp;&amp; lastOccurrence != null) {\r\n                    // count the number of weeks between the first and last occurrence, then add 1 as end day is exclusive\r\n                    result = ChronoUnit.WEEKS.between(firstOccurrence, lastOccurrence) + 1;\r\n                } else if (firstOccurrence == null &amp;&amp; lastOccurrence == null) {\r\n                    // no occurrence\r\n                    result = 0;\r\n                } else {\r\n                    result = 1;\r\n                }\r\n            }\r\n            return result;\r\n        }","title":"Calculate number of weekdays between two dates in Java","body":"<pre><code>public long getNumberOfWeekDayBetweenDates(LocalDate startDate, LocalDate endDate, String dayOfWeek) {\n        long result = -1;\n        if (startDate != null &amp;&amp; endDate != null &amp;&amp; dayOfWeek != null &amp;&amp; (startDate.isBefore(endDate) || startDate.isEqual(endDate))) {\n            java.time.DayOfWeek givenDayOfWeek = java.time.DayOfWeek.valueOf(dayOfWeek);\n            // find the first given day of week in the interval\n            LocalDate firstOccurrence = startDate.with(TemporalAdjusters.nextOrSame(givenDayOfWeek));\n            // similarly find last Monday\n            LocalDate lastOccurrence = endDate.with(TemporalAdjusters.previousOrSame(givenDayOfWeek));\n            if (firstOccurrence != null &amp;&amp; lastOccurrence != null) {\n                // count the number of weeks between the first and last occurrence, then add 1 as end day is exclusive\n                result = ChronoUnit.WEEKS.between(firstOccurrence, lastOccurrence) + 1;\n            } else if (firstOccurrence == null &amp;&amp; lastOccurrence == null) {\n                // no occurrence\n                result = 0;\n            } else {\n                result = 1;\n            }\n        }\n        return result;\n    }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2078190,"reputation":1221,"user_id":1850930,"display_name":"jfajunior"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1562227347,"creation_date":1562227347,"answer_id":56883305,"question_id":4600034,"body_markdown":"Solution for Java 8 without loop and INCLUSIVE intervals: \r\n\r\n\tpublic long getDaysWithoutSundays(LocalDate startDate, LocalDate endDate) {\r\n\t\tlong numberOfDays = ChronoUnit.DAYS.between(startDate, endDate) + 1;\r\n\t\tlong numberOfSundays = numberOfDays / 7;\r\n\t\tlong rest = numberOfDays % 7;\r\n\t\tif (rest &gt; 0) {\r\n\t\t\tint startToEnd = startDate.getDayOfWeek().getValue() - endDate.getDayOfWeek().getValue();\r\n\t\t\tif (startToEnd &gt; 0) {\r\n\t\t\t\tnumberOfSundays++;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (endDate.getDayOfWeek().equals(DayOfWeek.SUNDAY)) {\r\n\t\t\t\t\tnumberOfSundays++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn numberOfDays - numberOfSundays;\r\n\t}","title":"Calculate number of weekdays between two dates in Java","body":"<p>Solution for Java 8 without loop and INCLUSIVE intervals: </p>\n\n<pre><code>public long getDaysWithoutSundays(LocalDate startDate, LocalDate endDate) {\n    long numberOfDays = ChronoUnit.DAYS.between(startDate, endDate) + 1;\n    long numberOfSundays = numberOfDays / 7;\n    long rest = numberOfDays % 7;\n    if (rest &gt; 0) {\n        int startToEnd = startDate.getDayOfWeek().getValue() - endDate.getDayOfWeek().getValue();\n        if (startToEnd &gt; 0) {\n            numberOfSundays++;\n        }\n        else {\n            if (endDate.getDayOfWeek().equals(DayOfWeek.SUNDAY)) {\n                numberOfSundays++;\n            }\n        }\n    }\n    return numberOfDays - numberOfSundays;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4218968,"reputation":4362,"user_id":3454208,"accept_rate":48,"display_name":"Varun"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1570524047,"creation_date":1570524047,"answer_id":58282879,"question_id":4600034,"body_markdown":"\r\n\r\n&lt;!-- begin snippet: js hide: false console: true babel: false --&gt;\r\n\r\n&lt;!-- language: lang-js --&gt;\r\n\r\n    import java.util.ArrayList;\r\n    import java.util.Calendar;\r\n    import java.util.Date;\r\n    import java.util.HashMap;\r\n    import java.util.List;\r\n\r\n    /**\r\n     * \r\n     * @author varun.vishwakarma\r\n     *\r\n     */\r\n    public class FindWeekendsInDateRange {\r\n    \tstatic HashMap&lt;Integer, String&gt; daysOfWeek=null;\r\n    \t\r\n    \t\r\n    \tstatic {\r\n    \t\tdaysOfWeek = new HashMap&lt;Integer, String&gt;();\r\n    \t\tdaysOfWeek.put(new Integer(1), &quot;Sun&quot;);\r\n    \t\tdaysOfWeek.put(new Integer(2), &quot;Mon&quot;);\r\n    \t\tdaysOfWeek.put(new Integer(3), &quot;Tue&quot;);\r\n    \t\tdaysOfWeek.put(new Integer(4), &quot;Wed&quot;);\r\n    \t\tdaysOfWeek.put(new Integer(5), &quot;Thu&quot;);\r\n    \t\tdaysOfWeek.put(new Integer(6), &quot;Fri&quot;);\r\n    \t\tdaysOfWeek.put(new Integer(7), &quot;Sat&quot;);\r\n    \t}\r\n\r\n    \t/**\r\n    \t * \r\n    \t * @param from_date \r\n    \t * @param to_date\r\n    \t * @return \r\n    \t */\r\n    \tpublic static List&lt;Date&gt;  calculateWeekendsInDateReange(Date fromDate, Date toDate) {\r\n    \t\tList&lt;Date&gt; listOfWeekends = new ArrayList&lt;Date&gt;();\r\n    \t\t\tCalendar from = Calendar.getInstance();\r\n    \t\t\tCalendar to = Calendar.getInstance();\r\n    \t\t\tfrom.setTime(fromDate);\r\n    \t\t\tto.setTime(toDate);\r\n    \t\t\twhile (from.getTimeInMillis() &lt; to.getTimeInMillis()) {\r\n    \t\t\t\tif (daysOfWeek.get(from.get(Calendar.DAY_OF_WEEK)) == &quot;Sat&quot;) {\r\n    \t\t\t\t\tDate sat = from.getTime();\r\n    \t\t\t\t\tlistOfWeekends.add(sat);\r\n    \t\t\t\t} else if (daysOfWeek.get(from.get(Calendar.DAY_OF_WEEK)) == &quot;Sun&quot;) {\r\n    \t\t\t\t\tDate sun = from.getTime();\r\n    \t\t\t\t\tlistOfWeekends.add(sun);\r\n    \t\t\t\t}\r\n    \t\t\t\tfrom.add(Calendar.DAY_OF_MONTH, 1);\r\n    \t\t\t}\r\n    \t\treturn listOfWeekends;\r\n    \t}\r\n    \tpublic static void main(String[] args) {\r\n    \t\tString fromDate = &quot;7-Oct-2019&quot;;\r\n    \t\tString toDate = &quot;25-Oct-2019&quot;;\r\n    \t\tSystem.out.println(FindWeekendsInDateRange.calculateWeekendsInDateReange(new Date(fromDate), new Date(toDate)));\r\n    \t\r\n\r\n    \t}\r\n\r\n    }\r\n\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\n","title":"Calculate number of weekdays between two dates in Java","body":"<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>import java.util.ArrayList;\r\nimport java.util.Calendar;\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\n\r\n/**\r\n * \r\n * @author varun.vishwakarma\r\n *\r\n */\r\npublic class FindWeekendsInDateRange {\r\n\tstatic HashMap&lt;Integer, String&gt; daysOfWeek=null;\r\n\t\r\n\t\r\n\tstatic {\r\n\t\tdaysOfWeek = new HashMap&lt;Integer, String&gt;();\r\n\t\tdaysOfWeek.put(new Integer(1), \"Sun\");\r\n\t\tdaysOfWeek.put(new Integer(2), \"Mon\");\r\n\t\tdaysOfWeek.put(new Integer(3), \"Tue\");\r\n\t\tdaysOfWeek.put(new Integer(4), \"Wed\");\r\n\t\tdaysOfWeek.put(new Integer(5), \"Thu\");\r\n\t\tdaysOfWeek.put(new Integer(6), \"Fri\");\r\n\t\tdaysOfWeek.put(new Integer(7), \"Sat\");\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param from_date \r\n\t * @param to_date\r\n\t * @return \r\n\t */\r\n\tpublic static List&lt;Date&gt;  calculateWeekendsInDateReange(Date fromDate, Date toDate) {\r\n\t\tList&lt;Date&gt; listOfWeekends = new ArrayList&lt;Date&gt;();\r\n\t\t\tCalendar from = Calendar.getInstance();\r\n\t\t\tCalendar to = Calendar.getInstance();\r\n\t\t\tfrom.setTime(fromDate);\r\n\t\t\tto.setTime(toDate);\r\n\t\t\twhile (from.getTimeInMillis() &lt; to.getTimeInMillis()) {\r\n\t\t\t\tif (daysOfWeek.get(from.get(Calendar.DAY_OF_WEEK)) == \"Sat\") {\r\n\t\t\t\t\tDate sat = from.getTime();\r\n\t\t\t\t\tlistOfWeekends.add(sat);\r\n\t\t\t\t} else if (daysOfWeek.get(from.get(Calendar.DAY_OF_WEEK)) == \"Sun\") {\r\n\t\t\t\t\tDate sun = from.getTime();\r\n\t\t\t\t\tlistOfWeekends.add(sun);\r\n\t\t\t\t}\r\n\t\t\t\tfrom.add(Calendar.DAY_OF_MONTH, 1);\r\n\t\t\t}\r\n\t\treturn listOfWeekends;\r\n\t}\r\n\tpublic static void main(String[] args) {\r\n\t\tString fromDate = \"7-Oct-2019\";\r\n\t\tString toDate = \"25-Oct-2019\";\r\n\t\tSystem.out.println(FindWeekendsInDateRange.calculateWeekendsInDateReange(new Date(fromDate), new Date(toDate)));\r\n\t\r\n\r\n\t}\r\n\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"},{"tags":[],"owner":{"account_id":7666017,"reputation":7604,"user_id":5809720,"display_name":"Sagar Gangwal"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1614336677,"creation_date":1614336677,"answer_id":66384444,"question_id":4600034,"body_markdown":"For **`LocalDate`** supported by latest java version you can try below function.\r\n\r\nIt provides support of function[**`getDayOfWeek()`**][1].\r\n\r\nThe **`getDayOfWeek()`** method of **`LocalDate`** class in Java gets the day-of-week field, which is an enum DayOfWeek.\r\n\r\n    public static int getWeekEndCount(LocalDate fromDate, LocalDate toDate) {\r\n            int saturday = 0;\r\n            int sunday = 0;\r\n            while (!fromDate.isAfter(toDate)) {\r\n                if (fromDate.getDayOfWeek().equals(DayOfWeek.SATURDAY))\r\n                    saturday++;\r\n                else if (fromDate.getDayOfWeek().equals(DayOfWeek.SUNDAY))\r\n                    sunday++;\r\n                fromDate = fromDate.plusDays(1);\r\n            }\r\n            System.out.println(&quot;Saturday count==&quot;+saturday);\r\n            System.out.println(&quot;Sunday count==&quot;+sunday);\r\n            return saturday+sunday;\r\n        }\r\n\r\n\r\n  [1]: https://www.geeksforgeeks.org/localdate-getdayofweek-method-in-java/","title":"Calculate number of weekdays between two dates in Java","body":"<p>For <strong><code>LocalDate</code></strong> supported by latest java version you can try below function.</p>\n<p>It provides support of function<a href=\"https://www.geeksforgeeks.org/localdate-getdayofweek-method-in-java/\" rel=\"nofollow noreferrer\"><strong><code>getDayOfWeek()</code></strong></a>.</p>\n<p>The <strong><code>getDayOfWeek()</code></strong> method of <strong><code>LocalDate</code></strong> class in Java gets the day-of-week field, which is an enum DayOfWeek.</p>\n<pre><code>public static int getWeekEndCount(LocalDate fromDate, LocalDate toDate) {\n        int saturday = 0;\n        int sunday = 0;\n        while (!fromDate.isAfter(toDate)) {\n            if (fromDate.getDayOfWeek().equals(DayOfWeek.SATURDAY))\n                saturday++;\n            else if (fromDate.getDayOfWeek().equals(DayOfWeek.SUNDAY))\n                sunday++;\n            fromDate = fromDate.plusDays(1);\n        }\n        System.out.println(&quot;Saturday count==&quot;+saturday);\n        System.out.println(&quot;Sunday count==&quot;+sunday);\n        return saturday+sunday;\n    }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":59102,"reputation":627,"user_id":176859,"display_name":"idarwin"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1677285065,"creation_date":1677285065,"answer_id":75562548,"question_id":4600034,"body_markdown":"I&#39;m surprised that every solution given here fails to account for business holidays, which occur in most countries every few months at least, so any span more than a few months will give an incorrect answer. Fortunately, Ravindra&#39;s answer using Streams is, despite the inconsequential (for spans under ~10 years) overhead, the best one because it is trivial to correct:\r\n\r\n    import java.time.*;\r\n    import java.util.*;\r\n\r\n    import static java.time.temporal.ChronoUnit.DAYS;\r\n\r\n    public class WeekDaysLeft {\r\n    public static void main(String[] args) {\r\n        LocalDate startDate = LocalDate.now(); // Early 2023\r\n        LocalDate endDate = LocalDate.of(2023, 6, 23);\r\n        Set&lt;DayOfWeek&gt; weekendDays =\r\n           EnumSet.of(DayOfWeek.SATURDAY, DayOfWeek.SUNDAY);\r\n        Set&lt;LocalDate&gt; holidays =\r\n            Set.of(LocalDate.of(2023,4,7),\r\n                LocalDate.of(2023,4,10));\r\n        final long weekDaysBetween =\r\n            startDate.datesUntil(endDate)\r\n            .filter(d -&gt; !weekendDays.contains(\r\n                d.getDayOfWeek()))\r\n            .filter(d -&gt; !holidays.contains(d))\r\n            .count();\r\n        System.out.println(weekDaysBetween);\r\n    }\r\n    }\r\n\r\nIn regard to my claim that the overhead is inconsequential:\r\n 1. Run my solution under time(1) on Unix/Linux\r\n e.g., time java WeekDaysLeft.java\r\n 2. Change the end-date to 2033, and repeat step 1.\r\nOn my system, the user time went DOWN slightly (user time up trivially).\r\nAnd, of course, if you&#39;re running this after June, 2023, bump all the years given.","title":"Calculate number of weekdays between two dates in Java","body":"<p>I'm surprised that every solution given here fails to account for business holidays, which occur in most countries every few months at least, so any span more than a few months will give an incorrect answer. Fortunately, Ravindra's answer using Streams is, despite the inconsequential (for spans under ~10 years) overhead, the best one because it is trivial to correct:</p>\n<pre><code>import java.time.*;\nimport java.util.*;\n\nimport static java.time.temporal.ChronoUnit.DAYS;\n\npublic class WeekDaysLeft {\npublic static void main(String[] args) {\n    LocalDate startDate = LocalDate.now(); // Early 2023\n    LocalDate endDate = LocalDate.of(2023, 6, 23);\n    Set&lt;DayOfWeek&gt; weekendDays =\n       EnumSet.of(DayOfWeek.SATURDAY, DayOfWeek.SUNDAY);\n    Set&lt;LocalDate&gt; holidays =\n        Set.of(LocalDate.of(2023,4,7),\n            LocalDate.of(2023,4,10));\n    final long weekDaysBetween =\n        startDate.datesUntil(endDate)\n        .filter(d -&gt; !weekendDays.contains(\n            d.getDayOfWeek()))\n        .filter(d -&gt; !holidays.contains(d))\n        .count();\n    System.out.println(weekDaysBetween);\n}\n}\n</code></pre>\n<p>In regard to my claim that the overhead is inconsequential:</p>\n<ol>\n<li>Run my solution under time(1) on Unix/Linux\ne.g., time java WeekDaysLeft.java</li>\n<li>Change the end-date to 2033, and repeat step 1.\nOn my system, the user time went DOWN slightly (user time up trivially).\nAnd, of course, if you're running this after June, 2023, bump all the years given.</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":23983780,"reputation":11,"user_id":17970844,"display_name":"UdacianND004"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694364626,"creation_date":1694364626,"answer_id":77077080,"question_id":4600034,"body_markdown":"Without loop, excluding last day:\r\n```\r\npublic static int daysWithoutWeekends(Date start, Date end){\r\n        if(start.after(end)){\r\n            var temp = start;\r\n            start = end;\r\n            end = temp;\r\n        }\r\n        Calendar c1 = Calendar.getInstance();\r\n        c1.setTime(start);\r\n        int w1 = c1.get(Calendar.DAY_OF_WEEK);\r\n        c1.add(Calendar.DAY_OF_WEEK, 7-w1);\r\n\r\n        Calendar c2 = Calendar.getInstance();\r\n        c2.setTime(end);\r\n        int w2 = c2.get(Calendar.DAY_OF_WEEK);\r\n        c2.add(Calendar.DAY_OF_WEEK, -w2);\r\n\r\n        int days =(int) ((c2.getTimeInMillis()-c1.getTimeInMillis())/(1000*60*60*24));\r\n        int daysWithoutWeekendDays = days-(days*2/7);\r\n\r\n        int additionalDays = Math.min(7-w1, 5) + Math.min(Math.max(w2-2, 0), 5);\r\n        return daysWithoutWeekendDays+additionalDays;\r\n    }\r\n```","title":"Calculate number of weekdays between two dates in Java","body":"<p>Without loop, excluding last day:</p>\n<pre><code>public static int daysWithoutWeekends(Date start, Date end){\n        if(start.after(end)){\n            var temp = start;\n            start = end;\n            end = temp;\n        }\n        Calendar c1 = Calendar.getInstance();\n        c1.setTime(start);\n        int w1 = c1.get(Calendar.DAY_OF_WEEK);\n        c1.add(Calendar.DAY_OF_WEEK, 7-w1);\n\n        Calendar c2 = Calendar.getInstance();\n        c2.setTime(end);\n        int w2 = c2.get(Calendar.DAY_OF_WEEK);\n        c2.add(Calendar.DAY_OF_WEEK, -w2);\n\n        int days =(int) ((c2.getTimeInMillis()-c1.getTimeInMillis())/(1000*60*60*24));\n        int daysWithoutWeekendDays = days-(days*2/7);\n\n        int additionalDays = Math.min(7-w1, 5) + Math.min(Math.max(w2-2, 0), 5);\n        return daysWithoutWeekendDays+additionalDays;\n    }\n</code></pre>\n"}],"owner":{"account_id":265739,"reputation":1795,"user_id":552914,"accept_rate":97,"display_name":"John C"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":102511,"favorite_count":0,"down_vote_count":0,"up_vote_count":61,"accepted_answer_id":4600057,"answer_count":22,"score":61,"last_activity_date":1694364626,"creation_date":1294190073,"question_id":4600034,"body_markdown":"Can anyone point me to some Java snippet wherein i can get business (except Sat and Sun) days between two dates.","title":"Calculate number of weekdays between two dates in Java","body":"<p>Can anyone point me to some Java snippet wherein i can get business (except Sat and Sun) days between two dates.</p>\n"},{"tags":["java","spring","zeromq","jzmq"],"comments":[{"owner":{"account_id":448441,"reputation":3683,"user_id":6783775,"display_name":"rveerd"},"score":0,"creation_date":1689346346,"post_id":76644159,"comment_id":135205004,"body_markdown":"Errno 4 is `EINTR`, an interrupted system call. That means your program receives a signal while calling a system function. Apparently when trying to receive data from the socket. Probably your `recv()` call is blocking waiting for data when it is interrupted. A solution is to retry the interrupted call.","body":"Errno 4 is <code>EINTR</code>, an interrupted system call. That means your program receives a signal while calling a system function. Apparently when trying to receive data from the socket. Probably your <code>recv()</code> call is blocking waiting for data when it is interrupted. A solution is to retry the interrupted call."}],"answers":[{"comments":[{"owner":{"account_id":17260307,"reputation":3,"user_id":12498373,"display_name":"jose1278"},"score":0,"creation_date":1694364465,"post_id":76825617,"comment_id":135878484,"body_markdown":"I&#39;ve added code to give an insight to the other part of the code that wasn&#39;t seen, from this do you think it is about the OS being too slow to deal with this and best option still is to put a time delay between pushReply(message) and send? @bazza","body":"I&#39;ve added code to give an insight to the other part of the code that wasn&#39;t seen, from this do you think it is about the OS being too slow to deal with this and best option still is to put a time delay between pushReply(message) and send? @bazza"},{"owner":{"account_id":2463651,"reputation":7815,"user_id":2147218,"display_name":"bazza"},"score":0,"creation_date":1694379319,"post_id":76825617,"comment_id":135879907,"body_markdown":"@jose1278 Does the other bit of code terminate, when it prints that error? Or, does it keep running? If it terminates, then that could explain why the first bit of code is getting an `EINTR` signal. For this new piece of code, is there a race condition between setting up the sockets in `OnInit()` and the handling of the timer in `OnTimer()`? I&#39;m not sure what `EventSetMilliscondTimer()` is doing and whether that&#39;s anything to do with how `OnTimer()` is called. It&#39;d also be useful to know what error is returned, rather than to just say there is an error.","body":"@jose1278 Does the other bit of code terminate, when it prints that error? Or, does it keep running? If it terminates, then that could explain why the first bit of code is getting an <code>EINTR</code> signal. For this new piece of code, is there a race condition between setting up the sockets in <code>OnInit()</code> and the handling of the timer in <code>OnTimer()</code>? I&#39;m not sure what <code>EventSetMilliscondTimer()</code> is doing and whether that&#39;s anything to do with how <code>OnTimer()</code> is called. It&#39;d also be useful to know what error is returned, rather than to just say there is an error."}],"tags":[],"owner":{"account_id":2463651,"reputation":7815,"user_id":2147218,"display_name":"bazza"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1691046115,"creation_date":1691046115,"answer_id":76825617,"question_id":76644159,"body_markdown":"I&#39;m assuming that, what&#39;s not shown, is the other program paired with this serving as the other endpoints for the PUSH and PULL sockets that you create and connect. \r\n\r\nI think that the problem lies in your other program that we&#39;re not seeing. Is that receiving the `GET_CURRENCY_STRENGTHS` message, replying, and then immediately terminating, or immediately cleaning up its context in much the same way as this code snippet is? \r\n\r\nIf so, it is the immediate termination / clean up that is the problem. The act of sending a message using ZMQ is non blocking; you&#39;re just pushing the message on to a queue that&#39;s managed by the thread(s) that ZMQ starts up and manages in the background. If after a ZMQ send() you immediately terminate the program or clean up, that means in all likelihood the management threads haven&#39;t actually had any time to do anything at all - maybe they&#39;ve not even been scheduled by the OS at this point. \r\n\r\nThe result of the program terminating is that the OS cleans up whatever resources have not yet been cleaned up by the program itself - sockets, allocated memory, threads, the lot. \r\n\r\nThe fact that this is all on localhost is interesting, because the OS has full visibility of the underlying tcp socket and can tell the connecting end (this program) a lot more about the state of the tcp socket than if the other endpoints were on another computer.  \r\n\r\nIf this is the case, at other end of the connections (in the code snippet you&#39;ve given us), what&#39;s happening is that ZMQ is patiently waiting in a blocked system call for something to come in via a tcp socket. Except, that socket is getting torn down by the OS (or the other end cleaning up). So, the socket read is terminated (because the socket no longer exists) and you get an ugly exception as shown.\r\n\r\nAt least, that&#39;s my guess. If that&#39;s correct, try putting in some delay in the other program (that we&#39;ve not seen) between the zmq send() and the termination of the program, allow things to happen in the background.\r\n\r\nThe variability in whether your code succeeds or not would be down to the random nature of the threads being scheduled or not following the zmq send(). The communication between the application program and the zme management thread(s) is done via IPC pipes (or other things like semaphores), all of which give the OS an opportunity to re-schedule threads. Sometimes it might say one thread gets scheduled, another time it may not, depending on how much of a time slice the main application thread has had (and a heap of other mysterious, arcane factors). \r\n\r\n**In General**\r\n\r\nIn ZMQ in particular, and in other Actor Model systems in general, termination is something that has to be agreed on. Because it&#39;s buffering messages inside the transport, you&#39;ve no idea whether &quot;that last, final message&quot; has made it through to the receiving end and that it is safe to terminate. What you need to have is a either a time delay before closing to allow everything to settle down to quiescence, or some explicit messaging acknowledging that the final message has propagated to everywhere. ","title":"Why am I getting an Errno 4 ZMQException?","body":"<p>I'm assuming that, what's not shown, is the other program paired with this serving as the other endpoints for the PUSH and PULL sockets that you create and connect.</p>\n<p>I think that the problem lies in your other program that we're not seeing. Is that receiving the <code>GET_CURRENCY_STRENGTHS</code> message, replying, and then immediately terminating, or immediately cleaning up its context in much the same way as this code snippet is?</p>\n<p>If so, it is the immediate termination / clean up that is the problem. The act of sending a message using ZMQ is non blocking; you're just pushing the message on to a queue that's managed by the thread(s) that ZMQ starts up and manages in the background. If after a ZMQ send() you immediately terminate the program or clean up, that means in all likelihood the management threads haven't actually had any time to do anything at all - maybe they've not even been scheduled by the OS at this point.</p>\n<p>The result of the program terminating is that the OS cleans up whatever resources have not yet been cleaned up by the program itself - sockets, allocated memory, threads, the lot.</p>\n<p>The fact that this is all on localhost is interesting, because the OS has full visibility of the underlying tcp socket and can tell the connecting end (this program) a lot more about the state of the tcp socket than if the other endpoints were on another computer.</p>\n<p>If this is the case, at other end of the connections (in the code snippet you've given us), what's happening is that ZMQ is patiently waiting in a blocked system call for something to come in via a tcp socket. Except, that socket is getting torn down by the OS (or the other end cleaning up). So, the socket read is terminated (because the socket no longer exists) and you get an ugly exception as shown.</p>\n<p>At least, that's my guess. If that's correct, try putting in some delay in the other program (that we've not seen) between the zmq send() and the termination of the program, allow things to happen in the background.</p>\n<p>The variability in whether your code succeeds or not would be down to the random nature of the threads being scheduled or not following the zmq send(). The communication between the application program and the zme management thread(s) is done via IPC pipes (or other things like semaphores), all of which give the OS an opportunity to re-schedule threads. Sometimes it might say one thread gets scheduled, another time it may not, depending on how much of a time slice the main application thread has had (and a heap of other mysterious, arcane factors).</p>\n<p><strong>In General</strong></p>\n<p>In ZMQ in particular, and in other Actor Model systems in general, termination is something that has to be agreed on. Because it's buffering messages inside the transport, you've no idea whether &quot;that last, final message&quot; has made it through to the receiving end and that it is safe to terminate. What you need to have is a either a time delay before closing to allow everything to settle down to quiescence, or some explicit messaging acknowledging that the final message has propagated to everywhere.</p>\n"}],"owner":{"account_id":17260307,"reputation":3,"user_id":12498373,"display_name":"jose1278"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":92,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694364299,"creation_date":1688837222,"question_id":76644159,"body_markdown":"I am getting this exception:\r\n\r\n   \r\n\r\n     org.zeromq.ZMQException: Errno 4\r\n        \tat org.zeromq.ZMQ$Socket.mayRaise(ZMQ.java:3732) ~[jeromq-0.5.3.jar:na]\r\n        \tat org.zeromq.ZMQ$Socket.recv(ZMQ.java:3530) ~[jeromq-0.5.3.jar:na]\r\n        \tat com.forexassistant.service.zeromq.CurrencyStrengthZeroMQ.sendCurrencyStrengthRequest(CurrencyStrengthZeroMQ.java:30) ~[classes/:na]\r\n        \tat com.forexassistant.service.algorithmlogic.AlgorithmLogic.getCurrencyStrength(AlgorithmLogic.java:209) ~[classes/:na]\r\n        \tat sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source) ~[na:na]\r\n        \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_241]\r\n        \tat java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_241]\r\n        \tat org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84) ~[spring-context-5.3.22.jar:5.3.22]\r\n        \tat org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54) ~[spring-context-5.3.22.jar:5.3.22]\r\n        \tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_241]\r\n        \tat java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308) [na:1.8.0_241]\r\n        \tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180) [na:1.8.0_241]\r\n        \tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294) [na:1.8.0_241]\r\n        \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_241]\r\n        \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_241]\r\n        \tat java.lang.Thread.run(Thread.java:748) [na:1.8.0_241]\r\n        \tSuppressed: org.zeromq.ZMQException: Errno 4\r\n        \t\tat zmq.Ctx.terminate(Ctx.java:304) ~[jeromq-0.5.3.jar:na]\r\n        \t\tat org.zeromq.ZMQ$Context.term(ZMQ.java:671) ~[jeromq-0.5.3.jar:na]\r\n        \t\tat org.zeromq.ZContext.destroy(ZContext.java:136) ~[jeromq-0.5.3.jar:na]\r\n        \t\tat org.zeromq.ZContext.close(ZContext.java:463) ~[jeromq-0.5.3.jar:na]\r\n        \t\tat com.forexassistant.service.zeromq.CurrencyStrengthZeroMQ.sendCurrencyStrengthRequest(CurrencyStrengthZeroMQ.java:37) ~[classes/:na]\r\n        \t\t... 13 common frames omitted\r\n\r\nI have no idea why it is happening, the logic in question is this that communicates with the socket:\r\n\r\n    public String sendCurrencyStrengthRequest() {\r\n    \t\ttry (ZContext context = new ZContext()) {\r\n    \t\t\tZMQ.Socket socket = context.createSocket(SocketType.PUSH);\r\n    \t        socket.connect(&quot;tcp://localhost:32868&quot;);\r\n    \t        ZMQ.Socket socket2 = context.createSocket(SocketType.PULL);\r\n    \t\t    socket2.connect(&quot;tcp://localhost:32869&quot;); \r\n    \t        \r\n    \t\t    String msg = &quot;GET_CURRENCY_STRENGTHS&quot;;\r\n    \t        socket.send(msg,1);\r\n    \t        \r\n    \t\t\r\n    \t     \twhile (!Thread.currentThread().isInterrupted()) {\r\n    \t\t    \t byte[] reply = socket2.recv(0);\r\n    \t\t    \t if(reply!=null) {\r\n    \t\t    \t\t currencyStrengths= new String(reply, ZMQ.CHARSET);\r\n    \t\t    \t }\r\n    \t\t    \t context.close();\r\n    \t\t    \t break;  \t \r\n    \t\t    }\r\n    \t\t}\r\n    \t\treturn currencyStrengths;\r\n    \t}\r\n\r\nThis is the code from the other bit:\r\n```\r\n\r\n\r\n// CREATE ZeroMQ Context\r\nContext context(PROJECT_NAME);\r\n\r\n// CREATE ZMQ_PUSH SOCKET\r\nSocket pushSocket(context, ZMQ_PUSH);\r\n\r\n// CREATE ZMQ_PULL SOCKET\r\nSocket pullSocket(context, ZMQ_PULL);\r\n\r\n// CREATE ZMQ_PUB SOCKET\r\nSocket pubSocket(context, ZMQ_PUB);\r\n\r\n\r\nint OnInit() {\r\n\r\n   EventSetMillisecondTimer(MILLISECOND_TIMER);     // Set Millisecond Timer to get client socket input\r\n   \r\n   //EventSetTimer(1790);\r\n   \r\n   context.setBlocky(false);\r\n   \r\n   // Send responses to PULL_PORT that client is listening on.   \r\n   if(!pushSocket.bind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PULL_PORT))) {\r\n      Print(&quot;[PUSH] ####ERROR#### Binding MT4 Server to Socket on Port &quot; + IntegerToString(PULL_PORT) + &quot;..&quot;);\r\n      return(INIT_FAILED);\r\n   } else {\r\n      Print(&quot;[PUSH] Binding MT4 Server to Socket on Port &quot; + IntegerToString(PULL_PORT) + &quot;..&quot;);\r\n      pushSocket.setSendHighWaterMark(1);\r\n      pushSocket.setLinger(0);\r\n   }\r\n   \r\n   // Receive commands from PUSH_PORT that client is sending to.     \r\n   if(!pullSocket.bind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUSH_PORT))) {\r\n      Print(&quot;[PULL] ####ERROR#### Binding MT4 Server to Socket on Port &quot; + IntegerToString(PUSH_PORT) + &quot;..&quot;);\r\n      return(INIT_FAILED);\r\n   } else {\r\n      Print(&quot;[PULL] Binding MT4 Server to Socket on Port &quot; + IntegerToString(PUSH_PORT) + &quot;..&quot;);\r\n      pullSocket.setReceiveHighWaterMark(1);   \r\n      pullSocket.setLinger(0); \r\n   }\r\n   \r\n   // Send new market data to PUB_PORT that client is subscribed to.      \r\n   if(!pubSocket.bind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUB_PORT))) {\r\n      Print(&quot;[PUB] ####ERROR#### Binding MT4 Server to Socket on Port &quot; + IntegerToString(PUB_PORT) + &quot;..&quot;);\r\n      return(INIT_FAILED);\r\n   } else {\r\n      Print(&quot;[PUB] Binding MT4 Server to Socket on Port &quot; + IntegerToString(PUB_PORT) + &quot;..&quot;);\r\n      pubSocket.setSendHighWaterMark(1);\r\n      pubSocket.setLinger(0);\r\n   }\r\n   return(INIT_SUCCEEDED);\r\n}\r\n//+------------------------------------------------------------------+\r\n//| Expert deinitialization function                                 |\r\n//+------------------------------------------------------------------+\r\nvoid OnDeinit(const int reason) {\r\n\r\n   Print(&quot;[PUSH] Unbinding MT4 Server from Socket on Port &quot; + IntegerToString(PULL_PORT) + &quot;..&quot;);\r\n   pushSocket.unbind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PULL_PORT));\r\n   pushSocket.disconnect(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PULL_PORT));\r\n   \r\n   \r\n   Print(&quot;[PULL] Unbinding MT4 Server from Socket on Port &quot; + IntegerToString(PUSH_PORT) + &quot;..&quot;);\r\n   pullSocket.unbind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUSH_PORT));\r\n   pullSocket.disconnect(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUSH_PORT));\r\n   \r\n   \r\n   if (Publish_MarketData == true || Publish_MarketRates == true) {\r\n      Print(&quot;[PUB] Unbinding MT4 Server from Socket on Port &quot; + IntegerToString(PUB_PORT) + &quot;..&quot;);\r\n      pubSocket.unbind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUB_PORT));\r\n      pubSocket.disconnect(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUB_PORT));\r\n   }\r\n   \r\n   // Shutdown ZeroMQ Context\r\n   context.shutdown();\r\n   context.destroy(0);\r\n   \r\n   EventKillTimer();\r\n}\r\n\r\n\r\n//+------------------------------------------------------------------+\r\n//| Expert timer function                                            |\r\n//+------------------------------------------------------------------+\r\nvoid OnTimer() {\r\n\r\n   /*\r\n      Use this OnTimer() function to get and respond to commands\r\n   */\r\n   \r\n   if(CheckServerStatus() == true) {\r\n      // Get client&#39;s response, but don&#39;t block.\r\n      bool hasAllOtherRequest = pullSocket.recv(request, true);\r\n      \r\n      if(hasAllOtherRequest){\r\n         if (request.size() &gt; 0) {\r\n            // Wait \r\n            // pullSocket.recv(request,false);\r\n            \r\n            // MessageHandler() should go here.   \r\n            ZmqMsg reply = MessageHandler(request);\r\n            \r\n            \r\n            // Send response, and block\r\n            // pushSocket.send(reply);\r\n            \r\n            // Send response, but don&#39;t block\r\n            if(!pushSocket.send(reply, true)) {\r\n              Print(&quot;###ERROR### Sending message&quot;);\r\n            }\r\n         }\r\n      }\r\n      \r\n      \r\n      // update prices regularly in case there was no tick within X milliseconds (for non-chart symbols). \r\n      if (GetTickCount() &gt;= lastUpdateMillis + MILLISECOND_TIMER_PRICES) OnTick();\r\n   }\r\n}\r\n//+------------------------------------------------------------------+\r\n\r\nZmqMsg MessageHandler(ZmqMsg &amp;_request) {\r\n   \r\n   // Output object\r\n   ZmqMsg reply;\r\n   \r\n   // Message components for later.\r\n   string components[11];\r\n   \r\n   if(_request.size() &gt; 0) {\r\n   \r\n      // Get data from request   \r\n      ArrayResize(_data, _request.size());\r\n      _request.getData(_data);\r\n      string dataStr = CharArrayToString(_data);\r\n      \r\n      \r\n      // Process data\r\n      ParseZmqMessage(dataStr, components);\r\n      \r\n      // Interpret data\r\n      InterpretZmqMessage(pushSocket, components);\r\n      \r\n      \r\n   } else {\r\n      // NO DATA RECEIVED\r\n   }\r\n   \r\n   return(reply);\r\n}\r\n\r\n\r\n//+------------------------------------------------------------------+\r\n// Interpret Zmq Message and perform actions\r\nvoid InterpretZmqMessage(Socket &amp;pSocket, string &amp;compArray[]) {\r\n\r\n   \r\n   int switch_action = 0;\r\n   \r\n   /* 02-08-2019 10:41 CEST - HEARTBEAT */\r\n   if(compArray[0] == &quot;GET_CURRENCY_STRENGTHS&quot;)\r\n      switch_action = 14; \r\n  \r\n   /* Setup processing variables */\r\n   string zmq_ret = &quot;&quot;;\r\n   string response = &quot;&quot;;\r\n   string responseArray[10];\r\n   string ret = &quot;&quot;;\r\n   int ticket = -1;\r\n   bool ans = false;\r\n   \r\n   /****************************\r\n    * PERFORM SOME CHECKS HERE *\r\n    ****************************/\r\n   if (CheckOpsStatus(pSocket, switch_action) == true) {\r\n   \r\n      switch(switch_action) {\r\n       case 14: \r\n            \r\n            getCurrencyStrengths(responseArray);\r\n            \r\n            response = response + responseArray[0] + &quot;, &quot;;\r\n            response = response + responseArray[1] + &quot;, &quot;;\r\n            response = response + responseArray[2] + &quot;, &quot;;\r\n            response = response + responseArray[3] + &quot;, &quot;;\r\n            response = response + responseArray[4] + &quot;, &quot;;\r\n            response = response + responseArray[5];\r\n            \r\n               \r\n            InformPullClient(pSocket, response);\r\n            \r\n            break;\r\n            \r\n            \r\n         default: \r\n            break;\r\n      }\r\n   }\r\n}\r\n\r\n\r\n\r\n// Inform Client\r\nvoid InformPullClient(Socket&amp; pSocket, string message) {\r\n\r\n   ZmqMsg pushReply(message);\r\n   \r\n   pSocket.send(pushReply,true); // NON-BLOCKING\r\n   \r\n}\r\n\r\n\r\n```\r\nWhen the error happens then the line to print Print(&quot;###ERROR### Sending message&quot;); is hit and causes that to be printed in the other application.\r\n\r\n\r\nAm I doing this wrong? sendCurrencyStrengthRequest() is scheduled in Spring to be called every 5 seconds and there is another function that will be called every 30mins that uses a different pull and push socket within a different context, all this works for a while and then this error gets thrown, any idea?\r\n","title":"Why am I getting an Errno 4 ZMQException?","body":"<p>I am getting this exception:</p>\n<pre><code> org.zeromq.ZMQException: Errno 4\n        at org.zeromq.ZMQ$Socket.mayRaise(ZMQ.java:3732) ~[jeromq-0.5.3.jar:na]\n        at org.zeromq.ZMQ$Socket.recv(ZMQ.java:3530) ~[jeromq-0.5.3.jar:na]\n        at com.forexassistant.service.zeromq.CurrencyStrengthZeroMQ.sendCurrencyStrengthRequest(CurrencyStrengthZeroMQ.java:30) ~[classes/:na]\n        at com.forexassistant.service.algorithmlogic.AlgorithmLogic.getCurrencyStrength(AlgorithmLogic.java:209) ~[classes/:na]\n        at sun.reflect.GeneratedMethodAccessor111.invoke(Unknown Source) ~[na:na]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_241]\n        at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_241]\n        at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84) ~[spring-context-5.3.22.jar:5.3.22]\n        at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54) ~[spring-context-5.3.22.jar:5.3.22]\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_241]\n        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308) [na:1.8.0_241]\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180) [na:1.8.0_241]\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294) [na:1.8.0_241]\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_241]\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_241]\n        at java.lang.Thread.run(Thread.java:748) [na:1.8.0_241]\n        Suppressed: org.zeromq.ZMQException: Errno 4\n            at zmq.Ctx.terminate(Ctx.java:304) ~[jeromq-0.5.3.jar:na]\n            at org.zeromq.ZMQ$Context.term(ZMQ.java:671) ~[jeromq-0.5.3.jar:na]\n            at org.zeromq.ZContext.destroy(ZContext.java:136) ~[jeromq-0.5.3.jar:na]\n            at org.zeromq.ZContext.close(ZContext.java:463) ~[jeromq-0.5.3.jar:na]\n            at com.forexassistant.service.zeromq.CurrencyStrengthZeroMQ.sendCurrencyStrengthRequest(CurrencyStrengthZeroMQ.java:37) ~[classes/:na]\n            ... 13 common frames omitted\n</code></pre>\n<p>I have no idea why it is happening, the logic in question is this that communicates with the socket:</p>\n<pre><code>public String sendCurrencyStrengthRequest() {\n        try (ZContext context = new ZContext()) {\n            ZMQ.Socket socket = context.createSocket(SocketType.PUSH);\n            socket.connect(&quot;tcp://localhost:32868&quot;);\n            ZMQ.Socket socket2 = context.createSocket(SocketType.PULL);\n            socket2.connect(&quot;tcp://localhost:32869&quot;); \n            \n            String msg = &quot;GET_CURRENCY_STRENGTHS&quot;;\n            socket.send(msg,1);\n            \n        \n            while (!Thread.currentThread().isInterrupted()) {\n                 byte[] reply = socket2.recv(0);\n                 if(reply!=null) {\n                     currencyStrengths= new String(reply, ZMQ.CHARSET);\n                 }\n                 context.close();\n                 break;      \n            }\n        }\n        return currencyStrengths;\n    }\n</code></pre>\n<p>This is the code from the other bit:</p>\n<pre><code>\n\n// CREATE ZeroMQ Context\nContext context(PROJECT_NAME);\n\n// CREATE ZMQ_PUSH SOCKET\nSocket pushSocket(context, ZMQ_PUSH);\n\n// CREATE ZMQ_PULL SOCKET\nSocket pullSocket(context, ZMQ_PULL);\n\n// CREATE ZMQ_PUB SOCKET\nSocket pubSocket(context, ZMQ_PUB);\n\n\nint OnInit() {\n\n   EventSetMillisecondTimer(MILLISECOND_TIMER);     // Set Millisecond Timer to get client socket input\n   \n   //EventSetTimer(1790);\n   \n   context.setBlocky(false);\n   \n   // Send responses to PULL_PORT that client is listening on.   \n   if(!pushSocket.bind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PULL_PORT))) {\n      Print(&quot;[PUSH] ####ERROR#### Binding MT4 Server to Socket on Port &quot; + IntegerToString(PULL_PORT) + &quot;..&quot;);\n      return(INIT_FAILED);\n   } else {\n      Print(&quot;[PUSH] Binding MT4 Server to Socket on Port &quot; + IntegerToString(PULL_PORT) + &quot;..&quot;);\n      pushSocket.setSendHighWaterMark(1);\n      pushSocket.setLinger(0);\n   }\n   \n   // Receive commands from PUSH_PORT that client is sending to.     \n   if(!pullSocket.bind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUSH_PORT))) {\n      Print(&quot;[PULL] ####ERROR#### Binding MT4 Server to Socket on Port &quot; + IntegerToString(PUSH_PORT) + &quot;..&quot;);\n      return(INIT_FAILED);\n   } else {\n      Print(&quot;[PULL] Binding MT4 Server to Socket on Port &quot; + IntegerToString(PUSH_PORT) + &quot;..&quot;);\n      pullSocket.setReceiveHighWaterMark(1);   \n      pullSocket.setLinger(0); \n   }\n   \n   // Send new market data to PUB_PORT that client is subscribed to.      \n   if(!pubSocket.bind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUB_PORT))) {\n      Print(&quot;[PUB] ####ERROR#### Binding MT4 Server to Socket on Port &quot; + IntegerToString(PUB_PORT) + &quot;..&quot;);\n      return(INIT_FAILED);\n   } else {\n      Print(&quot;[PUB] Binding MT4 Server to Socket on Port &quot; + IntegerToString(PUB_PORT) + &quot;..&quot;);\n      pubSocket.setSendHighWaterMark(1);\n      pubSocket.setLinger(0);\n   }\n   return(INIT_SUCCEEDED);\n}\n//+------------------------------------------------------------------+\n//| Expert deinitialization function                                 |\n//+------------------------------------------------------------------+\nvoid OnDeinit(const int reason) {\n\n   Print(&quot;[PUSH] Unbinding MT4 Server from Socket on Port &quot; + IntegerToString(PULL_PORT) + &quot;..&quot;);\n   pushSocket.unbind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PULL_PORT));\n   pushSocket.disconnect(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PULL_PORT));\n   \n   \n   Print(&quot;[PULL] Unbinding MT4 Server from Socket on Port &quot; + IntegerToString(PUSH_PORT) + &quot;..&quot;);\n   pullSocket.unbind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUSH_PORT));\n   pullSocket.disconnect(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUSH_PORT));\n   \n   \n   if (Publish_MarketData == true || Publish_MarketRates == true) {\n      Print(&quot;[PUB] Unbinding MT4 Server from Socket on Port &quot; + IntegerToString(PUB_PORT) + &quot;..&quot;);\n      pubSocket.unbind(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUB_PORT));\n      pubSocket.disconnect(StringFormat(&quot;%s://%s:%d&quot;, ZEROMQ_PROTOCOL, HOSTNAME, PUB_PORT));\n   }\n   \n   // Shutdown ZeroMQ Context\n   context.shutdown();\n   context.destroy(0);\n   \n   EventKillTimer();\n}\n\n\n//+------------------------------------------------------------------+\n//| Expert timer function                                            |\n//+------------------------------------------------------------------+\nvoid OnTimer() {\n\n   /*\n      Use this OnTimer() function to get and respond to commands\n   */\n   \n   if(CheckServerStatus() == true) {\n      // Get client's response, but don't block.\n      bool hasAllOtherRequest = pullSocket.recv(request, true);\n      \n      if(hasAllOtherRequest){\n         if (request.size() &gt; 0) {\n            // Wait \n            // pullSocket.recv(request,false);\n            \n            // MessageHandler() should go here.   \n            ZmqMsg reply = MessageHandler(request);\n            \n            \n            // Send response, and block\n            // pushSocket.send(reply);\n            \n            // Send response, but don't block\n            if(!pushSocket.send(reply, true)) {\n              Print(&quot;###ERROR### Sending message&quot;);\n            }\n         }\n      }\n      \n      \n      // update prices regularly in case there was no tick within X milliseconds (for non-chart symbols). \n      if (GetTickCount() &gt;= lastUpdateMillis + MILLISECOND_TIMER_PRICES) OnTick();\n   }\n}\n//+------------------------------------------------------------------+\n\nZmqMsg MessageHandler(ZmqMsg &amp;_request) {\n   \n   // Output object\n   ZmqMsg reply;\n   \n   // Message components for later.\n   string components[11];\n   \n   if(_request.size() &gt; 0) {\n   \n      // Get data from request   \n      ArrayResize(_data, _request.size());\n      _request.getData(_data);\n      string dataStr = CharArrayToString(_data);\n      \n      \n      // Process data\n      ParseZmqMessage(dataStr, components);\n      \n      // Interpret data\n      InterpretZmqMessage(pushSocket, components);\n      \n      \n   } else {\n      // NO DATA RECEIVED\n   }\n   \n   return(reply);\n}\n\n\n//+------------------------------------------------------------------+\n// Interpret Zmq Message and perform actions\nvoid InterpretZmqMessage(Socket &amp;pSocket, string &amp;compArray[]) {\n\n   \n   int switch_action = 0;\n   \n   /* 02-08-2019 10:41 CEST - HEARTBEAT */\n   if(compArray[0] == &quot;GET_CURRENCY_STRENGTHS&quot;)\n      switch_action = 14; \n  \n   /* Setup processing variables */\n   string zmq_ret = &quot;&quot;;\n   string response = &quot;&quot;;\n   string responseArray[10];\n   string ret = &quot;&quot;;\n   int ticket = -1;\n   bool ans = false;\n   \n   /****************************\n    * PERFORM SOME CHECKS HERE *\n    ****************************/\n   if (CheckOpsStatus(pSocket, switch_action) == true) {\n   \n      switch(switch_action) {\n       case 14: \n            \n            getCurrencyStrengths(responseArray);\n            \n            response = response + responseArray[0] + &quot;, &quot;;\n            response = response + responseArray[1] + &quot;, &quot;;\n            response = response + responseArray[2] + &quot;, &quot;;\n            response = response + responseArray[3] + &quot;, &quot;;\n            response = response + responseArray[4] + &quot;, &quot;;\n            response = response + responseArray[5];\n            \n               \n            InformPullClient(pSocket, response);\n            \n            break;\n            \n            \n         default: \n            break;\n      }\n   }\n}\n\n\n\n// Inform Client\nvoid InformPullClient(Socket&amp; pSocket, string message) {\n\n   ZmqMsg pushReply(message);\n   \n   pSocket.send(pushReply,true); // NON-BLOCKING\n   \n}\n\n\n</code></pre>\n<p>When the error happens then the line to print Print(&quot;###ERROR### Sending message&quot;); is hit and causes that to be printed in the other application.</p>\n<p>Am I doing this wrong? sendCurrencyStrengthRequest() is scheduled in Spring to be called every 5 seconds and there is another function that will be called every 30mins that uses a different pull and push socket within a different context, all this works for a while and then this error gets thrown, any idea?</p>\n"},{"tags":["java","spring-data-jpa"],"answers":[{"tags":[],"owner":{"account_id":5582102,"reputation":1071,"user_id":4423695,"display_name":"ThilankaD"},"comment_count":0,"down_vote_count":0,"up_vote_count":9,"is_accepted":true,"score":9,"last_activity_date":1625161646,"creation_date":1625161646,"answer_id":68214786,"question_id":68213740,"body_markdown":"Since you have not defined the column name for `id` in A then the column name will defaults to `id`. Then in class B, you should change the `referencedColumnName` to `id` (or else you can simply skip the `referencedColumnName` attribute since it can be derived directly from the target entity in an OneToOne relationship)\r\n\r\n    @Entity\r\n    @Table(name = &quot;b&quot;)\r\n    @AllArgsConstructor\r\n    @NoArgsConstructor\r\n    @Data\r\n    @EqualsAndHashCode(callSuper=false)\r\n    public class B extends Auditable {\r\n    \r\n        @Id\r\n        @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n        private Long id;\r\n    \r\n        @Column\r\n        @Size(min = 1, max = 100)\r\n        private String name;\r\n    \r\n        @OneToOne\r\n        @JoinColumn(name=&quot;aId&quot;, referencedColumnName = &quot;id&quot;)\r\n        private A aId;\r\n    \r\n    }\r\n\r\nIn repository, you need to annotate it with `@Repository` annotation to let Spring know it should be treated as a Repository Bean.\r\n\r\n \r\n    @Repository\r\n    public interface BRepository extends JpaRepository&lt;B, Long&gt; {\r\n        \r\n        @Query(value=&quot;select b from B b where B.aId.id=?1&quot;)\r\n        List&lt;B&gt; findAllBByA_aId(String aId);\r\n    }\r\n\r\nor you can use SPeL directly,\r\n\r\n\r\n    @Repository\r\n    public interface BRepository extends JpaRepository&lt;B, Long&gt; {\r\n        \r\n        List&lt;B&gt; findAllByaIdId(String aId);\r\n    }\r\n","title":"Spring Data JPA: FindBy on Join Column","body":"<p>Since you have not defined the column name for <code>id</code> in A then the column name will defaults to <code>id</code>. Then in class B, you should change the <code>referencedColumnName</code> to <code>id</code> (or else you can simply skip the <code>referencedColumnName</code> attribute since it can be derived directly from the target entity in an OneToOne relationship)</p>\n<pre><code>@Entity\n@Table(name = &quot;b&quot;)\n@AllArgsConstructor\n@NoArgsConstructor\n@Data\n@EqualsAndHashCode(callSuper=false)\npublic class B extends Auditable {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column\n    @Size(min = 1, max = 100)\n    private String name;\n\n    @OneToOne\n    @JoinColumn(name=&quot;aId&quot;, referencedColumnName = &quot;id&quot;)\n    private A aId;\n\n}\n</code></pre>\n<p>In repository, you need to annotate it with <code>@Repository</code> annotation to let Spring know it should be treated as a Repository Bean.</p>\n<pre><code>@Repository\npublic interface BRepository extends JpaRepository&lt;B, Long&gt; {\n    \n    @Query(value=&quot;select b from B b where B.aId.id=?1&quot;)\n    List&lt;B&gt; findAllBByA_aId(String aId);\n}\n</code></pre>\n<p>or you can use SPeL directly,</p>\n<pre><code>@Repository\npublic interface BRepository extends JpaRepository&lt;B, Long&gt; {\n    \n    List&lt;B&gt; findAllByaIdId(String aId);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1034341,"reputation":33,"user_id":1042032,"display_name":"Hugo Scavino"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694363691,"creation_date":1694363691,"answer_id":77077013,"question_id":68213740,"body_markdown":"In my case, the below @Query worked for me. After the &#39;WHERE&#39; I used the instance and not the Repository name. Basically, I had to use lowercase &#39;b&#39; and not uppercase &#39;B&#39;\r\n\r\n`@Query(value=&quot;select b from B b where b.aId.id=?1&quot;)`\r\n","title":"Spring Data JPA: FindBy on Join Column","body":"<p>In my case, the below @Query worked for me. After the 'WHERE' I used the instance and not the Repository name. Basically, I had to use lowercase 'b' and not uppercase 'B'</p>\n<p><code>@Query(value=&quot;select b from B b where b.aId.id=?1&quot;)</code></p>\n"}],"owner":{"account_id":19540743,"reputation":303,"user_id":14298525,"display_name":"mifol68042"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":12230,"favorite_count":0,"down_vote_count":0,"up_vote_count":11,"accepted_answer_id":68214786,"answer_count":2,"score":11,"last_activity_date":1694363691,"creation_date":1625156557,"question_id":68213740,"body_markdown":"I have setup two entities like below in a one-to-one mapping and I am trying to query on the joincolumn like below in my repository:\r\n\r\n    @Entity\r\n    @Table(name = &quot;a&quot;)\r\n    @AllArgsConstructor\r\n    @NoArgsConstructor\r\n    @Data\r\n    @EqualsAndHashCode(callSuper=false)\r\n    public class A extends Auditable {\r\n    \r\n        @Id\r\n        @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n        private Long id;\r\n    \r\n        @Column(unique = true)\r\n        @Size(min = 1, max = 100)\r\n        private String name;\r\n    }\r\n\r\n\r\n    @Entity\r\n    @Table(name = &quot;b&quot;)\r\n    @AllArgsConstructor\r\n    @NoArgsConstructor\r\n    @Data\r\n    @EqualsAndHashCode(callSuper=false)\r\n    public class B extends Auditable {\r\n    \r\n        @Id\r\n        @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n        private Long id;\r\n    \r\n        @Column\r\n        @Size(min = 1, max = 100)\r\n        private String name;\r\n    \r\n        @OneToOne\r\n        @JoinColumn(name=&quot;aId&quot;, referencedColumnName = &quot;aId&quot;)\r\n        private A aId;\r\n    \r\n    }\r\n\r\n\r\nIn my `BRepository.java`, I am trying to do this:\r\n\r\n    @Component\r\n    public interface BRepository extends JpaRepository&lt;B, Long&gt; {\r\n        List&lt;B&gt; findAllBByA_aId(String aId);\r\n    }\r\n\r\nI get the following error:\r\n\r\n`No property a found for type B! Did you mean &#39;aId&#39;?`\r\n\r\nIs this not the right way to query on a join column in spring-data??","title":"Spring Data JPA: FindBy on Join Column","body":"<p>I have setup two entities like below in a one-to-one mapping and I am trying to query on the joincolumn like below in my repository:</p>\n<pre><code>@Entity\n@Table(name = &quot;a&quot;)\n@AllArgsConstructor\n@NoArgsConstructor\n@Data\n@EqualsAndHashCode(callSuper=false)\npublic class A extends Auditable {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column(unique = true)\n    @Size(min = 1, max = 100)\n    private String name;\n}\n\n\n@Entity\n@Table(name = &quot;b&quot;)\n@AllArgsConstructor\n@NoArgsConstructor\n@Data\n@EqualsAndHashCode(callSuper=false)\npublic class B extends Auditable {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column\n    @Size(min = 1, max = 100)\n    private String name;\n\n    @OneToOne\n    @JoinColumn(name=&quot;aId&quot;, referencedColumnName = &quot;aId&quot;)\n    private A aId;\n\n}\n</code></pre>\n<p>In my <code>BRepository.java</code>, I am trying to do this:</p>\n<pre><code>@Component\npublic interface BRepository extends JpaRepository&lt;B, Long&gt; {\n    List&lt;B&gt; findAllBByA_aId(String aId);\n}\n</code></pre>\n<p>I get the following error:</p>\n<p><code>No property a found for type B! Did you mean 'aId'?</code></p>\n<p>Is this not the right way to query on a join column in spring-data??</p>\n"},{"tags":["java","spring","spring-boot","validation","testing"],"answers":[{"comments":[{"owner":{"account_id":20544317,"reputation":3,"user_id":21406289,"display_name":"Luisian"},"score":0,"creation_date":1678913545,"post_id":75749693,"comment_id":133627559,"body_markdown":"I tried your code, but unfortunately, I,ve got the same result &quot;Expected org.springframework.web.bind.MethodArgumentNotValidException to be thrown, but nothing was thrown.&quot;","body":"I tried your code, but unfortunately, I,ve got the same result &quot;Expected org.springframework.web.bind.MethodArgumentNotValidException to be thrown, but nothing was thrown.&quot;"},{"owner":{"account_id":2124329,"reputation":612,"user_id":1886904,"display_name":"egeorge"},"score":0,"creation_date":1679003497,"post_id":75749693,"comment_id":133647767,"body_markdown":"You might need to call the full MVC stack with `MockMVC` for the ExceptionHandler to be included in it.","body":"You might need to call the full MVC stack with <code>MockMVC</code> for the ExceptionHandler to be included in it."}],"tags":[],"owner":{"account_id":2124329,"reputation":612,"user_id":1886904,"display_name":"egeorge"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1678911654,"creation_date":1678911654,"answer_id":75749693,"question_id":75749445,"body_markdown":"It looks like you are bypassing the `Spring` injection, so I would not expect things like the `RestExceptionHandler` to get invoked. I suggest making this a `SpringBootTest`\r\n```Java\r\n@SpringBootTest\r\n@ExtendWith(MockitoExtension.class)\r\npublic class ProductServiceTest {\r\n   @Mock ProductRepository productRepository;\r\n   @Autowired ProductMapper productMapper;\r\n   @Autowired ProductServiceImpl productService;\r\n\r\n   @Test\r\n   void whenEmptyNameProduct() {\r\n      //...same as before\r\n   }\r\n }\r\n```\r\nI don&#39;t know what mocking framework you use, but this is what the `SpringBoot` `Mockito` version would look like.","title":"How to test @NotBlank spring validation with JUnit? [RESOLVED]","body":"<p>It looks like you are bypassing the <code>Spring</code> injection, so I would not expect things like the <code>RestExceptionHandler</code> to get invoked. I suggest making this a <code>SpringBootTest</code></p>\n<pre><code>@SpringBootTest\n@ExtendWith(MockitoExtension.class)\npublic class ProductServiceTest {\n   @Mock ProductRepository productRepository;\n   @Autowired ProductMapper productMapper;\n   @Autowired ProductServiceImpl productService;\n\n   @Test\n   void whenEmptyNameProduct() {\n      //...same as before\n   }\n }\n</code></pre>\n<p>I don't know what mocking framework you use, but this is what the <code>SpringBoot</code> <code>Mockito</code> version would look like.</p>\n"},{"comments":[{"owner":{"account_id":20544317,"reputation":3,"user_id":21406289,"display_name":"Luisian"},"score":1,"creation_date":1678969086,"post_id":75753937,"comment_id":133637823,"body_markdown":"Thank you, it works. I tried similar approach and achieved success.","body":"Thank you, it works. I tried similar approach and achieved success."},{"owner":{"account_id":8559295,"reputation":87,"user_id":6413802,"display_name":"DRayen"},"score":0,"creation_date":1687846114,"post_id":75753937,"comment_id":134989667,"body_markdown":"I tried the same approach. But I get the below error. `javax.validation.ValidationException: HV000045: A group has to be an interface.` But do not have any groups defined in my entity class.","body":"I tried the same approach. But I get the below error. <code>javax.validation.ValidationException: HV000045: A group has to be an interface.</code> But do not have any groups defined in my entity class."}],"tags":[],"owner":{"account_id":17520379,"reputation":1536,"user_id":12706564,"display_name":"Emanuel Trandafir"},"comment_count":2,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1678957188,"creation_date":1678957188,"answer_id":75753937,"question_id":75749445,"body_markdown":"firstly, you can quickly unit-test and check how your object is validated like this:\r\n\r\n    @Test\r\n\tvoid test2() {\r\n\t\t//given\r\n\t\tValidator validator = Validation.buildDefaultValidatorFactory().getValidator();\r\n\t\tProductRequest productMissingName = buildValidProduct();\r\n\t\tproductMissingName.setName(&quot;&quot;);\r\n\r\n\t\t//when\r\n\t\tvar violations  = validator.validate(productMissingName);\r\n\t\tSystem.out.println(violations);\r\n\r\n\t\t//then\r\n\t\t// ...\r\n\t}\r\n\r\nThen, you need to make sure that this validation will happen. So you&#39;ll need to add a `@Valid` - you can put it in the controller, or even here in the service class. For instance:\r\n\r\n    @Override\r\n    @Transactional\r\n    public ProductResponse createProduct(@Valid ProductRequest productRequest) {\r\n        // ...\r\n    }\r\n\r\nOnce you have these, it should work with the `@SpringBootTest`, as suggested by @egeorge in the previous answer\r\n","title":"How to test @NotBlank spring validation with JUnit? [RESOLVED]","body":"<p>firstly, you can quickly unit-test and check how your object is validated like this:</p>\n<pre><code>@Test\nvoid test2() {\n    //given\n    Validator validator = Validation.buildDefaultValidatorFactory().getValidator();\n    ProductRequest productMissingName = buildValidProduct();\n    productMissingName.setName(&quot;&quot;);\n\n    //when\n    var violations  = validator.validate(productMissingName);\n    System.out.println(violations);\n\n    //then\n    // ...\n}\n</code></pre>\n<p>Then, you need to make sure that this validation will happen. So you'll need to add a <code>@Valid</code> - you can put it in the controller, or even here in the service class. For instance:</p>\n<pre><code>@Override\n@Transactional\npublic ProductResponse createProduct(@Valid ProductRequest productRequest) {\n    // ...\n}\n</code></pre>\n<p>Once you have these, it should work with the <code>@SpringBootTest</code>, as suggested by @egeorge in the previous answer</p>\n"}],"owner":{"account_id":20544317,"reputation":3,"user_id":21406289,"display_name":"Luisian"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":715,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75753937,"answer_count":2,"score":0,"last_activity_date":1694363178,"creation_date":1678909882,"question_id":75749445,"body_markdown":"I am trying to test validation I have a controller\r\n\r\n    @RestController\r\n    @RequestMapping(&quot;/product&quot;)\r\n    @RequiredArgsConstructor\r\n    @CrossOrigin\r\n    public class ProductController {\r\n\r\n    private final ProductService productService;\r\n\r\n    @PreAuthorize(&quot;hasRole(&#39;ROLE_ADMIN&#39;)&quot;)\r\n    @PostMapping\r\n    public ProductResponse createProduct(@RequestBody @Valid ProductRequest request) {\r\n        return productService.createProduct(request);\r\n     }\r\n    }\r\nservice\r\n\r\n    @Slf4j\r\n    @Service\r\n    @RequiredArgsConstructor\r\n    public class ProductServiceImpl implements ProductService {\r\n\r\n    private final ProductMapper productMapper;\r\n    private final ProductRepository productRepository;\r\n\r\n    @Override\r\n    @Transactional\r\n    public ProductResponse createProduct(ProductRequest productRequest) {\r\n        Product product = productMapper.mapToEntity(productRequest);\r\n        Product savedProduct = productRepository.save(product);\r\n        log.info(&quot;New product saved. Id = {}&quot;, savedProduct.getId());\r\n        return productMapper.mapToResponse(savedProduct);\r\n    }\r\n\r\n    }\r\n\r\nDTO with spring validation annotations for controller and service \r\n\r\n    @Getter\r\n    @Setter\r\n    public class ProductRequest {\r\n\r\n        @NotBlank(message = &quot;{name.not-blank}&quot;)\r\n        private String name;\r\n\r\n        @Positive(message = &quot;{amount.positive}&quot;)\r\n        private Integer amount;\r\n\r\n        @Positive(message = &quot;{price.positive}&quot;)\r\n        private Double price;\r\n    }\r\n\r\nMesagge in message.properties file:\r\n\r\n    name.not-blank=Name field is required\r\n\r\n\r\n\r\nthe exceptions are handled in RestExceptionHandler:\r\n\r\n    @ExceptionHandler(MethodArgumentNotValidException.class)\r\n    protected ResponseEntity&lt;ExceptionResponse&gt; handleMethodArgumentNotValidException(MethodArgumentNotValidException ex) {\r\n        String message = ex.getAllErrors().stream()\r\n                .map(DefaultMessageSourceResolvable::getDefaultMessage)\r\n                .collect(Collectors.joining(&quot;, &quot;));\r\n        ExceptionResponse response = new ExceptionResponse(message);\r\n        log.error(message);\r\n        return new ResponseEntity&lt;&gt;(response, HttpStatus.BAD_REQUEST);\r\n    }\r\n\r\n\r\nAnd if I launch the app, and don&#39;t fill the name field of ProductRequest, I get the message according to my messages.properties file: &quot;Name field is required&quot;\r\n[enter image description here](https://i.stack.imgur.com/JzLuU.png)\r\n\r\nBut, if I create test and don&#39;t fill the same field in creating ProductRequest:\r\n\r\n    public class ProductServiceTest {\r\n\r\n    private final ProductRepository productRepository = mock(ProductRepository.class);\r\n    private final ProductMapper productMapper = new ProductMapperImpl();\r\n    private final ProductServiceImpl productService =\r\n            new ProductServiceImpl(\r\n                    productMapper,\r\n                    productRepository);\r\n\r\n    @Test\r\n    void whenEmptyNameProduct() {\r\n        var productRequest = buildProduct();\r\n        var product = productMapper.mapToEntity(productRequest);\r\n        when(productRepository.save(any())).thenReturn(product);\r\n        var productResponse = productMapper.mapToResponse(product);\r\n        MethodArgumentNotValidException thrown = assertThrows(\r\n                MethodArgumentNotValidException.class,\r\n                () -&gt; productService.createProduct(productRequest));\r\n        assertTrue(thrown.getMessage().contentEquals(&quot;Name field is required&quot;));\r\n    }\r\n\r\n    private ProductRequest buildProduct() {\r\n        ProductRequest request = new ProductRequest();\r\n    //        request.setName(&quot;&quot;);\r\n        request.setAmount(0);\r\n        request.setPrice(500.0);\r\n        return request;\r\n    }\r\n\r\n    }\r\n\r\nI get the message from console:\r\n\r\n&gt; org.opentest4j.AssertionFailedError: Expected org.springframework.web.bind.MethodArgumentNotValidException to be thrown, but nothing was thrown.\r\n\r\n[enter image description here](https://i.stack.imgur.com/PvNlf.png)\r\n\r\n\r\nI&#39;ve also tried to remove the exception handling from RestExceptionHandler, and launch the app, but in this case I get the massage:\r\n\r\n&gt; Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.guavapay.delivery.dto.response.ProductResponse com.guavapay.delivery.controller.ProductController.createProduct(com.guavapay.delivery.dto.request.ProductRequest): [Field error in object &#39;productRequest&#39; on field &#39;name&#39;: rejected value []; codes [NotBlank.productRequest.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [productRequest.name,name]; arguments []; default message [name]]; default message [Name field is required]] ]\r\n\r\n[enter image description here](https://i.stack.imgur.com/dDghU.png)\r\nwhere the MethodArgumentNotValidException is contained.\r\n\r\nAnd I am confused, what do I need to do that to test the @NotBlank annotation properly and get the MethodArgumentNotValidException for asserting in test?.. \r\n\r\nCould you advise me anything?","title":"How to test @NotBlank spring validation with JUnit? [RESOLVED]","body":"<p>I am trying to test validation I have a controller</p>\n<pre><code>@RestController\n@RequestMapping(&quot;/product&quot;)\n@RequiredArgsConstructor\n@CrossOrigin\npublic class ProductController {\n\nprivate final ProductService productService;\n\n@PreAuthorize(&quot;hasRole('ROLE_ADMIN')&quot;)\n@PostMapping\npublic ProductResponse createProduct(@RequestBody @Valid ProductRequest request) {\n    return productService.createProduct(request);\n }\n}\n</code></pre>\n<p>service</p>\n<pre><code>@Slf4j\n@Service\n@RequiredArgsConstructor\npublic class ProductServiceImpl implements ProductService {\n\nprivate final ProductMapper productMapper;\nprivate final ProductRepository productRepository;\n\n@Override\n@Transactional\npublic ProductResponse createProduct(ProductRequest productRequest) {\n    Product product = productMapper.mapToEntity(productRequest);\n    Product savedProduct = productRepository.save(product);\n    log.info(&quot;New product saved. Id = {}&quot;, savedProduct.getId());\n    return productMapper.mapToResponse(savedProduct);\n}\n\n}\n</code></pre>\n<p>DTO with spring validation annotations for controller and service</p>\n<pre><code>@Getter\n@Setter\npublic class ProductRequest {\n\n    @NotBlank(message = &quot;{name.not-blank}&quot;)\n    private String name;\n\n    @Positive(message = &quot;{amount.positive}&quot;)\n    private Integer amount;\n\n    @Positive(message = &quot;{price.positive}&quot;)\n    private Double price;\n}\n</code></pre>\n<p>Mesagge in message.properties file:</p>\n<pre><code>name.not-blank=Name field is required\n</code></pre>\n<p>the exceptions are handled in RestExceptionHandler:</p>\n<pre><code>@ExceptionHandler(MethodArgumentNotValidException.class)\nprotected ResponseEntity&lt;ExceptionResponse&gt; handleMethodArgumentNotValidException(MethodArgumentNotValidException ex) {\n    String message = ex.getAllErrors().stream()\n            .map(DefaultMessageSourceResolvable::getDefaultMessage)\n            .collect(Collectors.joining(&quot;, &quot;));\n    ExceptionResponse response = new ExceptionResponse(message);\n    log.error(message);\n    return new ResponseEntity&lt;&gt;(response, HttpStatus.BAD_REQUEST);\n}\n</code></pre>\n<p>And if I launch the app, and don't fill the name field of ProductRequest, I get the message according to my messages.properties file: &quot;Name field is required&quot;\n<a href=\"https://i.stack.imgur.com/JzLuU.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n<p>But, if I create test and don't fill the same field in creating ProductRequest:</p>\n<pre><code>public class ProductServiceTest {\n\nprivate final ProductRepository productRepository = mock(ProductRepository.class);\nprivate final ProductMapper productMapper = new ProductMapperImpl();\nprivate final ProductServiceImpl productService =\n        new ProductServiceImpl(\n                productMapper,\n                productRepository);\n\n@Test\nvoid whenEmptyNameProduct() {\n    var productRequest = buildProduct();\n    var product = productMapper.mapToEntity(productRequest);\n    when(productRepository.save(any())).thenReturn(product);\n    var productResponse = productMapper.mapToResponse(product);\n    MethodArgumentNotValidException thrown = assertThrows(\n            MethodArgumentNotValidException.class,\n            () -&gt; productService.createProduct(productRequest));\n    assertTrue(thrown.getMessage().contentEquals(&quot;Name field is required&quot;));\n}\n\nprivate ProductRequest buildProduct() {\n    ProductRequest request = new ProductRequest();\n//        request.setName(&quot;&quot;);\n    request.setAmount(0);\n    request.setPrice(500.0);\n    return request;\n}\n\n}\n</code></pre>\n<p>I get the message from console:</p>\n<blockquote>\n<p>org.opentest4j.AssertionFailedError: Expected org.springframework.web.bind.MethodArgumentNotValidException to be thrown, but nothing was thrown.</p>\n</blockquote>\n<p><a href=\"https://i.stack.imgur.com/PvNlf.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n<p>I've also tried to remove the exception handling from RestExceptionHandler, and launch the app, but in this case I get the massage:</p>\n<blockquote>\n<p>Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.guavapay.delivery.dto.response.ProductResponse com.guavapay.delivery.controller.ProductController.createProduct(com.guavapay.delivery.dto.request.ProductRequest): [Field error in object 'productRequest' on field 'name': rejected value []; codes [NotBlank.productRequest.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [productRequest.name,name]; arguments []; default message [name]]; default message [Name field is required]] ]</p>\n</blockquote>\n<p><a href=\"https://i.stack.imgur.com/dDghU.png\" rel=\"nofollow noreferrer\">enter image description here</a>\nwhere the MethodArgumentNotValidException is contained.</p>\n<p>And I am confused, what do I need to do that to test the @NotBlank annotation properly and get the MethodArgumentNotValidException for asserting in test?..</p>\n<p>Could you advise me anything?</p>\n"},{"tags":["java","mockito"],"comments":[{"owner":{"account_id":11683,"reputation":1438219,"user_id":22656,"accept_rate":86,"display_name":"Jon Skeet"},"score":1,"creation_date":1631107456,"post_id":69103108,"comment_id":122134506,"body_markdown":"What exactly do you mean by &quot;while parsing for the negative scenario&quot;? When do you expect `ofInstant` to fail? And is there any reason you have to do this with mocking rather than injecting the time zone (which will help with all kinds of testing) and just using a suitable zone/instant combination? (In other words, I&#39;d say that the first sentence of this question is wrong - you need to test your code, but that&#39;s not the same as needing to mock ofInstant.)","body":"What exactly do you mean by &quot;while parsing for the negative scenario&quot;? When do you expect <code>ofInstant</code> to fail? And is there any reason you have to do this with mocking rather than injecting the time zone (which will help with all kinds of testing) and just using a suitable zone/instant combination? (In other words, I&#39;d say that the first sentence of this question is wrong - you need to test your code, but that&#39;s not the same as needing to mock ofInstant.)"}],"answers":[{"comments":[{"owner":{"account_id":7720636,"reputation":1532,"user_id":5846981,"accept_rate":100,"display_name":"Som"},"score":1,"creation_date":1631105509,"post_id":69103252,"comment_id":122133493,"body_markdown":"ZonedDateTime is a final Class. It cannot be mocked in this way.","body":"ZonedDateTime is a final Class. It cannot be mocked in this way."},{"owner":{"account_id":748890,"reputation":9396,"user_id":730754,"accept_rate":50,"display_name":"Eduardo Y&#225;&#241;ez Parareda"},"score":0,"creation_date":1631106039,"post_id":69103252,"comment_id":122133767,"body_markdown":"You&#39;re right, then the only solution is to use something like PowerMockito","body":"You&#39;re right, then the only solution is to use something like PowerMockito"},{"owner":{"account_id":15856821,"reputation":2451,"user_id":11441011,"display_name":"maloomeister"},"score":0,"creation_date":1631106659,"post_id":69103252,"comment_id":122134066,"body_markdown":"@EduardoY&#225;&#241;ezParareda `mockStatic` does not return a mocked object. The stubbing is to be done on the class, once it is mocked via `mockStatic()`.","body":"@EduardoY&#225;&#241;ezParareda <code>mockStatic</code> does not return a mocked object. The stubbing is to be done on the class, once it is mocked via <code>mockStatic()</code>."},{"owner":{"account_id":748890,"reputation":9396,"user_id":730754,"accept_rate":50,"display_name":"Eduardo Y&#225;&#241;ez Parareda"},"score":0,"creation_date":1631106971,"post_id":69103252,"comment_id":122134227,"body_markdown":"Yes, I made mistakes when adapting to PowerMock, now it should be ok.","body":"Yes, I made mistakes when adapting to PowerMock, now it should be ok."},{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":4,"creation_date":1631107018,"post_id":69103252,"comment_id":122134254,"body_markdown":"Current version of Mockito supports mocking statics too.","body":"Current version of Mockito supports mocking statics too."},{"owner":{"account_id":15856821,"reputation":2451,"user_id":11441011,"display_name":"maloomeister"},"score":0,"creation_date":1631107154,"post_id":69103252,"comment_id":122134343,"body_markdown":"@EduardoY&#225;&#241;ezParareda The parentheses on the last line are still off, fyi.","body":"@EduardoY&#225;&#241;ezParareda The parentheses on the last line are still off, fyi."}],"tags":[],"owner":{"account_id":748890,"reputation":9396,"user_id":730754,"accept_rate":50,"display_name":"Eduardo Y&#225;&#241;ez Parareda"},"comment_count":6,"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1631108605,"creation_date":1631104667,"answer_id":69103252,"question_id":69103108,"body_markdown":"You cannot use `Mockito` for this because `ZonedDateTime` is a final class and `ofInstant` is a _static_ method, but you can use the `PowerMock` library to enhance `Mockito` capabilities:\r\n\r\n    final String error = &quot;Error while parsing the effective end date&quot;;\r\n    // Enable static mocking for all methods of a class\r\n    mockStatic(ZonedDateTime.class);\r\n    PowerMockito.doThrow(new DateTimeException(error).when(ZonedDateTime.ofInstant(Mockito.anyObject(), Mockito.anyObject()));","title":"How to Mock a ZonedDateTime with Mockito and Junit","body":"<p>You cannot use <code>Mockito</code> for this because <code>ZonedDateTime</code> is a final class and <code>ofInstant</code> is a <em>static</em> method, but you can use the <code>PowerMock</code> library to enhance <code>Mockito</code> capabilities:</p>\n<pre><code>final String error = &quot;Error while parsing the effective end date&quot;;\n// Enable static mocking for all methods of a class\nmockStatic(ZonedDateTime.class);\nPowerMockito.doThrow(new DateTimeException(error).when(ZonedDateTime.ofInstant(Mockito.anyObject(), Mockito.anyObject()));\n</code></pre>\n"},{"tags":[],"owner":{"account_id":12541443,"reputation":633,"user_id":9126244,"display_name":"hfc"},"comment_count":0,"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1649834867,"creation_date":1647623498,"answer_id":71530773,"question_id":69103108,"body_markdown":"As of now (18/03/2022) Mockito supports mocking static methods. You can do \r\n\r\n    @Test\r\n    public void testDate() {\r\n        String instantExpected = &quot;2022-03-14T09:33:52Z&quot;;\r\n        ZonedDateTime zonedDateTime = ZonedDateTime.parse(instantExpected);\r\n\r\n        try (MockedStatic&lt;ZonedDateTime&gt; mockedLocalDateTime = Mockito.mockStatic(ZonedDateTime.class)) {\r\n            mockedLocalDateTime.when(ZonedDateTime::now).thenReturn(zonedDateTime);\r\n\r\n            assertThat(yourService.getCurrentDate()).isEqualTo(zonedDateTime);\r\n        }\r\n    }\r\n\r\nPlease note that you need to use `mockito-inline` dependency:\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.mockito&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;mockito-inline&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;4.4.0&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;","title":"How to Mock a ZonedDateTime with Mockito and Junit","body":"<p>As of now (18/03/2022) Mockito supports mocking static methods. You can do</p>\n<pre><code>@Test\npublic void testDate() {\n    String instantExpected = &quot;2022-03-14T09:33:52Z&quot;;\n    ZonedDateTime zonedDateTime = ZonedDateTime.parse(instantExpected);\n\n    try (MockedStatic&lt;ZonedDateTime&gt; mockedLocalDateTime = Mockito.mockStatic(ZonedDateTime.class)) {\n        mockedLocalDateTime.when(ZonedDateTime::now).thenReturn(zonedDateTime);\n\n        assertThat(yourService.getCurrentDate()).isEqualTo(zonedDateTime);\n    }\n}\n</code></pre>\n<p>Please note that you need to use <code>mockito-inline</code> dependency:</p>\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.mockito&lt;/groupId&gt;\n        &lt;artifactId&gt;mockito-inline&lt;/artifactId&gt;\n        &lt;version&gt;4.4.0&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11686211,"reputation":161,"user_id":8555991,"display_name":"fiver6"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694363177,"creation_date":1694363177,"answer_id":77076976,"question_id":69103108,"body_markdown":"As of 01/14/2023 with &quot;mockito-core&quot; 5.0.0, we don&#39;t need to add &quot;mockito-inline&quot; dependency anymore to mock ZonedDateTime with Mockito.\r\n\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.mockito&lt;/groupId&gt;\r\n            &lt;artifactId&gt;mockito-core&lt;/artifactId&gt;\r\n            &lt;version&gt;5.0.0&lt;/version&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\nThen, use it as:\r\n\r\n        @Test\r\n        void test() {\r\n        ZonedDateTime zonedDateTime = ZonedDateTime.parse(&quot;2024-01-01T00:00:00.000000+03:00[Europe/Istanbul]&quot;);\r\n        try (MockedStatic&lt;ZonedDateTime&gt; mockedStatic = mockStatic(ZonedDateTime.class)) {\r\n            mockedStatic.when(() -&gt; ZonedDateTime.now(ZoneId.of(&quot;Europe/Istanbul&quot;))).thenReturn(zonedDateTime);\r\n            System.out.println(ZonedDateTime.now(ZoneId.of(&quot;Europe/Istanbul&quot;)));\r\n        }\r\n    }","title":"How to Mock a ZonedDateTime with Mockito and Junit","body":"<p>As of 01/14/2023 with &quot;mockito-core&quot; 5.0.0, we don't need to add &quot;mockito-inline&quot; dependency anymore to mock ZonedDateTime with Mockito.</p>\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.mockito&lt;/groupId&gt;\n        &lt;artifactId&gt;mockito-core&lt;/artifactId&gt;\n        &lt;version&gt;5.0.0&lt;/version&gt;\n        &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<p>Then, use it as:</p>\n<pre><code>    @Test\n    void test() {\n    ZonedDateTime zonedDateTime = ZonedDateTime.parse(&quot;2024-01-01T00:00:00.000000+03:00[Europe/Istanbul]&quot;);\n    try (MockedStatic&lt;ZonedDateTime&gt; mockedStatic = mockStatic(ZonedDateTime.class)) {\n        mockedStatic.when(() -&gt; ZonedDateTime.now(ZoneId.of(&quot;Europe/Istanbul&quot;))).thenReturn(zonedDateTime);\n        System.out.println(ZonedDateTime.now(ZoneId.of(&quot;Europe/Istanbul&quot;)));\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":7720636,"reputation":1532,"user_id":5846981,"accept_rate":100,"display_name":"Som"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":8643,"favorite_count":0,"down_vote_count":0,"up_vote_count":7,"accepted_answer_id":69103252,"answer_count":3,"score":7,"last_activity_date":1694363177,"creation_date":1631104027,"question_id":69103108,"body_markdown":"I need to mock a `ZonedDateTime.ofInstant()` method. I know there are many suggestions in SO but for my specific problem, till now I did not get any simple way out.\r\n\r\nHere is my code :\r\n\r\n    public ZonedDateTime myMethodToTest(){\r\n\r\n        MyClass myClass;\r\n        myClass = fetchSomethingFromDB();\r\n        try{\r\n            final ZoneId systemDefault = ZoneId.systemDefault();\r\n            return ZonedDateTime.ofInstant(myClass.getEndDt().toInstant(), systemDefault);\r\n        } catch(DateTimeException dte) {\r\n            return null;\r\n        }\r\n        \r\n    }\r\n\r\nHere is my incomplete Test method :\r\n\r\n     @Mock\r\n     MyClass mockMyClass;\r\n\r\n     @Test(expected = DateTimeException.class)\r\n     public void testmyMethodToTest_Exception() {\r\n        String error = &quot;Error while parsing the effective end date&quot;;\r\n        doThrow(new DateTimeException(error)).when(--need to mock here---);\r\n        ZonedDateTime dateTime = mockMyClass.myMethodTotest();\r\n    }\r\n\r\nI want to mock the `ZonedDateTime.ofInstant()` method to throw a DateTimeException while parsing for the negative scenario. How I can do that.","title":"How to Mock a ZonedDateTime with Mockito and Junit","body":"<p>I need to mock a <code>ZonedDateTime.ofInstant()</code> method. I know there are many suggestions in SO but for my specific problem, till now I did not get any simple way out.</p>\n<p>Here is my code :</p>\n<pre><code>public ZonedDateTime myMethodToTest(){\n\n    MyClass myClass;\n    myClass = fetchSomethingFromDB();\n    try{\n        final ZoneId systemDefault = ZoneId.systemDefault();\n        return ZonedDateTime.ofInstant(myClass.getEndDt().toInstant(), systemDefault);\n    } catch(DateTimeException dte) {\n        return null;\n    }\n    \n}\n</code></pre>\n<p>Here is my incomplete Test method :</p>\n<pre><code> @Mock\n MyClass mockMyClass;\n\n @Test(expected = DateTimeException.class)\n public void testmyMethodToTest_Exception() {\n    String error = &quot;Error while parsing the effective end date&quot;;\n    doThrow(new DateTimeException(error)).when(--need to mock here---);\n    ZonedDateTime dateTime = mockMyClass.myMethodTotest();\n}\n</code></pre>\n<p>I want to mock the <code>ZonedDateTime.ofInstant()</code> method to throw a DateTimeException while parsing for the negative scenario. How I can do that.</p>\n"},{"tags":["java","list","enums"],"comments":[{"owner":{"account_id":141282,"reputation":10126,"user_id":348189,"accept_rate":89,"display_name":"TacB0sS"},"score":0,"creation_date":1419500489,"post_id":16149117,"comment_id":43710045,"body_markdown":"ArrayList&lt;Something&gt; list = new ArrayList&lt;Something&gt;(Arrays.asList(Something.values()))","body":"ArrayList&lt;Something&gt; list = new ArrayList&lt;Something&gt;(Arrays.asList(Something.values()))"}],"answers":[{"comments":[{"owner":{"account_id":4910,"reputation":9204,"user_id":7616,"accept_rate":75,"display_name":"shyam"},"score":1,"creation_date":1366639558,"post_id":16149150,"comment_id":23073450,"body_markdown":"Then you could simply do `Something.class.getEnumConstants()` right?","body":"Then you could simply do <code>Something.class.getEnumConstants()</code> right?"},{"owner":{"account_id":23121,"reputation":527376,"user_id":57695,"accept_rate":75,"display_name":"Peter Lawrey"},"score":2,"creation_date":1366639599,"post_id":16149150,"comment_id":23073482,"body_markdown":"... or `Something.values();`","body":"... or <code>Something.values();</code>"}],"tags":[],"owner":{"account_id":395472,"reputation":12714,"user_id":758446,"accept_rate":93,"display_name":"BlackVegetable"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1366639453,"creation_date":1366639453,"answer_id":16149150,"question_id":16149117,"body_markdown":"This is a bit more readable:\r\n\r\n    Object[] allValues = all.getDeclaringClass().getEnumConstants();","title":"Filling a List with all enum values in Java","body":"<p>This is a bit more readable:</p>\n\n<pre><code>Object[] allValues = all.getDeclaringClass().getEnumConstants();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":41850,"reputation":132328,"user_id":121747,"accept_rate":89,"display_name":"Jack"},"comment_count":0,"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1366639494,"creation_date":1366639494,"answer_id":16149162,"question_id":16149117,"body_markdown":"There is a constructor for `ArrayList` which is\r\n\r\n    ArrayList(Collection&lt;? extends E&gt; c) \r\n\r\nNow, `EnumSet` extends `AbstractCollection` so you can just do\r\n\r\n    ArrayList&lt;Something&gt; all = new ArrayList&lt;Something&gt;(enumSet)","title":"Filling a List with all enum values in Java","body":"<p>There is a constructor for <code>ArrayList</code> which is</p>\n\n<pre><code>ArrayList(Collection&lt;? extends E&gt; c) \n</code></pre>\n\n<p>Now, <code>EnumSet</code> extends <code>AbstractCollection</code> so you can just do</p>\n\n<pre><code>ArrayList&lt;Something&gt; all = new ArrayList&lt;Something&gt;(enumSet)\n</code></pre>\n"},{"comments":[{"owner":{"account_id":111587,"reputation":11539,"user_id":294702,"accept_rate":90,"display_name":"MonoThreaded"},"score":3,"creation_date":1366639584,"post_id":16149165,"comment_id":23073470,"body_markdown":"Sometimes EnumSet don&#39;t cut it. In particular when order matters","body":"Sometimes EnumSet don&#39;t cut it. In particular when order matters"},{"owner":{"account_id":23121,"reputation":527376,"user_id":57695,"accept_rate":75,"display_name":"Peter Lawrey"},"score":1,"creation_date":1366639655,"post_id":16149165,"comment_id":23073531,"body_markdown":"@MonoThreaded What order did you have in mind? An EnumSet is in the natural order for an enum. The list will be in the same order as the set, so using a List doesn&#39;t change anything here.","body":"@MonoThreaded What order did you have in mind? An EnumSet is in the natural order for an enum. The list will be in the same order as the set, so using a List doesn&#39;t change anything here."},{"owner":{"account_id":111587,"reputation":11539,"user_id":294702,"accept_rate":90,"display_name":"MonoThreaded"},"score":1,"creation_date":1366640229,"post_id":16149165,"comment_id":23073945,"body_markdown":"Sorry, ordering is out of scope for this question. I believe you meant values() in the first example.","body":"Sorry, ordering is out of scope for this question. I believe you meant values() in the first example."},{"owner":{"account_id":3068738,"reputation":662,"user_id":2599884,"accept_rate":86,"display_name":"buzzsawddog"},"score":0,"creation_date":1392823180,"post_id":16149165,"comment_id":33137390,"body_markdown":"@PeterLawrey we use Enums all the time.  When we design a workflow the approval process may not move in the `Natural Order` of the Enum, this is why a `List&lt;Enum&gt;` comes in handy vs an `EnumSet`.","body":"@PeterLawrey we use Enums all the time.  When we design a workflow the approval process may not move in the <code>Natural Order</code> of the Enum, this is why a <code>List&lt;Enum&gt;</code> comes in handy vs an <code>EnumSet</code>."},{"owner":{"account_id":16917807,"reputation":1246,"user_id":12235376,"display_name":"pallgeuer"},"score":0,"creation_date":1609783445,"post_id":16149165,"comment_id":115924769,"body_markdown":"`EnumSet` does not have a `get()` method (easy random access) while `List` does. This may be important for whatever the List/EnumSet is intended to be used for","body":"<code>EnumSet</code> does not have a <code>get()</code> method (easy random access) while <code>List</code> does. This may be important for whatever the List/EnumSet is intended to be used for"}],"tags":[],"owner":{"account_id":23121,"reputation":527376,"user_id":57695,"accept_rate":75,"display_name":"Peter Lawrey"},"comment_count":5,"down_vote_count":0,"up_vote_count":205,"is_accepted":true,"score":205,"last_activity_date":1366640306,"creation_date":1366639501,"answer_id":16149165,"question_id":16149117,"body_markdown":"I wouldn&#39;t use a List in the first places as an EnumSet is more approriate but you can do\r\n\r\n    List&lt;Something&gt; somethingList = Arrays.asList(Something.values());\r\n\r\nor\r\n\r\n    List&lt;Something&gt; somethingList =\r\n                     new ArrayList&lt;Something&gt;(EnumSet.allOf(Something.class));\r\n","title":"Filling a List with all enum values in Java","body":"<p>I wouldn't use a List in the first places as an EnumSet is more approriate but you can do</p>\n\n<pre><code>List&lt;Something&gt; somethingList = Arrays.asList(Something.values());\n</code></pre>\n\n<p>or</p>\n\n<pre><code>List&lt;Something&gt; somethingList =\n                 new ArrayList&lt;Something&gt;(EnumSet.allOf(Something.class));\n</code></pre>\n"},{"tags":[],"owner":{"account_id":29332,"reputation":12535,"user_id":79207,"accept_rate":72,"display_name":"planetjones"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1366639547,"creation_date":1366639547,"answer_id":16149177,"question_id":16149117,"body_markdown":"    List&lt;Something&gt; result = new ArrayList&lt;Something&gt;(all);\r\n\r\n`EnumSet` is a Java Collection, as it implements the `Set` interface:\r\n\r\n    public interface Set&lt;E&gt; extends Collection&lt;E&gt; \r\n\r\nSo anything you can do with a Collection you can do with an `EnumSet`.","title":"Filling a List with all enum values in Java","body":"<pre><code>List&lt;Something&gt; result = new ArrayList&lt;Something&gt;(all);\n</code></pre>\n\n<p><code>EnumSet</code> is a Java Collection, as it implements the <code>Set</code> interface:</p>\n\n<pre><code>public interface Set&lt;E&gt; extends Collection&lt;E&gt; \n</code></pre>\n\n<p>So anything you can do with a Collection you can do with an <code>EnumSet</code>.</p>\n"},{"comments":[{"owner":{"account_id":29332,"reputation":12535,"user_id":79207,"accept_rate":72,"display_name":"planetjones"},"score":0,"creation_date":1366640134,"post_id":16149195,"comment_id":23073885,"body_markdown":"worth clarifying that you do not get a java.util.ArrayList out of this, as stated in the question","body":"worth clarifying that you do not get a java.util.ArrayList out of this, as stated in the question"}],"tags":[],"owner":{"account_id":2052678,"reputation":134073,"user_id":1831293,"accept_rate":91,"display_name":"Evgeniy Dorofeev"},"comment_count":1,"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1366639580,"creation_date":1366639580,"answer_id":16149195,"question_id":16149117,"body_markdown":"try\r\n\r\n\tenum E {\r\n\t\tE1, E2, E3\r\n\t}\r\n\r\n\tpublic static void main(String[] args) throws Exception {\r\n\t\tList&lt;E&gt; list = Arrays.asList(E.values());\r\n\t\tSystem.out.println(list);\r\n\t}\r\n","title":"Filling a List with all enum values in Java","body":"<p>try</p>\n\n<pre><code>enum E {\n    E1, E2, E3\n}\n\npublic static void main(String[] args) throws Exception {\n    List&lt;E&gt; list = Arrays.asList(E.values());\n    System.out.println(list);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2023007,"reputation":2962,"user_id":1808743,"accept_rate":88,"display_name":"Joshua"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1366639725,"creation_date":1366639725,"answer_id":16149256,"question_id":16149117,"body_markdown":"Try this:\r\n    \r\n    ... = new ArrayList&lt;Something&gt;(EnumSet.allOf(Something.class));\r\n\r\nas `ArrayList` has a constructor with `Collection&lt;? extends E&gt;`. But use this method only if you really want to use `EnumSet`.\r\n\r\nAll enums have access to the method `values()`. It returns an array of all enum values:\r\n\r\n    ... = Arrays.asList(Something.values());","title":"Filling a List with all enum values in Java","body":"<p>Try this:</p>\n\n<pre><code>... = new ArrayList&lt;Something&gt;(EnumSet.allOf(Something.class));\n</code></pre>\n\n<p>as <code>ArrayList</code> has a constructor with <code>Collection&lt;? extends E&gt;</code>. But use this method only if you really want to use <code>EnumSet</code>.</p>\n\n<p>All enums have access to the method <code>values()</code>. It returns an array of all enum values:</p>\n\n<pre><code>... = Arrays.asList(Something.values());\n</code></pre>\n"},{"tags":[],"owner":{"account_id":62229,"reputation":21708,"user_id":185022,"accept_rate":81,"display_name":"AZ_"},"comment_count":0,"down_vote_count":0,"up_vote_count":16,"is_accepted":false,"score":16,"last_activity_date":1419498503,"creation_date":1419498503,"answer_id":27645804,"question_id":16149117,"body_markdown":"[`Class.getEnumConstants()`][1]\r\n\r\n    List&lt;SOME_ENUM&gt; enumList = Arrays.asList(SOME_ENUM.class.getEnumConstants());\r\n\r\n\r\n  [1]: http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getEnumConstants%28%29","title":"Filling a List with all enum values in Java","body":"<p><a href=\"http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getEnumConstants%28%29\" rel=\"noreferrer\"><code>Class.getEnumConstants()</code></a></p>\n\n<pre><code>List&lt;SOME_ENUM&gt; enumList = Arrays.asList(SOME_ENUM.class.getEnumConstants());\n</code></pre>\n"},{"comments":[{"owner":{"account_id":11764939,"reputation":3827,"user_id":8609847,"display_name":"Satish Patro"},"score":0,"creation_date":1587980395,"post_id":37279227,"comment_id":108712730,"body_markdown":"I am getting hexCode","body":"I am getting hexCode"}],"tags":[],"owner":{"account_id":178949,"reputation":12261,"user_id":411247,"accept_rate":91,"display_name":"Topera"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1463495911,"creation_date":1463495911,"answer_id":37279227,"question_id":16149117,"body_markdown":"You can use also:\r\n\r\n    Collections.singletonList(Something.values())","title":"Filling a List with all enum values in Java","body":"<p>You can use also:</p>\n\n<pre><code>Collections.singletonList(Something.values())\n</code></pre>\n"},{"tags":[],"owner":{"account_id":14267852,"reputation":1,"user_id":10306369,"display_name":"سيدا الشايقي"},"comment_count":0,"down_vote_count":3,"up_vote_count":0,"is_accepted":false,"score":-3,"last_activity_date":1535888598,"creation_date":1535888423,"answer_id":52136671,"question_id":16149117,"body_markdown":"    private ComboBox gender;\r\n    private enum Selgender{Male,Famle};\r\n    ObservableList&lt;Object&gt; observableList  =FXCollections.observableArrayList(Selgender.values());\r\n        \r\n\r\n","title":"Filling a List with all enum values in Java","body":"<pre><code>private ComboBox gender;\nprivate enum Selgender{Male,Famle};\nObservableList&lt;Object&gt; observableList  =FXCollections.observableArrayList(Selgender.values());\n</code></pre>\n"},{"tags":[],"owner":{"account_id":19044543,"reputation":6393,"user_id":13903942,"display_name":"Federico Ba&#249;"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694362644,"creation_date":1694362644,"answer_id":77076946,"question_id":16149117,"body_markdown":"I know the question is asking about `List` but I think I have possible cleaner solutions as well as one solution using `List` that wasn&#39;t added yet.\r\n\r\nI&#39;m using `Java 17` \r\n\r\n### Simply use a array of `enum`\r\n\r\n\r\n```java\r\npublic class Main {\r\n    static public enum Something {\r\n        One,\r\n        Two,\r\n        Three,\r\n        Four,\r\n        Five,\r\n        ;\r\n\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        Something[] somethings = Something.values();\r\n        for (Something something: somethings) {\r\n            System.out.printf(&quot;- %s\\n&quot;, something);\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n```\r\n\r\nSimple get all values of the enum with `enum.values()`\r\n\r\n`Something[] somethings = Something.values();`\r\n\r\n#### Use `list.of`\r\n\r\n```java\r\n\r\nimport java.util.List;\r\n\r\npublic class Main {\r\n    static public enum Something {\r\n        One,\r\n        Two,\r\n        Three,\r\n        Four,\r\n        Five,\r\n        ;\r\n\r\n    }\r\n\r\n    public static void main(String[] args) { \r\n        List&lt;Something&gt; somethings2 = List.of(Something.values());\r\n        for (Something something: somethings2) {\r\n            System.out.printf(&quot;- %s\\n&quot;, something);\r\n        }\r\n    }\r\n\r\n}\r\n\r\n```\r\n\r\nI&#39;ve seen solutions using `Arrays.asList(` which as described in [What is the difference between List.of and Arrays.asList?][1]\r\n\r\n&gt; `Arrays.asList` returns a mutable list while the list returned by `List.of` is [immutable](https://docs.oracle.com/javase/9/docs/api/java/util/List.html#immutable)\r\n\r\nor \r\n\r\n&gt; `Arrays.asList` allows null elements while `List.of` doesn&#39;t\r\n\r\nAnd few other reasons.\r\nBecause theoretically, from an Array of `enum` you should&#39;t be able to mutate it (adding / removing elements) I think it makes more sense to use `List.of`\r\nAnyways, it depends by use cases and both ways are probably valid\r\n\r\n\r\n  [1]: https://stackoverflow.com/a/46579348/13903942","title":"Filling a List with all enum values in Java","body":"<p>I know the question is asking about <code>List</code> but I think I have possible cleaner solutions as well as one solution using <code>List</code> that wasn't added yet.</p>\n<p>I'm using <code>Java 17</code></p>\n<h3>Simply use a array of <code>enum</code></h3>\n<pre class=\"lang-java prettyprint-override\"><code>public class Main {\n    static public enum Something {\n        One,\n        Two,\n        Three,\n        Four,\n        Five,\n        ;\n\n    }\n\n    public static void main(String[] args) {\n        Something[] somethings = Something.values();\n        for (Something something: somethings) {\n            System.out.printf(&quot;- %s\\n&quot;, something);\n        }\n\n    }\n\n}\n\n</code></pre>\n<p>Simple get all values of the enum with <code>enum.values()</code></p>\n<p><code>Something[] somethings = Something.values();</code></p>\n<h4>Use <code>list.of</code></h4>\n<pre class=\"lang-java prettyprint-override\"><code>\nimport java.util.List;\n\npublic class Main {\n    static public enum Something {\n        One,\n        Two,\n        Three,\n        Four,\n        Five,\n        ;\n\n    }\n\n    public static void main(String[] args) { \n        List&lt;Something&gt; somethings2 = List.of(Something.values());\n        for (Something something: somethings2) {\n            System.out.printf(&quot;- %s\\n&quot;, something);\n        }\n    }\n\n}\n\n</code></pre>\n<p>I've seen solutions using <code>Arrays.asList(</code> which as described in <a href=\"https://stackoverflow.com/a/46579348/13903942\">What is the difference between List.of and Arrays.asList?</a></p>\n<blockquote>\n<p><code>Arrays.asList</code> returns a mutable list while the list returned by <code>List.of</code> is <a href=\"https://docs.oracle.com/javase/9/docs/api/java/util/List.html#immutable\" rel=\"nofollow noreferrer\">immutable</a></p>\n</blockquote>\n<p>or</p>\n<blockquote>\n<p><code>Arrays.asList</code> allows null elements while <code>List.of</code> doesn't</p>\n</blockquote>\n<p>And few other reasons.\nBecause theoretically, from an Array of <code>enum</code> you should't be able to mutate it (adding / removing elements) I think it makes more sense to use <code>List.of</code>\nAnyways, it depends by use cases and both ways are probably valid</p>\n"}],"owner":{"account_id":111587,"reputation":11539,"user_id":294702,"accept_rate":90,"display_name":"MonoThreaded"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":211812,"favorite_count":0,"down_vote_count":0,"up_vote_count":104,"accepted_answer_id":16149165,"answer_count":10,"score":104,"last_activity_date":1694362644,"creation_date":1366639337,"question_id":16149117,"body_markdown":"I would like to fill a list with all possible values of an enum&lt;br&gt;\r\nSince I recently fell in love with `EnumSet`, I leveraged `allOf()`&lt;br&gt;\r\n\r\n    EnumSet&lt;Something&gt; all = EnumSet.allOf( Something.class);\r\n    List&lt;Something&gt; list = new ArrayList&lt;&gt;( all.size());\r\n    for (Something s : all) {\r\n    \tlist.add( s);\r\n    }\r\n    return list;\r\n\r\n**Is there a better way** (as in non obfuscated one liner) to achieve the same result?","title":"Filling a List with all enum values in Java","body":"<p>I would like to fill a list with all possible values of an enum<br>\nSince I recently fell in love with <code>EnumSet</code>, I leveraged <code>allOf()</code><br></p>\n\n<pre><code>EnumSet&lt;Something&gt; all = EnumSet.allOf( Something.class);\nList&lt;Something&gt; list = new ArrayList&lt;&gt;( all.size());\nfor (Something s : all) {\n    list.add( s);\n}\nreturn list;\n</code></pre>\n\n<p><strong>Is there a better way</strong> (as in non obfuscated one liner) to achieve the same result?</p>\n"},{"tags":["java","spring-boot","websocket"],"answers":[{"comments":[{"owner":{"account_id":20209390,"reputation":5,"user_id":14822787,"display_name":"Abdullah Howard"},"score":0,"creation_date":1694363282,"post_id":77076734,"comment_id":135878344,"body_markdown":"I am using Spring starter-web which has a built in tomcat. Wouldn&#39;t adding another tomcat interfere with that?","body":"I am using Spring starter-web which has a built in tomcat. Wouldn&#39;t adding another tomcat interfere with that?"}],"tags":[],"owner":{"account_id":29034199,"reputation":871,"user_id":22240478,"display_name":"pwoltschk"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1694359578,"creation_date":1694359578,"answer_id":77076734,"question_id":77076235,"body_markdown":" The error message indicates that Spring is unable to upgrade the HTTP request to a WebSocket connection on your Tomcat server. \r\n\r\nThere are few things to check:\r\n\r\n- Make sure you are using a compatible version of Tomcat that supports Servlet 3.1 or later. Tomcat 8.5 meets this requirement.\r\n\r\n- Add the `tomcat-websocket` dependency to your pom.xml:\r\n\r\n```\r\n&lt;dependency&gt;\r\n  &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\r\n  &lt;artifactId&gt;tomcat-embed-websocket&lt;/artifactId&gt;\r\n  &lt;version&gt;9.0.43&lt;/version&gt; \r\n&lt;/dependency&gt;\r\n```\r\n\r\n- Configure Spring to use the TomcatRequestUpgradeStrategy:\r\n\r\n```\r\n@Configuration\r\npublic class WebSocketConfig implements WebSocketMessageBrokerConfigurer {\r\n\r\n  @Override\r\n  public void registerStompEndpoints(StompEndpointRegistry registry) {\r\n    registry.addEndpoint(&quot;/chat&quot;).setHandshakeHandler(new DefaultHandshakeHandler(\r\n      new TomcatRequestUpgradeStrategy())).withSockJS();\r\n  }\r\n\r\n}\r\n```\r\n\r\nThis explicitly configures Spring to use Tomcat&#39;s built-in WebSocket support.\r\n","title":"No suitable default RequestUpgradeStrategy found on Dailyrazor&#39;s tomcat 8.5 server","body":"<p>The error message indicates that Spring is unable to upgrade the HTTP request to a WebSocket connection on your Tomcat server.</p>\n<p>There are few things to check:</p>\n<ul>\n<li><p>Make sure you are using a compatible version of Tomcat that supports Servlet 3.1 or later. Tomcat 8.5 meets this requirement.</p>\n</li>\n<li><p>Add the <code>tomcat-websocket</code> dependency to your pom.xml:</p>\n</li>\n</ul>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\n  &lt;artifactId&gt;tomcat-embed-websocket&lt;/artifactId&gt;\n  &lt;version&gt;9.0.43&lt;/version&gt; \n&lt;/dependency&gt;\n</code></pre>\n<ul>\n<li>Configure Spring to use the TomcatRequestUpgradeStrategy:</li>\n</ul>\n<pre><code>@Configuration\npublic class WebSocketConfig implements WebSocketMessageBrokerConfigurer {\n\n  @Override\n  public void registerStompEndpoints(StompEndpointRegistry registry) {\n    registry.addEndpoint(&quot;/chat&quot;).setHandshakeHandler(new DefaultHandshakeHandler(\n      new TomcatRequestUpgradeStrategy())).withSockJS();\n  }\n\n}\n</code></pre>\n<p>This explicitly configures Spring to use Tomcat's built-in WebSocket support.</p>\n"}],"owner":{"account_id":20209390,"reputation":5,"user_id":14822787,"display_name":"Abdullah Howard"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":66,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77076734,"answer_count":1,"score":0,"last_activity_date":1694359578,"creation_date":1694351277,"question_id":77076235,"body_markdown":"I am fairly new to spring-boot and Websockets in general. I am attempting to create a program that requires websockets to manage a chat application. The program runs perfectly fine on my local machine. However, when uploading it to my tomcat server on Dailyrazor, I get the error message `No suitable default RequestUpgradeStrategy found`.\r\n\r\nWhat I have tried:\r\n1. I have checked my spring-boot version to ensure that it is compatible with my Tomcat 8.5 server\r\n2. I have checked to make sure that my websockets version is also compatible. It is also important to note that my program ran perfectly fine on Dailyrazor before I added websockets to it.\r\n\r\nHere is my build.gradle file\r\n\r\n```\r\nbuildscript {\r\n    repositories {\r\n        maven {\r\n            url &quot;https://plugins.gradle.org/m2/&quot;\r\n        }\r\n    }\r\n    dependencies {\r\n        classpath &quot;org.springframework.boot:spring-boot-gradle-plugin:2.2.2.RELEASE&quot;\r\n        classpath &quot;io.spring.gradle:dependency-management-plugin:1.0.8.RELEASE&quot;\r\n    }\r\n}\r\n\r\nplugins {\r\n    id &#39;war&#39;\r\n}\r\n\r\ngroup &#39;com.teamtreehouse&#39;\r\nversion &#39;1.0-SNAPSHOT&#39;\r\n\r\n\r\n\r\nallprojects  {\r\n    apply plugin: &#39;maven&#39;\r\n    apply plugin: &quot;io.spring.dependency-management&quot;\r\n    group = &#39;com.wnp&#39;\r\n    version = &#39;6.5.0-SNAPSHOT&#39;\r\n}\r\n\r\napply plugin: &#39;java&#39;\r\napply plugin: &quot;org.springframework.boot&quot;\r\n\r\nsourceCompatibility = 1.8\r\ntargetCompatibility = 1.8\r\n\r\nrepositories {\r\n    mavenCentral()\r\n}\r\n\r\ndependencies {\r\n// https://mvnrepository.com/artifact/org.apache.tomcat.embed/tomcat-embed-websocket\r\n\r\n//    compile &#39;org.projectreactor:reactor-spring:1.0.1.release&#39;\r\n    implementation &#39;io.spring.dependency-management:io.spring.dependency-management.gradle.plugin:1.1.0&#39;\r\n\r\n    compile &#39;org.springframework.boot:spring-boot-starter-web&#39;\r\n    compile &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;\r\n    compile &#39;org.springframework.boot:spring-boot-starter-thymeleaf&#39;\r\n    compile &#39;org.springframework.boot:spring-boot-starter-security&#39;\r\n//// https://mvnrepository.com/artifact/org.springframework/spring-web\r\n//    implementation &#39;org.springframework:spring-web:6.0.0&#39;\r\n\r\n\r\n    implementation &#39;org.springframework.boot:spring-boot-starter-mail:2.2.2.RELEASE&#39;\r\n\r\n    compile group: &#39;org.apache.maven.plugins&#39;, name: &#39;maven-surefire-plugin&#39;, version: &#39;2.22.2&#39;\r\n    implementation &#39;org.ocpsoft.prettytime:prettytime:3.2.7.Final&#39;\r\n\r\n//    compile &#39;org.springframework:spring-orm&#39;\r\n//    compile group: &#39;org.hibernate&#39;, name: &#39;hibernate-core&#39;\r\n    // https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-tomcat\r\n//    providedRuntime group: &#39;org.springframework.boot&#39;, name: &#39;spring-boot-starter-tomcat&#39;, version: &#39;2.7.5&#39;\r\n// https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-tomcat\r\n    providedRuntime &#39;org.springframework.boot:spring-boot-starter-tomcat:2.2.2.RELEASE&#39;\r\n\r\n    compile &#39;org.eclipse.mylyn.github:org.eclipse.egit.github.core:2.1.5&#39;\r\n    testCompile group: &#39;junit&#39;, name: &#39;junit&#39;, version: &#39;4.11&#39;\r\n    compile &#39;org.hashids:hashids:1.0.1&#39;\r\n\r\n// https://mvnrepository.com/artifact/mysql/mysql-connector-java\r\n    implementation &#39;mysql:mysql-connector-java:8.0.33&#39;\r\n    implementation &#39;org.springframework.boot:spring-boot-starter-websocket&#39;\r\n\r\n    testImplementation group: &#39;junit&#39;, name: &#39;junit&#39;, version: &#39;4.11&#39;\r\n    implementation group: &#39;com.amazonaws&#39;, name: &#39;aws-java-sdk-s3&#39;, version: &#39;1.12.131&#39;\r\n// https://mvnrepository.com/artifact/org.projectlombok/lombok\r\n    compileOnly &#39;org.projectlombok:lombok:1.18.28&#39;\r\n\r\n    testImplementation &#39;software.amazon.awssdk:s3:2.17.102&#39;\r\n\r\n    runtimeOnly &#39;software.amazon.awssdk:bom:2.17.102&#39;\r\n\r\n\r\n}\r\n```\r\n\r\n\r\nHere is my websockets configuration:\r\n\r\n```\r\n@Configuration\r\n@EnableWebSocketMessageBroker\r\npublic class WebSocketConfig implements WebSocketMessageBrokerConfigurer {\r\n\r\n    @Override\r\n    public void registerStompEndpoints(StompEndpointRegistry registry) {\r\n        registry.addEndpoint(&quot;/chat&quot;);\r\n        registry.addEndpoint(&quot;/chat&quot;).withSockJS();\r\n    }\r\n\r\n    @Override\r\n    public void configureMessageBroker(MessageBrokerRegistry registry) {\r\n        registry.setApplicationDestinationPrefixes(&quot;/app&quot;);\r\n        registry.enableSimpleBroker(&quot;/topic&quot;);\r\n    }\r\n\r\n\r\n}\r\n```\r\nFinally, here is my error log:\r\n\r\n```\r\nINFO next-step-co.com-startStop-2 org.apache.catalina.core.ContainerBase.[Catalina].[next-step-co.com].[/] - 2 Spring WebApplicationInitializers detected on classpath\r\nINFO mysql-cj-abandoned-connection-cleanup org.apache.catalina.loader.WebappClassLoader - Illegal access: this web application instance has been stopped already.  Could not load .  The eventual following stack trace is caused by an error thrown for debugging purposes as well as to attempt to terminate the thread which caused the illegal access, and has no functional impact.\r\nINFO next-step-co.com-startStop-2 org.apache.catalina.core.ContainerBase.[Catalina].[next-step-co.com].[/] - Initializing Spring embedded WebApplicationContext\r\nERROR next-step-co.com-startStop-2 org.apache.catalina.core.ContainerBase - ContainerBase.addChild: start: \r\norg.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[next-step-co.com].StandardContext[]]\r\n\tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)\r\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:724)\r\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:700)\r\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:714)\r\n\tat org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:919)\r\n\tat org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1704)\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n\tat java.lang.Thread.run(Thread.java:745)\r\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;stompWebSocketHandlerMapping&#39; defined in class path resource [org/springframework/web/socket/config/annotation/DelegatingWebSocketMessageBrokerConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.web.servlet.HandlerMapping]: Factory method &#39;stompWebSocketHandlerMapping&#39; threw exception; nested exception is java.lang.IllegalStateException: No suitable default RequestUpgradeStrategy found\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:656)\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:484)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1338)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1177)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:557)\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:323)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory$$Lambda$878/444480024.getObject(Unknown Source)\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:321)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:879)\r\n\tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:878)\r\n\tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:550)\r\n\tat org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:141)\r\n\tat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:747)\r\n\tat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:315)\r\n\tat org.springframework.boot.web.servlet.support.SpringBootServletInitializer.run(SpringBootServletInitializer.java:152)\r\n\tat org.springframework.boot.web.servlet.support.SpringBootServletInitializer.createRootApplicationContext(SpringBootServletInitializer.java:132)\r\n\tat org.springframework.boot.web.servlet.support.SpringBootServletInitializer.onStartup(SpringBootServletInitializer.java:92)\r\n\tat org.springframework.web.SpringServletContainerInitializer.onStartup(SpringServletContainerInitializer.java:172)\r\n\tat org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5164)\r\n\tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\r\n\t... 10 more\r\nCaused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.web.servlet.HandlerMapping]: Factory method &#39;stompWebSocketHandlerMapping&#39; threw exception; nested exception is java.lang.IllegalStateException: No suitable default RequestUpgradeStrategy found\r\n\tat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185)\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651)\r\n\t... 33 more\r\nCaused by: java.lang.IllegalStateException: No suitable default RequestUpgradeStrategy found\r\n\tat org.springframework.web.socket.server.support.AbstractHandshakeHandler.initRequestUpgradeStrategy(AbstractHandshakeHandler.java:153)\r\n\tat org.springframework.web.socket.server.support.AbstractHandshakeHandler.&lt;init&gt;(AbstractHandshakeHandler.java:119)\r\n\tat org.springframework.web.socket.server.support.DefaultHandshakeHandler.&lt;init&gt;(DefaultHandshakeHandler.java:35)\r\n\tat org.springframework.web.socket.server.support.WebSocketHttpRequestHandler.&lt;init&gt;(WebSocketHttpRequestHandler.java:74)\r\n\tat org.springframework.web.socket.config.annotation.WebMvcStompWebSocketEndpointRegistration.getMappings(WebMvcStompWebSocketEndpointRegistration.java:142)\r\n\tat org.springframework.web.socket.config.annotation.WebMvcStompEndpointRegistry.getHandlerMapping(WebMvcStompEndpointRegistry.java:155)\r\n\tat org.springframework.web.socket.config.annotation.WebSocketMessageBrokerConfigurationSupport.stompWebSocketHandlerMapping(WebSocketMessageBrokerConfigurationSupport.java:82)\r\n\tat org.springframework.web.socket.config.annotation.DelegatingWebSocketMessageBrokerConfiguration$$EnhancerBySpringCGLIB$$89bc0503.CGLIB$stompWebSocketHandlerMapping$11(&lt;generated&gt;)\r\n\tat org.springframework.web.socket.config.annotation.DelegatingWebSocketMessageBrokerConfiguration$$EnhancerBySpringCGLIB$$89bc0503$$FastClassBySpringCGLIB$$d170f115.invoke(&lt;generated&gt;)\r\n\tat org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244)\r\n\tat org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:363)\r\n\tat org.springframework.web.socket.config.annotation.DelegatingWebSocketMessageBrokerConfiguration$$EnhancerBySpringCGLIB$$89bc0503.stompWebSocketHandlerMapping(&lt;generated&gt;)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:483)\r\n\tat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154)\r\n\t... 34 more\r\nERROR next-step-co.com-startStop-2 org.apache.catalina.startup.HostConfig - Error deploying web application archive /home/nextste2/tomcat/webapps/next-step-co.com/ROOT.war\r\njava.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[next-step-co.com].StandardContext[]]\r\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:727)\r\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:700)\r\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:714)\r\n\tat org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:919)\r\n\tat org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1704)\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n\tat java.lang.Thread.run(Thread.java:745)\r\n\r\n```","title":"No suitable default RequestUpgradeStrategy found on Dailyrazor&#39;s tomcat 8.5 server","body":"<p>I am fairly new to spring-boot and Websockets in general. I am attempting to create a program that requires websockets to manage a chat application. The program runs perfectly fine on my local machine. However, when uploading it to my tomcat server on Dailyrazor, I get the error message <code>No suitable default RequestUpgradeStrategy found</code>.</p>\n<p>What I have tried:</p>\n<ol>\n<li>I have checked my spring-boot version to ensure that it is compatible with my Tomcat 8.5 server</li>\n<li>I have checked to make sure that my websockets version is also compatible. It is also important to note that my program ran perfectly fine on Dailyrazor before I added websockets to it.</li>\n</ol>\n<p>Here is my build.gradle file</p>\n<pre><code>buildscript {\n    repositories {\n        maven {\n            url &quot;https://plugins.gradle.org/m2/&quot;\n        }\n    }\n    dependencies {\n        classpath &quot;org.springframework.boot:spring-boot-gradle-plugin:2.2.2.RELEASE&quot;\n        classpath &quot;io.spring.gradle:dependency-management-plugin:1.0.8.RELEASE&quot;\n    }\n}\n\nplugins {\n    id 'war'\n}\n\ngroup 'com.teamtreehouse'\nversion '1.0-SNAPSHOT'\n\n\n\nallprojects  {\n    apply plugin: 'maven'\n    apply plugin: &quot;io.spring.dependency-management&quot;\n    group = 'com.wnp'\n    version = '6.5.0-SNAPSHOT'\n}\n\napply plugin: 'java'\napply plugin: &quot;org.springframework.boot&quot;\n\nsourceCompatibility = 1.8\ntargetCompatibility = 1.8\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n// https://mvnrepository.com/artifact/org.apache.tomcat.embed/tomcat-embed-websocket\n\n//    compile 'org.projectreactor:reactor-spring:1.0.1.release'\n    implementation 'io.spring.dependency-management:io.spring.dependency-management.gradle.plugin:1.1.0'\n\n    compile 'org.springframework.boot:spring-boot-starter-web'\n    compile 'org.springframework.boot:spring-boot-starter-data-jpa'\n    compile 'org.springframework.boot:spring-boot-starter-thymeleaf'\n    compile 'org.springframework.boot:spring-boot-starter-security'\n//// https://mvnrepository.com/artifact/org.springframework/spring-web\n//    implementation 'org.springframework:spring-web:6.0.0'\n\n\n    implementation 'org.springframework.boot:spring-boot-starter-mail:2.2.2.RELEASE'\n\n    compile group: 'org.apache.maven.plugins', name: 'maven-surefire-plugin', version: '2.22.2'\n    implementation 'org.ocpsoft.prettytime:prettytime:3.2.7.Final'\n\n//    compile 'org.springframework:spring-orm'\n//    compile group: 'org.hibernate', name: 'hibernate-core'\n    // https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-tomcat\n//    providedRuntime group: 'org.springframework.boot', name: 'spring-boot-starter-tomcat', version: '2.7.5'\n// https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-tomcat\n    providedRuntime 'org.springframework.boot:spring-boot-starter-tomcat:2.2.2.RELEASE'\n\n    compile 'org.eclipse.mylyn.github:org.eclipse.egit.github.core:2.1.5'\n    testCompile group: 'junit', name: 'junit', version: '4.11'\n    compile 'org.hashids:hashids:1.0.1'\n\n// https://mvnrepository.com/artifact/mysql/mysql-connector-java\n    implementation 'mysql:mysql-connector-java:8.0.33'\n    implementation 'org.springframework.boot:spring-boot-starter-websocket'\n\n    testImplementation group: 'junit', name: 'junit', version: '4.11'\n    implementation group: 'com.amazonaws', name: 'aws-java-sdk-s3', version: '1.12.131'\n// https://mvnrepository.com/artifact/org.projectlombok/lombok\n    compileOnly 'org.projectlombok:lombok:1.18.28'\n\n    testImplementation 'software.amazon.awssdk:s3:2.17.102'\n\n    runtimeOnly 'software.amazon.awssdk:bom:2.17.102'\n\n\n}\n</code></pre>\n<p>Here is my websockets configuration:</p>\n<pre><code>@Configuration\n@EnableWebSocketMessageBroker\npublic class WebSocketConfig implements WebSocketMessageBrokerConfigurer {\n\n    @Override\n    public void registerStompEndpoints(StompEndpointRegistry registry) {\n        registry.addEndpoint(&quot;/chat&quot;);\n        registry.addEndpoint(&quot;/chat&quot;).withSockJS();\n    }\n\n    @Override\n    public void configureMessageBroker(MessageBrokerRegistry registry) {\n        registry.setApplicationDestinationPrefixes(&quot;/app&quot;);\n        registry.enableSimpleBroker(&quot;/topic&quot;);\n    }\n\n\n}\n</code></pre>\n<p>Finally, here is my error log:</p>\n<pre><code>INFO next-step-co.com-startStop-2 org.apache.catalina.core.ContainerBase.[Catalina].[next-step-co.com].[/] - 2 Spring WebApplicationInitializers detected on classpath\nINFO mysql-cj-abandoned-connection-cleanup org.apache.catalina.loader.WebappClassLoader - Illegal access: this web application instance has been stopped already.  Could not load .  The eventual following stack trace is caused by an error thrown for debugging purposes as well as to attempt to terminate the thread which caused the illegal access, and has no functional impact.\nINFO next-step-co.com-startStop-2 org.apache.catalina.core.ContainerBase.[Catalina].[next-step-co.com].[/] - Initializing Spring embedded WebApplicationContext\nERROR next-step-co.com-startStop-2 org.apache.catalina.core.ContainerBase - ContainerBase.addChild: start: \norg.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[next-step-co.com].StandardContext[]]\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)\n    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:724)\n    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:700)\n    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:714)\n    at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:919)\n    at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1704)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'stompWebSocketHandlerMapping' defined in class path resource [org/springframework/web/socket/config/annotation/DelegatingWebSocketMessageBrokerConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.web.servlet.HandlerMapping]: Factory method 'stompWebSocketHandlerMapping' threw exception; nested exception is java.lang.IllegalStateException: No suitable default RequestUpgradeStrategy found\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:656)\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:484)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1338)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1177)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:557)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:323)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$$Lambda$878/444480024.getObject(Unknown Source)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:321)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:879)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:878)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:550)\n    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:141)\n    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:747)\n    at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)\n    at org.springframework.boot.web.servlet.support.SpringBootServletInitializer.run(SpringBootServletInitializer.java:152)\n    at org.springframework.boot.web.servlet.support.SpringBootServletInitializer.createRootApplicationContext(SpringBootServletInitializer.java:132)\n    at org.springframework.boot.web.servlet.support.SpringBootServletInitializer.onStartup(SpringBootServletInitializer.java:92)\n    at org.springframework.web.SpringServletContainerInitializer.onStartup(SpringServletContainerInitializer.java:172)\n    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5164)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n    ... 10 more\nCaused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.web.servlet.HandlerMapping]: Factory method 'stompWebSocketHandlerMapping' threw exception; nested exception is java.lang.IllegalStateException: No suitable default RequestUpgradeStrategy found\n    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185)\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651)\n    ... 33 more\nCaused by: java.lang.IllegalStateException: No suitable default RequestUpgradeStrategy found\n    at org.springframework.web.socket.server.support.AbstractHandshakeHandler.initRequestUpgradeStrategy(AbstractHandshakeHandler.java:153)\n    at org.springframework.web.socket.server.support.AbstractHandshakeHandler.&lt;init&gt;(AbstractHandshakeHandler.java:119)\n    at org.springframework.web.socket.server.support.DefaultHandshakeHandler.&lt;init&gt;(DefaultHandshakeHandler.java:35)\n    at org.springframework.web.socket.server.support.WebSocketHttpRequestHandler.&lt;init&gt;(WebSocketHttpRequestHandler.java:74)\n    at org.springframework.web.socket.config.annotation.WebMvcStompWebSocketEndpointRegistration.getMappings(WebMvcStompWebSocketEndpointRegistration.java:142)\n    at org.springframework.web.socket.config.annotation.WebMvcStompEndpointRegistry.getHandlerMapping(WebMvcStompEndpointRegistry.java:155)\n    at org.springframework.web.socket.config.annotation.WebSocketMessageBrokerConfigurationSupport.stompWebSocketHandlerMapping(WebSocketMessageBrokerConfigurationSupport.java:82)\n    at org.springframework.web.socket.config.annotation.DelegatingWebSocketMessageBrokerConfiguration$$EnhancerBySpringCGLIB$$89bc0503.CGLIB$stompWebSocketHandlerMapping$11(&lt;generated&gt;)\n    at org.springframework.web.socket.config.annotation.DelegatingWebSocketMessageBrokerConfiguration$$EnhancerBySpringCGLIB$$89bc0503$$FastClassBySpringCGLIB$$d170f115.invoke(&lt;generated&gt;)\n    at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244)\n    at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:363)\n    at org.springframework.web.socket.config.annotation.DelegatingWebSocketMessageBrokerConfiguration$$EnhancerBySpringCGLIB$$89bc0503.stompWebSocketHandlerMapping(&lt;generated&gt;)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:483)\n    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154)\n    ... 34 more\nERROR next-step-co.com-startStop-2 org.apache.catalina.startup.HostConfig - Error deploying web application archive /home/nextste2/tomcat/webapps/next-step-co.com/ROOT.war\njava.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[next-step-co.com].StandardContext[]]\n    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:727)\n    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:700)\n    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:714)\n    at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:919)\n    at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1704)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\n\n</code></pre>\n"},{"tags":["java","spring-boot","hibernate","jpa"],"comments":[{"owner":{"account_id":1658807,"reputation":31819,"user_id":1527544,"accept_rate":54,"display_name":"Antoniossss"},"score":0,"creation_date":1692113453,"post_id":76906930,"comment_id":135578862,"body_markdown":"Maybe wrong `@Modifying` annotation (check the package)?","body":"Maybe wrong <code>@Modifying</code> annotation (check the package)?"},{"owner":{"account_id":10827831,"reputation":143,"user_id":7963227,"display_name":"Sametcey"},"score":0,"creation_date":1692114286,"post_id":76906930,"comment_id":135579022,"body_markdown":"one Question: WHICH Library du you import for the @Query annotation? Are your shure that you import the right one?","body":"one Question: WHICH Library du you import for the @Query annotation? Are your shure that you import the right one?"}],"answers":[{"tags":[],"owner":{"account_id":8047538,"reputation":423,"user_id":6067302,"display_name":"TomekK"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1692113877,"creation_date":1692113877,"answer_id":76907265,"question_id":76906930,"body_markdown":"Locking with the use of `@Lock` doesn&#39;t work with non select `@Query`.\r\nIt looks like a bigger theme since we have this in the Query interface documentation:\r\n\r\n&gt; Throws: IllegalStateException - if the query is found not to be a Java\r\n&gt; Persistence query language SELECT query or a Criteria API query\r\n\r\nhttps://docs.oracle.com/javaee/6/api/javax/persistence/Query.html#setLockMode(javax.persistence.LockModeType)","title":"Spring JPA update &quot;expecting SELECT query&quot;","body":"<p>Locking with the use of <code>@Lock</code> doesn't work with non select <code>@Query</code>.\nIt looks like a bigger theme since we have this in the Query interface documentation:</p>\n<blockquote>\n<p>Throws: IllegalStateException - if the query is found not to be a Java\nPersistence query language SELECT query or a Criteria API query</p>\n</blockquote>\n<p><a href=\"https://docs.oracle.com/javaee/6/api/javax/persistence/Query.html#setLockMode(javax.persistence.LockModeType)\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javaee/6/api/javax/persistence/Query.html#setLockMode(javax.persistence.LockModeType)</a></p>\n"},{"tags":[],"owner":{"account_id":1034341,"reputation":33,"user_id":1042032,"display_name":"Hugo Scavino"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694359575,"creation_date":1694359575,"answer_id":77076733,"question_id":76906930,"body_markdown":"Make sure to import the correct @Modifying annotation. Use the one from jpa and not jdbc. \r\n\r\nimport org.springframework.data.jpa.repository.Modifying;","title":"Spring JPA update &quot;expecting SELECT query&quot;","body":"<p>Make sure to import the correct @Modifying annotation. Use the one from jpa and not jdbc.</p>\n<p>import org.springframework.data.jpa.repository.Modifying;</p>\n"}],"owner":{"account_id":4015385,"reputation":5418,"user_id":3307720,"accept_rate":51,"display_name":"nasch"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":660,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1694359575,"creation_date":1692111226,"question_id":76906930,"body_markdown":"Here&#39;s the query in my repository interface:\r\n\r\n    @Modifying\r\n    @Lock(LockModeType.PESSIMISTIC_FORCE_INCREMENT)\r\n    @Query(&quot;UPDATE TradeTransaction tt set tt.externalStatus = :status where tt.id = :id&quot;)\r\n    int updateTransactionExternalStatus(@Param(&quot;status&quot;) TradeTransaction.ExternalStatus status,\r\n                                        @Param(&quot;id&quot;) Long id);\r\n\r\nAnd here&#39;s the error:\r\n\r\n    org.hibernate.query.IllegalSelectQueryException: Expecting a SELECT Query [org.hibernate.query.sqm.tree.select.SqmSelectStatement], but found org.hibernate.query.sqm.tree.update.SqmUpdateStatement [UPDATE TradeTransaction tt set tt.externalStatus = :status where tt.id = :id]\r\n\t\r\nEverything I&#39;m reading says the @Modifying annotation should do it.\r\n\r\nEDIT: I&#39;ve determined I don&#39;t need this kind of transaction control after all. TomekK&#39;s answer may be helpful to someone so I&#39;ll leave this up.","title":"Spring JPA update &quot;expecting SELECT query&quot;","body":"<p>Here's the query in my repository interface:</p>\n<pre><code>@Modifying\n@Lock(LockModeType.PESSIMISTIC_FORCE_INCREMENT)\n@Query(&quot;UPDATE TradeTransaction tt set tt.externalStatus = :status where tt.id = :id&quot;)\nint updateTransactionExternalStatus(@Param(&quot;status&quot;) TradeTransaction.ExternalStatus status,\n                                    @Param(&quot;id&quot;) Long id);\n</code></pre>\n<p>And here's the error:</p>\n<pre><code>org.hibernate.query.IllegalSelectQueryException: Expecting a SELECT Query [org.hibernate.query.sqm.tree.select.SqmSelectStatement], but found org.hibernate.query.sqm.tree.update.SqmUpdateStatement [UPDATE TradeTransaction tt set tt.externalStatus = :status where tt.id = :id]\n</code></pre>\n<p>Everything I'm reading says the @Modifying annotation should do it.</p>\n<p>EDIT: I've determined I don't need this kind of transaction control after all. TomekK's answer may be helpful to someone so I'll leave this up.</p>\n"},{"tags":["java","uml","sequence-diagram","argouml"],"comments":[{"owner":{"account_id":55879,"reputation":10520,"user_id":167425,"accept_rate":50,"display_name":"Tom Morris"},"score":0,"creation_date":1301076427,"post_id":5410487,"comment_id":6155847,"body_markdown":"Could you describe what problem you are having or where you are stuck?  I&#39;m familiar with ArgoUML sequence diagrams, but it&#39;s unclear what problem you are having.","body":"Could you describe what problem you are having or where you are stuck?  I&#39;m familiar with ArgoUML sequence diagrams, but it&#39;s unclear what problem you are having."},{"owner":{"account_id":1225248,"reputation":19779,"user_id":1190934,"accept_rate":60,"display_name":"James Oravec"},"score":0,"creation_date":1363635827,"post_id":5410487,"comment_id":21920210,"body_markdown":"I had the same question. Didn&#39;t see any useful tutorials on YouTube in English. I ended up making my sequence diagram with: http://www.websequencediagrams.com/","body":"I had the same question. Didn&#39;t see any useful tutorials on YouTube in English. I ended up making my sequence diagram with: <a href=\"http://www.websequencediagrams.com/\" rel=\"nofollow noreferrer\">websequencediagrams.com</a>"}],"answers":[{"comments":[{"owner":{"account_id":55879,"reputation":10520,"user_id":167425,"accept_rate":50,"display_name":"Tom Morris"},"score":2,"creation_date":1301076370,"post_id":5410602,"comment_id":6155831,"body_markdown":"That doesn&#39;t answer the question that was asked.","body":"That doesn&#39;t answer the question that was asked."}],"tags":[],"owner":{"account_id":294087,"reputation":6941,"user_id":597770,"display_name":"iluxa"},"comment_count":1,"down_vote_count":2,"up_vote_count":2,"is_accepted":false,"score":0,"last_activity_date":1300908701,"creation_date":1300908701,"answer_id":5410602,"question_id":5410487,"body_markdown":"The best tool for sequence diagrams I ever found is Quick Sequence Diagram Editor - check it out: http://sdedit.sourceforge.net/index.html\r\n","title":"Sequence Diagrams ARGOUML","body":"<p>The best tool for sequence diagrams I ever found is Quick Sequence Diagram Editor - check it out: <a href=\"http://sdedit.sourceforge.net/index.html\" rel=\"nofollow\">http://sdedit.sourceforge.net/index.html</a></p>\n"},{"comments":[{"owner":{"account_id":3236725,"reputation":2084,"user_id":2730742,"accept_rate":27,"display_name":"krm"},"score":0,"creation_date":1448556489,"post_id":15485544,"comment_id":55646325,"body_markdown":"That doesn&#39;t answer the question that was asked.","body":"That doesn&#39;t answer the question that was asked."}],"tags":[],"owner":{"account_id":1225248,"reputation":19779,"user_id":1190934,"accept_rate":60,"display_name":"James Oravec"},"comment_count":1,"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1363635985,"creation_date":1363635985,"answer_id":15485544,"question_id":5410487,"body_markdown":"If you are willing to use other tools, I used http://www.websequencediagrams.com/ which gave me what I needed. \r\n\r\nI liked the fact that I don&#39;t have to download an executable, it generate the images in real time and I can save the text that generated the diagram (I can also right click and save the generated image as well).","title":"Sequence Diagrams ARGOUML","body":"<p>If you are willing to use other tools, I used <a href=\"http://www.websequencediagrams.com/\" rel=\"nofollow\">http://www.websequencediagrams.com/</a> which gave me what I needed. </p>\n\n<p>I liked the fact that I don't have to download an executable, it generate the images in real time and I can save the text that generated the diagram (I can also right click and save the generated image as well).</p>\n"},{"comments":[{"owner":{"account_id":3236725,"reputation":2084,"user_id":2730742,"accept_rate":27,"display_name":"krm"},"score":0,"creation_date":1448556450,"post_id":20803651,"comment_id":55646294,"body_markdown":"+1 for a useful answer. I don&#39;t know why this answer had been downvoted, because it&#39;s the only correct answer to the question which had been asked. Other answers propose a usage of other tools, so they actually don&#39;t answer the question. In my case the zipped binary package worked correctly, so that I could create a sequence diagram, though the setup and Java Web Start versions didn&#39;t work.","body":"+1 for a useful answer. I don&#39;t know why this answer had been downvoted, because it&#39;s the only correct answer to the question which had been asked. Other answers propose a usage of other tools, so they actually don&#39;t answer the question. In my case the zipped binary package worked correctly, so that I could create a sequence diagram, though the setup and Java Web Start versions didn&#39;t work."}],"tags":[],"owner":{"account_id":357702,"reputation":33,"user_id":698030,"display_name":"Kai"},"comment_count":1,"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1388159861,"creation_date":1388159861,"answer_id":20803651,"question_id":5410487,"body_markdown":"If you are talking about the webstart version of argouml. And if you problem is not even able to create a sequence diagram. Please try download one instead of start it via webstart. \r\n\r\nMy locally installed copy have no trouble creating sequence diagram, while the webstarted one can&#39;t.","title":"Sequence Diagrams ARGOUML","body":"<p>If you are talking about the webstart version of argouml. And if you problem is not even able to create a sequence diagram. Please try download one instead of start it via webstart. </p>\n\n<p>My locally installed copy have no trouble creating sequence diagram, while the webstarted one can't.</p>\n"},{"tags":[],"owner":{"account_id":3236725,"reputation":2084,"user_id":2730742,"accept_rate":27,"display_name":"krm"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1448556678,"creation_date":1448556678,"answer_id":33943675,"question_id":5410487,"body_markdown":"In my case the zipped binary package worked correctly, so that I could create a sequence diagram, though the setup and Java Web Start versions didn&#39;t work. \r\n\r\nHere&#39;s the link to a [binary package of the latest stable version][1]. \r\nHere&#39;s a link to the [page with all available downloads for the last stable version][2]\r\n\r\n  [1]: http://argouml-downloads.tigris.org/nonav/argouml-0.34/ArgoUML-0.34.zip\r\n  [2]: http://argouml-downloads.tigris.org/argouml-0.34/","title":"Sequence Diagrams ARGOUML","body":"<p>In my case the zipped binary package worked correctly, so that I could create a sequence diagram, though the setup and Java Web Start versions didn't work. </p>\n\n<p>Here's the link to a <a href=\"http://argouml-downloads.tigris.org/nonav/argouml-0.34/ArgoUML-0.34.zip\" rel=\"nofollow\">binary package of the latest stable version</a>. \nHere's a link to the <a href=\"http://argouml-downloads.tigris.org/argouml-0.34/\" rel=\"nofollow\">page with all available downloads for the last stable version</a></p>\n"}],"owner":{"account_id":338853,"reputation":81,"user_id":667958,"accept_rate":25,"display_name":"Wanda"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":8211,"favorite_count":0,"down_vote_count":1,"up_vote_count":6,"answer_count":4,"score":5,"last_activity_date":1694358405,"creation_date":1300908138,"question_id":5410487,"body_markdown":"Im having trouble using argoUML to draw  my squence diagrams. Does anyone know how I can generate a sequence diagram in argouml?\r\n","title":"Sequence Diagrams ARGOUML","body":"<p>Im having trouble using argoUML to draw  my squence diagrams. Does anyone know how I can generate a sequence diagram in argouml?</p>\n"},{"tags":["java","android","metadata","android-mediaplayer","exoplayer"],"answers":[{"tags":[],"owner":{"account_id":4925749,"reputation":33,"user_id":3967027,"display_name":"Dawinder Gill"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694358192,"creation_date":1694358192,"answer_id":77076655,"question_id":77028032,"body_markdown":"It looks like you did not add &#39;title&#39; anywhere which is why you are getting a &#39;NULL&#39; value as an output. You can use the code below to add and get the title or any other information from MediaMetadata.\r\n\r\n    //Add required info into mediaMetadata\r\n    val mediaMetadata = MediaMetadata.Builder()\r\n            .setDisplayTitle(&quot;Your title here&quot;)\r\n            .setArtist(&quot;Your artist name&quot;)\r\n            .build()\r\n    \r\n    //Build mediaItem with data added and url of media\r\n    val mediaItem = MediaItem.Builder()\r\n            .setMediaMetadata(mediaMetadata)\r\n            .setUri(&quot;Your track URL here&quot;)\r\n\r\n    mediaItem.build()\r\n\r\n    //Now add this mediaItem into your code like this\r\n    player.setMediaItem(mediaItem);\r\n    player.prepare();\r\n    player.play();\r\n\r\n    //Now in listener\r\n    player.addListener(new Player.Listener() {\r\n\r\n                    @Override\r\n                    public void onMediaMetadataChanged(MediaMetadata mediaMetadata) {\r\n                        //Now get posted values like this\r\n                        println(&quot;Title : &quot;+mediaMetadata.displayTitle)    \r\n                    }\r\n                }\r\n        );\r\n\r\nYou can find more useful methods in MediaMetadata Builder like setAlbumTitle, setAlbumArtist, setSubtitle, setDescription, setUserRating, etc.\r\n\r\nOne more thing I think your code is in Java but my code at the beginning is in Kotlin so convert it into Java before use.","title":"Media3 ExoPlayer getMediaMetadata() do not get correct data","body":"<p>It looks like you did not add 'title' anywhere which is why you are getting a 'NULL' value as an output. You can use the code below to add and get the title or any other information from MediaMetadata.</p>\n<pre><code>//Add required info into mediaMetadata\nval mediaMetadata = MediaMetadata.Builder()\n        .setDisplayTitle(&quot;Your title here&quot;)\n        .setArtist(&quot;Your artist name&quot;)\n        .build()\n\n//Build mediaItem with data added and url of media\nval mediaItem = MediaItem.Builder()\n        .setMediaMetadata(mediaMetadata)\n        .setUri(&quot;Your track URL here&quot;)\n\nmediaItem.build()\n\n//Now add this mediaItem into your code like this\nplayer.setMediaItem(mediaItem);\nplayer.prepare();\nplayer.play();\n\n//Now in listener\nplayer.addListener(new Player.Listener() {\n\n                @Override\n                public void onMediaMetadataChanged(MediaMetadata mediaMetadata) {\n                    //Now get posted values like this\n                    println(&quot;Title : &quot;+mediaMetadata.displayTitle)    \n                }\n            }\n    );\n</code></pre>\n<p>You can find more useful methods in MediaMetadata Builder like setAlbumTitle, setAlbumArtist, setSubtitle, setDescription, setUserRating, etc.</p>\n<p>One more thing I think your code is in Java but my code at the beginning is in Kotlin so convert it into Java before use.</p>\n"}],"owner":{"account_id":29350396,"reputation":1,"user_id":22487672,"display_name":"Z Ivanov"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":199,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694358192,"creation_date":1693653013,"question_id":77028032,"body_markdown":"I&#39;m trying to create a very simple app - a online radio player, and I want to get the name of the song currently playing. Here is the code:\r\n\r\n\r\n```\r\nplayer = new ExoPlayer.Builder(this).build();\r\n        viewPlayer.setPlayer(player);\r\n        MediaItem mediaItem = MediaItem.fromUri(link);\r\n        player.setMediaItem(mediaItem);\r\n        player.prepare();\r\n        player.play();\r\n\r\n\r\n        player.addListener(\r\n                new Player.Listener() {\r\n\r\n                    @Override\r\n                    public void onMediaMetadataChanged(MediaMetadata mediaMetadata) {\r\n                        metadata = player.getMediaMetadata();\r\n\r\n                        if (metadata.title!=null) {\r\n                            MainActivity.this.title = metadata.albumTitle.toString();\r\n                            viewSong.setText(MainActivity.this.title);\r\n                        } else viewSong.setText(&quot;NULL&quot;);\r\n                    }\r\n                }\r\n        );\r\n```\r\nI think, I have all dependencies needed in build.gradle.\r\n\r\n\r\nPlayer works fine but `getMediaMetadata()` gives me this (in debug mode):\r\n\r\n\r\n```\r\nmetadata = {MediaMetadata@11693}\r\n\talbumArtist = null\r\n\talbumTitle = null\r\n\tartist = null\r\n\t..............\r\n\t..............\r\n\tgenre = Rock Music\r\n\t..............\r\n\t..............\r\n\tstation = RADIO 1 ROCK\r\n```\r\n\r\n\r\nThere is some data, but what I need is &#39;null&#39;.\r\n\r\nI know that metadata contains the title and artist info. \r\n[VLC player gives me this:](https://i.stack.imgur.com/fMqiA.png)\r\n\r\nI did not find any relevant answer of this problem yet.","title":"Media3 ExoPlayer getMediaMetadata() do not get correct data","body":"<p>I'm trying to create a very simple app - a online radio player, and I want to get the name of the song currently playing. Here is the code:</p>\n<pre><code>player = new ExoPlayer.Builder(this).build();\n        viewPlayer.setPlayer(player);\n        MediaItem mediaItem = MediaItem.fromUri(link);\n        player.setMediaItem(mediaItem);\n        player.prepare();\n        player.play();\n\n\n        player.addListener(\n                new Player.Listener() {\n\n                    @Override\n                    public void onMediaMetadataChanged(MediaMetadata mediaMetadata) {\n                        metadata = player.getMediaMetadata();\n\n                        if (metadata.title!=null) {\n                            MainActivity.this.title = metadata.albumTitle.toString();\n                            viewSong.setText(MainActivity.this.title);\n                        } else viewSong.setText(&quot;NULL&quot;);\n                    }\n                }\n        );\n</code></pre>\n<p>I think, I have all dependencies needed in build.gradle.</p>\n<p>Player works fine but <code>getMediaMetadata()</code> gives me this (in debug mode):</p>\n<pre><code>metadata = {MediaMetadata@11693}\n    albumArtist = null\n    albumTitle = null\n    artist = null\n    ..............\n    ..............\n    genre = Rock Music\n    ..............\n    ..............\n    station = RADIO 1 ROCK\n</code></pre>\n<p>There is some data, but what I need is 'null'.</p>\n<p>I know that metadata contains the title and artist info.\n<a href=\"https://i.stack.imgur.com/fMqiA.png\" rel=\"nofollow noreferrer\">VLC player gives me this:</a></p>\n<p>I did not find any relevant answer of this problem yet.</p>\n"},{"tags":["java","pdf","hash","pdfbox","electronic-signature"],"comments":[{"owner":{"account_id":1916831,"reputation":91511,"user_id":1729265,"display_name":"mkl"},"score":1,"creation_date":1692885128,"post_id":76969040,"comment_id":135687053,"body_markdown":"*&quot;I know that we would get the best help if we shared the PDF before and after signing&quot;* - indeed, please share.","body":"<i>&quot;I know that we would get the best help if we shared the PDF before and after signing&quot;</i> - indeed, please share."},{"owner":{"account_id":17774775,"reputation":1,"user_id":12907401,"display_name":"jan_s"},"score":0,"creation_date":1692897891,"post_id":76969040,"comment_id":135690128,"body_markdown":"@KJ yes I tried that version as well, here&#39;s the code:\nhttps://gist.github.com/jan-sz/7c2fdf1e48e302bca01711440d364316\nValidation in Adobe Acrobat Reader shows &quot;Certification is invalid&quot; &quot;Document has been altered or corrupted since it was signed&quot;. When I checked the size of `ByteArrayOutputStream` I return in `ContentSigner.getOutputStream` it&#39;s  `baos.toByteArray().length` is 0.","body":"@KJ yes I tried that version as well, here&#39;s the code: <a href=\"https://gist.github.com/jan-sz/7c2fdf1e48e302bca01711440d364316\" rel=\"nofollow noreferrer\">gist.github.com/jan-sz/7c2fdf1e48e302bca01711440d364316</a> Validation in Adobe Acrobat Reader shows &quot;Certification is invalid&quot; &quot;Document has been altered or corrupted since it was signed&quot;. When I checked the size of <code>ByteArrayOutputStream</code> I return in <code>ContentSigner.getOutputStream</code> it&#39;s  <code>baos.toByteArray().length</code> is 0."},{"owner":{"account_id":17774775,"reputation":1,"user_id":12907401,"display_name":"jan_s"},"score":0,"creation_date":1692952618,"post_id":76969040,"comment_id":135697536,"body_markdown":"@mkl I edited my question - I added a class that imitiates the external signature and added the examples of PDFs and keys used for signature –","body":"@mkl I edited my question - I added a class that imitiates the external signature and added the examples of PDFs and keys used for signature –"}],"answers":[{"comments":[{"owner":{"account_id":17774775,"reputation":1,"user_id":12907401,"display_name":"jan_s"},"score":0,"creation_date":1693241685,"post_id":76978464,"comment_id":135731601,"body_markdown":"thank you for that answer, indeed we missed `sigb.setDirectSignature(true);` - after adding this the Adobe Acrobat doesn&#39;t say that Document was altered anymore (there are some other problems most probably caused by what you explained about hashes).","body":"thank you for that answer, indeed we missed <code>sigb.setDirectSignature(true);</code> - after adding this the Adobe Acrobat doesn&#39;t say that Document was altered anymore (there are some other problems most probably caused by what you explained about hashes)."},{"owner":{"account_id":17774775,"reputation":1,"user_id":12907401,"display_name":"jan_s"},"score":0,"creation_date":1693242162,"post_id":76978464,"comment_id":135731703,"body_markdown":"Up until now I wasn&#39;t aware that there are different ways to sign the PDF, thank you for that, I found the explanation that helps me understand it a bit better here: https://eideasy.com/how-hash-digest-signing-works-for-pdf-pades/ - we were trying to create a simple signature container because we didn&#39;t know any better. Our desire is to calculate the hash that takes into consideration the public key from the certificate.","body":"Up until now I wasn&#39;t aware that there are different ways to sign the PDF, thank you for that, I found the explanation that helps me understand it a bit better here: <a href=\"https://eideasy.com/how-hash-digest-signing-works-for-pdf-pades/\" rel=\"nofollow noreferrer\">eideasy.com/how-hash-digest-signing-works-for-pdf-pades</a> - we were trying to create a simple signature container because we didn&#39;t know any better. Our desire is to calculate the hash that takes into consideration the public key from the certificate."},{"owner":{"account_id":17774775,"reputation":1,"user_id":12907401,"display_name":"jan_s"},"score":0,"creation_date":1693242509,"post_id":76978464,"comment_id":135731752,"body_markdown":"I actually thought that by using `document.addSignature(signature); ExternalSigningSupport externalSigning = document.saveIncrementalForExternalSigning(output); sign(externalSigning.getContent());` we would be able to add the signer&#39;s public key and calculate the hash based on that but it just shows my lack of understanding of these libraries and I couldn&#39;t find any tutorials for PDFBox and signature - could you please help me fix it ? From other posts here I understood that this hack with `ContentSigner nonSigner_signedHashProvided` is required if some API signs the hash and returns it for us","body":"I actually thought that by using <code>document.addSignature(signature); ExternalSigningSupport externalSigning = document.saveIncrementalForExternalSigning(output); sign(externalSigning.getContent());</code> we would be able to add the signer&#39;s public key and calculate the hash based on that but it just shows my lack of understanding of these libraries and I couldn&#39;t find any tutorials for PDFBox and signature - could you please help me fix it ? From other posts here I understood that this hack with <code>ContentSigner nonSigner_signedHashProvided</code> is required if some API signs the hash and returns it for us"}],"tags":[],"owner":{"account_id":1916831,"reputation":91511,"user_id":1729265,"display_name":"mkl"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1692976460,"creation_date":1692976460,"answer_id":76978464,"question_id":76969040,"body_markdown":"Analyzing your example file one sees that none of the hashes in the signature is correct. Furthermore, one sees that the CMS signature container is not of the simple form required for your hack to work.\r\n\r\n### Creating a simple signature container (no signed attributes)\r\n\r\nYou desire to create a simple signature container (no signed attributes, the signature bytes directly sign the data) for your `ContentSigner` hack to work.\r\n\r\nYour example file contains a signature container with signed attributes, though. Thus, both the hash in the signed attributes and in the signature bytes are wrong, the former because you use `&quot;not used&quot;.getBytes()` as generator input and the latter because it is not based on the signed attributes.\r\n\r\nThe cause is that you incompletely copied the code from the [answer][1] you used as template: you dropped the call of the `JcaSignerInfoGeneratorBuilder` method `setDirectSignature` there:\r\n```lang-java\r\n    JcaSignerInfoGeneratorBuilder sigb = new JcaSignerInfoGeneratorBuilder(new JcaDigestCalculatorProviderBuilder().build());\r\n    sigb.setDirectSignature(true);\r\n```\r\nBut the `JcaSignerInfoGeneratorBuilder` only creates simple signature container structures if `DirectSignature` is set to `true`.\r\n\r\nThus, please complete your copy of that code.\r\n\r\n### Signing the correct hash\r\n\r\nEven after switching to creation of simple signature containers you&#39;ll sign the wrong hash because your flow with the `ExternalSignature` test replacement after hashing the data using `MessageDigest.getInstance(&quot;SHA256&quot;, new BouncyCastleProvider())` at the beginning of `CreateSignature.sign` hashes that hash again by using `Signature.getInstance(&quot;SHA256withRSA&quot;)` in `ExternalSignature.sign`.\r\n\r\nTo make that flow work, you&#39;ll have to remove one of the hash calculations.\r\n\r\nI don&#39;t know, though, whether your `ExternalSignature` test replacement really correctly represents your `ServerSignature` functionality. If the latter does not hash itself but truly expects pre-hashed data, your flow with it may work without further ado after switching to creation of simple signature containers.\r\n\r\n### As an aside\r\n\r\nWhy do you insist on creating simple signature containers? Every signature profile that is somehow to be taken seriously requires the use of signed attributes.\r\n\r\n\r\n  [1]: https://stackoverflow.com/a/69910676/1729265","title":"Java Apache PDFBox - issue with generating the hash for external signing or with merging it back - adding Public key certificate chain to PDF","body":"<p>Analyzing your example file one sees that none of the hashes in the signature is correct. Furthermore, one sees that the CMS signature container is not of the simple form required for your hack to work.</p>\n<h3>Creating a simple signature container (no signed attributes)</h3>\n<p>You desire to create a simple signature container (no signed attributes, the signature bytes directly sign the data) for your <code>ContentSigner</code> hack to work.</p>\n<p>Your example file contains a signature container with signed attributes, though. Thus, both the hash in the signed attributes and in the signature bytes are wrong, the former because you use <code>&quot;not used&quot;.getBytes()</code> as generator input and the latter because it is not based on the signed attributes.</p>\n<p>The cause is that you incompletely copied the code from the <a href=\"https://stackoverflow.com/a/69910676/1729265\">answer</a> you used as template: you dropped the call of the <code>JcaSignerInfoGeneratorBuilder</code> method <code>setDirectSignature</code> there:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    JcaSignerInfoGeneratorBuilder sigb = new JcaSignerInfoGeneratorBuilder(new JcaDigestCalculatorProviderBuilder().build());\n    sigb.setDirectSignature(true);\n</code></pre>\n<p>But the <code>JcaSignerInfoGeneratorBuilder</code> only creates simple signature container structures if <code>DirectSignature</code> is set to <code>true</code>.</p>\n<p>Thus, please complete your copy of that code.</p>\n<h3>Signing the correct hash</h3>\n<p>Even after switching to creation of simple signature containers you'll sign the wrong hash because your flow with the <code>ExternalSignature</code> test replacement after hashing the data using <code>MessageDigest.getInstance(&quot;SHA256&quot;, new BouncyCastleProvider())</code> at the beginning of <code>CreateSignature.sign</code> hashes that hash again by using <code>Signature.getInstance(&quot;SHA256withRSA&quot;)</code> in <code>ExternalSignature.sign</code>.</p>\n<p>To make that flow work, you'll have to remove one of the hash calculations.</p>\n<p>I don't know, though, whether your <code>ExternalSignature</code> test replacement really correctly represents your <code>ServerSignature</code> functionality. If the latter does not hash itself but truly expects pre-hashed data, your flow with it may work without further ado after switching to creation of simple signature containers.</p>\n<h3>As an aside</h3>\n<p>Why do you insist on creating simple signature containers? Every signature profile that is somehow to be taken seriously requires the use of signed attributes.</p>\n"},{"tags":[],"owner":{"account_id":17774775,"reputation":1,"user_id":12907401,"display_name":"jan_s"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1694357983,"creation_date":1693990368,"answer_id":77050400,"question_id":76969040,"body_markdown":"I found the solution to my problem in other Stackoverflow post:\r\nhttps://stackoverflow.com/questions/75505900/pdfbox-document-getting-corrupted-after-adding-signed-attributes \r\n\r\nBased on the answer from mkl, we were able to create a working solution with PDFBox version 3.0.0:\r\n```java\r\npackage TOTPSignPDF.Service;\r\n\r\nimport TOTPSignPDF.ServerSignature;\r\nimport org.apache.pdfbox.Loader;\r\nimport org.apache.pdfbox.pdmodel.PDDocument;\r\nimport org.apache.pdfbox.pdmodel.interactive.digitalsignature.ExternalSigningSupport;\r\nimport org.apache.pdfbox.pdmodel.interactive.digitalsignature.PDSignature;\r\nimport org.apache.pdfbox.pdmodel.interactive.digitalsignature.SignatureOptions;\r\nimport org.bouncycastle.asn1.ASN1EncodableVector;\r\nimport org.bouncycastle.asn1.ASN1ObjectIdentifier;\r\nimport org.bouncycastle.asn1.ASN1Primitive;\r\nimport org.bouncycastle.asn1.DERSet;\r\nimport org.bouncycastle.asn1.cms.Attribute;\r\nimport org.bouncycastle.asn1.cms.AttributeTable;\r\nimport org.bouncycastle.asn1.ess.ESSCertIDv2;\r\nimport org.bouncycastle.asn1.ess.SigningCertificateV2;\r\nimport org.bouncycastle.asn1.nist.NISTObjectIdentifiers;\r\nimport org.bouncycastle.asn1.pkcs.PKCSObjectIdentifiers;\r\nimport org.bouncycastle.asn1.x509.AlgorithmIdentifier;\r\nimport org.bouncycastle.cert.X509CertificateHolder;\r\nimport org.bouncycastle.cert.jcajce.JcaCertStore;\r\nimport org.bouncycastle.cms.CMSAttributeTableGenerator;\r\nimport org.bouncycastle.cms.CMSException;\r\nimport org.bouncycastle.cms.CMSSignedData;\r\nimport org.bouncycastle.cms.CMSSignedDataGenerator;\r\nimport org.bouncycastle.cms.CMSTypedData;\r\nimport org.bouncycastle.cms.DefaultSignedAttributeTableGenerator;\r\nimport org.bouncycastle.cms.jcajce.JcaSignerInfoGeneratorBuilder;\r\nimport org.bouncycastle.jcajce.io.OutputStreamFactory;\r\nimport org.bouncycastle.operator.ContentSigner;\r\nimport org.bouncycastle.operator.OperatorCreationException;\r\nimport org.bouncycastle.operator.jcajce.JcaDigestCalculatorProviderBuilder;\r\nimport org.slf4j.Logger;\r\nimport org.slf4j.LoggerFactory;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.stereotype.Service;\r\n\r\nimport java.io.File;\r\nimport java.io.FileOutputStream;\r\nimport java.io.IOException;\r\nimport java.io.OutputStream;\r\nimport java.security.MessageDigest;\r\nimport java.security.NoSuchAlgorithmException;\r\nimport java.security.cert.Certificate;\r\nimport java.security.cert.CertificateEncodingException;\r\nimport java.security.cert.X509Certificate;\r\nimport java.util.Arrays;\r\nimport java.util.Base64;\r\nimport java.util.Calendar;\r\n\r\n/*\r\n    This solution was based on official examples from Apache:\r\n    https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/CreateSignature.java?revision=1899086&amp;view=markup\r\n    https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/CreateSignatureBase.java?view=markup\r\n */\r\n\r\n@Service\r\npublic class CreateSignature {\r\n\r\n    private static final Logger LOG = LoggerFactory.getLogger(CreateSignature.class);\r\n\r\n    @Autowired\r\n    ServerSignature serverSignature;\r\n\r\n    private Certificate[] certificateChain;\r\n\r\n    /**\r\n     * Signs the given PDF file.\r\n     *\r\n     * @param inFile the original PDF file\r\n     */\r\n    public void signDocument(File inFile, Certificate[] certChain) throws\r\n                                                                   IOException,\r\n                                                                   CertificateEncodingException,\r\n                                                                   NoSuchAlgorithmException,\r\n                                                                   OperatorCreationException,\r\n                                                                   CMSException {\r\n\r\n        // we&#39;re being given the certificate chain with public key\r\n        setCertificateChain(certChain);\r\n\r\n        String name = inFile.getName();\r\n        String substring = name.substring(0, name.lastIndexOf(&#39;.&#39;));\r\n\r\n        File outFile = new File(inFile.getParent(), substring + &quot;_signed_pdfbox.pdf&quot;);\r\n        signDocument(inFile, outFile);\r\n    }\r\n\r\n    private void setCertificateChain(final Certificate[] certificateChain) {\r\n        this.certificateChain = certificateChain;\r\n    }\r\n\r\n    // https://stackoverflow.com/questions/75505900/pdfbox-document-getting-corrupted-after-adding-signed-attributes\r\n    private void signDocument(File inFile, File outFile) throws\r\n                                                         IOException,\r\n                                                         NoSuchAlgorithmException,\r\n                                                         OperatorCreationException,\r\n                                                         CertificateEncodingException,\r\n                                                         CMSException {\r\n        try (\r\n            FileOutputStream output = new FileOutputStream(outFile);\r\n            PDDocument document = Loader.loadPDF(inFile)\r\n        ) {\r\n            PDSignature signature = new PDSignature();\r\n\r\n            signature.setFilter(PDSignature.FILTER_ADOBE_PPKLITE);\r\n            signature.setSubFilter(PDSignature.SUBFILTER_ETSI_CADES_DETACHED);\r\n            signature.setName(&quot;Test Name&quot;);\r\n            signature.setSignDate(Calendar.getInstance());\r\n\r\n            SignatureOptions signatureOptions = new SignatureOptions();\r\n            signatureOptions.setPage(0);\r\n\r\n            document.addSignature(signature, signatureOptions);\r\n            ExternalSigningSupport externalSigning = document.saveIncrementalForExternalSigning(output);\r\n\r\n            // retrieve signer certificate and its chain\r\n            X509Certificate cert = (X509Certificate) certificateChain[0];\r\n\r\n            // build signed attribute table generator and SignerInfo generator builder\r\n            ESSCertIDv2 certid = new ESSCertIDv2(\r\n                new AlgorithmIdentifier(NISTObjectIdentifiers.id_sha256),\r\n                MessageDigest.getInstance(&quot;SHA-256&quot;).digest(cert.getEncoded())\r\n            );\r\n            SigningCertificateV2 sigcert = new SigningCertificateV2(certid);\r\n            Attribute attr = new Attribute(PKCSObjectIdentifiers.id_aa_signingCertificateV2, new DERSet(sigcert));\r\n\r\n            ASN1EncodableVector v = new ASN1EncodableVector();\r\n            v.add(attr);\r\n            AttributeTable atttributeTable = new AttributeTable(v);\r\n            CMSAttributeTableGenerator attrGen = new DefaultSignedAttributeTableGenerator(atttributeTable);\r\n\r\n            org.bouncycastle.asn1.x509.Certificate cert2 = org.bouncycastle.asn1.x509.Certificate.getInstance(ASN1Primitive.fromByteArray(cert.getEncoded()));\r\n            JcaSignerInfoGeneratorBuilder sigb = new JcaSignerInfoGeneratorBuilder(new JcaDigestCalculatorProviderBuilder().build());\r\n            sigb.setSignedAttributeGenerator(attrGen);\r\n\r\n            // create ContentSigner that signs by calling the external endpoint\r\n            ContentSigner contentSigner = new ContentSigner() {\r\n                private MessageDigest digest = MessageDigest.getInstance(&quot;SHA-256&quot;);\r\n                private OutputStream stream = OutputStreamFactory.createStream(digest);\r\n\r\n                @Override\r\n                public byte[] getSignature() {\r\n                    try {\r\n                        byte[] hash = digest.digest();\r\n                        byte[] signedHash = serverSignature.sign(Base64.getEncoder().encodeToString(hash));\r\n                        return signedHash;\r\n                    } catch (Exception e) {\r\n                        throw new RuntimeException(&quot;Exception while signing&quot;, e);\r\n                    }\r\n                }\r\n\r\n                @Override\r\n                public OutputStream getOutputStream() {\r\n                    return stream;\r\n                }\r\n\r\n                @Override\r\n                public AlgorithmIdentifier getAlgorithmIdentifier() {\r\n                    return new AlgorithmIdentifier(new ASN1ObjectIdentifier(&quot;1.2.840.113549.1.1.11&quot;));\r\n                }\r\n            };\r\n\r\n            // create the SignedData generator and execute\r\n            CMSSignedDataGenerator gen = new CMSSignedDataGenerator();\r\n            gen.addCertificates(new JcaCertStore(Arrays.asList(certificateChain)));\r\n            gen.addSignerInfoGenerator(sigb.build(contentSigner, new X509CertificateHolder(cert2)));\r\n\r\n            CMSTypedData msg = new CMSProcessableInputStream(externalSigning.getContent());\r\n            CMSSignedData signedData = gen.generate(msg, false);\r\n\r\n            byte[] cmsSignature = signedData.getEncoded();\r\n            externalSigning.setSignature(cmsSignature);\r\n        }\r\n    }\r\n}\r\n```","title":"Java Apache PDFBox - issue with generating the hash for external signing or with merging it back - adding Public key certificate chain to PDF","body":"<p>I found the solution to my problem in other Stackoverflow post:\n<a href=\"https://stackoverflow.com/questions/75505900/pdfbox-document-getting-corrupted-after-adding-signed-attributes\">pdfbox - document getting corrupted after adding signed attributes</a></p>\n<p>Based on the answer from mkl, we were able to create a working solution with PDFBox version 3.0.0:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package TOTPSignPDF.Service;\n\nimport TOTPSignPDF.ServerSignature;\nimport org.apache.pdfbox.Loader;\nimport org.apache.pdfbox.pdmodel.PDDocument;\nimport org.apache.pdfbox.pdmodel.interactive.digitalsignature.ExternalSigningSupport;\nimport org.apache.pdfbox.pdmodel.interactive.digitalsignature.PDSignature;\nimport org.apache.pdfbox.pdmodel.interactive.digitalsignature.SignatureOptions;\nimport org.bouncycastle.asn1.ASN1EncodableVector;\nimport org.bouncycastle.asn1.ASN1ObjectIdentifier;\nimport org.bouncycastle.asn1.ASN1Primitive;\nimport org.bouncycastle.asn1.DERSet;\nimport org.bouncycastle.asn1.cms.Attribute;\nimport org.bouncycastle.asn1.cms.AttributeTable;\nimport org.bouncycastle.asn1.ess.ESSCertIDv2;\nimport org.bouncycastle.asn1.ess.SigningCertificateV2;\nimport org.bouncycastle.asn1.nist.NISTObjectIdentifiers;\nimport org.bouncycastle.asn1.pkcs.PKCSObjectIdentifiers;\nimport org.bouncycastle.asn1.x509.AlgorithmIdentifier;\nimport org.bouncycastle.cert.X509CertificateHolder;\nimport org.bouncycastle.cert.jcajce.JcaCertStore;\nimport org.bouncycastle.cms.CMSAttributeTableGenerator;\nimport org.bouncycastle.cms.CMSException;\nimport org.bouncycastle.cms.CMSSignedData;\nimport org.bouncycastle.cms.CMSSignedDataGenerator;\nimport org.bouncycastle.cms.CMSTypedData;\nimport org.bouncycastle.cms.DefaultSignedAttributeTableGenerator;\nimport org.bouncycastle.cms.jcajce.JcaSignerInfoGeneratorBuilder;\nimport org.bouncycastle.jcajce.io.OutputStreamFactory;\nimport org.bouncycastle.operator.ContentSigner;\nimport org.bouncycastle.operator.OperatorCreationException;\nimport org.bouncycastle.operator.jcajce.JcaDigestCalculatorProviderBuilder;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\n\nimport java.io.File;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.OutputStream;\nimport java.security.MessageDigest;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.cert.Certificate;\nimport java.security.cert.CertificateEncodingException;\nimport java.security.cert.X509Certificate;\nimport java.util.Arrays;\nimport java.util.Base64;\nimport java.util.Calendar;\n\n/*\n    This solution was based on official examples from Apache:\n    https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/CreateSignature.java?revision=1899086&amp;view=markup\n    https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/CreateSignatureBase.java?view=markup\n */\n\n@Service\npublic class CreateSignature {\n\n    private static final Logger LOG = LoggerFactory.getLogger(CreateSignature.class);\n\n    @Autowired\n    ServerSignature serverSignature;\n\n    private Certificate[] certificateChain;\n\n    /**\n     * Signs the given PDF file.\n     *\n     * @param inFile the original PDF file\n     */\n    public void signDocument(File inFile, Certificate[] certChain) throws\n                                                                   IOException,\n                                                                   CertificateEncodingException,\n                                                                   NoSuchAlgorithmException,\n                                                                   OperatorCreationException,\n                                                                   CMSException {\n\n        // we're being given the certificate chain with public key\n        setCertificateChain(certChain);\n\n        String name = inFile.getName();\n        String substring = name.substring(0, name.lastIndexOf('.'));\n\n        File outFile = new File(inFile.getParent(), substring + &quot;_signed_pdfbox.pdf&quot;);\n        signDocument(inFile, outFile);\n    }\n\n    private void setCertificateChain(final Certificate[] certificateChain) {\n        this.certificateChain = certificateChain;\n    }\n\n    // https://stackoverflow.com/questions/75505900/pdfbox-document-getting-corrupted-after-adding-signed-attributes\n    private void signDocument(File inFile, File outFile) throws\n                                                         IOException,\n                                                         NoSuchAlgorithmException,\n                                                         OperatorCreationException,\n                                                         CertificateEncodingException,\n                                                         CMSException {\n        try (\n            FileOutputStream output = new FileOutputStream(outFile);\n            PDDocument document = Loader.loadPDF(inFile)\n        ) {\n            PDSignature signature = new PDSignature();\n\n            signature.setFilter(PDSignature.FILTER_ADOBE_PPKLITE);\n            signature.setSubFilter(PDSignature.SUBFILTER_ETSI_CADES_DETACHED);\n            signature.setName(&quot;Test Name&quot;);\n            signature.setSignDate(Calendar.getInstance());\n\n            SignatureOptions signatureOptions = new SignatureOptions();\n            signatureOptions.setPage(0);\n\n            document.addSignature(signature, signatureOptions);\n            ExternalSigningSupport externalSigning = document.saveIncrementalForExternalSigning(output);\n\n            // retrieve signer certificate and its chain\n            X509Certificate cert = (X509Certificate) certificateChain[0];\n\n            // build signed attribute table generator and SignerInfo generator builder\n            ESSCertIDv2 certid = new ESSCertIDv2(\n                new AlgorithmIdentifier(NISTObjectIdentifiers.id_sha256),\n                MessageDigest.getInstance(&quot;SHA-256&quot;).digest(cert.getEncoded())\n            );\n            SigningCertificateV2 sigcert = new SigningCertificateV2(certid);\n            Attribute attr = new Attribute(PKCSObjectIdentifiers.id_aa_signingCertificateV2, new DERSet(sigcert));\n\n            ASN1EncodableVector v = new ASN1EncodableVector();\n            v.add(attr);\n            AttributeTable atttributeTable = new AttributeTable(v);\n            CMSAttributeTableGenerator attrGen = new DefaultSignedAttributeTableGenerator(atttributeTable);\n\n            org.bouncycastle.asn1.x509.Certificate cert2 = org.bouncycastle.asn1.x509.Certificate.getInstance(ASN1Primitive.fromByteArray(cert.getEncoded()));\n            JcaSignerInfoGeneratorBuilder sigb = new JcaSignerInfoGeneratorBuilder(new JcaDigestCalculatorProviderBuilder().build());\n            sigb.setSignedAttributeGenerator(attrGen);\n\n            // create ContentSigner that signs by calling the external endpoint\n            ContentSigner contentSigner = new ContentSigner() {\n                private MessageDigest digest = MessageDigest.getInstance(&quot;SHA-256&quot;);\n                private OutputStream stream = OutputStreamFactory.createStream(digest);\n\n                @Override\n                public byte[] getSignature() {\n                    try {\n                        byte[] hash = digest.digest();\n                        byte[] signedHash = serverSignature.sign(Base64.getEncoder().encodeToString(hash));\n                        return signedHash;\n                    } catch (Exception e) {\n                        throw new RuntimeException(&quot;Exception while signing&quot;, e);\n                    }\n                }\n\n                @Override\n                public OutputStream getOutputStream() {\n                    return stream;\n                }\n\n                @Override\n                public AlgorithmIdentifier getAlgorithmIdentifier() {\n                    return new AlgorithmIdentifier(new ASN1ObjectIdentifier(&quot;1.2.840.113549.1.1.11&quot;));\n                }\n            };\n\n            // create the SignedData generator and execute\n            CMSSignedDataGenerator gen = new CMSSignedDataGenerator();\n            gen.addCertificates(new JcaCertStore(Arrays.asList(certificateChain)));\n            gen.addSignerInfoGenerator(sigb.build(contentSigner, new X509CertificateHolder(cert2)));\n\n            CMSTypedData msg = new CMSProcessableInputStream(externalSigning.getContent());\n            CMSSignedData signedData = gen.generate(msg, false);\n\n            byte[] cmsSignature = signedData.getEncoded();\n            externalSigning.setSignature(cmsSignature);\n        }\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":17774775,"reputation":1,"user_id":12907401,"display_name":"jan_s"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":295,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77050400,"answer_count":2,"score":0,"last_activity_date":1694357983,"creation_date":1692878226,"question_id":76969040,"body_markdown":"**Problem description**\r\n\r\nWe have a specific business / technical case - we need to electronically sign PDFs, and to do that we&#39;re partnering with a company that handles electronic signature over the hash of a PDF.\r\n\r\nWe more or less know how to get the hash from the PDF and merge it back after signing by an external service via Rest API - but something along this process causes the PDF to show &quot;Document has been altered or corrupted since it was signed&quot;.\r\n\r\n\r\n\r\n[Resulting PDF with broken signature](https://i.stack.imgur.com/FSmHW.png)\r\n\r\n**How we&#39;re doing it**\r\n\r\nWe are using library Apache PDFBox version 3.0.0 (and we tried with different versions as well) and we&#39;re basing our solution on the official Apache Examples:\r\n\r\nhttps://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/\r\n- CreateSignature\r\n- CreateSignatureBase\r\n\r\nWe&#39;ve read many posts on stackoverlow that describe problems similar to ours, for example:\r\n- https://stackoverflow.com/questions/56867465/external-signature-with-pdfbox-2-0-15\r\n- https://stackoverflow.com/questions/41767351/create-pkcs7-signature-from-file-digest\r\n\r\n*And we settled on the solution described here*: \r\nhttps://stackoverflow.com/questions/69676156/java-pdfbox-pdf-sign-problem-external-signature-invalid-signature-there-are\r\n\r\nOur main class - CreateSignature\r\n\r\n```java\r\npackage TOTPSignPDF.Service;\r\n\r\nimport org.apache.pdfbox.Loader;\r\nimport org.apache.pdfbox.pdmodel.PDDocument;\r\nimport org.apache.pdfbox.pdmodel.interactive.digitalsignature.ExternalSigningSupport;\r\nimport org.apache.pdfbox.pdmodel.interactive.digitalsignature.PDSignature;\r\nimport org.bouncycastle.asn1.x509.AlgorithmIdentifier;\r\nimport org.bouncycastle.cert.jcajce.JcaCertStore;\r\nimport org.bouncycastle.cms.CMSException;\r\nimport org.bouncycastle.cms.CMSSignedData;\r\nimport org.bouncycastle.cms.CMSSignedDataGenerator;\r\nimport org.bouncycastle.cms.CMSTypedData;\r\nimport org.bouncycastle.cms.jcajce.JcaSignerInfoGeneratorBuilder;\r\nimport org.bouncycastle.jce.provider.BouncyCastleProvider;\r\nimport org.bouncycastle.operator.ContentSigner;\r\nimport org.bouncycastle.operator.DefaultSignatureAlgorithmIdentifierFinder;\r\nimport org.bouncycastle.operator.OperatorCreationException;\r\nimport org.bouncycastle.operator.jcajce.JcaDigestCalculatorProviderBuilder;\r\nimport org.slf4j.Logger;\r\nimport org.slf4j.LoggerFactory;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.stereotype.Service;\r\n\r\nimport java.io.ByteArrayInputStream;\r\nimport java.io.ByteArrayOutputStream;\r\nimport java.io.File;\r\nimport java.io.FileNotFoundException;\r\nimport java.io.FileOutputStream;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.io.OutputStream;\r\nimport java.security.GeneralSecurityException;\r\nimport java.security.MessageDigest;\r\nimport java.security.cert.Certificate;\r\nimport java.security.cert.X509Certificate;\r\nimport java.util.Arrays;\r\nimport java.util.Base64;\r\nimport java.util.Calendar;\r\n\r\n/*\r\n    This solution was based on official examples from Apache:\r\n    https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/CreateSignature.java?revision=1899086&amp;view=markup\r\n    https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/CreateSignatureBase.java?view=markup\r\n */\r\n\r\n@Service\r\npublic class CreateSignature {\r\n\r\n    private static final Logger LOG = LoggerFactory.getLogger(CreateSignature.class);\r\n\r\n    //@Autowired\r\n    //ServerSignature serverSignature;\r\n\r\n    @Autowired\r\n    ExternalSignature externalSignature;\r\n\r\n    private Certificate[] certificateChain;\r\n\r\n    /**\r\n     * Signs the given PDF file.\r\n     *\r\n     * @param inFile the original PDF file\r\n     */\r\n    public void signDocument(File inFile) throws IOException {\r\n\r\n        // we&#39;re being given the certificate chain with public key\r\n        setCertificateChain(externalSignature.getCertificateChain());\r\n\r\n        String name = inFile.getName();\r\n        String substring = name.substring(0, name.lastIndexOf(&#39;.&#39;));\r\n\r\n        File outFile = new File(inFile.getParent(), substring + &quot;_signed.pdf&quot;);\r\n        loadPDFAndSign(inFile, outFile);\r\n    }\r\n\r\n    private void setCertificateChain(final Certificate[] certificateChain) {\r\n        this.certificateChain = certificateChain;\r\n    }\r\n\r\n    /**\r\n     * Signs the given PDF file.\r\n     *\r\n     * @param inFile  input PDF file\r\n     * @param outFile output PDF file\r\n     * @throws IOException if the input file could not be read\r\n     */\r\n\r\n    private void loadPDFAndSign(File inFile, File outFile) throws IOException {\r\n        if (inFile == null || !inFile.exists()) {\r\n            throw new FileNotFoundException(&quot;Document for signing does not exist&quot;);\r\n        }\r\n\r\n        // sign\r\n        try (FileOutputStream fileOutputStream = new FileOutputStream(outFile);\r\n             PDDocument doc = Loader.loadPDF(inFile)) {\r\n            addSignatureDictionaryAndSignExternally(doc, fileOutputStream);\r\n        }\r\n    }\r\n\r\n    private void addSignatureDictionaryAndSignExternally(PDDocument document, OutputStream output)\r\n        throws IOException {\r\n\r\n        int accessPermissions = SigUtils.getMDPPermission(document);\r\n        if (accessPermissions == 1) {\r\n            throw new IllegalStateException(&quot;No changes to the document are permitted due to DocMDP transform parameters dictionary&quot;);\r\n        }\r\n\r\n        // create signature dictionary\r\n        PDSignature signature = new PDSignature();\r\n        signature.setFilter(PDSignature.FILTER_ADOBE_PPKLITE);\r\n        signature.setSubFilter(PDSignature.SUBFILTER_ADBE_PKCS7_DETACHED);\r\n        signature.setName(&quot;Example User&quot;);\r\n        signature.setLocation(&quot;Los Angeles, CA&quot;);\r\n        signature.setReason(&quot;Testing&quot;);\r\n\r\n        // the signing date, needed for valid signature\r\n        signature.setSignDate(Calendar.getInstance());\r\n\r\n        // Optional: certify \r\n        if (accessPermissions == 0) {\r\n            SigUtils.setMDPPermission(document, signature, 2);\r\n        }\r\n\r\n        // it was if(isExternalSigning()) {\r\n        document.addSignature(signature);\r\n        ExternalSigningSupport externalSigning = document.saveIncrementalForExternalSigning(output);\r\n        // invoke external signature service - passing the document content with the &quot;empty&quot; signature added\r\n        byte[] cmsSignature = sign(externalSigning.getContent());\r\n        // set signature bytes received from the service\r\n        externalSigning.setSignature(cmsSignature);\r\n        //}\r\n\r\n        // call SigUtils.checkCrossReferenceTable(document) if Adobe complains - we&#39;re doing it only because I ran out of ideas\r\n        // and read https://stackoverflow.com/a/71293901/535646\r\n        // and https://issues.apache.org/jira/browse/PDFBOX-5382\r\n        SigUtils.checkCrossReferenceTable(document); // no errors here\r\n\r\n        //document.close(); not needed because document is defined as auto-closeable resource in the function above\r\n    }\r\n\r\n    /**\r\n     * SignatureInterface sample implementation.\r\n     * Use your favorite cryptographic library to implement PKCS #7 signature creation.\r\n     * If you want to create the hash and the signature separately (e.g. to transfer only the hash\r\n     * to an external application), read &lt;a href=&quot;https://stackoverflow.com/questions/41767351&quot;&gt;this\r\n     * answer&lt;/a&gt; or &lt;a href=&quot;https://stackoverflow.com/questions/56867465&quot;&gt;this answer&lt;/a&gt;.\r\n     *\r\n     * @throws IOException\r\n     */\r\n    private byte[] sign(InputStream content) throws IOException {\r\n        try {\r\n\r\n            // get the hash of the document with additional signature field\r\n            MessageDigest digest = MessageDigest.getInstance(&quot;SHA256&quot;, new BouncyCastleProvider());\r\n\r\n            byte[] hashBytes = digest.digest(content.readAllBytes());\r\n            String hashBase64 = new String(Base64.getEncoder().encode(hashBytes));\r\n            LOG.info(&quot;Digest in Base64: &quot; + hashBase64);\r\n\r\n            // call External API to sign the hash - hash of the document with added field for signature\r\n            //byte[] signedHashBytes = serverSignature.sign(hashBase64);\r\n            byte[] signedHashBytes = externalSignature.sign(hashBytes);\r\n\r\n            // this lower part of the code is based on this answer:\r\n            // https://stackoverflow.com/questions/69676156/java-pdfbox-pdf-sign-problem-external-signature-invalid-signature-there-are\r\n            //\r\n            // In the standalone application this ContentSigner would be an implementation of signing process,\r\n            // but we are given the signed hash from the External Api and we just have to return it - the same situation\r\n            // as in this stackoverflow post\r\n            ContentSigner nonSigner_signedHashProvided = new ContentSigner() {\r\n\r\n                @Override\r\n                public byte[] getSignature() {\r\n                    return signedHashBytes;\r\n                }\r\n\r\n                @Override\r\n                public OutputStream getOutputStream() {\r\n                    return new ByteArrayOutputStream();\r\n                }\r\n\r\n                @Override\r\n                public AlgorithmIdentifier getAlgorithmIdentifier() {\r\n                    return new DefaultSignatureAlgorithmIdentifierFinder().find(&quot;SHA256WithRSA&quot;);\r\n                }\r\n            };\r\n\r\n            CMSSignedDataGenerator gen = new CMSSignedDataGenerator();\r\n            X509Certificate certificateRepresentingTheSigner = (X509Certificate) certificateChain[0];\r\n\r\n            gen.addSignerInfoGenerator(\r\n                new JcaSignerInfoGeneratorBuilder(new JcaDigestCalculatorProviderBuilder().build())\r\n                    .build(\r\n                        nonSigner_signedHashProvided,\r\n                        certificateRepresentingTheSigner\r\n                    )\r\n            );\r\n            gen.addCertificates(new JcaCertStore(Arrays.asList(certificateChain)));\r\n\r\n            //CMSProcessableInputStream msg = new CMSProcessableInputStream(content);\r\n            //these don&#39;t seem to change anything\r\n            //CMSTypedData msg = new CMSProcessableByteArray(signedHashBytes);\r\n            CMSTypedData msg = new CMSProcessableInputStream(new ByteArrayInputStream(&quot;not used&quot;.getBytes()));\r\n            CMSSignedData signedData = gen.generate(msg, false);\r\n\r\n            return signedData.getEncoded();\r\n        } catch (GeneralSecurityException | CMSException | OperatorCreationException e) {\r\n            throw new IOException(e);\r\n        } catch (Exception e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nClass imitating the external hash signing process - ExternalSignature\r\n\r\nI created a local keystore with self-signed private key with this command:\r\n\r\n`keytool -genkeypair -storepass 123456 -storetype pkcs12 -alias testKeystoreForPOC -validity 365 -keystore testKeystore.jks -keyalg RSA -sigalg SHA256withRSA`\r\n\r\n\r\n```java\r\npackage TOTPSignPDF.Service;\r\n\r\nimport org.slf4j.Logger;\r\nimport org.slf4j.LoggerFactory;\r\nimport org.springframework.stereotype.Service;\r\n\r\nimport javax.annotation.PostConstruct;\r\nimport java.io.File;\r\nimport java.io.FileInputStream;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.security.InvalidKeyException;\r\nimport java.security.KeyStore;\r\nimport java.security.KeyStoreException;\r\nimport java.security.NoSuchAlgorithmException;\r\nimport java.security.PrivateKey;\r\nimport java.security.Signature;\r\nimport java.security.SignatureException;\r\nimport java.security.UnrecoverableKeyException;\r\nimport java.security.cert.Certificate;\r\nimport java.security.cert.CertificateEncodingException;\r\nimport java.security.cert.CertificateException;\r\nimport java.security.cert.X509Certificate;\r\nimport java.util.Base64;\r\nimport java.util.Enumeration;\r\n\r\n@Service\r\npublic class ExternalSignature {\r\n    private static final Logger LOG = LoggerFactory.getLogger(ExternalSignature.class);\r\n\r\n    private Certificate[] certificateChain;\r\n\r\n    private PrivateKey privateKey;\r\n\r\n    public byte[] sign(byte[] bytesToSign) {\r\n        LOG.info(&quot;Started signing process&quot;);\r\n        try {\r\n            Signature privateSignature = Signature.getInstance(&quot;SHA256withRSA&quot;);\r\n            privateSignature.initSign(privateKey);\r\n            privateSignature.update(bytesToSign);\r\n            byte[] signature = privateSignature.sign();\r\n            LOG.info(&quot;Finished signing process&quot;);\r\n            return signature;\r\n        } catch (NoSuchAlgorithmException | InvalidKeyException | SignatureException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n\r\n    public Certificate[] getCertificateChain(){\r\n        return this.certificateChain;\r\n    }\r\n\r\n    @PostConstruct\r\n    private void initializePostConstruct() {\r\n        File keystoreFile = new File(&quot;keystore/testKeystore.jks&quot;);\r\n\r\n        try {\r\n            KeyStore keystore = KeyStore.getInstance(&quot;PKCS12&quot;);\r\n\r\n            char[] password = &quot;123456&quot;.toCharArray();\r\n            try (InputStream is = new FileInputStream(keystoreFile)) {\r\n                keystore.load(is, password);\r\n            }\r\n\r\n            // grabs the first alias from the keystore and get the private key. An\r\n            // alternative method or constructor could be used for setting a specific\r\n            // alias that should be used.\r\n            Enumeration&lt;String&gt; aliases = keystore.aliases();\r\n            String alias;\r\n            Certificate cert = null;\r\n            while (cert == null &amp;&amp; aliases.hasMoreElements()) {\r\n                alias = aliases.nextElement();\r\n                setPrivateKey((PrivateKey) keystore.getKey(alias, password));\r\n                Certificate[] certChain = keystore.getCertificateChain(alias);\r\n                if (certChain != null) {\r\n                    setCertificateChain(certChain);\r\n                    cert = certChain[0];\r\n                    if (cert instanceof X509Certificate) {\r\n                        // avoid expired certificate\r\n                        ((X509Certificate) cert).checkValidity();\r\n\r\n                        SigUtils.checkCertificateUsage((X509Certificate) cert);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (cert == null) {\r\n                throw new IOException(&quot;Could not find certificate&quot;);\r\n            }\r\n        } catch (KeyStoreException | NoSuchAlgorithmException | CertificateException | UnrecoverableKeyException | IOException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n\r\n    public final void setPrivateKey(PrivateKey privateKey) {\r\n        LOG.info(&quot;Set new private key&quot;);\r\n        String base64OfPrivateKey = new String(Base64.getEncoder().encode(privateKey.getEncoded()));\r\n        LOG.info(&quot;base64OfPrivateKey: &quot; + base64OfPrivateKey);\r\n        this.privateKey = privateKey;\r\n    }\r\n\r\n    public final void setCertificateChain(final Certificate[] certificateChain) {\r\n        LOG.info(&quot;Set new certificate chain, size: &quot; + certificateChain.length);\r\n        try {\r\n            String base64OfPublicKey = new String(Base64.getEncoder().encode(certificateChain[0].getEncoded()));\r\n            LOG.info(&quot;base64OfPublicKey: &quot; + base64OfPublicKey);\r\n        } catch (CertificateEncodingException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n        this.certificateChain = certificateChain;\r\n    }\r\n}\r\n```\r\n\r\n\r\nAdditional classes that are used from Apache examples:\r\n\r\n- CMSProcessableInputStream\r\n- SigUtils\r\n\r\n**Please help us**\r\n\r\nAs far as we understand other posts on this site revolving around similar problems, everything should work, but it doesn&#39;t.\r\nMost probably we&#39;re missing some crucial step.\r\n\r\nWe’re looking forward to any response, every bit of information could help us.\r\n\r\nSomething that I don&#39;t understand is why the digest (hash) of the PDF is so small: `LXl/LHCaxrf7lYlN8d8m7gDNp9DRqY+azvxCS/mB3uY=`\r\n\r\nDoes it look like correct size ?\r\n\r\n\r\n\r\n**PDF examples and public / private key**\r\n\r\n - [PDF after signing](https://www.dropbox.com/scl/fi/zpy8wez9m6hk05r94b1og/PDFSignTest_signed.pdf?rlkey=4df0pjie0caqt5xkeb0tqfrlk&amp;dl=0)\r\n - [PDF before signing](https://www.dropbox.com/scl/fi/6xbq3k648iabgeomlq7ir/PDFSignTest.pdf?rlkey=faomwn2uw6c62xxyxv1uo5rnl&amp;dl=0)\r\n - [Keystore used for signing process](https://www.dropbox.com/scl/fi/mjqottdokq31a5lnc09fi/testKeystore.jks?rlkey=dqq75mb83gh09jhlru8emmi4c&amp;dl=0)\r\n\r\n - Public key in Base64:     `MIIDUTCCAjmgAwIBAgIEZPgGSjANBgkqhkiG9w0BAQsFADBZMQswCQYDVQQGEwJURTENMAsGA1UECBMEVGVzdDENMAsGA1UEBxMEVGVzdDENMAsGA1UEChMEVGVzdDENMAsGA1UECxMEVGVzdDEOMAwGA1UEAxMFSmFuIFMwHhcNMjMwODI0MTgzMTM2WhcNMjQwODIzMTgzMTM2WjBZMQswCQYDVQQGEwJURTENMAsGA1UECBMEVGVzdDENMAsGA1UEBxMEVGVzdDENMAsGA1UEChMEVGVzdDENMAsGA1UECxMEVGVzdDEOMAwGA1UEAxMFSmFuIFMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCEO5+UBxpzSI5vtmPvzlyz0d1yHph33VG9bFkqQ7bnmE3ghHiFyGTBrD7IPTrBg1NjhdC5jqpa/acY/oWUAwV5dlyD02nVBoy7VBLvz7QOc9QPaUQ2frVY4Qy05qgLZEGgnbpG2X44sqV8ogW1y2IaY+2F9NBKralp8r6M/sB4DKJmTWd+1UOlpnlfr3H5KvX+YXzfC+KVDIEoG7yzXZuw7I3x0VawVz/5gx3FAkagi7yHh9J58kmImpOFquxcK6SdMCoBsWmFmHmCpExVfxrVLMpIV5a5AHDWn84YHHRKC5kvhnyujXaIHFV+78TFxk8DGnPnKcgFRWKRVyfcYT7hAgMBAAGjITAfMB0GA1UdDgQWBBQFR8qbfk35MQdMqxQhZ2kkLoLPDDANBgkqhkiG9w0BAQsFAAOCAQEAI6aAn6zKcRieUkyHraRswYhxRjpc1fDaeDz01XanqxUIpNf31dU+f62oo5Dv4VAgd6MzLdFSpcERB9ScJzIIrz7mnqS0r8LhesDejs/mnDg2+E89XHy7yZtU3MqAXmESe7qms8AB1F68YZ+OOjWfn1AZfjaAzU0La49NaFbQE96vBLBGNX2Efavk7trv9PMCKMio19w/FBGwH8cU0erAi/WZhRlX3C1eFfmGSs5BWZL03yOmdeR/PVNut135dbk0EJ9rn6TJp1KgoNqcnsbPZcSxmUB/3U/hWUoFb6UN7g+1NbVh0PHCZ2Kbwyk6mO2viNbXka1WuopUxGh1RmJW9A==`\r\n\r\n - Private key in Base64:\r\n`MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCEO5+UBxpzSI5vtmPvzlyz0d1yHph33VG9bFkqQ7bnmE3ghHiFyGTBrD7IPTrBg1NjhdC5jqpa/acY/oWUAwV5dlyD02nVBoy7VBLvz7QOc9QPaUQ2frVY4Qy05qgLZEGgnbpG2X44sqV8ogW1y2IaY+2F9NBKralp8r6M/sB4DKJmTWd+1UOlpnlfr3H5KvX+YXzfC+KVDIEoG7yzXZuw7I3x0VawVz/5gx3FAkagi7yHh9J58kmImpOFquxcK6SdMCoBsWmFmHmCpExVfxrVLMpIV5a5AHDWn84YHHRKC5kvhnyujXaIHFV+78TFxk8DGnPnKcgFRWKRVyfcYT7hAgMBAAECggEAdp8iBWHl6XsyQ6bDufFOmgVu+RvXPNfuptXWmyKJpvKrEfjkQWdGc7L30xuSZNxRZxs45ezEh8G6L6LL475eH9r9HUj/TJmGj9nY7wZNiRWBK54MEjLSrfudMX8lSqrScKpt23bqUyR3bfnO04my5Oe1wRCf9g4ZxzB6nfM+Z7Hq+HxJRk5KlkMCGCf5Q0kA0t2FCkEHyvLUKft/ba05/XNODnDbA3n7AkWCzKmU9ypRen2OjqWaamQAaD0eJvxXDMEsAbZ+xGzD68GKs9+glmF9iZUoDwFMa3aCqVTpskOUtYxKHXVwgbhZoPpgmC+NPjlwaWdntp8a77q/Z0Jg0QKBgQDEwxbwvUHG3vtUK27WMBW7UunwUHuyA5ECaZG6Spm1rq6OhGLaSOWDNUF9VVgLTEkW6M/stxEuTqzWT1lbUqGIYeOkP6e5tD9LIYoUb6Sozpa6f0cwEsxNKpVOxRIn9tIOx3dZS164+rT1d75+t6W9tHPGFaOZJOKwObn9eoJK7QKBgQCsCx7xQq+rawXoNPQBBABSvLe4alxCQ8MhBDhFYjWAh9scfocCDFHSYXzG1AhMG5dBMNWvkL3xuXVw1ba7FltSb1VHvjQqkr9AV+QNR4sCorVy1tNIuH63Jwtsn3UkYr0CUU6u/sWZW5pirs+fobFv2DZraPnB3j5z1d8RpjShRQKBgF3ilMSkGYmyBgxgeQ98fDIY2wVO8ea76upSwzU3uWZGhoX8R0rOs6zKsYgDO/KQIOPsjKHvrCQDaFcOH54CrI7t3ngV44sppXXM+BzONKxTfvpYFviqT4+WfQ3L3ODy1cI1jQ4vd3AeOFBUJbJDILOHMiLXWmuNfRkHQmbfmOH1AoGAFilQkQ9gBZrBpgm8LK1RRVcd61l4DOkhp40dmoJuFeJqLR93UKI5n/oC0rHZZ8ReFX2u6PCiJxMWt7Qv16WnmdTRjW5I1fsVO7qWm8dNdsdyzBo0GTf6yqjy5ckck9VMN5I1qoES/xA3sOKHyC5R5vBZAjkBgyGXteAk3eck/GkCgYEArm4brBpXj+Ox6Korw0Hk2bdk30R7BAm2+N+E1683wJBnWP3kiGGRDaGulUtoq2HthXr42ZyfwtuiS9UrAJFOWDLy3UYxeR1DYDFoq+mdy1fR8IniWXyGZQ6goJ0t/SNIN1NsRnh03Fc8iqRqYEs3anvuOr8xGvMsxXW0qT9OLcY=`","title":"Java Apache PDFBox - issue with generating the hash for external signing or with merging it back - adding Public key certificate chain to PDF","body":"<p><strong>Problem description</strong></p>\n<p>We have a specific business / technical case - we need to electronically sign PDFs, and to do that we're partnering with a company that handles electronic signature over the hash of a PDF.</p>\n<p>We more or less know how to get the hash from the PDF and merge it back after signing by an external service via Rest API - but something along this process causes the PDF to show &quot;Document has been altered or corrupted since it was signed&quot;.</p>\n<p><a href=\"https://i.stack.imgur.com/FSmHW.png\" rel=\"nofollow noreferrer\">Resulting PDF with broken signature</a></p>\n<p><strong>How we're doing it</strong></p>\n<p>We are using library Apache PDFBox version 3.0.0 (and we tried with different versions as well) and we're basing our solution on the official Apache Examples:</p>\n<p><a href=\"https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/\" rel=\"nofollow noreferrer\">https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/</a></p>\n<ul>\n<li>CreateSignature</li>\n<li>CreateSignatureBase</li>\n</ul>\n<p>We've read many posts on stackoverlow that describe problems similar to ours, for example:</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/56867465/external-signature-with-pdfbox-2-0-15\">External Signature with PDFBox 2.0.15</a></li>\n<li><a href=\"https://stackoverflow.com/questions/41767351/create-pkcs7-signature-from-file-digest\">Create pkcs7 signature from file digest</a></li>\n</ul>\n<p><em>And we settled on the solution described here</em>:\n<a href=\"https://stackoverflow.com/questions/69676156/java-pdfbox-pdf-sign-problem-external-signature-invalid-signature-there-are\">Java PdfBox - PDF Sign Problem -External Signature -Invalid signature There are errors in formatting or in the information contained in this signature</a></p>\n<p>Our main class - CreateSignature</p>\n<pre class=\"lang-java prettyprint-override\"><code>package TOTPSignPDF.Service;\n\nimport org.apache.pdfbox.Loader;\nimport org.apache.pdfbox.pdmodel.PDDocument;\nimport org.apache.pdfbox.pdmodel.interactive.digitalsignature.ExternalSigningSupport;\nimport org.apache.pdfbox.pdmodel.interactive.digitalsignature.PDSignature;\nimport org.bouncycastle.asn1.x509.AlgorithmIdentifier;\nimport org.bouncycastle.cert.jcajce.JcaCertStore;\nimport org.bouncycastle.cms.CMSException;\nimport org.bouncycastle.cms.CMSSignedData;\nimport org.bouncycastle.cms.CMSSignedDataGenerator;\nimport org.bouncycastle.cms.CMSTypedData;\nimport org.bouncycastle.cms.jcajce.JcaSignerInfoGeneratorBuilder;\nimport org.bouncycastle.jce.provider.BouncyCastleProvider;\nimport org.bouncycastle.operator.ContentSigner;\nimport org.bouncycastle.operator.DefaultSignatureAlgorithmIdentifierFinder;\nimport org.bouncycastle.operator.OperatorCreationException;\nimport org.bouncycastle.operator.jcajce.JcaDigestCalculatorProviderBuilder;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\n\nimport java.io.ByteArrayInputStream;\nimport java.io.ByteArrayOutputStream;\nimport java.io.File;\nimport java.io.FileNotFoundException;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.OutputStream;\nimport java.security.GeneralSecurityException;\nimport java.security.MessageDigest;\nimport java.security.cert.Certificate;\nimport java.security.cert.X509Certificate;\nimport java.util.Arrays;\nimport java.util.Base64;\nimport java.util.Calendar;\n\n/*\n    This solution was based on official examples from Apache:\n    https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/CreateSignature.java?revision=1899086&amp;view=markup\n    https://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/CreateSignatureBase.java?view=markup\n */\n\n@Service\npublic class CreateSignature {\n\n    private static final Logger LOG = LoggerFactory.getLogger(CreateSignature.class);\n\n    //@Autowired\n    //ServerSignature serverSignature;\n\n    @Autowired\n    ExternalSignature externalSignature;\n\n    private Certificate[] certificateChain;\n\n    /**\n     * Signs the given PDF file.\n     *\n     * @param inFile the original PDF file\n     */\n    public void signDocument(File inFile) throws IOException {\n\n        // we're being given the certificate chain with public key\n        setCertificateChain(externalSignature.getCertificateChain());\n\n        String name = inFile.getName();\n        String substring = name.substring(0, name.lastIndexOf('.'));\n\n        File outFile = new File(inFile.getParent(), substring + &quot;_signed.pdf&quot;);\n        loadPDFAndSign(inFile, outFile);\n    }\n\n    private void setCertificateChain(final Certificate[] certificateChain) {\n        this.certificateChain = certificateChain;\n    }\n\n    /**\n     * Signs the given PDF file.\n     *\n     * @param inFile  input PDF file\n     * @param outFile output PDF file\n     * @throws IOException if the input file could not be read\n     */\n\n    private void loadPDFAndSign(File inFile, File outFile) throws IOException {\n        if (inFile == null || !inFile.exists()) {\n            throw new FileNotFoundException(&quot;Document for signing does not exist&quot;);\n        }\n\n        // sign\n        try (FileOutputStream fileOutputStream = new FileOutputStream(outFile);\n             PDDocument doc = Loader.loadPDF(inFile)) {\n            addSignatureDictionaryAndSignExternally(doc, fileOutputStream);\n        }\n    }\n\n    private void addSignatureDictionaryAndSignExternally(PDDocument document, OutputStream output)\n        throws IOException {\n\n        int accessPermissions = SigUtils.getMDPPermission(document);\n        if (accessPermissions == 1) {\n            throw new IllegalStateException(&quot;No changes to the document are permitted due to DocMDP transform parameters dictionary&quot;);\n        }\n\n        // create signature dictionary\n        PDSignature signature = new PDSignature();\n        signature.setFilter(PDSignature.FILTER_ADOBE_PPKLITE);\n        signature.setSubFilter(PDSignature.SUBFILTER_ADBE_PKCS7_DETACHED);\n        signature.setName(&quot;Example User&quot;);\n        signature.setLocation(&quot;Los Angeles, CA&quot;);\n        signature.setReason(&quot;Testing&quot;);\n\n        // the signing date, needed for valid signature\n        signature.setSignDate(Calendar.getInstance());\n\n        // Optional: certify \n        if (accessPermissions == 0) {\n            SigUtils.setMDPPermission(document, signature, 2);\n        }\n\n        // it was if(isExternalSigning()) {\n        document.addSignature(signature);\n        ExternalSigningSupport externalSigning = document.saveIncrementalForExternalSigning(output);\n        // invoke external signature service - passing the document content with the &quot;empty&quot; signature added\n        byte[] cmsSignature = sign(externalSigning.getContent());\n        // set signature bytes received from the service\n        externalSigning.setSignature(cmsSignature);\n        //}\n\n        // call SigUtils.checkCrossReferenceTable(document) if Adobe complains - we're doing it only because I ran out of ideas\n        // and read https://stackoverflow.com/a/71293901/535646\n        // and https://issues.apache.org/jira/browse/PDFBOX-5382\n        SigUtils.checkCrossReferenceTable(document); // no errors here\n\n        //document.close(); not needed because document is defined as auto-closeable resource in the function above\n    }\n\n    /**\n     * SignatureInterface sample implementation.\n     * Use your favorite cryptographic library to implement PKCS #7 signature creation.\n     * If you want to create the hash and the signature separately (e.g. to transfer only the hash\n     * to an external application), read &lt;a href=&quot;https://stackoverflow.com/questions/41767351&quot;&gt;this\n     * answer&lt;/a&gt; or &lt;a href=&quot;https://stackoverflow.com/questions/56867465&quot;&gt;this answer&lt;/a&gt;.\n     *\n     * @throws IOException\n     */\n    private byte[] sign(InputStream content) throws IOException {\n        try {\n\n            // get the hash of the document with additional signature field\n            MessageDigest digest = MessageDigest.getInstance(&quot;SHA256&quot;, new BouncyCastleProvider());\n\n            byte[] hashBytes = digest.digest(content.readAllBytes());\n            String hashBase64 = new String(Base64.getEncoder().encode(hashBytes));\n            LOG.info(&quot;Digest in Base64: &quot; + hashBase64);\n\n            // call External API to sign the hash - hash of the document with added field for signature\n            //byte[] signedHashBytes = serverSignature.sign(hashBase64);\n            byte[] signedHashBytes = externalSignature.sign(hashBytes);\n\n            // this lower part of the code is based on this answer:\n            // https://stackoverflow.com/questions/69676156/java-pdfbox-pdf-sign-problem-external-signature-invalid-signature-there-are\n            //\n            // In the standalone application this ContentSigner would be an implementation of signing process,\n            // but we are given the signed hash from the External Api and we just have to return it - the same situation\n            // as in this stackoverflow post\n            ContentSigner nonSigner_signedHashProvided = new ContentSigner() {\n\n                @Override\n                public byte[] getSignature() {\n                    return signedHashBytes;\n                }\n\n                @Override\n                public OutputStream getOutputStream() {\n                    return new ByteArrayOutputStream();\n                }\n\n                @Override\n                public AlgorithmIdentifier getAlgorithmIdentifier() {\n                    return new DefaultSignatureAlgorithmIdentifierFinder().find(&quot;SHA256WithRSA&quot;);\n                }\n            };\n\n            CMSSignedDataGenerator gen = new CMSSignedDataGenerator();\n            X509Certificate certificateRepresentingTheSigner = (X509Certificate) certificateChain[0];\n\n            gen.addSignerInfoGenerator(\n                new JcaSignerInfoGeneratorBuilder(new JcaDigestCalculatorProviderBuilder().build())\n                    .build(\n                        nonSigner_signedHashProvided,\n                        certificateRepresentingTheSigner\n                    )\n            );\n            gen.addCertificates(new JcaCertStore(Arrays.asList(certificateChain)));\n\n            //CMSProcessableInputStream msg = new CMSProcessableInputStream(content);\n            //these don't seem to change anything\n            //CMSTypedData msg = new CMSProcessableByteArray(signedHashBytes);\n            CMSTypedData msg = new CMSProcessableInputStream(new ByteArrayInputStream(&quot;not used&quot;.getBytes()));\n            CMSSignedData signedData = gen.generate(msg, false);\n\n            return signedData.getEncoded();\n        } catch (GeneralSecurityException | CMSException | OperatorCreationException e) {\n            throw new IOException(e);\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n    }\n}\n</code></pre>\n<p>Class imitating the external hash signing process - ExternalSignature</p>\n<p>I created a local keystore with self-signed private key with this command:</p>\n<p><code>keytool -genkeypair -storepass 123456 -storetype pkcs12 -alias testKeystoreForPOC -validity 365 -keystore testKeystore.jks -keyalg RSA -sigalg SHA256withRSA</code></p>\n<pre class=\"lang-java prettyprint-override\"><code>package TOTPSignPDF.Service;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Service;\n\nimport javax.annotation.PostConstruct;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.security.InvalidKeyException;\nimport java.security.KeyStore;\nimport java.security.KeyStoreException;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.PrivateKey;\nimport java.security.Signature;\nimport java.security.SignatureException;\nimport java.security.UnrecoverableKeyException;\nimport java.security.cert.Certificate;\nimport java.security.cert.CertificateEncodingException;\nimport java.security.cert.CertificateException;\nimport java.security.cert.X509Certificate;\nimport java.util.Base64;\nimport java.util.Enumeration;\n\n@Service\npublic class ExternalSignature {\n    private static final Logger LOG = LoggerFactory.getLogger(ExternalSignature.class);\n\n    private Certificate[] certificateChain;\n\n    private PrivateKey privateKey;\n\n    public byte[] sign(byte[] bytesToSign) {\n        LOG.info(&quot;Started signing process&quot;);\n        try {\n            Signature privateSignature = Signature.getInstance(&quot;SHA256withRSA&quot;);\n            privateSignature.initSign(privateKey);\n            privateSignature.update(bytesToSign);\n            byte[] signature = privateSignature.sign();\n            LOG.info(&quot;Finished signing process&quot;);\n            return signature;\n        } catch (NoSuchAlgorithmException | InvalidKeyException | SignatureException e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n    public Certificate[] getCertificateChain(){\n        return this.certificateChain;\n    }\n\n    @PostConstruct\n    private void initializePostConstruct() {\n        File keystoreFile = new File(&quot;keystore/testKeystore.jks&quot;);\n\n        try {\n            KeyStore keystore = KeyStore.getInstance(&quot;PKCS12&quot;);\n\n            char[] password = &quot;123456&quot;.toCharArray();\n            try (InputStream is = new FileInputStream(keystoreFile)) {\n                keystore.load(is, password);\n            }\n\n            // grabs the first alias from the keystore and get the private key. An\n            // alternative method or constructor could be used for setting a specific\n            // alias that should be used.\n            Enumeration&lt;String&gt; aliases = keystore.aliases();\n            String alias;\n            Certificate cert = null;\n            while (cert == null &amp;&amp; aliases.hasMoreElements()) {\n                alias = aliases.nextElement();\n                setPrivateKey((PrivateKey) keystore.getKey(alias, password));\n                Certificate[] certChain = keystore.getCertificateChain(alias);\n                if (certChain != null) {\n                    setCertificateChain(certChain);\n                    cert = certChain[0];\n                    if (cert instanceof X509Certificate) {\n                        // avoid expired certificate\n                        ((X509Certificate) cert).checkValidity();\n\n                        SigUtils.checkCertificateUsage((X509Certificate) cert);\n                    }\n                }\n            }\n\n            if (cert == null) {\n                throw new IOException(&quot;Could not find certificate&quot;);\n            }\n        } catch (KeyStoreException | NoSuchAlgorithmException | CertificateException | UnrecoverableKeyException | IOException e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n    public final void setPrivateKey(PrivateKey privateKey) {\n        LOG.info(&quot;Set new private key&quot;);\n        String base64OfPrivateKey = new String(Base64.getEncoder().encode(privateKey.getEncoded()));\n        LOG.info(&quot;base64OfPrivateKey: &quot; + base64OfPrivateKey);\n        this.privateKey = privateKey;\n    }\n\n    public final void setCertificateChain(final Certificate[] certificateChain) {\n        LOG.info(&quot;Set new certificate chain, size: &quot; + certificateChain.length);\n        try {\n            String base64OfPublicKey = new String(Base64.getEncoder().encode(certificateChain[0].getEncoded()));\n            LOG.info(&quot;base64OfPublicKey: &quot; + base64OfPublicKey);\n        } catch (CertificateEncodingException e) {\n            throw new RuntimeException(e);\n        }\n        this.certificateChain = certificateChain;\n    }\n}\n</code></pre>\n<p>Additional classes that are used from Apache examples:</p>\n<ul>\n<li>CMSProcessableInputStream</li>\n<li>SigUtils</li>\n</ul>\n<p><strong>Please help us</strong></p>\n<p>As far as we understand other posts on this site revolving around similar problems, everything should work, but it doesn't.\nMost probably we're missing some crucial step.</p>\n<p>We’re looking forward to any response, every bit of information could help us.</p>\n<p>Something that I don't understand is why the digest (hash) of the PDF is so small: <code>LXl/LHCaxrf7lYlN8d8m7gDNp9DRqY+azvxCS/mB3uY=</code></p>\n<p>Does it look like correct size ?</p>\n<p><strong>PDF examples and public / private key</strong></p>\n<ul>\n<li><p><a href=\"https://www.dropbox.com/scl/fi/zpy8wez9m6hk05r94b1og/PDFSignTest_signed.pdf?rlkey=4df0pjie0caqt5xkeb0tqfrlk&amp;dl=0\" rel=\"nofollow noreferrer\">PDF after signing</a></p>\n</li>\n<li><p><a href=\"https://www.dropbox.com/scl/fi/6xbq3k648iabgeomlq7ir/PDFSignTest.pdf?rlkey=faomwn2uw6c62xxyxv1uo5rnl&amp;dl=0\" rel=\"nofollow noreferrer\">PDF before signing</a></p>\n</li>\n<li><p><a href=\"https://www.dropbox.com/scl/fi/mjqottdokq31a5lnc09fi/testKeystore.jks?rlkey=dqq75mb83gh09jhlru8emmi4c&amp;dl=0\" rel=\"nofollow noreferrer\">Keystore used for signing process</a></p>\n</li>\n<li><p>Public key in Base64:     <code>MIIDUTCCAjmgAwIBAgIEZPgGSjANBgkqhkiG9w0BAQsFADBZMQswCQYDVQQGEwJURTENMAsGA1UECBMEVGVzdDENMAsGA1UEBxMEVGVzdDENMAsGA1UEChMEVGVzdDENMAsGA1UECxMEVGVzdDEOMAwGA1UEAxMFSmFuIFMwHhcNMjMwODI0MTgzMTM2WhcNMjQwODIzMTgzMTM2WjBZMQswCQYDVQQGEwJURTENMAsGA1UECBMEVGVzdDENMAsGA1UEBxMEVGVzdDENMAsGA1UEChMEVGVzdDENMAsGA1UECxMEVGVzdDEOMAwGA1UEAxMFSmFuIFMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCEO5+UBxpzSI5vtmPvzlyz0d1yHph33VG9bFkqQ7bnmE3ghHiFyGTBrD7IPTrBg1NjhdC5jqpa/acY/oWUAwV5dlyD02nVBoy7VBLvz7QOc9QPaUQ2frVY4Qy05qgLZEGgnbpG2X44sqV8ogW1y2IaY+2F9NBKralp8r6M/sB4DKJmTWd+1UOlpnlfr3H5KvX+YXzfC+KVDIEoG7yzXZuw7I3x0VawVz/5gx3FAkagi7yHh9J58kmImpOFquxcK6SdMCoBsWmFmHmCpExVfxrVLMpIV5a5AHDWn84YHHRKC5kvhnyujXaIHFV+78TFxk8DGnPnKcgFRWKRVyfcYT7hAgMBAAGjITAfMB0GA1UdDgQWBBQFR8qbfk35MQdMqxQhZ2kkLoLPDDANBgkqhkiG9w0BAQsFAAOCAQEAI6aAn6zKcRieUkyHraRswYhxRjpc1fDaeDz01XanqxUIpNf31dU+f62oo5Dv4VAgd6MzLdFSpcERB9ScJzIIrz7mnqS0r8LhesDejs/mnDg2+E89XHy7yZtU3MqAXmESe7qms8AB1F68YZ+OOjWfn1AZfjaAzU0La49NaFbQE96vBLBGNX2Efavk7trv9PMCKMio19w/FBGwH8cU0erAi/WZhRlX3C1eFfmGSs5BWZL03yOmdeR/PVNut135dbk0EJ9rn6TJp1KgoNqcnsbPZcSxmUB/3U/hWUoFb6UN7g+1NbVh0PHCZ2Kbwyk6mO2viNbXka1WuopUxGh1RmJW9A==</code></p>\n</li>\n<li><p>Private key in Base64:\n<code>MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCEO5+UBxpzSI5vtmPvzlyz0d1yHph33VG9bFkqQ7bnmE3ghHiFyGTBrD7IPTrBg1NjhdC5jqpa/acY/oWUAwV5dlyD02nVBoy7VBLvz7QOc9QPaUQ2frVY4Qy05qgLZEGgnbpG2X44sqV8ogW1y2IaY+2F9NBKralp8r6M/sB4DKJmTWd+1UOlpnlfr3H5KvX+YXzfC+KVDIEoG7yzXZuw7I3x0VawVz/5gx3FAkagi7yHh9J58kmImpOFquxcK6SdMCoBsWmFmHmCpExVfxrVLMpIV5a5AHDWn84YHHRKC5kvhnyujXaIHFV+78TFxk8DGnPnKcgFRWKRVyfcYT7hAgMBAAECggEAdp8iBWHl6XsyQ6bDufFOmgVu+RvXPNfuptXWmyKJpvKrEfjkQWdGc7L30xuSZNxRZxs45ezEh8G6L6LL475eH9r9HUj/TJmGj9nY7wZNiRWBK54MEjLSrfudMX8lSqrScKpt23bqUyR3bfnO04my5Oe1wRCf9g4ZxzB6nfM+Z7Hq+HxJRk5KlkMCGCf5Q0kA0t2FCkEHyvLUKft/ba05/XNODnDbA3n7AkWCzKmU9ypRen2OjqWaamQAaD0eJvxXDMEsAbZ+xGzD68GKs9+glmF9iZUoDwFMa3aCqVTpskOUtYxKHXVwgbhZoPpgmC+NPjlwaWdntp8a77q/Z0Jg0QKBgQDEwxbwvUHG3vtUK27WMBW7UunwUHuyA5ECaZG6Spm1rq6OhGLaSOWDNUF9VVgLTEkW6M/stxEuTqzWT1lbUqGIYeOkP6e5tD9LIYoUb6Sozpa6f0cwEsxNKpVOxRIn9tIOx3dZS164+rT1d75+t6W9tHPGFaOZJOKwObn9eoJK7QKBgQCsCx7xQq+rawXoNPQBBABSvLe4alxCQ8MhBDhFYjWAh9scfocCDFHSYXzG1AhMG5dBMNWvkL3xuXVw1ba7FltSb1VHvjQqkr9AV+QNR4sCorVy1tNIuH63Jwtsn3UkYr0CUU6u/sWZW5pirs+fobFv2DZraPnB3j5z1d8RpjShRQKBgF3ilMSkGYmyBgxgeQ98fDIY2wVO8ea76upSwzU3uWZGhoX8R0rOs6zKsYgDO/KQIOPsjKHvrCQDaFcOH54CrI7t3ngV44sppXXM+BzONKxTfvpYFviqT4+WfQ3L3ODy1cI1jQ4vd3AeOFBUJbJDILOHMiLXWmuNfRkHQmbfmOH1AoGAFilQkQ9gBZrBpgm8LK1RRVcd61l4DOkhp40dmoJuFeJqLR93UKI5n/oC0rHZZ8ReFX2u6PCiJxMWt7Qv16WnmdTRjW5I1fsVO7qWm8dNdsdyzBo0GTf6yqjy5ckck9VMN5I1qoES/xA3sOKHyC5R5vBZAjkBgyGXteAk3eck/GkCgYEArm4brBpXj+Ox6Korw0Hk2bdk30R7BAm2+N+E1683wJBnWP3kiGGRDaGulUtoq2HthXr42ZyfwtuiS9UrAJFOWDLy3UYxeR1DYDFoq+mdy1fR8IniWXyGZQ6goJ0t/SNIN1NsRnh03Fc8iqRqYEs3anvuOr8xGvMsxXW0qT9OLcY=</code></p>\n</li>\n</ul>\n"},{"tags":["java","android","sms","restore","smsmanager"],"comments":[{"owner":{"account_id":1790714,"reputation":91128,"user_id":1631193,"accept_rate":71,"display_name":"Gabe Sechan"},"score":1,"creation_date":1693524086,"post_id":77019630,"comment_id":135776413,"body_markdown":"You&#39;re trying to insert the same id multiple times.  You can&#39;t do that.  If an sms with that id already exists in the db, it will fail like this.","body":"You&#39;re trying to insert the same id multiple times.  You can&#39;t do that.  If an sms with that id already exists in the db, it will fail like this."},{"owner":{"account_id":6964564,"reputation":1,"user_id":5343031,"display_name":"Shahin Sadeghi"},"score":0,"creation_date":1693563608,"post_id":77019630,"comment_id":135780920,"body_markdown":"Thank you @GabeSechan I deleted all the text messages from the phone and there is no similar id and the error Logcat is no longer shown but The bug still remains and SMS messages cannot be restored only on Xiaomi phones.","body":"Thank you @GabeSechan I deleted all the text messages from the phone and there is no similar id and the error Logcat is no longer shown but The bug still remains and SMS messages cannot be restored only on Xiaomi phones."},{"owner":{"account_id":5404,"reputation":22100,"user_id":8681,"accept_rate":67,"display_name":"Jorn"},"score":1,"creation_date":1693836580,"post_id":77019630,"comment_id":135809061,"body_markdown":"When your &quot;app cannot restore text messages&quot;, what *exactly* happens? Crash, stacktrace, error messages, actual vs expected results...","body":"When your &quot;app cannot restore text messages&quot;, what <i>exactly</i> happens? Crash, stacktrace, error messages, actual vs expected results..."},{"owner":{"account_id":6964564,"reputation":1,"user_id":5343031,"display_name":"Shahin Sadeghi"},"score":0,"creation_date":1693858541,"post_id":77019630,"comment_id":135812556,"body_markdown":"Hi @Jorn it doesn&#39;t display any errors or Crash in logcat just show in the Verbose:\n 2023-09-05 00:38:47.088 9563-9563/com.backupeamoozesh3 D/Names&#160;are: _id\n2023-09-05 00:38:47.088 9563-9563/com.backupeamoozesh3 D/Names&#160;are: thread_id\n2023-09-05 00:38:47.088 9563-9563/com.backupeamoozesh3 D/Names&#160;are: address\n2023-09-05 00:38:47.089 9563-9563/com.backupeamoozesh3 D/Names&#160;are: mx_id_v2\n2023-09-05 00:38:47.120 9563-9563/com.backupeamoozesh3 I/Toast: Show toast from OpPackageName:com.backupeamoozesh3, PackageName:com.backupeamoozesh3","body":"Hi @Jorn it doesn&#39;t display any errors or Crash in logcat just show in the Verbose:  2023-09-05 00:38:47.088 9563-9563/com.backupeamoozesh3 D/Names are: _id 2023-09-05 00:38:47.088 9563-9563/com.backupeamoozesh3 D/Names are: thread_id 2023-09-05 00:38:47.088 9563-9563/com.backupeamoozesh3 D/Names are: address 2023-09-05 00:38:47.089 9563-9563/com.backupeamoozesh3 D/Names are: mx_id_v2 2023-09-05 00:38:47.120 9563-9563/com.backupeamoozesh3 I/Toast: Show toast from OpPackageName:com.backupeamoozesh3, PackageName:com.backupeamoozesh3"}],"answers":[{"tags":[],"owner":{"account_id":29293095,"reputation":840,"user_id":22443070,"display_name":"xPetersue"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694357969,"creation_date":1694357969,"answer_id":77076639,"question_id":77019630,"body_markdown":"I just noticed that the issue with duplicated IDs has been resolved. Well, the issue only persists on Xiaomi phones.\r\n\r\nTry to check the following possibilities.\r\n\r\n1. Make sure your app is compatible with Xiaomi&#39;s MIUI and that it has the necessary permissions to read and write SMS messages.\r\n2. Update Dependencies: Ensure that your app&#39;s dependencies, including any third-party libraries and the Android SDK, are up to date. Sometimes, issues can be caused by outdated libraries or SDK versions.\r\n\r\nIf the issue persists, consider alternative methods for SMS backup and restore on Xiaomi devices. Xiaomi&#39;s customizations may conflict with certain approaches. You could explore options like using Xiaomi&#39;s official backup and restore APIs if available.\r\n","title":"SMS backups cannot be restored on Xiaomi phones android","body":"<p>I just noticed that the issue with duplicated IDs has been resolved. Well, the issue only persists on Xiaomi phones.</p>\n<p>Try to check the following possibilities.</p>\n<ol>\n<li>Make sure your app is compatible with Xiaomi's MIUI and that it has the necessary permissions to read and write SMS messages.</li>\n<li>Update Dependencies: Ensure that your app's dependencies, including any third-party libraries and the Android SDK, are up to date. Sometimes, issues can be caused by outdated libraries or SDK versions.</li>\n</ol>\n<p>If the issue persists, consider alternative methods for SMS backup and restore on Xiaomi devices. Xiaomi's customizations may conflict with certain approaches. You could explore options like using Xiaomi's official backup and restore APIs if available.</p>\n"}],"owner":{"account_id":6964564,"reputation":1,"user_id":5343031,"display_name":"Shahin Sadeghi"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":208,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"answer_count":1,"score":-2,"last_activity_date":1694357969,"creation_date":1693521720,"question_id":77019630,"body_markdown":"I&#39;m making one sms backup and restore android app.&lt;br&gt;\r\nUnfortunately, my app cannot restore text messages on Xiaomi phones, including Redmi 3s with android 6, Redmi Note 11 with android 12, But in other phones, it performs SMS backup and restore operations very well.&lt;br&gt;\r\nHow can I solve this bug?&lt;br&gt;\r\nJava codes:&lt;br&gt;\r\n``` \r\npublic class SmsBackupActivity extends Activity {\r\n\r\n    private static final int DEF_SMS_REQ = 0;\r\n    Button btnBackup;\r\n    Button btnRestore;\r\n    AlertDialog dismiss;\r\n    SMSGettersSetters localSMSGettersSetters;\r\n    Cursor localCursor;\r\n    int i;\r\n    int j;\r\n    private static Context context;\r\n    ProgressDialog pDialog;\r\n    public List&lt;SMSGettersSetters&gt; smsBuffer = new ArrayList();\r\n    TextView tvLastBackup;\r\n    FileWriter write;\r\n    String[] xmlfile;\r\n    Uri localUri;\r\n\r\n    private void backupSMS() throws IOException {\r\n\r\n        this.smsBuffer.clear();\r\n        String str1 = getExternalFilesDir(null) + File.separator + &quot;sms&quot;;\r\n        this.write = new FileWriter(str1 + File.separator + this.xmlfile[0] + &quot;.xml&quot;);\r\n        localUri = Uri.parse(&quot;content://sms/&quot;);\r\n        ContentResolver localContentResolver = getContentResolver();\r\n        String[] arrayOfString1 = new String[8];\r\n        arrayOfString1[0] = &quot;_id&quot;;\r\n        arrayOfString1[1] = &quot;thread_id&quot;;\r\n        arrayOfString1[2] = &quot;address&quot;;\r\n        arrayOfString1[3] = &quot;person&quot;;\r\n        arrayOfString1[4] = &quot;date&quot;;\r\n        arrayOfString1[5] = &quot;body&quot;;\r\n        arrayOfString1[6] = &quot;type&quot;;\r\n        arrayOfString1[7] = &quot;read&quot;;\r\n        localCursor = localContentResolver.query(localUri, arrayOfString1, null, null, null);\r\n        String[] arrayOfString2 = new String[8];\r\n        arrayOfString2[0] = &quot;_id&quot;;\r\n        arrayOfString2[1] = &quot;thread_id&quot;;\r\n        arrayOfString2[2] = &quot;address&quot;;\r\n        arrayOfString2[3] = &quot;person&quot;;\r\n        arrayOfString2[4] = &quot;date&quot;;\r\n        arrayOfString2[5] = &quot;body&quot;;\r\n        arrayOfString2[6] = &quot;type&quot;;\r\n        arrayOfString2[7] = &quot;read&quot;;\r\n        localCursor.moveToFirst();\r\n        i = localCursor.getCount();\r\n        this.pDialog.setMax(i);\r\n        this.write.append(&quot;&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;&quot;);\r\n        this.write.append(&#39;\\n&#39;);\r\n        this.write.append(&quot;&lt;smsall&gt;&quot;);\r\n        this.write.append(&#39;\\n&#39;);\r\n\r\n        while (true) {\r\n            localSMSGettersSetters = new SMSGettersSetters();\r\n            @SuppressLint(&quot;Range&quot;) String str2 = localCursor.getString(localCursor.getColumnIndex(&quot;_id&quot;));\r\n            @SuppressLint(&quot;Range&quot;) String str3 = localCursor.getString(localCursor.getColumnIndex(&quot;thread_id&quot;));\r\n            @SuppressLint(&quot;Range&quot;) String str4 = localCursor.getString(localCursor.getColumnIndex(&quot;address&quot;));\r\n            @SuppressLint(&quot;Range&quot;) String str5 = localCursor.getString(localCursor.getColumnIndex(&quot;person&quot;));\r\n            @SuppressLint(&quot;Range&quot;) String str6 = localCursor.getString(localCursor.getColumnIndex(&quot;date&quot;));\r\n            @SuppressLint(&quot;Range&quot;) String str7 = localCursor.getString(localCursor.getColumnIndex(&quot;body&quot;)).replaceAll(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).replaceAll(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).replaceAll(&quot;&gt;&quot;, &quot;&amp;gt;&quot;).replaceAll(&quot;\\&quot;&quot;, &quot;&amp;quot;&quot;).replaceAll(&quot;&gt;&quot;, &quot;&amp;apos;&quot;).replaceAll(&quot;&#39;&quot;, &quot;&amp;frasl;&quot;);\r\n            @SuppressLint(&quot;Range&quot;) String str8 = localCursor.getString(localCursor.getColumnIndex(&quot;type&quot;));\r\n            @SuppressLint(&quot;Range&quot;) String str9 = localCursor.getString(localCursor.getColumnIndex(&quot;read&quot;));\r\n            localSMSGettersSetters.setId(str2);\r\n            localSMSGettersSetters.setThreadId(str3);\r\n            localSMSGettersSetters.setAddres(str4);\r\n            localSMSGettersSetters.setPerson(str5);\r\n            localSMSGettersSetters.setDate(str6);\r\n            localSMSGettersSetters.setBody(str7);\r\n            localSMSGettersSetters.setType(str8);\r\n            localSMSGettersSetters.setRead(str9);\r\n            localSMSGettersSetters.setSentDate(str1);\r\n            this.smsBuffer.add(localSMSGettersSetters);\r\n\r\n            Handler localHandler = new Handler(Looper.getMainLooper());\r\n            localHandler.post(new Runnable() {\r\n                @Override\r\n                public void run() {\r\n                    final int m = j;\r\n                    SmsBackupActivity.this.pDialog.setProgress(1 + m);\r\n                    i++;\r\n                    int v = -1 + i;\r\n\r\n                    if (m == v) {\r\n\r\n                        Log.d(&quot;dismiss&quot;, &quot;is called&quot;);\r\n                        SmsBackupActivity.this.pDialog.dismiss();\r\n                        SmsBackupActivity.this.setBackupDate();\r\n                    }\r\n                    i--;\r\n                    return;\r\n                }\r\n            });\r\n            generateXMLFileForSMS(localSMSGettersSetters);\r\n            localCursor.moveToNext();\r\n            j++;\r\n\r\n            if (j == i) {\r\n                this.write.append(&quot;&lt;/smsall&gt;&quot;);\r\n                this.write.flush();\r\n                this.write.close();\r\n                pDialog.dismiss();\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    private void generateXMLFileForSMS(SMSGettersSetters paramSMSGettersSetters) {\r\n        try {\r\n            this.write.append(&quot;&lt;sms&gt;&quot;);\r\n            this.write.append(&#39;\\n&#39;);\r\n            this.write.append(&quot;&lt;id&gt;&quot; + paramSMSGettersSetters.getId() + &quot;&lt;/id&gt;&quot;);\r\n            this.write.append(&#39;\\n&#39;);\r\n            this.write.append(&quot;&lt;threadId&gt;&quot; + paramSMSGettersSetters.getThreadId() + &quot;&lt;/threadId&gt;&quot;);\r\n            this.write.append(&#39;\\n&#39;);\r\n            this.write.append(&quot;&lt;address&gt;&quot; + paramSMSGettersSetters.getAddress() + &quot;&lt;/address&gt;&quot;);\r\n            this.write.append(&#39;\\n&#39;);\r\n            this.write.append(&quot;&lt;person&gt;&quot; + paramSMSGettersSetters.getPerson() + &quot;&lt;/person&gt;&quot;);\r\n            this.write.append(&#39;\\n&#39;);\r\n            this.write.append(&quot;&lt;date&gt;&quot; + paramSMSGettersSetters.getDate() + &quot;&lt;/date&gt;&quot;);\r\n            this.write.append(&#39;\\n&#39;);\r\n            this.write.append(&quot;&lt;body&gt;&quot; + paramSMSGettersSetters.getBody() + &quot;&lt;/body&gt;&quot;);\r\n            this.write.append(&#39;\\n&#39;);\r\n            this.write.append(&quot;&lt;type&gt;&quot; + paramSMSGettersSetters.getType() + &quot;&lt;/type&gt;&quot;);\r\n            this.write.append(&#39;\\n&#39;);\r\n            this.write.append(&quot;&lt;read&gt;&quot; + paramSMSGettersSetters.getRead() + &quot;&lt;/read&gt;&quot;);\r\n            this.write.append(&#39;\\n&#39;);\r\n            this.write.append(&quot;&lt;/sms&gt;&quot;);\r\n            this.write.append(&#39;\\n&#39;);\r\n            return;\r\n        } catch (NullPointerException localNullPointerException) {\r\n            while (true)\r\n                System.out.println(&quot;Nullpointer Exception &quot; + localNullPointerException);\r\n        } catch (IOException localIOException) {\r\n            while (true)\r\n                localIOException.printStackTrace();\r\n        } catch (Exception localException) {\r\n            while (true)\r\n                localException.printStackTrace();\r\n        }\r\n    }\r\n\r\n    private void launchComponent(String paramString1, String paramString2) {\r\n        Intent localIntent = new Intent(&quot;android.intent.action.MAIN&quot;);\r\n        localIntent.addCategory(&quot;android.intent.category.LAUNCHER&quot;);\r\n        localIntent.setComponent(new ComponentName(paramString1, paramString2));\r\n        startActivity(localIntent);\r\n    }\r\n\r\n    public void BackupAlert() {\r\n        AlertDialog.Builder localBuilder = new AlertDialog.Builder(this);\r\n        View localView = getLayoutInflater().inflate(R.layout.layout_backup_dialog, null);\r\n        final EditText localEditText = (EditText) localView.findViewById(R.id.etFileName);\r\n        CharSequence localCharSequence = DateFormat.format(&quot;yyMMddhhmmss&quot;, new Date().getTime());\r\n        localEditText.setText(&quot;sms_&quot; + localCharSequence + &quot;.xml&quot;);\r\n        localBuilder.setView(localView);\r\n        localBuilder.setPositiveButton(&quot;ok&quot;, new OnClickListener() {\r\n            @Override\r\n            public void onClick(DialogInterface paramAnonymousDialogInterface, int paramAnonymousInt) {\r\n                SmsBackupActivity.this.xmlfile = localEditText.getText().toString().trim().split(&quot;.xml&quot;);\r\n                SmsBackupActivity.this.setProgressDialog();\r\n                new Thread(new Runnable() {\r\n                    @Override\r\n                    public void run() {\r\n                        try {\r\n                            Looper.prepare();\r\n                            SmsBackupActivity.this.backupSMS();\r\n                            Looper.loop();\r\n                        } catch (IOException e) {\r\n                            // TODO Auto-generated catch block\r\n                            e.printStackTrace();\r\n                        }\r\n                    }\r\n                }).start();\r\n            }\r\n        });\r\n        localBuilder.setNegativeButton(&quot;cancel&quot;, null);\r\n        AlertDialog localAlertDialog = localBuilder.create();\r\n        localAlertDialog.getWindow().getAttributes().windowAnimations = R.style.PauseDialogAnimation;\r\n        localAlertDialog.show();\r\n    }\r\n\r\n\r\n    public String getBackupDate(String paramString) {\r\n        return getSharedPreferences(&quot;BackupPrefs&quot;, 0).getString(paramString, getString(R.string.never_backup));\r\n    }\r\n\r\n    public int getSMSCount() {\r\n        Cursor localCursor = getContentResolver().query(Uri.parse(&quot;content://sms/&quot;), null, null, null, null);\r\n        String[] arrayOfString = localCursor.getColumnNames();\r\n        for (int i = 0; ; i++) {\r\n            if (i &gt;= arrayOfString.length)\r\n                return localCursor.getCount();\r\n            Log.d(&quot;Names are&quot;, arrayOfString[i]);\r\n        }\r\n    }\r\n\r\n    public List&lt;FileGetterSetters&gt; getSMSFiles() {\r\n        ArrayList localArrayList = new ArrayList();\r\n        File[] arrayOfFile = new File(getExternalFilesDir(null) + File.separator + &quot;sms&quot;).listFiles();\r\n        int i = arrayOfFile.length;\r\n        for (int j = 0; ; j++) {\r\n            if (j &gt;= i)\r\n                return localArrayList;\r\n            File localFile = arrayOfFile[j];\r\n            FileGetterSetters localFileGetterSetters = new FileGetterSetters();\r\n            Log.d(&quot;file Name is&quot;, localFile.getName());\r\n            localFileGetterSetters.setFileName(localFile.getName());\r\n            Date localDate = new Date(localFile.lastModified());\r\n            Log.d(&quot;Modified date is&quot;, localDate.toString());\r\n            localFileGetterSetters.setDateCreated(localDate.toString());\r\n            localArrayList.add(localFileGetterSetters);\r\n        }\r\n    }\r\n\r\n    public String getXML(String paramString) {\r\n        Log.d(&quot;File path is&quot;, paramString);\r\n        File localFile = new File(paramString);\r\n        StringBuilder localStringBuilder = new StringBuilder();\r\n        try {\r\n            BufferedReader localBufferedReader = new BufferedReader(new InputStreamReader(new FileInputStream(localFile)));\r\n            while (true) {\r\n                String str = localBufferedReader.readLine();\r\n                if (str == null)\r\n                    return localStringBuilder.toString();\r\n                localStringBuilder.append(str);\r\n                localStringBuilder.append(&#39;\\n&#39;);\r\n            }\r\n        } catch (IOException localIOException) {\r\n\r\n        }\r\n        return paramString;\r\n    }\r\n\r\n    public void initAllViews() {\r\n        this.btnBackup = ((Button) findViewById(R.id.btnBackup));\r\n        this.btnRestore = ((Button) findViewById(R.id.btnRestore));\r\n        TextView localTextView1 = (TextView) findViewById(R.id.tvSMS);\r\n        this.tvLastBackup = ((TextView) findViewById(R.id.tvLastBackup));\r\n\r\n        btnBackup.setOnClickListener(new View.OnClickListener() {\r\n\r\n            @Override\r\n            public void onClick(View v) {\r\n                // TODO Auto-generated method stub\r\n                if (getSMSCount() &gt; 0) {\r\n                    SmsBackupActivity.this.BackupAlert();\r\n                } else {\r\n                    Toast.makeText(getApplicationContext(), &quot;SMS not found&quot;, Toast.LENGTH_SHORT).show();\r\n                }\r\n\r\n            }\r\n        });\r\n        btnRestore.setOnClickListener(new View.OnClickListener() {\r\n\r\n            @SuppressLint(&quot;NewApi&quot;)\r\n            @Override\r\n            public void onClick(View v) {\r\n                // TODO Auto-generated method stub\r\n\r\n                if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.Q) {\r\n                    RoleManager roleManager = (RoleManager) getSystemService(Context.ROLE_SERVICE);\r\n                    if (roleManager != null &amp;&amp; !roleManager.isRoleHeld(ROLE_SMS)) {\r\n                        SmsReceiver.enable(SmsBackupActivity.this);\r\n                        Intent intent = roleManager.createRequestRoleIntent(ROLE_SMS);\r\n                        startActivityForResult(intent, DEF_SMS_REQ);\r\n                    }\r\n                    else {\r\n                        SmsBackupActivity.this.restoreBackupFilesDialog(true);\r\n                    }\r\n                } else {\r\n                    if (!Telephony.Sms.getDefaultSmsPackage(getApplicationContext()).equals(getPackageName()))\r\n                    {\r\n                        Intent intent = new Intent(Telephony.Sms.Intents.ACTION_CHANGE_DEFAULT);\r\n                        intent.putExtra(Telephony.Sms.Intents.EXTRA_PACKAGE_NAME,getPackageName());\r\n                        startActivityForResult(intent, DEF_SMS_REQ);\r\n                    }\r\n                    else\r\n                    {\r\n                        SmsBackupActivity.this.restoreBackupFilesDialog(true);\r\n                    }\r\n                }\r\n\r\n            }\r\n        });\r\n\r\n        localTextView1.setText(Html.fromHtml(&quot;&lt;font color=&#39;#FFFFFF&#39;&gt;SMS:&lt;/font&gt;&quot; + getSMSCount()));\r\n        this.tvLastBackup.setText(Html.fromHtml(&quot;&lt;font color=&#39;#FFFFFF&#39;&gt;&quot; + getString(R.string.last_backup) + &quot;:&lt;/font&gt;&quot; + getBackupDate(&quot;smsBackupDate&quot;)));\r\n    }\r\n\r\n    public void okDialog() {\r\n        AlertDialog localAlertDialog = new AlertDialog.Builder(this).create();\r\n\r\n        localAlertDialog.setMessage(getString(R.string.deleted_successfully_));\r\n        localAlertDialog.setButton(&quot;ok&quot;, new OnClickListener() {\r\n            @Override\r\n            public void onClick(DialogInterface paramAnonymousDialogInterface, int paramAnonymousInt) {\r\n            }\r\n        });\r\n        localAlertDialog.show();\r\n    }\r\n\r\n    @Override\r\n    protected void onCreate(Bundle paramBundle) {\r\n        super.onCreate(paramBundle);\r\n        setContentView(R.layout.layout_sms_backupt);\r\n        SmsBackupActivity.context = getApplicationContext();\r\n        initAllViews();\r\n    }\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\r\n        switch (requestCode) {\r\n            case DEF_SMS_REQ:\r\n                if (Build.VERSION.SDK_INT == Build.VERSION_CODES.KITKAT &amp;&amp; isDefaultSmsApp(this) ||\r\n                        Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.BASE &amp;&amp; resultCode == Activity.RESULT_OK) {\r\n                    SmsBackupActivity.this.restoreBackupFilesDialog(true);\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    @TargetApi(Build.VERSION_CODES.KITKAT)\r\n    public static boolean isDefaultSmsApp(Context context) {\r\n        return context.getPackageName().equals(getDefaultSmsPackage(context));\r\n    }\r\n\r\n    public void openInbox() {\r\n        try {\r\n            Intent localIntent = new Intent(&quot;android.intent.action.MAIN&quot;);\r\n            localIntent.addCategory(&quot;android.intent.category.LAUNCHER&quot;);\r\n            Iterator localIterator = getPackageManager().queryIntentActivities(localIntent, 0).iterator();\r\n            while (localIterator.hasNext()) {\r\n                ResolveInfo localResolveInfo = (ResolveInfo) localIterator.next();\r\n                if (localResolveInfo.activityInfo.packageName.equalsIgnoreCase(&quot;com.android.mms&quot;))\r\n                    launchComponent(localResolveInfo.activityInfo.packageName, localResolveInfo.activityInfo.name);\r\n            }\r\n        } catch (ActivityNotFoundException localActivityNotFoundException) {\r\n        }\r\n    }\r\n\r\n    @SuppressLint(&quot;NewApi&quot;)\r\n    public void restoreBackup(HashMap&lt;String, String&gt; paramHashMap) {\r\n        ContentValues localContentValues = new ContentValues();\r\n        localContentValues.put(&quot;address&quot;, paramHashMap.get(&quot;address&quot;));\r\n        localContentValues.put(&quot;person&quot;, paramHashMap.get(&quot;person&quot;));\r\n        localContentValues.put(&quot;date&quot;, paramHashMap.get(&quot;date&quot;));\r\n        localContentValues.put(&quot;body&quot;, paramHashMap.get(&quot;body&quot;));\r\n        localContentValues.put(&quot;_id&quot;, paramHashMap.get(&quot;id&quot;));\r\n        localContentValues.put(&quot;type&quot;, paramHashMap.get(&quot;type&quot;));\r\n        localContentValues.put(&quot;read&quot;, paramHashMap.get(&quot;read&quot;));\r\n\r\n        try {\r\n            if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.BASE) {\r\n                getContentResolver().insert(Telephony.Sms.CONTENT_URI, localContentValues);\r\n            } else {\r\n                getContentResolver().insert(Uri.parse(&quot;content://sms/&quot;), localContentValues);\r\n            }\r\n        }catch (Exception e){\r\n\r\n        }\r\n\r\n    }\r\n\r\n    public void restoreBackupFilesDialog(final boolean paramBoolean) {\r\n        AlertDialog.Builder localBuilder = new AlertDialog.Builder(this);\r\n        localBuilder.setTitle(R.string.backup_files);\r\n        ListView localListView = new ListView(this);\r\n        final List localList = getSMSFiles();\r\n        localListView.setAdapter(new FileAdapter(this, R.layout.item_row_file, localList));\r\n        localListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {\r\n            @Override\r\n            public void onItemClick(AdapterView&lt;?&gt; paramAnonymousAdapterView, View paramAnonymousView, int paramAnonymousInt, long paramAnonymousLong) {\r\n                SmsBackupActivity.this.dismiss.dismiss();\r\n                if (paramBoolean) {\r\n                    String str = getExternalFilesDir(null) + File.separator + &quot;sms&quot; + File.separator + ((FileGetterSetters) localList.get(paramAnonymousInt)).getFileName();\r\n                    Log.d(&quot;Seleted file path is&quot;, str);\r\n                    RestoringTask localRestoringTask = new RestoringTask(SmsBackupActivity.this);\r\n                    String[] arrayOfString = new String[1];\r\n                    arrayOfString[0] = str;\r\n                    localRestoringTask.execute(arrayOfString);\r\n                }\r\n            }\r\n        });\r\n        localBuilder.setView(localListView);\r\n        localBuilder.setNegativeButton(&quot;cancel&quot;, null);\r\n        AlertDialog localAlertDialog = localBuilder.create();\r\n        localAlertDialog.getWindow().getAttributes().alpha = 0.6F;\r\n        localAlertDialog.getWindow().getAttributes().windowAnimations = R.style.FileDialogAnimation;\r\n        this.dismiss = localAlertDialog;\r\n        localAlertDialog.show();\r\n    }\r\n\r\n\r\n    public void setBackupDate() {\r\n        CharSequence localCharSequence = DateFormat.format(&quot;yy/MM/dd hh:mm:ss&quot;, new Date().getTime());\r\n        this.tvLastBackup.setText(Html.fromHtml(&quot;&lt;font color=&#39;#FFFFFF&#39;&gt;&quot; + getString(R.string.last_backup) + &quot;:&lt;/font&gt;&quot; + localCharSequence.toString()));\r\n        setLastBackupDate(&quot;smsBackupDate&quot;, localCharSequence.toString());\r\n    }\r\n\r\n\r\n    public void setLastBackupDate(String paramString1, String paramString2) {\r\n        SharedPreferences.Editor localEditor = getSharedPreferences(&quot;BackupPrefs&quot;, 0).edit();\r\n        localEditor.putString(paramString1, paramString2);\r\n        localEditor.commit();\r\n    }\r\n\r\n    public void setProgressDialog() {\r\n        this.pDialog = new ProgressDialog(this);\r\n        this.pDialog.setMessage(getString(R.string.backuping_files_please_wait_));\r\n        this.pDialog.setIndeterminate(false);\r\n        this.pDialog.setProgressDrawable(getResources().getDrawable(R.drawable.greenprogress));\r\n        this.pDialog.setMax(100);\r\n        this.pDialog.setProgressStyle(1);\r\n        this.pDialog.setCancelable(true);\r\n        this.pDialog.show();\r\n    }\r\n\r\n\r\n    public void viewMessagesDialog() {\r\n        AlertDialog.Builder localBuilder = new AlertDialog.Builder(this);\r\n\r\n        localBuilder.setMessage(getString(R.string.restore_completed_successfully_));\r\n        localBuilder.setPositiveButton(getString(R.string.view_messages), new OnClickListener() {\r\n            @Override\r\n            public void onClick(DialogInterface paramAnonymousDialogInterface, int paramAnonymousInt) {\r\n                SmsBackupActivity.this.openInbox();\r\n            }\r\n        });\r\n        localBuilder.setNegativeButton(&quot;cancel&quot;, null);\r\n        AlertDialog localAlertDialog = localBuilder.create();\r\n        localAlertDialog.getWindow().getAttributes().windowAnimations = R.style.PauseDialogAnimation;\r\n        localAlertDialog.show();\r\n    }\r\n\r\n    public class RestoringTask extends AsyncTask&lt;String, Integer, String&gt; {\r\n\r\n        ProgressDialog pd = new ProgressDialog(SmsBackupActivity.this);\r\n        Integer[] arrayOfInteger;\r\n\r\n        public RestoringTask(SmsBackupActivity smsBackupActivity) {\r\n        }\r\n\r\n        @Override\r\n        @SuppressWarnings(&quot;unchecked&quot;)\r\n        protected String doInBackground(String[] paramArrayOfString) {\r\n            String str = SmsBackupActivity.this.getXML(paramArrayOfString[0]);\r\n            XMLParser localXMLParser = new XMLParser();\r\n\r\n            NodeList localNodeList = localXMLParser.getDomElement(str).getElementsByTagName(&quot;sms&quot;);\r\n            int i = localNodeList.getLength();\r\n            for (int j = 0; ; j++) {\r\n                if (j &gt;= i)\r\n                    return &quot;&quot;;\r\n                @SuppressWarnings(&quot;rawtypes&quot;)\r\n                HashMap localHashMap = new HashMap();\r\n                Element localElement = (Element) localNodeList.item(j);\r\n                localHashMap.put(&quot;id&quot;, localXMLParser.getValue(localElement, &quot;id&quot;));\r\n                localHashMap.put(&quot;threadId&quot;, localXMLParser.getValue(localElement, &quot;threadId&quot;));\r\n                localHashMap.put(&quot;address&quot;, localXMLParser.getValue(localElement, &quot;address&quot;));\r\n                localHashMap.put(&quot;person&quot;, localXMLParser.getValue(localElement, &quot;person&quot;));\r\n                localHashMap.put(&quot;date&quot;, localXMLParser.getValue(localElement, &quot;date&quot;));\r\n                localHashMap.put(&quot;body&quot;, localXMLParser.getValue(localElement, &quot;body&quot;));\r\n                localHashMap.put(&quot;type&quot;, localXMLParser.getValue(localElement, &quot;type&quot;));\r\n                localHashMap.put(&quot;read&quot;, localXMLParser.getValue(localElement, &quot;read&quot;));\r\n\r\n                SmsBackupActivity.this.restoreBackup(localHashMap);\r\n                Integer[] arrayOfInteger = new Integer[2];\r\n                arrayOfInteger[0] = Integer.valueOf(i);\r\n                arrayOfInteger[1] = Integer.valueOf(j);\r\n                publishProgress(arrayOfInteger);\r\n            }\r\n\r\n        }\r\n\r\n        @Override\r\n        @SuppressLint(&quot;InlinedApi&quot;)\r\n        protected void onPostExecute(String paramString) {\r\n            super.onPostExecute(paramString);\r\n            ((TextView) SmsBackupActivity.this.findViewById(R.id.tvSMS)).setText(Html.fromHtml(&quot;&lt;font color=&#39;#FFFFFF&#39;&gt;SMS:&lt;/font&gt;&quot; + SmsBackupActivity.this.getSMSCount()));\r\n            this.pd.dismiss();\r\n            if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {\r\n                Toast.makeText(getApplicationContext(), &quot;Restored successfully&quot;, Toast.LENGTH_SHORT).show();\r\n            } else {\r\n                SmsBackupActivity.this.viewMessagesDialog();\r\n            }\r\n\r\n        }\r\n\r\n        @Override\r\n        protected void onPreExecute() {\r\n            super.onPreExecute();\r\n            this.pd.setProgressStyle(1);\r\n            this.pd.setMessage(SmsBackupActivity.this.getString(R.string.restoring_backups_));\r\n            this.pd.setProgressDrawable(SmsBackupActivity.this.getResources().getDrawable(R.drawable.greenprogress));\r\n            this.pd.show();\r\n        }\r\n\r\n        @Override\r\n        protected void onProgressUpdate(Integer[] paramArrayOfInteger) {\r\n            this.pd.setMax(paramArrayOfInteger[0].intValue());\r\n            this.pd.setProgress(paramArrayOfInteger[1].intValue());\r\n            super.onProgressUpdate(paramArrayOfInteger);\r\n        }\r\n    }\r\n}\r\n ```\r\nAlso, in my MainActivity file, I&#39;ve taken Manifest.permission.READ_SMS permission.&lt;br&gt;\r\n**Update**: I deleted all the text messages from the phone and there is no similar id and the error Logcat is no longer shown but The bug still remains and SMS messages cannot be restored only on Xiaomi phones.","title":"SMS backups cannot be restored on Xiaomi phones android","body":"<p>I'm making one sms backup and restore android app.<br>\nUnfortunately, my app cannot restore text messages on Xiaomi phones, including Redmi 3s with android 6, Redmi Note 11 with android 12, But in other phones, it performs SMS backup and restore operations very well.<br>\nHow can I solve this bug?<br>\nJava codes:<br></p>\n<pre><code>public class SmsBackupActivity extends Activity {\n\n    private static final int DEF_SMS_REQ = 0;\n    Button btnBackup;\n    Button btnRestore;\n    AlertDialog dismiss;\n    SMSGettersSetters localSMSGettersSetters;\n    Cursor localCursor;\n    int i;\n    int j;\n    private static Context context;\n    ProgressDialog pDialog;\n    public List&lt;SMSGettersSetters&gt; smsBuffer = new ArrayList();\n    TextView tvLastBackup;\n    FileWriter write;\n    String[] xmlfile;\n    Uri localUri;\n\n    private void backupSMS() throws IOException {\n\n        this.smsBuffer.clear();\n        String str1 = getExternalFilesDir(null) + File.separator + &quot;sms&quot;;\n        this.write = new FileWriter(str1 + File.separator + this.xmlfile[0] + &quot;.xml&quot;);\n        localUri = Uri.parse(&quot;content://sms/&quot;);\n        ContentResolver localContentResolver = getContentResolver();\n        String[] arrayOfString1 = new String[8];\n        arrayOfString1[0] = &quot;_id&quot;;\n        arrayOfString1[1] = &quot;thread_id&quot;;\n        arrayOfString1[2] = &quot;address&quot;;\n        arrayOfString1[3] = &quot;person&quot;;\n        arrayOfString1[4] = &quot;date&quot;;\n        arrayOfString1[5] = &quot;body&quot;;\n        arrayOfString1[6] = &quot;type&quot;;\n        arrayOfString1[7] = &quot;read&quot;;\n        localCursor = localContentResolver.query(localUri, arrayOfString1, null, null, null);\n        String[] arrayOfString2 = new String[8];\n        arrayOfString2[0] = &quot;_id&quot;;\n        arrayOfString2[1] = &quot;thread_id&quot;;\n        arrayOfString2[2] = &quot;address&quot;;\n        arrayOfString2[3] = &quot;person&quot;;\n        arrayOfString2[4] = &quot;date&quot;;\n        arrayOfString2[5] = &quot;body&quot;;\n        arrayOfString2[6] = &quot;type&quot;;\n        arrayOfString2[7] = &quot;read&quot;;\n        localCursor.moveToFirst();\n        i = localCursor.getCount();\n        this.pDialog.setMax(i);\n        this.write.append(&quot;&lt;?xml version='1.0' encoding='UTF-8'?&gt;&quot;);\n        this.write.append('\\n');\n        this.write.append(&quot;&lt;smsall&gt;&quot;);\n        this.write.append('\\n');\n\n        while (true) {\n            localSMSGettersSetters = new SMSGettersSetters();\n            @SuppressLint(&quot;Range&quot;) String str2 = localCursor.getString(localCursor.getColumnIndex(&quot;_id&quot;));\n            @SuppressLint(&quot;Range&quot;) String str3 = localCursor.getString(localCursor.getColumnIndex(&quot;thread_id&quot;));\n            @SuppressLint(&quot;Range&quot;) String str4 = localCursor.getString(localCursor.getColumnIndex(&quot;address&quot;));\n            @SuppressLint(&quot;Range&quot;) String str5 = localCursor.getString(localCursor.getColumnIndex(&quot;person&quot;));\n            @SuppressLint(&quot;Range&quot;) String str6 = localCursor.getString(localCursor.getColumnIndex(&quot;date&quot;));\n            @SuppressLint(&quot;Range&quot;) String str7 = localCursor.getString(localCursor.getColumnIndex(&quot;body&quot;)).replaceAll(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).replaceAll(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).replaceAll(&quot;&gt;&quot;, &quot;&amp;gt;&quot;).replaceAll(&quot;\\&quot;&quot;, &quot;&amp;quot;&quot;).replaceAll(&quot;&gt;&quot;, &quot;&amp;apos;&quot;).replaceAll(&quot;'&quot;, &quot;&amp;frasl;&quot;);\n            @SuppressLint(&quot;Range&quot;) String str8 = localCursor.getString(localCursor.getColumnIndex(&quot;type&quot;));\n            @SuppressLint(&quot;Range&quot;) String str9 = localCursor.getString(localCursor.getColumnIndex(&quot;read&quot;));\n            localSMSGettersSetters.setId(str2);\n            localSMSGettersSetters.setThreadId(str3);\n            localSMSGettersSetters.setAddres(str4);\n            localSMSGettersSetters.setPerson(str5);\n            localSMSGettersSetters.setDate(str6);\n            localSMSGettersSetters.setBody(str7);\n            localSMSGettersSetters.setType(str8);\n            localSMSGettersSetters.setRead(str9);\n            localSMSGettersSetters.setSentDate(str1);\n            this.smsBuffer.add(localSMSGettersSetters);\n\n            Handler localHandler = new Handler(Looper.getMainLooper());\n            localHandler.post(new Runnable() {\n                @Override\n                public void run() {\n                    final int m = j;\n                    SmsBackupActivity.this.pDialog.setProgress(1 + m);\n                    i++;\n                    int v = -1 + i;\n\n                    if (m == v) {\n\n                        Log.d(&quot;dismiss&quot;, &quot;is called&quot;);\n                        SmsBackupActivity.this.pDialog.dismiss();\n                        SmsBackupActivity.this.setBackupDate();\n                    }\n                    i--;\n                    return;\n                }\n            });\n            generateXMLFileForSMS(localSMSGettersSetters);\n            localCursor.moveToNext();\n            j++;\n\n            if (j == i) {\n                this.write.append(&quot;&lt;/smsall&gt;&quot;);\n                this.write.flush();\n                this.write.close();\n                pDialog.dismiss();\n                return;\n            }\n        }\n    }\n\n    private void generateXMLFileForSMS(SMSGettersSetters paramSMSGettersSetters) {\n        try {\n            this.write.append(&quot;&lt;sms&gt;&quot;);\n            this.write.append('\\n');\n            this.write.append(&quot;&lt;id&gt;&quot; + paramSMSGettersSetters.getId() + &quot;&lt;/id&gt;&quot;);\n            this.write.append('\\n');\n            this.write.append(&quot;&lt;threadId&gt;&quot; + paramSMSGettersSetters.getThreadId() + &quot;&lt;/threadId&gt;&quot;);\n            this.write.append('\\n');\n            this.write.append(&quot;&lt;address&gt;&quot; + paramSMSGettersSetters.getAddress() + &quot;&lt;/address&gt;&quot;);\n            this.write.append('\\n');\n            this.write.append(&quot;&lt;person&gt;&quot; + paramSMSGettersSetters.getPerson() + &quot;&lt;/person&gt;&quot;);\n            this.write.append('\\n');\n            this.write.append(&quot;&lt;date&gt;&quot; + paramSMSGettersSetters.getDate() + &quot;&lt;/date&gt;&quot;);\n            this.write.append('\\n');\n            this.write.append(&quot;&lt;body&gt;&quot; + paramSMSGettersSetters.getBody() + &quot;&lt;/body&gt;&quot;);\n            this.write.append('\\n');\n            this.write.append(&quot;&lt;type&gt;&quot; + paramSMSGettersSetters.getType() + &quot;&lt;/type&gt;&quot;);\n            this.write.append('\\n');\n            this.write.append(&quot;&lt;read&gt;&quot; + paramSMSGettersSetters.getRead() + &quot;&lt;/read&gt;&quot;);\n            this.write.append('\\n');\n            this.write.append(&quot;&lt;/sms&gt;&quot;);\n            this.write.append('\\n');\n            return;\n        } catch (NullPointerException localNullPointerException) {\n            while (true)\n                System.out.println(&quot;Nullpointer Exception &quot; + localNullPointerException);\n        } catch (IOException localIOException) {\n            while (true)\n                localIOException.printStackTrace();\n        } catch (Exception localException) {\n            while (true)\n                localException.printStackTrace();\n        }\n    }\n\n    private void launchComponent(String paramString1, String paramString2) {\n        Intent localIntent = new Intent(&quot;android.intent.action.MAIN&quot;);\n        localIntent.addCategory(&quot;android.intent.category.LAUNCHER&quot;);\n        localIntent.setComponent(new ComponentName(paramString1, paramString2));\n        startActivity(localIntent);\n    }\n\n    public void BackupAlert() {\n        AlertDialog.Builder localBuilder = new AlertDialog.Builder(this);\n        View localView = getLayoutInflater().inflate(R.layout.layout_backup_dialog, null);\n        final EditText localEditText = (EditText) localView.findViewById(R.id.etFileName);\n        CharSequence localCharSequence = DateFormat.format(&quot;yyMMddhhmmss&quot;, new Date().getTime());\n        localEditText.setText(&quot;sms_&quot; + localCharSequence + &quot;.xml&quot;);\n        localBuilder.setView(localView);\n        localBuilder.setPositiveButton(&quot;ok&quot;, new OnClickListener() {\n            @Override\n            public void onClick(DialogInterface paramAnonymousDialogInterface, int paramAnonymousInt) {\n                SmsBackupActivity.this.xmlfile = localEditText.getText().toString().trim().split(&quot;.xml&quot;);\n                SmsBackupActivity.this.setProgressDialog();\n                new Thread(new Runnable() {\n                    @Override\n                    public void run() {\n                        try {\n                            Looper.prepare();\n                            SmsBackupActivity.this.backupSMS();\n                            Looper.loop();\n                        } catch (IOException e) {\n                            // TODO Auto-generated catch block\n                            e.printStackTrace();\n                        }\n                    }\n                }).start();\n            }\n        });\n        localBuilder.setNegativeButton(&quot;cancel&quot;, null);\n        AlertDialog localAlertDialog = localBuilder.create();\n        localAlertDialog.getWindow().getAttributes().windowAnimations = R.style.PauseDialogAnimation;\n        localAlertDialog.show();\n    }\n\n\n    public String getBackupDate(String paramString) {\n        return getSharedPreferences(&quot;BackupPrefs&quot;, 0).getString(paramString, getString(R.string.never_backup));\n    }\n\n    public int getSMSCount() {\n        Cursor localCursor = getContentResolver().query(Uri.parse(&quot;content://sms/&quot;), null, null, null, null);\n        String[] arrayOfString = localCursor.getColumnNames();\n        for (int i = 0; ; i++) {\n            if (i &gt;= arrayOfString.length)\n                return localCursor.getCount();\n            Log.d(&quot;Names are&quot;, arrayOfString[i]);\n        }\n    }\n\n    public List&lt;FileGetterSetters&gt; getSMSFiles() {\n        ArrayList localArrayList = new ArrayList();\n        File[] arrayOfFile = new File(getExternalFilesDir(null) + File.separator + &quot;sms&quot;).listFiles();\n        int i = arrayOfFile.length;\n        for (int j = 0; ; j++) {\n            if (j &gt;= i)\n                return localArrayList;\n            File localFile = arrayOfFile[j];\n            FileGetterSetters localFileGetterSetters = new FileGetterSetters();\n            Log.d(&quot;file Name is&quot;, localFile.getName());\n            localFileGetterSetters.setFileName(localFile.getName());\n            Date localDate = new Date(localFile.lastModified());\n            Log.d(&quot;Modified date is&quot;, localDate.toString());\n            localFileGetterSetters.setDateCreated(localDate.toString());\n            localArrayList.add(localFileGetterSetters);\n        }\n    }\n\n    public String getXML(String paramString) {\n        Log.d(&quot;File path is&quot;, paramString);\n        File localFile = new File(paramString);\n        StringBuilder localStringBuilder = new StringBuilder();\n        try {\n            BufferedReader localBufferedReader = new BufferedReader(new InputStreamReader(new FileInputStream(localFile)));\n            while (true) {\n                String str = localBufferedReader.readLine();\n                if (str == null)\n                    return localStringBuilder.toString();\n                localStringBuilder.append(str);\n                localStringBuilder.append('\\n');\n            }\n        } catch (IOException localIOException) {\n\n        }\n        return paramString;\n    }\n\n    public void initAllViews() {\n        this.btnBackup = ((Button) findViewById(R.id.btnBackup));\n        this.btnRestore = ((Button) findViewById(R.id.btnRestore));\n        TextView localTextView1 = (TextView) findViewById(R.id.tvSMS);\n        this.tvLastBackup = ((TextView) findViewById(R.id.tvLastBackup));\n\n        btnBackup.setOnClickListener(new View.OnClickListener() {\n\n            @Override\n            public void onClick(View v) {\n                // TODO Auto-generated method stub\n                if (getSMSCount() &gt; 0) {\n                    SmsBackupActivity.this.BackupAlert();\n                } else {\n                    Toast.makeText(getApplicationContext(), &quot;SMS not found&quot;, Toast.LENGTH_SHORT).show();\n                }\n\n            }\n        });\n        btnRestore.setOnClickListener(new View.OnClickListener() {\n\n            @SuppressLint(&quot;NewApi&quot;)\n            @Override\n            public void onClick(View v) {\n                // TODO Auto-generated method stub\n\n                if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.Q) {\n                    RoleManager roleManager = (RoleManager) getSystemService(Context.ROLE_SERVICE);\n                    if (roleManager != null &amp;&amp; !roleManager.isRoleHeld(ROLE_SMS)) {\n                        SmsReceiver.enable(SmsBackupActivity.this);\n                        Intent intent = roleManager.createRequestRoleIntent(ROLE_SMS);\n                        startActivityForResult(intent, DEF_SMS_REQ);\n                    }\n                    else {\n                        SmsBackupActivity.this.restoreBackupFilesDialog(true);\n                    }\n                } else {\n                    if (!Telephony.Sms.getDefaultSmsPackage(getApplicationContext()).equals(getPackageName()))\n                    {\n                        Intent intent = new Intent(Telephony.Sms.Intents.ACTION_CHANGE_DEFAULT);\n                        intent.putExtra(Telephony.Sms.Intents.EXTRA_PACKAGE_NAME,getPackageName());\n                        startActivityForResult(intent, DEF_SMS_REQ);\n                    }\n                    else\n                    {\n                        SmsBackupActivity.this.restoreBackupFilesDialog(true);\n                    }\n                }\n\n            }\n        });\n\n        localTextView1.setText(Html.fromHtml(&quot;&lt;font color='#FFFFFF'&gt;SMS:&lt;/font&gt;&quot; + getSMSCount()));\n        this.tvLastBackup.setText(Html.fromHtml(&quot;&lt;font color='#FFFFFF'&gt;&quot; + getString(R.string.last_backup) + &quot;:&lt;/font&gt;&quot; + getBackupDate(&quot;smsBackupDate&quot;)));\n    }\n\n    public void okDialog() {\n        AlertDialog localAlertDialog = new AlertDialog.Builder(this).create();\n\n        localAlertDialog.setMessage(getString(R.string.deleted_successfully_));\n        localAlertDialog.setButton(&quot;ok&quot;, new OnClickListener() {\n            @Override\n            public void onClick(DialogInterface paramAnonymousDialogInterface, int paramAnonymousInt) {\n            }\n        });\n        localAlertDialog.show();\n    }\n\n    @Override\n    protected void onCreate(Bundle paramBundle) {\n        super.onCreate(paramBundle);\n        setContentView(R.layout.layout_sms_backupt);\n        SmsBackupActivity.context = getApplicationContext();\n        initAllViews();\n    }\n\n    @Override\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\n        switch (requestCode) {\n            case DEF_SMS_REQ:\n                if (Build.VERSION.SDK_INT == Build.VERSION_CODES.KITKAT &amp;&amp; isDefaultSmsApp(this) ||\n                        Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.BASE &amp;&amp; resultCode == Activity.RESULT_OK) {\n                    SmsBackupActivity.this.restoreBackupFilesDialog(true);\n                }\n                break;\n        }\n    }\n\n    @TargetApi(Build.VERSION_CODES.KITKAT)\n    public static boolean isDefaultSmsApp(Context context) {\n        return context.getPackageName().equals(getDefaultSmsPackage(context));\n    }\n\n    public void openInbox() {\n        try {\n            Intent localIntent = new Intent(&quot;android.intent.action.MAIN&quot;);\n            localIntent.addCategory(&quot;android.intent.category.LAUNCHER&quot;);\n            Iterator localIterator = getPackageManager().queryIntentActivities(localIntent, 0).iterator();\n            while (localIterator.hasNext()) {\n                ResolveInfo localResolveInfo = (ResolveInfo) localIterator.next();\n                if (localResolveInfo.activityInfo.packageName.equalsIgnoreCase(&quot;com.android.mms&quot;))\n                    launchComponent(localResolveInfo.activityInfo.packageName, localResolveInfo.activityInfo.name);\n            }\n        } catch (ActivityNotFoundException localActivityNotFoundException) {\n        }\n    }\n\n    @SuppressLint(&quot;NewApi&quot;)\n    public void restoreBackup(HashMap&lt;String, String&gt; paramHashMap) {\n        ContentValues localContentValues = new ContentValues();\n        localContentValues.put(&quot;address&quot;, paramHashMap.get(&quot;address&quot;));\n        localContentValues.put(&quot;person&quot;, paramHashMap.get(&quot;person&quot;));\n        localContentValues.put(&quot;date&quot;, paramHashMap.get(&quot;date&quot;));\n        localContentValues.put(&quot;body&quot;, paramHashMap.get(&quot;body&quot;));\n        localContentValues.put(&quot;_id&quot;, paramHashMap.get(&quot;id&quot;));\n        localContentValues.put(&quot;type&quot;, paramHashMap.get(&quot;type&quot;));\n        localContentValues.put(&quot;read&quot;, paramHashMap.get(&quot;read&quot;));\n\n        try {\n            if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.BASE) {\n                getContentResolver().insert(Telephony.Sms.CONTENT_URI, localContentValues);\n            } else {\n                getContentResolver().insert(Uri.parse(&quot;content://sms/&quot;), localContentValues);\n            }\n        }catch (Exception e){\n\n        }\n\n    }\n\n    public void restoreBackupFilesDialog(final boolean paramBoolean) {\n        AlertDialog.Builder localBuilder = new AlertDialog.Builder(this);\n        localBuilder.setTitle(R.string.backup_files);\n        ListView localListView = new ListView(this);\n        final List localList = getSMSFiles();\n        localListView.setAdapter(new FileAdapter(this, R.layout.item_row_file, localList));\n        localListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {\n            @Override\n            public void onItemClick(AdapterView&lt;?&gt; paramAnonymousAdapterView, View paramAnonymousView, int paramAnonymousInt, long paramAnonymousLong) {\n                SmsBackupActivity.this.dismiss.dismiss();\n                if (paramBoolean) {\n                    String str = getExternalFilesDir(null) + File.separator + &quot;sms&quot; + File.separator + ((FileGetterSetters) localList.get(paramAnonymousInt)).getFileName();\n                    Log.d(&quot;Seleted file path is&quot;, str);\n                    RestoringTask localRestoringTask = new RestoringTask(SmsBackupActivity.this);\n                    String[] arrayOfString = new String[1];\n                    arrayOfString[0] = str;\n                    localRestoringTask.execute(arrayOfString);\n                }\n            }\n        });\n        localBuilder.setView(localListView);\n        localBuilder.setNegativeButton(&quot;cancel&quot;, null);\n        AlertDialog localAlertDialog = localBuilder.create();\n        localAlertDialog.getWindow().getAttributes().alpha = 0.6F;\n        localAlertDialog.getWindow().getAttributes().windowAnimations = R.style.FileDialogAnimation;\n        this.dismiss = localAlertDialog;\n        localAlertDialog.show();\n    }\n\n\n    public void setBackupDate() {\n        CharSequence localCharSequence = DateFormat.format(&quot;yy/MM/dd hh:mm:ss&quot;, new Date().getTime());\n        this.tvLastBackup.setText(Html.fromHtml(&quot;&lt;font color='#FFFFFF'&gt;&quot; + getString(R.string.last_backup) + &quot;:&lt;/font&gt;&quot; + localCharSequence.toString()));\n        setLastBackupDate(&quot;smsBackupDate&quot;, localCharSequence.toString());\n    }\n\n\n    public void setLastBackupDate(String paramString1, String paramString2) {\n        SharedPreferences.Editor localEditor = getSharedPreferences(&quot;BackupPrefs&quot;, 0).edit();\n        localEditor.putString(paramString1, paramString2);\n        localEditor.commit();\n    }\n\n    public void setProgressDialog() {\n        this.pDialog = new ProgressDialog(this);\n        this.pDialog.setMessage(getString(R.string.backuping_files_please_wait_));\n        this.pDialog.setIndeterminate(false);\n        this.pDialog.setProgressDrawable(getResources().getDrawable(R.drawable.greenprogress));\n        this.pDialog.setMax(100);\n        this.pDialog.setProgressStyle(1);\n        this.pDialog.setCancelable(true);\n        this.pDialog.show();\n    }\n\n\n    public void viewMessagesDialog() {\n        AlertDialog.Builder localBuilder = new AlertDialog.Builder(this);\n\n        localBuilder.setMessage(getString(R.string.restore_completed_successfully_));\n        localBuilder.setPositiveButton(getString(R.string.view_messages), new OnClickListener() {\n            @Override\n            public void onClick(DialogInterface paramAnonymousDialogInterface, int paramAnonymousInt) {\n                SmsBackupActivity.this.openInbox();\n            }\n        });\n        localBuilder.setNegativeButton(&quot;cancel&quot;, null);\n        AlertDialog localAlertDialog = localBuilder.create();\n        localAlertDialog.getWindow().getAttributes().windowAnimations = R.style.PauseDialogAnimation;\n        localAlertDialog.show();\n    }\n\n    public class RestoringTask extends AsyncTask&lt;String, Integer, String&gt; {\n\n        ProgressDialog pd = new ProgressDialog(SmsBackupActivity.this);\n        Integer[] arrayOfInteger;\n\n        public RestoringTask(SmsBackupActivity smsBackupActivity) {\n        }\n\n        @Override\n        @SuppressWarnings(&quot;unchecked&quot;)\n        protected String doInBackground(String[] paramArrayOfString) {\n            String str = SmsBackupActivity.this.getXML(paramArrayOfString[0]);\n            XMLParser localXMLParser = new XMLParser();\n\n            NodeList localNodeList = localXMLParser.getDomElement(str).getElementsByTagName(&quot;sms&quot;);\n            int i = localNodeList.getLength();\n            for (int j = 0; ; j++) {\n                if (j &gt;= i)\n                    return &quot;&quot;;\n                @SuppressWarnings(&quot;rawtypes&quot;)\n                HashMap localHashMap = new HashMap();\n                Element localElement = (Element) localNodeList.item(j);\n                localHashMap.put(&quot;id&quot;, localXMLParser.getValue(localElement, &quot;id&quot;));\n                localHashMap.put(&quot;threadId&quot;, localXMLParser.getValue(localElement, &quot;threadId&quot;));\n                localHashMap.put(&quot;address&quot;, localXMLParser.getValue(localElement, &quot;address&quot;));\n                localHashMap.put(&quot;person&quot;, localXMLParser.getValue(localElement, &quot;person&quot;));\n                localHashMap.put(&quot;date&quot;, localXMLParser.getValue(localElement, &quot;date&quot;));\n                localHashMap.put(&quot;body&quot;, localXMLParser.getValue(localElement, &quot;body&quot;));\n                localHashMap.put(&quot;type&quot;, localXMLParser.getValue(localElement, &quot;type&quot;));\n                localHashMap.put(&quot;read&quot;, localXMLParser.getValue(localElement, &quot;read&quot;));\n\n                SmsBackupActivity.this.restoreBackup(localHashMap);\n                Integer[] arrayOfInteger = new Integer[2];\n                arrayOfInteger[0] = Integer.valueOf(i);\n                arrayOfInteger[1] = Integer.valueOf(j);\n                publishProgress(arrayOfInteger);\n            }\n\n        }\n\n        @Override\n        @SuppressLint(&quot;InlinedApi&quot;)\n        protected void onPostExecute(String paramString) {\n            super.onPostExecute(paramString);\n            ((TextView) SmsBackupActivity.this.findViewById(R.id.tvSMS)).setText(Html.fromHtml(&quot;&lt;font color='#FFFFFF'&gt;SMS:&lt;/font&gt;&quot; + SmsBackupActivity.this.getSMSCount()));\n            this.pd.dismiss();\n            if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {\n                Toast.makeText(getApplicationContext(), &quot;Restored successfully&quot;, Toast.LENGTH_SHORT).show();\n            } else {\n                SmsBackupActivity.this.viewMessagesDialog();\n            }\n\n        }\n\n        @Override\n        protected void onPreExecute() {\n            super.onPreExecute();\n            this.pd.setProgressStyle(1);\n            this.pd.setMessage(SmsBackupActivity.this.getString(R.string.restoring_backups_));\n            this.pd.setProgressDrawable(SmsBackupActivity.this.getResources().getDrawable(R.drawable.greenprogress));\n            this.pd.show();\n        }\n\n        @Override\n        protected void onProgressUpdate(Integer[] paramArrayOfInteger) {\n            this.pd.setMax(paramArrayOfInteger[0].intValue());\n            this.pd.setProgress(paramArrayOfInteger[1].intValue());\n            super.onProgressUpdate(paramArrayOfInteger);\n        }\n    }\n}\n</code></pre>\n<p>Also, in my MainActivity file, I've taken Manifest.permission.READ_SMS permission.<br>\n<strong>Update</strong>: I deleted all the text messages from the phone and there is no similar id and the error Logcat is no longer shown but The bug still remains and SMS messages cannot be restored only on Xiaomi phones.</p>\n"},{"tags":["java","sql","database","h2"],"comments":[{"owner":{"account_id":969721,"reputation":344527,"user_id":992484,"accept_rate":60,"display_name":"MadProgrammer"},"score":0,"creation_date":1415132750,"post_id":26743992,"comment_id":42074226,"body_markdown":"Funny how the first answer you get is exactly what I&#39;ve been saying...","body":"Funny how the first answer you get is exactly what I&#39;ve been saying..."},{"owner":{"account_id":3870202,"reputation":521,"user_id":3205654,"accept_rate":57,"display_name":"Ryan"},"score":2,"creation_date":1415137208,"post_id":26743992,"comment_id":42076437,"body_markdown":"Not exactly. None of your responses were very direct or helpful.","body":"Not exactly. None of your responses were very direct or helpful."},{"owner":{"account_id":969721,"reputation":344527,"user_id":992484,"accept_rate":60,"display_name":"MadProgrammer"},"score":0,"creation_date":1415141195,"post_id":26743992,"comment_id":42078214,"body_markdown":"So &quot;use the server mode&quot; wasn&#39;t helpful...shame","body":"So &quot;use the server mode&quot; wasn&#39;t helpful...shame"},{"owner":{"account_id":3870202,"reputation":521,"user_id":3205654,"accept_rate":57,"display_name":"Ryan"},"score":0,"creation_date":1415144888,"post_id":26743992,"comment_id":42079468,"body_markdown":"Okay, I don&#39;t think using &quot;AUTO_SERVER=TRUE&quot; alone fixed the problem. Should that alone have fixed the problem? Right now, I have it set up to immediately commit and close the connection after a query is made, so the lock file is created and then deleted. Is this an efficient way to allow multiple users to access the database?","body":"Okay, I don&#39;t think using &quot;AUTO_SERVER=TRUE&quot; alone fixed the problem. Should that alone have fixed the problem? Right now, I have it set up to immediately commit and close the connection after a query is made, so the lock file is created and then deleted. Is this an efficient way to allow multiple users to access the database?"}],"answers":[{"comments":[{"owner":{"account_id":3870202,"reputation":521,"user_id":3205654,"accept_rate":57,"display_name":"Ryan"},"score":1,"creation_date":1415137138,"post_id":26744250,"comment_id":42076398,"body_markdown":"So, is there a way to use &quot;AUTO_SERVER=TRUE&quot; to do this? Would that make it mixed?","body":"So, is there a way to use &quot;AUTO_SERVER=TRUE&quot; to do this? Would that make it mixed?"},{"owner":{"account_id":3870202,"reputation":521,"user_id":3205654,"accept_rate":57,"display_name":"Ryan"},"score":0,"creation_date":1415137177,"post_id":26744250,"comment_id":42076420,"body_markdown":"And, if I make the Auto Server true, would that allow multiple connections?","body":"And, if I make the Auto Server true, would that allow multiple connections?"},{"owner":{"account_id":249090,"reputation":4307,"user_id":524900,"display_name":"Lolo"},"score":2,"creation_date":1415168998,"post_id":26744250,"comment_id":42085727,"body_markdown":"The [automatic mixed mode](http://www.h2database.com/html/features.html#auto_mixed_mode) (i.e. AUTO_SERVER=TRUE) allows multiple concurrent connections to the database. However, I wouldn&#39;t recommend it, due to the constraints that the first connection starts the server and when that connection is closed, so is the server and all remote connections are therefore closed, and pending transactions will be rolled back.","body":"The <a href=\"http://www.h2database.com/html/features.html#auto_mixed_mode\" rel=\"nofollow noreferrer\">automatic mixed mode</a> (i.e. AUTO_SERVER=TRUE) allows multiple concurrent connections to the database. However, I wouldn&#39;t recommend it, due to the constraints that the first connection starts the server and when that connection is closed, so is the server and all remote connections are therefore closed, and pending transactions will be rolled back."},{"owner":{"account_id":3870202,"reputation":521,"user_id":3205654,"accept_rate":57,"display_name":"Ryan"},"score":0,"creation_date":1415171560,"post_id":26744250,"comment_id":42086619,"body_markdown":"But if I use &quot;connection.commit()&quot;, I won&#39;t have that problem, correct?","body":"But if I use &quot;connection.commit()&quot;, I won&#39;t have that problem, correct?"},{"owner":{"account_id":7644969,"reputation":548,"user_id":5795938,"display_name":"Stefan Neuhaus"},"score":2,"creation_date":1487535229,"post_id":26744250,"comment_id":71817057,"body_markdown":"The documentation states that in embedded mode there is no limit on the number of open connections.","body":"The documentation states that in embedded mode there is no limit on the number of open connections."},{"owner":{"account_id":116399,"reputation":689,"user_id":305224,"display_name":"user305224"},"score":1,"creation_date":1521101573,"post_id":26744250,"comment_id":85590812,"body_markdown":"@StefanNeuhaus but not by multiple users","body":"@StefanNeuhaus but not by multiple users"}],"tags":[],"owner":{"account_id":249090,"reputation":4307,"user_id":524900,"display_name":"Lolo"},"comment_count":6,"down_vote_count":1,"up_vote_count":26,"is_accepted":true,"score":25,"last_activity_date":1415132318,"creation_date":1415132318,"answer_id":26744250,"question_id":26743992,"body_markdown":"It looks like you are using H2 in embedded mode, which only allows one database connection at a time. See [connection modes][1] in the documentation for details.\r\n\r\nIf you need support for multiple connections, including from multiple application instances, then you need to start H2 in [server mode][2] instead and use the appropriate [connection URLs][3] for this mode.\r\n\r\n\r\n  [1]: http://www.h2database.com/html/features.html#connection_modes\r\n  [2]: http://www.h2database.com/html/tutorial.html#using_server\r\n  [3]: http://www.h2database.com/html/features.html#database_url","title":"How do I allow multiple users to connect to my H2 database simultaneously?","body":"<p>It looks like you are using H2 in embedded mode, which only allows one database connection at a time. See <a href=\"http://www.h2database.com/html/features.html#connection_modes\">connection modes</a> in the documentation for details.</p>\n\n<p>If you need support for multiple connections, including from multiple application instances, then you need to start H2 in <a href=\"http://www.h2database.com/html/tutorial.html#using_server\">server mode</a> instead and use the appropriate <a href=\"http://www.h2database.com/html/features.html#database_url\">connection URLs</a> for this mode.</p>\n"},{"tags":[],"owner":{"account_id":13118858,"reputation":6035,"user_id":9477038,"display_name":"Jackkobec"},"comment_count":0,"down_vote_count":1,"up_vote_count":8,"is_accepted":false,"score":7,"last_activity_date":1522498674,"creation_date":1522498674,"answer_id":49587637,"question_id":26743992,"body_markdown":"**AUTO_SERVER=TRUE** allows multiple connections mode.","title":"How do I allow multiple users to connect to my H2 database simultaneously?","body":"<p><strong>AUTO_SERVER=TRUE</strong> allows multiple connections mode.</p>\n"},{"tags":[],"owner":{"account_id":7993153,"reputation":23,"user_id":6030425,"display_name":"mairisb"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694357558,"creation_date":1694356695,"answer_id":77076570,"question_id":26743992,"body_markdown":"The accepted answer is wrong. It is possible to have multiple connections without starting a separate H2 server manually by using [Automatic Mixed Mode][1]:\r\n\r\n&gt; Multiple processes can access the same database without having to start the server manually. To do that, append ;AUTO_SERVER=TRUE to the database URL. You can use the same database URL independent of whether the database is already open or not. This feature doesn&#39;t work with in-memory databases. \r\n\r\nSo, to allow multiple users to connect to an H2 database simultaneously, append `;AUTO_SERVER=true` data source URL property.\r\n\r\nThe only caveat is that you can&#39;t use this with the in-memory database. The next best thing (based on simplicity) is file-based database.\r\n\r\n---\r\n\r\n**Example for a spring app**\r\n\r\n`application.properties` to use a file-based database:\r\n\r\n```env\r\nspring.datasource.url=jdbc:h2:file:./data/testdb;AUTO_SERVER=TRUE\r\nspring.datasource.driverClassName=org.h2.Driver\r\nspring.datasource.username=sa\r\nspring.datasource.password=password\r\nspring.jpa.database-platform=org.hibernate.dialect.H2Dialect\r\nspring.jpa.generate-ddl=true\r\n```\r\n\r\nWhen launching the app this will create a new database file as `./data/testdb.mv.db` or use it if it already exists.\r\n\r\nNow you can connect to this database from another source using the same url `h2:file:./data/testdb;AUTO_SERVER=TRUE`. It&#39;s important not to forget to append `;AUTO_SERVER=true` to the url when connecting from another source, otherwise you will get `The file is locked` exception.\r\n\r\n\r\n  [1]: http://www.h2database.com/html/features.html#auto_mixed_mode","title":"How do I allow multiple users to connect to my H2 database simultaneously?","body":"<p>The accepted answer is wrong. It is possible to have multiple connections without starting a separate H2 server manually by using <a href=\"http://www.h2database.com/html/features.html#auto_mixed_mode\" rel=\"nofollow noreferrer\">Automatic Mixed Mode</a>:</p>\n<blockquote>\n<p>Multiple processes can access the same database without having to start the server manually. To do that, append ;AUTO_SERVER=TRUE to the database URL. You can use the same database URL independent of whether the database is already open or not. This feature doesn't work with in-memory databases.</p>\n</blockquote>\n<p>So, to allow multiple users to connect to an H2 database simultaneously, append <code>;AUTO_SERVER=true</code> data source URL property.</p>\n<p>The only caveat is that you can't use this with the in-memory database. The next best thing (based on simplicity) is file-based database.</p>\n<hr />\n<p><strong>Example for a spring app</strong></p>\n<p><code>application.properties</code> to use a file-based database:</p>\n<pre><code>spring.datasource.url=jdbc:h2:file:./data/testdb;AUTO_SERVER=TRUE\nspring.datasource.driverClassName=org.h2.Driver\nspring.datasource.username=sa\nspring.datasource.password=password\nspring.jpa.database-platform=org.hibernate.dialect.H2Dialect\nspring.jpa.generate-ddl=true\n</code></pre>\n<p>When launching the app this will create a new database file as <code>./data/testdb.mv.db</code> or use it if it already exists.</p>\n<p>Now you can connect to this database from another source using the same url <code>h2:file:./data/testdb;AUTO_SERVER=TRUE</code>. It's important not to forget to append <code>;AUTO_SERVER=true</code> to the url when connecting from another source, otherwise you will get <code>The file is locked</code> exception.</p>\n"}],"owner":{"account_id":3870202,"reputation":521,"user_id":3205654,"accept_rate":57,"display_name":"Ryan"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":24831,"favorite_count":0,"down_vote_count":0,"up_vote_count":23,"accepted_answer_id":26744250,"answer_count":3,"score":23,"last_activity_date":1694357558,"creation_date":1415131396,"question_id":26743992,"body_markdown":"I am using H2 for database management, and this is what I would like to do:\r\n\r\nI would like to allow multiple users to access a database at the same time. I&#39;ve read a bit about &quot;MULTI_THREADED=TRUE&quot;, &quot;LOCK_FILE=NO&quot;, and &quot;AUTO_SERVER=TRUE&quot;. I&#39;ve also read that &quot;LOCK_FILE=NO&quot; can be dangerous, because it can corrupt the database. I definitely would not want this, so I&#39;m assuming that is a bad way to go. I&#39;ve also tried to close the connection immediately after a record is accessed, whether it is being read from or written to. So far, nothing seems to work. The application is not allowing me to read from or write to the database if the database has been connected to in a separate instance of the application (ex: on another computer). Once I completely close the application on one computer, I am able to access the database records.\r\n\r\nHow do I allow multiple users to connect to the H2 database at the same time without compromising the safety of the database?","title":"How do I allow multiple users to connect to my H2 database simultaneously?","body":"<p>I am using H2 for database management, and this is what I would like to do:</p>\n\n<p>I would like to allow multiple users to access a database at the same time. I've read a bit about \"MULTI_THREADED=TRUE\", \"LOCK_FILE=NO\", and \"AUTO_SERVER=TRUE\". I've also read that \"LOCK_FILE=NO\" can be dangerous, because it can corrupt the database. I definitely would not want this, so I'm assuming that is a bad way to go. I've also tried to close the connection immediately after a record is accessed, whether it is being read from or written to. So far, nothing seems to work. The application is not allowing me to read from or write to the database if the database has been connected to in a separate instance of the application (ex: on another computer). Once I completely close the application on one computer, I am able to access the database records.</p>\n\n<p>How do I allow multiple users to connect to the H2 database at the same time without compromising the safety of the database?</p>\n"},{"tags":["java","reflections"],"comments":[{"owner":{"account_id":3380632,"reputation":14294,"user_id":2837741,"accept_rate":100,"display_name":"daniu"},"score":0,"creation_date":1694255650,"post_id":77071815,"comment_id":135869417,"body_markdown":"How did you try `isAssignableFrom`? It [should be the way to go](https://www.tutorialspoint.com/java/lang/class_isassignablefrom.htm).","body":"How did you try <code>isAssignableFrom</code>? It <a href=\"https://www.tutorialspoint.com/java/lang/class_isassignablefrom.htm\" rel=\"nofollow noreferrer\">should be the way to go</a>."},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":3,"creation_date":1694255818,"post_id":77071815,"comment_id":135869436,"body_markdown":"@daniu are you sure that [`Class::isAssignableFrom` (`docs.oracle.com`)](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Class.html#isAssignableFrom(java.lang.Class)) should work? IIRC, `isAssignableFrom(...)` checks the object hierarchy. Since the class in question does not `implements` the interface, I think this would not work.","body":"@daniu are you sure that <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Class.html#isAssignableFrom(java.lang.Class)\" rel=\"nofollow noreferrer\"><code>Class::isAssignableFrom</code> (<code>docs.oracle.com</code>)</a> should work? IIRC, <code>isAssignableFrom(...)</code> checks the object hierarchy. Since the class in question does not <code>implements</code> the interface, I think this would not work."},{"owner":{"account_id":698222,"reputation":50202,"user_id":573032,"accept_rate":77,"display_name":"Roman C"},"score":0,"creation_date":1694256122,"post_id":77071815,"comment_id":135869468,"body_markdown":"Clarify compatible, the way you think it is, it isn&#39;t. Also you can use a Reflection API to look into a Class details. Or you searching for the library to do it for you?","body":"Clarify compatible, the way you think it is, it isn&#39;t. Also you can use a Reflection API to look into a Class details. Or you searching for the library to do it for you?"},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":1,"creation_date":1694256157,"post_id":77071815,"comment_id":135869473,"body_markdown":"It is definitively possible to implement a check for this; the compiler does this check (otherwise it would not be able to find certain errors when we implement an interface). I wonder, however, what the end goal here is. We&#39;d need to either manipulate the bytecode of the (already compiled) class, or modify the (source code of the) class and recompile. This smells like an [XY problem (`xyproblem.info`)](https://xyproblem.info/). What are you actually trying to achieve?","body":"It is definitively possible to implement a check for this; the compiler does this check (otherwise it would not be able to find certain errors when we implement an interface). I wonder, however, what the end goal here is. We&#39;d need to either manipulate the bytecode of the (already compiled) class, or modify the (source code of the) class and recompile. This smells like an <a href=\"https://xyproblem.info/\" rel=\"nofollow noreferrer\">XY problem (<code>xyproblem.info</code>)</a>. What are you actually trying to achieve?"},{"owner":{"account_id":20470686,"reputation":21,"user_id":15021196,"display_name":"Oliver Wheatley"},"score":0,"creation_date":1694256545,"post_id":77071815,"comment_id":135869513,"body_markdown":"@Turing85 The end goal is to identify whether a class exactly matches an interface. So what I&#39;m building is a library that is being used to auto test code that students are tasked with writing. Students annotate their classes with a specific annotation which I then search for using reflections. I want to validate that the class they have written meets the criteria that was given to them in the task.","body":"@Turing85 The end goal is to identify whether a class exactly matches an interface. So what I&#39;m building is a library that is being used to auto test code that students are tasked with writing. Students annotate their classes with a specific annotation which I then search for using reflections. I want to validate that the class they have written meets the criteria that was given to them in the task."},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":0,"creation_date":1694256765,"post_id":77071815,"comment_id":135869530,"body_markdown":"... Why not give them the interface and enforce that their code implements the interface?","body":"... Why not give them the interface and enforce that their code implements the interface?"},{"owner":{"account_id":20470686,"reputation":21,"user_id":15021196,"display_name":"Oliver Wheatley"},"score":0,"creation_date":1694256998,"post_id":77071815,"comment_id":135869564,"body_markdown":"@Turing85 Good question, so in this instance the students are not told what the correct return type is for a method, part of the task is to determine the most appropriate return type and giving them the interface would reveal this.","body":"@Turing85 Good question, so in this instance the students are not told what the correct return type is for a method, part of the task is to determine the most appropriate return type and giving them the interface would reveal this."},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":0,"creation_date":1694257088,"post_id":77071815,"comment_id":135869578,"body_markdown":"Then an alternative idea would be to write some code that manipulates the source code to add the `implements SomeInterface` code fragment (from what I read, It should be fairly simple with a bash script, or an OpenRewrite recipe).","body":"Then an alternative idea would be to write some code that manipulates the source code to add the <code>implements SomeInterface</code> code fragment (from what I read, It should be fairly simple with a bash script, or an OpenRewrite recipe)."},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":1,"creation_date":1694257495,"post_id":77071815,"comment_id":135869619,"body_markdown":"Yet another idea is to let the Interface return `Object`. We can then test the runtime type of the returned value with `instanceof ...` or `.getClass().getCanonocalName()` or ... as part of the test procedure. Of course, we should then mention that the interface returns `Object` because part of the exercise is to determine the return type.","body":"Yet another idea is to let the Interface return <code>Object</code>. We can then test the runtime type of the returned value with <code>instanceof ...</code> or <code>.getClass().getCanonocalName()</code> or ... as part of the test procedure. Of course, we should then mention that the interface returns <code>Object</code> because part of the exercise is to determine the return type."},{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":2,"creation_date":1694291667,"post_id":77071815,"comment_id":135872977,"body_markdown":"Voting to re-open. Closing for &quot;seeking recommendations for books, tools, software libraries&quot; is an over-reaction and a misinterpretation. This is actually a question about the intricacies of using reflection.","body":"Voting to re-open. Closing for &quot;seeking recommendations for books, tools, software libraries&quot; is an over-reaction and a misinterpretation. This is actually a question about the intricacies of using reflection."}],"answers":[{"comments":[{"owner":{"account_id":20470686,"reputation":21,"user_id":15021196,"display_name":"Oliver Wheatley"},"score":0,"creation_date":1694256720,"post_id":77071857,"comment_id":135869525,"body_markdown":"I think this should solve it, for the functionality I need. Thanks.","body":"I think this should solve it, for the functionality I need. Thanks."},{"owner":{"account_id":1211967,"reputation":7024,"user_id":1180351,"display_name":"Rob Spoor"},"score":1,"creation_date":1694258894,"post_id":77071857,"comment_id":135869725,"body_markdown":"`cls.getMethod` will **never** return `null`. A `NoSuchMethodException` is thrown if the method does not exist.","body":"<code>cls.getMethod</code> will <b>never</b> return <code>null</code>. A <code>NoSuchMethodException</code> is thrown if the method does not exist."},{"owner":{"account_id":1211967,"reputation":7024,"user_id":1180351,"display_name":"Rob Spoor"},"score":0,"creation_date":1694258954,"post_id":77071857,"comment_id":135869734,"body_markdown":"Also, you can make use of varargs for the argument types: `cls.getMethod(&quot;doSomething&quot;)` is equivalent to what you typed. You want to reflectively get an `equals` method? Just use `cls.getMethod(&quot;equals&quot;, Object.class)`.","body":"Also, you can make use of varargs for the argument types: <code>cls.getMethod(&quot;doSomething&quot;)</code> is equivalent to what you typed. You want to reflectively get an <code>equals</code> method? Just use <code>cls.getMethod(&quot;equals&quot;, Object.class)</code>."},{"owner":{"account_id":1689973,"reputation":37330,"user_id":1552534,"display_name":"WJS"},"score":0,"creation_date":1694276872,"post_id":77071857,"comment_id":135871519,"body_markdown":"*`There is no such concept of &quot;is capable of implementing&quot; an interface. A class either does (or does not) implement an interface.`*  I disagree.  Imo, `is capable` means that you could  recompile the class to implement the interface without error, requiring no further modification of the class. This might be accomplished by reflective analysis of all aspects of the interface methods to see if they match those same methods in the class.","body":"<i><code>There is no such concept of &quot;is capable of implementing&quot; an interface. A class either does (or does not) implement an interface.</code></i>  I disagree.  Imo, <code>is capable</code> means that you could  recompile the class to implement the interface without error, requiring no further modification of the class. This might be accomplished by reflective analysis of all aspects of the interface methods to see if they match those same methods in the class."},{"owner":{"account_id":1689973,"reputation":37330,"user_id":1552534,"display_name":"WJS"},"score":0,"creation_date":1694278332,"post_id":77071857,"comment_id":135871672,"body_markdown":"And I don&#39;t believe this would require using an object of the class  but just using `Class/interface` interogation.","body":"And I don&#39;t believe this would require using an object of the class  but just using <code>Class&#47;interface</code> interogation."}],"tags":[],"owner":{"account_id":3557625,"reputation":199021,"user_id":2970947,"display_name":"Elliott Frisch"},"comment_count":5,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1694256271,"creation_date":1694256271,"answer_id":77071857,"question_id":77071815,"body_markdown":"There is no such concept of &quot;is capable of implementing&quot; an interface. A class either does (or does not) implement an interface. **However**, you can use *reflection* to dynamically call some method. It has caveats and limitations (of course). For example, it&#39;s usually slow. But here is a `doSomething` with &quot;duck-typing&quot;.\r\n\r\n\tpublic static final void doSomething(Object o) {\r\n\t\tif (o == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tClass&lt;?&gt; cls = o.getClass();\r\n\t\ttry {\r\n\t\t\tMethod m = cls.getMethod(&quot;doSomething&quot;, new Class&lt;?&gt;[] {});\r\n\t\t\tif (m != null) {\r\n\t\t\t\tm.invoke(o, new Object[] {});\r\n\t\t\t}\r\n\t\t} catch (final Exception e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t}\r\n\r\nNote the line `if (m != null)`, that does check if `doSomething` is available in the actual instance `o`. You could test for the presence of all necessary methods in the same manner.","title":"How to check if a class is capable of implementing an interface at runtime in Java (JDK 17)","body":"<p>There is no such concept of &quot;is capable of implementing&quot; an interface. A class either does (or does not) implement an interface. <strong>However</strong>, you can use <em>reflection</em> to dynamically call some method. It has caveats and limitations (of course). For example, it's usually slow. But here is a <code>doSomething</code> with &quot;duck-typing&quot;.</p>\n<pre><code>public static final void doSomething(Object o) {\n    if (o == null) {\n        return;\n    }\n    Class&lt;?&gt; cls = o.getClass();\n    try {\n        Method m = cls.getMethod(&quot;doSomething&quot;, new Class&lt;?&gt;[] {});\n        if (m != null) {\n            m.invoke(o, new Object[] {});\n        }\n    } catch (final Exception e) {\n        e.printStackTrace();\n    }\n}\n</code></pre>\n<p>Note the line <code>if (m != null)</code>, that does check if <code>doSomething</code> is available in the actual instance <code>o</code>. You could test for the presence of all necessary methods in the same manner.</p>\n"},{"tags":[],"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694357125,"creation_date":1694357125,"answer_id":77076590,"question_id":77071815,"body_markdown":"### Problem statement\r\n\r\nOP [clarified in the comments][clarificationComment] that the goal is to build an evaluation system for exercises given to students, I see some approaches that do not require reflection.\r\n\r\n### Approach 1: return `Object`\r\nWe can release the interface-definition to the students, but replace the return-type with `Object`. We can then check the runtime-type of the return value via `instanceof` or [`Class::isAssignableFrom` (`docs.oracle.com`)][classIsAssignableFromApi] (or really any other way we see fit).\r\n\r\n### Approach 2: Modify the source code to add `implements &lt;interface&gt;`\r\nThere are many way we could do this, e.g. a simple bash-script like\r\n\r\n    find \\\r\n      src/main/java \\\r\n      -type f \\\r\n      -name &quot;*.java&quot; \\\r\n      -exec \\\r\n        sed \\\r\n          -i \\\r\n          &#39;s/^\\(.*class\\s\\+Bar\\)\\s\\+{.*$/\\1 implements Foo {/g&#39; \\\r\n        {} \\;\r\n\r\nWe can then incorporate this script in a plethora of ways in our build-process. The downside of this approach is that it is OS-depndent.\r\n\r\nI would like to highlight another approach using [OpenRewrite (`docs.openrewrite.org`)][openRewriteHome], which is OS-independent. OpenRewrite allows us, among other things, to formulate simple rules for refactoring in a declarative way. In our example, we want to replace the string `class &lt;classname&gt;` with `class  &lt;classname&gt; implements &lt;interfacename&gt;`. If we assume the name of the interface to be `Foo` and the name of the class to be `Bar`, a OpenRewrite recipe may look like this:\r\n\r\n    type: specs.openrewrite.org/v1beta/recipe\r\n    name: de.turing85.AddFooInterfaceToBarClass\r\n    displayName: Add the Foo interface to the Bar class.\r\n    recipeList:\r\n      - org.openrewrite.text.FindAndReplace:\r\n          find: (?&lt;classdef&gt;class\\s+Bar)\\s+\\{\r\n          replace: ${classdef} implements Foo {\r\n          regex: true\r\n          filePattern: src/main/java/**/*.java\r\n\r\nSince OpenRewrite provides a [maven- (`docs.openrewrite.org`)][openRewriteMavenPlugin] and a [gradle-plugin (`docs.openrewrite.org`)][openRewriteGradlePlugin], we can simply incoroprate it in our build-process.\r\n\r\nA POC can be found in [this `github.com` repository][githubOpenRewriteExample].\r\n\r\n[clarificationComment]: https://stackoverflow.com/questions/77071815/how-to-check-if-a-class-is-capable-of-implementing-an-interface-at-runtime-in-ja#comment135869513_77071815\r\n\r\n[classIsAssignableFromApi]: https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Class.html#isAssignableFrom(java.lang.Class)\r\n\r\n[openRewriteHome]: https://docs.openrewrite.org/\r\n\r\n[openRewriteMavenPlugin]: https://docs.openrewrite.org/reference/rewrite-maven-plugin\r\n\r\n[openRewriteGradlePlugin]: https://docs.openrewrite.org/reference/gradle-plugin-configuration\r\n\r\n[githubOpenRewriteExample]: https://github.com/turing85/openrewrite-example","title":"How to check if a class is capable of implementing an interface at runtime in Java (JDK 17)","body":"<h3>Problem statement</h3>\n<p>OP <a href=\"https://stackoverflow.com/questions/77071815/how-to-check-if-a-class-is-capable-of-implementing-an-interface-at-runtime-in-ja#comment135869513_77071815\">clarified in the comments</a> that the goal is to build an evaluation system for exercises given to students, I see some approaches that do not require reflection.</p>\n<h3>Approach 1: return <code>Object</code></h3>\n<p>We can release the interface-definition to the students, but replace the return-type with <code>Object</code>. We can then check the runtime-type of the return value via <code>instanceof</code> or <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Class.html#isAssignableFrom(java.lang.Class)\" rel=\"nofollow noreferrer\"><code>Class::isAssignableFrom</code> (<code>docs.oracle.com</code>)</a> (or really any other way we see fit).</p>\n<h3>Approach 2: Modify the source code to add <code>implements &lt;interface&gt;</code></h3>\n<p>There are many way we could do this, e.g. a simple bash-script like</p>\n<pre><code>find \\\n  src/main/java \\\n  -type f \\\n  -name &quot;*.java&quot; \\\n  -exec \\\n    sed \\\n      -i \\\n      's/^\\(.*class\\s\\+Bar\\)\\s\\+{.*$/\\1 implements Foo {/g' \\\n    {} \\;\n</code></pre>\n<p>We can then incorporate this script in a plethora of ways in our build-process. The downside of this approach is that it is OS-depndent.</p>\n<p>I would like to highlight another approach using <a href=\"https://docs.openrewrite.org/\" rel=\"nofollow noreferrer\">OpenRewrite (<code>docs.openrewrite.org</code>)</a>, which is OS-independent. OpenRewrite allows us, among other things, to formulate simple rules for refactoring in a declarative way. In our example, we want to replace the string <code>class &lt;classname&gt;</code> with <code>class  &lt;classname&gt; implements &lt;interfacename&gt;</code>. If we assume the name of the interface to be <code>Foo</code> and the name of the class to be <code>Bar</code>, a OpenRewrite recipe may look like this:</p>\n<pre><code>type: specs.openrewrite.org/v1beta/recipe\nname: de.turing85.AddFooInterfaceToBarClass\ndisplayName: Add the Foo interface to the Bar class.\nrecipeList:\n  - org.openrewrite.text.FindAndReplace:\n      find: (?&lt;classdef&gt;class\\s+Bar)\\s+\\{\n      replace: ${classdef} implements Foo {\n      regex: true\n      filePattern: src/main/java/**/*.java\n</code></pre>\n<p>Since OpenRewrite provides a <a href=\"https://docs.openrewrite.org/reference/rewrite-maven-plugin\" rel=\"nofollow noreferrer\">maven- (<code>docs.openrewrite.org</code>)</a> and a <a href=\"https://docs.openrewrite.org/reference/gradle-plugin-configuration\" rel=\"nofollow noreferrer\">gradle-plugin (<code>docs.openrewrite.org</code>)</a>, we can simply incoroprate it in our build-process.</p>\n<p>A POC can be found in <a href=\"https://github.com/turing85/openrewrite-example\" rel=\"nofollow noreferrer\">this <code>github.com</code> repository</a>.</p>\n"}],"owner":{"account_id":20470686,"reputation":21,"user_id":15021196,"display_name":"Oliver Wheatley"},"comment_count":10,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":92,"favorite_count":0,"down_vote_count":3,"up_vote_count":2,"accepted_answer_id":77071857,"answer_count":2,"score":-1,"last_activity_date":1694357125,"creation_date":1694255489,"question_id":77071815,"body_markdown":"I need to determine whether a class is capable of implementing an interface when it does not explicitly implement that interface. I would like to determine this at runtime, I am using reflections to gather classes.\r\n\r\nFor example:\r\n\r\nLets say I have the following class:\r\n\r\n```\r\npublic class Clazz {\r\n    public void doSomething() {\r\n        // ... do it\r\n    }\r\n}\r\n```\r\n\r\nAnd the following interface:\r\n\r\n```\r\npublic interface ClazzInterface {\r\n    public void doSomething();\r\n}\r\n```\r\n\r\nClazz does not implement ClazzInterface, however it is compatible with ClazzInterface and could implement it without any modification. I am looking for a way to check this at runtime.\r\n\r\nSomething like:\r\n\r\n```\r\nboolean canImplement = Clazz.class canImplement ClazzInterface.class\r\n```\r\n\r\nIs this possible either through a built in library or method or some logic I could write myself?\r\n\r\nI have tried using reflections `isAssignableFrom` and this does not work, returning `false` for the above example.","title":"How to check if a class is capable of implementing an interface at runtime in Java (JDK 17)","body":"<p>I need to determine whether a class is capable of implementing an interface when it does not explicitly implement that interface. I would like to determine this at runtime, I am using reflections to gather classes.</p>\n<p>For example:</p>\n<p>Lets say I have the following class:</p>\n<pre><code>public class Clazz {\n    public void doSomething() {\n        // ... do it\n    }\n}\n</code></pre>\n<p>And the following interface:</p>\n<pre><code>public interface ClazzInterface {\n    public void doSomething();\n}\n</code></pre>\n<p>Clazz does not implement ClazzInterface, however it is compatible with ClazzInterface and could implement it without any modification. I am looking for a way to check this at runtime.</p>\n<p>Something like:</p>\n<pre><code>boolean canImplement = Clazz.class canImplement ClazzInterface.class\n</code></pre>\n<p>Is this possible either through a built in library or method or some logic I could write myself?</p>\n<p>I have tried using reflections <code>isAssignableFrom</code> and this does not work, returning <code>false</code> for the above example.</p>\n"},{"tags":["java","spring","spring-security"],"comments":[{"owner":{"account_id":2064278,"reputation":13138,"user_id":1840146,"accept_rate":86,"display_name":"Toerktumlare"},"score":0,"creation_date":1687983477,"post_id":76575976,"comment_id":135014684,"body_markdown":"using JWTs as session holders is a security risk, your application can easily be DDoSed as you are doing a database call for every request, your token can be stolen in the browser etc. Dont use JWTs as sessions https://developer.okta.com/blog/2017/08/17/why-jwts-suck-as-session-tokens","body":"using JWTs as session holders is a security risk, your application can easily be DDoSed as you are doing a database call for every request, your token can be stolen in the browser etc. Dont use JWTs as sessions <a href=\"https://developer.okta.com/blog/2017/08/17/why-jwts-suck-as-session-tokens\" rel=\"nofollow noreferrer\">developer.okta.com/blog/2017/08/17/&hellip;</a>"},{"owner":{"account_id":6704835,"reputation":31,"user_id":5170202,"display_name":"Bruno Paiva"},"score":0,"creation_date":1688290787,"post_id":76575976,"comment_id":135051969,"body_markdown":"Thanks for the callout, but this is just a research project, just study purposes","body":"Thanks for the callout, but this is just a research project, just study purposes"},{"owner":{"account_id":2064278,"reputation":13138,"user_id":1840146,"accept_rate":86,"display_name":"Toerktumlare"},"score":0,"creation_date":1688291554,"post_id":76575976,"comment_id":135052053,"body_markdown":"so for that reason its okey to learn and study bad practices?","body":"so for that reason its okey to learn and study bad practices?"}],"owner":{"account_id":6704835,"reputation":31,"user_id":5170202,"display_name":"Bruno Paiva"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":236,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1694356445,"creation_date":1687978557,"question_id":76575976,"body_markdown":"I am using Spring Security with JWT authorization and recently I was trying to upgrade my Spring Security to the latest version (6.1.1), however for non-mapped API routes I&#39;m getting always 403 Forbidden instead of 404 Not Found, even when setting the Authorization token correctly. I created a JWTFilter that is always called during the Authentication flow. If authenticated successfully it sets the Authentication object inside the context (see code paste below).\r\n\r\nI activated TRACE logging and this is the logs when I try to call a path tha wasn&#39;t mapped in the SecurityConfig.\r\n\r\n```\r\n2023-06-28T19:42:18.740+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain [RequestMatcher=any request, Filters=[org.springframework.security.web.session.DisableEncodeUrlFilter@4126cd58, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7ecd90ea, org.springframework.security.web.context.SecurityContextHolderFilter@e25af5a, org.springframework.security.web.header.HeaderWriterFilter@34734cf6, org.springframework.security.web.authentication.logout.LogoutFilter@5901af8b, org.greenhill.application.config.security.JwtTokenFilter@19098979, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@6df7193b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@57640814, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@bad144f, org.springframework.security.web.session.SessionManagementFilter@6921fa4d, org.springframework.security.web.access.ExceptionTranslationFilter@7a88c97f, org.springframework.security.web.access.intercept.AuthorizationFilter@7a98b997]] (1/1)\r\n2023-06-28T19:42:18.740+01:00 DEBUG 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing POST /test\r\n2023-06-28T19:42:18.740+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/12)\r\n2023-06-28T19:42:18.740+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/12)\r\n2023-06-28T19:42:18.740+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/12)\r\n2023-06-28T19:42:18.740+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (4/12)\r\n2023-06-28T19:42:18.741+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (5/12)\r\n2023-06-28T19:42:18.741+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Or [Ant [pattern=&#39;/logout&#39;, GET], Ant [pattern=&#39;/logout&#39;, POST], Ant [pattern=&#39;/logout&#39;, PUT], Ant [pattern=&#39;/logout&#39;, DELETE]]\r\n2023-06-28T19:42:18.741+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking JwtTokenFilter (6/12)\r\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] .s.s.w.c.SupplierDeferredSecurityContext : Created SecurityContextImpl [Null authentication]\r\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (7/12)\r\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (8/12)\r\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (9/12)\r\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SessionManagementFilter (10/12)\r\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.a.AnonymousAuthenticationFilter  : Did not set SecurityContextHolder since already authenticated UsernamePasswordAuthenticationToken [Principal=org.greenhill.auth.repository.entity.Worker@6586a89e, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[]]\r\n2023-06-28T19:42:18.744+01:00 TRACE 6970 --- [nio-8080-exec-4] s.CompositeSessionAuthenticationStrategy : Preparing session with ChangeSessionIdAuthenticationStrategy (1/1)\r\n2023-06-28T19:42:18.744+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (11/12)\r\n2023-06-28T19:42:18.744+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (12/12)\r\n2023-06-28T19:42:18.744+01:00 TRACE 6970 --- [nio-8080-exec-4] estMatcherDelegatingAuthorizationManager : Authorizing SecurityContextHolderAwareRequestWrapper[ org.springframework.security.web.header.HeaderWriterFilter$HeaderWriterRequest@61b920f6]\r\n2023-06-28T19:42:18.747+01:00 TRACE 6970 --- [nio-8080-exec-4] estMatcherDelegatingAuthorizationManager : Checking authorization on SecurityContextHolderAwareRequestWrapper[ org.springframework.security.web.header.HeaderWriterFilter$HeaderWriterRequest@61b920f6] using org.springframework.security.authorization.AuthenticatedAuthorizationManager@e8f8395\r\n2023-06-28T19:42:18.748+01:00 DEBUG 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured POST /test\r\n2023-06-28T19:42:18.749+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]\r\n2023-06-28T19:42:18.752+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain [RequestMatcher=any request, Filters=[org.springframework.security.web.session.DisableEncodeUrlFilter@4126cd58, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7ecd90ea, org.springframework.security.web.context.SecurityContextHolderFilter@e25af5a, org.springframework.security.web.header.HeaderWriterFilter@34734cf6, org.springframework.security.web.authentication.logout.LogoutFilter@5901af8b, org.greenhill.application.config.security.JwtTokenFilter@19098979, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@6df7193b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@57640814, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@bad144f, org.springframework.security.web.session.SessionManagementFilter@6921fa4d, org.springframework.security.web.access.ExceptionTranslationFilter@7a88c97f, org.springframework.security.web.access.intercept.AuthorizationFilter@7a98b997]] (1/1)\r\n2023-06-28T19:42:18.752+01:00 DEBUG 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing POST /error\r\n2023-06-28T19:42:18.752+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/12)\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/12)\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/12)\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (4/12)\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (5/12)\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Or [Ant [pattern=&#39;/logout&#39;, GET], Ant [pattern=&#39;/logout&#39;, POST], Ant [pattern=&#39;/logout&#39;, PUT], Ant [pattern=&#39;/logout&#39;, DELETE]]\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking JwtTokenFilter (6/12)\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (7/12)\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (8/12)\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (9/12)\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SessionManagementFilter (10/12)\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (11/12)\r\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (12/12)\r\n2023-06-28T19:42:18.754+01:00 TRACE 6970 --- [nio-8080-exec-4] estMatcherDelegatingAuthorizationManager : Authorizing SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.core.ApplicationHttpRequest@1ef57c0b]]\r\n2023-06-28T19:42:18.755+01:00 TRACE 6970 --- [nio-8080-exec-4] estMatcherDelegatingAuthorizationManager : Checking authorization on SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.core.ApplicationHttpRequest@1ef57c0b]] using org.springframework.security.authorization.AuthenticatedAuthorizationManager@e8f8395\r\n2023-06-28T19:42:18.755+01:00 TRACE 6970 --- [nio-8080-exec-4] .s.s.w.c.SupplierDeferredSecurityContext : Created SecurityContextImpl [Null authentication]\r\n2023-06-28T19:42:18.755+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to AnonymousAuthenticationToken [Principal=anonymousUser, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ANONYMOUS]]\r\n2023-06-28T19:42:18.756+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.a.ExceptionTranslationFilter     : Sending AnonymousAuthenticationToken [Principal=anonymousUser, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ANONYMOUS]] to authentication entry point since access is denied\r\n\r\norg.springframework.security.access.AccessDeniedException: Access Denied\r\n\tat org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:98) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:91) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.1.1.jar:6.1.1]\r\n\tat org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352) ~[spring-web-6.0.9.jar:6.0.9]\r\n\tat org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268) ~[spring-web-6.0.9.jar:6.0.9]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:642) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:410) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:340) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:277) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:358) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:222) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:151) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\r\n\tat java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]\r\n\r\n2023-06-28T19:42:18.763+01:00 DEBUG 6970 --- [nio-8080-exec-4] o.s.s.w.a.Http403ForbiddenEntryPoint     : Pre-authenticated entry point called. Rejecting access\r\n2023-06-28T19:42:22.075+01:00  INFO 6970 --- [ionShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit &#39;default&#39;\r\n2023-06-28T19:42:22.080+01:00  INFO 6970 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...\r\n2023-06-28T19:42:22.095+01:00  INFO 6970 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.\r\n\r\nProcess finished with exit code 130 (interrupted by signal 2: SIGINT)\r\n```\r\n\r\nThis is my SecurityConfig class:\r\n\r\n\r\n```\r\n@Configuration\r\n@EnableMethodSecurity\r\npublic class SecurityConfiguration {\r\n\r\n    private final AuthRepository authRepository;\r\n    private final JwtTokenFilter jwtTokenFilter;\r\n\r\n    public SecurityConfiguration(AuthRepository authRepository, JwtTokenFilter jwtTokenFilter) {\r\n        this.authRepository = authRepository;\r\n        this.jwtTokenFilter = jwtTokenFilter;\r\n    }\r\n\r\n    @Bean\r\n    public SecurityFilterChain jwtFilterChain(HttpSecurity http) throws Exception {\r\n        http.csrf(csrf -&gt; csrf.disable())\r\n                .authorizeHttpRequests(request -&gt; request.requestMatchers(&quot;/auth/**&quot;)\r\n                        .permitAll().anyRequest().authenticated())\r\n                .sessionManagement(manager -&gt; manager.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\r\n                .authenticationProvider(authenticationProvider())\r\n                .addFilterBefore(jwtTokenFilter, UsernamePasswordAuthenticationFilter.class);\r\n\r\n        return http.build();\r\n    }\r\n    @Bean\r\n    public PasswordEncoder passwordEncoder() {\r\n        return new BCryptPasswordEncoder();\r\n    }\r\n\r\n    @Bean\r\n    public AuthenticationProvider authenticationProvider() {\r\n        DaoAuthenticationProvider authProvider = new DaoAuthenticationProvider();\r\n        UserDetailsService userDetailsService = username -&gt; authRepository.findByEmail(username)\r\n                .orElseThrow(\r\n                        () -&gt; new UsernameNotFoundException(&quot;User &quot; + username + &quot; not found.&quot;));\r\n        authProvider.setUserDetailsService(userDetailsService);\r\n        authProvider.setPasswordEncoder(passwordEncoder());\r\n        return authProvider;\r\n    }\r\n\r\n    @Bean\r\n    public AuthenticationManager authenticationManager(AuthenticationConfiguration config)\r\n            throws Exception {\r\n        return config.getAuthenticationManager();\r\n    }\r\n}\r\n\r\n```\r\n\r\nThis is my JwtTokenFilter class\r\n\r\n\r\n```\r\n@Component\r\npublic class JwtTokenFilter extends OncePerRequestFilter {\r\n\r\n    private final JwtTokenUtil jwtTokenUtil;\r\n\r\n\r\n    public JwtTokenFilter(JwtTokenUtil jwtTokenUtil) {\r\n        this.jwtTokenUtil = jwtTokenUtil;\r\n    }\r\n\r\n    @Override\r\n    protected void doFilterInternal(HttpServletRequest request,\r\n                                    HttpServletResponse response, FilterChain filterChain)\r\n            throws ServletException, IOException {\r\n\r\n        if (!hasAuthorizationBearer(request)) {\r\n            filterChain.doFilter(request, response);\r\n            return;\r\n        }\r\n\r\n        String token = getAccessToken(request);\r\n\r\n        if (!jwtTokenUtil.validateAccessToken(token)) {\r\n            filterChain.doFilter(request, response);\r\n            return;\r\n        }\r\n\r\n        setAuthenticationContext(token, request);\r\n        filterChain.doFilter(request, response);\r\n    }\r\n\r\n    private boolean hasAuthorizationBearer(HttpServletRequest request) {\r\n        String header = request.getHeader(&quot;Authorization&quot;);\r\n        if (ObjectUtils.isEmpty(header) || !header.startsWith(&quot;Bearer&quot;)) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private String getAccessToken(HttpServletRequest request) {\r\n        String header = request.getHeader(&quot;Authorization&quot;);\r\n        String token = header.split(&quot; &quot;)[1].trim();\r\n        return token;\r\n    }\r\n\r\n    private void setAuthenticationContext(String token, HttpServletRequest request) {\r\n        UserDetails userDetails = getUserDetails(token);\r\n\r\n        UsernamePasswordAuthenticationToken\r\n                authentication = new UsernamePasswordAuthenticationToken(userDetails, null, null);\r\n\r\n        authentication.setDetails(\r\n                new WebAuthenticationDetailsSource().buildDetails(request));\r\n\r\n        SecurityContextHolder.getContext().setAuthentication(authentication);\r\n    }\r\n\r\n    private UserDetails getUserDetails(String token) {\r\n        Worker worker = new Worker();\r\n        String[] jwtSubject = jwtTokenUtil.getSubject(token).split(&quot;,&quot;);\r\n\r\n        worker.setId(UUID.fromString(jwtSubject[0]));\r\n        worker.setEmail(jwtSubject[1]);\r\n\r\n        return worker;\r\n    }\r\n}\r\n```\r\n\r\nWhen I call `/auth/sign-in` or `/auth/sign-up` it works perfecly.\r\nDoes anyone know what could be the issue here?\r\n\r\nFrom the logs above, apparently Spring Security is executing the same FilterChain twice. On the first time It can authenticate successfully, but the second time it doesn&#39;t and then the `AnonymousAuthenticationFilter` throws the Access Denied\r\n\r\nI tried calling my API in a path that is not `/auth/sign-in` or `/auth/sign-up`, and instead of getting 404 I&#39;m always getting 403 forbidden.","title":"Spring Security 6.1 returning 403 for non mapped API routes","body":"<p>I am using Spring Security with JWT authorization and recently I was trying to upgrade my Spring Security to the latest version (6.1.1), however for non-mapped API routes I'm getting always 403 Forbidden instead of 404 Not Found, even when setting the Authorization token correctly. I created a JWTFilter that is always called during the Authentication flow. If authenticated successfully it sets the Authentication object inside the context (see code paste below).</p>\n<p>I activated TRACE logging and this is the logs when I try to call a path tha wasn't mapped in the SecurityConfig.</p>\n<pre><code>2023-06-28T19:42:18.740+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain [RequestMatcher=any request, Filters=[org.springframework.security.web.session.DisableEncodeUrlFilter@4126cd58, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7ecd90ea, org.springframework.security.web.context.SecurityContextHolderFilter@e25af5a, org.springframework.security.web.header.HeaderWriterFilter@34734cf6, org.springframework.security.web.authentication.logout.LogoutFilter@5901af8b, org.greenhill.application.config.security.JwtTokenFilter@19098979, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@6df7193b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@57640814, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@bad144f, org.springframework.security.web.session.SessionManagementFilter@6921fa4d, org.springframework.security.web.access.ExceptionTranslationFilter@7a88c97f, org.springframework.security.web.access.intercept.AuthorizationFilter@7a98b997]] (1/1)\n2023-06-28T19:42:18.740+01:00 DEBUG 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing POST /test\n2023-06-28T19:42:18.740+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/12)\n2023-06-28T19:42:18.740+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/12)\n2023-06-28T19:42:18.740+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/12)\n2023-06-28T19:42:18.740+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (4/12)\n2023-06-28T19:42:18.741+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (5/12)\n2023-06-28T19:42:18.741+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Or [Ant [pattern='/logout', GET], Ant [pattern='/logout', POST], Ant [pattern='/logout', PUT], Ant [pattern='/logout', DELETE]]\n2023-06-28T19:42:18.741+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking JwtTokenFilter (6/12)\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] .s.s.w.c.SupplierDeferredSecurityContext : Created SecurityContextImpl [Null authentication]\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (7/12)\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (8/12)\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (9/12)\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SessionManagementFilter (10/12)\n2023-06-28T19:42:18.743+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.a.AnonymousAuthenticationFilter  : Did not set SecurityContextHolder since already authenticated UsernamePasswordAuthenticationToken [Principal=org.greenhill.auth.repository.entity.Worker@6586a89e, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[]]\n2023-06-28T19:42:18.744+01:00 TRACE 6970 --- [nio-8080-exec-4] s.CompositeSessionAuthenticationStrategy : Preparing session with ChangeSessionIdAuthenticationStrategy (1/1)\n2023-06-28T19:42:18.744+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (11/12)\n2023-06-28T19:42:18.744+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (12/12)\n2023-06-28T19:42:18.744+01:00 TRACE 6970 --- [nio-8080-exec-4] estMatcherDelegatingAuthorizationManager : Authorizing SecurityContextHolderAwareRequestWrapper[ org.springframework.security.web.header.HeaderWriterFilter$HeaderWriterRequest@61b920f6]\n2023-06-28T19:42:18.747+01:00 TRACE 6970 --- [nio-8080-exec-4] estMatcherDelegatingAuthorizationManager : Checking authorization on SecurityContextHolderAwareRequestWrapper[ org.springframework.security.web.header.HeaderWriterFilter$HeaderWriterRequest@61b920f6] using org.springframework.security.authorization.AuthenticatedAuthorizationManager@e8f8395\n2023-06-28T19:42:18.748+01:00 DEBUG 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured POST /test\n2023-06-28T19:42:18.749+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]\n2023-06-28T19:42:18.752+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain [RequestMatcher=any request, Filters=[org.springframework.security.web.session.DisableEncodeUrlFilter@4126cd58, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7ecd90ea, org.springframework.security.web.context.SecurityContextHolderFilter@e25af5a, org.springframework.security.web.header.HeaderWriterFilter@34734cf6, org.springframework.security.web.authentication.logout.LogoutFilter@5901af8b, org.greenhill.application.config.security.JwtTokenFilter@19098979, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@6df7193b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@57640814, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@bad144f, org.springframework.security.web.session.SessionManagementFilter@6921fa4d, org.springframework.security.web.access.ExceptionTranslationFilter@7a88c97f, org.springframework.security.web.access.intercept.AuthorizationFilter@7a98b997]] (1/1)\n2023-06-28T19:42:18.752+01:00 DEBUG 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing POST /error\n2023-06-28T19:42:18.752+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/12)\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/12)\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/12)\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (4/12)\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (5/12)\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Or [Ant [pattern='/logout', GET], Ant [pattern='/logout', POST], Ant [pattern='/logout', PUT], Ant [pattern='/logout', DELETE]]\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking JwtTokenFilter (6/12)\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (7/12)\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (8/12)\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (9/12)\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SessionManagementFilter (10/12)\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (11/12)\n2023-06-28T19:42:18.753+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (12/12)\n2023-06-28T19:42:18.754+01:00 TRACE 6970 --- [nio-8080-exec-4] estMatcherDelegatingAuthorizationManager : Authorizing SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.core.ApplicationHttpRequest@1ef57c0b]]\n2023-06-28T19:42:18.755+01:00 TRACE 6970 --- [nio-8080-exec-4] estMatcherDelegatingAuthorizationManager : Checking authorization on SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.core.ApplicationHttpRequest@1ef57c0b]] using org.springframework.security.authorization.AuthenticatedAuthorizationManager@e8f8395\n2023-06-28T19:42:18.755+01:00 TRACE 6970 --- [nio-8080-exec-4] .s.s.w.c.SupplierDeferredSecurityContext : Created SecurityContextImpl [Null authentication]\n2023-06-28T19:42:18.755+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to AnonymousAuthenticationToken [Principal=anonymousUser, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ANONYMOUS]]\n2023-06-28T19:42:18.756+01:00 TRACE 6970 --- [nio-8080-exec-4] o.s.s.w.a.ExceptionTranslationFilter     : Sending AnonymousAuthenticationToken [Principal=anonymousUser, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ANONYMOUS]] to authentication entry point since access is denied\n\norg.springframework.security.access.AccessDeniedException: Access Denied\n    at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:98) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:91) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.1.1.jar:6.1.1]\n    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352) ~[spring-web-6.0.9.jar:6.0.9]\n    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268) ~[spring-web-6.0.9.jar:6.0.9]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101) ~[spring-web-6.0.9.jar:6.0.9]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:642) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:410) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:340) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:277) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:358) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:222) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:151) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]\n    at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]\n\n2023-06-28T19:42:18.763+01:00 DEBUG 6970 --- [nio-8080-exec-4] o.s.s.w.a.Http403ForbiddenEntryPoint     : Pre-authenticated entry point called. Rejecting access\n2023-06-28T19:42:22.075+01:00  INFO 6970 --- [ionShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'\n2023-06-28T19:42:22.080+01:00  INFO 6970 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...\n2023-06-28T19:42:22.095+01:00  INFO 6970 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.\n\nProcess finished with exit code 130 (interrupted by signal 2: SIGINT)\n</code></pre>\n<p>This is my SecurityConfig class:</p>\n<pre><code>@Configuration\n@EnableMethodSecurity\npublic class SecurityConfiguration {\n\n    private final AuthRepository authRepository;\n    private final JwtTokenFilter jwtTokenFilter;\n\n    public SecurityConfiguration(AuthRepository authRepository, JwtTokenFilter jwtTokenFilter) {\n        this.authRepository = authRepository;\n        this.jwtTokenFilter = jwtTokenFilter;\n    }\n\n    @Bean\n    public SecurityFilterChain jwtFilterChain(HttpSecurity http) throws Exception {\n        http.csrf(csrf -&gt; csrf.disable())\n                .authorizeHttpRequests(request -&gt; request.requestMatchers(&quot;/auth/**&quot;)\n                        .permitAll().anyRequest().authenticated())\n                .sessionManagement(manager -&gt; manager.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\n                .authenticationProvider(authenticationProvider())\n                .addFilterBefore(jwtTokenFilter, UsernamePasswordAuthenticationFilter.class);\n\n        return http.build();\n    }\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n\n    @Bean\n    public AuthenticationProvider authenticationProvider() {\n        DaoAuthenticationProvider authProvider = new DaoAuthenticationProvider();\n        UserDetailsService userDetailsService = username -&gt; authRepository.findByEmail(username)\n                .orElseThrow(\n                        () -&gt; new UsernameNotFoundException(&quot;User &quot; + username + &quot; not found.&quot;));\n        authProvider.setUserDetailsService(userDetailsService);\n        authProvider.setPasswordEncoder(passwordEncoder());\n        return authProvider;\n    }\n\n    @Bean\n    public AuthenticationManager authenticationManager(AuthenticationConfiguration config)\n            throws Exception {\n        return config.getAuthenticationManager();\n    }\n}\n\n</code></pre>\n<p>This is my JwtTokenFilter class</p>\n<pre><code>@Component\npublic class JwtTokenFilter extends OncePerRequestFilter {\n\n    private final JwtTokenUtil jwtTokenUtil;\n\n\n    public JwtTokenFilter(JwtTokenUtil jwtTokenUtil) {\n        this.jwtTokenUtil = jwtTokenUtil;\n    }\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request,\n                                    HttpServletResponse response, FilterChain filterChain)\n            throws ServletException, IOException {\n\n        if (!hasAuthorizationBearer(request)) {\n            filterChain.doFilter(request, response);\n            return;\n        }\n\n        String token = getAccessToken(request);\n\n        if (!jwtTokenUtil.validateAccessToken(token)) {\n            filterChain.doFilter(request, response);\n            return;\n        }\n\n        setAuthenticationContext(token, request);\n        filterChain.doFilter(request, response);\n    }\n\n    private boolean hasAuthorizationBearer(HttpServletRequest request) {\n        String header = request.getHeader(&quot;Authorization&quot;);\n        if (ObjectUtils.isEmpty(header) || !header.startsWith(&quot;Bearer&quot;)) {\n            return false;\n        }\n\n        return true;\n    }\n\n    private String getAccessToken(HttpServletRequest request) {\n        String header = request.getHeader(&quot;Authorization&quot;);\n        String token = header.split(&quot; &quot;)[1].trim();\n        return token;\n    }\n\n    private void setAuthenticationContext(String token, HttpServletRequest request) {\n        UserDetails userDetails = getUserDetails(token);\n\n        UsernamePasswordAuthenticationToken\n                authentication = new UsernamePasswordAuthenticationToken(userDetails, null, null);\n\n        authentication.setDetails(\n                new WebAuthenticationDetailsSource().buildDetails(request));\n\n        SecurityContextHolder.getContext().setAuthentication(authentication);\n    }\n\n    private UserDetails getUserDetails(String token) {\n        Worker worker = new Worker();\n        String[] jwtSubject = jwtTokenUtil.getSubject(token).split(&quot;,&quot;);\n\n        worker.setId(UUID.fromString(jwtSubject[0]));\n        worker.setEmail(jwtSubject[1]);\n\n        return worker;\n    }\n}\n</code></pre>\n<p>When I call <code>/auth/sign-in</code> or <code>/auth/sign-up</code> it works perfecly.\nDoes anyone know what could be the issue here?</p>\n<p>From the logs above, apparently Spring Security is executing the same FilterChain twice. On the first time It can authenticate successfully, but the second time it doesn't and then the <code>AnonymousAuthenticationFilter</code> throws the Access Denied</p>\n<p>I tried calling my API in a path that is not <code>/auth/sign-in</code> or <code>/auth/sign-up</code>, and instead of getting 404 I'm always getting 403 forbidden.</p>\n"},{"tags":["java","httpserver","fileserver"],"comments":[{"owner":{"account_id":247613,"reputation":284089,"user_id":522444,"accept_rate":100,"display_name":"Hovercraft Full Of Eels"},"score":1,"creation_date":1694352630,"post_id":77076313,"comment_id":135877235,"body_markdown":"Maybe it&#39;s me, but I would think that this question would benefit from more detail, more *real* code, and removal of the GitHub link. All pertinent information should be in the question itself, such as a [mre] code post, and not in a link.","body":"Maybe it&#39;s me, but I would think that this question would benefit from more detail, more <i>real</i> code, and removal of the GitHub link. All pertinent information should be in the question itself, such as a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> code post, and not in a link."},{"owner":{"account_id":1927984,"reputation":357,"user_id":1738007,"display_name":"Tugalsan Karabacak"},"score":0,"creation_date":1694352989,"post_id":77076313,"comment_id":135877266,"body_markdown":"Oh, I thought I only use jdk classes. Did u see any legal issues?","body":"Oh, I thought I only use jdk classes. Did u see any legal issues?"},{"owner":{"account_id":247613,"reputation":284089,"user_id":522444,"accept_rate":100,"display_name":"Hovercraft Full Of Eels"},"score":1,"creation_date":1694353089,"post_id":77076313,"comment_id":135877276,"body_markdown":"What do you mean by &quot;legal issues&quot;? This site is a software Q&amp;A site and does not delve into legal issues, other than that intellectual property rights must be respected. That&#39;s it.","body":"What do you mean by &quot;legal issues&quot;? This site is a software Q&amp;A site and does not delve into legal issues, other than that intellectual property rights must be respected. That&#39;s it."},{"owner":{"account_id":1927984,"reputation":357,"user_id":1738007,"display_name":"Tugalsan Karabacak"},"score":0,"creation_date":1694353249,"post_id":77076313,"comment_id":135877286,"body_markdown":"To be safe I am removing github redirection.","body":"To be safe I am removing github redirection."}],"answers":[{"comments":[{"owner":{"account_id":1927984,"reputation":357,"user_id":1738007,"display_name":"Tugalsan Karabacak"},"score":0,"creation_date":1694371819,"post_id":77076425,"comment_id":135879170,"body_markdown":"Thank you. Before &quot;fileHandler.handle(exchange);&quot;, adding &quot;if (file not exists) return;&quot; helped a lot.","body":"Thank you. Before &quot;fileHandler.handle(exchange);&quot;, adding &quot;if (file not exists) return;&quot; helped a lot."}],"tags":[],"owner":{"account_id":27243397,"reputation":1331,"user_id":20769158,"display_name":"scrhartley"},"comment_count":1,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1694356096,"creation_date":1694354386,"answer_id":77076425,"question_id":77076313,"body_markdown":"If you put an index file (index.html or index.htm) in the directory, then that will be served, rather than the directory contents.\r\n\r\nOne more thing: you probably want a / at the end of the context path (so &quot;/file/&quot;) as per the note in the [API](https://docs.oracle.com/en/java/javase/17/docs/api/jdk.httpserver/com/sun/net/httpserver/HttpServer.html#createContext(java.lang.String,com.sun.net.httpserver.HttpHandler)):\r\n&gt; The path should generally, but is not required to, end with &#39;/&#39;. If the path does not end with &#39;/&#39;, eg such as with &quot;/foo&quot; then this would match requests with a path of &quot;/foobar&quot; or &quot;/foo/bar&quot;.\r\n\r\nAlternatively:\r\n```java\r\nvar server = HttpServer.create(new InetSocketAddress(8080), 2);\r\nvar fileHandler = SimpleFileServer.createFileHandler(Path.of(&quot;d:\\file&quot;));\r\nserver.createContext(&quot;/file/&quot;, (exchange) -&gt; {\r\n    if (exchange.getHttpContext().getPath().equals(exchange.getRequestURI().getPath())) {\r\n        try (exchange) {\r\n            exchange.setAttribute(&quot;request-path&quot;, &quot;could not resolve request URI path&quot;);\r\n            exchange.sendResponseHeaders(404, 0);\r\n        }\r\n    } else {\r\n        fileHandler.handle(exchange);\r\n    }\r\n});\r\nserver.start();\r\n```","title":"Java SimpleFileServer disable directory listing","body":"<p>If you put an index file (index.html or index.htm) in the directory, then that will be served, rather than the directory contents.</p>\n<p>One more thing: you probably want a / at the end of the context path (so &quot;/file/&quot;) as per the note in the <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/jdk.httpserver/com/sun/net/httpserver/HttpServer.html#createContext(java.lang.String,com.sun.net.httpserver.HttpHandler)\" rel=\"nofollow noreferrer\">API</a>:</p>\n<blockquote>\n<p>The path should generally, but is not required to, end with '/'. If the path does not end with '/', eg such as with &quot;/foo&quot; then this would match requests with a path of &quot;/foobar&quot; or &quot;/foo/bar&quot;.</p>\n</blockquote>\n<p>Alternatively:</p>\n<pre class=\"lang-java prettyprint-override\"><code>var server = HttpServer.create(new InetSocketAddress(8080), 2);\nvar fileHandler = SimpleFileServer.createFileHandler(Path.of(&quot;d:\\file&quot;));\nserver.createContext(&quot;/file/&quot;, (exchange) -&gt; {\n    if (exchange.getHttpContext().getPath().equals(exchange.getRequestURI().getPath())) {\n        try (exchange) {\n            exchange.setAttribute(&quot;request-path&quot;, &quot;could not resolve request URI path&quot;);\n            exchange.sendResponseHeaders(404, 0);\n        }\n    } else {\n        fileHandler.handle(exchange);\n    }\n});\nserver.start();\n</code></pre>\n"}],"owner":{"account_id":1927984,"reputation":357,"user_id":1738007,"display_name":"Tugalsan Karabacak"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":50,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":77076425,"answer_count":1,"score":0,"last_activity_date":1694356096,"creation_date":1694352528,"question_id":77076313,"body_markdown":"For a minimalistic SimpleFileServer pseudocode below, how to disable directory listing? \r\n~~~\r\nvar server = HttpsServer.create(new InetSocketAddress(port), 2)\r\nserver.createContext(&quot;/file&quot;, SimpleFileServer.createFileHandler(Path.of(&quot;d:\\file&quot;)));\r\nserver.start();\r\n~~~\r\n\r\n","title":"Java SimpleFileServer disable directory listing","body":"<p>For a minimalistic SimpleFileServer pseudocode below, how to disable directory listing?</p>\n<pre><code>var server = HttpsServer.create(new InetSocketAddress(port), 2)\nserver.createContext(&quot;/file&quot;, SimpleFileServer.createFileHandler(Path.of(&quot;d:\\file&quot;)));\nserver.start();\n</code></pre>\n"},{"tags":["java","casting","primitive-types","jshell"],"comments":[{"owner":{"account_id":2792262,"reputation":163877,"user_id":2402272,"accept_rate":85,"display_name":"John Bollinger"},"score":0,"creation_date":1694354810,"post_id":77076404,"comment_id":135877430,"body_markdown":"Because of automatic promotion of your `byte` operands to type `int`, and the results of the `-` operations therefore being of type `int`.","body":"Because of automatic promotion of your <code>byte</code> operands to type <code>int</code>, and the results of the <code>-</code> operations therefore being of type <code>int</code>."},{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":1,"creation_date":1694354890,"post_id":77076404,"comment_id":135877437,"body_markdown":"You need to read the 2nd duplink to understand why `byte val = 200 - 200;` is allowed.  (And it isn&#39;t a bug in jshell.  The JLS says it is valid.)","body":"You need to read the 2nd duplink to understand why <code>byte val = 200 - 200;</code> is allowed.  (And it isn&#39;t a bug in jshell.  The JLS says it is valid.)"},{"owner":{"account_id":162699,"reputation":138060,"user_id":3788176,"accept_rate":54,"display_name":"Andy Turner"},"score":0,"creation_date":1694361119,"post_id":77076404,"comment_id":135878131,"body_markdown":"The critical thing here is that your variable isn&#39;t `final`, thus its value is not considered a constant expression, even if you never change its value once assigned.","body":"The critical thing here is that your variable isn&#39;t <code>final</code>, thus its value is not considered a constant expression, even if you never change its value once assigned."}],"answers":[{"comments":[{"owner":{"account_id":162699,"reputation":138060,"user_id":3788176,"accept_rate":54,"display_name":"Andy Turner"},"score":1,"creation_date":1694360954,"post_id":77076450,"comment_id":135878113,"body_markdown":"You&#39;ll need to expand a bit to explain why `byte val = 200 - 200;` is allowed.","body":"You&#39;ll need to expand a bit to explain why <code>byte val = 200 - 200;</code> is allowed."}],"tags":[],"owner":{"account_id":2656033,"reputation":47,"user_id":2296720,"accept_rate":100,"display_name":"FreackH"},"comment_count":1,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1694354839,"creation_date":1694354839,"answer_id":77076450,"question_id":77076404,"body_markdown":"Java automatically promotes each `byte`, `short`, or `char` operand to `int` when evaluating an expression. Because the operands are automatically promoted to `int` when the expression is evaluated, the result also gets promoted to `int`. Thus, the result of the expression is now of type `int`, which cannot be assigned to a `byte` without the use of a cast.","title":"What are rules in casting primitive types in expressions in Java?","body":"<p>Java automatically promotes each <code>byte</code>, <code>short</code>, or <code>char</code> operand to <code>int</code> when evaluating an expression. Because the operands are automatically promoted to <code>int</code> when the expression is evaluated, the result also gets promoted to <code>int</code>. Thus, the result of the expression is now of type <code>int</code>, which cannot be assigned to a <code>byte</code> without the use of a cast.</p>\n"}],"owner":{"account_id":12471496,"reputation":59,"user_id":9079439,"display_name":"Argos"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":55,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"closed_date":1694354681,"answer_count":1,"score":-2,"last_activity_date":1694355314,"creation_date":1694354026,"question_id":77076404,"body_markdown":"I&#39;m trying to figure out why some castings work and why others do not. Can you explain to me why some of these examples work and others don&#39;t?\r\n\r\n\r\n**Setup:**\r\n\r\nI&#39;m using jshell.\r\n\r\n    byte one = 1;\r\n    one ==&gt; 1\r\n**Example 1:**\r\n\r\n    jshell&gt; byte val = 200 - 200;\r\n    val ==&gt; 0\r\nAccording to my knowledge these literals are of type int, but code compiles because the result fits in the byte.\r\n\r\n\r\n**Example 2**\r\n\r\n    jshell&gt; byte val = 1 - one;\r\n    |  Error:\r\n    |  incompatible types: possible lossy conversion from int to byte\r\n    |  byte val = 1 - one;\r\n    |             ^-----^\r\nWhen I&#39;m switching one literal to a variable, code suddenly does not compile. Casting any or all of components of the espression doesn&#39;t fix the problem. \r\n\r\n**Example 3**\r\n```\r\njshell&gt; byte val = (byte)(1) - one;\r\n|  Error:\r\n|  incompatible types: possible lossy conversion from int to byte\r\n|  byte val = (byte)(1) - one;\r\n|     \r\n```\r\nI expected this to work. After all I did convert the integer in this expression to byte, so there shouldn&#39;t be &#39;incompatible types&#39; error.\r\n\r\n**Example 4**\r\n```\r\njshell&gt; byte val = 1 - (byte)(one);\r\n|  Error:\r\n|  incompatible types: possible lossy conversion from int to byte\r\n|  byte val = 1 - (byte)(one);\r\n|             ^-------------^\r\n```\r\nThis was more an experiment to see if this would fix the problem. I didn&#39;t expect this to work.\r\n\r\n**Example 5**\r\n\r\n```\r\njshell&gt; byte val = (byte)(1) - (byte)(one);\r\n|  Error:\r\n|  incompatible types: possible lossy conversion from int to byte\r\n|  byte val = (byte)(1) - (byte)(one);\r\n|             ^---------------------^\r\n```\r\nThis one confuses me so much. I&#39;m casting both components to byte, so why would there be an error? After all in Example 1 there was a similar operation and Java didn&#39;t complain at all. \r\n\r\n**Example 6**\r\n```\r\njshell&gt; byte val = (byte)(1 - one);\r\nval ==&gt; 0\r\n```\r\nIn the end only casting result of the expression doesn&#39;t produce an error. Why?\r\n","title":"What are rules in casting primitive types in expressions in Java?","body":"<p>I'm trying to figure out why some castings work and why others do not. Can you explain to me why some of these examples work and others don't?</p>\n<p><strong>Setup:</strong></p>\n<p>I'm using jshell.</p>\n<pre><code>byte one = 1;\none ==&gt; 1\n</code></pre>\n<p><strong>Example 1:</strong></p>\n<pre><code>jshell&gt; byte val = 200 - 200;\nval ==&gt; 0\n</code></pre>\n<p>According to my knowledge these literals are of type int, but code compiles because the result fits in the byte.</p>\n<p><strong>Example 2</strong></p>\n<pre><code>jshell&gt; byte val = 1 - one;\n|  Error:\n|  incompatible types: possible lossy conversion from int to byte\n|  byte val = 1 - one;\n|             ^-----^\n</code></pre>\n<p>When I'm switching one literal to a variable, code suddenly does not compile. Casting any or all of components of the espression doesn't fix the problem.</p>\n<p><strong>Example 3</strong></p>\n<pre><code>jshell&gt; byte val = (byte)(1) - one;\n|  Error:\n|  incompatible types: possible lossy conversion from int to byte\n|  byte val = (byte)(1) - one;\n|     \n</code></pre>\n<p>I expected this to work. After all I did convert the integer in this expression to byte, so there shouldn't be 'incompatible types' error.</p>\n<p><strong>Example 4</strong></p>\n<pre><code>jshell&gt; byte val = 1 - (byte)(one);\n|  Error:\n|  incompatible types: possible lossy conversion from int to byte\n|  byte val = 1 - (byte)(one);\n|             ^-------------^\n</code></pre>\n<p>This was more an experiment to see if this would fix the problem. I didn't expect this to work.</p>\n<p><strong>Example 5</strong></p>\n<pre><code>jshell&gt; byte val = (byte)(1) - (byte)(one);\n|  Error:\n|  incompatible types: possible lossy conversion from int to byte\n|  byte val = (byte)(1) - (byte)(one);\n|             ^---------------------^\n</code></pre>\n<p>This one confuses me so much. I'm casting both components to byte, so why would there be an error? After all in Example 1 there was a similar operation and Java didn't complain at all.</p>\n<p><strong>Example 6</strong></p>\n<pre><code>jshell&gt; byte val = (byte)(1 - one);\nval ==&gt; 0\n</code></pre>\n<p>In the end only casting result of the expression doesn't produce an error. Why?</p>\n"},{"tags":["java","spring","jpa","javabeans","autowired"],"comments":[{"owner":{"account_id":15539213,"reputation":346,"user_id":11210547,"display_name":"P&#233;ter Bar&#225;th"},"score":0,"creation_date":1673437442,"post_id":64813071,"comment_id":132497821,"body_markdown":"Does the courseDAO derive from an interface?","body":"Does the courseDAO derive from an interface?"}],"answers":[{"tags":[],"owner":{"account_id":9983336,"reputation":4132,"user_id":7769052,"accept_rate":75,"display_name":"banan3&#39;14"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694355053,"creation_date":1694326996,"answer_id":77075014,"question_id":64813071,"body_markdown":"If you do name your bean `entityManagerFactory` it might break other beans that depend on the type of it to be Hibernate `EntityManagerFactory`. Rename it to for example `localContainerEntityManagerFactory`.","title":"Bean is expected to be of type &#39;CourseDAO&#39; but was actually of type &#39;com.sun.proxy.$Proxy49&#39;","body":"<p>If you do name your bean <code>entityManagerFactory</code> it might break other beans that depend on the type of it to be Hibernate <code>EntityManagerFactory</code>. Rename it to for example <code>localContainerEntityManagerFactory</code>.</p>\n"}],"owner":{"account_id":6678616,"reputation":528,"user_id":5152519,"accept_rate":100,"display_name":"Danny"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1360,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1694355053,"creation_date":1605221826,"question_id":64813071,"body_markdown":"In a training Spring MVC + JPA/Hibernate project, I&#39;m getting the error in question, after I&#39;ve changed my configuration.\r\n\r\nOriginally the DAO class was like this:\r\n\r\n```\r\npublic Course getById(Integer id) throws DAOException {\r\n        Course result = null;\r\n        try {\r\n            EntityManager em = emf.getFactory().createEntityManager();\r\n            result = em.find(Course.class, id);\r\n        } catch (Exception e) {\r\n            logger.error(e.getMessage(), e);\r\n            throw new DAOException(&quot;Could not get Course By Id&quot;, e);\r\n        }\r\n        return result;\r\n    }\r\n```\r\n\r\nI was told to spawn *EntityManager* with `@PersistenceContext`, and avoid creating new EntityManager every now and then. So I replaced the above `EntityManager em = ...` line with a `@Autowired EntityManager em;` field, and changed the JpaConfig class, so it looks like:\r\n\r\n```\r\n@Configuration\r\n@ComponentScan(basePackages = &quot;com.example.school&quot;)\r\n@PropertySource(&quot;classpath:database.properties&quot;)\r\n@EnableTransactionManagement\r\npublic class JpaConfig {\r\n    private final Environment environment;\r\n\r\n    @Autowired\r\n    public JpaConfig(Environment environment) {\r\n        this.environment = environment;\r\n    }\r\n\r\n    @Autowired\r\n    DataSource dataSource;\r\n    \r\n    @Bean\r\n    public LocalContainerEntityManagerFactoryBean entityManagerFactory() throws NamingException {\r\n        LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();\r\n        em.setDataSource(dataSource);\r\n        em.setPackagesToScan(&quot;com.example.school&quot;);\r\n        JpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();\r\n        em.setJpaVendorAdapter(vendorAdapter);\r\n        return em;\r\n    }\r\n\r\n    @Bean\r\n    public PlatformTransactionManager transactionManager(EntityManagerFactory emf) {\r\n        JpaTransactionManager transactionManager = new JpaTransactionManager();\r\n        transactionManager.setEntityManagerFactory(emf);\r\n        return transactionManager;\r\n    }\r\n\r\n    @Bean\r\n    public PersistenceExceptionTranslationPostProcessor exceptionTranslation() {\r\n        return new PersistenceExceptionTranslationPostProcessor();\r\n    }\r\n}\r\n```\r\n\r\nWhile previously the configuration file was that simple:\r\n\r\n```\r\n@Configuration\r\npublic class EntityManagerConfig {\r\n    EntityManagerFactory emf = Persistence.createEntityManagerFactory(&quot;PU&quot;);\r\n\r\n    @Bean\r\n    EntityManager em() {\r\n        return emf.createEntityManager();\r\n    }\r\n}\r\n```\r\n\r\nNow I get a stacktrace with the following most important problem in it:\r\n\r\norg.springframework.beans.factory.UnsatisfiedDependencyException ...\r\n\r\n...\r\n\r\nCaused by: org.springframework.beans.factory.BeanNotOfRequiredTypeException: Bean named &#39;courseDAO&#39; is expected to be of type &#39;com.example.school.dao.CourseDAO&#39; but was actually of type &#39;com.sun.proxy.$Proxy49&#39;\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1317)\r\n\r\nWhat can be wrong about this configuration?","title":"Bean is expected to be of type &#39;CourseDAO&#39; but was actually of type &#39;com.sun.proxy.$Proxy49&#39;","body":"<p>In a training Spring MVC + JPA/Hibernate project, I'm getting the error in question, after I've changed my configuration.</p>\n<p>Originally the DAO class was like this:</p>\n<pre><code>public Course getById(Integer id) throws DAOException {\n        Course result = null;\n        try {\n            EntityManager em = emf.getFactory().createEntityManager();\n            result = em.find(Course.class, id);\n        } catch (Exception e) {\n            logger.error(e.getMessage(), e);\n            throw new DAOException(&quot;Could not get Course By Id&quot;, e);\n        }\n        return result;\n    }\n</code></pre>\n<p>I was told to spawn <em>EntityManager</em> with <code>@PersistenceContext</code>, and avoid creating new EntityManager every now and then. So I replaced the above <code>EntityManager em = ...</code> line with a <code>@Autowired EntityManager em;</code> field, and changed the JpaConfig class, so it looks like:</p>\n<pre><code>@Configuration\n@ComponentScan(basePackages = &quot;com.example.school&quot;)\n@PropertySource(&quot;classpath:database.properties&quot;)\n@EnableTransactionManagement\npublic class JpaConfig {\n    private final Environment environment;\n\n    @Autowired\n    public JpaConfig(Environment environment) {\n        this.environment = environment;\n    }\n\n    @Autowired\n    DataSource dataSource;\n    \n    @Bean\n    public LocalContainerEntityManagerFactoryBean entityManagerFactory() throws NamingException {\n        LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();\n        em.setDataSource(dataSource);\n        em.setPackagesToScan(&quot;com.example.school&quot;);\n        JpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();\n        em.setJpaVendorAdapter(vendorAdapter);\n        return em;\n    }\n\n    @Bean\n    public PlatformTransactionManager transactionManager(EntityManagerFactory emf) {\n        JpaTransactionManager transactionManager = new JpaTransactionManager();\n        transactionManager.setEntityManagerFactory(emf);\n        return transactionManager;\n    }\n\n    @Bean\n    public PersistenceExceptionTranslationPostProcessor exceptionTranslation() {\n        return new PersistenceExceptionTranslationPostProcessor();\n    }\n}\n</code></pre>\n<p>While previously the configuration file was that simple:</p>\n<pre><code>@Configuration\npublic class EntityManagerConfig {\n    EntityManagerFactory emf = Persistence.createEntityManagerFactory(&quot;PU&quot;);\n\n    @Bean\n    EntityManager em() {\n        return emf.createEntityManager();\n    }\n}\n</code></pre>\n<p>Now I get a stacktrace with the following most important problem in it:</p>\n<p>org.springframework.beans.factory.UnsatisfiedDependencyException ...</p>\n<p>...</p>\n<p>Caused by: org.springframework.beans.factory.BeanNotOfRequiredTypeException: Bean named 'courseDAO' is expected to be of type 'com.example.school.dao.CourseDAO' but was actually of type 'com.sun.proxy.$Proxy49'\nat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1317)</p>\n<p>What can be wrong about this configuration?</p>\n"},{"tags":["java","spring","spring-mvc","session","spring-security"],"answers":[{"tags":[],"owner":{"account_id":3948767,"reputation":761,"user_id":4568220,"accept_rate":44,"display_name":"raju vaishnav"},"comment_count":0,"down_vote_count":0,"up_vote_count":18,"is_accepted":true,"score":18,"last_activity_date":1461392723,"creation_date":1461392723,"answer_id":36807445,"question_id":36795678,"body_markdown":"I was able to solve above issue by adding below config in web.xml only. any better way will be accepted.\r\n\r\n\r\n     &lt;session-config&gt;\r\n        &lt;session-timeout&gt;20&lt;/session-timeout&gt;\r\n    &lt;/session-config&gt;","title":"How to enable session and set session timeout in Spring Security","body":"<p>I was able to solve above issue by adding below config in web.xml only. any better way will be accepted.</p>\n\n<pre><code> &lt;session-config&gt;\n    &lt;session-timeout&gt;20&lt;/session-timeout&gt;\n&lt;/session-config&gt;\n</code></pre>\n"},{"comments":[{"owner":{"account_id":3305465,"reputation":638,"user_id":2780428,"accept_rate":100,"display_name":"Alic"},"score":3,"creation_date":1486154770,"post_id":37219356,"comment_id":71240007,"body_markdown":"You can also add the listener as a bean, in case you start up your application in a different way.","body":"You can also add the listener as a bean, in case you start up your application in a different way."},{"owner":{"account_id":11114265,"reputation":168,"user_id":8159014,"display_name":"jeevanswamy21"},"score":0,"creation_date":1510219404,"post_id":37219356,"comment_id":81344713,"body_markdown":"super.onStartup(servletContext); its not taking showing error in intializer","body":"super.onStartup(servletContext); its not taking showing error in intializer"},{"owner":{"account_id":9216321,"reputation":486,"user_id":6847323,"accept_rate":14,"display_name":"srinivas gowda"},"score":0,"creation_date":1521308429,"post_id":37219356,"comment_id":85680012,"body_markdown":"Hi @munilvc  session is create onStartup is fine.. when trying track user session, the session time should start after Logged in right","body":"Hi @munilvc  session is create onStartup is fine.. when trying track user session, the session time should start after Logged in right"},{"owner":{"account_id":15316701,"reputation":99,"user_id":11050399,"display_name":"ashwin"},"score":3,"creation_date":1553854611,"post_id":37219356,"comment_id":97549209,"body_markdown":"in which class should i use void onStartup function","body":"in which class should i use void onStartup function"}],"tags":[],"owner":{"account_id":3925872,"reputation":522,"user_id":3246375,"accept_rate":43,"display_name":"munilvc"},"comment_count":4,"down_vote_count":0,"up_vote_count":35,"is_accepted":false,"score":35,"last_activity_date":1509633451,"creation_date":1463173764,"answer_id":37219356,"question_id":36795678,"body_markdown":"If you are using [JavaConfig][1] and do not want to use XML you can create a `HttpSessionListener` and use `getSession().setMaxInactiveInterval()`, then in the `Initializer` add the listener in `onStartup()`:\r\n\r\n    public class SessionListener implements HttpSessionListener {\r\n    \r\n        @Override\r\n        public void sessionCreated(HttpSessionEvent event) {\r\n            System.out.println(&quot;session created&quot;);\r\n            event.getSession().setMaxInactiveInterval(15);\r\n        }\r\n    \r\n        @Override\r\n        public void sessionDestroyed(HttpSessionEvent event) {\r\n           System.out.println(&quot;session destroyed&quot;);\r\n        }\r\n    }\r\n\r\nThen in the Initializer:\r\n\r\n    @Override\r\n    public void onStartup(ServletContext servletContext) throws ServletException {\r\n        super.onStartup(servletContext);\r\n        servletContext.addListener(new SessionListener());\r\n    }\r\n\r\n\r\n  [1]: https://docs.spring.io/spring-javaconfig/docs/1.0.0.M4/reference/html/","title":"How to enable session and set session timeout in Spring Security","body":"<p>If you are using <a href=\"https://docs.spring.io/spring-javaconfig/docs/1.0.0.M4/reference/html/\" rel=\"noreferrer\">JavaConfig</a> and do not want to use XML you can create a <code>HttpSessionListener</code> and use <code>getSession().setMaxInactiveInterval()</code>, then in the <code>Initializer</code> add the listener in <code>onStartup()</code>:</p>\n\n<pre><code>public class SessionListener implements HttpSessionListener {\n\n    @Override\n    public void sessionCreated(HttpSessionEvent event) {\n        System.out.println(\"session created\");\n        event.getSession().setMaxInactiveInterval(15);\n    }\n\n    @Override\n    public void sessionDestroyed(HttpSessionEvent event) {\n       System.out.println(\"session destroyed\");\n    }\n}\n</code></pre>\n\n<p>Then in the Initializer:</p>\n\n<pre><code>@Override\npublic void onStartup(ServletContext servletContext) throws ServletException {\n    super.onStartup(servletContext);\n    servletContext.addListener(new SessionListener());\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":942759,"reputation":469,"user_id":970544,"accept_rate":93,"display_name":"coms"},"score":15,"creation_date":1531841349,"post_id":49701303,"comment_id":89742305,"body_markdown":"`server.servlet.session.timeout=` helped me. List of common properties: https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html","body":"<code>server.servlet.session.timeout=</code> helped me. List of common properties: <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html\" rel=\"nofollow noreferrer\">docs.spring.io/spring-boot/docs/current/reference/html/&hellip;</a>"}],"tags":[],"owner":{"account_id":74193,"reputation":4313,"user_id":213292,"accept_rate":40,"display_name":"JJ Roman"},"comment_count":1,"down_vote_count":1,"up_vote_count":16,"is_accepted":false,"score":15,"last_activity_date":1523050625,"creation_date":1523050625,"answer_id":49701303,"question_id":36795678,"body_markdown":"When using application.properties set property `server.session.timeout=` value is in seconds.","title":"How to enable session and set session timeout in Spring Security","body":"<p>When using application.properties set property <code>server.session.timeout=</code> value is in seconds.</p>\n"},{"tags":[],"owner":{"account_id":3364917,"reputation":3325,"user_id":2825798,"display_name":"PraveenKumar Lalasangi"},"comment_count":0,"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1694354284,"creation_date":1566418368,"answer_id":57598611,"question_id":36795678,"body_markdown":"Different ways to configure session timeout time(maxInactiveInterval) in spring security.\r\n\r\n&lt;b&gt; 1. By addinng session config in web.xml(from raju vaishnav&#39;s answer)&lt;/b&gt;\r\n\r\n&lt;b&gt; 2. By creating implementation of HttpSessionListener and adding it to servlet context.(from munilvc&#39;s answer)&lt;/b&gt;\r\n### 3. By registering your custom AuthenticationSuccessHandler in spring security configuration, and setting session maximum inactive interval in onAuthenticationSuccess method.\r\nThis implementation has advantages\r\n\r\n1. On login success, You can set different value of maxInactiveInterval for different roles/users.\r\n\r\n2. On login success, you can set user object in session, hence user object can be accessed in any controller from session.\r\n\r\nDisadvantage: You can not set session timeout for ANONYMOUS user(Un-authenticated user)\r\n\r\nCreate AuthenticationSuccessHandler Handler\r\n```java\r\npublic class MyAuthenticationSuccessHandler implements AuthenticationSuccessHandler\r\n{\r\n\r\n\tpublic void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication)\r\n\t\t\tthrows IOException \r\n\t{\r\n        Set&lt;String&gt; roles = AuthorityUtils.authorityListToSet(authentication.getAuthorities());\r\n        if (roles.contains(&quot;ROLE_ADMIN&quot;))\r\n        {\r\n        \trequest.getSession(false).setMaxInactiveInterval(60);\r\n        }\r\n        else\r\n        {\r\n        \trequest.getSession(false).setMaxInactiveInterval(120);\r\n        }\r\n        //Your login success url goes here, currently login success url=&quot;/&quot;\r\n        response.sendRedirect(request.getContextPath());\r\n    }\r\n}\r\n```\r\nRegister success handler\r\n\r\nIn Java Config way\r\n```java\r\n@Override\r\nprotected void configure(final HttpSecurity http) throws Exception\r\n{\r\n\thttp\r\n\t\t.authorizeRequests()\r\n\t\t\t.antMatchers(&quot;/resources/**&quot;, &quot;/login&quot;).permitAll()\r\n\t\t\t.antMatchers(&quot;/app/admin/*&quot;).hasRole(&quot;ADMIN&quot;)\r\n\t\t\t.antMatchers(&quot;/app/user/*&quot;, &quot;/&quot;).hasAnyRole(&quot;ADMIN&quot;, &quot;USER&quot;)\r\n\t\t.and().exceptionHandling().accessDeniedPage(&quot;/403&quot;)\r\n\t\t.and().formLogin()\r\n\t\t\t.loginPage(&quot;/login&quot;).usernameParameter(&quot;userName&quot;)\r\n\t\t\t.passwordParameter(&quot;password&quot;)\r\n\t\t\t.successHandler(new MyAuthenticationSuccessHandler())\r\n\t\t\t.failureUrl(&quot;/login?error=true&quot;)\r\n\t\t.and().logout()\r\n\t\t\t.logoutSuccessHandler(new CustomLogoutSuccessHandler())\r\n\t\t\t.invalidateHttpSession(true)\r\n\t\t.and().csrf().disable();\r\n\r\n\thttp.sessionManagement().maximumSessions(1).expiredUrl(&quot;/login?expired=true&quot;);\r\n}\r\n```\r\nIn xml config way\r\n```xml\r\n&lt;http auto-config=&quot;true&quot; use-expressions=&quot;true&quot; create-session=&quot;ifRequired&quot;&gt;\r\n\t&lt;csrf disabled=&quot;true&quot;/&gt;\r\n\r\n\t&lt;intercept-url pattern=&quot;/resources/**&quot; access=&quot;permitAll&quot; /&gt;\r\n\t&lt;intercept-url pattern=&quot;/login&quot; access=&quot;permitAll&quot; /&gt;\r\n\r\n\t&lt;intercept-url pattern=&quot;/app/admin/*&quot; access=&quot;hasRole(&#39;ROLE_ADMIN&#39;)&quot; /&gt;\r\n\t&lt;intercept-url pattern=&quot;/&quot; access=&quot;hasAnyRole(&#39;ROLE_USER&#39;, &#39;ROLE_ADMIN&#39;)&quot; /&gt;\r\n\t&lt;intercept-url pattern=&quot;/app/user/*&quot; access=&quot;hasAnyRole(&#39;ROLE_USER&#39;, &#39;ROLE_ADMIN&#39;)&quot; /&gt;\r\n\r\n\t&lt;access-denied-handler error-page=&quot;/403&quot; /&gt;\r\n\r\n\t&lt;form-login \r\n\t    login-page=&quot;/login&quot;\r\n\t    authentication-success-handler-ref=&quot;authenticationSuccessHandler&quot;\r\n\t    authentication-failure-url=&quot;/login?error=true&quot; \r\n\t    username-parameter=&quot;userName&quot;\r\n\t    password-parameter=&quot;password&quot; /&gt;\r\n\r\n\t&lt;logout invalidate-session=&quot;false&quot; success-handler-ref=&quot;customLogoutSuccessHandler&quot;/&gt;\r\n\r\n\t&lt;session-management invalid-session-url=&quot;/login?expired=true&quot;&gt;\r\n\t\t&lt;concurrency-control max-sessions=&quot;1&quot; /&gt;\r\n\t&lt;/session-management&gt;\r\n &lt;/http&gt;\r\n \r\n &lt;beans:bean id=&quot;authenticationSuccessHandler&quot; class=&quot;com.pvn.mvctiles.configuration.MyAuthenticationSuccessHandler&quot; /&gt;\r\n \r\n ```\r\n\r\nWorking code is available in [my github repository](https://github.com/nlpraveennl/stackoverflow-answer-reference/)\r\nWorking code is available in two forms\r\n\r\n[1. XML config way of implementation](https://github.com/nlpraveennl/stackoverflow-answer-reference/tree/master/springsecurity-auth-success-handler-xmlconfig)\r\n\r\n[2. JAVA config way of implementation](https://github.com/nlpraveennl/stackoverflow-answer-reference/tree/master/springsecurity-auth-success-handler-javaconfig)\r\n\r\nIf you want to have automatic logout feature and timer which displays when session is about to expire, if user is filling form but not submitted then user can extend session by clicking on keep session alive button.\r\nIf you want to implement auto logout refer [stack overflow answer on auto logout on session timeout](https://stackoverflow.com/a/57598264/2825798). Hope this will help.\r\n\r\n\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/gF7el.png","title":"How to enable session and set session timeout in Spring Security","body":"<p>Different ways to configure session timeout time(maxInactiveInterval) in spring security.</p>\n<p><b> 1. By addinng session config in web.xml(from raju vaishnav's answer)</b></p>\n<p><b> 2. By creating implementation of HttpSessionListener and adding it to servlet context.(from munilvc's answer)</b></p>\n<h3>3. By registering your custom AuthenticationSuccessHandler in spring security configuration, and setting session maximum inactive interval in onAuthenticationSuccess method.</h3>\n<p>This implementation has advantages</p>\n<ol>\n<li><p>On login success, You can set different value of maxInactiveInterval for different roles/users.</p>\n</li>\n<li><p>On login success, you can set user object in session, hence user object can be accessed in any controller from session.</p>\n</li>\n</ol>\n<p>Disadvantage: You can not set session timeout for ANONYMOUS user(Un-authenticated user)</p>\n<p>Create AuthenticationSuccessHandler Handler</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class MyAuthenticationSuccessHandler implements AuthenticationSuccessHandler\n{\n\n    public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication)\n            throws IOException \n    {\n        Set&lt;String&gt; roles = AuthorityUtils.authorityListToSet(authentication.getAuthorities());\n        if (roles.contains(&quot;ROLE_ADMIN&quot;))\n        {\n            request.getSession(false).setMaxInactiveInterval(60);\n        }\n        else\n        {\n            request.getSession(false).setMaxInactiveInterval(120);\n        }\n        //Your login success url goes here, currently login success url=&quot;/&quot;\n        response.sendRedirect(request.getContextPath());\n    }\n}\n</code></pre>\n<p>Register success handler</p>\n<p>In Java Config way</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Override\nprotected void configure(final HttpSecurity http) throws Exception\n{\n    http\n        .authorizeRequests()\n            .antMatchers(&quot;/resources/**&quot;, &quot;/login&quot;).permitAll()\n            .antMatchers(&quot;/app/admin/*&quot;).hasRole(&quot;ADMIN&quot;)\n            .antMatchers(&quot;/app/user/*&quot;, &quot;/&quot;).hasAnyRole(&quot;ADMIN&quot;, &quot;USER&quot;)\n        .and().exceptionHandling().accessDeniedPage(&quot;/403&quot;)\n        .and().formLogin()\n            .loginPage(&quot;/login&quot;).usernameParameter(&quot;userName&quot;)\n            .passwordParameter(&quot;password&quot;)\n            .successHandler(new MyAuthenticationSuccessHandler())\n            .failureUrl(&quot;/login?error=true&quot;)\n        .and().logout()\n            .logoutSuccessHandler(new CustomLogoutSuccessHandler())\n            .invalidateHttpSession(true)\n        .and().csrf().disable();\n\n    http.sessionManagement().maximumSessions(1).expiredUrl(&quot;/login?expired=true&quot;);\n}\n</code></pre>\n<p>In xml config way</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;http auto-config=&quot;true&quot; use-expressions=&quot;true&quot; create-session=&quot;ifRequired&quot;&gt;\n    &lt;csrf disabled=&quot;true&quot;/&gt;\n\n    &lt;intercept-url pattern=&quot;/resources/**&quot; access=&quot;permitAll&quot; /&gt;\n    &lt;intercept-url pattern=&quot;/login&quot; access=&quot;permitAll&quot; /&gt;\n\n    &lt;intercept-url pattern=&quot;/app/admin/*&quot; access=&quot;hasRole('ROLE_ADMIN')&quot; /&gt;\n    &lt;intercept-url pattern=&quot;/&quot; access=&quot;hasAnyRole('ROLE_USER', 'ROLE_ADMIN')&quot; /&gt;\n    &lt;intercept-url pattern=&quot;/app/user/*&quot; access=&quot;hasAnyRole('ROLE_USER', 'ROLE_ADMIN')&quot; /&gt;\n\n    &lt;access-denied-handler error-page=&quot;/403&quot; /&gt;\n\n    &lt;form-login \n        login-page=&quot;/login&quot;\n        authentication-success-handler-ref=&quot;authenticationSuccessHandler&quot;\n        authentication-failure-url=&quot;/login?error=true&quot; \n        username-parameter=&quot;userName&quot;\n        password-parameter=&quot;password&quot; /&gt;\n\n    &lt;logout invalidate-session=&quot;false&quot; success-handler-ref=&quot;customLogoutSuccessHandler&quot;/&gt;\n\n    &lt;session-management invalid-session-url=&quot;/login?expired=true&quot;&gt;\n        &lt;concurrency-control max-sessions=&quot;1&quot; /&gt;\n    &lt;/session-management&gt;\n &lt;/http&gt;\n \n &lt;beans:bean id=&quot;authenticationSuccessHandler&quot; class=&quot;com.pvn.mvctiles.configuration.MyAuthenticationSuccessHandler&quot; /&gt;\n \n</code></pre>\n<p>Working code is available in <a href=\"https://github.com/nlpraveennl/stackoverflow-answer-reference/\" rel=\"nofollow noreferrer\">my github repository</a>\nWorking code is available in two forms</p>\n<p><a href=\"https://github.com/nlpraveennl/stackoverflow-answer-reference/tree/master/springsecurity-auth-success-handler-xmlconfig\" rel=\"nofollow noreferrer\">1. XML config way of implementation</a></p>\n<p><a href=\"https://github.com/nlpraveennl/stackoverflow-answer-reference/tree/master/springsecurity-auth-success-handler-javaconfig\" rel=\"nofollow noreferrer\">2. JAVA config way of implementation</a></p>\n<p>If you want to have automatic logout feature and timer which displays when session is about to expire, if user is filling form but not submitted then user can extend session by clicking on keep session alive button.\nIf you want to implement auto logout refer <a href=\"https://stackoverflow.com/a/57598264/2825798\">stack overflow answer on auto logout on session timeout</a>. Hope this will help.</p>\n"},{"tags":[],"owner":{"account_id":11773195,"reputation":31,"user_id":8615602,"display_name":"Komal Singh Sisodiya"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1598525719,"creation_date":1598525719,"answer_id":63614506,"question_id":36795678,"body_markdown":"I handled it inside subclass of [UsernamePasswordAuthenticationFilter][1]\r\nYou can get username by - \r\n\r\n    obtainUsername(request);\r\n\r\nand apply user checks and set time out accordingly, like-\r\n\r\n    if(username.equalsIgnoreCase(&quot;komal-singh-sisodiya@xyz.com&quot;)) \r\n\t\t\t{\r\n\t\t\tlogger.debug(&quot;setting timeout 15 min&quot;);\r\n\t\t\trequest.getSession(false).setMaxInactiveInterval(15*60);\r\n\t\t\t}\r\n\r\n  [1]: https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/web/authentication/UsernamePasswordAuthenticationFilter.html","title":"How to enable session and set session timeout in Spring Security","body":"<p>I handled it inside subclass of <a href=\"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/web/authentication/UsernamePasswordAuthenticationFilter.html\" rel=\"nofollow noreferrer\">UsernamePasswordAuthenticationFilter</a>\nYou can get username by -</p>\n<pre><code>obtainUsername(request);\n</code></pre>\n<p>and apply user checks and set time out accordingly, like-</p>\n<pre><code>if(username.equalsIgnoreCase(&quot;komal-singh-sisodiya@xyz.com&quot;)) \n        {\n        logger.debug(&quot;setting timeout 15 min&quot;);\n        request.getSession(false).setMaxInactiveInterval(15*60);\n        }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6430905,"reputation":400,"user_id":4984125,"display_name":"New Bee"},"comment_count":0,"down_vote_count":1,"up_vote_count":8,"is_accepted":false,"score":7,"last_activity_date":1609117486,"creation_date":1609117486,"answer_id":65471968,"question_id":36795678,"body_markdown":"In your application properties use \r\n**`server.servlet.session.timeout=1m`** (If a duration suffix is not specified, seconds will be used.)\r\n\r\nBy default it is 30 minutes.\r\n","title":"How to enable session and set session timeout in Spring Security","body":"<p>In your application properties use\n<strong><code>server.servlet.session.timeout=1m</code></strong> (If a duration suffix is not specified, seconds will be used.)</p>\n<p>By default it is 30 minutes.</p>\n"},{"tags":[],"owner":{"account_id":11418021,"reputation":4780,"user_id":8370334,"display_name":"Abd Abughazaleh"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1654356874,"creation_date":1654356874,"answer_id":72501015,"question_id":36795678,"body_markdown":"Add the below in `application.proprites` \r\n\r\n    server.servlet.session.timeout= ","title":"How to enable session and set session timeout in Spring Security","body":"<p>Add the below in <code>application.proprites</code></p>\n<pre><code>server.servlet.session.timeout= \n</code></pre>\n"},{"tags":[],"owner":{"account_id":9260961,"reputation":1,"user_id":6878063,"display_name":"hema arun"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1660918152,"creation_date":1660665967,"answer_id":73377018,"question_id":36795678,"body_markdown":"this will work:    \r\n\r\n    @EnableJdbcHttpSession(maxInactiveIntervalInSeconds = 84600)","title":"How to enable session and set session timeout in Spring Security","body":"<p>this will work:</p>\n<pre><code>@EnableJdbcHttpSession(maxInactiveIntervalInSeconds = 84600)\n</code></pre>\n"}],"owner":{"account_id":3948767,"reputation":761,"user_id":4568220,"accept_rate":44,"display_name":"raju vaishnav"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":105556,"favorite_count":0,"down_vote_count":0,"up_vote_count":37,"accepted_answer_id":36807445,"answer_count":8,"score":37,"last_activity_date":1694354284,"creation_date":1461333159,"question_id":36795678,"body_markdown":"I am new to Spring Security and I am working on a login, logout, and session timeout feature. I have configured my code by referring to [this][1] document. My code looks below:\r\n\r\n\t@Override\r\n\tprotected void configure(HttpSecurity http) throws Exception {\r\n\r\n\t\thttp.authorizeRequests().antMatchers(&quot;/admin/**&quot;)\r\n\t\t\t.access(&quot;hasRole(&#39;ROLE_USER&#39;)&quot;).and().formLogin()\r\n\t\t\t.loginPage(&quot;/login&quot;).failureUrl(&quot;/login?error&quot;)\r\n\t\t\t\t.usernameParameter(&quot;username&quot;)\r\n\t\t\t\t.passwordParameter(&quot;password&quot;)\r\n\t\t\t\t.and().logout().logoutSuccessUrl(&quot;/login?logout&quot;).and().csrf();\r\n\t\thttp.sessionManagement().maximumSessions(1).expiredUrl(&quot;/login?expired&quot;);\r\n\t}\r\n\r\n **Override the class AbstractSecurityWebApplicationInitializer**\r\n\r\n\timport org.springframework.security.web.context.AbstractSecurityWebApplicationInitializer;\r\n\r\n\tpublic class SpringSecurityInitializer extends AbstractSecurityWebApplicationInitializer {\r\n\r\n\t\t@Override\r\n\t\tpublic boolean enableHttpSessionEventPublisher() {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\nI need clarification on whether I am doing it right, if it looks good, then where I need to setup the session timeout. I am doing it fully based on annotation.\r\n\r\n  [1]: http://docs.spring.io/spring-security/site/docs/3.2.4.RELEASE/apidocs/org/springframework/security/config/annotation/web/builders/HttpSecurity.html#sessionManagement%28%29\r\n\r\n","title":"How to enable session and set session timeout in Spring Security","body":"<p>I am new to Spring Security and I am working on a login, logout, and session timeout feature. I have configured my code by referring to <a href=\"http://docs.spring.io/spring-security/site/docs/3.2.4.RELEASE/apidocs/org/springframework/security/config/annotation/web/builders/HttpSecurity.html#sessionManagement%28%29\" rel=\"noreferrer\">this</a> document. My code looks below:</p>\n\n<pre><code>@Override\nprotected void configure(HttpSecurity http) throws Exception {\n\n    http.authorizeRequests().antMatchers(\"/admin/**\")\n        .access(\"hasRole('ROLE_USER')\").and().formLogin()\n        .loginPage(\"/login\").failureUrl(\"/login?error\")\n            .usernameParameter(\"username\")\n            .passwordParameter(\"password\")\n            .and().logout().logoutSuccessUrl(\"/login?logout\").and().csrf();\n    http.sessionManagement().maximumSessions(1).expiredUrl(\"/login?expired\");\n}\n</code></pre>\n\n<p><strong>Override the class AbstractSecurityWebApplicationInitializer</strong></p>\n\n<pre><code>import org.springframework.security.web.context.AbstractSecurityWebApplicationInitializer;\n\npublic class SpringSecurityInitializer extends AbstractSecurityWebApplicationInitializer {\n\n    @Override\n    public boolean enableHttpSessionEventPublisher() {\n        return true;\n    }\n\n}\n</code></pre>\n\n<p>I need clarification on whether I am doing it right, if it looks good, then where I need to setup the session timeout. I am doing it fully based on annotation.</p>\n"},{"tags":["java","spring-boot","hibernate","spring-orm"],"owner":{"account_id":19468499,"reputation":194,"user_id":14241354,"display_name":"14241354"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":20,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"closed_date":1694359113,"answer_count":0,"score":0,"last_activity_date":1694354243,"creation_date":1694354243,"question_id":77076417,"body_markdown":"When calling the `scanPackages(String...)` method of `org.springframework.orm.hibernate5.LocalSessionFactoryBuilder` I get a `NoSuchMethodError`:\r\n\r\n```\r\njava.lang.NoSuchMethodError: &#39;void org.springframework.orm.hibernate5.LocalSessionFactoryBuilder.addAttributeConverter(java.lang.Class)&#39;\r\n\tat org.springframework.orm.hibernate5.LocalSessionFactoryBuilder.scanPackages(LocalSessionFactoryBuilder.java:350)\r\n```\r\n\r\n* The error occurs when the package being scanned includes a class annotated with `jakarta.persistence.Converter`.\r\n* This happens when using `spring-boot-starter-parent` versions `3.1.0`, `3.1.1`, `3.1.2` and `3.1.3`.\r\n* It does not happen when I use `spring-boot-starter-parent` version `3.0.10`.\r\n* `spring-boot-starter-parent` `3.1.3` uses `hibernate-core` `6.2.7.Final` and `spring-orm` `6.0.11`.\r\n\r\n\r\n# **Example:**\r\n\r\nBelow is a unit test that demonstrates this problem, and the `pom.xml` I was using to build it. The unit test fails with a `NoSuchMethodError`.\r\n\r\n**src/test/java/com/example/ScanPackagesTest.java**\r\n```\r\npackage com.example;\r\n\r\nimport java.sql.Date;\r\nimport java.time.LocalDate;\r\n\r\nimport javax.sql.DataSource;\r\n\r\nimport org.junit.jupiter.api.Test;\r\nimport org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseBuilder;\r\nimport org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType;\r\nimport org.springframework.orm.hibernate5.LocalSessionFactoryBuilder;\r\n\r\nimport jakarta.persistence.AttributeConverter;\r\nimport jakarta.persistence.Converter;\r\n\r\npublic class ScanPackagesTest {\r\n   @Test\r\n   public void test() {\r\n      DataSource dataSource = new EmbeddedDatabaseBuilder().setType(EmbeddedDatabaseType.H2).build();\r\n      LocalSessionFactoryBuilder sessionBuilder = new LocalSessionFactoryBuilder(dataSource);\r\n      sessionBuilder.scanPackages(&quot;com.example&quot;);\r\n   }\r\n\r\n   @Converter(autoApply = true)\r\n   public static class StubConverter implements AttributeConverter&lt;LocalDate, Date&gt; {\r\n      @Override\r\n      public Date convertToDatabaseColumn(LocalDate attribute) {\r\n         return attribute == null ? null : Date.valueOf(attribute);\r\n      }\r\n\r\n      @Override\r\n      public LocalDate convertToEntityAttribute(Date dbData) {\r\n         return dbData == null ? null : dbData.toLocalDate();\r\n      }\r\n   }\r\n}\r\n\r\n```\r\n\r\n**pom.xml**\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n\txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\t&lt;parent&gt;\r\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;3.1.3&lt;/version&gt; &lt;!-- Test passes when using 3.0.10. Test fails when using 3.1.0 or later. --&gt;\r\n\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n\t&lt;/parent&gt;\r\n\t&lt;groupId&gt;com.example&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;demo&lt;/artifactId&gt;\r\n\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n\t&lt;name&gt;demo&lt;/name&gt;\r\n\t&lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\r\n\t&lt;properties&gt;\r\n\t\t&lt;java.version&gt;17&lt;/java.version&gt;\r\n\t&lt;/properties&gt;\r\n\t&lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;com.h2database&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;h2&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t&lt;/dependencies&gt;\r\n\r\n\t&lt;build&gt;\r\n\t\t&lt;plugins&gt;\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\t\t&lt;/plugins&gt;\r\n\t&lt;/build&gt;\r\n\r\n&lt;/project&gt;\r\n```\r\n\r\n**Stacktrace of failing test:**\r\n```\r\njava.lang.NoSuchMethodError: &#39;void org.springframework.orm.hibernate5.LocalSessionFactoryBuilder.addAttributeConverter(java.lang.Class)&#39;\r\n\tat org.springframework.orm.hibernate5.LocalSessionFactoryBuilder.scanPackages(LocalSessionFactoryBuilder.java:350)\r\n\tat com.example.ScanPackagesTest.test(ScanPackagesTest.java:21)\r\n```\r\n","title":"NoSuchMethod &#39;void org.springframework.orm.hibernate5.LocalSessionFactoryBuilder.addAttributeConverter(java.lang.Class)&#39;","body":"<p>When calling the <code>scanPackages(String...)</code> method of <code>org.springframework.orm.hibernate5.LocalSessionFactoryBuilder</code> I get a <code>NoSuchMethodError</code>:</p>\n<pre><code>java.lang.NoSuchMethodError: 'void org.springframework.orm.hibernate5.LocalSessionFactoryBuilder.addAttributeConverter(java.lang.Class)'\n    at org.springframework.orm.hibernate5.LocalSessionFactoryBuilder.scanPackages(LocalSessionFactoryBuilder.java:350)\n</code></pre>\n<ul>\n<li>The error occurs when the package being scanned includes a class annotated with <code>jakarta.persistence.Converter</code>.</li>\n<li>This happens when using <code>spring-boot-starter-parent</code> versions <code>3.1.0</code>, <code>3.1.1</code>, <code>3.1.2</code> and <code>3.1.3</code>.</li>\n<li>It does not happen when I use <code>spring-boot-starter-parent</code> version <code>3.0.10</code>.</li>\n<li><code>spring-boot-starter-parent</code> <code>3.1.3</code> uses <code>hibernate-core</code> <code>6.2.7.Final</code> and <code>spring-orm</code> <code>6.0.11</code>.</li>\n</ul>\n<h1><strong>Example:</strong></h1>\n<p>Below is a unit test that demonstrates this problem, and the <code>pom.xml</code> I was using to build it. The unit test fails with a <code>NoSuchMethodError</code>.</p>\n<p><strong>src/test/java/com/example/ScanPackagesTest.java</strong></p>\n<pre><code>package com.example;\n\nimport java.sql.Date;\nimport java.time.LocalDate;\n\nimport javax.sql.DataSource;\n\nimport org.junit.jupiter.api.Test;\nimport org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseBuilder;\nimport org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType;\nimport org.springframework.orm.hibernate5.LocalSessionFactoryBuilder;\n\nimport jakarta.persistence.AttributeConverter;\nimport jakarta.persistence.Converter;\n\npublic class ScanPackagesTest {\n   @Test\n   public void test() {\n      DataSource dataSource = new EmbeddedDatabaseBuilder().setType(EmbeddedDatabaseType.H2).build();\n      LocalSessionFactoryBuilder sessionBuilder = new LocalSessionFactoryBuilder(dataSource);\n      sessionBuilder.scanPackages(&quot;com.example&quot;);\n   }\n\n   @Converter(autoApply = true)\n   public static class StubConverter implements AttributeConverter&lt;LocalDate, Date&gt; {\n      @Override\n      public Date convertToDatabaseColumn(LocalDate attribute) {\n         return attribute == null ? null : Date.valueOf(attribute);\n      }\n\n      @Override\n      public LocalDate convertToEntityAttribute(Date dbData) {\n         return dbData == null ? null : dbData.toLocalDate();\n      }\n   }\n}\n\n</code></pre>\n<p><strong>pom.xml</strong></p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.1.3&lt;/version&gt; &lt;!-- Test passes when using 3.0.10. Test fails when using 3.1.0 or later. --&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;demo&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;demo&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.h2database&lt;/groupId&gt;\n            &lt;artifactId&gt;h2&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p><strong>Stacktrace of failing test:</strong></p>\n<pre><code>java.lang.NoSuchMethodError: 'void org.springframework.orm.hibernate5.LocalSessionFactoryBuilder.addAttributeConverter(java.lang.Class)'\n    at org.springframework.orm.hibernate5.LocalSessionFactoryBuilder.scanPackages(LocalSessionFactoryBuilder.java:350)\n    at com.example.ScanPackagesTest.test(ScanPackagesTest.java:21)\n</code></pre>\n"},{"tags":["java","spring-security","oauth-2.0","spring-oauth2"],"answers":[{"tags":[],"owner":{"account_id":19460464,"reputation":43,"user_id":14234891,"display_name":"Ionathan Ardelean"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694330805,"creation_date":1694330805,"answer_id":77075158,"question_id":77074220,"body_markdown":"In Spring Security 5.7.0-M2 WebSecurityConfigurerAdapter was deprecated.\r\nHere is how you do it now:\r\nhttps://spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter\r\n\r\n","title":"error with WebSecurityConfigurerAdapter when migrating springboot application 2.7 to 3.1.1","body":"<p>In Spring Security 5.7.0-M2 WebSecurityConfigurerAdapter was deprecated.\nHere is how you do it now:\n<a href=\"https://spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter\" rel=\"nofollow noreferrer\">https://spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter</a></p>\n"},{"tags":[],"owner":{"account_id":24440940,"reputation":3132,"user_id":18364656,"display_name":"Andrei Lisa"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694351758,"creation_date":1694331013,"answer_id":77075169,"question_id":77074220,"body_markdown":"If the problem is in migration and nothing else, i mean to replace old configuration.\r\n\r\nYou should remove ` extends WebSecurityConfigurerAdapter`.\r\n\r\nThe configuration class will look so:\r\n\r\n    @Configuration\r\n    @EnableWebSecurity\r\n    public class OpaqueSecurityConfig {\r\n    \r\n      @Bean\r\n      public SecurityFilterChain securityFilterChain(HttpSecurity http)  throws Exception {\r\n    \r\n        http.cors(AbstractHttpConfigurer::disable);\r\n        http.authorizeHttpRequests(request -&gt; {\r\n          request.requestMatchers(HttpMethod.GET,\r\n                  &quot;/public/**&quot;, &quot;/v3/api-docs/**&quot;, &quot;/swagger-ui/**&quot;, &quot;/swagger-ui.html&quot;, &quot;/apiGeneral-docs/**&quot;, &quot;swagger-ui-GeneralApi/**&quot;, &quot;/swagger-ui-GeneralApi.html/**&quot;).permitAll()\r\n              .requestMatchers(HttpMethod.POST, &quot;/public/**&quot;).permitAll()\r\n              .anyRequest().authenticated();\r\n        });\r\n        http.oauth2ResourceServer(c -&gt; c.opaqueToken(Customizer.withDefaults()));\r\n    \r\n        return http.build();\r\n      }\r\n    \r\n      @Bean\r\n      OpaqueTokenIntrospector tokenIntrospector(RestTemplateBuilder builder, OAuth2ResourceServerProperties resourceServerProps) {\r\n        return new CustomOpaqueTokenIntrospector(builder, resourceServerProps);\r\n      }\r\n    \r\n    }\r\nBut i really suggest you to check next resources:\r\n\r\n[spring-security-without-the-websecurityconfigureradapter][1]\r\n\r\n[Migration Guide][2]\r\n\r\n\r\nAbout `gradle` build file also update the version for \r\n\r\n`implementation &#39;org.springframework.boot:spring-boot-gradle-plugin:**2.7.0**&#39;` to one that you use in project.\r\n\r\n\r\n  [1]: https://spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter\r\n  [2]: https://docs.spring.io/spring-security/reference/migration-7/configuration.html","title":"error with WebSecurityConfigurerAdapter when migrating springboot application 2.7 to 3.1.1","body":"<p>If the problem is in migration and nothing else, i mean to replace old configuration.</p>\n<p>You should remove <code> extends WebSecurityConfigurerAdapter</code>.</p>\n<p>The configuration class will look so:</p>\n<pre><code>@Configuration\n@EnableWebSecurity\npublic class OpaqueSecurityConfig {\n\n  @Bean\n  public SecurityFilterChain securityFilterChain(HttpSecurity http)  throws Exception {\n\n    http.cors(AbstractHttpConfigurer::disable);\n    http.authorizeHttpRequests(request -&gt; {\n      request.requestMatchers(HttpMethod.GET,\n              &quot;/public/**&quot;, &quot;/v3/api-docs/**&quot;, &quot;/swagger-ui/**&quot;, &quot;/swagger-ui.html&quot;, &quot;/apiGeneral-docs/**&quot;, &quot;swagger-ui-GeneralApi/**&quot;, &quot;/swagger-ui-GeneralApi.html/**&quot;).permitAll()\n          .requestMatchers(HttpMethod.POST, &quot;/public/**&quot;).permitAll()\n          .anyRequest().authenticated();\n    });\n    http.oauth2ResourceServer(c -&gt; c.opaqueToken(Customizer.withDefaults()));\n\n    return http.build();\n  }\n\n  @Bean\n  OpaqueTokenIntrospector tokenIntrospector(RestTemplateBuilder builder, OAuth2ResourceServerProperties resourceServerProps) {\n    return new CustomOpaqueTokenIntrospector(builder, resourceServerProps);\n  }\n\n}\n</code></pre>\n<p>But i really suggest you to check next resources:</p>\n<p><a href=\"https://spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter\" rel=\"nofollow noreferrer\">spring-security-without-the-websecurityconfigureradapter</a></p>\n<p><a href=\"https://docs.spring.io/spring-security/reference/migration-7/configuration.html\" rel=\"nofollow noreferrer\">Migration Guide</a></p>\n<p>About <code>gradle</code> build file also update the version for</p>\n<p><code>implementation 'org.springframework.boot:spring-boot-gradle-plugin:**2.7.0**'</code> to one that you use in project.</p>\n"}],"owner":{"account_id":15908288,"reputation":55,"user_id":11489433,"display_name":"Kenny Cruz"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":99,"favorite_count":0,"down_vote_count":2,"up_vote_count":1,"accepted_answer_id":77075169,"answer_count":2,"score":-1,"last_activity_date":1694351758,"creation_date":1694297912,"question_id":77074220,"body_markdown":"Good afternoon, I have a problem with an application in springboot 2.7.1 that I updated to version 3.1.1\r\nmy application uses CustomOpaqueTokenIntrospector to validate a token, the problem is that in version 3.1.1 &quot;WebSecurityConfigurerAdapter&quot;, &quot;cors&quot;,&quot;antMatchers&quot;, &quot;oauth2ResourceServer().opaqueToken()&quot; are deprecated, and honestly I&#39;m new to this authentication and authorization.\r\nCould you help me with an answer on how I could correct my problem, I have attached the code of my configuration classes.\r\n\r\n**Class OpaqueSecurityConfig:**\r\n\r\n    package ec.edu.espe.generalapi.Config.security;\r\n    \r\n    import org.springframework.boot.autoconfigure.security.oauth2.resource.OAuth2ResourceServerProperties;\r\n    import org.springframework.boot.web.client.RestTemplateBuilder;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.http.HttpMethod;\r\n    import org.springframework.security.config.annotation.web.builders.HttpSecurity;\r\n    import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\r\n    import org.springframework.security.oauth2.server.resource.introspection.OpaqueTokenIntrospector;\r\n    \r\n    @Configuration\r\n    public class OpaqueSecurityConfig extends WebSecurityConfigurerAdapter {\r\n    \r\n        @Override\r\n        protected void configure(HttpSecurity http) throws Exception {\r\n           \r\n            http.cors();\r\n            http\r\n                    .authorizeRequests(authz -&gt; authz\r\n                            .antMatchers(HttpMethod.GET, &quot;/public/**&quot;, &quot;/v3/api-docs/**&quot;, &quot;/swagger-ui/**&quot;, &quot;/swagger-ui.html&quot;, &quot;/apiGeneral-docs/**&quot;, &quot;swagger-ui-GeneralApi/**&quot;, &quot;/swagger-ui-GeneralApi.html/**&quot;).permitAll()\r\n                            .antMatchers(HttpMethod.POST, &quot;/public/**&quot;).permitAll()\r\n                            .anyRequest().authenticated())\r\n                    .oauth2ResourceServer().opaqueToken();\r\n        }\r\n    \r\n        @Bean\r\n        OpaqueTokenIntrospector tokenIntrospector(RestTemplateBuilder builder, OAuth2ResourceServerProperties resourceServerProps) {\r\n            return new CustomOpaqueTokenIntrospector(builder, resourceServerProps);\r\n        }\r\n    \r\n    }\r\n\r\n**Class CustomOpaqueTokenIntrospector:**\r\n\r\n    package ec.edu.espe.generalapi.Config.security;\r\n    \r\n    import org.springframework.boot.autoconfigure.security.oauth2.resource.OAuth2ResourceServerProperties;\r\n    import org.springframework.boot.web.client.RestTemplateBuilder;\r\n    import org.springframework.security.oauth2.core.OAuth2AuthenticatedPrincipal;\r\n    import org.springframework.security.oauth2.server.resource.introspection.NimbusOpaqueTokenIntrospector;\r\n    import org.springframework.security.oauth2.server.resource.introspection.OpaqueTokenIntrospector;\r\n    import org.springframework.web.client.RestOperations;\r\n    \r\n    import java.time.Duration;\r\n    \r\n    \r\n    public class CustomOpaqueTokenIntrospector implements OpaqueTokenIntrospector {\r\n        private OAuth2ResourceServerProperties.Opaquetoken opaqueTokenProps;\r\n        private RestTemplateBuilder builder;\r\n        CustomOpaqueTokenIntrospector(RestTemplateBuilder builder, OAuth2ResourceServerProperties resourceServerProps) {\r\n            this.opaqueTokenProps = resourceServerProps.getOpaquetoken();\r\n            this.builder = builder;\r\n        }\r\n    \r\n        @Override\r\n        public OAuth2AuthenticatedPrincipal introspect(String token) {\r\n          //  System.out.println(token);\r\n            RestOperations restOperations = builder\r\n                    .defaultHeader(&quot;Authorization&quot;, &quot;Bearer &quot; + token)\r\n                    .setConnectTimeout(Duration.ofSeconds(60))\r\n                    .setReadTimeout(Duration.ofSeconds(60))\r\n                    .build();\r\n            return new NimbusOpaqueTokenIntrospector(opaqueTokenProps.getIntrospectionUri(), restOperations).introspect(token);\r\n        }\r\n    }\r\n\r\nand finally:\r\n\r\n**build.gradle**\r\n\r\n    plugins {\r\n    \tid &#39;java&#39;\r\n    \tid &#39;org.springframework.boot&#39; version &#39;3.1.3&#39;\r\n    \tid &#39;io.spring.dependency-management&#39; version &#39;1.1.3&#39;\r\n    }\r\n    \r\n    group = &#39;example&#39;\r\n    version = &#39;0.0.1-SNAPSHOT&#39;\r\n    \r\n    java {\r\n    \tsourceCompatibility = &#39;17&#39;\r\n    }\r\n    \r\n    \r\n    repositories {\r\n    \tmavenCentral()\r\n    }\r\n    \r\n    dependencies {\r\n    \timplementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;\r\n    \timplementation &#39;org.springframework.boot:spring-boot-starter-web&#39;\r\n    \timplementation &#39;org.springframework.boot:spring-boot-starter-oauth2-resource-server:3.0.0&#39;\r\n    \timplementation &#39;org.springframework.boot:spring-boot-gradle-plugin:2.7.0&#39;\r\n    \tcompileOnly &#39;org.projectlombok:lombok&#39;\r\n    \timplementation &#39;org.springdoc:springdoc-openapi-ui:1.6.12&#39;\r\n    \timplementation &#39;org.springdoc:springdoc-openapi-security:1.6.12&#39;\r\n    \timplementation group: &#39;org.postgresql&#39;, name: &#39;postgresql&#39;, version: &#39;42.3.1&#39;\r\n    \truntimeOnly &#39;com.nimbusds:oauth2-oidc-sdk:9.2.4&#39;\r\n    \timplementation &#39;org.springframework.boot:spring-boot-starter-actuator:2.6.1&#39;\r\n    \truntimeOnly &#39;com.oracle.database.jdbc:ojdbc8&#39;\r\n    \tannotationProcessor &#39;org.projectlombok:lombok&#39;\r\n    \ttestImplementation &#39;org.springframework.boot:spring-boot-starter-test&#39;\r\n    }\r\n    \r\n    tasks.named(&#39;test&#39;) {\r\n    \tuseJUnitPlatform()\r\n    }\r\n\r\n\r\n","title":"error with WebSecurityConfigurerAdapter when migrating springboot application 2.7 to 3.1.1","body":"<p>Good afternoon, I have a problem with an application in springboot 2.7.1 that I updated to version 3.1.1\nmy application uses CustomOpaqueTokenIntrospector to validate a token, the problem is that in version 3.1.1 &quot;WebSecurityConfigurerAdapter&quot;, &quot;cors&quot;,&quot;antMatchers&quot;, &quot;oauth2ResourceServer().opaqueToken()&quot; are deprecated, and honestly I'm new to this authentication and authorization.\nCould you help me with an answer on how I could correct my problem, I have attached the code of my configuration classes.</p>\n<p><strong>Class OpaqueSecurityConfig:</strong></p>\n<pre><code>package ec.edu.espe.generalapi.Config.security;\n\nimport org.springframework.boot.autoconfigure.security.oauth2.resource.OAuth2ResourceServerProperties;\nimport org.springframework.boot.web.client.RestTemplateBuilder;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.http.HttpMethod;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\nimport org.springframework.security.oauth2.server.resource.introspection.OpaqueTokenIntrospector;\n\n@Configuration\npublic class OpaqueSecurityConfig extends WebSecurityConfigurerAdapter {\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n       \n        http.cors();\n        http\n                .authorizeRequests(authz -&gt; authz\n                        .antMatchers(HttpMethod.GET, &quot;/public/**&quot;, &quot;/v3/api-docs/**&quot;, &quot;/swagger-ui/**&quot;, &quot;/swagger-ui.html&quot;, &quot;/apiGeneral-docs/**&quot;, &quot;swagger-ui-GeneralApi/**&quot;, &quot;/swagger-ui-GeneralApi.html/**&quot;).permitAll()\n                        .antMatchers(HttpMethod.POST, &quot;/public/**&quot;).permitAll()\n                        .anyRequest().authenticated())\n                .oauth2ResourceServer().opaqueToken();\n    }\n\n    @Bean\n    OpaqueTokenIntrospector tokenIntrospector(RestTemplateBuilder builder, OAuth2ResourceServerProperties resourceServerProps) {\n        return new CustomOpaqueTokenIntrospector(builder, resourceServerProps);\n    }\n\n}\n</code></pre>\n<p><strong>Class CustomOpaqueTokenIntrospector:</strong></p>\n<pre><code>package ec.edu.espe.generalapi.Config.security;\n\nimport org.springframework.boot.autoconfigure.security.oauth2.resource.OAuth2ResourceServerProperties;\nimport org.springframework.boot.web.client.RestTemplateBuilder;\nimport org.springframework.security.oauth2.core.OAuth2AuthenticatedPrincipal;\nimport org.springframework.security.oauth2.server.resource.introspection.NimbusOpaqueTokenIntrospector;\nimport org.springframework.security.oauth2.server.resource.introspection.OpaqueTokenIntrospector;\nimport org.springframework.web.client.RestOperations;\n\nimport java.time.Duration;\n\n\npublic class CustomOpaqueTokenIntrospector implements OpaqueTokenIntrospector {\n    private OAuth2ResourceServerProperties.Opaquetoken opaqueTokenProps;\n    private RestTemplateBuilder builder;\n    CustomOpaqueTokenIntrospector(RestTemplateBuilder builder, OAuth2ResourceServerProperties resourceServerProps) {\n        this.opaqueTokenProps = resourceServerProps.getOpaquetoken();\n        this.builder = builder;\n    }\n\n    @Override\n    public OAuth2AuthenticatedPrincipal introspect(String token) {\n      //  System.out.println(token);\n        RestOperations restOperations = builder\n                .defaultHeader(&quot;Authorization&quot;, &quot;Bearer &quot; + token)\n                .setConnectTimeout(Duration.ofSeconds(60))\n                .setReadTimeout(Duration.ofSeconds(60))\n                .build();\n        return new NimbusOpaqueTokenIntrospector(opaqueTokenProps.getIntrospectionUri(), restOperations).introspect(token);\n    }\n}\n</code></pre>\n<p>and finally:</p>\n<p><strong>build.gradle</strong></p>\n<pre><code>plugins {\n    id 'java'\n    id 'org.springframework.boot' version '3.1.3'\n    id 'io.spring.dependency-management' version '1.1.3'\n}\n\ngroup = 'example'\nversion = '0.0.1-SNAPSHOT'\n\njava {\n    sourceCompatibility = '17'\n}\n\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'\n    implementation 'org.springframework.boot:spring-boot-starter-web'\n    implementation 'org.springframework.boot:spring-boot-starter-oauth2-resource-server:3.0.0'\n    implementation 'org.springframework.boot:spring-boot-gradle-plugin:2.7.0'\n    compileOnly 'org.projectlombok:lombok'\n    implementation 'org.springdoc:springdoc-openapi-ui:1.6.12'\n    implementation 'org.springdoc:springdoc-openapi-security:1.6.12'\n    implementation group: 'org.postgresql', name: 'postgresql', version: '42.3.1'\n    runtimeOnly 'com.nimbusds:oauth2-oidc-sdk:9.2.4'\n    implementation 'org.springframework.boot:spring-boot-starter-actuator:2.6.1'\n    runtimeOnly 'com.oracle.database.jdbc:ojdbc8'\n    annotationProcessor 'org.projectlombok:lombok'\n    testImplementation 'org.springframework.boot:spring-boot-starter-test'\n}\n\ntasks.named('test') {\n    useJUnitPlatform()\n}\n</code></pre>\n"},{"tags":["java","spring-boot","openshift"],"comments":[{"owner":{"account_id":4181375,"reputation":5121,"user_id":3426309,"display_name":"Andrey B. Panfilov"},"score":0,"creation_date":1676990363,"post_id":75521872,"comment_id":133245625,"body_markdown":"have you tried smth. like: `java -cp &quot;directory where foo.properties is located&quot; -jar myapplication.jar` ?","body":"have you tried smth. like: <code>java -cp &quot;directory where foo.properties is located&quot; -jar myapplication.jar</code> ?"},{"owner":{"account_id":3867185,"reputation":1489,"user_id":3203447,"accept_rate":94,"display_name":"JTK"},"score":0,"creation_date":1693492822,"post_id":75521872,"comment_id":135771020,"body_markdown":"It&#39;s not possible to use -cp and -jar together: https://stackoverflow.com/questions/13018100/execute-jar-file-with-multiple-classpath-libraries-from-command-prompt","body":"It&#39;s not possible to use -cp and -jar together: <a href=\"https://stackoverflow.com/questions/13018100/execute-jar-file-with-multiple-classpath-libraries-from-command-prompt\" title=\"execute jar file with multiple classpath libraries from command prompt\">stackoverflow.com/questions/13018100/&hellip;</a>"}],"answers":[{"comments":[{"owner":{"account_id":3867185,"reputation":1489,"user_id":3203447,"accept_rate":94,"display_name":"JTK"},"score":0,"creation_date":1693492766,"post_id":75525834,"comment_id":135771010,"body_markdown":"It&#39;s not possible to use -cp and -jar together: https://stackoverflow.com/questions/13018100/execute-jar-file-with-multiple-classpath-libraries-from-command-prompt","body":"It&#39;s not possible to use -cp and -jar together: <a href=\"https://stackoverflow.com/questions/13018100/execute-jar-file-with-multiple-classpath-libraries-from-command-prompt\" title=\"execute jar file with multiple classpath libraries from command prompt\">stackoverflow.com/questions/13018100/&hellip;</a>"},{"owner":{"account_id":153343,"reputation":1086,"user_id":368532,"accept_rate":70,"display_name":"Boris"},"score":0,"creation_date":1694351690,"post_id":75525834,"comment_id":135877141,"body_markdown":"You&#39;re indeed right, modified the answer, you would need to put jar to &quot;cp&quot; argument and manually specify main class.","body":"You&#39;re indeed right, modified the answer, you would need to put jar to &quot;cp&quot; argument and manually specify main class."}],"tags":[],"owner":{"account_id":153343,"reputation":1086,"user_id":368532,"accept_rate":70,"display_name":"Boris"},"comment_count":2,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694351660,"creation_date":1677013022,"answer_id":75525834,"question_id":75521872,"body_markdown":"**spring.config.location** has nothing to do with java native **getResourceAsStream** method, therefore it doesn&#39;t help\r\n\r\nFor JVM to interpret **/deployments/config/** as part of your classpath, you have to include this folder to the classpath in java command.\r\n\r\nYou probably have a Dockerfile with this line\r\n\r\n    java -jar service.jar\r\n\r\nModify it to \r\n\r\n    java -cp service.jar:/deployments/config mypackage.MyApplication\r\n","title":"Add external properties to classpath for maven dependence","body":"<p><strong>spring.config.location</strong> has nothing to do with java native <strong>getResourceAsStream</strong> method, therefore it doesn't help</p>\n<p>For JVM to interpret <strong>/deployments/config/</strong> as part of your classpath, you have to include this folder to the classpath in java command.</p>\n<p>You probably have a Dockerfile with this line</p>\n<pre><code>java -jar service.jar\n</code></pre>\n<p>Modify it to</p>\n<pre><code>java -cp service.jar:/deployments/config mypackage.MyApplication\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3867185,"reputation":1489,"user_id":3203447,"accept_rate":94,"display_name":"JTK"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1693494012,"creation_date":1693494012,"answer_id":77017043,"question_id":75521872,"body_markdown":"This was solved by configuring OCP4 Environment Variables: `JAVA_MAIN_CLASS`, `JAVA_CLASSPATH`\r\n\r\n    JAVA_MAIN_CLASS=-Dloader.main=your.spring.application.class org.springframework.boot.loader.JarLauncher\r\n\r\n    JAVA_CLASSPATH=/deployments/your.spring.application.jar:/deployments/data/:.\r\n\r\nIt&#39;s not possible to use both `-jar` and `-cp` on the command line: https://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/java.html#-jar","title":"Add external properties to classpath for maven dependence","body":"<p>This was solved by configuring OCP4 Environment Variables: <code>JAVA_MAIN_CLASS</code>, <code>JAVA_CLASSPATH</code></p>\n<pre><code>JAVA_MAIN_CLASS=-Dloader.main=your.spring.application.class org.springframework.boot.loader.JarLauncher\n\nJAVA_CLASSPATH=/deployments/your.spring.application.jar:/deployments/data/:.\n</code></pre>\n<p>It's not possible to use both <code>-jar</code> and <code>-cp</code> on the command line: <a href=\"https://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/java.html#-jar\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/java.html#-jar</a></p>\n"}],"owner":{"account_id":3867185,"reputation":1489,"user_id":3203447,"accept_rate":94,"display_name":"JTK"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":110,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77017043,"answer_count":2,"score":0,"last_activity_date":1694351660,"creation_date":1676989708,"question_id":75521872,"body_markdown":"I have an spring-boot application deployed on Openshift.\r\nThis application is dependent on a plain old java application, which has been added as maven dependence. \r\nThe maven dependence requires a `foo.properties` file on the classpath, it loads the `foo.properties` file using:\r\n\r\n    inputStream = this.getClass().getResourceAsStream(&quot;/foo.properties&quot;);\r\n\r\nThe `foo.properties` file will contain different values depending on the environment it&#39;s deployed to.\r\nI have tried to externalise the properties by adding a configmap to openshift, and mounting it at: `/deployments/config`\r\n\r\nI have added spring properties to the openshift environment variables:\r\n\r\n    spring.config.name foo\r\n    spring.config.location /deployments/config/\r\n\r\nHowever the maven dependence is unable to pick up the `foo.properties`, returning null.\r\n\r\nIs what I&#39;m attempting achievable, or are there alternative solutions to this problem?","title":"Add external properties to classpath for maven dependence","body":"<p>I have an spring-boot application deployed on Openshift.\nThis application is dependent on a plain old java application, which has been added as maven dependence.\nThe maven dependence requires a <code>foo.properties</code> file on the classpath, it loads the <code>foo.properties</code> file using:</p>\n<pre><code>inputStream = this.getClass().getResourceAsStream(&quot;/foo.properties&quot;);\n</code></pre>\n<p>The <code>foo.properties</code> file will contain different values depending on the environment it's deployed to.\nI have tried to externalise the properties by adding a configmap to openshift, and mounting it at: <code>/deployments/config</code></p>\n<p>I have added spring properties to the openshift environment variables:</p>\n<pre><code>spring.config.name foo\nspring.config.location /deployments/config/\n</code></pre>\n<p>However the maven dependence is unable to pick up the <code>foo.properties</code>, returning null.</p>\n<p>Is what I'm attempting achievable, or are there alternative solutions to this problem?</p>\n"},{"tags":["java","spring-boot","web","spring-security"],"answers":[{"comments":[{"owner":{"account_id":2064278,"reputation":13138,"user_id":1840146,"accept_rate":86,"display_name":"Toerktumlare"},"score":1,"creation_date":1694363780,"post_id":77076133,"comment_id":135878409,"body_markdown":"should be noted that if selecting JWTs you can not logout the user and that your application will be susceptible to token stealing attacks through cross site scripting etc.","body":"should be noted that if selecting JWTs you can not logout the user and that your application will be susceptible to token stealing attacks through cross site scripting etc."}],"tags":[],"owner":{"account_id":1442195,"reputation":861,"user_id":1361980,"display_name":"kalmas"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694349419,"creation_date":1694349419,"answer_id":77076133,"question_id":77075818,"body_markdown":"There is no stored session to keep you logged in once you are redirected. That&#39;s what `SessionCreationPolicy.STATELESS` means: don&#39;t create a server-side session, treat every request individually. You have to authenticate somehow when the browser redirects to `/api/home`. There are many options but it boils down to one of the following:\r\n* Enable backend sessions, this will tell Spring to link your requests together via the `JSESSIONID` cookie. This is the simple answer but will lead to problems down the road if you are building an API (see: [REST][1])\r\n* Include authentication token with each request. For example, make an endpoint that accepts a username and password and returns a token (see: [JWT][2]) to the client (browser). The client would then provide that token as a header on subsequent requests to authenticate.\r\n\r\n\r\n  [1]: https://restfulapi.net/\r\n  [2]: https://jwt.io/","title":"In Spring Security, after entering correct username and password, it redirects to the home page but it still displays &quot;HTTP 403 Forbidden&quot;","body":"<p>There is no stored session to keep you logged in once you are redirected. That's what <code>SessionCreationPolicy.STATELESS</code> means: don't create a server-side session, treat every request individually. You have to authenticate somehow when the browser redirects to <code>/api/home</code>. There are many options but it boils down to one of the following:</p>\n<ul>\n<li>Enable backend sessions, this will tell Spring to link your requests together via the <code>JSESSIONID</code> cookie. This is the simple answer but will lead to problems down the road if you are building an API (see: <a href=\"https://restfulapi.net/\" rel=\"nofollow noreferrer\">REST</a>)</li>\n<li>Include authentication token with each request. For example, make an endpoint that accepts a username and password and returns a token (see: <a href=\"https://jwt.io/\" rel=\"nofollow noreferrer\">JWT</a>) to the client (browser). The client would then provide that token as a header on subsequent requests to authenticate.</li>\n</ul>\n"}],"owner":{"account_id":29402756,"reputation":1,"user_id":22528551,"display_name":"Mantozi"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":64,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1694349419,"creation_date":1694343468,"question_id":77075818,"body_markdown":"So I was practicing my SpringBoot+SpringSecurity skill.\r\nIn the security configuration:\r\n\r\n```\r\n@Bean\r\n    public SecurityFilterChain configuration(HttpSecurity http) throws Exception {\r\n        http.csrf(AbstractHttpConfigurer::disable);\r\n\r\n        http.authorizeHttpRequests(Registry -&gt; Registry\r\n                .requestMatchers(Constants.PUBLIC_URL)// /auth/**\r\n                .permitAll()\r\n                .requestMatchers(Constants.AUTHENTICATE_URL)// /api/**\r\n                .hasAnyRole(Role.ADMIN.name(), Role.USER.name())\r\n        );\r\n\r\n        http.sessionManagement(session\r\n                -&gt; session.sessionCreationPolicy(SessionCreationPolicy.STATELESS));\r\n\r\n        http.authenticationProvider(authenticationProvider());\r\n\r\n        return http.build();\r\n    }\r\n```\r\n\r\nThis is my authenticate controller:\r\n\r\n```\r\n@PostMapping(&quot;/authenticate&quot;)\r\n    public String processAuthenticate(@Valid @ModelAttribute(name = &quot;user&quot;) AuthenticateRequest authenticateRequest, BindingResult bindingResult) {\r\n        bindingResult = authServices.authenticate(authenticateRequest, bindingResult);\r\n\r\n        if (bindingResult.hasErrors()) {\r\n            return &quot;authenticate&quot;;\r\n        }\r\n\r\n        SecurityContextHolder.getContext().setAuthentication(\r\n                new UsernamePasswordAuthenticationToken(\r\n                        authenticateRequest.getUsername(),\r\n                        authenticateRequest.getPassword()\r\n                )\r\n        );\r\n        return &quot;redirect:/api/home&quot;;\r\n    }\r\n```\r\nSo, that&#39;s exactly what I think:\r\nif `authServices.authenticate(authenticateRequest, bindingResult);` does not throw any exception, which means the correct username and password are entered!\r\nNext, the SecurityContextHolder will set the Authentication(UsernamePasswordAuthentication) and fill it with username and password.\r\nFinally, send redirect to the url &quot;/api/home&quot;.\r\n\r\nThere are two roles defined: USER and ADMIN.\r\n\r\n```\r\npublic enum Role {\r\n\r\n    USER(Collections.emptySet()),\r\n\r\n\r\n    ADMIN(Set.of(ADMIN_READ,\r\n            ADMIN_UPDATE, ADMIN_CREATE, ADMIN_DELETE\r\n    ));\r\n\r\n\r\n    @Getter\r\n    private final Set&lt;Permission&gt; permissions;\r\n\r\n    public List&lt;SimpleGrantedAuthority&gt; getAuthorities() {\r\n        List&lt;SimpleGrantedAuthority&gt; authorities = new java.util.ArrayList&lt;&gt;(getPermissions().stream()\r\n                .map(permission -&gt; new SimpleGrantedAuthority(permission.getPermission()))\r\n                .toList());\r\n        authorities.add(new SimpleGrantedAuthority(&quot;ROLE_&quot; + this.name()));\r\n        return authorities;\r\n    }\r\n}\r\n```\r\n\r\nI think it shall be something wrong in the authorities or roles or something. Because when I delete the `.hasAnyRole(Role.ADMIN.name(), Role.USER.name())` and change it to `permitAll()`\r\n\r\nAdditionally, there is no AccessDeniedException threw out, only Http 403 Error on the web page.\r\n\r\nThis is my Mysql table:\r\n&#39;1&#39;, &#39;user1&#39;, &#39;$2a$10$faQJhWWffJlvWbN4YDC4tep4TIMDzH3Hze4tH9MMmt6r9NKp49FCe&#39;, &#39;user1@qq.com&#39;, &#39;ADMIN&#39;\r\n\r\n&#39;5&#39;, &#39;user2&#39;, &#39;$2a$10$qAZAuvoG.aaEMljYfQirZOhjEUsUZ3edcum/Mhc6UPOc.ti0VD7JO&#39;, &#39;user2@qq.com&#39;, &#39;USER&#39;\r\n\r\n\r\nI&#39;ve tried:\r\n\r\nadding @PreAuthorize(&quot;isAuthenticated()&quot;)on the homePage controller function but does not help.\r\nand @Secured(&quot;ROLE_USER&quot;) does not help either.\r\nchanging the column &quot;USER&quot; to &quot;ROLE_USER&quot; in the Mysql table does not help.\r\nAnd, I changed the `.hasAnyRole(Role.ADMIN.name(), Role.USER.name())` to `.hasAuthority(&quot;ADMIN&quot;)`,to\r\n`.hasAuthority(&quot;USER&quot;)`,unluckily, they does NOT help.\r\n\r\n\r\nWhat I expected:\r\nJust tell me the reason for this annoying problem. I wish I can redirect to the /api/home successfully. Thank you very much!","title":"In Spring Security, after entering correct username and password, it redirects to the home page but it still displays &quot;HTTP 403 Forbidden&quot;","body":"<p>So I was practicing my SpringBoot+SpringSecurity skill.\nIn the security configuration:</p>\n<pre><code>@Bean\n    public SecurityFilterChain configuration(HttpSecurity http) throws Exception {\n        http.csrf(AbstractHttpConfigurer::disable);\n\n        http.authorizeHttpRequests(Registry -&gt; Registry\n                .requestMatchers(Constants.PUBLIC_URL)// /auth/**\n                .permitAll()\n                .requestMatchers(Constants.AUTHENTICATE_URL)// /api/**\n                .hasAnyRole(Role.ADMIN.name(), Role.USER.name())\n        );\n\n        http.sessionManagement(session\n                -&gt; session.sessionCreationPolicy(SessionCreationPolicy.STATELESS));\n\n        http.authenticationProvider(authenticationProvider());\n\n        return http.build();\n    }\n</code></pre>\n<p>This is my authenticate controller:</p>\n<pre><code>@PostMapping(&quot;/authenticate&quot;)\n    public String processAuthenticate(@Valid @ModelAttribute(name = &quot;user&quot;) AuthenticateRequest authenticateRequest, BindingResult bindingResult) {\n        bindingResult = authServices.authenticate(authenticateRequest, bindingResult);\n\n        if (bindingResult.hasErrors()) {\n            return &quot;authenticate&quot;;\n        }\n\n        SecurityContextHolder.getContext().setAuthentication(\n                new UsernamePasswordAuthenticationToken(\n                        authenticateRequest.getUsername(),\n                        authenticateRequest.getPassword()\n                )\n        );\n        return &quot;redirect:/api/home&quot;;\n    }\n</code></pre>\n<p>So, that's exactly what I think:\nif <code>authServices.authenticate(authenticateRequest, bindingResult);</code> does not throw any exception, which means the correct username and password are entered!\nNext, the SecurityContextHolder will set the Authentication(UsernamePasswordAuthentication) and fill it with username and password.\nFinally, send redirect to the url &quot;/api/home&quot;.</p>\n<p>There are two roles defined: USER and ADMIN.</p>\n<pre><code>public enum Role {\n\n    USER(Collections.emptySet()),\n\n\n    ADMIN(Set.of(ADMIN_READ,\n            ADMIN_UPDATE, ADMIN_CREATE, ADMIN_DELETE\n    ));\n\n\n    @Getter\n    private final Set&lt;Permission&gt; permissions;\n\n    public List&lt;SimpleGrantedAuthority&gt; getAuthorities() {\n        List&lt;SimpleGrantedAuthority&gt; authorities = new java.util.ArrayList&lt;&gt;(getPermissions().stream()\n                .map(permission -&gt; new SimpleGrantedAuthority(permission.getPermission()))\n                .toList());\n        authorities.add(new SimpleGrantedAuthority(&quot;ROLE_&quot; + this.name()));\n        return authorities;\n    }\n}\n</code></pre>\n<p>I think it shall be something wrong in the authorities or roles or something. Because when I delete the <code>.hasAnyRole(Role.ADMIN.name(), Role.USER.name())</code> and change it to <code>permitAll()</code></p>\n<p>Additionally, there is no AccessDeniedException threw out, only Http 403 Error on the web page.</p>\n<p>This is my Mysql table:\n'1', 'user1', '$2a$10$faQJhWWffJlvWbN4YDC4tep4TIMDzH3Hze4tH9MMmt6r9NKp49FCe', 'user1@qq.com', 'ADMIN'</p>\n<p>'5', 'user2', '$2a$10$qAZAuvoG.aaEMljYfQirZOhjEUsUZ3edcum/Mhc6UPOc.ti0VD7JO', 'user2@qq.com', 'USER'</p>\n<p>I've tried:</p>\n<p>adding @PreAuthorize(&quot;isAuthenticated()&quot;)on the homePage controller function but does not help.\nand @Secured(&quot;ROLE_USER&quot;) does not help either.\nchanging the column &quot;USER&quot; to &quot;ROLE_USER&quot; in the Mysql table does not help.\nAnd, I changed the <code>.hasAnyRole(Role.ADMIN.name(), Role.USER.name())</code> to <code>.hasAuthority(&quot;ADMIN&quot;)</code>,to\n<code>.hasAuthority(&quot;USER&quot;)</code>,unluckily, they does NOT help.</p>\n<p>What I expected:\nJust tell me the reason for this annoying problem. I wish I can redirect to the /api/home successfully. Thank you very much!</p>\n"},{"tags":["java","cloning"],"answers":[{"tags":[],"owner":{"account_id":1449510,"reputation":48182,"user_id":1366871,"accept_rate":100,"display_name":"dreamcrash"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1694348511,"creation_date":1353552418,"answer_id":13505207,"question_id":13505147,"body_markdown":"When you do a clone of an `Object &#39;A&#39;`, you are creating a new `Object &#39;B&#39;` (with the same references to objects) but in a different memory address. Thus, when you modify the object &#39;A&#39; you are not accessing the same memory address of the `Object &#39;B&#39;`. Therefore, changes in the clone do not reflect back in the original object and vice-versa.\r\n\r\n\r\n**Shallow Copy**\r\n\r\nGenerally, the clone method of an object, creates a new instance of the same class and copies all the fields to the new instance and returns it. This is nothing but shallow copy. Object class provides a clone method and provides support for the shallow copy. It returns ‘Object’ as the type and you need to explicitly cast back to your original object.\r\n\r\n**Deep Copy**\r\n\r\nWhen you need a deep copy then you need to implement it yourself. When the copied object contains some other object its references are copied recursively in the deep copy. When you implement a deep copy be careful as you might fall for cyclic dependencies. If you don’t want to implement deep copy yourself then you can go for serialization. It does implement deep copy implicitly and gracefully handling cyclic dependencies.\r\n\r\n([source][1] about the information) \r\n\r\nHere an illustrative example:\r\n\r\nShallow\r\n\r\n![Before Copy](https://upload.wikimedia.org/wikipedia/en/thumb/6/6c/Pre_shallow_deep_copy.svg/120px-Pre_shallow_deep_copy.svg.png)\r\n![Shallow Copying](https://upload.wikimedia.org/wikipedia/en/thumb/3/3e/Shallow_copy_in_progress.svg/120px-Shallow_copy_in_progress.svg.png)\r\n![Shallow Done](https://upload.wikimedia.org/wikipedia/en/thumb/e/e1/Shallow_copy_done.svg/120px-Shallow_copy_done.svg.png)\r\n\r\nDeep:\r\n\r\n![Before Copy](https://upload.wikimedia.org/wikipedia/en/thumb/6/6c/Pre_shallow_deep_copy.svg/120px-Pre_shallow_deep_copy.svg.png)\r\n[![Deep Copying][2]][2]  \n&lt;sub&gt;(source: [wikimedia.org][4])&lt;/sub&gt;  \n\r\n[![Deep Done][3]][3]\r\n\r\n\r\n  [1]: https://javapapers.com/core-java/java-clone-shallow-copy-and-deep-copy/\n [2]: https://i.stack.imgur.com/0hokX.png\n [3]: https://i.stack.imgur.com/QeXVZ.png\n [4]: https://web.archive.org/web/20170126014102/https://upload.wikimedia.org/wikipedia/en/thumb/5/5f/Deep_copy_in_progress.svg/120px-Deep_copy_in_progress.svg.png","title":"Modifying arraylists in a method and pass by value","body":"<p>When you do a clone of an <code>Object 'A'</code>, you are creating a new <code>Object 'B'</code> (with the same references to objects) but in a different memory address. Thus, when you modify the object 'A' you are not accessing the same memory address of the <code>Object 'B'</code>. Therefore, changes in the clone do not reflect back in the original object and vice-versa.</p>\n<p><strong>Shallow Copy</strong></p>\n<p>Generally, the clone method of an object, creates a new instance of the same class and copies all the fields to the new instance and returns it. This is nothing but shallow copy. Object class provides a clone method and provides support for the shallow copy. It returns ‘Object’ as the type and you need to explicitly cast back to your original object.</p>\n<p><strong>Deep Copy</strong></p>\n<p>When you need a deep copy then you need to implement it yourself. When the copied object contains some other object its references are copied recursively in the deep copy. When you implement a deep copy be careful as you might fall for cyclic dependencies. If you don’t want to implement deep copy yourself then you can go for serialization. It does implement deep copy implicitly and gracefully handling cyclic dependencies.</p>\n<p>(<a href=\"https://javapapers.com/core-java/java-clone-shallow-copy-and-deep-copy/\" rel=\"nofollow noreferrer\">source</a> about the information)</p>\n<p>Here an illustrative example:</p>\n<p>Shallow</p>\n<p><img src=\"https://upload.wikimedia.org/wikipedia/en/thumb/6/6c/Pre_shallow_deep_copy.svg/120px-Pre_shallow_deep_copy.svg.png\" alt=\"Before Copy\" />\n<img src=\"https://upload.wikimedia.org/wikipedia/en/thumb/3/3e/Shallow_copy_in_progress.svg/120px-Shallow_copy_in_progress.svg.png\" alt=\"Shallow Copying\" />\n<img src=\"https://upload.wikimedia.org/wikipedia/en/thumb/e/e1/Shallow_copy_done.svg/120px-Shallow_copy_done.svg.png\" alt=\"Shallow Done\" /></p>\n<p>Deep:</p>\n<p><img src=\"https://upload.wikimedia.org/wikipedia/en/thumb/6/6c/Pre_shallow_deep_copy.svg/120px-Pre_shallow_deep_copy.svg.png\" alt=\"Before Copy\" />\n<a href=\"https://i.stack.imgur.com/0hokX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0hokX.png\" alt=\"Deep Copying\" /></a><br />\n<sub>(source: <a href=\"https://web.archive.org/web/20170126014102/https://upload.wikimedia.org/wikipedia/en/thumb/5/5f/Deep_copy_in_progress.svg/120px-Deep_copy_in_progress.svg.png\" rel=\"nofollow noreferrer\">wikimedia.org</a>)</sub></p>\n<p><a href=\"https://i.stack.imgur.com/QeXVZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QeXVZ.png\" alt=\"Deep Done\" /></a></p>\n"},{"tags":[],"owner":{"account_id":1435980,"reputation":127999,"user_id":1357341,"accept_rate":100,"display_name":"arshajii"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1353553392,"creation_date":1353552584,"answer_id":13505227,"question_id":13505147,"body_markdown":"The whole purpose of a clone is to be *different* than the original - so changes in the clone *are not* reflected in the original. Otherwise, you could just use simple assignment as opposed to cloning.\r\n\r\ne.g.\r\n\r\n    MyClass a = new MyClass();  // some cloneable class\r\n    \r\n    MyClass b = a;  // not a clone, changes to `b` will affect in `a`\r\n                    // assignment duplicates the reference\r\n        -or-\r\n\r\n    MyClass b = a.clone();  // clone, changes to `b` will not affect in `a`\r\n                            // clone duplicates the object\r\n\r\nThere is actually a Wikipedia article on Java cloning [here][1].\r\n\r\n\r\n  [1]: http://en.wikipedia.org/wiki/Clone_%28Java_method%29","title":"Modifying arraylists in a method and pass by value","body":"<p>The whole purpose of a clone is to be <em>different</em> than the original - so changes in the clone <em>are not</em> reflected in the original. Otherwise, you could just use simple assignment as opposed to cloning.</p>\n\n<p>e.g.</p>\n\n<pre><code>MyClass a = new MyClass();  // some cloneable class\n\nMyClass b = a;  // not a clone, changes to `b` will affect in `a`\n                // assignment duplicates the reference\n    -or-\n\nMyClass b = a.clone();  // clone, changes to `b` will not affect in `a`\n                        // clone duplicates the object\n</code></pre>\n\n<p>There is actually a Wikipedia article on Java cloning <a href=\"http://en.wikipedia.org/wiki/Clone_%28Java_method%29\" rel=\"nofollow\">here</a>.</p>\n"}],"owner":{"account_id":1967259,"reputation":525,"user_id":1767157,"accept_rate":87,"display_name":"Floose"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":94,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":13505207,"answer_count":2,"score":2,"last_activity_date":1694348511,"creation_date":1353551827,"question_id":13505147,"body_markdown":"I read [this][1] post today about deep copying and had a few questions:\r\n\r\n\r\nIn the first code, the author says adding an (integer) object to a clone does not appear in the original. Why is this so? As I understand, cloning basically creates an object with the same references to objects as the original.\r\n\r\nWhy isn&#39;t a change in the clone reflected back in the original?\r\n\r\nDoesn&#39;t clone share the same reference as the Original?\r\n\r\n\r\n  [1]: http://javatechniques.com/blog/faster-deep-copies-of-java-objects/","title":"Modifying arraylists in a method and pass by value","body":"<p>I read <a href=\"http://javatechniques.com/blog/faster-deep-copies-of-java-objects/\" rel=\"nofollow\">this</a> post today about deep copying and had a few questions:</p>\n\n<p>In the first code, the author says adding an (integer) object to a clone does not appear in the original. Why is this so? As I understand, cloning basically creates an object with the same references to objects as the original.</p>\n\n<p>Why isn't a change in the clone reflected back in the original?</p>\n\n<p>Doesn't clone share the same reference as the Original?</p>\n"},{"tags":["java","spring-boot","gradle"],"comments":[{"owner":{"account_id":2767223,"reputation":21433,"user_id":2382650,"accept_rate":92,"display_name":"Cisco"},"score":0,"creation_date":1694354668,"post_id":77075994,"comment_id":135877416,"body_markdown":"What are the contents for the `build-logic/build.gradle`? And how are you applying the convention plugins to a project? Amend your question with those details.","body":"What are the contents for the <code>build-logic&#47;build.gradle</code>? And how are you applying the convention plugins to a project? Amend your question with those details."}],"owner":{"account_id":12491675,"reputation":187,"user_id":9092996,"display_name":"Kush Singh"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":27,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1694346964,"creation_date":1694346964,"question_id":77075994,"body_markdown":"[![Current build logic structure][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/UEWJu.png\r\nThe above is my current build logic structure, when I try to apply shared dependencies in `java-common-conventions.gradle` the build complains.\r\n\r\nalso I&#39;m unable to apply spring boot plugins like so:\r\n\r\n```plugins {\r\n    // Apply the java Plugin to add support for Java.\r\n    id &#39;java&#39;\r\n    id &#39;org.springframework.boot&#39; version &#39;2.7.10&#39;\r\n}\r\n```\r\n\r\nerror:  \r\n`\r\nInvalid plugin request [id: &#39;org.springframework.boot&#39;, version: &#39;2.7.10&#39;]. Plugin requests from precompiled scripts must not include a version number. Please remove the version from the offending request and make sure the module containing the requested plugin &#39;org.springframework.boot&#39; is an implementation dependency\r\n`\r\nit does work if I define it in every subproject&#39;s `build.gradle`\r\n\r\nhow do I shared dependencies and how/where do I define the `subproject` &amp; allproject closures?","title":"where do i define shared dependencies in gradle 8 structure?","body":"<p><a href=\"https://i.stack.imgur.com/UEWJu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UEWJu.png\" alt=\"Current build logic structure\" /></a></p>\n<p>The above is my current build logic structure, when I try to apply shared dependencies in <code>java-common-conventions.gradle</code> the build complains.</p>\n<p>also I'm unable to apply spring boot plugins like so:</p>\n<pre><code>    // Apply the java Plugin to add support for Java.\n    id 'java'\n    id 'org.springframework.boot' version '2.7.10'\n}\n</code></pre>\n<p>error:<br />\n<code>Invalid plugin request [id: 'org.springframework.boot', version: '2.7.10']. Plugin requests from precompiled scripts must not include a version number. Please remove the version from the offending request and make sure the module containing the requested plugin 'org.springframework.boot' is an implementation dependency</code>\nit does work if I define it in every subproject's <code>build.gradle</code></p>\n<p>how do I shared dependencies and how/where do I define the <code>subproject</code> &amp; allproject closures?</p>\n"},{"tags":["java","keycloak","keycloak-spi"],"comments":[{"owner":{"account_id":6825031,"reputation":151,"user_id":5250989,"display_name":"Silvio"},"score":0,"creation_date":1694342640,"post_id":75470097,"comment_id":135876249,"body_markdown":"Same problem here.","body":"Same problem here."}],"answers":[{"tags":[],"owner":{"account_id":6825031,"reputation":151,"user_id":5250989,"display_name":"Silvio"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694346599,"creation_date":1694346599,"answer_id":77075975,"question_id":75470097,"body_markdown":"I had the same problem.\r\n\r\nThe solution for me was that the getUserByUsername had to throw an error for addUser to be called. So in my case if I returned a 404 from my API if user is not found then addUser was called.","title":"Keycloak add user from custom user provider","body":"<p>I had the same problem.</p>\n<p>The solution for me was that the getUserByUsername had to throw an error for addUser to be called. So in my case if I returned a 404 from my API if user is not found then addUser was called.</p>\n"}],"owner":{"account_id":14824442,"reputation":21,"user_id":10705782,"display_name":"MrDeliK"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":98,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694346599,"creation_date":1676539238,"question_id":75470097,"body_markdown":"I&#39;m creating a custom user storage using the [User storage SPI](https://www.keycloak.org/docs/latest/server_development/index.html#add-remove-user-and-query-capability-interfaces)\r\n\r\nMy problem here is that that addUser function is not called.\r\nWhen i try to add a user, the function `getUserByNickName` is directly called but do not find any user.","title":"Keycloak add user from custom user provider","body":"<p>I'm creating a custom user storage using the <a href=\"https://www.keycloak.org/docs/latest/server_development/index.html#add-remove-user-and-query-capability-interfaces\" rel=\"nofollow noreferrer\">User storage SPI</a></p>\n<p>My problem here is that that addUser function is not called.\nWhen i try to add a user, the function <code>getUserByNickName</code> is directly called but do not find any user.</p>\n"},{"tags":["java","spring-boot","forms","spring-mvc"],"comments":[{"owner":{"account_id":16341513,"reputation":209,"user_id":11802330,"display_name":"Eric"},"score":0,"creation_date":1694409656,"post_id":77075885,"comment_id":135882111,"body_markdown":"To post data &amp; files, you can try [this](https://stackoverflow.com/questions/76655712/how-to-receive-an-entity-with-image-from-requestparam/76677954#76677954). To generate directory to upload files to you can try [this](https://stackoverflow.com/questions/76962580/spring-boot-jar-deploy-file-upload-system/76977184#76977184)","body":"To post data &amp; files, you can try <a href=\"https://stackoverflow.com/questions/76655712/how-to-receive-an-entity-with-image-from-requestparam/76677954#76677954\">this</a>. To generate directory to upload files to you can try <a href=\"https://stackoverflow.com/questions/76962580/spring-boot-jar-deploy-file-upload-system/76977184#76977184\">this</a>"}],"owner":{"account_id":29406648,"reputation":1,"user_id":22531851,"display_name":"Владислав Бучченко"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":20,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694345180,"creation_date":1694344816,"question_id":77075885,"body_markdown":"My DB `Day` model has fields: timestamp such as id, description, content, steps, mainImage. The constructor is empty with default values ​​if there is no such timestamp in the database. &quot;non-empty&quot; if timestamp is in BD, getters/setters. There is a view `full_day.html` with info and an Edit Day button. When clicked Edit, a modal window opens with a form for changing the day using the &quot;Save&quot; button.\r\n\r\nIn short, I want my user to add an image to a form (and some other things) and the image file goes to the /static/images/ and the file name goes to the MySQL Table. What are the ideas to do?\r\n\r\n(It is the details of the info I described above)\r\n\r\n**CalendarController.java**:\r\n```java\r\n// Other methods\r\n@GetMapping(&quot;/{year}/{month}/{dayNumber}&quot;)\r\npublic String day(Model model,\r\n                  @PathVariable int year,\r\n                  @PathVariable String month,\r\n                  @PathVariable int dayNumber) {\r\n\r\n    long timestamp = convertToDateTimestamp(year, month, dayNumber);\r\n\r\n    Optional&lt;Day&gt; gotDay = dayRepository.findById(timestamp);\r\n    ArrayList&lt;Day&gt; currentDay = new ArrayList&lt;&gt;();\r\n\r\n    gotDay.ifPresent(currentDay::add);\r\n\r\n    model.addAttribute(&quot;gotDay&quot;, gotDay);\r\n    model.addAttribute(&quot;currentDay&quot;, currentDay);\r\n    model.addAttribute(&quot;year&quot;, year);\r\n    model.addAttribute(&quot;month&quot;, month);\r\n    model.addAttribute(&quot;dayNumber&quot;, dayNumber);\r\n    return &quot;full_day&quot;;\r\n}\r\n\r\n@PostMapping(&quot;/{year}/{month}/{dayNumber}&quot;)\r\npublic String saveDay(Model model,\r\n                      @ModelAttribute(&quot;gotDay&quot;) Day currentDay,\r\n                      @PathVariable int year,\r\n                      @PathVariable String month,\r\n                      @PathVariable int dayNumber\r\n) {\r\n\r\n    currentDay.setTimestamp(convertToDateTimestamp(year, month, dayNumber));\r\n    dayRepository.save(currentDay);\r\n\r\n    return &quot;redirect:/calendar/&quot; + year + &quot;/&quot; + month + &quot;/&quot; + dayNumber;\r\n}\r\n```\r\n\r\n**Day.java:**\r\n```java\r\n@Entity\r\n@Table(schema = &quot;memoryfulday&quot;, name = &quot;memoryful&quot;)\r\npublic class Day {\r\n    @Id\r\n    private Long timestamp;\r\n    private String description, content;\r\n    private int steps;\r\n    private String mainImage;\r\n//    private MultipartFile mainImage;\r\n\r\n    public Day(Long timestamp) {\r\n        this.timestamp = timestamp;\r\n        this.mainImage = &quot;NoPhoto.png&quot;;\r\n        this.description = &quot;No brief description&quot;;\r\n        this.steps = 0;\r\n        this.content = &quot;No content&quot;;\r\n    }\r\n\r\n    public Day(Long timestamp, String mainImage, String description, String content, int steps) {\r\n        this.timestamp = timestamp;\r\n        this.mainImage = mainImage;\r\n        this.description = description;\r\n        this.content = content;\r\n        this.steps = steps;\r\n    }\r\n\r\n    // toString()\r\n    // getters/setters\r\n}\r\n```\r\n**full_day.html:**\r\n```html\r\n&lt;!-- some code --&gt;\r\n&lt;div id=&quot;edit-modal&quot; class=&quot;edit-modal&quot;&gt;\r\n    &lt;div class=&quot;edit-content&quot;&gt;\r\n        &lt;span class=&quot;close&quot;&gt;&amp;times;&lt;/span&gt;\r\n        &lt;h2&gt;Edit Day Window&lt;/h2&gt;\r\n\r\n        &lt;form method=&quot;post&quot; th:object=&quot;${gotDay}&quot;&gt;\r\n            &lt;label for=&quot;steps&quot;&gt;Daily steps&lt;/label&gt;\r\n            &lt;input value=&quot;${day.steps}&quot; th:field=&quot;*{steps}&quot; id=&quot;steps&quot; type=&quot;number&quot; tabindex=&quot;1&quot; placeholder=&quot;10000&quot;&gt;\r\n\r\n            &lt;label for=&quot;description&quot;&gt;Description&lt;/label&gt;\r\n            &lt;input value=&quot;${day.description}&quot; th:field=&quot;*{description}&quot; id=&quot;description&quot; type=&quot;text&quot; tabindex=&quot;2&quot; placeholder=&quot;Enter day&#39;s description&quot;&gt;\r\n\r\n            &lt;label for=&quot;content&quot;&gt;Content&lt;/label&gt;\r\n            &lt;textarea th:text=&quot;${day.content}&quot; th:field=&quot;*{content}&quot; id=&quot;content&quot; tabindex=&quot;3&quot; placeholder=&quot;Enter day&#39;s content&quot;&gt;&lt;/textarea&gt;\r\n            &lt;input type=&quot;submit&quot; tabindex=&quot;4&quot; class=&quot;left-right&quot; id=&quot;editSubmit&quot; value=&quot;Save&quot;&gt;\r\n        &lt;/form&gt;\r\n    &lt;/div&gt;\r\n&lt;/div&gt;\r\n\r\n// some js to interract with modal window\r\n```\r\n\r\nI watched videos, searched info in websites, but I didn&#39;t find what I wanted. I tried some code that ChatGPT wrote for me, but it couldn&#39;t help me.","title":"Add an image from &lt;input type=&quot;file&quot;&gt; through &lt;form method=&quot;post&quot;&gt; to the /static/images and the name of the image to MySQL","body":"<p>My DB <code>Day</code> model has fields: timestamp such as id, description, content, steps, mainImage. The constructor is empty with default values ​​if there is no such timestamp in the database. &quot;non-empty&quot; if timestamp is in BD, getters/setters. There is a view <code>full_day.html</code> with info and an Edit Day button. When clicked Edit, a modal window opens with a form for changing the day using the &quot;Save&quot; button.</p>\n<p>In short, I want my user to add an image to a form (and some other things) and the image file goes to the /static/images/ and the file name goes to the MySQL Table. What are the ideas to do?</p>\n<p>(It is the details of the info I described above)</p>\n<p><strong>CalendarController.java</strong>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>// Other methods\n@GetMapping(&quot;/{year}/{month}/{dayNumber}&quot;)\npublic String day(Model model,\n                  @PathVariable int year,\n                  @PathVariable String month,\n                  @PathVariable int dayNumber) {\n\n    long timestamp = convertToDateTimestamp(year, month, dayNumber);\n\n    Optional&lt;Day&gt; gotDay = dayRepository.findById(timestamp);\n    ArrayList&lt;Day&gt; currentDay = new ArrayList&lt;&gt;();\n\n    gotDay.ifPresent(currentDay::add);\n\n    model.addAttribute(&quot;gotDay&quot;, gotDay);\n    model.addAttribute(&quot;currentDay&quot;, currentDay);\n    model.addAttribute(&quot;year&quot;, year);\n    model.addAttribute(&quot;month&quot;, month);\n    model.addAttribute(&quot;dayNumber&quot;, dayNumber);\n    return &quot;full_day&quot;;\n}\n\n@PostMapping(&quot;/{year}/{month}/{dayNumber}&quot;)\npublic String saveDay(Model model,\n                      @ModelAttribute(&quot;gotDay&quot;) Day currentDay,\n                      @PathVariable int year,\n                      @PathVariable String month,\n                      @PathVariable int dayNumber\n) {\n\n    currentDay.setTimestamp(convertToDateTimestamp(year, month, dayNumber));\n    dayRepository.save(currentDay);\n\n    return &quot;redirect:/calendar/&quot; + year + &quot;/&quot; + month + &quot;/&quot; + dayNumber;\n}\n</code></pre>\n<p><strong>Day.java:</strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>@Entity\n@Table(schema = &quot;memoryfulday&quot;, name = &quot;memoryful&quot;)\npublic class Day {\n    @Id\n    private Long timestamp;\n    private String description, content;\n    private int steps;\n    private String mainImage;\n//    private MultipartFile mainImage;\n\n    public Day(Long timestamp) {\n        this.timestamp = timestamp;\n        this.mainImage = &quot;NoPhoto.png&quot;;\n        this.description = &quot;No brief description&quot;;\n        this.steps = 0;\n        this.content = &quot;No content&quot;;\n    }\n\n    public Day(Long timestamp, String mainImage, String description, String content, int steps) {\n        this.timestamp = timestamp;\n        this.mainImage = mainImage;\n        this.description = description;\n        this.content = content;\n        this.steps = steps;\n    }\n\n    // toString()\n    // getters/setters\n}\n</code></pre>\n<p><strong>full_day.html:</strong></p>\n<pre class=\"lang-html prettyprint-override\"><code>&lt;!-- some code --&gt;\n&lt;div id=&quot;edit-modal&quot; class=&quot;edit-modal&quot;&gt;\n    &lt;div class=&quot;edit-content&quot;&gt;\n        &lt;span class=&quot;close&quot;&gt;&amp;times;&lt;/span&gt;\n        &lt;h2&gt;Edit Day Window&lt;/h2&gt;\n\n        &lt;form method=&quot;post&quot; th:object=&quot;${gotDay}&quot;&gt;\n            &lt;label for=&quot;steps&quot;&gt;Daily steps&lt;/label&gt;\n            &lt;input value=&quot;${day.steps}&quot; th:field=&quot;*{steps}&quot; id=&quot;steps&quot; type=&quot;number&quot; tabindex=&quot;1&quot; placeholder=&quot;10000&quot;&gt;\n\n            &lt;label for=&quot;description&quot;&gt;Description&lt;/label&gt;\n            &lt;input value=&quot;${day.description}&quot; th:field=&quot;*{description}&quot; id=&quot;description&quot; type=&quot;text&quot; tabindex=&quot;2&quot; placeholder=&quot;Enter day's description&quot;&gt;\n\n            &lt;label for=&quot;content&quot;&gt;Content&lt;/label&gt;\n            &lt;textarea th:text=&quot;${day.content}&quot; th:field=&quot;*{content}&quot; id=&quot;content&quot; tabindex=&quot;3&quot; placeholder=&quot;Enter day's content&quot;&gt;&lt;/textarea&gt;\n            &lt;input type=&quot;submit&quot; tabindex=&quot;4&quot; class=&quot;left-right&quot; id=&quot;editSubmit&quot; value=&quot;Save&quot;&gt;\n        &lt;/form&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n\n// some js to interract with modal window\n</code></pre>\n<p>I watched videos, searched info in websites, but I didn't find what I wanted. I tried some code that ChatGPT wrote for me, but it couldn't help me.</p>\n"},{"tags":["java","multithreading"],"comments":[{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":2,"creation_date":1694342229,"post_id":77075732,"comment_id":135876205,"body_markdown":"Threads run instructions and are mapped to cores. One thread is associated with at most one core at any one point in time. Therefore, each instruction is associated with exactly on e thread. Each instruction is executed on exactly one core, therefore bound to exactly one thread. `Thread.currentThread()` is the thread that executes the current statement (or thread of executions, to be precise).","body":"Threads run instructions and are mapped to cores. One thread is associated with at most one core at any one point in time. Therefore, each instruction is associated with exactly on e thread. Each instruction is executed on exactly one core, therefore bound to exactly one thread. <code>Thread.currentThread()</code> is the thread that executes the current statement (or thread of executions, to be precise)."},{"owner":{"account_id":31180,"reputation":29173,"user_id":85421,"display_name":"user85421"},"score":1,"creation_date":1694342629,"post_id":77075732,"comment_id":135876247,"body_markdown":"it is just the same `Thread` that is calling the `sleep` method (this is not necessarily related (directly) to any core)","body":"it is just the same <code>Thread</code> that is calling the <code>sleep</code> method (this is not necessarily related (directly) to any core)"},{"owner":{"account_id":213468,"reputation":103500,"user_id":466862,"display_name":"Mark Rotteveel"},"score":1,"creation_date":1694342895,"post_id":77075732,"comment_id":135876277,"body_markdown":"The call to method `currentThread()` is executed on a specific thread, that thread is identified through native code and returned.","body":"The call to method <code>currentThread()</code> is executed on a specific thread, that thread is identified through native code and returned."},{"owner":{"account_id":483434,"reputation":25487,"user_id":898478,"accept_rate":86,"display_name":"m0skit0"},"score":1,"creation_date":1694343198,"post_id":77075732,"comment_id":135876323,"body_markdown":"You might want to look at how threading is implemented for a given OS (e.g. libc in Linux).","body":"You might want to look at how threading is implemented for a given OS (e.g. libc in Linux)."}],"answers":[{"comments":[{"owner":{"account_id":4200525,"reputation":61370,"user_id":3440745,"display_name":"Tsyvarev"},"score":0,"creation_date":1694371492,"post_id":77075906,"comment_id":135879140,"body_markdown":"&quot;The name is left over from ancient times when computers only had one CPU each.&quot; - I find the name `currentThread` to be perfectly applicable to the multicore too. E.g. it is the &quot;thread which currently executes our code&quot;. It describes the **multithreading** aspect, not a multicore one.","body":"&quot;The name is left over from ancient times when computers only had one CPU each.&quot; - I find the name <code>currentThread</code> to be perfectly applicable to the multicore too. E.g. it is the &quot;thread which currently executes our code&quot;. It describes the <b>multithreading</b> aspect, not a multicore one."},{"owner":{"account_id":422870,"reputation":25925,"user_id":801894,"display_name":"Solomon Slow"},"score":0,"creation_date":1694372524,"post_id":77075906,"comment_id":135879229,"body_markdown":"@Tsyvarev, Sure, but which thread is &quot;current&quot; when multiple threads currently are executing our code? Depends what you think &quot;current&quot; means. A name like `Thread.self()` would have caused less confusion. But the original authors of the Java language were some pretty smart dudes. If they didn&#39;t think of it at the time, then I can&#39;t pretend that I would have thought of it back then either.","body":"@Tsyvarev, Sure, but which thread is &quot;current&quot; when multiple threads currently are executing our code? Depends what you think &quot;current&quot; means. A name like <code>Thread.self()</code> would have caused less confusion. But the original authors of the Java language were some pretty smart dudes. If they didn&#39;t think of it at the time, then I can&#39;t pretend that I would have thought of it back then either."},{"owner":{"account_id":422870,"reputation":25925,"user_id":801894,"display_name":"Solomon Slow"},"score":0,"creation_date":1694372698,"post_id":77075906,"comment_id":135879245,"body_markdown":"P.S., where the name _really_ comes from: In a single-CPU OS, there would have been a variable in the kernel code that pointed to the context record for the thread that currently was being executed by the CPU. The variable would have a name like `current_thread`, and the system call that a user-mode function could call to find out the identity of the thread that was executing it was pretty much just a &quot;getter&quot; for that kernel variable.","body":"P.S., where the name <i>really</i> comes from: In a single-CPU OS, there would have been a variable in the kernel code that pointed to the context record for the thread that currently was being executed by the CPU. The variable would have a name like <code>current_thread</code>, and the system call that a user-mode function could call to find out the identity of the thread that was executing it was pretty much just a &quot;getter&quot; for that kernel variable."},{"owner":{"account_id":4200525,"reputation":61370,"user_id":3440745,"display_name":"Tsyvarev"},"score":0,"creation_date":1694373512,"post_id":77075906,"comment_id":135879343,"body_markdown":"&quot;A name like `Thread.self()` would have caused less confusion.&quot; - Assuming a `Thread` is a threading **library**, and not a representation of the specific thread, I find the method `.self` even more confusing (as pointing to the library, not to the thread). Actually, I don&#39;t think that there is a name which would represent a conception of the &quot;current thread&quot; in non-confusing way. But &quot;Current Thread&quot; is de-facto a standard name for the concept, and it is used in many programming languages.","body":"&quot;A name like <code>Thread.self()</code> would have caused less confusion.&quot; - Assuming a <code>Thread</code> is a threading <b>library</b>, and not a representation of the specific thread, I find the method <code>.self</code> even more confusing (as pointing to the library, not to the thread). Actually, I don&#39;t think that there is a name which would represent a conception of the &quot;current thread&quot; in non-confusing way. But &quot;Current Thread&quot; is de-facto a standard name for the concept, and it is used in many programming languages."}],"tags":[],"owner":{"account_id":422870,"reputation":25925,"user_id":801894,"display_name":"Solomon Slow"},"comment_count":4,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1694345147,"creation_date":1694345147,"answer_id":77075906,"question_id":77075732,"body_markdown":"&quot;Current thread&quot; does not mean what you think it means. What it means is, the thread that called the `Thread.currentThread()` function. The name is left over from ancient times when computers only had one CPU each. In those days, only one thread could be &quot;current,&quot; and so the thread that called the function and the current thread were one and the same. ","title":"Thread.currentThread in case of parallel threads","body":"<p>&quot;Current thread&quot; does not mean what you think it means. What it means is, the thread that called the <code>Thread.currentThread()</code> function. The name is left over from ancient times when computers only had one CPU each. In those days, only one thread could be &quot;current,&quot; and so the thread that called the function and the current thread were one and the same.</p>\n"}],"owner":{"account_id":2846397,"reputation":6438,"user_id":2444661,"accept_rate":55,"display_name":"Mandroid"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":59,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":77075906,"answer_count":1,"score":1,"last_activity_date":1694345147,"creation_date":1694342054,"question_id":77075732,"body_markdown":"Current implementation of Thread.sleep is:\r\n\r\n    public static void sleep(long millis) throws InterruptedException {\r\n        if (millis &lt; 0L) {\r\n            throw new IllegalArgumentException(&quot;timeout value is negative&quot;);\r\n        } else {\r\n            Thread var3 = currentThread();\r\n    .....\r\n\r\ncurrentThread is native method.\r\nIn a multi-core system we can have multiple threads actually running at same time.\r\n\r\nHow is current thread then decided?","title":"Thread.currentThread in case of parallel threads","body":"<p>Current implementation of Thread.sleep is:</p>\n<pre><code>public static void sleep(long millis) throws InterruptedException {\n    if (millis &lt; 0L) {\n        throw new IllegalArgumentException(&quot;timeout value is negative&quot;);\n    } else {\n        Thread var3 = currentThread();\n.....\n</code></pre>\n<p>currentThread is native method.\nIn a multi-core system we can have multiple threads actually running at same time.</p>\n<p>How is current thread then decided?</p>\n"},{"tags":["java","maven","graphql","runtime-error","micronaut"],"owner":{"account_id":4145529,"reputation":33,"user_id":3399383,"display_name":"user3399383"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":132,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694345101,"creation_date":1694345101,"question_id":77075901,"body_markdown":"I currently have an existing Micronaut server project that containing multiple endpoints. I&#39;m considering incorporating an additional GraphQL endpoint and introducing management endpoints for a new feature. However, whenever I add one of these dependencies (micronaut-graphql or micronaut-management), the software fails to start and consistently generates the following error message:\r\n\r\n```\r\n←[36m13:12:08.804←[0;39m ←[1;30m[main]←[0;39m ←[1;31mERROR←[0;39m ←[35mio.micronaut.runtime.Micronaut←[0;39m - Error starting Micronaut server: Error instantiating bean of type  [io.micronaut.web.router.DefaultRouter]\r\n\r\nMessage: Bean of type [class io.micronaut.context.DefaultApplicationContext$RuntimeConfiguredEnvironment] is a manually registered singleton that was registered with the context via BeanContext.registerBean(..) and cannot be created directly\r\nPath Taken: NettyEmbeddedServer.buildDefaultServer(NettyHttpServerConfiguration configuration) --&gt; new DefaultNettyEmbeddedServerFactory(ApplicationContext applicationContext,[RouteExecutor routeExecutor],MediaTypeCodecRegistry mediaTypeCodecRegistry,StaticResourceResolver staticResourceResolver,ThreadFactory nettyThreadFactory,HttpCompressionStrategy httpCompressionStrategy,EventLoopGroupFactory eventLoopGroupFactory,EventLoopGroupRegistry eventLoopGroupRegistry) --&gt; new RouteExecutor([Router router],BeanContext beanContext,RequestArgumentSatisfier requestArgumentSatisfier,HttpServerConfiguration serverConfiguration,ErrorResponseProcessor errorResponseProcessor,ExecutorSelector executorSelector) --&gt; new DefaultRouter([Collection builders])\r\nio.micronaut.context.exceptions.BeanInstantiationException: Error instantiating bean of type  [io.micronaut.web.router.DefaultRouter]\r\n\r\nMessage: Bean of type [class io.micronaut.context.DefaultApplicationContext$RuntimeConfiguredEnvironment] is a manually registered singleton that was registered with the context via BeanContext.registerBean(..) and cannot be created directly\r\nPath Taken: NettyEmbeddedServer.buildDefaultServer(NettyHttpServerConfiguration configuration) --&gt; new DefaultNettyEmbeddedServerFactory(ApplicationContext applicationContext,[RouteExecutor routeExecutor],MediaTypeCodecRegistry mediaTypeCodecRegistry,StaticResourceResolver staticResourceResolver,ThreadFactory nettyThreadFactory,HttpCompressionStrategy httpCompressionStrategy,EventLoopGroupFactory eventLoopGroupFactory,EventLoopGroupRegistry eventLoopGroupRegistry) --&gt; new RouteExecutor([Router router],BeanContext beanContext,RequestArgumentSatisfier requestArgumentSatisfier,HttpServerConfiguration serverConfiguration,ErrorResponseProcessor errorResponseProcessor,ExecutorSelector executorSelector) --&gt; new DefaultRouter([Collection builders])\r\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2367)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2305)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\r\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\r\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\r\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2853)\r\n        at io.micronaut.context.DefaultBeanContext.addCandidateToList(DefaultBeanContext.java:3511)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistrations(DefaultBeanContext.java:3457)\r\n        at io.micronaut.context.DefaultBeanContext.getBeanRegistrations(DefaultBeanContext.java:3427)\r\n        at io.micronaut.context.DefaultBeanContext.getBeansOfType(DefaultBeanContext.java:1381)\r\n        at io.micronaut.context.AbstractBeanResolutionContext.getBeansOfType(AbstractBeanResolutionContext.java:72)\r\n        at io.micronaut.context.AbstractInitializableBeanDefinition.resolveBeansOfType(AbstractInitializableBeanDefinition.java:2161)\r\n        at io.micronaut.context.AbstractInitializableBeanDefinition.getBeansOfTypeForConstructorArgument(AbstractInitializableBeanDefinition.java:1437)\r\n        at io.micronaut.web.router.$DefaultRouter$Definition.build(Unknown Source)\r\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2354)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2305)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\r\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\r\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\r\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2800)\r\n        at io.micronaut.context.DefaultBeanContext.getBean(DefaultBeanContext.java:1617)\r\n        at io.micronaut.context.AbstractBeanResolutionContext.getBean(AbstractBeanResolutionContext.java:66)\r\n        at io.micronaut.context.AbstractInitializableBeanDefinition.resolveBean(AbstractInitializableBeanDefinition.java:2065)\r\n        at io.micronaut.context.AbstractInitializableBeanDefinition.getBeanForConstructorArgument(AbstractInitializableBeanDefinition.java:1297)\r\n        at io.micronaut.http.server.$RouteExecutor$Definition.build(Unknown Source)\r\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2354)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2305)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\r\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\r\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\r\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2800)\r\n        at io.micronaut.context.DefaultBeanContext.getBean(DefaultBeanContext.java:1617)\r\n        at io.micronaut.context.AbstractBeanResolutionContext.getBean(AbstractBeanResolutionContext.java:66)\r\n        at io.micronaut.context.AbstractInitializableBeanDefinition.resolveBean(AbstractInitializableBeanDefinition.java:2065)\r\n        at io.micronaut.context.AbstractInitializableBeanDefinition.getBeanForConstructorArgument(AbstractInitializableBeanDefinition.java:1297)\r\n        at io.micronaut.http.server.netty.$DefaultNettyEmbeddedServerFactory$Definition.build(Unknown Source)\r\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2354)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2305)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\r\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\r\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\r\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2800)\r\n        at io.micronaut.context.DefaultBeanContext.getBean(DefaultBeanContext.java:1617)\r\n        at io.micronaut.context.DefaultBeanContext.getBean(DefaultBeanContext.java:1599)\r\n        at io.micronaut.http.server.netty.$DefaultNettyEmbeddedServerFactory$BuildDefaultServer0$Definition.build(Unknown Source)\r\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2354)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2305)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\r\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\r\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\r\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2800)\r\n        at io.micronaut.context.DefaultBeanContext.findBean(DefaultBeanContext.java:1680)\r\n        at io.micronaut.context.DefaultBeanContext.findBean(DefaultBeanContext.java:1655)\r\n        at io.micronaut.context.DefaultBeanContext.findBean(DefaultBeanContext.java:878)\r\n        at io.micronaut.context.BeanLocator.findBean(BeanLocator.java:291)\r\n        at io.micronaut.runtime.Micronaut.start(Micronaut.java:77)\r\n        at io.micronaut.runtime.Micronaut.run(Micronaut.java:323)\r\n        at io.micronaut.runtime.Micronaut.run(Micronaut.java:309)\r\n        at demo.Main.main(Main.java:10)\r\nCaused by: java.lang.UnsupportedOperationException: Bean of type [class io.micronaut.context.DefaultApplicationContext$RuntimeConfiguredEnvironment] is a manually registered singleton that was registered with the context via BeanContext.registerBean(..) and cannot be created directly\r\n        at io.micronaut.context.NoInjectionBeanDefinition.getConstructor(NoInjectionBeanDefinition.java:131)\r\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanDefinition(DefaultBeanContext.java:2315)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2307)\r\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\r\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\r\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\r\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\r\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2800)\r\n        at io.micronaut.context.DefaultBeanContext.getBean(DefaultBeanContext.java:1617)\r\n        at io.micronaut.context.AbstractBeanResolutionContext.getBean(AbstractBeanResolutionContext.java:66)\r\n        at io.micronaut.context.AbstractInitializableBeanDefinition.resolveBean(AbstractInitializableBeanDefinition.java:2065)\r\n        at io.micronaut.context.AbstractInitializableBeanDefinition.getBeanForConstructorArgument(AbstractInitializableBeanDefinition.java:1297)\r\n        at io.micronaut.management.endpoint.processors.$DeleteEndpointRouteBuilder$Definition.build(Unknown Source)\r\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2354)\r\n        ... 68 common frames omitted\r\n```\r\n\r\n\r\nFor reproducing the problem I created a small example project here (without having the dependencies and tests for /health and /graphql enabled here:\r\n\r\n[GitHub Repo](https://github.com/HPIMartin/MicronautDemo/tree/main)\r\n\r\nIf the dependencies are added the tests are green but if I build the jar file e.g. using the provided dockerfile the resulting jar is failing.","title":"Micronaut - Exception: manualy registered singleton by adding framework dependecy","body":"<p>I currently have an existing Micronaut server project that containing multiple endpoints. I'm considering incorporating an additional GraphQL endpoint and introducing management endpoints for a new feature. However, whenever I add one of these dependencies (micronaut-graphql or micronaut-management), the software fails to start and consistently generates the following error message:</p>\n<pre><code>←[36m13:12:08.804←[0;39m ←[1;30m[main]←[0;39m ←[1;31mERROR←[0;39m ←[35mio.micronaut.runtime.Micronaut←[0;39m - Error starting Micronaut server: Error instantiating bean of type  [io.micronaut.web.router.DefaultRouter]\n\nMessage: Bean of type [class io.micronaut.context.DefaultApplicationContext$RuntimeConfiguredEnvironment] is a manually registered singleton that was registered with the context via BeanContext.registerBean(..) and cannot be created directly\nPath Taken: NettyEmbeddedServer.buildDefaultServer(NettyHttpServerConfiguration configuration) --&gt; new DefaultNettyEmbeddedServerFactory(ApplicationContext applicationContext,[RouteExecutor routeExecutor],MediaTypeCodecRegistry mediaTypeCodecRegistry,StaticResourceResolver staticResourceResolver,ThreadFactory nettyThreadFactory,HttpCompressionStrategy httpCompressionStrategy,EventLoopGroupFactory eventLoopGroupFactory,EventLoopGroupRegistry eventLoopGroupRegistry) --&gt; new RouteExecutor([Router router],BeanContext beanContext,RequestArgumentSatisfier requestArgumentSatisfier,HttpServerConfiguration serverConfiguration,ErrorResponseProcessor errorResponseProcessor,ExecutorSelector executorSelector) --&gt; new DefaultRouter([Collection builders])\nio.micronaut.context.exceptions.BeanInstantiationException: Error instantiating bean of type  [io.micronaut.web.router.DefaultRouter]\n\nMessage: Bean of type [class io.micronaut.context.DefaultApplicationContext$RuntimeConfiguredEnvironment] is a manually registered singleton that was registered with the context via BeanContext.registerBean(..) and cannot be created directly\nPath Taken: NettyEmbeddedServer.buildDefaultServer(NettyHttpServerConfiguration configuration) --&gt; new DefaultNettyEmbeddedServerFactory(ApplicationContext applicationContext,[RouteExecutor routeExecutor],MediaTypeCodecRegistry mediaTypeCodecRegistry,StaticResourceResolver staticResourceResolver,ThreadFactory nettyThreadFactory,HttpCompressionStrategy httpCompressionStrategy,EventLoopGroupFactory eventLoopGroupFactory,EventLoopGroupRegistry eventLoopGroupRegistry) --&gt; new RouteExecutor([Router router],BeanContext beanContext,RequestArgumentSatisfier requestArgumentSatisfier,HttpServerConfiguration serverConfiguration,ErrorResponseProcessor errorResponseProcessor,ExecutorSelector executorSelector) --&gt; new DefaultRouter([Collection builders])\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2367)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2305)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2853)\n        at io.micronaut.context.DefaultBeanContext.addCandidateToList(DefaultBeanContext.java:3511)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistrations(DefaultBeanContext.java:3457)\n        at io.micronaut.context.DefaultBeanContext.getBeanRegistrations(DefaultBeanContext.java:3427)\n        at io.micronaut.context.DefaultBeanContext.getBeansOfType(DefaultBeanContext.java:1381)\n        at io.micronaut.context.AbstractBeanResolutionContext.getBeansOfType(AbstractBeanResolutionContext.java:72)\n        at io.micronaut.context.AbstractInitializableBeanDefinition.resolveBeansOfType(AbstractInitializableBeanDefinition.java:2161)\n        at io.micronaut.context.AbstractInitializableBeanDefinition.getBeansOfTypeForConstructorArgument(AbstractInitializableBeanDefinition.java:1437)\n        at io.micronaut.web.router.$DefaultRouter$Definition.build(Unknown Source)\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2354)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2305)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2800)\n        at io.micronaut.context.DefaultBeanContext.getBean(DefaultBeanContext.java:1617)\n        at io.micronaut.context.AbstractBeanResolutionContext.getBean(AbstractBeanResolutionContext.java:66)\n        at io.micronaut.context.AbstractInitializableBeanDefinition.resolveBean(AbstractInitializableBeanDefinition.java:2065)\n        at io.micronaut.context.AbstractInitializableBeanDefinition.getBeanForConstructorArgument(AbstractInitializableBeanDefinition.java:1297)\n        at io.micronaut.http.server.$RouteExecutor$Definition.build(Unknown Source)\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2354)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2305)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2800)\n        at io.micronaut.context.DefaultBeanContext.getBean(DefaultBeanContext.java:1617)\n        at io.micronaut.context.AbstractBeanResolutionContext.getBean(AbstractBeanResolutionContext.java:66)\n        at io.micronaut.context.AbstractInitializableBeanDefinition.resolveBean(AbstractInitializableBeanDefinition.java:2065)\n        at io.micronaut.context.AbstractInitializableBeanDefinition.getBeanForConstructorArgument(AbstractInitializableBeanDefinition.java:1297)\n        at io.micronaut.http.server.netty.$DefaultNettyEmbeddedServerFactory$Definition.build(Unknown Source)\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2354)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2305)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2800)\n        at io.micronaut.context.DefaultBeanContext.getBean(DefaultBeanContext.java:1617)\n        at io.micronaut.context.DefaultBeanContext.getBean(DefaultBeanContext.java:1599)\n        at io.micronaut.http.server.netty.$DefaultNettyEmbeddedServerFactory$BuildDefaultServer0$Definition.build(Unknown Source)\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2354)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2305)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2800)\n        at io.micronaut.context.DefaultBeanContext.findBean(DefaultBeanContext.java:1680)\n        at io.micronaut.context.DefaultBeanContext.findBean(DefaultBeanContext.java:1655)\n        at io.micronaut.context.DefaultBeanContext.findBean(DefaultBeanContext.java:878)\n        at io.micronaut.context.BeanLocator.findBean(BeanLocator.java:291)\n        at io.micronaut.runtime.Micronaut.start(Micronaut.java:77)\n        at io.micronaut.runtime.Micronaut.run(Micronaut.java:323)\n        at io.micronaut.runtime.Micronaut.run(Micronaut.java:309)\n        at demo.Main.main(Main.java:10)\nCaused by: java.lang.UnsupportedOperationException: Bean of type [class io.micronaut.context.DefaultApplicationContext$RuntimeConfiguredEnvironment] is a manually registered singleton that was registered with the context via BeanContext.registerBean(..) and cannot be created directly\n        at io.micronaut.context.NoInjectionBeanDefinition.getConstructor(NoInjectionBeanDefinition.java:131)\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanDefinition(DefaultBeanContext.java:2315)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2307)\n        at io.micronaut.context.DefaultBeanContext.doCreateBean(DefaultBeanContext.java:2251)\n        at io.micronaut.context.DefaultBeanContext.createRegistration(DefaultBeanContext.java:3016)\n        at io.micronaut.context.SingletonScope.getOrCreate(SingletonScope.java:80)\n        at io.micronaut.context.DefaultBeanContext.findOrCreateSingletonBeanRegistration(DefaultBeanContext.java:2918)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2879)\n        at io.micronaut.context.DefaultBeanContext.resolveBeanRegistration(DefaultBeanContext.java:2800)\n        at io.micronaut.context.DefaultBeanContext.getBean(DefaultBeanContext.java:1617)\n        at io.micronaut.context.AbstractBeanResolutionContext.getBean(AbstractBeanResolutionContext.java:66)\n        at io.micronaut.context.AbstractInitializableBeanDefinition.resolveBean(AbstractInitializableBeanDefinition.java:2065)\n        at io.micronaut.context.AbstractInitializableBeanDefinition.getBeanForConstructorArgument(AbstractInitializableBeanDefinition.java:1297)\n        at io.micronaut.management.endpoint.processors.$DeleteEndpointRouteBuilder$Definition.build(Unknown Source)\n        at io.micronaut.context.DefaultBeanContext.resolveByBeanFactory(DefaultBeanContext.java:2354)\n        ... 68 common frames omitted\n</code></pre>\n<p>For reproducing the problem I created a small example project here (without having the dependencies and tests for /health and /graphql enabled here:</p>\n<p><a href=\"https://github.com/HPIMartin/MicronautDemo/tree/main\" rel=\"nofollow noreferrer\">GitHub Repo</a></p>\n<p>If the dependencies are added the tests are green but if I build the jar file e.g. using the provided dockerfile the resulting jar is failing.</p>\n"},{"tags":["java","video","android-framelayout","mediacontroller"],"owner":{"account_id":29257311,"reputation":21,"user_id":22415222,"display_name":"Arianna Garaglia"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":10,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1694344261,"creation_date":1694344261,"question_id":77075852,"body_markdown":"I&#39;m trying to view videos in my app, but the problem is that the media controller doesn&#39;t stay docked to the video. In fact, if I scroll down the page, the media controller of the first video is located on the buttons\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\nthe code of the adapter is this:\r\n\r\n```\r\npublic void onBindViewHolder(@NonNull VideoViewHolder holder, int position) {\r\n        String videoURL = videoURLs.get(position);\r\n\r\n        VideoView videoView = holder.videoView;\r\n        FrameLayout customMediaController = holder.customMediaController;\r\n\r\n        // crea un mediaController personalizzato\r\n        MediaController mediaController = new MediaController(holder.itemView.getContext());\r\n        // collega la VideoView al MediaController\r\n        mediaController.setAnchorView(videoView);\r\n        // imposta il MediaController per la VideoView\r\n        videoView.setMediaController(mediaController);\r\n\r\n        // gestione manuale della posizione del MediaController\r\n        FrameLayout.LayoutParams layoutParams = new FrameLayout.LayoutParams(\r\n                FrameLayout.LayoutParams.WRAP_CONTENT,\r\n                FrameLayout.LayoutParams.WRAP_CONTENT\r\n        );\r\n        layoutParams.gravity = Gravity.CENTER;\r\n        customMediaController.setLayoutParams(layoutParams);\r\n\r\n        .......\r\n    } \r\n```\r\n\r\nthe code of the xml file is this:\r\n\r\n```\r\n&lt;RelativeLayout\r\n    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    android:layout_width=&quot;match_parent&quot;\r\n    android:layout_height=&quot;wrap_content&quot;\r\n    android:layout_marginTop=&quot;10dp&quot;&gt;\r\n\r\n    &lt;!-- Pulsante Play --&gt;\r\n    &lt;Button\r\n        android:id=&quot;@+id/playButton&quot;\r\n        android:layout_width=&quot;@dimen/larghezza_bottone_piccolo&quot;\r\n        android:layout_height=&quot;@dimen/altezza_bottone_piccolo&quot;\r\n        android:text=&quot;@string/avvia&quot;\r\n        android:layout_marginTop=&quot;3dp&quot;\r\n        android:layout_marginStart=&quot;50dp&quot; /&gt;\r\n\r\n    &lt;FrameLayout\r\n        android:id=&quot;@+id/video_container&quot;\r\n        android:layout_width=&quot;wrap_content&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:layout_marginTop=&quot;10dp&quot;\r\n        android:layout_centerHorizontal=&quot;true&quot;\r\n        android:layout_below=&quot;@+id/playButton&quot;&gt;\r\n\r\n        &lt;VideoView\r\n            android:id=&quot;@+id/videoView&quot;\r\n            android:layout_width=&quot;300dp&quot;\r\n            android:layout_height=&quot;300dp&quot;\r\n            /&gt;\r\n\r\n        &lt;FrameLayout\r\n            android:id=&quot;@+id/custom_media_controller&quot;\r\n            android:layout_width=&quot;300dp&quot;\r\n            android:layout_height=&quot;300dp&quot;&gt;\r\n        &lt;/FrameLayout&gt;\r\n    &lt;/FrameLayout&gt;\r\n\r\n    &lt;com.google.android.material.floatingactionbutton.FloatingActionButton\r\n        android:id=&quot;@+id/deleteButton&quot;\r\n        android:layout_width=&quot;wrap_content&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:src=&quot;@drawable/delete_icon&quot;\r\n        android:contentDescription=&quot;@string/elimina&quot;\r\n        android:layout_marginTop=&quot;3dp&quot;\r\n        android:layout_marginStart=&quot;20dp&quot;\r\n        android:layout_toRightOf=&quot;@+id/playButton&quot;/&gt;\r\n\r\n    &lt;com.google.android.material.floatingactionbutton.FloatingActionButton\r\n        android:id=&quot;@+id/downloadButton&quot;\r\n        android:layout_width=&quot;wrap_content&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:src=&quot;@drawable/baseline_download_24&quot;\r\n        android:contentDescription=&quot;@string/download&quot;\r\n        android:layout_marginTop=&quot;3dp&quot;\r\n        android:layout_toRightOf=&quot;@+id/deleteButton&quot;\r\n        android:layout_marginStart=&quot;20dp&quot; /&gt;\r\n\r\n&lt;/RelativeLayout&gt;\r\n```\r\n\r\nI can&#39;t solve this problem, i&#39;ve tried so many things\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/UiTJz.jpg","title":"mediacontroller not anchored to video frame layout","body":"<p>I'm trying to view videos in my app, but the problem is that the media controller doesn't stay docked to the video. In fact, if I scroll down the page, the media controller of the first video is located on the buttons</p>\n<p><a href=\"https://i.stack.imgur.com/UiTJz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UiTJz.jpg\" alt=\"enter image description here\" /></a></p>\n<p>the code of the adapter is this:</p>\n<pre><code>public void onBindViewHolder(@NonNull VideoViewHolder holder, int position) {\n        String videoURL = videoURLs.get(position);\n\n        VideoView videoView = holder.videoView;\n        FrameLayout customMediaController = holder.customMediaController;\n\n        // crea un mediaController personalizzato\n        MediaController mediaController = new MediaController(holder.itemView.getContext());\n        // collega la VideoView al MediaController\n        mediaController.setAnchorView(videoView);\n        // imposta il MediaController per la VideoView\n        videoView.setMediaController(mediaController);\n\n        // gestione manuale della posizione del MediaController\n        FrameLayout.LayoutParams layoutParams = new FrameLayout.LayoutParams(\n                FrameLayout.LayoutParams.WRAP_CONTENT,\n                FrameLayout.LayoutParams.WRAP_CONTENT\n        );\n        layoutParams.gravity = Gravity.CENTER;\n        customMediaController.setLayoutParams(layoutParams);\n\n        .......\n    } \n</code></pre>\n<p>the code of the xml file is this:</p>\n<pre><code>&lt;RelativeLayout\n    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;wrap_content&quot;\n    android:layout_marginTop=&quot;10dp&quot;&gt;\n\n    &lt;!-- Pulsante Play --&gt;\n    &lt;Button\n        android:id=&quot;@+id/playButton&quot;\n        android:layout_width=&quot;@dimen/larghezza_bottone_piccolo&quot;\n        android:layout_height=&quot;@dimen/altezza_bottone_piccolo&quot;\n        android:text=&quot;@string/avvia&quot;\n        android:layout_marginTop=&quot;3dp&quot;\n        android:layout_marginStart=&quot;50dp&quot; /&gt;\n\n    &lt;FrameLayout\n        android:id=&quot;@+id/video_container&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:layout_marginTop=&quot;10dp&quot;\n        android:layout_centerHorizontal=&quot;true&quot;\n        android:layout_below=&quot;@+id/playButton&quot;&gt;\n\n        &lt;VideoView\n            android:id=&quot;@+id/videoView&quot;\n            android:layout_width=&quot;300dp&quot;\n            android:layout_height=&quot;300dp&quot;\n            /&gt;\n\n        &lt;FrameLayout\n            android:id=&quot;@+id/custom_media_controller&quot;\n            android:layout_width=&quot;300dp&quot;\n            android:layout_height=&quot;300dp&quot;&gt;\n        &lt;/FrameLayout&gt;\n    &lt;/FrameLayout&gt;\n\n    &lt;com.google.android.material.floatingactionbutton.FloatingActionButton\n        android:id=&quot;@+id/deleteButton&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:src=&quot;@drawable/delete_icon&quot;\n        android:contentDescription=&quot;@string/elimina&quot;\n        android:layout_marginTop=&quot;3dp&quot;\n        android:layout_marginStart=&quot;20dp&quot;\n        android:layout_toRightOf=&quot;@+id/playButton&quot;/&gt;\n\n    &lt;com.google.android.material.floatingactionbutton.FloatingActionButton\n        android:id=&quot;@+id/downloadButton&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:src=&quot;@drawable/baseline_download_24&quot;\n        android:contentDescription=&quot;@string/download&quot;\n        android:layout_marginTop=&quot;3dp&quot;\n        android:layout_toRightOf=&quot;@+id/deleteButton&quot;\n        android:layout_marginStart=&quot;20dp&quot; /&gt;\n\n&lt;/RelativeLayout&gt;\n</code></pre>\n<p>I can't solve this problem, i've tried so many things</p>\n"},{"tags":["java","concurrency","thread-safety","synchronized"],"comments":[{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":1,"creation_date":1694333058,"post_id":77072580,"comment_id":135875355,"body_markdown":"Don&#39;t put your questions into the comments. You can see for yourself that they are almost invisible. Put them into the text part of your question.","body":"Don&#39;t put your questions into the comments. You can see for yourself that they are almost invisible. Put them into the text part of your question."}],"answers":[{"comments":[{"owner":{"account_id":7828782,"reputation":150,"user_id":7356882,"display_name":"HyperVol"},"score":0,"creation_date":1694291645,"post_id":77072609,"comment_id":135872975,"body_markdown":"That&#39;s correct , but putIfAbsent returns old value so i doubt it&#39;ll be useful here","body":"That&#39;s correct , but putIfAbsent returns old value so i doubt it&#39;ll be useful here"},{"owner":{"account_id":5998820,"reputation":12676,"user_id":4712734,"display_name":"DuncG"},"score":2,"creation_date":1694293558,"post_id":77072609,"comment_id":135873133,"body_markdown":"@Hypervol Your logic is flawed as two threads can get past `store.containsKey(name)` as false, and both evaluate `putIfAbsent`. One putIfAbsent call will return null, and the other will return the `new Item()` of the other thread. Because you don&#39;t check, a different version of newItem gets returned by the &quot;losing&quot; caller. With `computeIfAbsent` there is never inconsistent return for same name.","body":"@Hypervol Your logic is flawed as two threads can get past <code>store.containsKey(name)</code> as false, and both evaluate <code>putIfAbsent</code>. One putIfAbsent call will return null, and the other will return the <code>new Item()</code> of the other thread. Because you don&#39;t check, a different version of newItem gets returned by the &quot;losing&quot; caller. With <code>computeIfAbsent</code> there is never inconsistent return for same name."},{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":2,"creation_date":1694333140,"post_id":77072609,"comment_id":135875366,"body_markdown":"@HyperVol That&#39;s correct, it returns the old value instead of putting the new value. How is that not useful?","body":"@HyperVol That&#39;s correct, it returns the old value instead of putting the new value. How is that not useful?"}],"tags":[],"owner":{"account_id":5998820,"reputation":12676,"user_id":4712734,"display_name":"DuncG"},"comment_count":3,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1694329438,"creation_date":1694268756,"answer_id":77072609,"question_id":77072580,"body_markdown":"You are ignoring the return value of `putIfAbsent` which would allow you to return consistent values. \r\n\r\nHowever you can replace most of the method by a single call to\r\n\r\n    return map.computeIfAbsent(name, key -&gt; new Item());","title":"Thread Safety in operations involving ConcurrentHashMap in Java","body":"<p>You are ignoring the return value of <code>putIfAbsent</code> which would allow you to return consistent values.</p>\n<p>However you can replace most of the method by a single call to</p>\n<pre><code>return map.computeIfAbsent(name, key -&gt; new Item());\n</code></pre>\n"},{"comments":[{"owner":{"account_id":7828782,"reputation":150,"user_id":7356882,"display_name":"HyperVol"},"score":0,"creation_date":1694292176,"post_id":77072879,"comment_id":135873019,"body_markdown":"Sounds good for this case. But, if there are some other actions in the same method, which need to be Atomic/thread-protected (actions not on store , but some other variable/resources) , what do you suggest in that case?","body":"Sounds good for this case. But, if there are some other actions in the same method, which need to be Atomic/thread-protected (actions not on store , but some other variable/resources) , what do you suggest in that case?"},{"owner":{"account_id":12635385,"reputation":527,"user_id":9185029,"display_name":"Alexander Katsenelenbogen"},"score":1,"creation_date":1694379810,"post_id":77072879,"comment_id":135879955,"body_markdown":"@HyperVol It really depends considering that there&#39;s a vast world of multithreaded possibilities. I.e. What resource are you protecting/Why? Do the actions you describe need to be in the same method? Why? What do they need to be &quot;synchronized&quot; with?","body":"@HyperVol It really depends considering that there&#39;s a vast world of multithreaded possibilities. I.e. What resource are you protecting/Why? Do the actions you describe need to be in the same method? Why? What do they need to be &quot;synchronized&quot; with?"}],"tags":[],"owner":{"account_id":12635385,"reputation":527,"user_id":9185029,"display_name":"Alexander Katsenelenbogen"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1694273171,"creation_date":1694273171,"answer_id":77072879,"question_id":77072580,"body_markdown":"As written, your method is not threadsafe. Why?\r\n\r\nIt is possible for two thread invocations of this method to reach this line and see a missing key:\r\n\r\n    if (store.containsKey(name)) {\r\n        throw new Exception(&quot;Already Exists&quot;);\r\n     }\r\nIf both invocations see the name key as missing, then your item now gets created twice. So what&#39;s the lesson here? Using ConcurrentHashMap on its own is not enough, at least not in the way you are using it. \r\n\r\nWhat you want to do is take advantage of ConcurrentHashMap&#39;s *atomic* methods. The answer posted by DuncG provides a way to do this:\r\n\r\n    return map.computeIfAbsent(name, () -&gt; new Item());\r\n\r\nNow, the ConcurrentHashMap takes care of the thread-safety for you, and you have no need of using the synchronized keyword. Effectively, it will check the map, create the object if it is missing, and return it, all atomically, without any concern for race conditions.\r\n\r\nAll that said, if your use case can tolerate two or more creations of the Item() and two or more versions floating around (by chance), then it may not be that big of a deal. That said, I&#39;d still recommend going with the computeIfAbsent approach since it guarantees consistent behavior.","title":"Thread Safety in operations involving ConcurrentHashMap in Java","body":"<p>As written, your method is not threadsafe. Why?</p>\n<p>It is possible for two thread invocations of this method to reach this line and see a missing key:</p>\n<pre><code>if (store.containsKey(name)) {\n    throw new Exception(&quot;Already Exists&quot;);\n }\n</code></pre>\n<p>If both invocations see the name key as missing, then your item now gets created twice. So what's the lesson here? Using ConcurrentHashMap on its own is not enough, at least not in the way you are using it.</p>\n<p>What you want to do is take advantage of ConcurrentHashMap's <em>atomic</em> methods. The answer posted by DuncG provides a way to do this:</p>\n<pre><code>return map.computeIfAbsent(name, () -&gt; new Item());\n</code></pre>\n<p>Now, the ConcurrentHashMap takes care of the thread-safety for you, and you have no need of using the synchronized keyword. Effectively, it will check the map, create the object if it is missing, and return it, all atomically, without any concern for race conditions.</p>\n<p>All that said, if your use case can tolerate two or more creations of the Item() and two or more versions floating around (by chance), then it may not be that big of a deal. That said, I'd still recommend going with the computeIfAbsent approach since it guarantees consistent behavior.</p>\n"}],"owner":{"account_id":7828782,"reputation":150,"user_id":7356882,"display_name":"HyperVol"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":62,"favorite_count":0,"down_vote_count":3,"up_vote_count":0,"accepted_answer_id":77072879,"answer_count":2,"score":-3,"last_activity_date":1694344234,"creation_date":1694268297,"question_id":77072580,"body_markdown":"Context: I&#39;m creating a new `Item`, caching it and returning it, however, its name must be unique. We&#39;re talking about multithreaded env. My questions are in the comments.\r\n\r\n```\r\nclass ItemOperations {\r\n\r\n    private ConcurrentMap&lt;String, Item&gt; store = new ConcurrentHashMap&lt;&gt;();\r\n\r\n    Item createItem(String name) throws Exception {\r\n\r\n        // I agree this operation is thread safe because of ConcurrentHashMap\r\n        if (store.containsKey(name)) {\r\n            throw new Exception(&quot;Already Exists&quot;);\r\n        }\r\n\r\n        // Item creation is Expensive operation\r\n        Item newItem = new Item();\r\n        // *Ques 1* : For above - multiple threads will create multiple different objects right ?\r\n\r\n\r\n        // putIfAbsent is again thread safe due to concurrentMap..\r\n        // Losing thread will not update the value.. (correct me if i&#39;m wrong)\r\n        store.putIfAbsent(&quot;newItemName&quot;, newItem);\r\n\r\n\r\n        // *Ques 2* : Separate threads will return different objects and\r\n        // the second thread will return a new object which is \r\n        //NOT present in the store but was created on the fly , hence returning incorrect data\r\n        return newItem;\r\n    }\r\n}\r\n```\r\nHow to fix this ?\r\n\r\nMy thoughts: Should the whole createItem() be wrapped in a synchronized(this) block? so that Item Object creation is thread safe ? If yes, we&#39;ll lose the benefits of ConcurrentHashmap and it&#39;ll further degrade performance.\r\n\r\nUsing put instead of putIfAbsent is worse - ensures data correctness, but useless multiple writes to hashmap - hence impacting performance.","title":"Thread Safety in operations involving ConcurrentHashMap in Java","body":"<p>Context: I'm creating a new <code>Item</code>, caching it and returning it, however, its name must be unique. We're talking about multithreaded env. My questions are in the comments.</p>\n<pre><code>class ItemOperations {\n\n    private ConcurrentMap&lt;String, Item&gt; store = new ConcurrentHashMap&lt;&gt;();\n\n    Item createItem(String name) throws Exception {\n\n        // I agree this operation is thread safe because of ConcurrentHashMap\n        if (store.containsKey(name)) {\n            throw new Exception(&quot;Already Exists&quot;);\n        }\n\n        // Item creation is Expensive operation\n        Item newItem = new Item();\n        // *Ques 1* : For above - multiple threads will create multiple different objects right ?\n\n\n        // putIfAbsent is again thread safe due to concurrentMap..\n        // Losing thread will not update the value.. (correct me if i'm wrong)\n        store.putIfAbsent(&quot;newItemName&quot;, newItem);\n\n\n        // *Ques 2* : Separate threads will return different objects and\n        // the second thread will return a new object which is \n        //NOT present in the store but was created on the fly , hence returning incorrect data\n        return newItem;\n    }\n}\n</code></pre>\n<p>How to fix this ?</p>\n<p>My thoughts: Should the whole createItem() be wrapped in a synchronized(this) block? so that Item Object creation is thread safe ? If yes, we'll lose the benefits of ConcurrentHashmap and it'll further degrade performance.</p>\n<p>Using put instead of putIfAbsent is worse - ensures data correctness, but useless multiple writes to hashmap - hence impacting performance.</p>\n"},{"tags":["java","apache","openid-connect","quarkus","mod-auth-openidc"],"comments":[{"owner":{"account_id":10801575,"reputation":1614,"user_id":7945344,"display_name":"Lucas Declercq"},"score":0,"creation_date":1685569596,"post_id":76375712,"comment_id":134680509,"body_markdown":"You should use a ContainerRequestFilter to manually read the headers and setup the security context and/or a RequestScoped custom bean containing the values you need. You can get inspiration from this post : https://stackoverflow.com/questions/66695265/how-to-retrieve-securitycontext-in-a-quarkus-application","body":"You should use a ContainerRequestFilter to manually read the headers and setup the security context and/or a RequestScoped custom bean containing the values you need. You can get inspiration from this post : <a href=\"https://stackoverflow.com/questions/66695265/how-to-retrieve-securitycontext-in-a-quarkus-application\" title=\"how to retrieve securitycontext in a quarkus application\">stackoverflow.com/questions/66695265/&hellip;</a>"}],"owner":{"account_id":14865200,"reputation":150,"user_id":10734565,"display_name":"Vinetos"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":92,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694342481,"creation_date":1685551551,"question_id":76375712,"body_markdown":"I run Quarkus behind an Apache Reverse Proxy.  \r\nThe Apache use `mod_auth_openidc` to authenticate the user and pass the `OIDC_CLAIM_*` HTTP headers to the applications behind.  \r\n\r\nHow to configure Quarkus to read the `OIDC_CLAIM_*` HTTP headers ? Is there a way to @Inject this in the &quot;quarkus&quot; way ?\r\n\r\nHere&#39;s the relevant HTTPD configuration : \r\n```xml\r\n&lt;Location /java&gt;\r\n   ProxyPreserveHost On\r\n   AuthType openid-connect\r\n   Require claim resource_access.apache-oidc.roles:admin-role\r\n\r\n   ProxyPass &quot;http://java-app:8080&quot;\r\n   ProxyPassReverse &quot;http://java-app:8080&quot;\r\n&lt;/Location&gt;\r\n```\r\n\r\nActually, the only way I have found using `@HeaderParam`\r\n```java\r\n@GET\r\npublic String get(@HeaderParam(&quot;OIDC_CLAIM_preferred_username&quot;) String username) {\r\n     return username;\r\n}\r\n```\r\n\r\nIt works but not the way it should. Can I use Quarkus to retrieve `OIDC_*` headers and access its content with the CDI ?\r\n\r\n\r\nThanks,","title":"How to use OIDC_CLAIM_* headers in Quarkus behind an Apache Reverse Proxy?","body":"<p>I run Quarkus behind an Apache Reverse Proxy.<br />\nThe Apache use <code>mod_auth_openidc</code> to authenticate the user and pass the <code>OIDC_CLAIM_*</code> HTTP headers to the applications behind.</p>\n<p>How to configure Quarkus to read the <code>OIDC_CLAIM_*</code> HTTP headers ? Is there a way to @Inject this in the &quot;quarkus&quot; way ?</p>\n<p>Here's the relevant HTTPD configuration :</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Location /java&gt;\n   ProxyPreserveHost On\n   AuthType openid-connect\n   Require claim resource_access.apache-oidc.roles:admin-role\n\n   ProxyPass &quot;http://java-app:8080&quot;\n   ProxyPassReverse &quot;http://java-app:8080&quot;\n&lt;/Location&gt;\n</code></pre>\n<p>Actually, the only way I have found using <code>@HeaderParam</code></p>\n<pre class=\"lang-java prettyprint-override\"><code>@GET\npublic String get(@HeaderParam(&quot;OIDC_CLAIM_preferred_username&quot;) String username) {\n     return username;\n}\n</code></pre>\n<p>It works but not the way it should. Can I use Quarkus to retrieve <code>OIDC_*</code> headers and access its content with the CDI ?</p>\n<p>Thanks,</p>\n"},{"tags":["java","instagram-api"],"owner":{"account_id":29406887,"reputation":1,"user_id":22531747,"display_name":"AHMET YILDIZBAKAN"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":22,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694340532,"creation_date":1694340532,"question_id":77075651,"body_markdown":"```\r\npackage com.yazilimevi.unfollow.CustomViews;\r\n\r\nimport android.app.Dialog;\r\nimport android.content.Context;\r\nimport android.graphics.Bitmap;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.webkit.WebSettings;\r\nimport android.webkit.WebView;\r\nimport android.webkit.WebViewClient;\r\n\r\nimport androidx.annotation.NonNull;\r\n\r\nimport com.yazilimevi.unfollow.InsClient;\r\nimport com.yazilimevi.unfollow.MainActivity;\r\nimport com.yazilimevi.unfollow.R;\r\nimport com.yazilimevi.unfollow.insterfaces.AuthenticationListener;\r\n\r\npublic class AuthenticationDialog extends Dialog {\r\n    private AuthenticationListener listener;\r\n    private Context context;\r\n    private WebView webView;\r\n\r\n    private final String url = InsClient.BASE_URL\r\n            +&quot;oauth/authorize/?client_id=&quot;\r\n            +InsClient.INSTAGRAM_CLIENT_ID\r\n            +&quot;&amp;redirect_uri=&quot;\r\n            +InsClient.REDIRECT_URI\r\n            +&quot;&amp;response_type=token&quot;\r\n            +&quot;&amp;display=touch&amp;scope=public_content&quot;;\r\n\r\n\r\n    public AuthenticationDialog(AuthenticationListener listener, @NonNull Context context) {\r\n        super(context);\r\n        this.context = context;\r\n        this.listener = listener;\r\n    }\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        this.setContentView(R.layout.auth_dialog);\r\n        initializeWebView();\r\n    }\r\n\r\n    private void initializeWebView() {\r\n        webView = (WebView) findViewById(R.id.webView);\r\n        webView.loadUrl(url);\r\n\r\n        webView.setWebViewClient(new WebViewClient(){\r\n\r\n            String access_token;\r\n            boolean authComplete;\r\n\r\n            @Override\r\n            public boolean shouldOverrideUrlLoading(WebView view, String url) {\r\n                view.loadUrl(url);\r\n                return false;\r\n            }\r\n\r\n            @Override\r\n            public void onPageStarted(WebView view, String url, Bitmap favicon) {\r\n                super.onPageStarted(view, url, favicon);\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onPageFinished(WebView view, String url) {\r\n                super.onPageFinished(view, url);\r\n              /*  WebSettings settings = webView.getSettings();\r\n                settings.setJavaScriptEnabled(true);\r\n                settings.setDomStorageEnabled(true);*/\r\n                if (url.contains(&quot;#access_token=&quot;) &amp;&amp; !authComplete){\r\n\r\n                    Uri uri = Uri.parse(url);\r\n                    access_token = uri.getEncodedFragment();\r\n                    access_token = access_token.substring(access_token.lastIndexOf(&quot;=&quot;)+1);\r\n                    authComplete = true;\r\n                    listener.onCodeReceived(access_token);\r\n                    dismiss();\r\n                }\r\n                else if (url.contains(&quot;?error&quot;)){\r\n                    System.out.println(&quot;&#231;ıktı&quot;);\r\n                    dismiss();\r\n                }\r\n\r\n            }\r\n        });\r\n\r\n    }\r\n}\r\n\r\n```\r\n\r\nurl.contains(&quot;#access_token=&quot;) It translates to false and Instagram webview does not work. I added Instagram API and client ids. I call the dialog in the main activity section, but only the Instagram logo appears in the dialog that opens. url.contains(&quot;#access_token=&quot;) It translates to false and Instagram webview does not work. I added Instagram API and client ids. I call the dialog in the main activity section, but only the Instagram logo appears in the dialog that opens. url.contains(&quot;#access_token=&quot;) It translates to false and Instagram webview does not work. I added Instagram API and client ids. I call the dialog in the main activity section, but only the Instagram logo appears in the dialog that opens.\r\n```\r\n`public static final String GET_USER_INFO_URL = &quot;https://api.instagram.com/v1/users/self/?access_token=&quot;;\r\npublic static String INSTAGRAM_CLIENT_ID =&quot;685551893072923&quot;;\r\npublic static String INSTAGRAM_CLIENT_ID_SECRET =&quot;7b599f18f96677b83053241599686f42&quot;;\r\npublic static String BASE_URL =&quot;https://api.instagram.com/&quot;;\r\npublic static String REDIRECT_URI = &quot;https%3A%2F%2Fwww.instagram.com/&quot;;\r\npublic final static String PREF_NAME = &quot;app_pref&quot;;`\r\n```\r\n I&#39;m waiting for your help I&#39;m waiting for your help I&#39;m waiting for your help I&#39;m waiting for your help","title":"Android studio java getting error fetching access token","body":"<pre><code>package com.yazilimevi.unfollow.CustomViews;\n\nimport android.app.Dialog;\nimport android.content.Context;\nimport android.graphics.Bitmap;\nimport android.net.Uri;\nimport android.os.Bundle;\nimport android.util.Log;\nimport android.webkit.WebSettings;\nimport android.webkit.WebView;\nimport android.webkit.WebViewClient;\n\nimport androidx.annotation.NonNull;\n\nimport com.yazilimevi.unfollow.InsClient;\nimport com.yazilimevi.unfollow.MainActivity;\nimport com.yazilimevi.unfollow.R;\nimport com.yazilimevi.unfollow.insterfaces.AuthenticationListener;\n\npublic class AuthenticationDialog extends Dialog {\n    private AuthenticationListener listener;\n    private Context context;\n    private WebView webView;\n\n    private final String url = InsClient.BASE_URL\n            +&quot;oauth/authorize/?client_id=&quot;\n            +InsClient.INSTAGRAM_CLIENT_ID\n            +&quot;&amp;redirect_uri=&quot;\n            +InsClient.REDIRECT_URI\n            +&quot;&amp;response_type=token&quot;\n            +&quot;&amp;display=touch&amp;scope=public_content&quot;;\n\n\n    public AuthenticationDialog(AuthenticationListener listener, @NonNull Context context) {\n        super(context);\n        this.context = context;\n        this.listener = listener;\n    }\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        this.setContentView(R.layout.auth_dialog);\n        initializeWebView();\n    }\n\n    private void initializeWebView() {\n        webView = (WebView) findViewById(R.id.webView);\n        webView.loadUrl(url);\n\n        webView.setWebViewClient(new WebViewClient(){\n\n            String access_token;\n            boolean authComplete;\n\n            @Override\n            public boolean shouldOverrideUrlLoading(WebView view, String url) {\n                view.loadUrl(url);\n                return false;\n            }\n\n            @Override\n            public void onPageStarted(WebView view, String url, Bitmap favicon) {\n                super.onPageStarted(view, url, favicon);\n\n            }\n\n            @Override\n            public void onPageFinished(WebView view, String url) {\n                super.onPageFinished(view, url);\n              /*  WebSettings settings = webView.getSettings();\n                settings.setJavaScriptEnabled(true);\n                settings.setDomStorageEnabled(true);*/\n                if (url.contains(&quot;#access_token=&quot;) &amp;&amp; !authComplete){\n\n                    Uri uri = Uri.parse(url);\n                    access_token = uri.getEncodedFragment();\n                    access_token = access_token.substring(access_token.lastIndexOf(&quot;=&quot;)+1);\n                    authComplete = true;\n                    listener.onCodeReceived(access_token);\n                    dismiss();\n                }\n                else if (url.contains(&quot;?error&quot;)){\n                    System.out.println(&quot;çıktı&quot;);\n                    dismiss();\n                }\n\n            }\n        });\n\n    }\n}\n\n</code></pre>\n<p>url.contains(&quot;#access_token=&quot;) It translates to false and Instagram webview does not work. I added Instagram API and client ids. I call the dialog in the main activity section, but only the Instagram logo appears in the dialog that opens. url.contains(&quot;#access_token=&quot;) It translates to false and Instagram webview does not work. I added Instagram API and client ids. I call the dialog in the main activity section, but only the Instagram logo appears in the dialog that opens. url.contains(&quot;#access_token=&quot;) It translates to false and Instagram webview does not work. I added Instagram API and client ids. I call the dialog in the main activity section, but only the Instagram logo appears in the dialog that opens.</p>\n<pre><code>`public static final String GET_USER_INFO_URL = &quot;https://api.instagram.com/v1/users/self/?access_token=&quot;;\npublic static String INSTAGRAM_CLIENT_ID =&quot;685551893072923&quot;;\npublic static String INSTAGRAM_CLIENT_ID_SECRET =&quot;7b599f18f96677b83053241599686f42&quot;;\npublic static String BASE_URL =&quot;https://api.instagram.com/&quot;;\npublic static String REDIRECT_URI = &quot;https%3A%2F%2Fwww.instagram.com/&quot;;\npublic final static String PREF_NAME = &quot;app_pref&quot;;`\n</code></pre>\n<p>I'm waiting for your help I'm waiting for your help I'm waiting for your help I'm waiting for your help</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":213468,"reputation":103500,"user_id":466862,"display_name":"Mark Rotteveel"},"score":2,"creation_date":1694340524,"post_id":77075589,"comment_id":135876017,"body_markdown":"Why is your expected result 6 -&gt; 9? You also use `addfirst` for 9, meaning it will be added *before* 6, because it was called after adding 6.","body":"Why is your expected result 6 -&gt; 9? You also use <code>addfirst</code> for 9, meaning it will be added <i>before</i> 6, because it was called after adding 6."},{"owner":{"account_id":31180,"reputation":29173,"user_id":85421,"display_name":"user85421"},"score":0,"creation_date":1694342996,"post_id":77075589,"comment_id":135876289,"body_markdown":"... you must `addLast(9)` if you want it added as *Last*","body":"... you must <code>addLast(9)</code> if you want it added as <i>Last</i>"},{"owner":{"account_id":6520,"reputation":10523,"user_id":11002,"accept_rate":75,"display_name":"tgdavies"},"score":0,"creation_date":1694343372,"post_id":77075589,"comment_id":135876340,"body_markdown":"Step through your code with the debugger.","body":"Step through your code with the debugger."}],"answers":[{"tags":[],"owner":{"account_id":27734686,"reputation":1,"user_id":21172516,"display_name":"jun AS"},"comment_count":0,"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1694340204,"creation_date":1694340204,"answer_id":77075640,"question_id":77075589,"body_markdown":"the answer is true,you define code addfirst,is mean per newnode will add  to the head position. you add 6, head -&gt;6 ,again add 9，9.next = head，head - &gt;9,when you print ,is just 9 -&gt; 6, if you want 6 —&gt;9 ,you should to use addlast","title":"Why my element is not getting add at start index when i call addfirst method in linkedlist","body":"<p>the answer is true,you define code addfirst,is mean per newnode will add  to the head position. you add 6, head -&gt;6 ,again add 9，9.next = head，head - &gt;9,when you print ,is just 9 -&gt; 6, if you want 6 —&gt;9 ,you should to use addlast</p>\n"}],"owner":{"account_id":29406800,"reputation":1,"user_id":22531673,"display_name":"Dishank Gawas"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":36,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1694340481,"creation_date":1694339416,"question_id":77075589,"body_markdown":"This is my linked list code:\r\n\r\n```java\r\npackage com.dishank.primitive;\r\n\r\npublic class LL {\r\n\tNode head;\r\n\t\r\n\tclass Node{\r\n\t\tint data;\r\n\t\tNode next;\r\n\t\t\r\n\t\tNode(int data){\r\n\t\t\tthis.data=data;\r\n\t\t\tthis.next=null;\r\n\t\t}\r\n\t}\r\n\r\n\t// add first\r\n\tpublic void addfirst(int data) {\r\n\t\tNode newnode = new Node(data);\r\n\t\tif(head==null) {\r\n\t\t\thead=newnode;\r\n\t\t\treturn;\t\r\n\t\t}\r\n\t\tnewnode.next=head;\r\n\t\thead=newnode;\r\n\t}\r\n\r\n\t//add last\r\n\tpublic void addlast(int data) {\r\n\t\tNode newnode=new Node(data);\r\n\t\tif(head==null) {\r\n\t\t\thead=newnode;\r\n\t\t\treturn;\t\r\n\t\t}\r\n\t\tNode currNode = head;\r\n\t\twhile(currNode.next!=null) {\r\n\t\t\tcurrNode=currNode.next;\r\n\t\t}\r\n\t\tcurrNode.next=newnode;\r\n\t}\r\n\r\n\tpublic void printt() {\r\n\t\tNode currNode = head;\r\n\t\twhile(currNode!=null) {\r\n\t\t\tSystem.out.print(currNode.data+&quot; -&gt; &quot;);\r\n\t\t\tcurrNode=currNode.next;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\tLL list = new LL();\r\n\t\tlist.addfirst(6);\r\n\t\tlist.addfirst(9);\r\n\t\tlist.printt();\r\n\t}\r\n\r\n}\r\n```\r\n\r\nExpected op is 6 -&gt; 9, but I&#39;m getting 9 -&gt; 6 -&gt;. I tried updating my code, but nothing works. What is the problem?","title":"Why my element is not getting add at start index when i call addfirst method in linkedlist","body":"<p>This is my linked list code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.dishank.primitive;\n\npublic class LL {\n    Node head;\n    \n    class Node{\n        int data;\n        Node next;\n        \n        Node(int data){\n            this.data=data;\n            this.next=null;\n        }\n    }\n\n    // add first\n    public void addfirst(int data) {\n        Node newnode = new Node(data);\n        if(head==null) {\n            head=newnode;\n            return; \n        }\n        newnode.next=head;\n        head=newnode;\n    }\n\n    //add last\n    public void addlast(int data) {\n        Node newnode=new Node(data);\n        if(head==null) {\n            head=newnode;\n            return; \n        }\n        Node currNode = head;\n        while(currNode.next!=null) {\n            currNode=currNode.next;\n        }\n        currNode.next=newnode;\n    }\n\n    public void printt() {\n        Node currNode = head;\n        while(currNode!=null) {\n            System.out.print(currNode.data+&quot; -&gt; &quot;);\n            currNode=currNode.next;\n        }\n    }\n\n    public static void main(String[] args) {\n        LL list = new LL();\n        list.addfirst(6);\n        list.addfirst(9);\n        list.printt();\n    }\n\n}\n</code></pre>\n<p>Expected op is 6 -&gt; 9, but I'm getting 9 -&gt; 6 -&gt;. I tried updating my code, but nothing works. What is the problem?</p>\n"},{"tags":["java","spring-boot","thymeleaf"],"comments":[{"owner":{"account_id":3475140,"reputation":2491,"user_id":3019956,"accept_rate":33,"display_name":"want2learn"},"score":0,"creation_date":1555599607,"post_id":55748199,"comment_id":98174322,"body_markdown":"what is there on line 64 on your html ?","body":"what is there on line 64 on your html ?"},{"owner":{"account_id":6682518,"reputation":13,"user_id":11378283,"display_name":"Alexander Romanov"},"score":0,"creation_date":1555600128,"post_id":55748199,"comment_id":98174615,"body_markdown":"I&#39;m sorry.This one &lt;input type=&quot;text&quot; name=&quot;name&quot;  th:field=&quot;*{name}&quot;/&gt;","body":"I&#39;m sorry.This one &lt;input type=&quot;text&quot; name=&quot;name&quot;  th:field=&quot;*{name}&quot;/&gt;"},{"owner":{"account_id":6682518,"reputation":13,"user_id":11378283,"display_name":"Alexander Romanov"},"score":0,"creation_date":1555600225,"post_id":55748199,"comment_id":98174675,"body_markdown":"Col 32 starts here th","body":"Col 32 starts here th"},{"owner":{"account_id":3475140,"reputation":2491,"user_id":3019956,"accept_rate":33,"display_name":"want2learn"},"score":0,"creation_date":1555600358,"post_id":55748199,"comment_id":98174754,"body_markdown":"change `&lt;form method=&quot;POST&quot; th:object=&quot;${taco}&quot;&gt;` to `&lt;form method=&quot;POST&quot; th:object=&quot;${design}&quot;&gt;`","body":"change <code>&lt;form method=&quot;POST&quot; th:object=&quot;${taco}&quot;&gt;</code> to <code>&lt;form method=&quot;POST&quot; th:object=&quot;${design}&quot;&gt;</code>"},{"owner":{"account_id":6682518,"reputation":13,"user_id":11378283,"display_name":"Alexander Romanov"},"score":0,"creation_date":1555600625,"post_id":55748199,"comment_id":98174897,"body_markdown":"It works, but incorrect input ok but another page part doesn&#39;t work( Why i should change taco to design?","body":"It works, but incorrect input ok but another page part doesn&#39;t work( Why i should change taco to design?"},{"owner":{"account_id":3475140,"reputation":2491,"user_id":3019956,"accept_rate":33,"display_name":"want2learn"},"score":0,"creation_date":1555600679,"post_id":55748199,"comment_id":98174930,"body_markdown":"you are missing `th:action` on your form as well.","body":"you are missing <code>th:action</code> on your form as well."}],"answers":[{"comments":[{"owner":{"account_id":3475140,"reputation":2491,"user_id":3019956,"accept_rate":33,"display_name":"want2learn"},"score":0,"creation_date":1555609371,"post_id":55749117,"comment_id":98179078,"body_markdown":"What you mean another part of page ?","body":"What you mean another part of page ?"},{"owner":{"account_id":6682518,"reputation":13,"user_id":11378283,"display_name":"Alexander Romanov"},"score":0,"creation_date":1555611812,"post_id":55749117,"comment_id":98180121,"body_markdown":"How you can see i getting data from database and showing them at view with help this construction &lt;div th:each=&quot;ingredient: ${protein}&quot;&gt;\n                &lt;input name=&quot;ingredients&quot; type=&quot;checkbox&quot; th:value=&quot;${ingredient.id}&quot;/&gt;\n                &lt;span th:text=&quot;${ingredient.name}&quot;&gt;INGREDIENT&lt;/span&gt;\n            &lt;/div&gt;","body":"How you can see i getting data from database and showing them at view with help this construction &lt;div th:each=&quot;ingredient: ${protein}&quot;&gt;                 &lt;input name=&quot;ingredients&quot; type=&quot;checkbox&quot; th:value=&quot;${ingredient.id}&quot;/&gt;                 &lt;span th:text=&quot;${ingredient.name}&quot;&gt;INGREDIENT&lt;/span&gt;             &lt;/div&gt;"},{"owner":{"account_id":6682518,"reputation":13,"user_id":11378283,"display_name":"Alexander Romanov"},"score":0,"creation_date":1555611874,"post_id":55749117,"comment_id":98180154,"body_markdown":"and this doesn&#39;t work if i replace th:object to th:object=&quot;${design}&quot;","body":"and this doesn&#39;t work if i replace th:object to th:object=&quot;${design}&quot;"},{"owner":{"account_id":3475140,"reputation":2491,"user_id":3019956,"accept_rate":33,"display_name":"want2learn"},"score":0,"creation_date":1555614853,"post_id":55749117,"comment_id":98181368,"body_markdown":"I can&#39;t understand what you are saying. Take a look at thymeleaf docs. https://www.thymeleaf.org/doc/tutorials/2.1/thymeleafspring.html","body":"I can&#39;t understand what you are saying. Take a look at thymeleaf docs. <a href=\"https://www.thymeleaf.org/doc/tutorials/2.1/thymeleafspring.html\" rel=\"nofollow noreferrer\">thymeleaf.org/doc/tutorials/2.1/thymeleafspring.html</a>"}],"tags":[],"owner":{"account_id":3475140,"reputation":2491,"user_id":3019956,"accept_rate":33,"display_name":"want2learn"},"comment_count":4,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1555600792,"creation_date":1555600792,"answer_id":55749117,"question_id":55748199,"body_markdown":"I noticed two things on your code.\r\n\r\n1. I don&#39;t see `th:action` on your form that is required for form submission.\r\n2. change `form method=&quot;POST&quot; th:object=&quot;${taco}&quot;` to `form method=&quot;POST&quot; th:object=&quot;${design}&quot;`\r\n\r\nTry fixing these two and it should work.","title":"How to set object field from Thymeleaf template?","body":"<p>I noticed two things on your code.</p>\n\n<ol>\n<li>I don't see <code>th:action</code> on your form that is required for form submission.</li>\n<li>change <code>form method=\"POST\" th:object=\"${taco}\"</code> to <code>form method=\"POST\" th:object=\"${design}\"</code></li>\n</ol>\n\n<p>Try fixing these two and it should work.</p>\n"},{"comments":[{"owner":{"account_id":6682518,"reputation":13,"user_id":11378283,"display_name":"Alexander Romanov"},"score":0,"creation_date":1555622062,"post_id":55751684,"comment_id":98183995,"body_markdown":"Thank&#39;s for your help.I solved problem.You was right.","body":"Thank&#39;s for your help.I solved problem.You was right."}],"tags":[],"owner":{"account_id":2869500,"reputation":54,"user_id":2463147,"display_name":"Polash"},"comment_count":1,"down_vote_count":1,"up_vote_count":1,"is_accepted":true,"score":0,"last_activity_date":1694340291,"creation_date":1555611244,"answer_id":55751684,"question_id":55748199,"body_markdown":"I found two thing in code:\r\n\r\n1. I  do not find any  action your  form in html. You should use `th:action` tag to add an action.\r\n2. in html you used `th:object=&quot;${taco}&quot;` for declare an object for your html form. But you do not add “taco” object in your model in controller method from where you return the html design. You should add the “taco” object in your controller method like below.\r\n\r\n   \r\n\r\n     model.addAttribute(“taco”, taco Object);","title":"How to set object field from Thymeleaf template?","body":"<p>I found two thing in code:</p>\n<ol>\n<li><p>I  do not find any  action your  form in html. You should use <code>th:action</code> tag to add an action.</p>\n</li>\n<li><p>in html you used <code>th:object=&quot;${taco}&quot;</code> for declare an object for your html form. But you do not add “taco” object in your model in controller method from where you return the html design. You should add the “taco” object in your controller method like below.</p>\n<p>model.addAttribute(“taco”, taco Object);</p>\n</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":11739059,"reputation":368,"user_id":8591962,"display_name":"Mohit Bansal"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1569544508,"creation_date":1569543199,"answer_id":58126199,"question_id":55748199,"body_markdown":"I encountered same issue.\r\n\r\nResolution for me was to add getters in Taco.java for name. Somehow lombok is not generating getters automatically at run time.\r\n\r\nAnd `th:object=&quot;${taco}&quot;` should be `th:object=&quot;${design}&quot;`\r\n\r\nNo need to make changes for `th:action`. From tutorial\r\n&gt;If you take another look at the &lt;form&gt; tag in your view, you can see that its method attribute is set to POST. Moreover, the &lt;form&gt; doesn’t declare an action attribute. This means that when the form is submitted, the browser will gather up all the data in the form and send it to the server in an HTTP POST request to the same path for which a GET request displayed the form—the /design path.\r\n\r\n","title":"How to set object field from Thymeleaf template?","body":"<p>I encountered same issue.</p>\n\n<p>Resolution for me was to add getters in Taco.java for name. Somehow lombok is not generating getters automatically at run time.</p>\n\n<p>And <code>th:object=\"${taco}\"</code> should be <code>th:object=\"${design}\"</code></p>\n\n<p>No need to make changes for <code>th:action</code>. From tutorial</p>\n\n<blockquote>\n  <p>If you take another look at the  tag in your view, you can see that its method attribute is set to POST. Moreover, the  doesn’t declare an action attribute. This means that when the form is submitted, the browser will gather up all the data in the form and send it to the server in an HTTP POST request to the same path for which a GET request displayed the form—the /design path.</p>\n</blockquote>\n"}],"owner":{"account_id":6682518,"reputation":13,"user_id":11378283,"display_name":"Alexander Romanov"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":7923,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":55751684,"answer_count":3,"score":1,"last_activity_date":1694340291,"creation_date":1555597738,"question_id":55748199,"body_markdown":"i&#39;m new in Spring and i trying to learn it with help Spring in action 5 (Craig Walls).I&#39;m creating small  Spring Boot MVC-application.Now i have a little problem with Thymeleaf.\r\n\r\nI have Controller,View and model as POJO object.When i&#39;m trying to get data from form Intellij Idea told me that something wrong with my Thymeleaf view in this line:&lt;input type=&quot;text&quot; name=&quot;name&quot;  th:field=&quot;*{name}&quot;/&gt;\r\n\r\n    Model\r\n    import java.util.Date;\r\n    import java.util.List;\r\n    \r\n    import javax.validation.constraints.NotNull;\r\n    import javax.validation.constraints.Size;\r\n    \r\n    import lombok.Data;\r\n    \r\n    \r\n    @Data\r\n    public class Taco {\r\n    \r\n        private Long id;\r\n    \r\n        private Date createdAt;\r\n    \r\n        @NotNull\r\n        @Size(min=5, message=&quot;Name must be at least 5 characters long&quot;)\r\n        private String name;\r\n    \r\n        @Size(min=1, message=&quot;You must choose at least 1 ingredient&quot;)\r\n        private List&lt;Ingredient&gt; ingredients;\r\n    \r\n    \r\n    }\r\n\r\nView\r\n\r\n    &lt;!DOCTYPE html&gt;\r\n    &lt;html lang=&quot;en&quot;\r\n          xmlns=&quot;http://www.w3.org/1999/xhtml&quot;\r\n          xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;\r\n    &lt;head&gt;\r\n        &lt;meta charset=&quot;UTF-8&quot;&gt;\r\n        &lt;title&gt;Taco Cloud&lt;/title&gt;\r\n        &lt;link rel=&quot;stylesheet&quot; th:href=&quot;@{/styles.css}&quot;/&gt;\r\n    \r\n    &lt;/head&gt;\r\n    &lt;body&gt;\r\n    \r\n        &lt;h1&gt;Design your taco!&lt;/h1&gt;\r\n        &lt;img src=&quot;../static/images/TacoCloud.png&quot; alt=&quot;TacoCloud.png&quot; th:src=&quot;@{/images/TacoCloud.png}&quot;&gt;\r\n    \r\n        &lt;form method=&quot;POST&quot; th:object=&quot;${taco}&quot;&gt;\r\n            &lt;div class=&quot;grid&quot;&gt;\r\n                &lt;div class=&quot;ingredient-group&quot; id=&quot;wraps&quot;&gt;\r\n                    &lt;h3&gt;Designate yor wrap:&lt;/h3&gt;\r\n                    &lt;div th:each=&quot;ingredient:${wrap}&quot;&gt;\r\n                        &lt;input name=&quot;ingredients&quot; type=&quot;checkbox&quot; th:value=&quot;${ingredient.id}&quot;/&gt;\r\n    \r\n                        &lt;span th:text=&quot;${ingredient.name}&quot;&gt;INGREDIENT&lt;/span&gt;&lt;br/&gt;\r\n                    &lt;/div&gt;\r\n                &lt;/div&gt;\r\n    \r\n    \r\n                &lt;div class=&quot;ingredient-group&quot; id=&quot;proteins&quot;&gt;\r\n                &lt;h3&gt;Pick your protein:&lt;/h3&gt;\r\n                &lt;div th:each=&quot;ingredient: ${protein}&quot;&gt;\r\n                    &lt;input name=&quot;ingredients&quot; type=&quot;checkbox&quot; th:value=&quot;${ingredient.id}&quot;/&gt;\r\n                    &lt;span th:text=&quot;${ingredient.name}&quot;&gt;INGREDIENT&lt;/span&gt;\r\n                &lt;/div&gt;\r\n            &lt;/div&gt;\r\n    \r\n    \r\n                &lt;div class=&quot;ingredient-group&quot; id=&quot;cheeses&quot;&gt;\r\n                    &lt;h3&gt;Choose your cheese:&lt;/h3&gt;\r\n                    &lt;div th:each=&quot;ingredient:${cheese}&quot;&gt;\r\n                        &lt;input name=&quot;ingredients&quot; type=&quot;checkbox&quot; th:value=&quot;${ingredient.id}&quot;/&gt;\r\n                        &lt;span th:text=&quot;${ingredient.name}&quot;&gt;INGREDIENT&lt;/span&gt;&lt;br/&gt;\r\n                    &lt;/div&gt;\r\n                &lt;/div&gt;\r\n    \r\n                &lt;div class=&quot;ingredient-group&quot; id=&quot;veggies&quot;&gt;\r\n                    &lt;h3&gt;Determine your veggies:&lt;/h3&gt;\r\n                    &lt;div th:each=&quot;ingredient : ${veggies}&quot;&gt;\r\n                        &lt;input name=&quot;ingredients&quot; type=&quot;checkbox&quot; th:value=&quot;${ingredient.id}&quot;\r\n                        /&gt;\r\n                        &lt;span th:text=&quot;${ingredient.name}&quot;&gt;INGREDIENT&lt;/span&gt;&lt;br/&gt;\r\n                    &lt;/div&gt;\r\n                &lt;/div&gt;\r\n                &lt;div class=&quot;ingredient-group&quot; id=&quot;sauces&quot;&gt;\r\n                    &lt;h3&gt;Select your sauce:&lt;/h3&gt;\r\n                    &lt;div th:each=&quot;ingredient : ${sauce}&quot;&gt;\r\n                        &lt;input name=&quot;ingredients&quot; type=&quot;checkbox&quot; th:value=&quot;${ingredient.id}&quot;\r\n                        /&gt;\r\n                        &lt;span th:text=&quot;${ingredient.name}&quot;&gt;INGREDIENT&lt;/span&gt;&lt;br/&gt;\r\n                    &lt;/div&gt;\r\n                &lt;/div&gt;\r\n            &lt;/div&gt;\r\n            &lt;div&gt;\r\n                &lt;h3&gt;Name your taco creation:&lt;/h3&gt;\r\n                &lt;input type=&quot;text&quot; name=&quot;name&quot;  th:field=&quot;*{name}&quot;/&gt; \r\n         \r\n                &lt;br/&gt;\r\n                &lt;button&gt;Submit your taco&lt;/button&gt;\r\n            &lt;/div&gt;\r\n    \r\n        &lt;/form&gt;\r\n    \r\n    &lt;/body&gt;\r\n    &lt;/html&gt;\r\n\r\nController\r\n\r\n    import lombok.extern.slf4j.Slf4j;\r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.stereotype.Controller;\r\n    import org.springframework.ui.Model;\r\n    import org.springframework.validation.Errors;\r\n    import org.springframework.web.bind.annotation.GetMapping;\r\n    import org.springframework.web.bind.annotation.PostMapping;\r\n    import org.springframework.web.bind.annotation.RequestMapping;\r\n    import tacos.Ingredient.Type;\r\n    import tacos.Ingredient;\r\n    import org.springframework.web.bind.annotation.ModelAttribute;\r\n    import tacos.Taco;\r\n    import tacos.data.IngredientRepository;\r\n    \r\n    import javax.validation.Valid;\r\n    \r\n    \r\n    import java.util.ArrayList;\r\n    import java.util.Arrays;\r\n    import java.util.List;\r\n    import java.util.stream.Collectors;\r\n    \r\n    \r\n    @Slf4j\r\n    @Controller\r\n    @RequestMapping(&quot;/design&quot;)\r\n    public class DesignTacoController {\r\n    \r\n        private final IngredientRepository ingredientRepo;\r\n    \r\n        @Autowired\r\n        public DesignTacoController(IngredientRepository ingredientRepo){\r\n            this.ingredientRepo=ingredientRepo;\r\n        }\r\n    \r\n    \r\n        @GetMapping\r\n        public String showDesignForm(Model model) {\r\n    \r\n            List&lt;Ingredient&gt; ingredients=new ArrayList&lt;&gt;();\r\n            ingredientRepo.findAll().forEach(i-&gt;ingredients.add(i));\r\n    \r\n            Type[] types = Ingredient.Type.values();\r\n            for (Type type : types) {\r\n                model.addAttribute(type.toString().toLowerCase(),\r\n                        filterByType(ingredients, type));\r\n            }\r\n    \r\n            return &quot;design&quot;;\r\n        }\r\n    \r\n    \r\n        private List&lt;Ingredient&gt; filterByType(\r\n                List&lt;Ingredient&gt; ingredients, Type type) {\r\n            return ingredients\r\n                    .stream()\r\n                    .filter(x -&gt; x.getType().equals(type))\r\n                    .collect(Collectors.toList());\r\n        }\r\n    \r\n        @PostMapping\r\n        public String processDesign(@Valid @ModelAttribute(&quot;design&quot;) Taco design, Errors errors, Model model) {\r\n            if (errors.hasErrors()) {\r\n                return &quot;design&quot;;\r\n            }\r\n    \r\n            // Save the taco design...\r\n            // We&#39;ll do this in chapter 3\r\n            log.info(&quot;Processing design: &quot; + design);\r\n    \r\n            return &quot;redirect:/orders/current&quot;;\r\n        }\r\n    \r\n    }\r\n\r\nAnd finally i get this error:\r\n\r\n    org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: &quot;class path resource [templates/design.html]&quot;)\r\n    \r\n    Caused by: org.attoparser.ParseException: Error during execution of processor &#39;org.thymeleaf.spring5.processor.SpringInputGeneralFieldTagProcessor&#39; (template: &quot;design&quot; - line 64, col 45)\r\n\r\n","title":"How to set object field from Thymeleaf template?","body":"<p>i'm new in Spring and i trying to learn it with help Spring in action 5 (Craig Walls).I'm creating small  Spring Boot MVC-application.Now i have a little problem with Thymeleaf.</p>\n\n<p>I have Controller,View and model as POJO object.When i'm trying to get data from form Intellij Idea told me that something wrong with my Thymeleaf view in this line:</p>\n\n<pre><code>Model\nimport java.util.Date;\nimport java.util.List;\n\nimport javax.validation.constraints.NotNull;\nimport javax.validation.constraints.Size;\n\nimport lombok.Data;\n\n\n@Data\npublic class Taco {\n\n    private Long id;\n\n    private Date createdAt;\n\n    @NotNull\n    @Size(min=5, message=\"Name must be at least 5 characters long\")\n    private String name;\n\n    @Size(min=1, message=\"You must choose at least 1 ingredient\")\n    private List&lt;Ingredient&gt; ingredients;\n\n\n}\n</code></pre>\n\n<p>View</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"\n      xmlns=\"http://www.w3.org/1999/xhtml\"\n      xmlns:th=\"http://www.thymeleaf.org\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Taco Cloud&lt;/title&gt;\n    &lt;link rel=\"stylesheet\" th:href=\"@{/styles.css}\"/&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n\n    &lt;h1&gt;Design your taco!&lt;/h1&gt;\n    &lt;img src=\"../static/images/TacoCloud.png\" alt=\"TacoCloud.png\" th:src=\"@{/images/TacoCloud.png}\"&gt;\n\n    &lt;form method=\"POST\" th:object=\"${taco}\"&gt;\n        &lt;div class=\"grid\"&gt;\n            &lt;div class=\"ingredient-group\" id=\"wraps\"&gt;\n                &lt;h3&gt;Designate yor wrap:&lt;/h3&gt;\n                &lt;div th:each=\"ingredient:${wrap}\"&gt;\n                    &lt;input name=\"ingredients\" type=\"checkbox\" th:value=\"${ingredient.id}\"/&gt;\n\n                    &lt;span th:text=\"${ingredient.name}\"&gt;INGREDIENT&lt;/span&gt;&lt;br/&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n\n\n            &lt;div class=\"ingredient-group\" id=\"proteins\"&gt;\n            &lt;h3&gt;Pick your protein:&lt;/h3&gt;\n            &lt;div th:each=\"ingredient: ${protein}\"&gt;\n                &lt;input name=\"ingredients\" type=\"checkbox\" th:value=\"${ingredient.id}\"/&gt;\n                &lt;span th:text=\"${ingredient.name}\"&gt;INGREDIENT&lt;/span&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n\n            &lt;div class=\"ingredient-group\" id=\"cheeses\"&gt;\n                &lt;h3&gt;Choose your cheese:&lt;/h3&gt;\n                &lt;div th:each=\"ingredient:${cheese}\"&gt;\n                    &lt;input name=\"ingredients\" type=\"checkbox\" th:value=\"${ingredient.id}\"/&gt;\n                    &lt;span th:text=\"${ingredient.name}\"&gt;INGREDIENT&lt;/span&gt;&lt;br/&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"ingredient-group\" id=\"veggies\"&gt;\n                &lt;h3&gt;Determine your veggies:&lt;/h3&gt;\n                &lt;div th:each=\"ingredient : ${veggies}\"&gt;\n                    &lt;input name=\"ingredients\" type=\"checkbox\" th:value=\"${ingredient.id}\"\n                    /&gt;\n                    &lt;span th:text=\"${ingredient.name}\"&gt;INGREDIENT&lt;/span&gt;&lt;br/&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n            &lt;div class=\"ingredient-group\" id=\"sauces\"&gt;\n                &lt;h3&gt;Select your sauce:&lt;/h3&gt;\n                &lt;div th:each=\"ingredient : ${sauce}\"&gt;\n                    &lt;input name=\"ingredients\" type=\"checkbox\" th:value=\"${ingredient.id}\"\n                    /&gt;\n                    &lt;span th:text=\"${ingredient.name}\"&gt;INGREDIENT&lt;/span&gt;&lt;br/&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;h3&gt;Name your taco creation:&lt;/h3&gt;\n            &lt;input type=\"text\" name=\"name\"  th:field=\"*{name}\"/&gt; \n\n            &lt;br/&gt;\n            &lt;button&gt;Submit your taco&lt;/button&gt;\n        &lt;/div&gt;\n\n    &lt;/form&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>import lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.validation.Errors;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport tacos.Ingredient.Type;\nimport tacos.Ingredient;\nimport org.springframework.web.bind.annotation.ModelAttribute;\nimport tacos.Taco;\nimport tacos.data.IngredientRepository;\n\nimport javax.validation.Valid;\n\n\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.List;\nimport java.util.stream.Collectors;\n\n\n@Slf4j\n@Controller\n@RequestMapping(\"/design\")\npublic class DesignTacoController {\n\n    private final IngredientRepository ingredientRepo;\n\n    @Autowired\n    public DesignTacoController(IngredientRepository ingredientRepo){\n        this.ingredientRepo=ingredientRepo;\n    }\n\n\n    @GetMapping\n    public String showDesignForm(Model model) {\n\n        List&lt;Ingredient&gt; ingredients=new ArrayList&lt;&gt;();\n        ingredientRepo.findAll().forEach(i-&gt;ingredients.add(i));\n\n        Type[] types = Ingredient.Type.values();\n        for (Type type : types) {\n            model.addAttribute(type.toString().toLowerCase(),\n                    filterByType(ingredients, type));\n        }\n\n        return \"design\";\n    }\n\n\n    private List&lt;Ingredient&gt; filterByType(\n            List&lt;Ingredient&gt; ingredients, Type type) {\n        return ingredients\n                .stream()\n                .filter(x -&gt; x.getType().equals(type))\n                .collect(Collectors.toList());\n    }\n\n    @PostMapping\n    public String processDesign(@Valid @ModelAttribute(\"design\") Taco design, Errors errors, Model model) {\n        if (errors.hasErrors()) {\n            return \"design\";\n        }\n\n        // Save the taco design...\n        // We'll do this in chapter 3\n        log.info(\"Processing design: \" + design);\n\n        return \"redirect:/orders/current\";\n    }\n\n}\n</code></pre>\n\n<p>And finally i get this error:</p>\n\n<pre><code>org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: \"class path resource [templates/design.html]\")\n\nCaused by: org.attoparser.ParseException: Error during execution of processor 'org.thymeleaf.spring5.processor.SpringInputGeneralFieldTagProcessor' (template: \"design\" - line 64, col 45)\n</code></pre>\n"},{"tags":["java","sqlite","jdbc"],"comments":[{"owner":{"account_id":213468,"reputation":103500,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1694339396,"post_id":77075521,"comment_id":135875909,"body_markdown":"Obviously, the database you updated through NetBeans is not the same database as the JAR. Please provide a [mre] that includes the relevant build files.","body":"Obviously, the database you updated through NetBeans is not the same database as the JAR. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that includes the relevant build files."},{"owner":{"account_id":31180,"reputation":29173,"user_id":85421,"display_name":"user85421"},"score":1,"creation_date":1694343831,"post_id":77075521,"comment_id":135876379,"body_markdown":"A JAR file is like a ZIP file, it is an archive of other files, but it is not trivial to (directly) change the contents of the files inside the JAR/ZIP (also not the intention of it)","body":"A JAR file is like a ZIP file, it is an archive of other files, but it is not trivial to (directly) change the contents of the files inside the JAR/ZIP (also not the intention of it)"},{"owner":{"account_id":25866616,"reputation":1,"user_id":19598180,"display_name":"Rohan Nag"},"score":0,"creation_date":1694348322,"post_id":77075521,"comment_id":135876803,"body_markdown":"I simply want to build a terminal based application. If I just run the java file, it can&#39;t find the SQLite drivers, and I have to provide a class path every time. Is there  a better way to build a terminal based application using Java, other than converting into a Jar, such that the data persistence issue is resolved. Please help me!","body":"I simply want to build a terminal based application. If I just run the java file, it can&#39;t find the SQLite drivers, and I have to provide a class path every time. Is there  a better way to build a terminal based application using Java, other than converting into a Jar, such that the data persistence issue is resolved. Please help me!"},{"owner":{"account_id":5998820,"reputation":12676,"user_id":4712734,"display_name":"DuncG"},"score":0,"creation_date":1694369169,"post_id":77075521,"comment_id":135878918,"body_markdown":"Your situation isn&#39;t using jpackage but you have a resource path db which means it is readonly. See [How to control SQLite 3 database files directory after installing my app (Packaged using JPackage)](https://stackoverflow.com/questions/70163374/how-to-control-sqlite-3-database-files-directory-after-installing-my-app-packag)","body":"Your situation isn&#39;t using jpackage but you have a resource path db which means it is readonly. See <a href=\"https://stackoverflow.com/questions/70163374/how-to-control-sqlite-3-database-files-directory-after-installing-my-app-packag\">How to control SQLite 3 database files directory after installing my app (Packaged using JPackage)</a>"}],"owner":{"account_id":25866616,"reputation":1,"user_id":19598180,"display_name":"Rohan Nag"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":47,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694339347,"creation_date":1694338332,"question_id":77075521,"body_markdown":"I&#39;m encountering an issue with my Java application developed in NetBeans. The application uses an SQLite database, and I&#39;ve noticed that changes made to the database persist when I run the program from within NetBeans. However, when I build the JAR file and run it separately, the database changes are not reflected.\r\n\r\nHere are some key details:\r\n\r\nThe database file (customerDB.db) is stored in the &quot;databases&quot; folder, and the folder is added as a resource in my NetBeans project.\r\nI&#39;m confident that I&#39;m modifying the correct database file in the &quot;databases&quot; folder.\r\n\r\nNetBeans seems to copy the database file to a temporary location during the build process, which is used when running the JAR file.\r\nI would appreciate any insights into why the JAR file&#39;s database isn&#39;t updating as expected and how I can ensure that changes persist when running the JAR file.\r\n\r\nHere&#39;s the program for connecting to the SQLite Database, and updating it:\r\n\r\n```\r\n\r\npublic class SQLiteDatabase {\r\n\r\n    private Connection con;\r\n    private final String tableName;\r\n\r\n    public SQLiteDatabase() throws SQLException, ClassNotFoundException, IOException {\r\n        tableName = &quot;&quot;;\r\n        Class.forName(&quot;org.sqlite.JDBC&quot;);\r\n        Path dbFile = Files.createTempFile(null, &quot;.db&quot;);\r\n\r\n        con = DriverManager.getConnection(&quot;jdbc:sqlite::resource:customerDB.db&quot;);\r\n\r\n    }\r\n\r\n    public SQLiteDatabase(String tableName, String tableFields) throws SQLException, ClassNotFoundException, IOException {\r\n        this.tableName = tableName;\r\n        Class.forName(&quot;org.sqlite.JDBC&quot;);\r\n        String query = String.format(&quot;CREATE TABLE IF NOT EXISTS %s %s&quot;, tableName, tableFields);\r\n        \r\n        con = DriverManager.getConnection(&quot;jdbc:sqlite::resource:customerDB.db&quot;);\r\n        \r\n        Statement st = con.createStatement();\r\n        st.executeUpdate(query);\r\n    }\r\n\r\n    public void showTables() throws SQLException {\r\n        try (ResultSet rs = con.getMetaData().getTables(null, null, null, null)) {\r\n            while (rs.next()) {\r\n                System.out.println(rs.getString(&quot;TABLE_NAME&quot;));\r\n            }\r\n        }\r\n    }\r\n\r\n    public void insertData(int id, String name, String username, String password) throws SQLException {\r\n        String query = String.format(&quot;INSERT INTO %s VALUES(?,?,?,?)&quot;, tableName);\r\n        PreparedStatement p = con.prepareStatement(query);\r\n        p.setInt(1, id);\r\n        p.setString(2, name);\r\n        p.setString(3, username);\r\n        p.setString(4, password);\r\n\r\n        int count = p.executeUpdate();\r\n\r\n        System.out.println(String.format(&quot;%d row(s) added sucessfully&quot;, count));\r\n\r\n        p.close();\r\n    }\r\n\r\n    public void readData() throws SQLException {\r\n        String query = String.format(&quot;SELECT * FROM %s&quot;, tableName);\r\n        Formatter formatter = new Formatter();\r\n\r\n        try (Statement st = con.createStatement(); \r\n             ResultSet rs = st.executeQuery(query)) {\r\n\r\n            formatter.format(&quot;%-5s %-25s %-25s %-25s\\n&quot;, &quot;id&quot;, &quot;name&quot;, &quot;username&quot;, &quot;password&quot;);\r\n\r\n        while(rs.next())\r\n        {\r\n            int id = rs.getInt(1);\r\n            String name = rs.getString(2);\r\n            String username = rs.getString(3);\r\n            String password = rs.getString(4);\r\n            \r\n            formatter.format(&quot;%-5s %-25s %-25s %-25s\\n&quot;, id,name,username, password);\r\n\r\n        }\r\n            System.out.println(formatter);\r\n\r\n        }\r\n    }\r\n    \r\n    public void deleteData(int id) throws SQLException {\r\n        String query = String.format(&quot;DELETE FROM %s WHERE id=?&quot;, tableName);\r\n        try (PreparedStatement p = con.prepareStatement(query)) {\r\n            p.setInt(1, id);\r\n            \r\n            int count = p.executeUpdate();\r\n            \r\n            System.out.println(String.format(&quot;%d row(s) deleted sucessfully&quot;, count));\r\n        }\r\n    }\r\n\r\n    public Boolean close() throws SQLException {\r\n        con.close();\r\n    }\r\n}\r\n```\r\n\r\nAnd here&#39;s the driver code:\r\n\r\n```\r\nimport sqlite.SQLiteDatabase;\r\n\r\npublic class BankManagementSystem {\r\n    public static void main(String[] args) {\r\n        \r\n        try(Scanner sc = new Scanner(System.in))\r\n        {  \r\n            SQLiteDatabase sql = new SQLiteDatabase(&quot;login_details&quot;, &quot;(id int, name varchar(255), username varchar(255), password varchar(255))&quot;);\r\n            \r\n            \r\n//           sql.showTables();\r\n//           sql.insertData(1, &quot;rohan&quot;, &quot;rohan&quot;, &quot;1234&quot;);\r\n//           sql.deleteData(1);\r\n            sql.readData();\r\n            \r\n        }\r\n        catch(Exception e)\r\n        {\r\n            Logger.getLogger(BankManagementSystem.class.getName()).log(Level.SEVERE, null, e);\r\n        }\r\n    }\r\n}\r\n```\r\nWhen ran with the `sql.insertData(1, &quot;rohan&quot;, &quot;rohan&quot;, &quot;1234&quot;);` statement, its shows the following output:\r\n```\r\n1 row(s) added successfully\r\n```\r\nThen after running with the `sql.readData();` statement, it shows the data entry in NetBeans.\r\nHere&#39;s the output in NetBeans:\r\n```\r\nid    name                      username                  password\r\n1     rohan                     rohan                     1234 \r\n```\r\nBut when I build the JAR file (clean and build option) then run the JAR file, it doesn&#39;t show the updated database.\r\nIt just shows:\r\n```\r\nid    name                      username                  password\r\n```\r\n\r\nPlease help me out! I want the data to be consistent. When I update the database from NetBeans, it should also reflect in the JAR file also.","title":"Why is the SQLite database not updating inside the jar file?","body":"<p>I'm encountering an issue with my Java application developed in NetBeans. The application uses an SQLite database, and I've noticed that changes made to the database persist when I run the program from within NetBeans. However, when I build the JAR file and run it separately, the database changes are not reflected.</p>\n<p>Here are some key details:</p>\n<p>The database file (customerDB.db) is stored in the &quot;databases&quot; folder, and the folder is added as a resource in my NetBeans project.\nI'm confident that I'm modifying the correct database file in the &quot;databases&quot; folder.</p>\n<p>NetBeans seems to copy the database file to a temporary location during the build process, which is used when running the JAR file.\nI would appreciate any insights into why the JAR file's database isn't updating as expected and how I can ensure that changes persist when running the JAR file.</p>\n<p>Here's the program for connecting to the SQLite Database, and updating it:</p>\n<pre><code>\npublic class SQLiteDatabase {\n\n    private Connection con;\n    private final String tableName;\n\n    public SQLiteDatabase() throws SQLException, ClassNotFoundException, IOException {\n        tableName = &quot;&quot;;\n        Class.forName(&quot;org.sqlite.JDBC&quot;);\n        Path dbFile = Files.createTempFile(null, &quot;.db&quot;);\n\n        con = DriverManager.getConnection(&quot;jdbc:sqlite::resource:customerDB.db&quot;);\n\n    }\n\n    public SQLiteDatabase(String tableName, String tableFields) throws SQLException, ClassNotFoundException, IOException {\n        this.tableName = tableName;\n        Class.forName(&quot;org.sqlite.JDBC&quot;);\n        String query = String.format(&quot;CREATE TABLE IF NOT EXISTS %s %s&quot;, tableName, tableFields);\n        \n        con = DriverManager.getConnection(&quot;jdbc:sqlite::resource:customerDB.db&quot;);\n        \n        Statement st = con.createStatement();\n        st.executeUpdate(query);\n    }\n\n    public void showTables() throws SQLException {\n        try (ResultSet rs = con.getMetaData().getTables(null, null, null, null)) {\n            while (rs.next()) {\n                System.out.println(rs.getString(&quot;TABLE_NAME&quot;));\n            }\n        }\n    }\n\n    public void insertData(int id, String name, String username, String password) throws SQLException {\n        String query = String.format(&quot;INSERT INTO %s VALUES(?,?,?,?)&quot;, tableName);\n        PreparedStatement p = con.prepareStatement(query);\n        p.setInt(1, id);\n        p.setString(2, name);\n        p.setString(3, username);\n        p.setString(4, password);\n\n        int count = p.executeUpdate();\n\n        System.out.println(String.format(&quot;%d row(s) added sucessfully&quot;, count));\n\n        p.close();\n    }\n\n    public void readData() throws SQLException {\n        String query = String.format(&quot;SELECT * FROM %s&quot;, tableName);\n        Formatter formatter = new Formatter();\n\n        try (Statement st = con.createStatement(); \n             ResultSet rs = st.executeQuery(query)) {\n\n            formatter.format(&quot;%-5s %-25s %-25s %-25s\\n&quot;, &quot;id&quot;, &quot;name&quot;, &quot;username&quot;, &quot;password&quot;);\n\n        while(rs.next())\n        {\n            int id = rs.getInt(1);\n            String name = rs.getString(2);\n            String username = rs.getString(3);\n            String password = rs.getString(4);\n            \n            formatter.format(&quot;%-5s %-25s %-25s %-25s\\n&quot;, id,name,username, password);\n\n        }\n            System.out.println(formatter);\n\n        }\n    }\n    \n    public void deleteData(int id) throws SQLException {\n        String query = String.format(&quot;DELETE FROM %s WHERE id=?&quot;, tableName);\n        try (PreparedStatement p = con.prepareStatement(query)) {\n            p.setInt(1, id);\n            \n            int count = p.executeUpdate();\n            \n            System.out.println(String.format(&quot;%d row(s) deleted sucessfully&quot;, count));\n        }\n    }\n\n    public Boolean close() throws SQLException {\n        con.close();\n    }\n}\n</code></pre>\n<p>And here's the driver code:</p>\n<pre><code>import sqlite.SQLiteDatabase;\n\npublic class BankManagementSystem {\n    public static void main(String[] args) {\n        \n        try(Scanner sc = new Scanner(System.in))\n        {  \n            SQLiteDatabase sql = new SQLiteDatabase(&quot;login_details&quot;, &quot;(id int, name varchar(255), username varchar(255), password varchar(255))&quot;);\n            \n            \n//           sql.showTables();\n//           sql.insertData(1, &quot;rohan&quot;, &quot;rohan&quot;, &quot;1234&quot;);\n//           sql.deleteData(1);\n            sql.readData();\n            \n        }\n        catch(Exception e)\n        {\n            Logger.getLogger(BankManagementSystem.class.getName()).log(Level.SEVERE, null, e);\n        }\n    }\n}\n</code></pre>\n<p>When ran with the <code>sql.insertData(1, &quot;rohan&quot;, &quot;rohan&quot;, &quot;1234&quot;);</code> statement, its shows the following output:</p>\n<pre><code>1 row(s) added successfully\n</code></pre>\n<p>Then after running with the <code>sql.readData();</code> statement, it shows the data entry in NetBeans.\nHere's the output in NetBeans:</p>\n<pre><code>id    name                      username                  password\n1     rohan                     rohan                     1234 \n</code></pre>\n<p>But when I build the JAR file (clean and build option) then run the JAR file, it doesn't show the updated database.\nIt just shows:</p>\n<pre><code>id    name                      username                  password\n</code></pre>\n<p>Please help me out! I want the data to be consistent. When I update the database from NetBeans, it should also reflect in the JAR file also.</p>\n"},{"tags":["java","spring","logging","cxf"],"owner":{"account_id":6374796,"reputation":386,"user_id":4946127,"accept_rate":67,"display_name":"user2594"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":24,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694338840,"creation_date":1694338840,"question_id":77075547,"body_markdown":"We have an embedded JAX-RS web service within a stand-alone Java application using Apache CXF with Spring and having a traditional web.xml deployment descriptor to configure the beans.\r\n\r\nWhen we invoke an API call from a rest client, we could see the below logs getting generated which we wanted to suppress.\r\n\r\n    \r\n    Service http request on thread: Thread[http-nio-8088-exec-9,5,main]\r\n    Create a new message for processing\r\n    Request Headers: {accept-encoding=[gzip, deflate, br], Authorization=[***], cache-control=[no-cache], connection=[keep-alive], Content-Length=[2827], content-type=[application/json], host=[localhost:8088], postman-token=[e4a88b18-c864-4267-92b0-e8659007118c], Proxy-Authorization=[***], user-agent=[PostmanRuntime/7.29.2],consumer.id=[a3b799098c9e493a9b3a04ba4daedae091ajaqqo], svc.version=[2.0.0]}\r\n    Adding interceptor org.apache.cxf.transport.https.CertConstraintsInterceptor@7ac897c2 to phase pre-stream\r\n    Chain org.apache.cxf.phase.PhaseInterceptorChain@26a32a9c was created. Current flow:\r\n      pre-stream [CertConstraintsInterceptor]\r\n      unmarshal [JAXRSInInterceptor]\r\n      pre-logical [OneWayProcessorInterceptor]\r\n      invoke [ServiceInvokerInterceptor]\r\n      post-invoke [OutgoingChainInterceptor]\r\n    \r\n    Invoking handleMessage on interceptor org.apache.cxf.transport.https.CertConstraintsInterceptor@7ac897c2\r\n    Invoking handleMessage on interceptor org.apache.cxf.jaxrs.interceptor.JAXRSInInterceptor@735f6995\r\n    Trying to select a resource class, request path : /v1/api/fetch\r\n    Resource class\r\n    No method match, method name : implService, request path : /fetch, method @Path : /simulate, HTTP Method : POST, method HTTP Method : POST, ContentType : application/json, method @Consumes : application/json,application/xml,text/xml,, Accept : */*,, method @Produces : */*,.\r\n    Resource operation service may get selected\r\n    Resource operation service on the resource class \r\n    Request path is: /v1/api/fetch\r\n    Request HTTP method is: POST\r\n    Request contentType is: application/json\r\n    Accept contentType is: */*\r\n    Found operation: fetchService\r\n    Invoking handleMessage on interceptor org.apache.cxf.interceptor.OneWayProcessorInterceptor@13a230be\r\n    Invoking handleMessage on interceptor org.apache.cxf.interceptor.ServiceInvokerInterceptor@6c4f928\r\n\r\n\r\nWe are looking to suppress these logs. One way I could think of is by adding below:-\r\n\r\n    &lt;jaxrs:properties&gt;\r\n        &lt;entry key=&quot;org.apache.cxf.Logger&quot; value=&quot;org.apache.cxf.common.logging.Log4jLogger&quot; /&gt;\r\n    &lt;/jaxrs:properties&gt;\r\n\r\nto jax rs configuration in webContext.xml:\r\n\r\n    &lt;jaxrs:server address=&quot;/services&quot;&gt;\r\n        &lt;jaxrs:serviceBeans&gt;\r\n            &lt;ref bean=&quot;router${router.runas}DeliveryService&quot; /&gt;\r\n        &lt;/jaxrs:serviceBeans&gt;\r\n        &lt;jaxrs:providers&gt;\r\n            &lt;ref bean=&quot;provider&quot; /&gt;\r\n            &lt;ref bean=&quot;exceptionMapper&quot; /&gt;\r\n        &lt;/jaxrs:providers&gt;\r\n        &lt;jaxrs:properties&gt;\r\n            &lt;entry key=&quot;org.apache.cxf.Logger&quot; value=&quot;org.apache.cxf.common.logging.Log4jLogger&quot; /&gt;\r\n        &lt;/jaxrs:properties&gt;\r\n    &lt;/jaxrs:server&gt;\r\n\r\nAnd passing the following JVM args while starting up the application.\r\n\r\n    -Dlog4j.logger.org.apache.cxf.name=org.apache.cxf\r\n    -Dlog4j.logger.org.apache.cxf.level=ERROR\r\n\r\nBut this is not solving and we are still seeing the logs. Can someone please take a look and suggest where things are going wrong. TIA.","title":"Apache CXF logs are not getting suppressed","body":"<p>We have an embedded JAX-RS web service within a stand-alone Java application using Apache CXF with Spring and having a traditional web.xml deployment descriptor to configure the beans.</p>\n<p>When we invoke an API call from a rest client, we could see the below logs getting generated which we wanted to suppress.</p>\n<pre><code>Service http request on thread: Thread[http-nio-8088-exec-9,5,main]\nCreate a new message for processing\nRequest Headers: {accept-encoding=[gzip, deflate, br], Authorization=[***], cache-control=[no-cache], connection=[keep-alive], Content-Length=[2827], content-type=[application/json], host=[localhost:8088], postman-token=[e4a88b18-c864-4267-92b0-e8659007118c], Proxy-Authorization=[***], user-agent=[PostmanRuntime/7.29.2],consumer.id=[a3b799098c9e493a9b3a04ba4daedae091ajaqqo], svc.version=[2.0.0]}\nAdding interceptor org.apache.cxf.transport.https.CertConstraintsInterceptor@7ac897c2 to phase pre-stream\nChain org.apache.cxf.phase.PhaseInterceptorChain@26a32a9c was created. Current flow:\n  pre-stream [CertConstraintsInterceptor]\n  unmarshal [JAXRSInInterceptor]\n  pre-logical [OneWayProcessorInterceptor]\n  invoke [ServiceInvokerInterceptor]\n  post-invoke [OutgoingChainInterceptor]\n\nInvoking handleMessage on interceptor org.apache.cxf.transport.https.CertConstraintsInterceptor@7ac897c2\nInvoking handleMessage on interceptor org.apache.cxf.jaxrs.interceptor.JAXRSInInterceptor@735f6995\nTrying to select a resource class, request path : /v1/api/fetch\nResource class\nNo method match, method name : implService, request path : /fetch, method @Path : /simulate, HTTP Method : POST, method HTTP Method : POST, ContentType : application/json, method @Consumes : application/json,application/xml,text/xml,, Accept : */*,, method @Produces : */*,.\nResource operation service may get selected\nResource operation service on the resource class \nRequest path is: /v1/api/fetch\nRequest HTTP method is: POST\nRequest contentType is: application/json\nAccept contentType is: */*\nFound operation: fetchService\nInvoking handleMessage on interceptor org.apache.cxf.interceptor.OneWayProcessorInterceptor@13a230be\nInvoking handleMessage on interceptor org.apache.cxf.interceptor.ServiceInvokerInterceptor@6c4f928\n</code></pre>\n<p>We are looking to suppress these logs. One way I could think of is by adding below:-</p>\n<pre><code>&lt;jaxrs:properties&gt;\n    &lt;entry key=&quot;org.apache.cxf.Logger&quot; value=&quot;org.apache.cxf.common.logging.Log4jLogger&quot; /&gt;\n&lt;/jaxrs:properties&gt;\n</code></pre>\n<p>to jax rs configuration in webContext.xml:</p>\n<pre><code>&lt;jaxrs:server address=&quot;/services&quot;&gt;\n    &lt;jaxrs:serviceBeans&gt;\n        &lt;ref bean=&quot;router${router.runas}DeliveryService&quot; /&gt;\n    &lt;/jaxrs:serviceBeans&gt;\n    &lt;jaxrs:providers&gt;\n        &lt;ref bean=&quot;provider&quot; /&gt;\n        &lt;ref bean=&quot;exceptionMapper&quot; /&gt;\n    &lt;/jaxrs:providers&gt;\n    &lt;jaxrs:properties&gt;\n        &lt;entry key=&quot;org.apache.cxf.Logger&quot; value=&quot;org.apache.cxf.common.logging.Log4jLogger&quot; /&gt;\n    &lt;/jaxrs:properties&gt;\n&lt;/jaxrs:server&gt;\n</code></pre>\n<p>And passing the following JVM args while starting up the application.</p>\n<pre><code>-Dlog4j.logger.org.apache.cxf.name=org.apache.cxf\n-Dlog4j.logger.org.apache.cxf.level=ERROR\n</code></pre>\n<p>But this is not solving and we are still seeing the logs. Can someone please take a look and suggest where things are going wrong. TIA.</p>\n"},{"tags":["java","mysql","json","jdbc","max-allowed-packet"],"comments":[{"owner":{"account_id":7035840,"reputation":33810,"user_id":5389997,"display_name":"Shadow"},"score":1,"creation_date":1694338666,"post_id":77075522,"comment_id":135875863,"body_markdown":"Nothing, really. If you bump into the packet size limot, then either you have to increase the limit or dexrease the size of the data you send.","body":"Nothing, really. If you bump into the packet size limot, then either you have to increase the limit or dexrease the size of the data you send."},{"owner":{"account_id":5577723,"reputation":2140,"user_id":4420649,"display_name":"Wilson Hauck"},"score":1,"creation_date":1694501664,"post_id":77075522,"comment_id":135895190,"body_markdown":"Is your organization financially impacted by this inability to process data someone is providing for your consumption?  If so, share this reality with the DBA and maybe he will consider taking it to the limit of 1G.  If RAM is available on the server.  HTOP or TOP provides clues on RAM availability and usage for most Linux type systems..  Windows has similar clues.","body":"Is your organization financially impacted by this inability to process data someone is providing for your consumption?  If so, share this reality with the DBA and maybe he will consider taking it to the limit of 1G.  If RAM is available on the server.  HTOP or TOP provides clues on RAM availability and usage for most Linux type systems..  Windows has similar clues."},{"owner":{"account_id":18991005,"reputation":1312,"user_id":13860286,"display_name":"Shila Mosammami"},"score":0,"creation_date":1694504169,"post_id":77075522,"comment_id":135895647,"body_markdown":"@WilsonHauck Thank you,  This problem does not happen too often, after we migrated to new google API for reading the insights, I considered like the old API a delay of 72 hours but seemingly new API is more than 5 days late so I am obligated to update my database values for at least 3 months which leads to this much info. Right now I have just broke down the number of records to save and once updated for all the clients there wouldn&#39;t be a problem.","body":"@WilsonHauck Thank you,  This problem does not happen too often, after we migrated to new google API for reading the insights, I considered like the old API a delay of 72 hours but seemingly new API is more than 5 days late so I am obligated to update my database values for at least 3 months which leads to this much info. Right now I have just broke down the number of records to save and once updated for all the clients there wouldn&#39;t be a problem."},{"owner":{"account_id":5577723,"reputation":2140,"user_id":4420649,"display_name":"Wilson Hauck"},"score":1,"creation_date":1694509676,"post_id":77075522,"comment_id":135896650,"body_markdown":"The very best always.  For performance tuning, view profile info.","body":"The very best always.  For performance tuning, view profile info."},{"owner":{"account_id":529143,"reputation":136619,"user_id":1766831,"display_name":"Rick James"},"score":0,"creation_date":1695001325,"post_id":77075522,"comment_id":135961325,"body_markdown":"Are you generating the input string in Java?  Can you stop before hitting the 64KB limit?  Or change the configuration if you will not exceed the hard limit of 1MB","body":"Are you generating the input string in Java?  Can you stop before hitting the 64KB limit?  Or change the configuration if you will not exceed the hard limit of 1MB"},{"owner":{"account_id":18991005,"reputation":1312,"user_id":13860286,"display_name":"Shila Mosammami"},"score":0,"creation_date":1695020639,"post_id":77075522,"comment_id":135962956,"body_markdown":"@RickJames,  I am doing the split before reaching the limit, I was wondering if there is another way t tackle the issue but seems that there is no other method.","body":"@RickJames,  I am doing the split before reaching the limit, I was wondering if there is another way t tackle the issue but seems that there is no other method."},{"owner":{"account_id":529143,"reputation":136619,"user_id":1766831,"display_name":"Rick James"},"score":1,"creation_date":1695063318,"post_id":77075522,"comment_id":135971393,"body_markdown":"typo:  the hard limit is 1GB.","body":"typo:  the hard limit is 1GB."}],"owner":{"account_id":18991005,"reputation":1312,"user_id":13860286,"display_name":"Shila Mosammami"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":27,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694338358,"creation_date":1694338358,"question_id":77075522,"body_markdown":"I have this error while inserting batch in mysql:\r\n\r\n    java.sql.BatchUpdateException: Packet for query is too large (70,566,811 &gt; 67,108,864). You can change this value on the server by setting the &#39;max_allowed_packet&#39; variable.\r\n\r\nI need to read the insights from a Google-API day by day and save them using [fetchMultiDailyMetricsTimeSeries Method][1]. Everyday, the program should get executed to read the info related to 3 days ago,but I discovered that Google is not updated for last three days and **Now** I am obligated to update the info in my table for at least 3 months. Here arise the problem that we receive loads of data on a field typed JSON in `mysql` returned from API. So, I cannot change the table structure since there are other programs reading from this table and this problem will be no longer valid after updating the table.\r\n\r\nThe query is a simple Insert that I need to to consider `ON DUPLICATE UPDATE`. In fact, I cannot change the `max-allowed-pocket` variable (The ***DBA*** does not want to change it). \r\n\r\nI have split my list in a way that for every 500 records, the program goes to do the insert. However, it seems that it is not enough and the received data is too large even in 500 records limit. right now, I am trying to make the break-point smaller and also fetch the info for a shorter loop of days like 10 so that there would not be a problem but this would be too slow since I need to perform these for all the clients (more than 20) and for 90 days.\r\n\r\nI use `JAVA` and `JDBC Prepared Statement`. \r\n\r\nWhat can I do else?\r\n\r\n\r\n\r\n  [1]: https://developers.google.com/my-business/reference/performance/rest/v1/locations/fetchMultiDailyMetricsTimeSeries","title":"max-allowed-packet error in sql while fetching data from Google API and batch insert","body":"<p>I have this error while inserting batch in mysql:</p>\n<pre><code>java.sql.BatchUpdateException: Packet for query is too large (70,566,811 &gt; 67,108,864). You can change this value on the server by setting the 'max_allowed_packet' variable.\n</code></pre>\n<p>I need to read the insights from a Google-API day by day and save them using <a href=\"https://developers.google.com/my-business/reference/performance/rest/v1/locations/fetchMultiDailyMetricsTimeSeries\" rel=\"nofollow noreferrer\">fetchMultiDailyMetricsTimeSeries Method</a>. Everyday, the program should get executed to read the info related to 3 days ago,but I discovered that Google is not updated for last three days and <strong>Now</strong> I am obligated to update the info in my table for at least 3 months. Here arise the problem that we receive loads of data on a field typed JSON in <code>mysql</code> returned from API. So, I cannot change the table structure since there are other programs reading from this table and this problem will be no longer valid after updating the table.</p>\n<p>The query is a simple Insert that I need to to consider <code>ON DUPLICATE UPDATE</code>. In fact, I cannot change the <code>max-allowed-pocket</code> variable (The <em><strong>DBA</strong></em> does not want to change it).</p>\n<p>I have split my list in a way that for every 500 records, the program goes to do the insert. However, it seems that it is not enough and the received data is too large even in 500 records limit. right now, I am trying to make the break-point smaller and also fetch the info for a shorter loop of days like 10 so that there would not be a problem but this would be too slow since I need to perform these for all the clients (more than 20) and for 90 days.</p>\n<p>I use <code>JAVA</code> and <code>JDBC Prepared Statement</code>.</p>\n<p>What can I do else?</p>\n"},{"tags":["java","proguard","quarkus","obfuscation","uberjar"],"owner":{"account_id":9502539,"reputation":814,"user_id":7063104,"display_name":"Archsx"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":35,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1694337593,"creation_date":1694337593,"question_id":77075473,"body_markdown":"I&#39;m building a regular uber-jar (not native executable file) based on Quarkus. and I also wanna obfuscate the uber-jar. so I build the jar file with \r\n```\r\n ./gradlew quarkusBuild -Dquarkus.package.type=uber-jar\r\n\r\n```\r\nand here is part of build.gradle.kts\r\n```\r\n tasks.register(&quot;proguard&quot;, JavaExec::class) {\r\n    classpath = files(&quot;$rootDir/proguard/lib/proguard.jar&quot;)\r\n    main = &quot;proguard.ProGuard&quot;\r\n    args(\r\n        &quot;-include&quot;,\r\n        &quot;proguard.conf&quot;,\r\n        &quot;-injars&quot;,\r\n        &quot;build/my-project-1.0.0-runner.jar&quot;,\r\n        &quot;-outjars&quot;,\r\n        &quot;build/app.jar&quot;\r\n    )\r\n }\r\n\r\n```\r\nhowerver, after I build the jar and run `./gradlew proguard`, I got tons of warnings, \r\n```\r\nWarning: there were 3260 unresolved references to classes or interfaces.\r\n\r\nWarning: there were 56 unresolved references to program class members.\r\n\r\nWarning: there were 204 unresolved references to library class members.\r\n\r\n```\r\n\r\n**Thounds** of warnings !!  I think maybe I should use option `-keep` to prevent some package from obfuscating.but there are too many warnings and I wonder is it the right way to fix the warning. anyway I add some `-keep` option in `proguard.conf`, and it is interesting that I find some option not work. here is my proguard.conf:\r\n```\r\n-target 17\r\n# -verbose\r\n\r\n-dontshrink\r\n\r\n-dontoptimize\r\n\r\n-dontwarn\r\n\r\n-adaptclassstrings\r\n\r\n-libraryjars /usr/lib/jvm/temurin-17-jdk-amd64/jmods/java.base.jmod\r\n-libraryjars /usr/lib/jvm/temurin-17-jdk-amd64/jmods/java.logging.jmod\r\n-libraryjars /usr/lib/jvm/temurin-17-jdk-amd64/jmods/java.sql.jmod\r\n-libraryjars /usr/lib/jvm/temurin-17-jdk-amd64/jmods/java.xml.jmod\r\n\r\n\r\n\r\n\r\n# Keep all Quarkus-related classes and resources\r\n-keep class io.quarkus.** { *; }\r\n-keep class io.quarkus.vertx.** { *; }\r\n-keep interface io.quarkus.vertx.** { *; }\r\n-keep class io.vertx.** { *; }\r\n-keep class io.vertx.**\r\n-keep class io.vertx.** {\r\n    *;\r\n}\r\n\r\n-keep interface io.vertx.** { *; }\r\n-keep interface com.sun.** { *; }\r\n-keep interface io.quarkus.** { *; }\r\n-keep class javax.** { *; }\r\n-keep class com.google.common.** { *; }\r\n-keep class com.sun.** { *; }\r\n-keep class java.util.logging.Level { *; }\r\n-keep class com.fasterxml.jackson.annotation.** { *; }\r\n-dontwarn  com.fasterxml.jackson.databind\r\n-dontwarn  javax.annotation.**\r\n-dontwarn  javax.xml.**\r\n-dontwarn  javax.**\r\n-dontwarn  java.awt.**\r\n-keep class javax.annotation.** { *; }\r\n-keep class  org.apache.log4j.** { *; }\r\n-keep class  org.apache.log4j.**\r\n-keep class  org.jboss.** { *; }\r\n-keep class  org.jboss.**\r\n-keep class  io.netty.** { *; }\r\n-keep class  io.netty.**\r\n-keep class  sun.misc.** { *; }\r\n-keep class  sun.misc.**\r\n\r\n-keepattributes *Annotation*,Signature\r\n\r\n# Keep application-specific classes and resources\r\n-keep class org.myproject.** { *; }\r\n\r\n```\r\nAs you can see , I&#39;ve add `-keep class  io.netty.** { *; }\r\n-keep class  io.netty.**` but still got io.netty warning:\r\n```\r\n// part of the massive warning\r\n\r\nWarning: io.netty.handler.ssl.OpenSsl: can&#39;t find referenced class io.netty.internal.tcnative.SSL\r\nWarning: io.netty.handler.ssl.OpenSsl: can&#39;t find referenced class io.netty.internal.tcnative.SSLContext\r\n\r\n// ...\r\n// also, I&#39;ve add -keep org.jboss.**\r\nWarning: io.netty.handler.codec.marshalling.LimitingByteInput: can&#39;t find referenced class org.jboss.marshalling.ByteInput \r\n\r\n// and some similar occasion, I&#39;ve add the keep option but still get warning\r\nWarning: com.google.common.util.concurrent.AbstractFuture$UnsafeAtomicHelper: can&#39;t find referenced class sun.misc.Unsafe\r\n\r\n\r\n// I&#39;ve add java.base.jmod and java.logging.jmod, java.sql.jmod and java.xml.jmod \r\n// now I have to add java.beans.jmod ? I have to add all the jmod in the jdk?\r\nWarning: com.fasterxml.jackson.databind.ext.Java7SupportImpl: can&#39;t find referenced class java.beans.Transient\r\nWarning: com.fasterxml.jackson.databind.ext.Java7SupportImpl: can&#39;t find referenced class java.beans.ConstructorProperties\r\nWarning: com.fasterxml.jackson.databind.ext.Java7SupportImpl: can&#39;t find referenced class java.beans.Transient\r\n\r\n\r\n\r\n```\r\nmaybe you&#39;ve notice that I have even add `-dontwarn` but why I **still** got the thounds warnings . \r\n","title":"proguard.conf option -keep and -dontwarn not work","body":"<p>I'm building a regular uber-jar (not native executable file) based on Quarkus. and I also wanna obfuscate the uber-jar. so I build the jar file with</p>\n<pre><code> ./gradlew quarkusBuild -Dquarkus.package.type=uber-jar\n\n</code></pre>\n<p>and here is part of build.gradle.kts</p>\n<pre><code> tasks.register(&quot;proguard&quot;, JavaExec::class) {\n    classpath = files(&quot;$rootDir/proguard/lib/proguard.jar&quot;)\n    main = &quot;proguard.ProGuard&quot;\n    args(\n        &quot;-include&quot;,\n        &quot;proguard.conf&quot;,\n        &quot;-injars&quot;,\n        &quot;build/my-project-1.0.0-runner.jar&quot;,\n        &quot;-outjars&quot;,\n        &quot;build/app.jar&quot;\n    )\n }\n\n</code></pre>\n<p>howerver, after I build the jar and run <code>./gradlew proguard</code>, I got tons of warnings,</p>\n<pre><code>Warning: there were 3260 unresolved references to classes or interfaces.\n\nWarning: there were 56 unresolved references to program class members.\n\nWarning: there were 204 unresolved references to library class members.\n\n</code></pre>\n<p><strong>Thounds</strong> of warnings !!  I think maybe I should use option <code>-keep</code> to prevent some package from obfuscating.but there are too many warnings and I wonder is it the right way to fix the warning. anyway I add some <code>-keep</code> option in <code>proguard.conf</code>, and it is interesting that I find some option not work. here is my proguard.conf:</p>\n<pre><code>-target 17\n# -verbose\n\n-dontshrink\n\n-dontoptimize\n\n-dontwarn\n\n-adaptclassstrings\n\n-libraryjars /usr/lib/jvm/temurin-17-jdk-amd64/jmods/java.base.jmod\n-libraryjars /usr/lib/jvm/temurin-17-jdk-amd64/jmods/java.logging.jmod\n-libraryjars /usr/lib/jvm/temurin-17-jdk-amd64/jmods/java.sql.jmod\n-libraryjars /usr/lib/jvm/temurin-17-jdk-amd64/jmods/java.xml.jmod\n\n\n\n\n# Keep all Quarkus-related classes and resources\n-keep class io.quarkus.** { *; }\n-keep class io.quarkus.vertx.** { *; }\n-keep interface io.quarkus.vertx.** { *; }\n-keep class io.vertx.** { *; }\n-keep class io.vertx.**\n-keep class io.vertx.** {\n    *;\n}\n\n-keep interface io.vertx.** { *; }\n-keep interface com.sun.** { *; }\n-keep interface io.quarkus.** { *; }\n-keep class javax.** { *; }\n-keep class com.google.common.** { *; }\n-keep class com.sun.** { *; }\n-keep class java.util.logging.Level { *; }\n-keep class com.fasterxml.jackson.annotation.** { *; }\n-dontwarn  com.fasterxml.jackson.databind\n-dontwarn  javax.annotation.**\n-dontwarn  javax.xml.**\n-dontwarn  javax.**\n-dontwarn  java.awt.**\n-keep class javax.annotation.** { *; }\n-keep class  org.apache.log4j.** { *; }\n-keep class  org.apache.log4j.**\n-keep class  org.jboss.** { *; }\n-keep class  org.jboss.**\n-keep class  io.netty.** { *; }\n-keep class  io.netty.**\n-keep class  sun.misc.** { *; }\n-keep class  sun.misc.**\n\n-keepattributes *Annotation*,Signature\n\n# Keep application-specific classes and resources\n-keep class org.myproject.** { *; }\n\n</code></pre>\n<p>As you can see , I've add <code>-keep class  io.netty.** { *; } -keep class  io.netty.**</code> but still got io.netty warning:</p>\n<pre><code>// part of the massive warning\n\nWarning: io.netty.handler.ssl.OpenSsl: can't find referenced class io.netty.internal.tcnative.SSL\nWarning: io.netty.handler.ssl.OpenSsl: can't find referenced class io.netty.internal.tcnative.SSLContext\n\n// ...\n// also, I've add -keep org.jboss.**\nWarning: io.netty.handler.codec.marshalling.LimitingByteInput: can't find referenced class org.jboss.marshalling.ByteInput \n\n// and some similar occasion, I've add the keep option but still get warning\nWarning: com.google.common.util.concurrent.AbstractFuture$UnsafeAtomicHelper: can't find referenced class sun.misc.Unsafe\n\n\n// I've add java.base.jmod and java.logging.jmod, java.sql.jmod and java.xml.jmod \n// now I have to add java.beans.jmod ? I have to add all the jmod in the jdk?\nWarning: com.fasterxml.jackson.databind.ext.Java7SupportImpl: can't find referenced class java.beans.Transient\nWarning: com.fasterxml.jackson.databind.ext.Java7SupportImpl: can't find referenced class java.beans.ConstructorProperties\nWarning: com.fasterxml.jackson.databind.ext.Java7SupportImpl: can't find referenced class java.beans.Transient\n\n\n\n</code></pre>\n<p>maybe you've notice that I have even add <code>-dontwarn</code> but why I <strong>still</strong> got the thounds warnings .</p>\n"},{"tags":["java","android","overlay","android-button","android-overlay"],"answers":[{"comments":[{"owner":{"account_id":18331583,"reputation":39,"user_id":13349991,"display_name":"Mirek"},"score":0,"creation_date":1694289867,"post_id":77070664,"comment_id":135872813,"body_markdown":"Yes, you are right but that is not important in this time because I need to see floating widget button at first, then I can click and see text dialog.","body":"Yes, you are right but that is not important in this time because I need to see floating widget button at first, then I can click and see text dialog."},{"owner":{"account_id":26840344,"reputation":134,"user_id":20426969,"display_name":"Sarmad Ali"},"score":0,"creation_date":1694336635,"post_id":77070664,"comment_id":135875685,"body_markdown":"@Mirek check the second answer i posted","body":"@Mirek check the second answer i posted"}],"tags":[],"owner":{"account_id":26840344,"reputation":134,"user_id":20426969,"display_name":"Sarmad Ali"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694227898,"creation_date":1694227898,"answer_id":77070664,"question_id":77069843,"body_markdown":"Your showTextDialog() method in FloatingWidgetService.java is empty and that&#39;s why nothing appears when you call this empty method:\r\n\r\n     private void showTextDialog() {\r\n    \r\n        }\r\n\r\ntry this to test if it is properly working or not and then replace it with your code you want:\r\n\r\n    private void showTextDialog() {\r\n        Toast.makeText(this, &quot;Button clicked!&quot;, Toast.LENGTH_SHORT).show();\r\n    }\r\n\r\n\r\n\r\n","title":"Why floating widget overlay button is not visible and code is without error?","body":"<p>Your showTextDialog() method in FloatingWidgetService.java is empty and that's why nothing appears when you call this empty method:</p>\n<pre><code> private void showTextDialog() {\n\n    }\n</code></pre>\n<p>try this to test if it is properly working or not and then replace it with your code you want:</p>\n<pre><code>private void showTextDialog() {\n    Toast.makeText(this, &quot;Button clicked!&quot;, Toast.LENGTH_SHORT).show();\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":18331583,"reputation":39,"user_id":13349991,"display_name":"Mirek"},"score":0,"creation_date":1694448207,"post_id":77075420,"comment_id":135889093,"body_markdown":"Yes, it works, thank you. The problem that there is required second app start is only for first time when you allow permissions to apps, right?","body":"Yes, it works, thank you. The problem that there is required second app start is only for first time when you allow permissions to apps, right?"},{"owner":{"account_id":26840344,"reputation":134,"user_id":20426969,"display_name":"Sarmad Ali"},"score":0,"creation_date":1694449845,"post_id":77075420,"comment_id":135889412,"body_markdown":"Yes, once permission is granted it will show floating widget and perform other actions on it accordingly how you control it.","body":"Yes, once permission is granted it will show floating widget and perform other actions on it accordingly how you control it."}],"tags":[],"owner":{"account_id":26840344,"reputation":134,"user_id":20426969,"display_name":"Sarmad Ali"},"comment_count":2,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694337406,"creation_date":1694336566,"answer_id":77075420,"question_id":77069843,"body_markdown":"I have done some modification in your files. This code works fine when i tested it on my physical device, but it has one drawback that when user granted the permission of overlay it do not show floating widget but when you relaunch the app then it show the flaoting button. if you want to achieve this when user granted permission and it should show the flaoting widget immediately after it you can do it by imlementing broadcast receiver (with permission of MANAGE_OVERLAY_PERMISSION&quot;) and using the foregroundservice: however the code is this:\r\n\r\nMainActivity.java:\r\n\r\n    public class MainActivity extends AppCompatActivity {\r\n    \r\n        @Override\r\n        protected void onCreate(Bundle savedInstanceState) {\r\n            super.onCreate(savedInstanceState);\r\n            setContentView(R.layout.activity_main);\r\n    \r\n            startFloatingWidgetService();\r\n        }\r\n        private void startFloatingWidgetService() {\r\n            Intent intent = new Intent(this, FloatingWidgetService.class);\r\n            startService(intent);\r\n        }\r\n    }\r\n\r\nFloatingWidgetService.java\r\n\r\nIn this class the main change i did is to check if we have permission to overlay or not. if not request permission if it&#39;s already give or not needed then show widget.\r\n\r\n    public class FloatingWidgetService extends Service {\r\n\r\n    \r\n    private WindowManager mWindowManager;\r\n    private View mFloatingWidgetView;\r\n    @Override\r\n    public IBinder onBind(Intent intent) {\r\n        \r\n        return null;\r\n    }\r\n\r\n    // Method to request the SYSTEM_ALERT_WINDOW permission\r\n    private void requestOverlayPermission() {\r\n\r\n        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) {\r\n            Intent intent = new Intent(Settings.ACTION_MANAGE_OVERLAY_PERMISSION);\r\n            intent.setData(Uri.parse(&quot;package:&quot; + getPackageName()));\r\n            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\r\n            startActivity(intent);\r\n        }\r\n    }\r\n\r\n    // Method to create the floating widget\r\n    private void createFloatingWidget() {\r\n\r\n        // Inflate the layout for the floating widget\r\n        mFloatingWidgetView = LayoutInflater.from(this).inflate(R.layout.floating_widget_layout,\r\n                null);\r\n\r\n        // Initialize the button on the floating widget\r\n        Button button = mFloatingWidgetView.findViewById(R.id.floating_button);\r\n        button.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                // Handle the button click event\r\n                showTextDialog();\r\n                // You can perform other actions here as needed\r\n            }\r\n        });\r\n\r\n        // Initialize the WindowManager\r\n        mWindowManager = (WindowManager) getSystemService(WINDOW_SERVICE);\r\n\r\n        // Set up WindowManager.LayoutParams for the floating widget\r\n        WindowManager.LayoutParams params = new WindowManager.LayoutParams(\r\n                WindowManager.LayoutParams.WRAP_CONTENT,\r\n                WindowManager.LayoutParams.WRAP_CONTENT,\r\n                WindowManager.LayoutParams.TYPE_APPLICATION_OVERLAY,\r\n                WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE,\r\n                PixelFormat.TRANSLUCENT\r\n        );\r\n\r\n        // Set the gravity of the floating widget (position on the screen)\r\n        params.gravity = Gravity.BOTTOM | Gravity.END;\r\n\r\n        // Add the floating widget to the WindowManager\r\n        mWindowManager.addView(mFloatingWidgetView, params);\r\n    }\r\n\r\n    @Override\r\n    public void onCreate() {\r\n        super.onCreate();\r\n\r\n        // Check if the permission is granted (only for API level 23 and higher)\r\n        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M &amp;&amp; !Settings.canDrawOverlays(this)) {\r\n            // You don&#39;t have permission to draw overlays, so request it\r\n            requestOverlayPermission();\r\n        } else {\r\n            // Permission is granted, proceed with creating the floating widget\r\n            createFloatingWidget();\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n    @Override\r\n    public void onDestroy() {\r\n        super.onDestroy();\r\n        if (mFloatingWidgetView != null &amp;&amp; mWindowManager != null) {\r\n            mWindowManager.removeView(mFloatingWidgetView);\r\n        }\r\n    }\r\n\r\n    private void showTextDialog() {\r\n\r\n                                 }\r\n    }\r\n\r\nactivity_main.xml\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n    &lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n        xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\r\n        xmlns:tools=&quot;http://schemas.android.com/tools&quot;\r\n        android:layout_width=&quot;match_parent&quot;\r\n        android:layout_height=&quot;match_parent&quot;\r\n        tools:context=&quot;.MainActivity&quot;&gt;\r\n    \r\n        &lt;TextView\r\n            android:layout_width=&quot;wrap_content&quot;\r\n            android:layout_height=&quot;wrap_content&quot;\r\n            android:text=&quot;Hello World!&quot;\r\n            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;\r\n            app:layout_constraintEnd_toEndOf=&quot;parent&quot;\r\n            app:layout_constraintStart_toStartOf=&quot;parent&quot;\r\n            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\r\n    \r\n        &lt;Button\r\n            android:id=&quot;@+id/start_button&quot;\r\n            android:layout_width=&quot;wrap_content&quot;\r\n            android:layout_height=&quot;wrap_content&quot;\r\n            android:layout_marginTop=&quot;16dp&quot;\r\n            android:text=&quot;@string/start_floating_widget_service&quot;\r\n            app:layout_constraintEnd_toEndOf=&quot;parent&quot;\r\n            app:layout_constraintHorizontal_bias=&quot;0.5&quot;\r\n            app:layout_constraintStart_toStartOf=&quot;parent&quot;\r\n            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\r\n    \r\n    &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;\r\n\r\nfloating_widget_layout.xml\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n    &lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n        android:layout_width=&quot;wrap_content&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:orientation=&quot;vertical&quot;&gt;\r\n    \r\n        &lt;Button\r\n            android:id=&quot;@+id/floating_button&quot;\r\n            android:layout_width=&quot;wrap_content&quot;\r\n            android:layout_height=&quot;wrap_content&quot;\r\n            android:layout_gravity=&quot;end&quot;\r\n            android:background=&quot;@android:color/holo_red_light&quot;\r\n            android:text=&quot;@string/floating_widget_button&quot;\r\n            android:textColor=&quot;#212121&quot; /&gt;\r\n    \r\n    &lt;/LinearLayout&gt;\r\n\r\nAndroidManifest.xml\r\n\r\nIn your manifest you didn&#39;t added service in your manifest.\r\n\r\n    &lt;service\r\n                android:name=&quot;.FloatingWidgetService&quot;\r\n                android:enabled=&quot;true&quot;\r\n                android:exported=&quot;true&quot; /&gt;\r\n\r\nif you don&#39;t face any issue with the overlay permission then it should work by only adding service to your manifest but to be on the safe side add the code that I provided in the FloatingWidgetService class to verify the permission.\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n    &lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n        xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\r\n    \r\n        &lt;uses-permission android:name=&quot;android.permission.SYSTEM_ALERT_WINDOW&quot; /&gt;\r\n    \r\n        &lt;application\r\n            android:allowBackup=&quot;true&quot;\r\n            android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;\r\n            android:fullBackupContent=&quot;@xml/backup_rules&quot;\r\n            android:icon=&quot;@mipmap/ic_launcher&quot;\r\n            android:label=&quot;@string/app_name&quot;\r\n            android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;\r\n            android:supportsRtl=&quot;true&quot;\r\n            android:theme=&quot;@style/Theme.FloatingWidget&quot;\r\n            tools:targetApi=&quot;31&quot;&gt;\r\n    \r\n            &lt;service\r\n                android:name=&quot;.FloatingWidgetService&quot;\r\n                android:enabled=&quot;true&quot;\r\n                android:exported=&quot;true&quot; /&gt;\r\n    \r\n            &lt;activity\r\n                android:name=&quot;.MainActivity&quot;\r\n                android:exported=&quot;true&quot;&gt;\r\n                &lt;intent-filter&gt;\r\n                    &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\r\n    \r\n                    &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\r\n                &lt;/intent-filter&gt;\r\n            &lt;/activity&gt;\r\n        &lt;/application&gt;\r\n    \r\n    &lt;/manifest&gt;\r\n\r\n\r\n\r\nYou can access the code here : [Github][1]\r\n\r\nlet me know if it works for you or not.\r\n\r\n\r\n  [1]: https://github.com/sarmadalij/FloatingWidget","title":"Why floating widget overlay button is not visible and code is without error?","body":"<p>I have done some modification in your files. This code works fine when i tested it on my physical device, but it has one drawback that when user granted the permission of overlay it do not show floating widget but when you relaunch the app then it show the flaoting button. if you want to achieve this when user granted permission and it should show the flaoting widget immediately after it you can do it by imlementing broadcast receiver (with permission of MANAGE_OVERLAY_PERMISSION&quot;) and using the foregroundservice: however the code is this:</p>\n<p>MainActivity.java:</p>\n<pre><code>public class MainActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        startFloatingWidgetService();\n    }\n    private void startFloatingWidgetService() {\n        Intent intent = new Intent(this, FloatingWidgetService.class);\n        startService(intent);\n    }\n}\n</code></pre>\n<p>FloatingWidgetService.java</p>\n<p>In this class the main change i did is to check if we have permission to overlay or not. if not request permission if it's already give or not needed then show widget.</p>\n<pre><code>public class FloatingWidgetService extends Service {\n\n\nprivate WindowManager mWindowManager;\nprivate View mFloatingWidgetView;\n@Override\npublic IBinder onBind(Intent intent) {\n    \n    return null;\n}\n\n// Method to request the SYSTEM_ALERT_WINDOW permission\nprivate void requestOverlayPermission() {\n\n    if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) {\n        Intent intent = new Intent(Settings.ACTION_MANAGE_OVERLAY_PERMISSION);\n        intent.setData(Uri.parse(&quot;package:&quot; + getPackageName()));\n        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n        startActivity(intent);\n    }\n}\n\n// Method to create the floating widget\nprivate void createFloatingWidget() {\n\n    // Inflate the layout for the floating widget\n    mFloatingWidgetView = LayoutInflater.from(this).inflate(R.layout.floating_widget_layout,\n            null);\n\n    // Initialize the button on the floating widget\n    Button button = mFloatingWidgetView.findViewById(R.id.floating_button);\n    button.setOnClickListener(new View.OnClickListener() {\n        @Override\n        public void onClick(View v) {\n            // Handle the button click event\n            showTextDialog();\n            // You can perform other actions here as needed\n        }\n    });\n\n    // Initialize the WindowManager\n    mWindowManager = (WindowManager) getSystemService(WINDOW_SERVICE);\n\n    // Set up WindowManager.LayoutParams for the floating widget\n    WindowManager.LayoutParams params = new WindowManager.LayoutParams(\n            WindowManager.LayoutParams.WRAP_CONTENT,\n            WindowManager.LayoutParams.WRAP_CONTENT,\n            WindowManager.LayoutParams.TYPE_APPLICATION_OVERLAY,\n            WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE,\n            PixelFormat.TRANSLUCENT\n    );\n\n    // Set the gravity of the floating widget (position on the screen)\n    params.gravity = Gravity.BOTTOM | Gravity.END;\n\n    // Add the floating widget to the WindowManager\n    mWindowManager.addView(mFloatingWidgetView, params);\n}\n\n@Override\npublic void onCreate() {\n    super.onCreate();\n\n    // Check if the permission is granted (only for API level 23 and higher)\n    if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M &amp;&amp; !Settings.canDrawOverlays(this)) {\n        // You don't have permission to draw overlays, so request it\n        requestOverlayPermission();\n    } else {\n        // Permission is granted, proceed with creating the floating widget\n        createFloatingWidget();\n    }\n\n\n\n}\n\n@Override\npublic void onDestroy() {\n    super.onDestroy();\n    if (mFloatingWidgetView != null &amp;&amp; mWindowManager != null) {\n        mWindowManager.removeView(mFloatingWidgetView);\n    }\n}\n\nprivate void showTextDialog() {\n\n                             }\n}\n</code></pre>\n<p>activity_main.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    tools:context=&quot;.MainActivity&quot;&gt;\n\n    &lt;TextView\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:text=&quot;Hello World!&quot;\n        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;\n        app:layout_constraintEnd_toEndOf=&quot;parent&quot;\n        app:layout_constraintStart_toStartOf=&quot;parent&quot;\n        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\n\n    &lt;Button\n        android:id=&quot;@+id/start_button&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:layout_marginTop=&quot;16dp&quot;\n        android:text=&quot;@string/start_floating_widget_service&quot;\n        app:layout_constraintEnd_toEndOf=&quot;parent&quot;\n        app:layout_constraintHorizontal_bias=&quot;0.5&quot;\n        app:layout_constraintStart_toStartOf=&quot;parent&quot;\n        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\n\n&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;\n</code></pre>\n<p>floating_widget_layout.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    android:layout_width=&quot;wrap_content&quot;\n    android:layout_height=&quot;wrap_content&quot;\n    android:orientation=&quot;vertical&quot;&gt;\n\n    &lt;Button\n        android:id=&quot;@+id/floating_button&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:layout_gravity=&quot;end&quot;\n        android:background=&quot;@android:color/holo_red_light&quot;\n        android:text=&quot;@string/floating_widget_button&quot;\n        android:textColor=&quot;#212121&quot; /&gt;\n\n&lt;/LinearLayout&gt;\n</code></pre>\n<p>AndroidManifest.xml</p>\n<p>In your manifest you didn't added service in your manifest.</p>\n<pre><code>&lt;service\n            android:name=&quot;.FloatingWidgetService&quot;\n            android:enabled=&quot;true&quot;\n            android:exported=&quot;true&quot; /&gt;\n</code></pre>\n<p>if you don't face any issue with the overlay permission then it should work by only adding service to your manifest but to be on the safe side add the code that I provided in the FloatingWidgetService class to verify the permission.</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\n\n    &lt;uses-permission android:name=&quot;android.permission.SYSTEM_ALERT_WINDOW&quot; /&gt;\n\n    &lt;application\n        android:allowBackup=&quot;true&quot;\n        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;\n        android:fullBackupContent=&quot;@xml/backup_rules&quot;\n        android:icon=&quot;@mipmap/ic_launcher&quot;\n        android:label=&quot;@string/app_name&quot;\n        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;\n        android:supportsRtl=&quot;true&quot;\n        android:theme=&quot;@style/Theme.FloatingWidget&quot;\n        tools:targetApi=&quot;31&quot;&gt;\n\n        &lt;service\n            android:name=&quot;.FloatingWidgetService&quot;\n            android:enabled=&quot;true&quot;\n            android:exported=&quot;true&quot; /&gt;\n\n        &lt;activity\n            android:name=&quot;.MainActivity&quot;\n            android:exported=&quot;true&quot;&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\n\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/activity&gt;\n    &lt;/application&gt;\n\n&lt;/manifest&gt;\n</code></pre>\n<p>You can access the code here : <a href=\"https://github.com/sarmadalij/FloatingWidget\" rel=\"nofollow noreferrer\">Github</a></p>\n<p>let me know if it works for you or not.</p>\n"}],"owner":{"account_id":18331583,"reputation":39,"user_id":13349991,"display_name":"Mirek"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":79,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77075420,"answer_count":2,"score":0,"last_activity_date":1694337406,"creation_date":1694206626,"question_id":77069843,"body_markdown":"I tried to make floating widget overlay button - like messenger profile photo widget, which is displayed when someone send you message. I used these files. When I run program, there is nothing invalid in code. I see app with button but there is nothing visible after click.\r\n\r\nMainActivity.java:\r\n```java\r\npackage com.example.mywidget;\r\n\r\nimport android.app.Activity;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\npublic class MainActivity extends Activity {\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n\r\n        startFloatingWidgetService();\r\n\r\n    };\r\n\r\n    private void startFloatingWidgetService() {\r\n        Intent intent = new Intent(this, FloatingWidgetService.class);\r\n        startService(intent);\r\n    }\r\n};\r\n```\r\n\r\n\r\nFloatingWidgetService.java\r\n```java\r\npackage com.example.mywidget; \r\n\r\nimport android.app.Service;\r\nimport android.content.Intent;\r\nimport android.graphics.PixelFormat;\r\nimport android.os.IBinder;\r\nimport android.view.Gravity;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.WindowManager;\r\nimport android.widget.Button;\r\nimport android.widget.LinearLayout;\r\n\r\npublic class FloatingWidgetService extends Service {\r\n\r\n    private WindowManager mWindowManager;\r\n    private View mFloatingWidgetView;\r\n\r\n    @Override\r\n    public IBinder onBind(Intent intent) {\r\n        return null;\r\n    }\r\n\r\n    @Override\r\n    public void onCreate() {\r\n        super.onCreate();\r\n        mFloatingWidgetView = LayoutInflater.from(this).inflate(R.layout.floating_widget_layout, null);\r\n\r\n        // Inicializace tlač&#237;tka\r\n        Button button = mFloatingWidgetView.findViewById(R.id.floating_button);\r\n        button.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n              \r\n                showTextDialog();\r\n            }\r\n        });\r\n\r\n        // Inicializace WindowManager\r\n        mWindowManager = (WindowManager) getSystemService(WINDOW_SERVICE);\r\n        WindowManager.LayoutParams params = new WindowManager.LayoutParams(\r\n                WindowManager.LayoutParams.WRAP_CONTENT,\r\n                WindowManager.LayoutParams.WRAP_CONTENT,\r\n                WindowManager.LayoutParams.TYPE_APPLICATION_OVERLAY, \r\n                WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE,\r\n                PixelFormat.TRANSLUCENT\r\n        );\r\n\r\n        params.gravity = Gravity.BOTTOM | Gravity.END;\r\n        mWindowManager.addView(mFloatingWidgetView, params);\r\n    }\r\n\r\n    @Override\r\n    public void onDestroy() {\r\n        super.onDestroy();\r\n        if (mFloatingWidgetView != null &amp;&amp; mWindowManager != null) {\r\n            mWindowManager.removeView(mFloatingWidgetView);\r\n        }\r\n    }\r\n\r\n    private void showTextDialog() {\r\n\r\n    }\r\n}\r\n``` \r\n\r\nactivity_main.xml\r\n```xml\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\r\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;\r\n    android:layout_width=&quot;match_parent&quot;\r\n    android:layout_height=&quot;match_parent&quot;\r\n    tools:context=&quot;.MainActivity&quot;&gt;\r\n\r\n    &lt;TextView\r\n        android:layout_width=&quot;wrap_content&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:text=&quot;Hello World!&quot;\r\n        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;\r\n        app:layout_constraintEnd_toEndOf=&quot;parent&quot;\r\n        app:layout_constraintStart_toStartOf=&quot;parent&quot;\r\n        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\r\n\r\n    &lt;Button\r\n        android:id=&quot;@+id/start_button&quot;\r\n        android:layout_width=&quot;wrap_content&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:text=&quot;Start Floating Widget Service&quot; /&gt;\r\n\r\n&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;\r\n```\r\n\r\nfloating_widget_layout.xml\r\n```xml\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    android:layout_width=&quot;wrap_content&quot;\r\n    android:layout_height=&quot;wrap_content&quot;\r\n    android:orientation=&quot;vertical&quot;&gt;\r\n\r\n    &lt;Button\r\n        android:id=&quot;@+id/floating_button&quot;\r\n        android:layout_width=&quot;wrap_content&quot;\r\n        android:layout_height=&quot;wrap_content&quot;\r\n        android:text=&quot;dfdsfdasdfasdfAFASD&quot;\r\n        android:layout_gravity=&quot;end&quot;\r\n        android:background=&quot;@android:color/holo_red_light&quot;/&gt;\r\n\r\n&lt;/LinearLayout&gt;\r\n```\r\n\r\nAndroidManifest.xml\r\n```xml\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\r\n\r\n    &lt;uses-permission android:name=&quot;android.permission.SYSTEM_ALERT_WINDOW&quot;/&gt;\r\n\r\n    &lt;application\r\n        android:allowBackup=&quot;true&quot;\r\n        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;\r\n        android:fullBackupContent=&quot;@xml/backup_rules&quot;\r\n        android:icon=&quot;@mipmap/ic_launcher&quot;\r\n        android:label=&quot;@string/app_name&quot;\r\n        android:supportsRtl=&quot;true&quot;\r\n        android:theme=&quot;@style/Theme.Mywidget&quot;\r\n        tools:targetApi=&quot;31&quot;&gt;\r\n        &lt;activity\r\n            android:name=&quot;.MainActivity&quot;\r\n            android:exported=&quot;true&quot;&gt;\r\n            &lt;intent-filter&gt;\r\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\r\n\r\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\r\n            &lt;/intent-filter&gt;\r\n        &lt;/activity&gt;\r\n    &lt;/application&gt;\r\n\r\n&lt;/manifest&gt;\r\n```","title":"Why floating widget overlay button is not visible and code is without error?","body":"<p>I tried to make floating widget overlay button - like messenger profile photo widget, which is displayed when someone send you message. I used these files. When I run program, there is nothing invalid in code. I see app with button but there is nothing visible after click.</p>\n<p>MainActivity.java:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.mywidget;\n\nimport android.app.Activity;\nimport android.os.Bundle;\nimport android.view.View;\nimport android.content.Intent;\nimport android.os.Bundle;\nimport android.view.View;\nimport androidx.appcompat.app.AppCompatActivity;\n\npublic class MainActivity extends Activity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        startFloatingWidgetService();\n\n    };\n\n    private void startFloatingWidgetService() {\n        Intent intent = new Intent(this, FloatingWidgetService.class);\n        startService(intent);\n    }\n};\n</code></pre>\n<p>FloatingWidgetService.java</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.mywidget; \n\nimport android.app.Service;\nimport android.content.Intent;\nimport android.graphics.PixelFormat;\nimport android.os.IBinder;\nimport android.view.Gravity;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.WindowManager;\nimport android.widget.Button;\nimport android.widget.LinearLayout;\n\npublic class FloatingWidgetService extends Service {\n\n    private WindowManager mWindowManager;\n    private View mFloatingWidgetView;\n\n    @Override\n    public IBinder onBind(Intent intent) {\n        return null;\n    }\n\n    @Override\n    public void onCreate() {\n        super.onCreate();\n        mFloatingWidgetView = LayoutInflater.from(this).inflate(R.layout.floating_widget_layout, null);\n\n        // Inicializace tlačítka\n        Button button = mFloatingWidgetView.findViewById(R.id.floating_button);\n        button.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n              \n                showTextDialog();\n            }\n        });\n\n        // Inicializace WindowManager\n        mWindowManager = (WindowManager) getSystemService(WINDOW_SERVICE);\n        WindowManager.LayoutParams params = new WindowManager.LayoutParams(\n                WindowManager.LayoutParams.WRAP_CONTENT,\n                WindowManager.LayoutParams.WRAP_CONTENT,\n                WindowManager.LayoutParams.TYPE_APPLICATION_OVERLAY, \n                WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE,\n                PixelFormat.TRANSLUCENT\n        );\n\n        params.gravity = Gravity.BOTTOM | Gravity.END;\n        mWindowManager.addView(mFloatingWidgetView, params);\n    }\n\n    @Override\n    public void onDestroy() {\n        super.onDestroy();\n        if (mFloatingWidgetView != null &amp;&amp; mWindowManager != null) {\n            mWindowManager.removeView(mFloatingWidgetView);\n        }\n    }\n\n    private void showTextDialog() {\n\n    }\n}\n</code></pre>\n<p>activity_main.xml</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    tools:context=&quot;.MainActivity&quot;&gt;\n\n    &lt;TextView\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:text=&quot;Hello World!&quot;\n        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;\n        app:layout_constraintEnd_toEndOf=&quot;parent&quot;\n        app:layout_constraintStart_toStartOf=&quot;parent&quot;\n        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\n\n    &lt;Button\n        android:id=&quot;@+id/start_button&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:text=&quot;Start Floating Widget Service&quot; /&gt;\n\n&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;\n</code></pre>\n<p>floating_widget_layout.xml</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    android:layout_width=&quot;wrap_content&quot;\n    android:layout_height=&quot;wrap_content&quot;\n    android:orientation=&quot;vertical&quot;&gt;\n\n    &lt;Button\n        android:id=&quot;@+id/floating_button&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:text=&quot;dfdsfdasdfasdfAFASD&quot;\n        android:layout_gravity=&quot;end&quot;\n        android:background=&quot;@android:color/holo_red_light&quot;/&gt;\n\n&lt;/LinearLayout&gt;\n</code></pre>\n<p>AndroidManifest.xml</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\n\n    &lt;uses-permission android:name=&quot;android.permission.SYSTEM_ALERT_WINDOW&quot;/&gt;\n\n    &lt;application\n        android:allowBackup=&quot;true&quot;\n        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;\n        android:fullBackupContent=&quot;@xml/backup_rules&quot;\n        android:icon=&quot;@mipmap/ic_launcher&quot;\n        android:label=&quot;@string/app_name&quot;\n        android:supportsRtl=&quot;true&quot;\n        android:theme=&quot;@style/Theme.Mywidget&quot;\n        tools:targetApi=&quot;31&quot;&gt;\n        &lt;activity\n            android:name=&quot;.MainActivity&quot;\n            android:exported=&quot;true&quot;&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\n\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/activity&gt;\n    &lt;/application&gt;\n\n&lt;/manifest&gt;\n</code></pre>\n"},{"tags":["java","google-books"],"answers":[{"comments":[{"owner":{"account_id":1632544,"reputation":420,"user_id":1506811,"accept_rate":40,"display_name":"Anton  Zimm"},"score":0,"creation_date":1559677930,"post_id":49111250,"comment_id":99494182,"body_markdown":"Thank you a lot. You are right, in Belarus we have api don&#39;t work at all. VPN solve the problem.","body":"Thank you a lot. You are right, in Belarus we have api don&#39;t work at all. VPN solve the problem."}],"tags":[],"owner":{"account_id":8017240,"reputation":68,"user_id":6047091,"display_name":"Victoria K"},"comment_count":1,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1520255389,"creation_date":1520255389,"answer_id":49111250,"question_id":48886400,"body_markdown":"As I&#39;ve understood, the problem is in my country(Belarus). Looks like Google Books APi doesn&#39;t work in Belarus. Problem can be fixed by using VPN.","title":"Google books api always returns nothing","body":"<p>As I've understood, the problem is in my country(Belarus). Looks like Google Books APi doesn't work in Belarus. Problem can be fixed by using VPN.</p>\n"}],"owner":{"account_id":8017240,"reputation":68,"user_id":6047091,"display_name":"Victoria K"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1045,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":49111250,"answer_count":1,"score":0,"last_activity_date":1694337371,"creation_date":1519133272,"question_id":48886400,"body_markdown":"I am trying to use Google books API but for any request I receive `totalItems = 0`.\r\n\r\nI&#39;ve tried to send the request in chrome, for example: \r\n\r\n&gt; https://www.googleapis.com/books/v1/volumes?q=flowers+inauthor:keyes&amp;key=MY_KEY\r\n\r\nAlso I&#39;ve tried the approach, described here:\r\n\r\nhttps://github.com/google/google-api-java-client-samples/blob/master/books-cmdline-sample/src/main/java/com/google/api/services/samples/books/cmdline/BooksSample.java\r\n\r\n\r\nAnd for any query with any parameters I always receive nothing:\r\n\r\n    {\r\n     &quot;kind&quot;: &quot;books#volumes&quot;,\r\n     &quot;totalItems&quot;: 0\r\n    }\r\n\r\nI generated key using developer console: https://console.developers.google.com and selected option Api Key.\r\n\r\n\r\n","title":"Google books api always returns nothing","body":"<p>I am trying to use Google books API but for any request I receive <code>totalItems = 0</code>.</p>\n<p>I've tried to send the request in chrome, for example:</p>\n<blockquote>\n<p><a href=\"https://www.googleapis.com/books/v1/volumes?q=flowers+inauthor:keyes&amp;key=MY_KEY\" rel=\"nofollow noreferrer\">https://www.googleapis.com/books/v1/volumes?q=flowers+inauthor:keyes&amp;key=MY_KEY</a></p>\n</blockquote>\n<p>Also I've tried the approach, described here:</p>\n<p><a href=\"https://github.com/google/google-api-java-client-samples/blob/master/books-cmdline-sample/src/main/java/com/google/api/services/samples/books/cmdline/BooksSample.java\" rel=\"nofollow noreferrer\">https://github.com/google/google-api-java-client-samples/blob/master/books-cmdline-sample/src/main/java/com/google/api/services/samples/books/cmdline/BooksSample.java</a></p>\n<p>And for any query with any parameters I always receive nothing:</p>\n<pre><code>{\n &quot;kind&quot;: &quot;books#volumes&quot;,\n &quot;totalItems&quot;: 0\n}\n</code></pre>\n<p>I generated key using developer console: <a href=\"https://console.developers.google.com\" rel=\"nofollow noreferrer\">https://console.developers.google.com</a> and selected option Api Key.</p>\n"},{"tags":["java","frequency"],"comments":[{"owner":{"account_id":4819600,"reputation":56500,"user_id":3890632,"display_name":"khelwood"},"score":0,"creation_date":1658998768,"post_id":73149937,"comment_id":129192758,"body_markdown":"When word `i` is the same as word `j`, you increment `frequency[i]`. What about `frequency[j]`?","body":"When word <code>i</code> is the same as word <code>j</code>, you increment <code>frequency[i]</code>. What about <code>frequency[j]</code>?"}],"answers":[{"tags":[],"owner":{"account_id":15572374,"reputation":108,"user_id":12490479,"display_name":"Woutenator"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1658999592,"creation_date":1658999592,"answer_id":73150202,"question_id":73149937,"body_markdown":"I would use a Map for this. A map can be used to store a value for a given key. You can use your words as keys and their counts as values. Using a Map makes your code easier to understand, shorter, and less prone to errors. For example:\r\n\r\n    import java.util.Scanner;\r\n    import java.util.Map;\r\n    import java.util.HashMap;\r\n\r\n    public class MyClass {\r\n        public static void main(String args[]) {\r\n            HashMap&lt;String, Integer&gt; frequencies = new HashMap&lt;&gt;();\r\n            Scanner s = new Scanner(System.in);\r\n    \r\n            int wordCount = s.nextInt();\r\n      \r\n            for (int i = 0; i &lt; wordCount; ++i) {\r\n                String word = s.next();\r\n                int count = frequencies.getOrDefault(word, 0);\r\n                frequencies.put(word, count + 1);\r\n            }\r\n      \r\n            for (Map.Entry&lt;String, Integer&gt; item : frequencies.entrySet()) {\r\n                System.out.println(item.getKey() + &quot;: &quot; + item.getValue());\r\n            }\r\n        }\r\n    }","title":"Word frequencies","body":"<p>I would use a Map for this. A map can be used to store a value for a given key. You can use your words as keys and their counts as values. Using a Map makes your code easier to understand, shorter, and less prone to errors. For example:</p>\n<pre><code>import java.util.Scanner;\nimport java.util.Map;\nimport java.util.HashMap;\n\npublic class MyClass {\n    public static void main(String args[]) {\n        HashMap&lt;String, Integer&gt; frequencies = new HashMap&lt;&gt;();\n        Scanner s = new Scanner(System.in);\n\n        int wordCount = s.nextInt();\n  \n        for (int i = 0; i &lt; wordCount; ++i) {\n            String word = s.next();\n            int count = frequencies.getOrDefault(word, 0);\n            frequencies.put(word, count + 1);\n        }\n  \n        for (Map.Entry&lt;String, Integer&gt; item : frequencies.entrySet()) {\n            System.out.println(item.getKey() + &quot;: &quot; + item.getValue());\n        }\n    }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":2671330,"reputation":183386,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":3,"creation_date":1658999799,"post_id":73150236,"comment_id":129193158,"body_markdown":"Tip: `s-&gt;s` can be replaced with `Function.identity()`","body":"Tip: <code>s-&gt;s</code> can be replaced with <code>Function.identity()</code>"}],"tags":[],"owner":{"account_id":2777627,"reputation":775,"user_id":2390877,"accept_rate":60,"display_name":"Yves V."},"comment_count":1,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1658999709,"creation_date":1658999709,"answer_id":73150236,"question_id":73149937,"body_markdown":"For such a scenario you, either use a Map, where you keep the frequency for each word, or you can even do it with a stream and a group by. You don&#39;t even need to know the number of words in advance, assuming you simply split them by a space.\r\n\r\nWith a stream it&#39;s basically a oneliner:\r\n\r\n```\r\nString input = &quot;pickle test rick Pickle test pickle&quot;;\r\n// With a stream:\r\nMap&lt;String, Long&gt; result = Arrays.stream(input.split(&quot; &quot;)).collect(Collectors.groupingBy(s-&gt;s, Collectors.counting()));\r\n```\r\n\r\nThe map contains:\r\n```\r\n{Pickle=1, test=2, rick=1, pickle=2}\r\n```\r\n\r\nIf you don&#39;t like streams, simply iterate manually over the words, and increment the value of the word (which is used as key in your map).","title":"Word frequencies","body":"<p>For such a scenario you, either use a Map, where you keep the frequency for each word, or you can even do it with a stream and a group by. You don't even need to know the number of words in advance, assuming you simply split them by a space.</p>\n<p>With a stream it's basically a oneliner:</p>\n<pre><code>String input = &quot;pickle test rick Pickle test pickle&quot;;\n// With a stream:\nMap&lt;String, Long&gt; result = Arrays.stream(input.split(&quot; &quot;)).collect(Collectors.groupingBy(s-&gt;s, Collectors.counting()));\n</code></pre>\n<p>The map contains:</p>\n<pre><code>{Pickle=1, test=2, rick=1, pickle=2}\n</code></pre>\n<p>If you don't like streams, simply iterate manually over the words, and increment the value of the word (which is used as key in your map).</p>\n"},{"tags":[],"owner":{"account_id":1671119,"reputation":1077,"user_id":1537580,"accept_rate":62,"display_name":"FrancescoDS"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1659000941,"creation_date":1659000941,"answer_id":73150516,"question_id":73149937,"body_markdown":"the problem is in this instruction:\r\n\r\n    if (wordsList[i].equals(wordsList[j]))\r\n\r\n`wordsList[j]` is null if j &gt; i. This happens because you scan the words in external for, so in the inner for you don&#39;t know the words at indexes &gt; i. \r\n\r\nBecause of that, when you perform the comparison, the second word results as null for indexes j &gt; i.\r\n\r\n\r\n   ","title":"Word frequencies","body":"<p>the problem is in this instruction:</p>\n<pre><code>if (wordsList[i].equals(wordsList[j]))\n</code></pre>\n<p><code>wordsList[j]</code> is null if j &gt; i. This happens because you scan the words in external for, so in the inner for you don't know the words at indexes &gt; i.</p>\n<p>Because of that, when you perform the comparison, the second word results as null for indexes j &gt; i.</p>\n"},{"tags":[],"owner":{"account_id":23959668,"reputation":26587,"user_id":17949945,"display_name":"Alexander Ivanchenko"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1659006750,"creation_date":1659002561,"answer_id":73150930,"question_id":73149937,"body_markdown":"Creating a `HashMap` containing frequencies of each word is the most performant approach.\r\n\r\nOne of the ways to do it is by using method [`merge()`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html#merge(K,V,java.util.function.BiFunction)), that was introduced in the `Map` interface with Java 8. It expects three arguments: a *key*, a *value* to be associated with that *key* (if it was not present in the map) and a *function* that would be evaluated if the already exists, and we need to merge the previous value and a new one.\r\n\r\n    public static void main(String[] args) {\r\n        Scanner scanner = new Scanner(System.in);\r\n        int numberWords = scanner.nextInt();\r\n        \r\n        Map&lt;String, Integer&gt; frequencies = new HashMap&lt;&gt;();\r\n        for (int i = 0; i &lt; numberWords; i++) {\r\n            frequencies.merge(scanner.next(), 1, Integer::sum);\r\n        }\r\n        \r\n        frequencies.forEach((k, v) -&gt; System.out.println(k + &quot; -&gt; &quot; + v));\r\n    }\r\n\r\n*Output:*\r\n```\r\nPickle -&gt; 1\r\ntest -&gt; 2\r\nrick -&gt; 1\r\npickle -&gt; 2\r\n```\r\n\r\nIn case if you&#39;re comfortable with Stream API, you can approach this problem using built-in *collector* [`toMap()`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/stream/Collectors.html#toMap(java.util.function.Function,java.util.function.Function,java.util.function.BinaryOperator)) (***note*** that we can read the input directly from the stream):\r\n\r\n    public static void main(String[] args) {\r\n        Scanner scanner = new Scanner(System.in);\r\n        \r\n        Map&lt;String, Integer&gt; frequencies = IntStream.range(0,scanner.nextInt())\r\n            .mapToObj(i -&gt; scanner.next())\r\n            .collect(Collectors.toMap(\r\n                Function.identity(),\r\n                i -&gt; 1,\r\n                Integer::sum\r\n            ));\r\n        \r\n        frequencies.forEach((k, v) -&gt; System.out.println(k + &quot; -&gt; &quot; + v));\r\n    }\r\n\r\n*Output:*\r\n```\r\nPickle -&gt; 1\r\ntest -&gt; 2\r\nrick -&gt; 1\r\npickle -&gt; 2\r\n```","title":"Word frequencies","body":"<p>Creating a <code>HashMap</code> containing frequencies of each word is the most performant approach.</p>\n<p>One of the ways to do it is by using method <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html#merge(K,V,java.util.function.BiFunction)\" rel=\"nofollow noreferrer\"><code>merge()</code></a>, that was introduced in the <code>Map</code> interface with Java 8. It expects three arguments: a <em>key</em>, a <em>value</em> to be associated with that <em>key</em> (if it was not present in the map) and a <em>function</em> that would be evaluated if the already exists, and we need to merge the previous value and a new one.</p>\n<pre><code>public static void main(String[] args) {\n    Scanner scanner = new Scanner(System.in);\n    int numberWords = scanner.nextInt();\n    \n    Map&lt;String, Integer&gt; frequencies = new HashMap&lt;&gt;();\n    for (int i = 0; i &lt; numberWords; i++) {\n        frequencies.merge(scanner.next(), 1, Integer::sum);\n    }\n    \n    frequencies.forEach((k, v) -&gt; System.out.println(k + &quot; -&gt; &quot; + v));\n}\n</code></pre>\n<p><em>Output:</em></p>\n<pre><code>Pickle -&gt; 1\ntest -&gt; 2\nrick -&gt; 1\npickle -&gt; 2\n</code></pre>\n<p>In case if you're comfortable with Stream API, you can approach this problem using built-in <em>collector</em> <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/stream/Collectors.html#toMap(java.util.function.Function,java.util.function.Function,java.util.function.BinaryOperator)\" rel=\"nofollow noreferrer\"><code>toMap()</code></a> (<em><strong>note</strong></em> that we can read the input directly from the stream):</p>\n<pre><code>public static void main(String[] args) {\n    Scanner scanner = new Scanner(System.in);\n    \n    Map&lt;String, Integer&gt; frequencies = IntStream.range(0,scanner.nextInt())\n        .mapToObj(i -&gt; scanner.next())\n        .collect(Collectors.toMap(\n            Function.identity(),\n            i -&gt; 1,\n            Integer::sum\n        ));\n    \n    frequencies.forEach((k, v) -&gt; System.out.println(k + &quot; -&gt; &quot; + v));\n}\n</code></pre>\n<p><em>Output:</em></p>\n<pre><code>Pickle -&gt; 1\ntest -&gt; 2\nrick -&gt; 1\npickle -&gt; 2\n</code></pre>\n"},{"tags":[],"owner":{"account_id":27020925,"reputation":1,"user_id":20578920,"display_name":"Dan"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1669184404,"creation_date":1669184404,"answer_id":74542532,"question_id":73149937,"body_markdown":"I used another string variable I named currWord to hold the values in wordsList[i] and then compared currWord to wordsList[j]. Here is the code:\r\n\r\n```\r\nimport java.util.Scanner; \r\n\r\npublic class LabProgram {\r\n    public static void main(String[] args) {\r\n        Scanner scnr = new Scanner(System.in);\r\n        String [] userString = new String[20];\r\n        int [] wordFreq = new int[20];\r\n        String currWord;\r\n        int stringLength;\r\n        int i;\r\n        int j;\r\n      \r\n        stringLength = scnr.nextInt();\r\n        userString = new String[stringLength];\r\n        wordFreq = new int[stringLength];\r\n      \r\n        for (i = 0; i &lt; stringLength; ++i) {\r\n            userString[i] = scnr.next();\r\n            wordFreq[i] = 0;\r\n        }\r\n      \r\n        for (i = 0; i &lt; stringLength; ++i) {\r\n            currWord = userString[i];\r\n            for (j = 0; j &lt; stringLength; ++j) {\r\n                if (userString[j].compareTo(currWord) == 0) {\r\n                wordFreq[i] = wordFreq[i] + 1;\r\n                }\r\n            }\r\n        }\r\n         \r\n        for (i = 0; i &lt; stringLength; ++i) {\r\n            System.out.println(userString[i] + &quot; - &quot; + wordFreq[i]);\r\n        }\r\n    }\r\n}\r\n```\r\n","title":"Word frequencies","body":"<p>I used another string variable I named currWord to hold the values in wordsList[i] and then compared currWord to wordsList[j]. Here is the code:</p>\n<pre><code>import java.util.Scanner; \n\npublic class LabProgram {\n    public static void main(String[] args) {\n        Scanner scnr = new Scanner(System.in);\n        String [] userString = new String[20];\n        int [] wordFreq = new int[20];\n        String currWord;\n        int stringLength;\n        int i;\n        int j;\n      \n        stringLength = scnr.nextInt();\n        userString = new String[stringLength];\n        wordFreq = new int[stringLength];\n      \n        for (i = 0; i &lt; stringLength; ++i) {\n            userString[i] = scnr.next();\n            wordFreq[i] = 0;\n        }\n      \n        for (i = 0; i &lt; stringLength; ++i) {\n            currWord = userString[i];\n            for (j = 0; j &lt; stringLength; ++j) {\n                if (userString[j].compareTo(currWord) == 0) {\n                wordFreq[i] = wordFreq[i] + 1;\n                }\n            }\n        }\n         \n        for (i = 0; i &lt; stringLength; ++i) {\n            System.out.println(userString[i] + &quot; - &quot; + wordFreq[i]);\n        }\n    }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":29370428,"reputation":1,"user_id":22503172,"display_name":"Michael Ojoko"},"score":0,"creation_date":1693912232,"post_id":77043972,"comment_id":135819004,"body_markdown":"You do not want to the loop you are getting the user input from in the same loop you are checking the values. Instead create two sperate loops. Also initializing your frequency array with 0 inside your loop may also cause problems.","body":"You do not want to the loop you are getting the user input from in the same loop you are checking the values. Instead create two sperate loops. Also initializing your frequency array with 0 inside your loop may also cause problems."},{"owner":{"account_id":18999437,"reputation":2461,"user_id":13867124,"display_name":"AztecCodes"},"score":0,"creation_date":1693961348,"post_id":77043972,"comment_id":135827697,"body_markdown":"This code snippet appears to read input, tally word occurrences in an array, and display the results. However, it could be improved by adding explanations for better understanding.","body":"This code snippet appears to read input, tally word occurrences in an array, and display the results. However, it could be improved by adding explanations for better understanding."},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1693961357,"post_id":77043972,"comment_id":135827699,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/77043972/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":29370428,"reputation":1,"user_id":22503172,"display_name":"Michael Ojoko"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694337228,"creation_date":1693911811,"answer_id":77043972,"question_id":73149937,"body_markdown":"``` \r\nimport java.util.Scanner; \r\n\r\npublic class LabProgram {\r\n   public static void main(String[] args) {\r\n      Scanner scnr = new Scanner(System.in);\r\n      // length of the array\r\n      int numWords = scnr.nextInt();\r\n\r\n      // array containing the string of words later to be set by the user.\r\n      String[] wordsList = new String[numWords];\r\n\r\n      int i;\r\n      int j;\r\n\r\n      // array to tally the number of occurrences of a given word.\r\n      int[] numOccur = new int[numWords];\r\n      \r\n      // Use input from user and assign it with values in array.\r\n      for (i = 0; i &lt; numWords; ++i) {\r\n         wordsList[i] = scnr.next();\r\n      }\r\n\r\n      // nested for loop. to check matching values in array.\r\n      // if value is found the occurrence array at the same index of the matching string is incremented.  \r\n      for (i = 0; i &lt; numWords; ++i) {\r\n         for (j = 0; j &lt; numWords; ++j) {\r\n            if (wordsList[i].equals(wordsList[j])) {\r\n               numOccur[i]++;\r\n            }\r\n         }\r\n      }\r\n\r\n      // this prints the string element and its corresponding value in the occurrences array. \r\n      for (i = 0; i &lt; numWords; ++i) {\r\n         System.out.println(wordsList[i] + &quot; - &quot; + numOccur[i]);\r\n      }\r\n      \r\n   }\r\n} \r\n```\r\n","title":"Word frequencies","body":"<pre><code>import java.util.Scanner; \n\npublic class LabProgram {\n   public static void main(String[] args) {\n      Scanner scnr = new Scanner(System.in);\n      // length of the array\n      int numWords = scnr.nextInt();\n\n      // array containing the string of words later to be set by the user.\n      String[] wordsList = new String[numWords];\n\n      int i;\n      int j;\n\n      // array to tally the number of occurrences of a given word.\n      int[] numOccur = new int[numWords];\n      \n      // Use input from user and assign it with values in array.\n      for (i = 0; i &lt; numWords; ++i) {\n         wordsList[i] = scnr.next();\n      }\n\n      // nested for loop. to check matching values in array.\n      // if value is found the occurrence array at the same index of the matching string is incremented.  \n      for (i = 0; i &lt; numWords; ++i) {\n         for (j = 0; j &lt; numWords; ++j) {\n            if (wordsList[i].equals(wordsList[j])) {\n               numOccur[i]++;\n            }\n         }\n      }\n\n      // this prints the string element and its corresponding value in the occurrences array. \n      for (i = 0; i &lt; numWords; ++i) {\n         System.out.println(wordsList[i] + &quot; - &quot; + numOccur[i]);\n      }\n      \n   }\n} \n</code></pre>\n"}],"owner":{"account_id":25915340,"reputation":1,"user_id":19638813,"display_name":"redbull_luvr"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3749,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":6,"score":0,"last_activity_date":1694337228,"creation_date":1658998466,"question_id":73149937,"body_markdown":"I&#39;m writing a Java program that calculates the frequencies of words in an input. The initial integer indicates how many words will follow. Here is my code so far:\r\n\r\n```\r\nimport java.util.Scanner; \r\npublic class LabProgram {\r\n   public static void main(String[] args) {\r\n\r\n      Scanner scnr = new Scanner(System.in);\r\n      int numberWords = scnr.nextInt();\r\n      String[] wordsList = new String[numberWords];\r\n      int i;\r\n      int j;\r\n      int[] frequency = new int[numberWords];\r\n      \r\n\r\n      for (i = 0; i &lt; numberWords; ++i) {\r\n         wordsList[i] = scnr.next();\r\n         frequency[i] = 0;\r\n         for (j = 0; j &lt; numberWords; ++j) {\r\n            if (wordsList[i].equals(wordsList[j])) {\r\n               frequency[i] = frequency[i] + 1;\r\n            }\r\n         }\r\n      }\r\n      for (i = 0; i &lt; numberWords; ++i) {\r\n         System.out.print(wordsList[i] + &quot; - &quot; + frequency[i]);\r\n         System.out.print(&quot;\\n&quot;);\r\n      }\r\n      \r\n   }\r\n}\r\n```\r\nWhen I input the following:\r\n```none\r\n6 pickle test rick Pickle test pickle\r\n```\r\nThis is the output:\r\n```none\r\npickle - 1\r\ntest - 1\r\nrick - 1\r\nPickle - 1\r\ntest - 2\r\npickle - 2\r\n```\r\nHowever, this is the expected output:\r\n```none\r\npickle - 2\r\ntest - 2\r\nrick - 1\r\nPickle - 1\r\ntest - 2\r\npickle - 2\r\n```\r\nIt looks like it&#39;s picking up the correct frequencies for later occurrences, but not for the initial occurrences.","title":"Word frequencies","body":"<p>I'm writing a Java program that calculates the frequencies of words in an input. The initial integer indicates how many words will follow. Here is my code so far:</p>\n<pre><code>import java.util.Scanner; \npublic class LabProgram {\n   public static void main(String[] args) {\n\n      Scanner scnr = new Scanner(System.in);\n      int numberWords = scnr.nextInt();\n      String[] wordsList = new String[numberWords];\n      int i;\n      int j;\n      int[] frequency = new int[numberWords];\n      \n\n      for (i = 0; i &lt; numberWords; ++i) {\n         wordsList[i] = scnr.next();\n         frequency[i] = 0;\n         for (j = 0; j &lt; numberWords; ++j) {\n            if (wordsList[i].equals(wordsList[j])) {\n               frequency[i] = frequency[i] + 1;\n            }\n         }\n      }\n      for (i = 0; i &lt; numberWords; ++i) {\n         System.out.print(wordsList[i] + &quot; - &quot; + frequency[i]);\n         System.out.print(&quot;\\n&quot;);\n      }\n      \n   }\n}\n</code></pre>\n<p>When I input the following:</p>\n<pre class=\"lang-none prettyprint-override\"><code>6 pickle test rick Pickle test pickle\n</code></pre>\n<p>This is the output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>pickle - 1\ntest - 1\nrick - 1\nPickle - 1\ntest - 2\npickle - 2\n</code></pre>\n<p>However, this is the expected output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>pickle - 2\ntest - 2\nrick - 1\nPickle - 1\ntest - 2\npickle - 2\n</code></pre>\n<p>It looks like it's picking up the correct frequencies for later occurrences, but not for the initial occurrences.</p>\n"},{"tags":["java","git","eclipse","egit"],"comments":[{"owner":{"account_id":4459325,"reputation":1497,"user_id":3628679,"display_name":"Alex"},"score":0,"creation_date":1694374955,"post_id":77075401,"comment_id":135879485,"body_markdown":"It seems the logic of the UI changed from the Eclipse version I was used to?! Whenever I edit a file, it shows up in the lower Staged window. However, ifI  then commit, the Staged window is not cleared, but all the files are still in Staged. I don&#39;t get this. Any guidance?","body":"It seems the logic of the UI changed from the Eclipse version I was used to?! Whenever I edit a file, it shows up in the lower Staged window. However, ifI  then commit, the Staged window is not cleared, but all the files are still in Staged. I don&#39;t get this. Any guidance?"},{"owner":{"account_id":4459325,"reputation":1497,"user_id":3628679,"display_name":"Alex"},"score":0,"creation_date":1694375286,"post_id":77075401,"comment_id":135879508,"body_markdown":"Is the issue maybe related to the  &quot;Unborn branch: This commit will create the branch master&quot; ? Although the message doesn&#39;t disappear after I commit.","body":"Is the issue maybe related to the  &quot;Unborn branch: This commit will create the branch master&quot; ? Although the message doesn&#39;t disappear after I commit."}],"owner":{"account_id":4459325,"reputation":1497,"user_id":3628679,"display_name":"Alex"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":38,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694335958,"creation_date":1694335958,"question_id":77075401,"body_markdown":"I had a project in Eclipse, version controled in a local file system git repository. Because of other problems, I had to re-install Eclipse and took the opportunity to install the latest Eclipse update, Version: 2023-06 (4.28.0). Then, I &quot;re-installed&quot; the project in Eclipse. This project resides in the workspace directory of Eclipse. Before putting this project under git control again, I migrated the project to java modules. Next, I deleted the former project git directory in the git root directory in the file system. The git root directory and the Eclipse workspace directory are on the same level my users home directory.\r\nSo in the Eclipse Java view, I right clicked the project and selected Teams -&gt; Share project. In the dialog I created a new git project at the same old git root location, having the same name as the old previous project.\r\n\r\nIn the Java view the project has now the git master tag.\r\n\r\n[![enter image description here][1]][1]. \r\n\r\nWhen I now go to the Git Staging tab, irrespective of whether I do this in the git- or the Java view, I see as expected all the files of the project in the &quot;Unstaged Changes&quot; window. But clicking the double green plus icon, the single green cross icon, trying to move the files with drag and drop into the Staged Changes window, right click a file and select &quot;Add to index&quot; - nothing moves the files from Unstaged to Stage. Git remains stubborn and the  Commit button disabled.\r\n\r\n[![enter image description here][2]][2]\r\n\r\nOn the file system all files were copied to the git project directory. I guess this is the base for the Unstaged file list.\r\n\r\nI also don&#39;t see any kind of git error message. Is there a log file, and if so where? Maybe there is somewhere a git configuration file that is outdated and mixing up with my old and my new setup?!\r\n\r\nThe Git setup in Eclipse is:\r\n\r\n[![enter image description here][3]][3]\r\n\r\nPlease let me know if you need further information. Thank you in advance.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/LZmGm.png\r\n  [2]: https://i.stack.imgur.com/wj6c5.png\r\n  [3]: https://i.stack.imgur.com/TLWtB.png","title":"Can&#39;t stage new project in Eclipse git","body":"<p>I had a project in Eclipse, version controled in a local file system git repository. Because of other problems, I had to re-install Eclipse and took the opportunity to install the latest Eclipse update, Version: 2023-06 (4.28.0). Then, I &quot;re-installed&quot; the project in Eclipse. This project resides in the workspace directory of Eclipse. Before putting this project under git control again, I migrated the project to java modules. Next, I deleted the former project git directory in the git root directory in the file system. The git root directory and the Eclipse workspace directory are on the same level my users home directory.\nSo in the Eclipse Java view, I right clicked the project and selected Teams -&gt; Share project. In the dialog I created a new git project at the same old git root location, having the same name as the old previous project.</p>\n<p>In the Java view the project has now the git master tag.</p>\n<p><a href=\"https://i.stack.imgur.com/LZmGm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LZmGm.png\" alt=\"enter image description here\" /></a>.</p>\n<p>When I now go to the Git Staging tab, irrespective of whether I do this in the git- or the Java view, I see as expected all the files of the project in the &quot;Unstaged Changes&quot; window. But clicking the double green plus icon, the single green cross icon, trying to move the files with drag and drop into the Staged Changes window, right click a file and select &quot;Add to index&quot; - nothing moves the files from Unstaged to Stage. Git remains stubborn and the  Commit button disabled.</p>\n<p><a href=\"https://i.stack.imgur.com/wj6c5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wj6c5.png\" alt=\"enter image description here\" /></a></p>\n<p>On the file system all files were copied to the git project directory. I guess this is the base for the Unstaged file list.</p>\n<p>I also don't see any kind of git error message. Is there a log file, and if so where? Maybe there is somewhere a git configuration file that is outdated and mixing up with my old and my new setup?!</p>\n<p>The Git setup in Eclipse is:</p>\n<p><a href=\"https://i.stack.imgur.com/TLWtB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TLWtB.png\" alt=\"enter image description here\" /></a></p>\n<p>Please let me know if you need further information. Thank you in advance.</p>\n"},{"tags":["java","eclipse","anchor","fill","gridbaglayout"],"comments":[{"owner":{"account_id":969721,"reputation":344527,"user_id":992484,"accept_rate":60,"display_name":"MadProgrammer"},"score":1,"creation_date":1694336342,"post_id":77075398,"comment_id":135875663,"body_markdown":"Try adding `weighty = 1` to the last component (the button)","body":"Try adding <code>weighty = 1</code> to the last component (the button)"},{"owner":{"account_id":26293779,"reputation":1,"user_id":19960387,"display_name":"nour tebbal"},"score":0,"creation_date":1694338081,"post_id":77075398,"comment_id":135875813,"body_markdown":"That solve the problem for all the components but the last one stays at the center vertically, I usually add an invisible useless component at the end and i apply your solution and that solve the problem but I feel like it&#39;s not professionnal, thanx for the answer any way","body":"That solve the problem for all the components but the last one stays at the center vertically, I usually add an invisible useless component at the end and i apply your solution and that solve the problem but I feel like it&#39;s not professionnal, thanx for the answer any way"},{"owner":{"account_id":969721,"reputation":344527,"user_id":992484,"accept_rate":60,"display_name":"MadProgrammer"},"score":0,"creation_date":1694343014,"post_id":77075398,"comment_id":135876290,"body_markdown":"The set it’s anchor to be NORTH or use a “filler” component","body":"The set it’s anchor to be NORTH or use a “filler” component"}],"owner":{"account_id":26293779,"reputation":1,"user_id":19960387,"display_name":"nour tebbal"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":17,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694335931,"creation_date":1694335931,"question_id":77075398,"body_markdown":"I have these components shown on the center vertically, I want to show them on the top of the panel, like it shown in the picture (the yellow arrow).\r\nNB: I tried to set the anchor on &quot;NORTH&quot; and fill to &quot;BOTH&quot; but nothing happened.\r\n\r\n[enter image description here](https://i.stack.imgur.com/4MD7e.jpg)\r\n\r\n```\r\nsetLayout(new GridBagLayout());\r\n\t\tGridBagConstraints gbc = new GridBagConstraints();\r\n\t\tBorder border = BorderFactory.createTitledBorder(null, &quot;Saisie&quot;, TitledBorder.CENTER, TitledBorder.TOP, new Font(&quot;times new roman&quot;,Font.BOLD,14),Color.GRAY);\r\n\t\tsetBorder(border);\r\n\t\t\r\n\t\tgbc.gridx = 0;\r\n\t\tgbc.gridy = 0;\r\n\t\tgbc.gridwidth = 1;\r\n\t\tgbc.gridheight = 1;\r\n\t\tgbc.weightx = 0.;\r\n\t\tgbc.weighty = 0.;\r\n\t\tgbc.fill = GridBagConstraints.NONE;\r\n\t\tgbc.anchor = GridBagConstraints.LINE_END;\r\n\t\tgbc.insets = new Insets(3, 3, 3, 3);\r\n\t\tadd(JLabel_ID, gbc);\r\n\t\t\r\n\t\tgbc.gridx = 1;\r\n\t\tgbc.gridy = 0;\r\n\t\tgbc.gridwidth = 1;\r\n\t\tgbc.gridheight = 1;\r\n\t\tgbc.weightx = 0.;\r\n\t\tgbc.weighty = 0.;\r\n\t\tgbc.fill = GridBagConstraints.HORIZONTAL;\r\n\t\tgbc.anchor = GridBagConstraints.CENTER;\r\n\t\tgbc.insets = new Insets(3, 3, 3, 3);\r\n\t\tadd(JTextField_ID, gbc);\r\n\t\t\r\n\t\tgbc.gridx = 0;\r\n\t\tgbc.gridy = 1;\r\n\t\tgbc.gridwidth = 1;\r\n\t\tgbc.gridheight = 1;\r\n\t\tgbc.weightx = 0.;\r\n\t\tgbc.weighty = 0.;\r\n\t\tgbc.fill = GridBagConstraints.NONE;\r\n\t\tgbc.anchor = GridBagConstraints.LINE_END;\r\n\t\tgbc.insets = new Insets(3, 3, 3, 3);\r\n\t\tadd(JLabel_Nom, gbc);\r\n\t\t\r\n\t\tgbc.gridx = 1;\r\n\t\tgbc.gridy = 1;\r\n\t\tgbc.gridwidth = 1;\r\n\t\tgbc.gridheight = 1;\r\n\t\tgbc.weightx = 0.;\r\n\t\tgbc.weighty = 0.;\r\n\t\tgbc.fill = GridBagConstraints.HORIZONTAL;\r\n\t\tgbc.anchor = GridBagConstraints.CENTER;\r\n\t\tgbc.insets = new Insets(3, 3, 3, 3);\r\n\t\tadd(JTextField_Nom, gbc);\r\n\r\n\t}```\r\n\r\n\r\nI tried to set the anchor on &quot;NORTH&quot; and fill to &quot;BOTH&quot; but nothing happened.","title":"Java component positioning on the top of the GridBagLayout","body":"<p>I have these components shown on the center vertically, I want to show them on the top of the panel, like it shown in the picture (the yellow arrow).\nNB: I tried to set the anchor on &quot;NORTH&quot; and fill to &quot;BOTH&quot; but nothing happened.</p>\n<p><a href=\"https://i.stack.imgur.com/4MD7e.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n<pre><code>setLayout(new GridBagLayout());\n        GridBagConstraints gbc = new GridBagConstraints();\n        Border border = BorderFactory.createTitledBorder(null, &quot;Saisie&quot;, TitledBorder.CENTER, TitledBorder.TOP, new Font(&quot;times new roman&quot;,Font.BOLD,14),Color.GRAY);\n        setBorder(border);\n        \n        gbc.gridx = 0;\n        gbc.gridy = 0;\n        gbc.gridwidth = 1;\n        gbc.gridheight = 1;\n        gbc.weightx = 0.;\n        gbc.weighty = 0.;\n        gbc.fill = GridBagConstraints.NONE;\n        gbc.anchor = GridBagConstraints.LINE_END;\n        gbc.insets = new Insets(3, 3, 3, 3);\n        add(JLabel_ID, gbc);\n        \n        gbc.gridx = 1;\n        gbc.gridy = 0;\n        gbc.gridwidth = 1;\n        gbc.gridheight = 1;\n        gbc.weightx = 0.;\n        gbc.weighty = 0.;\n        gbc.fill = GridBagConstraints.HORIZONTAL;\n        gbc.anchor = GridBagConstraints.CENTER;\n        gbc.insets = new Insets(3, 3, 3, 3);\n        add(JTextField_ID, gbc);\n        \n        gbc.gridx = 0;\n        gbc.gridy = 1;\n        gbc.gridwidth = 1;\n        gbc.gridheight = 1;\n        gbc.weightx = 0.;\n        gbc.weighty = 0.;\n        gbc.fill = GridBagConstraints.NONE;\n        gbc.anchor = GridBagConstraints.LINE_END;\n        gbc.insets = new Insets(3, 3, 3, 3);\n        add(JLabel_Nom, gbc);\n        \n        gbc.gridx = 1;\n        gbc.gridy = 1;\n        gbc.gridwidth = 1;\n        gbc.gridheight = 1;\n        gbc.weightx = 0.;\n        gbc.weighty = 0.;\n        gbc.fill = GridBagConstraints.HORIZONTAL;\n        gbc.anchor = GridBagConstraints.CENTER;\n        gbc.insets = new Insets(3, 3, 3, 3);\n        add(JTextField_Nom, gbc);\n\n    }```\n\n\nI tried to set the anchor on &quot;NORTH&quot; and fill to &quot;BOTH&quot; but nothing happened.\n</code></pre>\n"},{"tags":["java","android","android-mediacodec","mediamuxer"],"answers":[{"comments":[{"owner":{"account_id":29391722,"reputation":13,"user_id":22519909,"display_name":"Lewis Jack"},"score":0,"creation_date":1694397100,"post_id":77075264,"comment_id":135881203,"body_markdown":"Your method is effective, thank you very much","body":"Your method is effective, thank you very much"}],"tags":[],"owner":{"account_id":5376192,"reputation":9447,"user_id":4283005,"display_name":"dev.bmax"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1694333308,"creation_date":1694333308,"answer_id":77075264,"question_id":77063784,"body_markdown":"Timestamps are used to control the playback speed. \r\n\r\nSetting the frame rate is not enough. You need to assign a timestamp to each frame that you write to the output file. \r\n\r\nTry to use the `BufferInfo` object for this:\r\n\r\n    bufferInfo.presentationTimeUs = nextFrameTimeUs();\r\n    mediaMuxer.writeSampleData(videoTrackIndex, encodedData, bufferInfo);\r\n\r\nThe implementation of `nextFrameTimeUs()` is up to you. One way to do it is to map the current frame index to presentation time based on the average frame duration (that you can calculate from the frame rate).\r\n\r\nNote that the presentation time should be given in microseconds (Us).\r\n","title":"Regarding the problem of making the bitmaps image collection of ArrayList&lt;Bitmap&gt; type into a video, the duration of the video is too short","body":"<p>Timestamps are used to control the playback speed.</p>\n<p>Setting the frame rate is not enough. You need to assign a timestamp to each frame that you write to the output file.</p>\n<p>Try to use the <code>BufferInfo</code> object for this:</p>\n<pre><code>bufferInfo.presentationTimeUs = nextFrameTimeUs();\nmediaMuxer.writeSampleData(videoTrackIndex, encodedData, bufferInfo);\n</code></pre>\n<p>The implementation of <code>nextFrameTimeUs()</code> is up to you. One way to do it is to map the current frame index to presentation time based on the average frame duration (that you can calculate from the frame rate).</p>\n<p>Note that the presentation time should be given in microseconds (Us).</p>\n"}],"owner":{"account_id":29391722,"reputation":13,"user_id":22519909,"display_name":"Lewis Jack"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":28,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77075264,"answer_count":1,"score":0,"last_activity_date":1694333308,"creation_date":1694139637,"question_id":77063784,"body_markdown":"There are 300 frames of images in the bitmaps, and the set frame rate is 30, but the video length is only 3 seconds; if there are 600 frames of images, the video length is 6 seconds, etc.;The video can play all content, but the playback rate is faster, at double or triple speed; what is the reason for this? How should it(encodeVideo(ArrayList&lt;Bitmap&gt; bitmaps)) be optimized?\r\n\r\n    private static final String MIME_TYPE = &quot;video/avc&quot;; \r\n    private static final int BIT_RATE = 3000000; \r\n    private static final int FRAME_RATE = 30;\r\n    private static final int I_FRAME_INTERVAL = 10;\r\n\r\n\r\n\r\n    public void encodeVideo(ArrayList&lt;Bitmap&gt; bitmaps) {\r\n        Executor executor = Executors.newSingleThreadExecutor();\r\n        executor.execute(() -&gt; {\r\n            if (bitmaps == null || bitmaps.isEmpty()) {\r\n                return;\r\n            }\r\n\r\n\r\n            try {\r\n                width = bitmaps.get(0).getWidth();\r\n                height = bitmaps.get(0).getHeight();\r\n                String timeStamp = new SimpleDateFormat(&quot;yyyyMMdd_HHmmss&quot;, Locale.getDefault()).format(new Date());\r\n                String fileName1 = &quot;VID_&quot; + timeStamp + &quot;.mp4&quot;;\r\n                outputFile = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM), fileName1);\r\n\r\n                \r\n                MediaFormat format = MediaFormat.createVideoFormat(MIME_TYPE, width, height);\r\n                format.setInteger(MediaFormat.KEY_COLOR_FORMAT, MediaCodecInfo.CodecCapabilities.COLOR_FormatSurface);\r\n                format.setInteger(MediaFormat.KEY_BIT_RATE, BIT_RATE);\r\n                format.setInteger(MediaFormat.KEY_FRAME_RATE, FRAME_RATE);\r\n                format.setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, I_FRAME_INTERVAL);\r\n\r\n                \r\n                mediaCodec = MediaCodec.createEncoderByType(MIME_TYPE);\r\n                mediaCodec.configure(format, null, null, MediaCodec.CONFIGURE_FLAG_ENCODE);\r\n                inputSurface = mediaCodec.createInputSurface();\r\n                mediaCodec.start();\r\n\r\n                \r\n                mediaMuxer = new MediaMuxer(outputFile.getPath(), MediaMuxer.OutputFormat.MUXER_OUTPUT_MPEG_4);\r\n\r\n                for (Bitmap bitmap : bitmaps) {\r\n                    if (Thread.currentThread().isInterrupted()) {\r\n                        return;\r\n                    }\r\n                    \r\n                    Canvas canvas = inputSurface.lockCanvas(null);\r\n                    if (canvas != null) {\r\n                        try {\r\n                            canvas.drawBitmap(bitmap, 0, 0, null);\r\n                        } finally {\r\n                            inputSurface.unlockCanvasAndPost(canvas);\r\n                        }\r\n                    }\r\n\r\n                    \r\n                    MediaCodec.BufferInfo bufferInfo = new MediaCodec.BufferInfo();\r\n                    while (true) {\r\n                        int encoderStatus = mediaCodec.dequeueOutputBuffer(bufferInfo, 0);\r\n                        if (encoderStatus == MediaCodec.INFO_TRY_AGAIN_LATER) {\r\n                            break;\r\n                        } else if (encoderStatus == MediaCodec.INFO_OUTPUT_FORMAT_CHANGED) {\r\n                            if (muxerStarted) {\r\n                                releaseResources();\r\n                                return;\r\n                            }\r\n                            MediaFormat newFormat = mediaCodec.getOutputFormat();\r\n                            videoTrackIndex = mediaMuxer.addTrack(newFormat);\r\n                            mediaMuxer.start();\r\n                            muxerStarted = true;\r\n                        } else if (encoderStatus &lt; 0) {\r\n                            Log.w(TAG, &quot;unexpected result from encoder.dequeueOutputBuffer: &quot; + encoderStatus);\r\n                        } else {\r\n                            ByteBuffer encodedData = mediaCodec.getOutputBuffer(encoderStatus);\r\n                            if (encodedData == null) {\r\n                                releaseResources();\r\n                                return;\r\n                            }\r\n                            if ((bufferInfo.flags &amp; MediaCodec.BUFFER_FLAG_CODEC_CONFIG) != 0) {\r\n                                bufferInfo.size = 0;\r\n                            }\r\n                            if (bufferInfo.size != 0) {\r\n                                if (!muxerStarted) {\r\n                                    releaseResources();\r\n                                    return;\r\n                                }\r\n                                encodedData.position(bufferInfo.offset);\r\n                                encodedData.limit(bufferInfo.offset + bufferInfo.size);\r\n                                mediaMuxer.writeSampleData(videoTrackIndex, encodedData, bufferInfo);\r\n                            }\r\n                            mediaCodec.releaseOutputBuffer(encoderStatus, false);\r\n                            if ((bufferInfo.flags &amp; MediaCodec.BUFFER_FLAG_END_OF_STREAM) != 0) {\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                \r\n                releaseResources();\r\n\r\n               \r\n                ContentValues values = new ContentValues();\r\n                values.put(MediaStore.Video.Media.DATA, outputFile.getAbsolutePath());\r\n                values.put(MediaStore.Video.Media.MIME_TYPE, &quot;video/mp4&quot;);\r\n                Uri uri = context.getContentResolver().insert(MediaStore.Video.Media.EXTERNAL_CONTENT_URI, values);\r\n\r\n\r\n            } catch (IOException e) {\r\n                releaseResources();\r\n            }\r\n        });\r\n    }\r\n","title":"Regarding the problem of making the bitmaps image collection of ArrayList&lt;Bitmap&gt; type into a video, the duration of the video is too short","body":"<p>There are 300 frames of images in the bitmaps, and the set frame rate is 30, but the video length is only 3 seconds; if there are 600 frames of images, the video length is 6 seconds, etc.;The video can play all content, but the playback rate is faster, at double or triple speed; what is the reason for this? How should it(encodeVideo(ArrayList bitmaps)) be optimized?</p>\n<pre><code>private static final String MIME_TYPE = &quot;video/avc&quot;; \nprivate static final int BIT_RATE = 3000000; \nprivate static final int FRAME_RATE = 30;\nprivate static final int I_FRAME_INTERVAL = 10;\n\n\n\npublic void encodeVideo(ArrayList&lt;Bitmap&gt; bitmaps) {\n    Executor executor = Executors.newSingleThreadExecutor();\n    executor.execute(() -&gt; {\n        if (bitmaps == null || bitmaps.isEmpty()) {\n            return;\n        }\n\n\n        try {\n            width = bitmaps.get(0).getWidth();\n            height = bitmaps.get(0).getHeight();\n            String timeStamp = new SimpleDateFormat(&quot;yyyyMMdd_HHmmss&quot;, Locale.getDefault()).format(new Date());\n            String fileName1 = &quot;VID_&quot; + timeStamp + &quot;.mp4&quot;;\n            outputFile = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM), fileName1);\n\n            \n            MediaFormat format = MediaFormat.createVideoFormat(MIME_TYPE, width, height);\n            format.setInteger(MediaFormat.KEY_COLOR_FORMAT, MediaCodecInfo.CodecCapabilities.COLOR_FormatSurface);\n            format.setInteger(MediaFormat.KEY_BIT_RATE, BIT_RATE);\n            format.setInteger(MediaFormat.KEY_FRAME_RATE, FRAME_RATE);\n            format.setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, I_FRAME_INTERVAL);\n\n            \n            mediaCodec = MediaCodec.createEncoderByType(MIME_TYPE);\n            mediaCodec.configure(format, null, null, MediaCodec.CONFIGURE_FLAG_ENCODE);\n            inputSurface = mediaCodec.createInputSurface();\n            mediaCodec.start();\n\n            \n            mediaMuxer = new MediaMuxer(outputFile.getPath(), MediaMuxer.OutputFormat.MUXER_OUTPUT_MPEG_4);\n\n            for (Bitmap bitmap : bitmaps) {\n                if (Thread.currentThread().isInterrupted()) {\n                    return;\n                }\n                \n                Canvas canvas = inputSurface.lockCanvas(null);\n                if (canvas != null) {\n                    try {\n                        canvas.drawBitmap(bitmap, 0, 0, null);\n                    } finally {\n                        inputSurface.unlockCanvasAndPost(canvas);\n                    }\n                }\n\n                \n                MediaCodec.BufferInfo bufferInfo = new MediaCodec.BufferInfo();\n                while (true) {\n                    int encoderStatus = mediaCodec.dequeueOutputBuffer(bufferInfo, 0);\n                    if (encoderStatus == MediaCodec.INFO_TRY_AGAIN_LATER) {\n                        break;\n                    } else if (encoderStatus == MediaCodec.INFO_OUTPUT_FORMAT_CHANGED) {\n                        if (muxerStarted) {\n                            releaseResources();\n                            return;\n                        }\n                        MediaFormat newFormat = mediaCodec.getOutputFormat();\n                        videoTrackIndex = mediaMuxer.addTrack(newFormat);\n                        mediaMuxer.start();\n                        muxerStarted = true;\n                    } else if (encoderStatus &lt; 0) {\n                        Log.w(TAG, &quot;unexpected result from encoder.dequeueOutputBuffer: &quot; + encoderStatus);\n                    } else {\n                        ByteBuffer encodedData = mediaCodec.getOutputBuffer(encoderStatus);\n                        if (encodedData == null) {\n                            releaseResources();\n                            return;\n                        }\n                        if ((bufferInfo.flags &amp; MediaCodec.BUFFER_FLAG_CODEC_CONFIG) != 0) {\n                            bufferInfo.size = 0;\n                        }\n                        if (bufferInfo.size != 0) {\n                            if (!muxerStarted) {\n                                releaseResources();\n                                return;\n                            }\n                            encodedData.position(bufferInfo.offset);\n                            encodedData.limit(bufferInfo.offset + bufferInfo.size);\n                            mediaMuxer.writeSampleData(videoTrackIndex, encodedData, bufferInfo);\n                        }\n                        mediaCodec.releaseOutputBuffer(encoderStatus, false);\n                        if ((bufferInfo.flags &amp; MediaCodec.BUFFER_FLAG_END_OF_STREAM) != 0) {\n                            break;\n                        }\n                    }\n                }\n            }\n\n            \n            releaseResources();\n\n           \n            ContentValues values = new ContentValues();\n            values.put(MediaStore.Video.Media.DATA, outputFile.getAbsolutePath());\n            values.put(MediaStore.Video.Media.MIME_TYPE, &quot;video/mp4&quot;);\n            Uri uri = context.getContentResolver().insert(MediaStore.Video.Media.EXTERNAL_CONTENT_URI, values);\n\n\n        } catch (IOException e) {\n            releaseResources();\n        }\n    });\n}\n</code></pre>\n"},{"tags":["java","spring-boot","spring-security"],"comments":[{"owner":{"account_id":2064278,"reputation":13138,"user_id":1840146,"accept_rate":86,"display_name":"Toerktumlare"},"score":0,"creation_date":1694262675,"post_id":77071936,"comment_id":135870114,"body_markdown":"UserDetails has nothing to do with JWT, `oauth2ResourceServer`. It is null because if you pass a JWT to a spring service, it will validate the token, but it will not load any user details since a token is not a session and it is stateless. If you want the id, you need to put it in the jwt token as a claim.","body":"UserDetails has nothing to do with JWT, <code>oauth2ResourceServer</code>. It is null because if you pass a JWT to a spring service, it will validate the token, but it will not load any user details since a token is not a session and it is stateless. If you want the id, you need to put it in the jwt token as a claim."},{"owner":{"account_id":24613960,"reputation":33,"user_id":20440933,"display_name":"Jez"},"score":0,"creation_date":1694263170,"post_id":77071936,"comment_id":135870168,"body_markdown":"So basically, I have to put every data I need about the user into the JWT, and then extract it in the controller?","body":"So basically, I have to put every data I need about the user into the JWT, and then extract it in the controller?"},{"owner":{"account_id":2064278,"reputation":13138,"user_id":1840146,"accept_rate":86,"display_name":"Toerktumlare"},"score":0,"creation_date":1694264002,"post_id":77071936,"comment_id":135870249,"body_markdown":"or you give up using JWT tokens and resource server since it is not what you want and instead implement FormLogin","body":"or you give up using JWT tokens and resource server since it is not what you want and instead implement FormLogin"},{"owner":{"account_id":308139,"reputation":8199,"user_id":619830,"accept_rate":75,"display_name":"ch4mp"},"score":1,"creation_date":1694301098,"post_id":77071936,"comment_id":135873657,"body_markdown":"I don&#39;t agree with last comment: configuring a REST API as a stateless resource server is a good idea, you should stick with it: it makes it very scalable and fault tolerant. Moreover, what is the point of configuring OAuth2 client and request &amp; store tokens if you never use it to query an OAuth2 resource server?","body":"I don&#39;t agree with last comment: configuring a REST API as a stateless resource server is a good idea, you should stick with it: it makes it very scalable and fault tolerant. Moreover, what is the point of configuring OAuth2 client and request &amp; store tokens if you never use it to query an OAuth2 resource server?"}],"answers":[{"comments":[{"owner":{"account_id":24613960,"reputation":33,"user_id":20440933,"display_name":"Jez"},"score":0,"creation_date":1694345744,"post_id":77074380,"comment_id":135876549,"body_markdown":"Thanks for the detailed explanation this is kind of a learning project for me. For now, I made it like this:\nI access the Jwt form AuthenticationPrincipal and added the user&#39;s ID as the &#39;sub&#39; to the Jwt so I can read it in the controller.","body":"Thanks for the detailed explanation this is kind of a learning project for me. For now, I made it like this: I access the Jwt form AuthenticationPrincipal and added the user&#39;s ID as the &#39;sub&#39; to the Jwt so I can read it in the controller."},{"owner":{"account_id":308139,"reputation":8199,"user_id":619830,"accept_rate":75,"display_name":"ch4mp"},"score":1,"creation_date":1694358599,"post_id":77074380,"comment_id":135877855,"body_markdown":"You could find my tutorials useful: https://github.com/ch4mpy/spring-addons/tree/master/samples/tutorials there is, among other things, a complete BFF sample (in case you want a Javascript based front-end)","body":"You could find my tutorials useful: <a href=\"https://github.com/ch4mpy/spring-addons/tree/master/samples/tutorials\" rel=\"nofollow noreferrer\">github.com/ch4mpy/spring-addons/tree/master/samples/tutorial&zwnj;&#8203;s</a> there is, among other things, a complete BFF sample (in case you want a Javascript based front-end)"},{"owner":{"account_id":24613960,"reputation":33,"user_id":20440933,"display_name":"Jez"},"score":0,"creation_date":1694359784,"post_id":77074380,"comment_id":135877992,"body_markdown":"Awesome, thanks!","body":"Awesome, thanks!"},{"owner":{"account_id":308139,"reputation":8199,"user_id":619830,"accept_rate":75,"display_name":"ch4mp"},"score":1,"creation_date":1694376902,"post_id":77074380,"comment_id":135879662,"body_markdown":"Don&#39;t skip the README. There is some useful I for on the r&#233;po main README too.","body":"Don&#39;t skip the README. There is some useful I for on the r&#233;po main README too."}],"tags":[],"owner":{"account_id":308139,"reputation":8199,"user_id":619830,"accept_rate":75,"display_name":"ch4mp"},"comment_count":4,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694333014,"creation_date":1694303104,"answer_id":77074380,"question_id":77071936,"body_markdown":"Resource server build the security-context out of the access token, either by decoding it (if it&#39;s a JWT), or introspecting it (whatever the format).\r\n\r\nIn case of JWT, there is a [chapter in the doc][1] explaining how it works, and you should read it.\r\n\r\nIf you stick with the default `Authentication` implementation with JWT decoders (`JwtAuthenticationToken`), then `@AuthenticationPrincipal` should return a `org.springframework.security.oauth2.jwt.Jwt` from which you can read claims (provided that the request was authorised with a valid `Bearer` JWT).\r\n\r\nSo, yes, as you suggest in the comments to your question, enriching access tokens (when creating it on the authorization server) with all of the user data you need on your resource server(s), seems a better idea\r\nthan looping to the database for each and every REST API call.\r\n\r\nIf there are claims you need to access frequently, you could configure the `jwtAuthenticationConverter` to return your own extension of `AbstractAuthenticationToken` (instead of `JwtAuthenticationToken`). It is rather simple and allows to return typed values from named accessors (and de-couple your application code from your authorization server claims structure).\r\n\r\n#### P.S.\r\nOAuth2 resource servers are queried by OAuth2 clients but mobile and Javascript based applications (Angular, Vue, React, etc) make unsafe OAuth2 clients.\r\n\r\nThe [current recommendation][2] from Spring Security team is to use &quot;confidential&quot; clients on the server.\r\n\r\nFor mobile and Javascript based applications, I use `spring-cloud-gateway` (with `spring-boot-starter-oauth2-client` and `TokenRelay=` filter) in front of my stateless resource servers. In this architecture, requests are authorized with:\r\n- sessions between the front-end and the (stateful) gateway\r\n- Bearer JWT between the gateway and the (stateless) REST APIs.\r\n\r\n\r\n  [1]: https://docs.spring.io/spring-security/reference/servlet/oauth2/resource-server/jwt.html#oauth2resourceserver-jwt-architecture\r\n  [2]: https://github.com/spring-projects/spring-authorization-server/issues/297#issue-896744390","title":"Spring Boot REST (OAUTH2 JWT) @AuthenticationPrincipal returns null for custom UserDetails","body":"<p>Resource server build the security-context out of the access token, either by decoding it (if it's a JWT), or introspecting it (whatever the format).</p>\n<p>In case of JWT, there is a <a href=\"https://docs.spring.io/spring-security/reference/servlet/oauth2/resource-server/jwt.html#oauth2resourceserver-jwt-architecture\" rel=\"nofollow noreferrer\">chapter in the doc</a> explaining how it works, and you should read it.</p>\n<p>If you stick with the default <code>Authentication</code> implementation with JWT decoders (<code>JwtAuthenticationToken</code>), then <code>@AuthenticationPrincipal</code> should return a <code>org.springframework.security.oauth2.jwt.Jwt</code> from which you can read claims (provided that the request was authorised with a valid <code>Bearer</code> JWT).</p>\n<p>So, yes, as you suggest in the comments to your question, enriching access tokens (when creating it on the authorization server) with all of the user data you need on your resource server(s), seems a better idea\nthan looping to the database for each and every REST API call.</p>\n<p>If there are claims you need to access frequently, you could configure the <code>jwtAuthenticationConverter</code> to return your own extension of <code>AbstractAuthenticationToken</code> (instead of <code>JwtAuthenticationToken</code>). It is rather simple and allows to return typed values from named accessors (and de-couple your application code from your authorization server claims structure).</p>\n<h4>P.S.</h4>\n<p>OAuth2 resource servers are queried by OAuth2 clients but mobile and Javascript based applications (Angular, Vue, React, etc) make unsafe OAuth2 clients.</p>\n<p>The <a href=\"https://github.com/spring-projects/spring-authorization-server/issues/297#issue-896744390\" rel=\"nofollow noreferrer\">current recommendation</a> from Spring Security team is to use &quot;confidential&quot; clients on the server.</p>\n<p>For mobile and Javascript based applications, I use <code>spring-cloud-gateway</code> (with <code>spring-boot-starter-oauth2-client</code> and <code>TokenRelay=</code> filter) in front of my stateless resource servers. In this architecture, requests are authorized with:</p>\n<ul>\n<li>sessions between the front-end and the (stateful) gateway</li>\n<li>Bearer JWT between the gateway and the (stateless) REST APIs.</li>\n</ul>\n"}],"owner":{"account_id":24613960,"reputation":33,"user_id":20440933,"display_name":"Jez"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":202,"favorite_count":0,"down_vote_count":1,"up_vote_count":3,"accepted_answer_id":77074380,"answer_count":1,"score":2,"last_activity_date":1694333014,"creation_date":1694257805,"question_id":77071936,"body_markdown":"**Context:** I have a Spring Boot REST API secured with oauth2 JWT, this part works properly.\r\n\r\n**Problem:** In my RestController I want to access the currently authenticated user&#39;s ID with `@AuthenticationPrincipal User userDetails` but it returns `null`.\r\n\r\n**Security Filter Chain:**\r\n\r\n```\r\n    @Bean\r\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception\r\n    {\r\n        return http\r\n                .csrf(csrf -&gt; csrf.disable())\r\n                .authorizeHttpRequests(auth -&gt;\r\n                {\r\n                    auth.requestMatchers(new AntPathRequestMatcher(&quot;/auth/**&quot;)).permitAll();\r\n                    auth.requestMatchers(new AntPathRequestMatcher(&quot;/admin/**&quot;)).hasAnyRole(&quot;ADMIN&quot;);\r\n                    auth.requestMatchers(new AntPathRequestMatcher(&quot;/user/**&quot;)).hasAnyRole(&quot;USER&quot;, &quot;ADMIN&quot;);\r\n                    auth.anyRequest().authenticated();\r\n                })\r\n                .oauth2ResourceServer(oauth2 -&gt; oauth2\r\n                        .jwt(jwtConfigurer -&gt; jwtConfigurer.jwtAuthenticationConverter(jwtAuthenticationConverter()))\r\n                        .authenticationEntryPoint(invalidTokenAuthenticationEntryPoint)\r\n                )\r\n                .exceptionHandling(exception -&gt;\r\n                        exception.authenticationEntryPoint(authRequiredAuthenticationEntryPoint))\r\n                .sessionManagement(session -&gt; session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\r\n                .build();\r\n    }\r\n```\r\n\r\n\r\n\r\n**User Entity:**\r\n\r\n```\r\n@Entity\r\n@Table(name = &quot;user&quot;)\r\n@Getter\r\n@Setter\r\n@AllArgsConstructor\r\n@NoArgsConstructor\r\npublic class User extends AbstractTimestampEntity implements UserDetails\r\n{\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = &quot;user_id&quot;)\r\n    private Long userId;\r\n\r\n    @Column(nullable = false)\r\n    private String username;\r\n\r\n    @Column(nullable = false)\r\n    private String email;\r\n\r\n    @Column(nullable = false)\r\n    @JsonIgnore\r\n    private String password;\r\n\r\n    @ManyToMany\r\n    @JoinTable(\r\n            name = &quot;user_role_junction&quot;,\r\n            joinColumns = {@JoinColumn(name = &quot;user_id&quot;)},\r\n            inverseJoinColumns = {@JoinColumn(name = &quot;role_id&quot;)}\r\n    )\r\n    private Set&lt;Role&gt; authorities;\r\n\r\n    // Constructor for manual user creation\r\n    public User(String username, String email, String password, Set&lt;Role&gt; authorities)\r\n    {\r\n        this.username = username;\r\n        this.email = email;\r\n        this.password = password;\r\n        this.authorities = authorities;\r\n    }\r\n\r\n    @Override\r\n    public boolean isAccountNonExpired()\r\n    {\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean isAccountNonLocked()\r\n    {\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean isCredentialsNonExpired()\r\n    {\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean isEnabled()\r\n    {\r\n        return true;\r\n    }\r\n}\r\n```\r\n\r\n**User Details Service implementation**\r\n\r\n```\r\n@Service\r\npublic class UserDetailsServiceImpl implements UserDetailsService\r\n{\r\n    private UserRepository userRepository;\r\n\r\n    public UserDetailsServiceImpl(UserRepository userRepository)\r\n    {\r\n        this.userRepository = userRepository;\r\n    }\r\n\r\n    @Override\r\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException\r\n    {\r\n        return userRepository.findByUsername(username).orElseThrow(() -&gt; new UsernameNotFoundException(&quot;User does not exists!&quot;));\r\n    }\r\n}\r\n```\r\n\r\n**User Controller**\r\n\r\n```\r\npackage com.jez.blogapi.controller;\r\n\r\nimport com.jez.blogapi.model.User;\r\nimport org.springframework.http.HttpStatus;\r\nimport org.springframework.http.ResponseEntity;\r\nimport org.springframework.security.core.annotation.AuthenticationPrincipal;\r\nimport org.springframework.web.bind.annotation.GetMapping;\r\nimport org.springframework.web.bind.annotation.RequestMapping;\r\nimport org.springframework.web.bind.annotation.RestController;\r\n\r\n@RestController\r\n@RequestMapping(&quot;/user&quot;)\r\npublic class UserController\r\n{\r\n    @GetMapping(&quot;/test&quot;)\r\n    public ResponseEntity&lt;String&gt; getUserById(@AuthenticationPrincipal User userDetails)\r\n    {\r\n        System.out.println(userDetails);\r\n        return new ResponseEntity&lt;&gt;(&quot;test response message&quot;, HttpStatus.OK);\r\n    }\r\n}\r\n```\r\n\r\n\r\n\r\n\r\n","title":"Spring Boot REST (OAUTH2 JWT) @AuthenticationPrincipal returns null for custom UserDetails","body":"<p><strong>Context:</strong> I have a Spring Boot REST API secured with oauth2 JWT, this part works properly.</p>\n<p><strong>Problem:</strong> In my RestController I want to access the currently authenticated user's ID with <code>@AuthenticationPrincipal User userDetails</code> but it returns <code>null</code>.</p>\n<p><strong>Security Filter Chain:</strong></p>\n<pre><code>    @Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception\n    {\n        return http\n                .csrf(csrf -&gt; csrf.disable())\n                .authorizeHttpRequests(auth -&gt;\n                {\n                    auth.requestMatchers(new AntPathRequestMatcher(&quot;/auth/**&quot;)).permitAll();\n                    auth.requestMatchers(new AntPathRequestMatcher(&quot;/admin/**&quot;)).hasAnyRole(&quot;ADMIN&quot;);\n                    auth.requestMatchers(new AntPathRequestMatcher(&quot;/user/**&quot;)).hasAnyRole(&quot;USER&quot;, &quot;ADMIN&quot;);\n                    auth.anyRequest().authenticated();\n                })\n                .oauth2ResourceServer(oauth2 -&gt; oauth2\n                        .jwt(jwtConfigurer -&gt; jwtConfigurer.jwtAuthenticationConverter(jwtAuthenticationConverter()))\n                        .authenticationEntryPoint(invalidTokenAuthenticationEntryPoint)\n                )\n                .exceptionHandling(exception -&gt;\n                        exception.authenticationEntryPoint(authRequiredAuthenticationEntryPoint))\n                .sessionManagement(session -&gt; session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\n                .build();\n    }\n</code></pre>\n<p><strong>User Entity:</strong></p>\n<pre><code>@Entity\n@Table(name = &quot;user&quot;)\n@Getter\n@Setter\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User extends AbstractTimestampEntity implements UserDetails\n{\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name = &quot;user_id&quot;)\n    private Long userId;\n\n    @Column(nullable = false)\n    private String username;\n\n    @Column(nullable = false)\n    private String email;\n\n    @Column(nullable = false)\n    @JsonIgnore\n    private String password;\n\n    @ManyToMany\n    @JoinTable(\n            name = &quot;user_role_junction&quot;,\n            joinColumns = {@JoinColumn(name = &quot;user_id&quot;)},\n            inverseJoinColumns = {@JoinColumn(name = &quot;role_id&quot;)}\n    )\n    private Set&lt;Role&gt; authorities;\n\n    // Constructor for manual user creation\n    public User(String username, String email, String password, Set&lt;Role&gt; authorities)\n    {\n        this.username = username;\n        this.email = email;\n        this.password = password;\n        this.authorities = authorities;\n    }\n\n    @Override\n    public boolean isAccountNonExpired()\n    {\n        return true;\n    }\n\n    @Override\n    public boolean isAccountNonLocked()\n    {\n        return true;\n    }\n\n    @Override\n    public boolean isCredentialsNonExpired()\n    {\n        return true;\n    }\n\n    @Override\n    public boolean isEnabled()\n    {\n        return true;\n    }\n}\n</code></pre>\n<p><strong>User Details Service implementation</strong></p>\n<pre><code>@Service\npublic class UserDetailsServiceImpl implements UserDetailsService\n{\n    private UserRepository userRepository;\n\n    public UserDetailsServiceImpl(UserRepository userRepository)\n    {\n        this.userRepository = userRepository;\n    }\n\n    @Override\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException\n    {\n        return userRepository.findByUsername(username).orElseThrow(() -&gt; new UsernameNotFoundException(&quot;User does not exists!&quot;));\n    }\n}\n</code></pre>\n<p><strong>User Controller</strong></p>\n<pre><code>package com.jez.blogapi.controller;\n\nimport com.jez.blogapi.model.User;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.security.core.annotation.AuthenticationPrincipal;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\n@RequestMapping(&quot;/user&quot;)\npublic class UserController\n{\n    @GetMapping(&quot;/test&quot;)\n    public ResponseEntity&lt;String&gt; getUserById(@AuthenticationPrincipal User userDetails)\n    {\n        System.out.println(userDetails);\n        return new ResponseEntity&lt;&gt;(&quot;test response message&quot;, HttpStatus.OK);\n    }\n}\n</code></pre>\n"},{"tags":["java","design-patterns"],"answers":[{"tags":[],"owner":{"account_id":189531,"reputation":22741,"user_id":428916,"accept_rate":69,"display_name":"Rocky Pulley"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1309367417,"creation_date":1309367417,"answer_id":6524610,"question_id":6524563,"body_markdown":"It sounds like maybe it&#39;s using the Observer pattern.\r\n\r\n","title":"Is Something-Aware a design pattern?","body":"<p>It sounds like maybe it's using the Observer pattern.</p>\n"},{"tags":[],"owner":{"account_id":131213,"reputation":47334,"user_id":331052,"display_name":"Affe"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1309368735,"creation_date":1309368735,"answer_id":6524835,"question_id":6524563,"body_markdown":"The design pattern is still Dependency Injection and IOC.  The marker interfaces are just a clunky language-version specific way of implementing it.","title":"Is Something-Aware a design pattern?","body":"<p>The design pattern is still Dependency Injection and IOC.  The marker interfaces are just a clunky language-version specific way of implementing it.</p>\n"}],"owner":{"account_id":33478,"reputation":1691,"user_id":93773,"accept_rate":45,"display_name":"Matt"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1730,"favorite_count":0,"down_vote_count":0,"up_vote_count":10,"answer_count":2,"score":10,"last_activity_date":1694332259,"creation_date":1309367192,"question_id":6524563,"body_markdown":"In the Struts2 interceptor package, we can see many XxxAware interfaces, like `ApplicationAware`, `CookieAware`, and so on. \r\n\r\nIn the Spring framework, `ApplicationContextAware`, `BeanFactoryAware`, and other examples can be seen as well.\r\n\r\nI also follow this design concept to implement my framework. Is this a kind of design pattern? Does it have a name?","title":"Is Something-Aware a design pattern?","body":"<p>In the Struts2 interceptor package, we can see many XxxAware interfaces, like <code>ApplicationAware</code>, <code>CookieAware</code>, and so on.</p>\n<p>In the Spring framework, <code>ApplicationContextAware</code>, <code>BeanFactoryAware</code>, and other examples can be seen as well.</p>\n<p>I also follow this design concept to implement my framework. Is this a kind of design pattern? Does it have a name?</p>\n"},{"tags":["java","spring-boot","thymeleaf","junit5","spring-test"],"answers":[{"comments":[{"owner":{"account_id":460980,"reputation":399,"user_id":862404,"accept_rate":66,"display_name":"Paul"},"score":0,"creation_date":1694415335,"post_id":77073980,"comment_id":135882832,"body_markdown":"Works great, thank you very much Ken !","body":"Works great, thank you very much Ken !"}],"tags":[],"owner":{"account_id":136251,"reputation":87506,"user_id":339637,"accept_rate":55,"display_name":"Ken Chan"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694291878,"creation_date":1694291878,"answer_id":77073980,"question_id":77051481,"body_markdown":"Those thymeleaf related beans are auto-configured by `ThymeleafAutoConfiguration` which is enabled if any configuration class is annotated with `@EnableAutoConfiguration`. \r\n\r\n`@SpringBootApplication` has this `@EnableAutoConfiguration` , so when you start the app in normal way , `ThymeleafAutoConfiguration` takes effect and define the related thymeleaf beans.\r\n\r\nBut now in test , you just specify to use `ThymeleafProcessor` and `TemplateEngine` as the configuration class to start the spring context. Neither `@SpringBootApplication` nor `@EnableAutoConfiguration` involved and so `ThymeleafAutoConfiguration` does not take effect.\r\n\r\nYou can fix it by explicitly import `ThymeleafAutoConfiguration` using `@ImportAutoConfiguration` :\r\n\r\n``` java\r\n@SpringBootTest(classes = {ThymeleafProcessor.class})\r\n@ImportAutoConfiguration(ThymeleafAutoConfiguration.class)\r\nclass ThymeleafProcessorTest {\r\n\r\n\r\n}\r\n```\r\n\r\nI also tidy up the codes a bit :\r\n\r\n- `@ExtendWith(SpringExtension.class)`  is not required as it is already defined by `@SpringBootTest`\r\n\r\n- Do not need to define `TemplateEngine` in `@SpringBootTest` as it will be defined by `ThymeleafAutoConfiguration`\r\n\r\n- Most probably `@EnableConfigurationProperties` is also not required.\r\n","title":"How to unit test a Thymeleaf template using Spring Boot Test","body":"<p>Those thymeleaf related beans are auto-configured by <code>ThymeleafAutoConfiguration</code> which is enabled if any configuration class is annotated with <code>@EnableAutoConfiguration</code>.</p>\n<p><code>@SpringBootApplication</code> has this <code>@EnableAutoConfiguration</code> , so when you start the app in normal way , <code>ThymeleafAutoConfiguration</code> takes effect and define the related thymeleaf beans.</p>\n<p>But now in test , you just specify to use <code>ThymeleafProcessor</code> and <code>TemplateEngine</code> as the configuration class to start the spring context. Neither <code>@SpringBootApplication</code> nor <code>@EnableAutoConfiguration</code> involved and so <code>ThymeleafAutoConfiguration</code> does not take effect.</p>\n<p>You can fix it by explicitly import <code>ThymeleafAutoConfiguration</code> using <code>@ImportAutoConfiguration</code> :</p>\n<pre class=\"lang-java prettyprint-override\"><code>@SpringBootTest(classes = {ThymeleafProcessor.class})\n@ImportAutoConfiguration(ThymeleafAutoConfiguration.class)\nclass ThymeleafProcessorTest {\n\n\n}\n</code></pre>\n<p>I also tidy up the codes a bit :</p>\n<ul>\n<li><p><code>@ExtendWith(SpringExtension.class)</code>  is not required as it is already defined by <code>@SpringBootTest</code></p>\n</li>\n<li><p>Do not need to define <code>TemplateEngine</code> in <code>@SpringBootTest</code> as it will be defined by <code>ThymeleafAutoConfiguration</code></p>\n</li>\n<li><p>Most probably <code>@EnableConfigurationProperties</code> is also not required.</p>\n</li>\n</ul>\n"}],"owner":{"account_id":460980,"reputation":399,"user_id":862404,"accept_rate":66,"display_name":"Paul"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":248,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77073980,"answer_count":1,"score":0,"last_activity_date":1694331839,"creation_date":1693999845,"question_id":77051481,"body_markdown":"I am parsing a Thymeleaf template using the following bean:\r\n\r\n\r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.stereotype.Service;\r\n    import org.thymeleaf.TemplateEngine;\r\n    import org.thymeleaf.context.Context;\r\n    \r\n    @Service\r\n    public class ThymeleafProcessor {\r\n    \r\n        private final TemplateEngine templateEngine;\r\n    \r\n        @Autowired\r\n        public ThymeleafProcessor(TemplateEngine templateEngine) {\r\n            this.templateEngine = templateEngine;\r\n        }\r\n    \r\n        public String process() {\r\n            final var templateResolvers = templateEngine.getTemplateResolvers();\r\n            System.out.println(templateResolvers);// Collection with one SpringResourceTemplateResolver \r\n            String process = templateEngine.process(&quot;test.html&quot;, new Context());\r\n            System.out.println(process); //Prints &quot;Hello World&quot;\r\n            return process;\r\n        }\r\n    }\r\n\r\n\r\nThe template is located in src/main/resources/templates and looks like this:\r\n\r\n    Hello World\r\n\r\nSo far everything works fine.\r\n\r\nNow I want to write a unit test for the bean but this doesn&#39;t work:\r\n\r\n    import org.junit.jupiter.api.Test;\r\n    import org.junit.jupiter.api.extension.ExtendWith;\r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.boot.context.properties.EnableConfigurationProperties;\r\n    import org.springframework.boot.test.context.SpringBootTest;\r\n    import org.springframework.test.context.junit.jupiter.SpringExtension;\r\n    import org.thymeleaf.TemplateEngine;\r\n    \r\n    import static org.junit.jupiter.api.Assertions.assertEquals;\r\n    \r\n    @ExtendWith(SpringExtension.class)\r\n    @SpringBootTest(classes = {\r\n            ThymeleafProcessor.class,\r\n            TemplateEngine.class,\r\n    })\r\n    @EnableConfigurationProperties\r\n    class ThymeleafProcessorTest {\r\n    \r\n        @Autowired\r\n        private ThymeleafProcessor thymeleafProcessor;\r\n    \r\n        @Autowired\r\n        private TemplateEngine templateEngine;\r\n    \r\n    \r\n        @Test\r\n        void doTest() {\r\n            System.out.println(templateEngine.getTemplateResolvers().size());  //this will return 0 in the test\r\n    \r\n            var result = thymeleafProcessor.process();\r\n    \r\n            assertEquals(&quot;Hello World&quot;, result);\r\n        }\r\n    \r\n    }\r\n\r\n\r\nInsetad of the expected String &quot;Hello World&quot; the String &quot;test.html&quot; is returned. The problem seems to be that no Template Resolver is available.\r\n\r\nHow does the test need to be configured in order to test the Thymeleaf template?\r\n\r\n","title":"How to unit test a Thymeleaf template using Spring Boot Test","body":"<p>I am parsing a Thymeleaf template using the following bean:</p>\n<pre><code>import org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\nimport org.thymeleaf.TemplateEngine;\nimport org.thymeleaf.context.Context;\n\n@Service\npublic class ThymeleafProcessor {\n\n    private final TemplateEngine templateEngine;\n\n    @Autowired\n    public ThymeleafProcessor(TemplateEngine templateEngine) {\n        this.templateEngine = templateEngine;\n    }\n\n    public String process() {\n        final var templateResolvers = templateEngine.getTemplateResolvers();\n        System.out.println(templateResolvers);// Collection with one SpringResourceTemplateResolver \n        String process = templateEngine.process(&quot;test.html&quot;, new Context());\n        System.out.println(process); //Prints &quot;Hello World&quot;\n        return process;\n    }\n}\n</code></pre>\n<p>The template is located in src/main/resources/templates and looks like this:</p>\n<pre><code>Hello World\n</code></pre>\n<p>So far everything works fine.</p>\n<p>Now I want to write a unit test for the bean but this doesn't work:</p>\n<pre><code>import org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.context.properties.EnableConfigurationProperties;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.test.context.junit.jupiter.SpringExtension;\nimport org.thymeleaf.TemplateEngine;\n\nimport static org.junit.jupiter.api.Assertions.assertEquals;\n\n@ExtendWith(SpringExtension.class)\n@SpringBootTest(classes = {\n        ThymeleafProcessor.class,\n        TemplateEngine.class,\n})\n@EnableConfigurationProperties\nclass ThymeleafProcessorTest {\n\n    @Autowired\n    private ThymeleafProcessor thymeleafProcessor;\n\n    @Autowired\n    private TemplateEngine templateEngine;\n\n\n    @Test\n    void doTest() {\n        System.out.println(templateEngine.getTemplateResolvers().size());  //this will return 0 in the test\n\n        var result = thymeleafProcessor.process();\n\n        assertEquals(&quot;Hello World&quot;, result);\n    }\n\n}\n</code></pre>\n<p>Insetad of the expected String &quot;Hello World&quot; the String &quot;test.html&quot; is returned. The problem seems to be that no Template Resolver is available.</p>\n<p>How does the test need to be configured in order to test the Thymeleaf template?</p>\n"},{"tags":["java","security","jar","crlf-vulnerability"],"comments":[{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1694331822,"post_id":77075132,"comment_id":135875255,"body_markdown":"Finding all installed JAR files can be done using an OS-specific command; e.g. `sudo find / -name \\*.jar`.  The duplink tells you how to find a JAR&#39;s version information (if any) ... in addition to what is implied by the JAR file&#39;s filename.","body":"Finding all installed JAR files can be done using an OS-specific command; e.g. <code>sudo find &#47; -name \\*.jar</code>.  The duplink tells you how to find a JAR&#39;s version information (if any) ... in addition to what is implied by the JAR file&#39;s filename."},{"owner":{"account_id":350117,"reputation":8663,"user_id":685806,"accept_rate":44,"display_name":"Pino"},"score":0,"creation_date":1694347159,"post_id":77075132,"comment_id":135876703,"body_markdown":"...and for the CVEs you can use https://owasp.org/www-project-dependency-check/","body":"...and for the CVEs you can use <a href=\"https://owasp.org/www-project-dependency-check/\" rel=\"nofollow noreferrer\">owasp.org/www-project-dependency-check</a>"}],"owner":{"account_id":2982039,"reputation":1,"user_id":2531808,"display_name":"Zoeb"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":14,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1694331733,"answer_count":0,"score":0,"last_activity_date":1694330292,"creation_date":1694330292,"question_id":77075132,"body_markdown":"I&#39;m trying to find and list all the Java Jar files in the system for vulnerability scanning. \r\n\r\nNeed to get the information regarding their version and any active CVEs that are against those Versions of JAR. \r\n\r\nWill also appreciate any advice on tools that can do it. \r\n\r\ntried listing all the Jar files manually, but couldnt get the version info from that. ","title":"Finding all the JAR packages that are installed in a system for vulnerability scanning","body":"<p>I'm trying to find and list all the Java Jar files in the system for vulnerability scanning.</p>\n<p>Need to get the information regarding their version and any active CVEs that are against those Versions of JAR.</p>\n<p>Will also appreciate any advice on tools that can do it.</p>\n<p>tried listing all the Jar files manually, but couldnt get the version info from that.</p>\n"},{"tags":["java","visual-studio-code"],"comments":[{"owner":{"account_id":18420551,"reputation":404,"user_id":13418296,"display_name":"Generous Badger"},"score":1,"creation_date":1648205089,"post_id":61370386,"comment_id":126570889,"body_markdown":"*Usually* when you&#39;re given external class files they should be bundled inside a jar file. But a directory containing class files can also be on the classpath.","body":"<i>Usually</i> when you&#39;re given external class files they should be bundled inside a jar file. But a directory containing class files can also be on the classpath."},{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1694329681,"post_id":61370386,"comment_id":135875098,"body_markdown":"Surely this just refers to the `import` statement?","body":"Surely this just refers to the <code>import</code> statement?"}],"answers":[{"comments":[{"owner":{"account_id":18420551,"reputation":404,"user_id":13418296,"display_name":"Generous Badger"},"score":2,"creation_date":1648205048,"post_id":61381361,"comment_id":126570869,"body_markdown":"You don&#39;t need to decompile a .class file just to use it. That should only be necessary if you want to edit it.","body":"You don&#39;t need to decompile a .class file just to use it. That should only be necessary if you want to edit it."}],"tags":[],"owner":{"account_id":17942799,"reputation":7768,"user_id":13037676,"display_name":"Steven-MSFT"},"comment_count":1,"down_vote_count":2,"up_vote_count":1,"is_accepted":false,"score":-1,"last_activity_date":1587625933,"creation_date":1587625933,"answer_id":61381361,"question_id":61370386,"body_markdown":"as I know, intellij idea can decompile the .class file depends on the build in decompile plugin, while the extension named &#39;Java Decompiler&#39; in vscode marketplace works a little complex. maybe you can take a try, use the &#39;Java Decompiler&#39; extension or take a look in the intellij idea.","title":"How to use java .class file in Visual Studio Code?","body":"<p>as I know, intellij idea can decompile the .class file depends on the build in decompile plugin, while the extension named 'Java Decompiler' in vscode marketplace works a little complex. maybe you can take a try, use the 'Java Decompiler' extension or take a look in the intellij idea.</p>\n"},{"tags":[],"owner":{"account_id":78259,"reputation":1816,"user_id":222838,"accept_rate":75,"display_name":"mico"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1652256624,"creation_date":1652256624,"answer_id":72197568,"question_id":61370386,"body_markdown":"The easiest way is to have both classes in the same directory, like in this example. Say you have class A\r\n\r\n    public class A {\r\n        public int fun() {\r\n            return 0;\r\n        }\r\n    }\r\n\r\nto use class A from class B in the same directory, you just declare a type A in your B\r\n\r\n\tclass B {\r\n\t\tpublic static void main(String[] args) {\r\n\t\t\tA a = new A();\r\n\t\t\tint i = a.fun();\r\n\t\t\tSystem.out.println(i);\r\n\t\t}\r\n\t}\r\n \r\nthis will print `0`.\r\n\r\nThis works because both classes are in the same directory, and class A is declared public.\r\n\r\nBeing in the same directory, with no package declaration, means that both classes are in the default package, this is the easiest case.","title":"How to use java .class file in Visual Studio Code?","body":"<p>The easiest way is to have both classes in the same directory, like in this example. Say you have class A</p>\n<pre><code>public class A {\n    public int fun() {\n        return 0;\n    }\n}\n</code></pre>\n<p>to use class A from class B in the same directory, you just declare a type A in your B</p>\n<pre><code>class B {\n    public static void main(String[] args) {\n        A a = new A();\n        int i = a.fun();\n        System.out.println(i);\n    }\n}\n</code></pre>\n<p>this will print <code>0</code>.</p>\n<p>This works because both classes are in the same directory, and class A is declared public.</p>\n<p>Being in the same directory, with no package declaration, means that both classes are in the default package, this is the easiest case.</p>\n"},{"tags":[],"owner":{"account_id":1863598,"reputation":1206,"user_id":1687636,"accept_rate":64,"display_name":"Sheldon Wei"},"comment_count":0,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1660296301,"creation_date":1660296301,"answer_id":73331974,"question_id":61370386,"body_markdown":"You may use the extension https://marketplace.visualstudio.com/items?itemName=dgileadi.java-decompiler.\r\nThe ext can help you view the original source code of .class file.\r\n\r\nOn the other hand, what you talked is auto-import feature, which is suported by vscode now.","title":"How to use java .class file in Visual Studio Code?","body":"<p>You may use the extension <a href=\"https://marketplace.visualstudio.com/items?itemName=dgileadi.java-decompiler\" rel=\"nofollow noreferrer\">https://marketplace.visualstudio.com/items?itemName=dgileadi.java-decompiler</a>.\nThe ext can help you view the original source code of .class file.</p>\n<p>On the other hand, what you talked is auto-import feature, which is suported by vscode now.</p>\n"}],"owner":{"account_id":18373681,"reputation":29,"user_id":13383260,"display_name":"Cory"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":21507,"favorite_count":0,"down_vote_count":2,"up_vote_count":3,"answer_count":3,"score":1,"last_activity_date":1694329320,"creation_date":1587573570,"question_id":61370386,"body_markdown":"I&#39;m currently studying a Java course, and one of the assignments requires me to use (import) a class inside a .class file.\r\n\r\nI&#39;m currently using Visual Studio Code, and I can&#39;t seem to find a way to import the class into my Java code.\r\n\r\nWe are not given the .java code. From what I can tell, Visual Studio Code does not support the use of .class files.","title":"How to use java .class file in Visual Studio Code?","body":"<p>I'm currently studying a Java course, and one of the assignments requires me to use (import) a class inside a .class file.</p>\n\n<p>I'm currently using Visual Studio Code, and I can't seem to find a way to import the class into my Java code.</p>\n\n<p>We are not given the .java code. From what I can tell, Visual Studio Code does not support the use of .class files.</p>\n"},{"tags":["java","android","android-webview"],"comments":[{"owner":{"account_id":2191523,"reputation":6723,"user_id":1938435,"accept_rate":92,"display_name":"PurkkaKoodari"},"score":0,"creation_date":1445499986,"post_id":33275717,"comment_id":54352113,"body_markdown":"Possible duplicate of [How to edit or create custom error page for WebView?](http://stackoverflow.com/questions/4101331/how-to-edit-or-create-custom-error-page-for-webview)","body":"Possible duplicate of <a href=\"http://stackoverflow.com/questions/4101331/how-to-edit-or-create-custom-error-page-for-webview\">How to edit or create custom error page for WebView?</a>"},{"owner":{"account_id":274791,"reputation":1249,"user_id":567235,"accept_rate":79,"display_name":"CoderRoller"},"score":0,"creation_date":1445501314,"post_id":33275717,"comment_id":54352858,"body_markdown":"I dont want to hide the message only but to hold to it until the signal is strong and the page is loaded, see the edit.","body":"I dont want to hide the message only but to hold to it until the signal is strong and the page is loaded, see the edit."}],"answers":[{"comments":[{"owner":{"account_id":274791,"reputation":1249,"user_id":567235,"accept_rate":79,"display_name":"CoderRoller"},"score":2,"creation_date":1445501443,"post_id":33275826,"comment_id":54352934,"body_markdown":"Can you elaborate a bit more please?. Check the URL for what purpose?, i already know the URL that I am loading.","body":"Can you elaborate a bit more please?. Check the URL for what purpose?, i already know the URL that I am loading."}],"tags":[],"owner":{"account_id":3523143,"reputation":213,"user_id":2944936,"display_name":"Ravneet Singh"},"comment_count":1,"down_vote_count":2,"up_vote_count":1,"is_accepted":false,"score":-1,"last_activity_date":1445508222,"creation_date":1445500138,"answer_id":33275826,"question_id":33275717,"body_markdown":"You can check the url that is getting loaded in your webview by doing this.\r\n    \r\n    myWebView.setWebViewClient(new WebViewClient() {\r\n        @SuppressLint(&quot;NewApi&quot;)\r\n        @Override\r\n        public void onPageFinished(WebView view, String url) {\r\n            super.onPageFinished(view, url);\r\n        }\r\n        @Override\r\n        public void onPageStarted(WebView view, String url, Bitmap favicon) {\r\n            super.onPageStarted(view, url, favicon);\t\r\n        }\r\n    });","title":"Android Webview ERR_NAME_NOT_RESOLVED loading an URL","body":"<p>You can check the url that is getting loaded in your webview by doing this.</p>\n\n<pre><code>myWebView.setWebViewClient(new WebViewClient() {\n    @SuppressLint(\"NewApi\")\n    @Override\n    public void onPageFinished(WebView view, String url) {\n        super.onPageFinished(view, url);\n    }\n    @Override\n    public void onPageStarted(WebView view, String url, Bitmap favicon) {\n        super.onPageStarted(view, url, favicon);    \n    }\n});\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1558234,"reputation":503,"user_id":1448739,"accept_rate":23,"display_name":"Jarvis"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1452251654,"creation_date":1452251654,"answer_id":34675718,"question_id":33275717,"body_markdown":"You can ask the user to retry at that point of time either displaying there or by showing a popup with a message. If you get the network is strong enough load the same page again.","title":"Android Webview ERR_NAME_NOT_RESOLVED loading an URL","body":"<p>You can ask the user to retry at that point of time either displaying there or by showing a popup with a message. If you get the network is strong enough load the same page again.</p>\n"}],"owner":{"account_id":274791,"reputation":1249,"user_id":567235,"accept_rate":79,"display_name":"CoderRoller"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":16620,"favorite_count":0,"down_vote_count":0,"up_vote_count":5,"answer_count":2,"score":5,"last_activity_date":1694329320,"creation_date":1445499775,"question_id":33275717,"body_markdown":"I have an App made using Android `Webview`, while using Wifi connection the initial page loaded displays ok, after switching to mobile data mode, the application shows the `ERR_NAME_NOT_RESOLVED` message at times.\r\n\r\nIs there a workaround to hide this message until the page is correctly displayed? or to make it work when the connection is not good in the initial load?\r\n\r\nThanks for the insight.","title":"Android Webview ERR_NAME_NOT_RESOLVED loading an URL","body":"<p>I have an App made using Android <code>Webview</code>, while using Wifi connection the initial page loaded displays ok, after switching to mobile data mode, the application shows the <code>ERR_NAME_NOT_RESOLVED</code> message at times.</p>\n\n<p>Is there a workaround to hide this message until the page is correctly displayed? or to make it work when the connection is not good in the initial load?</p>\n\n<p>Thanks for the insight.</p>\n"},{"tags":["java","spring","spring-boot","spring-mvc","jetty"],"answers":[{"comments":[{"owner":{"account_id":21115744,"reputation":35,"user_id":15522868,"display_name":"javalanga"},"score":0,"creation_date":1694211010,"post_id":77068859,"comment_id":135866451,"body_markdown":"Thanks for your answer. But I can see that the WelcomePageHandlerMapping is not getting called if there is a controller mapping for such API path. How it can happen?","body":"Thanks for your answer. But I can see that the WelcomePageHandlerMapping is not getting called if there is a controller mapping for such API path. How it can happen?"},{"owner":{"account_id":1473276,"reputation":111009,"user_id":1384297,"accept_rate":100,"display_name":"Andy Wilkinson"},"score":0,"creation_date":1694327567,"post_id":77068859,"comment_id":135874977,"body_markdown":"@javalanga I’ve updated my answer to try to explain this","body":"@javalanga I’ve updated my answer to try to explain this"}],"tags":[],"owner":{"account_id":1473276,"reputation":111009,"user_id":1384297,"accept_rate":100,"display_name":"Andy Wilkinson"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1694327525,"creation_date":1694194097,"answer_id":77068859,"question_id":77066825,"body_markdown":"When a request is received, Spring MVC calls all registered handler mappings in order until one provides a handler for the request. \r\n\r\n`WelcomePageHandlerMapping` is ordered after the `RequestMappingHandlerMapping` so `WelcomePageHandlerMapping` will only be called if no `@RequestMapping` matches the request.\r\n\r\nWhen `WelcomePageHandlerMapping` is called it has to determine if it can provide a handler for the incoming request. Part of determining if it can do so is checking to see if the request will accept a `text/html` response. This check is done before checking that the path matches so the invalid `Accept` header causes a problem irrespective of the request&#39;s path.","title":"The Spring Boot&#39;s WelcomePageHandlerMapping is getting called on invalid API path where the 404 error expected","body":"<p>When a request is received, Spring MVC calls all registered handler mappings in order until one provides a handler for the request.</p>\n<p><code>WelcomePageHandlerMapping</code> is ordered after the <code>RequestMappingHandlerMapping</code> so <code>WelcomePageHandlerMapping</code> will only be called if no <code>@RequestMapping</code> matches the request.</p>\n<p>When <code>WelcomePageHandlerMapping</code> is called it has to determine if it can provide a handler for the incoming request. Part of determining if it can do so is checking to see if the request will accept a <code>text/html</code> response. This check is done before checking that the path matches so the invalid <code>Accept</code> header causes a problem irrespective of the request's path.</p>\n"}],"owner":{"account_id":21115744,"reputation":35,"user_id":15522868,"display_name":"javalanga"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":222,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":77068859,"answer_count":1,"score":2,"last_activity_date":1694327525,"creation_date":1694175488,"question_id":77066825,"body_markdown":"I have a simple Spring Boot (3.1.2) application with defined @RestController with several @GetMapping (`/app/test`, `/app/test2`).\r\n\r\nE.g:\r\n\r\n```\r\n@GetMapping(&quot;/test&quot;)\r\n    public TestModel getTestModel() {\r\n        return TestModel.builder()\r\n                .testModelName(&quot;The best test model ever!&quot;)\r\n                .testModelVersion(1)\r\n                .build();\r\n    }\r\n```\r\n\r\nSo when I&#39;m trying to send a request to my app using the incorrect API path and `Accept` header like this:\r\n\r\n`curl -X GET http://localhost:8080/random/incorrect -H &quot;Accept: yaml&quot;`\r\n\r\nInstead of expected 404 Not Found error, I&#39;m getting this exception:\r\n```\r\njakarta.servlet.ServletException: Request processing failed: org.springframework.http.InvalidMediaTypeException: Invalid mime type &quot;yaml&quot;: does not contain &#39;/&#39;\r\n\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1019) ~[spring-webmvc-6.0.11.jar:6.0.11]\r\n\tat org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.0.11.jar:6.0.11]\r\n\tat jakarta.servlet.http.HttpServlet.service(HttpServlet.java:500) ~[jakarta.servlet-api-5.0.0.jar:5.0.0]\r\n\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.11.jar:6.0.11]\r\n\tat jakarta.servlet.http.HttpServlet.service(HttpServlet.java:587) ~[jakarta.servlet-api-5.0.0.jar:5.0.0]\r\n\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:764) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1665) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.11.jar:6.0.11]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.11.jar:6.0.11]\r\n\tat org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.11.jar:6.0.11]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.11.jar:6.0.11]\r\n\tat org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.11.jar:6.0.11]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.11.jar:6.0.11]\r\n\tat org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.websocket.servlet.WebSocketUpgradeFilter.doFilter(WebSocketUpgradeFilter.java:170) ~[websocket-servlet-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:527) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:131) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:578) ~[jetty-security-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:223) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1570) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:221) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1381) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:176) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:484) ~[jetty-servlet-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1543) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:174) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1303) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:129) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.Server.handle(Server.java:563) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.HttpChannel.lambda$handle$0(HttpChannel.java:505) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:762) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:497) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:282) ~[jetty-server-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314) ~[jetty-io-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100) ~[jetty-io-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53) ~[jetty-io-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969) ~[jetty-util-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194) ~[jetty-util-11.0.15.jar:11.0.15]\r\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149) ~[jetty-util-11.0.15.jar:11.0.15]\r\n\tat java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]\r\nCaused by: org.springframework.http.InvalidMediaTypeException: Invalid mime type &quot;yaml&quot;: does not contain &#39;/&#39;\r\n\tat org.springframework.http.MediaType.parseMediaType(MediaType.java:742) ~[spring-web-6.0.11.jar:6.0.11]\r\n\tat org.springframework.http.MediaType.parseMediaTypes(MediaType.java:768) ~[spring-web-6.0.11.jar:6.0.11]\r\n\tat org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping.getAcceptedMediaTypes(WelcomePageHandlerMapping.java:82) ~[spring-boot-autoconfigure-3.1.2.jar:3.1.2]\r\n\tat org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping.isHtmlTextAccepted(WelcomePageHandlerMapping.java:71) ~[spring-boot-autoconfigure-3.1.2.jar:3.1.2]\r\n\tat org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping.getHandlerInternal(WelcomePageHandlerMapping.java:67) ~[spring-boot-autoconfigure-3.1.2.jar:3.1.2]\r\n\tat org.springframework.web.servlet.handler.AbstractHandlerMapping.getHandler(AbstractHandlerMapping.java:505) ~[spring-webmvc-6.0.11.jar:6.0.11]\r\n\tat org.springframework.web.servlet.DispatcherServlet.getHandler(DispatcherServlet.java:1275) ~[spring-webmvc-6.0.11.jar:6.0.11]\r\n\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1057) ~[spring-webmvc-6.0.11.jar:6.0.11]\r\n\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.11.jar:6.0.11]\r\n\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.11.jar:6.0.11]\r\n\t... 48 common frames omitted\r\n```\r\n\r\nAs I can see the `WelcomePageHandlerMapping` is getting called. So my question is: why is this handler getting called instead of returning the 404 error instantly?\r\n\r\n\r\n\r\nI tried to find some info in documentation but I had no luck.","title":"The Spring Boot&#39;s WelcomePageHandlerMapping is getting called on invalid API path where the 404 error expected","body":"<p>I have a simple Spring Boot (3.1.2) application with defined @RestController with several @GetMapping (<code>/app/test</code>, <code>/app/test2</code>).</p>\n<p>E.g:</p>\n<pre><code>@GetMapping(&quot;/test&quot;)\n    public TestModel getTestModel() {\n        return TestModel.builder()\n                .testModelName(&quot;The best test model ever!&quot;)\n                .testModelVersion(1)\n                .build();\n    }\n</code></pre>\n<p>So when I'm trying to send a request to my app using the incorrect API path and <code>Accept</code> header like this:</p>\n<p><code>curl -X GET http://localhost:8080/random/incorrect -H &quot;Accept: yaml&quot;</code></p>\n<p>Instead of expected 404 Not Found error, I'm getting this exception:</p>\n<pre><code>jakarta.servlet.ServletException: Request processing failed: org.springframework.http.InvalidMediaTypeException: Invalid mime type &quot;yaml&quot;: does not contain '/'\n    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1019) ~[spring-webmvc-6.0.11.jar:6.0.11]\n    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.0.11.jar:6.0.11]\n    at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:500) ~[jakarta.servlet-api-5.0.0.jar:5.0.0]\n    at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.11.jar:6.0.11]\n    at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:587) ~[jakarta.servlet-api-5.0.0.jar:5.0.0]\n    at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:764) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1665) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.11.jar:6.0.11]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.11.jar:6.0.11]\n    at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.11.jar:6.0.11]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.11.jar:6.0.11]\n    at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.11.jar:6.0.11]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.11.jar:6.0.11]\n    at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.websocket.servlet.WebSocketUpgradeFilter.doFilter(WebSocketUpgradeFilter.java:170) ~[websocket-servlet-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:527) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:131) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:578) ~[jetty-security-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:223) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1570) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:221) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1381) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:176) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:484) ~[jetty-servlet-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1543) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:174) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1303) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:129) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.Server.handle(Server.java:563) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.HttpChannel.lambda$handle$0(HttpChannel.java:505) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:762) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:497) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:282) ~[jetty-server-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314) ~[jetty-io-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100) ~[jetty-io-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53) ~[jetty-io-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969) ~[jetty-util-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194) ~[jetty-util-11.0.15.jar:11.0.15]\n    at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149) ~[jetty-util-11.0.15.jar:11.0.15]\n    at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]\nCaused by: org.springframework.http.InvalidMediaTypeException: Invalid mime type &quot;yaml&quot;: does not contain '/'\n    at org.springframework.http.MediaType.parseMediaType(MediaType.java:742) ~[spring-web-6.0.11.jar:6.0.11]\n    at org.springframework.http.MediaType.parseMediaTypes(MediaType.java:768) ~[spring-web-6.0.11.jar:6.0.11]\n    at org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping.getAcceptedMediaTypes(WelcomePageHandlerMapping.java:82) ~[spring-boot-autoconfigure-3.1.2.jar:3.1.2]\n    at org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping.isHtmlTextAccepted(WelcomePageHandlerMapping.java:71) ~[spring-boot-autoconfigure-3.1.2.jar:3.1.2]\n    at org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping.getHandlerInternal(WelcomePageHandlerMapping.java:67) ~[spring-boot-autoconfigure-3.1.2.jar:3.1.2]\n    at org.springframework.web.servlet.handler.AbstractHandlerMapping.getHandler(AbstractHandlerMapping.java:505) ~[spring-webmvc-6.0.11.jar:6.0.11]\n    at org.springframework.web.servlet.DispatcherServlet.getHandler(DispatcherServlet.java:1275) ~[spring-webmvc-6.0.11.jar:6.0.11]\n    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1057) ~[spring-webmvc-6.0.11.jar:6.0.11]\n    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.11.jar:6.0.11]\n    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.11.jar:6.0.11]\n    ... 48 common frames omitted\n</code></pre>\n<p>As I can see the <code>WelcomePageHandlerMapping</code> is getting called. So my question is: why is this handler getting called instead of returning the 404 error instantly?</p>\n<p>I tried to find some info in documentation but I had no luck.</p>\n"},{"tags":["java","lombok"],"comments":[{"owner":{"account_id":19900384,"reputation":81,"user_id":14580500,"display_name":"ash"},"score":0,"creation_date":1694261920,"post_id":77072135,"comment_id":135870035,"body_markdown":"How about the use the Optional  to pack your object ，the Optional class is supported after Java8","body":"How about the use the Optional  to pack your object ，the Optional class is supported after Java8"},{"owner":{"account_id":143734,"reputation":791,"user_id":352290,"accept_rate":100,"display_name":"user352290"},"score":0,"creation_date":1694262974,"post_id":77072135,"comment_id":135870148,"body_markdown":"syndImage itself is null, how to handle it elegantly and return null","body":"syndImage itself is null, how to handle it elegantly and return null"},{"owner":{"account_id":19900384,"reputation":81,"user_id":14580500,"display_name":"ash"},"score":1,"creation_date":1694263862,"post_id":77072135,"comment_id":135870235,"body_markdown":"String s = null;\nString trim = Optional.ofNullable(s).orElse(&quot;&quot;).trim();","body":"String s = null; String trim = Optional.ofNullable(s).orElse(&quot;&quot;).trim();"},{"owner":{"account_id":19900384,"reputation":81,"user_id":14580500,"display_name":"ash"},"score":0,"creation_date":1694263966,"post_id":77072135,"comment_id":135870242,"body_markdown":"Like the up code , if don&#39;t use the Optional,it may say NullPointException,but like the code ,it can replace the empty object to a default object to avoid the NullPoint","body":"Like the up code , if don&#39;t use the Optional,it may say NullPointException,but like the code ,it can replace the empty object to a default object to avoid the NullPoint"},{"owner":{"account_id":143734,"reputation":791,"user_id":352290,"accept_rate":100,"display_name":"user352290"},"score":0,"creation_date":1694264064,"post_id":77072135,"comment_id":135870253,"body_markdown":"syndImage is null and its not a string","body":"syndImage is null and its not a string"},{"owner":{"account_id":19900384,"reputation":81,"user_id":14580500,"display_name":"ash"},"score":0,"creation_date":1694264582,"post_id":77072135,"comment_id":135870306,"body_markdown":"The string can replace by your syndImage ... I don&#39;t defined a object like syndImage ...","body":"The string can replace by your syndImage ... I don&#39;t defined a object like syndImage ..."}],"answers":[{"comments":[{"owner":{"account_id":143734,"reputation":791,"user_id":352290,"accept_rate":100,"display_name":"user352290"},"score":1,"creation_date":1694263846,"post_id":77072321,"comment_id":135870230,"body_markdown":"I don&#39;t want to build the object if input is null and just return null","body":"I don&#39;t want to build the object if input is null and just return null"},{"owner":{"account_id":29401700,"reputation":11,"user_id":22527733,"display_name":"saribasrana"},"score":1,"creation_date":1694264244,"post_id":77072321,"comment_id":135870265,"body_markdown":"oh then this comes to mind &#39;return syndImage == null ? null : return Image.builder()...&#39;","body":"oh then this comes to mind &#39;return syndImage == null ? null : return Image.builder()...&#39;"},{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":0,"creation_date":1694288750,"post_id":77072321,"comment_id":135872690,"body_markdown":"@user352290 Your title and question are not clear. They could use some editing.","body":"@user352290 Your title and question are not clear. They could use some editing."}],"tags":[],"owner":{"account_id":29401700,"reputation":11,"user_id":22527733,"display_name":"saribasrana"},"comment_count":3,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694263770,"creation_date":1694263731,"answer_id":77072321,"question_id":77072135,"body_markdown":"You can use requireNonNullElse() like this:\r\n\r\n    return Image.builder()\r\n    .title(Objects.requireNonNullElse(syndImage.getTitle(), &quot;Default Title&quot;))\r\n    .url(Objects.requireNonNullElse(syndImage.getUrl(), &quot;Default URL&quot;))\r\n    .build();","title":"How to convert to an Object by handling null inputs","body":"<p>You can use requireNonNullElse() like this:</p>\n<pre><code>return Image.builder()\n.title(Objects.requireNonNullElse(syndImage.getTitle(), &quot;Default Title&quot;))\n.url(Objects.requireNonNullElse(syndImage.getUrl(), &quot;Default URL&quot;))\n.build();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694289912,"creation_date":1694289133,"answer_id":77073836,"question_id":77072135,"body_markdown":"## Use the builder\r\n\r\n[You commented][1]:\r\n\r\n&gt;I don&#39;t want to build the object if input is null and just return null \r\n\r\nSounds like a job for your Builder. That is one purpose of a builder: Verify inputs before constructing an object. \r\n\r\nSo if you don&#39;t like one of the inputs (`null`, whatever), have `Image.builder().….build()` return `null`. \r\n\r\nOr better, have it return an empty [`Optional&lt; Image &gt;`][2] object. The point of `Optional` is to flag to the calling programmer that a null value is a legitimate result. \r\n\r\n```java\r\npublic static Optional&lt; Image &gt; convert(SyndImage syndImage) {\r\n    return Image.builder()\r\n        .title(syndImage.getTitle())\r\n        .url(syndImage.getUrl())\r\n        .build();\r\n}  \r\n```\r\n\r\nInside your builder code:\r\n\r\n```java\r\nif ( Objects.isNull( url ) ) { return Optional.empty() ; }\r\n```\r\n\r\nThe calling code checks to see if they received an `Image` object in the payload.\r\n\r\n```java\r\nif( optionalImage.isPresent() ) { … }\r\n```\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/77072135/how-to-convert-to-an-object-by-handling-null-inputs/77073836#comment135870230_77072321\r\n  [2]: https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/Optional.html","title":"How to convert to an Object by handling null inputs","body":"<h2>Use the builder</h2>\n<p><a href=\"https://stackoverflow.com/questions/77072135/how-to-convert-to-an-object-by-handling-null-inputs/77073836#comment135870230_77072321\">You commented</a>:</p>\n<blockquote>\n<p>I don't want to build the object if input is null and just return null</p>\n</blockquote>\n<p>Sounds like a job for your Builder. That is one purpose of a builder: Verify inputs before constructing an object.</p>\n<p>So if you don't like one of the inputs (<code>null</code>, whatever), have <code>Image.builder().….build()</code> return <code>null</code>.</p>\n<p>Or better, have it return an empty <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/Optional.html\" rel=\"nofollow noreferrer\"><code>Optional&lt; Image &gt;</code></a> object. The point of <code>Optional</code> is to flag to the calling programmer that a null value is a legitimate result.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static Optional&lt; Image &gt; convert(SyndImage syndImage) {\n    return Image.builder()\n        .title(syndImage.getTitle())\n        .url(syndImage.getUrl())\n        .build();\n}  \n</code></pre>\n<p>Inside your builder code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>if ( Objects.isNull( url ) ) { return Optional.empty() ; }\n</code></pre>\n<p>The calling code checks to see if they received an <code>Image</code> object in the payload.</p>\n<pre class=\"lang-java prettyprint-override\"><code>if( optionalImage.isPresent() ) { … }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":13993199,"reputation":129,"user_id":10362945,"display_name":"Sagar"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694326907,"creation_date":1694326907,"answer_id":77075011,"question_id":77072135,"body_markdown":"Assuming you have limitations to update existing builder or refactor to optional return for getImage,you could implement as below\r\n```\r\nimport lombok.Data;\r\nimport org.junit.jupiter.api.Assertions;\r\n\r\nimport java.util.Objects;\r\nimport java.util.Optional;\r\n\r\n@Data\r\nclass SyndImage{\r\n    String title;\r\n    String url;\r\n\r\n    public SyndImage(String title, String url) {\r\n        this.title = title;\r\n        this.url = url;\r\n    }\r\n\r\n    public SyndImage(String title) {\r\n        this.title = title;\r\n    }\r\n\r\n    public SyndImage() {\r\n\r\n    }\r\n}\r\nclass Image{}\r\npublic class OptionalUtility {\r\n\r\n    public static void main(String[] args) {\r\n\r\n        Assertions.assertNull(getImage(new SyndImage()));//null fields\r\n        //SyndImage allFileds = new SyndImage(&quot;MyTitle1&quot;, &quot;Url1&quot;);\r\n        Assertions.assertNotNull(getImage(new SyndImage(&quot;MyTitle1&quot;, &quot;Url1&quot;)));//all fields\r\n\r\n        //SyndImage title = new SyndImage(&quot;Title&quot;);\r\n        Assertions.assertNull(getImage(new SyndImage(&quot;Title&quot;)));//only title field is available\r\n        \r\n        Assertions.assertNull(getImage(null));//null fields\r\n        \r\n    }\r\n\r\n    private static Image getImage(SyndImage syndImage) {\r\n       return Optional.ofNullable(syndImage)\r\n                .filter(sImage-&gt; Objects.nonNull(sImage.getTitle()))//if field checks are also required\r\n                .filter(sImage-&gt;Objects.nonNull(sImage.getUrl()))\r\n                .map(sImage-&gt;iamgeBuilderMethod(sImage))\r\n                .orElse(null);//this is generally not recommended\r\n    }\r\n\r\n    private static Image iamgeBuilderMethod(SyndImage sImage) {\r\n       /* return Image.builder()\r\n                .title(syndImage.getTitle())\r\n                .url(syndImage.getUrl())\r\n                .build();*/\r\n        System.out.println(&quot;Image created&quot;);\r\n        return new Image();//this will be your existing convert method\r\n    }\r\n}\r\n```","title":"How to convert to an Object by handling null inputs","body":"<p>Assuming you have limitations to update existing builder or refactor to optional return for getImage,you could implement as below</p>\n<pre><code>import lombok.Data;\nimport org.junit.jupiter.api.Assertions;\n\nimport java.util.Objects;\nimport java.util.Optional;\n\n@Data\nclass SyndImage{\n    String title;\n    String url;\n\n    public SyndImage(String title, String url) {\n        this.title = title;\n        this.url = url;\n    }\n\n    public SyndImage(String title) {\n        this.title = title;\n    }\n\n    public SyndImage() {\n\n    }\n}\nclass Image{}\npublic class OptionalUtility {\n\n    public static void main(String[] args) {\n\n        Assertions.assertNull(getImage(new SyndImage()));//null fields\n        //SyndImage allFileds = new SyndImage(&quot;MyTitle1&quot;, &quot;Url1&quot;);\n        Assertions.assertNotNull(getImage(new SyndImage(&quot;MyTitle1&quot;, &quot;Url1&quot;)));//all fields\n\n        //SyndImage title = new SyndImage(&quot;Title&quot;);\n        Assertions.assertNull(getImage(new SyndImage(&quot;Title&quot;)));//only title field is available\n        \n        Assertions.assertNull(getImage(null));//null fields\n        \n    }\n\n    private static Image getImage(SyndImage syndImage) {\n       return Optional.ofNullable(syndImage)\n                .filter(sImage-&gt; Objects.nonNull(sImage.getTitle()))//if field checks are also required\n                .filter(sImage-&gt;Objects.nonNull(sImage.getUrl()))\n                .map(sImage-&gt;iamgeBuilderMethod(sImage))\n                .orElse(null);//this is generally not recommended\n    }\n\n    private static Image iamgeBuilderMethod(SyndImage sImage) {\n       /* return Image.builder()\n                .title(syndImage.getTitle())\n                .url(syndImage.getUrl())\n                .build();*/\n        System.out.println(&quot;Image created&quot;);\n        return new Image();//this will be your existing convert method\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":143734,"reputation":791,"user_id":352290,"accept_rate":100,"display_name":"user352290"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":56,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":3,"score":0,"last_activity_date":1694326907,"creation_date":1694261165,"question_id":77072135,"body_markdown":"How to convert to an Object by handling null inputs, is there a way to check for null inputs and return null without writing the if check for null;\r\n\r\n    public static Image convert(SyndImage syndImage) {\r\n        return Image.builder()\r\n            .title(syndImage.getTitle())\r\n            .url(syndImage.getUrl())\r\n            .build();\r\n    }  ","title":"How to convert to an Object by handling null inputs","body":"<p>How to convert to an Object by handling null inputs, is there a way to check for null inputs and return null without writing the if check for null;</p>\n<pre><code>public static Image convert(SyndImage syndImage) {\n    return Image.builder()\n        .title(syndImage.getTitle())\n        .url(syndImage.getUrl())\n        .build();\n}  \n</code></pre>\n"},{"tags":["java","android","android-studio","gradle","build.gradle"],"comments":[{"owner":{"account_id":442814,"reputation":23181,"user_id":833647,"display_name":"Ken Wolf"},"score":0,"creation_date":1678721112,"post_id":75723748,"comment_id":133584116,"body_markdown":"Try reboot, delete that .lck file, and try again","body":"Try reboot, delete that .lck file, and try again"}],"answers":[{"comments":[{"owner":{"account_id":11736217,"reputation":1036,"user_id":9878385,"display_name":"Karatekid430"},"score":0,"creation_date":1696482592,"post_id":76145179,"comment_id":136159113,"body_markdown":"Finally a correct answer, thanks! I wonder how that ended up as &#39;/sdk&#39; for me, this is a new installation.","body":"Finally a correct answer, thanks! I wonder how that ended up as &#39;/sdk&#39; for me, this is a new installation."}],"tags":[],"owner":{"account_id":15087538,"reputation":161,"user_id":10888323,"display_name":"Joel Kanyi"},"comment_count":1,"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1694326467,"creation_date":1682923705,"answer_id":76145179,"question_id":75723748,"body_markdown":"Make your Gradle User Home to be empty [![Make your Gradle User Home to be empty][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/TTuMs.png\r\n\r\nThen restart Android Studio and sync. Gradle error will be gone.","title":"gradle error in android studio: Could not create parent directory for lock file","body":"<p>Make your Gradle User Home to be empty <a href=\"https://i.stack.imgur.com/TTuMs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TTuMs.png\" alt=\"Make your Gradle User Home to be empty\" /></a></p>\n<p>Then restart Android Studio and sync. Gradle error will be gone.</p>\n"}],"owner":{"account_id":24541871,"reputation":1,"user_id":18452158,"display_name":"Harshit Sah"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":920,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694326467,"creation_date":1678720531,"question_id":75723748,"body_markdown":"**Gradle Error** : Could not create parent directory for lock file.\r\n\r\n\r\n**Could not create parent directory for lock file D:\\PROGRAM FILES\\ANDROID\\jbr\\wrapper\\dists\\gradle-7.5-bin\\f1w0cc9nuo0eivz97x2xlu9sv\\gradle-7.5-bin.zip.lck**\r\n\r\n\r\n**While building or syncing my app, the Gradle shows this error.** \r\n\r\n**Please help me with this error.**","title":"gradle error in android studio: Could not create parent directory for lock file","body":"<p><strong>Gradle Error</strong> : Could not create parent directory for lock file.</p>\n<p><strong>Could not create parent directory for lock file D:\\PROGRAM FILES\\ANDROID\\jbr\\wrapper\\dists\\gradle-7.5-bin\\f1w0cc9nuo0eivz97x2xlu9sv\\gradle-7.5-bin.zip.lck</strong></p>\n<p><strong>While building or syncing my app, the Gradle shows this error.</strong></p>\n<p><strong>Please help me with this error.</strong></p>\n"},{"tags":["java","ssl","db2","connection","driver"],"comments":[{"owner":{"account_id":6780825,"reputation":155680,"user_id":5221149,"display_name":"Andreas"},"score":0,"creation_date":1533565609,"post_id":51709836,"comment_id":90380893,"body_markdown":"``\\`` is an escape character in a Java string literal, so you need to double them: `DriverManager.getConnection(&quot;jdbc:db2://[host]:[port]/[databaseName]:sslConnection=true;sslTrustStoreLocation=c:\\\\db2_ssl\\\\db2.jks;sslTrustStorePassword=teste123;&quot;, &quot;myuser&quot;, &quot;mypassword&quot;);`","body":"<code>\\</code> is an escape character in a Java string literal, so you need to double them: <code>DriverManager.getConnection(&quot;jdbc:db2:&#47;&#47;[host]:[port]&#47;[datab&zwnj;&#8203;aseName]:sslConnecti&zwnj;&#8203;on=true;sslTrustStor&zwnj;&#8203;eLocation=c:\\\\db2_ss&zwnj;&#8203;l\\\\db2.jks;sslTrustS&zwnj;&#8203;torePassword=teste12&zwnj;&#8203;3;&quot;, &quot;myuser&quot;, &quot;mypassword&quot;);</code>"},{"owner":{"account_id":11306067,"reputation":11409,"user_id":8290634,"display_name":"mao"},"score":0,"creation_date":1533566055,"post_id":51709836,"comment_id":90381211,"body_markdown":"You are also using an unsupported  out of date jdbc driver (3.64.96) which dates from V9.5 fp10.  That&#39;s not the cause of your symptom however. But consider using supported versions. The -4499 can happen when you are not connecting to the port configured for SSL at the target Db2-instance.","body":"You are also using an unsupported  out of date jdbc driver (3.64.96) which dates from V9.5 fp10.  That&#39;s not the cause of your symptom however. But consider using supported versions. The -4499 can happen when you are not connecting to the port configured for SSL at the target Db2-instance."},{"owner":{"account_id":6349671,"reputation":178,"user_id":4929141,"display_name":"THIAGORC"},"score":0,"creation_date":1533573647,"post_id":51709836,"comment_id":90385654,"body_markdown":"Hi Andreas.\nI already tried it, still got the same issue.\n\nAny other ideas?","body":"Hi Andreas. I already tried it, still got the same issue.  Any other ideas?"},{"owner":{"account_id":6349671,"reputation":178,"user_id":4929141,"display_name":"THIAGORC"},"score":0,"creation_date":1533574027,"post_id":51709836,"comment_id":90385829,"body_markdown":"Hi @mao, I tried to update to the latest db2 driver (10.1) and still got the same issue.","body":"Hi @mao, I tried to update to the latest db2 driver (10.1) and still got the same issue."},{"owner":{"account_id":11306067,"reputation":11409,"user_id":8290634,"display_name":"mao"},"score":0,"creation_date":1533575646,"post_id":51709836,"comment_id":90386616,"body_markdown":"V10.1 is also out of support (since 30/Sept/2017). The latest Db2 jdbc driver is V11.1.3.3 at current date. Verify the JKS has the signer (CA) certificate(s) in addition to the certificate, if the cert is not self-signed. Verify that all certs are valid and unexpired and not revoked. Verify that your JVM/jdk are up to date(at least Java 8)","body":"V10.1 is also out of support (since 30/Sept/2017). The latest Db2 jdbc driver is V11.1.3.3 at current date. Verify the JKS has the signer (CA) certificate(s) in addition to the certificate, if the cert is not self-signed. Verify that all certs are valid and unexpired and not revoked. Verify that your JVM/jdk are up to date(at least Java 8)"}],"answers":[{"tags":[],"owner":{"account_id":6349671,"reputation":178,"user_id":4929141,"display_name":"THIAGORC"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1533581763,"creation_date":1533581763,"answer_id":51714001,"question_id":51709836,"body_markdown":"Appreciate all responses.\r\nAfter several tests I could realize that the &quot;problem&quot; is on JDK.\r\nI changed to use JDK 1.8 and it worked successfully.\r\n\r\nNot sure if we have a workaround for other JDK versions.\r\n\r\nThank you.","title":"DB2 JDBC SSL Connection","body":"<p>Appreciate all responses.\nAfter several tests I could realize that the \"problem\" is on JDK.\nI changed to use JDK 1.8 and it worked successfully.</p>\n\n<p>Not sure if we have a workaround for other JDK versions.</p>\n\n<p>Thank you.</p>\n"}],"owner":{"account_id":6349671,"reputation":178,"user_id":4929141,"display_name":"THIAGORC"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":16067,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"answer_count":1,"score":1,"last_activity_date":1694325735,"creation_date":1533565359,"question_id":51709836,"body_markdown":"Recently our partner have updated their database environment to use SSL, and we need to update our application config in order to establish the connection with the database.\r\n\r\nI have generated the JKS file and also have imported the certificates to the JKS.\r\n\r\nWhen I use SQL Squirrel connection string:\r\n\r\n&gt; jdbc:db2://[host]:[port]/[databaseName]:sslConnection=true;sslTrustStoreLocation=c:\\db2_ssl\\db2.jks;sslTrustStorePassword=teste123;\r\n\r\nIt connectes successfully.\r\n\r\nIf I use the exact the same connection string:\r\n\r\n    Connection connection = DriverManager.getConnection(&quot;jdbc:db2://[host]:[port]/[databaseName]:sslConnection=true;sslTrustStoreLocation=c:\\db2_ssl\\db2.jks;sslTrustStorePassword=teste123;&quot;, &quot;myuser&quot;, &quot;mypassword&quot;);\r\n\r\nIt throws me the exception as follows:\r\n\r\n    com.ibm.db2.jcc.am.DisconnectNonTransientConnectionException: [jcc][t4][2030][11211][3.64.96] A communication error occurred during operations on the connection&#39;s underlying socket, socket input stream, \r\n    or socket output stream.  Error location: T4Agent.sendRequest() - flush (-1).  Message: Received fatal alert: handshake_failure. ERRORCODE=-4499, SQLSTATE=08001\r\n    \tat com.ibm.db2.jcc.am.bd.a(bd.java:321)\r\n    \tat com.ibm.db2.jcc.t4.a.a(a.java:548)\r\n    \tat com.ibm.db2.jcc.t4.a.a(a.java:543)\r\n    \tat com.ibm.db2.jcc.t4.a.f(a.java:484)\r\n    \tat com.ibm.db2.jcc.t4.a.flush_(a.java:390)\r\n    \tat com.ibm.db2.jcc.am.Agent.flowOutsideUOW(Agent.java:246)\r\n    \tat com.ibm.db2.jcc.t4.b.b(b.java:1220)\r\n    \tat com.ibm.db2.jcc.t4.b.b(b.java:788)\r\n    \tat com.ibm.db2.jcc.t4.b.a(b.java:760)\r\n    \tat com.ibm.db2.jcc.t4.b.a(b.java:421)\r\n    \tat com.ibm.db2.jcc.t4.b.a(b.java:396)\r\n    \tat com.ibm.db2.jcc.t4.b.&lt;init&gt;(b.java:334)\r\n    \tat com.ibm.db2.jcc.DB2SimpleDataSource.getConnection(DB2SimpleDataSource.java:232)\r\n    \tat com.ibm.db2.jcc.DB2SimpleDataSource.getConnection(DB2SimpleDataSource.java:198)\r\n    \tat com.ibm.db2.jcc.DB2Driver.connect(DB2Driver.java:475)\r\n    \tat com.ibm.db2.jcc.DB2Driver.connect(DB2Driver.java:116)\r\n    \tat java.sql.DriverManager.getConnection(DriverManager.java:379)\r\n    \tat java.sql.DriverManager.getConnection(DriverManager.java:415)\r\n    \tat com.ibm.sdpi.wmb.flows.productdata.ProductDataAnnouncementNode.evaluate(ProductDataAnnouncementNode.java:93)\r\n    \tat com.ibm.broker.javacompute.MbRuntimeJavaComputeNode.evaluate(MbRuntimeJavaComputeNode.java:265)\r\n    \tat com.ibm.broker.plugin.MbNode.evaluate(MbNode.java:1480)\r\n    \tat com.ibm.broker.plugin.MbOutputTerminal._propagate(Native Method)\r\n    \tat com.ibm.broker.plugin.MbOutputTerminal.propagate(MbOutputTerminal.java:114)\r\n    \tat com.ibm.sdpi.wmb.flows.common.SDPIOutboundCommon_JavaCompute.evaluate(SDPIOutboundCommon_JavaCompute.java:226)\r\n    \tat com.ibm.broker.javacompute.MbRuntimeJavaComputeNode.evaluate(MbRuntimeJavaComputeNode.java:265)\r\n    \tat com.ibm.broker.plugin.MbNode.evaluate(MbNode.java:1480)\r\n    Caused by: javax.net.ssl.SSLHandshakeException: Received fatal alert: handshake_failure\r\n    \tat com.ibm.jsse2.o.a(o.java:22)\r\n    \tat com.ibm.jsse2.o.a(o.java:34)\r\n    \tat com.ibm.jsse2.SSLSocketImpl.b(SSLSocketImpl.java:378)\r\n    \tat com.ibm.jsse2.SSLSocketImpl.a(SSLSocketImpl.java:479)\r\n    \tat com.ibm.jsse2.SSLSocketImpl.h(SSLSocketImpl.java:437)\r\n    \tat com.ibm.jsse2.SSLSocketImpl.a(SSLSocketImpl.java:772)\r\n    \tat com.ibm.jsse2.k.write(k.java:3)\r\n    \tat com.ibm.db2.jcc.t4.db.b(db.java:1685)\r\n    \tat com.ibm.db2.jcc.t4.db.a(db.java:1633)\r\n    \tat com.ibm.db2.jcc.t4.a.f(a.java:451)\r\n    \t... 22 more\r\n\r\nI am using the exact same DB2 drivers in SQL Squirrel and application.\r\n\r\nWhy it does work in SQL Squirrel and it doesn&#39;t using DriverManager?\r\n\r\nDo you have any ideas how to connect to a remote DB2 database using SSL?\r\n\r\nThanks in advance.","title":"DB2 JDBC SSL Connection","body":"<p>Recently our partner have updated their database environment to use SSL, and we need to update our application config in order to establish the connection with the database.</p>\n\n<p>I have generated the JKS file and also have imported the certificates to the JKS.</p>\n\n<p>When I use SQL Squirrel connection string:</p>\n\n<blockquote>\n  <p>jdbc:db2://[host]:[port]/[databaseName]:sslConnection=true;sslTrustStoreLocation=c:\\db2_ssl\\db2.jks;sslTrustStorePassword=teste123;</p>\n</blockquote>\n\n<p>It connectes successfully.</p>\n\n<p>If I use the exact the same connection string:</p>\n\n<pre><code>Connection connection = DriverManager.getConnection(\"jdbc:db2://[host]:[port]/[databaseName]:sslConnection=true;sslTrustStoreLocation=c:\\db2_ssl\\db2.jks;sslTrustStorePassword=teste123;\", \"myuser\", \"mypassword\");\n</code></pre>\n\n<p>It throws me the exception as follows:</p>\n\n<pre><code>com.ibm.db2.jcc.am.DisconnectNonTransientConnectionException: [jcc][t4][2030][11211][3.64.96] A communication error occurred during operations on the connection's underlying socket, socket input stream, \nor socket output stream.  Error location: T4Agent.sendRequest() - flush (-1).  Message: Received fatal alert: handshake_failure. ERRORCODE=-4499, SQLSTATE=08001\n    at com.ibm.db2.jcc.am.bd.a(bd.java:321)\n    at com.ibm.db2.jcc.t4.a.a(a.java:548)\n    at com.ibm.db2.jcc.t4.a.a(a.java:543)\n    at com.ibm.db2.jcc.t4.a.f(a.java:484)\n    at com.ibm.db2.jcc.t4.a.flush_(a.java:390)\n    at com.ibm.db2.jcc.am.Agent.flowOutsideUOW(Agent.java:246)\n    at com.ibm.db2.jcc.t4.b.b(b.java:1220)\n    at com.ibm.db2.jcc.t4.b.b(b.java:788)\n    at com.ibm.db2.jcc.t4.b.a(b.java:760)\n    at com.ibm.db2.jcc.t4.b.a(b.java:421)\n    at com.ibm.db2.jcc.t4.b.a(b.java:396)\n    at com.ibm.db2.jcc.t4.b.&lt;init&gt;(b.java:334)\n    at com.ibm.db2.jcc.DB2SimpleDataSource.getConnection(DB2SimpleDataSource.java:232)\n    at com.ibm.db2.jcc.DB2SimpleDataSource.getConnection(DB2SimpleDataSource.java:198)\n    at com.ibm.db2.jcc.DB2Driver.connect(DB2Driver.java:475)\n    at com.ibm.db2.jcc.DB2Driver.connect(DB2Driver.java:116)\n    at java.sql.DriverManager.getConnection(DriverManager.java:379)\n    at java.sql.DriverManager.getConnection(DriverManager.java:415)\n    at com.ibm.sdpi.wmb.flows.productdata.ProductDataAnnouncementNode.evaluate(ProductDataAnnouncementNode.java:93)\n    at com.ibm.broker.javacompute.MbRuntimeJavaComputeNode.evaluate(MbRuntimeJavaComputeNode.java:265)\n    at com.ibm.broker.plugin.MbNode.evaluate(MbNode.java:1480)\n    at com.ibm.broker.plugin.MbOutputTerminal._propagate(Native Method)\n    at com.ibm.broker.plugin.MbOutputTerminal.propagate(MbOutputTerminal.java:114)\n    at com.ibm.sdpi.wmb.flows.common.SDPIOutboundCommon_JavaCompute.evaluate(SDPIOutboundCommon_JavaCompute.java:226)\n    at com.ibm.broker.javacompute.MbRuntimeJavaComputeNode.evaluate(MbRuntimeJavaComputeNode.java:265)\n    at com.ibm.broker.plugin.MbNode.evaluate(MbNode.java:1480)\nCaused by: javax.net.ssl.SSLHandshakeException: Received fatal alert: handshake_failure\n    at com.ibm.jsse2.o.a(o.java:22)\n    at com.ibm.jsse2.o.a(o.java:34)\n    at com.ibm.jsse2.SSLSocketImpl.b(SSLSocketImpl.java:378)\n    at com.ibm.jsse2.SSLSocketImpl.a(SSLSocketImpl.java:479)\n    at com.ibm.jsse2.SSLSocketImpl.h(SSLSocketImpl.java:437)\n    at com.ibm.jsse2.SSLSocketImpl.a(SSLSocketImpl.java:772)\n    at com.ibm.jsse2.k.write(k.java:3)\n    at com.ibm.db2.jcc.t4.db.b(db.java:1685)\n    at com.ibm.db2.jcc.t4.db.a(db.java:1633)\n    at com.ibm.db2.jcc.t4.a.f(a.java:451)\n    ... 22 more\n</code></pre>\n\n<p>I am using the exact same DB2 drivers in SQL Squirrel and application.</p>\n\n<p>Why it does work in SQL Squirrel and it doesn't using DriverManager?</p>\n\n<p>Do you have any ideas how to connect to a remote DB2 database using SSL?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["java","spring"],"comments":[{"owner":{"account_id":551394,"reputation":8315,"user_id":916225,"accept_rate":69,"display_name":"seenukarthi"},"score":0,"creation_date":1564552032,"post_id":57283758,"comment_id":101063138,"body_markdown":"What is the type of the Object returned by `resetDatabase_H2();` and `resetDatabase_Postgresql();`","body":"What is the type of the Object returned by <code>resetDatabase_H2();</code> and <code>resetDatabase_Postgresql();</code>"},{"owner":{"account_id":11430866,"reputation":928,"user_id":8379612,"display_name":"Pratik"},"score":0,"creation_date":1564553900,"post_id":57283758,"comment_id":101063859,"body_markdown":"@KarthikeyanVaithilingam Runnable. However resetDatabase_Postgresql always returns null.","body":"@KarthikeyanVaithilingam Runnable. However resetDatabase_Postgresql always returns null."},{"owner":{"account_id":551394,"reputation":8315,"user_id":916225,"accept_rate":69,"display_name":"seenukarthi"},"score":1,"creation_date":1564556323,"post_id":57283758,"comment_id":101064901,"body_markdown":"Then you have to investigate why ` resetDatabase_Postgresql` is returning null.","body":"Then you have to investigate why ` resetDatabase_Postgresql` is returning null."}],"answers":[{"tags":[],"owner":{"account_id":9983336,"reputation":4132,"user_id":7769052,"accept_rate":75,"display_name":"banan3&#39;14"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694325420,"creation_date":1694325420,"answer_id":77074968,"question_id":57283758,"body_markdown":"If `resetDatabase_Postgresql` can return `null`, then you can wrap it into an optional and return a runnable that does nothing in that case:\r\n&lt;!-- language: java --&gt;\r\n\r\n    return Optional.ofNullable(resetDatabase_Postgresql()).orElse(() -&gt; {});","title":"Bean named X is expected to be of type &#39;java.lang.Runnable&#39; but was actually of type &#39;org.springframework.beans.factory.support.NullBean&#39;","body":"<p>If <code>resetDatabase_Postgresql</code> can return <code>null</code>, then you can wrap it into an optional and return a runnable that does nothing in that case:</p>\n<pre class=\"lang-java prettyprint-override\"><code>return Optional.ofNullable(resetDatabase_Postgresql()).orElse(() -&gt; {});\n</code></pre>\n"}],"owner":{"account_id":11430866,"reputation":928,"user_id":8379612,"display_name":"Pratik"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1147,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694325420,"creation_date":1564550706,"question_id":57283758,"body_markdown":"Spring is giving me below error, but can&#39;t figure out why is it ! \r\n\r\nNote: There is no bean definition in xml file for this.\r\n\r\n&gt; Bean named &#39;resetDatabase&#39; is expected to be of type\r\n&gt; &#39;java.lang.Runnable&#39; but was actually of type\r\n&gt; &#39;org.springframework.beans.factory.support.NullBean&#39;\r\n\r\n    @Bean\r\n    Runnable resetDatabase() throws Exception\r\n    {\r\n    \tif (env.acceptsProfiles(&quot;prof&quot;))\r\n    \t{\r\n    \t\treturn resetDatabase_H2();\r\n    \t}\r\n    \telse\r\n    \t{\r\n    \t\t// return resetDatabase_H2();\r\n    \t\treturn resetDatabase_Postgresql();\r\n    \t}\r\n    }\r\n\r\nI referred [this][1] as well but couldn&#39;t find any solution for my case\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/14545872/bean-named-xxx-must-be-of-typexxx-but-was-actually-of-typexxx","title":"Bean named X is expected to be of type &#39;java.lang.Runnable&#39; but was actually of type &#39;org.springframework.beans.factory.support.NullBean&#39;","body":"<p>Spring is giving me below error, but can't figure out why is it ! </p>\n\n<p>Note: There is no bean definition in xml file for this.</p>\n\n<blockquote>\n  <p>Bean named 'resetDatabase' is expected to be of type\n  'java.lang.Runnable' but was actually of type\n  'org.springframework.beans.factory.support.NullBean'</p>\n</blockquote>\n\n<pre><code>@Bean\nRunnable resetDatabase() throws Exception\n{\n    if (env.acceptsProfiles(\"prof\"))\n    {\n        return resetDatabase_H2();\n    }\n    else\n    {\n        // return resetDatabase_H2();\n        return resetDatabase_Postgresql();\n    }\n}\n</code></pre>\n\n<p>I referred <a href=\"https://stackoverflow.com/questions/14545872/bean-named-xxx-must-be-of-typexxx-but-was-actually-of-typexxx\">this</a> as well but couldn't find any solution for my case</p>\n"},{"tags":["java","apache-camel"],"answers":[{"comments":[{"owner":{"account_id":1901420,"reputation":3763,"user_id":1717210,"display_name":"TacheDeChoco"},"score":1,"creation_date":1694437517,"post_id":77074892,"comment_id":135886801,"body_markdown":"IMHO a `transformer` (https://camel.apache.org/components/4.0.x/eips/transform-eip.html) would be even better (more meaningful) than a simple `Processor`. My 2 cents","body":"IMHO a <code>transformer</code> (<a href=\"https://camel.apache.org/components/4.0.x/eips/transform-eip.html\" rel=\"nofollow noreferrer\">camel.apache.org/components/4.0.x/eips/transform-eip.html</a>) would be even better (more meaningful) than a simple <code>Processor</code>. My 2 cents"}],"tags":[],"owner":{"account_id":204687,"reputation":1978,"user_id":453056,"accept_rate":86,"display_name":"Kyle"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694323088,"creation_date":1694323088,"answer_id":77074892,"question_id":77067388,"body_markdown":"You can look into how to write your own Type Converters [here](https://camel.apache.org/manual/type-converter.html#_writing_your_own_type_converters), but I don&#39;t believe they will work in your case due to Java&#39;s type erasure. As you alluded to, you&#39;ll just be converting a `List` to a `List`.\r\n\r\nPersonally I&#39;d probably just implement a [`Processor`](https://camel.apache.org/manual/processor.html) and call [`.process(..)`](https://camel.apache.org/components/4.0.x/eips/process-eip.html). It&#39;s a bit neater than `.bean(..)` for this use case.","title":"How to use Camel convertBodyTo with a list","body":"<p>You can look into how to write your own Type Converters <a href=\"https://camel.apache.org/manual/type-converter.html#_writing_your_own_type_converters\" rel=\"nofollow noreferrer\">here</a>, but I don't believe they will work in your case due to Java's type erasure. As you alluded to, you'll just be converting a <code>List</code> to a <code>List</code>.</p>\n<p>Personally I'd probably just implement a <a href=\"https://camel.apache.org/manual/processor.html\" rel=\"nofollow noreferrer\"><code>Processor</code></a> and call <a href=\"https://camel.apache.org/components/4.0.x/eips/process-eip.html\" rel=\"nofollow noreferrer\"><code>.process(..)</code></a>. It's a bit neater than <code>.bean(..)</code> for this use case.</p>\n"}],"owner":{"account_id":10351852,"reputation":216,"user_id":7635045,"display_name":"Pampa Nello"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":59,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1694323088,"creation_date":1694180196,"question_id":77067388,"body_markdown":"I have a list of type A and I would like to transform it in a list of type B.\r\n\r\nLet&#39;s imagine:\r\n\r\n```java\r\n// ... call the db and get a few rows mapped to List&lt;A&gt;\r\n.to(&quot;jdbc:...&quot;)\r\n.convertBodyTo(List.class) // ?!?\r\n```\r\n\r\nIn Camel, if it was a &quot;normal&quot; type, I would just use: `.convertBodyTo(B.class)`, then let Camel find the converter I coded.\r\n\r\nHowever, since this is a list of type A, if I do `.convertBodyTo(List.class)`, the converter is just not called.\r\n\r\nI could not split and process one at the time, because I need to do some grouping on `List&lt;A&gt;` before converting.\r\n\r\nI could fix it by using a bean, but I wanted to know if there is any way to call `convertBodyTo` to convert from a list to a list.\r\n","title":"How to use Camel convertBodyTo with a list","body":"<p>I have a list of type A and I would like to transform it in a list of type B.</p>\n<p>Let's imagine:</p>\n<pre class=\"lang-java prettyprint-override\"><code>// ... call the db and get a few rows mapped to List&lt;A&gt;\n.to(&quot;jdbc:...&quot;)\n.convertBodyTo(List.class) // ?!?\n</code></pre>\n<p>In Camel, if it was a &quot;normal&quot; type, I would just use: <code>.convertBodyTo(B.class)</code>, then let Camel find the converter I coded.</p>\n<p>However, since this is a list of type A, if I do <code>.convertBodyTo(List.class)</code>, the converter is just not called.</p>\n<p>I could not split and process one at the time, because I need to do some grouping on <code>List&lt;A&gt;</code> before converting.</p>\n<p>I could fix it by using a bean, but I wanted to know if there is any way to call <code>convertBodyTo</code> to convert from a list to a list.</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":15088308,"reputation":1377,"user_id":10888893,"display_name":"Mr. Patel"},"score":0,"creation_date":1573443992,"post_id":58795063,"comment_id":103871876,"body_markdown":"It is happening because your package name is having conflicts go to you main activity class copy it&#39;s package name and paste it into your manifest activity tag in place of .MainActivity","body":"It is happening because your package name is having conflicts go to you main activity class copy it&#39;s package name and paste it into your manifest activity tag in place of .MainActivity"},{"owner":{"account_id":13085437,"reputation":916,"user_id":9454556,"display_name":"Cyrille Con Morales"},"score":0,"creation_date":1573444411,"post_id":58795063,"comment_id":103871931,"body_markdown":"This has a lot of answer, check it out https://stackoverflow.com/questions/20915266/error-type-3-error-activity-class-does-not-exist","body":"This has a lot of answer, check it out <a href=\"https://stackoverflow.com/questions/20915266/error-type-3-error-activity-class-does-not-exist\" title=\"error type 3 error activity class does not exist\">stackoverflow.com/questions/20915266/&hellip;</a>"},{"owner":{"account_id":12489458,"reputation":175,"user_id":9091536,"display_name":"Angel"},"score":0,"creation_date":1573444522,"post_id":58795063,"comment_id":103871948,"body_markdown":"@Mr.Patel the same error occurs :(","body":"@Mr.Patel the same error occurs :("},{"owner":{"account_id":16652352,"reputation":574,"user_id":12034846,"display_name":"kam1234"},"score":0,"creation_date":1573446968,"post_id":58795063,"comment_id":103872354,"body_markdown":"please post your activity code","body":"please post your activity code"},{"owner":{"account_id":4532512,"reputation":1767,"user_id":3682565,"accept_rate":71,"display_name":"NamNH"},"score":0,"creation_date":1573447353,"post_id":58795063,"comment_id":103872426,"body_markdown":"Make sure the app&#39;s id, package are correct. Try to uninstall the current app in your device &amp; `File &gt; Invalidate caches / restart` from android studio, then run again.","body":"Make sure the app&#39;s id, package are correct. Try to uninstall the current app in your device &amp; <code>File &gt; Invalidate caches &#47; restart</code> from android studio, then run again."},{"owner":{"account_id":12489458,"reputation":175,"user_id":9091536,"display_name":"Angel"},"score":0,"creation_date":1573449302,"post_id":58795063,"comment_id":103872774,"body_markdown":"@NamNH still the error occurs :(","body":"@NamNH still the error occurs :("},{"owner":{"account_id":12489458,"reputation":175,"user_id":9091536,"display_name":"Angel"},"score":0,"creation_date":1573449397,"post_id":58795063,"comment_id":103872790,"body_markdown":"@kam1234 hi. I edited my post. thank you :)","body":"@kam1234 hi. I edited my post. thank you :)"},{"owner":{"account_id":15088308,"reputation":1377,"user_id":10888893,"display_name":"Mr. Patel"},"score":0,"creation_date":1573450091,"post_id":58795063,"comment_id":103872967,"body_markdown":"Well i guess you will need to create a new project try running that if it doesn&#39;t work issue issue is with your studio and if it work copy paste your code in new application!","body":"Well i guess you will need to create a new project try running that if it doesn&#39;t work issue issue is with your studio and if it work copy paste your code in new application!"},{"owner":{"account_id":4532512,"reputation":1767,"user_id":3682565,"accept_rate":71,"display_name":"NamNH"},"score":0,"creation_date":1573451740,"post_id":58795063,"comment_id":103873353,"body_markdown":"@AngelEsguerra, hard to determine the root cause, maybe the android studio has some problems. Try to create new project with simple activity template, then run it. If it&#39;s not crashed, your `sms` code (maybe in gradle or somewhere) has problems, otherwise the android studio. (Note that use androidX like your sample)","body":"@AngelEsguerra, hard to determine the root cause, maybe the android studio has some problems. Try to create new project with simple activity template, then run it. If it&#39;s not crashed, your <code>sms</code> code (maybe in gradle or somewhere) has problems, otherwise the android studio. (Note that use androidX like your sample)"},{"owner":{"account_id":12489458,"reputation":175,"user_id":9091536,"display_name":"Angel"},"score":0,"creation_date":1573452578,"post_id":58795063,"comment_id":103873558,"body_markdown":"@NamNH is possible to determine if the android studio is the problem? If it is, what could be the possible solution?","body":"@NamNH is possible to determine if the android studio is the problem? If it is, what could be the possible solution?"},{"owner":{"account_id":4532512,"reputation":1767,"user_id":3682565,"accept_rate":71,"display_name":"NamNH"},"score":0,"creation_date":1573452870,"post_id":58795063,"comment_id":103873649,"body_markdown":"@AngelEsguerra, So, It depends. you can try to do something like reset the config, or remove the `.m2` folder, even remove some conflict plugin (if found)... But, the fastest way is just re-install android studio (make sure clean uninstall it first).","body":"@AngelEsguerra, So, It depends. you can try to do something like reset the config, or remove the <code>.m2</code> folder, even remove some conflict plugin (if found)... But, the fastest way is just re-install android studio (make sure clean uninstall it first)."},{"owner":{"account_id":4532512,"reputation":1767,"user_id":3682565,"accept_rate":71,"display_name":"NamNH"},"score":0,"creation_date":1573453111,"post_id":58795063,"comment_id":103873717,"body_markdown":"Are use try to create simple project like my comment above? does it work? If it works, android studio is still ok, just rework with your current project, because your code still simple &amp; little :).","body":"Are use try to create simple project like my comment above? does it work? If it works, android studio is still ok, just rework with your current project, because your code still simple &amp; little :)."},{"owner":{"account_id":7114869,"reputation":503,"user_id":6152175,"accept_rate":83,"display_name":"alexandre9865"},"score":1,"creation_date":1595598806,"post_id":58795063,"comment_id":111539084,"body_markdown":"@AngelEsguerra how did you solve it?","body":"@AngelEsguerra how did you solve it?"},{"owner":{"account_id":59548,"reputation":19807,"user_id":178143,"accept_rate":61,"display_name":"Ted"},"score":0,"creation_date":1669648416,"post_id":58795063,"comment_id":131683908,"body_markdown":"Yes, was it resolved? =)","body":"Yes, was it resolved? =)"}],"answers":[{"comments":[{"owner":{"account_id":12489458,"reputation":175,"user_id":9091536,"display_name":"Angel"},"score":0,"creation_date":1573443450,"post_id":58795091,"comment_id":103871792,"body_markdown":"Hi. Thank you for replying. There is already a intent-filter in my android manifest but it still gets the same error :(","body":"Hi. Thank you for replying. There is already a intent-filter in my android manifest but it still gets the same error :("}],"tags":[],"owner":{"account_id":2313718,"reputation":1126,"user_id":2031246,"display_name":"John Le"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1573441842,"creation_date":1573441842,"answer_id":58795091,"question_id":58795063,"body_markdown":"Add the `intent-filter` to the `AndroidManifest.xml`: \r\n\r\n    &lt;activity\r\n        android:name=“.MainActivity”&gt;\r\n        &lt;intent-filter&gt;\r\n            &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\r\n    \r\n            &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\r\n        &lt;/intent-filter&gt;\r\n    &lt;/activity&gt;\r\n\r\n","title":"Error: Activity class {.MainActivity} does not exist","body":"<p>Add the <code>intent-filter</code> to the <code>AndroidManifest.xml</code>: </p>\n\n<pre><code>&lt;activity\n    android:name=“.MainActivity”&gt;\n    &lt;intent-filter&gt;\n        &lt;action android:name=\"android.intent.action.MAIN\" /&gt;\n\n        &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt;\n    &lt;/intent-filter&gt;\n&lt;/activity&gt;\n</code></pre>\n"},{"comments":[{"owner":{"account_id":1010778,"reputation":2555,"user_id":1408339,"accept_rate":73,"display_name":"rwst"},"score":0,"creation_date":1649436782,"post_id":58795733,"comment_id":126883742,"body_markdown":"Works for me only with Specified Activity, with default the command `am start` is generated with a double path like `com.xyz/com.xyz.activity`. Any idea why?","body":"Works for me only with Specified Activity, with default the command <code>am start</code> is generated with a double path like <code>com.xyz&#47;com.xyz.activity</code>. Any idea why?"},{"owner":{"account_id":2144018,"reputation":373,"user_id":3493859,"display_name":"bardi"},"score":0,"creation_date":1666346341,"post_id":58795733,"comment_id":130920419,"body_markdown":"@rwst, `com.xyz/com.xyz.activity` is not a double path, it represents the package and the class of that component, see [ComponentName docs](https://developer.android.com/reference/android/content/ComponentName#unflattenFromString(java.lang.String))","body":"@rwst, <code>com.xyz&#47;com.xyz.activity</code> is not a double path, it represents the package and the class of that component, see <a href=\"https://developer.android.com/reference/android/content/ComponentName#unflattenFromString(java.lang.String)\" rel=\"nofollow noreferrer\">ComponentName docs</a>"}],"tags":[],"owner":{"display_name":"user12321197"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1573449665,"creation_date":1573448041,"answer_id":58795733,"question_id":58795063,"body_markdown":"Take the path:\r\n\r\ntab Run / edit Configuration / tab general / Lunch Options / launch.\r\n\r\nAnd select the default activity option.\r\nIf the problem does not resolve, select the Specified Activity option and select the MainActivity.\r\n\r\nIf the problem is resolved, it is likely that the activity path is in the wrong androidManifest. You can write the path completely in androidmanifest.\r\n\r\n    &lt;activity android:name=&quot;path.MainActivity&quot;&gt;\r\n            &lt;intent-filter&gt;\r\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\r\n\r\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\r\n            &lt;/intent-filter&gt;\r\n        &lt;/activity&gt;\r\n\r\nIn the code above write the path of the activity instead of the word path.\r\nAnd also go back app configurations and choose the default activity one again.","title":"Error: Activity class {.MainActivity} does not exist","body":"<p>Take the path:</p>\n\n<p>tab Run / edit Configuration / tab general / Lunch Options / launch.</p>\n\n<p>And select the default activity option.\nIf the problem does not resolve, select the Specified Activity option and select the MainActivity.</p>\n\n<p>If the problem is resolved, it is likely that the activity path is in the wrong androidManifest. You can write the path completely in androidmanifest.</p>\n\n<pre><code>&lt;activity android:name=\"path.MainActivity\"&gt;\n        &lt;intent-filter&gt;\n            &lt;action android:name=\"android.intent.action.MAIN\" /&gt;\n\n            &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt;\n        &lt;/intent-filter&gt;\n    &lt;/activity&gt;\n</code></pre>\n\n<p>In the code above write the path of the activity instead of the word path.\nAnd also go back app configurations and choose the default activity one again.</p>\n"},{"comments":[{"owner":{"account_id":16652352,"reputation":574,"user_id":12034846,"display_name":"kam1234"},"score":0,"creation_date":1573449866,"post_id":58795937,"comment_id":103872915,"body_markdown":"try all of these","body":"try all of these"}],"tags":[],"owner":{"account_id":16652352,"reputation":574,"user_id":12034846,"display_name":"kam1234"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1573449839,"creation_date":1573449839,"answer_id":58795937,"question_id":58795063,"body_markdown":"try this\r\n```\r\n&lt;activity android:name=&quot;MainActivity&quot;&gt;\r\n            &lt;intent-filter&gt;\r\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\r\n\r\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\r\n            &lt;/intent-filter&gt;\r\n        &lt;/activity&gt;\r\n```\r\nor \r\n```\r\n&lt;activity android:name=&quot;.MainActivity&quot;&gt;\r\n            &lt;intent-filter&gt;\r\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\r\n\r\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\r\n            &lt;/intent-filter&gt;\r\n        &lt;/activity&gt;\r\n```\r\nor \r\n```\r\n&lt;activity android:name=&quot;com.example.sms.MainActivity&quot;&gt;\r\n            &lt;intent-filter&gt;\r\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\r\n\r\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\r\n            &lt;/intent-filter&gt;\r\n        &lt;/activity&gt;\r\n```","title":"Error: Activity class {.MainActivity} does not exist","body":"<p>try this</p>\n\n<pre><code>&lt;activity android:name=\"MainActivity\"&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=\"android.intent.action.MAIN\" /&gt;\n\n                &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/activity&gt;\n</code></pre>\n\n<p>or </p>\n\n<pre><code>&lt;activity android:name=\".MainActivity\"&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=\"android.intent.action.MAIN\" /&gt;\n\n                &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/activity&gt;\n</code></pre>\n\n<p>or </p>\n\n<pre><code>&lt;activity android:name=\"com.example.sms.MainActivity\"&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=\"android.intent.action.MAIN\" /&gt;\n\n                &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/activity&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":15474264,"reputation":21,"user_id":11163325,"display_name":"jeff kim"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1586847578,"creation_date":1586847578,"answer_id":61202246,"question_id":58795063,"body_markdown":"You can look at this response here [Error type 3 Error: Activity class {} does not exist][1]. \r\n\r\nAlso, another common problem is if you are running your app on a physical device that has multiple user accounts. E.g. Main User and A Guest User. In this case there might be a conflict if one user does not update their application. Follow the following steps;\r\n\r\n 1. Go to Settings.\r\n 2. Go to Apps.\r\n 3. Select your app.\r\n 4. Open the overflow menu on the top right and select Uninstall for all users.\r\n 5. Done. Try to install then launch your app again.\r\n\r\nThe other alternative, which is longer, is to uninstall the app while in one account, then switch accounts and uninstall in the other. \r\n\r\nHope it helps.\r\n\r\n  [1]: https://stackoverflow.com/questions/20915266/error-type-3-error-activity-class-does-not-exist","title":"Error: Activity class {.MainActivity} does not exist","body":"<p>You can look at this response here <a href=\"https://stackoverflow.com/questions/20915266/error-type-3-error-activity-class-does-not-exist\">Error type 3 Error: Activity class {} does not exist</a>. </p>\n\n<p>Also, another common problem is if you are running your app on a physical device that has multiple user accounts. E.g. Main User and A Guest User. In this case there might be a conflict if one user does not update their application. Follow the following steps;</p>\n\n<ol>\n<li>Go to Settings.</li>\n<li>Go to Apps.</li>\n<li>Select your app.</li>\n<li>Open the overflow menu on the top right and select Uninstall for all users.</li>\n<li>Done. Try to install then launch your app again.</li>\n</ol>\n\n<p>The other alternative, which is longer, is to uninstall the app while in one account, then switch accounts and uninstall in the other. </p>\n\n<p>Hope it helps.</p>\n"},{"tags":[],"owner":{"account_id":18913897,"reputation":541,"user_id":13799368,"display_name":"Try this"},"comment_count":0,"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1595765959,"creation_date":1595765959,"answer_id":63100028,"question_id":58795063,"body_markdown":"Can you try uninstalling app using following ADB command and re-run?\r\n\r\n```\r\nadb uninstall &lt;your-apps-package-name&gt;\r\n```\r\n\r\n","title":"Error: Activity class {.MainActivity} does not exist","body":"<p>Can you try uninstalling app using following ADB command and re-run?</p>\n<pre><code>adb uninstall &lt;your-apps-package-name&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":19412571,"reputation":1,"user_id":14196748,"display_name":"ibrahim bougaoua"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1599562452,"creation_date":1599562452,"answer_id":63792426,"question_id":58795063,"body_markdown":"The same error occurred to me and I solved it by renaming the package and using &quot;clean project and rebuild project&quot; ... then I shut down android stodio and restarted it then it worked fine.","title":"Error: Activity class {.MainActivity} does not exist","body":"<p>The same error occurred to me and I solved it by renaming the package and using &quot;clean project and rebuild project&quot; ... then I shut down android stodio and restarted it then it worked fine.</p>\n"},{"comments":[{"owner":{"account_id":14192811,"reputation":348,"user_id":10252907,"display_name":"Nguy&#234;n Ng&#244; Duy"},"score":1,"creation_date":1611019670,"post_id":64347113,"comment_id":116310772,"body_markdown":"Thankyou. You save my day. This is the simple answer.","body":"Thankyou. You save my day. This is the simple answer."},{"owner":{"account_id":9790340,"reputation":77,"user_id":7255184,"accept_rate":17,"display_name":"Mudassir"},"score":1,"creation_date":1616958706,"post_id":64347113,"comment_id":118159457,"body_markdown":"Saved my day .. very helpful other solutions did not worked","body":"Saved my day .. very helpful other solutions did not worked"},{"owner":{"display_name":"user16388400"},"score":1,"creation_date":1638066370,"post_id":64347113,"comment_id":123987832,"body_markdown":"Thanks a lot !!! That&#39;s the solution!!!","body":"Thanks a lot !!! That&#39;s the solution!!!"},{"owner":{"account_id":7766681,"reputation":91,"user_id":5877656,"display_name":"Halen"},"score":1,"creation_date":1670195675,"post_id":64347113,"comment_id":131813486,"body_markdown":"Where is that folder? I couldnt find it","body":"Where is that folder? I couldnt find it"},{"owner":{"account_id":86960,"reputation":5647,"user_id":241465,"accept_rate":66,"display_name":"Titan"},"score":1,"creation_date":1682626823,"post_id":64347113,"comment_id":134249905,"body_markdown":"The folder is hidden `.idea` in the root of your android project folder","body":"The folder is hidden <code>.idea</code> in the root of your android project folder"}],"tags":[],"owner":{"account_id":15924324,"reputation":111,"user_id":11490329,"display_name":"Amelia"},"comment_count":5,"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1602653066,"creation_date":1602653066,"answer_id":64347113,"question_id":58795063,"body_markdown":"you can delete the folder of **idea**,then restart your project.","title":"Error: Activity class {.MainActivity} does not exist","body":"<p>you can delete the folder of <strong>idea</strong>,then restart your project.</p>\n"},{"comments":[{"owner":{"account_id":2678092,"reputation":1134,"user_id":2313984,"display_name":"AndrWeisR"},"score":1,"creation_date":1639089276,"post_id":64670656,"comment_id":124266947,"body_markdown":"This was downvoted, but I upvoted it, because this was the case for me. My emulator was still locked at startup, and I got this error. Once I unlocked the emulator, the app ran fine without the misleading &quot;MainActivity does not exist&quot; error.","body":"This was downvoted, but I upvoted it, because this was the case for me. My emulator was still locked at startup, and I got this error. Once I unlocked the emulator, the app ran fine without the misleading &quot;MainActivity does not exist&quot; error."},{"owner":{"account_id":1029927,"reputation":528,"user_id":1038456,"display_name":"Aparajita"},"score":1,"creation_date":1675899103,"post_id":64670656,"comment_id":133029638,"body_markdown":"Same here, that was the problem.","body":"Same here, that was the problem."}],"tags":[],"owner":{"account_id":8709327,"reputation":49,"user_id":6516073,"display_name":"Chester"},"comment_count":2,"down_vote_count":1,"up_vote_count":4,"is_accepted":false,"score":3,"last_activity_date":1604437444,"creation_date":1604437444,"answer_id":64670656,"question_id":58795063,"body_markdown":"I have had this happen to me once when I enabled the Fingerprint / PIN lock on the AVD and ran the app afterwards.\r\n\r\nI found I needed to unlock the device before running the app.","title":"Error: Activity class {.MainActivity} does not exist","body":"<p>I have had this happen to me once when I enabled the Fingerprint / PIN lock on the AVD and ran the app afterwards.</p>\n<p>I found I needed to unlock the device before running the app.</p>\n"},{"tags":[],"owner":{"account_id":19083053,"reputation":9,"user_id":13934897,"display_name":"omkar shinde"},"comment_count":0,"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1632555966,"creation_date":1632555626,"answer_id":69324109,"question_id":58795063,"body_markdown":"\r\n\r\nYou can look at this response here Error type 3 Error: Activity class {} does not exist.\r\n\r\nAlso, another common problem is if you are running your app on a physical device that has multiple user accounts. E.g. Main User and A Guest User. In this case there might be a conflict if one user does not update their application. Follow the following steps;\r\n\r\nGo to Settings.\r\nGo to Apps.\r\nSelect your app.\r\nOpen the overflow menu on the top right and select Uninstall for all users.\r\nDone. Try to install then launch your app again.\r\nThe other alternative, which is longer, is to uninstall the app while in one account, then switch accounts and uninstall in the other.","title":"Error: Activity class {.MainActivity} does not exist","body":"<p>You can look at this response here Error type 3 Error: Activity class {} does not exist.</p>\n<p>Also, another common problem is if you are running your app on a physical device that has multiple user accounts. E.g. Main User and A Guest User. In this case there might be a conflict if one user does not update their application. Follow the following steps;</p>\n<p>Go to Settings.\nGo to Apps.\nSelect your app.\nOpen the overflow menu on the top right and select Uninstall for all users.\nDone. Try to install then launch your app again.\nThe other alternative, which is longer, is to uninstall the app while in one account, then switch accounts and uninstall in the other.</p>\n"},{"tags":[],"owner":{"account_id":11470078,"reputation":101,"user_id":8407174,"display_name":"Gustone Alwanga"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1670460140,"creation_date":1670460140,"answer_id":74724347,"question_id":58795063,"body_markdown":"Had this in react native, all the above solutions did not work for me\r\nwhile in root, I did `cd android`\r\nthen `./gradlew uninstallAll`\r\nthen after its done, cd out , run the project and the error was gone","title":"Error: Activity class {.MainActivity} does not exist","body":"<p>Had this in react native, all the above solutions did not work for me\nwhile in root, I did <code>cd android</code>\nthen <code>./gradlew uninstallAll</code>\nthen after its done, cd out , run the project and the error was gone</p>\n"}],"owner":{"account_id":12489458,"reputation":175,"user_id":9091536,"display_name":"Angel"},"comment_count":14,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":21712,"favorite_count":0,"down_vote_count":0,"up_vote_count":9,"answer_count":10,"score":9,"last_activity_date":1694322130,"creation_date":1573441540,"question_id":58795063,"body_markdown":"I tried to run my android application in my android device but it keeps saying that my Main Activity does not exist although my Main Activity class is there\r\n\r\nI tried to create a new project then copied my previous codes and it worked for a while. But then it produced the same error again.\r\n\r\n```\r\nError while executing: am start -n &quot;com.example.sms/com.example.sms.MainActivity&quot; -a android.intent.action.MAIN -c android.intent.category.LAUNCHER\r\nStarting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.example.sms/.MainActivity }\r\nError type 3\r\nError: Activity class {com.example.sms/com.example.sms.MainActivity} does not exist.\r\n\r\nError while Launching activity\r\n\r\n\r\n```\r\nThere is already a intent-filter in may android manifest:\r\n```\r\n        &lt;activity android:name=&quot;.MainActivity&quot;&gt;\r\n            &lt;intent-filter&gt;\r\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\r\n\r\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\r\n            &lt;/intent-filter&gt;\r\n        &lt;/activity&gt;\r\n```\r\n\r\nI already tried to clean and rebuild project. But it still gets the same error. My android device&#39;s version is android 9.\r\n\r\nHere is my main activity:\r\n\r\n```\r\npackage com.example.sms;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.app.ActivityCompat;\r\nimport androidx.core.content.ContextCompat;\r\n\r\nimport android.Manifest;\r\nimport android.content.Intent;\r\nimport android.content.pm.PackageManager;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.telephony.SmsManager;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.Toast;\r\n\r\nimport java.util.ArrayList;\r\n\r\npublic class MainActivity extends AppCompatActivity implements View.OnClickListener {\r\n\r\n    EditText etNumber, etMessage;\r\n    Button btnSend;\r\n\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n\r\n        etNumber = (EditText)findViewById(R.id.etNumber);\r\n        btnSend = (Button)findViewById(R.id.btnSend);\r\n        btnSend.setOnClickListener(this);\r\n\r\n    }\r\n\r\n    public void MyMessage() {\r\n\r\n        String phoneNum = etNumber.getText().toString().trim();\r\n        String spamMessage = &quot;Hi&quot;;\r\n\r\n        if (etNumber.getText().toString().equals(&quot;09152006203&quot;)) {\r\n            if (!etNumber.getText().toString().equals(&quot;&quot;)) {\r\n                SmsManager smsManager = SmsManager.getDefault();\r\n                ArrayList&lt;String&gt; sms = smsManager.divideMessage(spamMessage);\r\n                smsManager.sendMultipartTextMessage(phoneNum, null,sms,null, null);\r\n\r\n                Toast.makeText(this, &quot;Message has been sent&quot;, Toast.LENGTH_SHORT).show();\r\n\r\n            } else {\r\n                Toast.makeText(this, &quot;Please enter number or message&quot;, Toast.LENGTH_SHORT).show();\r\n            }\r\n        } else {\r\n            Toast.makeText(this, &quot;Number is incorrect!&quot;, Toast.LENGTH_SHORT).show();\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\r\n        super.onRequestPermissionsResult(requestCode, permissions, grantResults);\r\n\r\n        switch(requestCode){\r\n\r\n            case 0:\r\n                if(grantResults.length&gt;=0 &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED){\r\n                    MyMessage();\r\n                } else {\r\n                    Toast.makeText(this, &quot;You do not have required permission&quot;, Toast.LENGTH_SHORT).show();\r\n                }\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void onClick(View v) {\r\n        int permissionCheck = ContextCompat.checkSelfPermission(this, Manifest.permission.SEND_SMS);\r\n\r\n        if(permissionCheck == PackageManager.PERMISSION_GRANTED){\r\n            MyMessage();\r\n        }\r\n        else{\r\n            ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.SEND_SMS}, 0);\r\n        }\r\n\r\n\r\n    }\r\n}\r\n\r\n```","title":"Error: Activity class {.MainActivity} does not exist","body":"<p>I tried to run my android application in my android device but it keeps saying that my Main Activity does not exist although my Main Activity class is there</p>\n\n<p>I tried to create a new project then copied my previous codes and it worked for a while. But then it produced the same error again.</p>\n\n<pre><code>Error while executing: am start -n \"com.example.sms/com.example.sms.MainActivity\" -a android.intent.action.MAIN -c android.intent.category.LAUNCHER\nStarting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.example.sms/.MainActivity }\nError type 3\nError: Activity class {com.example.sms/com.example.sms.MainActivity} does not exist.\n\nError while Launching activity\n\n\n</code></pre>\n\n<p>There is already a intent-filter in may android manifest:</p>\n\n<pre><code>        &lt;activity android:name=\".MainActivity\"&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=\"android.intent.action.MAIN\" /&gt;\n\n                &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/activity&gt;\n</code></pre>\n\n<p>I already tried to clean and rebuild project. But it still gets the same error. My android device's version is android 9.</p>\n\n<p>Here is my main activity:</p>\n\n<pre><code>package com.example.sms;\n\nimport androidx.annotation.NonNull;\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.core.app.ActivityCompat;\nimport androidx.core.content.ContextCompat;\n\nimport android.Manifest;\nimport android.content.Intent;\nimport android.content.pm.PackageManager;\nimport android.net.Uri;\nimport android.os.Bundle;\nimport android.telephony.SmsManager;\nimport android.view.View;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.Toast;\n\nimport java.util.ArrayList;\n\npublic class MainActivity extends AppCompatActivity implements View.OnClickListener {\n\n    EditText etNumber, etMessage;\n    Button btnSend;\n\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        etNumber = (EditText)findViewById(R.id.etNumber);\n        btnSend = (Button)findViewById(R.id.btnSend);\n        btnSend.setOnClickListener(this);\n\n    }\n\n    public void MyMessage() {\n\n        String phoneNum = etNumber.getText().toString().trim();\n        String spamMessage = \"Hi\";\n\n        if (etNumber.getText().toString().equals(\"09152006203\")) {\n            if (!etNumber.getText().toString().equals(\"\")) {\n                SmsManager smsManager = SmsManager.getDefault();\n                ArrayList&lt;String&gt; sms = smsManager.divideMessage(spamMessage);\n                smsManager.sendMultipartTextMessage(phoneNum, null,sms,null, null);\n\n                Toast.makeText(this, \"Message has been sent\", Toast.LENGTH_SHORT).show();\n\n            } else {\n                Toast.makeText(this, \"Please enter number or message\", Toast.LENGTH_SHORT).show();\n            }\n        } else {\n            Toast.makeText(this, \"Number is incorrect!\", Toast.LENGTH_SHORT).show();\n        }\n    }\n\n    @Override\n    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\n        super.onRequestPermissionsResult(requestCode, permissions, grantResults);\n\n        switch(requestCode){\n\n            case 0:\n                if(grantResults.length&gt;=0 &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED){\n                    MyMessage();\n                } else {\n                    Toast.makeText(this, \"You do not have required permission\", Toast.LENGTH_SHORT).show();\n                }\n        }\n    }\n\n    @Override\n    public void onClick(View v) {\n        int permissionCheck = ContextCompat.checkSelfPermission(this, Manifest.permission.SEND_SMS);\n\n        if(permissionCheck == PackageManager.PERMISSION_GRANTED){\n            MyMessage();\n        }\n        else{\n            ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.SEND_SMS}, 0);\n        }\n\n\n    }\n}\n\n</code></pre>\n"},{"tags":["java","logging"],"answers":[{"tags":[],"owner":{"account_id":2826194,"reputation":10795,"user_id":2428802,"display_name":"jmehrens"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694318592,"creation_date":1694318592,"answer_id":77074780,"question_id":76724896,"body_markdown":"&gt; At runtime within the mini app interpreter, I want to be able to place the current mini app name at the front of every log statement. Is there a way to do this with default java.util.logging?\r\n\r\nOne issue with `java.util.logging.SimpleFormatter.format` system property or logging property is that it is read and set once when the class is loaded and is forever that value.\r\n\r\nTo build something dynamic you have to write your own [java.util.logging.Formatter][1] or find a 3rd party formatter:\r\n\r\n    public class AppFormatter extends SimpleFormatter {\r\n        public String format(LogRecord record) {\r\n            return System.getProperty(&quot;app.name&quot;) + &quot; &quot; + super.format(record);\r\n        }\r\n    }\r\n\r\nThen in your configuration file you have to replace the use of SimpleFormatter with full qualified name of your `AppFormatter`.\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/util/logging/Formatter.html#format-java.util.logging.LogRecord-","title":"java.util.logging - Add a prefix at runtime","body":"<blockquote>\n<p>At runtime within the mini app interpreter, I want to be able to place the current mini app name at the front of every log statement. Is there a way to do this with default java.util.logging?</p>\n</blockquote>\n<p>One issue with <code>java.util.logging.SimpleFormatter.format</code> system property or logging property is that it is read and set once when the class is loaded and is forever that value.</p>\n<p>To build something dynamic you have to write your own <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/logging/Formatter.html#format-java.util.logging.LogRecord-\" rel=\"nofollow noreferrer\">java.util.logging.Formatter</a> or find a 3rd party formatter:</p>\n<pre><code>public class AppFormatter extends SimpleFormatter {\n    public String format(LogRecord record) {\n        return System.getProperty(&quot;app.name&quot;) + &quot; &quot; + super.format(record);\n    }\n}\n</code></pre>\n<p>Then in your configuration file you have to replace the use of SimpleFormatter with full qualified name of your <code>AppFormatter</code>.</p>\n"}],"owner":{"account_id":26546563,"reputation":3,"user_id":20176545,"display_name":"Carter Smith"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":55,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694318592,"creation_date":1689797738,"question_id":76724896,"body_markdown":"I have a Java web application running on Tomcat that interprets and runs other mini Java applications (Beanshells). Both the main app and the mini apps use the default java.util.logging. The main app includes a logging.properties file that enables writing logs to a file separate from the main Tomcat logs.\r\n\r\nAt runtime within the mini app interpreter, I want to be able to place the current mini app name at the front of every log statement. Is there a way to do this with default java.util.logging?\r\n\r\nI have attempted to use a system property called app.name in the format string inside logging.properties, setting and clearing the property at runtime, but no dice - nothing is logged before the rest of the string. Here&#39;s the logging.properties file for the main webapp:\r\n\r\n```\r\nhandlers = org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\r\n\r\norg.apache.juli.FileHandler.level=INFO\r\norg.apache.juli.FileHandler.directory=${catalina.base}/logs\r\norg.apache.juli.FileHandler.prefix=apprunner.\r\norg.apache.juli.FileHandler.encoding=UTF-8\r\norg.apache.juli.FileHandler.formatter=java.util.logging.SimpleFormatter\r\n\r\njava.util.logging.ConsoleHandler.level=INFO\r\njava.util.logging.ConsoleHandler.formatter=java.util.logging.SimpleFormatter\r\n\r\njava.util.logging.SimpleFormatter.format=${app.name} %1$tY-%1$tm-%1$td %1$tH:%1$tM:%1$tS %4$s %2$s %5$s%6$s%n\r\n```\r\n\r\nInside the evalJava function inside com.apprunner.App:\r\n\r\n```\r\nlogger.info(&quot;### BEGIN JAVA EXECUTION ###&quot;);\r\nSystem.setProperty(&quot;app.name&quot;, ui_object_name);\r\nlogger.info(System.getProperty(&quot;app.name&quot;));\r\n```\r\n\r\nResulting logs in apprunner.[date].log:\r\n\r\n```\r\nJul 19, 2023 4:09:29 PM com.apprunner.App evalJava\r\nINFO: ### BEGIN JAVA EXECUTION ###\r\nJul 19, 2023 4:09:29 PM com.apprunner.App evalJava\r\nINFO: testapp/app/testapp.java\r\n```","title":"java.util.logging - Add a prefix at runtime","body":"<p>I have a Java web application running on Tomcat that interprets and runs other mini Java applications (Beanshells). Both the main app and the mini apps use the default java.util.logging. The main app includes a logging.properties file that enables writing logs to a file separate from the main Tomcat logs.</p>\n<p>At runtime within the mini app interpreter, I want to be able to place the current mini app name at the front of every log statement. Is there a way to do this with default java.util.logging?</p>\n<p>I have attempted to use a system property called app.name in the format string inside logging.properties, setting and clearing the property at runtime, but no dice - nothing is logged before the rest of the string. Here's the logging.properties file for the main webapp:</p>\n<pre><code>handlers = org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n\norg.apache.juli.FileHandler.level=INFO\norg.apache.juli.FileHandler.directory=${catalina.base}/logs\norg.apache.juli.FileHandler.prefix=apprunner.\norg.apache.juli.FileHandler.encoding=UTF-8\norg.apache.juli.FileHandler.formatter=java.util.logging.SimpleFormatter\n\njava.util.logging.ConsoleHandler.level=INFO\njava.util.logging.ConsoleHandler.formatter=java.util.logging.SimpleFormatter\n\njava.util.logging.SimpleFormatter.format=${app.name} %1$tY-%1$tm-%1$td %1$tH:%1$tM:%1$tS %4$s %2$s %5$s%6$s%n\n</code></pre>\n<p>Inside the evalJava function inside com.apprunner.App:</p>\n<pre><code>logger.info(&quot;### BEGIN JAVA EXECUTION ###&quot;);\nSystem.setProperty(&quot;app.name&quot;, ui_object_name);\nlogger.info(System.getProperty(&quot;app.name&quot;));\n</code></pre>\n<p>Resulting logs in apprunner.[date].log:</p>\n<pre><code>Jul 19, 2023 4:09:29 PM com.apprunner.App evalJava\nINFO: ### BEGIN JAVA EXECUTION ###\nJul 19, 2023 4:09:29 PM com.apprunner.App evalJava\nINFO: testapp/app/testapp.java\n</code></pre>\n"},{"tags":["java","compilation"],"comments":[{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":1,"creation_date":1694320140,"post_id":77074444,"comment_id":135874551,"body_markdown":"Because you lied to the compiler.","body":"Because you lied to the compiler."},{"owner":{"account_id":2179728,"reputation":73077,"user_id":10819573,"display_name":"Arvind Kumar Avinash"},"score":0,"creation_date":1694335975,"post_id":77074444,"comment_id":135875632,"body_markdown":"Casting is a convenience Java has given you to make the Java compiler trust you. So, it compiles but you are trying to abuse the convenience given to you. Remember [Karma](https://en.wikipedia.org/wiki/Karma) &#128522;","body":"Casting is a convenience Java has given you to make the Java compiler trust you. So, it compiles but you are trying to abuse the convenience given to you. Remember <a href=\"https://en.wikipedia.org/wiki/Karma\" rel=\"nofollow noreferrer\">Karma</a> 😊"},{"owner":{"account_id":2709823,"reputation":10716,"user_id":2338547,"display_name":"markspace"},"score":0,"creation_date":1694356539,"post_id":77074444,"comment_id":135877610,"body_markdown":"Note that casting a literal expression happens at compile time: `int i = (int)(1.0+2.0);`  This is different than casting a reference type as the OP has.  So the OP might be asking why the reference type is different than the literal type.","body":"Note that casting a literal expression happens at compile time: <code>int i = (int)(1.0+2.0);</code>  This is different than casting a reference type as the OP has.  So the OP might be asking why the reference type is different than the literal type."}],"answers":[{"comments":[{"owner":{"account_id":247613,"reputation":284089,"user_id":522444,"accept_rate":100,"display_name":"Hovercraft Full Of Eels"},"score":4,"creation_date":1694312703,"post_id":77074602,"comment_id":135874245,"body_markdown":"1/5th through this answer and I already could  tell who the author was. Contravariance/Covariance/Invariance are key topics that are not easy to understand.  Well stated, and from all of us, thanks for well educating us.  1+","body":"1/5th through this answer and I already could  tell who the author was. Contravariance/Covariance/Invariance are key topics that are not easy to understand.  Well stated, and from all of us, thanks for well educating us.  1+"},{"owner":{"account_id":2709823,"reputation":10716,"user_id":2338547,"display_name":"markspace"},"score":1,"creation_date":1694316972,"post_id":77074602,"comment_id":135874406,"body_markdown":"I&#39;m not sure this answers the OP&#39;s question.  Why does that line compile?  The compiler will evaluate `int i = 1.0 + 2.0;` at compile time and throw an error.  But I&#39;m pretty sure both the cast `(Integer[])` and the `new` keyword are never evaluated by the compiler like a literal is.  (But I didn&#39;t double check that.)  So there is no choice: both `new` and the cast are only evaluated at runtime.","body":"I&#39;m not sure this answers the OP&#39;s question.  Why does that line compile?  The compiler will evaluate <code>int i = 1.0 + 2.0;</code> at compile time and throw an error.  But I&#39;m pretty sure both the cast <code>(Integer[])</code> and the <code>new</code> keyword are never evaluated by the compiler like a literal is.  (But I didn&#39;t double check that.)  So there is no choice: both <code>new</code> and the cast are only evaluated at runtime."},{"owner":{"account_id":2709823,"reputation":10716,"user_id":2338547,"display_name":"markspace"},"score":1,"creation_date":1694317094,"post_id":77074602,"comment_id":135874409,"body_markdown":"I guess in other words I&#39;m interpreting the OP&#39;s question as asking &quot;The type Object[] is right there, the cast (Integer[]) is right there, why can&#39;t the compiler evaluate that and spot the error immediately?&quot;  (Edit: but `int i = (int)(1.0+2.0);` is evaluated at compile time, so I guess casting references only happens at runtime, primitives can be evaluated at compile time; possibly this is also a source of confusion.)","body":"I guess in other words I&#39;m interpreting the OP&#39;s question as asking &quot;The type Object[] is right there, the cast (Integer[]) is right there, why can&#39;t the compiler evaluate that and spot the error immediately?&quot;  (Edit: but <code>int i = (int)(1.0+2.0);</code> is evaluated at compile time, so I guess casting references only happens at runtime, primitives can be evaluated at compile time; possibly this is also a source of confusion.)"},{"owner":{"account_id":2179728,"reputation":73077,"user_id":10819573,"display_name":"Arvind Kumar Avinash"},"score":0,"creation_date":1694333886,"post_id":77074602,"comment_id":135875425,"body_markdown":"The problem will be with `ns[0] = 5.5; // ... a double`, not with `Integer firstElement = is[0]; // BOOM!`.","body":"The problem will be with <code>ns[0] = 5.5; &#47;&#47; ... a double</code>, not with <code>Integer firstElement = is[0]; &#47;&#47; BOOM!</code>."},{"owner":{"account_id":22435873,"reputation":65,"user_id":16641133,"display_name":"Oscar"},"score":0,"creation_date":1694354860,"post_id":77074602,"comment_id":135877434,"body_markdown":"Thanks for your time in answer me. I think, whatever, that JAVA compiler must detect the bug a compilation time, because is a NEW instruction and not a CAST assignment from an Objecjt variable. Thanks thanks","body":"Thanks for your time in answer me. I think, whatever, that JAVA compiler must detect the bug a compilation time, because is a NEW instruction and not a CAST assignment from an Objecjt variable. Thanks thanks"},{"owner":{"account_id":401843,"reputation":89863,"user_id":768644,"display_name":"rzwitserloot"},"score":1,"creation_date":1694355322,"post_id":77074602,"comment_id":135877477,"body_markdown":"@markspace The last line of the answer explains it: It&#39;s a one-word explanation: &quot;Because&quot;. Spec says so. Doing it right is very complicated (see middle of answer: Co/Contra/Invariance), presumably java v1.0 design threw in the towel to try to make sense of it at compile time.","body":"@markspace The last line of the answer explains it: It&#39;s a one-word explanation: &quot;Because&quot;. Spec says so. Doing it right is very complicated (see middle of answer: Co/Contra/Invariance), presumably java v1.0 design threw in the towel to try to make sense of it at compile time."},{"owner":{"account_id":22435873,"reputation":65,"user_id":16641133,"display_name":"Oscar"},"score":0,"creation_date":1694355458,"post_id":77074602,"comment_id":135877492,"body_markdown":"In the ArrayList&lt;AnyType&gt; implementation, JAVA use arrays as a base type....","body":"In the ArrayList&lt;AnyType&gt; implementation, JAVA use arrays as a base type...."},{"owner":{"account_id":22435873,"reputation":65,"user_id":16641133,"display_name":"Oscar"},"score":0,"creation_date":1694361340,"post_id":77074602,"comment_id":135878161,"body_markdown":"I don&#39;t understand what do you say in statement: &quot;Hence why list.add() doesn&#39;t work here - there is no value that is both Double and Integer and Number and SomeSubTypeOfNumberYouHaventEvenWrittenYet.&quot; What is list ?","body":"I don&#39;t understand what do you say in statement: &quot;Hence why list.add() doesn&#39;t work here - there is no value that is both Double and Integer and Number and SomeSubTypeOfNumberYouHaventEvenWrittenYet.&quot; What is list ?"},{"owner":{"account_id":401843,"reputation":89863,"user_id":768644,"display_name":"rzwitserloot"},"score":0,"creation_date":1694367524,"post_id":77074602,"comment_id":135878759,"body_markdown":"@Oscar Given a `List&lt;? extends WhateverYouWant&gt; list`, you can&#39;t call `.add()` on that list. Except, literally, `list.add(null);`. Given that `List&lt;?&gt;` is short for `List&lt;? extends Object&gt;`, you can&#39;t call `.add()` on that either.","body":"@Oscar Given a <code>List&lt;? extends WhateverYouWant&gt; list</code>, you can&#39;t call <code>.add()</code> on that list. Except, literally, <code>list.add(null);</code>. Given that <code>List&lt;?&gt;</code> is short for <code>List&lt;? extends Object&gt;</code>, you can&#39;t call <code>.add()</code> on that either."},{"owner":{"account_id":401843,"reputation":89863,"user_id":768644,"display_name":"rzwitserloot"},"score":0,"creation_date":1694367567,"post_id":77074602,"comment_id":135878764,"body_markdown":"e.g.: `List&lt;? extends Number&gt; listOfNumbers = ...; Number n = something; listOfNumbers.add(n);` - this does not compile. You can&#39;t `.add()` anything to this list.","body":"e.g.: <code>List&lt;? extends Number&gt; listOfNumbers = ...; Number n = something; listOfNumbers.add(n);</code> - this does not compile. You can&#39;t <code>.add()</code> anything to this list."}],"tags":[],"owner":{"account_id":401843,"reputation":89863,"user_id":768644,"display_name":"rzwitserloot"},"comment_count":10,"down_vote_count":1,"up_vote_count":9,"is_accepted":false,"score":8,"last_activity_date":1694316290,"creation_date":1694311657,"answer_id":77074602,"question_id":77074444,"body_markdown":"It _compiles_. But it does not _run_. Try it - shove that in a `main` method and execute it. You&#39;ll get a ClassCastException.\r\n\r\nThere are a number of things going on here. Most of this is &#39;programming language archeology&#39; - none of it makes sense and none of it is particularly consistent. If your aim is to learn the language better, there&#39;s a very simple rule you should apply to your java programming:\r\n\r\n1. Do not use arrays. At all. For anything. Except perhaps arrays of primitive types (`int[]`, `long[]`, etcetera) for performance reasons. There is no point to them. They aren&#39;t faster than lists and have all sorts of wonky downsides. Including effectively broken equals and hashCode and toString implementations (in that they do unexpected things; the spec properly explains these things, but an API that does what the spec says it does, but the spec says bizarro unexpected things, well, I&#39;ll let the reader come up with a term for it. I trust it won&#39;t be a particularly nice term), they are this useless amalgamation of immutable-ish (they can neither grow nor shrink) but not actually immutable (you can set values), and more.\r\n\r\n2. When casting arrays, assume that the compiler has no idea and you&#39;ll have to rely on runtime exceptions. Really, once you&#39;ve reached this level (You&#39;re casting arrays), you need to back up and fix whatever got you into that mess.\r\n\r\nThere is really not much point in going any further if your aim is to be a good java coder.\r\n\r\nBut, hey, you asked - so, let&#39;s put on our brown hat, grab a whip, play the Indiana Jones themesong, and go spelunkin&#39; into the depths of java&#39;s distant past!\r\n\r\n## Covariance, Contravariance, Invariance.\r\n\r\nWe need to cover the key problem first. An answer has already been posted by somebody who does not understand type systems, so, that&#39;s anecdotal proof this needs to be explained first.\r\n\r\nJava&#39;s type system is itself &#39;covariant&#39;. That means: Any type is a fine substitution for any of its supertypes. If you have a method that requires that you pass it a `Number` parameter, you can pass an expression of type `Integer`, no problem.\r\n\r\nHowever, once you move up to listy things (be it generics, or arrays) __this does not work__. They should be __invariant__ - Only the exact type required will do and no other type can substitute.\r\n\r\nThat&#39;s because you can actually both __write__ _and_ __read__ from listy things and therein lies the problem. Here&#39;s a trivial example:\r\n\r\n```\r\nInteger i = 5;\r\nNumber n = i; // this is fine.\r\n\r\nInteger[] is = new Integer[10];\r\nNumber[] ns = is; // fine, too? right? Maybe?\r\nns[0] = 5.5; // ... a double\r\nInteger firstElement = is[0]; // BOOM!\r\n```\r\n\r\nThat last line shows the problem. Because basic java types are covariant and will remain so, the `ns[0] = 5.5` line has to compile - I&#39;m assigning a Double to a place that requires a Number. Nevertheless this leads to a problem on the last line.\r\n\r\n__Generics gets this right__. The generics equivalent is this:\r\n\r\n```\r\nList&lt;Integer&gt; is = new ArrayList&lt;Integer&gt;();\r\nList&lt;Number&gt; ns = is; // This does not compile!\r\n```\r\n\r\nAnd gives you the tools you need to make nice APIs; you can ask for covariance (`List&lt;? extends Number&gt;`, where a `List&lt;Integer&gt;` _is_ acceptable, but the compiler prevents you from writing to this list to ensure the &#39;whoops there is a double in my list of integers&#39; problem cannot occur), and even contravariance (`List&lt;? super Integer&gt;`, where you can pass a `List&lt;Integer&gt;`, or `List&lt;Number&gt;`, or a `List&lt;Object&gt;`. You can write to it (any integer - which works fine regardless of which of those 3 kinds of lists is actually passed in), but the compiler prevents you from reading. Or rather, returns `Object`, given that List in general guarantees that whatever it stores, it&#39;s at least Object).\r\n\r\nHere&#39;s a good tip: When you read `List&lt;? extends Number&gt;` you may be translating that: &quot;A list, containing things whose type is Number or subtypes of Number - you know, things whose type is.. something, that extends Number&quot;. __That is wrong__. You&#39;re supposed to read it as: &quot;A list, limited to contain some type that _I simply do not know here_ (see the question mark? That means &#39;don&#39;t know&#39;). All I know is: That restriction is Number or some subtype there of. It could be a list that is only supposed to store integers. Could be Doubles. Could be any Number. No idea. Everything I do with this list must be valid regardless of whether that&#39;s a `List&lt;Number&gt;` or a `List&lt;Integer&gt;` or a `List&lt;Double&gt;` or any other `List&lt;X&gt;` where X is a subtype of Number. _It has to work for __ALL__ of them or it is not valid java and the compiler will refuse it_. Hence why `list.add()` doesn&#39;t work here - there is no value that is both Double and Integer and Number and SomeSubTypeOfNumberYouHaventEvenWrittenYet. Well, except the literal `null` which indeed you can actually pass, the only way to call `add` at all.\r\n\r\n__Arrays get this totally wrong__.\r\n\r\nWhy? Well, generics is really complicated. The notion that you need 4 different types that all are `List&lt;Number&gt;` adjacent but subtly different is already quite complex:\r\n\r\n* `List` (raw/legacy type. Perhaps if java had had generics from v1.0 this would not be needed).\r\n* `List&lt;Number&gt;`\r\n* `List&lt;? extends Number&gt;`\r\n* `List&lt;? super Number&gt;`\r\n\r\nand java was trying to &#39;keep things simple&#39; so didn&#39;t add this. Generics didn&#39;t show up until java 1.5, over a decade later.\r\n\r\nIn some ways the designers of java were apparently (it&#39;s been a looong time, I haven&#39;t asked them) also not aware that the component type of a listy thing just cannot be covariant. Or, more likely, sometimes you want to write code that operates on arbitrary arrays and the language designers decided to just let the compiler get out of the way, turn java into more or less a dynamically typed (i.e. the compiler doesn&#39;t help you) situation where only the runtime exists to prevent problems from occurring.\r\n\r\nHence, you can do this stuff:\r\n\r\n```\r\nObject is = new Integer[10];\r\nNumber[] numbers = (Number[]) is;\r\nis[0] = 5.5;\r\n```\r\n\r\nThat code compiles, but when you run it.. the second line works, but the third line doesn&#39;t - fails with an ArrayStoreException. That&#39;s because arrays do know what their component type is, and thus the `is[0] =..` assignment does check: Hey, what&#39;s the _actual_ component type of the array object that the `is` variable is pointing at? Oh it&#39;s `Integer[]`.. hmm, then, ArrayStoreException. It&#39;s a variant of ClassCastException in that sense.\r\n\r\nSimilarly, you can actually cast Object arrays to whatever array type you want, but the system is designed so that _storing_ things into arrays might fail with an ArrayStoreException, but _reading_ them never will. Because it&#39;s easier to reason about code when you know certain things aren&#39;t possible. Such as non-integers being in your `Integer[]` array.\r\n\r\nTo ensure that rule, when you cast an array, the runtime checks and won&#39;t let you if it means read operations could fail. Hence why arrays are covariant-ish:\r\n\r\n```\r\nObject xs = new Integer[100];\r\nNumber[] ns = (Number[]) xs; // allowed\r\nxs = new Number[100];\r\nInteger[] is = (Integer[]) xs; // not allowed\r\n```\r\n\r\nWhere &#39;not allowed&#39; means: Usually compiles fine, but at runtime results in a `ClassCastException`.\r\n\r\nThe only reason it works that way is that the &#39;allowed&#39; line is still broken (in that you&#39;d expect an array of type `Number[]` to allow you to write any Number to it, whereas here this one doesn&#39;t and will fail with an ArrayStoreEx unless it&#39;s an Integer), but allowed because it can&#39;t break when _reading_ from it (whatever is in that array, it&#39;s at least a Number. Because all Integers are Numbers and the only thing that array can store is Integer objects). Whereas the second is not allowed, because if it had been allowed, __reading from it could cause problems__. `ArrayStoreException` exists; `ArrayReadException` does not.\r\n\r\nWhy was the choice made this way? At some point we&#39;ve arrived at a dead end. The answer to _that_ is: &quot;Because the spec says so&quot; and if you want to know why _that_ is the case, the answer is: &quot;Because the designers at the time wanted it that way&quot;. Any further &#39;but.. why?&#39; questions should be directed directly at James Gosling and co.\r\n","title":"why does &quot;Integer [ ] x = (Integer [ ]) new Object[100]; &quot; compile?","body":"<p>It <em>compiles</em>. But it does not <em>run</em>. Try it - shove that in a <code>main</code> method and execute it. You'll get a ClassCastException.</p>\n<p>There are a number of things going on here. Most of this is 'programming language archeology' - none of it makes sense and none of it is particularly consistent. If your aim is to learn the language better, there's a very simple rule you should apply to your java programming:</p>\n<ol>\n<li><p>Do not use arrays. At all. For anything. Except perhaps arrays of primitive types (<code>int[]</code>, <code>long[]</code>, etcetera) for performance reasons. There is no point to them. They aren't faster than lists and have all sorts of wonky downsides. Including effectively broken equals and hashCode and toString implementations (in that they do unexpected things; the spec properly explains these things, but an API that does what the spec says it does, but the spec says bizarro unexpected things, well, I'll let the reader come up with a term for it. I trust it won't be a particularly nice term), they are this useless amalgamation of immutable-ish (they can neither grow nor shrink) but not actually immutable (you can set values), and more.</p>\n</li>\n<li><p>When casting arrays, assume that the compiler has no idea and you'll have to rely on runtime exceptions. Really, once you've reached this level (You're casting arrays), you need to back up and fix whatever got you into that mess.</p>\n</li>\n</ol>\n<p>There is really not much point in going any further if your aim is to be a good java coder.</p>\n<p>But, hey, you asked - so, let's put on our brown hat, grab a whip, play the Indiana Jones themesong, and go spelunkin' into the depths of java's distant past!</p>\n<h2>Covariance, Contravariance, Invariance.</h2>\n<p>We need to cover the key problem first. An answer has already been posted by somebody who does not understand type systems, so, that's anecdotal proof this needs to be explained first.</p>\n<p>Java's type system is itself 'covariant'. That means: Any type is a fine substitution for any of its supertypes. If you have a method that requires that you pass it a <code>Number</code> parameter, you can pass an expression of type <code>Integer</code>, no problem.</p>\n<p>However, once you move up to listy things (be it generics, or arrays) <strong>this does not work</strong>. They should be <strong>invariant</strong> - Only the exact type required will do and no other type can substitute.</p>\n<p>That's because you can actually both <strong>write</strong> <em>and</em> <strong>read</strong> from listy things and therein lies the problem. Here's a trivial example:</p>\n<pre><code>Integer i = 5;\nNumber n = i; // this is fine.\n\nInteger[] is = new Integer[10];\nNumber[] ns = is; // fine, too? right? Maybe?\nns[0] = 5.5; // ... a double\nInteger firstElement = is[0]; // BOOM!\n</code></pre>\n<p>That last line shows the problem. Because basic java types are covariant and will remain so, the <code>ns[0] = 5.5</code> line has to compile - I'm assigning a Double to a place that requires a Number. Nevertheless this leads to a problem on the last line.</p>\n<p><strong>Generics gets this right</strong>. The generics equivalent is this:</p>\n<pre><code>List&lt;Integer&gt; is = new ArrayList&lt;Integer&gt;();\nList&lt;Number&gt; ns = is; // This does not compile!\n</code></pre>\n<p>And gives you the tools you need to make nice APIs; you can ask for covariance (<code>List&lt;? extends Number&gt;</code>, where a <code>List&lt;Integer&gt;</code> <em>is</em> acceptable, but the compiler prevents you from writing to this list to ensure the 'whoops there is a double in my list of integers' problem cannot occur), and even contravariance (<code>List&lt;? super Integer&gt;</code>, where you can pass a <code>List&lt;Integer&gt;</code>, or <code>List&lt;Number&gt;</code>, or a <code>List&lt;Object&gt;</code>. You can write to it (any integer - which works fine regardless of which of those 3 kinds of lists is actually passed in), but the compiler prevents you from reading. Or rather, returns <code>Object</code>, given that List in general guarantees that whatever it stores, it's at least Object).</p>\n<p>Here's a good tip: When you read <code>List&lt;? extends Number&gt;</code> you may be translating that: &quot;A list, containing things whose type is Number or subtypes of Number - you know, things whose type is.. something, that extends Number&quot;. <strong>That is wrong</strong>. You're supposed to read it as: &quot;A list, limited to contain some type that <em>I simply do not know here</em> (see the question mark? That means 'don't know'). All I know is: That restriction is Number or some subtype there of. It could be a list that is only supposed to store integers. Could be Doubles. Could be any Number. No idea. Everything I do with this list must be valid regardless of whether that's a <code>List&lt;Number&gt;</code> or a <code>List&lt;Integer&gt;</code> or a <code>List&lt;Double&gt;</code> or any other <code>List&lt;X&gt;</code> where X is a subtype of Number. <em>It has to work for <strong>ALL</strong> of them or it is not valid java and the compiler will refuse it</em>. Hence why <code>list.add()</code> doesn't work here - there is no value that is both Double and Integer and Number and SomeSubTypeOfNumberYouHaventEvenWrittenYet. Well, except the literal <code>null</code> which indeed you can actually pass, the only way to call <code>add</code> at all.</p>\n<p><strong>Arrays get this totally wrong</strong>.</p>\n<p>Why? Well, generics is really complicated. The notion that you need 4 different types that all are <code>List&lt;Number&gt;</code> adjacent but subtly different is already quite complex:</p>\n<ul>\n<li><code>List</code> (raw/legacy type. Perhaps if java had had generics from v1.0 this would not be needed).</li>\n<li><code>List&lt;Number&gt;</code></li>\n<li><code>List&lt;? extends Number&gt;</code></li>\n<li><code>List&lt;? super Number&gt;</code></li>\n</ul>\n<p>and java was trying to 'keep things simple' so didn't add this. Generics didn't show up until java 1.5, over a decade later.</p>\n<p>In some ways the designers of java were apparently (it's been a looong time, I haven't asked them) also not aware that the component type of a listy thing just cannot be covariant. Or, more likely, sometimes you want to write code that operates on arbitrary arrays and the language designers decided to just let the compiler get out of the way, turn java into more or less a dynamically typed (i.e. the compiler doesn't help you) situation where only the runtime exists to prevent problems from occurring.</p>\n<p>Hence, you can do this stuff:</p>\n<pre><code>Object is = new Integer[10];\nNumber[] numbers = (Number[]) is;\nis[0] = 5.5;\n</code></pre>\n<p>That code compiles, but when you run it.. the second line works, but the third line doesn't - fails with an ArrayStoreException. That's because arrays do know what their component type is, and thus the <code>is[0] =..</code> assignment does check: Hey, what's the <em>actual</em> component type of the array object that the <code>is</code> variable is pointing at? Oh it's <code>Integer[]</code>.. hmm, then, ArrayStoreException. It's a variant of ClassCastException in that sense.</p>\n<p>Similarly, you can actually cast Object arrays to whatever array type you want, but the system is designed so that <em>storing</em> things into arrays might fail with an ArrayStoreException, but <em>reading</em> them never will. Because it's easier to reason about code when you know certain things aren't possible. Such as non-integers being in your <code>Integer[]</code> array.</p>\n<p>To ensure that rule, when you cast an array, the runtime checks and won't let you if it means read operations could fail. Hence why arrays are covariant-ish:</p>\n<pre><code>Object xs = new Integer[100];\nNumber[] ns = (Number[]) xs; // allowed\nxs = new Number[100];\nInteger[] is = (Integer[]) xs; // not allowed\n</code></pre>\n<p>Where 'not allowed' means: Usually compiles fine, but at runtime results in a <code>ClassCastException</code>.</p>\n<p>The only reason it works that way is that the 'allowed' line is still broken (in that you'd expect an array of type <code>Number[]</code> to allow you to write any Number to it, whereas here this one doesn't and will fail with an ArrayStoreEx unless it's an Integer), but allowed because it can't break when <em>reading</em> from it (whatever is in that array, it's at least a Number. Because all Integers are Numbers and the only thing that array can store is Integer objects). Whereas the second is not allowed, because if it had been allowed, <strong>reading from it could cause problems</strong>. <code>ArrayStoreException</code> exists; <code>ArrayReadException</code> does not.</p>\n<p>Why was the choice made this way? At some point we've arrived at a dead end. The answer to <em>that</em> is: &quot;Because the spec says so&quot; and if you want to know why <em>that</em> is the case, the answer is: &quot;Because the designers at the time wanted it that way&quot;. Any further 'but.. why?' questions should be directed directly at James Gosling and co.</p>\n"}],"owner":{"account_id":22435873,"reputation":65,"user_id":16641133,"display_name":"Oscar"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":139,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":1,"score":3,"last_activity_date":1694316290,"creation_date":1694305775,"question_id":77074444,"body_markdown":"I compile: \r\n```\r\nInteger [ ] x = (Integer [ ]) new Object[100];\r\n```\r\nit succeeds. \r\nand I don&#39;t know Why?","title":"why does &quot;Integer [ ] x = (Integer [ ]) new Object[100]; &quot; compile?","body":"<p>I compile:</p>\n<pre><code>Integer [ ] x = (Integer [ ]) new Object[100];\n</code></pre>\n<p>it succeeds.\nand I don't know Why?</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":83916,"reputation":171,"user_id":234941,"display_name":"vmlinuz"},"score":0,"creation_date":1282116250,"post_id":3509046,"comment_id":3668486,"body_markdown":"Erm, what do you want to send AT commands to?","body":"Erm, what do you want to send AT commands to?"},{"owner":{"account_id":8568290,"reputation":357,"user_id":6420121,"display_name":"lansanalsm"},"score":0,"creation_date":1640689824,"post_id":3509046,"comment_id":124633283,"body_markdown":"Were you able to find any solution for this, i&#39;m trying to achieve the same thing","body":"Were you able to find any solution for this, i&#39;m trying to achieve the same thing"}],"answers":[{"comments":[{"owner":{"account_id":174589,"reputation":289,"user_id":404052,"accept_rate":0,"display_name":"Mobile_Application_Developer"},"score":0,"creation_date":1282127100,"post_id":3510829,"comment_id":3669899,"body_markdown":"Thanks balaji duddukuri.....\n\n\nbut can you please explain how to embed this AT command syntax in android (java) code.\nactually i want to disconnect incoming call programmatically for which i want to use AT+CHUP command but nnot getting how to execute this in java code.","body":"Thanks balaji duddukuri.....   but can you please explain how to embed this AT command syntax in android (java) code. actually i want to disconnect incoming call programmatically for which i want to use AT+CHUP command but nnot getting how to execute this in java code."},{"owner":{"account_id":174589,"reputation":289,"user_id":404052,"accept_rate":0,"display_name":"Mobile_Application_Developer"},"score":0,"creation_date":1282204529,"post_id":3510829,"comment_id":3680596,"body_markdown":"Can we use RIL (Radio Interface Layer) to disconnect incoming call ??\nplease reply..\nThanks","body":"Can we use RIL (Radio Interface Layer) to disconnect incoming call ?? please reply.. Thanks"}],"tags":[],"owner":{"account_id":645735,"reputation":1,"user_id":423828,"display_name":"balaji duddukuri"},"comment_count":2,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1299797639,"creation_date":1282125032,"answer_id":3510829,"question_id":3509046,"body_markdown":"Use syntax like this and let me know:\r\n\r\n    echo -e &quot;AT+CFUN=?\\r\\n&quot; &gt; /dev/ttyUSB0","title":"How to use AT commands in Android applications?","body":"<p>Use syntax like this and let me know:</p>\n\n<pre><code>echo -e \"AT+CFUN=?\\r\\n\" &gt; /dev/ttyUSB0\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1025319,"reputation":418,"user_id":1034755,"accept_rate":100,"display_name":"boettger1"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1320772782,"creation_date":1320772782,"answer_id":8054470,"question_id":3509046,"body_markdown":"The invokeOemRilRequestRaw() and invokeOemRilRequestStrings() methods which have implementations in a number of classes (RIL, PhoneProxy, PhoneBase, and some others) are what you need, but they are not available through the SDK and thus off-limits to us mere mortals.","title":"How to use AT commands in Android applications?","body":"<p>The invokeOemRilRequestRaw() and invokeOemRilRequestStrings() methods which have implementations in a number of classes (RIL, PhoneProxy, PhoneBase, and some others) are what you need, but they are not available through the SDK and thus off-limits to us mere mortals.</p>\n"},{"tags":[],"owner":{"account_id":1170362,"reputation":15132,"user_id":1147688,"accept_rate":53,"display_name":"not2qubit"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1328029690,"creation_date":1328029690,"answer_id":9083775,"question_id":3509046,"body_markdown":"1. There is a great review of this in the XDA forum thread:\r\n\r\n   [*How to talk to the Modem with AT commands*][1].\r\n\r\n   That thread show you how to send AT commands (ATC) with a remote \r\n   terminal (USB connected to you PC), but it has not yet solved the \r\n   problem of how to use a local (phone) terminal to talk to the \r\n   phone Modem.\r\n\r\n2. You need a terminal application/program to do any talking to the\r\n   modem (remember, its a 2-way communication). So that&#39;s why you need\r\n   a rooted device, since the root kit usually come with *Busybox*\r\n   (that includes a *microcom* terminal program). Otherwise you have to\r\n   write your own program.\r\n\r\n3. AFAIK. You can disconnect incoming calls in many other and easier \r\n   ways than with AT commands. \r\n\r\n  [1]: http://forum.xda-developers.com/showthread.php?t=1471241\r\n","title":"How to use AT commands in Android applications?","body":"<ol>\n<li><p>There is a great review of this in the XDA forum thread:</p>\n\n<p><a href=\"http://forum.xda-developers.com/showthread.php?t=1471241\" rel=\"nofollow\"><em>How to talk to the Modem with AT commands</em></a>.</p>\n\n<p>That thread show you how to send AT commands (ATC) with a remote \nterminal (USB connected to you PC), but it has not yet solved the \nproblem of how to use a local (phone) terminal to talk to the \nphone Modem.</p></li>\n<li><p>You need a terminal application/program to do any talking to the\nmodem (remember, its a 2-way communication). So that's why you need\na rooted device, since the root kit usually come with <em>Busybox</em>\n(that includes a <em>microcom</em> terminal program). Otherwise you have to\nwrite your own program.</p></li>\n<li><p>AFAIK. You can disconnect incoming calls in many other and easier \nways than with AT commands. </p></li>\n</ol>\n"}],"owner":{"account_id":174589,"reputation":289,"user_id":404052,"accept_rate":0,"display_name":"Mobile_Application_Developer"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":9375,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"answer_count":3,"score":1,"last_activity_date":1694315281,"creation_date":1282107010,"question_id":3509046,"body_markdown":"I want to send AT commands in my Android application, but I could not find the right syntax. How can I do this?\r\n","title":"How to use AT commands in Android applications?","body":"<p>I want to send AT commands in my Android application, but I could not find the right syntax. How can I do this?</p>\n"},{"tags":["java","spring-boot","apache-kafka","spring-kafka","kafka-producer-api"],"answers":[{"comments":[{"owner":{"account_id":27618172,"reputation":31,"user_id":21079823,"display_name":"PTInnovating"},"score":0,"creation_date":1674667273,"post_id":75235122,"comment_id":132765084,"body_markdown":"Thanks for the reply. Ideally get(...) will block the other request at a time(for the timeout set). Could you please suggest which is the better approach to send record to kafka async with callback listener or the get on the future.","body":"Thanks for the reply. Ideally get(...) will block the other request at a time(for the timeout set). Could you please suggest which is the better approach to send record to kafka async with callback listener or the get on the future."},{"owner":{"account_id":1288095,"reputation":169336,"user_id":1240763,"display_name":"Gary Russell"},"score":0,"creation_date":1674669133,"post_id":75235122,"comment_id":132765657,"body_markdown":"If you want to block the caller thread until the result is received, get is simplest. Async would mean you&#39;d have to write code to block the caller and wake him when the result is received.","body":"If you want to block the caller thread until the result is received, get is simplest. Async would mean you&#39;d have to write code to block the caller and wake him when the result is received."},{"owner":{"account_id":27618172,"reputation":31,"user_id":21079823,"display_name":"PTInnovating"},"score":0,"creation_date":1679505297,"post_id":75235122,"comment_id":133735495,"body_markdown":"Can you help me with this one as well.\nhttps://stackoverflow.com/questions/75780715/kafka-producer-producing-values-in-alternative-even-partitions-like-0-2-4-etc","body":"Can you help me with this one as well. <a href=\"https://stackoverflow.com/questions/75780715/kafka-producer-producing-values-in-alternative-even-partitions-like-0-2-4-etc\" title=\"kafka producer producing values in alternative even partitions like 0 2 4 etc\">stackoverflow.com/questions/75780715/&hellip;</a>"}],"tags":[],"owner":{"account_id":1288095,"reputation":169336,"user_id":1240763,"display_name":"Gary Russell"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1674655294,"creation_date":1674655294,"answer_id":75235122,"question_id":75234212,"body_markdown":"Don&#39;t use an async listener, simply call `get(...)` on the future (with some timeout) and the thread will block until success or failure.","title":"KAFKA ListenableFuture spring- how to return client a response with object based on onsuccess method future.addCallback as onsuccess is void","body":"<p>Don't use an async listener, simply call <code>get(...)</code> on the future (with some timeout) and the thread will block until success or failure.</p>\n"},{"tags":[],"owner":{"account_id":29405252,"reputation":1,"user_id":22530469,"display_name":"Fanindhra Thirunagaru"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694313074,"creation_date":1694313052,"answer_id":77074638,"question_id":75234212,"body_markdown":"    future.completable().join();\r\n\r\n\r\nBy using the above line of code and a small flag for updating the status, the main thread will wait until the callback is completed before exiting and you can compare the flag to return or leave it.\r\n\r\njoin() returns the result after the future is completed.\r\n","title":"KAFKA ListenableFuture spring- how to return client a response with object based on onsuccess method future.addCallback as onsuccess is void","body":"<pre><code>future.completable().join();\n</code></pre>\n<p>By using the above line of code and a small flag for updating the status, the main thread will wait until the callback is completed before exiting and you can compare the flag to return or leave it.</p>\n<p>join() returns the result after the future is completed.</p>\n"}],"owner":{"account_id":27618172,"reputation":31,"user_id":21079823,"display_name":"PTInnovating"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":670,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1694313074,"creation_date":1674650896,"question_id":75234212,"body_markdown":"```java\r\npublic class Test {\r\n\r\n    public StudentDto publishStudentDto\r\n\r\n    {\r\n        ListenableFuture&lt;SendResult&lt;String, Student&gt;&gt; future = this.studentKafkaTemplate.send(topicName, student);\r\n        future.addCallback(new ListenableFutureCallback&lt;SendResult&lt;String, Student&gt;&gt;() {\r\n            @Override\r\n            public void onSuccess(SendResult&lt;String, Student&gt; result) {\r\n                logger.info(&quot;Student created &amp; message published to topic: {} with offset: {} to partition {}&quot;, student, result.getRecordMetadata().offset(), result.getRecordMetadata().partition());\r\n            }\r\n\r\n            @Override\r\n            public void onFailure(Throwable ex) {\r\n                logger.error(&quot;student not created. Error in publishing student to topic : &quot; + student, ex);\r\n            }\r\n        });\r\n    }\r\n}\r\n```\r\nI want to return StudentDto to controller if Student is published successfully on topic. But as onSuccess is called after the response is returned to controller. Is there is any way i can return StudentDto if it published successfully.\r\n\r\nI want to return StudentDto to controller if Student is published successfully on topic. But as onSuccess is called after the response is returned to controller. Is there is any way i can return StudentDto if it published successfully.","title":"KAFKA ListenableFuture spring- how to return client a response with object based on onsuccess method future.addCallback as onsuccess is void","body":"<pre class=\"lang-java prettyprint-override\"><code>public class Test {\n\n    public StudentDto publishStudentDto\n\n    {\n        ListenableFuture&lt;SendResult&lt;String, Student&gt;&gt; future = this.studentKafkaTemplate.send(topicName, student);\n        future.addCallback(new ListenableFutureCallback&lt;SendResult&lt;String, Student&gt;&gt;() {\n            @Override\n            public void onSuccess(SendResult&lt;String, Student&gt; result) {\n                logger.info(&quot;Student created &amp; message published to topic: {} with offset: {} to partition {}&quot;, student, result.getRecordMetadata().offset(), result.getRecordMetadata().partition());\n            }\n\n            @Override\n            public void onFailure(Throwable ex) {\n                logger.error(&quot;student not created. Error in publishing student to topic : &quot; + student, ex);\n            }\n        });\n    }\n}\n</code></pre>\n<p>I want to return StudentDto to controller if Student is published successfully on topic. But as onSuccess is called after the response is returned to controller. Is there is any way i can return StudentDto if it published successfully.</p>\n<p>I want to return StudentDto to controller if Student is published successfully on topic. But as onSuccess is called after the response is returned to controller. Is there is any way i can return StudentDto if it published successfully.</p>\n"},{"tags":["java","xml","namespaces","rdf4j"],"answers":[{"comments":[{"owner":{"account_id":4153704,"reputation":549,"user_id":3405484,"display_name":"Abdelghani"},"score":0,"creation_date":1695124465,"post_id":77074568,"comment_id":135979462,"body_markdown":"Thanks a lot @Jeen Broekstra. Your answer made things very clear :)","body":"Thanks a lot @Jeen Broekstra. Your answer made things very clear :)"}],"tags":[],"owner":{"account_id":203984,"reputation":21757,"user_id":451941,"accept_rate":100,"display_name":"Jeen Broekstra"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1694311243,"creation_date":1694310601,"answer_id":77074568,"question_id":77000281,"body_markdown":"A namespace is not the same thing as a base URI, and there is no such thing as a &quot;base namespace&quot;. Namespaces are an abbreviation mechanism for URIs where you define a prefix that replaces the first part of a full URI with a short string, so that in your RDF data you can represent the URI with a &quot;prefixed name&quot; (depending on the specific RDF syntax what that looks like, exactly).\r\n\r\nBase URIs, on the other hand, are a generic parser/writer mechanism that allows resolving _relative URIs_ in the data. Some syntax formats (like XML) allow defining the base URI in the document itself, others don&#39;t, but they serve a different purpose than namespaces.\r\n\r\nAs an example, this XML snippet:\r\n\r\n```xml\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;rdf:RDF\r\nxmlns:base=&quot;http://example.org/&quot;&gt;\r\n  &lt;rdf:Description rdf:about=&quot;foo&quot;&gt;\r\n....\r\n```\r\n   \r\nis legal RDF, despite the fact that the RDF/XML syntax spec requires that the value of the `rdf:about` attribute (the _subject_) is a full URI. The reason it&#39;s legal is that a base URI is defined against which the string `foo` can be resolved as a relative URI. The resolved full URI will be `http://example.org/foo`. Note that this has _nothing_ to do with namespaces.\r\n\r\nWhat is happening in your code is that you are  not using base URIs at all. In the first part you are defining an RDF model in memory, using the `ModelBuilder`. You are adding the string `base:foo` as a subject URI. The `ModelBuilder` (actually, the `ValueFactory`, but it comes tot the same thing) interprets this as a full URI, because there is no namespace defined in the ModelBuilder that has `base` as its prefix. \r\n\r\nWriting that model to XML file does not change that, regardless of what you define as base URI or namespaces _while writing_: you are exporting an RDF model that has `base:foo` as a full URI, so that&#39;s what you&#39;ll get in your output.\r\n\r\nTo get what you want, you need to make sure that your `Model` object has the full URIs, and that, instead of trying add a namespace to the writer, you set its base URI when _creating_ the writer.\r\n\r\n```java\r\n\t\tvar model = new ModelBuilder().add(&quot;http://example.org/foo&quot;, RDFS.ISDEFINEDBY, &quot;http://example.org/FOO&quot;).build();\r\n\t\tvar writer = Rio.createWriter(RDFFormat.RDFXML, System.out, &quot;http://example.org/&quot;);\r\n\r\n\t\twriter.startRDF();\r\n\t\tfor (Statement st : model) {\r\n\t\t\twriter.handleStatement(st);\r\n\t\t}\r\n\t\twriter.endRDF();\r\n```\r\n\r\n...or more succinctly:\r\n\r\n```java\r\n\t\tvar model = new ModelBuilder().add(&quot;http://example.org/foo&quot;, RDFS.ISDEFINEDBY, &quot;http://example.org/FOO&quot;).build();\r\n\r\n\t\tRio.write(model, System.out, &quot;http://example.org/&quot;, RDFFormat.RDFXML);\r\n```\r\n\r\n\r\nIf you don&#39;t like having to write the full URI every time when creating your model, that&#39;s where namespaces can come in handy, for example:\r\n\r\n```java\r\n\t\tvar model = new ModelBuilder().setNamespace(&quot;ex&quot;, &quot;http://example.org/&quot;)\r\n                .add(&quot;ex:foo&quot;, RDFS.ISDEFINEDBY, &quot;ex:FOO&quot;).build();\r\n```\r\n","title":"org.eclipse.rdf4j.rio.RDFWriter, how to set base namespace when writing document","body":"<p>A namespace is not the same thing as a base URI, and there is no such thing as a &quot;base namespace&quot;. Namespaces are an abbreviation mechanism for URIs where you define a prefix that replaces the first part of a full URI with a short string, so that in your RDF data you can represent the URI with a &quot;prefixed name&quot; (depending on the specific RDF syntax what that looks like, exactly).</p>\n<p>Base URIs, on the other hand, are a generic parser/writer mechanism that allows resolving <em>relative URIs</em> in the data. Some syntax formats (like XML) allow defining the base URI in the document itself, others don't, but they serve a different purpose than namespaces.</p>\n<p>As an example, this XML snippet:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;rdf:RDF\nxmlns:base=&quot;http://example.org/&quot;&gt;\n  &lt;rdf:Description rdf:about=&quot;foo&quot;&gt;\n....\n</code></pre>\n<p>is legal RDF, despite the fact that the RDF/XML syntax spec requires that the value of the <code>rdf:about</code> attribute (the <em>subject</em>) is a full URI. The reason it's legal is that a base URI is defined against which the string <code>foo</code> can be resolved as a relative URI. The resolved full URI will be <code>http://example.org/foo</code>. Note that this has <em>nothing</em> to do with namespaces.</p>\n<p>What is happening in your code is that you are  not using base URIs at all. In the first part you are defining an RDF model in memory, using the <code>ModelBuilder</code>. You are adding the string <code>base:foo</code> as a subject URI. The <code>ModelBuilder</code> (actually, the <code>ValueFactory</code>, but it comes tot the same thing) interprets this as a full URI, because there is no namespace defined in the ModelBuilder that has <code>base</code> as its prefix.</p>\n<p>Writing that model to XML file does not change that, regardless of what you define as base URI or namespaces <em>while writing</em>: you are exporting an RDF model that has <code>base:foo</code> as a full URI, so that's what you'll get in your output.</p>\n<p>To get what you want, you need to make sure that your <code>Model</code> object has the full URIs, and that, instead of trying add a namespace to the writer, you set its base URI when <em>creating</em> the writer.</p>\n<pre class=\"lang-java prettyprint-override\"><code>        var model = new ModelBuilder().add(&quot;http://example.org/foo&quot;, RDFS.ISDEFINEDBY, &quot;http://example.org/FOO&quot;).build();\n        var writer = Rio.createWriter(RDFFormat.RDFXML, System.out, &quot;http://example.org/&quot;);\n\n        writer.startRDF();\n        for (Statement st : model) {\n            writer.handleStatement(st);\n        }\n        writer.endRDF();\n</code></pre>\n<p>...or more succinctly:</p>\n<pre class=\"lang-java prettyprint-override\"><code>        var model = new ModelBuilder().add(&quot;http://example.org/foo&quot;, RDFS.ISDEFINEDBY, &quot;http://example.org/FOO&quot;).build();\n\n        Rio.write(model, System.out, &quot;http://example.org/&quot;, RDFFormat.RDFXML);\n</code></pre>\n<p>If you don't like having to write the full URI every time when creating your model, that's where namespaces can come in handy, for example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>        var model = new ModelBuilder().setNamespace(&quot;ex&quot;, &quot;http://example.org/&quot;)\n                .add(&quot;ex:foo&quot;, RDFS.ISDEFINEDBY, &quot;ex:FOO&quot;).build();\n</code></pre>\n"}],"owner":{"account_id":4153704,"reputation":549,"user_id":3405484,"display_name":"Abdelghani"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":50,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":77074568,"answer_count":1,"score":1,"last_activity_date":1694311243,"creation_date":1693312697,"question_id":77000281,"body_markdown":"I am using the rdf4j library to export xml files.\r\nI use org.eclipse.rdf4j.rio.RDFWriter to save it in a file and I need to define the base namespace. So I expect to have something like :\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;rdf:RDF\r\n    xml:base=&quot;http://exmaple.org/&quot;&gt;\r\n    &lt;rdf:Description rdf:about=foo&gt;\r\n    &lt;rdf:type rdf:resource= FOO&gt;\r\n    ...\r\n\r\nI understood that I can set a namespace using handleNamespace(). But I cant figure out how to use it to set the base namespace : I tried :\r\n\r\n    ModelBuilder builder = new ModelBuilder();\r\n    ValueFactory vf = SimpleValueFactory.getInstance();\r\n    builder.add(vf.createIRI(&quot;base:foo&quot;), RDFS.ISDEFINEDBY, vf.createIRI(&quot;base:FOO&quot;);\r\n    Model model = builder.build();\r\n\tRDFWriter writer = Rio.createWriter(RDFFormat.RDFXML, someOutputStream);\r\n\ttry {\r\n\t  writer.startRDF();\r\n\t  writer.handleNamespace(&quot;base&quot;, &quot;http://exmaple.org/&quot;);\r\n          for (Statement st: model) {\r\n      writer.handleStatement(st);\r\n      }\r\n      writer.endRDF();\r\n    ...\r\n\r\nbut this does not give me what I expect :\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;rdf:RDF\r\n    xmlns:base=&quot;http://exmaple.org/&quot;&gt;\r\n    &lt;rdf:Description rdf:about=base:foo&gt;\r\n    &lt;rdf:type rdf:resource= base:FOO&gt;\r\n\r\n\r\nAny ideas?\r\n","title":"org.eclipse.rdf4j.rio.RDFWriter, how to set base namespace when writing document","body":"<p>I am using the rdf4j library to export xml files.\nI use org.eclipse.rdf4j.rio.RDFWriter to save it in a file and I need to define the base namespace. So I expect to have something like :</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;rdf:RDF\nxml:base=&quot;http://exmaple.org/&quot;&gt;\n&lt;rdf:Description rdf:about=foo&gt;\n&lt;rdf:type rdf:resource= FOO&gt;\n...\n</code></pre>\n<p>I understood that I can set a namespace using handleNamespace(). But I cant figure out how to use it to set the base namespace : I tried :</p>\n<pre><code>ModelBuilder builder = new ModelBuilder();\nValueFactory vf = SimpleValueFactory.getInstance();\nbuilder.add(vf.createIRI(&quot;base:foo&quot;), RDFS.ISDEFINEDBY, vf.createIRI(&quot;base:FOO&quot;);\nModel model = builder.build();\nRDFWriter writer = Rio.createWriter(RDFFormat.RDFXML, someOutputStream);\ntry {\n  writer.startRDF();\n  writer.handleNamespace(&quot;base&quot;, &quot;http://exmaple.org/&quot;);\n      for (Statement st: model) {\n  writer.handleStatement(st);\n  }\n  writer.endRDF();\n...\n</code></pre>\n<p>but this does not give me what I expect :</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;rdf:RDF\nxmlns:base=&quot;http://exmaple.org/&quot;&gt;\n&lt;rdf:Description rdf:about=base:foo&gt;\n&lt;rdf:type rdf:resource= base:FOO&gt;\n</code></pre>\n<p>Any ideas?</p>\n"},{"tags":["java","bouncycastle"],"comments":[{"owner":{"account_id":3421244,"reputation":35883,"user_id":2868801,"display_name":"dave_thompson_085"},"score":1,"creation_date":1692808983,"post_id":76962408,"comment_id":135675751,"body_markdown":"(1) 1.54 is almost a decade old; the latest release is 1.75 (2) you can generate a keypair using the standard JCA API `KeyPairGenerator.getInstance(algorithm,&quot;BC&quot;)` or the Bouncy &#39;lightweight&#39; API which varies depending on the algorithm which you didn&#39;t tell us (3) yes you can do this in Java code (or anything else that compiles to JVM code, e.g. Kotlin); show what you&#39;re trying to do and exactly how it doesn&#39;t work (compile error? runtime exception -- with stacktrace? wrong output -- what is it and what should it be?","body":"(1) 1.54 is almost a decade old; the latest release is 1.75 (2) you can generate a keypair using the standard JCA API <code>KeyPairGenerator.getInstance(algorithm,&quot;BC&quot;)</code> or the Bouncy &#39;lightweight&#39; API which varies depending on the algorithm which you didn&#39;t tell us (3) yes you can do this in Java code (or anything else that compiles to JVM code, e.g. Kotlin); show what you&#39;re trying to do and exactly how it doesn&#39;t work (compile error? runtime exception -- with stacktrace? wrong output -- what is it and what should it be?"},{"owner":{"account_id":965625,"reputation":1524,"user_id":1103606,"accept_rate":51,"display_name":"Peter Penzov"},"score":0,"creation_date":1692809201,"post_id":76962408,"comment_id":135675790,"body_markdown":"I tries this https://stackoverflow.com/questions/76963370/convert-byte-to-string-readable-text but I can&#39;t get the signature. Can you show me how to get the same result using JVM default classes, please?","body":"I tries this <a href=\"https://stackoverflow.com/questions/76963370/convert-byte-to-string-readable-text\" title=\"convert byte to string readable text\">stackoverflow.com/questions/76963370/&hellip;</a> but I can&#39;t get the signature. Can you show me how to get the same result using JVM default classes, please?"},{"owner":{"account_id":3421244,"reputation":35883,"user_id":2868801,"display_name":"dave_thompson_085"},"score":0,"creation_date":1692846624,"post_id":76962408,"comment_id":135680408,"body_markdown":"That Q (#76963370) is about a _certificate_, and the signature on the certificate, not a keypair. It sounds like what you really want is to generate a certificate, possibly a self-signed certificate although you aren&#39;t clear. Your baeldung link uses the `openssl` program to generate key and self-signed cert, or more simply you can just use the `-genkeypair` option of `keytool` -- it actually generates both a keypair and a self-signed cert. But with the standard Java (JCA) classes you can only generate the keypair NOT a cert. Per your link you can do a cert with Bouncy bcprov PLUS bcpkix.","body":"That Q (#76963370) is about a <i>certificate</i>, and the signature on the certificate, not a keypair. It sounds like what you really want is to generate a certificate, possibly a self-signed certificate although you aren&#39;t clear. Your baeldung link uses the <code>openssl</code> program to generate key and self-signed cert, or more simply you can just use the <code>-genkeypair</code> option of <code>keytool</code> -- it actually generates both a keypair and a self-signed cert. But with the standard Java (JCA) classes you can only generate the keypair NOT a cert. Per your link you can do a cert with Bouncy bcprov PLUS bcpkix."},{"owner":{"account_id":965625,"reputation":1524,"user_id":1103606,"accept_rate":51,"display_name":"Peter Penzov"},"score":0,"creation_date":1692863258,"post_id":76962408,"comment_id":135682323,"body_markdown":"yes, you&#39;re right. I don&#39;t need a certificate. Only public and private certificate and signature of the private certificate.","body":"yes, you&#39;re right. I don&#39;t need a certificate. Only public and private certificate and signature of the private certificate."},{"owner":{"account_id":3421244,"reputation":35883,"user_id":2868801,"display_name":"dave_thompson_085"},"score":1,"creation_date":1692935341,"post_id":76962408,"comment_id":135694975,"body_markdown":"You&#39;re still not making sense. There is no such thing as a private certificate, nor a signature of one. Moreover you can&#39;t both need and not need something.","body":"You&#39;re still not making sense. There is no such thing as a private certificate, nor a signature of one. Moreover you can&#39;t both need and not need something."},{"owner":{"account_id":12359353,"reputation":42442,"user_id":9014097,"display_name":"Topaco"},"score":0,"creation_date":1693808368,"post_id":76962408,"comment_id":135804144,"body_markdown":"Duplicate to https://stackoverflow.com/questions/76983695/get-private-and-public-keys-as-a-string-and-store-then-into-postgresql-db","body":"Duplicate to <a href=\"https://stackoverflow.com/questions/76983695/get-private-and-public-keys-as-a-string-and-store-then-into-postgresql-db\" title=\"get private and public keys as a string and store then into postgresql db\">stackoverflow.com/questions/76983695/&hellip;</a>"},{"owner":{"account_id":1087271,"reputation":64101,"user_id":1082681,"accept_rate":90,"display_name":"kriegaex"},"score":1,"creation_date":1694305128,"post_id":76962408,"comment_id":135873919,"body_markdown":"Peter, please take some more time to formulate a clear question. Learn the basic difference between the terms &quot;key&quot; and &quot;certificate&quot; and decide what you want. Please do not just mix the terms and confuse everyone, including yourself. Otherwise, nobody can answer your question. It would also help to avoid the [XY problem](https://meta.stackexchange.com/a/66378/309898) by explaining **which** basic problem you want to solve, not to focus on **how** you think you should solve it.","body":"Peter, please take some more time to formulate a clear question. Learn the basic difference between the terms &quot;key&quot; and &quot;certificate&quot; and decide what you want. Please do not just mix the terms and confuse everyone, including yourself. Otherwise, nobody can answer your question. It would also help to avoid the <a href=\"https://meta.stackexchange.com/a/66378/309898\">XY problem</a> by explaining <b>which</b> basic problem you want to solve, not to focus on <b>how</b> you think you should solve it."}],"answers":[{"tags":[],"owner":{"account_id":1087271,"reputation":64101,"user_id":1082681,"accept_rate":90,"display_name":"kriegaex"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694310336,"creation_date":1694306814,"answer_id":77074468,"question_id":76962408,"body_markdown":"Your code is quite chaotic with regard to naming. You cannot magically turn a key into a certificate just by naming it so. You create a key pair and fetch the public key, always calling it a certificate. An apple is not an orange, even if you call it one.\r\n\r\nAnyway, you did not post your full stack trace. If you had, it would have been apparent why your program throws this exception:\r\n\r\n```none\r\njava.security.cert.CertificateException: Could not parse certificate: java.io.IOException: Empty input\r\n\tat sun.security.provider.X509Factory.engineGenerateCertificate(X509Factory.java:114)\r\n\tat java.security.cert.CertificateFactory.generateCertificate(CertificateFactory.java:339)\r\n\tat CertificateGenerateTestApiTest.getKeyPayload(CertificateGenerateTestApiTest.java:98)\r\n\tat CertificateGenerateTestApiTest.verifyCertificate(CertificateGenerateTestApiTest.java:61)\r\n\tat CertificateGenerateTestApiTest.main(CertificateGenerateTestApiTest.java:45)\r\nCaused by: java.io.IOException: Empty input\r\n\tat sun.security.provider.X509Factory.engineGenerateCertificate(X509Factory.java:110)\r\n\t... 4 more\r\nException in thread &quot;main&quot; java.lang.NullPointerException\r\n\tat CertificateGenerateTestApiTest.verifyCertificate(CertificateGenerateTestApiTest.java:65)\r\n\tat CertificateGenerateTestApiTest.main(CertificateGenerateTestApiTest.java:45)\r\n```\r\n\r\nMy line numbers are a bit different after pasting your code into my IDE and adjusting a few things to make it run without JUnit, but the basic information stays the same:\r\n\r\nYou never initialise the `data` field in your class, but are trying to call `data.getBytes(&quot;UTF8&quot;)`. That cannot work.\r\n\r\nThere are many other problems in your code, but this one answers your question why this error message occurs.","title":"Generate public and private key and get private key signature","body":"<p>Your code is quite chaotic with regard to naming. You cannot magically turn a key into a certificate just by naming it so. You create a key pair and fetch the public key, always calling it a certificate. An apple is not an orange, even if you call it one.</p>\n<p>Anyway, you did not post your full stack trace. If you had, it would have been apparent why your program throws this exception:</p>\n<pre class=\"lang-none prettyprint-override\"><code>java.security.cert.CertificateException: Could not parse certificate: java.io.IOException: Empty input\n    at sun.security.provider.X509Factory.engineGenerateCertificate(X509Factory.java:114)\n    at java.security.cert.CertificateFactory.generateCertificate(CertificateFactory.java:339)\n    at CertificateGenerateTestApiTest.getKeyPayload(CertificateGenerateTestApiTest.java:98)\n    at CertificateGenerateTestApiTest.verifyCertificate(CertificateGenerateTestApiTest.java:61)\n    at CertificateGenerateTestApiTest.main(CertificateGenerateTestApiTest.java:45)\nCaused by: java.io.IOException: Empty input\n    at sun.security.provider.X509Factory.engineGenerateCertificate(X509Factory.java:110)\n    ... 4 more\nException in thread &quot;main&quot; java.lang.NullPointerException\n    at CertificateGenerateTestApiTest.verifyCertificate(CertificateGenerateTestApiTest.java:65)\n    at CertificateGenerateTestApiTest.main(CertificateGenerateTestApiTest.java:45)\n</code></pre>\n<p>My line numbers are a bit different after pasting your code into my IDE and adjusting a few things to make it run without JUnit, but the basic information stays the same:</p>\n<p>You never initialise the <code>data</code> field in your class, but are trying to call <code>data.getBytes(&quot;UTF8&quot;)</code>. That cannot work.</p>\n<p>There are many other problems in your code, but this one answers your question why this error message occurs.</p>\n"}],"owner":{"account_id":965625,"reputation":1524,"user_id":1103606,"accept_rate":51,"display_name":"Peter Penzov"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":308,"favorite_count":0,"down_vote_count":5,"up_vote_count":2,"answer_count":1,"score":-3,"last_activity_date":1694310336,"creation_date":1692801196,"question_id":76962408,"body_markdown":"I want to use `org.bouncycastle:bcprov-jdk15on:1.54` in order to generate a public and private key with Bouncy castle.\r\n\r\nI tried to follow this tutorial: https://www.baeldung.com/java-bouncy-castle but several things are not clear.\r\n\r\nHow I can generate a public and private key without using CLI. Can I do this using only Java code and after that get the signature? I don&#39;t need to have a `.cer` or `.csr` files. I need ot no this in memory. \r\n\r\nEDIT: I tried this code:\r\n\r\n    import io.jsonwebtoken.lang.Assert;\r\n    import org.bouncycastle.jce.provider.BouncyCastleProvider;\r\n    import org.junit.jupiter.api.Test;\r\n    \r\n    import javax.xml.bind.DatatypeConverter;\r\n    import java.io.ByteArrayInputStream;\r\n    import java.io.UnsupportedEncodingException;\r\n    import java.nio.charset.StandardCharsets;\r\n    import java.security.InvalidKeyException;\r\n    import java.security.KeyPair;\r\n    import java.security.KeyPairGenerator;\r\n    import java.security.NoSuchAlgorithmException;\r\n    import java.security.NoSuchProviderException;\r\n    import java.security.PublicKey;\r\n    import java.security.SecureRandom;\r\n    import java.security.Security;\r\n    import java.security.Signature;\r\n    import java.security.SignatureException;\r\n    import java.security.cert.Certificate;\r\n    import java.security.cert.CertificateException;\r\n    import java.security.cert.CertificateFactory;\r\n    import java.util.Base64;\r\n    \r\n    public class CertificateGenerateTestApiTest {\r\n    \r\n        String data; // complete certificate and metadata. We need to get of when we generate a certificate\r\n        String signature; // signature of the certificate\r\n    \r\n        @Test\r\n        public void certificateGenerationTest()\r\n        {\r\n            // Generate private and public keys\r\n            KeyPair keyPair = generateCertificate();\r\n    \r\n            PublicKey publicCertificate = keyPair.getPublic();\r\n    \r\n            // Problem 1 - think how to populate &quot;data&quot; variable from public certificate\r\n            // Problem 2 - think how to populate &quot;signature&quot; variable from public certificate\r\n    \r\n            // Get public key as byte[] in order later on to be stored into DB\r\n            byte[] originalPublicCertificate = privateCertificateToByte(publicCertificate);\r\n    \r\n            // Let&#39;s say we received some certificate by some web client, and we want to verify it against our original certificate\r\n            byte[] secondPublicCertificateReceivedByClient = cloneByteArrayData(originalPublicCertificate);\r\n    \r\n            // Verify certificate\r\n            Assert.isTrue(verifyCertificate(secondPublicCertificateReceivedByClient));\r\n        }\r\n    \r\n        private KeyPair generateCertificate()\r\n        {\r\n            try {\r\n                Security.addProvider(new BouncyCastleProvider());\r\n                KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;RSA&quot;, &quot;BC&quot;);\r\n                keyPairGenerator.initialize(2048, new SecureRandom());\r\n    \r\n                KeyPair keyPair = keyPairGenerator.generateKeyPair();\r\n    \r\n                return keyPair;\r\n            } catch (NoSuchAlgorithmException | NoSuchProviderException e) {\r\n                e.printStackTrace();\r\n            }\r\n            return null;\r\n        }\r\n    \r\n        private boolean verifyCertificate(byte[] secondPublicCertificateReceivedByClient)\r\n        {\r\n            PublicKey publicKey = getKeyPayload(byteToString(secondPublicCertificateReceivedByClient));\r\n            boolean verified = false;\r\n    \r\n            try {\r\n                verified = verifySignature(data.getBytes(&quot;UTF8&quot;), publicKey,\r\n                        DatatypeConverter.parseHexBinary(signature));\r\n            } catch (SignatureException | UnsupportedEncodingException e) {\r\n    \r\n            } catch (NoSuchAlgorithmException | InvalidKeyException e) {\r\n                e.printStackTrace();\r\n            }\r\n            return verified;\r\n        }\r\n    \r\n        private boolean verifySignature(byte[] data, PublicKey key, byte[] signature)\r\n                throws NoSuchAlgorithmException, InvalidKeyException, SignatureException {\r\n            Signature signer = Signature.getInstance(&quot;SHA1withDSA&quot;);\r\n            signer.initVerify(key);\r\n            signer.update(data);\r\n            try {\r\n                if (signer.verify(signature)) {\r\n                    return true;\r\n                }\r\n            } catch (SignatureException e) {\r\n                e.printStackTrace();\r\n            }\r\n            return false;\r\n        }\r\n    \r\n        private PublicKey getKeyPayload(String certificateString) {\r\n            try {\r\n                CertificateFactory cf = CertificateFactory.getInstance(&quot;X.509&quot;);\r\n                ByteArrayInputStream bis =\r\n                        new ByteArrayInputStream(certificateString.getBytes(StandardCharsets.UTF_8));\r\n    \r\n                Certificate certificate = null;\r\n                while (bis.available() &gt; 0) {\r\n                    certificate = cf.generateCertificate(bis);\r\n                }\r\n    \r\n                return (certificate == null) ? null : certificate.getPublicKey();\r\n            } catch (CertificateException e) {\r\n                e.printStackTrace();\r\n            }\r\n            return null;\r\n        }\r\n    \r\n        private String byteToString(byte[] publicKeyBytes)\r\n        {\r\n            return Base64.getEncoder().encodeToString(publicKeyBytes);\r\n        }\r\n    \r\n        private byte[] privateCertificateToByte(PublicKey publicCertificate)\r\n        {\r\n            return publicCertificate.getEncoded();\r\n        }\r\n    \r\n        /**\r\n         * Clone byte[] data\r\n         */\r\n        private byte[] cloneByteArrayData(byte[] sourceArray)\r\n        {\r\n            int sourceOffset = 0; /* Starting index in the source array */;\r\n            int destinationOffset = 0; // Starting index in the destination array\r\n            byte[] destinationArray = new byte[sourceArray.length];\r\n    \r\n            for (int i = 0; i &lt; sourceArray.length; i++) {\r\n                destinationArray[destinationOffset + i] = sourceArray[sourceOffset + i];\r\n            }\r\n    \r\n            return destinationArray;\r\n        }\r\n    }\r\n\r\n\r\nI get:\r\n\r\n    java.security.cert.CertificateException: Could not parse certificate: java.io.IOException: Empty input\r\n\r\n","title":"Generate public and private key and get private key signature","body":"<p>I want to use <code>org.bouncycastle:bcprov-jdk15on:1.54</code> in order to generate a public and private key with Bouncy castle.</p>\n<p>I tried to follow this tutorial: <a href=\"https://www.baeldung.com/java-bouncy-castle\" rel=\"nofollow noreferrer\">https://www.baeldung.com/java-bouncy-castle</a> but several things are not clear.</p>\n<p>How I can generate a public and private key without using CLI. Can I do this using only Java code and after that get the signature? I don't need to have a <code>.cer</code> or <code>.csr</code> files. I need ot no this in memory.</p>\n<p>EDIT: I tried this code:</p>\n<pre><code>import io.jsonwebtoken.lang.Assert;\nimport org.bouncycastle.jce.provider.BouncyCastleProvider;\nimport org.junit.jupiter.api.Test;\n\nimport javax.xml.bind.DatatypeConverter;\nimport java.io.ByteArrayInputStream;\nimport java.io.UnsupportedEncodingException;\nimport java.nio.charset.StandardCharsets;\nimport java.security.InvalidKeyException;\nimport java.security.KeyPair;\nimport java.security.KeyPairGenerator;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.NoSuchProviderException;\nimport java.security.PublicKey;\nimport java.security.SecureRandom;\nimport java.security.Security;\nimport java.security.Signature;\nimport java.security.SignatureException;\nimport java.security.cert.Certificate;\nimport java.security.cert.CertificateException;\nimport java.security.cert.CertificateFactory;\nimport java.util.Base64;\n\npublic class CertificateGenerateTestApiTest {\n\n    String data; // complete certificate and metadata. We need to get of when we generate a certificate\n    String signature; // signature of the certificate\n\n    @Test\n    public void certificateGenerationTest()\n    {\n        // Generate private and public keys\n        KeyPair keyPair = generateCertificate();\n\n        PublicKey publicCertificate = keyPair.getPublic();\n\n        // Problem 1 - think how to populate &quot;data&quot; variable from public certificate\n        // Problem 2 - think how to populate &quot;signature&quot; variable from public certificate\n\n        // Get public key as byte[] in order later on to be stored into DB\n        byte[] originalPublicCertificate = privateCertificateToByte(publicCertificate);\n\n        // Let's say we received some certificate by some web client, and we want to verify it against our original certificate\n        byte[] secondPublicCertificateReceivedByClient = cloneByteArrayData(originalPublicCertificate);\n\n        // Verify certificate\n        Assert.isTrue(verifyCertificate(secondPublicCertificateReceivedByClient));\n    }\n\n    private KeyPair generateCertificate()\n    {\n        try {\n            Security.addProvider(new BouncyCastleProvider());\n            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;RSA&quot;, &quot;BC&quot;);\n            keyPairGenerator.initialize(2048, new SecureRandom());\n\n            KeyPair keyPair = keyPairGenerator.generateKeyPair();\n\n            return keyPair;\n        } catch (NoSuchAlgorithmException | NoSuchProviderException e) {\n            e.printStackTrace();\n        }\n        return null;\n    }\n\n    private boolean verifyCertificate(byte[] secondPublicCertificateReceivedByClient)\n    {\n        PublicKey publicKey = getKeyPayload(byteToString(secondPublicCertificateReceivedByClient));\n        boolean verified = false;\n\n        try {\n            verified = verifySignature(data.getBytes(&quot;UTF8&quot;), publicKey,\n                    DatatypeConverter.parseHexBinary(signature));\n        } catch (SignatureException | UnsupportedEncodingException e) {\n\n        } catch (NoSuchAlgorithmException | InvalidKeyException e) {\n            e.printStackTrace();\n        }\n        return verified;\n    }\n\n    private boolean verifySignature(byte[] data, PublicKey key, byte[] signature)\n            throws NoSuchAlgorithmException, InvalidKeyException, SignatureException {\n        Signature signer = Signature.getInstance(&quot;SHA1withDSA&quot;);\n        signer.initVerify(key);\n        signer.update(data);\n        try {\n            if (signer.verify(signature)) {\n                return true;\n            }\n        } catch (SignatureException e) {\n            e.printStackTrace();\n        }\n        return false;\n    }\n\n    private PublicKey getKeyPayload(String certificateString) {\n        try {\n            CertificateFactory cf = CertificateFactory.getInstance(&quot;X.509&quot;);\n            ByteArrayInputStream bis =\n                    new ByteArrayInputStream(certificateString.getBytes(StandardCharsets.UTF_8));\n\n            Certificate certificate = null;\n            while (bis.available() &gt; 0) {\n                certificate = cf.generateCertificate(bis);\n            }\n\n            return (certificate == null) ? null : certificate.getPublicKey();\n        } catch (CertificateException e) {\n            e.printStackTrace();\n        }\n        return null;\n    }\n\n    private String byteToString(byte[] publicKeyBytes)\n    {\n        return Base64.getEncoder().encodeToString(publicKeyBytes);\n    }\n\n    private byte[] privateCertificateToByte(PublicKey publicCertificate)\n    {\n        return publicCertificate.getEncoded();\n    }\n\n    /**\n     * Clone byte[] data\n     */\n    private byte[] cloneByteArrayData(byte[] sourceArray)\n    {\n        int sourceOffset = 0; /* Starting index in the source array */;\n        int destinationOffset = 0; // Starting index in the destination array\n        byte[] destinationArray = new byte[sourceArray.length];\n\n        for (int i = 0; i &lt; sourceArray.length; i++) {\n            destinationArray[destinationOffset + i] = sourceArray[sourceOffset + i];\n        }\n\n        return destinationArray;\n    }\n}\n</code></pre>\n<p>I get:</p>\n<pre><code>java.security.cert.CertificateException: Could not parse certificate: java.io.IOException: Empty input\n</code></pre>\n"},{"tags":["java","windows-8","console"],"comments":[{"owner":{"account_id":4399373,"reputation":377,"user_id":3589392,"accept_rate":90,"display_name":"man-qa"},"score":0,"creation_date":1400072962,"post_id":23655606,"comment_id":36333261,"body_markdown":"If you are showing the console as an admin it might be because you need to enter the username and password","body":"If you are showing the console as an admin it might be because you need to enter the username and password"},{"owner":{"account_id":1980457,"reputation":680,"user_id":1985423,"accept_rate":70,"display_name":"Stefan Bollmann"},"score":0,"creation_date":1400073448,"post_id":23655606,"comment_id":36333634,"body_markdown":"@man-qa: For understanding: I started the javacpl.exe from a command prompt that I started as admin. There I had to use the admin username&amp;password. The Java app itself user. I tried also to start the app as admin.","body":"@man-qa: For understanding: I started the javacpl.exe from a command prompt that I started as admin. There I had to use the admin username&amp;password. The Java app itself user. I tried also to start the app as admin."},{"owner":{"account_id":145466,"reputation":4321,"user_id":355294,"accept_rate":93,"display_name":"TheBlastOne"},"score":0,"creation_date":1446016547,"post_id":23655606,"comment_id":54562722,"body_markdown":"No solution so far? I currently can reproduce this under fully patched Windows 7 with current Java 8, too.","body":"No solution so far? I currently can reproduce this under fully patched Windows 7 with current Java 8, too."}],"answers":[{"comments":[{"owner":{"account_id":1980457,"reputation":680,"user_id":1985423,"accept_rate":70,"display_name":"Stefan Bollmann"},"score":4,"creation_date":1400270059,"post_id":23685233,"comment_id":36425036,"body_markdown":"The option is selected and the window is not appearing. This is exactly what the link in my question is about. [link](http://stackoverflow.com/questions/20398289/java-control-panel-on-windows-8-1)","body":"The option is selected and the window is not appearing. This is exactly what the link in my question is about. <a href=\"http://stackoverflow.com/questions/20398289/java-control-panel-on-windows-8-1\">link</a>"}],"tags":[],"owner":{"display_name":"user2395486"},"comment_count":1,"down_vote_count":5,"up_vote_count":0,"is_accepted":false,"score":-5,"last_activity_date":1400175886,"creation_date":1400175886,"answer_id":23685233,"question_id":23655606,"body_markdown":"Bring up the Windows Charms bar through Windows key + W. Search for &quot;Java Control Panel&quot; and open that up. Go into the &quot;Advanced&quot; tab and the second category down should be &quot;Java Console&quot; - make sure that the &quot;Show Console&quot; option is selected.","title":"java console window not appearing","body":"<p>Bring up the Windows Charms bar through Windows key + W. Search for \"Java Control Panel\" and open that up. Go into the \"Advanced\" tab and the second category down should be \"Java Console\" - make sure that the \"Show Console\" option is selected.</p>\n"},{"tags":[],"owner":{"account_id":35683,"reputation":7004,"user_id":101151,"accept_rate":43,"display_name":"jla"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1449870344,"creation_date":1449870344,"answer_id":34233061,"question_id":23655606,"body_markdown":"The Java Console is available for applets running with Java Plug-in and applications running with Java Web Start.\r\n\r\nhttps://docs.oracle.com/javase/8/docs/technotes/guides/deploy/console_trace_log.html\r\n\r\nIf you are running your command from a command interpreter, it will become your console for input and output unless otherwise redirected. If you are using javaw you will have no console.\r\n\r\n","title":"java console window not appearing","body":"<p>The Java Console is available for applets running with Java Plug-in and applications running with Java Web Start.</p>\n\n<p><a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/deploy/console_trace_log.html\" rel=\"nofollow\">https://docs.oracle.com/javase/8/docs/technotes/guides/deploy/console_trace_log.html</a></p>\n\n<p>If you are running your command from a command interpreter, it will become your console for input and output unless otherwise redirected. If you are using javaw you will have no console.</p>\n"}],"owner":{"account_id":1980457,"reputation":680,"user_id":1985423,"accept_rate":70,"display_name":"Stefan Bollmann"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":15707,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":2,"score":2,"last_activity_date":1694307625,"creation_date":1400072656,"question_id":23655606,"body_markdown":"When starting a Java program e.g.\r\n\r\n      Java -cp path/to/ main.class\r\n\r\nmy application starts, but I don&#39;t get a console in Win 8.1. I have [set the Java console Switch to show console][1] as Admin. But the console still doesn&#39;t show up.\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/20398289/java-control-panel-on-windows-8-1","title":"java console window not appearing","body":"<p>When starting a Java program e.g.</p>\n\n<pre><code>  Java -cp path/to/ main.class\n</code></pre>\n\n<p>my application starts, but I don't get a console in Win 8.1. I have <a href=\"https://stackoverflow.com/questions/20398289/java-control-panel-on-windows-8-1\">set the Java console Switch to show console</a> as Admin. But the console still doesn't show up.</p>\n"},{"tags":["java","eclipse","web-services","service"],"answers":[{"comments":[{"owner":{"account_id":469838,"reputation":6333,"user_id":876686,"accept_rate":82,"display_name":"tier1"},"score":0,"creation_date":1313586350,"post_id":7092972,"comment_id":8492114,"body_markdown":"Correct, there are also new methods that I have added.","body":"Correct, there are also new methods that I have added."},{"owner":{"account_id":433296,"reputation":7639,"user_id":818557,"accept_rate":80,"display_name":"Anuj Balan"},"score":0,"creation_date":1313641919,"post_id":7092972,"comment_id":8506164,"body_markdown":"I dont know if there is any means of refreshing the wsdl without the code getting changed. All I can suggest from my exp is that you can re generate the wsdl for the new exposed methods from Axis Codegen plugin(you just need to specify the path to the class files)","body":"I dont know if there is any means of refreshing the wsdl without the code getting changed. All I can suggest from my exp is that you can re generate the wsdl for the new exposed methods from Axis Codegen plugin(you just need to specify the path to the class files)"}],"tags":[],"owner":{"account_id":433296,"reputation":7639,"user_id":818557,"accept_rate":80,"display_name":"Anuj Balan"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1313584901,"creation_date":1313584901,"answer_id":7092972,"question_id":7092772,"body_markdown":"You mean to say that the exposed methods have changed(Its parameters and their data types) ? \r\nIf yes, the wsdl can be re generated using the codegen JAVA2WSDL(plugin in eclipse).\r\n","title":"How do you update the wsdl in a Eclipse Web Service Client project?","body":"<p>You mean to say that the exposed methods have changed(Its parameters and their data types) ? \nIf yes, the wsdl can be re generated using the codegen JAVA2WSDL(plugin in eclipse).</p>\n"}],"owner":{"account_id":469838,"reputation":6333,"user_id":876686,"accept_rate":82,"display_name":"tier1"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":8471,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694307625,"creation_date":1313584114,"question_id":7092772,"body_markdown":"I have an Eclipse web service client with a WCF service that I am calling functions from.  The WCF service has changed and I need to update the wsdl in my eclipse project without losing all of my code.  I haven&#39;t been able to find anything on google, mostly just tutorials on how to create client programs.  Does anybody know how to refresh/update that wsdl in eclipse? ","title":"How do you update the wsdl in a Eclipse Web Service Client project?","body":"<p>I have an Eclipse web service client with a WCF service that I am calling functions from.  The WCF service has changed and I need to update the wsdl in my eclipse project without losing all of my code.  I haven't been able to find anything on google, mostly just tutorials on how to create client programs.  Does anybody know how to refresh/update that wsdl in eclipse? </p>\n"},{"tags":["java","algorithm","data-mining","cluster-analysis","k-means"],"comments":[{"owner":{"account_id":2396367,"reputation":12997,"user_id":2095090,"accept_rate":83,"display_name":"Vincent van der Weele"},"score":0,"creation_date":1389695747,"post_id":21111070,"comment_id":31762149,"body_markdown":"When calculating `sum1` and `sum2`, you should loop until `k` and `j`, respectively (instead of 9). The value of the rest of those arrays (`cluster1` and `cluster2`) is undefined.","body":"When calculating <code>sum1</code> and <code>sum2</code>, you should loop until <code>k</code> and <code>j</code>, respectively (instead of 9). The value of the rest of those arrays (<code>cluster1</code> and <code>cluster2</code>) is undefined."}],"answers":[{"comments":[{"owner":{"account_id":479954,"reputation":2855,"user_id":892914,"accept_rate":89,"display_name":"jnovacho"},"score":0,"creation_date":1389696175,"post_id":21111362,"comment_id":31762419,"body_markdown":"I sense the rounding could pose a problem. Math#round does math rounding. Maybe floor/ceil would be more appropriate.","body":"I sense the rounding could pose a problem. Math#round does math rounding. Maybe floor/ceil would be more appropriate."}],"tags":[],"owner":{"account_id":3659411,"reputation":40844,"user_id":3049628,"accept_rate":78,"display_name":"Tim B"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1389696106,"creation_date":1389695749,"answer_id":21111362,"question_id":21111070,"body_markdown":"The only possible infinite loop is the do-while.\r\n\r\n    if(m1==a &amp;&amp; m2==b)\r\n        flag=false;\r\n    else\r\n        flag=true;\r\n\r\nYou only exit the loop if `flag` is true. Breakpoint the if statement here and have a look to see why it is never getting set to false. Maybe add some debug print statements as well.\r\n","title":"Implementation of k-means clustering algorithm","body":"<p>The only possible infinite loop is the do-while.</p>\n\n<pre><code>if(m1==a &amp;&amp; m2==b)\n    flag=false;\nelse\n    flag=true;\n</code></pre>\n\n<p>You only exit the loop if <code>flag</code> is true. Breakpoint the if statement here and have a look to see why it is never getting set to false. Maybe add some debug print statements as well.</p>\n"},{"tags":[],"owner":{"account_id":2396367,"reputation":12997,"user_id":2095090,"accept_rate":83,"display_name":"Vincent van der Weele"},"comment_count":0,"down_vote_count":0,"up_vote_count":5,"is_accepted":true,"score":5,"last_activity_date":1389705442,"creation_date":1389697246,"answer_id":21111871,"question_id":21111070,"body_markdown":"You have a bunch of errors:\r\n\r\n 1. At the start of your `do` loop you should reset `sum1` and `sum2` to 0.\r\n\r\n 2. You should loop until `k` and `j` respectively when calculating `sum1` and `sum2` (or clear `cluster1` and `cluster2` at the start of your `do` loop.\r\n\r\n 3. In the calculation of `sum2` you accidentally use `sum1`.\r\n\r\nWhen I make those fixes the code runs fine, yielding the output:\r\n\r\n    Final cluster 1 :   \r\n    2   4   10   12  3   11  0   0   0\r\n    \r\n    Final cluster 2 :\r\n    20  30  25   0   0   0   0   0   0\r\n\r\n\r\nMy general advise: learn how to use a debugger. Stackoverflow is not meant for questions like this: it is expected that you can find your own bugs and only come here when everything else fails... ","title":"Implementation of k-means clustering algorithm","body":"<p>You have a bunch of errors:</p>\n\n<ol>\n<li><p>At the start of your <code>do</code> loop you should reset <code>sum1</code> and <code>sum2</code> to 0.</p></li>\n<li><p>You should loop until <code>k</code> and <code>j</code> respectively when calculating <code>sum1</code> and <code>sum2</code> (or clear <code>cluster1</code> and <code>cluster2</code> at the start of your <code>do</code> loop.</p></li>\n<li><p>In the calculation of <code>sum2</code> you accidentally use <code>sum1</code>.</p></li>\n</ol>\n\n<p>When I make those fixes the code runs fine, yielding the output:</p>\n\n<pre><code>Final cluster 1 :   \n2   4   10   12  3   11  0   0   0\n\nFinal cluster 2 :\n20  30  25   0   0   0   0   0   0\n</code></pre>\n\n<p>My general advise: learn how to use a debugger. Stackoverflow is not meant for questions like this: it is expected that you can find your own bugs and only come here when everything else fails... </p>\n"},{"tags":[],"owner":{"account_id":3911816,"reputation":999,"user_id":3236903,"accept_rate":58,"display_name":"Manindar"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1478599574,"creation_date":1478599574,"answer_id":40484050,"question_id":21111070,"body_markdown":"    public class KMeansClustering {\r\n\r\n    public static void main(String args[]) {\r\n        int arr[] = {2, 4, 10, 12, 3, 20, 30, 11, 25};    // initial data\r\n        int i, m1, m2, a, b, n = 0;\r\n        boolean flag;\r\n        float sum1, sum2;\r\n        a = arr[0];\r\n        b = arr[1];\r\n        m1 = a;\r\n        m2 = b;\r\n        int cluster1[] = new int[arr.length], cluster2[] = new int[arr.length];\r\n        do {\r\n            sum1 = 0;\r\n            sum2 = 0;\r\n            cluster1 = new int[arr.length];\r\n            cluster2 = new int[arr.length];\r\n            n++;\r\n            int k = 0, j = 0;\r\n            for (i = 0; i &lt; arr.length; i++) {\r\n                if (Math.abs(arr[i] - m1) &lt;= Math.abs(arr[i] - m2)) {\r\n                    cluster1[k] = arr[i];\r\n                    k++;\r\n                } else {\r\n                    cluster2[j] = arr[i];\r\n                    j++;\r\n                }\r\n            }\r\n            System.out.println();\r\n            for (i = 0; i &lt; k; i++) {\r\n                sum1 = sum1 + cluster1[i];\r\n            }\r\n            for (i = 0; i &lt; j; i++) {\r\n                sum2 = sum2 + cluster2[i];\r\n            }\r\n            //printing Centroids/Means\\\r\n            System.out.println(&quot;m1=&quot; + m1 + &quot;   m2=&quot; + m2);\r\n            a = m1;\r\n            b = m2;\r\n            m1 = Math.round(sum1 / k);\r\n            m2 = Math.round(sum2 / j);\r\n            flag = !(m1 == a &amp;&amp; m2 == b);\r\n\r\n            System.out.println(&quot;After iteration &quot; + n + &quot; , cluster 1 :\\n&quot;);    //printing the clusters of each iteration\r\n            for (i = 0; i &lt; cluster1.length; i++) {\r\n                System.out.print(cluster1[i] + &quot;\\t&quot;);\r\n            }\r\n\r\n            System.out.println(&quot;\\n&quot;);\r\n            System.out.println(&quot;After iteration &quot; + n + &quot; , cluster 2 :\\n&quot;);\r\n            for (i = 0; i &lt; cluster2.length; i++) {\r\n                System.out.print(cluster2[i] + &quot;\\t&quot;);\r\n            }\r\n\r\n        } while (flag);\r\n\r\n        System.out.println(&quot;Final cluster 1 :\\n&quot;);            // final clusters\r\n        for (i = 0; i &lt; cluster1.length; i++) {\r\n            System.out.print(cluster1[i] + &quot;\\t&quot;);\r\n        }\r\n\r\n        System.out.println();\r\n        System.out.println(&quot;Final cluster 2 :\\n&quot;);\r\n        for (i = 0; i &lt; cluster2.length; i++) {\r\n            System.out.print(cluster2[i] + &quot;\\t&quot;);\r\n        }\r\n    }\r\n}\r\n\r\nThis is working code. ","title":"Implementation of k-means clustering algorithm","body":"<pre><code>public class KMeansClustering {\n\npublic static void main(String args[]) {\n    int arr[] = {2, 4, 10, 12, 3, 20, 30, 11, 25};    // initial data\n    int i, m1, m2, a, b, n = 0;\n    boolean flag;\n    float sum1, sum2;\n    a = arr[0];\n    b = arr[1];\n    m1 = a;\n    m2 = b;\n    int cluster1[] = new int[arr.length], cluster2[] = new int[arr.length];\n    do {\n        sum1 = 0;\n        sum2 = 0;\n        cluster1 = new int[arr.length];\n        cluster2 = new int[arr.length];\n        n++;\n        int k = 0, j = 0;\n        for (i = 0; i &lt; arr.length; i++) {\n            if (Math.abs(arr[i] - m1) &lt;= Math.abs(arr[i] - m2)) {\n                cluster1[k] = arr[i];\n                k++;\n            } else {\n                cluster2[j] = arr[i];\n                j++;\n            }\n        }\n        System.out.println();\n        for (i = 0; i &lt; k; i++) {\n            sum1 = sum1 + cluster1[i];\n        }\n        for (i = 0; i &lt; j; i++) {\n            sum2 = sum2 + cluster2[i];\n        }\n        //printing Centroids/Means\\\n        System.out.println(\"m1=\" + m1 + \"   m2=\" + m2);\n        a = m1;\n        b = m2;\n        m1 = Math.round(sum1 / k);\n        m2 = Math.round(sum2 / j);\n        flag = !(m1 == a &amp;&amp; m2 == b);\n\n        System.out.println(\"After iteration \" + n + \" , cluster 1 :\\n\");    //printing the clusters of each iteration\n        for (i = 0; i &lt; cluster1.length; i++) {\n            System.out.print(cluster1[i] + \"\\t\");\n        }\n\n        System.out.println(\"\\n\");\n        System.out.println(\"After iteration \" + n + \" , cluster 2 :\\n\");\n        for (i = 0; i &lt; cluster2.length; i++) {\n            System.out.print(cluster2[i] + \"\\t\");\n        }\n\n    } while (flag);\n\n    System.out.println(\"Final cluster 1 :\\n\");            // final clusters\n    for (i = 0; i &lt; cluster1.length; i++) {\n        System.out.print(cluster1[i] + \"\\t\");\n    }\n\n    System.out.println();\n    System.out.println(\"Final cluster 2 :\\n\");\n    for (i = 0; i &lt; cluster2.length; i++) {\n        System.out.print(cluster2[i] + \"\\t\");\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>This is working code. </p>\n"},{"tags":[],"owner":{"account_id":9934169,"reputation":1,"user_id":7353039,"display_name":"anoojkv varghese"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1501146046,"creation_date":1501144430,"answer_id":45345420,"question_id":21111070,"body_markdown":"    package k;\r\n    \r\n    /**\r\n     *\r\n     * @author Anooj.k.varghese\r\n     */\r\n    \r\n    import java.io.FileNotFoundException;\r\n    import java.io.File;\r\n    import java.util.Scanner;\r\n    public class K {\r\n       \r\n    \r\n        /**\r\n         * @param args the command line arguments\r\n         */\r\n        //GLOBAL VARIABLES\r\n        //data_set[][] -------------datast is stored in the data_set[][] array\r\n        //initial_centroid[][]------according to k&#39;th value we select initaly k centroid.stored in the initial_centroid[][] \r\n        //                          value is assigned in the  &#39;first_itration()&#39; function\r\n        private static double[][] arr;\r\n        static int num = 0;\r\n        static Double data_set[][]=new Double[20000][100];\r\n        static Double diff[][]=new Double[20000][100];\r\n        static Double intial_centroid[][]=new Double[300][400];\r\n        static Double center_mean[][]=new Double[20000][100];\r\n        static Double total_mean[]=new Double[200000];\r\n        static int cnum;\r\n        static int it=1;\r\n        static int checker=1;\r\n        static int row=4;//rows in Your DataSet here i use iris dataset \r\n         /////////////////////////////////reading the file/////////////////////////////////////\r\n         // discriptin readFile readthe txt file\r\n        private static void readFile() throws FileNotFoundException\r\n            {\r\n            Scanner scanner = new Scanner(new File(&quot;E:/aa.txt&quot;));//Dataset path\r\n            scanner.useDelimiter(System.getProperty(&quot;line.separator&quot;));\r\n            int lineNo = 0;\r\n                while (scanner.hasNext())\r\n                 {\r\n                    parseLine(scanner.next(),lineNo);\r\n                    lineNo++;\r\n                    System.out.println();\r\n                 }\r\n                 // System.out.println(&quot;total&quot;+num); PRINT THE TOTAL\r\n    \t scanner.close();\r\n            }\r\n        //read file is copey to the data_set\r\n        public static void parseLine(String line,int lineNo)\r\n          { \r\n            Scanner lineScanner = new Scanner(line);\r\n            lineScanner.useDelimiter(&quot;,&quot;);\r\n    \t      for(int col=0;col&lt;row;col++)\r\n                  {\r\n                      Double arry=lineScanner.nextDouble();\r\n                      data_set[num][col]=arry;                          ///here read  data set is assign the variable data_set\r\n                   }\r\n             num++;\r\n                   \r\n            }\r\n          public static void first_itration()\r\n        {   double a = 0;\r\n             System.out.println(&quot;ENTER CLUSTER NUMBER&quot;);\r\n             Scanner sc=new Scanner(System.in);      \r\n             cnum=sc.nextInt();   //enter the number of cenroid\r\n            \r\n             int result[]=new int[cnum];\r\n            double re=0;\r\n       \r\n             System.out.println(&quot;centroid&quot;);\r\n             for(int i=0;i&lt;cnum;i++)\r\n             {\r\n                for(int j=0;j&lt;row;j++)\r\n                    {\r\n                        intial_centroid[i][j]=data_set[i][j];                  //// CENTROID ARE STORED IN AN intial_centroid variable\r\n                        System.out.print(intial_centroid[i][j]);      \r\n                    }\r\n                System.out.println();\r\n             }\r\n           System.out.println(&quot;------------&quot;);\r\n          \r\n           int counter1=0;\r\n           for(int i=0;i&lt;num;i++)\r\n           {\r\n                for(int j=0;j&lt;row;j++)\r\n                    {\r\n                          //System.out.println(&quot;hii&quot;);\r\n                     System.out.print(data_set[i][j]);\r\n                         \r\n                     }\r\n           counter1++;\r\n           System.out.println();\r\n           }\r\n               System.out.println(&quot;total=&quot;+counter1);                             //print the total number of data\r\n               //----------------------------------\r\n               \r\n               ///////////////////EUCLIDEAN DISTANCE////////////////////////////////////\r\n                                                                                    /// find the Euclidean Distance\r\n            for(int i=0;i&lt;num;i++)\r\n            {\r\n                    for(int j=0;j&lt;cnum;j++)       \r\n                    {\r\n                        re=0;\r\n                         for(int k=0;k&lt;row;k++)\r\n                         {\r\n                                a= (intial_centroid[j][k]-data_set[i][k]);\r\n                                //System.out.println(a);\r\n                                 a=a*a;\r\n                                 re=re+a;                                                 // store the row sum\r\n                  \r\n                            }\r\n                 \r\n                             diff[i][j]= Math.sqrt(re);// find the squre root\r\n             \r\n            }\r\n            }\r\n    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n            \r\n    ///////////////////////////////////////////////FIND THE SMALLEST VALUE////////////////////////////////////////////////\r\n       double aaa;\r\n       double counter;\r\n         int ccc=1;\r\n       for(int i=0;i&lt;num;i++)\r\n       {\r\n             int c=1;\r\n             counter=c;\r\n             aaa=diff[i][0];\r\n             for(int j=0;j&lt;cnum;j++)\r\n             {\r\n              //System.out.println(diff[i][j]);\r\n            \r\n                if(aaa&gt;=diff[i][j] )                                                //change\r\n                    {\r\n                        aaa=diff[i][j];\r\n                        counter=j;\r\n                        \r\n                                \r\n                        // Jth value are stord in the counter variable \r\n                   //   System.out.println(counter);\r\n                   }\r\n                        \r\n                \r\n             }\r\n             \r\n                data_set[i][row]=counter;                                        //assign the counter to last position of data set\r\n         \r\n                //System.out.println(&quot;--&quot;);\r\n          }                                                                  //print the first itration\r\n                System.out.println(&quot;**FIRST ITRATION**&quot;);\r\n         \r\n          for(int i=0;i&lt;num;i++)\r\n                  {\r\n                      for(int j=0;j&lt;=row;j++)\r\n                          {\r\n                          //System.out.println(&quot;hii&quot;);\r\n                                  System.out.print(data_set[i][j]+ &quot; &quot;);\r\n                           }\r\n                      System.out.println();\r\n                  }\r\n         \r\n        it++;\r\n        }\r\n        \r\n        \r\n        public static void calck_mean()\r\n        { \r\n            for(int i=0;i&lt;20000;i++)\r\n            {\r\n                for(int j=0;j&lt;100;j++)\r\n                {\r\n                    center_mean[i][j]=0.0;\r\n                }\r\n            }\r\n            \r\n            \r\n      double c = 0; \r\n         int a=0;\r\n         int p;\r\n         int abbb = 0;\r\n            if(it%2==0)\r\n             {\r\n                 abbb=row;\r\n             }\r\n            else if(it%2==1)\r\n             {\r\n                 abbb=row+1;\r\n              }\r\n            for(int k=0;k&lt;cnum;k++)\r\n                {\r\n                        double counter = 0;    \r\n                        for(int i=0;i&lt;num;i++)\r\n                         {\r\n                            for(int j=0;j&lt;=row;j++)\r\n                            {               \r\n                                if(data_set[i][abbb]==a)\r\n                                {\r\n                                System.out.print(data_set[i][j]);\r\n                                center_mean[k][j] += data_set[i][j];\r\n                      \r\n                                }\r\n                         \r\n                              }\r\n                            System.out.println();\r\n                          if(data_set[i][abbb]==a)\r\n                            {\r\n                                counter++;\r\n                            }\r\n                      System.out.println();\r\n                  }\r\n              \r\n             a++;\r\n             total_mean[k]=counter;\r\n            \r\n             }\r\n             for(int i=0;i&lt;cnum;i++)\r\n                {\r\n                System.out.println(&quot;\\n&quot;);\r\n                for(int j=0;j&lt;row;j++)\r\n                {\r\n                  if(total_mean[i]==0)\r\n                  {\r\n                       center_mean[i][j]=0.0;\r\n                  }\r\n                  else\r\n                  {\r\n                    center_mean[i][j]=center_mean[i][j]/total_mean[i];\r\n                  }\r\n                  }\r\n            }\r\n            for(int k=0;k&lt;cnum;k++)\r\n            {\r\n                for(int j=0;j&lt;row;j++)\r\n                {\r\n                  //System.out.print(center_mean[k][j]);\r\n                }\r\n                System.out.println();\r\n                \r\n            }\r\n           /* for(int j=0;j&lt;cnum;j++)\r\n            {\r\n                System.out.println(total_mean[j]);\r\n            }*/\r\n           \r\n        }\r\n    public static void kmeans1()\r\n        {\r\n           double  a = 0;\r\n           int result[]=new int[cnum];\r\n           double re=0;\r\n            \r\n      //// CENTROID ARE STORED IN AN data_set VARIABLE intial_centroid \r\n             System.out.println(&quot; new centroid&quot;);\r\n                for(int i=0;i&lt;cnum;i++)\r\n                {\r\n                    for(int j=0;j&lt;row;j++)\r\n                    {\r\n                        intial_centroid[i][j]=center_mean[i][j];\r\n                        System.out.print(intial_centroid[i][j]);\r\n                    }\r\n                 System.out.println();\r\n                }\r\n        \r\n       //----------------------------------------------JUST PRINT THE data_set\r\n          \r\n               //----------------------------------\r\n            for(int i=0;i&lt;num;i++)\r\n            {\r\n                for(int j=0;j&lt;cnum;j++)\r\n                {\r\n                 re=0;\r\n                 for(int k=0;k&lt;row;k++)\r\n                 {\r\n                 \r\n                   a=(intial_centroid[j][k]-data_set[i][k]);\r\n                     //System.out.println(a);\r\n                    a=a*a;        \r\n                   re=re+a;\r\n                  \r\n                    }\r\n                 \r\n                 diff[i][j]= Math.sqrt(re);\r\n                 //System.out.println(diff[i][j]);\r\n                }\r\n            }\r\n       double aaa;\r\n        double counter;\r\n         for(int i=0;i&lt;num;i++)\r\n         {\r\n             \r\n             int c=1;\r\n             counter=c;\r\n              aaa=diff[i][0];\r\n             for(int j=0;j&lt;cnum;j++)\r\n             {\r\n                // System.out.println(diff[i][j]);\r\n                if(aaa&gt;=diff[i][j])                                                  //change\r\n                {\r\n                   aaa=diff[i][j];\r\n                    counter=j;\r\n                   //   System.out.println(counter);\r\n                }\r\n                        \r\n                \r\n             }\r\n             \r\n             \r\n             if(it%2==0)\r\n                {\r\n            // abbb=4;\r\n                    data_set[i][row+1]=counter;\r\n                }\r\n             else if(it%2==1)\r\n                {\r\n                    data_set[i][row]=counter;\r\n          //   abbb=4;\r\n                }\r\n             \r\n         \r\n            //System.out.println(&quot;--&quot;);\r\n         }\r\n         System.out.println(it+&quot; ITRATION**&quot;);\r\n         \r\n          for(int i=0;i&lt;num;i++)\r\n                  {\r\n                      for(int j=0;j&lt;=row+1;j++)\r\n                      {\r\n                          //System.out.println(&quot;hii&quot;);\r\n                          System.out.print(data_set[i][j]+&quot; &quot;);\r\n                      }\r\n                      System.out.println();\r\n                  }\r\n         \r\n        it++;\r\n        }\r\n    public static void check()\r\n    {\r\n        checker=0;\r\n        for(int i=0;i&lt;num;i++)\r\n        {\r\n             //System.out.println(&quot;hii&quot;);\r\n            if(Double.compare(data_set[i][row],data_set[i][row+1]) != 0)\r\n            {\r\n                checker=1;\r\n                //System.out.println(&quot;hii &quot; + i  + &quot; &quot; + data_set[i][4]+ &quot; &quot;+data_set[i][4]);\r\n                break;\r\n            }\r\n            System.out.println();\r\n        }\r\n        \r\n    }\r\n    public static void dispaly()\r\n    {\r\n     \r\n          System.out.println(it+&quot; ITRATION**&quot;);\r\n         \r\n          for(int i=0;i&lt;num;i++)\r\n                  {\r\n                      for(int j=0;j&lt;=row+1;j++)\r\n                      {\r\n                          //System.out.println(&quot;hii&quot;);\r\n                          System.out.print(data_set[i][j]+&quot; &quot;);\r\n                      }\r\n                      System.out.println();\r\n                  }\r\n    }\r\n        \r\n     \r\n     public static void print()\r\n        {\r\n            System.out.println();\r\n             System.out.println();\r\n              System.out.println();\r\n            System.out.println(&quot;----OUTPUT----&quot;);\r\n            int c=0;\r\n            int a=0;\r\n            for(int i=0;i&lt;cnum;i++)\r\n            {\r\n                System.out.println(&quot;---------CLUSTER-&quot;+i+&quot;-----&quot;);\r\n             a=0;\r\n                for(int j=0;j&lt;num;j++)\r\n                {\r\n                     if(data_set[j][row]==i)\r\n                     {a++;\r\n                    for(int k=0;k&lt;row;k++)\r\n                    {\r\n                    \r\n                        System.out.print(data_set[j][k]+&quot;  &quot;);\r\n                    }\r\n                    c++;\r\n                    System.out.println();\r\n                    }\r\n                     //System.out.println(num);\r\n                        \r\n                }\r\n                   System.out.println(&quot;CLUSTER INSTANCES=&quot;+a);\r\n          \r\n                \r\n            }\r\n            System.out.println(&quot;TOTAL INSTANCE&quot;+c);\r\n        }\r\n    \r\n    \r\n        public static void main(String[] args) throws FileNotFoundException \r\n        {\r\n        readFile();\r\n        first_itration();\r\n       \r\n        while(checker!=0)\r\n                {\r\n                calck_mean();\r\n                kmeans1();\r\n                check();\r\n                } \r\n      dispaly();\r\n      print();\r\n        }\r\n    \r\n      \r\n    \r\n       \r\n    }\r\n    \r\n    \r\n        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n              \r\n            \r\n       ","title":"Implementation of k-means clustering algorithm","body":"<pre><code>package k;\n\n/**\n *\n * @author Anooj.k.varghese\n */\n\nimport java.io.FileNotFoundException;\nimport java.io.File;\nimport java.util.Scanner;\npublic class K {\n\n\n    /**\n     * @param args the command line arguments\n     */\n    //GLOBAL VARIABLES\n    //data_set[][] -------------datast is stored in the data_set[][] array\n    //initial_centroid[][]------according to k'th value we select initaly k centroid.stored in the initial_centroid[][] \n    //                          value is assigned in the  'first_itration()' function\n    private static double[][] arr;\n    static int num = 0;\n    static Double data_set[][]=new Double[20000][100];\n    static Double diff[][]=new Double[20000][100];\n    static Double intial_centroid[][]=new Double[300][400];\n    static Double center_mean[][]=new Double[20000][100];\n    static Double total_mean[]=new Double[200000];\n    static int cnum;\n    static int it=1;\n    static int checker=1;\n    static int row=4;//rows in Your DataSet here i use iris dataset \n     /////////////////////////////////reading the file/////////////////////////////////////\n     // discriptin readFile readthe txt file\n    private static void readFile() throws FileNotFoundException\n        {\n        Scanner scanner = new Scanner(new File(\"E:/aa.txt\"));//Dataset path\n        scanner.useDelimiter(System.getProperty(\"line.separator\"));\n        int lineNo = 0;\n            while (scanner.hasNext())\n             {\n                parseLine(scanner.next(),lineNo);\n                lineNo++;\n                System.out.println();\n             }\n             // System.out.println(\"total\"+num); PRINT THE TOTAL\n     scanner.close();\n        }\n    //read file is copey to the data_set\n    public static void parseLine(String line,int lineNo)\n      { \n        Scanner lineScanner = new Scanner(line);\n        lineScanner.useDelimiter(\",\");\n          for(int col=0;col&lt;row;col++)\n              {\n                  Double arry=lineScanner.nextDouble();\n                  data_set[num][col]=arry;                          ///here read  data set is assign the variable data_set\n               }\n         num++;\n\n        }\n      public static void first_itration()\n    {   double a = 0;\n         System.out.println(\"ENTER CLUSTER NUMBER\");\n         Scanner sc=new Scanner(System.in);      \n         cnum=sc.nextInt();   //enter the number of cenroid\n\n         int result[]=new int[cnum];\n        double re=0;\n\n         System.out.println(\"centroid\");\n         for(int i=0;i&lt;cnum;i++)\n         {\n            for(int j=0;j&lt;row;j++)\n                {\n                    intial_centroid[i][j]=data_set[i][j];                  //// CENTROID ARE STORED IN AN intial_centroid variable\n                    System.out.print(intial_centroid[i][j]);      \n                }\n            System.out.println();\n         }\n       System.out.println(\"------------\");\n\n       int counter1=0;\n       for(int i=0;i&lt;num;i++)\n       {\n            for(int j=0;j&lt;row;j++)\n                {\n                      //System.out.println(\"hii\");\n                 System.out.print(data_set[i][j]);\n\n                 }\n       counter1++;\n       System.out.println();\n       }\n           System.out.println(\"total=\"+counter1);                             //print the total number of data\n           //----------------------------------\n\n           ///////////////////EUCLIDEAN DISTANCE////////////////////////////////////\n                                                                                /// find the Euclidean Distance\n        for(int i=0;i&lt;num;i++)\n        {\n                for(int j=0;j&lt;cnum;j++)       \n                {\n                    re=0;\n                     for(int k=0;k&lt;row;k++)\n                     {\n                            a= (intial_centroid[j][k]-data_set[i][k]);\n                            //System.out.println(a);\n                             a=a*a;\n                             re=re+a;                                                 // store the row sum\n\n                        }\n\n                         diff[i][j]= Math.sqrt(re);// find the squre root\n\n        }\n        }\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n///////////////////////////////////////////////FIND THE SMALLEST VALUE////////////////////////////////////////////////\n   double aaa;\n   double counter;\n     int ccc=1;\n   for(int i=0;i&lt;num;i++)\n   {\n         int c=1;\n         counter=c;\n         aaa=diff[i][0];\n         for(int j=0;j&lt;cnum;j++)\n         {\n          //System.out.println(diff[i][j]);\n\n            if(aaa&gt;=diff[i][j] )                                                //change\n                {\n                    aaa=diff[i][j];\n                    counter=j;\n\n\n                    // Jth value are stord in the counter variable \n               //   System.out.println(counter);\n               }\n\n\n         }\n\n            data_set[i][row]=counter;                                        //assign the counter to last position of data set\n\n            //System.out.println(\"--\");\n      }                                                                  //print the first itration\n            System.out.println(\"**FIRST ITRATION**\");\n\n      for(int i=0;i&lt;num;i++)\n              {\n                  for(int j=0;j&lt;=row;j++)\n                      {\n                      //System.out.println(\"hii\");\n                              System.out.print(data_set[i][j]+ \" \");\n                       }\n                  System.out.println();\n              }\n\n    it++;\n    }\n\n\n    public static void calck_mean()\n    { \n        for(int i=0;i&lt;20000;i++)\n        {\n            for(int j=0;j&lt;100;j++)\n            {\n                center_mean[i][j]=0.0;\n            }\n        }\n\n\n  double c = 0; \n     int a=0;\n     int p;\n     int abbb = 0;\n        if(it%2==0)\n         {\n             abbb=row;\n         }\n        else if(it%2==1)\n         {\n             abbb=row+1;\n          }\n        for(int k=0;k&lt;cnum;k++)\n            {\n                    double counter = 0;    \n                    for(int i=0;i&lt;num;i++)\n                     {\n                        for(int j=0;j&lt;=row;j++)\n                        {               \n                            if(data_set[i][abbb]==a)\n                            {\n                            System.out.print(data_set[i][j]);\n                            center_mean[k][j] += data_set[i][j];\n\n                            }\n\n                          }\n                        System.out.println();\n                      if(data_set[i][abbb]==a)\n                        {\n                            counter++;\n                        }\n                  System.out.println();\n              }\n\n         a++;\n         total_mean[k]=counter;\n\n         }\n         for(int i=0;i&lt;cnum;i++)\n            {\n            System.out.println(\"\\n\");\n            for(int j=0;j&lt;row;j++)\n            {\n              if(total_mean[i]==0)\n              {\n                   center_mean[i][j]=0.0;\n              }\n              else\n              {\n                center_mean[i][j]=center_mean[i][j]/total_mean[i];\n              }\n              }\n        }\n        for(int k=0;k&lt;cnum;k++)\n        {\n            for(int j=0;j&lt;row;j++)\n            {\n              //System.out.print(center_mean[k][j]);\n            }\n            System.out.println();\n\n        }\n       /* for(int j=0;j&lt;cnum;j++)\n        {\n            System.out.println(total_mean[j]);\n        }*/\n\n    }\npublic static void kmeans1()\n    {\n       double  a = 0;\n       int result[]=new int[cnum];\n       double re=0;\n\n  //// CENTROID ARE STORED IN AN data_set VARIABLE intial_centroid \n         System.out.println(\" new centroid\");\n            for(int i=0;i&lt;cnum;i++)\n            {\n                for(int j=0;j&lt;row;j++)\n                {\n                    intial_centroid[i][j]=center_mean[i][j];\n                    System.out.print(intial_centroid[i][j]);\n                }\n             System.out.println();\n            }\n\n   //----------------------------------------------JUST PRINT THE data_set\n\n           //----------------------------------\n        for(int i=0;i&lt;num;i++)\n        {\n            for(int j=0;j&lt;cnum;j++)\n            {\n             re=0;\n             for(int k=0;k&lt;row;k++)\n             {\n\n               a=(intial_centroid[j][k]-data_set[i][k]);\n                 //System.out.println(a);\n                a=a*a;        \n               re=re+a;\n\n                }\n\n             diff[i][j]= Math.sqrt(re);\n             //System.out.println(diff[i][j]);\n            }\n        }\n   double aaa;\n    double counter;\n     for(int i=0;i&lt;num;i++)\n     {\n\n         int c=1;\n         counter=c;\n          aaa=diff[i][0];\n         for(int j=0;j&lt;cnum;j++)\n         {\n            // System.out.println(diff[i][j]);\n            if(aaa&gt;=diff[i][j])                                                  //change\n            {\n               aaa=diff[i][j];\n                counter=j;\n               //   System.out.println(counter);\n            }\n\n\n         }\n\n\n         if(it%2==0)\n            {\n        // abbb=4;\n                data_set[i][row+1]=counter;\n            }\n         else if(it%2==1)\n            {\n                data_set[i][row]=counter;\n      //   abbb=4;\n            }\n\n\n        //System.out.println(\"--\");\n     }\n     System.out.println(it+\" ITRATION**\");\n\n      for(int i=0;i&lt;num;i++)\n              {\n                  for(int j=0;j&lt;=row+1;j++)\n                  {\n                      //System.out.println(\"hii\");\n                      System.out.print(data_set[i][j]+\" \");\n                  }\n                  System.out.println();\n              }\n\n    it++;\n    }\npublic static void check()\n{\n    checker=0;\n    for(int i=0;i&lt;num;i++)\n    {\n         //System.out.println(\"hii\");\n        if(Double.compare(data_set[i][row],data_set[i][row+1]) != 0)\n        {\n            checker=1;\n            //System.out.println(\"hii \" + i  + \" \" + data_set[i][4]+ \" \"+data_set[i][4]);\n            break;\n        }\n        System.out.println();\n    }\n\n}\npublic static void dispaly()\n{\n\n      System.out.println(it+\" ITRATION**\");\n\n      for(int i=0;i&lt;num;i++)\n              {\n                  for(int j=0;j&lt;=row+1;j++)\n                  {\n                      //System.out.println(\"hii\");\n                      System.out.print(data_set[i][j]+\" \");\n                  }\n                  System.out.println();\n              }\n}\n\n\n public static void print()\n    {\n        System.out.println();\n         System.out.println();\n          System.out.println();\n        System.out.println(\"----OUTPUT----\");\n        int c=0;\n        int a=0;\n        for(int i=0;i&lt;cnum;i++)\n        {\n            System.out.println(\"---------CLUSTER-\"+i+\"-----\");\n         a=0;\n            for(int j=0;j&lt;num;j++)\n            {\n                 if(data_set[j][row]==i)\n                 {a++;\n                for(int k=0;k&lt;row;k++)\n                {\n\n                    System.out.print(data_set[j][k]+\"  \");\n                }\n                c++;\n                System.out.println();\n                }\n                 //System.out.println(num);\n\n            }\n               System.out.println(\"CLUSTER INSTANCES=\"+a);\n\n\n        }\n        System.out.println(\"TOTAL INSTANCE\"+c);\n    }\n\n\n    public static void main(String[] args) throws FileNotFoundException \n    {\n    readFile();\n    first_itration();\n\n    while(checker!=0)\n            {\n            calck_mean();\n            kmeans1();\n            check();\n            } \n  dispaly();\n  print();\n    }\n\n\n\n\n}\n\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n</code></pre>\n"},{"comments":[{"owner":{"account_id":3484078,"reputation":2533,"user_id":2915423,"display_name":"helvete"},"score":0,"creation_date":1694533778,"post_id":77074451,"comment_id":135902281,"body_markdown":"[Link only answers](https://meta.stackexchange.com/questions/8231/are-answers-that-just-contain-links-elsewhere-really-good-answers/8259#8259) are considered very low quality and [can get deleted](https://stackoverflow.com/help/deleted-answers), please put the important parts from the linked resource into the answer body.","body":"<a href=\"https://meta.stackexchange.com/questions/8231/are-answers-that-just-contain-links-elsewhere-really-good-answers/8259#8259\">Link only answers</a> are considered very low quality and <a href=\"https://stackoverflow.com/help/deleted-answers\">can get deleted</a>, please put the important parts from the linked resource into the answer body."}],"tags":[],"owner":{"account_id":6125245,"reputation":1,"user_id":4777461,"display_name":"milan sonkar"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694306146,"creation_date":1694306146,"answer_id":77074451,"question_id":21111070,"body_markdown":"Take a look at SMILE library at https://haifengl.github.io/clustering.html\r\nIt has a lot of ready made opensource clustering algorithm implementation in Java","title":"Implementation of k-means clustering algorithm","body":"<p>Take a look at SMILE library at <a href=\"https://haifengl.github.io/clustering.html\" rel=\"nofollow noreferrer\">https://haifengl.github.io/clustering.html</a>\nIt has a lot of ready made opensource clustering algorithm implementation in Java</p>\n"}],"owner":{"account_id":2423885,"reputation":133,"user_id":2116256,"accept_rate":40,"display_name":"chinu"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":44321,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":21111871,"answer_count":5,"score":1,"last_activity_date":1694306146,"creation_date":1389695022,"question_id":21111070,"body_markdown":"In my program, i&#39;m taking k=2 for k-mean algorithm i.e i want only 2 clusters.\r\nI have implemented in a very simple and straightforward way, still i&#39;m unable to understand why my program is getting into infinite loop.\r\ncan anyone please guide me where i&#39;m making a mistake..?\r\n\r\nfor simplicity, i hav taken the input in the program code itself.\r\nhere is my code :\r\n\r\n    import java.io.*;\r\n    import java.lang.*;\r\n    class Kmean\r\n    {\r\n    public static void main(String args[])\r\n    {\r\n    int N=9;\r\n    int arr[]={2,4,10,12,3,20,30,11,25};    // initial data\r\n    int i,m1,m2,a,b,n=0;\r\n    boolean flag=true;\r\n    float sum1=0,sum2=0;\r\n    a=arr[0];b=arr[1];\r\n    m1=a; m2=b;\r\n    int cluster1[]=new int[9],cluster2[]=new int[9];\r\n    for(i=0;i&lt;9;i++)\r\n    \tSystem.out.print(arr[i]+ &quot;\\t&quot;);\r\n    System.out.println();\r\n    \r\n    do\r\n    {\r\n     n++;\r\n     int k=0,j=0;\r\n     for(i=0;i&lt;9;i++)\r\n     {\r\n    \tif(Math.abs(arr[i]-m1)&lt;=Math.abs(arr[i]-m2))\r\n    \t{\tcluster1[k]=arr[i];\r\n    \t\tk++;\r\n    \t}\r\n    \telse\r\n    \t{\tcluster2[j]=arr[i];\r\n    \t\tj++;\r\n    \t}\r\n     }\r\n    \tSystem.out.println();\r\n    \tfor(i=0;i&lt;9;i++)\r\n     \t\tsum1=sum1+cluster1[i];\r\n    \tfor(i=0;i&lt;9;i++)\r\n     \t\tsum2=sum1+cluster2[i];\r\n    \ta=m1;\r\n    \tb=m2;\r\n    \tm1=Math.round(sum1/k);\r\n    \tm2=Math.round(sum2/j);\r\n    \tif(m1==a &amp;&amp; m2==b)\r\n    \t\tflag=false;\r\n    \telse\r\n    \t\tflag=true;\r\n    \r\n    \tSystem.out.println(&quot;After iteration &quot;+ n +&quot; , cluster 1 :\\n&quot;);    //printing the clusters of each iteration\r\n    \tfor(i=0;i&lt;9;i++)\r\n    \t\tSystem.out.print(cluster1[i]+ &quot;\\t&quot;);\r\n    \r\n    \tSystem.out.println(&quot;\\n&quot;);\r\n    \tSystem.out.println(&quot;After iteration &quot;+ n +&quot; , cluster 2 :\\n&quot;);\r\n    \tfor(i=0;i&lt;9;i++)\r\n    \t\tSystem.out.print(cluster2[i]+ &quot;\\t&quot;);\r\n    \t\r\n    }while(flag);\r\n    \r\n    \tSystem.out.println(&quot;Final cluster 1 :\\n&quot;);            // final clusters\r\n    \tfor(i=0;i&lt;9;i++)\r\n    \t\tSystem.out.print(cluster1[i]+ &quot;\\t&quot;);\r\n    \r\n    \tSystem.out.println();\r\n    \tSystem.out.println(&quot;Final cluster 2 :\\n&quot;);\r\n    \tfor(i=0;i&lt;9;i++)\r\n    \t\tSystem.out.print(cluster2[i]+ &quot;\\t&quot;);\r\n     }\r\n    }\r\n\r\n","title":"Implementation of k-means clustering algorithm","body":"<p>In my program, i'm taking k=2 for k-mean algorithm i.e i want only 2 clusters.\nI have implemented in a very simple and straightforward way, still i'm unable to understand why my program is getting into infinite loop.\ncan anyone please guide me where i'm making a mistake..?</p>\n\n<p>for simplicity, i hav taken the input in the program code itself.\nhere is my code :</p>\n\n<pre><code>import java.io.*;\nimport java.lang.*;\nclass Kmean\n{\npublic static void main(String args[])\n{\nint N=9;\nint arr[]={2,4,10,12,3,20,30,11,25};    // initial data\nint i,m1,m2,a,b,n=0;\nboolean flag=true;\nfloat sum1=0,sum2=0;\na=arr[0];b=arr[1];\nm1=a; m2=b;\nint cluster1[]=new int[9],cluster2[]=new int[9];\nfor(i=0;i&lt;9;i++)\n    System.out.print(arr[i]+ \"\\t\");\nSystem.out.println();\n\ndo\n{\n n++;\n int k=0,j=0;\n for(i=0;i&lt;9;i++)\n {\n    if(Math.abs(arr[i]-m1)&lt;=Math.abs(arr[i]-m2))\n    {   cluster1[k]=arr[i];\n        k++;\n    }\n    else\n    {   cluster2[j]=arr[i];\n        j++;\n    }\n }\n    System.out.println();\n    for(i=0;i&lt;9;i++)\n        sum1=sum1+cluster1[i];\n    for(i=0;i&lt;9;i++)\n        sum2=sum1+cluster2[i];\n    a=m1;\n    b=m2;\n    m1=Math.round(sum1/k);\n    m2=Math.round(sum2/j);\n    if(m1==a &amp;&amp; m2==b)\n        flag=false;\n    else\n        flag=true;\n\n    System.out.println(\"After iteration \"+ n +\" , cluster 1 :\\n\");    //printing the clusters of each iteration\n    for(i=0;i&lt;9;i++)\n        System.out.print(cluster1[i]+ \"\\t\");\n\n    System.out.println(\"\\n\");\n    System.out.println(\"After iteration \"+ n +\" , cluster 2 :\\n\");\n    for(i=0;i&lt;9;i++)\n        System.out.print(cluster2[i]+ \"\\t\");\n\n}while(flag);\n\n    System.out.println(\"Final cluster 1 :\\n\");            // final clusters\n    for(i=0;i&lt;9;i++)\n        System.out.print(cluster1[i]+ \"\\t\");\n\n    System.out.println();\n    System.out.println(\"Final cluster 2 :\\n\");\n    for(i=0;i&lt;9;i++)\n        System.out.print(cluster2[i]+ \"\\t\");\n }\n}\n</code></pre>\n"},{"tags":["java","completable-future","ebean","completion-stage"],"comments":[{"owner":{"account_id":465573,"reputation":192703,"user_id":869736,"accept_rate":82,"display_name":"Louis Wasserman"},"score":0,"creation_date":1694277385,"post_id":77072817,"comment_id":135871570,"body_markdown":"This is going to depend on `internalAPI`, which you haven&#39;t shown us.","body":"This is going to depend on <code>internalAPI</code>, which you haven&#39;t shown us."},{"owner":{"account_id":465573,"reputation":192703,"user_id":869736,"accept_rate":82,"display_name":"Louis Wasserman"},"score":0,"creation_date":1694279344,"post_id":77072817,"comment_id":135871770,"body_markdown":"(It looks like `internalAPI` fundamentally expects a Function, to which the answer is &quot;this is impossible.&quot; You can probably chain it with other CompletionStages, but that&#39;ll require going outside whatever internalAPI does; there isn&#39;t a generic way to do this.","body":"(It looks like <code>internalAPI</code> fundamentally expects a Function, to which the answer is &quot;this is impossible.&quot; You can probably chain it with other CompletionStages, but that&#39;ll require going outside whatever internalAPI does; there isn&#39;t a generic way to do this."},{"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"score":1,"creation_date":1694287168,"post_id":77072817,"comment_id":135872525,"body_markdown":"What about just doing &quot;first step&quot; inside the function passed to `internalAPI`, then executing `secondStep` via e.g., `thenCompose`?","body":"What about just doing &quot;first step&quot; inside the function passed to <code>internalAPI</code>, then executing <code>secondStep</code> via e.g., <code>thenCompose</code>?"},{"owner":{"account_id":269513,"reputation":14298,"user_id":558892,"accept_rate":79,"display_name":"Deqing"},"score":0,"creation_date":1694305663,"post_id":77072817,"comment_id":135873946,"body_markdown":"@LouisWasserman I added implementation of the internalAPI","body":"@LouisWasserman I added implementation of the internalAPI"},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":0,"creation_date":1694429999,"post_id":77072817,"comment_id":135885379,"body_markdown":"As Slaw said, something like `foo1().thenCompose(x -&gt; internalAPI(param -&gt; { secondStep(); return Boolean.TRUE; });`, except that you have to check the boolean values if you keep using boolean values as success indicator, instead of using exceptions/failed futures.","body":"As Slaw said, something like <code>foo1().thenCompose(x -&gt; internalAPI(param -&gt; { secondStep(); return Boolean.TRUE; });</code>, except that you have to check the boolean values if you keep using boolean values as success indicator, instead of using exceptions/failed futures."}],"owner":{"account_id":269513,"reputation":14298,"user_id":558892,"accept_rate":79,"display_name":"Deqing"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":52,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1694305606,"creation_date":1694272052,"question_id":77072817,"body_markdown":"We have an internal API that executes the code in a lambda and returns a Boolean result in a CompleteStage:\r\n\r\n    private CompletionStage&lt;Boolean&gt; foo1() {\r\n        return internalAPI(param -&gt; {\r\n            // first step\r\n            // second step\r\n            return Boolean.TRUE;\r\n        });\r\n    }\r\n\r\nNow the second step is implemented as an async task as well:\r\n\r\n    private CompletionStage&lt;Boolean&gt; foo2() {\r\n        return internalAPI(param -&gt; {\r\n            // first step\r\n            secondStep();  // &lt;-- how to execute this and get result of it?\r\n            // if second step finished successfully then ... \r\n            return Boolean.TRUE;\r\n        });\r\n    }\r\n\r\n    private CompletionStage&lt;Boolean&gt; secondStep() {\r\n        // do something\r\n    }\r\n\r\nHow do I make the `secondStep()` run in the `foo2()`, make sure it&#39;s finished before hitting `return Boolean.TRUE;`?\r\n\r\n\r\n--- EDIT ---\r\n\r\nThis is the brief implementation of `internalAPI()`, basically it&#39;s trying to do all steps in one transaction and if one of the steps is failed the transaction can be rollback:\r\n\r\n    public &lt;A&gt; CompletableFuture&lt;A&gt; internalAPI(Function&lt;Connection, A&gt; block) {\r\n        return CompletableFuture.supplyAsync(() -&gt; doTransaction(block),\r\n                new HttpExecutionContext(databaseContext).current());\r\n    }\r\n\r\n    public &lt;T&gt; T doTransaction(Function&lt;Connection, T&gt; block) {\r\n        Transaction tx = Ebean.beginTransaction();\r\n        try (Connection sql2oConnection = sql.open()) {\r\n            spliceConnections(sql2oConnection, tx.getConnection());\r\n            T ret = block.apply(sql2oConnection);\r\n            Ebean.commitTransaction();\r\n            return ret;\r\n        } finally {\r\n            Ebean.endTransaction();\r\n        }\r\n    }","title":"Do a CompletionStage inside a CompletionStage","body":"<p>We have an internal API that executes the code in a lambda and returns a Boolean result in a CompleteStage:</p>\n<pre><code>private CompletionStage&lt;Boolean&gt; foo1() {\n    return internalAPI(param -&gt; {\n        // first step\n        // second step\n        return Boolean.TRUE;\n    });\n}\n</code></pre>\n<p>Now the second step is implemented as an async task as well:</p>\n<pre><code>private CompletionStage&lt;Boolean&gt; foo2() {\n    return internalAPI(param -&gt; {\n        // first step\n        secondStep();  // &lt;-- how to execute this and get result of it?\n        // if second step finished successfully then ... \n        return Boolean.TRUE;\n    });\n}\n\nprivate CompletionStage&lt;Boolean&gt; secondStep() {\n    // do something\n}\n</code></pre>\n<p>How do I make the <code>secondStep()</code> run in the <code>foo2()</code>, make sure it's finished before hitting <code>return Boolean.TRUE;</code>?</p>\n<p>--- EDIT ---</p>\n<p>This is the brief implementation of <code>internalAPI()</code>, basically it's trying to do all steps in one transaction and if one of the steps is failed the transaction can be rollback:</p>\n<pre><code>public &lt;A&gt; CompletableFuture&lt;A&gt; internalAPI(Function&lt;Connection, A&gt; block) {\n    return CompletableFuture.supplyAsync(() -&gt; doTransaction(block),\n            new HttpExecutionContext(databaseContext).current());\n}\n\npublic &lt;T&gt; T doTransaction(Function&lt;Connection, T&gt; block) {\n    Transaction tx = Ebean.beginTransaction();\n    try (Connection sql2oConnection = sql.open()) {\n        spliceConnections(sql2oConnection, tx.getConnection());\n        T ret = block.apply(sql2oConnection);\n        Ebean.commitTransaction();\n        return ret;\n    } finally {\n        Ebean.endTransaction();\n    }\n}\n</code></pre>\n"},{"tags":["java","tostring","long-integer"],"comments":[{"owner":{"account_id":1691630,"reputation":49583,"user_id":1553851,"accept_rate":73,"display_name":"shmosel"},"score":2,"creation_date":1686114447,"post_id":76420021,"comment_id":134752992,"body_markdown":"Please include the specific inputs and outputs you&#39;re having trouble with.","body":"Please include the specific inputs and outputs you&#39;re having trouble with."},{"owner":{"account_id":2396133,"reputation":2138,"user_id":2638227,"display_name":"Mustafa &#214;z&#231;etin"},"score":0,"creation_date":1686114453,"post_id":76420021,"comment_id":134752993,"body_markdown":"What does `Long.parseLong(numb)` return? Can you put a break point and inspect it?","body":"What does <code>Long.parseLong(numb)</code> return? Can you put a break point and inspect it?"}],"answers":[{"tags":[],"owner":{"account_id":9760,"reputation":85860,"user_id":18157,"accept_rate":100,"display_name":"Jim Garrison"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1686115533,"creation_date":1686115533,"answer_id":76420102,"question_id":76420021,"body_markdown":"To represent a number in a given base _n_, you must have _n_ distinct symbols.\r\n\r\nThe range of possible bases is limited, and certainly does not go up to `Integer.MAX_VALUE`. The actual limit is given in `Character.MAX_RADIX`, which has the value `36`.  This is what you should be using instead of `Integer.MAX_VALUE`.\r\n\r\n    public static int bases(String numb) {\r\n        for (int i = 2; i &lt; Character.MAX_RADIX; i++) {\r\n            String basecheck = &quot;&quot;;\r\n            basecheck = Long.toString(Long.parseLong(numb), i);\r\n            ...\r\n","title":"not sure how to fix long.tostring failure","body":"<p>To represent a number in a given base <em>n</em>, you must have <em>n</em> distinct symbols.</p>\n<p>The range of possible bases is limited, and certainly does not go up to <code>Integer.MAX_VALUE</code>. The actual limit is given in <code>Character.MAX_RADIX</code>, which has the value <code>36</code>.  This is what you should be using instead of <code>Integer.MAX_VALUE</code>.</p>\n<pre><code>public static int bases(String numb) {\n    for (int i = 2; i &lt; Character.MAX_RADIX; i++) {\n        String basecheck = &quot;&quot;;\n        basecheck = Long.toString(Long.parseLong(numb), i);\n        ...\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4228398,"reputation":17727,"user_id":3461397,"display_name":"Oleg Cherednik"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694304034,"creation_date":1694304034,"answer_id":77074407,"question_id":76420021,"body_markdown":"```java\r\npublic static void main(String... args) {\r\n    Scanner scan = new Scanner(System.in);\r\n    String[] nums = scan.nextLine().split(&quot;\\\\s+&quot;);\r\n\r\n    for (String num : nums) {\r\n        if (&quot;0&quot;.equals(num))\r\n            return;\r\n\r\n        System.out.println(base(num));\r\n    }\r\n}\r\n\r\npublic static int base(String num) {\r\n    final BigInteger b = new BigInteger(num);\r\n    final BigInteger max = b.divide(BigInteger.TWO);\r\n\r\n    for (int i = 2; BigInteger.valueOf(i).compareTo(max) &lt;= 0; i++)\r\n        if (isPalindrome(b.toString(i)))\r\n            return i;\r\n\r\n    return 0;\r\n}\r\n\r\nprivate static boolean isPalindrome(String str) {\r\n    for (int i = 0, j = str.length() - 1; i &lt; j; i++, j--)\r\n        if (str.charAt(i) != str.charAt(j))\r\n            return false;\r\n\r\n    return true;\r\n}\r\n```","title":"not sure how to fix long.tostring failure","body":"<pre class=\"lang-java prettyprint-override\"><code>public static void main(String... args) {\n    Scanner scan = new Scanner(System.in);\n    String[] nums = scan.nextLine().split(&quot;\\\\s+&quot;);\n\n    for (String num : nums) {\n        if (&quot;0&quot;.equals(num))\n            return;\n\n        System.out.println(base(num));\n    }\n}\n\npublic static int base(String num) {\n    final BigInteger b = new BigInteger(num);\n    final BigInteger max = b.divide(BigInteger.TWO);\n\n    for (int i = 2; BigInteger.valueOf(i).compareTo(max) &lt;= 0; i++)\n        if (isPalindrome(b.toString(i)))\n            return i;\n\n    return 0;\n}\n\nprivate static boolean isPalindrome(String str) {\n    for (int i = 0, j = str.length() - 1; i &lt; j; i++, j--)\n        if (str.charAt(i) != str.charAt(j))\n            return false;\n\n    return true;\n}\n</code></pre>\n"}],"owner":{"account_id":28769598,"reputation":1,"user_id":22033647,"display_name":"helios"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":51,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":2,"score":-1,"last_activity_date":1694304034,"creation_date":1686114160,"question_id":76420021,"body_markdown":"\\` I am doing a problem and we are supposed to write a program that reads a sequence of positive integers. The first zero terminates the input. For each input, N, the program computes the smallest base B (where B≥2) such that N is palindromic when written in base B. my code is fine for lowest palindromic bases yet when I get to a higher base with a bigger number, the .ToString method doesn&#39;t add my longs to the string correctly. It just adds random letters and numbers.\r\n\r\n```\r\nimport java.util.Arrays;\r\nimport java.util.Scanner;\r\n\r\npublic class num5 {\r\n\tpublic static void main(String[] args) {\r\n\t\tScanner in = new Scanner(System.in);\r\n\t\tString nums[] = in.nextLine().split(&quot; &quot;);\r\n\t\tfor (int i = 0; i &lt; nums.length - 1; i++) {\r\n\t\t\tif (nums[i].equals(&quot;0&quot;)) {\r\n\t\t\t\tSystem.exit(0);\r\n\t\t\t}\r\n\t\t\tSystem.out.println(bases(nums[i]));\r\n\t\t}\r\n\r\n\t\tfor (String var : nums) {\r\n\t\t\tSystem.out.println(var);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static boolean ispalin(String original) {\r\n\r\n\t\tString reverse = &quot;&quot;;\r\n\r\n\t\tint length = original.length();\r\n\t\tfor (int k = (length - 1); k &gt;= 0; k--)\r\n\t\t\treverse = reverse + original.charAt(k);\r\n\t\tif (original.equals(reverse))\r\n\t\t\treturn true;\r\n\t\telse\r\n\t\t\treturn false;\r\n\t}\r\n\r\n\tpublic static int bases(String numb) {\r\n\t\tfor (int i = 2; i &lt; Integer.MAX_VALUE; i++) {\r\n\t\t\tString basecheck = &quot;&quot;;\r\n\t\t\tbasecheck = Long.toString(Long.parseLong(numb), i);\r\n\t\t\tif (ispalin(basecheck)) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\r\n}\r\n```\r\n\r\nIs there any way to fix this problem?","title":"not sure how to fix long.tostring failure","body":"<p>` I am doing a problem and we are supposed to write a program that reads a sequence of positive integers. The first zero terminates the input. For each input, N, the program computes the smallest base B (where B≥2) such that N is palindromic when written in base B. my code is fine for lowest palindromic bases yet when I get to a higher base with a bigger number, the .ToString method doesn't add my longs to the string correctly. It just adds random letters and numbers.</p>\n<pre><code>import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class num5 {\n    public static void main(String[] args) {\n        Scanner in = new Scanner(System.in);\n        String nums[] = in.nextLine().split(&quot; &quot;);\n        for (int i = 0; i &lt; nums.length - 1; i++) {\n            if (nums[i].equals(&quot;0&quot;)) {\n                System.exit(0);\n            }\n            System.out.println(bases(nums[i]));\n        }\n\n        for (String var : nums) {\n            System.out.println(var);\n        }\n    }\n\n    public static boolean ispalin(String original) {\n\n        String reverse = &quot;&quot;;\n\n        int length = original.length();\n        for (int k = (length - 1); k &gt;= 0; k--)\n            reverse = reverse + original.charAt(k);\n        if (original.equals(reverse))\n            return true;\n        else\n            return false;\n    }\n\n    public static int bases(String numb) {\n        for (int i = 2; i &lt; Integer.MAX_VALUE; i++) {\n            String basecheck = &quot;&quot;;\n            basecheck = Long.toString(Long.parseLong(numb), i);\n            if (ispalin(basecheck)) {\n                return i;\n            }\n        }\n        return 0;\n    }\n\n}\n</code></pre>\n<p>Is there any way to fix this problem?</p>\n"},{"tags":["java","mysql","jdbc","glassfish"],"comments":[{"owner":{"account_id":15064163,"reputation":13516,"user_id":10871900,"display_name":"dan1st is crying"},"score":0,"creation_date":1689093025,"post_id":76663884,"comment_id":135163183,"body_markdown":"Does [this](https://stackoverflow.com/questions/16891182/keytool-error-keystore-was-tampered-with-or-password-was-incorrect) maybe help?","body":"Does <a href=\"https://stackoverflow.com/questions/16891182/keytool-error-keystore-was-tampered-with-or-password-was-incorrect\">this</a> maybe help?"}],"answers":[{"comments":[{"owner":{"account_id":411863,"reputation":7400,"user_id":784594,"display_name":"OndroMih"},"score":0,"creation_date":1694303866,"post_id":77074397,"comment_id":135873851,"body_markdown":"Just for reference, if you&#39;d like to use SSL, you need to specify the following property in the JVM config: `-Djavax.net.ssl.keyStorePassword=changeit`, where &quot;changeit&quot; is the default password for the GlassFish certificte stores, and you&#39;ll also need to add the public key from the MySQL server into GlassFish so that it&#39;s trusted by GlassFish. But you only need to do this in production if you want to secure the communication between GlassFish and MySQL.","body":"Just for reference, if you&#39;d like to use SSL, you need to specify the following property in the JVM config: <code>-Djavax.net.ssl.keyStorePassword=changeit</code>, where &quot;changeit&quot; is the default password for the GlassFish certificte stores, and you&#39;ll also need to add the public key from the MySQL server into GlassFish so that it&#39;s trusted by GlassFish. But you only need to do this in production if you want to secure the communication between GlassFish and MySQL."},{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1694322278,"post_id":77074397,"comment_id":135874675,"body_markdown":"You&#39;ll need to add the *certificate* from the MySQL server into Glassfish&#39;s truststore, if it isn&#39;t signed by a CA.","body":"You&#39;ll need to add the <i>certificate</i> from the MySQL server into Glassfish&#39;s truststore, if it isn&#39;t signed by a CA."},{"owner":{"account_id":411863,"reputation":7400,"user_id":784594,"display_name":"OndroMih"},"score":0,"creation_date":1694417520,"post_id":77074397,"comment_id":135883194,"body_markdown":"Yes, I’m sorry, I meant the certificate, not the public key.","body":"Yes, I’m sorry, I meant the certificate, not the public key."}],"tags":[],"owner":{"account_id":411863,"reputation":7400,"user_id":784594,"display_name":"OndroMih"},"comment_count":3,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1694303684,"creation_date":1694303684,"answer_id":77074397,"question_id":76663884,"body_markdown":"The MySQL driver uses secure connection (SSL/TLS) by default, which doesn&#39;t work out of the box and requires some configuration in GlassFish.\r\n\r\nIf you&#39;re just getting started, I recommend to disable SSL in the driver, with this connection URL:\r\n\r\n&quot;jdbc:mysql://localhost:3306/library?useSSL=false&quot;","title":"java.sql.SQLNonTransientConnectionException: Cannot open file:keystore.jks [Keystore was tampered with, or password was incorrect]","body":"<p>The MySQL driver uses secure connection (SSL/TLS) by default, which doesn't work out of the box and requires some configuration in GlassFish.</p>\n<p>If you're just getting started, I recommend to disable SSL in the driver, with this connection URL:</p>\n<p>&quot;jdbc:mysql://localhost:3306/library?useSSL=false&quot;</p>\n"}],"owner":{"account_id":17291258,"reputation":1,"user_id":12522767,"display_name":"Subhranshu Mohapatra"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":313,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694303684,"creation_date":1689091692,"question_id":76663884,"body_markdown":"I am new to Java world, while creating a webapp using NetBeans code is working fine till get method is executed but when I am trying to execute the SQL query glassfish is unable to show data from MSQL DB and giving errors. I am using \r\n\r\n- Apache NetBeans IDE 18\r\n- JDK20\r\n- Glassfish 7.0.3\r\n- MySQL 8.0 CE\r\n- windows10\r\n\r\n\r\n\r\n\r\nIn my project created a servlet called GreetingServlet.java which should get executed to fetch data from library database. library is running. But my code is showing errors in web browser like\r\n\r\n```none\r\nHTTP Status 500 - Internal Server Error\r\ntype Exception report\r\nmessageInternal Server Error\r\ndescriptionThe server encountered an internal error that prevented it from fulfilling this request.\r\nexception\r\njakarta.servlet.ServletException: Servlet Could not display records.\r\nroot cause\r\n\r\njava.sql.SQLNonTransientConnectionException: Cannot open file:C:\\Users\\Subhranshu\\glassfish7\\glassfish\\domains\\domain1/config/keystore.jks [Keystore was tampered with, or password was incorrect]\r\nroot cause\r\n\r\ncom.mysql.cj.exceptions.SSLParamsException: Cannot open file:C:\\Users\\Subhranshu\\glassfish7\\glassfish\\domains\\domain1/config/keystore.jks [Keystore was tampered with, or password was incorrect]\r\nroot cause\r\n\r\njava.io.IOException: Keystore was tampered with, or password was incorrect\r\nroot cause\r\n\r\njava.security.UnrecoverableKeyException: Password verification failed\r\n```\r\n\r\nPlease find my code:\r\n\r\n           \r\n```java\r\nConnection con;\r\ncon = null;  \r\nPreparedStatement stmt = null;\r\nResultSet rs = null;\r\ntry {\r\n    Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);\r\n    con =DriverManager.getConnection \r\n    //(&quot;jdbc:mysql://127.0.0.1:3306/library&quot;,&quot;root&quot;,&quot;&quot;);\r\n    (&quot;jdbc:mysql://localhost:3306/library&quot;,&quot;root&quot;,&quot;&quot;);\r\n    stmt = con.prepareStatement(&quot;select * from users where username = ? and password = ?&quot;);\r\n    stmt.setString(1, username);\r\n    stmt.setString(2, password);\r\n    rs = stmt.executeQuery();\r\n```\r\n","title":"java.sql.SQLNonTransientConnectionException: Cannot open file:keystore.jks [Keystore was tampered with, or password was incorrect]","body":"<p>I am new to Java world, while creating a webapp using NetBeans code is working fine till get method is executed but when I am trying to execute the SQL query glassfish is unable to show data from MSQL DB and giving errors. I am using</p>\n<ul>\n<li>Apache NetBeans IDE 18</li>\n<li>JDK20</li>\n<li>Glassfish 7.0.3</li>\n<li>MySQL 8.0 CE</li>\n<li>windows10</li>\n</ul>\n<p>In my project created a servlet called GreetingServlet.java which should get executed to fetch data from library database. library is running. But my code is showing errors in web browser like</p>\n<pre class=\"lang-none prettyprint-override\"><code>HTTP Status 500 - Internal Server Error\ntype Exception report\nmessageInternal Server Error\ndescriptionThe server encountered an internal error that prevented it from fulfilling this request.\nexception\njakarta.servlet.ServletException: Servlet Could not display records.\nroot cause\n\njava.sql.SQLNonTransientConnectionException: Cannot open file:C:\\Users\\Subhranshu\\glassfish7\\glassfish\\domains\\domain1/config/keystore.jks [Keystore was tampered with, or password was incorrect]\nroot cause\n\ncom.mysql.cj.exceptions.SSLParamsException: Cannot open file:C:\\Users\\Subhranshu\\glassfish7\\glassfish\\domains\\domain1/config/keystore.jks [Keystore was tampered with, or password was incorrect]\nroot cause\n\njava.io.IOException: Keystore was tampered with, or password was incorrect\nroot cause\n\njava.security.UnrecoverableKeyException: Password verification failed\n</code></pre>\n<p>Please find my code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Connection con;\ncon = null;  \nPreparedStatement stmt = null;\nResultSet rs = null;\ntry {\n    Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);\n    con =DriverManager.getConnection \n    //(&quot;jdbc:mysql://127.0.0.1:3306/library&quot;,&quot;root&quot;,&quot;&quot;);\n    (&quot;jdbc:mysql://localhost:3306/library&quot;,&quot;root&quot;,&quot;&quot;);\n    stmt = con.prepareStatement(&quot;select * from users where username = ? and password = ?&quot;);\n    stmt.setString(1, username);\n    stmt.setString(2, password);\n    rs = stmt.executeQuery();\n</code></pre>\n"},{"tags":["java","oop","collections","frameworks"],"comments":[{"owner":{"account_id":27699053,"reputation":2348,"user_id":21144042,"display_name":"Diego Borba"},"score":1,"creation_date":1691699538,"post_id":76871815,"comment_id":135530755,"body_markdown":"*&quot;the ouptput for the below code is&quot;*.... ?","body":"<i>&quot;the ouptput for the below code is&quot;</i>.... ?"}],"answers":[{"comments":[{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1692633304,"post_id":76872017,"comment_id":135646970,"body_markdown":"To be more precise, it’s guaranteed that a `Map` doesn’t store multiple equal keys at all. Since it only keeps the first encountered key, there’s no ordering relationship between equal keys.","body":"To be more precise, it’s guaranteed that a <code>Map</code> doesn’t store multiple equal keys at all. Since it only keeps the first encountered key, there’s no ordering relationship between equal keys."}],"tags":[],"owner":{"account_id":9760,"reputation":85860,"user_id":18157,"accept_rate":100,"display_name":"Jim Garrison"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1691628187,"creation_date":1691628187,"answer_id":76872017,"question_id":76871815,"body_markdown":"&gt; ... the output should be {abc=1, def=1, ghi=1}\r\n\r\nThere is no reason to expect this behavior. Every comparison operation yields zero (i.e. &quot;equal&quot;) for your sample data, and there&#39;s no guarantee in the specification (i.e. the Javadoc) that `TreeMap` preserves insertion order for equal keys.  If you want to preserve insertion order you&#39;ll need to use a `LinkedHashMap`.","title":"Ambiguity during Custom Sorting of TreeMap","body":"<blockquote>\n<p>... the output should be {abc=1, def=1, ghi=1}</p>\n</blockquote>\n<p>There is no reason to expect this behavior. Every comparison operation yields zero (i.e. &quot;equal&quot;) for your sample data, and there's no guarantee in the specification (i.e. the Javadoc) that <code>TreeMap</code> preserves insertion order for equal keys.  If you want to preserve insertion order you'll need to use a <code>LinkedHashMap</code>.</p>\n"},{"tags":[],"owner":{"account_id":4228398,"reputation":17727,"user_id":3461397,"display_name":"Oleg Cherednik"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694302021,"creation_date":1694302021,"answer_id":77074347,"question_id":76871815,"body_markdown":"The output `{abc=3}` is not ambigous. You use the custom comparator, that treats all keys with **same length** as a same keys. And finally, the keys with greater length will be at the beginning.\r\n\r\n***P.S.** `TreeMap` is the `Map` implementation where keys are unique and sorted with given `Comparator`.*\r\n\r\n```java\r\nString[] s = { &quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;, &quot;abc&quot;, &quot;def&quot;, &quot;abc&quot; };\r\nMap&lt;String, Integer&gt; tm = new TreeMap&lt;&gt;();\r\n\r\nfor (String k : s) {\r\n    tm.merge(k, 1, Integer::sum);\r\n}\r\n\r\nSystem.out.println(tm);\r\n```\r\n\r\n**Output:**\r\n```\r\n{abc=3, def=2, ghi=1}\r\n```","title":"Ambiguity during Custom Sorting of TreeMap","body":"<p>The output <code>{abc=3}</code> is not ambigous. You use the custom comparator, that treats all keys with <strong>same length</strong> as a same keys. And finally, the keys with greater length will be at the beginning.</p>\n<p><em><strong>P.S.</strong> <code>TreeMap</code> is the <code>Map</code> implementation where keys are unique and sorted with given <code>Comparator</code>.</em></p>\n<pre class=\"lang-java prettyprint-override\"><code>String[] s = { &quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;, &quot;abc&quot;, &quot;def&quot;, &quot;abc&quot; };\nMap&lt;String, Integer&gt; tm = new TreeMap&lt;&gt;();\n\nfor (String k : s) {\n    tm.merge(k, 1, Integer::sum);\n}\n\nSystem.out.println(tm);\n</code></pre>\n<p><strong>Output:</strong></p>\n<pre><code>{abc=3, def=2, ghi=1}\n</code></pre>\n"}],"owner":{"account_id":25813484,"reputation":1,"user_id":19553805,"display_name":"Vishant Sandilya"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":50,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"answer_count":2,"score":-2,"last_activity_date":1694302021,"creation_date":1691623356,"question_id":76871815,"body_markdown":"the ouptput for the below code is:\r\n\r\n```\r\npublic static void main(String[] args) {\r\n    String[] s = {&quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;};\r\n    TreeMap&lt;String, Integer&gt; tm = new TreeMap&lt;&gt;((a, b) -&gt; -a.length() + b.length());\r\n\r\n    for (String k : s) {\r\n        tm.merge(k, 1, Integer::sum);\r\n    }\r\n\r\n    System.out.println(tm);\r\n    }\r\n```\r\n\r\nthe output should be:\r\n \r\n\r\n    {abc=1, def=1, ghi=1}","title":"Ambiguity during Custom Sorting of TreeMap","body":"<p>the ouptput for the below code is:</p>\n<pre><code>public static void main(String[] args) {\n    String[] s = {&quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;};\n    TreeMap&lt;String, Integer&gt; tm = new TreeMap&lt;&gt;((a, b) -&gt; -a.length() + b.length());\n\n    for (String k : s) {\n        tm.merge(k, 1, Integer::sum);\n    }\n\n    System.out.println(tm);\n    }\n</code></pre>\n<p>the output should be:</p>\n<pre><code>{abc=1, def=1, ghi=1}\n</code></pre>\n"},{"tags":["java","garbage-collection","g1gc"],"comments":[{"owner":{"account_id":350117,"reputation":8663,"user_id":685806,"accept_rate":44,"display_name":"Pino"},"score":0,"creation_date":1693934315,"post_id":77046489,"comment_id":135824048,"body_markdown":"Does this answer your question? [Does Java Garbage Collect always has to &quot;Stop-the-World&quot;?](https://stackoverflow.com/questions/40182392/does-java-garbage-collect-always-has-to-stop-the-world)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/40182392/does-java-garbage-collect-always-has-to-stop-the-world\">Does Java Garbage Collect always has to &quot;Stop-the-World&quot;?</a>"},{"owner":{"account_id":14156033,"reputation":156,"user_id":10226743,"display_name":"hmad"},"score":0,"creation_date":1693936189,"post_id":77046489,"comment_id":135824401,"body_markdown":"no that does not answer my question @Pino i know that there are cases when STW-GCs are necessary. the question is in my particular usage scenario are there any parameters that I can use to avoid STW-GC","body":"no that does not answer my question @Pino i know that there are cases when STW-GCs are necessary. the question is in my particular usage scenario are there any parameters that I can use to avoid STW-GC"},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1694000671,"post_id":77046489,"comment_id":135833021,"body_markdown":"Think about it this way: if there was a parameter which can avoid stop-the-world pauses even when we don’t know anything about their cause, like in your example, what do you think would be the reason that this parameter is not on by default?","body":"Think about it this way: if there was a parameter which can avoid stop-the-world pauses even when we don’t know anything about their cause, like in your example, what do you think would be the reason that this parameter is not on by default?"},{"owner":{"account_id":14156033,"reputation":156,"user_id":10226743,"display_name":"hmad"},"score":0,"creation_date":1694008888,"post_id":77046489,"comment_id":135834983,"body_markdown":"oh no - i am not looking for a magical parameter that would avoid stop-the-world pause, i have explained what is happening before the pause and i am asking if there are any tunables that would help in *this* situation.","body":"oh no - i am not looking for a magical parameter that would avoid stop-the-world pause, i have explained what is happening before the pause and i am asking if there are any tunables that would help in <i>this</i> situation."},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1694076453,"post_id":77046489,"comment_id":135844538,"body_markdown":"You didn’t explain what’s happening, you just described the symptoms we can see in these pictures. You also provided the *conjecture* that the symptoms imply that allocations went directly to the Old Gen, which is not backed by anything. The graph would look the same if just all young objects were promoted to old. But regardless of whether the conjecture is correct or not, it still doesn’t explain *why* this happens and without knowing why it happens, there is no way to fix the issue. Except for a `--do-not-make-a-spike-a-day` option which does not exist.","body":"You didn’t explain what’s happening, you just described the symptoms we can see in these pictures. You also provided the <i>conjecture</i> that the symptoms imply that allocations went directly to the Old Gen, which is not backed by anything. The graph would look the same if just all young objects were promoted to old. But regardless of whether the conjecture is correct or not, it still doesn’t explain <i>why</i> this happens and without knowing why it happens, there is no way to fix the issue. Except for a <code>--do-not-make-a-spike-a-day</code> option which does not exist."},{"owner":{"account_id":14156033,"reputation":156,"user_id":10226743,"display_name":"hmad"},"score":0,"creation_date":1694106753,"post_id":77046489,"comment_id":135851077,"body_markdown":"@Holger, please feel free to ask questions if you need more information rather than jumping to conclusions. If you disagree with my conjecture, let&#39;s discuss it . Kindly consider removing any comments that don&#39;t contribute productively, as they can be a time-wasting distraction for everyone.\n\nFurthermore, consider the possibility that other users might have encountered a similar usage pattern with their app and could offer a solution.\n\nare you expecting me to *explain* what exactly is happening and *why* it is happening?! stackoverflow is a discussion board!","body":"@Holger, please feel free to ask questions if you need more information rather than jumping to conclusions. If you disagree with my conjecture, let&#39;s discuss it . Kindly consider removing any comments that don&#39;t contribute productively, as they can be a time-wasting distraction for everyone.  Furthermore, consider the possibility that other users might have encountered a similar usage pattern with their app and could offer a solution.  are you expecting me to <i>explain</i> what exactly is happening and <i>why</i> it is happening?! stackoverflow is a discussion board!"},{"owner":{"account_id":1056871,"reputation":117749,"user_id":1059372,"accept_rate":97,"display_name":"Eugene"},"score":0,"creation_date":1694158578,"post_id":77046489,"comment_id":135857254,"body_markdown":"we had a similar scenario of a lot of apps, and what helped greatly was moving to jre-11. We still compile with 8 (there are reasons for that), but run in 11, mainly due to the massive improvements in g1gc. What we have observed is far, far less STW pauses and an increased number of mixed collections, which is a big win. You could try such a thing if possible","body":"we had a similar scenario of a lot of apps, and what helped greatly was moving to jre-11. We still compile with 8 (there are reasons for that), but run in 11, mainly due to the massive improvements in g1gc. What we have observed is far, far less STW pauses and an increased number of mixed collections, which is a big win. You could try such a thing if possible"},{"owner":{"account_id":54150,"reputation":2013,"user_id":161995,"accept_rate":100,"display_name":"Erik"},"score":0,"creation_date":1694672936,"post_id":77046489,"comment_id":135922535,"body_markdown":"A bit late to the party but can you check the log for humongous allocations? Humongous allocations will always go to old gen.","body":"A bit late to the party but can you check the log for humongous allocations? Humongous allocations will always go to old gen."}],"answers":[{"tags":[],"owner":{"account_id":3161929,"reputation":137,"user_id":2672803,"display_name":"dchristle"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694301931,"creation_date":1694301931,"answer_id":77074342,"question_id":77046489,"body_markdown":"**The problem is likely that your application is allocating a very large amount of long-lived objects in a short amount of time.** As other commenters have mentioned, you cannot stop all STW pauses, but given your large heap &amp; the fact that you&#39;re posting here, it probably means you hit a very long STW pause - maybe even a Full GC - during the spike. Enabling detailed logs with `-verbose:gc -XX:+PrintGCDetails` would give us better details to help.\r\n\r\nSince you didn&#39;t provide GC logs, it&#39;s difficult to say exactly, but there are some observations from your plots that can help us figure it out: \r\n\r\n_The Eden space usage gets very small, relative to the steady state._\r\n\r\nUnder normal conditions in G1, a &quot;Young GC&quot; is by far the most common GC, and it includes a STW pause that should ideally be small. Most of the points on your plots are probably Young GC&#39;s; when a GC event happens, the GC log prints the region sizes &amp; a log analysis/plotter can process them. In Young GC, G1 starts at the reference roots of your application, scans the reference tree deeper and deeper to find all &quot;live&quot; objects, and copies them to one of two &quot;Survivor&quot; spaces. \r\n\r\nRoughtly speaking, because the length of a Young GC STW pause is proportional to the amount of live objects, G1 will shrink the size of Eden to try to ensure future pauses meet the latency target. \r\n\r\n_The Old Gen usage has a rapid increase during the traffic spike of approx. 16GB. It is nearly monotonic, but contains a very small decrease mid way. Increasing `MaxTenuringThreshold` from its default of 6 to 15 didn&#39;t improve things._\r\n\r\nSince your application continues to allocate lots of memory quickly, and the Eden space is now smaller, it fills up fast. The time between when an object is allocated &amp; when a Young GC processes it is now even shorter, meaning those objects have less time to die. On average, this means a higher fraction will need to be copied to Survivor. By default, the Survivor region is just 1/6&#39;th the size of Eden. When the fraction of live Eden objects is high, existing Survivor objects will get prematurely promoted to Old to free up space. Your application may allocate so much that objects promote directly from Young -&gt; Old. This explains why you see a rapid increase in the size of Old Gen. And since objects don&#39;t stay in Young or Survivor long enough to reach even the default MaxTenuringThreshold, explaining why increasing it did nothing.\r\n\r\nNormally, G1 tries to collect Old concurrently with a series of Mixed collections. The small dip during the spike suggests at least one Mixed collection may have happened, but it freed up almost no space. Since there are a few more points on the plot before the big drop, that may mean no further Mixed collections ran or they ran but freed up very little space. The large drop could be a Mixed collection, but given that you&#39;re asking about how to stop bad pause behavior, it&#39;s probably a Full GC. With your heap size (&gt;40GB) and the amount of live data in your Old gen (~26GB), a Full GC would generally be quite long.\r\n\r\n**_Suggested strategies:_**\r\n\r\n**A: (Avoid Full GC):** If it&#39;s true the large drop is a Full GC, because your Old gen live set size is already quite large, you need to either increase your heap by at least ~5GB, or refactor your application to keep fewer objects in memory long term (reduce the steady state 26GB Old size). Theoretically, if you did try setting G1NewSize to 35% so that the ~16GB spike fits within Eden, it could stay in Eden long enough to die, avoiding a long Young GC pause. This isn&#39;t likely to work well in practice, though, since a larger Eden will make your Old even smaller, and increase the chance of Full GC. It&#39;s also relies on luck that Eden is almost empty exactly at the time the spike starts. Otherwise, large fractions of the spike will get copied to Old anyway &amp; the Young GC pause will be large. \r\n\r\n**B: (Application refactor):** This is the best approach, if it&#39;s possible to do. G1 is designed under the assumption that most objects in Eden are dead at the time of a Young GC, and that&#39;s not true for your application. The large amount of data you&#39;re receiving seems to stay live for a few minutes &amp; then get collected. Perhaps your code reads the entire incoming dataset into memory, and then only after it&#39;s fully in-memory, copies it to a database or does some other aggregation, before discarding it. Refactoring to process the data incrementally would mean the chunks die quickly in Eden &amp; little promotion happens. This is the ideal operating condition for G1 and would eliminate the Full GC.","title":"java how to avoid stop-the-world garbage collection","body":"<p><strong>The problem is likely that your application is allocating a very large amount of long-lived objects in a short amount of time.</strong> As other commenters have mentioned, you cannot stop all STW pauses, but given your large heap &amp; the fact that you're posting here, it probably means you hit a very long STW pause - maybe even a Full GC - during the spike. Enabling detailed logs with <code>-verbose:gc -XX:+PrintGCDetails</code> would give us better details to help.</p>\n<p>Since you didn't provide GC logs, it's difficult to say exactly, but there are some observations from your plots that can help us figure it out:</p>\n<p><em>The Eden space usage gets very small, relative to the steady state.</em></p>\n<p>Under normal conditions in G1, a &quot;Young GC&quot; is by far the most common GC, and it includes a STW pause that should ideally be small. Most of the points on your plots are probably Young GC's; when a GC event happens, the GC log prints the region sizes &amp; a log analysis/plotter can process them. In Young GC, G1 starts at the reference roots of your application, scans the reference tree deeper and deeper to find all &quot;live&quot; objects, and copies them to one of two &quot;Survivor&quot; spaces.</p>\n<p>Roughtly speaking, because the length of a Young GC STW pause is proportional to the amount of live objects, G1 will shrink the size of Eden to try to ensure future pauses meet the latency target.</p>\n<p><em>The Old Gen usage has a rapid increase during the traffic spike of approx. 16GB. It is nearly monotonic, but contains a very small decrease mid way. Increasing <code>MaxTenuringThreshold</code> from its default of 6 to 15 didn't improve things.</em></p>\n<p>Since your application continues to allocate lots of memory quickly, and the Eden space is now smaller, it fills up fast. The time between when an object is allocated &amp; when a Young GC processes it is now even shorter, meaning those objects have less time to die. On average, this means a higher fraction will need to be copied to Survivor. By default, the Survivor region is just 1/6'th the size of Eden. When the fraction of live Eden objects is high, existing Survivor objects will get prematurely promoted to Old to free up space. Your application may allocate so much that objects promote directly from Young -&gt; Old. This explains why you see a rapid increase in the size of Old Gen. And since objects don't stay in Young or Survivor long enough to reach even the default MaxTenuringThreshold, explaining why increasing it did nothing.</p>\n<p>Normally, G1 tries to collect Old concurrently with a series of Mixed collections. The small dip during the spike suggests at least one Mixed collection may have happened, but it freed up almost no space. Since there are a few more points on the plot before the big drop, that may mean no further Mixed collections ran or they ran but freed up very little space. The large drop could be a Mixed collection, but given that you're asking about how to stop bad pause behavior, it's probably a Full GC. With your heap size (&gt;40GB) and the amount of live data in your Old gen (~26GB), a Full GC would generally be quite long.</p>\n<p><strong><em>Suggested strategies:</em></strong></p>\n<p><strong>A: (Avoid Full GC):</strong> If it's true the large drop is a Full GC, because your Old gen live set size is already quite large, you need to either increase your heap by at least ~5GB, or refactor your application to keep fewer objects in memory long term (reduce the steady state 26GB Old size). Theoretically, if you did try setting G1NewSize to 35% so that the ~16GB spike fits within Eden, it could stay in Eden long enough to die, avoiding a long Young GC pause. This isn't likely to work well in practice, though, since a larger Eden will make your Old even smaller, and increase the chance of Full GC. It's also relies on luck that Eden is almost empty exactly at the time the spike starts. Otherwise, large fractions of the spike will get copied to Old anyway &amp; the Young GC pause will be large.</p>\n<p><strong>B: (Application refactor):</strong> This is the best approach, if it's possible to do. G1 is designed under the assumption that most objects in Eden are dead at the time of a Young GC, and that's not true for your application. The large amount of data you're receiving seems to stay live for a few minutes &amp; then get collected. Perhaps your code reads the entire incoming dataset into memory, and then only after it's fully in-memory, copies it to a database or does some other aggregation, before discarding it. Refactoring to process the data incrementally would mean the chunks die quickly in Eden &amp; little promotion happens. This is the ideal operating condition for G1 and would eliminate the Full GC.</p>\n"}],"owner":{"account_id":14156033,"reputation":156,"user_id":10226743,"display_name":"hmad"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":297,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1694301931,"creation_date":1693933933,"question_id":77046489,"body_markdown":"we have an market app that streams market data, this gets a spike of data on a daily basis.\r\ndue to the allocations during the spike the VM ends up doing a stop-the-world garbage collection.\r\nFrom the usage graphs it looks like all the allocation during the spike goes directly to old gen? are there any g1gc parameters that can be used to change this behavior? i am thinking by keeping them in eden space we&#39;ll be able to avoid the STW-gc\r\n\r\ntried -XX:MaxTenuringThreshold=15 does not seem to have an effect.\r\n\r\nusing java 8 with g1gc\r\n\r\n[![Total Heap Usage][1]][1]\r\nTotal Heap Usage\r\n\r\n[![G1 Eden space, during the spike the usage is going down][2]][2]\r\nG1 Eden space: during the spike the usage is going down\r\n\r\n[![G1 old gen, looks like all allocation during the spike is going directly to old gen][3]][3]\r\nG1 old gen: looks like all allocation during the spike is going directly to old gen\r\n\r\n  [1]: https://i.stack.imgur.com/H5z9A.png\r\n  [2]: https://i.stack.imgur.com/ITuol.png\r\n  [3]: https://i.stack.imgur.com/xqb2a.png","title":"java how to avoid stop-the-world garbage collection","body":"<p>we have an market app that streams market data, this gets a spike of data on a daily basis.\ndue to the allocations during the spike the VM ends up doing a stop-the-world garbage collection.\nFrom the usage graphs it looks like all the allocation during the spike goes directly to old gen? are there any g1gc parameters that can be used to change this behavior? i am thinking by keeping them in eden space we'll be able to avoid the STW-gc</p>\n<p>tried -XX:MaxTenuringThreshold=15 does not seem to have an effect.</p>\n<p>using java 8 with g1gc</p>\n<p><a href=\"https://i.stack.imgur.com/H5z9A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H5z9A.png\" alt=\"Total Heap Usage\" /></a>\nTotal Heap Usage</p>\n<p><a href=\"https://i.stack.imgur.com/ITuol.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ITuol.png\" alt=\"G1 Eden space, during the spike the usage is going down\" /></a>\nG1 Eden space: during the spike the usage is going down</p>\n<p><a href=\"https://i.stack.imgur.com/xqb2a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xqb2a.png\" alt=\"G1 old gen, looks like all allocation during the spike is going directly to old gen\" /></a>\nG1 old gen: looks like all allocation during the spike is going directly to old gen</p>\n"},{"tags":["java","collections","java-8","java-stream"],"comments":[{"owner":{"account_id":1101161,"reputation":119804,"user_id":1093528,"accept_rate":65,"display_name":"fge"},"score":0,"creation_date":1396870228,"post_id":22911030,"comment_id":34967475,"body_markdown":"Uhm, doing this without streams is even more simple... But OK, this is an exercise, so...","body":"Uhm, doing this without streams is even more simple... But OK, this is an exercise, so..."},{"owner":{"account_id":271693,"reputation":7924,"user_id":562363,"accept_rate":59,"display_name":"Absurd-Mind"},"score":1,"creation_date":1396876953,"post_id":22911030,"comment_id":34972443,"body_markdown":"You can&#39;t do it with one stream as long it is unsorted. You need to resolve min and max beforehand. If your stream is sorted you can do it with with `.filter(x -&gt; x != ranges.get(0)).filter(x -&gt; x != ranges.get(ranges.size()-1))`","body":"You can&#39;t do it with one stream as long it is unsorted. You need to resolve min and max beforehand. If your stream is sorted you can do it with with <code>.filter(x -&gt; x != ranges.get(0)).filter(x -&gt; x != ranges.get(ranges.size()-1))</code>"},{"owner":{"account_id":3093821,"reputation":53931,"user_id":3182664,"accept_rate":55,"display_name":"Marco13"},"score":0,"creation_date":1396877905,"post_id":22911030,"comment_id":34973142,"body_markdown":"I think that the Scala version can not be compared to the Java version. The Scala approach (sorting and removing the first and the last element) is completely different to the Java approach (computing min and max, and filtering the stream)","body":"I think that the Scala version can not be compared to the Java version. The Scala approach (sorting and removing the first and the last element) is completely different to the Java approach (computing min and max, and filtering the stream)"},{"owner":{"account_id":61147,"reputation":2846,"user_id":182393,"accept_rate":85,"display_name":"Koziołek"},"score":0,"creation_date":1396897562,"post_id":22911030,"comment_id":34986000,"body_markdown":"@Marco13 I know but it&#39;s a nice example what I want to get.","body":"@Marco13 I know but it&#39;s a nice example what I want to get."},{"owner":{"account_id":3093821,"reputation":53931,"user_id":3182664,"accept_rate":55,"display_name":"Marco13"},"score":1,"creation_date":1396899727,"post_id":22911030,"comment_id":34987401,"body_markdown":"Shouldn&#39;t something like `List&lt;Integer&gt; collect = ranges.stream().sorted().collect(Collectors.toList()).subList(1, ranges.size()-1);` then be an option? It&#39;s at least closer to the Scala approach...","body":"Shouldn&#39;t something like <code>List&lt;Integer&gt; collect = ranges.stream().sorted().collect(Collectors.toList()).subLis&zwnj;&#8203;t(1, ranges.size()-1);</code> then be an option? It&#39;s at least closer to the Scala approach..."},{"owner":{"account_id":271693,"reputation":7924,"user_id":562363,"accept_rate":59,"display_name":"Absurd-Mind"},"score":0,"creation_date":1396908085,"post_id":22911030,"comment_id":34991894,"body_markdown":"@Koziołek please keep in mind that sorting the collection and removing the first/last element will be in O(n*log(n)) while calculating min/max and then eliminating these with a stream will be O(n) (both worst case)","body":"@Koziołek please keep in mind that sorting the collection and removing the first/last element will be in O(n*log(n)) while calculating min/max and then eliminating these with a stream will be O(n) (both worst case)"},{"owner":{"account_id":440158,"reputation":323231,"user_id":829571,"accept_rate":94,"display_name":"assylias"},"score":0,"creation_date":1396909153,"post_id":22911030,"comment_id":34992260,"body_markdown":"possible duplicate of [Excluding extrema from HashSet with a Stream](http://stackoverflow.com/questions/22923505/excluding-extrema-from-hashset-with-a-stream)","body":"possible duplicate of <a href=\"http://stackoverflow.com/questions/22923505/excluding-extrema-from-hashset-with-a-stream\">Excluding extrema from HashSet with a Stream</a>"}],"answers":[{"tags":[],"owner":{"account_id":3446101,"reputation":11395,"user_id":2886891,"accept_rate":75,"display_name":"Honza Zidek"},"comment_count":0,"down_vote_count":0,"up_vote_count":7,"is_accepted":true,"score":7,"last_activity_date":1396908567,"creation_date":1396906013,"answer_id":22923449,"question_id":22911030,"body_markdown":"The solution is not very efficient, but I think it follows your requirements - it does what you want and it is in one single *pipeline* - one single sequence of bulk data operations, how Java 8 calls it.\r\n\r\n    import java.util.Comparator;\r\n    import java.util.List;\r\n    import java.util.stream.Collectors;\r\n    import java.util.stream.Stream;\r\n\r\n    Stream&lt;Integer&gt; ranges = Stream.iterate(1, i -&gt; i + 1).limit(15);\r\n    List&lt;Integer&gt; collect = ranges\r\n        .sorted(Comparator.reverseOrder()) // sort the stream from the highest to the smallest\r\n        .skip(1)                           // discards 1 element from the beginning\r\n        .sorted()                          // sort the stream from the smallest to the highest\r\n        .skip(1)                           // discards 1 element from the beginning\r\n        .collect(Collectors.toList())     \r\n        ;\r\n\r\nBut, as fge suggested and Marco13 wrote in their comment below your question, it would be better and much more efficient just to sort the stream, terminate the pipeline to a list and then remove the first and the last member :P Or even faster without sort - go through all the elements, find min and max, remember their position and then remove them.","title":"Remove max (or min) from collection using Java8 streaming API","body":"<p>The solution is not very efficient, but I think it follows your requirements - it does what you want and it is in one single <em>pipeline</em> - one single sequence of bulk data operations, how Java 8 calls it.</p>\n\n<pre><code>import java.util.Comparator;\nimport java.util.List;\nimport java.util.stream.Collectors;\nimport java.util.stream.Stream;\n\nStream&lt;Integer&gt; ranges = Stream.iterate(1, i -&gt; i + 1).limit(15);\nList&lt;Integer&gt; collect = ranges\n    .sorted(Comparator.reverseOrder()) // sort the stream from the highest to the smallest\n    .skip(1)                           // discards 1 element from the beginning\n    .sorted()                          // sort the stream from the smallest to the highest\n    .skip(1)                           // discards 1 element from the beginning\n    .collect(Collectors.toList())     \n    ;\n</code></pre>\n\n<p>But, as fge suggested and Marco13 wrote in their comment below your question, it would be better and much more efficient just to sort the stream, terminate the pipeline to a list and then remove the first and the last member :P Or even faster without sort - go through all the elements, find min and max, remember their position and then remove them.</p>\n"},{"comments":[{"owner":{"account_id":969638,"reputation":2243,"user_id":992426,"accept_rate":86,"display_name":"habitats"},"score":0,"creation_date":1422475381,"post_id":24681064,"comment_id":44768812,"body_markdown":"Brilliant. I had no idea this existed!","body":"Brilliant. I had no idea this existed!"}],"tags":[],"owner":{"account_id":1416522,"reputation":91364,"user_id":3553087,"display_name":"Brian Goetz"},"comment_count":1,"down_vote_count":0,"up_vote_count":29,"is_accepted":false,"score":29,"last_activity_date":1405007651,"creation_date":1405007651,"answer_id":24681064,"question_id":22911030,"body_markdown":"Don&#39;t forget `Collection.removeIf`.  You can compute min and max, and then do:\r\n\r\n    list.removeIf(x -&gt; x == min || x == max);\r\n\r\n(This also deals well with duplicates.)","title":"Remove max (or min) from collection using Java8 streaming API","body":"<p>Don't forget <code>Collection.removeIf</code>.  You can compute min and max, and then do:</p>\n\n<pre><code>list.removeIf(x -&gt; x == min || x == max);\n</code></pre>\n\n<p>(This also deals well with duplicates.)</p>\n"},{"tags":[],"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694299829,"creation_date":1694299829,"answer_id":77074281,"question_id":22911030,"body_markdown":"As the other answers have shown, Java can do this just fine. To provide an alternative to the other answers, you can make this even more concise if you know the size of the data set beforehand. To match your Scala version, here is the essentially the same thing in Java.\r\n\r\n```java\r\nIntStream\r\n   .rangeClosed(1,15)\r\n   .sorted()               //Sorts the contents\r\n   .limit(dataSetSize - 1) //Keeps all except the last element\r\n   .skip(1)                //Removes the min element\r\n   .boxed()\r\n   .toList()\r\n   ;\r\n```\r\n\r\nThat gives you this.\r\n\r\n```\r\n[2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]\r\n```\r\n\r\nYou can replace the `IntStream.rangeClosed(1, 15)` with any `Stream&lt;T extends Comparable&lt;T&gt;&gt;`. As long as `T extends Comparable&lt;T&gt;`, then this strategy works.\r\n\r\nAnd if `T` does not implement `Comparable&lt;T&gt;`, just provide your own `Comparator&lt;T&gt;`.\r\n\r\n```java\r\nrecord Foo(int value) {}\r\n\r\nStream\r\n   .of(new Foo(1), new Foo(7), new Foo(3), new Foo(2), new Foo(6), new Foo(4), new Foo(5))\r\n   .sorted(Comparator.comparing(Foo::value))\r\n   .limit(dataSetSize - 1)\r\n   .skip(1)\r\n   .toList()\r\n   ;\r\n```\r\n\r\nThat gives you this.\r\n\r\n```\r\n[Foo[value=2], Foo[value=3], Foo[value=4], Foo[value=5], Foo[value=6]]\r\n```","title":"Remove max (or min) from collection using Java8 streaming API","body":"<p>As the other answers have shown, Java can do this just fine. To provide an alternative to the other answers, you can make this even more concise if you know the size of the data set beforehand. To match your Scala version, here is the essentially the same thing in Java.</p>\n<pre class=\"lang-java prettyprint-override\"><code>IntStream\n   .rangeClosed(1,15)\n   .sorted()               //Sorts the contents\n   .limit(dataSetSize - 1) //Keeps all except the last element\n   .skip(1)                //Removes the min element\n   .boxed()\n   .toList()\n   ;\n</code></pre>\n<p>That gives you this.</p>\n<pre><code>[2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]\n</code></pre>\n<p>You can replace the <code>IntStream.rangeClosed(1, 15)</code> with any <code>Stream&lt;T extends Comparable&lt;T&gt;&gt;</code>. As long as <code>T extends Comparable&lt;T&gt;</code>, then this strategy works.</p>\n<p>And if <code>T</code> does not implement <code>Comparable&lt;T&gt;</code>, just provide your own <code>Comparator&lt;T&gt;</code>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>record Foo(int value) {}\n\nStream\n   .of(new Foo(1), new Foo(7), new Foo(3), new Foo(2), new Foo(6), new Foo(4), new Foo(5))\n   .sorted(Comparator.comparing(Foo::value))\n   .limit(dataSetSize - 1)\n   .skip(1)\n   .toList()\n   ;\n</code></pre>\n<p>That gives you this.</p>\n<pre><code>[Foo[value=2], Foo[value=3], Foo[value=4], Foo[value=5], Foo[value=6]]\n</code></pre>\n"}],"owner":{"account_id":61147,"reputation":2846,"user_id":182393,"accept_rate":85,"display_name":"Koziołek"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":7158,"favorite_count":0,"down_vote_count":0,"up_vote_count":11,"accepted_answer_id":22923449,"answer_count":3,"score":11,"last_activity_date":1694299829,"creation_date":1396869933,"question_id":22911030,"body_markdown":"I have little problem with code design that use new streaming API from Java 8. I would like to learn new things and one of the task is:\r\n\r\nReject max and min from list. List not contains duplicates.\r\n\r\nLooks simple? Nope... My code:\r\n\r\n      List&lt;Integer&gt; ranges = Lists.newArrayList(new Range(1, 15));\r\n            List&lt;Integer&gt; collect = ranges.stream()\r\n                    .filter(x -&gt; x != ranges.stream()\r\n                            .mapToInt(Integer::intValue)\r\n                            .max()\r\n                            .getAsInt())\r\n                    .filter(x -&gt; x != ranges.stream()\r\n                            .mapToInt(Integer::intValue)\r\n                            .min()\r\n                            .getAsInt())\r\n                    \r\n                    .collect(Collectors.toList());\r\n            assertThat(collect).hasSize(13);   // OK\r\n            assertThat(collect).isEqualTo(Lists.newArrayList(new Range(2,14)));   // OK\r\n\r\nthis code is good (if only we dont have duplicates of min/max, but this is not a core problem here) but problem is that I use here three streams. First is main stream, second to remove max and third to remove min. \r\nIs there any possibility to do this task in one stream?\r\n\r\n//edit:\r\nVery primitive Scala version:\r\n\r\n    val list = List.range(1, 15).sortWith(_&gt;_).tail.reverse.tail\r\n\r\nwith additional sort because we could have shuiffeled list.","title":"Remove max (or min) from collection using Java8 streaming API","body":"<p>I have little problem with code design that use new streaming API from Java 8. I would like to learn new things and one of the task is:</p>\n\n<p>Reject max and min from list. List not contains duplicates.</p>\n\n<p>Looks simple? Nope... My code:</p>\n\n<pre><code>  List&lt;Integer&gt; ranges = Lists.newArrayList(new Range(1, 15));\n        List&lt;Integer&gt; collect = ranges.stream()\n                .filter(x -&gt; x != ranges.stream()\n                        .mapToInt(Integer::intValue)\n                        .max()\n                        .getAsInt())\n                .filter(x -&gt; x != ranges.stream()\n                        .mapToInt(Integer::intValue)\n                        .min()\n                        .getAsInt())\n\n                .collect(Collectors.toList());\n        assertThat(collect).hasSize(13);   // OK\n        assertThat(collect).isEqualTo(Lists.newArrayList(new Range(2,14)));   // OK\n</code></pre>\n\n<p>this code is good (if only we dont have duplicates of min/max, but this is not a core problem here) but problem is that I use here three streams. First is main stream, second to remove max and third to remove min. \nIs there any possibility to do this task in one stream?</p>\n\n<p>//edit:\nVery primitive Scala version:</p>\n\n<pre><code>val list = List.range(1, 15).sortWith(_&gt;_).tail.reverse.tail\n</code></pre>\n\n<p>with additional sort because we could have shuiffeled list.</p>\n"},{"tags":["java","string"],"comments":[{"owner":{"account_id":31180,"reputation":29173,"user_id":85421,"display_name":"user85421"},"score":2,"creation_date":1694267859,"post_id":77072552,"comment_id":135870645,"body_markdown":"are you sure that is `O(n&#178;)` and not `O(n)`? The outer loop is being *skipped* as often as the inner loop is being executed","body":"are you sure that is <code>O(n&#178;)</code> and not <code>O(n)</code>? The outer loop is being <i>skipped</i> as often as the inner loop is being executed"},{"owner":{"account_id":31180,"reputation":29173,"user_id":85421,"display_name":"user85421"},"score":0,"creation_date":1694268730,"post_id":77072552,"comment_id":135870726,"body_markdown":"but it has an error: infinite loop (for example with word `&quot;abc&quot;`) - *maybe* because `k` is **not** being set to `i` (or incremented) before starting the inner loop (that loop can actually be changed to use `i` directly no need for `k`)","body":"but it has an error: infinite loop (for example with word <code>&quot;abc&quot;</code>) - <i>maybe</i> because <code>k</code> is <b>not</b> being set to <code>i</code> (or incremented) before starting the inner loop (that loop can actually be changed to use <code>i</code> directly no need for <code>k</code>)"},{"owner":{"account_id":31180,"reputation":29173,"user_id":85421,"display_name":"user85421"},"score":0,"creation_date":1694269165,"post_id":77072552,"comment_id":135870776,"body_markdown":"actually  just change `i=k;`  to `i = k - 1; ` ( &#236;` will be incremented on next iteration) and it should work fine (and `O(n)`)","body":"actually  just change <code>i=k;</code>  to <code>i = k - 1; </code> ( &#236;` will be incremented on next iteration) and it should work fine (and <code>O(n)</code>)"},{"owner":{"account_id":465573,"reputation":192703,"user_id":869736,"accept_rate":82,"display_name":"Louis Wasserman"},"score":0,"creation_date":1694277465,"post_id":77072552,"comment_id":135871583,"body_markdown":"This is already O(n), it just has a small bug.","body":"This is already O(n), it just has a small bug."},{"owner":{"account_id":1689973,"reputation":37330,"user_id":1552534,"display_name":"WJS"},"score":0,"creation_date":1694467573,"post_id":77072552,"comment_id":135892199,"body_markdown":"@MadhukarH If any helped you solve the issue, please consider accepting one of the posted answers.","body":"@MadhukarH If any helped you solve the issue, please consider accepting one of the posted answers."}],"answers":[{"comments":[{"owner":{"account_id":1888781,"reputation":2007,"user_id":1707427,"display_name":"S&#246;ren"},"score":1,"creation_date":1694285517,"post_id":77072600,"comment_id":135872386,"body_markdown":"This is still O(n^2). Copying strings is O(n).","body":"This is still O(n^2). Copying strings is O(n)."}],"tags":[],"owner":{"account_id":16573818,"reputation":16,"user_id":11976107,"display_name":"Nhat Anh"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1694268665,"creation_date":1694268665,"answer_id":77072600,"question_id":77072552,"body_markdown":"With &quot;aaaabbccccaadd&quot; and the answer is &quot;a4b2c4a2d2&quot;, I assume this is counting the consecutive words occurrance right? if so then you just need one loop O(n).\r\n\r\n    private static String wordCount(String word){\r\n        if (word.isEmpty()) return &quot;&quot;;\r\n        \r\n        String result = &quot;&quot;;\r\n        int k = 0;\r\n        char currentChar = word.charAt(0);\r\n        for(int i = 0 ; i &lt; word.length() ; i++){\r\n            if (currentChar != word.charAt(i)) {\r\n                result += currentChar;\r\n                result += String.valueOf(k);\r\n                currentChar = word.charAt(i);\r\n                k = 1;\r\n            } else {\r\n                k++;\r\n            }\r\n        }\r\n        result += currentChar;\r\n        result += String.valueOf(k);\r\n\r\n        return result;\r\n    }","title":"String occurance of characters for e.g. &quot;aaaabbccccaadd&quot; the answer to be &quot;a4b2c4a2d2&quot;","body":"<p>With &quot;aaaabbccccaadd&quot; and the answer is &quot;a4b2c4a2d2&quot;, I assume this is counting the consecutive words occurrance right? if so then you just need one loop O(n).</p>\n<pre><code>private static String wordCount(String word){\n    if (word.isEmpty()) return &quot;&quot;;\n    \n    String result = &quot;&quot;;\n    int k = 0;\n    char currentChar = word.charAt(0);\n    for(int i = 0 ; i &lt; word.length() ; i++){\n        if (currentChar != word.charAt(i)) {\n            result += currentChar;\n            result += String.valueOf(k);\n            currentChar = word.charAt(i);\n            k = 1;\n        } else {\n            k++;\n        }\n    }\n    result += currentChar;\n    result += String.valueOf(k);\n\n    return result;\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":29402173,"reputation":3,"user_id":22528102,"display_name":"Madhukar H"},"score":0,"creation_date":1694269668,"post_id":77072619,"comment_id":135870822,"body_markdown":"regular expression solution is awesome, thanks !!","body":"regular expression solution is awesome, thanks !!"}],"tags":[],"owner":{"account_id":1689973,"reputation":37330,"user_id":1552534,"display_name":"WJS"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694269576,"creation_date":1694268857,"answer_id":77072619,"question_id":77072552,"body_markdown":"Here is a simple, imperative way to do it.\r\n\r\nInitialize some fields\r\n```\r\nString s = &quot;aaaabbccccaadd&quot;;\r\nStringBuilder sb = new StringBuilder();\r\nchar currentChar = s.charAt(0);\r\nint count = 1;\r\n```\r\n- iterate over the string, counting until the character changes\r\n- then append the character and the count to the StringBuilder. Then reset the `count` to `1` and assign `thisChar` to `currentChar`\r\n- once the loop is done.\r\n- append the last character and its count.\r\n```\r\n\r\nfor (int i = 1; i &lt; s.length(); i++) {\r\n    char thisChar = s.charAt(i);\r\n    if (currentChar == thisChar) {\r\n        count++;\r\n    } else {\r\n        sb.append(currentChar).append(count);\r\n        count = 1;\r\n        currentChar = thisChar;\r\n    }\r\n}\r\nsb.append(currentChar).append(count);\r\nSystem.out.println(sb);\r\n```\r\nprints\r\n```\r\na4b2c4a2d2\r\n```\r\nAnd here is a solution using regular expressions.\r\n\r\n- `(.)` capture a single character\r\n- `(\\\\1)*` followed by zero or more of the same character (uses a backreference).\r\n- then append `group(1)`, the single character followed by the length of the entire `group(0)`.\r\n```\r\nMatcher matcher = Pattern.compile(&quot;(.)(\\\\1)*&quot;).matcher(s);\r\nStringBuilder sb = new StringBuilder();\r\nwhile(matcher.find()) {\r\n    sb.append(matcher.group(1)).append(matcher.group(0).length());\r\n}\r\nSystem.out.println(sb);\r\n```\r\nprints\r\n```\r\na4b2c4a2d2\r\n","title":"String occurance of characters for e.g. &quot;aaaabbccccaadd&quot; the answer to be &quot;a4b2c4a2d2&quot;","body":"<p>Here is a simple, imperative way to do it.</p>\n<p>Initialize some fields</p>\n<pre><code>String s = &quot;aaaabbccccaadd&quot;;\nStringBuilder sb = new StringBuilder();\nchar currentChar = s.charAt(0);\nint count = 1;\n</code></pre>\n<ul>\n<li>iterate over the string, counting until the character changes</li>\n<li>then append the character and the count to the StringBuilder. Then reset the <code>count</code> to <code>1</code> and assign <code>thisChar</code> to <code>currentChar</code></li>\n<li>once the loop is done.</li>\n<li>append the last character and its count.</li>\n</ul>\n<pre><code>\nfor (int i = 1; i &lt; s.length(); i++) {\n    char thisChar = s.charAt(i);\n    if (currentChar == thisChar) {\n        count++;\n    } else {\n        sb.append(currentChar).append(count);\n        count = 1;\n        currentChar = thisChar;\n    }\n}\nsb.append(currentChar).append(count);\nSystem.out.println(sb);\n</code></pre>\n<p>prints</p>\n<pre><code>a4b2c4a2d2\n</code></pre>\n<p>And here is a solution using regular expressions.</p>\n<ul>\n<li><code>(.)</code> capture a single character</li>\n<li><code>(\\\\1)*</code> followed by zero or more of the same character (uses a backreference).</li>\n<li>then append <code>group(1)</code>, the single character followed by the length of the entire <code>group(0)</code>.</li>\n</ul>\n<pre><code>Matcher matcher = Pattern.compile(&quot;(.)(\\\\1)*&quot;).matcher(s);\nStringBuilder sb = new StringBuilder();\nwhile(matcher.find()) {\n    sb.append(matcher.group(1)).append(matcher.group(0).length());\n}\nSystem.out.println(sb);\n</code></pre>\n<p>prints</p>\n<pre><code>a4b2c4a2d2\n</code></pre>\n"},{"tags":[],"owner":{"account_id":23740623,"reputation":1,"user_id":17758716,"display_name":"Reilas"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694297980,"creation_date":1694297980,"answer_id":77074223,"question_id":77072552,"body_markdown":"You can reduce the iterations, at least, by simply checking for a character change.  \r\nIn your code, you are spawning a new loop, starting at _k_.\r\n\r\nHere is an example.  \r\n\r\n```java\r\nchar[] chars = &quot;aaaabbccccaadd&quot;.toCharArray();\r\nchar c;\r\nStringBuilder s = new StringBuilder();\r\ns.append(c = chars[0]);\r\nint b = 1;\r\nfor (int i = 1, n = chars.length; i &lt; n; i++) {\r\n    if (chars[i] == c) b++;\r\n    else {\r\n        if (b != 1) s.append(b);\r\n        b = 1;\r\n        s.append(c = chars[i]);\r\n    }\r\n}\r\ns.append(b);\r\n```\r\n\r\nYour code will execute the same example string, &quot;aaaabbccccaadd&quot; in _19_ iterations.  \r\nWhereas, this will execute it in _13_.\r\n\r\nI have a few recommendations for your code.\r\n\r\nUtilize variable declaration chains, and append _k_ as a _for-loop_ variable.  \r\nAnd, define a _length_ variable to prevent the loop from calling _word.length_ on every iteration.\r\n\r\n```java\r\nfor(int i = 0, k = 0, n = word.length() ; i &lt; n ; i++)\r\n```\r\n\r\n\r\nAlso, declare _temp_ outside of the _for-loop_, and place _count_ as an additional variable.\r\n\r\n```java\r\nchar temp;\r\nfor(int i = 0, k = 0, n = word.length(), count ; i &lt; n ; i++)\r\n```\r\n\r\nHere is the re-factor.\r\n\r\n```java\r\nString result = &quot;&quot;;\r\nchar temp;\r\nfor(int i = 0, k = 0, n = word.length(), count ; i &lt; n ; i++){\r\n    temp = word.charAt(i);\r\n    result += temp;\r\n    count = 0;\r\n    while(k &lt; n &amp;&amp; word.charAt(k) == temp){\r\n        k++;\r\n        count++;\r\n        temp = word.charAt(i);\r\n    }\r\n    i=k;\r\n    result += count;\r\n}\r\n\r\nreturn result;\r\n```","title":"String occurance of characters for e.g. &quot;aaaabbccccaadd&quot; the answer to be &quot;a4b2c4a2d2&quot;","body":"<p>You can reduce the iterations, at least, by simply checking for a character change.<br />\nIn your code, you are spawning a new loop, starting at <em>k</em>.</p>\n<p>Here is an example.</p>\n<pre class=\"lang-java prettyprint-override\"><code>char[] chars = &quot;aaaabbccccaadd&quot;.toCharArray();\nchar c;\nStringBuilder s = new StringBuilder();\ns.append(c = chars[0]);\nint b = 1;\nfor (int i = 1, n = chars.length; i &lt; n; i++) {\n    if (chars[i] == c) b++;\n    else {\n        if (b != 1) s.append(b);\n        b = 1;\n        s.append(c = chars[i]);\n    }\n}\ns.append(b);\n</code></pre>\n<p>Your code will execute the same example string, &quot;aaaabbccccaadd&quot; in <em>19</em> iterations.<br />\nWhereas, this will execute it in <em>13</em>.</p>\n<p>I have a few recommendations for your code.</p>\n<p>Utilize variable declaration chains, and append <em>k</em> as a <em>for-loop</em> variable.<br />\nAnd, define a <em>length</em> variable to prevent the loop from calling <em>word.length</em> on every iteration.</p>\n<pre class=\"lang-java prettyprint-override\"><code>for(int i = 0, k = 0, n = word.length() ; i &lt; n ; i++)\n</code></pre>\n<p>Also, declare <em>temp</em> outside of the <em>for-loop</em>, and place <em>count</em> as an additional variable.</p>\n<pre class=\"lang-java prettyprint-override\"><code>char temp;\nfor(int i = 0, k = 0, n = word.length(), count ; i &lt; n ; i++)\n</code></pre>\n<p>Here is the re-factor.</p>\n<pre class=\"lang-java prettyprint-override\"><code>String result = &quot;&quot;;\nchar temp;\nfor(int i = 0, k = 0, n = word.length(), count ; i &lt; n ; i++){\n    temp = word.charAt(i);\n    result += temp;\n    count = 0;\n    while(k &lt; n &amp;&amp; word.charAt(k) == temp){\n        k++;\n        count++;\n        temp = word.charAt(i);\n    }\n    i=k;\n    result += count;\n}\n\nreturn result;\n</code></pre>\n"}],"owner":{"account_id":29402173,"reputation":3,"user_id":22528102,"display_name":"Madhukar H"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":84,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"accepted_answer_id":77072600,"answer_count":3,"score":-1,"last_activity_date":1694297980,"creation_date":1694267609,"question_id":77072552,"body_markdown":"This question got asked by Monjim interview, I am able to do with brute force with time complexity of o(n2).\r\n\r\n\r\nSolution is -\r\n\r\n    private static String wordCount(String word){\r\n        String result = &quot;&quot;;\r\n        int k = 0;\r\n        for(int i = 0 ; i &lt; word.length() ; i++){\r\n            char temp = word.charAt(i);\r\n            result += temp;\r\n            int count = 0;\r\n            while(k &lt; word.length() &amp;&amp; word.charAt(k) == temp){\r\n                k++;\r\n                count++;\r\n                temp = word.charAt(i);\r\n            }\r\n            i=k;\r\n            result += count;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\nCan anyone help me out with lesser time complexity.....","title":"String occurance of characters for e.g. &quot;aaaabbccccaadd&quot; the answer to be &quot;a4b2c4a2d2&quot;","body":"<p>This question got asked by Monjim interview, I am able to do with brute force with time complexity of o(n2).</p>\n<p>Solution is -</p>\n<pre><code>private static String wordCount(String word){\n    String result = &quot;&quot;;\n    int k = 0;\n    for(int i = 0 ; i &lt; word.length() ; i++){\n        char temp = word.charAt(i);\n        result += temp;\n        int count = 0;\n        while(k &lt; word.length() &amp;&amp; word.charAt(k) == temp){\n            k++;\n            count++;\n            temp = word.charAt(i);\n        }\n        i=k;\n        result += count;\n    }\n\n    return result;\n}\n</code></pre>\n<p>Can anyone help me out with lesser time complexity.....</p>\n"},{"tags":["java","json"],"comments":[{"owner":{"account_id":3915122,"reputation":329,"user_id":3239113,"display_name":"Ralph Rimorin"},"score":0,"creation_date":1459405465,"post_id":36325499,"comment_id":60273891,"body_markdown":"Hi @TDHM, can you check this link? https://groups.google.com/forum/#!topic/vertx/tTmv-US-HMI      , you are removing a data from a fix size array. Can you convert the JsonArray to an ArrayList?","body":"Hi @TDHM, can you check this link? <a href=\"https://groups.google.com/forum/#!topic/vertx/tTmv-US-HMI\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/vertx/tTmv-US-HMI</a>      , you are removing a data from a fix size array. Can you convert the JsonArray to an ArrayList?"},{"owner":{"account_id":3200341,"reputation":12790,"user_id":2702504,"accept_rate":68,"display_name":"Keerthivasan"},"score":0,"creation_date":1459406614,"post_id":36325499,"comment_id":60274464,"body_markdown":"Can you provide the api that you use. i.e Fully qualified name of JSONArray","body":"Can you provide the api that you use. i.e Fully qualified name of JSONArray"}],"answers":[{"comments":[{"owner":{"account_id":1587389,"reputation":13480,"user_id":1471417,"accept_rate":50,"display_name":"Alpha"},"score":0,"creation_date":1459405810,"post_id":36325610,"comment_id":60274071,"body_markdown":"This also gives same error: `java.lang.UnsupportedOperationException`","body":"This also gives same error: <code>java.lang.UnsupportedOperationException</code>"}],"tags":[],"owner":{"account_id":4023887,"reputation":2257,"user_id":3313050,"display_name":"Benjamin"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1459406589,"creation_date":1459405236,"answer_id":36325610,"question_id":36325499,"body_markdown":"May be Your `JsonElement` or `JSONArray` is null.\r\n\r\n`getJsonObject` returns a `JSONObject`.\r\n the remove method want `int`.\r\n\r\n`UnsupportedOperationException`\r\nif removing is not supported.\r\n\r\nTry This :\r\n\r\n    JSONArray fieldsObject =jsonObject.getJsonArray(&quot;fields&quot;);\r\n    fieldsObject.remove(int index);\r\n\r\n\r\nOR\r\n\r\n    JSONArray result = new JSONArray();\r\n    for(int i=0;i&lt;fieldsObject.length();i++)\r\n    {\r\n       if(i!=2)\r\n       {\r\n        result.put(fieldsObject.get(i)); \r\n       }\r\n    }\r\n\r\nand assign result to original one \r\n\r\n    fieldsObject=result;","title":"Remove json object from json array","body":"<p>May be Your <code>JsonElement</code> or <code>JSONArray</code> is null.</p>\n\n<p><code>getJsonObject</code> returns a <code>JSONObject</code>.\n the remove method want <code>int</code>.</p>\n\n<p><code>UnsupportedOperationException</code>\nif removing is not supported.</p>\n\n<p>Try This :</p>\n\n<pre><code>JSONArray fieldsObject =jsonObject.getJsonArray(\"fields\");\nfieldsObject.remove(int index);\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>JSONArray result = new JSONArray();\nfor(int i=0;i&lt;fieldsObject.length();i++)\n{\n   if(i!=2)\n   {\n    result.put(fieldsObject.get(i)); \n   }\n}\n</code></pre>\n\n<p>and assign result to original one </p>\n\n<pre><code>fieldsObject=result;\n</code></pre>\n"},{"comments":[{"owner":{"account_id":1587389,"reputation":13480,"user_id":1471417,"accept_rate":50,"display_name":"Alpha"},"score":0,"creation_date":1460366665,"post_id":36325714,"comment_id":60690311,"body_markdown":"Sanj, I checked it with `org.json` but `remove` method is not available for `JSONArray`. I&#39;m using version `20090211`. Could you please let me know which version of `org.json` you are using?","body":"Sanj, I checked it with <code>org.json</code> but <code>remove</code> method is not available for <code>JSONArray</code>. I&#39;m using version <code>20090211</code>. Could you please let me know which version of <code>org.json</code> you are using?"},{"owner":{"account_id":3542644,"reputation":3919,"user_id":2959331,"display_name":"Sanj"},"score":0,"creation_date":1460392823,"post_id":36325714,"comment_id":60709309,"body_markdown":"I am using version 20160212","body":"I am using version 20160212"}],"tags":[],"owner":{"account_id":3542644,"reputation":3919,"user_id":2959331,"display_name":"Sanj"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1459406933,"creation_date":1459405729,"answer_id":36325714,"question_id":36325499,"body_markdown":"&gt;  - `gson` library\r\n\r\nRemove works for `gson` library version `2.3.1`\r\n\r\n    public static void main(String[] args) throws Exception {\r\n    \r\n    \t\t\r\n\t\tString s = &quot;{ \\&quot;fields\\&quot; : [ &quot;+\r\n\t\t\t\t&quot; {\\&quot;name\\&quot;:\\&quot;First Name\\&quot;,\\&quot;id\\&quot;:1},&quot;+\r\n\t\t\t\t&quot;{\\&quot;name\\&quot;:\\&quot;Middle Name\\&quot;,\\&quot;id\\&quot;:2},&quot;+\r\n\t\t\t\t&quot;{\\&quot;name\\&quot;:\\&quot;Last Name\\&quot;,\\&quot;id\\&quot;:3}&quot;+\r\n\t\t\t\t&quot;]}&quot;;\r\n    \r\n    \t\tJsonParser parser = new JsonParser();\r\n    \t\tJsonObject json = parser.parse(s).getAsJsonObject();\r\n    \t\tSystem.out.println(&quot;original object:&quot;+json);\r\n    \t\tJsonArray fieldsObject = json.getAsJsonArray(&quot;fields&quot;);\r\n    \t\tSystem.out.println(&quot;Before removal :&quot;+fieldsObject);\r\n    \t\tObject remove = fieldsObject.remove(1);\r\n    \t\tSystem.out.println(&quot;After removal :&quot;+fieldsObject);\r\n    \t}\r\n\r\nOutput:\r\n\r\n       original object:{&quot;fields&quot;:[{&quot;name&quot;:&quot;First Name&quot;,&quot;id&quot;:1},{&quot;name&quot;:&quot;Middle Name&quot;,&quot;id&quot;:2},{&quot;name&quot;:&quot;Last Name&quot;,&quot;id&quot;:3}]}\r\n    Before removal :[{&quot;name&quot;:&quot;First Name&quot;,&quot;id&quot;:1},{&quot;name&quot;:&quot;Middle Name&quot;,&quot;id&quot;:2},{&quot;name&quot;:&quot;Last Name&quot;,&quot;id&quot;:3}]\r\n    After removal :[{&quot;name&quot;:&quot;First Name&quot;,&quot;id&quot;:1},{&quot;name&quot;:&quot;Last Name&quot;,&quot;id&quot;:3}]\r\n\r\n&gt;  - `org.json` library\r\n\r\n Remove works for `org.json` library  \r\n\r\n    public static void main(String[] args) throws Exception {\r\n        \r\n        \t\tString s = &quot;{ \\&quot;fields\\&quot; : [ &quot;+\r\n\t\t\t\t&quot; {\\&quot;name\\&quot;:\\&quot;First Name\\&quot;,\\&quot;id\\&quot;:1},&quot;+\r\n\t\t\t\t&quot;{\\&quot;name\\&quot;:\\&quot;Middle Name\\&quot;,\\&quot;id\\&quot;:2},&quot;+\r\n\t\t\t\t&quot;{\\&quot;name\\&quot;:\\&quot;Last Name\\&quot;,\\&quot;id\\&quot;:3}&quot;+\r\n\t\t\t\t&quot;]}&quot;;\r\n        \t\tJSONObject json = new JSONObject(s);\r\n        \t\tSystem.out.println(&quot;original object:&quot;+json);\r\n        \t\tJSONArray fieldsObject =json.getJSONArray(&quot;fields&quot;);\r\n        \t\tSystem.out.println(&quot;Before removal :&quot;+fieldsObject);\r\n        \t\tObject remove = fieldsObject.remove(1);\r\n        \t\tSystem.out.println(&quot;After removal :&quot;+fieldsObject);\r\n        \t}\r\n\r\nOutput:\r\n\r\n    original object:{&quot;fields&quot;:[{&quot;name&quot;:&quot;First Name&quot;,&quot;id&quot;:1},{&quot;name&quot;:&quot;Middle Name&quot;,&quot;id&quot;:2},{&quot;name&quot;:&quot;Last Name&quot;,&quot;id&quot;:3}]}\r\n    Before removal :[{&quot;name&quot;:&quot;First Name&quot;,&quot;id&quot;:1},{&quot;name&quot;:&quot;Middle Name&quot;,&quot;id&quot;:2},{&quot;name&quot;:&quot;Last Name&quot;,&quot;id&quot;:3}]\r\n    After removal :[{&quot;name&quot;:&quot;First Name&quot;,&quot;id&quot;:1},{&quot;name&quot;:&quot;Last Name&quot;,&quot;id&quot;:3}]\r\n\r\n","title":"Remove json object from json array","body":"<blockquote>\n  <ul>\n  <li><code>gson</code> library</li>\n  </ul>\n</blockquote>\n\n<p>Remove works for <code>gson</code> library version <code>2.3.1</code></p>\n\n<pre><code>public static void main(String[] args) throws Exception {\n\n\n    String s = \"{ \\\"fields\\\" : [ \"+\n            \" {\\\"name\\\":\\\"First Name\\\",\\\"id\\\":1},\"+\n            \"{\\\"name\\\":\\\"Middle Name\\\",\\\"id\\\":2},\"+\n            \"{\\\"name\\\":\\\"Last Name\\\",\\\"id\\\":3}\"+\n            \"]}\";\n\n        JsonParser parser = new JsonParser();\n        JsonObject json = parser.parse(s).getAsJsonObject();\n        System.out.println(\"original object:\"+json);\n        JsonArray fieldsObject = json.getAsJsonArray(\"fields\");\n        System.out.println(\"Before removal :\"+fieldsObject);\n        Object remove = fieldsObject.remove(1);\n        System.out.println(\"After removal :\"+fieldsObject);\n    }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>   original object:{\"fields\":[{\"name\":\"First Name\",\"id\":1},{\"name\":\"Middle Name\",\"id\":2},{\"name\":\"Last Name\",\"id\":3}]}\nBefore removal :[{\"name\":\"First Name\",\"id\":1},{\"name\":\"Middle Name\",\"id\":2},{\"name\":\"Last Name\",\"id\":3}]\nAfter removal :[{\"name\":\"First Name\",\"id\":1},{\"name\":\"Last Name\",\"id\":3}]\n</code></pre>\n\n<blockquote>\n  <ul>\n  <li><code>org.json</code> library</li>\n  </ul>\n</blockquote>\n\n<p>Remove works for <code>org.json</code> library  </p>\n\n<pre><code>public static void main(String[] args) throws Exception {\n\n            String s = \"{ \\\"fields\\\" : [ \"+\n            \" {\\\"name\\\":\\\"First Name\\\",\\\"id\\\":1},\"+\n            \"{\\\"name\\\":\\\"Middle Name\\\",\\\"id\\\":2},\"+\n            \"{\\\"name\\\":\\\"Last Name\\\",\\\"id\\\":3}\"+\n            \"]}\";\n            JSONObject json = new JSONObject(s);\n            System.out.println(\"original object:\"+json);\n            JSONArray fieldsObject =json.getJSONArray(\"fields\");\n            System.out.println(\"Before removal :\"+fieldsObject);\n            Object remove = fieldsObject.remove(1);\n            System.out.println(\"After removal :\"+fieldsObject);\n        }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>original object:{\"fields\":[{\"name\":\"First Name\",\"id\":1},{\"name\":\"Middle Name\",\"id\":2},{\"name\":\"Last Name\",\"id\":3}]}\nBefore removal :[{\"name\":\"First Name\",\"id\":1},{\"name\":\"Middle Name\",\"id\":2},{\"name\":\"Last Name\",\"id\":3}]\nAfter removal :[{\"name\":\"First Name\",\"id\":1},{\"name\":\"Last Name\",\"id\":3}]\n</code></pre>\n"},{"tags":[],"owner":{"account_id":439098,"reputation":4236,"user_id":4274119,"accept_rate":83,"display_name":"justAbit"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1459405763,"creation_date":1459405763,"answer_id":36325725,"question_id":36325499,"body_markdown":"You can not remove element from `JsonArray` as it does not support `remove()` method:\r\n\r\n    private static final class JsonArrayImpl extends AbstractList&lt;JsonValue&gt; implements JsonArray {\r\n\r\nAnd `remove()` method&#39;s implementation comes from `AbstractList` :\r\n\r\n    public E remove(int index) {\r\n        throw new UnsupportedOperationException();\r\n    }\r\n\r\nInstead why don&#39;t you create a separate data strucure array or list to hold the objects that you want?\r\n\r\nBy the way, the purpose of using `JsonArray` is to load json data in object form that is why it supports read methods but does not support modifications on the loaded data structure.","title":"Remove json object from json array","body":"<p>You can not remove element from <code>JsonArray</code> as it does not support <code>remove()</code> method:</p>\n\n<pre><code>private static final class JsonArrayImpl extends AbstractList&lt;JsonValue&gt; implements JsonArray {\n</code></pre>\n\n<p>And <code>remove()</code> method's implementation comes from <code>AbstractList</code> :</p>\n\n<pre><code>public E remove(int index) {\n    throw new UnsupportedOperationException();\n}\n</code></pre>\n\n<p>Instead why don't you create a separate data strucure array or list to hold the objects that you want?</p>\n\n<p>By the way, the purpose of using <code>JsonArray</code> is to load json data in object form that is why it supports read methods but does not support modifications on the loaded data structure.</p>\n"},{"tags":[],"owner":{"account_id":3112142,"reputation":474,"user_id":2633702,"display_name":"srinivas"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1459407488,"creation_date":1459407488,"answer_id":36326244,"question_id":36325499,"body_markdown":"I tried using org.json library as mentioned by Sanj in the above post. We can remove the element from JSONArray as below. I placed the json content in the .txt file and read into the String object for constructing the JSONObject. Please refer the code below.\r\n\r\n    public class App{    \r\n\tpublic static void main(String args[]) throws IOException{    \r\n\r\n\t\tBufferedReader br = new BufferedReader(new FileReader(&quot;json.txt&quot;));\r\n\t\tString jsonContent = &quot;&quot;;\r\n\t\tString jsonLine;\r\n\t\twhile((jsonLine=br.readLine())!=null){\r\n\t\t\tjsonContent+=jsonLine;\r\n\t\t}\r\n\t\tJSONObject jObj = new JSONObject(jsonContent);\r\n\t\tJSONArray jsonArray = jObj.getJSONArray(&quot;fields&quot;);\r\n\t\tjsonArray.remove(1);\r\n\t\tSystem.out.println(jsonArray);\r\n\t}\r\n    }","title":"Remove json object from json array","body":"<p>I tried using org.json library as mentioned by Sanj in the above post. We can remove the element from JSONArray as below. I placed the json content in the .txt file and read into the String object for constructing the JSONObject. Please refer the code below.</p>\n\n<pre><code>public class App{    \npublic static void main(String args[]) throws IOException{    \n\n    BufferedReader br = new BufferedReader(new FileReader(\"json.txt\"));\n    String jsonContent = \"\";\n    String jsonLine;\n    while((jsonLine=br.readLine())!=null){\n        jsonContent+=jsonLine;\n    }\n    JSONObject jObj = new JSONObject(jsonContent);\n    JSONArray jsonArray = jObj.getJSONArray(\"fields\");\n    jsonArray.remove(1);\n    System.out.println(jsonArray);\n}\n}\n</code></pre>\n"}],"owner":{"account_id":1587389,"reputation":13480,"user_id":1471417,"accept_rate":50,"display_name":"Alpha"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":14274,"favorite_count":0,"down_vote_count":0,"up_vote_count":5,"answer_count":4,"score":5,"last_activity_date":1694297225,"creation_date":1459404759,"question_id":36325499,"body_markdown":"I&#39;ve a JsonArray like:\r\n\r\n    &quot;fields&quot; : [\r\n    \t{\r\n    \t  &quot;name&quot;:&quot;First Name&quot;,\r\n          &quot;id&quot;:1\r\n    \t},\r\n    \t{\r\n    \t  &quot;name&quot;:&quot;Middle Name&quot;,\r\n          &quot;id&quot;:2\r\n    \t},\r\n    \t{\r\n    \t  &quot;name&quot;:&quot;Last Name&quot;,\r\n          &quot;id&quot;:3\r\n    \t}\r\n    ]\r\n\r\nI want to remove second JsonObject from above JsonArray. In order to do that I&#39; wrote following code:\r\n\r\n    JsonArray fieldsObject =jsonObject.getJsonArray(&quot;fields&quot;);\r\n    fieldsObject.remove(fieldsObject.getJsonObject(2));\r\n\r\nBut second line throws error: `java.lang.UnsupportedOperationException`\r\n\r\nIs there any way, I can remove JsonObject from a JsonArray?","title":"Remove json object from json array","body":"<p>I've a JsonArray like:</p>\n\n<pre><code>\"fields\" : [\n    {\n      \"name\":\"First Name\",\n      \"id\":1\n    },\n    {\n      \"name\":\"Middle Name\",\n      \"id\":2\n    },\n    {\n      \"name\":\"Last Name\",\n      \"id\":3\n    }\n]\n</code></pre>\n\n<p>I want to remove second JsonObject from above JsonArray. In order to do that I' wrote following code:</p>\n\n<pre><code>JsonArray fieldsObject =jsonObject.getJsonArray(\"fields\");\nfieldsObject.remove(fieldsObject.getJsonObject(2));\n</code></pre>\n\n<p>But second line throws error: <code>java.lang.UnsupportedOperationException</code></p>\n\n<p>Is there any way, I can remove JsonObject from a JsonArray?</p>\n"},{"tags":["java","jakarta-ee","glassfish","derby","payara"],"answers":[{"tags":[],"owner":{"account_id":411863,"reputation":7400,"user_id":784594,"display_name":"OndroMih"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694296508,"creation_date":1694296508,"answer_id":77074160,"question_id":76956116,"body_markdown":"Payara doesn’t include Derby driver. You need to add Derby DB JARs into Payara, for example into the lib directory in the domain directory.\r\n\r\nIf you did it, try setting the following parameters to the connection pool:\r\n\r\n\r\nResource type: javax.sql.DataSource\r\n\r\nDatasource classname: org.apache.derby.jdbc.ClientDataSource\r\n\r\nYou can also try Eclipse GlassFish 7, which includes Derby DB, and even uses it for the default connection pool. You can copy the configuration from GlassFish to Payara, as long as you have the correct Derby JARs to Payara too.","title":"Unable to create Derby connection pool in Payara-6 server","body":"<p>Payara doesn’t include Derby driver. You need to add Derby DB JARs into Payara, for example into the lib directory in the domain directory.</p>\n<p>If you did it, try setting the following parameters to the connection pool:</p>\n<p>Resource type: javax.sql.DataSource</p>\n<p>Datasource classname: org.apache.derby.jdbc.ClientDataSource</p>\n<p>You can also try Eclipse GlassFish 7, which includes Derby DB, and even uses it for the default connection pool. You can copy the configuration from GlassFish to Payara, as long as you have the correct Derby JARs to Payara too.</p>\n"}],"owner":{"account_id":4157818,"reputation":1427,"user_id":4233030,"accept_rate":62,"display_name":"Python_user"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":57,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1694296508,"creation_date":1692729980,"question_id":76956116,"body_markdown":"I am trying to create a Derby connection pool in Payara-6 server. I tried creating it twice: once with vendor &quot;Derby&quot; and once with &quot;Derby-30&quot; (not sure about the differences). These were the following values that I set:\r\n\r\n    Resource Type: java.sql.Driver\r\n    Datasource Classname: &lt;empty&gt;\r\n    Driver classname: org.apache.derby.jdbc.ClientDriver\r\n\r\nI have also set the URL, user, &amp; password for the DB. But, when I try to ping the DB&lt; I get the following error:\r\n[![enter image description here][1]][1]\r\n\r\nI do have the derby jars locally in my machine, but I do not believe that the same is available to the payara server. Please help in debugging the same.\r\n\r\n  [1]: https://i.stack.imgur.com/OQo3Q.png","title":"Unable to create Derby connection pool in Payara-6 server","body":"<p>I am trying to create a Derby connection pool in Payara-6 server. I tried creating it twice: once with vendor &quot;Derby&quot; and once with &quot;Derby-30&quot; (not sure about the differences). These were the following values that I set:</p>\n<pre><code>Resource Type: java.sql.Driver\nDatasource Classname: &lt;empty&gt;\nDriver classname: org.apache.derby.jdbc.ClientDriver\n</code></pre>\n<p>I have also set the URL, user, &amp; password for the DB. But, when I try to ping the DB&lt; I get the following error:\n<a href=\"https://i.stack.imgur.com/OQo3Q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OQo3Q.png\" alt=\"enter image description here\" /></a></p>\n<p>I do have the derby jars locally in my machine, but I do not believe that the same is available to the payara server. Please help in debugging the same.</p>\n"},{"tags":["java","spring","spring-security"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1670222704,"post_id":74673260,"comment_id":131817191,"body_markdown":"That was deprecated in Spring Security 5.6 and removed in Spring Security 6, hence not available anymore. Check the documentation. Also (unrelated) your dependencies are a bit of a mess, clean them up. You are also using some wrong dependencies (thymeleaf spring scurity 5 should be for security 6).","body":"That was deprecated in Spring Security 5.6 and removed in Spring Security 6, hence not available anymore. Check the documentation. Also (unrelated) your dependencies are a bit of a mess, clean them up. You are also using some wrong dependencies (thymeleaf spring scurity 5 should be for security 6)."}],"answers":[{"tags":[],"owner":{"account_id":308139,"reputation":8199,"user_id":619830,"accept_rate":75,"display_name":"ch4mp"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1694296082,"creation_date":1670134698,"answer_id":74673292,"question_id":74673260,"body_markdown":"WebsecurityConfigurerAdapter was removed in Spring-boot 3.\r\n\r\nExpose a `SecurityFilterChain` bean instead (`SecurityWebFilterChain` if your app is reactive).\r\n\r\nOpen [the manual][1] or have look at [those tutorials][2]. \r\n\r\n\r\n  [1]: https://docs.spring.io/spring-security/reference/migration/index.html\r\n  [2]: https://github.com/ch4mpy/spring-addons/tree/master/samples/tutorials","title":"Spring doesn&#39;t see WebSecurityConfigurerAdapter","body":"<p>WebsecurityConfigurerAdapter was removed in Spring-boot 3.</p>\n<p>Expose a <code>SecurityFilterChain</code> bean instead (<code>SecurityWebFilterChain</code> if your app is reactive).</p>\n<p>Open <a href=\"https://docs.spring.io/spring-security/reference/migration/index.html\" rel=\"nofollow noreferrer\">the manual</a> or have look at <a href=\"https://github.com/ch4mpy/spring-addons/tree/master/samples/tutorials\" rel=\"nofollow noreferrer\">those tutorials</a>.</p>\n"},{"tags":[],"owner":{"account_id":20853579,"reputation":338,"user_id":16436722,"display_name":"стасевич"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1670150559,"creation_date":1670147929,"answer_id":74674453,"question_id":74673260,"body_markdown":"Video from Dan Vega:\r\n\r\n[What&#39;s new in Spring Security 6][1]\r\n\r\n\r\nSpring Security: Upgrading the Deprecated `WebSecurityConfigurerAdapter`  \r\nConfigure HTTP Security\r\nMore importantly, if we want to avoid deprecation for HTTP security, we can create a `SecurityFilterChain` bean.\r\n\r\nFor example, suppose we want to secure the endpoints depending on the roles, and leave an anonymous entry point only for login. We&#39;ll also restrict any delete request to an admin role. We&#39;ll use Basic Authentication:\r\n\r\n    @Bean\r\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\r\n        http.csrf()\r\n          .disable()\r\n          .authorizeRequests()\r\n          .antMatchers(HttpMethod.DELETE)\r\n          .hasRole(&quot;ADMIN&quot;)\r\n          .antMatchers(&quot;/admin/**&quot;)\r\n          .hasAnyRole(&quot;ADMIN&quot;)\r\n          .antMatchers(&quot;/user/**&quot;)\r\n          .hasAnyRole(&quot;USER&quot;, &quot;ADMIN&quot;)\r\n          .antMatchers(&quot;/login/**&quot;)\r\n          .anonymous()\r\n          .anyRequest()\r\n          .authenticated()\r\n          .and()\r\n          .httpBasic()\r\n          .and()\r\n          .sessionManagement()\r\n          .sessionCreationPolicy(SessionCreationPolicy.STATELESS);\r\n    \r\n        return http.build();\r\n    }\r\n\r\nThe HTTP security will build a `DefaultSecurityFilterChain` object to load request matchers and filters.  \r\n[spring Security: Upgrading the Deprecated WebSecurityConfigurerAdapter][2]\r\n\r\n\r\n  [1]: https://www.youtube.com/watch?v=TDOHbK39Oxg&amp;list=PLYjyDlouoSEfFogsLh2Y-9KLzJ1xCq078&amp;index=13\r\n  [2]: https://www.baeldung.com/spring-deprecated-websecurityconfigureradapter","title":"Spring doesn&#39;t see WebSecurityConfigurerAdapter","body":"<p>Video from Dan Vega:</p>\n<p><a href=\"https://www.youtube.com/watch?v=TDOHbK39Oxg&amp;list=PLYjyDlouoSEfFogsLh2Y-9KLzJ1xCq078&amp;index=13\" rel=\"nofollow noreferrer\">What's new in Spring Security 6</a></p>\n<p>Spring Security: Upgrading the Deprecated <code>WebSecurityConfigurerAdapter</code><br />\nConfigure HTTP Security\nMore importantly, if we want to avoid deprecation for HTTP security, we can create a <code>SecurityFilterChain</code> bean.</p>\n<p>For example, suppose we want to secure the endpoints depending on the roles, and leave an anonymous entry point only for login. We'll also restrict any delete request to an admin role. We'll use Basic Authentication:</p>\n<pre><code>@Bean\npublic SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n    http.csrf()\n      .disable()\n      .authorizeRequests()\n      .antMatchers(HttpMethod.DELETE)\n      .hasRole(&quot;ADMIN&quot;)\n      .antMatchers(&quot;/admin/**&quot;)\n      .hasAnyRole(&quot;ADMIN&quot;)\n      .antMatchers(&quot;/user/**&quot;)\n      .hasAnyRole(&quot;USER&quot;, &quot;ADMIN&quot;)\n      .antMatchers(&quot;/login/**&quot;)\n      .anonymous()\n      .anyRequest()\n      .authenticated()\n      .and()\n      .httpBasic()\n      .and()\n      .sessionManagement()\n      .sessionCreationPolicy(SessionCreationPolicy.STATELESS);\n\n    return http.build();\n}\n</code></pre>\n<p>The HTTP security will build a <code>DefaultSecurityFilterChain</code> object to load request matchers and filters.<br />\n<a href=\"https://www.baeldung.com/spring-deprecated-websecurityconfigureradapter\" rel=\"nofollow noreferrer\">spring Security: Upgrading the Deprecated WebSecurityConfigurerAdapter</a></p>\n"}],"owner":{"account_id":23545307,"reputation":33,"user_id":17588867,"display_name":"AllodyUser "},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":9257,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":74674453,"answer_count":2,"score":3,"last_activity_date":1694296082,"creation_date":1670134160,"question_id":74673260,"body_markdown":"I want to create WebSecurityConfig class that extends WebSecurityConfigurerAdapter, but I always get error &quot;Cannot resolve symbol &#39;WebSecurityConfigurerAdapter&#39;&quot;.\r\nI have already tried to add different dependencies. It&#39;s my gradle file\r\n```\r\ndependencies {\r\n    runtimeOnly &#39;org.postgresql:postgresql&#39;\r\n    implementation group: &#39;org.postgresql&#39;, name: &#39;postgresql&#39;, version: &#39;42.5.1&#39;\r\n    implementation group: &#39;org.springframework.boot&#39;, name: &#39;spring-boot-starter-data-jpa&#39;, version: &#39;3.0.0&#39;\r\n    implementation group: &#39;org.springframework.boot&#39;, name: &#39;spring-boot-starter-data-rest&#39;, version: &#39;3.0.0&#39;\r\n    implementation group: &#39;org.springframework.boot&#39;, name: &#39;spring-boot-starter-tomcat&#39;, version: &#39;3.0.0&#39;\r\n    implementation group: &#39;org.springframework.boot&#39;, name: &#39;spring-boot-starter-web&#39;, version: &#39;3.0.0&#39;\r\n    implementation group: &#39;io.jsonwebtoken&#39;, name: &#39;jjwt-api&#39;, version: &#39;0.11.5&#39;\r\n    implementation group: &#39;org.postgresql&#39;, name: &#39;postgresql&#39;, version: &#39;42.5.1&#39;\r\n    implementation group: &#39;org.springframework.boot&#39;, name: &#39;spring-boot-starter-validation&#39;, version: &#39;3.0.0&#39;\r\n    implementation group: &#39;org.springframework.security&#39;, name: &#39;spring-security-core&#39;, version: &#39;6.0.0&#39;\r\n    implementation group: &#39;org.springframework.security&#39;, name: &#39;spring-security-config&#39;, version: &#39;6.0.0&#39;\r\n    implementation group: &#39;org.springframework.security&#39;, name: &#39;spring-security-web&#39;, version: &#39;6.0.0&#39;\r\n    implementation group: &#39;org.springframework.security&#39;, name: &#39;spring-security-oauth2-jose&#39;, version: &#39;6.0.0&#39;\r\n    implementation group: &#39;org.springframework.security&#39;, name: &#39;spring-security-oauth2-resource-server&#39;, version: &#39;6.0.0&#39;\r\n    implementation group: &#39;org.springframework.boot&#39;, name: &#39;spring-boot-starter-security&#39;, version: &#39;3.0.0&#39;\r\n    implementation group: &#39;org.springframework.boot&#39;, name: &#39;spring-boot-starter-thymeleaf&#39;, version: &#39;3.0.0&#39;\r\n    implementation group: &#39;org.thymeleaf.extras&#39;, name: &#39;thymeleaf-extras-springsecurity5&#39;, version: &#39;3.1.0.RELEASE&#39;\r\n}\r\n```\r\nMaybe I don&#39;t understand something easy. Can you help me with this,please. \r\nI have already spent 2 days on this\r\n\r\nThere is the same question on stack overflow (https://stackoverflow.com/questions/54177651/cannot-resolve-symbol-websecurityconfigureradapter), but it doesn&#39;t help me.\r\nIt&#39;s my file with WebSecurityConfig class\r\n\r\n```\r\nimport nsu.project.springserver.security.jwt.AuthEntryPointJwt;\r\nimport nsu.project.springserver.security.jwt.AuthTokenFilter;\r\nimport nsu.project.springserver.security.services.UserDetailsServiceImpl;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.security.authentication.AuthenticationManager;\r\nimport org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;\r\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\r\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\r\nimport org.springframework.security.config.http.SessionCreationPolicy;\r\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\r\nimport org.springframework.security.crypto.password.PasswordEncoder;\r\nimport org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;\r\n\r\n@Configuration\r\n@EnableWebSecurity\r\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\r\n....\r\n}\r\n```","title":"Spring doesn&#39;t see WebSecurityConfigurerAdapter","body":"<p>I want to create WebSecurityConfig class that extends WebSecurityConfigurerAdapter, but I always get error &quot;Cannot resolve symbol 'WebSecurityConfigurerAdapter'&quot;.\nI have already tried to add different dependencies. It's my gradle file</p>\n<pre><code>dependencies {\n    runtimeOnly 'org.postgresql:postgresql'\n    implementation group: 'org.postgresql', name: 'postgresql', version: '42.5.1'\n    implementation group: 'org.springframework.boot', name: 'spring-boot-starter-data-jpa', version: '3.0.0'\n    implementation group: 'org.springframework.boot', name: 'spring-boot-starter-data-rest', version: '3.0.0'\n    implementation group: 'org.springframework.boot', name: 'spring-boot-starter-tomcat', version: '3.0.0'\n    implementation group: 'org.springframework.boot', name: 'spring-boot-starter-web', version: '3.0.0'\n    implementation group: 'io.jsonwebtoken', name: 'jjwt-api', version: '0.11.5'\n    implementation group: 'org.postgresql', name: 'postgresql', version: '42.5.1'\n    implementation group: 'org.springframework.boot', name: 'spring-boot-starter-validation', version: '3.0.0'\n    implementation group: 'org.springframework.security', name: 'spring-security-core', version: '6.0.0'\n    implementation group: 'org.springframework.security', name: 'spring-security-config', version: '6.0.0'\n    implementation group: 'org.springframework.security', name: 'spring-security-web', version: '6.0.0'\n    implementation group: 'org.springframework.security', name: 'spring-security-oauth2-jose', version: '6.0.0'\n    implementation group: 'org.springframework.security', name: 'spring-security-oauth2-resource-server', version: '6.0.0'\n    implementation group: 'org.springframework.boot', name: 'spring-boot-starter-security', version: '3.0.0'\n    implementation group: 'org.springframework.boot', name: 'spring-boot-starter-thymeleaf', version: '3.0.0'\n    implementation group: 'org.thymeleaf.extras', name: 'thymeleaf-extras-springsecurity5', version: '3.1.0.RELEASE'\n}\n</code></pre>\n<p>Maybe I don't understand something easy. Can you help me with this,please.\nI have already spent 2 days on this</p>\n<p>There is the same question on stack overflow (<a href=\"https://stackoverflow.com/questions/54177651/cannot-resolve-symbol-websecurityconfigureradapter\">Cannot resolve symbol WebSecurityConfigurerAdapter</a>), but it doesn't help me.\nIt's my file with WebSecurityConfig class</p>\n<pre><code>import nsu.project.springserver.security.jwt.AuthEntryPointJwt;\nimport nsu.project.springserver.security.jwt.AuthTokenFilter;\nimport nsu.project.springserver.security.services.UserDetailsServiceImpl;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.authentication.AuthenticationManager;\nimport org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.http.SessionCreationPolicy;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;\n\n@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n....\n}\n</code></pre>\n"},{"tags":["java","encryption","rsa","padding","public-key-encryption"],"comments":[{"owner":{"account_id":2033317,"reputation":61286,"user_id":1816580,"display_name":"Artjom B."},"score":0,"creation_date":1464026224,"post_id":37396855,"comment_id":62303610,"body_markdown":"There are a lot of examples out there. What&#39;s the problem you&#39;re having? Don&#39;t forget to encode the ciphertext with base64 or hex if you want to have it in a string.","body":"There are a lot of examples out there. What&#39;s the problem you&#39;re having? Don&#39;t forget to encode the ciphertext with base64 or hex if you want to have it in a string."},{"owner":{"account_id":203680,"reputation":112068,"user_id":451475,"accept_rate":100,"display_name":"zaph"},"score":0,"creation_date":1464029913,"post_id":37396855,"comment_id":62305552,"body_markdown":"The results will be essentially random byte and not all such bytes are a valid UTF-8 encoding. If you need UTF-8 you need to use an encoding on the random output, Base64 and Hexadecimal are commonly used.","body":"The results will be essentially random byte and not all such bytes are a valid UTF-8 encoding. If you need UTF-8 you need to use an encoding on the random output, Base64 and Hexadecimal are commonly used."}],"answers":[{"comments":[{"owner":{"account_id":8464744,"reputation":43,"user_id":6349207,"accept_rate":60,"display_name":"Marzo"},"score":0,"creation_date":1464028165,"post_id":37397545,"comment_id":62304639,"body_markdown":"My problem is that I don t want to generate a key. My public key is in this form :  lyoXmyo7ZcnVZnI7rZcw5....  how can I use this public key in this form ?","body":"My problem is that I don t want to generate a key. My public key is in this form :  lyoXmyo7ZcnVZnI7rZcw5....  how can I use this public key in this form ?"},{"owner":{"account_id":2033317,"reputation":61286,"user_id":1816580,"display_name":"Artjom B."},"score":1,"creation_date":1464029706,"post_id":37397545,"comment_id":62305449,"body_markdown":"@Marzo You&#39;ll first have to figure out what find of format this public key is in. Ask the people you&#39;ve got this from and if they don&#39;t know, ask for the code that generated it. You should be able to go from there.","body":"@Marzo You&#39;ll first have to figure out what find of format this public key is in. Ask the people you&#39;ve got this from and if they don&#39;t know, ask for the code that generated it. You should be able to go from there."},{"owner":{"account_id":8464744,"reputation":43,"user_id":6349207,"accept_rate":60,"display_name":"Marzo"},"score":1,"creation_date":1464030218,"post_id":37397545,"comment_id":62305731,"body_markdown":"I have the modulus and the exponent of the key but i cannot initialize my key from my java code","body":"I have the modulus and the exponent of the key but i cannot initialize my key from my java code"},{"owner":{"account_id":2033317,"reputation":61286,"user_id":1816580,"display_name":"Artjom B."},"score":0,"creation_date":1464031056,"post_id":37397545,"comment_id":62306201,"body_markdown":"@Marzo In that case: https://docs.oracle.com/javase/8/docs/api/index.html?java/security/spec/RSAPublicKeySpec.html","body":"@Marzo In that case: <a href=\"https://docs.oracle.com/javase/8/docs/api/index.html?java/security/spec/RSAPublicKeySpec.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/8/docs/api/index.html?java/security/s&zwnj;&#8203;pec/&hellip;</a>"},{"owner":{"account_id":8464744,"reputation":43,"user_id":6349207,"accept_rate":60,"display_name":"Marzo"},"score":0,"creation_date":1464034451,"post_id":37397545,"comment_id":62308028,"body_markdown":"@venture I can t understand the line PKCS1EncodedKeySpec(res)  what is res ?","body":"@venture I can t understand the line PKCS1EncodedKeySpec(res)  what is res ?"},{"owner":{"account_id":8464744,"reputation":43,"user_id":6349207,"accept_rate":60,"display_name":"Marzo"},"score":0,"creation_date":1464035494,"post_id":37397545,"comment_id":62308591,"body_markdown":"@venture sorry but PKCS1EncodedKeySpec is undefined as a type for me .. !","body":"@venture sorry but PKCS1EncodedKeySpec is undefined as a type for me .. !"},{"owner":{"account_id":6644784,"reputation":79,"user_id":5129339,"display_name":"venture"},"score":0,"creation_date":1464036669,"post_id":37397545,"comment_id":62309241,"body_markdown":"@Marzo Apologies, I didn&#39;t notice you were using PKCS1 rather than PKCS8. You&#39;ll need to use bouncy castle to convert your key into a useable RSA key. http://stackoverflow.com/questions/7611383/generating-rsa-keys-in-pkcs1-format-in-java","body":"@Marzo Apologies, I didn&#39;t notice you were using PKCS1 rather than PKCS8. You&#39;ll need to use bouncy castle to convert your key into a useable RSA key. <a href=\"http://stackoverflow.com/questions/7611383/generating-rsa-keys-in-pkcs1-format-in-java\" title=\"generating rsa keys in pkcs1 format in java\">stackoverflow.com/questions/7611383/&hellip;</a>"},{"owner":{"account_id":8464744,"reputation":43,"user_id":6349207,"accept_rate":60,"display_name":"Marzo"},"score":0,"creation_date":1464042098,"post_id":37397545,"comment_id":62311543,"body_markdown":"@venture please look at the code in the second answer","body":"@venture please look at the code in the second answer"},{"owner":{"account_id":2165380,"reputation":699,"user_id":1918607,"accept_rate":75,"display_name":"Dante"},"score":0,"creation_date":1554988455,"post_id":37397545,"comment_id":97957893,"body_markdown":"it throws an error &quot;Invalid DER: object is not integer&quot;","body":"it throws an error &quot;Invalid DER: object is not integer&quot;"}],"tags":[],"owner":{"account_id":6644784,"reputation":79,"user_id":5129339,"display_name":"venture"},"comment_count":9,"down_vote_count":2,"up_vote_count":0,"is_accepted":true,"score":-2,"last_activity_date":1464036731,"creation_date":1464026335,"answer_id":37397545,"question_id":37396855,"body_markdown":"Assuming you&#39;re using a valid RSA key, you&#39;ll need to:\r\n\r\n1. Convert your public key from a string to an actual public key object\r\n        \r\n        //This code is incorrect. You&#39;ll need bouncy castle for PKCS1\r\n        KeyFactory keyFactory = KeyFactory.getInstance(&quot;RSA&quot;);\r\n        byte[] keyBytes = Base64().getDecoder.decode(publicKey.getBytes()); //assuming base64 encoded key\r\n        PKCS1EncodedKeySpec KeySpec = new PKCS1EncodedKeySpec(keyBytes);\r\n        RSAPublicKey publicKey = (RSAPublicKey)keyFactory.generatePublic(KeySpec);\r\n\r\n2. Get the bytes of your plain text\r\n3. Encrypt using your public key\r\n4. Encode to a readable format. \r\n\r\nCheck out this answer for steps 1-3: [RSA Encrypt/Decrypt in Java][1]. Remember to use the correct algorithm spec, in your case PKCS1\r\n\r\nChances are your cipher text will not use only UTF-8 characters so you&#39;ll probably want to use Base 64 encoded text to display your cipher text. Base 64 is able to display all those wonky characters as ascii values.\r\n\r\nSimply use: `Base64.getEncoder().encodeToString(cipherTextBytes)`\r\n\r\n  [1]: https://stackoverflow.com/a/23795194/5129339","title":"How to encode a text with rsa/ecb/pkcs1 padding mode with a given public key in java?","body":"<p>Assuming you're using a valid RSA key, you'll need to:</p>\n\n<ol>\n<li><p>Convert your public key from a string to an actual public key object</p>\n\n<pre><code>//This code is incorrect. You'll need bouncy castle for PKCS1\nKeyFactory keyFactory = KeyFactory.getInstance(\"RSA\");\nbyte[] keyBytes = Base64().getDecoder.decode(publicKey.getBytes()); //assuming base64 encoded key\nPKCS1EncodedKeySpec KeySpec = new PKCS1EncodedKeySpec(keyBytes);\nRSAPublicKey publicKey = (RSAPublicKey)keyFactory.generatePublic(KeySpec);\n</code></pre></li>\n<li><p>Get the bytes of your plain text</p></li>\n<li>Encrypt using your public key</li>\n<li>Encode to a readable format. </li>\n</ol>\n\n<p>Check out this answer for steps 1-3: <a href=\"https://stackoverflow.com/a/23795194/5129339\">RSA Encrypt/Decrypt in Java</a>. Remember to use the correct algorithm spec, in your case PKCS1</p>\n\n<p>Chances are your cipher text will not use only UTF-8 characters so you'll probably want to use Base 64 encoded text to display your cipher text. Base 64 is able to display all those wonky characters as ascii values.</p>\n\n<p>Simply use: <code>Base64.getEncoder().encodeToString(cipherTextBytes)</code></p>\n"},{"tags":[],"owner":{"account_id":8464744,"reputation":43,"user_id":6349207,"accept_rate":60,"display_name":"Marzo"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1464041975,"creation_date":1464041975,"answer_id":37401465,"question_id":37396855,"body_markdown":"i have done this code: \r\n\r\n            String pub = &quot;MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4IJZLsjlx+o4RSvafaAcReoNnzrI0UXu7kZyXPe31ql32X9AvhC6QQIUmLkr1Evm0zP/SgVG9YX3DSqBUgPo04iv1I1/wNKwAf1/uH9EiiqdpczefyxxnzJiKUTcx2/4mA4E4QxCIL5JsZb78WoYZrd2kToW/WD01MnSFiCgSyjGdd812GY2EVzfvlv8kYuti3icMUyitEfHhtw8cAWI6/nVrRPNs0e5NsvtZJ0nfrXsfQDR0C7+ivQK+fQabi8oRGsbTZceAvVlqVE669zoIwIFLcB+eYXTxbka4E7veUMpaF9w//HdwVS2y/2jJiI+16qPStQQPIKQ4Cucoif7/UHfIBuVGVJ5MIVyK7NC7TV/lyoXmyo7ZcnVZnI7rZcw5/qZcqaZ0VCrzvHijwTK7100hOOjiarvRa2OJGXHLIeAUlbrHOXEXS6ah2glPhLDEg6Qzp/lKVSISolal7q73qyhF483P9jXn3hefSLA9J1/1LgeajWvuVkxuw+dy2Tlv7oUpNBkX47/TOho5qttr1y9K3hD5Q87RAJPdBtFdDbY8qUPxoiBsTbUWjVoEjJf2YAsLTJIIi2ZISkbD/VdrtZnS73QSJkJReOMNT9XYNGDJvwNIrRcNGFKlJcX6qq+ozGNsDkrt0ObxAD7YCTjAYQVTlbQOaTu5DbGxGDNCoMCAwEAAQ==&quot;;\r\n\t    \t \r\n\t    \tKeyFactory keyFactory = KeyFactory.getInstance(&quot;RSA&quot;);\r\n\t    \tbyte[] keyBytes = Base64.getDecoder().decode(pub.getBytes(&quot;UTF-8&quot;));  \r\n\t    \tPKCS1EncodedKeySpec KeySpec = new PKCS1EncodedKeySpec(keyBytes);\r\n\t    \tRSAPublicKey publicKey = (RSAPublicKey)keyFactory.generatePublic((java.security.spec.KeySpec) KeySpec);\r\n\t    \t\r\n\t    \tCipher cipher = Cipher.getInstance(&quot;RSA/ECB/PKCS1Padding&quot;);\r\n\t    \tcipher.init(Cipher.ENCRYPT_MODE, publicKey);\r\n             \r\n\t    \tbyte[] cipherData = cipher.doFinal(text.getBytes(&quot;UTF-8&quot;));\r\n\t    \t\r\n\t    \t\r\n\t        return cipherData;\r\n\r\n\r\nBut it doesnot work.. \r\nit is said that Invalid DER: object is not integer","title":"How to encode a text with rsa/ecb/pkcs1 padding mode with a given public key in java?","body":"<p>i have done this code: </p>\n\n<pre><code>        String pub = \"MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4IJZLsjlx+o4RSvafaAcReoNnzrI0UXu7kZyXPe31ql32X9AvhC6QQIUmLkr1Evm0zP/SgVG9YX3DSqBUgPo04iv1I1/wNKwAf1/uH9EiiqdpczefyxxnzJiKUTcx2/4mA4E4QxCIL5JsZb78WoYZrd2kToW/WD01MnSFiCgSyjGdd812GY2EVzfvlv8kYuti3icMUyitEfHhtw8cAWI6/nVrRPNs0e5NsvtZJ0nfrXsfQDR0C7+ivQK+fQabi8oRGsbTZceAvVlqVE669zoIwIFLcB+eYXTxbka4E7veUMpaF9w//HdwVS2y/2jJiI+16qPStQQPIKQ4Cucoif7/UHfIBuVGVJ5MIVyK7NC7TV/lyoXmyo7ZcnVZnI7rZcw5/qZcqaZ0VCrzvHijwTK7100hOOjiarvRa2OJGXHLIeAUlbrHOXEXS6ah2glPhLDEg6Qzp/lKVSISolal7q73qyhF483P9jXn3hefSLA9J1/1LgeajWvuVkxuw+dy2Tlv7oUpNBkX47/TOho5qttr1y9K3hD5Q87RAJPdBtFdDbY8qUPxoiBsTbUWjVoEjJf2YAsLTJIIi2ZISkbD/VdrtZnS73QSJkJReOMNT9XYNGDJvwNIrRcNGFKlJcX6qq+ozGNsDkrt0ObxAD7YCTjAYQVTlbQOaTu5DbGxGDNCoMCAwEAAQ==\";\n\n        KeyFactory keyFactory = KeyFactory.getInstance(\"RSA\");\n        byte[] keyBytes = Base64.getDecoder().decode(pub.getBytes(\"UTF-8\"));  \n        PKCS1EncodedKeySpec KeySpec = new PKCS1EncodedKeySpec(keyBytes);\n        RSAPublicKey publicKey = (RSAPublicKey)keyFactory.generatePublic((java.security.spec.KeySpec) KeySpec);\n\n        Cipher cipher = Cipher.getInstance(\"RSA/ECB/PKCS1Padding\");\n        cipher.init(Cipher.ENCRYPT_MODE, publicKey);\n\n        byte[] cipherData = cipher.doFinal(text.getBytes(\"UTF-8\"));\n\n\n        return cipherData;\n</code></pre>\n\n<p>But it doesnot work.. \nit is said that Invalid DER: object is not integer</p>\n"},{"comments":[{"owner":{"account_id":11125108,"reputation":5965,"user_id":8166854,"display_name":"Michael Fehr"},"score":0,"creation_date":1694345226,"post_id":77074145,"comment_id":135876505,"body_markdown":"Never use getBytes() without defining a charset like &quot;UTF-8&quot; to prevent any errors when the (system&#39;s) default charsets differ.","body":"Never use getBytes() without defining a charset like &quot;UTF-8&quot; to prevent any errors when the (system&#39;s) default charsets differ."}],"tags":[],"owner":{"account_id":14622806,"reputation":55,"user_id":10560942,"display_name":"Shubhankar Kumar"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694295913,"creation_date":1694295913,"answer_id":77074145,"question_id":37396855,"body_markdown":"For someone still looking for a solution:\r\n\r\n````\r\nString pub = &quot;MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4IJZLsjlx+o4RSvafaAcReoNnzrI0UXu7kZyXPe31ql32X9AvhC6QQIUmLkr1Evm0zP/SgVG9YX3DSqBUgPo04iv1I1/wNKwAf1/uH9EiiqdpczefyxxnzJiKUTcx2/4mA4E4QxCIL5JsZb78WoYZrd2kToW/WD01MnSFiCgSyjGdd812GY2EVzfvlv8kYuti3icMUyitEfHhtw8cAWI6/nVrRPNs0e5NsvtZJ0nfrXsfQDR0C7+ivQK+fQabi8oRGsbTZceAvVlqVE669zoIwIFLcB+eYXTxbka4E7veUMpaF9w//HdwVS2y/2jJiI+16qPStQQPIKQ4Cucoif7/UHfIBuVGVJ5MIVyK7NC7TV/lyoXmyo7ZcnVZnI7rZcw5/qZcqaZ0VCrzvHijwTK7100hOOjiarvRa2OJGXHLIeAUlbrHOXEXS6ah2glPhLDEg6Qzp/lKVSISolal7q73qyhF483P9jXn3hefSLA9J1/1LgeajWvuVkxuw+dy2Tlv7oUpNBkX47/TOho5qttr1y9K3hD5Q87RAJPdBtFdDbY8qUPxoiBsTbUWjVoEjJf2YAsLTJIIi2ZISkbD/VdrtZnS73QSJkJReOMNT9XYNGDJvwNIrRcNGFKlJcX6qq+ozGNsDkrt0ObxAD7YCTjAYQVTlbQOaTu5DbGxGDNCoMCAwEAAQ==&quot;;\r\nCipher cipher= Cipher.getInstance(&quot;RSA&quot;);\r\nKeyFactory kf = KeyFactory.getInstance(&quot;RSA&quot;);\r\nX509EncodedKeySpec keySpec = new X509EncodedKeySpec(Base64.getDecoder().decode(publicKey));\r\nPublicKey pb = kf.generatePublic(keySpec);\r\ncipher.init(Cipher.ENCRYPT_MODE,pb);\r\nbyte[] output = cipher.doFinal(input.getBytes());\r\n````\r\n","title":"How to encode a text with rsa/ecb/pkcs1 padding mode with a given public key in java?","body":"<p>For someone still looking for a solution:</p>\n<pre><code>String pub = &quot;MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4IJZLsjlx+o4RSvafaAcReoNnzrI0UXu7kZyXPe31ql32X9AvhC6QQIUmLkr1Evm0zP/SgVG9YX3DSqBUgPo04iv1I1/wNKwAf1/uH9EiiqdpczefyxxnzJiKUTcx2/4mA4E4QxCIL5JsZb78WoYZrd2kToW/WD01MnSFiCgSyjGdd812GY2EVzfvlv8kYuti3icMUyitEfHhtw8cAWI6/nVrRPNs0e5NsvtZJ0nfrXsfQDR0C7+ivQK+fQabi8oRGsbTZceAvVlqVE669zoIwIFLcB+eYXTxbka4E7veUMpaF9w//HdwVS2y/2jJiI+16qPStQQPIKQ4Cucoif7/UHfIBuVGVJ5MIVyK7NC7TV/lyoXmyo7ZcnVZnI7rZcw5/qZcqaZ0VCrzvHijwTK7100hOOjiarvRa2OJGXHLIeAUlbrHOXEXS6ah2glPhLDEg6Qzp/lKVSISolal7q73qyhF483P9jXn3hefSLA9J1/1LgeajWvuVkxuw+dy2Tlv7oUpNBkX47/TOho5qttr1y9K3hD5Q87RAJPdBtFdDbY8qUPxoiBsTbUWjVoEjJf2YAsLTJIIi2ZISkbD/VdrtZnS73QSJkJReOMNT9XYNGDJvwNIrRcNGFKlJcX6qq+ozGNsDkrt0ObxAD7YCTjAYQVTlbQOaTu5DbGxGDNCoMCAwEAAQ==&quot;;\nCipher cipher= Cipher.getInstance(&quot;RSA&quot;);\nKeyFactory kf = KeyFactory.getInstance(&quot;RSA&quot;);\nX509EncodedKeySpec keySpec = new X509EncodedKeySpec(Base64.getDecoder().decode(publicKey));\nPublicKey pb = kf.generatePublic(keySpec);\ncipher.init(Cipher.ENCRYPT_MODE,pb);\nbyte[] output = cipher.doFinal(input.getBytes());\n</code></pre>\n"}],"owner":{"account_id":8464744,"reputation":43,"user_id":6349207,"accept_rate":60,"display_name":"Marzo"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":14037,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":37397545,"answer_count":3,"score":1,"last_activity_date":1694295913,"creation_date":1464023678,"question_id":37396855,"body_markdown":"I want to encode a string with rsa/ecb/pkcs1 padding mode with a given public key (the public key is a string) in java.\r\n\r\nI also want to present the results in UTF-8 Format \r\nhow to do it?","title":"How to encode a text with rsa/ecb/pkcs1 padding mode with a given public key in java?","body":"<p>I want to encode a string with rsa/ecb/pkcs1 padding mode with a given public key (the public key is a string) in java.</p>\n\n<p>I also want to present the results in UTF-8 Format \nhow to do it?</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":465573,"reputation":192703,"user_id":869736,"accept_rate":82,"display_name":"Louis Wasserman"},"score":3,"creation_date":1694274966,"post_id":77072968,"comment_id":135871333,"body_markdown":"`OutputStream` is for bytes, `Writer` is for characters.  Just writing an `int` wouldn&#39;t work; it&#39;s going to output each byte as its own char rather than combining the two bytes.","body":"<code>OutputStream</code> is for bytes, <code>Writer</code> is for characters.  Just writing an <code>int</code> wouldn&#39;t work; it&#39;s going to output each byte as its own char rather than combining the two bytes."},{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":1,"creation_date":1694275607,"post_id":77072968,"comment_id":135871394,"body_markdown":"Use [this ctor](https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/PrintStream.html#%3Cinit%3E(java.io.OutputStream,boolean,java.nio.charset.Charset))","body":"Use <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/PrintStream.html#%3Cinit%3E(java.io.OutputStream,boolean,java.nio.charset.Charset)\" rel=\"nofollow noreferrer\">this ctor</a>"},{"owner":{"account_id":31180,"reputation":29173,"user_id":85421,"display_name":"user85421"},"score":1,"creation_date":1694277787,"post_id":77072968,"comment_id":135871616,"body_markdown":"BTW `&quot;&#176;&quot;.getBytes()` results in `[-62, -80]` (aka `[0xC2, 0xB0]`) as UTF-8 is probably the used enccoding and `\\u00B0` is encoded by that bytes - [Wikipedia]: &quot;The first 128 code points (ASCII) need one byte. The next 1,920 code points need two bytes to encode, ...&quot;","body":"BTW <code>&quot;&#176;&quot;.getBytes()</code> results in <code>[-62, -80]</code> (aka <code>[0xC2, 0xB0]</code>) as UTF-8 is probably the used enccoding and <code>\\u00B0</code> is encoded by that bytes - [Wikipedia]: &quot;The first 128 code points (ASCII) need one byte. The next 1,920 code points need two bytes to encode, ...&quot;"},{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":1,"creation_date":1694288212,"post_id":77072968,"comment_id":135872641,"body_markdown":"By the way, `char` is physically incapable of representing most characters. Make a habit of using Unicode [code point](https://en.wikipedia.org/wiki/Code_point) integer numbers instead: `Character.toString( b )`. For [DEGREE SIGN](https://www.fileformat.info/info/unicode/char/b0/index.htm), `Character.toString( 176 )`. See that code run [at Ideone.com](https://ideone.com/yJai53).","body":"By the way, <code>char</code> is physically incapable of representing most characters. Make a habit of using Unicode <a href=\"https://en.wikipedia.org/wiki/Code_point\" rel=\"nofollow noreferrer\">code point</a> integer numbers instead: <code>Character.toString( b )</code>. For <a href=\"https://www.fileformat.info/info/unicode/char/b0/index.htm\" rel=\"nofollow noreferrer\">DEGREE SIGN</a>, <code>Character.toString( 176 )</code>. See that code run <a href=\"https://ideone.com/yJai53\" rel=\"nofollow noreferrer\">at Ideone.com</a>."},{"owner":{"account_id":2656033,"reputation":47,"user_id":2296720,"accept_rate":100,"display_name":"FreackH"},"score":0,"creation_date":1694293995,"post_id":77072968,"comment_id":135873173,"body_markdown":"Thanks all for pointing me in the right direction, indeed I was trying to write characters using a byte stream, so any integer not fitting within the byte type was getting split. I managed to get a working solution using Charset decoder and a ByteBuffer, will post it below.","body":"Thanks all for pointing me in the right direction, indeed I was trying to write characters using a byte stream, so any integer not fitting within the byte type was getting split. I managed to get a working solution using Charset decoder and a ByteBuffer, will post it below."}],"answers":[{"comments":[{"owner":{"account_id":2656033,"reputation":47,"user_id":2296720,"accept_rate":100,"display_name":"FreackH"},"score":0,"creation_date":1694294187,"post_id":77073087,"comment_id":135873192,"body_markdown":"Thanks, that was one of the first things I tried but it did not work. The problem here is that the byte stream is still being used to write int-long characters per every write(int b) call.","body":"Thanks, that was one of the first things I tried but it did not work. The problem here is that the byte stream is still being used to write int-long characters per every write(int b) call."}],"tags":[],"owner":{"account_id":92073,"reputation":1,"user_id":252518,"accept_rate":71,"display_name":"Freeman"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1694287945,"creation_date":1694276852,"answer_id":77073087,"question_id":77072968,"body_markdown":"I think you must specify the character encoding when creating the `PrintStream`, because when you append the value of `(char) b` to the `jTextArea1`, it assumes the default character encoding of your system and not be able to display certain characters properly!\r\n\r\nFor the [`PrintStream` constructor][1], pass the parameter for [`Charset`][2], such as [`StandardCharsets.UTF_8`][3].\r\n\r\n    System.setOut(new PrintStream(new StdOutput(), true, StandardCharsets.UTF_8));\r\n    \r\n    class StdOutput extends OutputStream {\r\n        @Override\r\n        public void write(int b) throws IOException {\r\n            jTextArea1.append(String.valueOf((char) b));\r\n        }\r\n    }\r\n\r\n\r\n  [1]: https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/PrintStream.html#%3Cinit%3E(java.io.OutputStream,boolean,java.nio.charset.Charset)\r\n  [2]: https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/nio/charset/Charset.html\r\n  [3]: https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/nio/charset/StandardCharsets.html#UTF_8","title":"Write Unicode characters to &amp; from standard output stream","body":"<p>I think you must specify the character encoding when creating the <code>PrintStream</code>, because when you append the value of <code>(char) b</code> to the <code>jTextArea1</code>, it assumes the default character encoding of your system and not be able to display certain characters properly!</p>\n<p>For the <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/PrintStream.html#%3Cinit%3E(java.io.OutputStream,boolean,java.nio.charset.Charset)\" rel=\"nofollow noreferrer\"><code>PrintStream</code> constructor</a>, pass the parameter for <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/nio/charset/Charset.html\" rel=\"nofollow noreferrer\"><code>Charset</code></a>, such as <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/nio/charset/StandardCharsets.html#UTF_8\" rel=\"nofollow noreferrer\"><code>StandardCharsets.UTF_8</code></a>.</p>\n<pre><code>System.setOut(new PrintStream(new StdOutput(), true, StandardCharsets.UTF_8));\n\nclass StdOutput extends OutputStream {\n    @Override\n    public void write(int b) throws IOException {\n        jTextArea1.append(String.valueOf((char) b));\n    }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1694297280,"post_id":77074092,"comment_id":135873449,"body_markdown":"What was your particular motivation for remapping `System.out`?","body":"What was your particular motivation for remapping <code>System.out</code>?"},{"owner":{"account_id":2656033,"reputation":47,"user_id":2296720,"accept_rate":100,"display_name":"FreackH"},"score":0,"creation_date":1694354171,"post_id":77074092,"comment_id":135877371,"body_markdown":"@g00se I have a large TextArea where the app displays status codes and other messages while it runs, so I thought redirecting the standard output to it would make it more convinient for diagnostic purposes e.g. exceptions display, use of System.out.print() in the code etc.  Looking purely at the overhead it added and other issues I faced I would not use it in production code. Was still worth the effort to see if it was possible at all and learn something new.","body":"@g00se I have a large TextArea where the app displays status codes and other messages while it runs, so I thought redirecting the standard output to it would make it more convinient for diagnostic purposes e.g. exceptions display, use of System.out.print() in the code etc.  Looking purely at the overhead it added and other issues I faced I would not use it in production code. Was still worth the effort to see if it was possible at all and learn something new."}],"tags":[],"owner":{"account_id":2656033,"reputation":47,"user_id":2296720,"accept_rate":100,"display_name":"FreackH"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694294831,"creation_date":1694294831,"answer_id":77074092,"question_id":77072968,"body_markdown":"Thanks to the people who commented on my original post, I came up with something that works for my situation:\r\n\r\n        bb = ByteBuffer.allocateDirect(500);\r\n        cs = Charset.forName(&quot;UTF-8&quot;);\r\n        dc = cs.newDecoder();\r\n\r\n        System.setOut(new PrintStream(new StdOutput(), true));\r\n\r\n    class StdOutput extends OutputStream {\r\n        @Override\r\n        public void write(int b) throws IOException {\r\n            if (b == &#39;\\n&#39;) {\r\n                bb.put((byte)&#39;\\n&#39;);\r\n                bb.rewind();\r\n                jTextArea1.append(dc.decode(bb).toString());\r\n                bb = ByteBuffer.allocateDirect(500);\r\n            } else {\r\n                bb.put((byte) b);\r\n            }\r\n        }\r\n    }\r\n\r\nObviously that is pretty clumsy and only works for my locale and if I put a single string of a known length per write call, so if anyone can suggest a more elegant solution for writing characters to the standard output stream - I would highly appreciate it!","title":"Write Unicode characters to &amp; from standard output stream","body":"<p>Thanks to the people who commented on my original post, I came up with something that works for my situation:</p>\n<pre><code>    bb = ByteBuffer.allocateDirect(500);\n    cs = Charset.forName(&quot;UTF-8&quot;);\n    dc = cs.newDecoder();\n\n    System.setOut(new PrintStream(new StdOutput(), true));\n\nclass StdOutput extends OutputStream {\n    @Override\n    public void write(int b) throws IOException {\n        if (b == '\\n') {\n            bb.put((byte)'\\n');\n            bb.rewind();\n            jTextArea1.append(dc.decode(bb).toString());\n            bb = ByteBuffer.allocateDirect(500);\n        } else {\n            bb.put((byte) b);\n        }\n    }\n}\n</code></pre>\n<p>Obviously that is pretty clumsy and only works for my locale and if I put a single string of a known length per write call, so if anyone can suggest a more elegant solution for writing characters to the standard output stream - I would highly appreciate it!</p>\n"}],"owner":{"account_id":2656033,"reputation":47,"user_id":2296720,"accept_rate":100,"display_name":"FreackH"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":77,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1694294831,"creation_date":1694274770,"question_id":77072968,"body_markdown":"I need to reassign the standard output stream to a jTextArea, which I did as follows:\r\n\r\n        System.setOut(new PrintStream(new StdOutput()));\r\n    \r\n        class StdOutput extends OutputStream {\r\n            @Override\r\n            public void write(int b) throws IOException {\r\n                jTextArea1.append(String.valueOf((char) b));\r\n            }\r\n        }\r\n\r\nHowever, I have some special characters written to the stream but they don&#39;t get displayed properly - e.g. a degree sign comes out as two chineese characters.\r\n\r\nI thought this may have to do with the width of the `char` type and truncating the `int` type to 16 bits, so not all special characters will be displayed properly. However, the degree sign is only `0x00B0` so it should fit well within a `char`. What I get instead of `0x00B0` is two characters - `0xFFC2` &amp; `0xFFB0`.\r\n\r\nI also tried masking `b` with `0xFFFFFFFF` and assigning different encodings to the `PrintStream` instance, but had no success. What am I missing?","title":"Write Unicode characters to &amp; from standard output stream","body":"<p>I need to reassign the standard output stream to a jTextArea, which I did as follows:</p>\n<pre><code>    System.setOut(new PrintStream(new StdOutput()));\n\n    class StdOutput extends OutputStream {\n        @Override\n        public void write(int b) throws IOException {\n            jTextArea1.append(String.valueOf((char) b));\n        }\n    }\n</code></pre>\n<p>However, I have some special characters written to the stream but they don't get displayed properly - e.g. a degree sign comes out as two chineese characters.</p>\n<p>I thought this may have to do with the width of the <code>char</code> type and truncating the <code>int</code> type to 16 bits, so not all special characters will be displayed properly. However, the degree sign is only <code>0x00B0</code> so it should fit well within a <code>char</code>. What I get instead of <code>0x00B0</code> is two characters - <code>0xFFC2</code> &amp; <code>0xFFB0</code>.</p>\n<p>I also tried masking <code>b</code> with <code>0xFFFFFFFF</code> and assigning different encodings to the <code>PrintStream</code> instance, but had no success. What am I missing?</p>\n"},{"tags":["java","ant","saxon"],"comments":[{"owner":{"account_id":529122,"reputation":158120,"user_id":415448,"accept_rate":33,"display_name":"Michael Kay"},"score":0,"creation_date":1649665083,"post_id":71822203,"comment_id":126924367,"body_markdown":"Is the problem specific to use of &#39;-?&#39; or does it occur with other arguments? The stack trace suggests a failure by Ant to load Saxon, which would happen irrespective of the actual arguments.","body":"Is the problem specific to use of &#39;-?&#39; or does it occur with other arguments? The stack trace suggests a failure by Ant to load Saxon, which would happen irrespective of the actual arguments."},{"owner":{"account_id":2029617,"reputation":322,"user_id":1813708,"accept_rate":43,"display_name":"John Carlson"},"score":0,"creation_date":1650248939,"post_id":71822203,"comment_id":127064905,"body_markdown":"I think that ant under OpenJDK 18 may be the issue.  I’ve had to add xmlresolver jars in other places, which helped Saxon work.   Right now, I just comment out the -? and deal with it that way.","body":"I think that ant under OpenJDK 18 may be the issue.  I’ve had to add xmlresolver jars in other places, which helped Saxon work.   Right now, I just comment out the -? and deal with it that way."},{"owner":{"account_id":2029617,"reputation":322,"user_id":1813708,"accept_rate":43,"display_name":"John Carlson"},"score":0,"creation_date":1689970969,"post_id":71822203,"comment_id":135293224,"body_markdown":"It&#39;s a check in ant to make sure that saxon is working.\n\nThis code doesn&#39;t break the build.xml:\n\n        &lt;java classname=&quot;net.sf.saxon.Transform&quot; classpath=&quot;${saxon.dir}/${saxon.jar};${saxon.dir}/${xmlresolver.jar};.&quot; failonerror=&quot;true&quot; fork=&quot;${fork}&quot;&gt;\n            &lt;arg value=&quot;-?&quot; description=&quot;help information&quot;/&gt;\n        &lt;/java&gt;","body":"It&#39;s a check in ant to make sure that saxon is working.  This code doesn&#39;t break the build.xml:          &lt;java classname=&quot;net.sf.saxon.Transform&quot; classpath=&quot;${saxon.dir}/${saxon.jar};${saxon.dir}/${xmlresol&zwnj;&#8203;ver.jar};.&quot; failonerror=&quot;true&quot; fork=&quot;${fork}&quot;&gt;             &lt;arg value=&quot;-?&quot; description=&quot;help information&quot;/&gt;         &lt;/java&gt;"}],"answers":[{"comments":[{"owner":{"account_id":2029617,"reputation":322,"user_id":1813708,"accept_rate":43,"display_name":"John Carlson"},"score":0,"creation_date":1694312188,"post_id":77074086,"comment_id":135874225,"body_markdown":"That sounds like a reasonable fix, so I&#39;m going to accept your answer. We currently have fork=&quot;true&quot;","body":"That sounds like a reasonable fix, so I&#39;m going to accept your answer. We currently have fork=&quot;true&quot;"}],"tags":[],"owner":{"account_id":18223968,"reputation":796,"user_id":13264143,"display_name":"John Glen"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1694294616,"creation_date":1694294616,"answer_id":77074086,"question_id":71822203,"body_markdown":"Found the same bug on Windows 10 with Java 20, and the solution was to add fork=&quot;yes&quot; to the java command. It has been an issue since Java 18 that has never been fixed as of the date of this posting.","title":"Need help getting ant saxon Transform &#39;-?&#39; working","body":"<p>Found the same bug on Windows 10 with Java 20, and the solution was to add fork=&quot;yes&quot; to the java command. It has been an issue since Java 18 that has never been fixed as of the date of this posting.</p>\n"}],"owner":{"account_id":2029617,"reputation":322,"user_id":1813708,"accept_rate":43,"display_name":"John Carlson"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":115,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77074086,"answer_count":1,"score":0,"last_activity_date":1694294616,"creation_date":1649645233,"question_id":71822203,"body_markdown":"I am having issues running a saxon programs with ant using the -? arg.  This fails on Linux (flavors of Ubuntu) and Windows 10 in my experience.\r\n\r\nHere&#39;s the code that fails in build.xml:\r\n\r\n```\r\n &lt;java classname=&quot;net.sf.saxon.Transform&quot; classpath=&quot;${saxon.dir}/${saxon.jar};.&quot; failonerror=&quot;true&quot;&gt;\r\n            &lt;arg value=&quot;-?&quot; description=&quot;help information&quot;/&gt;\r\n        &lt;/java&gt;\r\n```\r\nNote that this seems to work:\r\n```\r\n$ java -cp &quot;java/lib/saxon-he-11.2.jar;java/lib/xmlresolver-4.2.0.jar;java/lib/xmlresolver-4.2.0-data.jar&quot; net.sf.saxon.\r\nTransform &#39;-?&#39;\r\nSaxonJ-HE 11.2 from Saxonica\r\nUsage: see http://www.saxonica.com/documentation/index.html#!using-xsl/commandline\r\nFormat: net.sf.saxon.Transform options params\r\nOptions available: -? -a -catalog -config -cr -diag -dtd -ea -expand -explain -export -ext -im -init -it -jit -json -l -lib -license -nogo -now -ns -o -opt -or -outval -p -quit -r -relocate -repeat -s -sa -scmin -strip -t -T -target -TB -threads -TJ -Tlevel -Tout -TP -traceout -tree -u -val -versionmsg -warnings -x -xi -xmlversion -xsd -xsdversion -xsiloc -xsl -y --?\r\nUse -XYZ:? for details of option XYZ\r\nParams:\r\n  param=value           Set stylesheet string parameter\r\n  +param=filename       Set stylesheet document parameter\r\n  ?param=expression     Set stylesheet parameter using XPath\r\n  !param=value          Set serialization parameter\r\n```\r\nA typical stacktrace looks like this:\r\n```\r\nBUILD FAILED\r\nC:\\x3d-code\\www.web3d.org\\x3d\\stylesheets\\build.xml:364: The following error occurred while executing this line:\r\nC:\\x3d-code\\www.web3d.org\\x3d\\stylesheets\\build.xml:164: java.lang.UnsupportedOperationException: The Security Manager is deprecated and will be removed in a future release\r\n        at java.base/java.lang.System.setSecurityManager(System.java:416)\r\n        at org.apache.tools.ant.types.Permissions.setSecurityManager(Permissions.java:103)\r\n        at org.apache.tools.ant.taskdefs.ExecuteJava.run(ExecuteJava.java:216)\r\n        at org.apache.tools.ant.taskdefs.ExecuteJava.execute(ExecuteJava.java:155)\r\n        at org.apache.tools.ant.taskdefs.Java.run(Java.java:891)\r\n        at org.apache.tools.ant.taskdefs.Java.executeJava(Java.java:231)\r\n        at org.apache.tools.ant.taskdefs.Java.executeJava(Java.java:135)\r\n        at org.apache.tools.ant.taskdefs.Java.execute(Java.java:108)\r\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:299)\r\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\r\n        at java.base/java.lang.reflect.Method.invoke(Method.java:577)\r\n        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:99)\r\n        at org.apache.tools.ant.Task.perform(Task.java:350)\r\n        at org.apache.tools.ant.Target.execute(Target.java:449)\r\n        at org.apache.tools.ant.Target.performTasks(Target.java:470)\r\n        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1401)\r\n        at org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:36)\r\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1264)\r\n        at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:437)\r\n        at org.apache.tools.ant.taskdefs.CallTarget.execute(CallTarget.java:106)\r\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:299)\r\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\r\n        at java.base/java.lang.reflect.Method.invoke(Method.java:577)\r\n        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:99)\r\n        at org.apache.tools.ant.Task.perform(Task.java:350)\r\n        at org.apache.tools.ant.Target.execute(Target.java:449)\r\n        at org.apache.tools.ant.Target.performTasks(Target.java:470)\r\n        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1401)\r\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1374)\r\n        at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\r\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1264)\r\n        at org.apache.tools.ant.Main.runBuild(Main.java:818)\r\n        at org.apache.tools.ant.Main.startAnt(Main.java:223)\r\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:284)\r\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:101)\r\n\r\nTotal time: 0 seconds\r\n```\r\n\r\nIt would be cool if someone could come up with the appropriate ant configuration or syntax to make this work.","title":"Need help getting ant saxon Transform &#39;-?&#39; working","body":"<p>I am having issues running a saxon programs with ant using the -? arg.  This fails on Linux (flavors of Ubuntu) and Windows 10 in my experience.</p>\n<p>Here's the code that fails in build.xml:</p>\n<pre><code> &lt;java classname=&quot;net.sf.saxon.Transform&quot; classpath=&quot;${saxon.dir}/${saxon.jar};.&quot; failonerror=&quot;true&quot;&gt;\n            &lt;arg value=&quot;-?&quot; description=&quot;help information&quot;/&gt;\n        &lt;/java&gt;\n</code></pre>\n<p>Note that this seems to work:</p>\n<pre><code>$ java -cp &quot;java/lib/saxon-he-11.2.jar;java/lib/xmlresolver-4.2.0.jar;java/lib/xmlresolver-4.2.0-data.jar&quot; net.sf.saxon.\nTransform '-?'\nSaxonJ-HE 11.2 from Saxonica\nUsage: see http://www.saxonica.com/documentation/index.html#!using-xsl/commandline\nFormat: net.sf.saxon.Transform options params\nOptions available: -? -a -catalog -config -cr -diag -dtd -ea -expand -explain -export -ext -im -init -it -jit -json -l -lib -license -nogo -now -ns -o -opt -or -outval -p -quit -r -relocate -repeat -s -sa -scmin -strip -t -T -target -TB -threads -TJ -Tlevel -Tout -TP -traceout -tree -u -val -versionmsg -warnings -x -xi -xmlversion -xsd -xsdversion -xsiloc -xsl -y --?\nUse -XYZ:? for details of option XYZ\nParams:\n  param=value           Set stylesheet string parameter\n  +param=filename       Set stylesheet document parameter\n  ?param=expression     Set stylesheet parameter using XPath\n  !param=value          Set serialization parameter\n</code></pre>\n<p>A typical stacktrace looks like this:</p>\n<pre><code>BUILD FAILED\nC:\\x3d-code\\www.web3d.org\\x3d\\stylesheets\\build.xml:364: The following error occurred while executing this line:\nC:\\x3d-code\\www.web3d.org\\x3d\\stylesheets\\build.xml:164: java.lang.UnsupportedOperationException: The Security Manager is deprecated and will be removed in a future release\n        at java.base/java.lang.System.setSecurityManager(System.java:416)\n        at org.apache.tools.ant.types.Permissions.setSecurityManager(Permissions.java:103)\n        at org.apache.tools.ant.taskdefs.ExecuteJava.run(ExecuteJava.java:216)\n        at org.apache.tools.ant.taskdefs.ExecuteJava.execute(ExecuteJava.java:155)\n        at org.apache.tools.ant.taskdefs.Java.run(Java.java:891)\n        at org.apache.tools.ant.taskdefs.Java.executeJava(Java.java:231)\n        at org.apache.tools.ant.taskdefs.Java.executeJava(Java.java:135)\n        at org.apache.tools.ant.taskdefs.Java.execute(Java.java:108)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:299)\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\n        at java.base/java.lang.reflect.Method.invoke(Method.java:577)\n        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:99)\n        at org.apache.tools.ant.Task.perform(Task.java:350)\n        at org.apache.tools.ant.Target.execute(Target.java:449)\n        at org.apache.tools.ant.Target.performTasks(Target.java:470)\n        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1401)\n        at org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:36)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1264)\n        at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:437)\n        at org.apache.tools.ant.taskdefs.CallTarget.execute(CallTarget.java:106)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:299)\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\n        at java.base/java.lang.reflect.Method.invoke(Method.java:577)\n        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:99)\n        at org.apache.tools.ant.Task.perform(Task.java:350)\n        at org.apache.tools.ant.Target.execute(Target.java:449)\n        at org.apache.tools.ant.Target.performTasks(Target.java:470)\n        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1401)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1374)\n        at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1264)\n        at org.apache.tools.ant.Main.runBuild(Main.java:818)\n        at org.apache.tools.ant.Main.startAnt(Main.java:223)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:284)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:101)\n\nTotal time: 0 seconds\n</code></pre>\n<p>It would be cool if someone could come up with the appropriate ant configuration or syntax to make this work.</p>\n"},{"tags":["java","gmail"],"comments":[{"owner":{"account_id":2066403,"reputation":109440,"user_id":1841839,"accept_rate":71,"display_name":"Linda Lawton - DaImTo"},"score":0,"creation_date":1667570772,"post_id":74317936,"comment_id":131204192,"body_markdown":"what happens if you remove    props.put(&quot;mail.smtp.auth&quot;, &quot;true&quot;);","body":"what happens if you remove    props.put(&quot;mail.smtp.auth&quot;, &quot;true&quot;);"},{"owner":{"account_id":212642,"reputation":831,"user_id":465588,"accept_rate":68,"display_name":"Maik"},"score":0,"creation_date":1668779483,"post_id":74317936,"comment_id":131495553,"body_markdown":"@DaImTo nothing changes, same error as before","body":"@DaImTo nothing changes, same error as before"},{"owner":{"account_id":2066403,"reputation":109440,"user_id":1841839,"accept_rate":71,"display_name":"Linda Lawton - DaImTo"},"score":0,"creation_date":1668782587,"post_id":74317936,"comment_id":131496743,"body_markdown":"Does this answer your question? [Postfix and OpenJDK 11: &quot;No appropriate protocol (protocol is disabled or cipher suites are inappropriate)&quot;](https://stackoverflow.com/questions/67899129/postfix-and-openjdk-11-no-appropriate-protocol-protocol-is-disabled-or-cipher)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/67899129/postfix-and-openjdk-11-no-appropriate-protocol-protocol-is-disabled-or-cipher\">Postfix and OpenJDK 11: &quot;No appropriate protocol (protocol is disabled or cipher suites are inappropriate)&quot;</a>"}],"answers":[{"tags":[],"owner":{"account_id":60737,"reputation":15904,"user_id":181336,"display_name":"Adriaan Koster"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1667571509,"creation_date":1667571509,"answer_id":74318478,"question_id":74317936,"body_markdown":"I figured this out a while back and this should work:\r\n\r\n    import javax.mail.*;\r\n    \r\n    public class Emailer {\r\n    \r\n        private final String username;\r\n        private final String password;\r\n        private Session session;  \r\n    \r\n        public Emailer(String username, String password) {\r\n            this.username = username;\r\n            this.password = password;\r\n        }\r\n    \r\n        public void send(String email, String subject, String content) {\r\n            if (hasSession()) {\r\n                try {\r\n                    Transport.send(createMimeMessage(email, session, subject, content));\r\n                    System.out.printf(&quot;Email sent to %s%n&quot;, email);\r\n                } catch (MessagingException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }\r\n        }\r\n    \r\n        private boolean hasSession() {\r\n            if (session == null) {\r\n                session = startSessionTLS();\r\n            }\r\n            if (session == null) {\r\n                System.out.printf(&quot;Cannot start email session%n&quot;);\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n    \r\n        private Session startSessionTLS() {\r\n    \r\n            Properties props = new Properties();\r\n            props.put(&quot;mail.smtp.host&quot;, &quot;smtp.gmail.com&quot;);\r\n            props.put(&quot;mail.smtp.port&quot;, &quot;587&quot;);\r\n            props.put(&quot;mail.smtp.auth&quot;, &quot;true&quot;);\r\n            props.put(&quot;mail.smtp.starttls.enable&quot;, &quot;true&quot;);\r\n    \r\n            return Session.getInstance(props, new javax.mail.Authenticator() {\r\n                protected PasswordAuthentication getPasswordAuthentication() {\r\n                    return new PasswordAuthentication(username, password);\r\n                }\r\n            });\r\n        }\r\n    \r\n        private MimeMessage createMimeMessage(String email, Session session, String subject, String body) throws MessagingException {\r\n            MimeMessage message = new MimeMessage(session);\r\n            message.setFrom(new InternetAddress(&quot;noreply@email.com&quot;));\r\n            message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(email));\r\n            message.setSubject(subject);\r\n            message.setText(body);\r\n            return message;\r\n        }\r\n    }","title":"Send email with gmail using java","body":"<p>I figured this out a while back and this should work:</p>\n<pre><code>import javax.mail.*;\n\npublic class Emailer {\n\n    private final String username;\n    private final String password;\n    private Session session;  \n\n    public Emailer(String username, String password) {\n        this.username = username;\n        this.password = password;\n    }\n\n    public void send(String email, String subject, String content) {\n        if (hasSession()) {\n            try {\n                Transport.send(createMimeMessage(email, session, subject, content));\n                System.out.printf(&quot;Email sent to %s%n&quot;, email);\n            } catch (MessagingException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n\n    private boolean hasSession() {\n        if (session == null) {\n            session = startSessionTLS();\n        }\n        if (session == null) {\n            System.out.printf(&quot;Cannot start email session%n&quot;);\n            return false;\n        }\n        return true;\n    }\n\n    private Session startSessionTLS() {\n\n        Properties props = new Properties();\n        props.put(&quot;mail.smtp.host&quot;, &quot;smtp.gmail.com&quot;);\n        props.put(&quot;mail.smtp.port&quot;, &quot;587&quot;);\n        props.put(&quot;mail.smtp.auth&quot;, &quot;true&quot;);\n        props.put(&quot;mail.smtp.starttls.enable&quot;, &quot;true&quot;);\n\n        return Session.getInstance(props, new javax.mail.Authenticator() {\n            protected PasswordAuthentication getPasswordAuthentication() {\n                return new PasswordAuthentication(username, password);\n            }\n        });\n    }\n\n    private MimeMessage createMimeMessage(String email, Session session, String subject, String body) throws MessagingException {\n        MimeMessage message = new MimeMessage(session);\n        message.setFrom(new InternetAddress(&quot;noreply@email.com&quot;));\n        message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(email));\n        message.setSubject(subject);\n        message.setText(body);\n        return message;\n    }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":212642,"reputation":831,"user_id":465588,"accept_rate":68,"display_name":"Maik"},"score":1,"creation_date":1668776760,"post_id":74322233,"comment_id":131494574,"body_markdown":"Ok I have enabled the 2FA on the gmail account, and created an app password (for a Windows Computer). Now when i try to run your code, at the line Transport.send(message); i get the following exception:\njavax.mail.MessagingException: Can&#39;t send command to SMTP host;\n  nested exception is:\n\tjavax.net.ssl.SSLHandshakeException: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)","body":"Ok I have enabled the 2FA on the gmail account, and created an app password (for a Windows Computer). Now when i try to run your code, at the line Transport.send(message); i get the following exception: javax.mail.MessagingException: Can&#39;t send command to SMTP host;   nested exception is: \tjavax.net.ssl.SSLHandshakeException: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)"},{"owner":{"account_id":22089978,"reputation":142,"user_id":16348170,"display_name":"hidden_machine"},"score":0,"creation_date":1668792382,"post_id":74322233,"comment_id":131500298,"body_markdown":"@Maik Try to first send the email through curl, if it works through curl, then the issue is definitely either jdk version or the email library version related. If it doesn&#39;t work through curl, then the issue is probably incorrect authentication","body":"@Maik Try to first send the email through curl, if it works through curl, then the issue is definitely either jdk version or the email library version related. If it doesn&#39;t work through curl, then the issue is probably incorrect authentication"},{"owner":{"account_id":22089978,"reputation":142,"user_id":16348170,"display_name":"hidden_machine"},"score":0,"creation_date":1668792512,"post_id":74322233,"comment_id":131500336,"body_markdown":"@Maik [Here](https://stackoverflow.com/a/16069786/16348170) is a simple one line command to send email through curl","body":"@Maik <a href=\"https://stackoverflow.com/a/16069786/16348170\">Here</a> is a simple one line command to send email through curl"},{"owner":{"account_id":212642,"reputation":831,"user_id":465588,"accept_rate":68,"display_name":"Maik"},"score":0,"creation_date":1669029163,"post_id":74322233,"comment_id":131541974,"body_markdown":"I didn&#39;t know what curl is, I&#39;m learning... The example you linked is for linux, but I guess it should work on a windows machine too, right? I get this error: &quot;curl: (3) URL using bad/illegal format or missing URL&quot;. The right port to use is 465 or 587?","body":"I didn&#39;t know what curl is, I&#39;m learning... The example you linked is for linux, but I guess it should work on a windows machine too, right? I get this error: &quot;curl: (3) URL using bad/illegal format or missing URL&quot;. The right port to use is 465 or 587?"},{"owner":{"account_id":22089978,"reputation":142,"user_id":16348170,"display_name":"hidden_machine"},"score":0,"creation_date":1669046829,"post_id":74322233,"comment_id":131548609,"body_markdown":"@Maik , just remove the backslashes, and it should work. The backslashes are used for spanning the command across multiple lines in a `linux` terminal. The equivalent would be `^` in `windows`","body":"@Maik , just remove the backslashes, and it should work. The backslashes are used for spanning the command across multiple lines in a <code>linux</code> terminal. The equivalent would be <code>^</code> in <code>windows</code>"},{"owner":{"account_id":22089978,"reputation":142,"user_id":16348170,"display_name":"hidden_machine"},"score":0,"creation_date":1669147502,"post_id":74322233,"comment_id":131577269,"body_markdown":"@Maik gmail provides an an official guide to use their services; on their website ; https://developers.google.com/gmail/api/quickstart/java  https://developers.google.com/gmail/api/guides/sending","body":"@Maik gmail provides an an official guide to use their services; on their website ; <a href=\"https://developers.google.com/gmail/api/quickstart/java\" rel=\"nofollow noreferrer\">developers.google.com/gmail/api/quickstart/java</a>  <a href=\"https://developers.google.com/gmail/api/guides/sending\" rel=\"nofollow noreferrer\">developers.google.com/gmail/api/guides/sending</a>"},{"owner":{"account_id":212642,"reputation":831,"user_id":465588,"accept_rate":68,"display_name":"Maik"},"score":0,"creation_date":1669716747,"post_id":74322233,"comment_id":131700685,"body_markdown":"I already had written the command without backslashes, and the one above was the error i got. I tried again, removing single quote from the various parameters, and this time I got &quot;252 2.1.5 Send some mail, I&#39;ll try my best p35-20020a056402502300b00463b9d47e1fsm6033215eda.71 - gsmtp&quot;.\nBut nothing happens: I got no mail and the is no message in the sent box","body":"I already had written the command without backslashes, and the one above was the error i got. I tried again, removing single quote from the various parameters, and this time I got &quot;252 2.1.5 Send some mail, I&#39;ll try my best p35-20020a056402502300b00463b9d47e1fsm6033215eda.71 - gsmtp&quot;. But nothing happens: I got no mail and the is no message in the sent box"}],"tags":[],"owner":{"account_id":22089978,"reputation":142,"user_id":16348170,"display_name":"hidden_machine"},"comment_count":7,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1667591747,"creation_date":1667591099,"answer_id":74322233,"question_id":74317936,"body_markdown":"        public class EmailService {\r\n    \r\n        private String username;\r\n        private String password;\r\n    \r\n        private final Properties prop;\r\n    public EmailService(String host, int port, String username, String password) {\r\n                prop = new Properties();\r\n                prop.put(&quot;mail.smtp.auth&quot;, true);\r\n                prop.put(&quot;mail.smtp.starttls.enable&quot;, &quot;true&quot;);\r\n                prop.put(&quot;mail.smtp.host&quot;, host);\r\n                prop.put(&quot;mail.smtp.port&quot;, port);\r\n                prop.put(&quot;mail.smtp.ssl.trust&quot;, host);\r\n        \r\n                this.username = username;\r\n                this.password = password;\r\n            }\r\n        \r\n            public void sendMail(String from,String to,String subject, String msg) throws Exception {\r\n        \r\n                Session session = Session.getInstance(prop, new Authenticator() {\r\n                    @Override\r\n                    protected PasswordAuthentication getPasswordAuthentication() {\r\n                        return new PasswordAuthentication(username, password);\r\n                    }\r\n                });\r\n        \r\n                Message message = new MimeMessage(session);\r\n                message.setFrom(new InternetAddress(from));\r\n                message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(to));\r\n                message.setSubject(subject);\r\n        \r\n                MimeBodyPart mimeBodyPart = new MimeBodyPart();\r\n                mimeBodyPart.setContent(msg, &quot;text/html; charset=utf-8&quot;);\r\n        \r\n                Multipart multipart = new MimeMultipart();\r\n                multipart.addBodyPart(mimeBodyPart);\r\n        \r\n                message.setContent(multipart);\r\n        \r\n                Transport.send(message);\r\n    }\r\n            }\r\nand then call the function like so:\r\n\r\n    new EmailService(&quot;smtp.gmail.com&quot;, 587, &quot;&lt;emailID&gt;&quot;, &quot;&lt;pass(not the actual gmail-account password if you&#39;re using gmail for this&gt;&quot;)\r\n                        .sendMail(&quot;&lt;emailID&gt;&quot;,\r\n                                toemail,\r\n                                &quot;&lt;title&gt;&quot;,\r\n                                &quot;&lt;body&gt;);\r\n\r\nHowever, **that&#39;s only half the solution**. Since they discontinued the `Less Secure App Access` feature on gmail accounts, you should access your gmail account through a different way now. \r\n\r\nYou must enable 2FA on that gmail account, and add an entry to `App passwords` under your google account. After that, the password you provide in the above function would be the &#39;App password&#39; that you got from the gmail account(not the actual gmail account password, this one is auto-generated I believe). \r\n\r\n[![enter image description here][1]][1]\r\n\r\nI am unaware of any other email service that offers smtp email feature for free nowadays. They all require you to pay in someway,except for gmail(Correct me if I&#39;m wrong)\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/l9oiI.png","title":"Send email with gmail using java","body":"<pre><code>    public class EmailService {\n\n    private String username;\n    private String password;\n\n    private final Properties prop;\npublic EmailService(String host, int port, String username, String password) {\n            prop = new Properties();\n            prop.put(&quot;mail.smtp.auth&quot;, true);\n            prop.put(&quot;mail.smtp.starttls.enable&quot;, &quot;true&quot;);\n            prop.put(&quot;mail.smtp.host&quot;, host);\n            prop.put(&quot;mail.smtp.port&quot;, port);\n            prop.put(&quot;mail.smtp.ssl.trust&quot;, host);\n    \n            this.username = username;\n            this.password = password;\n        }\n    \n        public void sendMail(String from,String to,String subject, String msg) throws Exception {\n    \n            Session session = Session.getInstance(prop, new Authenticator() {\n                @Override\n                protected PasswordAuthentication getPasswordAuthentication() {\n                    return new PasswordAuthentication(username, password);\n                }\n            });\n    \n            Message message = new MimeMessage(session);\n            message.setFrom(new InternetAddress(from));\n            message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(to));\n            message.setSubject(subject);\n    \n            MimeBodyPart mimeBodyPart = new MimeBodyPart();\n            mimeBodyPart.setContent(msg, &quot;text/html; charset=utf-8&quot;);\n    \n            Multipart multipart = new MimeMultipart();\n            multipart.addBodyPart(mimeBodyPart);\n    \n            message.setContent(multipart);\n    \n            Transport.send(message);\n}\n        }\n</code></pre>\n<p>and then call the function like so:</p>\n<pre><code>new EmailService(&quot;smtp.gmail.com&quot;, 587, &quot;&lt;emailID&gt;&quot;, &quot;&lt;pass(not the actual gmail-account password if you're using gmail for this&gt;&quot;)\n                    .sendMail(&quot;&lt;emailID&gt;&quot;,\n                            toemail,\n                            &quot;&lt;title&gt;&quot;,\n                            &quot;&lt;body&gt;);\n</code></pre>\n<p>However, <strong>that's only half the solution</strong>. Since they discontinued the <code>Less Secure App Access</code> feature on gmail accounts, you should access your gmail account through a different way now.</p>\n<p>You must enable 2FA on that gmail account, and add an entry to <code>App passwords</code> under your google account. After that, the password you provide in the above function would be the 'App password' that you got from the gmail account(not the actual gmail account password, this one is auto-generated I believe).</p>\n<p><a href=\"https://i.stack.imgur.com/l9oiI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l9oiI.png\" alt=\"enter image description here\" /></a></p>\n<p>I am unaware of any other email service that offers smtp email feature for free nowadays. They all require you to pay in someway,except for gmail(Correct me if I'm wrong)</p>\n"},{"tags":[],"owner":{"account_id":4306599,"reputation":3578,"user_id":3518815,"accept_rate":25,"display_name":"Kuntal Ghosh"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1694294403,"creation_date":1694294403,"answer_id":77074075,"question_id":74317936,"body_markdown":"First of all, you cannot use password while sending email via Gmail. You need to generate app-specific password for this.\r\n\r\nTo enable app-specific password follow below steps.\r\n\r\n**Step 1:** Enable 2FA. *To enable 2FA, please click [here][1].*\r\n\r\n**Step 2:** Create an app-specific password. *To create one, please click [here][2].*\r\n\r\nClick on the highlighted option from the &quot;Select app&quot; dropdown. Click Generate. It will generate 16 digits password and appear only once. Copy somewhere for future use.\r\n\r\n[![enter image description here][3]][3]\r\n\r\nIn *application.properties* file add below lines for email configurations\r\n\r\n    spring.mail.host=smtp.gmail.com\r\n    spring.mail.port=587\r\n    spring.mail.username=YOUR GMAIL ID\r\n    spring.mail.password=APP-SPECIFIC PASSWORD\r\n    spring.mail.properties.mail.smtp.auth=true\r\n    spring.mail.properties.mail.smtp.starttls.enable=true\r\n\r\nThe maven dependency can also be added by modifying your project’s *pom.xml* file to include the following\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n        &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;\r\n    &lt;/dependency&gt;\r\n\r\nIf you need HTML email, you can use `MimeMessage` class for this purpose.\r\n\r\nThe service file to send the email is as following. This will create HTML emails for you.\r\n\r\n    package com.comp.service;\r\n    \r\n    import javax.mail.MessagingException;\r\n    import javax.mail.internet.MimeMessage;\r\n    \r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.mail.javamail.JavaMailSender;\r\n    import org.springframework.stereotype.Service;\r\n    \r\n    import com.comp.serviceIntf.EmailService;\r\n    \r\n    @Service\r\n    public class EmailServiceImpl implements EmailService {\r\n    \r\n    \t@Autowired\r\n        private JavaMailSender mailSender;\r\n    \t\r\n    \t@Override\r\n    \tpublic void sendEmail(String to, String name, String userid, String password) throws MessagingException\r\n    \t{\r\n    \t\tString htmlContent = &quot;Hi %s, &lt;br /&gt;&lt;br /&gt;Welcome to &lt;b&gt;MyCompany&lt;/b&gt;. &lt;br /&gt;Your UserID is: &lt;b&gt;%s&lt;/b&gt; and Password is: &lt;b&gt;%s&lt;/b&gt;&lt;br /&gt;&lt;h5&gt;This is system generated password. You can change it anytime after login.&lt;/h5&gt;&lt;h5&gt;Please do not share this credential with anybody else.&lt;/h5&gt;&lt;br /&gt;With regards,&lt;br /&gt;MyCompany&quot;;\r\n    \t\thtmlContent = String.format(htmlContent, name, userid, password);\r\n    \t\t\r\n    \t\tString subject = &quot;Welcome %s (%s) on successful registration&quot;;\r\n    \t\tsubject = String.format(subject, name, userid);\r\n    \t\t\r\n    \t\t\r\n    \t\tMimeMessage message = mailSender.createMimeMessage();\r\n    \t\tmessage.setRecipients(MimeMessage.RecipientType.TO, to);\r\n    \t\tmessage.setSubject(subject);\r\n    \t\tmessage.setContent(htmlContent, &quot;text/html; charset=utf-8&quot;);\r\n    \t    mailSender.send(message);\r\n    \t}\r\n    }\r\n\r\nIf you do not need HTML email, you can use `SimpleMailMessage` class for this purpose.\r\n\r\n    SimpleMailMessage message = new SimpleMailMessage();\r\n    message.setTo(to);\r\n    message.setSubject(subject);\r\n    message.setText(body);\r\n\r\n    mailSender.send(message);\r\n\r\n\r\n**Note:** I am unaware of any other email like yahoo, outlook etc. This discussion is purely from Gmail point of view.\r\n\r\n  [1]: https://myaccount.google.com/signinoptions/two-step-verification/enroll-welcome\r\n  [2]: https://myaccount.google.com/apppasswords\r\n  [3]: https://i.stack.imgur.com/pbnZY.png","title":"Send email with gmail using java","body":"<p>First of all, you cannot use password while sending email via Gmail. You need to generate app-specific password for this.</p>\n<p>To enable app-specific password follow below steps.</p>\n<p><strong>Step 1:</strong> Enable 2FA. <em>To enable 2FA, please click <a href=\"https://myaccount.google.com/signinoptions/two-step-verification/enroll-welcome\" rel=\"nofollow noreferrer\">here</a>.</em></p>\n<p><strong>Step 2:</strong> Create an app-specific password. <em>To create one, please click <a href=\"https://myaccount.google.com/apppasswords\" rel=\"nofollow noreferrer\">here</a>.</em></p>\n<p>Click on the highlighted option from the &quot;Select app&quot; dropdown. Click Generate. It will generate 16 digits password and appear only once. Copy somewhere for future use.</p>\n<p><a href=\"https://i.stack.imgur.com/pbnZY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pbnZY.png\" alt=\"enter image description here\" /></a></p>\n<p>In <em>application.properties</em> file add below lines for email configurations</p>\n<pre><code>spring.mail.host=smtp.gmail.com\nspring.mail.port=587\nspring.mail.username=YOUR GMAIL ID\nspring.mail.password=APP-SPECIFIC PASSWORD\nspring.mail.properties.mail.smtp.auth=true\nspring.mail.properties.mail.smtp.starttls.enable=true\n</code></pre>\n<p>The maven dependency can also be added by modifying your project’s <em>pom.xml</em> file to include the following</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>If you need HTML email, you can use <code>MimeMessage</code> class for this purpose.</p>\n<p>The service file to send the email is as following. This will create HTML emails for you.</p>\n<pre><code>package com.comp.service;\n\nimport javax.mail.MessagingException;\nimport javax.mail.internet.MimeMessage;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.mail.javamail.JavaMailSender;\nimport org.springframework.stereotype.Service;\n\nimport com.comp.serviceIntf.EmailService;\n\n@Service\npublic class EmailServiceImpl implements EmailService {\n\n    @Autowired\n    private JavaMailSender mailSender;\n    \n    @Override\n    public void sendEmail(String to, String name, String userid, String password) throws MessagingException\n    {\n        String htmlContent = &quot;Hi %s, &lt;br /&gt;&lt;br /&gt;Welcome to &lt;b&gt;MyCompany&lt;/b&gt;. &lt;br /&gt;Your UserID is: &lt;b&gt;%s&lt;/b&gt; and Password is: &lt;b&gt;%s&lt;/b&gt;&lt;br /&gt;&lt;h5&gt;This is system generated password. You can change it anytime after login.&lt;/h5&gt;&lt;h5&gt;Please do not share this credential with anybody else.&lt;/h5&gt;&lt;br /&gt;With regards,&lt;br /&gt;MyCompany&quot;;\n        htmlContent = String.format(htmlContent, name, userid, password);\n        \n        String subject = &quot;Welcome %s (%s) on successful registration&quot;;\n        subject = String.format(subject, name, userid);\n        \n        \n        MimeMessage message = mailSender.createMimeMessage();\n        message.setRecipients(MimeMessage.RecipientType.TO, to);\n        message.setSubject(subject);\n        message.setContent(htmlContent, &quot;text/html; charset=utf-8&quot;);\n        mailSender.send(message);\n    }\n}\n</code></pre>\n<p>If you do not need HTML email, you can use <code>SimpleMailMessage</code> class for this purpose.</p>\n<pre><code>SimpleMailMessage message = new SimpleMailMessage();\nmessage.setTo(to);\nmessage.setSubject(subject);\nmessage.setText(body);\n\nmailSender.send(message);\n</code></pre>\n<p><strong>Note:</strong> I am unaware of any other email like yahoo, outlook etc. This discussion is purely from Gmail point of view.</p>\n"}],"owner":{"account_id":212642,"reputation":831,"user_id":465588,"accept_rate":68,"display_name":"Maik"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3271,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":3,"score":2,"last_activity_date":1694294403,"creation_date":1667569124,"question_id":74317936,"body_markdown":"As title says, I would like to send emails with my gmail account writing some java code. \r\nI have found many code examples, but none of them is working for me\r\n\r\nI was looking a this one: https://stackoverflow.com/questions/46663/how-can-i-send-an-email-by-java-application-using-gmail-yahoo-or-hotmail/47452#47452\r\n\r\nI have tried the code posted as answer, but I get this exception:\r\n\r\n    javax.mail.MessagingException: Can&#39;t send command to SMTP host;\r\n      nested exception is:\r\n    \tjavax.net.ssl.SSLHandshakeException: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)\r\n    \tat com.sun.mail.smtp.SMTPTransport.sendCommand(SMTPTransport.java:1717)\r\n    \tat com.sun.mail.smtp.SMTPTransport.sendCommand(SMTPTransport.java:1704)\r\n    \tat com.sun.mail.smtp.SMTPTransport.ehlo(SMTPTransport.java:1088)\r\n    \tat com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:468)\r\n    \tat javax.mail.Service.connect(Service.java:291)\r\n    \tat javax.mail.Service.connect(Service.java:172)\r\n    ...\r\n\r\n\r\nThe code is this:\r\n\r\n    public class GmailTest {\r\n       \r\n        private static String USER_NAME = &quot;*****&quot;;  // GMail user name (just the part before &quot;@gmail.com&quot;)\r\n        private static String PASSWORD = &quot;********&quot;; // GMail password\r\n        private static String RECIPIENT = &quot;random.address@gmail.com&quot;;\r\n    \r\n        public static void main(String[] args) {\r\n            String from = USER_NAME;\r\n            String pass = PASSWORD;\r\n            String[] to = { RECIPIENT }; // list of recipient email addresses\r\n            String subject = &quot;Java send mail example&quot;;\r\n            String body = &quot;Welcome to JavaMail!&quot;;\r\n    \r\n            sendFromGMail(from, pass, to, subject, body);\r\n        }\r\n    \r\n        private static void sendFromGMail(String from, String pass, String[] to, String subject, String body) {\r\n            Properties props = System.getProperties();\r\n            String host = &quot;smtp.gmail.com&quot;;\r\n            props.put(&quot;mail.smtp.starttls.enable&quot;, &quot;true&quot;);\r\n            props.put(&quot;mail.smtp.host&quot;, host);\r\n            props.put(&quot;mail.smtp.user&quot;, from);\r\n            props.put(&quot;mail.smtp.password&quot;, pass);\r\n            props.put(&quot;mail.smtp.port&quot;, &quot;587&quot;);\r\n            props.put(&quot;mail.smtp.auth&quot;, &quot;true&quot;);\r\n    \r\n            Session session = Session.getDefaultInstance(props);\r\n            MimeMessage message = new MimeMessage(session);\r\n    \r\n            try {\r\n                message.setFrom(new InternetAddress(from));\r\n                InternetAddress[] toAddress = new InternetAddress[to.length];\r\n    \r\n                // To get the array of addresses\r\n                for( int i = 0; i &lt; to.length; i++ ) {\r\n                    toAddress[i] = new InternetAddress(to[i]);\r\n                }\r\n    \r\n                for( int i = 0; i &lt; toAddress.length; i++) {\r\n                    message.addRecipient(Message.RecipientType.TO, toAddress[i]);\r\n                }\r\n    \r\n                message.setSubject(subject);\r\n                message.setText(body);\r\n                Transport transport = session.getTransport(&quot;smtp&quot;);\r\n                transport.connect(host, from, pass);\r\n                transport.sendMessage(message, message.getAllRecipients());\r\n                transport.close();\r\n            \r\n            } catch (Exception e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n    }\r\n\r\nShould this work in 2022 or did something change?\r\nWhy am I getting that exception?","title":"Send email with gmail using java","body":"<p>As title says, I would like to send emails with my gmail account writing some java code.\nI have found many code examples, but none of them is working for me</p>\n<p>I was looking a this one: <a href=\"https://stackoverflow.com/questions/46663/how-can-i-send-an-email-by-java-application-using-gmail-yahoo-or-hotmail/47452#47452\">How can I send an email by Java application using GMail, Yahoo, or Hotmail?</a></p>\n<p>I have tried the code posted as answer, but I get this exception:</p>\n<pre><code>javax.mail.MessagingException: Can't send command to SMTP host;\n  nested exception is:\n    javax.net.ssl.SSLHandshakeException: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)\n    at com.sun.mail.smtp.SMTPTransport.sendCommand(SMTPTransport.java:1717)\n    at com.sun.mail.smtp.SMTPTransport.sendCommand(SMTPTransport.java:1704)\n    at com.sun.mail.smtp.SMTPTransport.ehlo(SMTPTransport.java:1088)\n    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:468)\n    at javax.mail.Service.connect(Service.java:291)\n    at javax.mail.Service.connect(Service.java:172)\n...\n</code></pre>\n<p>The code is this:</p>\n<pre><code>public class GmailTest {\n   \n    private static String USER_NAME = &quot;*****&quot;;  // GMail user name (just the part before &quot;@gmail.com&quot;)\n    private static String PASSWORD = &quot;********&quot;; // GMail password\n    private static String RECIPIENT = &quot;random.address@gmail.com&quot;;\n\n    public static void main(String[] args) {\n        String from = USER_NAME;\n        String pass = PASSWORD;\n        String[] to = { RECIPIENT }; // list of recipient email addresses\n        String subject = &quot;Java send mail example&quot;;\n        String body = &quot;Welcome to JavaMail!&quot;;\n\n        sendFromGMail(from, pass, to, subject, body);\n    }\n\n    private static void sendFromGMail(String from, String pass, String[] to, String subject, String body) {\n        Properties props = System.getProperties();\n        String host = &quot;smtp.gmail.com&quot;;\n        props.put(&quot;mail.smtp.starttls.enable&quot;, &quot;true&quot;);\n        props.put(&quot;mail.smtp.host&quot;, host);\n        props.put(&quot;mail.smtp.user&quot;, from);\n        props.put(&quot;mail.smtp.password&quot;, pass);\n        props.put(&quot;mail.smtp.port&quot;, &quot;587&quot;);\n        props.put(&quot;mail.smtp.auth&quot;, &quot;true&quot;);\n\n        Session session = Session.getDefaultInstance(props);\n        MimeMessage message = new MimeMessage(session);\n\n        try {\n            message.setFrom(new InternetAddress(from));\n            InternetAddress[] toAddress = new InternetAddress[to.length];\n\n            // To get the array of addresses\n            for( int i = 0; i &lt; to.length; i++ ) {\n                toAddress[i] = new InternetAddress(to[i]);\n            }\n\n            for( int i = 0; i &lt; toAddress.length; i++) {\n                message.addRecipient(Message.RecipientType.TO, toAddress[i]);\n            }\n\n            message.setSubject(subject);\n            message.setText(body);\n            Transport transport = session.getTransport(&quot;smtp&quot;);\n            transport.connect(host, from, pass);\n            transport.sendMessage(message, message.getAllRecipients());\n            transport.close();\n        \n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<p>Should this work in 2022 or did something change?\nWhy am I getting that exception?</p>\n"},{"tags":["java","maven","gitlab","nexus","gitlab-ci-runner"],"answers":[{"comments":[{"owner":{"account_id":3992968,"reputation":1304,"user_id":3291266,"accept_rate":53,"display_name":"Mega"},"score":0,"creation_date":1653738272,"post_id":69479285,"comment_id":127927057,"body_markdown":"Hell Pawel, I have updated with the root cause of the issue and how I fixed it at the time.","body":"Hell Pawel, I have updated with the root cause of the issue and how I fixed it at the time."}],"tags":[],"owner":{"account_id":18126986,"reputation":1,"user_id":13182434,"display_name":"Paweł Tarsa"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1633601311,"creation_date":1633601311,"answer_id":69479285,"question_id":59686900,"body_markdown":"not sure if help is still needed but it seems that You did not grant necessary privileges to role of the user which You use for deployment/resolving dependencies. Please grant role nx-repository-view-*-*-* privilege. Test it and then you can decrease scope depend on your needs.","title":"Maven Nexus Issue - Authorization failed for 403 Forbidden","body":"<p>not sure if help is still needed but it seems that You did not grant necessary privileges to role of the user which You use for deployment/resolving dependencies. Please grant role nx-repository-view-<em>-</em>-* privilege. Test it and then you can decrease scope depend on your needs.</p>\n"},{"tags":[],"owner":{"account_id":3992968,"reputation":1304,"user_id":3291266,"accept_rate":53,"display_name":"Mega"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1653738226,"creation_date":1653738226,"answer_id":72415405,"question_id":59686900,"body_markdown":"The issue at the time was with corporate proxy blocking download from maven central etc\r\n\r\nEdit the proxies section in your maven settings.xml, which could be located in your ~/.m2/settings.xml file.\r\nSettings.xml also exists in your MAVEN_HOME, so ensure you are updating the correct settings.xml\r\n\r\n    &lt;settings&gt;\r\n    &lt;proxies&gt;\r\n        &lt;proxy&gt;\r\n            &lt;id&gt;httpproxy&lt;/id&gt;\r\n            &lt;active&gt;true&lt;/active&gt;\r\n            &lt;protocol&gt;http&lt;/protocol&gt;\r\n            &lt;host&gt;your-proxy-host&lt;/host&gt;\r\n            &lt;port&gt;your-proxy-port&lt;/port&gt;\r\n            &lt;nonProxyHosts&gt;add.host.that.needs.to.bypass.proxy.here|some.host.com&lt;/nonProxyHosts&gt;\r\n        &lt;/proxy&gt;\r\n    &lt;proxy&gt;\r\n            &lt;id&gt;httpsproxy&lt;/id&gt;\r\n            &lt;active&gt;true&lt;/active&gt;\r\n            &lt;protocol&gt;https&lt;/protocol&gt;\r\n            &lt;host&gt;your-proxy-host&lt;/host&gt;\r\n            &lt;port&gt;your-proxy-port&lt;/port&gt;\r\n            &lt;nonProxyHosts&gt;add.host.that.needs.to.bypass.proxy.here|some.host.com&lt;/nonProxyHosts&gt;\r\n        &lt;/proxy&gt;\r\n    \r\n    &lt;/proxies&gt;\r\n    &lt;/settings&gt;","title":"Maven Nexus Issue - Authorization failed for 403 Forbidden","body":"<p>The issue at the time was with corporate proxy blocking download from maven central etc</p>\n<p>Edit the proxies section in your maven settings.xml, which could be located in your ~/.m2/settings.xml file.\nSettings.xml also exists in your MAVEN_HOME, so ensure you are updating the correct settings.xml</p>\n<pre><code>&lt;settings&gt;\n&lt;proxies&gt;\n    &lt;proxy&gt;\n        &lt;id&gt;httpproxy&lt;/id&gt;\n        &lt;active&gt;true&lt;/active&gt;\n        &lt;protocol&gt;http&lt;/protocol&gt;\n        &lt;host&gt;your-proxy-host&lt;/host&gt;\n        &lt;port&gt;your-proxy-port&lt;/port&gt;\n        &lt;nonProxyHosts&gt;add.host.that.needs.to.bypass.proxy.here|some.host.com&lt;/nonProxyHosts&gt;\n    &lt;/proxy&gt;\n&lt;proxy&gt;\n        &lt;id&gt;httpsproxy&lt;/id&gt;\n        &lt;active&gt;true&lt;/active&gt;\n        &lt;protocol&gt;https&lt;/protocol&gt;\n        &lt;host&gt;your-proxy-host&lt;/host&gt;\n        &lt;port&gt;your-proxy-port&lt;/port&gt;\n        &lt;nonProxyHosts&gt;add.host.that.needs.to.bypass.proxy.here|some.host.com&lt;/nonProxyHosts&gt;\n    &lt;/proxy&gt;\n\n&lt;/proxies&gt;\n&lt;/settings&gt;\n</code></pre>\n"}],"owner":{"account_id":3992968,"reputation":1304,"user_id":3291266,"accept_rate":53,"display_name":"Mega"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":12034,"favorite_count":0,"down_vote_count":0,"up_vote_count":5,"answer_count":2,"score":5,"last_activity_date":1694293550,"creation_date":1578679677,"question_id":59686900,"body_markdown":"We have been on this issue for days now.\r\n\r\nCreated a Gitlab CI Pipeline for a Java App that reads dependencies from Maven and Nexus\r\n\r\nThe gitlab pipeline was configured to run as a nexus user with admin rights, this has been verified many times.\r\n\r\nBut, when the gitlab pipeline is executed we get the following error:\r\n     \r\n    [ERROR] Failed to execute goal on project hello-component: Could not resolve dependencies for project x.y.z:hello-component:jar:1.6-SNAPSHOT: Failed to collect dependencies at a.b:c:jar:4.5.1132100: Failed to read artifact descriptor for b:c:jar:4.5.1132100: Could not transfer artifact a.b:c:pom:4.5.1132100 from/to maven-snapshots (http://host:8081/repository/maven-snapshots): Authorization failed for http://host:8081/repository/maven-snapshots/a/b/c/4.5.1132100/nidp-4.5.1132100.pom 403 Forbidden -&gt; [Help 1]\r\n    org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal on project hello-component: Could not resolve dependencies for project x.y.z:hello-component:jar:1.6-SNAPSHOT: Failed to collect dependencies at a.b:c:jar:4.5.1132100\r\n\r\nI have also used the following guide:\r\n\r\n    https://blog.sonatype.com/how-to-use-gitlab-ci-with-nexus\r\n\r\nMy POM has the below, with env variables configured in ci/cd/settings/variables:\r\n\r\n         &lt;build&gt;\r\n                &lt;plugins&gt;\r\n                    &lt;plugin&gt;\r\n                        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n                        &lt;version&gt;3.8.0&lt;/version&gt;\r\n                        &lt;configuration&gt;\r\n                            &lt;source&gt;1.8&lt;/source&gt;\r\n                            &lt;target&gt;1.8&lt;/target&gt;\r\n                        &lt;/configuration&gt;\r\n                    &lt;/plugin&gt;\r\n                    &lt;plugin&gt;\r\n                        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                        &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\r\n                        &lt;version&gt;2.22.1&lt;/version&gt;\r\n                    &lt;/plugin&gt;\r\n                    &lt;plugin&gt;\r\n                        &lt;groupId&gt;org.sonatype.plugins&lt;/groupId&gt;\r\n                        &lt;artifactId&gt;nexus-staging-maven-plugin&lt;/artifactId&gt;\r\n                        &lt;version&gt;1.5.1&lt;/version&gt;\r\n                        &lt;executions&gt;\r\n                            &lt;execution&gt;\r\n                                &lt;id&gt;default-deploy&lt;/id&gt;\r\n                                &lt;phase&gt;deploy&lt;/phase&gt;\r\n                                &lt;goals&gt;\r\n                                    &lt;goal&gt;deploy&lt;/goal&gt;\r\n                                &lt;/goals&gt;\r\n                            &lt;/execution&gt;\r\n                        &lt;/executions&gt;\r\n                        &lt;configuration&gt;\r\n                            &lt;serverId&gt;maven-snapshots&lt;/serverId&gt;\r\n                            &lt;nexusUrl&gt;http://host:8081/repository/maven-snapshots&lt;/nexusUrl&gt;\r\n                            &lt;skipStaging&gt;true&lt;/skipStaging&gt;\r\n                        &lt;/configuration&gt;\r\n                    &lt;/plugin&gt;\r\n                &lt;/plugins&gt;\r\n            &lt;/build&gt;\r\n    \r\n    &lt;repositories&gt;\r\n            &lt;repository&gt;\r\n                &lt;id&gt;maven-snapshots&lt;/id&gt;\r\n                &lt;url&gt;http://host:8081/repository/maven-snapshots&lt;/url&gt;\r\n            &lt;/repository&gt;\r\n            &lt;repository&gt;\r\n                &lt;id&gt;maven-releases&lt;/id&gt;\r\n                &lt;url&gt;http://host:8081/repository/maven-releases&lt;/url&gt;\r\n            &lt;/repository&gt;\r\n            &lt;!--repository&gt;\r\n                &lt;id&gt;nexus.local&lt;/id&gt;\r\n                &lt;url&gt;$HOME/.m2/repository&lt;/url&gt;\r\n            &lt;/repository--&gt;\r\n        &lt;/repositories&gt;\r\n    \r\n        &lt;distributionManagement&gt;\r\n            &lt;snapshotRepository&gt;\r\n                &lt;id&gt;maven-snapshots&lt;/id&gt;\r\n                &lt;url&gt;http://host:8081/repository/maven-snapshots&lt;/url&gt;\r\n            &lt;/snapshotRepository&gt;\r\n            &lt;repository&gt;\r\n                &lt;id&gt;maven-releases&lt;/id&gt;\r\n                &lt;url&gt;http://host:8081/repository/maven-releases&lt;/url&gt;\r\n            &lt;/repository&gt;\r\n        &lt;/distributionManagement&gt;\r\n\r\nThe Gitlab CI runner has the following:\r\n\r\n    image: maven:3.3.9-jdk-8\r\n    \r\n    variables:\r\n      GIT_STRATEGY: clone\r\n      MAVEN_CLI_OPTS: &quot;-s /opt/apache-maven-3.6.3/conf/settings.xml --batch-mode&quot;\r\n      MAVEN_OPTS: &quot;-Dmaven.repo.local=/home/gitlab-runner/.m2/repository&quot;\r\n    \r\n    cache:\r\n      paths:\r\n        - /home/gitlab-runner/.m2/repository/\r\n        - target/\r\n     \r\n    stages:\r\n      - build\r\n    \r\n    CodeBuild:\r\n      stage: build\r\n      script:\r\n       - /opt/apache-maven-3.6.3/bin/mvn $MAVEN_CLI_OPTS -X clean package\r\n      artifacts:\r\n        name: “x—y-component&quot;\r\n        paths:\r\n          - ./target/x—y-component.jar\r\n\r\nSetting.xml on gitlab ci server has the following nexus user reference:\r\n\r\n&lt;server&gt;\r\n      &lt;id&gt;maven-snapshots&lt;/id&gt;\r\n      &lt;username&gt;[adminuser]&lt;/username&gt;\r\n      &lt;password&gt;[adminpassword]&lt;/password&gt;\r\n&lt;/server&gt;\r\n\r\nAny help will be most appreciated.\r\n\r\nThanks\r\n","title":"Maven Nexus Issue - Authorization failed for 403 Forbidden","body":"<p>We have been on this issue for days now.</p>\n\n<p>Created a Gitlab CI Pipeline for a Java App that reads dependencies from Maven and Nexus</p>\n\n<p>The gitlab pipeline was configured to run as a nexus user with admin rights, this has been verified many times.</p>\n\n<p>But, when the gitlab pipeline is executed we get the following error:</p>\n\n<pre><code>[ERROR] Failed to execute goal on project hello-component: Could not resolve dependencies for project x.y.z:hello-component:jar:1.6-SNAPSHOT: Failed to collect dependencies at a.b:c:jar:4.5.1132100: Failed to read artifact descriptor for b:c:jar:4.5.1132100: Could not transfer artifact a.b:c:pom:4.5.1132100 from/to maven-snapshots (http://host:8081/repository/maven-snapshots): Authorization failed for http://host:8081/repository/maven-snapshots/a/b/c/4.5.1132100/nidp-4.5.1132100.pom 403 Forbidden -&gt; [Help 1]\norg.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal on project hello-component: Could not resolve dependencies for project x.y.z:hello-component:jar:1.6-SNAPSHOT: Failed to collect dependencies at a.b:c:jar:4.5.1132100\n</code></pre>\n\n<p>I have also used the following guide:</p>\n\n<pre><code>https://blog.sonatype.com/how-to-use-gitlab-ci-with-nexus\n</code></pre>\n\n<p>My POM has the below, with env variables configured in ci/cd/settings/variables:</p>\n\n<pre><code>     &lt;build&gt;\n            &lt;plugins&gt;\n                &lt;plugin&gt;\n                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;3.8.0&lt;/version&gt;\n                    &lt;configuration&gt;\n                        &lt;source&gt;1.8&lt;/source&gt;\n                        &lt;target&gt;1.8&lt;/target&gt;\n                    &lt;/configuration&gt;\n                &lt;/plugin&gt;\n                &lt;plugin&gt;\n                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;2.22.1&lt;/version&gt;\n                &lt;/plugin&gt;\n                &lt;plugin&gt;\n                    &lt;groupId&gt;org.sonatype.plugins&lt;/groupId&gt;\n                    &lt;artifactId&gt;nexus-staging-maven-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;1.5.1&lt;/version&gt;\n                    &lt;executions&gt;\n                        &lt;execution&gt;\n                            &lt;id&gt;default-deploy&lt;/id&gt;\n                            &lt;phase&gt;deploy&lt;/phase&gt;\n                            &lt;goals&gt;\n                                &lt;goal&gt;deploy&lt;/goal&gt;\n                            &lt;/goals&gt;\n                        &lt;/execution&gt;\n                    &lt;/executions&gt;\n                    &lt;configuration&gt;\n                        &lt;serverId&gt;maven-snapshots&lt;/serverId&gt;\n                        &lt;nexusUrl&gt;http://host:8081/repository/maven-snapshots&lt;/nexusUrl&gt;\n                        &lt;skipStaging&gt;true&lt;/skipStaging&gt;\n                    &lt;/configuration&gt;\n                &lt;/plugin&gt;\n            &lt;/plugins&gt;\n        &lt;/build&gt;\n\n&lt;repositories&gt;\n        &lt;repository&gt;\n            &lt;id&gt;maven-snapshots&lt;/id&gt;\n            &lt;url&gt;http://host:8081/repository/maven-snapshots&lt;/url&gt;\n        &lt;/repository&gt;\n        &lt;repository&gt;\n            &lt;id&gt;maven-releases&lt;/id&gt;\n            &lt;url&gt;http://host:8081/repository/maven-releases&lt;/url&gt;\n        &lt;/repository&gt;\n        &lt;!--repository&gt;\n            &lt;id&gt;nexus.local&lt;/id&gt;\n            &lt;url&gt;$HOME/.m2/repository&lt;/url&gt;\n        &lt;/repository--&gt;\n    &lt;/repositories&gt;\n\n    &lt;distributionManagement&gt;\n        &lt;snapshotRepository&gt;\n            &lt;id&gt;maven-snapshots&lt;/id&gt;\n            &lt;url&gt;http://host:8081/repository/maven-snapshots&lt;/url&gt;\n        &lt;/snapshotRepository&gt;\n        &lt;repository&gt;\n            &lt;id&gt;maven-releases&lt;/id&gt;\n            &lt;url&gt;http://host:8081/repository/maven-releases&lt;/url&gt;\n        &lt;/repository&gt;\n    &lt;/distributionManagement&gt;\n</code></pre>\n\n<p>The Gitlab CI runner has the following:</p>\n\n<pre><code>image: maven:3.3.9-jdk-8\n\nvariables:\n  GIT_STRATEGY: clone\n  MAVEN_CLI_OPTS: \"-s /opt/apache-maven-3.6.3/conf/settings.xml --batch-mode\"\n  MAVEN_OPTS: \"-Dmaven.repo.local=/home/gitlab-runner/.m2/repository\"\n\ncache:\n  paths:\n    - /home/gitlab-runner/.m2/repository/\n    - target/\n\nstages:\n  - build\n\nCodeBuild:\n  stage: build\n  script:\n   - /opt/apache-maven-3.6.3/bin/mvn $MAVEN_CLI_OPTS -X clean package\n  artifacts:\n    name: “x—y-component\"\n    paths:\n      - ./target/x—y-component.jar\n</code></pre>\n\n<p>Setting.xml on gitlab ci server has the following nexus user reference:</p>\n\n<p>\n      maven-snapshots\n      [adminuser]\n      [adminpassword]\n</p>\n\n<p>Any help will be most appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":148782,"reputation":23519,"user_id":360811,"accept_rate":55,"display_name":"shabunc"},"score":7,"creation_date":1368618679,"post_id":4801794,"comment_id":23798313,"body_markdown":"Here&#39;s example of how it can be useful - http://stackoverflow.com/a/1239631/360811","body":"Here&#39;s example of how it can be useful - <a href=\"http://stackoverflow.com/a/1239631/360811\">stackoverflow.com/a/1239631/360811</a>"},{"owner":{"account_id":1144386,"reputation":28762,"user_id":1127485,"accept_rate":83,"display_name":"sschuberth"},"score":3,"creation_date":1442405043,"post_id":4801794,"comment_id":53067015,"body_markdown":"possible duplicate of [Arrays.asList() vs Collections.singletonList()](http://stackoverflow.com/questions/26027396/arrays-aslist-vs-collections-singletonlist)","body":"possible duplicate of <a href=\"http://stackoverflow.com/questions/26027396/arrays-aslist-vs-collections-singletonlist\">Arrays.asList() vs Collections.singletonList()</a>"},{"owner":{"account_id":7220692,"reputation":723,"user_id":5511336,"display_name":"KumarAnkit"},"score":5,"creation_date":1554287726,"post_id":4801794,"comment_id":97693209,"body_markdown":"@sschuberth, please compare the dates for the questions. OP was not aware s/he could be duplicating a future question","body":"@sschuberth, please compare the dates for the questions. OP was not aware s/he could be duplicating a future question"},{"owner":{"account_id":1144386,"reputation":28762,"user_id":1127485,"accept_rate":83,"display_name":"sschuberth"},"score":0,"creation_date":1554300669,"post_id":4801794,"comment_id":97701446,"body_markdown":"True, @KumarAnkit, but links to duplicates are still useful for people looking for alternative / potentially better answers. In fact I believe linking as duplicate should be regarded as a bidirectional thing, and the better questions / answers should be kept, no matter whether these are the older or newer.","body":"True, @KumarAnkit, but links to duplicates are still useful for people looking for alternative / potentially better answers. In fact I believe linking as duplicate should be regarded as a bidirectional thing, and the better questions / answers should be kept, no matter whether these are the older or newer."},{"owner":{"account_id":7220692,"reputation":723,"user_id":5511336,"display_name":"KumarAnkit"},"score":1,"creation_date":1554354585,"post_id":4801794,"comment_id":97721794,"body_markdown":"@sschuberth, good point, but it should be categorised as similar, as this question here.","body":"@sschuberth, good point, but it should be categorised as similar, as this question here."},{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1587458983,"post_id":4801794,"comment_id":108512422,"body_markdown":"@sschuberth - It is not bi-directional.  Closing a question as a duplicate prevents any more answers from being added to it.  So, if someone incorrectly dup-close a question just because it is related, they are actually blocking off potentially useful new contributions.","body":"@sschuberth - It is not bi-directional.  Closing a question as a duplicate prevents any more answers from being added to it.  So, if someone incorrectly dup-close a question just because it is related, they are actually blocking off potentially useful new contributions."}],"answers":[{"comments":[{"owner":{"account_id":372117,"reputation":2909,"user_id":1486762,"accept_rate":47,"display_name":"Bilbo Baggins"},"score":0,"creation_date":1474956457,"post_id":4801851,"comment_id":66731875,"body_markdown":"Can you help me understand this part of the above comment? &quot;Of course, this works best when the code processing the passed-in value does not need to add to the collection.&quot; I didn&#39;t get it.","body":"Can you help me understand this part of the above comment? &quot;Of course, this works best when the code processing the passed-in value does not need to add to the collection.&quot; I didn&#39;t get it."},{"owner":{"account_id":263441,"reputation":2404,"user_id":549003,"accept_rate":62,"display_name":"Daniel Higueras"},"score":2,"creation_date":1477639269,"post_id":4801851,"comment_id":67857668,"body_markdown":"I think he refers to not being able to modify the passed-in list, as it is an immutable one.","body":"I think he refers to not being able to modify the passed-in list, as it is an immutable one."},{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":3,"creation_date":1550145364,"post_id":4801851,"comment_id":96167230,"body_markdown":"@BilboBaggins - That statement was ironic.  :-)  The phrase &quot;this works best when ...&quot; is more accurately written &quot;this only works at all if ...&quot;.","body":"@BilboBaggins - That statement was ironic.  :-)  The phrase &quot;this works best when ...&quot; is more accurately written &quot;this only works at all if ...&quot;."}],"tags":[],"owner":{"account_id":19562,"reputation":30712,"user_id":45935,"accept_rate":100,"display_name":"Jim Ferrans"},"comment_count":3,"down_vote_count":0,"up_vote_count":32,"is_accepted":false,"score":32,"last_activity_date":1296022759,"creation_date":1296022759,"answer_id":4801851,"question_id":4801794,"body_markdown":"Here&#39;s one [view][1] on the singleton methods:\r\n\r\n&gt; I have found these various &quot;singleton&quot; methods to be useful for passing a single value to an API that requires a collection of that value. Of course, this works best when the code processing the passed-in value does not need to add to the collection.\r\n\r\n\r\n  [1]: http://marxsoftware.blogspot.com/p/my-publications.html","title":"Use of Java&#39;s Collections.singletonList()?","body":"<p>Here's one <a href=\"http://marxsoftware.blogspot.com/p/my-publications.html\" rel=\"noreferrer\">view</a> on the singleton methods:</p>\n\n<blockquote>\n  <p>I have found these various \"singleton\" methods to be useful for passing a single value to an API that requires a collection of that value. Of course, this works best when the code processing the passed-in value does not need to add to the collection.</p>\n</blockquote>\n"},{"comments":[{"owner":{"account_id":796053,"reputation":115361,"user_id":878126,"accept_rate":51,"display_name":"android developer"},"score":0,"creation_date":1676460682,"post_id":4801854,"comment_id":133139837,"body_markdown":"Why is it named &quot;singleton&quot; ? Because it has a single item inside? It&#39;s quite confusing as &quot;singleton&quot; is supposed to be of single instance globally, yet you can create multiple instances of such a list (whether of same object within, or other objects)...","body":"Why is it named &quot;singleton&quot; ? Because it has a single item inside? It&#39;s quite confusing as &quot;singleton&quot; is supposed to be of single instance globally, yet you can create multiple instances of such a list (whether of same object within, or other objects)..."},{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":1,"creation_date":1676469111,"post_id":4801854,"comment_id":133142449,"body_markdown":"It comes from Mathematics: &quot;Singleton ... 5: Mathematics. a set consisting of one given element.&quot; source: https://www.dictionary.com/browse/singleton .   Also https://en.wikipedia.org/wiki/Singleton_(mathematics).","body":"It comes from Mathematics: &quot;Singleton ... 5: Mathematics. a set consisting of one given element.&quot; source: <a href=\"https://www.dictionary.com/browse/singleton\" rel=\"nofollow noreferrer\">dictionary.com/browse/singleton</a> .   Also <a href=\"https://en.wikipedia.org/wiki/Singleton_(mathematics)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Singleton_(mathematics)</a>."},{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1676469569,"post_id":4801854,"comment_id":133142621,"body_markdown":"And note that the Wikipedia article cites Principia Mathematica (1910) as a source.   So the mathematical definition has &quot;first use&quot; rights for the term relative to Go4 design patterns, etc.","body":"And note that the Wikipedia article cites Principia Mathematica (1910) as a source.   So the mathematical definition has &quot;first use&quot; rights for the term relative to Go4 design patterns, etc."},{"owner":{"account_id":796053,"reputation":115361,"user_id":878126,"accept_rate":51,"display_name":"android developer"},"score":0,"creation_date":1676556335,"post_id":4801854,"comment_id":133163540,"body_markdown":"I see. I thought &quot;singleton&quot; is in the same meaning of &quot;Singleton design pattern&quot;, meaning only up to one instance of it. Seems confusing name now. All this time I thought this is the meaning. Now it has 2 different (yet a bit similar ) meanings...","body":"I see. I thought &quot;singleton&quot; is in the same meaning of &quot;Singleton design pattern&quot;, meaning only up to one instance of it. Seems confusing name now. All this time I thought this is the meaning. Now it has 2 different (yet a bit similar ) meanings..."},{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1676556573,"post_id":4801854,"comment_id":133163624,"body_markdown":"*&quot;There&#39;s a sign on the wall - \nBut she wants to be sure -\n&#39;Cause you know, sometimes words have two meanings&quot;* - Led Zeppelin","body":"<i>&quot;There&#39;s a sign on the wall -  But she wants to be sure - &#39;Cause you know, sometimes words have two meanings&quot;</i> - Led Zeppelin"}],"tags":[],"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"comment_count":5,"down_vote_count":0,"up_vote_count":195,"is_accepted":true,"score":195,"last_activity_date":1675847631,"creation_date":1296022774,"answer_id":4801854,"question_id":4801794,"body_markdown":"The [javadoc][1] says this:\r\n\r\n&gt; *&quot;Returns an immutable list containing only the specified object. The returned list is serializable.&quot;*\r\n\r\nYou ask:\r\n\r\n&gt; Why would I want to have a separate method to do that?\r\n\r\nPrimarily as a convenience ... to save you having to write a sequence of statements to:\r\n\r\n  - create an empty list object\r\n  - add an element to it, and\r\n  - wrap it with an immutable wrapper.\r\n\r\nIt may also be a bit faster and/or save a bit of memory, but it is unlikely that these small savings will be significant.  (An application that creates vast numbers of singleton lists is unusual to say the least.) \r\n\r\n&gt; How does immutability play a role here?\r\n\r\nIt is part of the specification of the method; see above.\r\n\r\n&gt; Are there any special useful use-cases for this method, rather than just being a convenience method?\r\n\r\nClearly, there are use-cases where it is convenient to use the `singletonList` method.  Indeed, *any* program where you need to use an immutable list with one element is a valid use-case.  (It takes roughly zero imagination to think of one.)\r\n\r\nBut I don&#39;t know how you would (objectively) distinguish between an ordinary use-case and a &quot;specially useful&quot; one ... \r\n\r\n  [1]: http://download.oracle.com/javase/6/docs/api/java/util/Collections.html#singletonList(T)","title":"Use of Java&#39;s Collections.singletonList()?","body":"<p>The <a href=\"http://download.oracle.com/javase/6/docs/api/java/util/Collections.html#singletonList(T)\" rel=\"noreferrer\">javadoc</a> says this:</p>\n<blockquote>\n<p><em>&quot;Returns an immutable list containing only the specified object. The returned list is serializable.&quot;</em></p>\n</blockquote>\n<p>You ask:</p>\n<blockquote>\n<p>Why would I want to have a separate method to do that?</p>\n</blockquote>\n<p>Primarily as a convenience ... to save you having to write a sequence of statements to:</p>\n<ul>\n<li>create an empty list object</li>\n<li>add an element to it, and</li>\n<li>wrap it with an immutable wrapper.</li>\n</ul>\n<p>It may also be a bit faster and/or save a bit of memory, but it is unlikely that these small savings will be significant.  (An application that creates vast numbers of singleton lists is unusual to say the least.)</p>\n<blockquote>\n<p>How does immutability play a role here?</p>\n</blockquote>\n<p>It is part of the specification of the method; see above.</p>\n<blockquote>\n<p>Are there any special useful use-cases for this method, rather than just being a convenience method?</p>\n</blockquote>\n<p>Clearly, there are use-cases where it is convenient to use the <code>singletonList</code> method.  Indeed, <em>any</em> program where you need to use an immutable list with one element is a valid use-case.  (It takes roughly zero imagination to think of one.)</p>\n<p>But I don't know how you would (objectively) distinguish between an ordinary use-case and a &quot;specially useful&quot; one ...</p>\n"},{"comments":[{"owner":{"account_id":3533121,"reputation":1545,"user_id":2952093,"accept_rate":88,"display_name":"kap"},"score":0,"creation_date":1409702965,"post_id":10942995,"comment_id":40051543,"body_markdown":"Create an Unmodifiable Collection with one object the &quot;normal&quot; way and using the singleton method. Then you see immediately why.","body":"Create an Unmodifiable Collection with one object the &quot;normal&quot; way and using the singleton method. Then you see immediately why."}],"tags":[],"owner":{"account_id":1551372,"reputation":31,"user_id":1443673,"display_name":"Anonumous"},"comment_count":1,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1339128995,"creation_date":1339128995,"answer_id":10942995,"question_id":4801794,"body_markdown":"If an Immutable/Singleton collections refers to the one which having only one object and which is not further gets modified, then the same functionality can be achieved by making a collection &quot;UnmodifiableCollection&quot; having only one object. Since the same functionality can be achieved by Unmodifiable Collection with one object, then what special purpose the Singleton Collection serves for?","title":"Use of Java&#39;s Collections.singletonList()?","body":"<p>If an Immutable/Singleton collections refers to the one which having only one object and which is not further gets modified, then the same functionality can be achieved by making a collection \"UnmodifiableCollection\" having only one object. Since the same functionality can be achieved by Unmodifiable Collection with one object, then what special purpose the Singleton Collection serves for?</p>\n"},{"comments":[{"owner":{"account_id":7929172,"reputation":1797,"user_id":6059506,"accept_rate":77,"display_name":"theprogrammer"},"score":3,"creation_date":1585925215,"post_id":31089004,"comment_id":107944121,"body_markdown":"Thanks, this is the better answer. You even give an example instead of simply saying &quot;Clearly there are use cases, but I don&#39;t know about them&quot;.","body":"Thanks, this is the better answer. You even give an example instead of simply saying &quot;Clearly there are use cases, but I don&#39;t know about them&quot;."}],"tags":[],"owner":{"account_id":5319468,"reputation":1975,"user_id":4243316,"accept_rate":0,"display_name":"salsinga"},"comment_count":1,"down_vote_count":0,"up_vote_count":33,"is_accepted":false,"score":33,"last_activity_date":1576543051,"creation_date":1435409649,"answer_id":31089004,"question_id":4801794,"body_markdown":"From the javadoc\r\n\r\n    @param  the sole object to be stored in the returned list.\r\n    @return an immutable list containing only the specified object.\r\n    \r\nexample    \r\n\r\n    import java.util.*;\r\n\r\n    public class HelloWorld {\r\n        public static void main(String args[]) {\r\n            // create an array of string objs\r\n            String initList[] = { &quot;One&quot;, &quot;Two&quot;, &quot;Four&quot;, &quot;One&quot;,};\r\n            \r\n            // create one list\r\n            List list = new ArrayList(Arrays.asList(initList));\r\n            \r\n            System.out.println(&quot;List value before: &quot;+list);\r\n            \r\n            // create singleton list\r\n            list = Collections.singletonList(&quot;OnlyOneElement&quot;);\r\n            list.add(&quot;five&quot;); //throws UnsupportedOperationException\r\n            System.out.println(&quot;List value after: &quot;+list);\r\n        }\r\n    }\r\n\r\nUse it when  code expects a read-only list, but you only want to pass one element in it. `singletonList` is (thread-)safe and fast.\r\n","title":"Use of Java&#39;s Collections.singletonList()?","body":"<p>From the javadoc</p>\n\n<pre><code>@param  the sole object to be stored in the returned list.\n@return an immutable list containing only the specified object.\n</code></pre>\n\n<p>example    </p>\n\n<pre><code>import java.util.*;\n\npublic class HelloWorld {\n    public static void main(String args[]) {\n        // create an array of string objs\n        String initList[] = { \"One\", \"Two\", \"Four\", \"One\",};\n\n        // create one list\n        List list = new ArrayList(Arrays.asList(initList));\n\n        System.out.println(\"List value before: \"+list);\n\n        // create singleton list\n        list = Collections.singletonList(\"OnlyOneElement\");\n        list.add(\"five\"); //throws UnsupportedOperationException\n        System.out.println(\"List value after: \"+list);\n    }\n}\n</code></pre>\n\n<p>Use it when  code expects a read-only list, but you only want to pass one element in it. <code>singletonList</code> is (thread-)safe and fast.</p>\n"},{"tags":[],"owner":{"account_id":13338050,"reputation":484,"user_id":9627242,"display_name":"ajain"},"comment_count":0,"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1576542880,"creation_date":1523545941,"answer_id":49800120,"question_id":4801794,"body_markdown":"To answer your immutable question: \r\n\r\n[`Collections.singletonList`](https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/util/Collections.html#singletonList(T)) will create an immutable List.\r\nAn immutable List (also referred to as an unmodifiable List) cannot have it&#39;s contents changed. The methods to add or remove items will throw exceptions if you try to alter the contents.\r\n\r\nA singleton List contains only that item and cannot be altered.","title":"Use of Java&#39;s Collections.singletonList()?","body":"<p>To answer your immutable question: </p>\n\n<p><a href=\"https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/util/Collections.html#singletonList(T)\" rel=\"noreferrer\"><code>Collections.singletonList</code></a> will create an immutable List.\nAn immutable List (also referred to as an unmodifiable List) cannot have it's contents changed. The methods to add or remove items will throw exceptions if you try to alter the contents.</p>\n\n<p>A singleton List contains only that item and cannot be altered.</p>\n"},{"tags":[],"owner":{"account_id":1704646,"reputation":442,"user_id":1563969,"display_name":"Sarang"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1566582308,"creation_date":1566582308,"answer_id":57630885,"question_id":4801794,"body_markdown":"singletonList can hold instance of any object. Object state can be modify.\r\n\r\n    List&lt;Character&gt; list = new ArrayList&lt;Character&gt;();\r\n    list.add(&#39;X&#39;);\r\n    list.add(&#39;Y&#39;);\r\n    System.out.println(&quot;Initial list: &quot;+ list);\r\n    List&lt;List&lt;Character&gt;&gt; list2 = Collections.singletonList(list);\r\n    list.add(&#39;Z&#39;);\r\n    System.out.println(list);\r\n    System.out.println(list2);\r\n\r\nWe can not define unmodifiableList like above.\r\n\r\n","title":"Use of Java&#39;s Collections.singletonList()?","body":"<p>singletonList can hold instance of any object. Object state can be modify.</p>\n\n<pre><code>List&lt;Character&gt; list = new ArrayList&lt;Character&gt;();\nlist.add('X');\nlist.add('Y');\nSystem.out.println(\"Initial list: \"+ list);\nList&lt;List&lt;Character&gt;&gt; list2 = Collections.singletonList(list);\nlist.add('Z');\nSystem.out.println(list);\nSystem.out.println(list2);\n</code></pre>\n\n<p>We can not define unmodifiableList like above.</p>\n"},{"comments":[{"owner":{"account_id":9842376,"reputation":537,"user_id":7465516,"display_name":"julaine"},"score":0,"creation_date":1701096557,"post_id":77074044,"comment_id":136729217,"body_markdown":"This is so much more readable as it uses a method that everyone knows and doesn&#39;t throw around the word &#39;Singleton&#39; for no reason.","body":"This is so much more readable as it uses a method that everyone knows and doesn&#39;t throw around the word &#39;Singleton&#39; for no reason."}],"tags":[],"owner":{"account_id":16363184,"reputation":326,"user_id":11818269,"display_name":"mouad36"},"comment_count":1,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1694293469,"creation_date":1694293469,"answer_id":77074044,"question_id":4801794,"body_markdown":"it&#39;s for creating an immutable list containing only the specified object.\r\n\r\n**As of Java 9**, use one of the ***of*** methods instead for creating immutable list of the given elements.\r\nexample : \r\n\r\n```lang-java\r\n    List&lt;Car&gt; singletonCarList = List.of(new Car());\r\n```","title":"Use of Java&#39;s Collections.singletonList()?","body":"<p>it's for creating an immutable list containing only the specified object.</p>\n<p><strong>As of Java 9</strong>, use one of the <em><strong>of</strong></em> methods instead for creating immutable list of the given elements.\nexample :</p>\n<pre class=\"lang-java prettyprint-override\"><code>    List&lt;Car&gt; singletonCarList = List.of(new Car());\n</code></pre>\n"}],"owner":{"account_id":20344,"reputation":46577,"user_id":2288585,"accept_rate":60,"display_name":"Debajit"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":234702,"favorite_count":0,"down_vote_count":2,"up_vote_count":224,"accepted_answer_id":4801854,"answer_count":7,"score":222,"last_activity_date":1694293469,"creation_date":1296021749,"question_id":4801794,"body_markdown":"What is the use of `Collections.singletonList()` in Java? I understand that it returns a list with one element. Why would I want to have a separate method to do that? How does immutability play a role here?\r\n\r\nAre there any special useful use-cases for this method rather than just being a convenient method?","title":"Use of Java&#39;s Collections.singletonList()?","body":"<p>What is the use of <code>Collections.singletonList()</code> in Java? I understand that it returns a list with one element. Why would I want to have a separate method to do that? How does immutability play a role here?</p>\n\n<p>Are there any special useful use-cases for this method rather than just being a convenient method?</p>\n"},{"tags":["java","spring-boot","amazon-s3","io","awss3transfermanager"],"comments":[{"owner":{"account_id":2994830,"reputation":1,"user_id":2541560,"display_name":"Kayaman"},"score":0,"creation_date":1694292486,"post_id":77073919,"comment_id":135873055,"body_markdown":"How did you determine the `PrintWriter` wasn&#39;t being closed? That also shouldn&#39;t prevent a shutdown.","body":"How did you determine the <code>PrintWriter</code> wasn&#39;t being closed? That also shouldn&#39;t prevent a shutdown."},{"owner":{"account_id":18758024,"reputation":1,"user_id":13677567,"display_name":"Shaggy"},"score":0,"creation_date":1694292725,"post_id":77073919,"comment_id":135873068,"body_markdown":"When I comment out the PrintWriter code , the application went down","body":"When I comment out the PrintWriter code , the application went down"},{"owner":{"account_id":2994830,"reputation":1,"user_id":2541560,"display_name":"Kayaman"},"score":0,"creation_date":1694325071,"post_id":77073919,"comment_id":135874831,"body_markdown":"Well, why don&#39;t you profile the application and get some better insight than that.","body":"Well, why don&#39;t you profile the application and get some better insight than that."}],"owner":{"account_id":18758024,"reputation":1,"user_id":13677567,"display_name":"Shaggy"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":38,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694291437,"creation_date":1694290712,"question_id":77073919,"body_markdown":"So I am making an archiver application using Spring boot, whenever application should start, fetch data from database , uploads to S3 and it should goes down automatically.\r\n\r\nSo, I used below property in application.yml\r\n\r\n\r\n```\r\nspring:\r\n   main:\r\n    web-application-type: none\r\n```\r\n\r\nand It was working as excepted like, Whenever my application starts  : It makes the S3 client, establish the Database connection , fetch data from Database using Hibernate , uploads into S3 using **PutObject** and goes down.\r\n\r\nLogs:\r\n\r\n```\r\n2023-09-10 01:04:51.578  INFO 14992 --- [           main] c.j.m.s.ArchiverBusinessServiceImpl  : Archiver process completed with status SUCCESS\r\n2023-09-10 01:04:51.592  INFO 14992 --- [ionShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit &#39;default&#39;\r\n2023-09-10 01:04:51.595  INFO 14992 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...\r\n2023-09-10 01:04:55.606  INFO 14992 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.\r\n\r\nProcess finished with exit code 0\r\n```\r\n\r\nbut recently, to improve an S3 performance (Since I am uploading around 1-2 millions files at one time), I started using transfer manager.\r\nSo, Now application fetch data from database , crates a files in directory, use that directory for transfer manager for bulk upload in s3.\r\n\r\nProblem is , everything works as expected only this time application is not going down.\r\nIts just stops at \r\n\r\n```\r\n2023-09-10 01:04:51.578  INFO 14992 --- [           main] c.j.m.s.ArchiverBusinessServiceImpl  : Archiver process completed with status SUCCESS\r\n```\r\n\r\nso, when I did some analysis , looks like PrintWriter (used for creating files ) causing this issue i.e Its not getting closed when operation ends.\r\n\r\nHowever, I am closing printwriter using try-with-resource, tried with close() method as well.\r\n\r\nNeed an assist to resolve this.\r\n\r\nHere is the code snippet:\r\n\r\nfor creating a files\r\n\r\n```\r\npublic void storeFile(KeyEntity keyEntity, List&lt;JsonObject&gt; jsonObjects, String archiveDate) {\r\n\r\n        String fileName= getFileName(archiveDate,keyEntity);\r\n        String path = ArchiveProperties.getFileUploadPath();\r\n        Path dir= Paths.get(path);\r\n\r\n        if(!Files.exists(dir)){\r\n            try {\r\n                Files.createDirectories(dir);\r\n            } catch (IOException e) {\r\n                log.error(&quot;Exception occurred while creating directory {}&quot;,ArchiveProperties.getFileUploadPath());\r\n                throw new RuntimeException(e);\r\n            }\r\n        }\r\n        Path file = Paths.get(path,fileName);\r\n        try(PrintWriter printWriter = new PrintWriter(new FileWriter(file.toFile()))){\r\n            printWriter.print(jsonObjects);\r\n        } catch (IOException e) {\r\n            log.error(&quot;Exception occurred while writing into directory {} for filename {}&quot;, ArchiveProperties.getFileUploadPath(), fileName);\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n```\r\n\r\nDirectory upload using transfer Manager:\r\n\r\n```\r\npublic Boolean bulkUpload(String path, S3Properties s3Properties,String filePrefix){\r\n\r\n        log.info(&quot;S3ObjectStore:bulkUpload :: Initialing bulk upload for path {}&quot;,path);\r\n\r\n        AmazonS3Client s3 = S3Configuration.getS3Client(provider,s3Properties);\r\n        TransferManager transferManager = TransferManagerBuilder.standard().withS3Client(s3).build();\r\n        try {\r\n\r\n            MultipleFileUpload multipleFileUpload = transferManager.uploadDirectory(s3Properties.getBucket(),filePrefix,new File(path),false);\r\n            showTransferProgress(multipleFileUpload);\r\n            multipleFileUpload.waitForCompletion();\r\n\r\n        }\r\n        catch ( Exception e) {\r\n            log.error(&quot;S3ObjectStore:bulkUpload :: Exception occurred while uploading directory to s3&quot;,e);\r\n            return Boolean.FALSE;\r\n        }finally {\r\n            transferManager.shutdownNow();\r\n          \r\n        }\r\n        return Boolean.TRUE;\r\n    }\r\n\r\n```\r\n\r\n\r\n```\r\npublic static AmazonS3Client getS3Client(final IdaS3ClientKeysProvider provider, final S3Properties s3Properties){\r\n\r\n        log.info(&quot;Creating AmazonS3Client for bulk upload ..............&quot;);\r\n        IdaS3ClientKeysProvider idaS3ClientKeysProvider = provider;\r\n        //Set up the connection configuration\r\n        ClientConfiguration config = new ClientConfiguration().withRetryPolicy(ClientConfiguration.DEFAULT_RETRY_POLICY);\r\n        //DEFAULT_RETRY_POLICY=3 times retry for failure files\r\n        config.setProtocol(Protocol.HTTPS);\r\n        config.setSignerOverride(&quot;S3SignerType&quot;);\r\n        //Set up the AWS credentials\r\n        BasicAWSCredentials credentials = new BasicAWSCredentials(idaS3ClientKeysProvider.getS3Keys().getS3AccessKey(),idaS3ClientKeysProvider.getS3Keys().getS3SecretKey());\r\n        //Set up AWS Client\r\n        AmazonS3Client client = new AmazonS3Client(credentials,config);\r\n        client.setS3ClientOptions(S3ClientOptions.builder().setPathStyleAccess(true).build());\r\n        client.setEndpoint(s3Properties.getDataplaneEndpoint());\r\n        log.info(&quot;Inside AmazonS3Client :: access key :{}, secret key :{}&quot;,provider.getS3Keys().getS3AccessKey(),provider.getS3Keys().getS3SecretKey());\r\n        return client;\r\n    }\r\n```\r\n\r\n \r\n\r\n\r\n\r\nExpecting: Application should go down/ shutdown automatically\r\n","title":"How to check if any IO stream is open and forcefully close it in Java","body":"<p>So I am making an archiver application using Spring boot, whenever application should start, fetch data from database , uploads to S3 and it should goes down automatically.</p>\n<p>So, I used below property in application.yml</p>\n<pre><code>spring:\n   main:\n    web-application-type: none\n</code></pre>\n<p>and It was working as excepted like, Whenever my application starts  : It makes the S3 client, establish the Database connection , fetch data from Database using Hibernate , uploads into S3 using <strong>PutObject</strong> and goes down.</p>\n<p>Logs:</p>\n<pre><code>2023-09-10 01:04:51.578  INFO 14992 --- [           main] c.j.m.s.ArchiverBusinessServiceImpl  : Archiver process completed with status SUCCESS\n2023-09-10 01:04:51.592  INFO 14992 --- [ionShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'\n2023-09-10 01:04:51.595  INFO 14992 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...\n2023-09-10 01:04:55.606  INFO 14992 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.\n\nProcess finished with exit code 0\n</code></pre>\n<p>but recently, to improve an S3 performance (Since I am uploading around 1-2 millions files at one time), I started using transfer manager.\nSo, Now application fetch data from database , crates a files in directory, use that directory for transfer manager for bulk upload in s3.</p>\n<p>Problem is , everything works as expected only this time application is not going down.\nIts just stops at</p>\n<pre><code>2023-09-10 01:04:51.578  INFO 14992 --- [           main] c.j.m.s.ArchiverBusinessServiceImpl  : Archiver process completed with status SUCCESS\n</code></pre>\n<p>so, when I did some analysis , looks like PrintWriter (used for creating files ) causing this issue i.e Its not getting closed when operation ends.</p>\n<p>However, I am closing printwriter using try-with-resource, tried with close() method as well.</p>\n<p>Need an assist to resolve this.</p>\n<p>Here is the code snippet:</p>\n<p>for creating a files</p>\n<pre><code>public void storeFile(KeyEntity keyEntity, List&lt;JsonObject&gt; jsonObjects, String archiveDate) {\n\n        String fileName= getFileName(archiveDate,keyEntity);\n        String path = ArchiveProperties.getFileUploadPath();\n        Path dir= Paths.get(path);\n\n        if(!Files.exists(dir)){\n            try {\n                Files.createDirectories(dir);\n            } catch (IOException e) {\n                log.error(&quot;Exception occurred while creating directory {}&quot;,ArchiveProperties.getFileUploadPath());\n                throw new RuntimeException(e);\n            }\n        }\n        Path file = Paths.get(path,fileName);\n        try(PrintWriter printWriter = new PrintWriter(new FileWriter(file.toFile()))){\n            printWriter.print(jsonObjects);\n        } catch (IOException e) {\n            log.error(&quot;Exception occurred while writing into directory {} for filename {}&quot;, ArchiveProperties.getFileUploadPath(), fileName);\n            throw new RuntimeException(e);\n        }\n    }\n</code></pre>\n<p>Directory upload using transfer Manager:</p>\n<pre><code>public Boolean bulkUpload(String path, S3Properties s3Properties,String filePrefix){\n\n        log.info(&quot;S3ObjectStore:bulkUpload :: Initialing bulk upload for path {}&quot;,path);\n\n        AmazonS3Client s3 = S3Configuration.getS3Client(provider,s3Properties);\n        TransferManager transferManager = TransferManagerBuilder.standard().withS3Client(s3).build();\n        try {\n\n            MultipleFileUpload multipleFileUpload = transferManager.uploadDirectory(s3Properties.getBucket(),filePrefix,new File(path),false);\n            showTransferProgress(multipleFileUpload);\n            multipleFileUpload.waitForCompletion();\n\n        }\n        catch ( Exception e) {\n            log.error(&quot;S3ObjectStore:bulkUpload :: Exception occurred while uploading directory to s3&quot;,e);\n            return Boolean.FALSE;\n        }finally {\n            transferManager.shutdownNow();\n          \n        }\n        return Boolean.TRUE;\n    }\n\n</code></pre>\n<pre><code>public static AmazonS3Client getS3Client(final IdaS3ClientKeysProvider provider, final S3Properties s3Properties){\n\n        log.info(&quot;Creating AmazonS3Client for bulk upload ..............&quot;);\n        IdaS3ClientKeysProvider idaS3ClientKeysProvider = provider;\n        //Set up the connection configuration\n        ClientConfiguration config = new ClientConfiguration().withRetryPolicy(ClientConfiguration.DEFAULT_RETRY_POLICY);\n        //DEFAULT_RETRY_POLICY=3 times retry for failure files\n        config.setProtocol(Protocol.HTTPS);\n        config.setSignerOverride(&quot;S3SignerType&quot;);\n        //Set up the AWS credentials\n        BasicAWSCredentials credentials = new BasicAWSCredentials(idaS3ClientKeysProvider.getS3Keys().getS3AccessKey(),idaS3ClientKeysProvider.getS3Keys().getS3SecretKey());\n        //Set up AWS Client\n        AmazonS3Client client = new AmazonS3Client(credentials,config);\n        client.setS3ClientOptions(S3ClientOptions.builder().setPathStyleAccess(true).build());\n        client.setEndpoint(s3Properties.getDataplaneEndpoint());\n        log.info(&quot;Inside AmazonS3Client :: access key :{}, secret key :{}&quot;,provider.getS3Keys().getS3AccessKey(),provider.getS3Keys().getS3SecretKey());\n        return client;\n    }\n</code></pre>\n<p>Expecting: Application should go down/ shutdown automatically</p>\n"},{"tags":["java","java.util.logging","printstacktrace"],"answers":[{"comments":[{"owner":{"account_id":4139900,"reputation":61,"user_id":3395540,"display_name":"Adam Kaye-Smith"},"score":0,"creation_date":1597458523,"post_id":63406670,"comment_id":112147242,"body_markdown":"Thank-you very much for your answer.","body":"Thank-you very much for your answer."},{"owner":{"account_id":4139900,"reputation":61,"user_id":3395540,"display_name":"Adam Kaye-Smith"},"score":0,"creation_date":1597458614,"post_id":63406670,"comment_id":112147251,"body_markdown":"But , the stack trace is not coming from any of my catch&#39;s and e.printStackTrace. It only seems to come when I include the 2 lines : -","body":"But , the stack trace is not coming from any of my catch&#39;s and e.printStackTrace. It only seems to come when I include the 2 lines : -"},{"owner":{"account_id":4139900,"reputation":61,"user_id":3395540,"display_name":"Adam Kaye-Smith"},"score":0,"creation_date":1597458640,"post_id":63406670,"comment_id":112147253,"body_markdown":"java.util.logging.Logger.getLogger(&quot;com.gargoylesoftware.htmlunit&quot;).setLevel(java.util.logging.Level.OFF);\n\njava.util.logging.Logger.getLogger(&quot;org.apache.http&quot;).setLevel(java.util.logging.Level.OFF);","body":"java.util.logging.Logger.getLogger(&quot;com.gargoylesoftware.htm&zwnj;&#8203;lunit&quot;).setLevel(jav&zwnj;&#8203;a.util.logging.Level&zwnj;&#8203;.OFF);  java.util.logging.Logger.getLogger(&quot;org.apache.http&quot;).setLev&zwnj;&#8203;el(java.util.logging&zwnj;&#8203;.Level.OFF);"},{"owner":{"account_id":4139900,"reputation":61,"user_id":3395540,"display_name":"Adam Kaye-Smith"},"score":0,"creation_date":1597458725,"post_id":63406670,"comment_id":112147262,"body_markdown":"But these 2 lines seem to be  only printing half the stacktrace - I would love to add code so that the full stack trace is being printed.","body":"But these 2 lines seem to be  only printing half the stacktrace - I would love to add code so that the full stack trace is being printed."},{"owner":{"account_id":4139900,"reputation":61,"user_id":3395540,"display_name":"Adam Kaye-Smith"},"score":0,"creation_date":1597578498,"post_id":63406670,"comment_id":112173037,"body_markdown":"Have edited the original question to add the code - as suggested by the above answer","body":"Have edited the original question to add the code - as suggested by the above answer"}],"tags":[],"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"comment_count":5,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1597465645,"creation_date":1597380223,"answer_id":63406670,"question_id":63406604,"body_markdown":"The &quot;Caused by&quot; means that this is a nested exception.\r\n\r\nThe &quot;... 30 more&quot; in a nested exception stacktrace means that those 30 lines are the same as in the primary exception.\r\n\r\nSo just look at the primary stacktrace to see those stack frames.\r\n\r\n------------------------\r\n\r\nApparently your exception stacktraces are being generated in a way that is suppressing (or removing) the primary exception stacktrace.  This is puzzling, but it is probably being done by one of the unit testing libraries that you are using.\r\n\r\nGetting to the bottom of this will probably involve you either debugging whatever it is that is generating the stacktrace, or writing a [minimal reproducible example](https://stackoverflow.com/help/minimal-reproducible-example) so that someone else can debug it.\r\n\r\n","title":"In Java - how do I get a full stack trace","body":"<p>The &quot;Caused by&quot; means that this is a nested exception.</p>\n<p>The &quot;... 30 more&quot; in a nested exception stacktrace means that those 30 lines are the same as in the primary exception.</p>\n<p>So just look at the primary stacktrace to see those stack frames.</p>\n<hr />\n<p>Apparently your exception stacktraces are being generated in a way that is suppressing (or removing) the primary exception stacktrace.  This is puzzling, but it is probably being done by one of the unit testing libraries that you are using.</p>\n<p>Getting to the bottom of this will probably involve you either debugging whatever it is that is generating the stacktrace, or writing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so that someone else can debug it.</p>\n"}],"owner":{"account_id":4139900,"reputation":61,"user_id":3395540,"display_name":"Adam Kaye-Smith"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":361,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1694290560,"creation_date":1597379715,"question_id":63406604,"body_markdown":"Currently I get the following output from code run\r\n```\r\nCaused by: java.lang.NullPointerException\r\n\tat com.gargoylesoftware.htmlunit.html.HtmlScript$2.execute(HtmlScript.java:227)\r\n\tat com.gargoylesoftware.htmlunit.html.HtmlScript.onAllChildrenAddedToPage(HtmlScript.java:256)\r\n\tat com.gargoylesoftware.htmlunit.html.parser.neko.HtmlUnitNekoDOMBuilder.endElement(HtmlUnitNekoDOMBuilder.java:560)\r\n\tat org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)\r\n\tat com.gargoylesoftware.htmlunit.html.parser.neko.HtmlUnitNekoDOMBuilder.endElement(HtmlUnitNekoDOMBuilder.java:514)\r\n\tat net.sourceforge.htmlunit.cyberneko.HTMLTagBalancer.callEndElement(HTMLTagBalancer.java:1192)\r\n\tat net.sourceforge.htmlunit.cyberneko.HTMLTagBalancer.endElement(HTMLTagBalancer.java:1132)\r\n\tat net.sourceforge.htmlunit.cyberneko.filters.DefaultFilter.endElement(DefaultFilter.java:219)\r\n\tat net.sourceforge.htmlunit.cyberneko.filters.NamespaceBinder.endElement(NamespaceBinder.java:312)\r\n\tat net.sourceforge.htmlunit.cyberneko.HTMLScanner$ContentScanner.scanEndElement(HTMLScanner.java:3189)\r\n\tat net.sourceforge.htmlunit.cyberneko.HTMLScanner$ContentScanner.scan(HTMLScanner.java:2114)\r\n\tat net.sourceforge.htmlunit.cyberneko.HTMLScanner.scanDocument(HTMLScanner.java:937)\r\n\tat net.sourceforge.htmlunit.cyberneko.HTMLConfiguration.parse(HTMLConfiguration.java:443)\r\n\tat net.sourceforge.htmlunit.cyberneko.HTMLConfiguration.parse(HTMLConfiguration.java:394)\r\n\tat org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\r\n\tat com.gargoylesoftware.htmlunit.html.parser.neko.HtmlUnitNekoDOMBuilder.parse(HtmlUnitNekoDOMBuilder.java:760)\r\n\tat com.gargoylesoftware.htmlunit.html.parser.neko.HtmlUnitNekoHtmlParser.parseFragment(HtmlUnitNekoHtmlParser.java:158)\r\n\tat com.gargoylesoftware.htmlunit.html.parser.neko.HtmlUnitNekoHtmlParser.parseFragment(HtmlUnitNekoHtmlParser.java:112)\r\n\tat com.gargoylesoftware.htmlunit.javascript.host.Element.parseHtmlSnippet(Element.java:868)\r\n\tat com.gargoylesoftware.htmlunit.javascript.host.Element.setInnerHTML(Element.java:920)\r\n\tat com.gargoylesoftware.htmlunit.javascript.host.html.HTMLElement.setInnerHTML(HTMLElement.java:676)\r\n\tat sun.reflect.GeneratedMethodAccessor17.invoke(Unknown Source)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat net.sourceforge.htmlunit.corejs.javascript.MemberBox.invoke(MemberBox.java:188)\r\n\t... 30 more\r\n```\r\n\r\nThe above `... 30 more` means that I do not know the line of my code that causes the problem. How can I get the full stack trace.\r\n\r\nAlso, if it does not seem to be running any of my catch statements with `printStackTrace`, but if I turn off logging with the below command \r\n\r\n```java\r\njava.util.logging.Logger.getLogger(&quot;com.gargoylesoftware.htmlunit&quot;).setLevel(java.util.logging.Level.OFF);\r\n\r\njava.util.logging.Logger.getLogger(&quot;org.apache.http&quot;).setLevel(java.util.logging.Level.OFF);\r\n\r\n\r\n**Have put in my full code below as suggested by the comments below . Did not put in the actual URL though**\r\n\r\nimport com.gargoylesoftware.htmlunit.html.*;\r\nimport java.io.File;\r\nimport com.gargoylesoftware.htmlunit.WebClient;\r\nimport com.gargoylesoftware.htmlunit.html.HtmlPage;\r\n\r\n\r\n\r\npublic class download_to_send_to_stackoverflow\r\n{\r\n     public static void main(String args[])\r\n     {\r\n\r\n      String url = &quot;did not want to include the actual web site &quot;;\r\n\r\n\r\n      HtmlPage page = null;\r\n\r\n      WebClient webClient = new WebClient();\r\n\t  webClient.getOptions().setRedirectEnabled(true);  \r\n\t  webClient.getOptions().setJavaScriptEnabled(true);  // tried making false - but didnt work\r\n \t  webClient.getOptions().setCssEnabled(false);\r\n\t  webClient.getOptions().setUseInsecureSSL(true);\r\n          webClient.getOptions().setTimeout(30000);\r\n\t  webClient.setJavaScriptTimeout(30000); //e.g. 50s\r\n \t  webClient.waitForBackgroundJavaScript(15000) ;   // added 2017/1/24\r\n\t  webClient.waitForBackgroundJavaScriptStartingBefore(30000) ;   // added 2017/1/24\r\n\r\n\r\n          try\r\n               {\r\n               page = webClient.getPage( url );\r\n   \t       savePage_just_html(page );  \r\n\t       }\r\n\r\n          catch( Exception e )\r\n               {\r\n               System.out.println( &quot;Exception thrown:----------------------------------------&quot; + e.getMessage() );\r\n               e.printStackTrace();\r\n               }\r\n     }\r\n\r\n\r\n\r\n\r\n     protected static String savePage_just_html(HtmlPage page)\r\n     {\r\n          try\r\n          {\r\n          \tFile saveFolder = new File(&quot;spool/_&quot;);\r\n\t        page.save(saveFolder);   // this is the line causing the error with limit stack trace\r\n          }\r\n\r\n\r\n\r\n          catch ( Exception e )\r\n          {\r\n               System.out.println( &quot;IOException was thrown: ---------------------------------- &quot; + e.getMessage() );\r\n               e.printStackTrace();\r\n          }\r\n\r\n\r\n          return &quot;file.html&quot;;\r\n     }\r\n\r\n\r\n\r\n}\r\n\r\n\r\n\r\n------------------------------------------------------\r\n\r\n\r\n  page.save(saveFolder);   above is the problem line.  if I take it out I dont get the limited statcktrace errors but I also dont save the html page - which I want to do\r\n\r\n- The question is - why does this line only print a limited stacktrace","title":"In Java - how do I get a full stack trace","body":"<p>Currently I get the following output from code run</p>\n<pre><code>Caused by: java.lang.NullPointerException\n    at com.gargoylesoftware.htmlunit.html.HtmlScript$2.execute(HtmlScript.java:227)\n    at com.gargoylesoftware.htmlunit.html.HtmlScript.onAllChildrenAddedToPage(HtmlScript.java:256)\n    at com.gargoylesoftware.htmlunit.html.parser.neko.HtmlUnitNekoDOMBuilder.endElement(HtmlUnitNekoDOMBuilder.java:560)\n    at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)\n    at com.gargoylesoftware.htmlunit.html.parser.neko.HtmlUnitNekoDOMBuilder.endElement(HtmlUnitNekoDOMBuilder.java:514)\n    at net.sourceforge.htmlunit.cyberneko.HTMLTagBalancer.callEndElement(HTMLTagBalancer.java:1192)\n    at net.sourceforge.htmlunit.cyberneko.HTMLTagBalancer.endElement(HTMLTagBalancer.java:1132)\n    at net.sourceforge.htmlunit.cyberneko.filters.DefaultFilter.endElement(DefaultFilter.java:219)\n    at net.sourceforge.htmlunit.cyberneko.filters.NamespaceBinder.endElement(NamespaceBinder.java:312)\n    at net.sourceforge.htmlunit.cyberneko.HTMLScanner$ContentScanner.scanEndElement(HTMLScanner.java:3189)\n    at net.sourceforge.htmlunit.cyberneko.HTMLScanner$ContentScanner.scan(HTMLScanner.java:2114)\n    at net.sourceforge.htmlunit.cyberneko.HTMLScanner.scanDocument(HTMLScanner.java:937)\n    at net.sourceforge.htmlunit.cyberneko.HTMLConfiguration.parse(HTMLConfiguration.java:443)\n    at net.sourceforge.htmlunit.cyberneko.HTMLConfiguration.parse(HTMLConfiguration.java:394)\n    at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n    at com.gargoylesoftware.htmlunit.html.parser.neko.HtmlUnitNekoDOMBuilder.parse(HtmlUnitNekoDOMBuilder.java:760)\n    at com.gargoylesoftware.htmlunit.html.parser.neko.HtmlUnitNekoHtmlParser.parseFragment(HtmlUnitNekoHtmlParser.java:158)\n    at com.gargoylesoftware.htmlunit.html.parser.neko.HtmlUnitNekoHtmlParser.parseFragment(HtmlUnitNekoHtmlParser.java:112)\n    at com.gargoylesoftware.htmlunit.javascript.host.Element.parseHtmlSnippet(Element.java:868)\n    at com.gargoylesoftware.htmlunit.javascript.host.Element.setInnerHTML(Element.java:920)\n    at com.gargoylesoftware.htmlunit.javascript.host.html.HTMLElement.setInnerHTML(HTMLElement.java:676)\n    at sun.reflect.GeneratedMethodAccessor17.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:498)\n    at net.sourceforge.htmlunit.corejs.javascript.MemberBox.invoke(MemberBox.java:188)\n    ... 30 more\n</code></pre>\n<p>The above <code>... 30 more</code> means that I do not know the line of my code that causes the problem. How can I get the full stack trace.</p>\n<p>Also, if it does not seem to be running any of my catch statements with <code>printStackTrace</code>, but if I turn off logging with the below command</p>\n<pre class=\"lang-java prettyprint-override\"><code>java.util.logging.Logger.getLogger(&quot;com.gargoylesoftware.htmlunit&quot;).setLevel(java.util.logging.Level.OFF);\n\njava.util.logging.Logger.getLogger(&quot;org.apache.http&quot;).setLevel(java.util.logging.Level.OFF);\n\n\n**Have put in my full code below as suggested by the comments below . Did not put in the actual URL though**\n\nimport com.gargoylesoftware.htmlunit.html.*;\nimport java.io.File;\nimport com.gargoylesoftware.htmlunit.WebClient;\nimport com.gargoylesoftware.htmlunit.html.HtmlPage;\n\n\n\npublic class download_to_send_to_stackoverflow\n{\n     public static void main(String args[])\n     {\n\n      String url = &quot;did not want to include the actual web site &quot;;\n\n\n      HtmlPage page = null;\n\n      WebClient webClient = new WebClient();\n      webClient.getOptions().setRedirectEnabled(true);  \n      webClient.getOptions().setJavaScriptEnabled(true);  // tried making false - but didnt work\n      webClient.getOptions().setCssEnabled(false);\n      webClient.getOptions().setUseInsecureSSL(true);\n          webClient.getOptions().setTimeout(30000);\n      webClient.setJavaScriptTimeout(30000); //e.g. 50s\n      webClient.waitForBackgroundJavaScript(15000) ;   // added 2017/1/24\n      webClient.waitForBackgroundJavaScriptStartingBefore(30000) ;   // added 2017/1/24\n\n\n          try\n               {\n               page = webClient.getPage( url );\n           savePage_just_html(page );  \n           }\n\n          catch( Exception e )\n               {\n               System.out.println( &quot;Exception thrown:----------------------------------------&quot; + e.getMessage() );\n               e.printStackTrace();\n               }\n     }\n\n\n\n\n     protected static String savePage_just_html(HtmlPage page)\n     {\n          try\n          {\n            File saveFolder = new File(&quot;spool/_&quot;);\n            page.save(saveFolder);   // this is the line causing the error with limit stack trace\n          }\n\n\n\n          catch ( Exception e )\n          {\n               System.out.println( &quot;IOException was thrown: ---------------------------------- &quot; + e.getMessage() );\n               e.printStackTrace();\n          }\n\n\n          return &quot;file.html&quot;;\n     }\n\n\n\n}\n\n\n\n------------------------------------------------------\n\n\n  page.save(saveFolder);   above is the problem line.  if I take it out I dont get the limited statcktrace errors but I also dont save the html page - which I want to do\n\n- The question is - why does this line only print a limited stacktrace\n</code></pre>\n"},{"tags":["java","android"],"comments":[{"owner":{"display_name":"user1410081"},"score":0,"creation_date":1454696374,"post_id":30909922,"comment_id":58176263,"body_markdown":"Can you show your project structure?","body":"Can you show your project structure?"},{"owner":{"account_id":1576433,"reputation":22963,"user_id":1462718,"accept_rate":89,"display_name":"Brandon"},"score":0,"creation_date":1468888404,"post_id":30909922,"comment_id":64301050,"body_markdown":"Why are you trying to open XXX library? ;) Pr0n..","body":"Why are you trying to open XXX library? ;) Pr0n.."}],"answers":[{"tags":[],"owner":{"account_id":3385495,"reputation":4501,"user_id":2841538,"display_name":"us_david"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1468888110,"creation_date":1468888110,"answer_id":38447823,"question_id":30909922,"body_markdown":"Try this:  \r\n\r\n    System.loadLibrary(&quot;kdu_jni&quot;);\r\n\r\n  \r\nloadLibrary() actually load from the ape&#39;s lib/. Also you don&#39;t need to specify &#39;lib&#39; &amp; the extension &#39;so&#39;.  \r\n\r\nHope this helps.  \r\n","title":"dlopen(&quot;xxxx&quot;) failed: dlopen failed: library &quot;xxxx&quot; not found","body":"<p>Try this:  </p>\n\n<pre><code>System.loadLibrary(\"kdu_jni\");\n</code></pre>\n\n<p>loadLibrary() actually load from the ape's lib/. Also you don't need to specify 'lib' &amp; the extension 'so'.  </p>\n\n<p>Hope this helps.  </p>\n"},{"tags":[],"owner":{"account_id":4352710,"reputation":83,"user_id":3552455,"accept_rate":57,"display_name":"Eliran Goshen"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1480267253,"creation_date":1480267253,"answer_id":40831675,"question_id":30909922,"body_markdown":"I have same problem with other .so file.\r\nI added jniLibs library to `...src/main` with the relevant file and it worked.\r\nMaybe you can try it to.\r\n\r\n","title":"dlopen(&quot;xxxx&quot;) failed: dlopen failed: library &quot;xxxx&quot; not found","body":"<p>I have same problem with other .so file.\nI added jniLibs library to <code>...src/main</code> with the relevant file and it worked.\nMaybe you can try it to.</p>\n"},{"tags":[],"owner":{"account_id":1324963,"reputation":14633,"user_id":1270008,"display_name":"tanius"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1591806401,"creation_date":1591806401,"answer_id":62308454,"question_id":30909922,"body_markdown":"With `System.load(&quot;…&quot;);` you are loading a library in a way that is undetectable by the Android APK packaging code of your build system. Due to this, the library is not included into the APK and cannot be found at runtime when you start the app on an Android device.\r\n\r\nTo solve this, use the mechanism of your build system to make the APK packager aware of extra libraries to include. This will differ between build systems. As an example, this in a CMake build system you would just add the library to the list of libraries in `target_link_libraries(…)`:\r\n\r\n```\r\nadd_executable(my_executable_name ${SRCS} ${RESOURCES})\r\n\r\n# Link all required libraries with the executable, \r\n# and include them into the Android APK.\r\ntarget_link_libraries(my_executable_name\r\n    # Name libraries here as you would when calling &quot;g++ -l…&quot;.\r\n    # Alternatively, use absolute paths.\r\n    Qt5::Core\r\n    Qt5::Quick\r\n    /my/path/to/native/libkdu_jni.so\r\n)\r\n```\r\n","title":"dlopen(&quot;xxxx&quot;) failed: dlopen failed: library &quot;xxxx&quot; not found","body":"<p>With <code>System.load(\"…\");</code> you are loading a library in a way that is undetectable by the Android APK packaging code of your build system. Due to this, the library is not included into the APK and cannot be found at runtime when you start the app on an Android device.</p>\n\n<p>To solve this, use the mechanism of your build system to make the APK packager aware of extra libraries to include. This will differ between build systems. As an example, this in a CMake build system you would just add the library to the list of libraries in <code>target_link_libraries(…)</code>:</p>\n\n<pre><code>add_executable(my_executable_name ${SRCS} ${RESOURCES})\n\n# Link all required libraries with the executable, \n# and include them into the Android APK.\ntarget_link_libraries(my_executable_name\n    # Name libraries here as you would when calling \"g++ -l…\".\n    # Alternatively, use absolute paths.\n    Qt5::Core\n    Qt5::Quick\n    /my/path/to/native/libkdu_jni.so\n)\n</code></pre>\n"}],"owner":{"account_id":5350827,"reputation":1022,"user_id":4265006,"accept_rate":95,"display_name":"Dauezevy"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":8454,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":3,"score":3,"last_activity_date":1694290065,"creation_date":1434615278,"question_id":30909922,"body_markdown":"    package com.test.nativeapp;\r\n    \r\n    import android.support.v7.app.ActionBarActivity;\r\n    import android.os.Bundle;\r\n    import android.view.Menu;\r\n    import android.view.MenuItem;\r\n    \r\n    public class MainActivity extends ActionBarActivity {\r\n    \t\r\n    \tstatic {\r\n    \t    try {\r\n    \t    \tSystem.load(&quot;native/libkdu_jni.so&quot;);\r\n    \t    } catch (UnsatisfiedLinkError e) {\r\n    \t      System.err.println(&quot;Native code library failed to load.\\n&quot; + e);\r\n    \t      System.exit(1);\r\n    \t    }\r\n    \t  }\r\n    \t\r\n    \t@Override\r\n    \tprotected void onCreate(Bundle savedInstanceState) {\r\n    \t\tsuper.onCreate(savedInstanceState);\r\n    \t\tsetContentView(R.layout.activity_main);\r\n    \t}\r\n    \r\n    \t@Override\r\n    \tpublic boolean onCreateOptionsMenu(Menu menu) {\r\n    \t\t// Inflate the menu; this adds items to the action bar if it is present.\r\n    \t\tgetMenuInflater().inflate(R.menu.main, menu);\r\n    \t\treturn true;\r\n    \t}\r\n    \r\n    \t@Override\r\n    \tpublic boolean onOptionsItemSelected(MenuItem item) {\r\n    \t\t// Handle action bar item clicks here. The action bar will\r\n    \t\t// automatically handle clicks on the Home/Up button, so long\r\n    \t\t// as you specify a parent activity in AndroidManifest.xml.\r\n    \t\tint id = item.getItemId();\r\n    \t\tif (id == R.id.action_settings) {\r\n    \t\t\treturn true;\r\n    \t\t}\r\n    \t\treturn super.onOptionsItemSelected(item);\r\n    \t}\r\n    }\r\n\r\nLogCat Error:\r\n\r\n\r\n \r\n\r\n&gt; 06-18 11:13:55.235: D/dalvikvm(17658): Trying to load lib\r\n&gt; native/libkdu_jni.so 0x421eeb38 06-18 11:13:55.235: E/dalvikvm(17658):\r\n&gt; dlopen(&quot;native/libkdu_jni.so&quot;) failed: dlopen failed: library\r\n&gt; &quot;native/libkdu_jni.so&quot; not found\r\n&gt; \r\n&gt; \r\n&gt; 06-18 11:13:55.235: W/System.err(17658): Native code library failed to\r\n&gt; load.\r\n&gt; \r\n&gt; \r\n&gt; 06-18 11:13:55.235: W/System.err(17658):\r\n&gt; java.lang.UnsatisfiedLinkError: dlopen failed: library\r\n&gt; &quot;native/libkdu_jni.so&quot; not found\r\n\r\n\r\n\r\nWhere should i put this folder ?","title":"dlopen(&quot;xxxx&quot;) failed: dlopen failed: library &quot;xxxx&quot; not found","body":"<pre><code>package com.test.nativeapp;\n\nimport android.support.v7.app.ActionBarActivity;\nimport android.os.Bundle;\nimport android.view.Menu;\nimport android.view.MenuItem;\n\npublic class MainActivity extends ActionBarActivity {\n\n    static {\n        try {\n            System.load(\"native/libkdu_jni.so\");\n        } catch (UnsatisfiedLinkError e) {\n          System.err.println(\"Native code library failed to load.\\n\" + e);\n          System.exit(1);\n        }\n      }\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n    }\n\n    @Override\n    public boolean onCreateOptionsMenu(Menu menu) {\n        // Inflate the menu; this adds items to the action bar if it is present.\n        getMenuInflater().inflate(R.menu.main, menu);\n        return true;\n    }\n\n    @Override\n    public boolean onOptionsItemSelected(MenuItem item) {\n        // Handle action bar item clicks here. The action bar will\n        // automatically handle clicks on the Home/Up button, so long\n        // as you specify a parent activity in AndroidManifest.xml.\n        int id = item.getItemId();\n        if (id == R.id.action_settings) {\n            return true;\n        }\n        return super.onOptionsItemSelected(item);\n    }\n}\n</code></pre>\n\n<p>LogCat Error:</p>\n\n<blockquote>\n  <p>06-18 11:13:55.235: D/dalvikvm(17658): Trying to load lib\n  native/libkdu_jni.so 0x421eeb38 06-18 11:13:55.235: E/dalvikvm(17658):\n  dlopen(\"native/libkdu_jni.so\") failed: dlopen failed: library\n  \"native/libkdu_jni.so\" not found</p>\n  \n  <p>06-18 11:13:55.235: W/System.err(17658): Native code library failed to\n  load.</p>\n  \n  <p>06-18 11:13:55.235: W/System.err(17658):\n  java.lang.UnsatisfiedLinkError: dlopen failed: library\n  \"native/libkdu_jni.so\" not found</p>\n</blockquote>\n\n<p>Where should i put this folder ?</p>\n"},{"tags":["java","android","gridview","android-custom-view"],"comments":[{"owner":{"account_id":216120,"reputation":49213,"user_id":471160,"accept_rate":90,"display_name":"marcinj"},"score":0,"creation_date":1694334245,"post_id":77073887,"comment_id":135875454,"body_markdown":"Is your gridView layout actually inflated before you make a calls like findViewById?","body":"Is your gridView layout actually inflated before you make a calls like findViewById?"},{"owner":{"account_id":29350372,"reputation":11,"user_id":22487654,"display_name":"NikoBitan"},"score":0,"creation_date":1694337332,"post_id":77073887,"comment_id":135875736,"body_markdown":"I made an XML file with a GridView with the id &quot;grid_table&quot;","body":"I made an XML file with a GridView with the id &quot;grid_table&quot;"}],"owner":{"account_id":29350372,"reputation":11,"user_id":22487654,"display_name":"NikoBitan"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":30,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694289961,"creation_date":1694289961,"question_id":77073887,"body_markdown":"I want to generate a GridView, the number of columns is always 5 what changes is the number of rows, i have a spinner with numbers from 5 to 10 which dictates how many rows the grid should have.\r\nBesides just genereting the grid i also want for each of the cells to have a view inside them once the grid is created, it&#39;s a custom view called EmptyCell.\r\nHow do i do that?\r\n\r\nThis is the function that should create a GridView:\r\n\r\n```\r\nprivate View createGrid(int numRow){\r\n\r\n        GridView gridview = findViewById(R.id.grid_table);\r\n        gridview.setNumColumns(5);\r\n\r\n        GridAdapter gridadapter = new GridAdapter(WeekEditing.this, numRow);\r\n        gridview.setAdapter(gridadapter);\r\n\r\n        return gridview;\r\n    }\r\n```\r\nAnd this is the custom adapter that i wrote:\r\n\r\n```\r\npackage com.example.teacherplanner;\r\n\r\nimport android.content.Context;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.BaseAdapter;\r\nimport android.widget.LinearLayout;\r\n\r\npublic class GridAdapter extends BaseAdapter {\r\n\r\n    private Context context;\r\n    private int numRows;\r\n\r\n    public GridAdapter(Context context, int numRows) {\r\n        this.context = context;\r\n        this.numRows = numRows;\r\n    }\r\n\r\n    @Override\r\n    public int getCount() {\r\n        return numRows * 5;\r\n    }\r\n\r\n    @Override\r\n    public Object getItem(int position) {\r\n        return null;\r\n    }\r\n\r\n    @Override\r\n    public long getItemId(int position) {\r\n        return 0;\r\n    }\r\n\r\n\r\n\r\n    @Override\r\n    public View getView(int position, View convertView, ViewGroup parent) {\r\n        if (convertView == null) {\r\n            LayoutInflater inflater = LayoutInflater.from(context);\r\n            convertView = inflater.inflate(R.layout.empty_cell, parent, false);\r\n        }\r\n\r\n        LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(\r\n                ViewGroup.LayoutParams.WRAP_CONTENT,\r\n                ViewGroup.LayoutParams.WRAP_CONTENT\r\n        );\r\n        convertView.setLayoutParams(layoutParams);\r\n\r\n        return convertView;\r\n    }\r\n}\r\n\r\n```\r\n\r\nMy idea was to add a GripView in the XML file and to change it whnever i would call the function but my program keeps crashing\r\n\r\n","title":"How to create a GridView with views inside cells using a spinner","body":"<p>I want to generate a GridView, the number of columns is always 5 what changes is the number of rows, i have a spinner with numbers from 5 to 10 which dictates how many rows the grid should have.\nBesides just genereting the grid i also want for each of the cells to have a view inside them once the grid is created, it's a custom view called EmptyCell.\nHow do i do that?</p>\n<p>This is the function that should create a GridView:</p>\n<pre><code>private View createGrid(int numRow){\n\n        GridView gridview = findViewById(R.id.grid_table);\n        gridview.setNumColumns(5);\n\n        GridAdapter gridadapter = new GridAdapter(WeekEditing.this, numRow);\n        gridview.setAdapter(gridadapter);\n\n        return gridview;\n    }\n</code></pre>\n<p>And this is the custom adapter that i wrote:</p>\n<pre><code>package com.example.teacherplanner;\n\nimport android.content.Context;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\nimport android.widget.BaseAdapter;\nimport android.widget.LinearLayout;\n\npublic class GridAdapter extends BaseAdapter {\n\n    private Context context;\n    private int numRows;\n\n    public GridAdapter(Context context, int numRows) {\n        this.context = context;\n        this.numRows = numRows;\n    }\n\n    @Override\n    public int getCount() {\n        return numRows * 5;\n    }\n\n    @Override\n    public Object getItem(int position) {\n        return null;\n    }\n\n    @Override\n    public long getItemId(int position) {\n        return 0;\n    }\n\n\n\n    @Override\n    public View getView(int position, View convertView, ViewGroup parent) {\n        if (convertView == null) {\n            LayoutInflater inflater = LayoutInflater.from(context);\n            convertView = inflater.inflate(R.layout.empty_cell, parent, false);\n        }\n\n        LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(\n                ViewGroup.LayoutParams.WRAP_CONTENT,\n                ViewGroup.LayoutParams.WRAP_CONTENT\n        );\n        convertView.setLayoutParams(layoutParams);\n\n        return convertView;\n    }\n}\n\n</code></pre>\n<p>My idea was to add a GripView in the XML file and to change it whnever i would call the function but my program keeps crashing</p>\n"},{"tags":["java","classloader"],"comments":[{"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"score":2,"creation_date":1694291724,"post_id":77073806,"comment_id":135872979,"body_markdown":"The extension/platform and system/application class loaders are both &quot;user-defined class loaders&quot;. That is to say, they are instances of `java.lang.ClassLoader` written in Java code.","body":"The extension/platform and system/application class loaders are both &quot;user-defined class loaders&quot;. That is to say, they are instances of <code>java.lang.ClassLoader</code> written in Java code."},{"owner":{"account_id":75804,"reputation":94840,"user_id":217324,"accept_rate":96,"display_name":"Nathan Hughes"},"score":0,"creation_date":1694304738,"post_id":77073806,"comment_id":135873899,"body_markdown":"Didnt extension classloader go away as of java 9?","body":"Didnt extension classloader go away as of java 9?"},{"owner":{"account_id":1778034,"reputation":595,"user_id":1621408,"accept_rate":85,"display_name":"gaurs"},"score":0,"creation_date":1694315374,"post_id":77073806,"comment_id":135874357,"body_markdown":"@NathanHughes: Yes, its  replaced with `PlatformClassLoader` post Java9 with backward compatibility.","body":"@NathanHughes: Yes, its  replaced with <code>PlatformClassLoader</code> post Java9 with backward compatibility."},{"owner":{"account_id":1778034,"reputation":595,"user_id":1621408,"accept_rate":85,"display_name":"gaurs"},"score":0,"creation_date":1694320812,"post_id":77073806,"comment_id":135874591,"body_markdown":"@Slaw: Is it because the Bootstrap class loader is a native implementation and the other two are Java implementations? As per the [javadocs](https://docs.oracle.com/javase%2F9%2Fdocs%2Fapi%2F%2F/java/lang/ClassLoader.html): The Java run-time has the following built-in class loaders:  Bootstrap, Platform, and System.\n\nSo what are the criteria for this user-defined vs. JVM provided categorization if all are provided by JVM itself?","body":"@Slaw: Is it because the Bootstrap class loader is a native implementation and the other two are Java implementations? As per the <a href=\"https://docs.oracle.com/javase%2F9%2Fdocs%2Fapi%2F%2F/java/lang/ClassLoader.html\" rel=\"nofollow noreferrer\">javadocs</a>: The Java run-time has the following built-in class loaders:  Bootstrap, Platform, and System.  So what are the criteria for this user-defined vs. JVM provided categorization if all are provided by JVM itself?"},{"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"score":1,"creation_date":1694382666,"post_id":77073806,"comment_id":135880212,"body_markdown":"The platform and system loaders are _not_ provided by the JVM. They are provided by the standard library (though the implementations are internal). But something has to start things off (i.e., _bootstrap_ the class loading process). This is done by a special class loader built into the JVM itself.","body":"The platform and system loaders are <i>not</i> provided by the JVM. They are provided by the standard library (though the implementations are internal). But something has to start things off (i.e., <i>bootstrap</i> the class loading process). This is done by a special class loader built into the JVM itself."},{"owner":{"account_id":1778034,"reputation":595,"user_id":1621408,"accept_rate":85,"display_name":"gaurs"},"score":0,"creation_date":1694581732,"post_id":77073806,"comment_id":135908337,"body_markdown":"Can&#39;t accept it as an answer (as its a comment), but that clarifies @Slaw. thanks","body":"Can&#39;t accept it as an answer (as its a comment), but that clarifies @Slaw. thanks"}],"owner":{"account_id":1778034,"reputation":595,"user_id":1621408,"accept_rate":85,"display_name":"gaurs"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":55,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1694288660,"creation_date":1694288660,"question_id":77073806,"body_markdown":"As mentioned in [JVM specification][1]:\r\n\r\n&gt; There are two kinds of class loaders: the **bootstrap class loader**\r\n&gt; supplied by the Java Virtual Machine, and **user-defined class loaders**.\r\n&gt; Every user-defined class loader is an instance of a subclass of the\r\n&gt; abstract class ClassLoader.\r\n\r\nAdditionally, we know that at JVM startup, the following class loaders are set:\r\n\r\n1. Bootstrap class loader\r\n2. Extension or Platform class loader\r\n3. System or Application class loader \r\n\r\nwhich seems to be contradictory to what is mentioned in the JVM spec as instead of just the bootstrap class loader, there are other classloaders as well supplied by JVM.\r\n\r\n  [1]: https://docs.oracle.com/javase/specs/jvms/se20/html/jvms-5.html#jvms-5.3","title":"Java Classloaders types","body":"<p>As mentioned in <a href=\"https://docs.oracle.com/javase/specs/jvms/se20/html/jvms-5.html#jvms-5.3\" rel=\"nofollow noreferrer\">JVM specification</a>:</p>\n<blockquote>\n<p>There are two kinds of class loaders: the <strong>bootstrap class loader</strong>\nsupplied by the Java Virtual Machine, and <strong>user-defined class loaders</strong>.\nEvery user-defined class loader is an instance of a subclass of the\nabstract class ClassLoader.</p>\n</blockquote>\n<p>Additionally, we know that at JVM startup, the following class loaders are set:</p>\n<ol>\n<li>Bootstrap class loader</li>\n<li>Extension or Platform class loader</li>\n<li>System or Application class loader</li>\n</ol>\n<p>which seems to be contradictory to what is mentioned in the JVM spec as instead of just the bootstrap class loader, there are other classloaders as well supplied by JVM.</p>\n"},{"tags":["java","android","kotlin","intellij-idea","android-view"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1694289423,"post_id":77073764,"comment_id":135872763,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."},{"owner":{"account_id":238127,"reputation":86162,"user_id":506796,"accept_rate":83,"display_name":"Tenfour04"},"score":0,"creation_date":1694290110,"post_id":77073764,"comment_id":135872834,"body_markdown":"“Even though the class isn’t generated yet” why do you think this is the case? It generates the new binding class automatically. The compiler is constantly recompiling your Kotlin code as you type it. That’s how it can show you errors before you build the app.","body":"“Even though the class isn’t generated yet” why do you think this is the case? It generates the new binding class automatically. The compiler is constantly recompiling your Kotlin code as you type it. That’s how it can show you errors before you build the app."},{"owner":{"account_id":28079978,"reputation":1,"user_id":21451224,"display_name":"Nikolai"},"score":0,"creation_date":1694290426,"post_id":77073764,"comment_id":135872867,"body_markdown":"@Tenfour04 I found ActivityMainBinding.java file in biuld/generated directory, but it changes only when I run application. So there&#39;s something under the hood of IntelliJ that I can&#39;t see in real time?","body":"@Tenfour04 I found ActivityMainBinding.java file in biuld/generated directory, but it changes only when I run application. So there&#39;s something under the hood of IntelliJ that I can&#39;t see in real time?"},{"owner":{"account_id":238127,"reputation":86162,"user_id":506796,"accept_rate":83,"display_name":"Tenfour04"},"score":0,"creation_date":1694290712,"post_id":77073764,"comment_id":135872888,"body_markdown":"I guess I never really thought about it but that must be the case. The stuff in `build` is where it copies all the relevant code for a build and that gets compiled fully when doing a build. That’s not what it’s looking at to generate code hints and errors as you are programming.","body":"I guess I never really thought about it but that must be the case. The stuff in <code>build</code> is where it copies all the relevant code for a build and that gets compiled fully when doing a build. That’s not what it’s looking at to generate code hints and errors as you are programming."}],"owner":{"account_id":28079978,"reputation":1,"user_id":21451224,"display_name":"Nikolai"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":21,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694287983,"creation_date":1694287835,"question_id":77073764,"body_markdown":"I was playing around Kotlin and learned about ViewBinding and how it works. It seems quite easy for me but there is one thing I don&#39;t understand. I edit activity_main.xml and instantly get hints on ActivityMainBinding instance&#39;s fields. For example, I add a new TextView in xml layout and AndroidStudio immediately shows me hints on this View, even though the class has not been generated yet. Is it just an AndroidStudio built-in analyzer feature or something else? Does it really calculate this in real time and allows you to see the class fields that have not yet been generated, but will appear at the next build of the application?","title":"How I get hints from IntelliJ on ViewBinding class fields when this class is not generated yet?","body":"<p>I was playing around Kotlin and learned about ViewBinding and how it works. It seems quite easy for me but there is one thing I don't understand. I edit activity_main.xml and instantly get hints on ActivityMainBinding instance's fields. For example, I add a new TextView in xml layout and AndroidStudio immediately shows me hints on this View, even though the class has not been generated yet. Is it just an AndroidStudio built-in analyzer feature or something else? Does it really calculate this in real time and allows you to see the class fields that have not yet been generated, but will appear at the next build of the application?</p>\n"},{"tags":["java","android","gridview"],"comments":[{"owner":{"account_id":17523909,"reputation":407,"user_id":12709358,"display_name":"Elango"},"score":0,"creation_date":1694288386,"post_id":77073771,"comment_id":135872654,"body_markdown":"welcome , Plz read [HOW TO ASK](https://stackoverflow.com/help/how-to-ask)","body":"welcome , Plz read <a href=\"https://stackoverflow.com/help/how-to-ask\">HOW TO ASK</a>"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1694323458,"post_id":77073771,"comment_id":135874751,"body_markdown":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.","body":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking."},{"owner":{"account_id":29403393,"reputation":3,"user_id":22529371,"display_name":"Christyan Rodriguez"},"score":0,"creation_date":1694376190,"post_id":77073771,"comment_id":135879600,"body_markdown":"I need to go through the recyclerview items and get the position in an alertdialog","body":"I need to go through the recyclerview items and get the position in an alertdialog"}],"owner":{"account_id":29403393,"reputation":3,"user_id":22529371,"display_name":"Christyan Rodriguez"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":14,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1694287979,"creation_date":1694287979,"question_id":77073771,"body_markdown":"I have an application that will be used on a large screen and operated only with an external keyboard. There is a gridview dynamically inflated according to a database and I have to scroll through its items with the arrows on the external keyboard and highlight the one that has the focus so that if the Enter key is pressed an alertdialog is displayed with the data of that item. I can show the alert with the data, but I don&#39;t know how to navigate the gridview with the arrows on an external keyboard.\r\n\r\n\r\nchange the selection focus of each element of the gridview and show alert with data of the selected element when pressing ENTER","title":"navigate textview of gridview with arrows android","body":"<p>I have an application that will be used on a large screen and operated only with an external keyboard. There is a gridview dynamically inflated according to a database and I have to scroll through its items with the arrows on the external keyboard and highlight the one that has the focus so that if the Enter key is pressed an alertdialog is displayed with the data of that item. I can show the alert with the data, but I don't know how to navigate the gridview with the arrows on an external keyboard.</p>\n<p>change the selection focus of each element of the gridview and show alert with data of the selected element when pressing ENTER</p>\n"},{"tags":["java","hibernate"],"answers":[{"tags":[],"owner":{"account_id":136251,"reputation":87506,"user_id":339637,"accept_rate":55,"display_name":"Ken Chan"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1694287676,"creation_date":1694282256,"answer_id":77073431,"question_id":77072217,"body_markdown":"There are a bit differences in term of the generated insert SQL and the configuration of the create timestamp column.\r\n\r\n\r\n`@Column(updatable = false, insertable = false)` requires you to configure the DB column to have a default value which is set to the current timestamp. The generate SQL will not include the created time column because of `insertable=false`\r\n\r\n\r\n`@CreationTimestamp(source = SourceType.DB)` does not require the DB column to have such default value setting. Hibernate will call the current timestamp fucntion from DB, and use its value to generate the insert SQL. \r\n\r\n","title":"@CreationTimestamp with value from DB is excessive?","body":"<p>There are a bit differences in term of the generated insert SQL and the configuration of the create timestamp column.</p>\n<p><code>@Column(updatable = false, insertable = false)</code> requires you to configure the DB column to have a default value which is set to the current timestamp. The generate SQL will not include the created time column because of <code>insertable=false</code></p>\n<p><code>@CreationTimestamp(source = SourceType.DB)</code> does not require the DB column to have such default value setting. Hibernate will call the current timestamp fucntion from DB, and use its value to generate the insert SQL.</p>\n"}],"owner":{"account_id":5863731,"reputation":807,"user_id":4618492,"accept_rate":56,"display_name":"littleAlien"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":43,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":77073431,"answer_count":1,"score":1,"last_activity_date":1694287676,"creation_date":1694262392,"question_id":77072217,"body_markdown":"Is there any reason to add annotation \r\n```\r\n@CreationTimestamp(source = SourceType.DB)\r\n```\r\ninstead of \r\n```\r\n@Column(updatable = false, insertable = false)\r\n```\r\nexcept for db schema-generation?\r\nAnyway value will be set by DB.\r\n\r\nMoreover, `CreationTimestamp` is not compartible with `Immutable`, and cause error `JpaSystemException: Lock mode not supported`","title":"@CreationTimestamp with value from DB is excessive?","body":"<p>Is there any reason to add annotation</p>\n<pre><code>@CreationTimestamp(source = SourceType.DB)\n</code></pre>\n<p>instead of</p>\n<pre><code>@Column(updatable = false, insertable = false)\n</code></pre>\n<p>except for db schema-generation?\nAnyway value will be set by DB.</p>\n<p>Moreover, <code>CreationTimestamp</code> is not compartible with <code>Immutable</code>, and cause error <code>JpaSystemException: Lock mode not supported</code></p>\n"}],"has_more":true,"quota_max":10000,"quota_remaining":9940,"page":194,"page_size":100}
