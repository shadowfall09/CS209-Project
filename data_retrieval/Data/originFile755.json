{"items":[{"tags":["java","web-scraping","redirect","diacritics"],"comments":[{"owner":{"account_id":74704,"reputation":11534,"user_id":214525,"accept_rate":100,"display_name":"f1sh"},"score":0,"creation_date":1672922510,"post_id":75018290,"comment_id":132384673,"body_markdown":"What makes you think this has to do with the umlauts?","body":"What makes you think this has to do with the umlauts?"},{"owner":{"account_id":4570223,"reputation":315,"user_id":3710098,"accept_rate":71,"display_name":"Garog"},"score":0,"creation_date":1672924466,"post_id":75018290,"comment_id":132385346,"body_markdown":"because i can access every other page where the redirect has no umlauts. just the pages with umlauts are not working.","body":"because i can access every other page where the redirect has no umlauts. just the pages with umlauts are not working."}],"owner":{"account_id":4570223,"reputation":315,"user_id":3710098,"accept_rate":71,"display_name":"Garog"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":27,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672922524,"creation_date":1672921188,"question_id":75018290,"body_markdown":"I have a url `url = new URL(&quot;https://website.com/lang/npc=&quot;+id);` and want to load the content with `con.getInputStream()` but that results in `Server redirected too many  times (20)`.\r\nThis problem is because the website redirects me to a url with umlauts -&gt; `https://website.com/lang/npc=6/koboldgez&#252;cht`\r\n\r\nHow to avoid this problem ? ","title":"WebScraping with Java getInputStream(), redirect and umlauts","body":"<p>I have a url <code>url = new URL(&quot;https://website.com/lang/npc=&quot;+id);</code> and want to load the content with <code>con.getInputStream()</code> but that results in <code>Server redirected too many  times (20)</code>.\nThis problem is because the website redirects me to a url with umlauts -&gt; <code>https://website.com/lang/npc=6/koboldgez√ºcht</code></p>\n<p>How to avoid this problem ?</p>\n"},{"tags":["java","casting","classcastexception"],"comments":[{"owner":{"account_id":24831,"reputation":5854,"user_id":63383,"accept_rate":100,"display_name":"Mauricio"},"score":59,"creation_date":1296566042,"post_id":4862960,"comment_id":5403937,"body_markdown":"YOU are telling the compiler to NOT detect the error.","body":"YOU are telling the compiler to NOT detect the error."}],"answers":[{"comments":[{"owner":{"account_id":287330,"reputation":5349,"user_id":1470886,"accept_rate":41,"display_name":"saravanan"},"score":0,"creation_date":1296566347,"post_id":4862980,"comment_id":5404003,"body_markdown":"but the following code generates compilation error               Dog dog=new Animal(); (incompatible types) .but in this situation compiler identifies Animal is a super class and Dog is a subclass.so the assignment is wrong.but when we cast              Dog dog = (Dog) animal; it accepts .please explain me about this","body":"but the following code generates compilation error               Dog dog=new Animal(); (incompatible types) .but in this situation compiler identifies Animal is a super class and Dog is a subclass.so the assignment is wrong.but when we cast              Dog dog = (Dog) animal; it accepts .please explain me about this"},{"owner":{"account_id":70258,"reputation":590444,"user_id":203907,"accept_rate":81,"display_name":"Bozho"},"score":3,"creation_date":1296567083,"post_id":4862980,"comment_id":5404212,"body_markdown":"yes, because Animal is superclass. Not every animal is a Dog, right? You can refer to classes only by their types or their supertypes. Not their subtypes.","body":"yes, because Animal is superclass. Not every animal is a Dog, right? You can refer to classes only by their types or their supertypes. Not their subtypes."}],"tags":[],"owner":{"account_id":70258,"reputation":590444,"user_id":203907,"accept_rate":81,"display_name":"Bozho"},"comment_count":2,"down_vote_count":0,"up_vote_count":59,"is_accepted":false,"score":59,"last_activity_date":1296565991,"creation_date":1296565991,"answer_id":4862980,"question_id":4862960,"body_markdown":"Because theoretically `Animal animal` _can_ be a dog:\r\n\r\n    Animal animal = new Dog();\r\n\r\nGenerally, downcasting is not a good idea. You should avoid it. If you use it, you better include a check: \r\n\r\n    if (animal instanceof Dog) {\r\n        Dog dog = (Dog) animal;\r\n    }","title":"Explicit casting from super-class to sub-class","body":"<p>Because theoretically <code>Animal animal</code> <em>can</em> be a dog:</p>\n\n<pre><code>Animal animal = new Dog();\n</code></pre>\n\n<p>Generally, downcasting is not a good idea. You should avoid it. If you use it, you better include a check: </p>\n\n<pre><code>if (animal instanceof Dog) {\n    Dog dog = (Dog) animal;\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":382032,"reputation":3864,"user_id":737023,"accept_rate":60,"display_name":"Clarence Liu"},"score":7,"creation_date":1388689780,"post_id":4863082,"comment_id":31351581,"body_markdown":"There is no compilation error, that&#39;s the reason for his question","body":"There is no compilation error, that&#39;s the reason for his question"}],"tags":[],"owner":{"account_id":102129,"reputation":7632,"user_id":274344,"accept_rate":82,"display_name":"Simeon"},"comment_count":1,"down_vote_count":3,"up_vote_count":4,"is_accepted":false,"score":1,"last_activity_date":1296566573,"creation_date":1296566573,"answer_id":4863082,"question_id":4862960,"body_markdown":"The code generates a compilation error because your **instance type** is an Animal:\r\n\r\n    Animal animal=new Animal();\r\n\r\nDowncasting is not allowed in Java for several reasons.\r\nSee [here][1] for details.\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/380813/downcasting-in-java/380828#380828","title":"Explicit casting from super-class to sub-class","body":"<p>The code generates a compilation error because your <strong>instance type</strong> is an Animal:</p>\n\n<pre><code>Animal animal=new Animal();\n</code></pre>\n\n<p>Downcasting is not allowed in Java for several reasons.\nSee <a href=\"https://stackoverflow.com/questions/380813/downcasting-in-java/380828#380828\">here</a> for details.</p>\n"},{"comments":[{"owner":{"display_name":"user3402040"},"score":0,"creation_date":1449658429,"post_id":4863090,"comment_id":56100452,"body_markdown":"Thanks but you need dog extend from Animal if not, not work :)","body":"Thanks but you need dog extend from Animal if not, not work :)"},{"owner":{"account_id":264830,"reputation":70811,"user_id":551406,"accept_rate":95,"display_name":"Michael Berry"},"score":4,"creation_date":1495708913,"post_id":4863090,"comment_id":75371049,"body_markdown":"@delive Of course you do, but as per the question, `Dog` *does* extend from `Animal`!","body":"@delive Of course you do, but as per the question, <code>Dog</code> <i>does</i> extend from <code>Animal</code>!"}],"tags":[],"owner":{"account_id":264830,"reputation":70811,"user_id":551406,"accept_rate":95,"display_name":"Michael Berry"},"comment_count":2,"down_vote_count":1,"up_vote_count":369,"is_accepted":true,"score":368,"last_activity_date":1406737009,"creation_date":1296566615,"answer_id":4863090,"question_id":4862960,"body_markdown":"By using a cast you&#39;re essentially telling the compiler &quot;trust me. I&#39;m a professional, I know what I&#39;m doing and I know that although you can&#39;t guarantee it, I&#39;m telling you that this `animal` variable is definitely going to be a dog.&quot;\r\n\r\nSince the animal isn&#39;t actually a dog (it&#39;s an animal, you could do `Animal animal = new Dog();` and it&#39;d be a dog) the VM throws an exception at runtime because you&#39;ve violated that trust (you told the compiler everything would be ok and it&#39;s not!)\r\n\r\nThe compiler is a bit smarter than just blindly accepting everything, if you try and cast objects in different inheritence hierarchies (cast a Dog to a String for example) then the compiler will throw it back at you because it knows that could never possibly work.\r\n\r\nBecause you&#39;re essentially just stopping the compiler from complaining, every time you cast it&#39;s important to check that you won&#39;t cause a `ClassCastException` by using `instanceof` in an if statement (or something to that effect.)","title":"Explicit casting from super-class to sub-class","body":"<p>By using a cast you're essentially telling the compiler \"trust me. I'm a professional, I know what I'm doing and I know that although you can't guarantee it, I'm telling you that this <code>animal</code> variable is definitely going to be a dog.\"</p>\n\n<p>Since the animal isn't actually a dog (it's an animal, you could do <code>Animal animal = new Dog();</code> and it'd be a dog) the VM throws an exception at runtime because you've violated that trust (you told the compiler everything would be ok and it's not!)</p>\n\n<p>The compiler is a bit smarter than just blindly accepting everything, if you try and cast objects in different inheritence hierarchies (cast a Dog to a String for example) then the compiler will throw it back at you because it knows that could never possibly work.</p>\n\n<p>Because you're essentially just stopping the compiler from complaining, every time you cast it's important to check that you won't cause a <code>ClassCastException</code> by using <code>instanceof</code> in an if statement (or something to that effect.)</p>\n"},{"tags":[],"owner":{"account_id":924594,"reputation":9421,"user_id":955619,"accept_rate":93,"display_name":"Caumons"},"comment_count":0,"down_vote_count":0,"up_vote_count":56,"is_accepted":false,"score":56,"last_activity_date":1329083698,"creation_date":1329083698,"answer_id":9253085,"question_id":4862960,"body_markdown":"In order to avoid this kind of ClassCastException, if you have:\r\n\r\n    class A\r\n    class B extends A\r\n\r\nYou can define a constructor in B that takes an object of A. This way we can do the &quot;cast&quot; e.g.:\r\n\r\n    public B(A a) {\r\n        super(a.arg1, a.arg2); //arg1 and arg2 must be, at least, protected in class A\r\n        // If B class has more attributes, then you would initilize them here\r\n    }","title":"Explicit casting from super-class to sub-class","body":"<p>In order to avoid this kind of ClassCastException, if you have:</p>\n\n<pre><code>class A\nclass B extends A\n</code></pre>\n\n<p>You can define a constructor in B that takes an object of A. This way we can do the \"cast\" e.g.:</p>\n\n<pre><code>public B(A a) {\n    super(a.arg1, a.arg2); //arg1 and arg2 must be, at least, protected in class A\n    // If B class has more attributes, then you would initilize them here\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2315704,"reputation":11993,"user_id":2032823,"accept_rate":84,"display_name":"Zeeshan"},"comment_count":0,"down_vote_count":0,"up_vote_count":31,"is_accepted":false,"score":31,"last_activity_date":1564140172,"creation_date":1403528877,"answer_id":24366779,"question_id":4862960,"body_markdown":"*Elaborating the answer given by Michael Berry.*\r\n\r\n`Dog d = (Dog)Animal; //Compiles but fails at runtime`\r\n\r\nHere you are saying to the compiler &quot;Trust me. I know `d` is really referring to a `Dog` object&quot; although it&#39;s not. \r\n**Remember compiler is forced to trust us when we do a downcast**. \r\n \r\n&gt; The compiler only knows about the declared reference type. The JVM at runtime knows what the object really is. \r\n\r\nSo when the JVM at the runtime figures out that the `Dog d` is actually referring to an `Animal` and not a `Dog` object it says.\r\n Hey... you lied to the compiler and throws a big fat `ClassCastException`.\r\n\r\nSo if you are downcasting you should use `instanceof` test to avoid screwing up.\r\n\r\n`if (animal instanceof Dog) {\r\n    Dog dog = (Dog) animal;\r\n}`\r\n\r\nNow a question comes to our mind. Why the hell compiler is allowing the downcast when eventually it is going to throw a `java.lang.ClassCastException`?\r\n\r\nThe answer is that all the compiler can do is verify that the two types are in the same inheritance tree, so depending on whatever code might have\r\n come before the downcast, it&#39;s possible that `animal` is of type `dog`. \r\n &gt; The compiler must allow things that might possible work at runtime.\r\n \r\n Consider the following code snipet:\r\n \r\n\r\n    public static void main(String[] args) \r\n    {\t\r\n    \tDog d = getMeAnAnimal();// ERROR: Type mismatch: cannot convert Animal to Dog\r\n    \tDog d = (Dog)getMeAnAnimal(); // Downcast works fine. No ClassCastException :)\r\n    \td.eat();\r\n    \r\n    }\r\n    \r\n    private static Animal getMeAnAnimal()\r\n    {\r\n    \tAnimal animal = new Dog();\r\n    \treturn animal;\r\n    }\r\n\r\n \r\n However, if the compiler is sure that the cast would not possible work, compilation will fail. I.E. If you try to cast objects in different inheritance hierarchies \r\n\r\n `String s = (String)d; // ERROR : cannot cast for Dog to String`\r\n \r\n &gt;Unlike downcasting, upcasting works implicitly because when you upcast you are implicitly restricting the number of method you can invoke,\r\n as opposite to downcasting, which implies that later on, you might want to invoke a more specific method.\r\n \r\n `Dog d = new Dog();\r\n Animal animal1 = d;\t// Works fine with no explicit cast\r\n Animal animal2 = (Animal) d; // Works fine with n explicit cast`\r\n \r\n Both of the above upcast will work fine without any exception because a Dog IS-A Animal, anithing an Animal can do, a dog can do. But it&#39;s not true vica-versa.\r\n ","title":"Explicit casting from super-class to sub-class","body":"<p><em>Elaborating the answer given by Michael Berry.</em></p>\n\n<p><code>Dog d = (Dog)Animal; //Compiles but fails at runtime</code></p>\n\n<p>Here you are saying to the compiler \"Trust me. I know <code>d</code> is really referring to a <code>Dog</code> object\" although it's not. \n<strong>Remember compiler is forced to trust us when we do a downcast</strong>. </p>\n\n<blockquote>\n  <p>The compiler only knows about the declared reference type. The JVM at runtime knows what the object really is. </p>\n</blockquote>\n\n<p>So when the JVM at the runtime figures out that the <code>Dog d</code> is actually referring to an <code>Animal</code> and not a <code>Dog</code> object it says.\n Hey... you lied to the compiler and throws a big fat <code>ClassCastException</code>.</p>\n\n<p>So if you are downcasting you should use <code>instanceof</code> test to avoid screwing up.</p>\n\n<p><code>if (animal instanceof Dog) {\n    Dog dog = (Dog) animal;\n}</code></p>\n\n<p>Now a question comes to our mind. Why the hell compiler is allowing the downcast when eventually it is going to throw a <code>java.lang.ClassCastException</code>?</p>\n\n<p>The answer is that all the compiler can do is verify that the two types are in the same inheritance tree, so depending on whatever code might have\n come before the downcast, it's possible that <code>animal</code> is of type <code>dog</code>. </p>\n\n<blockquote>\n  <p>The compiler must allow things that might possible work at runtime.</p>\n</blockquote>\n\n<p>Consider the following code snipet:</p>\n\n<pre><code>public static void main(String[] args) \n{   \n    Dog d = getMeAnAnimal();// ERROR: Type mismatch: cannot convert Animal to Dog\n    Dog d = (Dog)getMeAnAnimal(); // Downcast works fine. No ClassCastException :)\n    d.eat();\n\n}\n\nprivate static Animal getMeAnAnimal()\n{\n    Animal animal = new Dog();\n    return animal;\n}\n</code></pre>\n\n<p>However, if the compiler is sure that the cast would not possible work, compilation will fail. I.E. If you try to cast objects in different inheritance hierarchies </p>\n\n<p><code>String s = (String)d; // ERROR : cannot cast for Dog to String</code></p>\n\n<blockquote>\n  <p>Unlike downcasting, upcasting works implicitly because when you upcast you are implicitly restricting the number of method you can invoke,\n   as opposite to downcasting, which implies that later on, you might want to invoke a more specific method.</p>\n</blockquote>\n\n<p><code>Dog d = new Dog();\n Animal animal1 = d;    // Works fine with no explicit cast\n Animal animal2 = (Animal) d; // Works fine with n explicit cast</code></p>\n\n<p>Both of the above upcast will work fine without any exception because a Dog IS-A Animal, anithing an Animal can do, a dog can do. But it's not true vica-versa.</p>\n"},{"tags":[],"owner":{"account_id":4094046,"reputation":1930,"user_id":3361335,"accept_rate":15,"display_name":"fresko"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1424271451,"creation_date":1424271451,"answer_id":28586625,"question_id":4862960,"body_markdown":"As explained, it is not possible.\r\nIf you want to use a method of the subclass, evaluate the possibility to add the method to the superclass (may be empty) and call from the subclasses getting the behaviour you want (subclass) thanks to polymorphism.\r\nSo when you call d.method() the call will succeed withoug casting, but in case the object will be not a dog, there will not be a problem","title":"Explicit casting from super-class to sub-class","body":"<p>As explained, it is not possible.\nIf you want to use a method of the subclass, evaluate the possibility to add the method to the superclass (may be empty) and call from the subclasses getting the behaviour you want (subclass) thanks to polymorphism.\nSo when you call d.method() the call will succeed withoug casting, but in case the object will be not a dog, there will not be a problem</p>\n"},{"tags":[],"owner":{"account_id":2233181,"reputation":3815,"user_id":1970299,"accept_rate":72,"display_name":"Mehdi"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1542950684,"creation_date":1542950684,"answer_id":53441037,"question_id":4862960,"body_markdown":"To develop the answer of @Caumons:\r\n\r\n&gt; Imagine one father class has many children and there is a need to add a common\r\n&gt; field into that class. If you consider the mentioned approach, you should\r\n&gt; go to each children class one by one and refactor their constructors for the new field.\r\n&gt; therefore that solution is not a promising solution in this scenario\r\n\r\nNow take a look at this solution.\r\n\r\n&gt; A father can receive an self object from each children. Here is a father\r\n&gt; class:\r\n\r\n    public class Father {\r\n    \r\n        protected String fatherField;\r\n    \r\n        public Father(Father a){\r\n            fatherField = a.fatherField;\r\n        }\r\n\r\n        //Second constructor\r\n        public Father(String fatherField){\r\n            this.fatherField = fatherField;\r\n        }\r\n\r\n        //.... Other constructors + Getters and Setters for the Fields\r\n    }\r\n\r\n&gt; Here is our child class that should implement one of its father\r\n&gt; constructor, in this case the aforementioned constructor :\r\n\r\n    public class Child extends Father {\r\n    \r\n        protected String childField;\r\n    \r\n        public Child(Father father, String childField ) {\r\n            super(father);\r\n            this.childField = childField;\r\n        }\r\n    \r\n        //.... Other constructors + Getters and Setters for the Fields\r\n    \r\n        @Override\r\n        public String toString() {\r\n            return String.format(&quot;Father Field is: %s\\nChild Field is: %s&quot;, fatherField, childField);\r\n        }\r\n    }\r\n\r\n\r\nNow we test out application:\r\n\r\n    public class Test {\r\n        public static void main(String[] args) {\r\n            Father fatherObj = new Father(&quot;Father String&quot;);\r\n            Child child = new Child(fatherObj, &quot;Child String&quot;);\r\n            System.out.println(child);\r\n        }\r\n    }\r\n\r\nAnd here is the result : \r\n\r\n&gt; Father Field is: Father String \r\n\r\n&gt; Child Field is: Child String\r\n\r\nNow you can easily add new fields to father class without being worried of your children codes to break;","title":"Explicit casting from super-class to sub-class","body":"<p>To develop the answer of @Caumons:</p>\n\n<blockquote>\n  <p>Imagine one father class has many children and there is a need to add a common\n  field into that class. If you consider the mentioned approach, you should\n  go to each children class one by one and refactor their constructors for the new field.\n  therefore that solution is not a promising solution in this scenario</p>\n</blockquote>\n\n<p>Now take a look at this solution.</p>\n\n<blockquote>\n  <p>A father can receive an self object from each children. Here is a father\n  class:</p>\n</blockquote>\n\n<pre><code>public class Father {\n\n    protected String fatherField;\n\n    public Father(Father a){\n        fatherField = a.fatherField;\n    }\n\n    //Second constructor\n    public Father(String fatherField){\n        this.fatherField = fatherField;\n    }\n\n    //.... Other constructors + Getters and Setters for the Fields\n}\n</code></pre>\n\n<blockquote>\n  <p>Here is our child class that should implement one of its father\n  constructor, in this case the aforementioned constructor :</p>\n</blockquote>\n\n<pre><code>public class Child extends Father {\n\n    protected String childField;\n\n    public Child(Father father, String childField ) {\n        super(father);\n        this.childField = childField;\n    }\n\n    //.... Other constructors + Getters and Setters for the Fields\n\n    @Override\n    public String toString() {\n        return String.format(\"Father Field is: %s\\nChild Field is: %s\", fatherField, childField);\n    }\n}\n</code></pre>\n\n<p>Now we test out application:</p>\n\n<pre><code>public class Test {\n    public static void main(String[] args) {\n        Father fatherObj = new Father(\"Father String\");\n        Child child = new Child(fatherObj, \"Child String\");\n        System.out.println(child);\n    }\n}\n</code></pre>\n\n<p>And here is the result : </p>\n\n<blockquote>\n  <p>Father Field is: Father String </p>\n  \n  <p>Child Field is: Child String</p>\n</blockquote>\n\n<p>Now you can easily add new fields to father class without being worried of your children codes to break;</p>\n"},{"tags":[],"owner":{"account_id":2109512,"reputation":310,"user_id":1875069,"display_name":"S01ds"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1648121214,"creation_date":1648121214,"answer_id":71601642,"question_id":4862960,"body_markdown":"As it was said before, you can&#39;t cast from superclass to subclass unless your object was instantiated from the subclass in the first place.\r\n\r\nHowever, there are workarounds.\r\n\r\nAll you need is a set of constructors and a convenience method that will either cast your object to Dog, or return a new Dog object with the same Animal properties.\r\n\r\nBelow is an example that does just that:\r\n\r\n\tpublic class Animal {\r\n\r\n\t    public Animal() {}\r\n\r\n\t    public Animal(Animal in) {\r\n\t    \t// Assign animal properties\r\n\t    }\r\n\r\n\t    public Dog toDog() {\r\n\t        if (this instanceof Dog)\r\n\t            return (Dog) this;\r\n\t        return new Dog(this);\r\n\t    }\r\n\r\n\t}\r\n\r\n\tpublic class Dog extends Animal {\r\n\r\n\t    public Dog(Animal in) {\r\n\t    \tsuper(in);\r\n\t    }\r\n\r\n\t    public void main(String[] args) {\r\n\t        Animal animal = new Animal();\r\n\t        Dog dog = animal.toDog();\r\n\t    }\r\n\r\n\t}","title":"Explicit casting from super-class to sub-class","body":"<p>As it was said before, you can't cast from superclass to subclass unless your object was instantiated from the subclass in the first place.</p>\n<p>However, there are workarounds.</p>\n<p>All you need is a set of constructors and a convenience method that will either cast your object to Dog, or return a new Dog object with the same Animal properties.</p>\n<p>Below is an example that does just that:</p>\n<pre><code>public class Animal {\n\n    public Animal() {}\n\n    public Animal(Animal in) {\n        // Assign animal properties\n    }\n\n    public Dog toDog() {\n        if (this instanceof Dog)\n            return (Dog) this;\n        return new Dog(this);\n    }\n\n}\n\npublic class Dog extends Animal {\n\n    public Dog(Animal in) {\n        super(in);\n    }\n\n    public void main(String[] args) {\n        Animal animal = new Animal();\n        Dog dog = animal.toDog();\n    }\n\n}\n</code></pre>\n"}],"owner":{"account_id":287330,"reputation":5349,"user_id":1470886,"accept_rate":41,"display_name":"saravanan"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":287378,"favorite_count":0,"down_vote_count":2,"up_vote_count":187,"accepted_answer_id":4863090,"answer_count":8,"score":185,"last_activity_date":1672922508,"creation_date":1296565860,"question_id":4862960,"body_markdown":"    public class Animal {\r\n        public void eat() {}\r\n    }\r\n\r\n    public class Dog extends Animal {\r\n        public void eat() {}\r\n\r\n        public void main(String[] args) {\r\n            Animal animal = new Animal();\r\n            Dog dog = (Dog) animal;\r\n        }\r\n    }\r\n\r\nThe assignment `Dog dog = (Dog) animal;` does not generate a compilation error, but at runtime it generates a `ClassCastException`. Why can&#39;t the compiler detect this error?\r\n","title":"Explicit casting from super-class to sub-class","body":"<pre><code>public class Animal {\n    public void eat() {}\n}\n\npublic class Dog extends Animal {\n    public void eat() {}\n\n    public void main(String[] args) {\n        Animal animal = new Animal();\n        Dog dog = (Dog) animal;\n    }\n}\n</code></pre>\n\n<p>The assignment <code>Dog dog = (Dog) animal;</code> does not generate a compilation error, but at runtime it generates a <code>ClassCastException</code>. Why can't the compiler detect this error?</p>\n"},{"tags":["java","android","sockets","xmpp","asmack"],"answers":[{"comments":[{"owner":{"account_id":3324280,"reputation":2469,"user_id":2794682,"accept_rate":44,"display_name":"Hassaan Rabbani"},"score":0,"creation_date":1394618840,"post_id":22347294,"comment_id":33966181,"body_markdown":"Great, now I am getting the response at one side and this is amazing thank you so much, but now how can i reply back to the server. for example i am using xmpp analyzer and i send disco#items query to my client which was received by my client, but client did not respond back to server. do i need to add response handler or something like that?","body":"Great, now I am getting the response at one side and this is amazing thank you so much, but now how can i reply back to the server. for example i am using xmpp analyzer and i send disco#items query to my client which was received by my client, but client did not respond back to server. do i need to add response handler or something like that?"},{"owner":{"account_id":3324280,"reputation":2469,"user_id":2794682,"accept_rate":44,"display_name":"Hassaan Rabbani"},"score":0,"creation_date":1394618918,"post_id":22347294,"comment_id":33966251,"body_markdown":"Secondly, how can I send raw xml query to server from client.? am i missing something there as well in the code?","body":"Secondly, how can I send raw xml query to server from client.? am i missing something there as well in the code?"},{"owner":{"account_id":1133306,"reputation":8320,"user_id":1118886,"accept_rate":68,"display_name":"Sheraz Ahmad Khilji"},"score":0,"creation_date":1394619830,"post_id":22347294,"comment_id":33966887,"body_markdown":"@HassaanRabbani Nic to know that the above solution worked. I haven&#39;t played too much with asmack xmpp and i haven&#39;t had experience with using disco#items query.So I suggest you make another question for this so that people who have more experience than me can guide you. If the above answer solved your problem then please accept it :)","body":"@HassaanRabbani Nic to know that the above solution worked. I haven&#39;t played too much with asmack xmpp and i haven&#39;t had experience with using disco#items query.So I suggest you make another question for this so that people who have more experience than me can guide you. If the above answer solved your problem then please accept it :)"},{"owner":{"account_id":3324280,"reputation":2469,"user_id":2794682,"accept_rate":44,"display_name":"Hassaan Rabbani"},"score":0,"creation_date":1394620897,"post_id":22347294,"comment_id":33967651,"body_markdown":"the above solution worked for one problem, that is receiving the IQ, what about sending the IQ? how can i send an IQ to the client from another client or from client to server?","body":"the above solution worked for one problem, that is receiving the IQ, what about sending the IQ? how can i send an IQ to the client from another client or from client to server?"},{"owner":{"account_id":1133306,"reputation":8320,"user_id":1118886,"accept_rate":68,"display_name":"Sheraz Ahmad Khilji"},"score":0,"creation_date":1394621121,"post_id":22347294,"comment_id":33967805,"body_markdown":"Take a look at this https://groups.google.com/forum/#!topic/prosody-users/8IW2t2i45Uk and http://community.igniterealtime.org/thread/40941","body":"Take a look at this <a href=\"https://groups.google.com/forum/#!topic/prosody-users/8IW2t2i45Uk\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/prosody-users/8IW2t2i45Uk</a> and <a href=\"http://community.igniterealtime.org/thread/40941\" rel=\"nofollow noreferrer\">community.igniterealtime.org/thread/40941</a>"},{"owner":{"account_id":4646044,"reputation":2898,"user_id":3764306,"accept_rate":25,"display_name":"Kamalakannan J"},"score":0,"creation_date":1484068768,"post_id":22347294,"comment_id":70354005,"body_markdown":"Is this features available on Smack library ?","body":"Is this features available on Smack library ?"}],"tags":[],"owner":{"account_id":1133306,"reputation":8320,"user_id":1118886,"accept_rate":68,"display_name":"Sheraz Ahmad Khilji"},"comment_count":6,"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1394617057,"creation_date":1394617057,"answer_id":22347294,"question_id":22344187,"body_markdown":"I think the problem is that your providers aren&#39;t registered. Please take a look at [this][1]. On Android you have to register the providers manually before you form an XMPP connection. Copy the class below into your project\r\n\r\n\r\n    import org.jivesoftware.smack.provider.PrivacyProvider;\r\n    import org.jivesoftware.smack.provider.ProviderManager;\r\n    import org.jivesoftware.smackx.GroupChatInvitation;\r\n    import org.jivesoftware.smackx.PrivateDataManager;\r\n    import org.jivesoftware.smackx.packet.ChatStateExtension;\r\n    import org.jivesoftware.smackx.packet.LastActivity;\r\n    import org.jivesoftware.smackx.packet.OfflineMessageInfo;\r\n    import org.jivesoftware.smackx.packet.OfflineMessageRequest;\r\n    import org.jivesoftware.smackx.packet.SharedGroupsInfo;\r\n    import org.jivesoftware.smackx.provider.AdHocCommandDataProvider;\r\n    import org.jivesoftware.smackx.provider.BytestreamsProvider;\r\n    import org.jivesoftware.smackx.provider.DataFormProvider;\r\n    import org.jivesoftware.smackx.provider.DelayInformationProvider;\r\n    import org.jivesoftware.smackx.provider.DiscoverInfoProvider;\r\n    import org.jivesoftware.smackx.provider.DiscoverItemsProvider;\r\n    import org.jivesoftware.smackx.provider.MUCAdminProvider;\r\n    import org.jivesoftware.smackx.provider.MUCOwnerProvider;\r\n    import org.jivesoftware.smackx.provider.MUCUserProvider;\r\n    import org.jivesoftware.smackx.provider.MessageEventProvider;\r\n    import org.jivesoftware.smackx.provider.MultipleAddressesProvider;\r\n    import org.jivesoftware.smackx.provider.RosterExchangeProvider;\r\n    import org.jivesoftware.smackx.provider.StreamInitiationProvider;\r\n    import org.jivesoftware.smackx.provider.VCardProvider;\r\n    import org.jivesoftware.smackx.provider.XHTMLExtensionProvider;\r\n    import org.jivesoftware.smackx.search.UserSearch;\r\n    \r\n    import android.util.Log;\r\n    \r\n    public class ServiceProviders {\r\n    \tpublic static void Register_Providers(ProviderManager pm) {\r\n    \r\n    \t\t// Private Data Storage\r\n    \t\tpm.addIQProvider(&quot;query&quot;, &quot;jabber:iq:private&quot;,\r\n    \t\t\t\tnew PrivateDataManager.PrivateDataIQProvider());\r\n    \r\n    \t\t// Time\r\n    \t\ttry {\r\n    \t\t\tpm.addIQProvider(&quot;query&quot;, &quot;jabber:iq:time&quot;,\r\n    \t\t\t\t\tClass.forName(&quot;org.jivesoftware.smackx.packet.Time&quot;));\r\n    \t\t} catch (ClassNotFoundException e) {\r\n    \t\t\tLog.w(&quot;TestClient&quot;,\r\n    \t\t\t\t\t&quot;Can&#39;t load class for org.jivesoftware.smackx.packet.Time&quot;);\r\n    \t\t}\r\n    \r\n    \t\t// Roster Exchange\r\n    \t\tpm.addExtensionProvider(&quot;x&quot;, &quot;jabber:x:roster&quot;,\r\n    \t\t\t\tnew RosterExchangeProvider());\r\n    \r\n    \t\t// Message Events\r\n    \t\tpm.addExtensionProvider(&quot;x&quot;, &quot;jabber:x:event&quot;,\r\n    \t\t\t\tnew MessageEventProvider());\r\n    \r\n    \t\t// Chat State\r\n    \t\tpm.addExtensionProvider(&quot;active&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/chatstates&quot;,\r\n    \t\t\t\tnew ChatStateExtension.Provider());\r\n    \r\n    \t\tpm.addExtensionProvider(&quot;composing&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/chatstates&quot;,\r\n    \t\t\t\tnew ChatStateExtension.Provider());\r\n    \r\n    \t\tpm.addExtensionProvider(&quot;paused&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/chatstates&quot;,\r\n    \t\t\t\tnew ChatStateExtension.Provider());\r\n    \r\n    \t\tpm.addExtensionProvider(&quot;inactive&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/chatstates&quot;,\r\n    \t\t\t\tnew ChatStateExtension.Provider());\r\n    \r\n    \t\tpm.addExtensionProvider(&quot;gone&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/chatstates&quot;,\r\n    \t\t\t\tnew ChatStateExtension.Provider());\r\n    \r\n    \t\t// XHTML\r\n    \t\tpm.addExtensionProvider(&quot;html&quot;, &quot;http://jabber.org/protocol/xhtml-im&quot;,\r\n    \t\t\t\tnew XHTMLExtensionProvider());\r\n    \r\n    \t\t// Group Chat Invitations\r\n    \t\tpm.addExtensionProvider(&quot;x&quot;, &quot;jabber:x:conference&quot;,\r\n    \t\t\t\tnew GroupChatInvitation.Provider());\r\n    \r\n    \t\t// Service Discovery # Items\r\n    \t\tpm.addIQProvider(&quot;query&quot;, &quot;http://jabber.org/protocol/disco#items&quot;,\r\n    \t\t\t\tnew DiscoverItemsProvider());\r\n    \r\n    \t\t// Service Discovery # Info\r\n    \t\tpm.addIQProvider(&quot;query&quot;, &quot;http://jabber.org/protocol/disco#info&quot;,\r\n    \t\t\t\tnew DiscoverInfoProvider());\r\n    \r\n    \t\t// Data Forms\r\n    \t\tpm.addExtensionProvider(&quot;x&quot;, &quot;jabber:x:data&quot;, new DataFormProvider());\r\n    \r\n    \t\t// MUC User\r\n    \t\tpm.addExtensionProvider(&quot;x&quot;, &quot;http://jabber.org/protocol/muc#user&quot;,\r\n    \t\t\t\tnew MUCUserProvider());\r\n    \r\n    \t\t// MUC Admin\r\n    \t\tpm.addIQProvider(&quot;query&quot;, &quot;http://jabber.org/protocol/muc#admin&quot;,\r\n    \t\t\t\tnew MUCAdminProvider());\r\n    \r\n    \t\t// MUC Owner\r\n    \t\tpm.addIQProvider(&quot;query&quot;, &quot;http://jabber.org/protocol/muc#owner&quot;,\r\n    \t\t\t\tnew MUCOwnerProvider());\r\n    \r\n    \t\t// Delayed Delivery\r\n    \t\tpm.addExtensionProvider(&quot;x&quot;, &quot;jabber:x:delay&quot;,\r\n    \t\t\t\tnew DelayInformationProvider());\r\n    \r\n    \t\t// Version\r\n    \t\ttry {\r\n    \t\t\tpm.addIQProvider(&quot;query&quot;, &quot;jabber:iq:version&quot;,\r\n    \t\t\t\t\tClass.forName(&quot;org.jivesoftware.smackx.packet.Version&quot;));\r\n    \t\t} catch (ClassNotFoundException e) {\r\n    \t\t\t// Not sure what&#39;s happening here.\r\n    \t\t}\r\n    \r\n    \t\t// VCard\r\n    \t\tpm.addIQProvider(&quot;vCard&quot;, &quot;vcard-temp&quot;, new VCardProvider());\r\n    \r\n    \t\t// Offline Message Requests\r\n    \t\tpm.addIQProvider(&quot;offline&quot;, &quot;http://jabber.org/protocol/offline&quot;,\r\n    \t\t\t\tnew OfflineMessageRequest.Provider());\r\n    \r\n    \t\t// Offline Message Indicator\r\n    \t\tpm.addExtensionProvider(&quot;offline&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/offline&quot;,\r\n    \t\t\t\tnew OfflineMessageInfo.Provider());\r\n    \r\n    \t\t// Last Activity\r\n    \t\tpm.addIQProvider(&quot;query&quot;, &quot;jabber:iq:last&quot;, new LastActivity.Provider());\r\n    \r\n    \t\t// User Search\r\n    \t\tpm.addIQProvider(&quot;query&quot;, &quot;jabber:iq:search&quot;, new UserSearch.Provider());\r\n    \r\n    \t\t// SharedGroupsInfo\r\n    \t\tpm.addIQProvider(&quot;sharedgroup&quot;,\r\n    \t\t\t\t&quot;http://www.jivesoftware.org/protocol/sharedgroup&quot;,\r\n    \t\t\t\tnew SharedGroupsInfo.Provider());\r\n    \r\n    \t\t// JEP-33: Extended Stanza Addressing\r\n    \t\tpm.addExtensionProvider(&quot;addresses&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/address&quot;,\r\n    \t\t\t\tnew MultipleAddressesProvider());\r\n    \r\n    \t\t// FileTransfer\r\n    \t\tpm.addIQProvider(&quot;si&quot;, &quot;http://jabber.org/protocol/si&quot;,\r\n    \t\t\t\tnew StreamInitiationProvider());\r\n    \r\n    \t\tpm.addIQProvider(&quot;query&quot;, &quot;http://jabber.org/protocol/bytestreams&quot;,\r\n    \t\t\t\tnew BytestreamsProvider());\r\n    \r\n    \t\t// Privacy\r\n    \t\tpm.addIQProvider(&quot;query&quot;, &quot;jabber:iq:privacy&quot;, new PrivacyProvider());\r\n    \r\n    \t\tpm.addIQProvider(&quot;command&quot;, &quot;http://jabber.org/protocol/commands&quot;,\r\n    \t\t\t\tnew AdHocCommandDataProvider());\r\n    \t\tpm.addExtensionProvider(&quot;malformed-action&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/commands&quot;,\r\n    \t\t\t\tnew AdHocCommandDataProvider.MalformedActionError());\r\n    \t\tpm.addExtensionProvider(&quot;bad-locale&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/commands&quot;,\r\n    \t\t\t\tnew AdHocCommandDataProvider.BadLocaleError());\r\n    \t\tpm.addExtensionProvider(&quot;bad-payload&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/commands&quot;,\r\n    \t\t\t\tnew AdHocCommandDataProvider.BadPayloadError());\r\n    \t\tpm.addExtensionProvider(&quot;bad-sessionid&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/commands&quot;,\r\n    \t\t\t\tnew AdHocCommandDataProvider.BadSessionIDError());\r\n    \t\tpm.addExtensionProvider(&quot;session-expired&quot;,\r\n    \t\t\t\t&quot;http://jabber.org/protocol/commands&quot;,\r\n    \t\t\t\tnew AdHocCommandDataProvider.SessionExpiredError());\r\n    \r\n    \t\tpm.addIQProvider(&quot;query&quot;, &quot;http://jabber.org/protocol/disco#info&quot;,\r\n    \t\t\t\tnew DiscoverInfoProvider());\r\n    \t\tpm.addExtensionProvider(&quot;x&quot;, &quot;jabber:x:data&quot;, new DataFormProvider());\r\n    \t\t// pm.addExtensionProvider(&quot;status &quot;,&quot;&quot;, new XMLPlayerList());\r\n    \r\n    \t}\r\n    }\r\n\r\n\r\nCall this method like this\r\n\r\n    ServiceProviders.Register_Providers(ProviderManager.getInstance());\r\n\r\nSo try calling this method at the start of your app or before forming a connection.\r\n\r\nHope this helps\r\n\r\n\r\n  [1]: http://community.igniterealtime.org/thread/31118","title":"Send and Receive IQ XMPP ASMACK Android","body":"<p>I think the problem is that your providers aren't registered. Please take a look at <a href=\"http://community.igniterealtime.org/thread/31118\" rel=\"nofollow\">this</a>. On Android you have to register the providers manually before you form an XMPP connection. Copy the class below into your project</p>\n\n<pre><code>import org.jivesoftware.smack.provider.PrivacyProvider;\nimport org.jivesoftware.smack.provider.ProviderManager;\nimport org.jivesoftware.smackx.GroupChatInvitation;\nimport org.jivesoftware.smackx.PrivateDataManager;\nimport org.jivesoftware.smackx.packet.ChatStateExtension;\nimport org.jivesoftware.smackx.packet.LastActivity;\nimport org.jivesoftware.smackx.packet.OfflineMessageInfo;\nimport org.jivesoftware.smackx.packet.OfflineMessageRequest;\nimport org.jivesoftware.smackx.packet.SharedGroupsInfo;\nimport org.jivesoftware.smackx.provider.AdHocCommandDataProvider;\nimport org.jivesoftware.smackx.provider.BytestreamsProvider;\nimport org.jivesoftware.smackx.provider.DataFormProvider;\nimport org.jivesoftware.smackx.provider.DelayInformationProvider;\nimport org.jivesoftware.smackx.provider.DiscoverInfoProvider;\nimport org.jivesoftware.smackx.provider.DiscoverItemsProvider;\nimport org.jivesoftware.smackx.provider.MUCAdminProvider;\nimport org.jivesoftware.smackx.provider.MUCOwnerProvider;\nimport org.jivesoftware.smackx.provider.MUCUserProvider;\nimport org.jivesoftware.smackx.provider.MessageEventProvider;\nimport org.jivesoftware.smackx.provider.MultipleAddressesProvider;\nimport org.jivesoftware.smackx.provider.RosterExchangeProvider;\nimport org.jivesoftware.smackx.provider.StreamInitiationProvider;\nimport org.jivesoftware.smackx.provider.VCardProvider;\nimport org.jivesoftware.smackx.provider.XHTMLExtensionProvider;\nimport org.jivesoftware.smackx.search.UserSearch;\n\nimport android.util.Log;\n\npublic class ServiceProviders {\n    public static void Register_Providers(ProviderManager pm) {\n\n        // Private Data Storage\n        pm.addIQProvider(\"query\", \"jabber:iq:private\",\n                new PrivateDataManager.PrivateDataIQProvider());\n\n        // Time\n        try {\n            pm.addIQProvider(\"query\", \"jabber:iq:time\",\n                    Class.forName(\"org.jivesoftware.smackx.packet.Time\"));\n        } catch (ClassNotFoundException e) {\n            Log.w(\"TestClient\",\n                    \"Can't load class for org.jivesoftware.smackx.packet.Time\");\n        }\n\n        // Roster Exchange\n        pm.addExtensionProvider(\"x\", \"jabber:x:roster\",\n                new RosterExchangeProvider());\n\n        // Message Events\n        pm.addExtensionProvider(\"x\", \"jabber:x:event\",\n                new MessageEventProvider());\n\n        // Chat State\n        pm.addExtensionProvider(\"active\",\n                \"http://jabber.org/protocol/chatstates\",\n                new ChatStateExtension.Provider());\n\n        pm.addExtensionProvider(\"composing\",\n                \"http://jabber.org/protocol/chatstates\",\n                new ChatStateExtension.Provider());\n\n        pm.addExtensionProvider(\"paused\",\n                \"http://jabber.org/protocol/chatstates\",\n                new ChatStateExtension.Provider());\n\n        pm.addExtensionProvider(\"inactive\",\n                \"http://jabber.org/protocol/chatstates\",\n                new ChatStateExtension.Provider());\n\n        pm.addExtensionProvider(\"gone\",\n                \"http://jabber.org/protocol/chatstates\",\n                new ChatStateExtension.Provider());\n\n        // XHTML\n        pm.addExtensionProvider(\"html\", \"http://jabber.org/protocol/xhtml-im\",\n                new XHTMLExtensionProvider());\n\n        // Group Chat Invitations\n        pm.addExtensionProvider(\"x\", \"jabber:x:conference\",\n                new GroupChatInvitation.Provider());\n\n        // Service Discovery # Items\n        pm.addIQProvider(\"query\", \"http://jabber.org/protocol/disco#items\",\n                new DiscoverItemsProvider());\n\n        // Service Discovery # Info\n        pm.addIQProvider(\"query\", \"http://jabber.org/protocol/disco#info\",\n                new DiscoverInfoProvider());\n\n        // Data Forms\n        pm.addExtensionProvider(\"x\", \"jabber:x:data\", new DataFormProvider());\n\n        // MUC User\n        pm.addExtensionProvider(\"x\", \"http://jabber.org/protocol/muc#user\",\n                new MUCUserProvider());\n\n        // MUC Admin\n        pm.addIQProvider(\"query\", \"http://jabber.org/protocol/muc#admin\",\n                new MUCAdminProvider());\n\n        // MUC Owner\n        pm.addIQProvider(\"query\", \"http://jabber.org/protocol/muc#owner\",\n                new MUCOwnerProvider());\n\n        // Delayed Delivery\n        pm.addExtensionProvider(\"x\", \"jabber:x:delay\",\n                new DelayInformationProvider());\n\n        // Version\n        try {\n            pm.addIQProvider(\"query\", \"jabber:iq:version\",\n                    Class.forName(\"org.jivesoftware.smackx.packet.Version\"));\n        } catch (ClassNotFoundException e) {\n            // Not sure what's happening here.\n        }\n\n        // VCard\n        pm.addIQProvider(\"vCard\", \"vcard-temp\", new VCardProvider());\n\n        // Offline Message Requests\n        pm.addIQProvider(\"offline\", \"http://jabber.org/protocol/offline\",\n                new OfflineMessageRequest.Provider());\n\n        // Offline Message Indicator\n        pm.addExtensionProvider(\"offline\",\n                \"http://jabber.org/protocol/offline\",\n                new OfflineMessageInfo.Provider());\n\n        // Last Activity\n        pm.addIQProvider(\"query\", \"jabber:iq:last\", new LastActivity.Provider());\n\n        // User Search\n        pm.addIQProvider(\"query\", \"jabber:iq:search\", new UserSearch.Provider());\n\n        // SharedGroupsInfo\n        pm.addIQProvider(\"sharedgroup\",\n                \"http://www.jivesoftware.org/protocol/sharedgroup\",\n                new SharedGroupsInfo.Provider());\n\n        // JEP-33: Extended Stanza Addressing\n        pm.addExtensionProvider(\"addresses\",\n                \"http://jabber.org/protocol/address\",\n                new MultipleAddressesProvider());\n\n        // FileTransfer\n        pm.addIQProvider(\"si\", \"http://jabber.org/protocol/si\",\n                new StreamInitiationProvider());\n\n        pm.addIQProvider(\"query\", \"http://jabber.org/protocol/bytestreams\",\n                new BytestreamsProvider());\n\n        // Privacy\n        pm.addIQProvider(\"query\", \"jabber:iq:privacy\", new PrivacyProvider());\n\n        pm.addIQProvider(\"command\", \"http://jabber.org/protocol/commands\",\n                new AdHocCommandDataProvider());\n        pm.addExtensionProvider(\"malformed-action\",\n                \"http://jabber.org/protocol/commands\",\n                new AdHocCommandDataProvider.MalformedActionError());\n        pm.addExtensionProvider(\"bad-locale\",\n                \"http://jabber.org/protocol/commands\",\n                new AdHocCommandDataProvider.BadLocaleError());\n        pm.addExtensionProvider(\"bad-payload\",\n                \"http://jabber.org/protocol/commands\",\n                new AdHocCommandDataProvider.BadPayloadError());\n        pm.addExtensionProvider(\"bad-sessionid\",\n                \"http://jabber.org/protocol/commands\",\n                new AdHocCommandDataProvider.BadSessionIDError());\n        pm.addExtensionProvider(\"session-expired\",\n                \"http://jabber.org/protocol/commands\",\n                new AdHocCommandDataProvider.SessionExpiredError());\n\n        pm.addIQProvider(\"query\", \"http://jabber.org/protocol/disco#info\",\n                new DiscoverInfoProvider());\n        pm.addExtensionProvider(\"x\", \"jabber:x:data\", new DataFormProvider());\n        // pm.addExtensionProvider(\"status \",\"\", new XMLPlayerList());\n\n    }\n}\n</code></pre>\n\n<p>Call this method like this</p>\n\n<pre><code>ServiceProviders.Register_Providers(ProviderManager.getInstance());\n</code></pre>\n\n<p>So try calling this method at the start of your app or before forming a connection.</p>\n\n<p>Hope this helps</p>\n"},{"tags":[],"owner":{"account_id":11388548,"reputation":1,"user_id":8349438,"display_name":"Kevin Chen"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672921896,"creation_date":1530099050,"answer_id":51061708,"question_id":22344187,"body_markdown":"For sent out, you actually just need to construct the xml string and return in `getChildElementXML()`, no other setup needed.\r\n\r\nAs mentioned in this blog post: https://billynyh.github.io/blog/2014/09/28/android-xmpp-dev/\r\n\r\n&gt; For receiving IQ response, first you need to create IQProvider and add\r\n&gt; to ProviderManager, matching the xmlns in the query object. The\r\n&gt; IQProvider is used to convert the response packet to your customized\r\n&gt; IQ object. Then you need to extends PacketListener, and when you\r\n&gt; create the connection object, add the listener to it, with a\r\n&gt; PacketTypeFilter to match your IQ class. With both provider and\r\n&gt; listener setup correctly, you should be able to receive the response\r\n&gt; of the IQ.","title":"Send and Receive IQ XMPP ASMACK Android","body":"<p>For sent out, you actually just need to construct the xml string and return in <code>getChildElementXML()</code>, no other setup needed.</p>\n<p>As mentioned in this blog post: <a href=\"https://billynyh.github.io/blog/2014/09/28/android-xmpp-dev/\" rel=\"nofollow noreferrer\">https://billynyh.github.io/blog/2014/09/28/android-xmpp-dev/</a></p>\n<blockquote>\n<p>For receiving IQ response, first you need to create IQProvider and add\nto ProviderManager, matching the xmlns in the query object. The\nIQProvider is used to convert the response packet to your customized\nIQ object. Then you need to extends PacketListener, and when you\ncreate the connection object, add the listener to it, with a\nPacketTypeFilter to match your IQ class. With both provider and\nlistener setup correctly, you should be able to receive the response\nof the IQ.</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":13856402,"reputation":31,"user_id":10003092,"display_name":"Z. Mei"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1530277943,"creation_date":1530277943,"answer_id":51102588,"question_id":22344187,"body_markdown":"When sending a self-define message, for example,\r\n\r\n    &lt;iq id=&#39;123&#39; type=&#39;get&#39; from=&#39;client@xmpp/B&#39; to=&#39;client2@xmpp/s2&#39;&gt;&lt;req var=&#39;read&#39;&gt;&lt;attr var=&#39;temprature&#39;/&gt;&lt;/req&gt;&lt;/iq&gt;\r\n\r\nYou need to define your own IQ and send this IQ:\r\n\r\n\r\n    public class MyIQ extends IQ {\r\n            @Override\r\n            public String getChildElementXML() {\r\n                StringBuilder stringBuilder = new StringBuilder();\r\n                stringBuilder.append(&quot;&amp;lt;req var=&#39;read&#39;&amp;gt;&amp;lt; attr var=&#39;temprature&#39;/&amp;gt;&amp;lt;/req&amp;gt;&quot;);\r\n                return stringBuilder.toString();\r\n            }\r\n        }\r\n       \r\n        MyIQ packet = new MyIQ();\r\n        packet.setType(IQ.Type.GET);\r\n        packet.setFrom(&quot;client@xmpp/B&quot;);\r\n        packet.setTo(&quot;client2@xmpp/s2&quot;);\r\n        xmppConnection.sendPacket(packet);\r\n\r\n ","title":"Send and Receive IQ XMPP ASMACK Android","body":"<p>When sending a self-define message, for example,</p>\n\n<pre><code>&lt;iq id='123' type='get' from='client@xmpp/B' to='client2@xmpp/s2'&gt;&lt;req var='read'&gt;&lt;attr var='temprature'/&gt;&lt;/req&gt;&lt;/iq&gt;\n</code></pre>\n\n<p>You need to define your own IQ and send this IQ:</p>\n\n<pre><code>public class MyIQ extends IQ {\n        @Override\n        public String getChildElementXML() {\n            StringBuilder stringBuilder = new StringBuilder();\n            stringBuilder.append(\"&amp;lt;req var='read'&amp;gt;&amp;lt; attr var='temprature'/&amp;gt;&amp;lt;/req&amp;gt;\");\n            return stringBuilder.toString();\n        }\n    }\n\n    MyIQ packet = new MyIQ();\n    packet.setType(IQ.Type.GET);\n    packet.setFrom(\"client@xmpp/B\");\n    packet.setTo(\"client2@xmpp/s2\");\n    xmppConnection.sendPacket(packet);\n</code></pre>\n"}],"owner":{"account_id":3324280,"reputation":2469,"user_id":2794682,"accept_rate":44,"display_name":"Hassaan Rabbani"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":6187,"favorite_count":0,"down_vote_count":1,"up_vote_count":10,"accepted_answer_id":22347294,"answer_count":3,"score":9,"last_activity_date":1672921896,"creation_date":1394607693,"question_id":22344187,"body_markdown":"**Background:**\r\n\r\nI have been able to implement one to one chatting through `XMPP` in android using `asmack` library. I am able to send presence to the server as well. I am using `OpenFire` server for my Chat based application. \r\n\r\n**Problem:**\r\nI am using `connection.addPacketListener(new PacketListener()`  to receive message and IQ packets, for message packets I have classified it like this\r\n\r\n    PacketFilter Chatfilter = new MessageTypeFilter(Message.Type.chat);\r\n    connection.addPacketListener(new PacketListener() {\r\n            public void processPacket(Packet packet) {\r\n                Message message = (Message) packet;\r\n                if (message.getBody() != null) {\r\n                    String fromName = StringUtils.parseBareAddress(message.getFrom());\r\n                    Log.i(&quot;XMPPClient&quot;, &quot;Got text [&quot; + message.getBody() + &quot;] from [&quot; + fromName + &quot;]&quot;);\r\n                    messages.add(fromName + &quot;:&quot;);\r\n                    m1=message.getBody();\r\n                    messages.add(message.getBody());\r\n                    // Add the incoming message to the list view\r\n                    /* mHandler.post(new Runnable() {\r\n                    public void run() {\r\n                    setListAdapter();\r\n                    recieve.setText(m1);\r\n                    }\r\n                    });*/\r\n                }\r\n            }\r\n    }, Chatfilter);\r\n\r\nAnd it is working all fine, but **problem arises when** I use something similar to receive IQ packets\r\n\r\nHere is the code which I am using to receive IQ PACKETS\r\n\r\n    PacketFilter Iqfilter = new IQTypeFilter(IQ.Type.RESULT);\r\n    connection.addPacketListener(new PacketListener() {\r\n        public void processPacket(Packet packet) {\r\n            IQ iq = (IQ) packet;\r\n            String fromName = StringUtils.parseBareAddress(iq.getFrom());\r\n            Log.i(&quot;XMPPClient&quot;, &quot;Got text [&quot; + iq.toString() + &quot;] from [&quot; + fromName + &quot;]&quot;);\r\n            m1=iq.getFrom();\r\n            mHandler.post(new Runnable() {\r\n                public void run() {\r\n                    setListAdapter();\r\n                    recieve.setText(m1);\r\n                }\r\n            });\r\n        }\r\n    }, Iqfilter);\r\n\r\nI am sending a simple `disco#items` query and it does not respond, even it does not enter into the function, I have tried to debug it as well, I have also tried to send simple `PING` command but it does not respond to it either. **what am I missing here?**\r\n\r\nSecondly I am facing problems in sending IQ packets to the server as well or to some other client as well. I read somewhere that I should do it like this. but it does not work.\r\n\r\n    final IQ iq = new IQ() {\r\n            \tpublic String getChildElementXML() { \r\n            \treturn &quot;&lt;query xmlns=&#39;http://jabber.org/protocol/disco#info&#39;/&gt;&quot;; // here is your query\r\n            \t//this returns &quot;&lt;iq type=&#39;get&#39; from=&#39;User@YourServer/Resource&#39; id=&#39;info1&#39;&gt; &lt;query xmlns=&#39;http://jabber.org/protocol/disco#info&#39;/&gt;&lt;/iq&gt;&quot;;\r\n            \t }};\r\n            \t// set the type\r\n            \tiq.setType(IQ.Type.GET);\r\n\r\n            \t// send the request\r\n            \tconnection.sendPacket(iq);\r\n\r\nThe confusing thing is when I read the documentation of XMPP and asmack for android it was written that to send an IQ you need to have receiver&#39;s address as well. but in this code we are not setting up any receiver.\r\n\r\nThere is much less information available on internet for XMPP asmack and Android. ","title":"Send and Receive IQ XMPP ASMACK Android","body":"<p><strong>Background:</strong></p>\n\n<p>I have been able to implement one to one chatting through <code>XMPP</code> in android using <code>asmack</code> library. I am able to send presence to the server as well. I am using <code>OpenFire</code> server for my Chat based application. </p>\n\n<p><strong>Problem:</strong>\nI am using <code>connection.addPacketListener(new PacketListener()</code>  to receive message and IQ packets, for message packets I have classified it like this</p>\n\n<pre><code>PacketFilter Chatfilter = new MessageTypeFilter(Message.Type.chat);\nconnection.addPacketListener(new PacketListener() {\n        public void processPacket(Packet packet) {\n            Message message = (Message) packet;\n            if (message.getBody() != null) {\n                String fromName = StringUtils.parseBareAddress(message.getFrom());\n                Log.i(\"XMPPClient\", \"Got text [\" + message.getBody() + \"] from [\" + fromName + \"]\");\n                messages.add(fromName + \":\");\n                m1=message.getBody();\n                messages.add(message.getBody());\n                // Add the incoming message to the list view\n                /* mHandler.post(new Runnable() {\n                public void run() {\n                setListAdapter();\n                recieve.setText(m1);\n                }\n                });*/\n            }\n        }\n}, Chatfilter);\n</code></pre>\n\n<p>And it is working all fine, but <strong>problem arises when</strong> I use something similar to receive IQ packets</p>\n\n<p>Here is the code which I am using to receive IQ PACKETS</p>\n\n<pre><code>PacketFilter Iqfilter = new IQTypeFilter(IQ.Type.RESULT);\nconnection.addPacketListener(new PacketListener() {\n    public void processPacket(Packet packet) {\n        IQ iq = (IQ) packet;\n        String fromName = StringUtils.parseBareAddress(iq.getFrom());\n        Log.i(\"XMPPClient\", \"Got text [\" + iq.toString() + \"] from [\" + fromName + \"]\");\n        m1=iq.getFrom();\n        mHandler.post(new Runnable() {\n            public void run() {\n                setListAdapter();\n                recieve.setText(m1);\n            }\n        });\n    }\n}, Iqfilter);\n</code></pre>\n\n<p>I am sending a simple <code>disco#items</code> query and it does not respond, even it does not enter into the function, I have tried to debug it as well, I have also tried to send simple <code>PING</code> command but it does not respond to it either. <strong>what am I missing here?</strong></p>\n\n<p>Secondly I am facing problems in sending IQ packets to the server as well or to some other client as well. I read somewhere that I should do it like this. but it does not work.</p>\n\n<pre><code>final IQ iq = new IQ() {\n            public String getChildElementXML() { \n            return \"&lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;\"; // here is your query\n            //this returns \"&lt;iq type='get' from='User@YourServer/Resource' id='info1'&gt; &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;&lt;/iq&gt;\";\n             }};\n            // set the type\n            iq.setType(IQ.Type.GET);\n\n            // send the request\n            connection.sendPacket(iq);\n</code></pre>\n\n<p>The confusing thing is when I read the documentation of XMPP and asmack for android it was written that to send an IQ you need to have receiver's address as well. but in this code we are not setting up any receiver.</p>\n\n<p>There is much less information available on internet for XMPP asmack and Android. </p>\n"},{"tags":["java","maven","refactoring"],"comments":[{"owner":{"account_id":1042328,"reputation":7972,"user_id":1048093,"accept_rate":75,"display_name":"wemu"},"score":1,"creation_date":1383754713,"post_id":19816278,"comment_id":29464346,"body_markdown":"I&#39;m not aware of a tool or a maven plugin that does this. I usually use the IDE and its search and replace features. Just be careful if you use the groupId for several artifactId&#39;s.","body":"I&#39;m not aware of a tool or a maven plugin that does this. I usually use the IDE and its search and replace features. Just be careful if you use the groupId for several artifactId&#39;s."},{"owner":{"account_id":3381550,"reputation":1165,"user_id":2838491,"accept_rate":29,"display_name":"joao cenoura"},"score":3,"creation_date":1383757891,"post_id":19816278,"comment_id":29466370,"body_markdown":"I&#39;ve ended up using sed: `find ~/project/trunk -name &quot;pom.xml&quot; | xargs sed -i &#39;s/&lt;groupId&gt;org.old.groupId&lt;\\/groupId&gt;/&lt;groupId&gt;org.new.groupId&lt;\\/groupId&gt;/g&#39;`. It worked like a charm, but still I was curious if there was a mojo outwhere.","body":"I&#39;ve ended up using sed: <code>find ~&#47;project&#47;trunk -name &quot;pom.xml&quot; | xargs sed -i &#39;s&#47;&lt;groupId&gt;org.old.groupId&lt;\\&#47;groupId&gt;&#47;&lt;groupId&gt;org.new.grou&zwnj;&#8203;pId&lt;\\&#47;groupId&gt;&#47;g&#39;</code>. It worked like a charm, but still I was curious if there was a mojo outwhere."},{"owner":{"account_id":1042328,"reputation":7972,"user_id":1048093,"accept_rate":75,"display_name":"wemu"},"score":2,"creation_date":1383812521,"post_id":19816278,"comment_id":29487794,"body_markdown":"out of curiosity I found: http://docs.codehaus.org/display/MAVENUSER/PomMavenPlugin but it seems a bit old :)","body":"out of curiosity I found: <a href=\"http://docs.codehaus.org/display/MAVENUSER/PomMavenPlugin\" rel=\"nofollow noreferrer\">docs.codehaus.org/display/MAVENUSER/PomMavenPlugin</a> but it seems a bit old :)"},{"owner":{"account_id":3381550,"reputation":1165,"user_id":2838491,"accept_rate":29,"display_name":"joao cenoura"},"score":1,"creation_date":1383850381,"post_id":19816278,"comment_id":29510784,"body_markdown":"Thanks! That was exactly what I was looking for. Quite a pity it is pretty much abandoned...","body":"Thanks! That was exactly what I was looking for. Quite a pity it is pretty much abandoned..."},{"owner":{"account_id":7547772,"reputation":8593,"user_id":5730279,"display_name":"hc_dev"},"score":0,"creation_date":1618125983,"post_id":19816278,"comment_id":118503444,"body_markdown":"@wemu You should add an answer. A solving comment is harder to find by others asking the same &#129300;","body":"@wemu You should add an answer. A solving comment is harder to find by others asking the same ü§î"},{"owner":{"account_id":3044540,"reputation":877,"user_id":2580580,"accept_rate":67,"display_name":"Sebastian"},"score":1,"creation_date":1619974012,"post_id":19816278,"comment_id":119059499,"body_markdown":"sometimes searching and using a tool is slower than just doing it :-)","body":"sometimes searching and using a tool is slower than just doing it :-)"}],"answers":[{"comments":[{"owner":{"account_id":4302704,"reputation":1236,"user_id":3516034,"display_name":"Phil"},"score":1,"creation_date":1499463129,"post_id":44979656,"comment_id":76935267,"body_markdown":"I think asker was looking for a solution that doesn&#39;t use a text editor but a specific tool designed to change group and artifact ids.","body":"I think asker was looking for a solution that doesn&#39;t use a text editor but a specific tool designed to change group and artifact ids."},{"owner":{"account_id":3381550,"reputation":1165,"user_id":2838491,"accept_rate":29,"display_name":"joao cenoura"},"score":0,"creation_date":1500038581,"post_id":44979656,"comment_id":77179271,"body_markdown":"Yes, (though it was long ago) the idea was to update several child projects (pom.xml) in a bulk way, hopefully using maven and avoid manual edits.","body":"Yes, (though it was long ago) the idea was to update several child projects (pom.xml) in a bulk way, hopefully using maven and avoid manual edits."},{"owner":{"account_id":2768064,"reputation":3161,"user_id":2383282,"accept_rate":60,"display_name":"Abhijeet Kamble"},"score":0,"creation_date":1516345506,"post_id":44979656,"comment_id":83656509,"body_markdown":"This is a manual method and we are looking for automated solution for this.","body":"This is a manual method and we are looking for automated solution for this."}],"tags":[],"owner":{"display_name":"user8272917"},"comment_count":3,"down_vote_count":4,"up_vote_count":0,"is_accepted":false,"score":-4,"last_activity_date":1499461731,"creation_date":1499461731,"answer_id":44979656,"question_id":19816278,"body_markdown":"Simple solution would be use textpad or notepad++ or other tool as you said sed and use find in file and replace the group id and artifact ids.","title":"Renaming groupId in maven","body":"<p>Simple solution would be use textpad or notepad++ or other tool as you said sed and use find in file and replace the group id and artifact ids.</p>\n"},{"tags":[],"owner":{"account_id":1686882,"reputation":1183,"user_id":1549977,"accept_rate":86,"display_name":"Benjamin Marwell"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1618125847,"creation_date":1566907390,"answer_id":57674272,"question_id":19816278,"body_markdown":"&gt; Is there a way to rename both groupId and artifactId?\n\nAs of today, the answer to your question is simple:\n\n* No, there is no such plugin for renaming.\r\n\n### Write your own Maven Plugin\r\nI guess you might be able to write such a maven plugin, though.\r\n\r\nYou can include this field in your Mojo:\r\n```java\r\n    @Parameter(defaultValue = &quot;${project}&quot;, readonly = true)\r\n    @SuppressWarnings(&quot;UnusedDeclaration&quot;)\r\n    private MavenProject project;\r\n```\r\n\r\nThe `MavenProject` class has the methods you are looking for (`setArtifactId`, etc.).\r\n\r\nIn fact, the [`SetMojo`][1] from the maven-version-plugin will do exactly this for you.\r\n\n------\r\nThis answer will be updated as soon as there is such a plugin.\n\n\n  [1]: https://github.com/mojohaus/versions-maven-plugin/blob/master/src/main/java/org/codehaus/mojo/versions/SetMojo.java","title":"Renaming groupId in maven","body":"<blockquote>\n<p>Is there a way to rename both groupId and artifactId?</p>\n</blockquote>\n<p>As of today, the answer to your question is simple:</p>\n<ul>\n<li>No, there is no such plugin for renaming.</li>\n</ul>\n<h3>Write your own Maven Plugin</h3>\n<p>I guess you might be able to write such a maven plugin, though.</p>\n<p>You can include this field in your Mojo:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @Parameter(defaultValue = &quot;${project}&quot;, readonly = true)\n    @SuppressWarnings(&quot;UnusedDeclaration&quot;)\n    private MavenProject project;\n</code></pre>\n<p>The <code>MavenProject</code> class has the methods you are looking for (<code>setArtifactId</code>, etc.).</p>\n<p>In fact, the <a href=\"https://github.com/mojohaus/versions-maven-plugin/blob/master/src/main/java/org/codehaus/mojo/versions/SetMojo.java\" rel=\"nofollow noreferrer\"><code>SetMojo</code></a> from the maven-version-plugin will do exactly this for you.</p>\n<hr />\n<p>This answer will be updated as soon as there is such a plugin.</p>\n"},{"tags":[],"owner":{"account_id":6131586,"reputation":1281,"user_id":4781571,"accept_rate":76,"display_name":"harsha kumar Reddy"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1618169339,"creation_date":1618169339,"answer_id":67049336,"question_id":19816278,"body_markdown":"This is the only way i know of. \r\n\r\nFirst  create the and move all java source according to the new groupId you are going to specify in the pom . rename the project folder to the new artifactId. update the .project file according to new artifactId.\r\n\r\nNow right click on the project in eclipse and do update maven project. If its updated without any errors you are good to go . ","title":"Renaming groupId in maven","body":"<p>This is the only way i know of.</p>\n<p>First  create the and move all java source according to the new groupId you are going to specify in the pom . rename the project folder to the new artifactId. update the .project file according to new artifactId.</p>\n<p>Now right click on the project in eclipse and do update maven project. If its updated without any errors you are good to go .</p>\n"}],"owner":{"account_id":3381550,"reputation":1165,"user_id":2838491,"accept_rate":29,"display_name":"joao cenoura"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":15612,"favorite_count":0,"down_vote_count":0,"up_vote_count":26,"answer_count":3,"score":26,"last_activity_date":1672921468,"creation_date":1383752305,"question_id":19816278,"body_markdown":"I&#39;m in a middle of a refactoring and house keeping process of a multi-module Maven3 project and I need to rename groupId and artifactId of some artifacts.\r\n \r\nIs there a way to rename both groupId and artifactId?  \r\nI know I can use some find-and-replace tool like sed, but I&#39;m wondering if there&#39;s a mojo like [versions-maven-plugin][1] (e.g.: `mvn versions:set -DnewVersion=1.0.3-SNAPSHOT`) but for groupId and artifactId.\r\n\r\n\r\n\r\n  [1]: http://mojo.codehaus.org/versions-maven-plugin/","title":"Renaming groupId in maven","body":"<p>I'm in a middle of a refactoring and house keeping process of a multi-module Maven3 project and I need to rename groupId and artifactId of some artifacts.</p>\n\n<p>Is there a way to rename both groupId and artifactId?<br>\nI know I can use some find-and-replace tool like sed, but I'm wondering if there's a mojo like <a href=\"http://mojo.codehaus.org/versions-maven-plugin/\" rel=\"noreferrer\">versions-maven-plugin</a> (e.g.: <code>mvn versions:set -DnewVersion=1.0.3-SNAPSHOT</code>) but for groupId and artifactId.</p>\n"},{"tags":["java","zip","fileoutputstream","zipoutputstream"],"comments":[{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":0,"creation_date":1672917136,"post_id":75017448,"comment_id":132382935,"body_markdown":"How exactly did you try to open the downloaded file?","body":"How exactly did you try to open the downloaded file?"},{"owner":{"account_id":14672099,"reputation":1179,"user_id":10596295,"display_name":"Martin"},"score":0,"creation_date":1672917196,"post_id":75017448,"comment_id":132382963,"body_markdown":"I am opening it via Archive Utility on mac. @BasilBourque","body":"I am opening it via Archive Utility on mac. @BasilBourque"},{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":1,"creation_date":1672919137,"post_id":75017448,"comment_id":132383571,"body_markdown":"Have you tried using the DEFLATE method? It could be that the Mac doesn&#39;t recognise NO_COMPRESSION. Also, are you sure you want to name the zip entry &quot;details_&lt;date&gt;.zip&quot;? There are multiple problems with that. First, are you sure you want a zip file inside a zip file? If not, you should remove the &quot;.zip&quot; from the filename. Second, if the date contains &quot;/&quot; characters (such as &quot;5/1/2023&quot;) then they will end up as subdirectories.","body":"Have you tried using the DEFLATE method? It could be that the Mac doesn&#39;t recognise NO_COMPRESSION. Also, are you sure you want to name the zip entry &quot;details_&lt;date&gt;.zip&quot;? There are multiple problems with that. First, are you sure you want a zip file inside a zip file? If not, you should remove the &quot;.zip&quot; from the filename. Second, if the date contains &quot;/&quot; characters (such as &quot;5/1/2023&quot;) then they will end up as subdirectories."},{"owner":{"account_id":14672099,"reputation":1179,"user_id":10596295,"display_name":"Martin"},"score":1,"creation_date":1672921078,"post_id":75017448,"comment_id":132384177,"body_markdown":"You are right @k314159, wrapping zip with zip was problematic. I posted an answer. Thanks a lot!","body":"You are right @k314159, wrapping zip with zip was problematic. I posted an answer. Thanks a lot!"}],"answers":[{"comments":[{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":0,"creation_date":1672922769,"post_id":75018261,"comment_id":132384773,"body_markdown":"By the way, I just noticed you&#39;re using `zipOutputStream.setLevel(Deflater.DEFLATED)` wrong. It should be `zipOutputStream.setMethod(Deflater.DEFLATED)`, since DEFLATED is a method, not a level. The level is just an integer between 0 and 9.","body":"By the way, I just noticed you&#39;re using <code>zipOutputStream.setLevel(Deflater.DEFLATED)</code> wrong. It should be <code>zipOutputStream.setMethod(Deflater.DEFLATED)</code>, since DEFLATED is a method, not a level. The level is just an integer between 0 and 9."}],"tags":[],"owner":{"account_id":14672099,"reputation":1179,"user_id":10596295,"display_name":"Martin"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672921043,"creation_date":1672921043,"answer_id":75018261,"question_id":75017448,"body_markdown":"I managed to find out the root cause with @k314159\r\n, namely, I had a zip file wrapped with a zip file. New version which works as expected. \r\n\r\n```\r\n    public static byte[] createZipByteArray(String fileName, byte[] content) throws IOException {\r\n        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();\r\n        try (byteArrayOutputStream; ZipOutputStream zipOutputStream = new ZipOutputStream(byteArrayOutputStream)) {\r\n            zipOutputStream.setLevel(Deflater.DEFLATED);\r\n            ZipEntry zipEntry = new ZipEntry(fileName);\r\n            zipOutputStream.putNextEntry(zipEntry);\r\n            zipOutputStream.write(content);\r\n            zipOutputStream.closeEntry();\r\n            zipOutputStream.flush();\r\n        }\r\n        return byteArrayOutputStream.toByteArray();\r\n    }\r\n```\r\n\r\nand controller \r\n\r\n```\r\n    @GetMapping(value = &quot;objectWithDetails&quot;, produces = &quot;application/zip&quot;)\r\n    @RolesAllowed(&quot;QUERY_DATA&quot;)\r\n    public ResponseEntity&lt;byte[]&gt; getObjectWithDetails(String limit, HttpServletResponse response) throws IOException {\r\n        response.setContentType(&quot;application/zip&quot;);\r\n        List&lt;ObjectSpecification &gt; objectRepresentation = objectService.getObjectRepresentation(limit);\r\n\r\n        byte[] objectsBytes = objectMapper.writeValueAsBytes(objectRepresentation);\r\n\r\n        return ResponseEntity\r\n                .ok()\r\n                .contentType(MediaType.valueOf(&quot;application/zip&quot;))\r\n                .header(&quot;Content-Encoding&quot;, &quot;UTF-8&quot;)\r\n                .header(&quot;Content-Disposition&quot;, getObjectFileName(&quot;attachment; filename=objects_&quot;))\r\n                .body(createZipByteArray(getObjectFileName(&quot;objects_&quot;), objectsBytes));\r\n    }\r\n```\r\n","title":"Generated zip file is always corrupted after download on Mac","body":"<p>I managed to find out the root cause with @k314159\n, namely, I had a zip file wrapped with a zip file. New version which works as expected.</p>\n<pre><code>    public static byte[] createZipByteArray(String fileName, byte[] content) throws IOException {\n        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();\n        try (byteArrayOutputStream; ZipOutputStream zipOutputStream = new ZipOutputStream(byteArrayOutputStream)) {\n            zipOutputStream.setLevel(Deflater.DEFLATED);\n            ZipEntry zipEntry = new ZipEntry(fileName);\n            zipOutputStream.putNextEntry(zipEntry);\n            zipOutputStream.write(content);\n            zipOutputStream.closeEntry();\n            zipOutputStream.flush();\n        }\n        return byteArrayOutputStream.toByteArray();\n    }\n</code></pre>\n<p>and controller</p>\n<pre><code>    @GetMapping(value = &quot;objectWithDetails&quot;, produces = &quot;application/zip&quot;)\n    @RolesAllowed(&quot;QUERY_DATA&quot;)\n    public ResponseEntity&lt;byte[]&gt; getObjectWithDetails(String limit, HttpServletResponse response) throws IOException {\n        response.setContentType(&quot;application/zip&quot;);\n        List&lt;ObjectSpecification &gt; objectRepresentation = objectService.getObjectRepresentation(limit);\n\n        byte[] objectsBytes = objectMapper.writeValueAsBytes(objectRepresentation);\n\n        return ResponseEntity\n                .ok()\n                .contentType(MediaType.valueOf(&quot;application/zip&quot;))\n                .header(&quot;Content-Encoding&quot;, &quot;UTF-8&quot;)\n                .header(&quot;Content-Disposition&quot;, getObjectFileName(&quot;attachment; filename=objects_&quot;))\n                .body(createZipByteArray(getObjectFileName(&quot;objects_&quot;), objectsBytes));\n    }\n</code></pre>\n"}],"owner":{"account_id":14672099,"reputation":1179,"user_id":10596295,"display_name":"Martin"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":334,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75018261,"answer_count":1,"score":0,"last_activity_date":1672921043,"creation_date":1672916599,"question_id":75017448,"body_markdown":"Lets say that I have a collection of objects which I would like to wrap with zip. My zip conversion class looks like:\r\n\r\n```\r\npublic class ZipFile {\r\n\r\n    public byte[] createZipByteArray(String fileName, byte[] content) throws IOException {\r\n        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();\r\n        try (byteArrayOutputStream; ZipOutputStream zipOutputStream = new ZipOutputStream(byteArrayOutputStream)) {\r\n            zipOutputStream.setLevel(Deflater.NO_COMPRESSION);\r\n            ZipEntry zipEntry = new ZipEntry(fileName);\r\n            zipOutputStream.putNextEntry(zipEntry);\r\n            zipOutputStream.write(content);\r\n            zipOutputStream.closeEntry();\r\n            zipOutputStream.flush();\r\n        }\r\n        return byteArrayOutputStream.toByteArray();\r\n    }\r\n\r\n}\r\n```\r\n\r\nMy controller looks like:\r\n\r\n```\r\n    @GetMapping(value = &quot;objectWithDetails/zip&quot;, produces = &quot;application/zip&quot;)\r\n    @RolesAllowed(&quot;QUERY_DATA&quot;)\r\n    public ResponseEntity&lt;byte[]&gt; getObjectWithDetails(String limit, HttpServletResponse response) throws IOException {\r\n        response.setContentType(&quot;application/zip&quot;);\r\n\r\n        List&lt;ObjectSpecification&gt; objectRepresentation = recipeService.getObjectRepresentation(limit);\r\n\r\n        byte[] objectsBytes = objectMapper.writeValueAsBytes(objectRepresentation);\r\n\r\n        ZipFile zipFile = new ZipFile();\r\n\r\n        return ResponseEntity\r\n                .ok()\r\n                .contentType(MediaType.valueOf(&quot;application/zip&quot;))\r\n                .header(&quot;Content-Encoding&quot;, &quot;UTF-8&quot;)\r\n                .header(&quot;Content-Disposition&quot;, String.format(&quot;attachment; filename=\\&quot;details_%s.zip\\&quot;&quot;, dateTimeProvider.nowDate()))\r\n                .body(zipFile.createZipByteArray(String.format(&quot;details_%s.zip&quot;, dateTimeProvider.nowDate()), objectsBytes));\r\n\r\n    }\r\n```\r\n\r\nIn swagger, I have a download option for the generated zip files. After all, when I try to open the downloaded file I receive the following:\r\n\r\n```Unable to expand filename.zip. It is in an unsupported format. ```\r\n\r\nI tried closing `ZipOutputStream` and `ByteArrayOutputStream` in a different configuration. Applied a different option for the content type in the controller but still, I cannot find out why all zip files are corrupted. I will be grateful for suggestions on what I miss. Cheers!  ","title":"Generated zip file is always corrupted after download on Mac","body":"<p>Lets say that I have a collection of objects which I would like to wrap with zip. My zip conversion class looks like:</p>\n<pre><code>public class ZipFile {\n\n    public byte[] createZipByteArray(String fileName, byte[] content) throws IOException {\n        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();\n        try (byteArrayOutputStream; ZipOutputStream zipOutputStream = new ZipOutputStream(byteArrayOutputStream)) {\n            zipOutputStream.setLevel(Deflater.NO_COMPRESSION);\n            ZipEntry zipEntry = new ZipEntry(fileName);\n            zipOutputStream.putNextEntry(zipEntry);\n            zipOutputStream.write(content);\n            zipOutputStream.closeEntry();\n            zipOutputStream.flush();\n        }\n        return byteArrayOutputStream.toByteArray();\n    }\n\n}\n</code></pre>\n<p>My controller looks like:</p>\n<pre><code>    @GetMapping(value = &quot;objectWithDetails/zip&quot;, produces = &quot;application/zip&quot;)\n    @RolesAllowed(&quot;QUERY_DATA&quot;)\n    public ResponseEntity&lt;byte[]&gt; getObjectWithDetails(String limit, HttpServletResponse response) throws IOException {\n        response.setContentType(&quot;application/zip&quot;);\n\n        List&lt;ObjectSpecification&gt; objectRepresentation = recipeService.getObjectRepresentation(limit);\n\n        byte[] objectsBytes = objectMapper.writeValueAsBytes(objectRepresentation);\n\n        ZipFile zipFile = new ZipFile();\n\n        return ResponseEntity\n                .ok()\n                .contentType(MediaType.valueOf(&quot;application/zip&quot;))\n                .header(&quot;Content-Encoding&quot;, &quot;UTF-8&quot;)\n                .header(&quot;Content-Disposition&quot;, String.format(&quot;attachment; filename=\\&quot;details_%s.zip\\&quot;&quot;, dateTimeProvider.nowDate()))\n                .body(zipFile.createZipByteArray(String.format(&quot;details_%s.zip&quot;, dateTimeProvider.nowDate()), objectsBytes));\n\n    }\n</code></pre>\n<p>In swagger, I have a download option for the generated zip files. After all, when I try to open the downloaded file I receive the following:</p>\n<p><code>Unable to expand filename.zip. It is in an unsupported format. </code></p>\n<p>I tried closing <code>ZipOutputStream</code> and <code>ByteArrayOutputStream</code> in a different configuration. Applied a different option for the content type in the controller but still, I cannot find out why all zip files are corrupted. I will be grateful for suggestions on what I miss. Cheers!</p>\n"},{"tags":["java","spring-boot","jpa","jparepository"],"answers":[{"comments":[{"owner":{"account_id":16736345,"reputation":13,"user_id":12097339,"display_name":"user678"},"score":0,"creation_date":1672946240,"post_id":75018255,"comment_id":132393381,"body_markdown":"do you think you could explain a bit why you think the second option is better than using Object[]? - it would help me understand your point of view a bit better, thanks","body":"do you think you could explain a bit why you think the second option is better than using Object[]? - it would help me understand your point of view a bit better, thanks"},{"owner":{"account_id":16736345,"reputation":13,"user_id":12097339,"display_name":"user678"},"score":0,"creation_date":1672946943,"post_id":75018255,"comment_id":132393551,"body_markdown":"is it because if I use Object[] I have to write code that has to be written to convert returned data and if I use a predefined class the code is cleaner as a result?","body":"is it because if I use Object[] I have to write code that has to be written to convert returned data and if I use a predefined class the code is cleaner as a result?"},{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1672953489,"post_id":75018255,"comment_id":132395509,"body_markdown":"It is better maintainable if you can access the values per getter and setter as with index. Think about changing the order or adding new attributes","body":"It is better maintainable if you can access the values per getter and setter as with index. Think about changing the order or adding new attributes"}],"tags":[],"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672921011,"creation_date":1672921011,"answer_id":75018255,"question_id":75018217,"body_markdown":"You select two columns which is not a string. Your message returns an `Object[]`:\r\n\r\n    interface MyClassRepository extends JpaRepository&lt;MyClass, Long&gt; {\r\n        @Query(value = &quot;select m.name, max(date) from MyClass m group by m.name&quot;)\r\n        List&lt;Object[]&gt; selectLatest();\r\n    }\r\n\r\nWhere the index zero contains the name and the index 1 contains the Date.\r\n\r\nBut for me a better solution is to create an Object with two attributes and select this:\r\n\r\n    public class MyLatestClass {\r\n       private String name;\r\n       private LocalDate date;\r\n       \r\n       public MyLatestClass(String name, LocalDate date){\r\n         this.name=name;\r\n         this.date=date;\r\n       }\r\n       //getter \r\n       ....\r\n    }\r\n    \r\n    interface MyClassRepository extends JpaRepository&lt;MyClass, Long&gt; {\r\n        @Query(value = &quot;select new MyLatestClass(name, max(date)) from MyClass m group by m.name&quot;)\r\n        List&lt;MyLatestClass&gt; selectLatest();\r\n    }","title":"No converter found capable of converting from type [java.time.LocalDate] to type [@org.springframework.data.jpa.repository.Query java.lang.String]","body":"<p>You select two columns which is not a string. Your message returns an <code>Object[]</code>:</p>\n<pre><code>interface MyClassRepository extends JpaRepository&lt;MyClass, Long&gt; {\n    @Query(value = &quot;select m.name, max(date) from MyClass m group by m.name&quot;)\n    List&lt;Object[]&gt; selectLatest();\n}\n</code></pre>\n<p>Where the index zero contains the name and the index 1 contains the Date.</p>\n<p>But for me a better solution is to create an Object with two attributes and select this:</p>\n<pre><code>public class MyLatestClass {\n   private String name;\n   private LocalDate date;\n   \n   public MyLatestClass(String name, LocalDate date){\n     this.name=name;\n     this.date=date;\n   }\n   //getter \n   ....\n}\n\ninterface MyClassRepository extends JpaRepository&lt;MyClass, Long&gt; {\n    @Query(value = &quot;select new MyLatestClass(name, max(date)) from MyClass m group by m.name&quot;)\n    List&lt;MyLatestClass&gt; selectLatest();\n}\n</code></pre>\n"}],"owner":{"account_id":16736345,"reputation":13,"user_id":12097339,"display_name":"user678"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":480,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75018255,"answer_count":1,"score":0,"last_activity_date":1672921011,"creation_date":1672920839,"question_id":75018217,"body_markdown":"I have a springboot project with mysql and jpa and in there I have a model/domain class\r\n\r\n```\r\nclass MyClass {\r\n    private long id;\r\n    private String name;\r\n    private LocalDate date;\r\n    private String data1;\r\n    private Integer data2;\r\n}\r\n```\r\nand I also have repository interface that extends JpaRepository where I want to add a custom query to pick rows with latest date by name - the code is as follows:\r\n\r\n```\r\ninterface MyClassRepository extends JpaRepository&lt;MyClass, Long&gt; {\r\n    @Query(value = &quot;select m.name, max(date) from MyClass m group by m.name&quot;)\r\n    List&lt;String&gt; selectLatest();\r\n}\r\n```\r\nWhen the call of that query is executed I get the error message as in the title\r\n\r\n```\r\nNo converter found capable of converting from type [java.time.LocalDate] to type [@org.springframework.data.jpa.repository.Query java.lang.String]\r\n```\r\n\r\n\r\n\r\n\r\n\r\nI have found similar questions but each was more specific to a class and more complex than mine, I think it&#39;s the java.util.LocalDate that&#39;s the problem here?","title":"No converter found capable of converting from type [java.time.LocalDate] to type [@org.springframework.data.jpa.repository.Query java.lang.String]","body":"<p>I have a springboot project with mysql and jpa and in there I have a model/domain class</p>\n<pre><code>class MyClass {\n    private long id;\n    private String name;\n    private LocalDate date;\n    private String data1;\n    private Integer data2;\n}\n</code></pre>\n<p>and I also have repository interface that extends JpaRepository where I want to add a custom query to pick rows with latest date by name - the code is as follows:</p>\n<pre><code>interface MyClassRepository extends JpaRepository&lt;MyClass, Long&gt; {\n    @Query(value = &quot;select m.name, max(date) from MyClass m group by m.name&quot;)\n    List&lt;String&gt; selectLatest();\n}\n</code></pre>\n<p>When the call of that query is executed I get the error message as in the title</p>\n<pre><code>No converter found capable of converting from type [java.time.LocalDate] to type [@org.springframework.data.jpa.repository.Query java.lang.String]\n</code></pre>\n<p>I have found similar questions but each was more specific to a class and more complex than mine, I think it's the java.util.LocalDate that's the problem here?</p>\n"},{"tags":["java","xml","list","xpath","nodelist"],"comments":[{"owner":{"account_id":91947,"reputation":161829,"user_id":252228,"accept_rate":80,"display_name":"Martin Honnen"},"score":0,"creation_date":1672921421,"post_id":75017933,"comment_id":132384295,"body_markdown":"You could consider to simply select e.g. `//IR/Level` with XPath, that way, for your sample, the node list would contain two element nodes and the value you want (e.g. either the empty string or the value `LVL00006` could be read out on the DOM API level with `nodes.item(i).getTextContent()` or with a relative XPath expression selecting `string()` on `nodes.item(i)`.","body":"You could consider to simply select e.g. <code>&#47;&#47;IR&#47;Level</code> with XPath, that way, for your sample, the node list would contain two element nodes and the value you want (e.g. either the empty string or the value <code>LVL00006</code> could be read out on the DOM API level with <code>nodes.item(i).getTextContent()</code> or with a relative XPath expression selecting <code>string()</code> on <code>nodes.item(i)</code>."},{"owner":{"account_id":91947,"reputation":161829,"user_id":252228,"accept_rate":80,"display_name":"Martin Honnen"},"score":0,"creation_date":1672921505,"post_id":75017933,"comment_id":132384326,"body_markdown":"Another option would be to move to XPath 2 or 3 where you can select e.g. `//IR/Level/string()` directly as a sequence of string. That is not possible with the JAXP, XPath 1 API but certainly e.g. with Saxon&#39;s s9api.","body":"Another option would be to move to XPath 2 or 3 where you can select e.g. <code>&#47;&#47;IR&#47;Level&#47;string()</code> directly as a sequence of string. That is not possible with the JAXP, XPath 1 API but certainly e.g. with Saxon&#39;s s9api."}],"owner":{"account_id":20230671,"reputation":3,"user_id":14837299,"display_name":"Ajitesh Shukla"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":50,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672920986,"creation_date":1672919296,"question_id":75017933,"body_markdown":"I have a use case where my XML is like this \r\n```xml\r\n&lt;IR&gt;\r\n        &lt;name&gt;abc&lt;/name&gt;\r\n        &lt;Level&gt;&lt;/Level&gt;\r\n      \r\n&lt;/IR&gt;\r\n&lt;IR&gt;\r\n        &lt;name&gt;xyz&lt;/name&gt; \r\n        &lt;Level&gt;LVL00006&lt;/Level&gt;     \r\n&lt;/IR&gt;\r\n```\r\n\r\nI am using below code to extract information of level.\r\n\r\n```java\r\npublic class TestUseCases {\r\n public static void main(String[] args) {\r\n\tDocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\r\n\ttry {\r\n\t\tfactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);\r\n\t} catch (ParserConfigurationException e1) {\r\n\t\t// TODO Auto-generated catch block\r\n\t\te1.printStackTrace();\r\n\t}\r\n\tDocument document;\r\n\ttry {\r\n\t\tdocument = factory.newDocumentBuilder()\r\n\t\t\t\t.parse(new InputSource(new StringReader(xml)));\r\n\t\r\n\tString xpathExpression = &quot;&quot;;\r\n\tMap&lt;String, List&lt;String&gt;&gt; iRValues = new LinkedHashMap&lt;String, List&lt;String&gt;&gt;();\r\n\txpathExpression = &quot;(/IR/Level/text())&quot;;\r\n\t\r\n\t\tiRValues.put(&quot;REQLVL&quot;, evaluateXPath(document, xpathExpression));\r\n\t\t\r\n\t\tSystem.out.println(iRValues);\r\n\t} catch (SupportException e) {\r\n\t\t// TODO Auto-generated catch block\r\n\t\te.printStackTrace();\r\n\t} catch (SAXException | IOException | ParserConfigurationException e) {\r\n\t\t// TODO Auto-generated catch block\r\n\t\te.printStackTrace();\r\n\t}\r\n  }\r\n\r\n  private static List&lt;String&gt; evaluateXPath(Document document, String xpathExpression) throws SupportException {\r\n\t// Create XPathFactory object\r\n\tXPathFactory xpathFactory = XPathFactory.newInstance();\r\n\r\n\t// Create XPath object\r\n\tXPath xpath = xpathFactory.newXPath();\r\n\r\n\tList&lt;String&gt; values = new ArrayList&lt;&gt;();\r\n\ttry {\r\n\t\t// Create XPathExpression object\r\n\t\tXPathExpression expr = xpath.compile(xpathExpression);\r\n\t\t// Evaluate expression result on XML document\r\n\t\tNodeList nodes = (NodeList) expr.evaluate(document, XPathConstants.NODESET);\r\n\t\tSystem.out.println(nodes.getLength());\r\n\t\tfor (int i = 0; i &lt; nodes.getLength(); i++) {\r\n\t\t\tString item = nodes.item(i).getNodeValue();\r\n\t\t\tSystem.out.println(item);\r\n\t\t\tif (item.trim().isEmpty()) {\r\n\t\t\t\tvalues.add(SupportConstants.EMPTY_SPACE);\r\n\t\t\t} else {\r\n\t\t\t\tvalues.add(nodes.item(i).getNodeValue());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} catch (XPathExpressionException e) {\r\n\t\tthrow new SupportException(SupportExceptionMessage.ERROR_IN_READING_RESPONSE_FROM_CM);\r\n\t}\r\n\treturn values;\r\n  }\r\n}\r\n```\r\n\r\nOUTPUT:\r\n```none\r\n1\r\nLVL00006\r\n{REQLVL=[LVL00006]}\r\n```\r\n\r\nThe problem is because first level tag is empty, I get a list which has only one element and I am not able to know whether the element is of abc or xyz. Is there a way so that I can put space if the tag is empty?\r\n\r\n\r\n\r\n\r\n\r\nI am expecting list as [&quot; &quot;, LVL00006].","title":"How to get element as space in list of tags using xpath, if the element is not present","body":"<p>I have a use case where my XML is like this</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;IR&gt;\n        &lt;name&gt;abc&lt;/name&gt;\n        &lt;Level&gt;&lt;/Level&gt;\n      \n&lt;/IR&gt;\n&lt;IR&gt;\n        &lt;name&gt;xyz&lt;/name&gt; \n        &lt;Level&gt;LVL00006&lt;/Level&gt;     \n&lt;/IR&gt;\n</code></pre>\n<p>I am using below code to extract information of level.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class TestUseCases {\n public static void main(String[] args) {\n    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n    try {\n        factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);\n    } catch (ParserConfigurationException e1) {\n        // TODO Auto-generated catch block\n        e1.printStackTrace();\n    }\n    Document document;\n    try {\n        document = factory.newDocumentBuilder()\n                .parse(new InputSource(new StringReader(xml)));\n    \n    String xpathExpression = &quot;&quot;;\n    Map&lt;String, List&lt;String&gt;&gt; iRValues = new LinkedHashMap&lt;String, List&lt;String&gt;&gt;();\n    xpathExpression = &quot;(/IR/Level/text())&quot;;\n    \n        iRValues.put(&quot;REQLVL&quot;, evaluateXPath(document, xpathExpression));\n        \n        System.out.println(iRValues);\n    } catch (SupportException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    } catch (SAXException | IOException | ParserConfigurationException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    }\n  }\n\n  private static List&lt;String&gt; evaluateXPath(Document document, String xpathExpression) throws SupportException {\n    // Create XPathFactory object\n    XPathFactory xpathFactory = XPathFactory.newInstance();\n\n    // Create XPath object\n    XPath xpath = xpathFactory.newXPath();\n\n    List&lt;String&gt; values = new ArrayList&lt;&gt;();\n    try {\n        // Create XPathExpression object\n        XPathExpression expr = xpath.compile(xpathExpression);\n        // Evaluate expression result on XML document\n        NodeList nodes = (NodeList) expr.evaluate(document, XPathConstants.NODESET);\n        System.out.println(nodes.getLength());\n        for (int i = 0; i &lt; nodes.getLength(); i++) {\n            String item = nodes.item(i).getNodeValue();\n            System.out.println(item);\n            if (item.trim().isEmpty()) {\n                values.add(SupportConstants.EMPTY_SPACE);\n            } else {\n                values.add(nodes.item(i).getNodeValue());\n            }\n        }\n\n    } catch (XPathExpressionException e) {\n        throw new SupportException(SupportExceptionMessage.ERROR_IN_READING_RESPONSE_FROM_CM);\n    }\n    return values;\n  }\n}\n</code></pre>\n<p>OUTPUT:</p>\n<pre class=\"lang-none prettyprint-override\"><code>1\nLVL00006\n{REQLVL=[LVL00006]}\n</code></pre>\n<p>The problem is because first level tag is empty, I get a list which has only one element and I am not able to know whether the element is of abc or xyz. Is there a way so that I can put space if the tag is empty?</p>\n<p>I am expecting list as [&quot; &quot;, LVL00006].</p>\n"},{"tags":["java","maven-3"],"comments":[{"owner":{"account_id":4181375,"reputation":5121,"user_id":3426309,"display_name":"Andrey B. Panfilov"},"score":0,"creation_date":1672921352,"post_id":75018223,"comment_id":132384264,"body_markdown":"ask an author of dependency to publish valid pom","body":"ask an author of dependency to publish valid pom"},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":1,"creation_date":1672921496,"post_id":75018223,"comment_id":132384322,"body_markdown":"The relative parent-pom path in a pom of a dependency should be irrelevant, since they are only needed to build the dependency; when built, the parent pom should be resolve through the dependency system (e.g. through mvnrepository). Please [edit] the post and add the (relevant part of the) `pom.xml`.","body":"The relative parent-pom path in a pom of a dependency should be irrelevant, since they are only needed to build the dependency; when built, the parent pom should be resolve through the dependency system (e.g. through mvnrepository). Please <a href=\"https://stackoverflow.com/posts/75018223/edit\">edit</a> the post and add the (relevant part of the) <code>pom.xml</code>."},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1672940793,"post_id":75018223,"comment_id":132391693,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."}],"owner":{"account_id":11458982,"reputation":1,"user_id":8399169,"display_name":"Azhar Ahmed A"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":36,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672920874,"creation_date":1672920874,"question_id":75018223,"body_markdown":"I have a service where I have added dependency which contains relative path to a parent pom. When I try to build this locally, the local build fails complaining that its unable to find the parent pom.\r\n\r\nSuggestion to overcome this issue so that I can build the project locally ","title":"Dependency in pom refers to a parent pom which when running locally fails","body":"<p>I have a service where I have added dependency which contains relative path to a parent pom. When I try to build this locally, the local build fails complaining that its unable to find the parent pom.</p>\n<p>Suggestion to overcome this issue so that I can build the project locally</p>\n"},{"tags":["java","selenium","xpath"],"answers":[{"comments":[{"owner":{"account_id":18283691,"reputation":1,"user_id":13322070,"display_name":"Ganesan M"},"score":0,"creation_date":1672893146,"post_id":75007245,"comment_id":132377035,"body_markdown":"Here we don&#39;t know about the ul size, so we can&#39;t specify the index statically.\nWe have to get the ul which is under h3[1] dynamically.","body":"Here we don&#39;t know about the ul size, so we can&#39;t specify the index statically. We have to get the ul which is under h3[1] dynamically."}],"tags":[],"owner":{"account_id":27429108,"reputation":1,"user_id":20926091,"display_name":"Adinath Rajegore"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672844174,"creation_date":1672844174,"answer_id":75007245,"question_id":75004456,"body_markdown":"Here You are providing indexing to the h3 tag, after which both the lists are getting located because both are coming in following-sibling Axes. \r\n\r\nYou can provide indexing to ul direclty as:\r\nList&lt;WebElement&gt; logs = driver.findElements(By.xpath(&quot;//*[@id=\\&quot;on-premisesbackwardsincompatible\\&quot;]/following-sibling::h3/following-sibling::ul[1]&quot;));\r\n\r\nor you can locate the element with xpath:\r\nList&lt;WebElement&gt; logs = driver.findElements(By.xpath(&quot;//*[@id=&#39;v2-43-october-11--2022&#39;]/following-sibling::ul[1]));","title":"How to get a list within two different elements in selenium java","body":"<p>Here You are providing indexing to the h3 tag, after which both the lists are getting located because both are coming in following-sibling Axes.</p>\n<p>You can provide indexing to ul direclty as:\nList logs = driver.findElements(By.xpath(&quot;//*[@id=&quot;on-premisesbackwardsincompatible&quot;]/following-sibling::h3/following-sibling::ul[1]&quot;));</p>\n<p>or you can locate the element with xpath:\nList logs = driver.findElements(By.xpath(&quot;//*[@id='v2-43-october-11--2022']/following-sibling::ul[1]));</p>\n"},{"tags":[],"owner":{"account_id":10404380,"reputation":2588,"user_id":7671727,"display_name":"AbiSaran"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672920667,"creation_date":1672920667,"answer_id":75018180,"question_id":75004456,"body_markdown":"You can try the below XPath:\r\n\r\n    //*[@id=&#39;v2-45-january-10--2023&#39;]/preceding-sibling::ul\r\n\r\nIt gives the results of the first 2 `&lt;ul&gt;` tags which are next to the first `&lt;h3&gt;` tag.","title":"How to get a list within two different elements in selenium java","body":"<p>You can try the below XPath:</p>\n<pre><code>//*[@id='v2-45-january-10--2023']/preceding-sibling::ul\n</code></pre>\n<p>It gives the results of the first 2 <code>&lt;ul&gt;</code> tags which are next to the first <code>&lt;h3&gt;</code> tag.</p>\n"}],"owner":{"account_id":18283691,"reputation":1,"user_id":13322070,"display_name":"Ganesan M"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":44,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1672920667,"creation_date":1672830145,"question_id":75004456,"body_markdown":"Here,\r\nhaving two h3 tags under a div tag.Need a lists which is under 1st h3 tag(which is not under 2nd h3 tag)\r\n\r\nAs shown in the below image,&lt;br&gt;\r\nh3(1) -&gt; v2-43-october-11--2022&lt;br&gt;\r\nh3(2) -&gt; v2-45-january-10--2023\r\nUnder h3(1) i have two list(ul), under h3(2) i have one list(ul)\r\nNeed an elements which is under h3(1) only&lt;br&gt;(https://i.stack.imgur.com/So4A4.png)\r\n\r\nHere is my code\r\n\r\n```\r\nList&lt;WebElement&gt; logs = driver.findElements(By.xpath(&quot;//*[@id=\\&quot;on-premisesbackwardsincompatible\\&quot;]/following-sibling::h3[1]/following-sibling::ul&quot;));\r\nfor(WebElement w : logs)\r\n       System.out.println(w.getText());\r\n```\r\n\r\n\r\nbut it&#39;s giving all the 3 lists, need 1st two lists only&lt;br&gt;\r\nNeed an elements which is under h3(1) only&lt;br&gt;\r\n(https://i.stack.imgur.com/XCs1W.png)\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/Njxvs.png","title":"How to get a list within two different elements in selenium java","body":"<p>Here,\nhaving two h3 tags under a div tag.Need a lists which is under 1st h3 tag(which is not under 2nd h3 tag)</p>\n<p>As shown in the below image,<br>\nh3(1) -&gt; v2-43-october-11--2022<br>\nh3(2) -&gt; v2-45-january-10--2023\nUnder h3(1) i have two list(ul), under h3(2) i have one list(ul)\nNeed an elements which is under h3(1) only<br>(<a href=\"https://i.stack.imgur.com/So4A4.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/So4A4.png</a>)</p>\n<p>Here is my code</p>\n<pre><code>List&lt;WebElement&gt; logs = driver.findElements(By.xpath(&quot;//*[@id=\\&quot;on-premisesbackwardsincompatible\\&quot;]/following-sibling::h3[1]/following-sibling::ul&quot;));\nfor(WebElement w : logs)\n       System.out.println(w.getText());\n</code></pre>\n<p>but it's giving all the 3 lists, need 1st two lists only<br>\nNeed an elements which is under h3(1) only<br>\n(<a href=\"https://i.stack.imgur.com/XCs1W.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/XCs1W.png</a>)</p>\n"},{"tags":["java","postgresql","spring-boot","liquibase"],"comments":[{"owner":{"account_id":4181375,"reputation":5121,"user_id":3426309,"display_name":"Andrey B. Panfilov"},"score":1,"creation_date":1672920259,"post_id":75017965,"comment_id":132383943,"body_markdown":"[liquibase-schema-name](https://docs.liquibase.com/parameters/liquibase-schema-name.html). In short: since default schema is managed by jdbc driver, liquibase does not see previous `DATABASECHANGELOG` table and tries to reapply old migrations. You need to specify correct schema where the actual `DATABASECHANGELOG` table is located via `spring.liquibase.liquibase-schema`. BTW, being in your shoes I would stay clear off schemas.","body":"<a href=\"https://docs.liquibase.com/parameters/liquibase-schema-name.html\" rel=\"nofollow noreferrer\">liquibase-schema-name</a>. In short: since default schema is managed by jdbc driver, liquibase does not see previous <code>DATABASECHANGELOG</code> table and tries to reapply old migrations. You need to specify correct schema where the actual <code>DATABASECHANGELOG</code> table is located via <code>spring.liquibase.liquibase-schema</code>. BTW, being in your shoes I would stay clear off schemas."},{"owner":{"account_id":22889080,"reputation":37,"user_id":17029505,"display_name":"idelkaro"},"score":0,"creation_date":1673805139,"post_id":75017965,"comment_id":132574630,"body_markdown":"Thanks, it worked out! but also in my case i had to add ```spring.liquibase.url```","body":"Thanks, it worked out! but also in my case i had to add <code>spring.liquibase.url</code>"}],"owner":{"account_id":22889080,"reputation":37,"user_id":17029505,"display_name":"idelkaro"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":148,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672919850,"creation_date":1672919511,"question_id":75017965,"body_markdown":"I have ```db-service``` with all the changelog files. When running ```db-service``` for the first time all the tables will be created in the ```public schema```. Then tables will be filled with initial data. \r\n\r\n[![enter image description here][1]][1] db-service \r\n\r\n[![enter image description here][2]][2] db-service\r\n\r\nNow we have decided to split ```db-service``` and distribute changelog files between services. So in the microservice I have created the same structure of folders.\r\n\r\nI moved changelog files to ```info-service```. And now I need to move tables into a separate schema, but I can&#39;t do it until tables aren&#39;t filled with init data. So I&#39;ve created new folder and added additional path in root.changelog.\r\n\r\n[![enter image description here][3]][3] info-service\r\n\r\n[![enter image description here][4]][4] info-service\r\n\r\nMy changesets look like: \r\n\r\n [![enter image description here][5]][5] 230105-initial-changelog.xml\r\n\r\nI run this changeset with URL ```spring.datasource.url=jdbc:postgresql://localhost:5432/postgres``` and everything works fine, tables are moved to another schema.\r\n\r\nBut then I modify data source URL to start working in my info-microservice with specific schema: \r\n```spring.datasource.url=jdbc:postgresql://localhost:5432/postgres?currentSchema=info_schema```\r\n\r\nAnd when I run my service for the second time with currentSchema URL parameter I get ```ERROR: relation &quot;atm&quot; already exists``` and ```ERROR: relation &quot;contacts&quot; already exists```. So liquibase wants to start doing all the changes from the beginning in the info-schema. It tries to create, init and alter tables again.\r\n\r\nHow to let Liquibase know that it shouldn&#39;t create tables in my schema? Note that i can&#39;t change old changelogfiles from the ```structure folder```\r\n\r\n \r\n\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/ZskzA.png\r\n  [2]: https://i.stack.imgur.com/T1JWK.png\r\n  [3]: https://i.stack.imgur.com/2QF9w.png\r\n  [4]: https://i.stack.imgur.com/eQiuQ.png\r\n  [5]: https://i.stack.imgur.com/nPk1g.png","title":"How to move tables to another postgres schema using liquibase without running queries inside schema again?","body":"<p>I have <code>db-service</code> with all the changelog files. When running <code>db-service</code> for the first time all the tables will be created in the <code>public schema</code>. Then tables will be filled with initial data.</p>\n<p><a href=\"https://i.stack.imgur.com/ZskzA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZskzA.png\" alt=\"enter image description here\" /></a> db-service</p>\n<p><a href=\"https://i.stack.imgur.com/T1JWK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T1JWK.png\" alt=\"enter image description here\" /></a> db-service</p>\n<p>Now we have decided to split <code>db-service</code> and distribute changelog files between services. So in the microservice I have created the same structure of folders.</p>\n<p>I moved changelog files to <code>info-service</code>. And now I need to move tables into a separate schema, but I can't do it until tables aren't filled with init data. So I've created new folder and added additional path in root.changelog.</p>\n<p><a href=\"https://i.stack.imgur.com/2QF9w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2QF9w.png\" alt=\"enter image description here\" /></a> info-service</p>\n<p><a href=\"https://i.stack.imgur.com/eQiuQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eQiuQ.png\" alt=\"enter image description here\" /></a> info-service</p>\n<p>My changesets look like:</p>\n<p><a href=\"https://i.stack.imgur.com/nPk1g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nPk1g.png\" alt=\"enter image description here\" /></a> 230105-initial-changelog.xml</p>\n<p>I run this changeset with URL <code>spring.datasource.url=jdbc:postgresql://localhost:5432/postgres</code> and everything works fine, tables are moved to another schema.</p>\n<p>But then I modify data source URL to start working in my info-microservice with specific schema:\n<code>spring.datasource.url=jdbc:postgresql://localhost:5432/postgres?currentSchema=info_schema</code></p>\n<p>And when I run my service for the second time with currentSchema URL parameter I get <code>ERROR: relation &quot;atm&quot; already exists</code> and <code>ERROR: relation &quot;contacts&quot; already exists</code>. So liquibase wants to start doing all the changes from the beginning in the info-schema. It tries to create, init and alter tables again.</p>\n<p>How to let Liquibase know that it shouldn't create tables in my schema? Note that i can't change old changelogfiles from the <code>structure folder</code></p>\n"},{"tags":["java","spring","testing","junit"],"answers":[{"comments":[{"owner":{"account_id":15518530,"reputation":36,"user_id":11195302,"display_name":"Pranjal Chamola"},"score":0,"creation_date":1587389981,"post_id":61321289,"comment_id":108484695,"body_markdown":"Still not working, Do i need to define anything in TestConfig?","body":"Still not working, Do i need to define anything in TestConfig?"},{"owner":{"account_id":3710759,"reputation":104,"user_id":3088166,"display_name":"a.eugene"},"score":0,"creation_date":1587391194,"post_id":61321289,"comment_id":108485512,"body_markdown":"No. So, this message `No mapping found for HTTP request` shows us that this controller doesn&#39;t present in ApplicationContext. Is your application is Spring Boot?","body":"No. So, this message <code>No mapping found for HTTP request</code> shows us that this controller doesn&#39;t present in ApplicationContext. Is your application is Spring Boot?"},{"owner":{"account_id":3710759,"reputation":104,"user_id":3088166,"display_name":"a.eugene"},"score":0,"creation_date":1587391497,"post_id":61321289,"comment_id":108485742,"body_markdown":"I created a simple Spring Boot project via Initializer and implemented some logic as You have. The test is working perfectly. So I think the problem is in application configuration and code in question doesn&#39;t have any problem.","body":"I created a simple Spring Boot project via Initializer and implemented some logic as You have. The test is working perfectly. So I think the problem is in application configuration and code in question doesn&#39;t have any problem."}],"tags":[],"owner":{"account_id":3710759,"reputation":104,"user_id":3088166,"display_name":"a.eugene"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1587381813,"creation_date":1587381813,"answer_id":61321289,"question_id":61319742,"body_markdown":"Are you sure that your rest controller present in the application context that starts during the test? \r\n\r\nTry `@SpringBootTest(classes = TestConfig.class)` instead of `@SpringBootTest(classes = EncoderRest.class)`.\r\n\r\n    @Configuration\r\n    @EnableAutoConfiguration\r\n    public class TestConfig {\r\n\r\n    }","title":"No mapping found for HTTP request with URI [/api/encodedurl] in DispatcherServlet with name &#39;&#39;","body":"<p>Are you sure that your rest controller present in the application context that starts during the test? </p>\n\n<p>Try <code>@SpringBootTest(classes = TestConfig.class)</code> instead of <code>@SpringBootTest(classes = EncoderRest.class)</code>.</p>\n\n<pre><code>@Configuration\n@EnableAutoConfiguration\npublic class TestConfig {\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":13678477,"reputation":299,"user_id":9869394,"display_name":"Dinushika Rathnayake"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672919646,"creation_date":1672919646,"answer_id":75017992,"question_id":61319742,"body_markdown":"*No mapping found for HTTP request with URI [lanka-qr/tran/validate] in DispatcherServlet with name &#39;&#39;*\r\n\r\nNot related to application context but same error occurs due to missing leading forward slash when mock perform().\r\n\r\nMy Controller have @RequestMapping and @PostMapping like this.\r\n\r\n    @RequestMapping(value = &quot;aaa&quot;)\r\n\r\n    @PostMapping(value = &quot;bbb/ccc&quot;)\r\n\r\nWhen I perform mock like this, error occures.\r\n\r\n    mockMvc.perform(post(&quot;aaa/bbb/ccc&quot;)\r\nCorrected as,\r\n\r\n    mockMvc.perform(post(&quot;/aaa/bbb/ccc&quot;)","title":"No mapping found for HTTP request with URI [/api/encodedurl] in DispatcherServlet with name &#39;&#39;","body":"<p><em>No mapping found for HTTP request with URI [lanka-qr/tran/validate] in DispatcherServlet with name ''</em></p>\n<p>Not related to application context but same error occurs due to missing leading forward slash when mock perform().</p>\n<p>My Controller have @RequestMapping and @PostMapping like this.</p>\n<pre><code>@RequestMapping(value = &quot;aaa&quot;)\n\n@PostMapping(value = &quot;bbb/ccc&quot;)\n</code></pre>\n<p>When I perform mock like this, error occures.</p>\n<pre><code>mockMvc.perform(post(&quot;aaa/bbb/ccc&quot;)\n</code></pre>\n<p>Corrected as,</p>\n<pre><code>mockMvc.perform(post(&quot;/aaa/bbb/ccc&quot;)\n</code></pre>\n"}],"owner":{"account_id":15518530,"reputation":36,"user_id":11195302,"display_name":"Pranjal Chamola"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":458,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"answer_count":2,"score":1,"last_activity_date":1672919646,"creation_date":1587376811,"question_id":61319742,"body_markdown":"I am writing a JUnit test case for an API but getting error as `No mapping found for HTTP request with URI [/api/encodedurl] in DispatcherServlet with name &#39;&#39;`&lt;br&gt;\r\nI wasted more than 2 days not getting any solution checked every possible thing for this. API is token free already.\r\n\r\n\r\nHere is my code\r\n\r\n**Encoder Rest Test**\r\n\t\r\n\tpackage com.zoylo.admin.web.rest;\r\n\t\r\n\timport static org.junit.Assert.assertEquals;\t\r\n\timport org.junit.Test;\r\n\timport org.junit.runner.RunWith;\r\n\timport org.mockito.Mockito;\r\n\timport org.springframework.beans.factory.annotation.Autowired;\r\n\timport org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;\r\n\timport org.springframework.boot.test.context.SpringBootTest;\r\n\timport org.springframework.boot.test.mock.mockito.MockBean;\r\n\timport org.springframework.http.HttpStatus;\r\n\timport org.springframework.http.MediaType;\r\n\timport org.springframework.mock.web.MockHttpServletResponse;\r\n\timport org.springframework.test.context.junit4.SpringRunner;\r\n\timport org.springframework.test.web.servlet.MockMvc;\r\n\timport org.springframework.test.web.servlet.MvcResult;\r\n\timport org.springframework.test.web.servlet.RequestBuilder;\r\n\timport org.springframework.test.web.servlet.request.MockMvcRequestBuilders;\t\r\n\t\r\n\t@RunWith(SpringRunner.class)\r\n\t@SpringBootTest(classes = EncoderRest.class)\r\n\t@AutoConfigureMockMvc\r\n\tpublic class EncoderRestTest {\r\n\t\t@Autowired\r\n\t\tprivate MockMvc mockMvc;\r\n\t\r\n\t\t@MockBean\r\n\t\tprivate EncoderBll encoderBll;\r\n\t\r\n\t\tObjectMapper mapper = new ObjectMapper();\r\n\t\r\n\t\t@Test\r\n\t\tpublic void save() throws Exception {\r\n\t\t\t// mock output\r\n\t\t\tEncoderMV mv = new EncoderMV();\r\n\t\t\tmv.setPaymentUrl(&quot;www.paytm.com&quot;);\r\n\t\t\tMockito.when(encoderBll.createPaymentUrl(Mockito.any(EncoderVM.class))).thenReturn(mv);\r\n\t\r\n\t\t\tEncoderVM vm = new EncoderVM();\r\n\t\t\tvm.setBookingId(&quot;ICICI090&quot;);\r\n\t\t\tvm.setType(&quot;Payment&quot;);\r\n\t\r\n\t\t\tString requestBody = mapper.writerWithDefaultPrettyPrinter().writeValueAsString(vm);\r\n\t\t\tRequestBuilder requestBuilder = MockMvcRequestBuilders.post(&quot;/api/encodedurl&quot;)\r\n\t\t\t\t\t.accept(MediaType.APPLICATION_JSON).content(requestBody).contentType(MediaType.APPLICATION_JSON);\r\n\t\t\tMvcResult result = mockMvc.perform(requestBuilder).andReturn();\r\n\t\t\tMockHttpServletResponse response = result.getResponse();\r\n\t\t\tassertEquals(HttpStatus.CREATED.value(), response.getStatus());\r\n\t\r\n\t\t}\r\n\t\r\n\t}\r\n\t\r\n\r\n**EncoderRest**\r\n\t\r\n\t@RestController\r\n\t@RequestMapping(&quot;/api&quot;)\r\n\tpublic class EncoderRest {\r\n\t\t\r\n\t\tprivate final Logger logger = LoggerFactory.getLogger(this.getClass());\r\n\t\t\r\n\t\t@Autowired\r\n\t\tprivate EncoderBll encoderBll;\r\n\t\t\r\n\t\t\r\n\t\t@PostMapping(&quot;/encodedurl&quot;)\r\n\t\tpublic ResponseEntity&lt;?&gt; generateEncodedUrl(@RequestBody EncoderVM encoderVM) {\r\n\t\t\t......\r\n\t\t}\r\n\t}\r\n\t\r\n\r\n**EncoderBllImpl**\r\n\t\r\n\tpublic class EncoderBllImpl implements EncoderBll{\r\n\t\t\t\r\n\t\t@Override\r\n\t\tpublic EncoderMV createPaymentUrl(EncoderVM encoderVM) {\r\n\t\t\tEncoderMV encoderMV = null;\r\n\t\t\t.\r\n\t\t\t.\r\n\t\t\t.\t\r\n\t\t\treturn encoderMV;\r\n\t\t}\t\r\n\t}\r\n\t\r\n**Error**\r\n\t\r\n&gt;     No mapping found for HTTP request with URI [/api/encodedurl] in DispatcherServlet with name &#39;&#39;  \r\n\r\n","title":"No mapping found for HTTP request with URI [/api/encodedurl] in DispatcherServlet with name &#39;&#39;","body":"<p>I am writing a JUnit test case for an API but getting error as <code>No mapping found for HTTP request with URI [/api/encodedurl] in DispatcherServlet with name ''</code><br>\nI wasted more than 2 days not getting any solution checked every possible thing for this. API is token free already.</p>\n\n<p>Here is my code</p>\n\n<p><strong>Encoder Rest Test</strong></p>\n\n<pre><code>package com.zoylo.admin.web.rest;\n\nimport static org.junit.Assert.assertEquals;    \nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.mockito.Mockito;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.boot.test.mock.mockito.MockBean;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.MediaType;\nimport org.springframework.mock.web.MockHttpServletResponse;\nimport org.springframework.test.context.junit4.SpringRunner;\nimport org.springframework.test.web.servlet.MockMvc;\nimport org.springframework.test.web.servlet.MvcResult;\nimport org.springframework.test.web.servlet.RequestBuilder;\nimport org.springframework.test.web.servlet.request.MockMvcRequestBuilders; \n\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = EncoderRest.class)\n@AutoConfigureMockMvc\npublic class EncoderRestTest {\n    @Autowired\n    private MockMvc mockMvc;\n\n    @MockBean\n    private EncoderBll encoderBll;\n\n    ObjectMapper mapper = new ObjectMapper();\n\n    @Test\n    public void save() throws Exception {\n        // mock output\n        EncoderMV mv = new EncoderMV();\n        mv.setPaymentUrl(\"www.paytm.com\");\n        Mockito.when(encoderBll.createPaymentUrl(Mockito.any(EncoderVM.class))).thenReturn(mv);\n\n        EncoderVM vm = new EncoderVM();\n        vm.setBookingId(\"ICICI090\");\n        vm.setType(\"Payment\");\n\n        String requestBody = mapper.writerWithDefaultPrettyPrinter().writeValueAsString(vm);\n        RequestBuilder requestBuilder = MockMvcRequestBuilders.post(\"/api/encodedurl\")\n                .accept(MediaType.APPLICATION_JSON).content(requestBody).contentType(MediaType.APPLICATION_JSON);\n        MvcResult result = mockMvc.perform(requestBuilder).andReturn();\n        MockHttpServletResponse response = result.getResponse();\n        assertEquals(HttpStatus.CREATED.value(), response.getStatus());\n\n    }\n\n}\n</code></pre>\n\n<p><strong>EncoderRest</strong></p>\n\n<pre><code>@RestController\n@RequestMapping(\"/api\")\npublic class EncoderRest {\n\n    private final Logger logger = LoggerFactory.getLogger(this.getClass());\n\n    @Autowired\n    private EncoderBll encoderBll;\n\n\n    @PostMapping(\"/encodedurl\")\n    public ResponseEntity&lt;?&gt; generateEncodedUrl(@RequestBody EncoderVM encoderVM) {\n        ......\n    }\n}\n</code></pre>\n\n<p><strong>EncoderBllImpl</strong></p>\n\n<pre><code>public class EncoderBllImpl implements EncoderBll{\n\n    @Override\n    public EncoderMV createPaymentUrl(EncoderVM encoderVM) {\n        EncoderMV encoderMV = null;\n        .\n        .\n        .   \n        return encoderMV;\n    }   \n}\n</code></pre>\n\n<p><strong>Error</strong></p>\n\n<blockquote>\n<pre><code>No mapping found for HTTP request with URI [/api/encodedurl] in DispatcherServlet with name ''  \n</code></pre>\n</blockquote>\n"},{"tags":["java","image","url","io"],"comments":[{"owner":{"account_id":20466438,"reputation":115,"user_id":15017829,"display_name":"Mike Kim"},"score":0,"creation_date":1672298383,"post_id":74948118,"comment_id":132260831,"body_markdown":"What happens if you do `file = new File()` after the `mkdir()`? How about if you assign `boolean foo = directory.mkdir()` and print out `foo`, does it say &quot;true&quot;?","body":"What happens if you do <code>file = new File()</code> after the <code>mkdir()</code>? How about if you assign <code>boolean foo = directory.mkdir()</code> and print out <code>foo</code>, does it say &quot;true&quot;?"},{"owner":{"account_id":25902085,"reputation":35,"user_id":19627792,"display_name":"VegetaSan"},"score":0,"creation_date":1672302721,"post_id":74948118,"comment_id":132261830,"body_markdown":"@MikeKim I did `file = new File()` after the `mkdir()`, but it didn&#39;t help, still same error and works only half of the time... Regarding `boolean foo = directory.mkdir()` - it prints true if the folder doesn&#39;t exist and it creates one, if the folder is already created, its skips that if statement","body":"@MikeKim I did <code>file = new File()</code> after the <code>mkdir()</code>, but it didn&#39;t help, still same error and works only half of the time... Regarding <code>boolean foo = directory.mkdir()</code> - it prints true if the folder doesn&#39;t exist and it creates one, if the folder is already created, its skips that if statement"},{"owner":{"account_id":1531514,"reputation":26639,"user_id":1428606,"accept_rate":71,"display_name":"Harald K"},"score":0,"creation_date":1672304478,"post_id":74948118,"comment_id":132262280,"body_markdown":"*&quot;I&#39;m trying to convert URL to file and save it to the folder.&quot;* - For this task, you should probably just download the URL to file using an HTTP library. Unless you also need to convert the image to JPEG, you can leave `ImageIO` out of it, and save time. `ImageIO.read(URL)`, I believe, is intended mostly for local resources (ie. `ClassLoader.getResource(..)` URLs).  If you need the conversion, I suggest using 2 steps, first download, then convert. Very odd if your code works only in debug mode though...","body":"<i>&quot;I&#39;m trying to convert URL to file and save it to the folder.&quot;</i> - For this task, you should probably just download the URL to file using an HTTP library. Unless you also need to convert the image to JPEG, you can leave <code>ImageIO</code> out of it, and save time. <code>ImageIO.read(URL)</code>, I believe, is intended mostly for local resources (ie. <code>ClassLoader.getResource(..)</code> URLs).  If you need the conversion, I suggest using 2 steps, first download, then convert. Very odd if your code works only in debug mode though..."}],"owner":{"account_id":25902085,"reputation":35,"user_id":19627792,"display_name":"VegetaSan"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":101,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672919360,"creation_date":1672296985,"question_id":74948118,"body_markdown":"I&#39;m trying to convert URL to file and save it to the folder.\r\n\r\n    public void saveFileToStorage(String url, Long timestamp, Integer deviceId) {\r\n        String folder = &quot;D:\\\\Work\\\\S3\\\\&quot; + deviceId;\r\n        File directory = new File(folder);\r\n        File file = new File(folder, timestamp + &quot;.jpg&quot;);\r\n        if (!directory.exists()) {\r\n            directory.mkdir();\r\n        }\r\n        try {\r\n            URL link = new URL(url);\r\n            HttpURLConnection connection = (HttpURLConnection) link.openConnection();\r\n            BufferedImage image = ImageIO.read(connection.getInputStream());\r\n            ImageIO.write(image, &quot;jpg&quot;, file);\r\n            connection.disconnect();\r\n        } catch (IOException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\nBut this code works fine only in debug mode, when I start a program, most of the time it will throw - &quot;java.lang.RuntimeException: java.io.FileNotFoundException&quot; I tried to read image from URL only by using ImageIO.read and without HttpURLConnection, but it will always throw - &quot;Can&#39;t get input stream from URL!&quot;(in debug mode still works). Is there a way to fix this? Thank you\r\n\r\n**UPD: Solved!**\r\nThe problems was in url from which file uploads with delay, and because program works fast, it didn&#39;t have time to download file and threw FileNotFoundException. For now I added `Thread.slepp(1000)` and it works.\r\n","title":"java.lang.RuntimeException: java.io.FileNotFoundException: when creating file from URL(works in debug mode)","body":"<p>I'm trying to convert URL to file and save it to the folder.</p>\n<pre><code>public void saveFileToStorage(String url, Long timestamp, Integer deviceId) {\n    String folder = &quot;D:\\\\Work\\\\S3\\\\&quot; + deviceId;\n    File directory = new File(folder);\n    File file = new File(folder, timestamp + &quot;.jpg&quot;);\n    if (!directory.exists()) {\n        directory.mkdir();\n    }\n    try {\n        URL link = new URL(url);\n        HttpURLConnection connection = (HttpURLConnection) link.openConnection();\n        BufferedImage image = ImageIO.read(connection.getInputStream());\n        ImageIO.write(image, &quot;jpg&quot;, file);\n        connection.disconnect();\n    } catch (IOException e) {\n        throw new RuntimeException(e);\n    }\n}\n</code></pre>\n<p>But this code works fine only in debug mode, when I start a program, most of the time it will throw - &quot;java.lang.RuntimeException: java.io.FileNotFoundException&quot; I tried to read image from URL only by using ImageIO.read and without HttpURLConnection, but it will always throw - &quot;Can't get input stream from URL!&quot;(in debug mode still works). Is there a way to fix this? Thank you</p>\n<p><strong>UPD: Solved!</strong>\nThe problems was in url from which file uploads with delay, and because program works fast, it didn't have time to download file and threw FileNotFoundException. For now I added <code>Thread.slepp(1000)</code> and it works.</p>\n"},{"tags":["java","selenium"],"comments":[{"owner":{"account_id":9804742,"reputation":3296,"user_id":8157304,"accept_rate":75,"display_name":"sound wave"},"score":0,"creation_date":1672911233,"post_id":75006885,"comment_id":132381021,"body_markdown":"is it ok if i post python code? cause i&#39;m not familiar with java","body":"is it ok if i post python code? cause i&#39;m not familiar with java"}],"answers":[{"tags":[],"owner":{"account_id":12360572,"reputation":1730,"user_id":9014957,"accept_rate":17,"display_name":"pburgr"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672919160,"creation_date":1672919160,"answer_id":75017913,"question_id":75006885,"body_markdown":"This works just fine:\r\n\r\n    String chromedriverPath = System.getProperty(&quot;user.dir&quot;) + &quot;\\\\resources\\\\chromedriver.exe&quot;;\r\n    System.setProperty(&quot;webdriver.chrome.driver&quot;, chromedriverPath);\r\n    ChromeOptions options = new ChromeOptions();\r\n    options.addArguments(&quot;--ignore-certificate-errors&quot;);\r\n    options.addArguments(&quot;--start-maximized&quot;);\r\n    options.addArguments(&quot;--disable-notifications&quot;);\r\n    WebDriver driver = new ChromeDriver(options);\r\n    driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);\r\n\r\n    driver.get(&quot;https://www.google.com&quot;);\r\n    driver.findElement(By.id(&quot;L2AGLb&quot;)).click();","title":"How to handle with Google Cookies window in Selenium","body":"<p>This works just fine:</p>\n<pre><code>String chromedriverPath = System.getProperty(&quot;user.dir&quot;) + &quot;\\\\resources\\\\chromedriver.exe&quot;;\nSystem.setProperty(&quot;webdriver.chrome.driver&quot;, chromedriverPath);\nChromeOptions options = new ChromeOptions();\noptions.addArguments(&quot;--ignore-certificate-errors&quot;);\noptions.addArguments(&quot;--start-maximized&quot;);\noptions.addArguments(&quot;--disable-notifications&quot;);\nWebDriver driver = new ChromeDriver(options);\ndriver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);\n\ndriver.get(&quot;https://www.google.com&quot;);\ndriver.findElement(By.id(&quot;L2AGLb&quot;)).click();\n</code></pre>\n"}],"owner":{"account_id":27431792,"reputation":1,"user_id":20928364,"display_name":"CeBugger"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":29,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672919160,"creation_date":1672842500,"question_id":75006885,"body_markdown":"I can not find a way to handle with the Google Cookies window at the first navigation to google.com. I would like accept the cookies but I can not scroll down on the page. \r\n[screenshot here](https://i.stack.imgur.com/wjPhV.png)\r\n\r\nI guess focus is staying on the main page which is google.com but I could not switch to the cookies window. I have tried the iframe swithc, alert or popup iterator. None of them did not work. Any suggestion is appreciated.\r\n","title":"How to handle with Google Cookies window in Selenium","body":"<p>I can not find a way to handle with the Google Cookies window at the first navigation to google.com. I would like accept the cookies but I can not scroll down on the page.\n<a href=\"https://i.stack.imgur.com/wjPhV.png\" rel=\"nofollow noreferrer\">screenshot here</a></p>\n<p>I guess focus is staying on the main page which is google.com but I could not switch to the cookies window. I have tried the iframe swithc, alert or popup iterator. None of them did not work. Any suggestion is appreciated.</p>\n"},{"tags":["java","excel","apache-poi"],"comments":[{"owner":{"account_id":3685403,"reputation":9772,"user_id":3069254,"display_name":"Jorge_B"},"score":3,"creation_date":1392638327,"post_id":21828403,"comment_id":33037083,"body_markdown":"Are you totally sure that this output belongs to this program?","body":"Are you totally sure that this output belongs to this program?"},{"owner":{"account_id":125988,"reputation":4853,"user_id":2115021,"accept_rate":20,"display_name":"Kick"},"score":0,"creation_date":1392638507,"post_id":21828403,"comment_id":33037204,"body_markdown":"Dnt think the above code will throw any such error","body":"Dnt think the above code will throw any such error"},{"owner":{"account_id":3825012,"reputation":1457,"user_id":3172024,"display_name":"Naren"},"score":0,"creation_date":1392639608,"post_id":21828403,"comment_id":33037868,"body_markdown":"First refresh ur project in Eclipse then you can see it.. in the console there will be nothing .if you run this program","body":"First refresh ur project in Eclipse then you can see it.. in the console there will be nothing .if you run this program"},{"owner":{"account_id":350017,"reputation":47555,"user_id":685641,"display_name":"Gagravarr"},"score":1,"creation_date":1392723915,"post_id":21828403,"comment_id":33079713,"body_markdown":"Looks like you&#39;re running a different program!","body":"Looks like you&#39;re running a different program!"}],"answers":[{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1671148992,"post_id":74767070,"comment_id":132042584,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/74767070/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":27225279,"reputation":1,"user_id":20753875,"display_name":"Tamilarasi S"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672919151,"creation_date":1670824284,"answer_id":74767070,"question_id":21828403,"body_markdown":"Actually this error you will get while the Jar is still building. Just wait for few seconds. \r\n**Right Click** and then **Run** : It will work..!\r\n\r\n","title":"Error With creating an excel file from java POI","body":"<p>Actually this error you will get while the Jar is still building. Just wait for few seconds.\n<strong>Right Click</strong> and then <strong>Run</strong> : It will work..!</p>\n"}],"owner":{"account_id":2742280,"reputation":59,"user_id":2363546,"display_name":"mzpx"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":649,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672919151,"creation_date":1392638065,"question_id":21828403,"body_markdown":"Hi I would like to create an excel file from a java code, I put this code on eclipse but nothing happen\r\n\r\n    import org.apache.poi.ss.usermodel.Workbook;\r\n    import org.apache.poi.hssf.usermodel.HSSFWorkbook;\r\n    \r\n    import java.io.FileOutputStream;\r\n    \r\n    public class TestPOI1 {\r\n    \r\n         public static void main(String[] args) {\r\n             //create the new workbook\r\n             Workbook workbook = new HSSFWorkbook();\r\n    \r\n             try {\r\n                     //create the output stream to save the document on the hard drive\r\n                     FileOutputStream output = new FileOutputStream(&quot;Test1.xls&quot;);\r\n    \r\n                     //write the file onto the hard drive\r\n                     workbook.write(output);\r\n    \r\n                     //finish it up by closing the document\r\n                     output.close();\r\n             } catch(Exception e) {\r\n                     e.printStackTrace();\r\n             }   \r\n        }        \r\n    }\r\n\r\nin the console, this message is written\r\n\r\n     Usage: BiffDrawingToXml [options] inputWorkbook Options:\r\n     -exclude-workbook exclude workbook-level records\r\n     -sheet-indexes output sheets with specified indexes\r\n     -sheet-namek output sheets with specified name\r\n\r\nand I can&#39;t found my excel file in the hard drive or in the file project. thanks for help.","title":"Error With creating an excel file from java POI","body":"<p>Hi I would like to create an excel file from a java code, I put this code on eclipse but nothing happen</p>\n\n<pre><code>import org.apache.poi.ss.usermodel.Workbook;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\n\nimport java.io.FileOutputStream;\n\npublic class TestPOI1 {\n\n     public static void main(String[] args) {\n         //create the new workbook\n         Workbook workbook = new HSSFWorkbook();\n\n         try {\n                 //create the output stream to save the document on the hard drive\n                 FileOutputStream output = new FileOutputStream(\"Test1.xls\");\n\n                 //write the file onto the hard drive\n                 workbook.write(output);\n\n                 //finish it up by closing the document\n                 output.close();\n         } catch(Exception e) {\n                 e.printStackTrace();\n         }   \n    }        \n}\n</code></pre>\n\n<p>in the console, this message is written</p>\n\n<pre><code> Usage: BiffDrawingToXml [options] inputWorkbook Options:\n -exclude-workbook exclude workbook-level records\n -sheet-indexes output sheets with specified indexes\n -sheet-namek output sheets with specified name\n</code></pre>\n\n<p>and I can't found my excel file in the hard drive or in the file project. thanks for help.</p>\n"},{"tags":["java","oop","design-patterns"],"answers":[{"tags":[],"owner":{"account_id":319873,"reputation":87612,"user_id":637853,"accept_rate":50,"display_name":"Thomas"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672918911,"creation_date":1672917446,"answer_id":75017611,"question_id":75017457,"body_markdown":"Instead of having those special items I&#39;d suggest you try the following:\r\n\r\n- Provide rules for discounts like you&#39;re already doing. Define a hierarchy of rules since you might not want to combine discounts (e.g. &quot;buy x, get y free&quot; and &quot;buy x and pay only y&quot;)\r\n- Add &quot;discount&quot; items if a rule applies, e.g.\r\n  - &quot;buy x, get y free&quot; -&gt; add a discount of &quot;free_items * item_price&quot;, e.g. &quot;buy 6 and get 2 free&quot; with a price of 4.99 -&gt; position with value &quot;-9.98&quot;\r\n  - &quot;buy x for price y&quot; -&gt; add discount of &quot;items * (item_price - discounted_price)&quot;\r\n  - &quot;buy item x and get item y for price z&quot; -&gt; add discount item for &quot;y&quot; with a value of &quot;amount_of_y * (price_of_y - z)&quot;\r\n\r\n\r\nIn the end the receipt could thus look like this (with each line being an item):\r\n\r\n    Item          Amount Unit price  Total\r\n    ======================================\r\n    Coke               4       0.99   3.96\r\n    Coke 4 for 3       1      -0.99  -0.99  //item added by the &quot;buy 4 get 1 free&quot; rule\r\n    Snickers           2       1.95   3.90\r\n    Snickers 1.70      2      -0.25  -0.50  //item added by the &quot;get Snickers for 1.70&quot; rule\r\n    Beer              11       1.50  16.50\r\n    Chips              1       2.69   2.69      \r\n    Chips (for 6 beer) 1      -2.69  -2.69  //item added by the &quot;buy 6 beer and get 1 bag of chips&quot; rule, applied once 1 bag of chips was in the cart  \r\n    ======================================\r\n    Total                            22.87\r\n\r\nThis has the advantage of showing the original price as well as the discounts that were added. Of course the order of elements could be different if needed but I&#39;d basically maintain it like this:\r\n\r\n    List&lt;Item&gt; basketItems; //items the customer added with the original price\r\n    List&lt;Item&gt; discountItems; //items created by rules to show the discounts that were applied\r\n\r\n    List&lt;Item&gt; finalItems; //a combination of basketItems and discountItems to show in the output - either just concatenate or sort by item, group, price etc. as needed","title":"How to design a &#39;bundle&#39; discount for a supermarket checkout?","body":"<p>Instead of having those special items I'd suggest you try the following:</p>\n<ul>\n<li>Provide rules for discounts like you're already doing. Define a hierarchy of rules since you might not want to combine discounts (e.g. &quot;buy x, get y free&quot; and &quot;buy x and pay only y&quot;)</li>\n<li>Add &quot;discount&quot; items if a rule applies, e.g.\n<ul>\n<li>&quot;buy x, get y free&quot; -&gt; add a discount of &quot;free_items * item_price&quot;, e.g. &quot;buy 6 and get 2 free&quot; with a price of 4.99 -&gt; position with value &quot;-9.98&quot;</li>\n<li>&quot;buy x for price y&quot; -&gt; add discount of &quot;items * (item_price - discounted_price)&quot;</li>\n<li>&quot;buy item x and get item y for price z&quot; -&gt; add discount item for &quot;y&quot; with a value of &quot;amount_of_y * (price_of_y - z)&quot;</li>\n</ul>\n</li>\n</ul>\n<p>In the end the receipt could thus look like this (with each line being an item):</p>\n<pre><code>Item          Amount Unit price  Total\n======================================\nCoke               4       0.99   3.96\nCoke 4 for 3       1      -0.99  -0.99  //item added by the &quot;buy 4 get 1 free&quot; rule\nSnickers           2       1.95   3.90\nSnickers 1.70      2      -0.25  -0.50  //item added by the &quot;get Snickers for 1.70&quot; rule\nBeer              11       1.50  16.50\nChips              1       2.69   2.69      \nChips (for 6 beer) 1      -2.69  -2.69  //item added by the &quot;buy 6 beer and get 1 bag of chips&quot; rule, applied once 1 bag of chips was in the cart  \n======================================\nTotal                            22.87\n</code></pre>\n<p>This has the advantage of showing the original price as well as the discounts that were added. Of course the order of elements could be different if needed but I'd basically maintain it like this:</p>\n<pre><code>List&lt;Item&gt; basketItems; //items the customer added with the original price\nList&lt;Item&gt; discountItems; //items created by rules to show the discounts that were applied\n\nList&lt;Item&gt; finalItems; //a combination of basketItems and discountItems to show in the output - either just concatenate or sort by item, group, price etc. as needed\n</code></pre>\n"}],"owner":{"account_id":17492472,"reputation":11,"user_id":12684339,"display_name":"hfg124g76g1"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":225,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672918911,"creation_date":1672916651,"question_id":75017457,"body_markdown":"I&#39;m working on an exercise to create a supermarket design with various discounts for the products. Examples of discounts are:\r\n- Buy x amount of an item to get y free\r\n- Buy y amount of an item for $y\r\n- Buy item x and item y for $z\r\n\r\nThe first two discounts I have managed to create. But since the discount is calculated against the *basket item*, I&#39;m struggling to see how I can get the discount to apply to more than one products. I could create a brand new item and label it &quot;x and y&quot; but that feels a bit like cheating. Please advise\r\n\r\n\r\n\r\n```\r\nimport java.math.BigDecimal;\r\n\r\npublic class Item {\r\n\r\n    private final String sku;\r\n    private final BigDecimal unitPrice;\r\n\r\n    public Item(String sku, BigDecimal unitPrice) {\r\n        this.sku = sku;\r\n        this.unitPrice = unitPrice;\r\n    }\r\n\r\n    public BigDecimal getUnitPrice() {\r\n        return unitPrice;\r\n    }\r\n}\r\n\r\n```\r\n\r\n\r\n\r\n```\r\nimport java.math.BigDecimal;\r\n\r\npublic class BasketItem {\r\n\r\n    private final Item item;\r\n    private int quantity;\r\n    private final Discount discount;\r\n\r\n    public BasketItem(Item item, Discount discount) {\r\n        this.item = item;\r\n        this.discount = discount;\r\n        this.quantity = 1;\r\n    }\r\n\r\n    public BasketItem(Item item, Discount discount, int quantity) {\r\n        this.item = item;\r\n        this.discount = discount;\r\n        this.quantity = quantity;\r\n    }\r\n\r\n    public void increment() {\r\n        this.quantity++;\r\n    }\r\n\r\n    public BigDecimal calculateSubTotal() {\r\n        return item.getUnitPrice().multiply(new BigDecimal(quantity));\r\n    }\r\n\r\n    public BigDecimal calculateDiscount() {\r\n        return discount.apply(this);\r\n    }\r\n\r\n    public Item getItem() {\r\n        return item;\r\n    }\r\n\r\n    public int getQuantity() {\r\n        return quantity;\r\n    }\r\n\r\n}\r\n```\r\n\r\n\r\n```\r\nimport java.math.BigDecimal;\r\n\r\npublic interface Discount {\r\n\r\n    BigDecimal apply(BasketItem item);\r\n\r\n}\r\n```\r\n\r\n\r\n```\r\nimport java.math.BigDecimal;\r\nimport java.security.InvalidParameterException;\r\n\r\npublic class BuyXGetYFree implements Discount {\r\n\r\n    private final int buy;\r\n    private final int free;\r\n\r\n    public BuyXGetYFree(int buy, int free) {\r\n        if (buy &lt; 1) {\r\n            throw new InvalidParameterException(&quot;Can&#39;t buy less than 1 item&quot;);\r\n        }\r\n\r\n        if (free &lt; 1) {\r\n            throw new InvalidParameterException(&quot;Can&#39;t free less than 1 item for free&quot;);\r\n        }\r\n\r\n        if (free &gt; buy) {\r\n            throw new InvalidParameterException(&quot;The free amount must not exceed the purchased amount&quot;);\r\n        }\r\n\r\n        this.buy = buy;\r\n        this.free = free;\r\n    }\r\n\r\n    @Override\r\n    public BigDecimal apply(BasketItem basketItem) {\r\n\r\n        int quantity = basketItem.getQuantity();\r\n        BigDecimal unitPrice = basketItem.getItem().getUnitPrice();\r\n\r\n        if (buy + free &gt; quantity &amp;&amp; quantity &gt; buy) {\r\n            return unitPrice.multiply(BigDecimal.valueOf(quantity - buy));\r\n        }\r\n\r\n        int multiplier = quantity / (buy + free);\r\n        int forFree = multiplier * free;\r\n        return unitPrice.multiply(BigDecimal.valueOf(forFree));\r\n    }\r\n    \r\n}\r\n\r\n\r\n```\r\n\r\n\r\n\r\n```\r\nimport java.math.BigDecimal;\r\n\r\npublic class NoDiscount implements Discount {\r\n\r\n    @Override\r\n    public BigDecimal apply(BasketItem item) {\r\n        return BigDecimal.ZERO;\r\n    }\r\n}\r\n\r\n```\r\n\r\n\r\n```\r\nimport java.math.BigDecimal;\r\nimport java.security.InvalidParameterException;\r\n\r\npublic class BuyXForY implements Discount{\r\n\r\n    int buy;\r\n    BigDecimal pay;\r\n\r\n    public BuyXForY(int buy, BigDecimal pay) {\r\n        if (buy &lt; 1) {\r\n            throw new InvalidParameterException(&quot;Buy must be at least 1&quot;);\r\n        }\r\n        this.buy = buy;\r\n        this.pay = pay;\r\n    }\r\n\r\n    @Override\r\n    public BigDecimal apply(BasketItem item) {\r\n        int quantity = item.getQuantity();\r\n\r\n        if (quantity &lt; buy) {\r\n            return BigDecimal.ZERO;\r\n        }\r\n\r\n        int multiplier = quantity / buy;\r\n        int remainder = quantity % buy;\r\n\r\n        BigDecimal buyAtDiscountedPrice = new BigDecimal(multiplier).multiply(pay);\r\n        BigDecimal buyAtNormalPrice = new BigDecimal(multiplier).multiply(new BigDecimal(remainder));\r\n        BigDecimal normalPrice = new BigDecimal(quantity).multiply(item.getItem().getUnitPrice());\r\n\r\n        return normalPrice.subtract(buyAtDiscountedPrice.add(buyAtNormalPrice));\r\n    }\r\n}\r\n\r\n```\r\n\r\n\r\n```\r\npublic class DiscountAssignment {\r\n\r\n    private final Discount discount;\r\n    private final Item item;\r\n\r\n    public DiscountAssignment(Discount discount, Item item) {\r\n        this.discount = discount;\r\n        this.item = item;\r\n    }\r\n\r\n    public Discount getDiscount() {\r\n        return discount;\r\n    }\r\n\r\n    public Item getItem() {\r\n        return item;\r\n    }\r\n\r\n}\r\n```\r\n\r\n\r\n```\r\nimport java.math.BigDecimal;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\nimport java.util.Optional;\r\n\r\npublic class Checkout {\r\n\r\n    private final List&lt;BasketItem&gt; basketItems;\r\n    private final List&lt;DiscountAssignment&gt; discountAssignments;\r\n\r\n    public Checkout(List&lt;DiscountAssignment&gt; discountAssignments) {\r\n        this.basketItems = new ArrayList&lt;&gt;();\r\n        this.discountAssignments = discountAssignments;\r\n    }\r\n\r\n    public void scan(Item item) {\r\n        Optional&lt;BasketItem&gt; basketItemOptional = basketItems.stream().filter(basketItem -&gt; basketItem.getItem().equals(item)).findFirst();\r\n\r\n        if (basketItemOptional.isPresent()) {\r\n            basketItemOptional.get().increment();\r\n            return;\r\n        }\r\n\r\n        Optional&lt;DiscountAssignment&gt; discountsToApply = discountAssignments.stream().filter(discountAssignment -&gt; discountAssignment.getItem().equals(item)).findFirst();\r\n\r\n        if (discountsToApply.isPresent()) {\r\n            basketItems.add(new BasketItem(item, discountsToApply.get().getDiscount()));\r\n        } else {\r\n            basketItems.add(new BasketItem(item, new NoDiscount()));\r\n        }\r\n    }\r\n\r\n    public BigDecimal total() {\r\n        System.out.println(basketItems);\r\n\r\n        return basketItems.stream()\r\n                .map(BasketItem::calculateSubTotal)\r\n                .reduce(BigDecimal.ZERO, BigDecimal::add)\r\n                .subtract(basketItems.stream()\r\n                        .map(BasketItem::calculateDiscount)\r\n                        .reduce(BigDecimal.ZERO, BigDecimal::add));\r\n    }\r\n\r\n}\r\n\r\n```\r\n\r\nA quick test outputs a total cost of 4 \r\n\r\n```\r\nimport java.math.BigDecimal;\r\nimport java.util.List;\r\n\r\npublic class Test {\r\n\r\n    public static void main(String[] args) {\r\n        Item drink = new Item(&quot;Drink&quot;, new BigDecimal(1));\r\n        Item candy = new Item(&quot;Candy&quot;, new BigDecimal(1));\r\n\r\n        DiscountAssignment buyOneGetOneFreeDiscount = new DiscountAssignment(new BuyXGetYFree(1, 1), drink);\r\n        DiscountAssignment buyTwoForOneDollar = new DiscountAssignment(new BuyXForY(2, BigDecimal.ONE), candy);\r\n\r\n        Checkout checkout = new Checkout(List.of(buyOneGetOneFreeDiscount, buyTwoForOneDollar));\r\n        checkout.scan(drink);\r\n        checkout.scan(drink);\r\n        checkout.scan(drink);\r\n        checkout.scan(drink);\r\n        checkout.scan(candy);\r\n        checkout.scan(candy);\r\n\r\n        System.out.println(&quot;Total cost: &quot; + checkout.total());\r\n    }\r\n\r\n}\r\n\r\n```\r\n\r\n\r\n\r\n\r\nI tried created a brand new bundle item. But each item must be scanned individually. ","title":"How to design a &#39;bundle&#39; discount for a supermarket checkout?","body":"<p>I'm working on an exercise to create a supermarket design with various discounts for the products. Examples of discounts are:</p>\n<ul>\n<li>Buy x amount of an item to get y free</li>\n<li>Buy y amount of an item for $y</li>\n<li>Buy item x and item y for $z</li>\n</ul>\n<p>The first two discounts I have managed to create. But since the discount is calculated against the <em>basket item</em>, I'm struggling to see how I can get the discount to apply to more than one products. I could create a brand new item and label it &quot;x and y&quot; but that feels a bit like cheating. Please advise</p>\n<pre><code>import java.math.BigDecimal;\n\npublic class Item {\n\n    private final String sku;\n    private final BigDecimal unitPrice;\n\n    public Item(String sku, BigDecimal unitPrice) {\n        this.sku = sku;\n        this.unitPrice = unitPrice;\n    }\n\n    public BigDecimal getUnitPrice() {\n        return unitPrice;\n    }\n}\n\n</code></pre>\n<pre><code>import java.math.BigDecimal;\n\npublic class BasketItem {\n\n    private final Item item;\n    private int quantity;\n    private final Discount discount;\n\n    public BasketItem(Item item, Discount discount) {\n        this.item = item;\n        this.discount = discount;\n        this.quantity = 1;\n    }\n\n    public BasketItem(Item item, Discount discount, int quantity) {\n        this.item = item;\n        this.discount = discount;\n        this.quantity = quantity;\n    }\n\n    public void increment() {\n        this.quantity++;\n    }\n\n    public BigDecimal calculateSubTotal() {\n        return item.getUnitPrice().multiply(new BigDecimal(quantity));\n    }\n\n    public BigDecimal calculateDiscount() {\n        return discount.apply(this);\n    }\n\n    public Item getItem() {\n        return item;\n    }\n\n    public int getQuantity() {\n        return quantity;\n    }\n\n}\n</code></pre>\n<pre><code>import java.math.BigDecimal;\n\npublic interface Discount {\n\n    BigDecimal apply(BasketItem item);\n\n}\n</code></pre>\n<pre><code>import java.math.BigDecimal;\nimport java.security.InvalidParameterException;\n\npublic class BuyXGetYFree implements Discount {\n\n    private final int buy;\n    private final int free;\n\n    public BuyXGetYFree(int buy, int free) {\n        if (buy &lt; 1) {\n            throw new InvalidParameterException(&quot;Can't buy less than 1 item&quot;);\n        }\n\n        if (free &lt; 1) {\n            throw new InvalidParameterException(&quot;Can't free less than 1 item for free&quot;);\n        }\n\n        if (free &gt; buy) {\n            throw new InvalidParameterException(&quot;The free amount must not exceed the purchased amount&quot;);\n        }\n\n        this.buy = buy;\n        this.free = free;\n    }\n\n    @Override\n    public BigDecimal apply(BasketItem basketItem) {\n\n        int quantity = basketItem.getQuantity();\n        BigDecimal unitPrice = basketItem.getItem().getUnitPrice();\n\n        if (buy + free &gt; quantity &amp;&amp; quantity &gt; buy) {\n            return unitPrice.multiply(BigDecimal.valueOf(quantity - buy));\n        }\n\n        int multiplier = quantity / (buy + free);\n        int forFree = multiplier * free;\n        return unitPrice.multiply(BigDecimal.valueOf(forFree));\n    }\n    \n}\n\n\n</code></pre>\n<pre><code>import java.math.BigDecimal;\n\npublic class NoDiscount implements Discount {\n\n    @Override\n    public BigDecimal apply(BasketItem item) {\n        return BigDecimal.ZERO;\n    }\n}\n\n</code></pre>\n<pre><code>import java.math.BigDecimal;\nimport java.security.InvalidParameterException;\n\npublic class BuyXForY implements Discount{\n\n    int buy;\n    BigDecimal pay;\n\n    public BuyXForY(int buy, BigDecimal pay) {\n        if (buy &lt; 1) {\n            throw new InvalidParameterException(&quot;Buy must be at least 1&quot;);\n        }\n        this.buy = buy;\n        this.pay = pay;\n    }\n\n    @Override\n    public BigDecimal apply(BasketItem item) {\n        int quantity = item.getQuantity();\n\n        if (quantity &lt; buy) {\n            return BigDecimal.ZERO;\n        }\n\n        int multiplier = quantity / buy;\n        int remainder = quantity % buy;\n\n        BigDecimal buyAtDiscountedPrice = new BigDecimal(multiplier).multiply(pay);\n        BigDecimal buyAtNormalPrice = new BigDecimal(multiplier).multiply(new BigDecimal(remainder));\n        BigDecimal normalPrice = new BigDecimal(quantity).multiply(item.getItem().getUnitPrice());\n\n        return normalPrice.subtract(buyAtDiscountedPrice.add(buyAtNormalPrice));\n    }\n}\n\n</code></pre>\n<pre><code>public class DiscountAssignment {\n\n    private final Discount discount;\n    private final Item item;\n\n    public DiscountAssignment(Discount discount, Item item) {\n        this.discount = discount;\n        this.item = item;\n    }\n\n    public Discount getDiscount() {\n        return discount;\n    }\n\n    public Item getItem() {\n        return item;\n    }\n\n}\n</code></pre>\n<pre><code>import java.math.BigDecimal;\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Optional;\n\npublic class Checkout {\n\n    private final List&lt;BasketItem&gt; basketItems;\n    private final List&lt;DiscountAssignment&gt; discountAssignments;\n\n    public Checkout(List&lt;DiscountAssignment&gt; discountAssignments) {\n        this.basketItems = new ArrayList&lt;&gt;();\n        this.discountAssignments = discountAssignments;\n    }\n\n    public void scan(Item item) {\n        Optional&lt;BasketItem&gt; basketItemOptional = basketItems.stream().filter(basketItem -&gt; basketItem.getItem().equals(item)).findFirst();\n\n        if (basketItemOptional.isPresent()) {\n            basketItemOptional.get().increment();\n            return;\n        }\n\n        Optional&lt;DiscountAssignment&gt; discountsToApply = discountAssignments.stream().filter(discountAssignment -&gt; discountAssignment.getItem().equals(item)).findFirst();\n\n        if (discountsToApply.isPresent()) {\n            basketItems.add(new BasketItem(item, discountsToApply.get().getDiscount()));\n        } else {\n            basketItems.add(new BasketItem(item, new NoDiscount()));\n        }\n    }\n\n    public BigDecimal total() {\n        System.out.println(basketItems);\n\n        return basketItems.stream()\n                .map(BasketItem::calculateSubTotal)\n                .reduce(BigDecimal.ZERO, BigDecimal::add)\n                .subtract(basketItems.stream()\n                        .map(BasketItem::calculateDiscount)\n                        .reduce(BigDecimal.ZERO, BigDecimal::add));\n    }\n\n}\n\n</code></pre>\n<p>A quick test outputs a total cost of 4</p>\n<pre><code>import java.math.BigDecimal;\nimport java.util.List;\n\npublic class Test {\n\n    public static void main(String[] args) {\n        Item drink = new Item(&quot;Drink&quot;, new BigDecimal(1));\n        Item candy = new Item(&quot;Candy&quot;, new BigDecimal(1));\n\n        DiscountAssignment buyOneGetOneFreeDiscount = new DiscountAssignment(new BuyXGetYFree(1, 1), drink);\n        DiscountAssignment buyTwoForOneDollar = new DiscountAssignment(new BuyXForY(2, BigDecimal.ONE), candy);\n\n        Checkout checkout = new Checkout(List.of(buyOneGetOneFreeDiscount, buyTwoForOneDollar));\n        checkout.scan(drink);\n        checkout.scan(drink);\n        checkout.scan(drink);\n        checkout.scan(drink);\n        checkout.scan(candy);\n        checkout.scan(candy);\n\n        System.out.println(&quot;Total cost: &quot; + checkout.total());\n    }\n\n}\n\n</code></pre>\n<p>I tried created a brand new bundle item. But each item must be scanned individually.</p>\n"},{"tags":["java","spring","spring-boot"],"answers":[{"comments":[{"owner":{"account_id":13970001,"reputation":1974,"user_id":10088866,"display_name":"Clyde Barrow"},"score":0,"creation_date":1672923476,"post_id":75017845,"comment_id":132385009,"body_markdown":"that&#39;s my question - why the test fails after I add the dependency","body":"that&#39;s my question - why the test fails after I add the dependency"}],"tags":[],"owner":{"account_id":17258352,"reputation":94,"user_id":12496947,"display_name":"Nouman Ahmed"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672918735,"creation_date":1672918735,"answer_id":75017845,"question_id":75017290,"body_markdown":"I think you have Spring tests running when you try to build your project. So either fix the test or disable it if you don&#39;t need it for time being. ","title":"Project stops building after adding spring-boot-starter-oauth2-client","body":"<p>I think you have Spring tests running when you try to build your project. So either fix the test or disable it if you don't need it for time being.</p>\n"}],"owner":{"account_id":13970001,"reputation":1974,"user_id":10088866,"display_name":"Clyde Barrow"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":69,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672918735,"creation_date":1672915802,"question_id":75017290,"body_markdown":"I have a very simple spring boot app with dependencies like \r\n\r\n    \timplementation &#39;org.springframework.boot:spring-boot-starter-actuator&#39;\r\n    \timplementation &quot;org.springframework.boot:spring-boot-starter-validation&quot;\r\n    \timplementation &quot;org.springframework.boot:spring-boot-starter-actuator&quot;\r\n    \timplementation&quot;org.togglz:togglz-spring-boot-starter:3.2.1&quot;\r\n    \timplementation &quot;org.togglz:togglz-console:3.2.1&quot;\r\n    \tcompileOnly &#39;org.projectlombok:lombok&#39;\r\n    \tannotationProcessor &#39;org.projectlombok:lombok&#39;\r\n    \ttestImplementation &#39;org.springframework.boot:spring-boot-starter-test&#39;\r\n\r\nThe app is working fine but when I am adding the `spring-boot-starter-oauth2-client` suddenly the spring context cannot load and I get exception like \r\n```\r\njava.lang.IllegalStateException: Failed to load ApplicationContext\r\n\tat org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:98) ~[spring-test-5.3.23.jar:5.3.23]\r\n\tat org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:124) ~[spring-test-5.3.23.jar:5.3.23]\r\n\tat org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:118) ~[spring-test-5.3.23.jar:5.3.23]\r\n\tat org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83) ~[spring-test-5.3.23.jar:5.3.23]\r\n\tat org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener.prepareTestInstance(SpringBootDependencyInjectionTestExecutionListener.java:43) ~[spring-boot-test-autoconfigure-2.7.4.jar:2.7.4]\r\n\tat org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:248) ~[spring-test-5.3.23.jar:5.3.23]\r\n\tat org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:138) ~[spring-test-5.3.23.jar:5.3.23]\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$8(ClassBasedTestDescriptor.java:363) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:368) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$9(ClassBasedTestDescriptor.java:363) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197) ~[na:na]\r\n\tat java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179) ~[na:na]\r\n\tat java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625) ~[na:na]\r\n\tat java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509) ~[na:na]\r\n\tat java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499) ~[na:na]\r\n\tat java.base/java.util.stream.StreamSpliterators$WrappingSpliterator.forEachRemaining(StreamSpliterators.java:310) ~[na:na]\r\n\tat java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:735) ~[na:na]\r\n\tat java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:734) ~[na:na]\r\n\tat java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762) ~[na:na]\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:362) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$6(ClassBasedTestDescriptor.java:283) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:282) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$4(ClassBasedTestDescriptor.java:272) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:271) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$0(TestMethodTestDescriptor.java:102) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:101) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:66) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:123) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:123) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:90) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat java.base/java.util.ArrayList.forEach(ArrayList.java:1511) ~[na:na]\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat java.base/java.util.ArrayList.forEach(ArrayList.java:1511) ~[na:na]\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.8.2.jar:1.8.2]\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107) ~[na:na]\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88) ~[na:na]\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54) ~[na:na]\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67) ~[na:na]\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52) ~[na:na]\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114) ~[na:na]\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86) ~[na:na]\r\n\tat org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86) ~[na:na]\r\n\tat org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53) ~[na:na]\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:99) ~[na:na]\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:79) ~[na:na]\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:75) ~[na:na]\r\n\tat org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:62) ~[na:na]\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36) ~[na:na]\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24) ~[na:na]\r\n\tat org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33) ~[na:na]\r\n\tat org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94) ~[na:na]\r\n\tat jdk.proxy1/jdk.proxy1.$Proxy2.stop(Unknown Source) ~[na:na]\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:193) ~[na:na]\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129) ~[na:na]\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100) ~[na:na]\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60) ~[na:na]\r\n\tat org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56) ~[na:na]\r\n\tat org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:113) ~[na:na]\r\n\tat org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:65) ~[na:na]\r\n\tat worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69) ~[gradle-worker.jar:na]\r\n\tat worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74) ~[gradle-worker.jar:na]\r\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;featureManager&#39; defined in class path resource [org/togglz/spring/boot/actuate/autoconfigure/TogglzAutoConfiguration$FeatureManagerConfiguration.class]: Unsatisfied dependency expressed through method &#39;featureManager&#39; parameter 2; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &#39;org.togglz.core.user.UserProvider&#39; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:541) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918) ~[spring-context-5.3.23.jar:5.3.23]\r\n\tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583) ~[spring-context-5.3.23.jar:5.3.23]\r\n\tat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:734) ~[spring-boot-2.7.4.jar:2.7.4]\r\n\tat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.4.jar:2.7.4]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:308) ~[spring-boot-2.7.4.jar:2.7.4]\r\n\tat org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:132) ~[spring-boot-test-2.7.4.jar:2.7.4]\r\n\tat org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:141) ~[spring-test-5.3.23.jar:5.3.23]\r\n\tat org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:90) ~[spring-test-5.3.23.jar:5.3.23]\r\n\t... 88 common frames omitted\r\nCaused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &#39;org.togglz.core.user.UserProvider&#39; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoMatchingBeanFound(DefaultListableBeanFactory.java:1801) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1357) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\tat org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.23.jar:5.3.23]\r\n\t... 106 common frames omitted\r\n```\r\n\r\nI see that it has something to do with the actuator but I don&#39;t understand why it happens when I add this particular dependency. How to fix it ? \r\n \r\nI created a small example of the issue -&gt; https://github.com/solveretur/springissue/blob/main/build.gradle\r\n","title":"Project stops building after adding spring-boot-starter-oauth2-client","body":"<p>I have a very simple spring boot app with dependencies like</p>\n<pre><code>    implementation 'org.springframework.boot:spring-boot-starter-actuator'\n    implementation &quot;org.springframework.boot:spring-boot-starter-validation&quot;\n    implementation &quot;org.springframework.boot:spring-boot-starter-actuator&quot;\n    implementation&quot;org.togglz:togglz-spring-boot-starter:3.2.1&quot;\n    implementation &quot;org.togglz:togglz-console:3.2.1&quot;\n    compileOnly 'org.projectlombok:lombok'\n    annotationProcessor 'org.projectlombok:lombok'\n    testImplementation 'org.springframework.boot:spring-boot-starter-test'\n</code></pre>\n<p>The app is working fine but when I am adding the <code>spring-boot-starter-oauth2-client</code> suddenly the spring context cannot load and I get exception like</p>\n<pre><code>java.lang.IllegalStateException: Failed to load ApplicationContext\n    at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:98) ~[spring-test-5.3.23.jar:5.3.23]\n    at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:124) ~[spring-test-5.3.23.jar:5.3.23]\n    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:118) ~[spring-test-5.3.23.jar:5.3.23]\n    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:83) ~[spring-test-5.3.23.jar:5.3.23]\n    at org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener.prepareTestInstance(SpringBootDependencyInjectionTestExecutionListener.java:43) ~[spring-boot-test-autoconfigure-2.7.4.jar:2.7.4]\n    at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:248) ~[spring-test-5.3.23.jar:5.3.23]\n    at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:138) ~[spring-test-5.3.23.jar:5.3.23]\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$8(ClassBasedTestDescriptor.java:363) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:368) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$9(ClassBasedTestDescriptor.java:363) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197) ~[na:na]\n    at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179) ~[na:na]\n    at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625) ~[na:na]\n    at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509) ~[na:na]\n    at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499) ~[na:na]\n    at java.base/java.util.stream.StreamSpliterators$WrappingSpliterator.forEachRemaining(StreamSpliterators.java:310) ~[na:na]\n    at java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:735) ~[na:na]\n    at java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:734) ~[na:na]\n    at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762) ~[na:na]\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:362) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$6(ClassBasedTestDescriptor.java:283) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:282) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$4(ClassBasedTestDescriptor.java:272) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:271) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$0(TestMethodTestDescriptor.java:102) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:101) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:66) ~[junit-jupiter-engine-5.8.2.jar:5.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:123) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:123) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:90) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at java.base/java.util.ArrayList.forEach(ArrayList.java:1511) ~[na:na]\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at java.base/java.util.ArrayList.forEach(ArrayList.java:1511) ~[na:na]\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.8.2.jar:1.8.2]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107) ~[na:na]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88) ~[na:na]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54) ~[na:na]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67) ~[na:na]\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52) ~[na:na]\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114) ~[na:na]\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86) ~[na:na]\n    at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86) ~[na:na]\n    at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53) ~[na:na]\n    at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:99) ~[na:na]\n    at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:79) ~[na:na]\n    at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:75) ~[na:na]\n    at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:62) ~[na:na]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\n    at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]\n    at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36) ~[na:na]\n    at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24) ~[na:na]\n    at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33) ~[na:na]\n    at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94) ~[na:na]\n    at jdk.proxy1/jdk.proxy1.$Proxy2.stop(Unknown Source) ~[na:na]\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:193) ~[na:na]\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129) ~[na:na]\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100) ~[na:na]\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60) ~[na:na]\n    at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56) ~[na:na]\n    at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:113) ~[na:na]\n    at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:65) ~[na:na]\n    at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69) ~[gradle-worker.jar:na]\n    at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74) ~[gradle-worker.jar:na]\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'featureManager' defined in class path resource [org/togglz/spring/boot/actuate/autoconfigure/TogglzAutoConfiguration$FeatureManagerConfiguration.class]: Unsatisfied dependency expressed through method 'featureManager' parameter 2; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'org.togglz.core.user.UserProvider' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}\n    at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:541) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918) ~[spring-context-5.3.23.jar:5.3.23]\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583) ~[spring-context-5.3.23.jar:5.3.23]\n    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:734) ~[spring-boot-2.7.4.jar:2.7.4]\n    at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.4.jar:2.7.4]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:308) ~[spring-boot-2.7.4.jar:2.7.4]\n    at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:132) ~[spring-boot-test-2.7.4.jar:2.7.4]\n    at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:141) ~[spring-test-5.3.23.jar:5.3.23]\n    at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:90) ~[spring-test-5.3.23.jar:5.3.23]\n    ... 88 common frames omitted\nCaused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'org.togglz.core.user.UserProvider' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoMatchingBeanFound(DefaultListableBeanFactory.java:1801) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1357) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.23.jar:5.3.23]\n    at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.23.jar:5.3.23]\n    ... 106 common frames omitted\n</code></pre>\n<p>I see that it has something to do with the actuator but I don't understand why it happens when I add this particular dependency. How to fix it ?</p>\n<p>I created a small example of the issue -&gt; <a href=\"https://github.com/solveretur/springissue/blob/main/build.gradle\" rel=\"nofollow noreferrer\">https://github.com/solveretur/springissue/blob/main/build.gradle</a></p>\n"},{"tags":["java","spring-boot","visual-studio-code","azure-appservice"],"comments":[{"owner":{"account_id":25311208,"reputation":7305,"user_id":19133920,"display_name":"JialeDu"},"score":0,"creation_date":1672909357,"post_id":75010485,"comment_id":132380405,"body_markdown":"You should use a version of the Java runtime org.springframework.boot.loader.WarLauncher on Azure App Service that is compatible with the version of the .class file.","body":"You should use a version of the Java runtime org.springframework.boot.loader.WarLauncher on Azure App Service that is compatible with the version of the .class file."},{"owner":{"account_id":4206618,"reputation":808,"user_id":4180447,"accept_rate":47,"display_name":"tarekahf"},"score":0,"creation_date":1672910291,"post_id":75010485,"comment_id":132380711,"body_markdown":"I tried and created several App Services with different JDK versions. When I selected JDK 17 the Container Crash error disappeared however I still cannot browse the service. I am still seeing the same error response I mentioned in the post above.","body":"I tried and created several App Services with different JDK versions. When I selected JDK 17 the Container Crash error disappeared however I still cannot browse the service. I am still seeing the same error response I mentioned in the post above."},{"owner":{"account_id":4206618,"reputation":808,"user_id":4180447,"accept_rate":47,"display_name":"tarekahf"},"score":0,"creation_date":1672912657,"post_id":75010485,"comment_id":132381452,"body_markdown":"@JialeDu check the update I added to the post above.","body":"@JialeDu check the update I added to the post above."},{"owner":{"account_id":405484,"reputation":34324,"user_id":774398,"accept_rate":83,"display_name":"Patrick"},"score":0,"creation_date":1678281605,"post_id":75010485,"comment_id":133501740,"body_markdown":"Could also be this issue: https://github.com/spring-projects/spring-boot/issues/33974","body":"Could also be this issue: <a href=\"https://github.com/spring-projects/spring-boot/issues/33974\" rel=\"nofollow noreferrer\">github.com/spring-projects/spring-boot/issues/33974</a>"}],"answers":[{"tags":[],"owner":{"account_id":4206618,"reputation":808,"user_id":4180447,"accept_rate":47,"display_name":"tarekahf"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672918468,"creation_date":1672917782,"answer_id":75017674,"question_id":75010485,"body_markdown":"I checked the steps from:\r\n\r\nhttps://learn.microsoft.com/en-us/azure/app-service/quickstart-java?pivots=platform-linux-development-environment-maven&amp;tabs=tomcat\r\n\r\nand, I combined the steps on the project I used earlier, mainly I ran the following commands:\r\n\r\n```\r\nPS&gt; cd complete\r\nPS&gt; mvn com.microsoft.azure:azure-webapp-maven-plugin:2.5.0:config\r\nPS&gt; mvn package azure-webapp:deploy\r\n```\r\nNote that when creating an App Service, the selection of version `Java 17` and web container `Java SE` is required to make it successful. Also, I was able to create the app service either using Maven command lines or using the Azure portal. I was unable to create the App Service with Java 17 from Azure Extension.\r\n\r\nThe maven config adds the App Service setup to the pom.xml:\r\n\r\n```\r\n  &lt;build&gt; \r\n    &lt;plugins&gt; \r\n      &lt;plugin&gt; \r\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;  \r\n        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; \r\n      &lt;/plugin&gt;  \r\n      &lt;plugin&gt;\r\n        &lt;groupId&gt;com.microsoft.azure&lt;/groupId&gt;\r\n        &lt;artifactId&gt;azure-webapp-maven-plugin&lt;/artifactId&gt;\r\n        &lt;version&gt;2.5.0&lt;/version&gt;\r\n        &lt;configuration&gt;\r\n          &lt;schemaVersion&gt;v2&lt;/schemaVersion&gt;\r\n          &lt;subscriptionId&gt;dd9aa0d1-f465-4cf3-a0e0-88aa1eb9a8c1&lt;/subscriptionId&gt;\r\n          &lt;resourceGroup&gt;spring-boot-complete-1672914653291-rg&lt;/resourceGroup&gt;\r\n          &lt;appName&gt;spring-boot-complete-1672914653291&lt;/appName&gt;\r\n          &lt;pricingTier&gt;P1v2&lt;/pricingTier&gt;\r\n          &lt;region&gt;centralus&lt;/region&gt;\r\n          &lt;runtime&gt;\r\n            &lt;os&gt;Linux&lt;/os&gt;\r\n            &lt;javaVersion&gt;Java 17&lt;/javaVersion&gt;\r\n            &lt;webContainer&gt;Java SE&lt;/webContainer&gt;\r\n          &lt;/runtime&gt;\r\n          &lt;deployment&gt;\r\n            &lt;resources&gt;\r\n              &lt;resource&gt;\r\n                &lt;directory&gt;${project.basedir}/target&lt;/directory&gt;\r\n                &lt;includes&gt;\r\n                  &lt;include&gt;*.jar&lt;/include&gt;\r\n                &lt;/includes&gt;\r\n              &lt;/resource&gt;\r\n            &lt;/resources&gt;\r\n          &lt;/deployment&gt;\r\n        &lt;/configuration&gt;\r\n      &lt;/plugin&gt;\r\n    &lt;/plugins&gt; \r\n  &lt;/build&gt; \r\n```\r\n\r\nAfter following the above steps, it worked right away. I was able to make changes and right-click on the JAR file and deploy to the App Service again without any problem.\r\n\r\nIt&#39;s clear the article from VS Code website is missing those steps.","title":"Errors navigating to Azure App Service after deploying Spring Boot Java App to Linux App Service","body":"<p>I checked the steps from:</p>\n<p><a href=\"https://learn.microsoft.com/en-us/azure/app-service/quickstart-java?pivots=platform-linux-development-environment-maven&amp;tabs=tomcat\" rel=\"nofollow noreferrer\">https://learn.microsoft.com/en-us/azure/app-service/quickstart-java?pivots=platform-linux-development-environment-maven&amp;tabs=tomcat</a></p>\n<p>and, I combined the steps on the project I used earlier, mainly I ran the following commands:</p>\n<pre><code>PS&gt; cd complete\nPS&gt; mvn com.microsoft.azure:azure-webapp-maven-plugin:2.5.0:config\nPS&gt; mvn package azure-webapp:deploy\n</code></pre>\n<p>Note that when creating an App Service, the selection of version <code>Java 17</code> and web container <code>Java SE</code> is required to make it successful. Also, I was able to create the app service either using Maven command lines or using the Azure portal. I was unable to create the App Service with Java 17 from Azure Extension.</p>\n<p>The maven config adds the App Service setup to the pom.xml:</p>\n<pre><code>  &lt;build&gt; \n    &lt;plugins&gt; \n      &lt;plugin&gt; \n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;  \n        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; \n      &lt;/plugin&gt;  \n      &lt;plugin&gt;\n        &lt;groupId&gt;com.microsoft.azure&lt;/groupId&gt;\n        &lt;artifactId&gt;azure-webapp-maven-plugin&lt;/artifactId&gt;\n        &lt;version&gt;2.5.0&lt;/version&gt;\n        &lt;configuration&gt;\n          &lt;schemaVersion&gt;v2&lt;/schemaVersion&gt;\n          &lt;subscriptionId&gt;dd9aa0d1-f465-4cf3-a0e0-88aa1eb9a8c1&lt;/subscriptionId&gt;\n          &lt;resourceGroup&gt;spring-boot-complete-1672914653291-rg&lt;/resourceGroup&gt;\n          &lt;appName&gt;spring-boot-complete-1672914653291&lt;/appName&gt;\n          &lt;pricingTier&gt;P1v2&lt;/pricingTier&gt;\n          &lt;region&gt;centralus&lt;/region&gt;\n          &lt;runtime&gt;\n            &lt;os&gt;Linux&lt;/os&gt;\n            &lt;javaVersion&gt;Java 17&lt;/javaVersion&gt;\n            &lt;webContainer&gt;Java SE&lt;/webContainer&gt;\n          &lt;/runtime&gt;\n          &lt;deployment&gt;\n            &lt;resources&gt;\n              &lt;resource&gt;\n                &lt;directory&gt;${project.basedir}/target&lt;/directory&gt;\n                &lt;includes&gt;\n                  &lt;include&gt;*.jar&lt;/include&gt;\n                &lt;/includes&gt;\n              &lt;/resource&gt;\n            &lt;/resources&gt;\n          &lt;/deployment&gt;\n        &lt;/configuration&gt;\n      &lt;/plugin&gt;\n    &lt;/plugins&gt; \n  &lt;/build&gt; \n</code></pre>\n<p>After following the above steps, it worked right away. I was able to make changes and right-click on the JAR file and deploy to the App Service again without any problem.</p>\n<p>It's clear the article from VS Code website is missing those steps.</p>\n"}],"owner":{"account_id":4206618,"reputation":808,"user_id":4180447,"accept_rate":47,"display_name":"tarekahf"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":579,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75017674,"answer_count":1,"score":0,"last_activity_date":1672918468,"creation_date":1672861139,"question_id":75010485,"body_markdown":"I followed the steps here:\r\n\r\nhttps://code.visualstudio.com/docs/java/java-webapp#_deploy-web-apps-to-the-cloud\r\n\r\nand deployed the app under the &quot;Complete&quot; folder to Azure App Service. I had to change the packaging type from JAR to WAR in pom.xml so that the deployment was successful, otherwise, it was not deploying and was getting errors something as cannot deploy JAR artifact.\r\n\r\nWhen I open the Azure App Service URL, I get the following error response:\r\n\r\n```\r\nHTTP Status 404 ‚Äì Not Found\r\nType Status Report\r\n\r\nMessage The requested resource [/] is not available\r\n\r\nDescription The origin server did not find a current representation for the target resource or is not willing to disclose that one exists.\r\n\r\nApache Tomcat/8.5.78\r\n```\r\n\r\nI did enable the logs and diagnostics and I see the following error under App Service | AppServiceName | Diagnose and solve problems:\r\n\r\n```\r\nContainer Crash\r\nDisplays application logs for why the container may have crashed\r\nApplication Errors that may have caused the container to crash were detected\r\n2023-01-04T17:04:36.769939898Z Picked up JAVA_TOOL_OPTIONS: -Xmx716M -Djava.net.preferIPv4Stack=true 2023-01-04T17:04:37.193667111Z Error: LinkageError occurred while loading main class org.springframework.boot.loader.WarLauncher2023-01-04T17:04:37.197640485Z java.lang.UnsupportedClassVersionError: org/springframework/boot/loader/WarLauncher has been compiled by a more recent version of the Java Runtime (class file version 61.0), this version of the Java Runtime only recognizes class file versions up to 55.0 \r\n```\r\n\r\n\r\nBelow is the pom.xml after modifying the `java.version` from 17 to 18 and packaging from jar to war:\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n\txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\t&lt;parent&gt;\r\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;3.0.0&lt;/version&gt;\r\n\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n\t&lt;/parent&gt;\r\n\t&lt;groupId&gt;com.example&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-boot-complete&lt;/artifactId&gt;\r\n\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n\t&lt;name&gt;spring-boot-complete&lt;/name&gt;\r\n\t&lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\r\n\t&lt;packaging&gt;war&lt;/packaging&gt;\r\n\r\n\t&lt;properties&gt;\r\n\t\t&lt;java.version&gt;18&lt;/java.version&gt;\r\n\t&lt;/properties&gt;\r\n\r\n\t&lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;!-- tag::actuator[] --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;!-- end::actuator[] --&gt;\r\n\r\n\t\t&lt;!-- tag::tests[] --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;!-- end::tests[] --&gt;\r\n\t&lt;/dependencies&gt;\r\n\r\n\t&lt;build&gt;\r\n\t\t&lt;plugins&gt;\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\t\t&lt;/plugins&gt;\r\n\t&lt;/build&gt;\r\n\r\n&lt;/project&gt;\r\n``` \r\n\r\nThe JDK used was JDK 18 in VS Code on my local and the one deployed on Azure App Service was JDK 11. The Spring Boot configured in the pom.xml seems to be based on JDK 17. I repeated the deployment and chose App Service JDK 17 and Tomcat 10. This time I didn&#39;t see the error above in the diagnostic logs, but still, I see the same error response when I navigate to the app service URL.\r\n\r\nUpdate 1\r\n===\r\nI followed the steps from this article and it worked from the first time: https://learn.microsoft.com/en-us/azure/app-service/quickstart-java?pivots=platform-linux-development-environment-maven&amp;tabs=tomcat\r\n\r\nI think the missing step from the first article is the configuration of Maven `com.microsoft.azure:azure-webapp-maven-plugin`. I need to check it out. The steps create the `helloworld` app with the following pom.xml. I think I cam compare and figure out the changes.\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;  \r\n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;  \r\n  &lt;groupId&gt;example.demo&lt;/groupId&gt;  \r\n  &lt;artifactId&gt;helloworld&lt;/artifactId&gt;  \r\n  &lt;packaging&gt;war&lt;/packaging&gt;  \r\n  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;  \r\n  &lt;name&gt;helloworld Maven Webapp&lt;/name&gt;  \r\n  &lt;url&gt;http://maven.apache.org&lt;/url&gt;  \r\n  &lt;dependencies&gt; \r\n    &lt;dependency&gt; \r\n      &lt;groupId&gt;junit&lt;/groupId&gt;  \r\n      &lt;artifactId&gt;junit&lt;/artifactId&gt;  \r\n      &lt;version&gt;3.8.1&lt;/version&gt;  \r\n      &lt;scope&gt;test&lt;/scope&gt; \r\n    &lt;/dependency&gt; \r\n  &lt;/dependencies&gt;  \r\n  &lt;build&gt; \r\n    &lt;finalName&gt;helloworld&lt;/finalName&gt;  \r\n    &lt;plugins&gt;\r\n      &lt;plugin&gt;\r\n        &lt;groupId&gt;com.microsoft.azure&lt;/groupId&gt;\r\n        &lt;artifactId&gt;azure-webapp-maven-plugin&lt;/artifactId&gt;\r\n        &lt;version&gt;2.5.0&lt;/version&gt;\r\n        &lt;configuration&gt;\r\n          &lt;schemaVersion&gt;v2&lt;/schemaVersion&gt;\r\n          &lt;subscriptionId&gt;dd9aa0d1-f465-4cf3-a0e0-88aa1eb9a8c1&lt;/subscriptionId&gt;\r\n          &lt;resourceGroup&gt;helloworld-1672911087928-rg&lt;/resourceGroup&gt;\r\n          &lt;appName&gt;helloworld-1672911087928&lt;/appName&gt;\r\n          &lt;pricingTier&gt;P1v2&lt;/pricingTier&gt;\r\n          &lt;region&gt;centralus&lt;/region&gt;\r\n          &lt;runtime&gt;\r\n            &lt;os&gt;Linux&lt;/os&gt;\r\n            &lt;javaVersion&gt;Java 11&lt;/javaVersion&gt;\r\n            &lt;webContainer&gt;Tomcat 8.5&lt;/webContainer&gt;\r\n          &lt;/runtime&gt;\r\n          &lt;deployment&gt;\r\n            &lt;resources&gt;\r\n              &lt;resource&gt;\r\n                &lt;directory&gt;${project.basedir}/target&lt;/directory&gt;\r\n                &lt;includes&gt;\r\n                  &lt;include&gt;*.war&lt;/include&gt;\r\n                &lt;/includes&gt;\r\n              &lt;/resource&gt;\r\n            &lt;/resources&gt;\r\n          &lt;/deployment&gt;\r\n        &lt;/configuration&gt;\r\n      &lt;/plugin&gt;\r\n    &lt;/plugins&gt;\r\n  &lt;/build&gt; \r\n&lt;/project&gt;\r\n```\r\n\r\nAny help to troubleshoot this problem would be greatly appreciated.","title":"Errors navigating to Azure App Service after deploying Spring Boot Java App to Linux App Service","body":"<p>I followed the steps here:</p>\n<p><a href=\"https://code.visualstudio.com/docs/java/java-webapp#_deploy-web-apps-to-the-cloud\" rel=\"nofollow noreferrer\">https://code.visualstudio.com/docs/java/java-webapp#_deploy-web-apps-to-the-cloud</a></p>\n<p>and deployed the app under the &quot;Complete&quot; folder to Azure App Service. I had to change the packaging type from JAR to WAR in pom.xml so that the deployment was successful, otherwise, it was not deploying and was getting errors something as cannot deploy JAR artifact.</p>\n<p>When I open the Azure App Service URL, I get the following error response:</p>\n<pre><code>HTTP Status 404 ‚Äì Not Found\nType Status Report\n\nMessage The requested resource [/] is not available\n\nDescription The origin server did not find a current representation for the target resource or is not willing to disclose that one exists.\n\nApache Tomcat/8.5.78\n</code></pre>\n<p>I did enable the logs and diagnostics and I see the following error under App Service | AppServiceName | Diagnose and solve problems:</p>\n<pre><code>Container Crash\nDisplays application logs for why the container may have crashed\nApplication Errors that may have caused the container to crash were detected\n2023-01-04T17:04:36.769939898Z Picked up JAVA_TOOL_OPTIONS: -Xmx716M -Djava.net.preferIPv4Stack=true 2023-01-04T17:04:37.193667111Z Error: LinkageError occurred while loading main class org.springframework.boot.loader.WarLauncher2023-01-04T17:04:37.197640485Z java.lang.UnsupportedClassVersionError: org/springframework/boot/loader/WarLauncher has been compiled by a more recent version of the Java Runtime (class file version 61.0), this version of the Java Runtime only recognizes class file versions up to 55.0 \n</code></pre>\n<p>Below is the pom.xml after modifying the <code>java.version</code> from 17 to 18 and packaging from jar to war:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.0.0&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-complete&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;spring-boot-complete&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;packaging&gt;war&lt;/packaging&gt;\n\n    &lt;properties&gt;\n        &lt;java.version&gt;18&lt;/java.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- tag::actuator[] --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;!-- end::actuator[] --&gt;\n\n        &lt;!-- tag::tests[] --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;!-- end::tests[] --&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p>The JDK used was JDK 18 in VS Code on my local and the one deployed on Azure App Service was JDK 11. The Spring Boot configured in the pom.xml seems to be based on JDK 17. I repeated the deployment and chose App Service JDK 17 and Tomcat 10. This time I didn't see the error above in the diagnostic logs, but still, I see the same error response when I navigate to the app service URL.</p>\n<h1>Update 1</h1>\n<p>I followed the steps from this article and it worked from the first time: <a href=\"https://learn.microsoft.com/en-us/azure/app-service/quickstart-java?pivots=platform-linux-development-environment-maven&amp;tabs=tomcat\" rel=\"nofollow noreferrer\">https://learn.microsoft.com/en-us/azure/app-service/quickstart-java?pivots=platform-linux-development-environment-maven&amp;tabs=tomcat</a></p>\n<p>I think the missing step from the first article is the configuration of Maven <code>com.microsoft.azure:azure-webapp-maven-plugin</code>. I need to check it out. The steps create the <code>helloworld</code> app with the following pom.xml. I think I cam compare and figure out the changes.</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;  \n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;  \n  &lt;groupId&gt;example.demo&lt;/groupId&gt;  \n  &lt;artifactId&gt;helloworld&lt;/artifactId&gt;  \n  &lt;packaging&gt;war&lt;/packaging&gt;  \n  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;  \n  &lt;name&gt;helloworld Maven Webapp&lt;/name&gt;  \n  &lt;url&gt;http://maven.apache.org&lt;/url&gt;  \n  &lt;dependencies&gt; \n    &lt;dependency&gt; \n      &lt;groupId&gt;junit&lt;/groupId&gt;  \n      &lt;artifactId&gt;junit&lt;/artifactId&gt;  \n      &lt;version&gt;3.8.1&lt;/version&gt;  \n      &lt;scope&gt;test&lt;/scope&gt; \n    &lt;/dependency&gt; \n  &lt;/dependencies&gt;  \n  &lt;build&gt; \n    &lt;finalName&gt;helloworld&lt;/finalName&gt;  \n    &lt;plugins&gt;\n      &lt;plugin&gt;\n        &lt;groupId&gt;com.microsoft.azure&lt;/groupId&gt;\n        &lt;artifactId&gt;azure-webapp-maven-plugin&lt;/artifactId&gt;\n        &lt;version&gt;2.5.0&lt;/version&gt;\n        &lt;configuration&gt;\n          &lt;schemaVersion&gt;v2&lt;/schemaVersion&gt;\n          &lt;subscriptionId&gt;dd9aa0d1-f465-4cf3-a0e0-88aa1eb9a8c1&lt;/subscriptionId&gt;\n          &lt;resourceGroup&gt;helloworld-1672911087928-rg&lt;/resourceGroup&gt;\n          &lt;appName&gt;helloworld-1672911087928&lt;/appName&gt;\n          &lt;pricingTier&gt;P1v2&lt;/pricingTier&gt;\n          &lt;region&gt;centralus&lt;/region&gt;\n          &lt;runtime&gt;\n            &lt;os&gt;Linux&lt;/os&gt;\n            &lt;javaVersion&gt;Java 11&lt;/javaVersion&gt;\n            &lt;webContainer&gt;Tomcat 8.5&lt;/webContainer&gt;\n          &lt;/runtime&gt;\n          &lt;deployment&gt;\n            &lt;resources&gt;\n              &lt;resource&gt;\n                &lt;directory&gt;${project.basedir}/target&lt;/directory&gt;\n                &lt;includes&gt;\n                  &lt;include&gt;*.war&lt;/include&gt;\n                &lt;/includes&gt;\n              &lt;/resource&gt;\n            &lt;/resources&gt;\n          &lt;/deployment&gt;\n        &lt;/configuration&gt;\n      &lt;/plugin&gt;\n    &lt;/plugins&gt;\n  &lt;/build&gt; \n&lt;/project&gt;\n</code></pre>\n<p>Any help to troubleshoot this problem would be greatly appreciated.</p>\n"},{"tags":["java","queue","addition"],"answers":[{"comments":[{"owner":{"account_id":106062,"reputation":31478,"user_id":282706,"accept_rate":80,"display_name":"Finbarr"},"score":0,"creation_date":1272102955,"post_id":2704005,"comment_id":2727439,"body_markdown":"I know, I just posted that answer myself a few minutes ago. Do you know of any classes where the `add` method is different to the `offer` method?","body":"I know, I just posted that answer myself a few minutes ago. Do you know of any classes where the <code>add</code> method is different to the <code>offer</code> method?"}],"tags":[],"owner":{"account_id":9400,"reputation":54564,"user_id":17343,"accept_rate":81,"display_name":"Peter Lang"},"comment_count":1,"down_vote_count":0,"up_vote_count":42,"is_accepted":false,"score":42,"last_activity_date":1672917958,"creation_date":1272102797,"answer_id":2704005,"question_id":2703984,"body_markdown":"The short answer: **it depends** on the concrete implementation.\r\n\r\nIf your queue has a max capacity limit, there actually is a difference.  \r\n \r\n\r\n - Case #1 (**no max capacity limit**) applied:\r\n\r\nThere is **no difference** like the implementation of [`PriorityQueue`][1]:\r\n\r\n    public boolean add(E e) {\r\n        return offer(e);\r\n    }\r\n\r\n---\r\n\r\n - Case #2 (**max capacity limit**) applied:\r\n\r\n**There actually is a difference** like the implementation of [`ArrayBlockingQueue`][2] which extends [`AbstractQueue`][3] :\r\n\r\n    // ArrayBlockingQueue which extends AbstractQueue\r\n    public boolean add(E e) {\r\n        return super.add(e);\r\n    }\r\n    \r\n    // AbstractQueue\r\n    public boolean add(E e) {\r\n        if (offer(e))\r\n            return true;\r\n        else\r\n            throw new IllegalStateException(&quot;Queue full&quot;);\r\n    }\r\n\r\n - `offer`: if the queue is full, return `false` and will not throw an exception\r\n - `add`: if the queue is full, throw an exception\r\n\r\n  [1]: https://docs.oracle.com/javase/7/docs/api/java/util/PriorityQueue.html\r\n  [2]: https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ArrayBlockingQueue.html\r\n  [3]: http://java.sun.com/j2se/1.5.0/docs/api/java/util/AbstractQueue.html","title":"What is the difference between the add and offer methods in a Queue in Java?","body":"<p>The short answer: <strong>it depends</strong> on the concrete implementation.</p>\n<p>If your queue has a max capacity limit, there actually is a difference.</p>\n<ul>\n<li>Case #1 (<strong>no max capacity limit</strong>) applied:</li>\n</ul>\n<p>There is <strong>no difference</strong> like the implementation of <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/PriorityQueue.html\" rel=\"nofollow noreferrer\"><code>PriorityQueue</code></a>:</p>\n<pre><code>public boolean add(E e) {\n    return offer(e);\n}\n</code></pre>\n<hr />\n<ul>\n<li>Case #2 (<strong>max capacity limit</strong>) applied:</li>\n</ul>\n<p><strong>There actually is a difference</strong> like the implementation of <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ArrayBlockingQueue.html\" rel=\"nofollow noreferrer\"><code>ArrayBlockingQueue</code></a> which extends <a href=\"http://java.sun.com/j2se/1.5.0/docs/api/java/util/AbstractQueue.html\" rel=\"nofollow noreferrer\"><code>AbstractQueue</code></a> :</p>\n<pre><code>// ArrayBlockingQueue which extends AbstractQueue\npublic boolean add(E e) {\n    return super.add(e);\n}\n\n// AbstractQueue\npublic boolean add(E e) {\n    if (offer(e))\n        return true;\n    else\n        throw new IllegalStateException(&quot;Queue full&quot;);\n}\n</code></pre>\n<ul>\n<li><code>offer</code>: if the queue is full, return <code>false</code> and will not throw an exception</li>\n<li><code>add</code>: if the queue is full, throw an exception</li>\n</ul>\n"},{"comments":[{"owner":{"account_id":106062,"reputation":31478,"user_id":282706,"accept_rate":80,"display_name":"Finbarr"},"score":7,"creation_date":1272103239,"post_id":2704023,"comment_id":2727467,"body_markdown":"+1 for finding that snippet about when to use `offer` vs `add`.","body":"+1 for finding that snippet about when to use <code>offer</code> vs <code>add</code>."}],"tags":[],"owner":{"account_id":67098,"reputation":2296,"user_id":196509,"display_name":"dvd"},"comment_count":1,"down_vote_count":0,"up_vote_count":201,"is_accepted":true,"score":201,"last_activity_date":1446782440,"creation_date":1272103064,"answer_id":2704023,"question_id":2703984,"body_markdown":"I guess the difference is in the contract, that when element can not be added to collection the `add` method throws an exception and `offer` doesn&#39;t.\r\n\r\nFrom: http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collection.html#add%28E%29\r\n&gt; If a collection refuses to add a\r\n&gt; particular element for any reason\r\n&gt; other than that it already contains\r\n&gt; the element, it **must throw** an\r\n&gt; exception (rather than returning\r\n&gt; false). This preserves the invariant\r\n&gt; that a collection always contains the\r\n&gt; specified element after this call\r\n&gt; returns.\r\n\r\nFrom: http://java.sun.com/j2se/1.5.0/docs/api/java/util/Queue.html#offer%28E%29\r\n\r\n&gt; Inserts the specified element into\r\n&gt; this queue, if possible. When using\r\n&gt; queues that may impose insertion\r\n&gt; restrictions (for example capacity\r\n&gt; bounds), method offer is generally\r\n&gt; preferable to method\r\n&gt; Collection.add(E), which can fail to\r\n&gt; insert an element only by throwing an\r\n&gt; exception.\r\n\r\n","title":"What is the difference between the add and offer methods in a Queue in Java?","body":"<p>I guess the difference is in the contract, that when element can not be added to collection the <code>add</code> method throws an exception and <code>offer</code> doesn't.</p>\n\n<p>From: <a href=\"http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collection.html#add%28E%29\" rel=\"noreferrer\">http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collection.html#add%28E%29</a></p>\n\n<blockquote>\n  <p>If a collection refuses to add a\n  particular element for any reason\n  other than that it already contains\n  the element, it <strong>must throw</strong> an\n  exception (rather than returning\n  false). This preserves the invariant\n  that a collection always contains the\n  specified element after this call\n  returns.</p>\n</blockquote>\n\n<p>From: <a href=\"http://java.sun.com/j2se/1.5.0/docs/api/java/util/Queue.html#offer%28E%29\" rel=\"noreferrer\">http://java.sun.com/j2se/1.5.0/docs/api/java/util/Queue.html#offer%28E%29</a></p>\n\n<blockquote>\n  <p>Inserts the specified element into\n  this queue, if possible. When using\n  queues that may impose insertion\n  restrictions (for example capacity\n  bounds), method offer is generally\n  preferable to method\n  Collection.add(E), which can fail to\n  insert an element only by throwing an\n  exception.</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"comment_count":0,"down_vote_count":0,"up_vote_count":20,"is_accepted":false,"score":20,"last_activity_date":1272103619,"creation_date":1272103212,"answer_id":2704036,"question_id":2703984,"body_markdown":"The difference between `offer` and `add` is explained by these two excerpts from the javadocs:\r\n\r\nFrom the [`Collection`][1] interface:\r\n\r\n&gt; If a collection refuses to `add` a particular element for any reason other than that it already contains the element, it must throw an exception (rather than returning false). This preserves the invariant that a collection always contains the specified element after this call returns. \r\n\r\nFrom the [`Queue`][2] interface\r\n\r\n&gt; When using queues that may impose insertion restrictions (for example capacity bounds), method `offer` is generally preferable to method `Collection.add(E)`, which can fail to insert an element only by throwing an exception. \r\n\r\n`PriorityQueue` is a `Queue` implementation that does not impose any insertion restrictions.  Therefore the `add` and `offer` methods have the same semantics.\r\n\r\nBy contrast, `ArrayBlockingQueue` is an implementation in which `offer` and `add` behave differently, depending on how the queue was instantiated.\r\n\r\n  [1]: http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collection.html#add(E)\r\n  [2]: http://java.sun.com/j2se/1.5.0/docs/api/java/util/Queue.html#offer(E)","title":"What is the difference between the add and offer methods in a Queue in Java?","body":"<p>The difference between <code>offer</code> and <code>add</code> is explained by these two excerpts from the javadocs:</p>\n\n<p>From the <a href=\"http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collection.html#add(E)\" rel=\"noreferrer\"><code>Collection</code></a> interface:</p>\n\n<blockquote>\n  <p>If a collection refuses to <code>add</code> a particular element for any reason other than that it already contains the element, it must throw an exception (rather than returning false). This preserves the invariant that a collection always contains the specified element after this call returns. </p>\n</blockquote>\n\n<p>From the <a href=\"http://java.sun.com/j2se/1.5.0/docs/api/java/util/Queue.html#offer(E)\" rel=\"noreferrer\"><code>Queue</code></a> interface</p>\n\n<blockquote>\n  <p>When using queues that may impose insertion restrictions (for example capacity bounds), method <code>offer</code> is generally preferable to method <code>Collection.add(E)</code>, which can fail to insert an element only by throwing an exception. </p>\n</blockquote>\n\n<p><code>PriorityQueue</code> is a <code>Queue</code> implementation that does not impose any insertion restrictions.  Therefore the <code>add</code> and <code>offer</code> methods have the same semantics.</p>\n\n<p>By contrast, <code>ArrayBlockingQueue</code> is an implementation in which <code>offer</code> and <code>add</code> behave differently, depending on how the queue was instantiated.</p>\n"},{"tags":[],"owner":{"account_id":1936670,"reputation":2894,"user_id":1743971,"display_name":"Yeshodhan Kulkarni"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1367946131,"creation_date":1367946131,"answer_id":16424648,"question_id":2703984,"body_markdown":"Source: http://docs.oracle.com/javase/6/docs/api/java/util/Queue.html\r\n\r\nThe offer method inserts an element if possible, otherwise returning false. This differs from the Collection.add method, which can fail to add an element only by throwing an unchecked exception. The offer method is designed for use when failure is a normal, rather than exceptional occurrence, for example, in fixed-capacity (or &quot;bounded&quot;) queues.","title":"What is the difference between the add and offer methods in a Queue in Java?","body":"<p>Source: <a href=\"http://docs.oracle.com/javase/6/docs/api/java/util/Queue.html\" rel=\"nofollow\">http://docs.oracle.com/javase/6/docs/api/java/util/Queue.html</a></p>\n\n<p>The offer method inserts an element if possible, otherwise returning false. This differs from the Collection.add method, which can fail to add an element only by throwing an unchecked exception. The offer method is designed for use when failure is a normal, rather than exceptional occurrence, for example, in fixed-capacity (or \"bounded\") queues.</p>\n"},{"tags":[],"owner":{"account_id":2519241,"reputation":81,"user_id":2189930,"display_name":"Heavin"},"comment_count":0,"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1400308184,"creation_date":1400306928,"answer_id":23708193,"question_id":2703984,"body_markdown":"from the source code in jdk 7 as follow:\r\n\r\n    public boolean add(E e) {\r\n        if (offer(e))\r\n            return true;\r\n        else\r\n            throw new IllegalStateException(&quot;Queue full&quot;);\r\n    }\r\n\r\nwe can easily know that the add function will return true when successfully add a new element into the queue, but throw a exception when failed .","title":"What is the difference between the add and offer methods in a Queue in Java?","body":"<p>from the source code in jdk 7 as follow:</p>\n\n<pre><code>public boolean add(E e) {\n    if (offer(e))\n        return true;\n    else\n        throw new IllegalStateException(\"Queue full\");\n}\n</code></pre>\n\n<p>we can easily know that the add function will return true when successfully add a new element into the queue, but throw a exception when failed .</p>\n"},{"tags":[],"owner":{"account_id":5460,"reputation":6354,"user_id":8792,"display_name":"Peter"},"comment_count":0,"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1402432999,"creation_date":1402432999,"answer_id":24150480,"question_id":2703984,"body_markdown":"The `Queue` interface specifies that `add()` will throw an `IllegalStateException` if no space is currently available (and otherwise return `true`) while `offer()` will return `false` if the element couldn&#39;t be inserted due to capacity restrictions.\r\n\r\nThe reason they are the same in a `PriorityQueue` is that this queue is specified to be unbounded, i.e. there are no capacity restrictions.  In the case of no capacity restrictions, the contracts of `add()` and `offer()` display the same behaviour.","title":"What is the difference between the add and offer methods in a Queue in Java?","body":"<p>The <code>Queue</code> interface specifies that <code>add()</code> will throw an <code>IllegalStateException</code> if no space is currently available (and otherwise return <code>true</code>) while <code>offer()</code> will return <code>false</code> if the element couldn't be inserted due to capacity restrictions.</p>\n\n<p>The reason they are the same in a <code>PriorityQueue</code> is that this queue is specified to be unbounded, i.e. there are no capacity restrictions.  In the case of no capacity restrictions, the contracts of <code>add()</code> and <code>offer()</code> display the same behaviour.</p>\n"},{"tags":[],"owner":{"account_id":3228622,"reputation":761,"user_id":2724374,"accept_rate":56,"display_name":"Aslam a"},"comment_count":0,"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1672917080,"creation_date":1501643441,"answer_id":45450816,"question_id":2703984,"body_markdown":"I will write the java contract example code for the `offer` method and the `add` method showing how they differ.\r\n\r\n\r\n    BlockingQueue&lt;String&gt; queue = new ArrayBlockingQueue&lt;&gt;(2);\r\n    queue.add(&quot;TestQuue1&quot;);  // will return true\t\t\r\n    queue.add(&quot;TestQuue2&quot;);\t // will return true\r\n    queue.add(&quot;TestQuue3&quot;);\t // will throw &quot;java.lang.IllegalStateException: Queue full\r\n    \r\n    BlockingQueue&lt;String&gt; queue = new ArrayBlockingQueue&lt;&gt;(2);\r\n    queue.offer(&quot;TestQuue1&quot;); // will return true\t\t\r\n    queue.offer(&quot;TestQuue2&quot;); // will return true\t\r\n    queue.offer(&quot;TestQuue3&quot;); // will return false and will not throw any exception","title":"What is the difference between the add and offer methods in a Queue in Java?","body":"<p>I will write the java contract example code for the <code>offer</code> method and the <code>add</code> method showing how they differ.</p>\n<pre><code>BlockingQueue&lt;String&gt; queue = new ArrayBlockingQueue&lt;&gt;(2);\nqueue.add(&quot;TestQuue1&quot;);  // will return true        \nqueue.add(&quot;TestQuue2&quot;);  // will return true\nqueue.add(&quot;TestQuue3&quot;);  // will throw &quot;java.lang.IllegalStateException: Queue full\n\nBlockingQueue&lt;String&gt; queue = new ArrayBlockingQueue&lt;&gt;(2);\nqueue.offer(&quot;TestQuue1&quot;); // will return true       \nqueue.offer(&quot;TestQuue2&quot;); // will return true   \nqueue.offer(&quot;TestQuue3&quot;); // will return false and will not throw any exception\n</code></pre>\n"},{"comments":[{"owner":{"account_id":3630754,"reputation":677,"user_id":3026998,"accept_rate":0,"display_name":"Raj"},"score":1,"creation_date":1542716127,"post_id":48967605,"comment_id":93660836,"body_markdown":"add method never returns false if the element is already available\n\n Queue&lt;String&gt; q = new PriorityQueue&lt;&gt;();\n        String b=&quot;java&quot;;\n        boolean is1 = q.add(b);\n        boolean is2 = q.add(&quot;java&quot;);\n        boolean is3 = q.add(b);\n        boolean is4 = q.offer(&quot;java&quot;);\n        boolean is5 = q.offer(b);\n        boolean is6 = q.offer(b);\n        System.out.println(&quot;qq::&quot;+q);","body":"add method never returns false if the element is already available   Queue&lt;String&gt; q = new PriorityQueue&lt;&gt;();         String b=&quot;java&quot;;         boolean is1 = q.add(b);         boolean is2 = q.add(&quot;java&quot;);         boolean is3 = q.add(b);         boolean is4 = q.offer(&quot;java&quot;);         boolean is5 = q.offer(b);         boolean is6 = q.offer(b);         System.out.println(&quot;qq::&quot;+q);"},{"owner":{"account_id":4553174,"reputation":454,"user_id":15068701,"display_name":"Maksym Ovsianikov"},"score":0,"creation_date":1543222189,"post_id":48967605,"comment_id":93824936,"body_markdown":"Thanks, Raj! I&#39;ve updated my response above. Oracle documentation says: &quot;The offer method inserts an element if possible, otherwise returning false. This differs from the Collection.add method, which can fail to add an element only by throwing an unchecked exception. The offer method is designed for use when failure is a normal, rather than exceptional occurrence, for example, in fixed-capacity (or &quot;bounded&quot;) queues.&quot;","body":"Thanks, Raj! I&#39;ve updated my response above. Oracle documentation says: &quot;The offer method inserts an element if possible, otherwise returning false. This differs from the Collection.add method, which can fail to add an element only by throwing an unchecked exception. The offer method is designed for use when failure is a normal, rather than exceptional occurrence, for example, in fixed-capacity (or &quot;bounded&quot;) queues.&quot;"}],"tags":[],"owner":{"account_id":4553174,"reputation":454,"user_id":15068701,"display_name":"Maksym Ovsianikov"},"comment_count":2,"down_vote_count":0,"up_vote_count":21,"is_accepted":false,"score":21,"last_activity_date":1543222329,"creation_date":1519506371,"answer_id":48967605,"question_id":2703984,"body_markdown":"The difference is following:\r\n\r\n - **offer** method - tries to add an element to a queue, and returns ***false*** if the element can&#39;t be added (like in case when a queue is full), or ***true*** if the element was added, and doesn&#39;t throw any specific exception.\r\n\r\n - **add** method - tries to add an element to a queue, returns ***true*** if the element was added, or throws an IllegalStateException if no space is currently available.","title":"What is the difference between the add and offer methods in a Queue in Java?","body":"<p>The difference is following:</p>\n\n<ul>\n<li><p><strong>offer</strong> method - tries to add an element to a queue, and returns <strong><em>false</em></strong> if the element can't be added (like in case when a queue is full), or <strong><em>true</em></strong> if the element was added, and doesn't throw any specific exception.</p></li>\n<li><p><strong>add</strong> method - tries to add an element to a queue, returns <strong><em>true</em></strong> if the element was added, or throws an IllegalStateException if no space is currently available.</p></li>\n</ul>\n"},{"tags":[],"owner":{"account_id":4893517,"reputation":53,"user_id":4159669,"display_name":"Neha Jain"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1651082968,"creation_date":1651082968,"answer_id":72033462,"question_id":2703984,"body_markdown":"**offer** method throws true or false, if addition is done\r\n\r\n**add** method throws an exception when no addition possible in queue","title":"What is the difference between the add and offer methods in a Queue in Java?","body":"<p><strong>offer</strong> method throws true or false, if addition is done</p>\n<p><strong>add</strong> method throws an exception when no addition possible in queue</p>\n"}],"owner":{"account_id":106062,"reputation":31478,"user_id":282706,"accept_rate":80,"display_name":"Finbarr"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":127636,"favorite_count":0,"down_vote_count":0,"up_vote_count":145,"accepted_answer_id":2704023,"answer_count":9,"score":145,"last_activity_date":1672917958,"creation_date":1272102379,"question_id":2703984,"body_markdown":"Take the `PriorityQueue` for example http://java.sun.com/j2se/1.5.0/docs/api/java/util/PriorityQueue.html#offer(E)\r\n\r\nCan anyone give me an example of a [`Queue`][1] where the [`add`][2] and [`offer`][3] methods are different?\r\n\r\nAccording to the [`Collection`][4] doc, the `add` method will often seek to ensure that an element exists within the `Collection` rather than adding duplicates. So my question is, what is the difference between the `add` and `offer` methods?\r\n\r\nIs it that the `offer` method will add duplicates regardless? (I doubt that it is because if a `Collection` should only have distinct elements this would circumvent that).\r\n\r\nEDIT:\r\nIn a `PriorityQueue` the `add` and `offer` methods are the same method (see my answer below). Can anyone give me an example of a class where the `add` and `offer` methods are different?\r\n\r\n\r\n  [1]: http://docs.oracle.com/javase/8/docs/api/java/util/Queue.html\r\n  [2]: http://docs.oracle.com/javase/8/docs/api/java/util/Queue.html#add-E-\r\n  [3]: http://docs.oracle.com/javase/8/docs/api/java/util/Queue.html#offer-E-\r\n  [4]: http://docs.oracle.com/javase/8/docs/api/java/util/Collection.html","title":"What is the difference between the add and offer methods in a Queue in Java?","body":"<p>Take the <code>PriorityQueue</code> for example <a href=\"http://java.sun.com/j2se/1.5.0/docs/api/java/util/PriorityQueue.html#offer(E)\" rel=\"noreferrer\">http://java.sun.com/j2se/1.5.0/docs/api/java/util/PriorityQueue.html#offer(E)</a></p>\n\n<p>Can anyone give me an example of a <a href=\"http://docs.oracle.com/javase/8/docs/api/java/util/Queue.html\" rel=\"noreferrer\"><code>Queue</code></a> where the <a href=\"http://docs.oracle.com/javase/8/docs/api/java/util/Queue.html#add-E-\" rel=\"noreferrer\"><code>add</code></a> and <a href=\"http://docs.oracle.com/javase/8/docs/api/java/util/Queue.html#offer-E-\" rel=\"noreferrer\"><code>offer</code></a> methods are different?</p>\n\n<p>According to the <a href=\"http://docs.oracle.com/javase/8/docs/api/java/util/Collection.html\" rel=\"noreferrer\"><code>Collection</code></a> doc, the <code>add</code> method will often seek to ensure that an element exists within the <code>Collection</code> rather than adding duplicates. So my question is, what is the difference between the <code>add</code> and <code>offer</code> methods?</p>\n\n<p>Is it that the <code>offer</code> method will add duplicates regardless? (I doubt that it is because if a <code>Collection</code> should only have distinct elements this would circumvent that).</p>\n\n<p>EDIT:\nIn a <code>PriorityQueue</code> the <code>add</code> and <code>offer</code> methods are the same method (see my answer below). Can anyone give me an example of a class where the <code>add</code> and <code>offer</code> methods are different?</p>\n"},{"tags":["java","spring-boot","spring-data-jpa","thymeleaf","spring-thymeleaf"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1672757330,"post_id":74940172,"comment_id":132343420,"body_markdown":"Check your logs for the full stack trace and add it (as code) to your question.","body":"Check your logs for the full stack trace and add it (as code) to your question."}],"answers":[{"comments":[{"owner":{"account_id":4487116,"reputation":429,"user_id":3649352,"accept_rate":67,"display_name":"Kunal Varpe"},"score":0,"creation_date":1672817127,"post_id":74994738,"comment_id":132356167,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/74994738/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":6632532,"reputation":1,"user_id":7121721,"display_name":"Tristan Mahinay"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672756293,"creation_date":1672756293,"answer_id":74994738,"question_id":74940172,"body_markdown":"One thing this cloud happen is some html tags aren&#39;t enclosed well. Like your &lt;meta&gt; tag should be closed too.","title":"How can I get the information that I already put in H2 Database to thymeleaf page?","body":"<p>One thing this cloud happen is some html tags aren't enclosed well. Like your  tag should be closed too.</p>\n"}],"owner":{"account_id":27373451,"reputation":1,"user_id":20879174,"display_name":"Bilel Guembri"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":85,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672917935,"creation_date":1672229928,"question_id":74940172,"body_markdown":"Client.java\r\n\r\n```\r\npackage com.example.demo.entities;\r\n\r\nimport java.io.Serializable;\r\nimport java.util.Collection;\r\n\r\nimport jakarta.persistence.Column;\r\nimport jakarta.persistence.Entity;\r\nimport jakarta.persistence.GeneratedValue;\r\nimport jakarta.persistence.GenerationType;\r\nimport jakarta.persistence.Id;\r\nimport jakarta.persistence.*;\r\nimport lombok.AllArgsConstructor;\r\nimport lombok.Getter;\r\nimport lombok.NoArgsConstructor;\r\nimport lombok.Setter;\r\n@Entity\r\n@Table(name = &quot;clients&quot;)\r\n@Getter\r\n@Setter\r\n@AllArgsConstructor\r\n@NoArgsConstructor\r\npublic class Client implements Serializable {\r\n\t@Id\r\n\t@GeneratedValue(strategy = GenerationType.IDENTITY)\r\n\tprivate Long id;\r\n\t\r\n\t@Column(name = &quot;name&quot;)\t\r\n\tprivate java.lang.String nom;\r\n\t\r\n\t@Column(name = &quot;adress&quot;)\t\r\n\tprivate java.lang.String adresse;\r\n\tprivate String mail;\r\n\tprivate String telephone;\r\n\t\r\n\t\r\n\tpublic Client(String nom, String adresse) {\r\n\t\tsuper();\r\n\t\tthis.nom = nom;\r\n\t\tthis.adresse = adresse;\r\n\t}\r\n\tpublic Client(String nom, String adresse,  String mail, String telephone) {\r\n\t\tsuper();\r\n\t\tthis.nom = nom;\r\n\t\tthis.adresse = adresse;\r\n\t\tthis.mail = mail;\r\n\t\tthis.telephone = telephone;\r\n\t}\r\n\tpublic Client() {};\r\n}\r\n```\r\n\r\nClientController.java\r\n\r\n```\r\npackage com.example.demo.controller;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.stereotype.Controller;\r\nimport org.springframework.ui.Model;\r\nimport org.springframework.web.bind.annotation.GetMapping;\r\n\r\nimport com.example.demo.entities.Client;\r\nimport com.example.demo.repository.ClientRepository;\r\n\r\n@Controller\r\npublic class ClientController{\r\n\t@Autowired\r\n\tpublic ClientRepository cr;\r\n\t@GetMapping(&quot;/&quot;)\r\n\tpublic String viewHomePage(Model model) {\r\n\t\tList &lt;Client&gt; list= cr.findAll();\r\n\t\tmodel.addAttribute(&quot;list&quot;,list);\r\n\t\treturn &quot;home&quot;;\t\r\n\t\t\r\n\t}\r\n\t\t\r\n}\r\n```\r\n\r\nClientRepository.java\r\n\r\n```\r\npackage com.example.demo.repository;\r\n\r\nimport org.springframework.data.jpa.repository.JpaRepository;\r\nimport org.springframework.stereotype.Repository;\r\n\r\nimport com.example.demo.entities.Client;\r\n@Repository \r\npublic interface ClientRepository extends JpaRepository&lt;Client,Long&gt;{\r\n\t\r\n}\r\n```\r\n\r\nmain.java\r\n\r\n```\r\npackage com.example.demo;\r\n\r\nimport org.springframework.boot.SpringApplication;\r\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\r\nimport org.springframework.context.ApplicationContext;\r\n\r\nimport com.example.demo.entities.Client;\r\nimport com.example.demo.repository.ClientRepository;\r\n\r\n@SpringBootApplication\r\npublic class Shop1Application {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\t\r\n\t\tApplicationContext crt=SpringApplication.run(Shop1Application.class, args);\r\n\t\tClientRepository cr=crt.getBean(ClientRepository.class);\r\n\t\tClient c1=new Client(&quot;Bilel&quot;,&quot;Hammamet&quot;,&quot;myemailis&quot;,&quot;123456&quot;);\r\n\t\tClient c2=new Client(&quot;Wissal&quot;,&quot;Tunis&quot;,&quot;herrmail&quot;,&quot;1151&quot;);\r\n\t\tClient c3=new Client(&quot;Mohamed&quot;,&quot;nabeul&quot;,&quot;hisemail&quot;,&quot;444&quot;);\r\n\t\tClient c4=new Client(&quot;anas&quot;,&quot;Hammamet&quot;,&quot;his&quot;,&quot;55222&quot;);\r\n\t\tClient c5=new Client(&quot;mourad&quot;,&quot;tunis&quot;,&quot;fffff&quot;,&quot;44&quot;);\r\n\t\tcr.save(c1);\r\n\t\tcr.save(c2);\r\n\t\tcr.save(c3);\r\n\t\tcr.save(c4);\r\n\t\tcr.save(c5);\r\n\t\t\r\n\t\r\n\t}\r\n\r\n}\r\n```\r\n\r\nhome.html\r\n\r\n```html\r\n&lt;!DOCTYPE html&gt;\r\n&lt;html xmlns:th=&quot;http//www.thymeleaf.org&quot;&gt;\r\n&lt;head&gt;\r\n&lt;meta charset=&quot;UTF-8&quot;&gt;\r\n&lt;title&gt;Insert title here&lt;/title&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;h1 &gt; Liste des clients de la base &lt;/h1&gt;\r\n&lt;div&gt;\r\n&lt;table&gt;\r\n&lt;tr&gt;\r\n&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;Nom&lt;/th&gt;&lt;th&gt;Adresse&lt;/th&gt;&lt;th&gt;Mail&lt;/th&gt;&lt;th&gt;telephone&lt;/th&gt;\r\n&lt;/tr&gt;\r\n&lt;tr th:each=&quot;c:${list}&quot;&gt;\r\n&lt;td th:text=&quot;${c.id}&quot;&gt;&lt;/td&gt;\r\n&lt;td th:text=&quot;${c.nom}&quot;&gt;&lt;/td&gt;\r\n&lt;td th:text=&quot;${c.adresse}&quot;&gt;&lt;/td&gt;\r\n&lt;td th:text=&quot;${c.mail}&quot;&gt;&lt;/td&gt;\r\n&lt;td th:text=&quot;${c.telephone}&quot;&gt;&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;/table&gt;\r\n&lt;/div&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n```\r\n\r\n\r\n[This is an ss of my packages][1] \r\n\r\n\r\n[This is an ss of error in localhost:8080][2]\r\n\r\n\r\n[This is h2 database][3]\r\n\r\n\r\nI tried to change in the home.html file but nothing happened I think the problem is in the home.html (Thymeleaf section). I think I have a problem calling the id, adresse, telephone from the repository which found in the h2 database to make them appear in a table in the thymeleaf page.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/OqWi7.png\r\n  [2]: https://i.stack.imgur.com/TBLps.png\r\n  [3]: https://i.stack.imgur.com/6ttfM.png","title":"How can I get the information that I already put in H2 Database to thymeleaf page?","body":"<p>Client.java</p>\n<pre><code>package com.example.demo.entities;\n\nimport java.io.Serializable;\nimport java.util.Collection;\n\nimport jakarta.persistence.Column;\nimport jakarta.persistence.Entity;\nimport jakarta.persistence.GeneratedValue;\nimport jakarta.persistence.GenerationType;\nimport jakarta.persistence.Id;\nimport jakarta.persistence.*;\nimport lombok.AllArgsConstructor;\nimport lombok.Getter;\nimport lombok.NoArgsConstructor;\nimport lombok.Setter;\n@Entity\n@Table(name = &quot;clients&quot;)\n@Getter\n@Setter\n@AllArgsConstructor\n@NoArgsConstructor\npublic class Client implements Serializable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n    \n    @Column(name = &quot;name&quot;)  \n    private java.lang.String nom;\n    \n    @Column(name = &quot;adress&quot;)    \n    private java.lang.String adresse;\n    private String mail;\n    private String telephone;\n    \n    \n    public Client(String nom, String adresse) {\n        super();\n        this.nom = nom;\n        this.adresse = adresse;\n    }\n    public Client(String nom, String adresse,  String mail, String telephone) {\n        super();\n        this.nom = nom;\n        this.adresse = adresse;\n        this.mail = mail;\n        this.telephone = telephone;\n    }\n    public Client() {};\n}\n</code></pre>\n<p>ClientController.java</p>\n<pre><code>package com.example.demo.controller;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.web.bind.annotation.GetMapping;\n\nimport com.example.demo.entities.Client;\nimport com.example.demo.repository.ClientRepository;\n\n@Controller\npublic class ClientController{\n    @Autowired\n    public ClientRepository cr;\n    @GetMapping(&quot;/&quot;)\n    public String viewHomePage(Model model) {\n        List &lt;Client&gt; list= cr.findAll();\n        model.addAttribute(&quot;list&quot;,list);\n        return &quot;home&quot;;  \n        \n    }\n        \n}\n</code></pre>\n<p>ClientRepository.java</p>\n<pre><code>package com.example.demo.repository;\n\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.stereotype.Repository;\n\nimport com.example.demo.entities.Client;\n@Repository \npublic interface ClientRepository extends JpaRepository&lt;Client,Long&gt;{\n    \n}\n</code></pre>\n<p>main.java</p>\n<pre><code>package com.example.demo;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.context.ApplicationContext;\n\nimport com.example.demo.entities.Client;\nimport com.example.demo.repository.ClientRepository;\n\n@SpringBootApplication\npublic class Shop1Application {\n\n    public static void main(String[] args) {\n        \n        ApplicationContext crt=SpringApplication.run(Shop1Application.class, args);\n        ClientRepository cr=crt.getBean(ClientRepository.class);\n        Client c1=new Client(&quot;Bilel&quot;,&quot;Hammamet&quot;,&quot;myemailis&quot;,&quot;123456&quot;);\n        Client c2=new Client(&quot;Wissal&quot;,&quot;Tunis&quot;,&quot;herrmail&quot;,&quot;1151&quot;);\n        Client c3=new Client(&quot;Mohamed&quot;,&quot;nabeul&quot;,&quot;hisemail&quot;,&quot;444&quot;);\n        Client c4=new Client(&quot;anas&quot;,&quot;Hammamet&quot;,&quot;his&quot;,&quot;55222&quot;);\n        Client c5=new Client(&quot;mourad&quot;,&quot;tunis&quot;,&quot;fffff&quot;,&quot;44&quot;);\n        cr.save(c1);\n        cr.save(c2);\n        cr.save(c3);\n        cr.save(c4);\n        cr.save(c5);\n        \n    \n    }\n\n}\n</code></pre>\n<p>home.html</p>\n<pre class=\"lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\n&lt;html xmlns:th=&quot;http//www.thymeleaf.org&quot;&gt;\n&lt;head&gt;\n&lt;meta charset=&quot;UTF-8&quot;&gt;\n&lt;title&gt;Insert title here&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1 &gt; Liste des clients de la base &lt;/h1&gt;\n&lt;div&gt;\n&lt;table&gt;\n&lt;tr&gt;\n&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;Nom&lt;/th&gt;&lt;th&gt;Adresse&lt;/th&gt;&lt;th&gt;Mail&lt;/th&gt;&lt;th&gt;telephone&lt;/th&gt;\n&lt;/tr&gt;\n&lt;tr th:each=&quot;c:${list}&quot;&gt;\n&lt;td th:text=&quot;${c.id}&quot;&gt;&lt;/td&gt;\n&lt;td th:text=&quot;${c.nom}&quot;&gt;&lt;/td&gt;\n&lt;td th:text=&quot;${c.adresse}&quot;&gt;&lt;/td&gt;\n&lt;td th:text=&quot;${c.mail}&quot;&gt;&lt;/td&gt;\n&lt;td th:text=&quot;${c.telephone}&quot;&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/OqWi7.png\" rel=\"nofollow noreferrer\">This is an ss of my packages</a></p>\n<p><a href=\"https://i.stack.imgur.com/TBLps.png\" rel=\"nofollow noreferrer\">This is an ss of error in localhost:8080</a></p>\n<p><a href=\"https://i.stack.imgur.com/6ttfM.png\" rel=\"nofollow noreferrer\">This is h2 database</a></p>\n<p>I tried to change in the home.html file but nothing happened I think the problem is in the home.html (Thymeleaf section). I think I have a problem calling the id, adresse, telephone from the repository which found in the h2 database to make them appear in a table in the thymeleaf page.</p>\n"},{"tags":["java","maven","pom.xml","spring-cloud"],"comments":[{"owner":{"account_id":6964901,"reputation":10403,"user_id":5343269,"accept_rate":45,"display_name":"11thdimension"},"score":0,"creation_date":1512633390,"post_id":47690101,"comment_id":82339260,"body_markdown":"Most likely you&#39;re behind a corporate proxy and maven hasn&#39;t been configured for it.","body":"Most likely you&#39;re behind a corporate proxy and maven hasn&#39;t been configured for it."},{"owner":{"account_id":8675941,"reputation":438,"user_id":6493369,"display_name":"Poorvi Nigotiya"},"score":0,"creation_date":1512633825,"post_id":47690101,"comment_id":82339486,"body_markdown":"There is no such proxy setting. Also, If I override the default version with some other version, it successfully downloads","body":"There is no such proxy setting. Also, If I override the default version with some other version, it successfully downloads"},{"owner":{"account_id":6964901,"reputation":10403,"user_id":5343269,"accept_rate":45,"display_name":"11thdimension"},"score":0,"creation_date":1512634368,"post_id":47690101,"comment_id":82339738,"body_markdown":"Default version of what?","body":"Default version of what?"},{"owner":{"account_id":112317,"reputation":93949,"user_id":296328,"accept_rate":60,"display_name":"khmarbaise"},"score":0,"creation_date":1512635308,"post_id":47690101,"comment_id":82340203,"body_markdown":"Have you run Maven on command line or from within Eclipse? If in eclipse please try from plain command line...Apart from that which version of Maven are you using? If this does not help. Delete the directory `$HOME/.m2/repository/org/springframework` and retry...","body":"Have you run Maven on command line or from within Eclipse? If in eclipse please try from plain command line...Apart from that which version of Maven are you using? If this does not help. Delete the directory <code>$HOME&#47;.m2&#47;repository&#47;org&#47;springframework</code> and retry..."},{"owner":{"account_id":8675941,"reputation":438,"user_id":6493369,"display_name":"Poorvi Nigotiya"},"score":0,"creation_date":1512636768,"post_id":47690101,"comment_id":82341023,"body_markdown":"@11thdimension - I am using Brixton.RELEASE which by default looks for org.springframework.boot:spring-boot-starter-web:jar:1.3.5.RELEASE. But if I override version as &lt;version&gt;1.3.6.RELEASE&lt;\\version&gt; it downloads successfully. Same for other dependency as well","body":"@11thdimension - I am using Brixton.RELEASE which by default looks for org.springframework.boot:spring-boot-starter-web:jar:1.3.5.R&zwnj;&#8203;ELEASE. But if I override version as &lt;version&gt;1.3.6.RELEASE&lt;\\version&gt; it downloads successfully. Same for other dependency as well"},{"owner":{"account_id":8675941,"reputation":438,"user_id":6493369,"display_name":"Poorvi Nigotiya"},"score":0,"creation_date":1512636909,"post_id":47690101,"comment_id":82341105,"body_markdown":"@khmarbaise I am using STS. I tried deleting the .m2 repository, but still facing the issue","body":"@khmarbaise I am using STS. I tried deleting the .m2 repository, but still facing the issue"},{"owner":{"account_id":6964901,"reputation":10403,"user_id":5343269,"accept_rate":45,"display_name":"11thdimension"},"score":0,"creation_date":1512658136,"post_id":47690101,"comment_id":82355040,"body_markdown":"It&#39;s strange, if it&#39;s working for one version and not working for a specific version. I tried your pom and it&#39;s working for me, that means there&#39;s nothing wrong with POM itself. Try running with `-X or --debug` may be that will give more clues.","body":"It&#39;s strange, if it&#39;s working for one version and not working for a specific version. I tried your pom and it&#39;s working for me, that means there&#39;s nothing wrong with POM itself. Try running with <code>-X or --debug</code> may be that will give more clues."},{"owner":{"account_id":8675941,"reputation":438,"user_id":6493369,"display_name":"Poorvi Nigotiya"},"score":0,"creation_date":1512714654,"post_id":47690101,"comment_id":82377602,"body_markdown":"Actually, I switched from STS to eclipse and surprisingly same pom.xml is working fine. It&#39;s a mystery how this could be IDE dependent. And that too when STS is built over Eclipse itself. I am clueless.","body":"Actually, I switched from STS to eclipse and surprisingly same pom.xml is working fine. It&#39;s a mystery how this could be IDE dependent. And that too when STS is built over Eclipse itself. I am clueless."}],"answers":[{"comments":[{"owner":{"account_id":8675941,"reputation":438,"user_id":6493369,"display_name":"Poorvi Nigotiya"},"score":0,"creation_date":1512633947,"post_id":47690145,"comment_id":82339546,"body_markdown":"Thanks, but this was the first thing I tried doing. Unfortunately, it did not work.","body":"Thanks, but this was the first thing I tried doing. Unfortunately, it did not work."}],"tags":[],"owner":{"account_id":216316,"reputation":8480,"user_id":471481,"accept_rate":100,"display_name":"Andrei Sfat"},"comment_count":1,"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1512642094,"creation_date":1512633261,"answer_id":47690145,"question_id":47690101,"body_markdown":"Try force refreshing your dependencies. Specifying `-U` does that\r\n\r\n    mvn clean install -U\r\n\r\nEdit:\r\nYou can purge your local release dependencies and to the normal `mvn clean install` afterwards:\r\n\r\n    mvn dependency:purge-local-repository\r\n\r\nThere is not way to force the release dependencies to be pulled, the `-U` only works with snapshot dependencies","title":"Could not transfer artifacts from/to central maven repo when using Spring Framework Cloud","body":"<p>Try force refreshing your dependencies. Specifying <code>-U</code> does that</p>\n\n<pre><code>mvn clean install -U\n</code></pre>\n\n<p>Edit:\nYou can purge your local release dependencies and to the normal <code>mvn clean install</code> afterwards:</p>\n\n<pre><code>mvn dependency:purge-local-repository\n</code></pre>\n\n<p>There is not way to force the release dependencies to be pulled, the <code>-U</code> only works with snapshot dependencies</p>\n"},{"tags":[],"owner":{"account_id":8675941,"reputation":438,"user_id":6493369,"display_name":"Poorvi Nigotiya"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1512737987,"creation_date":1512737987,"answer_id":47714937,"question_id":47690101,"body_markdown":"I tried the same pom.xml inEclipse IDE and surprisingly it worked there as it is.\r\n\r\nTo make it work on STS, I added following properties\r\n\r\n    &lt;properties&gt;\r\n    \t\t&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\r\n    \t\t&lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\r\n    \t\t&lt;java.version&gt;1.8&lt;/java.version&gt;\r\n    \t\t&lt;start-class&gt;io.pivotal.microservices.services.Main&lt;/start-class&gt;\r\n    \t\t&lt;spring-cloud.version&gt;Brixton.RELEASE&lt;/spring-cloud.version&gt;\r\n    \t&lt;/properties&gt;\r\n\r\nRefer https://stackoverflow.com/questions/45765370/unable-to-download-import-package-org-springframework-cloud-config-server-enable\r\n\r\nThis worked for me, though I am still curious about the difference.","title":"Could not transfer artifacts from/to central maven repo when using Spring Framework Cloud","body":"<p>I tried the same pom.xml inEclipse IDE and surprisingly it worked there as it is.</p>\n\n<p>To make it work on STS, I added following properties</p>\n\n<pre><code>&lt;properties&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\n        &lt;java.version&gt;1.8&lt;/java.version&gt;\n        &lt;start-class&gt;io.pivotal.microservices.services.Main&lt;/start-class&gt;\n        &lt;spring-cloud.version&gt;Brixton.RELEASE&lt;/spring-cloud.version&gt;\n    &lt;/properties&gt;\n</code></pre>\n\n<p>Refer <a href=\"https://stackoverflow.com/questions/45765370/unable-to-download-import-package-org-springframework-cloud-config-server-enable\">Unable to download/import package org.springframework.cloud.config.server.EnableConfigServer</a></p>\n\n<p>This worked for me, though I am still curious about the difference.</p>\n"},{"tags":[],"owner":{"account_id":23954992,"reputation":1,"user_id":17946007,"display_name":"Javohir Rajabov"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1651057464,"creation_date":1650980963,"answer_id":72015132,"question_id":47690101,"body_markdown":"I had the same error on my project and this is what worked for me.\r\n\r\nFirst of all, go to your `pom.xml` and find your spring-parent version. Then \r\ngo to https://repo.maven.apache.org/maven2/springframework/spring-parent and check if your same **springframework** version exists, if not change your **springframework** version to an existing one.\r\n\r\n\r\n  [1]: https://repo.maven.apache.org/maven2/springframework/spring-parent/","title":"Could not transfer artifacts from/to central maven repo when using Spring Framework Cloud","body":"<p>I had the same error on my project and this is what worked for me.</p>\n<p>First of all, go to your <code>pom.xml</code> and find your spring-parent version. Then\ngo to <a href=\"https://repo.maven.apache.org/maven2/springframework/spring-parent\" rel=\"nofollow noreferrer\">https://repo.maven.apache.org/maven2/springframework/spring-parent</a> and check if your same <strong>springframework</strong> version exists, if not change your <strong>springframework</strong> version to an existing one.</p>\n"}],"owner":{"account_id":8675941,"reputation":438,"user_id":6493369,"display_name":"Poorvi Nigotiya"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":54228,"favorite_count":0,"down_vote_count":1,"up_vote_count":5,"accepted_answer_id":47714937,"answer_count":3,"score":4,"last_activity_date":1672917305,"creation_date":1512633050,"question_id":47690101,"body_markdown":"I am trying to create a maven project using Spring Framework Cloud. \r\nI defined pom.xml file as below\r\n\r\n    &lt;parent&gt;\r\n    \t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\r\n    \t\t&lt;artifactId&gt;spring-cloud-starter-parent&lt;/artifactId&gt;\r\n    \t\t&lt;version&gt;Brixton.RELEASE&lt;/version&gt;\r\n    \t&lt;/parent&gt;\r\n    \r\n    \t&lt;properties&gt;\r\n    \t\t&lt;!-- Stand-alone RESTFul application for testing only --&gt;\r\n    \t\t&lt;start-class&gt;io.pivotal.microservices.services.Main&lt;/start-class&gt;\r\n    \t&lt;/properties&gt;\r\n    \r\n    \t&lt;dependencies&gt;\r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;!-- Setup Spring Boot --&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;!-- Setup Spring MVC &amp; REST, use Embedded Tomcat --&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;!-- Setup Spring Data common components --&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.data&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-data-commons&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;!-- Testing starter --&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;!-- Setup Spring Data JPA Repository support --&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;!-- In-memory database for testing/demos --&gt;\r\n    \t\t\t&lt;groupId&gt;org.hsqldb&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;hsqldb&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;!-- Spring Cloud starter --&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-cloud-starter&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \r\n    \t\t&lt;dependency&gt;\r\n    \t\t\t&lt;!-- Eureka service registration --&gt;\r\n    \t\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\r\n    \t\t\t&lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt;\r\n    \t\t&lt;/dependency&gt;\r\n    \t&lt;/dependencies&gt;\r\n\r\nWhen trying to build maven getting error for all dependencies as \r\n\r\nCould not transfer artifacts from/to central (https://repo.maven.apache.org/maven2) \r\n\r\n&gt; Multiple annotations found at this line:\r\n&gt; \t- Failure to transfer org.springframework:spring-orm:jar:4.2.6.RELEASE from\r\n&gt; https://repo.maven.apache.org/maven2 was cached in the local\r\n&gt; repository, resolution will not be  \t reattempted until the update\r\n&gt; interval of central has elapsed or updates are forced. Original error:\r\n&gt; Could not transfer artifact\r\n&gt; org.springframework:spring-orm:jar:4.2.6.RELEASE from/to central  \t\r\n&gt; (https://repo.maven.apache.org/maven2): The operation was cancelled.\r\n&gt; org.eclipse.aether.transfer.ArtifactTransferException: Failure to\r\n&gt; transfer org.springframework:spring-orm:jar:\r\n&gt; \t 4.2.6.RELEASE from https://repo.maven.apache.org/maven2 was cached in the local repository, resolution will not be reattempted until the\r\n&gt; update interval of central has elapsed or updates are  \t forced.\r\n&gt; Original error: Could not transfer artifact\r\n&gt; org.springframework:spring-orm:jar:4.2.6.RELEASE from/to central\r\n&gt; (https://repo.maven.apache.org/maven2): The operation was cancelled.\r\n&gt; at  \t\r\n&gt; org.eclipse.aether.internal.impl.DefaultUpdateCheckManager.newException(DefaultUpdateCheckManager.java:238)\r\n&gt; at  \t\r\n&gt; org.eclipse.aether.internal.impl.DefaultUpdateCheckManager.checkArtifact(DefaultUpdateCheckManager.java:206)\r\n&gt; at  \t\r\n&gt; org.eclipse.aether.internal.impl.DefaultArtifactResolver.gatherDownloads(DefaultArtifactResolver.java:585)\r\n&gt; at  \t\r\n&gt; org.eclipse.aether.internal.impl.DefaultArtifactResolver.performDownloads(DefaultArtifactResolver.java:503)\r\n&gt; at  \t\r\n&gt; org.eclipse.aether.internal.impl.DefaultArtifactResolver.resolve(DefaultArtifactResolver.java:421)\r\n&gt; at  \t\r\n&gt; org.eclipse.aether.internal.impl.DefaultArtifactResolver.resolveArtifacts(DefaultArtifactResolver.java:246)\r\n&gt; at  \t\r\n&gt; org.eclipse.aether.internal.impl.DefaultRepositorySystem.resolveDependencies(DefaultRepositorySystem.java:367)\r\n&gt; at\r\n\r\nWhen I go to the location, I can clearly see the Jar files are present in that location.\r\nIs there something else I need to add to my pom.xml?","title":"Could not transfer artifacts from/to central maven repo when using Spring Framework Cloud","body":"<p>I am trying to create a maven project using Spring Framework Cloud. \nI defined pom.xml file as below</p>\n\n<pre><code>&lt;parent&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;Brixton.RELEASE&lt;/version&gt;\n    &lt;/parent&gt;\n\n    &lt;properties&gt;\n        &lt;!-- Stand-alone RESTFul application for testing only --&gt;\n        &lt;start-class&gt;io.pivotal.microservices.services.Main&lt;/start-class&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;!-- Setup Spring Boot --&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;!-- Setup Spring MVC &amp; REST, use Embedded Tomcat --&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;!-- Setup Spring Data common components --&gt;\n            &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-data-commons&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;!-- Testing starter --&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;!-- Setup Spring Data JPA Repository support --&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;!-- In-memory database for testing/demos --&gt;\n            &lt;groupId&gt;org.hsqldb&lt;/groupId&gt;\n            &lt;artifactId&gt;hsqldb&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;!-- Spring Cloud starter --&gt;\n            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-cloud-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;!-- Eureka service registration --&gt;\n            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n</code></pre>\n\n<p>When trying to build maven getting error for all dependencies as </p>\n\n<p>Could not transfer artifacts from/to central (<a href=\"https://repo.maven.apache.org/maven2\" rel=\"nofollow noreferrer\">https://repo.maven.apache.org/maven2</a>) </p>\n\n<blockquote>\n  <p>Multiple annotations found at this line:\n    - Failure to transfer org.springframework:spring-orm:jar:4.2.6.RELEASE from\n  <a href=\"https://repo.maven.apache.org/maven2\" rel=\"nofollow noreferrer\">https://repo.maven.apache.org/maven2</a> was cached in the local\n  repository, resolution will not be     reattempted until the update\n  interval of central has elapsed or updates are forced. Original error:\n  Could not transfer artifact\n  org.springframework:spring-orm:jar:4.2.6.RELEASE from/to central<br>\n  (<a href=\"https://repo.maven.apache.org/maven2\" rel=\"nofollow noreferrer\">https://repo.maven.apache.org/maven2</a>): The operation was cancelled.\n  org.eclipse.aether.transfer.ArtifactTransferException: Failure to\n  transfer org.springframework:spring-orm:jar:\n     4.2.6.RELEASE from <a href=\"https://repo.maven.apache.org/maven2\" rel=\"nofollow noreferrer\">https://repo.maven.apache.org/maven2</a> was cached in the local repository, resolution will not be reattempted until the\n  update interval of central has elapsed or updates are      forced.\n  Original error: Could not transfer artifact\n  org.springframework:spring-orm:jar:4.2.6.RELEASE from/to central\n  (<a href=\"https://repo.maven.apache.org/maven2\" rel=\"nofollow noreferrer\">https://repo.maven.apache.org/maven2</a>): The operation was cancelled.\n  at<br>\n  org.eclipse.aether.internal.impl.DefaultUpdateCheckManager.newException(DefaultUpdateCheckManager.java:238)\n  at<br>\n  org.eclipse.aether.internal.impl.DefaultUpdateCheckManager.checkArtifact(DefaultUpdateCheckManager.java:206)\n  at<br>\n  org.eclipse.aether.internal.impl.DefaultArtifactResolver.gatherDownloads(DefaultArtifactResolver.java:585)\n  at<br>\n  org.eclipse.aether.internal.impl.DefaultArtifactResolver.performDownloads(DefaultArtifactResolver.java:503)\n  at<br>\n  org.eclipse.aether.internal.impl.DefaultArtifactResolver.resolve(DefaultArtifactResolver.java:421)\n  at<br>\n  org.eclipse.aether.internal.impl.DefaultArtifactResolver.resolveArtifacts(DefaultArtifactResolver.java:246)\n  at<br>\n  org.eclipse.aether.internal.impl.DefaultRepositorySystem.resolveDependencies(DefaultRepositorySystem.java:367)\n  at</p>\n</blockquote>\n\n<p>When I go to the location, I can clearly see the Jar files are present in that location.\nIs there something else I need to add to my pom.xml?</p>\n"},{"tags":["java","spring-security","microservices","spring-cloud","resilience4j"],"owner":{"account_id":9909761,"reputation":25,"user_id":7336936,"display_name":"Abhishek Singh"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":436,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":0,"score":2,"last_activity_date":1672916581,"creation_date":1672897207,"question_id":75014269,"body_markdown":"To provide some background, I am trying to implement below architecture.\r\nIt is from a course provided by &quot;DailyCodeBuffer&quot; on microservices, there are 3 services, order, product and payment. Clients can call the order service and order-service internally accesses payment and product services. Everything is registered on Eureka service registry and there is an API-Gateway via which everything should be routed.\r\n[Architecture Schema][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/CKzfH.png\r\n\r\nSo, first I created everything without the Okta Auth implementation and things were working perfectly fine. Upon calling the order-service via the gateway, I was able to get the order details by id let&#39;s say for example.\r\n\r\nThen I added the Okta auth and now every time I try to access an order details by id, **for first 2-3 times I always get the fallback method response from the gateway. And if I keep requesting back to back, it gives me result after 2-3 times**. If I try to hit the order-service directly without going via the gateway, things are working fine. Similarly, if I remove the circuit-breaker configuration for order-service from the Yaml given below, things are working fine again. **Kindly suggest the possible reasons and the solution/direction in which I should look.**\r\nPlease let me know if you want any other code/implementation from the repo. At this point, I honestly don‚Äôt know where to look for the issue.\r\n\r\nHere is my API-gateway yaml:\r\n\r\n    server:\r\n      port: 9090\r\n    \r\n    logging:\r\n      level:\r\n        web: debug\r\n    \r\n    spring:\r\n      application:\r\n        name: API-GATEWAY\r\n      config:\r\n        import: configserver:http://localhost:9296\r\n      cloud:\r\n        gateway:\r\n          routes:\r\n            - id: ORDER-SERVICE\r\n              uri: lb://ORDER-SERVICE\r\n              predicates:\r\n                - Path=/order/**\r\n              filters:\r\n                - name: CircuitBreaker\r\n                  args:\r\n                    name: ORDER-SERVICE\r\n                    fallbackuri: forward:/orderServiceFallBack\r\n                - name: RequestRateLimiter\r\n                  args:\r\n                    redis-rate-limiter.replenishRate: 1\r\n                    redis-rate-limiter.burstCapacity: 1\r\n            - id: PAYMENT-SERVICE\r\n              uri: lb://PAYMENT-SERVICE\r\n              predicates:\r\n                - Path=/payment/**\r\n              filters:\r\n                - name: CircuitBreaker\r\n                  args:\r\n                    name: PAYMENT-SERVICE\r\n                    fallbackuri: forward:/paymentServiceFallBack\r\n                - name: RequestRateLimiter\r\n                  args:\r\n                    redis-rate-limiter.replenishRate: 1\r\n                    redis-rate-limiter.burstCapacity: 1\r\n            - id: PRODUCT-SERVICE\r\n              uri: lb://PRODUCT-SERVICE\r\n              predicates:\r\n                - Path=/product/**\r\n              filters:\r\n                - name: CircuitBreaker\r\n                  args:\r\n                    name: PRODUCT-SERVICE\r\n                    fallbackuri: forward:/productServiceFallBack\r\n                - name: RequestRateLimiter\r\n                  args:\r\n                    redis-rate-limiter.replenishRate: 1\r\n                    redis-rate-limiter.burstCapacity: 1\r\n    \r\n    okta:\r\n      oauth2:\r\n        issuer: &lt;&lt;not mentioning here for security reasons&gt;&gt;\r\n        audience: api://default\r\n        client-id: &lt;&lt;not mentioning here for security reasons&gt;&gt;\r\n        client-secret: &lt;&lt;not mentioning here for security reasons&gt;&gt;\r\n        scopes: openid, profile, email, offline_access\r\n\r\nHere is my controller layer for order-service(The SOUT is printing everything correctly every time, so I am skipping service layer code here, please ask if you still want it):\r\n\r\n    @PreAuthorize(&quot;hasAuthority(&#39;Admin&#39;) || hasAuthority(&#39;Customer&#39;)&quot;)\r\n    @GetMapping(&quot;/{orderId}&quot;)\r\n    public ResponseEntity&lt;OrderResponse&gt; getOrderDetails(@PathVariable(&quot;orderId&quot;) long orderId) {\r\n        OrderResponse orderResponse = orderService.getOrderDetails(orderId);\r\n        System.out.println(&quot;orderResponse = &quot; + orderResponse);\r\n        return new ResponseEntity&lt;&gt;(orderResponse, HttpStatus.OK);\r\n    }\r\n\r\nHere is my Cloud-Gateway application class where I have setup the circuit breaker with default configs:\r\n\r\n    @SpringBootApplication\r\n    public class CloudGatewayApplication {\r\n    \r\n    \tpublic static void main(String[] args) {\r\n    \t\tSpringApplication.run(CloudGatewayApplication.class, args);\r\n    \t}\r\n    \r\n    \t@Bean\r\n    \tKeyResolver userKeySolver() {\r\n    \t\treturn exchange -&gt; Mono.just(&quot;userKey&quot;);\r\n    \t}\r\n    \r\n    \t@Bean\r\n    \tpublic Customizer&lt;Resilience4JCircuitBreakerFactory&gt; defaultCustomizer() {\r\n    \t\treturn factory -&gt; factory.configureDefault(\r\n    \t\t\t\tid -&gt; new Resilience4JConfigBuilder(id)\r\n    \t\t\t\t\t\t.circuitBreakerConfig(\r\n    \t\t\t\t\t\t\t\tCircuitBreakerConfig.ofDefaults()\r\n    \t\t\t\t\t\t).build()\r\n    \t\t);\r\n    \t}\r\n    \r\n    }\r\n\r\nFallBack controller in API-gateway:\r\n\r\n    import org.springframework.web.bind.annotation.GetMapping;\r\n    import org.springframework.web.bind.annotation.RestController;\r\n    \r\n    @RestController\r\n    public class FallbackController {\r\n    \r\n        @GetMapping(&quot;/orderServiceFallBack&quot;)\r\n        public String orderServiceFallback() {\r\n            return &quot;Order service is down!&quot;;\r\n        }\r\n    \r\n        @GetMapping(&quot;/paymentServiceFallBack&quot;)\r\n        public String paymentServiceFallback() {\r\n            return &quot;Payment service is down!&quot;;\r\n        }\r\n    \r\n        @GetMapping(&quot;/productServiceFallBack&quot;)\r\n        public String productServiceFallback() {\r\n            return &quot;Product service is down!&quot;;\r\n        }\r\n    }\r\n\r\n\r\n Order-service logs (Same logs every time):\r\n\r\n    2023-01-05 10:56:22.465 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : HTTP GET https://dev-89319517.okta.com/oauth2/default/v1/keys\r\n    2023-01-05 10:56:22.466 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Accept=[text/plain, */*]\r\n    2023-01-05 10:56:23.799 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Response 200 OK\r\n    2023-01-05 10:56:23.799 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Reading to [java.lang.String] as &quot;application/json&quot;\r\n    2023-01-05 10:56:23.860 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.servlet.DispatcherServlet        : GET &quot;/order/4&quot;, parameters={}\r\n    2023-01-05 10:56:23.872 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.dailycodebuffer.orderservice.controller.OrderController#getOrderDetails(long)\r\n    2023-01-05 10:56:23.915  INFO [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] c.d.o.service.OrderServiceImpl           : Get order details for order id: 4\r\n    2023-01-05 10:56:24.016  INFO [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] c.d.o.service.OrderServiceImpl           : Invoking product service to fetch the product for id: 2\r\n    2023-01-05 10:56:24.018 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : HTTP GET http://PRODUCT-SERVICE/product/2\r\n    2023-01-05 10:56:24.019 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Accept=[application/json, application/*+json]\r\n    2023-01-05 10:56:24.028 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,1bc48b17dcb26435] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : HTTP POST https://dev-89319517.okta.com/oauth2/default/v1/token\r\n    2023-01-05 10:56:24.028 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,1bc48b17dcb26435] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Accept=[application/json, application/*+json]\r\n    2023-01-05 10:56:24.029 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,1bc48b17dcb26435] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Writing [{grant_type=[client_credentials], scope=[internal]}] as &quot;application/x-www-form-urlencoded;charset=UTF-8&quot;\r\n    2023-01-05 10:56:24.672 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,1bc48b17dcb26435] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Response 200 OK\r\n    2023-01-05 10:56:24.672 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,1bc48b17dcb26435] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Reading to [org.springframework.security.oauth2.core.endpoint.OAuth2AccessTokenResponse] as &quot;application/json;charset=UTF-8&quot;\r\n    2023-01-05 10:56:26.132 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Response 200 OK\r\n    2023-01-05 10:56:26.132 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Reading to [com.dailycodebuffer.orderservice.external.response.ProductResponse]\r\n    2023-01-05 10:56:26.134  INFO [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] c.d.o.service.OrderServiceImpl           : Getting payment information from payment service\r\n    2023-01-05 10:56:26.134 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : HTTP GET http://PAYMENT-SERVICE/payment/order/4\r\n    2023-01-05 10:56:26.134 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Accept=[application/json, application/*+json]\r\n    2023-01-05 10:56:26.134 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : HTTP POST http://localhost:9411/api/v2/spans\r\n    2023-01-05 10:56:26.134 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Accept=[text/plain, application/json, application/*+json, */*]\r\n    2023-01-05 10:56:26.135 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Writing [[B@397bd980] as &quot;application/json&quot;\r\n    2023-01-05 10:56:26.165 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Response 202 ACCEPTED\r\n    2023-01-05 10:56:27.744 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Response 200 OK\r\n    2023-01-05 10:56:27.744 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Reading to [com.dailycodebuffer.orderservice.external.response.PaymentResponse]\r\n    orderResponse = OrderResponse(orderId=4, orderDate=2023-01-02T12:21:48.312429Z, orderStatus=PLACED, amount=2000, productDetails=OrderResponse.ProductDetails(productName=MacBook, productId=2, quantity=1, price=2000), paymentDetails=OrderResponse.PaymentDetails(paymentId=1, paymentMode=CASH, paymentStatus=SUCCESS, paymentDate=2023-01-02T12:21:48.794794Z))\r\n    2023-01-05 10:56:27.760 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using &#39;application/json&#39;, given [*/*] and supported [application/json, application/*+json, application/json, application/*+json]\r\n    2023-01-05 10:56:27.763 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [OrderResponse(orderId=4, orderDate=2023-01-02T12:21:48.312429Z, orderStatus=PLACED, amount=2000, pro (truncated)...]\r\n    2023-01-05 10:56:27.773 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK\r\n    2023-01-05 10:56:28.168 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : HTTP POST http://localhost:9411/api/v2/spans\r\n    2023-01-05 10:56:28.169 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Accept=[text/plain, application/json, application/*+json, */*]\r\n    2023-01-05 10:56:28.169 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Writing [[B@3460194e] as &quot;application/json&quot;\r\n    2023-01-05 10:56:28.176 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Response 202 ACCEPTED\r\n\r\n\r\nAPI-Gateway logs when it fails:\r\n\r\n    2023-01-05 10:58:24.485 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-1] o.s.w.s.adapter.HttpWebHandlerAdapter    : [f9b266b7-10] HTTP GET &quot;/order/4&quot;\r\n    2023-01-05 10:58:24.496 DEBUG [API-GATEWAY,e7049b94195ecf37,6cf05802f3dca2dc] 23068 --- [     parallel-1] o.s.w.s.s.DefaultWebSessionManager       : Created new WebSession.\r\n    2023-01-05 10:58:25.163 DEBUG [API-GATEWAY,,] 23068 --- [/api/v2/spans}}] o.s.w.r.f.client.ExchangeFunctions       : [34ca7d36] HTTP POST http://localhost:9411/api/v2/spans\r\n    2023-01-05 10:58:25.168 DEBUG [API-GATEWAY,60dd40f12b9da81d,070b6d8bba49f22f] 23068 --- [ctor-http-nio-4] o.s.core.codec.ByteArrayEncoder          : [34ca7d36] Writing 439 bytes\r\n    2023-01-05 10:58:25.181 DEBUG [API-GATEWAY,60dd40f12b9da81d,070b6d8bba49f22f] 23068 --- [ctor-http-nio-4] o.s.w.r.f.client.ExchangeFunctions       : [34ca7d36] [862de7b5-1, L:/127.0.0.1:59384 - R:localhost/127.0.0.1:9411] Response 202 ACCEPTED\r\n    2023-01-05 10:58:25.511 DEBUG [API-GATEWAY,b4f5aea2726ff3fb,08f2382b1d8686aa] 23068 --- [     parallel-2] s.w.r.r.m.a.RequestMappingHandlerMapping : [f9b266b7-10] Mapped to com.dailycodebuffer.cloudgateway.controller.FallbackController#orderServiceFallback()\r\n    2023-01-05 10:58:25.514 DEBUG [API-GATEWAY,b4f5aea2726ff3fb,08f2382b1d8686aa] 23068 --- [     parallel-2] o.s.w.r.r.m.a.ResponseBodyResultHandler  : [f9b266b7-10] Using &#39;text/plain;charset=UTF-8&#39; given [*/*] and supported [text/plain;charset=UTF-8, text/event-stream, text/plain;charset=UTF-8, */*]\r\n    2023-01-05 10:58:25.514 DEBUG [API-GATEWAY,b4f5aea2726ff3fb,08f2382b1d8686aa] 23068 --- [     parallel-2] o.s.w.r.r.m.a.ResponseBodyResultHandler  : [f9b266b7-10] 0..1 [java.lang.String]\r\n    2023-01-05 10:58:25.514 DEBUG [API-GATEWAY,b4f5aea2726ff3fb,08f2382b1d8686aa] 23068 --- [     parallel-2] o.s.core.codec.CharSequenceEncoder       : [f9b266b7-10] Writing &quot;Order service is down!&quot;\r\n    2023-01-05 10:58:25.516 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-1] o.s.w.s.adapter.HttpWebHandlerAdapter    : [f9b266b7-10] Completed 200 OK\r\n    2023-01-05 10:58:26.188 DEBUG [API-GATEWAY,,] 23068 --- [/api/v2/spans}}] o.s.w.r.f.client.ExchangeFunctions       : [1c1092e2] HTTP POST http://localhost:9411/api/v2/spans\r\n    2023-01-05 10:58:26.190 DEBUG [API-GATEWAY,60dd40f12b9da81d,070b6d8bba49f22f] 23068 --- [ctor-http-nio-4] o.s.core.codec.ByteArrayEncoder          : [1c1092e2] Writing 1268 bytes\r\n    2023-01-05 10:58:26.198 DEBUG [API-GATEWAY,60dd40f12b9da81d,070b6d8bba49f22f] 23068 --- [ctor-http-nio-4] o.s.w.r.f.client.ExchangeFunctions       : [1c1092e2] [862de7b5-2, L:/127.0.0.1:59384 - R:localhost/127.0.0.1:9411] Response 202 ACCEPTED\r\n\r\nAPI-Gateway logs when it returns proper results:\r\n\r\n    2023-01-05 10:59:44.857 DEBUG [API-GATEWAY,b4f5aea2726ff3fb,08f2382b1d8686aa] 23068 --- [ctor-http-nio-1] o.s.w.s.adapter.HttpWebHandlerAdapter    : [f9b266b7-12] HTTP GET &quot;/order/4&quot;\r\n    2023-01-05 10:59:44.865 DEBUG [API-GATEWAY,6e2c73066610bdd2,04c9da4375862aa5] 23068 --- [     parallel-3] o.s.w.s.s.DefaultWebSessionManager       : Created new WebSession.\r\n    2023-01-05 10:59:44.946 DEBUG [API-GATEWAY,,] 23068 --- [/api/v2/spans}}] o.s.w.r.f.client.ExchangeFunctions       : [c2145ca] HTTP POST http://localhost:9411/api/v2/spans\r\n    2023-01-05 10:59:44.947 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-2] o.s.core.codec.ByteArrayEncoder          : [c2145ca] Writing 439 bytes\r\n    2023-01-05 10:59:44.960 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-2] o.s.w.r.f.client.ExchangeFunctions       : [c2145ca] [fcfb2f85-3, L:/127.0.0.1:59436 - R:localhost/127.0.0.1:9411] Response 202 ACCEPTED\r\n    2023-01-05 10:59:45.484 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-1] o.s.w.s.adapter.HttpWebHandlerAdapter    : [f9b266b7-12] Completed 200 OK\r\n    2023-01-05 10:59:45.964 DEBUG [API-GATEWAY,,] 23068 --- [/api/v2/spans}}] o.s.w.r.f.client.ExchangeFunctions       : [143e412e] HTTP POST http://localhost:9411/api/v2/spans\r\n    2023-01-05 10:59:45.965 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-2] o.s.core.codec.ByteArrayEncoder          : [143e412e] Writing 853 bytes\r\n    2023-01-05 10:59:45.993 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-2] o.s.w.r.f.client.ExchangeFunctions       : [143e412e] [fcfb2f85-4, L:/127.0.0.1:59436 - R:localhost/127.0.0.1:9411] Response 202 ACCEPTED\r\n\r\n**Update:** I added Exception in the fallback method argument list and below in the stacktrace:\r\n\r\n    @GetMapping(&quot;/orderServiceFallBack&quot;)\r\n        public String orderServiceFallback(Exception e) {\r\n            System.out.println(&quot;e.getMessage() = &quot; + e.getMessage()); // This is printing null.\r\n            System.out.println(&quot;e.getStackTrace() = &quot; + Arrays.toString(e.getStackTrace()));\r\n            return &quot;Order service is down!&quot;;\r\n        }\r\n\r\nBelow is the stacktrace printed:\r\n     \r\n  \r\n\r\n    [java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)\r\n        java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)\r\n        java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:480)\r\n        org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:211)\r\n        org.springframework.web.reactive.result.method.annotation.ModelAttributeMethodArgumentResolver.constructAttribute(ModelAttributeMethodArgumentResolver.java:225)\r\n        org.springframework.web.reactive.result.method.annotation.ModelAttributeMethodArgumentResolver.createAttribute(ModelAttributeMethodArgumentResolver.java:217)\r\n        org.springframework.web.reactive.result.method.annotation.ModelAttributeMethodArgumentResolver.prepareAttributeMono(ModelAttributeMethodArgumentResolver.java:177)\r\n        org.springframework.web.reactive.result.method.annotation.ModelAttributeMethodArgumentResolver.resolveArgument(ModelAttributeMethodArgumentResolver.java:111)\r\n        org.springframework.web.reactive.result.method.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:119)\r\n        org.springframework.web.reactive.result.method.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:205)\r\n        org.springframework.web.reactive.result.method.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:136)\r\n        org.springframework.web.reactive.result.method.annotation.RequestMappingHandlerAdapter.lambda$handle$1(RequestMappingHandlerAdapter.java:200)\r\n        reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:44)\r\n        reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.subscribeNext(MonoIgnoreThen.java:240)\r\n        reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.onComplete(MonoIgnoreThen.java:203)\r\n        reactor.core.publisher.MonoFlatMap$FlatMapMain.onComplete(MonoFlatMap.java:181)\r\n        reactor.core.publisher.Operators.complete(Operators.java:137)\r\n        reactor.core.publisher.MonoZip.subscribe(MonoZip.java:121)\r\n        reactor.core.publisher.Mono.subscribe(Mono.java:4490)\r\n        reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.subscribeNext(MonoIgnoreThen.java:263)\r\n        reactor.core.publisher.MonoIgnoreThen.subscribe(MonoIgnoreThen.java:51)\r\n        reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:64)\r\n        reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:157)\r\n        reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:74)\r\n        reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:82)\r\n        reactor.core.publisher.FluxConcatMap$ConcatMapImmediate.innerNext(FluxConcatMap.java:282)\r\n        reactor.core.publisher.FluxConcatMap$ConcatMapInner.onNext(FluxConcatMap.java:863)\r\n        reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber.onNext(FluxMapFuseable.java:129)\r\n        reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.onNext(MonoPeekTerminal.java:180)\r\n        reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2400)\r\n        reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.request(MonoPeekTerminal.java:139)\r\n        reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber.request(FluxMapFuseable.java:171)\r\n        reactor.core.publisher.Operators$MultiSubscriptionSubscriber.set(Operators.java:2196)\r\n        reactor.core.publisher.Operators$MultiSubscriptionSubscriber.onSubscribe(Operators.java:2070)\r\n        reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber.onSubscribe(FluxMapFuseable.java:96)\r\n        reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.onSubscribe(MonoPeekTerminal.java:152)\r\n        reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)\r\n        reactor.core.publisher.Mono.subscribe(Mono.java:4490)\r\n        reactor.core.publisher.FluxConcatMap$ConcatMapImmediate.drain(FluxConcatMap.java:451)\r\n        reactor.core.publisher.FluxConcatMap$ConcatMapImmediate.onSubscribe(FluxConcatMap.java:219)\r\n        reactor.core.publisher.FluxIterable.subscribe(FluxIterable.java:201)\r\n        reactor.core.publisher.FluxIterable.subscribe(FluxIterable.java:83)\r\n        reactor.core.publisher.Mono.subscribe(Mono.java:4490)\r\n        reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onError(FluxOnErrorResume.java:103)\r\n        reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.onError(MonoPeekTerminal.java:258)\r\n        reactor.core.publisher.SerializedSubscriber.onError(SerializedSubscriber.java:124)\r\n        reactor.core.publisher.SerializedSubscriber.onError(SerializedSubscriber.java:124)\r\n        reactor.core.publisher.FluxTimeout$TimeoutMainSubscriber.handleTimeout(FluxTimeout.java:295)\r\n        reactor.core.publisher.FluxTimeout$TimeoutMainSubscriber.doTimeout(FluxTimeout.java:280)\r\n        reactor.core.publisher.FluxTimeout$TimeoutTimeoutSubscriber.onNext(FluxTimeout.java:419)\r\n        reactor.core.publisher.FluxOnErrorReturn$ReturnSubscriber.onNext(FluxOnErrorReturn.java:162)\r\n        reactor.core.publisher.MonoDelay$MonoDelayRunnable.propagateDelay(MonoDelay.java:271)\r\n        reactor.core.publisher.MonoDelay$MonoDelayRunnable.run(MonoDelay.java:286)\r\n        reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)\r\n        reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)\r\n        java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n        java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)\r\n        java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\r\n        java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n        java.base/java.lang.Thread.run(Thread.java:833)]\r\n\r\n\r\n**Update2:** I enabled the circuitbreakers&#39; status in the actuator and checked before and after hitting the API. the failedCalls numbers are going up. But why? Because in my controller, the SOUT is printing everything perfectly fine.\r\n\r\nThis is what I am getting in the /actuator/health endpoint:\r\n\r\n    {\r\n    &quot;status&quot;: &quot;UP&quot;,\r\n    &quot;components&quot;: {\r\n        &quot;circuitBreakers&quot;: {\r\n            &quot;status&quot;: &quot;UP&quot;,\r\n            &quot;details&quot;: {\r\n                &quot;PAYMENT-SERVICE&quot;: {\r\n                    &quot;status&quot;: &quot;UP&quot;,\r\n                    &quot;details&quot;: {\r\n                        &quot;failureRate&quot;: &quot;-1.0%&quot;,\r\n                        &quot;failureRateThreshold&quot;: &quot;50.0%&quot;,\r\n                        &quot;slowCallRate&quot;: &quot;-1.0%&quot;,\r\n                        &quot;slowCallRateThreshold&quot;: &quot;100.0%&quot;,\r\n                        &quot;bufferedCalls&quot;: 0,\r\n                        &quot;slowCalls&quot;: 0,\r\n                        &quot;slowFailedCalls&quot;: 0,\r\n                        &quot;failedCalls&quot;: 0,\r\n                        &quot;notPermittedCalls&quot;: 0,\r\n                        &quot;state&quot;: &quot;CLOSED&quot;\r\n                    }\r\n                },\r\n                &quot;ORDER-SERVICE&quot;: {\r\n                    &quot;status&quot;: &quot;UP&quot;,\r\n                    &quot;details&quot;: {\r\n                        &quot;failureRate&quot;: &quot;-1.0%&quot;,\r\n                        &quot;failureRateThreshold&quot;: &quot;50.0%&quot;,\r\n                        &quot;slowCallRate&quot;: &quot;-1.0%&quot;,\r\n                        &quot;slowCallRateThreshold&quot;: &quot;100.0%&quot;,\r\n                        &quot;bufferedCalls&quot;: 1,\r\n                        &quot;slowCalls&quot;: 0,\r\n                        &quot;slowFailedCalls&quot;: 0,\r\n                        &quot;failedCalls&quot;: 1,\r\n                        &quot;notPermittedCalls&quot;: 0,\r\n                        &quot;state&quot;: &quot;CLOSED&quot;\r\n                    }\r\n                },\r\n                &quot;PRODUCT-SERVICE&quot;: {\r\n                    &quot;status&quot;: &quot;UP&quot;,\r\n                    &quot;details&quot;: {\r\n                        &quot;failureRate&quot;: &quot;-1.0%&quot;,\r\n                        &quot;failureRateThreshold&quot;: &quot;50.0%&quot;,\r\n                        &quot;slowCallRate&quot;: &quot;-1.0%&quot;,\r\n                        &quot;slowCallRateThreshold&quot;: &quot;100.0%&quot;,\r\n                        &quot;bufferedCalls&quot;: 0,\r\n                        &quot;slowCalls&quot;: 0,\r\n                        &quot;slowFailedCalls&quot;: 0,\r\n                        &quot;failedCalls&quot;: 0,\r\n                        &quot;notPermittedCalls&quot;: 0,\r\n                        &quot;state&quot;: &quot;CLOSED&quot;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }","title":"Spring API-gateway | Resilience4j randomly invoking fallback method even if the service is returning proper response","body":"<p>To provide some background, I am trying to implement below architecture.\nIt is from a course provided by &quot;DailyCodeBuffer&quot; on microservices, there are 3 services, order, product and payment. Clients can call the order service and order-service internally accesses payment and product services. Everything is registered on Eureka service registry and there is an API-Gateway via which everything should be routed.\n<a href=\"https://i.stack.imgur.com/CKzfH.png\" rel=\"nofollow noreferrer\">Architecture Schema</a></p>\n<p>So, first I created everything without the Okta Auth implementation and things were working perfectly fine. Upon calling the order-service via the gateway, I was able to get the order details by id let's say for example.</p>\n<p>Then I added the Okta auth and now every time I try to access an order details by id, <strong>for first 2-3 times I always get the fallback method response from the gateway. And if I keep requesting back to back, it gives me result after 2-3 times</strong>. If I try to hit the order-service directly without going via the gateway, things are working fine. Similarly, if I remove the circuit-breaker configuration for order-service from the Yaml given below, things are working fine again. <strong>Kindly suggest the possible reasons and the solution/direction in which I should look.</strong>\nPlease let me know if you want any other code/implementation from the repo. At this point, I honestly don‚Äôt know where to look for the issue.</p>\n<p>Here is my API-gateway yaml:</p>\n<pre><code>server:\n  port: 9090\n\nlogging:\n  level:\n    web: debug\n\nspring:\n  application:\n    name: API-GATEWAY\n  config:\n    import: configserver:http://localhost:9296\n  cloud:\n    gateway:\n      routes:\n        - id: ORDER-SERVICE\n          uri: lb://ORDER-SERVICE\n          predicates:\n            - Path=/order/**\n          filters:\n            - name: CircuitBreaker\n              args:\n                name: ORDER-SERVICE\n                fallbackuri: forward:/orderServiceFallBack\n            - name: RequestRateLimiter\n              args:\n                redis-rate-limiter.replenishRate: 1\n                redis-rate-limiter.burstCapacity: 1\n        - id: PAYMENT-SERVICE\n          uri: lb://PAYMENT-SERVICE\n          predicates:\n            - Path=/payment/**\n          filters:\n            - name: CircuitBreaker\n              args:\n                name: PAYMENT-SERVICE\n                fallbackuri: forward:/paymentServiceFallBack\n            - name: RequestRateLimiter\n              args:\n                redis-rate-limiter.replenishRate: 1\n                redis-rate-limiter.burstCapacity: 1\n        - id: PRODUCT-SERVICE\n          uri: lb://PRODUCT-SERVICE\n          predicates:\n            - Path=/product/**\n          filters:\n            - name: CircuitBreaker\n              args:\n                name: PRODUCT-SERVICE\n                fallbackuri: forward:/productServiceFallBack\n            - name: RequestRateLimiter\n              args:\n                redis-rate-limiter.replenishRate: 1\n                redis-rate-limiter.burstCapacity: 1\n\nokta:\n  oauth2:\n    issuer: &lt;&lt;not mentioning here for security reasons&gt;&gt;\n    audience: api://default\n    client-id: &lt;&lt;not mentioning here for security reasons&gt;&gt;\n    client-secret: &lt;&lt;not mentioning here for security reasons&gt;&gt;\n    scopes: openid, profile, email, offline_access\n</code></pre>\n<p>Here is my controller layer for order-service(The SOUT is printing everything correctly every time, so I am skipping service layer code here, please ask if you still want it):</p>\n<pre><code>@PreAuthorize(&quot;hasAuthority('Admin') || hasAuthority('Customer')&quot;)\n@GetMapping(&quot;/{orderId}&quot;)\npublic ResponseEntity&lt;OrderResponse&gt; getOrderDetails(@PathVariable(&quot;orderId&quot;) long orderId) {\n    OrderResponse orderResponse = orderService.getOrderDetails(orderId);\n    System.out.println(&quot;orderResponse = &quot; + orderResponse);\n    return new ResponseEntity&lt;&gt;(orderResponse, HttpStatus.OK);\n}\n</code></pre>\n<p>Here is my Cloud-Gateway application class where I have setup the circuit breaker with default configs:</p>\n<pre><code>@SpringBootApplication\npublic class CloudGatewayApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(CloudGatewayApplication.class, args);\n    }\n\n    @Bean\n    KeyResolver userKeySolver() {\n        return exchange -&gt; Mono.just(&quot;userKey&quot;);\n    }\n\n    @Bean\n    public Customizer&lt;Resilience4JCircuitBreakerFactory&gt; defaultCustomizer() {\n        return factory -&gt; factory.configureDefault(\n                id -&gt; new Resilience4JConfigBuilder(id)\n                        .circuitBreakerConfig(\n                                CircuitBreakerConfig.ofDefaults()\n                        ).build()\n        );\n    }\n\n}\n</code></pre>\n<p>FallBack controller in API-gateway:</p>\n<pre><code>import org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\npublic class FallbackController {\n\n    @GetMapping(&quot;/orderServiceFallBack&quot;)\n    public String orderServiceFallback() {\n        return &quot;Order service is down!&quot;;\n    }\n\n    @GetMapping(&quot;/paymentServiceFallBack&quot;)\n    public String paymentServiceFallback() {\n        return &quot;Payment service is down!&quot;;\n    }\n\n    @GetMapping(&quot;/productServiceFallBack&quot;)\n    public String productServiceFallback() {\n        return &quot;Product service is down!&quot;;\n    }\n}\n</code></pre>\n<p>Order-service logs (Same logs every time):</p>\n<pre><code>2023-01-05 10:56:22.465 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : HTTP GET https://dev-89319517.okta.com/oauth2/default/v1/keys\n2023-01-05 10:56:22.466 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Accept=[text/plain, */*]\n2023-01-05 10:56:23.799 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Response 200 OK\n2023-01-05 10:56:23.799 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Reading to [java.lang.String] as &quot;application/json&quot;\n2023-01-05 10:56:23.860 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.servlet.DispatcherServlet        : GET &quot;/order/4&quot;, parameters={}\n2023-01-05 10:56:23.872 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.dailycodebuffer.orderservice.controller.OrderController#getOrderDetails(long)\n2023-01-05 10:56:23.915  INFO [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] c.d.o.service.OrderServiceImpl           : Get order details for order id: 4\n2023-01-05 10:56:24.016  INFO [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] c.d.o.service.OrderServiceImpl           : Invoking product service to fetch the product for id: 2\n2023-01-05 10:56:24.018 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : HTTP GET http://PRODUCT-SERVICE/product/2\n2023-01-05 10:56:24.019 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Accept=[application/json, application/*+json]\n2023-01-05 10:56:24.028 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,1bc48b17dcb26435] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : HTTP POST https://dev-89319517.okta.com/oauth2/default/v1/token\n2023-01-05 10:56:24.028 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,1bc48b17dcb26435] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Accept=[application/json, application/*+json]\n2023-01-05 10:56:24.029 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,1bc48b17dcb26435] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Writing [{grant_type=[client_credentials], scope=[internal]}] as &quot;application/x-www-form-urlencoded;charset=UTF-8&quot;\n2023-01-05 10:56:24.672 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,1bc48b17dcb26435] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Response 200 OK\n2023-01-05 10:56:24.672 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,1bc48b17dcb26435] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Reading to [org.springframework.security.oauth2.core.endpoint.OAuth2AccessTokenResponse] as &quot;application/json;charset=UTF-8&quot;\n2023-01-05 10:56:26.132 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Response 200 OK\n2023-01-05 10:56:26.132 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Reading to [com.dailycodebuffer.orderservice.external.response.ProductResponse]\n2023-01-05 10:56:26.134  INFO [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] c.d.o.service.OrderServiceImpl           : Getting payment information from payment service\n2023-01-05 10:56:26.134 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : HTTP GET http://PAYMENT-SERVICE/payment/order/4\n2023-01-05 10:56:26.134 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Accept=[application/json, application/*+json]\n2023-01-05 10:56:26.134 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : HTTP POST http://localhost:9411/api/v2/spans\n2023-01-05 10:56:26.134 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Accept=[text/plain, application/json, application/*+json, */*]\n2023-01-05 10:56:26.135 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Writing [[B@397bd980] as &quot;application/json&quot;\n2023-01-05 10:56:26.165 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Response 202 ACCEPTED\n2023-01-05 10:56:27.744 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Response 200 OK\n2023-01-05 10:56:27.744 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.client.RestTemplate              : Reading to [com.dailycodebuffer.orderservice.external.response.PaymentResponse]\norderResponse = OrderResponse(orderId=4, orderDate=2023-01-02T12:21:48.312429Z, orderStatus=PLACED, amount=2000, productDetails=OrderResponse.ProductDetails(productName=MacBook, productId=2, quantity=1, price=2000), paymentDetails=OrderResponse.PaymentDetails(paymentId=1, paymentMode=CASH, paymentStatus=SUCCESS, paymentDate=2023-01-02T12:21:48.794794Z))\n2023-01-05 10:56:27.760 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json, application/json, application/*+json]\n2023-01-05 10:56:27.763 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [OrderResponse(orderId=4, orderDate=2023-01-02T12:21:48.312429Z, orderStatus=PLACED, amount=2000, pro (truncated)...]\n2023-01-05 10:56:27.773 DEBUG [ORDER-SERVICE,03f7ef4ad8f0e497,4a4d18fceb3bada1] 14072 --- [nio-8082-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK\n2023-01-05 10:56:28.168 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : HTTP POST http://localhost:9411/api/v2/spans\n2023-01-05 10:56:28.169 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Accept=[text/plain, application/json, application/*+json, */*]\n2023-01-05 10:56:28.169 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Writing [[B@3460194e] as &quot;application/json&quot;\n2023-01-05 10:56:28.176 DEBUG [ORDER-SERVICE,,] 14072 --- [/api/v2/spans}}] org.springframework.web.HttpLogging      : Response 202 ACCEPTED\n</code></pre>\n<p>API-Gateway logs when it fails:</p>\n<pre><code>2023-01-05 10:58:24.485 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-1] o.s.w.s.adapter.HttpWebHandlerAdapter    : [f9b266b7-10] HTTP GET &quot;/order/4&quot;\n2023-01-05 10:58:24.496 DEBUG [API-GATEWAY,e7049b94195ecf37,6cf05802f3dca2dc] 23068 --- [     parallel-1] o.s.w.s.s.DefaultWebSessionManager       : Created new WebSession.\n2023-01-05 10:58:25.163 DEBUG [API-GATEWAY,,] 23068 --- [/api/v2/spans}}] o.s.w.r.f.client.ExchangeFunctions       : [34ca7d36] HTTP POST http://localhost:9411/api/v2/spans\n2023-01-05 10:58:25.168 DEBUG [API-GATEWAY,60dd40f12b9da81d,070b6d8bba49f22f] 23068 --- [ctor-http-nio-4] o.s.core.codec.ByteArrayEncoder          : [34ca7d36] Writing 439 bytes\n2023-01-05 10:58:25.181 DEBUG [API-GATEWAY,60dd40f12b9da81d,070b6d8bba49f22f] 23068 --- [ctor-http-nio-4] o.s.w.r.f.client.ExchangeFunctions       : [34ca7d36] [862de7b5-1, L:/127.0.0.1:59384 - R:localhost/127.0.0.1:9411] Response 202 ACCEPTED\n2023-01-05 10:58:25.511 DEBUG [API-GATEWAY,b4f5aea2726ff3fb,08f2382b1d8686aa] 23068 --- [     parallel-2] s.w.r.r.m.a.RequestMappingHandlerMapping : [f9b266b7-10] Mapped to com.dailycodebuffer.cloudgateway.controller.FallbackController#orderServiceFallback()\n2023-01-05 10:58:25.514 DEBUG [API-GATEWAY,b4f5aea2726ff3fb,08f2382b1d8686aa] 23068 --- [     parallel-2] o.s.w.r.r.m.a.ResponseBodyResultHandler  : [f9b266b7-10] Using 'text/plain;charset=UTF-8' given [*/*] and supported [text/plain;charset=UTF-8, text/event-stream, text/plain;charset=UTF-8, */*]\n2023-01-05 10:58:25.514 DEBUG [API-GATEWAY,b4f5aea2726ff3fb,08f2382b1d8686aa] 23068 --- [     parallel-2] o.s.w.r.r.m.a.ResponseBodyResultHandler  : [f9b266b7-10] 0..1 [java.lang.String]\n2023-01-05 10:58:25.514 DEBUG [API-GATEWAY,b4f5aea2726ff3fb,08f2382b1d8686aa] 23068 --- [     parallel-2] o.s.core.codec.CharSequenceEncoder       : [f9b266b7-10] Writing &quot;Order service is down!&quot;\n2023-01-05 10:58:25.516 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-1] o.s.w.s.adapter.HttpWebHandlerAdapter    : [f9b266b7-10] Completed 200 OK\n2023-01-05 10:58:26.188 DEBUG [API-GATEWAY,,] 23068 --- [/api/v2/spans}}] o.s.w.r.f.client.ExchangeFunctions       : [1c1092e2] HTTP POST http://localhost:9411/api/v2/spans\n2023-01-05 10:58:26.190 DEBUG [API-GATEWAY,60dd40f12b9da81d,070b6d8bba49f22f] 23068 --- [ctor-http-nio-4] o.s.core.codec.ByteArrayEncoder          : [1c1092e2] Writing 1268 bytes\n2023-01-05 10:58:26.198 DEBUG [API-GATEWAY,60dd40f12b9da81d,070b6d8bba49f22f] 23068 --- [ctor-http-nio-4] o.s.w.r.f.client.ExchangeFunctions       : [1c1092e2] [862de7b5-2, L:/127.0.0.1:59384 - R:localhost/127.0.0.1:9411] Response 202 ACCEPTED\n</code></pre>\n<p>API-Gateway logs when it returns proper results:</p>\n<pre><code>2023-01-05 10:59:44.857 DEBUG [API-GATEWAY,b4f5aea2726ff3fb,08f2382b1d8686aa] 23068 --- [ctor-http-nio-1] o.s.w.s.adapter.HttpWebHandlerAdapter    : [f9b266b7-12] HTTP GET &quot;/order/4&quot;\n2023-01-05 10:59:44.865 DEBUG [API-GATEWAY,6e2c73066610bdd2,04c9da4375862aa5] 23068 --- [     parallel-3] o.s.w.s.s.DefaultWebSessionManager       : Created new WebSession.\n2023-01-05 10:59:44.946 DEBUG [API-GATEWAY,,] 23068 --- [/api/v2/spans}}] o.s.w.r.f.client.ExchangeFunctions       : [c2145ca] HTTP POST http://localhost:9411/api/v2/spans\n2023-01-05 10:59:44.947 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-2] o.s.core.codec.ByteArrayEncoder          : [c2145ca] Writing 439 bytes\n2023-01-05 10:59:44.960 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-2] o.s.w.r.f.client.ExchangeFunctions       : [c2145ca] [fcfb2f85-3, L:/127.0.0.1:59436 - R:localhost/127.0.0.1:9411] Response 202 ACCEPTED\n2023-01-05 10:59:45.484 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-1] o.s.w.s.adapter.HttpWebHandlerAdapter    : [f9b266b7-12] Completed 200 OK\n2023-01-05 10:59:45.964 DEBUG [API-GATEWAY,,] 23068 --- [/api/v2/spans}}] o.s.w.r.f.client.ExchangeFunctions       : [143e412e] HTTP POST http://localhost:9411/api/v2/spans\n2023-01-05 10:59:45.965 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-2] o.s.core.codec.ByteArrayEncoder          : [143e412e] Writing 853 bytes\n2023-01-05 10:59:45.993 DEBUG [API-GATEWAY,,] 23068 --- [ctor-http-nio-2] o.s.w.r.f.client.ExchangeFunctions       : [143e412e] [fcfb2f85-4, L:/127.0.0.1:59436 - R:localhost/127.0.0.1:9411] Response 202 ACCEPTED\n</code></pre>\n<p><strong>Update:</strong> I added Exception in the fallback method argument list and below in the stacktrace:</p>\n<pre><code>@GetMapping(&quot;/orderServiceFallBack&quot;)\n    public String orderServiceFallback(Exception e) {\n        System.out.println(&quot;e.getMessage() = &quot; + e.getMessage()); // This is printing null.\n        System.out.println(&quot;e.getStackTrace() = &quot; + Arrays.toString(e.getStackTrace()));\n        return &quot;Order service is down!&quot;;\n    }\n</code></pre>\n<p>Below is the stacktrace printed:</p>\n<pre><code>[java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)\n    java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n    java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)\n    java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:480)\n    org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:211)\n    org.springframework.web.reactive.result.method.annotation.ModelAttributeMethodArgumentResolver.constructAttribute(ModelAttributeMethodArgumentResolver.java:225)\n    org.springframework.web.reactive.result.method.annotation.ModelAttributeMethodArgumentResolver.createAttribute(ModelAttributeMethodArgumentResolver.java:217)\n    org.springframework.web.reactive.result.method.annotation.ModelAttributeMethodArgumentResolver.prepareAttributeMono(ModelAttributeMethodArgumentResolver.java:177)\n    org.springframework.web.reactive.result.method.annotation.ModelAttributeMethodArgumentResolver.resolveArgument(ModelAttributeMethodArgumentResolver.java:111)\n    org.springframework.web.reactive.result.method.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:119)\n    org.springframework.web.reactive.result.method.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:205)\n    org.springframework.web.reactive.result.method.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:136)\n    org.springframework.web.reactive.result.method.annotation.RequestMappingHandlerAdapter.lambda$handle$1(RequestMappingHandlerAdapter.java:200)\n    reactor.core.publisher.MonoDefer.subscribe(MonoDefer.java:44)\n    reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.subscribeNext(MonoIgnoreThen.java:240)\n    reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.onComplete(MonoIgnoreThen.java:203)\n    reactor.core.publisher.MonoFlatMap$FlatMapMain.onComplete(MonoFlatMap.java:181)\n    reactor.core.publisher.Operators.complete(Operators.java:137)\n    reactor.core.publisher.MonoZip.subscribe(MonoZip.java:121)\n    reactor.core.publisher.Mono.subscribe(Mono.java:4490)\n    reactor.core.publisher.MonoIgnoreThen$ThenIgnoreMain.subscribeNext(MonoIgnoreThen.java:263)\n    reactor.core.publisher.MonoIgnoreThen.subscribe(MonoIgnoreThen.java:51)\n    reactor.core.publisher.InternalMonoOperator.subscribe(InternalMonoOperator.java:64)\n    reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:157)\n    reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:74)\n    reactor.core.publisher.MonoNext$NextSubscriber.onNext(MonoNext.java:82)\n    reactor.core.publisher.FluxConcatMap$ConcatMapImmediate.innerNext(FluxConcatMap.java:282)\n    reactor.core.publisher.FluxConcatMap$ConcatMapInner.onNext(FluxConcatMap.java:863)\n    reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber.onNext(FluxMapFuseable.java:129)\n    reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.onNext(MonoPeekTerminal.java:180)\n    reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2400)\n    reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.request(MonoPeekTerminal.java:139)\n    reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber.request(FluxMapFuseable.java:171)\n    reactor.core.publisher.Operators$MultiSubscriptionSubscriber.set(Operators.java:2196)\n    reactor.core.publisher.Operators$MultiSubscriptionSubscriber.onSubscribe(Operators.java:2070)\n    reactor.core.publisher.FluxMapFuseable$MapFuseableSubscriber.onSubscribe(FluxMapFuseable.java:96)\n    reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.onSubscribe(MonoPeekTerminal.java:152)\n    reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)\n    reactor.core.publisher.Mono.subscribe(Mono.java:4490)\n    reactor.core.publisher.FluxConcatMap$ConcatMapImmediate.drain(FluxConcatMap.java:451)\n    reactor.core.publisher.FluxConcatMap$ConcatMapImmediate.onSubscribe(FluxConcatMap.java:219)\n    reactor.core.publisher.FluxIterable.subscribe(FluxIterable.java:201)\n    reactor.core.publisher.FluxIterable.subscribe(FluxIterable.java:83)\n    reactor.core.publisher.Mono.subscribe(Mono.java:4490)\n    reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onError(FluxOnErrorResume.java:103)\n    reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.onError(MonoPeekTerminal.java:258)\n    reactor.core.publisher.SerializedSubscriber.onError(SerializedSubscriber.java:124)\n    reactor.core.publisher.SerializedSubscriber.onError(SerializedSubscriber.java:124)\n    reactor.core.publisher.FluxTimeout$TimeoutMainSubscriber.handleTimeout(FluxTimeout.java:295)\n    reactor.core.publisher.FluxTimeout$TimeoutMainSubscriber.doTimeout(FluxTimeout.java:280)\n    reactor.core.publisher.FluxTimeout$TimeoutTimeoutSubscriber.onNext(FluxTimeout.java:419)\n    reactor.core.publisher.FluxOnErrorReturn$ReturnSubscriber.onNext(FluxOnErrorReturn.java:162)\n    reactor.core.publisher.MonoDelay$MonoDelayRunnable.propagateDelay(MonoDelay.java:271)\n    reactor.core.publisher.MonoDelay$MonoDelayRunnable.run(MonoDelay.java:286)\n    reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:68)\n    reactor.core.scheduler.SchedulerTask.call(SchedulerTask.java:28)\n    java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n    java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)\n    java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n    java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n    java.base/java.lang.Thread.run(Thread.java:833)]\n</code></pre>\n<p><strong>Update2:</strong> I enabled the circuitbreakers' status in the actuator and checked before and after hitting the API. the failedCalls numbers are going up. But why? Because in my controller, the SOUT is printing everything perfectly fine.</p>\n<p>This is what I am getting in the /actuator/health endpoint:</p>\n<pre><code>{\n&quot;status&quot;: &quot;UP&quot;,\n&quot;components&quot;: {\n    &quot;circuitBreakers&quot;: {\n        &quot;status&quot;: &quot;UP&quot;,\n        &quot;details&quot;: {\n            &quot;PAYMENT-SERVICE&quot;: {\n                &quot;status&quot;: &quot;UP&quot;,\n                &quot;details&quot;: {\n                    &quot;failureRate&quot;: &quot;-1.0%&quot;,\n                    &quot;failureRateThreshold&quot;: &quot;50.0%&quot;,\n                    &quot;slowCallRate&quot;: &quot;-1.0%&quot;,\n                    &quot;slowCallRateThreshold&quot;: &quot;100.0%&quot;,\n                    &quot;bufferedCalls&quot;: 0,\n                    &quot;slowCalls&quot;: 0,\n                    &quot;slowFailedCalls&quot;: 0,\n                    &quot;failedCalls&quot;: 0,\n                    &quot;notPermittedCalls&quot;: 0,\n                    &quot;state&quot;: &quot;CLOSED&quot;\n                }\n            },\n            &quot;ORDER-SERVICE&quot;: {\n                &quot;status&quot;: &quot;UP&quot;,\n                &quot;details&quot;: {\n                    &quot;failureRate&quot;: &quot;-1.0%&quot;,\n                    &quot;failureRateThreshold&quot;: &quot;50.0%&quot;,\n                    &quot;slowCallRate&quot;: &quot;-1.0%&quot;,\n                    &quot;slowCallRateThreshold&quot;: &quot;100.0%&quot;,\n                    &quot;bufferedCalls&quot;: 1,\n                    &quot;slowCalls&quot;: 0,\n                    &quot;slowFailedCalls&quot;: 0,\n                    &quot;failedCalls&quot;: 1,\n                    &quot;notPermittedCalls&quot;: 0,\n                    &quot;state&quot;: &quot;CLOSED&quot;\n                }\n            },\n            &quot;PRODUCT-SERVICE&quot;: {\n                &quot;status&quot;: &quot;UP&quot;,\n                &quot;details&quot;: {\n                    &quot;failureRate&quot;: &quot;-1.0%&quot;,\n                    &quot;failureRateThreshold&quot;: &quot;50.0%&quot;,\n                    &quot;slowCallRate&quot;: &quot;-1.0%&quot;,\n                    &quot;slowCallRateThreshold&quot;: &quot;100.0%&quot;,\n                    &quot;bufferedCalls&quot;: 0,\n                    &quot;slowCalls&quot;: 0,\n                    &quot;slowFailedCalls&quot;: 0,\n                    &quot;failedCalls&quot;: 0,\n                    &quot;notPermittedCalls&quot;: 0,\n                    &quot;state&quot;: &quot;CLOSED&quot;\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["java","elasticsearch","spring-data-elasticsearch","testcontainers","testcontainers-junit5"],"answers":[{"comments":[{"owner":{"account_id":3463037,"reputation":2280,"user_id":2899485,"accept_rate":42,"display_name":"A_G"},"score":0,"creation_date":1642702445,"post_id":70786515,"comment_id":125148268,"body_markdown":"Its dramatically high for me : 22/01/20 10:12:38 INFO &#128051; [docker.elastic.co/elasticsearch/elasticsearch:7.11.2]: Container docker.elastic.co/elasticsearch/elasticsearch:7.11.2 started in PT50.984S","body":"Its dramatically high for me : 22/01/20 10:12:38 INFO üê≥ [docker.elastic.co/elasticsearch/elasticsearch:7.11.2]: Container docker.elastic.co/elasticsearch/elasticsearch:7.11.2 started in PT50.984S"},{"owner":{"account_id":5534873,"reputation":18496,"user_id":4393565,"accept_rate":67,"display_name":"P.J.Meisch"},"score":1,"creation_date":1642713155,"post_id":70786515,"comment_id":125152264,"body_markdown":"for me starting a Elasticsearch  7.16.3 testcontainer takes a little over 20 seconds. But I use only one for all of my integration tests, I think that&#39;s the crucial point.","body":"for me starting a Elasticsearch  7.16.3 testcontainer takes a little over 20 seconds. But I use only one for all of my integration tests, I think that&#39;s the crucial point."},{"owner":{"account_id":1093963,"reputation":3605,"user_id":1087978,"display_name":"Oleg ≈†elajev"},"score":0,"creation_date":1642719696,"post_id":70786515,"comment_id":125154099,"body_markdown":"@AsthaGupta, can you please check how much resources Docker has access to? And does the container start faster if you give more memory/CPU?","body":"@AsthaGupta, can you please check how much resources Docker has access to? And does the container start faster if you give more memory/CPU?"},{"owner":{"account_id":3463037,"reputation":2280,"user_id":2899485,"accept_rate":42,"display_name":"A_G"},"score":2,"creation_date":1642725136,"post_id":70786515,"comment_id":125155083,"body_markdown":"This is perfect. I doubled the memory from 2Gb to 4 and increased the CPU from 8 to 10 and the same tests finished in less than a minute which were earlier taking 30 mins. Thanks again for all the helpful links!","body":"This is perfect. I doubled the memory from 2Gb to 4 and increased the CPU from 8 to 10 and the same tests finished in less than a minute which were earlier taking 30 mins. Thanks again for all the helpful links!"},{"owner":{"account_id":2763938,"reputation":194,"user_id":2380213,"display_name":"serkan_ozal"},"score":0,"creation_date":1642770892,"post_id":70786515,"comment_id":125166809,"body_markdown":"Hi, (Disclaimer: Co-Founder&amp;CTO @ Thundra) You can also use Thundra Foresight to trace, debug and detect performance bottlenecks in your tests: https://www.thundra.io/foresight","body":"Hi, (Disclaimer: Co-Founder&amp;CTO @ Thundra) You can also use Thundra Foresight to trace, debug and detect performance bottlenecks in your tests: <a href=\"https://www.thundra.io/foresight\" rel=\"nofollow noreferrer\">thundra.io/foresight</a>"},{"owner":{"account_id":2763938,"reputation":194,"user_id":2380213,"display_name":"serkan_ozal"},"score":0,"creation_date":1642771027,"post_id":70786515,"comment_id":125166871,"body_markdown":"We (https://www.thundra.io/foresight) also have integration with Testcontainers so you can also trace and debug Testcontainers operations with Thundra Foresight (https://foresight.docs.thundra.io/) for detecting the points to be optimized","body":"We (<a href=\"https://www.thundra.io/foresight\" rel=\"nofollow noreferrer\">thundra.io/foresight</a>) also have integration with Testcontainers so you can also trace and debug Testcontainers operations with Thundra Foresight (<a href=\"https://foresight.docs.thundra.io/\" rel=\"nofollow noreferrer\">foresight.docs.thundra.io</a>) for detecting the points to be optimized"},{"owner":{"account_id":210082,"reputation":19409,"user_id":461499,"accept_rate":73,"display_name":"Rob Audenaerde"},"score":0,"creation_date":1672916429,"post_id":70786515,"comment_id":132382718,"body_markdown":"Elasticsearch 8 is even slower :(","body":"Elasticsearch 8 is even slower :("}],"tags":[],"owner":{"account_id":1093963,"reputation":3605,"user_id":1087978,"display_name":"Oleg ≈†elajev"},"comment_count":7,"down_vote_count":0,"up_vote_count":5,"is_accepted":true,"score":5,"last_activity_date":1642769225,"creation_date":1642682793,"answer_id":70786515,"question_id":70778593,"body_markdown":"General advice for any performance work or optimizations is to measure before introducing changes. I&#39;d recommend profiling your test runs before you draw conclusions. \r\n\r\nThere are a few metrics there that you can estimate without extensive use of profilers. \r\n* How long does the Elastic container start? \r\n\r\nFor me it takes 8.2 seconds (I used `elasticsearch-oss:7.10.2`): \r\n```\r\n14:35:55.803 [main] INFO  &#128051; [docker.elastic.co/elasticsearch/elasticsearch-oss:7.10.2] -\r\n Container docker.elastic.co/elasticsearch/elasticsearch-oss:7.10.2 \r\n started in PT8.264592S\r\n```\r\n* How often do you start new containers? The Docker image will be naturally cached, so it&#39;s not a concern, but depending on how you organize your test suite the amount of time you start new containers can grow. \r\n\r\nYou can read more about the lifecycle of the containers managed by Testcontainers [in the docs](https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/).\r\n \r\nFor example, if you use JUnit you can check whether you start new containers in `@BeforeEach` or `@BeforeAll` or are using a singleton container throughout the test suite. \r\n\r\n* How fast is the application in the container? \r\n\r\nOne of the factors is how much resources Docker is allowed to use. By default, [Docker is configured](https://docs.docker.com/desktop/mac/#resources) to have 2G of memory which could be a bottleneck.\r\nIf you don&#39;t have enough memory available in the container Elastic might behave slower than it should (even slower if it starts swapping, etc). Give it plenty of CPU and memory for fastest results. \r\n\r\nIf looking at these 3 things doesn&#39;t help, then perhaps you could profile the test run to check what are the bottlenecks.\r\n","title":"Speed up Elasticsearch Test Containers","body":"<p>General advice for any performance work or optimizations is to measure before introducing changes. I'd recommend profiling your test runs before you draw conclusions.</p>\n<p>There are a few metrics there that you can estimate without extensive use of profilers.</p>\n<ul>\n<li>How long does the Elastic container start?</li>\n</ul>\n<p>For me it takes 8.2 seconds (I used <code>elasticsearch-oss:7.10.2</code>):</p>\n<pre><code>14:35:55.803 [main] INFO  üê≥ [docker.elastic.co/elasticsearch/elasticsearch-oss:7.10.2] -\n Container docker.elastic.co/elasticsearch/elasticsearch-oss:7.10.2 \n started in PT8.264592S\n</code></pre>\n<ul>\n<li>How often do you start new containers? The Docker image will be naturally cached, so it's not a concern, but depending on how you organize your test suite the amount of time you start new containers can grow.</li>\n</ul>\n<p>You can read more about the lifecycle of the containers managed by Testcontainers <a href=\"https://www.testcontainers.org/test_framework_integration/manual_lifecycle_control/\" rel=\"nofollow noreferrer\">in the docs</a>.</p>\n<p>For example, if you use JUnit you can check whether you start new containers in <code>@BeforeEach</code> or <code>@BeforeAll</code> or are using a singleton container throughout the test suite.</p>\n<ul>\n<li>How fast is the application in the container?</li>\n</ul>\n<p>One of the factors is how much resources Docker is allowed to use. By default, <a href=\"https://docs.docker.com/desktop/mac/#resources\" rel=\"nofollow noreferrer\">Docker is configured</a> to have 2G of memory which could be a bottleneck.\nIf you don't have enough memory available in the container Elastic might behave slower than it should (even slower if it starts swapping, etc). Give it plenty of CPU and memory for fastest results.</p>\n<p>If looking at these 3 things doesn't help, then perhaps you could profile the test run to check what are the bottlenecks.</p>\n"}],"owner":{"account_id":3463037,"reputation":2280,"user_id":2899485,"accept_rate":42,"display_name":"A_G"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2319,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":70786515,"answer_count":1,"score":2,"last_activity_date":1672916415,"creation_date":1642631529,"question_id":70778593,"body_markdown":"I have moved the java integration tests to use elasticsearch test containers instead of using embedded elasticsearch. The tests have become slower by 1 hour which is a huge productivity hit. I am looking for ways to speed that up.\r\n\r\nI tried using params like `reuse` on Elasticsearch container but that didn&#39;t make a dent. My latest configuration is\r\n```\r\n    private static final String ELASTICSEARCH_VERSION = &quot;7.11.2&quot;;\r\n    private static ElasticsearchContainer elasticsearchContainer;\r\n    private static final DockerImageName ELASTICSEARCH_IMAGE =\r\n          DockerImageName\r\n                .parse(&quot;docker.elastic.co/elasticsearch/elasticsearch&quot;)\r\n                .withTag(ELASTICSEARCH_VERSION);\r\n```\r\n\r\n```\r\n            elasticsearchContainer = new ElasticsearchContainer(ELASTICSEARCH_IMAGE)\r\n                  .withEnv(&quot;foo&quot;, &quot;bar&quot;).withSharedMemorySize(1000000000L);\r\n            elasticsearchContainer.addExposedPorts(9200, 9300);\r\n            elasticsearchContainer.withStartupTimeout(Duration.of(5, ChronoUnit.MINUTES));\r\n            elasticsearchContainer.start();\r\n```\r\n\r\n```\r\n    private static RestHighLevelClient getRestHighLevelClient(ElasticsearchContainer container) {\r\n        final CredentialsProvider credentialsProvider = new BasicCredentialsProvider();\r\n        credentialsProvider.setCredentials(AuthScope.ANY,\r\n                                           new UsernamePasswordCredentials(ELASTICSEARCH_USERNAME,\r\n                                                                           ELASTICSEARCH_PASSWORD));\r\n        RestClientBuilder restClientBuilder = RestClient.builder(HttpHost.create(container.getHttpHostAddress()))\r\n              .setHttpClientConfigCallback(httpClientBuilder -&gt; httpClientBuilder\r\n                    .setDefaultCredentialsProvider(credentialsProvider)\r\n                    .setKeepAliveStrategy((response, context) -&gt; 3 * 60 * 1000));\r\n        // Try to prevent SocketTimeoutException when fetching larger batch size\r\n        restClientBuilder.setRequestConfigCallback(\r\n              requestConfigBuilder -&gt; requestConfigBuilder.setSocketTimeout(2 * 60 * 1000));\r\n\r\n        return new RestHighLevelClient(restClientBuilder);\r\n    }\r\n```\r\n\r\nGradle config (gradle daemon crashed once so increased to 2g)\r\n```\r\norg.gradle.jvmargs=-Xms2g -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8\r\n```\r\n\r\nAny suggestions on making the tests faster?","title":"Speed up Elasticsearch Test Containers","body":"<p>I have moved the java integration tests to use elasticsearch test containers instead of using embedded elasticsearch. The tests have become slower by 1 hour which is a huge productivity hit. I am looking for ways to speed that up.</p>\n<p>I tried using params like <code>reuse</code> on Elasticsearch container but that didn't make a dent. My latest configuration is</p>\n<pre><code>    private static final String ELASTICSEARCH_VERSION = &quot;7.11.2&quot;;\n    private static ElasticsearchContainer elasticsearchContainer;\n    private static final DockerImageName ELASTICSEARCH_IMAGE =\n          DockerImageName\n                .parse(&quot;docker.elastic.co/elasticsearch/elasticsearch&quot;)\n                .withTag(ELASTICSEARCH_VERSION);\n</code></pre>\n<pre><code>            elasticsearchContainer = new ElasticsearchContainer(ELASTICSEARCH_IMAGE)\n                  .withEnv(&quot;foo&quot;, &quot;bar&quot;).withSharedMemorySize(1000000000L);\n            elasticsearchContainer.addExposedPorts(9200, 9300);\n            elasticsearchContainer.withStartupTimeout(Duration.of(5, ChronoUnit.MINUTES));\n            elasticsearchContainer.start();\n</code></pre>\n<pre><code>    private static RestHighLevelClient getRestHighLevelClient(ElasticsearchContainer container) {\n        final CredentialsProvider credentialsProvider = new BasicCredentialsProvider();\n        credentialsProvider.setCredentials(AuthScope.ANY,\n                                           new UsernamePasswordCredentials(ELASTICSEARCH_USERNAME,\n                                                                           ELASTICSEARCH_PASSWORD));\n        RestClientBuilder restClientBuilder = RestClient.builder(HttpHost.create(container.getHttpHostAddress()))\n              .setHttpClientConfigCallback(httpClientBuilder -&gt; httpClientBuilder\n                    .setDefaultCredentialsProvider(credentialsProvider)\n                    .setKeepAliveStrategy((response, context) -&gt; 3 * 60 * 1000));\n        // Try to prevent SocketTimeoutException when fetching larger batch size\n        restClientBuilder.setRequestConfigCallback(\n              requestConfigBuilder -&gt; requestConfigBuilder.setSocketTimeout(2 * 60 * 1000));\n\n        return new RestHighLevelClient(restClientBuilder);\n    }\n</code></pre>\n<p>Gradle config (gradle daemon crashed once so increased to 2g)</p>\n<pre><code>org.gradle.jvmargs=-Xms2g -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8\n</code></pre>\n<p>Any suggestions on making the tests faster?</p>\n"},{"tags":["java","spring","spring-boot"],"comments":[{"owner":{"account_id":26698569,"reputation":875,"user_id":20306007,"display_name":"life888888"},"score":0,"creation_date":1672754508,"post_id":74993410,"comment_id":132342436,"body_markdown":"Does this answer your question? [How does one specify a temp directory for file uploads in Spring Boot?](https://stackoverflow.com/questions/29923682/how-does-one-specify-a-temp-directory-for-file-uploads-in-spring-boot)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/29923682/how-does-one-specify-a-temp-directory-for-file-uploads-in-spring-boot\">How does one specify a temp directory for file uploads in Spring Boot?</a>"}],"answers":[{"comments":[{"owner":{"account_id":22246447,"reputation":17,"user_id":16480070,"display_name":"Sizor"},"score":0,"creation_date":1672826223,"post_id":75002240,"comment_id":132358602,"body_markdown":"ok, thanks, still wondering how to do it in my case, cause i have system on pretty small disk and there will app running and then i have connect large disk and i want all files go straight to that external connected disk, to avoid the situation that the file is too large. I will be uploading files about 2GB. Can you just hint me some solution exactly for my case?","body":"ok, thanks, still wondering how to do it in my case, cause i have system on pretty small disk and there will app running and then i have connect large disk and i want all files go straight to that external connected disk, to avoid the situation that the file is too large. I will be uploading files about 2GB. Can you just hint me some solution exactly for my case?"},{"owner":{"account_id":16623452,"reputation":902,"user_id":12013107,"display_name":"Saurabh"},"score":0,"creation_date":1672916217,"post_id":75002240,"comment_id":132382640,"body_markdown":"Sorry, my bad. I miss understood the internal code. For you just configured the `spring.servlet.multipart.location` keeping  `spring.servlet.multipart.file-size-threshold` to default value to zero. It will store all files directly that place only. But as you mention you want to upload file about 2GB you have to change `max-file-size` and `max-request-size` as well accordingly.","body":"Sorry, my bad. I miss understood the internal code. For you just configured the <code>spring.servlet.multipart.location</code> keeping  <code>spring.servlet.multipart.file-size-threshold</code> to default value to zero. It will store all files directly that place only. But as you mention you want to upload file about 2GB you have to change <code>max-file-size</code> and <code>max-request-size</code> as well accordingly."}],"tags":[],"owner":{"account_id":16623452,"reputation":902,"user_id":12013107,"display_name":"Saurabh"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672916409,"creation_date":1672817851,"answer_id":75002240,"question_id":74993410,"body_markdown":"As mentioned in [this][1] document for `spring.servlet.multipart.location`, \r\n\r\n&gt; location specifies the directory where uploaded files will be stored.\r\n&gt; When not specified, a temporary directory will be used.\r\n\r\nI dig around some internal code and found out that, it depends on the `spring.servlet.multipart.file-size-threshold` configuration. As mentioned in the doc \r\n\r\n&gt; specifies the size threshold after which files will be written to disk. The default is 0.\r\n\r\nIf you mention any non-zero value then it will attempt to store that much in memory first before, writing to disk.\r\nFor your case, if you mention any location in `spring.servlet.multipart.location` the file will directly stored over that location only.\r\nYou may also want to check  `spring.servlet.multipart.max-file-size` and `spring.servlet.multipart.max-request-size` property.\r\n\r\n\r\n  [1]: https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/autoconfigure/web/servlet/MultipartProperties.html","title":"Spring boot multi part files upload storing data wondering","body":"<p>As mentioned in <a href=\"https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/autoconfigure/web/servlet/MultipartProperties.html\" rel=\"nofollow noreferrer\">this</a> document for <code>spring.servlet.multipart.location</code>,</p>\n<blockquote>\n<p>location specifies the directory where uploaded files will be stored.\nWhen not specified, a temporary directory will be used.</p>\n</blockquote>\n<p>I dig around some internal code and found out that, it depends on the <code>spring.servlet.multipart.file-size-threshold</code> configuration. As mentioned in the doc</p>\n<blockquote>\n<p>specifies the size threshold after which files will be written to disk. The default is 0.</p>\n</blockquote>\n<p>If you mention any non-zero value then it will attempt to store that much in memory first before, writing to disk.\nFor your case, if you mention any location in <code>spring.servlet.multipart.location</code> the file will directly stored over that location only.\nYou may also want to check  <code>spring.servlet.multipart.max-file-size</code> and <code>spring.servlet.multipart.max-request-size</code> property.</p>\n"}],"owner":{"account_id":22246447,"reputation":17,"user_id":16480070,"display_name":"Sizor"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":460,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672916409,"creation_date":1672749016,"question_id":74993410,"body_markdown":"I have this service in spring boot app:\r\n\r\n    @Service\r\n    public class FileStorageService {\r\n        private final Path root = Paths.get(&quot;uploads&quot;);\r\n    \r\n        public void init() {\r\n            try {\r\n              Files.createDirectories(root);\r\n            } catch (IOException e) {\r\n              throw new RuntimeException(&quot;Could not initialize folder for upload!&quot;);\r\n            }\r\n          }\r\n        \r\n          public ResponseEntity&lt;?&gt; save(MultipartFile[] files) {\r\n            if (files.length == 0) {\r\n                //return ResponseEntity.badRequest();\r\n            }\r\n    \r\n           \r\n        \r\n            Arrays.asList(files).stream().forEach(file -&gt; {\r\n                try {\r\n                    // Get the file and save it somewhere\r\n                    byte[] bytes = file.getBytes();\r\n                    Path path = Paths.get(root + File.separator + file.getOriginalFilename());\r\n                    Files.write(path, bytes);\r\n        \r\n                } catch (IOException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            });\r\n    \r\n            \r\n            return new ResponseEntity&lt;&gt;(null, HttpStatus.OK);\r\n            \r\n        }\r\n        \r\n    }\r\n\r\nThere is some folder for saving files &quot;uploads&quot;. And i am now wondering what is \r\n\r\n    spring.servlet.multipart.location=\r\n\r\nsetting used for. Is this just folder where raw data from request are stored before they are saved in &quot;uploads&quot; folder?","title":"Spring boot multi part files upload storing data wondering","body":"<p>I have this service in spring boot app:</p>\n<pre><code>@Service\npublic class FileStorageService {\n    private final Path root = Paths.get(&quot;uploads&quot;);\n\n    public void init() {\n        try {\n          Files.createDirectories(root);\n        } catch (IOException e) {\n          throw new RuntimeException(&quot;Could not initialize folder for upload!&quot;);\n        }\n      }\n    \n      public ResponseEntity&lt;?&gt; save(MultipartFile[] files) {\n        if (files.length == 0) {\n            //return ResponseEntity.badRequest();\n        }\n\n       \n    \n        Arrays.asList(files).stream().forEach(file -&gt; {\n            try {\n                // Get the file and save it somewhere\n                byte[] bytes = file.getBytes();\n                Path path = Paths.get(root + File.separator + file.getOriginalFilename());\n                Files.write(path, bytes);\n    \n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        });\n\n        \n        return new ResponseEntity&lt;&gt;(null, HttpStatus.OK);\n        \n    }\n    \n}\n</code></pre>\n<p>There is some folder for saving files &quot;uploads&quot;. And i am now wondering what is</p>\n<pre><code>spring.servlet.multipart.location=\n</code></pre>\n<p>setting used for. Is this just folder where raw data from request are stored before they are saved in &quot;uploads&quot; folder?</p>\n"},{"tags":["java","appium"],"owner":{"account_id":12496720,"reputation":21,"user_id":11494942,"display_name":"mr.m.m."},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":197,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672916399,"creation_date":1672840915,"question_id":75006580,"body_markdown":"I&#39;ve been using older version of Appium and appium-java-client and recently I&#39;ve been trying to upgrade to new versions. For closing the app after each android test I used `mobileDriver.quit()` but it&#39;s not working in the new version. I&#39;ve read the documentation and found a command `mobileDriver.executeScript(&quot;mobile: terminateApp&quot;, ImmutableMap.of(&quot;appId&quot;, &quot;app.id&quot;))` but it won&#39;t work either. Has anyone been able to achieve this?\r\nThanks in advance.","title":"How to terminate app after each test Appium UIAutomator2","body":"<p>I've been using older version of Appium and appium-java-client and recently I've been trying to upgrade to new versions. For closing the app after each android test I used <code>mobileDriver.quit()</code> but it's not working in the new version. I've read the documentation and found a command <code>mobileDriver.executeScript(&quot;mobile: terminateApp&quot;, ImmutableMap.of(&quot;appId&quot;, &quot;app.id&quot;))</code> but it won't work either. Has anyone been able to achieve this?\nThanks in advance.</p>\n"},{"tags":["java","intellij-idea"],"answers":[{"tags":[],"owner":{"account_id":6682867,"reputation":544,"user_id":5155332,"display_name":"northpl93"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1587414344,"creation_date":1587414344,"answer_id":61331426,"question_id":61331320,"body_markdown":"If you are using JetBrains Toolbox, restart it. IntelliJ inherits old environment variables from toolbox&#39;s process.","title":"IntelliJ terminal has a different environment path?","body":"<p>If you are using JetBrains Toolbox, restart it. IntelliJ inherits old environment variables from toolbox's process.</p>\n"},{"tags":[],"owner":{"account_id":36734,"reputation":392137,"user_id":104891,"display_name":"CrazyCoder"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1587414866,"creation_date":1587414866,"answer_id":61331578,"question_id":61331320,"body_markdown":"Environment variables are inherited from the parent process and are not updated on the fly in most cases. You should logout/login or reboot for the environment variables to have effect for all the apps on the system.","title":"IntelliJ terminal has a different environment path?","body":"<p>Environment variables are inherited from the parent process and are not updated on the fly in most cases. You should logout/login or reboot for the environment variables to have effect for all the apps on the system.</p>\n"}],"owner":{"account_id":11936627,"reputation":105,"user_id":8734879,"display_name":"Rufus7"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":472,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":61331578,"answer_count":2,"score":1,"last_activity_date":1672915962,"creation_date":1587413959,"question_id":61331320,"body_markdown":"I am trying to run maven project in the intelliJ, then got an error \r\n```\r\n JAVA_HOME is set to an invalid directory.\r\n JAVA_HOME = &quot;H:\\jdk\\1.8\\bin&quot;\r\n Please set the JAVA_HOME varialbe in your environment to match \r\n the location of you Java installation\r\n```\r\n\r\nI have changed the environment variable in system to &quot;H:\\jdk\\1.8&quot;, and restart the intelliJ, still got the same error. But in system command prompt, the java_home is already &quot;H:\\jdk\\1.8&quot;\r\n\r\nDoes anyone know how to solve it? Thank you.","title":"IntelliJ terminal has a different environment path?","body":"<p>I am trying to run maven project in the intelliJ, then got an error </p>\n\n<pre><code> JAVA_HOME is set to an invalid directory.\n JAVA_HOME = \"H:\\jdk\\1.8\\bin\"\n Please set the JAVA_HOME varialbe in your environment to match \n the location of you Java installation\n</code></pre>\n\n<p>I have changed the environment variable in system to \"H:\\jdk\\1.8\", and restart the intelliJ, still got the same error. But in system command prompt, the java_home is already \"H:\\jdk\\1.8\"</p>\n\n<p>Does anyone know how to solve it? Thank you.</p>\n"},{"tags":["java","protocol-buffers","grpc","grpc-java"],"comments":[{"owner":{"account_id":14947494,"reputation":521,"user_id":10792320,"display_name":"San P"},"score":2,"creation_date":1615160359,"post_id":66507828,"comment_id":117598774,"body_markdown":"Why don&#39;t you like the first approach? For best practices you can check out:\n\nhttps://developers.google.com/protocol-buffers/docs/proto3#enum\n\nor\n\nhttps://developers.google.com/protocol-buffers/docs/reference/java-generated#enum","body":"Why don&#39;t you like the first approach? For best practices you can check out:  <a href=\"https://developers.google.com/protocol-buffers/docs/proto3#enum\" rel=\"nofollow noreferrer\">developers.google.com/protocol-buffers/docs/proto3#enum</a>  or  <a href=\"https://developers.google.com/protocol-buffers/docs/reference/java-generated#enum\" rel=\"nofollow noreferrer\">developers.google.com/protocol-buffers/docs/reference/&hellip;</a>"},{"owner":{"account_id":5382000,"reputation":5258,"user_id":4286990,"accept_rate":60,"display_name":"vatsal mevada"},"score":0,"creation_date":1615177941,"post_id":66507828,"comment_id":117601653,"body_markdown":"@SanP Thanks for those references to best practices. I ended up using the first approach only. I also noticed that there is experimental support for optional attributes, which appeared cleaner to me but unfortunately I won&#39;t be able to use that experimental feature in our production code. About the first approach one annoying thing was the scoping semantics of the enums. i.e. I have to keep in unique in the entire proto file which means I will have to use `UNKNOWN_FOO` instead of `UNKNOWN`.","body":"@SanP Thanks for those references to best practices. I ended up using the first approach only. I also noticed that there is experimental support for optional attributes, which appeared cleaner to me but unfortunately I won&#39;t be able to use that experimental feature in our production code. About the first approach one annoying thing was the scoping semantics of the enums. i.e. I have to keep in unique in the entire proto file which means I will have to use <code>UNKNOWN_FOO</code> instead of <code>UNKNOWN</code>."}],"answers":[{"comments":[{"owner":{"account_id":2744351,"reputation":743,"user_id":2365072,"accept_rate":100,"display_name":"Tez"},"score":0,"creation_date":1660715410,"post_id":71015456,"comment_id":129594832,"body_markdown":"Protoc doesn&#39;t compile the `has` methods for enums","body":"Protoc doesn&#39;t compile the <code>has</code> methods for enums"}],"tags":[],"owner":{"account_id":5209973,"reputation":1102,"user_id":4166721,"display_name":"Cash Lo"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1644222366,"creation_date":1644222366,"answer_id":71015456,"question_id":66507828,"body_markdown":"You should be able to check the field using `hasFoo()`, while `getFoo()` will return `BAR`, `hasFoo()` should return `false`.","title":"How to handle a nullable enum type field in a protobuf3 message?","body":"<p>You should be able to check the field using <code>hasFoo()</code>, while <code>getFoo()</code> will return <code>BAR</code>, <code>hasFoo()</code> should return <code>false</code>.</p>\n"},{"tags":[],"owner":{"account_id":14173637,"reputation":105,"user_id":10239573,"display_name":"Miri"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672915705,"creation_date":1672915705,"answer_id":75017267,"question_id":66507828,"body_markdown":"Continue reading only if you do not wish to use `UNKNOWN` enum value.\r\n\r\nDo not know if the best practice but whenever I&#39;m sending the object itself where the value can&#39;t be null, I use the `enum` value.\r\nAnd in requests (like your `UpdateRequest`) when it can be empty I&#39;m using a `string` type instead and handle the conversion manually.\r\n\r\n    message Object {\r\n      EnumProperty property = 1;\r\n    \r\n      enum EnumProperty {\r\n        FIRST = 0;\r\n        SECOND = 1;\r\n        THIRD = 2;\r\n      }\r\n    }\r\n    \r\n    message ObjectUpdateRequest {\r\n      string property = 1;\r\n    }","title":"How to handle a nullable enum type field in a protobuf3 message?","body":"<p>Continue reading only if you do not wish to use <code>UNKNOWN</code> enum value.</p>\n<p>Do not know if the best practice but whenever I'm sending the object itself where the value can't be null, I use the <code>enum</code> value.\nAnd in requests (like your <code>UpdateRequest</code>) when it can be empty I'm using a <code>string</code> type instead and handle the conversion manually.</p>\n<pre><code>message Object {\n  EnumProperty property = 1;\n\n  enum EnumProperty {\n    FIRST = 0;\n    SECOND = 1;\n    THIRD = 2;\n  }\n}\n\nmessage ObjectUpdateRequest {\n  string property = 1;\n}\n</code></pre>\n"}],"owner":{"account_id":5382000,"reputation":5258,"user_id":4286990,"accept_rate":60,"display_name":"vatsal mevada"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":5164,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"answer_count":2,"score":4,"last_activity_date":1672915705,"creation_date":1615047143,"question_id":66507828,"body_markdown":"The following are my protobuf definitions:\r\n```\r\nenum Foo {\r\n   BAR = 0;\r\n   BAZ = 1;      \r\n}\r\n\r\nmessage UpdateRequest {\r\n  string id = 1;\r\n  Foo foo = 2;\r\n  .\r\n  .\r\n  .\r\n}\r\n```\r\n\r\nI need the `foo` field of the `UpdateRequest` to be nullable. However, if I don&#39;t set the value of this field then as per protobuf semantics it always ends up picking `BAR` as the default value.\r\n\r\nLooking around, I found a couple of ways to handle this.\r\n1. Add an additional `UNKNOWN` value in the enum and map it to `0` so that this value will be used as the default value instead of `BAR` and I can treat this value as null.\r\n\r\n```\r\nenum Foo {\r\n   UNKNOWN = 0;\r\n   BAR = 1;\r\n   BAZ = 2;      \r\n}\r\n```\r\n2. Use `oneof` construct.\r\n\r\nHowever, somehow I feel that both of the above approaches are a kind of a workaround and I am not able to locate official documentation explaining the best practice to handle this case.\r\n\r\nWhat is the best practice to handle this use case?\r\n","title":"How to handle a nullable enum type field in a protobuf3 message?","body":"<p>The following are my protobuf definitions:</p>\n<pre><code>enum Foo {\n   BAR = 0;\n   BAZ = 1;      \n}\n\nmessage UpdateRequest {\n  string id = 1;\n  Foo foo = 2;\n  .\n  .\n  .\n}\n</code></pre>\n<p>I need the <code>foo</code> field of the <code>UpdateRequest</code> to be nullable. However, if I don't set the value of this field then as per protobuf semantics it always ends up picking <code>BAR</code> as the default value.</p>\n<p>Looking around, I found a couple of ways to handle this.</p>\n<ol>\n<li>Add an additional <code>UNKNOWN</code> value in the enum and map it to <code>0</code> so that this value will be used as the default value instead of <code>BAR</code> and I can treat this value as null.</li>\n</ol>\n<pre><code>enum Foo {\n   UNKNOWN = 0;\n   BAR = 1;\n   BAZ = 2;      \n}\n</code></pre>\n<ol start=\"2\">\n<li>Use <code>oneof</code> construct.</li>\n</ol>\n<p>However, somehow I feel that both of the above approaches are a kind of a workaround and I am not able to locate official documentation explaining the best practice to handle this case.</p>\n<p>What is the best practice to handle this use case?</p>\n"},{"tags":["java","open-telemetry"],"comments":[{"owner":{"account_id":10595855,"reputation":2708,"user_id":7804595,"display_name":"Valeriy K."},"score":0,"creation_date":1678961579,"post_id":75016256,"comment_id":133635603,"body_markdown":"Try to exclude classLoaderMatcher() at all. It enables classloader which will load `java.sql.Statement` but may be unable to load other classes. Use the default loader.","body":"Try to exclude classLoaderMatcher() at all. It enables classloader which will load <code>java.sql.Statement</code> but may be unable to load other classes. Use the default loader."}],"answers":[{"comments":[{"owner":{"account_id":27438316,"reputation":21,"user_id":20933731,"display_name":"Vaibhav"},"score":0,"creation_date":1672915852,"post_id":75016729,"comment_id":132382497,"body_markdown":"Updated the Advice code. Still not working. \nAlso, I am assuming that if the flow reaches inside the advice, System.out.println(&quot;Inside MYSQL-1.4&quot;) and System.out.println(&quot;Inside MYSQL-1.5&quot;) should be printed. But this too is not coming when I am making a call to db from application.","body":"Updated the Advice code. Still not working.  Also, I am assuming that if the flow reaches inside the advice, System.out.println(&quot;Inside MYSQL-1.4&quot;) and System.out.println(&quot;Inside MYSQL-1.5&quot;) should be printed. But this too is not coming when I am making a call to db from application."},{"owner":{"account_id":21372668,"reputation":156,"user_id":15739953,"display_name":"Mateusz Rzeszutek"},"score":0,"creation_date":1672937195,"post_id":75016729,"comment_id":132390433,"body_markdown":"Have you tried running the agent in the debug mode? (`-Dotel.javaagent.debug=true`)\nPerhaps there are some errors in the output logs that might be helpful.","body":"Have you tried running the agent in the debug mode? (<code>-Dotel.javaagent.debug=true</code>) Perhaps there are some errors in the output logs that might be helpful."},{"owner":{"account_id":27438316,"reputation":21,"user_id":20933731,"display_name":"Vaibhav"},"score":0,"creation_date":1673450730,"post_id":75016729,"comment_id":132502684,"body_markdown":"Thanks, was able to fix this using the debug option","body":"Thanks, was able to fix this using the debug option"}],"tags":[],"owner":{"account_id":21372668,"reputation":156,"user_id":15739953,"display_name":"Mateusz Rzeszutek"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672913032,"creation_date":1672913032,"answer_id":75016729,"question_id":75016256,"body_markdown":"You&#39;ll need to set the `readOnly = false` option on the `@Argument` annotation , otherwise the advice code will not overwrite the original value:\r\n\r\n```java\r\n    @Advice.OnMethodEnter(suppress = Throwable.class)\r\n    public static void onEnter(@Advice.Argument(value = 0, readOnly = false) String sql) {\r\n      System.out.println(&quot;Inside MYSQL-1.4&quot;);\r\n\r\n      sql = sql + &quot; -- some comment&quot;;\r\n\r\n      System.out.println(&quot;Inside MYSQL- 1.5&quot;);\r\n    }\r\n```","title":"Why is my OpenTelemetry java extension not working","body":"<p>You'll need to set the <code>readOnly = false</code> option on the <code>@Argument</code> annotation , otherwise the advice code will not overwrite the original value:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @Advice.OnMethodEnter(suppress = Throwable.class)\n    public static void onEnter(@Advice.Argument(value = 0, readOnly = false) String sql) {\n      System.out.println(&quot;Inside MYSQL-1.4&quot;);\n\n      sql = sql + &quot; -- some comment&quot;;\n\n      System.out.println(&quot;Inside MYSQL- 1.5&quot;);\n    }\n</code></pre>\n"}],"owner":{"account_id":27438316,"reputation":21,"user_id":20933731,"display_name":"Vaibhav"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":873,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672915682,"creation_date":1672910744,"question_id":75016256,"body_markdown":"I have created an extension to add some comment in the sql query. For this I have created a `MySQLAddCommentInstrumentation.java` class to make changes to `query` in `Statement.java` class.\r\nAlso there is one `MySQLAddCommentInstrumentationModule.java` class which adds this instrumentation (`MySQLAddCommentInstrumentation`) to its list.\r\n\r\nWhen I build this extension and run my app, I do not see the comment in the query under db.statement zipkin log.\r\n\r\nInstrumentation Class - MySQLAddCommentInstrumentation.java\r\nPath - examples/extension/src/main/java/com/example/javaagent/mysqlinstrumentation/MySQLAddCommentInstrumentation.java\r\n\r\n\r\n```\r\npackage com.example.javaagent.mysqlinstrumentation;\r\n\r\nimport static io.opentelemetry.javaagent.extension.matcher.AgentElementMatchers.implementsInterface;\r\nimport static net.bytebuddy.matcher.ElementMatchers.named;\r\nimport static net.bytebuddy.matcher.ElementMatchers.namedOneOf;\r\n\r\nimport io.opentelemetry.javaagent.extension.instrumentation.TypeInstrumentation;\r\nimport io.opentelemetry.javaagent.extension.instrumentation.TypeTransformer;\r\nimport net.bytebuddy.asm.Advice;\r\nimport net.bytebuddy.description.type.TypeDescription;\r\nimport net.bytebuddy.matcher.ElementMatcher;\r\nimport net.bytebuddy.matcher.ElementMatchers;\r\n\r\npublic class MySQLAddCommentInstrumentation implements TypeInstrumentation {\r\n\r\n  @Override\r\n  public ElementMatcher&lt;TypeDescription&gt; typeMatcher() {\r\n    System.out.println(&quot;Inside MYSQL- 1.1&quot;);\r\n    return implementsInterface(named(&quot;java.sql.Statement&quot;));\r\n  }\r\n\r\n  public void transform(TypeTransformer transformer) {\r\n    System.out.println(&quot;Inside MYSQL- 1.2&quot;);\r\n\r\n    transformer.applyAdviceToMethod(\r\n        namedOneOf(&quot;executeQuery&quot;)\r\n            .and(ElementMatchers.takesArgument(0, String.class))\r\n            .and(ElementMatchers.isPublic()),\r\n        MySQLAddCommentInstrumentation.class.getName() + &quot;$StatementAddCommentAdvice&quot;);\r\n\r\n    System.out.println(&quot;Inside MYSQL- 1.3&quot;);\r\n  }\r\n\r\n  @SuppressWarnings(&quot;unused&quot;)\r\n  public static class StatementAddCommentAdvice {\r\n\r\n    @Advice.OnMethodEnter(suppress = Throwable.class)\r\n    public static void onEnter(@Advice.Argument(value = 0, readOnly = false) String sql) {\r\n      System.out.println(&quot;Inside MYSQL- 1.4&quot;);\r\n\r\n      sql = sql + &quot; -- some comment&quot;;\r\n\r\n      System.out.println(&quot;Inside MYSQL- 1.5&quot;);\r\n    }\r\n  }\r\n```\r\n\r\nInstrumentationModule - MySQLAddCommentInstrumentationModule.java\r\nPath - examples/extension/src/main/java/com/example/javaagent/mysqlinstrumentation/MySQLAddCommentInstrumentationModule.java\r\n\r\n\r\n\r\n```\r\npackage com.example.javaagent.mysqlinstrumentation;\r\n\r\nimport static java.util.Collections.singletonList;\r\n\r\nimport com.google.auto.service.AutoService;\r\nimport io.opentelemetry.javaagent.extension.instrumentation.InstrumentationModule;\r\nimport io.opentelemetry.javaagent.extension.instrumentation.TypeInstrumentation;\r\nimport io.opentelemetry.javaagent.extension.matcher.AgentElementMatchers;\r\nimport java.util.List;\r\nimport net.bytebuddy.matcher.ElementMatcher;\r\n\r\n\r\n@AutoService(InstrumentationModule.class)\r\npublic final class MySQLAddCommentInstrumentationModule extends InstrumentationModule {\r\n  public MySQLAddCommentInstrumentationModule() {\r\n    super(&quot;jdbc&quot;);\r\n  }\r\n\r\n  @Override\r\n  public int order() {\r\n    return 1;\r\n  }\r\n\r\n  @Override\r\n  public ElementMatcher.Junction&lt;ClassLoader&gt; classLoaderMatcher() {\r\n    return AgentElementMatchers.hasClassesNamed(&quot;java.sql.Statement&quot;);\r\n  }\r\n\r\n  @Override\r\n  public List&lt;TypeInstrumentation&gt; typeInstrumentations() {\r\n    return singletonList(new MySQLAddCommentInstrumentation());\r\n  }\r\n}\r\n\r\n```\r\n\r\n\r\nCode where this instrumentations is expected to run:\r\n\r\n\r\n```\r\ntry {\r\n            Connection con = DriverManager.getConnection(url, uname, password);\r\n            Statement statement = con.createStatement();\r\n            System.out.println(query);\r\n            ResultSet result = statement.executeQuery(query);\r\n            System.out.println(query);\r\n\r\n        } catch (SQLException e) {\r\n            e.printStackTrace();\r\n        }\r\n```\r\n\r\nI have run `./gradlew build` inside examples/extension and used that extension jar to run my application\r\n\r\n```\r\njava -javaagent:/Users/vaibhavpaharia/Downloads/opentelemetry-javaagent.jar \\\r\n     -Dotel.javaagent.extensions=/Users/vaibhavpaharia/ok/opentelemetry-java-instrumentation/examples/extension/build/libs/opentelemetry-java-instrumentation-extension-demo-1.0-all.jar  \\\r\n     -Dotel.service.name=simpleapplication \\\r\n     -Dotel.traces.exporter=zipkin \\\r\n     -Dserver.port=8080 \\\r\n     -jar /Users/vaibhavpaharia/Downloads/simpleproject/target/simpleproject-0.0.1-SNAPSHOT.jar\r\n```\r\n\r\n\r\nAfter running the application with agent and extension I see that other extensions are working fine which are present in the example folder. \r\nAlso, I tried changing the order method in MySQLAddCommentInstrumentationModule.java and returned 0 from there, in that case `Inside MYSQL- 1.1`, `Inside MYSQL- 1.2` and `Inside MYSQL- 1.3` got printed so it seems the new extension is recognised while running the application. It never prints `Inside MYSQL- 1.4` and `Inside MYSQL- 1.5`. Also, the traces stop coming to zipkin.\r\n\r\n\r\n```\r\nOpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended\r\n[otel.javaagent 2023-01-05 14:50:31:010 +0530] [main] INFO io.opentelemetry.javaagent.tooling.VersionLogger - opentelemetry-javaagent - version: 1.20.2\r\nInside MYSQL- 1.1\r\nInside MYSQL- 1.2\r\nInside MYSQL- 1.3\r\n[otel.javaagent 2023-01-05 14:50:34:068 +0530] [main] INFO io.opentelemetry.javaagent.shaded.instrumentation.jmx.engine.JmxMetricInsight - Empty JMX configuration, no metrics will be collected for InstrumentationScope io.opentelemetry.jmx\r\n\r\n  .   ____          _            __ _ _\r\n /\\\\ / ___&#39;_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\r\n( ( )\\___ | &#39;_ | &#39;_| | &#39;_ \\/ _` | \\ \\ \\ \\\r\n \\\\/  ___)| |_)| | | | | || (_| |  ) ) ) )\r\n  &#39;  |____| .__|_| |_|_| |_\\__, | / / / /\r\n =========|_|==============|___/=/_/_/_/\r\n :: Spring Boot ::                (v3.0.1)\r\n\r\n2023-01-05T14:50:35.687+05:30  INFO 85143 --- [           main] c.e.s.SimpleprojectApplication           : Starting SimpleprojectApplication v0.0.1-SNAPSHOT using Java 18.0.2 with PID 85143 (/Users/vaibhavpaharia/Downloads/simpleproject/target/simpleproject-0.0.1-SNAPSHOT.jar started by vaibhavpaharia in /Users/vaibhavpaharia)\r\n2023-01-05T14:50:35.700+05:30  INFO 85143 --- [           main] c.e.s.SimpleprojectApplication           : No active profile set, falling back to 1 default profile: &quot;default&quot;\r\n2023-01-05T14:50:37.451+05:30  INFO 85143 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)\r\n2023-01-05T14:50:37.531+05:30  INFO 85143 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]\r\n2023-01-05T14:50:37.531+05:30  INFO 85143 --- [           main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.4]\r\n2023-01-05T14:50:37.643+05:30  INFO 85143 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext\r\n2023-01-05T14:50:37.645+05:30  INFO 85143 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1859 ms\r\n2023-01-05T14:50:38.254+05:30  INFO 85143 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path &#39;&#39;\r\n2023-01-05T14:50:38.266+05:30  INFO 85143 --- [           main] c.e.s.SimpleprojectApplication           : Started SimpleprojectApplication in 3.409 seconds (process running for 7.566)\r\n```\r\n\r\n","title":"Why is my OpenTelemetry java extension not working","body":"<p>I have created an extension to add some comment in the sql query. For this I have created a <code>MySQLAddCommentInstrumentation.java</code> class to make changes to <code>query</code> in <code>Statement.java</code> class.\nAlso there is one <code>MySQLAddCommentInstrumentationModule.java</code> class which adds this instrumentation (<code>MySQLAddCommentInstrumentation</code>) to its list.</p>\n<p>When I build this extension and run my app, I do not see the comment in the query under db.statement zipkin log.</p>\n<p>Instrumentation Class - MySQLAddCommentInstrumentation.java\nPath - examples/extension/src/main/java/com/example/javaagent/mysqlinstrumentation/MySQLAddCommentInstrumentation.java</p>\n<pre><code>package com.example.javaagent.mysqlinstrumentation;\n\nimport static io.opentelemetry.javaagent.extension.matcher.AgentElementMatchers.implementsInterface;\nimport static net.bytebuddy.matcher.ElementMatchers.named;\nimport static net.bytebuddy.matcher.ElementMatchers.namedOneOf;\n\nimport io.opentelemetry.javaagent.extension.instrumentation.TypeInstrumentation;\nimport io.opentelemetry.javaagent.extension.instrumentation.TypeTransformer;\nimport net.bytebuddy.asm.Advice;\nimport net.bytebuddy.description.type.TypeDescription;\nimport net.bytebuddy.matcher.ElementMatcher;\nimport net.bytebuddy.matcher.ElementMatchers;\n\npublic class MySQLAddCommentInstrumentation implements TypeInstrumentation {\n\n  @Override\n  public ElementMatcher&lt;TypeDescription&gt; typeMatcher() {\n    System.out.println(&quot;Inside MYSQL- 1.1&quot;);\n    return implementsInterface(named(&quot;java.sql.Statement&quot;));\n  }\n\n  public void transform(TypeTransformer transformer) {\n    System.out.println(&quot;Inside MYSQL- 1.2&quot;);\n\n    transformer.applyAdviceToMethod(\n        namedOneOf(&quot;executeQuery&quot;)\n            .and(ElementMatchers.takesArgument(0, String.class))\n            .and(ElementMatchers.isPublic()),\n        MySQLAddCommentInstrumentation.class.getName() + &quot;$StatementAddCommentAdvice&quot;);\n\n    System.out.println(&quot;Inside MYSQL- 1.3&quot;);\n  }\n\n  @SuppressWarnings(&quot;unused&quot;)\n  public static class StatementAddCommentAdvice {\n\n    @Advice.OnMethodEnter(suppress = Throwable.class)\n    public static void onEnter(@Advice.Argument(value = 0, readOnly = false) String sql) {\n      System.out.println(&quot;Inside MYSQL- 1.4&quot;);\n\n      sql = sql + &quot; -- some comment&quot;;\n\n      System.out.println(&quot;Inside MYSQL- 1.5&quot;);\n    }\n  }\n</code></pre>\n<p>InstrumentationModule - MySQLAddCommentInstrumentationModule.java\nPath - examples/extension/src/main/java/com/example/javaagent/mysqlinstrumentation/MySQLAddCommentInstrumentationModule.java</p>\n<pre><code>package com.example.javaagent.mysqlinstrumentation;\n\nimport static java.util.Collections.singletonList;\n\nimport com.google.auto.service.AutoService;\nimport io.opentelemetry.javaagent.extension.instrumentation.InstrumentationModule;\nimport io.opentelemetry.javaagent.extension.instrumentation.TypeInstrumentation;\nimport io.opentelemetry.javaagent.extension.matcher.AgentElementMatchers;\nimport java.util.List;\nimport net.bytebuddy.matcher.ElementMatcher;\n\n\n@AutoService(InstrumentationModule.class)\npublic final class MySQLAddCommentInstrumentationModule extends InstrumentationModule {\n  public MySQLAddCommentInstrumentationModule() {\n    super(&quot;jdbc&quot;);\n  }\n\n  @Override\n  public int order() {\n    return 1;\n  }\n\n  @Override\n  public ElementMatcher.Junction&lt;ClassLoader&gt; classLoaderMatcher() {\n    return AgentElementMatchers.hasClassesNamed(&quot;java.sql.Statement&quot;);\n  }\n\n  @Override\n  public List&lt;TypeInstrumentation&gt; typeInstrumentations() {\n    return singletonList(new MySQLAddCommentInstrumentation());\n  }\n}\n\n</code></pre>\n<p>Code where this instrumentations is expected to run:</p>\n<pre><code>try {\n            Connection con = DriverManager.getConnection(url, uname, password);\n            Statement statement = con.createStatement();\n            System.out.println(query);\n            ResultSet result = statement.executeQuery(query);\n            System.out.println(query);\n\n        } catch (SQLException e) {\n            e.printStackTrace();\n        }\n</code></pre>\n<p>I have run <code>./gradlew build</code> inside examples/extension and used that extension jar to run my application</p>\n<pre><code>java -javaagent:/Users/vaibhavpaharia/Downloads/opentelemetry-javaagent.jar \\\n     -Dotel.javaagent.extensions=/Users/vaibhavpaharia/ok/opentelemetry-java-instrumentation/examples/extension/build/libs/opentelemetry-java-instrumentation-extension-demo-1.0-all.jar  \\\n     -Dotel.service.name=simpleapplication \\\n     -Dotel.traces.exporter=zipkin \\\n     -Dserver.port=8080 \\\n     -jar /Users/vaibhavpaharia/Downloads/simpleproject/target/simpleproject-0.0.1-SNAPSHOT.jar\n</code></pre>\n<p>After running the application with agent and extension I see that other extensions are working fine which are present in the example folder.\nAlso, I tried changing the order method in MySQLAddCommentInstrumentationModule.java and returned 0 from there, in that case <code>Inside MYSQL- 1.1</code>, <code>Inside MYSQL- 1.2</code> and <code>Inside MYSQL- 1.3</code> got printed so it seems the new extension is recognised while running the application. It never prints <code>Inside MYSQL- 1.4</code> and <code>Inside MYSQL- 1.5</code>. Also, the traces stop coming to zipkin.</p>\n<pre><code>OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended\n[otel.javaagent 2023-01-05 14:50:31:010 +0530] [main] INFO io.opentelemetry.javaagent.tooling.VersionLogger - opentelemetry-javaagent - version: 1.20.2\nInside MYSQL- 1.1\nInside MYSQL- 1.2\nInside MYSQL- 1.3\n[otel.javaagent 2023-01-05 14:50:34:068 +0530] [main] INFO io.opentelemetry.javaagent.shaded.instrumentation.jmx.engine.JmxMetricInsight - Empty JMX configuration, no metrics will be collected for InstrumentationScope io.opentelemetry.jmx\n\n  .   ____          _            __ _ _\n /\\\\ / ___'_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\n( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\\n \\\\/  ___)| |_)| | | | | || (_| |  ) ) ) )\n  '  |____| .__|_| |_|_| |_\\__, | / / / /\n =========|_|==============|___/=/_/_/_/\n :: Spring Boot ::                (v3.0.1)\n\n2023-01-05T14:50:35.687+05:30  INFO 85143 --- [           main] c.e.s.SimpleprojectApplication           : Starting SimpleprojectApplication v0.0.1-SNAPSHOT using Java 18.0.2 with PID 85143 (/Users/vaibhavpaharia/Downloads/simpleproject/target/simpleproject-0.0.1-SNAPSHOT.jar started by vaibhavpaharia in /Users/vaibhavpaharia)\n2023-01-05T14:50:35.700+05:30  INFO 85143 --- [           main] c.e.s.SimpleprojectApplication           : No active profile set, falling back to 1 default profile: &quot;default&quot;\n2023-01-05T14:50:37.451+05:30  INFO 85143 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)\n2023-01-05T14:50:37.531+05:30  INFO 85143 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]\n2023-01-05T14:50:37.531+05:30  INFO 85143 --- [           main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.4]\n2023-01-05T14:50:37.643+05:30  INFO 85143 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext\n2023-01-05T14:50:37.645+05:30  INFO 85143 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1859 ms\n2023-01-05T14:50:38.254+05:30  INFO 85143 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''\n2023-01-05T14:50:38.266+05:30  INFO 85143 --- [           main] c.e.s.SimpleprojectApplication           : Started SimpleprojectApplication in 3.409 seconds (process running for 7.566)\n</code></pre>\n"},{"tags":["java","android","imei"],"answers":[{"tags":[],"owner":{"account_id":1790714,"reputation":91128,"user_id":1631193,"accept_rate":71,"display_name":"Gabe Sechan"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1635353355,"creation_date":1635353355,"answer_id":69742582,"question_id":69740071,"body_markdown":"You can&#39;t get READ_PRIVILEGED_PHONE_STATE.  It&#39;s only available to privleged system apps.  Unless this is a personal app and you have a rooted device so you can make your app a privleged system app.","title":"getImeiForSlot: The user 10170 does not meet the requirements to access device identifiers","body":"<p>You can't get READ_PRIVILEGED_PHONE_STATE.  It's only available to privleged system apps.  Unless this is a personal app and you have a rooted device so you can make your app a privleged system app.</p>\n"},{"tags":[],"owner":{"account_id":10128114,"reputation":881,"user_id":7482614,"accept_rate":20,"display_name":"deva11"},"comment_count":0,"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1672915654,"creation_date":1672915654,"answer_id":75017258,"question_id":69740071,"body_markdown":"As Mentioned in Docs , There is a Restriction on non-resettable device identifiers.\r\n\r\nStarting in Android 10, apps must have the READ_PRIVILEGED_PHONE_STATE privileged permission in order to access the device&#39;s non-resettable identifiers, which include both IMEI and serial number.\r\n\r\n&gt; Caution: Third-party apps installed from the Google Play Store cannot\r\n&gt; declare privileged permissions.\r\n\r\nRef : https://developer.android.com/about/versions/10/privacy/changes#non-resettable-device-ids","title":"getImeiForSlot: The user 10170 does not meet the requirements to access device identifiers","body":"<p>As Mentioned in Docs , There is a Restriction on non-resettable device identifiers.</p>\n<p>Starting in Android 10, apps must have the READ_PRIVILEGED_PHONE_STATE privileged permission in order to access the device's non-resettable identifiers, which include both IMEI and serial number.</p>\n<blockquote>\n<p>Caution: Third-party apps installed from the Google Play Store cannot\ndeclare privileged permissions.</p>\n</blockquote>\n<p>Ref : <a href=\"https://developer.android.com/about/versions/10/privacy/changes#non-resettable-device-ids\" rel=\"nofollow noreferrer\">https://developer.android.com/about/versions/10/privacy/changes#non-resettable-device-ids</a></p>\n"}],"owner":{"account_id":10484756,"reputation":847,"user_id":7728676,"display_name":"lewis machilika"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3508,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":69742582,"answer_count":2,"score":0,"last_activity_date":1672915654,"creation_date":1635343174,"question_id":69740071,"body_markdown":"I have **android 10** I want to get **IMEI** below is my manifest settings\r\n```\r\n    &lt;uses-permission android:name=&quot;android.permission.READ_PHONE_STATE&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.READ_PRIVILEGED_PHONE_STATE&quot;/&gt;\r\n```\r\n\r\nand below is my java code to get the IMEI but I am getting the above error.\r\n```\r\n        Button btnAuth = findViewById(R.id.button);\r\n        TelephonyManager telephonyManager = (TelephonyManager)getSystemService(Context.TELEPHONY_SERVICE);\r\n        btnAuth.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                try {\r\n                    Log.i(&quot;huwa &quot;, telephonyManager.getImei());\r\n                }catch(Exception e){\r\n                    Log.i(&quot;huwa &quot;, e.toString());\r\n                }\r\n            }\r\n        });\r\n```","title":"getImeiForSlot: The user 10170 does not meet the requirements to access device identifiers","body":"<p>I have <strong>android 10</strong> I want to get <strong>IMEI</strong> below is my manifest settings</p>\n<pre><code>    &lt;uses-permission android:name=&quot;android.permission.READ_PHONE_STATE&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.READ_PRIVILEGED_PHONE_STATE&quot;/&gt;\n</code></pre>\n<p>and below is my java code to get the IMEI but I am getting the above error.</p>\n<pre><code>        Button btnAuth = findViewById(R.id.button);\n        TelephonyManager telephonyManager = (TelephonyManager)getSystemService(Context.TELEPHONY_SERVICE);\n        btnAuth.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                try {\n                    Log.i(&quot;huwa &quot;, telephonyManager.getImei());\n                }catch(Exception e){\n                    Log.i(&quot;huwa &quot;, e.toString());\n                }\n            }\n        });\n</code></pre>\n"},{"tags":["java","javafx","javafx-3d"],"comments":[{"owner":{"account_id":81822,"reputation":204250,"user_id":230513,"accept_rate":100,"display_name":"trashgod"},"score":0,"creation_date":1672940306,"post_id":75016039,"comment_id":132391537,"body_markdown":"Anything you can use in the `PickResult`, mentioned [here](https://stackoverflow.com/a/72322484/230513), [here](https://stackoverflow.com/a/72313844/230513) and [here](https://stackoverflow.com/a/59329700/230513)?","body":"Anything you can use in the <code>PickResult</code>, mentioned <a href=\"https://stackoverflow.com/a/72322484/230513\">here</a>, <a href=\"https://stackoverflow.com/a/72313844/230513\">here</a> and <a href=\"https://stackoverflow.com/a/59329700/230513\">here</a>?"},{"owner":{"account_id":11854454,"reputation":433,"user_id":14999427,"display_name":"Suic"},"score":0,"creation_date":1672941205,"post_id":75016039,"comment_id":132391839,"body_markdown":"unfortunately not, seems like i&#39;ll have to do all the math myself to construct the ray &amp; intersect with each triangle, the former is which what im mainly struggling with currently (how to construct a ray from a point in screen space)","body":"unfortunately not, seems like i&#39;ll have to do all the math myself to construct the ray &amp; intersect with each triangle, the former is which what im mainly struggling with currently (how to construct a ray from a point in screen space)"},{"owner":{"account_id":4498992,"reputation":735,"user_id":3658055,"display_name":"Birdasaur"},"score":1,"creation_date":1673290865,"post_id":75016039,"comment_id":132461514,"body_markdown":"For others interested the original StackOverflow post about Ray Intersections refers to Github repo code that has been since moved to here:\nhttps://github.com/FXyz/FXyz","body":"For others interested the original StackOverflow post about Ray Intersections refers to Github repo code that has been since moved to here: <a href=\"https://github.com/FXyz/FXyz\" rel=\"nofollow noreferrer\">github.com/FXyz/FXyz</a>"}],"answers":[{"comments":[{"owner":{"account_id":11854454,"reputation":433,"user_id":14999427,"display_name":"Suic"},"score":0,"creation_date":1672913683,"post_id":75016408,"comment_id":132381776,"body_markdown":"I did check this out and tested it but it seems like it&#39;s half broken even with 0 modifications to the code (the picking isn&#39;t pixel perfect) and when i tried it with a single triangle it was off by a lot. (btw i didn&#39;t downvote this answer)","body":"I did check this out and tested it but it seems like it&#39;s half broken even with 0 modifications to the code (the picking isn&#39;t pixel perfect) and when i tried it with a single triangle it was off by a lot. (btw i didn&#39;t downvote this answer)"}],"tags":[],"owner":{"account_id":5347179,"reputation":10433,"user_id":4262407,"accept_rate":40,"display_name":"mipa"},"comment_count":1,"down_vote_count":3,"up_vote_count":0,"is_accepted":false,"score":-3,"last_activity_date":1672911613,"creation_date":1672911613,"answer_id":75016408,"question_id":75016039,"body_markdown":"I think the answer to this question may help you. https://stackoverflow.com/questions/50790379/how-to-correctly-obtain-screen-coordinates-of-3d-shape-after-rotation If you can compute the screen coordinates of a 3D shape (triangle) the hit test should then be simple.","title":"Intersect TriangleMesh from screen coordinates in JavaFX","body":"<p>I think the answer to this question may help you. <a href=\"https://stackoverflow.com/questions/50790379/how-to-correctly-obtain-screen-coordinates-of-3d-shape-after-rotation\">How to correctly obtain screen coordinates of 3D shape after rotation</a> If you can compute the screen coordinates of a 3D shape (triangle) the hit test should then be simple.</p>\n"}],"owner":{"account_id":11854454,"reputation":433,"user_id":14999427,"display_name":"Suic"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":85,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":1,"score":0,"last_activity_date":1672915261,"creation_date":1672909666,"question_id":75016039,"body_markdown":"I have a TriangleMesh in javafx and a 2D point in screen space and i want to check whether any triangles in the mesh intersect with that point(basically same as clicking a point in the mesh except that i already have a predefined screen coordinate)\r\n\r\nNote that i don&#39;t care where the intersection happened etc but only the fact whether it intersected or not.\r\n\r\nI did try googling this and found some useful answers, especially one by Jos&#233; Pereda here: https://stackoverflow.com/a/27612786/14999427\r\n\r\nHowever the links are down\r\n\r\nEdit: i did find a working link to it, however it just hardcodes the origin/target and im not sure how to compute these from the 2d screen point\r\n\r\nAnother idea i had was to copy the implementation from openjfx but after some research i figured that i&#39;d have to copy a lot of internals and even then i wasn&#39;t sure if i would get it working so i scrapped that idea.\r\n\r\nGoal: i want to use my mouse to create a rectangle at an arbitrary position in the mesh and then find all triangles that are inside that rectangle (i believe it&#39;s usually called rectangle selection in 3d modeling software)\r\n\r\nUpdate: converting each triangle to 2d screen coordinates using Node#localToScreen and then doing a 2D point inside triangle test works perfectly however it also selects faces that are culled.\r\n\r\nUpdate 2: after also doing the culling myself it works quite well (it&#39;s not perfect but it&#39;s mostly accurate)\r\nCurrent code:\r\n```java\r\nPoint2D v1Screen = view.localToScreen(mesh.getPoints().get(0), mesh.getPoints()\r\n        .get(1), mesh.getPoints().get(2));\r\nPoint2D v2Screen = view.localToScreen(mesh.getPoints().get(3), mesh.getPoints()\r\n        .get(4), mesh.getPoints().get(5));\r\nPoint2D v3Screen = view.localToScreen(mesh.getPoints().get(6), mesh.getPoints()\r\n        .get(7), mesh.getPoints().get(8));\r\nPoint2D point = new Point2D(mouseX, mouseY);\r\nboolean inTriangle = pointInTriangle(point, v1Screen, v2Screen, v3Screen);\r\n// Back-face culling\r\ndouble dxAB = v1Screen.getX() - v2Screen.getX();\r\ndouble dyAB = v1Screen.getY() - v2Screen.getY();\r\ndouble dxCB = v3Screen.getX() - v2Screen.getX();\r\ndouble dyCB = v3Screen.getY() - v2Screen.getY();\r\nboolean culled = ((dxAB * dyCB) - (dyAB * dxCB)) &lt;= 0;\r\nif (inTriangle &amp;&amp; !culled) {\r\n    view.setMaterial(new PhongMaterial(Color.BLUE));\r\n    System.out.println(&quot;Intersected&quot;);\r\n}\r\n```","title":"Intersect TriangleMesh from screen coordinates in JavaFX","body":"<p>I have a TriangleMesh in javafx and a 2D point in screen space and i want to check whether any triangles in the mesh intersect with that point(basically same as clicking a point in the mesh except that i already have a predefined screen coordinate)</p>\n<p>Note that i don't care where the intersection happened etc but only the fact whether it intersected or not.</p>\n<p>I did try googling this and found some useful answers, especially one by Jos√© Pereda here: <a href=\"https://stackoverflow.com/a/27612786/14999427\">https://stackoverflow.com/a/27612786/14999427</a></p>\n<p>However the links are down</p>\n<p>Edit: i did find a working link to it, however it just hardcodes the origin/target and im not sure how to compute these from the 2d screen point</p>\n<p>Another idea i had was to copy the implementation from openjfx but after some research i figured that i'd have to copy a lot of internals and even then i wasn't sure if i would get it working so i scrapped that idea.</p>\n<p>Goal: i want to use my mouse to create a rectangle at an arbitrary position in the mesh and then find all triangles that are inside that rectangle (i believe it's usually called rectangle selection in 3d modeling software)</p>\n<p>Update: converting each triangle to 2d screen coordinates using Node#localToScreen and then doing a 2D point inside triangle test works perfectly however it also selects faces that are culled.</p>\n<p>Update 2: after also doing the culling myself it works quite well (it's not perfect but it's mostly accurate)\nCurrent code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Point2D v1Screen = view.localToScreen(mesh.getPoints().get(0), mesh.getPoints()\n        .get(1), mesh.getPoints().get(2));\nPoint2D v2Screen = view.localToScreen(mesh.getPoints().get(3), mesh.getPoints()\n        .get(4), mesh.getPoints().get(5));\nPoint2D v3Screen = view.localToScreen(mesh.getPoints().get(6), mesh.getPoints()\n        .get(7), mesh.getPoints().get(8));\nPoint2D point = new Point2D(mouseX, mouseY);\nboolean inTriangle = pointInTriangle(point, v1Screen, v2Screen, v3Screen);\n// Back-face culling\ndouble dxAB = v1Screen.getX() - v2Screen.getX();\ndouble dyAB = v1Screen.getY() - v2Screen.getY();\ndouble dxCB = v3Screen.getX() - v2Screen.getX();\ndouble dyCB = v3Screen.getY() - v2Screen.getY();\nboolean culled = ((dxAB * dyCB) - (dyAB * dxCB)) &lt;= 0;\nif (inTriangle &amp;&amp; !culled) {\n    view.setMaterial(new PhongMaterial(Color.BLUE));\n    System.out.println(&quot;Intersected&quot;);\n}\n</code></pre>\n"},{"tags":["java","performance","indexing","elasticsearch"],"answers":[{"comments":[{"owner":{"account_id":2766246,"reputation":175,"user_id":2381893,"display_name":"Perditor"},"score":0,"creation_date":1372008952,"post_id":17168662,"comment_id":25022735,"body_markdown":"It seems to be the right think i intended to do. I overread the mapping stuff because of the confusion about index (in elasticsearch context) and the index in relational databases. Settign for properties indexed = &quot;analyzed&quot; seems to be the right approach. However i still stuck in the problem described above. After some reasearches i found a way to change the mapping but it seems not effecting at all and i have no idea what im doing wrong. Can anybody help me?","body":"It seems to be the right think i intended to do. I overread the mapping stuff because of the confusion about index (in elasticsearch context) and the index in relational databases. Settign for properties indexed = &quot;analyzed&quot; seems to be the right approach. However i still stuck in the problem described above. After some reasearches i found a way to change the mapping but it seems not effecting at all and i have no idea what im doing wrong. Can anybody help me?"}],"tags":[],"owner":{"account_id":2674438,"reputation":35313,"user_id":2311148,"display_name":"cmbaxter"},"comment_count":1,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1371557887,"creation_date":1371557887,"answer_id":17168662,"question_id":17167779,"body_markdown":"I apologize in advance it I don&#39;t understand the question.  Elasticsearch is itself an index based technology (it&#39;s built on top of Lucene which is a build for index based search).  You put documents into Elasticsearch and the individual fields on those documents are indexed and searchable.  You should not have to worry about creating secondary indexes; the fields will be indexed by default (in most cases).\r\n\r\nOne of the differences between Elasticsearch and Solr is that in Solr, you have to specify a schema defining what the fields are on the documents and whether that field will be indexed (available to search against), stored (available as the result of a search) or both.  Elasticsearch does not require an upfront schema, and in lieu of specific mappings for fields, then reasonable defaults are used instead.  I believe that the core fields (string, number, etc..._) are indexed by default, meaning they are available to search against.\r\n\r\nNow in your case, you have a document with a lot of fields on it.  You will probably need to tweak the mappings a bit to only index the fields that you know you might search against.  If you index too much, the size of the index itself will balloon and will not be as fast as if you had a trim index of only the fields you know you will search against.  Also, Lucene loads parts of the index into memory to really enable fast searches.  With a bloated index, you won&#39;t be able to keep as much stuff in memory and your searches will suffer as a result.  You should look at the [Mappings API][1] and the [Core Types][2] section for more info on how to do this.\r\n\r\n\r\n  [1]: http://www.elasticsearch.org/guide/reference/mapping/\r\n  [2]: http://www.elasticsearch.org/guide/reference/mapping/core-types/","title":"ElasticSearch: Secondary indecies on field values using Java-API","body":"<p>I apologize in advance it I don't understand the question.  Elasticsearch is itself an index based technology (it's built on top of Lucene which is a build for index based search).  You put documents into Elasticsearch and the individual fields on those documents are indexed and searchable.  You should not have to worry about creating secondary indexes; the fields will be indexed by default (in most cases).</p>\n\n<p>One of the differences between Elasticsearch and Solr is that in Solr, you have to specify a schema defining what the fields are on the documents and whether that field will be indexed (available to search against), stored (available as the result of a search) or both.  Elasticsearch does not require an upfront schema, and in lieu of specific mappings for fields, then reasonable defaults are used instead.  I believe that the core fields (string, number, etc..._) are indexed by default, meaning they are available to search against.</p>\n\n<p>Now in your case, you have a document with a lot of fields on it.  You will probably need to tweak the mappings a bit to only index the fields that you know you might search against.  If you index too much, the size of the index itself will balloon and will not be as fast as if you had a trim index of only the fields you know you will search against.  Also, Lucene loads parts of the index into memory to really enable fast searches.  With a bloated index, you won't be able to keep as much stuff in memory and your searches will suffer as a result.  You should look at the <a href=\"http://www.elasticsearch.org/guide/reference/mapping/\" rel=\"nofollow\">Mappings API</a> and the <a href=\"http://www.elasticsearch.org/guide/reference/mapping/core-types/\" rel=\"nofollow\">Core Types</a> section for more info on how to do this.</p>\n"}],"owner":{"account_id":2766246,"reputation":175,"user_id":2381893,"display_name":"Perditor"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2234,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":17168662,"answer_count":1,"score":2,"last_activity_date":1672915060,"creation_date":1371555164,"question_id":17167779,"body_markdown":"I&#39;m considering to use ElasticSearch as a search engine for large objects. There are about 500 millions objects on a single machine. For far is Elasticsearch a good solution for executing advanced queries. But a have the problem that i did find any technique to create secondary index on the document fields. Is in elasticsearch a possibility to create a secondary indecies like in MySQL on columns? Or are there any other technologies implemented to accelerate searches on field values? I&#39;m using an single server enviroment and I have to store about 300 fields per row/object. At the moment there are about 500 million object in my database.","title":"ElasticSearch: Secondary indecies on field values using Java-API","body":"<p>I'm considering to use ElasticSearch as a search engine for large objects. There are about 500 millions objects on a single machine. For far is Elasticsearch a good solution for executing advanced queries. But a have the problem that i did find any technique to create secondary index on the document fields. Is in elasticsearch a possibility to create a secondary indecies like in MySQL on columns? Or are there any other technologies implemented to accelerate searches on field values? I'm using an single server enviroment and I have to store about 300 fields per row/object. At the moment there are about 500 million object in my database.</p>\n"},{"tags":["java","spring-boot","rest"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":2,"creation_date":1672915045,"post_id":75017093,"comment_id":132382234,"body_markdown":"No there isn&#39;t. An `@RequestParam` annotated `Map` will automatically have all the request parameters. So unless you define your own object, annotation and `MethodArgumentHandler` this isn&#39;t possible.","body":"No there isn&#39;t. An <code>@RequestParam</code> annotated <code>Map</code> will automatically have all the request parameters. So unless you define your own object, annotation and <code>MethodArgumentHandler</code> this isn&#39;t possible."},{"owner":{"account_id":7816422,"reputation":127,"user_id":5910979,"accept_rate":60,"display_name":"BillUser88"},"score":0,"creation_date":1672933764,"post_id":75017093,"comment_id":132389070,"body_markdown":"Can I combine the MethodArgumentHandler  with the dynamic number of parameters?","body":"Can I combine the MethodArgumentHandler  with the dynamic number of parameters?"},{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":1,"creation_date":1672934278,"post_id":75017093,"comment_id":132389282,"body_markdown":"You can do whatever you want, however simply filtering the known attributes from the map is a lot easier.","body":"You can do whatever you want, however simply filtering the known attributes from the map is a lot easier."}],"owner":{"account_id":7816422,"reputation":127,"user_id":5910979,"accept_rate":60,"display_name":"BillUser88"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":139,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672914905,"creation_date":1672914905,"question_id":75017093,"body_markdown":"I am having a rest call where the front end sends me page and size and also a dynamic number of query parameters in the url. I map them all using this piece of code:\r\n\r\nFrom postman:\r\n\r\n    http://localhost:8080/something/search?page=0&amp;size=10&amp;sort=applicationId,asc&amp;applicationId=name1&amp;applicationId=name2&amp;reference=12345\r\n\r\nThe way I map them:\r\n\r\n    public ResponseEntity&lt;Page&lt;ObjectToReturn&gt;&gt; getObjectWithDynamicCriteria(Pageable pageable, @RequestParam MultiValueMap&lt;String, String&gt; params) \r\n\r\nMy problem with this approach is that both pageable and multivalue map contains the same information about the pageable object.\r\n\r\n    \r\n      Page request [number: 0, size 10, sort: applicationId: ASC]\r\n      params {page=[0], size=[10], sort=[applicationId,asc], applicationId=[name1, name2], reference=[12345]} \r\n\r\nI process the multivalue map values for example the application id and the reference but before I remove the page and size from the map because they already exist in the pageable object.\r\n\r\nIs there any way to have lets say pageable object and multivalue map but the multivalue map to not have the --&gt;  page=[0], size=[10], sort=[applicationId,asc]?\r\n\r\n   \r\n\r\n\r\n\r\n\r\n","title":"How to map seperately dynamic number of query parameters and pageable information in rest call?","body":"<p>I am having a rest call where the front end sends me page and size and also a dynamic number of query parameters in the url. I map them all using this piece of code:</p>\n<p>From postman:</p>\n<pre><code>http://localhost:8080/something/search?page=0&amp;size=10&amp;sort=applicationId,asc&amp;applicationId=name1&amp;applicationId=name2&amp;reference=12345\n</code></pre>\n<p>The way I map them:</p>\n<pre><code>public ResponseEntity&lt;Page&lt;ObjectToReturn&gt;&gt; getObjectWithDynamicCriteria(Pageable pageable, @RequestParam MultiValueMap&lt;String, String&gt; params) \n</code></pre>\n<p>My problem with this approach is that both pageable and multivalue map contains the same information about the pageable object.</p>\n<pre><code>  Page request [number: 0, size 10, sort: applicationId: ASC]\n  params {page=[0], size=[10], sort=[applicationId,asc], applicationId=[name1, name2], reference=[12345]} \n</code></pre>\n<p>I process the multivalue map values for example the application id and the reference but before I remove the page and size from the map because they already exist in the pageable object.</p>\n<p>Is there any way to have lets say pageable object and multivalue map but the multivalue map to not have the --&gt;  page=[0], size=[10], sort=[applicationId,asc]?</p>\n"},{"tags":["java","compare","migration","java-7","comparator"],"comments":[{"owner":{"account_id":247613,"reputation":284089,"user_id":522444,"accept_rate":100,"display_name":"Hovercraft Full Of Eels"},"score":0,"creation_date":1342041790,"post_id":11441666,"comment_id":15097492,"body_markdown":"What line of code causes this Exception to be thrown? What&#39;s on lines 835 and 453 of ComparableTimSort.java?","body":"What line of code causes this Exception to be thrown? What&#39;s on lines 835 and 453 of ComparableTimSort.java?"},{"owner":{"account_id":360576,"reputation":60355,"user_id":702638,"accept_rate":98,"display_name":"Hunter McMillen"},"score":0,"creation_date":1342041862,"post_id":11441666,"comment_id":15097520,"body_markdown":"It seems to me that you should have this method delegate to the `Card` class: `return card1.compareTo(card2)` and implement this logic there.","body":"It seems to me that you should have this method delegate to the <code>Card</code> class: <code>return card1.compareTo(card2)</code> and implement this logic there."},{"owner":{"account_id":1521093,"reputation":3980,"user_id":1420715,"accept_rate":89,"display_name":"Lakatos Gyula"},"score":2,"creation_date":1342042373,"post_id":11441666,"comment_id":15097722,"body_markdown":"@HovercraftFullOfEels It&#39;s a class from Oracle, not wroted by me. It&#39;s thows an exception on that line. The method is very long and looks hard to understand.","body":"@HovercraftFullOfEels It&#39;s a class from Oracle, not wroted by me. It&#39;s thows an exception on that line. The method is very long and looks hard to understand."},{"owner":{"account_id":1521093,"reputation":3980,"user_id":1420715,"accept_rate":89,"display_name":"Lakatos Gyula"},"score":0,"creation_date":1342042476,"post_id":11441666,"comment_id":15097760,"body_markdown":"@HunterMcMillen I can&#39;t do that. Card only contains the static data of a card (name, text etc...) while this class contains some changing variables like type and amount.","body":"@HunterMcMillen I can&#39;t do that. Card only contains the static data of a card (name, text etc...) while this class contains some changing variables like type and amount."},{"owner":{"account_id":283609,"reputation":45044,"user_id":581205,"accept_rate":72,"display_name":"maaartinus"},"score":0,"creation_date":1409581485,"post_id":11441666,"comment_id":40003156,"body_markdown":"I really wonder what makes you to write such a weird asymmetrical and unreadable `compareTo`???","body":"I really wonder what makes you to write such a weird asymmetrical and unreadable <code>compareTo</code>???"},{"owner":{"account_id":1521093,"reputation":3980,"user_id":1420715,"accept_rate":89,"display_name":"Lakatos Gyula"},"score":1,"creation_date":1409640921,"post_id":11441666,"comment_id":40020619,"body_markdown":"After reading the Clean Code book I don&#39;t know either.","body":"After reading the Clean Code book I don&#39;t know either."},{"owner":{"account_id":8235,"reputation":87020,"user_id":14731,"accept_rate":89,"display_name":"Gili"},"score":0,"creation_date":1453847193,"post_id":11441666,"comment_id":57777123,"body_markdown":"Possible duplicate of [&quot;Comparison method violates its general contract!&quot;](http://stackoverflow.com/questions/8327514/comparison-method-violates-its-general-contract)","body":"Possible duplicate of <a href=\"http://stackoverflow.com/questions/8327514/comparison-method-violates-its-general-contract\">&quot;Comparison method violates its general contract!&quot;</a>"}],"answers":[{"comments":[{"owner":{"account_id":11209,"reputation":25528,"user_id":21499,"accept_rate":56,"display_name":"Dr. Hans-Peter St&#246;rr"},"score":17,"creation_date":1406270408,"post_id":11441813,"comment_id":38775853,"body_markdown":"Actually, the example you given does not violate transitivity, but the rule sgn(compare(x, y)) == -sgn(compare(y, x)) as stated in  http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html#compare(T,%20T) - that&#39;s antisymmetry in mathematical terms.","body":"Actually, the example you given does not violate transitivity, but the rule sgn(compare(x, y)) == -sgn(compare(y, x)) as stated in  <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html#compare(T,%20T)\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/7/docs/api/java/util/&hellip;</a> - that&#39;s antisymmetry in mathematical terms."},{"owner":{"account_id":283609,"reputation":45044,"user_id":581205,"accept_rate":72,"display_name":"maaartinus"},"score":1,"creation_date":1409581374,"post_id":11441813,"comment_id":40003093,"body_markdown":"I&#39;d suggest to use `if (card1.getSet() != card2.getSet()) return card1.getSet() &gt; card2.getSet() ? 1 : -1;` for more speed, if someone cares.","body":"I&#39;d suggest to use <code>if (card1.getSet() != card2.getSet()) return card1.getSet() &gt; card2.getSet() ? 1 : -1;</code> for more speed, if someone cares."},{"owner":{"account_id":401940,"reputation":13996,"user_id":768795,"display_name":"Thomas W"},"score":0,"creation_date":1476322937,"post_id":11441813,"comment_id":67299841,"body_markdown":"I encountered this and it was a **symmetry** issue in my Comparator. The hard part to diagnose was that my weakness was the first field (a boolean field check, not a proper comparison) which did not check for both being true correct. This was only exposed, however, after I added a subsequent subordinate comparison which must have perturbed the sort order.","body":"I encountered this and it was a <b>symmetry</b> issue in my Comparator. The hard part to diagnose was that my weakness was the first field (a boolean field check, not a proper comparison) which did not check for both being true correct. This was only exposed, however, after I added a subsequent subordinate comparison which must have perturbed the sort order."},{"owner":{"account_id":397001,"reputation":8330,"user_id":760893,"accept_rate":90,"display_name":"Sonhja"},"score":1,"creation_date":1490773849,"post_id":11441813,"comment_id":73256850,"body_markdown":"@maaartinus thanks for your suggestion! It was perfect for me :)","body":"@maaartinus thanks for your suggestion! It was perfect for me :)"}],"tags":[],"owner":{"account_id":299251,"reputation":335925,"user_id":605744,"accept_rate":100,"display_name":"Tomasz Nurkiewicz"},"comment_count":4,"down_vote_count":0,"up_vote_count":130,"is_accepted":true,"score":130,"last_activity_date":1342043373,"creation_date":1342042300,"answer_id":11441813,"question_id":11441666,"body_markdown":"The exception message is actually pretty descriptive. The contract it mentions is *transitivity*: if `A &gt; B` and `B &gt; C` then for any `A`, `B` and `C`: `A &gt; C`. I checked it with paper and pencil and your code seems to have few holes:\r\n\r\n    if (card1.getRarity() &lt; card2.getRarity()) {\r\n      return 1;\r\n\r\nyou do not return `-1` if `card1.getRarity() &gt; card2.getRarity()`.\r\n\r\n---\r\n\r\n    if (card1.getId() == card2.getId()) {\r\n      //...\r\n    }\r\n    return -1;\r\n\r\nYou return `-1` if ids aren&#39;t equal. You should return `-1` or `1` depending on which id was bigger.\r\n\r\n---\r\n\r\nTake a look at this. Apart from being much more readable, I think it should actually work:\r\n\r\n\tif (card1.getSet() &gt; card2.getSet()) {\r\n\t\treturn 1;\r\n\t}\r\n\tif (card1.getSet() &lt; card2.getSet()) {\r\n\t\treturn -1;\r\n\t};\r\n\tif (card1.getRarity() &lt; card2.getRarity()) {\r\n\t\treturn 1;\r\n\t}\r\n\tif (card1.getRarity() &gt; card2.getRarity()) {\r\n\t\treturn -1;\r\n\t}\r\n\tif (card1.getId() &gt; card2.getId()) {\r\n\t\treturn 1;\r\n\t}\r\n\tif (card1.getId() &lt; card2.getId()) {\r\n\t\treturn -1;\r\n\t}\r\n\treturn cardType - item.getCardType();  //watch out for overflow!","title":"Java error: Comparison method violates its general contract","body":"<p>The exception message is actually pretty descriptive. The contract it mentions is <em>transitivity</em>: if <code>A &gt; B</code> and <code>B &gt; C</code> then for any <code>A</code>, <code>B</code> and <code>C</code>: <code>A &gt; C</code>. I checked it with paper and pencil and your code seems to have few holes:</p>\n\n<pre><code>if (card1.getRarity() &lt; card2.getRarity()) {\n  return 1;\n</code></pre>\n\n<p>you do not return <code>-1</code> if <code>card1.getRarity() &gt; card2.getRarity()</code>.</p>\n\n<hr>\n\n<pre><code>if (card1.getId() == card2.getId()) {\n  //...\n}\nreturn -1;\n</code></pre>\n\n<p>You return <code>-1</code> if ids aren't equal. You should return <code>-1</code> or <code>1</code> depending on which id was bigger.</p>\n\n<hr>\n\n<p>Take a look at this. Apart from being much more readable, I think it should actually work:</p>\n\n<pre><code>if (card1.getSet() &gt; card2.getSet()) {\n    return 1;\n}\nif (card1.getSet() &lt; card2.getSet()) {\n    return -1;\n};\nif (card1.getRarity() &lt; card2.getRarity()) {\n    return 1;\n}\nif (card1.getRarity() &gt; card2.getRarity()) {\n    return -1;\n}\nif (card1.getId() &gt; card2.getId()) {\n    return 1;\n}\nif (card1.getId() &lt; card2.getId()) {\n    return -1;\n}\nreturn cardType - item.getCardType();  //watch out for overflow!\n</code></pre>\n"},{"tags":[],"owner":{"account_id":921430,"reputation":7972,"user_id":953068,"accept_rate":59,"display_name":"Joe"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1375259026,"creation_date":1342042501,"answer_id":11441860,"question_id":11441666,"body_markdown":"            if (card1.getRarity() &lt; card2.getRarity()) {\r\n                return 1;\r\n\r\nHowever, if `card2.getRarity()` is less than `card1.getRarity()` you might not return **-1**.\r\n\r\nYou similarly miss other cases.  I would do this, you can change around depending on your intent:\r\n\r\n    public int compareTo(Object o) {\t\r\n        if(this == o){\r\n            return 0;\r\n        }\r\n    \r\n        CollectionItem item = (CollectionItem) o;\r\n    \r\n        Card card1 = CardCache.getInstance().getCard(cardId);\r\n        Card card2 = CardCache.getInstance().getCard(item.getCardId());\r\n    \tint comp=card1.getSet() - card2.getSet();\r\n    \tif (comp!=0){\r\n    \t\treturn comp;\r\n    \t}\r\n    \tcomp=card1.getRarity() - card2.getRarity();\r\n    \tif (comp!=0){\r\n    \t\treturn comp;\r\n    \t}\r\n    \tcomp=card1.getSet() - card2.getSet();\r\n    \tif (comp!=0){\r\n    \t\treturn comp;\r\n    \t}\t\r\n    \tcomp=card1.getId() - card2.getId();\r\n    \tif (comp!=0){\r\n    \t\treturn comp;\r\n    \t}\t\r\n    \tcomp=card1.getCardType() - card2.getCardType();\r\n    \r\n    \treturn comp;\r\n    \t\r\n        }\r\n    }","title":"Java error: Comparison method violates its general contract","body":"<pre><code>        if (card1.getRarity() &lt; card2.getRarity()) {\n            return 1;\n</code></pre>\n\n<p>However, if <code>card2.getRarity()</code> is less than <code>card1.getRarity()</code> you might not return <strong>-1</strong>.</p>\n\n<p>You similarly miss other cases.  I would do this, you can change around depending on your intent:</p>\n\n<pre><code>public int compareTo(Object o) {    \n    if(this == o){\n        return 0;\n    }\n\n    CollectionItem item = (CollectionItem) o;\n\n    Card card1 = CardCache.getInstance().getCard(cardId);\n    Card card2 = CardCache.getInstance().getCard(item.getCardId());\n    int comp=card1.getSet() - card2.getSet();\n    if (comp!=0){\n        return comp;\n    }\n    comp=card1.getRarity() - card2.getRarity();\n    if (comp!=0){\n        return comp;\n    }\n    comp=card1.getSet() - card2.getSet();\n    if (comp!=0){\n        return comp;\n    }   \n    comp=card1.getId() - card2.getId();\n    if (comp!=0){\n        return comp;\n    }   \n    comp=card1.getCardType() - card2.getCardType();\n\n    return comp;\n\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":13062,"reputation":21722,"user_id":26039,"accept_rate":82,"display_name":"Eran"},"comment_count":0,"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1342042558,"creation_date":1342042558,"answer_id":11441871,"question_id":11441666,"body_markdown":"Consider the following case:\r\n\r\nFirst, `o1.compareTo(o2)` is called. `card1.getSet() == card2.getSet()` happens to be true and so is `card1.getRarity() &lt; card2.getRarity()`, so you return 1.\r\n\r\nThen, `o2.compareTo(o1)` is called. Again, `card1.getSet() == card2.getSet()` is true. Then, you skip to the following `else`, then `card1.getId() == card2.getId()` happens to be true, and so is `cardType &gt; item.getCardType()`. You return 1 again.\r\n\r\nFrom that, `o1 &gt; o2`, and `o2 &gt; o1`. You broke the contract.","title":"Java error: Comparison method violates its general contract","body":"<p>Consider the following case:</p>\n\n<p>First, <code>o1.compareTo(o2)</code> is called. <code>card1.getSet() == card2.getSet()</code> happens to be true and so is <code>card1.getRarity() &lt; card2.getRarity()</code>, so you return 1.</p>\n\n<p>Then, <code>o2.compareTo(o1)</code> is called. Again, <code>card1.getSet() == card2.getSet()</code> is true. Then, you skip to the following <code>else</code>, then <code>card1.getId() == card2.getId()</code> happens to be true, and so is <code>cardType &gt; item.getCardType()</code>. You return 1 again.</p>\n\n<p>From that, <code>o1 &gt; o2</code>, and <code>o2 &gt; o1</code>. You broke the contract.</p>\n"},{"comments":[{"owner":{"account_id":11209,"reputation":25528,"user_id":21499,"accept_rate":56,"display_name":"Dr. Hans-Peter St&#246;rr"},"score":13,"creation_date":1406270533,"post_id":20236925,"comment_id":38775910,"body_markdown":"That should only be used as a quick and ugly workaround to make things work again until you fix the comparator. If the exception happens it means you comparator is buggy and the sort order will be weird. You have to consider all the rules given in http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html#compare(T,%20T) .","body":"That should only be used as a quick and ugly workaround to make things work again until you fix the comparator. If the exception happens it means you comparator is buggy and the sort order will be weird. You have to consider all the rules given in <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html#compare(T,%20T)\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/7/docs/api/java/util/&hellip;</a> ."},{"owner":{"account_id":2222305,"reputation":2537,"user_id":1961413,"accept_rate":86,"display_name":"Jefferey Cave"},"score":0,"creation_date":1452899468,"post_id":20236925,"comment_id":57385338,"body_markdown":"What if &quot;weird&quot; is what I was going for? `(a,b) -&gt; { return (new int[]{-1,1})[(int)((Math.random()*2)%2)]}` I know `Collections.shuffle` exists, but I dislike being over-protected.","body":"What if &quot;weird&quot; is what I was going for? <code>(a,b) -&gt; { return (new int[]{-1,1})[(int)((Math.random()*2)%2)]}</code> I know <code>Collections.shuffle</code> exists, but I dislike being over-protected."},{"owner":{"account_id":7916982,"reputation":313,"user_id":5979115,"display_name":"Stefano Scarpanti"},"score":0,"creation_date":1579518553,"post_id":20236925,"comment_id":105781113,"body_markdown":"I have an old application and with JDK8 I got this error. Using JDK6 it works correctly, so I simply downgrade to 6, thanks.","body":"I have an old application and with JDK8 I got this error. Using JDK6 it works correctly, so I simply downgrade to 6, thanks."}],"tags":[],"owner":{"account_id":3375818,"reputation":893,"user_id":2833957,"display_name":"Justin Civi"},"comment_count":3,"down_vote_count":0,"up_vote_count":42,"is_accepted":false,"score":42,"last_activity_date":1471528734,"creation_date":1385539504,"answer_id":20236925,"question_id":11441666,"body_markdown":"It also has something to do with the version of JDK.\r\nIf it does well in JDK6, maybe it will have the problem in JDK 7 described by you, because the implementation method in jdk 7 has been changed.\r\n\r\nLook at this:\r\n\r\nDescription: The sorting algorithm used by `java.util.Arrays.sort` and (indirectly) by `java.util.Collections.sort` has been replaced. The new sort implementation may throw an `IllegalArgumentException` if it detects a `Comparable` that violates the `Comparable` contract. The previous implementation silently ignored such a situation. If the previous behavior is desired, you can use the new system property, `java.util.Arrays.useLegacyMergeSort`, to restore previous mergesort behaviour.\r\n\r\nI don&#39;t know the exact reason. However, if you add the code before you use sort. It will be OK.\r\n\r\n    System.setProperty(&quot;java.util.Arrays.useLegacyMergeSort&quot;, &quot;true&quot;);","title":"Java error: Comparison method violates its general contract","body":"<p>It also has something to do with the version of JDK.\nIf it does well in JDK6, maybe it will have the problem in JDK 7 described by you, because the implementation method in jdk 7 has been changed.</p>\n\n<p>Look at this:</p>\n\n<p>Description: The sorting algorithm used by <code>java.util.Arrays.sort</code> and (indirectly) by <code>java.util.Collections.sort</code> has been replaced. The new sort implementation may throw an <code>IllegalArgumentException</code> if it detects a <code>Comparable</code> that violates the <code>Comparable</code> contract. The previous implementation silently ignored such a situation. If the previous behavior is desired, you can use the new system property, <code>java.util.Arrays.useLegacyMergeSort</code>, to restore previous mergesort behaviour.</p>\n\n<p>I don't know the exact reason. However, if you add the code before you use sort. It will be OK.</p>\n\n<pre><code>System.setProperty(\"java.util.Arrays.useLegacyMergeSort\", \"true\");\n</code></pre>\n"},{"comments":[{"owner":{"account_id":7361187,"reputation":91,"user_id":5604419,"display_name":"Olaf Achthoven"},"score":5,"creation_date":1455543731,"post_id":35000727,"comment_id":58522463,"body_markdown":"This code validates compare(a,b) = - compare(b, c). It does not check that if  compare(a,b) &gt; 0 &amp;&amp; compare(b,c) &gt; 0 then compare(a,c) &gt; 0","body":"This code validates compare(a,b) = - compare(b, c). It does not check that if  compare(a,b) &gt; 0 &amp;&amp; compare(b,c) &gt; 0 then compare(a,c) &gt; 0"},{"owner":{"account_id":4115446,"reputation":1122,"user_id":3377123,"display_name":"doctorram"},"score":0,"creation_date":1651847159,"post_id":35000727,"comment_id":127468464,"body_markdown":"Beware this can be very slow.  We got a few ANRs using this.","body":"Beware this can be very slow.  We got a few ANRs using this."}],"tags":[],"owner":{"account_id":8235,"reputation":87020,"user_id":14731,"accept_rate":89,"display_name":"Gili"},"comment_count":2,"down_vote_count":1,"up_vote_count":63,"is_accepted":false,"score":62,"last_activity_date":1455556581,"creation_date":1453750161,"answer_id":35000727,"question_id":11441666,"body_markdown":"You can use the following class to pinpoint transitivity bugs in your Comparators:\r\n\r\n    /**\r\n     * @author Gili Tzabari\r\n     */\r\n    public final class Comparators\r\n    {\r\n    \t/**\r\n    \t * Verify that a comparator is transitive.\r\n    \t *\r\n    \t * @param &lt;T&gt;        the type being compared\r\n    \t * @param comparator the comparator to test\r\n    \t * @param elements   the elements to test against\r\n    \t * @throws AssertionError if the comparator is not transitive\r\n    \t */\r\n    \tpublic static &lt;T&gt; void verifyTransitivity(Comparator&lt;T&gt; comparator, Collection&lt;T&gt; elements)\r\n    \t{\r\n    \t\tfor (T first: elements)\r\n    \t\t{\r\n    \t\t\tfor (T second: elements)\r\n    \t\t\t{\r\n    \t\t\t\tint result1 = comparator.compare(first, second);\r\n    \t\t\t\tint result2 = comparator.compare(second, first);\r\n    \t\t\t\tif (result1 != -result2)\r\n    \t\t\t\t{\r\n    \t\t\t\t\t// Uncomment the following line to step through the failed case\r\n    \t\t\t\t\t//comparator.compare(first, second);\r\n    \t\t\t\t\tthrow new AssertionError(&quot;compare(&quot; + first + &quot;, &quot; + second + &quot;) == &quot; + result1 +\r\n    \t\t\t\t\t\t&quot; but swapping the parameters returns &quot; + result2);\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n    \t\t}\r\n\t\t\tfor (T first: elements)\r\n\t\t\t{\r\n\t\t\t\tfor (T second: elements)\r\n\t\t\t\t{\r\n\t\t\t\t\tint firstGreaterThanSecond = comparator.compare(first, second);\r\n\t\t\t\t\tif (firstGreaterThanSecond &lt;= 0)\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\tfor (T third: elements)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tint secondGreaterThanThird = comparator.compare(second, third);\r\n\t\t\t\t\t\tif (secondGreaterThanThird &lt;= 0)\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\tint firstGreaterThanThird = comparator.compare(first, third);\r\n\t\t\t\t\t\tif (firstGreaterThanThird &lt;= 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t// Uncomment the following line to step through the failed case\r\n\t\t\t\t\t\t\t//comparator.compare(first, third);\r\n\t\t\t\t\t\t\tthrow new AssertionError(&quot;compare(&quot; + first + &quot;, &quot; + second + &quot;) &gt; 0, &quot; +\r\n\t\t\t\t\t\t\t\t&quot;compare(&quot; + second + &quot;, &quot; + third + &quot;) &gt; 0, but compare(&quot; + first + &quot;, &quot; + third + &quot;) == &quot; +\r\n\t\t\t\t\t\t\t\tfirstGreaterThanThird);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n    \t}\r\n    \r\n    \t/**\r\n    \t * Prevent construction.\r\n    \t */\r\n    \tprivate Comparators()\r\n    \t{\r\n    \t}\r\n    }\r\n\r\nSimply invoke `Comparators.verifyTransitivity(myComparator, myCollection)` in front of the code that fails.","title":"Java error: Comparison method violates its general contract","body":"<p>You can use the following class to pinpoint transitivity bugs in your Comparators:</p>\n\n<pre><code>/**\n * @author Gili Tzabari\n */\npublic final class Comparators\n{\n    /**\n     * Verify that a comparator is transitive.\n     *\n     * @param &lt;T&gt;        the type being compared\n     * @param comparator the comparator to test\n     * @param elements   the elements to test against\n     * @throws AssertionError if the comparator is not transitive\n     */\n    public static &lt;T&gt; void verifyTransitivity(Comparator&lt;T&gt; comparator, Collection&lt;T&gt; elements)\n    {\n        for (T first: elements)\n        {\n            for (T second: elements)\n            {\n                int result1 = comparator.compare(first, second);\n                int result2 = comparator.compare(second, first);\n                if (result1 != -result2)\n                {\n                    // Uncomment the following line to step through the failed case\n                    //comparator.compare(first, second);\n                    throw new AssertionError(\"compare(\" + first + \", \" + second + \") == \" + result1 +\n                        \" but swapping the parameters returns \" + result2);\n                }\n            }\n        }\n        for (T first: elements)\n        {\n            for (T second: elements)\n            {\n                int firstGreaterThanSecond = comparator.compare(first, second);\n                if (firstGreaterThanSecond &lt;= 0)\n                    continue;\n                for (T third: elements)\n                {\n                    int secondGreaterThanThird = comparator.compare(second, third);\n                    if (secondGreaterThanThird &lt;= 0)\n                        continue;\n                    int firstGreaterThanThird = comparator.compare(first, third);\n                    if (firstGreaterThanThird &lt;= 0)\n                    {\n                        // Uncomment the following line to step through the failed case\n                        //comparator.compare(first, third);\n                        throw new AssertionError(\"compare(\" + first + \", \" + second + \") &gt; 0, \" +\n                            \"compare(\" + second + \", \" + third + \") &gt; 0, but compare(\" + first + \", \" + third + \") == \" +\n                            firstGreaterThanThird);\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Prevent construction.\n     */\n    private Comparators()\n    {\n    }\n}\n</code></pre>\n\n<p>Simply invoke <code>Comparators.verifyTransitivity(myComparator, myCollection)</code> in front of the code that fails.</p>\n"},{"tags":[],"owner":{"account_id":11679359,"reputation":1,"user_id":8551666,"display_name":"Jean Burkhardt"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1520494007,"creation_date":1504353536,"answer_id":46013525,"question_id":11441666,"body_markdown":"I had to sort on several criterion (date, and, if same date; other things...). What was working on Eclipse with an older version of Java, did not worked any more on Android : comparison method violates contract ...\r\n\r\nAfter reading on StackOverflow, I wrote a separate function that I called from compare() if the dates are the same. This function calculates the priority, according to the criteria, and returns -1, 0, or 1 to compare(). It seems to work now. ","title":"Java error: Comparison method violates its general contract","body":"<p>I had to sort on several criterion (date, and, if same date; other things...). What was working on Eclipse with an older version of Java, did not worked any more on Android : comparison method violates contract ...</p>\n\n<p>After reading on StackOverflow, I wrote a separate function that I called from compare() if the dates are the same. This function calculates the priority, according to the criteria, and returns -1, 0, or 1 to compare(). It seems to work now. </p>\n"},{"tags":[],"owner":{"account_id":5379962,"reputation":941,"user_id":4285515,"display_name":"pmkent"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1523239755,"creation_date":1523238369,"answer_id":49724518,"question_id":11441666,"body_markdown":"I got the same error with a class like the following `StockPickBean`. Called from this code:\r\n\r\n    List&lt;StockPickBean&gt; beansListcatMap.getValue();\r\n    beansList.sort(StockPickBean.Comparators.VALUE);\r\n\r\n    public class StockPickBean implements Comparable&lt;StockPickBean&gt; {\r\n        private double value;\r\n        public double getValue() { return value; }\r\n        public void setValue(double value) { this.value = value; }\r\n       \r\n        @Override\r\n        public int compareTo(StockPickBean view) {\r\n            return Comparators.VALUE.compare(this,view); //return \r\n            Comparators.SYMBOL.compare(this,view);\r\n        }\r\n    \r\n        public static class Comparators {\r\n            public static Comparator&lt;StockPickBean&gt; VALUE = (val1, val2) -&gt; \r\n    (int) \r\n             (val1.value - val2.value);\r\n        }\r\n    }\r\n\r\nAfter getting the same error: \r\n\r\n&gt; java.lang.IllegalArgumentException: Comparison method violates its general contract!\r\n\r\nI changed this line:\r\n\r\n    public static Comparator&lt;StockPickBean&gt; VALUE = (val1, val2) -&gt; (int) \r\n             (val1.value - val2.value);\r\n\r\nto:\r\n\r\n    public static Comparator&lt;StockPickBean&gt; VALUE = (StockPickBean spb1, \r\n    StockPickBean spb2) -&gt; Double.compare(spb2.value,spb1.value);\r\n\r\nThat fixes the error.","title":"Java error: Comparison method violates its general contract","body":"<p>I got the same error with a class like the following <code>StockPickBean</code>. Called from this code:</p>\n\n<pre><code>List&lt;StockPickBean&gt; beansListcatMap.getValue();\nbeansList.sort(StockPickBean.Comparators.VALUE);\n\npublic class StockPickBean implements Comparable&lt;StockPickBean&gt; {\n    private double value;\n    public double getValue() { return value; }\n    public void setValue(double value) { this.value = value; }\n\n    @Override\n    public int compareTo(StockPickBean view) {\n        return Comparators.VALUE.compare(this,view); //return \n        Comparators.SYMBOL.compare(this,view);\n    }\n\n    public static class Comparators {\n        public static Comparator&lt;StockPickBean&gt; VALUE = (val1, val2) -&gt; \n(int) \n         (val1.value - val2.value);\n    }\n}\n</code></pre>\n\n<p>After getting the same error: </p>\n\n<blockquote>\n  <p>java.lang.IllegalArgumentException: Comparison method violates its general contract!</p>\n</blockquote>\n\n<p>I changed this line:</p>\n\n<pre><code>public static Comparator&lt;StockPickBean&gt; VALUE = (val1, val2) -&gt; (int) \n         (val1.value - val2.value);\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>public static Comparator&lt;StockPickBean&gt; VALUE = (StockPickBean spb1, \nStockPickBean spb2) -&gt; Double.compare(spb2.value,spb1.value);\n</code></pre>\n\n<p>That fixes the error.</p>\n"},{"comments":[{"owner":{"account_id":2575220,"reputation":3130,"user_id":2233069,"accept_rate":25,"display_name":"djdance"},"score":0,"creation_date":1635450184,"post_id":59478121,"comment_id":123308961,"body_markdown":"It works also for Collections.sort","body":"It works also for Collections.sort"}],"tags":[],"owner":{"account_id":3153911,"reputation":765,"user_id":2666708,"display_name":"Prateek Bhuwania"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1577274517,"creation_date":1577274517,"answer_id":59478121,"question_id":11441666,"body_markdown":"I ran into a similar problem where I was trying to sort a `n x 2 2D array` named `contests` which is a 2D array of simple integers. This was working for most of the times but threw a runtime error for one input:-\r\n```        \r\nArrays.sort(contests, (row1, row2) -&gt; {\r\n            if (row1[0] &lt; row2[0]) {\r\n                return 1;\r\n            } else return -1;\r\n        });\r\n```\r\n\r\nError:-\r\n\r\n    Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: Comparison method violates its general contract!\r\n    \tat java.base/java.util.TimSort.mergeHi(TimSort.java:903)\r\n    \tat java.base/java.util.TimSort.mergeAt(TimSort.java:520)\r\n    \tat java.base/java.util.TimSort.mergeForceCollapse(TimSort.java:461)\r\n    \tat java.base/java.util.TimSort.sort(TimSort.java:254)\r\n    \tat java.base/java.util.Arrays.sort(Arrays.java:1441)\r\n    \tat com.hackerrank.Solution.luckBalance(Solution.java:15)\r\n    \tat com.hackerrank.Solution.main(Solution.java:49)\r\n\r\nLooking at the answers above I tried adding a condition for `equals` and I don&#39;t know why but it worked. Hopefully we must explicitly specify what should be returned for all cases (greater than, equals and less than):\r\n```\r\n        Arrays.sort(contests, (row1, row2) -&gt; {\r\n            if (row1[0] &lt; row2[0]) {\r\n                return 1;\r\n            }\r\n            if(row1[0] == row2[0]) return 0;\r\n            return -1;\r\n        });\r\n```","title":"Java error: Comparison method violates its general contract","body":"<p>I ran into a similar problem where I was trying to sort a <code>n x 2 2D array</code> named <code>contests</code> which is a 2D array of simple integers. This was working for most of the times but threw a runtime error for one input:-</p>\n\n<pre><code>Arrays.sort(contests, (row1, row2) -&gt; {\n            if (row1[0] &lt; row2[0]) {\n                return 1;\n            } else return -1;\n        });\n</code></pre>\n\n<p>Error:-</p>\n\n<pre><code>Exception in thread \"main\" java.lang.IllegalArgumentException: Comparison method violates its general contract!\n    at java.base/java.util.TimSort.mergeHi(TimSort.java:903)\n    at java.base/java.util.TimSort.mergeAt(TimSort.java:520)\n    at java.base/java.util.TimSort.mergeForceCollapse(TimSort.java:461)\n    at java.base/java.util.TimSort.sort(TimSort.java:254)\n    at java.base/java.util.Arrays.sort(Arrays.java:1441)\n    at com.hackerrank.Solution.luckBalance(Solution.java:15)\n    at com.hackerrank.Solution.main(Solution.java:49)\n</code></pre>\n\n<p>Looking at the answers above I tried adding a condition for <code>equals</code> and I don't know why but it worked. Hopefully we must explicitly specify what should be returned for all cases (greater than, equals and less than):</p>\n\n<pre><code>        Arrays.sort(contests, (row1, row2) -&gt; {\n            if (row1[0] &lt; row2[0]) {\n                return 1;\n            }\n            if(row1[0] == row2[0]) return 0;\n            return -1;\n        });\n</code></pre>\n"},{"tags":[],"owner":{"account_id":137615,"reputation":910,"user_id":341919,"accept_rate":75,"display_name":"Carl Rosenberger"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1591555439,"creation_date":1591555439,"answer_id":62250048,"question_id":11441666,"body_markdown":"I had the same symptom. For me it turned out that another thread was modifying the compared objects while the sorting was happening in a Stream. To resolve the issue, I mapped the objects to immutable temporary objects, collected the Stream to a temporary Collection and did the sorting on that.","title":"Java error: Comparison method violates its general contract","body":"<p>I had the same symptom. For me it turned out that another thread was modifying the compared objects while the sorting was happening in a Stream. To resolve the issue, I mapped the objects to immutable temporary objects, collected the Stream to a temporary Collection and did the sorting on that.</p>\n"},{"tags":[],"owner":{"account_id":3667837,"reputation":2435,"user_id":3055724,"display_name":"Duloren"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1647633826,"creation_date":1647633826,"answer_id":71532607,"question_id":11441666,"body_markdown":"The origin of this exception is a wrong `Comparator` implementation. By [checking the docs][1], we must implement the `compare(o1, o2)` method as an [equivalence relation][2] by following the rules:\r\n\r\n- `if` a.equals(b) is `true` `then` compare(a, b) is `0`\r\n- `if` a.compare(b) &gt; 0 `then` b.compare(a) &lt; 0 is `true`\r\n- `if` a.compare(b) &gt; 0 and b.compare(c) &gt; 0 `then` a.compare(c) &gt; 0 is `true`\r\n\r\nYou may check your code to realize where your implementation is offending one or more of Comparator contract rules. If it is hard to find it by a static analysis, you can use the data which cast the exception to check the rules. \r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html\r\n  [2]: https://en.wikipedia.org/wiki/Equivalence_relation","title":"Java error: Comparison method violates its general contract","body":"<p>The origin of this exception is a wrong <code>Comparator</code> implementation. By <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html\" rel=\"nofollow noreferrer\">checking the docs</a>, we must implement the <code>compare(o1, o2)</code> method as an <a href=\"https://en.wikipedia.org/wiki/Equivalence_relation\" rel=\"nofollow noreferrer\">equivalence relation</a> by following the rules:</p>\n<ul>\n<li><code>if</code> a.equals(b) is <code>true</code> <code>then</code> compare(a, b) is <code>0</code></li>\n<li><code>if</code> a.compare(b) &gt; 0 <code>then</code> b.compare(a) &lt; 0 is <code>true</code></li>\n<li><code>if</code> a.compare(b) &gt; 0 and b.compare(c) &gt; 0 <code>then</code> a.compare(c) &gt; 0 is <code>true</code></li>\n</ul>\n<p>You may check your code to realize where your implementation is offending one or more of Comparator contract rules. If it is hard to find it by a static analysis, you can use the data which cast the exception to check the rules.</p>\n"},{"tags":[],"owner":{"account_id":6607573,"reputation":11,"user_id":5103928,"display_name":"Jeffrey Do"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1654612136,"creation_date":1654612136,"answer_id":72532989,"question_id":11441666,"body_markdown":"What about doing something simpler like this:\r\n    \r\n    int result = card1.getSet().compareTo(card2.getSet())\r\n    if (result == 0) {\r\n        result = card1.getRarity().compareTo(card2.getRarity())\r\n    }\r\n    if (result == 0) {\r\n        result = card1.getId().compareTo(card2.getId())\r\n    }\r\n    if (result == 0) {\r\n        result = card1.getCardType().compareTo(card2.getCardType())\r\n    }\r\n    return result;\r\n\r\nYou just need to order the comparisons in order of preference.  ","title":"Java error: Comparison method violates its general contract","body":"<p>What about doing something simpler like this:</p>\n<pre><code>int result = card1.getSet().compareTo(card2.getSet())\nif (result == 0) {\n    result = card1.getRarity().compareTo(card2.getRarity())\n}\nif (result == 0) {\n    result = card1.getId().compareTo(card2.getId())\n}\nif (result == 0) {\n    result = card1.getCardType().compareTo(card2.getCardType())\n}\nreturn result;\n</code></pre>\n<p>You just need to order the comparisons in order of preference.</p>\n"},{"tags":[],"owner":{"account_id":22415217,"reputation":185,"user_id":16623378,"display_name":"Qu·ªëc H&#249;ng"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1660037312,"creation_date":1660037312,"answer_id":73289480,"question_id":11441666,"body_markdown":"If you try to run this code you will meet the kind this exception:\r\n```java\r\n    public static void main(String[] args) {\r\n        Random random = new Random();\r\n        List&lt;Integer&gt; list = new ArrayList&lt;&gt;();\r\n        for (int i = 0; i &lt; 50000; i++) {\r\n            list.add(random.nextInt());\r\n        }\r\n        list.sort((x, y) -&gt; {\r\n            int c = random.nextInt(3);\r\n            if (c == 0) {\r\n                return 0;\r\n            }\r\n            if (c == 1) {\r\n                return 1;\r\n            }\r\n            return -1;\r\n        });\r\n    }\r\n```\r\n```\r\nException in thread &quot;main&quot; java.lang.IllegalArgumentException: Comparison method violates its general contract!\r\n\tat java.util.TimSort.mergeLo(TimSort.java:777)\r\n\tat java.util.TimSort.mergeAt(TimSort.java:514)\r\n\tat java.util.TimSort.mergeCollapse(TimSort.java:441)\r\n\tat java.util.TimSort.sort(TimSort.java:245)\r\n\tat java.util.Arrays.sort(Arrays.java:1512)\r\n\tat java.util.ArrayList.sort(ArrayList.java:1462)\r\n\tat Test.main(Test.java:14)\r\n```\r\nThe reason is when implementing the Comparator, it may meet the case of A &gt; B and B &gt; C and C &gt; A and the sort method will be run around to be broken. Java prevent this case by throw exception this case:\r\n```java\r\nclass TimSort&lt;T&gt; {\r\n.\r\n.\r\n.\r\nelse if (len1 == 0) {\r\n            throw new IllegalArgumentException(\r\n                &quot;Comparison method violates its general contract!&quot;);\r\n.\r\n.\r\n.\r\n```\r\nIn conclusion, to handle this issue. You have to make sure the comparator will not meet the case of A &gt; B and B &gt; C and C &gt; A.\r\n","title":"Java error: Comparison method violates its general contract","body":"<p>If you try to run this code you will meet the kind this exception:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    public static void main(String[] args) {\n        Random random = new Random();\n        List&lt;Integer&gt; list = new ArrayList&lt;&gt;();\n        for (int i = 0; i &lt; 50000; i++) {\n            list.add(random.nextInt());\n        }\n        list.sort((x, y) -&gt; {\n            int c = random.nextInt(3);\n            if (c == 0) {\n                return 0;\n            }\n            if (c == 1) {\n                return 1;\n            }\n            return -1;\n        });\n    }\n</code></pre>\n<pre><code>Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: Comparison method violates its general contract!\n    at java.util.TimSort.mergeLo(TimSort.java:777)\n    at java.util.TimSort.mergeAt(TimSort.java:514)\n    at java.util.TimSort.mergeCollapse(TimSort.java:441)\n    at java.util.TimSort.sort(TimSort.java:245)\n    at java.util.Arrays.sort(Arrays.java:1512)\n    at java.util.ArrayList.sort(ArrayList.java:1462)\n    at Test.main(Test.java:14)\n</code></pre>\n<p>The reason is when implementing the Comparator, it may meet the case of A &gt; B and B &gt; C and C &gt; A and the sort method will be run around to be broken. Java prevent this case by throw exception this case:</p>\n<pre class=\"lang-java prettyprint-override\"><code>class TimSort&lt;T&gt; {\n.\n.\n.\nelse if (len1 == 0) {\n            throw new IllegalArgumentException(\n                &quot;Comparison method violates its general contract!&quot;);\n.\n.\n.\n</code></pre>\n<p>In conclusion, to handle this issue. You have to make sure the comparator will not meet the case of A &gt; B and B &gt; C and C &gt; A.</p>\n"},{"tags":[],"owner":{"account_id":1140418,"reputation":5502,"user_id":1124509,"accept_rate":53,"display_name":"Reto H&#246;hener"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1672914465,"creation_date":1672914465,"answer_id":75017000,"question_id":11441666,"body_markdown":"A variation of Gili&#39;s answer to check if the comparator satisfies the requirements described in the compare method&#39;s javadoc - with a focus on completeness and readability, e.g. by naming the variables the same as in the javadoc. Note that this is O(n^3), only use it when debugging, maybe just on a subset of your elements, in order to be fast enough to finish at all.\r\n\r\n      public static &lt;T&gt; void verifyComparator(Comparator&lt;T&gt; comparator, Collection&lt;T&gt; elements) {\r\n        for (T x : elements) {\r\n          for (T y : elements) {\r\n            for (T z : elements) {\r\n              int x_y = comparator.compare(x, y);\r\n              int y_x = comparator.compare(y, x);\r\n              int y_z = comparator.compare(y, z);\r\n              int x_z = comparator.compare(x, z);\r\n    \r\n              // javadoc: The implementor must ensure that sgn(compare(x, y)) == -sgn(compare(y, x))\r\n              if (Math.signum(x_y) == -Math.signum(y_x)) { // ok\r\n              } else {\r\n                System.err.println(&quot;not holding: sgn(compare(x, y)) == -sgn(compare(y, x))&quot; //\r\n                    + &quot; | x_y: &quot; + x_y + &quot;, y_x: &quot; + y_x + &quot;,  x: &quot; + x + &quot;, y: &quot; + y);\r\n              }\r\n    \r\n              // javadoc: The implementor must also ensure that the relation is transitive:\r\n              // ((compare(x, y)&gt;0) &amp;&amp; (compare(y, z)&gt;0)) implies compare(x, z)&gt;0.\r\n              if (x_y &gt; 0 &amp;&amp; y_z &gt; 0) {\r\n                if (x_z &gt; 0) { // ok\r\n                } else {\r\n                  System.err.println(&quot;not holding: ((compare(x, y)&gt;0) &amp;&amp; (compare(y, z)&gt;0)) implies compare(x, z)&gt;0&quot; //\r\n                      + &quot; | x_y: &quot; + x_y + &quot;, y_z: &quot; + y_z + &quot;,  x_z: &quot; + x_z + &quot;, x: &quot; + x + &quot;, y: &quot; + y + &quot;, z: &quot; + z);\r\n                }\r\n              }\r\n    \r\n              // javadoc: Finally, the implementor must ensure that:\r\n              // compare(x, y)==0 implies that sgn(compare(x, z))==sgn(compare(y, z)) for all z.\r\n              if (x_y == 0) {\r\n                if (Math.signum(x_z) == Math.signum(y_z)) { // ok\r\n                } else {\r\n                  System.err.println(&quot;not holding: compare(x, y)==0 implies that sgn(compare(x, z))==sgn(compare(y, z)) for all z&quot; //\r\n                      + &quot; | x_y: &quot; + x_y + &quot;, x_z: &quot; + x_z + &quot;,  y_z: &quot; + y_z + &quot;, x: &quot; + x + &quot;, y: &quot; + y + &quot;, z: &quot; + z);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }","title":"Java error: Comparison method violates its general contract","body":"<p>A variation of Gili's answer to check if the comparator satisfies the requirements described in the compare method's javadoc - with a focus on completeness and readability, e.g. by naming the variables the same as in the javadoc. Note that this is O(n^3), only use it when debugging, maybe just on a subset of your elements, in order to be fast enough to finish at all.</p>\n<pre><code>  public static &lt;T&gt; void verifyComparator(Comparator&lt;T&gt; comparator, Collection&lt;T&gt; elements) {\n    for (T x : elements) {\n      for (T y : elements) {\n        for (T z : elements) {\n          int x_y = comparator.compare(x, y);\n          int y_x = comparator.compare(y, x);\n          int y_z = comparator.compare(y, z);\n          int x_z = comparator.compare(x, z);\n\n          // javadoc: The implementor must ensure that sgn(compare(x, y)) == -sgn(compare(y, x))\n          if (Math.signum(x_y) == -Math.signum(y_x)) { // ok\n          } else {\n            System.err.println(&quot;not holding: sgn(compare(x, y)) == -sgn(compare(y, x))&quot; //\n                + &quot; | x_y: &quot; + x_y + &quot;, y_x: &quot; + y_x + &quot;,  x: &quot; + x + &quot;, y: &quot; + y);\n          }\n\n          // javadoc: The implementor must also ensure that the relation is transitive:\n          // ((compare(x, y)&gt;0) &amp;&amp; (compare(y, z)&gt;0)) implies compare(x, z)&gt;0.\n          if (x_y &gt; 0 &amp;&amp; y_z &gt; 0) {\n            if (x_z &gt; 0) { // ok\n            } else {\n              System.err.println(&quot;not holding: ((compare(x, y)&gt;0) &amp;&amp; (compare(y, z)&gt;0)) implies compare(x, z)&gt;0&quot; //\n                  + &quot; | x_y: &quot; + x_y + &quot;, y_z: &quot; + y_z + &quot;,  x_z: &quot; + x_z + &quot;, x: &quot; + x + &quot;, y: &quot; + y + &quot;, z: &quot; + z);\n            }\n          }\n\n          // javadoc: Finally, the implementor must ensure that:\n          // compare(x, y)==0 implies that sgn(compare(x, z))==sgn(compare(y, z)) for all z.\n          if (x_y == 0) {\n            if (Math.signum(x_z) == Math.signum(y_z)) { // ok\n            } else {\n              System.err.println(&quot;not holding: compare(x, y)==0 implies that sgn(compare(x, z))==sgn(compare(y, z)) for all z&quot; //\n                  + &quot; | x_y: &quot; + x_y + &quot;, x_z: &quot; + x_z + &quot;,  y_z: &quot; + y_z + &quot;, x: &quot; + x + &quot;, y: &quot; + y + &quot;, z: &quot; + z);\n            }\n          }\n        }\n      }\n    }\n  }\n</code></pre>\n"}],"owner":{"account_id":1521093,"reputation":3980,"user_id":1420715,"accept_rate":89,"display_name":"Lakatos Gyula"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":203263,"favorite_count":0,"down_vote_count":0,"up_vote_count":121,"accepted_answer_id":11441813,"answer_count":13,"score":121,"last_activity_date":1672914465,"creation_date":1342041615,"question_id":11441666,"body_markdown":"I saw many questions about this, and tried to solve the problem, but after one hour of googling and a lots of trial &amp; error, I still can&#39;t fix it. I hope some of you catch the problem.\r\n\r\nThis is what I get:\r\n\r\n&lt;!-- language: none --&gt;\r\n\r\n    java.lang.IllegalArgumentException: Comparison method violates its general contract!\r\n    \tat java.util.ComparableTimSort.mergeHi(ComparableTimSort.java:835)\r\n    \tat java.util.ComparableTimSort.mergeAt(ComparableTimSort.java:453)\r\n    \tat java.util.ComparableTimSort.mergeForceCollapse(ComparableTimSort.java:392)\r\n    \tat java.util.ComparableTimSort.sort(ComparableTimSort.java:191)\r\n    \tat java.util.ComparableTimSort.sort(ComparableTimSort.java:146)\r\n    \tat java.util.Arrays.sort(Arrays.java:472)\r\n    \tat java.util.Collections.sort(Collections.java:155)\r\n        ...\r\n\r\nAnd this is my comparator:\r\n\r\n    @Override\r\n    public int compareTo(Object o) {\r\n        if(this == o){\r\n            return 0;\r\n        }\r\n        \r\n        CollectionItem item = (CollectionItem) o;\r\n\r\n        Card card1 = CardCache.getInstance().getCard(cardId);\r\n        Card card2 = CardCache.getInstance().getCard(item.getCardId());\r\n\r\n        if (card1.getSet() &lt; card2.getSet()) {\r\n            return -1;\r\n        } else {\r\n            if (card1.getSet() == card2.getSet()) {\r\n                if (card1.getRarity() &lt; card2.getRarity()) {\r\n                    return 1;\r\n                } else {\r\n                    if (card1.getId() == card2.getId()) {\r\n                        if (cardType &gt; item.getCardType()) {\r\n                            return 1;\r\n                        } else {\r\n                            if (cardType == item.getCardType()) {\r\n                                return 0;\r\n                            }\r\n                            return -1;\r\n                        }\r\n                    }\r\n                    return -1;\r\n                }\r\n            }\r\n            return 1;\r\n        }\r\n    }\r\n\r\nAny idea?","title":"Java error: Comparison method violates its general contract","body":"<p>I saw many questions about this, and tried to solve the problem, but after one hour of googling and a lots of trial &amp; error, I still can't fix it. I hope some of you catch the problem.</p>\n\n<p>This is what I get:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>java.lang.IllegalArgumentException: Comparison method violates its general contract!\n    at java.util.ComparableTimSort.mergeHi(ComparableTimSort.java:835)\n    at java.util.ComparableTimSort.mergeAt(ComparableTimSort.java:453)\n    at java.util.ComparableTimSort.mergeForceCollapse(ComparableTimSort.java:392)\n    at java.util.ComparableTimSort.sort(ComparableTimSort.java:191)\n    at java.util.ComparableTimSort.sort(ComparableTimSort.java:146)\n    at java.util.Arrays.sort(Arrays.java:472)\n    at java.util.Collections.sort(Collections.java:155)\n    ...\n</code></pre>\n\n<p>And this is my comparator:</p>\n\n<pre><code>@Override\npublic int compareTo(Object o) {\n    if(this == o){\n        return 0;\n    }\n\n    CollectionItem item = (CollectionItem) o;\n\n    Card card1 = CardCache.getInstance().getCard(cardId);\n    Card card2 = CardCache.getInstance().getCard(item.getCardId());\n\n    if (card1.getSet() &lt; card2.getSet()) {\n        return -1;\n    } else {\n        if (card1.getSet() == card2.getSet()) {\n            if (card1.getRarity() &lt; card2.getRarity()) {\n                return 1;\n            } else {\n                if (card1.getId() == card2.getId()) {\n                    if (cardType &gt; item.getCardType()) {\n                        return 1;\n                    } else {\n                        if (cardType == item.getCardType()) {\n                            return 0;\n                        }\n                        return -1;\n                    }\n                }\n                return -1;\n            }\n        }\n        return 1;\n    }\n}\n</code></pre>\n\n<p>Any idea?</p>\n"},{"tags":["java","file","if-statement","size","filesize"],"comments":[{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":0,"creation_date":1672909579,"post_id":75015948,"comment_id":132380479,"body_markdown":"What do you mean you can&#39;t? What result do you expect and what do you get, instead?","body":"What do you mean you can&#39;t? What result do you expect and what do you get, instead?"},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":0,"creation_date":1672909687,"post_id":75015948,"comment_id":132380504,"body_markdown":"Anyway, if you mean you&#39;re overflowing, try using `BigDecimal` if you care about decimals or `BigInteger` if you only care about integers.","body":"Anyway, if you mean you&#39;re overflowing, try using <code>BigDecimal</code> if you care about decimals or <code>BigInteger</code> if you only care about integers."},{"owner":{"account_id":22903011,"reputation":105,"user_id":17041460,"display_name":"Thend"},"score":0,"creation_date":1672909889,"post_id":75015948,"comment_id":132380570,"body_markdown":"@FedericoklezCulloca Sorry for my quick and lazy posting, I edited the post (early morning here). The problem is that for files larger than 1Gb it directly jumps to TB and shows zero.","body":"@FedericoklezCulloca Sorry for my quick and lazy posting, I edited the post (early morning here). The problem is that for files larger than 1Gb it directly jumps to TB and shows zero."},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":1,"creation_date":1672910459,"post_id":75015948,"comment_id":132380769,"body_markdown":"Of course it does. `size` can&#39;t be less than `size / n` if `n &lt; size` so none of the previous conditions (`size &lt; kilobytes`, `size &lt; megabytes` etc) will ever be true. And then it shows 0 because you&#39;re reassigning the value back to size, which is a `long` and doesn&#39;t have decimals.","body":"Of course it does. <code>size</code> can&#39;t be less than <code>size &#47; n</code> if <code>n &lt; size</code> so none of the previous conditions (<code>size &lt; kilobytes</code>, <code>size &lt; megabytes</code> etc) will ever be true. And then it shows 0 because you&#39;re reassigning the value back to size, which is a <code>long</code> and doesn&#39;t have decimals."},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":0,"creation_date":1672910516,"post_id":75015948,"comment_id":132380784,"body_markdown":"You could avoid all those `&amp;&amp; size &lt; xxx`  in your condition if you reverse the order of the `if`s (i.e., start with TB, then GB etc...)","body":"You could avoid all those <code>&amp;&amp; size &lt; xxx</code>  in your condition if you reverse the order of the <code>if</code>s (i.e., start with TB, then GB etc...)"},{"owner":{"account_id":22903011,"reputation":105,"user_id":17041460,"display_name":"Thend"},"score":0,"creation_date":1672911895,"post_id":75015948,"comment_id":132381214,"body_markdown":"@FedericoklezCulloca I changed to BigDecimal, however still jumps to TB, what is your suggestion? Should I change the relations somehow, not clear how. (Edited the post!)","body":"@FedericoklezCulloca I changed to BigDecimal, however still jumps to TB, what is your suggestion? Should I change the relations somehow, not clear how. (Edited the post!)"},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":0,"creation_date":1672911984,"post_id":75015948,"comment_id":132381249,"body_markdown":"I suggested to change to `BigDecimal` **if** the problem was overflowing (which is not, as you then explained). See my other comments that explain what the actual problems are and how to fix this.","body":"I suggested to change to <code>BigDecimal</code> <b>if</b> the problem was overflowing (which is not, as you then explained). See my other comments that explain what the actual problems are and how to fix this."},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":1,"creation_date":1672912172,"post_id":75015948,"comment_id":132381296,"body_markdown":"I forgot, the solution to not seeing 0 is to not reassign to `size`. Either assign the result to a `double` or just print `size / (1024.0 * 1024.0 *1024.0 *1024)` directly.","body":"I forgot, the solution to not seeing 0 is to not reassign to <code>size</code>. Either assign the result to a <code>double</code> or just print <code>size &#47; (1024.0 * 1024.0 *1024.0 *1024)</code> directly."},{"owner":{"account_id":6714862,"reputation":16230,"user_id":5176992,"display_name":"Eritrean"},"score":1,"creation_date":1672912948,"post_id":75015948,"comment_id":132381549,"body_markdown":"Does this answer your question? [How can I convert byte size into a human-readable format in Java?](https://stackoverflow.com/questions/3758606/how-can-i-convert-byte-size-into-a-human-readable-format-in-java)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/3758606/how-can-i-convert-byte-size-into-a-human-readable-format-in-java\">How can I convert byte size into a human-readable format in Java?</a>"},{"owner":{"account_id":22903011,"reputation":105,"user_id":17041460,"display_name":"Thend"},"score":0,"creation_date":1672914441,"post_id":75015948,"comment_id":132382030,"body_markdown":"@FedericoklezCulloca I have changed size / (1024.0 * 1024.0 *1024.0 *1024) as you mentioned, for all of the code, now works perfectly. I edited the post with the correct code. Best!","body":"@FedericoklezCulloca I have changed size / (1024.0 * 1024.0 *1024.0 *1024) as you mentioned, for all of the code, now works perfectly. I edited the post with the correct code. Best!"},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":1,"creation_date":1672915026,"post_id":75015948,"comment_id":132382226,"body_markdown":"@Thend glad I could help :) It would be better if you posted your solution as an actual answer, rather than an edit to your original question. It makes everything more clear **and** helps future readers which may have a similar problem to yours find a solution.","body":"@Thend glad I could help :) It would be better if you posted your solution as an actual answer, rather than an edit to your original question. It makes everything more clear <b>and</b> helps future readers which may have a similar problem to yours find a solution."}],"owner":{"account_id":22903011,"reputation":105,"user_id":17041460,"display_name":"Thend"},"comment_count":11,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":68,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1672914195,"creation_date":1672909253,"question_id":75015948,"body_markdown":"I&#39;d like to print file/directory sizes in Java, however for files larger than 1GB I cannot. For example, when I check a file with ~1.3 GB it writes 0.000 TB, this is shown on the debugging screenshot. The if-else jumps to the else branch. Probably the maximum limit of long type? Please advice me, the code is the following:\r\n\r\n    long size;\r\n    String notation;\r\n    if (file.isDirectory()) {\r\n        // File is a directory, calculate size of all files in the directory\r\n        size = 0;\r\n        for (File f : file.listFiles()) {\r\n            size += f.length();\r\n        }\r\n    } else {\r\n        // File is a regular file, use size of file\r\n        size = file.length();\r\n    }\r\n\r\n    // Conversion\r\n    long bytes = size;\r\n    long kilobytes = (bytes / 1024);\r\n    long megabytes = (kilobytes / 1024);\r\n    long gigabytes = (megabytes / 1024);\r\n    long terabytes = (gigabytes / 1024);\r\n    long petabytes = (terabytes / 1024);\r\n    long exabytes = (petabytes / 1024);\r\n    //long zettabytes = (exabytes / 1024);\r\n    //long yottabytes = (zettabytes / 1024);\r\n\r\n    if (size &gt; 0 &amp;&amp; size &lt; kilobytes){\r\n        notation = &quot;B&quot;;\r\n        System.out.println(size+notation);\r\n    } else if (size &gt; kilobytes &amp;&amp; size &lt; megabytes) {\r\n        // file is smaller than 1 MB, return size in KB\r\n        size /= 1024;\r\n        notation = &quot;KB&quot;;\r\n        System.out.println(size+notation);\r\n    } else if (size &gt; megabytes &amp;&amp; size &lt; gigabytes) {\r\n        // file is smaller than 1 GB, return size in MB\r\n        notation = &quot;MB&quot;;\r\n        size /= 1024.0 * 1024;\r\n        System.out.println(size+notation);\r\n    } else if (size &gt; gigabytes &amp;&amp; size &lt; terabytes) {\r\n        // file is larger than 1 GB, return size in GB\r\n        notation = &quot;GB&quot;;\r\n        size /= 1024.0 * 1024.0 * 1024.0;\r\n        System.out.println(size+notation);\r\n    } else {\r\n        // file is larger than 1 TB, return size in TB\r\n        notation = &quot;TB&quot;;\r\n        size /= 1024.0 * 1024.0 * 1024.0 * 1024;\r\n        System.out.println(size+notation);\r\n    }\r\n\r\n    // cast size to double before passing it to String.format\r\n    return String.format(&quot;[Size: %.3f %s]&quot;, (double) size, notation);\r\n}\r\n\r\nDebugging shows the following: [![screenshot][1]][1]\r\n\r\n\r\n**EDIT:**\r\nI have changed to BigDecimal, the values seems correct, but still jumps to TB. Please see the screenshot:\r\n[![screenshot 2][2]][2]\r\n\r\n**SOLUTION:**\r\nNow everything is perfect, thank you for all ;)\r\n\r\n    if (bsize.compareTo(BigDecimal.valueOf(1024)) &lt; 0) {\r\n        notation = &quot;B&quot;;\r\n        System.out.println(bsize+notation);\r\n    } else if (bsize.compareTo(BigDecimal.valueOf(1024*1024)) &lt; 0) {\r\n        // file is smaller than 1 MB, return size in KB\r\n        bsize = bsize.divide(BigDecimal.valueOf(1024));\r\n        notation = &quot;KB&quot;;\r\n        System.out.println(bsize+notation);\r\n    } else if (bsize.compareTo(BigDecimal.valueOf(1024L*1024L*1024L)) &lt; 0) {\r\n        // file is smaller than 1 GB, return size in MB\r\n        notation = &quot;MB&quot;;\r\n        bsize = bsize.divide(BigDecimal.valueOf(1024*1024));\r\n        System.out.println(bsize+notation);\r\n    } else if (bsize.compareTo(BigDecimal.valueOf(1024L*1024L*1024L*1024L)) &lt; 0) {\r\n        // file is larger than 1 GB, return size in GB\r\n        notation = &quot;GB&quot;;\r\n        System.out.println(bsize+notation);\r\n        bsize = bsize.divide(BigDecimal.valueOf(1024*1024*1024));\r\n        System.out.println(bsize+notation);\r\n    } else {\r\n        // file is larger than 1 TB, return size in TB\r\n        notation = &quot;TB&quot;;\r\n        bsize = bsize.divide(BigDecimal.valueOf(1024L*1024L*1024L*1024L));\r\n        System.out.println(bsize+notation);\r\n    }\r\n\r\n  [1]: https://i.stack.imgur.com/H5AvA.jpg\r\n  [2]: https://i.stack.imgur.com/M5x7S.jpg","title":"Java if-else statement to print file/directory size; large file size (1 GB&lt;) printing issue","body":"<p>I'd like to print file/directory sizes in Java, however for files larger than 1GB I cannot. For example, when I check a file with ~1.3 GB it writes 0.000 TB, this is shown on the debugging screenshot. The if-else jumps to the else branch. Probably the maximum limit of long type? Please advice me, the code is the following:</p>\n<pre><code>long size;\nString notation;\nif (file.isDirectory()) {\n    // File is a directory, calculate size of all files in the directory\n    size = 0;\n    for (File f : file.listFiles()) {\n        size += f.length();\n    }\n} else {\n    // File is a regular file, use size of file\n    size = file.length();\n}\n\n// Conversion\nlong bytes = size;\nlong kilobytes = (bytes / 1024);\nlong megabytes = (kilobytes / 1024);\nlong gigabytes = (megabytes / 1024);\nlong terabytes = (gigabytes / 1024);\nlong petabytes = (terabytes / 1024);\nlong exabytes = (petabytes / 1024);\n//long zettabytes = (exabytes / 1024);\n//long yottabytes = (zettabytes / 1024);\n\nif (size &gt; 0 &amp;&amp; size &lt; kilobytes){\n    notation = &quot;B&quot;;\n    System.out.println(size+notation);\n} else if (size &gt; kilobytes &amp;&amp; size &lt; megabytes) {\n    // file is smaller than 1 MB, return size in KB\n    size /= 1024;\n    notation = &quot;KB&quot;;\n    System.out.println(size+notation);\n} else if (size &gt; megabytes &amp;&amp; size &lt; gigabytes) {\n    // file is smaller than 1 GB, return size in MB\n    notation = &quot;MB&quot;;\n    size /= 1024.0 * 1024;\n    System.out.println(size+notation);\n} else if (size &gt; gigabytes &amp;&amp; size &lt; terabytes) {\n    // file is larger than 1 GB, return size in GB\n    notation = &quot;GB&quot;;\n    size /= 1024.0 * 1024.0 * 1024.0;\n    System.out.println(size+notation);\n} else {\n    // file is larger than 1 TB, return size in TB\n    notation = &quot;TB&quot;;\n    size /= 1024.0 * 1024.0 * 1024.0 * 1024;\n    System.out.println(size+notation);\n}\n\n// cast size to double before passing it to String.format\nreturn String.format(&quot;[Size: %.3f %s]&quot;, (double) size, notation);\n</code></pre>\n<p>}</p>\n<p>Debugging shows the following: <a href=\"https://i.stack.imgur.com/H5AvA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H5AvA.jpg\" alt=\"screenshot\" /></a></p>\n<p><strong>EDIT:</strong>\nI have changed to BigDecimal, the values seems correct, but still jumps to TB. Please see the screenshot:\n<a href=\"https://i.stack.imgur.com/M5x7S.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M5x7S.jpg\" alt=\"screenshot 2\" /></a></p>\n<p><strong>SOLUTION:</strong>\nNow everything is perfect, thank you for all ;)</p>\n<pre><code>if (bsize.compareTo(BigDecimal.valueOf(1024)) &lt; 0) {\n    notation = &quot;B&quot;;\n    System.out.println(bsize+notation);\n} else if (bsize.compareTo(BigDecimal.valueOf(1024*1024)) &lt; 0) {\n    // file is smaller than 1 MB, return size in KB\n    bsize = bsize.divide(BigDecimal.valueOf(1024));\n    notation = &quot;KB&quot;;\n    System.out.println(bsize+notation);\n} else if (bsize.compareTo(BigDecimal.valueOf(1024L*1024L*1024L)) &lt; 0) {\n    // file is smaller than 1 GB, return size in MB\n    notation = &quot;MB&quot;;\n    bsize = bsize.divide(BigDecimal.valueOf(1024*1024));\n    System.out.println(bsize+notation);\n} else if (bsize.compareTo(BigDecimal.valueOf(1024L*1024L*1024L*1024L)) &lt; 0) {\n    // file is larger than 1 GB, return size in GB\n    notation = &quot;GB&quot;;\n    System.out.println(bsize+notation);\n    bsize = bsize.divide(BigDecimal.valueOf(1024*1024*1024));\n    System.out.println(bsize+notation);\n} else {\n    // file is larger than 1 TB, return size in TB\n    notation = &quot;TB&quot;;\n    bsize = bsize.divide(BigDecimal.valueOf(1024L*1024L*1024L*1024L));\n    System.out.println(bsize+notation);\n}\n</code></pre>\n"},{"tags":["java","performance-testing","gatling"],"answers":[{"comments":[{"owner":{"account_id":15028110,"reputation":93,"user_id":10847244,"display_name":"Taserface"},"score":0,"creation_date":1672915238,"post_id":75016946,"comment_id":132382299,"body_markdown":"Okay, can you please provide me with an example how can I achieve this? To me, Gatling lacks a few functionalities as the one above to be flexible and achieve complex (but at the same time, quite common) things easily. The documentation also has very little examples on those.","body":"Okay, can you please provide me with an example how can I achieve this? To me, Gatling lacks a few functionalities as the one above to be flexible and achieve complex (but at the same time, quite common) things easily. The documentation also has very little examples on those."},{"owner":{"account_id":6852429,"reputation":6319,"user_id":5269205,"display_name":"St&#233;phane LANDELLE"},"score":0,"creation_date":1672915455,"post_id":75016946,"comment_id":132382371,"body_markdown":"You have an example in the other ticket you commented on: https://stackoverflow.com/a/68085836/5269205","body":"You have an example in the other ticket you commented on: <a href=\"https://stackoverflow.com/a/68085836/5269205\">stackoverflow.com/a/68085836/5269205</a>"}],"tags":[],"owner":{"account_id":6852429,"reputation":6319,"user_id":5269205,"display_name":"St&#233;phane LANDELLE"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672914167,"creation_date":1672914167,"answer_id":75016946,"question_id":75016699,"body_markdown":"That&#39;s not possible. Gatling Expression Language is intended as a simple solution for simple use cases.\r\n\r\nFor more complex use cases, you have to switch to using [functions][1] and the [Session API][2].\r\n\r\n\r\n  [1]: https://gatling.io/docs/gatling/reference/current/core/session/function/\r\n  [2]: https://gatling.io/docs/gatling/reference/current/core/session/session_api/#fetching-data","title":"Nested attributes in Gatling Expression Language","body":"<p>That's not possible. Gatling Expression Language is intended as a simple solution for simple use cases.</p>\n<p>For more complex use cases, you have to switch to using <a href=\"https://gatling.io/docs/gatling/reference/current/core/session/function/\" rel=\"nofollow noreferrer\">functions</a> and the <a href=\"https://gatling.io/docs/gatling/reference/current/core/session/session_api/#fetching-data\" rel=\"nofollow noreferrer\">Session API</a>.</p>\n"}],"owner":{"account_id":15028110,"reputation":93,"user_id":10847244,"display_name":"Taserface"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":116,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672914167,"creation_date":1672912924,"question_id":75016699,"body_markdown":"I use Gatling Java  to write a performance test.\r\nI have a session variable &#39;VAR_X&#39; with a value of &#39;Jerry&#39;.\r\n\r\nMy code has a &#39;post()&#39; method that sends a request. It uses a custom feeder to provide a body for the request.  \r\n\r\n    public ChainBuilder post() {\r\n    \tList&lt;String&gt; requestBodyList = new ArrayList&lt;String&gt;();\r\n    \tIterator&lt;Map&lt;String, Object&gt;&gt; feeder =requestBodyList.add(Collections.singletonMap(&quot;REQUEST_BODY&quot;, (Object) &quot;my_config { x: #{VAR_X} }&quot;)).iterator();\r\n    \treturn feed(feeder)\r\n    \t\t.exec(http(&quot;Post request&quot;))\r\n    \t\t.post(&quot;x_resource/&quot;)\r\n    \t\t.body(StringBody(&quot;#{REQUEST_BODY}&quot;))\r\n    }\r\n\r\n\r\nCurrently my code results in the request body to be &quot;my_config { x: #{VAR_X} }&quot;. \r\nI would like the value of session variable &#39;VAR_X&#39; to get inserted into the request body, by using Gatling Expression Language (GEL).\r\nThe desired request body should be:\r\n&quot;my_config { x: Jerry }&quot;\r\n\r\nHow can I change my code to achieve that?","title":"Nested attributes in Gatling Expression Language","body":"<p>I use Gatling Java  to write a performance test.\nI have a session variable 'VAR_X' with a value of 'Jerry'.</p>\n<p>My code has a 'post()' method that sends a request. It uses a custom feeder to provide a body for the request.</p>\n<pre><code>public ChainBuilder post() {\n    List&lt;String&gt; requestBodyList = new ArrayList&lt;String&gt;();\n    Iterator&lt;Map&lt;String, Object&gt;&gt; feeder =requestBodyList.add(Collections.singletonMap(&quot;REQUEST_BODY&quot;, (Object) &quot;my_config { x: #{VAR_X} }&quot;)).iterator();\n    return feed(feeder)\n        .exec(http(&quot;Post request&quot;))\n        .post(&quot;x_resource/&quot;)\n        .body(StringBody(&quot;#{REQUEST_BODY}&quot;))\n}\n</code></pre>\n<p>Currently my code results in the request body to be &quot;my_config { x: #{VAR_X} }&quot;.\nI would like the value of session variable 'VAR_X' to get inserted into the request body, by using Gatling Expression Language (GEL).\nThe desired request body should be:\n&quot;my_config { x: Jerry }&quot;</p>\n<p>How can I change my code to achieve that?</p>\n"},{"tags":["java","mysql","spring","jpa"],"comments":[{"owner":{"account_id":18002520,"reputation":324,"user_id":13084140,"display_name":"Ryednap"},"score":0,"creation_date":1672926054,"post_id":75016936,"comment_id":132385965,"body_markdown":"From my testing of both cases you specified the field `boo` will be set to `null` by default.","body":"From my testing of both cases you specified the field <code>boo</code> will be set to <code>null</code> by default."}],"owner":{"account_id":12766164,"reputation":467,"user_id":10789874,"display_name":"Shivam Papat"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":58,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672914133,"creation_date":1672914133,"question_id":75016936,"body_markdown":"I have an entity with a Boolean object. As Boolean gets converted to TINYINT(1) in MYSQL, the values stored in the column is either 1 or 0. \r\n\r\nI declared the column in entity class as: \r\n\r\n    @Column(name=&quot;boo&quot;)\r\n    Boolean boo = false;\r\n\r\nCurrently, it is storing 0 for all columns. \r\nHow do I set default to NULL to all values.\r\n\r\nDoes this will set default to null ?\r\n\r\n    @ColumnDefault(value=&quot;null&quot;)\r\n    @Column(name=&quot;boo&quot;)\r\n    Boolean boo;\r\n\r\nor this,\r\n\r\n    @ColumnDefault(value=&quot;NULL&quot;)\r\n    @Column(name=&quot;boo&quot;)\r\n    Boolean boo;\r\n\r\nIf none, what else can be done. \r\nThanks.","title":"How to set default NULL for tinyint(1) using JPA","body":"<p>I have an entity with a Boolean object. As Boolean gets converted to TINYINT(1) in MYSQL, the values stored in the column is either 1 or 0.</p>\n<p>I declared the column in entity class as:</p>\n<pre><code>@Column(name=&quot;boo&quot;)\nBoolean boo = false;\n</code></pre>\n<p>Currently, it is storing 0 for all columns.\nHow do I set default to NULL to all values.</p>\n<p>Does this will set default to null ?</p>\n<pre><code>@ColumnDefault(value=&quot;null&quot;)\n@Column(name=&quot;boo&quot;)\nBoolean boo;\n</code></pre>\n<p>or this,</p>\n<pre><code>@ColumnDefault(value=&quot;NULL&quot;)\n@Column(name=&quot;boo&quot;)\nBoolean boo;\n</code></pre>\n<p>If none, what else can be done.\nThanks.</p>\n"},{"tags":["java","spring","spring-mvc","mapping","servlet-filters"],"comments":[{"owner":{"account_id":195331,"reputation":275428,"user_id":438154,"accept_rate":98,"display_name":"Sotirios Delimanolis"},"score":0,"creation_date":1441232872,"post_id":32364126,"comment_id":52600815,"body_markdown":"Why do you think that, in your current configuration, the `Filter` should be invoked?","body":"Why do you think that, in your current configuration, the <code>Filter</code> should be invoked?"},{"owner":{"account_id":3163862,"reputation":36940,"user_id":2674303,"accept_rate":62,"display_name":"gstackoverflow"},"score":0,"creation_date":1441233084,"post_id":32364126,"comment_id":52600882,"body_markdown":"According following answer: http://stackoverflow.com/a/26157610/2674303","body":"According following answer: <a href=\"http://stackoverflow.com/a/26157610/2674303\">stackoverflow.com/a/26157610/2674303</a>"},{"owner":{"account_id":195331,"reputation":275428,"user_id":438154,"accept_rate":98,"display_name":"Sotirios Delimanolis"},"score":0,"creation_date":1441233188,"post_id":32364126,"comment_id":52600906,"body_markdown":"So you&#39;re using Spring Boot?","body":"So you&#39;re using Spring Boot?"},{"owner":{"account_id":3163862,"reputation":36940,"user_id":2674303,"accept_rate":62,"display_name":"gstackoverflow"},"score":0,"creation_date":1441233303,"post_id":32364126,"comment_id":52600942,"body_markdown":"@Sotirios Delimanolis I am not absolutelu sure but I have dependency on **spring-framework-bom** in my pom","body":"@Sotirios Delimanolis I am not absolutelu sure but I have dependency on <b>spring-framework-bom</b> in my pom"},{"owner":{"account_id":3163862,"reputation":36940,"user_id":2674303,"accept_rate":62,"display_name":"gstackoverflow"},"score":0,"creation_date":1441234087,"post_id":32364126,"comment_id":52601195,"body_markdown":"@Sotirios Delimanolis topic updated","body":"@Sotirios Delimanolis topic updated"},{"owner":{"account_id":3163862,"reputation":36940,"user_id":2674303,"accept_rate":62,"display_name":"gstackoverflow"},"score":0,"creation_date":1441485314,"post_id":32364126,"comment_id":52701226,"body_markdown":"@Roxy please be attentive. I meantioned about this link in my topic","body":"@Roxy please be attentive. I meantioned about this link in my topic"},{"owner":{"account_id":3299944,"reputation":419,"user_id":2776345,"accept_rate":50,"display_name":"Nayanjyoti Deka"},"score":0,"creation_date":1441995880,"post_id":32364126,"comment_id":52917766,"body_markdown":"In the contructor of CaseInsensitiveHttpServletRequestWrapper where you do params.putAll(request.getParameterMap()), instead of directly putting the parameter map, if you iterate over the parameter map and put individually key, value params with converting the key to lowercase or uppercase, wouldn&#39;t it work?","body":"In the contructor of CaseInsensitiveHttpServletRequestWrapper where you do params.putAll(request.getParameterMap()), instead of directly putting the parameter map, if you iterate over the parameter map and put individually key, value params with converting the key to lowercase or uppercase, wouldn&#39;t it work?"},{"owner":{"account_id":1229539,"reputation":82701,"user_id":1194415,"accept_rate":76,"display_name":"membersound"},"score":0,"creation_date":1501839941,"post_id":32364126,"comment_id":77967603,"body_markdown":"Did you find a solution regarding `@ModelAttribute` mapping?","body":"Did you find a solution regarding <code>@ModelAttribute</code> mapping?"}],"answers":[{"comments":[{"owner":{"account_id":3163862,"reputation":36940,"user_id":2674303,"accept_rate":62,"display_name":"gstackoverflow"},"score":0,"creation_date":1441533939,"post_id":32418047,"comment_id":52710063,"body_markdown":"both options is not nice. I want to encapsulate new functionality in separated code. It is madness to replace **valueName** with **valuename**","body":"both options is not nice. I want to encapsulate new functionality in separated code. It is madness to replace <b>valueName</b> with <b>valuename</b>"},{"owner":{"account_id":1658164,"reputation":3247,"user_id":1527103,"accept_rate":89,"display_name":"Gokhan Oner"},"score":0,"creation_date":1441534064,"post_id":32418047,"comment_id":52710093,"body_markdown":"Well, i understand but there is not much to do, i believe.","body":"Well, i understand but there is not much to do, i believe."},{"owner":{"account_id":3163862,"reputation":36940,"user_id":2674303,"accept_rate":62,"display_name":"gstackoverflow"},"score":0,"creation_date":1441534464,"post_id":32418047,"comment_id":52710180,"body_markdown":"why? this doesn&#39;t look very hard. I know that there are exist renaming processors and a lot of confused stuffs inside spring mvc. Why I cannot just replace **equals** with **equalsIgnoreCase** in proper place ?","body":"why? this doesn&#39;t look very hard. I know that there are exist renaming processors and a lot of confused stuffs inside spring mvc. Why I cannot just replace <b>equals</b> with <b>equalsIgnoreCase</b> in proper place ?"},{"owner":{"account_id":1658164,"reputation":3247,"user_id":1527103,"accept_rate":89,"display_name":"Gokhan Oner"},"score":0,"creation_date":1441535021,"post_id":32418047,"comment_id":52710347,"body_markdown":"The issueis, spring has its annotation prosessors. When is see @ModelAttribute annotation, it calls reflection and try to set the properties of the model. This is different than RequestParam. I looked to the annotation processor and couldnt see a way to cheat. Maybe, you should copy that annotation processor, and change it the way you want. I really understand and i agree that there should be a simpler way to do it, but unf. I cannot see.","body":"The issueis, spring has its annotation prosessors. When is see @ModelAttribute annotation, it calls reflection and try to set the properties of the model. This is different than RequestParam. I looked to the annotation processor and couldnt see a way to cheat. Maybe, you should copy that annotation processor, and change it the way you want. I really understand and i agree that there should be a simpler way to do it, but unf. I cannot see."},{"owner":{"account_id":3163862,"reputation":36940,"user_id":2674303,"accept_rate":62,"display_name":"gstackoverflow"},"score":0,"creation_date":1441535165,"post_id":32418047,"comment_id":52710387,"body_markdown":"One thanks for your effort) let to wait another answers. maybe someone can suggest something more relevant","body":"One thanks for your effort) let to wait another answers. maybe someone can suggest something more relevant"}],"tags":[],"owner":{"account_id":1658164,"reputation":3247,"user_id":1527103,"accept_rate":89,"display_name":"Gokhan Oner"},"comment_count":5,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1441490060,"creation_date":1441490060,"answer_id":32418047,"question_id":32364126,"body_markdown":"Your problem, I believe, is ```@ModelAttribute```. You&#39;re asking Spring to map the parameters to ```MyBean``` object, and the property inside this object is ```valueName```. \r\n\r\nIn order Spring to reflect the params to the object, it needs to be in the correct case.\r\n\r\nYou have 2 options:\r\n\r\n - change the property name to ```valuename``` in your MyBean object, and all property names to lowercase, it should work with help of your solution.\r\n - remove ```@ModelAttribute``` and put ```@RequestParam``` for each property. If you have many props, this could be painful.\r\n","title":"Spring mvc. case insensitive get parameters mapping","body":"<p>Your problem, I believe, is <code>@ModelAttribute</code>. You're asking Spring to map the parameters to <code>MyBean</code> object, and the property inside this object is <code>valueName</code>. </p>\n\n<p>In order Spring to reflect the params to the object, it needs to be in the correct case.</p>\n\n<p>You have 2 options:</p>\n\n<ul>\n<li>change the property name to <code>valuename</code> in your MyBean object, and all property names to lowercase, it should work with help of your solution.</li>\n<li>remove <code>@ModelAttribute</code> and put <code>@RequestParam</code> for each property. If you have many props, this could be painful.</li>\n</ul>\n"},{"comments":[{"owner":{"account_id":3163862,"reputation":36940,"user_id":2674303,"accept_rate":62,"display_name":"gstackoverflow"},"score":1,"creation_date":1441800661,"post_id":32477766,"comment_id":52819112,"body_markdown":"**valuename** is awful","body":"<b>valuename</b> is awful"},{"owner":{"account_id":4946877,"reputation":173,"user_id":3982002,"accept_rate":71,"display_name":"Neeraj Gupta"},"score":0,"creation_date":1441804558,"post_id":32477766,"comment_id":52822014,"body_markdown":"I know that... but if you want case insensitive mapping of request params for which spring does not provide any hooks... I believe you will have to stick with either lowercase or uppercase for your domains.","body":"I know that... but if you want case insensitive mapping of request params for which spring does not provide any hooks... I believe you will have to stick with either lowercase or uppercase for your domains."},{"owner":{"account_id":3163862,"reputation":36940,"user_id":2674303,"accept_rate":62,"display_name":"gstackoverflow"},"score":0,"creation_date":1441964771,"post_id":32477766,"comment_id":52898496,"body_markdown":"Spring is open source project. I believe that a lot of spring commiters visit SO. Maybe ticket will be created.","body":"Spring is open source project. I believe that a lot of spring commiters visit SO. Maybe ticket will be created."}],"tags":[],"owner":{"account_id":4946877,"reputation":173,"user_id":3982002,"accept_rate":71,"display_name":"Neeraj Gupta"},"comment_count":3,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1441796454,"creation_date":1441796454,"answer_id":32477766,"question_id":32364126,"body_markdown":"Here is what you can do...\r\n\r\nCreate the domain(POJO) with all lowercase variables\r\n\r\n    public class MyBean{\r\n        private String valuename;\r\n    \r\n    \tpublic String getValuename() {\r\n    \t\treturn valuename;\r\n    \t}\r\n    \r\n    \tpublic void setValuename(String valuename) {\r\n    \t\tthis.valuename = valuename;\r\n    \t}\r\n    }\r\n\r\nThen create a class which will extend [`HttpServletRequestWrapper`][1] \r\n\r\n    public class CustomWrappedRequest extends HttpServletRequestWrapper\r\n    {\r\n        private final Map&lt;String, String[]&gt; modifiableParameters;\r\n        private Map&lt;String, String[]&gt; allParameters = null;\r\n    \r\n        public CustomWrappedRequest(final HttpServletRequest request, \r\n                                                        final Map&lt;String, String[]&gt; additionalParams)\r\n        {\r\n            super(request);\r\n            modifiableParameters = new TreeMap&lt;String, String[]&gt;();\r\n            modifiableParameters.putAll(additionalParams);\r\n        }\r\n    \r\n        @Override\r\n        public String getParameter(final String name)\r\n        {\r\n            String[] strings = getParameterMap().get(name);\r\n            if (strings != null)\r\n            {\r\n                return strings[0];\r\n            }\r\n            return super.getParameter(name);\r\n        }\r\n    \r\n        @Override\r\n        public Map&lt;String, String[]&gt; getParameterMap()\r\n        {\r\n            if (allParameters == null)\r\n            {\r\n                allParameters = new TreeMap&lt;String, String[]&gt;();\r\n                allParameters.putAll(super.getParameterMap());\r\n                allParameters.putAll(modifiableParameters);\r\n            }\r\n            return Collections.unmodifiableMap(allParameters);\r\n        }\r\n    \r\n        @Override\r\n        public Enumeration&lt;String&gt; getParameterNames()\r\n        {\r\n            return Collections.enumeration(getParameterMap().keySet());\r\n        }\r\n    \r\n        @Override\r\n        public String[] getParameterValues(final String name)\r\n        {\r\n            return getParameterMap().get(name);\r\n        }\r\n    }\r\n\r\nLast add a filter with appropriate web.xml config the `doFilter()` will look like this\r\n\r\n    public void doFilter(ServletRequest request, ServletResponse reponse, FilterChain chain)\r\n    \t\t\tthrows IOException, ServletException {\r\n    \t    Map&lt;String, String[]&gt; params = request.getParameterMap();\r\n    \t    Map&lt;String, String[]&gt; extraParams = new TreeMap&lt;String, String[]&gt;();\r\n    \t    Iterator&lt;String&gt; i = params.keySet().iterator();\r\n    \r\n    \t    while ( i.hasNext() )\r\n    \t      {\r\n    \t        String key = (String) i.next();\r\n    \t        String value = ((String[]) params.get( key ))[ 0 ];\r\n    \t        extraParams.put(key.toLowerCase(), new String[] {value});\r\n    \r\n    \t      }\r\n    \t    HttpServletRequest wrappedRequest = new CustomWrappedRequest((HttpServletRequest)request, extraParams);\r\n    \t    \r\n    \t    chain.doFilter(wrappedRequest, reponse);\r\n    \t\t\r\n    \t}\r\n\r\nHere the filter will convet the params into lowercase and attach it to your custom made request. \r\nThen use can use `@ModelAttribute` in the controller code to get the desired object.\r\n\r\nHope it helps :)\r\n\r\n\r\n\r\n\r\n\r\n  [1]: http://www.ocpsoft.org/opensource/how-to-safely-add-modify-servlet-request-parameter-values/","title":"Spring mvc. case insensitive get parameters mapping","body":"<p>Here is what you can do...</p>\n\n<p>Create the domain(POJO) with all lowercase variables</p>\n\n<pre><code>public class MyBean{\n    private String valuename;\n\n    public String getValuename() {\n        return valuename;\n    }\n\n    public void setValuename(String valuename) {\n        this.valuename = valuename;\n    }\n}\n</code></pre>\n\n<p>Then create a class which will extend <a href=\"http://www.ocpsoft.org/opensource/how-to-safely-add-modify-servlet-request-parameter-values/\" rel=\"nofollow\"><code>HttpServletRequestWrapper</code></a> </p>\n\n<pre><code>public class CustomWrappedRequest extends HttpServletRequestWrapper\n{\n    private final Map&lt;String, String[]&gt; modifiableParameters;\n    private Map&lt;String, String[]&gt; allParameters = null;\n\n    public CustomWrappedRequest(final HttpServletRequest request, \n                                                    final Map&lt;String, String[]&gt; additionalParams)\n    {\n        super(request);\n        modifiableParameters = new TreeMap&lt;String, String[]&gt;();\n        modifiableParameters.putAll(additionalParams);\n    }\n\n    @Override\n    public String getParameter(final String name)\n    {\n        String[] strings = getParameterMap().get(name);\n        if (strings != null)\n        {\n            return strings[0];\n        }\n        return super.getParameter(name);\n    }\n\n    @Override\n    public Map&lt;String, String[]&gt; getParameterMap()\n    {\n        if (allParameters == null)\n        {\n            allParameters = new TreeMap&lt;String, String[]&gt;();\n            allParameters.putAll(super.getParameterMap());\n            allParameters.putAll(modifiableParameters);\n        }\n        return Collections.unmodifiableMap(allParameters);\n    }\n\n    @Override\n    public Enumeration&lt;String&gt; getParameterNames()\n    {\n        return Collections.enumeration(getParameterMap().keySet());\n    }\n\n    @Override\n    public String[] getParameterValues(final String name)\n    {\n        return getParameterMap().get(name);\n    }\n}\n</code></pre>\n\n<p>Last add a filter with appropriate web.xml config the <code>doFilter()</code> will look like this</p>\n\n<pre><code>public void doFilter(ServletRequest request, ServletResponse reponse, FilterChain chain)\n            throws IOException, ServletException {\n        Map&lt;String, String[]&gt; params = request.getParameterMap();\n        Map&lt;String, String[]&gt; extraParams = new TreeMap&lt;String, String[]&gt;();\n        Iterator&lt;String&gt; i = params.keySet().iterator();\n\n        while ( i.hasNext() )\n          {\n            String key = (String) i.next();\n            String value = ((String[]) params.get( key ))[ 0 ];\n            extraParams.put(key.toLowerCase(), new String[] {value});\n\n          }\n        HttpServletRequest wrappedRequest = new CustomWrappedRequest((HttpServletRequest)request, extraParams);\n\n        chain.doFilter(wrappedRequest, reponse);\n\n    }\n</code></pre>\n\n<p>Here the filter will convet the params into lowercase and attach it to your custom made request. \nThen use can use <code>@ModelAttribute</code> in the controller code to get the desired object.</p>\n\n<p>Hope it helps :)</p>\n"},{"tags":[],"owner":{"account_id":2417567,"reputation":886,"user_id":2111288,"accept_rate":33,"display_name":"SaviNuclear"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1442012312,"creation_date":1441981342,"answer_id":32525732,"question_id":32364126,"body_markdown":"Actually, you have to change the things in the `CaseInsensitiveRequestFilter` class as per your bean variable name. In your case the variable is `valueName`, so for every request it will convert it as per your variable setter method camel case injection and then match as per your request. Just try for your custom requirements:\r\n\r\n    package biz.deinum.web.filter;\r\n    \r\n    import java.io.IOException;\r\n    import java.util.Collections;\r\n    import java.util.Enumeration;\r\n    import java.util.HashMap;\r\n    import java.util.Iterator;\r\n    import java.util.Map;\r\n    import java.util.Map.Entry;\r\n    import java.util.Set;\r\n    \r\n    import javax.servlet.FilterChain;\r\n    import javax.servlet.ServletException;\r\n    import javax.servlet.http.HttpServletRequest;\r\n    import javax.servlet.http.HttpServletRequestWrapper;\r\n    import javax.servlet.http.HttpServletResponse;\r\n    \r\n    import org.springframework.util.LinkedCaseInsensitiveMap;\r\n    import org.springframework.web.filter.OncePerRequestFilter;\r\n    \r\n    public class CaseInsensitiveRequestFilter extends OncePerRequestFilter {\r\n        @Override\r\n        protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {\r\n            filterChain.doFilter(new CaseInsensitiveHttpServletRequestWrapper(request), response);\r\n        }\r\n    \r\n        private static class CaseInsensitiveHttpServletRequestWrapper extends HttpServletRequestWrapper {\r\n    \r\n            private final LinkedCaseInsensitiveMap&lt;String[]&gt; params = new LinkedCaseInsensitiveMap&lt;&gt;();\r\n    \r\n            private CaseInsensitiveHttpServletRequestWrapper(HttpServletRequest request) {\r\n                super(request);\r\n                Map&lt;String, String[]&gt; map = request.getParameterMap();\r\n                Set set = map.entrySet();\r\n                Iterator it = set.iterator();\r\n                Map&lt;String, String[]&gt; tempMap = new HashMap&lt;String, String[]&gt;(); \r\n                while (it.hasNext()) {\r\n                \tMap.Entry&lt;String, String[]&gt; entry = (Entry&lt;String, String[]&gt;) it.next();\r\n                \tString key = entry.getKey();\r\n                \t// Keep your parameter bean name here in your case it is &quot;valueName&quot;\r\n                \tString beanParamaterName = &quot;valueName&quot;;\r\n                \tif(key.equalsIgnoreCase(beanParamaterName)){\r\n                \t\ttempMap.put(key.toLowerCase(), entry.getValue());\r\n                \t}\r\n                }\r\n                params.putAll(tempMap);\r\n            }\r\n    \r\n            @Override\r\n            public String getParameter(String name) {\r\n                String[] values = getParameterValues(name);\r\n                System.out.println(values.toString()+&quot;-&quot;);\r\n                if (values == null || values.length == 0) {\r\n                    return null;\r\n                }\r\n                return values[0];\r\n            }\r\n    \r\n            @Override\r\n            public Map&lt;String, String[]&gt; getParameterMap() {\r\n                return Collections.unmodifiableMap(this.params);\r\n            }\r\n    \r\n            @Override\r\n            public Enumeration&lt;String&gt; getParameterNames() {\r\n                return Collections.enumeration(this.params.keySet());\r\n            }\r\n    \r\n            @Override\r\n            public String[] getParameterValues(String name) {\r\n            \tSystem.out.println(name);\r\n                return (String[])params.get(name);\r\n            }\r\n        }\r\n    }","title":"Spring mvc. case insensitive get parameters mapping","body":"<p>Actually, you have to change the things in the <code>CaseInsensitiveRequestFilter</code> class as per your bean variable name. In your case the variable is <code>valueName</code>, so for every request it will convert it as per your variable setter method camel case injection and then match as per your request. Just try for your custom requirements:</p>\n\n<pre><code>package biz.deinum.web.filter;\n\nimport java.io.IOException;\nimport java.util.Collections;\nimport java.util.Enumeration;\nimport java.util.HashMap;\nimport java.util.Iterator;\nimport java.util.Map;\nimport java.util.Map.Entry;\nimport java.util.Set;\n\nimport javax.servlet.FilterChain;\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletRequestWrapper;\nimport javax.servlet.http.HttpServletResponse;\n\nimport org.springframework.util.LinkedCaseInsensitiveMap;\nimport org.springframework.web.filter.OncePerRequestFilter;\n\npublic class CaseInsensitiveRequestFilter extends OncePerRequestFilter {\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {\n        filterChain.doFilter(new CaseInsensitiveHttpServletRequestWrapper(request), response);\n    }\n\n    private static class CaseInsensitiveHttpServletRequestWrapper extends HttpServletRequestWrapper {\n\n        private final LinkedCaseInsensitiveMap&lt;String[]&gt; params = new LinkedCaseInsensitiveMap&lt;&gt;();\n\n        private CaseInsensitiveHttpServletRequestWrapper(HttpServletRequest request) {\n            super(request);\n            Map&lt;String, String[]&gt; map = request.getParameterMap();\n            Set set = map.entrySet();\n            Iterator it = set.iterator();\n            Map&lt;String, String[]&gt; tempMap = new HashMap&lt;String, String[]&gt;(); \n            while (it.hasNext()) {\n                Map.Entry&lt;String, String[]&gt; entry = (Entry&lt;String, String[]&gt;) it.next();\n                String key = entry.getKey();\n                // Keep your parameter bean name here in your case it is \"valueName\"\n                String beanParamaterName = \"valueName\";\n                if(key.equalsIgnoreCase(beanParamaterName)){\n                    tempMap.put(key.toLowerCase(), entry.getValue());\n                }\n            }\n            params.putAll(tempMap);\n        }\n\n        @Override\n        public String getParameter(String name) {\n            String[] values = getParameterValues(name);\n            System.out.println(values.toString()+\"-\");\n            if (values == null || values.length == 0) {\n                return null;\n            }\n            return values[0];\n        }\n\n        @Override\n        public Map&lt;String, String[]&gt; getParameterMap() {\n            return Collections.unmodifiableMap(this.params);\n        }\n\n        @Override\n        public Enumeration&lt;String&gt; getParameterNames() {\n            return Collections.enumeration(this.params.keySet());\n        }\n\n        @Override\n        public String[] getParameterValues(String name) {\n            System.out.println(name);\n            return (String[])params.get(name);\n        }\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2800537,"reputation":454,"user_id":2408863,"display_name":"tonnoz"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672914120,"creation_date":1672914120,"answer_id":75016934,"question_id":32364126,"body_markdown":"Your enum param:\r\n\r\n    enum YourEnum {\r\n        ENUM1, ENUM2, ENUM3\r\n    }\r\n\r\nAdd this converter class:\r\n\r\n    class StringToEnumConverter implements Converter&lt;String, YourEnum&gt; {\r\n        @Override\r\n        YourEnum convert(String source) {\r\n            return YourEnum.valueOf(source.toUpperCase());\r\n        }\r\n    }\r\n\r\nand this Configuration:\r\n\r\n    class ApiWebConfiguration implements WebMvcConfigurer {\r\n    \r\n        @Override\r\n        void addFormatters(FormatterRegistry registry) {\r\n            registry.addConverter(new StringToEnumConverter());\r\n        }\r\n    ...\r\n    }\r\n\r\nvoila, case-unsensitive enum parameter.","title":"Spring mvc. case insensitive get parameters mapping","body":"<p>Your enum param:</p>\n<pre><code>enum YourEnum {\n    ENUM1, ENUM2, ENUM3\n}\n</code></pre>\n<p>Add this converter class:</p>\n<pre><code>class StringToEnumConverter implements Converter&lt;String, YourEnum&gt; {\n    @Override\n    YourEnum convert(String source) {\n        return YourEnum.valueOf(source.toUpperCase());\n    }\n}\n</code></pre>\n<p>and this Configuration:</p>\n<pre><code>class ApiWebConfiguration implements WebMvcConfigurer {\n\n    @Override\n    void addFormatters(FormatterRegistry registry) {\n        registry.addConverter(new StringToEnumConverter());\n    }\n...\n}\n</code></pre>\n<p>voila, case-unsensitive enum parameter.</p>\n"}],"owner":{"account_id":3163862,"reputation":36940,"user_id":2674303,"accept_rate":62,"display_name":"gstackoverflow"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":7086,"favorite_count":0,"down_vote_count":0,"up_vote_count":11,"answer_count":4,"score":11,"last_activity_date":1672914120,"creation_date":1441232657,"question_id":32364126,"body_markdown":"according [this answer][1] I try to write my code:\n\npojo:\n\n    class MyBean{\n    \n        public String getValueName() {\n            return valueName;\n        }\n    \n        public void setValueName(String valueName) {\n            this.valueName = valueName;\n        }\n    \n        String valueName;\n    }\n\ninside controller:\n\n\n        @ModelAttribute\n        public MyBean createMyBean() {\n            return new MyBean();\n        }\n        @RequestMapping(value = &quot;/getMyBean&quot;, method = RequestMethod.GET)\n        public String getMyBean(@ModelAttribute MyBean myBean) {\n            System.out.println(myBean.getValueName());\n            return &quot;pathToJsp&quot;;\n        }\n\n\nweb.xml configuration:\n\n   \n\n    &lt;filter&gt;\n        &lt;filter-name&gt;caseInsensitiveFilter&lt;/filter-name&gt;\n        &lt;filter-class&gt;com.terminal.interceptor.CaseInsensitiveRequestFilter&lt;/filter-class&gt;\n    &lt;/filter&gt;\n    \n    &lt;filter-mapping&gt;\n        &lt;filter-name&gt;caseInsensitiveFilter&lt;/filter-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;/filter-mapping&gt;\n\nFilter:\n\n    @Component\n    public class CaseInsensitiveRequestFilter extends OncePerRequestFilter {\n        @Override\n        protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {\n            filterChain.doFilter(new CaseInsensitiveHttpServletRequestWrapper(request), response);\n        }\n    \n        private static class CaseInsensitiveHttpServletRequestWrapper extends HttpServletRequestWrapper {\n    \n            private final LinkedCaseInsensitiveMap params = new LinkedCaseInsensitiveMap();\n    \n            /**\n             * Constructs a request object wrapping the given request.\n             *\n             * @param request\n             * @throws IllegalArgumentException if the request is null\n             */\n            private CaseInsensitiveHttpServletRequestWrapper(HttpServletRequest request) {\n                super(request);\n                params.putAll(request.getParameterMap());\n            }\n    \n            @Override\n            public String getParameter(String name) {\n                String[] values = getParameterValues(name);\n                if (values == null || values.length == 0) {\n                    return null;\n                }\n                return values[0];\n            }\n    \n            @Override\n            public Map getParameterMap() {\n                return Collections.unmodifiableMap(this.params);\n            }\n    \n            @Override\n            public Enumeration getParameterNames() {\n                return Collections.enumeration(this.params.keySet());\n            }\n    \n            @Override\n            public String[] getParameterValues(String name) {\n                return (String[]) params.get(name);\n            }\n        }\n    }\n\nIn debug I see that filter method invoke but I cannot achieve case insentive get parameters mapping.\n\nfor example `localhost:8081/getMyBean?valueName=trololo` works but `localhost:8081/getMyBean?valuename=trololo` - not\n\n  [1]: https://stackoverflow.com/a/29533456/2674303","title":"Spring mvc. case insensitive get parameters mapping","body":"<p>according <a href=\"https://stackoverflow.com/a/29533456/2674303\">this answer</a> I try to write my code:</p>\n<p>pojo:</p>\n<pre><code>class MyBean{\n\n    public String getValueName() {\n        return valueName;\n    }\n\n    public void setValueName(String valueName) {\n        this.valueName = valueName;\n    }\n\n    String valueName;\n}\n</code></pre>\n<p>inside controller:</p>\n<pre><code>    @ModelAttribute\n    public MyBean createMyBean() {\n        return new MyBean();\n    }\n    @RequestMapping(value = &quot;/getMyBean&quot;, method = RequestMethod.GET)\n    public String getMyBean(@ModelAttribute MyBean myBean) {\n        System.out.println(myBean.getValueName());\n        return &quot;pathToJsp&quot;;\n    }\n</code></pre>\n<p>web.xml configuration:</p>\n<pre><code>&lt;filter&gt;\n    &lt;filter-name&gt;caseInsensitiveFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;com.terminal.interceptor.CaseInsensitiveRequestFilter&lt;/filter-class&gt;\n&lt;/filter&gt;\n\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;caseInsensitiveFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n</code></pre>\n<p>Filter:</p>\n<pre><code>@Component\npublic class CaseInsensitiveRequestFilter extends OncePerRequestFilter {\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {\n        filterChain.doFilter(new CaseInsensitiveHttpServletRequestWrapper(request), response);\n    }\n\n    private static class CaseInsensitiveHttpServletRequestWrapper extends HttpServletRequestWrapper {\n\n        private final LinkedCaseInsensitiveMap params = new LinkedCaseInsensitiveMap();\n\n        /**\n         * Constructs a request object wrapping the given request.\n         *\n         * @param request\n         * @throws IllegalArgumentException if the request is null\n         */\n        private CaseInsensitiveHttpServletRequestWrapper(HttpServletRequest request) {\n            super(request);\n            params.putAll(request.getParameterMap());\n        }\n\n        @Override\n        public String getParameter(String name) {\n            String[] values = getParameterValues(name);\n            if (values == null || values.length == 0) {\n                return null;\n            }\n            return values[0];\n        }\n\n        @Override\n        public Map getParameterMap() {\n            return Collections.unmodifiableMap(this.params);\n        }\n\n        @Override\n        public Enumeration getParameterNames() {\n            return Collections.enumeration(this.params.keySet());\n        }\n\n        @Override\n        public String[] getParameterValues(String name) {\n            return (String[]) params.get(name);\n        }\n    }\n}\n</code></pre>\n<p>In debug I see that filter method invoke but I cannot achieve case insentive get parameters mapping.</p>\n<p>for example <code>localhost:8081/getMyBean?valueName=trololo</code> works but <code>localhost:8081/getMyBean?valuename=trololo</code> - not</p>\n"},{"tags":["java","spring-boot","spring-webclient"],"comments":[{"owner":{"account_id":4912982,"reputation":14853,"user_id":3957754,"accept_rate":50,"display_name":"JRichardsz"},"score":0,"creation_date":1639752282,"post_id":70357582,"comment_id":124435941,"body_markdown":"Are you able to replicate in your local workspace? Try pointing your spring app to a telegram api mock. If you are not able to  reproduce the error, it will be hard to help you","body":"Are you able to replicate in your local workspace? Try pointing your spring app to a telegram api mock. If you are not able to  reproduce the error, it will be hard to help you"},{"owner":{"account_id":17827364,"reputation":1861,"user_id":12948262,"display_name":"wxker"},"score":0,"creation_date":1639756088,"post_id":70357582,"comment_id":124437458,"body_markdown":"@JRichardsz I have tried to replicate it locally but to no avail, especially since this problem happens randomly after some time (could be days). Also, I used Telegram as an example, but this issue happens to all the hosts that I&#39;m sending requests to. What&#39;s common across all the hosts is that the connections don&#39;t add up. I&#39;m thinking and hoping that that is the cause of the problem.","body":"@JRichardsz I have tried to replicate it locally but to no avail, especially since this problem happens randomly after some time (could be days). Also, I used Telegram as an example, but this issue happens to all the hosts that I&#39;m sending requests to. What&#39;s common across all the hosts is that the connections don&#39;t add up. I&#39;m thinking and hoping that that is the cause of the problem."},{"owner":{"account_id":9492638,"reputation":759,"user_id":7056847,"display_name":"Saxon"},"score":0,"creation_date":1639827439,"post_id":70357582,"comment_id":124450978,"body_markdown":"Try to generate a thread dump of your java process when the problem occurs and analyze the content. You might also be running out of threads. Which is the value of server.tomcat.threads.max. The default is 200.","body":"Try to generate a thread dump of your java process when the problem occurs and analyze the content. You might also be running out of threads. Which is the value of server.tomcat.threads.max. The default is 200."},{"owner":{"account_id":14213490,"reputation":555,"user_id":10268003,"display_name":"Aniket Singla"},"score":0,"creation_date":1639916965,"post_id":70357582,"comment_id":124465578,"body_markdown":"Do you see &quot;connection reset by peer&quot; anywhere in logs? Asked because netty uses connection pooling by default and most of the api gateways closes idle connections after some time.","body":"Do you see &quot;connection reset by peer&quot; anywhere in logs? Asked because netty uses connection pooling by default and most of the api gateways closes idle connections after some time."},{"owner":{"account_id":17827364,"reputation":1861,"user_id":12948262,"display_name":"wxker"},"score":0,"creation_date":1640131947,"post_id":70357582,"comment_id":124522143,"body_markdown":"@Saxon while your suggestion was not the cause of my issue, it was your suggestion to generate a thread dump that led to me finding out the actual problem. Could you write an answer so I could award you the bounty?","body":"@Saxon while your suggestion was not the cause of my issue, it was your suggestion to generate a thread dump that led to me finding out the actual problem. Could you write an answer so I could award you the bounty?"}],"answers":[{"tags":[],"owner":{"account_id":7265249,"reputation":1110,"user_id":5540231,"display_name":"jausen brett"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1640010349,"creation_date":1640003127,"answer_id":70421766,"question_id":70357582,"body_markdown":"I would propose to take a look in the RateLimiter direction.\r\nMaybe it does not work as expected, depending on the number of requests your application does over time.\r\nFrom the Javadoc for Ratelimiter:\r\n&quot;It is important to note that the number of permits requested never affects the throttling of the request itself ... but it affects the throttling of the next request. I.e., if an expensive task arrives at an idle RateLimiter, it will be granted immediately, but it is the next request that will experience extra throttling, thus paying for the cost of the expensive task.&quot;\r\nAlso helpful might be this discussion:\r\n[github][1] or [github][2]\r\n\r\nI could imaginge there is some throttling adding up or other effect in the RateLimiter, i would try to play around with it and make sure this thing really works the way you want.\r\nAlternatively, consider using Spring @Scheduled to read from your queue.\r\nYou might want to spice it up using embedded JMS for further goodies (message persistence etc).\r\n\r\n  [1]: https://github.com/resilience4j/resilience4j/issues/1049\r\n  [2]: https://github.com/resilience4j/resilience4j/issues/336","title":"Spring Boot WebClient stops sending requests","body":"<p>I would propose to take a look in the RateLimiter direction.\nMaybe it does not work as expected, depending on the number of requests your application does over time.\nFrom the Javadoc for Ratelimiter:\n&quot;It is important to note that the number of permits requested never affects the throttling of the request itself ... but it affects the throttling of the next request. I.e., if an expensive task arrives at an idle RateLimiter, it will be granted immediately, but it is the next request that will experience extra throttling, thus paying for the cost of the expensive task.&quot;\nAlso helpful might be this discussion:\n<a href=\"https://github.com/resilience4j/resilience4j/issues/1049\" rel=\"nofollow noreferrer\">github</a> or <a href=\"https://github.com/resilience4j/resilience4j/issues/336\" rel=\"nofollow noreferrer\">github</a></p>\n<p>I could imaginge there is some throttling adding up or other effect in the RateLimiter, i would try to play around with it and make sure this thing really works the way you want.\nAlternatively, consider using Spring @Scheduled to read from your queue.\nYou might want to spice it up using embedded JMS for further goodies (message persistence etc).</p>\n"},{"comments":[{"owner":{"account_id":6795143,"reputation":369,"user_id":11095900,"display_name":"Ricardo Rabanales"},"score":0,"creation_date":1687383019,"post_id":70442933,"comment_id":134930850,"body_markdown":"I know it&#39;s been a while.. but, do you have an example of the blocking task you&#39;re talking about? I&#39;m facing a similar issue but I don&#39;t how we might be blocking the reactors threads.. It would very helpful","body":"I know it&#39;s been a while.. but, do you have an example of the blocking task you&#39;re talking about? I&#39;m facing a similar issue but I don&#39;t how we might be blocking the reactors threads.. It would very helpful"}],"tags":[],"owner":{"account_id":17827364,"reputation":1861,"user_id":12948262,"display_name":"wxker"},"comment_count":1,"down_vote_count":0,"up_vote_count":5,"is_accepted":true,"score":5,"last_activity_date":1640131868,"creation_date":1640131868,"answer_id":70442933,"question_id":70357582,"body_markdown":"Finally found and solved the problem. The issue was that I had a blocking task that was blocked on a reactor thread. I only noticed this thanks to the thread dump. The blocking task was waiting for an event, so it could take a long time to resolve. So eventually, when all four reactor threads are blocked, all requests would naturally be stuck with no threads to process them. \r\n\r\nIn short: don&#39;t block your reactor threads.","title":"Spring Boot WebClient stops sending requests","body":"<p>Finally found and solved the problem. The issue was that I had a blocking task that was blocked on a reactor thread. I only noticed this thanks to the thread dump. The blocking task was waiting for an event, so it could take a long time to resolve. So eventually, when all four reactor threads are blocked, all requests would naturally be stuck with no threads to process them.</p>\n<p>In short: don't block your reactor threads.</p>\n"},{"comments":[{"owner":{"account_id":17827364,"reputation":1861,"user_id":12948262,"display_name":"wxker"},"score":0,"creation_date":1640598869,"post_id":70488464,"comment_id":124611802,"body_markdown":"Sorry man, you posted it way too late. The bounty had already expired.","body":"Sorry man, you posted it way too late. The bounty had already expired."}],"tags":[],"owner":{"account_id":9492638,"reputation":759,"user_id":7056847,"display_name":"Saxon"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1640539515,"creation_date":1640539515,"answer_id":70488464,"question_id":70357582,"body_markdown":"These problems are often related to thread exhaustion on spring-boot, and should be analyzed generating the thread dump at the time the block occurs with jstack:\r\n\r\n    jstack &lt;java pid&gt; &gt; ThredDump.txt\r\n\r\nThe content of the generated file ThredDump.txt usually gives the info on blocked threads.\r\n","title":"Spring Boot WebClient stops sending requests","body":"<p>These problems are often related to thread exhaustion on spring-boot, and should be analyzed generating the thread dump at the time the block occurs with jstack:</p>\n<pre><code>jstack &lt;java pid&gt; &gt; ThredDump.txt\n</code></pre>\n<p>The content of the generated file ThredDump.txt usually gives the info on blocked threads.</p>\n"}],"owner":{"account_id":17827364,"reputation":1861,"user_id":12948262,"display_name":"wxker"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3973,"favorite_count":0,"down_vote_count":0,"up_vote_count":10,"accepted_answer_id":70442933,"answer_count":3,"score":10,"last_activity_date":1672913943,"creation_date":1639532997,"question_id":70357582,"body_markdown":"I am running a Spring Boot app that uses WebClient for both non-blocking and blocking HTTP requests. After the app has run for some time, all outgoing HTTP requests seem to get stuck.\r\n\r\nWebClient is used to send requests to multiple hosts, but as an example, here is how it is initialized and used to send requests to Telegram:\r\n\r\nWebClientConfig:\r\n```java\r\n    @Bean\r\n    public ReactorClientHttpConnector httpClient() {\r\n        HttpClient.create(ConnectionProvider.builder(&quot;connectionProvider&quot;).build())\r\n                .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, connectTimeout)\r\n                .responseTimeout(Duration.ofMillis(responseTimeout));\r\n        return new ReactorClientHttpConnector(httpClient);\r\n    }\r\n```\r\nThe same ReactorClientHttpConnector is used for all WebClients.\r\n\r\nTelegramClient:\r\n```java\r\n    @Autowired\r\n    ReactorClientHttpConnector httpClient;\r\n\r\n    WebClient webClient;\r\n\r\n    RateLimiter rateLimiter;\r\n\r\n    @PostConstruct\r\n    public void init() {\r\n        webClient = WebClient.builder()\r\n                .clientConnector(httpClient)\r\n                .baseUrl(telegramUrl)\r\n                .build();\r\n\r\n        rateLimiter = RateLimiter.of(&quot;telegram-rate-limiter&quot;,\r\n                RateLimiterConfig.custom()\r\n                        .limitRefreshPeriod(Duration.ofMinutes(1))\r\n                        .limitForPeriod(20)\r\n                        .build());\r\n    }\r\n\r\n    public void sendMessage(@PathVariable(&quot;token&quot;) String token, @RequestParam(&quot;chat_id&quot;) long chatId, @RequestParam(&quot;text&quot;) String message) {\r\n        webClient.post().uri(String.format(&quot;/bot%s/sendMessage&quot;, token))\r\n                .contentType(MediaType.APPLICATION_JSON)\r\n                .body(BodyInserters.fromFormData(&quot;chat_id&quot;, String.valueOf(chatId))\r\n                        .with(&quot;text&quot;, message))\r\n                .retrieve()\r\n                .bodyToMono(Void.class)\r\n                .transformDeferred(RateLimiterOperator.of(rateLimiter))\r\n                .block();\r\n    }\r\n```\r\nThe RateLimiter is used to ensure the number of requests does not exceed 20 a minute as specified in the Telegram API.\r\n\r\nWhen the app is started, all requests are resolved normally as expected. But after some time has passed, all requests seem to get stuck. The amount of time needed for this to happen can vary from a few hours to a few days. It happens for all requests to different hosts and is easily noticeable when messages from the TelegramBot stops. Once the requests get stuck, they are stuck indefinitely and I have to restart the app to get it working again.\r\n\r\nThere are no exceptions in the log that seem to have caused this. Since I maintain a queue for my telegram messages, I can see the point in time when the requests stop when the number of messages in the queue steadily increases and when errors happen in the other processes that are waiting for the requests to resolve.\r\n\r\nIt does not seem like the requests are even sent out as the connect timeout and response timeout that I have set do not take effect. \r\n\r\nI had previously also tried setting idle time to 0 but that did not solve the problem\r\n```java\r\n    @Bean\r\n    public ReactorClientHttpConnector httpClient() {\r\n        HttpClient httpClient = HttpClient.create(ConnectionProvider.builder(&quot;connectionProvider&quot;).maxConnections(1000).maxIdleTime(Duration.ofSeconds(0)).build())\r\n        HttpClient httpClient = HttpClient.newConnection()\r\n                .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, connectTimeout)\r\n                .responseTimeout(Duration.ofMillis(responseTimeout));\r\n        return new ReactorClientHttpConnector(httpClient);\r\n    }\r\n```\r\n\r\n**Update:**\r\n\r\nI enabled metrics and viewed it using micrometer when it got stuck. Interestingly, it shows that there is one connection for Telegram, but also shows no connections on idle, pending or active.\r\n```\r\nreactor_netty_connection_provider_idle_connections{id=&quot;-1268283746&quot;,name=&quot;connectionProvider&quot;,remote_address=&quot;api.telegram.org:443&quot;,} 0.0\r\nreactor_netty_connection_provider_pending_connections{id=&quot;-1268283746&quot;,name=&quot;connectionProvider&quot;,remote_address=&quot;api.telegram.org:443&quot;,} 0.0\r\nreactor_netty_connection_provider_active_connections{id=&quot;-1268283746&quot;,name=&quot;connectionProvider&quot;,remote_address=&quot;api.telegram.org:443&quot;,} 0.0\r\nreactor_netty_connection_provider_total_connections{id=&quot;-1268283746&quot;,name=&quot;connectionProvider&quot;,remote_address=&quot;api.telegram.org:443&quot;,} 1.0\r\n```\r\nCould the issue be this missing connection?\r\n\r\n**Update 2:**\r\n\r\nI thought this might be related to this other issue: https://stackoverflow.com/questions/60833824/closing-reactor-netty-connection-on-error-status-codes\r\n\r\nSo I updated my HttpClient to this:\r\n```java\r\n    @Bean\r\n    public ReactorClientHttpConnector httpClient() {\r\n        HttpClient httpClient = HttpClient.create(ConnectionProvider.builder(&quot;connectionProvider&quot;).metrics(true).build())\r\n                .doAfterResponseSuccess((r, c) -&gt; c.dispose())\r\n                .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, connectTimeout)\r\n                .responseTimeout(Duration.ofMillis(responseTimeout));\r\n        return new ReactorClientHttpConnector(httpClient);\r\n    }\r\n```\r\nBut all that seemed to do is accelerate the occurrence of the problem. Just like before, the active, pending and idle connections do not add up to the total connections. The total is always greater than the other 3 metrics added together.\r\n\r\n**Update 3:**\r\nI did a thread dump when the issue happened. There were a total of 74 threads, so I don&#39;t think the app is running out of threads. \r\n\r\nThe dump for the Telegram thread:\r\n```\r\n&quot;TelegramBot&quot; #20 daemon prio=5 os_prio=0 cpu=14.65ms elapsed=47154.24s tid=0x00007f6b28e73000 nid=0x1c waiting on condition  [0x00007f6aed6fb000]\r\n   java.lang.Thread.State: WAITING (parking)\r\n        at jdk.internal.misc.Unsafe.park(java.base@11.0.13/Native Method)\r\n        - parking to wait for  &lt;0x00000000fa865c80&gt; (a java.util.concurrent.CountDownLatch$Sync)\r\n        at java.util.concurrent.locks.LockSupport.park(java.base@11.0.13/LockSupport.java:194)\r\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(java.base@11.0.13/AbstractQueuedSynchronizer.java:885)\r\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(java.base@11.0.13/AbstractQueuedSynchronizer.java:1039)\r\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(java.base@11.0.13/AbstractQueuedSynchronizer.java:1345)\r\n        at java.util.concurrent.CountDownLatch.await(java.base@11.0.13/CountDownLatch.java:232)\r\n        at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:87)\r\n        at reactor.core.publisher.Mono.block(Mono.java:1707)\r\n        at com.moon.arbitrage.cm.feign.TelegramClient.sendMessage(TelegramClient.java:59)\r\n        at com.moon.arbitrage.cm.service.TelegramService.lambda$sendArbMessage$0(TelegramService.java:53)\r\n        at com.moon.arbitrage.cm.service.TelegramService$$Lambda$1092/0x000000084070f840.run(Unknown Source)\r\n        at com.moon.arbitrage.cm.service.TelegramService.task(TelegramService.java:82)\r\n        at com.moon.arbitrage.cm.service.TelegramService$$Lambda$920/0x0000000840665040.run(Unknown Source)\r\n        at java.lang.Thread.run(java.base@11.0.13/Thread.java:829)\r\n\r\n   Locked ownable synchronizers:\r\n        - None\r\n```\r\nThe reactor worker threads:\r\n```\r\n&quot;reactor-http-epoll-1&quot; #15 daemon prio=5 os_prio=0 cpu=810.44ms elapsed=47157.07s tid=0x00007f6b281c4000 nid=0x17 runnable  [0x00007f6b0c46c000]\r\n   java.lang.Thread.State: RUNNABLE\r\n        at io.netty.channel.epoll.Native.epollWait0(Native Method)\r\n        at io.netty.channel.epoll.Native.epollWait(Native.java:177)\r\n        at io.netty.channel.epoll.EpollEventLoop.epollWait(EpollEventLoop.java:286)\r\n        at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:351)\r\n        at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\r\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\r\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n        at java.lang.Thread.run(java.base@11.0.13/Thread.java:829)\r\n\r\n   Locked ownable synchronizers:\r\n        - None\r\n\r\n&quot;reactor-http-epoll-2&quot; #16 daemon prio=5 os_prio=0 cpu=1312.16ms elapsed=47157.07s tid=0x00007f6b281c5000 nid=0x18 waiting on condition  [0x00007f6b0c369000]\r\n   java.lang.Thread.State: WAITING (parking)\r\n        at jdk.internal.misc.Unsafe.park(java.base@11.0.13/Native Method)\r\n        - parking to wait for  &lt;0x00000000fa865948&gt; (a java.util.concurrent.CompletableFuture$Signaller)\r\n        at java.util.concurrent.locks.LockSupport.park(java.base@11.0.13/LockSupport.java:194)\r\n        at java.util.concurrent.CompletableFuture$Signaller.block(java.base@11.0.13/CompletableFuture.java:1796)\r\n        at java.util.concurrent.ForkJoinPool.managedBlock(java.base@11.0.13/ForkJoinPool.java:3128)\r\n        at java.util.concurrent.CompletableFuture.waitingGet(java.base@11.0.13/CompletableFuture.java:1823)\r\n        at java.util.concurrent.CompletableFuture.get(java.base@11.0.13/CompletableFuture.java:1998)\r\n        at com.moon.arbitrage.cm.service.OrderService.reconcileOrder(OrderService.java:103)\r\n        at com.moon.arbitrage.cm.service.BotService$BotTask.lambda$task$1(BotService.java:383)\r\n        at com.moon.arbitrage.cm.service.BotService$BotTask$$Lambda$1161/0x00000008400af440.accept(Unknown Source)\r\n        at reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.onNext(MonoPeekTerminal.java:171)\r\n        at reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.onNext(MonoPeekTerminal.java:180)\r\n        at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1816)\r\n        at reactor.core.publisher.MonoFlatMap$FlatMapInner.onNext(MonoFlatMap.java:249)\r\n        at reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onNext(FluxOnErrorResume.java:79)\r\n        at reactor.core.publisher.FluxOnAssembly$OnAssemblySubscriber.onNext(FluxOnAssembly.java:539)\r\n        at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1816)\r\n        at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:151)\r\n        at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onNext(FluxContextWrite.java:107)\r\n        at reactor.core.publisher.FluxMapFuseable$MapFuseableConditionalSubscriber.onNext(FluxMapFuseable.java:295)\r\n        at reactor.core.publisher.FluxFilterFuseable$FilterFuseableConditionalSubscriber.onNext(FluxFilterFuseable.java:337)\r\n        at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1816)\r\n        at reactor.core.publisher.MonoCollect$CollectSubscriber.onComplete(MonoCollect.java:159)\r\n        at reactor.core.publisher.FluxMap$MapSubscriber.onComplete(FluxMap.java:142)\r\n        at reactor.core.publisher.FluxPeek$PeekSubscriber.onComplete(FluxPeek.java:260)\r\n        at reactor.core.publisher.FluxMap$MapSubscriber.onComplete(FluxMap.java:142)\r\n        at reactor.netty.channel.FluxReceive.onInboundComplete(FluxReceive.java:400)\r\n        at reactor.netty.channel.ChannelOperations.onInboundComplete(ChannelOperations.java:419)\r\n        at reactor.netty.channel.ChannelOperations.terminate(ChannelOperations.java:473)\r\n        at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:702)\r\n        at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:93)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)\r\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)\r\n        at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)\r\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)\r\n        at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\r\n        at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324)\r\n        at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296)\r\n        at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)\r\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)\r\n        at io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1372)\r\n        at io.netty.handler.ssl.SslHandler.decodeJdkCompatible(SslHandler.java:1235)\r\n        at io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1284)\r\n        at io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:507)\r\n        at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:446)\r\n        at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)\r\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)\r\n        at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)\r\n        at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\r\n        at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)\r\n        at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480)\r\n        at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378)\r\n        at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\r\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\r\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n        at java.lang.Thread.run(java.base@11.0.13/Thread.java:829)\r\n\r\n   Locked ownable synchronizers:\r\n        - None\r\n\r\n&quot;reactor-http-epoll-3&quot; #17 daemon prio=5 os_prio=0 cpu=171.84ms elapsed=47157.07s tid=0x00007f6b28beb000 nid=0x19 runnable  [0x00007f6b0c26a000]\r\n   java.lang.Thread.State: RUNNABLE\r\n        at io.netty.channel.epoll.Native.epollWait0(Native Method)\r\n        at io.netty.channel.epoll.Native.epollWait(Native.java:177)\r\n        at io.netty.channel.epoll.EpollEventLoop.epollWait(EpollEventLoop.java:281)\r\n        at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:351)\r\n        at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\r\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\r\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n        at java.lang.Thread.run(java.base@11.0.13/Thread.java:829)\r\n\r\n   Locked ownable synchronizers:\r\n        - None\r\n\r\n&quot;reactor-http-epoll-4&quot; #18 daemon prio=5 os_prio=0 cpu=188.10ms elapsed=47157.07s tid=0x00007f6b28b7d800 nid=0x1a runnable  [0x00007f6b0c169000]\r\n   java.lang.Thread.State: RUNNABLE\r\n        at io.netty.channel.epoll.Native.epollWait0(Native Method)\r\n        at io.netty.channel.epoll.Native.epollWait(Native.java:177)\r\n        at io.netty.channel.epoll.EpollEventLoop.epollWait(EpollEventLoop.java:281)\r\n        at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:351)\r\n        at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\r\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\r\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n        at java.lang.Thread.run(java.base@11.0.13/Thread.java:829)\r\n\r\n   Locked ownable synchronizers:\r\n        - None\r\n```\r\nSeems like one of them is blocked with another task (that isn&#39;t even from the Telegram service) but that shouldn&#39;t be an issue since the other three worker threads are runnable right?","title":"Spring Boot WebClient stops sending requests","body":"<p>I am running a Spring Boot app that uses WebClient for both non-blocking and blocking HTTP requests. After the app has run for some time, all outgoing HTTP requests seem to get stuck.</p>\n<p>WebClient is used to send requests to multiple hosts, but as an example, here is how it is initialized and used to send requests to Telegram:</p>\n<p>WebClientConfig:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @Bean\n    public ReactorClientHttpConnector httpClient() {\n        HttpClient.create(ConnectionProvider.builder(&quot;connectionProvider&quot;).build())\n                .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, connectTimeout)\n                .responseTimeout(Duration.ofMillis(responseTimeout));\n        return new ReactorClientHttpConnector(httpClient);\n    }\n</code></pre>\n<p>The same ReactorClientHttpConnector is used for all WebClients.</p>\n<p>TelegramClient:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @Autowired\n    ReactorClientHttpConnector httpClient;\n\n    WebClient webClient;\n\n    RateLimiter rateLimiter;\n\n    @PostConstruct\n    public void init() {\n        webClient = WebClient.builder()\n                .clientConnector(httpClient)\n                .baseUrl(telegramUrl)\n                .build();\n\n        rateLimiter = RateLimiter.of(&quot;telegram-rate-limiter&quot;,\n                RateLimiterConfig.custom()\n                        .limitRefreshPeriod(Duration.ofMinutes(1))\n                        .limitForPeriod(20)\n                        .build());\n    }\n\n    public void sendMessage(@PathVariable(&quot;token&quot;) String token, @RequestParam(&quot;chat_id&quot;) long chatId, @RequestParam(&quot;text&quot;) String message) {\n        webClient.post().uri(String.format(&quot;/bot%s/sendMessage&quot;, token))\n                .contentType(MediaType.APPLICATION_JSON)\n                .body(BodyInserters.fromFormData(&quot;chat_id&quot;, String.valueOf(chatId))\n                        .with(&quot;text&quot;, message))\n                .retrieve()\n                .bodyToMono(Void.class)\n                .transformDeferred(RateLimiterOperator.of(rateLimiter))\n                .block();\n    }\n</code></pre>\n<p>The RateLimiter is used to ensure the number of requests does not exceed 20 a minute as specified in the Telegram API.</p>\n<p>When the app is started, all requests are resolved normally as expected. But after some time has passed, all requests seem to get stuck. The amount of time needed for this to happen can vary from a few hours to a few days. It happens for all requests to different hosts and is easily noticeable when messages from the TelegramBot stops. Once the requests get stuck, they are stuck indefinitely and I have to restart the app to get it working again.</p>\n<p>There are no exceptions in the log that seem to have caused this. Since I maintain a queue for my telegram messages, I can see the point in time when the requests stop when the number of messages in the queue steadily increases and when errors happen in the other processes that are waiting for the requests to resolve.</p>\n<p>It does not seem like the requests are even sent out as the connect timeout and response timeout that I have set do not take effect.</p>\n<p>I had previously also tried setting idle time to 0 but that did not solve the problem</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @Bean\n    public ReactorClientHttpConnector httpClient() {\n        HttpClient httpClient = HttpClient.create(ConnectionProvider.builder(&quot;connectionProvider&quot;).maxConnections(1000).maxIdleTime(Duration.ofSeconds(0)).build())\n        HttpClient httpClient = HttpClient.newConnection()\n                .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, connectTimeout)\n                .responseTimeout(Duration.ofMillis(responseTimeout));\n        return new ReactorClientHttpConnector(httpClient);\n    }\n</code></pre>\n<p><strong>Update:</strong></p>\n<p>I enabled metrics and viewed it using micrometer when it got stuck. Interestingly, it shows that there is one connection for Telegram, but also shows no connections on idle, pending or active.</p>\n<pre><code>reactor_netty_connection_provider_idle_connections{id=&quot;-1268283746&quot;,name=&quot;connectionProvider&quot;,remote_address=&quot;api.telegram.org:443&quot;,} 0.0\nreactor_netty_connection_provider_pending_connections{id=&quot;-1268283746&quot;,name=&quot;connectionProvider&quot;,remote_address=&quot;api.telegram.org:443&quot;,} 0.0\nreactor_netty_connection_provider_active_connections{id=&quot;-1268283746&quot;,name=&quot;connectionProvider&quot;,remote_address=&quot;api.telegram.org:443&quot;,} 0.0\nreactor_netty_connection_provider_total_connections{id=&quot;-1268283746&quot;,name=&quot;connectionProvider&quot;,remote_address=&quot;api.telegram.org:443&quot;,} 1.0\n</code></pre>\n<p>Could the issue be this missing connection?</p>\n<p><strong>Update 2:</strong></p>\n<p>I thought this might be related to this other issue: <a href=\"https://stackoverflow.com/questions/60833824/closing-reactor-netty-connection-on-error-status-codes\">Closing Reactor Netty connection on error status codes</a></p>\n<p>So I updated my HttpClient to this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @Bean\n    public ReactorClientHttpConnector httpClient() {\n        HttpClient httpClient = HttpClient.create(ConnectionProvider.builder(&quot;connectionProvider&quot;).metrics(true).build())\n                .doAfterResponseSuccess((r, c) -&gt; c.dispose())\n                .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, connectTimeout)\n                .responseTimeout(Duration.ofMillis(responseTimeout));\n        return new ReactorClientHttpConnector(httpClient);\n    }\n</code></pre>\n<p>But all that seemed to do is accelerate the occurrence of the problem. Just like before, the active, pending and idle connections do not add up to the total connections. The total is always greater than the other 3 metrics added together.</p>\n<p><strong>Update 3:</strong>\nI did a thread dump when the issue happened. There were a total of 74 threads, so I don't think the app is running out of threads.</p>\n<p>The dump for the Telegram thread:</p>\n<pre><code>&quot;TelegramBot&quot; #20 daemon prio=5 os_prio=0 cpu=14.65ms elapsed=47154.24s tid=0x00007f6b28e73000 nid=0x1c waiting on condition  [0x00007f6aed6fb000]\n   java.lang.Thread.State: WAITING (parking)\n        at jdk.internal.misc.Unsafe.park(java.base@11.0.13/Native Method)\n        - parking to wait for  &lt;0x00000000fa865c80&gt; (a java.util.concurrent.CountDownLatch$Sync)\n        at java.util.concurrent.locks.LockSupport.park(java.base@11.0.13/LockSupport.java:194)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(java.base@11.0.13/AbstractQueuedSynchronizer.java:885)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(java.base@11.0.13/AbstractQueuedSynchronizer.java:1039)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(java.base@11.0.13/AbstractQueuedSynchronizer.java:1345)\n        at java.util.concurrent.CountDownLatch.await(java.base@11.0.13/CountDownLatch.java:232)\n        at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:87)\n        at reactor.core.publisher.Mono.block(Mono.java:1707)\n        at com.moon.arbitrage.cm.feign.TelegramClient.sendMessage(TelegramClient.java:59)\n        at com.moon.arbitrage.cm.service.TelegramService.lambda$sendArbMessage$0(TelegramService.java:53)\n        at com.moon.arbitrage.cm.service.TelegramService$$Lambda$1092/0x000000084070f840.run(Unknown Source)\n        at com.moon.arbitrage.cm.service.TelegramService.task(TelegramService.java:82)\n        at com.moon.arbitrage.cm.service.TelegramService$$Lambda$920/0x0000000840665040.run(Unknown Source)\n        at java.lang.Thread.run(java.base@11.0.13/Thread.java:829)\n\n   Locked ownable synchronizers:\n        - None\n</code></pre>\n<p>The reactor worker threads:</p>\n<pre><code>&quot;reactor-http-epoll-1&quot; #15 daemon prio=5 os_prio=0 cpu=810.44ms elapsed=47157.07s tid=0x00007f6b281c4000 nid=0x17 runnable  [0x00007f6b0c46c000]\n   java.lang.Thread.State: RUNNABLE\n        at io.netty.channel.epoll.Native.epollWait0(Native Method)\n        at io.netty.channel.epoll.Native.epollWait(Native.java:177)\n        at io.netty.channel.epoll.EpollEventLoop.epollWait(EpollEventLoop.java:286)\n        at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:351)\n        at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n        at java.lang.Thread.run(java.base@11.0.13/Thread.java:829)\n\n   Locked ownable synchronizers:\n        - None\n\n&quot;reactor-http-epoll-2&quot; #16 daemon prio=5 os_prio=0 cpu=1312.16ms elapsed=47157.07s tid=0x00007f6b281c5000 nid=0x18 waiting on condition  [0x00007f6b0c369000]\n   java.lang.Thread.State: WAITING (parking)\n        at jdk.internal.misc.Unsafe.park(java.base@11.0.13/Native Method)\n        - parking to wait for  &lt;0x00000000fa865948&gt; (a java.util.concurrent.CompletableFuture$Signaller)\n        at java.util.concurrent.locks.LockSupport.park(java.base@11.0.13/LockSupport.java:194)\n        at java.util.concurrent.CompletableFuture$Signaller.block(java.base@11.0.13/CompletableFuture.java:1796)\n        at java.util.concurrent.ForkJoinPool.managedBlock(java.base@11.0.13/ForkJoinPool.java:3128)\n        at java.util.concurrent.CompletableFuture.waitingGet(java.base@11.0.13/CompletableFuture.java:1823)\n        at java.util.concurrent.CompletableFuture.get(java.base@11.0.13/CompletableFuture.java:1998)\n        at com.moon.arbitrage.cm.service.OrderService.reconcileOrder(OrderService.java:103)\n        at com.moon.arbitrage.cm.service.BotService$BotTask.lambda$task$1(BotService.java:383)\n        at com.moon.arbitrage.cm.service.BotService$BotTask$$Lambda$1161/0x00000008400af440.accept(Unknown Source)\n        at reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.onNext(MonoPeekTerminal.java:171)\n        at reactor.core.publisher.MonoPeekTerminal$MonoTerminalPeekSubscriber.onNext(MonoPeekTerminal.java:180)\n        at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1816)\n        at reactor.core.publisher.MonoFlatMap$FlatMapInner.onNext(MonoFlatMap.java:249)\n        at reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onNext(FluxOnErrorResume.java:79)\n        at reactor.core.publisher.FluxOnAssembly$OnAssemblySubscriber.onNext(FluxOnAssembly.java:539)\n        at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1816)\n        at reactor.core.publisher.MonoFlatMap$FlatMapMain.onNext(MonoFlatMap.java:151)\n        at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onNext(FluxContextWrite.java:107)\n        at reactor.core.publisher.FluxMapFuseable$MapFuseableConditionalSubscriber.onNext(FluxMapFuseable.java:295)\n        at reactor.core.publisher.FluxFilterFuseable$FilterFuseableConditionalSubscriber.onNext(FluxFilterFuseable.java:337)\n        at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1816)\n        at reactor.core.publisher.MonoCollect$CollectSubscriber.onComplete(MonoCollect.java:159)\n        at reactor.core.publisher.FluxMap$MapSubscriber.onComplete(FluxMap.java:142)\n        at reactor.core.publisher.FluxPeek$PeekSubscriber.onComplete(FluxPeek.java:260)\n        at reactor.core.publisher.FluxMap$MapSubscriber.onComplete(FluxMap.java:142)\n        at reactor.netty.channel.FluxReceive.onInboundComplete(FluxReceive.java:400)\n        at reactor.netty.channel.ChannelOperations.onInboundComplete(ChannelOperations.java:419)\n        at reactor.netty.channel.ChannelOperations.terminate(ChannelOperations.java:473)\n        at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:702)\n        at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:93)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)\n        at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)\n        at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n        at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324)\n        at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296)\n        at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)\n        at io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1372)\n        at io.netty.handler.ssl.SslHandler.decodeJdkCompatible(SslHandler.java:1235)\n        at io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1284)\n        at io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:507)\n        at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:446)\n        at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)\n        at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)\n        at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n        at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)\n        at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480)\n        at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378)\n        at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n        at java.lang.Thread.run(java.base@11.0.13/Thread.java:829)\n\n   Locked ownable synchronizers:\n        - None\n\n&quot;reactor-http-epoll-3&quot; #17 daemon prio=5 os_prio=0 cpu=171.84ms elapsed=47157.07s tid=0x00007f6b28beb000 nid=0x19 runnable  [0x00007f6b0c26a000]\n   java.lang.Thread.State: RUNNABLE\n        at io.netty.channel.epoll.Native.epollWait0(Native Method)\n        at io.netty.channel.epoll.Native.epollWait(Native.java:177)\n        at io.netty.channel.epoll.EpollEventLoop.epollWait(EpollEventLoop.java:281)\n        at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:351)\n        at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n        at java.lang.Thread.run(java.base@11.0.13/Thread.java:829)\n\n   Locked ownable synchronizers:\n        - None\n\n&quot;reactor-http-epoll-4&quot; #18 daemon prio=5 os_prio=0 cpu=188.10ms elapsed=47157.07s tid=0x00007f6b28b7d800 nid=0x1a runnable  [0x00007f6b0c169000]\n   java.lang.Thread.State: RUNNABLE\n        at io.netty.channel.epoll.Native.epollWait0(Native Method)\n        at io.netty.channel.epoll.Native.epollWait(Native.java:177)\n        at io.netty.channel.epoll.EpollEventLoop.epollWait(EpollEventLoop.java:281)\n        at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:351)\n        at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n        at java.lang.Thread.run(java.base@11.0.13/Thread.java:829)\n\n   Locked ownable synchronizers:\n        - None\n</code></pre>\n<p>Seems like one of them is blocked with another task (that isn't even from the Telegram service) but that shouldn't be an issue since the other three worker threads are runnable right?</p>\n"},{"tags":["java","mockito","project-reactor"],"answers":[{"tags":[],"owner":{"account_id":19395247,"reputation":3208,"user_id":14183092,"display_name":"kerbermeister"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672913896,"creation_date":1672913896,"answer_id":75016891,"question_id":74881845,"body_markdown":"Your mock is okay, there&#39;s nothing wrong with that.\r\n\r\nYou should use transform() instead of publish() in your Foo class.\r\nSince publish() turns your stream into the hot-publisher. This is the reason why you&#39;re seeing such effect.\r\n\r\nSo your code should look something like:\r\n\r\n     public Mono&lt;Void&gt; deleteRelated(String id) {\r\n            return findById(id)\r\n                    .log()\r\n                    .transform(bar::delete)\r\n                    .collectList()\r\n                    .then();\r\n     }\r\n\r\nAlso there&#39;s no need to use `Mono.just(id)` with `flatMapMany()` since you can call your method with returning Flux directly","title":"Unit testing Project Reactor&#39;s publish","body":"<p>Your mock is okay, there's nothing wrong with that.</p>\n<p>You should use transform() instead of publish() in your Foo class.\nSince publish() turns your stream into the hot-publisher. This is the reason why you're seeing such effect.</p>\n<p>So your code should look something like:</p>\n<pre><code> public Mono&lt;Void&gt; deleteRelated(String id) {\n        return findById(id)\n                .log()\n                .transform(bar::delete)\n                .collectList()\n                .then();\n }\n</code></pre>\n<p>Also there's no need to use <code>Mono.just(id)</code> with <code>flatMapMany()</code> since you can call your method with returning Flux directly</p>\n"}],"owner":{"account_id":2733030,"reputation":33,"user_id":2356353,"display_name":"Lucas"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":459,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1672913896,"creation_date":1671657378,"question_id":74881845,"body_markdown":"Suppose you need to mock a method that accepts a flux.\r\n\r\n``` java\r\n@ExtendWith(MockitoExtension.class)\r\npublic class FooTest {\r\n    @Mock Bar bar;\r\n    @InjectMocks Foo foo;\r\n\r\n    @Test\r\n    void test() {\r\n        when(bar.delete(any())).thenReturn(Mono.empty());\r\n\r\n        StepVerifier.create(foo.deleteRelated(&quot;123&quot;))\r\n                .expectNext()\r\n                .verifyComplete();\r\n    }\r\n}\r\n```\r\n\r\n``` java\r\npublic class Foo {\r\n    private final Bar bar;\r\n    public Foo(Bar bar) {\r\n        this.bar = bar;\r\n    }\r\n\r\n    public Mono&lt;Void&gt; deleteRelated(String id) {\r\n        return Mono.just(id)\r\n                .flatMapMany(this::findById)\r\n                .log()\r\n                .publish(bar::delete)\r\n                .collectList()\r\n                .then();\r\n    }\r\n\r\n    private Flux&lt;String&gt; findById(String id) {\r\n        return Flux.just(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;);\r\n    }\r\n}\r\n```\r\n\r\n``` java\r\npublic class Bar {\r\n    public Mono&lt;Void&gt; delete(Flux&lt;String&gt; vals) {\r\n        return vals.buffer(3)\r\n                .flatMap(this::deleteAFewAtATime)\r\n                .collectList()\r\n                .then();\r\n    }\r\n\r\n    private Mono&lt;Void&gt; deleteAFewAtATime(List&lt;String&gt; key) {\r\n        return Mono.empty();\r\n    }\r\n}\r\n```\r\n\r\n\r\nRunning this test results in an output with a cancel:\r\n``` \r\nreactor.Flux.MonoFlatMapMany.1 : onSubscribe([Synchronous Fuseable] FluxArray.ArraySubscription)\r\nreactor.Flux.MonoFlatMapMany.1 : cancel()\r\n```\r\n\r\nI wouldn&#39;t have expected the cancel signal to be emitted. I believe this is because the input to `bar.delete()` was not subscribed to.\r\n\r\nHow can I mock a function with a Flux as an input, and have that Flux be subscribed to?","title":"Unit testing Project Reactor&#39;s publish","body":"<p>Suppose you need to mock a method that accepts a flux.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@ExtendWith(MockitoExtension.class)\npublic class FooTest {\n    @Mock Bar bar;\n    @InjectMocks Foo foo;\n\n    @Test\n    void test() {\n        when(bar.delete(any())).thenReturn(Mono.empty());\n\n        StepVerifier.create(foo.deleteRelated(&quot;123&quot;))\n                .expectNext()\n                .verifyComplete();\n    }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>public class Foo {\n    private final Bar bar;\n    public Foo(Bar bar) {\n        this.bar = bar;\n    }\n\n    public Mono&lt;Void&gt; deleteRelated(String id) {\n        return Mono.just(id)\n                .flatMapMany(this::findById)\n                .log()\n                .publish(bar::delete)\n                .collectList()\n                .then();\n    }\n\n    private Flux&lt;String&gt; findById(String id) {\n        return Flux.just(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;);\n    }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>public class Bar {\n    public Mono&lt;Void&gt; delete(Flux&lt;String&gt; vals) {\n        return vals.buffer(3)\n                .flatMap(this::deleteAFewAtATime)\n                .collectList()\n                .then();\n    }\n\n    private Mono&lt;Void&gt; deleteAFewAtATime(List&lt;String&gt; key) {\n        return Mono.empty();\n    }\n}\n</code></pre>\n<p>Running this test results in an output with a cancel:</p>\n<pre><code>reactor.Flux.MonoFlatMapMany.1 : onSubscribe([Synchronous Fuseable] FluxArray.ArraySubscription)\nreactor.Flux.MonoFlatMapMany.1 : cancel()\n</code></pre>\n<p>I wouldn't have expected the cancel signal to be emitted. I believe this is because the input to <code>bar.delete()</code> was not subscribed to.</p>\n<p>How can I mock a function with a Flux as an input, and have that Flux be subscribed to?</p>\n"},{"tags":["java","inputstream","ghost4j"],"comments":[{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":1,"creation_date":1672828983,"post_id":75003950,"comment_id":132359499,"body_markdown":"I don&#39;t know this file format but I think it&#39;s quite likely to be impossible to parse a partially-read file.","body":"I don&#39;t know this file format but I think it&#39;s quite likely to be impossible to parse a partially-read file."},{"owner":{"account_id":25126031,"reputation":63,"user_id":18973819,"display_name":"Mirai"},"score":0,"creation_date":1672928752,"post_id":75003950,"comment_id":132387044,"body_markdown":"I agree, with the solution i posted my application is a bit slow when i have to load a new set of pages, but considering is a print program, maybe the user has no real interest in navigating all the pages of file in the Print Preview","body":"I agree, with the solution i posted my application is a bit slow when i have to load a new set of pages, but considering is a print program, maybe the user has no real interest in navigating all the pages of file in the Print Preview"}],"answers":[{"comments":[{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":1,"creation_date":1672926333,"post_id":75016868,"comment_id":132386065,"body_markdown":"I just used this Ghostscript command successfully to print the number of pages in input.pdf so you might be able to adapt it: `gs -q -dNODISPLAY --permit-file-read=input.pdf -c &quot;(input.pdf) (r) file runpdfbegin pdfpagecount = quit&quot; ` I know next to nothing about Ghostscript but @K-J might be able to help","body":"I just used this Ghostscript command successfully to print the number of pages in input.pdf so you might be able to adapt it: <code>gs -q -dNODISPLAY --permit-file-read=input.pdf -c &quot;(input.pdf) (r) file runpdfbegin pdfpagecount = quit&quot; </code> I know next to nothing about Ghostscript but @K-J might be able to help"},{"owner":{"account_id":25126031,"reputation":63,"user_id":18973819,"display_name":"Mirai"},"score":0,"creation_date":1672928978,"post_id":75016868,"comment_id":132387136,"body_markdown":"Thank you! I will try to adapt it with a PS file, where did you fine this command? I have read a lot on Ghostscript documentation, didn&#39;t find anything. I am not so good in english maybe i missed it","body":"Thank you! I will try to adapt it with a PS file, where did you fine this command? I have read a lot on Ghostscript documentation, didn&#39;t find anything. I am not so good in english maybe i missed it"},{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":1,"creation_date":1672930149,"post_id":75016868,"comment_id":132387570,"body_markdown":"I found a lot of similar commands from googling but had to do quite a bit of trial and error before I could get it to work on my system. `pdfinfo` is easier ;)","body":"I found a lot of similar commands from googling but had to do quite a bit of trial and error before I could get it to work on my system. <code>pdfinfo</code> is easier ;)"},{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1673352458,"post_id":75016868,"comment_id":132474759,"body_markdown":"Fiendish stuff ;)","body":"Fiendish stuff ;)"}],"tags":[],"owner":{"account_id":25126031,"reputation":63,"user_id":18973819,"display_name":"Mirai"},"comment_count":4,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672913713,"creation_date":1672913713,"answer_id":75016868,"question_id":75003950,"body_markdown":"I found out I can use Ghost4J Core API to retrieve from a Post Script file a reduced set of pages as Images.\r\n\r\n```\r\nGhostscript gs = Ghostscript.getInstance();\r\n\r\nString[] gsArgs = new String[9];\r\n        gsArgs[0] = &quot;-dQUIET&quot;;\r\n        gsArgs[1] = &quot;-dNOPAUSE&quot;;\r\n        gsArgs[2] = &quot;-dBATCH&quot;;\r\n        gsArgs[3] = &quot;-dSAFER&quot;;\r\n        gsArgs[4] = &quot;-sDEVICE=display&quot;;\r\n        gsArgs[5] = &quot;-sDisplayHandle=0&quot;;\r\n        gsArgs[6] = &quot;-dDisplayFormat=16#804&quot;;\r\n        gsArgs[7] = &quot;-sPageList=&quot;+firstPage+&quot;-&quot;+lastPage;\r\n        gsArgs[8] = &quot;-f&quot;+filename;\r\n        \r\n         //create display callback (capture display output pages as images)\r\n  ImageWriterDisplayCallback displayCallback = new ImageWriterDisplayCallback();\r\n \r\n        //set display callback\r\n        gs.setDisplayCallback(displayCallback);\r\n        \r\n        //run PostScript (also works with PDF) and exit interpreter\r\n        try {\r\n \r\n            gs.initialize(gsArgs);\r\n            gs.exit();\r\n            Ghostscript.deleteInstance();\r\n \r\n        } catch (GhostscriptException e) {\r\n            System.out.println(&quot;ERROR: &quot; + e.getMessage());\r\n            e.printStackTrace();\r\n        }\r\n\r\n       return displayCallback.getImages(); //return List&lt;Images&gt;\r\n\r\n```\r\nThis solve the problem of rendering page as images in the preview.\r\n\r\nHowever, i could not find a way to use Ghost4J to know total number of pages of PS file (in case the file is too big for opening it with Document.load()).\r\n\r\nSo, i am still here needing some help  ","title":"Rendering big Post Script file with Ghost4J in Java","body":"<p>I found out I can use Ghost4J Core API to retrieve from a Post Script file a reduced set of pages as Images.</p>\n<pre><code>Ghostscript gs = Ghostscript.getInstance();\n\nString[] gsArgs = new String[9];\n        gsArgs[0] = &quot;-dQUIET&quot;;\n        gsArgs[1] = &quot;-dNOPAUSE&quot;;\n        gsArgs[2] = &quot;-dBATCH&quot;;\n        gsArgs[3] = &quot;-dSAFER&quot;;\n        gsArgs[4] = &quot;-sDEVICE=display&quot;;\n        gsArgs[5] = &quot;-sDisplayHandle=0&quot;;\n        gsArgs[6] = &quot;-dDisplayFormat=16#804&quot;;\n        gsArgs[7] = &quot;-sPageList=&quot;+firstPage+&quot;-&quot;+lastPage;\n        gsArgs[8] = &quot;-f&quot;+filename;\n        \n         //create display callback (capture display output pages as images)\n  ImageWriterDisplayCallback displayCallback = new ImageWriterDisplayCallback();\n \n        //set display callback\n        gs.setDisplayCallback(displayCallback);\n        \n        //run PostScript (also works with PDF) and exit interpreter\n        try {\n \n            gs.initialize(gsArgs);\n            gs.exit();\n            Ghostscript.deleteInstance();\n \n        } catch (GhostscriptException e) {\n            System.out.println(&quot;ERROR: &quot; + e.getMessage());\n            e.printStackTrace();\n        }\n\n       return displayCallback.getImages(); //return List&lt;Images&gt;\n\n</code></pre>\n<p>This solve the problem of rendering page as images in the preview.</p>\n<p>However, i could not find a way to use Ghost4J to know total number of pages of PS file (in case the file is too big for opening it with Document.load()).</p>\n<p>So, i am still here needing some help</p>\n"}],"owner":{"account_id":25126031,"reputation":63,"user_id":18973819,"display_name":"Mirai"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":82,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75016868,"answer_count":1,"score":0,"last_activity_date":1672913713,"creation_date":1672827293,"question_id":75003950,"body_markdown":"i made a Java application whose purpose is to offer a Print Preview for PS files.\r\n\r\nMy program uses Ghostscript and Ghost4J to load the Post Script file and produces a list of Images (one for each page) using the SimpleRenderer.render method. Then using a simple JList i show only the image corresponding to the page the user selected in JList. \r\n\r\nThis worked fine until a really big PS file occurred, causing an OutOfMemoryError when executing the code\r\n\r\n```\r\nPSDocument pdocument = new PSDocument(new File(filename));\r\n```\r\n\r\nI know that is possibile to read a file a little at a time using InputStreams, the problem is that i can&#39;t think of a way to connect the bytes that i read with the actual pages of the document.\r\n\r\nExample, i tried to read from PS file 100 MB at a time\r\n\r\n```\r\nint buffer_size = 100000000;\r\nbyte[] buffer = new byte[buffer_size];\r\n\r\nFileInputStream partial = new FileInputStream(filename);\r\npartial.read(buffer, 0, buffer_size);\r\ndocument.load(new ByteArrayInputStream(buffer));\r\n\r\nSimpleRenderer renderer = new SimpleRenderer();\r\n\r\n//how many pages do i have to read?\r\nList&lt;Image&gt; images = renderer.render(document, firstpage ??, lastpage ??);\r\n```\r\nAm i missing some Ghost4J functionality to read partially a file?\r\nOr has someone other suggestions / approaches about how to solve this problem in different ways? \r\nI am really struggling \r\n","title":"Rendering big Post Script file with Ghost4J in Java","body":"<p>i made a Java application whose purpose is to offer a Print Preview for PS files.</p>\n<p>My program uses Ghostscript and Ghost4J to load the Post Script file and produces a list of Images (one for each page) using the SimpleRenderer.render method. Then using a simple JList i show only the image corresponding to the page the user selected in JList.</p>\n<p>This worked fine until a really big PS file occurred, causing an OutOfMemoryError when executing the code</p>\n<pre><code>PSDocument pdocument = new PSDocument(new File(filename));\n</code></pre>\n<p>I know that is possibile to read a file a little at a time using InputStreams, the problem is that i can't think of a way to connect the bytes that i read with the actual pages of the document.</p>\n<p>Example, i tried to read from PS file 100 MB at a time</p>\n<pre><code>int buffer_size = 100000000;\nbyte[] buffer = new byte[buffer_size];\n\nFileInputStream partial = new FileInputStream(filename);\npartial.read(buffer, 0, buffer_size);\ndocument.load(new ByteArrayInputStream(buffer));\n\nSimpleRenderer renderer = new SimpleRenderer();\n\n//how many pages do i have to read?\nList&lt;Image&gt; images = renderer.render(document, firstpage ??, lastpage ??);\n</code></pre>\n<p>Am i missing some Ghost4J functionality to read partially a file?\nOr has someone other suggestions / approaches about how to solve this problem in different ways?\nI am really struggling</p>\n"},{"tags":["java","android","flutter","exoplayer","video-player"],"comments":[{"owner":{"account_id":4007082,"reputation":23327,"user_id":3301492,"display_name":"Boris"},"score":0,"creation_date":1658862459,"post_id":73126292,"comment_id":129156278,"body_markdown":"Is the Certificate Authority (CA) installed and trusted on your device?","body":"Is the Certificate Authority (CA) installed and trusted on your device?"},{"owner":{"account_id":7718452,"reputation":2363,"user_id":5845384,"accept_rate":36,"display_name":"Jitendra Modi"},"score":0,"creation_date":1658889139,"post_id":73126292,"comment_id":129161789,"body_markdown":"@Boris no but what if i release application then everyone should not hve that CA installed on their phone right?","body":"@Boris no but what if i release application then everyone should not hve that CA installed on their phone right?"},{"owner":{"account_id":4007082,"reputation":23327,"user_id":3301492,"display_name":"Boris"},"score":0,"creation_date":1658948786,"post_id":73126292,"comment_id":129181867,"body_markdown":"I don&#39;t know that.","body":"I don&#39;t know that."},{"owner":{"account_id":11640960,"reputation":201,"user_id":8525393,"display_name":"ff .n"},"score":0,"creation_date":1662871866,"post_id":73126292,"comment_id":130104379,"body_markdown":"do you solve this problem?","body":"do you solve this problem?"},{"owner":{"account_id":3223608,"reputation":590,"user_id":2720424,"display_name":"Pruthvi"},"score":0,"creation_date":1672919010,"post_id":73126292,"comment_id":132383530,"body_markdown":"Were you able to resolve this issue ?  -@JitendraModi","body":"Were you able to resolve this issue ?  -@JitendraModi"},{"owner":{"account_id":7718452,"reputation":2363,"user_id":5845384,"accept_rate":36,"display_name":"Jitendra Modi"},"score":0,"creation_date":1673345424,"post_id":73126292,"comment_id":132472604,"body_markdown":"@Pruthvi No, Issue still persists","body":"@Pruthvi No, Issue still persists"}],"owner":{"account_id":7718452,"reputation":2363,"user_id":5845384,"accept_rate":36,"display_name":"Jitendra Modi"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1424,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1672913652,"creation_date":1658850191,"question_id":73126292,"body_markdown":"I am using `video_player: any` in flutter. I am using https server url. All things are working fine, I am able to call api, load images but when I try to load video, I am getting this errors.\r\n\r\n\r\n    E/ExoPlayerImplInternal: Playback error\r\n      com.google.android.exoplayer2.ExoPlaybackException: Source error\r\n        at com.google.android.exoplayer2.ExoPlayerImplInternal.handleMessage(ExoPlayerImplInternal.java:580)\r\n        at android.os.Handler.dispatchMessage(Handler.java:103)\r\n        at android.os.Looper.loop(Looper.java:237)\r\n        at android.os.HandlerThread.run(HandlerThread.java:67)\r\n     Caused by: com.google.android.exoplayer2.upstream.HttpDataSource$HttpDataSourceException: Unable to connect\r\n        at com.google.android.exoplayer2.upstream.DefaultHttpDataSource.open(DefaultHttpDataSource.java:346)\r\n        at com.google.android.exoplayer2.upstream.StatsDataSource.open(StatsDataSource.java:84)\r\n        at com.google.android.exoplayer2.source.ProgressiveMediaPeriod$ExtractingLoadable.load(ProgressiveMediaPeriod.java:1016)\r\n        at com.google.android.exoplayer2.upstream.Loader$LoadTask.run(Loader.java:417)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:641)\r\n        at java.lang.Thread.run(Thread.java:919)\r\n     Caused by: javax.net.ssl.SSLHandshakeException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.\r\n        at com.android.org.conscrypt.ConscryptFileDescriptorSocket.startHandshake(ConscryptFileDescriptorSocket.java:239)\r\n        at com.android.okhttp.internal.io.RealConnection.connectTls(RealConnection.java:1471)\r\n        at com.android.okhttp.internal.io.RealConnection.connectSocket(RealConnection.java:1415)\r\n        at com.android.okhttp.internal.io.RealConnection.connect(RealConnection.java:1359)\r\n        at com.android.okhttp.internal.http.StreamAllocation.findConnection(StreamAllocation.java:221)\r\n        at com.android.okhttp.internal.http.StreamAllocation.findHealthyConnection(StreamAllocation.java:144)\r\n        at com.android.okhttp.internal.http.StreamAllocation.newStream(StreamAllocation.java:106)\r\n        at com.android.okhttp.internal.http.HttpEngine.connect(HttpEngine.java:400)\r\n        at com.android.okhttp.internal.http.HttpEngine.sendRequest(HttpEngine.java:333)\r\n        at com.android.okhttp.internal.huc.HttpURLConnectionImpl.execute(HttpURLConnectionImpl.java:483)\r\n        at com.android.okhttp.internal.huc.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:135)\r\n        at com.android.okhttp.internal.huc.DelegatingHttpsURLConnection.connect(DelegatingHttpsURLConnection.java:90)\r\n        at com.android.okhttp.internal.huc.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:30)\r\n        at com.google.android.exoplayer2.upstream.DefaultHttpDataSource.makeConnection(DefaultHttpDataSource.java:608)\r\n        at com.google.android.exoplayer2.upstream.DefaultHttpDataSource.makeConnection(DefaultHttpDataSource.java:513)\r\n        at com.google.android.exoplayer2.upstream.DefaultHttpDataSource.open(DefaultHttpDataSource.java:339)\r\n        at com.google.android.exoplayer2.upstream.StatsDataSource.open(StatsDataSource.java:84)&#160;\r\n        at com.google.android.exoplayer2.source.ProgressiveMediaPeriod$ExtractingLoadable.load(ProgressiveMediaPeriod.java:1016)&#160;\r\n        at com.google.android.exoplayer2.upstream.Loader$LoadTask.run(Loader.java:417)&#160;\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167)&#160;\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:641)&#160;\r\n        at java.lang.Thread.run(Thread.java:919)&#160;\r\n     Caused by: java.security.cert.CertificateException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.\r\n        at com.android.org.conscrypt.TrustManagerImpl.checkTrustedRecursive(TrustManagerImpl.java:668)\r\n        at com.android.org.conscrypt.TrustManagerImpl.checkTrusted(TrustManagerImpl.java:513)\r\n        at com.android.org.conscrypt.TrustManagerImpl.checkTrusted(TrustManagerImpl.java:432)\r\n        at com.android.org.conscrypt.TrustManagerImpl.getTrustedChainForServer(TrustManagerImpl.java:360)\r\n        at android.security.net.config.NetworkSecurityTrustManager.checkServerTrusted(NetworkSecurityTrustManager.java:94)\r\n        at android.security.net.config.RootTrustManager.checkServerTrusted(RootTrustManager.java:89)\r\n        at com.android.org.conscrypt.Platform.checkServerTrusted(Platform.java:224)\r\n        at com.android.org.conscrypt.ConscryptFileDescriptorSocket.verifyCertificateChain(ConscryptFileDescriptorSocket.java:430)\r\n        at com.android.org.conscrypt.NativeCrypto.SSL_do_handshake(Native Method)\r\n        at com.android.org.conscrypt.NativeSsl.doHandshake(NativeSsl.java:387)\r\n          at com.a\r\n    E/flutter: [ERROR:flutter/lib/ui/ui_dart_state.cc(198)] Unhandled Exception: PlatformException(VideoError, Video player had error com.google.android.exoplayer2.ExoPlaybackException: Source error, null, null)\r\n\r\nI have added security config as follows\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n    &lt;network-security-config&gt;\r\n    &lt;domain-config&gt;\r\n        &lt;domain includeSubdomains=&quot;true&quot;&gt;dxb.suphub.net&lt;/domain&gt;\r\n        &lt;trust-anchors&gt;\r\n            &lt;certificates src=&quot;@raw/my_ca&quot;/&gt;\r\n        &lt;/trust-anchors&gt;\r\n    &lt;/domain-config&gt;\r\n    &lt;/network-security-config&gt;\r\n\r\n\r\nand in Manifest file, I have added following command\r\n\r\n    android:networkSecurityConfig=&quot;@xml/network_security_config&quot;\r\n\r\nStill I am getting this error, Any help would be appreciated.\r\nThank you","title":"Unhandled Exception: PlatformException(VideoError, Video player had error com.google.android.exoplayer2.ExoPlaybackException)","body":"<p>I am using <code>video_player: any</code> in flutter. I am using https server url. All things are working fine, I am able to call api, load images but when I try to load video, I am getting this errors.</p>\n<pre><code>E/ExoPlayerImplInternal: Playback error\n  com.google.android.exoplayer2.ExoPlaybackException: Source error\n    at com.google.android.exoplayer2.ExoPlayerImplInternal.handleMessage(ExoPlayerImplInternal.java:580)\n    at android.os.Handler.dispatchMessage(Handler.java:103)\n    at android.os.Looper.loop(Looper.java:237)\n    at android.os.HandlerThread.run(HandlerThread.java:67)\n Caused by: com.google.android.exoplayer2.upstream.HttpDataSource$HttpDataSourceException: Unable to connect\n    at com.google.android.exoplayer2.upstream.DefaultHttpDataSource.open(DefaultHttpDataSource.java:346)\n    at com.google.android.exoplayer2.upstream.StatsDataSource.open(StatsDataSource.java:84)\n    at com.google.android.exoplayer2.source.ProgressiveMediaPeriod$ExtractingLoadable.load(ProgressiveMediaPeriod.java:1016)\n    at com.google.android.exoplayer2.upstream.Loader$LoadTask.run(Loader.java:417)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:641)\n    at java.lang.Thread.run(Thread.java:919)\n Caused by: javax.net.ssl.SSLHandshakeException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.\n    at com.android.org.conscrypt.ConscryptFileDescriptorSocket.startHandshake(ConscryptFileDescriptorSocket.java:239)\n    at com.android.okhttp.internal.io.RealConnection.connectTls(RealConnection.java:1471)\n    at com.android.okhttp.internal.io.RealConnection.connectSocket(RealConnection.java:1415)\n    at com.android.okhttp.internal.io.RealConnection.connect(RealConnection.java:1359)\n    at com.android.okhttp.internal.http.StreamAllocation.findConnection(StreamAllocation.java:221)\n    at com.android.okhttp.internal.http.StreamAllocation.findHealthyConnection(StreamAllocation.java:144)\n    at com.android.okhttp.internal.http.StreamAllocation.newStream(StreamAllocation.java:106)\n    at com.android.okhttp.internal.http.HttpEngine.connect(HttpEngine.java:400)\n    at com.android.okhttp.internal.http.HttpEngine.sendRequest(HttpEngine.java:333)\n    at com.android.okhttp.internal.huc.HttpURLConnectionImpl.execute(HttpURLConnectionImpl.java:483)\n    at com.android.okhttp.internal.huc.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:135)\n    at com.android.okhttp.internal.huc.DelegatingHttpsURLConnection.connect(DelegatingHttpsURLConnection.java:90)\n    at com.android.okhttp.internal.huc.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:30)\n    at com.google.android.exoplayer2.upstream.DefaultHttpDataSource.makeConnection(DefaultHttpDataSource.java:608)\n    at com.google.android.exoplayer2.upstream.DefaultHttpDataSource.makeConnection(DefaultHttpDataSource.java:513)\n    at com.google.android.exoplayer2.upstream.DefaultHttpDataSource.open(DefaultHttpDataSource.java:339)\n    at com.google.android.exoplayer2.upstream.StatsDataSource.open(StatsDataSource.java:84)¬†\n    at com.google.android.exoplayer2.source.ProgressiveMediaPeriod$ExtractingLoadable.load(ProgressiveMediaPeriod.java:1016)¬†\n    at com.google.android.exoplayer2.upstream.Loader$LoadTask.run(Loader.java:417)¬†\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167)¬†\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:641)¬†\n    at java.lang.Thread.run(Thread.java:919)¬†\n Caused by: java.security.cert.CertificateException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.\n    at com.android.org.conscrypt.TrustManagerImpl.checkTrustedRecursive(TrustManagerImpl.java:668)\n    at com.android.org.conscrypt.TrustManagerImpl.checkTrusted(TrustManagerImpl.java:513)\n    at com.android.org.conscrypt.TrustManagerImpl.checkTrusted(TrustManagerImpl.java:432)\n    at com.android.org.conscrypt.TrustManagerImpl.getTrustedChainForServer(TrustManagerImpl.java:360)\n    at android.security.net.config.NetworkSecurityTrustManager.checkServerTrusted(NetworkSecurityTrustManager.java:94)\n    at android.security.net.config.RootTrustManager.checkServerTrusted(RootTrustManager.java:89)\n    at com.android.org.conscrypt.Platform.checkServerTrusted(Platform.java:224)\n    at com.android.org.conscrypt.ConscryptFileDescriptorSocket.verifyCertificateChain(ConscryptFileDescriptorSocket.java:430)\n    at com.android.org.conscrypt.NativeCrypto.SSL_do_handshake(Native Method)\n    at com.android.org.conscrypt.NativeSsl.doHandshake(NativeSsl.java:387)\n      at com.a\nE/flutter: [ERROR:flutter/lib/ui/ui_dart_state.cc(198)] Unhandled Exception: PlatformException(VideoError, Video player had error com.google.android.exoplayer2.ExoPlaybackException: Source error, null, null)\n</code></pre>\n<p>I have added security config as follows</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;network-security-config&gt;\n&lt;domain-config&gt;\n    &lt;domain includeSubdomains=&quot;true&quot;&gt;dxb.suphub.net&lt;/domain&gt;\n    &lt;trust-anchors&gt;\n        &lt;certificates src=&quot;@raw/my_ca&quot;/&gt;\n    &lt;/trust-anchors&gt;\n&lt;/domain-config&gt;\n&lt;/network-security-config&gt;\n</code></pre>\n<p>and in Manifest file, I have added following command</p>\n<pre><code>android:networkSecurityConfig=&quot;@xml/network_security_config&quot;\n</code></pre>\n<p>Still I am getting this error, Any help would be appreciated.\nThank you</p>\n"},{"tags":["java","java-17"],"owner":{"account_id":25464687,"reputation":1,"user_id":19263923,"display_name":"Ankeet"},"comment_count":0,"delete_vote_count":1,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":27,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1672913564,"answer_count":0,"score":0,"last_activity_date":1672913611,"creation_date":1672913304,"question_id":75016787,"body_markdown":"I am new to Java..\r\n\r\nMy understanding is that to build java program one needs a JDK and to run java programs JRE is needed. I have build my project with Oracle JDK 17. How to run java program the same program if Oracle JDK 17 does not come with JRE","title":"How to run java program using Oracle JDK 17, if Oracle JDK 17 does not come with JRE","body":"<p>I am new to Java..</p>\n<p>My understanding is that to build java program one needs a JDK and to run java programs JRE is needed. I have build my project with Oracle JDK 17. How to run java program the same program if Oracle JDK 17 does not come with JRE</p>\n"},{"tags":["java","sockets","tcp","connection","localhost"],"owner":{"account_id":27295914,"reputation":11,"user_id":20813555,"display_name":"Nihad Alyafi"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":22,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1672913310,"creation_date":1672913223,"question_id":75016768,"body_markdown":"i want to check the connection from android app to the local server, what is the best way to check the connection every X second to do some work when the server is reachable\r\n\r\nfor now, I&#39;m using this code\r\n\r\n```\r\npublic static boolean itsOnline(Context context) {\r\n    String host=&quot;google.com&quot;; //put the local server ip instead \r\n    try {\r\n        StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder()\r\n                .permitAll().build();\r\n\r\n        StrictMode.setThreadPolicy(policy);\r\n\r\n        Socket sock = new Socket();\r\n        SocketAddress sockaddr = new InetSocketAddress(host,443);\r\n\r\n        sock.connect(sockaddr, 2000);\r\n        sock.close();\r\n        Toast.makeText(context.getApplicationContext(), &quot;Connected to : &quot;+ host, Toast.LENGTH_SHORT).show();\r\n\r\n        return true;\r\n    } catch (IOException ioException) {\r\n        Toast.makeText(context.getApplicationContext(), &quot;Not Connected to : &quot;+host, Toast.LENGTH_LONG).show();\r\n        return false;\r\n    }\r\n```\r\n\r\nbut i want to make it done continually, and if there is a better way i will appreciate any advice.","title":"Checking the connection to local server","body":"<p>i want to check the connection from android app to the local server, what is the best way to check the connection every X second to do some work when the server is reachable</p>\n<p>for now, I'm using this code</p>\n<pre><code>public static boolean itsOnline(Context context) {\n    String host=&quot;google.com&quot;; //put the local server ip instead \n    try {\n        StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder()\n                .permitAll().build();\n\n        StrictMode.setThreadPolicy(policy);\n\n        Socket sock = new Socket();\n        SocketAddress sockaddr = new InetSocketAddress(host,443);\n\n        sock.connect(sockaddr, 2000);\n        sock.close();\n        Toast.makeText(context.getApplicationContext(), &quot;Connected to : &quot;+ host, Toast.LENGTH_SHORT).show();\n\n        return true;\n    } catch (IOException ioException) {\n        Toast.makeText(context.getApplicationContext(), &quot;Not Connected to : &quot;+host, Toast.LENGTH_LONG).show();\n        return false;\n    }\n</code></pre>\n<p>but i want to make it done continually, and if there is a better way i will appreciate any advice.</p>\n"},{"tags":["java","visual-studio-code"],"comments":[{"owner":{"account_id":25311208,"reputation":7305,"user_id":19133920,"display_name":"JialeDu"},"score":0,"creation_date":1672728754,"post_id":74981600,"comment_id":132334824,"body_markdown":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking. Please see [how to ask](https://stackoverflow.com/help/how-to-ask). \n[minimal reproducible example](https://stackoverflow.com/help/minimal-reproducible-example)","body":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking. Please see <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask</a>.  <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"},{"owner":{"account_id":27306844,"reputation":11,"user_id":20822658,"display_name":"Eml0c"},"score":0,"creation_date":1672738246,"post_id":74981600,"comment_id":132337224,"body_markdown":"Sorry about my english, i just rewrite the quetion","body":"Sorry about my english, i just rewrite the quetion"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1672741535,"post_id":74981600,"comment_id":132338320,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."}],"answers":[{"comments":[{"owner":{"account_id":27306844,"reputation":11,"user_id":20822658,"display_name":"Eml0c"},"score":0,"creation_date":1672840333,"post_id":75002067,"comment_id":132363192,"body_markdown":"I did add folder to source path but doesent work. I open a github issue to ask: [this issue](https://github.com/redhat-developer/vscode-java/issues/2853), and they say it is not possible for the moment. You need to do a jar file or use a build tool. They marked the issue as enhancement","body":"I did add folder to source path but doesent work. I open a github issue to ask: <a href=\"https://github.com/redhat-developer/vscode-java/issues/2853\" rel=\"nofollow noreferrer\">this issue</a>, and they say it is not possible for the moment. You need to do a jar file or use a build tool. They marked the issue as enhancement"}],"tags":[],"owner":{"account_id":25311208,"reputation":7305,"user_id":19133920,"display_name":"JialeDu"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672816685,"creation_date":1672816685,"answer_id":75002067,"question_id":74981600,"body_markdown":"Copying `class0` to `project1` is a simple and effective way. Or add `project0` to `project1&#39;s` source path.\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/TlHpT.png","title":"Error in Visual srudio code java extension: Set other project in source path: The source path must be contained in the project root folder","body":"<p>Copying <code>class0</code> to <code>project1</code> is a simple and effective way. Or add <code>project0</code> to <code>project1's</code> source path.</p>\n<p><a href=\"https://i.stack.imgur.com/TlHpT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TlHpT.png\" alt=\"enter image description here\" /></a></p>\n"},{"tags":[],"owner":{"account_id":27306844,"reputation":11,"user_id":20822658,"display_name":"Eml0c"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672913179,"creation_date":1672913179,"answer_id":75016755,"question_id":74981600,"body_markdown":"I post the same question as a Github Issue (here)[https://github.com/redhat-developer/vscode-java/issues/2853]\r\n\r\nAs they said: &quot;Is not posible support referencing another unmanaged folder as a dependency today&quot;\r\n\r\nVs code calls unmanaged folder any without build tools, so for the moment the only option is to inject dependency as a .jar file","title":"Error in Visual srudio code java extension: Set other project in source path: The source path must be contained in the project root folder","body":"<p>I post the same question as a Github Issue (here)[https://github.com/redhat-developer/vscode-java/issues/2853]</p>\n<p>As they said: &quot;Is not posible support referencing another unmanaged folder as a dependency today&quot;</p>\n<p>Vs code calls unmanaged folder any without build tools, so for the moment the only option is to inject dependency as a .jar file</p>\n"}],"owner":{"account_id":27306844,"reputation":11,"user_id":20822658,"display_name":"Eml0c"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":271,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"accepted_answer_id":75016755,"answer_count":2,"score":-1,"last_activity_date":1672913179,"creation_date":1672657355,"question_id":74981600,"body_markdown":"Suppose I have 4 independent Java projects: project0, project1, project2, and project3. \r\n\r\nInside each project, I have the src folder, and inside some packages and classes. Project 1, 2, and 3 use classes from project0. \r\n\r\nIn Eclipse, I can indicate in a section that the sources of project 0 are used. \r\nWhen I try something similar in VScode, I go to configure the classpath of project one and see that it includes its src folder. When I add the src folder of project0, I get the following error: &quot;The source path must be contained in the project root folder.&quot; \r\n\r\nI can solve this by creating the .jar of project 0 and adding it to the other projects, but this is very inconvenient when making quick tests. \r\n\r\nI know there are tools like Maven or Ant to do these things, but I would like to know if there is any way to indicate in vscode that one project uses classes from another without having to include the .jar as a dependency.\r\n\r\n```\r\nprojeca0\r\n-src\r\n -package0\r\n   -class0\r\n\r\npeoject1\r\n -src\r\n -package1\r\n  -class1\r\n```\r\n\r\nIf class1 uses class0, it will fail. I wish add project0/src as dependency of project1 without creatinfg project0 .jar and add it to project 1.\r\n\r\n","title":"Error in Visual srudio code java extension: Set other project in source path: The source path must be contained in the project root folder","body":"<p>Suppose I have 4 independent Java projects: project0, project1, project2, and project3.</p>\n<p>Inside each project, I have the src folder, and inside some packages and classes. Project 1, 2, and 3 use classes from project0.</p>\n<p>In Eclipse, I can indicate in a section that the sources of project 0 are used.\nWhen I try something similar in VScode, I go to configure the classpath of project one and see that it includes its src folder. When I add the src folder of project0, I get the following error: &quot;The source path must be contained in the project root folder.&quot;</p>\n<p>I can solve this by creating the .jar of project 0 and adding it to the other projects, but this is very inconvenient when making quick tests.</p>\n<p>I know there are tools like Maven or Ant to do these things, but I would like to know if there is any way to indicate in vscode that one project uses classes from another without having to include the .jar as a dependency.</p>\n<pre><code>projeca0\n-src\n -package0\n   -class0\n\npeoject1\n -src\n -package1\n  -class1\n</code></pre>\n<p>If class1 uses class0, it will fail. I wish add project0/src as dependency of project1 without creatinfg project0 .jar and add it to project 1.</p>\n"},{"tags":["java","file-upload"],"comments":[{"owner":{"account_id":1018203,"reputation":3271,"user_id":1029272,"display_name":"Deco"},"score":1,"creation_date":1334656287,"post_id":10188898,"comment_id":13078393,"body_markdown":"Can you please provide us with the code that you are using so that we can have a look? It is hard to diagnose without any error message or code.","body":"Can you please provide us with the code that you are using so that we can have a look? It is hard to diagnose without any error message or code."},{"owner":{"account_id":245943,"reputation":5001,"user_id":519755,"accept_rate":84,"display_name":"Varun"},"score":0,"creation_date":1334657686,"post_id":10188898,"comment_id":13078937,"body_markdown":"in both the cases same stream is been used to perform actions","body":"in both the cases same stream is been used to perform actions"}],"answers":[{"tags":[],"owner":{"account_id":5747,"reputation":3010,"user_id":9422,"display_name":"slipset"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1334659135,"creation_date":1334659135,"answer_id":10189606,"question_id":10188898,"body_markdown":"In  \r\n   \r\n\r\n     byte[] fileArray = IOUtils.toByteArray(loIns);\r\n    \r\n\r\nyou&#39;ve already exhausted your inputstream, so when you want to write it to a file, you should use the content of the `fileArray`, not your `loIns`:\r\n\r\n    FileUtils.writeByteArrayToFile(loOutput, fileArray);\r\n\r\nFileUtils is provided by apache-commons","title":"Java file upload - inputstream issue","body":"<p>In  </p>\n\n<pre><code> byte[] fileArray = IOUtils.toByteArray(loIns);\n</code></pre>\n\n<p>you've already exhausted your inputstream, so when you want to write it to a file, you should use the content of the <code>fileArray</code>, not your <code>loIns</code>:</p>\n\n<pre><code>FileUtils.writeByteArrayToFile(loOutput, fileArray);\n</code></pre>\n\n<p>FileUtils is provided by apache-commons</p>\n"}],"owner":{"account_id":245943,"reputation":5001,"user_id":519755,"accept_rate":84,"display_name":"Varun"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2958,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":10189606,"answer_count":1,"score":0,"last_activity_date":1672913059,"creation_date":1334656112,"question_id":10188898,"body_markdown":"I have to upload some files from jsp page, when i read the inputstream for the same.\r\nI am checking for its authenticity that its a valid file or not, for that I am using [`jmimemagic` ][1] and it takes input stream as argument and now when I am trying to upload it, its only uploading 1 byte of data?\r\n\r\nI feel like there is some issue with inputstream any solution pls?\r\n\r\n     //For checking the file type\r\n    InputStream loIns = aoFileStream.getInputStreamToReadFile();\r\n    \t\t\tbyte[] fileArray = IOUtils.toByteArray(loIns);\r\n    \t\t\tmimeType = Magic.getMagicMatch(fileArray, true).getMimeType();\r\n    \t\t\tif(!loAllowedFileTypesMimeList.contains(mimeType)){\r\n    \t\t\t\treturn false;\r\n    \t\t\t}else{\r\n    \t\t\t\tString lsFileName = aoFileStream.getFileName();\r\n    \t\t\t\tString lsFileExt = lsFileName.substring(lsFileName.lastIndexOf(&quot;.&quot;) + 1);\r\n    \t\t\t\tif(loAllowedFileTypesList.contains(lsFileExt.toLowerCase())){\r\n    \t\t\t\t\treturn true;\r\n    \t\t\t\t}\r\n    \t\t\t\treturn false;\r\n    \t\t\t} \r\n\r\n\r\n\r\n    // For uploading the content\r\n    File loOutputFile = new File(asFilePathToUpload);\r\n    \t\t\tif(!loOutputFile.exists()){\r\n    \t\t\t\tFileOutputStream loOutput = new FileOutputStream(loOutputFile);\r\n    \t\t\t\twhile (liEnd != -1) {\r\n    \t\t\t\t\tliEnd = inputStreamToReadFile.read();\r\n    \t\t\t\t\tloOutput.write(liEnd);\r\n    \t\t\t\t}\r\n    \t\t\t\tinputStreamToReadFile.close();\r\n    \t\t\t\tloOutput.close();\r\n    \t\t\t}\r\n\r\n  [1]: https://sourceforge.net/projects/jmimemagic/\r","title":"Java file upload - inputstream issue","body":"<p>I have to upload some files from jsp page, when i read the inputstream for the same.\nI am checking for its authenticity that its a valid file or not, for that I am using <a href=\"https://sourceforge.net/projects/jmimemagic/\" rel=\"nofollow noreferrer\"><code>jmimemagic</code> </a> and it takes input stream as argument and now when I am trying to upload it, its only uploading 1 byte of data?</p>\n<p>I feel like there is some issue with inputstream any solution pls?</p>\n<pre><code> //For checking the file type\nInputStream loIns = aoFileStream.getInputStreamToReadFile();\n            byte[] fileArray = IOUtils.toByteArray(loIns);\n            mimeType = Magic.getMagicMatch(fileArray, true).getMimeType();\n            if(!loAllowedFileTypesMimeList.contains(mimeType)){\n                return false;\n            }else{\n                String lsFileName = aoFileStream.getFileName();\n                String lsFileExt = lsFileName.substring(lsFileName.lastIndexOf(&quot;.&quot;) + 1);\n                if(loAllowedFileTypesList.contains(lsFileExt.toLowerCase())){\n                    return true;\n                }\n                return false;\n            } \n\n\n\n// For uploading the content\nFile loOutputFile = new File(asFilePathToUpload);\n            if(!loOutputFile.exists()){\n                FileOutputStream loOutput = new FileOutputStream(loOutputFile);\n                while (liEnd != -1) {\n                    liEnd = inputStreamToReadFile.read();\n                    loOutput.write(liEnd);\n                }\n                inputStreamToReadFile.close();\n                loOutput.close();\n            }\n</code></pre>\n"},{"tags":["java","rest","exception","swagger"],"comments":[{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1672912010,"post_id":75016432,"comment_id":132381254,"body_markdown":"Please share the complete stacktrace","body":"Please share the complete stacktrace"},{"owner":{"account_id":18295032,"reputation":53,"user_id":13321125,"display_name":"Amber Akkermans"},"score":0,"creation_date":1672912080,"post_id":75016432,"comment_id":132381272,"body_markdown":"Added to my original question","body":"Added to my original question"}],"answers":[{"tags":[],"owner":{"account_id":401843,"reputation":89873,"user_id":768644,"display_name":"rzwitserloot"},"comment_count":0,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1672913029,"creation_date":1672913029,"answer_id":75016728,"question_id":75016432,"body_markdown":"You&#39;re asking JAXB to put the peg (a number value received from the JSON and identifier by swagger as $int64) in the hole (the `Instant expires;` field in your `AccountClientIdentifierEntity` class).\r\n\r\nTurns out, that&#39;s a square peg and a round hole. JAXB tries its best, and given that it has no idea what an `Instant` might be, is planning to construct one and perhaps find a set method maybe. That&#39;s not how `Instant` works, however; you&#39;re looking specifically for `Instant.ofEpochSecond` or `ofEpochMilli`, and we are now truly getting into the root issue here: What does that $int64 even mean? Is it seconds since 1970? milliseconds? Nanofurlongs? Perhaps it&#39;s days since 1902, using the decimal fraction for hours and seconds?\r\n\r\nAsking JAXB to just take a flying wild stab at it seems unreasonable, and indeed, isn&#39;t a thing JAXB can do, nor will it ever. You must tell it what to do.\r\n\r\nTo do this, you tell JAXB that there is a specific unmarshaller available for that field.\r\n\r\nAn `@XmlJavaTypeAdapter` annotation should be able to do the job; you can annotate the `expires` field with it, passing a class reference to a class that implements [`XmlAdapter`](https://docs.oracle.com/javase/8/docs/api/javax/xml/bind/annotation/adapters/XmlAdapter.html).\r\n\r\nThe [`jaxb-java-time-adapters`](https://github.com/davidkarlsen/jaxb-java-time-adapters) project could be useful here; possibly only to look at the source to know what to do.\r\n","title":"java.lang.NoSuchMethodError: java.time.Instant.&lt;init&gt;()","body":"<p>You're asking JAXB to put the peg (a number value received from the JSON and identifier by swagger as $int64) in the hole (the <code>Instant expires;</code> field in your <code>AccountClientIdentifierEntity</code> class).</p>\n<p>Turns out, that's a square peg and a round hole. JAXB tries its best, and given that it has no idea what an <code>Instant</code> might be, is planning to construct one and perhaps find a set method maybe. That's not how <code>Instant</code> works, however; you're looking specifically for <code>Instant.ofEpochSecond</code> or <code>ofEpochMilli</code>, and we are now truly getting into the root issue here: What does that $int64 even mean? Is it seconds since 1970? milliseconds? Nanofurlongs? Perhaps it's days since 1902, using the decimal fraction for hours and seconds?</p>\n<p>Asking JAXB to just take a flying wild stab at it seems unreasonable, and indeed, isn't a thing JAXB can do, nor will it ever. You must tell it what to do.</p>\n<p>To do this, you tell JAXB that there is a specific unmarshaller available for that field.</p>\n<p>An <code>@XmlJavaTypeAdapter</code> annotation should be able to do the job; you can annotate the <code>expires</code> field with it, passing a class reference to a class that implements <a href=\"https://docs.oracle.com/javase/8/docs/api/javax/xml/bind/annotation/adapters/XmlAdapter.html\" rel=\"noreferrer\"><code>XmlAdapter</code></a>.</p>\n<p>The <a href=\"https://github.com/davidkarlsen/jaxb-java-time-adapters\" rel=\"noreferrer\"><code>jaxb-java-time-adapters</code></a> project could be useful here; possibly only to look at the source to know what to do.</p>\n"}],"owner":{"account_id":18295032,"reputation":53,"user_id":13321125,"display_name":"Amber Akkermans"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1016,"favorite_count":0,"down_vote_count":1,"up_vote_count":4,"answer_count":1,"score":3,"last_activity_date":1672913029,"creation_date":1672911721,"question_id":75016432,"body_markdown":"I get the error `java.lang.NoSuchMethodError: java.time.Instant.&lt;init&gt;()` when in a rest-API documentation (swagger) I try to do a post request with as body the following json:\r\n\r\n    {\r\n      &quot;accountId&quot;: &quot;string&quot;,\r\n      &quot;name&quot;: &quot;string&quot;,\r\n      &quot;value&quot;: &quot;string&quot;,\r\n      &quot;expires&quot;: 0\r\n    }\r\n\r\nthis maps to the model:\r\n\r\n    AccountClientIdentifierEntity{\r\n    accountId\tstring\r\n    name\tstring\r\n    value\tstring\r\n    expires\tinteger($int64)\r\n    }\r\n\r\nNow in my Java code this expires attribute is actually an Instant, but it somehow gets parsed as an Integer here, so I guess my problem lies here, when I post with the &quot;0&quot; instead of an Instant. Can someone help me to fix this, or at least catch the error correctly?\r\n\r\nFull code:\r\nEntity:\r\n\r\n    /**\r\n     * The Class UserEntity.\r\n     */\r\n    @XmlRootElement(name = &quot;accountClientIdentifier&quot;)\r\n    @XmlType(propOrder = { &quot;accountId&quot;, &quot;name&quot;, &quot;value&quot;, &quot;expires&quot;})\r\n    @JsonInclude(JsonInclude.Include.NON_NULL)\r\n    public class AccountClientIdentifierEntity {\r\n    \r\n        public static void registerToContextProvider(){\r\n            try {\r\n                CustomContextProvider.registerClass(com.inteno.iopsys.plugin.restapi.entity.AccountClientIdentifierEntity.class);\r\n            } catch (Exception e){\r\n                Log.error(&quot;Could not register AccountClientIdentifierEntity: &quot;+e.getMessage());\r\n            }\r\n        }\r\n    \r\n        /** The username. */\r\n        private String accountId;\r\n    \r\n        /** The name. */\r\n        private String name;\r\n    \r\n        /** The value. */\r\n        private String value;\r\n    \r\n        /** expires. */\r\n        private Instant expires;\r\n    \r\n    \r\n        /**\r\n         * Instantiates a new user entity.\r\n         */\r\n        public AccountClientIdentifierEntity() {\r\n    \r\n        }\r\n    \r\n        /**\r\n         * Instantiates a new user entity.\r\n         *\r\n         * @param accountId\r\n         *            the account ID\r\n         * @param name\r\n         *            the name\r\n         * @param value\r\n         *            the value\r\n         */\r\n        public AccountClientIdentifierEntity(String accountId, String name, String value) {\r\n            this.accountId = accountId;\r\n            this.name = name;\r\n            this.value = value;\r\n        }\r\n+ getters &amp; setters\r\n\r\nservice path:\r\n\r\n    @POST\r\n        @Path(&quot;/identifiers&quot;)\r\n        @ApiOperation(value = &quot;Add a new account client identifier&quot;)\r\n        @ApiResponses(value = {@ApiResponse(code = 201, message = &quot;Created&quot;)})\r\n        public Response createAccountClientId(\r\n                @ApiParam(value = &quot;The new identifier to create&quot;, required = true) AccountClientIdentifierEntity accountClientIdentifierEntity\r\n        ) throws ServiceException {\r\n            controller.createOrUpdateAccountClientIdentifier(accountClientIdentifierEntity);\r\n            return Response.status(Response.Status.CREATED).build();\r\n        }\r\n\r\nStacktrace:\r\n\r\n    2023.01.05 09:25:21 WARN  [Jetty-QTP-API-1-821]: HttpChannel.java:700 - /restapi/v1/account/identifiers\r\n    java.lang.NoSuchMethodError: java.time.Instant.&lt;init&gt;()\r\n            at com.sun.xml.bind.v2.ClassFactory.tryGetDeclaredConstructor(ClassFactory.java:115) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.xml.bind.v2.ClassFactory.create0(ClassFactory.java:76) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.createInstance(ClassBeanInfoImpl.java:255) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallingContext.createInstance(UnmarshallingContext.java:672) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.xml.bind.v2.runtime.unmarshaller.StructureLoader.startElement(StructureLoader.java:158) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallingContext._startElement(UnmarshallingContext.java:547) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallingContext.startElement(UnmarshallingContext.java:526) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.xml.bind.v2.runtime.unmarshaller.InterningXmlVisitor.startElement(InterningXmlVisitor.java:45) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.xml.bind.v2.runtime.unmarshaller.StAXStreamConnector.handleStartElement(StAXStreamConnector.java:216) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.xml.bind.v2.runtime.unmarshaller.StAXStreamConnector.bridge(StAXStreamConnector.java:150) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:385) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:364) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            at com.sun.jersey.json.impl.BaseJSONUnmarshaller.unmarshalJAXBElementFromJSON(BaseJSONUnmarshaller.java:111) ~[?:?]\r\n            at com.sun.jersey.json.impl.BaseJSONUnmarshaller.unmarshalFromJSON(BaseJSONUnmarshaller.java:100) ~[?:?]\r\n            at com.sun.jersey.json.impl.provider.entity.JSONRootElementProvider.readFrom(JSONRootElementProvider.java:154) ~[?:?]\r\n            at com.sun.jersey.core.provider.jaxb.AbstractRootElementProvider.readFrom(AbstractRootElementProvider.java:111) ~[?:?]\r\n            at com.sun.jersey.spi.container.ContainerRequest.getEntity(ContainerRequest.java:490) ~[?:?]\r\n            at com.sun.jersey.server.impl.model.method.dispatch.EntityParamDispatchProvider$EntityInjectable.getValue(EntityParamDispatchProvider.java:123) ~[?:?]\r\n            at com.sun.jersey.server.impl.inject.InjectableValuesProvider.getInjectableValues(InjectableValuesProvider.java:86) ~[?:?]\r\n            at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$EntityParamInInvoker.getParams(AbstractResourceMethodDispatchProvider.java:153) ~[?:?]\r\n            at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:203) ~[?:?]\r\n            at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75) ~[?:?]\r\n            at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:302) ~[?:?]\r\n            at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147) ~[?:?]\r\n            at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108) ~[?:?]\r\n            at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147) ~[?:?]\r\n            at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84) ~[?:?]\r\n            at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1542) ~[?:?]        at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1473) ~[?:?]        at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1419) ~[?:?]\r\n            at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1409) ~[?:?]\r\n            at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:409) ~[?:?]\r\n            at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:558) ~[?:?]\r\n            at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:733) ~[?:?]\r\n            at javax.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[jetty-servlet-api-4.0.6.jar:?]\r\n            at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:764) ~[jetty-servlet-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:508) ~[jetty-servlet-10.0.5.jar:10.0.5]        at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:221) ~[jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1373) ~[jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:176) ~[jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:463) ~[jetty-servlet-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:174) ~[jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1295) ~[jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:129) ~[jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.handler.HandlerList.handle(HandlerList.java:51) ~[jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122) ~[jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.Server.handle(Server.java:562) ~[jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.HttpChannel.lambda$handle$0(HttpChannel.java:399) ~[jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:656) ~[jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:391) [jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:282) [jetty-server-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:319) [jetty-io-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100) [jetty-io-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:538) [jetty-io-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:387) [jetty-io-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:161) [jetty-io-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100) [jetty-io-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.io.SocketChannelEndPoint$1.run(SocketChannelEndPoint.java:101) [jetty-io-10.0.5.jar:10.0.5]        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333) [jetty-util-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310) [jetty-util-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168) [jetty-util-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126) [jetty-util-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:378) [jetty-util-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:894) [jetty-util-10.0.5.jar:10.0.5]\r\n            at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1038) [jetty-util-10.0.5.jar:10.0.5]\r\n            at java.lang.Thread.run(Thread.java:834) [?:?]\r\n    Caused by: java.lang.NoSuchMethodException: java.time.Instant.&lt;init&gt;()\r\n            at java.lang.Class.getConstructor0(Class.java:3350) ~[?:?]\r\n            at java.lang.Class.getDeclaredConstructor(Class.java:2554) ~[?:?]\r\n            at com.sun.xml.bind.v2.ClassFactory.tryGetDeclaredConstructor(ClassFactory.java:107) ~[jaxb-runtime-2.3.2.jar:2.3.2]\r\n            ... 65 more","title":"java.lang.NoSuchMethodError: java.time.Instant.&lt;init&gt;()","body":"<p>I get the error <code>java.lang.NoSuchMethodError: java.time.Instant.&lt;init&gt;()</code> when in a rest-API documentation (swagger) I try to do a post request with as body the following json:</p>\n<pre><code>{\n  &quot;accountId&quot;: &quot;string&quot;,\n  &quot;name&quot;: &quot;string&quot;,\n  &quot;value&quot;: &quot;string&quot;,\n  &quot;expires&quot;: 0\n}\n</code></pre>\n<p>this maps to the model:</p>\n<pre><code>AccountClientIdentifierEntity{\naccountId   string\nname    string\nvalue   string\nexpires integer($int64)\n}\n</code></pre>\n<p>Now in my Java code this expires attribute is actually an Instant, but it somehow gets parsed as an Integer here, so I guess my problem lies here, when I post with the &quot;0&quot; instead of an Instant. Can someone help me to fix this, or at least catch the error correctly?</p>\n<p>Full code:\nEntity:</p>\n<pre><code>/**\n * The Class UserEntity.\n */\n@XmlRootElement(name = &quot;accountClientIdentifier&quot;)\n@XmlType(propOrder = { &quot;accountId&quot;, &quot;name&quot;, &quot;value&quot;, &quot;expires&quot;})\n@JsonInclude(JsonInclude.Include.NON_NULL)\npublic class AccountClientIdentifierEntity {\n\n    public static void registerToContextProvider(){\n        try {\n            CustomContextProvider.registerClass(com.inteno.iopsys.plugin.restapi.entity.AccountClientIdentifierEntity.class);\n        } catch (Exception e){\n            Log.error(&quot;Could not register AccountClientIdentifierEntity: &quot;+e.getMessage());\n        }\n    }\n\n    /** The username. */\n    private String accountId;\n\n    /** The name. */\n    private String name;\n\n    /** The value. */\n    private String value;\n\n    /** expires. */\n    private Instant expires;\n\n\n    /**\n     * Instantiates a new user entity.\n     */\n    public AccountClientIdentifierEntity() {\n\n    }\n\n    /**\n     * Instantiates a new user entity.\n     *\n     * @param accountId\n     *            the account ID\n     * @param name\n     *            the name\n     * @param value\n     *            the value\n     */\n    public AccountClientIdentifierEntity(String accountId, String name, String value) {\n        this.accountId = accountId;\n        this.name = name;\n        this.value = value;\n    }\n</code></pre>\n<ul>\n<li>getters &amp; setters</li>\n</ul>\n<p>service path:</p>\n<pre><code>@POST\n    @Path(&quot;/identifiers&quot;)\n    @ApiOperation(value = &quot;Add a new account client identifier&quot;)\n    @ApiResponses(value = {@ApiResponse(code = 201, message = &quot;Created&quot;)})\n    public Response createAccountClientId(\n            @ApiParam(value = &quot;The new identifier to create&quot;, required = true) AccountClientIdentifierEntity accountClientIdentifierEntity\n    ) throws ServiceException {\n        controller.createOrUpdateAccountClientIdentifier(accountClientIdentifierEntity);\n        return Response.status(Response.Status.CREATED).build();\n    }\n</code></pre>\n<p>Stacktrace:</p>\n<pre><code>2023.01.05 09:25:21 WARN  [Jetty-QTP-API-1-821]: HttpChannel.java:700 - /restapi/v1/account/identifiers\njava.lang.NoSuchMethodError: java.time.Instant.&lt;init&gt;()\n        at com.sun.xml.bind.v2.ClassFactory.tryGetDeclaredConstructor(ClassFactory.java:115) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.xml.bind.v2.ClassFactory.create0(ClassFactory.java:76) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.createInstance(ClassBeanInfoImpl.java:255) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallingContext.createInstance(UnmarshallingContext.java:672) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.xml.bind.v2.runtime.unmarshaller.StructureLoader.startElement(StructureLoader.java:158) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallingContext._startElement(UnmarshallingContext.java:547) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallingContext.startElement(UnmarshallingContext.java:526) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.xml.bind.v2.runtime.unmarshaller.InterningXmlVisitor.startElement(InterningXmlVisitor.java:45) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.xml.bind.v2.runtime.unmarshaller.StAXStreamConnector.handleStartElement(StAXStreamConnector.java:216) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.xml.bind.v2.runtime.unmarshaller.StAXStreamConnector.bridge(StAXStreamConnector.java:150) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:385) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:364) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        at com.sun.jersey.json.impl.BaseJSONUnmarshaller.unmarshalJAXBElementFromJSON(BaseJSONUnmarshaller.java:111) ~[?:?]\n        at com.sun.jersey.json.impl.BaseJSONUnmarshaller.unmarshalFromJSON(BaseJSONUnmarshaller.java:100) ~[?:?]\n        at com.sun.jersey.json.impl.provider.entity.JSONRootElementProvider.readFrom(JSONRootElementProvider.java:154) ~[?:?]\n        at com.sun.jersey.core.provider.jaxb.AbstractRootElementProvider.readFrom(AbstractRootElementProvider.java:111) ~[?:?]\n        at com.sun.jersey.spi.container.ContainerRequest.getEntity(ContainerRequest.java:490) ~[?:?]\n        at com.sun.jersey.server.impl.model.method.dispatch.EntityParamDispatchProvider$EntityInjectable.getValue(EntityParamDispatchProvider.java:123) ~[?:?]\n        at com.sun.jersey.server.impl.inject.InjectableValuesProvider.getInjectableValues(InjectableValuesProvider.java:86) ~[?:?]\n        at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$EntityParamInInvoker.getParams(AbstractResourceMethodDispatchProvider.java:153) ~[?:?]\n        at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:203) ~[?:?]\n        at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75) ~[?:?]\n        at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:302) ~[?:?]\n        at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147) ~[?:?]\n        at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108) ~[?:?]\n        at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147) ~[?:?]\n        at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84) ~[?:?]\n        at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1542) ~[?:?]        at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1473) ~[?:?]        at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1419) ~[?:?]\n        at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1409) ~[?:?]\n        at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:409) ~[?:?]\n        at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:558) ~[?:?]\n        at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:733) ~[?:?]\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[jetty-servlet-api-4.0.6.jar:?]\n        at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:764) ~[jetty-servlet-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:508) ~[jetty-servlet-10.0.5.jar:10.0.5]        at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:221) ~[jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1373) ~[jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:176) ~[jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:463) ~[jetty-servlet-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:174) ~[jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1295) ~[jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:129) ~[jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.handler.HandlerList.handle(HandlerList.java:51) ~[jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122) ~[jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.Server.handle(Server.java:562) ~[jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.HttpChannel.lambda$handle$0(HttpChannel.java:399) ~[jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:656) ~[jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:391) [jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:282) [jetty-server-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:319) [jetty-io-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100) [jetty-io-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:538) [jetty-io-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:387) [jetty-io-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:161) [jetty-io-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100) [jetty-io-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.io.SocketChannelEndPoint$1.run(SocketChannelEndPoint.java:101) [jetty-io-10.0.5.jar:10.0.5]        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333) [jetty-util-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310) [jetty-util-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168) [jetty-util-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126) [jetty-util-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:378) [jetty-util-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:894) [jetty-util-10.0.5.jar:10.0.5]\n        at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1038) [jetty-util-10.0.5.jar:10.0.5]\n        at java.lang.Thread.run(Thread.java:834) [?:?]\nCaused by: java.lang.NoSuchMethodException: java.time.Instant.&lt;init&gt;()\n        at java.lang.Class.getConstructor0(Class.java:3350) ~[?:?]\n        at java.lang.Class.getDeclaredConstructor(Class.java:2554) ~[?:?]\n        at com.sun.xml.bind.v2.ClassFactory.tryGetDeclaredConstructor(ClassFactory.java:107) ~[jaxb-runtime-2.3.2.jar:2.3.2]\n        ... 65 more\n</code></pre>\n"},{"tags":["java","hibernate","elasticsearch","hibernate-search"],"answers":[{"comments":[{"owner":{"account_id":1482404,"reputation":952,"user_id":1391454,"accept_rate":43,"display_name":"Mubasher"},"score":0,"creation_date":1573799742,"post_id":58859536,"comment_id":104011228,"body_markdown":"Hi yrodiere, First Thanks for your response. Your understanding is absolutely correct that I am doing massive changes in database. I have updated my question and added the scenario and code. My Elastic Search is on EC2 instance of AWS in a VPN so network is not the issue. I have observed there are many simultaneous thread are working with large AddLuceneWork Queues . I will check my ES configurations and try to test with your provided properties. I will update you if this was not resolved.","body":"Hi yrodiere, First Thanks for your response. Your understanding is absolutely correct that I am doing massive changes in database. I have updated my question and added the scenario and code. My Elastic Search is on EC2 instance of AWS in a VPN so network is not the issue. I have observed there are many simultaneous thread are working with large AddLuceneWork Queues . I will check my ES configurations and try to test with your provided properties. I will update you if this was not resolved."},{"owner":{"account_id":1482404,"reputation":952,"user_id":1391454,"accept_rate":43,"display_name":"Mubasher"},"score":0,"creation_date":1573804867,"post_id":58859536,"comment_id":104013191,"body_markdown":"Hi yrodiere, when Hibernate search 6.0.0 is gonna released for production use.","body":"Hi yrodiere, when Hibernate search 6.0.0 is gonna released for production use."},{"owner":{"account_id":8974783,"reputation":9445,"user_id":6692043,"display_name":"yrodiere"},"score":0,"creation_date":1573820980,"post_id":58859536,"comment_id":104021521,"body_markdown":"@Mubasher &quot;When it&#39;s ready&quot;. There is no set date yet. That being said, the code is clean and well-tested; when it comes to Elasticsearch, it already works better than Search 5. Search 6 is only considered Beta because we will introduce backward-incompatible changes that will require you to update your code or reindex your data. If you&#39;re fine with that, you can already use it in production.","body":"@Mubasher &quot;When it&#39;s ready&quot;. There is no set date yet. That being said, the code is clean and well-tested; when it comes to Elasticsearch, it already works better than Search 5. Search 6 is only considered Beta because we will introduce backward-incompatible changes that will require you to update your code or reindex your data. If you&#39;re fine with that, you can already use it in production."},{"owner":{"account_id":8974783,"reputation":9445,"user_id":6692043,"display_name":"yrodiere"},"score":0,"creation_date":1574182965,"post_id":58859536,"comment_id":104137142,"body_markdown":"@Mubasher Judging from your code, one big problem is that you&#39;re executing everything in a single session and a single transaction. You should consider splitting the import into multiple transactions if possible, or at least flushing/clearing the session periodically. Do not forget to use [flushToIndexes](https://docs.jboss.org/hibernate/search/5.11/reference/en-US/html_single/#search-batchindex-flushtoindexes) before each `session.clear()` to send indexing requests to Elasticsearch.","body":"@Mubasher Judging from your code, one big problem is that you&#39;re executing everything in a single session and a single transaction. You should consider splitting the import into multiple transactions if possible, or at least flushing/clearing the session periodically. Do not forget to use <a href=\"https://docs.jboss.org/hibernate/search/5.11/reference/en-US/html_single/#search-batchindex-flushtoindexes\" rel=\"nofollow noreferrer\">flushToIndexes</a> before each <code>session.clear()</code> to send indexing requests to Elasticsearch."},{"owner":{"account_id":1482404,"reputation":952,"user_id":1391454,"accept_rate":43,"display_name":"Mubasher"},"score":0,"creation_date":1574308917,"post_id":58859536,"comment_id":104188879,"body_markdown":"I am also using Spring Data JPA with Hibernate ORM and Hibernate Search.","body":"I am also using Spring Data JPA with Hibernate ORM and Hibernate Search."},{"owner":{"account_id":8974783,"reputation":9445,"user_id":6692043,"display_name":"yrodiere"},"score":0,"creation_date":1574334510,"post_id":58859536,"comment_id":104200445,"body_markdown":"If you want the whole import of 15,000+ complex entities to be transactional, then I&#39;m not sure how to improve performance. Did setting the max total connection per route improve anything?","body":"If you want the whole import of 15,000+ complex entities to be transactional, then I&#39;m not sure how to improve performance. Did setting the max total connection per route improve anything?"}],"tags":[],"owner":{"account_id":8974783,"reputation":9445,"user_id":6692043,"display_name":"yrodiere"},"comment_count":6,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672912693,"creation_date":1573742893,"answer_id":58859536,"question_id":58857935,"body_markdown":"I would need the code that performs the entity changes in order to be sure, but from what I understand:\r\n\r\n* you are performing massive changes in your database\r\n* Hibernate Search queues the corresponding index changes (thousands of them)\r\n* Hibernate Search processes the queue asynchronously, but in large batches, sending very large indexing requests to Elasticsearch.\r\n* Elasticsearch can&#39;t keep up and requests end up timing out\r\n\r\nThere are three solutions:\r\n\r\n1. sending fewer requests to Elasticsearch at a time (smaller batches), so that Elasticsearch gets the same amount of time to index fewer documents.\r\n2. allowing more time for Elasticsearch to handle each request.\r\n3. increasing the indexing speed of Elasticsearch.\r\n\r\nNumber 1 would only be useful if your problem is caused by rare, short &quot;bursts&quot; of changes, which doesn&#39;t seem to be your case.\r\nIt is not possible in Hibernate Serach 5 anyway, but for the sake of completeness, here&#39;s how to do it in Hibernate Search 6 by configuring [indexing queues](https://docs.jboss.org/hibernate/stable/search/reference/en-US/html_single/#backend-elasticsearch-indexing-queues), with Spring Boot:\r\n\r\n```\r\nspring:\r\n  jpa:\r\n    properties:\r\n      hibernate:\r\n        search:\r\n          backend:\r\n            indexing.max_bulk_size: 50 # default is 100\r\n```\r\n\r\nNumber 2 is probably not a good idea, since the default timeout is already quite large: 30 seconds (used to be 60 seconds in Hibernate Search 5). If you&#39;re getting timeouts, either Elasticsearch is very, very slow, or there are network problems that led to connection timeouts. In both cases it&#39;s concerning and you should have a look at your setup (see below).\r\nIf you really want to increase this timeout, use the property [`hibernate.search.backend.read_timeout`](https://docs.jboss.org/hibernate/stable/search/reference/en-US/html_single/#backend-elasticsearch-configuration-connection-tuning), in milliseconds (in Hibernate Search 5, it&#39;s `hibernate.search.default.elasticsearch.read_timeout`).\r\n\r\nNumber 3 is the way to go, I think. You really should have a look at the configuration of your Elasticsearch cluster. Try to test and monitor your cluster to see if there are bottlenecks.\r\n\r\nOne easy-to-solve bottleneck is the number of simultaneous connections from Hibernate Search to Elasticsearch. By default in Hibernate Search 5.10 it&#39;s maximum 2 per Elasticsearch node and 20 per cluster. If you&#39;re only using one Elasticsearch node, that could be *very* limiting. Try raising it; here&#39;s how to do it in Hibernate Search 5:\r\n\r\n\r\n```\r\nspring:\r\n  jpa:\r\n    properties:\r\n      hibernate:\r\n        search:\r\n          default:\r\n            elasticsearch:\r\n              max_total_connection_per_route: 10\r\n```\r\n\r\nWith Hibernate Search 6 the default is already 10, but you can raise it regardless, if you think that makes sense:\r\n\r\n\r\n```\r\nspring:\r\n  jpa:\r\n    properties:\r\n      hibernate:\r\n        search:\r\n          backend:\r\n            max_connections_per_route: 20\r\n```\r\n\r\n","title":"Hibernate Search: concurrent timeout exception","body":"<p>I would need the code that performs the entity changes in order to be sure, but from what I understand:</p>\n<ul>\n<li>you are performing massive changes in your database</li>\n<li>Hibernate Search queues the corresponding index changes (thousands of them)</li>\n<li>Hibernate Search processes the queue asynchronously, but in large batches, sending very large indexing requests to Elasticsearch.</li>\n<li>Elasticsearch can't keep up and requests end up timing out</li>\n</ul>\n<p>There are three solutions:</p>\n<ol>\n<li>sending fewer requests to Elasticsearch at a time (smaller batches), so that Elasticsearch gets the same amount of time to index fewer documents.</li>\n<li>allowing more time for Elasticsearch to handle each request.</li>\n<li>increasing the indexing speed of Elasticsearch.</li>\n</ol>\n<p>Number 1 would only be useful if your problem is caused by rare, short &quot;bursts&quot; of changes, which doesn't seem to be your case.\nIt is not possible in Hibernate Serach 5 anyway, but for the sake of completeness, here's how to do it in Hibernate Search 6 by configuring <a href=\"https://docs.jboss.org/hibernate/stable/search/reference/en-US/html_single/#backend-elasticsearch-indexing-queues\" rel=\"nofollow noreferrer\">indexing queues</a>, with Spring Boot:</p>\n<pre><code>spring:\n  jpa:\n    properties:\n      hibernate:\n        search:\n          backend:\n            indexing.max_bulk_size: 50 # default is 100\n</code></pre>\n<p>Number 2 is probably not a good idea, since the default timeout is already quite large: 30 seconds (used to be 60 seconds in Hibernate Search 5). If you're getting timeouts, either Elasticsearch is very, very slow, or there are network problems that led to connection timeouts. In both cases it's concerning and you should have a look at your setup (see below).\nIf you really want to increase this timeout, use the property <a href=\"https://docs.jboss.org/hibernate/stable/search/reference/en-US/html_single/#backend-elasticsearch-configuration-connection-tuning\" rel=\"nofollow noreferrer\"><code>hibernate.search.backend.read_timeout</code></a>, in milliseconds (in Hibernate Search 5, it's <code>hibernate.search.default.elasticsearch.read_timeout</code>).</p>\n<p>Number 3 is the way to go, I think. You really should have a look at the configuration of your Elasticsearch cluster. Try to test and monitor your cluster to see if there are bottlenecks.</p>\n<p>One easy-to-solve bottleneck is the number of simultaneous connections from Hibernate Search to Elasticsearch. By default in Hibernate Search 5.10 it's maximum 2 per Elasticsearch node and 20 per cluster. If you're only using one Elasticsearch node, that could be <em>very</em> limiting. Try raising it; here's how to do it in Hibernate Search 5:</p>\n<pre><code>spring:\n  jpa:\n    properties:\n      hibernate:\n        search:\n          default:\n            elasticsearch:\n              max_total_connection_per_route: 10\n</code></pre>\n<p>With Hibernate Search 6 the default is already 10, but you can raise it regardless, if you think that makes sense:</p>\n<pre><code>spring:\n  jpa:\n    properties:\n      hibernate:\n        search:\n          backend:\n            max_connections_per_route: 20\n</code></pre>\n"}],"owner":{"account_id":1482404,"reputation":952,"user_id":1391454,"accept_rate":43,"display_name":"Mubasher"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1255,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":58859536,"answer_count":1,"score":0,"last_activity_date":1672912693,"creation_date":1573738149,"question_id":58857935,"body_markdown":"**Scenario:**\r\nI am processing an excel file containing 150+columns and 15000 rows. This file converted to List&lt;EntityClazz&gt; and then called repository.saveAll(List&lt;EntityClazz&gt;) . This service method was called concurently by 15 user request.\r\n\r\n**Code**\r\n\r\n    @Transactional(rollbackFor = Exception.class)\r\n    \tpublic BooleanResponse fileProcessing(\r\n    \t\t\tRequest req) {\r\n    \r\n    \r\n    \t\tfor (MultipartFile file : req.getMasterSheets()) {\r\n    \t\t\tList&lt;EntityClazz&gt; list = excelParser.processExcelFile(file, EntityClazz.class);\r\n    \t\t\tEntityClazzRepository.saveAll(list);\r\n    \t\t\tlist.clear();\r\n    \t\t}\r\n    \r\n    \t\treturn BooleanResponse.success();\r\n    \r\n    \t}\r\n\r\nI am facing following exception with Hibernate Search and Elastic Search.\r\n\r\n    2019-11-14 12:38:32.567 ERROR 1 --- [eout executor-1] o.h.s.exception.impl.LogErrorHandler     : HSEARCH000058: Exception occurred org.hibernate.search.exception.SearchException: HSEARCH400007: Elasticsearch request failed.\r\n    Request: POST /_bulk with parameters {refresh=false}\r\n    Response: null\r\n    Subsequent failures:\r\n            Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 436294  Work Type  org.hibernate.search.backend.AddLuceneWork\r\n            Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 436310  Work Type  org.hibernate.search.backend.AddLuceneWork\r\n            Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 436326  Work Type  org.hibernate.search.backend.AddLuceneWork\r\n            Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 436342  Work Type  org.hibernate.search.backend.AddLuceneWork\r\n    .\r\n    .\r\n    .\r\n    .\r\n    \r\n            Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 472620  Work Type  org.hibernate.search.backend.AddLuceneWork\r\n            Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 472625  Work Type  org.hibernate.search.backend.AddLuceneWork\r\n\r\n  \r\n\r\n   \r\n    org.hibernate.search.exception.SearchException: HSEARCH400007: Elasticsearch request failed.\r\n    Request: POST /_bulk with parameters {refresh=false}\r\n    Response: null\r\n            at org.hibernate.search.elasticsearch.work.impl.BulkWork.lambda$execute$1(BulkWork.java:77) ~[hibernate-search-elasticsearch-5.10.5.Final.jar!/:5.10.5.Final]\r\n            at org.hibernate.search.util.impl.Futures.lambda$handler$1(Futures.java:57) ~[hibernate-search-engine-5.10.5.Final.jar!/:5.10.5.Final]\r\n            at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:870) ~[na:1.8.0_212]\r\n            at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:852) ~[na:1.8.0_212]\r\n            at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:474) ~[na:1.8.0_212]\r\n            at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1977) ~[na:1.8.0_212]\r\n            at org.hibernate.search.elasticsearch.client.impl.DefaultElasticsearchClient.lambda$send$3(DefaultElasticsearchClient.java:137) ~[hibernate-search-elasticsearch-5.10.5.Final.jar!/:5.10.5.Final]\r\n            at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_212]\r\n            at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_212]\r\n            at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_212]\r\n            at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_212]\r\n            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[na:1.8.0_212]\r\n            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[na:1.8.0_212]\r\n            at java.lang.Thread.run(Thread.java:748) ~[na:1.8.0_212]\r\n    Caused by: java.util.concurrent.TimeoutException: null\r\n            ... 8 common frames omitted\r\n\r\nThis log is one such example of many exceptions printed out... Feels like there are many threads working and some how failed. Don&#39;t know why.. Data set which needs to be indexed was almost 50000 at one time. and Hibernate search starts indexing automatically and asynchronously after transaction commit as I have set async true. \r\n\r\nI am using Hibernate Search version 5.10 and elastic search version 5.6.10.\r\nMy database table is very large. and There is bulk update/insert operation is performed by Hibernate on this table. \r\n\r\nMy Elastic Search Server is on default configuration. that only one node. yellow health.\r\n\r\nHere is Elastic Search Cluster Node stats:\r\n\r\n    {\r\n       &quot;_nodes&quot;:{\r\n          &quot;total&quot;:1,\r\n          &quot;successful&quot;:1,\r\n          &quot;failed&quot;:0\r\n       },\r\n       &quot;cluster_name&quot;:&quot;elasticsearch&quot;,\r\n       &quot;nodes&quot;:{\r\n          &quot;I7fWwFhORhimHRDL6jJTuw&quot;:{\r\n             &quot;timestamp&quot;:1573740483870,\r\n             &quot;name&quot;:&quot;I7fWwFh&quot;,\r\n             &quot;transport_address&quot;:&quot;&quot;,\r\n             &quot;host&quot;:&quot;&quot;,\r\n             &quot;ip&quot;:&quot;&quot;,\r\n             &quot;roles&quot;:[\r\n                &quot;master&quot;,\r\n                &quot;data&quot;,\r\n                &quot;ingest&quot;\r\n             ],\r\n             &quot;indices&quot;:{\r\n                &quot;docs&quot;:{\r\n                   &quot;count&quot;:7090,\r\n                   &quot;deleted&quot;:956\r\n                },\r\n                &quot;store&quot;:{\r\n                   &quot;size_in_bytes&quot;:69228643,\r\n                   &quot;throttle_time_in_millis&quot;:0\r\n                },\r\n                &quot;indexing&quot;:{\r\n                   &quot;index_total&quot;:5091795,\r\n                   &quot;index_time_in_millis&quot;:60401979,\r\n                   &quot;index_current&quot;:11,\r\n                   &quot;index_failed&quot;:7,\r\n                   &quot;delete_total&quot;:124964,\r\n                   &quot;delete_time_in_millis&quot;:2232,\r\n                   &quot;delete_current&quot;:0,\r\n                   &quot;noop_update_total&quot;:0,\r\n                   &quot;is_throttled&quot;:true,\r\n                   &quot;throttle_time_in_millis&quot;:1348474\r\n                },\r\n                &quot;get&quot;:{\r\n                   &quot;total&quot;:4913,\r\n                   &quot;time_in_millis&quot;:316,\r\n                   &quot;exists_total&quot;:4913,\r\n                   &quot;exists_time_in_millis&quot;:316,\r\n                   &quot;missing_total&quot;:0,\r\n                   &quot;missing_time_in_millis&quot;:0,\r\n                   &quot;current&quot;:0\r\n                },\r\n                &quot;search&quot;:{\r\n                   &quot;open_contexts&quot;:0,\r\n                   &quot;query_total&quot;:232976,\r\n                   &quot;query_time_in_millis&quot;:79853,\r\n                   &quot;query_current&quot;:0,\r\n                   &quot;fetch_total&quot;:183622,\r\n                   &quot;fetch_time_in_millis&quot;:608420,\r\n                   &quot;fetch_current&quot;:0,\r\n                   &quot;scroll_total&quot;:3555,\r\n                   &quot;scroll_time_in_millis&quot;:192717,\r\n                   &quot;scroll_current&quot;:0,\r\n                   &quot;suggest_total&quot;:0,\r\n                   &quot;suggest_time_in_millis&quot;:0,\r\n                   &quot;suggest_current&quot;:0\r\n                },\r\n                &quot;merges&quot;:{\r\n                   &quot;current&quot;:0,\r\n                   &quot;current_docs&quot;:0,\r\n                   &quot;current_size_in_bytes&quot;:0,\r\n                   &quot;total&quot;:9867,\r\n                   &quot;total_time_in_millis&quot;:23061388,\r\n                   &quot;total_docs&quot;:7412149,\r\n                   &quot;total_size_in_bytes&quot;:191974966202,\r\n                   &quot;total_stopped_time_in_millis&quot;:0,\r\n                   &quot;total_throttled_time_in_millis&quot;:626635,\r\n                   &quot;total_auto_throttle_in_bytes&quot;:80244256738\r\n                },\r\n                &quot;refresh&quot;:{\r\n                   &quot;total&quot;:200577,\r\n                   &quot;total_time_in_millis&quot;:32611981,\r\n                   &quot;listeners&quot;:0\r\n                },\r\n                &quot;flush&quot;:{\r\n                   &quot;total&quot;:7747,\r\n                   &quot;total_time_in_millis&quot;:67635\r\n                },\r\n                &quot;warmer&quot;:{\r\n                   &quot;current&quot;:0,\r\n                   &quot;total&quot;:677,\r\n                   &quot;total_time_in_millis&quot;:21\r\n                },\r\n                &quot;query_cache&quot;:{\r\n                   &quot;memory_size_in_bytes&quot;:0,\r\n                   &quot;total_count&quot;:0,\r\n                   &quot;hit_count&quot;:0,\r\n                   &quot;miss_count&quot;:0,\r\n                   &quot;cache_size&quot;:0,\r\n                   &quot;cache_count&quot;:0,\r\n                   &quot;evictions&quot;:0\r\n                },\r\n                &quot;fielddata&quot;:{\r\n                   &quot;memory_size_in_bytes&quot;:0,\r\n                   &quot;evictions&quot;:0\r\n                },\r\n                &quot;completion&quot;:{\r\n                   &quot;size_in_bytes&quot;:0\r\n                },\r\n                &quot;segments&quot;:{\r\n                   &quot;count&quot;:48,\r\n                   &quot;memory_in_bytes&quot;:4551470,\r\n                   &quot;terms_memory_in_bytes&quot;:3595446,\r\n                   &quot;stored_fields_memory_in_bytes&quot;:20168,\r\n                   &quot;term_vectors_memory_in_bytes&quot;:0,\r\n                   &quot;norms_memory_in_bytes&quot;:913856,\r\n                   &quot;points_memory_in_bytes&quot;:280,\r\n                   &quot;doc_values_memory_in_bytes&quot;:21720,\r\n                   &quot;index_writer_memory_in_bytes&quot;:0,\r\n                   &quot;version_map_memory_in_bytes&quot;:0,\r\n                   &quot;fixed_bit_set_memory_in_bytes&quot;:0,\r\n                   &quot;max_unsafe_auto_id_timestamp&quot;:-1,\r\n                   &quot;file_sizes&quot;:{\r\n    \r\n                   }\r\n                },\r\n                &quot;translog&quot;:{\r\n                   &quot;operations&quot;:0,\r\n                   &quot;size_in_bytes&quot;:1290\r\n                },\r\n                &quot;request_cache&quot;:{\r\n                   &quot;memory_size_in_bytes&quot;:21920,\r\n                   &quot;evictions&quot;:0,\r\n                   &quot;hit_count&quot;:0,\r\n                   &quot;miss_count&quot;:30\r\n                },\r\n                &quot;recovery&quot;:{\r\n                   &quot;current_as_source&quot;:0,\r\n                   &quot;current_as_target&quot;:0,\r\n                   &quot;throttle_time_in_millis&quot;:0\r\n                }\r\n             },\r\n             &quot;os&quot;:{\r\n                &quot;timestamp&quot;:1573740483888,\r\n                &quot;cpu&quot;:{\r\n                   &quot;percent&quot;:0,\r\n                   &quot;load_average&quot;:{\r\n                      &quot;1m&quot;:0,\r\n                      &quot;5m&quot;:0,\r\n                      &quot;15m&quot;:0\r\n                   }\r\n                },\r\n                &quot;mem&quot;:{\r\n                   &quot;total_in_bytes&quot;:4134809600,\r\n                   &quot;free_in_bytes&quot;:115888128,\r\n                   &quot;used_in_bytes&quot;:4018921472,\r\n                   &quot;free_percent&quot;:3,\r\n                   &quot;used_percent&quot;:97\r\n                },\r\n                &quot;swap&quot;:{\r\n                   &quot;total_in_bytes&quot;:0,\r\n                   &quot;free_in_bytes&quot;:0,\r\n                   &quot;used_in_bytes&quot;:0\r\n                },\r\n                &quot;cgroup&quot;:{\r\n                   &quot;cpuacct&quot;:{\r\n                      &quot;control_group&quot;:&quot;/&quot;,\r\n                      &quot;usage_nanos&quot;:85077837036370\r\n                   },\r\n                   &quot;cpu&quot;:{\r\n                      &quot;control_group&quot;:&quot;/&quot;,\r\n                      &quot;cfs_period_micros&quot;:100000,\r\n                      &quot;cfs_quota_micros&quot;:-1,\r\n                      &quot;stat&quot;:{\r\n                         &quot;number_of_elapsed_periods&quot;:0,\r\n                         &quot;number_of_times_throttled&quot;:0,\r\n                         &quot;time_throttled_nanos&quot;:0\r\n                      }\r\n                   }\r\n                }\r\n             },\r\n             &quot;process&quot;:{\r\n                &quot;timestamp&quot;:1573740483888,\r\n                &quot;open_file_descriptors&quot;:213,\r\n                &quot;max_file_descriptors&quot;:65536,\r\n                &quot;cpu&quot;:{\r\n                   &quot;percent&quot;:0,\r\n                   &quot;total_in_millis&quot;:82774150\r\n                },\r\n                &quot;mem&quot;:{\r\n                   &quot;total_virtual_in_bytes&quot;:5024968704\r\n                }\r\n             },\r\n             &quot;jvm&quot;:{\r\n                &quot;timestamp&quot;:1573740483888,\r\n                &quot;uptime_in_millis&quot;:2672036639,\r\n                &quot;mem&quot;:{\r\n                   &quot;heap_used_in_bytes&quot;:1155032416,\r\n                   &quot;heap_used_percent&quot;:54,\r\n                   &quot;heap_committed_in_bytes&quot;:2130051072,\r\n                   &quot;heap_max_in_bytes&quot;:2130051072,\r\n                   &quot;non_heap_used_in_bytes&quot;:146981608,\r\n                   &quot;non_heap_committed_in_bytes&quot;:154607616,\r\n                   &quot;pools&quot;:{\r\n                      &quot;young&quot;:{\r\n                         &quot;used_in_bytes&quot;:135568192,\r\n                         &quot;max_in_bytes&quot;:139591680,\r\n                         &quot;peak_used_in_bytes&quot;:139591680,\r\n                         &quot;peak_max_in_bytes&quot;:139591680\r\n                      },\r\n                      &quot;survivor&quot;:{\r\n                         &quot;used_in_bytes&quot;:4866896,\r\n                         &quot;max_in_bytes&quot;:17432576,\r\n                         &quot;peak_used_in_bytes&quot;:17432576,\r\n                         &quot;peak_max_in_bytes&quot;:17432576\r\n                      },\r\n                      &quot;old&quot;:{\r\n                         &quot;used_in_bytes&quot;:1014597328,\r\n                         &quot;max_in_bytes&quot;:1973026816,\r\n                         &quot;peak_used_in_bytes&quot;:1638372912,\r\n                         &quot;peak_max_in_bytes&quot;:1973026816\r\n                      }\r\n                   }\r\n                },\r\n                &quot;threads&quot;:{\r\n                   &quot;count&quot;:43,\r\n                   &quot;peak_count&quot;:50\r\n                },\r\n                &quot;gc&quot;:{\r\n                   &quot;collectors&quot;:{\r\n                      &quot;young&quot;:{\r\n                         &quot;collection_count&quot;:170449,\r\n                         &quot;collection_time_in_millis&quot;:1934820\r\n                      },\r\n                      &quot;old&quot;:{\r\n                         &quot;collection_count&quot;:847,\r\n                         &quot;collection_time_in_millis&quot;:38599\r\n                      }\r\n                   }\r\n                },\r\n                &quot;buffer_pools&quot;:{\r\n                   &quot;direct&quot;:{\r\n                      &quot;count&quot;:32,\r\n                      &quot;used_in_bytes&quot;:67767443,\r\n                      &quot;total_capacity_in_bytes&quot;:67767442\r\n                   },\r\n                   &quot;mapped&quot;:{\r\n                      &quot;count&quot;:108,\r\n                      &quot;used_in_bytes&quot;:68478134,\r\n                      &quot;total_capacity_in_bytes&quot;:68478134\r\n                   }\r\n                },\r\n                &quot;classes&quot;:{\r\n                   &quot;current_loaded_count&quot;:12473,\r\n                   &quot;total_loaded_count&quot;:12527,\r\n                   &quot;total_unloaded_count&quot;:54\r\n                }\r\n             },\r\n             &quot;thread_pool&quot;:{\r\n                &quot;bulk&quot;:{\r\n                   &quot;threads&quot;:2,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:2,\r\n                   &quot;completed&quot;:383422\r\n                },\r\n                &quot;fetch_shard_started&quot;:{\r\n                   &quot;threads&quot;:1,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:4,\r\n                   &quot;completed&quot;:97\r\n                },\r\n                &quot;fetch_shard_store&quot;:{\r\n                   &quot;threads&quot;:0,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:0,\r\n                   &quot;completed&quot;:0\r\n                },\r\n                &quot;flush&quot;:{\r\n                   &quot;threads&quot;:1,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:1,\r\n                   &quot;completed&quot;:12854\r\n                },\r\n                &quot;force_merge&quot;:{\r\n                   &quot;threads&quot;:1,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:1,\r\n                   &quot;completed&quot;:1240\r\n                },\r\n                &quot;generic&quot;:{\r\n                   &quot;threads&quot;:4,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:8,\r\n                   &quot;completed&quot;:273461\r\n                },\r\n                &quot;get&quot;:{\r\n                   &quot;threads&quot;:2,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:2,\r\n                   &quot;completed&quot;:4897\r\n                },\r\n                &quot;index&quot;:{\r\n                   &quot;threads&quot;:2,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:2,\r\n                   &quot;completed&quot;:16\r\n                },\r\n                &quot;listener&quot;:{\r\n                   &quot;threads&quot;:1,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:1,\r\n                   &quot;completed&quot;:21\r\n                },\r\n                &quot;management&quot;:{\r\n                   &quot;threads&quot;:3,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:1,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:3,\r\n                   &quot;completed&quot;:366004\r\n                },\r\n                &quot;refresh&quot;:{\r\n                   &quot;threads&quot;:1,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:1,\r\n                   &quot;completed&quot;:21459450\r\n                },\r\n                &quot;search&quot;:{\r\n                   &quot;threads&quot;:4,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:4,\r\n                   &quot;completed&quot;:463814\r\n                },\r\n                &quot;snapshot&quot;:{\r\n                   &quot;threads&quot;:0,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:0,\r\n                   &quot;completed&quot;:0\r\n                },\r\n                &quot;warmer&quot;:{\r\n                   &quot;threads&quot;:0,\r\n                   &quot;queue&quot;:0,\r\n                   &quot;active&quot;:0,\r\n                   &quot;rejected&quot;:0,\r\n                   &quot;largest&quot;:0,\r\n                   &quot;completed&quot;:0\r\n                }\r\n             },\r\n             &quot;fs&quot;:{\r\n                &quot;timestamp&quot;:1573740483888,\r\n                &quot;total&quot;:{\r\n                   &quot;total_in_bytes&quot;:8577331200,\r\n                   &quot;free_in_bytes&quot;:20480,\r\n                   &quot;available_in_bytes&quot;:20480\r\n                },\r\n                &quot;data&quot;:[\r\n                   {\r\n                      &quot;path&quot;:&quot;/var/lib/elasticsearch/nodes/0&quot;,\r\n                      &quot;mount&quot;:&quot;/ (/dev/xvda1)&quot;,\r\n                      &quot;type&quot;:&quot;xfs&quot;,\r\n                      &quot;total_in_bytes&quot;:8577331200,\r\n                      &quot;free_in_bytes&quot;:20480,\r\n                      &quot;available_in_bytes&quot;:20480,\r\n                      &quot;spins&quot;:&quot;false&quot;\r\n                   }\r\n                ],\r\n                &quot;io_stats&quot;:{\r\n                   &quot;devices&quot;:[\r\n                      {\r\n                         &quot;device_name&quot;:&quot;xvda1&quot;,\r\n                         &quot;operations&quot;:5857367,\r\n                         &quot;read_operations&quot;:171280,\r\n                         &quot;write_operations&quot;:5686087,\r\n                         &quot;read_kilobytes&quot;:13911088,\r\n                         &quot;write_kilobytes&quot;:304080912\r\n                      }\r\n                   ],\r\n                   &quot;total&quot;:{\r\n                      &quot;operations&quot;:5857367,\r\n                      &quot;read_operations&quot;:171280,\r\n                      &quot;write_operations&quot;:5686087,\r\n                      &quot;read_kilobytes&quot;:13911088,\r\n                      &quot;write_kilobytes&quot;:304080912\r\n                   }\r\n                }\r\n             },\r\n             &quot;transport&quot;:{\r\n                &quot;server_open&quot;:0,\r\n                &quot;rx_count&quot;:20,\r\n                &quot;rx_size_in_bytes&quot;:7538,\r\n                &quot;tx_count&quot;:20,\r\n                &quot;tx_size_in_bytes&quot;:7538\r\n             },\r\n             &quot;http&quot;:{\r\n                &quot;current_open&quot;:20,\r\n                &quot;total_opened&quot;:2915\r\n             },\r\n             &quot;breakers&quot;:{\r\n                &quot;request&quot;:{\r\n                   &quot;limit_size_in_bytes&quot;:1278030643,\r\n                   &quot;limit_size&quot;:&quot;1.1gb&quot;,\r\n                   &quot;estimated_size_in_bytes&quot;:0,\r\n                   &quot;estimated_size&quot;:&quot;0b&quot;,\r\n                   &quot;overhead&quot;:1,\r\n                   &quot;tripped&quot;:0\r\n                },\r\n                &quot;fielddata&quot;:{\r\n                   &quot;limit_size_in_bytes&quot;:1278030643,\r\n                   &quot;limit_size&quot;:&quot;1.1gb&quot;,\r\n                   &quot;estimated_size_in_bytes&quot;:0,\r\n                   &quot;estimated_size&quot;:&quot;0b&quot;,\r\n                   &quot;overhead&quot;:1.03,\r\n                   &quot;tripped&quot;:0\r\n                },\r\n                &quot;in_flight_requests&quot;:{\r\n                   &quot;limit_size_in_bytes&quot;:2130051072,\r\n                   &quot;limit_size&quot;:&quot;1.9gb&quot;,\r\n                   &quot;estimated_size_in_bytes&quot;:4396991,\r\n                   &quot;estimated_size&quot;:&quot;4.1mb&quot;,\r\n                   &quot;overhead&quot;:1,\r\n                   &quot;tripped&quot;:0\r\n                },\r\n                &quot;parent&quot;:{\r\n                   &quot;limit_size_in_bytes&quot;:1491035750,\r\n                   &quot;limit_size&quot;:&quot;1.3gb&quot;,\r\n                   &quot;estimated_size_in_bytes&quot;:4396991,\r\n                   &quot;estimated_size&quot;:&quot;4.1mb&quot;,\r\n                   &quot;overhead&quot;:1,\r\n                   &quot;tripped&quot;:0\r\n                }\r\n             },\r\n             &quot;script&quot;:{\r\n                &quot;compilations&quot;:1,\r\n                &quot;cache_evictions&quot;:0\r\n             },\r\n             &quot;discovery&quot;:{\r\n                &quot;cluster_state_queue&quot;:{\r\n                   &quot;total&quot;:0,\r\n                   &quot;pending&quot;:0,\r\n                   &quot;committed&quot;:0\r\n                }\r\n             },\r\n             &quot;ingest&quot;:{\r\n                &quot;total&quot;:{\r\n                   &quot;count&quot;:0,\r\n                   &quot;time_in_millis&quot;:0,\r\n                   &quot;current&quot;:0,\r\n                   &quot;failed&quot;:0\r\n                },\r\n                &quot;pipelines&quot;:{\r\n    \r\n                }\r\n             }\r\n          }\r\n       }\r\n    }\r\n\r\nHere is my Hibernate Search configurations with Spring boot 2.0 application.\r\n\r\n    spring:\r\n    \r\n      datasource:\r\n        \r\n        hikari:\r\n          maximum-pool-size: 30\r\n          minimum-idle: 10\r\n      jpa:\r\n        show-sql: false\r\n        properties:\r\n          hibernate:\r\n            ejb:\r\n              interceptor: com.xyz.xyz.xyz.util.EntityInterceptor\r\n            jdbc:\r\n              batch_size: 100\r\n              order_inserts: true\r\n              order_update: true\r\n            search:\r\n              autoregister_listeners: true\r\n              fulltext_query: ERROR\r\n              default_null_token: N/A\r\n              error_handler: com.xyz.xyz.xyz.search.exceptions.HibernateSearchErrorHandler\r\n              default:\r\n                indexmanager: elasticsearch\r\n                worker:\r\n                  execution: async\r\n                elasticsearch:\r\n                  required_index_status: yellow\r\n                  index_schema_management_strategy: none\r\n                  host: ${ES_HOST:http://127.0.0.1:9200}\r\n                  request: ERROR\r\n                  log:\r\n                    json_pretty_printing: false\r\n\r\n\r\nI am not understanding what is missing. Please guide me in right direction. Ask me if any other information require to understand my problem. Many thanks in advance.","title":"Hibernate Search: concurrent timeout exception","body":"<p><strong>Scenario:</strong>\nI am processing an excel file containing 150+columns and 15000 rows. This file converted to List and then called repository.saveAll(List) . This service method was called concurently by 15 user request.</p>\n<p><strong>Code</strong></p>\n<pre><code>@Transactional(rollbackFor = Exception.class)\n    public BooleanResponse fileProcessing(\n            Request req) {\n\n\n        for (MultipartFile file : req.getMasterSheets()) {\n            List&lt;EntityClazz&gt; list = excelParser.processExcelFile(file, EntityClazz.class);\n            EntityClazzRepository.saveAll(list);\n            list.clear();\n        }\n\n        return BooleanResponse.success();\n\n    }\n</code></pre>\n<p>I am facing following exception with Hibernate Search and Elastic Search.</p>\n<pre><code>2019-11-14 12:38:32.567 ERROR 1 --- [eout executor-1] o.h.s.exception.impl.LogErrorHandler     : HSEARCH000058: Exception occurred org.hibernate.search.exception.SearchException: HSEARCH400007: Elasticsearch request failed.\nRequest: POST /_bulk with parameters {refresh=false}\nResponse: null\nSubsequent failures:\n        Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 436294  Work Type  org.hibernate.search.backend.AddLuceneWork\n        Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 436310  Work Type  org.hibernate.search.backend.AddLuceneWork\n        Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 436326  Work Type  org.hibernate.search.backend.AddLuceneWork\n        Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 436342  Work Type  org.hibernate.search.backend.AddLuceneWork\n.\n.\n.\n.\n\n        Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 472620  Work Type  org.hibernate.search.backend.AddLuceneWork\n        Entity com.xyz.xyz.domain.entity.epc.EntityClazz  Id 472625  Work Type  org.hibernate.search.backend.AddLuceneWork\n\n\n\n\norg.hibernate.search.exception.SearchException: HSEARCH400007: Elasticsearch request failed.\nRequest: POST /_bulk with parameters {refresh=false}\nResponse: null\n        at org.hibernate.search.elasticsearch.work.impl.BulkWork.lambda$execute$1(BulkWork.java:77) ~[hibernate-search-elasticsearch-5.10.5.Final.jar!/:5.10.5.Final]\n        at org.hibernate.search.util.impl.Futures.lambda$handler$1(Futures.java:57) ~[hibernate-search-engine-5.10.5.Final.jar!/:5.10.5.Final]\n        at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:870) ~[na:1.8.0_212]\n        at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:852) ~[na:1.8.0_212]\n        at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:474) ~[na:1.8.0_212]\n        at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1977) ~[na:1.8.0_212]\n        at org.hibernate.search.elasticsearch.client.impl.DefaultElasticsearchClient.lambda$send$3(DefaultElasticsearchClient.java:137) ~[hibernate-search-elasticsearch-5.10.5.Final.jar!/:5.10.5.Final]\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_212]\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_212]\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_212]\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_212]\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[na:1.8.0_212]\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[na:1.8.0_212]\n        at java.lang.Thread.run(Thread.java:748) ~[na:1.8.0_212]\nCaused by: java.util.concurrent.TimeoutException: null\n        ... 8 common frames omitted\n</code></pre>\n<p>This log is one such example of many exceptions printed out... Feels like there are many threads working and some how failed. Don't know why.. Data set which needs to be indexed was almost 50000 at one time. and Hibernate search starts indexing automatically and asynchronously after transaction commit as I have set async true.</p>\n<p>I am using Hibernate Search version 5.10 and elastic search version 5.6.10.\nMy database table is very large. and There is bulk update/insert operation is performed by Hibernate on this table.</p>\n<p>My Elastic Search Server is on default configuration. that only one node. yellow health.</p>\n<p>Here is Elastic Search Cluster Node stats:</p>\n<pre><code>{\n   &quot;_nodes&quot;:{\n      &quot;total&quot;:1,\n      &quot;successful&quot;:1,\n      &quot;failed&quot;:0\n   },\n   &quot;cluster_name&quot;:&quot;elasticsearch&quot;,\n   &quot;nodes&quot;:{\n      &quot;I7fWwFhORhimHRDL6jJTuw&quot;:{\n         &quot;timestamp&quot;:1573740483870,\n         &quot;name&quot;:&quot;I7fWwFh&quot;,\n         &quot;transport_address&quot;:&quot;&quot;,\n         &quot;host&quot;:&quot;&quot;,\n         &quot;ip&quot;:&quot;&quot;,\n         &quot;roles&quot;:[\n            &quot;master&quot;,\n            &quot;data&quot;,\n            &quot;ingest&quot;\n         ],\n         &quot;indices&quot;:{\n            &quot;docs&quot;:{\n               &quot;count&quot;:7090,\n               &quot;deleted&quot;:956\n            },\n            &quot;store&quot;:{\n               &quot;size_in_bytes&quot;:69228643,\n               &quot;throttle_time_in_millis&quot;:0\n            },\n            &quot;indexing&quot;:{\n               &quot;index_total&quot;:5091795,\n               &quot;index_time_in_millis&quot;:60401979,\n               &quot;index_current&quot;:11,\n               &quot;index_failed&quot;:7,\n               &quot;delete_total&quot;:124964,\n               &quot;delete_time_in_millis&quot;:2232,\n               &quot;delete_current&quot;:0,\n               &quot;noop_update_total&quot;:0,\n               &quot;is_throttled&quot;:true,\n               &quot;throttle_time_in_millis&quot;:1348474\n            },\n            &quot;get&quot;:{\n               &quot;total&quot;:4913,\n               &quot;time_in_millis&quot;:316,\n               &quot;exists_total&quot;:4913,\n               &quot;exists_time_in_millis&quot;:316,\n               &quot;missing_total&quot;:0,\n               &quot;missing_time_in_millis&quot;:0,\n               &quot;current&quot;:0\n            },\n            &quot;search&quot;:{\n               &quot;open_contexts&quot;:0,\n               &quot;query_total&quot;:232976,\n               &quot;query_time_in_millis&quot;:79853,\n               &quot;query_current&quot;:0,\n               &quot;fetch_total&quot;:183622,\n               &quot;fetch_time_in_millis&quot;:608420,\n               &quot;fetch_current&quot;:0,\n               &quot;scroll_total&quot;:3555,\n               &quot;scroll_time_in_millis&quot;:192717,\n               &quot;scroll_current&quot;:0,\n               &quot;suggest_total&quot;:0,\n               &quot;suggest_time_in_millis&quot;:0,\n               &quot;suggest_current&quot;:0\n            },\n            &quot;merges&quot;:{\n               &quot;current&quot;:0,\n               &quot;current_docs&quot;:0,\n               &quot;current_size_in_bytes&quot;:0,\n               &quot;total&quot;:9867,\n               &quot;total_time_in_millis&quot;:23061388,\n               &quot;total_docs&quot;:7412149,\n               &quot;total_size_in_bytes&quot;:191974966202,\n               &quot;total_stopped_time_in_millis&quot;:0,\n               &quot;total_throttled_time_in_millis&quot;:626635,\n               &quot;total_auto_throttle_in_bytes&quot;:80244256738\n            },\n            &quot;refresh&quot;:{\n               &quot;total&quot;:200577,\n               &quot;total_time_in_millis&quot;:32611981,\n               &quot;listeners&quot;:0\n            },\n            &quot;flush&quot;:{\n               &quot;total&quot;:7747,\n               &quot;total_time_in_millis&quot;:67635\n            },\n            &quot;warmer&quot;:{\n               &quot;current&quot;:0,\n               &quot;total&quot;:677,\n               &quot;total_time_in_millis&quot;:21\n            },\n            &quot;query_cache&quot;:{\n               &quot;memory_size_in_bytes&quot;:0,\n               &quot;total_count&quot;:0,\n               &quot;hit_count&quot;:0,\n               &quot;miss_count&quot;:0,\n               &quot;cache_size&quot;:0,\n               &quot;cache_count&quot;:0,\n               &quot;evictions&quot;:0\n            },\n            &quot;fielddata&quot;:{\n               &quot;memory_size_in_bytes&quot;:0,\n               &quot;evictions&quot;:0\n            },\n            &quot;completion&quot;:{\n               &quot;size_in_bytes&quot;:0\n            },\n            &quot;segments&quot;:{\n               &quot;count&quot;:48,\n               &quot;memory_in_bytes&quot;:4551470,\n               &quot;terms_memory_in_bytes&quot;:3595446,\n               &quot;stored_fields_memory_in_bytes&quot;:20168,\n               &quot;term_vectors_memory_in_bytes&quot;:0,\n               &quot;norms_memory_in_bytes&quot;:913856,\n               &quot;points_memory_in_bytes&quot;:280,\n               &quot;doc_values_memory_in_bytes&quot;:21720,\n               &quot;index_writer_memory_in_bytes&quot;:0,\n               &quot;version_map_memory_in_bytes&quot;:0,\n               &quot;fixed_bit_set_memory_in_bytes&quot;:0,\n               &quot;max_unsafe_auto_id_timestamp&quot;:-1,\n               &quot;file_sizes&quot;:{\n\n               }\n            },\n            &quot;translog&quot;:{\n               &quot;operations&quot;:0,\n               &quot;size_in_bytes&quot;:1290\n            },\n            &quot;request_cache&quot;:{\n               &quot;memory_size_in_bytes&quot;:21920,\n               &quot;evictions&quot;:0,\n               &quot;hit_count&quot;:0,\n               &quot;miss_count&quot;:30\n            },\n            &quot;recovery&quot;:{\n               &quot;current_as_source&quot;:0,\n               &quot;current_as_target&quot;:0,\n               &quot;throttle_time_in_millis&quot;:0\n            }\n         },\n         &quot;os&quot;:{\n            &quot;timestamp&quot;:1573740483888,\n            &quot;cpu&quot;:{\n               &quot;percent&quot;:0,\n               &quot;load_average&quot;:{\n                  &quot;1m&quot;:0,\n                  &quot;5m&quot;:0,\n                  &quot;15m&quot;:0\n               }\n            },\n            &quot;mem&quot;:{\n               &quot;total_in_bytes&quot;:4134809600,\n               &quot;free_in_bytes&quot;:115888128,\n               &quot;used_in_bytes&quot;:4018921472,\n               &quot;free_percent&quot;:3,\n               &quot;used_percent&quot;:97\n            },\n            &quot;swap&quot;:{\n               &quot;total_in_bytes&quot;:0,\n               &quot;free_in_bytes&quot;:0,\n               &quot;used_in_bytes&quot;:0\n            },\n            &quot;cgroup&quot;:{\n               &quot;cpuacct&quot;:{\n                  &quot;control_group&quot;:&quot;/&quot;,\n                  &quot;usage_nanos&quot;:85077837036370\n               },\n               &quot;cpu&quot;:{\n                  &quot;control_group&quot;:&quot;/&quot;,\n                  &quot;cfs_period_micros&quot;:100000,\n                  &quot;cfs_quota_micros&quot;:-1,\n                  &quot;stat&quot;:{\n                     &quot;number_of_elapsed_periods&quot;:0,\n                     &quot;number_of_times_throttled&quot;:0,\n                     &quot;time_throttled_nanos&quot;:0\n                  }\n               }\n            }\n         },\n         &quot;process&quot;:{\n            &quot;timestamp&quot;:1573740483888,\n            &quot;open_file_descriptors&quot;:213,\n            &quot;max_file_descriptors&quot;:65536,\n            &quot;cpu&quot;:{\n               &quot;percent&quot;:0,\n               &quot;total_in_millis&quot;:82774150\n            },\n            &quot;mem&quot;:{\n               &quot;total_virtual_in_bytes&quot;:5024968704\n            }\n         },\n         &quot;jvm&quot;:{\n            &quot;timestamp&quot;:1573740483888,\n            &quot;uptime_in_millis&quot;:2672036639,\n            &quot;mem&quot;:{\n               &quot;heap_used_in_bytes&quot;:1155032416,\n               &quot;heap_used_percent&quot;:54,\n               &quot;heap_committed_in_bytes&quot;:2130051072,\n               &quot;heap_max_in_bytes&quot;:2130051072,\n               &quot;non_heap_used_in_bytes&quot;:146981608,\n               &quot;non_heap_committed_in_bytes&quot;:154607616,\n               &quot;pools&quot;:{\n                  &quot;young&quot;:{\n                     &quot;used_in_bytes&quot;:135568192,\n                     &quot;max_in_bytes&quot;:139591680,\n                     &quot;peak_used_in_bytes&quot;:139591680,\n                     &quot;peak_max_in_bytes&quot;:139591680\n                  },\n                  &quot;survivor&quot;:{\n                     &quot;used_in_bytes&quot;:4866896,\n                     &quot;max_in_bytes&quot;:17432576,\n                     &quot;peak_used_in_bytes&quot;:17432576,\n                     &quot;peak_max_in_bytes&quot;:17432576\n                  },\n                  &quot;old&quot;:{\n                     &quot;used_in_bytes&quot;:1014597328,\n                     &quot;max_in_bytes&quot;:1973026816,\n                     &quot;peak_used_in_bytes&quot;:1638372912,\n                     &quot;peak_max_in_bytes&quot;:1973026816\n                  }\n               }\n            },\n            &quot;threads&quot;:{\n               &quot;count&quot;:43,\n               &quot;peak_count&quot;:50\n            },\n            &quot;gc&quot;:{\n               &quot;collectors&quot;:{\n                  &quot;young&quot;:{\n                     &quot;collection_count&quot;:170449,\n                     &quot;collection_time_in_millis&quot;:1934820\n                  },\n                  &quot;old&quot;:{\n                     &quot;collection_count&quot;:847,\n                     &quot;collection_time_in_millis&quot;:38599\n                  }\n               }\n            },\n            &quot;buffer_pools&quot;:{\n               &quot;direct&quot;:{\n                  &quot;count&quot;:32,\n                  &quot;used_in_bytes&quot;:67767443,\n                  &quot;total_capacity_in_bytes&quot;:67767442\n               },\n               &quot;mapped&quot;:{\n                  &quot;count&quot;:108,\n                  &quot;used_in_bytes&quot;:68478134,\n                  &quot;total_capacity_in_bytes&quot;:68478134\n               }\n            },\n            &quot;classes&quot;:{\n               &quot;current_loaded_count&quot;:12473,\n               &quot;total_loaded_count&quot;:12527,\n               &quot;total_unloaded_count&quot;:54\n            }\n         },\n         &quot;thread_pool&quot;:{\n            &quot;bulk&quot;:{\n               &quot;threads&quot;:2,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:2,\n               &quot;completed&quot;:383422\n            },\n            &quot;fetch_shard_started&quot;:{\n               &quot;threads&quot;:1,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:4,\n               &quot;completed&quot;:97\n            },\n            &quot;fetch_shard_store&quot;:{\n               &quot;threads&quot;:0,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:0,\n               &quot;completed&quot;:0\n            },\n            &quot;flush&quot;:{\n               &quot;threads&quot;:1,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:1,\n               &quot;completed&quot;:12854\n            },\n            &quot;force_merge&quot;:{\n               &quot;threads&quot;:1,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:1,\n               &quot;completed&quot;:1240\n            },\n            &quot;generic&quot;:{\n               &quot;threads&quot;:4,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:8,\n               &quot;completed&quot;:273461\n            },\n            &quot;get&quot;:{\n               &quot;threads&quot;:2,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:2,\n               &quot;completed&quot;:4897\n            },\n            &quot;index&quot;:{\n               &quot;threads&quot;:2,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:2,\n               &quot;completed&quot;:16\n            },\n            &quot;listener&quot;:{\n               &quot;threads&quot;:1,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:1,\n               &quot;completed&quot;:21\n            },\n            &quot;management&quot;:{\n               &quot;threads&quot;:3,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:1,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:3,\n               &quot;completed&quot;:366004\n            },\n            &quot;refresh&quot;:{\n               &quot;threads&quot;:1,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:1,\n               &quot;completed&quot;:21459450\n            },\n            &quot;search&quot;:{\n               &quot;threads&quot;:4,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:4,\n               &quot;completed&quot;:463814\n            },\n            &quot;snapshot&quot;:{\n               &quot;threads&quot;:0,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:0,\n               &quot;completed&quot;:0\n            },\n            &quot;warmer&quot;:{\n               &quot;threads&quot;:0,\n               &quot;queue&quot;:0,\n               &quot;active&quot;:0,\n               &quot;rejected&quot;:0,\n               &quot;largest&quot;:0,\n               &quot;completed&quot;:0\n            }\n         },\n         &quot;fs&quot;:{\n            &quot;timestamp&quot;:1573740483888,\n            &quot;total&quot;:{\n               &quot;total_in_bytes&quot;:8577331200,\n               &quot;free_in_bytes&quot;:20480,\n               &quot;available_in_bytes&quot;:20480\n            },\n            &quot;data&quot;:[\n               {\n                  &quot;path&quot;:&quot;/var/lib/elasticsearch/nodes/0&quot;,\n                  &quot;mount&quot;:&quot;/ (/dev/xvda1)&quot;,\n                  &quot;type&quot;:&quot;xfs&quot;,\n                  &quot;total_in_bytes&quot;:8577331200,\n                  &quot;free_in_bytes&quot;:20480,\n                  &quot;available_in_bytes&quot;:20480,\n                  &quot;spins&quot;:&quot;false&quot;\n               }\n            ],\n            &quot;io_stats&quot;:{\n               &quot;devices&quot;:[\n                  {\n                     &quot;device_name&quot;:&quot;xvda1&quot;,\n                     &quot;operations&quot;:5857367,\n                     &quot;read_operations&quot;:171280,\n                     &quot;write_operations&quot;:5686087,\n                     &quot;read_kilobytes&quot;:13911088,\n                     &quot;write_kilobytes&quot;:304080912\n                  }\n               ],\n               &quot;total&quot;:{\n                  &quot;operations&quot;:5857367,\n                  &quot;read_operations&quot;:171280,\n                  &quot;write_operations&quot;:5686087,\n                  &quot;read_kilobytes&quot;:13911088,\n                  &quot;write_kilobytes&quot;:304080912\n               }\n            }\n         },\n         &quot;transport&quot;:{\n            &quot;server_open&quot;:0,\n            &quot;rx_count&quot;:20,\n            &quot;rx_size_in_bytes&quot;:7538,\n            &quot;tx_count&quot;:20,\n            &quot;tx_size_in_bytes&quot;:7538\n         },\n         &quot;http&quot;:{\n            &quot;current_open&quot;:20,\n            &quot;total_opened&quot;:2915\n         },\n         &quot;breakers&quot;:{\n            &quot;request&quot;:{\n               &quot;limit_size_in_bytes&quot;:1278030643,\n               &quot;limit_size&quot;:&quot;1.1gb&quot;,\n               &quot;estimated_size_in_bytes&quot;:0,\n               &quot;estimated_size&quot;:&quot;0b&quot;,\n               &quot;overhead&quot;:1,\n               &quot;tripped&quot;:0\n            },\n            &quot;fielddata&quot;:{\n               &quot;limit_size_in_bytes&quot;:1278030643,\n               &quot;limit_size&quot;:&quot;1.1gb&quot;,\n               &quot;estimated_size_in_bytes&quot;:0,\n               &quot;estimated_size&quot;:&quot;0b&quot;,\n               &quot;overhead&quot;:1.03,\n               &quot;tripped&quot;:0\n            },\n            &quot;in_flight_requests&quot;:{\n               &quot;limit_size_in_bytes&quot;:2130051072,\n               &quot;limit_size&quot;:&quot;1.9gb&quot;,\n               &quot;estimated_size_in_bytes&quot;:4396991,\n               &quot;estimated_size&quot;:&quot;4.1mb&quot;,\n               &quot;overhead&quot;:1,\n               &quot;tripped&quot;:0\n            },\n            &quot;parent&quot;:{\n               &quot;limit_size_in_bytes&quot;:1491035750,\n               &quot;limit_size&quot;:&quot;1.3gb&quot;,\n               &quot;estimated_size_in_bytes&quot;:4396991,\n               &quot;estimated_size&quot;:&quot;4.1mb&quot;,\n               &quot;overhead&quot;:1,\n               &quot;tripped&quot;:0\n            }\n         },\n         &quot;script&quot;:{\n            &quot;compilations&quot;:1,\n            &quot;cache_evictions&quot;:0\n         },\n         &quot;discovery&quot;:{\n            &quot;cluster_state_queue&quot;:{\n               &quot;total&quot;:0,\n               &quot;pending&quot;:0,\n               &quot;committed&quot;:0\n            }\n         },\n         &quot;ingest&quot;:{\n            &quot;total&quot;:{\n               &quot;count&quot;:0,\n               &quot;time_in_millis&quot;:0,\n               &quot;current&quot;:0,\n               &quot;failed&quot;:0\n            },\n            &quot;pipelines&quot;:{\n\n            }\n         }\n      }\n   }\n}\n</code></pre>\n<p>Here is my Hibernate Search configurations with Spring boot 2.0 application.</p>\n<pre><code>spring:\n\n  datasource:\n    \n    hikari:\n      maximum-pool-size: 30\n      minimum-idle: 10\n  jpa:\n    show-sql: false\n    properties:\n      hibernate:\n        ejb:\n          interceptor: com.xyz.xyz.xyz.util.EntityInterceptor\n        jdbc:\n          batch_size: 100\n          order_inserts: true\n          order_update: true\n        search:\n          autoregister_listeners: true\n          fulltext_query: ERROR\n          default_null_token: N/A\n          error_handler: com.xyz.xyz.xyz.search.exceptions.HibernateSearchErrorHandler\n          default:\n            indexmanager: elasticsearch\n            worker:\n              execution: async\n            elasticsearch:\n              required_index_status: yellow\n              index_schema_management_strategy: none\n              host: ${ES_HOST:http://127.0.0.1:9200}\n              request: ERROR\n              log:\n                json_pretty_printing: false\n</code></pre>\n<p>I am not understanding what is missing. Please guide me in right direction. Ask me if any other information require to understand my problem. Many thanks in advance.</p>\n"},{"tags":["java","spring","spring-cloud-sleuth"],"comments":[{"owner":{"account_id":1976110,"reputation":10792,"user_id":1773866,"display_name":"Marcin Grzejszczak"},"score":0,"creation_date":1607431894,"post_id":65198990,"comment_id":115265182,"body_markdown":"Please read this document https://stackoverflow.com/help/how-to-ask on how to ask a good question. You have provided absolutely no meaningful information to help you.","body":"Please read this document <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> on how to ask a good question. You have provided absolutely no meaningful information to help you."},{"owner":{"account_id":18940353,"reputation":177,"user_id":13820546,"display_name":"Harshit Gupta"},"score":0,"creation_date":1607436012,"post_id":65198990,"comment_id":115267221,"body_markdown":"Hi @MarcinGrzejszczak I think people who are aware of spring-cloud-sleuth and java would be able to understand what is the issue. Thanks for checking my question, \n\nIn my request headers, I am providing the given value in `X-B3-TraceId` and this is the error I am getting from TraceFilter.","body":"Hi @MarcinGrzejszczak I think people who are aware of spring-cloud-sleuth and java would be able to understand what is the issue. Thanks for checking my question,   In my request headers, I am providing the given value in <code>X-B3-TraceId</code> and this is the error I am getting from TraceFilter."},{"owner":{"account_id":1976110,"reputation":10792,"user_id":1773866,"display_name":"Marcin Grzejszczak"},"score":0,"creation_date":1607436736,"post_id":65198990,"comment_id":115267585,"body_markdown":"I am the maintainer of Spring Cloud Sleuth and I don&#39;t understand your problem. Not to mention that you haven&#39;t provided what you&#39;re doing, how you&#39;re doing it, which version of Sleuth you have nor which version of Boot. There&#39;s no concrete information passed.","body":"I am the maintainer of Spring Cloud Sleuth and I don&#39;t understand your problem. Not to mention that you haven&#39;t provided what you&#39;re doing, how you&#39;re doing it, which version of Sleuth you have nor which version of Boot. There&#39;s no concrete information passed."},{"owner":{"account_id":18940353,"reputation":177,"user_id":13820546,"display_name":"Harshit Gupta"},"score":0,"creation_date":1607439010,"post_id":65198990,"comment_id":115268686,"body_markdown":"I am using spring boot 1.5.13.RELEASE with spring-cloud-sleuth-core/1.3.4.RELEASE","body":"I am using spring boot 1.5.13.RELEASE with spring-cloud-sleuth-core/1.3.4.RELEASE"},{"owner":{"account_id":18940353,"reputation":177,"user_id":13820546,"display_name":"Harshit Gupta"},"score":0,"creation_date":1607439143,"post_id":65198990,"comment_id":115268773,"body_markdown":"I have a service A which calls my service B which is on spring boot. Service A passes a request header with key `X-B3-TraceId` and value `1f99a12d-066e-4aac-a71a-e7d42d7fa7a3` but I am getting the above Exception.","body":"I have a service A which calls my service B which is on spring boot. Service A passes a request header with key <code>X-B3-TraceId</code> and value <code>1f99a12d-066e-4aac-a71a-e7d42d7fa7a3</code> but I am getting the above Exception."},{"owner":{"account_id":1976110,"reputation":10792,"user_id":1773866,"display_name":"Marcin Grzejszczak"},"score":0,"creation_date":1607442568,"post_id":65198990,"comment_id":115270667,"body_markdown":"This version is not supported. Please upgrade to the latest version and fix the description because in its current form this question should be closed","body":"This version is not supported. Please upgrade to the latest version and fix the description because in its current form this question should be closed"},{"owner":{"account_id":18940353,"reputation":177,"user_id":13820546,"display_name":"Harshit Gupta"},"score":0,"creation_date":1607442864,"post_id":65198990,"comment_id":115270829,"body_markdown":"@MarcinGrzejszczak is this issue resolved in the latest version?","body":"@MarcinGrzejszczak is this issue resolved in the latest version?"}],"owner":{"account_id":18940353,"reputation":177,"user_id":13820546,"display_name":"Harshit Gupta"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":363,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1672912588,"creation_date":1607430753,"question_id":65198990,"body_markdown":"I have a service A which calls my service B which is on spring boot. Service A passes a request header with key X-B3-TraceId and value 1f99a12d-066e-4aac-a71a-e7d42d7fa7a3 but the sleuth gives the following exception:\r\n\r\n```\r\n2020-12-08 20:18:21,821 [XNIO-2 task-5] ERROR [org.springframework.cloud.sleuth.instrument.web.ZipkinHttpSpanExtractor] [ZipkinHttpSpanExtractor.java:50] [trace=,span=]  - Exception occurred while trying to extract span from carrier\r\njava.lang.IllegalArgumentException: Malformed id: 1f99a12d-066e-4aac-a71a-e7d42d7fa7a3\r\n\tat org.springframework.cloud.sleuth.Span.hexToId(Span.java:585)\r\n\tat org.springframework.cloud.sleuth.instrument.web.ZipkinHttpSpanExtractor.buildParentSpan(ZipkinHttpSpanExtractor.java:90)\r\n\tat org.springframework.cloud.sleuth.instrument.web.ZipkinHttpSpanExtractor.joinTrace(ZipkinHttpSpanExtractor.java:48)\r\n\tat org.springframework.cloud.sleuth.instrument.web.ZipkinHttpSpanExtractor.joinTrace(ZipkinHttpSpanExtractor.java:19)\r\n\tat org.springframework.cloud.sleuth.instrument.web.TraceFilter.createSpan(TraceFilter.java:375)\r\n\tat org.springframework.cloud.sleuth.instrument.web.TraceFilter.doFilter(TraceFilter.java:165)\r\n```\r\nFrom Span class I think traceId can only include 0-9 and a-f\r\n```\r\n    public static long hexToId(String lowerHex, int index) {\r\n        Assert.hasText(lowerHex, &quot;Can&#39;t convert empty hex string to long&quot;);\r\n        long result = 0L;\r\n\r\n        for(int endIndex = Math.min(index + 16, lowerHex.length()); index &lt; endIndex; ++index) {\r\n            char c = lowerHex.charAt(index);\r\n            result &lt;&lt;= 4;\r\n            if (c &gt;= &#39;0&#39; &amp;&amp; c &lt;= &#39;9&#39;) {\r\n                result |= (long)(c - 48);\r\n            } else {\r\n                if (c &lt; &#39;a&#39; || c &gt; &#39;f&#39;) {\r\n                    throw new IllegalArgumentException(&quot;Malformed id: &quot; + lowerHex);\r\n                }\r\n\r\n                result |= (long)(c - 97 + 10);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n```\r\nAny way to make the trace id generic?\r\n\r\nI am using spring boot 1.5.13.RELEASE with spring-cloud-sleuth-core/1.3.4.RELEASE ","title":"Sleuth TraceId Malformed ID Exception","body":"<p>I have a service A which calls my service B which is on spring boot. Service A passes a request header with key X-B3-TraceId and value 1f99a12d-066e-4aac-a71a-e7d42d7fa7a3 but the sleuth gives the following exception:</p>\n<pre><code>2020-12-08 20:18:21,821 [XNIO-2 task-5] ERROR [org.springframework.cloud.sleuth.instrument.web.ZipkinHttpSpanExtractor] [ZipkinHttpSpanExtractor.java:50] [trace=,span=]  - Exception occurred while trying to extract span from carrier\njava.lang.IllegalArgumentException: Malformed id: 1f99a12d-066e-4aac-a71a-e7d42d7fa7a3\n    at org.springframework.cloud.sleuth.Span.hexToId(Span.java:585)\n    at org.springframework.cloud.sleuth.instrument.web.ZipkinHttpSpanExtractor.buildParentSpan(ZipkinHttpSpanExtractor.java:90)\n    at org.springframework.cloud.sleuth.instrument.web.ZipkinHttpSpanExtractor.joinTrace(ZipkinHttpSpanExtractor.java:48)\n    at org.springframework.cloud.sleuth.instrument.web.ZipkinHttpSpanExtractor.joinTrace(ZipkinHttpSpanExtractor.java:19)\n    at org.springframework.cloud.sleuth.instrument.web.TraceFilter.createSpan(TraceFilter.java:375)\n    at org.springframework.cloud.sleuth.instrument.web.TraceFilter.doFilter(TraceFilter.java:165)\n</code></pre>\n<p>From Span class I think traceId can only include 0-9 and a-f</p>\n<pre><code>    public static long hexToId(String lowerHex, int index) {\n        Assert.hasText(lowerHex, &quot;Can't convert empty hex string to long&quot;);\n        long result = 0L;\n\n        for(int endIndex = Math.min(index + 16, lowerHex.length()); index &lt; endIndex; ++index) {\n            char c = lowerHex.charAt(index);\n            result &lt;&lt;= 4;\n            if (c &gt;= '0' &amp;&amp; c &lt;= '9') {\n                result |= (long)(c - 48);\n            } else {\n                if (c &lt; 'a' || c &gt; 'f') {\n                    throw new IllegalArgumentException(&quot;Malformed id: &quot; + lowerHex);\n                }\n\n                result |= (long)(c - 97 + 10);\n            }\n        }\n\n        return result;\n    }\n</code></pre>\n<p>Any way to make the trace id generic?</p>\n<p>I am using spring boot 1.5.13.RELEASE with spring-cloud-sleuth-core/1.3.4.RELEASE</p>\n"},{"tags":["java","android"],"answers":[{"tags":[],"owner":{"account_id":26855967,"reputation":2351,"user_id":20440272,"display_name":"Sohaib Ahmed"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672912425,"creation_date":1672912425,"answer_id":75016583,"question_id":75016001,"body_markdown":"Try this Code\r\n\r\n    binding.saif1.addTextChangedListener(new TextWatcher() {\r\n        @Override\r\n        public void beforeTextChanged(CharSequence s, int start, int count, int after) {\r\n\r\n        }\r\n\r\n        @Override\r\n        public void onTextChanged(CharSequence s, int start, int before, int count) {\r\n\r\n        }\r\n\r\n        @Override\r\n        public void afterTextChanged(Editable mEdit) {\r\n            String text = mEdit.toString();\r\n            int temp = 0;\r\n\r\n            for (char ch : text.toCharArray()) {\r\n                if (ch == &#39;A&#39;) {\r\n                    temp += 10;\r\n                } else if (ch == &#39;B&#39;) {\r\n                    temp += 20;\r\n                }\r\n            }\r\n\r\n            binding.textView.setText(String.valueOf(temp));\r\n        }\r\n    });\r\n\r\nYou can add more condition by duplicating `else if` case.. e.g.\r\n\r\n    else if (ch == &#39;C&#39;) {\r\n        temp += 30;\r\n    }","title":"Display automatically an Integer value from Edit Text (entered by the user) to Text View without any actions?","body":"<p>Try this Code</p>\n<pre><code>binding.saif1.addTextChangedListener(new TextWatcher() {\n    @Override\n    public void beforeTextChanged(CharSequence s, int start, int count, int after) {\n\n    }\n\n    @Override\n    public void onTextChanged(CharSequence s, int start, int before, int count) {\n\n    }\n\n    @Override\n    public void afterTextChanged(Editable mEdit) {\n        String text = mEdit.toString();\n        int temp = 0;\n\n        for (char ch : text.toCharArray()) {\n            if (ch == 'A') {\n                temp += 10;\n            } else if (ch == 'B') {\n                temp += 20;\n            }\n        }\n\n        binding.textView.setText(String.valueOf(temp));\n    }\n});\n</code></pre>\n<p>You can add more condition by duplicating <code>else if</code> case.. e.g.</p>\n<pre><code>else if (ch == 'C') {\n    temp += 30;\n}\n</code></pre>\n"}],"owner":{"account_id":26488482,"reputation":104,"user_id":20126668,"display_name":"Best Thinking"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":33,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":75016583,"answer_count":1,"score":0,"last_activity_date":1672912425,"creation_date":1672909505,"question_id":75016001,"body_markdown":"I want to complete a project in which the user writes different characters like A, D, C in an edit text box and then automatically the values of those characters are collected (Addition in each other) in another text box.\r\nFor example if user pressed A then its value to textbox 10 and then user pressed B, its value 20 to textbox with A+B value. I am using the given code but not getting success.\r\n\r\n`your text`    \r\n         `\r\n    ` saif1.addTextChangedListener(new TextWatcher()\r\n        {\r\n                @SuppressLint(&quot;SetTextI18n&quot;)\r\n            @Override\r\n            public void afterTextChanged(Editable mEdit)\r\n            {\r\n                String text  = mEdit.toString();\r\n\r\n                if (text.equals(&quot;A&quot;)) {\r\n\r\n                        charactervalue.setText(&quot;10&quot;);\r\n                        \r\n                    String n1 = charactervalue.getText().toString();\r\n                    int n11 = Integer.parseInt(n1);\r\n                    String n2 = result.getText().toString();\r\n                    int n22 = Integer.parseInt(n2);\r\n                    finaltotal.setText(String.valueOf(n11 + n22));\r\n\r\n                }else if(text.equals(&quot;B&quot;)) {\r\n\r\n                    charactervalue.setText(&quot;20&quot;);\r\n\r\n                }\r\n\r\n            }\r\n\r\n            public void beforeTextChanged(CharSequence s, int start, int count, int after){\r\n\r\n            }\r\n\r\n            public void onTextChanged(CharSequence s, int start, int before, int count){\r\n\r\n            }\r\n\r\n        });\r\n","title":"Display automatically an Integer value from Edit Text (entered by the user) to Text View without any actions?","body":"<p>I want to complete a project in which the user writes different characters like A, D, C in an edit text box and then automatically the values of those characters are collected (Addition in each other) in another text box.\nFor example if user pressed A then its value to textbox 10 and then user pressed B, its value 20 to textbox with A+B value. I am using the given code but not getting success.</p>\n<p><code>your text</code><br />\n<code> </code> saif1.addTextChangedListener(new TextWatcher()\n{\n@SuppressLint(&quot;SetTextI18n&quot;)\n@Override\npublic void afterTextChanged(Editable mEdit)\n{\nString text  = mEdit.toString();</p>\n<pre><code>            if (text.equals(&quot;A&quot;)) {\n\n                    charactervalue.setText(&quot;10&quot;);\n                    \n                String n1 = charactervalue.getText().toString();\n                int n11 = Integer.parseInt(n1);\n                String n2 = result.getText().toString();\n                int n22 = Integer.parseInt(n2);\n                finaltotal.setText(String.valueOf(n11 + n22));\n\n            }else if(text.equals(&quot;B&quot;)) {\n\n                charactervalue.setText(&quot;20&quot;);\n\n            }\n\n        }\n\n        public void beforeTextChanged(CharSequence s, int start, int count, int after){\n\n        }\n\n        public void onTextChanged(CharSequence s, int start, int before, int count){\n\n        }\n\n    });\n</code></pre>\n"},{"tags":["java","wildfly"],"comments":[{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":1,"creation_date":1672911520,"post_id":75016289,"comment_id":132381099,"body_markdown":"Wildfly 2.7 is JakartaEE compliant, but &quot;Smiley&#39;s HTTP Proxy Servlet&quot; requires a JavaEE container.","body":"Wildfly 2.7 is JakartaEE compliant, but &quot;Smiley&#39;s HTTP Proxy Servlet&quot; requires a JavaEE container."},{"owner":{"account_id":459833,"reputation":441,"user_id":860546,"accept_rate":43,"display_name":"yaron"},"score":0,"creation_date":1672912415,"post_id":75016289,"comment_id":132381374,"body_markdown":"@StephenC What should i do to use &quot;Smiley&#39;s HTTP Proxy Servlet&quot; in wildfly27","body":"@StephenC What should i do to use &quot;Smiley&#39;s HTTP Proxy Servlet&quot; in wildfly27"},{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1672913811,"post_id":75016289,"comment_id":132381820,"body_markdown":"Look for an alternative.  It is not compatible.   Or hack on the source  code.","body":"Look for an alternative.  It is not compatible.   Or hack on the source  code."},{"owner":{"account_id":459833,"reputation":441,"user_id":860546,"accept_rate":43,"display_name":"yaron"},"score":0,"creation_date":1672913984,"post_id":75016289,"comment_id":132381879,"body_markdown":"@StephenC i have a few servlet that use javax.servlet and i need to upgrade to wilfly27\nSo i need to change code to jakarta, can&#39;t look for an alternative","body":"@StephenC i have a few servlet that use javax.servlet and i need to upgrade to wilfly27 So i need to change code to jakarta, can&#39;t look for an alternative"},{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":1,"creation_date":1672924365,"post_id":75016289,"comment_id":132385306,"body_markdown":"In that case change the code to jakarta.  The source code is available.","body":"In that case change the code to jakarta.  The source code is available."},{"owner":{"account_id":51161,"reputation":17015,"user_id":152794,"display_name":"James R. Perkins"},"score":0,"creation_date":1673033949,"post_id":75016289,"comment_id":132414447,"body_markdown":"There will soon be a feature pack that can be added to WildFly which will perform the package migration in a deployment from Jakarta EE 8 to Jakarta EE 9 https://issues.redhat.com/browse/WFLY-17219.","body":"There will soon be a feature pack that can be added to WildFly which will perform the package migration in a deployment from Jakarta EE 8 to Jakarta EE 9 <a href=\"https://issues.redhat.com/browse/WFLY-17219\" rel=\"nofollow noreferrer\">issues.redhat.com/browse/WFLY-17219</a>."}],"owner":{"account_id":459833,"reputation":441,"user_id":860546,"accept_rate":43,"display_name":"yaron"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":623,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672912371,"creation_date":1672910985,"question_id":75016289,"body_markdown":"I try to use https://github.com/mitre/HTTP-Proxy-Servlet in wildfly27 with jdk11\r\n\r\nI get the following error\r\nShould it work as it is , or should i replace javax with jakarta?\r\n\r\nIs this problem because i use wildfly, and it won&#39;t happen with another server app like tomcat?\r\n\r\n\r\n``` \r\n11:23:55,153 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-3) MSC000001: Failed to start service jboss.deployment.unit.&quot;proxy.war&quot;.undertow-deployment.UndertowDeploymentInfoService: org.jboss.msc.service.StartException in service jboss.deployment.unit.&quot;proxy.war&quot;.undertow-deployment.UndertowDeploymentInfoService: Failed to start service\r\n        at org.jboss.msc@1.4.13.Final//org.jboss.msc.service.ServiceControllerImpl$StartTask.execute(ServiceControllerImpl.java:1731)\r\n        at org.jboss.msc@1.4.13.Final//org.jboss.msc.service.ServiceControllerImpl$ControllerTask.run(ServiceControllerImpl.java:1559)\r\n        at org.jboss.threads@2.4.0.Final//org.jboss.threads.ContextClassLoaderSavingRunnable.run(ContextClassLoaderSavingRunnable.java:35)\r\n        at org.jboss.threads@2.4.0.Final//org.jboss.threads.EnhancedQueueExecutor.safeRun(EnhancedQueueExecutor.java:1990)\r\n        at org.jboss.threads@2.4.0.Final//org.jboss.threads.EnhancedQueueExecutor$ThreadBody.doRunTask(EnhancedQueueExecutor.java:1486)\r\n        at org.jboss.threads@2.4.0.Final//org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1377)\r\n        at java.base/java.lang.Thread.run(Thread.java:829)\r\nCaused by: java.lang.IllegalArgumentException: UT010009: Servlet proxyHostServer of type class org.mitre.dsmiley.httpproxy.ProxyServlet does not implement jakarta.servlet.Servlet\r\n        at io.undertow.servlet@2.3.0.Final//io.undertow.servlet.api.ServletInfo.&lt;init&gt;(ServletInfo.java:98)\r\n        at org.wildfly.extension.undertow@27.0.1.Final//org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.createServletConfig(UndertowDeploymentInfoService.java:660)\r\n        at org.wildfly.extension.undertow@27.0.1.Final//org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.start(UndertowDeploymentInfoService.java:288)\r\n        at org.jboss.msc@1.4.13.Final//org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1739)\r\n        at org.jboss.msc@1.4.13.Final//org.jboss.msc.service.ServiceControllerImpl$StartTask.execute(ServiceControllerImpl.java:1701)\r\n```","title":"Using javax.servlet in jdk11 and wildfly27","body":"<p>I try to use <a href=\"https://github.com/mitre/HTTP-Proxy-Servlet\" rel=\"nofollow noreferrer\">https://github.com/mitre/HTTP-Proxy-Servlet</a> in wildfly27 with jdk11</p>\n<p>I get the following error\nShould it work as it is , or should i replace javax with jakarta?</p>\n<p>Is this problem because i use wildfly, and it won't happen with another server app like tomcat?</p>\n<pre><code>11:23:55,153 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-3) MSC000001: Failed to start service jboss.deployment.unit.&quot;proxy.war&quot;.undertow-deployment.UndertowDeploymentInfoService: org.jboss.msc.service.StartException in service jboss.deployment.unit.&quot;proxy.war&quot;.undertow-deployment.UndertowDeploymentInfoService: Failed to start service\n        at org.jboss.msc@1.4.13.Final//org.jboss.msc.service.ServiceControllerImpl$StartTask.execute(ServiceControllerImpl.java:1731)\n        at org.jboss.msc@1.4.13.Final//org.jboss.msc.service.ServiceControllerImpl$ControllerTask.run(ServiceControllerImpl.java:1559)\n        at org.jboss.threads@2.4.0.Final//org.jboss.threads.ContextClassLoaderSavingRunnable.run(ContextClassLoaderSavingRunnable.java:35)\n        at org.jboss.threads@2.4.0.Final//org.jboss.threads.EnhancedQueueExecutor.safeRun(EnhancedQueueExecutor.java:1990)\n        at org.jboss.threads@2.4.0.Final//org.jboss.threads.EnhancedQueueExecutor$ThreadBody.doRunTask(EnhancedQueueExecutor.java:1486)\n        at org.jboss.threads@2.4.0.Final//org.jboss.threads.EnhancedQueueExecutor$ThreadBody.run(EnhancedQueueExecutor.java:1377)\n        at java.base/java.lang.Thread.run(Thread.java:829)\nCaused by: java.lang.IllegalArgumentException: UT010009: Servlet proxyHostServer of type class org.mitre.dsmiley.httpproxy.ProxyServlet does not implement jakarta.servlet.Servlet\n        at io.undertow.servlet@2.3.0.Final//io.undertow.servlet.api.ServletInfo.&lt;init&gt;(ServletInfo.java:98)\n        at org.wildfly.extension.undertow@27.0.1.Final//org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.createServletConfig(UndertowDeploymentInfoService.java:660)\n        at org.wildfly.extension.undertow@27.0.1.Final//org.wildfly.extension.undertow.deployment.UndertowDeploymentInfoService.start(UndertowDeploymentInfoService.java:288)\n        at org.jboss.msc@1.4.13.Final//org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1739)\n        at org.jboss.msc@1.4.13.Final//org.jboss.msc.service.ServiceControllerImpl$StartTask.execute(ServiceControllerImpl.java:1701)\n</code></pre>\n"},{"tags":["java","thymeleaf"],"comments":[{"owner":{"account_id":3701688,"reputation":3357,"user_id":3081206,"display_name":"takendarkk"},"score":0,"creation_date":1440159978,"post_id":32140262,"comment_id":52170044,"body_markdown":"&quot;_so far no success_&quot; You should really try to be more descriptive about what is happening rather than just saying &quot;it doesn&#39;t work&quot;.","body":"&quot;<i>so far no success</i>&quot; You should really try to be more descriptive about what is happening rather than just saying &quot;it doesn&#39;t work&quot;."},{"owner":{"account_id":4299687,"reputation":6224,"user_id":3663765,"accept_rate":61,"display_name":"Program-Me-Rev"},"score":0,"creation_date":1440160127,"post_id":32140262,"comment_id":52170135,"body_markdown":"@Takendarkk I did edited the question. The email sends, but the inline image won&#39;t show in the email.","body":"@Takendarkk I did edited the question. The email sends, but the inline image won&#39;t show in the email."},{"owner":{"account_id":5110952,"reputation":738,"user_id":4097545,"display_name":"Rohan Kushwaha"},"score":0,"creation_date":1441354247,"post_id":32140262,"comment_id":52654961,"body_markdown":"@Program-Me-Rev, Did you solve it?","body":"@Program-Me-Rev, Did you solve it?"},{"owner":{"account_id":12169228,"reputation":251,"user_id":8884490,"accept_rate":20,"display_name":"user_531"},"score":0,"creation_date":1547302681,"post_id":32140262,"comment_id":95150762,"body_markdown":"@Program-Me-Rev is this problem solved by the  below solutions provided ? i am facing the same issue .","body":"@Program-Me-Rev is this problem solved by the  below solutions provided ? i am facing the same issue ."},{"owner":{"account_id":12169228,"reputation":251,"user_id":8884490,"accept_rate":20,"display_name":"user_531"},"score":0,"creation_date":1547306185,"post_id":32140262,"comment_id":95151597,"body_markdown":"@Program-Me-Rev may i please know what is input ?","body":"@Program-Me-Rev may i please know what is input ?"}],"answers":[{"comments":[{"owner":{"account_id":12169228,"reputation":251,"user_id":8884490,"accept_rate":20,"display_name":"user_531"},"score":1,"creation_date":1547202050,"post_id":32150384,"comment_id":95120212,"body_markdown":"can you please elaborate ? i have the same problem?","body":"can you please elaborate ? i have the same problem?"},{"owner":{"account_id":4561689,"reputation":427,"user_id":3703849,"display_name":"Pavul Zavala"},"score":0,"creation_date":1575138578,"post_id":32150384,"comment_id":104467868,"body_markdown":"i created an utility class, where i was setting inline images before email construction, inline images were not working, i moved to the end and was working magically, thanks a lot.","body":"i created an utility class, where i was setting inline images before email construction, inline images were not working, i moved to the end and was working magically, thanks a lot."}],"tags":[],"owner":{"account_id":158089,"reputation":476,"user_id":1649295,"display_name":"derickson82"},"comment_count":2,"down_vote_count":0,"up_vote_count":12,"is_accepted":false,"score":12,"last_activity_date":1445980238,"creation_date":1440197539,"answer_id":32150384,"question_id":32140262,"body_markdown":"Just move your call to `setText()` up a few lines.\r\n\r\nThe javadoc for [`MimeMessageHelper.addInLine()`][1] says:\r\n\r\n&gt; NOTE: Invoke `addInline` _after_ [`setText(java.lang.String)`][2]; else, mail readers might not be able to resolve inline references correctly.\r\n\r\n\r\n  [1]: http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/mail/javamail/MimeMessageHelper.html#addInline-java.lang.String-org.springframework.core.io.Resource-\r\n  [2]: http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/mail/javamail/MimeMessageHelper.html#setText-java.lang.String-","title":"How to send email with inline image using ThymeLeaf","body":"<p>Just move your call to <code>setText()</code> up a few lines.</p>\n\n<p>The javadoc for <a href=\"http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/mail/javamail/MimeMessageHelper.html#addInline-java.lang.String-org.springframework.core.io.Resource-\" rel=\"noreferrer\"><code>MimeMessageHelper.addInLine()</code></a> says:</p>\n\n<blockquote>\n  <p>NOTE: Invoke <code>addInline</code> <em>after</em> <a href=\"http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/mail/javamail/MimeMessageHelper.html#setText-java.lang.String-\" rel=\"noreferrer\"><code>setText(java.lang.String)</code></a>; else, mail readers might not be able to resolve inline references correctly.</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":4299687,"reputation":6224,"user_id":3663765,"accept_rate":61,"display_name":"Program-Me-Rev"},"comment_count":0,"down_vote_count":2,"up_vote_count":3,"is_accepted":true,"score":1,"last_activity_date":1441368907,"creation_date":1441368907,"answer_id":32397836,"question_id":32140262,"body_markdown":"This works perfectly:\r\n\r\nJust add a link to the image hosted on an external server away from your desktop. Use inline CSS, instead of CSS classes.\r\n\r\nThis website will help you convert CSS classes to inline CSS, [Premailer.Dialect](http://premailer.dialect.ca/).\r\n\r\nAvoid any fancy CSS, just use the most basic. Floating (like float: left;) should be avoided as much as possible if you&#39;d like your HTML mail to flow easily, even in mobile devises and other smaller screens.\r\n\r\nInclude [NekoHTML](http://nekohtml.sourceforge.net/) in your project libraries, and change your [Spring](https://spring.io/) spring.xml to:\r\n\r\n\t&lt;!-- THYMELEAF: Template Resolver for email templates --&gt;\r\n\t&lt;bean id=&quot;emailTemplateResolver&quot; class=&quot;org.thymeleaf.templateresolver.ClassLoaderTemplateResolver&quot;&gt;\r\n\t\t&lt;property name=&quot;prefix&quot; value=&quot;resources/WEB_INF/HTMLMailTemplates/XXXX/html/&quot; /&gt;\r\n\t\t&lt;!-- &lt;property name=&quot;templateMode&quot; value=&quot;HTML5&quot; /&gt; --&gt;\r\n\t\t&lt;property name=&quot;templateMode&quot; value=&quot;LEGACYHTML5&quot; /&gt;\r\n\t\t&lt;property name=&quot;characterEncoding&quot; value=&quot;UTF-8&quot; /&gt;\r\n\t\t&lt;property name=&quot;order&quot; value=&quot;1&quot; /&gt;\r\n\t&lt;/bean&gt;\r\n\r\nSample this:\r\n\r\n\t&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\r\n\t&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;\r\n\t&lt;head&gt;\r\n\t\t&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;\r\n\t\t&lt;title&gt;Email With Inline Images&lt;/title&gt;\r\n\r\n\t\t&lt;style&gt;\r\n\t\t\tbody {\r\n\t\t\t\tbackground-image: url(&#39;https://dl.dropbox.com/s/XXXX/pageBackGround.gif&#39;);\r\n\t\t\t\tbackground-repeat: repeat;\r\n\t\t\t\tmargin:0;\r\n\t\t\t\toutline:0;\r\n\t\t\t}\r\n\t\t\t.pageContentWrapper {\r\n\t\t\t\tpadding:10px;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tbackground-image: url(&#39;https://dl.dropbox.com/s/XXXX/smallerInlineImage.gif&#39;);\r\n\t\t\t\tbackground-repeat: repeat;\r\n\t\t\t}\r\n\t\t\t.smallerInlineImage {\r\n\t\t\t\twidth: 22px;\r\n\t\t\t\theight: 22px;\r\n\t\t\t\tpadding: 0 4px 6px 0;\r\n\t\t\t\tfloat: left;\r\n\t\t\t}\r\n\t\t&lt;/style&gt;\r\n\r\n\t&lt;/head&gt;\r\n\r\n\t&lt;body&gt;\r\n\t\t&lt;div class=&quot;pageContentWrapper&quot;&gt;\r\n\t\t\t&lt;div class=&quot;smallerInlineImage&quot;&gt;\r\n\t\t\t\t&lt;img src=&quot;https://dl.dropboxusercontent.com/s/3ydel6zp53pb65b/smallerInlineImage.png&quot; height=&quot;22&quot; width=&quot;22&quot;&gt;\r\n\t\t\t&lt;/div&gt;\r\n\t\t&lt;/div&gt;\r\n\t&lt;/body&gt;\r\n\r\nService Class:\r\n\r\n\t@Service\r\n\tpublic class ThymeEmailService {\r\n\r\n\t    @Autowired\r\n\t    private JavaMailSender mailSender;\r\n\r\n\t    @Autowired\r\n\t    private TemplateEngine templateEngine;\r\n\r\n\t    public void sendMailWithInline() throws MessagingException {\r\n\r\n\t        final Context ctx = new Context();\r\n\r\n\t        final MimeMessage mimeMessage = this.mailSender.createMimeMessage();\r\n\t        final MimeMessageHelper message = new MimeMessageHelper(mimeMessage, true, &quot;UTF-8&quot;);\r\n\t        message.setSubject(&quot;Sample Email Subject&quot;);\r\n\t        message.setFrom(&quot;senderEmail@yahoo.com&quot;);\r\n\t        message.setTo(&quot;recipientEmail@yahoo.com&quot;);\r\n\r\n\t        final String htmlContent = this.templateEngine.process(&quot;emailTemplate.html&quot;, ctx);\r\n\t        message.setText(htmlContent, true);\r\n\r\n\t        String[] attachments = {&quot;C:\\\\Users\\\\MyPc\\\\Dropbox\\\\CV\\\\myPDFAttachment.pdf&quot;};\r\n\r\n\t        for (String attachment : attachments) {\r\n\t            FileSystemResource file = new FileSystemResource(attachment);\r\n\t            message.addAttachment(file.getFilename(), file);\r\n\t        }\r\n\r\n\t        this.mailSender.send(mimeMessage);\r\n\t    }\r\n\t}","title":"How to send email with inline image using ThymeLeaf","body":"<p>This works perfectly:</p>\n\n<p>Just add a link to the image hosted on an external server away from your desktop. Use inline CSS, instead of CSS classes.</p>\n\n<p>This website will help you convert CSS classes to inline CSS, <a href=\"http://premailer.dialect.ca/\" rel=\"nofollow\">Premailer.Dialect</a>.</p>\n\n<p>Avoid any fancy CSS, just use the most basic. Floating (like float: left;) should be avoided as much as possible if you'd like your HTML mail to flow easily, even in mobile devises and other smaller screens.</p>\n\n<p>Include <a href=\"http://nekohtml.sourceforge.net/\" rel=\"nofollow\">NekoHTML</a> in your project libraries, and change your <a href=\"https://spring.io/\" rel=\"nofollow\">Spring</a> spring.xml to:</p>\n\n<pre><code>&lt;!-- THYMELEAF: Template Resolver for email templates --&gt;\n&lt;bean id=\"emailTemplateResolver\" class=\"org.thymeleaf.templateresolver.ClassLoaderTemplateResolver\"&gt;\n    &lt;property name=\"prefix\" value=\"resources/WEB_INF/HTMLMailTemplates/XXXX/html/\" /&gt;\n    &lt;!-- &lt;property name=\"templateMode\" value=\"HTML5\" /&gt; --&gt;\n    &lt;property name=\"templateMode\" value=\"LEGACYHTML5\" /&gt;\n    &lt;property name=\"characterEncoding\" value=\"UTF-8\" /&gt;\n    &lt;property name=\"order\" value=\"1\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>Sample this:</p>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n    &lt;title&gt;Email With Inline Images&lt;/title&gt;\n\n    &lt;style&gt;\n        body {\n            background-image: url('https://dl.dropbox.com/s/XXXX/pageBackGround.gif');\n            background-repeat: repeat;\n            margin:0;\n            outline:0;\n        }\n        .pageContentWrapper {\n            padding:10px;\n            width: 100%;\n            background-image: url('https://dl.dropbox.com/s/XXXX/smallerInlineImage.gif');\n            background-repeat: repeat;\n        }\n        .smallerInlineImage {\n            width: 22px;\n            height: 22px;\n            padding: 0 4px 6px 0;\n            float: left;\n        }\n    &lt;/style&gt;\n\n&lt;/head&gt;\n\n&lt;body&gt;\n    &lt;div class=\"pageContentWrapper\"&gt;\n        &lt;div class=\"smallerInlineImage\"&gt;\n            &lt;img src=\"https://dl.dropboxusercontent.com/s/3ydel6zp53pb65b/smallerInlineImage.png\" height=\"22\" width=\"22\"&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>Service Class:</p>\n\n<pre><code>@Service\npublic class ThymeEmailService {\n\n    @Autowired\n    private JavaMailSender mailSender;\n\n    @Autowired\n    private TemplateEngine templateEngine;\n\n    public void sendMailWithInline() throws MessagingException {\n\n        final Context ctx = new Context();\n\n        final MimeMessage mimeMessage = this.mailSender.createMimeMessage();\n        final MimeMessageHelper message = new MimeMessageHelper(mimeMessage, true, \"UTF-8\");\n        message.setSubject(\"Sample Email Subject\");\n        message.setFrom(\"senderEmail@yahoo.com\");\n        message.setTo(\"recipientEmail@yahoo.com\");\n\n        final String htmlContent = this.templateEngine.process(\"emailTemplate.html\", ctx);\n        message.setText(htmlContent, true);\n\n        String[] attachments = {\"C:\\\\Users\\\\MyPc\\\\Dropbox\\\\CV\\\\myPDFAttachment.pdf\"};\n\n        for (String attachment : attachments) {\n            FileSystemResource file = new FileSystemResource(attachment);\n            message.addAttachment(file.getFilename(), file);\n        }\n\n        this.mailSender.send(mimeMessage);\n    }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":16731772,"reputation":1574,"user_id":12093975,"display_name":"skyho"},"score":0,"creation_date":1672911642,"post_id":75008608,"comment_id":132381127,"body_markdown":"https://docs.spring.io/spring-framework/docs/5.0.13.RELEASE/spring-framework-reference/integration.html#mail","body":"<a href=\"https://docs.spring.io/spring-framework/docs/5.0.13.RELEASE/spring-framework-reference/integration.html#mail\" rel=\"nofollow noreferrer\">docs.spring.io/spring-framework/docs/5.0.13.RELEASE/&hellip;</a>"}],"tags":[],"owner":{"account_id":16731772,"reputation":1574,"user_id":12093975,"display_name":"skyho"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672911663,"creation_date":1672850762,"answer_id":75008608,"question_id":32140262,"body_markdown":"\r\n\r\n```java\r\n@Component\r\n@RequiredArgsConstructor\r\n@Slf4j\r\npublic class EmailSenderService {\r\n\r\n    private final JavaMailSender emailSender;\r\n\r\n    private final SpringTemplateEngine templateEngine;\r\n\r\n    public void sendEmail (MailDto mailDto, String nameTemplate)  {\r\n\r\n        MimeMessage message = emailSender.createMimeMessage();\r\n\r\n\r\n        MimeMessageHelper helper;\r\n        try {\r\n            helper = new MimeMessageHelper(message,\r\n                    MimeMessageHelper.MULTIPART_MODE_MIXED_RELATED,\r\n                    StandardCharsets.UTF_8.name ());\r\n\r\n            ClassPathResource attachment = new ClassPathResource(&quot;static/pdf/practice-react-programming.pdf&quot;);\r\n            ClassPathResource image = new ClassPathResource(&quot;static/img/auth.png&quot;);\r\n\r\n            helper.addAttachment(&quot;reactive-programming-book&quot;, attachment);\r\n\r\n            helper.setTo(mailDto.mailTo()); \r\n            helper.setSubject(mailDto.subject());\r\n            /*it is important to specify the same sender address that you have specified in application.yml*/\r\n            helper.setFrom(mailDto.mailFrom());\r\n\r\n            Context context = new Context();\r\n\r\n            context.setVariables(mailDto.propertiesMail());\r\n\r\n            String html = templateEngine.process(nameTemplate, context);\r\n            helper.setText(html, true);\r\n            \r\n            /*This must be set after calling the method setText()*/\r\n            helper.addInline(&quot;auth&quot;, image);\r\n        } catch (MessagingException e) {\r\n            log.error(e.getLocalizedMessage());\r\n          //  throw new RuntimeException(e);\r\n        }\r\n\r\n        emailSender.send(message);\r\n    }\r\n}\r\n```\r\n\r\n```html\r\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\r\n        &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\r\n&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot; xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;\r\n&lt;head&gt;\r\n    &lt;title&gt;Thymeleaf –∏ Spring boot&lt;/title&gt;\r\n\r\n    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;/&gt;\r\n    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;/&gt;\r\n\r\n    &lt;link href=&#39;http://fonts.googleapis.com/css?family=Roboto&#39; rel=&#39;stylesheet&#39; type=&#39;text/css&#39;/&gt;\r\n\r\n    &lt;!-- use the font --&gt;\r\n    &lt;style&gt;\r\n        body {\r\n            font-family: &#39;Roboto&#39;, sans-serif;\r\n            font-size: 48px;\r\n        }\r\n\r\n        .circle {\r\n            border-radius: 50%; \r\n            border: 5px solid #fff;\r\n            box-shadow: 2px 1px 5px #999999;\r\n        }\r\n\r\n        p {\r\n            font-size: 25px;\r\n            font-family: Cambria;\r\n        }\r\n    &lt;/style&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;p th:text=&quot;${&#39;Hello Dear &#39; + name}&quot;&gt;&lt;/p&gt;\r\n\r\n&lt;p th:if=&quot;${name.length() &gt; 5}&quot;&gt;\r\n   you name ...\r\n&lt;/p&gt;\r\n&lt;p&gt;\r\n     &lt;b&gt;Authentication has being passed.&lt;/b&gt;\r\n    &lt;span th:text=&quot;${#dates.format(#dates.createNow(), &#39;dd MMM yyyy HH:mm&#39;)}&quot;&gt;&lt;/span&gt;\r\n&lt;/p&gt;\r\n\r\n&lt;p&gt;\r\n    text...\r\n&lt;/p&gt;\r\n&lt;p&gt;\r\n    &lt;!--for external images.--&gt;\r\n    &lt;a href=&quot;https://kipmu.ru/wp-content/uploads/ksplshd-scaled.jpg&quot;&gt;\r\n        &lt;img src=&quot;https://kipmu.ru/wp-content/uploads/ksplshd-scaled.jpg&quot;\r\n             alt=&quot;http://localhost.com&quot;\r\n             height=&quot;220&quot;\r\n             width=&quot;220&quot;\r\n             class=&quot;circle&quot;/&gt;\r\n    &lt;/a&gt;\r\n&lt;/p&gt;\r\n\r\n&lt;p&gt;Attached images&lt;/p&gt;\r\n&lt;p&gt;\r\n    &lt;img src=&quot;cid:auth&quot; alt=&quot;http://localhost.com&quot;\r\n    height=&quot;220&quot;\r\n    width=&quot;220&quot;\r\n    class=&quot;circle&quot; /&gt;\r\n&lt;/p&gt;\r\n&lt;p&gt;\r\n    Regardless, &lt;br/&gt;\r\n    &lt;em th:text=&quot;${sign}&quot;&gt;&lt;/em&gt;\r\n&lt;p th:text=&quot;${location}&quot;&gt;&lt;/p&gt;\r\n&lt;/p&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n```\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/JzbIn.png","title":"How to send email with inline image using ThymeLeaf","body":"<pre class=\"lang-java prettyprint-override\"><code>@Component\n@RequiredArgsConstructor\n@Slf4j\npublic class EmailSenderService {\n\n    private final JavaMailSender emailSender;\n\n    private final SpringTemplateEngine templateEngine;\n\n    public void sendEmail (MailDto mailDto, String nameTemplate)  {\n\n        MimeMessage message = emailSender.createMimeMessage();\n\n\n        MimeMessageHelper helper;\n        try {\n            helper = new MimeMessageHelper(message,\n                    MimeMessageHelper.MULTIPART_MODE_MIXED_RELATED,\n                    StandardCharsets.UTF_8.name ());\n\n            ClassPathResource attachment = new ClassPathResource(&quot;static/pdf/practice-react-programming.pdf&quot;);\n            ClassPathResource image = new ClassPathResource(&quot;static/img/auth.png&quot;);\n\n            helper.addAttachment(&quot;reactive-programming-book&quot;, attachment);\n\n            helper.setTo(mailDto.mailTo()); \n            helper.setSubject(mailDto.subject());\n            /*it is important to specify the same sender address that you have specified in application.yml*/\n            helper.setFrom(mailDto.mailFrom());\n\n            Context context = new Context();\n\n            context.setVariables(mailDto.propertiesMail());\n\n            String html = templateEngine.process(nameTemplate, context);\n            helper.setText(html, true);\n            \n            /*This must be set after calling the method setText()*/\n            helper.addInline(&quot;auth&quot;, image);\n        } catch (MessagingException e) {\n            log.error(e.getLocalizedMessage());\n          //  throw new RuntimeException(e);\n        }\n\n        emailSender.send(message);\n    }\n}\n</code></pre>\n<pre class=\"lang-html prettyprint-override\"><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;\n        &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot; xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;\n&lt;head&gt;\n    &lt;title&gt;Thymeleaf –∏ Spring boot&lt;/title&gt;\n\n    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;/&gt;\n    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;/&gt;\n\n    &lt;link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'/&gt;\n\n    &lt;!-- use the font --&gt;\n    &lt;style&gt;\n        body {\n            font-family: 'Roboto', sans-serif;\n            font-size: 48px;\n        }\n\n        .circle {\n            border-radius: 50%; \n            border: 5px solid #fff;\n            box-shadow: 2px 1px 5px #999999;\n        }\n\n        p {\n            font-size: 25px;\n            font-family: Cambria;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;p th:text=&quot;${'Hello Dear ' + name}&quot;&gt;&lt;/p&gt;\n\n&lt;p th:if=&quot;${name.length() &gt; 5}&quot;&gt;\n   you name ...\n&lt;/p&gt;\n&lt;p&gt;\n     &lt;b&gt;Authentication has being passed.&lt;/b&gt;\n    &lt;span th:text=&quot;${#dates.format(#dates.createNow(), 'dd MMM yyyy HH:mm')}&quot;&gt;&lt;/span&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n    text...\n&lt;/p&gt;\n&lt;p&gt;\n    &lt;!--for external images.--&gt;\n    &lt;a href=&quot;https://kipmu.ru/wp-content/uploads/ksplshd-scaled.jpg&quot;&gt;\n        &lt;img src=&quot;https://kipmu.ru/wp-content/uploads/ksplshd-scaled.jpg&quot;\n             alt=&quot;http://localhost.com&quot;\n             height=&quot;220&quot;\n             width=&quot;220&quot;\n             class=&quot;circle&quot;/&gt;\n    &lt;/a&gt;\n&lt;/p&gt;\n\n&lt;p&gt;Attached images&lt;/p&gt;\n&lt;p&gt;\n    &lt;img src=&quot;cid:auth&quot; alt=&quot;http://localhost.com&quot;\n    height=&quot;220&quot;\n    width=&quot;220&quot;\n    class=&quot;circle&quot; /&gt;\n&lt;/p&gt;\n&lt;p&gt;\n    Regardless, &lt;br/&gt;\n    &lt;em th:text=&quot;${sign}&quot;&gt;&lt;/em&gt;\n&lt;p th:text=&quot;${location}&quot;&gt;&lt;/p&gt;\n&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/JzbIn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JzbIn.png\" alt=\"enter image description here\" /></a></p>\n"}],"owner":{"account_id":4299687,"reputation":6224,"user_id":3663765,"accept_rate":61,"display_name":"Program-Me-Rev"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":16626,"favorite_count":0,"down_vote_count":0,"up_vote_count":8,"accepted_answer_id":32397836,"answer_count":3,"score":8,"last_activity_date":1672911663,"creation_date":1440159786,"question_id":32140262,"body_markdown":"I&#39;m trying to send an email with an inline image using ThymeLeaf and Spring, but so far no success. The email sends, but the inline image won&#39;t show in the email.\r\n\r\nThe project is not web-based (not a website), but is a desktop stand-alone, not mobile\r\n\r\nThis is how I get the image file:\r\n\r\n\tURL url = getClass().getResource(&quot;/LawFirmAdvisoryGroup.jpg&quot;);\r\n\tFile file = new File(url.getPath());\r\n\r\n\tMultipartFile multipartFile = new MockMultipartFile(file.getName(),\r\n\t\tfile.getName(), &quot;image/jpeg&quot;, IOUtils.toByteArray(input));\r\n\r\n----------------------------------------------------------------------------\r\n\r\nMy service class:\r\n\r\n\t@Autowired\r\n\tprivate JavaMailSender mailSender;\r\n\r\n\t@Autowired\r\n\tprivate TemplateEngine templateEngine;\r\n\r\n\tpublic void sendMailWithInline(final String recipientName, final String recipientEmail, final MultipartFile image, final byte[] imageBytes)\r\n\tthrows MessagingException {\r\n\r\n\t    final Context ctx = new Context();\r\n\t        ctx.setVariable(&quot;imageResourceName&quot;, image.getName()); // so that we can reference it from HTML\r\n\r\n\t        final MimeMessage mimeMessage = this.mailSender.createMimeMessage();\r\n\t        final MimeMessageHelper message\r\n\t        = new MimeMessageHelper(mimeMessage, true, &quot;UTF-8&quot;);\r\n\t        message.setSubject(&quot;Inline Image&quot;);\r\n\t        message.setFrom(&quot;XXXX@yahoo.com&quot;);\r\n\t        message.setTo(recipientEmail);\r\n\r\n\t        // Add the inline image, referenced from the HTML code as &quot;cid:${imageResourceName}&quot;\r\n\t        final InputStreamSource imageSource = new ByteArrayResource(imageBytes);\r\n\t        message.addInline(image.getName(), imageSource, image.getContentType());\r\n\t        \r\n\r\n\t        final String htmlContent = this.templateEngine.process(&quot;left_sidebar.html&quot;, ctx);\r\n\t        message.setText(htmlContent, true);\r\n\t        this.mailSender.send(mimeMessage);\r\n\r\n\t    }\r\n\r\n----------------------------------------------------------------------------\r\n\r\nThe HTML:\r\n\r\n\t&lt;!DOCTYPE html&gt;\r\n\t&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;\r\n\t  &lt;head&gt;\r\n\t    &lt;title th:remove=&quot;all&quot;&gt;Email with inline image&lt;/title&gt;\r\n\t    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;\r\n\t  &lt;/head&gt;\r\n\t  &lt;body&gt;\r\n\t    &lt;p&gt;\r\n\t      &lt;img src=&quot;LawFirmAdvisoryGroup.jpg&quot; th:src=&quot;&#39;cid:&#39; + ${imageResourceName}&quot; /&gt;\r\n\t    &lt;/p&gt;\r\n\t  &lt;/body&gt;\r\n\t&lt;/html&gt;","title":"How to send email with inline image using ThymeLeaf","body":"<p>I'm trying to send an email with an inline image using ThymeLeaf and Spring, but so far no success. The email sends, but the inline image won't show in the email.</p>\n\n<p>The project is not web-based (not a website), but is a desktop stand-alone, not mobile</p>\n\n<p>This is how I get the image file:</p>\n\n<pre><code>URL url = getClass().getResource(\"/LawFirmAdvisoryGroup.jpg\");\nFile file = new File(url.getPath());\n\nMultipartFile multipartFile = new MockMultipartFile(file.getName(),\n    file.getName(), \"image/jpeg\", IOUtils.toByteArray(input));\n</code></pre>\n\n<hr>\n\n<p>My service class:</p>\n\n<pre><code>@Autowired\nprivate JavaMailSender mailSender;\n\n@Autowired\nprivate TemplateEngine templateEngine;\n\npublic void sendMailWithInline(final String recipientName, final String recipientEmail, final MultipartFile image, final byte[] imageBytes)\nthrows MessagingException {\n\n    final Context ctx = new Context();\n        ctx.setVariable(\"imageResourceName\", image.getName()); // so that we can reference it from HTML\n\n        final MimeMessage mimeMessage = this.mailSender.createMimeMessage();\n        final MimeMessageHelper message\n        = new MimeMessageHelper(mimeMessage, true, \"UTF-8\");\n        message.setSubject(\"Inline Image\");\n        message.setFrom(\"XXXX@yahoo.com\");\n        message.setTo(recipientEmail);\n\n        // Add the inline image, referenced from the HTML code as \"cid:${imageResourceName}\"\n        final InputStreamSource imageSource = new ByteArrayResource(imageBytes);\n        message.addInline(image.getName(), imageSource, image.getContentType());\n\n\n        final String htmlContent = this.templateEngine.process(\"left_sidebar.html\", ctx);\n        message.setText(htmlContent, true);\n        this.mailSender.send(mimeMessage);\n\n    }\n</code></pre>\n\n<hr>\n\n<p>The HTML:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html xmlns:th=\"http://www.thymeleaf.org\"&gt;\n  &lt;head&gt;\n    &lt;title th:remove=\"all\"&gt;Email with inline image&lt;/title&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;p&gt;\n      &lt;img src=\"LawFirmAdvisoryGroup.jpg\" th:src=\"'cid:' + ${imageResourceName}\" /&gt;\n    &lt;/p&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"},{"tags":["java","hadoop","mapreduce","hadoop-yarn","druid"],"comments":[{"owner":{"account_id":2671330,"reputation":183386,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":0,"creation_date":1672928770,"post_id":75016402,"comment_id":132387050,"body_markdown":"If the data is small, why do you need 4-6GB of memory per mapreduce task to process it?","body":"If the data is small, why do you need 4-6GB of memory per mapreduce task to process it?"},{"owner":{"account_id":13258181,"reputation":153,"user_id":9573581,"display_name":"Harpsichord1207"},"score":0,"creation_date":1672975860,"post_id":75016402,"comment_id":132399403,"body_markdown":"@OneCricketeer in production the data size may be larger, like 5GB data to ingest per task. Here I try to use a small file to make sure the problem is not caused by data size.","body":"@OneCricketeer in production the data size may be larger, like 5GB data to ingest per task. Here I try to use a small file to make sure the problem is not caused by data size."},{"owner":{"account_id":2671330,"reputation":183386,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":0,"creation_date":1673016112,"post_id":75016402,"comment_id":132408827,"body_markdown":"Sure, but files are broken into chunks up to 128 MB by mapreduce, by default, assuming that the file is splitable, so the size of the entire file isn&#39;t relevant. That being said, what happens when you halve each of those memory settings?","body":"Sure, but files are broken into chunks up to 128 MB by mapreduce, by default, assuming that the file is splitable, so the size of the entire file isn&#39;t relevant. That being said, what happens when you halve each of those memory settings?"}],"owner":{"account_id":13258181,"reputation":153,"user_id":9573581,"display_name":"Harpsichord1207"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":114,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672911568,"creation_date":1672911568,"question_id":75016402,"body_markdown":"I&#39;m using Apache Druid to ingest data(type: index_hadoop), but the index task failed, there&#39;s no useful infomation in index log. Then I find the MR application(application name: OELandingType-determine_partitions_hashed-Optional.of([2022-12-25T00:00:00.000Z/20222-12-26T00:00:00.000Z], OELandingType is my druid datasource name)) was failed, the error in yarn log says:\r\n```\r\n2023-01-05 17:04:55,291 INFO [main] org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl: Adding job token for job_1672909107121_0001 to jobTokenSecretManager\r\n2023-01-05 17:04:55,349 INFO [main] org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl: Not uberizing job_1672909107121_0001 because: too many reduces;\r\n2023-01-05 17:04:55,397 INFO [main] org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl: Input size for job job_1672909107121_0001 = 115735. Number of splits = 1\r\n2023-01-05 17:08:51,299 FATAL [main] org.apache.hadoop.mapreduce.v2.app.MRAppMaster: Error starting MRAppMaster\r\njava.lang.OutOfMemoryError: GC overhead limit exceeded\r\n\tat java.util.concurrent.locks.ReentrantReadWriteLock.&lt;init&gt;(ReentrantReadWriteLock.java:240)\r\n\tat java.util.concurrent.locks.ReentrantReadWriteLock.&lt;init&gt;(ReentrantReadWriteLock.java:230)\r\n\tat org.apache.hadoop.mapreduce.v2.app.job.impl.TaskImpl.&lt;init&gt;(TaskImpl.java:304)\r\n\tat org.apache.hadoop.mapreduce.v2.app.job.impl.ReduceTaskImpl.&lt;init&gt;(ReduceTaskImpl.java:47)\r\n\tat org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl$InitTransition.createReduceTasks(JobImpl.java:1569)\r\n\tat org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl$InitTransition.transition(JobImpl.java:1494)\r\n\tat org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl$InitTransition.transition(JobImpl.java:1414)\r\n\tat org.apache.hadoop.yarn.state.StateMachineFactory$MultipleInternalArc.doTransition(StateMachineFactory.java:385)\r\n\tat org.apache.hadoop.yarn.state.StateMachineFactory.doTransition(StateMachineFactory.java:302)\r\n\tat org.apache.hadoop.yarn.state.StateMachineFactory.access$300(StateMachineFactory.java:46)\r\n\tat org.apache.hadoop.yarn.state.StateMachineFactory$InternalStateMachine.doTransition(StateMachineFactory.java:448)\r\n\tat org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl.handle(JobImpl.java:1008)\r\n\tat org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl.handle(JobImpl.java:139)\r\n\tat org.apache.hadoop.mapreduce.v2.app.MRAppMaster$JobEventDispatcher.handle(MRAppMaster.java:1436)\r\n\tat org.apache.hadoop.mapreduce.v2.app.MRAppMaster.serviceStart(MRAppMaster.java:1207)\r\n\tat org.apache.hadoop.service.AbstractService.start(AbstractService.java:193)\r\n\tat org.apache.hadoop.mapreduce.v2.app.MRAppMaster$5.run(MRAppMaster.java:1654)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat javax.security.auth.Subject.doAs(Subject.java:422)\r\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1844)\r\n\tat org.apache.hadoop.mapreduce.v2.app.MRAppMaster.initAndStartAppMaster(MRAppMaster.java:1650)\r\n\tat org.apache.hadoop.mapreduce.v2.app.MRAppMaster.main(MRAppMaster.java:1583)\r\n2023-01-05 17:09:05,108 INFO [main] org.apache.hadoop.util.ExitUtil: Exiting with status 1\r\n2023-01-05 17:09:45,419 ERROR [Thread-0] org.apache.hadoop.yarn.YarnUncaughtExceptionHandler: Thread Thread[Thread-0,5,main] threw an Throwable, but we are shutting down, so ignoring this\r\njava.lang.OutOfMemoryError: GC overhead limit exceeded\r\n```\r\n\r\nYou can see from the log the data size is quite small, `Input size for job job_1672909107121_0001 = 115735. Number of splits = 1`, following are some other information    which may be relevant:\r\n\r\n 1. Hadoop 2.8.5 based on yarn, total 4 x m5a.xlarge(4 Core 16G memory, 100G SSD GP3) , 3 were used as yarn node (12G Mem and 4 vCore)\r\n 2. yarn.app.mapreduce.am.resource.mb = 6144\r\n 3. yarn.app.mapreduce.am.command-opts = -Xmx4915m\r\n 4. mapreduce.map.memory.mb = 3072\r\n 5. mapreduce.reduce.memory.mb = 6144\r\n\r\n\r\n","title":"Hadoop mapreduce application failed due to OutOfMemoryError","body":"<p>I'm using Apache Druid to ingest data(type: index_hadoop), but the index task failed, there's no useful infomation in index log. Then I find the MR application(application name: OELandingType-determine_partitions_hashed-Optional.of([2022-12-25T00:00:00.000Z/20222-12-26T00:00:00.000Z], OELandingType is my druid datasource name)) was failed, the error in yarn log says:</p>\n<pre><code>2023-01-05 17:04:55,291 INFO [main] org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl: Adding job token for job_1672909107121_0001 to jobTokenSecretManager\n2023-01-05 17:04:55,349 INFO [main] org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl: Not uberizing job_1672909107121_0001 because: too many reduces;\n2023-01-05 17:04:55,397 INFO [main] org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl: Input size for job job_1672909107121_0001 = 115735. Number of splits = 1\n2023-01-05 17:08:51,299 FATAL [main] org.apache.hadoop.mapreduce.v2.app.MRAppMaster: Error starting MRAppMaster\njava.lang.OutOfMemoryError: GC overhead limit exceeded\n    at java.util.concurrent.locks.ReentrantReadWriteLock.&lt;init&gt;(ReentrantReadWriteLock.java:240)\n    at java.util.concurrent.locks.ReentrantReadWriteLock.&lt;init&gt;(ReentrantReadWriteLock.java:230)\n    at org.apache.hadoop.mapreduce.v2.app.job.impl.TaskImpl.&lt;init&gt;(TaskImpl.java:304)\n    at org.apache.hadoop.mapreduce.v2.app.job.impl.ReduceTaskImpl.&lt;init&gt;(ReduceTaskImpl.java:47)\n    at org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl$InitTransition.createReduceTasks(JobImpl.java:1569)\n    at org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl$InitTransition.transition(JobImpl.java:1494)\n    at org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl$InitTransition.transition(JobImpl.java:1414)\n    at org.apache.hadoop.yarn.state.StateMachineFactory$MultipleInternalArc.doTransition(StateMachineFactory.java:385)\n    at org.apache.hadoop.yarn.state.StateMachineFactory.doTransition(StateMachineFactory.java:302)\n    at org.apache.hadoop.yarn.state.StateMachineFactory.access$300(StateMachineFactory.java:46)\n    at org.apache.hadoop.yarn.state.StateMachineFactory$InternalStateMachine.doTransition(StateMachineFactory.java:448)\n    at org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl.handle(JobImpl.java:1008)\n    at org.apache.hadoop.mapreduce.v2.app.job.impl.JobImpl.handle(JobImpl.java:139)\n    at org.apache.hadoop.mapreduce.v2.app.MRAppMaster$JobEventDispatcher.handle(MRAppMaster.java:1436)\n    at org.apache.hadoop.mapreduce.v2.app.MRAppMaster.serviceStart(MRAppMaster.java:1207)\n    at org.apache.hadoop.service.AbstractService.start(AbstractService.java:193)\n    at org.apache.hadoop.mapreduce.v2.app.MRAppMaster$5.run(MRAppMaster.java:1654)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at javax.security.auth.Subject.doAs(Subject.java:422)\n    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1844)\n    at org.apache.hadoop.mapreduce.v2.app.MRAppMaster.initAndStartAppMaster(MRAppMaster.java:1650)\n    at org.apache.hadoop.mapreduce.v2.app.MRAppMaster.main(MRAppMaster.java:1583)\n2023-01-05 17:09:05,108 INFO [main] org.apache.hadoop.util.ExitUtil: Exiting with status 1\n2023-01-05 17:09:45,419 ERROR [Thread-0] org.apache.hadoop.yarn.YarnUncaughtExceptionHandler: Thread Thread[Thread-0,5,main] threw an Throwable, but we are shutting down, so ignoring this\njava.lang.OutOfMemoryError: GC overhead limit exceeded\n</code></pre>\n<p>You can see from the log the data size is quite small, <code>Input size for job job_1672909107121_0001 = 115735. Number of splits = 1</code>, following are some other information    which may be relevant:</p>\n<ol>\n<li>Hadoop 2.8.5 based on yarn, total 4 x m5a.xlarge(4 Core 16G memory, 100G SSD GP3) , 3 were used as yarn node (12G Mem and 4 vCore)</li>\n<li>yarn.app.mapreduce.am.resource.mb = 6144</li>\n<li>yarn.app.mapreduce.am.command-opts = -Xmx4915m</li>\n<li>mapreduce.map.memory.mb = 3072</li>\n<li>mapreduce.reduce.memory.mb = 6144</li>\n</ol>\n"},{"tags":["java","android","flutter"],"answers":[{"comments":[{"owner":{"account_id":19912683,"reputation":346,"user_id":14590393,"display_name":"Shehan DMG"},"score":0,"creation_date":1672823390,"post_id":75002722,"comment_id":132357767,"body_markdown":"I added them in manifest file.","body":"I added them in manifest file."},{"owner":{"account_id":13611822,"reputation":1267,"user_id":9819071,"display_name":"Rahul Variya"},"score":0,"creation_date":1672824546,"post_id":75002722,"comment_id":132358111,"body_markdown":"Now any challenges? @ShehanDMG","body":"Now any challenges? @ShehanDMG"},{"owner":{"account_id":19912683,"reputation":346,"user_id":14590393,"display_name":"Shehan DMG"},"score":0,"creation_date":1672827497,"post_id":75002722,"comment_id":132359044,"body_markdown":"I already had them in the code. Nothing wrong with that.","body":"I already had them in the code. Nothing wrong with that."},{"owner":{"account_id":13611822,"reputation":1267,"user_id":9819071,"display_name":"Rahul Variya"},"score":0,"creation_date":1672831871,"post_id":75002722,"comment_id":132360346,"body_markdown":"I think there is another issue, can you please tell me your device version? so I can run and tell you about the more detail? if you don&#39;t mind","body":"I think there is another issue, can you please tell me your device version? so I can run and tell you about the more detail? if you don&#39;t mind"},{"owner":{"account_id":19912683,"reputation":346,"user_id":14590393,"display_name":"Shehan DMG"},"score":0,"creation_date":1672845714,"post_id":75002722,"comment_id":132365290,"body_markdown":"emulator - pixel 4 api 24","body":"emulator - pixel 4 api 24"},{"owner":{"account_id":19912683,"reputation":346,"user_id":14590393,"display_name":"Shehan DMG"},"score":0,"creation_date":1672851684,"post_id":75002722,"comment_id":132367596,"body_markdown":"not sure why it worked when I cold booted the emulator.","body":"not sure why it worked when I cold booted the emulator."}],"tags":[],"owner":{"account_id":13611822,"reputation":1267,"user_id":9819071,"display_name":"Rahul Variya"},"comment_count":6,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672820707,"creation_date":1672820707,"answer_id":75002722,"question_id":75002570,"body_markdown":"you have to put the required file in `AndroidMenifest.xml`\r\nlocation project -&gt; android-&gt;app-&gt;src-&gt;main-&gt;\r\n\r\n    &lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n        package=&quot;com.example.tmdp_getx_mvc&quot;&gt;\r\n    \r\n        &lt;uses-permission android:name=&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;/&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.WAKE_LOCK&quot;/&gt;\r\n    &lt;!-- For apps with targetSDK=31 (Android 12) --&gt;\r\n        &lt;uses-permission android:name=&quot;android.permission.SCHEDULE_EXACT_ALARM&quot;/&gt;\r\n       &lt;application\r\n            android:label=&quot;tmdp_getx_mvc&quot;\r\n            android:name=&quot;${applicationName}&quot;\r\n            android:icon=&quot;@mipmap/ic_launcher&quot;&gt;\r\n            &lt;activity\r\n                android:name=&quot;.MainActivity&quot;\r\n                android:exported=&quot;true&quot;\r\n                android:launchMode=&quot;singleTop&quot;\r\n                android:theme=&quot;@style/LaunchTheme&quot;\r\n                android:configChanges=&quot;orientation|keyboardHidden|keyboard|screenSize|smallestScreenSize|locale|layoutDirection|fontScale|screenLayout|density|uiMode&quot;\r\n                android:hardwareAccelerated=&quot;true&quot;\r\n                android:windowSoftInputMode=&quot;adjustResize&quot;&gt;\r\n                &lt;!-- Specifies an Android theme to apply to this Activity as soon as\r\n                     the Android process has started. This theme is visible to the user\r\n                     while the Flutter UI initializes. After that, this theme continues\r\n                     to determine the Window background behind the Flutter UI. --&gt;\r\n                &lt;meta-data\r\n                  android:name=&quot;io.flutter.embedding.android.NormalTheme&quot;\r\n                  android:resource=&quot;@style/NormalTheme&quot;\r\n                  /&gt;\r\n                  \r\n                &lt;intent-filter&gt;\r\n                    &lt;action android:name=&quot;android.intent.action.MAIN&quot;/&gt;\r\n                    &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot;/&gt;\r\n                &lt;/intent-filter&gt;\r\n            &lt;/activity&gt;\r\n            &lt;service\r\n                android:name=&quot;dev.fluttercommunity.plus.androidalarmmanager.AlarmService&quot;\r\n                android:permission=&quot;android.permission.BIND_JOB_SERVICE&quot;\r\n                android:exported=&quot;false&quot;/&gt;\r\n            &lt;receiver\r\n                android:name=&quot;dev.fluttercommunity.plus.androidalarmmanager.AlarmBroadcastReceiver&quot;\r\n                android:exported=&quot;false&quot;/&gt;\r\n            &lt;receiver\r\n                android:name=&quot;dev.fluttercommunity.plus.androidalarmmanager.RebootBroadcastReceiver&quot;\r\n                android:enabled=&quot;false&quot;\r\n                android:exported=&quot;false&quot;&gt;\r\n                &lt;intent-filter&gt;\r\n                    &lt;action android:name=&quot;android.intent.action.BOOT_COMPLETED&quot; /&gt;\r\n                &lt;/intent-filter&gt;\r\n            &lt;/receiver&gt;\r\n            &lt;!-- Don&#39;t delete the meta-data below.\r\n                 This is used by the Flutter tool to generate GeneratedPluginRegistrant.java --&gt;\r\n            &lt;meta-data\r\n                android:name=&quot;flutterEmbedding&quot;\r\n                android:value=&quot;2&quot; /&gt;\r\n        &lt;/application&gt;\r\n    &lt;/manifest&gt;\r\nFor more detail refer: https://pub.dev/packages/android_alarm_manager_plus\r\nAfter update manifest file once uninstall and install app from device","title":"flutter android alarm manager plus plugin throws error when calling initializer function?","body":"<p>you have to put the required file in <code>AndroidMenifest.xml</code>\nlocation project -&gt; android-&gt;app-&gt;src-&gt;main-&gt;</p>\n<pre><code>&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    package=&quot;com.example.tmdp_getx_mvc&quot;&gt;\n\n    &lt;uses-permission android:name=&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;/&gt;\n    &lt;uses-permission android:name=&quot;android.permission.WAKE_LOCK&quot;/&gt;\n&lt;!-- For apps with targetSDK=31 (Android 12) --&gt;\n    &lt;uses-permission android:name=&quot;android.permission.SCHEDULE_EXACT_ALARM&quot;/&gt;\n   &lt;application\n        android:label=&quot;tmdp_getx_mvc&quot;\n        android:name=&quot;${applicationName}&quot;\n        android:icon=&quot;@mipmap/ic_launcher&quot;&gt;\n        &lt;activity\n            android:name=&quot;.MainActivity&quot;\n            android:exported=&quot;true&quot;\n            android:launchMode=&quot;singleTop&quot;\n            android:theme=&quot;@style/LaunchTheme&quot;\n            android:configChanges=&quot;orientation|keyboardHidden|keyboard|screenSize|smallestScreenSize|locale|layoutDirection|fontScale|screenLayout|density|uiMode&quot;\n            android:hardwareAccelerated=&quot;true&quot;\n            android:windowSoftInputMode=&quot;adjustResize&quot;&gt;\n            &lt;!-- Specifies an Android theme to apply to this Activity as soon as\n                 the Android process has started. This theme is visible to the user\n                 while the Flutter UI initializes. After that, this theme continues\n                 to determine the Window background behind the Flutter UI. --&gt;\n            &lt;meta-data\n              android:name=&quot;io.flutter.embedding.android.NormalTheme&quot;\n              android:resource=&quot;@style/NormalTheme&quot;\n              /&gt;\n              \n            &lt;intent-filter&gt;\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot;/&gt;\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot;/&gt;\n            &lt;/intent-filter&gt;\n        &lt;/activity&gt;\n        &lt;service\n            android:name=&quot;dev.fluttercommunity.plus.androidalarmmanager.AlarmService&quot;\n            android:permission=&quot;android.permission.BIND_JOB_SERVICE&quot;\n            android:exported=&quot;false&quot;/&gt;\n        &lt;receiver\n            android:name=&quot;dev.fluttercommunity.plus.androidalarmmanager.AlarmBroadcastReceiver&quot;\n            android:exported=&quot;false&quot;/&gt;\n        &lt;receiver\n            android:name=&quot;dev.fluttercommunity.plus.androidalarmmanager.RebootBroadcastReceiver&quot;\n            android:enabled=&quot;false&quot;\n            android:exported=&quot;false&quot;&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=&quot;android.intent.action.BOOT_COMPLETED&quot; /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/receiver&gt;\n        &lt;!-- Don't delete the meta-data below.\n             This is used by the Flutter tool to generate GeneratedPluginRegistrant.java --&gt;\n        &lt;meta-data\n            android:name=&quot;flutterEmbedding&quot;\n            android:value=&quot;2&quot; /&gt;\n    &lt;/application&gt;\n&lt;/manifest&gt;\n</code></pre>\n<p>For more detail refer: <a href=\"https://pub.dev/packages/android_alarm_manager_plus\" rel=\"nofollow noreferrer\">https://pub.dev/packages/android_alarm_manager_plus</a>\nAfter update manifest file once uninstall and install app from device</p>\n"},{"tags":[],"owner":{"account_id":19912683,"reputation":346,"user_id":14590393,"display_name":"Shehan DMG"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672911161,"creation_date":1672911161,"answer_id":75016340,"question_id":75002570,"body_markdown":"It worked without changing anything after I cold booted the emulator.","title":"flutter android alarm manager plus plugin throws error when calling initializer function?","body":"<p>It worked without changing anything after I cold booted the emulator.</p>\n"}],"owner":{"account_id":19912683,"reputation":346,"user_id":14590393,"display_name":"Shehan DMG"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":122,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1672911161,"creation_date":1672819887,"question_id":75002570,"body_markdown":"I&#39;m trying to use android alarm manager plus in my flutter app to schedule some local notifications. I started with simple AndroidAlarmManager.oneShot(..) function. And I&quot;m calling intialize function in main method.\r\n\r\n```\r\nvoid main() async{\r\n  WidgetsFlutterBinding.ensureInitialized();\r\n  await AndroidAlarmManager.initialize();\r\n  runApp(const MyApp());\r\n}\r\n\r\n```\r\n\r\nthat ```await AndroidAlarmManager.initialize();``` cause the error. Error is\r\n```\r\nE/flutter (10486): [ERROR:flutter/lib/ui/ui_dart_state.cc(198)] Unhandled Exception: MissingPluginException(No implementation found for method AlarmService.start on channel dev.fluttercommunity.plus/android_alarm_manager)\r\n```\r\n\r\nSo I&#39;m as I read some other issues, the problem is with pluginregistrar is not registering AlarmService. So I have to add a native code to Application file. But my project doesn&#39;t have Application.java file. \r\nAll I have is \r\n\r\n1.flutter_project_root\\android\\app\\src\\main\\java\\io\\flutter\\plugins\\GeneratedPluginRegistrant.java\r\n\r\n```\r\n@Keep\r\npublic final class GeneratedPluginRegistrant {\r\n  private static final String TAG = &quot;GeneratedPluginRegistrant&quot;;\r\n  public static void registerWith(@NonNull FlutterEngine flutterEngine) {\r\n    try {\r\n      flutterEngine.getPlugins().add(new dev.fluttercommunity.plus.androidalarmmanager.AndroidAlarmManagerPlugin());\r\n    } catch(Exception e) {\r\n      Log.e(TAG, &quot;Error registering plugin android_alarm_manager_plus, dev.fluttercommunity.plus.androidalarmmanager.AndroidAlarmManagerPlugin&quot;, e);\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n2.flutter_root\\android\\app\\src\\main\\kotlin\\com\\example\\snooze_test\\MainActivity.kt\r\n```\r\nimport io.flutter.embedding.android.FlutterActivity\r\n\r\nclass MainActivity: FlutterActivity() {\r\n}\r\n```\r\n\r\nI don&#39;t know native code. How should fix this?","title":"flutter android alarm manager plus plugin throws error when calling initializer function?","body":"<p>I'm trying to use android alarm manager plus in my flutter app to schedule some local notifications. I started with simple AndroidAlarmManager.oneShot(..) function. And I&quot;m calling intialize function in main method.</p>\n<pre><code>void main() async{\n  WidgetsFlutterBinding.ensureInitialized();\n  await AndroidAlarmManager.initialize();\n  runApp(const MyApp());\n}\n\n</code></pre>\n<p>that <code>await AndroidAlarmManager.initialize();</code> cause the error. Error is</p>\n<pre><code>E/flutter (10486): [ERROR:flutter/lib/ui/ui_dart_state.cc(198)] Unhandled Exception: MissingPluginException(No implementation found for method AlarmService.start on channel dev.fluttercommunity.plus/android_alarm_manager)\n</code></pre>\n<p>So I'm as I read some other issues, the problem is with pluginregistrar is not registering AlarmService. So I have to add a native code to Application file. But my project doesn't have Application.java file.\nAll I have is</p>\n<p>1.flutter_project_root\\android\\app\\src\\main\\java\\io\\flutter\\plugins\\GeneratedPluginRegistrant.java</p>\n<pre><code>@Keep\npublic final class GeneratedPluginRegistrant {\n  private static final String TAG = &quot;GeneratedPluginRegistrant&quot;;\n  public static void registerWith(@NonNull FlutterEngine flutterEngine) {\n    try {\n      flutterEngine.getPlugins().add(new dev.fluttercommunity.plus.androidalarmmanager.AndroidAlarmManagerPlugin());\n    } catch(Exception e) {\n      Log.e(TAG, &quot;Error registering plugin android_alarm_manager_plus, dev.fluttercommunity.plus.androidalarmmanager.AndroidAlarmManagerPlugin&quot;, e);\n    }\n  }\n}\n</code></pre>\n<p>2.flutter_root\\android\\app\\src\\main\\kotlin\\com\\example\\snooze_test\\MainActivity.kt</p>\n<pre><code>import io.flutter.embedding.android.FlutterActivity\n\nclass MainActivity: FlutterActivity() {\n}\n</code></pre>\n<p>I don't know native code. How should fix this?</p>\n"},{"tags":["java","apache-spark","group-by","rdd"],"answers":[{"tags":[],"owner":{"account_id":12182705,"reputation":10096,"user_id":8893686,"display_name":"Oli"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672911127,"creation_date":1672910822,"answer_id":75016259,"question_id":75015749,"body_markdown":"You could transform the `Iterable` into a `List` and then sort that list like below. I assume that your sorting field is called `x` and that it is of type String but you can obviously adapt that to your specific case.\r\n```java\r\nString sortingField = &quot;x&quot;\r\nJavaPairRDD&lt;String, List&lt;Row&gt;&gt; rdd = mydataset\r\n    .javaRDD()\r\n    .mapToPair(row -&gt; new Tuple2&lt;&gt;(row.getAs(&quot;id&quot;).toString(), row))\r\n    .groupByKey()\r\n    .mapValues(it -&gt; {\r\n        List&lt;Row&gt; rows = new ArrayList&lt;&gt;();\r\n        it.forEach(rows::add);\r\n        rows.sort(\r\n            (Row a, Row b) -&gt; a.&lt;String&gt;getAs(sortingField).compareTo(b.&lt;String&gt;getAs(sortingField))\r\n        );\r\n        return rows;\r\n    });\r\n```\r\n\r\nNote that this is much simpler to write in scala:\r\n```scala\r\nval rdd = mydataset\r\n    .rdd\r\n    .map(row =&gt; (row.getAs(&quot;id&quot;).toString, row))\r\n    .groupByKey\r\n    .mapValues( _.toSeq.sortBy(_.getAs[String](&quot;x&quot;)))\r\n```","title":"Sorting an rdd after using groupbykey using values","body":"<p>You could transform the <code>Iterable</code> into a <code>List</code> and then sort that list like below. I assume that your sorting field is called <code>x</code> and that it is of type String but you can obviously adapt that to your specific case.</p>\n<pre class=\"lang-java prettyprint-override\"><code>String sortingField = &quot;x&quot;\nJavaPairRDD&lt;String, List&lt;Row&gt;&gt; rdd = mydataset\n    .javaRDD()\n    .mapToPair(row -&gt; new Tuple2&lt;&gt;(row.getAs(&quot;id&quot;).toString(), row))\n    .groupByKey()\n    .mapValues(it -&gt; {\n        List&lt;Row&gt; rows = new ArrayList&lt;&gt;();\n        it.forEach(rows::add);\n        rows.sort(\n            (Row a, Row b) -&gt; a.&lt;String&gt;getAs(sortingField).compareTo(b.&lt;String&gt;getAs(sortingField))\n        );\n        return rows;\n    });\n</code></pre>\n<p>Note that this is much simpler to write in scala:</p>\n<pre class=\"lang-scala prettyprint-override\"><code>val rdd = mydataset\n    .rdd\n    .map(row =&gt; (row.getAs(&quot;id&quot;).toString, row))\n    .groupByKey\n    .mapValues( _.toSeq.sortBy(_.getAs[String](&quot;x&quot;)))\n</code></pre>\n"}],"owner":{"account_id":19902607,"reputation":133,"user_id":14582309,"display_name":"Luff li"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":58,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75016259,"answer_count":1,"score":0,"last_activity_date":1672911127,"creation_date":1672908036,"question_id":75015749,"body_markdown":"I have `JavaPairRDD` as\r\n\r\n```\r\nJavaPairRDD&lt;String, Iterable&lt;Row&gt;&gt; rdd = mydataset.orderBy(&quot;orderfield1&quot;, &quot;orderfield2&quot;).javaRDD().mapToPair(row -&gt; new Tuple2&lt;&gt;(row.getAs(&quot;id&quot;).toString(), row)).groupByKey()\r\n```\r\n\r\nAs `groupbykey()` doesn&#39;t maintain order `orderby` doesn&#39;t work here.\r\nI want to order the `Iterable&lt;Row&gt;` using some of the fields from dataset.","title":"Sorting an rdd after using groupbykey using values","body":"<p>I have <code>JavaPairRDD</code> as</p>\n<pre><code>JavaPairRDD&lt;String, Iterable&lt;Row&gt;&gt; rdd = mydataset.orderBy(&quot;orderfield1&quot;, &quot;orderfield2&quot;).javaRDD().mapToPair(row -&gt; new Tuple2&lt;&gt;(row.getAs(&quot;id&quot;).toString(), row)).groupByKey()\n</code></pre>\n<p>As <code>groupbykey()</code> doesn't maintain order <code>orderby</code> doesn't work here.\nI want to order the <code>Iterable&lt;Row&gt;</code> using some of the fields from dataset.</p>\n"},{"tags":["java","timezone","containers","tomcat9","java-opts"],"answers":[{"comments":[{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":0,"creation_date":1672884797,"post_id":75012316,"comment_id":132375877,"body_markdown":"Amazing detective work here, well done.","body":"Amazing detective work here, well done."},{"owner":{"account_id":14565699,"reputation":21,"user_id":16065879,"display_name":"Alan Aguinaga"},"score":0,"creation_date":1672951520,"post_id":75012316,"comment_id":132394958,"body_markdown":"You solved the problem. Thank you so much!","body":"You solved the problem. Thank you so much!"}],"tags":[],"owner":{"account_id":3524496,"reputation":168,"user_id":2945996,"display_name":"rimesc"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1672885188,"creation_date":1672873783,"answer_id":75012316,"question_id":75012145,"body_markdown":"# Rule change in Brazil time zone\r\n\r\nYour problem seems to be that Java is reporting the same time, but in daylight saving time (I believe BRST=Brasilia Summer Time, which is UTC-2).\r\n\r\nAccording to Wikipedia, [Brazil stopped using daylight saving time][1] in 2019. According to [this page][2] the change was included in Java 1.8.0_231, while you‚Äôre on Java 1.8.0_202.\r\n\r\nUpdating to Java 1.8.0_231 or later, if you can, ought to fix the inconsistency.\r\n\r\n\r\n  [1]: https://en.wikipedia.org/wiki/Daylight_saving_time_in_Brazil\r\n  [2]: https://www.oracle.com/java/technologies/tzdata-versions.html","title":"My container has a correct date and timezone. But my tomcat is getting one hour more than I configured. How to fix wrong time in tomcat 9 container?","body":"<h1>Rule change in Brazil time zone</h1>\n<p>Your problem seems to be that Java is reporting the same time, but in daylight saving time (I believe BRST=Brasilia Summer Time, which is UTC-2).</p>\n<p>According to Wikipedia, <a href=\"https://en.wikipedia.org/wiki/Daylight_saving_time_in_Brazil\" rel=\"nofollow noreferrer\">Brazil stopped using daylight saving time</a> in 2019. According to <a href=\"https://www.oracle.com/java/technologies/tzdata-versions.html\" rel=\"nofollow noreferrer\">this page</a> the change was included in Java 1.8.0_231, while you‚Äôre on Java 1.8.0_202.</p>\n<p>Updating to Java 1.8.0_231 or later, if you can, ought to fix the inconsistency.</p>\n"},{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":1,"creation_date":1672932857,"post_id":75016304,"comment_id":132388693,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/75016304/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."},{"owner":{"account_id":14565699,"reputation":21,"user_id":16065879,"display_name":"Alan Aguinaga"},"score":0,"creation_date":1672951769,"post_id":75016304,"comment_id":132395033,"body_markdown":"thank you but I got the problem. If you look at this Dockerfile my partner copied an tomcat tar file to conteiner but I was adjusting a uncompressed setenv.sh outside. That&#39;s why it was getting nothing from modified setenv.sh. I fixed it adding an uncompressed directory that now I was doing my modifications.","body":"thank you but I got the problem. If you look at this Dockerfile my partner copied an tomcat tar file to conteiner but I was adjusting a uncompressed setenv.sh outside. That&#39;s why it was getting nothing from modified setenv.sh. I fixed it adding an uncompressed directory that now I was doing my modifications."}],"tags":[],"owner":{"account_id":27435883,"reputation":1,"user_id":20931738,"display_name":"Nour Mohamed"},"comment_count":2,"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1672911049,"creation_date":1672911049,"answer_id":75016304,"question_id":75012145,"body_markdown":"    FROM openjdk:11-jre-slim\r\n    MAINTAINER Me\r\n    \r\n    USER root\r\n    \r\n    RUN rm -rf ${JAVA_HOME}/*src.zip\r\n    \r\n    ENV JAVA_PKG=jdk-8u202-linux-x64.tar.gz\r\n    ENV CATALINA_PKG=apache-tomcat-9.0.55.tar.gz\r\n    \r\n    ENV JAVA_HOME=/opt/jdk1.8.0_202\r\n    ENV CATALINA_HOME=/opt/apache-tomcat-9.0.55\r\n    \r\n    # Set the timezone and locale\r\n    RUN apt-get update &amp;&amp; DEBIAN_FRONTEND=noninteractive apt-get install -y locales\r\n    RUN sed -i -e &#39;s/# pt_BR.UTF-8 UTF-8/pt_BR.UTF-8 UTF-8/&#39; /etc/locale.gen &amp;&amp; \\\r\n        dpkg-reconfigure --frontend=noninteractive locales &amp;&amp; \\\r\n        update-locale LANG=pt_BR.UTF-8\r\n    ENV LANG pt_BR.UTF-8\r\n    ENV TZ=America/Sao_Paulo\r\n    RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo $TZ &gt; /etc/timezone\r\n    ENV LANGUAGE pt_BR.UTF-8\r\n    ENV LC_ALL pt_BR.UTF-8\r\n    \r\n    # Install JDK and Tomcat\r\n    COPY ./java/${JAVA_PKG} /opt/\r\n    RUN tar -xzvf /opt/${JAVA_PKG} --directory=/opt/\r\n    RUN rm /opt/${JAVA_PKG}\r\n    COPY ./tomcat/${CATALINA_PKG} /opt/\r\n    RUN tar -xzvf /opt/${CATALINA_PKG} --directory=/opt/\r\n    RUN rm /opt/${CATALINA_PKG}\r\n    ENV PATH=&quot;$JAVA_HOME/bin:${PATH}&quot;\r\n    ENV PATH=&quot;$CATALINA_HOME/bin:${PATH}&quot;\r\n    \r\n    # Create a group and user\r\n    RUN groupadd tomcat_grp &amp;&amp; useradd -r -u 1002 tomcat -g tomcat_grp\r\n    \r\n    # Copy libs and set permissions\r\n    COPY ./lib/* ${CATALINA_HOME}/lib/\r\n    RUN chown -R tomcat:tomcat_grp ${CATALINA_HOME}\r\n    \r\n     - \r\n    \r\n    To set environment variables in a Docker container, you can use the ENV instruction in your Dockerfile, like you have done. You can also set environment variables when you start the container using the -e flag with docker run.\r\n    \r\n    For example: docker run -e JAVA_OPTS=&quot;-Duser.timezone=UTC&quot; my_image\r\n    \r\n    To load\r\n    \r\n    The environment use source command the docker file for example COPY setenv.sh /usr/local/tomcat/bin/setenv.sh RUN chmod +x /usr/local/tomcat/bin/setenv.sh\r\n    \r\n    CMD [&quot;catalina.sh&quot;, &quot;run&quot;] ENTRYPOINT [&quot;/bin/bash&quot;, &quot;-c&quot;, &quot;source /usr/local/tomcat/bin/setenv.sh &amp;&amp; exec /usr/local/tomcat/bin/catalina.sh run&quot;] . $CATALINA_HOME/bin/setenv.sh\r\n    \r\n    environment: JAVA_OPTS: &quot;-javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml -Duser.timezone=America/Sao_Paulo&quot; CATALINA_OPTS: &quot;-Djava.rmi.server.hostname=$HOST_IP&quot;\r\n    \r\n    JAVA_OPTS=-javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml -Duser.timezone=America/Sao_Paulo CATALINA_OPTS=-Djava.rmi.server.hostname=$HOST_IP\r\n    \r\n    environment: JAVA_OPTS: ${JAVA_OPTS} CATALINA_OPTS: ${CATALINA_OPTS}\r\n    \r\n    env_file:\r\n    \r\n    ./env_file.env\r\n    environment: JAVA_OPTS: &quot;-javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml -Duser.timezone=America/Sao_Paulo&quot; CATALINA_OPTS: &quot;-Djava.rmi.server.hostname=$HOST_IP&quot; JAVA_OPTS=-javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml -Duser.timezone=America/Sao_Paulo CATALINA_OPTS=-Djava.rmi.server.hostname=$HOST_IP\r\n    \r\n    environment: JAVA_OPTS: ${JAVA_OPTS} CATALINA_OPTS: ${CATALINA_OPTS}\r\n    \r\n    env_file:\r\n    \r\n    ./env_file.env\r\n    ----------\r\n\r\n","title":"My container has a correct date and timezone. But my tomcat is getting one hour more than I configured. How to fix wrong time in tomcat 9 container?","body":"<pre><code>FROM openjdk:11-jre-slim\nMAINTAINER Me\n\nUSER root\n\nRUN rm -rf ${JAVA_HOME}/*src.zip\n\nENV JAVA_PKG=jdk-8u202-linux-x64.tar.gz\nENV CATALINA_PKG=apache-tomcat-9.0.55.tar.gz\n\nENV JAVA_HOME=/opt/jdk1.8.0_202\nENV CATALINA_HOME=/opt/apache-tomcat-9.0.55\n\n# Set the timezone and locale\nRUN apt-get update &amp;&amp; DEBIAN_FRONTEND=noninteractive apt-get install -y locales\nRUN sed -i -e 's/# pt_BR.UTF-8 UTF-8/pt_BR.UTF-8 UTF-8/' /etc/locale.gen &amp;&amp; \\\n    dpkg-reconfigure --frontend=noninteractive locales &amp;&amp; \\\n    update-locale LANG=pt_BR.UTF-8\nENV LANG pt_BR.UTF-8\nENV TZ=America/Sao_Paulo\nRUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo $TZ &gt; /etc/timezone\nENV LANGUAGE pt_BR.UTF-8\nENV LC_ALL pt_BR.UTF-8\n\n# Install JDK and Tomcat\nCOPY ./java/${JAVA_PKG} /opt/\nRUN tar -xzvf /opt/${JAVA_PKG} --directory=/opt/\nRUN rm /opt/${JAVA_PKG}\nCOPY ./tomcat/${CATALINA_PKG} /opt/\nRUN tar -xzvf /opt/${CATALINA_PKG} --directory=/opt/\nRUN rm /opt/${CATALINA_PKG}\nENV PATH=&quot;$JAVA_HOME/bin:${PATH}&quot;\nENV PATH=&quot;$CATALINA_HOME/bin:${PATH}&quot;\n\n# Create a group and user\nRUN groupadd tomcat_grp &amp;&amp; useradd -r -u 1002 tomcat -g tomcat_grp\n\n# Copy libs and set permissions\nCOPY ./lib/* ${CATALINA_HOME}/lib/\nRUN chown -R tomcat:tomcat_grp ${CATALINA_HOME}\n\n - \n\nTo set environment variables in a Docker container, you can use the ENV instruction in your Dockerfile, like you have done. You can also set environment variables when you start the container using the -e flag with docker run.\n\nFor example: docker run -e JAVA_OPTS=&quot;-Duser.timezone=UTC&quot; my_image\n\nTo load\n\nThe environment use source command the docker file for example COPY setenv.sh /usr/local/tomcat/bin/setenv.sh RUN chmod +x /usr/local/tomcat/bin/setenv.sh\n\nCMD [&quot;catalina.sh&quot;, &quot;run&quot;] ENTRYPOINT [&quot;/bin/bash&quot;, &quot;-c&quot;, &quot;source /usr/local/tomcat/bin/setenv.sh &amp;&amp; exec /usr/local/tomcat/bin/catalina.sh run&quot;] . $CATALINA_HOME/bin/setenv.sh\n\nenvironment: JAVA_OPTS: &quot;-javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml -Duser.timezone=America/Sao_Paulo&quot; CATALINA_OPTS: &quot;-Djava.rmi.server.hostname=$HOST_IP&quot;\n\nJAVA_OPTS=-javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml -Duser.timezone=America/Sao_Paulo CATALINA_OPTS=-Djava.rmi.server.hostname=$HOST_IP\n\nenvironment: JAVA_OPTS: ${JAVA_OPTS} CATALINA_OPTS: ${CATALINA_OPTS}\n\nenv_file:\n\n./env_file.env\nenvironment: JAVA_OPTS: &quot;-javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml -Duser.timezone=America/Sao_Paulo&quot; CATALINA_OPTS: &quot;-Djava.rmi.server.hostname=$HOST_IP&quot; JAVA_OPTS=-javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml -Duser.timezone=America/Sao_Paulo CATALINA_OPTS=-Djava.rmi.server.hostname=$HOST_IP\n\nenvironment: JAVA_OPTS: ${JAVA_OPTS} CATALINA_OPTS: ${CATALINA_OPTS}\n\nenv_file:\n\n./env_file.env\n----------\n</code></pre>\n"}],"owner":{"account_id":14565699,"reputation":21,"user_id":16065879,"display_name":"Alan Aguinaga"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":462,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1672911049,"creation_date":1672872314,"question_id":75012145,"body_markdown":"I am trying to make it run setenv.sh to load some JAVA_OPTS but is it not loading nothing. My Tomcat start a .war files using springboot for start my application. \r\nThe problem here is that it is not loading correct timezone on java and it is not loading JMX and Prometheus exporters. \r\n\r\nHere is my docker file. \r\n\r\n```docker\r\nFROM openjdk:11-jre-slim\r\nMAINTAINER Me\r\n\r\nUSER root\r\n\r\nRUN rm -rf ${JAVA_HOME}/*src.zip\r\n\r\nENV JAVA_PKG=jdk-8u202-linux-x64.tar.gz\r\nENV CATALINA_PKG=apache-tomcat-9.0.55.tar.gz\r\n\r\nENV JAVA_HOME=/opt/jdk1.8.0_202\r\nENV CATALINA_HOME=/opt/apache-tomcat-9.0.55\r\n\r\nRUN apt-get update &amp;&amp; DEBIAN_FRONTEND=noninteractive apt-get install -y locales\r\nRUN sed -i -e &#39;s/# pt_BR.UTF-8 UTF-8/pt_BR.UTF-8 UTF-8/&#39; /etc/locale.gen &amp;&amp; \\\r\n    dpkg-reconfigure --frontend=noninteractive locales &amp;&amp; \\\r\n    update-locale LANG=pt_BR.UTF-8\r\nENV LANG pt_BR.UTF-8 \r\n#RUN echo &quot;America/Sao_Paulo&quot; &gt;  /etc/timezone\r\nENV TZ=America/Sao_Paulo\r\nRUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo $TZ &gt; /etc/timezone\r\n\r\n#ENV TZ America/Sao_Paulo\r\nENV LANGUAGE pt_BR.UTF-8\r\nENV LC_ALL pt_BR.UTF-8\r\n\r\n\r\nCOPY ./java/${JAVA_PKG} /opt/\r\nRUN tar -xzvf /opt/${JAVA_PKG} --directory=/opt/\r\nRUN rm /opt/${JAVA_PKG}\r\n\r\nCOPY ./tomcat/${CATALINA_PKG} /opt/\r\nRUN tar -xzvf /opt/${CATALINA_PKG} --directory=/opt/\r\nRUN rm /opt/${CATALINA_PKG}\r\n\r\nENV PATH=&quot;$JAVA_HOME/bin:${PATH}&quot;\r\nENV PATH=&quot;$CATALINA_HOME/bin:${PATH}&quot;\r\n\r\n# Create a group and user\r\n#RUN addgroup -S tomcat_grp &amp;&amp; adduser -S tomcat -G tomcat_grp - criar UID 1002 para facilitar as permiss&#245;es de escrita no host\r\nRUN groupadd tomcat_grp &amp;&amp; useradd -r -u 1002 tomcat -g tomcat_grp\r\n\r\nCOPY ./lib/* ${CATALINA_HOME}/lib/\r\n\r\nRUN chown -R tomcat:tomcat_grp ${CATALINA_HOME}\r\nRUN chmod -R 777 ${CATALINA_HOME}\r\n\r\nRUN chown -R tomcat:tomcat_grp ${JAVA_HOME}\r\nRUN chmod -R 777 ${JAVA_HOME}\r\n\r\nUSER tomcat\r\n\r\nEXPOSE 8080\r\n\r\nUSER root\r\n\r\n#prometheus jmx exporter\r\nRUN mkdir -p /opt/jmx_exporter\r\nCOPY ./tomcat/jmx_exporter/jmx_prometheus_javaagent-0.17.2.jar /opt/jmx_exporter\r\nCOPY ./tomcat/jmx_exporter/config.yaml /opt/jmx_exporter\r\n\r\n#clean image\r\n#CMD [&quot;sh&quot;, &quot;-c&quot;, &quot;apt update&quot;; &quot;apt install wget -y&quot;; &quot;apt-get clean ; apt-get autoclean ; apt-get autoremove&quot;]\r\nRUN apt update &amp;&amp; apt install wget -y; apt clean; apt autoclean; apt autoremove\r\n\r\n#start tomcat\r\nCOPY startup.sh /usr/local/\r\nCMD [&quot;sh&quot;, &quot;-c&quot;, &quot;chmod a+x /opt/apache-tomcat-9.0.55/bin/catalina.sh; chmod a+x /opt/apache-tomcat-9.0.55/bin/setenv.sh; /opt/apache-tomcat-9.0.55/bin/setenv.sh; chmod a+x /usr/local/startup.sh ; /usr/local/startup.sh&quot;]\r\n#RUN chmod a+x /usr/local/startup.sh ; /usr/local/startup.sh\r\n\r\n#CMD [&quot;sh&quot;, &quot;-c&quot;, &quot;chmod a+x ${CATALINA_HOME}/bin/*.sh; chmod a+x /usr/local/startup.sh ; ${CATALINA_HOME}/bin/startup.sh&quot;]\r\n\r\n#COPY startup.sh /usr/local/\r\n#CMD chmod a+x /usr/local/startup.sh \r\n# Launch Tomcat on startup\r\n#CMD /usr/local/startup.sh\r\n\r\n```\r\n\r\nThis is a one service of my compose stack:\r\n\r\n\r\n```yaml\r\n  tomcat2_ecops_reports_pabx:\r\n    build: *build\r\n    labels:\r\n      - reports_pabx  \r\n    logging: *default-logging\r\n    container_name: ecops_reports_pabx_${CLIENT_NAME}_${VER}_${IMAGE_TAG}\r\n    restart: unless-stopped\r\n#    command: *command    \r\n    volumes:\r\n      -  ${LOCALTIME}\r\n      -  ${PABXREPTS_PRD}:${POD_WEBAPPS}\r\n      -  ${REPORTS}:${POD_WEBAPPS}/reports\r\n      -  ${CONF_CTXT}/context_reports.xml:${CONF_CTXT}/context.xml\r\n#    environment:\r\n#      CATALINA_OPTS: &quot;-Djava.rmi.server.hostname=$HOST_IP&quot;\r\n#      JAVA_OPTS: &quot;-javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml \\\r\n#        -Duser.timezone=America/Sao_Paulo&quot; \r\n    ports:\r\n      - 9912:8088 \r\n      - 8192:8191\r\n      - 9402:9404      \r\n    networks: *networks\r\n\r\n```\r\n\r\n\r\n\r\nI got a correct time inside my container: \r\n\r\n```none\r\nroot@b2ad0fe2338b:/# date\r\nqua 04 jan 2023 19:31:53 -03\r\nroot@b2ad0fe2338b:/# \r\n```\r\n\r\nI got correct time in my host system: \r\n\r\n```none\r\n[root@VM-L-13104 projeto_psv]# date\r\nWed Jan  4 19:31:42 -03 2023\r\n```\r\n\r\nTime in probe: \r\n&gt;Current time:&#160;Wed Jan 04 20:31:35 BRST 2023\r\n\r\nThis is the springboot process: \r\n\r\n```none\r\nVM settings:\r\n    Max. Heap Size (Estimated): 2.52G\r\n    Ergonomics Machine Class: server\r\n    Using VM: Java HotSpot(TM) 64-Bit Server VM\r\n\r\n04-Jan-2023 19:33:49.331 SEVERE [main] org.apache.tomcat.vault.util.PropertySourceVault.init Keystore password should be either masked or prefixed with one of {EXT}, {EXTC}, {CMD}, {CMDC}\r\n\torg.apache.tomcat.vault.security.vault.SecurityVaultException: Keystore password should be either masked or prefixed with one of {EXT}, {EXTC}, {CMD}, {CMDC}\r\n\t\tat org.apache.tomcat.vault.security.vault.PicketBoxSecurityVault.init(PicketBoxSecurityVault.java:168)\r\n\t\tat org.apache.tomcat.vault.util.PropertySourceVault.init(PropertySourceVault.java:105)\r\n\t\tat org.apache.tomcat.vault.util.PropertySourceVault.&lt;init&gt;(PropertySourceVault.java:82)\r\n\t\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n\t\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n\t\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n\t\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n\t\tat org.apache.tomcat.util.digester.Digester.&lt;clinit&gt;(Digester.java:104)\r\n\t\tat org.apache.catalina.startup.Catalina.createStartDigester(Catalina.java:367)\r\n\t\tat org.apache.catalina.startup.Catalina.parseServerXml(Catalina.java:608)\r\n\t\tat org.apache.catalina.startup.Catalina.load(Catalina.java:709)\r\n\t\tat org.apache.catalina.startup.Catalina.load(Catalina.java:746)\r\n\t\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\t\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\t\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\t\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\t\tat org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:305)\r\n\t\tat org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:475)\r\n04-Jan-2023 19:33:49.679 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version name:   Apache Tomcat/9.0.55\r\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server built:          Nov 10 2021 08:26:45 UTC\r\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version number: 9.0.55.0\r\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Name:               Linux\r\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Version:            3.10.0-1160.80.1.0.1.el7.x86_64\r\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Architecture:          amd64\r\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Java Home:             /opt/jdk1.8.0_202/jre\r\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Version:           1.8.0_202-b08\r\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Vendor:            Oracle Corporation\r\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_BASE:         /opt/apache-tomcat-9.0.55\r\n04-Jan-2023 19:33:49.684 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_HOME:         /opt/apache-tomcat-9.0.55\r\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.util.logging.config.file=/opt/apache-tomcat-9.0.55/conf/logging.properties\r\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager\r\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dserver=tomcat\r\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djvm=tomcat\r\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dhttp.port=\r\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dajp.port=8119\r\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dssl.port=8443\r\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dshutdown.port=8115\r\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -XX:+UnlockExperimentalVMOptions\r\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -XX:+UseCGroupMemoryLimitForHeap\r\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -XX:MaxRAMFraction=2\r\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.awt.headless=true\r\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dfile.encoding=UTF-8\r\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -DjavaEncoding=UTF-8\r\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.net.preferIPv4Stack=true\r\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dsun.rmi.dgc.client.gcInterval=3600000\r\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dsun.rmi.dgc.server.gcInterval=3600000\r\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dsun.lang.ClassLoader.allowArraySyntax=true\r\n04-Jan-2023 19:33:49.687 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -DUseSunHttpHandler=true\r\n04-Jan-2023 19:33:49.687 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dssl.SocketFactory.provider=sun.security.ssl.SSLSocketFactoryImpl\r\n04-Jan-2023 19:33:49.687 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dssl.ServerSocketFactory.provider=sun.security.ssl.SSLSocketFactoryImpl\r\n04-Jan-2023 19:33:49.687 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djdk.tls.ephemeralDHKeySize=2048\r\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.protocol.handler.pkgs=org.apache.catalina.webresources\r\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dorg.apache.catalina.security.SecurityListener.UMASK=0027\r\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcom.sun.management.jmxremote\r\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcom.sun.management.jmxremote.port=8191\r\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcom.sun.management.jmxremote.rmi.port=8191\r\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcom.sun.management.jmxremote.ssl=false\r\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcom.sun.management.jmxremote.authenticate=false\r\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dignore.endorsed.dirs=\r\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcatalina.base=/opt/apache-tomcat-9.0.55\r\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcatalina.home=/opt/apache-tomcat-9.0.55\r\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.io.tmpdir=/opt/apache-tomcat-9.0.55/temp\r\n04-Jan-2023 19:33:49.692 INFO [main] org.apache.catalina.core.AprLifecycleListener.lifecycleEvent The Apache Tomcat Native library which allows using OpenSSL was not found on the java.library.path: [/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib]\r\n04-Jan-2023 19:33:50.555 INFO [main] org.apache.coyote.AbstractProtocol.init Initializing ProtocolHandler [&quot;http-nio-8088&quot;]\r\n04-Jan-2023 19:33:50.644 INFO [main] org.apache.catalina.startup.Catalina.load Server initialization in [1490] milliseconds\r\n04-Jan-2023 19:33:50.707 INFO [main] org.apache.catalina.core.StandardService.startInternal Starting service [Catalina]\r\n04-Jan-2023 19:33:50.707 INFO [main] org.apache.catalina.core.StandardEngine.startInternal Starting Servlet engine: [Apache Tomcat/9.0.55]\r\n04-Jan-2023 19:33:50.780 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deploying web application archive [/opt/apache-tomcat-9.0.55/webapps/probe.war]\r\nSecurity framework of XStream not initialized, XStream is probably vulnerable.\r\n04-Jan-2023 19:34:03.393 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deployment of web application archive [/opt/apache-tomcat-9.0.55/webapps/probe.war] has finished in [12,612] ms\r\n04-Jan-2023 19:34:03.450 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deploying web application archive [/opt/apache-tomcat-9.0.55/webapps/reports.war]\r\n04-Jan-2023 19:34:04.725 INFO [main] org.apache.jasper.servlet.TldScanner.scanJars At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.\r\n04-Jan-2023 19:34:04.731 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deployment of web application archive [/opt/apache-tomcat-9.0.55/webapps/reports.war] has finished in [1,281] ms\r\n04-Jan-2023 19:34:04.743 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [&quot;http-nio-8088&quot;]\r\n04-Jan-2023 19:34:04.840 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in [14195] milliseconds\r\n\r\n```\r\n\r\n\r\nThis is a main part of my setenv.sh file: \r\n\r\n```bash\r\nJAVA_HOME=/opt/jdk1.8.0_202\r\nTOMCAT_HOME=/opt/apache-tomcat-9.0.55\r\nSERVER_NAME=tomcat\r\nHOST_IP=10.1.1.144\r\n\r\n# Language\r\nLANG=pt_BR\r\n\r\n#Custom Ports\r\n#HTTP_PORT=80\r\n#AJP_PORT=8119\r\nSSL_PORT=8443\r\nSHUTDOWN_PORT=8115\r\nJMX_PORT=8191\r\n\r\n\r\n# JMX Opts\r\nCATALINA_OPTS=&quot;-Dcom.sun.management.jmxremote&quot;\r\nCATALINA_OPTS=&quot;$CATALINA_OPTS -Dcom.sun.management.jmxremote.port=$JMX_PORT&quot;\r\nCATALINA_OPTS=&quot;$CATALINA_OPTS -Dcom.sun.management.jmxremote.rmi.port=$JMX_PORT&quot;\r\nCATALINA_OPTS=&quot;$CATALINA_OPTS -Dcom.sun.management.jmxremote.ssl=false&quot;\r\nCATALINA_OPTS=&quot;$CATALINA_OPTS -Dcom.sun.management.jmxremote.authenticate=false&quot;\r\nCATALINA_OPTS=&quot;$CATALINA_OPTS -Djava.rmi.server.hostname=$HOST_IP&quot;\r\n\r\n#Prometheus JMX Exporter\r\nJAVA_OPTS=&quot;$JAVA_OPTS -javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml&quot;\r\n\r\n#SET TIMEZONE IN JVM\r\nJAVA_OPTS=&quot;$JAVA_OPTS -Duser.timezone=America/Sao_Paulo&quot;\r\n```\r\n\r\nHow can I tell it to load correctly my setenv.sh file? Is this something on spring config lacking configurations? \r\n\r\nI tried a lot of things to start it using my VARs even putting then into catalina.sh and I have no positive results. \r\n\r\nI need to load those apps and load prometheus and JMX and put it to work with correct time. All my VARS are working on a real installed tomcat. \r\n\r\nWhat I am doing wrong, please?  \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nI would like to run my tomcat 9 servers with java loading a correct timezone. It is loading one hour more than current time. And I need to put JMX to be acessed outside my container. And I need to export this container status to Prometheus. ","title":"My container has a correct date and timezone. But my tomcat is getting one hour more than I configured. How to fix wrong time in tomcat 9 container?","body":"<p>I am trying to make it run setenv.sh to load some JAVA_OPTS but is it not loading nothing. My Tomcat start a .war files using springboot for start my application.\nThe problem here is that it is not loading correct timezone on java and it is not loading JMX and Prometheus exporters.</p>\n<p>Here is my docker file.</p>\n<pre><code>FROM openjdk:11-jre-slim\nMAINTAINER Me\n\nUSER root\n\nRUN rm -rf ${JAVA_HOME}/*src.zip\n\nENV JAVA_PKG=jdk-8u202-linux-x64.tar.gz\nENV CATALINA_PKG=apache-tomcat-9.0.55.tar.gz\n\nENV JAVA_HOME=/opt/jdk1.8.0_202\nENV CATALINA_HOME=/opt/apache-tomcat-9.0.55\n\nRUN apt-get update &amp;&amp; DEBIAN_FRONTEND=noninteractive apt-get install -y locales\nRUN sed -i -e 's/# pt_BR.UTF-8 UTF-8/pt_BR.UTF-8 UTF-8/' /etc/locale.gen &amp;&amp; \\\n    dpkg-reconfigure --frontend=noninteractive locales &amp;&amp; \\\n    update-locale LANG=pt_BR.UTF-8\nENV LANG pt_BR.UTF-8 \n#RUN echo &quot;America/Sao_Paulo&quot; &gt;  /etc/timezone\nENV TZ=America/Sao_Paulo\nRUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo $TZ &gt; /etc/timezone\n\n#ENV TZ America/Sao_Paulo\nENV LANGUAGE pt_BR.UTF-8\nENV LC_ALL pt_BR.UTF-8\n\n\nCOPY ./java/${JAVA_PKG} /opt/\nRUN tar -xzvf /opt/${JAVA_PKG} --directory=/opt/\nRUN rm /opt/${JAVA_PKG}\n\nCOPY ./tomcat/${CATALINA_PKG} /opt/\nRUN tar -xzvf /opt/${CATALINA_PKG} --directory=/opt/\nRUN rm /opt/${CATALINA_PKG}\n\nENV PATH=&quot;$JAVA_HOME/bin:${PATH}&quot;\nENV PATH=&quot;$CATALINA_HOME/bin:${PATH}&quot;\n\n# Create a group and user\n#RUN addgroup -S tomcat_grp &amp;&amp; adduser -S tomcat -G tomcat_grp - criar UID 1002 para facilitar as permiss√µes de escrita no host\nRUN groupadd tomcat_grp &amp;&amp; useradd -r -u 1002 tomcat -g tomcat_grp\n\nCOPY ./lib/* ${CATALINA_HOME}/lib/\n\nRUN chown -R tomcat:tomcat_grp ${CATALINA_HOME}\nRUN chmod -R 777 ${CATALINA_HOME}\n\nRUN chown -R tomcat:tomcat_grp ${JAVA_HOME}\nRUN chmod -R 777 ${JAVA_HOME}\n\nUSER tomcat\n\nEXPOSE 8080\n\nUSER root\n\n#prometheus jmx exporter\nRUN mkdir -p /opt/jmx_exporter\nCOPY ./tomcat/jmx_exporter/jmx_prometheus_javaagent-0.17.2.jar /opt/jmx_exporter\nCOPY ./tomcat/jmx_exporter/config.yaml /opt/jmx_exporter\n\n#clean image\n#CMD [&quot;sh&quot;, &quot;-c&quot;, &quot;apt update&quot;; &quot;apt install wget -y&quot;; &quot;apt-get clean ; apt-get autoclean ; apt-get autoremove&quot;]\nRUN apt update &amp;&amp; apt install wget -y; apt clean; apt autoclean; apt autoremove\n\n#start tomcat\nCOPY startup.sh /usr/local/\nCMD [&quot;sh&quot;, &quot;-c&quot;, &quot;chmod a+x /opt/apache-tomcat-9.0.55/bin/catalina.sh; chmod a+x /opt/apache-tomcat-9.0.55/bin/setenv.sh; /opt/apache-tomcat-9.0.55/bin/setenv.sh; chmod a+x /usr/local/startup.sh ; /usr/local/startup.sh&quot;]\n#RUN chmod a+x /usr/local/startup.sh ; /usr/local/startup.sh\n\n#CMD [&quot;sh&quot;, &quot;-c&quot;, &quot;chmod a+x ${CATALINA_HOME}/bin/*.sh; chmod a+x /usr/local/startup.sh ; ${CATALINA_HOME}/bin/startup.sh&quot;]\n\n#COPY startup.sh /usr/local/\n#CMD chmod a+x /usr/local/startup.sh \n# Launch Tomcat on startup\n#CMD /usr/local/startup.sh\n\n</code></pre>\n<p>This is a one service of my compose stack:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>  tomcat2_ecops_reports_pabx:\n    build: *build\n    labels:\n      - reports_pabx  \n    logging: *default-logging\n    container_name: ecops_reports_pabx_${CLIENT_NAME}_${VER}_${IMAGE_TAG}\n    restart: unless-stopped\n#    command: *command    \n    volumes:\n      -  ${LOCALTIME}\n      -  ${PABXREPTS_PRD}:${POD_WEBAPPS}\n      -  ${REPORTS}:${POD_WEBAPPS}/reports\n      -  ${CONF_CTXT}/context_reports.xml:${CONF_CTXT}/context.xml\n#    environment:\n#      CATALINA_OPTS: &quot;-Djava.rmi.server.hostname=$HOST_IP&quot;\n#      JAVA_OPTS: &quot;-javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml \\\n#        -Duser.timezone=America/Sao_Paulo&quot; \n    ports:\n      - 9912:8088 \n      - 8192:8191\n      - 9402:9404      \n    networks: *networks\n\n</code></pre>\n<p>I got a correct time inside my container:</p>\n<pre class=\"lang-none prettyprint-override\"><code>root@b2ad0fe2338b:/# date\nqua 04 jan 2023 19:31:53 -03\nroot@b2ad0fe2338b:/# \n</code></pre>\n<p>I got correct time in my host system:</p>\n<pre class=\"lang-none prettyprint-override\"><code>[root@VM-L-13104 projeto_psv]# date\nWed Jan  4 19:31:42 -03 2023\n</code></pre>\n<p>Time in probe:</p>\n<blockquote>\n<p>Current time:¬†Wed Jan 04 20:31:35 BRST 2023</p>\n</blockquote>\n<p>This is the springboot process:</p>\n<pre class=\"lang-none prettyprint-override\"><code>VM settings:\n    Max. Heap Size (Estimated): 2.52G\n    Ergonomics Machine Class: server\n    Using VM: Java HotSpot(TM) 64-Bit Server VM\n\n04-Jan-2023 19:33:49.331 SEVERE [main] org.apache.tomcat.vault.util.PropertySourceVault.init Keystore password should be either masked or prefixed with one of {EXT}, {EXTC}, {CMD}, {CMDC}\n    org.apache.tomcat.vault.security.vault.SecurityVaultException: Keystore password should be either masked or prefixed with one of {EXT}, {EXTC}, {CMD}, {CMDC}\n        at org.apache.tomcat.vault.security.vault.PicketBoxSecurityVault.init(PicketBoxSecurityVault.java:168)\n        at org.apache.tomcat.vault.util.PropertySourceVault.init(PropertySourceVault.java:105)\n        at org.apache.tomcat.vault.util.PropertySourceVault.&lt;init&gt;(PropertySourceVault.java:82)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n        at org.apache.tomcat.util.digester.Digester.&lt;clinit&gt;(Digester.java:104)\n        at org.apache.catalina.startup.Catalina.createStartDigester(Catalina.java:367)\n        at org.apache.catalina.startup.Catalina.parseServerXml(Catalina.java:608)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:709)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:746)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:498)\n        at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:305)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:475)\n04-Jan-2023 19:33:49.679 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version name:   Apache Tomcat/9.0.55\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server built:          Nov 10 2021 08:26:45 UTC\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version number: 9.0.55.0\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Name:               Linux\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Version:            3.10.0-1160.80.1.0.1.el7.x86_64\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Architecture:          amd64\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Java Home:             /opt/jdk1.8.0_202/jre\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Version:           1.8.0_202-b08\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Vendor:            Oracle Corporation\n04-Jan-2023 19:33:49.683 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_BASE:         /opt/apache-tomcat-9.0.55\n04-Jan-2023 19:33:49.684 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_HOME:         /opt/apache-tomcat-9.0.55\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.util.logging.config.file=/opt/apache-tomcat-9.0.55/conf/logging.properties\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dserver=tomcat\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djvm=tomcat\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dhttp.port=\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dajp.port=8119\n04-Jan-2023 19:33:49.685 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dssl.port=8443\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dshutdown.port=8115\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -XX:+UnlockExperimentalVMOptions\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -XX:+UseCGroupMemoryLimitForHeap\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -XX:MaxRAMFraction=2\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.awt.headless=true\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dfile.encoding=UTF-8\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -DjavaEncoding=UTF-8\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.net.preferIPv4Stack=true\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dsun.rmi.dgc.client.gcInterval=3600000\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dsun.rmi.dgc.server.gcInterval=3600000\n04-Jan-2023 19:33:49.686 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dsun.lang.ClassLoader.allowArraySyntax=true\n04-Jan-2023 19:33:49.687 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -DUseSunHttpHandler=true\n04-Jan-2023 19:33:49.687 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dssl.SocketFactory.provider=sun.security.ssl.SSLSocketFactoryImpl\n04-Jan-2023 19:33:49.687 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dssl.ServerSocketFactory.provider=sun.security.ssl.SSLSocketFactoryImpl\n04-Jan-2023 19:33:49.687 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djdk.tls.ephemeralDHKeySize=2048\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.protocol.handler.pkgs=org.apache.catalina.webresources\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dorg.apache.catalina.security.SecurityListener.UMASK=0027\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcom.sun.management.jmxremote\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcom.sun.management.jmxremote.port=8191\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcom.sun.management.jmxremote.rmi.port=8191\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcom.sun.management.jmxremote.ssl=false\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcom.sun.management.jmxremote.authenticate=false\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dignore.endorsed.dirs=\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcatalina.base=/opt/apache-tomcat-9.0.55\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcatalina.home=/opt/apache-tomcat-9.0.55\n04-Jan-2023 19:33:49.689 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.io.tmpdir=/opt/apache-tomcat-9.0.55/temp\n04-Jan-2023 19:33:49.692 INFO [main] org.apache.catalina.core.AprLifecycleListener.lifecycleEvent The Apache Tomcat Native library which allows using OpenSSL was not found on the java.library.path: [/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib]\n04-Jan-2023 19:33:50.555 INFO [main] org.apache.coyote.AbstractProtocol.init Initializing ProtocolHandler [&quot;http-nio-8088&quot;]\n04-Jan-2023 19:33:50.644 INFO [main] org.apache.catalina.startup.Catalina.load Server initialization in [1490] milliseconds\n04-Jan-2023 19:33:50.707 INFO [main] org.apache.catalina.core.StandardService.startInternal Starting service [Catalina]\n04-Jan-2023 19:33:50.707 INFO [main] org.apache.catalina.core.StandardEngine.startInternal Starting Servlet engine: [Apache Tomcat/9.0.55]\n04-Jan-2023 19:33:50.780 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deploying web application archive [/opt/apache-tomcat-9.0.55/webapps/probe.war]\nSecurity framework of XStream not initialized, XStream is probably vulnerable.\n04-Jan-2023 19:34:03.393 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deployment of web application archive [/opt/apache-tomcat-9.0.55/webapps/probe.war] has finished in [12,612] ms\n04-Jan-2023 19:34:03.450 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deploying web application archive [/opt/apache-tomcat-9.0.55/webapps/reports.war]\n04-Jan-2023 19:34:04.725 INFO [main] org.apache.jasper.servlet.TldScanner.scanJars At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.\n04-Jan-2023 19:34:04.731 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deployment of web application archive [/opt/apache-tomcat-9.0.55/webapps/reports.war] has finished in [1,281] ms\n04-Jan-2023 19:34:04.743 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [&quot;http-nio-8088&quot;]\n04-Jan-2023 19:34:04.840 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in [14195] milliseconds\n\n</code></pre>\n<p>This is a main part of my setenv.sh file:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>JAVA_HOME=/opt/jdk1.8.0_202\nTOMCAT_HOME=/opt/apache-tomcat-9.0.55\nSERVER_NAME=tomcat\nHOST_IP=10.1.1.144\n\n# Language\nLANG=pt_BR\n\n#Custom Ports\n#HTTP_PORT=80\n#AJP_PORT=8119\nSSL_PORT=8443\nSHUTDOWN_PORT=8115\nJMX_PORT=8191\n\n\n# JMX Opts\nCATALINA_OPTS=&quot;-Dcom.sun.management.jmxremote&quot;\nCATALINA_OPTS=&quot;$CATALINA_OPTS -Dcom.sun.management.jmxremote.port=$JMX_PORT&quot;\nCATALINA_OPTS=&quot;$CATALINA_OPTS -Dcom.sun.management.jmxremote.rmi.port=$JMX_PORT&quot;\nCATALINA_OPTS=&quot;$CATALINA_OPTS -Dcom.sun.management.jmxremote.ssl=false&quot;\nCATALINA_OPTS=&quot;$CATALINA_OPTS -Dcom.sun.management.jmxremote.authenticate=false&quot;\nCATALINA_OPTS=&quot;$CATALINA_OPTS -Djava.rmi.server.hostname=$HOST_IP&quot;\n\n#Prometheus JMX Exporter\nJAVA_OPTS=&quot;$JAVA_OPTS -javaagent:/opt/jmx_exporter/jmx_prometheus_javaagent-0.12.0.jar=9404:/opt/jmx_exporter/config.yaml&quot;\n\n#SET TIMEZONE IN JVM\nJAVA_OPTS=&quot;$JAVA_OPTS -Duser.timezone=America/Sao_Paulo&quot;\n</code></pre>\n<p>How can I tell it to load correctly my setenv.sh file? Is this something on spring config lacking configurations?</p>\n<p>I tried a lot of things to start it using my VARs even putting then into catalina.sh and I have no positive results.</p>\n<p>I need to load those apps and load prometheus and JMX and put it to work with correct time. All my VARS are working on a real installed tomcat.</p>\n<p>What I am doing wrong, please?</p>\n<p>I would like to run my tomcat 9 servers with java loading a correct timezone. It is loading one hour more than current time. And I need to put JMX to be acessed outside my container. And I need to export this container status to Prometheus.</p>\n"},{"tags":["java","linux","sockets","unix-socket"],"comments":[{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1668435697,"post_id":74432458,"comment_id":131397546,"body_markdown":"That type is used in junixsocket/junixsocket-tipc/src/main/java/org/newsclub/net/unix/tipc/AFTIPCTopologyWatcher.java","body":"That type is used in junixsocket/junixsocket-tipc/src/main/java/org/newsclub/net/&zwnj;&#8203;unix/tipc/AFTIPCTopo&zwnj;&#8203;logyWatcher.java"},{"owner":{"account_id":16177428,"reputation":1,"user_id":11679726,"display_name":"user11679726"},"score":0,"creation_date":1668516065,"post_id":74432458,"comment_id":131419437,"body_markdown":"thanks. I still need to &quot;unwrap&quot; lines like: `this.channel = AFTIPCDatagramSocket.newInstance(AFSocketType.SOCK_SEQPACKET).getChannel();`","body":"thanks. I still need to &quot;unwrap&quot; lines like: <code>this.channel = AFTIPCDatagramSocket.newInstance(AFSocketType.SOCK_SEQPACKET&zwnj;&#8203;).getChannel();</code>"},{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1668516153,"post_id":74432458,"comment_id":131419474,"body_markdown":"I&#39;m afraid I can&#39;t tell you anything about it. Maybe contact author?","body":"I&#39;m afraid I can&#39;t tell you anything about it. Maybe contact author?"}],"answers":[{"tags":[],"owner":{"account_id":16177428,"reputation":1,"user_id":11679726,"display_name":"user11679726"},"comment_count":0,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1672910865,"creation_date":1672910865,"answer_id":75016266,"question_id":74432458,"body_markdown":"The problem was solved using the Java Native Interface (JNI) directly. It turns out JNI is rather straightforward to use, whereas junixsocket piles up a stack of abstractions I didn&#39;t need.\r\n\r\n","title":"How do I create (and use) a unix domain socket of type SOCK_SEQPACKET on an abstract address with the Java library junixsocket?","body":"<p>The problem was solved using the Java Native Interface (JNI) directly. It turns out JNI is rather straightforward to use, whereas junixsocket piles up a stack of abstractions I didn't need.</p>\n"}],"owner":{"account_id":16177428,"reputation":1,"user_id":11679726,"display_name":"user11679726"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":157,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672910865,"creation_date":1668432650,"question_id":74432458,"body_markdown":"I have written a client and a server in C with such a socket, works fine. Now I need to talk to the server from Java.\r\n\r\nThe library [junixsocket][1] should allow me to do that. But how?\r\n\r\nI can&#39;t find a relevant example in the sources or tests, and the API is somewhat overwhelming to my Java-newbie eyes.\r\n\r\nI get the abstract address with:\r\n```\r\nAFUnixSocketAddress.inAbstractNamespace(&quot;my-project&quot;).\r\n```\r\n How to I create the `SOCK_SEQPACKET` socket? Connect to the server? Send and receive messages?\r\n\r\n[1]: https://kohlschutter.github.io/junixsocket/index.html","title":"How do I create (and use) a unix domain socket of type SOCK_SEQPACKET on an abstract address with the Java library junixsocket?","body":"<p>I have written a client and a server in C with such a socket, works fine. Now I need to talk to the server from Java.</p>\n<p>The library <a href=\"https://kohlschutter.github.io/junixsocket/index.html\" rel=\"nofollow noreferrer\">junixsocket</a> should allow me to do that. But how?</p>\n<p>I can't find a relevant example in the sources or tests, and the API is somewhat overwhelming to my Java-newbie eyes.</p>\n<p>I get the abstract address with:</p>\n<pre><code>AFUnixSocketAddress.inAbstractNamespace(&quot;my-project&quot;).\n</code></pre>\n<p>How to I create the <code>SOCK_SEQPACKET</code> socket? Connect to the server? Send and receive messages?</p>\n"},{"tags":["java","spring","spring-mvc","spring-2.5"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1672912685,"post_id":75016063,"comment_id":132381459,"body_markdown":"I would strongly suggest to upgrade to Spring 5.3 (at least) as that is still supported. YOu don&#39;t want to use a version that is very old and has known security flaws etc. That being said I [here](https://docs.spring.io/spring-framework/docs/2.5.6/reference/mvc.html#mvc-annotation) are the annotation driven docs for Spring 2.5.","body":"I would strongly suggest to upgrade to Spring 5.3 (at least) as that is still supported. YOu don&#39;t want to use a version that is very old and has known security flaws etc. That being said I <a href=\"https://docs.spring.io/spring-framework/docs/2.5.6/reference/mvc.html#mvc-annotation\" rel=\"nofollow noreferrer\">here</a> are the annotation driven docs for Spring 2.5."}],"owner":{"account_id":4597208,"reputation":48209,"user_id":3728901,"accept_rate":58,"display_name":"Vy Do"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":29,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672910669,"creation_date":1672909765,"question_id":75016063,"body_markdown":"I study for maintain an old web-app (Spring 2.5, Java/JDK 1.6, Eclipse IDE 2022-06, Windows 10 x64).\r\n\r\nLearned from tutorial https://mkyong.com/spring-mvc/spring-mvc-jquery-autocomplete-example/\r\n\r\nFile `mvc-dispatcher-servlet.xml`\r\n\r\n```xml\r\n&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;\r\n\txmlns:context=&quot;http://www.springframework.org/schema/context&quot;\r\n\txmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;\r\n\txsi:schemaLocation=&quot;\r\n        http://www.springframework.org/schema/beans     \r\n        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\r\n        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd\r\n        http://www.springframework.org/schema/context \r\n        http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;&gt;\r\n\r\n\t&lt;context:component-scan base-package=&quot;com.mkyong&quot; /&gt;\r\n\t&lt;bean\r\n\t\tclass=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;\r\n\t\t&lt;property name=&quot;prefix&quot;&gt;\r\n\t\t\t&lt;value&gt;/WEB-INF/pages/&lt;/value&gt;\r\n\t\t&lt;/property&gt;\r\n\t\t&lt;property name=&quot;suffix&quot;&gt;\r\n\t\t\t&lt;value&gt;.jsp&lt;/value&gt;\r\n\t\t&lt;/property&gt;\r\n\t&lt;/bean&gt;\r\n\t\r\n\t&lt;mvc:resources mapping=&quot;/resources/**&quot; location=&quot;/resources/&quot; /&gt;\r\n\r\n\t&lt;mvc:annotation-driven /&gt;\r\n\r\n&lt;/beans&gt;\r\n```\r\nI need convert this web-app (Spring 3.0) to Spring 2.5, how to revise? What is the same of Spring 3.0&#39;s &lt;mvc:annotation-driven&gt; in Spring 2.5?","title":"What is the same of Spring 3.0&#39;s &lt;mvc:annotation-driven&gt; in Spring 2.5?","body":"<p>I study for maintain an old web-app (Spring 2.5, Java/JDK 1.6, Eclipse IDE 2022-06, Windows 10 x64).</p>\n<p>Learned from tutorial <a href=\"https://mkyong.com/spring-mvc/spring-mvc-jquery-autocomplete-example/\" rel=\"nofollow noreferrer\">https://mkyong.com/spring-mvc/spring-mvc-jquery-autocomplete-example/</a></p>\n<p>File <code>mvc-dispatcher-servlet.xml</code></p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;\n    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;\n    xsi:schemaLocation=&quot;\n        http://www.springframework.org/schema/beans     \n        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd\n        http://www.springframework.org/schema/context \n        http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;&gt;\n\n    &lt;context:component-scan base-package=&quot;com.mkyong&quot; /&gt;\n    &lt;bean\n        class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;\n        &lt;property name=&quot;prefix&quot;&gt;\n            &lt;value&gt;/WEB-INF/pages/&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property name=&quot;suffix&quot;&gt;\n            &lt;value&gt;.jsp&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n    \n    &lt;mvc:resources mapping=&quot;/resources/**&quot; location=&quot;/resources/&quot; /&gt;\n\n    &lt;mvc:annotation-driven /&gt;\n\n&lt;/beans&gt;\n</code></pre>\n<p>I need convert this web-app (Spring 3.0) to Spring 2.5, how to revise? What is the same of Spring 3.0's mvc:annotation-driven in Spring 2.5?</p>\n"},{"tags":["java","permissions","guava","rate-limiting","resilience4j"],"answers":[{"tags":[],"owner":{"account_id":9992410,"reputation":460,"user_id":8710383,"display_name":"Oleksandr"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672910551,"creation_date":1672910551,"answer_id":75016225,"question_id":74994302,"body_markdown":"We found a solution only using **Resilience4J**.\r\nBased on the fact that the accumulation of the bucket in the rate limiter works on the basis of periodicity - we just redefined the period setting.\r\n\r\nInstead of 5 requests per 1 second, it became 1 request per 0.2s.\r\n\r\nMore precisely, it is even a smoothing of the effect of the accumulation of tokens instead of a solution, but it works pretty well.\r\n\r\n    public static RateLimiter buildRateLimiter(Duration period, int limit) {\r\n        var config = RateLimiterConfig.custom()\r\n                                      .limitRefreshPeriod(ofMillis(period.toMillis() / limit))\r\n                                      .limitForPeriod(1)\r\n                                      .build();\r\n\r\n        return RateLimiterRegistry.of(config).rateLimiter(&quot;test&quot;, config);\r\n    }\r\n\r\n","title":"RateLimiter disable permission accumulation","body":"<p>We found a solution only using <strong>Resilience4J</strong>.\nBased on the fact that the accumulation of the bucket in the rate limiter works on the basis of periodicity - we just redefined the period setting.</p>\n<p>Instead of 5 requests per 1 second, it became 1 request per 0.2s.</p>\n<p>More precisely, it is even a smoothing of the effect of the accumulation of tokens instead of a solution, but it works pretty well.</p>\n<pre><code>public static RateLimiter buildRateLimiter(Duration period, int limit) {\n    var config = RateLimiterConfig.custom()\n                                  .limitRefreshPeriod(ofMillis(period.toMillis() / limit))\n                                  .limitForPeriod(1)\n                                  .build();\n\n    return RateLimiterRegistry.of(config).rateLimiter(&quot;test&quot;, config);\n}\n</code></pre>\n"}],"owner":{"account_id":9992410,"reputation":460,"user_id":8710383,"display_name":"Oleksandr"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":215,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75016225,"answer_count":1,"score":0,"last_activity_date":1672910551,"creation_date":1672753958,"question_id":74994302,"body_markdown":"We are looking at 2 different libraries that work in the same way: **Apache Guava RateLimiter** &amp; **Resilience4J**.\r\n\r\nAccording to the documentation: \r\n\r\n&gt; RateLimiter uses the token bucket algorithm and accumulates the tokens. If the token consumption frequency is low, the requests can directly get the tokens without waiting. RateLimiter accumulates tokens to allow it to cope with a sudden increase in traffic. When RateLimiter does not have sufficient number of tokens available, it uses the delayed processing method.\r\n\r\n\r\nI observe that at such a moment the number of resolutions can reach x2 of the given one per second. Here is a simplified example of the Guava RateLimiter issue:\r\n\r\n    public static void main(String[] args) throws InterruptedException {\r\n        var result = new ArrayList&lt;Integer&gt;();\r\n        var rateLimiter = RateLimiter.create(5);\r\n\r\n        // Required to accumulate permissions\r\n        Thread.sleep(30000);\r\n\r\n        for (int i = 0; i &lt; 30; i++) {\r\n            result.add(LocalTime.now().getSecond());\r\n            rateLimiter.acquire();\r\n        }\r\n\r\n        var collect = result.stream().collect(Collectors.groupingBy(e -&gt; e, Collectors.counting()));\r\n        System.out.println(collect);\r\n    }\r\n\r\nThe result will be something like this:\r\n    `{42=10, 43=5, 44=5, 45=5, 46=5}`.\r\nX2 permissions at the first second instead of target 5.\r\n\r\nSo my main question is: how to disable such logic with accumulation? Or what are the options to avoid this? I can&#39;t cross the 5 rps limit.\r\n\r\n*P.S. Resilience4J works with the same logic, but creation should be:*\r\n\r\n        public static RateLimiter buildRateLimiter() {\r\n        var config = RateLimiterConfig.custom()\r\n                                      .limitRefreshPeriod(Duration.ofSeconds(1))\r\n                                      .limitForPeriod(5)\r\n                                      .build();\r\n\r\n        return RateLimiterRegistry.of(config).rateLimiter(&quot;test&quot;, config);\r\n    }","title":"RateLimiter disable permission accumulation","body":"<p>We are looking at 2 different libraries that work in the same way: <strong>Apache Guava RateLimiter</strong> &amp; <strong>Resilience4J</strong>.</p>\n<p>According to the documentation:</p>\n<blockquote>\n<p>RateLimiter uses the token bucket algorithm and accumulates the tokens. If the token consumption frequency is low, the requests can directly get the tokens without waiting. RateLimiter accumulates tokens to allow it to cope with a sudden increase in traffic. When RateLimiter does not have sufficient number of tokens available, it uses the delayed processing method.</p>\n</blockquote>\n<p>I observe that at such a moment the number of resolutions can reach x2 of the given one per second. Here is a simplified example of the Guava RateLimiter issue:</p>\n<pre><code>public static void main(String[] args) throws InterruptedException {\n    var result = new ArrayList&lt;Integer&gt;();\n    var rateLimiter = RateLimiter.create(5);\n\n    // Required to accumulate permissions\n    Thread.sleep(30000);\n\n    for (int i = 0; i &lt; 30; i++) {\n        result.add(LocalTime.now().getSecond());\n        rateLimiter.acquire();\n    }\n\n    var collect = result.stream().collect(Collectors.groupingBy(e -&gt; e, Collectors.counting()));\n    System.out.println(collect);\n}\n</code></pre>\n<p>The result will be something like this:\n<code>{42=10, 43=5, 44=5, 45=5, 46=5}</code>.\nX2 permissions at the first second instead of target 5.</p>\n<p>So my main question is: how to disable such logic with accumulation? Or what are the options to avoid this? I can't cross the 5 rps limit.</p>\n<p><em>P.S. Resilience4J works with the same logic, but creation should be:</em></p>\n<pre><code>    public static RateLimiter buildRateLimiter() {\n    var config = RateLimiterConfig.custom()\n                                  .limitRefreshPeriod(Duration.ofSeconds(1))\n                                  .limitForPeriod(5)\n                                  .build();\n\n    return RateLimiterRegistry.of(config).rateLimiter(&quot;test&quot;, config);\n}\n</code></pre>\n"},{"tags":["java","spring-boot","apache-camel","junit5"],"owner":{"account_id":26014900,"reputation":23,"user_id":20825594,"display_name":"John"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":74,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672910443,"creation_date":1672910443,"question_id":75016203,"body_markdown":"I have this test class - currently it is checking the response at the endpoint \r\n\r\n    Endpoints.SEDA_PROCESS_ENDPOINT\r\n\r\nbut I need it to check at\r\n\r\n     &quot;mock:&quot;+Endpoints.SEDA_PROCESS_ENDPOINT\r\n\r\n\r\nIs there a way to forward the response to this mock endpoint I have just defined?\r\n\r\nbelow is my test class \r\n\r\n    package com.sams.pricing.prism.data.processor;\r\n    \r\n    import java.math.BigDecimal;\r\n    import java.util.HashMap;\r\n    import java.util.Map;\r\n    \r\n    import org.apache.camel.EndpointInject;\r\n    import org.apache.camel.ProducerTemplate;\r\n    import org.apache.camel.component.mock.MockEndpoint;\r\n    import org.apache.camel.test.spring.MockEndpoints;\r\n    import org.apache.camel.test.spring.junit5.CamelSpringBootTest;\r\n    import org.junit.jupiter.api.Test;\r\n    import org.mockito.Mock;\r\n    import org.mockito.Mockito;\r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.boot.test.context.SpringBootTest;\r\n    \r\n    import com.fasterxml.jackson.core.JsonProcessingException;\r\n    import com.sams.pricing.prism.data.processor.model.CostIQRetail;\r\n    import com.sams.pricing.prism.data.processor.routes.PrismRouter;\r\n    import com.sams.pricing.prism.data.processor.service.RulesEngineClient;\r\n    import com.sams.pricing.prism.data.processor.util.Endpoints;\r\n    \r\n    \r\n    \r\n    @SpringBootTest\r\n    @CamelSpringBootTest\r\n    @MockEndpoints( Endpoints.SEDA_PROCESS_ENDPOINT)\r\n    public class CamelRouteTests3  {\r\n    \r\n    \r\n    \t\r\n    \r\n    \t    @Autowired\r\n    \t    private ProducerTemplate template;\r\n    \r\n    \t    @EndpointInject( &quot;mock:&quot; + Endpoints.SEDA_PROCESS_ENDPOINT)\r\n    \t    private MockEndpoint mock;\r\n    \r\n    \t    @Mock\r\n    \t    private  PrismRouter p;\r\n    \t    \r\n    \t    @Mock\r\n    \t    private RulesEngineClient rulesEngineClientMock;\r\n    \r\n    \t\r\n    \t\r\n    \r\n    \tpublic CostIQRetail costIQObject() {\r\n    \r\n    \t\tCostIQRetail obj = new CostIQRetail();\r\n    \r\n    \t\tobj.setItemNbr(123);\r\n    \t\tobj.setLocationNbr(4931);\r\n    \t\tobj.setIsDcFlag(false) ;\r\n    \t\tobj.setStatus(&quot;SUCCESS&quot;);\r\n    \t\tobj.setOrderableCost(new BigDecimal((10.0)));\r\n    \t\tobj.setWarehousePackCost(new BigDecimal(100.0));\r\n    \t\tobj.setOrderablePrepaidCost(null) ;\r\n    \t\tobj.setOrderableCollectCost(null) ;\r\n    \t\tobj.setReasonCode(&quot;Markdown - category funded&quot;);\r\n    \t\tobj.setEffectiveDate(&quot;2022-12-29&quot;);\r\n    \t\tobj.setIsFutureEffectiveDate(false);\r\n    \t\tobj.setCostType(&quot;WAREHOUSE PACK COST&quot;);\r\n    \t\tobj.setSource(&quot;COST IQ&quot;);\r\n    \t\tobj.setCreatedBy(&quot;lab1 account&quot;);\r\n    \t\tobj.setCreatedByUserId(&quot;LB-cost-test&quot;);\r\n    \t\tobj.setCreatedTs(&quot;2022-12-29T02:42:25.529Z&quot;);\r\n    \t\tobj.setCurrentRetailPrice(new BigDecimal(55.0)) ;\r\n    \t\tobj.setCurrentOrderableCost(null);\r\n    \t\tobj.setCurrentWarehousePackCost(new BigDecimal((0.0)));\r\n    \t\tobj.setCurrentOrderablePrepaidCost(null) ;\r\n    \t\tobj.setCurrentOrderableCollectCost(null);\r\n    \t\tobj.setMarginChange(new BigDecimal((-100.0)));\r\n    \t\tobj.setOwedToClub(new BigDecimal((0.0))); \r\n    \t\tobj.setItemSourceId(3572924); \r\n    \t\tobj.setPriceDestId(701800);\r\n    \t\tobj.setCategory(87);\r\n    \t\tobj.setOrderableQty(null);\r\n    \t\tobj.setOldMargin(new BigDecimal((100.0)));\r\n    \t\tobj.setNewMargin(new BigDecimal(0.0));  \r\n    \r\n    \t\treturn obj;\r\n    \t}\r\n    \r\n    \tprivate String costIQPayloadString() throws JsonProcessingException\r\n    \t{\r\n    \r\n    \t\t String key =  &quot;{\\&quot;retailTypeReasonCode\\&quot;:{\\&quot;retailTypeReasonCodeId\\&quot;:{\\&quot;retailType\\&quot;:\\&quot;BP\\&quot;,\\&quot;retailReasonCode\\&quot;:\\&quot;CC\\&quot;}},\\&quot;expirationDate\\&quot;:null,\\&quot;customerRetailAmount\\&quot;:0.0,\\&quot;auditMessage\\&quot;:null,\\&quot;createdTimestamp\\&quot;:null,\\&quot;clientID\\&quot;:\\&quot;COST IQ\\&quot;,\\&quot;rowNumber\\&quot;:0,\\&quot;auditRecordTimestamp\\&quot;:null,\\&quot;clubNumber\\&quot;:4931,\\&quot;itemNumber\\&quot;:123,\\&quot;effectiveDate\\&quot;:\\&quot;2022-12-29\\&quot;,\\&quot;submissionID\\&quot;:null,\\&quot;retailAmount\\&quot;:55.0,\\&quot;createdBy\\&quot;:\\&quot;lab1 account\\&quot;}&quot;;\r\n    \t\t String key2 = &quot;{\\&quot;retailTypeReasonCode\\&quot;:{\\&quot;retailTypeReasonCodeId\\&quot;:{\\&quot;retailType\\&quot;:\\&quot;BP\\&quot;,\\&quot;retailReasonCode\\&quot;:\\&quot;CC\\&quot;}},\\&quot;expirationDate\\&quot;:null,\\&quot;customerRetailAmount\\&quot;:0.0,\\&quot;auditMessage\\&quot;:null,\\&quot;createdTimestamp\\&quot;:null,\\&quot;clientID\\&quot;:\\&quot;COST IQ\\&quot;,\\&quot;rowNumber\\&quot;:0,\\&quot;auditRecordTimestamp\\&quot;:null,\\&quot;categoryId\\&quot;:87,\\&quot;subCategoryId\\&quot;:1,\\&quot;clubNumber\\&quot;:4931,\\&quot;itemNumber\\&quot;:123,\\&quot;effectiveDate\\&quot;:\\&quot;2022-12-29\\&quot;,\\&quot;submissionID\\&quot;:null,\\&quot;retailAmount\\&quot;:10.0,\\&quot;createdBy\\&quot;:\\&quot;lab1 account\\&quot;}&quot;;\r\n    \t\t return key2;\r\n    \r\n    \t}\r\n    \r\n    \r\n    \t@Test\r\n    \t void test() throws Exception {\r\n    \t\t// Set up the mock endpoints\r\n    \t\tmock.expectedBodiesReceived(costIQPayloadString());\r\n    \r\n    //p.interceptSendToEndpoint( Endpoints.SEDA_PROCESS_ENDPOINT).to(mock.getEndpointUri());\r\n    \t\tMockito.when(rulesEngineClientMock.validateRules((costIQObject()))).thenReturn(costIQObject());  //.thenR\r\n    \r\n    \t\tMap&lt;String, Object&gt; headers = new HashMap&lt;&gt;();\r\n    \t\theaders.put(&quot;appName&quot;, &quot;costIQ&quot;);\r\n    \r\n    \r\n    \r\n    \r\n    \t\t//   Send the test message to the SEDA_SEND_ENDPOINT\r\n    \t\ttemplate.sendBodyAndHeaders(Endpoints.SEDA_SEND_ENDPOINT, costIQObject(), headers);\r\n    \t\t\r\n    \t\tmock.assertIsSatisfied();\r\n    \r\n    \r\n    \t\r\n    \t}\r\n    \r\n    \r\n    \r\n    }\r\n\r\nI have looked at advice with but that involves adding in the cameltestsupport and would need to re-write this code. Is there a way to do this with current implementations? \r\n","title":"Apache camel - I want to send to my mock endpoint","body":"<p>I have this test class - currently it is checking the response at the endpoint</p>\n<pre><code>Endpoints.SEDA_PROCESS_ENDPOINT\n</code></pre>\n<p>but I need it to check at</p>\n<pre><code> &quot;mock:&quot;+Endpoints.SEDA_PROCESS_ENDPOINT\n</code></pre>\n<p>Is there a way to forward the response to this mock endpoint I have just defined?</p>\n<p>below is my test class</p>\n<pre><code>package com.sams.pricing.prism.data.processor;\n\nimport java.math.BigDecimal;\nimport java.util.HashMap;\nimport java.util.Map;\n\nimport org.apache.camel.EndpointInject;\nimport org.apache.camel.ProducerTemplate;\nimport org.apache.camel.component.mock.MockEndpoint;\nimport org.apache.camel.test.spring.MockEndpoints;\nimport org.apache.camel.test.spring.junit5.CamelSpringBootTest;\nimport org.junit.jupiter.api.Test;\nimport org.mockito.Mock;\nimport org.mockito.Mockito;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.context.SpringBootTest;\n\nimport com.fasterxml.jackson.core.JsonProcessingException;\nimport com.sams.pricing.prism.data.processor.model.CostIQRetail;\nimport com.sams.pricing.prism.data.processor.routes.PrismRouter;\nimport com.sams.pricing.prism.data.processor.service.RulesEngineClient;\nimport com.sams.pricing.prism.data.processor.util.Endpoints;\n\n\n\n@SpringBootTest\n@CamelSpringBootTest\n@MockEndpoints( Endpoints.SEDA_PROCESS_ENDPOINT)\npublic class CamelRouteTests3  {\n\n\n    \n\n        @Autowired\n        private ProducerTemplate template;\n\n        @EndpointInject( &quot;mock:&quot; + Endpoints.SEDA_PROCESS_ENDPOINT)\n        private MockEndpoint mock;\n\n        @Mock\n        private  PrismRouter p;\n        \n        @Mock\n        private RulesEngineClient rulesEngineClientMock;\n\n    \n    \n\n    public CostIQRetail costIQObject() {\n\n        CostIQRetail obj = new CostIQRetail();\n\n        obj.setItemNbr(123);\n        obj.setLocationNbr(4931);\n        obj.setIsDcFlag(false) ;\n        obj.setStatus(&quot;SUCCESS&quot;);\n        obj.setOrderableCost(new BigDecimal((10.0)));\n        obj.setWarehousePackCost(new BigDecimal(100.0));\n        obj.setOrderablePrepaidCost(null) ;\n        obj.setOrderableCollectCost(null) ;\n        obj.setReasonCode(&quot;Markdown - category funded&quot;);\n        obj.setEffectiveDate(&quot;2022-12-29&quot;);\n        obj.setIsFutureEffectiveDate(false);\n        obj.setCostType(&quot;WAREHOUSE PACK COST&quot;);\n        obj.setSource(&quot;COST IQ&quot;);\n        obj.setCreatedBy(&quot;lab1 account&quot;);\n        obj.setCreatedByUserId(&quot;LB-cost-test&quot;);\n        obj.setCreatedTs(&quot;2022-12-29T02:42:25.529Z&quot;);\n        obj.setCurrentRetailPrice(new BigDecimal(55.0)) ;\n        obj.setCurrentOrderableCost(null);\n        obj.setCurrentWarehousePackCost(new BigDecimal((0.0)));\n        obj.setCurrentOrderablePrepaidCost(null) ;\n        obj.setCurrentOrderableCollectCost(null);\n        obj.setMarginChange(new BigDecimal((-100.0)));\n        obj.setOwedToClub(new BigDecimal((0.0))); \n        obj.setItemSourceId(3572924); \n        obj.setPriceDestId(701800);\n        obj.setCategory(87);\n        obj.setOrderableQty(null);\n        obj.setOldMargin(new BigDecimal((100.0)));\n        obj.setNewMargin(new BigDecimal(0.0));  \n\n        return obj;\n    }\n\n    private String costIQPayloadString() throws JsonProcessingException\n    {\n\n         String key =  &quot;{\\&quot;retailTypeReasonCode\\&quot;:{\\&quot;retailTypeReasonCodeId\\&quot;:{\\&quot;retailType\\&quot;:\\&quot;BP\\&quot;,\\&quot;retailReasonCode\\&quot;:\\&quot;CC\\&quot;}},\\&quot;expirationDate\\&quot;:null,\\&quot;customerRetailAmount\\&quot;:0.0,\\&quot;auditMessage\\&quot;:null,\\&quot;createdTimestamp\\&quot;:null,\\&quot;clientID\\&quot;:\\&quot;COST IQ\\&quot;,\\&quot;rowNumber\\&quot;:0,\\&quot;auditRecordTimestamp\\&quot;:null,\\&quot;clubNumber\\&quot;:4931,\\&quot;itemNumber\\&quot;:123,\\&quot;effectiveDate\\&quot;:\\&quot;2022-12-29\\&quot;,\\&quot;submissionID\\&quot;:null,\\&quot;retailAmount\\&quot;:55.0,\\&quot;createdBy\\&quot;:\\&quot;lab1 account\\&quot;}&quot;;\n         String key2 = &quot;{\\&quot;retailTypeReasonCode\\&quot;:{\\&quot;retailTypeReasonCodeId\\&quot;:{\\&quot;retailType\\&quot;:\\&quot;BP\\&quot;,\\&quot;retailReasonCode\\&quot;:\\&quot;CC\\&quot;}},\\&quot;expirationDate\\&quot;:null,\\&quot;customerRetailAmount\\&quot;:0.0,\\&quot;auditMessage\\&quot;:null,\\&quot;createdTimestamp\\&quot;:null,\\&quot;clientID\\&quot;:\\&quot;COST IQ\\&quot;,\\&quot;rowNumber\\&quot;:0,\\&quot;auditRecordTimestamp\\&quot;:null,\\&quot;categoryId\\&quot;:87,\\&quot;subCategoryId\\&quot;:1,\\&quot;clubNumber\\&quot;:4931,\\&quot;itemNumber\\&quot;:123,\\&quot;effectiveDate\\&quot;:\\&quot;2022-12-29\\&quot;,\\&quot;submissionID\\&quot;:null,\\&quot;retailAmount\\&quot;:10.0,\\&quot;createdBy\\&quot;:\\&quot;lab1 account\\&quot;}&quot;;\n         return key2;\n\n    }\n\n\n    @Test\n     void test() throws Exception {\n        // Set up the mock endpoints\n        mock.expectedBodiesReceived(costIQPayloadString());\n\n//p.interceptSendToEndpoint( Endpoints.SEDA_PROCESS_ENDPOINT).to(mock.getEndpointUri());\n        Mockito.when(rulesEngineClientMock.validateRules((costIQObject()))).thenReturn(costIQObject());  //.thenR\n\n        Map&lt;String, Object&gt; headers = new HashMap&lt;&gt;();\n        headers.put(&quot;appName&quot;, &quot;costIQ&quot;);\n\n\n\n\n        //   Send the test message to the SEDA_SEND_ENDPOINT\n        template.sendBodyAndHeaders(Endpoints.SEDA_SEND_ENDPOINT, costIQObject(), headers);\n        \n        mock.assertIsSatisfied();\n\n\n    \n    }\n\n\n\n}\n</code></pre>\n<p>I have looked at advice with but that involves adding in the cameltestsupport and would need to re-write this code. Is there a way to do this with current implementations?</p>\n"},{"tags":["java","spring-boot","logging","logback","multi-tenant"],"comments":[{"owner":{"account_id":16269349,"reputation":13462,"user_id":11748454,"display_name":"Piotr P. Karwasz"},"score":0,"creation_date":1672745389,"post_id":74992625,"comment_id":132339548,"body_markdown":"`TurboFilter`s do not exist in Log4j2, they are characteristic to Logback. Did you tag your question correctly? If you are indeed using Log4j2 Core, see [this question](https://stackoverflow.com/q/74917795/11748454) for a standard filter that can change configuration without reloading the entire logging system.","body":"<code>TurboFilter</code>s do not exist in Log4j2, they are characteristic to Logback. Did you tag your question correctly? If you are indeed using Log4j2 Core, see <a href=\"https://stackoverflow.com/q/74917795/11748454\">this question</a> for a standard filter that can change configuration without reloading the entire logging system."},{"owner":{"account_id":16369011,"reputation":9,"user_id":11822699,"display_name":"Manjunath"},"score":0,"creation_date":1672983057,"post_id":74992625,"comment_id":132400381,"body_markdown":"Thanks for the response, yes @PiotrP.Karwasz we are using TurboFilters which the characteristic of logback we have already achieved changing configuration per tenant without reloading the entire logging system. But we need to further changing logger level for package/class along with per tenant without reloading the entire logging system.\nLet us know if you have any suggestion.","body":"Thanks for the response, yes @PiotrP.Karwasz we are using TurboFilters which the characteristic of logback we have already achieved changing configuration per tenant without reloading the entire logging system. But we need to further changing logger level for package/class along with per tenant without reloading the entire logging system. Let us know if you have any suggestion."}],"owner":{"account_id":16369011,"reputation":9,"user_id":11822699,"display_name":"Manjunath"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":110,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1672910351,"creation_date":1672744634,"question_id":74992625,"body_markdown":"here we have a use cases, we are working on a web application that will host multiple companies (tenant).\r\n\r\n \r\n\r\nCurrently, we have added company-specific log separation using MDC. It will separate the log files per company.\r\n\r\n \r\n\r\nWe want the flexibility to change the logger level at runtime for a company (tenant) specific along with package/class logger level change, as we are getting a bulk number of unwanted logs in those files.\r\n \r\n\r\n \r\n\r\n \r\n\r\nCan anyone help me with this?\r\n\r\nWe have achieved it partially either for the Company or Package level.\r\n\r\n \r\n\r\n&#183; Company-specific logger level change using **Turbo Filter.**\r\n\r\n \r\n\r\n&#183; Package/Class level using **Admin Centre (using Actuator endpoints)**\r\n \r\n\r\nOur question is if there is any way to change the logger level at run-time for a company-specific along with package/class.\r\n\r\n \r\n\r\nEg: As Our application is Hosted for two companies ACOMP &amp; BCOMP.\r\n\r\n \r\n\r\nOur requirement is\r\n\r\n \r\n\r\nACOMP should log at INFO as root logger level, also user can set few packages like **com.test.samplepackage to DEBUG level**.\r\n \r\n\r\nSimilarly,\r\n\r\nBCOMP should log at DEBUG as root logger level, also user can set few packages like **com.test.samplepackage to ERROR** level.\r\n \r\n\r\n \r\n\r\nCan anyone help me with this?","title":"Logger level change for multi-tenant application as well as Package/Class logger level","body":"<p>here we have a use cases, we are working on a web application that will host multiple companies (tenant).</p>\n<p>Currently, we have added company-specific log separation using MDC. It will separate the log files per company.</p>\n<p>We want the flexibility to change the logger level at runtime for a company (tenant) specific along with package/class logger level change, as we are getting a bulk number of unwanted logs in those files.</p>\n<p>Can anyone help me with this?</p>\n<p>We have achieved it partially either for the Company or Package level.</p>\n<p>¬∑ Company-specific logger level change using <strong>Turbo Filter.</strong></p>\n<p>¬∑ Package/Class level using <strong>Admin Centre (using Actuator endpoints)</strong></p>\n<p>Our question is if there is any way to change the logger level at run-time for a company-specific along with package/class.</p>\n<p>Eg: As Our application is Hosted for two companies ACOMP &amp; BCOMP.</p>\n<p>Our requirement is</p>\n<p>ACOMP should log at INFO as root logger level, also user can set few packages like <strong>com.test.samplepackage to DEBUG level</strong>.</p>\n<p>Similarly,</p>\n<p>BCOMP should log at DEBUG as root logger level, also user can set few packages like <strong>com.test.samplepackage to ERROR</strong> level.</p>\n<p>Can anyone help me with this?</p>\n"},{"tags":["java","spring","eclipse","servlets"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":1,"creation_date":1672908852,"post_id":75015663,"comment_id":132380261,"body_markdown":"Obviously not, as that is the parameter name used by the `ContextLoaderListener` to determine which xml file to load (by default it loads `/WEB-INF/applicationContext.xml`. There is a problem with this setup as you are now loading your application twice, once in the `ContextLoaderListener` and again by the `DispatcherServlet`.","body":"Obviously not, as that is the parameter name used by the <code>ContextLoaderListener</code> to determine which xml file to load (by default it loads <code>&#47;WEB-INF&#47;applicationContext.xml</code>. There is a problem with this setup as you are now loading your application twice, once in the <code>ContextLoaderListener</code> and again by the <code>DispatcherServlet</code>."}],"owner":{"account_id":4597208,"reputation":48209,"user_id":3728901,"accept_rate":58,"display_name":"Vy Do"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":29,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":0,"score":2,"last_activity_date":1672909941,"creation_date":1672907548,"question_id":75015663,"body_markdown":"I am using Java/JDK 1.6,  Spring 2.5.6, Eclipse IDE 2022-06 . I see file `web.xml`\r\n\r\n[![enter image description here][1]][1]\r\n\r\n```xml\r\n&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n\txsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee \r\n\t      http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;\r\n\tversion=&quot;2.5&quot;&gt;\r\n\r\n\t&lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;\r\n\r\n\t&lt;servlet&gt;\r\n\t\t&lt;servlet-name&gt;mvc-dispatcher&lt;/servlet-name&gt;\r\n\t\t&lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\r\n\t\t&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\r\n\t&lt;/servlet&gt;\r\n\r\n\t&lt;servlet-mapping&gt;\r\n\t\t&lt;servlet-name&gt;mvc-dispatcher&lt;/servlet-name&gt;\r\n\t\t&lt;url-pattern&gt;/&lt;/url-pattern&gt;\r\n\t&lt;/servlet-mapping&gt;\r\n\r\n\t&lt;context-param&gt;\r\n\t\t&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\r\n\t\t&lt;param-value&gt;/WEB-INF/mvc-dispatcher-servlet.xml&lt;/param-value&gt;\r\n\t&lt;/context-param&gt;\r\n\r\n\t&lt;listener&gt;\r\n\t\t&lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\r\n\t&lt;/listener&gt;\r\n\r\n&lt;/web-app&gt;\r\n```\r\nPlease focus at this line\r\n\r\n```xml\r\n&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\r\n```\r\n\r\nCan we replace word `contextConfigLocation` by `foo`?\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/5VlrY.png","title":"Can we replace word contextConfigLocation by foo?","body":"<p>I am using Java/JDK 1.6,  Spring 2.5.6, Eclipse IDE 2022-06 . I see file <code>web.xml</code></p>\n<p><a href=\"https://i.stack.imgur.com/5VlrY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5VlrY.png\" alt=\"enter image description here\" /></a></p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee \n          http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;\n    version=&quot;2.5&quot;&gt;\n\n    &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;\n\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;mvc-dispatcher&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n    &lt;/servlet&gt;\n\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;mvc-dispatcher&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n\n    &lt;context-param&gt;\n        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n        &lt;param-value&gt;/WEB-INF/mvc-dispatcher-servlet.xml&lt;/param-value&gt;\n    &lt;/context-param&gt;\n\n    &lt;listener&gt;\n        &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n    &lt;/listener&gt;\n\n&lt;/web-app&gt;\n</code></pre>\n<p>Please focus at this line</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n</code></pre>\n<p>Can we replace word <code>contextConfigLocation</code> by <code>foo</code>?</p>\n"},{"tags":["java","spring","mongodb","spring-boot","changestream"],"answers":[{"tags":[],"owner":{"account_id":13216928,"reputation":1467,"user_id":9545125,"display_name":"TheStranger"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672909623,"creation_date":1672909623,"answer_id":75016026,"question_id":74990044,"body_markdown":"I ended up making it work like this:\r\n\r\n    @Document(collection = &quot;teams&quot;)\r\n    public class Team {\r\n        @Id\r\n        @BsonProperty(&quot;_id&quot;)\r\n        private ObjectId id;\r\n        private Integer orgId;\r\n        private String name;\r\n        private List&lt;Member&gt; players;\r\n        private List&lt;Member&gt; staff;\r\n\r\n        public class Member {\r\n            @Id\r\n            private ObjectId id;\r\n            private String name;\r\n        }\r\n    }\r\n\r\nThen I added CodecRegistry to my `MongoChangeStream` class like this:\r\n\r\nSo this is what I&#39;ve tried:\r\n\r\n    @Component\r\n    public class MongoChangeStream {\r\n\r\n        private final MongoTemplate mongoTemplate;\r\n\r\n        public MongoDBChangeStream(MongoTemplate mongoTemplate) {\r\n            this.mongoTemplate = mongoTemplate;\r\n        }\r\n\r\n        @EventListener(ContextRefreshedEvent.class)\r\n        public void changeStream() {\r\n\r\n            // Select the collection to query\r\n            CodecRegistry pojoCodecRegistry = org.bson.codecs.configuration.CodecRegistries.fromRegistries(MongoClientSettings.getDefaultCodecRegistry(), org.bson.codecs.configuration.CodecRegistries.fromProviders(PojoCodecProvider.builder().conventions(List.of(ANNOTATION_CONVENTION)).automatic(true).build()));\r\n            MongoCollection&lt;Team&gt; collection = mongoTemplate.getCollection(&quot;teams&quot;).withCodecRegistry(pojoCodecRegistry).withDocumentClass(Group.class);\r\n\r\n            // Create pipeline for operationType filter\r\n            List&lt;Bson&gt; pipeline = Arrays.asList(\r\n                    Aggregates.match(\r\n                            Filters.in(&quot;operationType&quot;,\r\n                                    Arrays.asList(&quot;insert&quot;, &quot;update&quot;, &quot;delete&quot;))));\r\n\r\n            // Create the Change Stream and watch on the filters in the pipeline\r\n            ChangeStreamIterable&lt;Team&gt; changeStream = collection.watch()\r\n                .fullDocument(FullDocument.UPDATE_LOOKUP)\r\n                .fullDocumentBeforeChange(FullDocumentBeforeChange.REQUIRED);\r\n\r\n            // Iterate over the Change Stream\r\n            for (ChangeStreamDocument&lt;Team&gt; changeEvent : changeStream) {\r\n                switch (changeEvent.getOperationType().name()) {\r\n                    case &quot;UPDATE&quot;:\r\n                        if (changeEvent.getUpdateDescription().getUpdatedFields().containsKey(&quot;players&quot;)) {\r\n                            // Do something\r\n                        }\r\n                        if (changeEvent.getUpdateDescription().getUpdatedFields().containsKey(&quot;staff&quot;)) {\r\n                            // Do something\r\n                        }\r\n                        break;\r\n                    case &quot;DELETE&quot;:\r\n                            // Do something\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    }","title":"How do I get MongoDB ChangeStreamDocument out as my dto instead of Document type?","body":"<p>I ended up making it work like this:</p>\n<pre><code>@Document(collection = &quot;teams&quot;)\npublic class Team {\n    @Id\n    @BsonProperty(&quot;_id&quot;)\n    private ObjectId id;\n    private Integer orgId;\n    private String name;\n    private List&lt;Member&gt; players;\n    private List&lt;Member&gt; staff;\n\n    public class Member {\n        @Id\n        private ObjectId id;\n        private String name;\n    }\n}\n</code></pre>\n<p>Then I added CodecRegistry to my <code>MongoChangeStream</code> class like this:</p>\n<p>So this is what I've tried:</p>\n<pre><code>@Component\npublic class MongoChangeStream {\n\n    private final MongoTemplate mongoTemplate;\n\n    public MongoDBChangeStream(MongoTemplate mongoTemplate) {\n        this.mongoTemplate = mongoTemplate;\n    }\n\n    @EventListener(ContextRefreshedEvent.class)\n    public void changeStream() {\n\n        // Select the collection to query\n        CodecRegistry pojoCodecRegistry = org.bson.codecs.configuration.CodecRegistries.fromRegistries(MongoClientSettings.getDefaultCodecRegistry(), org.bson.codecs.configuration.CodecRegistries.fromProviders(PojoCodecProvider.builder().conventions(List.of(ANNOTATION_CONVENTION)).automatic(true).build()));\n        MongoCollection&lt;Team&gt; collection = mongoTemplate.getCollection(&quot;teams&quot;).withCodecRegistry(pojoCodecRegistry).withDocumentClass(Group.class);\n\n        // Create pipeline for operationType filter\n        List&lt;Bson&gt; pipeline = Arrays.asList(\n                Aggregates.match(\n                        Filters.in(&quot;operationType&quot;,\n                                Arrays.asList(&quot;insert&quot;, &quot;update&quot;, &quot;delete&quot;))));\n\n        // Create the Change Stream and watch on the filters in the pipeline\n        ChangeStreamIterable&lt;Team&gt; changeStream = collection.watch()\n            .fullDocument(FullDocument.UPDATE_LOOKUP)\n            .fullDocumentBeforeChange(FullDocumentBeforeChange.REQUIRED);\n\n        // Iterate over the Change Stream\n        for (ChangeStreamDocument&lt;Team&gt; changeEvent : changeStream) {\n            switch (changeEvent.getOperationType().name()) {\n                case &quot;UPDATE&quot;:\n                    if (changeEvent.getUpdateDescription().getUpdatedFields().containsKey(&quot;players&quot;)) {\n                        // Do something\n                    }\n                    if (changeEvent.getUpdateDescription().getUpdatedFields().containsKey(&quot;staff&quot;)) {\n                        // Do something\n                    }\n                    break;\n                case &quot;DELETE&quot;:\n                        // Do something\n                    break;\n            }\n        }\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":13216928,"reputation":1467,"user_id":9545125,"display_name":"TheStranger"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":562,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"accepted_answer_id":75016026,"answer_count":1,"score":1,"last_activity_date":1672909623,"creation_date":1672729836,"question_id":74990044,"body_markdown":"I have the following class in my MongoDB project:\r\n\r\n    @Document(collection = &quot;teams&quot;)\r\n    public class Team {\r\n        private @MongoId(FieldType.OBJECT_ID)\r\n        @Schema(type = &quot;string&quot;, example = &quot;60b0c56e4192f01e8745bd75&quot;)\r\n        ObjectId id;\r\n        @Schema(example = &quot;56373&quot;)\r\n        private Integer orgId;\r\n        private String name;\r\n        private List&lt;Member&gt; players;\r\n        private List&lt;Member&gt; staff;\r\n\r\n        public class Member{\r\n            private ObjectId id;\r\n            private String name;\r\n        }\r\n    }\r\n\r\nAs you can see, this class represents the documents in my `teams` collection in MongoDB.\r\nI&#39;m trying to create a ***change stream***, because I want to monitorize players and staff players joining and leaving teams, as well as existing teams being deleted from the teams collection.\r\n\r\nSo this is what I&#39;ve tried:\r\n\r\n    @Component\r\n    public class MongoChangeStream {\r\n\r\n        private final MongoTemplate mongoTemplate;\r\n\r\n        public MongoDBChangeStream(MongoTemplate mongoTemplate) {\r\n            this.mongoTemplate = mongoTemplate;\r\n        }\r\n\r\n        @EventListener(ContextRefreshedEvent.class)\r\n        public void changeStream() {\r\n\r\n            // Select the collection to query\r\n            MongoCollection&lt;Document&gt; collection = mongoTemplate.getCollection(&quot;teams&quot;);\r\n\r\n            // Create pipeline for operationType filter\r\n            List&lt;Bson&gt; pipeline = Arrays.asList(\r\n                    Aggregates.match(\r\n                            Filters.in(&quot;operationType&quot;,\r\n                                    Arrays.asList(&quot;insert&quot;, &quot;update&quot;, &quot;delete&quot;))));\r\n\r\n            // Create the Change Stream and watch on the filters in the pipeline\r\n            ChangeStreamIterable&lt;Document&gt; changeStream = collection.watch()\r\n                .fullDocument(FullDocument.UPDATE_LOOKUP)\r\n                .fullDocumentBeforeChange(FullDocumentBeforeChange.REQUIRED);\r\n\r\n            // Iterate over the Change Stream\r\n            for (ChangeStreamDocument&lt;Document&gt; changeEvent : changeStream) {\r\n                switch (changeEvent.getOperationType().name()) {\r\n                    case &quot;UPDATE&quot;:\r\n                        if (changeEvent.getUpdateDescription().getUpdatedFields().containsKey(&quot;players&quot;)) {\r\n                            // Do something\r\n                        }\r\n                        if (changeEvent.getUpdateDescription().getUpdatedFields().containsKey(&quot;staff&quot;)) {\r\n                            // Do something\r\n                        }\r\n                        break;\r\n                    case &quot;DELETE&quot;:\r\n                            // Do something\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\nMy question is basically how do I get the documents out from the changeStream as Team objects instead of Document objects?\r\n\r\nI&#39;ve tried to change all the occurrences of Documents with Team, but then I get this error:\r\n\r\n`Can&#39;t find a codec for CodecCacheKey{clazz=class com.test.dto.Team, types=null}.`","title":"How do I get MongoDB ChangeStreamDocument out as my dto instead of Document type?","body":"<p>I have the following class in my MongoDB project:</p>\n<pre><code>@Document(collection = &quot;teams&quot;)\npublic class Team {\n    private @MongoId(FieldType.OBJECT_ID)\n    @Schema(type = &quot;string&quot;, example = &quot;60b0c56e4192f01e8745bd75&quot;)\n    ObjectId id;\n    @Schema(example = &quot;56373&quot;)\n    private Integer orgId;\n    private String name;\n    private List&lt;Member&gt; players;\n    private List&lt;Member&gt; staff;\n\n    public class Member{\n        private ObjectId id;\n        private String name;\n    }\n}\n</code></pre>\n<p>As you can see, this class represents the documents in my <code>teams</code> collection in MongoDB.\nI'm trying to create a <em><strong>change stream</strong></em>, because I want to monitorize players and staff players joining and leaving teams, as well as existing teams being deleted from the teams collection.</p>\n<p>So this is what I've tried:</p>\n<pre><code>@Component\npublic class MongoChangeStream {\n\n    private final MongoTemplate mongoTemplate;\n\n    public MongoDBChangeStream(MongoTemplate mongoTemplate) {\n        this.mongoTemplate = mongoTemplate;\n    }\n\n    @EventListener(ContextRefreshedEvent.class)\n    public void changeStream() {\n\n        // Select the collection to query\n        MongoCollection&lt;Document&gt; collection = mongoTemplate.getCollection(&quot;teams&quot;);\n\n        // Create pipeline for operationType filter\n        List&lt;Bson&gt; pipeline = Arrays.asList(\n                Aggregates.match(\n                        Filters.in(&quot;operationType&quot;,\n                                Arrays.asList(&quot;insert&quot;, &quot;update&quot;, &quot;delete&quot;))));\n\n        // Create the Change Stream and watch on the filters in the pipeline\n        ChangeStreamIterable&lt;Document&gt; changeStream = collection.watch()\n            .fullDocument(FullDocument.UPDATE_LOOKUP)\n            .fullDocumentBeforeChange(FullDocumentBeforeChange.REQUIRED);\n\n        // Iterate over the Change Stream\n        for (ChangeStreamDocument&lt;Document&gt; changeEvent : changeStream) {\n            switch (changeEvent.getOperationType().name()) {\n                case &quot;UPDATE&quot;:\n                    if (changeEvent.getUpdateDescription().getUpdatedFields().containsKey(&quot;players&quot;)) {\n                        // Do something\n                    }\n                    if (changeEvent.getUpdateDescription().getUpdatedFields().containsKey(&quot;staff&quot;)) {\n                        // Do something\n                    }\n                    break;\n                case &quot;DELETE&quot;:\n                        // Do something\n                    break;\n            }\n        }\n    }\n}\n</code></pre>\n<p>My question is basically how do I get the documents out from the changeStream as Team objects instead of Document objects?</p>\n<p>I've tried to change all the occurrences of Documents with Team, but then I get this error:</p>\n<p><code>Can't find a codec for CodecCacheKey{clazz=class com.test.dto.Team, types=null}.</code></p>\n"},{"tags":["java","eclipse"],"comments":[{"owner":{"account_id":114128,"reputation":50467,"user_id":300257,"accept_rate":89,"display_name":"Gilbert Le Blanc"},"score":0,"creation_date":1672923360,"post_id":75016022,"comment_id":132384966,"body_markdown":"Inside your existing for loop, you add another for loop that asks for three numbers.  After you receive the three numbers, you average them (I guess) to get the final score, where you check for passing.  You only need to declare one instance of `Scanner` in your `main` method and pass that instance to your `inputNumber` method.  Method names start with a lowercase character.  Variable names start with a lowercase character.","body":"Inside your existing for loop, you add another for loop that asks for three numbers.  After you receive the three numbers, you average them (I guess) to get the final score, where you check for passing.  You only need to declare one instance of <code>Scanner</code> in your <code>main</code> method and pass that instance to your <code>inputNumber</code> method.  Method names start with a lowercase character.  Variable names start with a lowercase character."}],"owner":{"account_id":27439283,"reputation":29,"user_id":20934507,"display_name":"draing"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":34,"favorite_count":0,"down_vote_count":1,"up_vote_count":3,"answer_count":0,"score":2,"last_activity_date":1672909592,"creation_date":1672909592,"question_id":75016022,"body_markdown":" I need to modify my code . So that the user enters the number of students and their grades on three tests, and the program writes to him how many students have entered the institute (passing score = 7, maximum score = 10). I wrote the code for one test and don&#39;t know how to write for three.\r\n This problem is under the comment: &quot;//Information input and calculation&quot;\r\n```\r\nimport java.util.Scanner;\r\n\r\npublic class Attestation {\r\n\t\r\n\t\r\n\t\r\n\r\n\tstatic double InputNumber(String caption) {\r\n\t\tSystem.out.print(caption);\r\n\t\tScanner sc = new Scanner(System.in);\r\n\t\t\t\r\n\t\tboolean IsError;\r\n\t\tdo {\r\n\t\t\tIsError = !sc.hasNextDouble();\r\n\t\t\tif (IsError) {\r\n\t\t\t\tSystem.out.print(&quot;ERROR: &quot;);\r\n\t\t\t\tsc.nextLine();\r\n\t\t\t}\r\n\t\t} while (IsError);\r\n\t\t\r\n\t\treturn sc.nextDouble();\r\n\t}\r\n\t\t\t\t\r\n\tpublic static void main(String[] args) {\r\n\t\t\r\n\t\t\r\n\t// Entering quantities of numbers\r\n\t\tint count = (int) InputNumber(&quot;enter the number of students: &quot;);\r\n\t\t\r\n\t// Header\r\n\t\tSystem.out.println(&quot;Test ‚Ññ1\\t ‚îÇ Test ‚Ññ2\\t ‚îÇ Test ‚Ññ3&quot;);\r\n\t\tSystem.out.println(&quot;---------------------------------------------&quot;);\r\n\r\n\t// Information input and calculation\r\n\t\tint passed = 0;\r\n\t\tfor (int i = 1; i &lt;= count; i = i + 1) {\r\n\t\t    double number = InputNumber(&quot;enter the grades of the &quot; + i + &quot; student: &quot;);\r\n\t\tif(number &gt;= 7) {\r\n\t\tpassed = passed + 1;\r\n\t\t\t\r\n\t\t}\r\n\t        \r\n\t}\r\n\t\t\r\n\t// Displaying information\r\n\t        System.out.println(&quot;---&quot;);\r\n\t    \tSystem.out.println(passed + &quot; students entered the institute&quot;);\r\n\t    \t\r\n\t    \t\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t\t\r\n```\r\n\r\nI tried to modify the code, but I was constantly getting an error","title":"In my code, you can set a score for 1 test, but I need for three tests","body":"<p>I need to modify my code . So that the user enters the number of students and their grades on three tests, and the program writes to him how many students have entered the institute (passing score = 7, maximum score = 10). I wrote the code for one test and don't know how to write for three.\nThis problem is under the comment: &quot;//Information input and calculation&quot;</p>\n<pre><code>import java.util.Scanner;\n\npublic class Attestation {\n    \n    \n    \n\n    static double InputNumber(String caption) {\n        System.out.print(caption);\n        Scanner sc = new Scanner(System.in);\n            \n        boolean IsError;\n        do {\n            IsError = !sc.hasNextDouble();\n            if (IsError) {\n                System.out.print(&quot;ERROR: &quot;);\n                sc.nextLine();\n            }\n        } while (IsError);\n        \n        return sc.nextDouble();\n    }\n                \n    public static void main(String[] args) {\n        \n        \n    // Entering quantities of numbers\n        int count = (int) InputNumber(&quot;enter the number of students: &quot;);\n        \n    // Header\n        System.out.println(&quot;Test ‚Ññ1\\t ‚îÇ Test ‚Ññ2\\t ‚îÇ Test ‚Ññ3&quot;);\n        System.out.println(&quot;---------------------------------------------&quot;);\n\n    // Information input and calculation\n        int passed = 0;\n        for (int i = 1; i &lt;= count; i = i + 1) {\n            double number = InputNumber(&quot;enter the grades of the &quot; + i + &quot; student: &quot;);\n        if(number &gt;= 7) {\n        passed = passed + 1;\n            \n        }\n            \n    }\n        \n    // Displaying information\n            System.out.println(&quot;---&quot;);\n            System.out.println(passed + &quot; students entered the institute&quot;);\n            \n            \n        }\n\n    }\n\n        \n</code></pre>\n<p>I tried to modify the code, but I was constantly getting an error</p>\n"},{"tags":["java","arrays","spring-boot"],"answers":[{"tags":[],"owner":{"account_id":7291967,"reputation":57515,"user_id":5558072,"accept_rate":100,"display_name":"Youcef LAIDANI"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1672909538,"creation_date":1672909538,"answer_id":75016009,"question_id":75015962,"body_markdown":"You can use stream and `Arrays::asList` which will convert `String[]` to a `List&lt;String&gt;`, like this:\r\n\r\n    List&lt;List&lt;String&gt;&gt; response = allData.stream()\r\n            .map(Arrays::asList)\r\n            .collect(Collectors.toList()); // or just .toList();","title":"How do I convert List of String array to nested list of type String?","body":"<p>You can use stream and <code>Arrays::asList</code> which will convert <code>String[]</code> to a <code>List&lt;String&gt;</code>, like this:</p>\n<pre><code>List&lt;List&lt;String&gt;&gt; response = allData.stream()\n        .map(Arrays::asList)\n        .collect(Collectors.toList()); // or just .toList();\n</code></pre>\n"}],"owner":{"account_id":17183453,"reputation":49,"user_id":12438527,"display_name":"Ayon Moitra"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":100,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"closed_date":1672909553,"accepted_answer_id":75016009,"answer_count":1,"score":0,"last_activity_date":1672909560,"creation_date":1672909337,"question_id":75015962,"body_markdown":"How do I convert `List&lt;String[]&gt;` to `List&lt;List&lt;String&gt;&gt;`?\r\n\r\n    List&lt;String[]&gt; allData = csv.readAll();\r\n\r\nallData needs to be coverted in `List&lt;List&lt;String&gt;&gt;`.\r\n\r\n","title":"How do I convert List of String array to nested list of type String?","body":"<p>How do I convert <code>List&lt;String[]&gt;</code> to <code>List&lt;List&lt;String&gt;&gt;</code>?</p>\n<pre><code>List&lt;String[]&gt; allData = csv.readAll();\n</code></pre>\n<p>allData needs to be coverted in <code>List&lt;List&lt;String&gt;&gt;</code>.</p>\n"},{"tags":["java","spring","eclipse","jakarta-ee"],"comments":[{"owner":{"account_id":5823420,"reputation":785,"user_id":6656833,"display_name":"Pavel"},"score":2,"creation_date":1672904160,"post_id":75015074,"comment_id":132379027,"body_markdown":"have you checked this? https://stackoverflow.com/questions/6800799/replace-string-in-all-files-in-eclipse","body":"have you checked this? <a href=\"https://stackoverflow.com/questions/6800799/replace-string-in-all-files-in-eclipse\" title=\"replace string in all files in eclipse\">stackoverflow.com/questions/6800799/&hellip;</a>"},{"owner":{"account_id":1111280,"reputation":6531,"user_id":1101692,"accept_rate":89,"display_name":"Shark"},"score":0,"creation_date":1672919384,"post_id":75015074,"comment_id":132383655,"body_markdown":"If only there were a &quot;Replace all&quot; kind of functionality in the IDE....","body":"If only there were a &quot;Replace all&quot; kind of functionality in the IDE...."},{"owner":{"account_id":5701984,"reputation":5646,"user_id":4506678,"accept_rate":55,"display_name":"rzo1"},"score":0,"creation_date":1674156014,"post_id":75015074,"comment_id":132660474,"body_markdown":"You can do the SED approach. However, it also requires to carefully review and check libraries used in your app. All libs need to support jakarta namespace ;-)","body":"You can do the SED approach. However, it also requires to carefully review and check libraries used in your app. All libs need to support jakarta namespace ;-)"}],"answers":[{"tags":[],"owner":{"account_id":27439037,"reputation":1,"user_id":20934316,"display_name":"D&#224;rk &#198;k&#241;&#236;ght"},"comment_count":0,"down_vote_count":4,"up_vote_count":0,"is_accepted":false,"score":-4,"last_activity_date":1672908322,"creation_date":1672904744,"answer_id":75015225,"question_id":75015074,"body_markdown":"ctr+shift+o\r\n\r\nI think this will work.\r\n","title":"Replace javax.* package import statements with jakarta.* in all java files at once","body":"<p>ctr+shift+o</p>\n<p>I think this will work.</p>\n"},{"tags":[],"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672909509,"creation_date":1672909076,"answer_id":75015915,"question_id":75015074,"body_markdown":"You could use the Eclipse Transformer tool available from the Apache TomEE project here:\r\n\r\n  https://tomee.apache.org/latest/docs/jakartaee-9/eclipse-transformer.html\r\n\r\n&gt; *&quot;The Eclipse Transformer provides translation from `javax` to `jakarta` on various artifacts, including Java source source, compiled Java classes, along with jar, war and ear files.&quot;*\r\n\r\n\r\nThe README page contains instructions for building the transformer tool and documentation on how to use it.\r\n\r\nAnother alternative would be use Eclipse&#39;s search / replace across your entire codebase; see https://stackoverflow.com/questions/6800799.  However that is potentially risky; e.g. because of the possibility of making mistakes in the patterns that you use.\r\n\r\n","title":"Replace javax.* package import statements with jakarta.* in all java files at once","body":"<p>You could use the Eclipse Transformer tool available from the Apache TomEE project here:</p>\n<p><a href=\"https://tomee.apache.org/latest/docs/jakartaee-9/eclipse-transformer.html\" rel=\"nofollow noreferrer\">https://tomee.apache.org/latest/docs/jakartaee-9/eclipse-transformer.html</a></p>\n<blockquote>\n<p><em>&quot;The Eclipse Transformer provides translation from <code>javax</code> to <code>jakarta</code> on various artifacts, including Java source source, compiled Java classes, along with jar, war and ear files.&quot;</em></p>\n</blockquote>\n<p>The README page contains instructions for building the transformer tool and documentation on how to use it.</p>\n<p>Another alternative would be use Eclipse's search / replace across your entire codebase; see <a href=\"https://stackoverflow.com/questions/6800799\">Replace String in all files in Eclipse</a>.  However that is potentially risky; e.g. because of the possibility of making mistakes in the patterns that you use.</p>\n"}],"owner":{"account_id":13532622,"reputation":541,"user_id":9762633,"display_name":"Abhishek Singh"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":2120,"favorite_count":0,"down_vote_count":2,"up_vote_count":1,"closed_date":1685547775,"answer_count":2,"score":-1,"last_activity_date":1672909509,"creation_date":1672903613,"question_id":75015074,"body_markdown":"Since **javax.*** packages have been replaced with **Jakarta.*** packages in the latest release of spring 6 and hibernate I am facing a bit challenge to **replace all import statements** related to javax.* with Jakarta.* in all files(**1000s of java files**) at once. I am using the latest **eclipse IDE** and have **ubuntu OS**. Right now I am replacing it manually by opening one java file at a time. Is there a way to do this at once for all files?","title":"Replace javax.* package import statements with jakarta.* in all java files at once","body":"<p>Since <strong>javax.</strong>* packages have been replaced with <strong>Jakarta.</strong>* packages in the latest release of spring 6 and hibernate I am facing a bit challenge to <strong>replace all import statements</strong> related to javax.* with Jakarta.* in all files(<strong>1000s of java files</strong>) at once. I am using the latest <strong>eclipse IDE</strong> and have <strong>ubuntu OS</strong>. Right now I am replacing it manually by opening one java file at a time. Is there a way to do this at once for all files?</p>\n"},{"tags":["java","arrays","algorithm"],"comments":[{"owner":{"account_id":1015767,"reputation":2808,"user_id":1027359,"accept_rate":71,"display_name":"dotvav"},"score":6,"creation_date":1438852441,"post_id":31851548,"comment_id":51623217,"body_markdown":"This is a javascript question. This doesn&#39;t make sense in Java.","body":"This is a javascript question. This doesn&#39;t make sense in Java."},{"owner":{"account_id":4910820,"reputation":167,"user_id":3956173,"display_name":"mhGaber"},"score":0,"creation_date":1438852553,"post_id":31851548,"comment_id":51623291,"body_markdown":"I want to solve it in any language, java or javascript","body":"I want to solve it in any language, java or javascript"},{"owner":{"account_id":1726806,"reputation":13951,"user_id":4790924,"accept_rate":67,"display_name":"Sharon Ben Asher"},"score":0,"creation_date":1438852577,"post_id":31851548,"comment_id":51623310,"body_markdown":"we really want to help but I, for one, don&#39;t understand what your asking for. cn you give a Java example for input and desired output?","body":"we really want to help but I, for one, don&#39;t understand what your asking for. cn you give a Java example for input and desired output?"},{"owner":{"account_id":2544160,"reputation":3291,"user_id":2209329,"accept_rate":92,"display_name":"Micha≈Ç Szyd≈Çowski"},"score":2,"creation_date":1438852613,"post_id":31851548,"comment_id":51623339,"body_markdown":"But the method of solving that will be entirely different in Java than in JavaScript...","body":"But the method of solving that will be entirely different in Java than in JavaScript..."},{"owner":{"account_id":1015767,"reputation":2808,"user_id":1027359,"accept_rate":71,"display_name":"dotvav"},"score":0,"creation_date":1438852701,"post_id":31851548,"comment_id":51623397,"body_markdown":"Java does not have mixed-type arrays (where an item could be either an `int` or an `int[]`). It has `List` objects though...","body":"Java does not have mixed-type arrays (where an item could be either an <code>int</code> or an <code>int[]</code>). It has <code>List</code> objects though..."},{"owner":{"account_id":4910820,"reputation":167,"user_id":3956173,"display_name":"mhGaber"},"score":0,"creation_date":1438853265,"post_id":31851548,"comment_id":51623802,"body_markdown":"I have edited the question to show inputs and outputs, hope it&#39;s clear now.","body":"I have edited the question to show inputs and outputs, hope it&#39;s clear now."},{"owner":{"account_id":92555,"reputation":4267,"user_id":253609,"accept_rate":87,"display_name":"conorgriffin"},"score":0,"creation_date":1455630533,"post_id":31851548,"comment_id":58566661,"body_markdown":"Java can have mixed type arrays of objects such as `Object[]` which would accept `Object[]` or `Integer` as elements for example.  One such array containing nested arrays of `Integer` objects could be `new Object[]{1, 2, new Object[]{3, 4, new Object[]{5}, 6, 7}, 8, 9, 10}`","body":"Java can have mixed type arrays of objects such as <code>Object[]</code> which would accept <code>Object[]</code> or <code>Integer</code> as elements for example.  One such array containing nested arrays of <code>Integer</code> objects could be <code>new Object[]{1, 2, new Object[]{3, 4, new Object[]{5}, 6, 7}, 8, 9, 10}</code>"},{"owner":{"account_id":6924256,"reputation":61,"user_id":5315785,"display_name":"Nathan Donaldson"},"score":0,"creation_date":1614072826,"post_id":31851548,"comment_id":117266325,"body_markdown":"I had this question in an interview........My question is.......why would anyone ever do this? This is a sincere question.","body":"I had this question in an interview........My question is.......why would anyone ever do this? This is a sincere question."}],"answers":[{"comments":[{"owner":{"account_id":6383695,"reputation":5206,"user_id":4952262,"accept_rate":71,"display_name":"Michu93"},"score":1,"creation_date":1524744741,"post_id":31852134,"comment_id":87101249,"body_markdown":"OP has array, not string and you return String instead of array.","body":"OP has array, not string and you return String instead of array."}],"tags":[],"owner":{"account_id":6433038,"reputation":56,"user_id":4985432,"display_name":"Beniamin"},"comment_count":1,"down_vote_count":7,"up_vote_count":2,"is_accepted":false,"score":-5,"last_activity_date":1438853813,"creation_date":1438853813,"answer_id":31852134,"question_id":31851548,"body_markdown":"you can try this code:\r\n\r\n    String a = &quot;[[[1],2],[3]],4] &quot;;\r\n    a= a.replaceAll(&quot;[(\\\\[|\\\\])]&quot;, &quot;&quot;);\r\n    String[] b = a.split(&quot;,&quot;);","title":"Flatten nested arrays in java","body":"<p>you can try this code:</p>\n\n<pre><code>String a = \"[[[1],2],[3]],4] \";\na= a.replaceAll(\"[(\\\\[|\\\\])]\", \"\");\nString[] b = a.split(\",\");\n</code></pre>\n"},{"tags":[],"owner":{"account_id":92555,"reputation":4267,"user_id":253609,"accept_rate":87,"display_name":"conorgriffin"},"comment_count":0,"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1455629140,"creation_date":1455629140,"answer_id":35433875,"question_id":31851548,"body_markdown":"I created [a class to solve this][1] using Java, the code is also shown below.\r\n\r\nSolution:\r\n\r\n    package com.conorgriffin.flattener;\r\n    \r\n    import java.util.ArrayList;\r\n    import java.util.Arrays;\r\n    import java.util.List;\r\n    \r\n    /**\r\n     * Flattens an array of arbitrarily nested arrays of integers into a flat array of integers.\r\n     * &lt;p/&gt;\r\n     * @author conorgriffin\r\n     */\r\n    public class IntegerArrayFlattener {\r\n    \r\n        /**\r\n         * Flatten an array of arbitrarily nested arrays of integers into a flat array of integers. e.g. [[1,2,[3]],4] -&gt; [1,2,3,4].\r\n         *\r\n         * @param inputArray an array of Integers or nested arrays of Integers\r\n         * @return flattened array of Integers or null if input is null\r\n         * @throws IllegalArgumentException\r\n         */\r\n        public static Integer[] flatten(Object[] inputArray) throws IllegalArgumentException {\r\n    \r\n            if (inputArray == null) return null;\r\n    \r\n            List&lt;Integer&gt; flatList = new ArrayList&lt;Integer&gt;();\r\n    \r\n            for (Object element : inputArray) {\r\n                if (element instanceof Integer) {\r\n                    flatList.add((Integer) element);\r\n                } else if (element instanceof Object[]) {\r\n                    flatList.addAll(Arrays.asList(flatten((Object[]) element)));\r\n                } else {\r\n                    throw new IllegalArgumentException(&quot;Input must be an array of Integers or nested arrays of Integers&quot;);\r\n                }\r\n            }\r\n            return flatList.toArray(new Integer[flatList.size()]);\r\n        }\r\n    }\r\n\r\n\r\nUnit Tests:\r\n\r\n    package com.conorgriffin.flattener;\r\n    \r\n    import org.junit.Assert;\r\n    import org.junit.Test;\r\n    \r\n    /**\r\n     * Tests IntegerArrayFlattener\r\n     */\r\n    public class IntegerArrayFlattenerTest {\r\n    \r\n        Integer[] expectedArray = new Integer[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 10};\r\n    \r\n        @Test\r\n        public void testNullReturnsNull() throws IllegalArgumentException {\r\n            Assert.assertNull(\r\n                    &quot;Testing a null argument&quot;,\r\n                    IntegerArrayFlattener.flatten(null)\r\n            );\r\n        }\r\n    \r\n        @Test\r\n        public void testEmptyArray() throws IllegalArgumentException {\r\n            Assert.assertArrayEquals(\r\n                    &quot;Testing an empty array&quot;,\r\n                    new Integer[]{},\r\n                    IntegerArrayFlattener.flatten(new Object[]{})\r\n            );\r\n        }\r\n    \r\n        @Test\r\n        public void testFlatArray() throws IllegalArgumentException {\r\n            Assert.assertArrayEquals(\r\n                    &quot;Testing a flat array&quot;,\r\n                    expectedArray,\r\n                    IntegerArrayFlattener.flatten(new Object[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 10})\r\n            );\r\n        }\r\n    \r\n        @Test\r\n        public void testNestedArray() throws IllegalArgumentException {\r\n            Assert.assertArrayEquals(\r\n                    &quot;Testing nested array&quot;,\r\n                    expectedArray,\r\n                    IntegerArrayFlattener.flatten(new Object[]{1, 2, 3, 4, new Object[]{5, 6, 7, 8}, 9, 10})\r\n            );\r\n        }\r\n    \r\n        @Test\r\n        public void testMultipleNestedArrays() throws IllegalArgumentException {\r\n            Assert.assertArrayEquals(\r\n                    &quot;Testing multiple nested arrays&quot;,\r\n                    expectedArray,\r\n                    IntegerArrayFlattener.flatten(new Object[]{1, 2, new Object[]{3, 4, new Object[]{5}, 6, 7}, 8, 9, 10})\r\n            );\r\n        }\r\n    \r\n        @Test(expected = IllegalArgumentException.class)\r\n        public void throwsExceptionForObjectInArray() throws IllegalArgumentException {\r\n            IntegerArrayFlattener.flatten(\r\n                    new Object[]{new Object()}\r\n            );\r\n        }\r\n    \r\n        @Test(expected = IllegalArgumentException.class)\r\n        public void throwsExceptionForObjectInNestedArray() throws IllegalArgumentException {\r\n            IntegerArrayFlattener.flatten(\r\n                    new Object[]{1, 2, new Object[]{3, new Object()}}\r\n            );\r\n        }\r\n    \r\n        @Test(expected = IllegalArgumentException.class)\r\n        public void throwsExceptionForNullInArray() throws IllegalArgumentException {\r\n            IntegerArrayFlattener.flatten(\r\n                    new Object[]{null}\r\n            );\r\n        }\r\n    \r\n        @Test(expected = IllegalArgumentException.class)\r\n        public void throwsExceptionForNullInNestedArray() throws IllegalArgumentException {\r\n            IntegerArrayFlattener.flatten(\r\n                    new Object[]{1, 2, new Object[]{3, null}}\r\n            );\r\n        }\r\n    \r\n    }\r\n\r\n\r\n  [1]: https://github.com/conorgriffin/flattener","title":"Flatten nested arrays in java","body":"<p>I created <a href=\"https://github.com/conorgriffin/flattener\" rel=\"noreferrer\">a class to solve this</a> using Java, the code is also shown below.</p>\n\n<p>Solution:</p>\n\n<pre><code>package com.conorgriffin.flattener;\n\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.List;\n\n/**\n * Flattens an array of arbitrarily nested arrays of integers into a flat array of integers.\n * &lt;p/&gt;\n * @author conorgriffin\n */\npublic class IntegerArrayFlattener {\n\n    /**\n     * Flatten an array of arbitrarily nested arrays of integers into a flat array of integers. e.g. [[1,2,[3]],4] -&gt; [1,2,3,4].\n     *\n     * @param inputArray an array of Integers or nested arrays of Integers\n     * @return flattened array of Integers or null if input is null\n     * @throws IllegalArgumentException\n     */\n    public static Integer[] flatten(Object[] inputArray) throws IllegalArgumentException {\n\n        if (inputArray == null) return null;\n\n        List&lt;Integer&gt; flatList = new ArrayList&lt;Integer&gt;();\n\n        for (Object element : inputArray) {\n            if (element instanceof Integer) {\n                flatList.add((Integer) element);\n            } else if (element instanceof Object[]) {\n                flatList.addAll(Arrays.asList(flatten((Object[]) element)));\n            } else {\n                throw new IllegalArgumentException(\"Input must be an array of Integers or nested arrays of Integers\");\n            }\n        }\n        return flatList.toArray(new Integer[flatList.size()]);\n    }\n}\n</code></pre>\n\n<p>Unit Tests:</p>\n\n<pre><code>package com.conorgriffin.flattener;\n\nimport org.junit.Assert;\nimport org.junit.Test;\n\n/**\n * Tests IntegerArrayFlattener\n */\npublic class IntegerArrayFlattenerTest {\n\n    Integer[] expectedArray = new Integer[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 10};\n\n    @Test\n    public void testNullReturnsNull() throws IllegalArgumentException {\n        Assert.assertNull(\n                \"Testing a null argument\",\n                IntegerArrayFlattener.flatten(null)\n        );\n    }\n\n    @Test\n    public void testEmptyArray() throws IllegalArgumentException {\n        Assert.assertArrayEquals(\n                \"Testing an empty array\",\n                new Integer[]{},\n                IntegerArrayFlattener.flatten(new Object[]{})\n        );\n    }\n\n    @Test\n    public void testFlatArray() throws IllegalArgumentException {\n        Assert.assertArrayEquals(\n                \"Testing a flat array\",\n                expectedArray,\n                IntegerArrayFlattener.flatten(new Object[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 10})\n        );\n    }\n\n    @Test\n    public void testNestedArray() throws IllegalArgumentException {\n        Assert.assertArrayEquals(\n                \"Testing nested array\",\n                expectedArray,\n                IntegerArrayFlattener.flatten(new Object[]{1, 2, 3, 4, new Object[]{5, 6, 7, 8}, 9, 10})\n        );\n    }\n\n    @Test\n    public void testMultipleNestedArrays() throws IllegalArgumentException {\n        Assert.assertArrayEquals(\n                \"Testing multiple nested arrays\",\n                expectedArray,\n                IntegerArrayFlattener.flatten(new Object[]{1, 2, new Object[]{3, 4, new Object[]{5}, 6, 7}, 8, 9, 10})\n        );\n    }\n\n    @Test(expected = IllegalArgumentException.class)\n    public void throwsExceptionForObjectInArray() throws IllegalArgumentException {\n        IntegerArrayFlattener.flatten(\n                new Object[]{new Object()}\n        );\n    }\n\n    @Test(expected = IllegalArgumentException.class)\n    public void throwsExceptionForObjectInNestedArray() throws IllegalArgumentException {\n        IntegerArrayFlattener.flatten(\n                new Object[]{1, 2, new Object[]{3, new Object()}}\n        );\n    }\n\n    @Test(expected = IllegalArgumentException.class)\n    public void throwsExceptionForNullInArray() throws IllegalArgumentException {\n        IntegerArrayFlattener.flatten(\n                new Object[]{null}\n        );\n    }\n\n    @Test(expected = IllegalArgumentException.class)\n    public void throwsExceptionForNullInNestedArray() throws IllegalArgumentException {\n        IntegerArrayFlattener.flatten(\n                new Object[]{1, 2, new Object[]{3, null}}\n        );\n    }\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8469162,"reputation":444,"user_id":6352416,"accept_rate":61,"display_name":"Alien"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1485723987,"creation_date":1485723987,"answer_id":41925959,"question_id":31851548,"body_markdown":"This is how I solved this problem in Java: \r\n\r\n    public class ArrayUtil {\r\n    \r\n    \t/**\r\n    \t * Utility to flatten an array of arbitrarily nested arrays of integers into\r\n    \t * a flat array of integers. e.g. [[1,2,[3]],4] -&gt; [1,2,3,4]\r\n    \t * @param inputList\r\n    \t */\r\n    \tpublic static Integer[] flattenArray(ArrayList&lt;Object&gt; inputList) {\r\n    \t\t\r\n    \t\tArrayList&lt;Integer&gt; flatten = new ArrayList&lt;Integer&gt;();\r\n    \t\tif (inputList.size() &lt;= 0) {\r\n    \t\t\treturn new Integer[0];\t\t\t\t\t\t\t// if the inputList is empty, return an empty Integer[] array.\r\n    \t\t}\r\n    \r\n    \t\tfor (Object obj : inputList) {\r\n    \t\t\trecursiveFlatten(flatten, obj);\t\t\t\t\t// otherwise we can recursively flatten the input list.\r\n    \t\t}\r\n    \t\t\r\n    \t\tInteger [] flatArray = new Integer[flatten.size()];\r\n    \t\treturn flatArray = flatten.toArray(flatArray);\t\t\r\n    \t}\r\n    \t\r\n    \t/**\r\n    \t * Recursively flatten a nested array.\r\n    \t * @param flatten\r\n    \t * @param o\r\n    \t */\r\n    \tprivate static void recursiveFlatten(ArrayList&lt;Integer&gt; flatten, Object o){\r\n    \t\tif(isInteger(o)){\t\t\t\t\t\t\t\t// if the object is of type Integer, just add it into the list.\r\n    \t\t\tflatten.add((Integer)o);\r\n    \t\t} else if(o instanceof ArrayList){\t\t\t\t// otherwise, we need to call to recursively flatten the array\r\n    \t\t\tfor(Object obj : (ArrayList&lt;Object&gt;) o){\t// for the case where there are deeply nested arrays.\r\n    \t\t\t\trecursiveFlatten(flatten, obj);\r\n    \t\t\t}\r\n    \t\t}\r\n    \t}\r\n    \r\n    \t/**\r\n    \t * Return true if object belongs to Integer class,\r\n    \t * else return false.\r\n    \t * @param obj\r\n    \t * @return\r\n    \t */\r\n    \tprivate static boolean isInteger(Object obj) {\r\n    \t\treturn obj instanceof Integer;\r\n    \t}\r\n    \t\r\n    }","title":"Flatten nested arrays in java","body":"<p>This is how I solved this problem in Java: </p>\n\n<pre><code>public class ArrayUtil {\n\n    /**\n     * Utility to flatten an array of arbitrarily nested arrays of integers into\n     * a flat array of integers. e.g. [[1,2,[3]],4] -&gt; [1,2,3,4]\n     * @param inputList\n     */\n    public static Integer[] flattenArray(ArrayList&lt;Object&gt; inputList) {\n\n        ArrayList&lt;Integer&gt; flatten = new ArrayList&lt;Integer&gt;();\n        if (inputList.size() &lt;= 0) {\n            return new Integer[0];                          // if the inputList is empty, return an empty Integer[] array.\n        }\n\n        for (Object obj : inputList) {\n            recursiveFlatten(flatten, obj);                 // otherwise we can recursively flatten the input list.\n        }\n\n        Integer [] flatArray = new Integer[flatten.size()];\n        return flatArray = flatten.toArray(flatArray);      \n    }\n\n    /**\n     * Recursively flatten a nested array.\n     * @param flatten\n     * @param o\n     */\n    private static void recursiveFlatten(ArrayList&lt;Integer&gt; flatten, Object o){\n        if(isInteger(o)){                               // if the object is of type Integer, just add it into the list.\n            flatten.add((Integer)o);\n        } else if(o instanceof ArrayList){              // otherwise, we need to call to recursively flatten the array\n            for(Object obj : (ArrayList&lt;Object&gt;) o){    // for the case where there are deeply nested arrays.\n                recursiveFlatten(flatten, obj);\n            }\n        }\n    }\n\n    /**\n     * Return true if object belongs to Integer class,\n     * else return false.\n     * @param obj\n     * @return\n     */\n    private static boolean isInteger(Object obj) {\n        return obj instanceof Integer;\n    }\n\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":4806935,"reputation":666,"user_id":3881672,"accept_rate":100,"display_name":"Doopy"},"score":0,"creation_date":1535544214,"post_id":44909768,"comment_id":91103626,"body_markdown":"Sadly, this doesn&#39;t work if the inner arrays are of primitive type like int[], because the `o instanceof Object[]` check fails and primitive arrays cannot be cast to object arrays.","body":"Sadly, this doesn&#39;t work if the inner arrays are of primitive type like int[], because the <code>o instanceof Object[]</code> check fails and primitive arrays cannot be cast to object arrays."},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1535545794,"post_id":44909768,"comment_id":91104663,"body_markdown":"@DQQpy for primitive arrays, no recursion is necessary, as primitive arrays can‚Äôt contain arrays, so you could use `.flatMap(o -&gt; o instanceof int[]? Arrays.stream((int[])o).boxed(): o instanceof Object[]? flatten((Object[])o): Stream.of(o));` or, to invariably map to `int` values, `public static IntStream flattenToInt(Object o) { return o instanceof int[]? Arrays.stream((int[])o): o instanceof Object[]? Arrays.stream((Object[])o) .flatMapToInt(x -&gt; flattenToInt(x)): IntStream.of(((Number)o).intValue()); }`","body":"@DQQpy for primitive arrays, no recursion is necessary, as primitive arrays can‚Äôt contain arrays, so you could use <code>.flatMap(o -&gt; o instanceof int[]? Arrays.stream((int[])o).boxed(): o instanceof Object[]? flatten((Object[])o): Stream.of(o));</code> or, to invariably map to <code>int</code> values, <code>public static IntStream flattenToInt(Object o) { return o instanceof int[]? Arrays.stream((int[])o): o instanceof Object[]? Arrays.stream((Object[])o) .flatMapToInt(x -&gt; flattenToInt(x)): IntStream.of(((Number)o).intValue()); }</code>"},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1535546052,"post_id":44909768,"comment_id":91104837,"body_markdown":"If the input type is a regular array like `int[][][]`, the operation would be even simpler, as no recursion would be necessary, you just need *n-1* `flatMap` steps for *n* dimensions, `static IntStream flatten(int[][][] array) { return Arrays.stream(array).flatMap(Arrays::stream) .flatMapToInt(Arrays::stream); }`","body":"If the input type is a regular array like <code>int[][][]</code>, the operation would be even simpler, as no recursion would be necessary, you just need <i>n-1</i> <code>flatMap</code> steps for <i>n</i> dimensions, <code>static IntStream flatten(int[][][] array) { return Arrays.stream(array).flatMap(Arrays::stream) .flatMapToInt(Arrays::stream); }</code>"},{"owner":{"account_id":4806935,"reputation":666,"user_id":3881672,"accept_rate":100,"display_name":"Doopy"},"score":0,"creation_date":1535549055,"post_id":44909768,"comment_id":91107036,"body_markdown":"Good point, but if the inner arrays are of mixed types it becomes really complicated with all the case differentations. I can&#39;t find a better solution though","body":"Good point, but if the inner arrays are of mixed types it becomes really complicated with all the case differentations. I can&#39;t find a better solution though"},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":2,"creation_date":1535550047,"post_id":44909768,"comment_id":91107722,"body_markdown":"@DQQpy you can handle all array types generically using `java.lang.reflect.Array`, if you wish: `static Stream&lt;Object&gt; flatten(Object o) { return o != null &amp;&amp; o.getClass().isArray()? IntStream.range(0, Array.getLength(o)).mapToObj(ix -&gt; Array.get(o, ix)).flatMap(x -&gt; flatten(x)): Stream.of(o); }`","body":"@DQQpy you can handle all array types generically using <code>java.lang.reflect.Array</code>, if you wish: <code>static Stream&lt;Object&gt; flatten(Object o) { return o != null &amp;&amp; o.getClass().isArray()? IntStream.range(0, Array.getLength(o)).mapToObj(ix -&gt; Array.get(o, ix)).flatMap(x -&gt; flatten(x)): Stream.of(o); }</code>"}],"tags":[],"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"comment_count":5,"down_vote_count":0,"up_vote_count":23,"is_accepted":false,"score":23,"last_activity_date":1670867700,"creation_date":1499182356,"answer_id":44909768,"question_id":31851548,"body_markdown":"The Stream API offers a compact and flexible solution. Using the method\r\n\r\n```java\r\nprivate static Stream&lt;Object&gt; flatten(Object[] array) {\r\n    return Arrays.stream(array)\r\n        .flatMap(o -&gt; o instanceof Object[] a? flatten(a): Stream.of(o));\r\n}\r\n```\r\n\r\nor prior to JDK&#160;16\r\n```java\r\nprivate static Stream&lt;Object&gt; flatten(Object[] array) {\r\n    return Arrays.stream(array)\r\n        .flatMap(o -&gt; o instanceof Object[]? flatten((Object[])o): Stream.of(o));\r\n}\r\n```\r\nyou can perform the operation as\r\n\r\n    Object[] array = { 1, 2, new Object[]{ 3, 4, new Object[]{ 5 }, 6, 7 }, 8, 9, 10 };\r\n    System.out.println(&quot;original: &quot;+Arrays.deepToString(array));\r\n\r\n    Object[] flat = flatten(array).toArray();\r\n    System.out.println(&quot;flat:     &quot;+Arrays.toString(flat));\r\n\r\nor when you assume the leaf objects to be of a specific type:\r\n\r\n    int[] flatInt = flatten(array).mapToInt(Integer.class::cast).toArray();\r\n    System.out.println(&quot;flat int: &quot;+Arrays.toString(flatInt));\r\n\r\n\r\n","title":"Flatten nested arrays in java","body":"<p>The Stream API offers a compact and flexible solution. Using the method</p>\n<pre class=\"lang-java prettyprint-override\"><code>private static Stream&lt;Object&gt; flatten(Object[] array) {\n    return Arrays.stream(array)\n        .flatMap(o -&gt; o instanceof Object[] a? flatten(a): Stream.of(o));\n}\n</code></pre>\n<p>or prior to JDK¬†16</p>\n<pre class=\"lang-java prettyprint-override\"><code>private static Stream&lt;Object&gt; flatten(Object[] array) {\n    return Arrays.stream(array)\n        .flatMap(o -&gt; o instanceof Object[]? flatten((Object[])o): Stream.of(o));\n}\n</code></pre>\n<p>you can perform the operation as</p>\n<pre><code>Object[] array = { 1, 2, new Object[]{ 3, 4, new Object[]{ 5 }, 6, 7 }, 8, 9, 10 };\nSystem.out.println(&quot;original: &quot;+Arrays.deepToString(array));\n\nObject[] flat = flatten(array).toArray();\nSystem.out.println(&quot;flat:     &quot;+Arrays.toString(flat));\n</code></pre>\n<p>or when you assume the leaf objects to be of a specific type:</p>\n<pre><code>int[] flatInt = flatten(array).mapToInt(Integer.class::cast).toArray();\nSystem.out.println(&quot;flat int: &quot;+Arrays.toString(flatInt));\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3878613,"reputation":21,"user_id":3211854,"display_name":"Gaurav Mazra"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1524744423,"creation_date":1524744423,"answer_id":50042580,"question_id":31851548,"body_markdown":"It could be flattened by iterative approach.\r\n\r\n    static class ArrayHolder implements Iterator&lt;Object&gt; {\r\n\t\tprivate final Object[] elements;\r\n\t\tprivate int index = -1;\r\n\r\n\t\tpublic ArrayHolder(final Object[] elements) {\r\n\t\t\tthis.elements = elements;\r\n\t\t}\r\n\r\n\t\t@Override\r\n\t\tpublic boolean hasNext() {\r\n\t\t\treturn Objects.nonNull(elements) &amp;&amp; ++index &lt; elements.length;\r\n\t\t}\r\n\r\n\t\t@Override\r\n\t\tpublic Object next() {\r\n\t\t\tif (Objects.isNull(elements) || (index == -1 || index &gt; elements.length))\r\n\t\t\t\tthrow new NoSuchElementException();\r\n\r\n\t\t\treturn elements[index];\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\tprivate static boolean hasNext(ArrayHolder current) {\r\n\t\treturn Objects.nonNull(current) &amp;&amp; current.hasNext();\r\n\t}\r\n\r\n    private void flat(Object[] elements, List&lt;Object&gt; flattened) {\r\n\t\tDeque&lt;ArrayHolder&gt; stack = new LinkedList&lt;&gt;();\r\n\t\tstack.push(new ArrayHolder(elements));\r\n\r\n\t\tArrayHolder current = null;\r\n\t\twhile (hasNext(current)\r\n\t\t\t\t|| (!stack.isEmpty() &amp;&amp; hasNext(current = stack.pop()))) {\r\n\t\t\tObject element = current.next();\r\n\r\n\t\t\tif (Objects.nonNull(element) &amp;&amp; element.getClass().isArray()) {\r\n\t\t\t\tObject[] e = (Object[]) element;\r\n\t\t\t\tstack.push(current);\r\n\t\t\t\tstack.push(new ArrayHolder(e));\r\n\t\t\t\tcurrent = null;\r\n\t\t\t} else {\r\n\t\t\t\tflattened.add(element);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\nYou can find the full source [here][1]\r\nYou can use recursion to solve this problem.\r\n\r\n    private void flat(Object[] elements, List&lt;Object&gt; flattened) {\r\n\t\tfor (Object element : elements)\r\n\t\t{\r\n\t\t\tif (Objects.nonNull(element) &amp;&amp; element.getClass().isArray())\r\n\t\t\t{\r\n\t\t\t\tflat((Object[])element, flattened);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tflattened.add(element);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\nHere is the link for [recursion][2].\r\n\r\n\r\n  [1]: https://github.com/gauravrmazra/gauravbytes/blob/master/algorithms/src/main/java/com/gauravbytes/algorithms/array/flat/IterativeArrayFlatner.java\r\n  [2]: https://github.com/gauravrmazra/gauravbytes/blob/master/algorithms/src/main/java/com/gauravbytes/algorithms/array/flat/RecursiveArrayFlatner.java","title":"Flatten nested arrays in java","body":"<p>It could be flattened by iterative approach.</p>\n\n<pre><code>static class ArrayHolder implements Iterator&lt;Object&gt; {\n    private final Object[] elements;\n    private int index = -1;\n\n    public ArrayHolder(final Object[] elements) {\n        this.elements = elements;\n    }\n\n    @Override\n    public boolean hasNext() {\n        return Objects.nonNull(elements) &amp;&amp; ++index &lt; elements.length;\n    }\n\n    @Override\n    public Object next() {\n        if (Objects.isNull(elements) || (index == -1 || index &gt; elements.length))\n            throw new NoSuchElementException();\n\n        return elements[index];\n    }\n}\n\n\nprivate static boolean hasNext(ArrayHolder current) {\n    return Objects.nonNull(current) &amp;&amp; current.hasNext();\n}\n\nprivate void flat(Object[] elements, List&lt;Object&gt; flattened) {\n    Deque&lt;ArrayHolder&gt; stack = new LinkedList&lt;&gt;();\n    stack.push(new ArrayHolder(elements));\n\n    ArrayHolder current = null;\n    while (hasNext(current)\n            || (!stack.isEmpty() &amp;&amp; hasNext(current = stack.pop()))) {\n        Object element = current.next();\n\n        if (Objects.nonNull(element) &amp;&amp; element.getClass().isArray()) {\n            Object[] e = (Object[]) element;\n            stack.push(current);\n            stack.push(new ArrayHolder(e));\n            current = null;\n        } else {\n            flattened.add(element);\n        }\n    }\n}\n</code></pre>\n\n<p>You can find the full source <a href=\"https://github.com/gauravrmazra/gauravbytes/blob/master/algorithms/src/main/java/com/gauravbytes/algorithms/array/flat/IterativeArrayFlatner.java\" rel=\"nofollow noreferrer\">here</a>\nYou can use recursion to solve this problem.</p>\n\n<pre><code>private void flat(Object[] elements, List&lt;Object&gt; flattened) {\n    for (Object element : elements)\n    {\n        if (Objects.nonNull(element) &amp;&amp; element.getClass().isArray())\n        {\n            flat((Object[])element, flattened);\n        }\n        else\n        {\n            flattened.add(element);\n        }\n    }\n}\n</code></pre>\n\n<p>Here is the link for <a href=\"https://github.com/gauravrmazra/gauravbytes/blob/master/algorithms/src/main/java/com/gauravbytes/algorithms/array/flat/RecursiveArrayFlatner.java\" rel=\"nofollow noreferrer\">recursion</a>.</p>\n"},{"comments":[{"owner":{"account_id":9727822,"reputation":187,"user_id":7214070,"display_name":"Johann"},"score":0,"creation_date":1621843417,"post_id":52389199,"comment_id":119607103,"body_markdown":"You can just do `array.flat(Infinity)`, which is much shorter.","body":"You can just do <code>array.flat(Infinity)</code>, which is much shorter."}],"tags":[],"owner":{"account_id":3064759,"reputation":872,"user_id":2596716,"accept_rate":17,"display_name":"Renan Cidale"},"comment_count":1,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1537281954,"creation_date":1537281954,"answer_id":52389199,"question_id":31851548,"body_markdown":"That&#39;s the way I would solve it.\r\nDon&#39;t know which kind of efficiency you are looking for. But yeah. that does the job in JavaScript.\r\n\r\n`arr.toString().split(&#39;,&#39;).filter((item) =&gt; item).map((item) =&gt; Number(item))`\r\n\r\nA probably more efficient way to do this would be to use reduce and concat method from arr and recursion.\r\n\r\n    function flattenDeep(arr1) {\r\n       return arr1.reduce((acc, val) =&gt; Array.isArray(val) ? acc.concat(flattenDeep(val)) : acc.concat(val), []);\r\n    }","title":"Flatten nested arrays in java","body":"<p>That's the way I would solve it.\nDon't know which kind of efficiency you are looking for. But yeah. that does the job in JavaScript.</p>\n\n<p><code>arr.toString().split(',').filter((item) =&gt; item).map((item) =&gt; Number(item))</code></p>\n\n<p>A probably more efficient way to do this would be to use reduce and concat method from arr and recursion.</p>\n\n<pre><code>function flattenDeep(arr1) {\n   return arr1.reduce((acc, val) =&gt; Array.isArray(val) ? acc.concat(flattenDeep(val)) : acc.concat(val), []);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1819449,"reputation":4899,"user_id":1653808,"display_name":"Alex Joseph"},"comment_count":0,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1623573200,"creation_date":1623571977,"answer_id":67956179,"question_id":31851548,"body_markdown":"\r\nIf it&#39;s a primitive array with only two levels, you could do:\r\n\r\n    Arrays.stream(array)\r\n      .flatMapToInt(o -&gt; Arrays.stream(o))\r\n      .toArray()\r\n\r\nto get the corresponding boxed array (which you can unbox if necessary)","title":"Flatten nested arrays in java","body":"<p>If it's a primitive array with only two levels, you could do:</p>\n<pre><code>Arrays.stream(array)\n  .flatMapToInt(o -&gt; Arrays.stream(o))\n  .toArray()\n</code></pre>\n<p>to get the corresponding boxed array (which you can unbox if necessary)</p>\n"},{"tags":[],"owner":{"account_id":15510178,"reputation":11,"user_id":11189122,"display_name":"vignesh Devendran"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1658999569,"creation_date":1658825168,"answer_id":73120312,"question_id":31851548,"body_markdown":"The recursive call approach will work for this case:\r\n\r\n```java\r\nprivate static void recursiveCall(Object[] array) {\r\n\r\n\t\tfor (int i=0;i&lt;array.length;i++) {\r\n\t\t\tif (array[i] instanceof Object[]) {\r\n\t\t\t\trecursiveCall((Object[]) array[i]);\r\n\t\t\t}else {\r\n\t\t\t\tSystem.out.println(array[i]);\r\n\t\t\t}\r\n\t\t\t\r\n\t}\r\n\t\t\r\n}\r\n```","title":"Flatten nested arrays in java","body":"<p>The recursive call approach will work for this case:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private static void recursiveCall(Object[] array) {\n\n        for (int i=0;i&lt;array.length;i++) {\n            if (array[i] instanceof Object[]) {\n                recursiveCall((Object[]) array[i]);\n            }else {\n                System.out.println(array[i]);\n            }\n            \n    }\n        \n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1672894055,"post_id":75009493,"comment_id":132377190,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/75009493/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":17946118,"reputation":3,"user_id":13040360,"display_name":"Er prince kumar ojha"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672855335,"creation_date":1672855335,"answer_id":75009493,"question_id":31851548,"body_markdown":"package com.app;\r\n\r\nimport java.util.Arrays;\r\n\r\npublic class Test2 {\r\n\r\n\tpublic static void main(String[] args) {\r\n\r\n\t\tObject arr[] = { 1, 2, new Object[] { 4, new int[] { 5, 6 }, 7 }, 10 };\r\n\t\tString deepToString = Arrays.deepToString(arr);\r\n\t\tString replace = deepToString.replace(&quot;[&quot;, &quot;&quot;).replace(&quot;]&quot;, &quot;&quot;);\r\n\t\tString array[] = replace.split(&quot;,&quot;);\r\n\t\tint temp[] = new int[array.length];\r\n\t\tfor (int i = 0; i &lt; array.length; i++) {\r\n\t\t\ttemp[i] = Integer.parseInt(array[i].trim());\r\n\t\t}\r\n\t\tSystem.out.println(Arrays.toString(temp));\r\n\t}\r\n}\r\n","title":"Flatten nested arrays in java","body":"<p>package com.app;</p>\n<p>import java.util.Arrays;</p>\n<p>public class Test2 {</p>\n<pre><code>public static void main(String[] args) {\n\n    Object arr[] = { 1, 2, new Object[] { 4, new int[] { 5, 6 }, 7 }, 10 };\n    String deepToString = Arrays.deepToString(arr);\n    String replace = deepToString.replace(&quot;[&quot;, &quot;&quot;).replace(&quot;]&quot;, &quot;&quot;);\n    String array[] = replace.split(&quot;,&quot;);\n    int temp[] = new int[array.length];\n    for (int i = 0; i &lt; array.length; i++) {\n        temp[i] = Integer.parseInt(array[i].trim());\n    }\n    System.out.println(Arrays.toString(temp));\n}\n</code></pre>\n<p>}</p>\n"}],"owner":{"account_id":4910820,"reputation":167,"user_id":3956173,"display_name":"mhGaber"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":36899,"favorite_count":0,"down_vote_count":2,"up_vote_count":15,"answer_count":9,"score":13,"last_activity_date":1672909414,"creation_date":1438852304,"question_id":31851548,"body_markdown":"I want to flatten nested arrays like:\r\n\r\n    [[[1],2],[3]],4] -&gt; [1,2,3,4] \r\n\r\nmanually in java I can&#39;t find a clue ! :S \r\n\r\nI have tried a manual java script guide but it doesn&#39;t get a solution\r\n```java\r\npublic static void main(String[] args) {\r\n\r\n  Object arr[] = { 1, 2, new Object[] { 4, new int[] { 5, 6 }, 7 }, 10 };\r\n  String deepToString = Arrays.deepToString(arr);\r\n  String replace = deepToString.replace(&quot;[&quot;, &quot;&quot;).replace(&quot;]&quot;, &quot;&quot;);\r\n  String array[] = replace.split(&quot;,&quot;);\r\n  int temp[] = new int[array.length];\r\n  for (int i = 0; i &lt; array.length; i++) {\r\n    temp[i] = Integer.parseInt(array[i].trim());\r\n  }\r\n  System.out.println(Arrays.toString(temp));\r\n}\r\n```   ","title":"Flatten nested arrays in java","body":"<p>I want to flatten nested arrays like:</p>\n<pre><code>[[[1],2],[3]],4] -&gt; [1,2,3,4] \n</code></pre>\n<p>manually in java I can't find a clue ! :S</p>\n<p>I have tried a manual java script guide but it doesn't get a solution</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static void main(String[] args) {\n\n  Object arr[] = { 1, 2, new Object[] { 4, new int[] { 5, 6 }, 7 }, 10 };\n  String deepToString = Arrays.deepToString(arr);\n  String replace = deepToString.replace(&quot;[&quot;, &quot;&quot;).replace(&quot;]&quot;, &quot;&quot;);\n  String array[] = replace.split(&quot;,&quot;);\n  int temp[] = new int[array.length];\n  for (int i = 0; i &lt; array.length; i++) {\n    temp[i] = Integer.parseInt(array[i].trim());\n  }\n  System.out.println(Arrays.toString(temp));\n}\n</code></pre>\n"},{"tags":["java","spring-boot","postman","backend","request-headers"],"comments":[{"owner":{"account_id":6948780,"reputation":431,"user_id":5332102,"display_name":"G&#246;khan Polat"},"score":0,"creation_date":1672863114,"post_id":75010534,"comment_id":132371333,"body_markdown":"You&#39;re using both header and request param in same request. Fetching value method of these two are different. Are you somehow mixing up them? If you share how you fetch, we can help more","body":"You&#39;re using both header and request param in same request. Fetching value method of these two are different. Are you somehow mixing up them? If you share how you fetch, we can help more"},{"owner":{"account_id":3391382,"reputation":3687,"user_id":2846138,"display_name":"cyberbrain"},"score":0,"creation_date":1672864005,"post_id":75010534,"comment_id":132371620,"body_markdown":"did you try to use `@RequestHeader(value=&quot;email&quot;...)` instead of `@RequestHeader(name=&quot;email&quot;...)` ?","body":"did you try to use <code>@RequestHeader(value=&quot;email&quot;...)</code> instead of <code>@RequestHeader(name=&quot;email&quot;...)</code> ?"},{"owner":{"account_id":6323627,"reputation":11,"user_id":12854343,"display_name":"ktb"},"score":0,"creation_date":1672864887,"post_id":75010534,"comment_id":132371876,"body_markdown":"@cyberbrain, yes I tried doing both. It&#39;s not working","body":"@cyberbrain, yes I tried doing both. It&#39;s not working"},{"owner":{"account_id":6323627,"reputation":11,"user_id":12854343,"display_name":"ktb"},"score":0,"creation_date":1672864964,"post_id":75010534,"comment_id":132371894,"body_markdown":"@G&#246;khanPolat, I don&#39;t want to expose the email in the query param or the request param, hence using the headers","body":"@G&#246;khanPolat, I don&#39;t want to expose the email in the query param or the request param, hence using the headers"},{"owner":{"account_id":300800,"reputation":10941,"user_id":608164,"accept_rate":62,"display_name":"30thh"},"score":0,"creation_date":1672867238,"post_id":75010534,"comment_id":132372589,"body_markdown":"Did you try another names? It is possible you have some old proxy or filter in between, which doesn&#39;t like a custom header with the name &quot;email&quot;.","body":"Did you try another names? It is possible you have some old proxy or filter in between, which doesn&#39;t like a custom header with the name &quot;email&quot;."},{"owner":{"account_id":13730022,"reputation":309,"user_id":9907751,"display_name":"Firok"},"score":0,"creation_date":1672885888,"post_id":75010534,"comment_id":132376036,"body_markdown":"`@GetMapping(&quot;/test&quot;) String test(@RequestHeader(value = &quot;email&quot;, required = false) String email) { return email; }` just works well","body":"<code>@GetMapping(&quot;&#47;test&quot;) String test(@RequestHeader(value = &quot;email&quot;, required = false) String email) { return email; }</code> just works well"}],"owner":{"account_id":6323627,"reputation":11,"user_id":12854343,"display_name":"ktb"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":204,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672909411,"creation_date":1672861487,"question_id":75010534,"body_markdown":"I have an api which looks like this:\r\n\r\n```java\r\n@Get\r\n@Path(&quot;/{user_id}&quot;)\r\npublic Response getUser(@RequestHeader(name=&quot;email&quot;, required = false) String email, @PathParam(&quot;user_id&quot;) String userId, @QueryParam(&quot;pref&quot;) Boolean pref)\r\n```\r\n\r\nWhen I am sending a sample request through postman, I am not able to fetch the value of email even though i am providing it in the headers. It keeps showing `email: &quot;&quot;`\r\n\r\nWhat am I missing?\r\n\r\nI have tried changing some configs but its of no use. Maybe I am missing something. ","title":"How to send custom headers in spring boot GET Request?","body":"<p>I have an api which looks like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Get\n@Path(&quot;/{user_id}&quot;)\npublic Response getUser(@RequestHeader(name=&quot;email&quot;, required = false) String email, @PathParam(&quot;user_id&quot;) String userId, @QueryParam(&quot;pref&quot;) Boolean pref)\n</code></pre>\n<p>When I am sending a sample request through postman, I am not able to fetch the value of email even though i am providing it in the headers. It keeps showing <code>email: &quot;&quot;</code></p>\n<p>What am I missing?</p>\n<p>I have tried changing some configs but its of no use. Maybe I am missing something.</p>\n"},{"tags":["java","android","webrtc","webrtc-android"],"owner":{"account_id":2658237,"reputation":584,"user_id":2298490,"display_name":"grill2010"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":319,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":0,"score":3,"last_activity_date":1672909356,"creation_date":1672909356,"question_id":75015968,"body_markdown":"I&#39;m currently using a self compiled WebRtc lib for my Android project and I try to get lowest latency for game streaming/ cloud gaming. I found out that on browsers you can use playoutDelayHint and or jitterBufferDelayHint to fine tune latency and how the underlying peer connection will handle things.\r\n\r\nhttps://discourse.wicg.io/t/hint-attribute-in-webrtc-to-influence-underlying-audio-video-buffering/4038\r\n\r\nUnfortunately I have no idea of how to use these functionality within a native WebRtc project (no browser)?\r\n\r\nIs there a way to access and modify these flags in a native project and if not what actually must be adjusted in the WebRtc lib to achieve the same result? As I compile the WebRtc lib by my own I could just add this functionality by my own, I just don&#39;t have any idea what the playoutDelayHint and jitterBufferDelayHint flag is modifying in the background?\r\n\r\nI found this in the native code which could be the correct part for the playbackDelayHint but not sure\r\n\r\nhttps://github.com/maitrungduc1410/webrtc/blob/c2b1bad4c87a43d7e1af85e809d5abe04baf3104/api/video/video_timing.h#L116","title":"How to use playoutDelayHint and jitterBufferDelayHint in a Native WebRtc Java project","body":"<p>I'm currently using a self compiled WebRtc lib for my Android project and I try to get lowest latency for game streaming/ cloud gaming. I found out that on browsers you can use playoutDelayHint and or jitterBufferDelayHint to fine tune latency and how the underlying peer connection will handle things.</p>\n<p><a href=\"https://discourse.wicg.io/t/hint-attribute-in-webrtc-to-influence-underlying-audio-video-buffering/4038\" rel=\"nofollow noreferrer\">https://discourse.wicg.io/t/hint-attribute-in-webrtc-to-influence-underlying-audio-video-buffering/4038</a></p>\n<p>Unfortunately I have no idea of how to use these functionality within a native WebRtc project (no browser)?</p>\n<p>Is there a way to access and modify these flags in a native project and if not what actually must be adjusted in the WebRtc lib to achieve the same result? As I compile the WebRtc lib by my own I could just add this functionality by my own, I just don't have any idea what the playoutDelayHint and jitterBufferDelayHint flag is modifying in the background?</p>\n<p>I found this in the native code which could be the correct part for the playbackDelayHint but not sure</p>\n<p><a href=\"https://github.com/maitrungduc1410/webrtc/blob/c2b1bad4c87a43d7e1af85e809d5abe04baf3104/api/video/video_timing.h#L116\" rel=\"nofollow noreferrer\">https://github.com/maitrungduc1410/webrtc/blob/c2b1bad4c87a43d7e1af85e809d5abe04baf3104/api/video/video_timing.h#L116</a></p>\n"},{"tags":["java","exception","throws"],"owner":{"account_id":26954951,"reputation":11,"user_id":20523507,"display_name":"Brian M"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":21,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1672909335,"creation_date":1672718098,"question_id":74988907,"body_markdown":"I had a question about the `throws` keyword in the code below. In the method testLoop3() I am indicating that the `IndexOutOfBoundsException` may be thrown with the throws keyword. But the method testLoop() is identical except it does not show that exception being thrown. What is the purpose of including throws IndexOutOfBoundsException if the exception is being sent to the calling method in both cases and the output is exactly the same? I read that the throws keyword is to make the caller of method aware of the exception and force the caller to handle it in the last line of the main() method it is not handling it.\r\n\r\n\r\n```java\r\npackage exceptions;\r\n\r\nimport java.util.ArrayList;\r\n\r\npublic class TestException {\r\n\r\n  public static void main(String[] args) {\r\n    \r\n    System.out.println(&quot;------------------&quot;);\r\n    try {\r\n      testLoop();\r\n    } catch (Exception e) {\r\n      System.out.println(&quot;Exception from testLoop() passed to main= &quot; + e);\r\n    }         \r\n    System.out.println(&quot;After Exception&quot;);\r\n    System.out.println(&quot;------------------&quot;);\r\n    \r\n    testLoop2();\r\n    \r\n    try {\r\n      testLoop3();\r\n    } catch (Exception e) {\r\n      System.out.println(&quot;Exception from testLoop3() passed to main= &quot; + e);\r\n    }\r\n    System.out.println(&quot;After Exception&quot;);\r\n    \r\n    System.out.println(&quot;------------------&quot;);\r\n    testLoop();\r\n    \r\n    System.out.println(&quot;------------------&quot;);\r\n    testLoop3();\r\n  }\r\n  \r\n  private static void testLoop() {\r\n    System.out.println(&quot;In testLoop()&quot;);\r\n    ArrayList&lt;Integer&gt; arrLst = new ArrayList();\r\n    arrLst.add(4);\r\n    arrLst.add(6);\r\n    arrLst.add(2);\r\n    \r\n    for(int x=0; x&lt;5; x++)  {\r\n      System.out.println(arrLst.get(x));\r\n    }          \r\n  }\r\n  \r\n  private static void testLoop2() {\r\n    System.out.println(&quot;In testLoop2()&quot;);\r\n    ArrayList&lt;Integer&gt; arrLst = new ArrayList();\r\n    arrLst.add(4);\r\n    arrLst.add(6);\r\n    arrLst.add(2);\r\n    try {\r\n      for(int x=0; x&lt;5; x++)  {\r\n        System.out.println(arrLst.get(x));\r\n      }\r\n    } catch (Exception e) {\r\n      System.out.println(&quot;Exception = &quot; + e);\r\n    }    \r\n    System.out.println(&quot;After Exception&quot;);\r\n  }\r\n  \r\n  private static void testLoop3() throws IndexOutOfBoundsException{\r\n    System.out.println(&quot;In testLoop3()&quot;);\r\n    ArrayList&lt;Integer&gt; arrLst = new ArrayList();\r\n    arrLst.add(4);\r\n    arrLst.add(6);\r\n    arrLst.add(2);\r\n    \r\n    for(int x=0; x&lt;5; x++)  {\r\n      System.out.println(arrLst.get(x));\r\n    }          \r\n  }\r\n}\r\n```\r\nOutput:\r\n\r\n\r\n```\r\n------------------\r\nIn testLoop()\r\n4\r\n6\r\n2\r\nException from testLoop() passed to main= java.lang.IndexOutOfBoundsException: Index 3 out of bounds for length 3\r\nAfter Exception\r\n------------------\r\nIn testLoop2()\r\n4\r\n6\r\n2\r\nException = java.lang.IndexOutOfBoundsException: Index 3 out of bounds for length 3\r\nAfter Exception\r\nIn testLoop3()\r\n4\r\n6\r\n2\r\nException from testLoop3() passed to main= java.lang.IndexOutOfBoundsException: Index 3 out of bounds for length 3\r\nAfter Exception\r\n------------------\r\nIn testLoop()\r\n4\r\n6\r\n2\r\nException in thread &quot;main&quot; java.lang.IndexOutOfBoundsException: Index 3 out of bounds for length 3\r\n\tat java.base/jdk.internal.util.Preconditions.outOfBounds(Preconditions.java:64)\r\n\tat java.base/jdk.internal.util.Preconditions.outOfBoundsCheckIndex(Preconditions.java:70)\r\n\tat java.base/jdk.internal.util.Preconditions.checkIndex(Preconditions.java:248)\r\n\tat java.base/java.util.Objects.checkIndex(Objects.java:372)\r\n\tat java.base/java.util.ArrayList.get(ArrayList.java:459)\r\n\tat exceptions.TestException.testLoop(TestException.java:42)\r\n\tat exceptions.TestException.main(TestException.java:28)\r\n\r\n```\r\n\r\n\r\n\r\nI expected different results when calling testLoop() and testLoop3() due to the fact that testLoop3() has the thows IndexOutOfBoundsException and testLoop() does not. I excepted testLoop() not to propagate the exception to the main() method","title":"Questions about exception handling in Java specifically the purpose of the throws keyword","body":"<p>I had a question about the <code>throws</code> keyword in the code below. In the method testLoop3() I am indicating that the <code>IndexOutOfBoundsException</code> may be thrown with the throws keyword. But the method testLoop() is identical except it does not show that exception being thrown. What is the purpose of including throws IndexOutOfBoundsException if the exception is being sent to the calling method in both cases and the output is exactly the same? I read that the throws keyword is to make the caller of method aware of the exception and force the caller to handle it in the last line of the main() method it is not handling it.</p>\n<pre class=\"lang-java prettyprint-override\"><code>package exceptions;\n\nimport java.util.ArrayList;\n\npublic class TestException {\n\n  public static void main(String[] args) {\n    \n    System.out.println(&quot;------------------&quot;);\n    try {\n      testLoop();\n    } catch (Exception e) {\n      System.out.println(&quot;Exception from testLoop() passed to main= &quot; + e);\n    }         \n    System.out.println(&quot;After Exception&quot;);\n    System.out.println(&quot;------------------&quot;);\n    \n    testLoop2();\n    \n    try {\n      testLoop3();\n    } catch (Exception e) {\n      System.out.println(&quot;Exception from testLoop3() passed to main= &quot; + e);\n    }\n    System.out.println(&quot;After Exception&quot;);\n    \n    System.out.println(&quot;------------------&quot;);\n    testLoop();\n    \n    System.out.println(&quot;------------------&quot;);\n    testLoop3();\n  }\n  \n  private static void testLoop() {\n    System.out.println(&quot;In testLoop()&quot;);\n    ArrayList&lt;Integer&gt; arrLst = new ArrayList();\n    arrLst.add(4);\n    arrLst.add(6);\n    arrLst.add(2);\n    \n    for(int x=0; x&lt;5; x++)  {\n      System.out.println(arrLst.get(x));\n    }          \n  }\n  \n  private static void testLoop2() {\n    System.out.println(&quot;In testLoop2()&quot;);\n    ArrayList&lt;Integer&gt; arrLst = new ArrayList();\n    arrLst.add(4);\n    arrLst.add(6);\n    arrLst.add(2);\n    try {\n      for(int x=0; x&lt;5; x++)  {\n        System.out.println(arrLst.get(x));\n      }\n    } catch (Exception e) {\n      System.out.println(&quot;Exception = &quot; + e);\n    }    \n    System.out.println(&quot;After Exception&quot;);\n  }\n  \n  private static void testLoop3() throws IndexOutOfBoundsException{\n    System.out.println(&quot;In testLoop3()&quot;);\n    ArrayList&lt;Integer&gt; arrLst = new ArrayList();\n    arrLst.add(4);\n    arrLst.add(6);\n    arrLst.add(2);\n    \n    for(int x=0; x&lt;5; x++)  {\n      System.out.println(arrLst.get(x));\n    }          \n  }\n}\n</code></pre>\n<p>Output:</p>\n<pre><code>------------------\nIn testLoop()\n4\n6\n2\nException from testLoop() passed to main= java.lang.IndexOutOfBoundsException: Index 3 out of bounds for length 3\nAfter Exception\n------------------\nIn testLoop2()\n4\n6\n2\nException = java.lang.IndexOutOfBoundsException: Index 3 out of bounds for length 3\nAfter Exception\nIn testLoop3()\n4\n6\n2\nException from testLoop3() passed to main= java.lang.IndexOutOfBoundsException: Index 3 out of bounds for length 3\nAfter Exception\n------------------\nIn testLoop()\n4\n6\n2\nException in thread &quot;main&quot; java.lang.IndexOutOfBoundsException: Index 3 out of bounds for length 3\n    at java.base/jdk.internal.util.Preconditions.outOfBounds(Preconditions.java:64)\n    at java.base/jdk.internal.util.Preconditions.outOfBoundsCheckIndex(Preconditions.java:70)\n    at java.base/jdk.internal.util.Preconditions.checkIndex(Preconditions.java:248)\n    at java.base/java.util.Objects.checkIndex(Objects.java:372)\n    at java.base/java.util.ArrayList.get(ArrayList.java:459)\n    at exceptions.TestException.testLoop(TestException.java:42)\n    at exceptions.TestException.main(TestException.java:28)\n\n</code></pre>\n<p>I expected different results when calling testLoop() and testLoop3() due to the fact that testLoop3() has the thows IndexOutOfBoundsException and testLoop() does not. I excepted testLoop() not to propagate the exception to the main() method</p>\n"},{"tags":["java","antlr","antlr4"],"comments":[{"owner":{"account_id":6128906,"reputation":1172,"user_id":4779853,"display_name":"kaby76"},"score":1,"creation_date":1671020365,"post_id":74797082,"comment_id":132005960,"body_markdown":"Antlr Lexer rules are not parser-state dependent. Antlr lexer tokenizes the entire input first, then the parse starts.  The lexer matches the longest string regardless of rule order. If two lexer rules match the same string, the first rule listed is picked. So, `WORD_TOKEN` cannot match because `LABEL_TOKEN` occurs first. Also, always print out your tokens when debugging the grammar.","body":"Antlr Lexer rules are not parser-state dependent. Antlr lexer tokenizes the entire input first, then the parse starts.  The lexer matches the longest string regardless of rule order. If two lexer rules match the same string, the first rule listed is picked. So, <code>WORD_TOKEN</code> cannot match because <code>LABEL_TOKEN</code> occurs first. Also, always print out your tokens when debugging the grammar."},{"owner":{"account_id":27816,"reputation":6650,"user_id":73764,"accept_rate":91,"display_name":"Mike Cargal"},"score":1,"creation_date":1671031575,"post_id":74797082,"comment_id":132010313,"body_markdown":"Since you‚Äôre (apparently ) just trying to find patterns in a document and not trying to identify the structure of the document, I‚Äôd really have to suggest that a Regex matcher is a much more appropriate tool than ANTLR for this task.","body":"Since you‚Äôre (apparently ) just trying to find patterns in a document and not trying to identify the structure of the document, I‚Äôd really have to suggest that a Regex matcher is a much more appropriate tool than ANTLR for this task."}],"answers":[{"tags":[],"owner":{"account_id":2078337,"reputation":3704,"user_id":1851041,"display_name":"BernardK"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672909318,"creation_date":1672909318,"answer_id":75015958,"question_id":74797082,"body_markdown":"Free text is more difficult to parse than programming languages. It&#39;s not the first time that I see answers discouraging to use ANTLR, like Mike&#39;s comment. Nevertheless I have tried to find a solution.\r\n\r\nWith your grammar, the lexer rule `LABEL_TOKEN` systematically consumes the first letter after a digit or digit dot, as can be seen when listing the tokens produced by the lexer :\r\n\r\n    % grun Text text -tokens input.txt \r\n    [@0,0:5=&#39;Figure&#39;,&lt;&#39;Figure&#39;&gt;,1:0]\r\n    [@1,6:6=&#39; &#39;,&lt;SPACE_TOKEN&gt;,1:6]\r\n    [@2,7:9=&#39;6.R&#39;,&lt;LABEL_TOKEN&gt;,1:7]\r\n    [@3,10:18=&#39;egulation&#39;,&lt;WORD_TOKEN&gt;,1:10]\r\n    ...\r\n    [@21,62:64=&#39;86F&#39;,&lt;LABEL_TOKEN&gt;,3:19]\r\n    [@22,65:70=&#39;ormula&#39;,&lt;WORD_TOKEN&gt;,3:22]\r\n\r\nWith this grammar in file `Question.g4` :\r\n\r\n    grammar Question;\r\n    \r\n    text\r\n    @init {System.out.println(&quot;Question last update 2046&quot;);}\r\n        :   line+ EOF ;\r\n    \r\n    line\r\n        :   ( figure\r\n        |     ID\r\n        |     NUMBER\r\n        |     PUNCTUATION\r\n        |     SPACE\r\n            )+ NL?\r\n        ;\r\n    \r\n    figure\r\n        :   &#39;Figure&#39; SPACE figure_number\r\n        ;\r\n    \r\n    figure_number\r\n        :   NUMBER    \r\n                               { System.out.println(&quot;NUMBER ID current tk txt=&quot; + getCurrentToken().getText() + &quot; line=&quot; + getCurrentToken().getLine() + &quot; pos=&quot; + getCurrentToken().getCharPositionInLine()); }\r\n            { getCurrentToken().getText().length() == 1 }? ID\r\n                               { System.out.println(&quot;   &gt;&gt; C &quot; + $start.getTokenIndex() + &quot;-&quot; + ($ID == null ? &quot;?&quot; : $ID.getTokenIndex()) + &quot; text=&quot; + ($ID == null ? $NUMBER.text : $NUMBER.text + $ID.text)); }\r\n        |   NUMBER_DOT\r\n                               { System.out.println(&quot;NUMBER_DOT ID current tk txt=&quot; + getCurrentToken().getText() + &quot; line=&quot; + getCurrentToken().getLine() + &quot; pos=&quot; + getCurrentToken().getCharPositionInLine()); }\r\n            { getCurrentToken().getText().length() == 1 }? ID\r\n                               { System.out.println(&quot;   &gt;&gt; D &quot; + $start.getTokenIndex() + &quot;-&quot; + ($ID == null ? &quot;?&quot; : $ID.getTokenIndex()) + &quot; text=&quot; + ($ID == null ? $NUMBER_DOT.text : $NUMBER_DOT.text + $ID.text)); }\r\n        |   NUMBER_DOT NUMBER\r\n                               { System.out.println(&quot;NUMBER_DOT NUMBER ID current tk txt=&quot; + getCurrentToken().getText() + &quot; line=&quot; + getCurrentToken().getLine() + &quot; pos=&quot; + getCurrentToken().getCharPositionInLine()); }\r\n            { getCurrentToken().getText().length() == 1 }? ID\r\n                               { System.out.println(&quot;   &gt;&gt; E &quot; + $start.getTokenIndex() + &quot;-&quot; + ($ID == null ? &quot;?&quot; : $ID.getTokenIndex()) + &quot; text=&quot; + ($ID == null ? $NUMBER_DOT.text : $NUMBER_DOT.text + $ID.text)); }\r\n        |   NUMBER             { System.out.println(&quot;   &gt;&gt; A &quot; + $start.getTokenIndex() + &quot; text=&quot; + $NUMBER.text); }\r\n        |   NUMBER_DOT NUMBER? { System.out.println(&quot;   &gt;&gt; B &quot; + $start.getTokenIndex() + &quot; text=&quot; + $NUMBER_DOT.text + $NUMBER.text); }\r\n        ;\r\n    \r\n    ID          : LETTER ( LETTER | DIGIT )* ;\r\n    NUMBER      : DIGIT+ ;\r\n    NUMBER_DOT  : DIGIT+ &#39;.&#39; ;\r\n    PUNCTUATION : [.,;:!?\\-()&#39;&quot;‚Äô] ;\r\n    NL          : [\\r\\n]+ ;\r\n    SPACE       : &#39; &#39;+ ;\r\n    TAB         : [\\t]+ -&gt; skip ;\r\n    \r\n    fragment DIGIT  : [0-9] ;\r\n    fragment LETTER : [a-zA-Z] ;\r\n\r\nand the following input in file `input.txt` :\r\n\r\n    Figure 6.Regulation\r\n    Figure 6 Regulation\r\n    Figure 6.1A Regulation\r\n    See in Figure 2.1, 86Formula and other text\r\n    See Figure 3A xyz.\r\n    See Figure 3.1A abc.\r\n    \r\n    Since you‚Äôre (apparently ) just trying ... - to identify the structure -, I‚Äôd really suggest : a Regex matcher, see Figure 3A.\r\n\r\nand given :\r\n\r\n    alias a4=&#39;java -jar /usr/local/lib/antlr-4.11.1-complete.jar&#39;\r\n    alias grun=&#39;java org.antlr.v4.gui.TestRig&#39;\r\n    export CLASSPATH=.:/usr/local/lib/antlr-4.11.1-complete.jar\r\nExecution :\r\n\r\n    % a4 Question.g4                                              \r\n    % javac Q*.java \r\n    % grun Question text -tokens -gui input.txt\r\n    [@0,0:5=&#39;Figure&#39;,&lt;&#39;Figure&#39;&gt;,1:0]\r\n    [@1,6:6=&#39; &#39;,&lt;SPACE&gt;,1:6]\r\n    [@2,7:8=&#39;6.&#39;,&lt;NUMBER_DOT&gt;,1:7]\r\n    [@3,9:18=&#39;Regulation&#39;,&lt;ID&gt;,1:9]\r\n    ...\r\nthe grafic is quite nice and the output is :\r\n\r\n    Question last update 2046\r\n    NUMBER_DOT ID current tk txt=Regulation line=1 pos=9\r\n    line 1:9 rule figure_number failed predicate: { getCurrentToken().getText().length() == 1 }?\r\n       &gt;&gt; A 7 text=6\r\n    NUMBER_DOT NUMBER ID current tk txt=A line=3 pos=10\r\n       &gt;&gt; E 13-15 text=6.A\r\n       &gt;&gt; B 25 text=2.1\r\n    NUMBER ID current tk txt=A line=5 pos=12\r\n       &gt;&gt; C 42-43 text=3A\r\n    NUMBER_DOT NUMBER ID current tk txt=A line=6 pos=14\r\n       &gt;&gt; E 52-54 text=3.A\r\n    NUMBER ID current tk txt=A line=8 pos=124\r\n       &gt;&gt; C 112-113 text=3A\r\nFor the input `Figure 6.Regulation`, the semantic predicate\r\n\r\n`{ getCurrentToken().getText().length() == 1 }?`\r\n\r\nguards from using the first alternative, NUMBER ID, of rule figure_number.\r\n\r\nTo give a chance to alternatives C, D and E to be used, I had to move A and B at the end of rule figure_number. Explanation in section 15.7, [book][1] page 286, PDF page 288 :\r\n\r\n&gt; ANTLR‚Äôs general decision-making strategy is to find all viable\r\n&gt; alternatives and then ignore the alternatives guarded with predicates\r\n&gt; that currently evaluate to false. (A viable alternative is one that\r\n&gt; matches the current input.) If more than one viable alternative\r\n&gt; remains, the parser chooses the alternative specified first in the\r\n&gt; decision.\r\n\r\nWith\r\n\r\n    figure_number\r\n        :   NUMBER             ...  &gt;&gt; A\r\n        |   NUMBER_DOT NUMBER? ...  &gt;&gt; B\r\n\r\nthe parsing decisions give a completely different result :\r\n\r\n    Question last update 0853\r\n       &gt;&gt; B 2 text=6.null\r\n       &gt;&gt; A 7 text=6\r\n       &gt;&gt; B 13 text=6.1\r\n       &gt;&gt; B 25 text=2.1\r\n       &gt;&gt; A 42 text=3\r\n       &gt;&gt; B 52 text=3.1\r\n       &gt;&gt; A 112 text=3\r\n\r\nJust for completeness, it can be useful to have a listener, file `MyListener.java` :\r\n\r\n    public class MyListener extends QuestionBaseListener {\r\n        QuestionParser parser;\r\n        public MyListener(QuestionParser parser) { this.parser = parser; }\r\n    \r\n    \tpublic void exitLine(QuestionParser.LineContext ctx) {\r\n            System.out.println(&quot;&gt;&gt;&gt; in MyListener for line&quot;);\r\n            System.out.println(parser.getTokenStream().getText(ctx));\r\n        }\r\n    }\r\n\r\nand an application, file `Job.java` :\r\n\r\n    import org.antlr.v4.runtime.*;\r\n    import org.antlr.v4.runtime.tree.*;\r\n    \r\n    public class Job {\r\n        public static void main(String[] args) throws Exception {\r\n    \t\tSystem.out.println(&quot;==========Java Job 4/1/2023 14:32&quot;);\r\n    \t\tString input_file_name = &quot;&quot;;\r\n    \r\n    \t\tif ( args.length &lt; 1 )\r\n                throw new Exception(&quot;Missing input file name on command line&quot;);\r\n    \r\n            input_file_name  = args[0];\r\n    \t\tCharStream input = CharStreams.fromFileName(input_file_name);\r\n    \r\n    \t\tSystem.out.println(&quot;==========Java Job start parsing ==========&quot;);\r\n    \t\tQuestionLexer     lexer    = new QuestionLexer(input);\r\n    \t\tCommonTokenStream tokens   = new CommonTokenStream(lexer);\r\n    \t\tQuestionParser    parser   = new QuestionParser(tokens);\r\n    \t\tParseTree         tree     = parser.text();\r\n    \t\tSystem.out.println(&quot;==========Java Job parsing ended&quot;);\r\n    \t\tParseTreeWalker   walker   = new ParseTreeWalker();\r\n    \t\tSystem.out.println(&quot;==========Java Job about to new MyListener&quot;);\r\n    \t\tMyListener        listener = new MyListener(parser);\r\n    \t\tSystem.out.println(&quot;==========Java Job about to walk&quot;);\r\n    \t\twalker.walk(listener, tree);\r\n            System.out.println(&quot;==========Java Job tree size=&quot; + tree.getChildCount());\r\n    \t}\r\n    }\r\n\r\nwhich outputs the lines as seen by the parser :\r\n\r\n    % java Job input.txt\r\n    ...\r\n    ==========Java Job about to walk\r\n    &gt;&gt;&gt; in MyListener for line\r\n    Figure 6.Regulation\r\n    ...\r\n    &gt;&gt;&gt; in MyListener for line\r\n    See in Figure 2.1, 86Formula and other text\r\n\r\n  [1]: https://pragprog.com/titles/tpantlr2/the-definitive-antlr-4-reference/\r\n\r\n\r\n\r\n\r\n\r\n\r\n","title":"ANTLR doesn&#39;t match correct parser rule in some cases","body":"<p>Free text is more difficult to parse than programming languages. It's not the first time that I see answers discouraging to use ANTLR, like Mike's comment. Nevertheless I have tried to find a solution.</p>\n<p>With your grammar, the lexer rule <code>LABEL_TOKEN</code> systematically consumes the first letter after a digit or digit dot, as can be seen when listing the tokens produced by the lexer :</p>\n<pre><code>% grun Text text -tokens input.txt \n[@0,0:5='Figure',&lt;'Figure'&gt;,1:0]\n[@1,6:6=' ',&lt;SPACE_TOKEN&gt;,1:6]\n[@2,7:9='6.R',&lt;LABEL_TOKEN&gt;,1:7]\n[@3,10:18='egulation',&lt;WORD_TOKEN&gt;,1:10]\n...\n[@21,62:64='86F',&lt;LABEL_TOKEN&gt;,3:19]\n[@22,65:70='ormula',&lt;WORD_TOKEN&gt;,3:22]\n</code></pre>\n<p>With this grammar in file <code>Question.g4</code> :</p>\n<pre><code>grammar Question;\n\ntext\n@init {System.out.println(&quot;Question last update 2046&quot;);}\n    :   line+ EOF ;\n\nline\n    :   ( figure\n    |     ID\n    |     NUMBER\n    |     PUNCTUATION\n    |     SPACE\n        )+ NL?\n    ;\n\nfigure\n    :   'Figure' SPACE figure_number\n    ;\n\nfigure_number\n    :   NUMBER    \n                           { System.out.println(&quot;NUMBER ID current tk txt=&quot; + getCurrentToken().getText() + &quot; line=&quot; + getCurrentToken().getLine() + &quot; pos=&quot; + getCurrentToken().getCharPositionInLine()); }\n        { getCurrentToken().getText().length() == 1 }? ID\n                           { System.out.println(&quot;   &gt;&gt; C &quot; + $start.getTokenIndex() + &quot;-&quot; + ($ID == null ? &quot;?&quot; : $ID.getTokenIndex()) + &quot; text=&quot; + ($ID == null ? $NUMBER.text : $NUMBER.text + $ID.text)); }\n    |   NUMBER_DOT\n                           { System.out.println(&quot;NUMBER_DOT ID current tk txt=&quot; + getCurrentToken().getText() + &quot; line=&quot; + getCurrentToken().getLine() + &quot; pos=&quot; + getCurrentToken().getCharPositionInLine()); }\n        { getCurrentToken().getText().length() == 1 }? ID\n                           { System.out.println(&quot;   &gt;&gt; D &quot; + $start.getTokenIndex() + &quot;-&quot; + ($ID == null ? &quot;?&quot; : $ID.getTokenIndex()) + &quot; text=&quot; + ($ID == null ? $NUMBER_DOT.text : $NUMBER_DOT.text + $ID.text)); }\n    |   NUMBER_DOT NUMBER\n                           { System.out.println(&quot;NUMBER_DOT NUMBER ID current tk txt=&quot; + getCurrentToken().getText() + &quot; line=&quot; + getCurrentToken().getLine() + &quot; pos=&quot; + getCurrentToken().getCharPositionInLine()); }\n        { getCurrentToken().getText().length() == 1 }? ID\n                           { System.out.println(&quot;   &gt;&gt; E &quot; + $start.getTokenIndex() + &quot;-&quot; + ($ID == null ? &quot;?&quot; : $ID.getTokenIndex()) + &quot; text=&quot; + ($ID == null ? $NUMBER_DOT.text : $NUMBER_DOT.text + $ID.text)); }\n    |   NUMBER             { System.out.println(&quot;   &gt;&gt; A &quot; + $start.getTokenIndex() + &quot; text=&quot; + $NUMBER.text); }\n    |   NUMBER_DOT NUMBER? { System.out.println(&quot;   &gt;&gt; B &quot; + $start.getTokenIndex() + &quot; text=&quot; + $NUMBER_DOT.text + $NUMBER.text); }\n    ;\n\nID          : LETTER ( LETTER | DIGIT )* ;\nNUMBER      : DIGIT+ ;\nNUMBER_DOT  : DIGIT+ '.' ;\nPUNCTUATION : [.,;:!?\\-()'&quot;‚Äô] ;\nNL          : [\\r\\n]+ ;\nSPACE       : ' '+ ;\nTAB         : [\\t]+ -&gt; skip ;\n\nfragment DIGIT  : [0-9] ;\nfragment LETTER : [a-zA-Z] ;\n</code></pre>\n<p>and the following input in file <code>input.txt</code> :</p>\n<pre><code>Figure 6.Regulation\nFigure 6 Regulation\nFigure 6.1A Regulation\nSee in Figure 2.1, 86Formula and other text\nSee Figure 3A xyz.\nSee Figure 3.1A abc.\n\nSince you‚Äôre (apparently ) just trying ... - to identify the structure -, I‚Äôd really suggest : a Regex matcher, see Figure 3A.\n</code></pre>\n<p>and given :</p>\n<pre><code>alias a4='java -jar /usr/local/lib/antlr-4.11.1-complete.jar'\nalias grun='java org.antlr.v4.gui.TestRig'\nexport CLASSPATH=.:/usr/local/lib/antlr-4.11.1-complete.jar\n</code></pre>\n<p>Execution :</p>\n<pre><code>% a4 Question.g4                                              \n% javac Q*.java \n% grun Question text -tokens -gui input.txt\n[@0,0:5='Figure',&lt;'Figure'&gt;,1:0]\n[@1,6:6=' ',&lt;SPACE&gt;,1:6]\n[@2,7:8='6.',&lt;NUMBER_DOT&gt;,1:7]\n[@3,9:18='Regulation',&lt;ID&gt;,1:9]\n...\n</code></pre>\n<p>the grafic is quite nice and the output is :</p>\n<pre><code>Question last update 2046\nNUMBER_DOT ID current tk txt=Regulation line=1 pos=9\nline 1:9 rule figure_number failed predicate: { getCurrentToken().getText().length() == 1 }?\n   &gt;&gt; A 7 text=6\nNUMBER_DOT NUMBER ID current tk txt=A line=3 pos=10\n   &gt;&gt; E 13-15 text=6.A\n   &gt;&gt; B 25 text=2.1\nNUMBER ID current tk txt=A line=5 pos=12\n   &gt;&gt; C 42-43 text=3A\nNUMBER_DOT NUMBER ID current tk txt=A line=6 pos=14\n   &gt;&gt; E 52-54 text=3.A\nNUMBER ID current tk txt=A line=8 pos=124\n   &gt;&gt; C 112-113 text=3A\n</code></pre>\n<p>For the input <code>Figure 6.Regulation</code>, the semantic predicate</p>\n<p><code>{ getCurrentToken().getText().length() == 1 }?</code></p>\n<p>guards from using the first alternative, NUMBER ID, of rule figure_number.</p>\n<p>To give a chance to alternatives C, D and E to be used, I had to move A and B at the end of rule figure_number. Explanation in section 15.7, <a href=\"https://pragprog.com/titles/tpantlr2/the-definitive-antlr-4-reference/\" rel=\"nofollow noreferrer\">book</a> page 286, PDF page 288 :</p>\n<blockquote>\n<p>ANTLR‚Äôs general decision-making strategy is to find all viable\nalternatives and then ignore the alternatives guarded with predicates\nthat currently evaluate to false. (A viable alternative is one that\nmatches the current input.) If more than one viable alternative\nremains, the parser chooses the alternative specified first in the\ndecision.</p>\n</blockquote>\n<p>With</p>\n<pre><code>figure_number\n    :   NUMBER             ...  &gt;&gt; A\n    |   NUMBER_DOT NUMBER? ...  &gt;&gt; B\n</code></pre>\n<p>the parsing decisions give a completely different result :</p>\n<pre><code>Question last update 0853\n   &gt;&gt; B 2 text=6.null\n   &gt;&gt; A 7 text=6\n   &gt;&gt; B 13 text=6.1\n   &gt;&gt; B 25 text=2.1\n   &gt;&gt; A 42 text=3\n   &gt;&gt; B 52 text=3.1\n   &gt;&gt; A 112 text=3\n</code></pre>\n<p>Just for completeness, it can be useful to have a listener, file <code>MyListener.java</code> :</p>\n<pre><code>public class MyListener extends QuestionBaseListener {\n    QuestionParser parser;\n    public MyListener(QuestionParser parser) { this.parser = parser; }\n\n    public void exitLine(QuestionParser.LineContext ctx) {\n        System.out.println(&quot;&gt;&gt;&gt; in MyListener for line&quot;);\n        System.out.println(parser.getTokenStream().getText(ctx));\n    }\n}\n</code></pre>\n<p>and an application, file <code>Job.java</code> :</p>\n<pre><code>import org.antlr.v4.runtime.*;\nimport org.antlr.v4.runtime.tree.*;\n\npublic class Job {\n    public static void main(String[] args) throws Exception {\n        System.out.println(&quot;==========Java Job 4/1/2023 14:32&quot;);\n        String input_file_name = &quot;&quot;;\n\n        if ( args.length &lt; 1 )\n            throw new Exception(&quot;Missing input file name on command line&quot;);\n\n        input_file_name  = args[0];\n        CharStream input = CharStreams.fromFileName(input_file_name);\n\n        System.out.println(&quot;==========Java Job start parsing ==========&quot;);\n        QuestionLexer     lexer    = new QuestionLexer(input);\n        CommonTokenStream tokens   = new CommonTokenStream(lexer);\n        QuestionParser    parser   = new QuestionParser(tokens);\n        ParseTree         tree     = parser.text();\n        System.out.println(&quot;==========Java Job parsing ended&quot;);\n        ParseTreeWalker   walker   = new ParseTreeWalker();\n        System.out.println(&quot;==========Java Job about to new MyListener&quot;);\n        MyListener        listener = new MyListener(parser);\n        System.out.println(&quot;==========Java Job about to walk&quot;);\n        walker.walk(listener, tree);\n        System.out.println(&quot;==========Java Job tree size=&quot; + tree.getChildCount());\n    }\n}\n</code></pre>\n<p>which outputs the lines as seen by the parser :</p>\n<pre><code>% java Job input.txt\n...\n==========Java Job about to walk\n&gt;&gt;&gt; in MyListener for line\nFigure 6.Regulation\n...\n&gt;&gt;&gt; in MyListener for line\nSee in Figure 2.1, 86Formula and other text\n</code></pre>\n"}],"owner":{"account_id":18026994,"reputation":1,"user_id":13102672,"display_name":"Korpusova Svetlana"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":221,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672909318,"creation_date":1671015105,"question_id":74797082,"body_markdown":"I am trying to identify figure namber in documents. Strings like &quot;Figure 3. Caption&quot; or &quot;See in Figure 3&quot;. Some figure may contain subindex (&#39;1A&#39; or &#39;1.1&#39; or &#39;3.A&#39;) and sometimes there is no space beetwen Caption and dot. I have the following ANTLR file with rules:\r\n\r\n```\r\ngrammar Text;\r\n\r\ntext   : space? \r\n      ( \r\n       keywordFigure\r\n      | label\r\n      | space\r\n      | dot\r\n      | comma\r\n      | word )*;\r\n\r\n\r\nFIGURE : &#39;Figure&#39;;\r\nkeywordFigure : FIGURE;\r\n\r\nLABEL_TOKEN : [0-9]+ [a-zA-Z]?\r\n            | [0-9]+ &#39;.&#39; [0-9]+\r\n            | [0-9]+ &#39;.&#39; [a-zA-Z];\r\nlabel : LABEL_TOKEN;\r\n\r\n\r\n/* Separators */\r\n\r\nSPACE_TOKEN : [ \\t\\n\\r]+;\r\nspace : SPACE_TOKEN;\r\n\r\nDOT : &#39;.&#39;;\r\ndot : DOT;\r\n\r\nCOMMA : &#39;,&#39;;\r\ncomma : COMMA;\r\n\r\nfragment WORD_CHAR : ~[0-9 \\t\\n\\r.,];\r\nWORD_TOKEN : WORD_CHAR+;\r\nword : WORD_TOKEN;\r\n\r\n```\r\n\r\n\r\nThis grammar does not work correctly for some examples:\r\n\r\n```\r\nFigure 6.Regulation\r\n```\r\n*label* is &quot;6.R&quot; but not &quot;6.&quot; because the ANTLR priority (select the lexer rule which matches the longest input). \r\n\r\n```\r\nSee in Figure 2.1, 86Formula and other text\r\n```\r\n*labels* are &quot;2.1&quot; and &quot;86F&quot;. \r\n\r\nIs there a way how to identify a boundary for this rule?","title":"ANTLR doesn&#39;t match correct parser rule in some cases","body":"<p>I am trying to identify figure namber in documents. Strings like &quot;Figure 3. Caption&quot; or &quot;See in Figure 3&quot;. Some figure may contain subindex ('1A' or '1.1' or '3.A') and sometimes there is no space beetwen Caption and dot. I have the following ANTLR file with rules:</p>\n<pre><code>grammar Text;\n\ntext   : space? \n      ( \n       keywordFigure\n      | label\n      | space\n      | dot\n      | comma\n      | word )*;\n\n\nFIGURE : 'Figure';\nkeywordFigure : FIGURE;\n\nLABEL_TOKEN : [0-9]+ [a-zA-Z]?\n            | [0-9]+ '.' [0-9]+\n            | [0-9]+ '.' [a-zA-Z];\nlabel : LABEL_TOKEN;\n\n\n/* Separators */\n\nSPACE_TOKEN : [ \\t\\n\\r]+;\nspace : SPACE_TOKEN;\n\nDOT : '.';\ndot : DOT;\n\nCOMMA : ',';\ncomma : COMMA;\n\nfragment WORD_CHAR : ~[0-9 \\t\\n\\r.,];\nWORD_TOKEN : WORD_CHAR+;\nword : WORD_TOKEN;\n\n</code></pre>\n<p>This grammar does not work correctly for some examples:</p>\n<pre><code>Figure 6.Regulation\n</code></pre>\n<p><em>label</em> is &quot;6.R&quot; but not &quot;6.&quot; because the ANTLR priority (select the lexer rule which matches the longest input).</p>\n<pre><code>See in Figure 2.1, 86Formula and other text\n</code></pre>\n<p><em>labels</em> are &quot;2.1&quot; and &quot;86F&quot;.</p>\n<p>Is there a way how to identify a boundary for this rule?</p>\n"},{"tags":["javascript","java","android","reverse-engineering","frida"],"answers":[{"comments":[{"owner":{"account_id":25660142,"reputation":55,"user_id":19425991,"display_name":"na29"},"score":0,"creation_date":1672942698,"post_id":75015957,"comment_id":132392336,"body_markdown":"I have done this and now i get a new error: `TypeError: cannot read property &#39;$getHandle&#39; of undefined&quot;,&quot;stack&quot;:&quot;TypeError: cannot read property &#39;$getHandle&#39; of undefined`. May this be happening because the method is called using the abstract method instead?","body":"I have done this and now i get a new error: <code>TypeError: cannot read property &#39;$getHandle&#39; of undefined&quot;,&quot;stack&quot;:&quot;TypeError: cannot read property &#39;$getHandle&#39; of undefined</code>. May this be happening because the method is called using the abstract method instead?"},{"owner":{"account_id":25660142,"reputation":55,"user_id":19425991,"display_name":"na29"},"score":0,"creation_date":1672943643,"post_id":75015957,"comment_id":132392649,"body_markdown":"Also because i am getting these problems only in methods who are normally called using the abstract variant. For example here the method is called usually by using android.content.pm.PackageManager.getPackageInfo.","body":"Also because i am getting these problems only in methods who are normally called using the abstract variant. For example here the method is called usually by using android.content.pm.PackageManager.getPackageInfo."},{"owner":{"account_id":25660142,"reputation":55,"user_id":19425991,"display_name":"na29"},"score":0,"creation_date":1672950170,"post_id":75015957,"comment_id":132394572,"body_markdown":"Sorry if i spam comments, i can&#39;t edit them after some time. But may that error (the one i sent in the comments) be caused by the fact that I am calling the method passing it `this` which is undefined?","body":"Sorry if i spam comments, i can&#39;t edit them after some time. But may that error (the one i sent in the comments) be caused by the fact that I am calling the method passing it <code>this</code> which is undefined?"},{"owner":{"account_id":50585,"reputation":39940,"user_id":150978,"accept_rate":78,"display_name":"Robert"},"score":0,"creation_date":1672950902,"post_id":75015957,"comment_id":132394778,"body_markdown":"Just a guess, but have you tried your Frida code snippet on a different app? May be the app uses some security measures that prevent Frida from functioning correctly? What phone, Android Version and Frida client and Frida server version do you use?","body":"Just a guess, but have you tried your Frida code snippet on a different app? May be the app uses some security measures that prevent Frida from functioning correctly? What phone, Android Version and Frida client and Frida server version do you use?"},{"owner":{"account_id":25660142,"reputation":55,"user_id":19425991,"display_name":"na29"},"score":0,"creation_date":1672951525,"post_id":75015957,"comment_id":132394960,"body_markdown":"I have tried on different apps and different phones, it isn&#39;t the problem. I am using the last Frida Inject.","body":"I have tried on different apps and different phones, it isn&#39;t the problem. I am using the last Frida Inject."}],"tags":[],"owner":{"account_id":50585,"reputation":39940,"user_id":150978,"accept_rate":78,"display_name":"Robert"},"comment_count":5,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672909317,"creation_date":1672909317,"answer_id":75015957,"question_id":75011636,"body_markdown":"The common way is to save the reference to the hooked method and reuse it when you want to call the original implementation:\r\n\r\n```\r\nJava.perform(()=&gt;{\r\n    const jPM=Java.use(&#39;android.app.ApplicationPackageManager&#39;);\r\n    const getPImethod = jPM.getPackageInfo.overload(&#39;java.lang.String&#39;,&#39;int&#39;);\r\n    getPImethod.implementation=(pname,f)=&gt;{\r\n        console.log(&quot;Called =&gt; getPackageInfo (Flag=&quot;+f+&quot;, Pkg=&quot;+pname+&quot;)&quot;);\r\n        return getPImethod.call(this,pname,f);\r\n    }\r\n});\r\n```","title":"TypeError: cannot read property &#39;getPackageInfo&#39; of undefined in Frida","body":"<p>The common way is to save the reference to the hooked method and reuse it when you want to call the original implementation:</p>\n<pre><code>Java.perform(()=&gt;{\n    const jPM=Java.use('android.app.ApplicationPackageManager');\n    const getPImethod = jPM.getPackageInfo.overload('java.lang.String','int');\n    getPImethod.implementation=(pname,f)=&gt;{\n        console.log(&quot;Called =&gt; getPackageInfo (Flag=&quot;+f+&quot;, Pkg=&quot;+pname+&quot;)&quot;);\n        return getPImethod.call(this,pname,f);\n    }\n});\n</code></pre>\n"}],"owner":{"account_id":25660142,"reputation":55,"user_id":19425991,"display_name":"na29"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":207,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1672909317,"creation_date":1672868453,"question_id":75011636,"body_markdown":"Hi I am trying to call a method (getPackageInfo) using Frida, but i get this error:\r\n`TypeError: cannot read property &#39;getPackageInfo&#39; of undefined`.\r\nThis is the code:\r\n```\r\nJava.perform(()=&gt;{\r\n    const jPM=Java.use(&#39;android.app.ApplicationPackageManager&#39;);\r\n    jPM.getPackageInfo.overload(&#39;java.lang.String&#39;,&#39;int&#39;).implementation=(pname,f)=&gt;{\r\n        console.log(&quot;Called =&gt; getPackageInfo (Flag=&quot;+f+&quot;, Pkg=&quot;+pname+&quot;)&quot;);\r\n        return this.getPackageInfo.overload(&#39;java.lang.String&#39;,&#39;int&#39;).call(this,pname,f);\r\n    }\r\n});\r\n```\r\nAnd the error is from this line: `return this.getPackageInfo.overload(&#39;java.lang.String&#39;,&#39;int&#39;).call(this,pname,f);`","title":"TypeError: cannot read property &#39;getPackageInfo&#39; of undefined in Frida","body":"<p>Hi I am trying to call a method (getPackageInfo) using Frida, but i get this error:\n<code>TypeError: cannot read property 'getPackageInfo' of undefined</code>.\nThis is the code:</p>\n<pre><code>Java.perform(()=&gt;{\n    const jPM=Java.use('android.app.ApplicationPackageManager');\n    jPM.getPackageInfo.overload('java.lang.String','int').implementation=(pname,f)=&gt;{\n        console.log(&quot;Called =&gt; getPackageInfo (Flag=&quot;+f+&quot;, Pkg=&quot;+pname+&quot;)&quot;);\n        return this.getPackageInfo.overload('java.lang.String','int').call(this,pname,f);\n    }\n});\n</code></pre>\n<p>And the error is from this line: <code>return this.getPackageInfo.overload('java.lang.String','int').call(this,pname,f);</code></p>\n"},{"tags":["java","oop","inheritance","polymorphism","mapstruct"],"answers":[{"tags":[],"owner":{"account_id":755765,"reputation":8010,"user_id":765965,"accept_rate":94,"display_name":"Al-Mothafar"},"comment_count":0,"down_vote_count":0,"up_vote_count":8,"is_accepted":true,"score":8,"last_activity_date":1569684402,"creation_date":1475483866,"answer_id":39827492,"question_id":39773923,"body_markdown":"Currently, it seems it&#39;s not available yet as a feature for mapstruct :  [Support for Type-Refinement mapping (or Downcast Mapping)][1]\r\n\r\nI asked the question in their google group: https://groups.google.com/forum/?fromgroups#!topic/mapstruct-users/PqB-g1SBTPg\r\n\r\nand found that I need to do manual mapping using `default` method inside interface (for java 8).\r\n\r\nAnd got another issue for mapping parent that was almost not applicable so I write one more empty class that child of parent class called `LocalUserDTO`: \r\n\r\nSo the code becomes like the following:\r\n\r\n    @Mapper\r\n    public interface UserMapper {\r\n        public static UserMapper INSTANCE = Mappers.getMapper(UserMapper.class);\r\n    \r\n        LocalUser map(LocalUserDTO userDTO);\r\n    \r\n        @InheritInverseConfiguration\r\n        LocalUserDTO map(LocalUser user);\r\n    \r\n    \r\n        List&lt;UserDTO&gt; map(List&lt;User&gt; users);\r\n    \r\n        FacebookUser map(FacebookUserDTO userDTO);\r\n    \r\n        @InheritInverseConfiguration\r\n        FacebookUserDTO map(FacebookUser user);\r\n    \r\n        TwitterUser map(TwitterUserDTO userDTO);\r\n    \r\n        @InheritInverseConfiguration\r\n        TwitterUserDTO map(TwitterUser user);\r\n    \r\n        default UserDTO map(User user) {\r\n    \r\n            if (user instanceof FacebookUser) {\r\n                return this.map((FacebookUser) user);\r\n            } else if (user instanceof TwitterUser) {\r\n                return this.map((TwitterUser) user);\r\n            } else {\r\n                return this.map((LocalUser) user);\r\n            }\r\n        }\r\n    \r\n        @InheritInverseConfiguration\r\n        default User map(UserDTO userDTO) {\r\n            if (userDTO instanceof FacebookUserDTO) {\r\n                return this.map((FacebookUserDTO) userDTO);\r\n            } else if (userDTO instanceof TwitterUserDTO) {\r\n                return this.map((TwitterUserDTO) userDTO);\r\n            } else {\r\n                return this.map((LocalUserDTO) userDTO);\r\n            }\r\n        }\r\n    \r\n    }\r\n\r\n  [1]: https://github.com/mapstruct/mapstruct/issues/131","title":"MapStruct generic Map and map combined list of children objects","body":"<p>Currently, it seems it's not available yet as a feature for mapstruct :  <a href=\"https://github.com/mapstruct/mapstruct/issues/131\" rel=\"nofollow noreferrer\">Support for Type-Refinement mapping (or Downcast Mapping)</a></p>\n\n<p>I asked the question in their google group: <a href=\"https://groups.google.com/forum/?fromgroups#!topic/mapstruct-users/PqB-g1SBTPg\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/?fromgroups#!topic/mapstruct-users/PqB-g1SBTPg</a></p>\n\n<p>and found that I need to do manual mapping using <code>default</code> method inside interface (for java 8).</p>\n\n<p>And got another issue for mapping parent that was almost not applicable so I write one more empty class that child of parent class called <code>LocalUserDTO</code>: </p>\n\n<p>So the code becomes like the following:</p>\n\n<pre><code>@Mapper\npublic interface UserMapper {\n    public static UserMapper INSTANCE = Mappers.getMapper(UserMapper.class);\n\n    LocalUser map(LocalUserDTO userDTO);\n\n    @InheritInverseConfiguration\n    LocalUserDTO map(LocalUser user);\n\n\n    List&lt;UserDTO&gt; map(List&lt;User&gt; users);\n\n    FacebookUser map(FacebookUserDTO userDTO);\n\n    @InheritInverseConfiguration\n    FacebookUserDTO map(FacebookUser user);\n\n    TwitterUser map(TwitterUserDTO userDTO);\n\n    @InheritInverseConfiguration\n    TwitterUserDTO map(TwitterUser user);\n\n    default UserDTO map(User user) {\n\n        if (user instanceof FacebookUser) {\n            return this.map((FacebookUser) user);\n        } else if (user instanceof TwitterUser) {\n            return this.map((TwitterUser) user);\n        } else {\n            return this.map((LocalUser) user);\n        }\n    }\n\n    @InheritInverseConfiguration\n    default User map(UserDTO userDTO) {\n        if (userDTO instanceof FacebookUserDTO) {\n            return this.map((FacebookUserDTO) userDTO);\n        } else if (userDTO instanceof TwitterUserDTO) {\n            return this.map((TwitterUserDTO) userDTO);\n        } else {\n            return this.map((LocalUserDTO) userDTO);\n        }\n    }\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":22394573,"reputation":140,"user_id":16606026,"display_name":"user16606026"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1672909002,"creation_date":1672191482,"answer_id":74935499,"question_id":39773923,"body_markdown":"Was googling about this exact issue yesterday, but couldn&#39;t find anything on internet, so let&#39;s leave this here.\r\n\r\nAs the issue mentioned in the former answer has been solved earlier this year, Mapstruct now officially supports downcasting by `@SubclassMapping`.\r\n\r\n```java\r\npublic interface UserMapper {\r\n    @Named(&quot;UserToDTO&quot;)\r\n    @SubclassMapping(source = FacebookUser.class, target = FacebookUserDTO.class)\r\n    @SubclassMapping(source = TwitterUser.class, target = TwitterUserDTO.class)\r\n    UserDTO toDTO(User source);\r\n}\r\n```\r\n\r\nHowever you can&#39;t put parameterized class i.e. `List&lt;User&gt;` in that annotation,  and Mapstruct isn&#39;t actually using this specification above for Lists. Hence, one more function is needed.\r\n\r\n```java\r\npublic interface UserMapper {\r\n    @Named(&quot;UserToDTOList&quot;)\r\n    @IterableMapping(qualifiedByName = &quot;UserToDTO&quot;)\r\n    List&lt;UserDTO&gt; toDTO(List&lt;User&gt; source);\r\n\r\n    @Named(&quot;UserToDTO&quot;)\r\n    @SubclassMapping(source = FacebookUser.class, target = FacebookUserDTO.class)\r\n    @SubclassMapping(source = TwitterUser.class, target = TwitterUserDTO.class)\r\n    UserDTO toDTO(User source);\r\n}\r\n```\r\n\r\nThis also applies to field in a class. For my case, we have a list field like that in a class. At first I only added `@SubclassMapping`, but after checking the code Mapstruct generated, I found that it isn&#39;t using the method for list converting. Adding `@IterableMapping` fixed that.\r\n\r\nConsider a `UsersWrapper` class with a list field in it.\r\n\r\n```java\r\npublic class UsersWrapper {\r\n  List&lt;User&gt; list;\r\n}\r\n```\r\n\r\nAnd a `UsersWrapperDTO`.\r\n\r\n```java\r\npublic class UsersWrapperDTO {\r\n  List&lt;UserDTO&gt; list;\r\n}\r\n```\r\n\r\nThen, we can use one more method in the mapper.\r\n\r\n```java\r\npublic interface UserMapper {\r\n\r\n    @Mapping(source = &quot;source.list&quot;, target = &quot;list&quot;, qualifiedByName = &quot;UserToDTOList&quot;)\r\n    UsersWrapperDTO toDTO(UsersWrapper source);\r\n\r\n    @Named(&quot;UserToDTOList&quot;)\r\n    @IterableMapping(qualifiedByName = &quot;UserToDTO&quot;)\r\n    List&lt;UserDTO&gt; toDTO(List&lt;User&gt; source);\r\n\r\n    @Named(&quot;UserToDTO&quot;)\r\n    @SubclassMapping(source = FacebookUser.class, target = FacebookUserDTO.class)\r\n    @SubclassMapping(source = TwitterUser.class, target = TwitterUserDTO.class)\r\n    UserDTO toDTO(User source);\r\n}\r\n```\r\n\r\nMapstruct actually generates very readable codes, so if you find it doesn&#39;t work like you thought, checking there first is also an option.\r\n\r\nAin&#39;t familiar with Mapstruct so took me a whole afternoon to put the pieces together! Though, it does seem simple and make sense that I need to combine these two annotations together. Hopefully this post will save people some time.","title":"MapStruct generic Map and map combined list of children objects","body":"<p>Was googling about this exact issue yesterday, but couldn't find anything on internet, so let's leave this here.</p>\n<p>As the issue mentioned in the former answer has been solved earlier this year, Mapstruct now officially supports downcasting by <code>@SubclassMapping</code>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public interface UserMapper {\n    @Named(&quot;UserToDTO&quot;)\n    @SubclassMapping(source = FacebookUser.class, target = FacebookUserDTO.class)\n    @SubclassMapping(source = TwitterUser.class, target = TwitterUserDTO.class)\n    UserDTO toDTO(User source);\n}\n</code></pre>\n<p>However you can't put parameterized class i.e. <code>List&lt;User&gt;</code> in that annotation,  and Mapstruct isn't actually using this specification above for Lists. Hence, one more function is needed.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public interface UserMapper {\n    @Named(&quot;UserToDTOList&quot;)\n    @IterableMapping(qualifiedByName = &quot;UserToDTO&quot;)\n    List&lt;UserDTO&gt; toDTO(List&lt;User&gt; source);\n\n    @Named(&quot;UserToDTO&quot;)\n    @SubclassMapping(source = FacebookUser.class, target = FacebookUserDTO.class)\n    @SubclassMapping(source = TwitterUser.class, target = TwitterUserDTO.class)\n    UserDTO toDTO(User source);\n}\n</code></pre>\n<p>This also applies to field in a class. For my case, we have a list field like that in a class. At first I only added <code>@SubclassMapping</code>, but after checking the code Mapstruct generated, I found that it isn't using the method for list converting. Adding <code>@IterableMapping</code> fixed that.</p>\n<p>Consider a <code>UsersWrapper</code> class with a list field in it.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class UsersWrapper {\n  List&lt;User&gt; list;\n}\n</code></pre>\n<p>And a <code>UsersWrapperDTO</code>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class UsersWrapperDTO {\n  List&lt;UserDTO&gt; list;\n}\n</code></pre>\n<p>Then, we can use one more method in the mapper.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public interface UserMapper {\n\n    @Mapping(source = &quot;source.list&quot;, target = &quot;list&quot;, qualifiedByName = &quot;UserToDTOList&quot;)\n    UsersWrapperDTO toDTO(UsersWrapper source);\n\n    @Named(&quot;UserToDTOList&quot;)\n    @IterableMapping(qualifiedByName = &quot;UserToDTO&quot;)\n    List&lt;UserDTO&gt; toDTO(List&lt;User&gt; source);\n\n    @Named(&quot;UserToDTO&quot;)\n    @SubclassMapping(source = FacebookUser.class, target = FacebookUserDTO.class)\n    @SubclassMapping(source = TwitterUser.class, target = TwitterUserDTO.class)\n    UserDTO toDTO(User source);\n}\n</code></pre>\n<p>Mapstruct actually generates very readable codes, so if you find it doesn't work like you thought, checking there first is also an option.</p>\n<p>Ain't familiar with Mapstruct so took me a whole afternoon to put the pieces together! Though, it does seem simple and make sense that I need to combine these two annotations together. Hopefully this post will save people some time.</p>\n"}],"owner":{"account_id":755765,"reputation":8010,"user_id":765965,"accept_rate":94,"display_name":"Al-Mothafar"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":7950,"favorite_count":0,"down_vote_count":0,"up_vote_count":8,"accepted_answer_id":39827492,"answer_count":2,"score":8,"last_activity_date":1672909002,"creation_date":1475161657,"question_id":39773923,"body_markdown":"I have as parent class : `User.java` , and 2 classes : `FacebookUser.java` and `TwitterUser.java` they are entities that returned depends on the type column in database using `DiscriminatorColumn`, I want to write correct mapper to map User that could be instance of FacebookUser or TwitterUser. I have the following mapper that seems not works as intended, only Mapping the `User` parent not the children:\r\n\r\n    @Mapper\r\n    public interface UserMapper {\r\n        public static UserMapper INSTANCE = Mappers.getMapper(UserMapper.class);\r\n    \r\n        User map(UserDTO userDTO);\r\n    \r\n        @InheritInverseConfiguration\r\n        UserDTO map(User user);\r\n    \r\n        List&lt;UserDTO&gt; map(List&lt;User&gt; users);\r\n    \r\n        FacebookUser map(FacebookUserDTO userDTO);\r\n    \r\n        @InheritInverseConfiguration\r\n        FacebookUserDTO map(FacebookUser user);\r\n    \r\n        TwitterUser map(TwitterUserDTO userDTO);\r\n    \r\n        @InheritInverseConfiguration\r\n        TwitterUserDTO map(TwitterUser user);\r\n        \r\n    }\r\n\r\nThen I use : \r\n\r\n    UserDTO userDto = UserMapper.INSTANCE.map(user);\r\n\r\nClasses to map:\r\n\r\n    @Entity\r\n    @Table(name = &quot;users&quot;)\r\n    @Inheritance(strategy = InheritanceType.SINGLE_TABLE)\r\n    @DiscriminatorColumn(name = &quot;type&quot;, discriminatorType = DiscriminatorType.STRING, length = 10)\r\n    @DiscriminatorValue(value = &quot;Local&quot;)\r\n    public class User {\r\n        @Column\r\n        private String firstName;\r\n        @Column\r\n        private String lastName;\r\n        ///... setters and getters\r\n    }\r\n    \r\n    @Entity\r\n    @DiscriminatorValue(value = &quot;Facebook&quot;)\r\n    public class FacebookUser extends User {\r\n        @Column\r\n        private String userId;\r\n        ///... setters and getters\r\n    }\r\n    \r\n    @Entity\r\n    @DiscriminatorValue(value = &quot;Twitter&quot;)\r\n    public class TwitterUser extends User {\r\n        @Column\r\n        private String screenName; \r\n        ///... setters and getters\r\n    }\r\n    \r\nThe DTOs: \r\n\r\n    public class UserDTO {\r\n        private String firstName;\r\n        private String lastName;\r\n        ///... setters and getters\r\n    }\r\n    \r\n    public class FacebookUserDTO extends UserDTO {\r\n        private String userId;\r\n        ///... setters and getters\r\n    }\r\n    \r\n    public class TwitterUserDTO extends UserDTO {\r\n        private String screenName; \r\n        ///... setters and getters\r\n    }\r\n\r\nAlso if I have list of users that mixed with Facebook users and Twitter users, or basic user:\r\n\r\nLets say I have the following users:\r\n\r\n    User user = new User (&quot;firstName&quot;,&quot;lastName&quot;);\r\n    User fbUser = new FacebookUser (&quot;firstName&quot;,&quot;lastName&quot;,&quot;userId&quot;);\r\n    User twUser = new TwitterUser (&quot;firstName&quot;,&quot;lastName&quot;,&quot;screenName&quot;);\r\n    \r\n    List&lt;User&gt; users = new ArrayList&lt;&gt;();\r\n    users.add(user);\r\n    users.add(fbUser);\r\n    users.add(twUser);\r\n    \r\n    //Then: \r\n    \r\n    List&lt;UserDTO&gt; dtos = UserMapper.INSTANCE.map(users);\r\n\r\nI get only `firstName` and `lastName` but not `screenName` or `userId`.\r\n\r\nAny solution for this?","title":"MapStruct generic Map and map combined list of children objects","body":"<p>I have as parent class : <code>User.java</code> , and 2 classes : <code>FacebookUser.java</code> and <code>TwitterUser.java</code> they are entities that returned depends on the type column in database using <code>DiscriminatorColumn</code>, I want to write correct mapper to map User that could be instance of FacebookUser or TwitterUser. I have the following mapper that seems not works as intended, only Mapping the <code>User</code> parent not the children:</p>\n\n<pre><code>@Mapper\npublic interface UserMapper {\n    public static UserMapper INSTANCE = Mappers.getMapper(UserMapper.class);\n\n    User map(UserDTO userDTO);\n\n    @InheritInverseConfiguration\n    UserDTO map(User user);\n\n    List&lt;UserDTO&gt; map(List&lt;User&gt; users);\n\n    FacebookUser map(FacebookUserDTO userDTO);\n\n    @InheritInverseConfiguration\n    FacebookUserDTO map(FacebookUser user);\n\n    TwitterUser map(TwitterUserDTO userDTO);\n\n    @InheritInverseConfiguration\n    TwitterUserDTO map(TwitterUser user);\n\n}\n</code></pre>\n\n<p>Then I use : </p>\n\n<pre><code>UserDTO userDto = UserMapper.INSTANCE.map(user);\n</code></pre>\n\n<p>Classes to map:</p>\n\n<pre><code>@Entity\n@Table(name = \"users\")\n@Inheritance(strategy = InheritanceType.SINGLE_TABLE)\n@DiscriminatorColumn(name = \"type\", discriminatorType = DiscriminatorType.STRING, length = 10)\n@DiscriminatorValue(value = \"Local\")\npublic class User {\n    @Column\n    private String firstName;\n    @Column\n    private String lastName;\n    ///... setters and getters\n}\n\n@Entity\n@DiscriminatorValue(value = \"Facebook\")\npublic class FacebookUser extends User {\n    @Column\n    private String userId;\n    ///... setters and getters\n}\n\n@Entity\n@DiscriminatorValue(value = \"Twitter\")\npublic class TwitterUser extends User {\n    @Column\n    private String screenName; \n    ///... setters and getters\n}\n</code></pre>\n\n<p>The DTOs: </p>\n\n<pre><code>public class UserDTO {\n    private String firstName;\n    private String lastName;\n    ///... setters and getters\n}\n\npublic class FacebookUserDTO extends UserDTO {\n    private String userId;\n    ///... setters and getters\n}\n\npublic class TwitterUserDTO extends UserDTO {\n    private String screenName; \n    ///... setters and getters\n}\n</code></pre>\n\n<p>Also if I have list of users that mixed with Facebook users and Twitter users, or basic user:</p>\n\n<p>Lets say I have the following users:</p>\n\n<pre><code>User user = new User (\"firstName\",\"lastName\");\nUser fbUser = new FacebookUser (\"firstName\",\"lastName\",\"userId\");\nUser twUser = new TwitterUser (\"firstName\",\"lastName\",\"screenName\");\n\nList&lt;User&gt; users = new ArrayList&lt;&gt;();\nusers.add(user);\nusers.add(fbUser);\nusers.add(twUser);\n\n//Then: \n\nList&lt;UserDTO&gt; dtos = UserMapper.INSTANCE.map(users);\n</code></pre>\n\n<p>I get only <code>firstName</code> and <code>lastName</code> but not <code>screenName</code> or <code>userId</code>.</p>\n\n<p>Any solution for this?</p>\n"},{"tags":["java","rabin-karp"],"answers":[{"comments":[{"owner":{"account_id":16453280,"reputation":87,"user_id":11886164,"display_name":"Coding Enthusiast"},"score":0,"creation_date":1672909656,"post_id":75015887,"comment_id":132380495,"body_markdown":"I agree with you. But, if you see for loop written there also pow calculated data is stored in int there issue is not generated. can you tell me why?\n\n\n```  for(;i&lt;pLength;i++)\n            res+= (pattern.charAt(i)-&#39;a&#39;+1)*Math.pow(10,n--); ```","body":"I agree with you. But, if you see for loop written there also pow calculated data is stored in int there issue is not generated. can you tell me why?   ```  for(;i&lt;pLength;i++)             res+= (pattern.charAt(i)-&#39;a&#39;+1)*Math.pow(10,n--); ```"},{"owner":{"account_id":5823420,"reputation":785,"user_id":6656833,"display_name":"Pavel"},"score":0,"creation_date":1672909968,"post_id":75015887,"comment_id":132380592,"body_markdown":"that is because the expression `(text.charAt(i) - &#39;a&#39; + 1)` will be an `int` and then you would multiply int times double so the double will be casted to int","body":"that is because the expression <code>(text.charAt(i) - &#39;a&#39; + 1)</code> will be an <code>int</code> and then you would multiply int times double so the double will be casted to int"},{"owner":{"account_id":16453280,"reputation":87,"user_id":11886164,"display_name":"Coding Enthusiast"},"score":0,"creation_date":1672910340,"post_id":75015887,"comment_id":132380726,"body_markdown":"Thanks for Reply, But the Question is still as it is because \n\nAs you said \n`res+= (pattern.charAt(i)-&#39;a&#39;+1)*Math.pow(10,n--);`\n            first integer * double will be integer \n\n\ninside the while loop where error is present \n`int sub= (text.charAt(i-pLength)-&#39;a&#39;+1)*p;`\n\n\n\n(text.charAt(i-pLength)-&#39;a&#39;+1) -&gt; integer \np is double \n\nand the multiplication is expected to perform and result should be int as you said \nbut I got the error","body":"Thanks for Reply, But the Question is still as it is because   As you said  <code>res+= (pattern.charAt(i)-&#39;a&#39;+1)*Math.pow(10,n--);</code>             first integer * double will be integer    inside the while loop where error is present  <code>int sub= (text.charAt(i-pLength)-&#39;a&#39;+1)*p;</code>    (text.charAt(i-pLength)-&#39;a&#39;+1) -&gt; integer  p is double   and the multiplication is expected to perform and result should be int as you said  but I got the error"},{"owner":{"account_id":5823420,"reputation":785,"user_id":6656833,"display_name":"Pavel"},"score":0,"creation_date":1672910560,"post_id":75015887,"comment_id":132380799,"body_markdown":"you should get error on this line `int p= Math.pow(10,n);`, don&#39;t you?","body":"you should get error on this line <code>int p= Math.pow(10,n);</code>, don&#39;t you?"},{"owner":{"account_id":16453280,"reputation":87,"user_id":11886164,"display_name":"Coding Enthusiast"},"score":0,"creation_date":1672988334,"post_id":75015887,"comment_id":132401233,"body_markdown":"I got the error on line you mentioned. But same thing is written `res+=(pattern.charAt(i) - &#39;a&#39;+1)*Math.pow(10,n--);` and `curr+= (text.charAt(i)-&#39;a&#39;+1)*Math.pow(10,n--);` \n\nWhy error are not coming here.","body":"I got the error on line you mentioned. But same thing is written <code>res+=(pattern.charAt(i) - &#39;a&#39;+1)*Math.pow(10,n--);</code> and <code>curr+= (text.charAt(i)-&#39;a&#39;+1)*Math.pow(10,n--);</code>   Why error are not coming here."}],"tags":[],"owner":{"account_id":5823420,"reputation":785,"user_id":6656833,"display_name":"Pavel"},"comment_count":5,"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1672908909,"creation_date":1672908909,"answer_id":75015887,"question_id":75015753,"body_markdown":"the pow method from Math will give you a double, you have to cast it manually:\r\n`int p= (int) Math.pow(10,n);`\r\nsee also https://stackoverflow.com/questions/8071363/calculating-powers-of-integers","title":"lossy conversion from double to int for Rabin Karp Algorithm Code","body":"<p>the pow method from Math will give you a double, you have to cast it manually:\n<code>int p= (int) Math.pow(10,n);</code>\nsee also <a href=\"https://stackoverflow.com/questions/8071363/calculating-powers-of-integers\">Calculating powers of integers</a></p>\n"}],"owner":{"account_id":16453280,"reputation":87,"user_id":11886164,"display_name":"Coding Enthusiast"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":20,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1672908909,"creation_date":1672908084,"question_id":75015753,"body_markdown":"I was referring the code for Rabin karp algorithm. But inside the while loop it is Giving an error \r\n\r\npossible lossy conversion from double to int. \r\nCan anyone please help me to resolve this error. \r\n\r\n```\r\nimport java.util.Scanner;\r\n\r\npublic class Main {\r\n    static boolean rabinKarp(String text, String pattern) {\r\n        int pLength= pattern.length();\r\n        int n=pLength-1;\r\n        int res=0, curr=0;\r\n        int i=0;\r\n        for(;i&lt;pLength;i++)\r\n            res+= (pattern.charAt(i)-&#39;a&#39;+1)*Math.pow(10,n--);\r\n        \r\n        n=pLength-1;  \r\n        for(i=0;i&lt;pLength;i++)\r\n            curr+= (text.charAt(i)-&#39;a&#39;+1)*Math.pow(10,n--);\r\n        if(res==curr)\r\n            return true;\r\n        n=pLength-1;\r\n        while(i&lt;text.length()){\r\n            int p= Math.pow(10,n);\r\n            int sub= (text.charAt(i-pLength)-&#39;a&#39;+1)*p;\r\n            int add= (text.charAt(i)-&#39;a&#39;+1);\r\n            curr= (curr-sub)*10+add;\r\n            if(res==curr)\r\n                return true;\r\n            i++;\r\n        }\r\n        return false;    \r\n        \r\n    }\r\n    \r\n   public static void main(String[] args) {\r\n    Scanner in = new Scanner(System.in);\r\n    String text = &quot;abcbab&quot;;\r\n    String pattern = &quot;bab&quot;;\r\n    System.out.println(rabinKarp(text,pattern));\r\n  }\r\n\r\n}\r\n```","title":"lossy conversion from double to int for Rabin Karp Algorithm Code","body":"<p>I was referring the code for Rabin karp algorithm. But inside the while loop it is Giving an error</p>\n<p>possible lossy conversion from double to int.\nCan anyone please help me to resolve this error.</p>\n<pre><code>import java.util.Scanner;\n\npublic class Main {\n    static boolean rabinKarp(String text, String pattern) {\n        int pLength= pattern.length();\n        int n=pLength-1;\n        int res=0, curr=0;\n        int i=0;\n        for(;i&lt;pLength;i++)\n            res+= (pattern.charAt(i)-'a'+1)*Math.pow(10,n--);\n        \n        n=pLength-1;  \n        for(i=0;i&lt;pLength;i++)\n            curr+= (text.charAt(i)-'a'+1)*Math.pow(10,n--);\n        if(res==curr)\n            return true;\n        n=pLength-1;\n        while(i&lt;text.length()){\n            int p= Math.pow(10,n);\n            int sub= (text.charAt(i-pLength)-'a'+1)*p;\n            int add= (text.charAt(i)-'a'+1);\n            curr= (curr-sub)*10+add;\n            if(res==curr)\n                return true;\n            i++;\n        }\n        return false;    \n        \n    }\n    \n   public static void main(String[] args) {\n    Scanner in = new Scanner(System.in);\n    String text = &quot;abcbab&quot;;\n    String pattern = &quot;bab&quot;;\n    System.out.println(rabinKarp(text,pattern));\n  }\n\n}\n</code></pre>\n"},{"tags":["java","image","image-processing","processing","kinect"],"owner":{"account_id":25562543,"reputation":39,"user_id":19344937,"display_name":"Rose"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":39,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":0,"score":2,"last_activity_date":1672908877,"creation_date":1672908877,"question_id":75015878,"body_markdown":"The output image of using EasyOpenNI with an xbox360 kinect is a small 640 x 480 image, is there anyway to maybe scale it up to fullscreen, or near fullscreen.\r\n\r\nI tried using image.resize() but it creates additional images on the top, and the expanded image does not refresh, it gives the initial frame at boot.\r\n\r\nCode:\r\n~~~\r\nimport SimpleOpenNI.*;\r\n\r\nSimpleOpenNI kinect;\r\n \r\nPImage depthCam;\r\nPImage result;\r\n\r\nvoid setup()\r\n{\r\n  size(640, 480);\r\n  surface.setResizable(true);\r\n  background(0);\r\n\r\n  kinect  = new SimpleOpenNI(this);\r\n  kinect.enableDepth();\r\n \r\n  result = createImage(width,height,RGB);\r\n}\r\n \r\nvoid draw()\r\n{\r\n\r\n  background(0);\r\n  kinect.update();\r\n\r\n  depthCam = kinect.depthImage();\r\n  int[] depthVals = kinect.depthMap();\r\n\r\n  result.loadPixels();\r\n \r\n  for (int y=0; y&lt;depthCam.height; y=y+5)\r\n  {\r\n    for (int x =0; x&lt;depthCam.width; x=x+5)\r\n    {\r\n      int loc = x+(y*depthCam.width);\r\n\r\n      if (depthVals[loc] &lt;= 1200 &amp;&amp; depthVals[loc] &gt; 50) { \r\n        result.pixels[loc] = color(250);\r\n      }\r\n      else if (depthVals[loc] &gt; 1200 &amp;&amp; depthVals[loc]&lt; 3000 )\r\n      {\r\n        result.pixels[loc] = color(102);\r\n      }\r\n      else  {\r\n      //otherwise let the pixel value in the result image be white\r\n       result.pixels[loc] = color(0);\r\n      }\r\n \r\n    }\r\n  }\r\n\r\nresult.updatePixels();\r\nresult.resize(640*2,480*2);\r\nimage(result,0,0);\r\n\r\n}\r\n~~~\r\nHere is a screenshot of what appears:\r\n[![image](https://i.stack.imgur.com/PeHZQ.png)](https://i.stack.imgur.com/PeHZQ.png)\r\nEverything is working correctly, except for the fact that there are two duplicated streams at the top (that do refresh), and the enlarged stream does not refresh.","title":"How to resize the image of kinect with Processing","body":"<p>The output image of using EasyOpenNI with an xbox360 kinect is a small 640 x 480 image, is there anyway to maybe scale it up to fullscreen, or near fullscreen.</p>\n<p>I tried using image.resize() but it creates additional images on the top, and the expanded image does not refresh, it gives the initial frame at boot.</p>\n<p>Code:</p>\n<pre><code>import SimpleOpenNI.*;\n\nSimpleOpenNI kinect;\n \nPImage depthCam;\nPImage result;\n\nvoid setup()\n{\n  size(640, 480);\n  surface.setResizable(true);\n  background(0);\n\n  kinect  = new SimpleOpenNI(this);\n  kinect.enableDepth();\n \n  result = createImage(width,height,RGB);\n}\n \nvoid draw()\n{\n\n  background(0);\n  kinect.update();\n\n  depthCam = kinect.depthImage();\n  int[] depthVals = kinect.depthMap();\n\n  result.loadPixels();\n \n  for (int y=0; y&lt;depthCam.height; y=y+5)\n  {\n    for (int x =0; x&lt;depthCam.width; x=x+5)\n    {\n      int loc = x+(y*depthCam.width);\n\n      if (depthVals[loc] &lt;= 1200 &amp;&amp; depthVals[loc] &gt; 50) { \n        result.pixels[loc] = color(250);\n      }\n      else if (depthVals[loc] &gt; 1200 &amp;&amp; depthVals[loc]&lt; 3000 )\n      {\n        result.pixels[loc] = color(102);\n      }\n      else  {\n      //otherwise let the pixel value in the result image be white\n       result.pixels[loc] = color(0);\n      }\n \n    }\n  }\n\nresult.updatePixels();\nresult.resize(640*2,480*2);\nimage(result,0,0);\n\n}\n</code></pre>\n<p>Here is a screenshot of what appears:\n<a href=\"https://i.stack.imgur.com/PeHZQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PeHZQ.png\" alt=\"image\" /></a>\nEverything is working correctly, except for the fact that there are two duplicated streams at the top (that do refresh), and the enlarged stream does not refresh.</p>\n"},{"tags":["java","for-loop","selenium-webdriver"],"comments":[{"owner":{"account_id":25966286,"reputation":3,"user_id":19682196,"display_name":"Latest"},"score":0,"creation_date":1673250913,"post_id":75007255,"comment_id":132447561,"body_markdown":"is it hard to implement or noone cares? :)","body":"is it hard to implement or noone cares? :)"}],"owner":{"account_id":25966286,"reputation":3,"user_id":19682196,"display_name":"Latest"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":147,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672908777,"creation_date":1672844236,"question_id":75007255,"body_markdown":"on my project there is dynamically loaded table so each time when we scroll down, table is updating and rowcount starts from 0 or 1 i guess. and i want to iterate through whole table and get specific cell&#39;s text from every row. how can i do that? please, help.\r\nwhat i have done so far is:\r\n\r\n\t\tList&lt;WebElement&gt; currentGridTableRowsList = driver.findElements(\r\n\t\t\t\tBy.xpath(&quot;//table[@role=&#39;grid&#39;] //tbody/tr&quot;));\r\n        \r\n        //print current rows count\r\n\t\tint currentGridTableRows = currentGridTableRowsList.size();\r\n\t\tSystem.out.println(currentGridTableRows);\r\n\r\n\r\n\t\tfor (WebElement row : currentGridTableRowsList){\r\n\t\t\tList&lt;WebElement&gt; tdCollection = row.findElements(By.tagName(&quot;td&quot;));\r\n\t\t\tfor (WebElement td : tdCollection){\r\n\t\t\t\tString cellText = td.getText();\r\n\r\n\t\t\t\tSystem.out.println(cellText);\r\n\t\t\t}\r\n\t\t}\r\n\r\ncurrentGridTableRowsList.size() returns current grid number of rows - 10 for example. But attribute aria-rowcount returns 30 rows.\r\nI know there is a snippet\r\n\r\n    WebElement element = driver.findElement(By.xpath(‚Äú//table[@id = ‚ÄòtableID‚Äô]/tbody//tr[last()]‚Äù));\r\n    JavascriptExecutor js = (JavascriptExecutor) driver;\r\n    js.executeScript(‚Äúarguments[0].scrollIntoView();‚Äù, element);\r\n\r\nbut i don&#39;t know how to apply that, how to make correct for loops in Java language, so that when it is end of table (current grid), webdriver will scroll and when it is end of table (aria-rowcount) driver will quit. can you please tell me how to write correct for loop for the table and how to get specific cell value, for example td[2] of each row? ","title":"Iterate through dynamic table in for loop in java","body":"<p>on my project there is dynamically loaded table so each time when we scroll down, table is updating and rowcount starts from 0 or 1 i guess. and i want to iterate through whole table and get specific cell's text from every row. how can i do that? please, help.\nwhat i have done so far is:</p>\n<pre><code>    List&lt;WebElement&gt; currentGridTableRowsList = driver.findElements(\n            By.xpath(&quot;//table[@role='grid'] //tbody/tr&quot;));\n    \n    //print current rows count\n    int currentGridTableRows = currentGridTableRowsList.size();\n    System.out.println(currentGridTableRows);\n\n\n    for (WebElement row : currentGridTableRowsList){\n        List&lt;WebElement&gt; tdCollection = row.findElements(By.tagName(&quot;td&quot;));\n        for (WebElement td : tdCollection){\n            String cellText = td.getText();\n\n            System.out.println(cellText);\n        }\n    }\n</code></pre>\n<p>currentGridTableRowsList.size() returns current grid number of rows - 10 for example. But attribute aria-rowcount returns 30 rows.\nI know there is a snippet</p>\n<pre><code>WebElement element = driver.findElement(By.xpath(‚Äú//table[@id = ‚ÄòtableID‚Äô]/tbody//tr[last()]‚Äù));\nJavascriptExecutor js = (JavascriptExecutor) driver;\njs.executeScript(‚Äúarguments[0].scrollIntoView();‚Äù, element);\n</code></pre>\n<p>but i don't know how to apply that, how to make correct for loops in Java language, so that when it is end of table (current grid), webdriver will scroll and when it is end of table (aria-rowcount) driver will quit. can you please tell me how to write correct for loop for the table and how to get specific cell value, for example td[2] of each row?</p>\n"},{"tags":["java","zipinputstream"],"comments":[{"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"score":0,"creation_date":1672903760,"post_id":75014666,"comment_id":132378935,"body_markdown":"You could simplify the body of your `while` loop with [`InputStream#readAllBytes()`](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/io/InputStream.html#readAllBytes()), assuming you&#39;re using Java 9+.","body":"You could simplify the body of your <code>while</code> loop with <a href=\"https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/io/InputStream.html#readAllBytes()\" rel=\"nofollow noreferrer\"><code>InputStream#readAllBytes()</code></a>, assuming you&#39;re using Java 9+."},{"owner":{"account_id":16720659,"reputation":408,"user_id":12085680,"display_name":"BugsOverflow"},"score":0,"creation_date":1672906236,"post_id":75014666,"comment_id":132379506,"body_markdown":"@Slaw I am using 17, could you show in a comment/answer exactly where please?","body":"@Slaw I am using 17, could you show in a comment/answer exactly where please?"}],"answers":[{"comments":[{"owner":{"account_id":16720659,"reputation":408,"user_id":12085680,"display_name":"BugsOverflow"},"score":0,"creation_date":1672923681,"post_id":75015691,"comment_id":132385087,"body_markdown":"Will try it out and leave feedback, thank you, it will give me the bytes of each entry in the zip right? or is it the bytes of all zip?","body":"Will try it out and leave feedback, thank you, it will give me the bytes of each entry in the zip right? or is it the bytes of all zip?"},{"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"score":1,"creation_date":1672958206,"post_id":75015691,"comment_id":132396723,"body_markdown":"`readAllBytes()` essentially does exactly what you already have for you. It reads all the bytes until there are no more to read. And `ZipInputStream` does this per `ZipEntry`. So, it will only read the bytes of the current entry.","body":"<code>readAllBytes()</code> essentially does exactly what you already have for you. It reads all the bytes until there are no more to read. And <code>ZipInputStream</code> does this per <code>ZipEntry</code>. So, it will only read the bytes of the current entry."}],"tags":[],"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"comment_count":2,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1672907721,"creation_date":1672907721,"answer_id":75015691,"question_id":75014666,"body_markdown":"If you&#39;re using Java 9+ then you should be able to simplify that code with [`readAllBytes()`][1].\r\n\r\n```lang-java\r\npublic UnzippedFile unzip(ZipFile zipFile) throws IOException {\r\n    var unzippedFile = new UnzippedFile();\r\n    try (ZipInputStream zipInputStream = ZipUtils.toZipInputStream(zipFile)) {\r\n        ZipEntry entry;\r\n        while ((entry = zipInputStream.getNextEntry()) != null) {\r\n            String name = entry.getName();\r\n            byte[] file = zipInputStream.readAllBytes();\r\n\r\n            unzippedFile.addFileToMap(name, file);\r\n        }\r\n    }\r\n    return unzippedFile;\r\n}\r\n```\r\n\r\n  [1]: https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/io/InputStream.html#readAllBytes()","title":"How to get bytes from ZipEntry without using ByteArrayOutputStream","body":"<p>If you're using Java 9+ then you should be able to simplify that code with <a href=\"https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/io/InputStream.html#readAllBytes()\" rel=\"nofollow noreferrer\"><code>readAllBytes()</code></a>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public UnzippedFile unzip(ZipFile zipFile) throws IOException {\n    var unzippedFile = new UnzippedFile();\n    try (ZipInputStream zipInputStream = ZipUtils.toZipInputStream(zipFile)) {\n        ZipEntry entry;\n        while ((entry = zipInputStream.getNextEntry()) != null) {\n            String name = entry.getName();\n            byte[] file = zipInputStream.readAllBytes();\n\n            unzippedFile.addFileToMap(name, file);\n        }\n    }\n    return unzippedFile;\n}\n</code></pre>\n"}],"owner":{"account_id":16720659,"reputation":408,"user_id":12085680,"display_name":"BugsOverflow"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":121,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75015691,"answer_count":1,"score":0,"last_activity_date":1672907721,"creation_date":1672900827,"question_id":75014666,"body_markdown":"Is there a way to make this a little simpler? Since I need the bytes of each entry is there any way to get them without using the ByteArrayOutputStream\r\n\r\n    public UnzippedFile unzip(ZipFile zipFile) throws IOException {\r\n    \tvar unzippedFile = new UnzippedFile();\r\n    \ttry (ZipInputStream zipInputStream = ZipUtils.toZipInputStream(zipFile)) {\r\n    \t\tZipEntry entry;\r\n    \t\twhile ((entry = zipInputStream.getNextEntry()) != null) {\r\n    \t\t\tbyte[] buffer = new byte[1024];\r\n    \t\t\tint len;\r\n    \t\t\ttry (var file = new ByteArrayOutputStream(buffer.length)) {\r\n    \t\t\t\twhile ((len = zipInputStream.read(buffer)) &gt; 0) {\r\n    \t\t\t\t\tfile.write(buffer, 0, len);\r\n    \t\t\t\t}\r\n    \t\t\t\tunzippedFile.addFileToMap(entry.getName(), file.toByteArray());\r\n    \t\t\t}\r\n    \t\t}\r\n    \t}\r\n    \treturn unzippedFile;\r\n    }\r\n\r\nMy UnzippedFile class:\r\n\r\n    public class UnzippedFile {\r\n    \t@Getter\r\n    \tprivate final Map&lt;String, byte[]&gt; filesMap;\r\n    \r\n    \tpublic UnzippedFile() {\r\n    \t\tthis.filesMap = new HashMap&lt;&gt;();\r\n    \t}\r\n    \r\n    \tpublic void addFileToMap(String name, byte[] file) {\r\n    \t\tfilesMap.put(name, file);\r\n    \t}\r\n    \r\n    }","title":"How to get bytes from ZipEntry without using ByteArrayOutputStream","body":"<p>Is there a way to make this a little simpler? Since I need the bytes of each entry is there any way to get them without using the ByteArrayOutputStream</p>\n<pre><code>public UnzippedFile unzip(ZipFile zipFile) throws IOException {\n    var unzippedFile = new UnzippedFile();\n    try (ZipInputStream zipInputStream = ZipUtils.toZipInputStream(zipFile)) {\n        ZipEntry entry;\n        while ((entry = zipInputStream.getNextEntry()) != null) {\n            byte[] buffer = new byte[1024];\n            int len;\n            try (var file = new ByteArrayOutputStream(buffer.length)) {\n                while ((len = zipInputStream.read(buffer)) &gt; 0) {\n                    file.write(buffer, 0, len);\n                }\n                unzippedFile.addFileToMap(entry.getName(), file.toByteArray());\n            }\n        }\n    }\n    return unzippedFile;\n}\n</code></pre>\n<p>My UnzippedFile class:</p>\n<pre><code>public class UnzippedFile {\n    @Getter\n    private final Map&lt;String, byte[]&gt; filesMap;\n\n    public UnzippedFile() {\n        this.filesMap = new HashMap&lt;&gt;();\n    }\n\n    public void addFileToMap(String name, byte[] file) {\n        filesMap.put(name, file);\n    }\n\n}\n</code></pre>\n"},{"tags":["java","list","itext7"],"comments":[{"owner":{"account_id":5823420,"reputation":785,"user_id":6656833,"display_name":"Pavel"},"score":0,"creation_date":1672900019,"post_id":75014520,"comment_id":132378128,"body_markdown":"what encoding are you using?","body":"what encoding are you using?"}],"answers":[{"tags":[],"owner":{"account_id":345916,"reputation":461,"user_id":679116,"display_name":"S_G"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672907502,"creation_date":1672907502,"answer_id":75015656,"question_id":75014520,"body_markdown":"Can you try the following code to render &quot;‚òê&quot; as bullet point.\r\n\r\n        PdfWriter writer = new PdfWriter(&quot;src/main/resources/test/list.PDF&quot;);\r\n\t\tPdfDocument pdfDoc = new PdfDocument(writer);\r\n\t\tpdfDoc.setDefaultPageSize(PageSize.A4);\r\n\t\tDocument doc = new Document(pdfDoc);\r\n\t\t\r\n\t\tPdfFont unicodeFont = PdfFontFactory.createFont(&quot;src/main/resources/test/arial.ttf&quot;, PdfEncodings.IDENTITY_H);\r\n\t\t\r\n\t\t List list = new List();\r\n\t\t list.setFont(unicodeFont);\r\n\t\t list.setListSymbol(&quot;‚òê&quot;);\r\n\r\n\t\t list.add(new ListItem(&quot;list 1&quot;));\r\n\t\t list.add(new ListItem(&quot;list 2&quot;));\r\n\t\t list.add(new ListItem(&quot;list 3&quot;));\r\n\t\t \r\n\t\t doc.add(list);\r\n\t\t doc.close();","title":"List symbol not showing when inputing a special character in List.setListSymbol() in itext7","body":"<p>Can you try the following code to render &quot;‚òê&quot; as bullet point.</p>\n<pre><code>    PdfWriter writer = new PdfWriter(&quot;src/main/resources/test/list.PDF&quot;);\n    PdfDocument pdfDoc = new PdfDocument(writer);\n    pdfDoc.setDefaultPageSize(PageSize.A4);\n    Document doc = new Document(pdfDoc);\n    \n    PdfFont unicodeFont = PdfFontFactory.createFont(&quot;src/main/resources/test/arial.ttf&quot;, PdfEncodings.IDENTITY_H);\n    \n     List list = new List();\n     list.setFont(unicodeFont);\n     list.setListSymbol(&quot;‚òê&quot;);\n\n     list.add(new ListItem(&quot;list 1&quot;));\n     list.add(new ListItem(&quot;list 2&quot;));\n     list.add(new ListItem(&quot;list 3&quot;));\n     \n     doc.add(list);\n     doc.close();\n</code></pre>\n"}],"owner":{"display_name":"user20774904"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":35,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672907502,"creation_date":1672899697,"question_id":75014520,"body_markdown":"I am trying to set the list symbol for my list to ‚òê but for some reason when the pdf is created, nothing shows. \r\n\r\nI tried \r\n\r\n```\r\nList list = new List().setListSymbol(&quot;\\u2610&quot;);\r\n```\r\n\r\nAnd also,\r\n```\r\nList list = new List().setListSymbol(&quot;‚òê&quot;);\r\n```\r\nI also tried \r\n```\r\nList list = new List().setListSymbol(&quot;&gt;&quot;);\r\n```\r\njust to make sure the code was working and it was - the list showed up with &quot;&gt;&quot; as the bullet point. \r\n\r\nHow can I get the bullet point of my list to be &quot;‚òê&quot;?\r\n","title":"List symbol not showing when inputing a special character in List.setListSymbol() in itext7","body":"<p>I am trying to set the list symbol for my list to ‚òê but for some reason when the pdf is created, nothing shows.</p>\n<p>I tried</p>\n<pre><code>List list = new List().setListSymbol(&quot;\\u2610&quot;);\n</code></pre>\n<p>And also,</p>\n<pre><code>List list = new List().setListSymbol(&quot;‚òê&quot;);\n</code></pre>\n<p>I also tried</p>\n<pre><code>List list = new List().setListSymbol(&quot;&gt;&quot;);\n</code></pre>\n<p>just to make sure the code was working and it was - the list showed up with &quot;&gt;&quot; as the bullet point.</p>\n<p>How can I get the bullet point of my list to be &quot;‚òê&quot;?</p>\n"},{"tags":["java","cron","quartz-scheduler"],"comments":[{"owner":{"account_id":1060232,"reputation":1271,"user_id":1062022,"display_name":"Justmaker"},"score":1,"creation_date":1672827689,"post_id":75003833,"comment_id":132359119,"body_markdown":"Hi! Would you be able to share some code to see what you are working with so we can answer as precisely as possible?","body":"Hi! Would you be able to share some code to see what you are working with so we can answer as precisely as possible?"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1672831832,"post_id":75003833,"comment_id":132360331,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."},{"owner":{"account_id":8571974,"reputation":1,"user_id":6422521,"display_name":"Abhi Shek"},"score":0,"creation_date":1672906229,"post_id":75003833,"comment_id":132379501,"body_markdown":"I cant share in full but updated above with some code on how I was thinking to do it.","body":"I cant share in full but updated above with some code on how I was thinking to do it."}],"answers":[{"comments":[{"owner":{"account_id":8571974,"reputation":1,"user_id":6422521,"display_name":"Abhi Shek"},"score":0,"creation_date":1672906343,"post_id":75004016,"comment_id":132379535,"body_markdown":"the question is different sir","body":"the question is different sir"}],"tags":[],"owner":{"account_id":21442291,"reputation":42,"user_id":15796597,"display_name":"Sandeep Mehra"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672907185,"creation_date":1672827692,"answer_id":75004016,"question_id":75003833,"body_markdown":"You can try this if you need to run these task at a specific time of day:\r\n\r\n```\r\n00 16 * * * /home/theUser/alca/test1.sh\r\n10 16 * * * /home/theUser/alca/test2.sh\r\n```\r\n\r\nThese are two jobs and the second job should be in second line.  You see that the first job will run daily at 4 PM and the second job will run at 4:10 PM.","title":"Run a job 10 minutes after another job with quartz cron","body":"<p>You can try this if you need to run these task at a specific time of day:</p>\n<pre><code>00 16 * * * /home/theUser/alca/test1.sh\n10 16 * * * /home/theUser/alca/test2.sh\n</code></pre>\n<p>These are two jobs and the second job should be in second line.  You see that the first job will run daily at 4 PM and the second job will run at 4:10 PM.</p>\n"}],"owner":{"account_id":8571974,"reputation":1,"user_id":6422521,"display_name":"Abhi Shek"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":195,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672907185,"creation_date":1672826694,"question_id":75003833,"body_markdown":"Basically I want to run a monitoring job after 10 minutes. For that I need to add 10 minutes to the actual cron I have from original job. This 10 minutes is like buffer and expecting that it will be enough for original job to complete. In other cases my monitoring job will alert me. Assuming I use quartz cron.\r\n\r\nI tried parsing the cron but it leads to too many cases and quickly becoming complex to understand.\r\n\r\nbut cron expressions have *,?, ranges, increments , comma-separated numbers etc\r\nIs it even advisable to do so?\r\n\r\nsample code:\r\n\r\n    static String addMinutes(String period) throws ParseException {\r\n        CronExpression cron = new CronExpression(period);\r\n        String[] arr = period.split(&quot; &quot;);\r\n        String minutes = arr[1];\r\n        String hours = arr[2];\r\n        if(minutes.contains(&quot;,&quot;)){\r\n            \r\n        } else if (minutes.contains(&quot;-&quot;)) {\r\n            \r\n        } else if (minutes.contains(&quot;/&quot;)) {\r\n            \r\n        } else if (isInteger(minutes)) {\r\n            int i = Integer.parseInt(minutes);\r\n            i = (i+9) % 59;\r\n            arr[1] = Integer.toString(i);\r\n            //change hour\r\n            if(i &gt; 49 &amp;&amp; isInteger(hours)){\r\n                int h = Integer.parseInt(hours);\r\n                h = (h+1) % 24;\r\n                arr[2] = Integer.toString(h);\r\n            }\r\n        }\r\n        return period;\r\n    }\r\n","title":"Run a job 10 minutes after another job with quartz cron","body":"<p>Basically I want to run a monitoring job after 10 minutes. For that I need to add 10 minutes to the actual cron I have from original job. This 10 minutes is like buffer and expecting that it will be enough for original job to complete. In other cases my monitoring job will alert me. Assuming I use quartz cron.</p>\n<p>I tried parsing the cron but it leads to too many cases and quickly becoming complex to understand.</p>\n<p>but cron expressions have *,?, ranges, increments , comma-separated numbers etc\nIs it even advisable to do so?</p>\n<p>sample code:</p>\n<pre><code>static String addMinutes(String period) throws ParseException {\n    CronExpression cron = new CronExpression(period);\n    String[] arr = period.split(&quot; &quot;);\n    String minutes = arr[1];\n    String hours = arr[2];\n    if(minutes.contains(&quot;,&quot;)){\n        \n    } else if (minutes.contains(&quot;-&quot;)) {\n        \n    } else if (minutes.contains(&quot;/&quot;)) {\n        \n    } else if (isInteger(minutes)) {\n        int i = Integer.parseInt(minutes);\n        i = (i+9) % 59;\n        arr[1] = Integer.toString(i);\n        //change hour\n        if(i &gt; 49 &amp;&amp; isInteger(hours)){\n            int h = Integer.parseInt(hours);\n            h = (h+1) % 24;\n            arr[2] = Integer.toString(h);\n        }\n    }\n    return period;\n}\n</code></pre>\n"},{"tags":["java","selenium","selenium-webdriver","selenium-java"],"comments":[{"owner":{"account_id":12360572,"reputation":1730,"user_id":9014957,"accept_rate":17,"display_name":"pburgr"},"score":0,"creation_date":1672659169,"post_id":74977239,"comment_id":132320856,"body_markdown":"How to make the ad to show up? It don&#39;t appear in any browser.","body":"How to make the ad to show up? It don&#39;t appear in any browser."},{"owner":{"account_id":19497668,"reputation":11,"user_id":14264467,"display_name":"Guy"},"score":0,"creation_date":1672853376,"post_id":74977239,"comment_id":132368175,"body_markdown":"Hi pburgr, I&#39;m able to see the ad only in the chromedriver browser","body":"Hi pburgr, I&#39;m able to see the ad only in the chromedriver browser"},{"owner":{"account_id":12360572,"reputation":1730,"user_id":9014957,"accept_rate":17,"display_name":"pburgr"},"score":0,"creation_date":1672900533,"post_id":74977239,"comment_id":132378210,"body_markdown":"in my case even in chromedriver the ad doesn&#39;t show up.","body":"in my case even in chromedriver the ad doesn&#39;t show up."},{"owner":{"account_id":19497668,"reputation":11,"user_id":14264467,"display_name":"Guy"},"score":0,"creation_date":1672902609,"post_id":74977239,"comment_id":132378648,"body_markdown":"Wierd, 90% of the times when I click on &quot;My Account&quot; via the chromedriver it&#39;s showing me the ad","body":"Wierd, 90% of the times when I click on &quot;My Account&quot; via the chromedriver it&#39;s showing me the ad"}],"answers":[{"comments":[{"owner":{"account_id":19497668,"reputation":11,"user_id":14264467,"display_name":"Guy"},"score":0,"creation_date":1672853104,"post_id":74989520,"comment_id":132368084,"body_markdown":"Thanks Fouzan Jafri, these two options seem that skip the advertisement,\nBut I am still trying to search for a way to handle this popUp, \nI can&#39;t understand what is wrong in my code, I&#39;m switching to each frame of the advertisement and I can&#39;t click the &quot;dismiss-button&quot;","body":"Thanks Fouzan Jafri, these two options seem that skip the advertisement, But I am still trying to search for a way to handle this popUp,  I can&#39;t understand what is wrong in my code, I&#39;m switching to each frame of the advertisement and I can&#39;t click the &quot;dismiss-button&quot;"}],"tags":[],"owner":{"account_id":22542267,"reputation":11,"user_id":16732700,"display_name":"Fouzan Jafri"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672725451,"creation_date":1672725451,"answer_id":74989520,"question_id":74977239,"body_markdown":"It is hard to handle advertisement popUp. So we can handle it in 2 ways:\r\n\r\n1. downloading ad-blocker extension to your chrome and using the chrome option code.\r\n* download ad-bocker- https://chrome.google.com/webstore/detail/adblock-%E2%80%94-best-ad-blocker/gighmmpiobklfepjocnamgkkbiglidom\r\n* use chromeoption driver code:\r\n\tChromeOptions chromeOptions = new ChromeOptions();\r\n\tchromeOptions.addArguments(&quot;disable-infobars&quot;);\r\n\r\n2. Notice that popUp gets disabled is do back. so we can is click on myaccount go back and then click back:\r\n\r\n    \t\tWebElement MyAccount = driver.findElement(By.xpath(&quot;//[@href=&#39;https://practice.automationtesting.in/my-account/&#39;]&quot;));\r\n\t\tMyAccount.click();\r\n\t\tdriver.navigate().back();\r\n\t\tMyAccount.click();\r\n\r\n\r\n","title":"How can I click a floating advertisement?","body":"<p>It is hard to handle advertisement popUp. So we can handle it in 2 ways:</p>\n<ol>\n<li>downloading ad-blocker extension to your chrome and using the chrome option code.</li>\n</ol>\n<ul>\n<li>download ad-bocker- <a href=\"https://chrome.google.com/webstore/detail/adblock-%E2%80%94-best-ad-blocker/gighmmpiobklfepjocnamgkkbiglidom\" rel=\"nofollow noreferrer\">https://chrome.google.com/webstore/detail/adblock-%E2%80%94-best-ad-blocker/gighmmpiobklfepjocnamgkkbiglidom</a></li>\n<li>use chromeoption driver code:\nChromeOptions chromeOptions = new ChromeOptions();\nchromeOptions.addArguments(&quot;disable-infobars&quot;);</li>\n</ul>\n<ol start=\"2\">\n<li><p>Notice that popUp gets disabled is do back. so we can is click on myaccount go back and then click back:</p>\n<pre><code>     WebElement MyAccount = driver.findElement(By.xpath(&quot;//[@href='https://practice.automationtesting.in/my-account/']&quot;));\n MyAccount.click();\n driver.navigate().back();\n MyAccount.click();\n</code></pre>\n</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":19497668,"reputation":11,"user_id":14264467,"display_name":"Guy"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672906273,"creation_date":1672906256,"answer_id":75015475,"question_id":74977239,"body_markdown":"Found the issue: \r\n1. My &#39;wait&#39; not always working, so the driver tries to close the ad when not displayed - still searching for a way to correct this\r\n2. It&#39;s working without frame1: &quot;google_esf&quot;, only frame2 and frame3 needed\r\n\r\nUpdated code:\r\n\r\n            public void clickMyAccount() {\r\n            System.out.println(&quot;Click My Account&quot;);\r\n    \r\n            if(driver.findElement(myAccountBtn).isDisplayed()){\r\n                driver.findElement(myAccountBtn).click();\r\n                driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));\r\n                driver.manage().timeouts().pageLoadTimeout(Duration.ofSeconds(10));\r\n            } else {\r\n                System.out.println(&quot;My account button not displayed&quot;);\r\n            }\r\n    \r\n        }\r\n    \r\n        public void clickCloseAd(){\r\n            System.out.println(&quot;Click Close Ad&quot;);\r\n    \r\n    \r\n                if(driver.findElement(By.id(&quot;aswift_9&quot;)).isDisplayed()){\r\n    //                driver.switchTo().frame(driver.findElement(By.id(&quot;google_esf&quot;))); //Not in use but also a frame\r\n                    driver.switchTo().frame(driver.findElement(By.id(&quot;aswift_9&quot;)));\r\n                    driver.switchTo().frame(driver.findElement(By.id(&quot;ad_iframe&quot;)));\r\n                    driver.findElement(By.id(&quot;dismiss-button&quot;)).click();\r\n    \r\n                    driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));\r\n                    driver.manage().timeouts().pageLoadTimeout(Duration.ofSeconds(10));\r\n                    driver.switchTo().defaultContent();\r\n                } else {\r\n                    System.out.println(&quot;Ad not displayed&quot;);\r\n                }\r\n        }\r\n\r\n\r\nThanks all!","title":"How can I click a floating advertisement?","body":"<p>Found the issue:</p>\n<ol>\n<li>My 'wait' not always working, so the driver tries to close the ad when not displayed - still searching for a way to correct this</li>\n<li>It's working without frame1: &quot;google_esf&quot;, only frame2 and frame3 needed</li>\n</ol>\n<p>Updated code:</p>\n<pre><code>        public void clickMyAccount() {\n        System.out.println(&quot;Click My Account&quot;);\n\n        if(driver.findElement(myAccountBtn).isDisplayed()){\n            driver.findElement(myAccountBtn).click();\n            driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));\n            driver.manage().timeouts().pageLoadTimeout(Duration.ofSeconds(10));\n        } else {\n            System.out.println(&quot;My account button not displayed&quot;);\n        }\n\n    }\n\n    public void clickCloseAd(){\n        System.out.println(&quot;Click Close Ad&quot;);\n\n\n            if(driver.findElement(By.id(&quot;aswift_9&quot;)).isDisplayed()){\n//                driver.switchTo().frame(driver.findElement(By.id(&quot;google_esf&quot;))); //Not in use but also a frame\n                driver.switchTo().frame(driver.findElement(By.id(&quot;aswift_9&quot;)));\n                driver.switchTo().frame(driver.findElement(By.id(&quot;ad_iframe&quot;)));\n                driver.findElement(By.id(&quot;dismiss-button&quot;)).click();\n\n                driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));\n                driver.manage().timeouts().pageLoadTimeout(Duration.ofSeconds(10));\n                driver.switchTo().defaultContent();\n            } else {\n                System.out.println(&quot;Ad not displayed&quot;);\n            }\n    }\n</code></pre>\n<p>Thanks all!</p>\n"}],"owner":{"account_id":19497668,"reputation":11,"user_id":14264467,"display_name":"Guy"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":70,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75015475,"answer_count":2,"score":0,"last_activity_date":1672906951,"creation_date":1672605236,"question_id":74977239,"body_markdown":"I&#39;m trying to move to a different page (click &#39;my account&#39;), and a floating advertisement appears:\r\n[advertisement](https://i.stack.imgur.com/jYbk3.png)\r\n\r\nI tried to click on it, and can&#39;t find the &quot;Close&quot; element.\r\nFound that it might related to frames, but still not works.\r\n\r\nMy Code:\r\n\r\n\r\n```\r\npublic void clickMyAccount() {\r\n    driver.findElement(myAccountBtn).click();\r\n    driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));\r\n    driver.manage().timeouts().pageLoadTimeout(Duration.ofSeconds(10));\r\n\r\n    try {\r\n        Thread.sleep(5);\r\n    } catch (InterruptedException e) {\r\n        e.printStackTrace();\r\n    }\r\n}\r\n\r\npublic void clickCloseAd(){\r\n    driver.switchTo().frame(driver.findElement(By.id(&quot;google_esf&quot;)));\r\n    driver.switchTo().frame(driver.findElement(By.id(&quot;aswift_9&quot;)));\r\n    driver.switchTo().frame(driver.findElement(By.id(&quot;ad_iframe&quot;)));\r\n    driver.findElement(By.id(&quot;dismiss-button&quot;)).click();\r\n    driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));\r\n    driver.manage().timeouts().pageLoadTimeout(Duration.ofSeconds(10));\r\n    driver.switchTo().defaultContent();\r\n}\r\n```\r\n\r\n\r\nSite:\r\nhttps://practice.automationtesting.in/\r\n\r\n\r\n\r\nAny idea how can I click the floating advertisement?\r\n\r\n\r\nTried: move between frames until able to find the Close element\r\nActual: still can&#39;t find this element","title":"How can I click a floating advertisement?","body":"<p>I'm trying to move to a different page (click 'my account'), and a floating advertisement appears:\n<a href=\"https://i.stack.imgur.com/jYbk3.png\" rel=\"nofollow noreferrer\">advertisement</a></p>\n<p>I tried to click on it, and can't find the &quot;Close&quot; element.\nFound that it might related to frames, but still not works.</p>\n<p>My Code:</p>\n<pre><code>public void clickMyAccount() {\n    driver.findElement(myAccountBtn).click();\n    driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));\n    driver.manage().timeouts().pageLoadTimeout(Duration.ofSeconds(10));\n\n    try {\n        Thread.sleep(5);\n    } catch (InterruptedException e) {\n        e.printStackTrace();\n    }\n}\n\npublic void clickCloseAd(){\n    driver.switchTo().frame(driver.findElement(By.id(&quot;google_esf&quot;)));\n    driver.switchTo().frame(driver.findElement(By.id(&quot;aswift_9&quot;)));\n    driver.switchTo().frame(driver.findElement(By.id(&quot;ad_iframe&quot;)));\n    driver.findElement(By.id(&quot;dismiss-button&quot;)).click();\n    driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));\n    driver.manage().timeouts().pageLoadTimeout(Duration.ofSeconds(10));\n    driver.switchTo().defaultContent();\n}\n</code></pre>\n<p>Site:\n<a href=\"https://practice.automationtesting.in/\" rel=\"nofollow noreferrer\">https://practice.automationtesting.in/</a></p>\n<p>Any idea how can I click the floating advertisement?</p>\n<p>Tried: move between frames until able to find the Close element\nActual: still can't find this element</p>\n"},{"tags":["java","spring-boot","security","keycloak","keycloak-rest-api"],"answers":[{"tags":[],"owner":{"account_id":1449510,"reputation":48192,"user_id":1366871,"accept_rate":100,"display_name":"dreamcrash"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1672906926,"creation_date":1607531969,"answer_id":65221023,"question_id":65215817,"body_markdown":"**Update:** The `/auth` path was removed starting with [Keycloak 17 Quarkus distribution][1]. So you might need to remove the `/auth` from the endpoint calls presented on this answer.\r\n\r\n----\r\n\r\nYou can import/export realms using the [Keycloak Admin REST API][1]. To import use the endpoint:\r\n\r\n    POST &lt;KEYCLOAK_HOST&gt;/auth/admin/realms/&lt;REALM_NAME&gt;/partialImport\r\n\r\nand provide the `JSON` representation of the realm. That representation you can get via Admin Console API by click on `Realm` &gt; `Export` &gt; `Export`. Or using the endpoint:\r\n\r\n    POST &lt;KEYCLOAK_HOST&gt;/auth/admin/realms/&lt;REALM_NAME&gt;/partial-export?exportClients=true&amp;exportGroupsAndRoles=true\r\n\r\n\r\nAlternatively, for the export/import you can use:\r\n\r\n    POST &lt;KEYCLOAK_HOST&gt;/auth/admin/realms\r\n\r\nand \r\n\r\n    GET &lt;KEYCLOAK_HOST&gt;/auth/admin/realms/&lt;REALM_NAME&gt;\r\n\r\nrespectively.\r\n\r\nBut then you will need to export/import the clients separately:\r\n\r\n    GET &lt;KEYCLOAK_HOST&gt;/auth/admin/realms/&lt;REALM_NAME&gt;/clients\r\n\r\nand \r\n\r\n    POST &lt;KEYCLOAK_HOST&gt;/auth/admin/realms/&lt;REALM_NAME&gt;/clients\r\n\r\nand provide the `JSON` representation of the clients.\r\n\r\n\r\nFor a practical example on how to use the Rest API have a look at [this answer][2]. That answer is about using the API to create protocols mappers but you can easily adapt it to your use-case.\r\n\r\n\r\n  [1]: https://www.keycloak.org/docs-api/19.0.3/rest-api/index.html\r\n  [2]: https://stackoverflow.com/a/66915727/1366871","title":"default configuration with embedded keycloak and spring boot app","body":"<p><strong>Update:</strong> The <code>/auth</code> path was removed starting with <a href=\"https://www.keycloak.org/docs-api/19.0.3/rest-api/index.html\" rel=\"nofollow noreferrer\">Keycloak 17 Quarkus distribution</a>. So you might need to remove the <code>/auth</code> from the endpoint calls presented on this answer.</p>\n<hr />\n<p>You can import/export realms using the <a href=\"https://www.keycloak.org/docs-api/19.0.3/rest-api/index.html\" rel=\"nofollow noreferrer\">Keycloak Admin REST API</a>. To import use the endpoint:</p>\n<pre><code>POST &lt;KEYCLOAK_HOST&gt;/auth/admin/realms/&lt;REALM_NAME&gt;/partialImport\n</code></pre>\n<p>and provide the <code>JSON</code> representation of the realm. That representation you can get via Admin Console API by click on <code>Realm</code> &gt; <code>Export</code> &gt; <code>Export</code>. Or using the endpoint:</p>\n<pre><code>POST &lt;KEYCLOAK_HOST&gt;/auth/admin/realms/&lt;REALM_NAME&gt;/partial-export?exportClients=true&amp;exportGroupsAndRoles=true\n</code></pre>\n<p>Alternatively, for the export/import you can use:</p>\n<pre><code>POST &lt;KEYCLOAK_HOST&gt;/auth/admin/realms\n</code></pre>\n<p>and</p>\n<pre><code>GET &lt;KEYCLOAK_HOST&gt;/auth/admin/realms/&lt;REALM_NAME&gt;\n</code></pre>\n<p>respectively.</p>\n<p>But then you will need to export/import the clients separately:</p>\n<pre><code>GET &lt;KEYCLOAK_HOST&gt;/auth/admin/realms/&lt;REALM_NAME&gt;/clients\n</code></pre>\n<p>and</p>\n<pre><code>POST &lt;KEYCLOAK_HOST&gt;/auth/admin/realms/&lt;REALM_NAME&gt;/clients\n</code></pre>\n<p>and provide the <code>JSON</code> representation of the clients.</p>\n<p>For a practical example on how to use the Rest API have a look at <a href=\"https://stackoverflow.com/a/66915727/1366871\">this answer</a>. That answer is about using the API to create protocols mappers but you can easily adapt it to your use-case.</p>\n"}],"owner":{"account_id":12538952,"reputation":199,"user_id":9124641,"display_name":"c&#39;est moi"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":906,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":65221023,"answer_count":1,"score":1,"last_activity_date":1672906926,"creation_date":1607512959,"question_id":65215817,"body_markdown":"I&#39;m working with embedded  keycloak and spring boot app &lt;br&gt;\r\nI created a realm then I created a client with: &lt;br&gt;\r\n`Access Type`: `confidential`&lt;br&gt;\r\n`Authorization Enabled`: `enabled` &lt;br&gt;\r\nthen I created resources with permission and policy&lt;br&gt;\r\nMy problem is :&lt;br&gt;\r\nI want to export this configuration in a config file (java config or json config)  so that not every time I have to configure keycloak at the beginning when I restart my keycloak server&lt;br&gt;\r\n\r\nHow can I do this? ","title":"default configuration with embedded keycloak and spring boot app","body":"<p>I'm working with embedded  keycloak and spring boot app <br>\nI created a realm then I created a client with: <br>\n<code>Access Type</code>: <code>confidential</code><br>\n<code>Authorization Enabled</code>: <code>enabled</code> <br>\nthen I created resources with permission and policy<br>\nMy problem is :<br>\nI want to export this configuration in a config file (java config or json config)  so that not every time I have to configure keycloak at the beginning when I restart my keycloak server<br></p>\n<p>How can I do this?</p>\n"},{"tags":["java","json","jackson"],"comments":[{"owner":{"account_id":138148,"reputation":5659,"user_id":342882,"accept_rate":34,"display_name":"Daniil Iaitskov"},"score":0,"creation_date":1571355034,"post_id":18805455,"comment_id":103223328,"body_markdown":"I am looking similar question but for final field.","body":"I am looking similar question but for final field."},{"owner":{"account_id":4693037,"reputation":492,"user_id":3798662,"display_name":"Sunil Garg"},"score":0,"creation_date":1649767704,"post_id":18805455,"comment_id":126955237,"body_markdown":"https://stackoverflow.com/a/68910849/3798662 check this and then mark it as your answer if it solves the purpose","body":"<a href=\"https://stackoverflow.com/a/68910849/3798662\">stackoverflow.com/a/68910849/3798662</a> check this and then mark it as your answer if it solves the purpose"}],"answers":[{"comments":[{"owner":{"account_id":2183673,"reputation":12897,"user_id":1932588,"display_name":"Lee Meador"},"score":7,"creation_date":1461600090,"post_id":18806461,"comment_id":61260532,"body_markdown":"But if the JSON has value null, the optionalMember will end up as null. That may be what is wanted or not.","body":"But if the JSON has value null, the optionalMember will end up as null. That may be what is wanted or not."},{"owner":{"account_id":1425986,"reputation":3033,"user_id":2306595,"display_name":"Innokenty"},"score":2,"creation_date":1537950411,"post_id":18806461,"comment_id":91966142,"body_markdown":"This is the same as just setting the default value on a field. Doesn&#39;t solve the problem.","body":"This is the same as just setting the default value on a field. Doesn&#39;t solve the problem."}],"tags":[],"owner":{"account_id":2652951,"reputation":2597,"user_id":2294202,"accept_rate":80,"display_name":"gookman"},"comment_count":2,"down_vote_count":1,"up_vote_count":5,"is_accepted":false,"score":4,"last_activity_date":1379193333,"creation_date":1379193333,"answer_id":18806461,"question_id":18805455,"body_markdown":"Looks like the solution is to set the value of the properties inside the default constructor. So in this case the java class is:\r\n\r\n    class JavaObject {\r\n\r\n        public JavaObject() {\r\n \r\n            optionalMember = &quot;Value&quot;;\r\n        }\r\n\r\n        @NotNull\r\n        public String notNullMember;\r\n\r\n        public String optionalMember;\r\n    }\r\n\r\nAfter the mapping with Jackson, if the `optionalMember` is missing from the JSON its value in the Java class is `&quot;Value&quot;`.\r\n\r\nHowever, I am still interested to know if there is a solution with annotations and without the default constructor.","title":"Setting default values to null fields when mapping with Jackson","body":"<p>Looks like the solution is to set the value of the properties inside the default constructor. So in this case the java class is:</p>\n\n<pre><code>class JavaObject {\n\n    public JavaObject() {\n\n        optionalMember = \"Value\";\n    }\n\n    @NotNull\n    public String notNullMember;\n\n    public String optionalMember;\n}\n</code></pre>\n\n<p>After the mapping with Jackson, if the <code>optionalMember</code> is missing from the JSON its value in the Java class is <code>\"Value\"</code>.</p>\n\n<p>However, I am still interested to know if there is a solution with annotations and without the default constructor.</p>\n"},{"comments":[{"owner":{"account_id":2183673,"reputation":12897,"user_id":1932588,"display_name":"Lee Meador"},"score":86,"creation_date":1461600028,"post_id":18806773,"comment_id":61260497,"body_markdown":"This gives a default value if there is no json for the optionalMember. If there is json setting it to &quot;null&quot;, it will be null, not &quot;Value&quot;","body":"This gives a default value if there is no json for the optionalMember. If there is json setting it to &quot;null&quot;, it will be null, not &quot;Value&quot;"},{"owner":{"account_id":5345891,"reputation":2894,"user_id":4261472,"accept_rate":88,"display_name":"Sergei Voitovich"},"score":1,"creation_date":1489766261,"post_id":18806773,"comment_id":72830132,"body_markdown":"Added an answer showing how to save `Value` in case of `null`","body":"Added an answer showing how to save <code>Value</code> in case of <code>null</code>"},{"owner":{"account_id":13357055,"reputation":702,"user_id":9640261,"display_name":"NayoR"},"score":10,"creation_date":1542884716,"post_id":18806773,"comment_id":93733113,"body_markdown":"Also, if the class have an AllArgsConstructor, the default value will be erased to null\nSee https://stackoverflow.com/q/48725922/9640261","body":"Also, if the class have an AllArgsConstructor, the default value will be erased to null See <a href=\"https://stackoverflow.com/q/48725922/9640261\">stackoverflow.com/q/48725922/9640261</a>"},{"owner":{"account_id":2939325,"reputation":991,"user_id":2517585,"accept_rate":18,"display_name":"pellyadolfo"},"score":0,"creation_date":1561467105,"post_id":18806773,"comment_id":100066539,"body_markdown":"@LeeMeador, maybe because the value, in that case, is &quot;null&quot;?","body":"@LeeMeador, maybe because the value, in that case, is &quot;null&quot;?"},{"owner":{"account_id":18936940,"reputation":95,"user_id":13817797,"display_name":"Pradip Sodha"},"score":0,"creation_date":1616063472,"post_id":18806773,"comment_id":117888105,"body_markdown":"@llya not working in jackson 2.10, any suggestion ???","body":"@llya not working in jackson 2.10, any suggestion ???"},{"owner":{"account_id":4693037,"reputation":492,"user_id":3798662,"display_name":"Sunil Garg"},"score":0,"creation_date":1653673875,"post_id":18806773,"comment_id":127916440,"body_markdown":"try this ; more simpler &amp; cleaner way - https://stackoverflow.com/a/68910849/3798662","body":"try this ; more simpler &amp; cleaner way - <a href=\"https://stackoverflow.com/a/68910849/3798662\">stackoverflow.com/a/68910849/3798662</a>"}],"tags":[],"owner":{"account_id":1165262,"reputation":29315,"user_id":1143825,"accept_rate":94,"display_name":"Ilya"},"comment_count":6,"down_vote_count":5,"up_vote_count":116,"is_accepted":true,"score":111,"last_activity_date":1379195669,"creation_date":1379195669,"answer_id":18806773,"question_id":18805455,"body_markdown":"There is no annotation to set default value.  \r\nYou can set default value only on java class level: \r\n\r\n    public class JavaObject \r\n    {\r\n        public String notNullMember;\r\n    \r\n        public String optionalMember = &quot;Value&quot;;\r\n    }","title":"Setting default values to null fields when mapping with Jackson","body":"<p>There is no annotation to set default value.<br>\nYou can set default value only on java class level: </p>\n\n<pre><code>public class JavaObject \n{\n    public String notNullMember;\n\n    public String optionalMember = \"Value\";\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":13357055,"reputation":702,"user_id":9640261,"display_name":"NayoR"},"score":1,"creation_date":1542882217,"post_id":38620412,"comment_id":93731566,"body_markdown":"Setter set non-null value, so getter value will go in if statement each time it is called if and only if notNullMember is never set","body":"Setter set non-null value, so getter value will go in if statement each time it is called if and only if notNullMember is never set"}],"tags":[],"owner":{"account_id":1416081,"reputation":101,"user_id":1341731,"display_name":"Michael Conrad"},"comment_count":1,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1469643454,"creation_date":1469643454,"answer_id":38620412,"question_id":18805455,"body_markdown":"Make the member private and add a setter/getter pair.\r\nIn your setter, if null, then set default value instead.\r\nAdditionally, I have shown the snippet with the getter also returning a default when internal value is null.\r\n\r\n    class JavaObject {\r\n        private static final String DEFAULT=&quot;Default Value&quot;;\r\n    \r\n        public JavaObject() {\r\n        }\r\n    \r\n        @NotNull\r\n        private String notNullMember;\r\n        public void setNotNullMember(String value){\r\n                if (value==null) { notNullMember=DEFAULT; return; }\r\n                notNullMember=value;\r\n                return;\r\n        }\r\n\r\n        public String getNotNullMember(){\r\n                if (notNullMember==null) { return DEFAULT;}\r\n                return notNullMember;\r\n        }\r\n    \r\n        public String optionalMember;\r\n    }","title":"Setting default values to null fields when mapping with Jackson","body":"<p>Make the member private and add a setter/getter pair.\nIn your setter, if null, then set default value instead.\nAdditionally, I have shown the snippet with the getter also returning a default when internal value is null.</p>\n\n<pre><code>class JavaObject {\n    private static final String DEFAULT=\"Default Value\";\n\n    public JavaObject() {\n    }\n\n    @NotNull\n    private String notNullMember;\n    public void setNotNullMember(String value){\n            if (value==null) { notNullMember=DEFAULT; return; }\n            notNullMember=value;\n            return;\n    }\n\n    public String getNotNullMember(){\n            if (notNullMember==null) { return DEFAULT;}\n            return notNullMember;\n    }\n\n    public String optionalMember;\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":5524210,"reputation":633,"user_id":4386227,"accept_rate":67,"display_name":"Woland"},"score":4,"creation_date":1562076181,"post_id":41965174,"comment_id":100258510,"body_markdown":"Maybe there is a way to do it for all fields of class?","body":"Maybe there is a way to do it for all fields of class?"},{"owner":{"account_id":446117,"reputation":593,"user_id":838961,"display_name":"Marat Asadurian"},"score":0,"creation_date":1637952382,"post_id":41965174,"comment_id":123967918,"body_markdown":"This should be the accepted solution","body":"This should be the accepted solution"},{"owner":{"account_id":1325682,"reputation":982,"user_id":1270533,"accept_rate":0,"display_name":"Zhuo YING"},"score":0,"creation_date":1643270468,"post_id":41965174,"comment_id":125296139,"body_markdown":"No. Sir! This code make you POJO NOT be pure. Please don&#39;t do that.","body":"No. Sir! This code make you POJO NOT be pure. Please don&#39;t do that."},{"owner":{"account_id":4693037,"reputation":492,"user_id":3798662,"display_name":"Sunil Garg"},"score":0,"creation_date":1653673900,"post_id":41965174,"comment_id":127916446,"body_markdown":"try much cleaner way - https://stackoverflow.com/a/68910849/3798662","body":"try much cleaner way - <a href=\"https://stackoverflow.com/a/68910849/3798662\">stackoverflow.com/a/68910849/3798662</a>"}],"tags":[],"owner":{"account_id":5345891,"reputation":2894,"user_id":4261472,"accept_rate":88,"display_name":"Sergei Voitovich"},"comment_count":4,"down_vote_count":1,"up_vote_count":55,"is_accepted":false,"score":54,"last_activity_date":1521978388,"creation_date":1485888233,"answer_id":41965174,"question_id":18805455,"body_markdown":"Only one proposed solution keeps the `default-value` when `some-value:null` was set explicitly (POJO readability is lost there and it&#39;s clumsy)\r\n\r\nHere&#39;s how one can keep the `default-value` and never set it to `null`\r\n\r\n    @JsonProperty(&quot;some-value&quot;)\r\n    public String someValue = &quot;default-value&quot;;\r\n\r\n    @JsonSetter(&quot;some-value&quot;)\r\n    public void setSomeValue(String s) {\r\n        if (s != null) { \r\n            someValue = s; \r\n        }\r\n    }","title":"Setting default values to null fields when mapping with Jackson","body":"<p>Only one proposed solution keeps the <code>default-value</code> when <code>some-value:null</code> was set explicitly (POJO readability is lost there and it's clumsy)</p>\n\n<p>Here's how one can keep the <code>default-value</code> and never set it to <code>null</code></p>\n\n<pre><code>@JsonProperty(\"some-value\")\npublic String someValue = \"default-value\";\n\n@JsonSetter(\"some-value\")\npublic void setSomeValue(String s) {\n    if (s != null) { \n        someValue = s; \n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11171121,"reputation":2994,"user_id":8198056,"display_name":"Adrian"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1514301168,"creation_date":1514301168,"answer_id":47980441,"question_id":18805455,"body_markdown":"I had a similar problem, but in my case the default value was in database. Below is the solution for that:\r\n     \r\n     @Configuration\r\n     public class AppConfiguration {\r\n     @Autowired\r\n     private AppConfigDao appConfigDao;\r\n \r\n     @Bean\r\n     public Jackson2ObjectMapperBuilder builder() {\r\n       Jackson2ObjectMapperBuilder builder = new Jackson2ObjectMapperBuilder()\r\n           .deserializerByType(SomeDto.class, \r\n     new SomeDtoJsonDeserializer(appConfigDao.findDefaultValue()));\r\n       return builder;\r\n     }\r\n     \r\n\r\nThen in `SomeDtoJsonDeserializer` use `ObjectMapper` to deserialize the json and set default value if your field/object is null.","title":"Setting default values to null fields when mapping with Jackson","body":"<p>I had a similar problem, but in my case the default value was in database. Below is the solution for that:</p>\n\n<pre><code> @Configuration\n public class AppConfiguration {\n @Autowired\n private AppConfigDao appConfigDao;\n\n @Bean\n public Jackson2ObjectMapperBuilder builder() {\n   Jackson2ObjectMapperBuilder builder = new Jackson2ObjectMapperBuilder()\n       .deserializerByType(SomeDto.class, \n new SomeDtoJsonDeserializer(appConfigDao.findDefaultValue()));\n   return builder;\n }\n</code></pre>\n\n<p>Then in <code>SomeDtoJsonDeserializer</code> use <code>ObjectMapper</code> to deserialize the json and set default value if your field/object is null.</p>\n"},{"comments":[{"owner":{"account_id":4693037,"reputation":492,"user_id":3798662,"display_name":"Sunil Garg"},"score":1,"creation_date":1653673916,"post_id":56562890,"comment_id":127916449,"body_markdown":"https://stackoverflow.com/a/68910849/3798662","body":"<a href=\"https://stackoverflow.com/a/68910849/3798662\">stackoverflow.com/a/68910849/3798662</a>"}],"tags":[],"owner":{"account_id":6087813,"reputation":15135,"user_id":4751165,"accept_rate":96,"display_name":"Pau"},"comment_count":1,"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1672418158,"creation_date":1560344494,"answer_id":56562890,"question_id":18805455,"body_markdown":"You can create your own JsonDeserializer and annotate that property with `@JsonDeserialize(using = DefaultZero.class)`\r\n\r\nFor example: To configure BigDecimal to default to ZERO:\r\n\r\n    public static class DefaultZero extends JsonDeserializer&lt;BigDecimal&gt; {\r\n        private final JsonDeserializer&lt;BigDecimal&gt; delegate;\r\n\r\n        public DefaultZero(JsonDeserializer&lt;BigDecimal&gt; delegate) {\r\n            this.delegate = delegate;\r\n        }\r\n\r\n        @Override\r\n        public BigDecimal deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException, JsonProcessingException {\r\n            return jsonParser.getDecimalValue();\r\n        }\r\n\r\n        @Override\r\n        public BigDecimal getNullValue(DeserializationContext ctxt) throws JsonMappingException {\r\n            return BigDecimal.ZERO;\r\n        }\r\n    }\r\n\r\nAnd usage:\r\n\r\n    class Sth {\r\n \r\n       @JsonDeserialize(using = DefaultZero.class)\r\n       BigDecimal property;\r\n     }","title":"Setting default values to null fields when mapping with Jackson","body":"<p>You can create your own JsonDeserializer and annotate that property with <code>@JsonDeserialize(using = DefaultZero.class)</code></p>\n<p>For example: To configure BigDecimal to default to ZERO:</p>\n<pre><code>public static class DefaultZero extends JsonDeserializer&lt;BigDecimal&gt; {\n    private final JsonDeserializer&lt;BigDecimal&gt; delegate;\n\n    public DefaultZero(JsonDeserializer&lt;BigDecimal&gt; delegate) {\n        this.delegate = delegate;\n    }\n\n    @Override\n    public BigDecimal deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException, JsonProcessingException {\n        return jsonParser.getDecimalValue();\n    }\n\n    @Override\n    public BigDecimal getNullValue(DeserializationContext ctxt) throws JsonMappingException {\n        return BigDecimal.ZERO;\n    }\n}\n</code></pre>\n<p>And usage:</p>\n<pre><code>class Sth {\n\n   @JsonDeserialize(using = DefaultZero.class)\n   BigDecimal property;\n }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1448228,"reputation":3218,"user_id":1366016,"accept_rate":60,"display_name":"Wheezil"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1580936701,"creation_date":1580936701,"answer_id":60084100,"question_id":18805455,"body_markdown":"There are already a lot of good suggestions, but here&#39;s one more. You can use @JsonDeserialize to perform an arbitrary &quot;sanitizer&quot; which Jackson will invoke post-deserialization:\r\n\r\n    @JsonDeserialize(converter=Message1._Sanitizer.class)  \r\n    public class Message1 extends MessageBase\r\n    {\r\n    \tpublic String string1 = &quot;&quot;;\r\n    \tpublic int integer1;\r\n    \r\n    \tpublic static class _Sanitizer extends StdConverter&lt;Message1,Message1&gt; {\r\n    \t\t@Override\r\n    \t\tpublic Message1 convert(Message1 message) {\r\n    \t\t\tif (message.string1 == null) message.string1 = &quot;&quot;;\r\n    \t\t\treturn message;\r\n    \t\t}\r\n    \t}\r\n    }","title":"Setting default values to null fields when mapping with Jackson","body":"<p>There are already a lot of good suggestions, but here's one more. You can use @JsonDeserialize to perform an arbitrary \"sanitizer\" which Jackson will invoke post-deserialization:</p>\n\n<pre><code>@JsonDeserialize(converter=Message1._Sanitizer.class)  \npublic class Message1 extends MessageBase\n{\n    public String string1 = \"\";\n    public int integer1;\n\n    public static class _Sanitizer extends StdConverter&lt;Message1,Message1&gt; {\n        @Override\n        public Message1 convert(Message1 message) {\n            if (message.string1 == null) message.string1 = \"\";\n            return message;\n        }\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2343888,"reputation":56,"user_id":2054634,"display_name":"ptanov"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1629449626,"creation_date":1585818057,"answer_id":60987798,"question_id":18805455,"body_markdown":"Another option is to use [InjectableValues](https://fasterxml.github.io/jackson-databind/javadoc/2.7/com/fasterxml/jackson/databind/InjectableValues.html) and [@JacksonInject](https://fasterxml.github.io/jackson-annotations/javadoc/2.9/com/fasterxml/jackson/annotation/JacksonInject.html). It is very useful if you need to use not always the same value but one get from DB or somewhere else for the specific case. Here is an example of using `JacksonInject`:\r\n\r\n```java\r\nprotected static class Some {\r\n\tprivate final String field1;\r\n\tprivate final String field2;\r\n\r\n\tpublic Some(@JsonProperty(&quot;field1&quot;) final String field1,\r\n\t\t\t@JsonProperty(&quot;field2&quot;) @JacksonInject(value = &quot;defaultValueForField2&quot;,\r\n\t\t\t\t\tuseInput = OptBoolean.TRUE) final String field2) {\r\n\t\tthis.field1 = requireNonNull(field1);\r\n\t\tthis.field2 = requireNonNull(field2);\r\n\t}\r\n\r\n\tpublic String getField1() {\r\n\t\treturn field1;\r\n\t}\r\n\r\n\tpublic String getField2() {\r\n\t\treturn field2;\r\n\t}\r\n}\r\n\r\n@Test\r\npublic void testReadValueInjectables() throws JsonParseException, JsonMappingException, IOException {\r\n\tfinal ObjectMapper mapper = new ObjectMapper();\r\n\tfinal InjectableValues injectableValues =\r\n\t\t\tnew InjectableValues.Std().addValue(&quot;defaultValueForField2&quot;, &quot;somedefaultValue&quot;);\r\n\tmapper.setInjectableValues(injectableValues);\r\n\r\n\tfinal Some actualValueMissing = mapper.readValue(&quot;{\\&quot;field1\\&quot;: \\&quot;field1value\\&quot;}&quot;, Some.class);\r\n\tassertEquals(actualValueMissing.getField1(), &quot;field1value&quot;);\r\n\tassertEquals(actualValueMissing.getField2(), &quot;somedefaultValue&quot;);\r\n\r\n\tfinal Some actualValuePresent =\r\n\t\t\tmapper.readValue(&quot;{\\&quot;field1\\&quot;: \\&quot;field1value\\&quot;, \\&quot;field2\\&quot;: \\&quot;field2value\\&quot;}&quot;, Some.class);\r\n\tassertEquals(actualValuePresent.getField1(), &quot;field1value&quot;);\r\n\tassertEquals(actualValuePresent.getField2(), &quot;field2value&quot;);\r\n}\r\n```\r\n\r\nKeep in mind that if you are using constructor to create the entity (this usually happens when you use [@Value](https://projectlombok.org/features/Value) or [@AllArgsConstructor](https://projectlombok.org/features/constructor) in [lombok](https://projectlombok.org/) ) and you put `@JacksonInject` not to the constructor but to the property it will not work as expected - value of the injected field will always override value in json, no matter whether you put `useInput = OptBoolean.TRUE` in `@JacksonInject`. This is because jackson injects those properties after constructor is called (even if the property is `final`) - field is set to the correct value in constructor but then it is overrided (check: https://github.com/FasterXML/jackson-databind/issues/2678 and https://github.com/rzwitserloot/lombok/issues/1528#issuecomment-607725333 for more information), this test is unfortunately *passing*:\r\n\r\n```java\r\nprotected static class Some {\r\n\tprivate final String field1;\r\n\r\n\t@JacksonInject(value = &quot;defaultValueForField2&quot;, useInput = OptBoolean.TRUE)\r\n\tprivate final String field2;\r\n\r\n\tpublic Some(@JsonProperty(&quot;field1&quot;) final String field1,\r\n\t\t\t@JsonProperty(&quot;field2&quot;) @JacksonInject(value = &quot;defaultValueForField2&quot;,\r\n\t\t\t\t\tuseInput = OptBoolean.TRUE) final String field2) {\r\n\t\tthis.field1 = requireNonNull(field1);\r\n\t\tthis.field2 = requireNonNull(field2);\r\n\t}\r\n\r\n\tpublic String getField1() {\r\n\t\treturn field1;\r\n\t}\r\n\r\n\tpublic String getField2() {\r\n\t\treturn field2;\r\n\t}\r\n}\r\n\r\n@Test\r\npublic void testReadValueInjectablesIncorrectBehavior() throws JsonParseException, JsonMappingException, IOException {\r\n\tfinal ObjectMapper mapper = new ObjectMapper();\r\n\tfinal InjectableValues injectableValues =\r\n\t\t\tnew InjectableValues.Std().addValue(&quot;defaultValueForField2&quot;, &quot;somedefaultValue&quot;);\r\n\tmapper.setInjectableValues(injectableValues);\r\n\r\n\tfinal Some actualValueMissing = mapper.readValue(&quot;{\\&quot;field1\\&quot;: \\&quot;field1value\\&quot;}&quot;, Some.class);\r\n\tassertEquals(actualValueMissing.getField1(), &quot;field1value&quot;);\r\n\tassertEquals(actualValueMissing.getField2(), &quot;somedefaultValue&quot;);\r\n\r\n\tfinal Some actualValuePresent =\r\n\t\t\tmapper.readValue(&quot;{\\&quot;field1\\&quot;: \\&quot;field1value\\&quot;, \\&quot;field2\\&quot;: \\&quot;field2value\\&quot;}&quot;, Some.class);\r\n\tassertEquals(actualValuePresent.getField1(), &quot;field1value&quot;);\r\n\t// unfortunately &quot;field2value&quot; is overrided because of putting &quot;@JacksonInject&quot; to the field\r\n\tassertEquals(actualValuePresent.getField2(), &quot;somedefaultValue&quot;);\r\n}\r\n\r\n``` \r\n\r\nAnother approach is to use `JsonDeserializer`, e.g.:\r\n```java\r\n\tpublic class DefaultValueDeserializer extends JsonDeserializer&lt;String&gt; {\r\n\r\n\t\t@Override\r\n\t\tpublic String deserialize(JsonParser jsonParser, DeserializationContext deserializationContext)\r\n\t\t\t\tthrows IOException {\r\n\t\t\treturn jsonParser.getText();\r\n\t\t}\r\n\r\n\t\t@Override\r\n\t\tpublic String getNullValue(DeserializationContext ctxt) {\r\n\t\t\treturn &quot;some random value that can be different each time: &quot; + UUID.randomUUID().toString();\r\n\t\t}\r\n\t}\r\n\r\n```\r\nand then annotate a field like that:\r\n```java\r\n\tpublic class Content {\r\n\t\t@JsonDeserialize(using = DefaultValueDeserializer.class)\r\n\t\tprivate String someField;\r\n...\r\n\t}\r\n```\r\n\r\nkeep in mind that you can use attributes in `getNullValue(DeserializationContext ctxt)` passed using\r\n\r\n```java\r\nmapper.reader().forType(SomeType.class).withAttributes(singletonMap(&quot;dbConnection&quot;, dbConnection)).readValue(jsonString);\r\n```\r\n\r\nlike that:\r\n\r\n```java\r\n\t\t@Override\r\n\t\tpublic String getNullValue(DeserializationContext ctxt) {\r\n\t\t\treturn ((DbConnection)ctxt.getAttribute(&quot;dbConnection&quot;)).getDefaultValue(...);\r\n\t\t}\r\n```\r\n\r\nHope this helps to someone with a similar problem.\r\n\r\nP.S. I&#39;m using jackson v. 2.9.6","title":"Setting default values to null fields when mapping with Jackson","body":"<p>Another option is to use <a href=\"https://fasterxml.github.io/jackson-databind/javadoc/2.7/com/fasterxml/jackson/databind/InjectableValues.html\" rel=\"nofollow noreferrer\">InjectableValues</a> and <a href=\"https://fasterxml.github.io/jackson-annotations/javadoc/2.9/com/fasterxml/jackson/annotation/JacksonInject.html\" rel=\"nofollow noreferrer\">@JacksonInject</a>. It is very useful if you need to use not always the same value but one get from DB or somewhere else for the specific case. Here is an example of using <code>JacksonInject</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>protected static class Some {\n    private final String field1;\n    private final String field2;\n\n    public Some(@JsonProperty(&quot;field1&quot;) final String field1,\n            @JsonProperty(&quot;field2&quot;) @JacksonInject(value = &quot;defaultValueForField2&quot;,\n                    useInput = OptBoolean.TRUE) final String field2) {\n        this.field1 = requireNonNull(field1);\n        this.field2 = requireNonNull(field2);\n    }\n\n    public String getField1() {\n        return field1;\n    }\n\n    public String getField2() {\n        return field2;\n    }\n}\n\n@Test\npublic void testReadValueInjectables() throws JsonParseException, JsonMappingException, IOException {\n    final ObjectMapper mapper = new ObjectMapper();\n    final InjectableValues injectableValues =\n            new InjectableValues.Std().addValue(&quot;defaultValueForField2&quot;, &quot;somedefaultValue&quot;);\n    mapper.setInjectableValues(injectableValues);\n\n    final Some actualValueMissing = mapper.readValue(&quot;{\\&quot;field1\\&quot;: \\&quot;field1value\\&quot;}&quot;, Some.class);\n    assertEquals(actualValueMissing.getField1(), &quot;field1value&quot;);\n    assertEquals(actualValueMissing.getField2(), &quot;somedefaultValue&quot;);\n\n    final Some actualValuePresent =\n            mapper.readValue(&quot;{\\&quot;field1\\&quot;: \\&quot;field1value\\&quot;, \\&quot;field2\\&quot;: \\&quot;field2value\\&quot;}&quot;, Some.class);\n    assertEquals(actualValuePresent.getField1(), &quot;field1value&quot;);\n    assertEquals(actualValuePresent.getField2(), &quot;field2value&quot;);\n}\n</code></pre>\n<p>Keep in mind that if you are using constructor to create the entity (this usually happens when you use <a href=\"https://projectlombok.org/features/Value\" rel=\"nofollow noreferrer\">@Value</a> or <a href=\"https://projectlombok.org/features/constructor\" rel=\"nofollow noreferrer\">@AllArgsConstructor</a> in <a href=\"https://projectlombok.org/\" rel=\"nofollow noreferrer\">lombok</a> ) and you put <code>@JacksonInject</code> not to the constructor but to the property it will not work as expected - value of the injected field will always override value in json, no matter whether you put <code>useInput = OptBoolean.TRUE</code> in <code>@JacksonInject</code>. This is because jackson injects those properties after constructor is called (even if the property is <code>final</code>) - field is set to the correct value in constructor but then it is overrided (check: <a href=\"https://github.com/FasterXML/jackson-databind/issues/2678\" rel=\"nofollow noreferrer\">https://github.com/FasterXML/jackson-databind/issues/2678</a> and <a href=\"https://github.com/rzwitserloot/lombok/issues/1528#issuecomment-607725333\" rel=\"nofollow noreferrer\">https://github.com/rzwitserloot/lombok/issues/1528#issuecomment-607725333</a> for more information), this test is unfortunately <em>passing</em>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>protected static class Some {\n    private final String field1;\n\n    @JacksonInject(value = &quot;defaultValueForField2&quot;, useInput = OptBoolean.TRUE)\n    private final String field2;\n\n    public Some(@JsonProperty(&quot;field1&quot;) final String field1,\n            @JsonProperty(&quot;field2&quot;) @JacksonInject(value = &quot;defaultValueForField2&quot;,\n                    useInput = OptBoolean.TRUE) final String field2) {\n        this.field1 = requireNonNull(field1);\n        this.field2 = requireNonNull(field2);\n    }\n\n    public String getField1() {\n        return field1;\n    }\n\n    public String getField2() {\n        return field2;\n    }\n}\n\n@Test\npublic void testReadValueInjectablesIncorrectBehavior() throws JsonParseException, JsonMappingException, IOException {\n    final ObjectMapper mapper = new ObjectMapper();\n    final InjectableValues injectableValues =\n            new InjectableValues.Std().addValue(&quot;defaultValueForField2&quot;, &quot;somedefaultValue&quot;);\n    mapper.setInjectableValues(injectableValues);\n\n    final Some actualValueMissing = mapper.readValue(&quot;{\\&quot;field1\\&quot;: \\&quot;field1value\\&quot;}&quot;, Some.class);\n    assertEquals(actualValueMissing.getField1(), &quot;field1value&quot;);\n    assertEquals(actualValueMissing.getField2(), &quot;somedefaultValue&quot;);\n\n    final Some actualValuePresent =\n            mapper.readValue(&quot;{\\&quot;field1\\&quot;: \\&quot;field1value\\&quot;, \\&quot;field2\\&quot;: \\&quot;field2value\\&quot;}&quot;, Some.class);\n    assertEquals(actualValuePresent.getField1(), &quot;field1value&quot;);\n    // unfortunately &quot;field2value&quot; is overrided because of putting &quot;@JacksonInject&quot; to the field\n    assertEquals(actualValuePresent.getField2(), &quot;somedefaultValue&quot;);\n}\n\n</code></pre>\n<p>Another approach is to use <code>JsonDeserializer</code>, e.g.:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    public class DefaultValueDeserializer extends JsonDeserializer&lt;String&gt; {\n\n        @Override\n        public String deserialize(JsonParser jsonParser, DeserializationContext deserializationContext)\n                throws IOException {\n            return jsonParser.getText();\n        }\n\n        @Override\n        public String getNullValue(DeserializationContext ctxt) {\n            return &quot;some random value that can be different each time: &quot; + UUID.randomUUID().toString();\n        }\n    }\n\n</code></pre>\n<p>and then annotate a field like that:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    public class Content {\n        @JsonDeserialize(using = DefaultValueDeserializer.class)\n        private String someField;\n...\n    }\n</code></pre>\n<p>keep in mind that you can use attributes in <code>getNullValue(DeserializationContext ctxt)</code> passed using</p>\n<pre class=\"lang-java prettyprint-override\"><code>mapper.reader().forType(SomeType.class).withAttributes(singletonMap(&quot;dbConnection&quot;, dbConnection)).readValue(jsonString);\n</code></pre>\n<p>like that:</p>\n<pre class=\"lang-java prettyprint-override\"><code>        @Override\n        public String getNullValue(DeserializationContext ctxt) {\n            return ((DbConnection)ctxt.getAttribute(&quot;dbConnection&quot;)).getDefaultValue(...);\n        }\n</code></pre>\n<p>Hope this helps to someone with a similar problem.</p>\n<p>P.S. I'm using jackson v. 2.9.6</p>\n"},{"comments":[{"owner":{"account_id":5204645,"reputation":917,"user_id":4163002,"accept_rate":90,"display_name":"ZX9"},"score":1,"creation_date":1632170496,"post_id":68910849,"comment_id":122416626,"body_markdown":"This is excellent...if only it worked with lombok.","body":"This is excellent...if only it worked with lombok."},{"owner":{"account_id":4693037,"reputation":492,"user_id":3798662,"display_name":"Sunil Garg"},"score":0,"creation_date":1635230395,"post_id":68910849,"comment_id":123233427,"body_markdown":"It totally works!","body":"It totally works!"},{"owner":{"account_id":6767541,"reputation":3494,"user_id":5212118,"accept_rate":67,"display_name":"cucuru"},"score":1,"creation_date":1641919489,"post_id":68910849,"comment_id":124931433,"body_markdown":"it works perfect if the value is null, but how to manage if the value is empty?","body":"it works perfect if the value is null, but how to manage if the value is empty?"},{"owner":{"account_id":9366757,"reputation":793,"user_id":8031498,"accept_rate":67,"display_name":"Steve Storck"},"score":0,"creation_date":1649764326,"post_id":68910849,"comment_id":126953905,"body_markdown":"I am using this suggestion on a static inner class, and it is compatible with lombok, at least that way.","body":"I am using this suggestion on a static inner class, and it is compatible with lombok, at least that way."}],"tags":[],"owner":{"account_id":4693037,"reputation":492,"user_id":3798662,"display_name":"Sunil Garg"},"comment_count":4,"down_vote_count":0,"up_vote_count":19,"is_accepted":false,"score":19,"last_activity_date":1650117571,"creation_date":1629822170,"answer_id":68910849,"question_id":18805455,"body_markdown":"Use the [`JsonSetter`][1] annotation with the value [`Nulls.SKIP`][2]\r\n\r\nIf you want to assign a default value to any param which is not set in json request then you can simply assign that in the POJO itself.\r\n\r\nIf you don&#39;t use `@JsonSetter(nulls = Nulls.SKIP)` then the default value will be initialised only if there is no value coming in JSON, but if someone explicitly put a null then it can lead to a problem. Using `@JsonSetter(nulls = Nulls.SKIP)` will tell the Json de-searilizer to avoid `null` initialisation.\r\n\r\n\r\n&gt; Value that indicates that an input null value should be skipped and the default assignment is to be made; **this usually means that the property will have its default value**.\r\n\r\nas follow:\r\n\r\n    public class User {\r\n        @JsonSetter(nulls = Nulls.SKIP)\r\n        private Integer Score = 1000;\r\n        ...\r\n    }\r\n\r\n  [1]: https://fasterxml.github.io/jackson-annotations/javadoc/2.0.0/com/fasterxml/jackson/annotation/JsonSetter.html&lt;br/&gt;\r\n  [2]: https://fasterxml.github.io/jackson-annotations/javadoc/2.9/com/fasterxml/jackson/annotation/Nulls.html#SKIP","title":"Setting default values to null fields when mapping with Jackson","body":"<p>Use the <a href=\"https://fasterxml.github.io/jackson-annotations/javadoc/2.0.0/com/fasterxml/jackson/annotation/JsonSetter.html%3Cbr/%3E\" rel=\"noreferrer\"><code>JsonSetter</code></a> annotation with the value <a href=\"https://fasterxml.github.io/jackson-annotations/javadoc/2.9/com/fasterxml/jackson/annotation/Nulls.html#SKIP\" rel=\"noreferrer\"><code>Nulls.SKIP</code></a></p>\n<p>If you want to assign a default value to any param which is not set in json request then you can simply assign that in the POJO itself.</p>\n<p>If you don't use <code>@JsonSetter(nulls = Nulls.SKIP)</code> then the default value will be initialised only if there is no value coming in JSON, but if someone explicitly put a null then it can lead to a problem. Using <code>@JsonSetter(nulls = Nulls.SKIP)</code> will tell the Json de-searilizer to avoid <code>null</code> initialisation.</p>\n<blockquote>\n<p>Value that indicates that an input null value should be skipped and the default assignment is to be made; <strong>this usually means that the property will have its default value</strong>.</p>\n</blockquote>\n<p>as follow:</p>\n<pre><code>public class User {\n    @JsonSetter(nulls = Nulls.SKIP)\n    private Integer Score = 1000;\n    ...\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1639094010,"post_id":70297702,"comment_id":124268043,"body_markdown":"As it‚Äôs currently written, your answer is unclear. Please [edit] to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"As it‚Äôs currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/70297702/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":14507292,"reputation":111,"user_id":10478747,"display_name":"Jagadish"},"comment_count":1,"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1657712375,"creation_date":1639090102,"answer_id":70297702,"question_id":18805455,"body_markdown":"There is a solution, if you use Lombok&#39;s Builder annotation, you can combine Lombok with Jackson via the [@Jacksonized][1] annotation.\r\n\r\nWithout this, the combination of Lombok and Jackson is not working for this.\r\n\r\nVia adding the ```@Builder.Default``` on the property you are then able to set default values.\r\n\r\n&lt;!-- begin snippet: js hide: false console: true babel: false --&gt;\r\n\r\n&lt;!-- language: lang-html --&gt;\r\n\r\n    @Value\r\n    @Builder\r\n    @Jacksonized\r\n    public class SomeClass {\r\n\r\n         String field1;\r\n         \r\n         @Builder.Default\r\n         String field2 = &quot;default-value&quot;;\r\n\r\n    }\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\nSo, in the incoming json request, if the field2 is not specified, then the Builder.default annotation will allow the Builder interface to set the specified default-value into the property, if not, the original value from the request is set into that.\r\n\r\n\r\n  [1]: https://projectlombok.org/features/experimental/Jacksonized","title":"Setting default values to null fields when mapping with Jackson","body":"<p>There is a solution, if you use Lombok's Builder annotation, you can combine Lombok with Jackson via the <a href=\"https://projectlombok.org/features/experimental/Jacksonized\" rel=\"noreferrer\">@Jacksonized</a> annotation.</p>\n<p>Without this, the combination of Lombok and Jackson is not working for this.</p>\n<p>Via adding the <code>@Builder.Default</code> on the property you are then able to set default values.</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>@Value\n@Builder\n@Jacksonized\npublic class SomeClass {\n\n     String field1;\n     \n     @Builder.Default\n     String field2 = \"default-value\";\n\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n<p>So, in the incoming json request, if the field2 is not specified, then the Builder.default annotation will allow the Builder interface to set the specified default-value into the property, if not, the original value from the request is set into that.</p>\n"},{"tags":[],"owner":{"account_id":7661804,"reputation":63,"user_id":5806870,"display_name":"H. Sellik"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672906699,"creation_date":1672906699,"answer_id":75015546,"question_id":18805455,"body_markdown":"You can also apply `@JsonInclude(Include.NON_NULL)` to the entire class using Jackson &gt; 2. This will ignore null fields.\r\n\r\n&gt; Value that indicates that only properties with non-null values are to be included.\r\n\r\n```\r\n@JsonInclude(Include.NON_NULL)\r\nclass Foo\r\n{\r\n  String bar;\r\n}\r\n```\r\n\r\nhttps://stackoverflow.com/a/11761975/5806870","title":"Setting default values to null fields when mapping with Jackson","body":"<p>You can also apply <code>@JsonInclude(Include.NON_NULL)</code> to the entire class using Jackson &gt; 2. This will ignore null fields.</p>\n<blockquote>\n<p>Value that indicates that only properties with non-null values are to be included.</p>\n</blockquote>\n<pre><code>@JsonInclude(Include.NON_NULL)\nclass Foo\n{\n  String bar;\n}\n</code></pre>\n<p><a href=\"https://stackoverflow.com/a/11761975/5806870\">https://stackoverflow.com/a/11761975/5806870</a></p>\n"}],"owner":{"account_id":2652951,"reputation":2597,"user_id":2294202,"accept_rate":80,"display_name":"gookman"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":278605,"favorite_count":0,"down_vote_count":0,"up_vote_count":118,"accepted_answer_id":18806773,"answer_count":11,"score":118,"last_activity_date":1672906699,"creation_date":1379186111,"question_id":18805455,"body_markdown":"I am trying to map some JSON objects to Java objects with Jackson. Some of the fields in the JSON object are mandatory(which I can mark with `@NotNull`) and some are optional.\r\n\r\nAfter the mapping with Jackson, all the fields that are not set in the JSON object will have a null value in Java. Is there a similar annotation to `@NotNull` that can tell Jackson to set a default value to a Java class member, in case it is null?\r\n\r\nEdit:\r\nTo make the question more clear here is some code example.\r\n\r\nThe Java object:\r\n\r\n    class JavaObject {\r\n        @NotNull\r\n        public String notNullMember;\r\n\r\n        @DefaultValue(&quot;Value&quot;)\r\n        public String optionalMember;\r\n    }\r\n\r\nThe JSON object can be either:\r\n\r\n    {\r\n        &quot;notNullMember&quot; : &quot;notNull&quot;\r\n    }\r\nor:\r\n    \r\n    {\r\n        &quot;notNullMember&quot; : &quot;notNull&quot;,\r\n        &quot;optionalMember&quot; : &quot;optional&quot;\r\n    }\r\n\r\nThe `@DefaultValue` annotations is just to show what I am asking. It&#39;s not a real annotation. If the JSON object is like in the first example I want the value of the `optionalMember` to be `&quot;Value&quot;` and not `null`. Is there an annotation that does such a thing?\r\n\r\n","title":"Setting default values to null fields when mapping with Jackson","body":"<p>I am trying to map some JSON objects to Java objects with Jackson. Some of the fields in the JSON object are mandatory(which I can mark with <code>@NotNull</code>) and some are optional.</p>\n\n<p>After the mapping with Jackson, all the fields that are not set in the JSON object will have a null value in Java. Is there a similar annotation to <code>@NotNull</code> that can tell Jackson to set a default value to a Java class member, in case it is null?</p>\n\n<p>Edit:\nTo make the question more clear here is some code example.</p>\n\n<p>The Java object:</p>\n\n<pre><code>class JavaObject {\n    @NotNull\n    public String notNullMember;\n\n    @DefaultValue(\"Value\")\n    public String optionalMember;\n}\n</code></pre>\n\n<p>The JSON object can be either:</p>\n\n<pre><code>{\n    \"notNullMember\" : \"notNull\"\n}\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>{\n    \"notNullMember\" : \"notNull\",\n    \"optionalMember\" : \"optional\"\n}\n</code></pre>\n\n<p>The <code>@DefaultValue</code> annotations is just to show what I am asking. It's not a real annotation. If the JSON object is like in the first example I want the value of the <code>optionalMember</code> to be <code>\"Value\"</code> and not <code>null</code>. Is there an annotation that does such a thing?</p>\n"},{"tags":["java","internationalization","resourcebundle"],"comments":[{"owner":{"account_id":5774013,"reputation":1046,"user_id":5369132,"accept_rate":25,"display_name":"JesseBoyd"},"score":3,"creation_date":1506203404,"post_id":12072454,"comment_id":79727310,"body_markdown":"this is a great question and a great opportunity for Java to provide a utility method to return application specific available resources.  My research has turned up no useful solution other than iterating or searching files which seems a waste of resources.","body":"this is a great question and a great opportunity for Java to provide a utility method to return application specific available resources.  My research has turned up no useful solution other than iterating or searching files which seems a waste of resources."}],"answers":[{"comments":[{"owner":{"account_id":111681,"reputation":13319,"user_id":1480018,"accept_rate":87,"display_name":"Paul Taylor"},"score":0,"creation_date":1345637839,"post_id":12072910,"comment_id":16126458,"body_markdown":"Okay I see wht you mean. I&#39;m thinking about doing the iteration  but the files are within a jar not directly within a os folder, so how do I do that ?","body":"Okay I see wht you mean. I&#39;m thinking about doing the iteration  but the files are within a jar not directly within a os folder, so how do I do that ?"},{"owner":{"account_id":481401,"reputation":15030,"user_id":895215,"accept_rate":64,"display_name":"dcernahoschi"},"score":0,"creation_date":1345638586,"post_id":12072910,"comment_id":16126835,"body_markdown":"The best idea that comes into my mind is to use the java Zip API and to look inside the jar for files named `widget_*.properties`","body":"The best idea that comes into my mind is to use the java Zip API and to look inside the jar for files named <code>widget_*.properties</code>"},{"owner":{"account_id":111681,"reputation":13319,"user_id":1480018,"accept_rate":87,"display_name":"Paul Taylor"},"score":0,"creation_date":1345638977,"post_id":12072910,"comment_id":16127043,"body_markdown":"Problem is where the jar file is is relative to your working directory ectera (i/e on oSX this can be trickly to establish), so I tried using classloader but it doesnt support any kind of wildcard seaerch i.e ClassLoader.getSystemResources(&quot;widget_en.properties&quot;); finds one file but ClassLoader.getSystemResources(&quot;widget_*&quot;); returns nothing","body":"Problem is where the jar file is is relative to your working directory ectera (i/e on oSX this can be trickly to establish), so I tried using classloader but it doesnt support any kind of wildcard seaerch i.e ClassLoader.getSystemResources(&quot;widget_en.properties&quot;); finds one file but ClassLoader.getSystemResources(&quot;widget_*&quot;); returns nothing"},{"owner":{"account_id":481401,"reputation":15030,"user_id":895215,"accept_rate":64,"display_name":"dcernahoschi"},"score":0,"creation_date":1345639366,"post_id":12072910,"comment_id":16127244,"body_markdown":"If you&#39;ll add only a few standard locales you can use Locale.getAvailableLocales() to iterate over the system locales and get the corresponding bundles. But is not 100% sure.","body":"If you&#39;ll add only a few standard locales you can use Locale.getAvailableLocales() to iterate over the system locales and get the corresponding bundles. But is not 100% sure."}],"tags":[],"owner":{"account_id":481401,"reputation":15030,"user_id":895215,"accept_rate":64,"display_name":"dcernahoschi"},"comment_count":4,"down_vote_count":0,"up_vote_count":5,"is_accepted":true,"score":5,"last_activity_date":1430892959,"creation_date":1345637656,"answer_id":12072910,"question_id":12072454,"body_markdown":"I don&#39;t think there is an API for this because new valid locale objects can be created on the fly: \r\n\r\n    Locale locale = new Locale(&quot;abcd&quot;);\r\n\r\nwithout the need to register it somewhere. And then you can use a resource bundle \r\n`widget_abcd.properties` without restrictions: \r\n\r\n    ResourceBundle resource= ResourceBundle.getBundle(&quot;widget&quot;, new Locale(&quot;abcd&quot;));\r\n\r\nFrom the `java.util.Locale` API docs:\r\n\r\n&gt; Because a Locale object is just an identifier for a region, no\r\n&gt; validity check is performed when you construct a Locale. If you want\r\n&gt; to see whether particular resources are available for the Locale you\r\n&gt; construct, you must query those resources.\r\n\r\nTo solve the problem you can still iterate over all files called &quot;widget_&quot; in the resource directory and discover the new added resource bundles.\r\n\r\nNote that `Locale.getAvailableLocales()` **is not 100% sure** for the above reason: you might some day define a non standard locale. But if you&#39;ll add only a few standard locales you can use this static method to iterate over the system locales and get the corresponding bundles.","title":"In Java how do I find out what languages I have available my Resource Bundle","body":"<p>I don't think there is an API for this because new valid locale objects can be created on the fly: </p>\n\n<pre><code>Locale locale = new Locale(\"abcd\");\n</code></pre>\n\n<p>without the need to register it somewhere. And then you can use a resource bundle \n<code>widget_abcd.properties</code> without restrictions: </p>\n\n<pre><code>ResourceBundle resource= ResourceBundle.getBundle(\"widget\", new Locale(\"abcd\"));\n</code></pre>\n\n<p>From the <code>java.util.Locale</code> API docs:</p>\n\n<blockquote>\n  <p>Because a Locale object is just an identifier for a region, no\n  validity check is performed when you construct a Locale. If you want\n  to see whether particular resources are available for the Locale you\n  construct, you must query those resources.</p>\n</blockquote>\n\n<p>To solve the problem you can still iterate over all files called \"widget_\" in the resource directory and discover the new added resource bundles.</p>\n\n<p>Note that <code>Locale.getAvailableLocales()</code> <strong>is not 100% sure</strong> for the above reason: you might some day define a non standard locale. But if you'll add only a few standard locales you can use this static method to iterate over the system locales and get the corresponding bundles.</p>\n"},{"tags":[],"owner":{"account_id":1322191,"reputation":11583,"user_id":1267768,"accept_rate":83,"display_name":"Matt"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1345639736,"creation_date":1345639736,"answer_id":12073530,"question_id":12072454,"body_markdown":"If you can make two basic assumptions:\r\n\r\n1)  You have a default resource bundle with no locale, or at least one locale that you know is there. \r\n\r\n2)  All your resources are in the same location (ie. the same path within a single jar file)\r\n\r\nThen you can get the URL for a single resource:\r\n\r\n    URL url = SomeClass.class.getClassLoader().getResource(&quot;widget.properties&quot;);\r\n\r\nonce you have that, you should be able to parse the URL.\r\n\r\nIf you use commons-vfs, you should be able to convert the URL into  a FileObject:\r\n\r\n    FileSystemManager manager = VFS.getManager();\r\n    FileObject resource = manager.resolveFile(url.toExternalForm());\r\n    FileObject parent = resource.getParent();\r\n    FileObject children[] = parent.getChildren();\r\n    // figure out which ones are bundles, and parse the names into a list of locales.\r\n\r\nThis will save you the trouble of dealing with the complexities of jar: style url&#39;s and such,\r\nsince vfs will handle that for you.\r\n","title":"In Java how do I find out what languages I have available my Resource Bundle","body":"<p>If you can make two basic assumptions:</p>\n\n<p>1)  You have a default resource bundle with no locale, or at least one locale that you know is there. </p>\n\n<p>2)  All your resources are in the same location (ie. the same path within a single jar file)</p>\n\n<p>Then you can get the URL for a single resource:</p>\n\n<pre><code>URL url = SomeClass.class.getClassLoader().getResource(\"widget.properties\");\n</code></pre>\n\n<p>once you have that, you should be able to parse the URL.</p>\n\n<p>If you use commons-vfs, you should be able to convert the URL into  a FileObject:</p>\n\n<pre><code>FileSystemManager manager = VFS.getManager();\nFileObject resource = manager.resolveFile(url.toExternalForm());\nFileObject parent = resource.getParent();\nFileObject children[] = parent.getChildren();\n// figure out which ones are bundles, and parse the names into a list of locales.\n</code></pre>\n\n<p>This will save you the trouble of dealing with the complexities of jar: style url's and such,\nsince vfs will handle that for you.</p>\n"},{"comments":[{"owner":{"account_id":111681,"reputation":13319,"user_id":1480018,"accept_rate":87,"display_name":"Paul Taylor"},"score":0,"creation_date":1345641030,"post_id":12073815,"comment_id":16128071,"body_markdown":"Yes I really do package them within my jar, in a previous project I did not, but not Im using maven to build it seemed to want to put it in the jar, is that wierd ?","body":"Yes I really do package them within my jar, in a previous project I did not, but not Im using maven to build it seemed to want to put it in the jar, is that wierd ?"},{"owner":{"account_id":192606,"reputation":9871,"user_id":433835,"accept_rate":95,"display_name":"Koh&#225;nyi R&#243;bert"},"score":0,"creation_date":1345641738,"post_id":12073815,"comment_id":16128481,"body_markdown":"@PaulTaylor I like it when static resources are truly static. I don&#39;t like adding checks to my code like `new File(file).exists()` even if I only want to read a damn property from that file, which is *there* 99.9% of the time. Anyways, I think you have to apply *some level of hack* to your code if you want to load properties from external files with the ResourceBundle class - although I&#39;m not sure - so it doesn&#39;t really matter either way.  Bottom line: I think you&#39;re doing it just fine.","body":"@PaulTaylor I like it when static resources are truly static. I don&#39;t like adding checks to my code like <code>new File(file).exists()</code> even if I only want to read a damn property from that file, which is <i>there</i> 99.9% of the time. Anyways, I think you have to apply <i>some level of hack</i> to your code if you want to load properties from external files with the ResourceBundle class - although I&#39;m not sure - so it doesn&#39;t really matter either way.  Bottom line: I think you&#39;re doing it just fine."},{"owner":{"account_id":111681,"reputation":13319,"user_id":1480018,"accept_rate":87,"display_name":"Paul Taylor"},"score":0,"creation_date":1345648005,"post_id":12073815,"comment_id":16131930,"body_markdown":"Oh I see you mean storing them outside of java file rather than storing them in properties file within/outside of jar. Storing the resource bundles as properties files allows me to use tools to easily edit and translate the properties to other languages.","body":"Oh I see you mean storing them outside of java file rather than storing them in properties file within/outside of jar. Storing the resource bundles as properties files allows me to use tools to easily edit and translate the properties to other languages."},{"owner":{"account_id":192606,"reputation":9871,"user_id":433835,"accept_rate":95,"display_name":"Koh&#225;nyi R&#243;bert"},"score":0,"creation_date":1345651672,"post_id":12073815,"comment_id":16133576,"body_markdown":"@PaulTaylor I meant that if you have a JAR `application.jar` the resource property file should be inside this JAR (for localizable content at the least). Sorry if I was confusing.","body":"@PaulTaylor I meant that if you have a JAR <code>application.jar</code> the resource property file should be inside this JAR (for localizable content at the least). Sorry if I was confusing."},{"owner":{"account_id":111681,"reputation":13319,"user_id":1480018,"accept_rate":87,"display_name":"Paul Taylor"},"score":0,"creation_date":1345673154,"post_id":12073815,"comment_id":16141979,"body_markdown":"Still don&#39;t understand your point, yes they are in the main jar thats what I said,or is application.jar a particular naming convention in application servers, if so not relevant for this desktop application","body":"Still don&#39;t understand your point, yes they are in the main jar thats what I said,or is application.jar a particular naming convention in application servers, if so not relevant for this desktop application"},{"owner":{"account_id":192606,"reputation":9871,"user_id":433835,"accept_rate":95,"display_name":"Koh&#225;nyi R&#243;bert"},"score":0,"creation_date":1345698075,"post_id":12073815,"comment_id":16146500,"body_markdown":"@PaulTaylor I was referring to the fact that you could have store your localizable properties elsewhere, like *beside* your JAR file. In this case, as I know, you couldn&#39;t have used the `ResourceBundle` class in the first place. Sorry again for being confusing, I was confused myself, because when I wrote my post I thought for a minute that you can use `ResourceBundle` to read stuff from arbitrary property files (although one could write a custom control for doing so).","body":"@PaulTaylor I was referring to the fact that you could have store your localizable properties elsewhere, like <i>beside</i> your JAR file. In this case, as I know, you couldn&#39;t have used the <code>ResourceBundle</code> class in the first place. Sorry again for being confusing, I was confused myself, because when I wrote my post I thought for a minute that you can use <code>ResourceBundle</code> to read stuff from arbitrary property files (although one could write a custom control for doing so)."}],"tags":[],"owner":{"account_id":192606,"reputation":9871,"user_id":433835,"accept_rate":95,"display_name":"Koh&#225;nyi R&#243;bert"},"comment_count":6,"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1345640696,"creation_date":1345640696,"answer_id":12073815,"question_id":12072454,"body_markdown":"If you really package the resource files *inside* your JAR, then I would do it like this:\r\n\r\n    public static void main(String[] args) {\r\n      Set&lt;ResourceBundle&gt; resourceBundles = getResourceBundles(A.class.getName());\r\n      if (resourceBundles.isEmpty())\r\n        // ...\r\n    }\r\n    \r\n    public static Set&lt;ResourceBundle&gt; getResourceBundles(String baseName) {\r\n      Set&lt;ResourceBundle&gt; resourceBundles = new HashSet&lt;&gt;();\r\n\r\n      for (Locale locale : Locale.getAvailableLocales()) {\r\n        try {\r\n          resourceBundles.add(ResourceBundle.getBundle(baseName, locale));\r\n        } catch (MissingResourceException ex) {\r\n          // ...\r\n        }\r\n      }\r\n\r\n      return Collections.unmodifiableSet(resourceBundles);\r\n    }\r\n\r\nIf you care about your JARs then you would at least get a set containing the default resource for a given `baseName`.\r\n\r\nIf you have only resources with names like `baseName_&lt;country&gt;` this method works perfectly, because only those `ResourceBundles` will be added to the set which are present in your JAR. It&#39;ll work even if you decide you need separate `baseName_en_US` and `baseName_en_UK` resources, which is not unheard of.\r\n\r\n&lt;sub&gt;Shameless self-plug: I wrote a [`ResourceBundle.Control`][1] which takes a [`Charset`][2] as its argument, you might be interested in it if you want to load UTF-8 encoded resources files. [It&#39;s available at GitHub.][3]&lt;/sub&gt;\r\n\r\n[1]: http://docs.oracle.com/javase/7/docs/api/java/util/ResourceBundle.Control.html\r\n[2]: http://docs.oracle.com/javase/7/docs/api/java/nio/charset/Charset.html\r\n[3]: https://github.com/kohanyirobert/java-util-resource-bundle-charset-control","title":"In Java how do I find out what languages I have available my Resource Bundle","body":"<p>If you really package the resource files <em>inside</em> your JAR, then I would do it like this:</p>\n\n<pre><code>public static void main(String[] args) {\n  Set&lt;ResourceBundle&gt; resourceBundles = getResourceBundles(A.class.getName());\n  if (resourceBundles.isEmpty())\n    // ...\n}\n\npublic static Set&lt;ResourceBundle&gt; getResourceBundles(String baseName) {\n  Set&lt;ResourceBundle&gt; resourceBundles = new HashSet&lt;&gt;();\n\n  for (Locale locale : Locale.getAvailableLocales()) {\n    try {\n      resourceBundles.add(ResourceBundle.getBundle(baseName, locale));\n    } catch (MissingResourceException ex) {\n      // ...\n    }\n  }\n\n  return Collections.unmodifiableSet(resourceBundles);\n}\n</code></pre>\n\n<p>If you care about your JARs then you would at least get a set containing the default resource for a given <code>baseName</code>.</p>\n\n<p>If you have only resources with names like <code>baseName_&lt;country&gt;</code> this method works perfectly, because only those <code>ResourceBundles</code> will be added to the set which are present in your JAR. It'll work even if you decide you need separate <code>baseName_en_US</code> and <code>baseName_en_UK</code> resources, which is not unheard of.</p>\n\n<p><sub>Shameless self-plug: I wrote a <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/ResourceBundle.Control.html\" rel=\"noreferrer\"><code>ResourceBundle.Control</code></a> which takes a <a href=\"http://docs.oracle.com/javase/7/docs/api/java/nio/charset/Charset.html\" rel=\"noreferrer\"><code>Charset</code></a> as its argument, you might be interested in it if you want to load UTF-8 encoded resources files. <a href=\"https://github.com/kohanyirobert/java-util-resource-bundle-charset-control\" rel=\"noreferrer\">It's available at GitHub.</a></sub></p>\n"},{"comments":[{"owner":{"account_id":67765,"reputation":5435,"user_id":198108,"accept_rate":79,"display_name":"javydreamercsw"},"score":2,"creation_date":1495563895,"post_id":34551293,"comment_id":75302733,"body_markdown":"This is missing some code and doesn&#39;t compile as written.","body":"This is missing some code and doesn&#39;t compile as written."},{"owner":{"account_id":954960,"reputation":13272,"user_id":980442,"accept_rate":25,"display_name":"Daniel De Le&#243;n"},"score":0,"creation_date":1495661300,"post_id":34551293,"comment_id":75353513,"body_markdown":"Fixed, please check again.","body":"Fixed, please check again."}],"tags":[],"owner":{"account_id":954960,"reputation":13272,"user_id":980442,"accept_rate":25,"display_name":"Daniel De Le&#243;n"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1495661187,"creation_date":1451593269,"answer_id":34551293,"question_id":12072454,"body_markdown":"A solve it by listing files.\r\n\r\n\r\n    public class JavaApplication1 {\r\n\r\n        public static final ArrayList&lt;String&gt; LOCALES = new ArrayList&lt;&gt;();\r\n\r\n        static {\r\n            try {\r\n                File f = new File(JavaApplication1.class.getResource(&quot;/l10n&quot;).toURI());\r\n                final String bundle = &quot;widget_&quot;;// Bundle name prefix.\r\n                for (String s : f.list(new FilenameFilter() {\r\n                    @Override\r\n                    public boolean accept(File dir, String name) {\r\n                        return name.startsWith(bundle);\r\n                    }\r\n                })) {\r\n                    LOCALES.add(s.substring(bundle.length(), s.indexOf(&#39;.&#39;)));\r\n                }\r\n            } catch (URISyntaxException x) {\r\n                throw new RuntimeException(x);\r\n            }\r\n            LOCALES.trimToSize();\r\n        }\r\n\r\n        ...\r\n\r\n    }","title":"In Java how do I find out what languages I have available my Resource Bundle","body":"<p>A solve it by listing files.</p>\n\n<pre><code>public class JavaApplication1 {\n\n    public static final ArrayList&lt;String&gt; LOCALES = new ArrayList&lt;&gt;();\n\n    static {\n        try {\n            File f = new File(JavaApplication1.class.getResource(\"/l10n\").toURI());\n            final String bundle = \"widget_\";// Bundle name prefix.\n            for (String s : f.list(new FilenameFilter() {\n                @Override\n                public boolean accept(File dir, String name) {\n                    return name.startsWith(bundle);\n                }\n            })) {\n                LOCALES.add(s.substring(bundle.length(), s.indexOf('.')));\n            }\n        } catch (URISyntaxException x) {\n            throw new RuntimeException(x);\n        }\n        LOCALES.trimToSize();\n    }\n\n    ...\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":15782199,"reputation":69,"user_id":11388213,"display_name":"Universe Whole-Xuan"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672906655,"creation_date":1672906655,"answer_id":75015535,"question_id":12072454,"body_markdown":"This is my solution,hope can help people.\r\n\r\n    import org.apache.commons.io.FileUtils;\r\n    import org.apache.commons.io.filefilter.AndFileFilter;\r\n    import org.apache.commons.io.filefilter.PrefixFileFilter;\r\n    import org.apache.commons.io.filefilter.SuffixFileFilter;\r\n    import org.apache.commons.lang3.StringUtils; \r\n    private static Locale[] getAvailableLocales(String name) { \r\n        String path = thisClass.class.getClassLoader().getResource(&quot;&quot;).getPath();\r\n        if (path.contains(&quot;%20&quot;)) {\r\n            path = path.replaceFirst(&quot;%20&quot;, &quot; &quot;);\r\n        }\r\n        File file = new File(path);\r\n        Locale[] array = FileUtils.listFiles(file, new AndFileFilter(new PrefixFileFilter(name), new SuffixFileFilter(&quot;.properties&quot;)),null)\r\n                .stream()\r\n                .map(File::getName)\r\n                .map(v -&gt; StringUtils.substringBetween(v, name + &#39;_&#39;, &quot;.properties&quot;))\r\n                .map(v-&gt;v.replaceFirst(&quot;_&quot;,&quot;-&quot;))\r\n                .map(Locale::forLanguageTag)\r\n                .toArray(Locale[]::new);\r\n        return array;\r\n    }","title":"In Java how do I find out what languages I have available my Resource Bundle","body":"<p>This is my solution,hope can help people.</p>\n<pre><code>import org.apache.commons.io.FileUtils;\nimport org.apache.commons.io.filefilter.AndFileFilter;\nimport org.apache.commons.io.filefilter.PrefixFileFilter;\nimport org.apache.commons.io.filefilter.SuffixFileFilter;\nimport org.apache.commons.lang3.StringUtils; \nprivate static Locale[] getAvailableLocales(String name) { \n    String path = thisClass.class.getClassLoader().getResource(&quot;&quot;).getPath();\n    if (path.contains(&quot;%20&quot;)) {\n        path = path.replaceFirst(&quot;%20&quot;, &quot; &quot;);\n    }\n    File file = new File(path);\n    Locale[] array = FileUtils.listFiles(file, new AndFileFilter(new PrefixFileFilter(name), new SuffixFileFilter(&quot;.properties&quot;)),null)\n            .stream()\n            .map(File::getName)\n            .map(v -&gt; StringUtils.substringBetween(v, name + '_', &quot;.properties&quot;))\n            .map(v-&gt;v.replaceFirst(&quot;_&quot;,&quot;-&quot;))\n            .map(Locale::forLanguageTag)\n            .toArray(Locale[]::new);\n    return array;\n}\n</code></pre>\n"}],"owner":{"account_id":111681,"reputation":13319,"user_id":1480018,"accept_rate":87,"display_name":"Paul Taylor"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":10311,"favorite_count":0,"down_vote_count":0,"up_vote_count":27,"accepted_answer_id":12072910,"answer_count":5,"score":27,"last_activity_date":1672906655,"creation_date":1345636202,"question_id":12072454,"body_markdown":"I have some resource bundles packaged in my main jar \r\n\r\n    widget_en.properties\r\n    widget_de.properties\r\n\r\nI retrieve a resource bundle based on my default locale as folows\r\n\r\n    ResourceBundle.getBundle(&quot;widget&quot;, Locale.getDefault());\r\n\r\nBut I want to present the user with a list of available languages supported so that can select a language that may be different to their computers default\r\n\r\nBut I can&#39;t find a method in ResourceBundle that would list available locales, I don&#39;t want to hardcode a list as I may forget to update it when another resource bundle is added.\r\n\r\n**EDIT**\r\n\r\nAs I only resource bundles for different language (I dont have country refinements) so I have got generated a list by iterating through all the known language codes and check for each one as a resource.\r\n\r\n    String[]langs = Locale.getISOLanguages();\r\n    for(String lang:langs)\r\n    {\r\n          URL rb = ClassLoader.getSystemResource(&quot;widget_&quot;+lang+&quot;.properties&quot;);\r\n          if(rb!=null)\r\n          {\r\n                System.out.println(&quot;Found:&quot;+rb.toString());\r\n          }\r\n    }","title":"In Java how do I find out what languages I have available my Resource Bundle","body":"<p>I have some resource bundles packaged in my main jar </p>\n\n<pre><code>widget_en.properties\nwidget_de.properties\n</code></pre>\n\n<p>I retrieve a resource bundle based on my default locale as folows</p>\n\n<pre><code>ResourceBundle.getBundle(\"widget\", Locale.getDefault());\n</code></pre>\n\n<p>But I want to present the user with a list of available languages supported so that can select a language that may be different to their computers default</p>\n\n<p>But I can't find a method in ResourceBundle that would list available locales, I don't want to hardcode a list as I may forget to update it when another resource bundle is added.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>As I only resource bundles for different language (I dont have country refinements) so I have got generated a list by iterating through all the known language codes and check for each one as a resource.</p>\n\n<pre><code>String[]langs = Locale.getISOLanguages();\nfor(String lang:langs)\n{\n      URL rb = ClassLoader.getSystemResource(\"widget_\"+lang+\".properties\");\n      if(rb!=null)\n      {\n            System.out.println(\"Found:\"+rb.toString());\n      }\n}\n</code></pre>\n"},{"tags":["java","hibernate","orm","filter","mapping"],"answers":[{"tags":[],"owner":{"account_id":1012936,"reputation":145178,"user_id":1025118,"accept_rate":100,"display_name":"Vlad Mihalcea"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1409866652,"creation_date":1409866652,"answer_id":25675357,"question_id":25674339,"body_markdown":"While you can use Filters, you need to manually enable those for every Session.\r\n\r\nA much simpler approach is to use @Where:\r\n\r\n    User{\r\n       int id;\r\n\r\n       @Where(clause=&quot;deleted &lt;&gt; true&quot;)\r\n       private Set groups;\r\n\r\n       @Where(clause=&quot;deleted &lt;&gt; true&quot;)\r\n       private Set companies;\r\n    }\r\n\r\nThis way you can filter out the deleted children.","title":"How to filter data in Hibernate many to many mapping","body":"<p>While you can use Filters, you need to manually enable those for every Session.</p>\n\n<p>A much simpler approach is to use @Where:</p>\n\n<pre><code>User{\n   int id;\n\n   @Where(clause=\"deleted &lt;&gt; true\")\n   private Set groups;\n\n   @Where(clause=\"deleted &lt;&gt; true\")\n   private Set companies;\n}\n</code></pre>\n\n<p>This way you can filter out the deleted children.</p>\n"},{"tags":[],"owner":{"account_id":2357612,"reputation":15503,"user_id":2065083,"accept_rate":67,"display_name":"Chaitanya"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1409889988,"creation_date":1409889988,"answer_id":25678462,"question_id":25674339,"body_markdown":"One more way of doing this is using [`Criteria`][1] queries\r\n\r\n\r\n  [1]: https://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querycriteria.html","title":"How to filter data in Hibernate many to many mapping","body":"<p>One more way of doing this is using <a href=\"https://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querycriteria.html\" rel=\"nofollow\"><code>Criteria</code></a> queries</p>\n"},{"tags":[],"owner":{"account_id":4308961,"reputation":70,"user_id":10911886,"display_name":"user3520616"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672906087,"creation_date":1672906087,"answer_id":75015445,"question_id":25674339,"body_markdown":"In XML it would look like this:\r\n\r\n\r\n    &lt;set name=&quot;xyz&quot; cascade=&quot;save-update&quot; table=&quot;xyz&quot;&gt;\r\n      &lt;key&gt;\r\n        &lt;column name=&quot;xyz&quot; not-null=&quot;true&quot; /&gt;\r\n      &lt;/key&gt;\r\n      &lt;many-to-many entity-name=&quot;xyz&quot;&gt;\r\n        &lt;column name=&quot;xyz&quot; not-null=&quot;true&quot; /&gt;\r\n        \r\n        &lt;filter name=&quot;tenantFilter&quot; condition=&quot;xyz&quot;&gt;&lt;/filter&gt;\r\n      &lt;/many-to-many&gt;\r\n    &lt;/set&gt;","title":"How to filter data in Hibernate many to many mapping","body":"<p>In XML it would look like this:</p>\n<pre><code>&lt;set name=&quot;xyz&quot; cascade=&quot;save-update&quot; table=&quot;xyz&quot;&gt;\n  &lt;key&gt;\n    &lt;column name=&quot;xyz&quot; not-null=&quot;true&quot; /&gt;\n  &lt;/key&gt;\n  &lt;many-to-many entity-name=&quot;xyz&quot;&gt;\n    &lt;column name=&quot;xyz&quot; not-null=&quot;true&quot; /&gt;\n    \n    &lt;filter name=&quot;tenantFilter&quot; condition=&quot;xyz&quot;&gt;&lt;/filter&gt;\n  &lt;/many-to-many&gt;\n&lt;/set&gt;\n</code></pre>\n"}],"owner":{"account_id":4985782,"reputation":11,"user_id":4009461,"display_name":"AbhiShek SinGh"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":211,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":3,"score":1,"last_activity_date":1672906087,"creation_date":1409862072,"question_id":25674339,"body_markdown":"I have one table user which has mapping for Groups and companies.\r\n\r\n    User{\r\n    int id;\r\n    private Set groups;\r\n    private Set companies;\r\n    }\r\n\r\n\r\ngroup and companies both have one filed named &quot;deleted&quot; which is used to know the status of entity. I have done mapping with XML, now i want when i retrieve user record only those groups and companies will retrieve which is not deleted. (deleted=false)\r\nI am just stuck in this, so help me out.\r\n\r\nThank you.","title":"How to filter data in Hibernate many to many mapping","body":"<p>I have one table user which has mapping for Groups and companies.</p>\n\n<pre><code>User{\nint id;\nprivate Set groups;\nprivate Set companies;\n}\n</code></pre>\n\n<p>group and companies both have one filed named \"deleted\" which is used to know the status of entity. I have done mapping with XML, now i want when i retrieve user record only those groups and companies will retrieve which is not deleted. (deleted=false)\nI am just stuck in this, so help me out.</p>\n\n<p>Thank you.</p>\n"},{"tags":["java","spring","jpa","spring-data-jpa","spring-data"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1435134832,"post_id":31021519,"comment_id":50068258,"body_markdown":"There is nothing in your query that you can group by no calculations etc. are done... So not sure if you understand group by...","body":"There is nothing in your query that you can group by no calculations etc. are done... So not sure if you understand group by..."},{"owner":{"account_id":5946438,"reputation":91,"user_id":4675796,"display_name":"neocles"},"score":0,"creation_date":1435136069,"post_id":31021519,"comment_id":50068989,"body_markdown":"@M.Deinum. sorry, my query was wrong, I had changed it.","body":"@M.Deinum. sorry, my query was wrong, I had changed it."},{"owner":{"account_id":5946438,"reputation":91,"user_id":4675796,"display_name":"neocles"},"score":0,"creation_date":1435136657,"post_id":31021519,"comment_id":50069372,"body_markdown":"@M.Deinum I&#39;d like to grop entities by campaignId filed and make map where key is campaignId value and value is list of entities.","body":"@M.Deinum I&#39;d like to grop entities by campaignId filed and make map where key is campaignId value and value is list of entities."},{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1435137433,"post_id":31021519,"comment_id":50069886,"body_markdown":"That isn&#39;t how grouping works... You can group based on a count or sum for instance. In your case, just return a List and proces it to map later. That is the easiest I suspect.","body":"That isn&#39;t how grouping works... You can group based on a count or sum for instance. In your case, just return a List and proces it to map later. That is the easiest I suspect."},{"owner":{"account_id":255080,"reputation":15519,"user_id":534877,"accept_rate":65,"display_name":"Robert Niestroj"},"score":0,"creation_date":1435146193,"post_id":31021519,"comment_id":50075816,"body_markdown":"http://stackoverflow.com/questions/12076238/return-a-subset-of-a-jpa-entity-as-a-array-of-maps-from-a-jpql-query","body":"<a href=\"http://stackoverflow.com/questions/12076238/return-a-subset-of-a-jpa-entity-as-a-array-of-maps-from-a-jpql-query\" title=\"return a subset of a jpa entity as a array of maps from a jpql query\">stackoverflow.com/questions/12076238/&hellip;</a>"},{"owner":{"account_id":6241436,"reputation":2512,"user_id":4854931,"accept_rate":33,"display_name":"Alex78191"},"score":0,"creation_date":1496325069,"post_id":31021519,"comment_id":75624131,"body_markdown":"You should convert using Java Stream API.","body":"You should convert using Java Stream API."}],"answers":[{"comments":[{"owner":{"account_id":6537508,"reputation":1769,"user_id":5056459,"accept_rate":83,"display_name":"Adam Williams"},"score":0,"creation_date":1607811940,"post_id":56706311,"comment_id":115391995,"body_markdown":"This is inefficient, the grouping is being done in memory by the application instead of the database engine.","body":"This is inefficient, the grouping is being done in memory by the application instead of the database engine."},{"owner":{"account_id":1139113,"reputation":18996,"user_id":1123501,"accept_rate":89,"display_name":"Georgios Syngouroglou"},"score":0,"creation_date":1607819350,"post_id":56706311,"comment_id":115393382,"body_markdown":"You are correct, it is only suggested for small data sets. If your requirement is to group, lets say 20.000 rows, then it is better to let the DBMS do the job.","body":"You are correct, it is only suggested for small data sets. If your requirement is to group, lets say 20.000 rows, then it is better to let the DBMS do the job."}],"tags":[],"owner":{"account_id":1139113,"reputation":18996,"user_id":1123501,"accept_rate":89,"display_name":"Georgios Syngouroglou"},"comment_count":2,"down_vote_count":5,"up_vote_count":2,"is_accepted":false,"score":-3,"last_activity_date":1670251170,"creation_date":1561130703,"answer_id":56706311,"question_id":31021519,"body_markdown":"**Solution for small datasets only!!**  \r\n\r\nYou may get a list from your JPQL query and then convert it to map using the Java 8 Stream API.  \r\n  \r\n    // This method in your Repository interface\r\n    @Query(&quot;SELECT e FROM CampaignCrTargetingProfile e WHERE e.campaignId IN :ids&quot;)\r\n    public List&lt;CampaignCrTargetingProfile findByCampaignIdIn(@Param(&quot;ids&quot;) Iterable&lt;Integer&gt; ids);\r\n  \r\n    // This source from your Service class\r\n    List&lt;CampaignCrTargetingProfile&gt; list = repo.findByCampaignIdIn(iterableArg);\r\n    Map&lt;Integer, List&lt;CampaignCrTargetingProfile&gt;&gt; mapResult = list.stream()\r\n        .collect(Collectors.groupingBy(CampaignCrTargetingProfile::getCampaignId));\r\n  \r\nIt is better to let the DBMS prepare the GROUP BY operation but in order to get a Map as a result then the aforementioned code can prepare it with just one line of code, using Java 8 Stream API.  \r\nAs far as I have read, spring data does not support a result type of Map.  \r\nIt is inefficient, but I suggest it for small data sets.\r\n  \r\n## Important\r\n  \r\nI suggest to use this solution **only** when your data set consists of a small amount of entries and you are absolutely sure that this amount will not grow in the future, ex. when you use paging in order to limit your result set or a table of enumerated values because, as @adamwilliams comment, it is inefficient the grouping to be done in memory by the application.\r\n\r\n","title":"Spring data jpa. Return Map as result of group by operation","body":"<p><strong>Solution for small datasets only!!</strong></p>\n<p>You may get a list from your JPQL query and then convert it to map using the Java 8 Stream API.</p>\n<pre><code>// This method in your Repository interface\n@Query(&quot;SELECT e FROM CampaignCrTargetingProfile e WHERE e.campaignId IN :ids&quot;)\npublic List&lt;CampaignCrTargetingProfile findByCampaignIdIn(@Param(&quot;ids&quot;) Iterable&lt;Integer&gt; ids);\n\n// This source from your Service class\nList&lt;CampaignCrTargetingProfile&gt; list = repo.findByCampaignIdIn(iterableArg);\nMap&lt;Integer, List&lt;CampaignCrTargetingProfile&gt;&gt; mapResult = list.stream()\n    .collect(Collectors.groupingBy(CampaignCrTargetingProfile::getCampaignId));\n</code></pre>\n<p>It is better to let the DBMS prepare the GROUP BY operation but in order to get a Map as a result then the aforementioned code can prepare it with just one line of code, using Java 8 Stream API.<br />\nAs far as I have read, spring data does not support a result type of Map.<br />\nIt is inefficient, but I suggest it for small data sets.</p>\n<h2>Important</h2>\n<p>I suggest to use this solution <strong>only</strong> when your data set consists of a small amount of entries and you are absolutely sure that this amount will not grow in the future, ex. when you use paging in order to limit your result set or a table of enumerated values because, as @adamwilliams comment, it is inefficient the grouping to be done in memory by the application.</p>\n"}],"owner":{"account_id":5946438,"reputation":91,"user_id":4675796,"display_name":"neocles"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":11457,"favorite_count":0,"down_vote_count":0,"up_vote_count":8,"answer_count":1,"score":8,"last_activity_date":1672905910,"creation_date":1435134570,"question_id":31021519,"body_markdown":"I have a query in my jpa repository interface.\r\n\r\n    @Query(&quot;select e.campaignId, e from CampaignCrTargetingProfile e where e.campaignId in :ids group by e.campaignId&quot;)\r\n    public Map&lt;Integer, List&lt;CampaignCrTargetingProfile&gt;&gt; findByCampaignIdIn(@Param(&quot;ids&quot;) Iterable&lt;Integer&gt; ids);\r\n\r\ncampaignId is Integer.\r\n\r\nBut when I try to execute this query, I caught an exception.\r\n\r\n    Caused by: org.springframework.core.convert.ConverterNotFoundException: No converter found capable of converting from type java.lang.Integer to type java.util.Map&lt;?, ?&gt;\r\n\tat org.springframework.core.convert.support.GenericConversionService.handleConverterNotFound(GenericConversionService.java:311) ~[spring-core-4.1.5.RELEASE.jar:4.1.5.RELEASE]\r\n\tat org.springframework.core.convert.support.GenericConversionService.convert(GenericConversionService.java:192) ~[spring-core-4.1.5.RELEASE.jar:4.1.5.RELEASE]\r\n\tat org.springframework.core.convert.support.ArrayToObjectConverter.convert(ArrayToObjectConverter.java:66) ~[spring-core-4.1.5.RELEASE.jar:4.1.5.RELEASE]\r\n\tat org.springframework.core.convert.support.ConversionUtils.invokeConverter(ConversionUtils.java:35) ~[spring-core-4.1.5.RELEASE.jar:4.1.5.RELEASE]\r\n\t... 192 common frames omitted\r\n\r\nIs it possible to groping entites by its field and return result as Map&lt;Type of filed, Entity&gt;?  if it is impossible, is there another way to make something similar?","title":"Spring data jpa. Return Map as result of group by operation","body":"<p>I have a query in my jpa repository interface.</p>\n\n<pre><code>@Query(\"select e.campaignId, e from CampaignCrTargetingProfile e where e.campaignId in :ids group by e.campaignId\")\npublic Map&lt;Integer, List&lt;CampaignCrTargetingProfile&gt;&gt; findByCampaignIdIn(@Param(\"ids\") Iterable&lt;Integer&gt; ids);\n</code></pre>\n\n<p>campaignId is Integer.</p>\n\n<p>But when I try to execute this query, I caught an exception.</p>\n\n<pre><code>Caused by: org.springframework.core.convert.ConverterNotFoundException: No converter found capable of converting from type java.lang.Integer to type java.util.Map&lt;?, ?&gt;\nat org.springframework.core.convert.support.GenericConversionService.handleConverterNotFound(GenericConversionService.java:311) ~[spring-core-4.1.5.RELEASE.jar:4.1.5.RELEASE]\nat org.springframework.core.convert.support.GenericConversionService.convert(GenericConversionService.java:192) ~[spring-core-4.1.5.RELEASE.jar:4.1.5.RELEASE]\nat org.springframework.core.convert.support.ArrayToObjectConverter.convert(ArrayToObjectConverter.java:66) ~[spring-core-4.1.5.RELEASE.jar:4.1.5.RELEASE]\nat org.springframework.core.convert.support.ConversionUtils.invokeConverter(ConversionUtils.java:35) ~[spring-core-4.1.5.RELEASE.jar:4.1.5.RELEASE]\n... 192 common frames omitted\n</code></pre>\n\n<p>Is it possible to groping entites by its field and return result as Map?  if it is impossible, is there another way to make something similar?</p>\n"},{"tags":["java","sql","database","replace"],"comments":[{"owner":{"account_id":4181375,"reputation":5121,"user_id":3426309,"display_name":"Andrey B. Panfilov"},"score":2,"creation_date":1672905345,"post_id":75015040,"comment_id":132379320,"body_markdown":"you need to pay attention at least to `order by` and `group by` clauses, because replacing projection by `count(*)` makes SQL statement invalid if statement contains `order by` or `group by`. Another case is set operations: `UNION (ALL)`, `INTERSECT`, `MINUS` - that is obvious you can&#39;t perform desired transformation. Why do not just enclose original query into `select count(*) from (...)`?","body":"you need to pay attention at least to <code>order by</code> and <code>group by</code> clauses, because replacing projection by <code>count(*)</code> makes SQL statement invalid if statement contains <code>order by</code> or <code>group by</code>. Another case is set operations: <code>UNION (ALL)</code>, <code>INTERSECT</code>, <code>MINUS</code> - that is obvious you can&#39;t perform desired transformation. Why do not just enclose original query into <code>select count(*) from (...)</code>?"},{"owner":{"account_id":22807677,"reputation":414,"user_id":16959486,"display_name":"Teddy Tsai"},"score":0,"creation_date":1672906344,"post_id":75015040,"comment_id":132379537,"body_markdown":"@AndreyB.Panfilov because the database sharding parsing engine will not allow nested queries that do not contain the sharding column, it won&#39;t know how to route the query and throw a parsing exception.","body":"@AndreyB.Panfilov because the database sharding parsing engine will not allow nested queries that do not contain the sharding column, it won&#39;t know how to route the query and throw a parsing exception."},{"owner":{"account_id":4564696,"reputation":43122,"user_id":3706016,"display_name":"jarlh"},"score":0,"creation_date":1672906709,"post_id":75015040,"comment_id":132379643,"body_markdown":"To do this properly you need a full SQL grammar (for the dbms you&#39;re using.)","body":"To do this properly you need a full SQL grammar (for the dbms you&#39;re using.)"}],"answers":[{"tags":[],"owner":{"account_id":2094057,"reputation":506144,"user_id":1863229,"accept_rate":58,"display_name":"Tim Biegeleisen"},"comment_count":0,"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1672903869,"creation_date":1672903869,"answer_id":75015109,"question_id":75015040,"body_markdown":"We can try a regex replacement here, targeting the `SELECT` clause.  Assuming that each part of the query be on a separate line, we can try:\r\n\r\n&lt;!-- language: java --&gt;\r\n\r\n    String sql = &quot;select xxx,xxx,xxx \\nfrom xxx\\nwhere xxxxx&quot;;\r\n    String output = sql.replaceAll(&quot;\\\\bselect.*&quot;, &quot;select count(*) as total&quot;);\r\n    System.out.println(output);\r\n\r\nThis prints:\r\n\r\n    select count(*) as total\r\n    from xxx\r\n    where xxxxx\r\n\r\nThe regex pattern `\\bselect.*` will match the `select` keyword until the end of that line (`.*` will not match across newlines by default).  We then replace with the desired select count.","title":"Replace an arbitraty select SQL with a count SQL","body":"<p>We can try a regex replacement here, targeting the <code>SELECT</code> clause.  Assuming that each part of the query be on a separate line, we can try:</p>\n<pre class=\"lang-java prettyprint-override\"><code>String sql = &quot;select xxx,xxx,xxx \\nfrom xxx\\nwhere xxxxx&quot;;\nString output = sql.replaceAll(&quot;\\\\bselect.*&quot;, &quot;select count(*) as total&quot;);\nSystem.out.println(output);\n</code></pre>\n<p>This prints:</p>\n<pre><code>select count(*) as total\nfrom xxx\nwhere xxxxx\n</code></pre>\n<p>The regex pattern <code>\\bselect.*</code> will match the <code>select</code> keyword until the end of that line (<code>.*</code> will not match across newlines by default).  We then replace with the desired select count.</p>\n"}],"owner":{"account_id":22807677,"reputation":414,"user_id":16959486,"display_name":"Teddy Tsai"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":75,"favorite_count":0,"down_vote_count":1,"up_vote_count":3,"answer_count":1,"score":2,"last_activity_date":1672905541,"creation_date":1672903447,"question_id":75015040,"body_markdown":"I need like to write a method (java) to transform an arbirtraty SQL string\r\n```\r\nselect xxx,xxx,xxx \r\nfrom xxx\r\nwhere xxxxx\r\n\r\n-- or\r\n\r\nselect *\r\nfrom xxx\r\nwhere xxxxx\r\n```\r\nto a count sql string like:\r\n```\r\nselect count(*) as total\r\nfrom xxx\r\nwhere xxxxx\r\n```\r\n\r\nI was thinking of replacing anything between ```select``` and ```from``` with ```count(*) as total```, are there some potential problems with this approach? I don&#39;t need to handle EVERY case but I&#39;d like to know which cases could be problematic with this approach and if I can afford to ignore them, or if you would do it some other way.\r\n\r\nI cannot use this nested solution \r\n```\r\nselect count(*)\r\nfrom ( original query )\r\n```\r\n because of database sharding limitations.","title":"Replace an arbitraty select SQL with a count SQL","body":"<p>I need like to write a method (java) to transform an arbirtraty SQL string</p>\n<pre><code>select xxx,xxx,xxx \nfrom xxx\nwhere xxxxx\n\n-- or\n\nselect *\nfrom xxx\nwhere xxxxx\n</code></pre>\n<p>to a count sql string like:</p>\n<pre><code>select count(*) as total\nfrom xxx\nwhere xxxxx\n</code></pre>\n<p>I was thinking of replacing anything between <code>select</code> and <code>from</code> with <code>count(*) as total</code>, are there some potential problems with this approach? I don't need to handle EVERY case but I'd like to know which cases could be problematic with this approach and if I can afford to ignore them, or if you would do it some other way.</p>\n<p>I cannot use this nested solution</p>\n<pre><code>select count(*)\nfrom ( original query )\n</code></pre>\n<p>because of database sharding limitations.</p>\n"},{"tags":["java","spring","spring-boot","intellij-idea"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":4,"creation_date":1672904537,"post_id":75015172,"comment_id":132379119,"body_markdown":"Spring Boot 3 requires JDK17. You only have JDK11 so that won&#39;t work. You need JDK17.","body":"Spring Boot 3 requires JDK17. You only have JDK11 so that won&#39;t work. You need JDK17."}],"answers":[{"tags":[],"owner":{"account_id":4814720,"reputation":1477,"user_id":3887145,"display_name":"Ralf Wagner"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1672905337,"creation_date":1672905337,"answer_id":75015321,"question_id":75015172,"body_markdown":"Spring Boot 3 requires Java 17 as a minimum Java version, so you need to install this on your machine. (If you need to use several Java versions in parallel on your machine, this can be done quite nicely with SDKMan (https://sdkman.io/).\r\n\r\nIn IntelliJ, you need to add the new Java runtime to the known Java runtimes (File &gt; Project Settings &gt; SDKs) and the use it for your project (File &gt; Project Settings &gt; Project &gt; SDK).","title":"Having java versioning issue with gradle in Spring project in IntelliJ","body":"<p>Spring Boot 3 requires Java 17 as a minimum Java version, so you need to install this on your machine. (If you need to use several Java versions in parallel on your machine, this can be done quite nicely with SDKMan (<a href=\"https://sdkman.io/\" rel=\"nofollow noreferrer\">https://sdkman.io/</a>).</p>\n<p>In IntelliJ, you need to add the new Java runtime to the known Java runtimes (File &gt; Project Settings &gt; SDKs) and the use it for your project (File &gt; Project Settings &gt; Project &gt; SDK).</p>\n"},{"tags":[],"owner":{"account_id":1545258,"reputation":1177,"user_id":1438934,"accept_rate":18,"display_name":"Anish Mittal"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1672905513,"creation_date":1672905513,"answer_id":75015348,"question_id":75015172,"body_markdown":"Spring Boot 3 requires Java 17 as minimum version. So just install Java 17 and update java runtime path in IntelliJ.","title":"Having java versioning issue with gradle in Spring project in IntelliJ","body":"<p>Spring Boot 3 requires Java 17 as minimum version. So just install Java 17 and update java runtime path in IntelliJ.</p>\n"}],"owner":{"account_id":1545258,"reputation":1177,"user_id":1438934,"accept_rate":18,"display_name":"Anish Mittal"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":114,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":75015348,"answer_count":2,"score":2,"last_activity_date":1672905513,"creation_date":1672904334,"question_id":75015172,"body_markdown":"I created a project from start.spring.io. No matter whether I choose Java 11 or Java 17 there, I get this error when I open this spring project in IntelliJ.\r\n\r\n**Error**:\r\n\r\n    Could not resolve org.springframework.boot:spring-boot-gradle-plugin:3.0.1.\r\n         Required by:\r\n             project : &gt; org.springframework.boot:org.springframework.boot.gradle.plugin:3.0.1\r\n          &gt; No matching variant of org.springframework.boot:spring-boot-gradle-plugin:3.0.1 was found.\r\n    Incompatible because this component declares an API of a component compatible with Java 17 and the consumer needed a runtime of a component compatible with Java 11.\r\n\r\n**Note**: I have installed Java 11 on my local machine.\r\n\r\nWhy importing Java/Gradle project is so much errorneous in IntelliJ?\r\n\r\n\r\n","title":"Having java versioning issue with gradle in Spring project in IntelliJ","body":"<p>I created a project from start.spring.io. No matter whether I choose Java 11 or Java 17 there, I get this error when I open this spring project in IntelliJ.</p>\n<p><strong>Error</strong>:</p>\n<pre><code>Could not resolve org.springframework.boot:spring-boot-gradle-plugin:3.0.1.\n     Required by:\n         project : &gt; org.springframework.boot:org.springframework.boot.gradle.plugin:3.0.1\n      &gt; No matching variant of org.springframework.boot:spring-boot-gradle-plugin:3.0.1 was found.\nIncompatible because this component declares an API of a component compatible with Java 17 and the consumer needed a runtime of a component compatible with Java 11.\n</code></pre>\n<p><strong>Note</strong>: I have installed Java 11 on my local machine.</p>\n<p>Why importing Java/Gradle project is so much errorneous in IntelliJ?</p>\n"},{"tags":["java","spring"],"comments":[{"owner":{"account_id":74886,"reputation":26643,"user_id":214977,"accept_rate":69,"display_name":"granadaCoder"},"score":0,"creation_date":1550996999,"post_id":5113579,"comment_id":96472385,"body_markdown":"Future readers, in case you have a &quot;I think what I wrote should work&quot; issue, also see this bug, with a &quot;status=declined&quot;.  https://github.com/spring-projects/spring-framework/issues/16017   Just in case the URL ever eventually fails, the title of the bug post is &quot; Import of an XML file from the root of a JAR file with wildcard classpath and wildcard path does not work [SPR-11390] &quot;","body":"Future readers, in case you have a &quot;I think what I wrote should work&quot; issue, also see this bug, with a &quot;status=declined&quot;.  <a href=\"https://github.com/spring-projects/spring-framework/issues/16017\" rel=\"nofollow noreferrer\">github.com/spring-projects/spring-framework/issues/16017</a>   Just in case the URL ever eventually fails, the title of the bug post is &quot; Import of an XML file from the root of a JAR file with wildcard classpath and wildcard path does not work [SPR-11390] &quot;"}],"answers":[{"comments":[{"owner":{"account_id":3600444,"reputation":696,"user_id":3003858,"accept_rate":48,"display_name":"Aditzu"},"score":0,"creation_date":1483716805,"post_id":5115384,"comment_id":70223574,"body_markdown":"And if I have the same situation but only using annotated configuration classes instead of spring-config.xml what can I do?","body":"And if I have the same situation but only using annotated configuration classes instead of spring-config.xml what can I do?"},{"owner":{"account_id":138128,"reputation":294236,"user_id":342852,"accept_rate":97,"display_name":"Sean Patrick Floyd"},"score":0,"creation_date":1483720723,"post_id":5115384,"comment_id":70226088,"body_markdown":"@Aditzu use `@Import` to import your other `@Configuration` classes.","body":"@Aditzu use <code>@Import</code> to import your other <code>@Configuration</code> classes."}],"tags":[],"owner":{"account_id":138128,"reputation":294236,"user_id":342852,"accept_rate":97,"display_name":"Sean Patrick Floyd"},"comment_count":2,"down_vote_count":0,"up_vote_count":121,"is_accepted":true,"score":121,"last_activity_date":1298624707,"creation_date":1298624707,"answer_id":5115384,"question_id":5113579,"body_markdown":"    &lt;import resource=&quot;classpath:spring-config.xml&quot; /&gt;\r\n\r\n**Reference:**\r\n\r\n - [Composing XML-based configuration\r\n   metadata][1]\r\n - [Resources][2] (here the `classpath:`\r\n   part is explained)\r\n\r\n  [1]: http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-factory-xml-import\r\n  [2]: http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/resources.html","title":"How to import spring-config.xml of one project into spring-config.xml of another project?","body":"<pre><code>&lt;import resource=\"classpath:spring-config.xml\" /&gt;\n</code></pre>\n\n<p><strong>Reference:</strong></p>\n\n<ul>\n<li><a href=\"http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-factory-xml-import\" rel=\"noreferrer\">Composing XML-based configuration\nmetadata</a></li>\n<li><a href=\"http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/resources.html\" rel=\"noreferrer\">Resources</a> (here the <code>classpath:</code>\npart is explained)</li>\n</ul>\n"},{"comments":[{"owner":{"account_id":1164600,"reputation":5578,"user_id":1143482,"accept_rate":63,"display_name":"jpganz18"},"score":0,"creation_date":1479149354,"post_id":7807684,"comment_id":68426990,"body_markdown":"does the classpath*: apply if is inside another module ?","body":"does the classpath*: apply if is inside another module ?"},{"owner":{"account_id":6530445,"reputation":1987,"user_id":5051731,"display_name":"YetAnotherBot"},"score":1,"creation_date":1543226496,"post_id":7807684,"comment_id":93827161,"body_markdown":"Note that the use of * does not throw any error if 0 files are found in the classpath.","body":"Note that the use of * does not throw any error if 0 files are found in the classpath."}],"tags":[],"owner":{"account_id":950742,"reputation":2108,"user_id":976948,"accept_rate":75,"display_name":"RicardoS"},"comment_count":2,"down_vote_count":0,"up_vote_count":63,"is_accepted":false,"score":63,"last_activity_date":1318943264,"creation_date":1318943264,"answer_id":7807684,"question_id":5113579,"body_markdown":"A small variation of Sean&#39;s answer:\r\n\r\n    &lt;import resource=&quot;classpath*:spring-config.xml&quot; /&gt;\r\n\r\nWith the asterisk in order to spring search files &#39;spring-config.xml&#39; anywhere in the classpath.\r\n\r\nAnother reference:\r\nhttps://stackoverflow.com/questions/5092133/divide-spring-configuration-across-multiple-projects\r\n\r\nhttps://stackoverflow.com/questions/3294423/spring-classpath-prefix-difference","title":"How to import spring-config.xml of one project into spring-config.xml of another project?","body":"<p>A small variation of Sean's answer:</p>\n\n<pre><code>&lt;import resource=\"classpath*:spring-config.xml\" /&gt;\n</code></pre>\n\n<p>With the asterisk in order to spring search files 'spring-config.xml' anywhere in the classpath.</p>\n\n<p>Another reference:\n<a href=\"https://stackoverflow.com/questions/5092133/divide-spring-configuration-across-multiple-projects\">Divide Spring configuration across multiple projects</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/3294423/spring-classpath-prefix-difference\">Spring classpath prefix difference</a></p>\n"},{"tags":[],"owner":{"account_id":2230437,"reputation":101,"user_id":1968168,"display_name":"yogesh"},"comment_count":0,"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1366086405,"creation_date":1366086405,"answer_id":16028800,"question_id":5113579,"body_markdown":"For some reason, import as suggested by Ricardo didnt work for me. I got it working with following statement:\r\n\r\n`&lt;import resource=&quot;classpath*:/spring-config.xml&quot; /&gt;`\r\n\r\n","title":"How to import spring-config.xml of one project into spring-config.xml of another project?","body":"<p>For some reason, import as suggested by Ricardo didnt work for me. I got it working with following statement:</p>\n\n<p><code>&lt;import resource=\"classpath*:/spring-config.xml\" /&gt;</code></p>\n"},{"tags":[],"owner":{"account_id":3388946,"reputation":91,"user_id":2844287,"display_name":"ajeetkg"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1384278022,"creation_date":1384278022,"answer_id":19936168,"question_id":5113579,"body_markdown":"You have to add the jar/war of the module B in the module A and add the classpath in your new spring-module file. Just add this line \r\n\r\nspring-moduleA.xml  - is a file in module A under the resource folder. By adding this line, it imports all the bean definition from module A to module B. \r\n\r\nMODULE B/ spring-moduleB.xml\r\n___________\r\n\r\n    import resource=&quot;classpath:spring-moduleA.xml&quot;/&gt;\r\n\t\r\n    &lt;bean id=&quot;helloBeanB&quot; class=&quot;basic.HelloWorldB&quot;&gt;\r\n      &lt;property name=&quot;name&quot; value=&quot;BMVNPrj&quot; /&gt;\r\n    &lt;/bean&gt;","title":"How to import spring-config.xml of one project into spring-config.xml of another project?","body":"<p>You have to add the jar/war of the module B in the module A and add the classpath in your new spring-module file. Just add this line </p>\n\n<p>spring-moduleA.xml  - is a file in module A under the resource folder. By adding this line, it imports all the bean definition from module A to module B. </p>\n\n<p>MODULE B/ spring-moduleB.xml</p>\n\n<hr>\n\n<pre><code>import resource=\"classpath:spring-moduleA.xml\"/&gt;\n\n&lt;bean id=\"helloBeanB\" class=\"basic.HelloWorldB\"&gt;\n  &lt;property name=\"name\" value=\"BMVNPrj\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1573333,"reputation":15365,"user_id":1460509,"accept_rate":92,"display_name":"Devrim"},"comment_count":0,"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1505292428,"creation_date":1505292428,"answer_id":46192938,"question_id":5113579,"body_markdown":"Here is the annotation based example:\r\n\r\n    @SpringBootApplication\r\n    @ImportResource({&quot;classpath*:spring-config.xml&quot;})\r\n    public class MainApplication {\r\n    \r\n        public static void main(String[] args) {\r\n            SpringApplication.run(MainApplication.class, args);\r\n        }\r\n    }","title":"How to import spring-config.xml of one project into spring-config.xml of another project?","body":"<p>Here is the annotation based example:</p>\n\n<pre><code>@SpringBootApplication\n@ImportResource({\"classpath*:spring-config.xml\"})\npublic class MainApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(MainApplication.class, args);\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":13211871,"reputation":41,"user_id":9541813,"display_name":"JitenS"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1521949270,"creation_date":1521943188,"answer_id":49471810,"question_id":5113579,"body_markdown":"    &lt;import resource=&quot;classpath*:spring-config.xml&quot; /&gt; \r\nThis is the most suitable one for class path configuration.\r\nParticularly when you are searching for the .xml files in a different project which is in your class path.","title":"How to import spring-config.xml of one project into spring-config.xml of another project?","body":"<pre><code>&lt;import resource=\"classpath*:spring-config.xml\" /&gt; \n</code></pre>\n\n<p>This is the most suitable one for class path configuration.\nParticularly when you are searching for the .xml files in a different project which is in your class path.</p>\n"}],"owner":{"account_id":249783,"reputation":3042,"user_id":526073,"accept_rate":82,"display_name":"Chitresh"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":196962,"favorite_count":0,"down_vote_count":0,"up_vote_count":78,"accepted_answer_id":5115384,"answer_count":6,"score":78,"last_activity_date":1672905417,"creation_date":1298607769,"question_id":5113579,"body_markdown":"I have two projects with the name `simple-core-impl` and `simple-core-web`. Both projects are `spring based` and both have a parent project name `simple-core`. I have `simple-impl-config.xml` in `simple-core-impl` project and `simple-web-config.xml` in `simple-impl-config.xml`. \r\n\r\nI have a bean which has class: `simple service` which have one method which returns me a message &quot;hello World&quot;. I want to import the `simple-impl-config.xml` in the `simple-web-config.xml` so the bean is available into my controller which is in `simple-core-web` project. \r\n\r\n`simple-core-web` project has a jar of `simple-core-impl` project. \r\n\r\n\r\nSo please tell me how I can I import `spring-config.xml` of one project into `spring-config.xml` of another project so all the beans of first is available into other project by just importing? I do not want to rewrite all the beans.","title":"How to import spring-config.xml of one project into spring-config.xml of another project?","body":"<p>I have two projects with the name <code>simple-core-impl</code> and <code>simple-core-web</code>. Both projects are <code>spring based</code> and both have a parent project name <code>simple-core</code>. I have <code>simple-impl-config.xml</code> in <code>simple-core-impl</code> project and <code>simple-web-config.xml</code> in <code>simple-impl-config.xml</code>.</p>\n<p>I have a bean which has class: <code>simple service</code> which have one method which returns me a message &quot;hello World&quot;. I want to import the <code>simple-impl-config.xml</code> in the <code>simple-web-config.xml</code> so the bean is available into my controller which is in <code>simple-core-web</code> project.</p>\n<p><code>simple-core-web</code> project has a jar of <code>simple-core-impl</code> project.</p>\n<p>So please tell me how I can I import <code>spring-config.xml</code> of one project into <code>spring-config.xml</code> of another project so all the beans of first is available into other project by just importing? I do not want to rewrite all the beans.</p>\n"},{"tags":["java","spring","spring-mvc","spring2.x","spring-2.5"],"owner":{"account_id":4597208,"reputation":48209,"user_id":3728901,"accept_rate":58,"display_name":"Vy Do"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":19,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672905195,"creation_date":1672905195,"question_id":75015297,"body_markdown":"I need maintain old system with JDK/Java 1.6 , Apache Tomcat 6.0.x, Spring 2.5.6 . I am reading tutorial https://mkyong.com/spring-mvc/spring-mvc-jquery-autocomplete-example/ \r\n\r\n```xml\r\n&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;\r\n\txmlns:context=&quot;http://www.springframework.org/schema/context&quot;\r\n\txmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;\r\n\txsi:schemaLocation=&quot;\r\n        http://www.springframework.org/schema/beans     \r\n        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\r\n        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd\r\n        http://www.springframework.org/schema/context \r\n        http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;&gt;\r\n\r\n\t&lt;context:component-scan base-package=&quot;com.mkyong&quot; /&gt;\r\n\t&lt;bean\r\n\t\tclass=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;\r\n\t\t&lt;property name=&quot;prefix&quot;&gt;\r\n\t\t\t&lt;value&gt;/WEB-INF/pages/&lt;/value&gt;\r\n\t\t&lt;/property&gt;\r\n\t\t&lt;property name=&quot;suffix&quot;&gt;\r\n\t\t\t&lt;value&gt;.jsp&lt;/value&gt;\r\n\t\t&lt;/property&gt;\r\n\t&lt;/bean&gt;\t\r\n\t&lt;mvc:resources mapping=&quot;/resources/**&quot; location=&quot;/resources/&quot; /&gt;\r\n\t&lt;mvc:annotation-driven /&gt;\r\n&lt;/beans&gt;\r\n```\r\nI focus at (this line of code for Spring 3.0, full source code https://1drv.ms/u/s!AhMAe-fS33VbhYw_5QZm9dwpwUTQnQ?e=sYcvYG )\r\n\r\n```xml\r\n&lt;mvc:resources mapping=&quot;/resources/**&quot; location=&quot;/resources/&quot; /&gt;\r\n```\r\nand looking configuration for same purpose for Spring 2.5.6 .\r\n\r\n[![enter image description here][1]][1]\r\n\r\nI see at here http://www.springframework.org/schema/mvc/ , but not see what for Spring 2.5 . \r\nIn Spring 2.5, how to config like tag `&lt;mvc:resources&gt;` in Spring MVC 3.0?\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/dBSWe.png","title":"In Spring 2.5, how to config like tag &lt;mvc:resources&gt; in Spring MVC 3.0?","body":"<p>I need maintain old system with JDK/Java 1.6 , Apache Tomcat 6.0.x, Spring 2.5.6 . I am reading tutorial <a href=\"https://mkyong.com/spring-mvc/spring-mvc-jquery-autocomplete-example/\" rel=\"nofollow noreferrer\">https://mkyong.com/spring-mvc/spring-mvc-jquery-autocomplete-example/</a></p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;\n    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;\n    xsi:schemaLocation=&quot;\n        http://www.springframework.org/schema/beans     \n        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd\n        http://www.springframework.org/schema/context \n        http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;&gt;\n\n    &lt;context:component-scan base-package=&quot;com.mkyong&quot; /&gt;\n    &lt;bean\n        class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;\n        &lt;property name=&quot;prefix&quot;&gt;\n            &lt;value&gt;/WEB-INF/pages/&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property name=&quot;suffix&quot;&gt;\n            &lt;value&gt;.jsp&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt; \n    &lt;mvc:resources mapping=&quot;/resources/**&quot; location=&quot;/resources/&quot; /&gt;\n    &lt;mvc:annotation-driven /&gt;\n&lt;/beans&gt;\n</code></pre>\n<p>I focus at (this line of code for Spring 3.0, full source code <a href=\"https://1drv.ms/u/s!AhMAe-fS33VbhYw_5QZm9dwpwUTQnQ?e=sYcvYG\" rel=\"nofollow noreferrer\">https://1drv.ms/u/s!AhMAe-fS33VbhYw_5QZm9dwpwUTQnQ?e=sYcvYG</a> )</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;mvc:resources mapping=&quot;/resources/**&quot; location=&quot;/resources/&quot; /&gt;\n</code></pre>\n<p>and looking configuration for same purpose for Spring 2.5.6 .</p>\n<p><a href=\"https://i.stack.imgur.com/dBSWe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dBSWe.png\" alt=\"enter image description here\" /></a></p>\n<p>I see at here <a href=\"http://www.springframework.org/schema/mvc/\" rel=\"nofollow noreferrer\">http://www.springframework.org/schema/mvc/</a> , but not see what for Spring 2.5 .\nIn Spring 2.5, how to config like tag <code>&lt;mvc:resources&gt;</code> in Spring MVC 3.0?</p>\n"},{"tags":["java","ssl"],"comments":[{"owner":{"account_id":2843847,"reputation":55833,"user_id":2442804,"accept_rate":80,"display_name":"luk2302"},"score":0,"creation_date":1672838914,"post_id":75006116,"comment_id":132362617,"body_markdown":"You basically need to use the correct keystore based on the `Host` header. If someone requests site1.com you need to use site1.keystore and site2.keystore for site2.com. How are you currently communicating with your server? What domains are the SSL certificates for?","body":"You basically need to use the correct keystore based on the <code>Host</code> header. If someone requests site1.com you need to use site1.keystore and site2.keystore for site2.com. How are you currently communicating with your server? What domains are the SSL certificates for?"},{"owner":{"account_id":4509101,"reputation":101,"user_id":3665736,"display_name":"user3665736"},"score":0,"creation_date":1672839237,"post_id":75006116,"comment_id":132362749,"body_markdown":"I can only read the host header AFTER connection has occurred.","body":"I can only read the host header AFTER connection has occurred."},{"owner":{"account_id":2843847,"reputation":55833,"user_id":2442804,"accept_rate":80,"display_name":"luk2302"},"score":1,"creation_date":1672839369,"post_id":75006116,"comment_id":132362806,"body_markdown":"Ah, absolutely correct, my bad. Then https://en.wikipedia.org/wiki/Server_Name_Indication is what you need. (or different ports or different IPs)","body":"Ah, absolutely correct, my bad. Then <a href=\"https://en.wikipedia.org/wiki/Server_Name_Indication\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Server_Name_Indication</a> is what you need. (or different ports or different IPs)"}],"answers":[{"tags":[],"owner":{"account_id":4509101,"reputation":101,"user_id":3665736,"display_name":"user3665736"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1672905026,"creation_date":1672905026,"answer_id":75015273,"question_id":75006116,"body_markdown":"After digging the &quot;Server Name Indication&quot; (thanks luk2302) I have found 2 possible solutions to my problem.\r\nThe easiest one is to have a single certificate for my 2 sites; this can be achieved with:\r\n\r\n    sudo certbot certonly --force-renewal --standalone -d site1.com -d site2.com ...\r\n\r\nAnd then build my keystore as usual.\r\n\r\nIf I still want to have a single certificate per site, the solution is more complex: accept any socket connection, read and analyse the TLS header , grab the server name destination and then we know which is the needed certificate.\r\n\r\nThere is a good technote on the subject: \r\nhttps://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#SNIExamples","title":"How can I have a single server accepting secure traffic for 2 differents web sites","body":"<p>After digging the &quot;Server Name Indication&quot; (thanks luk2302) I have found 2 possible solutions to my problem.\nThe easiest one is to have a single certificate for my 2 sites; this can be achieved with:</p>\n<pre><code>sudo certbot certonly --force-renewal --standalone -d site1.com -d site2.com ...\n</code></pre>\n<p>And then build my keystore as usual.</p>\n<p>If I still want to have a single certificate per site, the solution is more complex: accept any socket connection, read and analyse the TLS header , grab the server name destination and then we know which is the needed certificate.</p>\n<p>There is a good technote on the subject:\n<a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#SNIExamples\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#SNIExamples</a></p>\n"}],"owner":{"account_id":4509101,"reputation":101,"user_id":3665736,"display_name":"user3665736"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":36,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":1,"score":3,"last_activity_date":1672905026,"creation_date":1672838612,"question_id":75006116,"body_markdown":"Using &quot;let&#39;s encrypt&quot;, I have created certificates for my 2 web sites.\r\nI have used certbot / openssl / keytool to finally end up with: site1.keystore and site2.keystore\r\n\r\nHere is my simplified java code:\r\n\r\n\r\n    public class TestServer\r\n    {\r\n      public static void main(String[] args) throws Exception\r\n      {\r\n        int port = 1443;\r\n        char[] passphrase = &quot;changeit&quot;.toCharArray();\r\n        \r\n        KeyStore ks = KeyStore.getInstance(KeyStore.getDefaultType());\r\n        ks.load(new FileInputStream (&quot;/path/to/site1.keystore&quot;), passphrase);\r\n    \r\n        KeyManagerFactory kmf = KeyManagerFactory.getInstance(&quot;SunX509&quot;);\r\n        kmf.init(ks, passphrase);\r\n    \r\n        SSLContext ctx = SSLContext.getInstance(&quot;TLS&quot;);\r\n        ctx.init(kmf.getKeyManagers(), null, null);\r\n    \r\n        SSLServerSocketFactory ssf = null;\r\n        ssf = ctx.getServerSocketFactory();\r\n    \r\n        ServerSocket ss = ssf.createServerSocket(port);\r\n        while (true)\r\n        {\r\n          Socket socket = ss.accept();\r\n          OutputStream out = socket.getOutputStream();\r\n          String response = &quot;Hello from secure server&quot;;\r\n          out.write((&quot;HTTP/1.1 200 OK\\r\\nContent-Type: text/html\\r\\nContent-Length: &quot; + response.length() + &quot;\\r\\n\\r\\n&quot; + response).getBytes());\r\n          out.flush();\r\n          socket.close();\r\n        }\r\n      }\r\n    }\r\n\r\nIf I use site1.keystore , I can connect to site1\r\nIf I use site2.keystore , I can connect to site2\r\nSo far so good...\r\n\r\nTo be able to connect to both sites, I have merged both keystore in a single all.keystore\r\n\r\nUnfortunately it does not work as expected ... maybe somebody has an idea of what is missing?\r\n","title":"How can I have a single server accepting secure traffic for 2 differents web sites","body":"<p>Using &quot;let's encrypt&quot;, I have created certificates for my 2 web sites.\nI have used certbot / openssl / keytool to finally end up with: site1.keystore and site2.keystore</p>\n<p>Here is my simplified java code:</p>\n<pre><code>public class TestServer\n{\n  public static void main(String[] args) throws Exception\n  {\n    int port = 1443;\n    char[] passphrase = &quot;changeit&quot;.toCharArray();\n    \n    KeyStore ks = KeyStore.getInstance(KeyStore.getDefaultType());\n    ks.load(new FileInputStream (&quot;/path/to/site1.keystore&quot;), passphrase);\n\n    KeyManagerFactory kmf = KeyManagerFactory.getInstance(&quot;SunX509&quot;);\n    kmf.init(ks, passphrase);\n\n    SSLContext ctx = SSLContext.getInstance(&quot;TLS&quot;);\n    ctx.init(kmf.getKeyManagers(), null, null);\n\n    SSLServerSocketFactory ssf = null;\n    ssf = ctx.getServerSocketFactory();\n\n    ServerSocket ss = ssf.createServerSocket(port);\n    while (true)\n    {\n      Socket socket = ss.accept();\n      OutputStream out = socket.getOutputStream();\n      String response = &quot;Hello from secure server&quot;;\n      out.write((&quot;HTTP/1.1 200 OK\\r\\nContent-Type: text/html\\r\\nContent-Length: &quot; + response.length() + &quot;\\r\\n\\r\\n&quot; + response).getBytes());\n      out.flush();\n      socket.close();\n    }\n  }\n}\n</code></pre>\n<p>If I use site1.keystore , I can connect to site1\nIf I use site2.keystore , I can connect to site2\nSo far so good...</p>\n<p>To be able to connect to both sites, I have merged both keystore in a single all.keystore</p>\n<p>Unfortunately it does not work as expected ... maybe somebody has an idea of what is missing?</p>\n"},{"tags":["java","android","gradle"],"comments":[{"owner":{"account_id":2671330,"reputation":183386,"user_id":2308683,"accept_rate":90,"display_name":"OneCricketeer"},"score":0,"creation_date":1648821398,"post_id":71694705,"comment_id":126728480,"body_markdown":"You&#39;re editing the wrong Gradle file","body":"You&#39;re editing the wrong Gradle file"}],"answers":[{"tags":[],"owner":{"account_id":7974949,"reputation":127,"user_id":6018433,"display_name":"Sikandar Khan"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672904347,"creation_date":1672904347,"answer_id":75015175,"question_id":71694705,"body_markdown":"You should move the `plugins{}` block to top of your file and outside of your `buildscript{}` block \r\n\r\n\r\n    buildscript {\r\n        repositories {\r\n            google()\r\n        }\r\n    }\r\n    plugins {\r\n            id &#39;com.android.application&#39; version &#39;7.1.2&#39; apply false\r\n            id &#39;com.android.library&#39; version &#39;7.1.2&#39; apply false\r\n    }","title":"While adding Firebase SDK to Android Studio error : Could not find method plugins() for arguments","body":"<p>You should move the <code>plugins{}</code> block to top of your file and outside of your <code>buildscript{}</code> block</p>\n<pre><code>buildscript {\n    repositories {\n        google()\n    }\n}\nplugins {\n        id 'com.android.application' version '7.1.2' apply false\n        id 'com.android.library' version '7.1.2' apply false\n}\n</code></pre>\n"}],"owner":{"account_id":24760205,"reputation":1,"user_id":18644701,"display_name":"Ravi Sachdeva"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1884,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672904347,"creation_date":1648738288,"question_id":71694705,"body_markdown":"I am trying to add Firebase SDK to Android project. \r\n\r\n```groovy\r\nbuildscript {\r\n    repositories {\r\n        google()\r\n    }\r\n\r\n    plugins {\r\n        id &#39;com.android.application&#39; version &#39;7.1.2&#39; apply false\r\n        id &#39;com.android.library&#39; version &#39;7.1.2&#39; apply false\r\n    }\r\n\r\n    dependencies {\r\n        classpath &#39;com.google.gms:google-services:4.3.10&#39;\r\n    }\r\n}\r\n\r\nallprojects {\r\n    repositories {\r\n        google()  // Google&#39;s Maven repository\r\n    }\r\n}\r\n\r\ntask clean(type: Delete) {\r\n    delete rootProject.buildDir\r\n}\r\n```\r\n\r\nerror message: \r\n```\r\n&gt; Build file &#39;C:\\\\Users\\\\Admin1\\\\AndroidStudioProjects\\\\MyApplication\\\\build.gradle&#39; line: 7\r\n&gt; A problem occurred evaluating root project &#39;My Application&#39;.\r\n&gt; Could not find method plugins() for arguments \\[build_arjjpsftc7rcjw6ntcnbana8l$\\_run_closure1$\\_closure3@22dd2f7f\\] on object of type org.gradle.api.internal.initialization.DefaultScriptHandler.\r\n```","title":"While adding Firebase SDK to Android Studio error : Could not find method plugins() for arguments","body":"<p>I am trying to add Firebase SDK to Android project.</p>\n<pre><code>buildscript {\n    repositories {\n        google()\n    }\n\n    plugins {\n        id 'com.android.application' version '7.1.2' apply false\n        id 'com.android.library' version '7.1.2' apply false\n    }\n\n    dependencies {\n        classpath 'com.google.gms:google-services:4.3.10'\n    }\n}\n\nallprojects {\n    repositories {\n        google()  // Google's Maven repository\n    }\n}\n\ntask clean(type: Delete) {\n    delete rootProject.buildDir\n}\n</code></pre>\n<p>error message:</p>\n<pre><code>&gt; Build file 'C:\\\\Users\\\\Admin1\\\\AndroidStudioProjects\\\\MyApplication\\\\build.gradle' line: 7\n&gt; A problem occurred evaluating root project 'My Application'.\n&gt; Could not find method plugins() for arguments \\[build_arjjpsftc7rcjw6ntcnbana8l$\\_run_closure1$\\_closure3@22dd2f7f\\] on object of type org.gradle.api.internal.initialization.DefaultScriptHandler.\n</code></pre>\n"},{"tags":["java","maven","java-11","java-17"],"answers":[{"comments":[{"owner":{"account_id":25464687,"reputation":1,"user_id":19263923,"display_name":"Ankeet"},"score":0,"creation_date":1672904037,"post_id":75015119,"comment_id":132379000,"body_markdown":"Will this pick Jdk 17.0.5? Trying to understand how it works internally","body":"Will this pick Jdk 17.0.5? Trying to understand how it works internally"},{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":1,"creation_date":1672904079,"post_id":75015119,"comment_id":132379006,"body_markdown":"It doesn&#39;t pickup any version. It uses the jdk which is configured by maven. normally the version is specified in the PATH variable. This configuration only told maven for which java version the code should be compiled. You can also use a JDK 17 and specify `java.version` to 11","body":"It doesn&#39;t pickup any version. It uses the jdk which is configured by maven. normally the version is specified in the PATH variable. This configuration only told maven for which java version the code should be compiled. You can also use a JDK 17 and specify <code>java.version</code> to 11"},{"owner":{"account_id":25464687,"reputation":1,"user_id":19263923,"display_name":"Ankeet"},"score":0,"creation_date":1672904157,"post_id":75015119,"comment_id":132379026,"body_markdown":"when i ran mvn version it prints Java Version 17.0.5. that means 17.0.5 will be picked?","body":"when i ran mvn version it prints Java Version 17.0.5. that means 17.0.5 will be picked?"},{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1672904210,"post_id":75015119,"comment_id":132379038,"body_markdown":"Yes but it has nothing to do with the `java.version` tag","body":"Yes but it has nothing to do with the <code>java.version</code> tag"},{"owner":{"account_id":25464687,"reputation":1,"user_id":19263923,"display_name":"Ankeet"},"score":0,"creation_date":1672904395,"post_id":75015119,"comment_id":132379091,"body_markdown":"my is a spring boot application, should I set java.version to 17.0.5..I am a little confused on difference between the maven complier complier and java.version and which to use when. Setting java.version to 17.0.5 and maven source and target to 17 as below, builds project successfully  &lt;properties&gt;\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;  \n      &lt;java.version&gt;17.0.5&lt;java.version&gt;                                            \n&lt;/properties&gt;","body":"my is a spring boot application, should I set java.version to 17.0.5..I am a little confused on difference between the maven complier complier and java.version and which to use when. Setting java.version to 17.0.5 and maven source and target to 17 as below, builds project successfully  &lt;properties&gt;         &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;         &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;         &lt;java.version&gt;17.0.5&lt;java.version&gt;                                             &lt;/properties&gt;"},{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1672904602,"post_id":75015119,"comment_id":132379139,"body_markdown":"as I know `java.version` is a shortcut for `maven.compiler.source` and `maven.compiler.target`.`&lt;java.version&gt;17.0.5&lt;/java.version&gt;` is just invalid","body":"as I know <code>java.version</code> is a shortcut for <code>maven.compiler.source</code> and <code>maven.compiler.target</code>.<code>&lt;java.version&gt;17.0.5&lt;&#47;java.version&gt;</code> is just invalid"},{"owner":{"account_id":25464687,"reputation":1,"user_id":19263923,"display_name":"Ankeet"},"score":0,"creation_date":1672905016,"post_id":75015119,"comment_id":132379244,"body_markdown":"if I just used java.version and set it &lt;java.version&gt;17&lt;java.version&gt; , will this use 17.0.5 or exact 17? I want the app to use 17.0.5","body":"if I just used java.version and set it &lt;java.version&gt;17&lt;java.version&gt; , will this use 17.0.5 or exact 17? I want the app to use 17.0.5"},{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":1,"creation_date":1672905090,"post_id":75015119,"comment_id":132379270,"body_markdown":"It will use the JVM which is in your $PATH variable. Also if you set any other valid value","body":"It will use the JVM which is in your $PATH variable. Also if you set any other valid value"}],"tags":[],"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"comment_count":8,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1672904296,"creation_date":1672903936,"answer_id":75015119,"question_id":75015089,"body_markdown":"The version is only the major version. So you have to specify only 17 as version\r\n\r\n    &lt;properties&gt;\r\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\r\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;  \r\n        &lt;java.version&gt;17&lt;java.version&gt;                                            \r\n    &lt;/properties&gt;    \r\n\r\n","title":"Building maven project fails on invalid target version 17.0.5","body":"<p>The version is only the major version. So you have to specify only 17 as version</p>\n<pre><code>&lt;properties&gt;\n    &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n    &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;  \n    &lt;java.version&gt;17&lt;java.version&gt;                                            \n&lt;/properties&gt;    \n</code></pre>\n"}],"owner":{"account_id":25464687,"reputation":1,"user_id":19263923,"display_name":"Ankeet"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":207,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672904296,"creation_date":1672903732,"question_id":75015089,"body_markdown":"I am upgrading application from Java 11 to Java 17.0.5\r\n\r\nIn my java project, I have set below properties\r\n\r\n    &lt;properties&gt;\r\n            &lt;maven.compiler.source&gt;17.0.5&lt;/maven.compiler.source&gt;\r\n            &lt;maven.compiler.target&gt;17.0.5&lt;/maven.compiler.target&gt;  \r\n          &lt;java.version&gt;17.0.5&lt;java.version&gt;                                            \r\n    &lt;/properties&gt;   \r\n    \r\n                                                                                                             \r\nOn building the project, it failed saying \r\n\r\n&gt; invalid target release 17.0.5\r\n\r\n`java -version` prints \r\n\r\n&gt; &quot;Java version 17.0.5&quot;\r\n\r\nand `mvn -version` prints \r\n\r\n&gt; Java 17.0.5\r\n\r\nPlease advise\r\n\r\n                                                                                  ","title":"Building maven project fails on invalid target version 17.0.5","body":"<p>I am upgrading application from Java 11 to Java 17.0.5</p>\n<p>In my java project, I have set below properties</p>\n<pre><code>&lt;properties&gt;\n        &lt;maven.compiler.source&gt;17.0.5&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;17.0.5&lt;/maven.compiler.target&gt;  \n      &lt;java.version&gt;17.0.5&lt;java.version&gt;                                            \n&lt;/properties&gt;   \n\n                                                                                                         \n</code></pre>\n<p>On building the project, it failed saying</p>\n<blockquote>\n<p>invalid target release 17.0.5</p>\n</blockquote>\n<p><code>java -version</code> prints</p>\n<blockquote>\n<p>&quot;Java version 17.0.5&quot;</p>\n</blockquote>\n<p>and <code>mvn -version</code> prints</p>\n<blockquote>\n<p>Java 17.0.5</p>\n</blockquote>\n<p>Please advise</p>\n"},{"tags":["java","spring","spring-boot","spring-aop"],"comments":[{"owner":{"account_id":1087271,"reputation":64101,"user_id":1082681,"accept_rate":90,"display_name":"kriegaex"},"score":0,"creation_date":1672902326,"post_id":75013506,"comment_id":132378591,"body_markdown":"Please learn [how to ask a question on SO](https://stackoverflow.com/help/how-to-ask) and provide a [minimal, complete, and verifiable example](https://stackoverflow.com/help/mcve). Thank you.","body":"Please learn <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask a question on SO</a> and provide a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a>. Thank you."}],"answers":[{"tags":[],"owner":{"account_id":1087271,"reputation":64101,"user_id":1082681,"accept_rate":90,"display_name":"kriegaex"},"comment_count":0,"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1672903443,"creation_date":1672903443,"answer_id":75015039,"question_id":75013506,"body_markdown":"Your question is interesting, but hardly a good fit for Stack Overflow. This is a place to ask about your own programming problems, not one to inquire and speculate about the motives of third-party developers&#39; design decisions.\r\n\r\nHaving said that, I am still in the holiday season spirit for now, trying to throw in a few thoughts:\r\n  * A weak hash map is useful when creating a cache in which, if no (strong) reference to the key exists anymore, the map entry (key and value) can be removed. I.e., a garbage collection can reclaim the memory for both the key and and the (often big and expensive) value. See [this tutorial](https://www.baeldung.com/java-weakhashmap) for a comprehensive explanation with examples.\r\n  * You want to synchronise on objects or data structures which are not inherently thread-safe. In this case, it looks as if the developer wants to avoid the same class from being validated concurrently, before adding it to the cache.\r\n\r\nPlease avoid asking lots of follow-up questions, because SO is not a discussion forum. Maybe you better approach the Spring AOP team with such questions.\r\n\r\nBTW, here is a [perma-link to the section of code in question][1], and here is one to the [Git blame/annotate version][2], in which you can see that the `synchronized` section is 14 years old. The same is true for the weak hash map usage, if you follow  the merely structural changes in the code back to the original implementation.\r\n\r\n  [1]: https://github.com/spring-projects/spring-framework/blob/b71db12c43a1a09fa2fb49bf88ce8f00e017511b/spring-aop/src/main/java/org/springframework/aop/framework/CglibAopProxy.java#L251-L261\r\n  [2]: https://github.com/spring-projects/spring-framework/blame/b71db12c43a1a09fa2fb49bf88ce8f00e017511b/spring-aop/src/main/java/org/springframework/aop/framework/CglibAopProxy.java#L251","title":"Why CglibAopProxy use WeakHashMap as a synchronized lock?","body":"<p>Your question is interesting, but hardly a good fit for Stack Overflow. This is a place to ask about your own programming problems, not one to inquire and speculate about the motives of third-party developers' design decisions.</p>\n<p>Having said that, I am still in the holiday season spirit for now, trying to throw in a few thoughts:</p>\n<ul>\n<li>A weak hash map is useful when creating a cache in which, if no (strong) reference to the key exists anymore, the map entry (key and value) can be removed. I.e., a garbage collection can reclaim the memory for both the key and and the (often big and expensive) value. See <a href=\"https://www.baeldung.com/java-weakhashmap\" rel=\"nofollow noreferrer\">this tutorial</a> for a comprehensive explanation with examples.</li>\n<li>You want to synchronise on objects or data structures which are not inherently thread-safe. In this case, it looks as if the developer wants to avoid the same class from being validated concurrently, before adding it to the cache.</li>\n</ul>\n<p>Please avoid asking lots of follow-up questions, because SO is not a discussion forum. Maybe you better approach the Spring AOP team with such questions.</p>\n<p>BTW, here is a <a href=\"https://github.com/spring-projects/spring-framework/blob/b71db12c43a1a09fa2fb49bf88ce8f00e017511b/spring-aop/src/main/java/org/springframework/aop/framework/CglibAopProxy.java#L251-L261\" rel=\"nofollow noreferrer\">perma-link to the section of code in question</a>, and here is one to the <a href=\"https://github.com/spring-projects/spring-framework/blame/b71db12c43a1a09fa2fb49bf88ce8f00e017511b/spring-aop/src/main/java/org/springframework/aop/framework/CglibAopProxy.java#L251\" rel=\"nofollow noreferrer\">Git blame/annotate version</a>, in which you can see that the <code>synchronized</code> section is 14 years old. The same is true for the weak hash map usage, if you follow  the merely structural changes in the code back to the original implementation.</p>\n"}],"owner":{"account_id":20937647,"reputation":1,"user_id":15382495,"display_name":"Kusch"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":46,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1672903831,"creation_date":1672888533,"question_id":75013506,"body_markdown":"`spring-aop 6.0.2`\r\n\r\nI&#39;m confused by the following CglibAopProxy class code:\r\n\r\n```java\r\nprivate static final Map&lt;Class&lt;?&gt;, Boolean&gt; validatedClasses = new WeakHashMap&lt;&gt;();\r\n\r\n// ...\r\n\r\nprivate void validateClassIfNecessary(Class&lt;?&gt; proxySuperClass, @Nullable ClassLoader proxyClassLoader) {\r\n    if (!this.advised.isOptimize() &amp;&amp; logger.isInfoEnabled()) {\r\n\r\n        // Why is &#39;validatedClasses&#39; a WeakHashMap?\r\n\r\n        synchronized (validatedClasses) {\r\n            if (!validatedClasses.containsKey(proxySuperClass)) {\r\n                doValidateClass(proxySuperClass, proxyClassLoader,\r\n                        ClassUtils.getAllInterfacesForClassAsSet(proxySuperClass));\r\n                validatedClasses.put(proxySuperClass, Boolean.TRUE);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// ...\r\n```\r\n\r\nI tried searching the Internet for related articles, but nothing solved my confusion.","title":"Why CglibAopProxy use WeakHashMap as a synchronized lock?","body":"<p><code>spring-aop 6.0.2</code></p>\n<p>I'm confused by the following CglibAopProxy class code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private static final Map&lt;Class&lt;?&gt;, Boolean&gt; validatedClasses = new WeakHashMap&lt;&gt;();\n\n// ...\n\nprivate void validateClassIfNecessary(Class&lt;?&gt; proxySuperClass, @Nullable ClassLoader proxyClassLoader) {\n    if (!this.advised.isOptimize() &amp;&amp; logger.isInfoEnabled()) {\n\n        // Why is 'validatedClasses' a WeakHashMap?\n\n        synchronized (validatedClasses) {\n            if (!validatedClasses.containsKey(proxySuperClass)) {\n                doValidateClass(proxySuperClass, proxyClassLoader,\n                        ClassUtils.getAllInterfacesForClassAsSet(proxySuperClass));\n                validatedClasses.put(proxySuperClass, Boolean.TRUE);\n            }\n        }\n    }\n}\n\n// ...\n</code></pre>\n<p>I tried searching the Internet for related articles, but nothing solved my confusion.</p>\n"},{"tags":["java","excel","quote"],"answers":[{"tags":[],"owner":{"account_id":9573972,"reputation":1131,"user_id":7110786,"display_name":"Saif Ahmad"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1672903801,"creation_date":1672903801,"answer_id":75015100,"question_id":75014979,"body_markdown":"The better way is to use a prepared statement so that you don&#39;t have to worry about handling special characters.\r\n\r\n        String message = &quot;Let&#39;s hangout somewhere.&quot;;\r\n        String query = &quot;Select * from Messages Where message=?&quot;;\r\n        Fillo fillo = new Fillo();\r\n        Connection connection = fillo.getConnection(&quot;&lt;excel_file_path&gt;&quot;);\r\n        PreparedStatement preparedStatement = connection.prepareStatement(query);\r\n        preparedStatement.setString(1, message);\r\n        ResultSet resultSet = preparedStatement.executeQuery();\r\n\r\nIf for some reason you can&#39;t use `PreparedStatement` then you use double single quotes for escaping it.\r\n\r\n        String message = &quot;Let&#39;&#39;s hangout somewhere.&quot;;\r\n        String query = &quot;Select * from Messages Where message=&#39;&quot; + message + &quot;&#39;&quot;;\r\n        Fillo fillo = new Fillo();\r\n        Connection connection = fillo.getConnection(&quot;&lt;excel_file_path&gt;&quot;);\r\n        ResultSet resultSet = connection.executeQuery(query);\r\n\r\n","title":"Fillo library shows Invalid query, if the query has &#39; single quote in where condition value or while updating any cell","body":"<p>The better way is to use a prepared statement so that you don't have to worry about handling special characters.</p>\n<pre><code>    String message = &quot;Let's hangout somewhere.&quot;;\n    String query = &quot;Select * from Messages Where message=?&quot;;\n    Fillo fillo = new Fillo();\n    Connection connection = fillo.getConnection(&quot;&lt;excel_file_path&gt;&quot;);\n    PreparedStatement preparedStatement = connection.prepareStatement(query);\n    preparedStatement.setString(1, message);\n    ResultSet resultSet = preparedStatement.executeQuery();\n</code></pre>\n<p>If for some reason you can't use <code>PreparedStatement</code> then you use double single quotes for escaping it.</p>\n<pre><code>    String message = &quot;Let''s hangout somewhere.&quot;;\n    String query = &quot;Select * from Messages Where message='&quot; + message + &quot;'&quot;;\n    Fillo fillo = new Fillo();\n    Connection connection = fillo.getConnection(&quot;&lt;excel_file_path&gt;&quot;);\n    ResultSet resultSet = connection.executeQuery(query);\n</code></pre>\n"}],"owner":{"account_id":9882624,"reputation":3,"user_id":8659514,"display_name":"Akshay_Nayak"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":101,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75015100,"answer_count":1,"score":0,"last_activity_date":1672903801,"creation_date":1672903102,"question_id":75014979,"body_markdown":"**Running below query:**\r\n\r\n    String query = &quot;Select * from Messages Where message=&#39;Let&#39;s hangout somewhere.&#39;&quot;;\r\n\r\nAbove query gives error saying, Invalid query.\r\n\r\nPlease let me know if any of you guys have came around this and share some fix or any work arounds.\r\n\r\n\r\nMaven dependency :\r\n       \r\n    &lt;!-- https://mvnrepository.com/artifact/com.codoid.products/fillo --&gt;\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;com.codoid.products&lt;/groupId&gt;\r\n        &lt;artifactId&gt;fillo&lt;/artifactId&gt;\r\n        &lt;version&gt;1.22&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nhttps://codoid.com/products/fillo/\r\n\r\nThanks in advance.\r\n\r\nOn removing the single quote &#39; from &quot;Let&#39;s hangout somewhere.&quot; which makes it: &quot;Lets hangout somewhere.&quot; and this is working completely fine.\r\n\r\nTried escaping the &#39; single quote, but still getting same error.\r\n\r\n","title":"Fillo library shows Invalid query, if the query has &#39; single quote in where condition value or while updating any cell","body":"<p><strong>Running below query:</strong></p>\n<pre><code>String query = &quot;Select * from Messages Where message='Let's hangout somewhere.'&quot;;\n</code></pre>\n<p>Above query gives error saying, Invalid query.</p>\n<p>Please let me know if any of you guys have came around this and share some fix or any work arounds.</p>\n<p>Maven dependency :</p>\n<pre><code>&lt;!-- https://mvnrepository.com/artifact/com.codoid.products/fillo --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.codoid.products&lt;/groupId&gt;\n    &lt;artifactId&gt;fillo&lt;/artifactId&gt;\n    &lt;version&gt;1.22&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p><a href=\"https://codoid.com/products/fillo/\" rel=\"nofollow noreferrer\">https://codoid.com/products/fillo/</a></p>\n<p>Thanks in advance.</p>\n<p>On removing the single quote ' from &quot;Let's hangout somewhere.&quot; which makes it: &quot;Lets hangout somewhere.&quot; and this is working completely fine.</p>\n<p>Tried escaping the ' single quote, but still getting same error.</p>\n"},{"tags":["java","spring-boot","java-17"],"answers":[{"tags":[],"owner":{"account_id":7423601,"reputation":18712,"user_id":5646962,"display_name":"Thomas Kl&#228;ger"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1672903773,"creation_date":1672903773,"answer_id":75015097,"question_id":75014865,"body_markdown":"The option `--XX:DumpLoadedClassList=cds.jsa` does **not** create a CDS archive - it is one step in creating a static CDS Archive File.\r\n\r\nTo create a Dynamic CDS Archive file you must use\r\n\r\n    java -Xlog:cds -XX:ArchiveClassesAtExit=cds.jsa -jar app-0.0.1-SNAPSHOT.jar\r\n\r\nSource: https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html#creating-cds-archives","title":"Dynamic Class Data Sharing not using the archive file","body":"<p>The option <code>--XX:DumpLoadedClassList=cds.jsa</code> does <strong>not</strong> create a CDS archive - it is one step in creating a static CDS Archive File.</p>\n<p>To create a Dynamic CDS Archive file you must use</p>\n<pre><code>java -Xlog:cds -XX:ArchiveClassesAtExit=cds.jsa -jar app-0.0.1-SNAPSHOT.jar\n</code></pre>\n<p>Source: <a href=\"https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html#creating-cds-archives\" rel=\"nofollow noreferrer\">https://docs.oracle.com/en/java/javase/17/docs/specs/man/java.html#creating-cds-archives</a></p>\n"}],"owner":{"account_id":1202593,"reputation":9569,"user_id":1173495,"accept_rate":46,"display_name":"SANN3"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":138,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75015097,"answer_count":1,"score":0,"last_activity_date":1672903773,"creation_date":1672902279,"question_id":75014865,"body_markdown":"We are trying to use Dynamic Class Data Sharing (Dynamic CDS) with our spring boot application.\r\n\r\nCreated the CDS archive using the following command\r\n\r\n    java -Xlog:cds -XX:DumpLoadedClassList=cds.jsa -jar app-0.0.1-SNAPSHOT.jar\r\n\r\nAnd trying to use the archive using the following command\r\n\r\n    java -Xlog:cds -XX:SharedArchiveFile=cds.jsa -jar app-0.0.1-SNAPSHOT.jar\r\n\r\nBut getting the following error in the beginning of the application startup\r\n\r\n    [0.009s][info][cds] trying to map cds.jsa\r\n    [0.009s][info][cds] Opened archive cds.jsa.\r\n    [0.009s][info][cds] _magic expected: 0xf00baba2\r\n    [0.009s][info][cds]          actual: 0x4f4e2023\r\n    [0.009s][info][cds] UseSharedSpaces: The shared archive file has a bad magic number.\r\n    [0.009s][info][cds] UseSharedSpaces: Unable to map shared spaces\r\n\r\n\r\nopenjdk version &quot;17&quot; 2021-09-14 (build 17+35-2724)\r\nSpringboot 2.6.3","title":"Dynamic Class Data Sharing not using the archive file","body":"<p>We are trying to use Dynamic Class Data Sharing (Dynamic CDS) with our spring boot application.</p>\n<p>Created the CDS archive using the following command</p>\n<pre><code>java -Xlog:cds -XX:DumpLoadedClassList=cds.jsa -jar app-0.0.1-SNAPSHOT.jar\n</code></pre>\n<p>And trying to use the archive using the following command</p>\n<pre><code>java -Xlog:cds -XX:SharedArchiveFile=cds.jsa -jar app-0.0.1-SNAPSHOT.jar\n</code></pre>\n<p>But getting the following error in the beginning of the application startup</p>\n<pre><code>[0.009s][info][cds] trying to map cds.jsa\n[0.009s][info][cds] Opened archive cds.jsa.\n[0.009s][info][cds] _magic expected: 0xf00baba2\n[0.009s][info][cds]          actual: 0x4f4e2023\n[0.009s][info][cds] UseSharedSpaces: The shared archive file has a bad magic number.\n[0.009s][info][cds] UseSharedSpaces: Unable to map shared spaces\n</code></pre>\n<p>openjdk version &quot;17&quot; 2021-09-14 (build 17+35-2724)\nSpringboot 2.6.3</p>\n"},{"tags":["java","google-api","google-drive-api"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1672884236,"post_id":75012605,"comment_id":132375776,"body_markdown":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.","body":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking."},{"owner":{"account_id":26135606,"reputation":11,"user_id":19825651,"display_name":"JRC"},"score":0,"creation_date":1672901074,"post_id":75012605,"comment_id":132378303,"body_markdown":"Also google api only allows you to read the file meta-data but does not allow you to access the file content.","body":"Also google api only allows you to read the file meta-data but does not allow you to access the file content."}],"answers":[{"comments":[{"owner":{"account_id":26135606,"reputation":11,"user_id":19825651,"display_name":"JRC"},"score":0,"creation_date":1672968956,"post_id":75015001,"comment_id":132398462,"body_markdown":"Thanks for the answer, do you have a working example? It seems the files().get(fileid) method only retrieve the file meta data, it seems like there is no way you can actually get the file content. I have tried execute(), executeAndDownloadTo() and executeMediaAsInputStream() and none of them worked","body":"Thanks for the answer, do you have a working example? It seems the files().get(fileid) method only retrieve the file meta data, it seems like there is no way you can actually get the file content. I have tried execute(), executeAndDownloadTo() and executeMediaAsInputStream() and none of them worked"}],"tags":[],"owner":{"account_id":2066403,"reputation":109440,"user_id":1841839,"accept_rate":71,"display_name":"Linda Lawton - DaImTo"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672903224,"creation_date":1672903224,"answer_id":75015001,"question_id":75012605,"body_markdown":"The Google drive api is a file storage api for the most part.   If you want to edit the contents of a file for example google docs or google sheets you need to use their respective apis.\r\n\r\nHowever if this is for example a raw text file minetype `text/plain`.  Then it is possible to download the file into `memory` (not save to disk) then modify the text data within it and reupload it.   \r\n\r\nThat is the only thing you can do as the api doesn&#39;t have a patch method for the file data there is only upload and download options.  To modify you would probably need to be able to edit only sections of it.\r\n\r\n\r\n\r\n\r\n\r\n","title":"Directly update file content through Google Drive API (V3)","body":"<p>The Google drive api is a file storage api for the most part.   If you want to edit the contents of a file for example google docs or google sheets you need to use their respective apis.</p>\n<p>However if this is for example a raw text file minetype <code>text/plain</code>.  Then it is possible to download the file into <code>memory</code> (not save to disk) then modify the text data within it and reupload it.</p>\n<p>That is the only thing you can do as the api doesn't have a patch method for the file data there is only upload and download options.  To modify you would probably need to be able to edit only sections of it.</p>\n"}],"owner":{"account_id":26135606,"reputation":11,"user_id":19825651,"display_name":"JRC"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":185,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":1,"score":0,"last_activity_date":1672903283,"creation_date":1672877256,"question_id":75012605,"body_markdown":"this is more like a confirmation of my personal finding rather than asking for solution.\r\nSo I would like to confirm that there is no way you can directly read, write/update the content of your files stored in google drive through the google drive API. \r\n\r\n(Note: I am aware that google docs api exists, but the file types I would like to modify is just simple text file (.txt), config file (.json) and excel (.xlsx, .xlsm))\r\n\r\nIf you would like to do so, the only way is to download the file and save it locally, read/modify the file locally. And to update the file in drive, you then have to, after modifying the file locally, upload the modified file back to google drive and delete the original one.\r\n\r\nCan anyone provide a &quot;yes&quot; or &quot;no&quot; to the above statement. And if &quot;no&quot;, please provide any information (a link or a code snippet) about an example that successfully updates the file in Google drive through provided Google drive API.","title":"Directly update file content through Google Drive API (V3)","body":"<p>this is more like a confirmation of my personal finding rather than asking for solution.\nSo I would like to confirm that there is no way you can directly read, write/update the content of your files stored in google drive through the google drive API.</p>\n<p>(Note: I am aware that google docs api exists, but the file types I would like to modify is just simple text file (.txt), config file (.json) and excel (.xlsx, .xlsm))</p>\n<p>If you would like to do so, the only way is to download the file and save it locally, read/modify the file locally. And to update the file in drive, you then have to, after modifying the file locally, upload the modified file back to google drive and delete the original one.</p>\n<p>Can anyone provide a &quot;yes&quot; or &quot;no&quot; to the above statement. And if &quot;no&quot;, please provide any information (a link or a code snippet) about an example that successfully updates the file in Google drive through provided Google drive API.</p>\n"},{"tags":["java","spring","performance"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":1,"creation_date":1672902306,"post_id":75014264,"comment_id":132378582,"body_markdown":"post construct is called before AOP processing has begun, so trying to intercept this in the startup cycle of the bean won&#39;t work. Use JFR events instead to investigate.","body":"post construct is called before AOP processing has begun, so trying to intercept this in the startup cycle of the bean won&#39;t work. Use JFR events instead to investigate."}],"answers":[{"comments":[{"owner":{"account_id":1551684,"reputation":1024,"user_id":1443928,"accept_rate":93,"display_name":"Hard Worker"},"score":0,"creation_date":1672903330,"post_id":75014993,"comment_id":132378824,"body_markdown":"What if Im using an old Spring application that is not spring boot ?","body":"What if Im using an old Spring application that is not spring boot ?"},{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1672903976,"post_id":75014993,"comment_id":132378981,"body_markdown":"You need to use at least Spring 5.3 and then it depends on how you are bootstrapping the application. If you are creating the `ApplicationContext` yourself, you can set it to the `ApplicationContext` through `setApplicationStartup`. But as you nowhere state which version or what app you are trying to investigate (Nor answer my question in your other question about the same topic).","body":"You need to use at least Spring 5.3 and then it depends on how you are bootstrapping the application. If you are creating the <code>ApplicationContext</code> yourself, you can set it to the <code>ApplicationContext</code> through <code>setApplicationStartup</code>. But as you nowhere state which version or what app you are trying to investigate (Nor answer my question in your other question about the same topic)."}],"tags":[],"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"comment_count":2,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1672903184,"creation_date":1672903184,"answer_id":75014993,"question_id":75014264,"body_markdown":"Don&#39;t do this yourself either use a proper profiler to get the results or start with using the [Java Flight Recorder] for which Spring has support out-of-the-box. \r\n\r\nSpring will record startup metrics as JFR events (see [the documentation][2]) and you can record these to a file and investigate that file with [Java Mission Control][3].\r\n\r\nSpring will record all sorts of events for different parts of the container and bean lifecycle, see [the documentation][4] for a list. \r\n\r\nTo enable you need to register the [`ApplicationStartup`][5] and pass that to the `ApplicationContext` you are using. To record to the flight recorder you will need to create the `FlightRecorderApplicationStartup`. \r\n\r\nAssuming you are using Spring Boot this is trivial to do, you pass it to the `SpringApplication` before running it. \r\n\r\n```java\r\n@SpringBootApplication\r\npublic class MyApplication {\r\n\r\n  public static void main(String[] args) throws Exception {\r\n    var app = new SpringApplication(MyApplication.class);\r\n    app.setApplicationStartup(new FlightRecorderApplicationStartup());\r\n    app.run(args);\r\n  }\r\n}\r\n```\r\n\r\nNow when starting you need to enable the flight recorder and the recordings. \r\n\r\n```shell\r\njava -XX:+FlightRecorder -XX:StartFlightRecording=duration=30s,filename=myrecording.jfr -jar your-app.jar\r\n```\r\n\r\nThis will record events for 30s and after that write a file called `myrecording.jfr`, which you can then open in Java Mission Control and see how long certain parts took for a bean or all beans etc. If you app takes more then 30s to startup increase the `duration` parameter to what you need. \r\n\r\nIf this isn&#39;t enough I would strongly suggest to use a proper profiler instead of trying to work around this with AOP as when adding AOP it will influence the time to start your application and beans (due to additional proxies being created, or you must use load- or compile time weaving). \r\n\r\n[1]: https://docs.oracle.com/javacomponents/jmc-5-4/jfr-runtime-guide/about.htm#JFRUH170\r\n[2]: https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#context-functionality-startup\r\n[3]: https://www.oracle.com/java/technologies/jdk-mission-control.html\r\n[4]: https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#core.appendix.application-startup-steps\r\n[5]: https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/core/metrics/ApplicationStartup.html\r\n[6]: https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/core/metrics/jfr/FlightRecorderApplicationStartup.html","title":"How to Estimate all post contruct time in spring Application","body":"<p>Don't do this yourself either use a proper profiler to get the results or start with using the [Java Flight Recorder] for which Spring has support out-of-the-box.</p>\n<p>Spring will record startup metrics as JFR events (see <a href=\"https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#context-functionality-startup\" rel=\"nofollow noreferrer\">the documentation</a>) and you can record these to a file and investigate that file with <a href=\"https://www.oracle.com/java/technologies/jdk-mission-control.html\" rel=\"nofollow noreferrer\">Java Mission Control</a>.</p>\n<p>Spring will record all sorts of events for different parts of the container and bean lifecycle, see <a href=\"https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#core.appendix.application-startup-steps\" rel=\"nofollow noreferrer\">the documentation</a> for a list.</p>\n<p>To enable you need to register the <a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/core/metrics/ApplicationStartup.html\" rel=\"nofollow noreferrer\"><code>ApplicationStartup</code></a> and pass that to the <code>ApplicationContext</code> you are using. To record to the flight recorder you will need to create the <code>FlightRecorderApplicationStartup</code>.</p>\n<p>Assuming you are using Spring Boot this is trivial to do, you pass it to the <code>SpringApplication</code> before running it.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@SpringBootApplication\npublic class MyApplication {\n\n  public static void main(String[] args) throws Exception {\n    var app = new SpringApplication(MyApplication.class);\n    app.setApplicationStartup(new FlightRecorderApplicationStartup());\n    app.run(args);\n  }\n}\n</code></pre>\n<p>Now when starting you need to enable the flight recorder and the recordings.</p>\n<pre class=\"lang-bash prettyprint-override\"><code>java -XX:+FlightRecorder -XX:StartFlightRecording=duration=30s,filename=myrecording.jfr -jar your-app.jar\n</code></pre>\n<p>This will record events for 30s and after that write a file called <code>myrecording.jfr</code>, which you can then open in Java Mission Control and see how long certain parts took for a bean or all beans etc. If you app takes more then 30s to startup increase the <code>duration</code> parameter to what you need.</p>\n<p>If this isn't enough I would strongly suggest to use a proper profiler instead of trying to work around this with AOP as when adding AOP it will influence the time to start your application and beans (due to additional proxies being created, or you must use load- or compile time weaving).</p>\n"}],"owner":{"account_id":1551684,"reputation":1024,"user_id":1443928,"accept_rate":93,"display_name":"Hard Worker"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":38,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672903269,"creation_date":1672897161,"question_id":75014264,"body_markdown":"I have a Spring application, and Im trying to understand how long all the PostConruct takes.\r\n\r\nbut this method isn&#39;t getting called, what am I missing ?\r\n\r\n\r\n    @Component\r\n    @Aspect\r\n    @Order(1)\r\n    public class InspectorTime {\r\n    \r\n    \r\n    \t@Around(&quot;@within(javax.annotation.PostConstruct)&quot;)\r\n    \tpublic void beforePostConstruct(ProceedingJoinPoint joinPoint) throws Throwable {\r\n    \t\tLOG.info(&quot;Before PostContract:{}&quot;, joinPoint.getSignature().getDeclaringType().toString());\r\n    \t\tStopWatch stopWatch = new StopWatch();\r\n    \t\tstopWatch.start();\r\n    \t\tjoinPoint.proceed(joinPoint.getArgs());\r\n    \t\tstopWatch.stop();\r\n    \t\tLOG.info(&quot;After PostContract:{}&quot;, joinPoint.getSignature().getDeclaringType().toString() + &quot;, total time&quot; + stopWatch.toString());\r\n    \t}\r\n    \r\n    }\r\n\r\nI have followed, these solutions\r\nhttps://stackoverflow.com/questions/42270469/before-postconstruct-spring-aop-ineterception\r\nbut they also estimate the &quot;Autowire&quot; timing.\r\nI need to estimate the postContruct only.\r\n\r\n\r\n\r\nI also tried this Code\r\n\r\n\t\r\n\r\n    @Around(&quot;@annotation(javax.annotation.PostConstruct)&quot;)\r\n    \tpublic Object logExecutionTime(ProceedingJoinPoint joinPoint) throws Throwable {\r\n    \t\tlong start = System.currentTimeMillis();\r\n    \t\tObject proceed = joinPoint.proceed();\r\n    \t\tlong executionTime = System.currentTimeMillis() - start;\r\n    \t\tlogger.info(&quot;{}.{} executed in {} ms&quot;, joinPoint.getSignature().getDeclaringTypeName(),\r\n    \t\t\t\tjoinPoint.getSignature().getName(), executionTime);\r\n    \t\treturn proceed;\r\n    \t}\r\n\r\nBut its making my other beans to failed to instantiate: \r\n\r\n    Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.data.redis.core.RedisTemplate]: Factory method &#39;redisTemplate&#39; threw exception; nested exception is java.lang.NullPointerException\r\n\r\n","title":"How to Estimate all post contruct time in spring Application","body":"<p>I have a Spring application, and Im trying to understand how long all the PostConruct takes.</p>\n<p>but this method isn't getting called, what am I missing ?</p>\n<pre><code>@Component\n@Aspect\n@Order(1)\npublic class InspectorTime {\n\n\n    @Around(&quot;@within(javax.annotation.PostConstruct)&quot;)\n    public void beforePostConstruct(ProceedingJoinPoint joinPoint) throws Throwable {\n        LOG.info(&quot;Before PostContract:{}&quot;, joinPoint.getSignature().getDeclaringType().toString());\n        StopWatch stopWatch = new StopWatch();\n        stopWatch.start();\n        joinPoint.proceed(joinPoint.getArgs());\n        stopWatch.stop();\n        LOG.info(&quot;After PostContract:{}&quot;, joinPoint.getSignature().getDeclaringType().toString() + &quot;, total time&quot; + stopWatch.toString());\n    }\n\n}\n</code></pre>\n<p>I have followed, these solutions\n<a href=\"https://stackoverflow.com/questions/42270469/before-postconstruct-spring-aop-ineterception\">@Before @PostConstruct Spring AOP ineterception</a>\nbut they also estimate the &quot;Autowire&quot; timing.\nI need to estimate the postContruct only.</p>\n<p>I also tried this Code</p>\n<pre><code>@Around(&quot;@annotation(javax.annotation.PostConstruct)&quot;)\n    public Object logExecutionTime(ProceedingJoinPoint joinPoint) throws Throwable {\n        long start = System.currentTimeMillis();\n        Object proceed = joinPoint.proceed();\n        long executionTime = System.currentTimeMillis() - start;\n        logger.info(&quot;{}.{} executed in {} ms&quot;, joinPoint.getSignature().getDeclaringTypeName(),\n                joinPoint.getSignature().getName(), executionTime);\n        return proceed;\n    }\n</code></pre>\n<p>But its making my other beans to failed to instantiate:</p>\n<pre><code>Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.data.redis.core.RedisTemplate]: Factory method 'redisTemplate' threw exception; nested exception is java.lang.NullPointerException\n</code></pre>\n"},{"tags":["java","xml","xpath","xsd"],"answers":[{"comments":[{"owner":{"account_id":3344014,"reputation":91,"user_id":2809542,"display_name":"prat8789"},"score":0,"creation_date":1380257972,"post_id":18975910,"comment_id":28141939,"body_markdown":"Hi @markdark, thanks for your reply.......the second point that you mentioned (local-name()) works fine :) ............ but I dint understand the schema thing. Because if you look at the schema I have posted in my main post (wls.xsd) it has this line &#39;&lt;xs:schema xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;&#39;... but it doesnt seem to work....please can you have a look at that also?","body":"Hi @markdark, thanks for your reply.......the second point that you mentioned (local-name()) works fine :) ............ but I dint understand the schema thing. Because if you look at the schema I have posted in my main post (wls.xsd) it has this line &#39;&lt;xs:schema xmlns:xs=&quot;<a href=\"http://www.w3.org/2001/XMLSchema\" rel=\"nofollow noreferrer\">w3.org/2001/XMLSchema</a>&quot;&gt;&#39;... but it doesnt seem to work....please can you have a look at that also?"},{"owner":{"account_id":3344014,"reputation":91,"user_id":2809542,"display_name":"prat8789"},"score":0,"creation_date":1380258349,"post_id":18975910,"comment_id":28142042,"body_markdown":"This comment is just to help others if they need to refer to an attribute of a element:                                //*[local-name()=&#39;element&#39;][@id=&#39;1234&#39;] ...ie no need to use local-name() for the attribute of an element.....Thanks for your solution Mark","body":"This comment is just to help others if they need to refer to an attribute of a element:                                //*[local-name()=&#39;element&#39;][@id=&#39;1234&#39;] ...ie no need to use local-name() for the attribute of an element.....Thanks for your solution Mark"}],"tags":[],"owner":{"account_id":2012584,"reputation":4731,"user_id":1800695,"accept_rate":93,"display_name":"Mark Veenstra"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1380009235,"creation_date":1380009235,"answer_id":18975910,"question_id":18973452,"body_markdown":"If you trying to get a XPath working on a XSD schema, make sure you declare the namespace from the XSD `xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;`.\r\n\r\nIf you don&#39;t want to use namespaces you can use XPath as follows:\r\n\r\n    //*[local-name()=&#39;element&#39;]\r\n    /*[local-name()=&#39;schema&#39;]/*[local-name()=&#39;element&#39;]","title":"Xpath expression to search nodes not relative to root node works for XML file but fails for XSD file","body":"<p>If you trying to get a XPath working on a XSD schema, make sure you declare the namespace from the XSD <code>xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"</code>.</p>\n\n<p>If you don't want to use namespaces you can use XPath as follows:</p>\n\n<pre><code>//*[local-name()='element']\n/*[local-name()='schema']/*[local-name()='element']\n</code></pre>\n"},{"tags":[],"owner":{"account_id":18443,"reputation":1196,"user_id":42230,"accept_rate":56,"display_name":"Martin Bring"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672902831,"creation_date":1672902831,"answer_id":75014939,"question_id":18973452,"body_markdown":"Nine years later :)\r\n\r\nCould it be that you need to set `setNamespaceAware(true);`on the DocumentBuilderFactory instance?\r\n\r\nI&#39;ve read that the parser allowed an element to be named with o colon and not treat it as a namespace prefix in the early days, and default is false.\r\n\r\nBut if so, then I don&#39;t understand how &quot;/schema/element&quot; can work... :)","title":"Xpath expression to search nodes not relative to root node works for XML file but fails for XSD file","body":"<p>Nine years later :)</p>\n<p>Could it be that you need to set <code>setNamespaceAware(true);</code>on the DocumentBuilderFactory instance?</p>\n<p>I've read that the parser allowed an element to be named with o colon and not treat it as a namespace prefix in the early days, and default is false.</p>\n<p>But if so, then I don't understand how &quot;/schema/element&quot; can work... :)</p>\n"}],"owner":{"account_id":3344014,"reputation":91,"user_id":2809542,"display_name":"prat8789"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":996,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1672902831,"creation_date":1379999847,"question_id":18973452,"body_markdown":"This is my XML (wls.xml)\r\n\r\n    &lt;?xml version=&quot;1.0&quot;?&gt;\r\n        &lt;note&gt;\r\n        &lt;to&gt;Tove&lt;/to&gt;\r\n        &lt;from&gt;Jani&lt;/from&gt;\r\n        &lt;heading&gt;Reminder&lt;/heading&gt;\r\n        &lt;body&gt;Don&#39;t forget me this weekend!&lt;/body&gt;\r\n    &lt;/note&gt;\r\n    \r\n\r\nThis the XSD (wls.xsd)\r\n\r\n    &lt;?xml version=&quot;1.0&quot;?&gt;\r\n    &lt;xs:schema xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;\r\n\r\n    &lt;xs:element name=&quot;note&quot;&gt;\r\n         &lt;xs:complexType&gt;\r\n           &lt;xs:sequence&gt;\r\n             &lt;xs:element name=&quot;to&quot; type=&quot;xs:string&quot;/&gt;\r\n             &lt;xs:element name=&quot;from&quot; type=&quot;xs:string&quot;/&gt;\r\n             &lt;xs:element name=&quot;heading&quot; type=&quot;xs:string&quot;/&gt;\r\n             &lt;xs:element name=&quot;body&quot; type=&quot;xs:string&quot;/&gt;\r\n           &lt;/xs:sequence&gt;\r\n        &lt;/xs:complexType&gt;\r\n   &lt;/xs:element&gt;\r\n\r\n&lt;/xs:schema&gt;\r\n    \r\n\r\n\r\nand this the java class i used to parse the above files using Xpath\r\n\r\n\r\n    public static void test1()\r\n\t{\r\n\t\tString ipFile=&quot;w3s.xml&quot;;//wls.xsd\r\n                \r\n\t\tNode fetchNode=null;\r\n\r\n\t\tFileInputStream fileip;\r\n\t\ttry {\r\n\t\t\tfileip = new FileInputStream(new File(ipFile));\r\n\t\t\t\r\n\t\t\tDocumentBuilder builder =   DocumentBuilderFactory.newInstance().newDocumentBuilder();\t\t\r\n\t\t\tDocument xmlDocument = builder.parse(fileip);\r\n\t\t\t\r\n\t\t\tSystem.out.println(xmlDocument.getDocumentElement().getNodeName());\r\n\t\t\tSystem.out.println(xmlDocument.getDocumentElement().getLocalName());\r\n\t\t\tevalXpath(xmlDocument,&quot;//xs:element&quot;);//FAILS\r\n\t\t\tevalXpath(xmlDocument,&quot;//element&quot;);//FAILS\r\n\t\t\tevalXpath(xmlDocument,&quot;/schema/element&quot;);//WORKS\r\n\t\t\tevalXpath(xmlDocument,&quot;/xs:schema/xs:element&quot;);//FAILS\r\n\t\t\tevalXpath(xmlDocument,&quot;//heading&quot;);//FAILS\r\n\t\t\t\r\n\t\t\r\n\t\t\t\r\n\t\t} catch (FileNotFoundException e) {\r\n\t\t\t// TODO Auto-generated catch block\r\n\t\t\te.printStackTrace();\r\n\t\t} catch (SAXException e) {\r\n\t\t\t// TODO Auto-generated catch block\r\n\t\t\te.printStackTrace();\r\n\t\t} catch (IOException e) {\r\n\t\t\t// TODO Auto-generated catch block\r\n\t\t\te.printStackTrace();\r\n\t\t} catch (ParserConfigurationException e) {\r\n\t\t\t// TODO Auto-generated catch block\r\n\t\t\te.printStackTrace();\r\n\t\t}       \r\n\t}\r\n\t\r\n\t\r\n\tpublic static void evalXpath(Document xmlDocument,String expression)\r\n\t{\r\n\t\tNode fetchNode=null;\r\n\t\tNodeList fetchNodeList=null;\r\n\t\t//String expression=null;\r\n\t\ttry\r\n\t\t{\r\n\t\t\tXPath xPath =  XPathFactory.newInstance().newXPath(); \r\n\t\t\t\r\n\t\t\tfetchNode = (Node) xPath.compile(expression).evaluate(xmlDocument, XPathConstants.NODE);\r\n\t\t\tSystem.out.println(fetchNode);\r\n\t\t\t\r\n\t\t\tfetchNodeList = (NodeList) xPath.compile(expression).evaluate(xmlDocument, XPathConstants.NODESET);\r\n\t\t\tSystem.out.println(fetchNodeList.getLength());\r\n\t\t}\r\n\t\tcatch (XPathExpressionException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}    \r\n\t}\r\n\t\r\n    }\r\n\r\n\r\nThe issue when I parse the XML file and run the expression of the type &#39;\\\\ElemName&#39; it works fine and fetches the node. Not then I do the same for XSD file it returns NULL. \r\nFor XSD I need to sue    &#39;\\RootNode\\IntermediateNode\\....\\ReqdNode&#39;\r\nI have tried this with name different XML and XSD, just attaching these short files for illustration purpose. \r\n\r\nIssue2\r\nAlso there is one more issue:\r\nsay if I have an element &#39;xs:schema&#39; and I need to get only the local name part (without namespace prefix) like &#39;schema&#39;, how can I do it? I have tried the getLocalName() but it doesn&#39;t work. \r\n\r\n(I am using jdk6 if you need to know)\r\n\r\nPlease provide a resolution for atleast my first issue.\r\n\r\nThanks in advance.\r\n","title":"Xpath expression to search nodes not relative to root node works for XML file but fails for XSD file","body":"<p>This is my XML (wls.xml)</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n    &lt;note&gt;\n    &lt;to&gt;Tove&lt;/to&gt;\n    &lt;from&gt;Jani&lt;/from&gt;\n    &lt;heading&gt;Reminder&lt;/heading&gt;\n    &lt;body&gt;Don't forget me this weekend!&lt;/body&gt;\n&lt;/note&gt;\n</code></pre>\n\n<p>This the XSD (wls.xsd)</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"&gt;\n\n&lt;xs:element name=\"note\"&gt;\n     &lt;xs:complexType&gt;\n       &lt;xs:sequence&gt;\n         &lt;xs:element name=\"to\" type=\"xs:string\"/&gt;\n         &lt;xs:element name=\"from\" type=\"xs:string\"/&gt;\n         &lt;xs:element name=\"heading\" type=\"xs:string\"/&gt;\n         &lt;xs:element name=\"body\" type=\"xs:string\"/&gt;\n       &lt;/xs:sequence&gt;\n    &lt;/xs:complexType&gt;\n</code></pre>\n\n<p></p>\n\n<p></p>\n\n<p>and this the java class i used to parse the above files using Xpath</p>\n\n<pre><code>public static void test1()\n{\n    String ipFile=\"w3s.xml\";//wls.xsd\n\n    Node fetchNode=null;\n\n    FileInputStream fileip;\n    try {\n        fileip = new FileInputStream(new File(ipFile));\n\n        DocumentBuilder builder =   DocumentBuilderFactory.newInstance().newDocumentBuilder();      \n        Document xmlDocument = builder.parse(fileip);\n\n        System.out.println(xmlDocument.getDocumentElement().getNodeName());\n        System.out.println(xmlDocument.getDocumentElement().getLocalName());\n        evalXpath(xmlDocument,\"//xs:element\");//FAILS\n        evalXpath(xmlDocument,\"//element\");//FAILS\n        evalXpath(xmlDocument,\"/schema/element\");//WORKS\n        evalXpath(xmlDocument,\"/xs:schema/xs:element\");//FAILS\n        evalXpath(xmlDocument,\"//heading\");//FAILS\n\n\n\n    } catch (FileNotFoundException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    } catch (SAXException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    } catch (IOException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    } catch (ParserConfigurationException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    }       \n}\n\n\npublic static void evalXpath(Document xmlDocument,String expression)\n{\n    Node fetchNode=null;\n    NodeList fetchNodeList=null;\n    //String expression=null;\n    try\n    {\n        XPath xPath =  XPathFactory.newInstance().newXPath(); \n\n        fetchNode = (Node) xPath.compile(expression).evaluate(xmlDocument, XPathConstants.NODE);\n        System.out.println(fetchNode);\n\n        fetchNodeList = (NodeList) xPath.compile(expression).evaluate(xmlDocument, XPathConstants.NODESET);\n        System.out.println(fetchNodeList.getLength());\n    }\n    catch (XPathExpressionException e) {\n        e.printStackTrace();\n    }    \n}\n\n}\n</code></pre>\n\n<p>The issue when I parse the XML file and run the expression of the type '\\ElemName' it works fine and fetches the node. Not then I do the same for XSD file it returns NULL. \nFor XSD I need to sue    '\\RootNode\\IntermediateNode....\\ReqdNode'\nI have tried this with name different XML and XSD, just attaching these short files for illustration purpose. </p>\n\n<p>Issue2\nAlso there is one more issue:\nsay if I have an element 'xs:schema' and I need to get only the local name part (without namespace prefix) like 'schema', how can I do it? I have tried the getLocalName() but it doesn't work. </p>\n\n<p>(I am using jdk6 if you need to know)</p>\n\n<p>Please provide a resolution for atleast my first issue.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["java","spring-boot","jpa","querydsl"],"owner":{"account_id":22614717,"reputation":1,"user_id":16794380,"display_name":"Anant"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":208,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1672902775,"creation_date":1672902491,"question_id":75014902,"body_markdown":"How can I write a queryDSL query for the following MySQL query:\r\n\r\n``` \r\nSELECT\r\n    u.id as user_id,\r\n\tcount(*) as total_completed\r\n    date(o.created_at) date\r\nFROM\r\n    users u\r\nLEFT JOIN orders o ON o.user_id = u.id\r\nWHERE o.status=&#39;COMPLETED&#39;\r\nGROUP BY date(o.created), u.id\r\n```\r\nI am mainly interested in implementing the `date(timestamp_field)` so that I can use it for aggregating over entire dates.\r\n\r\nThis is my `OrderEntity`:\r\n\r\n```\r\n...\r\n@Table(name = &quot;orders&quot;)\r\npublic class OrderEntity extends BaseEntity {\r\n\r\n    @Id\r\n    @Column(nullable = false)\r\n    private String id;\r\n    private Instant createdAt;\r\n\t...\r\n}\r\n```\r\n\r\nThis is in `QOrderEntity`\r\n``` \r\n    public final DateTimePath&lt;java.time.Instant&gt; createdAt = createDateTime(&quot;createdAt&quot;, java.time.Instant.class);\r\n```\r\n\r\nBasically, how can I truncate/type cast the SQL `Timestamp` field to `DATE` in the SELECT query. It needs to be done on the `WHERE` clause, `GROUP BY` clause, and `SELECT` clause\r\n\r\nI tried this link here: https://stackoverflow.com/questions/15610576/querydsl-select-rows-with-date-from-timestamp-column\r\n&gt; You can either use between or a custom expression if you use Querydsl SQL\r\nSomething like this\r\n\r\n&gt;`DateExpression&lt;Date&gt; converted = DateTemplate.create(Date.class, &quot;convert(date, {0})&quot;,`\r\n\r\nThe API doesn&#39;t have `create()` method, maybe it was removed.\r\n","title":"How can I group by a date(timestamp_field ) in QueryDSL 5.0.0","body":"<p>How can I write a queryDSL query for the following MySQL query:</p>\n<pre><code>SELECT\n    u.id as user_id,\n    count(*) as total_completed\n    date(o.created_at) date\nFROM\n    users u\nLEFT JOIN orders o ON o.user_id = u.id\nWHERE o.status='COMPLETED'\nGROUP BY date(o.created), u.id\n</code></pre>\n<p>I am mainly interested in implementing the <code>date(timestamp_field)</code> so that I can use it for aggregating over entire dates.</p>\n<p>This is my <code>OrderEntity</code>:</p>\n<pre><code>...\n@Table(name = &quot;orders&quot;)\npublic class OrderEntity extends BaseEntity {\n\n    @Id\n    @Column(nullable = false)\n    private String id;\n    private Instant createdAt;\n    ...\n}\n</code></pre>\n<p>This is in <code>QOrderEntity</code></p>\n<pre><code>    public final DateTimePath&lt;java.time.Instant&gt; createdAt = createDateTime(&quot;createdAt&quot;, java.time.Instant.class);\n</code></pre>\n<p>Basically, how can I truncate/type cast the SQL <code>Timestamp</code> field to <code>DATE</code> in the SELECT query. It needs to be done on the <code>WHERE</code> clause, <code>GROUP BY</code> clause, and <code>SELECT</code> clause</p>\n<p>I tried this link here: <a href=\"https://stackoverflow.com/questions/15610576/querydsl-select-rows-with-date-from-timestamp-column\">QueryDSL - select rows with date from timestamp column</a></p>\n<blockquote>\n<p>You can either use between or a custom expression if you use Querydsl SQL\nSomething like this</p>\n</blockquote>\n<blockquote>\n<p><code>DateExpression&lt;Date&gt; converted = DateTemplate.create(Date.class, &quot;convert(date, {0})&quot;,</code></p>\n</blockquote>\n<p>The API doesn't have <code>create()</code> method, maybe it was removed.</p>\n"},{"tags":["java","intellij-idea","interface-implementation"],"comments":[{"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"score":2,"creation_date":1672899857,"post_id":75014297,"comment_id":132378093,"body_markdown":"Sounds like you&#39;re asking about [Variable used in lambda expression should be final or effectively final](https://stackoverflow.com/q/34865383/6395627) (also see [Why are only final variables accessible in anonymous class?](https://stackoverflow.com/q/4732544/6395627)).","body":"Sounds like you&#39;re asking about <a href=\"https://stackoverflow.com/q/34865383/6395627\">Variable used in lambda expression should be final or effectively final</a> (also see <a href=\"https://stackoverflow.com/q/4732544/6395627\">Why are only final variables accessible in anonymous class?</a>)."},{"owner":{"account_id":5823420,"reputation":785,"user_id":6656833,"display_name":"Pavel"},"score":0,"creation_date":1672899937,"post_id":75014297,"comment_id":132378112,"body_markdown":"what is `UserInputRetriever`? where it comes from? it should hold the result value. you should not modify any variable outside of the lambda, that is a very bad practice.","body":"what is <code>UserInputRetriever</code>? where it comes from? it should hold the result value. you should not modify any variable outside of the lambda, that is a very bad practice."},{"owner":{"account_id":21570505,"reputation":1,"user_id":15903441,"display_name":"Tobi Cinquante"},"score":0,"creation_date":1672989178,"post_id":75014297,"comment_id":132401373,"body_markdown":"Thanks @Slaw Reading the thread you provided shed some light as to the why. I was just wondering why that didnt apply to array values, but only variables","body":"Thanks @Slaw Reading the thread you provided shed some light as to the why. I was just wondering why that didnt apply to array values, but only variables"},{"owner":{"account_id":21570505,"reputation":1,"user_id":15903441,"display_name":"Tobi Cinquante"},"score":0,"creation_date":1672989289,"post_id":75014297,"comment_id":132401395,"body_markdown":"@Pavel I am not modifying the value at all. As stated UserInputRetriever is an interface. I simply use the result from that interface implementation to compute another value","body":"@Pavel I am not modifying the value at all. As stated UserInputRetriever is an interface. I simply use the result from that interface implementation to compute another value"},{"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"score":1,"creation_date":1672989290,"post_id":75014297,"comment_id":132401396,"body_markdown":"Ultimately, because `array[0] = newValue` does not modify the local variable. More specifically, it doesn&#39;t reassign the local variable, therefore it is still final or effectively final. The local variable in this case being `array`, which references a specific array instance. Writing to a position in that array is updating that array&#39;s _instance_ state (which is not a local variable). You could see the same thing with any mutable object (e.g., `User user = ...; () -&gt; user.setName(&quot;foo&quot;);`).","body":"Ultimately, because <code>array[0] = newValue</code> does not modify the local variable. More specifically, it doesn&#39;t reassign the local variable, therefore it is still final or effectively final. The local variable in this case being <code>array</code>, which references a specific array instance. Writing to a position in that array is updating that array&#39;s <i>instance</i> state (which is not a local variable). You could see the same thing with any mutable object (e.g., <code>User user = ...; () -&gt; user.setName(&quot;foo&quot;);</code>)."},{"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"score":0,"creation_date":1672989821,"post_id":75014297,"comment_id":132401501,"body_markdown":"It helps to understand the why if you understand how programs are stored in memory, and how the stack and the heap work. A local variable is stored on the stack (the variable itself, not necessarily the object it references). It only exists until the method returns. After that, the memory it was stored at can become anything, even meaningless garbage. But a lambda/anonymous class instance can live beyond the scope of the method. The &quot;workaround&quot; then was to &quot;capture&quot; the value of the local variable and store it in an implicit field of the lambda/anonymous class. [cont.]","body":"It helps to understand the why if you understand how programs are stored in memory, and how the stack and the heap work. A local variable is stored on the stack (the variable itself, not necessarily the object it references). It only exists until the method returns. After that, the memory it was stored at can become anything, even meaningless garbage. But a lambda/anonymous class instance can live beyond the scope of the method. The &quot;workaround&quot; then was to &quot;capture&quot; the value of the local variable and store it in an implicit field of the lambda/anonymous class. [cont.]"},{"owner":{"account_id":21570505,"reputation":1,"user_id":15903441,"display_name":"Tobi Cinquante"},"score":0,"creation_date":1672989855,"post_id":75014297,"comment_id":132401506,"body_markdown":"@Slaw That is quite interesting. I definitely need to read more on lambdas. T Thanks. That actually makes sense because the elements of the array is what is being modified and not the variable or the reference to the array itself(which is on the stack). I feel really stupid now because the answer is actually very simple and logical. Thanks again!","body":"@Slaw That is quite interesting. I definitely need to read more on lambdas. T Thanks. That actually makes sense because the elements of the array is what is being modified and not the variable or the reference to the array itself(which is on the stack). I feel really stupid now because the answer is actually very simple and logical. Thanks again!"},{"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"score":0,"creation_date":1672989965,"post_id":75014297,"comment_id":132401529,"body_markdown":"[cont.] But if the local variable could be modified, then that could lead to subtle bugs. Especially if multiple threads are involved. So, they require the local variable to be (effectively) final to prevent such bugs from ever occurring. But fields are stored in the heap. The references to elements of an array are on the heap. These references live beyond any method invocation. This heap state is also covered by the Java Memory Model (JMM), giving well-defined behavior in multi-threaded contexts.","body":"[cont.] But if the local variable could be modified, then that could lead to subtle bugs. Especially if multiple threads are involved. So, they require the local variable to be (effectively) final to prevent such bugs from ever occurring. But fields are stored in the heap. The references to elements of an array are on the heap. These references live beyond any method invocation. This heap state is also covered by the Java Memory Model (JMM), giving well-defined behavior in multi-threaded contexts."}],"answers":[{"comments":[{"owner":{"account_id":21570505,"reputation":1,"user_id":15903441,"display_name":"Tobi Cinquante"},"score":0,"creation_date":1672989501,"post_id":75014780,"comment_id":132401439,"body_markdown":"Thanks for the explanation, Roland! It was really clear! I will also make sure to provide an executable of the problem next time. For everyone else who reads, I apologize for not putting enough details. First time using Stack Overflow","body":"Thanks for the explanation, Roland! It was really clear! I will also make sure to provide an executable of the problem next time. For everyone else who reads, I apologize for not putting enough details. First time using Stack Overflow"}],"tags":[],"owner":{"account_id":8354342,"reputation":76,"user_id":6275236,"display_name":"Roland J."},"comment_count":1,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1672901664,"creation_date":1672901664,"answer_id":75014780,"question_id":75014297,"body_markdown":"The [Java Lang. Spec.][1] states that the &quot;restriction to effectively final variables prohibits access to dynamically-changing local variables, whose capture would likely introduce concurrency problems&quot;. \r\n\r\nIn order to address this problem you can use atomic references or atomic types, e.g., AtomicBoolean. \r\n\r\n  [1]: https://docs.oracle.com/javase/specs/jls/se10/html/jls-15.html#jls-15.27.2\r\n\r\nBTW: It would have been helpful for others to provide an executable example of the problem and the solution. Something like this makes it easier to help:\r\n\r\n    import org.junit.jupiter.api.Test;\r\n    \r\n    import java.util.concurrent.atomic.AtomicBoolean;\r\n    \r\n    import static org.junit.jupiter.api.Assertions.*;\r\n    \r\n    public class FunctionalInterfaceProblem {\r\n        public static String EXCEPTION_MESSAGE = &quot;Value not 0 or 1&quot;;\r\n    \r\n        @java.lang.FunctionalInterface\r\n        interface SomeInterfaceWithBoolean&lt;T&gt; {\r\n            boolean calculate(T i) throws IllegalArgumentException;\r\n        }\r\n    \r\n        @Test\r\n        public void testWihArray() {\r\n            boolean[] outcome = new boolean[1];\r\n    \r\n            SomeInterfaceWithBoolean&lt;Integer&gt; result = i -&gt; {\r\n                if(i == 1){\r\n                    outcome[0] = true;\r\n                } else if (i == 0){\r\n                    outcome[0] = false;\r\n                } else {\r\n                    throw new IllegalArgumentException(EXCEPTION_MESSAGE);\r\n                }\r\n                return outcome[0];\r\n            };\r\n    \r\n            assertFalse(result.calculate(0));\r\n            assertTrue(result.calculate(1));\r\n            Throwable exception = assertThrows(IllegalArgumentException.class, ()-&gt;{result.calculate(2);} );\r\n            assertEquals(EXCEPTION_MESSAGE, exception.getMessage());\r\n        }\r\n    \r\n        @java.lang.FunctionalInterface\r\n        interface SomeInterfaceWithAtomicBoolean&lt;T&gt; {\r\n            AtomicBoolean calculate(T i) throws IllegalArgumentException;\r\n        }\r\n    \r\n        @Test\r\n        public void testWihAtomicBoolean() {\r\n            AtomicBoolean outcome = new AtomicBoolean(false);\r\n    \r\n            SomeInterfaceWithAtomicBoolean&lt;Integer&gt; result = i -&gt; {\r\n                if(i == 1){\r\n                    outcome.set(true);\r\n                } else if (i == 0){\r\n                    outcome.set(false);\r\n                } else {\r\n                    throw new IllegalArgumentException(EXCEPTION_MESSAGE);\r\n                }\r\n                return outcome;\r\n            };\r\n    \r\n            assertFalse(result.calculate(0).get());\r\n            assertTrue(result.calculate(1).get());\r\n            Throwable exception = assertThrows(IllegalArgumentException.class, ()-&gt;{result.calculate(2);} );\r\n            assertEquals(EXCEPTION_MESSAGE, exception.getMessage());\r\n        }\r\n    \r\n    }\r\n\r\n\r\n","title":"Implementing interfaces in a method using lambda (JAVA)","body":"<p>The <a href=\"https://docs.oracle.com/javase/specs/jls/se10/html/jls-15.html#jls-15.27.2\" rel=\"nofollow noreferrer\">Java Lang. Spec.</a> states that the &quot;restriction to effectively final variables prohibits access to dynamically-changing local variables, whose capture would likely introduce concurrency problems&quot;.</p>\n<p>In order to address this problem you can use atomic references or atomic types, e.g., AtomicBoolean.</p>\n<p>BTW: It would have been helpful for others to provide an executable example of the problem and the solution. Something like this makes it easier to help:</p>\n<pre><code>import org.junit.jupiter.api.Test;\n\nimport java.util.concurrent.atomic.AtomicBoolean;\n\nimport static org.junit.jupiter.api.Assertions.*;\n\npublic class FunctionalInterfaceProblem {\n    public static String EXCEPTION_MESSAGE = &quot;Value not 0 or 1&quot;;\n\n    @java.lang.FunctionalInterface\n    interface SomeInterfaceWithBoolean&lt;T&gt; {\n        boolean calculate(T i) throws IllegalArgumentException;\n    }\n\n    @Test\n    public void testWihArray() {\n        boolean[] outcome = new boolean[1];\n\n        SomeInterfaceWithBoolean&lt;Integer&gt; result = i -&gt; {\n            if(i == 1){\n                outcome[0] = true;\n            } else if (i == 0){\n                outcome[0] = false;\n            } else {\n                throw new IllegalArgumentException(EXCEPTION_MESSAGE);\n            }\n            return outcome[0];\n        };\n\n        assertFalse(result.calculate(0));\n        assertTrue(result.calculate(1));\n        Throwable exception = assertThrows(IllegalArgumentException.class, ()-&gt;{result.calculate(2);} );\n        assertEquals(EXCEPTION_MESSAGE, exception.getMessage());\n    }\n\n    @java.lang.FunctionalInterface\n    interface SomeInterfaceWithAtomicBoolean&lt;T&gt; {\n        AtomicBoolean calculate(T i) throws IllegalArgumentException;\n    }\n\n    @Test\n    public void testWihAtomicBoolean() {\n        AtomicBoolean outcome = new AtomicBoolean(false);\n\n        SomeInterfaceWithAtomicBoolean&lt;Integer&gt; result = i -&gt; {\n            if(i == 1){\n                outcome.set(true);\n            } else if (i == 0){\n                outcome.set(false);\n            } else {\n                throw new IllegalArgumentException(EXCEPTION_MESSAGE);\n            }\n            return outcome;\n        };\n\n        assertFalse(result.calculate(0).get());\n        assertTrue(result.calculate(1).get());\n        Throwable exception = assertThrows(IllegalArgumentException.class, ()-&gt;{result.calculate(2);} );\n        assertEquals(EXCEPTION_MESSAGE, exception.getMessage());\n    }\n\n}\n</code></pre>\n"}],"owner":{"account_id":21570505,"reputation":1,"user_id":15903441,"display_name":"Tobi Cinquante"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":122,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1672901664,"creation_date":1672897518,"question_id":75014297,"body_markdown":"I am working on a program that is supposed to describe a takeout system. I have a specific method that is supposed to simulate whether a customer has enough money to buy something using an interface. The problem I encountered was that while I was trying to implement an interface, UserInputRetriever, using lambda..I could only use final variables within the lambda expression. When it got to making a return statement for the method itself, shouldSimulate(), I realized I couldnt because what I returned is only visible in the lambda. Now IntelliJ, suggested using a final array which worked, because I was able to use it within the lambda expression and outside of it. I just need understanding as to why using array worked as compared to using a variable. Can you please explain?\r\n\r\nThe method is as follows:\r\n\r\n    public boolean shouldSimulate() {\r\n        boolean[] hasMoney = new boolean[1];\r\n\r\n        String userPrompt = &quot;&quot;&quot;\r\n                Please choose an option from the following:\r\n                0. To end simulation process\r\n                1. To proceed with simulation process&quot;&quot;&quot;;\r\n\r\n        UserInputRetriever&lt;?&gt; intUserInputRetriever = selection -&gt; {\r\n\r\n            if(selection == 1 &amp;&amp; customer.money &gt;= menu.getLowestFoodCost()){\r\n                System.out.println(&quot;You have enough money.\\nProceeding with &quot; +\r\n                        &quot;simulation&quot;);\r\n                hasMoney[0] = true; \r\n            }\r\n\r\n            else if (selection == 1 &amp;&amp; customer.money &lt; menu.getLowestFoodCost()){\r\n                System.out.println(&quot;You do not have enough money.\\nEnding the&quot; +\r\n                        &quot; simulation&quot;);\r\n                hasMoney[0] = false;\r\n            }\r\n\r\n            else if(selection == 0){\r\n                System.out.println(&quot;Terminating simulation&quot;);\r\n                hasMoney[0] = false;\r\n            }\r\n\r\n            else\r\n                throw new IllegalArgumentException(&quot;Please choose a valid &quot; +\r\n                        &quot;option&quot;);\r\n\r\n            return hasMoney[0];// if hasMoney was a variable, this would not throw a compile time error\r\n        };\r\n        getOutputOnInput(userPrompt, intUserInputRetriever);// you can ignore this line\r\n\r\n        return hasMoney[0];// if hasMoney was a variable, this would throw a compile time error\r\n    }\r\n\r\nI tried using a variable first locally and tried to also use that in my interface implementation (which used lambda), but it threw errors. But upon using suggestion from IntelliJ which suggested using an array, it worked. I would like to know why","title":"Implementing interfaces in a method using lambda (JAVA)","body":"<p>I am working on a program that is supposed to describe a takeout system. I have a specific method that is supposed to simulate whether a customer has enough money to buy something using an interface. The problem I encountered was that while I was trying to implement an interface, UserInputRetriever, using lambda..I could only use final variables within the lambda expression. When it got to making a return statement for the method itself, shouldSimulate(), I realized I couldnt because what I returned is only visible in the lambda. Now IntelliJ, suggested using a final array which worked, because I was able to use it within the lambda expression and outside of it. I just need understanding as to why using array worked as compared to using a variable. Can you please explain?</p>\n<p>The method is as follows:</p>\n<pre><code>public boolean shouldSimulate() {\n    boolean[] hasMoney = new boolean[1];\n\n    String userPrompt = &quot;&quot;&quot;\n            Please choose an option from the following:\n            0. To end simulation process\n            1. To proceed with simulation process&quot;&quot;&quot;;\n\n    UserInputRetriever&lt;?&gt; intUserInputRetriever = selection -&gt; {\n\n        if(selection == 1 &amp;&amp; customer.money &gt;= menu.getLowestFoodCost()){\n            System.out.println(&quot;You have enough money.\\nProceeding with &quot; +\n                    &quot;simulation&quot;);\n            hasMoney[0] = true; \n        }\n\n        else if (selection == 1 &amp;&amp; customer.money &lt; menu.getLowestFoodCost()){\n            System.out.println(&quot;You do not have enough money.\\nEnding the&quot; +\n                    &quot; simulation&quot;);\n            hasMoney[0] = false;\n        }\n\n        else if(selection == 0){\n            System.out.println(&quot;Terminating simulation&quot;);\n            hasMoney[0] = false;\n        }\n\n        else\n            throw new IllegalArgumentException(&quot;Please choose a valid &quot; +\n                    &quot;option&quot;);\n\n        return hasMoney[0];// if hasMoney was a variable, this would not throw a compile time error\n    };\n    getOutputOnInput(userPrompt, intUserInputRetriever);// you can ignore this line\n\n    return hasMoney[0];// if hasMoney was a variable, this would throw a compile time error\n}\n</code></pre>\n<p>I tried using a variable first locally and tried to also use that in my interface implementation (which used lambda), but it threw errors. But upon using suggestion from IntelliJ which suggested using an array, it worked. I would like to know why</p>\n"},{"tags":["java","arrays","for-loop","integer","switch-statement"],"comments":[{"owner":{"account_id":3116234,"reputation":9296,"user_id":2636929,"display_name":"Stultuske"},"score":0,"creation_date":1669187174,"post_id":74542802,"comment_id":131584750,"body_markdown":"do you understand what the &quot;return&quot; keyword does?","body":"do you understand what the &quot;return&quot; keyword does?"},{"owner":{"account_id":23617023,"reputation":3,"user_id":17650958,"display_name":"kelkrekeksa"},"score":0,"creation_date":1669188030,"post_id":74542802,"comment_id":131584964,"body_markdown":"oh okay after learning about it more I understood that I have to delete that line for the loop to work. Thanks for the help.","body":"oh okay after learning about it more I understood that I have to delete that line for the loop to work. Thanks for the help."}],"answers":[{"comments":[{"owner":{"account_id":3491975,"reputation":1562,"user_id":2921426,"accept_rate":64,"display_name":"SimonC"},"score":0,"creation_date":1669364458,"post_id":74542848,"comment_id":131629522,"body_markdown":"You could mention in your answer that `return` will exit the method and will *return to sender*, so to speak","body":"You could mention in your answer that <code>return</code> will exit the method and will <i>return to sender</i>, so to speak"}],"tags":[],"owner":{"account_id":22878710,"reputation":73,"user_id":17020613,"display_name":"ZYinNJU"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1669186707,"creation_date":1669186707,"answer_id":74542848,"question_id":74542802,"body_markdown":"Please do some progress to debug your program. `return intArray[i]` will return the value of the first letter when the for loop execute the first time.","title":"For loop is not returning a different value for every array index","body":"<p>Please do some progress to debug your program. <code>return intArray[i]</code> will return the value of the first letter when the for loop execute the first time.</p>\n"},{"tags":[],"owner":{"account_id":26973585,"reputation":117,"user_id":20539215,"display_name":"VicenteJankowski"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1672901561,"creation_date":1669188397,"answer_id":74543099,"question_id":74542802,"body_markdown":"You shouldn&#39;t put `return intArray[i]` inside the for loop, as it breaks the loop at the first iteration and finishes `getNumber` method.\r\n\r\nAlso you have doubled the for/while loop. As a result, if you fix the problem with `getNumber` method, you will get encrypted word as many times as `word.length()`. \r\n\r\nYou should either:\r\n\r\n - iterate the word in main function and return single integer in `getNumber` method \r\n\r\nor\r\n\r\n - change return type for getNumber to `int[]` (or even better String) and use for loop inside the `getNumber` - that would be preferred solution\r\n","title":"For loop is not returning a different value for every array index","body":"<p>You shouldn't put <code>return intArray[i]</code> inside the for loop, as it breaks the loop at the first iteration and finishes <code>getNumber</code> method.</p>\n<p>Also you have doubled the for/while loop. As a result, if you fix the problem with <code>getNumber</code> method, you will get encrypted word as many times as <code>word.length()</code>.</p>\n<p>You should either:</p>\n<ul>\n<li>iterate the word in main function and return single integer in <code>getNumber</code> method</li>\n</ul>\n<p>or</p>\n<ul>\n<li>change return type for getNumber to <code>int[]</code> (or even better String) and use for loop inside the <code>getNumber</code> - that would be preferred solution</li>\n</ul>\n"},{"tags":[],"owner":{"account_id":22794114,"reputation":1,"user_id":16947932,"display_name":"Abdullah All Abir"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1669189212,"creation_date":1669189212,"answer_id":74543230,"question_id":74542802,"body_markdown":"you are returning inside the for loop. So the loop won&#39;t continue, and will return the value after the 1st iteration. ","title":"For loop is not returning a different value for every array index","body":"<p>you are returning inside the for loop. So the loop won't continue, and will return the value after the 1st iteration.</p>\n"}],"owner":{"account_id":23617023,"reputation":3,"user_id":17650958,"display_name":"kelkrekeksa"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":56,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":74542848,"answer_count":3,"score":0,"last_activity_date":1672901561,"creation_date":1669186382,"question_id":74542802,"body_markdown":"I&#39;ve written a code about a program where a word gets encrypted as a number dependent on a fixed parameter such as &quot;Software&quot; turning into 76389273. However the for loop is not returning different values for every letter, and returns the same value (value of the first letter) for all letters. \r\n```\r\nimport java.util.Scanner;\r\n\r\npublic class StringtoNumber {\r\n    public static int getNumber(String word) {\r\n        int value = 0;\r\n        int intArray[] = new int[word.length()];\r\n        for (int i = 0; i &lt; word.length(); i++) {\r\n            switch (word.charAt(i)) {\r\n                case &#39;A&#39;:\r\n                case &#39;B&#39;:\r\n                case &#39;C&#39;:\r\n                case &#39;a&#39;:\r\n                case &#39;b&#39;:\r\n                case &#39;c&#39;:\r\n                    value = 2;\r\n                    break;\r\n                case &#39;D&#39;:\r\n                case &#39;E&#39;:\r\n                case &#39;F&#39;:\r\n                case &#39;d&#39;:\r\n                case &#39;e&#39;:\r\n                case &#39;f&#39;:\r\n                    value = 3;\r\n                    break;\r\n                case &#39;G&#39;:\r\n                case &#39;H&#39;:\r\n                case &#39;I&#39;:\r\n                case &#39;g&#39;:\r\n                case &#39;h&#39;:\r\n                case &#39;i&#39;:\r\n                    value = 4;\r\n                    break;\r\n                case &#39;J&#39;:\r\n                case &#39;K&#39;:\r\n                case &#39;L&#39;:\r\n                case &#39;j&#39;:\r\n                case &#39;k&#39;:\r\n                case &#39;l&#39;:\r\n                    value = 5;\r\n                    break;\r\n                case &#39;M&#39;:\r\n                case &#39;N&#39;:\r\n                case &#39;O&#39;:\r\n                case &#39;m&#39;:\r\n                case &#39;n&#39;:\r\n                case &#39;o&#39;:\r\n                    value = 6;\r\n                    break;\r\n                case &#39;P&#39;:\r\n                case &#39;Q&#39;:\r\n                case &#39;R&#39;:\r\n                case &#39;S&#39;:\r\n                case &#39;p&#39;:\r\n                case &#39;q&#39;:\r\n                case &#39;r&#39;:\r\n                case &#39;s&#39;:\r\n                    value = 7;\r\n                    break;\r\n                case &#39;T&#39;:\r\n                case &#39;U&#39;:\r\n                case &#39;V&#39;:\r\n                case &#39;t&#39;:\r\n                case &#39;u&#39;:\r\n                case &#39;v&#39;:\r\n                    value = 8;\r\n                    break;\r\n                case &#39;W&#39;:\r\n                case &#39;X&#39;:\r\n                case &#39;Y&#39;:\r\n                case &#39;Z&#39;:\r\n                case &#39;w&#39;:\r\n                case &#39;x&#39;:\r\n                case &#39;y&#39;:\r\n                case &#39;z&#39;:\r\n                    value = 9;\r\n                    break;\r\n            }\r\n            intArray[i] = value;\r\n            return intArray[i];\r\n        }\r\n\r\n        int result = 0;\r\n        for (int i = 0; i &lt; intArray.length; i++) {\r\n            result += Math.pow(10, i) * intArray[intArray.length - i - 1];\r\n        }\r\n        return result;\r\n    }\r\n\r\n        public static void main (String[]arg){\r\n\r\n            Scanner input = new Scanner(System.in);\r\n            System.out.println(&quot;what word do you want to encrypt&quot;);\r\n            String word = input.nextLine();\r\n            int counter = 0;\r\n            while (counter &lt; word.length()) {\r\n                System.out.print(getNumber(word));\r\n                counter++;\r\n            }\r\n        }\r\n    }\r\n```\r\n\r\nI&#39;ve tried finding mistake but I haven&#39;t seen anything, is there something I am not taking into account?","title":"For loop is not returning a different value for every array index","body":"<p>I've written a code about a program where a word gets encrypted as a number dependent on a fixed parameter such as &quot;Software&quot; turning into 76389273. However the for loop is not returning different values for every letter, and returns the same value (value of the first letter) for all letters.</p>\n<pre><code>import java.util.Scanner;\n\npublic class StringtoNumber {\n    public static int getNumber(String word) {\n        int value = 0;\n        int intArray[] = new int[word.length()];\n        for (int i = 0; i &lt; word.length(); i++) {\n            switch (word.charAt(i)) {\n                case 'A':\n                case 'B':\n                case 'C':\n                case 'a':\n                case 'b':\n                case 'c':\n                    value = 2;\n                    break;\n                case 'D':\n                case 'E':\n                case 'F':\n                case 'd':\n                case 'e':\n                case 'f':\n                    value = 3;\n                    break;\n                case 'G':\n                case 'H':\n                case 'I':\n                case 'g':\n                case 'h':\n                case 'i':\n                    value = 4;\n                    break;\n                case 'J':\n                case 'K':\n                case 'L':\n                case 'j':\n                case 'k':\n                case 'l':\n                    value = 5;\n                    break;\n                case 'M':\n                case 'N':\n                case 'O':\n                case 'm':\n                case 'n':\n                case 'o':\n                    value = 6;\n                    break;\n                case 'P':\n                case 'Q':\n                case 'R':\n                case 'S':\n                case 'p':\n                case 'q':\n                case 'r':\n                case 's':\n                    value = 7;\n                    break;\n                case 'T':\n                case 'U':\n                case 'V':\n                case 't':\n                case 'u':\n                case 'v':\n                    value = 8;\n                    break;\n                case 'W':\n                case 'X':\n                case 'Y':\n                case 'Z':\n                case 'w':\n                case 'x':\n                case 'y':\n                case 'z':\n                    value = 9;\n                    break;\n            }\n            intArray[i] = value;\n            return intArray[i];\n        }\n\n        int result = 0;\n        for (int i = 0; i &lt; intArray.length; i++) {\n            result += Math.pow(10, i) * intArray[intArray.length - i - 1];\n        }\n        return result;\n    }\n\n        public static void main (String[]arg){\n\n            Scanner input = new Scanner(System.in);\n            System.out.println(&quot;what word do you want to encrypt&quot;);\n            String word = input.nextLine();\n            int counter = 0;\n            while (counter &lt; word.length()) {\n                System.out.print(getNumber(word));\n                counter++;\n            }\n        }\n    }\n</code></pre>\n<p>I've tried finding mistake but I haven't seen anything, is there something I am not taking into account?</p>\n"},{"tags":["java","maven","junit","log4j","junit5"],"answers":[{"tags":[],"owner":{"account_id":5255222,"reputation":573,"user_id":4198317,"display_name":"St&#233;phane Jeandeaux"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1672901353,"creation_date":1672900685,"answer_id":75014638,"question_id":75013039,"body_markdown":"The methods BeforeAll and BeforeEach are not executed due to surefire plugin.\r\nYou should use at least maven-surefire-plugin#3.0.0-M1.\r\n\r\n```\r\n&lt;plugin&gt;\r\n  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n  &lt;artifactId&gt;maven-surefire-report-plugin&lt;/artifactId&gt;\r\n  &lt;version&gt;3.0.0-M1&lt;/version&gt;\r\n&lt;/plugin&gt;\r\n```\r\n","title":"mvn test + JUnit5 + log4j: Why logs printed in @BeforeAll and @BeforeEach are not output to console?","body":"<p>The methods BeforeAll and BeforeEach are not executed due to surefire plugin.\nYou should use at least maven-surefire-plugin#3.0.0-M1.</p>\n<pre><code>&lt;plugin&gt;\n  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n  &lt;artifactId&gt;maven-surefire-report-plugin&lt;/artifactId&gt;\n  &lt;version&gt;3.0.0-M1&lt;/version&gt;\n&lt;/plugin&gt;\n</code></pre>\n"}],"owner":{"account_id":2975171,"reputation":1319,"user_id":2526362,"accept_rate":83,"display_name":"Reed_Xia"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":341,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":75014638,"answer_count":1,"score":2,"last_activity_date":1672901353,"creation_date":1672882589,"question_id":75013039,"body_markdown":"I create a simple maven project to describe my problem\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\r\n  &lt;groupId&gt;org.example&lt;/groupId&gt;\r\n  &lt;artifactId&gt;NoLog&lt;/artifactId&gt;\r\n  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\r\n  &lt;properties&gt;\r\n    &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt;\r\n    &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt;\r\n    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\r\n  &lt;/properties&gt;\r\n  &lt;dependencies&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\r\n      &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\r\n      &lt;version&gt;5.9.0&lt;/version&gt;\r\n      &lt;scope&gt;test&lt;/scope&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;commons-logging&lt;/groupId&gt;\r\n      &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\r\n      &lt;version&gt;1.2&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\r\n      &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;\r\n      &lt;version&gt;2.19.0&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\r\n      &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\r\n      &lt;version&gt;2.19.0&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\r\n      &lt;artifactId&gt;log4j-jcl&lt;/artifactId&gt;\r\n      &lt;version&gt;2.19.0&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n  &lt;/dependencies&gt;\r\n&lt;/project&gt;\r\n```\r\n\r\nmy test class code\r\n```\r\nimport org.apache.logging.log4j.LogManager;\r\nimport org.apache.logging.log4j.Logger;\r\nimport org.junit.jupiter.api.BeforeAll;\r\nimport org.junit.jupiter.api.BeforeEach;\r\nimport org.junit.jupiter.api.Test;\r\n\r\npublic class TestDemo {\r\n\r\n  static Logger log = LogManager.getLogger(TestDemo.class);\r\n  @BeforeAll\r\n  public static void setupClass() {\r\n    log.info(&quot;BeforeAll 111 from log.info&quot;);\r\n    System.out.println(&quot;BeforeAll 111 from print&quot;);\r\n    log.info(&quot;BeforeAll 222 from log.info&quot;);\r\n    System.out.println(&quot;BeforeAll 222 from print&quot;);\r\n  }\r\n\r\n  @BeforeEach\r\n  public void setup() {\r\n    log.info(&quot;BeforeEach 111 from log.info&quot;);\r\n    System.out.println(&quot;BeforeEach 111 from print&quot;);\r\n    log.info(&quot;BeforeEach 222 from log.info&quot;);\r\n    System.out.println(&quot;BeforeEach 222 from print&quot;);\r\n  }\r\n\r\n  @Test\r\n  public void test1() {\r\n    log.info(&quot;test1 111 from log.info&quot;);\r\n    System.out.println(&quot;test 111 from print&quot;);\r\n    log.info(&quot;test1 222 from log.info&quot;);\r\n    System.out.println(&quot;test 222 from print&quot;);\r\n  }\r\n}\r\n```\r\nand the log4j2.xml\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;Configuration status=&quot;WARN&quot;&gt;\r\n  &lt;Appenders&gt;\r\n    &lt;Console name=&quot;LogToConsole&quot; target=&quot;SYSTEM_OUT&quot;&gt;\r\n      &lt;PatternLayout pattern=&quot;%d{YYYY-MM-dd HH:mm:ss} [%t] %-5p %c{1}:%L - %msg%n&quot;/&gt;\r\n    &lt;/Console&gt;\r\n  &lt;/Appenders&gt;\r\n  &lt;Loggers&gt;\r\n    &lt;Root level=&quot;info&quot;&gt;\r\n      &lt;AppenderRef ref=&quot;LogToConsole&quot;/&gt;\r\n    &lt;/Root&gt;\r\n    &lt;Logger name=&quot;com.hexagon&quot; level=&quot;debug&quot; additivity=&quot;false&quot;&gt;\r\n      &lt;AppenderRef ref=&quot;LogToConsole&quot;/&gt;\r\n    &lt;/Logger&gt;\r\n  &lt;/Loggers&gt;\r\n&lt;/Configuration&gt;\r\n```\r\n\r\nMy question is, when I run it using `mvn test`, I can only see the logs from @Test function, while I don&#39;t see the logs from @BeforeAll and @BeforeEach, why and how to enable it?\r\n\r\n```\r\n-------------------------------------------------------\r\n T E S T S\r\n-------------------------------------------------------\r\nRunning TestDemo\r\n2023-01-05 09:28:03 [main] INFO  TestDemo:29 - test1 111 from log.info\r\ntest 111 from print\r\n2023-01-05 09:28:03 [main] INFO  TestDemo:31 - test1 222 from log.info\r\ntest 222 from print\r\nTests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec\r\n\r\nResults :\r\n\r\nTests run: 1, Failures: 0, Errors: 0, Skipped: 0\r\n\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] BUILD SUCCESS\r\n```","title":"mvn test + JUnit5 + log4j: Why logs printed in @BeforeAll and @BeforeEach are not output to console?","body":"<p>I create a simple maven project to describe my problem</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n  &lt;groupId&gt;org.example&lt;/groupId&gt;\n  &lt;artifactId&gt;NoLog&lt;/artifactId&gt;\n  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n  &lt;properties&gt;\n    &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt;\n    &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt;\n    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n  &lt;/properties&gt;\n  &lt;dependencies&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n      &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\n      &lt;version&gt;5.9.0&lt;/version&gt;\n      &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n      &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n      &lt;version&gt;1.2&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n      &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;\n      &lt;version&gt;2.19.0&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n      &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\n      &lt;version&gt;2.19.0&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n      &lt;artifactId&gt;log4j-jcl&lt;/artifactId&gt;\n      &lt;version&gt;2.19.0&lt;/version&gt;\n    &lt;/dependency&gt;\n  &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre>\n<p>my test class code</p>\n<pre><code>import org.apache.logging.log4j.LogManager;\nimport org.apache.logging.log4j.Logger;\nimport org.junit.jupiter.api.BeforeAll;\nimport org.junit.jupiter.api.BeforeEach;\nimport org.junit.jupiter.api.Test;\n\npublic class TestDemo {\n\n  static Logger log = LogManager.getLogger(TestDemo.class);\n  @BeforeAll\n  public static void setupClass() {\n    log.info(&quot;BeforeAll 111 from log.info&quot;);\n    System.out.println(&quot;BeforeAll 111 from print&quot;);\n    log.info(&quot;BeforeAll 222 from log.info&quot;);\n    System.out.println(&quot;BeforeAll 222 from print&quot;);\n  }\n\n  @BeforeEach\n  public void setup() {\n    log.info(&quot;BeforeEach 111 from log.info&quot;);\n    System.out.println(&quot;BeforeEach 111 from print&quot;);\n    log.info(&quot;BeforeEach 222 from log.info&quot;);\n    System.out.println(&quot;BeforeEach 222 from print&quot;);\n  }\n\n  @Test\n  public void test1() {\n    log.info(&quot;test1 111 from log.info&quot;);\n    System.out.println(&quot;test 111 from print&quot;);\n    log.info(&quot;test1 222 from log.info&quot;);\n    System.out.println(&quot;test 222 from print&quot;);\n  }\n}\n</code></pre>\n<p>and the log4j2.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;Configuration status=&quot;WARN&quot;&gt;\n  &lt;Appenders&gt;\n    &lt;Console name=&quot;LogToConsole&quot; target=&quot;SYSTEM_OUT&quot;&gt;\n      &lt;PatternLayout pattern=&quot;%d{YYYY-MM-dd HH:mm:ss} [%t] %-5p %c{1}:%L - %msg%n&quot;/&gt;\n    &lt;/Console&gt;\n  &lt;/Appenders&gt;\n  &lt;Loggers&gt;\n    &lt;Root level=&quot;info&quot;&gt;\n      &lt;AppenderRef ref=&quot;LogToConsole&quot;/&gt;\n    &lt;/Root&gt;\n    &lt;Logger name=&quot;com.hexagon&quot; level=&quot;debug&quot; additivity=&quot;false&quot;&gt;\n      &lt;AppenderRef ref=&quot;LogToConsole&quot;/&gt;\n    &lt;/Logger&gt;\n  &lt;/Loggers&gt;\n&lt;/Configuration&gt;\n</code></pre>\n<p>My question is, when I run it using <code>mvn test</code>, I can only see the logs from @Test function, while I don't see the logs from @BeforeAll and @BeforeEach, why and how to enable it?</p>\n<pre><code>-------------------------------------------------------\n T E S T S\n-------------------------------------------------------\nRunning TestDemo\n2023-01-05 09:28:03 [main] INFO  TestDemo:29 - test1 111 from log.info\ntest 111 from print\n2023-01-05 09:28:03 [main] INFO  TestDemo:31 - test1 222 from log.info\ntest 222 from print\nTests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec\n\nResults :\n\nTests run: 1, Failures: 0, Errors: 0, Skipped: 0\n\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n</code></pre>\n"}],"has_more":true,"quota_max":10000,"quota_remaining":9468,"page":755,"page_size":100}
