{"items":[{"tags":["java","spring","rest","openapi","springdoc"],"answers":[{"tags":[],"owner":{"account_id":1742043,"reputation":513,"user_id":1593165,"display_name":"user1593165"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684846912,"creation_date":1684846912,"answer_id":76315087,"question_id":76315011,"body_markdown":"By default springdoc serves the api documentation \r\n\r\nat /v3/api-docs in json format\r\nat /v3/api-docs.yaml in yaml format\r\n\r\nThe first is shown to as a link in swagger-ui. To have the second shown as link you need to set the following spring configuration property\r\n\r\nspringdoc.swagger-ui.url: /v3/api-docs.yaml","title":"yaml format by default in springdoc","body":"<p>By default springdoc serves the api documentation</p>\n<p>at /v3/api-docs in json format\nat /v3/api-docs.yaml in yaml format</p>\n<p>The first is shown to as a link in swagger-ui. To have the second shown as link you need to set the following spring configuration property</p>\n<p>springdoc.swagger-ui.url: /v3/api-docs.yaml</p>\n"},{"tags":[],"owner":{"account_id":11450501,"reputation":311,"user_id":8423371,"display_name":"SM. Hosseini"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684851176,"creation_date":1684851176,"answer_id":76315729,"question_id":76315011,"body_markdown":"Yes, it is possible to have Swagger link the API documentation in YAML format by default when using Springdoc.\r\n\r\nSpringdoc integrates with Swagger UI to generate API documentation, and Swagger UI supports both JSON and YAML formats. To configure Springdoc to use YAML as the default format, you can follow these steps:\r\n\r\nInclude the necessary dependencies: Make sure you have the required dependencies in your project. You need springdoc-openapi-ui for Swagger UI integration and snakeyaml for YAML support.\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.springdoc&lt;/groupId&gt;\r\n        &lt;artifactId&gt;springdoc-openapi-ui&lt;/artifactId&gt;\r\n        &lt;version&gt;1.7.0&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.yaml&lt;/groupId&gt;\r\n        &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt;\r\n        &lt;version&gt;2.0&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nConfigure Springdoc to use YAML format: In your Spring Boot application configuration, you can define a bean of type OpenAPI and configure it to produce YAML output. You can use the YamlOpenAPIResource class provided by Springdoc to generate the YAML documentation.\r\n\r\n    import io.swagger.v3.oas.models.OpenAPI;\r\n    import org.springdoc.core.SwaggerUiConfigParameters;\r\n    import org.springdoc.core.SwaggerUiConfigParametersBuilder;\r\n    import org.springdoc.core.SwaggerUiConfigProperties;\r\n    \r\n    @Configuration\r\n    public class SwaggerConfiguration {\r\n    \r\n        @Bean\r\n        public OpenAPI openAPI() {\r\n            return new OpenAPI();\r\n        }\r\n    \r\n        @Bean\r\n        public SwaggerUiConfigParameters swaggerUiConfigParameters() {\r\n            SwaggerUiConfigProperties properties = new SwaggerUiConfigProperties();\r\n            properties.setConfigUrl(&quot;/v3/api-docs.yaml&quot;); // Set the YAML URL as the default\r\n    \r\n            return new SwaggerUiConfigParametersBuilder(properties).build();\r\n        }\r\n    }\r\n\r\nIn this configuration, setConfigUrl() is used to set the default URL for the Swagger UI configuration. By setting it to &quot;/v3/api-docs.yaml&quot;, it tells Swagger UI to load the documentation in YAML format by default.\r\n\r\nGenerate and access the YAML documentation: Start your application, and you can access the API documentation in YAML format by navigating to the following URL:\r\n\r\nbash\r\n\r\n    http://localhost:8080/swagger-ui/index.html?configUrl=/v3/api-docs.yaml\r\n\r\nThis URL will load Swagger UI with the API documentation in YAML format.\r\n\r\nNote: The configUrl parameter is used to specify the URL of the Swagger configuration file. In this case, it points to the YAML file generated by Springdoc.\r\n\r\n","title":"yaml format by default in springdoc","body":"<p>Yes, it is possible to have Swagger link the API documentation in YAML format by default when using Springdoc.</p>\n<p>Springdoc integrates with Swagger UI to generate API documentation, and Swagger UI supports both JSON and YAML formats. To configure Springdoc to use YAML as the default format, you can follow these steps:</p>\n<p>Include the necessary dependencies: Make sure you have the required dependencies in your project. You need springdoc-openapi-ui for Swagger UI integration and snakeyaml for YAML support.</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springdoc&lt;/groupId&gt;\n    &lt;artifactId&gt;springdoc-openapi-ui&lt;/artifactId&gt;\n    &lt;version&gt;1.7.0&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.yaml&lt;/groupId&gt;\n    &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt;\n    &lt;version&gt;2.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Configure Springdoc to use YAML format: In your Spring Boot application configuration, you can define a bean of type OpenAPI and configure it to produce YAML output. You can use the YamlOpenAPIResource class provided by Springdoc to generate the YAML documentation.</p>\n<pre><code>import io.swagger.v3.oas.models.OpenAPI;\nimport org.springdoc.core.SwaggerUiConfigParameters;\nimport org.springdoc.core.SwaggerUiConfigParametersBuilder;\nimport org.springdoc.core.SwaggerUiConfigProperties;\n\n@Configuration\npublic class SwaggerConfiguration {\n\n    @Bean\n    public OpenAPI openAPI() {\n        return new OpenAPI();\n    }\n\n    @Bean\n    public SwaggerUiConfigParameters swaggerUiConfigParameters() {\n        SwaggerUiConfigProperties properties = new SwaggerUiConfigProperties();\n        properties.setConfigUrl(&quot;/v3/api-docs.yaml&quot;); // Set the YAML URL as the default\n\n        return new SwaggerUiConfigParametersBuilder(properties).build();\n    }\n}\n</code></pre>\n<p>In this configuration, setConfigUrl() is used to set the default URL for the Swagger UI configuration. By setting it to &quot;/v3/api-docs.yaml&quot;, it tells Swagger UI to load the documentation in YAML format by default.</p>\n<p>Generate and access the YAML documentation: Start your application, and you can access the API documentation in YAML format by navigating to the following URL:</p>\n<p>bash</p>\n<pre><code>http://localhost:8080/swagger-ui/index.html?configUrl=/v3/api-docs.yaml\n</code></pre>\n<p>This URL will load Swagger UI with the API documentation in YAML format.</p>\n<p>Note: The configUrl parameter is used to specify the URL of the Swagger configuration file. In this case, it points to the YAML file generated by Springdoc.</p>\n"}],"owner":{"account_id":1742043,"reputation":513,"user_id":1593165,"display_name":"user1593165"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":399,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1684851176,"creation_date":1684846680,"question_id":76315011,"body_markdown":"Using springdoc is it possibile to have swagger link the api documentation in yaml format by default?\r\n\r\nBy default springdoc have swagger link the api documentation in json format. Sometimes it&#39;s desirable to have the documentation in yaml format by default.","title":"yaml format by default in springdoc","body":"<p>Using springdoc is it possibile to have swagger link the api documentation in yaml format by default?</p>\n<p>By default springdoc have swagger link the api documentation in json format. Sometimes it's desirable to have the documentation in yaml format by default.</p>\n"},{"tags":["java","spring-boot","basic-authentication","hashicorp-vault"],"comments":[{"owner":{"account_id":446597,"reputation":22464,"user_id":839733,"accept_rate":69,"display_name":"Abhijit Sarkar"},"score":0,"creation_date":1684840411,"post_id":76314045,"comment_id":134572860,"body_markdown":"How are you measuring? Did you time the two implementations of `AuthenticationProvider` or end-to-end request-response time?","body":"How are you measuring? Did you time the two implementations of <code>AuthenticationProvider</code> or end-to-end request-response time?"},{"owner":{"account_id":1118598,"reputation":556,"user_id":2462719,"accept_rate":83,"display_name":"AcidHawk"},"score":0,"creation_date":1684842473,"post_id":76314045,"comment_id":134573365,"body_markdown":"Ahh good question.  I did nothing as elaborate as that.  I was simply looking at the response time in postman when I ran my tests against myApp.  The reason I am looking at the authentication is that if I turn off all authentication the transactions complete in under 10ms.  When I enable Basic Authentication directly to the vault I see request-response times of 375ms and when I use the InMemoryUserDetailsManager and not direct calls to Vault I see very similar request-response times of 370ms.  I thought it would be more with an InMemory data structure.","body":"Ahh good question.  I did nothing as elaborate as that.  I was simply looking at the response time in postman when I ran my tests against myApp.  The reason I am looking at the authentication is that if I turn off all authentication the transactions complete in under 10ms.  When I enable Basic Authentication directly to the vault I see request-response times of 375ms and when I use the InMemoryUserDetailsManager and not direct calls to Vault I see very similar request-response times of 370ms.  I thought it would be more with an InMemory data structure."},{"owner":{"account_id":9531412,"reputation":2010,"user_id":7082956,"display_name":"Valerij Dobler"},"score":0,"creation_date":1684851854,"post_id":76314045,"comment_id":134575751,"body_markdown":"Your screenshots suggests a &lt;1% difference.","body":"Your screenshots suggests a &lt;1% difference."},{"owner":{"account_id":1118598,"reputation":556,"user_id":2462719,"accept_rate":83,"display_name":"AcidHawk"},"score":0,"creation_date":1684909945,"post_id":76314045,"comment_id":134584437,"body_markdown":"@ValerijDobler - Exactly.  That is what I am saying.  When making the call to a Vault on a remote machine compared to making the call to an InMemoryUserDetailsManager shouldn&#39;t the call to memory be significantly quicker than the call to the Vault?","body":"@ValerijDobler - Exactly.  That is what I am saying.  When making the call to a Vault on a remote machine compared to making the call to an InMemoryUserDetailsManager shouldn&#39;t the call to memory be significantly quicker than the call to the Vault?"},{"owner":{"account_id":9531412,"reputation":2010,"user_id":7082956,"display_name":"Valerij Dobler"},"score":0,"creation_date":1684926433,"post_id":76314045,"comment_id":134588051,"body_markdown":"Is the call being made at the time of the recording? Can you observe it at the serving side?","body":"Is the call being made at the time of the recording? Can you observe it at the serving side?"}],"owner":{"account_id":1118598,"reputation":556,"user_id":2462719,"accept_rate":83,"display_name":"AcidHawk"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":176,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1684851035,"creation_date":1684840029,"question_id":76314045,"body_markdown":"I was playing around with a little Spring Boot application that uses Hashicorp Vault. I wanted to implement Basic Authentication and wondered if I could keep the users details in the vault.  There will never be many users for this app perhaps 5 - 10 different users.  As the vault is used for other things I wanted to avoid having to keep the users in a separate database somewhere.  \r\n\r\nThe vault has kv (v1) engine which contains the username, a Bcrypt encoded password and the Roles of the user.\r\n\r\nWhen a user logins into this app it does a lookup for the provided username in the vault and compares the password provided (which is BCrypt encoded) with the encoded password string from the vault and if authenticated collects the Roles etc etc...\r\n\r\nSomething like this.\r\n\r\nI include this into my POM file\r\n```xml\r\n&lt;dependency&gt;\r\n   &lt;groupId&gt;org.springframework.vault&lt;/groupId&gt;\r\n   &lt;artifactId&gt;spring-vault-core&lt;/artifactId&gt;\r\n   &lt;version&gt;3.0.2&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```\r\n\r\nA simple User POJO\r\n```java\r\npublic class VaultBasicUser {\r\n    private String password;\r\n    private String roles;\r\n\r\n    public String getPassword() {\r\n        return password;\r\n    }\r\n\r\n    public void setPassword(String password) {\r\n        this.password = password;\r\n    }\r\n\r\n    public String getRoles() {\r\n        return roles;\r\n    }\r\n\r\n    public void setRoles(String roles) {\r\n        this.roles = roles;\r\n    }\r\n}\r\n```\r\n\r\nMy Custom Authentication Provider\r\n```java\r\n@Slf4j\r\n@Component\r\npublic class BasicVaultAuthentication implements AuthenticationProvider {\r\n\r\n    @Autowired\r\n    private VaultTemplate vaultTemplate;\r\n    \r\n    @Override\r\n    public Authentication authenticate(Authentication authentication) throws AuthenticationException {\r\n        \r\n        String name = authentication.getName();\r\n        String password = authentication.getCredentials().toString();\r\n        \r\n        VaultResponseSupport&lt;VaultBasicUser&gt; vaultResponse = vaultTemplate.read(&quot;myApp/users/&quot; + name, VaultBasicUser.class);\r\n        \r\n        String vaultSecret = vaultResponse.getData().getPassword();\r\n        \r\n        if (vaultSecret != null) {\r\n            if (BCrypt.checkpw(password, vaultSecret)) {\r\n        \r\n                String vaultRoles = vaultResponse.getData().getRoles();\r\n                        \r\n                List&lt;GrantedAuthority&gt; roles = new ArrayList&lt;&gt;();\r\n                \r\n                String[] stringOfRoles = vaultRoles.split(&quot;,&quot;);\r\n                for (String singleRole : stringOfRoles) {\r\n                    roles.add(new SimpleGrantedAuthority(singleRole.replaceAll(&quot;\\s&quot;, &quot;&quot;)));\r\n                }\r\n                \r\n                UserDetails principal = new User(name, password, roles);\r\n                Authentication auth = new UsernamePasswordAuthenticationToken(principal, password, roles);\r\n                return auth;\r\n            }\r\n            else {\r\n                log.info(&quot;Incorrect Credentials (Password)&quot;);\r\n                return null;\r\n            }\r\n        }\r\n        else {\r\n            log.info(&quot;Incorrect Credentials (User Not found in Vault)&quot;);\r\n            return null;\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public boolean supports(Class&lt;?&gt; authentication) {\r\n        return authentication.equals(UsernamePasswordAuthenticationToken.class\r\n        );\r\n    }\r\n```\r\n\r\nThis works, however when testing I noticed that each transaction&#39;s authentication was taking about 375ms to process.  I wondered if I change my strategy a little if I could reduce the 375ms for the authentication.\r\n\r\nSo I thought perhaps I could populate an InMemoryUserDetailsManager at startup and then the users will be in memory so the authentication part won&#39;t rely on API calls to the Vault for each transaction thereby reducing the time for authentication.\r\n\r\nI tried something like this:\r\n```java\r\n@Bean\r\n    public UserDetailsService userDetailsService(PasswordEncoder encoder) {\r\n        \r\n        Collection&lt;UserDetails&gt; allUsers = new ArrayList();\r\n\r\n        log.info(&quot;Collecting MyApp users from Vault: &quot; + vaultConfig.getUrl());\r\n\r\n        // ***** Get All users from Vault HERE ***** \r\n            VaultEndpoint vaultEndpoint;\r\n            try {\r\n                vaultEndpoint = VaultEndpoint.from(new URI(vaultConfig.getUrl()));\r\n                VaultTemplate vaultTemplate = new VaultTemplate(vaultEndpoint, new TokenAuthentication(vaultConfig.getToken()));\r\n                List&lt;String&gt; vaultUsers = vaultTemplate.list(&quot;myApp/users&quot;);\r\n\r\n                for (String vaultUser : vaultUsers) {\r\n                    VaultResponseSupport&lt;VaultBasicUser&gt; vaultResponse = vaultTemplate.read(&quot;myApp/users/&quot; + vaultUser, VaultBasicUser.class);\r\n                    String password = vaultResponse.getData().getPassword();\r\n                    String vaultRoles = vaultResponse.getData().getRoles();\r\n                    \r\n                    log.info(&quot;Adding User: [&quot; + vaultUser + &quot;, &quot; + password + &quot;, &quot; + vaultRoles + &quot;]&quot;);\r\n                    allUsers.add(User.withUsername(vaultUser).password(password).roles(vaultRoles).build());\r\n                }\r\n\r\n            } catch (URISyntaxException ex) {\r\n                log.error(&quot;Unable to read in MyApp users from Vault: &quot; + ex.getMessage());\r\n                log.info(&quot;Adding some Default Users...&quot;);\r\n                allUsers.add(User.withUsername(&quot;myapp_admin&quot;).password(encoder.encode(&quot;adminPassword&quot;)).roles(&quot;MYADMIN&quot;).build());\r\n                allUsers.add(User.withUsername(&quot;myapp_poweruser&quot;).password(encoder.encode(&quot;powerUserPassword&quot;)).roles(&quot;MYELEVATED&quot;).build());\r\n                allUsers.add(User.withUsername(&quot;myapp_client&quot;).password(encoder.encode(&quot;clientPassword&quot;)).roles(&quot;MYUSER&quot;).build());\r\n            }\r\n        } else {\r\n            log.info(&quot;Authentication configured for [&quot; + authType.getType() + &quot;] - Not connecting to Vault!&quot;);\r\n        }\r\n\r\n        return new InMemoryUserDetailsManager(allUsers);\r\n    }\r\n```\r\n\r\nHowever, when I run the same test the authentication still takes approximately 370ms.  Is my thinking totally wrong here?  Shouldn&#39;t retrieving the user details from memory be faster than getting them from the vault directly?  Have I got a problem somewhere else?\r\n\r\n**Edit #1:** Added some screenshots of using the Profiler in Netbeans.\r\n\r\nThis image is of using the BasicVaultAuthentication Custom Authentication Provider (This is where the call to the Vault happens right before the BCrypt.checkpw)\r\n\r\n[![enter image description here][1]][1]\r\n\r\nThis picture is using the InMemoryUserDetailsManager However the authentication should be against the users that have been loaded into memory.\r\n\r\n[![enter image description here][2]][2]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/2fcyg.png\r\n  [2]: https://i.stack.imgur.com/XyMJ0.png","title":"Spring boot using Hashicorp Vault for Basic Authentication","body":"<p>I was playing around with a little Spring Boot application that uses Hashicorp Vault. I wanted to implement Basic Authentication and wondered if I could keep the users details in the vault.  There will never be many users for this app perhaps 5 - 10 different users.  As the vault is used for other things I wanted to avoid having to keep the users in a separate database somewhere.</p>\n<p>The vault has kv (v1) engine which contains the username, a Bcrypt encoded password and the Roles of the user.</p>\n<p>When a user logins into this app it does a lookup for the provided username in the vault and compares the password provided (which is BCrypt encoded) with the encoded password string from the vault and if authenticated collects the Roles etc etc...</p>\n<p>Something like this.</p>\n<p>I include this into my POM file</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n   &lt;groupId&gt;org.springframework.vault&lt;/groupId&gt;\n   &lt;artifactId&gt;spring-vault-core&lt;/artifactId&gt;\n   &lt;version&gt;3.0.2&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>A simple User POJO</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class VaultBasicUser {\n    private String password;\n    private String roles;\n\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public String getRoles() {\n        return roles;\n    }\n\n    public void setRoles(String roles) {\n        this.roles = roles;\n    }\n}\n</code></pre>\n<p>My Custom Authentication Provider</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Slf4j\n@Component\npublic class BasicVaultAuthentication implements AuthenticationProvider {\n\n    @Autowired\n    private VaultTemplate vaultTemplate;\n    \n    @Override\n    public Authentication authenticate(Authentication authentication) throws AuthenticationException {\n        \n        String name = authentication.getName();\n        String password = authentication.getCredentials().toString();\n        \n        VaultResponseSupport&lt;VaultBasicUser&gt; vaultResponse = vaultTemplate.read(&quot;myApp/users/&quot; + name, VaultBasicUser.class);\n        \n        String vaultSecret = vaultResponse.getData().getPassword();\n        \n        if (vaultSecret != null) {\n            if (BCrypt.checkpw(password, vaultSecret)) {\n        \n                String vaultRoles = vaultResponse.getData().getRoles();\n                        \n                List&lt;GrantedAuthority&gt; roles = new ArrayList&lt;&gt;();\n                \n                String[] stringOfRoles = vaultRoles.split(&quot;,&quot;);\n                for (String singleRole : stringOfRoles) {\n                    roles.add(new SimpleGrantedAuthority(singleRole.replaceAll(&quot;\\s&quot;, &quot;&quot;)));\n                }\n                \n                UserDetails principal = new User(name, password, roles);\n                Authentication auth = new UsernamePasswordAuthenticationToken(principal, password, roles);\n                return auth;\n            }\n            else {\n                log.info(&quot;Incorrect Credentials (Password)&quot;);\n                return null;\n            }\n        }\n        else {\n            log.info(&quot;Incorrect Credentials (User Not found in Vault)&quot;);\n            return null;\n        }\n    }\n\n    @Override\n    public boolean supports(Class&lt;?&gt; authentication) {\n        return authentication.equals(UsernamePasswordAuthenticationToken.class\n        );\n    }\n</code></pre>\n<p>This works, however when testing I noticed that each transaction's authentication was taking about 375ms to process.  I wondered if I change my strategy a little if I could reduce the 375ms for the authentication.</p>\n<p>So I thought perhaps I could populate an InMemoryUserDetailsManager at startup and then the users will be in memory so the authentication part won't rely on API calls to the Vault for each transaction thereby reducing the time for authentication.</p>\n<p>I tried something like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\n    public UserDetailsService userDetailsService(PasswordEncoder encoder) {\n        \n        Collection&lt;UserDetails&gt; allUsers = new ArrayList();\n\n        log.info(&quot;Collecting MyApp users from Vault: &quot; + vaultConfig.getUrl());\n\n        // ***** Get All users from Vault HERE ***** \n            VaultEndpoint vaultEndpoint;\n            try {\n                vaultEndpoint = VaultEndpoint.from(new URI(vaultConfig.getUrl()));\n                VaultTemplate vaultTemplate = new VaultTemplate(vaultEndpoint, new TokenAuthentication(vaultConfig.getToken()));\n                List&lt;String&gt; vaultUsers = vaultTemplate.list(&quot;myApp/users&quot;);\n\n                for (String vaultUser : vaultUsers) {\n                    VaultResponseSupport&lt;VaultBasicUser&gt; vaultResponse = vaultTemplate.read(&quot;myApp/users/&quot; + vaultUser, VaultBasicUser.class);\n                    String password = vaultResponse.getData().getPassword();\n                    String vaultRoles = vaultResponse.getData().getRoles();\n                    \n                    log.info(&quot;Adding User: [&quot; + vaultUser + &quot;, &quot; + password + &quot;, &quot; + vaultRoles + &quot;]&quot;);\n                    allUsers.add(User.withUsername(vaultUser).password(password).roles(vaultRoles).build());\n                }\n\n            } catch (URISyntaxException ex) {\n                log.error(&quot;Unable to read in MyApp users from Vault: &quot; + ex.getMessage());\n                log.info(&quot;Adding some Default Users...&quot;);\n                allUsers.add(User.withUsername(&quot;myapp_admin&quot;).password(encoder.encode(&quot;adminPassword&quot;)).roles(&quot;MYADMIN&quot;).build());\n                allUsers.add(User.withUsername(&quot;myapp_poweruser&quot;).password(encoder.encode(&quot;powerUserPassword&quot;)).roles(&quot;MYELEVATED&quot;).build());\n                allUsers.add(User.withUsername(&quot;myapp_client&quot;).password(encoder.encode(&quot;clientPassword&quot;)).roles(&quot;MYUSER&quot;).build());\n            }\n        } else {\n            log.info(&quot;Authentication configured for [&quot; + authType.getType() + &quot;] - Not connecting to Vault!&quot;);\n        }\n\n        return new InMemoryUserDetailsManager(allUsers);\n    }\n</code></pre>\n<p>However, when I run the same test the authentication still takes approximately 370ms.  Is my thinking totally wrong here?  Shouldn't retrieving the user details from memory be faster than getting them from the vault directly?  Have I got a problem somewhere else?</p>\n<p><strong>Edit #1:</strong> Added some screenshots of using the Profiler in Netbeans.</p>\n<p>This image is of using the BasicVaultAuthentication Custom Authentication Provider (This is where the call to the Vault happens right before the BCrypt.checkpw)</p>\n<p><a href=\"https://i.stack.imgur.com/2fcyg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2fcyg.png\" alt=\"enter image description here\" /></a></p>\n<p>This picture is using the InMemoryUserDetailsManager However the authentication should be against the users that have been loaded into memory.</p>\n<p><a href=\"https://i.stack.imgur.com/XyMJ0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XyMJ0.png\" alt=\"enter image description here\" /></a></p>\n"},{"tags":["java","jpa","annotations","one-to-one"],"comments":[{"owner":{"account_id":231721,"reputation":20460,"user_id":496099,"display_name":"Chris"},"score":0,"creation_date":1684522163,"post_id":76291469,"comment_id":134534751,"body_markdown":"Why are you using PrimaryKeyJoinColumn instead of @MapsId? Try it instead and remove the mappedby- mappedby means the other side has the foreign key or at least defines the relationship which isn’t the case here. Do you really have both a customer_id and a separate appraised_for column or should that too be a single relation to the customer table?","body":"Why are you using PrimaryKeyJoinColumn instead of @MapsId? Try it instead and remove the mappedby- mappedby means the other side has the foreign key or at least defines the relationship which isn’t the case here. Do you really have both a customer_id and a separate appraised_for column or should that too be a single relation to the customer table?"},{"owner":{"account_id":5322173,"reputation":325,"user_id":4245323,"accept_rate":60,"display_name":"Rob Gravelle"},"score":0,"creation_date":1684588445,"post_id":76291469,"comment_id":134540766,"body_markdown":"@Chris, I removed the PrimaryKeyJoinColumn and renamed the customer_id column: @Column(name=&quot;appraised_for&quot;, insertable=false, updatable=false).","body":"@Chris, I removed the PrimaryKeyJoinColumn and renamed the customer_id column: @Column(name=&quot;appraised_for&quot;, insertable=false, updatable=false)."}],"answers":[{"tags":[],"owner":{"account_id":231721,"reputation":20460,"user_id":496099,"display_name":"Chris"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1684850908,"creation_date":1684850908,"answer_id":76315683,"question_id":76291469,"body_markdown":"Since you have a composite primary key mapped in the entity that references other entities, you might want to let JPA handle the foreign key values directly so you don&#39;t have to set them yourself. With JPA 2.0 and beyond, you can mark relationship with @Id or if using basic/embeddableId mappings for the identifiers, tell JPA that the relationship controls the mapping using @MapsId instead:\r\n\r\n    @Entity\r\n    @Table(name = &quot;appraisal&quot;)\r\n    @IdClass(AppraisalId.class)\r\n    public class Appraisal {\r\n        \r\n        @Id\r\n        private Long vehicleId;\r\n        \r\n        @MapsId(&quot;vehicleId&quot;)\r\n        @OneToOne\r\n        @JoinColumn(name=&quot;vehicle_id&quot;)\r\n        private Vehicle vehicle;\r\n        \r\n        @Id\r\n        private Long customerId;\r\n        \r\n        @MapsId(&quot;customerId&quot;)\r\n        @OneToOne\r\n        @JoinColumn(name=&quot;appraised_for&quot;, referencedColumnName=&quot;id&quot;)\r\n        private Customer customer;\r\n        \r\n        ..\r\n    }","title":"How to create a one-to-one relationship between two entities on a PK using JPA?","body":"<p>Since you have a composite primary key mapped in the entity that references other entities, you might want to let JPA handle the foreign key values directly so you don't have to set them yourself. With JPA 2.0 and beyond, you can mark relationship with @Id or if using basic/embeddableId mappings for the identifiers, tell JPA that the relationship controls the mapping using @MapsId instead:</p>\n<pre><code>@Entity\n@Table(name = &quot;appraisal&quot;)\n@IdClass(AppraisalId.class)\npublic class Appraisal {\n    \n    @Id\n    private Long vehicleId;\n    \n    @MapsId(&quot;vehicleId&quot;)\n    @OneToOne\n    @JoinColumn(name=&quot;vehicle_id&quot;)\n    private Vehicle vehicle;\n    \n    @Id\n    private Long customerId;\n    \n    @MapsId(&quot;customerId&quot;)\n    @OneToOne\n    @JoinColumn(name=&quot;appraised_for&quot;, referencedColumnName=&quot;id&quot;)\n    private Customer customer;\n    \n    ..\n}\n</code></pre>\n"}],"owner":{"account_id":5322173,"reputation":325,"user_id":4245323,"accept_rate":60,"display_name":"Rob Gravelle"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":32,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76315683,"answer_count":1,"score":0,"last_activity_date":1684850908,"creation_date":1684519110,"question_id":76291469,"body_markdown":"I&#39;m trying to link two entities using JPA via a one-to-one relationship, but I&#39;m getting a &quot;referenced property unknown&quot; error one one of the classes.  Here is a diagram of the two entities in question:\r\n\r\n[![Model diagram][1]][1]\r\n\r\nThe vehicle_id column of the appraisal table links to the id of the vehicle. For that reason, I added the @PrimaryKeyJoinColumn annotation in the Appraisal class:\r\n\r\n    @Entity\r\n    @Table(name = &quot;appraisal&quot;)\r\n    @Data\r\n    @IdClass(AppraisalId.class)\r\n    public class Appraisal {\r\n    \t\r\n    \t@Id\r\n    \t@Column(name=&quot;vehicle_id&quot;)\r\n        private Long vehicleId;\r\n    \t\r\n    \t@PrimaryKeyJoinColumn\r\n    \t@OneToOne(mappedBy = &quot;appraisal&quot;)\r\n    \tprivate Vehicle vehicle;\r\n    \t\r\n    \t@Id\r\n    \t@Column(name=&quot;customer_id&quot;)\r\n        private Long customerId;\r\n    \t\r\n    \t@OneToOne\r\n    \t@JoinColumn(name=&quot;appraised_for&quot;, referencedColumnName=&quot;id&quot;)\r\n    \tprivate Customer customer;\r\n    \t\r\n    \t//1 column omitted for brevity\r\n    }\r\n\r\nNotice that the Appraisal class uses a composite PK.  Here is the AppraisalId class:\r\n\r\n    @Data\r\n    public class AppraisalId implements Serializable {\r\n    \t\r\n    \tprivate static final long serialVersionUID = -5373569618334807665L;\r\n    \t\r\n    \tprivate Long vehicleId;\r\n    \tprivate Long customerId;\r\n    \r\n    }\r\n\r\nHere&#39;s the Vehicle class:\r\n\r\n    @Entity\r\n    @Table(name = &quot;vehicle&quot;)\r\n    @Getter\r\n    @Setter\r\n    public class Vehicle {\r\n    \t\r\n    \t@Id\r\n        @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n        @Column(name=&quot;id&quot;)\r\n        private Long id;\r\n    \t\r\n    \t@OneToOne(mappedBy = &quot;vehicle&quot;)\r\n        private Appraisal appraisal;\r\n    \t\r\n    \t//other columns omitted for brevity\r\n    }\r\n\r\nNote that I&#39;m using the Lombok @Data annotation to generate getters and setters.\r\n\r\nThe exact error is &quot;Unknown mappedBy in: ca.allauto.ups.model.Appraisal.vehicle, referenced property unknown: ca.allauto.ups.model.Vehicle.appraisal&quot;.\r\n\r\n**Any ideas what I&#39;m doing wrong?**\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/8RFHN.png","title":"How to create a one-to-one relationship between two entities on a PK using JPA?","body":"<p>I'm trying to link two entities using JPA via a one-to-one relationship, but I'm getting a &quot;referenced property unknown&quot; error one one of the classes.  Here is a diagram of the two entities in question:</p>\n<p><a href=\"https://i.stack.imgur.com/8RFHN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8RFHN.png\" alt=\"Model diagram\" /></a></p>\n<p>The vehicle_id column of the appraisal table links to the id of the vehicle. For that reason, I added the @PrimaryKeyJoinColumn annotation in the Appraisal class:</p>\n<pre><code>@Entity\n@Table(name = &quot;appraisal&quot;)\n@Data\n@IdClass(AppraisalId.class)\npublic class Appraisal {\n    \n    @Id\n    @Column(name=&quot;vehicle_id&quot;)\n    private Long vehicleId;\n    \n    @PrimaryKeyJoinColumn\n    @OneToOne(mappedBy = &quot;appraisal&quot;)\n    private Vehicle vehicle;\n    \n    @Id\n    @Column(name=&quot;customer_id&quot;)\n    private Long customerId;\n    \n    @OneToOne\n    @JoinColumn(name=&quot;appraised_for&quot;, referencedColumnName=&quot;id&quot;)\n    private Customer customer;\n    \n    //1 column omitted for brevity\n}\n</code></pre>\n<p>Notice that the Appraisal class uses a composite PK.  Here is the AppraisalId class:</p>\n<pre><code>@Data\npublic class AppraisalId implements Serializable {\n    \n    private static final long serialVersionUID = -5373569618334807665L;\n    \n    private Long vehicleId;\n    private Long customerId;\n\n}\n</code></pre>\n<p>Here's the Vehicle class:</p>\n<pre><code>@Entity\n@Table(name = &quot;vehicle&quot;)\n@Getter\n@Setter\npublic class Vehicle {\n    \n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name=&quot;id&quot;)\n    private Long id;\n    \n    @OneToOne(mappedBy = &quot;vehicle&quot;)\n    private Appraisal appraisal;\n    \n    //other columns omitted for brevity\n}\n</code></pre>\n<p>Note that I'm using the Lombok @Data annotation to generate getters and setters.</p>\n<p>The exact error is &quot;Unknown mappedBy in: ca.allauto.ups.model.Appraisal.vehicle, referenced property unknown: ca.allauto.ups.model.Vehicle.appraisal&quot;.</p>\n<p><strong>Any ideas what I'm doing wrong?</strong></p>\n"},{"tags":["java","indexing","lucene"],"comments":[{"owner":{"account_id":12743722,"reputation":19966,"user_id":12567365,"display_name":"andrewJames"},"score":1,"creation_date":1684767479,"post_id":76306857,"comment_id":134561134,"body_markdown":"Not an answer,just a couple of observations: (1) For Lucene 9.6.0, you need to use [`lucene-analysis-common`](https://mvnrepository.com/artifact/org.apache.lucene/lucene-analysis-common). The package was renamed from `analyzers` to `analysis`. Don&#39;t mix different JAR versions. (2) The sort you are trying to implement is the default sort order (by score, highest to lowest) - so you can remove it and get the required result (as you mention in the question).","body":"Not an answer,just a couple of observations: (1) For Lucene 9.6.0, you need to use <a href=\"https://mvnrepository.com/artifact/org.apache.lucene/lucene-analysis-common\" rel=\"nofollow noreferrer\"><code>lucene-analysis-common</code></a>. The package was renamed from <code>analyzers</code> to <code>analysis</code>. Don&#39;t mix different JAR versions. (2) The sort you are trying to implement is the default sort order (by score, highest to lowest) - so you can remove it and get the required result (as you mention in the question)."},{"owner":{"account_id":12743722,"reputation":19966,"user_id":12567365,"display_name":"andrewJames"},"score":1,"creation_date":1684778699,"post_id":76306857,"comment_id":134563564,"body_markdown":"Some more notes: When you do not try to use an explicit sort, you can retrieve the score from your `ScoreDoc`, which is: `doc=2 score=0.49662238 shardIndex=-1` (as you note). But when you get `NaN` the `ScoreDoc` is this:  `doc=2 score=NaN shardIndex=-1 fields=[0.49662238]`. You can see the `NaN` - but you can also see the score in the `fields` array - which looks very odd to me (but there may be an explanation). I would ask on the Lucene `java-user` mailing list - see [here](https://lucene.apache.org/core/discussion.html) for how to subscribe.","body":"Some more notes: When you do not try to use an explicit sort, you can retrieve the score from your <code>ScoreDoc</code>, which is: <code>doc=2 score=0.49662238 shardIndex=-1</code> (as you note). But when you get <code>NaN</code> the <code>ScoreDoc</code> is this:  <code>doc=2 score=NaN shardIndex=-1 fields=[0.49662238]</code>. You can see the <code>NaN</code> - but you can also see the score in the <code>fields</code> array - which looks very odd to me (but there may be an explanation). I would ask on the Lucene <code>java-user</code> mailing list - see <a href=\"https://lucene.apache.org/core/discussion.html\" rel=\"nofollow noreferrer\">here</a> for how to subscribe."},{"owner":{"account_id":1951378,"reputation":2495,"user_id":1755381,"accept_rate":48,"display_name":"Franz Deschler"},"score":0,"creation_date":1684779958,"post_id":76306857,"comment_id":134563811,"body_markdown":"Thanks @andrewJames for the hints! The `fields` property is part of the `FieldDoc` class (a subclass of `ScoreDoc`). The JavaDoc says, that it contains information about how to sort the documents. The `fields` array contains the score in THIS case, because I order by score. But it can also contain other types, depending on the type of the field-type that should be used for sorting.","body":"Thanks @andrewJames for the hints! The <code>fields</code> property is part of the <code>FieldDoc</code> class (a subclass of <code>ScoreDoc</code>). The JavaDoc says, that it contains information about how to sort the documents. The <code>fields</code> array contains the score in THIS case, because I order by score. But it can also contain other types, depending on the type of the field-type that should be used for sorting."}],"answers":[{"tags":[],"owner":{"account_id":12743722,"reputation":19966,"user_id":12567365,"display_name":"andrewJames"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1684850583,"creation_date":1684850583,"answer_id":76315631,"question_id":76306857,"body_markdown":"**Short Answer**\r\n\r\nSorting will work the way you expect, using your provided `Sort` criterion. It is equivalent to the default &quot;relevance&quot; sort order used by Lucene.\r\n\r\nYou can still access the relevance score, if you want to, by casting `ScoreDoc` to `FieldDoc`.\r\n\r\n---\r\n\r\n**Longer Answer**\r\n\r\nThe sort order defined by:\r\n\r\n    Sort sort = new Sort(SortField.FIELD_SCORE);\r\n\r\nis the same as the default sort order - which sorts by score (relevance) from highest to lowest. So, documents will be ordered in the same way in both cases.\r\n\r\nBut when you use an explicit sort, you can no longer access the score using `scoreDoc.score`, as noted in the question. Instead you only get `NaN` (not a number).\r\n\r\n    2 : NaN\r\n\r\n---\r\n\r\nHowever, you can still access the score (if you want to) by casting each `ScoreDoc` instance to a [`FieldDoc`](https://lucene.apache.org/core/9_6_0/core/org/apache/lucene/search/FieldDoc.html). We get `FieldDocs` because we have added a sort field to our search.\r\n\r\n`FieldDoc` extends `ScoreDoc`. It contains &quot;information about how to sort the referenced document&quot;.\r\n\r\nIn our case, there is only one sort field and it is the `FIELD_SCORE` value.\r\n\r\nSo, to print the score, we can change this code:\r\n\r\n```java\r\nfor (ScoreDoc scoreDoc : topDocs.scoreDocs) {\r\n    System.out.println(scoreDoc.doc + &quot; : &quot; + scoreDoc.score);\r\n}\r\n```\r\n\r\nto this:\r\n\r\n```java\r\nfor (ScoreDoc scoreDoc : topFieldDocs.scoreDocs) {\r\n    FieldDoc fieldDoc = (FieldDoc) scoreDoc;\r\n    System.out.println(scoreDoc.doc + &quot; : &quot; + fieldDoc.fields[0]);\r\n}\r\n```\r\n\r\nNow we will get the score printed, instead of `NaN`:\r\n\r\n    2 : 0.49662238\r\n\r\n**Speculation:** I may be wrong, but I assume the original `scoreDoc.score` field is `NaN` because it doesn&#39;t make sense to calculate it and store it here, given there is no guarantee that the applied search will use `SortField.FIELD_SCORE`. \r\n\r\nI expect users will mostly want to sort by something other than score - and maybe optionally use score as a tie-breaker.\r\n\r\nBut if `FIELD_SCORE` _is_ used, then the score will be available in that field, instead.\r\n\r\n---\r\n\r\nAs an aside, instead of this:\r\n\r\n    TopDocs topDocs = indexSearcher.search(query, 10, sort);\r\n\r\nYou can use this:\r\n\r\n    TopFieldDocs topFieldDocs = indexSearcher.search(query, 10, sort);\r\n\r\nThis allows us to access `SortField[]` - the fields which were used for sorting results. This includes information about field types.","title":"Apache Lucene returns NaN as score when sorting by relevance","body":"<p><strong>Short Answer</strong></p>\n<p>Sorting will work the way you expect, using your provided <code>Sort</code> criterion. It is equivalent to the default &quot;relevance&quot; sort order used by Lucene.</p>\n<p>You can still access the relevance score, if you want to, by casting <code>ScoreDoc</code> to <code>FieldDoc</code>.</p>\n<hr />\n<p><strong>Longer Answer</strong></p>\n<p>The sort order defined by:</p>\n<pre><code>Sort sort = new Sort(SortField.FIELD_SCORE);\n</code></pre>\n<p>is the same as the default sort order - which sorts by score (relevance) from highest to lowest. So, documents will be ordered in the same way in both cases.</p>\n<p>But when you use an explicit sort, you can no longer access the score using <code>scoreDoc.score</code>, as noted in the question. Instead you only get <code>NaN</code> (not a number).</p>\n<pre><code>2 : NaN\n</code></pre>\n<hr />\n<p>However, you can still access the score (if you want to) by casting each <code>ScoreDoc</code> instance to a <a href=\"https://lucene.apache.org/core/9_6_0/core/org/apache/lucene/search/FieldDoc.html\" rel=\"nofollow noreferrer\"><code>FieldDoc</code></a>. We get <code>FieldDocs</code> because we have added a sort field to our search.</p>\n<p><code>FieldDoc</code> extends <code>ScoreDoc</code>. It contains &quot;information about how to sort the referenced document&quot;.</p>\n<p>In our case, there is only one sort field and it is the <code>FIELD_SCORE</code> value.</p>\n<p>So, to print the score, we can change this code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>for (ScoreDoc scoreDoc : topDocs.scoreDocs) {\n    System.out.println(scoreDoc.doc + &quot; : &quot; + scoreDoc.score);\n}\n</code></pre>\n<p>to this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>for (ScoreDoc scoreDoc : topFieldDocs.scoreDocs) {\n    FieldDoc fieldDoc = (FieldDoc) scoreDoc;\n    System.out.println(scoreDoc.doc + &quot; : &quot; + fieldDoc.fields[0]);\n}\n</code></pre>\n<p>Now we will get the score printed, instead of <code>NaN</code>:</p>\n<pre><code>2 : 0.49662238\n</code></pre>\n<p><strong>Speculation:</strong> I may be wrong, but I assume the original <code>scoreDoc.score</code> field is <code>NaN</code> because it doesn't make sense to calculate it and store it here, given there is no guarantee that the applied search will use <code>SortField.FIELD_SCORE</code>.</p>\n<p>I expect users will mostly want to sort by something other than score - and maybe optionally use score as a tie-breaker.</p>\n<p>But if <code>FIELD_SCORE</code> <em>is</em> used, then the score will be available in that field, instead.</p>\n<hr />\n<p>As an aside, instead of this:</p>\n<pre><code>TopDocs topDocs = indexSearcher.search(query, 10, sort);\n</code></pre>\n<p>You can use this:</p>\n<pre><code>TopFieldDocs topFieldDocs = indexSearcher.search(query, 10, sort);\n</code></pre>\n<p>This allows us to access <code>SortField[]</code> - the fields which were used for sorting results. This includes information about field types.</p>\n"}],"owner":{"account_id":1951378,"reputation":2495,"user_id":1755381,"accept_rate":48,"display_name":"Franz Deschler"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":121,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76315631,"answer_count":1,"score":1,"last_activity_date":1684850583,"creation_date":1684763222,"question_id":76306857,"body_markdown":"I want to order the results of my Apache Lucene search by relevance. But when I use `SortField.FIELD_SCORE` for sorting, the score of the resulting documents is always `NaN`.\r\nWhen I omit the sort parameter, the search works perfectly fine, and the result documents contain a valid score.\r\n\r\nI use `lucene-core 9.6.0` and `lucene-analyzers-common 8.11.2` which are the most up to date versions in the Maven repository right now.\r\n\r\nAt first I thought, I messed up my index or query. But I&#39;m able to reproduce the issue with the most simple implementation I can imagine: \r\n\r\n```java\r\npublic class LuceneSearch {\r\n    public static void main(String[] args) {\r\n        try {\r\n            Directory directory = new ByteBuffersDirectory();\r\n            \r\n            try (IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(new SimpleAnalyzer()))) {\r\n                indexWriter.addDocument(createDocument(&quot;a very simple example&quot;));\r\n                indexWriter.addDocument(createDocument(&quot;another example&quot;));\r\n                indexWriter.addDocument(createDocument(&quot;hello world&quot;));\r\n            }\r\n\r\n            IndexReader indexReader = DirectoryReader.open(directory);\r\n            IndexSearcher indexSearcher = new IndexSearcher(indexReader);\r\n\r\n            Query query = new TermQuery(new Term(&quot;value&quot;, &quot;hello&quot;));\r\n            Sort sort = new Sort(SortField.FIELD_SCORE); // &lt;&lt;&lt;&lt; this causes the problem\r\n            TopDocs topDocs = indexSearcher.search(query, 10, sort);\r\n            for (ScoreDoc scoreDoc : topDocs.scoreDocs) {\r\n                System.out.println(scoreDoc.doc + &quot; : &quot; + scoreDoc.score);\r\n            }\r\n\r\n            indexReader.close();\r\n            directory.close();\r\n        } catch (IOException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n    private static Document createDocument(String value) {\r\n        Document document = new Document();\r\n        document.add(new TextField(&quot;value&quot;, value, Field.Store.NO));\r\n        return document;\r\n    }\r\n}\r\n```\r\n\r\nWhen I run this simple code, I get `2 : NaN`. Without the `sort` parameter, I get `2 : 0.49662238`. I have no idea what I&#39;m missing here. Or could it be a bug in the library?\r\nThanks for your help!\r\n\r\n**Edit:**\r\nAs @andrewJames stated in the comments, the ScoreDoc (actually `FieldDoc`) object contains a property `fields` which contains the score when using the sort parameter.\r\nAfter some testing, I found out that the actual score is identical in both cases (with/without sort parameter). So the sorting works correctly.","title":"Apache Lucene returns NaN as score when sorting by relevance","body":"<p>I want to order the results of my Apache Lucene search by relevance. But when I use <code>SortField.FIELD_SCORE</code> for sorting, the score of the resulting documents is always <code>NaN</code>.\nWhen I omit the sort parameter, the search works perfectly fine, and the result documents contain a valid score.</p>\n<p>I use <code>lucene-core 9.6.0</code> and <code>lucene-analyzers-common 8.11.2</code> which are the most up to date versions in the Maven repository right now.</p>\n<p>At first I thought, I messed up my index or query. But I'm able to reproduce the issue with the most simple implementation I can imagine:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class LuceneSearch {\n    public static void main(String[] args) {\n        try {\n            Directory directory = new ByteBuffersDirectory();\n            \n            try (IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(new SimpleAnalyzer()))) {\n                indexWriter.addDocument(createDocument(&quot;a very simple example&quot;));\n                indexWriter.addDocument(createDocument(&quot;another example&quot;));\n                indexWriter.addDocument(createDocument(&quot;hello world&quot;));\n            }\n\n            IndexReader indexReader = DirectoryReader.open(directory);\n            IndexSearcher indexSearcher = new IndexSearcher(indexReader);\n\n            Query query = new TermQuery(new Term(&quot;value&quot;, &quot;hello&quot;));\n            Sort sort = new Sort(SortField.FIELD_SCORE); // &lt;&lt;&lt;&lt; this causes the problem\n            TopDocs topDocs = indexSearcher.search(query, 10, sort);\n            for (ScoreDoc scoreDoc : topDocs.scoreDocs) {\n                System.out.println(scoreDoc.doc + &quot; : &quot; + scoreDoc.score);\n            }\n\n            indexReader.close();\n            directory.close();\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n\n    private static Document createDocument(String value) {\n        Document document = new Document();\n        document.add(new TextField(&quot;value&quot;, value, Field.Store.NO));\n        return document;\n    }\n}\n</code></pre>\n<p>When I run this simple code, I get <code>2 : NaN</code>. Without the <code>sort</code> parameter, I get <code>2 : 0.49662238</code>. I have no idea what I'm missing here. Or could it be a bug in the library?\nThanks for your help!</p>\n<p><strong>Edit:</strong>\nAs @andrewJames stated in the comments, the ScoreDoc (actually <code>FieldDoc</code>) object contains a property <code>fields</code> which contains the score when using the sort parameter.\nAfter some testing, I found out that the actual score is identical in both cases (with/without sort parameter). So the sorting works correctly.</p>\n"},{"tags":["java","sql","spring-boot","jpa"],"answers":[{"tags":[],"owner":{"account_id":18129699,"reputation":296,"user_id":13184919,"display_name":"M&#225;t&#233; Tős&#233;r"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1684850564,"creation_date":1684850564,"answer_id":76315628,"question_id":76315446,"body_markdown":"You can write a JPA find method, for your example:\r\n\r\n    findAllByProcessEntity_GroupIdsProcessIsIn(Set&lt;Long&gt; setOfIDs)\r\n\r\nI am not sure about the groupIdsProcess part, that is annotated with @ElementCollection, but missing a @CollectionTable(...) annotation, does it correctly map and return every value if you use findAll() in the ProcessInstance Repository?","title":"Is there a way to filter with JPA using a Set of IDs?","body":"<p>You can write a JPA find method, for your example:</p>\n<pre><code>findAllByProcessEntity_GroupIdsProcessIsIn(Set&lt;Long&gt; setOfIDs)\n</code></pre>\n<p>I am not sure about the groupIdsProcess part, that is annotated with @ElementCollection, but missing a @CollectionTable(...) annotation, does it correctly map and return every value if you use findAll() in the ProcessInstance Repository?</p>\n"}],"owner":{"account_id":25497686,"reputation":5,"user_id":19291501,"display_name":"Solaire"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":47,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76315628,"answer_count":1,"score":0,"last_activity_date":1684850564,"creation_date":1684849165,"question_id":76315446,"body_markdown":"    public class ProcessEntity implements Serializable {\r\n        @Id\r\n        @GeneratedValue(strategy = GenerationType.SEQUENCE)\r\n        private Long id;\r\n        @NotNull\r\n        private String processDefinitionName;\r\n        @Column(name = &quot;groups_ids&quot;)\r\n        @ElementCollection\r\n        private Set&lt;Long&gt; groupIdsProcess = new HashSet&lt;&gt;();\r\n    }\r\n    \r\n    public class ProcessInstance implements Serializable {\r\n        @Id\r\n        @GeneratedValue(strategy = GenerationType.SEQUENCE)\r\n        private Long id;\r\n        @ManyToOne\r\n        private ProcessEntity processEntity;\r\n    }\r\n\r\nI want to filter ProcessInstance using JPA by using a method like: \r\n\r\n    List&lt;ProcessInstance&gt; getAllByProcessEntityGroupIdsProcessContains(Set&lt;Long&gt; setOfIDs) \r\n\r\nThat will return a list of `ProcessInstances` whose `processEntity.groupIdsProcess` contains any of the IDs contained in the passed parameter `Set&lt;Long&gt; setOfIDs`\r\n\r\nIs it possible? \r\n\r\nI tried writing a native query without success, help would be appreciated","title":"Is there a way to filter with JPA using a Set of IDs?","body":"<pre><code>public class ProcessEntity implements Serializable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.SEQUENCE)\n    private Long id;\n    @NotNull\n    private String processDefinitionName;\n    @Column(name = &quot;groups_ids&quot;)\n    @ElementCollection\n    private Set&lt;Long&gt; groupIdsProcess = new HashSet&lt;&gt;();\n}\n\npublic class ProcessInstance implements Serializable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.SEQUENCE)\n    private Long id;\n    @ManyToOne\n    private ProcessEntity processEntity;\n}\n</code></pre>\n<p>I want to filter ProcessInstance using JPA by using a method like:</p>\n<pre><code>List&lt;ProcessInstance&gt; getAllByProcessEntityGroupIdsProcessContains(Set&lt;Long&gt; setOfIDs) \n</code></pre>\n<p>That will return a list of <code>ProcessInstances</code> whose <code>processEntity.groupIdsProcess</code> contains any of the IDs contained in the passed parameter <code>Set&lt;Long&gt; setOfIDs</code></p>\n<p>Is it possible?</p>\n<p>I tried writing a native query without success, help would be appreciated</p>\n"},{"tags":["java","networking","rmi"],"comments":[{"owner":{"account_id":372682,"reputation":22461,"user_id":721855,"display_name":"aled"},"score":0,"creation_date":1684851696,"post_id":76315575,"comment_id":134575700,"body_markdown":"Any reason you need to use RMI in a production application?","body":"Any reason you need to use RMI in a production application?"},{"owner":{"account_id":8075788,"reputation":163,"user_id":6086886,"accept_rate":75,"display_name":"Federico Lolli"},"score":0,"creation_date":1684851794,"post_id":76315575,"comment_id":134575732,"body_markdown":"Uni project sadly (required)...","body":"Uni project sadly (required)..."},{"owner":{"account_id":372682,"reputation":22461,"user_id":721855,"display_name":"aled"},"score":0,"creation_date":1684852134,"post_id":76315575,"comment_id":134575830,"body_markdown":"I can only suggest to look at the differences between production and development environments. Was development in the same machine and production communicates over the network? That could be a source of delays.","body":"I can only suggest to look at the differences between production and development environments. Was development in the same machine and production communicates over the network? That could be a source of delays."},{"owner":{"account_id":8075788,"reputation":163,"user_id":6086886,"accept_rate":75,"display_name":"Federico Lolli"},"score":0,"creation_date":1684852971,"post_id":76315575,"comment_id":134576078,"body_markdown":"No difference, dev environment means just localhost as target ip for server","body":"No difference, dev environment means just localhost as target ip for server"}],"owner":{"account_id":8075788,"reputation":163,"user_id":6086886,"accept_rate":75,"display_name":"Federico Lolli"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":45,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684850386,"creation_date":1684850077,"question_id":76315575,"body_markdown":"In a localhost environment, `registry.lookup` in Java RMI (Remote Method Invocation) works fine, but in production and staging environments, the same lookup takes a **very long time (ages)**, which is affecting our application&#39;s performance deeply.\r\n\r\nWe cannot find any solution, looked for other solutions here but nothing useful.\r\n\r\nThe code for the client:\r\n```\r\npackage it.***.***.network.rmi;\r\n\r\nimport java.io.IOException;\r\nimport java.rmi.NotBoundException;\r\nimport java.rmi.RemoteException;\r\nimport java.rmi.registry.LocateRegistry;\r\nimport java.rmi.registry.Registry;\r\n\r\n/**\r\n * This class represents the RMI client.\r\n */\r\npublic class ClientRmi implements ClientRmiIF {\r\n    private final String serverHost;\r\n    private final int serverPort;\r\n    private ServerRmiIF server;\r\n    private final CommandCallback callback;\r\n    private static Registry registry;\r\n    public ClientRmi(String serverHost, CommandCallback callback) throws RemoteException {\r\n        System.setProperty(&quot;java.rmi.server.hostname&quot;, serverHost);\r\n        this.serverHost = serverHost;\r\n        this.serverPort = 1099;\r\n        this.callback = callback;\r\n        server = null;\r\n    }\r\n\r\n    public ClientRmi(String serverHost, int serverPort, CommandCallback callback) throws RemoteException {\r\n        System.setProperty(&quot;java.rmi.server.hostname&quot;, serverHost);\r\n        this.serverHost = serverHost;\r\n        this.serverPort = serverPort;\r\n        this.callback = callback;\r\n        server = null;\r\n    }\r\n\r\n    @Override\r\n    public ClientRmi connect() throws RemoteException, NotBoundException {\r\n        registry = LocateRegistry.getRegistry(serverHost, serverPort);\r\n        this.server = (ServerRmiIF) registry.lookup(&quot;MyRMIServer&quot;);\r\n        return this;\r\n    }\r\n}\r\n\r\n```\r\n\r\nAnd the code for the server:\r\n```\r\npackage it.***.***.network.rmi;\r\n\r\nimport org.apache.logging.log4j.LogManager;\r\nimport org.apache.logging.log4j.Logger;\r\n\r\nimport java.io.IOException;\r\nimport java.net.MalformedURLException;\r\nimport java.rmi.Naming;\r\nimport java.rmi.RemoteException;\r\nimport java.rmi.registry.LocateRegistry;\r\nimport java.rmi.registry.Registry;\r\nimport java.rmi.server.UnicastRemoteObject;\r\nimport java.util.HashMap;\r\nimport java.util.HashSet;\r\nimport java.util.Map;\r\nimport java.util.Set;\r\n\r\n/**\r\n * This class represents the RMI server.\r\n */\r\npublic class ServerRmi implements ServerRmiIF {\r\n    private static Registry registry;\r\n    private final Set&lt;ClientRmiIF&gt; clients;\r\n    private final CommandCallback callback;\r\n    private static final Logger logger = LogManager.getLogger(ServerRmi.class);\r\n\r\n\r\n    public ServerRmi(String hostname, CommandCallback callback) throws RemoteException {\r\n        clients = new HashSet&lt;&gt;();\r\n\r\n        // set java.rmi.server.hostname\r\n        System.setProperty(&quot;java.rmi.server.hostname&quot;, hostname);\r\n\r\n        try {\r\n            registry = LocateRegistry.createRegistry(1099);\r\n            ServerRmiIF stub = (ServerRmiIF) UnicastRemoteObject.exportObject(this, 0);\r\n            registry.rebind(&quot;MyRMIServer&quot;, stub);\r\n        } catch (RemoteException e) {\r\n            logger.error(e.getMessage());\r\n            throw e;\r\n        }\r\n        this.callback = callback;\r\n    }\r\n}\r\n```\r\n\r\n\r\nAny insights on what could be causing the difference in lookup time, or suggestions for what we can investigate, would be greatly appreciated.","title":"Java RMI too slow to registry.lookup in non-dev environment","body":"<p>In a localhost environment, <code>registry.lookup</code> in Java RMI (Remote Method Invocation) works fine, but in production and staging environments, the same lookup takes a <strong>very long time (ages)</strong>, which is affecting our application's performance deeply.</p>\n<p>We cannot find any solution, looked for other solutions here but nothing useful.</p>\n<p>The code for the client:</p>\n<pre><code>package it.***.***.network.rmi;\n\nimport java.io.IOException;\nimport java.rmi.NotBoundException;\nimport java.rmi.RemoteException;\nimport java.rmi.registry.LocateRegistry;\nimport java.rmi.registry.Registry;\n\n/**\n * This class represents the RMI client.\n */\npublic class ClientRmi implements ClientRmiIF {\n    private final String serverHost;\n    private final int serverPort;\n    private ServerRmiIF server;\n    private final CommandCallback callback;\n    private static Registry registry;\n    public ClientRmi(String serverHost, CommandCallback callback) throws RemoteException {\n        System.setProperty(&quot;java.rmi.server.hostname&quot;, serverHost);\n        this.serverHost = serverHost;\n        this.serverPort = 1099;\n        this.callback = callback;\n        server = null;\n    }\n\n    public ClientRmi(String serverHost, int serverPort, CommandCallback callback) throws RemoteException {\n        System.setProperty(&quot;java.rmi.server.hostname&quot;, serverHost);\n        this.serverHost = serverHost;\n        this.serverPort = serverPort;\n        this.callback = callback;\n        server = null;\n    }\n\n    @Override\n    public ClientRmi connect() throws RemoteException, NotBoundException {\n        registry = LocateRegistry.getRegistry(serverHost, serverPort);\n        this.server = (ServerRmiIF) registry.lookup(&quot;MyRMIServer&quot;);\n        return this;\n    }\n}\n\n</code></pre>\n<p>And the code for the server:</p>\n<pre><code>package it.***.***.network.rmi;\n\nimport org.apache.logging.log4j.LogManager;\nimport org.apache.logging.log4j.Logger;\n\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.rmi.Naming;\nimport java.rmi.RemoteException;\nimport java.rmi.registry.LocateRegistry;\nimport java.rmi.registry.Registry;\nimport java.rmi.server.UnicastRemoteObject;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.Map;\nimport java.util.Set;\n\n/**\n * This class represents the RMI server.\n */\npublic class ServerRmi implements ServerRmiIF {\n    private static Registry registry;\n    private final Set&lt;ClientRmiIF&gt; clients;\n    private final CommandCallback callback;\n    private static final Logger logger = LogManager.getLogger(ServerRmi.class);\n\n\n    public ServerRmi(String hostname, CommandCallback callback) throws RemoteException {\n        clients = new HashSet&lt;&gt;();\n\n        // set java.rmi.server.hostname\n        System.setProperty(&quot;java.rmi.server.hostname&quot;, hostname);\n\n        try {\n            registry = LocateRegistry.createRegistry(1099);\n            ServerRmiIF stub = (ServerRmiIF) UnicastRemoteObject.exportObject(this, 0);\n            registry.rebind(&quot;MyRMIServer&quot;, stub);\n        } catch (RemoteException e) {\n            logger.error(e.getMessage());\n            throw e;\n        }\n        this.callback = callback;\n    }\n}\n</code></pre>\n<p>Any insights on what could be causing the difference in lookup time, or suggestions for what we can investigate, would be greatly appreciated.</p>\n"},{"tags":["java","spring","spring-boot"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":1,"creation_date":1684831210,"post_id":76312788,"comment_id":134570728,"body_markdown":"Add H2 for an in-memory database or stop using `@SpringBootTest` for simple testcases (which is whatyou are probably doing, without knowing the implications of this).","body":"Add H2 for an in-memory database or stop using <code>@SpringBootTest</code> for simple testcases (which is whatyou are probably doing, without knowing the implications of this)."},{"owner":{"account_id":4957766,"reputation":578,"user_id":3989874,"accept_rate":86,"display_name":"Pacman"},"score":0,"creation_date":1684831332,"post_id":76312788,"comment_id":134570750,"body_markdown":"H2: Don&#39;t want to add any db tests. @SpringBootTest: What would be an alternative?","body":"H2: Don&#39;t want to add any db tests. @SpringBootTest: What would be an alternative?"},{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":1,"creation_date":1684831396,"post_id":76312788,"comment_id":134570768,"body_markdown":"You don&#39;t need to but H2 will be created at startup of your test. This is what you need when writing tests with `@SpringBootTest` it will bootstrap a full application. If you don&#39;t want that don&#39;t use `@SpringBootTest` .","body":"You don&#39;t need to but H2 will be created at startup of your test. This is what you need when writing tests with <code>@SpringBootTest</code> it will bootstrap a full application. If you don&#39;t want that don&#39;t use <code>@SpringBootTest</code> ."}],"answers":[{"tags":[],"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1684834990,"creation_date":1684834990,"answer_id":76313349,"question_id":76312788,"body_markdown":"You get this error as you are probably abusing `@SpringBootTest` to do tests for services with using `@MockBean` to inject/create mocks for dependencies/repositories. `@SpringBootTest` is mainly intended for writing integration tests for the whole application not to test 1 single service. \r\n\r\nThe short answer is don&#39;t. Either use one of the sliced tests for that or just write a simple unit test (instantiate the service yourself and create mocks using Mockito yourself and inject, don&#39;t abuse `@SpringBootTest` for that). \r\n\r\nIf you really want to continue on this way the easiest solution is to add H2 as a test dependency so you have an in-memory database created for you when running tests. You don&#39;t use it but it is needed to start the application. \r\n\r\nAnother option would be to mock the `DataSource` in an `@TestConfiguration`. Problem is you would need to mock a whole lot of methods and classes as well and you are basically mocking so much you have mocked a stub of a datasource implementation. ","title":"How to prevent a Spring Boot application from instantiating a JDBC datasource during tests?","body":"<p>You get this error as you are probably abusing <code>@SpringBootTest</code> to do tests for services with using <code>@MockBean</code> to inject/create mocks for dependencies/repositories. <code>@SpringBootTest</code> is mainly intended for writing integration tests for the whole application not to test 1 single service.</p>\n<p>The short answer is don't. Either use one of the sliced tests for that or just write a simple unit test (instantiate the service yourself and create mocks using Mockito yourself and inject, don't abuse <code>@SpringBootTest</code> for that).</p>\n<p>If you really want to continue on this way the easiest solution is to add H2 as a test dependency so you have an in-memory database created for you when running tests. You don't use it but it is needed to start the application.</p>\n<p>Another option would be to mock the <code>DataSource</code> in an <code>@TestConfiguration</code>. Problem is you would need to mock a whole lot of methods and classes as well and you are basically mocking so much you have mocked a stub of a datasource implementation.</p>\n"}],"owner":{"account_id":4957766,"reputation":578,"user_id":3989874,"accept_rate":86,"display_name":"Pacman"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":90,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76313349,"answer_count":1,"score":0,"last_activity_date":1684850122,"creation_date":1684831128,"question_id":76312788,"body_markdown":"I&#39;ve recently added JPA to my application for a single database request. Since then the tests are failing:\r\n```java.lang.IllegalStateException: Failed to load ApplicationContext```\r\n\r\n[...]\r\n\r\n```Error creating bean with name &#39;dataSourceScriptDatabaseInitializer&#39;```\r\n\r\nMy understanding here is that during the test run Spring Boot tries to initialize the database connection, but I&#39;m not interested in doing any tests on the added db request. How can I stop this behaviour?","title":"How to prevent a Spring Boot application from instantiating a JDBC datasource during tests?","body":"<p>I've recently added JPA to my application for a single database request. Since then the tests are failing:\n<code>java.lang.IllegalStateException: Failed to load ApplicationContext</code></p>\n<p>[...]</p>\n<p><code>Error creating bean with name 'dataSourceScriptDatabaseInitializer'</code></p>\n<p>My understanding here is that during the test run Spring Boot tries to initialize the database connection, but I'm not interested in doing any tests on the added db request. How can I stop this behaviour?</p>\n"},{"tags":["java","junit5","spring-boot-test"],"comments":[{"owner":{"account_id":39208,"reputation":251260,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"score":1,"creation_date":1684755407,"post_id":76305197,"comment_id":134558360,"body_markdown":"When using `MockitoExtension`, you don&#39;t have to call `openMocks` (and openMocks should be called for the test class, not the field).","body":"When using <code>MockitoExtension</code>, you don&#39;t have to call <code>openMocks</code> (and openMocks should be called for the test class, not the field)."},{"owner":{"account_id":4999034,"reputation":1880,"user_id":6722075,"display_name":"Tohid Makari"},"score":0,"creation_date":1684755614,"post_id":76305197,"comment_id":134558406,"body_markdown":"@knittl I updated the question and still same error","body":"@knittl I updated the question and still same error"},{"owner":{"account_id":39208,"reputation":251260,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"score":1,"creation_date":1684820300,"post_id":76305197,"comment_id":134568527,"body_markdown":"Is `userInfo` and `userInfoDto` a typo or your real code? One doesn&#39;t exist, the other is never used.","body":"Is <code>userInfo</code> and <code>userInfoDto</code> a typo or your real code? One doesn&#39;t exist, the other is never used."}],"answers":[{"tags":[],"owner":{"account_id":26746848,"reputation":226,"user_id":20346807,"display_name":"Joan"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684850092,"creation_date":1684850092,"answer_id":76315579,"question_id":76305197,"body_markdown":"I think you should change the:\r\n\r\n    @Autowired\r\n    private UserRepository userRepository;\r\n\r\nFor\r\n\r\n    @InjectMocks\r\n    private UserRepository userRepository;\r\n\r\nI&#39;m assuming your `UserInfoDto` is `@Autowired` in original class and the `UserRepository` is the class you&#39;re trying to test\r\n","title":"Mocking returns null when using with @SpringBootTest and @ExtendWith(MockitoExtension.class)","body":"<p>I think you should change the:</p>\n<pre><code>@Autowired\nprivate UserRepository userRepository;\n</code></pre>\n<p>For</p>\n<pre><code>@InjectMocks\nprivate UserRepository userRepository;\n</code></pre>\n<p>I'm assuming your <code>UserInfoDto</code> is <code>@Autowired</code> in original class and the <code>UserRepository</code> is the class you're trying to test</p>\n"}],"owner":{"account_id":4999034,"reputation":1880,"user_id":6722075,"display_name":"Tohid Makari"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":95,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1684850092,"creation_date":1684750966,"question_id":76305197,"body_markdown":"I have snippet code as follows that when trying to mock object it returns null:\r\n\r\n`userInfoDto` is null.\r\n\r\n```\r\n@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\r\n@ExtendWith(MockitoExtension.class)\r\npublic class IntegrationTest {\r\n    @Autowired\r\n    private UserRepository userRepository;\r\n\r\n    @Mock\r\n    private UserInfoDto userInfo;\r\n    @BeforeEach\r\n    public void init() {\r\n        when(userInfo.getXCaller()).thenReturn(&quot;Test&quot;);\r\n    }\r\n\r\n}\r\n```","title":"Mocking returns null when using with @SpringBootTest and @ExtendWith(MockitoExtension.class)","body":"<p>I have snippet code as follows that when trying to mock object it returns null:</p>\n<p><code>userInfoDto</code> is null.</p>\n<pre><code>@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\n@ExtendWith(MockitoExtension.class)\npublic class IntegrationTest {\n    @Autowired\n    private UserRepository userRepository;\n\n    @Mock\n    private UserInfoDto userInfo;\n    @BeforeEach\n    public void init() {\n        when(userInfo.getXCaller()).thenReturn(&quot;Test&quot;);\n    }\n\n}\n</code></pre>\n"},{"tags":["java","exception","jpa"],"comments":[{"owner":{"account_id":9735171,"reputation":2264,"user_id":7218656,"accept_rate":75,"display_name":"Arun Sudhakaran"},"score":0,"creation_date":1684844263,"post_id":76314460,"comment_id":134573797,"body_markdown":"Can you add the complete error log?","body":"Can you add the complete error log?"},{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":2,"creation_date":1684844538,"post_id":76314460,"comment_id":134573873,"body_markdown":"`:p.productName` there should be no `:`. Same for the other fields. `:` should only be followed by the actual parameter name","body":"<code>:p.productName</code> there should be no <code>:</code>. Same for the other fields. <code>:</code> should only be followed by the actual parameter name"},{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":2,"creation_date":1684844997,"post_id":76314460,"comment_id":134573982,"body_markdown":"Your entity is named `Product` not `Products` and as you are writing a JPQL and not a SQL you need to reference the entity not the table. Also `:p.categoryId` is where you probably wanted to write `:categoryId` to check if the passed in parameter was `null` or not. The same applies to your other fields as well.","body":"Your entity is named <code>Product</code> not <code>Products</code> and as you are writing a JPQL and not a SQL you need to reference the entity not the table. Also <code>:p.categoryId</code> is where you probably wanted to write <code>:categoryId</code> to check if the passed in parameter was <code>null</code> or not. The same applies to your other fields as well."}],"answers":[{"comments":[{"owner":{"account_id":9571720,"reputation":6305,"user_id":7109162,"accept_rate":84,"display_name":"XtremeBaumer"},"score":2,"creation_date":1684844687,"post_id":76314705,"comment_id":134573909,"body_markdown":"That is the only part that would not throw an error. It just doesn&#39;t do what it should. `:p.productName`, `:p.brandId`, `:p.categoryId` and `:p.modelYear` are causing the error. Your &quot;correct&quot; query is still wrong","body":"That is the only part that would not throw an error. It just doesn&#39;t do what it should. <code>:p.productName</code>, <code>:p.brandId</code>, <code>:p.categoryId</code> and <code>:p.modelYear</code> are causing the error. Your &quot;correct&quot; query is still wrong"},{"owner":{"account_id":17385009,"reputation":65,"user_id":12596492,"display_name":"Minh Nguy&#234;n Nguyễn Đức"},"score":0,"creation_date":1684845105,"post_id":76314705,"comment_id":134574009,"body_markdown":"Thank you you two for help me. The problem is solved by you. I followed instructions on Baeldung, maybe it has some mistakes.","body":"Thank you you two for help me. The problem is solved by you. I followed instructions on Baeldung, maybe it has some mistakes."}],"tags":[],"owner":{"account_id":9735171,"reputation":2264,"user_id":7218656,"accept_rate":75,"display_name":"Arun Sudhakaran"},"comment_count":2,"down_vote_count":1,"up_vote_count":1,"is_accepted":true,"score":0,"last_activity_date":1684850026,"creation_date":1684844538,"answer_id":76314705,"question_id":76314460,"body_markdown":"One of the errors in the query is with the `:p.productName is null`, change it to `(p.productName is null or p.productName = :productName)`\r\n\r\nThe `:p.productName` is a named parameter and the named parameters are expected to have a value, since `:p.productName` is not provided with a the exception is thrown. It should be either the property name in the bean if you are using HQL, or it should be the column name from the table if you are using a native query. \r\n\r\nThe same is happening for other columns like `:p.brandId`, `:p.categoryId`, and `:p.modelYear`, so you should do it for other columns as well, the correct query will be \r\n\r\n    @Query(&quot;SELECT p FROM Product p WHERE &quot; +\r\n                &quot;(p.productId is null or p.productId = :productId) and &quot; +\r\n                &quot;(p.productName is null or p.productName = :productName) and &quot; +\r\n                &quot;(p.brandId is null or p.brandId = :brandId) and &quot; +\r\n                &quot;(p.categoryId is null or p.categoryId = :categoryId) and &quot; +\r\n                &quot;(p.modelYear is null or p.modelYear = :modelYear)&quot;)","title":"org.hibernate.query.SemanticException: A query exception occurred","body":"<p>One of the errors in the query is with the <code>:p.productName is null</code>, change it to <code>(p.productName is null or p.productName = :productName)</code></p>\n<p>The <code>:p.productName</code> is a named parameter and the named parameters are expected to have a value, since <code>:p.productName</code> is not provided with a the exception is thrown. It should be either the property name in the bean if you are using HQL, or it should be the column name from the table if you are using a native query.</p>\n<p>The same is happening for other columns like <code>:p.brandId</code>, <code>:p.categoryId</code>, and <code>:p.modelYear</code>, so you should do it for other columns as well, the correct query will be</p>\n<pre><code>@Query(&quot;SELECT p FROM Product p WHERE &quot; +\n            &quot;(p.productId is null or p.productId = :productId) and &quot; +\n            &quot;(p.productName is null or p.productName = :productName) and &quot; +\n            &quot;(p.brandId is null or p.brandId = :brandId) and &quot; +\n            &quot;(p.categoryId is null or p.categoryId = :categoryId) and &quot; +\n            &quot;(p.modelYear is null or p.modelYear = :modelYear)&quot;)\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2207385,"reputation":1511,"user_id":1950242,"display_name":"azwar_akbar"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684845522,"creation_date":1684845522,"answer_id":76314843,"question_id":76314460,"body_markdown":"I think you have problem with your query, here is the reasons:\r\n\r\nLook at the other `WHERE` statements for example `and (:p.productName is null or p.productName = :productName)` at this point you are putting `:p` which means it should be a parameter rather than column. By writing `:p.productName` it means that you are accessing property `.productName` from parameter `:p` which is not exist. The right syntax to compare **input parameter** with **value of column** is `and (p.productName is null or p.productName = :productName)`. Also you can make it more simple `and (p.productName = :productName)` by this way it will compare for null value or not.\r\n\r\nWhen you need to check the input parameter and the table column as well you can do like this way:\r\n\r\n    and (:productName is null or p.productName = :productName) \r\n\r\nor\r\n\r\n    and (:productName is not null or p.productName = :productName) \r\n\r\n\r\nThis is the example:\r\n\r\n    select\r\n    \tp\r\n    from\r\n    \tProducts p\r\n    where\r\n    \t(p.productId is null\r\n    \t\tor p.productId = :productId)\r\n    \tand (p.productName is null\r\n    \t\tor p.productName = :productName)\r\n    \tand (p.brandId is null\r\n    \t\tor p.brandId = :brandId)\r\n    \tand (p.categoryId is null\r\n    \t\tor p.categoryId = :categoryId)\r\n    \tand (p.modelYear is null\r\n    \t\tor p.modelYear = :modelYear)\r\n\r\n\t\t\r\nOther exsample:\r\n\r\n\r\n    select\r\n    \tp\r\n    from\r\n    \tProducts p\r\n    where\r\n    \t(:productId is null\r\n    \t\tor p.productId = :productId)\r\n    \tand (:productName is null\r\n    \t\tor p.productName = :productName)\r\n    \tand (:brandId is null\r\n    \t\tor p.brandId = :brandId)\r\n    \tand (:categoryId is null\r\n    \t\tor p.categoryId = :categoryId)\r\n    \tand (:modelYear is null\r\n    \t\tor p.modelYear = :modelYear)\r\n\r\nHope it helps.\r\n\r\n\r\n\r\n","title":"org.hibernate.query.SemanticException: A query exception occurred","body":"<p>I think you have problem with your query, here is the reasons:</p>\n<p>Look at the other <code>WHERE</code> statements for example <code>and (:p.productName is null or p.productName = :productName)</code> at this point you are putting <code>:p</code> which means it should be a parameter rather than column. By writing <code>:p.productName</code> it means that you are accessing property <code>.productName</code> from parameter <code>:p</code> which is not exist. The right syntax to compare <strong>input parameter</strong> with <strong>value of column</strong> is <code>and (p.productName is null or p.productName = :productName)</code>. Also you can make it more simple <code>and (p.productName = :productName)</code> by this way it will compare for null value or not.</p>\n<p>When you need to check the input parameter and the table column as well you can do like this way:</p>\n<pre><code>and (:productName is null or p.productName = :productName) \n</code></pre>\n<p>or</p>\n<pre><code>and (:productName is not null or p.productName = :productName) \n</code></pre>\n<p>This is the example:</p>\n<pre><code>select\n    p\nfrom\n    Products p\nwhere\n    (p.productId is null\n        or p.productId = :productId)\n    and (p.productName is null\n        or p.productName = :productName)\n    and (p.brandId is null\n        or p.brandId = :brandId)\n    and (p.categoryId is null\n        or p.categoryId = :categoryId)\n    and (p.modelYear is null\n        or p.modelYear = :modelYear)\n\n    \n</code></pre>\n<p>Other exsample:</p>\n<pre><code>select\n    p\nfrom\n    Products p\nwhere\n    (:productId is null\n        or p.productId = :productId)\n    and (:productName is null\n        or p.productName = :productName)\n    and (:brandId is null\n        or p.brandId = :brandId)\n    and (:categoryId is null\n        or p.categoryId = :categoryId)\n    and (:modelYear is null\n        or p.modelYear = :modelYear)\n</code></pre>\n<p>Hope it helps.</p>\n"}],"owner":{"account_id":17385009,"reputation":65,"user_id":12596492,"display_name":"Minh Nguy&#234;n Nguyễn Đức"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1097,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76314705,"answer_count":2,"score":1,"last_activity_date":1684850026,"creation_date":1684842872,"question_id":76314460,"body_markdown":"I am doing a @GetMapping request to search a product using multiple parameters.\r\n\r\nMy ProductController.java\r\n\r\n```\r\n@GetMapping(&quot;/search&quot;)\r\n    ResponseEntity&lt;ResponseObject&gt; findBySearch(@RequestParam(required = false) Integer productId,\r\n                                                @RequestParam(required = false) String productName,\r\n                                                @RequestParam(required = false) Integer brandId,\r\n                                                @RequestParam(required = false) Integer categoryId,\r\n                                                @RequestParam(required = false) Integer modelYear) {\r\n        List&lt;Product&gt; foundProducts = repository.findProductBySearch(productId, productName, brandId, categoryId, modelYear);\r\n        return (!foundProducts.isEmpty()) ?\r\n                ResponseEntity.status(HttpStatus.OK).body(new ResponseObject(HttpStatus.OK.toString(), &quot;Query successfully&quot;, foundProducts))\r\n                :\r\n                ResponseEntity.status(HttpStatus.NOT_FOUND).body(new ResponseObject(HttpStatus.NOT_FOUND.toString(), &quot;Cannot find product with provided model&quot;, &quot;&quot;));\r\n    }\r\n```\r\n\r\nMy ProductRepository.java\r\n\r\n```\r\n@Query(&quot;SELECT p FROM Products p WHERE (:productId is null or p.productId = :productId) and &quot; +\r\n            &quot;(:p.productName is null or p.productName = :productName) and &quot; +\r\n            &quot;(:p.brandId is null or p.brandId = :brandId) and &quot; +\r\n            &quot;(:p.categoryId is null or p.categoryId = :categoryId) and &quot; +\r\n            &quot;(:p.modelYear is null or p.modelYear = :modelYear)&quot;)\r\n    List&lt;Product&gt; findProductBySearch(@Param(&quot;productId&quot;) Integer productId,\r\n                                      @Param(&quot;productName&quot;) String productName,\r\n                                      @Param(&quot;brandId&quot;) Integer brandId,\r\n                                      @Param(&quot;categoryId&quot;) Integer categoryId,\r\n                                      @Param(&quot;modelYear&quot;) Integer modelYear);\r\n```\r\n\r\nMy Product.java\r\n\r\n```\r\n@Entity\r\n@Table(name = &quot;Products&quot;)\r\npublic class Product {\r\n    @Id\r\n    @SequenceGenerator(\r\n            name = &quot;product_sequence&quot;,\r\n            sequenceName = &quot;product_sequence&quot;,\r\n            allocationSize = 1\r\n    )\r\n    @GeneratedValue (\r\n            strategy = GenerationType.SEQUENCE,\r\n            generator = &quot;product_sequence&quot;\r\n    )\r\n    @Column(name = &quot;product_id&quot;)\r\n    int productId;\r\n    @Column(name = &quot;product_name&quot;)\r\n    String productName;\r\n    @Column(name = &quot;brand_id&quot;)\r\n    int brandId;\r\n    @Column(name = &quot;category_id&quot;)\r\n    int categoryId;\r\n    @Column(name = &quot;model_year&quot;)\r\n    int modelYear;\r\n    @Column(name = &quot;list_price&quot;)\r\n    double listPrice;\r\n\r\n//getters, setters\r\n```\r\n\r\nWhen I run project, it produced this error\r\n\r\n**org.hibernate.query.SemanticException: A query exception occurred [SELECT p FROM Products p WHERE (:productId is null or p.productId = :productId) and (:p.productName is null or p.productName = :productName) and (:p.brandId is null or p.brandId = :brandId) and (:p.categoryId is null or p.categoryId = :categoryId) and (:p.modelYear is null or p.modelYear = :modelYear)]**\r\n\r\nPlease help me to find where I got it wrong.","title":"org.hibernate.query.SemanticException: A query exception occurred","body":"<p>I am doing a @GetMapping request to search a product using multiple parameters.</p>\n<p>My ProductController.java</p>\n<pre><code>@GetMapping(&quot;/search&quot;)\n    ResponseEntity&lt;ResponseObject&gt; findBySearch(@RequestParam(required = false) Integer productId,\n                                                @RequestParam(required = false) String productName,\n                                                @RequestParam(required = false) Integer brandId,\n                                                @RequestParam(required = false) Integer categoryId,\n                                                @RequestParam(required = false) Integer modelYear) {\n        List&lt;Product&gt; foundProducts = repository.findProductBySearch(productId, productName, brandId, categoryId, modelYear);\n        return (!foundProducts.isEmpty()) ?\n                ResponseEntity.status(HttpStatus.OK).body(new ResponseObject(HttpStatus.OK.toString(), &quot;Query successfully&quot;, foundProducts))\n                :\n                ResponseEntity.status(HttpStatus.NOT_FOUND).body(new ResponseObject(HttpStatus.NOT_FOUND.toString(), &quot;Cannot find product with provided model&quot;, &quot;&quot;));\n    }\n</code></pre>\n<p>My ProductRepository.java</p>\n<pre><code>@Query(&quot;SELECT p FROM Products p WHERE (:productId is null or p.productId = :productId) and &quot; +\n            &quot;(:p.productName is null or p.productName = :productName) and &quot; +\n            &quot;(:p.brandId is null or p.brandId = :brandId) and &quot; +\n            &quot;(:p.categoryId is null or p.categoryId = :categoryId) and &quot; +\n            &quot;(:p.modelYear is null or p.modelYear = :modelYear)&quot;)\n    List&lt;Product&gt; findProductBySearch(@Param(&quot;productId&quot;) Integer productId,\n                                      @Param(&quot;productName&quot;) String productName,\n                                      @Param(&quot;brandId&quot;) Integer brandId,\n                                      @Param(&quot;categoryId&quot;) Integer categoryId,\n                                      @Param(&quot;modelYear&quot;) Integer modelYear);\n</code></pre>\n<p>My Product.java</p>\n<pre><code>@Entity\n@Table(name = &quot;Products&quot;)\npublic class Product {\n    @Id\n    @SequenceGenerator(\n            name = &quot;product_sequence&quot;,\n            sequenceName = &quot;product_sequence&quot;,\n            allocationSize = 1\n    )\n    @GeneratedValue (\n            strategy = GenerationType.SEQUENCE,\n            generator = &quot;product_sequence&quot;\n    )\n    @Column(name = &quot;product_id&quot;)\n    int productId;\n    @Column(name = &quot;product_name&quot;)\n    String productName;\n    @Column(name = &quot;brand_id&quot;)\n    int brandId;\n    @Column(name = &quot;category_id&quot;)\n    int categoryId;\n    @Column(name = &quot;model_year&quot;)\n    int modelYear;\n    @Column(name = &quot;list_price&quot;)\n    double listPrice;\n\n//getters, setters\n</code></pre>\n<p>When I run project, it produced this error</p>\n<p><strong>org.hibernate.query.SemanticException: A query exception occurred [SELECT p FROM Products p WHERE (:productId is null or p.productId = :productId) and (:p.productName is null or p.productName = :productName) and (:p.brandId is null or p.brandId = :brandId) and (:p.categoryId is null or p.categoryId = :categoryId) and (:p.modelYear is null or p.modelYear = :modelYear)]</strong></p>\n<p>Please help me to find where I got it wrong.</p>\n"},{"tags":["java","micronaut"],"comments":[{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":2,"creation_date":1565399929,"post_id":57437794,"comment_id":101354453,"body_markdown":"Yes it is really the expected behaviour, as it is documented, and you&#39;re getting it.","body":"Yes it is really the expected behaviour, as it is documented, and you&#39;re getting it."}],"answers":[{"comments":[{"owner":{"account_id":195614,"reputation":131,"user_id":438603,"display_name":"Jim Yu"},"score":0,"creation_date":1602716838,"post_id":57438605,"comment_id":113812181,"body_markdown":"I have a similar issue. How can we avoid that?","body":"I have a similar issue. How can we avoid that?"}],"tags":[],"owner":{"account_id":1844706,"reputation":3419,"user_id":1673320,"accept_rate":86,"display_name":"itachi"},"comment_count":1,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1565399987,"creation_date":1565399987,"answer_id":57438605,"question_id":57437794,"body_markdown":"I don&#39;t think there&#39;s something wrong with your code. The documentation of this particular exception states clearly:\r\n\r\n&gt; An exception that occurs when a response returns an error code equal to or greater than 400.\r\n\r\nIf that&#39;s not satisfactory for you, we can dig deeper. The exception is thrown in `DefaultHttpClient` class in a method named `channelRead0`. Let&#39;s see what can we find there.\r\n\r\n    boolean errorStatus = statusCode &gt;= 400;\r\n    if (errorStatus) {\r\n        emitter.onError(new HttpClientResponseException(response.getStatus().getReason(), response));\r\n    } else {\r\n        emitter.onNext(response);\r\n        emitter.onComplete();\r\n    }\r\n\r\nThis exception is passed further and it looks like it&#39;s eventually thrown somewhere. It just works this way, this is the author&#39;s design. If you don&#39;t like it, you can always use good old built-in [HttpURLConnection][1], a new [HttpClient][2] from Java 9 or something 3rd party like [OkHttp][3].\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/net/HttpURLConnection.html\r\n  [2]: https://docs.oracle.com/javase/9/docs/api/jdk/incubator/http/HttpClient.html\r\n  [3]: https://square.github.io/okhttp/","title":"HttpClient throws exception on response code 404. Is this by design or am I doing something wrong?","body":"<p>I don't think there's something wrong with your code. The documentation of this particular exception states clearly:</p>\n\n<blockquote>\n  <p>An exception that occurs when a response returns an error code equal to or greater than 400.</p>\n</blockquote>\n\n<p>If that's not satisfactory for you, we can dig deeper. The exception is thrown in <code>DefaultHttpClient</code> class in a method named <code>channelRead0</code>. Let's see what can we find there.</p>\n\n<pre><code>boolean errorStatus = statusCode &gt;= 400;\nif (errorStatus) {\n    emitter.onError(new HttpClientResponseException(response.getStatus().getReason(), response));\n} else {\n    emitter.onNext(response);\n    emitter.onComplete();\n}\n</code></pre>\n\n<p>This exception is passed further and it looks like it's eventually thrown somewhere. It just works this way, this is the author's design. If you don't like it, you can always use good old built-in <a href=\"https://docs.oracle.com/javase/8/docs/api/java/net/HttpURLConnection.html\" rel=\"nofollow noreferrer\">HttpURLConnection</a>, a new <a href=\"https://docs.oracle.com/javase/9/docs/api/jdk/incubator/http/HttpClient.html\" rel=\"nofollow noreferrer\">HttpClient</a> from Java 9 or something 3rd party like <a href=\"https://square.github.io/okhttp/\" rel=\"nofollow noreferrer\">OkHttp</a>.</p>\n"}],"owner":{"account_id":236684,"reputation":4709,"user_id":504331,"accept_rate":85,"display_name":"JSBach"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4070,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"closed_date":1565443889,"accepted_answer_id":57438605,"answer_count":1,"score":1,"last_activity_date":1684849263,"creation_date":1565389795,"question_id":57437794,"body_markdown":"I am starting today with Micronaut.\r\nI built this controller:\r\n\r\n    @Controller\r\n    public class MyController implements MyApi{\r\n\r\n\t@Override\r\n\tpublic String doit() {\r\n\t\tthrow new NotFoundException();\r\n\t    }\r\n    }\r\n\r\nand this exception handler:\r\n\r\n```java\r\n@Produces\r\n@Singleton\r\n@Requires(classes = { NotFoundException.class, ExceptionHandler.class})\r\npublic class NotFoundExceptionHandler implements ExceptionHandler&lt;NotFoundException, HttpResponse&gt; {\r\n\r\n\t@Override\r\n\tpublic HttpResponse handle(HttpRequest request, NotFoundException exception) {\r\n\t\treturn HttpResponseFactory.INSTANCE.status(HttpStatus.NOT_FOUND);\r\n\t}\r\n}\r\n```\r\n\r\nAnd this test:\r\n\r\n    \r\n    @MicronautTest\r\n    public class MyControllerIT {\r\n\r\n\t@Inject\r\n\t@Client(&quot;/&quot;)\r\n\tHttpClient client;\r\n\r\n\t@Test\r\n\tpublic void testHello() {\r\n\t\tHttpRequest&lt;String&gt; request = HttpRequest.GET(&quot;/myController&quot;);\r\n\t\tHttpResponse&lt;String&gt; body = client.toBlocking().exchange(request);\r\n\r\n\t\tassertThat(body.getStatus(), is(HttpStatus.NOT_FOUND));\r\n\t    }\r\n    }\r\n\r\n\r\nMy expectation is that it would pass: I would get a response back with no content, HTTP code 404, message &quot;Not found&quot; and I would be done.\r\n\r\nBut, instead, I get:\r\n\r\n    io.micronaut.http.client.exceptions.HttpClientResponseException: Not Found\r\n\r\n\tat io.micronaut.http.client.DefaultHttpClient$10.channelRead0(DefaultHttpClient.java:1799)\r\n\tat io.micronaut.http.client.DefaultHttpClient$10.channelRead0(DefaultHttpClient.java:1739)\r\n\tat io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\r\n\tat io.micronaut.http.netty.stream.HttpStreamsHandler.channelRead(HttpStreamsHandler.java:185)\r\n\tat io.micronaut.http.netty.stream.HttpStreamsClientHandler.channelRead(HttpStreamsClientHandler.java:180)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\r\n\tat io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\r\n\tat io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\r\n\tat io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:438)\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:328)\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:302)\r\n\tat io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:253)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\r\n\tat io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:287)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\r\n\tat io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1421)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\r\n\tat io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:930)\r\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:697)\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:632)\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:549)\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:511)\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:918)\r\n\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\r\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n\tat java.base/java.lang.Thread.run(Thread.java:834)\r\n\r\n\r\n\r\nI found this [HttpClientResponseException](https://docs.micronaut.io/latest/api/io/micronaut/http/client/exceptions/HttpClientResponseException.html) documentation that describes `An exception that occurs when a response returns an error code equal to or greater than 400.`\r\n\r\nIs this really the expected behavior? It seems a little bit odd that it forces me to handle it as an exception when the error code &gt; 400.\r\n\r\nDid I do something wrong in my setup?\r\n","title":"HttpClient throws exception on response code 404. Is this by design or am I doing something wrong?","body":"<p>I am starting today with Micronaut.\nI built this controller:</p>\n<pre><code>@Controller\npublic class MyController implements MyApi{\n\n@Override\npublic String doit() {\n    throw new NotFoundException();\n    }\n}\n</code></pre>\n<p>and this exception handler:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Produces\n@Singleton\n@Requires(classes = { NotFoundException.class, ExceptionHandler.class})\npublic class NotFoundExceptionHandler implements ExceptionHandler&lt;NotFoundException, HttpResponse&gt; {\n\n    @Override\n    public HttpResponse handle(HttpRequest request, NotFoundException exception) {\n        return HttpResponseFactory.INSTANCE.status(HttpStatus.NOT_FOUND);\n    }\n}\n</code></pre>\n<p>And this test:</p>\n<pre><code>@MicronautTest\npublic class MyControllerIT {\n\n@Inject\n@Client(&quot;/&quot;)\nHttpClient client;\n\n@Test\npublic void testHello() {\n    HttpRequest&lt;String&gt; request = HttpRequest.GET(&quot;/myController&quot;);\n    HttpResponse&lt;String&gt; body = client.toBlocking().exchange(request);\n\n    assertThat(body.getStatus(), is(HttpStatus.NOT_FOUND));\n    }\n}\n</code></pre>\n<p>My expectation is that it would pass: I would get a response back with no content, HTTP code 404, message &quot;Not found&quot; and I would be done.</p>\n<p>But, instead, I get:</p>\n<pre><code>io.micronaut.http.client.exceptions.HttpClientResponseException: Not Found\n\nat io.micronaut.http.client.DefaultHttpClient$10.channelRead0(DefaultHttpClient.java:1799)\nat io.micronaut.http.client.DefaultHttpClient$10.channelRead0(DefaultHttpClient.java:1739)\nat io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.micronaut.http.netty.stream.HttpStreamsHandler.channelRead(HttpStreamsHandler.java:185)\nat io.micronaut.http.netty.stream.HttpStreamsClientHandler.channelRead(HttpStreamsClientHandler.java:180)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:438)\nat io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:328)\nat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:302)\nat io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:253)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:287)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1421)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:930)\nat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)\nat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:697)\nat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:632)\nat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:549)\nat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:511)\nat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:918)\nat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\nat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\nat java.base/java.lang.Thread.run(Thread.java:834)\n</code></pre>\n<p>I found this <a href=\"https://docs.micronaut.io/latest/api/io/micronaut/http/client/exceptions/HttpClientResponseException.html\" rel=\"nofollow noreferrer\">HttpClientResponseException</a> documentation that describes <code>An exception that occurs when a response returns an error code equal to or greater than 400.</code></p>\n<p>Is this really the expected behavior? It seems a little bit odd that it forces me to handle it as an exception when the error code &gt; 400.</p>\n<p>Did I do something wrong in my setup?</p>\n"},{"tags":["java","swing","jcombobox","netbeans-8"],"comments":[{"owner":{"account_id":9463219,"reputation":9357,"user_id":7036419,"display_name":"Maurice Perry"},"score":0,"creation_date":1684820214,"post_id":76311455,"comment_id":134568516,"body_markdown":"Is &quot;Swing design&quot; the name of the sofware you&#39;re using to design Swing forms?","body":"Is &quot;Swing design&quot; the name of the sofware you&#39;re using to design Swing forms?"},{"owner":{"account_id":6017640,"reputation":8919,"user_id":4725875,"display_name":"DevilsHnd - 退した"},"score":0,"creation_date":1684820394,"post_id":76311455,"comment_id":134568544,"body_markdown":"[This post](https://stackoverflow.com/a/22652008/4725875) may assist you.","body":"<a href=\"https://stackoverflow.com/a/22652008/4725875\">This post</a> may assist you."},{"owner":{"account_id":28121958,"reputation":69,"user_id":21488044,"display_name":"Lucia"},"score":0,"creation_date":1684820430,"post_id":76311455,"comment_id":134568552,"body_markdown":"@MauricePerry No. I use Swing design in Netbeans 8.2.","body":"@MauricePerry No. I use Swing design in Netbeans 8.2."},{"owner":{"account_id":28121958,"reputation":69,"user_id":21488044,"display_name":"Lucia"},"score":0,"creation_date":1684820550,"post_id":76311455,"comment_id":134568570,"body_markdown":"@DevilsHnd Thank you. But I use the design option in Netbeans, which is drag and drop. So some code is auto-generated and cannot be modified.","body":"@DevilsHnd Thank you. But I use the design option in Netbeans, which is drag and drop. So some code is auto-generated and cannot be modified."},{"owner":{"account_id":9463219,"reputation":9357,"user_id":7036419,"display_name":"Maurice Perry"},"score":0,"creation_date":1684821292,"post_id":76311455,"comment_id":134568677,"body_markdown":"@Lucia it can be modified: https://stackoverflow.com/a/43892689/7036419","body":"@Lucia it can be modified: <a href=\"https://stackoverflow.com/a/43892689/7036419\">stackoverflow.com/a/43892689/7036419</a>"},{"owner":{"account_id":28121958,"reputation":69,"user_id":21488044,"display_name":"Lucia"},"score":0,"creation_date":1684821672,"post_id":76311455,"comment_id":134568738,"body_markdown":"@MauricePerry Yes, I&#39;ve already followed that link. But when I drag a new combo box, the line `cbLicense.setModel(new javax.swing.DefaultComboBoxModel&lt;&gt;(new String[] { &quot;Item 1&quot;, &quot;Item 2&quot;, &quot;Item 3&quot;, &quot;Item 4&quot; }));` is created automatically. Even I changed data type after that, that line is still there.","body":"@MauricePerry Yes, I&#39;ve already followed that link. But when I drag a new combo box, the line <code>cbLicense.setModel(new javax.swing.DefaultComboBoxModel&lt;&gt;(new String[] { &quot;Item 1&quot;, &quot;Item 2&quot;, &quot;Item 3&quot;, &quot;Item 4&quot; }));</code> is created automatically. Even I changed data type after that, that line is still there."},{"owner":{"account_id":9463219,"reputation":9357,"user_id":7036419,"display_name":"Maurice Perry"},"score":0,"creation_date":1684821806,"post_id":76311455,"comment_id":134568753,"body_markdown":"Use `Custom creation code` in the `Code` tab of the combobox properties","body":"Use <code>Custom creation code</code> in the <code>Code</code> tab of the combobox properties"},{"owner":{"account_id":9463219,"reputation":9357,"user_id":7036419,"display_name":"Maurice Perry"},"score":0,"creation_date":1684822123,"post_id":76311455,"comment_id":134568795,"body_markdown":"@Lucia or right-click on the combobox, and select &quot;Customize code...&quot;","body":"@Lucia or right-click on the combobox, and select &quot;Customize code...&quot;"},{"owner":{"account_id":28121958,"reputation":69,"user_id":21488044,"display_name":"Lucia"},"score":0,"creation_date":1684822294,"post_id":76311455,"comment_id":134568822,"body_markdown":"@MauricePerry I have declared CustomerItem outside of the generation code section. Now I added those code into Custom creation code:\n`cbLicense = CustomerItem[] items = new CustomerItem[3];\nitems[0] = new CustomerItem(&quot;oh&quot;, false);\nitems[1] = new CustomerItem(&quot;My&quot;, false);\nitems[2] = new CustomerItem(&quot;God&quot;, false);\n\n        DefaultComboBoxModel&lt;CustomerItem&gt; model = new DefaultComboBoxModel&lt;&gt;(items);\n        cbLicense.setModel(model);\n        cbLicense.setRenderer(new RenderCheckComboBox());`","body":"@MauricePerry I have declared CustomerItem outside of the generation code section. Now I added those code into Custom creation code: <code>cbLicense = CustomerItem[] items = new CustomerItem[3]; items[0] = new CustomerItem(&quot;oh&quot;, false); items[1] = new CustomerItem(&quot;My&quot;, false); items[2] = new CustomerItem(&quot;God&quot;, false);          DefaultComboBoxModel&lt;CustomerItem&gt; model = new DefaultComboBoxModel&lt;&gt;(items);         cbLicense.setModel(model);         cbLicense.setRenderer(new RenderCheckComboBox());</code>"},{"owner":{"account_id":28121958,"reputation":69,"user_id":21488044,"display_name":"Lucia"},"score":0,"creation_date":1684822446,"post_id":76311455,"comment_id":134568851,"body_markdown":"@MauricePerry I do apologise if it&#39;s hard to read my comment. I dont know to format code on comment. But an error has occured on the line: `cbLicense = CustomerItem[] items = new CustomerItem[3];`. And with this way, can I retrieve value from the database into combo box?","body":"@MauricePerry I do apologise if it&#39;s hard to read my comment. I dont know to format code on comment. But an error has occured on the line: <code>cbLicense = CustomerItem[] items = new CustomerItem[3];</code>. And with this way, can I retrieve value from the database into combo box?"},{"owner":{"account_id":9463219,"reputation":9357,"user_id":7036419,"display_name":"Maurice Perry"},"score":0,"creation_date":1684822570,"post_id":76311455,"comment_id":134568872,"body_markdown":"Try `new DefaultComboBoxModel&lt;&gt;(new CustomerItem[]{\nnew CustomerItem(&quot;oh&quot;, false), new CustomerItem(&quot;My&quot;, false), new CustomerItem(&quot;God&quot;, false)\n\n})`","body":"Try <code>new DefaultComboBoxModel&lt;&gt;(new CustomerItem[]{ new CustomerItem(&quot;oh&quot;, false), new CustomerItem(&quot;My&quot;, false), new CustomerItem(&quot;God&quot;, false)  })</code>"},{"owner":{"account_id":28121958,"reputation":69,"user_id":21488044,"display_name":"Lucia"},"score":0,"creation_date":1684822945,"post_id":76311455,"comment_id":134568948,"body_markdown":"@MauricePerry It automatically added `cbLicense =` before your code.\n        `cbLicense = DefaultComboBoxModel&lt;CustomerItem&gt; model = new DefaultComboBoxModel&lt;&gt;(new CustomerItem[]{\n            new CustomerItem(&quot;oh&quot;, false),\n            new CustomerItem(&quot;My&quot;, false),\n            new CustomerItem(&quot;God&quot;, false)\n        });\n        cbLicense.setModel(model);\n        cbLicense.setRenderer(new RenderCheckComboBox());`","body":"@MauricePerry It automatically added <code>cbLicense =</code> before your code.         <code>cbLicense = DefaultComboBoxModel&lt;CustomerItem&gt; model = new DefaultComboBoxModel&lt;&gt;(new CustomerItem[]{             new CustomerItem(&quot;oh&quot;, false),             new CustomerItem(&quot;My&quot;, false),             new CustomerItem(&quot;God&quot;, false)         });         cbLicense.setModel(model);         cbLicense.setRenderer(new RenderCheckComboBox());</code>"},{"owner":{"account_id":28121958,"reputation":69,"user_id":21488044,"display_name":"Lucia"},"score":0,"creation_date":1684823177,"post_id":76311455,"comment_id":134569002,"body_markdown":"@MauricePerry Oh, this is `Custom creation Code` so it will automatically add `cbLicense =`. But I wanna make changes on `cbLicense.setModel`.","body":"@MauricePerry Oh, this is <code>Custom creation Code</code> so it will automatically add <code>cbLicense =</code>. But I wanna make changes on <code>cbLicense.setModel</code>."},{"owner":{"account_id":9463219,"reputation":9357,"user_id":7036419,"display_name":"Maurice Perry"},"score":0,"creation_date":1684823843,"post_id":76311455,"comment_id":134569134,"body_markdown":"@Lucia two possible solutions: 1) right-click on the combobox and select &quot;Customize code...&quot;, 2) `new JComboBox&lt;&gt;(new DefaultComboBoxModel&lt;&gt;(new CustomerItem[]{ new CustomerItem(&quot;oh&quot;, false), new CustomerItem(&quot;My&quot;, false), new CustomerItem(&quot;God&quot;, false)  }))`","body":"@Lucia two possible solutions: 1) right-click on the combobox and select &quot;Customize code...&quot;, 2) <code>new JComboBox&lt;&gt;(new DefaultComboBoxModel&lt;&gt;(new CustomerItem[]{ new CustomerItem(&quot;oh&quot;, false), new CustomerItem(&quot;My&quot;, false), new CustomerItem(&quot;God&quot;, false)  }))</code>"}],"answers":[{"tags":[],"owner":{"account_id":9463219,"reputation":9357,"user_id":7036419,"display_name":"Maurice Perry"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684823994,"creation_date":1684823994,"answer_id":76311909,"question_id":76311455,"body_markdown":"Right-click on the combobox, and select &quot;Customize code...&quot;:\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/NNKfV.png","title":"Modify data type of JComboBox in Swing","body":"<p>Right-click on the combobox, and select &quot;Customize code...&quot;:</p>\n<p><a href=\"https://i.stack.imgur.com/NNKfV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NNKfV.png\" alt=\"enter image description here\" /></a></p>\n"}],"owner":{"account_id":28121958,"reputation":69,"user_id":21488044,"display_name":"Lucia"},"comment_count":14,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":52,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1684849238,"creation_date":1684818956,"question_id":76311455,"body_markdown":"I was trying to modify the data type of a combo box named `cbLicense` in Swing. In this case, I wanna change from `String` to `CustomerItem` which is a class. I use Swing design, so I selected the combo box, went to Properties/Code/TypeParameters. But the problem is that on the `Generated Code` section, there&#39;s still a line:\r\n\r\n`cbLicense.setModel(new javax.swing.DefaultComboBoxModel&lt;&gt;(new String[] { &quot;Item 1&quot;, &quot;Item 2&quot;, &quot;Item 3&quot;, &quot;Item 4&quot; }));`\r\n\r\nThis line has an incompatible type error. So how do I fix it? Do I need to add each `CustomerItem `object into `cbLicense `via Design view? Because the `CustomerItem `value is retrieved from the database.\r\n\r\nFind the way to customize combo box in Swing","title":"Modify data type of JComboBox in Swing","body":"<p>I was trying to modify the data type of a combo box named <code>cbLicense</code> in Swing. In this case, I wanna change from <code>String</code> to <code>CustomerItem</code> which is a class. I use Swing design, so I selected the combo box, went to Properties/Code/TypeParameters. But the problem is that on the <code>Generated Code</code> section, there's still a line:</p>\n<p><code>cbLicense.setModel(new javax.swing.DefaultComboBoxModel&lt;&gt;(new String[] { &quot;Item 1&quot;, &quot;Item 2&quot;, &quot;Item 3&quot;, &quot;Item 4&quot; }));</code></p>\n<p>This line has an incompatible type error. So how do I fix it? Do I need to add each <code>CustomerItem </code>object into <code>cbLicense </code>via Design view? Because the <code>CustomerItem </code>value is retrieved from the database.</p>\n<p>Find the way to customize combo box in Swing</p>\n"},{"tags":["java","spring-mvc","authentication","spring-security"],"answers":[{"comments":[{"owner":{"account_id":170337,"reputation":1872,"user_id":1792216,"accept_rate":82,"display_name":"Emiliano Schiano"},"score":1,"creation_date":1418760211,"post_id":27512275,"comment_id":43456122,"body_markdown":"It seems thar that method (registerAuthentication(AuthenticationManagerBuilder auth))is not part of WebSecurityConfigurerAdapter. Wich class are you extending from?","body":"It seems thar that method (registerAuthentication(AuthenticationManagerBuilder auth))is not part of WebSecurityConfigurerAdapter. Wich class are you extending from?"},{"owner":{"account_id":981284,"reputation":27959,"user_id":1000933,"display_name":"Master Slave"},"score":1,"creation_date":1418761461,"post_id":27512275,"comment_id":43456766,"body_markdown":"I&#39;ve missed the version that you mentioned in the user, I believe that for 3.2.3 the config should be @Autowired\n\tpublic void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {, I&#39;ll edit in the question","body":"I&#39;ve missed the version that you mentioned in the user, I believe that for 3.2.3 the config should be @Autowired \tpublic void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {, I&#39;ll edit in the question"},{"owner":{"account_id":170337,"reputation":1872,"user_id":1792216,"accept_rate":82,"display_name":"Emiliano Schiano"},"score":1,"creation_date":1418762058,"post_id":27512275,"comment_id":43457089,"body_markdown":"You are totally right! In the meantime I googled that and I found in the Spring changelog for that version that the method has been renamed. I rewrote my code and now it works!\nThank you very much for your help!\nRegards.","body":"You are totally right! In the meantime I googled that and I found in the Spring changelog for that version that the method has been renamed. I rewrote my code and now it works! Thank you very much for your help! Regards."}],"tags":[],"owner":{"account_id":981284,"reputation":27959,"user_id":1000933,"display_name":"Master Slave"},"comment_count":3,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1593937255,"creation_date":1418757650,"answer_id":27512275,"question_id":27503285,"body_markdown":"You should register your custom authentication in SecurityConfig class which have extended WebSecurityConfigureAdapter: \r\n\r\n    @Autowired\r\n    private MyUserDetailsService userDetailsService;\r\n \r\n    @Override\r\n    protected void configure(AuthenticationManagerBuilder auth) \r\n          throws Exception {\r\n    \tauth.userDetailsService(this.userDetailsService);\r\n    }\r\n\r\nfor 3.2.3 the config should be\r\n\r\n    @Autowired\r\n\tpublic void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\r\n        auth.userDetailsService(this.userDetailsService);\r\n    }","title":"Spring Security service configuration","body":"<p>You should register your custom authentication in SecurityConfig class which have extended WebSecurityConfigureAdapter:</p>\n<pre><code>@Autowired\nprivate MyUserDetailsService userDetailsService;\n\n@Override\nprotected void configure(AuthenticationManagerBuilder auth) \n      throws Exception {\n    auth.userDetailsService(this.userDetailsService);\n}\n</code></pre>\n<p>for 3.2.3 the config should be</p>\n<pre><code>@Autowired\npublic void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n    auth.userDetailsService(this.userDetailsService);\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":9072254,"reputation":1014,"user_id":6754986,"display_name":"LinFelix"},"score":1,"creation_date":1684851702,"post_id":76315187,"comment_id":134575704,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/76315187/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":28662752,"reputation":11,"user_id":21947367,"display_name":"PRANJAL"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1684848773,"creation_date":1684847492,"answer_id":76315187,"question_id":27503285,"body_markdown":"    @Component\r\n    public class JwtUtil {\r\n\r\n    @Value(&quot;${jwt.secret}&quot;)\r\n    private String secret;\r\n\r\n    @Value(&quot;${jwt.expiration}&quot;)\r\n    private Long expiration;\r\n\r\n    Date now = new Date();\r\n    Date ExpirationDate = new Date(now.getTime() + expiration * 1000);\r\n\r\n    public User getUser(final String token) {\r\n        Claims body = Jwts.parser()\r\n            .setSigningKey(secret)\r\n            .parseClaimsJws(token)\r\n            .getBody();\r\n\r\n        User u = new User();\r\n        u.setUsername(body.getSubject());\r\n        u.setUserId(Integer.parseInt((String) body.get(&quot;userId&quot;)));\r\n        Set &lt; Role &gt; roles = new HashSet &lt; &gt; ();\r\n        roles.add(Role.CONSUMER);\r\n        roles.add(Role.SELLER);\r\n        u.setRoles(roles);\r\n        return u;\r\n    }\r\n\r\n    public String generateToken(String username) {\r\n        User u = new User();\r\n        Claims claims = Jwts.claims().setSubject(username);\r\n        claims.put(&quot;userId&quot;, u.getUserId());\r\n        Set &lt; Role &gt; roles = new HashSet &lt; &gt; ();\r\n        roles.add(Role.CONSUMER);\r\n        roles.add(Role.SELLER);\r\n        claims.put(&quot;role&quot;, roles);\r\n\r\n        return Jwts.builder()\r\n            .setClaims(claims)\r\n            .setIssuedAt(now)\r\n            .setExpiration(ExpirationDate)\r\n            .signWith(SignatureAlgorithm.HS512, secret)\r\n            .compact();\r\n\r\n    }\r\n\r\n    public boolean validateToken(final String token) {\r\n        return getClaims(secret, token)\r\n            .getExpiration()\r\n            .after(new Date(System.currentTimeMillis()));\r\n    }\r\n\r\n    public Claims getClaims(String secret, String token) {\r\n        return Jwts.parser()\r\n            .setSigningKey(secret)\r\n            .parseClaimsJws(token)\r\n            .getBody();\r\n    }\r\n    public Boolean validateToken(String token, UserDetails userDetails) {\r\n\r\n        String username = extractUsername(token);\r\n\r\n        return (username.equals(userDetails.getUsername()) &amp;&amp; !isTokenExpired(token));\r\n\r\n    }\r\n\r\n\r\n    public String extractUsername(String token) {\r\n\r\n        return extractClaim(token, Claims::getSubject);\r\n\r\n    }\r\n\r\n\r\n    public String extractRole(String token) {\r\n\r\n        return (String) extractClaim(token, claims - &gt; claims.get(&quot;role&quot;));\r\n\r\n    }\r\n\r\n\r\n    public Date extractExpiration(String token) {\r\n\r\n        return extractClaim(token, Claims::getExpiration);\r\n\r\n    }\r\n\r\n\r\n    public &lt; T &gt; T extractClaim(String token, Function &lt; Claims, T &gt; claimsResolver) {\r\n\r\n        final Claims claims = extractAllClaims(token);\r\n\r\n        return claimsResolver.apply(claims);\r\n\r\n    }\r\n\r\n\r\n    private Claims extractAllClaims(String token) {\r\n\r\n        return Jwts.parser().setSigningKey(secret).parseClaimsJws(token).getBody();\r\n\r\n    }\r\n\r\n\r\n    private Boolean isTokenExpired(String token) {\r\n\r\n        final Date expiration = extractExpiration(token);\r\n\r\n        return expiration.before(new Date());\r\n\r\n    }\r\n    }\r\n\r\n\r\n    @Component\r\n    public class JwtAuthenticationFilter extends OncePerRequestFilter {\r\n\r\n\r\n    @Autowired\r\n    private JwtUtil jwtTokenUtil;\r\n\r\n\r\n    @Autowired\r\n    private UserDetailsService userDetailsService;\r\n\r\n\r\n    @Override\r\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws ServletException, IOException {\r\n\r\n        final String authorizationHeader = request.getHeader(&quot;Authorization&quot;);\r\n        String username = null;\r\n        String jwt = null;\r\n\r\n\r\n        if (authorizationHeader != null &amp;&amp; authorizationHeader.startsWith(&quot;JWT &quot;)) {\r\n\r\n            jwt = authorizationHeader.substring(7);\r\n            username = jwtTokenUtil.extractUsername(jwt);\r\n\r\n        }\r\n\r\n\r\n        if (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) {\r\n\r\n            UserDetails userDetails = this.userDetailsService.loadUserByUsername(username);\r\n\r\n\r\n            if (jwtTokenUtil.validateToken(jwt, userDetails)) {\r\n\r\n                UsernamePasswordAuthenticationToken usernamePasswordAuthenticationToken = new UsernamePasswordAuthenticationToken(\r\n\r\n                    userDetails, null, userDetails.getAuthorities());\r\n\r\n                usernamePasswordAuthenticationToken.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\r\n\r\n                SecurityContextHolder.getContext().setAuthentication(usernamePasswordAuthenticationToken);\r\n\r\n            }\r\n\r\n        }\r\n\r\n        chain.doFilter(request, response);\r\n\r\n    }\r\n\r\n    }\r\n\r\n    @Configuration\r\n    @EnableWebSecurity\r\n    @EnableGlobalMethodSecurity(prePostEnabled = true)\r\n    public class ApiSecurityConfig extends WebSecurityConfigurerAdapter {\r\n\r\n    @Autowired\r\n    private ApiAuthenticationEntryPoint jwtAuthenticationEntryPoint;\r\n\r\n\r\n    @Autowired\r\n    private JwtAuthenticationFilter jwtAuthorizationFilter;\r\n\r\n\r\n    @Autowired\r\n    private UserAuthService jwtUserDetailsService;\r\n\r\n\r\n\r\n    @Bean\r\n    public PasswordEncoder passwordEncoder() {\r\n\r\n        return new BCryptPasswordEncoder();\r\n\r\n    }\r\n\r\n    @Autowired\r\n    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\r\n\r\n        auth.userDetailsService(jwtUserDetailsService).passwordEncoder(passwordEncoder());\r\n\r\n    }\r\n\r\n    @Override\r\n    public void configure(WebSecurity web) throws Exception {\r\n\r\n    }\r\n\r\n    @Autowired\r\n    public void configure(AuthenticationManagerBuilder auth) throws Exception {\r\n        auth.userDetailsService(this.jwtUserDetailsService);\r\n    }\r\n\r\n    @Override\r\n    protected void configure(HttpSecurity http) throws Exception {\r\n        http.csrf().disable()\r\n            .authorizeRequests()\r\n            .antMatchers(HttpMethod.POST, &quot;/authenticate&quot;).permitAll()\r\n            .antMatchers(&quot;/api/public/**&quot;).permitAll()\r\n            .antMatchers(&quot;/api/auth/consumer/**&quot;).hasRole(&quot;CONSUMER&quot;)\r\n            .antMatchers(&quot;/api/auth/seller/**&quot;).hasRole(&quot;SELLER&quot;)\r\n            .anyRequest().authenticated()\r\n            .and()\r\n            .exceptionHandling().authenticationEntryPoint(jwtAuthenticationEntryPoint)\r\n            .and()\r\n            .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);\r\n\r\n\r\n        http.addFilterBefore(jwtAuthorizationFilter, UsernamePasswordAuthenticationFilter.class);\r\n\r\n    }\r\n\r\n    @Bean\r\n    public RegistrationBean jwtAuthFilterRegister(JwtAuthenticationFilter filter) {\r\n        FilterRegistrationBean registrationBean = new FilterRegistrationBean(filter);\r\n        registrationBean.setEnabled(false);\r\n        return registrationBean;\r\n    }\r\n\r\n    @Bean\r\n    @Override\r\n    public AuthenticationManager authenticationManagerBean() throws Exception {\r\n        return super.authenticationManagerBean();\r\n    }\r\n\r\n\r\n    }\r\n\r\n\r\n    @Component\r\n    public class ApiAuthenticationEntryPoint implements AuthenticationEntryPoint {\r\n\t@Override\r\n\tpublic void commence(HttpServletRequest request, HttpServletResponse response,\r\n\t\t\tAuthenticationException authException) throws IOException, ServletException {\r\n\t\r\n\t\tresponse.sendError(HttpServletResponse.SC_UNAUTHORIZED, &quot;Unauthorized&quot;);\r\n\t}\r\n    }\r\n\r\n    @Service\r\n    public class AuthService {\r\n\r\n    @Autowired\r\n    private UserRepo userRepository;\r\n\r\n    @Autowired\r\n    private JwtUtil jwtutil;\r\n\r\n\r\n    public String authenticate(String username, String password) throws AuthenticationException {\r\n        Optional &lt; User &gt; user = userRepository.findByUsername(username);\r\n        if (user == null) {\r\n            throw new AuthenticationException(&quot;Invalid username or password&quot;);\r\n        }\r\n        return jwtutil.generateToken(username);\r\n    }\r\n\r\n\r\n\r\n    }\r\n\r\n    @Service\r\n    public class ProductService {\r\n\r\n    @Autowired\r\n    private ProductRepo productRepository;\r\n\r\n    public List &lt; Product &gt; searchProducts(String keyword) {\r\n        return productRepository.findByProductNameContainingIgnoreCaseOrCategoryCategoryNameContainingIgnoreCase(keyword, keyword);\r\n    }\r\n\r\n    }\r\n\r\n    @RestController\r\n    @RequestMapping(&quot;/api/public&quot;)\r\n    public class PublicController {\r\n\r\n    @Autowired\r\n    private ProductService productService;\r\n\r\n    @Autowired\r\n    private AuthService authService;\r\n\r\n    @GetMapping(&quot;/product/search&quot;)\r\n    public List &lt; Product &gt; searchProducts(@RequestParam(&quot;keyword&quot;) String keyword) {\r\n        return productService.searchProducts(keyword);\r\n    }\r\n\r\n    @PostMapping(&quot;/login&quot;)\r\n    public ResponseEntity &lt; String &gt; login(@RequestBody User credentials) {\r\n        try {\r\n            String token = null;\r\n            try {\r\n                token = authService.authenticate(credentials.getUsername(), credentials.getPassword());\r\n            } catch (javax.naming.AuthenticationException e) {\r\n                // TODO Auto-generated catch block\r\n                e.printStackTrace();\r\n            }\r\n            return ResponseEntity.ok(token);\r\n        } catch (AuthenticationException e) {\r\n            return ResponseEntity.status(HttpStatus.UNAUTHORIZED).build();\r\n        }\r\n    }\r\n\r\n    }","title":"Spring Security service configuration","body":"<pre><code>@Component\npublic class JwtUtil {\n\n@Value(&quot;${jwt.secret}&quot;)\nprivate String secret;\n\n@Value(&quot;${jwt.expiration}&quot;)\nprivate Long expiration;\n\nDate now = new Date();\nDate ExpirationDate = new Date(now.getTime() + expiration * 1000);\n\npublic User getUser(final String token) {\n    Claims body = Jwts.parser()\n        .setSigningKey(secret)\n        .parseClaimsJws(token)\n        .getBody();\n\n    User u = new User();\n    u.setUsername(body.getSubject());\n    u.setUserId(Integer.parseInt((String) body.get(&quot;userId&quot;)));\n    Set &lt; Role &gt; roles = new HashSet &lt; &gt; ();\n    roles.add(Role.CONSUMER);\n    roles.add(Role.SELLER);\n    u.setRoles(roles);\n    return u;\n}\n\npublic String generateToken(String username) {\n    User u = new User();\n    Claims claims = Jwts.claims().setSubject(username);\n    claims.put(&quot;userId&quot;, u.getUserId());\n    Set &lt; Role &gt; roles = new HashSet &lt; &gt; ();\n    roles.add(Role.CONSUMER);\n    roles.add(Role.SELLER);\n    claims.put(&quot;role&quot;, roles);\n\n    return Jwts.builder()\n        .setClaims(claims)\n        .setIssuedAt(now)\n        .setExpiration(ExpirationDate)\n        .signWith(SignatureAlgorithm.HS512, secret)\n        .compact();\n\n}\n\npublic boolean validateToken(final String token) {\n    return getClaims(secret, token)\n        .getExpiration()\n        .after(new Date(System.currentTimeMillis()));\n}\n\npublic Claims getClaims(String secret, String token) {\n    return Jwts.parser()\n        .setSigningKey(secret)\n        .parseClaimsJws(token)\n        .getBody();\n}\npublic Boolean validateToken(String token, UserDetails userDetails) {\n\n    String username = extractUsername(token);\n\n    return (username.equals(userDetails.getUsername()) &amp;&amp; !isTokenExpired(token));\n\n}\n\n\npublic String extractUsername(String token) {\n\n    return extractClaim(token, Claims::getSubject);\n\n}\n\n\npublic String extractRole(String token) {\n\n    return (String) extractClaim(token, claims - &gt; claims.get(&quot;role&quot;));\n\n}\n\n\npublic Date extractExpiration(String token) {\n\n    return extractClaim(token, Claims::getExpiration);\n\n}\n\n\npublic &lt; T &gt; T extractClaim(String token, Function &lt; Claims, T &gt; claimsResolver) {\n\n    final Claims claims = extractAllClaims(token);\n\n    return claimsResolver.apply(claims);\n\n}\n\n\nprivate Claims extractAllClaims(String token) {\n\n    return Jwts.parser().setSigningKey(secret).parseClaimsJws(token).getBody();\n\n}\n\n\nprivate Boolean isTokenExpired(String token) {\n\n    final Date expiration = extractExpiration(token);\n\n    return expiration.before(new Date());\n\n}\n}\n\n\n@Component\npublic class JwtAuthenticationFilter extends OncePerRequestFilter {\n\n\n@Autowired\nprivate JwtUtil jwtTokenUtil;\n\n\n@Autowired\nprivate UserDetailsService userDetailsService;\n\n\n@Override\nprotected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws ServletException, IOException {\n\n    final String authorizationHeader = request.getHeader(&quot;Authorization&quot;);\n    String username = null;\n    String jwt = null;\n\n\n    if (authorizationHeader != null &amp;&amp; authorizationHeader.startsWith(&quot;JWT &quot;)) {\n\n        jwt = authorizationHeader.substring(7);\n        username = jwtTokenUtil.extractUsername(jwt);\n\n    }\n\n\n    if (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) {\n\n        UserDetails userDetails = this.userDetailsService.loadUserByUsername(username);\n\n\n        if (jwtTokenUtil.validateToken(jwt, userDetails)) {\n\n            UsernamePasswordAuthenticationToken usernamePasswordAuthenticationToken = new UsernamePasswordAuthenticationToken(\n\n                userDetails, null, userDetails.getAuthorities());\n\n            usernamePasswordAuthenticationToken.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\n\n            SecurityContextHolder.getContext().setAuthentication(usernamePasswordAuthenticationToken);\n\n        }\n\n    }\n\n    chain.doFilter(request, response);\n\n}\n\n}\n\n@Configuration\n@EnableWebSecurity\n@EnableGlobalMethodSecurity(prePostEnabled = true)\npublic class ApiSecurityConfig extends WebSecurityConfigurerAdapter {\n\n@Autowired\nprivate ApiAuthenticationEntryPoint jwtAuthenticationEntryPoint;\n\n\n@Autowired\nprivate JwtAuthenticationFilter jwtAuthorizationFilter;\n\n\n@Autowired\nprivate UserAuthService jwtUserDetailsService;\n\n\n\n@Bean\npublic PasswordEncoder passwordEncoder() {\n\n    return new BCryptPasswordEncoder();\n\n}\n\n@Autowired\npublic void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n\n    auth.userDetailsService(jwtUserDetailsService).passwordEncoder(passwordEncoder());\n\n}\n\n@Override\npublic void configure(WebSecurity web) throws Exception {\n\n}\n\n@Autowired\npublic void configure(AuthenticationManagerBuilder auth) throws Exception {\n    auth.userDetailsService(this.jwtUserDetailsService);\n}\n\n@Override\nprotected void configure(HttpSecurity http) throws Exception {\n    http.csrf().disable()\n        .authorizeRequests()\n        .antMatchers(HttpMethod.POST, &quot;/authenticate&quot;).permitAll()\n        .antMatchers(&quot;/api/public/**&quot;).permitAll()\n        .antMatchers(&quot;/api/auth/consumer/**&quot;).hasRole(&quot;CONSUMER&quot;)\n        .antMatchers(&quot;/api/auth/seller/**&quot;).hasRole(&quot;SELLER&quot;)\n        .anyRequest().authenticated()\n        .and()\n        .exceptionHandling().authenticationEntryPoint(jwtAuthenticationEntryPoint)\n        .and()\n        .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);\n\n\n    http.addFilterBefore(jwtAuthorizationFilter, UsernamePasswordAuthenticationFilter.class);\n\n}\n\n@Bean\npublic RegistrationBean jwtAuthFilterRegister(JwtAuthenticationFilter filter) {\n    FilterRegistrationBean registrationBean = new FilterRegistrationBean(filter);\n    registrationBean.setEnabled(false);\n    return registrationBean;\n}\n\n@Bean\n@Override\npublic AuthenticationManager authenticationManagerBean() throws Exception {\n    return super.authenticationManagerBean();\n}\n\n\n}\n\n\n@Component\npublic class ApiAuthenticationEntryPoint implements AuthenticationEntryPoint {\n@Override\npublic void commence(HttpServletRequest request, HttpServletResponse response,\n        AuthenticationException authException) throws IOException, ServletException {\n\n    response.sendError(HttpServletResponse.SC_UNAUTHORIZED, &quot;Unauthorized&quot;);\n}\n}\n\n@Service\npublic class AuthService {\n\n@Autowired\nprivate UserRepo userRepository;\n\n@Autowired\nprivate JwtUtil jwtutil;\n\n\npublic String authenticate(String username, String password) throws AuthenticationException {\n    Optional &lt; User &gt; user = userRepository.findByUsername(username);\n    if (user == null) {\n        throw new AuthenticationException(&quot;Invalid username or password&quot;);\n    }\n    return jwtutil.generateToken(username);\n}\n\n\n\n}\n\n@Service\npublic class ProductService {\n\n@Autowired\nprivate ProductRepo productRepository;\n\npublic List &lt; Product &gt; searchProducts(String keyword) {\n    return productRepository.findByProductNameContainingIgnoreCaseOrCategoryCategoryNameContainingIgnoreCase(keyword, keyword);\n}\n\n}\n\n@RestController\n@RequestMapping(&quot;/api/public&quot;)\npublic class PublicController {\n\n@Autowired\nprivate ProductService productService;\n\n@Autowired\nprivate AuthService authService;\n\n@GetMapping(&quot;/product/search&quot;)\npublic List &lt; Product &gt; searchProducts(@RequestParam(&quot;keyword&quot;) String keyword) {\n    return productService.searchProducts(keyword);\n}\n\n@PostMapping(&quot;/login&quot;)\npublic ResponseEntity &lt; String &gt; login(@RequestBody User credentials) {\n    try {\n        String token = null;\n        try {\n            token = authService.authenticate(credentials.getUsername(), credentials.getPassword());\n        } catch (javax.naming.AuthenticationException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n        return ResponseEntity.ok(token);\n    } catch (AuthenticationException e) {\n        return ResponseEntity.status(HttpStatus.UNAUTHORIZED).build();\n    }\n}\n\n}\n</code></pre>\n"}],"owner":{"account_id":170337,"reputation":1872,"user_id":1792216,"accept_rate":82,"display_name":"Emiliano Schiano"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2591,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":27512275,"answer_count":2,"score":3,"last_activity_date":1684848773,"creation_date":1418728280,"question_id":27503285,"body_markdown":"I&#39;m trying to build a Java EE app prototype using different frameworks. Everything works fine except the security layer. I chose to use Spring Security configured with Spring configuration.\r\n\r\nThe code is like this:\r\n\r\n**Spring Security Config**\r\n\r\n    @Configuration\r\n    @EnableWebMvcSecurity\r\n    public class SecurityConfig extends WebSecurityConfigurerAdapter\r\n    {\r\n    \t@Autowired\r\n    \tprivate MyUserDetailsService userDetailsService;\r\n    \r\n    \t@Override\r\n    \tprotected UserDetailsService userDetailsService () {\r\n    \t\treturn this.userDetailsService;\r\n    \t}\r\n    \r\n    \t@Override\r\n    \tpublic void configure(WebSecurity web) throws Exception {\r\n    \t\tweb\r\n    \t\t.ignoring()\r\n    \t\t.antMatchers(&quot;/resources/**&quot;);\r\n    \t}\r\n    \r\n    \t@Override\r\n    \tprotected void configure(HttpSecurity http) throws Exception {\r\n    \t\thttp\r\n    \t\t.formLogin()\r\n    \t\t.loginPage(&quot;/login&quot;)\r\n    \t\t.loginProcessingUrl(&quot;/login/authenticate&quot;)\r\n    \t\t.failureUrl(&quot;/login?error=bad_credentials&quot;)\r\n    \t\t.and()\r\n    \t\t.logout()\r\n    \t\t.logoutUrl(&quot;/signout&quot;)\r\n    \t\t.deleteCookies(&quot;JSESSIONID&quot;)\r\n    \t\t.and()\r\n    \t\t.authorizeRequests()\r\n    \t\t.antMatchers(&quot;/admin/**&quot;).hasRole(&quot;ADMIN&quot;)\r\n    \t\t.antMatchers(&quot;/**&quot;).permitAll()\r\n    \t\t.and()\r\n    \t\t.csrf();\r\n    \t}\r\n    }\r\n\r\n**User Detail Service**\r\n\r\n    @Service(&quot;myUserDetailsService&quot;)\r\n    public class MyUserDetailsService implements UserDetailsService\r\n    {\r\n        public static final Logger log = Logger.getLogger(MyUserDetailsService.class);\r\n    \r\n        public MyUserDetailsService() {\r\n        }\r\n    \r\n        @Autowired\r\n        private UserDao userDao;\r\n    \r\n        @Override\r\n        public UserDetails loadUserByUsername(String userName) throws UsernameNotFoundException {\r\n            final User user = getSystemUser(userName);\r\n            final List&lt;GrantedAuthority&gt; authorities = getUserAuthorities(user);\r\n            return buildUserForAuthentication(user, authorities);\r\n        }\r\n    \r\n        private User buildUserForAuthentication(User user, List&lt;GrantedAuthority&gt; authorities) {\r\n            //...\r\n        }\r\n    \r\n        private User getSystemUser(String alias) {\r\n        \t//...\r\n        }\r\n    \r\n        private List&lt;GrantedAuthority&gt; getUserAuthorities(User user) {\r\n        \t//...\r\n            return null;\r\n        }\r\n    }\r\n\r\nWhat I&#39;m expecting this code to do is that when `/login/authenticate` is reached with the user &amp; pass params, the underlying spring code invokes my user service, but this never happens.\r\n\r\nWhat am I missing?\r\n\r\nI&#39;m using spring-security 3.2.3.RELEASE.","title":"Spring Security service configuration","body":"<p>I'm trying to build a Java EE app prototype using different frameworks. Everything works fine except the security layer. I chose to use Spring Security configured with Spring configuration.</p>\n\n<p>The code is like this:</p>\n\n<p><strong>Spring Security Config</strong></p>\n\n<pre><code>@Configuration\n@EnableWebMvcSecurity\npublic class SecurityConfig extends WebSecurityConfigurerAdapter\n{\n    @Autowired\n    private MyUserDetailsService userDetailsService;\n\n    @Override\n    protected UserDetailsService userDetailsService () {\n        return this.userDetailsService;\n    }\n\n    @Override\n    public void configure(WebSecurity web) throws Exception {\n        web\n        .ignoring()\n        .antMatchers(\"/resources/**\");\n    }\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http\n        .formLogin()\n        .loginPage(\"/login\")\n        .loginProcessingUrl(\"/login/authenticate\")\n        .failureUrl(\"/login?error=bad_credentials\")\n        .and()\n        .logout()\n        .logoutUrl(\"/signout\")\n        .deleteCookies(\"JSESSIONID\")\n        .and()\n        .authorizeRequests()\n        .antMatchers(\"/admin/**\").hasRole(\"ADMIN\")\n        .antMatchers(\"/**\").permitAll()\n        .and()\n        .csrf();\n    }\n}\n</code></pre>\n\n<p><strong>User Detail Service</strong></p>\n\n<pre><code>@Service(\"myUserDetailsService\")\npublic class MyUserDetailsService implements UserDetailsService\n{\n    public static final Logger log = Logger.getLogger(MyUserDetailsService.class);\n\n    public MyUserDetailsService() {\n    }\n\n    @Autowired\n    private UserDao userDao;\n\n    @Override\n    public UserDetails loadUserByUsername(String userName) throws UsernameNotFoundException {\n        final User user = getSystemUser(userName);\n        final List&lt;GrantedAuthority&gt; authorities = getUserAuthorities(user);\n        return buildUserForAuthentication(user, authorities);\n    }\n\n    private User buildUserForAuthentication(User user, List&lt;GrantedAuthority&gt; authorities) {\n        //...\n    }\n\n    private User getSystemUser(String alias) {\n        //...\n    }\n\n    private List&lt;GrantedAuthority&gt; getUserAuthorities(User user) {\n        //...\n        return null;\n    }\n}\n</code></pre>\n\n<p>What I'm expecting this code to do is that when <code>/login/authenticate</code> is reached with the user &amp; pass params, the underlying spring code invokes my user service, but this never happens.</p>\n\n<p>What am I missing?</p>\n\n<p>I'm using spring-security 3.2.3.RELEASE.</p>\n"},{"tags":["java","authentication","servlets","jakarta-ee"],"answers":[{"comments":[{"owner":{"account_id":15557006,"reputation":1504,"user_id":11756421,"display_name":"DistantBlue"},"score":0,"creation_date":1570192832,"post_id":58236041,"comment_id":102846069,"body_markdown":"Thanks for an answer. Didn&#39;t know about container managed authentication, so now i&#39;m gonna read something about this.\nAnd another question then: is it a good idea to implement your own auth and use it instead of container managed auth?","body":"Thanks for an answer. Didn&#39;t know about container managed authentication, so now i&#39;m gonna read something about this. And another question then: is it a good idea to implement your own auth and use it instead of container managed auth?"},{"owner":{"account_id":699650,"reputation":16447,"user_id":1299005,"display_name":"Mark Thomas"},"score":1,"creation_date":1570459343,"post_id":58236041,"comment_id":102910621,"body_markdown":"Generally, rolling your own implementation of a security feature is a much high risk approach than using an existing implementation with a proven track record.","body":"Generally, rolling your own implementation of a security feature is a much high risk approach than using an existing implementation with a proven track record."}],"tags":[],"owner":{"account_id":699650,"reputation":16447,"user_id":1299005,"display_name":"Mark Thomas"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1570190569,"creation_date":1570190569,"answer_id":58236041,"question_id":58234923,"body_markdown":"`request.getUserPrincipal()` will be populated when you use container managed authentication. Since you have implemented your own authentication that method will return `null` and can be safely ignored.","title":"How does getUserPrincipal() work? When should i use it?","body":"<p><code>request.getUserPrincipal()</code> will be populated when you use container managed authentication. Since you have implemented your own authentication that method will return <code>null</code> and can be safely ignored.</p>\n"},{"tags":[],"owner":{"account_id":28662788,"reputation":11,"user_id":21947397,"display_name":"Frederic Godard"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1684848319,"creation_date":1684848319,"answer_id":76315310,"question_id":58234923,"body_markdown":"Perhaps a little late to answer, just in case :\r\n\r\nIn JEE servers, Principal and Subject objects are linked to your HttpRequest with JAAS login module. To implements your own authentication you have to implement your own JAAS login module. \r\n\r\nThen you will get naturally your own implementation of Principal.\r\nAnd then your authentication and authorisation to some pages or urls will be managed with configurations on your JEE Server. Example, you can add security contraints to your web.xml to allow or not somes urls like below :\r\n\r\n    &lt;security-constraint&gt;\r\n        &lt;web-resource-collection&gt;\r\n            &lt;web-resource-name&gt;admin&lt;/web-resource-name&gt;\r\n            &lt;url-pattern&gt;/admin/*&lt;/url-pattern&gt;\r\n        &lt;/web-resource-collection&gt;\r\n        &lt;auth-constraint&gt;\r\n            &lt;role-name&gt;admin&lt;/role-name&gt;\r\n        &lt;/auth-constraint&gt;\r\n    &lt;/security-constraint&gt;\r\n\r\nMore about JAAS : https://docs.oracle.com/en/java/javase/20/security/jaas-tutorials.html\r\n\r\nThis mecanism exists since the beggining of JEE, but few peoples knows how to use it.\r\n","title":"How does getUserPrincipal() work? When should i use it?","body":"<p>Perhaps a little late to answer, just in case :</p>\n<p>In JEE servers, Principal and Subject objects are linked to your HttpRequest with JAAS login module. To implements your own authentication you have to implement your own JAAS login module.</p>\n<p>Then you will get naturally your own implementation of Principal.\nAnd then your authentication and authorisation to some pages or urls will be managed with configurations on your JEE Server. Example, you can add security contraints to your web.xml to allow or not somes urls like below :</p>\n<pre><code>&lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;admin&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/admin/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt;\n    &lt;auth-constraint&gt;\n        &lt;role-name&gt;admin&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n&lt;/security-constraint&gt;\n</code></pre>\n<p>More about JAAS : <a href=\"https://docs.oracle.com/en/java/javase/20/security/jaas-tutorials.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/en/java/javase/20/security/jaas-tutorials.html</a></p>\n<p>This mecanism exists since the beggining of JEE, but few peoples knows how to use it.</p>\n"}],"owner":{"account_id":15557006,"reputation":1504,"user_id":11756421,"display_name":"DistantBlue"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2308,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":58236041,"answer_count":2,"score":1,"last_activity_date":1684848319,"creation_date":1570186136,"question_id":58234923,"body_markdown":"I&#39;m kinda new to Java EE and trying to learn it. So it&#39;s unclear to me how exactly `request.getUserPrincipal()` works. Where it gets Principal object? When and how this object is created? \r\n\r\nSo let&#39;s assume I have a login form that passes user name and password in HTTP POST request. In my servlet I have to take this data and compare it to records in my database. If find one, create user object with his name and some other data. In this case, when do I need to call `getUserPrincipal()`? And do i really need to call it, because there&#39;s already some logic which return a user object? And how this method will get `Principal` object for me?","title":"How does getUserPrincipal() work? When should i use it?","body":"<p>I'm kinda new to Java EE and trying to learn it. So it's unclear to me how exactly <code>request.getUserPrincipal()</code> works. Where it gets Principal object? When and how this object is created? </p>\n\n<p>So let's assume I have a login form that passes user name and password in HTTP POST request. In my servlet I have to take this data and compare it to records in my database. If find one, create user object with his name and some other data. In this case, when do I need to call <code>getUserPrincipal()</code>? And do i really need to call it, because there's already some logic which return a user object? And how this method will get <code>Principal</code> object for me?</p>\n"},{"tags":["java","spring","spring-boot","kotlin","spring-batch"],"comments":[{"owner":{"account_id":6482932,"reputation":29552,"user_id":5019386,"display_name":"Mahmoud Ben Hassine"},"score":0,"creation_date":1594025550,"post_id":62718203,"comment_id":110970953,"body_markdown":"Are you trying to run a new job instance or restart a failed one? Execution contexts that were serialized with 4.2.2 do not contain type informations (`@class`, `@property`, etc) that are required if deseriazlied with 4.2.4. If you run a new job with 4.2.4 and enable default typing, jackson will add type infos to the serialized execution context.","body":"Are you trying to run a new job instance or restart a failed one? Execution contexts that were serialized with 4.2.2 do not contain type informations (<code>@class</code>, <code>@property</code>, etc) that are required if deseriazlied with 4.2.4. If you run a new job with 4.2.4 and enable default typing, jackson will add type infos to the serialized execution context."},{"owner":{"account_id":915985,"reputation":3050,"user_id":948774,"accept_rate":82,"display_name":"kpentchev"},"score":0,"creation_date":1594025676,"post_id":62718203,"comment_id":110971015,"body_markdown":"@MahmoudBenHassine I am running a new one, but I want to read the last execution time of a previously successful instance. Do i understand correctly that this will not be possible having run the past jobs with 4.2.2?","body":"@MahmoudBenHassine I am running a new one, but I want to read the last execution time of a previously successful instance. Do i understand correctly that this will not be possible having run the past jobs with 4.2.2?"},{"owner":{"account_id":6482932,"reputation":29552,"user_id":5019386,"display_name":"Mahmoud Ben Hassine"},"score":1,"creation_date":1594026200,"post_id":62718203,"comment_id":110971251,"body_markdown":"You would need to add type infos (as you tried) to be able to deserialize the previous context (the one serialized with 4.2.2). I think your attempt to add `@class` in `&quot;{&quot;@class&quot;:&quot;java.util.HashMap&quot;}&quot;` is incorrect. Try to see how jackson serializes a new execution context and update your existing ones with a similar content.","body":"You would need to add type infos (as you tried) to be able to deserialize the previous context (the one serialized with 4.2.2). I think your attempt to add <code>@class</code> in <code>&quot;{&quot;@class&quot;:&quot;java.util.HashMap&quot;}&quot;</code> is incorrect. Try to see how jackson serializes a new execution context and update your existing ones with a similar content."},{"owner":{"account_id":915985,"reputation":3050,"user_id":948774,"accept_rate":82,"display_name":"kpentchev"},"score":0,"creation_date":1594029061,"post_id":62718203,"comment_id":110972569,"body_markdown":"@MahmoudBenHassine Actually, `{&quot;@class&quot;:&quot;java.util.HashMap&quot;}` was correct, I had to add it to `batch_step_execution_context` as well as to `batch_job_execution_context`.","body":"@MahmoudBenHassine Actually, <code>{&quot;@class&quot;:&quot;java.util.HashMap&quot;}</code> was correct, I had to add it to <code>batch_step_execution_context</code> as well as to <code>batch_job_execution_context</code>."},{"owner":{"account_id":6482932,"reputation":29552,"user_id":5019386,"display_name":"Mahmoud Ben Hassine"},"score":0,"creation_date":1594029333,"post_id":62718203,"comment_id":110972713,"body_markdown":"ok good to know. Indeed, you need to make sure to update both job and step execution contexts obviously. Is your issue resolved now?","body":"ok good to know. Indeed, you need to make sure to update both job and step execution contexts obviously. Is your issue resolved now?"},{"owner":{"account_id":915985,"reputation":3050,"user_id":948774,"accept_rate":82,"display_name":"kpentchev"},"score":0,"creation_date":1594029394,"post_id":62718203,"comment_id":110972746,"body_markdown":"@MahmoudBenHassine yes, I posted an answer with a sample fix","body":"@MahmoudBenHassine yes, I posted an answer with a sample fix"},{"owner":{"account_id":11005819,"reputation":151,"user_id":8084747,"display_name":"Hung Bang Quan"},"score":1,"creation_date":1612859902,"post_id":62718203,"comment_id":116891353,"body_markdown":"I&#39;ve got the same issue with Spring batch 4.3.1 (spring boot 2.4.2). I&#39;ve downgraded the version spring batch to 4.2.2 to solve it.","body":"I&#39;ve got the same issue with Spring batch 4.3.1 (spring boot 2.4.2). I&#39;ve downgraded the version spring batch to 4.2.2 to solve it."}],"answers":[{"comments":[{"owner":{"account_id":6482932,"reputation":29552,"user_id":5019386,"display_name":"Mahmoud Ben Hassine"},"score":0,"creation_date":1594029979,"post_id":62753551,"comment_id":110973041,"body_markdown":"`The configuration overriding was not needed.`: which Jackson version do you have in your classpath? I&#39;m not sure there is a migration service we (should) can provide as users execution contexts can contain any sort of data. Your use case is specific since you need some info from the previous execution to run a new one, the problem should not happen for new job instances.","body":"<code>The configuration overriding was not needed.</code>: which Jackson version do you have in your classpath? I&#39;m not sure there is a migration service we (should) can provide as users execution contexts can contain any sort of data. Your use case is specific since you need some info from the previous execution to run a new one, the problem should not happen for new job instances."},{"owner":{"account_id":915985,"reputation":3050,"user_id":948774,"accept_rate":82,"display_name":"kpentchev"},"score":0,"creation_date":1594030185,"post_id":62753551,"comment_id":110973139,"body_markdown":"@MahmoudBenHassine I have jackson version `2.11.0` after the upgrade to spring-boot `2.3.1.RELEASE` and had `2.10.2` before.","body":"@MahmoudBenHassine I have jackson version <code>2.11.0</code> after the upgrade to spring-boot <code>2.3.1.RELEASE</code> and had <code>2.10.2</code> before."},{"owner":{"account_id":6482932,"reputation":29552,"user_id":5019386,"display_name":"Mahmoud Ben Hassine"},"score":0,"creation_date":1594030599,"post_id":62753551,"comment_id":110973314,"body_markdown":"That explains it. Spring Batch 4.2.x uses Jackson 2.10.x with which you would need the config override (The upcoming v4.3 will use Jackson 2.11), but it&#39;s ok and better that you have Jackson 2.11 (brought by Spring Boot 2.3). Glad you fixed you issue!","body":"That explains it. Spring Batch 4.2.x uses Jackson 2.10.x with which you would need the config override (The upcoming v4.3 will use Jackson 2.11), but it&#39;s ok and better that you have Jackson 2.11 (brought by Spring Boot 2.3). Glad you fixed you issue!"},{"owner":{"account_id":204423,"reputation":173,"user_id":452632,"accept_rate":50,"display_name":"Neikius"},"score":0,"creation_date":1598956053,"post_id":62753551,"comment_id":112617648,"body_markdown":"@MahmoudBenHassine Wouldn&#39;t hurt to put this somewhere in release notes? I checked and couldn&#39;t find anything, but that could just be me looking up wrong stuff.","body":"@MahmoudBenHassine Wouldn&#39;t hurt to put this somewhere in release notes? I checked and couldn&#39;t find anything, but that could just be me looking up wrong stuff."},{"owner":{"account_id":6482932,"reputation":29552,"user_id":5019386,"display_name":"Mahmoud Ben Hassine"},"score":0,"creation_date":1598957544,"post_id":62753551,"comment_id":112618351,"body_markdown":"@Neikius It&#39;s in the release notes: https://github.com/spring-projects/spring-batch/releases/tag/4.2.4.RELEASE , issue 3729.","body":"@Neikius It&#39;s in the release notes: <a href=\"https://github.com/spring-projects/spring-batch/releases/tag/4.2.4.RELEASE\" rel=\"nofollow noreferrer\">github.com/spring-projects/spring-batch/releases/tag/&hellip;</a> , issue 3729."},{"owner":{"account_id":5147284,"reputation":2911,"user_id":4122894,"display_name":"sixrandanes"},"score":1,"creation_date":1647836697,"post_id":62753551,"comment_id":126462862,"body_markdown":"There is a typo in the sql scripts. I suppose the first  tableName should be batch_job_execution_context instead of batch_step_execution_context","body":"There is a typo in the sql scripts. I suppose the first  tableName should be batch_job_execution_context instead of batch_step_execution_context"}],"tags":[],"owner":{"account_id":915985,"reputation":3050,"user_id":948774,"accept_rate":82,"display_name":"kpentchev"},"comment_count":6,"down_vote_count":0,"up_vote_count":12,"is_accepted":true,"score":12,"last_activity_date":1594029352,"creation_date":1594029352,"answer_id":62753551,"question_id":62718203,"body_markdown":"Thanks to @MahmoudBenHassine for pointing me in the direction of the fix:\r\n\r\n\r\nMy attempt to manually add the type information to the database values was correct, but I didn&#39;t take it far enough.\r\n\r\nThere are 2 tables, whose values that needed updating:\r\n* table `batch_job_execution_context`, column `short_context`\r\n* table `batch_step_execution_context`, column `short_context`\r\n\r\nI did this with a liquibase script:\r\n```\r\n    &lt;changeSet id=&quot;update-job_execution_context-for-spring-batch-4.2.4&quot; author=&quot;kpentchev&quot;&gt;\r\n        &lt;update tableName=&quot;batch_step_execution_context&quot;&gt;\r\n            &lt;column name=&quot;short_context&quot; valueComputed=&quot;REPLACE(short_context, &#39;{&#39;, &#39;{&amp;quot;@class&amp;quot;:&amp;quot;java.util.HashMap&amp;quot;,&#39;)&quot; /&gt;\r\n        &lt;/update&gt;\r\n    &lt;/changeSet&gt;\r\n\r\n    &lt;changeSet id=&quot;update-step_execution_context-for-spring-batch-4.2.4&quot; author=&quot;kpentchev&quot;&gt;\r\n        &lt;update tableName=&quot;batch_step_execution_context&quot;&gt;\r\n            &lt;column name=&quot;short_context&quot; valueComputed=&quot;REPLACE(short_context, &#39;{&#39;, &#39;{&amp;quot;@class&amp;quot;:&amp;quot;java.util.HashMap&amp;quot;,&#39;)&quot; /&gt;\r\n        &lt;/update&gt;\r\n    &lt;/changeSet&gt;\r\n```\r\n\r\nThe configuration overriding was not needed.\r\n\r\nIt would have been nice to have a migration service as part of the `spring-batch` release, but here is a work-around.","title":"Spring Batch 4.2.4: Unable to deserialize the execution context","body":"<p>Thanks to @MahmoudBenHassine for pointing me in the direction of the fix:</p>\n<p>My attempt to manually add the type information to the database values was correct, but I didn't take it far enough.</p>\n<p>There are 2 tables, whose values that needed updating:</p>\n<ul>\n<li>table <code>batch_job_execution_context</code>, column <code>short_context</code></li>\n<li>table <code>batch_step_execution_context</code>, column <code>short_context</code></li>\n</ul>\n<p>I did this with a liquibase script:</p>\n<pre><code>    &lt;changeSet id=&quot;update-job_execution_context-for-spring-batch-4.2.4&quot; author=&quot;kpentchev&quot;&gt;\n        &lt;update tableName=&quot;batch_step_execution_context&quot;&gt;\n            &lt;column name=&quot;short_context&quot; valueComputed=&quot;REPLACE(short_context, '{', '{&amp;quot;@class&amp;quot;:&amp;quot;java.util.HashMap&amp;quot;,')&quot; /&gt;\n        &lt;/update&gt;\n    &lt;/changeSet&gt;\n\n    &lt;changeSet id=&quot;update-step_execution_context-for-spring-batch-4.2.4&quot; author=&quot;kpentchev&quot;&gt;\n        &lt;update tableName=&quot;batch_step_execution_context&quot;&gt;\n            &lt;column name=&quot;short_context&quot; valueComputed=&quot;REPLACE(short_context, '{', '{&amp;quot;@class&amp;quot;:&amp;quot;java.util.HashMap&amp;quot;,')&quot; /&gt;\n        &lt;/update&gt;\n    &lt;/changeSet&gt;\n</code></pre>\n<p>The configuration overriding was not needed.</p>\n<p>It would have been nice to have a migration service as part of the <code>spring-batch</code> release, but here is a work-around.</p>\n"},{"tags":[],"owner":{"account_id":8306034,"reputation":5283,"user_id":6243024,"display_name":"ck1"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1597259622,"creation_date":1597259622,"answer_id":63383336,"question_id":62718203,"body_markdown":"I recently ran into a similar problem while upgrading from Spring Batch `4.2.1.RELEASE` to `4.2.4.RELEASE`.\r\n\r\n@kpentchev provides a good solution for this by directly modifying serialized execution context JSON in the database.\r\n\r\nAnother solution is to extend `Jackson2ExecutionContextStringSerializer#deserialize(InputStream)`, catch the potential exception that&#39;s thrown deserializing the old JSON format, and use a second legacy `ObjectMapper`.\r\n\r\nI&#39;ve provided one such implementation below.\r\n\r\n----------\r\n\r\n```java\r\nimport com.fasterxml.jackson.annotation.JsonIgnore;\r\nimport com.fasterxml.jackson.core.JsonParser;\r\nimport com.fasterxml.jackson.core.type.TypeReference;\r\nimport com.fasterxml.jackson.databind.DeserializationContext;\r\nimport com.fasterxml.jackson.databind.DeserializationFeature;\r\nimport com.fasterxml.jackson.databind.JsonNode;\r\nimport com.fasterxml.jackson.databind.MapperFeature;\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\nimport com.fasterxml.jackson.databind.deser.std.StdDeserializer;\r\nimport com.fasterxml.jackson.databind.exc.InvalidTypeIdException;\r\nimport com.fasterxml.jackson.databind.module.SimpleModule;\r\nimport java.io.ByteArrayOutputStream;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.lang.reflect.Field;\r\nimport java.nio.charset.StandardCharsets;\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\nimport java.util.Objects;\r\nimport javax.validation.constraints.NotNull;\r\nimport lombok.NonNull;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.batch.core.JobParameter;\r\nimport org.springframework.batch.core.JobParameters;\r\nimport org.springframework.batch.core.repository.dao.Jackson2ExecutionContextStringSerializer;\r\nimport org.springframework.util.ReflectionUtils;\r\n\r\n/**\r\n * Extends {@link Jackson2ExecutionContextStringSerializer} in order to support deserializing JSON\r\n * that was serialized using Spring Batch 4.2.1.RELEASE, and persisted in the database.\r\n *\r\n * &lt;p&gt;This class has been tested upgrading from Spring Batch 4.2.1.RELEASE to 4.2.4.RELEASE.\r\n */\r\n@Slf4j\r\npublic class BackwardsCompatibleSerializer extends Jackson2ExecutionContextStringSerializer {\r\n\r\n  private final ObjectMapper newObjectMapper;\r\n\r\n  private final ObjectMapper legacyObjectMapper;\r\n\r\n  public BackwardsCompatibleSerializer() {\r\n    newObjectMapper = getNewObjectMapper();\r\n    legacyObjectMapper = createLegacyObjectMapper();\r\n  }\r\n\r\n  /**\r\n   * Overrides the default deserialization method.  If an {@link InvalidTypeIdException} is thrown\r\n   * during deserialization, the exception is caught, and an attempt is made to deserialize the JSON\r\n   * using the legacy {@link ObjectMapper} instance.\r\n   */\r\n  @Override\r\n  public @NotNull Map&lt;String, Object&gt; deserialize(@NotNull InputStream in) throws IOException {\r\n    String json = inputStreamToString(in);\r\n    TypeReference&lt;HashMap&lt;String, Object&gt;&gt; typeRef = new TypeReference&lt;&gt;() {};\r\n    try {\r\n      return newObjectMapper.readValue(json, typeRef);\r\n    } catch (InvalidTypeIdException e) {\r\n      log.info(&quot;Couldn&#39;t deserialize JSON: will attempt to use legacy ObjectMapper&quot;);\r\n      log.debug(&quot;Stacktrace&quot;, e);\r\n      return legacyObjectMapper.readValue(json, typeRef);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Uses Java reflection to access the new {@link ObjectMapper} instance from the private\r\n   * superclass field.  This will be used to serialize and deserialize JSON created using Spring\r\n   * Batch 4.2.4.RELEASE.\r\n   *\r\n   * @return the new {@link ObjectMapper} instance\r\n   */\r\n  private ObjectMapper getNewObjectMapper() {\r\n    ObjectMapper newObjectMapper;\r\n    Field field = ReflectionUtils.findField(Jackson2ExecutionContextStringSerializer.class,\r\n        &quot;objectMapper&quot;, ObjectMapper.class);\r\n    Objects.requireNonNull(field, &quot;objectMapper field is null&quot;);\r\n    ReflectionUtils.makeAccessible(field);\r\n    newObjectMapper = (ObjectMapper) ReflectionUtils.getField(field, this);\r\n    return newObjectMapper;\r\n  }\r\n\r\n  /**\r\n   * Creates the {@link ObjectMapper} instance that can be used for deserializing JSON that was\r\n   * previously serialized using Spring Batch 4.2.1.RELEASE.  This instance is only used if an\r\n   * exception is thrown in {@link #deserialize(InputStream)} when using the new {@link\r\n   * ObjectMapper} instance.\r\n   *\r\n   * @return the {@link ObjectMapper} instance that can be used for deserializing legacy JSON\r\n   */\r\n  @SuppressWarnings(&quot;deprecation&quot;)\r\n  private ObjectMapper createLegacyObjectMapper() {\r\n    ObjectMapper legacyObjectMapper = new ObjectMapper();\r\n    legacyObjectMapper.configure(MapperFeature.DEFAULT_VIEW_INCLUSION, false);\r\n    legacyObjectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, true);\r\n    legacyObjectMapper.enableDefaultTyping();\r\n    legacyObjectMapper.registerModule(new JobParametersModule());\r\n    return legacyObjectMapper;\r\n  }\r\n\r\n  private static String inputStreamToString(@NonNull InputStream inputStream) throws IOException {\r\n    ByteArrayOutputStream result = new ByteArrayOutputStream();\r\n    byte[] buffer = new byte[1024];\r\n    int length;\r\n    while ((length = inputStream.read(buffer)) != -1) {\r\n      result.write(buffer, 0, length);\r\n    }\r\n    return result.toString(StandardCharsets.UTF_8);\r\n  }\r\n\r\n  /*\r\n   * The remainder of this file was copied from here:\r\n   *\r\n   * https://github.com/spring-projects/spring-batch/blob/4.2.1.RELEASE/spring-batch-core/src/main/java/org/springframework/batch/core/repository/dao/Jackson2ExecutionContextStringSerializer.java\r\n   */\r\n\r\n  // BATCH-2680\r\n\r\n  /**\r\n   * Custom Jackson module to support {@link JobParameter} and {@link JobParameters}\r\n   * deserialization.\r\n   */\r\n  private static class JobParametersModule extends SimpleModule {\r\n\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    private JobParametersModule() {\r\n      super(&quot;Job parameters module&quot;);\r\n      setMixInAnnotation(JobParameters.class, JobParametersMixIn.class);\r\n      addDeserializer(JobParameter.class, new JobParameterDeserializer());\r\n    }\r\n\r\n    private abstract static class JobParametersMixIn {\r\n\r\n      @JsonIgnore\r\n      abstract boolean isEmpty();\r\n    }\r\n\r\n    private static class JobParameterDeserializer extends StdDeserializer&lt;JobParameter&gt; {\r\n\r\n      private static final long serialVersionUID = 1L;\r\n      private static final String IDENTIFYING_KEY_NAME = &quot;identifying&quot;;\r\n      private static final String TYPE_KEY_NAME = &quot;type&quot;;\r\n      private static final String VALUE_KEY_NAME = &quot;value&quot;;\r\n\r\n      JobParameterDeserializer() {\r\n        super(JobParameter.class);\r\n      }\r\n\r\n      @SuppressWarnings(&quot;checkstyle:all&quot;)\r\n      @Override\r\n      public JobParameter deserialize(JsonParser parser, DeserializationContext context)\r\n          throws IOException {\r\n        JsonNode node = parser.readValueAsTree();\r\n        boolean identifying = node.get(IDENTIFYING_KEY_NAME).asBoolean();\r\n        String type = node.get(TYPE_KEY_NAME).asText();\r\n        JsonNode value = node.get(VALUE_KEY_NAME);\r\n        Object parameterValue;\r\n        switch (JobParameter.ParameterType.valueOf(type)) {\r\n          case STRING: {\r\n            parameterValue = value.asText();\r\n            return new JobParameter((String) parameterValue, identifying);\r\n          }\r\n          case DATE: {\r\n            parameterValue = new Date(value.get(1).asLong());\r\n            return new JobParameter((Date) parameterValue, identifying);\r\n          }\r\n          case LONG: {\r\n            parameterValue = value.get(1).asLong();\r\n            return new JobParameter((Long) parameterValue, identifying);\r\n          }\r\n          case DOUBLE: {\r\n            parameterValue = value.asDouble();\r\n            return new JobParameter((Double) parameterValue, identifying);\r\n          }\r\n        }\r\n        return null;\r\n      }\r\n    }\r\n  }\r\n}\r\n```","title":"Spring Batch 4.2.4: Unable to deserialize the execution context","body":"<p>I recently ran into a similar problem while upgrading from Spring Batch <code>4.2.1.RELEASE</code> to <code>4.2.4.RELEASE</code>.</p>\n<p>@kpentchev provides a good solution for this by directly modifying serialized execution context JSON in the database.</p>\n<p>Another solution is to extend <code>Jackson2ExecutionContextStringSerializer#deserialize(InputStream)</code>, catch the potential exception that's thrown deserializing the old JSON format, and use a second legacy <code>ObjectMapper</code>.</p>\n<p>I've provided one such implementation below.</p>\n<hr />\n<pre class=\"lang-java prettyprint-override\"><code>import com.fasterxml.jackson.annotation.JsonIgnore;\nimport com.fasterxml.jackson.core.JsonParser;\nimport com.fasterxml.jackson.core.type.TypeReference;\nimport com.fasterxml.jackson.databind.DeserializationContext;\nimport com.fasterxml.jackson.databind.DeserializationFeature;\nimport com.fasterxml.jackson.databind.JsonNode;\nimport com.fasterxml.jackson.databind.MapperFeature;\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.fasterxml.jackson.databind.deser.std.StdDeserializer;\nimport com.fasterxml.jackson.databind.exc.InvalidTypeIdException;\nimport com.fasterxml.jackson.databind.module.SimpleModule;\nimport java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.lang.reflect.Field;\nimport java.nio.charset.StandardCharsets;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.Objects;\nimport javax.validation.constraints.NotNull;\nimport lombok.NonNull;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.batch.core.JobParameter;\nimport org.springframework.batch.core.JobParameters;\nimport org.springframework.batch.core.repository.dao.Jackson2ExecutionContextStringSerializer;\nimport org.springframework.util.ReflectionUtils;\n\n/**\n * Extends {@link Jackson2ExecutionContextStringSerializer} in order to support deserializing JSON\n * that was serialized using Spring Batch 4.2.1.RELEASE, and persisted in the database.\n *\n * &lt;p&gt;This class has been tested upgrading from Spring Batch 4.2.1.RELEASE to 4.2.4.RELEASE.\n */\n@Slf4j\npublic class BackwardsCompatibleSerializer extends Jackson2ExecutionContextStringSerializer {\n\n  private final ObjectMapper newObjectMapper;\n\n  private final ObjectMapper legacyObjectMapper;\n\n  public BackwardsCompatibleSerializer() {\n    newObjectMapper = getNewObjectMapper();\n    legacyObjectMapper = createLegacyObjectMapper();\n  }\n\n  /**\n   * Overrides the default deserialization method.  If an {@link InvalidTypeIdException} is thrown\n   * during deserialization, the exception is caught, and an attempt is made to deserialize the JSON\n   * using the legacy {@link ObjectMapper} instance.\n   */\n  @Override\n  public @NotNull Map&lt;String, Object&gt; deserialize(@NotNull InputStream in) throws IOException {\n    String json = inputStreamToString(in);\n    TypeReference&lt;HashMap&lt;String, Object&gt;&gt; typeRef = new TypeReference&lt;&gt;() {};\n    try {\n      return newObjectMapper.readValue(json, typeRef);\n    } catch (InvalidTypeIdException e) {\n      log.info(&quot;Couldn't deserialize JSON: will attempt to use legacy ObjectMapper&quot;);\n      log.debug(&quot;Stacktrace&quot;, e);\n      return legacyObjectMapper.readValue(json, typeRef);\n    }\n  }\n\n  /**\n   * Uses Java reflection to access the new {@link ObjectMapper} instance from the private\n   * superclass field.  This will be used to serialize and deserialize JSON created using Spring\n   * Batch 4.2.4.RELEASE.\n   *\n   * @return the new {@link ObjectMapper} instance\n   */\n  private ObjectMapper getNewObjectMapper() {\n    ObjectMapper newObjectMapper;\n    Field field = ReflectionUtils.findField(Jackson2ExecutionContextStringSerializer.class,\n        &quot;objectMapper&quot;, ObjectMapper.class);\n    Objects.requireNonNull(field, &quot;objectMapper field is null&quot;);\n    ReflectionUtils.makeAccessible(field);\n    newObjectMapper = (ObjectMapper) ReflectionUtils.getField(field, this);\n    return newObjectMapper;\n  }\n\n  /**\n   * Creates the {@link ObjectMapper} instance that can be used for deserializing JSON that was\n   * previously serialized using Spring Batch 4.2.1.RELEASE.  This instance is only used if an\n   * exception is thrown in {@link #deserialize(InputStream)} when using the new {@link\n   * ObjectMapper} instance.\n   *\n   * @return the {@link ObjectMapper} instance that can be used for deserializing legacy JSON\n   */\n  @SuppressWarnings(&quot;deprecation&quot;)\n  private ObjectMapper createLegacyObjectMapper() {\n    ObjectMapper legacyObjectMapper = new ObjectMapper();\n    legacyObjectMapper.configure(MapperFeature.DEFAULT_VIEW_INCLUSION, false);\n    legacyObjectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, true);\n    legacyObjectMapper.enableDefaultTyping();\n    legacyObjectMapper.registerModule(new JobParametersModule());\n    return legacyObjectMapper;\n  }\n\n  private static String inputStreamToString(@NonNull InputStream inputStream) throws IOException {\n    ByteArrayOutputStream result = new ByteArrayOutputStream();\n    byte[] buffer = new byte[1024];\n    int length;\n    while ((length = inputStream.read(buffer)) != -1) {\n      result.write(buffer, 0, length);\n    }\n    return result.toString(StandardCharsets.UTF_8);\n  }\n\n  /*\n   * The remainder of this file was copied from here:\n   *\n   * https://github.com/spring-projects/spring-batch/blob/4.2.1.RELEASE/spring-batch-core/src/main/java/org/springframework/batch/core/repository/dao/Jackson2ExecutionContextStringSerializer.java\n   */\n\n  // BATCH-2680\n\n  /**\n   * Custom Jackson module to support {@link JobParameter} and {@link JobParameters}\n   * deserialization.\n   */\n  private static class JobParametersModule extends SimpleModule {\n\n    private static final long serialVersionUID = 1L;\n\n    private JobParametersModule() {\n      super(&quot;Job parameters module&quot;);\n      setMixInAnnotation(JobParameters.class, JobParametersMixIn.class);\n      addDeserializer(JobParameter.class, new JobParameterDeserializer());\n    }\n\n    private abstract static class JobParametersMixIn {\n\n      @JsonIgnore\n      abstract boolean isEmpty();\n    }\n\n    private static class JobParameterDeserializer extends StdDeserializer&lt;JobParameter&gt; {\n\n      private static final long serialVersionUID = 1L;\n      private static final String IDENTIFYING_KEY_NAME = &quot;identifying&quot;;\n      private static final String TYPE_KEY_NAME = &quot;type&quot;;\n      private static final String VALUE_KEY_NAME = &quot;value&quot;;\n\n      JobParameterDeserializer() {\n        super(JobParameter.class);\n      }\n\n      @SuppressWarnings(&quot;checkstyle:all&quot;)\n      @Override\n      public JobParameter deserialize(JsonParser parser, DeserializationContext context)\n          throws IOException {\n        JsonNode node = parser.readValueAsTree();\n        boolean identifying = node.get(IDENTIFYING_KEY_NAME).asBoolean();\n        String type = node.get(TYPE_KEY_NAME).asText();\n        JsonNode value = node.get(VALUE_KEY_NAME);\n        Object parameterValue;\n        switch (JobParameter.ParameterType.valueOf(type)) {\n          case STRING: {\n            parameterValue = value.asText();\n            return new JobParameter((String) parameterValue, identifying);\n          }\n          case DATE: {\n            parameterValue = new Date(value.get(1).asLong());\n            return new JobParameter((Date) parameterValue, identifying);\n          }\n          case LONG: {\n            parameterValue = value.get(1).asLong();\n            return new JobParameter((Long) parameterValue, identifying);\n          }\n          case DOUBLE: {\n            parameterValue = value.asDouble();\n            return new JobParameter((Double) parameterValue, identifying);\n          }\n        }\n        return null;\n      }\n    }\n  }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":437395,"reputation":1937,"user_id":825061,"display_name":"Sergio Marcelo C Figueiredo"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1619790441,"creation_date":1619790441,"answer_id":67335069,"question_id":62718203,"body_markdown":"I relied on @kpentchev&#39;s solution and used the following SQL commands:\r\n\r\n    update BATCH_JOB_EXECUTION_CONTEXT\r\n    set SHORT_CONTEXT = replace(SHORT_CONTEXT, &#39;{&quot;map&quot;&#39;, &#39;{&quot;@class&quot;:&quot;java.util.HashMap&quot;,&quot;map&quot;&#39;)\r\n    WHERE SHORT_CONTEXT LIKE &#39;{&quot;map&quot;:%&#39;;\r\n\r\n    update BATCH_STEP_EXECUTION_CONTEXT\r\n    set SHORT_CONTEXT = replace(SHORT_CONTEXT, &#39;{&quot;map&quot;&#39;,&#39;{&quot;@class&quot;:&quot;java.util.HashMap&quot;,&quot;map&quot;&#39;)\r\n    WHERE SHORT_CONTEXT LIKE &#39;{&quot;map&quot;:%&#39;;\r\n\r\n    commit;","title":"Spring Batch 4.2.4: Unable to deserialize the execution context","body":"<p>I relied on @kpentchev's solution and used the following SQL commands:</p>\n<pre><code>update BATCH_JOB_EXECUTION_CONTEXT\nset SHORT_CONTEXT = replace(SHORT_CONTEXT, '{&quot;map&quot;', '{&quot;@class&quot;:&quot;java.util.HashMap&quot;,&quot;map&quot;')\nWHERE SHORT_CONTEXT LIKE '{&quot;map&quot;:%';\n\nupdate BATCH_STEP_EXECUTION_CONTEXT\nset SHORT_CONTEXT = replace(SHORT_CONTEXT, '{&quot;map&quot;','{&quot;@class&quot;:&quot;java.util.HashMap&quot;,&quot;map&quot;')\nWHERE SHORT_CONTEXT LIKE '{&quot;map&quot;:%';\n\ncommit;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2149542,"reputation":767,"user_id":1906350,"display_name":"Amitabha Roy"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684848020,"creation_date":1684848020,"answer_id":76315268,"question_id":62718203,"body_markdown":"An alternate solution can be to cleanup the database.\r\n\r\n`DELETE FROM BATCH_JOB_EXECUTION_CONTEXT WHERE JOB_EXECUTION_ID IN\r\n(SELECT JOB_EXECUTION_ID FROM BATCH_JOB_EXECUTION WHERE JOB_EXECUTION_ID IN\r\n(SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = &#39;myJob&#39;))`\r\n\r\n`DELETE FROM BATCH_STEP_EXECUTION_CONTEXT WHERE STEP_EXECUTION_ID IN \r\n(SELECT STEP_EXECUTION_ID FROM BATCH_STEP_EXECUTION WHERE JOB_EXECUTION_ID IN\r\n(SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = &#39;myJob&#39;))`\r\n\r\n`DELETE FROM BATCH_STEP_EXECUTION WHERE JOB_EXECUTION_ID IN\r\n(SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = &#39;myJob&#39;)`\r\n\r\n`DELETE FROM BATCH_JOB_EXECUTION_PARAMS WHERE JOB_EXECUTION_ID IN\r\n(SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = &#39;myJob&#39;)`\r\n\r\n`DELETE FROM BATCH_JOB_EXECUTION WHERE JOB_EXECUTION_ID IN\r\n(SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = &#39;myJob&#39;)`\r\n\r\n`DELETE FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = &#39;myJob&#39;`","title":"Spring Batch 4.2.4: Unable to deserialize the execution context","body":"<p>An alternate solution can be to cleanup the database.</p>\n<p><code>DELETE FROM BATCH_JOB_EXECUTION_CONTEXT WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_EXECUTION WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob'))</code></p>\n<p><code>DELETE FROM BATCH_STEP_EXECUTION_CONTEXT WHERE STEP_EXECUTION_ID IN  (SELECT STEP_EXECUTION_ID FROM BATCH_STEP_EXECUTION WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob'))</code></p>\n<p><code>DELETE FROM BATCH_STEP_EXECUTION WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob')</code></p>\n<p><code>DELETE FROM BATCH_JOB_EXECUTION_PARAMS WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob')</code></p>\n<p><code>DELETE FROM BATCH_JOB_EXECUTION WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob')</code></p>\n<p><code>DELETE FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob'</code></p>\n"}],"owner":{"account_id":915985,"reputation":3050,"user_id":948774,"accept_rate":82,"display_name":"kpentchev"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":13664,"favorite_count":0,"down_vote_count":0,"up_vote_count":9,"accepted_answer_id":62753551,"answer_count":4,"score":9,"last_activity_date":1684848020,"creation_date":1593788920,"question_id":62718203,"body_markdown":"I was using `spring-batch:4.2.2.RELEASE` as part of `spring-boot-starter-batch:2.2.4.RELEASE`.\r\nAfter upgrading the latter to version `2.3.1.RELEASE`, I get the following exception when starting a job:\r\n```\r\njava.lang.IllegalArgumentException: Unable to deserialize the execution context\r\n\tat org.springframework.batch.core.repository.dao.JdbcExecutionContextDao$ExecutionContextRowMapper.mapRow(JdbcExecutionContextDao.java:328)\r\n\tat org.springframework.batch.core.repository.dao.JdbcExecutionContextDao$ExecutionContextRowMapper.mapRow(JdbcExecutionContextDao.java:312)\r\n\tat org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:94)\r\n\tat org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:61)\r\n\tat org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:679)\r\n\tat org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:617)\r\n\tat org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:669)\r\n\tat org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:700)\r\n\tat org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:712)\r\n\tat org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:768)\r\n\tat org.springframework.batch.core.repository.dao.JdbcExecutionContextDao.getExecutionContext(JdbcExecutionContextDao.java:129)\r\n\tat org.springframework.batch.core.explore.support.SimpleJobExplorer.getStepExecutionDependencies(SimpleJobExplorer.java:238)\r\n\tat org.springframework.batch.core.explore.support.SimpleJobExplorer.getJobExecutions(SimpleJobExplorer.java:87)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)\r\n\tat org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)\r\n\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)\r\n\tat org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:127)\r\n\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\r\n\tat org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212)\r\n\tat com.sun.proxy.$Proxy145.getJobExecutions(Unknown Source)\r\n...\r\nCaused by: com.fasterxml.jackson.databind.exc.InvalidTypeIdException: Missing type id when trying to resolve subtype of [map type; class java.util.HashMap, [simple type, class java.lang.String] -&gt; [simple type, class java.lang.Object]]: missing type id property &#39;@class&#39;\r\n at [Source: (ByteArrayInputStream); line: 1, column: 192]\r\n\tat com.fasterxml.jackson.databind.exc.InvalidTypeIdException.from(InvalidTypeIdException.java:43)\r\n\tat com.fasterxml.jackson.databind.DeserializationContext.missingTypeIdException(DeserializationContext.java:1790)\r\n\tat com.fasterxml.jackson.databind.DeserializationContext.handleMissingTypeId(DeserializationContext.java:1319)\r\n\tat com.fasterxml.jackson.databind.jsontype.impl.TypeDeserializerBase._handleMissingTypeId(TypeDeserializerBase.java:303)\r\n\tat com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer._deserializeTypedUsingDefaultImpl(AsPropertyTypeDeserializer.java:166)\r\n\tat com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer.deserializeTypedFromObject(AsPropertyTypeDeserializer.java:107)\r\n\tat com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserializeWithType(MapDeserializer.java:400)\r\n\tat com.fasterxml.jackson.databind.deser.impl.TypeWrappedDeserializer.deserialize(TypeWrappedDeserializer.java:68)\r\n\tat com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4482)\r\n\tat com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3479)\r\n\tat org.springframework.batch.core.repository.dao.Jackson2ExecutionContextStringSerializer.deserialize(Jackson2ExecutionContextStringSerializer.java:123)\r\n\tat org.springframework.batch.core.repository.dao.Jackson2ExecutionContextStringSerializer.deserialize(Jackson2ExecutionContextStringSerializer.java:102)\r\n\tat org.springframework.batch.core.repository.dao.JdbcExecutionContextDao$ExecutionContextRowMapper.mapRow(JdbcExecutionContextDao.java:325)\r\n\t... 45 common frames omitted\r\n\r\n\r\n```\r\n\r\nI understand that the new version has a restricted handling of JSON deserialization and attempted to implement the suggested fix from the `Jackson2ExecutionContextStringSerializer` javadoc, however the problem persists:\r\n\r\n```\r\n@EnableBatchProcessing\r\n@Configuration\r\nclass BatchConfig(\r\n\r\n    val properties: BatchProperties,\r\n    val dataSource: DataSource,\r\n    val transactionManagerCustomizers: TransactionManagerCustomizers,\r\n    val entityManagerFactory: EntityManagerFactory\r\n) : JpaBatchConfigurer(properties, dataSource, transactionManagerCustomizers, entityManagerFactory) {\r\n\r\n    override fun createJobRepository(): JobRepository {\r\n        val factory = JobRepositoryFactoryBean()\r\n        val map = PropertyMapper.get()\r\n        map.from(dataSource).to { dataSource: DataSource? -&gt; factory.setDataSource(dataSource!!) }\r\n        map.from { determineIsolationLevel() }.whenNonNull().to { isolationLevelForCreate: String? -&gt; factory.setIsolationLevelForCreate(isolationLevelForCreate!!) }\r\n        map.from { properties.tablePrefix }.whenHasText().to { tablePrefix: String? -&gt; factory.setTablePrefix(tablePrefix!!) }\r\n        map.from { transactionManager }.to { transactionManager: PlatformTransactionManager? -&gt; factory.transactionManager = transactionManager!! }\r\n        factory.afterPropertiesSet()\r\n\r\n        val serializer = configureContextSerializer()\r\n        factory.setSerializer(serializer)\r\n\r\n        return factory.getObject()\r\n    }\r\n\r\n    private fun configureContextSerializer(): Jackson2ExecutionContextStringSerializer {\r\n        val polymorphicTypeValidator = LaissezFaireSubTypeValidator()\r\n        objectMapper.activateDefaultTyping(polymorphicTypeValidator)\r\n        val serializer = Jackson2ExecutionContextStringSerializer()\r\n        serializer.setObjectMapper(objectMapper)\r\n        return serializer\r\n    }\r\n```\r\nThe craziest part is that the execution context is actually empty, the database value is always `&quot;{}&quot;`. I even tried changing all values in the DB to `&quot;{&quot;@class&quot;:&quot;java.util.HashMap&quot;}&quot;`, but I still get the same exception.\r\n\r\nDoes anyone have an idea how to fix this? Is the configuration from my fix attempt wrong?","title":"Spring Batch 4.2.4: Unable to deserialize the execution context","body":"<p>I was using <code>spring-batch:4.2.2.RELEASE</code> as part of <code>spring-boot-starter-batch:2.2.4.RELEASE</code>.\nAfter upgrading the latter to version <code>2.3.1.RELEASE</code>, I get the following exception when starting a job:</p>\n<pre><code>java.lang.IllegalArgumentException: Unable to deserialize the execution context\n    at org.springframework.batch.core.repository.dao.JdbcExecutionContextDao$ExecutionContextRowMapper.mapRow(JdbcExecutionContextDao.java:328)\n    at org.springframework.batch.core.repository.dao.JdbcExecutionContextDao$ExecutionContextRowMapper.mapRow(JdbcExecutionContextDao.java:312)\n    at org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:94)\n    at org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:61)\n    at org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:679)\n    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:617)\n    at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:669)\n    at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:700)\n    at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:712)\n    at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:768)\n    at org.springframework.batch.core.repository.dao.JdbcExecutionContextDao.getExecutionContext(JdbcExecutionContextDao.java:129)\n    at org.springframework.batch.core.explore.support.SimpleJobExplorer.getStepExecutionDependencies(SimpleJobExplorer.java:238)\n    at org.springframework.batch.core.explore.support.SimpleJobExplorer.getJobExecutions(SimpleJobExplorer.java:87)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:566)\n    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)\n    at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:127)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212)\n    at com.sun.proxy.$Proxy145.getJobExecutions(Unknown Source)\n...\nCaused by: com.fasterxml.jackson.databind.exc.InvalidTypeIdException: Missing type id when trying to resolve subtype of [map type; class java.util.HashMap, [simple type, class java.lang.String] -&gt; [simple type, class java.lang.Object]]: missing type id property '@class'\n at [Source: (ByteArrayInputStream); line: 1, column: 192]\n    at com.fasterxml.jackson.databind.exc.InvalidTypeIdException.from(InvalidTypeIdException.java:43)\n    at com.fasterxml.jackson.databind.DeserializationContext.missingTypeIdException(DeserializationContext.java:1790)\n    at com.fasterxml.jackson.databind.DeserializationContext.handleMissingTypeId(DeserializationContext.java:1319)\n    at com.fasterxml.jackson.databind.jsontype.impl.TypeDeserializerBase._handleMissingTypeId(TypeDeserializerBase.java:303)\n    at com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer._deserializeTypedUsingDefaultImpl(AsPropertyTypeDeserializer.java:166)\n    at com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer.deserializeTypedFromObject(AsPropertyTypeDeserializer.java:107)\n    at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserializeWithType(MapDeserializer.java:400)\n    at com.fasterxml.jackson.databind.deser.impl.TypeWrappedDeserializer.deserialize(TypeWrappedDeserializer.java:68)\n    at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4482)\n    at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3479)\n    at org.springframework.batch.core.repository.dao.Jackson2ExecutionContextStringSerializer.deserialize(Jackson2ExecutionContextStringSerializer.java:123)\n    at org.springframework.batch.core.repository.dao.Jackson2ExecutionContextStringSerializer.deserialize(Jackson2ExecutionContextStringSerializer.java:102)\n    at org.springframework.batch.core.repository.dao.JdbcExecutionContextDao$ExecutionContextRowMapper.mapRow(JdbcExecutionContextDao.java:325)\n    ... 45 common frames omitted\n\n\n</code></pre>\n<p>I understand that the new version has a restricted handling of JSON deserialization and attempted to implement the suggested fix from the <code>Jackson2ExecutionContextStringSerializer</code> javadoc, however the problem persists:</p>\n<pre><code>@EnableBatchProcessing\n@Configuration\nclass BatchConfig(\n\n    val properties: BatchProperties,\n    val dataSource: DataSource,\n    val transactionManagerCustomizers: TransactionManagerCustomizers,\n    val entityManagerFactory: EntityManagerFactory\n) : JpaBatchConfigurer(properties, dataSource, transactionManagerCustomizers, entityManagerFactory) {\n\n    override fun createJobRepository(): JobRepository {\n        val factory = JobRepositoryFactoryBean()\n        val map = PropertyMapper.get()\n        map.from(dataSource).to { dataSource: DataSource? -&gt; factory.setDataSource(dataSource!!) }\n        map.from { determineIsolationLevel() }.whenNonNull().to { isolationLevelForCreate: String? -&gt; factory.setIsolationLevelForCreate(isolationLevelForCreate!!) }\n        map.from { properties.tablePrefix }.whenHasText().to { tablePrefix: String? -&gt; factory.setTablePrefix(tablePrefix!!) }\n        map.from { transactionManager }.to { transactionManager: PlatformTransactionManager? -&gt; factory.transactionManager = transactionManager!! }\n        factory.afterPropertiesSet()\n\n        val serializer = configureContextSerializer()\n        factory.setSerializer(serializer)\n\n        return factory.getObject()\n    }\n\n    private fun configureContextSerializer(): Jackson2ExecutionContextStringSerializer {\n        val polymorphicTypeValidator = LaissezFaireSubTypeValidator()\n        objectMapper.activateDefaultTyping(polymorphicTypeValidator)\n        val serializer = Jackson2ExecutionContextStringSerializer()\n        serializer.setObjectMapper(objectMapper)\n        return serializer\n    }\n</code></pre>\n<p>The craziest part is that the execution context is actually empty, the database value is always <code>&quot;{}&quot;</code>. I even tried changing all values in the DB to <code>&quot;{&quot;@class&quot;:&quot;java.util.HashMap&quot;}&quot;</code>, but I still get the same exception.</p>\n<p>Does anyone have an idea how to fix this? Is the configuration from my fix attempt wrong?</p>\n"},{"tags":["java","minecraft","minecraft-forge"],"comments":[{"owner":{"account_id":8860436,"reputation":45945,"user_id":7509065,"display_name":"Joseph Sible-Reinstate Monica"},"score":0,"creation_date":1684821606,"post_id":76311412,"comment_id":134568730,"body_markdown":"Hint: Compare the Java versions on the working and non-working computers.","body":"Hint: Compare the Java versions on the working and non-working computers."},{"owner":{"account_id":1992310,"reputation":11172,"user_id":1786065,"accept_rate":91,"display_name":"Rogue"},"score":0,"creation_date":1684854835,"post_id":76311412,"comment_id":134576617,"body_markdown":"Regarding your &quot;update&quot;: the shown script doesn&#39;t demonstrate this change at all, it&#39;s still using `java`. Unless you&#39;ve updated your environment variables (such that `java --version` reports something other than Java 19), then you haven&#39;t really changed anything.","body":"Regarding your &quot;update&quot;: the shown script doesn&#39;t demonstrate this change at all, it&#39;s still using <code>java</code>. Unless you&#39;ve updated your environment variables (such that <code>java --version</code> reports something other than Java 19), then you haven&#39;t really changed anything."},{"owner":{"account_id":28659535,"reputation":1,"user_id":21944738,"display_name":"Green_ lint"},"score":0,"creation_date":1684859489,"post_id":76311412,"comment_id":134577767,"body_markdown":"I had put the file path to the folder that contained the exe for java 1.8 but I made that update from my other computer and was a bit rushed so I didn&#39;t copy over the file path. I will add it when I get done with work.","body":"I had put the file path to the folder that contained the exe for java 1.8 but I made that update from my other computer and was a bit rushed so I didn&#39;t copy over the file path. I will add it when I get done with work."}],"owner":{"account_id":28659535,"reputation":1,"user_id":21944738,"display_name":"Green_ lint"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":346,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684847930,"creation_date":1684818126,"question_id":76311412,"body_markdown":"I am trying to host a Minecraft server and I&#39;m getting errors whenever I run the .bat for the server.\r\n\r\nHere is the contents of the .bat file that starts the server\r\n\r\n\r\n\r\n\r\n```\r\n@ECHO OFF\r\n\r\n:: When setting the memory below make sure to include the amount of ram letter. M = MB, G = GB. Don&#39;t use 1GB for example, it&#39;s 1G ::\r\n\r\n:: This is 64-bit memory ::\r\nset memsixtyfour=4G\r\n\r\n:: This is 32-bit memory - maximum 1.2G ish::\r\nset memthirtytwo=1G\r\n\r\n:: The path to the Java to use. Wrap in double quotes (&quot;C:\\Path\\To\\Java\\bin\\java&quot;). Use &quot;java&quot; to point to system default install.\r\nset javapath=&quot;java&quot;\r\n\r\n:: Any additional arguments to pass to Java such as Metaspace, GC or anything else\r\nset jvmargs=&quot;&quot;\r\n\r\n:: Don&#39;t edit past this point ::\r\n\r\nif $SYSTEM_os_arch==x86 (\r\n    echo OS is 32\r\n    set mem=%memthirtytwo%\r\n) else (\r\n    echo OS is 64\r\n    set mem=%memsixtyfour%\r\n)\r\n\r\n%javapath% -version\r\n\r\necho Launching forge-1.12.2-14.23.5.2860.jar with &#39;%mem%&#39; max memory, jvm args &#39;%jvmargs%&#39; and arguments &#39;%*&#39;\r\n\r\n:: add nogui to the end of this line to disable the gui ::\r\n%javapath% -Xmx%mem% %jvm_args%  -Dlog4j2.formatMsgNoLookups=true -Dlog4j.configurationFile=log4j2.xml -jar forge-1.12.2-14.23.5.2860.jar %*\r\nPAUSE\r\n```\r\n\r\n\r\nThis code is supposed to get the proper version of java, which is a variation of 1.8, and start the server startup but when it runs all I get is this error\r\n\r\n\r\n```\r\nOS is 64\r\njava version &quot;19.0.1&quot; 2022-10-18\r\nJava(TM) SE Runtime Environment (build 19.0.1+10-21)\r\nJava HotSpot(TM) 64-Bit Server VM (build 19.0.1+10-21, mixed mode, sharing)\r\nLaunching forge-1.12.2-14.23.5.2860.jar with &#39;4G&#39; max memory, jvm args &#39;&quot;&quot;&#39; and arguments &#39;&#39;\r\nA problem occurred running the Server launcher.java.lang.reflect.InvocationTargetException\r\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:110)\r\n        at java.base/java.lang.reflect.Method.invoke(Method.java:578)\r\n        at net.minecraftforge.fml.relauncher.ServerLaunchWrapper.run(ServerLaunchWrapper.java:70)\r\n        at net.minecraftforge.fml.relauncher.ServerLaunchWrapper.main(ServerLaunchWrapper.java:34)\r\nCaused by: java.lang.ClassCastException: class jdk.internal.loader.ClassLoaders$AppClassLoader cannot be cast to class java.net.URLClassLoader (jdk.internal.loader.ClassLoaders$AppClassLoader and java.net.URLClassLoader are in module java.base of loader &#39;bootstrap&#39;)\r\n        at net.minecraft.launchwrapper.Launch.&lt;init&gt;(Launch.java:34)\r\n        at net.minecraft.launchwrapper.Launch.main(Launch.java:28)\r\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\r\n        ... 3 more\r\nPress any key to continue . . .\r\n```\r\n\r\n\r\nI have no clue what is going on as I have tried the exact same thing on my desktop and it works.\r\nAll help is appreciated.\r\n\r\n--- Update 5/23/2023 9:11am ---\r\nI have tried to force the .bat file to use the proper version of java from a fresh install of jdk-8u351 and directing (used the file path to the bin directory which holds the java executable) the file to where &quot;java&quot; is when it set.\r\n\r\n```\r\n:: The path to the Java to use. Wrap in double quotes (&quot;C:\\Path\\To\\Java\\bin\\java&quot;). Use &quot;java&quot; to point to system default install.\r\nset javapath=&quot;java&quot;\r\n\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","title":"having trouble setting up a minecraft server, whenever I run the .bat it errors out and I don&#39;t know why as it works on my Desktop fine, same setup","body":"<p>I am trying to host a Minecraft server and I'm getting errors whenever I run the .bat for the server.</p>\n<p>Here is the contents of the .bat file that starts the server</p>\n<pre><code>@ECHO OFF\n\n:: When setting the memory below make sure to include the amount of ram letter. M = MB, G = GB. Don't use 1GB for example, it's 1G ::\n\n:: This is 64-bit memory ::\nset memsixtyfour=4G\n\n:: This is 32-bit memory - maximum 1.2G ish::\nset memthirtytwo=1G\n\n:: The path to the Java to use. Wrap in double quotes (&quot;C:\\Path\\To\\Java\\bin\\java&quot;). Use &quot;java&quot; to point to system default install.\nset javapath=&quot;java&quot;\n\n:: Any additional arguments to pass to Java such as Metaspace, GC or anything else\nset jvmargs=&quot;&quot;\n\n:: Don't edit past this point ::\n\nif $SYSTEM_os_arch==x86 (\n    echo OS is 32\n    set mem=%memthirtytwo%\n) else (\n    echo OS is 64\n    set mem=%memsixtyfour%\n)\n\n%javapath% -version\n\necho Launching forge-1.12.2-14.23.5.2860.jar with '%mem%' max memory, jvm args '%jvmargs%' and arguments '%*'\n\n:: add nogui to the end of this line to disable the gui ::\n%javapath% -Xmx%mem% %jvm_args%  -Dlog4j2.formatMsgNoLookups=true -Dlog4j.configurationFile=log4j2.xml -jar forge-1.12.2-14.23.5.2860.jar %*\nPAUSE\n</code></pre>\n<p>This code is supposed to get the proper version of java, which is a variation of 1.8, and start the server startup but when it runs all I get is this error</p>\n<pre><code>OS is 64\njava version &quot;19.0.1&quot; 2022-10-18\nJava(TM) SE Runtime Environment (build 19.0.1+10-21)\nJava HotSpot(TM) 64-Bit Server VM (build 19.0.1+10-21, mixed mode, sharing)\nLaunching forge-1.12.2-14.23.5.2860.jar with '4G' max memory, jvm args '&quot;&quot;' and arguments ''\nA problem occurred running the Server launcher.java.lang.reflect.InvocationTargetException\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:110)\n        at java.base/java.lang.reflect.Method.invoke(Method.java:578)\n        at net.minecraftforge.fml.relauncher.ServerLaunchWrapper.run(ServerLaunchWrapper.java:70)\n        at net.minecraftforge.fml.relauncher.ServerLaunchWrapper.main(ServerLaunchWrapper.java:34)\nCaused by: java.lang.ClassCastException: class jdk.internal.loader.ClassLoaders$AppClassLoader cannot be cast to class java.net.URLClassLoader (jdk.internal.loader.ClassLoaders$AppClassLoader and java.net.URLClassLoader are in module java.base of loader 'bootstrap')\n        at net.minecraft.launchwrapper.Launch.&lt;init&gt;(Launch.java:34)\n        at net.minecraft.launchwrapper.Launch.main(Launch.java:28)\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\n        ... 3 more\nPress any key to continue . . .\n</code></pre>\n<p>I have no clue what is going on as I have tried the exact same thing on my desktop and it works.\nAll help is appreciated.</p>\n<p>--- Update 5/23/2023 9:11am ---\nI have tried to force the .bat file to use the proper version of java from a fresh install of jdk-8u351 and directing (used the file path to the bin directory which holds the java executable) the file to where &quot;java&quot; is when it set.</p>\n<pre><code>:: The path to the Java to use. Wrap in double quotes (&quot;C:\\Path\\To\\Java\\bin\\java&quot;). Use &quot;java&quot; to point to system default install.\nset javapath=&quot;java&quot;\n\n</code></pre>\n"},{"tags":["java","multithreading","concurrency"],"comments":[{"owner":{"account_id":3887004,"reputation":46525,"user_id":3218114,"accept_rate":84,"display_name":"Braj"},"score":16,"creation_date":1407351398,"post_id":25168062,"comment_id":39185046,"body_markdown":"Why don&#39;t you try with [`AtomicInteger`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicInteger.html)?","body":"Why don&#39;t you try with <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicInteger.html\" rel=\"nofollow noreferrer\"><code>AtomicInteger</code></a>?"},{"owner":{"account_id":33828,"reputation":8054,"user_id":95033,"accept_rate":100,"display_name":"Wolfram"},"score":7,"creation_date":1407352286,"post_id":25168062,"comment_id":39185510,"body_markdown":"See also: [another SO question](http://stackoverflow.com/questions/7640533/is-the-pre-incriment-operator-thread-safe-java), [++ not considered atomic](http://madbean.com/2003/mb2003-44/), [Concurrency in Java](http://www.informit.com/articles/article.aspx?p=31682&amp;seqNum=3).","body":"See also: <a href=\"http://stackoverflow.com/questions/7640533/is-the-pre-incriment-operator-thread-safe-java\">another SO question</a>, <a href=\"http://madbean.com/2003/mb2003-44/\" rel=\"nofollow noreferrer\">++ not considered atomic</a>, <a href=\"http://www.informit.com/articles/article.aspx?p=31682&amp;seqNum=3\" rel=\"nofollow noreferrer\">Concurrency in Java</a>."},{"owner":{"account_id":332696,"reputation":3028,"user_id":658138,"display_name":"Mike Brennan"},"score":0,"creation_date":1407360136,"post_id":25168062,"comment_id":39189739,"body_markdown":"@user2864740, why do you say AtomicInteger is not atomic? You can use the [getAndIncrement](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicInteger.html#getAndIncrement()) method to do this. It is atomic.","body":"@user2864740, why do you say AtomicInteger is not atomic? You can use the <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicInteger.html#getAndIncrement()\" rel=\"nofollow noreferrer\">getAndIncrement</a> method to do this. It is atomic."},{"owner":{"account_id":154912,"reputation":4111,"user_id":371191,"accept_rate":71,"display_name":"Silly Freak"},"score":4,"creation_date":1407360247,"post_id":25168062,"comment_id":39189786,"body_markdown":"the JVM has an `iinc` operation for incrementing integers, but that only works for local variables, where concurrency is not a concern. For fields, the compiler generates read-modify-write commands separately.","body":"the JVM has an <code>iinc</code> operation for incrementing integers, but that only works for local variables, where concurrency is not a concern. For fields, the compiler generates read-modify-write commands separately."},{"owner":{"account_id":284109,"reputation":47153,"user_id":581994,"accept_rate":57,"display_name":"Hot Licks"},"score":15,"creation_date":1407362119,"post_id":25168062,"comment_id":39190685,"body_markdown":"Why would you even expect it to be atomic?","body":"Why would you even expect it to be atomic?"},{"owner":{"account_id":284109,"reputation":47153,"user_id":581994,"accept_rate":57,"display_name":"Hot Licks"},"score":1,"creation_date":1407376269,"post_id":25168062,"comment_id":39194465,"body_markdown":"Even on hardware that implements an &quot;increment storage location&quot; instruction, there&#39;s no guarantee that that&#39;s thread-safe.  Just because an operation can be represented as a single operator says nothing about it&#39;s thread-safety.","body":"Even on hardware that implements an &quot;increment storage location&quot; instruction, there&#39;s no guarantee that that&#39;s thread-safe.  Just because an operation can be represented as a single operator says nothing about it&#39;s thread-safety."},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":2,"creation_date":1407408090,"post_id":25168062,"comment_id":39207037,"body_markdown":"@Silly Freak: even if there was an `iinc` instruction for fields, having a single instruction does not guarantee atomicity, e.g. non-`volatile` `long` and `double` field access in not guaranteed to be atomic regardless of the fact that it is performed by a single bytecode instruction.","body":"@Silly Freak: even if there was an <code>iinc</code> instruction for fields, having a single instruction does not guarantee atomicity, e.g. non-<code>volatile</code> <code>long</code> and <code>double</code> field access in not guaranteed to be atomic regardless of the fact that it is performed by a single bytecode instruction."},{"owner":{"account_id":7413926,"reputation":5474,"user_id":11374957,"display_name":"Kaan"},"score":0,"creation_date":1580253654,"post_id":25168062,"comment_id":106035594,"body_markdown":"This question highlights the usefulness of learning assembly language.","body":"This question highlights the usefulness of learning assembly language."}],"answers":[{"tags":[],"owner":{"account_id":2742958,"reputation":2201,"user_id":2364028,"accept_rate":60,"display_name":"celeritas"},"comment_count":0,"down_vote_count":4,"up_vote_count":6,"is_accepted":false,"score":2,"last_activity_date":1407351515,"creation_date":1407351515,"answer_id":25168103,"question_id":25168062,"body_markdown":"In the JVM, an increment involves a read and a write, so it&#39;s not atomic. ","title":"Why is i++ not atomic?","body":"<p>In the JVM, an increment involves a read and a write, so it's not atomic. </p>\n"},{"comments":[{"owner":{"account_id":3415784,"reputation":60457,"user_id":2864740,"accept_rate":78,"display_name":"user2864740"},"score":0,"creation_date":1407351631,"post_id":25168105,"comment_id":39185180,"body_markdown":"(Even if `i++` *was* atomic, it would not be well-defined/thread-safe behavior.)","body":"(Even if <code>i++</code> <i>was</i> atomic, it would not be well-defined/thread-safe behavior.)"},{"owner":{"account_id":1079173,"reputation":42590,"user_id":1076640,"display_name":"yshavit"},"score":17,"creation_date":1407352216,"post_id":25168105,"comment_id":39185473,"body_markdown":"+1, but &quot;1. A, 2. B and C&quot; sounds like three operations, not two. :)","body":"+1, but &quot;1. A, 2. B and C&quot; sounds like three operations, not two. :)"},{"owner":{"account_id":284109,"reputation":47153,"user_id":581994,"accept_rate":57,"display_name":"Hot Licks"},"score":3,"creation_date":1407376486,"post_id":25168105,"comment_id":39194506,"body_markdown":"Note that even if the operation were implemented with a single machine instruction that incremented a storage location in place, there is no guarantee it would be thread-safe.  The machine still needs to fetch the value, increment it, and store it back, *plus* there may be multiple cache copies of that storage location.","body":"Note that even if the operation were implemented with a single machine instruction that incremented a storage location in place, there is no guarantee it would be thread-safe.  The machine still needs to fetch the value, increment it, and store it back, <i>plus</i> there may be multiple cache copies of that storage location."},{"owner":{"account_id":1137318,"reputation":8962,"user_id":1150915,"display_name":"Aquarelle"},"score":0,"creation_date":1407400599,"post_id":25168105,"comment_id":39202596,"body_markdown":"@HotLicks Not necessarily.  If the fetch, increment and store are done atomically, or in one single &quot;transaction&quot; (on the CPU level), then it&#39;s presumably thread-safe.  Although, yes, there may be cached copies, but that&#39;s a different story.  I think the only possible contention would be if the incrementing thread were paused (due to kernel scheduling) before the increment operation completed, possibly allowing another thread to read the variable.  I would think it depends upon the threading implementation, OS, and CPU.","body":"@HotLicks Not necessarily.  If the fetch, increment and store are done atomically, or in one single &quot;transaction&quot; (on the CPU level), then it&#39;s presumably thread-safe.  Although, yes, there may be cached copies, but that&#39;s a different story.  I think the only possible contention would be if the incrementing thread were paused (due to kernel scheduling) before the increment operation completed, possibly allowing another thread to read the variable.  I would think it depends upon the threading implementation, OS, and CPU."},{"owner":{"account_id":284109,"reputation":47153,"user_id":581994,"accept_rate":57,"display_name":"Hot Licks"},"score":3,"creation_date":1407412922,"post_id":25168105,"comment_id":39209964,"body_markdown":"@Aquarelle - If two processors execute the same operation against the same storage location simultaneously, and there is no &quot;reserve&quot; broadcast on the location, then they will almost certainly interfere and produce bogus results.  Yes, it is possible for this operation to be &quot;safe&quot;, but it takes special effort, even at the hardware level.","body":"@Aquarelle - If two processors execute the same operation against the same storage location simultaneously, and there is no &quot;reserve&quot; broadcast on the location, then they will almost certainly interfere and produce bogus results.  Yes, it is possible for this operation to be &quot;safe&quot;, but it takes special effort, even at the hardware level."},{"owner":{"account_id":28649,"reputation":38698,"user_id":76722,"accept_rate":80,"display_name":"Sebastian Mach"},"score":7,"creation_date":1407482270,"post_id":25168105,"comment_id":39240369,"body_markdown":"But I think the question was &quot;Why&quot; and not &quot;What happens&quot;.","body":"But I think the question was &quot;Why&quot; and not &quot;What happens&quot;."},{"owner":{"account_id":1263831,"reputation":388998,"user_id":1221571,"accept_rate":67,"display_name":"Eran"},"score":0,"creation_date":1407501294,"post_id":25168105,"comment_id":39250673,"body_markdown":"@phresnel I interpreted the question differently,  since if the op wanted to know why java creators chose not to make ++ atomic, there was no need for all the code posted. The code implied they asked why the code behaves the way it does. Based on the accepted answer I may have been wrong.","body":"@phresnel I interpreted the question differently,  since if the op wanted to know why java creators chose not to make ++ atomic, there was no need for all the code posted. The code implied they asked why the code behaves the way it does. Based on the accepted answer I may have been wrong."},{"owner":{"account_id":1674243,"reputation":10078,"user_id":1553537,"accept_rate":29,"display_name":"Giorgi Tsiklauri"},"score":0,"creation_date":1497088357,"post_id":25168105,"comment_id":75939384,"body_markdown":"Thank you; however, I think, that 1) read current; 2)increment; 3) assign it back is still three operations :)","body":"Thank you; however, I think, that 1) read current; 2)increment; 3) assign it back is still three operations :)"}],"tags":[],"owner":{"account_id":1263831,"reputation":388998,"user_id":1221571,"accept_rate":67,"display_name":"Eran"},"comment_count":8,"down_vote_count":4,"up_vote_count":46,"is_accepted":false,"score":42,"last_activity_date":1407351518,"creation_date":1407351518,"answer_id":25168105,"question_id":25168062,"body_markdown":"`i++` involves two operations :\r\n\r\n1. read the current value of `i`\r\n2. increment the value and assign it to `i`\r\n\r\nWhen two threads perform `i++` on the same variable at the same time, they may both get the same current value of `i`, and then increment and set it to `i+1`, so you&#39;ll get a single incrementation instead of two.\r\n\r\nExample :\r\n\r\n    int i = 5;\r\n    Thread 1 : i++;\r\n               // reads value 5\r\n    Thread 2 : i++;\r\n               // reads value 5\r\n    Thread 1 : // increments i to 6\r\n    Thread 2 : // increments i to 6\r\n               // i == 6 instead of 7","title":"Why is i++ not atomic?","body":"<p><code>i++</code> involves two operations :</p>\n\n<ol>\n<li>read the current value of <code>i</code></li>\n<li>increment the value and assign it to <code>i</code></li>\n</ol>\n\n<p>When two threads perform <code>i++</code> on the same variable at the same time, they may both get the same current value of <code>i</code>, and then increment and set it to <code>i+1</code>, so you'll get a single incrementation instead of two.</p>\n\n<p>Example :</p>\n\n<pre><code>int i = 5;\nThread 1 : i++;\n           // reads value 5\nThread 2 : i++;\n           // reads value 5\nThread 1 : // increments i to 6\nThread 2 : // increments i to 6\n           // i == 6 instead of 7\n</code></pre>\n"},{"comments":[{"owner":{"account_id":28649,"reputation":38698,"user_id":76722,"accept_rate":80,"display_name":"Sebastian Mach"},"score":3,"creation_date":1407423277,"post_id":25168135,"comment_id":39217236,"body_markdown":"I don&#39;t get how this should be an answer to the question. A language can define any feature as atomic, be it increments or unicorns. You just exemplify a consequence of not being atomic.","body":"I don&#39;t get how this should be an answer to the question. A language can define any feature as atomic, be it increments or unicorns. You just exemplify a consequence of not being atomic."},{"owner":{"account_id":2784842,"reputation":67281,"user_id":2396539,"accept_rate":78,"display_name":"Aniket Thakur"},"score":0,"creation_date":1407428955,"post_id":25168135,"comment_id":39220980,"body_markdown":"Yes a language can define any feature as atomic but as far as java is considered increment operator(which is the question posted by OP) is not atomic and my answer states the reasons.","body":"Yes a language can define any feature as atomic but as far as java is considered increment operator(which is the question posted by OP) is not atomic and my answer states the reasons."},{"owner":{"account_id":28649,"reputation":38698,"user_id":76722,"accept_rate":80,"display_name":"Sebastian Mach"},"score":2,"creation_date":1407429654,"post_id":25168135,"comment_id":39221347,"body_markdown":"(sorry for my harsh tone in first comment) But then, the reason seems to be &quot;because if it would be atomic, then there would be no race conditions&quot;. I.e., it sounds as if a race condition is desirable.","body":"(sorry for my harsh tone in first comment) But then, the reason seems to be &quot;because if it would be atomic, then there would be no race conditions&quot;. I.e., it sounds as if a race condition is desirable."},{"owner":{"account_id":75323,"reputation":15516,"user_id":216111,"accept_rate":100,"display_name":"josefx"},"score":0,"creation_date":1407477619,"post_id":25168135,"comment_id":39238421,"body_markdown":"@phresnel  the overhead introduced to keep an increment atomic is huge and rarely desired, keeping the operation cheap and as a result non atomic is desirable most of the time.","body":"@phresnel  the overhead introduced to keep an increment atomic is huge and rarely desired, keeping the operation cheap and as a result non atomic is desirable most of the time."},{"owner":{"account_id":28649,"reputation":38698,"user_id":76722,"accept_rate":80,"display_name":"Sebastian Mach"},"score":5,"creation_date":1407481785,"post_id":25168135,"comment_id":39240143,"body_markdown":"@josefx: Note that I am not questioning the facts, but the reasoning in this answer. It basically says _&quot;i++ is not atomic in Java because of the race conditions it has&quot;_, which is like saying _&quot;a car has no airbag because of the crashes that can happen&quot;_ or _&quot;you get no knife with your currywurst-order because the wurst may need to be cut&quot;_. Thus, I don&#39;t think this is an answer. The question was not _&quot;What does i++ do?&quot;_ or _&quot;What is the consequence of i++ not being synced?&quot;_.","body":"@josefx: Note that I am not questioning the facts, but the reasoning in this answer. It basically says <i>&quot;i++ is not atomic in Java because of the race conditions it has&quot;</i>, which is like saying <i>&quot;a car has no airbag because of the crashes that can happen&quot;</i> or <i>&quot;you get no knife with your currywurst-order because the wurst may need to be cut&quot;</i>. Thus, I don&#39;t think this is an answer. The question was not <i>&quot;What does i++ do?&quot;</i> or <i>&quot;What is the consequence of i++ not being synced?&quot;</i>."}],"tags":[],"owner":{"account_id":2784842,"reputation":67281,"user_id":2396539,"accept_rate":78,"display_name":"Aniket Thakur"},"comment_count":5,"down_vote_count":5,"up_vote_count":11,"is_accepted":false,"score":6,"last_activity_date":1407378905,"creation_date":1407351628,"answer_id":25168135,"question_id":25168062,"body_markdown":"&gt;    Why is i++ not atomic in Java?\r\n\r\nLet&#39;s break the increment operation into multiple statements:\r\n\r\nThread 1 &amp; 2 :\r\n\r\n1. Fetch value of total from memory\r\n2. Add 1 to the value\r\n3. Write back to the memory\r\n\r\nIf there is no synchronization then let&#39;s say Thread one has read the value 3 and incremented it to 4, but has not written it back. At this point, the context switch happens. Thread two reads the value 3, increments it and the context switch happens. Though both threads have incremented the total value, it will still be 4 - race condition.\r\n","title":"Why is i++ not atomic?","body":"<blockquote>\n  <p>Why is i++ not atomic in Java?</p>\n</blockquote>\n\n<p>Let's break the increment operation into multiple statements:</p>\n\n<p>Thread 1 &amp; 2 :</p>\n\n<ol>\n<li>Fetch value of total from memory</li>\n<li>Add 1 to the value</li>\n<li>Write back to the memory</li>\n</ol>\n\n<p>If there is no synchronization then let's say Thread one has read the value 3 and incremented it to 4, but has not written it back. At this point, the context switch happens. Thread two reads the value 3, increments it and the context switch happens. Though both threads have incremented the total value, it will still be 4 - race condition.</p>\n"},{"comments":[{"owner":{"account_id":154912,"reputation":4111,"user_id":371191,"accept_rate":71,"display_name":"Silly Freak"},"score":0,"creation_date":1407360785,"post_id":25168153,"comment_id":39190058,"body_markdown":"-1 &quot;public class Thread ... Since: JDK1.0&quot; Source: http://docs.oracle.com/javase/7/docs/api/index.html?java/lang/Thread.html","body":"-1 &quot;public class Thread ... Since: JDK1.0&quot; Source: <a href=\"http://docs.oracle.com/javase/7/docs/api/index.html?java/lang/Thread.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/7/docs/api/index.html?java/lang/&hellip;</a>"},{"owner":{"account_id":2772023,"reputation":1026,"user_id":2386432,"accept_rate":79,"display_name":"TheBat"},"score":0,"creation_date":1407361075,"post_id":25168153,"comment_id":39190212,"body_markdown":"The version doesn&#39;t matter so much as the fact that it was still implemented before the Thread class and was not changed because of it, but I&#39;ve edited my answer to please you.","body":"The version doesn&#39;t matter so much as the fact that it was still implemented before the Thread class and was not changed because of it, but I&#39;ve edited my answer to please you."},{"owner":{"account_id":154912,"reputation":4111,"user_id":371191,"accept_rate":71,"display_name":"Silly Freak"},"score":6,"creation_date":1407361239,"post_id":25168153,"comment_id":39190286,"body_markdown":"What matters is that your claim &quot;it was still implemented before the Thread class&quot; is not backed by sources. `i++` not being atomic is a design decision, not an oversight in a growing system.","body":"What matters is that your claim &quot;it was still implemented before the Thread class&quot; is not backed by sources. <code>i++</code> not being atomic is a design decision, not an oversight in a growing system."},{"owner":{"account_id":2772023,"reputation":1026,"user_id":2386432,"accept_rate":79,"display_name":"TheBat"},"score":0,"creation_date":1407424574,"post_id":25168153,"comment_id":39218137,"body_markdown":"Lol that&#39;s cute. i++ was defined well before Threads, simply because there were languages that existed before Java. The creators of Java used those other languages as a base instead of redefining a well accepted procedure. Where did I ever say it was an oversight?","body":"Lol that&#39;s cute. i++ was defined well before Threads, simply because there were languages that existed before Java. The creators of Java used those other languages as a base instead of redefining a well accepted procedure. Where did I ever say it was an oversight?"},{"owner":{"account_id":2772023,"reputation":1026,"user_id":2386432,"accept_rate":79,"display_name":"TheBat"},"score":0,"creation_date":1407424942,"post_id":25168153,"comment_id":39218413,"body_markdown":"@SillyFreak Here&#39;s some sources that show how old ++ is: http://en.wikipedia.org/wiki/Increment_and_decrement_operators\nhttp://en.wikipedia.org/wiki/B_(programming_language)","body":"@SillyFreak Here&#39;s some sources that show how old ++ is: <a href=\"http://en.wikipedia.org/wiki/Increment_and_decrement_operators\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Increment_and_decrement_operators</a> <a href=\"http://en.wikipedia.org/wiki/B_(programming_language)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/B_(programming_language)</a>"},{"owner":{"account_id":2087685,"reputation":16041,"user_id":1858225,"accept_rate":74,"display_name":"Kyle Strand"},"score":1,"creation_date":1407431353,"post_id":25168153,"comment_id":39222298,"body_markdown":"Just because a language feature is borrowed from or inspired by a corresponding feature in other languages doesn&#39;t mean it necessarily keeps the exact same underlying characteristics. Consider, for instance, the variety of `lambda` functions in different languages (e.g. the weakness of Python&#39;s `lambda` compared to true Lisp lambdas http://symbo1ics.com/blog/?p=1292). Even in C++, certain features taken from C aren&#39;t quite identical to their C counterparts, *despite* the fact that C++ is often thought to be backwards-compatible with C (http://www.cprogramming.com/tutorial/c-vs-c++.html).","body":"Just because a language feature is borrowed from or inspired by a corresponding feature in other languages doesn&#39;t mean it necessarily keeps the exact same underlying characteristics. Consider, for instance, the variety of <code>lambda</code> functions in different languages (e.g. the weakness of Python&#39;s <code>lambda</code> compared to true Lisp lambdas <a href=\"http://symbo1ics.com/blog/?p=1292\" rel=\"nofollow noreferrer\">symbo1ics.com/blog/?p=1292</a>). Even in C++, certain features taken from C aren&#39;t quite identical to their C counterparts, <i>despite</i> the fact that C++ is often thought to be backwards-compatible with C (<a href=\"http://www.cprogramming.com/tutorial/c-vs-c++.html\" rel=\"nofollow noreferrer\">cprogramming.com/tutorial/c-vs-c++.html</a>)."},{"owner":{"account_id":28649,"reputation":38698,"user_id":76722,"accept_rate":80,"display_name":"Sebastian Mach"},"score":1,"creation_date":1407482236,"post_id":25168153,"comment_id":39240353,"body_markdown":"@TheBat: But many borrowed keywords and operators __are not__ implemented like in the language/s they were borrowed from. E.g., `class` and `operator.` in C++ are totally orthogonal to their Java &quot;equivalents&quot;.","body":"@TheBat: But many borrowed keywords and operators <b>are not</b> implemented like in the language/s they were borrowed from. E.g., <code>class</code> and <code>operator.</code> in C++ are totally orthogonal to their Java &quot;equivalents&quot;."}],"tags":[],"owner":{"account_id":2772023,"reputation":1026,"user_id":2386432,"accept_rate":79,"display_name":"TheBat"},"comment_count":7,"down_vote_count":7,"up_vote_count":5,"is_accepted":false,"score":-2,"last_activity_date":1407424864,"creation_date":1407351684,"answer_id":25168153,"question_id":25168062,"body_markdown":"Concurrency (the `Thread` class and such) is an added feature in v1.0 of [Java][1]. `i++` was added in the beta before that, and as such is it still more than likely in its (more or less) original implementation.\r\n\r\nIt is up to the programmer to synchronize variables. Check out [Oracle&#39;s tutorial on this][2].\r\n\r\nEdit: To clarify, i++ is a well defined procedure that predates Java, and as such the designers of Java decided to keep the original functionality of that procedure.\r\n\r\nThe ++ operator was defined in B (1969) which predates java and threading by just a tad.\r\n\r\n  [1]: http://en.wikipedia.org/wiki/Java_%28programming_language%29\r\n  [2]: http://docs.oracle.com/javase/tutorial/essential/concurrency/","title":"Why is i++ not atomic?","body":"<p>Concurrency (the <code>Thread</code> class and such) is an added feature in v1.0 of <a href=\"http://en.wikipedia.org/wiki/Java_%28programming_language%29\" rel=\"nofollow\">Java</a>. <code>i++</code> was added in the beta before that, and as such is it still more than likely in its (more or less) original implementation.</p>\n\n<p>It is up to the programmer to synchronize variables. Check out <a href=\"http://docs.oracle.com/javase/tutorial/essential/concurrency/\" rel=\"nofollow\">Oracle's tutorial on this</a>.</p>\n\n<p>Edit: To clarify, i++ is a well defined procedure that predates Java, and as such the designers of Java decided to keep the original functionality of that procedure.</p>\n\n<p>The ++ operator was defined in B (1969) which predates java and threading by just a tad.</p>\n"},{"tags":[],"owner":{"account_id":2321321,"reputation":2169,"user_id":2036983,"display_name":"Jonathan Rosenne"},"comment_count":0,"down_vote_count":0,"up_vote_count":15,"is_accepted":false,"score":15,"last_activity_date":1612998169,"creation_date":1407354240,"answer_id":25168841,"question_id":25168062,"body_markdown":"# Java specification\r\n\r\nThe important thing is the [JLS (Java Language Specification)][1] rather than how various implementations of the JVM may or may not have implemented a certain feature of the language. \r\n\r\nThe JLS defines the ++ postfix operator in clause 15.14.2 which says i.a. &quot;the value 1 is added to the value of the variable and the sum is stored back into the variable&quot;. Nowhere does it mention or hint at multithreading or atomicity. \r\n\r\nFor multithreading or atomicity, the JLS provides *volatile* and *synchronized*. Additionally, there are the [`Atomic…`][2] classes.\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/specs/\r\n  [2]: https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/atomic/package-summary.html","title":"Why is i++ not atomic?","body":"<h1>Java specification</h1>\n<p>The important thing is the <a href=\"https://docs.oracle.com/javase/specs/\" rel=\"nofollow noreferrer\">JLS (Java Language Specification)</a> rather than how various implementations of the JVM may or may not have implemented a certain feature of the language.</p>\n<p>The JLS defines the ++ postfix operator in clause 15.14.2 which says i.a. &quot;the value 1 is added to the value of the variable and the sum is stored back into the variable&quot;. Nowhere does it mention or hint at multithreading or atomicity.</p>\n<p>For multithreading or atomicity, the JLS provides <em>volatile</em> and <em>synchronized</em>. Additionally, there are the <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/atomic/package-summary.html\" rel=\"nofollow noreferrer\"><code>Atomic…</code></a> classes.</p>\n"},{"comments":[{"owner":{"account_id":154912,"reputation":4111,"user_id":371191,"accept_rate":71,"display_name":"Silly Freak"},"score":2,"creation_date":1407363596,"post_id":25171089,"comment_id":39191223,"body_markdown":"as java has no pointers, incrementing local variables is inherently thread save, so with loops the problem mostly wouldn&#39;t be so bad. your point about least surprise stands, of course.\n\nalso, as it is, `i = i + 1` would be a translation for `++i`, not `i++`","body":"as java has no pointers, incrementing local variables is inherently thread save, so with loops the problem mostly wouldn&#39;t be so bad. your point about least surprise stands, of course.  also, as it is, <code>i = i + 1</code> would be a translation for <code>++i</code>, not <code>i++</code>"},{"owner":{"account_id":1085259,"reputation":78314,"user_id":1081110,"display_name":"Dawood ibn Kareem"},"score":23,"creation_date":1407375884,"post_id":25171089,"comment_id":39194375,"body_markdown":"The first word of the question is &quot;why&quot;.  As of now, this is the only answer to address the issue of &quot;why&quot;.  The other answers really just re-state the question.  So +1.","body":"The first word of the question is &quot;why&quot;.  As of now, this is the only answer to address the issue of &quot;why&quot;.  The other answers really just re-state the question.  So +1."},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":3,"creation_date":1407408590,"post_id":25171089,"comment_id":39207330,"body_markdown":"It might be worth noting that an atomicity guaranty would not solve the visibility issue for updates of non-`volatile` fields. So unless you will treat every field as implicitly `volatile` once one thread has used the `++` operator on it, such an atomicity guaranty would not solve concurrent update issues. So why potentially wasting performance for something if it doesn’t solve the problem.","body":"It might be worth noting that an atomicity guaranty would not solve the visibility issue for updates of non-<code>volatile</code> fields. So unless you will treat every field as implicitly <code>volatile</code> once one thread has used the <code>++</code> operator on it, such an atomicity guaranty would not solve concurrent update issues. So why potentially wasting performance for something if it doesn’t solve the problem."},{"owner":{"account_id":423135,"reputation":3737,"user_id":802335,"accept_rate":81,"display_name":"Dan Hlavenka"},"score":1,"creation_date":1408059199,"post_id":25171089,"comment_id":39467310,"body_markdown":"@DavidWallace don&#39;t you mean `++`? ;)","body":"@DavidWallace don&#39;t you mean <code>++</code>? ;)"}],"tags":[],"owner":{"account_id":1300809,"reputation":56627,"user_id":1250772,"accept_rate":45,"display_name":"Kaz"},"comment_count":4,"down_vote_count":0,"up_vote_count":136,"is_accepted":true,"score":136,"last_activity_date":1422330396,"creation_date":1407362958,"answer_id":25171089,"question_id":25168062,"body_markdown":"`i++` is probably not atomic in Java because atomicity is a special requirement which is not present in the majority of the uses of `i++`. That requirement has a significant overhead: there is a large cost in making an increment operation atomic; it involves synchronization at both the software and hardware levels that need not be present in an ordinary increment.\r\n\r\nYou could make the argument that `i++` should have been designed and documented as specifically performing an atomic increment, so that a non-atomic increment is performed using `i = i + 1`.  However, this would break the &quot;cultural compatibility&quot; between Java, and C and C++. As well, it would take away a convenient notation which programmers familiar with C-like languages take for granted, giving it a special meaning that applies only in limited circumstances.\r\n\r\nBasic C or C++ code like `for (i = 0; i &lt; LIMIT; i++)` would translate into Java as `for (i = 0; i &lt; LIMIT; i = i + 1)`; because it would be inappropriate to use the atomic `i++`. What&#39;s worse, programmers coming from C or other C-like languages to Java would use `i++` anyway, resulting in unnecessary use of atomic instructions.\r\n\r\nEven at the machine instruction set level, an increment type operation is usually not atomic for performance reasons. In x86, a special instruction &quot;lock prefix&quot; must be used to make the `inc` instruction atomic: for the same reasons as above.  If `inc` were always atomic, it would never be used when a non-atomic inc is required; programmers and compilers would generate code that loads, adds 1 and stores, because it would be way faster.\r\n\r\nIn some instruction set architectures, there is no atomic `inc` or perhaps no `inc` at all; to do an atomic inc on MIPS, you have to write a software loop which uses the `ll` and `sc`: load-linked, and store-conditional. Load-linked reads the word, and store-conditional stores the new value if the word has not changed, or else it fails (which is detected and causes a re-try).","title":"Why is i++ not atomic?","body":"<p><code>i++</code> is probably not atomic in Java because atomicity is a special requirement which is not present in the majority of the uses of <code>i++</code>. That requirement has a significant overhead: there is a large cost in making an increment operation atomic; it involves synchronization at both the software and hardware levels that need not be present in an ordinary increment.</p>\n\n<p>You could make the argument that <code>i++</code> should have been designed and documented as specifically performing an atomic increment, so that a non-atomic increment is performed using <code>i = i + 1</code>.  However, this would break the \"cultural compatibility\" between Java, and C and C++. As well, it would take away a convenient notation which programmers familiar with C-like languages take for granted, giving it a special meaning that applies only in limited circumstances.</p>\n\n<p>Basic C or C++ code like <code>for (i = 0; i &lt; LIMIT; i++)</code> would translate into Java as <code>for (i = 0; i &lt; LIMIT; i = i + 1)</code>; because it would be inappropriate to use the atomic <code>i++</code>. What's worse, programmers coming from C or other C-like languages to Java would use <code>i++</code> anyway, resulting in unnecessary use of atomic instructions.</p>\n\n<p>Even at the machine instruction set level, an increment type operation is usually not atomic for performance reasons. In x86, a special instruction \"lock prefix\" must be used to make the <code>inc</code> instruction atomic: for the same reasons as above.  If <code>inc</code> were always atomic, it would never be used when a non-atomic inc is required; programmers and compilers would generate code that loads, adds 1 and stores, because it would be way faster.</p>\n\n<p>In some instruction set architectures, there is no atomic <code>inc</code> or perhaps no <code>inc</code> at all; to do an atomic inc on MIPS, you have to write a software loop which uses the <code>ll</code> and <code>sc</code>: load-linked, and store-conditional. Load-linked reads the word, and store-conditional stores the new value if the word has not changed, or else it fails (which is detected and causes a re-try).</p>\n"},{"comments":[{"owner":{"account_id":28649,"reputation":38698,"user_id":76722,"accept_rate":80,"display_name":"Sebastian Mach"},"score":3,"creation_date":1407423405,"post_id":25178383,"comment_id":39217327,"body_markdown":"This is misleading. You have to separate execution and getting the result, otherwise you couldn&#39;t get values from _any_ atomic operation.","body":"This is misleading. You have to separate execution and getting the result, otherwise you couldn&#39;t get values from <i>any</i> atomic operation."},{"owner":{"account_id":197913,"reputation":840,"user_id":442274,"display_name":"Roy van Rijn"},"score":0,"creation_date":1407437814,"post_id":25178383,"comment_id":39225814,"body_markdown":"No it isn&#39;t, that is why Java&#39;s AtomicInteger has a get(), getAndIncrement(), getAndDecrement(), incrementAndGet(), decrementAndGet() etc.","body":"No it isn&#39;t, that is why Java&#39;s AtomicInteger has a get(), getAndIncrement(), getAndDecrement(), incrementAndGet(), decrementAndGet() etc."},{"owner":{"account_id":28649,"reputation":38698,"user_id":76722,"accept_rate":80,"display_name":"Sebastian Mach"},"score":2,"creation_date":1407442798,"post_id":25178383,"comment_id":39228524,"body_markdown":"And the Java-language could have defined `i++` to be expanded to `i.getAndIncrement()`. Such expanding isn&#39;t new. E.g., lambdas in C++ are expanded to anonymous class definitions in C++.","body":"And the Java-language could have defined <code>i++</code> to be expanded to <code>i.getAndIncrement()</code>. Such expanding isn&#39;t new. E.g., lambdas in C++ are expanded to anonymous class definitions in C++."},{"owner":{"account_id":372293,"reputation":180467,"user_id":721269,"accept_rate":100,"display_name":"David Schwartz"},"score":1,"creation_date":1448360470,"post_id":25178383,"comment_id":55545112,"body_markdown":"Given an atomic `i++` one can trivially create an atomic `++i` or vice-versa. One is equivalent to the other plus one.","body":"Given an atomic <code>i++</code> one can trivially create an atomic <code>++i</code> or vice-versa. One is equivalent to the other plus one."}],"tags":[],"owner":{"account_id":197913,"reputation":840,"user_id":442274,"display_name":"Roy van Rijn"},"comment_count":4,"down_vote_count":2,"up_vote_count":3,"is_accepted":false,"score":1,"last_activity_date":1407402265,"creation_date":1407402265,"answer_id":25178383,"question_id":25168062,"body_markdown":"If the operation `i++` would be atomic you wouldn&#39;t have the chance to read the value from it. This is exactly what you want to do using `i++` (instead of using `++i`).\r\n\r\nFor example look at the following code:\r\n\r\n    public static void main(final String[] args) {\r\n        int i = 0;\r\n        System.out.println(i++);\r\n    }\r\n\r\nIn this case we expect the output to be: `0`\r\n(because we post increment, e.g. first read, then update)\r\n\r\nThis is one of the reasons the operation can&#39;t be atomic, because you need to read the value (and do something with it) and **then** update the value.\r\n\r\nThe other important reason is that doing something atomically *usually* takes more time because of locking. It would be silly to have all the operations on primitives take a little bit longer for the rare cases when people want to have atomic operations. That is why they&#39;ve added [`AtomicInteger`][1] and [other][2] atomic classes to the language.\r\n\r\n\r\n  [1]: http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicInteger.html\r\n  [2]: http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/package-summary.html","title":"Why is i++ not atomic?","body":"<p>If the operation <code>i++</code> would be atomic you wouldn't have the chance to read the value from it. This is exactly what you want to do using <code>i++</code> (instead of using <code>++i</code>).</p>\n\n<p>For example look at the following code:</p>\n\n<pre><code>public static void main(final String[] args) {\n    int i = 0;\n    System.out.println(i++);\n}\n</code></pre>\n\n<p>In this case we expect the output to be: <code>0</code>\n(because we post increment, e.g. first read, then update)</p>\n\n<p>This is one of the reasons the operation can't be atomic, because you need to read the value (and do something with it) and <strong>then</strong> update the value.</p>\n\n<p>The other important reason is that doing something atomically <em>usually</em> takes more time because of locking. It would be silly to have all the operations on primitives take a little bit longer for the rare cases when people want to have atomic operations. That is why they've added <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicInteger.html\" rel=\"nofollow\"><code>AtomicInteger</code></a> and <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/package-summary.html\" rel=\"nofollow\">other</a> atomic classes to the language.</p>\n"},{"comments":[{"owner":{"account_id":28649,"reputation":38698,"user_id":76722,"accept_rate":80,"display_name":"Sebastian Mach"},"score":2,"creation_date":1407423311,"post_id":25181723,"comment_id":39217265,"body_markdown":"Hmm. A language can define any feature as atomic, be it increments or unicorns. You just exemplify a consequence of not being atomic.","body":"Hmm. A language can define any feature as atomic, be it increments or unicorns. You just exemplify a consequence of not being atomic."},{"owner":{"account_id":59764,"reputation":7790,"user_id":178728,"accept_rate":73,"display_name":"stratis"},"score":0,"creation_date":1407424809,"post_id":25181723,"comment_id":39218326,"body_markdown":"@phresnel Exactly. But I also point out that it&#39;s not a single operation which by extension implies that the computational cost for turning multiple such operations into atomic ones is much more expensive which in turn -partially- justifies why `i++` is not atomic.","body":"@phresnel Exactly. But I also point out that it&#39;s not a single operation which by extension implies that the computational cost for turning multiple such operations into atomic ones is much more expensive which in turn -partially- justifies why <code>i++</code> is not atomic."},{"owner":{"account_id":28649,"reputation":38698,"user_id":76722,"accept_rate":80,"display_name":"Sebastian Mach"},"score":2,"creation_date":1407425021,"post_id":25181723,"comment_id":39218470,"body_markdown":"While I get your point, your answer is a bit confusing to the learning. I see an example, and a conclusion that says &quot;because of the situation in the example&quot;; imho this is an incomplete reasoning :(","body":"While I get your point, your answer is a bit confusing to the learning. I see an example, and a conclusion that says &quot;because of the situation in the example&quot;; imho this is an incomplete reasoning :("},{"owner":{"account_id":59764,"reputation":7790,"user_id":178728,"accept_rate":73,"display_name":"stratis"},"score":1,"creation_date":1407425404,"post_id":25181723,"comment_id":39218740,"body_markdown":"@phresnel Maybe not the most pedagogical answer but it&#39;s the best I can currently offer. Hopefully it will help people and not confuse them. Thanks for critisism however. I &#39;ll try to be more precise in my future posts.","body":"@phresnel Maybe not the most pedagogical answer but it&#39;s the best I can currently offer. Hopefully it will help people and not confuse them. Thanks for critisism however. I &#39;ll try to be more precise in my future posts."}],"tags":[],"owner":{"account_id":59764,"reputation":7790,"user_id":178728,"accept_rate":73,"display_name":"stratis"},"comment_count":4,"down_vote_count":1,"up_vote_count":6,"is_accepted":false,"score":5,"last_activity_date":1575395380,"creation_date":1407412069,"answer_id":25181723,"question_id":25168062,"body_markdown":"`i++` is a statement which simply involves 3 operations:\r\n\r\n 1. Read current value\r\n 2. Write new value\r\n 3. Store new value\r\n\r\nThese three operations are not meant to be executed in a single step or in other words `i++` is not a  **compound** operation. As a result all sorts of things can go wrong when more than one threads are involved in a single but non-compound operation.\r\n\r\nConsider the following scenario:\r\n\r\n**Time 1**:\r\n\r\n    Thread A fetches i\r\n    Thread B fetches i\r\n\r\n**Time 2**:\r\n \r\n    Thread A overwrites i with a new value say -foo-\r\n    Thread B overwrites i with a new value say -bar-\r\n    Thread B stores -bar- in i\r\n    \r\n    // At this time thread B seems to be more &#39;active&#39;. Not only does it overwrite \r\n    // its local copy of i but also makes it in time to store -bar- back to \r\n    // &#39;main&#39; memory (i)\r\n\r\n**Time 3**:\r\n\r\n    Thread A attempts to store -foo- in memory effectively overwriting the -bar- \r\n    value (in i) which was just stored by thread B in Time 2.\r\n\r\n    Thread B has nothing to do here. Its work was done by Time 2. However it was \r\n    all for nothing as -bar- was eventually overwritten by another thread.\r\n\r\nAnd there you have it. A race condition.\r\n\r\n---------\r\n\r\nThat&#39;s why `i++` is not atomic. If it was, none of this would have happened and each `fetch-update-store` would happen atomically. That&#39;s exactly what `AtomicInteger` is for and in your case it would probably fit right in.\r\n\r\nP.S.\r\n \r\nAn excellent book covering all of those issues and then some is this:\r\n[Java Concurrency in Practice][1]\r\n\r\n\r\n  [1]: http://www.amazon.com/Java-Concurrency-Practice-Brian-Goetz/dp/0321349601/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1407412830&amp;sr=1-1&amp;keywords=java%20concurrency%20in%20practice","title":"Why is i++ not atomic?","body":"<p><code>i++</code> is a statement which simply involves 3 operations:</p>\n\n<ol>\n<li>Read current value</li>\n<li>Write new value</li>\n<li>Store new value</li>\n</ol>\n\n<p>These three operations are not meant to be executed in a single step or in other words <code>i++</code> is not a  <strong>compound</strong> operation. As a result all sorts of things can go wrong when more than one threads are involved in a single but non-compound operation.</p>\n\n<p>Consider the following scenario:</p>\n\n<p><strong>Time 1</strong>:</p>\n\n<pre><code>Thread A fetches i\nThread B fetches i\n</code></pre>\n\n<p><strong>Time 2</strong>:</p>\n\n<pre><code>Thread A overwrites i with a new value say -foo-\nThread B overwrites i with a new value say -bar-\nThread B stores -bar- in i\n\n// At this time thread B seems to be more 'active'. Not only does it overwrite \n// its local copy of i but also makes it in time to store -bar- back to \n// 'main' memory (i)\n</code></pre>\n\n<p><strong>Time 3</strong>:</p>\n\n<pre><code>Thread A attempts to store -foo- in memory effectively overwriting the -bar- \nvalue (in i) which was just stored by thread B in Time 2.\n\nThread B has nothing to do here. Its work was done by Time 2. However it was \nall for nothing as -bar- was eventually overwritten by another thread.\n</code></pre>\n\n<p>And there you have it. A race condition.</p>\n\n<hr>\n\n<p>That's why <code>i++</code> is not atomic. If it was, none of this would have happened and each <code>fetch-update-store</code> would happen atomically. That's exactly what <code>AtomicInteger</code> is for and in your case it would probably fit right in.</p>\n\n<p>P.S.</p>\n\n<p>An excellent book covering all of those issues and then some is this:\n<a href=\"https://rads.stackoverflow.com/amzn/click/com/0321349601\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Java Concurrency in Practice</a></p>\n"},{"tags":[],"owner":{"account_id":4611618,"reputation":843,"user_id":3739539,"display_name":"yanghaogn"},"comment_count":0,"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1451034197,"creation_date":1407895313,"answer_id":25276937,"question_id":25168062,"body_markdown":"There are two steps:\r\n\r\n 1. fetch i from memory\r\n 2. set i+1 to i\r\n\r\nso it&#39;s not atomic operation.\r\nWhen thread1 executes i++, and thread2 executes i++, the final value of i may be i+1.","title":"Why is i++ not atomic?","body":"<p>There are two steps:</p>\n\n<ol>\n<li>fetch i from memory</li>\n<li>set i+1 to i</li>\n</ol>\n\n<p>so it's not atomic operation.\nWhen thread1 executes i++, and thread2 executes i++, the final value of i may be i+1.</p>\n"},{"comments":[{"owner":{"account_id":238697,"reputation":1454,"user_id":507761,"accept_rate":100,"display_name":"Matthew Read"},"score":0,"creation_date":1644017317,"post_id":66290441,"comment_id":125502412,"body_markdown":"That is _how_ it is non-atomic, not _why_, as so many of the other answers and comments have covered.","body":"That is <i>how</i> it is non-atomic, not <i>why</i>, as so many of the other answers and comments have covered."}],"tags":[],"owner":{"account_id":11389245,"reputation":92,"user_id":8349909,"display_name":"Abdallah AbuSalah"},"comment_count":1,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1613816542,"creation_date":1613816542,"answer_id":66290441,"question_id":25168062,"body_markdown":"In JVM or any VM, the `i++` is equivalent to the following: \r\n\r\n    int temp = i;     // 1. read\r\n    i = temp + 1;    // 2. increment the value then 3. write it back\r\n\r\nthat is why i++ is non-atomic.","title":"Why is i++ not atomic?","body":"<p>In JVM or any VM, the <code>i++</code> is equivalent to the following:</p>\n<pre><code>int temp = i;     // 1. read\ni = temp + 1;    // 2. increment the value then 3. write it back\n</code></pre>\n<p>that is why i++ is non-atomic.</p>\n"},{"tags":[],"owner":{"account_id":4681862,"reputation":4855,"user_id":3790360,"accept_rate":57,"display_name":"Andie2302"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1684847572,"creation_date":1684847572,"answer_id":76315195,"question_id":25168062,"body_markdown":"In Java, the i++ operation is not atomic because it is actually a combination of multiple steps that can be interrupted by other threads. The i++ operation consists of three distinct steps: reading the current value of i, incrementing the value by 1, and storing the updated value back into i. Each of these steps is a separate operation and can be interleaved with operations from other threads, leading to potential race conditions.\r\n\r\nA race condition occurs when multiple threads access a shared resource concurrently, and the result of the operation depends on the specific order of execution. In the case of i++, if two or more threads attempt to increment i at the same time, they may read the same initial value of i, increment it separately, and then store their individual results back into i. This can lead to lost updates, where one or more increments are overwritten, resulting in an incorrect final value of i.\r\n\r\nTo ensure atomicity and avoid race conditions, Java provides the AtomicInteger class, which encapsulates an integer value and provides atomic operations on that value. Instead of using int i, you can use AtomicInteger i and perform atomic increments using the incrementAndGet() method. This method guarantees that the increment operation is performed atomically and eliminates the possibility of race conditions.\r\n\r\nHere&#39;s an example that demonstrates the atomic increment using AtomicInteger:\r\n\r\n\r\n    import java.util.concurrent.ExecutorService;\r\n    import java.util.concurrent.Executors;\r\n    import java.util.concurrent.atomic.AtomicInteger;\r\n    import java.util.logging.Level;\r\n    import java.util.logging.Logger;\r\n    \r\n    public class Test {\r\n    \r\n        private static AtomicInteger total = new AtomicInteger(0);\r\n        private static AtomicInteger countT1 = new AtomicInteger(0);\r\n        private static AtomicInteger countT2 = new AtomicInteger(0);\r\n        private boolean run = true;\r\n    \r\n        public Test() {\r\n            ExecutorService newCachedThreadPool = Executors.newCachedThreadPool();\r\n            newCachedThreadPool.execute(t1);\r\n            newCachedThreadPool.execute(t2);\r\n            try {\r\n                Thread.sleep(1000);\r\n            } catch (InterruptedException ex) {\r\n                Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\r\n            }\r\n            run = false;\r\n            try {\r\n                Thread.sleep(1000);\r\n            } catch (InterruptedException ex) {\r\n                Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\r\n            }\r\n            System.out.println((countT1.get() + countT2.get() + &quot; == &quot; + total.get()));\r\n        }\r\n    \r\n        private Runnable t1 = new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                while (run) {\r\n                    total.incrementAndGet();\r\n                    countT1.incrementAndGet();\r\n                    System.out.println(&quot;Hello #&quot; + countT1.get() + &quot; from Thread 1! Total hello: &quot; + total.get());\r\n                }\r\n            }\r\n        };\r\n    \r\n        private Runnable t2 = new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                while (run) {\r\n                    total.incrementAndGet();\r\n                    countT2.incrementAndGet();\r\n                    System.out.println(&quot;Hello #&quot; + countT2.get() + &quot; from Thread 2! Total hello: &quot; + total.get());\r\n                }\r\n            }\r\n        };\r\n    \r\n        public static void main(String[] args) {\r\n            new Test();\r\n        }\r\n    }\r\n\r\n","title":"Why is i++ not atomic?","body":"<p>In Java, the i++ operation is not atomic because it is actually a combination of multiple steps that can be interrupted by other threads. The i++ operation consists of three distinct steps: reading the current value of i, incrementing the value by 1, and storing the updated value back into i. Each of these steps is a separate operation and can be interleaved with operations from other threads, leading to potential race conditions.</p>\n<p>A race condition occurs when multiple threads access a shared resource concurrently, and the result of the operation depends on the specific order of execution. In the case of i++, if two or more threads attempt to increment i at the same time, they may read the same initial value of i, increment it separately, and then store their individual results back into i. This can lead to lost updates, where one or more increments are overwritten, resulting in an incorrect final value of i.</p>\n<p>To ensure atomicity and avoid race conditions, Java provides the AtomicInteger class, which encapsulates an integer value and provides atomic operations on that value. Instead of using int i, you can use AtomicInteger i and perform atomic increments using the incrementAndGet() method. This method guarantees that the increment operation is performed atomically and eliminates the possibility of race conditions.</p>\n<p>Here's an example that demonstrates the atomic increment using AtomicInteger:</p>\n<pre><code>import java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.atomic.AtomicInteger;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\n\npublic class Test {\n\n    private static AtomicInteger total = new AtomicInteger(0);\n    private static AtomicInteger countT1 = new AtomicInteger(0);\n    private static AtomicInteger countT2 = new AtomicInteger(0);\n    private boolean run = true;\n\n    public Test() {\n        ExecutorService newCachedThreadPool = Executors.newCachedThreadPool();\n        newCachedThreadPool.execute(t1);\n        newCachedThreadPool.execute(t2);\n        try {\n            Thread.sleep(1000);\n        } catch (InterruptedException ex) {\n            Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\n        }\n        run = false;\n        try {\n            Thread.sleep(1000);\n        } catch (InterruptedException ex) {\n            Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\n        }\n        System.out.println((countT1.get() + countT2.get() + &quot; == &quot; + total.get()));\n    }\n\n    private Runnable t1 = new Runnable() {\n        @Override\n        public void run() {\n            while (run) {\n                total.incrementAndGet();\n                countT1.incrementAndGet();\n                System.out.println(&quot;Hello #&quot; + countT1.get() + &quot; from Thread 1! Total hello: &quot; + total.get());\n            }\n        }\n    };\n\n    private Runnable t2 = new Runnable() {\n        @Override\n        public void run() {\n            while (run) {\n                total.incrementAndGet();\n                countT2.incrementAndGet();\n                System.out.println(&quot;Hello #&quot; + countT2.get() + &quot; from Thread 2! Total hello: &quot; + total.get());\n            }\n        }\n    };\n\n    public static void main(String[] args) {\n        new Test();\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":4681862,"reputation":4855,"user_id":3790360,"accept_rate":57,"display_name":"Andie2302"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":30327,"favorite_count":0,"down_vote_count":2,"up_vote_count":110,"accepted_answer_id":25171089,"answer_count":11,"score":108,"last_activity_date":1684847572,"creation_date":1407351321,"question_id":25168062,"body_markdown":"Why is `i++` not atomic in Java?\r\n\r\nTo get a bit deeper in Java I tried to count how often the loop in threads are executed.\r\n\r\nSo I used a\r\n\r\n    private static int total = 0;\r\n\r\nin the main class.\r\n\r\nI have two threads.\r\n\r\n - Thread 1: Prints `System.out.println(&quot;Hello from Thread 1!&quot;);`\r\n - Thread 2: Prints `System.out.println(&quot;Hello from Thread 2!&quot;);`\r\n\r\nAnd I count the lines printed by thread 1 and thread 2. But the lines of thread 1 + lines of thread 2 don&#39;t match the total number of lines printed out.\r\n\r\nHere is my code:\r\n\r\n    import java.util.concurrent.ExecutorService;\r\n    import java.util.concurrent.Executors;\r\n    import java.util.logging.Level;\r\n    import java.util.logging.Logger;\r\n\r\n    public class Test {\r\n\r\n        private static int total = 0;\r\n        private static int countT1 = 0;\r\n        private static int countT2 = 0;\r\n        private boolean run = true;\r\n\r\n        public Test() {\r\n            ExecutorService newCachedThreadPool = Executors.newCachedThreadPool();\r\n            newCachedThreadPool.execute(t1);\r\n            newCachedThreadPool.execute(t2);\r\n            try {\r\n                Thread.sleep(1000);\r\n            }\r\n            catch (InterruptedException ex) {\r\n                Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\r\n            }\r\n            run = false;\r\n            try {\r\n                Thread.sleep(1000);\r\n            }\r\n            catch (InterruptedException ex) {\r\n                Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\r\n            }\r\n            System.out.println((countT1 + countT2 + &quot; == &quot; + total));\r\n        }\r\n\r\n        private Runnable t1 = new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                while (run) {\r\n                    total++;\r\n                    countT1++;\r\n                    System.out.println(&quot;Hello #&quot; + countT1 + &quot; from Thread 1! Total hello: &quot; + total);\r\n                }\r\n            }\r\n        };\r\n\r\n        private Runnable t2 = new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                while (run) {\r\n                    total++;\r\n                    countT2++;\r\n                    System.out.println(&quot;Hello #&quot; + countT2 + &quot; from Thread 2! Total hello: &quot; + total);\r\n                }\r\n            }\r\n        };\r\n\r\n        public static void main(String[] args) {\r\n            new Test();\r\n        }\r\n    }","title":"Why is i++ not atomic?","body":"<p>Why is <code>i++</code> not atomic in Java?</p>\n<p>To get a bit deeper in Java I tried to count how often the loop in threads are executed.</p>\n<p>So I used a</p>\n<pre><code>private static int total = 0;\n</code></pre>\n<p>in the main class.</p>\n<p>I have two threads.</p>\n<ul>\n<li>Thread 1: Prints <code>System.out.println(&quot;Hello from Thread 1!&quot;);</code></li>\n<li>Thread 2: Prints <code>System.out.println(&quot;Hello from Thread 2!&quot;);</code></li>\n</ul>\n<p>And I count the lines printed by thread 1 and thread 2. But the lines of thread 1 + lines of thread 2 don't match the total number of lines printed out.</p>\n<p>Here is my code:</p>\n<pre><code>import java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\n\npublic class Test {\n\n    private static int total = 0;\n    private static int countT1 = 0;\n    private static int countT2 = 0;\n    private boolean run = true;\n\n    public Test() {\n        ExecutorService newCachedThreadPool = Executors.newCachedThreadPool();\n        newCachedThreadPool.execute(t1);\n        newCachedThreadPool.execute(t2);\n        try {\n            Thread.sleep(1000);\n        }\n        catch (InterruptedException ex) {\n            Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\n        }\n        run = false;\n        try {\n            Thread.sleep(1000);\n        }\n        catch (InterruptedException ex) {\n            Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\n        }\n        System.out.println((countT1 + countT2 + &quot; == &quot; + total));\n    }\n\n    private Runnable t1 = new Runnable() {\n        @Override\n        public void run() {\n            while (run) {\n                total++;\n                countT1++;\n                System.out.println(&quot;Hello #&quot; + countT1 + &quot; from Thread 1! Total hello: &quot; + total);\n            }\n        }\n    };\n\n    private Runnable t2 = new Runnable() {\n        @Override\n        public void run() {\n            while (run) {\n                total++;\n                countT2++;\n                System.out.println(&quot;Hello #&quot; + countT2 + &quot; from Thread 2! Total hello: &quot; + total);\n            }\n        }\n    };\n\n    public static void main(String[] args) {\n        new Test();\n    }\n}\n</code></pre>\n"},{"tags":["java","spring-boot","authentication","x509certificate","resttemplate"],"owner":{"account_id":28662128,"reputation":1,"user_id":21946850,"display_name":"Tech Savy"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":338,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684847024,"creation_date":1684842061,"question_id":76314355,"body_markdown":"I am pretty new to authenticating web services using Java. \r\n\r\nI have started working on a task wherein I am supposed to upload a document to a server using POST request. I did that task.\r\n\r\nAnother requirement is to use x.509 certificate for authentication as a client **(not server)**. This is where I am getting a bit confused.\r\n\r\nI did some research on google. Here is what I could found\r\n\r\n1. https://www.geeksforgeeks.org/x-509-authentication-service/\r\n2. https://stackoverflow.com/questions/11477011/where-do-i-get-an-x509-certificate-from\r\n3. https://stackoverflow.com/questions/45713593/what-is-the-right-way-to-send-a-client-certificate-with-every-request-made-by-th\r\n\r\n\r\nI Found multiple things but could **not** link these together. So coming here to link the dots. Here&#39;s what I could gather\r\n\r\n1. x.509 certificates is used to authenticate the client itself\r\n2. It contains key value pairs such as public key information, subject name, issuer name\r\n3. There is JKS file(.jks) file which also contains some public and private key information\r\n\r\n\r\nHere are my questions:\r\n\r\n1. How x.509 certificate and JKS file are related?\r\n2. Is it mandatory to have jks file for x509 authentication?\r\n3. How public and private keys are stored as far as x509 authentication is concerned?\r\n4. Where do I get x509 certificates? If I can generate, do I need to generate two of them - one having public key and the other having private key\r\n5. Once I have the certificates, where should I store the certificates for a real world application?\r\n5. Can someone share some code or point me to some code which can be a sample program explaining the concepts?\r\n\r\nBasically the working of x509 authentication\r\n\r\n1. https://www.geeksforgeeks.org/x-509-authentication-service/\r\n2. https://stackoverflow.com/questions/11477011/where-do-i-get-an-x509-certificate-from\r\n3. https://stackoverflow.com/questions/45713593/what-is-the-right-way-to-send-a-client-certificate-with-every-request-made-by-th","title":"POST request authentication in Java using x.509 certificates","body":"<p>I am pretty new to authenticating web services using Java.</p>\n<p>I have started working on a task wherein I am supposed to upload a document to a server using POST request. I did that task.</p>\n<p>Another requirement is to use x.509 certificate for authentication as a client <strong>(not server)</strong>. This is where I am getting a bit confused.</p>\n<p>I did some research on google. Here is what I could found</p>\n<ol>\n<li><a href=\"https://www.geeksforgeeks.org/x-509-authentication-service/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/x-509-authentication-service/</a></li>\n<li><a href=\"https://stackoverflow.com/questions/11477011/where-do-i-get-an-x509-certificate-from\">Where do I get an x509 certificate from?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/45713593/what-is-the-right-way-to-send-a-client-certificate-with-every-request-made-by-th\">What is the right way to send a client certificate with every request made by the resttemplate in spring?</a></li>\n</ol>\n<p>I Found multiple things but could <strong>not</strong> link these together. So coming here to link the dots. Here's what I could gather</p>\n<ol>\n<li>x.509 certificates is used to authenticate the client itself</li>\n<li>It contains key value pairs such as public key information, subject name, issuer name</li>\n<li>There is JKS file(.jks) file which also contains some public and private key information</li>\n</ol>\n<p>Here are my questions:</p>\n<ol>\n<li>How x.509 certificate and JKS file are related?</li>\n<li>Is it mandatory to have jks file for x509 authentication?</li>\n<li>How public and private keys are stored as far as x509 authentication is concerned?</li>\n<li>Where do I get x509 certificates? If I can generate, do I need to generate two of them - one having public key and the other having private key</li>\n<li>Once I have the certificates, where should I store the certificates for a real world application?</li>\n<li>Can someone share some code or point me to some code which can be a sample program explaining the concepts?</li>\n</ol>\n<p>Basically the working of x509 authentication</p>\n<ol>\n<li><a href=\"https://www.geeksforgeeks.org/x-509-authentication-service/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/x-509-authentication-service/</a></li>\n<li><a href=\"https://stackoverflow.com/questions/11477011/where-do-i-get-an-x509-certificate-from\">Where do I get an x509 certificate from?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/45713593/what-is-the-right-way-to-send-a-client-certificate-with-every-request-made-by-th\">What is the right way to send a client certificate with every request made by the resttemplate in spring?</a></li>\n</ol>\n"},{"tags":["java","exception","lucene"],"comments":[{"owner":{"account_id":5785597,"reputation":9456,"user_id":4564945,"display_name":"Necreaux"},"score":1,"creation_date":1425065437,"post_id":28772059,"comment_id":45824082,"body_markdown":"Where is this happening? Stack traces? Sample code?","body":"Where is this happening? Stack traces? Sample code?"}],"owner":{"account_id":130113,"reputation":2679,"user_id":329130,"display_name":"b-h-"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":226,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":0,"score":3,"last_activity_date":1684846647,"creation_date":1425062492,"question_id":28772059,"body_markdown":"Has anyone encountered this issue?\r\n\r\n```java.io.IOException: null: NIOFSIndexInput```\r\n\r\nIt is happening intermittently for me and despite the suggestion that it might be a corrupted index, the index checks out with no problems.","title":"IOException error in Lucene","body":"<p>Has anyone encountered this issue?</p>\n\n<p><code>java.io.IOException: null: NIOFSIndexInput</code></p>\n\n<p>It is happening intermittently for me and despite the suggestion that it might be a corrupted index, the index checks out with no problems.</p>\n"},{"tags":["java","postgresql","spring-boot","api"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1684822543,"post_id":76311717,"comment_id":134568866,"body_markdown":"You need to include the quote in the column name something like `name=&quot;&#39;\\&quot;alId\\&quot;&#39;&quot;` as you probably need to quote the name as well. Or `name=&quot;\\&quot;alId\\&quot;` and add `spring.jpa.properties.hibernate.globally_quoted_identifiers=true` to the `application.properties`.","body":"You need to include the quote in the column name something like <code>name=&quot;&#39;\\&quot;alId\\&quot;&#39;&quot;</code> as you probably need to quote the name as well. Or <code>name=&quot;\\&quot;alId\\&quot;</code> and add <code>spring.jpa.properties.hibernate.globally_quoted_identifiers=&zwnj;&#8203;true</code> to the <code>application.properties</code>."},{"owner":{"account_id":19369993,"reputation":1,"user_id":14163490,"display_name":"falah"},"score":0,"creation_date":1684835165,"post_id":76311717,"comment_id":134571675,"body_markdown":"I have tried to write name=&quot;\\&quot;alId\\&quot;&quot; before but it didn&#39;t work. I also already try to put back  &#39;name&#39; again together with the property you suggest to application.properties but still doesn&#39;t make any difference.","body":"I have tried to write name=&quot;\\&quot;alId\\&quot;&quot; before but it didn&#39;t work. I also already try to put back  &#39;name&#39; again together with the property you suggest to application.properties but still doesn&#39;t make any difference."},{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1684842213,"post_id":76311717,"comment_id":134573299,"body_markdown":"You should use `&quot;\\&quot;alId\\&quot;&quot;` with the property else include it in backticks (not single quotes) in the name (cannot do that here because that will quote it in the comments.","body":"You should use <code>&quot;\\&quot;alId\\&quot;&quot;</code> with the property else include it in backticks (not single quotes) in the name (cannot do that here because that will quote it in the comments."},{"owner":{"account_id":19369993,"reputation":1,"user_id":14163490,"display_name":"falah"},"score":0,"creation_date":1684846466,"post_id":76311717,"comment_id":134574343,"body_markdown":"Ya, i have tried all of these `name=&quot;\\&quot;alId\\&quot;&quot;` for `alID`, `name=&quot;\\&quot;alName\\&quot;&quot;` for `alName`, and `name=&quot;\\&quot;alPoints\\&quot;&quot;` for `alPoints`. I even use your suggestion to use this `spring.jpa.properties.hibernate.globally_quoted_identifiers=true` in `application.properties` but still does not work.  Is there anything that I miss?","body":"Ya, i have tried all of these <code>name=&quot;\\&quot;alId\\&quot;&quot;</code> for <code>alID</code>, <code>name=&quot;\\&quot;alName\\&quot;&quot;</code> for <code>alName</code>, and <code>name=&quot;\\&quot;alPoints\\&quot;&quot;</code> for <code>alPoints</code>. I even use your suggestion to use this <code>spring.jpa.properties.hibernate.globally_quoted_identifiers=&zwnj;&#8203;true</code> in <code>application.properties</code> but still does not work.  Is there anything that I miss?"},{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1684848459,"post_id":76311717,"comment_id":134574887,"body_markdown":"Try including backticks `\\`` in the column names next to the quotes.","body":"Try including backticks <code>`</code> in the column names next to the quotes."},{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1684850232,"post_id":76311717,"comment_id":134575318,"body_markdown":"Then I&#39;m out of ideas. Adding the quotes and quoting it as an identifier should make it work.","body":"Then I&#39;m out of ideas. Adding the quotes and quoting it as an identifier should make it work."},{"owner":{"account_id":19369993,"reputation":1,"user_id":14163490,"display_name":"falah"},"score":0,"creation_date":1684850489,"post_id":76311717,"comment_id":134575390,"body_markdown":"Done that. Get this error instead `org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;entityManagerFactory&#39; defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: Identifier text should not contain quote markers (` or &quot;)`","body":"Done that. Get this error instead <code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;entityManagerFactory&#39; defined in class path resource [org&#47;springframework&#47;boot&#47;autoconfigure&#47;orm&#47;jpa&#47;HibernateJpa&zwnj;&#8203;Configuration.class]&zwnj;&#8203;: Identifier text should not contain quote markers (</code> or &quot;)`"},{"owner":{"account_id":19369993,"reputation":1,"user_id":14163490,"display_name":"falah"},"score":0,"creation_date":1684850578,"post_id":76311717,"comment_id":134575412,"body_markdown":"well, thanks anyway","body":"well, thanks anyway"}],"owner":{"account_id":19369993,"reputation":1,"user_id":14163490,"display_name":"falah"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":167,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684846076,"creation_date":1684822313,"question_id":76311717,"body_markdown":"I was trying to create an API but Java Spring Boot can not read postgresql table column&#39;s name with sign double quotes on it. It throws error &#39;SQLState: 42703&#39; and &#39;ERROR: Column a1_0.xx does not exist&#39;. In Postman it threw &#39;500 Internal Server Error&#39;\r\n\r\nSo, the case is I was trying to create an API with Java Spring Boot.\r\n\r\nI have two tables. Both was created with postgresql. Both also has a structure like this:\r\n```\r\n------------+-------------------+----------+\r\nalId        | alName            | alPoints |\r\n[PK] bigint | character varying | bigint   |\r\n------------+-------------------+----------+\r\n101         | Name 1            | 70       |\r\n102         | Name 2            | 80       |\r\n103         | Name 3            | 90       |\r\n------------+-------------------+----------+\r\n```\r\nFirst table&#39;s name is &#39;alien_rest&#39;.  Second table&#39;s name is &#39;alien_rest3&#39;. I created the second one to check what is wrong with first one.\r\n\r\nBecause whenever I try to execute &#39;select * from public.alien_rest&#39; for first table through method &#39;.findAll()&#39;, it threw errors like below. What confuse me, somehow everything works fine when I execute &#39;select * from public.alien_rest3&#39; for second table.\r\n\r\nWhile in Postman, it threw error message &#39;500 Internal Server Error&#39;\r\n```\r\n2023-05-23T12:02:31.301+07:00[0;39m [33m WARN[0;39m [35m7520[0;39m [2m---[0;39m [2m[nio-8080-exec-2][0;39m [36mo.h.engine.jdbc.spi.SqlExceptionHelper  [0;39m [2m:[0;39m SQL Error: 0, SQLState: 42703\r\n[2m2023-05-23T12:02:31.302+07:00[0;39m [31mERROR[0;39m [35m7520[0;39m [2m---[0;39m [2m[nio-8080-exec-2][0;39m [36mo.h.engine.jdbc.spi.SqlExceptionHelper  [0;39m [2m:[0;39m ERROR: column a1_0.al_id does not exist\r\n  Hint: Perhaps you meant to reference the column &quot;a1_0.alId&quot;.\r\n  Position: 8\r\n[2m2023-05-23T12:02:31.323+07:00[0;39m [31mERROR[0;39m [35m7520[0;39m [2m---[0;39m [2m[nio-8080-exec-2][0;39m [36mo.a.c.c.C.[.[.[/].[dispatcherServlet]   [0;39m [2m:[0;39m Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select a1_0.al_id,a1_0.al_name,a1_0.al_points from alien_rest a1_0] [ERROR: column a1_0.al_id does not exist\r\n  Hint: Perhaps you meant to reference the column &quot;a1_0.alId&quot;.\r\n  Position: 8] [n/a]; SQL [n/a]] with root cause\r\n```\r\n\r\nI check through pgAdmin (mine is pgAdmin 4 version 7.1), turn out there is a difference with format of both column&#39;s name. &#39;alien_rest&#39; use sign &quot;&quot; for its columns&#39;name while alien_rest3 does not use sign &quot;&quot; for its columns&#39;name.\r\n\r\nFor first table or &#39;alien_rest&#39;, it has format like this:\r\n```\r\nCREATE TABLE IF NOT EXISTS public.alien_rest\r\n(\r\n    &quot;alId&quot; bigint NOT NULL,\r\n    &quot;alName&quot; character varying(20) COLLATE pg_catalog.&quot;default&quot;,\r\n    &quot;alPoints&quot; bigint,\r\n    CONSTRAINT alien_rest_pkey PRIMARY KEY (&quot;alId&quot;)\r\n)\r\n\r\nTABLESPACE pg_default;\r\n```\r\n\r\nwhile for the second table or &#39;alien_rest3&#39;, is has format like this:\r\n```\r\nCREATE TABLE IF NOT EXISTS public.alien_rest3\r\n(\r\n    alid bigint NOT NULL,\r\n    alname character varying COLLATE pg_catalog.&quot;default&quot;,\r\n    alpoints bigint,\r\n    CONSTRAINT alien_rest3_pkey PRIMARY KEY (alid)\r\n)\r\n\r\nTABLESPACE pg_default;\r\n```\r\n\r\nI am not sure what I did that cause table &#39;alien_rest&#39; use sign double quotes for its column&#39;s name.\r\n\r\nIt seems like the sign double quotes (or &quot;&quot;) in the column&#39;s name is the one who give problem to the Spring Boot to read the first table or &#39;alien_rest&#39;.\r\n\r\nSo, what is going on here? What can I do to fix the problem. Thank you for any help ;)\r\n\r\nTo make things clear, here is my codes in my Spring Boot project:\r\n\r\nAlienResource.java\r\n```\r\npackage com.kastamer;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.bind.annotation.GetMapping;\r\nimport org.springframework.web.bind.annotation.RequestMapping;\r\nimport org.springframework.web.bind.annotation.RestController;\r\n\r\n@RestController //DEFINE that THIS CLASS is TECHNICALLY now A CONTROLLER FOR the APP &#39;SpringBootRest&#39;\r\npublic class AlienResource {\r\n\r\n\t@Autowired\r\n\tAlienRepositoryDAO ard;\r\n\t\r\n\t@GetMapping(&quot;aliens&quot;)\r\n\tpublic List&lt;Alien&gt; getAliens() {\r\n\t\t\r\n\t\tList&lt;Alien&gt; aliens = (List&lt;Alien&gt;) ard.findAll();\r\n\t\treturn aliens;\r\n\t}\r\n}\r\n```\r\n\r\nAlien.java\r\n\r\n```\r\npackage com.kastamer;\r\n\r\nimport jakarta.persistence.Column;\r\nimport jakarta.persistence.Entity;\r\nimport jakarta.persistence.EntityResult;\r\nimport jakarta.persistence.FieldResult;\r\nimport jakarta.persistence.Id;\r\nimport jakarta.persistence.SqlResultSetMapping;\r\nimport jakarta.persistence.Table;\r\n\r\n@Entity\r\n@Table(name = &quot;alien_rest&quot;)//, schema = &quot;public&quot;) //THIS is NOT WORKING with/without &#39;schema&#39; for TABLE alien_rest\r\n/* --&gt; THIS is NOT WORKING for TABLE alien_rest\r\n@SqlResultSetMapping(name = &quot;AlienMapping&quot;, entities = @EntityResult(entityClass = Alien.class, \r\n\t\tfields = {\r\n\t\t\t\t@FieldResult(name = &quot;alId&quot;, column = &quot;alId&quot;),\r\n\t\t\t\t@FieldResult(name = &quot;alName&quot;, column = &quot;alName&quot;),\r\n\t\t\t\t@FieldResult(name = &quot;alPoints&quot;, column = &quot;alPoints&quot;)\r\n\t\t})) */\r\npublic class Alien {\r\n\r\n\t@Id\r\n\t//Column(name = &quot;\\&quot;alId\\&quot;&quot;) --&gt; PUT SIGN &#39;\\&quot;&#39; to VALUE does NOT HELP ANY\r\n    @Column(name = &quot;alId&quot;) //THIS is NOT WORKING for TABLE alien_rest\r\n\tprivate int alId;\r\n\t//Column(name &quot;\\&quot;alName\\&quot;&quot;) --&gt; PUT SIGN &#39;\\&quot;&#39; to VALUE does NOT HELP ANY\r\n\t@Column(name = &quot;alName&quot;) //THIS is NOT WORKING for TABLE alien_rest\r\n\tprivate String alName;\r\n   \t//Column(name &quot;\\&quot;alPoints\\&quot;&quot;) --&gt; PUT SIGN &#39;\\&quot;&#39; to VALUE does NOT HELP ANY\r\n\t@Column(name = &quot;alPoints&quot;) //THIS is NOT WORKING for TABLE alien_rest\r\n\tprivate int alPoints;\r\n\t\r\n\tpublic int getAlId() {\r\n\t\treturn alId;\r\n\t}\r\n\tpublic void setAlId(int alId) {\r\n\t\tthis.alId = alId;\r\n\t}\r\n\tpublic String getAlName() {\r\n\t\treturn alName;\r\n\t}\r\n\tpublic void setAlName(String alName) {\r\n\t\tthis.alName = alName;\r\n\t}\r\n\tpublic int getAlPoints() {\r\n\t\treturn alPoints;\r\n\t}\r\n\tpublic void setAlPoints(int alPoints) {\r\n\t\tthis.alPoints = alPoints;\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic String toString() {\r\n\t\treturn &quot;Alien [alName=&quot; + alName + &quot;, alPoints=&quot; + alPoints + &quot;, alId=&quot; + alId + &quot;]&quot;;\r\n\t}\t\r\n}\r\n\r\n```\r\n\r\nAlienRepositoryDAO.java\r\n\r\n```\r\npackage com.kastamer;\r\n\r\nimport java.util.List;\r\n\r\nimport org.springframework.data.jpa.repository.JpaRepository;\r\nimport org.springframework.data.jpa.repository.Query;\r\nimport org.springframework.data.repository.CrudRepository;\r\n\r\npublic interface AlienRepositoryDAO extends CrudRepository&lt;Alien, Integer&gt;{\r\n\r\n}\r\n```\r\n\r\npom.xml\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n\txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\t&lt;parent&gt;\r\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;3.1.0&lt;/version&gt;\r\n\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n\t&lt;/parent&gt;\r\n\t&lt;groupId&gt;com.kastamer&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;SpringBootRest&lt;/artifactId&gt;\r\n\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n\t&lt;name&gt;SpringBootRest&lt;/name&gt;\r\n\t&lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\r\n\t&lt;properties&gt;\r\n\t\t&lt;java.version&gt;17&lt;/java.version&gt;\r\n\t&lt;/properties&gt;\r\n\t&lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t\r\n\t\t&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-jpa --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\r\n\t\t    &lt;version&gt;3.1.0&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t\r\n\t\t&lt;!-- https://mvnrepository.com/artifact/org.postgresql/postgresql --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t    &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\r\n\t\t    &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\r\n\t\t    &lt;version&gt;42.6.0&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t&lt;/dependencies&gt;\r\n\r\n\t&lt;build&gt;\r\n\t\t&lt;plugins&gt;\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\t\t&lt;/plugins&gt;\r\n\t&lt;/build&gt;\r\n\r\n&lt;/project&gt;\r\n\r\n```\r\n","title":"Trying to create an API but Java Spring Boot can not read postgresql table column&#39;s name with sign double quotes on it. Error SQLState: 42703","body":"<p>I was trying to create an API but Java Spring Boot can not read postgresql table column's name with sign double quotes on it. It throws error 'SQLState: 42703' and 'ERROR: Column a1_0.xx does not exist'. In Postman it threw '500 Internal Server Error'</p>\n<p>So, the case is I was trying to create an API with Java Spring Boot.</p>\n<p>I have two tables. Both was created with postgresql. Both also has a structure like this:</p>\n<pre><code>------------+-------------------+----------+\nalId        | alName            | alPoints |\n[PK] bigint | character varying | bigint   |\n------------+-------------------+----------+\n101         | Name 1            | 70       |\n102         | Name 2            | 80       |\n103         | Name 3            | 90       |\n------------+-------------------+----------+\n</code></pre>\n<p>First table's name is 'alien_rest'.  Second table's name is 'alien_rest3'. I created the second one to check what is wrong with first one.</p>\n<p>Because whenever I try to execute 'select * from public.alien_rest' for first table through method '.findAll()', it threw errors like below. What confuse me, somehow everything works fine when I execute 'select * from public.alien_rest3' for second table.</p>\n<p>While in Postman, it threw error message '500 Internal Server Error'</p>\n<pre><code>2023-05-23T12:02:31.301+07:00[0;39m [33m WARN[0;39m [35m7520[0;39m [2m---[0;39m [2m[nio-8080-exec-2][0;39m [36mo.h.engine.jdbc.spi.SqlExceptionHelper  [0;39m [2m:[0;39m SQL Error: 0, SQLState: 42703\n[2m2023-05-23T12:02:31.302+07:00[0;39m [31mERROR[0;39m [35m7520[0;39m [2m---[0;39m [2m[nio-8080-exec-2][0;39m [36mo.h.engine.jdbc.spi.SqlExceptionHelper  [0;39m [2m:[0;39m ERROR: column a1_0.al_id does not exist\n  Hint: Perhaps you meant to reference the column &quot;a1_0.alId&quot;.\n  Position: 8\n[2m2023-05-23T12:02:31.323+07:00[0;39m [31mERROR[0;39m [35m7520[0;39m [2m---[0;39m [2m[nio-8080-exec-2][0;39m [36mo.a.c.c.C.[.[.[/].[dispatcherServlet]   [0;39m [2m:[0;39m Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select a1_0.al_id,a1_0.al_name,a1_0.al_points from alien_rest a1_0] [ERROR: column a1_0.al_id does not exist\n  Hint: Perhaps you meant to reference the column &quot;a1_0.alId&quot;.\n  Position: 8] [n/a]; SQL [n/a]] with root cause\n</code></pre>\n<p>I check through pgAdmin (mine is pgAdmin 4 version 7.1), turn out there is a difference with format of both column's name. 'alien_rest' use sign &quot;&quot; for its columns'name while alien_rest3 does not use sign &quot;&quot; for its columns'name.</p>\n<p>For first table or 'alien_rest', it has format like this:</p>\n<pre><code>CREATE TABLE IF NOT EXISTS public.alien_rest\n(\n    &quot;alId&quot; bigint NOT NULL,\n    &quot;alName&quot; character varying(20) COLLATE pg_catalog.&quot;default&quot;,\n    &quot;alPoints&quot; bigint,\n    CONSTRAINT alien_rest_pkey PRIMARY KEY (&quot;alId&quot;)\n)\n\nTABLESPACE pg_default;\n</code></pre>\n<p>while for the second table or 'alien_rest3', is has format like this:</p>\n<pre><code>CREATE TABLE IF NOT EXISTS public.alien_rest3\n(\n    alid bigint NOT NULL,\n    alname character varying COLLATE pg_catalog.&quot;default&quot;,\n    alpoints bigint,\n    CONSTRAINT alien_rest3_pkey PRIMARY KEY (alid)\n)\n\nTABLESPACE pg_default;\n</code></pre>\n<p>I am not sure what I did that cause table 'alien_rest' use sign double quotes for its column's name.</p>\n<p>It seems like the sign double quotes (or &quot;&quot;) in the column's name is the one who give problem to the Spring Boot to read the first table or 'alien_rest'.</p>\n<p>So, what is going on here? What can I do to fix the problem. Thank you for any help ;)</p>\n<p>To make things clear, here is my codes in my Spring Boot project:</p>\n<p>AlienResource.java</p>\n<pre><code>package com.kastamer;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController //DEFINE that THIS CLASS is TECHNICALLY now A CONTROLLER FOR the APP 'SpringBootRest'\npublic class AlienResource {\n\n    @Autowired\n    AlienRepositoryDAO ard;\n    \n    @GetMapping(&quot;aliens&quot;)\n    public List&lt;Alien&gt; getAliens() {\n        \n        List&lt;Alien&gt; aliens = (List&lt;Alien&gt;) ard.findAll();\n        return aliens;\n    }\n}\n</code></pre>\n<p>Alien.java</p>\n<pre><code>package com.kastamer;\n\nimport jakarta.persistence.Column;\nimport jakarta.persistence.Entity;\nimport jakarta.persistence.EntityResult;\nimport jakarta.persistence.FieldResult;\nimport jakarta.persistence.Id;\nimport jakarta.persistence.SqlResultSetMapping;\nimport jakarta.persistence.Table;\n\n@Entity\n@Table(name = &quot;alien_rest&quot;)//, schema = &quot;public&quot;) //THIS is NOT WORKING with/without 'schema' for TABLE alien_rest\n/* --&gt; THIS is NOT WORKING for TABLE alien_rest\n@SqlResultSetMapping(name = &quot;AlienMapping&quot;, entities = @EntityResult(entityClass = Alien.class, \n        fields = {\n                @FieldResult(name = &quot;alId&quot;, column = &quot;alId&quot;),\n                @FieldResult(name = &quot;alName&quot;, column = &quot;alName&quot;),\n                @FieldResult(name = &quot;alPoints&quot;, column = &quot;alPoints&quot;)\n        })) */\npublic class Alien {\n\n    @Id\n    //Column(name = &quot;\\&quot;alId\\&quot;&quot;) --&gt; PUT SIGN '\\&quot;' to VALUE does NOT HELP ANY\n    @Column(name = &quot;alId&quot;) //THIS is NOT WORKING for TABLE alien_rest\n    private int alId;\n    //Column(name &quot;\\&quot;alName\\&quot;&quot;) --&gt; PUT SIGN '\\&quot;' to VALUE does NOT HELP ANY\n    @Column(name = &quot;alName&quot;) //THIS is NOT WORKING for TABLE alien_rest\n    private String alName;\n    //Column(name &quot;\\&quot;alPoints\\&quot;&quot;) --&gt; PUT SIGN '\\&quot;' to VALUE does NOT HELP ANY\n    @Column(name = &quot;alPoints&quot;) //THIS is NOT WORKING for TABLE alien_rest\n    private int alPoints;\n    \n    public int getAlId() {\n        return alId;\n    }\n    public void setAlId(int alId) {\n        this.alId = alId;\n    }\n    public String getAlName() {\n        return alName;\n    }\n    public void setAlName(String alName) {\n        this.alName = alName;\n    }\n    public int getAlPoints() {\n        return alPoints;\n    }\n    public void setAlPoints(int alPoints) {\n        this.alPoints = alPoints;\n    }\n    \n    @Override\n    public String toString() {\n        return &quot;Alien [alName=&quot; + alName + &quot;, alPoints=&quot; + alPoints + &quot;, alId=&quot; + alId + &quot;]&quot;;\n    }   \n}\n\n</code></pre>\n<p>AlienRepositoryDAO.java</p>\n<pre><code>package com.kastamer;\n\nimport java.util.List;\n\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.data.jpa.repository.Query;\nimport org.springframework.data.repository.CrudRepository;\n\npublic interface AlienRepositoryDAO extends CrudRepository&lt;Alien, Integer&gt;{\n\n}\n</code></pre>\n<p>pom.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.1.0&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.kastamer&lt;/groupId&gt;\n    &lt;artifactId&gt;SpringBootRest&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;SpringBootRest&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        \n        &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-jpa --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n            &lt;version&gt;3.1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        &lt;!-- https://mvnrepository.com/artifact/org.postgresql/postgresql --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n            &lt;version&gt;42.6.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n\n</code></pre>\n"},{"tags":["java","pdf","plot","processing"],"owner":{"account_id":20468860,"reputation":67,"user_id":15019776,"display_name":"cans"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":26,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684845453,"creation_date":1684845453,"question_id":76314835,"body_markdown":"With Processing 4, I can save my data in PDF format. But it doesn&#39;t happen when I try to add an image behind the PDF output. I have to use beginRecord() function because I need to record data continuously.\r\n\r\n```\r\npublic void setup() \r\n{  \r\n  GPointsArray pointsECG = new GPointsArray(nPoints1);\r\n \r\n  size(1024, 600, JAVA2D);\r\n  backgroundImage = loadImage(ecgeniyi.png);\r\n  heightHeader=100;\r\n  println(&quot;Height:&quot;+height);\r\n\r\n  totalPlotsHeight=height-heightHeader;\r\n  \r\n  makeGUI();\r\n  surface.setTitle(&quot;Healthy Race&quot;);\r\n  PImage icon = loadImage(&quot;hr.png&quot;);\r\n  surface.setIcon(icon);\r\n  \r\n  plot1 = new GPlot(this);\r\n  plot1.setPos(20,200);\r\n  plot1.setDim(width-40, (totalPlotsHeight/3)-10);\r\n  plot1.setBgColor(0);\r\n  plot1.setBoxBgColor(0);\r\n  plot1.setLineColor(color(255, 255, 255));\r\n  plot1.setLineWidth(1);\r\n  plot1.setMar(0,0,0,0);\r\n\r\n  for (int i = 0; i &lt; nPoints1; i++) \r\n  {\r\n \r\n    pointsECG.add(i,0);\r\n\r\n  }\r\n  \r\n  plot1.setPoints(pointsECG);\r\n\r\n  for (int i=0; i&lt;windowSize; i++) \r\n  {\r\n\r\n    ch1Data[i] = 0;\r\n    ch2Data[i] = 0;\r\n    \r\n  }\r\n\r\n}\r\n\r\n\r\npublic void draw() \r\n{\r\n  background(255);\r\n // background(19,75,102);\r\n\r\n  GPointsArray pointsPlot1 = new GPointsArray(nPoints1);\r\n\r\n\r\n  if (startPlot)                             // If the condition is true, then the plotting is done\r\n  {\r\n    for(int i=0; i&lt;nPoints1;i++)\r\n    {    \r\n      pointsPlot1.add(i,ch1Data[i]);\r\n    }\r\n  } \r\n  else                                     // Default value is set\r\n  {\r\n  }\r\n\r\n  plot1.setPoints(pointsPlot1);\r\n\r\n  \r\n  plot1.beginDraw();\r\n  plot1.drawBackground();\r\n  plot1.drawLines();\r\n  plot1.endDraw();\r\n\r\nif(c == true){\r\nif(f == true){\r\n  pdf.nextPage();\r\n  f = false;\r\n}}\r\n\r\n  \r\n}\r\n\r\npublic void RecordData()\r\n{\r\n      c = true;\r\n\r\n  pdf = (PGraphicsPDF)beginRecord(PDF, &quot;Lines.pdf&quot;);\r\n  pdf.beginDraw();\r\n  pdf.background(255);\r\n  pdf.image(backgroundImage, 0, 0, pdf.width, pdf.height); \r\n  pdf.endDraw();\r\n\r\n  pdf.dispose();\r\n}\r\n\r\n\r\npublic void EndRecord()\r\n{\r\n    c = false;\r\n\r\n  endRecord();\r\n}\r\n```\r\n\r\nHere RecordData(); I want to see an image in the background while drawing PDF lines in the function.","title":"Adding background when outputting PDF in Processing 4 JAVA","body":"<p>With Processing 4, I can save my data in PDF format. But it doesn't happen when I try to add an image behind the PDF output. I have to use beginRecord() function because I need to record data continuously.</p>\n<pre><code>public void setup() \n{  \n  GPointsArray pointsECG = new GPointsArray(nPoints1);\n \n  size(1024, 600, JAVA2D);\n  backgroundImage = loadImage(ecgeniyi.png);\n  heightHeader=100;\n  println(&quot;Height:&quot;+height);\n\n  totalPlotsHeight=height-heightHeader;\n  \n  makeGUI();\n  surface.setTitle(&quot;Healthy Race&quot;);\n  PImage icon = loadImage(&quot;hr.png&quot;);\n  surface.setIcon(icon);\n  \n  plot1 = new GPlot(this);\n  plot1.setPos(20,200);\n  plot1.setDim(width-40, (totalPlotsHeight/3)-10);\n  plot1.setBgColor(0);\n  plot1.setBoxBgColor(0);\n  plot1.setLineColor(color(255, 255, 255));\n  plot1.setLineWidth(1);\n  plot1.setMar(0,0,0,0);\n\n  for (int i = 0; i &lt; nPoints1; i++) \n  {\n \n    pointsECG.add(i,0);\n\n  }\n  \n  plot1.setPoints(pointsECG);\n\n  for (int i=0; i&lt;windowSize; i++) \n  {\n\n    ch1Data[i] = 0;\n    ch2Data[i] = 0;\n    \n  }\n\n}\n\n\npublic void draw() \n{\n  background(255);\n // background(19,75,102);\n\n  GPointsArray pointsPlot1 = new GPointsArray(nPoints1);\n\n\n  if (startPlot)                             // If the condition is true, then the plotting is done\n  {\n    for(int i=0; i&lt;nPoints1;i++)\n    {    \n      pointsPlot1.add(i,ch1Data[i]);\n    }\n  } \n  else                                     // Default value is set\n  {\n  }\n\n  plot1.setPoints(pointsPlot1);\n\n  \n  plot1.beginDraw();\n  plot1.drawBackground();\n  plot1.drawLines();\n  plot1.endDraw();\n\nif(c == true){\nif(f == true){\n  pdf.nextPage();\n  f = false;\n}}\n\n  \n}\n\npublic void RecordData()\n{\n      c = true;\n\n  pdf = (PGraphicsPDF)beginRecord(PDF, &quot;Lines.pdf&quot;);\n  pdf.beginDraw();\n  pdf.background(255);\n  pdf.image(backgroundImage, 0, 0, pdf.width, pdf.height); \n  pdf.endDraw();\n\n  pdf.dispose();\n}\n\n\npublic void EndRecord()\n{\n    c = false;\n\n  endRecord();\n}\n</code></pre>\n<p>Here RecordData(); I want to see an image in the background while drawing PDF lines in the function.</p>\n"},{"tags":["java"],"owner":{"account_id":11530128,"reputation":25,"user_id":8449286,"display_name":"Krati Tiwari"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":67,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684845438,"creation_date":1684845438,"question_id":76314833,"body_markdown":"I have a method in Java which gets the contents of a build.gradle file in String format as an argument. The method should be able to parse the content and read plugins and dependencies from it. The end-goal is to check whether a particular plugin/dependency is added in build.gradle file. Can someone suggest an efficient way of doing this in Java?\r\n\r\nHere is a snippet of build.gradle file content (Actual content will be given as String):\r\n``` \r\nplugins {\r\n    id &quot;org.jetbrains.kotlin.jvm&quot; apply false\r\n    id &quot;org.sonarqube&quot;\r\n    id &quot;org.jlleitschuh.gradle.ktlint&quot;\r\n}\r\ndependencies {\r\n    implementation &quot;joda-time:joda-time:2.2&quot;\r\n    testImplementation &quot;junit:junit:4.12&quot;\r\n}\r\napply plugin: &#39;java&#39;\r\napply plugin: &#39;eclipse&#39;\r\napply plugin: &#39;application&#39;\r\n\r\nmainClassName = &#39;hello.HelloWorld&#39;\r\n\r\n// tag::repositories[]\r\nrepositories { \r\n    mavenCentral() \r\n}\r\n// end::repositories[]\r\n\r\n// tag::jar[]\r\njar {\r\n    archiveBaseName = &#39;gs-gradle&#39;\r\n    archiveVersion =  &#39;0.1.0&#39;\r\n}\r\n\r\n```","title":"Parse string build.gradle contents to extract plugins and dependencies in java","body":"<p>I have a method in Java which gets the contents of a build.gradle file in String format as an argument. The method should be able to parse the content and read plugins and dependencies from it. The end-goal is to check whether a particular plugin/dependency is added in build.gradle file. Can someone suggest an efficient way of doing this in Java?</p>\n<p>Here is a snippet of build.gradle file content (Actual content will be given as String):</p>\n<pre><code>plugins {\n    id &quot;org.jetbrains.kotlin.jvm&quot; apply false\n    id &quot;org.sonarqube&quot;\n    id &quot;org.jlleitschuh.gradle.ktlint&quot;\n}\ndependencies {\n    implementation &quot;joda-time:joda-time:2.2&quot;\n    testImplementation &quot;junit:junit:4.12&quot;\n}\napply plugin: 'java'\napply plugin: 'eclipse'\napply plugin: 'application'\n\nmainClassName = 'hello.HelloWorld'\n\n// tag::repositories[]\nrepositories { \n    mavenCentral() \n}\n// end::repositories[]\n\n// tag::jar[]\njar {\n    archiveBaseName = 'gs-gradle'\n    archiveVersion =  '0.1.0'\n}\n\n</code></pre>\n"},{"tags":["java","maven","java-11","apache-fop","java-module"],"comments":[{"owner":{"account_id":2973802,"reputation":48688,"user_id":2525313,"accept_rate":88,"display_name":"Nicolai Parlog"},"score":1,"creation_date":1622269899,"post_id":67742834,"comment_id":119749124,"body_markdown":"Not solving your problem, but you can&#39;t use batik-script on the module path because the JAR declares a service that it doesn&#39;t contain itself and the module system fobids that - see [this issue](https://issues.apache.org/jira/browse/BATIK-1260).","body":"Not solving your problem, but you can&#39;t use batik-script on the module path because the JAR declares a service that it doesn&#39;t contain itself and the module system fobids that - see <a href=\"https://issues.apache.org/jira/browse/BATIK-1260\" rel=\"nofollow noreferrer\">this issue</a>."},{"owner":{"account_id":2973802,"reputation":48688,"user_id":2525313,"accept_rate":88,"display_name":"Nicolai Parlog"},"score":0,"creation_date":1622270213,"post_id":67742834,"comment_id":119749176,"body_markdown":"Probably the quickest fix is not to use the module system for your application, you should be able to launch it from the class path with `-cp target/rutil-0.0.1-SNAPSHOT.jar;&quot;target/lib/*&quot;` instead of `-p ...`.","body":"Probably the quickest fix is not to use the module system for your application, you should be able to launch it from the class path with <code>-cp target&#47;rutil-0.0.1-SNAPSHOT.jar;&quot;target&#47;lib&#47;*&quot;</code> instead of <code>-p ...</code>."},{"owner":{"account_id":1939636,"reputation":28467,"user_id":1746118,"accept_rate":95,"display_name":"Naman"},"score":0,"creation_date":1622283050,"post_id":67742834,"comment_id":119751767,"body_markdown":"@NicolaiParlog moving everything to the classpath would mean getting rid of the `module-info`(not modularising one&#39;s app), right? In the hope of moving forward, I had [tried executing](https://stackoverflow.com/a/67743247/1746118) the linked project in the question with absolutely minimal dependencies required on the modulepath and still being able to execute with the rest of those in the classpath. I was able to see a successful execution for the shared sample.  Any caveats you might find in the suggested approach?","body":"@NicolaiParlog moving everything to the classpath would mean getting rid of the <code>module-info</code>(not modularising one&#39;s app), right? In the hope of moving forward, I had <a href=\"https://stackoverflow.com/a/67743247/1746118\">tried executing</a> the linked project in the question with absolutely minimal dependencies required on the modulepath and still being able to execute with the rest of those in the classpath. I was able to see a successful execution for the shared sample.  Any caveats you might find in the suggested approach?"}],"answers":[{"comments":[{"owner":{"account_id":2002545,"reputation":832,"user_id":1793217,"display_name":"ngong"},"score":1,"creation_date":1622294408,"post_id":67743247,"comment_id":119754547,"body_markdown":"Works for me, adding the star /* at the end of the --class-path.","body":"Works for me, adding the star /* at the end of the --class-path."}],"tags":[],"owner":{"account_id":1939636,"reputation":28467,"user_id":1746118,"accept_rate":95,"display_name":"Naman"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1622222894,"creation_date":1622222894,"answer_id":67743247,"question_id":67742834,"body_markdown":"You can put all your non modularised artifacts on the classpath and not support deriving their module information. These would be primarily treated as an [unnamed module][1].\r\n\r\n\r\n    java --module-path target/rutil-0.0.1-SNAPSHOT.jar;target/lib/fop-2.6.jar \\\r\n         --class-path target/lib \\\r\n         --module eu.ngong.rutil/eu.ngong.rutil.App\r\n\r\n\r\nI have provided an explanation in [this answer][2] to the error that you are facing. The immediate way to solve it while using all other artifacts on modulepath as well could be hacking the jar to remove the entry from the `MANIFEST.MF`. \r\n\r\n\r\n  [1]: http://openjdk.java.net/projects/jigsaw/spec/sotms/#unnamed-modules\r\n  [2]: https://stackoverflow.com/a/54682966/1746118","title":"How to run apache fop with Java-11?","body":"<p>You can put all your non modularised artifacts on the classpath and not support deriving their module information. These would be primarily treated as an <a href=\"http://openjdk.java.net/projects/jigsaw/spec/sotms/#unnamed-modules\" rel=\"nofollow noreferrer\">unnamed module</a>.</p>\n<pre><code>java --module-path target/rutil-0.0.1-SNAPSHOT.jar;target/lib/fop-2.6.jar \\\n     --class-path target/lib \\\n     --module eu.ngong.rutil/eu.ngong.rutil.App\n</code></pre>\n<p>I have provided an explanation in <a href=\"https://stackoverflow.com/a/54682966/1746118\">this answer</a> to the error that you are facing. The immediate way to solve it while using all other artifacts on modulepath as well could be hacking the jar to remove the entry from the <code>MANIFEST.MF</code>.</p>\n"},{"tags":[],"owner":{"account_id":204515,"reputation":11679,"user_id":452775,"accept_rate":63,"display_name":"Lii"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684845087,"creation_date":1684845087,"answer_id":76314789,"question_id":67742834,"body_markdown":"In Naman&#39;s solution FOP is placed on the class-path, instead on on the module path. This has some disadvantages.\r\n\r\nYou can also get FOP to work on the module-path of your application.\r\n\r\n * Use FOP 2.8, which doesn&#39;t have the error in the question.\r\n\r\n * Use the separate FOP artifacts, instead of the one that includes everything: `fop-core`, `fop-events` and `fop-util`. (This is the [recommenced](https://issues.apache.org/jira/browse/FOP-3088) way anyway.) \r\n * In your module, declare `requires fop-core`.\r\n * Patch `fop-core` with the other modules: `--patch-module fop.core=fop-events-2.8.jar;fop-util-2.8.jar`.\r\n    - Patching must be done both for compiling and running the application.\r\n* Start your application with `--module` and `--module-path`.\r\n\r\nDone. :)","title":"How to run apache fop with Java-11?","body":"<p>In Naman's solution FOP is placed on the class-path, instead on on the module path. This has some disadvantages.</p>\n<p>You can also get FOP to work on the module-path of your application.</p>\n<ul>\n<li><p>Use FOP 2.8, which doesn't have the error in the question.</p>\n</li>\n<li><p>Use the separate FOP artifacts, instead of the one that includes everything: <code>fop-core</code>, <code>fop-events</code> and <code>fop-util</code>. (This is the <a href=\"https://issues.apache.org/jira/browse/FOP-3088\" rel=\"nofollow noreferrer\">recommenced</a> way anyway.)</p>\n</li>\n<li><p>In your module, declare <code>requires fop-core</code>.</p>\n</li>\n<li><p>Patch <code>fop-core</code> with the other modules: <code>--patch-module fop.core=fop-events-2.8.jar;fop-util-2.8.jar</code>.</p>\n<ul>\n<li>Patching must be done both for compiling and running the application.</li>\n</ul>\n</li>\n<li><p>Start your application with <code>--module</code> and <code>--module-path</code>.</p>\n</li>\n</ul>\n<p>Done. :)</p>\n"}],"owner":{"account_id":2002545,"reputation":832,"user_id":1793217,"display_name":"ngong"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1005,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":67743247,"answer_count":2,"score":3,"last_activity_date":1684845087,"creation_date":1622220837,"question_id":67742834,"body_markdown":"Using fop and Java11 with Maven and Eclipse I can create PDF documents from an xsl-fo input.\r\n\r\nBut only if I start the program from within Eclipse.\r\n\r\nMy pom.xml advises Maven to copy all jar files used for dependencies, to a lib folder. Preparing to run from command line.\r\n\r\nWhen I try to start the program from command line like\r\n\r\n    java -p target/rutil-0.0.1-SNAPSHOT.jar;target/lib -m eu.ngong.rutil/eu.ngong.rutil.App\r\n\r\nI get this error:\r\n\r\n&gt; Error occurred during initialization of boot layer\r\njava.lang.module.FindException: Unable to derive module descriptor for target\\lib\\batik-script-1.14.jar.\r\n\r\nI can add exclusions to the fop dependency entry in pom.xml, but only to see the next failure message (same package in two modules) and so on.\r\n\r\nHow can I start my program from command line like Eclipse is doing?\r\n\r\nMy goal is to use fop in a nightly build batch run.\r\n\r\nYou may find an absolute minimal version of my program [here][1].\r\n\r\n\r\n  [1]: https://owncloud.august.de/index.php/s/5AEDpZBgRuD8PRb/download","title":"How to run apache fop with Java-11?","body":"<p>Using fop and Java11 with Maven and Eclipse I can create PDF documents from an xsl-fo input.</p>\n<p>But only if I start the program from within Eclipse.</p>\n<p>My pom.xml advises Maven to copy all jar files used for dependencies, to a lib folder. Preparing to run from command line.</p>\n<p>When I try to start the program from command line like</p>\n<pre><code>java -p target/rutil-0.0.1-SNAPSHOT.jar;target/lib -m eu.ngong.rutil/eu.ngong.rutil.App\n</code></pre>\n<p>I get this error:</p>\n<blockquote>\n<p>Error occurred during initialization of boot layer\njava.lang.module.FindException: Unable to derive module descriptor for target\\lib\\batik-script-1.14.jar.</p>\n</blockquote>\n<p>I can add exclusions to the fop dependency entry in pom.xml, but only to see the next failure message (same package in two modules) and so on.</p>\n<p>How can I start my program from command line like Eclipse is doing?</p>\n<p>My goal is to use fop in a nightly build batch run.</p>\n<p>You may find an absolute minimal version of my program <a href=\"https://owncloud.august.de/index.php/s/5AEDpZBgRuD8PRb/download\" rel=\"nofollow noreferrer\">here</a>.</p>\n"},{"tags":["java","spring","spring-boot","spring-security"],"comments":[{"owner":{"account_id":357760,"reputation":1492,"user_id":2304483,"display_name":"user2304483"},"score":0,"creation_date":1684569921,"post_id":76203747,"comment_id":134538859,"body_markdown":"The log is just by running the application or after hitting the controller?","body":"The log is just by running the application or after hitting the controller?"},{"owner":{"account_id":7087499,"reputation":69,"user_id":10054032,"display_name":"rsmidt"},"score":0,"creation_date":1684660997,"post_id":76203747,"comment_id":134546868,"body_markdown":"It&#39;s after hitting the controller.","body":"It&#39;s after hitting the controller."},{"owner":{"account_id":357760,"reputation":1492,"user_id":2304483,"display_name":"user2304483"},"score":0,"creation_date":1684661536,"post_id":76203747,"comment_id":134546917,"body_markdown":"ok. can you add to the question the annotations you have on top of the class.","body":"ok. can you add to the question the annotations you have on top of the class."},{"owner":{"account_id":3585451,"reputation":6335,"user_id":2992754,"display_name":"juanlumn"},"score":0,"creation_date":1684752130,"post_id":76203747,"comment_id":134557773,"body_markdown":"Have you added something like `@RequestMapping(&quot;api&quot;)` to the top of the class?","body":"Have you added something like <code>@RequestMapping(&quot;api&quot;)</code> to the top of the class?"}],"owner":{"account_id":7087499,"reputation":69,"user_id":10054032,"display_name":"rsmidt"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":260,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":0,"score":2,"last_activity_date":1684844882,"creation_date":1683573628,"question_id":76203747,"body_markdown":"I&#39;m following this [code sample][1] and this [guide][2] to implement a simple, stateless authentication for a REST API via Spring Boot + Security.\r\n\r\nWhen firing a request to `/api/login`, I can see and trace that my controller method is properly invoked, the authentication is successful, and a token gets generated. However, the filter is then invoked a second time for `/api/api/login` which obviously fails and then fails the whole chain.\r\n\r\nThe controller method:\r\n```java\r\n@PutMapping(&quot;/api/login&quot;)\r\npublic LoginUserOutput loginUser(@Valid @RequestBody LoginUserInput loginUserInput) {\r\n    final var authentication = authenticationManager.authenticate(new UsernamePasswordAuthenticationToken(loginUserInput.username(), loginUserInput.password()));\r\n    final var user = (User) authentication.getPrincipal();\r\n\r\n    final var claims = JwtClaimsSet.builder().subject(user.getUsername()).build();\r\n    final var header = JwsHeader.with(MacAlgorithm.HS256).build();\r\n    final var token = jwtEncoder.encode(JwtEncoderParameters.from(header, claims));\r\n\r\n    return new LoginUserOutput(token.getTokenValue());\r\n}\r\n```\r\n\r\nAnd my security filter chain:\r\n\r\n```java\r\n@Bean\r\nSecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\r\n    return http.csrf().disable()\r\n            .authorizeHttpRequests().requestMatchers(&quot;/api/prometheus/**&quot;).hasRole(&quot;MONITORING&quot;).and().httpBasic()\r\n            .and()\r\n            .authorizeHttpRequests().requestMatchers(HttpMethod.PUT, &quot;/api/login&quot;).permitAll()\r\n            .and()\r\n            .authorizeHttpRequests().anyRequest().authenticated()\r\n            .and()\r\n            .oauth2ResourceServer(OAuth2ResourceServerConfigurer::jwt)\r\n            .sessionManagement()\r\n            .sessionCreationPolicy(SessionCreationPolicy.STATELESS).and()\r\n            .exceptionHandling((exceptions) -&gt; exceptions.authenticationEntryPoint(new BearerTokenAuthenticationEntryPoint())\r\n                    .accessDeniedHandler(new BearerTokenAccessDeniedHandler()))\r\n            .build();\r\n}\r\n```\r\n\r\nI&#39;ve tried the endpoint both with Postman and the IntelliJ HTTP client.\r\n\r\nThis is the log output when running with Spring Security on DEBUG:\r\n```\r\n2023-05-08T21:18:42.121+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.security.web.FilterChainProxy        : Securing PUT /api/login\r\n2023-05-08T21:18:42.122+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext\r\n2023-05-08T21:18:42.123+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.security.web.FilterChainProxy        : Secured PUT /api/login\r\nHibernate: select u1_0.id,u1_0.hashed_password,u1_0.roles,u1_0.username from users u1_0 where u1_0.username=?\r\n2023-05-08T21:18:42.234+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.s.a.dao.DaoAuthenticationProvider    : Authenticated user\r\n2023-05-08T21:18:42.235+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.security.web.FilterChainProxy        : Securing PUT /api/api/login\r\n```\r\n\r\n  [1]: https://github.com/spring-projects/spring-security-samples/blob/main/servlet/spring-boot/java/jwt/login/src/main/java/example/RestConfig.java\r\n  [2]: https://www.toptal.com/spring/spring-security-tutorial","title":"Spring security filter is invoked twice with slightly different path","body":"<p>I'm following this <a href=\"https://github.com/spring-projects/spring-security-samples/blob/main/servlet/spring-boot/java/jwt/login/src/main/java/example/RestConfig.java\" rel=\"nofollow noreferrer\">code sample</a> and this <a href=\"https://www.toptal.com/spring/spring-security-tutorial\" rel=\"nofollow noreferrer\">guide</a> to implement a simple, stateless authentication for a REST API via Spring Boot + Security.</p>\n<p>When firing a request to <code>/api/login</code>, I can see and trace that my controller method is properly invoked, the authentication is successful, and a token gets generated. However, the filter is then invoked a second time for <code>/api/api/login</code> which obviously fails and then fails the whole chain.</p>\n<p>The controller method:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@PutMapping(&quot;/api/login&quot;)\npublic LoginUserOutput loginUser(@Valid @RequestBody LoginUserInput loginUserInput) {\n    final var authentication = authenticationManager.authenticate(new UsernamePasswordAuthenticationToken(loginUserInput.username(), loginUserInput.password()));\n    final var user = (User) authentication.getPrincipal();\n\n    final var claims = JwtClaimsSet.builder().subject(user.getUsername()).build();\n    final var header = JwsHeader.with(MacAlgorithm.HS256).build();\n    final var token = jwtEncoder.encode(JwtEncoderParameters.from(header, claims));\n\n    return new LoginUserOutput(token.getTokenValue());\n}\n</code></pre>\n<p>And my security filter chain:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\nSecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n    return http.csrf().disable()\n            .authorizeHttpRequests().requestMatchers(&quot;/api/prometheus/**&quot;).hasRole(&quot;MONITORING&quot;).and().httpBasic()\n            .and()\n            .authorizeHttpRequests().requestMatchers(HttpMethod.PUT, &quot;/api/login&quot;).permitAll()\n            .and()\n            .authorizeHttpRequests().anyRequest().authenticated()\n            .and()\n            .oauth2ResourceServer(OAuth2ResourceServerConfigurer::jwt)\n            .sessionManagement()\n            .sessionCreationPolicy(SessionCreationPolicy.STATELESS).and()\n            .exceptionHandling((exceptions) -&gt; exceptions.authenticationEntryPoint(new BearerTokenAuthenticationEntryPoint())\n                    .accessDeniedHandler(new BearerTokenAccessDeniedHandler()))\n            .build();\n}\n</code></pre>\n<p>I've tried the endpoint both with Postman and the IntelliJ HTTP client.</p>\n<p>This is the log output when running with Spring Security on DEBUG:</p>\n<pre><code>2023-05-08T21:18:42.121+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.security.web.FilterChainProxy        : Securing PUT /api/login\n2023-05-08T21:18:42.122+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext\n2023-05-08T21:18:42.123+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.security.web.FilterChainProxy        : Secured PUT /api/login\nHibernate: select u1_0.id,u1_0.hashed_password,u1_0.roles,u1_0.username from users u1_0 where u1_0.username=?\n2023-05-08T21:18:42.234+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.s.a.dao.DaoAuthenticationProvider    : Authenticated user\n2023-05-08T21:18:42.235+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.security.web.FilterChainProxy        : Securing PUT /api/api/login\n</code></pre>\n"},{"tags":["java","regex","regex-group","microbenchmark","recursive-backtracking"],"comments":[{"owner":{"account_id":3362143,"reputation":39498,"user_id":2823719,"accept_rate":11,"display_name":"Booboo"},"score":0,"creation_date":1684872757,"post_id":76314651,"comment_id":134580310,"body_markdown":"I don&#39;t see why `test1.replaceAll(&quot;\\\\s*,\\\\s*&quot;, &quot;,&quot;)` would result in backtracking. The regex engine should scan for either whitespace or a comma. If it finds whitespace then continue to scan for either more whitespace or a comma. If it then finds something else other than whitespace or a comma, there is no reason to backtrack. It should continue from that point looking for the next whitespace or comma. So if there is no comma in the string, it will just scan all the characters once.  In other words, it should be easy to construct a DFSA that recognizes `&quot;\\\\s*,\\\\s*&quot;`.","body":"I don&#39;t see why <code>test1.replaceAll(&quot;\\\\s*,\\\\s*&quot;, &quot;,&quot;)</code> would result in backtracking. The regex engine should scan for either whitespace or a comma. If it finds whitespace then continue to scan for either more whitespace or a comma. If it then finds something else other than whitespace or a comma, there is no reason to backtrack. It should continue from that point looking for the next whitespace or comma. So if there is no comma in the string, it will just scan all the characters once.  In other words, it should be easy to construct a DFSA that recognizes <code>&quot;\\\\s*,\\\\s*&quot;</code>."},{"owner":{"account_id":23740623,"reputation":1,"user_id":17758716,"display_name":"Reilas"},"score":0,"creation_date":1684989912,"post_id":76314651,"comment_id":134598757,"body_markdown":"Here is a Microsoft article on backtracking in .NET.  [Backtracking in .NET Regular Expressions | Microsoft Learn](https://learn.microsoft.com/en-us/dotnet/standard/base-types/backtracking-in-regular-expressions).","body":"Here is a Microsoft article on backtracking in .NET.  <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/base-types/backtracking-in-regular-expressions\" rel=\"nofollow noreferrer\">Backtracking in .NET Regular Expressions | Microsoft Learn</a>."},{"owner":{"account_id":23740623,"reputation":1,"user_id":17758716,"display_name":"Reilas"},"score":0,"creation_date":1684990062,"post_id":76314651,"comment_id":134598768,"body_markdown":"Have you reviewed any of the code from [Matcher.java](https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes/java/util/regex/Matcher.java)?","body":"Have you reviewed any of the code from <a href=\"https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes/java/util/regex/Matcher.java\" rel=\"nofollow noreferrer\">Matcher.java</a>?"}],"owner":{"account_id":6528860,"reputation":621,"user_id":5050691,"display_name":"SkogensKonung"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":49,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684844802,"creation_date":1684844161,"question_id":76314651,"body_markdown":"I have a regex in Java that matches zero or more whitespace characters, followed by a comma, followed by zero or more whitespace characters. To clean up the `String`s I use the following:\r\n```\r\nString new1 = test1.replaceAll(&quot;\\\\s*,\\\\s*&quot;, &quot;,&quot;);\r\n```\r\nIf I understand correctly, this regex will backtrack if there is no comma in a given string. Say we have `String s = &quot;Hello    World&quot;;` (4 spaces between words, no comma), then:\r\n\r\n1. The regex will start by trying to match the first `\\\\s*`, which succeeds by matching the four spaces after `&quot;Hello&quot;`.\r\n2. Then it tries to match the comma, which fails because there is no comma.\r\n3. The regex backtracks to the first `\\\\s*` and decides to match three spaces, leaving one space for the comma. It tries to match the comma again, which fails because there is still no comma.\r\n4. It continues the process of and tries again until it has exhausted all possibilities. In the end, the match fails as there is no comma in the string.\r\n\r\nI&#39;m looking for a version of this pattern that will prevent the backtracking. My idea was to use atomic groups, i.e.:\r\n```\r\nString new1 = test1.replaceAll(&quot;(?&gt;\\\\s*),(?&gt;\\\\s*)&quot;, &quot;,&quot;);\r\n```\r\n\r\nTo test the approach, I wrote a simple JMH benchmark using a `String` that has 50000 spaces between `Hello` and `World`, and no comma. On average, the approach with the atomic groups is 2x faster. This is of course better, but still unsatisfactory. \r\n\r\nBench result (see below for setup):\r\n```\r\nBenchmark                    Mode  Cnt  Score   Error  Units\r\nRegexBench.atomicGroup      thrpt       0,387          ops/s\r\nRegexBench.replaceAll       thrpt       0,162          ops/s\r\nRegexBench.replaceExtended  thrpt       0,248          ops/s\r\n```\r\nEDIT: Oddly enough, according to the https://regex101.com/ debugger, the pattern `\\s*,\\s*` needs 86 steps to decide that there is no match, whereas the one that uses atomic groups 172. Consequently, the former shall be faster, so I&#39;m perplexed why the latter is quicker in Java.\r\n\r\n-----\r\nHere&#39;s the bench setup:\r\n```\r\n@State(Scope.Thread)\r\n@BenchmarkMode(Mode.Throughput)\r\n@OutputTimeUnit(TimeUnit.SECONDS)\r\n@Warmup(iterations = 1)\r\n@Measurement(iterations = 1)\r\n@Fork(1)\r\npublic class RegexBench {\r\n\r\n    final static String s1 = divideTwoWordsByNumberOfSpaces(&quot;hello&quot;, &quot;world&quot;, 50000);\r\n\r\n    public static void main(final String[] args) throws IOException {\r\n        org.openjdk.jmh.Main.main(args);\r\n    }\r\n\r\n    static String divideTwoWordsByNumberOfSpaces(final String word1, final String word2, final int numberOfSpaces) {\r\n        final StringBuilder sb = new StringBuilder();\r\n        sb.append(word1);\r\n        for (int i = 0; i &lt; numberOfSpaces; i++) {\r\n            sb.append(&quot; &quot;);\r\n        }\r\n        sb.append(word2);\r\n        return sb.toString();\r\n    }\r\n\r\n    @Benchmark\r\n    public void replaceAll(final Blackhole blackhole) {\r\n        String new1 = s1.replaceAll(&quot;\\\\s*,\\\\s*&quot;, &quot;,&quot;);\r\n    }\r\n\r\n    @Benchmark\r\n    public void replaceExtended(final Blackhole blackhole) {\r\n        String new1 = s1.replaceAll(&quot;\\\\s*+,\\\\s*+&quot;, &quot;,&quot;);\r\n    }\r\n\r\n    @Benchmark\r\n    public void atomicGroup(final Blackhole blackhole){\r\n        String new1 = s1.replaceAll(&quot;(?&gt;\\\\s*),(?&gt;\\\\s*)&quot;, &quot;,&quot;);\r\n    }\r\n}\r\n```\r\n\r\nAnd these dependencies to pom.xml:\r\n```\r\n &lt;!-- https://mvnrepository.com/artifact/org.openjdk.jmh/jmh-core --&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.openjdk.jmh&lt;/groupId&gt;\r\n      &lt;artifactId&gt;jmh-core&lt;/artifactId&gt;\r\n      &lt;version&gt;1.36&lt;/version&gt;\r\n\r\n    &lt;/dependency&gt;\r\n\r\n    &lt;!-- https://mvnrepository.com/artifact/org.openjdk.jmh/jmh-generator-annprocess --&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.openjdk.jmh&lt;/groupId&gt;\r\n      &lt;artifactId&gt;jmh-generator-annprocess&lt;/artifactId&gt;\r\n      &lt;version&gt;1.36&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n```\r\n","title":"ReDoS-resistant regex for removing whitespaces around a comma","body":"<p>I have a regex in Java that matches zero or more whitespace characters, followed by a comma, followed by zero or more whitespace characters. To clean up the <code>String</code>s I use the following:</p>\n<pre><code>String new1 = test1.replaceAll(&quot;\\\\s*,\\\\s*&quot;, &quot;,&quot;);\n</code></pre>\n<p>If I understand correctly, this regex will backtrack if there is no comma in a given string. Say we have <code>String s = &quot;Hello    World&quot;;</code> (4 spaces between words, no comma), then:</p>\n<ol>\n<li>The regex will start by trying to match the first <code>\\\\s*</code>, which succeeds by matching the four spaces after <code>&quot;Hello&quot;</code>.</li>\n<li>Then it tries to match the comma, which fails because there is no comma.</li>\n<li>The regex backtracks to the first <code>\\\\s*</code> and decides to match three spaces, leaving one space for the comma. It tries to match the comma again, which fails because there is still no comma.</li>\n<li>It continues the process of and tries again until it has exhausted all possibilities. In the end, the match fails as there is no comma in the string.</li>\n</ol>\n<p>I'm looking for a version of this pattern that will prevent the backtracking. My idea was to use atomic groups, i.e.:</p>\n<pre><code>String new1 = test1.replaceAll(&quot;(?&gt;\\\\s*),(?&gt;\\\\s*)&quot;, &quot;,&quot;);\n</code></pre>\n<p>To test the approach, I wrote a simple JMH benchmark using a <code>String</code> that has 50000 spaces between <code>Hello</code> and <code>World</code>, and no comma. On average, the approach with the atomic groups is 2x faster. This is of course better, but still unsatisfactory.</p>\n<p>Bench result (see below for setup):</p>\n<pre><code>Benchmark                    Mode  Cnt  Score   Error  Units\nRegexBench.atomicGroup      thrpt       0,387          ops/s\nRegexBench.replaceAll       thrpt       0,162          ops/s\nRegexBench.replaceExtended  thrpt       0,248          ops/s\n</code></pre>\n<p>EDIT: Oddly enough, according to the <a href=\"https://regex101.com/\" rel=\"nofollow noreferrer\">https://regex101.com/</a> debugger, the pattern <code>\\s*,\\s*</code> needs 86 steps to decide that there is no match, whereas the one that uses atomic groups 172. Consequently, the former shall be faster, so I'm perplexed why the latter is quicker in Java.</p>\n<hr />\n<p>Here's the bench setup:</p>\n<pre><code>@State(Scope.Thread)\n@BenchmarkMode(Mode.Throughput)\n@OutputTimeUnit(TimeUnit.SECONDS)\n@Warmup(iterations = 1)\n@Measurement(iterations = 1)\n@Fork(1)\npublic class RegexBench {\n\n    final static String s1 = divideTwoWordsByNumberOfSpaces(&quot;hello&quot;, &quot;world&quot;, 50000);\n\n    public static void main(final String[] args) throws IOException {\n        org.openjdk.jmh.Main.main(args);\n    }\n\n    static String divideTwoWordsByNumberOfSpaces(final String word1, final String word2, final int numberOfSpaces) {\n        final StringBuilder sb = new StringBuilder();\n        sb.append(word1);\n        for (int i = 0; i &lt; numberOfSpaces; i++) {\n            sb.append(&quot; &quot;);\n        }\n        sb.append(word2);\n        return sb.toString();\n    }\n\n    @Benchmark\n    public void replaceAll(final Blackhole blackhole) {\n        String new1 = s1.replaceAll(&quot;\\\\s*,\\\\s*&quot;, &quot;,&quot;);\n    }\n\n    @Benchmark\n    public void replaceExtended(final Blackhole blackhole) {\n        String new1 = s1.replaceAll(&quot;\\\\s*+,\\\\s*+&quot;, &quot;,&quot;);\n    }\n\n    @Benchmark\n    public void atomicGroup(final Blackhole blackhole){\n        String new1 = s1.replaceAll(&quot;(?&gt;\\\\s*),(?&gt;\\\\s*)&quot;, &quot;,&quot;);\n    }\n}\n</code></pre>\n<p>And these dependencies to pom.xml:</p>\n<pre><code> &lt;!-- https://mvnrepository.com/artifact/org.openjdk.jmh/jmh-core --&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.openjdk.jmh&lt;/groupId&gt;\n      &lt;artifactId&gt;jmh-core&lt;/artifactId&gt;\n      &lt;version&gt;1.36&lt;/version&gt;\n\n    &lt;/dependency&gt;\n\n    &lt;!-- https://mvnrepository.com/artifact/org.openjdk.jmh/jmh-generator-annprocess --&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.openjdk.jmh&lt;/groupId&gt;\n      &lt;artifactId&gt;jmh-generator-annprocess&lt;/artifactId&gt;\n      &lt;version&gt;1.36&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n"},{"tags":["java","android","ssl","x509certificate","keystore"],"answers":[{"comments":[{"owner":{"account_id":3209968,"reputation":1619,"user_id":2710154,"accept_rate":72,"display_name":"SSH"},"score":0,"creation_date":1445924756,"post_id":33346934,"comment_id":54516942,"body_markdown":"thnx for the reply , i have already mentioned that may be I am taking this wrong, so as you said I have two things to ask, 1# Do I need to save my keys in SP as I am doing or only keystore is enough? 2# Where to save this file so that nobody else can access it?","body":"thnx for the reply , i have already mentioned that may be I am taking this wrong, so as you said I have two things to ask, 1# Do I need to save my keys in SP as I am doing or only keystore is enough? 2# Where to save this file so that nobody else can access it?"},{"owner":{"account_id":3209968,"reputation":1619,"user_id":2710154,"accept_rate":72,"display_name":"SSH"},"score":0,"creation_date":1445937824,"post_id":33346934,"comment_id":54522888,"body_markdown":"thnx again , testing with this, will accept your answer once i&#39;ll get success","body":"thnx again , testing with this, will accept your answer once i&#39;ll get success"},{"owner":{"account_id":3281695,"reputation":2769,"user_id":2762154,"accept_rate":73,"display_name":"Than"},"score":0,"creation_date":1445938790,"post_id":33346934,"comment_id":54523478,"body_markdown":"Nikolay Elenkov blog is great source of information for all things related to Security in Android. I recommend to look through all his blog posts to get a lot of knowledge about that. You can checkout his book as well: http://nelenkov.blogspot.com/2014/04/android-security-internals.html","body":"Nikolay Elenkov blog is great source of information for all things related to Security in Android. I recommend to look through all his blog posts to get a lot of knowledge about that. You can checkout his book as well: <a href=\"http://nelenkov.blogspot.com/2014/04/android-security-internals.html\" rel=\"nofollow noreferrer\">nelenkov.blogspot.com/2014/04/android-security-internals.htm&zwnj;&#8203;l</a>"}],"tags":[],"owner":{"account_id":3281695,"reputation":2769,"user_id":2762154,"accept_rate":73,"display_name":"Than"},"comment_count":3,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1445935719,"creation_date":1445865928,"answer_id":33346934,"question_id":33346429,"body_markdown":"I don&#39;t know why you want to keep your credentials in shared preferences when you have `Keystore`. Once you load your keystore file to memory you can add/retrieve keys anytime you want. And when you finished with just save it in file by calling:\r\n\r\n    FileOutputStream out = new FileOutputStream(keystoreFile);\r\n        keystore.store(out, password);\r\n        out.close();\r\n\r\nload from file:\r\n\r\n    keystore.load(new FileInputStream(keystoreFile, password);\r\n\r\n@answer to comment\r\n\r\nYou should only use `Keystore`. Data from shared preferences are not secured and it&#39;s very easy to retrieve private key from it. You did not use any kind of encryption so your key is stored in plain PEM text. But if you use `Keystore` your key is password protected (on key level and on keystore level) so if anybody gets the `Keystore` file without passwords it will be much harder for him to break it. Best place to keep `Keystore` file is your app internal space disk which cannot be accessed without rooted phone (`Context.MODE_PRIVATE` when creating file).\r\n","title":"How can I save my keystore securely","body":"<p>I don't know why you want to keep your credentials in shared preferences when you have <code>Keystore</code>. Once you load your keystore file to memory you can add/retrieve keys anytime you want. And when you finished with just save it in file by calling:</p>\n\n<pre><code>FileOutputStream out = new FileOutputStream(keystoreFile);\n    keystore.store(out, password);\n    out.close();\n</code></pre>\n\n<p>load from file:</p>\n\n<pre><code>keystore.load(new FileInputStream(keystoreFile, password);\n</code></pre>\n\n<p>@answer to comment</p>\n\n<p>You should only use <code>Keystore</code>. Data from shared preferences are not secured and it's very easy to retrieve private key from it. You did not use any kind of encryption so your key is stored in plain PEM text. But if you use <code>Keystore</code> your key is password protected (on key level and on keystore level) so if anybody gets the <code>Keystore</code> file without passwords it will be much harder for him to break it. Best place to keep <code>Keystore</code> file is your app internal space disk which cannot be accessed without rooted phone (<code>Context.MODE_PRIVATE</code> when creating file).</p>\n"},{"tags":[],"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1445937637,"creation_date":1445937637,"answer_id":33363957,"question_id":33346429,"body_markdown":"You&#39;ve answered your own question. Save them in a `KeyStore`, *not* in a preferences file.","title":"How can I save my keystore securely","body":"<p>You've answered your own question. Save them in a <code>KeyStore</code>, <em>not</em> in a preferences file.</p>\n"},{"tags":[],"owner":{"account_id":26824694,"reputation":11,"user_id":20413479,"display_name":"Subham Kumar"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684844508,"creation_date":1684844508,"answer_id":76314703,"question_id":33346429,"body_markdown":"The KeyStore get saved by itself unless it is being recreated. We can always extract the keys using `getKeys()` from the key store even after restarting the app. To do this first check if any of the `privateKey` or `secretKey` is already present or not. If present don&#39;t recreate the `KeyPair`(which indiretly creates a new KeyStore). \r\n                         **Notice**:The way I implemented the keyStore gets deleted after the app gets uninstalled. \r\n\r\n    public KeyStore createKeyStore(){\r\n            try {\r\n                KeyStore ks = KeyStore.getInstance(ANDROID_KEYSTORE);\r\n                ks.load(null);\r\n                return ks;\r\n            }\r\n            catch (KeyStoreException e){}\r\n            return  null;\r\n        }\r\n    \r\n    public KeyPair getAsymmetricKeyPair() throws NoSuchPaddingException, NoSuchAlgorithmException, UnrecoverableKeyException, KeyStoreException {\r\n                 KeyStore ks=createKeyStore();\r\n                 KeyPair keyPair;\r\n                 try {\r\n                      PrivateKey privateKey= (PrivateKey) ks.getKey(KEY_ALIAS, null);\r\n                     //privateKey is null it means that there is no keyStore Available   \r\n                      if(privateKey==null){\r\n           \r\n                      //Creating a new KeyStore while creating a KeyPair using keyPairGenerator\r\n                         keyPair=this.createAsymmetricKeyPair();\r\n                         return keyPair;\r\n                      }\r\n                      else //When the keyStore is already available\r\n                      {\r\n                          PublicKey publicKey=(PublicKey) ks.getCertificate(KEY_ALIAS).getPublicKey();\r\n                     //Creating a KeyPair After retrieving them from KeyStore\r\n                          return new KeyPair(publicKey,privateKey);\r\n                      }\r\n                 }\r\n                 catch (UnrecoverableEntryException e){}\r\n            return null;\r\n        }\r\n     public KeyPair createAsymmetricKeyPair(){\r\n        try {\r\n            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(\r\n                    KeyProperties.KEY_ALGORITHM_RSA, ANDROID_KEYSTORE);\r\n\r\n            keyPairGenerator.initialize(\r\n                    new KeyGenParameterSpec.Builder(\r\n                            KEY_ALIAS,\r\n                            KeyProperties.PURPOSE_DECRYPT|KeyProperties.PURPOSE_ENCRYPT)\r\n                            .setDigests(KeyProperties.DIGEST_SHA256, KeyProperties.DIGEST_SHA512)\r\n                            .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_RSA_PKCS1)\r\n                            .setBlockModes(KeyProperties.BLOCK_MODE_ECB)\r\n                            .build());\r\n            KeyPair keyPair = keyPairGenerator.generateKeyPair();\r\n            return keyPair;\r\n        }\r\n        catch(Exception e){}\r\n        return null;\r\n    }","title":"How can I save my keystore securely","body":"<p>The KeyStore get saved by itself unless it is being recreated. We can always extract the keys using <code>getKeys()</code> from the key store even after restarting the app. To do this first check if any of the <code>privateKey</code> or <code>secretKey</code> is already present or not. If present don't recreate the <code>KeyPair</code>(which indiretly creates a new KeyStore).\n<strong>Notice</strong>:The way I implemented the keyStore gets deleted after the app gets uninstalled.</p>\n<pre><code>public KeyStore createKeyStore(){\n        try {\n            KeyStore ks = KeyStore.getInstance(ANDROID_KEYSTORE);\n            ks.load(null);\n            return ks;\n        }\n        catch (KeyStoreException e){}\n        return  null;\n    }\n\npublic KeyPair getAsymmetricKeyPair() throws NoSuchPaddingException, NoSuchAlgorithmException, UnrecoverableKeyException, KeyStoreException {\n             KeyStore ks=createKeyStore();\n             KeyPair keyPair;\n             try {\n                  PrivateKey privateKey= (PrivateKey) ks.getKey(KEY_ALIAS, null);\n                 //privateKey is null it means that there is no keyStore Available   \n                  if(privateKey==null){\n       \n                  //Creating a new KeyStore while creating a KeyPair using keyPairGenerator\n                     keyPair=this.createAsymmetricKeyPair();\n                     return keyPair;\n                  }\n                  else //When the keyStore is already available\n                  {\n                      PublicKey publicKey=(PublicKey) ks.getCertificate(KEY_ALIAS).getPublicKey();\n                 //Creating a KeyPair After retrieving them from KeyStore\n                      return new KeyPair(publicKey,privateKey);\n                  }\n             }\n             catch (UnrecoverableEntryException e){}\n        return null;\n    }\n public KeyPair createAsymmetricKeyPair(){\n    try {\n        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(\n                KeyProperties.KEY_ALGORITHM_RSA, ANDROID_KEYSTORE);\n\n        keyPairGenerator.initialize(\n                new KeyGenParameterSpec.Builder(\n                        KEY_ALIAS,\n                        KeyProperties.PURPOSE_DECRYPT|KeyProperties.PURPOSE_ENCRYPT)\n                        .setDigests(KeyProperties.DIGEST_SHA256, KeyProperties.DIGEST_SHA512)\n                        .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_RSA_PKCS1)\n                        .setBlockModes(KeyProperties.BLOCK_MODE_ECB)\n                        .build());\n        KeyPair keyPair = keyPairGenerator.generateKeyPair();\n        return keyPair;\n    }\n    catch(Exception e){}\n    return null;\n}\n</code></pre>\n"}],"owner":{"account_id":3209968,"reputation":1619,"user_id":2710154,"accept_rate":72,"display_name":"SSH"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":5893,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":3,"score":2,"last_activity_date":1684844508,"creation_date":1445864443,"question_id":33346429,"body_markdown":"I have written an API so that my different apps can use it.It simply checks whether app is registered with the server or not.If not then it generates Public/Private keypair,and got a signed certificate by sending CSR to my server. The next time it uses the signed certificate and private key. Initially I have default keystore file in raw ( b/c all my communication is over SSL i.e. initially with default keystore and after registration with user generated keystore)\r\n\r\nMy API is working fine. The issues I am having are somewhat related to my lack of knowledge or wrong approach and hence I need assistance.\r\n\r\nI am using the following class to save/retrieve my Keypair\r\n\r\n    public class KeyIOHandler {\r\n    \r\n    \r\n        public static void writePublicKeyToPreferences(KeyPair key, Context context) {\r\n            StringWriter publicStringWriter = new StringWriter();\r\n            try {\r\n                PemWriter pemWriter = new PemWriter(publicStringWriter);\r\n                pemWriter.writeObject(new PemObject(&quot;myapp.PUBLIC KEY&quot;, key.getPublic().getEncoded()));\r\n                pemWriter.flush();\r\n                pemWriter.close();\r\n                SharedPreferences preferences = context.getSharedPreferences(&quot;SHARED_PREFERENCES&quot;,0);\r\n                preferences.edit().putString(&quot;RSA_PUBLIC_KEY&quot;, publicStringWriter.toString()).commit();\r\n                Log.e(&quot;Public  Key&quot;, publicStringWriter.toString());\r\n            } catch (IOException e) {\r\n                Log.e(&quot;RSA&quot;, e.getMessage());\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n    \r\n        public static void writePrivateKeyToPreferences(KeyPair keyPair, Context context) {\r\n            StringWriter privateStringWriter = new StringWriter();\r\n            try {\r\n                PemWriter pemWriter = new PemWriter(privateStringWriter);\r\n                pemWriter.writeObject(new PemObject(&quot;myapp.PRIVATE KEY&quot;, keyPair.getPrivate().getEncoded()));\r\n                pemWriter.flush();\r\n                pemWriter.close();\r\n                SharedPreferences preferences = context.getSharedPreferences(&quot;SHARED_PREFERENCES&quot;,0);\r\n                preferences.edit().putString(&quot;RSA_PRIVATE_KEY&quot;, privateStringWriter.toString()).commit();\r\n                Log.e(&quot;Private Key&quot;,privateStringWriter.toString());\r\n            } catch (IOException e) {\r\n                Log.e(&quot;RSA&quot;, e.getMessage());\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n    \r\n        public static PublicKey getRSAPublicKeyFromString(String publicKeyPEM) throws Exception {\r\n            publicKeyPEM = stripPublicKeyHeaders(publicKeyPEM);\r\n            KeyFactory keyFactory = KeyFactory.getInstance(&quot;RSA&quot;, &quot;SC&quot;);\r\n            byte[] publicKeyBytes = Base64.decode(publicKeyPEM.getBytes(&quot;UTF-8&quot;));\r\n            X509EncodedKeySpec x509KeySpec = new X509EncodedKeySpec(publicKeyBytes);\r\n            return keyFactory.generatePublic(x509KeySpec);\r\n        }\r\n    \r\n        public static PrivateKey getRSAPrivateKeyFromString(String privateKeyPEM) throws Exception {\r\n            privateKeyPEM = stripPrivateKeyHeaders(privateKeyPEM);\r\n            KeyFactory fact = KeyFactory.getInstance(&quot;RSA&quot;, &quot;SC&quot;);\r\n            byte[] clear = Base64.decode(privateKeyPEM);\r\n            PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(clear);\r\n            PrivateKey priv = fact.generatePrivate(keySpec);\r\n            Arrays.fill(clear, (byte) 0);\r\n            return priv;\r\n        }\r\n    \r\n        public static String stripPublicKeyHeaders(String key) {\r\n            //strip the headers from the key string\r\n            StringBuilder strippedKey = new StringBuilder();\r\n            String lines[] = key.split(&quot;\\n&quot;);\r\n            for (String line : lines) {\r\n                if (!line.contains(&quot;BEGIN PUBLIC KEY&quot;) &amp;&amp; !line.contains(&quot;END PUBLIC KEY&quot;) &amp;&amp; !isNullOrEmpty(line.trim())) {\r\n                    strippedKey.append(line.trim());\r\n                }\r\n            }\r\n            return strippedKey.toString().trim();\r\n        }\r\n    \r\n        public static String stripPrivateKeyHeaders(String key) {\r\n            StringBuilder strippedKey = new StringBuilder();\r\n            String lines[] = key.split(&quot;\\n&quot;);\r\n            for (String line : lines) {\r\n                if (!line.contains(&quot;BEGIN PRIVATE KEY&quot;) &amp;&amp; !line.contains(&quot;END PRIVATE KEY&quot;) &amp;&amp; !isNullOrEmpty(line.trim())) {\r\n                    strippedKey.append(line.trim());\r\n                }\r\n            }\r\n            return strippedKey.toString().trim();\r\n        }\r\n    \r\n        public static boolean isNullOrEmpty(String str) {\r\n            return str == null || str.isEmpty();\r\n        }\r\n    }\r\n\r\nand by using the following method I am generating my keystore but I am confuse how and where I can store this keystore securely so that i can use it for the rest of app&#39;s life.(unless key is stolen). As in shared preferences I cannot store any object, so where to save this keystore.Right now I have static keystore object in my class.(which is worst I know but just to make it working i have made it static)\r\n\r\n    private boolean  addToStore(){\r\n            try {\r\n                Security.insertProviderAt(new org.spongycastle.jce.provider.BouncyCastleProvider(), 1);\r\n                clientPkcs12 = KeyStore.getInstance(&quot;PKCS12&quot;);\r\n                clientPkcs12.load(null, null);\r\n                clientPkcs12.setKeyEntry(&quot;clientCert&quot;, keyPair.getPrivate(), &quot;123456&quot;.toCharArray(), chain);\r\n            }\r\n            catch(Exception ex){\r\n                Log.e(&quot;&quot;,ex.getCause().getMessage());\r\n            }\r\n            return false;\r\n        }\r\n\r\nI have gone through few posts,among them this is noticeable one [nelenkov.blogspot][1] but not getting how can I achieve my target or am I wrong at saving keystore? I mean do I have to create keystore every time? \r\n\r\n\r\n  [1]: http://nelenkov.blogspot.fr/2012/05/storing-application-secrets-in-androids.html","title":"How can I save my keystore securely","body":"<p>I have written an API so that my different apps can use it.It simply checks whether app is registered with the server or not.If not then it generates Public/Private keypair,and got a signed certificate by sending CSR to my server. The next time it uses the signed certificate and private key. Initially I have default keystore file in raw ( b/c all my communication is over SSL i.e. initially with default keystore and after registration with user generated keystore)</p>\n\n<p>My API is working fine. The issues I am having are somewhat related to my lack of knowledge or wrong approach and hence I need assistance.</p>\n\n<p>I am using the following class to save/retrieve my Keypair</p>\n\n<pre><code>public class KeyIOHandler {\n\n\n    public static void writePublicKeyToPreferences(KeyPair key, Context context) {\n        StringWriter publicStringWriter = new StringWriter();\n        try {\n            PemWriter pemWriter = new PemWriter(publicStringWriter);\n            pemWriter.writeObject(new PemObject(\"myapp.PUBLIC KEY\", key.getPublic().getEncoded()));\n            pemWriter.flush();\n            pemWriter.close();\n            SharedPreferences preferences = context.getSharedPreferences(\"SHARED_PREFERENCES\",0);\n            preferences.edit().putString(\"RSA_PUBLIC_KEY\", publicStringWriter.toString()).commit();\n            Log.e(\"Public  Key\", publicStringWriter.toString());\n        } catch (IOException e) {\n            Log.e(\"RSA\", e.getMessage());\n            e.printStackTrace();\n        }\n    }\n\n    public static void writePrivateKeyToPreferences(KeyPair keyPair, Context context) {\n        StringWriter privateStringWriter = new StringWriter();\n        try {\n            PemWriter pemWriter = new PemWriter(privateStringWriter);\n            pemWriter.writeObject(new PemObject(\"myapp.PRIVATE KEY\", keyPair.getPrivate().getEncoded()));\n            pemWriter.flush();\n            pemWriter.close();\n            SharedPreferences preferences = context.getSharedPreferences(\"SHARED_PREFERENCES\",0);\n            preferences.edit().putString(\"RSA_PRIVATE_KEY\", privateStringWriter.toString()).commit();\n            Log.e(\"Private Key\",privateStringWriter.toString());\n        } catch (IOException e) {\n            Log.e(\"RSA\", e.getMessage());\n            e.printStackTrace();\n        }\n    }\n\n    public static PublicKey getRSAPublicKeyFromString(String publicKeyPEM) throws Exception {\n        publicKeyPEM = stripPublicKeyHeaders(publicKeyPEM);\n        KeyFactory keyFactory = KeyFactory.getInstance(\"RSA\", \"SC\");\n        byte[] publicKeyBytes = Base64.decode(publicKeyPEM.getBytes(\"UTF-8\"));\n        X509EncodedKeySpec x509KeySpec = new X509EncodedKeySpec(publicKeyBytes);\n        return keyFactory.generatePublic(x509KeySpec);\n    }\n\n    public static PrivateKey getRSAPrivateKeyFromString(String privateKeyPEM) throws Exception {\n        privateKeyPEM = stripPrivateKeyHeaders(privateKeyPEM);\n        KeyFactory fact = KeyFactory.getInstance(\"RSA\", \"SC\");\n        byte[] clear = Base64.decode(privateKeyPEM);\n        PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(clear);\n        PrivateKey priv = fact.generatePrivate(keySpec);\n        Arrays.fill(clear, (byte) 0);\n        return priv;\n    }\n\n    public static String stripPublicKeyHeaders(String key) {\n        //strip the headers from the key string\n        StringBuilder strippedKey = new StringBuilder();\n        String lines[] = key.split(\"\\n\");\n        for (String line : lines) {\n            if (!line.contains(\"BEGIN PUBLIC KEY\") &amp;&amp; !line.contains(\"END PUBLIC KEY\") &amp;&amp; !isNullOrEmpty(line.trim())) {\n                strippedKey.append(line.trim());\n            }\n        }\n        return strippedKey.toString().trim();\n    }\n\n    public static String stripPrivateKeyHeaders(String key) {\n        StringBuilder strippedKey = new StringBuilder();\n        String lines[] = key.split(\"\\n\");\n        for (String line : lines) {\n            if (!line.contains(\"BEGIN PRIVATE KEY\") &amp;&amp; !line.contains(\"END PRIVATE KEY\") &amp;&amp; !isNullOrEmpty(line.trim())) {\n                strippedKey.append(line.trim());\n            }\n        }\n        return strippedKey.toString().trim();\n    }\n\n    public static boolean isNullOrEmpty(String str) {\n        return str == null || str.isEmpty();\n    }\n}\n</code></pre>\n\n<p>and by using the following method I am generating my keystore but I am confuse how and where I can store this keystore securely so that i can use it for the rest of app's life.(unless key is stolen). As in shared preferences I cannot store any object, so where to save this keystore.Right now I have static keystore object in my class.(which is worst I know but just to make it working i have made it static)</p>\n\n<pre><code>private boolean  addToStore(){\n        try {\n            Security.insertProviderAt(new org.spongycastle.jce.provider.BouncyCastleProvider(), 1);\n            clientPkcs12 = KeyStore.getInstance(\"PKCS12\");\n            clientPkcs12.load(null, null);\n            clientPkcs12.setKeyEntry(\"clientCert\", keyPair.getPrivate(), \"123456\".toCharArray(), chain);\n        }\n        catch(Exception ex){\n            Log.e(\"\",ex.getCause().getMessage());\n        }\n        return false;\n    }\n</code></pre>\n\n<p>I have gone through few posts,among them this is noticeable one <a href=\"http://nelenkov.blogspot.fr/2012/05/storing-application-secrets-in-androids.html\" rel=\"nofollow\">nelenkov.blogspot</a> but not getting how can I achieve my target or am I wrong at saving keystore? I mean do I have to create keystore every time? </p>\n"},{"tags":["java","google-cloud-firestore"],"answers":[{"tags":[],"owner":{"account_id":2794316,"reputation":1918,"user_id":2403836,"accept_rate":72,"display_name":"mr nooby noob"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1684843983,"creation_date":1684321808,"answer_id":76271438,"question_id":76270754,"body_markdown":"I figured it out.\r\n\r\nI solved the warnings for my methods (isPresent and isEmpty) by adding the following annotation to each method \r\n`com.google.cloud.firestore.annotation.Exclude`.\r\n\r\nAs for the nested the other warning for the other field, it&#39;s not really related to any of this. \r\nBefore, I was storing my `Foo` object directly in the database, however I updated it to be a `MyOptional&lt;Foo&gt;` instead. I noticed that when fetching the object the first time I see all the warnings for each field, however, once the object is updated to the new type, I no longer see the warnings.","title":"Firestore: No setter/field for field for nested class","body":"<p>I figured it out.</p>\n<p>I solved the warnings for my methods (isPresent and isEmpty) by adding the following annotation to each method\n<code>com.google.cloud.firestore.annotation.Exclude</code>.</p>\n<p>As for the nested the other warning for the other field, it's not really related to any of this.\nBefore, I was storing my <code>Foo</code> object directly in the database, however I updated it to be a <code>MyOptional&lt;Foo&gt;</code> instead. I noticed that when fetching the object the first time I see all the warnings for each field, however, once the object is updated to the new type, I no longer see the warnings.</p>\n"}],"owner":{"account_id":2794316,"reputation":1918,"user_id":2403836,"accept_rate":72,"display_name":"mr nooby noob"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":27,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1684843983,"creation_date":1684316984,"question_id":76270754,"body_markdown":"I have a class, `MyOptional`, that contains a generic object, in this case `Foo`.\r\nI can see that I am seeing the following warnings in the logs\r\n\r\n    No setter/field for present found on class MyOptional (fields/setters are case sensitive!)\r\n    No setter/field for empty found on class MyOptional (fields/setters are case sensitive!)\r\n    //The above two are static methods, and the below ones are fields in Foo\r\n    No setter/field for f1 found on class MyOptional\r\n    No setter/field for f2 found on class MyOptional\r\n    ...as well as for all other fields\r\n\r\nThe classes look like so:\r\n\r\n    @Data\r\n    @NoArgsConstructor\r\n    @AllArgsConstructor\r\n    @JsonIgnoreProperties(ignoreUnknown = true)\r\n    public class MyOptional&lt;T&gt; {\r\n    \r\n      private static final FSOptional&lt;?&gt; EMPTY = new FSOptional&lt;&gt;(null);\r\n    \r\n      private T value;\r\n    \r\n      public static &lt;T&gt; FSOptional&lt;T&gt; empty() {\r\n        return (FSOptional&lt;T&gt;) EMPTY;\r\n      }\r\n    \r\n      public static &lt;T&gt; FSOptional&lt;T&gt; of(T t) {\r\n        return new FSOptional&lt;&gt;(t);\r\n      }\r\n    \r\n      public boolean isPresent() {\r\n        return value != null;\r\n      }\r\n    \r\n      public boolean isEmpty() {\r\n        return value == null;\r\n      }\r\n    }\r\n\r\nand\r\n\r\n    @Data\r\n    @Builder\r\n    @NoArgsConstructor\r\n    @AllArgsConstructor\r\n    @JsonIgnoreProperties(ignoreUnknown = true)\r\n    public class Foo {\r\n      private String f1;\r\n      private String f2;\r\n      ...\r\n    }\r\n\r\nI can see in the db that the data is being saved, however it does show the results/values of my two static methods (`isEmpty()` and `isPresent()` for `MyOptional`).\r\nHOWEVER, I do notice that the base object of the db is Foo instead of MyOptional...\r\n\r\n[![DB result][1]][1]\r\n\r\nI DO have the default constructor and the setters and getters via `@NoArgsConstructor` and `@Data`, for both objects, so I am confused why I am still seeing this warning...any idea why and how to fix it?\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/zAuOa.png","title":"Firestore: No setter/field for field for nested class","body":"<p>I have a class, <code>MyOptional</code>, that contains a generic object, in this case <code>Foo</code>.\nI can see that I am seeing the following warnings in the logs</p>\n<pre><code>No setter/field for present found on class MyOptional (fields/setters are case sensitive!)\nNo setter/field for empty found on class MyOptional (fields/setters are case sensitive!)\n//The above two are static methods, and the below ones are fields in Foo\nNo setter/field for f1 found on class MyOptional\nNo setter/field for f2 found on class MyOptional\n...as well as for all other fields\n</code></pre>\n<p>The classes look like so:</p>\n<pre><code>@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@JsonIgnoreProperties(ignoreUnknown = true)\npublic class MyOptional&lt;T&gt; {\n\n  private static final FSOptional&lt;?&gt; EMPTY = new FSOptional&lt;&gt;(null);\n\n  private T value;\n\n  public static &lt;T&gt; FSOptional&lt;T&gt; empty() {\n    return (FSOptional&lt;T&gt;) EMPTY;\n  }\n\n  public static &lt;T&gt; FSOptional&lt;T&gt; of(T t) {\n    return new FSOptional&lt;&gt;(t);\n  }\n\n  public boolean isPresent() {\n    return value != null;\n  }\n\n  public boolean isEmpty() {\n    return value == null;\n  }\n}\n</code></pre>\n<p>and</p>\n<pre><code>@Data\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\n@JsonIgnoreProperties(ignoreUnknown = true)\npublic class Foo {\n  private String f1;\n  private String f2;\n  ...\n}\n</code></pre>\n<p>I can see in the db that the data is being saved, however it does show the results/values of my two static methods (<code>isEmpty()</code> and <code>isPresent()</code> for <code>MyOptional</code>).\nHOWEVER, I do notice that the base object of the db is Foo instead of MyOptional...</p>\n<p><a href=\"https://i.stack.imgur.com/zAuOa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zAuOa.png\" alt=\"DB result\" /></a></p>\n<p>I DO have the default constructor and the setters and getters via <code>@NoArgsConstructor</code> and <code>@Data</code>, for both objects, so I am confused why I am still seeing this warning...any idea why and how to fix it?</p>\n"},{"tags":["java","soap","apache-axis"],"comments":[{"owner":{"account_id":984044,"reputation":1316,"user_id":1003009,"accept_rate":51,"display_name":"SJunejo"},"score":0,"creation_date":1462979458,"post_id":6840272,"comment_id":61868587,"body_markdown":"Did you find solution/exmaple for this? I am looking for the same...!","body":"Did you find solution/exmaple for this? I am looking for the same...!"}],"answers":[{"comments":[{"owner":{"account_id":371821,"reputation":2107,"user_id":720564,"accept_rate":77,"display_name":"WinOrWin"},"score":0,"creation_date":1311757360,"post_id":6840524,"comment_id":8132774,"body_markdown":"Thanks for the tips, I will try to avoid such designs in future. I cant use the tools you mentioned in your post - cant it be done with axis 2 only ?","body":"Thanks for the tips, I will try to avoid such designs in future. I cant use the tools you mentioned in your post - cant it be done with axis 2 only ?"},{"owner":{"account_id":30285,"reputation":55210,"user_id":82511,"accept_rate":71,"display_name":"djna"},"score":1,"creation_date":1311759885,"post_id":6840524,"comment_id":8133423,"body_markdown":"According  to the Axis 2 web site it can be done, but I failed to find any examples.","body":"According  to the Axis 2 web site it can be done, but I failed to find any examples."},{"owner":{"account_id":373060,"reputation":2543,"user_id":722466,"accept_rate":52,"display_name":"Abbadon"},"score":0,"creation_date":1464160978,"post_id":6840524,"comment_id":62364732,"body_markdown":"Are they any open source platform supporting WS-Atomic transactions? Are they any replacement propose for WS-Atomic transaction?","body":"Are they any open source platform supporting WS-Atomic transactions? Are they any replacement propose for WS-Atomic transaction?"}],"tags":[],"owner":{"account_id":30285,"reputation":55210,"user_id":82511,"accept_rate":71,"display_name":"djna"},"comment_count":3,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1311749825,"creation_date":1311749825,"answer_id":6840524,"question_id":6840272,"body_markdown":"\r\n\r\nYou may do better to use a JAX/WS implementation provided by a particular application server vendor. You can see tutorials such as [this][1].\r\n\r\nOne thing to be aware of is that distributed transactions may seem very attractive but they do add considerable operational complexity, especially in failure scenarios. \r\n\r\n 1. The Transaction manager&#39;s transaction logs become critical to managing consistency between systems. Lose those logs and you have the potential to lose knowledge of the outcome of a transaction.\r\n 2. You introduce coupling between systems that may have different availability characteristics. A system failure at just the right (or rather wrong) time will cause database locks to be held in one system until all systems are restored to service. To be specific, in the two-phase  protocol, after a resource (eg. Database) has &quot;voted&quot; in phase 1, it cannot resolve the transaction until the transaction manager decides the overall fate of the transaction by collecting votes from all participants. If one participant cannot be restored for a time then all locks held by that transaction are kept for that time. The only workaround is manual intervention (operational complexity) and potential inconsistency.\r\n\r\nIn summary, I would be reluctant to recommend the use of distributed transactions between systems that are in different operational domains (eg. different companies, or different geographies).\r\n \r\n\r\n  [1]: http://www.ibm.com/developerworks/websphere/library/techarticles/0707_lo/0707_lo.html","title":"WS-AtomicTransaction with Axis2","body":"<p>You may do better to use a JAX/WS implementation provided by a particular application server vendor. You can see tutorials such as <a href=\"http://www.ibm.com/developerworks/websphere/library/techarticles/0707_lo/0707_lo.html\" rel=\"nofollow\">this</a>.</p>\n\n<p>One thing to be aware of is that distributed transactions may seem very attractive but they do add considerable operational complexity, especially in failure scenarios. </p>\n\n<ol>\n<li>The Transaction manager's transaction logs become critical to managing consistency between systems. Lose those logs and you have the potential to lose knowledge of the outcome of a transaction.</li>\n<li>You introduce coupling between systems that may have different availability characteristics. A system failure at just the right (or rather wrong) time will cause database locks to be held in one system until all systems are restored to service. To be specific, in the two-phase  protocol, after a resource (eg. Database) has \"voted\" in phase 1, it cannot resolve the transaction until the transaction manager decides the overall fate of the transaction by collecting votes from all participants. If one participant cannot be restored for a time then all locks held by that transaction are kept for that time. The only workaround is manual intervention (operational complexity) and potential inconsistency.</li>\n</ol>\n\n<p>In summary, I would be reluctant to recommend the use of distributed transactions between systems that are in different operational domains (eg. different companies, or different geographies).</p>\n"},{"tags":[],"owner":{"account_id":5061907,"reputation":184,"user_id":4063222,"display_name":"Mathieu CARBONNEAUX"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684843071,"creation_date":1684843071,"answer_id":76314490,"question_id":6840272,"body_markdown":"Seem they tried to developpe WS-AT... but fail ?\r\nthe apache project seem implementing this are kandula2 at axis 2...\r\nhttps://svn.apache.org/repos/asf/axis/axis2/java/kandula/site/2/index.html","title":"WS-AtomicTransaction with Axis2","body":"<p>Seem they tried to developpe WS-AT... but fail ?\nthe apache project seem implementing this are kandula2 at axis 2...\n<a href=\"https://svn.apache.org/repos/asf/axis/axis2/java/kandula/site/2/index.html\" rel=\"nofollow noreferrer\">https://svn.apache.org/repos/asf/axis/axis2/java/kandula/site/2/index.html</a></p>\n"}],"owner":{"account_id":371821,"reputation":2107,"user_id":720564,"accept_rate":77,"display_name":"WinOrWin"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1608,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1684843071,"creation_date":1311748329,"question_id":6840272,"body_markdown":"I have been using Axis2 to genarate my web services. Some of my services are a part of transaction - i.e, either all or none of them have to be executed.\r\n\r\nTo solve my problem, I have been reading about the WS-AT specs over the web. But I am unable to figure out how to configure and use this feature with Axis2. Can anyone please share how to start off ? Any supporting code will be good.\r\n\r\nThanks!","title":"WS-AtomicTransaction with Axis2","body":"<p>I have been using Axis2 to genarate my web services. Some of my services are a part of transaction - i.e, either all or none of them have to be executed.</p>\n\n<p>To solve my problem, I have been reading about the WS-AT specs over the web. But I am unable to figure out how to configure and use this feature with Axis2. Can anyone please share how to start off ? Any supporting code will be good.</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","eclipse","basic"],"comments":[{"owner":{"account_id":2536623,"reputation":1158,"user_id":2203541,"accept_rate":86,"display_name":"mlwn"},"score":0,"creation_date":1410109463,"post_id":25712690,"comment_id":40194076,"body_markdown":"Java uses Classes ...","body":"Java uses Classes ..."}],"answers":[{"comments":[{"owner":{"account_id":2536623,"reputation":1158,"user_id":2203541,"accept_rate":86,"display_name":"mlwn"},"score":0,"creation_date":1410109680,"post_id":25712743,"comment_id":40194134,"body_markdown":"#ErstwhileIII, did you mean to close the bracket in the end ?","body":"#ErstwhileIII, did you mean to close the bracket in the end ?"},{"owner":{"display_name":"user1148358"},"score":0,"creation_date":1410110877,"post_id":25712743,"comment_id":40194494,"body_markdown":"Yes, I thought this was the case;  my final question would be do I need to add this in a new Class file?  I am just thinking that If I need to include another Class (e.g. vector is one with direction/value held separately), do I need a new class file?  I am be talking complete nonsense here...","body":"Yes, I thought this was the case;  my final question would be do I need to add this in a new Class file?  I am just thinking that If I need to include another Class (e.g. vector is one with direction/value held separately), do I need a new class file?  I am be talking complete nonsense here..."}],"tags":[],"owner":{"account_id":2320529,"reputation":4829,"user_id":2036397,"accept_rate":33,"display_name":"ErstwhileIII"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1410114350,"creation_date":1410109537,"answer_id":25712743,"question_id":25712690,"body_markdown":"If you are asking what the `Java` class definition would look like, then consider the following:\r\n\r\n    public class CustomPoint {\r\n        // Object fields\r\n        float dX;\r\n        float dY;\r\n        float dZ;\r\n        float vector;\r\n        public CustomPoint() {}\r\n    \r\n    //// CustomPoint methods\r\n    }","title":"What is the equivalent of Visual Basic Type in Android Java","body":"<p>If you are asking what the <code>Java</code> class definition would look like, then consider the following:</p>\n\n<pre><code>public class CustomPoint {\n    // Object fields\n    float dX;\n    float dY;\n    float dZ;\n    float vector;\n    public CustomPoint() {}\n\n//// CustomPoint methods\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":166521,"reputation":30443,"user_id":390695,"accept_rate":72,"display_name":"Damian Leszczyński - Vash"},"score":0,"creation_date":1410109682,"post_id":25712756,"comment_id":40194136,"body_markdown":"Java requires types also in ct.","body":"Java requires types also in ct."},{"owner":{"account_id":2536623,"reputation":1158,"user_id":2203541,"accept_rate":86,"display_name":"mlwn"},"score":0,"creation_date":1410109837,"post_id":25712756,"comment_id":40194183,"body_markdown":"public CustomPoint(float x, float y, float z, float v) { ... }","body":"public CustomPoint(float x, float y, float z, float v) { ... }"}],"tags":[],"owner":{"account_id":4137311,"reputation":961,"user_id":3393666,"display_name":"kevinkl3"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1410110466,"creation_date":1410109653,"answer_id":25712756,"question_id":25712690,"body_markdown":"Visual basic Types can be seen more as C&#39;s structs, in java (since is OOP) you can create a class to do same, something like this:\r\n\r\n    class CustomPoint{\r\n    \tfloat Dx;\r\n    \tfloat Dy;\r\n    \tfloat Dz;\r\n    \tfloat vector;\r\n    \r\n    \tpublic CustomPoint(float x, float y, float z, float v){\r\n    \t\tDx = x;\r\n    \t\tDy = y;\r\n    \t\tDz = z;\r\n    \t\tvector = v;\r\n    \t}\r\n    \r\n    }","title":"What is the equivalent of Visual Basic Type in Android Java","body":"<p>Visual basic Types can be seen more as C's structs, in java (since is OOP) you can create a class to do same, something like this:</p>\n\n<pre><code>class CustomPoint{\n    float Dx;\n    float Dy;\n    float Dz;\n    float vector;\n\n    public CustomPoint(float x, float y, float z, float v){\n        Dx = x;\n        Dy = y;\n        Dz = z;\n        vector = v;\n    }\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":26479658,"reputation":21,"user_id":20119095,"display_name":"IROSH LASHAN"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684842961,"creation_date":1684842961,"answer_id":76314475,"question_id":25712690,"body_markdown":"    public class CustomPoint {\r\n        private float dx;\r\n        private float dy;\r\n        private float dz;\r\n        private float vector;\r\n        \r\n        public CustomPoint(float dx, float dy, float dz, float vector) {\r\n            this.dx = dx;\r\n            this.dy = dy;\r\n            this.dz = dz;\r\n            this.vector = vector;\r\n        }\r\n        \r\n        public float getDx() {\r\n            return dx;\r\n        }\r\n        \r\n        public void setDx(float dx) {\r\n            this.dx = dx;\r\n        }\r\n        \r\n        public float getDy() {\r\n            return dy;\r\n        }\r\n        \r\n        public void setDy(float dy) {\r\n            this.dy = dy;\r\n        }\r\n        \r\n        public float getDz() {\r\n            return dz;\r\n        }\r\n        \r\n        public void setDz(float dz) {\r\n            this.dz = dz;\r\n        }\r\n        \r\n        public float getVector() {\r\n            return vector;\r\n        }\r\n        \r\n        public void setVector(float vector) {\r\n            this.vector = vector;\r\n        }\r\n    }\r\n\r\n","title":"What is the equivalent of Visual Basic Type in Android Java","body":"<pre><code>public class CustomPoint {\n    private float dx;\n    private float dy;\n    private float dz;\n    private float vector;\n    \n    public CustomPoint(float dx, float dy, float dz, float vector) {\n        this.dx = dx;\n        this.dy = dy;\n        this.dz = dz;\n        this.vector = vector;\n    }\n    \n    public float getDx() {\n        return dx;\n    }\n    \n    public void setDx(float dx) {\n        this.dx = dx;\n    }\n    \n    public float getDy() {\n        return dy;\n    }\n    \n    public void setDy(float dy) {\n        this.dy = dy;\n    }\n    \n    public float getDz() {\n        return dz;\n    }\n    \n    public void setDz(float dz) {\n        this.dz = dz;\n    }\n    \n    public float getVector() {\n        return vector;\n    }\n    \n    public void setVector(float vector) {\n        this.vector = vector;\n    }\n}\n</code></pre>\n"}],"owner":{"display_name":"user1148358"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":230,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":3,"score":0,"last_activity_date":1684842961,"creation_date":1410109264,"question_id":25712690,"body_markdown":"This has to the simplest question on stackOverflow, but I am a complete beginner; sorry.\r\n\r\nCan anyone tell me how to declare a custom Type.\r\n\r\nIn VB, I would do:\r\n\r\n    Private Type CustomPoint\r\n        Dx as Single\r\n        Dy as Single\r\n        Dz as Single\r\n        Vector as Single\r\n    End Type\r\n\r\nHow would I do the same on Eclipse?  Do I need to create a new class for this?\r\n\r\nThank a lot for helping!","title":"What is the equivalent of Visual Basic Type in Android Java","body":"<p>This has to the simplest question on stackOverflow, but I am a complete beginner; sorry.</p>\n\n<p>Can anyone tell me how to declare a custom Type.</p>\n\n<p>In VB, I would do:</p>\n\n<pre><code>Private Type CustomPoint\n    Dx as Single\n    Dy as Single\n    Dz as Single\n    Vector as Single\nEnd Type\n</code></pre>\n\n<p>How would I do the same on Eclipse?  Do I need to create a new class for this?</p>\n\n<p>Thank a lot for helping!</p>\n"},{"tags":["java","code-generation","jooq"],"comments":[{"owner":{"account_id":247217,"reputation":213465,"user_id":521799,"accept_rate":89,"display_name":"Lukas Eder"},"score":0,"creation_date":1462365136,"post_id":37021579,"comment_id":61605631,"body_markdown":"Will you have `CUSTOMER1` and `CUSTOMER2` in a single query, or are those mutually exclusive tenants that appear only once per query?","body":"Will you have <code>CUSTOMER1</code> and <code>CUSTOMER2</code> in a single query, or are those mutually exclusive tenants that appear only once per query?"},{"owner":{"account_id":224454,"reputation":9570,"user_id":484293,"accept_rate":97,"display_name":"blubb"},"score":0,"creation_date":1462378185,"post_id":37021579,"comment_id":61615897,"body_markdown":"@Lukas Eder: thanks, I updated the question.","body":"@Lukas Eder: thanks, I updated the question."}],"answers":[{"comments":[{"owner":{"account_id":224454,"reputation":9570,"user_id":484293,"accept_rate":97,"display_name":"blubb"},"score":0,"creation_date":1462387986,"post_id":37033418,"comment_id":61621801,"body_markdown":"Thanks Lukas. Knowing that `Table.rename()` will come in 3.9, I will go with the reflection hack for now, since it is easier to migrate later on.","body":"Thanks Lukas. Knowing that <code>Table.rename()</code> will come in 3.9, I will go with the reflection hack for now, since it is easier to migrate later on."},{"owner":{"account_id":80581,"reputation":3955,"user_id":227779,"accept_rate":38,"display_name":"Per Lundberg"},"score":0,"creation_date":1651826603,"post_id":37033418,"comment_id":127460832,"body_markdown":"I really like the &quot;the answer to your question&quot; and &quot;the answer to your problem&quot; approach taken here. :) Sometimes, you simply don&#39;t know what you are doing well enough to be able to ask the right question...","body":"I really like the &quot;the answer to your question&quot; and &quot;the answer to your problem&quot; approach taken here. :) Sometimes, you simply don&#39;t know what you are doing well enough to be able to ask the right question..."},{"owner":{"account_id":247217,"reputation":213465,"user_id":521799,"accept_rate":89,"display_name":"Lukas Eder"},"score":1,"creation_date":1651829340,"post_id":37033418,"comment_id":127461874,"body_markdown":"@PerLundberg: It has a name: https://xyproblem.info. It&#39;s still a useful question, though. People will find the `rename()` method and think &quot;this is for me&quot;. But then, it doesn&#39;t do exactly what they want, so they google `rename()` to see what options they have. It&#39;s one way of discovering the feature whose name they didn&#39;t know, &quot;schema mapping.&quot;","body":"@PerLundberg: It has a name: <a href=\"https://xyproblem.info\" rel=\"nofollow noreferrer\">xyproblem.info</a>. It&#39;s still a useful question, though. People will find the <code>rename()</code> method and think &quot;this is for me&quot;. But then, it doesn&#39;t do exactly what they want, so they google <code>rename()</code> to see what options they have. It&#39;s one way of discovering the feature whose name they didn&#39;t know, &quot;schema mapping.&quot;"},{"owner":{"account_id":80581,"reputation":3955,"user_id":227779,"accept_rate":38,"display_name":"Per Lundberg"},"score":0,"creation_date":1651835968,"post_id":37033418,"comment_id":127464155,"body_markdown":"Yeah, good points. As for myself, I stumbled upon the `rename()` method by coincidence when I was in fact looking for table-aliasing using `as()`....:-D","body":"Yeah, good points. As for myself, I stumbled upon the <code>rename()</code> method by coincidence when I was in fact looking for table-aliasing using <code>as()</code>....:-D"},{"owner":{"account_id":247217,"reputation":213465,"user_id":521799,"accept_rate":89,"display_name":"Lukas Eder"},"score":0,"creation_date":1651844898,"post_id":37033418,"comment_id":127467496,"body_markdown":"@PerLundberg: And then, you came here, in awe of what&#39;s possible :) (or, wondering, what you were originally looking for before all of this distraction)","body":"@PerLundberg: And then, you came here, in awe of what&#39;s possible :) (or, wondering, what you were originally looking for before all of this distraction)"},{"owner":{"account_id":80581,"reputation":3955,"user_id":227779,"accept_rate":38,"display_name":"Per Lundberg"},"score":0,"creation_date":1652169196,"post_id":37033418,"comment_id":127534564,"body_markdown":"@LukasEder Something like that yes. :)","body":"@LukasEder Something like that yes. :)"}],"tags":[],"owner":{"account_id":247217,"reputation":213465,"user_id":521799,"accept_rate":89,"display_name":"Lukas Eder"},"comment_count":6,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1684842585,"creation_date":1462379759,"answer_id":37033418,"question_id":37021579,"body_markdown":"### The answer to your question\r\n\r\nThe question being in the title:\r\n\r\n&gt; why is there no Table.rename(String)?\r\n\r\nThe feature was implemented in jOOQ 3.3 ([#2921][1]). The issue reads:\r\n\r\n&gt; As table renaming is not really a SQL DSL feature, the rename() method should be generated onto generated tables only, instead of being declared in org.jooq.Table\r\n\r\nIn fact, this argument doesn&#39;t really make much sense. There are other &quot;non-DSL&quot; utilities on the DSL types. I don&#39;t see why `rename()` is special. The method should be declared on `Table` as you suggested. This might be done in the future ([#13937][2]).\r\n\r\n### The answer to your problem\r\n\r\nFrom the update of your question, I understand that you don&#39;t really need that fine-grained renaming control. jOOQ&#39;s out of the box multi-tenancy feature will do. This is called &quot;table mapping&quot; in the manual:\r\n\r\nhttp://www.jooq.org/doc/latest/manual/sql-building/dsl-context/runtime-schema-mapping\r\n\r\nFor the scope of a `Configuration` (most fine-grained scope: per-query level), you can rewrite any matching table name as such:\r\n\r\n    Settings settings = new Settings()\r\n        .withRenderMapping(new RenderMapping()\r\n        .withSchemata(\r\n            new MappedSchema().withInput(&quot;MY_SCHEMA&quot;)\r\n                              .withOutput(&quot;MY_SCHEMA&quot;)\r\n                              .withTables(\r\n             new MappedTable().withInput(&quot;CUSTOMER&quot;)\r\n                              .withOutput(&quot;CUSTOMER1&quot;))));\r\n\r\n\r\n  [1]: https://github.com/jOOQ/jOOQ/issues/2921\r\n  [2]: https://github.com/jOOQ/jOOQ/issues/13937","title":"JOOQ Metamodel: why is there no Table.rename(String)?","body":"<h3>The answer to your question</h3>\n<p>The question being in the title:</p>\n<blockquote>\n<p>why is there no Table.rename(String)?</p>\n</blockquote>\n<p>The feature was implemented in jOOQ 3.3 (<a href=\"https://github.com/jOOQ/jOOQ/issues/2921\" rel=\"nofollow noreferrer\">#2921</a>). The issue reads:</p>\n<blockquote>\n<p>As table renaming is not really a SQL DSL feature, the rename() method should be generated onto generated tables only, instead of being declared in org.jooq.Table</p>\n</blockquote>\n<p>In fact, this argument doesn't really make much sense. There are other &quot;non-DSL&quot; utilities on the DSL types. I don't see why <code>rename()</code> is special. The method should be declared on <code>Table</code> as you suggested. This might be done in the future (<a href=\"https://github.com/jOOQ/jOOQ/issues/13937\" rel=\"nofollow noreferrer\">#13937</a>).</p>\n<h3>The answer to your problem</h3>\n<p>From the update of your question, I understand that you don't really need that fine-grained renaming control. jOOQ's out of the box multi-tenancy feature will do. This is called &quot;table mapping&quot; in the manual:</p>\n<p><a href=\"http://www.jooq.org/doc/latest/manual/sql-building/dsl-context/runtime-schema-mapping\" rel=\"nofollow noreferrer\">http://www.jooq.org/doc/latest/manual/sql-building/dsl-context/runtime-schema-mapping</a></p>\n<p>For the scope of a <code>Configuration</code> (most fine-grained scope: per-query level), you can rewrite any matching table name as such:</p>\n<pre><code>Settings settings = new Settings()\n    .withRenderMapping(new RenderMapping()\n    .withSchemata(\n        new MappedSchema().withInput(&quot;MY_SCHEMA&quot;)\n                          .withOutput(&quot;MY_SCHEMA&quot;)\n                          .withTables(\n         new MappedTable().withInput(&quot;CUSTOMER&quot;)\n                          .withOutput(&quot;CUSTOMER1&quot;))));\n</code></pre>\n"}],"owner":{"account_id":224454,"reputation":9570,"user_id":484293,"accept_rate":97,"display_name":"blubb"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":553,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"accepted_answer_id":37033418,"answer_count":1,"score":4,"last_activity_date":1684842585,"creation_date":1462348113,"question_id":37021579,"body_markdown":"I am dynamically creating and using physical DB tables for which I only have one metamodel object. An example: I have one JOOQ class `Customer` in my metamodel, but I have `CUSTOMER1`, `CUSTOMER2`, etc. at runtime. I&#39;d like to write strongly typed JOOQ queries for these dynamic tables. The following seems to do the trick:\r\n\r\n    Customer CUSTOMER1 = Customer.rename(&quot;CUSTOMER1&quot;)\r\n\r\nOf course, there&#39;s a whole bunch of tables for which I need to do this. Unfortunately, I cannot leverage the `rename` method generically, because it is not part of the `Table&lt;R&gt;` interface. Is this an oversight or a deliberate measure against something I am missing?\r\n\r\nIs there a robust and elegant way to achieve what I want, i.e. without resorting to reflection?\r\n\r\n*EDIT*: the two tables are never used jointly in the same query. Concrete usage pattern is the following: At any given moment, a DB synonym `CUSTOMER` will point to one (the active), while the other is being modified (the shadow copy). Once the modification is complete, roles are swapped by pointing the synonym at the other one, and we start over. We do this to minimize &quot;downtime&quot; of heavy reporting result tables. ","title":"JOOQ Metamodel: why is there no Table.rename(String)?","body":"<p>I am dynamically creating and using physical DB tables for which I only have one metamodel object. An example: I have one JOOQ class <code>Customer</code> in my metamodel, but I have <code>CUSTOMER1</code>, <code>CUSTOMER2</code>, etc. at runtime. I'd like to write strongly typed JOOQ queries for these dynamic tables. The following seems to do the trick:</p>\n\n<pre><code>Customer CUSTOMER1 = Customer.rename(\"CUSTOMER1\")\n</code></pre>\n\n<p>Of course, there's a whole bunch of tables for which I need to do this. Unfortunately, I cannot leverage the <code>rename</code> method generically, because it is not part of the <code>Table&lt;R&gt;</code> interface. Is this an oversight or a deliberate measure against something I am missing?</p>\n\n<p>Is there a robust and elegant way to achieve what I want, i.e. without resorting to reflection?</p>\n\n<p><em>EDIT</em>: the two tables are never used jointly in the same query. Concrete usage pattern is the following: At any given moment, a DB synonym <code>CUSTOMER</code> will point to one (the active), while the other is being modified (the shadow copy). Once the modification is complete, roles are swapped by pointing the synonym at the other one, and we start over. We do this to minimize \"downtime\" of heavy reporting result tables. </p>\n"},{"tags":["java","java-8","java-stream"],"comments":[{"owner":{"account_id":173890,"reputation":30412,"user_id":402884,"accept_rate":75,"display_name":"Chris Martin"},"score":72,"creation_date":1414796202,"post_id":26684562,"comment_id":41967341,"body_markdown":"The type signature kinda tells the whole story. `map :: Stream T -&gt; (T -&gt; R) -&gt; Stream R`, `flatMap :: Stream T -&gt; (T -&gt; Stream R) -&gt; Stream R`.","body":"The type signature kinda tells the whole story. <code>map :: Stream T -&gt; (T -&gt; R) -&gt; Stream R</code>, <code>flatMap :: Stream T -&gt; (T -&gt; Stream R) -&gt; Stream R</code>."},{"owner":{"account_id":43736,"reputation":9289,"user_id":127971,"display_name":"michael"},"score":159,"creation_date":1500309222,"post_id":26684562,"comment_id":77267808,"body_markdown":"fwiw, those type signatures don&#39;t even look like Java. (I know, I know -- but to say it tells &quot;the whole story&quot; wrt map/flatMap assumes a lot of knowledge about the new &amp; improved &quot;Java++&quot;)","body":"fwiw, those type signatures don&#39;t even look like Java. (I know, I know -- but to say it tells &quot;the whole story&quot; wrt map/flatMap assumes a lot of knowledge about the new &amp; improved &quot;Java++&quot;)"},{"owner":{"account_id":1548079,"reputation":128727,"user_id":1441122,"display_name":"Stuart Marks"},"score":19,"creation_date":1500514448,"post_id":26684562,"comment_id":77374110,"body_markdown":"@michael That type signature looks like Haskell, not Java. But it&#39;s not clear whether the actual Java signature is any more readable: `&lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T,? extends Stream&lt;? extends R&gt;&gt; mapper)`.","body":"@michael That type signature looks like Haskell, not Java. But it&#39;s not clear whether the actual Java signature is any more readable: <code>&lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T,? extends Stream&lt;? extends R&gt;&gt; mapper)</code>."},{"owner":{"account_id":43736,"reputation":9289,"user_id":127971,"display_name":"michael"},"score":17,"creation_date":1500556776,"post_id":26684562,"comment_id":77397998,"body_markdown":"Ha, yeah, I was referring to the &quot;actual Java&quot;. Like C++, modern Java is almost unrecognizable to anyone who started using it in the 90s (like I did, both languages). Just replying to the comment, that method signatures hardly tell a &quot;whole story&quot;, at least not anymore, not without additional exposition (or in that commenters case, translation).","body":"Ha, yeah, I was referring to the &quot;actual Java&quot;. Like C++, modern Java is almost unrecognizable to anyone who started using it in the 90s (like I did, both languages). Just replying to the comment, that method signatures hardly tell a &quot;whole story&quot;, at least not anymore, not without additional exposition (or in that commenters case, translation)."},{"owner":{"account_id":2732025,"reputation":429,"user_id":2355587,"display_name":"derekm"},"score":5,"creation_date":1520450452,"post_id":26684562,"comment_id":85324611,"body_markdown":"Which is to say, a `map`&#39;s mapper lambda returns `R`, a `flatMap`&#39;s mapper lambda returns a `Stream` of `R` (`Stream&lt;R&gt;`). The streams returned by the `flatMap`&#39;s mapper are effectively concatenated. Otherwise, both `map` and `flatMap` return `Stream&lt;R&gt;`; the difference is what the mapper lambdas return, `R` vs. `Stream&lt;R&gt;`.","body":"Which is to say, a <code>map</code>&#39;s mapper lambda returns <code>R</code>, a <code>flatMap</code>&#39;s mapper lambda returns a <code>Stream</code> of <code>R</code> (<code>Stream&lt;R&gt;</code>). The streams returned by the <code>flatMap</code>&#39;s mapper are effectively concatenated. Otherwise, both <code>map</code> and <code>flatMap</code> return <code>Stream&lt;R&gt;</code>; the difference is what the mapper lambdas return, <code>R</code> vs. <code>Stream&lt;R&gt;</code>."},{"owner":{"account_id":4325247,"reputation":12424,"user_id":4390212,"accept_rate":74,"display_name":"DimaSan"},"score":2,"creation_date":1560290948,"post_id":26684562,"comment_id":99686124,"body_markdown":"Use `map` if each element is transformed into a single value. Use `flatMap` if each element will be transformed to multiple values and the resulting stream needs to be flattened.","body":"Use <code>map</code> if each element is transformed into a single value. Use <code>flatMap</code> if each element will be transformed to multiple values and the resulting stream needs to be flattened."}],"answers":[{"comments":[{"owner":{"account_id":4826640,"reputation":25377,"user_id":3895960,"accept_rate":97,"display_name":"Dici"},"score":10,"creation_date":1566663733,"post_id":26684582,"comment_id":101731155,"body_markdown":"Haha, to be fair I&#39;m still surprised to see how much traffic this question gets. Another funny observation is that it&#39;s been almost 5 years I wrote this answer and there&#39;s been a fairly consistent pattern of upvoting where the accepted answer gets roughly two upvotes for every one my answer gets. It&#39;s surprisingly consistent.","body":"Haha, to be fair I&#39;m still surprised to see how much traffic this question gets. Another funny observation is that it&#39;s been almost 5 years I wrote this answer and there&#39;s been a fairly consistent pattern of upvoting where the accepted answer gets roughly two upvotes for every one my answer gets. It&#39;s surprisingly consistent."},{"owner":{"account_id":2983257,"reputation":3053,"user_id":2532762,"accept_rate":44,"display_name":"1mike12"},"score":9,"creation_date":1572832250,"post_id":26684582,"comment_id":103671439,"body_markdown":"how is this not the accepted answer, thank for getting straight to the point and putting a very simple example","body":"how is this not the accepted answer, thank for getting straight to the point and putting a very simple example"},{"owner":{"account_id":14901094,"reputation":642,"user_id":13989422,"display_name":"Morteza"},"score":6,"creation_date":1597416975,"post_id":26684582,"comment_id":112134471,"body_markdown":"I believe this answer is concise and logically better explained than the accepted one.","body":"I believe this answer is concise and logically better explained than the accepted one."},{"owner":{"account_id":1648470,"reputation":168,"user_id":1519522,"display_name":"aff"},"score":3,"creation_date":1603683871,"post_id":26684582,"comment_id":114104414,"body_markdown":"This answer is short and practical. The accepted (Stuart&#39;s) answer added an explanation on _why is that kind of method (`flatMap`) needed?_ Each answer cater for different types of answer that the community may seek.","body":"This answer is short and practical. The accepted (Stuart&#39;s) answer added an explanation on <i>why is that kind of method (<code>flatMap</code>) needed?</i> Each answer cater for different types of answer that the community may seek."},{"owner":{"account_id":2860652,"reputation":2176,"user_id":2455994,"display_name":"Jayavignesh Vicky"},"score":0,"creation_date":1625455266,"post_id":26684582,"comment_id":120622950,"body_markdown":"sleek way of explaining","body":"sleek way of explaining"},{"owner":{"account_id":16720659,"reputation":408,"user_id":12085680,"display_name":"BugsOverflow"},"score":0,"creation_date":1679108133,"post_id":26684582,"comment_id":133666932,"body_markdown":"What is the use case of the flatMap? At the end I just want to collect it so I do not see why flatten it if at the end it will be a list or another collection, performance? map.collect vs flatMap.collect","body":"What is the use case of the flatMap? At the end I just want to collect it so I do not see why flatten it if at the end it will be a list or another collection, performance? map.collect vs flatMap.collect"},{"owner":{"account_id":4826640,"reputation":25377,"user_id":3895960,"accept_rate":97,"display_name":"Dici"},"score":0,"creation_date":1679256406,"post_id":26684582,"comment_id":133684635,"body_markdown":"If you collect it without flattening you&#39;ll get a list of lists (for example), which is not as easy to manipulate if all you care about are the values in the lists. If each list represents stronger concept like a cart of items or something like that, then keeping the items grouped in separate collections can make sense.","body":"If you collect it without flattening you&#39;ll get a list of lists (for example), which is not as easy to manipulate if all you care about are the values in the lists. If each list represents stronger concept like a cart of items or something like that, then keeping the items grouped in separate collections can make sense."}],"tags":[],"owner":{"account_id":4826640,"reputation":25377,"user_id":3895960,"accept_rate":97,"display_name":"Dici"},"comment_count":7,"down_vote_count":2,"up_vote_count":820,"is_accepted":false,"score":818,"last_activity_date":1463521417,"creation_date":1414796163,"answer_id":26684582,"question_id":26684562,"body_markdown":"`Stream.flatMap`, as it can be guessed by its name, is the combination of a `map` and a `flat` operation. That means that you first apply a function to your elements, and then flatten it. `Stream.map` only applies a function to the stream without flattening the stream.\r\n\r\nTo understand what *flattening* a stream consists in, consider a structure like `[ [1,2,3],[4,5,6],[7,8,9] ]` which has &quot;two levels&quot;. Flattening this means transforming it in a &quot;one level&quot; structure : `[ 1,2,3,4,5,6,7,8,9 ]`.","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p><code>Stream.flatMap</code>, as it can be guessed by its name, is the combination of a <code>map</code> and a <code>flat</code> operation. That means that you first apply a function to your elements, and then flatten it. <code>Stream.map</code> only applies a function to the stream without flattening the stream.</p>\n\n<p>To understand what <em>flattening</em> a stream consists in, consider a structure like <code>[ [1,2,3],[4,5,6],[7,8,9] ]</code> which has \"two levels\". Flattening this means transforming it in a \"one level\" structure : <code>[ 1,2,3,4,5,6,7,8,9 ]</code>.</p>\n"},{"comments":[{"owner":{"account_id":37484,"reputation":27768,"user_id":107158,"accept_rate":87,"display_name":"Derek Mahar"},"score":0,"creation_date":1544629836,"post_id":26684611,"comment_id":94345771,"body_markdown":"Why would you want to &quot;return any number of objects for each input object (including none)&quot;?","body":"Why would you want to &quot;return any number of objects for each input object (including none)&quot;?"},{"owner":{"account_id":1777092,"reputation":68282,"user_id":1620671,"accept_rate":87,"display_name":"Philipp"},"score":4,"creation_date":1544631109,"post_id":26684611,"comment_id":94346580,"body_markdown":"@DerekMahar There would be plenty of use-cases for this. For example, let&#39;s say you have a stream of `Department`s in your organization. Each department has between 0 and n `Employee`s. What you need is a stream of all employees. So what do you do? You write a flatMap method which takes a department and returns a stream of its employees.","body":"@DerekMahar There would be plenty of use-cases for this. For example, let&#39;s say you have a stream of <code>Department</code>s in your organization. Each department has between 0 and n <code>Employee</code>s. What you need is a stream of all employees. So what do you do? You write a flatMap method which takes a department and returns a stream of its employees."},{"owner":{"account_id":37484,"reputation":27768,"user_id":107158,"accept_rate":87,"display_name":"Derek Mahar"},"score":0,"creation_date":1544635047,"post_id":26684611,"comment_id":94348722,"body_markdown":"Philipp, does your example illustrate the main reason to use `flatMap`?  I suspect that it may be incidental and doesn&#39;t illustrate the key use case or reason why `flatMap` exists.  (Continued below...)","body":"Philipp, does your example illustrate the main reason to use <code>flatMap</code>?  I suspect that it may be incidental and doesn&#39;t illustrate the key use case or reason why <code>flatMap</code> exists.  (Continued below...)"},{"owner":{"account_id":37484,"reputation":27768,"user_id":107158,"accept_rate":87,"display_name":"Derek Mahar"},"score":0,"creation_date":1544635073,"post_id":26684611,"comment_id":94348739,"body_markdown":"After reading https://dzone.com/articles/understanding-flatmap, I think the main motivation behind `flatMap` is to accommodate errors that would be present when using `map`.  How do you handle cases where one or more items in the original set cannot be mapped to an output item?  By introducing an intermediate set (say an `Optional` or `Stream`) for each input object, `flatMap` allows you to exclude the &quot;invalid&quot; input objects (or the so called &quot;bad apples&quot; in the spirit of https://stackoverflow.com/a/52248643/107158) from the final set.","body":"After reading <a href=\"https://dzone.com/articles/understanding-flatmap\" rel=\"nofollow noreferrer\">dzone.com/articles/understanding-flatmap</a>, I think the main motivation behind <code>flatMap</code> is to accommodate errors that would be present when using <code>map</code>.  How do you handle cases where one or more items in the original set cannot be mapped to an output item?  By introducing an intermediate set (say an <code>Optional</code> or <code>Stream</code>) for each input object, <code>flatMap</code> allows you to exclude the &quot;invalid&quot; input objects (or the so called &quot;bad apples&quot; in the spirit of <a href=\"https://stackoverflow.com/a/52248643/107158\">stackoverflow.com/a/52248643/107158</a>) from the final set."},{"owner":{"account_id":1777092,"reputation":68282,"user_id":1620671,"accept_rate":87,"display_name":"Philipp"},"score":1,"creation_date":1544635283,"post_id":26684611,"comment_id":94348866,"body_markdown":"@DerekMahar Yes, stuations where each input-object might or might not return an output-object is another good use-case for flat-map.","body":"@DerekMahar Yes, stuations where each input-object might or might not return an output-object is another good use-case for flat-map."},{"owner":{"account_id":1777092,"reputation":68282,"user_id":1620671,"accept_rate":87,"display_name":"Philipp"},"score":0,"creation_date":1698417287,"post_id":26684611,"comment_id":136407079,"body_markdown":"@DerekMahar Although usually you would use the method `stream.filter` for that.","body":"@DerekMahar Although usually you would use the method <code>stream.filter</code> for that."}],"tags":[],"owner":{"account_id":1777092,"reputation":68282,"user_id":1620671,"accept_rate":87,"display_name":"Philipp"},"comment_count":6,"down_vote_count":1,"up_vote_count":55,"is_accepted":false,"score":54,"last_activity_date":1414796336,"creation_date":1414796336,"answer_id":26684611,"question_id":26684562,"body_markdown":"The function you pass to `stream.map` has to return one object. That means each object in the input stream results in exactly one object in the output stream.\r\n\r\nThe function you pass to `stream.flatMap` returns a stream for each object. That means the function can return any number of objects for each input object (including none). The resulting streams are then concatenated to one output stream.","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>The function you pass to <code>stream.map</code> has to return one object. That means each object in the input stream results in exactly one object in the output stream.</p>\n\n<p>The function you pass to <code>stream.flatMap</code> returns a stream for each object. That means the function can return any number of objects for each input object (including none). The resulting streams are then concatenated to one output stream.</p>\n"},{"comments":[{"owner":{"account_id":4751155,"reputation":4879,"user_id":3841161,"display_name":"coladict"},"score":42,"creation_date":1495094035,"post_id":26684710,"comment_id":75109489,"body_markdown":"Sounds to me like the `flatMap` operation is the exact opposite of flat. Yet again, leave it to Computer Scientists to turn a term on it&#39;s head. Like a function being &quot;transparent&quot; meaning you can&#39;t see anything it does, just the results, while colloquially saying you want a process to be transparent means you want every part of it to be seen.","body":"Sounds to me like the <code>flatMap</code> operation is the exact opposite of flat. Yet again, leave it to Computer Scientists to turn a term on it&#39;s head. Like a function being &quot;transparent&quot; meaning you can&#39;t see anything it does, just the results, while colloquially saying you want a process to be transparent means you want every part of it to be seen."},{"owner":{"account_id":44646,"reputation":2831,"user_id":131146,"accept_rate":75,"display_name":"Zefiro"},"score":59,"creation_date":1496851837,"post_id":26684710,"comment_id":75834342,"body_markdown":"@coladict Try viewing it from a different perspective: it&#39;s not a transparent case where you can see the inner workings through, but the whole function itself is transparent, i.e. invisible, to you - while still doing their work and letting you see what you&#39;re working with. In this case, &quot;flat&quot; refers to the opposite of &quot;nested&quot;, flatmap removes one nesting level by flattening.","body":"@coladict Try viewing it from a different perspective: it&#39;s not a transparent case where you can see the inner workings through, but the whole function itself is transparent, i.e. invisible, to you - while still doing their work and letting you see what you&#39;re working with. In this case, &quot;flat&quot; refers to the opposite of &quot;nested&quot;, flatmap removes one nesting level by flattening."},{"owner":{"account_id":1857741,"reputation":1493,"user_id":1682975,"accept_rate":100,"display_name":"Ashok Bijoy Debnath"},"score":13,"creation_date":1500494348,"post_id":26684710,"comment_id":77367054,"body_markdown":"@coladict The &quot;transparent&quot; thing has been eating my head for years. Glad to know at least one other person feels the same way.","body":"@coladict The &quot;transparent&quot; thing has been eating my head for years. Glad to know at least one other person feels the same way."},{"owner":{"account_id":3456895,"reputation":1651,"user_id":2895202,"accept_rate":100,"display_name":"markus"},"score":1,"creation_date":1501656854,"post_id":26684710,"comment_id":77867792,"body_markdown":"@coladict: i was just thinking along the same line where does the flat part in the name come from?","body":"@coladict: i was just thinking along the same line where does the flat part in the name come from?"},{"owner":{"account_id":7965864,"reputation":942,"user_id":6012102,"display_name":"andrzej.szmukala"},"score":11,"creation_date":1516102949,"post_id":26684710,"comment_id":83544338,"body_markdown":"Flattening comes from turning 2-level structure into single level structure, see Dici&#39;s answer for an example https://stackoverflow.com/a/26684582/6012102","body":"Flattening comes from turning 2-level structure into single level structure, see Dici&#39;s answer for an example <a href=\"https://stackoverflow.com/a/26684582/6012102\">stackoverflow.com/a/26684582/6012102</a>"},{"owner":{"account_id":339463,"reputation":11888,"user_id":668963,"accept_rate":87,"display_name":"neevek"},"score":47,"creation_date":1520410848,"post_id":26684710,"comment_id":85298810,"body_markdown":"This is the best explanation of **flatMap**. This is what makes it all clicked: *The values from the stream returned by the mapper are drained from the stream and are passed to the output stream. The &quot;clumps&quot; of values returned by each call to the mapper function are not distinguished at all in the output stream, thus the output is said to have been &quot;flattened&quot;*. Thank you!","body":"This is the best explanation of <b>flatMap</b>. This is what makes it all clicked: <i>The values from the stream returned by the mapper are drained from the stream and are passed to the output stream. The &quot;clumps&quot; of values returned by each call to the mapper function are not distinguished at all in the output stream, thus the output is said to have been &quot;flattened&quot;</i>. Thank you!"},{"owner":{"account_id":4590765,"reputation":365,"user_id":3724131,"display_name":"bradynpoulsen"},"score":2,"creation_date":1530135639,"post_id":26684710,"comment_id":89133363,"body_markdown":"@coladict\n@markus\n\nIf you provided the same transformer method to `map` instead of `flatMap`, you would have a `Stream&lt;Stream&lt;R&gt;&gt;` instead of just a `Stream&lt;R&gt;`\n\nhttps://gist.github.com/bradynpoulsen/f3f5458d718a996c5b3dec9decefb6d2","body":"@coladict @markus  If you provided the same transformer method to <code>map</code> instead of <code>flatMap</code>, you would have a <code>Stream&lt;Stream&lt;R&gt;&gt;</code> instead of just a <code>Stream&lt;R&gt;</code>  <a href=\"https://gist.github.com/bradynpoulsen/f3f5458d718a996c5b3dec9decefb6d2\" rel=\"nofollow noreferrer\">gist.github.com/bradynpoulsen/f3f5458d718a996c5b3dec9decefb6&zwnj;&#8203;d2</a>"},{"owner":{"account_id":94749,"reputation":2530,"user_id":258510,"accept_rate":75,"display_name":"P&#229;lOliver"},"score":0,"creation_date":1602161244,"post_id":26684710,"comment_id":113636612,"body_markdown":"@Zefiro would not the work &quot;opaque&quot; that better then?","body":"@Zefiro would not the work &quot;opaque&quot; that better then?"},{"owner":{"account_id":44646,"reputation":2831,"user_id":131146,"accept_rate":75,"display_name":"Zefiro"},"score":0,"creation_date":1602285215,"post_id":26684710,"comment_id":113682381,"body_markdown":"@P&#229;lOliver Possibly. But people seem to like transparency, so the same word is used for two different meanings, depending on whether you&#39;re interested in seeing the inner mechanism (so the box around it is transparent for it to be seen) or don&#39;t want their view blocked by those details (so the whole mechanism is see-through).","body":"@P&#229;lOliver Possibly. But people seem to like transparency, so the same word is used for two different meanings, depending on whether you&#39;re interested in seeing the inner mechanism (so the box around it is transparent for it to be seen) or don&#39;t want their view blocked by those details (so the whole mechanism is see-through)."},{"owner":{"account_id":9725157,"reputation":2553,"user_id":7212399,"accept_rate":100,"display_name":"Pratik Ambani"},"score":0,"creation_date":1616039413,"post_id":26684710,"comment_id":117880283,"body_markdown":"I would rather say  FlatMap == Map+FaltteningTheResults","body":"I would rather say  FlatMap == Map+FaltteningTheResults"},{"owner":{"account_id":13677323,"reputation":3369,"user_id":9868445,"display_name":"aderchox"},"score":0,"creation_date":1632700478,"post_id":26684710,"comment_id":122556237,"body_markdown":"Great answer, another typical usage would be using flatMap on an Optional, if the passed lambda returns an Optional too.","body":"Great answer, another typical usage would be using flatMap on an Optional, if the passed lambda returns an Optional too."},{"owner":{"account_id":1119690,"reputation":15787,"user_id":1108305,"accept_rate":47,"display_name":"M. Justin"},"score":0,"creation_date":1640329792,"post_id":26684710,"comment_id":124570622,"body_markdown":"Another advantage of using streams within the result: they can be lazily calculated, in case of large or expensive to compute streams.  So if each item of the initial stream returns, say, a million records that are easily calculated, you don&#39;t need to have all million records in memory at once: the stream function can generate them as they are processed.","body":"Another advantage of using streams within the result: they can be lazily calculated, in case of large or expensive to compute streams.  So if each item of the initial stream returns, say, a million records that are easily calculated, you don&#39;t need to have all million records in memory at once: the stream function can generate them as they are processed."}],"tags":[],"owner":{"account_id":1548079,"reputation":128727,"user_id":1441122,"display_name":"Stuart Marks"},"comment_count":12,"down_vote_count":2,"up_vote_count":1045,"is_accepted":true,"score":1043,"last_activity_date":1466269996,"creation_date":1414797102,"answer_id":26684710,"question_id":26684562,"body_markdown":"Both `map` and `flatMap` can be applied to a `Stream&lt;T&gt;` and they both return a `Stream&lt;R&gt;`. The difference is that the `map` operation produces one output value for each input value, whereas the `flatMap` operation produces an arbitrary number (zero or more) values for each input value.\r\n\r\nThis is reflected in the arguments to each operation.\r\n\r\nThe `map` operation takes a `Function`, which is called for each value in the input stream and produces one result value, which is sent to the output stream.\r\n\r\nThe `flatMap` operation takes a function that conceptually wants to consume one value and produce an arbitrary number of values. However, in Java, it&#39;s cumbersome for a method to return an arbitrary number of values, since methods can return only zero or one value. One could imagine an API where the mapper function for `flatMap` takes a value and returns an array or a `List` of values, which are then sent to the output. Given that this is the streams library, a particularly apt way to represent an arbitrary number of return values is for the mapper function itself to return a stream! The values from the stream returned by the mapper are drained from the stream and are passed to the output stream. The &quot;clumps&quot; of values returned by each call to the mapper function are not distinguished at all in the output stream, thus the output is said to have been &quot;flattened.&quot;\r\n\r\nTypical use is for the mapper function of `flatMap` to return `Stream.empty()` if it wants to send zero values, or something like `Stream.of(a, b, c)` if it wants to return several values. But of course any stream can be returned.\r\n","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>Both <code>map</code> and <code>flatMap</code> can be applied to a <code>Stream&lt;T&gt;</code> and they both return a <code>Stream&lt;R&gt;</code>. The difference is that the <code>map</code> operation produces one output value for each input value, whereas the <code>flatMap</code> operation produces an arbitrary number (zero or more) values for each input value.</p>\n\n<p>This is reflected in the arguments to each operation.</p>\n\n<p>The <code>map</code> operation takes a <code>Function</code>, which is called for each value in the input stream and produces one result value, which is sent to the output stream.</p>\n\n<p>The <code>flatMap</code> operation takes a function that conceptually wants to consume one value and produce an arbitrary number of values. However, in Java, it's cumbersome for a method to return an arbitrary number of values, since methods can return only zero or one value. One could imagine an API where the mapper function for <code>flatMap</code> takes a value and returns an array or a <code>List</code> of values, which are then sent to the output. Given that this is the streams library, a particularly apt way to represent an arbitrary number of return values is for the mapper function itself to return a stream! The values from the stream returned by the mapper are drained from the stream and are passed to the output stream. The \"clumps\" of values returned by each call to the mapper function are not distinguished at all in the output stream, thus the output is said to have been \"flattened.\"</p>\n\n<p>Typical use is for the mapper function of <code>flatMap</code> to return <code>Stream.empty()</code> if it wants to send zero values, or something like <code>Stream.of(a, b, c)</code> if it wants to return several values. But of course any stream can be returned.</p>\n"},{"comments":[{"owner":{"account_id":13540458,"reputation":4811,"user_id":9768291,"display_name":"payne"},"score":0,"creation_date":1574865297,"post_id":34332065,"comment_id":104382873,"body_markdown":"@PrashanthDebbadwar I think you would end up with a Stream of `Stream&lt;Integer&gt;` rather than a Stream of `Integer`.","body":"@PrashanthDebbadwar I think you would end up with a Stream of <code>Stream&lt;Integer&gt;</code> rather than a Stream of <code>Integer</code>."}],"tags":[],"owner":{"account_id":394969,"reputation":5307,"user_id":757695,"accept_rate":57,"display_name":"Rudy Vissers"},"comment_count":1,"down_vote_count":1,"up_vote_count":320,"is_accepted":false,"score":319,"last_activity_date":1592987887,"creation_date":1450347583,"answer_id":34332065,"question_id":26684562,"body_markdown":"I would like to give 2 examples to get a *more* practical point of view:\r\n&lt;BR&gt;First example making usage of `map`:\r\n\r\n```java\r\n@Test\r\npublic void convertStringToUpperCaseStreams() {\r\n   \tList&lt;String&gt; collected = Stream.of(&quot;a&quot;, &quot;b&quot;, &quot;hello&quot;) // Stream of String \r\n   \t\t\t.map(String::toUpperCase) // Returns a stream consisting of the results of applying the given function to the elements of this stream.\r\n  \t\t\t.collect(Collectors.toList());\r\n   \tassertEquals(asList(&quot;A&quot;, &quot;B&quot;, &quot;HELLO&quot;), collected);\r\n}\r\n```\r\n\r\nNothing special in the first example, a `Function` is applied to return the `String` in uppercase.\r\n\r\nSecond example making usage of `flatMap`:\r\n\r\n```java\r\n@Test\r\npublic void testflatMap() throws Exception {\r\n   \tList&lt;Integer&gt; together = Stream.of(asList(1, 2), asList(3, 4)) // Stream of List&lt;Integer&gt;\r\n   \t\t\t.flatMap(List::stream)\r\n   \t\t\t.map(integer -&gt; integer + 1)\r\n   \t\t\t.collect(Collectors.toList());\r\n   \tassertEquals(asList(2, 3, 4, 5), together);\r\n}\r\n```\r\nIn the second example, a Stream of List&lt;Integer&gt; is passed. **It is NOT a Stream of Integer!**\r\n&lt;BR&gt;_**If a transformation Function has to be used (through map), then first the Stream has to be flattened to something else (a Stream of Integer).**_\r\n&lt;BR&gt;If `flatMap` is removed then the following error is returned: **The operator + is undefined for the argument type(s) List&lt;Integer&gt;, int.**\r\n&lt;BR&gt;It is NOT possible to apply + 1 on a `List` of Integers!\r\n","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>I would like to give 2 examples to get a <em>more</em> practical point of view:\n<BR>First example making usage of <code>map</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Test\npublic void convertStringToUpperCaseStreams() {\n    List&lt;String&gt; collected = Stream.of(&quot;a&quot;, &quot;b&quot;, &quot;hello&quot;) // Stream of String \n            .map(String::toUpperCase) // Returns a stream consisting of the results of applying the given function to the elements of this stream.\n            .collect(Collectors.toList());\n    assertEquals(asList(&quot;A&quot;, &quot;B&quot;, &quot;HELLO&quot;), collected);\n}\n</code></pre>\n<p>Nothing special in the first example, a <code>Function</code> is applied to return the <code>String</code> in uppercase.</p>\n<p>Second example making usage of <code>flatMap</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Test\npublic void testflatMap() throws Exception {\n    List&lt;Integer&gt; together = Stream.of(asList(1, 2), asList(3, 4)) // Stream of List&lt;Integer&gt;\n            .flatMap(List::stream)\n            .map(integer -&gt; integer + 1)\n            .collect(Collectors.toList());\n    assertEquals(asList(2, 3, 4, 5), together);\n}\n</code></pre>\n<p>In the second example, a Stream of List is passed. <strong>It is NOT a Stream of Integer!</strong>\n<BR><em><strong>If a transformation Function has to be used (through map), then first the Stream has to be flattened to something else (a Stream of Integer).</strong></em>\n<BR>If <code>flatMap</code> is removed then the following error is returned: <strong>The operator + is undefined for the argument type(s) List, int.</strong>\n<BR>It is NOT possible to apply + 1 on a <code>List</code> of Integers!</p>\n"},{"comments":[{"owner":{"account_id":12863367,"reputation":442,"user_id":9304436,"display_name":"Hitesh"},"score":4,"creation_date":1550392377,"post_id":37120688,"comment_id":96245786,"body_markdown":"Nice diagrammatic explanation.","body":"Nice diagrammatic explanation."},{"owner":{"account_id":171134,"reputation":3434,"user_id":398348,"accept_rate":67,"display_name":"likejudo"},"score":1,"creation_date":1595964547,"post_id":37120688,"comment_id":111655166,"body_markdown":"@TechDog I appreciate your example. I was stuck trying to find how to split up lines into words and stream them.","body":"@TechDog I appreciate your example. I was stuck trying to find how to split up lines into words and stream them."},{"owner":{"account_id":11389854,"reputation":6022,"user_id":8370915,"display_name":"invzbl3"},"score":2,"creation_date":1632306172,"post_id":37120688,"comment_id":122454573,"body_markdown":"Thank you for your explanation based on practical examples with illustrations. It&#39;s very helpful for understanding.","body":"Thank you for your explanation based on practical examples with illustrations. It&#39;s very helpful for understanding."}],"tags":[],"owner":{"account_id":3641844,"reputation":3049,"user_id":3035746,"display_name":"TechDog"},"comment_count":3,"down_vote_count":1,"up_vote_count":208,"is_accepted":false,"score":207,"last_activity_date":1557715875,"creation_date":1462810730,"answer_id":37120688,"question_id":26684562,"body_markdown":"***Please go through the post fully to get a clear idea,***\r\n\r\n**map vs flatMap:**\r\n\r\nTo return a length  of each word from a list, we would do something like below..&lt;br&gt;\r\n\r\n## Short Version given below\r\n\r\n**When we collect two lists, given below** \r\n\r\n***Without** flat map* =&gt; **[1,2],[1,1]** =&gt; **[[1,2],[1,1]]** Here two lists are placed inside a list, so the output will be list containing lists\r\n\r\n***With** flat map* =&gt; **[1,2],[1,1]** =&gt; **[1,2,1,1]** Here two lists are flattened and only the values are placed in list, so the output will be list containing only elements \r\n\r\n**Basically it merges all the objects in to one**\r\n\r\n ## Detailed Version has been given below:-\r\n\r\n**For example:-** &lt;br&gt;Consider a list **[“STACK”, ”OOOVVVER”]** and we are trying to return a list like **[“STACKOVER”]**(returning only unique letters from that list)\r\nInitially, we would do something like below to return a list  **[“STACKOVER”]**  from  **[“STACK”, ”OOOVVVER”]**\r\n\r\n    public class WordMap {\r\n      public static void main(String[] args) {\r\n        List&lt;String&gt; lst = Arrays.asList(&quot;STACK&quot;,&quot;OOOVER&quot;);\r\n        lst.stream().map(w-&gt;w.split(&quot;&quot;)).distinct().collect(Collectors.toList());\r\n      }\r\n    }\r\n\r\nHere the issue is, Lambda passed to the map method returns a String array for each word, So the stream returned by the map method is actually of type Stream, But what we need is Stream to represent a stream of characters, below image illustrates the problem.&lt;br&gt;\r\n\r\n**Figure A:**\r\n\r\n[![enter image description here][2]][2]\r\n\r\nYou might think that, We can resolve this problem using flatmap,&lt;br&gt; OK, let us see how to solve this by using *map* and *Arrays.stream*\r\nFirst of all you gonna need a stream of characters instead of a stream of arrays. There is a method called Arrays.stream() that would take an array and produces a stream, for example:\r\n\r\n    String[] arrayOfWords = {&quot;STACK&quot;, &quot;OOOVVVER&quot;};\r\n    Stream&lt;String&gt; streamOfWords = Arrays.stream(arrayOfWords);\r\n    streamOfWords.map(s-&gt;s.split(&quot;&quot;)) //Converting word in to array of letters\r\n        .map(Arrays::stream).distinct() //Make array in to separate stream\r\n        .collect(Collectors.toList());\r\n\r\nThe above still does not work, because we now end up with a list of streams (more precisely, Stream&gt;), Instead, we must first convert each word into an array of individual letters and then make each array into a separate stream\r\n\r\n**By using flatMap we should be able to fix this problem as below:**\r\n\r\n    String[] arrayOfWords = {&quot;STACK&quot;, &quot;OOOVVVER&quot;};\r\n    Stream&lt;String&gt; streamOfWords = Arrays.stream(arrayOfWords);\r\n    streamOfWords.map(s-&gt;s.split(&quot;&quot;)) //Converting word in to array of letters\r\n        .flatMap(Arrays::stream).distinct() //flattens each generated stream in to a single stream\r\n        .collect(Collectors.toList());\r\n\r\nflatMap would perform mapping each array not with stream but with the contents of that stream. All of the individual streams that would get generated while using map(Arrays::stream) get merged into a single stream. Figure B illustrates the effect of using the flatMap method. Compare it with what map does in figure A.\r\n**Figure B**\r\n[![enter image description here][5]][5]\r\n\r\n**The flatMap method lets you replace each value of a stream with another stream and then joins all the generated streams into a single stream.**\r\n  [1]: http://i.stack.imgur.com/vd1yV.png\r\n  [2]: http://i.stack.imgur.com/0GRsT.png\r\n  [3]: http://i.stack.imgur.com/TYbGQ.png\r\n  [4]: http://i.stack.imgur.com/BN4Le.png\r\n  [5]: http://i.stack.imgur.com/yf3vz.png","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p><strong><em>Please go through the post fully to get a clear idea,</em></strong></p>\n\n<p><strong>map vs flatMap:</strong></p>\n\n<p>To return a length  of each word from a list, we would do something like below..<br></p>\n\n<h2>Short Version given below</h2>\n\n<p><strong>When we collect two lists, given below</strong> </p>\n\n<p><strong><em>Without</strong> flat map</em> => <strong>[1,2],[1,1]</strong> => <strong>[[1,2],[1,1]]</strong> Here two lists are placed inside a list, so the output will be list containing lists</p>\n\n<p><strong><em>With</strong> flat map</em> => <strong>[1,2],[1,1]</strong> => <strong>[1,2,1,1]</strong> Here two lists are flattened and only the values are placed in list, so the output will be list containing only elements </p>\n\n<p><strong>Basically it merges all the objects in to one</strong></p>\n\n<p>## Detailed Version has been given below:-</p>\n\n<p><strong>For example:-</strong> <br>Consider a list <strong>[“STACK”, ”OOOVVVER”]</strong> and we are trying to return a list like <strong>[“STACKOVER”]</strong>(returning only unique letters from that list)\nInitially, we would do something like below to return a list  <strong>[“STACKOVER”]</strong>  from  <strong>[“STACK”, ”OOOVVVER”]</strong></p>\n\n<pre><code>public class WordMap {\n  public static void main(String[] args) {\n    List&lt;String&gt; lst = Arrays.asList(\"STACK\",\"OOOVER\");\n    lst.stream().map(w-&gt;w.split(\"\")).distinct().collect(Collectors.toList());\n  }\n}\n</code></pre>\n\n<p>Here the issue is, Lambda passed to the map method returns a String array for each word, So the stream returned by the map method is actually of type Stream, But what we need is Stream to represent a stream of characters, below image illustrates the problem.<br></p>\n\n<p><strong>Figure A:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/0GRsT.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/0GRsT.png\" alt=\"enter image description here\"></a></p>\n\n<p>You might think that, We can resolve this problem using flatmap,<br> OK, let us see how to solve this by using <em>map</em> and <em>Arrays.stream</em>\nFirst of all you gonna need a stream of characters instead of a stream of arrays. There is a method called Arrays.stream() that would take an array and produces a stream, for example:</p>\n\n<pre><code>String[] arrayOfWords = {\"STACK\", \"OOOVVVER\"};\nStream&lt;String&gt; streamOfWords = Arrays.stream(arrayOfWords);\nstreamOfWords.map(s-&gt;s.split(\"\")) //Converting word in to array of letters\n    .map(Arrays::stream).distinct() //Make array in to separate stream\n    .collect(Collectors.toList());\n</code></pre>\n\n<p>The above still does not work, because we now end up with a list of streams (more precisely, Stream>), Instead, we must first convert each word into an array of individual letters and then make each array into a separate stream</p>\n\n<p><strong>By using flatMap we should be able to fix this problem as below:</strong></p>\n\n<pre><code>String[] arrayOfWords = {\"STACK\", \"OOOVVVER\"};\nStream&lt;String&gt; streamOfWords = Arrays.stream(arrayOfWords);\nstreamOfWords.map(s-&gt;s.split(\"\")) //Converting word in to array of letters\n    .flatMap(Arrays::stream).distinct() //flattens each generated stream in to a single stream\n    .collect(Collectors.toList());\n</code></pre>\n\n<p>flatMap would perform mapping each array not with stream but with the contents of that stream. All of the individual streams that would get generated while using map(Arrays::stream) get merged into a single stream. Figure B illustrates the effect of using the flatMap method. Compare it with what map does in figure A.\n<strong>Figure B</strong>\n<a href=\"https://i.stack.imgur.com/yf3vz.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/yf3vz.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>The flatMap method lets you replace each value of a stream with another stream and then joins all the generated streams into a single stream.</strong></p>\n"},{"comments":[{"owner":{"account_id":2623210,"reputation":1713,"user_id":2270804,"accept_rate":88,"display_name":"Charles-Antoine Fournel"},"score":0,"creation_date":1486724585,"post_id":42157396,"comment_id":71480743,"body_markdown":"could make a difference if you provide code instead of just provinding doc link","body":"could make a difference if you provide code instead of just provinding doc link"},{"owner":{"account_id":7618549,"reputation":1394,"user_id":5777189,"display_name":"BabyishTank"},"score":0,"creation_date":1660594948,"post_id":42157396,"comment_id":129564879,"body_markdown":"you type is incorrect right?   Set&lt;Student&gt; courses = studentList.stream().flatMap( e -&gt; e.getCourse().stream()).collect(Collectors.toSet());\n should be a set of string here?","body":"you type is incorrect right?   Set&lt;Student&gt; courses = studentList.stream().flatMap( e -&gt; e.getCourse().stream()).collect(Collectors.toSet());  should be a set of string here?"}],"tags":[],"owner":{"account_id":4159728,"reputation":469,"user_id":3410093,"display_name":"lalitbhagtani"},"comment_count":2,"down_vote_count":0,"up_vote_count":14,"is_accepted":false,"score":14,"last_activity_date":1532703077,"creation_date":1486723467,"answer_id":42157396,"question_id":26684562,"body_markdown":"Map:- \r\nThis method takes one Function as an argument and returns a new stream consisting of the results generated by applying the passed function to all the elements of the stream.\r\n\r\nLet&#39;s imagine, I have a list of integer values ( 1,2,3,4,5 ) and one function interface whose logic is square of the passed integer. ( e -&gt; e * e ). \r\n\r\n    List&lt;Integer&gt; intList = Arrays.asList(1, 2, 3, 4, 5);\r\n     \r\n    List&lt;Integer&gt; newList = intList.stream().map( e -&gt; e * e ).collect(Collectors.toList());\r\n     \r\n    System.out.println(newList);\r\n\r\noutput:- \r\n\r\n    [1, 4, 9, 16, 25]\r\n\r\nAs you can see, an output is a new stream whose values are square of values of the input stream.\r\n\r\n    [1, 2, 3, 4, 5] -&gt; apply e -&gt; e * e -&gt; [ 1*1, 2*2, 3*3, 4*4, 5*5 ] -&gt; [1, 4, 9, 16, 25 ]\r\n\r\nhttp://codedestine.com/java-8-stream-map-method/\r\n\r\nFlatMap :- \r\nThis method takes one Function as an argument, this function accepts one parameter T as an input argument and returns one stream of parameter R as a return value. When this function is applied to each element of this stream, it produces a stream of new values. All the elements of these new streams generated by each element are then copied to a new stream, which will be a return value of this method. \r\n\r\nLet&#39;s image, I have a list of student objects, where each student can opt for multiple subjects.\r\n\r\n    List&lt;Student&gt; studentList = new ArrayList&lt;Student&gt;();\r\n     \r\n      studentList.add(new Student(&quot;Robert&quot;,&quot;5st grade&quot;, Arrays.asList(new String[]{&quot;history&quot;,&quot;math&quot;,&quot;geography&quot;})));\r\n      studentList.add(new Student(&quot;Martin&quot;,&quot;8st grade&quot;, Arrays.asList(new String[]{&quot;economics&quot;,&quot;biology&quot;})));\r\n      studentList.add(new Student(&quot;Robert&quot;,&quot;9st grade&quot;, Arrays.asList(new String[]{&quot;science&quot;,&quot;math&quot;})));\r\n     \r\n      Set&lt;Student&gt; courses = studentList.stream().flatMap( e -&gt; e.getCourse().stream()).collect(Collectors.toSet());\r\n     \r\n      System.out.println(courses);\r\n\r\noutput:- \r\n\r\n    [economics, biology, geography, science, history, math]\r\n\r\nAs you can see, an output is a new stream whose values are a collection of all the elements of the streams return by each element of the input stream.\r\n\r\n[ S1 , S2 , S3 ]  -&gt;\r\n[ {&quot;history&quot;,&quot;math&quot;,&quot;geography&quot;}, {&quot;economics&quot;,&quot;biology&quot;}, {&quot;science&quot;,&quot;math&quot;} ] -&gt; take unique subjects -&gt;\r\n[economics, biology, geography, science, history, math]\r\n\r\nhttp://codedestine.com/java-8-stream-flatmap-method/\r\n\r\n\r\n","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>Map:- \nThis method takes one Function as an argument and returns a new stream consisting of the results generated by applying the passed function to all the elements of the stream.</p>\n\n<p>Let's imagine, I have a list of integer values ( 1,2,3,4,5 ) and one function interface whose logic is square of the passed integer. ( e -> e * e ). </p>\n\n<pre><code>List&lt;Integer&gt; intList = Arrays.asList(1, 2, 3, 4, 5);\n\nList&lt;Integer&gt; newList = intList.stream().map( e -&gt; e * e ).collect(Collectors.toList());\n\nSystem.out.println(newList);\n</code></pre>\n\n<p>output:- </p>\n\n<pre><code>[1, 4, 9, 16, 25]\n</code></pre>\n\n<p>As you can see, an output is a new stream whose values are square of values of the input stream.</p>\n\n<pre><code>[1, 2, 3, 4, 5] -&gt; apply e -&gt; e * e -&gt; [ 1*1, 2*2, 3*3, 4*4, 5*5 ] -&gt; [1, 4, 9, 16, 25 ]\n</code></pre>\n\n<p><a href=\"http://codedestine.com/java-8-stream-map-method/\" rel=\"noreferrer\">http://codedestine.com/java-8-stream-map-method/</a></p>\n\n<p>FlatMap :- \nThis method takes one Function as an argument, this function accepts one parameter T as an input argument and returns one stream of parameter R as a return value. When this function is applied to each element of this stream, it produces a stream of new values. All the elements of these new streams generated by each element are then copied to a new stream, which will be a return value of this method. </p>\n\n<p>Let's image, I have a list of student objects, where each student can opt for multiple subjects.</p>\n\n<pre><code>List&lt;Student&gt; studentList = new ArrayList&lt;Student&gt;();\n\n  studentList.add(new Student(\"Robert\",\"5st grade\", Arrays.asList(new String[]{\"history\",\"math\",\"geography\"})));\n  studentList.add(new Student(\"Martin\",\"8st grade\", Arrays.asList(new String[]{\"economics\",\"biology\"})));\n  studentList.add(new Student(\"Robert\",\"9st grade\", Arrays.asList(new String[]{\"science\",\"math\"})));\n\n  Set&lt;Student&gt; courses = studentList.stream().flatMap( e -&gt; e.getCourse().stream()).collect(Collectors.toSet());\n\n  System.out.println(courses);\n</code></pre>\n\n<p>output:- </p>\n\n<pre><code>[economics, biology, geography, science, history, math]\n</code></pre>\n\n<p>As you can see, an output is a new stream whose values are a collection of all the elements of the streams return by each element of the input stream.</p>\n\n<p>[ S1 , S2 , S3 ]  ->\n[ {\"history\",\"math\",\"geography\"}, {\"economics\",\"biology\"}, {\"science\",\"math\"} ] -> take unique subjects ->\n[economics, biology, geography, science, history, math]</p>\n\n<p><a href=\"http://codedestine.com/java-8-stream-flatmap-method/\" rel=\"noreferrer\">http://codedestine.com/java-8-stream-flatmap-method/</a></p>\n"},{"comments":[{"owner":{"account_id":2893891,"reputation":366,"user_id":2515091,"accept_rate":75,"display_name":"djames"},"score":1,"creation_date":1497371183,"post_id":42447211,"comment_id":76045560,"body_markdown":"the question was about Stream.map and Stream.flatMap &amp; not about Optional.map anfd Optional.flatMap","body":"the question was about Stream.map and Stream.flatMap &amp; not about Optional.map anfd Optional.flatMap"},{"owner":{"account_id":443720,"reputation":98,"user_id":1841466,"display_name":"Lo&#239;c"},"score":4,"creation_date":1497423536,"post_id":42447211,"comment_id":76065956,"body_markdown":"But it helped me a lot to understand my problems with optional and flatmap, thanks a lot!","body":"But it helped me a lot to understand my problems with optional and flatmap, thanks a lot!"},{"owner":{"account_id":2010126,"reputation":924,"user_id":1798786,"accept_rate":73,"display_name":"skwisgaar"},"score":2,"creation_date":1505859561,"post_id":42447211,"comment_id":79582907,"body_markdown":"@djames, it&#39;s a perfectly valid answer, read it starting from paragraph &quot;With streams, the flatMap method takes a function as an argument...&quot; :)","body":"@djames, it&#39;s a perfectly valid answer, read it starting from paragraph &quot;With streams, the flatMap method takes a function as an argument...&quot; :)"},{"owner":{"account_id":10074708,"reputation":1692,"user_id":7447228,"accept_rate":0,"display_name":"Ekaterina"},"score":0,"creation_date":1535006543,"post_id":42447211,"comment_id":90909100,"body_markdown":"flatMap() version also throws nullpointerexception if soundCard is null. So where&#39;s the promised benefit of Optional?","body":"flatMap() version also throws nullpointerexception if soundCard is null. So where&#39;s the promised benefit of Optional?"},{"owner":{"account_id":210629,"reputation":14178,"user_id":462347,"accept_rate":99,"display_name":"Mike"},"score":0,"creation_date":1542968144,"post_id":42447211,"comment_id":93762284,"body_markdown":"@Ekaterina, that&#39;s the pointer of working with `Optional`s, if the `getter`s return `Optional`s, then now `NullPointerException` will be thrown.","body":"@Ekaterina, that&#39;s the pointer of working with <code>Optional</code>s, if the <code>getter</code>s return <code>Optional</code>s, then now <code>NullPointerException</code> will be thrown."}],"tags":[],"owner":{"account_id":6890469,"reputation":777,"user_id":5294171,"display_name":"Rusty Core"},"comment_count":5,"down_vote_count":1,"up_vote_count":26,"is_accepted":false,"score":25,"last_activity_date":1487967741,"creation_date":1487966061,"answer_id":42447211,"question_id":26684562,"body_markdown":"Oracle&#39;s article on Optional highlights this difference between map and flatmap: \r\n\r\n    String version = computer.map(Computer::getSoundcard)\r\n                      .map(Soundcard::getUSB)\r\n                      .map(USB::getVersion)\r\n                      .orElse(&quot;UNKNOWN&quot;);\r\n\r\n&gt; Unfortunately, this code doesn&#39;t compile. Why? The variable computer\r\n&gt; is of type `Optional&lt;Computer&gt;`, so it is perfectly correct to call the\r\n&gt; map method. However, getSoundcard() returns an object of type\r\n&gt; Optional&lt;Soundcard&gt;. This means the result of the map operation is an\r\n&gt; object of type `Optional&lt;Optional&lt;Soundcard&gt;&gt;`. As a result, the call to\r\n&gt; getUSB() is invalid because the outermost Optional contains as its\r\n&gt; value another Optional, which of course doesn&#39;t support the getUSB()\r\n&gt; method.\r\n&gt; \r\n&gt; With streams, the flatMap method takes a function as an argument,\r\n&gt; which returns another stream. This function is applied to each element\r\n&gt; of a stream, which would result in a stream of streams. However,\r\n&gt; flatMap has the effect of replacing each generated stream by the\r\n&gt; contents of that stream. In other words, all the separate streams that\r\n&gt; are generated by the function get amalgamated or &quot;flattened&quot; into one\r\n&gt; single stream. What we want here is something similar, but **we want to\r\n&gt; &quot;flatten&quot; a two-level Optional into one**.\r\n&gt; \r\n&gt; Optional also supports a flatMap method. Its purpose is to apply\r\n&gt; the transformation function on the value of an Optional (just like the map\r\n&gt; operation does) and then **flatten the resulting two-level Optional into\r\n&gt; a single one**.\r\n&gt; \r\n&gt; So, to make our code correct, we need to rewrite it as follows using\r\n&gt; flatMap:\r\n\r\n    String version = computer.flatMap(Computer::getSoundcard)\r\n                       .flatMap(Soundcard::getUSB)\r\n                       .map(USB::getVersion)\r\n                       .orElse(&quot;UNKNOWN&quot;);\r\n\r\n&gt; The first flatMap ensures that an `Optional&lt;Soundcard&gt;` is returned\r\n&gt; instead of an `Optional&lt;Optional&lt;Soundcard&gt;&gt;`, and the second flatMap\r\n&gt; achieves the same purpose to return an `Optional&lt;USB&gt;`. Note that the\r\n&gt; third call just needs to be a map() because getVersion() returns a\r\n&gt; String rather than an Optional object.\r\n\r\nhttp://www.oracle.com/technetwork/articles/java/java8-optional-2175753.html\r\n\r\n\r\n\r\n","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>Oracle's article on Optional highlights this difference between map and flatmap: </p>\n\n<pre><code>String version = computer.map(Computer::getSoundcard)\n                  .map(Soundcard::getUSB)\n                  .map(USB::getVersion)\n                  .orElse(\"UNKNOWN\");\n</code></pre>\n\n<blockquote>\n  <p>Unfortunately, this code doesn't compile. Why? The variable computer\n  is of type <code>Optional&lt;Computer&gt;</code>, so it is perfectly correct to call the\n  map method. However, getSoundcard() returns an object of type\n  Optional. This means the result of the map operation is an\n  object of type <code>Optional&lt;Optional&lt;Soundcard&gt;&gt;</code>. As a result, the call to\n  getUSB() is invalid because the outermost Optional contains as its\n  value another Optional, which of course doesn't support the getUSB()\n  method.</p>\n  \n  <p>With streams, the flatMap method takes a function as an argument,\n  which returns another stream. This function is applied to each element\n  of a stream, which would result in a stream of streams. However,\n  flatMap has the effect of replacing each generated stream by the\n  contents of that stream. In other words, all the separate streams that\n  are generated by the function get amalgamated or \"flattened\" into one\n  single stream. What we want here is something similar, but <strong>we want to\n  \"flatten\" a two-level Optional into one</strong>.</p>\n  \n  <p>Optional also supports a flatMap method. Its purpose is to apply\n  the transformation function on the value of an Optional (just like the map\n  operation does) and then <strong>flatten the resulting two-level Optional into\n  a single one</strong>.</p>\n  \n  <p>So, to make our code correct, we need to rewrite it as follows using\n  flatMap:</p>\n</blockquote>\n\n<pre><code>String version = computer.flatMap(Computer::getSoundcard)\n                   .flatMap(Soundcard::getUSB)\n                   .map(USB::getVersion)\n                   .orElse(\"UNKNOWN\");\n</code></pre>\n\n<blockquote>\n  <p>The first flatMap ensures that an <code>Optional&lt;Soundcard&gt;</code> is returned\n  instead of an <code>Optional&lt;Optional&lt;Soundcard&gt;&gt;</code>, and the second flatMap\n  achieves the same purpose to return an <code>Optional&lt;USB&gt;</code>. Note that the\n  third call just needs to be a map() because getVersion() returns a\n  String rather than an Optional object.</p>\n</blockquote>\n\n<p><a href=\"http://www.oracle.com/technetwork/articles/java/java8-optional-2175753.html\" rel=\"noreferrer\">http://www.oracle.com/technetwork/articles/java/java8-optional-2175753.html</a></p>\n"},{"tags":[],"owner":{"account_id":3310029,"reputation":5220,"user_id":3278271,"accept_rate":0,"display_name":"Arsenius"},"comment_count":0,"down_vote_count":3,"up_vote_count":3,"is_accepted":false,"score":0,"last_activity_date":1497413550,"creation_date":1497413550,"answer_id":44535287,"question_id":26684562,"body_markdown":"Also good analogy can be with C# if you familiar with. Basically C# `Select` similar to java `map` and C# `SelectMany` java `flatMap`. Same applies to Kotlin for collections.","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>Also good analogy can be with C# if you familiar with. Basically C# <code>Select</code> similar to java <code>map</code> and C# <code>SelectMany</code> java <code>flatMap</code>. Same applies to Kotlin for collections.</p>\n"},{"comments":[{"owner":{"account_id":393510,"reputation":3285,"user_id":755401,"accept_rate":82,"display_name":"arthur"},"score":0,"creation_date":1520965019,"post_id":45310257,"comment_id":85529886,"body_markdown":"sorry but the 2nd snippet from point 1 is not compiling instead of  `List&lt;Integer&gt; result = Stream.of(Arrays.asList(1), Arrays.asList(2, 3))\n  .flatMap(i -&gt; i)\n  .collect(Collectors.toList());` . It is should be `Stream.of(Arrays.asList(1), Arrays.asList(2, 3))\n\t\t\t\t  .flatMap(List::stream)\n\t\t\t\t  .collect(Collectors.toList());`","body":"sorry but the 2nd snippet from point 1 is not compiling instead of  <code>List&lt;Integer&gt; result = Stream.of(Arrays.asList(1), Arrays.asList(2, 3))   .flatMap(i -&gt; i)   .collect(Collectors.toList());</code> . It is should be <code>Stream.of(Arrays.asList(1), Arrays.asList(2, 3)) \t\t\t\t  .flatMap(List::stream) \t\t\t\t  .collect(Collectors.toList());</code>"},{"owner":{"account_id":2570598,"reputation":13282,"user_id":2229438,"accept_rate":94,"display_name":"Grzegorz Piwowarek"},"score":0,"creation_date":1521011221,"post_id":45310257,"comment_id":85546014,"body_markdown":"@arthur I think I used Vavr&#39;s Stream and List here - but I agree that it might be confusing a bit - I will change that to standard Java","body":"@arthur I think I used Vavr&#39;s Stream and List here - but I agree that it might be confusing a bit - I will change that to standard Java"},{"owner":{"account_id":1056871,"reputation":117749,"user_id":1059372,"accept_rate":97,"display_name":"Eugene"},"score":0,"creation_date":1536527203,"post_id":45310257,"comment_id":91445270,"body_markdown":"@GrzegorzPiwowarek  [how about this simple explanation](https://stackoverflow.com/a/52248643/1059372) ?","body":"@GrzegorzPiwowarek  <a href=\"https://stackoverflow.com/a/52248643/1059372\">how about this simple explanation</a> ?"}],"tags":[],"owner":{"account_id":2570598,"reputation":13282,"user_id":2229438,"accept_rate":94,"display_name":"Grzegorz Piwowarek"},"comment_count":3,"down_vote_count":0,"up_vote_count":32,"is_accepted":false,"score":32,"last_activity_date":1523822896,"creation_date":1501004489,"answer_id":45310257,"question_id":26684562,"body_markdown":"I have a feeling that most answers here overcomplicate the simple problem. If you already understand how the `map` works that should be fairly easy to grasp.\r\n\r\nThere are cases where we can end up with unwanted nested structures when using `map()`, the `flatMap()` method is designed to overcome this by avoiding wrapping.\r\n\r\n\r\n----------\r\nExamples:\r\n#1\r\n\r\n    List&lt;List&lt;Integer&gt;&gt; result = Stream.of(Arrays.asList(1), Arrays.asList(2, 3))\r\n      .collect(Collectors.toList());\r\n\r\nWe can avoid having nested lists by using `flatMap`:\r\n\r\n    List&lt;Integer&gt; result = Stream.of(Arrays.asList(1), Arrays.asList(2, 3))\r\n      .flatMap(i -&gt; i.stream())\r\n      .collect(Collectors.toList());\r\n\r\n#2\r\n\r\n    Optional&lt;Optional&lt;String&gt;&gt; result = Optional.of(42)\r\n          .map(id -&gt; findById(id));\r\n\r\n    Optional&lt;String&gt; result = Optional.of(42)\r\n          .flatMap(id -&gt; findById(id));\r\n\r\nwhere:\r\n\r\n    private Optional&lt;String&gt; findById(Integer id)\r\n    ","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>I have a feeling that most answers here overcomplicate the simple problem. If you already understand how the <code>map</code> works that should be fairly easy to grasp.</p>\n\n<p>There are cases where we can end up with unwanted nested structures when using <code>map()</code>, the <code>flatMap()</code> method is designed to overcome this by avoiding wrapping.</p>\n\n<hr>\n\n<p>Examples:</p>\n\n<h1>1</h1>\n\n<pre><code>List&lt;List&lt;Integer&gt;&gt; result = Stream.of(Arrays.asList(1), Arrays.asList(2, 3))\n  .collect(Collectors.toList());\n</code></pre>\n\n<p>We can avoid having nested lists by using <code>flatMap</code>:</p>\n\n<pre><code>List&lt;Integer&gt; result = Stream.of(Arrays.asList(1), Arrays.asList(2, 3))\n  .flatMap(i -&gt; i.stream())\n  .collect(Collectors.toList());\n</code></pre>\n\n<h1>2</h1>\n\n<pre><code>Optional&lt;Optional&lt;String&gt;&gt; result = Optional.of(42)\n      .map(id -&gt; findById(id));\n\nOptional&lt;String&gt; result = Optional.of(42)\n      .flatMap(id -&gt; findById(id));\n</code></pre>\n\n<p>where:</p>\n\n<pre><code>private Optional&lt;String&gt; findById(Integer id)\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4852136,"reputation":2494,"user_id":3914166,"accept_rate":25,"display_name":"Bachiri Taoufiq Abderrahman"},"comment_count":0,"down_vote_count":2,"up_vote_count":40,"is_accepted":false,"score":38,"last_activity_date":1507432750,"creation_date":1507432750,"answer_id":46627214,"question_id":26684562,"body_markdown":"for a Map we have a list of elements and a (function,action) f so :\r\n\r\n    [a,b,c] f(x) =&gt; [f(a),f(b),f(c)]\r\n\r\nand for the flat map we have a list of elements list and we have a (function,action) f and we want the result to be flattened :\r\n\r\n    [[a,b],[c,d,e]] f(x) =&gt;[f(a),f(b),f(c),f(d),f(e)]","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>for a Map we have a list of elements and a (function,action) f so :</p>\n\n<pre><code>[a,b,c] f(x) =&gt; [f(a),f(b),f(c)]\n</code></pre>\n\n<p>and for the flat map we have a list of elements list and we have a (function,action) f and we want the result to be flattened :</p>\n\n<pre><code>[[a,b],[c,d,e]] f(x) =&gt;[f(a),f(b),f(c),f(d),f(e)]\n</code></pre>\n"},{"comments":[{"owner":{"account_id":1056871,"reputation":117749,"user_id":1059372,"accept_rate":97,"display_name":"Eugene"},"score":0,"creation_date":1536527163,"post_id":46969926,"comment_id":91445260,"body_markdown":"[how about this simple explanation](https://stackoverflow.com/a/52248643/1059372) ?","body":"<a href=\"https://stackoverflow.com/a/52248643/1059372\">how about this simple explanation</a> ?"}],"tags":[],"owner":{"account_id":300951,"reputation":7725,"user_id":608388,"accept_rate":71,"display_name":"Niraj Chauhan"},"comment_count":1,"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1509090203,"creation_date":1509090203,"answer_id":46969926,"question_id":26684562,"body_markdown":"This is very confusing for beginners. The basic difference is `map` emits one item for each entry in the list and `flatMap` is basically a `map` + `flatten` operation. To be more clear, use flatMap when you require more than one value, eg when you are expecting a loop to return arrays, flatMap will be really helpful in this case.\r\n\r\nI have written a blog about this, you can check it out [here][1].\r\n\r\n\r\n  [1]: https://blog.expert-talks.in/rx-java/difference-between-map-and-flatmap-rxjava/","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>This is very confusing for beginners. The basic difference is <code>map</code> emits one item for each entry in the list and <code>flatMap</code> is basically a <code>map</code> + <code>flatten</code> operation. To be more clear, use flatMap when you require more than one value, eg when you are expecting a loop to return arrays, flatMap will be really helpful in this case.</p>\n\n<p>I have written a blog about this, you can check it out <a href=\"https://blog.expert-talks.in/rx-java/difference-between-map-and-flatmap-rxjava/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"},{"tags":[],"owner":{"account_id":393510,"reputation":3285,"user_id":755401,"accept_rate":82,"display_name":"arthur"},"comment_count":0,"down_vote_count":1,"up_vote_count":33,"is_accepted":false,"score":32,"last_activity_date":1636499765,"creation_date":1521112027,"answer_id":49297863,"question_id":26684562,"body_markdown":"**map() and flatMap()** \r\n\r\n 1. `map()`\r\n\r\nJust takes a Function &lt;T, R&gt; a lambda param where T is element and R the return element built using T. At the end we&#39;ll have a Stream with objects of Type R. A simple example can be:\r\n\r\n    Stream\r\n      .of(1,2,3,4,5)\r\n      .map(myInt -&gt; &quot;preFix_&quot;+myInt)\r\n      .forEach(System.out::println);\r\n\r\nIt simply takes elements 1 to 5 of Type `Integer`, uses each element to build a new element from type `String` with value `&quot;prefix_&quot;+integer_value` and prints it out.\r\n\r\n 2. `flatMap()`\r\n\r\nIt is useful to know that flatMap() takes a function `F&lt;T, R&gt;` where\r\n\r\n- T is a type from *which a Stream can be built from/with*. It can be a List (T.stream()), an array (Arrays.stream(someArray)), etc.. anything that from which a Stream can be with/or form. in the example below each dev has many languages, so dev. Languages is a List and will use a lambda parameter. \r\n\r\n- R is the resulting Stream that will be built using T. Knowing that we have many instances of T, we will naturally have many Streams from R. All these Streams from Type R will **now be combined into one** single &#39;flat&#39; Stream from Type R.  \r\n\r\n**Example**\r\n\r\nThe examples of Bachiri Taoufiq  [see its answer here] [1] are simple and easy to understanding. Just for clarity, let just say we have a team of developers:\r\n\r\n    dev_team = {dev_1,dev_2,dev_3}\r\n\r\n, with each developer knowing  many languages:\r\n\r\n    dev_1 = {lang_a,lang_b,lang_c},\r\n    dev_2 = {lang_d},\r\n    dev_3 = {lang_e,lang_f}\r\n\r\nApplying  *Stream.map()* on dev_team to get the languages of each dev:\r\n\r\n    dev_team.map(dev -&gt; dev.getLanguages())\r\n \r\nwill give you this structure:\r\n\r\n    { \r\n      {lang_a,lang_b,lang_c},\r\n      {lang_d},\r\n      {lang_e,lang_f}\r\n    }\r\n\r\nwhich is basically a `List&lt;List&lt;Languages&gt;&gt; /Object[Languages[]]`. Not so very pretty, nor Java8-like!!\r\n\r\nwith `Stream.flatMap()` you can &#39;flatten&#39; things out as it takes the above structure   \r\nand turns it into `{lang_a, lang_b, lang_c, lang_d, lang_e, lang_f}`, which can basically used as `List&lt;Languages&gt;/Language[]/etc`...\r\n\r\n \r\nso in the end, your code would make more sense like this:\r\n\r\n    dev_team\r\n       .stream()    /* {dev_1,dev_2,dev_3} */\r\n       .map(dev -&gt; dev.getLanguages()) /* {{lang_a,...,lang_c},{lang_d}{lang_e,lang_f}}} */\r\n       .flatMap(languages -&gt;  languages.stream()) /* {lang_a,...,lang_d, lang_e, lang_f} */\r\n       .doWhateverWithYourNewStreamHere();\r\n\r\nor simply:\r\n\r\n    dev_team\r\n           .stream()    /* {dev_1,dev_2,dev_3} */\r\n           .flatMap(dev -&gt; dev.getLanguages().stream()) /* {lang_a,...,lang_d, lang_e, lang_f} */\r\n           .doWhateverWithYourNewStreamHere();\r\n\r\n**When to use map() and use flatMap()**:\r\n\r\n - Use `map()` when each element of type T from your stream is supposed to be mapped/transformed to a *single* element of type R. The result is a mapping of type *(1 start element -&gt; 1 end element)* and new stream of elements of type R is returned.\r\n\r\n - Use `flatMap()` when each element of type T from your stream is supposed to mapped/transformed to a *Collections* of elements of type R. The result is a mapping of type *(1 start element -&gt; n end elements)*. These Collections are then *merged* (or *flattened*) to a new stream of elements of type R. This is useful for example to represent **nested loops**.\r\n\r\nPre Java 8:\t\r\n\r\n    List&lt;Foo&gt; myFoos = new ArrayList&lt;Foo&gt;();\r\n    \tfor(Foo foo: myFoos){\r\n    \t\tfor(Bar bar:  foo.getMyBars()){\r\n    \t\t\tSystem.out.println(bar.getMyName());\r\n    \t\t}\r\n    \t}\r\n\r\nPost Java 8\r\n\r\n    myFoos\r\n        .stream()\r\n        .flatMap(foo -&gt; foo.getMyBars().stream())\r\n        .forEach(bar -&gt; System.out.println(bar.getMyName()));\r\n\r\n  [1]: https://stackoverflow.com/a/46627214/755401","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p><strong>map() and flatMap()</strong></p>\n<ol>\n<li><code>map()</code></li>\n</ol>\n<p>Just takes a Function &lt;T, R&gt; a lambda param where T is element and R the return element built using T. At the end we'll have a Stream with objects of Type R. A simple example can be:</p>\n<pre><code>Stream\n  .of(1,2,3,4,5)\n  .map(myInt -&gt; &quot;preFix_&quot;+myInt)\n  .forEach(System.out::println);\n</code></pre>\n<p>It simply takes elements 1 to 5 of Type <code>Integer</code>, uses each element to build a new element from type <code>String</code> with value <code>&quot;prefix_&quot;+integer_value</code> and prints it out.</p>\n<ol start=\"2\">\n<li><code>flatMap()</code></li>\n</ol>\n<p>It is useful to know that flatMap() takes a function <code>F&lt;T, R&gt;</code> where</p>\n<ul>\n<li><p>T is a type from <em>which a Stream can be built from/with</em>. It can be a List (T.stream()), an array (Arrays.stream(someArray)), etc.. anything that from which a Stream can be with/or form. in the example below each dev has many languages, so dev. Languages is a List and will use a lambda parameter.</p>\n</li>\n<li><p>R is the resulting Stream that will be built using T. Knowing that we have many instances of T, we will naturally have many Streams from R. All these Streams from Type R will <strong>now be combined into one</strong> single 'flat' Stream from Type R.</p>\n</li>\n</ul>\n<p><strong>Example</strong></p>\n<p>The examples of Bachiri Taoufiq  [see its answer here] <a href=\"https://stackoverflow.com/a/46627214/755401\">1</a> are simple and easy to understanding. Just for clarity, let just say we have a team of developers:</p>\n<pre><code>dev_team = {dev_1,dev_2,dev_3}\n</code></pre>\n<p>, with each developer knowing  many languages:</p>\n<pre><code>dev_1 = {lang_a,lang_b,lang_c},\ndev_2 = {lang_d},\ndev_3 = {lang_e,lang_f}\n</code></pre>\n<p>Applying  <em>Stream.map()</em> on dev_team to get the languages of each dev:</p>\n<pre><code>dev_team.map(dev -&gt; dev.getLanguages())\n</code></pre>\n<p>will give you this structure:</p>\n<pre><code>{ \n  {lang_a,lang_b,lang_c},\n  {lang_d},\n  {lang_e,lang_f}\n}\n</code></pre>\n<p>which is basically a <code>List&lt;List&lt;Languages&gt;&gt; /Object[Languages[]]</code>. Not so very pretty, nor Java8-like!!</p>\n<p>with <code>Stream.flatMap()</code> you can 'flatten' things out as it takes the above structure<br />\nand turns it into <code>{lang_a, lang_b, lang_c, lang_d, lang_e, lang_f}</code>, which can basically used as <code>List&lt;Languages&gt;/Language[]/etc</code>...</p>\n<p>so in the end, your code would make more sense like this:</p>\n<pre><code>dev_team\n   .stream()    /* {dev_1,dev_2,dev_3} */\n   .map(dev -&gt; dev.getLanguages()) /* {{lang_a,...,lang_c},{lang_d}{lang_e,lang_f}}} */\n   .flatMap(languages -&gt;  languages.stream()) /* {lang_a,...,lang_d, lang_e, lang_f} */\n   .doWhateverWithYourNewStreamHere();\n</code></pre>\n<p>or simply:</p>\n<pre><code>dev_team\n       .stream()    /* {dev_1,dev_2,dev_3} */\n       .flatMap(dev -&gt; dev.getLanguages().stream()) /* {lang_a,...,lang_d, lang_e, lang_f} */\n       .doWhateverWithYourNewStreamHere();\n</code></pre>\n<p><strong>When to use map() and use flatMap()</strong>:</p>\n<ul>\n<li><p>Use <code>map()</code> when each element of type T from your stream is supposed to be mapped/transformed to a <em>single</em> element of type R. The result is a mapping of type <em>(1 start element -&gt; 1 end element)</em> and new stream of elements of type R is returned.</p>\n</li>\n<li><p>Use <code>flatMap()</code> when each element of type T from your stream is supposed to mapped/transformed to a <em>Collections</em> of elements of type R. The result is a mapping of type <em>(1 start element -&gt; n end elements)</em>. These Collections are then <em>merged</em> (or <em>flattened</em>) to a new stream of elements of type R. This is useful for example to represent <strong>nested loops</strong>.</p>\n</li>\n</ul>\n<p>Pre Java 8:</p>\n<pre><code>List&lt;Foo&gt; myFoos = new ArrayList&lt;Foo&gt;();\n    for(Foo foo: myFoos){\n        for(Bar bar:  foo.getMyBars()){\n            System.out.println(bar.getMyName());\n        }\n    }\n</code></pre>\n<p>Post Java 8</p>\n<pre><code>myFoos\n    .stream()\n    .flatMap(foo -&gt; foo.getMyBars().stream())\n    .forEach(bar -&gt; System.out.println(bar.getMyName()));\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9893515,"reputation":6772,"user_id":7325804,"display_name":"Arnav Rao"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1532696968,"creation_date":1531288328,"answer_id":51278088,"question_id":26684562,"body_markdown":"Stream operations `flatMap` and `map` accept a function as input. \r\n\r\n`flatMap` expects the function to return a new stream for each element of the stream and returns a stream which combines all the elements of the streams returned by the function for each element. In other words, with `flatMap`, for each element from the source, multiple elements will be created by the function. http://www.zoftino.com/java-stream-examples#flatmap-operation\r\n\r\n`map` expects the function to return a transformed value and returns a new stream containing the transformed elements. In other words, with `map`, for each element from the source, one transformed element will be created by the function.\r\nhttp://www.zoftino.com/java-stream-examples#map-operation","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>Stream operations <code>flatMap</code> and <code>map</code> accept a function as input. </p>\n\n<p><code>flatMap</code> expects the function to return a new stream for each element of the stream and returns a stream which combines all the elements of the streams returned by the function for each element. In other words, with <code>flatMap</code>, for each element from the source, multiple elements will be created by the function. <a href=\"http://www.zoftino.com/java-stream-examples#flatmap-operation\" rel=\"nofollow noreferrer\">http://www.zoftino.com/java-stream-examples#flatmap-operation</a></p>\n\n<p><code>map</code> expects the function to return a transformed value and returns a new stream containing the transformed elements. In other words, with <code>map</code>, for each element from the source, one transformed element will be created by the function.\n<a href=\"http://www.zoftino.com/java-stream-examples#map-operation\" rel=\"nofollow noreferrer\">http://www.zoftino.com/java-stream-examples#map-operation</a></p>\n"},{"comments":[{"owner":{"account_id":3641844,"reputation":3049,"user_id":3035746,"display_name":"TechDog"},"score":14,"creation_date":1554445735,"post_id":51360374,"comment_id":97762313,"body_markdown":"Very crisp example.., Wouldn&#39;t take more than few secs to understand the concept with your example...","body":"Very crisp example.., Wouldn&#39;t take more than few secs to understand the concept with your example..."},{"owner":{"account_id":11711219,"reputation":497,"user_id":8573084,"display_name":"manikanta nvsr"},"score":0,"creation_date":1619431273,"post_id":51360374,"comment_id":118894318,"body_markdown":"Thanks for mentioning that Optional&lt;Optional&lt;T&gt;&gt;  to Optional&lt;T&gt;. Otherwise, it would&#39;ve been answer by me!","body":"Thanks for mentioning that Optional&lt;Optional&lt;T&gt;&gt;  to Optional&lt;T&gt;. Otherwise, it would&#39;ve been answer by me!"}],"tags":[],"owner":{"account_id":308156,"reputation":13682,"user_id":619860,"accept_rate":80,"display_name":"Hoa Nguyen"},"comment_count":2,"down_vote_count":0,"up_vote_count":157,"is_accepted":false,"score":157,"last_activity_date":1554216431,"creation_date":1531739240,"answer_id":51360374,"question_id":26684562,"body_markdown":"**One line answer: `flatMap` helps to flatten a `Collection&lt;Collection&lt;T&gt;&gt;` into a `Collection&lt;T&gt;`**. In the same way, it will also flatten an **`Optional&lt;Optional&lt;T&gt;&gt;`** into **`Optional&lt;T&gt;`**.\r\n\r\n[![enter image description here][1]][1]\r\n\r\nAs you can see, with **`map()`** only:\r\n\r\n - The intermediate type is `Stream&lt;List&lt;Item&gt;&gt;`\r\n - The return type is `List&lt;List&lt;Item&gt;&gt;`\r\n\r\nand with **`flatMap()`**:\r\n\r\n - The intermediate type is `Stream&lt;Item&gt;`\r\n - The return type is `List&lt;Item&gt;`\r\n\r\nThis is the **test result** from the code used right below: \r\n\r\n    -------- Without flatMap() -------------------------------\r\n         collect() returns: [[Laptop, Phone], [Mouse, Keyboard]]\r\n    \r\n    -------- With flatMap() ----------------------------------\r\n         collect() returns: [Laptop, Phone, Mouse, Keyboard]\r\n\r\n**Code used**:\r\n\r\n    import java.util.Arrays;\r\n    import java.util.Collection;\r\n    import java.util.List;\r\n    import java.util.stream.Collectors;\r\n    \r\n    public class Parcel {\r\n      String name;\r\n      List&lt;String&gt; items;\r\n      \r\n      public Parcel(String name, String... items) {\r\n        this.name = name;\r\n        this.items = Arrays.asList(items);\r\n      }\r\n      \r\n      public List&lt;String&gt; getItems() {\r\n        return items;\r\n      }\r\n      \r\n      public static void main(String[] args) {\r\n        Parcel amazon = new Parcel(&quot;amazon&quot;, &quot;Laptop&quot;, &quot;Phone&quot;);\r\n        Parcel ebay = new Parcel(&quot;ebay&quot;, &quot;Mouse&quot;, &quot;Keyboard&quot;);\r\n        List&lt;Parcel&gt; parcels = Arrays.asList(amazon, ebay);\r\n        \r\n        System.out.println(&quot;-------- Without flatMap() ---------------------------&quot;);\r\n        List&lt;List&lt;String&gt;&gt; mapReturn = parcels.stream()\r\n          .map(Parcel::getItems)\r\n          .collect(Collectors.toList());\r\n        System.out.println(&quot;\\t collect() returns: &quot; + mapReturn);\r\n      \r\n        System.out.println(&quot;\\n-------- With flatMap() ------------------------------&quot;);\r\n        List&lt;String&gt; flatMapReturn = parcels.stream()\r\n          .map(Parcel::getItems)\r\n          .flatMap(Collection::stream)\r\n          .collect(Collectors.toList());\r\n        System.out.println(&quot;\\t collect() returns: &quot; + flatMapReturn);\r\n      }\r\n    }\r\n\r\n  [1]: https://i.stack.imgur.com/7e1tY.jpg","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p><strong>One line answer: <code>flatMap</code> helps to flatten a <code>Collection&lt;Collection&lt;T&gt;&gt;</code> into a <code>Collection&lt;T&gt;</code></strong>. In the same way, it will also flatten an <strong><code>Optional&lt;Optional&lt;T&gt;&gt;</code></strong> into <strong><code>Optional&lt;T&gt;</code></strong>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7e1tY.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/7e1tY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see, with <strong><code>map()</code></strong> only:</p>\n\n<ul>\n<li>The intermediate type is <code>Stream&lt;List&lt;Item&gt;&gt;</code></li>\n<li>The return type is <code>List&lt;List&lt;Item&gt;&gt;</code></li>\n</ul>\n\n<p>and with <strong><code>flatMap()</code></strong>:</p>\n\n<ul>\n<li>The intermediate type is <code>Stream&lt;Item&gt;</code></li>\n<li>The return type is <code>List&lt;Item&gt;</code></li>\n</ul>\n\n<p>This is the <strong>test result</strong> from the code used right below: </p>\n\n<pre><code>-------- Without flatMap() -------------------------------\n     collect() returns: [[Laptop, Phone], [Mouse, Keyboard]]\n\n-------- With flatMap() ----------------------------------\n     collect() returns: [Laptop, Phone, Mouse, Keyboard]\n</code></pre>\n\n<p><strong>Code used</strong>:</p>\n\n<pre><code>import java.util.Arrays;\nimport java.util.Collection;\nimport java.util.List;\nimport java.util.stream.Collectors;\n\npublic class Parcel {\n  String name;\n  List&lt;String&gt; items;\n\n  public Parcel(String name, String... items) {\n    this.name = name;\n    this.items = Arrays.asList(items);\n  }\n\n  public List&lt;String&gt; getItems() {\n    return items;\n  }\n\n  public static void main(String[] args) {\n    Parcel amazon = new Parcel(\"amazon\", \"Laptop\", \"Phone\");\n    Parcel ebay = new Parcel(\"ebay\", \"Mouse\", \"Keyboard\");\n    List&lt;Parcel&gt; parcels = Arrays.asList(amazon, ebay);\n\n    System.out.println(\"-------- Without flatMap() ---------------------------\");\n    List&lt;List&lt;String&gt;&gt; mapReturn = parcels.stream()\n      .map(Parcel::getItems)\n      .collect(Collectors.toList());\n    System.out.println(\"\\t collect() returns: \" + mapReturn);\n\n    System.out.println(\"\\n-------- With flatMap() ------------------------------\");\n    List&lt;String&gt; flatMapReturn = parcels.stream()\n      .map(Parcel::getItems)\n      .flatMap(Collection::stream)\n      .collect(Collectors.toList());\n    System.out.println(\"\\t collect() returns: \" + flatMapReturn);\n  }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":37484,"reputation":27768,"user_id":107158,"accept_rate":87,"display_name":"Derek Mahar"},"score":0,"creation_date":1544630680,"post_id":52248643,"comment_id":94346347,"body_markdown":"For the `flatMap` case, do you first collect the seeds from each apple in separate bags, one bag per apple, before you pour all of the bags into a single bag?","body":"For the <code>flatMap</code> case, do you first collect the seeds from each apple in separate bags, one bag per apple, before you pour all of the bags into a single bag?"},{"owner":{"account_id":1056871,"reputation":117749,"user_id":1059372,"accept_rate":97,"display_name":"Eugene"},"score":0,"creation_date":1544630947,"post_id":52248643,"comment_id":94346483,"body_markdown":"@DerekMahar it used to be a poor into a single bag before java-10, meaning `flatmap` was not really lazy, but since java-10 it is lazy","body":"@DerekMahar it used to be a poor into a single bag before java-10, meaning <code>flatmap</code> was not really lazy, but since java-10 it is lazy"},{"owner":{"account_id":2538149,"reputation":524,"user_id":2204672,"accept_rate":71,"display_name":"JAVA"},"score":0,"creation_date":1555854731,"post_id":52248643,"comment_id":98237414,"body_markdown":"@Eugene please explain a little more lazy concept which you are trying to explain not clear to me.i understood what derkerMahar explained in comment is it that what happening before java10?","body":"@Eugene please explain a little more lazy concept which you are trying to explain not clear to me.i understood what derkerMahar explained in comment is it that what happening before java10?"},{"owner":{"account_id":1056871,"reputation":117749,"user_id":1059372,"accept_rate":97,"display_name":"Eugene"},"score":0,"creation_date":1562947432,"post_id":52248643,"comment_id":100553801,"body_markdown":"@JAVA just search `flatMap + lazy`, I bet there will be some answers.","body":"@JAVA just search <code>flatMap + lazy</code>, I bet there will be some answers."},{"owner":{"account_id":8906759,"reputation":2159,"user_id":6648326,"accept_rate":71,"display_name":"MasterJoe"},"score":0,"creation_date":1583385771,"post_id":52248643,"comment_id":107099884,"body_markdown":"@Eugene - The flatMap will take one apple at a time, extract its seeds and throw it into a bag/collection/array until all the apples seeds have been extracted. Right ? Is that how streams work ?","body":"@Eugene - The flatMap will take one apple at a time, extract its seeds and throw it into a bag/collection/array until all the apples seeds have been extracted. Right ? Is that how streams work ?"},{"owner":{"account_id":1056871,"reputation":117749,"user_id":1059372,"accept_rate":97,"display_name":"Eugene"},"score":0,"creation_date":1583386203,"post_id":52248643,"comment_id":107099988,"body_markdown":"@MasterJoe2 it depends on the java version, really.","body":"@MasterJoe2 it depends on the java version, really."},{"owner":{"account_id":1056871,"reputation":117749,"user_id":1059372,"accept_rate":97,"display_name":"Eugene"},"score":0,"creation_date":1583406425,"post_id":52248643,"comment_id":107109384,"body_markdown":"@MasterJoe2 it seems like you have a specific question in mind, why not post it?","body":"@MasterJoe2 it seems like you have a specific question in mind, why not post it?"},{"owner":{"account_id":8906759,"reputation":2159,"user_id":6648326,"accept_rate":71,"display_name":"MasterJoe"},"score":0,"creation_date":1583433874,"post_id":52248643,"comment_id":107124872,"body_markdown":"@Eugene - I have posted it here https://stackoverflow.com/questions/60539486/is-my-understanding-of-java-stream-flatmap-correct","body":"@Eugene - I have posted it here <a href=\"https://stackoverflow.com/questions/60539486/is-my-understanding-of-java-stream-flatmap-correct\" title=\"is my understanding of java stream flatmap correct\">stackoverflow.com/questions/60539486/&hellip;</a>"},{"owner":{"account_id":171134,"reputation":3434,"user_id":398348,"accept_rate":67,"display_name":"likejudo"},"score":1,"creation_date":1595938590,"post_id":52248643,"comment_id":111641242,"body_markdown":"@Eugene I don&#39;t understand. seeds are different from juice. As I understand, flat map is supposed to reduce multiple streams to a single stream. I wonder if your analogy is incorrect.","body":"@Eugene I don&#39;t understand. seeds are different from juice. As I understand, flat map is supposed to reduce multiple streams to a single stream. I wonder if your analogy is incorrect."}],"tags":[],"owner":{"account_id":1056871,"reputation":117749,"user_id":1059372,"accept_rate":97,"display_name":"Eugene"},"comment_count":9,"down_vote_count":2,"up_vote_count":21,"is_accepted":false,"score":19,"last_activity_date":1536527034,"creation_date":1536527034,"answer_id":52248643,"question_id":26684562,"body_markdown":"I am not very sure I am supposed to answer this, but every time I face someone that does not understand this, I use the same example. \r\n\r\nImagine you have an apple. A `map` is transforming that apple to `apple-juice` for example or a *one-to-one* mapping. \r\n\r\nTake that same apple and get only the seeds out of it, that is what `flatMap` does, or a *one to many*, one apple as input, many seeds as output. ","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>I am not very sure I am supposed to answer this, but every time I face someone that does not understand this, I use the same example. </p>\n\n<p>Imagine you have an apple. A <code>map</code> is transforming that apple to <code>apple-juice</code> for example or a <em>one-to-one</em> mapping. </p>\n\n<p>Take that same apple and get only the seeds out of it, that is what <code>flatMap</code> does, or a <em>one to many</em>, one apple as input, many seeds as output. </p>\n"},{"tags":[],"owner":{"account_id":5648618,"reputation":3627,"user_id":4469944,"accept_rate":50,"display_name":"S.K."},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1537810571,"creation_date":1537810571,"answer_id":52484577,"question_id":26684562,"body_markdown":"`flatMap()` also takes advantage of partial lazy evaluation of streams. It will read the fist stream and only when required, will go to the next stream. The behaviour is explained in detail here: https://stackoverflow.com/questions/46288915/is-flatmap-guaranteed-to-be-lazy","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p><code>flatMap()</code> also takes advantage of partial lazy evaluation of streams. It will read the fist stream and only when required, will go to the next stream. The behaviour is explained in detail here: <a href=\"https://stackoverflow.com/questions/46288915/is-flatmap-guaranteed-to-be-lazy\">Is flatMap guaranteed to be lazy?</a></p>\n"},{"tags":[],"owner":{"account_id":2238186,"reputation":3967,"user_id":1973933,"accept_rate":58,"display_name":"Melad Basilius"},"comment_count":0,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1552661049,"creation_date":1552661049,"answer_id":55185129,"question_id":26684562,"body_markdown":"Simple answer.\r\n\r\nThe `map` operation can produce a `Stream` of `Stream`.EX `Stream&lt;Stream&lt;Integer&gt;&gt;`\r\n\r\n`flatMap` operation will only produce `Stream` of something. EX `Stream&lt;Integer&gt;`\r\n","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>Simple answer.</p>\n\n<p>The <code>map</code> operation can produce a <code>Stream</code> of <code>Stream</code>.EX <code>Stream&lt;Stream&lt;Integer&gt;&gt;</code></p>\n\n<p><code>flatMap</code> operation will only produce <code>Stream</code> of something. EX <code>Stream&lt;Integer&gt;</code></p>\n"},{"tags":[],"owner":{"account_id":5745825,"reputation":11553,"user_id":4537090,"accept_rate":79,"display_name":"WesternGun"},"comment_count":0,"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1575032852,"creation_date":1575032465,"answer_id":59105341,"question_id":26684562,"body_markdown":"If you think `map()` as an iteration(one level `for` loop), `flatmap()` is a two-level iteration(like a nested `for` loop). (Enter each iterated element `foo`, and do `foo.getBarList()` and iterate in that `barList` again)\r\n\r\n---\r\n\r\n`map()`: take a stream, do something to every element, collect the single result of every process, output another stream. The definition of &quot;do something function&quot; is implicit. If the processment of any element results in `null`, `null` is used to compose the final stream. So, the number of elements in the resulting stream will be equal to number of input stream.\r\n\r\n`flatmap()`: take a stream of *elements/streams* and a function(explicit definition), apply the function to each element of each stream, and collect all the intermediate resulting stream to be a greater stream(&quot;flattening&quot;). If the processment of any element results in `null`, empty stream is provided to the final step of &quot;flattening&quot;. The number of elements in the resulting stream, is the total of all participating elements in all inputs, if the input is several streams. \r\n\r\n\r\n\r\n\r\n\r\n","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>If you think <code>map()</code> as an iteration(one level <code>for</code> loop), <code>flatmap()</code> is a two-level iteration(like a nested <code>for</code> loop). (Enter each iterated element <code>foo</code>, and do <code>foo.getBarList()</code> and iterate in that <code>barList</code> again)</p>\n\n<hr>\n\n<p><code>map()</code>: take a stream, do something to every element, collect the single result of every process, output another stream. The definition of \"do something function\" is implicit. If the processment of any element results in <code>null</code>, <code>null</code> is used to compose the final stream. So, the number of elements in the resulting stream will be equal to number of input stream.</p>\n\n<p><code>flatmap()</code>: take a stream of <em>elements/streams</em> and a function(explicit definition), apply the function to each element of each stream, and collect all the intermediate resulting stream to be a greater stream(\"flattening\"). If the processment of any element results in <code>null</code>, empty stream is provided to the final step of \"flattening\". The number of elements in the resulting stream, is the total of all participating elements in all inputs, if the input is several streams. </p>\n"},{"comments":[{"owner":{"account_id":125029,"reputation":330,"user_id":682256,"display_name":"Simon Logic"},"score":0,"creation_date":1645262324,"post_id":59834135,"comment_id":125827955,"body_markdown":"just replace with toCharArray and make your post shorter.","body":"just replace with toCharArray and make your post shorter."}],"tags":[],"owner":{"account_id":706860,"reputation":9592,"user_id":601844,"display_name":"epox"},"comment_count":1,"down_vote_count":0,"up_vote_count":59,"is_accepted":false,"score":59,"last_activity_date":1592998717,"creation_date":1579580449,"answer_id":59834135,"question_id":26684562,"body_markdown":"**.map** is for ***`A -&gt; B`*** mapping\r\n---\r\n\r\n    Stream.of(&quot;dog&quot;, &quot;cat&quot;)              // stream of 2 Strings\r\n        .map(s -&gt; s.length())            // stream of 2 Integers: [3, 3]\r\n*it converts any item `A` to any item `B`. [Javadoc][1]*\r\n___\r\n\r\n**.flatMap** is for ***`A -&gt; Stream&lt; B&gt;`*** concatinating\r\n---\r\n\r\n    Stream.of(&quot;dog&quot;, &quot;cat&quot;)             // stream of 2 Strings\r\n        .flatMapToInt(s -&gt; s.chars())   // stream of 6 ints:      [d, o, g, c, a, t]\r\n\r\n*it --1 converts any item `A` into `Stream&lt; B&gt;`, then --2 concatenates all the streams into one (flat) stream. [Javadoc][2]*\r\n___\r\n\r\nNote 1: Although the latter example flats to a stream of primitives (IntStream) instead of a stream of objects (Stream), it still illustrates the idea of the `.flatMap`.\r\n\r\nNote 2: Despite the name, String.chars() method returns ints. So the actual collection will be: `[100, 111, 103, 99, 97, 116]`\r\n, where `100` is the code of `&#39;d&#39;`, `111` is the code of `&#39;o&#39;` etc. Again, for illustrative purposes, it&#39;s presented as [d, o, g, c, a, t].\r\n\r\n\r\n  [1]: https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/stream/Stream.html#map(java.util.function.Function)\r\n\r\n  [2]: https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/stream/Stream.html#flatMap(java.util.function.Function)","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<h2><strong>.map</strong> is for <em><strong><code>A -&gt; B</code></strong></em> mapping</h2>\n<pre><code>Stream.of(&quot;dog&quot;, &quot;cat&quot;)              // stream of 2 Strings\n    .map(s -&gt; s.length())            // stream of 2 Integers: [3, 3]\n</code></pre>\n<p><em>it converts any item <code>A</code> to any item <code>B</code>. <a href=\"https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/stream/Stream.html#map(java.util.function.Function)\" rel=\"noreferrer\">Javadoc</a></em></p>\n<hr />\n<h2><strong>.flatMap</strong> is for <em><strong><code>A -&gt; Stream&lt; B&gt;</code></strong></em> concatinating</h2>\n<pre><code>Stream.of(&quot;dog&quot;, &quot;cat&quot;)             // stream of 2 Strings\n    .flatMapToInt(s -&gt; s.chars())   // stream of 6 ints:      [d, o, g, c, a, t]\n</code></pre>\n<p><em>it --1 converts any item <code>A</code> into <code>Stream&lt; B&gt;</code>, then --2 concatenates all the streams into one (flat) stream. <a href=\"https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/stream/Stream.html#flatMap(java.util.function.Function)\" rel=\"noreferrer\">Javadoc</a></em></p>\n<hr />\n<p>Note 1: Although the latter example flats to a stream of primitives (IntStream) instead of a stream of objects (Stream), it still illustrates the idea of the <code>.flatMap</code>.</p>\n<p>Note 2: Despite the name, String.chars() method returns ints. So the actual collection will be: <code>[100, 111, 103, 99, 97, 116]</code>\n, where <code>100</code> is the code of <code>'d'</code>, <code>111</code> is the code of <code>'o'</code> etc. Again, for illustrative purposes, it's presented as [d, o, g, c, a, t].</p>\n"},{"tags":[],"owner":{"account_id":480617,"reputation":2495,"user_id":893952,"accept_rate":57,"display_name":"Harry Coder"},"comment_count":0,"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1641330222,"creation_date":1641330222,"answer_id":70585039,"question_id":26684562,"body_markdown":"By reading all the messages, the simple way to understand is : \r\n\r\n - use `map` if you have a `flat` list of elements: [0, 1, 2, 3, 4, 5]\r\n - use `flatMap` if you have a list of list of elements: [[1, 3, 5], [2, 4, 6]]. This means that, your list need to be **flattened** before the **map** operation can be applied to each elements","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>By reading all the messages, the simple way to understand is :</p>\n<ul>\n<li>use <code>map</code> if you have a <code>flat</code> list of elements: [0, 1, 2, 3, 4, 5]</li>\n<li>use <code>flatMap</code> if you have a list of list of elements: [[1, 3, 5], [2, 4, 6]]. This means that, your list need to be <strong>flattened</strong> before the <strong>map</strong> operation can be applied to each elements</li>\n</ul>\n"},{"tags":[],"owner":{"account_id":13365877,"reputation":11,"user_id":9646171,"display_name":"Pritam Nath"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1667663065,"creation_date":1667663065,"answer_id":74329177,"question_id":26684562,"body_markdown":"map() takes a Stream and transform it to another Stream. It applies a function on each element of Stream and store return value into new Stream. It does not flatten the stream. But flatMap() is the combination of a map and a flat operation i.e, it applies a function to elements as well as flatten them.\r\n2) map() is used for transformation only, but flatMap() is used for both transformation and flattening.\r\nplease read more here.\r\nhttps://javaint4bytes.blogspot.com/2022/11/stream-flatmap-in-java-with-examples.html","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>map() takes a Stream and transform it to another Stream. It applies a function on each element of Stream and store return value into new Stream. It does not flatten the stream. But flatMap() is the combination of a map and a flat operation i.e, it applies a function to elements as well as flatten them.\n2) map() is used for transformation only, but flatMap() is used for both transformation and flattening.\nplease read more here.\n<a href=\"https://javaint4bytes.blogspot.com/2022/11/stream-flatmap-in-java-with-examples.html\" rel=\"nofollow noreferrer\">https://javaint4bytes.blogspot.com/2022/11/stream-flatmap-in-java-with-examples.html</a></p>\n"},{"tags":[],"owner":{"account_id":6383695,"reputation":5206,"user_id":4952262,"accept_rate":71,"display_name":"Michu93"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1684842529,"creation_date":1684842529,"answer_id":76314417,"question_id":26684562,"body_markdown":"Definitions of these Stream API methods: \r\n\r\n**map**(Function mapper) is an intermediate operation which returns a stream consisting of the results of applying the given function to the elements of this stream.\r\n\r\n**flatMap**(Function mapper) is an intermediate operation which returns a stream consisting of the results of replacing each element of this stream with the contents of a mapped stream produced by applying the provided mapping function to each element. In short, it is used to convert a Stream of Stream into a list of values.\r\n\r\nTake a look at example:\r\n\r\n    List&lt;String&gt; myList = Stream.of(&quot;Apple&quot;, &quot;Orange&quot;)\r\n           .map(String::toUpperCase)\r\n           .collect(Collectors.toList());\r\n    System.out.println(myList);\r\n\r\n It prints: `[APPLE, ORANGE]`\r\n\r\nCan we just change `map()` to `flatMap()`?\r\n\r\n    List&lt;String&gt; myListFlat = Stream.of(&quot;Apple&quot;, &quot;Orange&quot;)\r\n           .flatMap(String::toUpperCase)\r\n           .collect(Collectors.toList());\r\n    System.out.println(myListFlat);\r\n\r\nNo, we can see an error now: \r\n\r\n    java: incompatible types: cannot infer type-variable(s) R\r\n        (argument mismatch; bad return type in method reference\r\n          java.lang.String cannot be converted to java.util.stream.Stream&lt;? extends R&gt;)\r\n\r\nWhy is that? Take a look at methods signatures:\r\n\r\n    &lt;R&gt; Stream&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper);\r\n    &lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);\r\n\r\nThe reason why the code doesn’t work is that the `flatMap()` method expects a function that returns a Stream. In second example, I am passing a method reference to `String.toUpperCase()` which returns a String. Therefore, I am trying to apply `flatMap()` on a Stream of characters instead of a Stream of Strings.\r\n\r\nOk, so now we can have an idea for what `flatMap()` is used.\r\nLet&#39;s build a list of lists:\r\n\r\n    List&lt;List&lt;String&gt;&gt; list = Arrays.asList(\r\n                Arrays.asList(&quot;Apple&quot;),\r\n                Arrays.asList(&quot;Orange&quot;));\r\n    System.out.println(list);\r\n\r\nand it prints: `[[Apple], [Orange]]`. If we want to have it flatten let&#39;s use `flatMap()`:\r\n\r\n    List&lt;String&gt; flattedList = list\r\n                    .stream()\r\n                    .flatMap(Collection::stream)\r\n                    .collect(Collectors.toList());\r\n    \r\n    System.out.println(flattedList);\r\n\r\nand now it prints: `[Apple, Orange]`\r\n\r\nSources: \r\nhttps://www.geeksforgeeks.org/stream-flatmap-java-examples/\r\n\r\nhttps://www.javatpoint.com/flatmap-method-in-java-8\r\n\r\nhttps://www.baeldung.com/java-difference-map-and-flatmap\r\n\r\n","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>Definitions of these Stream API methods:</p>\n<p><strong>map</strong>(Function mapper) is an intermediate operation which returns a stream consisting of the results of applying the given function to the elements of this stream.</p>\n<p><strong>flatMap</strong>(Function mapper) is an intermediate operation which returns a stream consisting of the results of replacing each element of this stream with the contents of a mapped stream produced by applying the provided mapping function to each element. In short, it is used to convert a Stream of Stream into a list of values.</p>\n<p>Take a look at example:</p>\n<pre><code>List&lt;String&gt; myList = Stream.of(&quot;Apple&quot;, &quot;Orange&quot;)\n       .map(String::toUpperCase)\n       .collect(Collectors.toList());\nSystem.out.println(myList);\n</code></pre>\n<p>It prints: <code>[APPLE, ORANGE]</code></p>\n<p>Can we just change <code>map()</code> to <code>flatMap()</code>?</p>\n<pre><code>List&lt;String&gt; myListFlat = Stream.of(&quot;Apple&quot;, &quot;Orange&quot;)\n       .flatMap(String::toUpperCase)\n       .collect(Collectors.toList());\nSystem.out.println(myListFlat);\n</code></pre>\n<p>No, we can see an error now:</p>\n<pre><code>java: incompatible types: cannot infer type-variable(s) R\n    (argument mismatch; bad return type in method reference\n      java.lang.String cannot be converted to java.util.stream.Stream&lt;? extends R&gt;)\n</code></pre>\n<p>Why is that? Take a look at methods signatures:</p>\n<pre><code>&lt;R&gt; Stream&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper);\n&lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);\n</code></pre>\n<p>The reason why the code doesn’t work is that the <code>flatMap()</code> method expects a function that returns a Stream. In second example, I am passing a method reference to <code>String.toUpperCase()</code> which returns a String. Therefore, I am trying to apply <code>flatMap()</code> on a Stream of characters instead of a Stream of Strings.</p>\n<p>Ok, so now we can have an idea for what <code>flatMap()</code> is used.\nLet's build a list of lists:</p>\n<pre><code>List&lt;List&lt;String&gt;&gt; list = Arrays.asList(\n            Arrays.asList(&quot;Apple&quot;),\n            Arrays.asList(&quot;Orange&quot;));\nSystem.out.println(list);\n</code></pre>\n<p>and it prints: <code>[[Apple], [Orange]]</code>. If we want to have it flatten let's use <code>flatMap()</code>:</p>\n<pre><code>List&lt;String&gt; flattedList = list\n                .stream()\n                .flatMap(Collection::stream)\n                .collect(Collectors.toList());\n\nSystem.out.println(flattedList);\n</code></pre>\n<p>and now it prints: <code>[Apple, Orange]</code></p>\n<p>Sources:\n<a href=\"https://www.geeksforgeeks.org/stream-flatmap-java-examples/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/stream-flatmap-java-examples/</a></p>\n<p><a href=\"https://www.javatpoint.com/flatmap-method-in-java-8\" rel=\"nofollow noreferrer\">https://www.javatpoint.com/flatmap-method-in-java-8</a></p>\n<p><a href=\"https://www.baeldung.com/java-difference-map-and-flatmap\" rel=\"nofollow noreferrer\">https://www.baeldung.com/java-difference-map-and-flatmap</a></p>\n"}],"owner":{"account_id":1528364,"reputation":125614,"user_id":1426227,"accept_rate":79,"display_name":"cassiomolin"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":621451,"favorite_count":0,"down_vote_count":3,"up_vote_count":970,"accepted_answer_id":26684710,"answer_count":22,"score":967,"last_activity_date":1684842529,"creation_date":1414795995,"question_id":26684562,"body_markdown":"In Java 8, what&#39;s the difference between [`Stream.map()`][1] and [`Stream.flatMap()`][2] methods?\r\n\r\n\r\n  [1]: http://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#map-java.util.function.Function-\r\n  [2]: http://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#flatMap-java.util.function.Function-","title":"What&#39;s the difference between map() and flatMap() methods in Java 8?","body":"<p>In Java 8, what's the difference between <a href=\"http://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#map-java.util.function.Function-\" rel=\"noreferrer\"><code>Stream.map()</code></a> and <a href=\"http://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#flatMap-java.util.function.Function-\" rel=\"noreferrer\"><code>Stream.flatMap()</code></a> methods?</p>\n"},{"tags":["java","android"],"owner":{"account_id":28662122,"reputation":11,"user_id":21946846,"display_name":"Min Khant Htun"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":14,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684842403,"creation_date":1684842403,"question_id":76314403,"body_markdown":"I want to open my app on android boot in Android api 31 or above.\r\n\r\nI have a bootbroadcast reciever and it successfully received the broadcast.\r\nBut it does not open my app.\r\n\r\nHere is AndroidManifest\r\nI add queries for my app to be open.\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\r\n\r\n    &lt;uses-permission android:name=&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;/&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.REQUEST_BACKGROUND_LOCATION&quot; /&gt;\r\n\r\n    &lt;queries&gt;\r\n        &lt;package android:name=&quot;com.example.bootopen&quot; /&gt;\r\n    &lt;/queries&gt;\r\n\r\n    &lt;application\r\n        android:allowBackup=&quot;true&quot;\r\n        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;\r\n        android:fullBackupContent=&quot;@xml/backup_rules&quot;\r\n        android:icon=&quot;@mipmap/ic_launcher&quot;\r\n        android:label=&quot;@string/app_name&quot;\r\n        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;\r\n        android:supportsRtl=&quot;true&quot;\r\n        android:theme=&quot;@style/Theme.bootopen&quot;\r\n        tools:targetApi=&quot;31&quot;&gt;\r\n        &lt;activity\r\n            android:name=&quot;.MainActivity&quot;\r\n            android:exported=&quot;true&quot;\r\n            android:enabled=&quot;true&quot;&gt;\r\n            &lt;intent-filter&gt;\r\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\r\n\r\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\r\n            &lt;/intent-filter&gt;\r\n            &lt;meta-data\r\n                android:name=&quot;android.app.lib_name&quot;\r\n                android:value=&quot;&quot; /&gt;\r\n        &lt;/activity&gt;\r\n\r\n        &lt;receiver android:name=&quot;.BootReceiver&quot;\r\n            android:exported=&quot;false&quot; &gt;\r\n            &lt;intent-filter&gt;\r\n                &lt;action android:name=&quot;android.intent.action.BOOT_COMPLETED&quot; /&gt;\r\n                &lt;action android:name=&quot;android.intent.action.REBOOT&quot; /&gt;\r\n            &lt;/intent-filter&gt;\r\n        &lt;/receiver&gt;\r\n\r\n    &lt;/application&gt;\r\n\r\n&lt;/manifest&gt;\r\n\r\n```\r\n\r\nHere is BootReceiver\r\nBy using i checked boot completed or not and i got boot completed log.\r\nI use intent flags.\r\n\r\n```\r\npublic class BootReceiver extends BroadcastReceiver {\r\n    @Override\r\n    public void onReceive(Context context, Intent intent) {\r\n        if((intent.getAction() == Intent.ACTION_BOOT_COMPLETED) || (intent.getAction() == Intent.ACTION_REBOOT)) {\r\n            Log.v(&quot;Tag&quot;,&quot;Boot Completed&quot;);\r\n            Intent openIntent = context.getPackageManager().getLaunchIntentForPackage(&quot;com.example.bootopen&quot;);\r\n            openIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_NEW_DOCUMENT);\r\n            context.startActivity(openIntent);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nI wanna open my app after boot\r\n","title":"What could be wrong if my BootReceiver successfully receives broadcast but my Android app is not opening after boot in API 31 or above?","body":"<p>I want to open my app on android boot in Android api 31 or above.</p>\n<p>I have a bootbroadcast reciever and it successfully received the broadcast.\nBut it does not open my app.</p>\n<p>Here is AndroidManifest\nI add queries for my app to be open.</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\n\n    &lt;uses-permission android:name=&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;/&gt;\n    &lt;uses-permission android:name=&quot;android.permission.REQUEST_BACKGROUND_LOCATION&quot; /&gt;\n\n    &lt;queries&gt;\n        &lt;package android:name=&quot;com.example.bootopen&quot; /&gt;\n    &lt;/queries&gt;\n\n    &lt;application\n        android:allowBackup=&quot;true&quot;\n        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;\n        android:fullBackupContent=&quot;@xml/backup_rules&quot;\n        android:icon=&quot;@mipmap/ic_launcher&quot;\n        android:label=&quot;@string/app_name&quot;\n        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;\n        android:supportsRtl=&quot;true&quot;\n        android:theme=&quot;@style/Theme.bootopen&quot;\n        tools:targetApi=&quot;31&quot;&gt;\n        &lt;activity\n            android:name=&quot;.MainActivity&quot;\n            android:exported=&quot;true&quot;\n            android:enabled=&quot;true&quot;&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\n\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\n            &lt;/intent-filter&gt;\n            &lt;meta-data\n                android:name=&quot;android.app.lib_name&quot;\n                android:value=&quot;&quot; /&gt;\n        &lt;/activity&gt;\n\n        &lt;receiver android:name=&quot;.BootReceiver&quot;\n            android:exported=&quot;false&quot; &gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=&quot;android.intent.action.BOOT_COMPLETED&quot; /&gt;\n                &lt;action android:name=&quot;android.intent.action.REBOOT&quot; /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/receiver&gt;\n\n    &lt;/application&gt;\n\n&lt;/manifest&gt;\n\n</code></pre>\n<p>Here is BootReceiver\nBy using i checked boot completed or not and i got boot completed log.\nI use intent flags.</p>\n<pre><code>public class BootReceiver extends BroadcastReceiver {\n    @Override\n    public void onReceive(Context context, Intent intent) {\n        if((intent.getAction() == Intent.ACTION_BOOT_COMPLETED) || (intent.getAction() == Intent.ACTION_REBOOT)) {\n            Log.v(&quot;Tag&quot;,&quot;Boot Completed&quot;);\n            Intent openIntent = context.getPackageManager().getLaunchIntentForPackage(&quot;com.example.bootopen&quot;);\n            openIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_NEW_DOCUMENT);\n            context.startActivity(openIntent);\n        }\n    }\n}\n</code></pre>\n<p>I wanna open my app after boot</p>\n"},{"tags":["java","spring-boot"],"owner":{"account_id":60442,"reputation":3951,"user_id":180524,"accept_rate":59,"display_name":"Jason"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":23,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684842008,"creation_date":1684842008,"question_id":76314347,"body_markdown":"I need to create a database-driven Spring PropertySource that will read properties that would normally be in `application.properties` or an externalized property file defined with `@PropertySource`. Before anyone asks, the &quot;why&quot; is because that&#39;s how I&#39;ve been told to do it.\r\n\r\nIt seems like the best way to do this is to create an ```ApplicationContextInitializer``` that creates the ```PropertySource``` and adds it to the Environment:\r\n\r\n```java\r\n    environment.getPropertySources().addFirst(source);\r\n```\r\n\r\nAt this point, beans have not been loaded into the application context. This means I can&#39;t just grab the DataSource bean from said context.\r\n\r\nUnfortunately, the datasource configuration is in application.properties (the file isn&#39;t going away, but MOST properties are moving to the database. Datasource configuration stays.). So, somehow I need to configure a datasource for one-time use.\r\n\r\nOracle provides the UCPDataSource class specifically for Spring Boot, but somehow I need to manually bind an instance of it to values in the Environment (a task that is normally done in a BeanPostProcessor). \r\n\r\nAnyone have any ideas?","title":"Manual Configuration of DataSource Based on Spring Environment in ApplicationInitializer","body":"<p>I need to create a database-driven Spring PropertySource that will read properties that would normally be in <code>application.properties</code> or an externalized property file defined with <code>@PropertySource</code>. Before anyone asks, the &quot;why&quot; is because that's how I've been told to do it.</p>\n<p>It seems like the best way to do this is to create an <code>ApplicationContextInitializer</code> that creates the <code>PropertySource</code> and adds it to the Environment:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    environment.getPropertySources().addFirst(source);\n</code></pre>\n<p>At this point, beans have not been loaded into the application context. This means I can't just grab the DataSource bean from said context.</p>\n<p>Unfortunately, the datasource configuration is in application.properties (the file isn't going away, but MOST properties are moving to the database. Datasource configuration stays.). So, somehow I need to configure a datasource for one-time use.</p>\n<p>Oracle provides the UCPDataSource class specifically for Spring Boot, but somehow I need to manually bind an instance of it to values in the Environment (a task that is normally done in a BeanPostProcessor).</p>\n<p>Anyone have any ideas?</p>\n"},{"tags":["java","hibernate","querydsl"],"comments":[{"owner":{"account_id":26398340,"reputation":11,"user_id":20049137,"display_name":"rob"},"score":0,"creation_date":1684930657,"post_id":76314335,"comment_id":134589014,"body_markdown":"resolved this by changing the versions for querydsl","body":"resolved this by changing the versions for querydsl"}],"owner":{"account_id":26398340,"reputation":11,"user_id":20049137,"display_name":"rob"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":47,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684841959,"creation_date":1684841959,"question_id":76314335,"body_markdown":"i&#39;m currently upgrading my application, \r\ndependency use \r\n\r\n    spring-core: - 5.3.27\r\n    spring-security: - 5.8.3\r\n    hibernate-core: - 5.3.1.Final\r\n    hibernate-search-orm:- 5.10.2.Final\r\n    hibernate-entitymanager: - 5.3.1.Final\r\n    hibernate-jpa-2.1-api\r\n    hibernate-validator: - 6.1.6.Final\r\n    validation-api:- 2.0.0.Final\r\n    slf4j: -1.6.1\r\n    querydsl-apt:- 2.1.1\r\n\r\nerror code:- \r\n\r\n    extends JpaRepository&lt;AssignmentBO, Long&gt;, QueryDslPredicateExecutor&lt;AssignmentBO&gt;\r\n    import org.springframework.data.jpa.repository.QueryDslPredicateExecutor;\r\n\r\neclipse suggestion: -\r\n\r\n    QueryDslPredicateExecutor cannot be resolved to a type\r\n    The import org.springframework.data.jpa.repository.QueryDslPredicateExecutor cannot be resolved\r\n\r\nI tried changing the code(capital D and small d difference) to:- \r\n\r\n    extends JpaRepository&lt;AssignmentBO, Long&gt;, QuerydslPredicateExecutor&lt;AssignmentBO&gt;\r\n    import org.springframework.data.querydsl.QuerydslPredicateExecutor;\r\n    \r\nbut then my package starts give error\r\n\r\n    Multiple markers at this line\r\n    \t- The type com.querydsl.core.types.OrderSpecifier cannot be resolved. It is indirectly referenced from required .class files\r\n    \t- The type com.querydsl.core.types.Predicate cannot be resolved. It is indirectly referenced from required .class files\r\n    \r\nerror line:-\r\n\r\n    package com.demo.backend.repository;\r\n\r\n\r\n","title":"QueryDslPredicateExecutor cannot be resolved to a type","body":"<p>i'm currently upgrading my application,\ndependency use</p>\n<pre><code>spring-core: - 5.3.27\nspring-security: - 5.8.3\nhibernate-core: - 5.3.1.Final\nhibernate-search-orm:- 5.10.2.Final\nhibernate-entitymanager: - 5.3.1.Final\nhibernate-jpa-2.1-api\nhibernate-validator: - 6.1.6.Final\nvalidation-api:- 2.0.0.Final\nslf4j: -1.6.1\nquerydsl-apt:- 2.1.1\n</code></pre>\n<p>error code:-</p>\n<pre><code>extends JpaRepository&lt;AssignmentBO, Long&gt;, QueryDslPredicateExecutor&lt;AssignmentBO&gt;\nimport org.springframework.data.jpa.repository.QueryDslPredicateExecutor;\n</code></pre>\n<p>eclipse suggestion: -</p>\n<pre><code>QueryDslPredicateExecutor cannot be resolved to a type\nThe import org.springframework.data.jpa.repository.QueryDslPredicateExecutor cannot be resolved\n</code></pre>\n<p>I tried changing the code(capital D and small d difference) to:-</p>\n<pre><code>extends JpaRepository&lt;AssignmentBO, Long&gt;, QuerydslPredicateExecutor&lt;AssignmentBO&gt;\nimport org.springframework.data.querydsl.QuerydslPredicateExecutor;\n</code></pre>\n<p>but then my package starts give error</p>\n<pre><code>Multiple markers at this line\n    - The type com.querydsl.core.types.OrderSpecifier cannot be resolved. It is indirectly referenced from required .class files\n    - The type com.querydsl.core.types.Predicate cannot be resolved. It is indirectly referenced from required .class files\n</code></pre>\n<p>error line:-</p>\n<pre><code>package com.demo.backend.repository;\n</code></pre>\n"},{"tags":["java","spring","testing"],"owner":{"account_id":13774279,"reputation":43,"user_id":9940983,"display_name":"Roman"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":9,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684841889,"creation_date":1684841889,"question_id":76314324,"body_markdown":"I have base class in contractTest/java/.. and contracts in contractTest/resources/..\r\nI have ContractFields.java:\r\n\r\n    public class ContractFields {\r\n        public static final String betId = &quot;2140&quot;;\r\n    }\r\n\r\nAnd use betId in contract:\r\n\r\n    ...\r\n    body (betId: ContractFields.betId)\r\n\r\nI get error when run contractTest task:\r\n\r\n    unable to resolve class ...ContractFields\r\n\r\nHow i can i do create field in somewhere and import it in groovy contracts and java base class?","title":"Spring ContractDsl import one field in resources and java class","body":"<p>I have base class in contractTest/java/.. and contracts in contractTest/resources/..\nI have ContractFields.java:</p>\n<pre><code>public class ContractFields {\n    public static final String betId = &quot;2140&quot;;\n}\n</code></pre>\n<p>And use betId in contract:</p>\n<pre><code>...\nbody (betId: ContractFields.betId)\n</code></pre>\n<p>I get error when run contractTest task:</p>\n<pre><code>unable to resolve class ...ContractFields\n</code></pre>\n<p>How i can i do create field in somewhere and import it in groovy contracts and java base class?</p>\n"},{"tags":["java","math","dft"],"comments":[{"owner":{"account_id":372682,"reputation":22461,"user_id":721855,"display_name":"aled"},"score":0,"creation_date":1684674841,"post_id":76299934,"comment_id":134548418,"body_markdown":"What are the input, actual output and expected output?","body":"What are the input, actual output and expected output?"},{"owner":{"account_id":19067173,"reputation":1,"user_id":13922062,"display_name":"Momin Ahmed"},"score":0,"creation_date":1684676326,"post_id":76299934,"comment_id":134548576,"body_markdown":"I can&#39;t directly compare them because in this website: https://www.dynamicmath.xyz/fourier-epicycles/ I can not directly input the sample points (as x and y coordinates) so I have to draw a new input. However if I draw similar inputs, for example a rectangle, I can see that the demo in the website has lesser amplitudes as frequency increases. In my function, the amplitude generally continues to decrease but at the end it increases again. I know the points being inputted are correct, I have checked those. If you have any particular inputs, I can run and tell you my results.","body":"I can&#39;t directly compare them because in this website: <a href=\"https://www.dynamicmath.xyz/fourier-epicycles/\" rel=\"nofollow noreferrer\">dynamicmath.xyz/fourier-epicycles</a> I can not directly input the sample points (as x and y coordinates) so I have to draw a new input. However if I draw similar inputs, for example a rectangle, I can see that the demo in the website has lesser amplitudes as frequency increases. In my function, the amplitude generally continues to decrease but at the end it increases again. I know the points being inputted are correct, I have checked those. If you have any particular inputs, I can run and tell you my results."},{"owner":{"account_id":372682,"reputation":22461,"user_id":721855,"display_name":"aled"},"score":0,"creation_date":1684677231,"post_id":76299934,"comment_id":134548682,"body_markdown":"Questions in Stackoverlow should be self contained.","body":"Questions in Stackoverlow should be self contained."},{"owner":{"account_id":19067173,"reputation":1,"user_id":13922062,"display_name":"Momin Ahmed"},"score":0,"creation_date":1684678980,"post_id":76299934,"comment_id":134548905,"body_markdown":"Could you then guide me to a forum where this would be acceptable? I am really stuck here and I need help.","body":"Could you then guide me to a forum where this would be acceptable? I am really stuck here and I need help."},{"owner":{"account_id":2968584,"reputation":50571,"user_id":2521214,"accept_rate":71,"display_name":"Spektre"},"score":0,"creation_date":1684738940,"post_id":76299934,"comment_id":134555061,"body_markdown":"first check your DFT correctness (if you do iDFT you should get the original signal) and only then move on. See [How to compute Discrete Fourier Transform?](https://stackoverflow.com/a/26355569/2521214) and its sublinks so you have something for cross-comparison","body":"first check your DFT correctness (if you do iDFT you should get the original signal) and only then move on. See <a href=\"https://stackoverflow.com/a/26355569/2521214\">How to compute Discrete Fourier Transform?</a> and its sublinks so you have something for cross-comparison"},{"owner":{"account_id":466379,"reputation":17103,"user_id":871096,"accept_rate":52,"display_name":"Robert Dodier"},"score":0,"creation_date":1684778728,"post_id":76299934,"comment_id":134563570,"body_markdown":"Ahmed, it looks like you have made a good attempt. Problems like this can be approached in a fairly systematic way. First try some cases for which you can predict the results from mathematical identities. For example, what is the expected output for input which is all 0? What about all 0, except one 1? What about all 1? What about replacing every nonzero value with the negative of that value? What about a single value? two values? four? ten? etc. If you get past those cases, try other identities. When you get cases based on identities working, then try your &quot;real&quot; input. Good luck.","body":"Ahmed, it looks like you have made a good attempt. Problems like this can be approached in a fairly systematic way. First try some cases for which you can predict the results from mathematical identities. For example, what is the expected output for input which is all 0? What about all 0, except one 1? What about all 1? What about replacing every nonzero value with the negative of that value? What about a single value? two values? four? ten? etc. If you get past those cases, try other identities. When you get cases based on identities working, then try your &quot;real&quot; input. Good luck."}],"answers":[{"tags":[],"owner":{"account_id":2968584,"reputation":50571,"user_id":2521214,"accept_rate":71,"display_name":"Spektre"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684841780,"creation_date":1684830692,"answer_id":76312721,"question_id":76299934,"body_markdown":"not coding in JAVA but I was curious so I tried it in C++/VCL\r\n\r\n1. **load some 2D polygon data**\r\n\r\n   I used SVG hand-drawed image (in my SVG editor):\r\n    \r\n        &lt;svg width=&quot;512&quot; height=&quot;512&quot; viewBox=&quot;7.16534 14.370463 81.713727 78.871962&quot; &gt;\r\n         &lt;g fill=&quot;none&quot; stroke=&quot;blue&quot; stroke-width=&quot;1px&quot; data-tool=&quot;-1&quot; data-cfg=&quot;-1&quot; data-group=&quot;-1&quot; data-hair=&quot;0&quot; data-dir=&quot;0&quot; transform=&quot;matrix(1,0,0,1,0,0&quot;&gt;\r\n          &lt;path d=&quot;M 48.516651 35.319958 c -0.219755 -0.329888 -0.879021 -1.319554 -1.318532 -1.979331 c -0.43951 -0.659777 -0.824082 -1.209591 -1.318532 -1.979331 c -0.494449 -0.76974 -1.153715 -1.979331 -1.648165 -2.639108 c -0.494449 -0.659777 -0.879021 -0.824721 -1.318532 -1.319554 c -0.43951 -0.494832 -0.824082 -1.209591 -1.318532 -1.649442 c -0.494449 -0.439851 -0.879021 -0.714758 -1.648165 -0.989665 c -0.769143 -0.274907 -2.142614 -0.439851 -2.966697 -0.659777 c -0.824082 -0.219925 -1.208654 -0.549814 -1.977798 -0.659777 c -0.769143 -0.109962 -1.758042 0 -2.637064 0 c -0.879021 0 -1.758042 0 -2.637064 0 c -0.879021 0 -1.703103 0 -2.637064 0 c -0.93396 0 -2.197553 -0.054981 -2.966697 0 c -0.769143 0.054981 -1.098776 0.109962 -1.648165 0.329888 c -0.549388 0.219925 -0.9889 0.549814 -1.648165 0.989665 c -0.659266 0.439851 -1.593226 1.15461 -2.307431 1.649442 c -0.714204 0.494832 -1.483348 0.76974 -1.977798 1.319554 c -0.494449 0.549814 -0.714204 1.319554 -0.9889 1.979331 c -0.274694 0.659777 -0.43951 1.264572 -0.659266 1.979331 c -0.219755 0.714758 -0.494449 1.484498 -0.659266 2.30922 c -0.164816 0.824721 -0.274694 1.979331 -0.329633 2.639108 c -0.054938 0.659777 0 0.659777 0 1.319554 c 0 0.659777 0 1.869368 0 2.639108 c 0 0.76974 0 1.209591 0 1.979331 c 0 0.76974 -0.109877 1.979331 0 2.639108 c 0.109877 0.659777 0.274694 0.659777 0.659266 1.319554 c 0.384571 0.659777 1.208654 1.92435 1.648165 2.639108 c 0.43951 0.714758 0.494449 1.044647 0.9889 1.649442 c 0.494449 0.604795 1.483348 1.374535 1.977798 1.979331 c 0.494449 0.604795 0.604327 1.099628 0.9889 1.649442 c 0.384571 0.549814 0.93396 1.209591 1.318532 1.649442 c 0.384571 0.439851 0.494449 0.549814 0.9889 0.989665 c 0.494449 0.439851 1.37347 1.209591 1.977798 1.649442 c 0.604327 0.439851 1.043837 0.494832 1.648165 0.989665 c 0.604327 0.494832 1.428409 1.53948 1.977798 1.979331 c 0.549388 0.439851 0.824082 0.439851 1.318532 0.659777 c 0.494449 0.219925 1.043837 0.439851 1.648165 0.659777 c 0.604327 0.219925 1.318532 0.329888 1.977798 0.659777 c 0.659266 0.329888 1.318532 0.934684 1.977798 1.319554 c 0.659266 0.38487 1.428409 0.604795 1.977798 0.989665 c 0.549388 0.38487 0.769143 0.934684 1.318532 1.319554 c 0.549388 0.38487 1.318532 0.604795 1.977798 0.989665 c 0.659266 0.38487 1.37347 0.824721 1.977798 1.319554 c 0.604327 0.494832 1.098776 1.15461 1.648165 1.649442 c 0.549388 0.494832 1.043837 0.824721 1.648165 1.319554 c 0.604327 0.494832 1.428409 1.099628 1.977798 1.649442 c 0.549388 0.549814 0.879021 0.989665 1.318532 1.649442 c 0.43951 0.659777 0.9889 1.649442 1.318532 2.30922 c 0.329633 0.659777 0.329633 1.044647 0.659266 1.649442 c 0.329633 0.604795 0.9889 1.319554 1.318532 1.979331 c 0.329633 0.659777 0.43951 1.209591 0.659266 1.979331 c 0.219755 0.76974 0.549388 2.30922 0.659266 2.639108 c 0.109877 0.329888 0 -0.219925 0 -0.659777 c 0 -0.439851 -0.054938 -1.209591 0 -1.979331 c 0.054938 -0.76974 0.219755 -1.814387 0.329633 -2.639108 c 0.109877 -0.824721 0.164816 -1.594461 0.329633 -2.30922 c 0.164816 -0.714758 0.549388 -1.319554 0.659266 -1.979331 c 0.109877 -0.659777 -0.109877 -1.209591 0 -1.979331 c 0.109877 -0.76974 0.384571 -1.869368 0.659266 -2.639108 c 0.274694 -0.76974 0.769143 -1.264572 0.9889 -1.979331 c 0.219755 -0.714758 0.164816 -1.649442 0.329633 -2.30922 c 0.164816 -0.659777 0.329633 -0.879702 0.659266 -1.649442 c 0.329633 -0.76974 0.9889 -2.144275 1.318532 -2.968997 c 0.329633 -0.824721 0.43951 -1.484498 0.659266 -1.979331 c 0.219755 -0.494832 0.43951 -0.604795 0.659266 -0.989665 c 0.219755 -0.38487 0.384571 -0.824721 0.659266 -1.319554 c 0.274694 -0.494832 0.659266 -1.044647 0.9889 -1.649442 c 0.329633 -0.604795 0.604327 -1.319554 0.9889 -1.979331 c 0.384571 -0.659777 0.769143 -1.319554 1.318532 -1.979331 c 0.549388 -0.659777 1.318532 -1.429517 1.977798 -1.979331 c 0.659266 -0.549814 1.37347 -0.824721 1.977798 -1.319554 c 0.604327 -0.494832 1.098776 -1.209591 1.648165 -1.649442 c 0.549388 -0.439851 0.9889 -0.604795 1.648165 -0.989665 c 0.659266 -0.38487 1.648165 -0.879702 2.307431 -1.319554 c 0.659266 -0.439851 1.098776 -0.879702 1.648165 -1.319554 c 0.549388 -0.439851 1.043837 -0.824721 1.648165 -1.319554 c 0.604327 -0.494832 1.37347 -1.099628 1.977798 -1.649442 c 0.604327 -0.549814 1.208654 -1.099628 1.648165 -1.649442 c 0.43951 -0.549814 0.714204 -0.934684 0.9889 -1.649442 c 0.274694 -0.714758 0.549388 -1.704424 0.659266 -2.639108 c 0.109877 -0.934684 0 -2.199257 0 -2.968997 c 0 -0.76974 0.109877 -1.044647 0 -1.649442 c -0.109877 -0.604795 -0.274694 -1.209591 -0.659266 -1.979331 c -0.384571 -0.76974 -1.043837 -1.869368 -1.648165 -2.639108 c -0.604327 -0.76974 -1.428409 -1.484498 -1.977798 -1.979331 c -0.549388 -0.494832 -0.769143 -0.76974 -1.318532 -0.989665 c -0.549388 -0.219925 -1.37347 -0.164944 -1.977798 -0.329888 c -0.604327 -0.164944 -1.043837 -0.439851 -1.648165 -0.659777 c -0.604327 -0.219925 -1.37347 -0.549814 -1.977798 -0.659777 c -0.604327 -0.109962 -1.153715 0.054981 -1.648165 0 c -0.494449 -0.054981 -0.659266 -0.219925 -1.318532 -0.329888 c -0.659266 -0.109962 -1.922859 -0.274907 -2.637064 -0.329888 c -0.714204 -0.054981 -1.098776 0.054981 -1.648165 0 c -0.549388 -0.054981 -0.93396 -0.274907 -1.648165 -0.329888 c -0.714204 -0.054981 -1.86792 0 -2.637064 0 c -0.769143 0 -1.208654 0 -1.977798 0 c -0.769143 0 -1.922859 -0.164944 -2.637064 0 c -0.714204 0.164944 -0.9889 0.604795 -1.648165 0.989665 c -0.659266 0.38487 -1.703103 0.879702 -2.307431 1.319554 c -0.604327 0.439851 -0.879021 0.879702 -1.318532 1.319554 c -0.43951 0.439851 -1.043837 0.824721 -1.318532 1.319554 c -0.274694 0.494832 -0.109877 0.879702 -0.329633 1.649442 c -0.219755 0.76974 -0.824082 2.034312 -0.9889 2.968997 c -0.164816 0.934684 -0.054938 2.034312 0 2.639108 c 0.054938 0.604795 0.274694 0.824721 0.329633 0.989665 &quot;/&gt;\r\n         &lt;/g&gt;\r\n        &lt;/svg&gt;\r\n\r\n   and stored the data as set of 2D points (see `pic[]` in data.h below)\r\n\r\n2. **do 1D DFFT on input polygon (complex input and output)**\r\n\r\n   each 2D point is represented as single complex number. As I used DFFT (DFT was ~1sec too slow to my taste) the input data must be power of 2 size so &quot;pad&quot; themissing data (I duplicated last point).\r\n\r\n3. **during rendering do iDFT  (complex input and output) and render line/circle in each inner loop iteration**\r\n\r\n   however this step is different from iDFT as we do not use the outer loop and instead we select only single output (not computing whole array). The selected index is like animation time/parameter. However the change must be discrete (you can not interpolate between 2 values without more heavy computations).\r\n\r\n\r\nHere simplified (without SVG importer, with fixed size and static data and removed all unimportant stuff) C++/VCL example:\r\n\r\n&lt;!-- language: cpp --&gt;\r\n\r\n    //---------------------------------------------------------------------------\r\n    #include &lt;math.h&gt;\r\n    #include &quot;data.h&quot;\r\n    //---------------------------------------------------------------------------\r\n    int tepi=0;\t\t\t\t// animation time &lt;0,N)\r\n    //---------------------------------------------------------------------------\r\n    void DFFTcc(float *dst,float *src,int n)\t// n must be power of 2 !!!\r\n    \t{\r\n    \t// precompute sin,cos LUTs if not computed yet\r\n    \tstatic float _cos[N]={0.0},_sin[N];\r\n    \tif (_cos[0]&lt;=0.9)\r\n    \t\t{\r\n    \t\tfloat a,da; int i;\r\n    \t\tda=2.0*M_PI/float(N);\r\n    \t\tfor (a=0.0,i=0;i&lt;N;i++,a+=da) { _cos[i]=cos(a); _sin[i]=sin(a); }\r\n    \t\t}\r\n    \t// DFFT\r\n    \tif (n&lt;=1) { if (n==1) { dst[0]=src[0]*2.0; dst[1]=src[1]*2.0; } return; }\r\n    \tint i,j,n2=n&gt;&gt;1,q,dq=+N/n,mq=N-1;\r\n    \t// reorder even,odd (buterfly)\r\n    \tfor (j=0,i=0;i&lt;n+n;) { dst[j]=src[i]; i++; j++; dst[j]=src[i]; i+=3; j++; }\r\n    \tfor (    i=2;i&lt;n+n;) { dst[j]=src[i]; i++; j++; dst[j]=src[i]; i+=3; j++; }\r\n    \t// recursion\r\n    \tfloat tmp[N2];\r\n    \tDFFTcc(tmp  ,dst  ,n2);\t// even\r\n    \tDFFTcc(tmp+n,dst+n,n2);\t// odd\r\n    \t// reorder and weight back (buterfly)\r\n    \tfloat a0,a1,b0,b1,a,b;\r\n    \tfor (q=0,i=0,j=n;i&lt;n;i+=2,j+=2,q=(q+dq)&amp;mq)\r\n    \t\t{\r\n    \t\ta0=tmp[j  ]; a1=+_cos[q];\r\n    \t\tb0=tmp[j+1]; b1=+_sin[q];\r\n    \t\ta=(a0*a1)-(b0*b1);\r\n    \t\tb=(a0*b1)+(a1*b0);\r\n    \t\ta0=tmp[i  ]; a1=a;\r\n    \t\tb0=tmp[i+1]; b1=b;\r\n    \t\tdst[i  ]=(a0+a1)*0.5;\r\n    \t\tdst[i+1]=(b0+b1)*0.5;\r\n    \t\tdst[j  ]=(a0-a1)*0.5;\r\n    \t\tdst[j+1]=(b0-b1)*0.5;\r\n    \t\t}\r\n    \t}\r\n    //---------------------------------------------------------------------------\r\n    void draw(TCanvas *scr,int xs,int ys) // target canvas, resolution\r\n    \t{\r\n    \tint xs2,ys2;\r\n    \tGraphics::TBitmap *bmp;\r\n    \txs2=xs&gt;&gt;1;\r\n    \tys2=ys&gt;&gt;1;\r\n    \tbmp=new Graphics::TBitmap;\r\n    \tbmp-&gt;HandleType=bmDIB;\r\n    \tbmp-&gt;PixelFormat=pf32bit;\r\n    \tbmp-&gt;Width=xs;\r\n    \tbmp-&gt;Height=ys;\r\n    \tbmp-&gt;Canvas-&gt;Brush-&gt;Color=0x00000000;\r\n    \tbmp-&gt;Canvas-&gt;FillRect(TRect(0,0,xs,ys));\r\n    \r\n    \tint i;\r\n    \tfloat x,y,scale=float(ys)/100.0;\r\n    \r\n    \t// render image\r\n    \tbmp-&gt;Canvas-&gt;Pen-&gt;Color=0x00204080;\r\n    \t\t\t\t\t  i=0;\t\t// DC offset\r\n    \tx=pic[i]*scale; i++;\r\n    \ty=pic[i]*scale; i++;\r\n    \tbmp-&gt;Canvas-&gt;MoveTo(x,y);\r\n    \tfor (;i&lt;N2;)\r\n    \t\t{\r\n    \t\tx=pic[i]*scale; i++;\r\n    \t\ty=pic[i]*scale; i++;\r\n    \t\tbmp-&gt;Canvas-&gt;LineTo(x,y);\r\n    \t\t}\r\n    \r\n    \t// render epicycles\r\n    \tbmp-&gt;Canvas-&gt;Pen-&gt;Color=0x00804020;\r\n    \tbmp-&gt;Canvas-&gt;Brush-&gt;Style=bsClear;\r\n    \r\n    \t// iDFTcc src,dst\r\n    \tfloat dx,dy,a0,a1,b0,b1,q,qq,r,m;\r\n    \tq=+2.0*M_PI*tepi/float(N); x=0.0; y=0.0; m=0.5*scale;\r\n    \tfor (qq=0.0,i=0;i&lt;N;i++,qq+=q)\r\n    \t\t{\r\n    \t\ta0=epi[i+i  ]; a1=+cos(qq);\r\n    \t\tb0=epi[i+i+1]; b1=-sin(qq);\r\n    \t\tdx=(a0*a1)-(b0*b1);\r\n    \t\tdy=(a0*b1)+(b0*a1);\r\n    \t\tr=sqrt((dx*dx)+(dy*dy));\r\n    \t\tbmp-&gt;Canvas-&gt;Ellipse((x-r)*m,(y-r)*m,(x+r)*m,(y+r)*m);\r\n    \t\tbmp-&gt;Canvas-&gt;MoveTo(x*m,y*m);\r\n    \t\tx+=dx; y+=dy;\r\n    \t\tbmp-&gt;Canvas-&gt;LineTo(x*m,y*m);\r\n    \t\t}\r\n    \tbmp-&gt;Canvas-&gt;Brush-&gt;Style=bsSolid;\r\n    \r\n    \tscr-&gt;Draw(0,0,bmp);\r\n    \tdelete bmp;\r\n    \t}\r\n    //---------------------------------------------------------------------------\r\n    __fastcall TForm1::TForm1(TComponent* Owner):TForm(Owner) // window init\r\n    \t{\r\n    \t// polygon -&gt; epicycles\r\n    \tDFFTcc(epi,pic,N);\t\t// epi = DFFT(pic)\r\n    \t}\r\n    //---------------------------------------------------------------------------\r\n    void __fastcall TForm1::Timer1Timer(TObject *Sender) // animation timer\r\n    \t{\r\n    \ttepi++; if (tepi&gt;=N) tepi=0;\r\n    \tdraw(Canvas,ClientWidth,ClientHeight);\r\n    \t}\r\n    //---------------------------------------------------------------------------\r\n\r\nhere the **data.h** (both input and output so you can cross compare):\r\n\r\n&lt;!-- language: cpp --&gt;\r\n\r\n    const int N=256;\t\t// max num of points\r\n    const int N2=N+N;\r\n    float pic[N2]=\r\n    \t{48.096,34.688,47.443,33.708,46.917,32.922,46.362,32.097,45.831,31.285,45.305,30.419,44.749,29.497,44.231,28.722,\r\n    \t43.585,28.030,42.913,27.403,42.365,26.683,41.731,25.885,41.067,25.326,40.175,24.850,39.323,24.587,38.265,24.372,\r\n    \t37.240,24.168,36.361,23.896,35.495,23.555,34.632,23.408,33.618,23.406,32.567,23.442,31.654,23.444,30.639,23.444,\r\n    \t29.728,23.444,28.727,23.444,27.720,23.444,26.791,23.442,25.709,23.426,24.655,23.423,23.733,23.476,22.765,23.667,\r\n    \t21.977,24.015,21.123,24.564,20.370,25.080,19.519,25.696,18.674,26.305,17.889,26.802,17.035,27.310,16.414,27.888,\r\n    \t15.924,28.776,15.553,29.712,15.234,30.585,14.926,31.587,14.662,32.425,14.376,33.394,14.180,34.298,14.029,35.383,\r\n    \t13.926,36.395,13.883,37.262,13.905,38.121,13.905,39.128,13.905,40.218,13.905,41.150,13.905,42.131,13.895,43.064,\r\n    \t13.859,44.161,13.894,45.140,14.153,45.910,14.644,46.671,15.162,47.508,15.754,48.444,16.213,49.175,16.708,50.081,\r\n    \t17.202,50.825,17.876,51.522,18.659,52.254,19.254,52.899,19.780,53.777,20.224,54.533,20.862,55.361,21.487,56.103,\r\n    \t22.064,56.718,22.740,57.327,23.554,58.027,24.381,58.689,25.154,59.155,26.009,59.658,26.662,60.264,27.410,61.062,\r\n    \t28.079,61.711,28.879,62.171,29.665,62.487,30.630,62.876,31.495,63.174,32.451,63.454,33.282,63.833,34.143,64.425,\r\n    \t35.002,65.010,35.844,65.422,36.745,65.851,37.423,66.404,38.061,67.127,38.790,67.604,39.720,68.025,40.537,68.462,\r\n    \t41.418,69.015,42.254,69.628,42.923,70.266,43.621,71.008,44.287,71.608,45.056,72.207,45.776,72.780,46.603,73.436,\r\n    \t47.393,74.115,48.017,74.773,48.606,75.542,49.110,76.309,49.654,77.242,50.127,78.130,50.467,78.966,50.824,79.855,\r\n    \t51.324,80.606,51.945,81.488,52.354,82.314,52.653,83.274,52.906,84.200,53.187,85.357,53.417,86.302,53.505,86.444,\r\n    \t53.460,85.643,53.437,84.646,53.476,83.631,53.591,82.619,53.737,81.567,53.856,80.644,53.982,79.630,54.145,78.764,\r\n    \t54.490,77.808,54.780,76.886,54.788,76.031,54.766,75.018,54.917,74.152,55.171,73.121,55.439,72.267,55.904,71.341,\r\n    \t56.362,70.476,56.566,69.588,56.665,68.541,56.846,67.665,57.210,66.793,57.593,65.928,58.030,64.966,58.480,63.966,\r\n    \t58.828,63.118,59.163,62.053,59.450,61.265,59.999,60.481,60.408,59.677,60.851,58.833,61.379,57.978,61.834,57.169,\r\n    \t62.263,56.268,62.691,55.443,63.207,54.582,63.804,53.720,64.390,53.027,65.106,52.285,65.846,51.604,66.575,51.061,\r\n    \t67.414,50.553,68.120,50.031,68.845,49.280,69.543,48.573,70.274,48.069,71.161,47.584,71.945,47.144,72.887,46.622,\r\n    \t73.662,46.143,74.472,45.514,75.217,44.887,75.907,44.338,76.697,43.704,77.405,43.129,78.224,42.456,78.922,41.846,\r\n    \t79.693,41.128,80.374,40.410,80.918,39.702,81.394,38.832,81.691,38.013,81.958,37.022,82.139,35.980,82.188,35.038,\r\n    \t82.165,33.948,82.139,33.011,82.185,32.034,82.106,31.188,81.866,30.293,81.480,29.382,81.033,28.555,80.480,27.656,\r\n    \t79.889,26.816,79.271,26.100,78.524,25.369,77.854,24.764,77.122,24.107,76.363,23.716,75.355,23.568,74.453,23.414,\r\n    \t73.501,23.030,72.627,22.679,71.611,22.306,70.707,22.095,69.663,22.132,68.812,22.021,67.886,21.782,66.890,21.638,\r\n    \t65.791,21.507,64.846,21.449,63.878,21.478,63.050,21.336,62.032,21.135,61.165,21.110,60.081,21.126,59.162,21.135,\r\n    \t58.164,21.135,57.233,21.132,56.186,21.078,55.135,21.080,54.313,21.305,53.566,21.831,52.803,22.309,51.859,22.817,\r\n    \t50.969,23.343,50.239,23.958,49.576,24.691,48.899,25.303,48.232,26.007,48.005,26.761,47.857,27.733,47.552,28.605,\r\n    \t47.172,29.621,46.885,30.613,46.785,31.593,46.812,32.663,46.890,33.511,47.198,34.330,47.198,34.330,47.198,34.330,\r\n    \t47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,\r\n    \t47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,\r\n    \t};\r\n    float epi[N2]=\r\n    \t{95.280,89.953,-17.550,-49.533,6.344,7.333,6.259,7.659,4.980,2.621,-0.481,-0.499,0.779,0.595,0.154,-0.154,\r\n    \t0.239,-0.574,-0.535,0.244,-0.004,0.195,-0.152,0.501,0.046,0.143,-0.059,0.386,-0.024,-0.042,0.122,0.147,\r\n    \t0.034,0.009,0.129,0.086,-0.032,-0.036,0.101,0.007,0.018,-0.023,0.051,-0.006,-0.078,0.053,-0.004,0.016,\r\n    \t-0.010,0.063,0.000,0.028,-0.022,0.076,0.057,0.007,0.028,0.068,0.020,0.020,0.074,0.051,-0.024,0.018,\r\n    \t0.034,0.037,-0.050,-0.034,0.039,-0.006,-0.038,0.012,-0.003,0.010,-0.023,0.024,0.014,0.029,-0.012,0.007,\r\n    \t0.015,0.020,0.042,0.019,0.014,-0.022,0.045,0.015,-0.016,0.021,0.015,0.017,0.017,0.005,0.034,-0.001,\r\n    \t-0.018,0.013,-0.003,0.013,-0.014,0.033,0.017,0.016,0.017,0.023,-0.005,-0.015,0.020,0.022,-0.004,0.018,\r\n    \t0.009,0.008,0.009,0.001,0.012,0.025,-0.008,0.018,0.017,0.001,0.003,0.003,0.008,0.005,-0.003,0.001,\r\n    \t-0.006,0.015,-0.011,0.004,0.006,0.010,0.005,0.016,0.016,0.008,0.014,0.006,0.006,0.008,0.014,0.002,\r\n    \t-0.002,0.005,0.011,0.002,0.002,0.002,0.006,0.009,0.005,0.009,0.004,0.010,-0.001,0.012,0.004,0.005,\r\n    \t0.005,0.018,0.005,0.001,0.009,0.006,0.005,0.001,0.004,0.009,0.008,0.010,0.006,0.002,0.004,0.002,\r\n    \t0.002,0.002,0.002,0.007,0.005,0.005,0.001,0.002,0.004,0.001,0.005,0.007,0.005,0.011,0.004,0.008,\r\n    \t0.011,0.005,0.006,0.006,0.005,0.004,0.007,0.000,0.003,0.001,0.007,0.005,0.002,-0.000,0.006,0.002,\r\n    \t0.008,-0.003,0.002,0.013,0.018,0.010,-0.003,0.004,0.010,0.011,0.003,0.013,0.004,0.002,0.001,0.003,\r\n    \t0.013,0.009,0.014,-0.000,0.001,0.009,-0.003,-0.003,0.001,-0.003,0.002,0.006,0.002,0.008,0.002,0.005,\r\n    \t0.011,0.009,0.003,0.004,0.009,0.000,0.003,0.004,0.009,0.006,0.005,0.003,0.011,-0.001,0.006,-0.002,\r\n    \t-0.002,-0.001,0.005,0.007,0.007,0.010,0.010,0.006,-0.000,-0.001,0.002,0.006,-0.000,0.009,0.009,0.003,\r\n    \t0.007,0.005,0.004,0.004,0.005,0.002,0.009,0.001,0.004,0.006,0.004,-0.007,0.007,0.002,0.005,0.006,\r\n    \t-0.002,-0.005,0.005,0.002,0.003,0.005,0.013,0.012,-0.001,0.013,0.016,0.003,0.008,-0.006,0.007,0.007,\r\n    \t0.013,-0.000,0.003,0.001,0.004,0.007,0.004,0.009,-0.003,0.002,-0.002,0.002,0.001,0.001,0.008,0.005,\r\n    \t0.007,-0.000,0.005,0.005,0.008,0.004,0.011,0.003,0.005,0.000,0.007,-0.003,0.004,0.004,0.004,0.007,\r\n    \t0.002,0.001,0.010,-0.001,0.002,0.001,0.001,0.005,0.006,0.005,0.008,0.001,0.005,0.004,0.005,0.004,\r\n    \t0.002,0.004,0.008,0.004,0.009,0.004,0.014,-0.009,0.004,-0.000,0.000,0.005,0.002,-0.005,0.008,0.006,\r\n    \t0.005,-0.006,0.001,0.007,0.012,-0.004,0.007,0.011,0.012,-0.002,0.002,0.017,0.019,-0.017,0.020,0.004,\r\n    \t0.004,0.008,-0.002,0.006,0.002,0.005,0.012,0.011,-0.003,-0.001,0.025,-0.001,0.000,0.005,-0.001,-0.015,\r\n    \t0.010,0.000,-0.003,-0.001,0.003,0.031,0.004,0.014,0.020,0.006,0.012,-0.005,0.024,0.003,0.003,0.016,\r\n    \t0.009,-0.019,-0.019,-0.006,-0.010,-0.015,0.010,0.024,-0.003,-0.008,0.003,-0.002,0.023,-0.022,-0.007,0.038,\r\n    \t0.017,-0.027,0.042,0.010,0.032,-0.022,0.051,0.029,0.002,0.003,0.005,0.016,0.003,-0.014,-0.000,0.009,\r\n    \t-0.013,0.038,0.028,-0.008,0.031,0.017,0.055,-0.033,-0.053,0.073,-0.053,-0.032,0.074,0.053,-0.060,-0.058,\r\n    \t0.121,0.042,0.051,0.008,0.122,0.034,-0.051,-0.036,0.103,-0.025,-0.055,0.073,0.016,-0.064,-0.052,0.111,\r\n    \t0.085,-0.081,0.008,0.202,0.077,0.025,0.065,0.290,-0.002,-0.096,0.331,0.331,-0.079,0.070,0.467,0.246,\r\n    \t-0.526,-0.281,0.451,-0.037,-0.880,0.214,0.847,-0.670,-0.752,2.921,2.253,-4.359,-4.025,8.680,0.724,1.383,\r\n    \t};\r\n\r\nand preview:\r\n\r\n[![heart animation][1]][1]\r\n\r\nNow you just add the sorting of circles by radius if you want (now they are sorted by frequency)...\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/kVjeT.gif\r\n\r\n","title":"Unexpected amplitude values in my implementation of DFT in java","body":"<p>not coding in JAVA but I was curious so I tried it in C++/VCL</p>\n<ol>\n<li><p><strong>load some 2D polygon data</strong></p>\n<p>I used SVG hand-drawed image (in my SVG editor):</p>\n<pre><code> &lt;svg width=&quot;512&quot; height=&quot;512&quot; viewBox=&quot;7.16534 14.370463 81.713727 78.871962&quot; &gt;\n  &lt;g fill=&quot;none&quot; stroke=&quot;blue&quot; stroke-width=&quot;1px&quot; data-tool=&quot;-1&quot; data-cfg=&quot;-1&quot; data-group=&quot;-1&quot; data-hair=&quot;0&quot; data-dir=&quot;0&quot; transform=&quot;matrix(1,0,0,1,0,0&quot;&gt;\n   &lt;path d=&quot;M 48.516651 35.319958 c -0.219755 -0.329888 -0.879021 -1.319554 -1.318532 -1.979331 c -0.43951 -0.659777 -0.824082 -1.209591 -1.318532 -1.979331 c -0.494449 -0.76974 -1.153715 -1.979331 -1.648165 -2.639108 c -0.494449 -0.659777 -0.879021 -0.824721 -1.318532 -1.319554 c -0.43951 -0.494832 -0.824082 -1.209591 -1.318532 -1.649442 c -0.494449 -0.439851 -0.879021 -0.714758 -1.648165 -0.989665 c -0.769143 -0.274907 -2.142614 -0.439851 -2.966697 -0.659777 c -0.824082 -0.219925 -1.208654 -0.549814 -1.977798 -0.659777 c -0.769143 -0.109962 -1.758042 0 -2.637064 0 c -0.879021 0 -1.758042 0 -2.637064 0 c -0.879021 0 -1.703103 0 -2.637064 0 c -0.93396 0 -2.197553 -0.054981 -2.966697 0 c -0.769143 0.054981 -1.098776 0.109962 -1.648165 0.329888 c -0.549388 0.219925 -0.9889 0.549814 -1.648165 0.989665 c -0.659266 0.439851 -1.593226 1.15461 -2.307431 1.649442 c -0.714204 0.494832 -1.483348 0.76974 -1.977798 1.319554 c -0.494449 0.549814 -0.714204 1.319554 -0.9889 1.979331 c -0.274694 0.659777 -0.43951 1.264572 -0.659266 1.979331 c -0.219755 0.714758 -0.494449 1.484498 -0.659266 2.30922 c -0.164816 0.824721 -0.274694 1.979331 -0.329633 2.639108 c -0.054938 0.659777 0 0.659777 0 1.319554 c 0 0.659777 0 1.869368 0 2.639108 c 0 0.76974 0 1.209591 0 1.979331 c 0 0.76974 -0.109877 1.979331 0 2.639108 c 0.109877 0.659777 0.274694 0.659777 0.659266 1.319554 c 0.384571 0.659777 1.208654 1.92435 1.648165 2.639108 c 0.43951 0.714758 0.494449 1.044647 0.9889 1.649442 c 0.494449 0.604795 1.483348 1.374535 1.977798 1.979331 c 0.494449 0.604795 0.604327 1.099628 0.9889 1.649442 c 0.384571 0.549814 0.93396 1.209591 1.318532 1.649442 c 0.384571 0.439851 0.494449 0.549814 0.9889 0.989665 c 0.494449 0.439851 1.37347 1.209591 1.977798 1.649442 c 0.604327 0.439851 1.043837 0.494832 1.648165 0.989665 c 0.604327 0.494832 1.428409 1.53948 1.977798 1.979331 c 0.549388 0.439851 0.824082 0.439851 1.318532 0.659777 c 0.494449 0.219925 1.043837 0.439851 1.648165 0.659777 c 0.604327 0.219925 1.318532 0.329888 1.977798 0.659777 c 0.659266 0.329888 1.318532 0.934684 1.977798 1.319554 c 0.659266 0.38487 1.428409 0.604795 1.977798 0.989665 c 0.549388 0.38487 0.769143 0.934684 1.318532 1.319554 c 0.549388 0.38487 1.318532 0.604795 1.977798 0.989665 c 0.659266 0.38487 1.37347 0.824721 1.977798 1.319554 c 0.604327 0.494832 1.098776 1.15461 1.648165 1.649442 c 0.549388 0.494832 1.043837 0.824721 1.648165 1.319554 c 0.604327 0.494832 1.428409 1.099628 1.977798 1.649442 c 0.549388 0.549814 0.879021 0.989665 1.318532 1.649442 c 0.43951 0.659777 0.9889 1.649442 1.318532 2.30922 c 0.329633 0.659777 0.329633 1.044647 0.659266 1.649442 c 0.329633 0.604795 0.9889 1.319554 1.318532 1.979331 c 0.329633 0.659777 0.43951 1.209591 0.659266 1.979331 c 0.219755 0.76974 0.549388 2.30922 0.659266 2.639108 c 0.109877 0.329888 0 -0.219925 0 -0.659777 c 0 -0.439851 -0.054938 -1.209591 0 -1.979331 c 0.054938 -0.76974 0.219755 -1.814387 0.329633 -2.639108 c 0.109877 -0.824721 0.164816 -1.594461 0.329633 -2.30922 c 0.164816 -0.714758 0.549388 -1.319554 0.659266 -1.979331 c 0.109877 -0.659777 -0.109877 -1.209591 0 -1.979331 c 0.109877 -0.76974 0.384571 -1.869368 0.659266 -2.639108 c 0.274694 -0.76974 0.769143 -1.264572 0.9889 -1.979331 c 0.219755 -0.714758 0.164816 -1.649442 0.329633 -2.30922 c 0.164816 -0.659777 0.329633 -0.879702 0.659266 -1.649442 c 0.329633 -0.76974 0.9889 -2.144275 1.318532 -2.968997 c 0.329633 -0.824721 0.43951 -1.484498 0.659266 -1.979331 c 0.219755 -0.494832 0.43951 -0.604795 0.659266 -0.989665 c 0.219755 -0.38487 0.384571 -0.824721 0.659266 -1.319554 c 0.274694 -0.494832 0.659266 -1.044647 0.9889 -1.649442 c 0.329633 -0.604795 0.604327 -1.319554 0.9889 -1.979331 c 0.384571 -0.659777 0.769143 -1.319554 1.318532 -1.979331 c 0.549388 -0.659777 1.318532 -1.429517 1.977798 -1.979331 c 0.659266 -0.549814 1.37347 -0.824721 1.977798 -1.319554 c 0.604327 -0.494832 1.098776 -1.209591 1.648165 -1.649442 c 0.549388 -0.439851 0.9889 -0.604795 1.648165 -0.989665 c 0.659266 -0.38487 1.648165 -0.879702 2.307431 -1.319554 c 0.659266 -0.439851 1.098776 -0.879702 1.648165 -1.319554 c 0.549388 -0.439851 1.043837 -0.824721 1.648165 -1.319554 c 0.604327 -0.494832 1.37347 -1.099628 1.977798 -1.649442 c 0.604327 -0.549814 1.208654 -1.099628 1.648165 -1.649442 c 0.43951 -0.549814 0.714204 -0.934684 0.9889 -1.649442 c 0.274694 -0.714758 0.549388 -1.704424 0.659266 -2.639108 c 0.109877 -0.934684 0 -2.199257 0 -2.968997 c 0 -0.76974 0.109877 -1.044647 0 -1.649442 c -0.109877 -0.604795 -0.274694 -1.209591 -0.659266 -1.979331 c -0.384571 -0.76974 -1.043837 -1.869368 -1.648165 -2.639108 c -0.604327 -0.76974 -1.428409 -1.484498 -1.977798 -1.979331 c -0.549388 -0.494832 -0.769143 -0.76974 -1.318532 -0.989665 c -0.549388 -0.219925 -1.37347 -0.164944 -1.977798 -0.329888 c -0.604327 -0.164944 -1.043837 -0.439851 -1.648165 -0.659777 c -0.604327 -0.219925 -1.37347 -0.549814 -1.977798 -0.659777 c -0.604327 -0.109962 -1.153715 0.054981 -1.648165 0 c -0.494449 -0.054981 -0.659266 -0.219925 -1.318532 -0.329888 c -0.659266 -0.109962 -1.922859 -0.274907 -2.637064 -0.329888 c -0.714204 -0.054981 -1.098776 0.054981 -1.648165 0 c -0.549388 -0.054981 -0.93396 -0.274907 -1.648165 -0.329888 c -0.714204 -0.054981 -1.86792 0 -2.637064 0 c -0.769143 0 -1.208654 0 -1.977798 0 c -0.769143 0 -1.922859 -0.164944 -2.637064 0 c -0.714204 0.164944 -0.9889 0.604795 -1.648165 0.989665 c -0.659266 0.38487 -1.703103 0.879702 -2.307431 1.319554 c -0.604327 0.439851 -0.879021 0.879702 -1.318532 1.319554 c -0.43951 0.439851 -1.043837 0.824721 -1.318532 1.319554 c -0.274694 0.494832 -0.109877 0.879702 -0.329633 1.649442 c -0.219755 0.76974 -0.824082 2.034312 -0.9889 2.968997 c -0.164816 0.934684 -0.054938 2.034312 0 2.639108 c 0.054938 0.604795 0.274694 0.824721 0.329633 0.989665 &quot;/&gt;\n  &lt;/g&gt;\n &lt;/svg&gt;\n</code></pre>\n<p>and stored the data as set of 2D points (see <code>pic[]</code> in data.h below)</p>\n</li>\n<li><p><strong>do 1D DFFT on input polygon (complex input and output)</strong></p>\n<p>each 2D point is represented as single complex number. As I used DFFT (DFT was ~1sec too slow to my taste) the input data must be power of 2 size so &quot;pad&quot; themissing data (I duplicated last point).</p>\n</li>\n<li><p><strong>during rendering do iDFT  (complex input and output) and render line/circle in each inner loop iteration</strong></p>\n<p>however this step is different from iDFT as we do not use the outer loop and instead we select only single output (not computing whole array). The selected index is like animation time/parameter. However the change must be discrete (you can not interpolate between 2 values without more heavy computations).</p>\n</li>\n</ol>\n<p>Here simplified (without SVG importer, with fixed size and static data and removed all unimportant stuff) C++/VCL example:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>//---------------------------------------------------------------------------\n#include &lt;math.h&gt;\n#include &quot;data.h&quot;\n//---------------------------------------------------------------------------\nint tepi=0;             // animation time &lt;0,N)\n//---------------------------------------------------------------------------\nvoid DFFTcc(float *dst,float *src,int n)    // n must be power of 2 !!!\n    {\n    // precompute sin,cos LUTs if not computed yet\n    static float _cos[N]={0.0},_sin[N];\n    if (_cos[0]&lt;=0.9)\n        {\n        float a,da; int i;\n        da=2.0*M_PI/float(N);\n        for (a=0.0,i=0;i&lt;N;i++,a+=da) { _cos[i]=cos(a); _sin[i]=sin(a); }\n        }\n    // DFFT\n    if (n&lt;=1) { if (n==1) { dst[0]=src[0]*2.0; dst[1]=src[1]*2.0; } return; }\n    int i,j,n2=n&gt;&gt;1,q,dq=+N/n,mq=N-1;\n    // reorder even,odd (buterfly)\n    for (j=0,i=0;i&lt;n+n;) { dst[j]=src[i]; i++; j++; dst[j]=src[i]; i+=3; j++; }\n    for (    i=2;i&lt;n+n;) { dst[j]=src[i]; i++; j++; dst[j]=src[i]; i+=3; j++; }\n    // recursion\n    float tmp[N2];\n    DFFTcc(tmp  ,dst  ,n2); // even\n    DFFTcc(tmp+n,dst+n,n2); // odd\n    // reorder and weight back (buterfly)\n    float a0,a1,b0,b1,a,b;\n    for (q=0,i=0,j=n;i&lt;n;i+=2,j+=2,q=(q+dq)&amp;mq)\n        {\n        a0=tmp[j  ]; a1=+_cos[q];\n        b0=tmp[j+1]; b1=+_sin[q];\n        a=(a0*a1)-(b0*b1);\n        b=(a0*b1)+(a1*b0);\n        a0=tmp[i  ]; a1=a;\n        b0=tmp[i+1]; b1=b;\n        dst[i  ]=(a0+a1)*0.5;\n        dst[i+1]=(b0+b1)*0.5;\n        dst[j  ]=(a0-a1)*0.5;\n        dst[j+1]=(b0-b1)*0.5;\n        }\n    }\n//---------------------------------------------------------------------------\nvoid draw(TCanvas *scr,int xs,int ys) // target canvas, resolution\n    {\n    int xs2,ys2;\n    Graphics::TBitmap *bmp;\n    xs2=xs&gt;&gt;1;\n    ys2=ys&gt;&gt;1;\n    bmp=new Graphics::TBitmap;\n    bmp-&gt;HandleType=bmDIB;\n    bmp-&gt;PixelFormat=pf32bit;\n    bmp-&gt;Width=xs;\n    bmp-&gt;Height=ys;\n    bmp-&gt;Canvas-&gt;Brush-&gt;Color=0x00000000;\n    bmp-&gt;Canvas-&gt;FillRect(TRect(0,0,xs,ys));\n\n    int i;\n    float x,y,scale=float(ys)/100.0;\n\n    // render image\n    bmp-&gt;Canvas-&gt;Pen-&gt;Color=0x00204080;\n                      i=0;      // DC offset\n    x=pic[i]*scale; i++;\n    y=pic[i]*scale; i++;\n    bmp-&gt;Canvas-&gt;MoveTo(x,y);\n    for (;i&lt;N2;)\n        {\n        x=pic[i]*scale; i++;\n        y=pic[i]*scale; i++;\n        bmp-&gt;Canvas-&gt;LineTo(x,y);\n        }\n\n    // render epicycles\n    bmp-&gt;Canvas-&gt;Pen-&gt;Color=0x00804020;\n    bmp-&gt;Canvas-&gt;Brush-&gt;Style=bsClear;\n\n    // iDFTcc src,dst\n    float dx,dy,a0,a1,b0,b1,q,qq,r,m;\n    q=+2.0*M_PI*tepi/float(N); x=0.0; y=0.0; m=0.5*scale;\n    for (qq=0.0,i=0;i&lt;N;i++,qq+=q)\n        {\n        a0=epi[i+i  ]; a1=+cos(qq);\n        b0=epi[i+i+1]; b1=-sin(qq);\n        dx=(a0*a1)-(b0*b1);\n        dy=(a0*b1)+(b0*a1);\n        r=sqrt((dx*dx)+(dy*dy));\n        bmp-&gt;Canvas-&gt;Ellipse((x-r)*m,(y-r)*m,(x+r)*m,(y+r)*m);\n        bmp-&gt;Canvas-&gt;MoveTo(x*m,y*m);\n        x+=dx; y+=dy;\n        bmp-&gt;Canvas-&gt;LineTo(x*m,y*m);\n        }\n    bmp-&gt;Canvas-&gt;Brush-&gt;Style=bsSolid;\n\n    scr-&gt;Draw(0,0,bmp);\n    delete bmp;\n    }\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner):TForm(Owner) // window init\n    {\n    // polygon -&gt; epicycles\n    DFFTcc(epi,pic,N);      // epi = DFFT(pic)\n    }\n//---------------------------------------------------------------------------\nvoid __fastcall TForm1::Timer1Timer(TObject *Sender) // animation timer\n    {\n    tepi++; if (tepi&gt;=N) tepi=0;\n    draw(Canvas,ClientWidth,ClientHeight);\n    }\n//---------------------------------------------------------------------------\n</code></pre>\n<p>here the <strong>data.h</strong> (both input and output so you can cross compare):</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>const int N=256;        // max num of points\nconst int N2=N+N;\nfloat pic[N2]=\n    {48.096,34.688,47.443,33.708,46.917,32.922,46.362,32.097,45.831,31.285,45.305,30.419,44.749,29.497,44.231,28.722,\n    43.585,28.030,42.913,27.403,42.365,26.683,41.731,25.885,41.067,25.326,40.175,24.850,39.323,24.587,38.265,24.372,\n    37.240,24.168,36.361,23.896,35.495,23.555,34.632,23.408,33.618,23.406,32.567,23.442,31.654,23.444,30.639,23.444,\n    29.728,23.444,28.727,23.444,27.720,23.444,26.791,23.442,25.709,23.426,24.655,23.423,23.733,23.476,22.765,23.667,\n    21.977,24.015,21.123,24.564,20.370,25.080,19.519,25.696,18.674,26.305,17.889,26.802,17.035,27.310,16.414,27.888,\n    15.924,28.776,15.553,29.712,15.234,30.585,14.926,31.587,14.662,32.425,14.376,33.394,14.180,34.298,14.029,35.383,\n    13.926,36.395,13.883,37.262,13.905,38.121,13.905,39.128,13.905,40.218,13.905,41.150,13.905,42.131,13.895,43.064,\n    13.859,44.161,13.894,45.140,14.153,45.910,14.644,46.671,15.162,47.508,15.754,48.444,16.213,49.175,16.708,50.081,\n    17.202,50.825,17.876,51.522,18.659,52.254,19.254,52.899,19.780,53.777,20.224,54.533,20.862,55.361,21.487,56.103,\n    22.064,56.718,22.740,57.327,23.554,58.027,24.381,58.689,25.154,59.155,26.009,59.658,26.662,60.264,27.410,61.062,\n    28.079,61.711,28.879,62.171,29.665,62.487,30.630,62.876,31.495,63.174,32.451,63.454,33.282,63.833,34.143,64.425,\n    35.002,65.010,35.844,65.422,36.745,65.851,37.423,66.404,38.061,67.127,38.790,67.604,39.720,68.025,40.537,68.462,\n    41.418,69.015,42.254,69.628,42.923,70.266,43.621,71.008,44.287,71.608,45.056,72.207,45.776,72.780,46.603,73.436,\n    47.393,74.115,48.017,74.773,48.606,75.542,49.110,76.309,49.654,77.242,50.127,78.130,50.467,78.966,50.824,79.855,\n    51.324,80.606,51.945,81.488,52.354,82.314,52.653,83.274,52.906,84.200,53.187,85.357,53.417,86.302,53.505,86.444,\n    53.460,85.643,53.437,84.646,53.476,83.631,53.591,82.619,53.737,81.567,53.856,80.644,53.982,79.630,54.145,78.764,\n    54.490,77.808,54.780,76.886,54.788,76.031,54.766,75.018,54.917,74.152,55.171,73.121,55.439,72.267,55.904,71.341,\n    56.362,70.476,56.566,69.588,56.665,68.541,56.846,67.665,57.210,66.793,57.593,65.928,58.030,64.966,58.480,63.966,\n    58.828,63.118,59.163,62.053,59.450,61.265,59.999,60.481,60.408,59.677,60.851,58.833,61.379,57.978,61.834,57.169,\n    62.263,56.268,62.691,55.443,63.207,54.582,63.804,53.720,64.390,53.027,65.106,52.285,65.846,51.604,66.575,51.061,\n    67.414,50.553,68.120,50.031,68.845,49.280,69.543,48.573,70.274,48.069,71.161,47.584,71.945,47.144,72.887,46.622,\n    73.662,46.143,74.472,45.514,75.217,44.887,75.907,44.338,76.697,43.704,77.405,43.129,78.224,42.456,78.922,41.846,\n    79.693,41.128,80.374,40.410,80.918,39.702,81.394,38.832,81.691,38.013,81.958,37.022,82.139,35.980,82.188,35.038,\n    82.165,33.948,82.139,33.011,82.185,32.034,82.106,31.188,81.866,30.293,81.480,29.382,81.033,28.555,80.480,27.656,\n    79.889,26.816,79.271,26.100,78.524,25.369,77.854,24.764,77.122,24.107,76.363,23.716,75.355,23.568,74.453,23.414,\n    73.501,23.030,72.627,22.679,71.611,22.306,70.707,22.095,69.663,22.132,68.812,22.021,67.886,21.782,66.890,21.638,\n    65.791,21.507,64.846,21.449,63.878,21.478,63.050,21.336,62.032,21.135,61.165,21.110,60.081,21.126,59.162,21.135,\n    58.164,21.135,57.233,21.132,56.186,21.078,55.135,21.080,54.313,21.305,53.566,21.831,52.803,22.309,51.859,22.817,\n    50.969,23.343,50.239,23.958,49.576,24.691,48.899,25.303,48.232,26.007,48.005,26.761,47.857,27.733,47.552,28.605,\n    47.172,29.621,46.885,30.613,46.785,31.593,46.812,32.663,46.890,33.511,47.198,34.330,47.198,34.330,47.198,34.330,\n    47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,\n    47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,\n    };\nfloat epi[N2]=\n    {95.280,89.953,-17.550,-49.533,6.344,7.333,6.259,7.659,4.980,2.621,-0.481,-0.499,0.779,0.595,0.154,-0.154,\n    0.239,-0.574,-0.535,0.244,-0.004,0.195,-0.152,0.501,0.046,0.143,-0.059,0.386,-0.024,-0.042,0.122,0.147,\n    0.034,0.009,0.129,0.086,-0.032,-0.036,0.101,0.007,0.018,-0.023,0.051,-0.006,-0.078,0.053,-0.004,0.016,\n    -0.010,0.063,0.000,0.028,-0.022,0.076,0.057,0.007,0.028,0.068,0.020,0.020,0.074,0.051,-0.024,0.018,\n    0.034,0.037,-0.050,-0.034,0.039,-0.006,-0.038,0.012,-0.003,0.010,-0.023,0.024,0.014,0.029,-0.012,0.007,\n    0.015,0.020,0.042,0.019,0.014,-0.022,0.045,0.015,-0.016,0.021,0.015,0.017,0.017,0.005,0.034,-0.001,\n    -0.018,0.013,-0.003,0.013,-0.014,0.033,0.017,0.016,0.017,0.023,-0.005,-0.015,0.020,0.022,-0.004,0.018,\n    0.009,0.008,0.009,0.001,0.012,0.025,-0.008,0.018,0.017,0.001,0.003,0.003,0.008,0.005,-0.003,0.001,\n    -0.006,0.015,-0.011,0.004,0.006,0.010,0.005,0.016,0.016,0.008,0.014,0.006,0.006,0.008,0.014,0.002,\n    -0.002,0.005,0.011,0.002,0.002,0.002,0.006,0.009,0.005,0.009,0.004,0.010,-0.001,0.012,0.004,0.005,\n    0.005,0.018,0.005,0.001,0.009,0.006,0.005,0.001,0.004,0.009,0.008,0.010,0.006,0.002,0.004,0.002,\n    0.002,0.002,0.002,0.007,0.005,0.005,0.001,0.002,0.004,0.001,0.005,0.007,0.005,0.011,0.004,0.008,\n    0.011,0.005,0.006,0.006,0.005,0.004,0.007,0.000,0.003,0.001,0.007,0.005,0.002,-0.000,0.006,0.002,\n    0.008,-0.003,0.002,0.013,0.018,0.010,-0.003,0.004,0.010,0.011,0.003,0.013,0.004,0.002,0.001,0.003,\n    0.013,0.009,0.014,-0.000,0.001,0.009,-0.003,-0.003,0.001,-0.003,0.002,0.006,0.002,0.008,0.002,0.005,\n    0.011,0.009,0.003,0.004,0.009,0.000,0.003,0.004,0.009,0.006,0.005,0.003,0.011,-0.001,0.006,-0.002,\n    -0.002,-0.001,0.005,0.007,0.007,0.010,0.010,0.006,-0.000,-0.001,0.002,0.006,-0.000,0.009,0.009,0.003,\n    0.007,0.005,0.004,0.004,0.005,0.002,0.009,0.001,0.004,0.006,0.004,-0.007,0.007,0.002,0.005,0.006,\n    -0.002,-0.005,0.005,0.002,0.003,0.005,0.013,0.012,-0.001,0.013,0.016,0.003,0.008,-0.006,0.007,0.007,\n    0.013,-0.000,0.003,0.001,0.004,0.007,0.004,0.009,-0.003,0.002,-0.002,0.002,0.001,0.001,0.008,0.005,\n    0.007,-0.000,0.005,0.005,0.008,0.004,0.011,0.003,0.005,0.000,0.007,-0.003,0.004,0.004,0.004,0.007,\n    0.002,0.001,0.010,-0.001,0.002,0.001,0.001,0.005,0.006,0.005,0.008,0.001,0.005,0.004,0.005,0.004,\n    0.002,0.004,0.008,0.004,0.009,0.004,0.014,-0.009,0.004,-0.000,0.000,0.005,0.002,-0.005,0.008,0.006,\n    0.005,-0.006,0.001,0.007,0.012,-0.004,0.007,0.011,0.012,-0.002,0.002,0.017,0.019,-0.017,0.020,0.004,\n    0.004,0.008,-0.002,0.006,0.002,0.005,0.012,0.011,-0.003,-0.001,0.025,-0.001,0.000,0.005,-0.001,-0.015,\n    0.010,0.000,-0.003,-0.001,0.003,0.031,0.004,0.014,0.020,0.006,0.012,-0.005,0.024,0.003,0.003,0.016,\n    0.009,-0.019,-0.019,-0.006,-0.010,-0.015,0.010,0.024,-0.003,-0.008,0.003,-0.002,0.023,-0.022,-0.007,0.038,\n    0.017,-0.027,0.042,0.010,0.032,-0.022,0.051,0.029,0.002,0.003,0.005,0.016,0.003,-0.014,-0.000,0.009,\n    -0.013,0.038,0.028,-0.008,0.031,0.017,0.055,-0.033,-0.053,0.073,-0.053,-0.032,0.074,0.053,-0.060,-0.058,\n    0.121,0.042,0.051,0.008,0.122,0.034,-0.051,-0.036,0.103,-0.025,-0.055,0.073,0.016,-0.064,-0.052,0.111,\n    0.085,-0.081,0.008,0.202,0.077,0.025,0.065,0.290,-0.002,-0.096,0.331,0.331,-0.079,0.070,0.467,0.246,\n    -0.526,-0.281,0.451,-0.037,-0.880,0.214,0.847,-0.670,-0.752,2.921,2.253,-4.359,-4.025,8.680,0.724,1.383,\n    };\n</code></pre>\n<p>and preview:</p>\n<p><a href=\"https://i.stack.imgur.com/kVjeT.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kVjeT.gif\" alt=\"heart animation\" /></a></p>\n<p>Now you just add the sorting of circles by radius if you want (now they are sorted by frequency)...</p>\n"},{"comments":[{"owner":{"account_id":19067173,"reputation":1,"user_id":13922062,"display_name":"Momin Ahmed"},"score":0,"creation_date":1684838901,"post_id":76313406,"comment_id":134572520,"body_markdown":"Yes you are absolutely correct. I was viewing a preview sorted by amplitude instead of frequency but I didn&#39;t realize it then. Thank you!","body":"Yes you are absolutely correct. I was viewing a preview sorted by amplitude instead of frequency but I didn&#39;t realize it then. Thank you!"},{"owner":{"account_id":2968584,"reputation":50571,"user_id":2521214,"accept_rate":71,"display_name":"Spektre"},"score":0,"creation_date":1684841986,"post_id":76313406,"comment_id":134573243,"body_markdown":"@MominAhmed this is true only for real input ... however for 2D real input you have to do both DFT/iDFT twice ... if you do this in complex domain from the start (almost no performance hit) then you need just single DFT/iDFT ...","body":"@MominAhmed this is true only for real input ... however for 2D real input you have to do both DFT/iDFT twice ... if you do this in complex domain from the start (almost no performance hit) then you need just single DFT/iDFT ..."}],"tags":[],"owner":{"account_id":16944613,"reputation":418,"user_id":12255620,"display_name":"MBobrik"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684835315,"creation_date":1684835315,"answer_id":76313406,"question_id":76299934,"body_markdown":"As far as I remember, this is absolutely normal with DFT - the frequency domain values are basically mirrored thru the middle - amplitude of the ```i```-th element is equal to the amplitude of the ```N-i```th element (they are complex conjugates of each other). See the examples in https://en.wikipedia.org/wiki/Discrete_Fourier_transform \r\n\r\nFrom back then when I was actually using it, we stored the data just up to N/2.\r\n\r\n","title":"Unexpected amplitude values in my implementation of DFT in java","body":"<p>As far as I remember, this is absolutely normal with DFT - the frequency domain values are basically mirrored thru the middle - amplitude of the <code>i</code>-th element is equal to the amplitude of the <code>N-i</code>th element (they are complex conjugates of each other). See the examples in <a href=\"https://en.wikipedia.org/wiki/Discrete_Fourier_transform\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Discrete_Fourier_transform</a></p>\n<p>From back then when I was actually using it, we stored the data just up to N/2.</p>\n"}],"owner":{"account_id":19067173,"reputation":1,"user_id":13922062,"display_name":"Momin Ahmed"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":69,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1684841780,"creation_date":1684672602,"question_id":76299934,"body_markdown":"I am working on a project to draw a given figure using epicycles (by DFT). I am following this website: https://www.instructables.com/Drawing-With-Discrete-Fourier-Transform/ but I don&#39;t seem to be getting correct values for the amplitudes because for any sample of points, the amplitude increases in the end (at higher frequencies) while I don&#39;t think it should - at least not according to the examples in the website.\r\n\r\nThe function takes a double[][] as input containing x and y coordinates of sample points and Points.n is the number of sample points. Here is my DFT function:\r\n```\r\npublic class Dft {\r\n    public static double[][] dft(double[][] psamples){\r\n        double[][] result = new double[Points.n][2];\r\n        for (int i = 0; i &lt; Points.n; i++){\r\n            Complex x_i = new Complex(0, 0);\r\n            for (int j = 0; j &lt; Points.n; j++){\r\n                Complex sample = new Complex(psamples[j][0], psamples[j][1]);\r\n                double root = Math.PI*2*i*j/Points.n;\r\n                Complex unity = new Complex(Math.cos(root), -Math.sin(root));\r\n                x_i = Complex.add(x_i, Complex.multiply(sample, unity));\r\n            }\r\n            result[i][0] = x_i.amp()/Points.n; //amplitude\r\n            result[i][1] = x_i.angle(); //phase change\r\n            //frequency is equal to the index number i\r\n            System.out.println(i + &quot; amp: &quot; + result[i][0] + &quot; phase change: &quot; + result[i][1]);\r\n        }\r\n        return result;\r\n    } \r\n}\r\n\r\n```\r\n\r\nThe Complex class is :\r\n```\r\npublic class Complex {\r\n    double[] num = {0,0};\r\n    public Complex(double a, double b){\r\n        num[0] = a;\r\n        num[1] = b;\r\n    }\r\n    public void setReal(double a){\r\n        num[0] = a;\r\n    }\r\n    public void setImaginary(double b){\r\n        num[1] = b;\r\n    }\r\n    public double getReal(){\r\n        return num[0];\r\n    }\r\n    public double getImaginary(){\r\n        return num[1];\r\n    }\r\n    public static Complex add(Complex a, Complex b){\r\n        Complex result = new Complex(a.getReal()+b.getReal(), a.getImaginary() + b.getImaginary());\r\n        return result;\r\n    }\r\n    public static Complex euler(double r, double theta){\r\n        Complex result = new Complex(r*Math.cos(theta), r*Math.sin(theta));\r\n        return result;\r\n    }\r\n    public static Complex multiply(Complex a, Complex b){\r\n        Complex result = new Complex(a.getReal()*b.getReal() - a.getImaginary()*b.getImaginary(), a.getReal()*b.getImaginary() + a.getImaginary()*b.getReal());\r\n        return result;\r\n    }\r\n    public double amp(){\r\n        double result = Math.sqrt(num[0]*num[0] + num[1]*num[1]);\r\n        return result;\r\n    }\r\n    public double angle(){\r\n        if (num[0] == 0){\r\n            if (num[1]&gt;0) return Math.PI/2;\r\n            else if (num[1]&lt;0) return -Math.PI/2;\r\n            else return 0;\r\n        }\r\n        else {\r\n        double result = Math.atan2(num[1],num[0]);\r\n        return result;\r\n        }\r\n    }\r\n} \r\n\r\n```","title":"Unexpected amplitude values in my implementation of DFT in java","body":"<p>I am working on a project to draw a given figure using epicycles (by DFT). I am following this website: <a href=\"https://www.instructables.com/Drawing-With-Discrete-Fourier-Transform/\" rel=\"nofollow noreferrer\">https://www.instructables.com/Drawing-With-Discrete-Fourier-Transform/</a> but I don't seem to be getting correct values for the amplitudes because for any sample of points, the amplitude increases in the end (at higher frequencies) while I don't think it should - at least not according to the examples in the website.</p>\n<p>The function takes a double[][] as input containing x and y coordinates of sample points and Points.n is the number of sample points. Here is my DFT function:</p>\n<pre><code>public class Dft {\n    public static double[][] dft(double[][] psamples){\n        double[][] result = new double[Points.n][2];\n        for (int i = 0; i &lt; Points.n; i++){\n            Complex x_i = new Complex(0, 0);\n            for (int j = 0; j &lt; Points.n; j++){\n                Complex sample = new Complex(psamples[j][0], psamples[j][1]);\n                double root = Math.PI*2*i*j/Points.n;\n                Complex unity = new Complex(Math.cos(root), -Math.sin(root));\n                x_i = Complex.add(x_i, Complex.multiply(sample, unity));\n            }\n            result[i][0] = x_i.amp()/Points.n; //amplitude\n            result[i][1] = x_i.angle(); //phase change\n            //frequency is equal to the index number i\n            System.out.println(i + &quot; amp: &quot; + result[i][0] + &quot; phase change: &quot; + result[i][1]);\n        }\n        return result;\n    } \n}\n\n</code></pre>\n<p>The Complex class is :</p>\n<pre><code>public class Complex {\n    double[] num = {0,0};\n    public Complex(double a, double b){\n        num[0] = a;\n        num[1] = b;\n    }\n    public void setReal(double a){\n        num[0] = a;\n    }\n    public void setImaginary(double b){\n        num[1] = b;\n    }\n    public double getReal(){\n        return num[0];\n    }\n    public double getImaginary(){\n        return num[1];\n    }\n    public static Complex add(Complex a, Complex b){\n        Complex result = new Complex(a.getReal()+b.getReal(), a.getImaginary() + b.getImaginary());\n        return result;\n    }\n    public static Complex euler(double r, double theta){\n        Complex result = new Complex(r*Math.cos(theta), r*Math.sin(theta));\n        return result;\n    }\n    public static Complex multiply(Complex a, Complex b){\n        Complex result = new Complex(a.getReal()*b.getReal() - a.getImaginary()*b.getImaginary(), a.getReal()*b.getImaginary() + a.getImaginary()*b.getReal());\n        return result;\n    }\n    public double amp(){\n        double result = Math.sqrt(num[0]*num[0] + num[1]*num[1]);\n        return result;\n    }\n    public double angle(){\n        if (num[0] == 0){\n            if (num[1]&gt;0) return Math.PI/2;\n            else if (num[1]&lt;0) return -Math.PI/2;\n            else return 0;\n        }\n        else {\n        double result = Math.atan2(num[1],num[0]);\n        return result;\n        }\n    }\n} \n\n</code></pre>\n"},{"tags":["java","spring-boot"],"comments":[{"owner":{"account_id":446597,"reputation":22464,"user_id":839733,"accept_rate":69,"display_name":"Abhijit Sarkar"},"score":1,"creation_date":1684840558,"post_id":76314044,"comment_id":134572897,"body_markdown":"Postman doesn&#39;t download anything, it&#39;s not a browser.","body":"Postman doesn&#39;t download anything, it&#39;s not a browser."},{"owner":{"account_id":19147932,"reputation":5,"user_id":13986471,"display_name":"Ranjith Kumar"},"score":0,"creation_date":1684841007,"post_id":76314044,"comment_id":134573005,"body_markdown":"@AbhijitSarkar if i try to downloading from swagger, it is saying `Unable to open file. The file may corrupted`. But the file downloaded through postman is working fine. Is there anything i need to handle in code for that ?","body":"@AbhijitSarkar if i try to downloading from swagger, it is saying <code>Unable to open file. The file may corrupted</code>. But the file downloaded through postman is working fine. Is there anything i need to handle in code for that ?"},{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1684841288,"post_id":76314044,"comment_id":134573075,"body_markdown":"`File file = /*assigning/creating my file here*/` doesn&#39;t create a file, whatever may be in this initializer. Unclear what you&#39;re asking.","body":"<code>File file = &#47;*assigning&#47;creating my file here*&#47;</code> doesn&#39;t create a file, whatever may be in this initializer. Unclear what you&#39;re asking."}],"answers":[{"tags":[],"owner":{"account_id":372682,"reputation":22461,"user_id":721855,"display_name":"aled"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1684841600,"creation_date":1684841600,"answer_id":76314279,"question_id":76314044,"body_markdown":"You are setting the wrong content type in the response. You are setting in to a binary (`MediaType.APPLICATION_OCTET_STREAM`), so it is interpreted as a binary file by the browser. You should set it to what you already said in the `produces` attribute it returns, an Excel file: `application/vnd.ms-excel`.","title":"How to download file in java","body":"<p>You are setting the wrong content type in the response. You are setting in to a binary (<code>MediaType.APPLICATION_OCTET_STREAM</code>), so it is interpreted as a binary file by the browser. You should set it to what you already said in the <code>produces</code> attribute it returns, an Excel file: <code>application/vnd.ms-excel</code>.</p>\n"},{"tags":[],"owner":{"account_id":7655262,"reputation":7506,"user_id":5802417,"display_name":"Michael Gantman"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1684841691,"creation_date":1684841691,"answer_id":76314290,"question_id":76314044,"body_markdown":"No, what you send over HTTP is binary information, so you receive it as BLOB. It is up to a convention between the server and client to know that the information that you download is a file of a particular type. So, say if I am a server-side developer and I developed an end-point that reads and returns say a document in format PDF I should provide the information to a client that return type is file of type PDF. This could be done with headers but also as documentation. So, when a client invokes my end-point (s)he will receive a BLOB that the client needs to save as a file with .pdf extension.","title":"How to download file in java","body":"<p>No, what you send over HTTP is binary information, so you receive it as BLOB. It is up to a convention between the server and client to know that the information that you download is a file of a particular type. So, say if I am a server-side developer and I developed an end-point that reads and returns say a document in format PDF I should provide the information to a client that return type is file of type PDF. This could be done with headers but also as documentation. So, when a client invokes my end-point (s)he will receive a BLOB that the client needs to save as a file with .pdf extension.</p>\n"}],"owner":{"account_id":19147932,"reputation":5,"user_id":13986471,"display_name":"Ranjith Kumar"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":83,"favorite_count":0,"down_vote_count":3,"up_vote_count":0,"closed_date":1684842819,"answer_count":2,"score":-3,"last_activity_date":1684841691,"creation_date":1684840026,"question_id":76314044,"body_markdown":"I&#39;m trying to download excel in java, but instead of downloading as File, it is returning as blob type.\r\n\r\nI tried the below code to download the excel in java8.\r\n\r\n```\r\nimport java.io.File;\r\nimport java.io.FileInputStream;\r\n\r\nimport org.springframework.core.io.InputStreamResource;\r\nimport org.springframework.core.io.Resource;\r\nimport org.springframework.http.HttpHeaders;\r\nimport org.springframework.http.MediaType;\r\nimport org.springframework.http.ResponseEntity;\r\nimport org.springframework.web.bind.annotation.RequestParam;\r\n\r\n@PostMapping(value = &quot;/download-report&quot;, produces = &quot;application/vnd.ms-excel&quot;)\r\npublic ResponseEntity&lt;Resource&gt; getSrmTallyReportInExcel() {\r\n    try {\r\n        File file = /*assigning/creating my file here*/;\r\n        InputStreamResource resource = new InputStreamResource(new FileInputStream(file));\r\n        \r\n        HttpHeaders headers = new HttpHeaders();\r\n        headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);\r\n        headers.setContentDispositionFormData(&quot;attachment&quot;, &quot;report.xlsx&quot;);\r\n        \r\n        return ResponseEntity.ok().headers(headers).body(resource);\r\n    catch (Exception e) {}\r\n}\r\n```\r\n\r\nWhen i run in postman, instead of downloading file directly, it is returning the response in this format(�L������Pk�&quot;�W��9�˰�) which i can download as excel file by clicking on Save as File.\r\nBut i wish to download directly without click that Save as File option. is there any way to do that?","title":"How to download file in java","body":"<p>I'm trying to download excel in java, but instead of downloading as File, it is returning as blob type.</p>\n<p>I tried the below code to download the excel in java8.</p>\n<pre><code>import java.io.File;\nimport java.io.FileInputStream;\n\nimport org.springframework.core.io.InputStreamResource;\nimport org.springframework.core.io.Resource;\nimport org.springframework.http.HttpHeaders;\nimport org.springframework.http.MediaType;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.RequestParam;\n\n@PostMapping(value = &quot;/download-report&quot;, produces = &quot;application/vnd.ms-excel&quot;)\npublic ResponseEntity&lt;Resource&gt; getSrmTallyReportInExcel() {\n    try {\n        File file = /*assigning/creating my file here*/;\n        InputStreamResource resource = new InputStreamResource(new FileInputStream(file));\n        \n        HttpHeaders headers = new HttpHeaders();\n        headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);\n        headers.setContentDispositionFormData(&quot;attachment&quot;, &quot;report.xlsx&quot;);\n        \n        return ResponseEntity.ok().headers(headers).body(resource);\n    catch (Exception e) {}\n}\n</code></pre>\n<p>When i run in postman, instead of downloading file directly, it is returning the response in this format(�L������Pk�&quot;�W��9�˰�) which i can download as excel file by clicking on Save as File.\nBut i wish to download directly without click that Save as File option. is there any way to do that?</p>\n"},{"tags":["java","spring","spring-boot"],"answers":[{"comments":[{"owner":{"account_id":3735431,"reputation":117,"user_id":3106470,"display_name":"Zhang Li"},"score":0,"creation_date":1684897403,"post_id":76314262,"comment_id":134583185,"body_markdown":"I found my file is logback-spring.xml. These are the lines\nclass=&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&gt;\n&lt;pattern&gt;${FILE_LOG_PATTERN}&lt;/pattern&gt;\nI had hoped to override the %logger value, but didn&#39;t succeed. So I just modify the ${FILE_LOG_PATTERN} to &quot;%d %p %c [%t] %m%n&quot;","body":"I found my file is logback-spring.xml. These are the lines class=&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&gt; &lt;pattern&gt;${FILE_LOG_PATTERN}&lt;/pattern&gt; I had hoped to override the %logger value, but didn&#39;t succeed. So I just modify the ${FILE_LOG_PATTERN} to &quot;%d %p %c [%t] %m%n&quot;"}],"tags":[],"owner":{"account_id":8761405,"reputation":1504,"user_id":6551263,"display_name":"Chetan Ahirrao"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1684841535,"creation_date":1684841535,"answer_id":76314262,"question_id":76310764,"body_markdown":"Check your log pattern in logback.xml. \r\nThere will be `logger` pattern inside it like `%logger{30}` \r\n&lt;br/&gt; You can specify the length limit in curly braces. If the fully qualified class name is bigger than this length, it will be shortened. Only the last part i.e. classname will not be shortened. &lt;br&gt; If you don&#39;t want any limit and always want to print the Fully qualified class name, mention `%logger` without any curly braces. &lt;br/&gt; You can check official documentation for more details at &lt;a href=&quot;https://logback.qos.ch/manual/layouts.html#conversionWord&quot; title=&quot;Layout&quot;&gt;Layout&lt;/a&gt;","title":"How to en-large the package name field in springboot log","body":"<p>Check your log pattern in logback.xml.\nThere will be <code>logger</code> pattern inside it like <code>%logger{30}</code>\n<br/> You can specify the length limit in curly braces. If the fully qualified class name is bigger than this length, it will be shortened. Only the last part i.e. classname will not be shortened. <br> If you don't want any limit and always want to print the Fully qualified class name, mention <code>%logger</code> without any curly braces. <br/> You can check official documentation for more details at <a href=\"https://logback.qos.ch/manual/layouts.html#conversionWord\" rel=\"nofollow noreferrer\" title=\"Layout\">Layout</a></p>\n"}],"owner":{"account_id":3735431,"reputation":117,"user_id":3106470,"display_name":"Zhang Li"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":42,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76314262,"answer_count":1,"score":1,"last_activity_date":1684841535,"creation_date":1684805125,"question_id":76310764,"body_markdown":"I am new to spring and now checking a large code base, so I want to enable detailed logs. Now I got some logs like\r\n\r\n    2023-05-22 13:21:20.504  INFO 76276 --- [           main] com.zaxxer.hikari.HikariDataSource       : DatebookHikariCP - Starting...\r\n    2023-05-22 13:21:20.716  INFO 76276 --- [           main] com.zaxxer.hikari.HikariDataSource       : DatebookHikariCP - Start completed.\r\n    2023-05-22 13:21:20.721 DEBUG 76276 --- [           main] c.w.d.S.selectAllProperties              : ==&gt;  Preparing: SELECT SKEY, SDATA FROM SYS_PROPERTY \r\n    2023-05-22 13:21:20.734 DEBUG 76276 --- [           main] c.w.d.S.selectAllProperties              : ==&gt; Parameters\r\n\r\n\r\nFrom the log, it seems when the package name is large, it will be shortened gracefully. I hope I can configure the maximum allowed length of the field, so that I can see the full name of the package for most cases. \r\nIs there any config item for it? Or any other way for the purpose?","title":"How to en-large the package name field in springboot log","body":"<p>I am new to spring and now checking a large code base, so I want to enable detailed logs. Now I got some logs like</p>\n<pre><code>2023-05-22 13:21:20.504  INFO 76276 --- [           main] com.zaxxer.hikari.HikariDataSource       : DatebookHikariCP - Starting...\n2023-05-22 13:21:20.716  INFO 76276 --- [           main] com.zaxxer.hikari.HikariDataSource       : DatebookHikariCP - Start completed.\n2023-05-22 13:21:20.721 DEBUG 76276 --- [           main] c.w.d.S.selectAllProperties              : ==&gt;  Preparing: SELECT SKEY, SDATA FROM SYS_PROPERTY \n2023-05-22 13:21:20.734 DEBUG 76276 --- [           main] c.w.d.S.selectAllProperties              : ==&gt; Parameters\n</code></pre>\n<p>From the log, it seems when the package name is large, it will be shortened gracefully. I hope I can configure the maximum allowed length of the field, so that I can see the full name of the package for most cases.\nIs there any config item for it? Or any other way for the purpose?</p>\n"},{"tags":["java","android","webview","android-webview","android-animation"],"owner":{"account_id":21101320,"reputation":362,"user_id":15511159,"display_name":"Faizan Ahmad"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":26,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684841173,"creation_date":1684841173,"question_id":76314211,"body_markdown":"I am loading SVG animations in the android WebView using Java.\r\nMy WebView code in XML is:\r\n\r\n            &lt;WebView\r\n            android:id=&quot;@+id/animationView&quot;\r\n            android:layout_width=&quot;135dp&quot;\r\n            android:layout_height=&quot;135dp&quot;\r\n            android:adjustViewBounds=&quot;false&quot;/&gt;\r\n\r\nTo load SVG:\r\n\r\n            webView.getSettings().setCacheMode(WebSettings.LOAD_NO_CACHE);\r\n            webView.clearCache(true);\r\n            webView.getSettings().setLoadWithOverviewMode(true);\r\n            webView.getSettings().setUseWideViewPort(true);\r\n            webView.getSettings().setJavaScriptEnabled(true);\r\n\r\n            webView.setPadding(0, 0, 0, 0);\r\n            webView.setInitialScale(1);\r\n            webView.getSettings().setBuiltInZoomControls(false);\r\n\r\n            webView.loadUrl(&quot;file:///android_asset/xyz.svg&quot;);\r\n            webView.setBackgroundColor(Color.TRANSPARENT);\r\n            webView.setVisibility(View.VISIBLE);\r\n\r\nThis is working fine. It is fitting SVG in the web view by zooming out.\r\nBut sometimes, it is loading SVG by doing too much Zoom In. Sometimes SVG is too much zoomed, unable to resolve it.\r\nThis issue is happening once within 10 attempts.\r\n","title":"WebView is zoomedIn on some Android devices","body":"<p>I am loading SVG animations in the android WebView using Java.\nMy WebView code in XML is:</p>\n<pre><code>        &lt;WebView\n        android:id=&quot;@+id/animationView&quot;\n        android:layout_width=&quot;135dp&quot;\n        android:layout_height=&quot;135dp&quot;\n        android:adjustViewBounds=&quot;false&quot;/&gt;\n</code></pre>\n<p>To load SVG:</p>\n<pre><code>        webView.getSettings().setCacheMode(WebSettings.LOAD_NO_CACHE);\n        webView.clearCache(true);\n        webView.getSettings().setLoadWithOverviewMode(true);\n        webView.getSettings().setUseWideViewPort(true);\n        webView.getSettings().setJavaScriptEnabled(true);\n\n        webView.setPadding(0, 0, 0, 0);\n        webView.setInitialScale(1);\n        webView.getSettings().setBuiltInZoomControls(false);\n\n        webView.loadUrl(&quot;file:///android_asset/xyz.svg&quot;);\n        webView.setBackgroundColor(Color.TRANSPARENT);\n        webView.setVisibility(View.VISIBLE);\n</code></pre>\n<p>This is working fine. It is fitting SVG in the web view by zooming out.\nBut sometimes, it is loading SVG by doing too much Zoom In. Sometimes SVG is too much zoomed, unable to resolve it.\nThis issue is happening once within 10 attempts.</p>\n"},{"tags":["java","spring-boot","jwt","rest"],"comments":[{"owner":{"account_id":3925658,"reputation":5569,"user_id":3246362,"display_name":"Sam"},"score":7,"creation_date":1631290577,"post_id":69134968,"comment_id":122190837,"body_markdown":"Your token does not contain a username, so focus your effort to the creation part.","body":"Your token does not contain a username, so focus your effort to the creation part."},{"owner":{"account_id":22514761,"reputation":1572,"user_id":16709163,"display_name":"ray"},"score":2,"creation_date":1631291287,"post_id":69134968,"comment_id":122191038,"body_markdown":"Couldn&#39;t find any user related data in your token. Paste your JWT token [here](https://jwt.io/). You need to add user related data inside your token when you crates them.","body":"Couldn&#39;t find any user related data in your token. Paste your JWT token <a href=\"https://jwt.io/\" rel=\"nofollow noreferrer\">here</a>. You need to add user related data inside your token when you crates them."},{"owner":{"account_id":19092422,"reputation":51311,"user_id":13942448,"display_name":"jccampanero"},"score":1,"creation_date":1631469956,"post_id":69134968,"comment_id":122224693,"body_markdown":"As indicated by sam and ray, your token does not contain any user information (if you copy and paste the token in jet.io, for instance, it will provide no `sub` value in the payload). The create `createAuthenticationToken` method looks fine as well as `generateToken`. Please, try debugging your &#217;serDetails` instance before this line: `final String token = jwtTokenUtil.generateToken(userDetails);`. Also, be sure that your `UserDetails` correctly implements the `getUsername` method, sometimes we derived it from the database and we didn&#39;t implement it correctly. Try debugging the method ...","body":"As indicated by sam and ray, your token does not contain any user information (if you copy and paste the token in jet.io, for instance, it will provide no <code>sub</code> value in the payload). The create <code>createAuthenticationToken</code> method looks fine as well as <code>generateToken</code>. Please, try debugging your &#217;serDetails` instance before this line: <code>final String token = jwtTokenUtil.generateToken(userDetails);</code>. Also, be sure that your <code>UserDetails</code> correctly implements the <code>getUsername</code> method, sometimes we derived it from the database and we didn&#39;t implement it correctly. Try debugging the method ..."},{"owner":{"account_id":19092422,"reputation":51311,"user_id":13942448,"display_name":"jccampanero"},"score":1,"creation_date":1631469994,"post_id":69134968,"comment_id":122224696,"body_markdown":"`doGenerateToken` as well, and see the value of the `subject` variable. I hope I helps.","body":"<code>doGenerateToken</code> as well, and see the value of the <code>subject</code> variable. I hope I helps."},{"owner":{"account_id":19092422,"reputation":51311,"user_id":13942448,"display_name":"jccampanero"},"score":1,"creation_date":1631480441,"post_id":69134968,"comment_id":122226991,"body_markdown":"Sorry, I want to say [jwt.io](https://jwt.io), not jet.io. My computer translator.","body":"Sorry, I want to say <a href=\"https://jwt.io\" rel=\"nofollow noreferrer\">jwt.io</a>, not jet.io. My computer translator."},{"owner":{"account_id":14129013,"reputation":1232,"user_id":10207455,"display_name":"Dhanraj"},"score":1,"creation_date":1631883160,"post_id":69134968,"comment_id":122350493,"body_markdown":"@Value(&quot;${jwt.header}&quot;)\n    private String tokenHeader;  in AuthenticationRestController,  you are bringing the header part only.. trying using jwt.payload instead jwt.header of  to get Subject Details","body":"@Value(&quot;${jwt.header}&quot;)     private String tokenHeader;  in AuthenticationRestController,  you are bringing the header part only.. trying using jwt.payload instead jwt.header of  to get Subject Details"},{"owner":{"account_id":22514761,"reputation":1572,"user_id":16709163,"display_name":"ray"},"score":0,"creation_date":1631889730,"post_id":69134968,"comment_id":122353587,"body_markdown":"@Nunyet what is the `UserSecurityService`? Is it your own implementation?","body":"@Nunyet what is the <code>UserSecurityService</code>? Is it your own implementation?"}],"answers":[{"tags":[],"owner":{"account_id":1546031,"reputation":1931,"user_id":1439560,"display_name":"Huy Nguyen"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1631949953,"creation_date":1631949618,"answer_id":69232482,"question_id":69134968,"body_markdown":"Double check your jwt token. I think it miss sub attribute( subject or username here).\r\n\r\nI also highly recommend you write the few unit test for few class such as JwtTokenUtil to make sure your code working as expected. You can use spring-test to do it easily.  \r\n\r\nIt help you discover the bug easier and sooner. \r\n\r\nHere is few test which i used to test the commands &quot;jwt generate&quot; and &quot;jwt parse&quot;\r\n\r\n    @Test\r\n      public void testInvalidKey() {\r\n        String result = execute(&quot;jwt generate &quot;);\r\n        Assertions.assertEquals(JsonWebToken.ERR_LOAD_PRIVATE_KEY, result);\r\n      }\r\n    \r\n      @Test\r\n      public void testInvalidExpiredDate() {\r\n        String result = execute(\r\n            &quot;jwt generate -exp \\&quot;12-12-2020\\&quot;&quot;);\r\n        Assertions.assertEquals(JsonWebToken.ERR_INVALID_EXPIRED_DATE, result);\r\n      }\r\n    \r\n      @Test\r\n      public void testGenerateOk() {\r\n        String result = execute(\r\n            &quot;jwt generate&quot;);\r\n        Assertions.assertNotNull(result);\r\n        Assertions.assertTrue(result.length() &gt; 100);\r\n      }\r\n    \r\n      @Test\r\n      public void testParseToken() {\r\n        String result = execute(\r\n            &quot;jwt generate -sub designer&quot;);\r\n        Assertions.assertNotNull(result);\r\n        String parse = execute(&quot;jwt parse -token &quot; + result);    \r\n        Assertions.assertTrue(parse.contains(&quot;sub:designer&quot;));\r\n      }\r\n\r\nAnd here is few other test which i used to check the controller and filter.\r\n\r\n    @Test\r\n      public void testInValidToken() throws Exception{\r\n        Map&lt;String, Object&gt; map = new LinkedHashMap&lt;&gt;(reqObj);\r\n          mockMvc.perform(postWithTokenAndData(getUrlProvider(), map)\r\n              .header(HEADER_AUTHORIZATION, String.format(&quot;Bearer %s&quot;, INVALID_JWT))\r\n              .contentType(MediaType.APPLICATION_JSON))\r\n              .andExpect(MockMvcResultMatchers.status().is4xxClientError());\r\n      }\r\n      \r\n      @Test\r\n      public void testExpired() throws Exception{\r\n        Date exp = Date.from(Instant.now().minusSeconds(3600));\r\n          Map&lt;String, Object&gt; map = new LinkedHashMap&lt;&gt;(reqObj);\r\n          mockMvc.perform(postWithTokenAndData(getUrlProvider(), map)\r\n              .header(HEADER_AUTHORIZATION, String.format(&quot;Bearer %s&quot;, JwtHelperTest.getJwtToken(exp,\r\n                  &quot;designer&quot;)))\r\n              .contentType(MediaType.APPLICATION_JSON))\r\n              .andExpect(MockMvcResultMatchers.status().is4xxClientError());\r\n      }\r\n\r\n  \r\n  \r\n  \r\n  ","title":"Spring Security with JWT for REST API","body":"<p>Double check your jwt token. I think it miss sub attribute( subject or username here).</p>\n<p>I also highly recommend you write the few unit test for few class such as JwtTokenUtil to make sure your code working as expected. You can use spring-test to do it easily.</p>\n<p>It help you discover the bug easier and sooner.</p>\n<p>Here is few test which i used to test the commands &quot;jwt generate&quot; and &quot;jwt parse&quot;</p>\n<pre><code>@Test\n  public void testInvalidKey() {\n    String result = execute(&quot;jwt generate &quot;);\n    Assertions.assertEquals(JsonWebToken.ERR_LOAD_PRIVATE_KEY, result);\n  }\n\n  @Test\n  public void testInvalidExpiredDate() {\n    String result = execute(\n        &quot;jwt generate -exp \\&quot;12-12-2020\\&quot;&quot;);\n    Assertions.assertEquals(JsonWebToken.ERR_INVALID_EXPIRED_DATE, result);\n  }\n\n  @Test\n  public void testGenerateOk() {\n    String result = execute(\n        &quot;jwt generate&quot;);\n    Assertions.assertNotNull(result);\n    Assertions.assertTrue(result.length() &gt; 100);\n  }\n\n  @Test\n  public void testParseToken() {\n    String result = execute(\n        &quot;jwt generate -sub designer&quot;);\n    Assertions.assertNotNull(result);\n    String parse = execute(&quot;jwt parse -token &quot; + result);    \n    Assertions.assertTrue(parse.contains(&quot;sub:designer&quot;));\n  }\n</code></pre>\n<p>And here is few other test which i used to check the controller and filter.</p>\n<pre><code>@Test\n  public void testInValidToken() throws Exception{\n    Map&lt;String, Object&gt; map = new LinkedHashMap&lt;&gt;(reqObj);\n      mockMvc.perform(postWithTokenAndData(getUrlProvider(), map)\n          .header(HEADER_AUTHORIZATION, String.format(&quot;Bearer %s&quot;, INVALID_JWT))\n          .contentType(MediaType.APPLICATION_JSON))\n          .andExpect(MockMvcResultMatchers.status().is4xxClientError());\n  }\n  \n  @Test\n  public void testExpired() throws Exception{\n    Date exp = Date.from(Instant.now().minusSeconds(3600));\n      Map&lt;String, Object&gt; map = new LinkedHashMap&lt;&gt;(reqObj);\n      mockMvc.perform(postWithTokenAndData(getUrlProvider(), map)\n          .header(HEADER_AUTHORIZATION, String.format(&quot;Bearer %s&quot;, JwtHelperTest.getJwtToken(exp,\n              &quot;designer&quot;)))\n          .contentType(MediaType.APPLICATION_JSON))\n          .andExpect(MockMvcResultMatchers.status().is4xxClientError());\n  }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":28634365,"reputation":26,"user_id":21924752,"display_name":"user21924752"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1684490291,"creation_date":1684490291,"answer_id":76287985,"question_id":69134968,"body_markdown":"`enter code here`@Component\r\npublic class JwtUtil {\r\n\t\r\n\t @Value(&quot;${jwt.secret}&quot;)\r\n\t    private String secret;\r\n\t\r\n\t @Value(&quot;${jwt.expiration}&quot;) \r\n\t private Long expiration;\r\n\t \r\n\t Date now =new Date();\r\n\t Date ExpirationDate =new Date(now.getTime()+ expiration*1000);\r\n\r\n\tpublic User getUser(final String token) {\r\n\t\tClaims body = Jwts.parser()\r\n                .setSigningKey(secret)\r\n                .parseClaimsJws(token)\r\n                .getBody();\r\n\r\n        User u = new User();\r\n        u.setUsername(body.getSubject());\r\n        u.setUserId(Integer.parseInt((String) body.get(&quot;userId&quot;)));\r\n        Set&lt;Role&gt; roles =new HashSet&lt;&gt;(); \r\n        roles.add(Role.CONSUMER);\r\n        roles.add(Role.SELLER);\r\n        u.setRoles(roles);\r\n        return u;\r\n\t}\r\n\r\n\tpublic String generateToken(String username) {\r\n\t\t   User u = new User();\r\n\t\t  Claims claims = Jwts.claims().setSubject(username);\r\n\t        claims.put(&quot;userId&quot;, u.getUserId());\r\n\t        Set&lt;Role&gt; roles =new HashSet&lt;&gt;(); \r\n\t        roles.add(Role.CONSUMER);\r\n\t        roles.add(Role.SELLER);\r\n\t        claims.put(&quot;role&quot;,roles );\r\n\r\n\t        return Jwts.builder()\r\n\t                .setClaims(claims)\r\n\t                .setIssuedAt(now)\r\n\t                .setExpiration( ExpirationDate)\r\n\t                .signWith(SignatureAlgorithm.HS512, secret)\r\n\t                .compact();\r\n\t\t\r\n\t}\r\n\r\n\tpublic boolean validateToken(final String token) {\r\n\t\treturn getClaims(secret,token)\r\n\t\t\t\t.getExpiration()\r\n\t\t\t\t.after(new Date (System.currentTimeMillis()));\r\n\t}\r\n\t\r\n\tpublic Claims getClaims(String secret ,String token) {\r\n\t\treturn Jwts.parser()\r\n\t\t\t\t.setSigningKey(secret)\r\n\t\t\t\t.parseClaimsJws(token)\r\n\t\t\t\t.getBody();\r\n\t}\r\n}","title":"Spring Security with JWT for REST API","body":"<p><code>enter code here</code>@Component\npublic class JwtUtil {</p>\n<pre><code> @Value(&quot;${jwt.secret}&quot;)\n    private String secret;\n\n @Value(&quot;${jwt.expiration}&quot;) \n private Long expiration;\n \n Date now =new Date();\n Date ExpirationDate =new Date(now.getTime()+ expiration*1000);\n\npublic User getUser(final String token) {\n    Claims body = Jwts.parser()\n            .setSigningKey(secret)\n            .parseClaimsJws(token)\n            .getBody();\n\n    User u = new User();\n    u.setUsername(body.getSubject());\n    u.setUserId(Integer.parseInt((String) body.get(&quot;userId&quot;)));\n    Set&lt;Role&gt; roles =new HashSet&lt;&gt;(); \n    roles.add(Role.CONSUMER);\n    roles.add(Role.SELLER);\n    u.setRoles(roles);\n    return u;\n}\n\npublic String generateToken(String username) {\n       User u = new User();\n      Claims claims = Jwts.claims().setSubject(username);\n        claims.put(&quot;userId&quot;, u.getUserId());\n        Set&lt;Role&gt; roles =new HashSet&lt;&gt;(); \n        roles.add(Role.CONSUMER);\n        roles.add(Role.SELLER);\n        claims.put(&quot;role&quot;,roles );\n\n        return Jwts.builder()\n                .setClaims(claims)\n                .setIssuedAt(now)\n                .setExpiration( ExpirationDate)\n                .signWith(SignatureAlgorithm.HS512, secret)\n                .compact();\n    \n}\n\npublic boolean validateToken(final String token) {\n    return getClaims(secret,token)\n            .getExpiration()\n            .after(new Date (System.currentTimeMillis()));\n}\n\npublic Claims getClaims(String secret ,String token) {\n    return Jwts.parser()\n            .setSigningKey(secret)\n            .parseClaimsJws(token)\n            .getBody();\n}\n</code></pre>\n<p>}</p>\n"}],"owner":{"account_id":5619788,"reputation":4111,"user_id":4450024,"accept_rate":99,"display_name":"Nu&#241;ito Calzada"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1255,"favorite_count":0,"down_vote_count":0,"up_vote_count":6,"accepted_answer_id":76287985,"answer_count":2,"score":6,"last_activity_date":1684841168,"creation_date":1631289647,"question_id":69134968,"body_markdown":"I have this class:\r\n\r\n    @Configuration\r\n    @EnableWebSecurity\r\n    @EnableGlobalMethodSecurity(prePostEnabled = true)\r\n    public class ApiWebSecurityConfig extends WebSecurityConfigurerAdapter {\r\n    \r\n    \tprivate static final String SALT = &quot;fd&amp;lkj&#167;isfs23#$1*(_)nof&quot;;\r\n    \r\n    \tprivate final JwtAuthenticationEntryPoint unauthorizedHandler;\r\n    \tprivate final JwtTokenUtil jwtTokenUtil;\r\n    \tprivate final UserSecurityService userSecurityService;\r\n    \r\n    \t@Value(&quot;${jwt.header}&quot;)\r\n    \tprivate String tokenHeader;\r\n    \r\n    \r\n    \tpublic ApiWebSecurityConfig(JwtAuthenticationEntryPoint unauthorizedHandler, JwtTokenUtil jwtTokenUtil,\r\n    \t\t\tUserSecurityService userSecurityService) {\r\n    \t\tthis.unauthorizedHandler = unauthorizedHandler;\r\n    \t\tthis.jwtTokenUtil = jwtTokenUtil;\r\n    \t\tthis.userSecurityService = userSecurityService;\r\n    \t}\r\n    \r\n    \t@Autowired\r\n    \tpublic void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\r\n    \t\tauth\r\n    \t\t\t\t.userDetailsService(userSecurityService)\r\n    \t\t\t\t.passwordEncoder(passwordEncoder());\r\n    \t}\r\n    \r\n    \t@Bean\r\n    \tpublic BCryptPasswordEncoder passwordEncoder() {\r\n    \t\treturn new BCryptPasswordEncoder(12, new SecureRandom(SALT.getBytes()));\r\n    \t}\r\n    \r\n    \t@Bean\r\n    \t@Override\r\n    \tpublic AuthenticationManager authenticationManagerBean() throws Exception {\r\n    \t\treturn super.authenticationManagerBean();\r\n    \t}\r\n    \r\n    \t@Override\r\n    \tprotected void configure(HttpSecurity httpSecurity) throws Exception {\r\n    \r\n    \t\thttpSecurity\r\n    \t\t\t\t// we don&#39;t need CSRF because our token is invulnerable\r\n    \t\t\t\t.csrf().disable()\r\n    \r\n    \t\t\t\t.exceptionHandling().authenticationEntryPoint(unauthorizedHandler).and()\r\n    \r\n    \t\t\t\t// don&#39;t create session\r\n    \t\t\t\t.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS).and()\r\n    \t\t\t\t.authorizeRequests()\r\n    \t\t\t\t// Un-secure H2 Database\r\n    \t\t\t\t.antMatchers(&quot;/h2-console/**/**&quot;).permitAll()\r\n    \t\t\t\t.antMatchers(&quot;/api/v1/users&quot;).permitAll()\r\n    \t\t\t\t.antMatchers(&quot;/error&quot;).permitAll()\r\n    \t\t\t\t.anyRequest().authenticated();\r\n    \r\n    \t\t// Custom JWT based security filter\r\n    \t\tJwtAuthorizationTokenFilter authenticationTokenFilter = new JwtAuthorizationTokenFilter(userDetailsService(), jwtTokenUtil, tokenHeader);\r\n    \t\thttpSecurity\r\n    \t\t\t\t.addFilterBefore(authenticationTokenFilter, UsernamePasswordAuthenticationFilter.class);\r\n    \r\n    \t\t// disable page caching\r\n    \t\thttpSecurity\r\n    \t\t\t\t.headers()\r\n    \t\t\t\t.frameOptions()\r\n    \t\t\t\t.sameOrigin()  // required to set for H2 else H2 Console will be blank.\r\n    \t\t\t\t.cacheControl();\r\n    \t}\r\n    \r\n    \t@Override\r\n    \tpublic void configure(WebSecurity web) {\r\n    \r\n    \t\t// AuthenticationTokenFilter will ignore the below paths\r\n    \t\tweb\r\n    \t\t\t\t.ignoring()\r\n    \t\t\t\t.antMatchers(\r\n    \t\t\t\t\t\tHttpMethod.POST,\r\n    \t\t\t\t\t\t&quot;/api/v1/auth&quot;\r\n    \t\t\t\t)\r\n    \t\t\t\t.antMatchers(\r\n    \t\t\t\t\t\tHttpMethod.POST,\r\n    \t\t\t\t\t\t&quot;/api/v1/users&quot;\r\n    \t\t\t\t)\r\n    \t\t\t\t.antMatchers(\r\n    \t\t\t\t\t\tHttpMethod.GET,\r\n    \t\t\t\t\t\t&quot;/api/v1/countries&quot;\r\n    \t\t\t\t);\r\n    \r\n    \t}\r\n    \r\n    }\r\n\r\n\r\nand \r\n\r\n    @Provider\r\n    @Slf4j\r\n    public class JwtAuthorizationTokenFilter extends OncePerRequestFilter {\r\n    \r\n    \tprivate UserDetailsService userDetailsService;\r\n    \tprivate JwtTokenUtil jwtTokenUtil;\r\n    \tprivate String tokenHeader;\r\n    \r\n    \tpublic JwtAuthorizationTokenFilter(UserDetailsService userDetailsService,\r\n    \t\t\tJwtTokenUtil jwtTokenUtil,\r\n    \t\t\tString tokenHeader) {\r\n    \t\tthis.userDetailsService = userDetailsService;\r\n    \t\tthis.jwtTokenUtil = jwtTokenUtil;\r\n    \t\tthis.tokenHeader = tokenHeader;\r\n    \t}\r\n    \r\n    \r\n    \t@Override\r\n    \tprotected boolean shouldNotFilter(HttpServletRequest request) {\r\n    \t\treturn new AntPathMatcher().match(&quot;/api/v1/users&quot;,\r\n    \t\t\t\trequest.getServletPath());\r\n    \t}\r\n    \r\n    \r\n    \t@Override\r\n    \tprotected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws ServletException,\r\n    \t\t\tIOException {\r\n    \r\n    \t\tlog.info(&quot;processing authentication for &#39;{}&#39;&quot;, request.getRequestURL());\r\n    \t\tlog.info(&quot;tokenHeader &#39;{}&#39;&quot;, tokenHeader);\r\n    \r\n    \t\tfinal String requestHeader = request.getHeader(this.tokenHeader);\r\n    \r\n    \t\tlog.info(&quot;requestHeader &#39;{}&#39;&quot;, requestHeader);\r\n    \r\n    \t\tString username = null;\r\n    \t\tString authToken = null;\r\n    \r\n    \t\tif (requestHeader != null &amp;&amp; requestHeader.startsWith(&quot;Bearer &quot;)) {\r\n    \t\t\tauthToken = requestHeader.substring(7);\r\n    \r\n    \t\t\tlog.info(&quot;authToken &#39;{}&#39;&quot;, authToken);\r\n    \r\n    \t\t\ttry {\r\n    \t\t\t\tusername = jwtTokenUtil.getUsernameFromToken(authToken);\r\n    \t\t\t} catch (IllegalArgumentException e) {\r\n    \t\t\t\tlogger.info(&quot;an error occured during getting username from token&quot;, e);\r\n    \t\t\t} catch (ExpiredJwtException e) {\r\n    \t\t\t\tlogger.info(&quot;the token is expired and not valid anymore&quot;, e);\r\n    \t\t\t}\r\n    \t\t} else {\r\n    \t\t\tlogger.info(&quot;couldn&#39;t find bearer string, will ignore the header&quot;);\r\n    \t\t}\r\n    \r\n    \t\tlog.info(&quot;checking authentication for user &#39;{}&#39;&quot;, username);\r\n    \r\n    \t\tif (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) {\r\n    \t\t\tlogger.info(&quot;security context was null, so authorizating user&quot;);\r\n    \r\n    \t\t\t// It is not compelling necessary to load the use details from the database. You could also store the information\r\n    \t\t\t// in the token and read it from it. It&#39;s up to you ;)\r\n    \t\t\tUserDetails userDetails = this.userDetailsService.loadUserByUsername(username);\r\n    \r\n    \t\t\t// For simple validation it is completely sufficient to just check the token integrity. You don&#39;t have to call\r\n    \t\t\t// the database compellingly. Again it&#39;s up to you ;)\r\n    \t\t\tif (jwtTokenUtil.validateToken(authToken, userDetails)) {\r\n    \t\t\t\tUsernamePasswordAuthenticationToken authentication = new UsernamePasswordAuthenticationToken(userDetails, null, userDetails.getAuthorities());\r\n    \t\t\t\tauthentication.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\r\n    \t\t\t\tlog.info(&quot;authorizated user &#39;{}&#39;, setting security context&quot;, username);\r\n    \t\t\t\tSecurityContextHolder.getContext().setAuthentication(authentication);\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tchain.doFilter(request, response);\r\n    \t}\r\n    }\r\n\r\n\r\nand\r\n\r\n\r\n    @RestController\r\n    @Slf4j\r\n    public class AuthenticationRestController {\r\n    \r\n    \r\n    \tprivate static final Logger LOG = LoggerFactory.getLogger\t(AuthenticationRestController.class);\r\n    \r\n    \t@Value(&quot;${jwt.header}&quot;)\r\n    \tprivate String tokenHeader;\r\n    \r\n    \t@Autowired\r\n    \tprivate AuthenticationManager authenticationManager;\r\n    \r\n    \t@Autowired\r\n    \tprivate JwtTokenUtil jwtTokenUtil;\r\n    \r\n    \t@Autowired\r\n    \tprivate UserSecurityService userSecurityService;\r\n    \r\n    \t@PostMapping(path = &quot;/api/v1/auth&quot;, consumes = &quot;application/json&quot;, produces = &quot;application/json&quot;)\r\n    \tpublic ResponseEntity&lt;JwtAuthenticationResponse&gt;\r\n    \tcreateAuthenticationToken(\t@RequestBody JwtAuthenticationRequest authenticationRequest,\r\n    \t\t\tHttpServletRequest request) throws AuthenticationException {\r\n    \r\n    \t\tLOG.info(&quot;authenticating {} &quot; , authenticationRequest.getUsername());\r\n    \r\n    \t\tauthenticate(authenticationRequest.getUsername(), authenticationRequest.getPassword());\r\n    \r\n    \t\t// Reload password post-security so we can generate the token\r\n    \t\tfinal User userDetails = (User) userSecurityService.loadUserByUsername(authenticationRequest.getUsername());\r\n    \r\n    \t\tif (!userDetails.isEnabled()) {\r\n    \t\t\tthrow new UserDisabledException();\r\n    \t\t}\r\n    \r\n    \t\tif (LOG.isDebugEnabled()) {\r\n    \t\t\tLOG.debug(&quot;UserDetails userDetails [ &quot; + authenticationRequest.getUsername() + &quot; ]&quot;);\r\n    \t\t}\r\n    \r\n    \r\n    \t\tfinal String token = jwtTokenUtil.generateToken(userDetails);\r\n    \r\n    \t\t// Return the token\r\n    \t\treturn ResponseEntity.ok(new JwtAuthenticationResponse(token));\r\n    \t}\r\n    \r\n    \r\n    \t@GetMapping(path = &quot;${jwt.route.authentication.refresh}&quot;, consumes = &quot;application/json&quot;, produces = &quot;application/json&quot;)\r\n    \tpublic ResponseEntity&lt;?&gt; refreshAndGetAuthenticationToken(HttpServletRequest request) {\r\n    \t\tString authToken = request.getHeader(tokenHeader);\r\n    \t\tfinal String token = authToken.substring(7);\r\n    \t\tString username = jwtTokenUtil.getUsernameFromToken(token);\r\n    \t\tJwtUser user = (JwtUser) userSecurityService.loadUserByUsername(username);\r\n    \r\n    \t\tif (jwtTokenUtil.canTokenBeRefreshed(token, user.getLastPasswordResetDate())) {\r\n    \t\t\tString refreshedToken = jwtTokenUtil.refreshToken(token);\r\n    \t\t\treturn ResponseEntity.ok(new JwtAuthenticationResponse(refreshedToken));\r\n    \t\t} else {\r\n    \t\t\treturn ResponseEntity.badRequest().body(null);\r\n    \t\t}\r\n    \t}\r\n    \r\n    \t@ExceptionHandler({AuthenticationException.class})\r\n    \tpublic ResponseEntity&lt;String&gt; handleAuthenticationException(AuthenticationException e) {\r\n    \t\treturn ResponseEntity.status(HttpStatus.UNAUTHORIZED).body(e.getMessage());\r\n    \t}\r\n    \r\n    \t/**\r\n    \t * Authenticates the user. If something is wrong, an {@link AuthenticationException} will be thrown\r\n    \t */\r\n    \tprivate void authenticate(String username, String password) {\r\n    \r\n    \t\tObjects.requireNonNull(username);\r\n    \t\tObjects.requireNonNull(password);\r\n    \r\n    \r\n    \t\ttry {\r\n    \t\t\tauthenticationManager.authenticate(new UsernamePasswordAuthenticationToken(username, password));\r\n    \t\t} catch (DisabledException e) {\r\n    \t\t\te.printStackTrace();\r\n    \t\t\tthrow new AuthenticationException(&quot;User is disabled!&quot;, e);\r\n    \t\t} catch (BadCredentialsException e) {\r\n    \t\t\tthrow new AuthenticationException(&quot;Bad credentials!&quot;, e);\r\n    \t\t} catch (Exception e) {\r\n    \t\t\te.printStackTrace();\r\n    \t\t}\r\n    \t}\r\n    }\r\n\r\n\r\nand \r\n\r\n\r\n    @RestController\r\n    @RequestMapping(&quot;/api/v1/styles&quot;)\r\n    @Slf4j\r\n    public class StyleResourceController  {\r\n    \r\n    \t\r\n    \t@PutMapping(path = &quot;/{styleCode}&quot;)\r\n    \t@ResponseStatus(HttpStatus.OK)\r\n    \tpublic void setAlerts(@RequestHeader(value = &quot;Authorization&quot;) String authHeader, @PathVariable String styleCode)\r\n    \r\n    \t\t\tthrows DataAccessException {\r\n    \r\n    \t\tSystem.out.println(&quot;add style {} &quot;);\r\n    \r\n    \t\tfinal User user = authUserOnPath(authHeader);\r\n    \r\n    \t\tSystem.out.println(&quot;user {} &quot; + user);\r\n    \r\n    \t\t\tprotected User authUserOnPath(String authHeader) {\r\n    \r\n    \t\tString authToken = authHeader.substring(7);\r\n    \r\n    \t\tString username = jwtTokenUtil.getUsernameFromToken(authToken);\r\n    \t\tUser user = userService.findByUserName(username);\r\n    \r\n    \t\tif (user == null)\r\n    \t\t\tthrow new ResponseStatusException(HttpStatus.UNAUTHORIZED, &quot;UserNotFound&quot;);\r\n    \r\n    \t\treturn user;\r\n    \r\n    \t}\r\n    \r\n    \r\n    \t}\r\n    \r\n    }\r\n\r\n\r\nand\r\n\r\n    @Component\r\n    public class JwtTokenUtil implements Serializable {\r\n    \r\n    \t//static final String CLAIM_KEY_USERNAME = &quot;sub&quot;;\r\n    \t//static final String CLAIM_KEY_CREATED = &quot;iat&quot;;\r\n    \tprivate static final long serialVersionUID = -3301605591108950415L;\r\n    \t// @SuppressFBWarnings(value = &quot;SE_BAD_FIELD&quot;, justification = &quot;It&#39;s okay here&quot;)\r\n    \tprivate Clock clock = DefaultClock.INSTANCE;\r\n    \r\n    \t@Value(&quot;${jwt.secret}&quot;)\r\n    \tprivate String secret;\r\n    \r\n    \t@Value(&quot;${jwt.expiration}&quot;)\r\n    \tprivate Long expiration;\r\n    \r\n    \tpublic String getUsernameFromToken(String token) {\r\n    \t\treturn getClaimFromToken(token, Claims::getSubject);\r\n    \t}\r\n    \r\n    \tpublic Date getIssuedAtDateFromToken(String token) {\r\n    \t\treturn getClaimFromToken(token, Claims::getIssuedAt);\r\n    \t}\r\n    \r\n    \tpublic Date getExpirationDateFromToken(String token) {\r\n    \t\treturn getClaimFromToken(token, Claims::getExpiration);\r\n    \t}\r\n    \r\n    \tpublic &lt;T&gt; T getClaimFromToken(String token, Function&lt;Claims, T&gt; claimsResolver) {\r\n    \t\tfinal Claims claims = getAllClaimsFromToken(token);\r\n    \t\treturn claimsResolver.apply(claims);\r\n    \t}\r\n    \r\n    \tprivate Claims getAllClaimsFromToken(String token) {\r\n    \t\treturn Jwts.parser()\r\n    \t\t\t\t.setSigningKey(secret)\r\n    \t\t\t\t.parseClaimsJws(token)\r\n    \t\t\t\t.getBody();\r\n    \t}\r\n    \r\n    \tprivate Boolean isTokenExpired(String token) {\r\n    \t\tfinal Date expiration = getExpirationDateFromToken(token);\r\n    \t\treturn expiration.before(clock.now());\r\n    \t}\r\n    \r\n    \tprivate Boolean isCreatedBeforeLastPasswordReset(Date created, Date lastPasswordReset) {\r\n    \t\treturn (lastPasswordReset != null &amp;&amp; created.before(lastPasswordReset));\r\n    \t}\r\n    \r\n    \tprivate Boolean ignoreTokenExpiration(String token) {\r\n    \t\t// here you specify tokens, for that the expiration is ignored\r\n    \t\treturn false;\r\n    \t}\r\n    \r\n    \tpublic String generateToken(UserDetails userDetails) {\r\n    \t\tMap&lt;String, Object&gt; claims = new HashMap&lt;&gt;();\r\n    \t\treturn doGenerateToken(claims, userDetails.getUsername());\r\n    \t}\r\n    \r\n    \tprivate String doGenerateToken(Map&lt;String, Object&gt; claims, String subject) {\r\n    \t\tfinal Date createdDate = clock.now();\r\n    \t\tfinal Date expirationDate = calculateExpirationDate(createdDate);\r\n    \r\n    \t\treturn Jwts.builder()\r\n    \t\t\t\t.setClaims(claims)\r\n    \t\t\t\t.setSubject(subject)\r\n    \t\t\t\t.setIssuedAt(createdDate)\r\n    \t\t\t\t.setExpiration(expirationDate)\r\n    \t\t\t\t.signWith(SignatureAlgorithm.HS512, secret)\r\n    \t\t\t\t.compact();\r\n    \t}\r\n    \r\n    \tpublic Boolean canTokenBeRefreshed(String token, Date lastPasswordReset) {\r\n    \t\tfinal Date created = getIssuedAtDateFromToken(token);\r\n    \t\treturn !isCreatedBeforeLastPasswordReset(created, lastPasswordReset)\r\n    \t\t\t\t&amp;&amp; (!isTokenExpired(token) || ignoreTokenExpiration(token));\r\n    \t}\r\n    \r\n    \tpublic String refreshToken(String token) {\r\n    \t\tfinal Date createdDate = clock.now();\r\n    \t\tfinal Date expirationDate = calculateExpirationDate(createdDate);\r\n    \r\n    \t\tfinal Claims claims = getAllClaimsFromToken(token);\r\n    \t\tclaims.setIssuedAt(createdDate);\r\n    \t\tclaims.setExpiration(expirationDate);\r\n    \r\n    \t\treturn Jwts.builder()\r\n    \t\t\t\t.setClaims(claims)\r\n    \t\t\t\t.signWith(SignatureAlgorithm.HS512, secret)\r\n    \t\t\t\t.compact();\r\n    \t}\r\n    \r\n    \tpublic Boolean validateToken(String token, UserDetails userDetails) {\r\n    \t\tJwtUser user = (JwtUser) userDetails;\r\n    \t\tfinal String username = getUsernameFromToken(token);\r\n    \t\tfinal Date created = getIssuedAtDateFromToken(token);\r\n    \t\treturn (\r\n    \t\t\t\tusername.equals(user.getUsername())\r\n    \t\t\t\t\t\t&amp;&amp; !isTokenExpired(token)\r\n    \t\t\t\t\t\t&amp;&amp; !isCreatedBeforeLastPasswordReset(created, user.getLastPasswordResetDate())\r\n    \t\t);\r\n    \t}\r\n    \r\n    \tprivate Date calculateExpirationDate(Date createdDate) {\r\n    \t\treturn new Date(createdDate.getTime() + expiration * 1000);\r\n    \t}\r\n    }\r\n\r\nbut when I get the user from the token is null:\r\n\r\n    17:19:22.017 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - tokenHeader &#39;Authorization&#39;\r\n    17:19:22.017 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - requestHeader &#39;Bearer eyJhbGciOiJIUzUxMiJ9.eyJleHAiOjE2OTE3NjcxMzYsImlhdCI6MTYzMTI4NzEzNn0.C9s3dbjWNVyGdV5k0LXsNhMGMvPzboTx1J6sGEbfXVOP1CzCLeZFgVPQ4o8jgugvgURF3BcnsWAk7ygd7RCvdg&#39;\r\n    17:19:22.017 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - authToken &#39;eyJhbGciOiJIUzUxMiJ9.eyJleHAiOjE2OTE3NjcxMzYsImlhdCI6MTYzMTI4NzEzNn0.C9s3dbjWNVyGdV5k0LXsNhMGMvPzboTx1J6sGEbfXVOP1CzCLeZFgVPQ4o8jgugvgURF3BcnsWAk7ygd7RCvdg&#39;\r\n    17:19:22.018 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - checking authentication for user &#39;null&#39;\r\n","title":"Spring Security with JWT for REST API","body":"<p>I have this class:</p>\n<pre><code>@Configuration\n@EnableWebSecurity\n@EnableGlobalMethodSecurity(prePostEnabled = true)\npublic class ApiWebSecurityConfig extends WebSecurityConfigurerAdapter {\n\n    private static final String SALT = &quot;fd&amp;lkj§isfs23#$1*(_)nof&quot;;\n\n    private final JwtAuthenticationEntryPoint unauthorizedHandler;\n    private final JwtTokenUtil jwtTokenUtil;\n    private final UserSecurityService userSecurityService;\n\n    @Value(&quot;${jwt.header}&quot;)\n    private String tokenHeader;\n\n\n    public ApiWebSecurityConfig(JwtAuthenticationEntryPoint unauthorizedHandler, JwtTokenUtil jwtTokenUtil,\n            UserSecurityService userSecurityService) {\n        this.unauthorizedHandler = unauthorizedHandler;\n        this.jwtTokenUtil = jwtTokenUtil;\n        this.userSecurityService = userSecurityService;\n    }\n\n    @Autowired\n    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n        auth\n                .userDetailsService(userSecurityService)\n                .passwordEncoder(passwordEncoder());\n    }\n\n    @Bean\n    public BCryptPasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder(12, new SecureRandom(SALT.getBytes()));\n    }\n\n    @Bean\n    @Override\n    public AuthenticationManager authenticationManagerBean() throws Exception {\n        return super.authenticationManagerBean();\n    }\n\n    @Override\n    protected void configure(HttpSecurity httpSecurity) throws Exception {\n\n        httpSecurity\n                // we don't need CSRF because our token is invulnerable\n                .csrf().disable()\n\n                .exceptionHandling().authenticationEntryPoint(unauthorizedHandler).and()\n\n                // don't create session\n                .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS).and()\n                .authorizeRequests()\n                // Un-secure H2 Database\n                .antMatchers(&quot;/h2-console/**/**&quot;).permitAll()\n                .antMatchers(&quot;/api/v1/users&quot;).permitAll()\n                .antMatchers(&quot;/error&quot;).permitAll()\n                .anyRequest().authenticated();\n\n        // Custom JWT based security filter\n        JwtAuthorizationTokenFilter authenticationTokenFilter = new JwtAuthorizationTokenFilter(userDetailsService(), jwtTokenUtil, tokenHeader);\n        httpSecurity\n                .addFilterBefore(authenticationTokenFilter, UsernamePasswordAuthenticationFilter.class);\n\n        // disable page caching\n        httpSecurity\n                .headers()\n                .frameOptions()\n                .sameOrigin()  // required to set for H2 else H2 Console will be blank.\n                .cacheControl();\n    }\n\n    @Override\n    public void configure(WebSecurity web) {\n\n        // AuthenticationTokenFilter will ignore the below paths\n        web\n                .ignoring()\n                .antMatchers(\n                        HttpMethod.POST,\n                        &quot;/api/v1/auth&quot;\n                )\n                .antMatchers(\n                        HttpMethod.POST,\n                        &quot;/api/v1/users&quot;\n                )\n                .antMatchers(\n                        HttpMethod.GET,\n                        &quot;/api/v1/countries&quot;\n                );\n\n    }\n\n}\n</code></pre>\n<p>and</p>\n<pre><code>@Provider\n@Slf4j\npublic class JwtAuthorizationTokenFilter extends OncePerRequestFilter {\n\n    private UserDetailsService userDetailsService;\n    private JwtTokenUtil jwtTokenUtil;\n    private String tokenHeader;\n\n    public JwtAuthorizationTokenFilter(UserDetailsService userDetailsService,\n            JwtTokenUtil jwtTokenUtil,\n            String tokenHeader) {\n        this.userDetailsService = userDetailsService;\n        this.jwtTokenUtil = jwtTokenUtil;\n        this.tokenHeader = tokenHeader;\n    }\n\n\n    @Override\n    protected boolean shouldNotFilter(HttpServletRequest request) {\n        return new AntPathMatcher().match(&quot;/api/v1/users&quot;,\n                request.getServletPath());\n    }\n\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws ServletException,\n            IOException {\n\n        log.info(&quot;processing authentication for '{}'&quot;, request.getRequestURL());\n        log.info(&quot;tokenHeader '{}'&quot;, tokenHeader);\n\n        final String requestHeader = request.getHeader(this.tokenHeader);\n\n        log.info(&quot;requestHeader '{}'&quot;, requestHeader);\n\n        String username = null;\n        String authToken = null;\n\n        if (requestHeader != null &amp;&amp; requestHeader.startsWith(&quot;Bearer &quot;)) {\n            authToken = requestHeader.substring(7);\n\n            log.info(&quot;authToken '{}'&quot;, authToken);\n\n            try {\n                username = jwtTokenUtil.getUsernameFromToken(authToken);\n            } catch (IllegalArgumentException e) {\n                logger.info(&quot;an error occured during getting username from token&quot;, e);\n            } catch (ExpiredJwtException e) {\n                logger.info(&quot;the token is expired and not valid anymore&quot;, e);\n            }\n        } else {\n            logger.info(&quot;couldn't find bearer string, will ignore the header&quot;);\n        }\n\n        log.info(&quot;checking authentication for user '{}'&quot;, username);\n\n        if (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) {\n            logger.info(&quot;security context was null, so authorizating user&quot;);\n\n            // It is not compelling necessary to load the use details from the database. You could also store the information\n            // in the token and read it from it. It's up to you ;)\n            UserDetails userDetails = this.userDetailsService.loadUserByUsername(username);\n\n            // For simple validation it is completely sufficient to just check the token integrity. You don't have to call\n            // the database compellingly. Again it's up to you ;)\n            if (jwtTokenUtil.validateToken(authToken, userDetails)) {\n                UsernamePasswordAuthenticationToken authentication = new UsernamePasswordAuthenticationToken(userDetails, null, userDetails.getAuthorities());\n                authentication.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\n                log.info(&quot;authorizated user '{}', setting security context&quot;, username);\n                SecurityContextHolder.getContext().setAuthentication(authentication);\n            }\n        }\n        chain.doFilter(request, response);\n    }\n}\n</code></pre>\n<p>and</p>\n<pre><code>@RestController\n@Slf4j\npublic class AuthenticationRestController {\n\n\n    private static final Logger LOG = LoggerFactory.getLogger   (AuthenticationRestController.class);\n\n    @Value(&quot;${jwt.header}&quot;)\n    private String tokenHeader;\n\n    @Autowired\n    private AuthenticationManager authenticationManager;\n\n    @Autowired\n    private JwtTokenUtil jwtTokenUtil;\n\n    @Autowired\n    private UserSecurityService userSecurityService;\n\n    @PostMapping(path = &quot;/api/v1/auth&quot;, consumes = &quot;application/json&quot;, produces = &quot;application/json&quot;)\n    public ResponseEntity&lt;JwtAuthenticationResponse&gt;\n    createAuthenticationToken(  @RequestBody JwtAuthenticationRequest authenticationRequest,\n            HttpServletRequest request) throws AuthenticationException {\n\n        LOG.info(&quot;authenticating {} &quot; , authenticationRequest.getUsername());\n\n        authenticate(authenticationRequest.getUsername(), authenticationRequest.getPassword());\n\n        // Reload password post-security so we can generate the token\n        final User userDetails = (User) userSecurityService.loadUserByUsername(authenticationRequest.getUsername());\n\n        if (!userDetails.isEnabled()) {\n            throw new UserDisabledException();\n        }\n\n        if (LOG.isDebugEnabled()) {\n            LOG.debug(&quot;UserDetails userDetails [ &quot; + authenticationRequest.getUsername() + &quot; ]&quot;);\n        }\n\n\n        final String token = jwtTokenUtil.generateToken(userDetails);\n\n        // Return the token\n        return ResponseEntity.ok(new JwtAuthenticationResponse(token));\n    }\n\n\n    @GetMapping(path = &quot;${jwt.route.authentication.refresh}&quot;, consumes = &quot;application/json&quot;, produces = &quot;application/json&quot;)\n    public ResponseEntity&lt;?&gt; refreshAndGetAuthenticationToken(HttpServletRequest request) {\n        String authToken = request.getHeader(tokenHeader);\n        final String token = authToken.substring(7);\n        String username = jwtTokenUtil.getUsernameFromToken(token);\n        JwtUser user = (JwtUser) userSecurityService.loadUserByUsername(username);\n\n        if (jwtTokenUtil.canTokenBeRefreshed(token, user.getLastPasswordResetDate())) {\n            String refreshedToken = jwtTokenUtil.refreshToken(token);\n            return ResponseEntity.ok(new JwtAuthenticationResponse(refreshedToken));\n        } else {\n            return ResponseEntity.badRequest().body(null);\n        }\n    }\n\n    @ExceptionHandler({AuthenticationException.class})\n    public ResponseEntity&lt;String&gt; handleAuthenticationException(AuthenticationException e) {\n        return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body(e.getMessage());\n    }\n\n    /**\n     * Authenticates the user. If something is wrong, an {@link AuthenticationException} will be thrown\n     */\n    private void authenticate(String username, String password) {\n\n        Objects.requireNonNull(username);\n        Objects.requireNonNull(password);\n\n\n        try {\n            authenticationManager.authenticate(new UsernamePasswordAuthenticationToken(username, password));\n        } catch (DisabledException e) {\n            e.printStackTrace();\n            throw new AuthenticationException(&quot;User is disabled!&quot;, e);\n        } catch (BadCredentialsException e) {\n            throw new AuthenticationException(&quot;Bad credentials!&quot;, e);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<p>and</p>\n<pre><code>@RestController\n@RequestMapping(&quot;/api/v1/styles&quot;)\n@Slf4j\npublic class StyleResourceController  {\n\n    \n    @PutMapping(path = &quot;/{styleCode}&quot;)\n    @ResponseStatus(HttpStatus.OK)\n    public void setAlerts(@RequestHeader(value = &quot;Authorization&quot;) String authHeader, @PathVariable String styleCode)\n\n            throws DataAccessException {\n\n        System.out.println(&quot;add style {} &quot;);\n\n        final User user = authUserOnPath(authHeader);\n\n        System.out.println(&quot;user {} &quot; + user);\n\n            protected User authUserOnPath(String authHeader) {\n\n        String authToken = authHeader.substring(7);\n\n        String username = jwtTokenUtil.getUsernameFromToken(authToken);\n        User user = userService.findByUserName(username);\n\n        if (user == null)\n            throw new ResponseStatusException(HttpStatus.UNAUTHORIZED, &quot;UserNotFound&quot;);\n\n        return user;\n\n    }\n\n\n    }\n\n}\n</code></pre>\n<p>and</p>\n<pre><code>@Component\npublic class JwtTokenUtil implements Serializable {\n\n    //static final String CLAIM_KEY_USERNAME = &quot;sub&quot;;\n    //static final String CLAIM_KEY_CREATED = &quot;iat&quot;;\n    private static final long serialVersionUID = -3301605591108950415L;\n    // @SuppressFBWarnings(value = &quot;SE_BAD_FIELD&quot;, justification = &quot;It's okay here&quot;)\n    private Clock clock = DefaultClock.INSTANCE;\n\n    @Value(&quot;${jwt.secret}&quot;)\n    private String secret;\n\n    @Value(&quot;${jwt.expiration}&quot;)\n    private Long expiration;\n\n    public String getUsernameFromToken(String token) {\n        return getClaimFromToken(token, Claims::getSubject);\n    }\n\n    public Date getIssuedAtDateFromToken(String token) {\n        return getClaimFromToken(token, Claims::getIssuedAt);\n    }\n\n    public Date getExpirationDateFromToken(String token) {\n        return getClaimFromToken(token, Claims::getExpiration);\n    }\n\n    public &lt;T&gt; T getClaimFromToken(String token, Function&lt;Claims, T&gt; claimsResolver) {\n        final Claims claims = getAllClaimsFromToken(token);\n        return claimsResolver.apply(claims);\n    }\n\n    private Claims getAllClaimsFromToken(String token) {\n        return Jwts.parser()\n                .setSigningKey(secret)\n                .parseClaimsJws(token)\n                .getBody();\n    }\n\n    private Boolean isTokenExpired(String token) {\n        final Date expiration = getExpirationDateFromToken(token);\n        return expiration.before(clock.now());\n    }\n\n    private Boolean isCreatedBeforeLastPasswordReset(Date created, Date lastPasswordReset) {\n        return (lastPasswordReset != null &amp;&amp; created.before(lastPasswordReset));\n    }\n\n    private Boolean ignoreTokenExpiration(String token) {\n        // here you specify tokens, for that the expiration is ignored\n        return false;\n    }\n\n    public String generateToken(UserDetails userDetails) {\n        Map&lt;String, Object&gt; claims = new HashMap&lt;&gt;();\n        return doGenerateToken(claims, userDetails.getUsername());\n    }\n\n    private String doGenerateToken(Map&lt;String, Object&gt; claims, String subject) {\n        final Date createdDate = clock.now();\n        final Date expirationDate = calculateExpirationDate(createdDate);\n\n        return Jwts.builder()\n                .setClaims(claims)\n                .setSubject(subject)\n                .setIssuedAt(createdDate)\n                .setExpiration(expirationDate)\n                .signWith(SignatureAlgorithm.HS512, secret)\n                .compact();\n    }\n\n    public Boolean canTokenBeRefreshed(String token, Date lastPasswordReset) {\n        final Date created = getIssuedAtDateFromToken(token);\n        return !isCreatedBeforeLastPasswordReset(created, lastPasswordReset)\n                &amp;&amp; (!isTokenExpired(token) || ignoreTokenExpiration(token));\n    }\n\n    public String refreshToken(String token) {\n        final Date createdDate = clock.now();\n        final Date expirationDate = calculateExpirationDate(createdDate);\n\n        final Claims claims = getAllClaimsFromToken(token);\n        claims.setIssuedAt(createdDate);\n        claims.setExpiration(expirationDate);\n\n        return Jwts.builder()\n                .setClaims(claims)\n                .signWith(SignatureAlgorithm.HS512, secret)\n                .compact();\n    }\n\n    public Boolean validateToken(String token, UserDetails userDetails) {\n        JwtUser user = (JwtUser) userDetails;\n        final String username = getUsernameFromToken(token);\n        final Date created = getIssuedAtDateFromToken(token);\n        return (\n                username.equals(user.getUsername())\n                        &amp;&amp; !isTokenExpired(token)\n                        &amp;&amp; !isCreatedBeforeLastPasswordReset(created, user.getLastPasswordResetDate())\n        );\n    }\n\n    private Date calculateExpirationDate(Date createdDate) {\n        return new Date(createdDate.getTime() + expiration * 1000);\n    }\n}\n</code></pre>\n<p>but when I get the user from the token is null:</p>\n<pre><code>17:19:22.017 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - tokenHeader 'Authorization'\n17:19:22.017 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - requestHeader 'Bearer eyJhbGciOiJIUzUxMiJ9.eyJleHAiOjE2OTE3NjcxMzYsImlhdCI6MTYzMTI4NzEzNn0.C9s3dbjWNVyGdV5k0LXsNhMGMvPzboTx1J6sGEbfXVOP1CzCLeZFgVPQ4o8jgugvgURF3BcnsWAk7ygd7RCvdg'\n17:19:22.017 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - authToken 'eyJhbGciOiJIUzUxMiJ9.eyJleHAiOjE2OTE3NjcxMzYsImlhdCI6MTYzMTI4NzEzNn0.C9s3dbjWNVyGdV5k0LXsNhMGMvPzboTx1J6sGEbfXVOP1CzCLeZFgVPQ4o8jgugvgURF3BcnsWAk7ygd7RCvdg'\n17:19:22.018 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - checking authentication for user 'null'\n</code></pre>\n"},{"tags":["java","android","emulation","nfc","card"],"answers":[{"comments":[{"owner":{"account_id":10560695,"reputation":99,"user_id":7780558,"display_name":"Enes"},"score":1,"creation_date":1679312238,"post_id":75789626,"comment_id":133693123,"body_markdown":"is possıable to emulate Tag Type ISO 14443-3A   NXP MİFARE CLASSİC 1K with out root for example","body":"is possıable to emulate Tag Type ISO 14443-3A   NXP MİFARE CLASSİC 1K with out root for example"},{"owner":{"account_id":10560695,"reputation":99,"user_id":7780558,"display_name":"Enes"},"score":0,"creation_date":1679312650,"post_id":75789626,"comment_id":133693228,"body_markdown":"Tag 4 Type:   The NFC Tag 4 Type is defined to be compatible with ISO 14443A and ISO 14443B standard (13.56MHz).  This mean we can emulate this with HCE right","body":"Tag 4 Type:   The NFC Tag 4 Type is defined to be compatible with ISO 14443A and ISO 14443B standard (13.56MHz).  This mean we can emulate this with HCE right"},{"owner":{"account_id":2755641,"reputation":8698,"user_id":2373819,"display_name":"Andrew"},"score":1,"creation_date":1679336571,"post_id":75789626,"comment_id":133700346,"body_markdown":"&quot;Emulate MİFARE CLASSİC 1K with out root&quot;, this is the one that I believe that if your phone uses a NXP chipset it might be possible with a rooted phone, but not all phones use NXP chipsets. Just to clarify I believe that only the &quot;A&quot; modulation is supported by HCE and you have no control over the ISO 14443 level of the protocol (ISO 14443 is just used for anti collision and the UID related to that is a random number). HCE only gives you control of the ISO 7816-4 (Application protocol) used by type 4 Tags","body":"&quot;Emulate MİFARE CLASSİC 1K with out root&quot;, this is the one that I believe that if your phone uses a NXP chipset it might be possible with a rooted phone, but not all phones use NXP chipsets. Just to clarify I believe that only the &quot;A&quot; modulation is supported by HCE and you have no control over the ISO 14443 level of the protocol (ISO 14443 is just used for anti collision and the UID related to that is a random number). HCE only gives you control of the ISO 7816-4 (Application protocol) used by type 4 Tags"},{"owner":{"account_id":10560695,"reputation":99,"user_id":7780558,"display_name":"Enes"},"score":0,"creation_date":1679420498,"post_id":75789626,"comment_id":133718040,"body_markdown":"https://shop.sonmicro.com/SM5210 is this rfid chip can read phone emulator nfc. or how to know its type is ?","body":"<a href=\"https://shop.sonmicro.com/SM5210\" rel=\"nofollow noreferrer\">shop.sonmicro.com/SM5210</a> is this rfid chip can read phone emulator nfc. or how to know its type is ?"}],"tags":[],"owner":{"account_id":2755641,"reputation":8698,"user_id":2373819,"display_name":"Andrew"},"comment_count":4,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1679311103,"creation_date":1679311103,"answer_id":75789626,"question_id":75789540,"body_markdown":"There are many different types of NFC Tags\r\n\r\nYou can emulate a Type 4 tag without rooting the phone.\r\nAs you have seen this can be done as per https://developer.android.com/guide/topics/connectivity/nfc/hce\r\n\r\nAn example of HCE is available at https://github.com/underwindfall/NFCAndroid\r\n\r\nThis works without rooting the phone.\r\n\r\nI believe that some (not all) phone hardware might be able to emulate one other type of Tag if you have rooted the phone and know the non public API to access the hardware in the right manner (not confirmed).","title":"NFC Emulate card witout root","body":"<p>There are many different types of NFC Tags</p>\n<p>You can emulate a Type 4 tag without rooting the phone.\nAs you have seen this can be done as per <a href=\"https://developer.android.com/guide/topics/connectivity/nfc/hce\" rel=\"nofollow noreferrer\">https://developer.android.com/guide/topics/connectivity/nfc/hce</a></p>\n<p>An example of HCE is available at <a href=\"https://github.com/underwindfall/NFCAndroid\" rel=\"nofollow noreferrer\">https://github.com/underwindfall/NFCAndroid</a></p>\n<p>This works without rooting the phone.</p>\n<p>I believe that some (not all) phone hardware might be able to emulate one other type of Tag if you have rooted the phone and know the non public API to access the hardware in the right manner (not confirmed).</p>\n"}],"owner":{"account_id":10560695,"reputation":99,"user_id":7780558,"display_name":"Enes"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":8982,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75789626,"answer_count":1,"score":0,"last_activity_date":1684840315,"creation_date":1679310524,"question_id":75789540,"body_markdown":"I am developing a simple app that emulates reading a card.\r\n\r\nThe big problem is, is it possible to emulate a card WITHOUT root access on an Android device?\r\n\r\nif yes, can you share your information\r\n\r\nthank you all.\r\n\r\n\r\nI have looked at the following:\r\nhttps://developer.android.com/guide/topics/connectivity/nfc/hce\r\n\r\nthis is the working app with root access only\r\nhttps://play.google.com/store/apps/details?id=com.yuanwofei.cardemulator.pro&amp;hl=tr&amp;gl=US","title":"NFC Emulate card witout root","body":"<p>I am developing a simple app that emulates reading a card.</p>\n<p>The big problem is, is it possible to emulate a card WITHOUT root access on an Android device?</p>\n<p>if yes, can you share your information</p>\n<p>thank you all.</p>\n<p>I have looked at the following:\n<a href=\"https://developer.android.com/guide/topics/connectivity/nfc/hce\" rel=\"nofollow noreferrer\">https://developer.android.com/guide/topics/connectivity/nfc/hce</a></p>\n<p>this is the working app with root access only\n<a href=\"https://play.google.com/store/apps/details?id=com.yuanwofei.cardemulator.pro&amp;hl=tr&amp;gl=US\" rel=\"nofollow noreferrer\">https://play.google.com/store/apps/details?id=com.yuanwofei.cardemulator.pro&amp;hl=tr&amp;gl=US</a></p>\n"},{"tags":["java","android","auto-increment"],"answers":[{"comments":[{"owner":{"account_id":3657916,"reputation":1263,"user_id":3048424,"accept_rate":60,"display_name":"Milad Yarmohammadi"},"score":0,"creation_date":1535872488,"post_id":52134782,"comment_id":91219560,"body_markdown":"it seems your snippet only generates 2 Strings!","body":"it seems your snippet only generates 2 Strings!"}],"tags":[],"owner":{"account_id":1948424,"reputation":12649,"user_id":1753073,"display_name":"navylover"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1535872337,"creation_date":1535872337,"answer_id":52134782,"question_id":52134728,"body_markdown":"Convert number 1 to String &quot;001&quot; via below code:\r\n\r\n  \r\n\r\n      int num = 1; \r\n      String var = String.format(&quot;%03d&quot;, num); // var is &quot;001&quot;\r\n      int num = 99; \r\n      String var = String.format(&quot;%03d&quot;, num); // var is &quot;099&quot;\r\n\r\n\r\nand you could split 001001-001099 into two strings, each string has three digits.\r\n\r\n","title":"How to make auto-increment number start with (001…009, 011…099)?","body":"<p>Convert number 1 to String \"001\" via below code:</p>\n\n<pre><code>  int num = 1; \n  String var = String.format(\"%03d\", num); // var is \"001\"\n  int num = 99; \n  String var = String.format(\"%03d\", num); // var is \"099\"\n</code></pre>\n\n<p>and you could split 001001-001099 into two strings, each string has three digits.</p>\n"},{"comments":[{"owner":{"account_id":162699,"reputation":138060,"user_id":3788176,"accept_rate":54,"display_name":"Andy Turner"},"score":0,"creation_date":1535880634,"post_id":52134791,"comment_id":91221127,"body_markdown":"Or, of course, go between 1001 and 1100, and format with `%06d`.","body":"Or, of course, go between 1001 and 1100, and format with <code>%06d</code>."}],"tags":[],"owner":{"account_id":1791757,"reputation":22226,"user_id":1631967,"display_name":"aminography"},"comment_count":1,"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1535872405,"creation_date":1535872405,"answer_id":52134791,"question_id":52134728,"body_markdown":"Simply you can use this snippet to generate your desired sequence:\r\n\r\n        for (int i = 1; i &lt; 100; i++) {\r\n            String res = String.format(Locale.getDefault(), &quot;001%03d&quot;, i);\r\n        }","title":"How to make auto-increment number start with (001…009, 011…099)?","body":"<p>Simply you can use this snippet to generate your desired sequence:</p>\n\n<pre><code>    for (int i = 1; i &lt; 100; i++) {\n        String res = String.format(Locale.getDefault(), \"001%03d\", i);\n    }\n</code></pre>\n"}],"owner":{"account_id":13974552,"reputation":35,"user_id":10092237,"display_name":"aslam"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4129,"favorite_count":0,"down_vote_count":8,"up_vote_count":4,"closed_date":1684937599,"accepted_answer_id":52134791,"answer_count":2,"score":-4,"last_activity_date":1684840114,"creation_date":1535871762,"question_id":52134728,"body_markdown":"Please help me, I don&#39;t know how to create an auto-incrementing number that starts with 001 - 999 in Android studio..\r\n\r\nI want to play audio from url like [this][1].\r\n\r\nI want to modify 001001 to 001002, 001003 &gt;&gt; 001099 etc\r\n\r\nThanks in advance..!\r\n\r\n\r\n  [1]: http://www.everyayah.com/data/Alafasy_64kbps/001001.Mp3","title":"How to make auto-increment number start with (001…009, 011…099)?","body":"<p>Please help me, I don't know how to create an auto-incrementing number that starts with 001 - 999 in Android studio..</p>\n<p>I want to play audio from url like <a href=\"http://www.everyayah.com/data/Alafasy_64kbps/001001.Mp3\" rel=\"nofollow noreferrer\">this</a>.</p>\n<p>I want to modify 001001 to 001002, 001003 &gt;&gt; 001099 etc</p>\n<p>Thanks in advance..!</p>\n"},{"tags":["java","regex","performance","cpu-usage"],"comments":[{"owner":{"account_id":19435569,"reputation":1567,"user_id":21105992,"display_name":"teapot418"},"score":1,"creation_date":1684314176,"post_id":76270212,"comment_id":134498839,"body_markdown":"The library implementation is probably fairly well optimized. We may not be able to provide you with drop-in replacements for it that would perform better. The part you can improve is probably your pattern, especially if it uses backtracking. And you have not shared that.","body":"The library implementation is probably fairly well optimized. We may not be able to provide you with drop-in replacements for it that would perform better. The part you can improve is probably your pattern, especially if it uses backtracking. And you have not shared that."},{"owner":{"account_id":262183,"reputation":13618,"user_id":546871,"accept_rate":40,"display_name":"AdrianHHH"},"score":1,"creation_date":1684317549,"post_id":76270212,"comment_id":134499629,"body_markdown":"Why are there two `.*` items in the pattern? The RegEx will have to process the first `.*` which will match the entire string, then the match for the `p` in `purchase` will fail. It will backtrack by one character and the `p` will fail again, and so on. Perhaps changing to a non-greedy initial part (i.e. to `.*?\\\\b(purchase)\\\\b.*`) would improve matters. But, I repeat, why are the two `.*` items present.","body":"Why are there two <code>.*</code> items in the pattern? The RegEx will have to process the first <code>.*</code> which will match the entire string, then the match for the <code>p</code> in <code>purchase</code> will fail. It will backtrack by one character and the <code>p</code> will fail again, and so on. Perhaps changing to a non-greedy initial part (i.e. to <code>.*?\\\\b(purchase)\\\\b.*</code>) would improve matters. But, I repeat, why are the two <code>.*</code> items present."},{"owner":{"account_id":5998820,"reputation":12676,"user_id":4712734,"display_name":"DuncG"},"score":1,"creation_date":1684320944,"post_id":76270212,"comment_id":134500336,"body_markdown":"Should also get same result without &quot;.*&quot; if you use find not matches - `Pattern.compile(&quot;\\\\b(purchase)\\\\b&quot;).matcher(text).find()` and you can also re-use the Pattern.compile part.","body":"Should also get same result without &quot;.*&quot; if you use find not matches - <code>Pattern.compile(&quot;\\\\b(purchase)\\\\b&quot;).matcher(text).find()</code> and you can also re-use the Pattern.compile part."},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":4,"creation_date":1684328249,"post_id":76270212,"comment_id":134501952,"body_markdown":"As @DuncG said, use the right operation, i.e. `find()` instead of abusing `matches()` with expensive `.*` around the pattern. This already avoids backtracking. But you also don’t need capturing groups, so `Pattern.compile(&quot;\\\\bpurchase\\\\b&quot;).matcher(text).find()` will do. Keep in mind that you can keep and reuse the result of `Pattern.compile(…)`, i.e.  instead of storing the pattern string in a `static final` field, store the `Pattern` object, so you’re not repeating the work on every invocation.","body":"As @DuncG said, use the right operation, i.e. <code>find()</code> instead of abusing <code>matches()</code> with expensive <code>.*</code> around the pattern. This already avoids backtracking. But you also don’t need capturing groups, so <code>Pattern.compile(&quot;\\\\bpurchase\\\\b&quot;).matcher(text).find()</code> will do. Keep in mind that you can keep and reuse the result of <code>Pattern.compile(…)</code>, i.e.  instead of storing the pattern string in a <code>static final</code> field, store the <code>Pattern</code> object, so you’re not repeating the work on every invocation."},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":3,"creation_date":1684328479,"post_id":76270212,"comment_id":134502020,"body_markdown":"If you want to squeeze out the maximum performance with the reference implementation, use `Pattern.compile(&quot;purchase\\\\b(?&lt;=\\\\b.{8})&quot;)`. Having the literal text at the beginning of the pattern will enable the internal use of the [Boyer–Moore algorithm](https://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string-search_algorithm). But avoiding backtracking and reusing the `Pattern` object are more important.","body":"If you want to squeeze out the maximum performance with the reference implementation, use <code>Pattern.compile(&quot;purchase\\\\b(?&lt;=\\\\b.{8})&quot;)</code>. Having the literal text at the beginning of the pattern will enable the internal use of the <a href=\"https://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string-search_algorithm\" rel=\"nofollow noreferrer\">Boyer–Moore algorithm</a>. But avoiding backtracking and reusing the <code>Pattern</code> object are more important."},{"owner":{"account_id":2053598,"reputation":41316,"user_id":1831987,"display_name":"VGR"},"score":0,"creation_date":1684334051,"post_id":76270212,"comment_id":134503490,"body_markdown":"If you really want to optimize, avoid using regular expressions for such a simple problem.  You could just do this:  `int i = text.indexOf(&quot;purchase&quot;); return i &gt;= 0 &amp;&amp; (i == 0 || !Character.isLetter(text.charAt(i))) &amp;&amp; (i == text.length() - 8 || !Character.isLetter(text.charAt(i + 8)))`.  It may look longer, but regular expressions do a lot of work under the hood and involve a lot more code than this approach.","body":"If you really want to optimize, avoid using regular expressions for such a simple problem.  You could just do this:  <code>int i = text.indexOf(&quot;purchase&quot;); return i &gt;= 0 &amp;&amp; (i == 0 || !Character.isLetter(text.charAt(i))) &amp;&amp; (i == text.length() - 8 || !Character.isLetter(text.charAt(i + 8)))</code>.  It may look longer, but regular expressions do a lot of work under the hood and involve a lot more code than this approach."},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1684756009,"post_id":76270212,"comment_id":134558485,"body_markdown":"@VGR that’s not doing the same. Your variant checks whether the first occurrence of “purchase” is at word boundaries whereas the original code checks whether there is any occurrence of “purchase” at word boundaries.","body":"@VGR that’s not doing the same. Your variant checks whether the first occurrence of “purchase” is at word boundaries whereas the original code checks whether there is any occurrence of “purchase” at word boundaries."}],"answers":[{"tags":[],"owner":{"account_id":23740623,"reputation":1,"user_id":17758716,"display_name":"Reilas"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1684814179,"creation_date":1684813497,"answer_id":76311173,"question_id":76270212,"body_markdown":"There are a few changes you can make.\r\n\r\nYou can greatly reduce the CPU consumption by creating re-usable objects.\r\n\r\n```java\r\npublic class Example {\r\n    Pattern pattern = Pattern.compile(&quot;\\\\bpurchase\\\\b&quot;);\r\n    Matcher matcher;\r\n\r\n    private boolean isMatchPattern(String text) {\r\n        matcher = pattern.matcher(text);\r\n        return matcher.find();\r\n    }\r\n}\r\n```\r\n\r\nBehind the scenes, upon each call of `String.matches`, a new `Pattern` and `Matcher` object is created.\r\n\r\nTo combat this, you can create `Pattern` and `Matcher` fields within your class.  \r\nThen, access these fields from within your `isMatchPattern` method.\r\n\r\nFurthermore, for the regular expression pattern, there is no need to capture the text &quot;purchase&quot;, so you can remove the parentheses.\r\n\r\nAdditionally, the context of a `Pattern` pattern is non-conforming; it&#39;s expected to be anywhere within the text.  \r\nAs opposed to a `String.matches` call, which requires the entire parameter to match.  \r\nSo, you don&#39;t need the starting and ending `.*`, as they are redundant.\r\n\r\nIn regard to using an `String.indexOf`, or `String.contains`.\r\n\r\nIf you require the word-boundary check, then this is somewhat out of the question in terms of an idiomatic approach, as you&#39;d have to make more than one call.\r\n\r\nIf you don&#39;t require the check, then this would be the way to go.  \r\n\r\nAs a final solution, you can create a character array for-loop, which is more or less what the `Matcher` class does.","title":"Optimizing CPU Usage in Java Regex Matching","body":"<p>There are a few changes you can make.</p>\n<p>You can greatly reduce the CPU consumption by creating re-usable objects.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Example {\n    Pattern pattern = Pattern.compile(&quot;\\\\bpurchase\\\\b&quot;);\n    Matcher matcher;\n\n    private boolean isMatchPattern(String text) {\n        matcher = pattern.matcher(text);\n        return matcher.find();\n    }\n}\n</code></pre>\n<p>Behind the scenes, upon each call of <code>String.matches</code>, a new <code>Pattern</code> and <code>Matcher</code> object is created.</p>\n<p>To combat this, you can create <code>Pattern</code> and <code>Matcher</code> fields within your class.<br />\nThen, access these fields from within your <code>isMatchPattern</code> method.</p>\n<p>Furthermore, for the regular expression pattern, there is no need to capture the text &quot;purchase&quot;, so you can remove the parentheses.</p>\n<p>Additionally, the context of a <code>Pattern</code> pattern is non-conforming; it's expected to be anywhere within the text.<br />\nAs opposed to a <code>String.matches</code> call, which requires the entire parameter to match.<br />\nSo, you don't need the starting and ending <code>.*</code>, as they are redundant.</p>\n<p>In regard to using an <code>String.indexOf</code>, or <code>String.contains</code>.</p>\n<p>If you require the word-boundary check, then this is somewhat out of the question in terms of an idiomatic approach, as you'd have to make more than one call.</p>\n<p>If you don't require the check, then this would be the way to go.</p>\n<p>As a final solution, you can create a character array for-loop, which is more or less what the <code>Matcher</code> class does.</p>\n"}],"owner":{"account_id":4745793,"reputation":923,"user_id":3837201,"display_name":"zohreh"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":239,"favorite_count":0,"down_vote_count":5,"up_vote_count":1,"accepted_answer_id":76311173,"answer_count":1,"score":-4,"last_activity_date":1684839294,"creation_date":1684313466,"question_id":76270212,"body_markdown":"I encountered a performance issue related to regex matching in my Java project, which resulted in high CPU usage. Despite my attempts at regex optimization, I&#39;m still experiencing performance problems, particularly when multiple threads concurrently invoke the code.\r\n\r\nFor instance, when calling a method that performs regex matching concurrently 100 times, the CPU usage spikes to 90% for a brief period.\r\n\r\nHere&#39;s a simplified example of my code:\r\n\r\n    String BUY_PATTERN =&quot;.*\\\\b(purchase)\\\\b.*&quot;;\r\n\r\n    private static boolean isMatchPattern(String pattern, String text) {\r\n         return text.matches(BUY_PATTERN);\r\n    }\r\n\r\n\r\nI would like to reduce the CPU usage during regex matching. Can you provide suggestions for more efficient regex patterns that achieve the same functionality?\r\n\r\nAdditionally, I came across an article ([link provided][1]) discussing the impact of backtracking on performance, but I find it challenging to rewrite the regex to minimize backtracking.\r\n\r\nThank you for your assistance!\r\n\r\n\r\n  [1]: https://medium.com/javarevisited/a-regular-expression-makes-the-cpu-soar-to-100-72036a4b0771","title":"Optimizing CPU Usage in Java Regex Matching","body":"<p>I encountered a performance issue related to regex matching in my Java project, which resulted in high CPU usage. Despite my attempts at regex optimization, I'm still experiencing performance problems, particularly when multiple threads concurrently invoke the code.</p>\n<p>For instance, when calling a method that performs regex matching concurrently 100 times, the CPU usage spikes to 90% for a brief period.</p>\n<p>Here's a simplified example of my code:</p>\n<pre><code>String BUY_PATTERN =&quot;.*\\\\b(purchase)\\\\b.*&quot;;\n\nprivate static boolean isMatchPattern(String pattern, String text) {\n     return text.matches(BUY_PATTERN);\n}\n</code></pre>\n<p>I would like to reduce the CPU usage during regex matching. Can you provide suggestions for more efficient regex patterns that achieve the same functionality?</p>\n<p>Additionally, I came across an article (<a href=\"https://medium.com/javarevisited/a-regular-expression-makes-the-cpu-soar-to-100-72036a4b0771\" rel=\"nofollow noreferrer\">link provided</a>) discussing the impact of backtracking on performance, but I find it challenging to rewrite the regex to minimize backtracking.</p>\n<p>Thank you for your assistance!</p>\n"},{"tags":["java","spring-boot","spring-security","jwt"],"comments":[{"owner":{"account_id":2064278,"reputation":13138,"user_id":1840146,"accept_rate":86,"display_name":"Toerktumlare"},"score":1,"creation_date":1684169769,"post_id":76255236,"comment_id":134474727,"body_markdown":"this is documented here in https://docs.spring.io/spring-security/reference/servlet/oauth2/resource-server/jwt.html#oauth2resourceserver-jwt-authorization-extraction in the spring security documentation here is a fully documented example with code, and a large blogpost about how to do what you want to do https://github.com/Tandolf/spring-security-jwt-demo","body":"this is documented here in <a href=\"https://docs.spring.io/spring-security/reference/servlet/oauth2/resource-server/jwt.html#oauth2resourceserver-jwt-authorization-extraction\" rel=\"nofollow noreferrer\">docs.spring.io/spring-security/reference/servlet/oauth2/&hellip;</a> in the spring security documentation here is a fully documented example with code, and a large blogpost about how to do what you want to do <a href=\"https://github.com/Tandolf/spring-security-jwt-demo\" rel=\"nofollow noreferrer\">github.com/Tandolf/spring-security-jwt-demo</a>"}],"answers":[{"tags":[],"owner":{"account_id":9256941,"reputation":1073,"user_id":6875688,"accept_rate":75,"display_name":"Hugo L.M"},"comment_count":0,"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1684165790,"creation_date":1684165790,"answer_id":76255841,"question_id":76255236,"body_markdown":"Finally, I implemented a new class to convert granted authorities:\r\n\r\n    public class JwtGrantedAuthoritiesConverter implements Converter&lt;Jwt, Collection&lt;GrantedAuthority&gt;&gt; {\r\n    \r\n        @Override\r\n        public Collection&lt;GrantedAuthority&gt; convert(Jwt jwt) {\r\n            List&lt;Map&lt;String, String&gt;&gt; authorities = jwt.getClaim(&quot;authorities&quot;);\r\n    \r\n            return authorities.stream()\r\n                    .map(authority -&gt; new SimpleGrantedAuthority(authority.get(&quot;authority&quot;)))\r\n                    .collect(Collectors.toList());\r\n        }\r\n    }\r\n\r\n\r\n\r\nThen I use it in SecurityFilterChain:\r\n    \r\n                    .oauth2ResourceServer(oauth2 -&gt; oauth2.jwt(jwt -&gt; {\r\n                        jwt.decoder(jwtDecoder);\r\n                        jwt.jwtAuthenticationConverter(jwtAuthenticationConverter());\r\n                    }));","title":"Authorities not loaded in Spring Security with JWT token and Spring Boot 3","body":"<p>Finally, I implemented a new class to convert granted authorities:</p>\n<pre><code>public class JwtGrantedAuthoritiesConverter implements Converter&lt;Jwt, Collection&lt;GrantedAuthority&gt;&gt; {\n\n    @Override\n    public Collection&lt;GrantedAuthority&gt; convert(Jwt jwt) {\n        List&lt;Map&lt;String, String&gt;&gt; authorities = jwt.getClaim(&quot;authorities&quot;);\n\n        return authorities.stream()\n                .map(authority -&gt; new SimpleGrantedAuthority(authority.get(&quot;authority&quot;)))\n                .collect(Collectors.toList());\n    }\n}\n</code></pre>\n<p>Then I use it in SecurityFilterChain:</p>\n<pre><code>                .oauth2ResourceServer(oauth2 -&gt; oauth2.jwt(jwt -&gt; {\n                    jwt.decoder(jwtDecoder);\n                    jwt.jwtAuthenticationConverter(jwtAuthenticationConverter());\n                }));\n</code></pre>\n"},{"tags":[],"owner":{"account_id":25690087,"reputation":1360,"user_id":19451633,"display_name":"Andrei Titov"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684838949,"creation_date":1684835500,"answer_id":76313432,"question_id":76255236,"body_markdown":"With `spring-boot-starter-oauth2-resource-server` dependency you can also do that with out-of-box [JwtAuthenticationConverter](https://github.com/spring-projects/spring-security/blob/main/oauth2/oauth2-resource-server/src/main/java/org/springframework/security/oauth2/server/resource/authentication/JwtAuthenticationConverter.java) class by just defining an additional `@Bean`:\r\n\r\n```java\r\n@Bean\r\npublic JwtAuthenticationConverter jwtAuthenticationConverter() {\r\n    final JwtGrantedAuthoritiesConverter grantedAuthoritiesConverter = new JwtGrantedAuthoritiesConverter();\r\n    grantedAuthoritiesConverter.setAuthoritiesClaimName(&quot;authorities&quot;); // defaults to &quot;scope&quot; or &quot;scp&quot;\r\n    grantedAuthoritiesConverter.setAuthorityPrefix(&quot;&quot;); // defaults to &quot;SCOPE_&quot;\r\n\r\n    final JwtAuthenticationConverter jwtAuthenticationConverter = new JwtAuthenticationConverter();\r\n    jwtAuthenticationConverter.setJwtGrantedAuthoritiesConverter(grantedAuthoritiesConverter);\r\n    return jwtAuthenticationConverter;\r\n}\r\n```\r\n\r\nWith it you don&#39;t need to additionally configure your `JwtDecoder` and set any converters manually to a security filter chain config.  \r\nThis converter supports authorities claim as array and as string, in case of string representation consider defining delimiter using [`setAuthoritiesClaimDelimiter()`](https://github.com/spring-projects/spring-security/blob/main/oauth2/oauth2-resource-server/src/main/java/org/springframework/security/oauth2/server/resource/authentication/JwtGrantedAuthoritiesConverter.java#L91) method, default is `&quot; &quot;` (single space character).","title":"Authorities not loaded in Spring Security with JWT token and Spring Boot 3","body":"<p>With <code>spring-boot-starter-oauth2-resource-server</code> dependency you can also do that with out-of-box <a href=\"https://github.com/spring-projects/spring-security/blob/main/oauth2/oauth2-resource-server/src/main/java/org/springframework/security/oauth2/server/resource/authentication/JwtAuthenticationConverter.java\" rel=\"nofollow noreferrer\">JwtAuthenticationConverter</a> class by just defining an additional <code>@Bean</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\npublic JwtAuthenticationConverter jwtAuthenticationConverter() {\n    final JwtGrantedAuthoritiesConverter grantedAuthoritiesConverter = new JwtGrantedAuthoritiesConverter();\n    grantedAuthoritiesConverter.setAuthoritiesClaimName(&quot;authorities&quot;); // defaults to &quot;scope&quot; or &quot;scp&quot;\n    grantedAuthoritiesConverter.setAuthorityPrefix(&quot;&quot;); // defaults to &quot;SCOPE_&quot;\n\n    final JwtAuthenticationConverter jwtAuthenticationConverter = new JwtAuthenticationConverter();\n    jwtAuthenticationConverter.setJwtGrantedAuthoritiesConverter(grantedAuthoritiesConverter);\n    return jwtAuthenticationConverter;\n}\n</code></pre>\n<p>With it you don't need to additionally configure your <code>JwtDecoder</code> and set any converters manually to a security filter chain config.<br />\nThis converter supports authorities claim as array and as string, in case of string representation consider defining delimiter using <a href=\"https://github.com/spring-projects/spring-security/blob/main/oauth2/oauth2-resource-server/src/main/java/org/springframework/security/oauth2/server/resource/authentication/JwtGrantedAuthoritiesConverter.java#L91\" rel=\"nofollow noreferrer\"><code>setAuthoritiesClaimDelimiter()</code></a> method, default is <code>&quot; &quot;</code> (single space character).</p>\n"}],"owner":{"account_id":9256941,"reputation":1073,"user_id":6875688,"accept_rate":75,"display_name":"Hugo L.M"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":999,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1684838949,"creation_date":1684161855,"question_id":76255236,"body_markdown":"I am developing a Java service using JDK 17, Spring Boot 3, and Spring Security 6.0.3. The service is an API that requires validation of a JWT token using a public key.\r\n\r\nI have the following security configuration in SecurityConfig.java:\r\n\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.security.config.annotation.web.builders.HttpSecurity;\r\n    import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\r\n    import org.springframework.security.config.http.SessionCreationPolicy;\r\n    import org.springframework.security.oauth2.jwt.JwtDecoder;\r\n    import org.springframework.security.web.SecurityFilterChain;\r\n    \r\n    @Configuration\r\n    @EnableWebSecurity\r\n    public class SecurityConfig {\r\n        public static final String ADMIN = &quot;ROLE_ADMIN&quot;;\r\n    \r\n        private static final String[] AUTH_WHITELIST = {\r\n            &quot;/actuator/**&quot;,\r\n        };\r\n    \r\n        @Bean\r\n        public SecurityFilterChain securityFilterChain(HttpSecurity http, JwtDecoder jwtDecoder) throws Exception {\r\n            http\r\n                .csrf().disable()\r\n                .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)\r\n                .and()\r\n                .formLogin().disable()\r\n                .authorizeHttpRequests(requests -&gt; requests\r\n                    .requestMatchers(AUTH_WHITELIST).permitAll()\r\n                    .requestMatchers(&quot;/api/test/**&quot;).hasAnyAuthority(ADMIN)\r\n                    .anyRequest().authenticated()\r\n                )\r\n                .oauth2ResourceServer(oauth2 -&gt; oauth2.jwt(jwt -&gt; {\r\n                    jwt.decoder(jwtDecoder);\r\n                }));\r\n    \r\n            return http.build();\r\n        }\r\n    }\r\n\r\nIn addition, the AppConfig.java class contains the following code:\r\n\r\n    import lombok.RequiredArgsConstructor;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.core.convert.converter.Converter;\r\n    import org.springframework.security.oauth2.jwt.JwtDecoder;\r\n    import org.springframework.security.oauth2.jwt.NimbusJwtDecoder;\r\n    \r\n    import java.time.Instant;\r\n    import java.util.*;\r\n    \r\n    @Configuration\r\n    @RequiredArgsConstructor\r\n    public class AppConfig {\r\n        private final RsaKeyProperties rsaKeys;\r\n    \r\n        @Bean\r\n        JwtDecoder jwtDecoder() {\r\n            return NimbusJwtDecoder.withPublicKey(rsaKeys.publicKey()).build();\r\n        }\r\n    }\r\n\r\n\r\nThe problem I&#39;m facing is that Spring Security is not loading the authorities as expected. The following log message shows an authenticated token, but the &quot;Granted Authorities&quot; are empty:\r\n\r\n&gt; 2023-05-15T16:26:39.048+02:00 DEBUG 74733 --- [nio-8080-exec-3]\r\n&gt; o.s.s.o.s.r.a.JwtAuthenticationProvider  : Authenticated token\r\n&gt; 2023-05-15T16:26:39.048+02:00 DEBUG 74733 --- [nio-8080-exec-3]\r\n&gt; .s.r.w.a.BearerTokenAuthenticationFilter : Set SecurityContextHolder\r\n&gt; to JwtAuthenticationToken\r\n&gt; [Principal=org.springframework.security.oauth2.jwt.Jwt@d70a35df,\r\n&gt; Credentials=[PROTECTED], Authenticated=true,\r\n&gt; Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1,\r\n&gt; SessionId=null], Granted Authorities=[]]\r\n\r\nI have even tried using a custom Converter in AppConfig.java to convert the claims and add the authorities, but the issue persists. Here is the relevant code from AppConfig.java:\r\n\r\n    import lombok.RequiredArgsConstructor;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.core.convert.converter.Converter;\r\n    import org.springframework.security.oauth2.jwt.JwtDecoder;\r\n    import org.springframework.security.oauth2.jwt.NimbusJwtDecoder;\r\n    \r\n    import java.time.Instant;\r\n    import java.util.*;\r\n    \r\n    @Configuration\r\n    @RequiredArgsConstructor\r\n    public class AppConfig {\r\n        private final RsaKeyProperties rsaKeys;\r\n    \r\n        @Bean\r\n        JwtDecoder jwtDecoder() {\r\n            NimbusJwtDecoder jwtDecoder = NimbusJwtDecoder.withPublicKey(rsaKeys.publicKey()).build();\r\n            jwtDecoder.setClaimSetConverter(getClaimConverter());\r\n            return jwtDecoder;\r\n        }\r\n    \r\n        private Converter&lt;Map&lt;String, Object&gt;, Map&lt;String, Object&gt;&gt; getClaimConverter() {\r\n            return claims -&gt; {\r\n                Map&lt;String, Object&gt; mutableClaims = new HashMap&lt;&gt;(claims);\r\n    \r\n                // Convert &#39;exp&#39; and &#39;iat&#39; fields to Instant\r\n                if (claims.containsKey(&quot;exp&quot;)) {\r\n                    Date expDate = (Date) claims.get(&quot;exp&quot;);\r\n                    Instant expInstant = expDate.toInstant();\r\n                    mutableClaims.put(&quot;exp&quot;, expInstant);\r\n                }\r\n    \r\n                if (claims.containsKey(&quot;iat&quot;)) {\r\n                    Date iatDate = (Date) claims.get(&quot;iat&quot;);\r\n                    Instant iatInstant = iatDate.toInstant();\r\n                    mutableClaims.put(&quot;iat&quot;, iatInstant);\r\n                }\r\n    \r\n                // Hardcoded authorities for testing\r\n                List&lt;String&gt; authorities = List.of(&quot;ROLE_ADMIN&quot;);\r\n                mutableClaims.put(&quot;authorities&quot;, authorities);\r\n    \r\n                System.out.println(&quot;Claims: &quot; + claims);\r\n                System.out.println(&quot;Mutable claims: &quot; + mutableClaims);\r\n    \r\n                return mutableClaims;\r\n            };\r\n        }\r\n    }\r\n\r\n\r\n\r\nDespite these modifications, the &quot;Granted Authorities&quot; in the authentication token are still empty. As a result, I receive a 403 Forbidden response with the following message:\r\n\r\n&gt; www-authenticate: Bearer error=&quot;insufficient_scope&quot;,\r\n&gt; error_description=&quot;The request requires higher privileges than\r\n&gt; provided by the access token.&quot;,\r\n&gt; error_uri=&quot;https://tools.ietf.org/html/rfc6750#section-3.1&quot; I have\r\n&gt; also tested with hardcoding the authorities to ensure that the token\r\n&gt; format is not the issue. However, the authorities are still not\r\n&gt; properly loaded.\r\n\r\nI would greatly appreciate any guidance or suggestions on how to resolve this issue and ensure that the authorities are correctly loaded in Spring Security based on the provided token.\r\n\r\nThank you in advance for your help!\r\n\r\n----\r\n\r\nEdit 1\r\n\r\nToken example\r\n\r\n    {\r\n      &quot;sub&quot;: &quot;admin@example.com&quot;,\r\n      &quot;iss&quot;: &quot;self&quot;,\r\n      &quot;exp&quot;: 1684164375,\r\n      &quot;token_type&quot;: &quot;access_token&quot;,\r\n      &quot;iat&quot;: 1684160775,\r\n      &quot;authorities&quot;: [\r\n        &quot;ROLE_TEST&quot;,\r\n        &quot;ROLE_ADMIN&quot;,\r\n      ]\r\n    }","title":"Authorities not loaded in Spring Security with JWT token and Spring Boot 3","body":"<p>I am developing a Java service using JDK 17, Spring Boot 3, and Spring Security 6.0.3. The service is an API that requires validation of a JWT token using a public key.</p>\n<p>I have the following security configuration in SecurityConfig.java:</p>\n<pre><code>import org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.http.SessionCreationPolicy;\nimport org.springframework.security.oauth2.jwt.JwtDecoder;\nimport org.springframework.security.web.SecurityFilterChain;\n\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n    public static final String ADMIN = &quot;ROLE_ADMIN&quot;;\n\n    private static final String[] AUTH_WHITELIST = {\n        &quot;/actuator/**&quot;,\n    };\n\n    @Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http, JwtDecoder jwtDecoder) throws Exception {\n        http\n            .csrf().disable()\n            .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)\n            .and()\n            .formLogin().disable()\n            .authorizeHttpRequests(requests -&gt; requests\n                .requestMatchers(AUTH_WHITELIST).permitAll()\n                .requestMatchers(&quot;/api/test/**&quot;).hasAnyAuthority(ADMIN)\n                .anyRequest().authenticated()\n            )\n            .oauth2ResourceServer(oauth2 -&gt; oauth2.jwt(jwt -&gt; {\n                jwt.decoder(jwtDecoder);\n            }));\n\n        return http.build();\n    }\n}\n</code></pre>\n<p>In addition, the AppConfig.java class contains the following code:</p>\n<pre><code>import lombok.RequiredArgsConstructor;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.core.convert.converter.Converter;\nimport org.springframework.security.oauth2.jwt.JwtDecoder;\nimport org.springframework.security.oauth2.jwt.NimbusJwtDecoder;\n\nimport java.time.Instant;\nimport java.util.*;\n\n@Configuration\n@RequiredArgsConstructor\npublic class AppConfig {\n    private final RsaKeyProperties rsaKeys;\n\n    @Bean\n    JwtDecoder jwtDecoder() {\n        return NimbusJwtDecoder.withPublicKey(rsaKeys.publicKey()).build();\n    }\n}\n</code></pre>\n<p>The problem I'm facing is that Spring Security is not loading the authorities as expected. The following log message shows an authenticated token, but the &quot;Granted Authorities&quot; are empty:</p>\n<blockquote>\n<p>2023-05-15T16:26:39.048+02:00 DEBUG 74733 --- [nio-8080-exec-3]\no.s.s.o.s.r.a.JwtAuthenticationProvider  : Authenticated token\n2023-05-15T16:26:39.048+02:00 DEBUG 74733 --- [nio-8080-exec-3]\n.s.r.w.a.BearerTokenAuthenticationFilter : Set SecurityContextHolder\nto JwtAuthenticationToken\n[Principal=org.springframework.security.oauth2.jwt.Jwt@d70a35df,\nCredentials=[PROTECTED], Authenticated=true,\nDetails=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1,\nSessionId=null], Granted Authorities=[]]</p>\n</blockquote>\n<p>I have even tried using a custom Converter in AppConfig.java to convert the claims and add the authorities, but the issue persists. Here is the relevant code from AppConfig.java:</p>\n<pre><code>import lombok.RequiredArgsConstructor;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.core.convert.converter.Converter;\nimport org.springframework.security.oauth2.jwt.JwtDecoder;\nimport org.springframework.security.oauth2.jwt.NimbusJwtDecoder;\n\nimport java.time.Instant;\nimport java.util.*;\n\n@Configuration\n@RequiredArgsConstructor\npublic class AppConfig {\n    private final RsaKeyProperties rsaKeys;\n\n    @Bean\n    JwtDecoder jwtDecoder() {\n        NimbusJwtDecoder jwtDecoder = NimbusJwtDecoder.withPublicKey(rsaKeys.publicKey()).build();\n        jwtDecoder.setClaimSetConverter(getClaimConverter());\n        return jwtDecoder;\n    }\n\n    private Converter&lt;Map&lt;String, Object&gt;, Map&lt;String, Object&gt;&gt; getClaimConverter() {\n        return claims -&gt; {\n            Map&lt;String, Object&gt; mutableClaims = new HashMap&lt;&gt;(claims);\n\n            // Convert 'exp' and 'iat' fields to Instant\n            if (claims.containsKey(&quot;exp&quot;)) {\n                Date expDate = (Date) claims.get(&quot;exp&quot;);\n                Instant expInstant = expDate.toInstant();\n                mutableClaims.put(&quot;exp&quot;, expInstant);\n            }\n\n            if (claims.containsKey(&quot;iat&quot;)) {\n                Date iatDate = (Date) claims.get(&quot;iat&quot;);\n                Instant iatInstant = iatDate.toInstant();\n                mutableClaims.put(&quot;iat&quot;, iatInstant);\n            }\n\n            // Hardcoded authorities for testing\n            List&lt;String&gt; authorities = List.of(&quot;ROLE_ADMIN&quot;);\n            mutableClaims.put(&quot;authorities&quot;, authorities);\n\n            System.out.println(&quot;Claims: &quot; + claims);\n            System.out.println(&quot;Mutable claims: &quot; + mutableClaims);\n\n            return mutableClaims;\n        };\n    }\n}\n</code></pre>\n<p>Despite these modifications, the &quot;Granted Authorities&quot; in the authentication token are still empty. As a result, I receive a 403 Forbidden response with the following message:</p>\n<blockquote>\n<p>www-authenticate: Bearer error=&quot;insufficient_scope&quot;,\nerror_description=&quot;The request requires higher privileges than\nprovided by the access token.&quot;,\nerror_uri=&quot;https://tools.ietf.org/html/rfc6750#section-3.1&quot; I have\nalso tested with hardcoding the authorities to ensure that the token\nformat is not the issue. However, the authorities are still not\nproperly loaded.</p>\n</blockquote>\n<p>I would greatly appreciate any guidance or suggestions on how to resolve this issue and ensure that the authorities are correctly loaded in Spring Security based on the provided token.</p>\n<p>Thank you in advance for your help!</p>\n<hr />\n<p>Edit 1</p>\n<p>Token example</p>\n<pre><code>{\n  &quot;sub&quot;: &quot;admin@example.com&quot;,\n  &quot;iss&quot;: &quot;self&quot;,\n  &quot;exp&quot;: 1684164375,\n  &quot;token_type&quot;: &quot;access_token&quot;,\n  &quot;iat&quot;: 1684160775,\n  &quot;authorities&quot;: [\n    &quot;ROLE_TEST&quot;,\n    &quot;ROLE_ADMIN&quot;,\n  ]\n}\n</code></pre>\n"},{"tags":["java","selenium","selenium-webdriver"],"answers":[{"comments":[{"owner":{"account_id":306604,"reputation":37084,"user_id":617450,"accept_rate":61,"display_name":"Ripon Al Wasim"},"score":0,"creation_date":1390479661,"post_id":19669109,"comment_id":32114236,"body_markdown":"user1177636: Your previous code was Integer.toHexString(&lt;String&gt;), but parameter should be integer as Integer.toHexString(&lt;int&gt;)","body":"user1177636: Your previous code was Integer.toHexString(&lt;String&gt;), but parameter should be integer as Integer.toHexString(&lt;int&gt;)"}],"tags":[],"owner":{"account_id":1208658,"reputation":32250,"user_id":1177636,"accept_rate":50,"display_name":"Yi Zeng"},"comment_count":1,"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1390509883,"creation_date":1383080730,"answer_id":19669109,"question_id":19668893,"body_markdown":"First a quote from Selenium&#39;s documentation.\r\n\r\n&gt; Get the value of a given CSS property. Color values should be returned\r\n&gt; as rgba strings, so, for example if the &quot;background-color&quot; property is\r\n&gt; set as &quot;green&quot; in the HTML source, the returned value will be &quot;rgba(0,\r\n&gt; 255, 0, 1)&quot;. Note that shorthand CSS properties (e.g. background,\r\n&gt; font, border, border-top, margin, margin-top, padding, padding-top,\r\n&gt; list-style, outline, pause, cue) are not returned, in accordance with\r\n&gt; the DOM CSS2 specification - you should directly access the longhand\r\n&gt; properties (e.g. background-color) to access the desired values.\r\n\r\nThen this is not a Selenium specific question, this is just a general programming question about how to parse string `rgba(102,102,102)` to three number.\r\n\r\n    // Originally untested code, just the logic.\r\n    // Thanks for Ripon Al Wasim&#39;s correction.\r\n\r\n    String color = driver.findElement(By.xpath(&quot;//div[@class=&#39;gb_e gb_f gb_g gb_xb&#39;]/a&quot;)).getCssValue(&quot;color&quot;);\r\n\r\n    String[] numbers = color.replace(&quot;rgba(&quot;, &quot;&quot;).replace(&quot;)&quot;, &quot;&quot;).split(&quot;,&quot;);\r\n    int r = Integer.parseInt(numbers[0].trim());\r\n    int g = Integer.parseInt(numbers[1].trim());\r\n    int b = Integer.parseInt(numbers[2].trim());\r\n    System.out.println(&quot;r: &quot; + r + &quot;g: &quot; + g + &quot;b: &quot; + b);\r\n\r\n    String hex = &quot;#&quot; + Integer.toHexString(r) + Integer.toHexString(g) + Integer.toHexString(b);\r\n    System.out.println(hex);","title":"getCssValue (Color) in Hex format in Selenium WebDriver","body":"<p>First a quote from Selenium's documentation.</p>\n\n<blockquote>\n  <p>Get the value of a given CSS property. Color values should be returned\n  as rgba strings, so, for example if the \"background-color\" property is\n  set as \"green\" in the HTML source, the returned value will be \"rgba(0,\n  255, 0, 1)\". Note that shorthand CSS properties (e.g. background,\n  font, border, border-top, margin, margin-top, padding, padding-top,\n  list-style, outline, pause, cue) are not returned, in accordance with\n  the DOM CSS2 specification - you should directly access the longhand\n  properties (e.g. background-color) to access the desired values.</p>\n</blockquote>\n\n<p>Then this is not a Selenium specific question, this is just a general programming question about how to parse string <code>rgba(102,102,102)</code> to three number.</p>\n\n<pre><code>// Originally untested code, just the logic.\n// Thanks for Ripon Al Wasim's correction.\n\nString color = driver.findElement(By.xpath(\"//div[@class='gb_e gb_f gb_g gb_xb']/a\")).getCssValue(\"color\");\n\nString[] numbers = color.replace(\"rgba(\", \"\").replace(\")\", \"\").split(\",\");\nint r = Integer.parseInt(numbers[0].trim());\nint g = Integer.parseInt(numbers[1].trim());\nint b = Integer.parseInt(numbers[2].trim());\nSystem.out.println(\"r: \" + r + \"g: \" + g + \"b: \" + b);\n\nString hex = \"#\" + Integer.toHexString(r) + Integer.toHexString(g) + Integer.toHexString(b);\nSystem.out.println(hex);\n</code></pre>\n"},{"comments":[{"owner":{"account_id":8468750,"reputation":964,"user_id":6352151,"display_name":"Victor Moraes"},"score":0,"creation_date":1494253676,"post_id":21307354,"comment_id":74736314,"body_markdown":"In &quot;Way 2&quot; you are only using `numbers[0]`, when I believe you should actually be using `numbers[0]`, `numbers[1]` and `numbers[2]`","body":"In &quot;Way 2&quot; you are only using <code>numbers[0]</code>, when I believe you should actually be using <code>numbers[0]</code>, <code>numbers[1]</code> and <code>numbers[2]</code>"},{"owner":{"account_id":306604,"reputation":37084,"user_id":617450,"accept_rate":61,"display_name":"Ripon Al Wasim"},"score":0,"creation_date":1511265572,"post_id":21307354,"comment_id":81778390,"body_markdown":"Thanks  Victor Moraes to highlight the mistake. Yes, it should be numbers[0], numbers[1] and numbers[2]. I have corrected accordingly.","body":"Thanks  Victor Moraes to highlight the mistake. Yes, it should be numbers[0], numbers[1] and numbers[2]. I have corrected accordingly."},{"owner":{"account_id":4945970,"reputation":832,"user_id":3981312,"accept_rate":40,"display_name":"mancocapac"},"score":1,"creation_date":1520621753,"post_id":21307354,"comment_id":85405878,"body_markdown":"&quot;Way 2&quot;: The hex values should most likely be padded with leading 0&#39;s. I am here because a `driver.getElement().getCssValue(&quot;background-color&quot;) ` returns and rgba value: rgba(198, 15, 19, 1). DevTools gives a hex value: #c60f13, the above code returns #c6f13. suggest\n`String hex = String.format(&quot;#%02x%02x%02x&quot;, r,g,b);`","body":"&quot;Way 2&quot;: The hex values should most likely be padded with leading 0&#39;s. I am here because a <code>driver.getElement().getCssValue(&quot;background-color&quot;) </code> returns and rgba value: rgba(198, 15, 19, 1). DevTools gives a hex value: #c60f13, the above code returns #c6f13. suggest <code>String hex = String.format(&quot;#%02x%02x%02x&quot;, r,g,b);</code>"}],"tags":[],"owner":{"account_id":306604,"reputation":37084,"user_id":617450,"accept_rate":61,"display_name":"Ripon Al Wasim"},"comment_count":3,"down_vote_count":0,"up_vote_count":9,"is_accepted":true,"score":9,"last_activity_date":1511349240,"creation_date":1390477903,"answer_id":21307354,"question_id":19668893,"body_markdown":"Way 1: Using StringTokenizer:\r\n\r\n    String color = driver.findElement(By.xpath(&quot;//div[@class=&#39;gb_e gb_f gb_g gb_xb&#39;]/a&quot;)).getCssValue(&quot;color&quot;);\r\n    String s1 = color.substring(4);\r\n    color = s1.replace(&#39;)&#39;, &#39; &#39;);\r\n    StringTokenizer st = new StringTokenizer(color);\r\n    int r = Integer.parseInt(st.nextToken(&quot;,&quot;).trim());\r\n    int g = Integer.parseInt(st.nextToken(&quot;,&quot;).trim());\r\n    int b = Integer.parseInt(st.nextToken(&quot;,&quot;).trim());\r\n    Color c = new Color(r, g, b);\r\n    String hex = &quot;#&quot;+Integer.toHexString(c.getRGB()).substring(2);\r\n    System.out.println(hex);\r\n\r\nWay 2:\r\n\r\n    String color = driver.findElement(By.xpath(&quot;//div[@class=&#39;gb_e gb_f gb_g gb_xb&#39;]/a&quot;)).getCssValue(&quot;color&quot;);\r\n    String[] numbers = color.replace(&quot;rgb(&quot;, &quot;&quot;).replace(&quot;)&quot;, &quot;&quot;).split(&quot;,&quot;);\r\n    int r = Integer.parseInt(numbers[0].trim());\r\n    int g = Integer.parseInt(numbers[1].trim());\r\n    int b = Integer.parseInt(numbers[2].trim());\r\n    System.out.println(&quot;r: &quot; + r + &quot;g: &quot; + g + &quot;b: &quot; + b);\r\n    String hex = &quot;#&quot; + Integer.toHexString(r) + Integer.toHexString(g) + Integer.toHexString(b);\r\n    System.out.println(hex);\r\n\r\n","title":"getCssValue (Color) in Hex format in Selenium WebDriver","body":"<p>Way 1: Using StringTokenizer:</p>\n\n<pre><code>String color = driver.findElement(By.xpath(\"//div[@class='gb_e gb_f gb_g gb_xb']/a\")).getCssValue(\"color\");\nString s1 = color.substring(4);\ncolor = s1.replace(')', ' ');\nStringTokenizer st = new StringTokenizer(color);\nint r = Integer.parseInt(st.nextToken(\",\").trim());\nint g = Integer.parseInt(st.nextToken(\",\").trim());\nint b = Integer.parseInt(st.nextToken(\",\").trim());\nColor c = new Color(r, g, b);\nString hex = \"#\"+Integer.toHexString(c.getRGB()).substring(2);\nSystem.out.println(hex);\n</code></pre>\n\n<p>Way 2:</p>\n\n<pre><code>String color = driver.findElement(By.xpath(\"//div[@class='gb_e gb_f gb_g gb_xb']/a\")).getCssValue(\"color\");\nString[] numbers = color.replace(\"rgb(\", \"\").replace(\")\", \"\").split(\",\");\nint r = Integer.parseInt(numbers[0].trim());\nint g = Integer.parseInt(numbers[1].trim());\nint b = Integer.parseInt(numbers[2].trim());\nSystem.out.println(\"r: \" + r + \"g: \" + g + \"b: \" + b);\nString hex = \"#\" + Integer.toHexString(r) + Integer.toHexString(g) + Integer.toHexString(b);\nSystem.out.println(hex);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8468750,"reputation":964,"user_id":6352151,"display_name":"Victor Moraes"},"comment_count":0,"down_vote_count":0,"up_vote_count":14,"is_accepted":false,"score":14,"last_activity_date":1495583044,"creation_date":1494253553,"answer_id":43850214,"question_id":19668893,"body_markdown":"I know this is rather old, but you can get a simpler solution by using `org.openqa.selenium.support.Color`:\r\n\r\n    import org.openqa.selenium.support.Color;\r\n    String color = driver.findElement(By.xpath(&quot;//div[@class=&#39;gb_e gb_f gb_g gb_xb&#39;]/a&quot;)).getCssValue(&quot;color&quot;);\r\n    System.out.println(color);\r\n    String hex = Color.fromString(color).asHex();\r\n    System.out.println(hex);\r\n\r\nIt gives you a single line solution and even adds leading zeroes when required (something that the previous answers aren&#39;t accounting for)","title":"getCssValue (Color) in Hex format in Selenium WebDriver","body":"<p>I know this is rather old, but you can get a simpler solution by using <code>org.openqa.selenium.support.Color</code>:</p>\n\n<pre><code>import org.openqa.selenium.support.Color;\nString color = driver.findElement(By.xpath(\"//div[@class='gb_e gb_f gb_g gb_xb']/a\")).getCssValue(\"color\");\nSystem.out.println(color);\nString hex = Color.fromString(color).asHex();\nSystem.out.println(hex);\n</code></pre>\n\n<p>It gives you a single line solution and even adds leading zeroes when required (something that the previous answers aren't accounting for)</p>\n"},{"comments":[{"owner":{"account_id":8468750,"reputation":964,"user_id":6352151,"display_name":"Victor Moraes"},"score":0,"creation_date":1495632294,"post_id":44144119,"comment_id":75335753,"body_markdown":"I don&#39;t think a single letter typo in my answer would be a reason to add another answer to this. Just edit it, as you did. Plus, when you say &quot;The code works, but just a little typo&quot; it is not clear which code you&#39;re talking about. I know you&#39;re referring to mine because I received the notification, but for newcomers it might not be that clear. If you insist in providing a separate answer, I&#39;d advise adding a link to mine, for clarity. By the way, now that you edit my answer, yours is just a duplicate of mine with nothing to add (and it&#39;s even obsolete, since mine doesn&#39;t have typos anymore)","body":"I don&#39;t think a single letter typo in my answer would be a reason to add another answer to this. Just edit it, as you did. Plus, when you say &quot;The code works, but just a little typo&quot; it is not clear which code you&#39;re talking about. I know you&#39;re referring to mine because I received the notification, but for newcomers it might not be that clear. If you insist in providing a separate answer, I&#39;d advise adding a link to mine, for clarity. By the way, now that you edit my answer, yours is just a duplicate of mine with nothing to add (and it&#39;s even obsolete, since mine doesn&#39;t have typos anymore)"},{"owner":{"account_id":10737218,"reputation":151,"user_id":7901526,"display_name":"Fai Hasan"},"score":0,"creation_date":1495633287,"post_id":44144119,"comment_id":75336572,"body_markdown":"thanks bro, i couldn&#39;t edit or comment because i am under 15","body":"thanks bro, i couldn&#39;t edit or comment because i am under 15"}],"tags":[],"owner":{"account_id":10737218,"reputation":151,"user_id":7901526,"display_name":"Fai Hasan"},"comment_count":2,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1495570454,"creation_date":1495570085,"answer_id":44144119,"question_id":19668893,"body_markdown":"The code works, but just a little typo. The Color.fromString would be upper case C\r\n\r\n\r\n    import org.openqa.selenium.support.Color;\r\n    \r\n    String color = driver.findElement(By.xpath(&quot;xpath_value&quot;)).getCssValue(&quot;color&quot;);\r\n    System.out.println(color);\r\n    String hex = Color.fromString(color).asHex();\r\n    System.out.println(hex);\r\n\r\n","title":"getCssValue (Color) in Hex format in Selenium WebDriver","body":"<p>The code works, but just a little typo. The Color.fromString would be upper case C</p>\n\n<pre><code>import org.openqa.selenium.support.Color;\n\nString color = driver.findElement(By.xpath(\"xpath_value\")).getCssValue(\"color\");\nSystem.out.println(color);\nString hex = Color.fromString(color).asHex();\nSystem.out.println(hex);\n</code></pre>\n"},{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":1,"creation_date":1684856896,"post_id":76313855,"comment_id":134577148,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/76313855/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":23058055,"reputation":1,"user_id":17173821,"display_name":"Akshat Jain"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684838560,"creation_date":1684838560,"answer_id":76313855,"question_id":19668893,"body_markdown":"    import org.openqa.selenium.support.Color;\r\n    \r\n    String color = driver.findElement(By.xpath(&quot;xpath_value&quot;)).getCssValue(&quot;color&quot;);\r\n    System.out.println(color);\r\n    String hex = Color.fromString(color).asHex();\r\n    System.out.println(hex);\r\n\r\njust a simple and sweet code will help you to get a answer","title":"getCssValue (Color) in Hex format in Selenium WebDriver","body":"<pre><code>import org.openqa.selenium.support.Color;\n\nString color = driver.findElement(By.xpath(&quot;xpath_value&quot;)).getCssValue(&quot;color&quot;);\nSystem.out.println(color);\nString hex = Color.fromString(color).asHex();\nSystem.out.println(hex);\n</code></pre>\n<p>just a simple and sweet code will help you to get a answer</p>\n"}],"owner":{"account_id":2802238,"reputation":531,"user_id":2410266,"accept_rate":55,"display_name":"user2410266"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":42412,"favorite_count":0,"down_vote_count":0,"up_vote_count":9,"accepted_answer_id":21307354,"answer_count":5,"score":9,"last_activity_date":1684838560,"creation_date":1383080072,"question_id":19668893,"body_markdown":"In the following code I need to print the `color` in `Hex format`. \r\n\r\n*First* Print statement is showing value in `RGB` format which is `rgb(102,102,102)`.\r\n\r\nThe *Second* statement is showing value in `Hex`  which is `#666666`\r\n\r\nBut I am manually entering the value into the second print statement which is `102,102,102`.\r\n\r\nIs there any way to pass the value which I got from the 1st statement (Color) into the second print statement and get result?\r\n\r\n    import org.openqa.selenium.By;\r\n    import org.openqa.selenium.WebDriver;\r\n    import org.openqa.selenium.firefox.FirefoxDriver;\r\n    \r\n    public class Google {\r\n    \r\n        public static void main(String[] args) throws Exception {\r\n          \r\n            WebDriver driver = new FirefoxDriver();\r\n            driver.get(&quot;http://www.google.com/&quot;);\r\n            String Color = driver.findElement(By.xpath(&quot;//div[@class=&#39;gb_e gb_f gb_g gb_xb&#39;]/a&quot;)).getCssValue(&quot;color&quot;);\r\n            System.out.println(Color);\r\n            String hex = String.format(&quot;#%02x%02x%02x&quot;, 102,102,102);\r\n            System.out.println(hex);\r\n        }\r\n    }","title":"getCssValue (Color) in Hex format in Selenium WebDriver","body":"<p>In the following code I need to print the <code>color</code> in <code>Hex format</code>. </p>\n\n<p><em>First</em> Print statement is showing value in <code>RGB</code> format which is <code>rgb(102,102,102)</code>.</p>\n\n<p>The <em>Second</em> statement is showing value in <code>Hex</code>  which is <code>#666666</code></p>\n\n<p>But I am manually entering the value into the second print statement which is <code>102,102,102</code>.</p>\n\n<p>Is there any way to pass the value which I got from the 1st statement (Color) into the second print statement and get result?</p>\n\n<pre><code>import org.openqa.selenium.By;\nimport org.openqa.selenium.WebDriver;\nimport org.openqa.selenium.firefox.FirefoxDriver;\n\npublic class Google {\n\n    public static void main(String[] args) throws Exception {\n\n        WebDriver driver = new FirefoxDriver();\n        driver.get(\"http://www.google.com/\");\n        String Color = driver.findElement(By.xpath(\"//div[@class='gb_e gb_f gb_g gb_xb']/a\")).getCssValue(\"color\");\n        System.out.println(Color);\n        String hex = String.format(\"#%02x%02x%02x\", 102,102,102);\n        System.out.println(hex);\n    }\n}\n</code></pre>\n"},{"tags":["java","junit","mockito","lombok","testcase"],"answers":[{"tags":[],"owner":{"account_id":401843,"reputation":89863,"user_id":768644,"display_name":"rzwitserloot"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1684835837,"creation_date":1684835837,"answer_id":76313483,"question_id":76313443,"body_markdown":"Lombok author here: You don&#39;t.\r\n\r\nYou don&#39;t write test code to test that the inner workings of hibernate work correctly either; it&#39;s hibernate&#39;s job to test that. You don&#39;t test whether java&#39;s `switch` statement does what the spec says it does; it&#39;s team OpenJDK (the authors of `javac`)&#39;s job to test that.\r\n\r\nIf you&#39;re chasing 100% code coverage by your tests, configure your code coverage tool to exclude lombok-generated code.","title":"How can I write the test cases for Lombok annotation","body":"<p>Lombok author here: You don't.</p>\n<p>You don't write test code to test that the inner workings of hibernate work correctly either; it's hibernate's job to test that. You don't test whether java's <code>switch</code> statement does what the spec says it does; it's team OpenJDK (the authors of <code>javac</code>)'s job to test that.</p>\n<p>If you're chasing 100% code coverage by your tests, configure your code coverage tool to exclude lombok-generated code.</p>\n"},{"tags":[],"owner":{"account_id":22577442,"reputation":758,"user_id":16775102,"display_name":"Feel free"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1684837912,"creation_date":1684837912,"answer_id":76313757,"question_id":76313443,"body_markdown":"You are testing only all args constructor. You can add test for no args constructor like:\r\n\r\n        @Test\r\n        public void testABC() {\r\n            ABC abc = new ABC();\r\n            assertNotNull(abc); \r\n        }","title":"How can I write the test cases for Lombok annotation","body":"<p>You are testing only all args constructor. You can add test for no args constructor like:</p>\n<pre><code>    @Test\n    public void testABC() {\n        ABC abc = new ABC();\n        assertNotNull(abc); \n    }\n</code></pre>\n"}],"owner":{"account_id":15461608,"reputation":11,"user_id":11154158,"display_name":"Praveen"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":139,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1684837912,"creation_date":1684835563,"question_id":76313443,"body_markdown":"**How can I write the test cases for Lombok annotation?**\r\n```\r\n@Data\r\n@NoArgsConstructor\r\n@AllArgsConstructor\r\npublic class ABC{\r\n\t\r\n\tprivate String status;\r\n\tprivate String errorCode;\r\n\tprivate String message;\r\n\tprivate String id;\r\n\tprivate Long orderNumber;\r\n\tprivate Long lineId;\r\n}\r\n//writing testcases for above class\t\r\n@Test\r\n\tpublic void testupdate_1()throws Exception{\r\n\t\t\r\n\t\r\n\tABC result=new ABC();\r\n\tresult.setStatus(&quot;&quot;);\r\n\tresult.setErrorCode(&quot;&quot;);\r\n\tresult.setMessage(&quot;&quot;);\r\n\tresult.setId(&quot;&quot;);\r\n\tresult.setOrderNumber(123l);\r\n\tresult.setLineId(12l);;\r\n\tassertNotNull(result);\r\n\tassertEquals(&quot;&quot;, result.getStatus());\r\n\tassertEquals(&quot;&quot;, result.getErrorCode());\r\n\tassertEquals(&quot;&quot;, result.getMessage());\r\n\tassertEquals(&quot;&quot;, result.getId());\r\n\tassertEquals(Long.valueOf(123l), result.getOrderNumber());\r\n\tassertEquals(Long.valueOf(12l), result.getLineId());\r\n\t\r\n\t}\r\n```\r\n\r\n\r\neven I tried this but code coverage is showing very less. Please, anyone can help me to find correct answer for this.","title":"How can I write the test cases for Lombok annotation","body":"<p><strong>How can I write the test cases for Lombok annotation?</strong></p>\n<pre><code>@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class ABC{\n    \n    private String status;\n    private String errorCode;\n    private String message;\n    private String id;\n    private Long orderNumber;\n    private Long lineId;\n}\n//writing testcases for above class \n@Test\n    public void testupdate_1()throws Exception{\n        \n    \n    ABC result=new ABC();\n    result.setStatus(&quot;&quot;);\n    result.setErrorCode(&quot;&quot;);\n    result.setMessage(&quot;&quot;);\n    result.setId(&quot;&quot;);\n    result.setOrderNumber(123l);\n    result.setLineId(12l);;\n    assertNotNull(result);\n    assertEquals(&quot;&quot;, result.getStatus());\n    assertEquals(&quot;&quot;, result.getErrorCode());\n    assertEquals(&quot;&quot;, result.getMessage());\n    assertEquals(&quot;&quot;, result.getId());\n    assertEquals(Long.valueOf(123l), result.getOrderNumber());\n    assertEquals(Long.valueOf(12l), result.getLineId());\n    \n    }\n</code></pre>\n<p>even I tried this but code coverage is showing very less. Please, anyone can help me to find correct answer for this.</p>\n"},{"tags":["java","file","replace","copy"],"answers":[{"comments":[{"owner":{"account_id":399609,"reputation":691,"user_id":765075,"display_name":"commander_keen"},"score":0,"creation_date":1371560803,"post_id":17169576,"comment_id":24858578,"body_markdown":"Arg, why did I think it was an issue with the copyOption... Totally ignored the first two parameter types, thank you. Seems like I&#39;ve been coding for too long in the heat. ;-)","body":"Arg, why did I think it was an issue with the copyOption... Totally ignored the first two parameter types, thank you. Seems like I&#39;ve been coding for too long in the heat. ;-)"},{"owner":{"account_id":399609,"reputation":691,"user_id":765075,"display_name":"commander_keen"},"score":0,"creation_date":1371727699,"post_id":17169576,"comment_id":24932988,"body_markdown":"Uff, after copying the exported jar to a PC with Java 1.6 (that&#39;s why I mentioned that I need to be 1.6 compatible although I develop with Java 7 and compile for 1.6), it moans \n&quot;Exception in thread &quot;main&quot; java.lang.NoSuchMethodError: java.io.File.toPath()Lja\nva/nio/file/Path;&quot;\n\naccording to the documentations it&#39;s right, this method is only available since Java 7. (I wonder why this was not critized during development/design-time like other things I tried to use from Java 7 before, now I have to check everything by hand...)","body":"Uff, after copying the exported jar to a PC with Java 1.6 (that&#39;s why I mentioned that I need to be 1.6 compatible although I develop with Java 7 and compile for 1.6), it moans  &quot;Exception in thread &quot;main&quot; java.lang.NoSuchMethodError: java.io.File.toPath()Lja va/nio/file/Path;&quot;  according to the documentations it&#39;s right, this method is only available since Java 7. (I wonder why this was not critized during development/design-time like other things I tried to use from Java 7 before, now I have to check everything by hand...)"},{"owner":{"account_id":20627356,"reputation":49,"user_id":15142894,"display_name":"Vikas Roy"},"score":0,"creation_date":1655790808,"post_id":17169576,"comment_id":128408291,"body_markdown":"I have one query about this :  if two persons are uploading a image which **name and type** is same but image is different then who will upload in last with same type then previous image will replace with new image which has same type. what should i do for this **problem** because type and name is same but image is different so I don&#39;t want to replace it.","body":"I have one query about this :  if two persons are uploading a image which <b>name and type</b> is same but image is different then who will upload in last with same type then previous image will replace with new image which has same type. what should i do for this <b>problem</b> because type and name is same but image is different so I don&#39;t want to replace it."},{"owner":{"account_id":440158,"reputation":323231,"user_id":829571,"accept_rate":94,"display_name":"assylias"},"score":0,"creation_date":1655966882,"post_id":17169576,"comment_id":128458153,"body_markdown":"@VikasRoy I suggest you ask a separate question explaining your specific issue.","body":"@VikasRoy I suggest you ask a separate question explaining your specific issue."}],"tags":[],"owner":{"account_id":440158,"reputation":323231,"user_id":829571,"accept_rate":94,"display_name":"assylias"},"comment_count":4,"down_vote_count":0,"up_vote_count":129,"is_accepted":false,"score":129,"last_activity_date":1371560570,"creation_date":1371560570,"answer_id":17169576,"question_id":17169541,"body_markdown":"You need to pass `Path` arguments as explained by the error message:\r\n\r\n    Path from = cfgFilePath.toPath(); //convert from File to Path\r\n    Path to = Paths.get(strTarget); //convert from String to Path\r\n    Files.copy(from, to, StandardCopyOption.REPLACE_EXISTING);\r\n\r\nThat assumes your `strTarget` is a valid path.","title":"Copy file in Java and replace existing target","body":"<p>You need to pass <code>Path</code> arguments as explained by the error message:</p>\n\n<pre><code>Path from = cfgFilePath.toPath(); //convert from File to Path\nPath to = Paths.get(strTarget); //convert from String to Path\nFiles.copy(from, to, StandardCopyOption.REPLACE_EXISTING);\n</code></pre>\n\n<p>That assumes your <code>strTarget</code> is a valid path.</p>\n"},{"tags":[],"owner":{"account_id":2690688,"reputation":46,"user_id":2324109,"display_name":"vincentcjl"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1371560632,"creation_date":1371560632,"answer_id":17169599,"question_id":17169541,"body_markdown":"strTarget is a &quot;String&quot; object and not a &quot;Path&quot; object","title":"Copy file in Java and replace existing target","body":"<p>strTarget is a \"String\" object and not a \"Path\" object</p>\n"},{"comments":[{"owner":{"account_id":399609,"reputation":691,"user_id":765075,"display_name":"commander_keen"},"score":0,"creation_date":1371566711,"post_id":17169700,"comment_id":24862625,"body_markdown":"I wonder if this will work when I compile with compliance level for Java 1.6 as mentioned, but in any case thanks for the note, will keep it in mind for the future.","body":"I wonder if this will work when I compile with compliance level for Java 1.6 as mentioned, but in any case thanks for the note, will keep it in mind for the future."},{"owner":{"account_id":1101161,"reputation":119804,"user_id":1093528,"accept_rate":65,"display_name":"fge"},"score":0,"creation_date":1371569171,"post_id":17169700,"comment_id":24864336,"body_markdown":"@commander_keen do you mean the code you will deploy to runs 1.6 JVMs?","body":"@commander_keen do you mean the code you will deploy to runs 1.6 JVMs?"},{"owner":{"account_id":399609,"reputation":691,"user_id":765075,"display_name":"commander_keen"},"score":0,"creation_date":1371728933,"post_id":17169700,"comment_id":24933627,"body_markdown":"That is correct. As now recognized in the comments above, the whole Path thing and copy methods won&#39;t work. :-( Have to figure out how to copy files with Java 1.6 methods only and implement it again. Hints on best practice for 1.6 are welcome, though.","body":"That is correct. As now recognized in the comments above, the whole Path thing and copy methods won&#39;t work. :-( Have to figure out how to copy files with Java 1.6 methods only and implement it again. Hints on best practice for 1.6 are welcome, though."},{"owner":{"account_id":266456,"reputation":767,"user_id":554039,"display_name":"suriv"},"score":2,"creation_date":1465266566,"post_id":17169700,"comment_id":62817118,"body_markdown":"[File**s**](https://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html) != [File](https://docs.oracle.com/javase/7/docs/api/java/io/File.html). File**s** is part of nio. Please don&#39;t write 60 lines of boilerplate to avoid using Files.copy.","body":"<a href=\"https://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html\" rel=\"nofollow noreferrer\">File<b>s</b></a> != <a href=\"https://docs.oracle.com/javase/7/docs/api/java/io/File.html\" rel=\"nofollow noreferrer\">File</a>. File<b>s</b> is part of nio. Please don&#39;t write 60 lines of boilerplate to avoid using Files.copy."},{"owner":{"account_id":1101161,"reputation":119804,"user_id":1093528,"accept_rate":65,"display_name":"fge"},"score":0,"creation_date":1465294112,"post_id":17169700,"comment_id":62829848,"body_markdown":"@suriv the OP says he has to use Java 6... And yes, I know JSR 203. Quite well in fact.","body":"@suriv the OP says he has to use Java 6... And yes, I know JSR 203. Quite well in fact."}],"tags":[],"owner":{"account_id":1101161,"reputation":119804,"user_id":1093528,"accept_rate":65,"display_name":"fge"},"comment_count":5,"down_vote_count":5,"up_vote_count":15,"is_accepted":true,"score":10,"last_activity_date":1371732747,"creation_date":1371560887,"answer_id":17169700,"question_id":17169541,"body_markdown":"As a complement to @assylias&#39; answer:\r\n\r\nIf you use Java 7, drop `File` entirely. What you want is `Path` instead.\r\n\r\nAnd to get a `Path` object matching a path on your filesystem, you do:\r\n\r\n    Paths.get(&quot;path/to/file&quot;); // argument may also be absolute\r\n\r\nGet used to it real fast. Note that if you still use APIs which require `File`, `Path` has a `.toFile()` method.\r\n\r\nNote that if you are in the unfortunate case where you use an API which returns `File` objects, you can always do:\r\n\r\n    theFileObject.toPath()\r\n\r\nBut in code of yours, use `Path`. Systematically. Without a second thought.\r\n\r\n**EDIT** Copying a file to another using 1.6 using NIO can be done as such; note that the `Closer` class is inspited by [Guava][1]:\r\n\r\n    public final class Closer\r\n        implements Closeable\r\n    {\r\n        private final List&lt;Closeable&gt; closeables = new ArrayList&lt;Closeable&gt;();\r\n\r\n        // @Nullable is a JSR 305 annotation\r\n        public &lt;T extends Closeable&gt; T add(@Nullable final T closeable)\r\n        {\r\n            closeables.add(closeable);\r\n            return closeable;\r\n        }\r\n\r\n        public void closeQuietly()\r\n        {\r\n            try {\r\n                close();\r\n            } catch (IOException ignored) {\r\n            }\r\n        }\r\n\r\n        @Override\r\n        public void close()\r\n            throws IOException\r\n        {\r\n            IOException toThrow = null;\r\n            final List&lt;Closeable&gt; l = new ArrayList&lt;Closeable&gt;(closeables);\r\n            Collections.reverse(l);\r\n\r\n            for (final Closeable closeable: l) {\r\n                if (closeable == null)\r\n                    continue;\r\n                try {\r\n                    closeable.close();\r\n                } catch (IOException e) {\r\n                    if (toThrow == null)\r\n                        toThrow = e;\r\n                }\r\n            }\r\n\r\n            if (toThrow != null)\r\n                throw toThrow;\r\n        }\r\n    }\r\n\r\n    // Copy one file to another using NIO\r\n    public static void doCopy(final File source, final File destination)\r\n        throws IOException\r\n    {\r\n        final Closer closer = new Closer();\r\n        final RandomAccessFile src, dst;\r\n        final FileChannel in, out;\r\n    \r\n        try {\r\n            src = closer.add(new RandomAccessFile(source.getCanonicalFile(), &quot;r&quot;);\r\n            dst = closer.add(new RandomAccessFile(destination.getCanonicalFile(), &quot;rw&quot;);\r\n            in = closer.add(src.getChannel());\r\n            out = closer.add(dst.getChannel());\r\n            in.transferTo(0L, in.size(), out);\r\n            out.force(false);\r\n        } finally {\r\n            closer.close();\r\n        }\r\n    }\r\n\r\n\r\n  [1]: http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/Closer.html","title":"Copy file in Java and replace existing target","body":"<p>As a complement to @assylias' answer:</p>\n\n<p>If you use Java 7, drop <code>File</code> entirely. What you want is <code>Path</code> instead.</p>\n\n<p>And to get a <code>Path</code> object matching a path on your filesystem, you do:</p>\n\n<pre><code>Paths.get(\"path/to/file\"); // argument may also be absolute\n</code></pre>\n\n<p>Get used to it real fast. Note that if you still use APIs which require <code>File</code>, <code>Path</code> has a <code>.toFile()</code> method.</p>\n\n<p>Note that if you are in the unfortunate case where you use an API which returns <code>File</code> objects, you can always do:</p>\n\n<pre><code>theFileObject.toPath()\n</code></pre>\n\n<p>But in code of yours, use <code>Path</code>. Systematically. Without a second thought.</p>\n\n<p><strong>EDIT</strong> Copying a file to another using 1.6 using NIO can be done as such; note that the <code>Closer</code> class is inspited by <a href=\"http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/Closer.html\" rel=\"noreferrer\">Guava</a>:</p>\n\n<pre><code>public final class Closer\n    implements Closeable\n{\n    private final List&lt;Closeable&gt; closeables = new ArrayList&lt;Closeable&gt;();\n\n    // @Nullable is a JSR 305 annotation\n    public &lt;T extends Closeable&gt; T add(@Nullable final T closeable)\n    {\n        closeables.add(closeable);\n        return closeable;\n    }\n\n    public void closeQuietly()\n    {\n        try {\n            close();\n        } catch (IOException ignored) {\n        }\n    }\n\n    @Override\n    public void close()\n        throws IOException\n    {\n        IOException toThrow = null;\n        final List&lt;Closeable&gt; l = new ArrayList&lt;Closeable&gt;(closeables);\n        Collections.reverse(l);\n\n        for (final Closeable closeable: l) {\n            if (closeable == null)\n                continue;\n            try {\n                closeable.close();\n            } catch (IOException e) {\n                if (toThrow == null)\n                    toThrow = e;\n            }\n        }\n\n        if (toThrow != null)\n            throw toThrow;\n    }\n}\n\n// Copy one file to another using NIO\npublic static void doCopy(final File source, final File destination)\n    throws IOException\n{\n    final Closer closer = new Closer();\n    final RandomAccessFile src, dst;\n    final FileChannel in, out;\n\n    try {\n        src = closer.add(new RandomAccessFile(source.getCanonicalFile(), \"r\");\n        dst = closer.add(new RandomAccessFile(destination.getCanonicalFile(), \"rw\");\n        in = closer.add(src.getChannel());\n        out = closer.add(dst.getChannel());\n        in.transferTo(0L, in.size(), out);\n        out.force(false);\n    } finally {\n        closer.close();\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9959452,"reputation":2037,"user_id":7369238,"display_name":"ABHAY JOHRI"},"comment_count":0,"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1550584011,"creation_date":1550584011,"answer_id":54767775,"question_id":17169541,"body_markdown":"    package main.java;\r\n    \r\n    import java.io.IOException;\r\n    import java.nio.file.Files;\r\n    import java.nio.file.Path;\r\n    import java.nio.file.Paths;\r\n    import java.nio.file.StandardCopyOption;\r\n    \r\n    public class CopyFileOnExist {\r\n    \r\n    \tpublic static void main(String[] args)  {\r\n    \r\n    \t\tPath sourceDirectory = Paths.get(&quot;C:/Users/abc/Downloads/FileNotFoundExceptionExample/append.txt&quot;);\r\n            Path targetDirectory = Paths.get(&quot;C:/Users/abc/Downloads/FileNotFoundExceptionExample/append5.txt&quot;);\r\n    \r\n            //copy source to target using Files Class\r\n            try {\r\n    \t\t\tFiles.copy(sourceDirectory, targetDirectory,StandardCopyOption.REPLACE_EXISTING);\r\n    \t\t} catch (IOException e) {\r\n    \t\t\tSystem.out.println(e.toString());\r\n    \t\t}\r\n    \t}\r\n    \r\n    }\r\n\r\n","title":"Copy file in Java and replace existing target","body":"<pre><code>package main.java;\n\nimport java.io.IOException;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.nio.file.Paths;\nimport java.nio.file.StandardCopyOption;\n\npublic class CopyFileOnExist {\n\n    public static void main(String[] args)  {\n\n        Path sourceDirectory = Paths.get(\"C:/Users/abc/Downloads/FileNotFoundExceptionExample/append.txt\");\n        Path targetDirectory = Paths.get(\"C:/Users/abc/Downloads/FileNotFoundExceptionExample/append5.txt\");\n\n        //copy source to target using Files Class\n        try {\n            Files.copy(sourceDirectory, targetDirectory,StandardCopyOption.REPLACE_EXISTING);\n        } catch (IOException e) {\n            System.out.println(e.toString());\n        }\n    }\n\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":1,"creation_date":1684839327,"post_id":76313660,"comment_id":134572614,"body_markdown":"As it’s currently written, your answer is unclear. Please [edit] to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"As it’s currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/76313660/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":22194583,"reputation":1,"user_id":16436166,"display_name":"Ashish Gusian"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684837326,"creation_date":1684837261,"answer_id":76313660,"question_id":17169541,"body_markdown":"your statement Files.copy(path,Stringor address,StandardCopyOption) is this While you are giving a String where you have to set path of where you want to save file. \r\nSo simple Use this statement below:-\r\n\r\nFiles.copy(path,Paths.get(String or address),StandardCopyOption) by using Paths.get converts String into File location or path source path where you have to save file.","title":"Copy file in Java and replace existing target","body":"<p>your statement Files.copy(path,Stringor address,StandardCopyOption) is this While you are giving a String where you have to set path of where you want to save file.\nSo simple Use this statement below:-</p>\n<p>Files.copy(path,Paths.get(String or address),StandardCopyOption) by using Paths.get converts String into File location or path source path where you have to save file.</p>\n"}],"owner":{"account_id":399609,"reputation":691,"user_id":765075,"display_name":"commander_keen"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":101832,"favorite_count":0,"down_vote_count":2,"up_vote_count":54,"accepted_answer_id":17169700,"answer_count":5,"score":52,"last_activity_date":1684837326,"creation_date":1371560454,"question_id":17169541,"body_markdown":"I&#39;m trying to copy a file with java.nio.file.Files like this:\r\n\r\n    Files.copy(cfgFilePath, strTarget, StandardCopyOption.REPLACE_EXISTING);\r\n\r\nThe problem is that Eclipse says &quot;The method copy(Path, Path, CopyOption...) in the type Files is not applicable for the arguments (File, String, StandardCopyOption)&quot;\r\n\r\nI&#39;m using Eclipse and Java 7 on Win7 x64. My project is set up to use Java 1.6 compatibility.\r\n\r\nIs there a solution to this or do I have to create something like this as a workaround:\r\n\r\n    File temp = new File(target);\r\n \r\n    if(temp.exists())\r\n      temp.delete();\r\n\r\nThanks.","title":"Copy file in Java and replace existing target","body":"<p>I'm trying to copy a file with java.nio.file.Files like this:</p>\n\n<pre><code>Files.copy(cfgFilePath, strTarget, StandardCopyOption.REPLACE_EXISTING);\n</code></pre>\n\n<p>The problem is that Eclipse says \"The method copy(Path, Path, CopyOption...) in the type Files is not applicable for the arguments (File, String, StandardCopyOption)\"</p>\n\n<p>I'm using Eclipse and Java 7 on Win7 x64. My project is set up to use Java 1.6 compatibility.</p>\n\n<p>Is there a solution to this or do I have to create something like this as a workaround:</p>\n\n<pre><code>File temp = new File(target);\n\nif(temp.exists())\n  temp.delete();\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["java","spring","docker","kubernetes","minikube"],"comments":[{"owner":{"account_id":13863020,"reputation":137043,"user_id":10008173,"display_name":"David Maze"},"score":1,"creation_date":1684753096,"post_id":76301618,"comment_id":134557941,"body_markdown":"Can you `docker run` your image normally?  (As it is constructed, I&#39;d be surprised if `docker run ... bash` gave you an interactive shell.)  If the problem is specifically in Minikube, can you [edit] the question to include your Kubernetes Deployment YAML file?","body":"Can you <code>docker run</code> your image normally?  (As it is constructed, I&#39;d be surprised if <code>docker run ... bash</code> gave you an interactive shell.)  If the problem is specifically in Minikube, can you <a href=\"https://stackoverflow.com/posts/76301618/edit\">edit</a> the question to include your Kubernetes Deployment YAML file?"},{"owner":{"account_id":16149079,"reputation":493,"user_id":12898912,"display_name":"Maksym Rybalkin"},"score":0,"creation_date":1684771509,"post_id":76301618,"comment_id":134562049,"body_markdown":"@DavidMaze Just added my deployment config.\nI had a typo, I didn&#39;t use `bash` but used `docker run maxrybalkin91/revise-words-ws:1.0` and saw the app logs in console, which means that the `jar` was found in the image and was executed","body":"@DavidMaze Just added my deployment config. I had a typo, I didn&#39;t use <code>bash</code> but used <code>docker run maxrybalkin91&#47;revise-words-ws:1.0</code> and saw the app logs in console, which means that the <code>jar</code> was found in the image and was executed"},{"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"score":1,"creation_date":1684835885,"post_id":76301618,"comment_id":134571854,"body_markdown":"I just tried a `docker run maxrybalkin91/revise-words-ws:1.0`, and it seems the application starts up but complains about missing configuration. Have not tried the environment you specified. But: The title of the question states the jar is not found - and that is not true.\nWhat are we searching here?","body":"I just tried a <code>docker run maxrybalkin91&#47;revise-words-ws:1.0</code>, and it seems the application starts up but complains about missing configuration. Have not tried the environment you specified. But: The title of the question states the jar is not found - and that is not true. What are we searching here?"},{"owner":{"account_id":16149079,"reputation":493,"user_id":12898912,"display_name":"Maksym Rybalkin"},"score":0,"creation_date":1684838273,"post_id":76301618,"comment_id":134572381,"body_markdown":"@Queeg it doesn&#39;t find the configuration because it&#39;s taken from vault, which is run in my minikube","body":"@Queeg it doesn&#39;t find the configuration because it&#39;s taken from vault, which is run in my minikube"},{"owner":{"account_id":16149079,"reputation":493,"user_id":12898912,"display_name":"Maksym Rybalkin"},"score":1,"creation_date":1684838355,"post_id":76301618,"comment_id":134572400,"body_markdown":"@Queeg We&#39;re searching for a reason why the image is starting in docker, even with an error; but isn&#39;t starting in Kubernetes","body":"@Queeg We&#39;re searching for a reason why the image is starting in docker, even with an error; but isn&#39;t starting in Kubernetes"}],"answers":[{"comments":[{"owner":{"account_id":16149079,"reputation":493,"user_id":12898912,"display_name":"Maksym Rybalkin"},"score":0,"creation_date":1684787666,"post_id":76301979,"comment_id":134565276,"body_markdown":"I added `RUN ls ../app/` to my Dockerfile, and here is the build log\n```---&gt; Running in fc6abc20b853\nws.jar```","body":"I added <code>RUN ls ..&#47;app&#47;</code> to my Dockerfile, and here is the build log <code>---&gt; Running in fc6abc20b853 ws.jar</code>"}],"tags":[],"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"comment_count":1,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1684704206,"creation_date":1684704206,"answer_id":76301979,"question_id":76301618,"body_markdown":"As ENTRYPOINT you specify Java to run `./ws.jar`, assuming it would resolve from within work directory `/app`.\r\nAt runtime you get the error message that `/ws.jar` is not accessible, which looks like an absolute path.\r\n\r\nWhen running your container with /bin/bash, please check out where your jar file exists and which mode it has. Then decide who is right and who is broken: Your docker file or your error message. Fix the broken one.","title":"Kubernetes doesn&#39;t find a jar file","body":"<p>As ENTRYPOINT you specify Java to run <code>./ws.jar</code>, assuming it would resolve from within work directory <code>/app</code>.\nAt runtime you get the error message that <code>/ws.jar</code> is not accessible, which looks like an absolute path.</p>\n<p>When running your container with /bin/bash, please check out where your jar file exists and which mode it has. Then decide who is right and who is broken: Your docker file or your error message. Fix the broken one.</p>\n"},{"comments":[{"owner":{"account_id":16149079,"reputation":493,"user_id":12898912,"display_name":"Maksym Rybalkin"},"score":0,"creation_date":1684772143,"post_id":76307710,"comment_id":134562208,"body_markdown":"I&#39;ve tried that. Didn&#39;t help. Interesting thing that running docker image using `docker run` finds the jar and starts the app","body":"I&#39;ve tried that. Didn&#39;t help. Interesting thing that running docker image using <code>docker run</code> finds the jar and starts the app"},{"owner":{"account_id":16149079,"reputation":493,"user_id":12898912,"display_name":"Maksym Rybalkin"},"score":0,"creation_date":1684788026,"post_id":76307710,"comment_id":134565334,"body_markdown":"Just tried this `ENTRYPOINT java $JAVA_OPTS -jar ../app/ws.jar  $JAVA_ARGS`, ant it neither helped","body":"Just tried this <code>ENTRYPOINT java $JAVA_OPTS -jar ..&#47;app&#47;ws.jar  $JAVA_ARGS</code>, ant it neither helped"},{"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"score":1,"creation_date":1684822223,"post_id":76307710,"comment_id":134568813,"body_markdown":"Making `docker run ...` successful is the whole point. If you reached that, what else do you need?","body":"Making <code>docker run ...</code> successful is the whole point. If you reached that, what else do you need?"},{"owner":{"account_id":16149079,"reputation":493,"user_id":12898912,"display_name":"Maksym Rybalkin"},"score":0,"creation_date":1684825804,"post_id":76307710,"comment_id":134569496,"body_markdown":"It doesn&#39;t work in kubernetes, my pod fails with the main error","body":"It doesn&#39;t work in kubernetes, my pod fails with the main error"},{"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"score":1,"creation_date":1684836455,"post_id":76307710,"comment_id":134571978,"body_markdown":"So what is the &#39;main error&#39;? Maybe add that to your question. What I perceived is not related to missing jars.","body":"So what is the &#39;main error&#39;? Maybe add that to your question. What I perceived is not related to missing jars."}],"tags":[],"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"comment_count":5,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1684769074,"creation_date":1684769074,"answer_id":76307710,"question_id":76301618,"body_markdown":"If, as you say the jar file is in the right location (and I assume that is /app), how about using the absolute path for execution?\r\n\r\n    ENTRYPOINT java $JAVA_OPTS -jar $APP_HOME/ws.jar $JAVA_ARGS","title":"Kubernetes doesn&#39;t find a jar file","body":"<p>If, as you say the jar file is in the right location (and I assume that is /app), how about using the absolute path for execution?</p>\n<pre><code>ENTRYPOINT java $JAVA_OPTS -jar $APP_HOME/ws.jar $JAVA_ARGS\n</code></pre>\n"},{"comments":[{"owner":{"account_id":16149079,"reputation":493,"user_id":12898912,"display_name":"Maksym Rybalkin"},"score":0,"creation_date":1684838565,"post_id":76313634,"comment_id":134572447,"body_markdown":"It helped! Thanks a lot! Seems like it didn&#39;t use a new image, even it was rebuilt and pushed to my hub!","body":"It helped! Thanks a lot! Seems like it didn&#39;t use a new image, even it was rebuilt and pushed to my hub!"}],"tags":[],"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1684837058,"creation_date":1684837058,"answer_id":76313634,"question_id":76301618,"body_markdown":"As it seems a `docker run maxrybalkin91/revise-words-ws:1.0` brings up the application which complains about missing configuration data - but nowhere a jar file that is not found.\r\n\r\nSince in minikube you see a completely different error, is it possible you are running some outdated image?\r\n\r\nTry changing `imagePullPolilcy=Always` and see what you get.\r\n\r\nhttps://kubernetes.io/docs/concepts/containers/images/","title":"Kubernetes doesn&#39;t find a jar file","body":"<p>As it seems a <code>docker run maxrybalkin91/revise-words-ws:1.0</code> brings up the application which complains about missing configuration data - but nowhere a jar file that is not found.</p>\n<p>Since in minikube you see a completely different error, is it possible you are running some outdated image?</p>\n<p>Try changing <code>imagePullPolilcy=Always</code> and see what you get.</p>\n<p><a href=\"https://kubernetes.io/docs/concepts/containers/images/\" rel=\"nofollow noreferrer\">https://kubernetes.io/docs/concepts/containers/images/</a></p>\n"}],"owner":{"account_id":16149079,"reputation":493,"user_id":12898912,"display_name":"Maksym Rybalkin"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":407,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":76313634,"answer_count":3,"score":2,"last_activity_date":1684837058,"creation_date":1684697834,"question_id":76301618,"body_markdown":"I&#39;m using this `Dockerfile` configuration\r\n```\r\nFROM openjdk:17-alpine\r\n\r\nARG APP_HOME=/app\r\n\r\nWORKDIR $APP_HOME\r\n\r\nCOPY ./target/ws-exec.jar ws.jar\r\n\r\nENV JAVA_OPTS=&quot;-Dspring.profiles.active=prod -Dspring.application.name=words&quot;\r\n\r\nENTRYPOINT java $JAVA_OPTS -jar ./ws.jar $JAVA_ARGS\r\n```\r\n\r\nAfter deploying it to minikube, I see the only log:\r\n```Error: Unable to access jarfile /ws.jar```.\r\n\r\nI&#39;ve tried to run `docker run -it &lt;image&gt;` with my image&#39;s name, and it successfuly started with docker. Running `docker exec -it &lt;container&gt;` shew me that the `jar` is present in the right folder. I tried to make the jar executable adding a `CMD` or `RUN` layer into my `Dockerfile`, but nothing helped.\r\nWhere is my mistake, or what I don&#39;t understand?\r\n\r\nUPD here is my deployment.yaml\r\n```\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  labels:\r\n    app: revise-words-ws\r\n  name: revise-words-ws\r\n  namespace: default\r\nspec:\r\n  replicas: 1\r\n  minReadySeconds: 45\r\n  selector:\r\n    matchLabels:\r\n      app: revise-words-ws\r\n  strategy:\r\n    rollingUpdate:\r\n      maxSurge: 25%\r\n      maxUnavailable: 25%\r\n    type: RollingUpdate\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: revise-words-ws\r\n    spec:\r\n      containers:\r\n        - image: maxrybalkin91/revise-words-ws:1.0\r\n          imagePullPolicy: IfNotPresent\r\n          name: revise-words-ws\r\n          env:\r\n            - name: VAULT_TOKEN\r\n              valueFrom:\r\n                secretKeyRef:\r\n                  name: words\r\n                  key: vault_token\r\n            - name: VAULT_HOST\r\n              valueFrom:\r\n                secretKeyRef:\r\n                  name: words\r\n                  key: vault_host\r\n            - name: VAULT_PORT\r\n              valueFrom:\r\n                secretKeyRef:\r\n                  name: words\r\n                  key: vault_port\r\n          ports:\r\n            - name: liveness-port\r\n              containerPort: 8089\r\n          resources:\r\n            requests:\r\n              cpu: 100m\r\n              memory: 256Mi\r\n            limits:\r\n              cpu: 300m\r\n              memory: 512Mi\r\n          readinessProbe:\r\n            httpGet:\r\n              path: /\r\n              port: liveness-port\r\n            failureThreshold: 5\r\n            periodSeconds: 10\r\n            initialDelaySeconds: 60\r\n          livenessProbe:\r\n            httpGet:\r\n              path: /\r\n              port: liveness-port\r\n            failureThreshold: 5\r\n            periodSeconds: 10\r\n            initialDelaySeconds: 60\r\n            terminationGracePeriodSeconds: 30\r\n      restartPolicy: Always\r\n``` \r\n ","title":"Kubernetes doesn&#39;t find a jar file","body":"<p>I'm using this <code>Dockerfile</code> configuration</p>\n<pre><code>FROM openjdk:17-alpine\n\nARG APP_HOME=/app\n\nWORKDIR $APP_HOME\n\nCOPY ./target/ws-exec.jar ws.jar\n\nENV JAVA_OPTS=&quot;-Dspring.profiles.active=prod -Dspring.application.name=words&quot;\n\nENTRYPOINT java $JAVA_OPTS -jar ./ws.jar $JAVA_ARGS\n</code></pre>\n<p>After deploying it to minikube, I see the only log:\n<code>Error: Unable to access jarfile /ws.jar</code>.</p>\n<p>I've tried to run <code>docker run -it &lt;image&gt;</code> with my image's name, and it successfuly started with docker. Running <code>docker exec -it &lt;container&gt;</code> shew me that the <code>jar</code> is present in the right folder. I tried to make the jar executable adding a <code>CMD</code> or <code>RUN</code> layer into my <code>Dockerfile</code>, but nothing helped.\nWhere is my mistake, or what I don't understand?</p>\n<p>UPD here is my deployment.yaml</p>\n<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: revise-words-ws\n  name: revise-words-ws\n  namespace: default\nspec:\n  replicas: 1\n  minReadySeconds: 45\n  selector:\n    matchLabels:\n      app: revise-words-ws\n  strategy:\n    rollingUpdate:\n      maxSurge: 25%\n      maxUnavailable: 25%\n    type: RollingUpdate\n  template:\n    metadata:\n      labels:\n        app: revise-words-ws\n    spec:\n      containers:\n        - image: maxrybalkin91/revise-words-ws:1.0\n          imagePullPolicy: IfNotPresent\n          name: revise-words-ws\n          env:\n            - name: VAULT_TOKEN\n              valueFrom:\n                secretKeyRef:\n                  name: words\n                  key: vault_token\n            - name: VAULT_HOST\n              valueFrom:\n                secretKeyRef:\n                  name: words\n                  key: vault_host\n            - name: VAULT_PORT\n              valueFrom:\n                secretKeyRef:\n                  name: words\n                  key: vault_port\n          ports:\n            - name: liveness-port\n              containerPort: 8089\n          resources:\n            requests:\n              cpu: 100m\n              memory: 256Mi\n            limits:\n              cpu: 300m\n              memory: 512Mi\n          readinessProbe:\n            httpGet:\n              path: /\n              port: liveness-port\n            failureThreshold: 5\n            periodSeconds: 10\n            initialDelaySeconds: 60\n          livenessProbe:\n            httpGet:\n              path: /\n              port: liveness-port\n            failureThreshold: 5\n            periodSeconds: 10\n            initialDelaySeconds: 60\n            terminationGracePeriodSeconds: 30\n      restartPolicy: Always\n</code></pre>\n"},{"tags":["java","spring-boot","apache-spark","etl"],"comments":[{"owner":{"account_id":93689,"reputation":415951,"user_id":256196,"accept_rate":77,"display_name":"Bohemian"},"score":1,"creation_date":1684836946,"post_id":76313391,"comment_id":134572107,"body_markdown":"`&lt;exclusion&gt;&lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;&lt;artifactId&gt;jersey-server&lt;/artifactId&gt;&lt;/exclusion&gt;` might have something to do with not loading the class `org.glassfish.jersey.server.spi.Container`","body":"<code>&lt;exclusion&gt;&lt;groupId&gt;org.glassfish.jersey.core&lt;&#47;groupId&gt;&lt;arti&zwnj;&#8203;factId&gt;jersey-server&zwnj;&#8203;&lt;&#47;artifactId&gt;&lt;&#47;exclu&zwnj;&#8203;sion&gt;</code> might have something to do with not loading the class <code>org.glassfish.jersey.server.spi.Container</code>"},{"owner":{"account_id":25926402,"reputation":55,"user_id":19648218,"display_name":"Kiolimandars"},"score":0,"creation_date":1684837182,"post_id":76313391,"comment_id":134572161,"body_markdown":"@Bohemian I tried omitting that exclusion but I still get the same error.","body":"@Bohemian I tried omitting that exclusion but I still get the same error."},{"owner":{"account_id":93689,"reputation":415951,"user_id":256196,"accept_rate":77,"display_name":"Bohemian"},"score":1,"creation_date":1684859010,"post_id":76313391,"comment_id":134577644,"body_markdown":"Did you remove the `jersey-server` exclusion? The class `org.glassfish.jersey.server.spi.Container` is in the `org.glassfish.jersey.core` jar: Perhaps you should add that as a dependency too.","body":"Did you remove the <code>jersey-server</code> exclusion? The class <code>org.glassfish.jersey.server.spi.Container</code> is in the <code>org.glassfish.jersey.core</code> jar: Perhaps you should add that as a dependency too."}],"owner":{"account_id":25926402,"reputation":55,"user_id":19648218,"display_name":"Kiolimandars"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":42,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684836782,"creation_date":1684835252,"question_id":76313391,"body_markdown":"I am trying to read a CSV file from a database using apache spark and then print each line in the console (just to test). The csv file in encoded to utf8 when I upload it to the database then decoded when I try print it. I am getting the following error: \r\n\r\n\r\n```\r\njava.lang.NoClassDefFoundError: org/glassfish/jersey/server/spi/Container\r\n\tat org.apache.spark.status.api.v1.ApiRootResource$.getServletHandler(ApiRootResource.scala:63) ~[spark-core_2.12-2.4.8.jar:2.4.8]\r\n\tat org.apache.spark.ui.SparkUI.initialize(SparkUI.scala:70) ~[spark-core_2.12-2.4.8.jar:2.4.8]\r\n\tat org.apache.spark.ui.SparkUI.&lt;init&gt;(SparkUI.scala:80) ~[spark-core_2.12-2.4.8.jar:2.4.8]\r\n\tat org.apache.spark.ui.SparkUI$.create(SparkUI.scala:178) ~[spark-core_2.12-2.4.8.jar:2.4.8]\r\n\tat org.apache.spark.SparkContext.&lt;init&gt;(SparkContext.scala:444) ~[spark-core_2.12-2.4.8.jar:2.4.8]\r\n\tat org.apache.spark.SparkContext$.getOrCreate(SparkContext.scala:2526) ~[spark-core_2.12-2.4.8.jar:2.4.8]\r\n\tat org.apache.spark.sql.SparkSession$Builder.$anonfun$getOrCreate$1(SparkSession.scala:930) ~[spark-sql_2.12-2.4.8.jar:2.4.8]\r\n\tat scala.Option.getOrElse(Option.scala:189) ~[scala-library-2.12.10.jar:na]\r\n\tat org.apache.spark.sql.SparkSession$Builder.getOrCreate(SparkSession.scala:921) ~[spark-sql_2.12-2.4.8.jar:2.4.8]\r\n\tat com.example.dbtest.model.Job$1.run(Job.java:90) ~[classes/:na]\r\n\tat com.example.dbtest.components.JobScheduler.lambda$updateJobList$0(JobScheduler.java:49) ~[classes/:na]\r\n\tat org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54) ~[spring-context-6.0.7.jar:6.0.7]\r\n\tat org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:96) ~[spring-context-6.0.7.jar:6.0.7]\r\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]\r\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]\r\n\tat java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[na:na]\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]\r\n\tat java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]\r\nCaused by: java.lang.ClassNotFoundException: org.glassfish.jersey.server.spi.Container\r\n```\r\n\r\n\r\nThis is the code I am trying to execute: \r\n\r\n```\r\nSparkConf sparkConf = new SparkConf()\r\n    .setAppName(&quot;dbtest&quot;)\r\n    .setMaster(&quot;local[*]&quot;); // Set the master URL for local testing\r\n\r\n// Create a SparkSession using the SparkConf object\r\nSparkSession spark = SparkSession.builder()\r\n    .config(sparkConf)\r\n    .getOrCreate();\r\n\r\nString jdbcUrl = &quot;jdbc:postgresql://localhost:5432/mydatabase&quot;;\r\nString username = &quot;postgres&quot;;\r\n\r\n// Read the file data from the database table, selecting the &quot;body&quot; column\r\nDataset&lt;Row&gt; pdfData = spark.read()\r\n    .format(&quot;jdbc&quot;)\r\n    .option(&quot;url&quot;, jdbcUrl)\r\n    .option(&quot;dbtable&quot;, &quot;configurations&quot;)\r\n    .option(&quot;user&quot;, username)\r\n    .load()\r\n    .select(&quot;body&quot;);\r\n\r\n// Convert the fileData DataFrame to an RDD of Strings\r\nDataset&lt;String&gt; pdfContent = pdfData\r\n    .withColumn(&quot;body&quot;, functions.col(&quot;body&quot;)\r\n    .cast(&quot;string&quot;))\r\n    .select(&quot;body&quot;)\r\n    .as(Encoders.STRING());\r\n// Perform further processing or analysis on the fileLinesRDD\r\nSystem.out.println(pdfContent);\r\n```\r\n\r\nAnd this is my pom.xml file:\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n\txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\t&lt;parent&gt;\r\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;3.0.5&lt;/version&gt;\r\n\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n\t&lt;/parent&gt;\r\n\t&lt;groupId&gt;com.example&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;dbtest&lt;/artifactId&gt;\r\n\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n\t&lt;name&gt;dbtest&lt;/name&gt;\r\n\t&lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\r\n\t&lt;properties&gt;\r\n\t\t&lt;java.version&gt;1.8&lt;/java.version&gt;\r\n\t&lt;/properties&gt;\r\n\t&lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;!--&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;javax.annotation&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;javax.annotation-api&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;1.3.2&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;--&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\r\n\t\t\t&lt;exclusions&gt;\r\n\t\t\t\t&lt;exclusion&gt;\r\n\t\t\t\t\t&lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;\r\n\t\t\t\t\t&lt;artifactId&gt;jersey-client&lt;/artifactId&gt;\r\n\t\t\t\t&lt;/exclusion&gt;\r\n\t\t\t\t&lt;!-- Add more exclusions if needed --&gt;\r\n\t\t\t&lt;/exclusions&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.apache.spark&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spark-core_2.12&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.4.8&lt;/version&gt;\r\n\t\t\t&lt;exclusions&gt;\r\n\t\t\t\t&lt;exclusion&gt;\r\n\t\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t\t&lt;artifactId&gt;spring-boot-starter-jersey&lt;/artifactId&gt;\r\n\t\t\t\t&lt;/exclusion&gt;\r\n\t\t\t\t&lt;exclusion&gt;\r\n\t\t\t\t\t&lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;\r\n\t\t\t\t\t&lt;artifactId&gt;jersey-server&lt;/artifactId&gt;\r\n\t\t\t\t&lt;/exclusion&gt;\r\n\t\t\t\t&lt;exclusion&gt;\r\n\t\t\t\t\t&lt;groupId&gt;org.slf4j&lt;/groupId&gt;\r\n\t\t\t\t\t&lt;artifactId&gt;slf4j-reload4j&lt;/artifactId&gt;\r\n\t\t\t\t&lt;/exclusion&gt;\r\n\t\t\t\t&lt;exclusion&gt;\r\n\t\t\t\t\t&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;\r\n\t\t\t\t\t&lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;\r\n\t\t\t\t&lt;/exclusion&gt;\r\n\t\t\t\t&lt;exclusion&gt;\r\n\t\t\t\t\t&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;\r\n\t\t\t\t\t&lt;artifactId&gt;hadoop-yarn-client&lt;/artifactId&gt;\r\n\t\t\t\t&lt;/exclusion&gt;\r\n\r\n\r\n\r\n\t\t\t&lt;/exclusions&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;javax.ws.rs&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;javax.ws.rs-api&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.1&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;3.3.3&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;hadoop-yarn-client&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;3.3.3&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.apache.spark&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spark-sql_2.12&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.4.8&lt;/version&gt;\r\n\t\t\t&lt;exclusions&gt;\r\n\t\t\t\t&lt;exclusion&gt;\r\n\t\t\t\t\t&lt;groupId&gt;org.slf4j&lt;/groupId&gt;\r\n\t\t\t\t\t&lt;artifactId&gt;slf4j-reload4j&lt;/artifactId&gt;\r\n\t\t\t\t&lt;/exclusion&gt;\r\n\t\t\t&lt;/exclusions&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;7.0.2.Final&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.apache.spark&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spark-streaming_2.12&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.4.8&lt;/version&gt;\r\n\t\t\t&lt;exclusions&gt;\r\n\t\t\t\t&lt;exclusion&gt;\r\n\t\t\t\t\t&lt;groupId&gt;org.slf4j&lt;/groupId&gt;\r\n\t\t\t\t\t&lt;artifactId&gt;slf4j-reload4j&lt;/artifactId&gt;\r\n\t\t\t\t&lt;/exclusion&gt;\r\n\t\t\t&lt;/exclusions&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.postgresql&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;postgresql&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.slf4j&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;1.7.32&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;pdfbox&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.0.26&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;logback-classic&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;1.2.6&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t&lt;/dependencies&gt;\r\n\r\n\r\n\t&lt;build&gt;\r\n\t\t&lt;plugins&gt;\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\t\t&lt;/plugins&gt;\r\n\t&lt;/build&gt;\r\n\r\n&lt;/project&gt;\r\n\r\n```\r\n\r\n","title":"How to solve a glassfish error when trying to use apache Spark with Springboot","body":"<p>I am trying to read a CSV file from a database using apache spark and then print each line in the console (just to test). The csv file in encoded to utf8 when I upload it to the database then decoded when I try print it. I am getting the following error:</p>\n<pre><code>java.lang.NoClassDefFoundError: org/glassfish/jersey/server/spi/Container\n    at org.apache.spark.status.api.v1.ApiRootResource$.getServletHandler(ApiRootResource.scala:63) ~[spark-core_2.12-2.4.8.jar:2.4.8]\n    at org.apache.spark.ui.SparkUI.initialize(SparkUI.scala:70) ~[spark-core_2.12-2.4.8.jar:2.4.8]\n    at org.apache.spark.ui.SparkUI.&lt;init&gt;(SparkUI.scala:80) ~[spark-core_2.12-2.4.8.jar:2.4.8]\n    at org.apache.spark.ui.SparkUI$.create(SparkUI.scala:178) ~[spark-core_2.12-2.4.8.jar:2.4.8]\n    at org.apache.spark.SparkContext.&lt;init&gt;(SparkContext.scala:444) ~[spark-core_2.12-2.4.8.jar:2.4.8]\n    at org.apache.spark.SparkContext$.getOrCreate(SparkContext.scala:2526) ~[spark-core_2.12-2.4.8.jar:2.4.8]\n    at org.apache.spark.sql.SparkSession$Builder.$anonfun$getOrCreate$1(SparkSession.scala:930) ~[spark-sql_2.12-2.4.8.jar:2.4.8]\n    at scala.Option.getOrElse(Option.scala:189) ~[scala-library-2.12.10.jar:na]\n    at org.apache.spark.sql.SparkSession$Builder.getOrCreate(SparkSession.scala:921) ~[spark-sql_2.12-2.4.8.jar:2.4.8]\n    at com.example.dbtest.model.Job$1.run(Job.java:90) ~[classes/:na]\n    at com.example.dbtest.components.JobScheduler.lambda$updateJobList$0(JobScheduler.java:49) ~[classes/:na]\n    at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54) ~[spring-context-6.0.7.jar:6.0.7]\n    at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:96) ~[spring-context-6.0.7.jar:6.0.7]\n    at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:577) ~[na:na]\n    at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]\n    at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[na:na]\n    at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]\n    at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]\n    at java.base/java.lang.Thread.run(Thread.java:1589) ~[na:na]\nCaused by: java.lang.ClassNotFoundException: org.glassfish.jersey.server.spi.Container\n</code></pre>\n<p>This is the code I am trying to execute:</p>\n<pre><code>SparkConf sparkConf = new SparkConf()\n    .setAppName(&quot;dbtest&quot;)\n    .setMaster(&quot;local[*]&quot;); // Set the master URL for local testing\n\n// Create a SparkSession using the SparkConf object\nSparkSession spark = SparkSession.builder()\n    .config(sparkConf)\n    .getOrCreate();\n\nString jdbcUrl = &quot;jdbc:postgresql://localhost:5432/mydatabase&quot;;\nString username = &quot;postgres&quot;;\n\n// Read the file data from the database table, selecting the &quot;body&quot; column\nDataset&lt;Row&gt; pdfData = spark.read()\n    .format(&quot;jdbc&quot;)\n    .option(&quot;url&quot;, jdbcUrl)\n    .option(&quot;dbtable&quot;, &quot;configurations&quot;)\n    .option(&quot;user&quot;, username)\n    .load()\n    .select(&quot;body&quot;);\n\n// Convert the fileData DataFrame to an RDD of Strings\nDataset&lt;String&gt; pdfContent = pdfData\n    .withColumn(&quot;body&quot;, functions.col(&quot;body&quot;)\n    .cast(&quot;string&quot;))\n    .select(&quot;body&quot;)\n    .as(Encoders.STRING());\n// Perform further processing or analysis on the fileLinesRDD\nSystem.out.println(pdfContent);\n</code></pre>\n<p>And this is my pom.xml file:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.0.5&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;dbtest&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;dbtest&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;1.8&lt;/java.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;!--&lt;dependency&gt;\n            &lt;groupId&gt;javax.annotation&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.annotation-api&lt;/artifactId&gt;\n            &lt;version&gt;1.3.2&lt;/version&gt;\n        &lt;/dependency&gt;--&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;\n                    &lt;artifactId&gt;jersey-client&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;!-- Add more exclusions if needed --&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;\n            &lt;artifactId&gt;spark-core_2.12&lt;/artifactId&gt;\n            &lt;version&gt;2.4.8&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                    &lt;artifactId&gt;spring-boot-starter-jersey&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;\n                    &lt;artifactId&gt;jersey-server&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n                    &lt;artifactId&gt;slf4j-reload4j&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;\n                    &lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;\n                    &lt;artifactId&gt;hadoop-yarn-client&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n\n\n\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.ws.rs&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.ws.rs-api&lt;/artifactId&gt;\n            &lt;version&gt;2.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;\n            &lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;\n            &lt;version&gt;3.3.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;\n            &lt;artifactId&gt;hadoop-yarn-client&lt;/artifactId&gt;\n            &lt;version&gt;3.3.3&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;\n            &lt;artifactId&gt;spark-sql_2.12&lt;/artifactId&gt;\n            &lt;version&gt;2.4.8&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n                    &lt;artifactId&gt;slf4j-reload4j&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\n            &lt;version&gt;7.0.2.Final&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;\n            &lt;artifactId&gt;spark-streaming_2.12&lt;/artifactId&gt;\n            &lt;version&gt;2.4.8&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n                    &lt;artifactId&gt;slf4j-reload4j&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\n            &lt;version&gt;1.7.32&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt;\n            &lt;artifactId&gt;pdfbox&lt;/artifactId&gt;\n            &lt;version&gt;2.0.26&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;\n            &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;\n            &lt;version&gt;1.2.6&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n\n</code></pre>\n"},{"tags":["java","maven","bots","discord-jda"],"comments":[{"owner":{"account_id":14719989,"reputation":5877,"user_id":10630900,"display_name":"Minn"},"score":0,"creation_date":1684791942,"post_id":76308638,"comment_id":134565946,"body_markdown":"You have to update JDA.","body":"You have to update JDA."},{"owner":{"account_id":27521195,"reputation":15,"user_id":21931651,"display_name":"Николай"},"score":0,"creation_date":1684830132,"post_id":76308638,"comment_id":134570470,"body_markdown":"Thank you. It helped, but apparently there is another problem in the code. I have edited the question.","body":"Thank you. It helped, but apparently there is another problem in the code. I have edited the question."}],"answers":[{"tags":[],"owner":{"account_id":27521195,"reputation":15,"user_id":21931651,"display_name":"Николай"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1684836742,"creation_date":1684836742,"answer_id":76313606,"question_id":76308638,"body_markdown":"After I upgraded to the latest version of JDA, the problem was due to incorrect program logic. Remove the else block in the question code:\r\n\r\nInstead of:\r\n```\r\n    public void queue(AudioTrack track) {\r\n        if(!player.startTrack(track, true)) {\r\n            System.out.println(&quot;1&quot;);\r\n            queue.offer(track);\r\n            System.out.println(&quot;2&quot;);\r\n        } else {\r\n            System.out.println(&quot;3&quot;);\r\n            StackTraceElement[] stackTraceElements = Thread.currentThread().getStackTrace();\r\n            for (StackTraceElement element:stackTraceElements) {\r\n                System.out.println(element.getMethodName());\r\n            }\r\n            player.startTrack(track, false);\r\n            System.out.println(&quot;4&quot;);\r\n        }\r\n    }\r\n```\r\nThis:\r\n```\r\n    public void queue(AudioTrack track) {\r\n        if(!player.startTrack(track, true)) {\r\n            queue.offer(track);\r\n        }\r\n    }\r\n```","title":"What could be causing my Java Discord bot using Lavaplayer and Maven to not play music?","body":"<p>After I upgraded to the latest version of JDA, the problem was due to incorrect program logic. Remove the else block in the question code:</p>\n<p>Instead of:</p>\n<pre><code>    public void queue(AudioTrack track) {\n        if(!player.startTrack(track, true)) {\n            System.out.println(&quot;1&quot;);\n            queue.offer(track);\n            System.out.println(&quot;2&quot;);\n        } else {\n            System.out.println(&quot;3&quot;);\n            StackTraceElement[] stackTraceElements = Thread.currentThread().getStackTrace();\n            for (StackTraceElement element:stackTraceElements) {\n                System.out.println(element.getMethodName());\n            }\n            player.startTrack(track, false);\n            System.out.println(&quot;4&quot;);\n        }\n    }\n</code></pre>\n<p>This:</p>\n<pre><code>    public void queue(AudioTrack track) {\n        if(!player.startTrack(track, true)) {\n            queue.offer(track);\n        }\n    }\n</code></pre>\n"}],"owner":{"account_id":27521195,"reputation":15,"user_id":21931651,"display_name":"Николай"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":216,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76313606,"answer_count":1,"score":0,"last_activity_date":1684836742,"creation_date":1684776598,"question_id":76308638,"body_markdown":"I am writing a music bot for discord. The program successfully finds and downloads music, but does not play it. No code works, even completely copied from a manual, whose author has similar versions, and his code performs its function. Further study of the problem led to the fact that the program hangs on the line (after stacktrace):\r\n`\r\nplayer.startTrack(track, false);\r\n`\r\nHanging also happens if you replace the line above with:\r\n`\r\nplayer.playTrack(track);\r\n`\r\n\r\nI found information published a few years ago that some platforms restricted access to downloads from them for bots. The guide I tested the code for was released in February of this year. I think the problem is on my side.\r\n\r\nAlso, when using /play, I tried to enter links to different platforms and tracks on them, but nothing helps.\r\nMaybe i should specify some intentions in the code?\r\n\r\nCode:\r\n\r\n - Main\r\n\r\n```\r\npublic static void main(String[] args) throws Exception {\r\n        JDA jda = JDABuilder.createDefault(TOKEN).setChunkingFilter(ChunkingFilter.ALL)\r\n                .setMemberCachePolicy(MemberCachePolicy.ALL).enableIntents(GatewayIntent.GUILD_MEMBERS,\r\n                        GatewayIntent.GUILD_MESSAGES,\r\n                        GatewayIntent.GUILD_VOICE_STATES).build();\r\n        jda.addEventListener(new checker()); \r\n    }  \r\n```\r\n - AudioSendHandler\r\n ```\r\npublic class AudioForwarder implements AudioSendHandler {\r\n\r\n    private final AudioPlayer player;\r\n    private final Guild guild;\r\n    private final ByteBuffer buffer = ByteBuffer.allocate(1024);\r\n    private final MutableAudioFrame frame = new MutableAudioFrame();\r\n    private int time;\r\n\r\n    public AudioForwarder(AudioPlayer player, Guild guild) {\r\n        this.player = player;\r\n        this.guild = guild;\r\n        frame.setBuffer(buffer);\r\n    }\r\n\r\n    @Override\r\n    public boolean canProvide() {\r\n        boolean canProvide = player.provide(frame);\r\n        if(!canProvide) {\r\n            time += 20;\r\n            if (time &gt;= 300000) {\r\n                time = 0;\r\n                System.out.println(&quot;timeout&quot;);\r\n                guild.getAudioManager().closeAudioConnection();\r\n            }\r\n        } else {\r\n            time = 0;\r\n        }\r\n        return canProvide;\r\n    }\r\n\r\n    @Nullable\r\n    @Override\r\n    public ByteBuffer provide20MsAudio() {\r\n        final Buffer tmp = ((Buffer) buffer).flip();\r\n\r\n        return (ByteBuffer) tmp;\r\n    }\r\n\r\n    @Override\r\n    public boolean isOpus() {\r\n        return true;\r\n    }\r\n}\r\n```\r\n - TrackScheduler\r\n```\r\npublic class TrackScheduler extends AudioEventAdapter {\r\n\r\n    private final AudioPlayer player;\r\n    private final BlockingQueue&lt;AudioTrack&gt; queue = new LinkedBlockingQueue&lt;&gt;();\r\n    private boolean isRepeat = false;\r\n\r\n    public TrackScheduler(AudioPlayer player) {\r\n        this.player = player;\r\n    }\r\n\r\n    @Override\r\n    public void onTrackEnd(AudioPlayer player, AudioTrack track, AudioTrackEndReason endReason) {\r\n        if(isRepeat) {\r\n            System.out.println(&quot;6&quot;);\r\n            player.startTrack(track.makeClone(), false);\r\n            System.out.println(&quot;7&quot;);\r\n        } else {\r\n            System.out.println(&quot;8&quot;);\r\n            player.startTrack(queue.poll(), false);\r\n            System.out.println(&quot;9&quot;);\r\n        }\r\n    }\r\n\r\n    public void queue(AudioTrack track) {\r\n        if(!player.startTrack(track, true)) {\r\n            System.out.println(&quot;1&quot;);\r\n            queue.offer(track);\r\n            System.out.println(&quot;2&quot;);\r\n        } else {\r\n            System.out.println(&quot;3&quot;);\r\n            StackTraceElement[] stackTraceElements = Thread.currentThread().getStackTrace();\r\n            for (StackTraceElement element:stackTraceElements) {\r\n                System.out.println(element.getMethodName());\r\n            }\r\n            player.startTrack(track, false);\r\n            System.out.println(&quot;4&quot;);\r\n        }\r\n    }\r\n\r\n    public AudioPlayer getPlayer() {\r\n        return player;\r\n    }\r\n\r\n    public BlockingQueue&lt;AudioTrack&gt; getQueue() {\r\n        return queue;\r\n    }\r\n\r\n    public boolean isRepeat() {\r\n        return isRepeat;\r\n    }\r\n\r\n    public void setRepeat(boolean repeat) {\r\n        isRepeat = repeat;\r\n    }\r\n}\r\n```\r\n - GuildMusicManager\r\n```\r\npublic class GuildMusicManager {\r\n\r\n    private TrackScheduler trackScheduler;\r\n    private AudioForwarder audioForwarder;\r\n\r\n    public GuildMusicManager(AudioPlayerManager manager, Guild guild) {\r\n        AudioPlayer player = manager.createPlayer();\r\n        trackScheduler = new TrackScheduler(player);\r\n        player.addListener(trackScheduler);\r\n        audioForwarder = new AudioForwarder(player, guild);\r\n    }\r\n\r\n    public TrackScheduler getTrackScheduler() {\r\n        return trackScheduler;\r\n    }\r\n\r\n    public AudioForwarder getAudioForwarder() {\r\n        return audioForwarder;\r\n    }\r\n}\r\n```\r\n - PlayerManager\r\n```\r\npublic class PlayerManager {\r\n\r\n    private static PlayerManager INSTANCE;\r\n    private final Map&lt;Long, GuildMusicManager&gt; guildMusicManagers = new HashMap&lt;&gt;();\r\n    private final AudioPlayerManager audioPlayerManager = new DefaultAudioPlayerManager();\r\n\r\n    private PlayerManager() {\r\n        AudioSourceManagers.registerRemoteSources(audioPlayerManager);\r\n        AudioSourceManagers.registerLocalSource(audioPlayerManager);\r\n    }\r\n\r\n    public static PlayerManager get() {\r\n        if(INSTANCE == null) {\r\n            INSTANCE = new PlayerManager();\r\n        }\r\n        return INSTANCE;\r\n    }\r\n\r\n    public GuildMusicManager getGuildMusicManager(Guild guild) {\r\n        return guildMusicManagers.computeIfAbsent(guild.getIdLong(), (guildId) -&gt; {\r\n            GuildMusicManager musicManager = new GuildMusicManager(audioPlayerManager, guild);\r\n\r\n            guild.getAudioManager().setSendingHandler(musicManager.getAudioForwarder());\r\n\r\n            return musicManager;\r\n        });\r\n    }\r\n\r\n    public void play(Guild guild, String trackURL) {\r\n        GuildMusicManager guildMusicManager = getGuildMusicManager(guild);\r\n        audioPlayerManager.loadItemOrdered(guildMusicManager, trackURL, new AudioLoadResultHandler() {\r\n            @Override\r\n            public void trackLoaded(AudioTrack track) {\r\n                System.out.println(&quot;0&quot;);\r\n                guildMusicManager.getTrackScheduler().queue(track);\r\n                System.out.println(&quot;5&quot;);\r\n            }\r\n\r\n            @Override\r\n            public void playlistLoaded(AudioPlaylist playlist) {\r\n                System.out.println(&quot;0.1&quot;);\r\n                guildMusicManager.getTrackScheduler().queue(playlist.getTracks().get(0));\r\n                System.out.println(&quot;5.1&quot;);\r\n            }\r\n\r\n            @Override\r\n            public void noMatches() {\r\n                System.out.println(&quot;no_matches&quot;);\r\n            }\r\n\r\n            @Override\r\n            public void loadFailed(FriendlyException exception) {\r\n                System.out.println(&quot;failed&quot;);\r\n            }\r\n        });\r\n    }\r\n}\r\n```\r\n - /play\r\n```\r\npublic void onSlashCommandInteraction(@NotNull SlashCommandInteractionEvent event) {\r\n     if (event.getName().equals(&quot;play&quot;)) {\r\n                event.getGuild().getAudioManager().openAudioConnection(event.getMember().getVoiceState().getChannel());\r\n\r\n                String name = event.getOption(&quot;name&quot;).getAsString();\r\n                try {\r\n                    new URI(name);\r\n                } catch (URISyntaxException e) {\r\n                    name = name + &quot;ytsearch:&quot;;\r\n                }\r\n                PlayerManager playerManager = PlayerManager.get();\r\n                event.reply(&quot;Playing&quot;).setEphemeral(true).submit();\r\n                playerManager.play(event.getGuild(), name);\r\n        }\r\n}\r\n```\r\n\r\n[Console output][1]\r\n\r\nAfter using /play, the bot successfully connects to the voice channel, but immediately starts reconnecting to it every few seconds without playing music.\r\n\r\nOn the discord developer portal, all intents are enabled, on the test server the bot has administrator rights, the role of the bot is prioritized above all others.\r\n\r\nMy versions:\r\n\r\nJDA 5.0.0-alpha.11\r\n\r\nlavaplayer 1.3.77\r\n\r\nP.S. updated: \r\nMoved to version of JDA 5.0.0-beta.9. The hanging is gone, but the program still doesn&#39;t play sound, and this time I don&#39;t understand what&#39;s going on there. Updated code above and screenshot of console output.\r\n\r\nIf you move the stacktrace to the place where the code reaches during /play:\r\n\r\n[Console output 2][2]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/S5AkP.png\r\n  [2]: https://i.stack.imgur.com/8RG81.png","title":"What could be causing my Java Discord bot using Lavaplayer and Maven to not play music?","body":"<p>I am writing a music bot for discord. The program successfully finds and downloads music, but does not play it. No code works, even completely copied from a manual, whose author has similar versions, and his code performs its function. Further study of the problem led to the fact that the program hangs on the line (after stacktrace):\n<code>player.startTrack(track, false);</code>\nHanging also happens if you replace the line above with:\n<code>player.playTrack(track);</code></p>\n<p>I found information published a few years ago that some platforms restricted access to downloads from them for bots. The guide I tested the code for was released in February of this year. I think the problem is on my side.</p>\n<p>Also, when using /play, I tried to enter links to different platforms and tracks on them, but nothing helps.\nMaybe i should specify some intentions in the code?</p>\n<p>Code:</p>\n<ul>\n<li>Main</li>\n</ul>\n<pre><code>public static void main(String[] args) throws Exception {\n        JDA jda = JDABuilder.createDefault(TOKEN).setChunkingFilter(ChunkingFilter.ALL)\n                .setMemberCachePolicy(MemberCachePolicy.ALL).enableIntents(GatewayIntent.GUILD_MEMBERS,\n                        GatewayIntent.GUILD_MESSAGES,\n                        GatewayIntent.GUILD_VOICE_STATES).build();\n        jda.addEventListener(new checker()); \n    }  \n</code></pre>\n<ul>\n<li>AudioSendHandler</li>\n</ul>\n<pre><code>public class AudioForwarder implements AudioSendHandler {\n\n   private final AudioPlayer player;\n   private final Guild guild;\n   private final ByteBuffer buffer = ByteBuffer.allocate(1024);\n   private final MutableAudioFrame frame = new MutableAudioFrame();\n   private int time;\n\n   public AudioForwarder(AudioPlayer player, Guild guild) {\n       this.player = player;\n       this.guild = guild;\n       frame.setBuffer(buffer);\n   }\n\n   @Override\n   public boolean canProvide() {\n       boolean canProvide = player.provide(frame);\n       if(!canProvide) {\n           time += 20;\n           if (time &gt;= 300000) {\n               time = 0;\n               System.out.println(&quot;timeout&quot;);\n               guild.getAudioManager().closeAudioConnection();\n           }\n       } else {\n           time = 0;\n       }\n       return canProvide;\n   }\n\n   @Nullable\n   @Override\n   public ByteBuffer provide20MsAudio() {\n       final Buffer tmp = ((Buffer) buffer).flip();\n\n       return (ByteBuffer) tmp;\n   }\n\n   @Override\n   public boolean isOpus() {\n       return true;\n   }\n}\n</code></pre>\n<ul>\n<li>TrackScheduler</li>\n</ul>\n<pre><code>public class TrackScheduler extends AudioEventAdapter {\n\n    private final AudioPlayer player;\n    private final BlockingQueue&lt;AudioTrack&gt; queue = new LinkedBlockingQueue&lt;&gt;();\n    private boolean isRepeat = false;\n\n    public TrackScheduler(AudioPlayer player) {\n        this.player = player;\n    }\n\n    @Override\n    public void onTrackEnd(AudioPlayer player, AudioTrack track, AudioTrackEndReason endReason) {\n        if(isRepeat) {\n            System.out.println(&quot;6&quot;);\n            player.startTrack(track.makeClone(), false);\n            System.out.println(&quot;7&quot;);\n        } else {\n            System.out.println(&quot;8&quot;);\n            player.startTrack(queue.poll(), false);\n            System.out.println(&quot;9&quot;);\n        }\n    }\n\n    public void queue(AudioTrack track) {\n        if(!player.startTrack(track, true)) {\n            System.out.println(&quot;1&quot;);\n            queue.offer(track);\n            System.out.println(&quot;2&quot;);\n        } else {\n            System.out.println(&quot;3&quot;);\n            StackTraceElement[] stackTraceElements = Thread.currentThread().getStackTrace();\n            for (StackTraceElement element:stackTraceElements) {\n                System.out.println(element.getMethodName());\n            }\n            player.startTrack(track, false);\n            System.out.println(&quot;4&quot;);\n        }\n    }\n\n    public AudioPlayer getPlayer() {\n        return player;\n    }\n\n    public BlockingQueue&lt;AudioTrack&gt; getQueue() {\n        return queue;\n    }\n\n    public boolean isRepeat() {\n        return isRepeat;\n    }\n\n    public void setRepeat(boolean repeat) {\n        isRepeat = repeat;\n    }\n}\n</code></pre>\n<ul>\n<li>GuildMusicManager</li>\n</ul>\n<pre><code>public class GuildMusicManager {\n\n    private TrackScheduler trackScheduler;\n    private AudioForwarder audioForwarder;\n\n    public GuildMusicManager(AudioPlayerManager manager, Guild guild) {\n        AudioPlayer player = manager.createPlayer();\n        trackScheduler = new TrackScheduler(player);\n        player.addListener(trackScheduler);\n        audioForwarder = new AudioForwarder(player, guild);\n    }\n\n    public TrackScheduler getTrackScheduler() {\n        return trackScheduler;\n    }\n\n    public AudioForwarder getAudioForwarder() {\n        return audioForwarder;\n    }\n}\n</code></pre>\n<ul>\n<li>PlayerManager</li>\n</ul>\n<pre><code>public class PlayerManager {\n\n    private static PlayerManager INSTANCE;\n    private final Map&lt;Long, GuildMusicManager&gt; guildMusicManagers = new HashMap&lt;&gt;();\n    private final AudioPlayerManager audioPlayerManager = new DefaultAudioPlayerManager();\n\n    private PlayerManager() {\n        AudioSourceManagers.registerRemoteSources(audioPlayerManager);\n        AudioSourceManagers.registerLocalSource(audioPlayerManager);\n    }\n\n    public static PlayerManager get() {\n        if(INSTANCE == null) {\n            INSTANCE = new PlayerManager();\n        }\n        return INSTANCE;\n    }\n\n    public GuildMusicManager getGuildMusicManager(Guild guild) {\n        return guildMusicManagers.computeIfAbsent(guild.getIdLong(), (guildId) -&gt; {\n            GuildMusicManager musicManager = new GuildMusicManager(audioPlayerManager, guild);\n\n            guild.getAudioManager().setSendingHandler(musicManager.getAudioForwarder());\n\n            return musicManager;\n        });\n    }\n\n    public void play(Guild guild, String trackURL) {\n        GuildMusicManager guildMusicManager = getGuildMusicManager(guild);\n        audioPlayerManager.loadItemOrdered(guildMusicManager, trackURL, new AudioLoadResultHandler() {\n            @Override\n            public void trackLoaded(AudioTrack track) {\n                System.out.println(&quot;0&quot;);\n                guildMusicManager.getTrackScheduler().queue(track);\n                System.out.println(&quot;5&quot;);\n            }\n\n            @Override\n            public void playlistLoaded(AudioPlaylist playlist) {\n                System.out.println(&quot;0.1&quot;);\n                guildMusicManager.getTrackScheduler().queue(playlist.getTracks().get(0));\n                System.out.println(&quot;5.1&quot;);\n            }\n\n            @Override\n            public void noMatches() {\n                System.out.println(&quot;no_matches&quot;);\n            }\n\n            @Override\n            public void loadFailed(FriendlyException exception) {\n                System.out.println(&quot;failed&quot;);\n            }\n        });\n    }\n}\n</code></pre>\n<ul>\n<li>/play</li>\n</ul>\n<pre><code>public void onSlashCommandInteraction(@NotNull SlashCommandInteractionEvent event) {\n     if (event.getName().equals(&quot;play&quot;)) {\n                event.getGuild().getAudioManager().openAudioConnection(event.getMember().getVoiceState().getChannel());\n\n                String name = event.getOption(&quot;name&quot;).getAsString();\n                try {\n                    new URI(name);\n                } catch (URISyntaxException e) {\n                    name = name + &quot;ytsearch:&quot;;\n                }\n                PlayerManager playerManager = PlayerManager.get();\n                event.reply(&quot;Playing&quot;).setEphemeral(true).submit();\n                playerManager.play(event.getGuild(), name);\n        }\n}\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/S5AkP.png\" rel=\"nofollow noreferrer\">Console output</a></p>\n<p>After using /play, the bot successfully connects to the voice channel, but immediately starts reconnecting to it every few seconds without playing music.</p>\n<p>On the discord developer portal, all intents are enabled, on the test server the bot has administrator rights, the role of the bot is prioritized above all others.</p>\n<p>My versions:</p>\n<p>JDA 5.0.0-alpha.11</p>\n<p>lavaplayer 1.3.77</p>\n<p>P.S. updated:\nMoved to version of JDA 5.0.0-beta.9. The hanging is gone, but the program still doesn't play sound, and this time I don't understand what's going on there. Updated code above and screenshot of console output.</p>\n<p>If you move the stacktrace to the place where the code reaches during /play:</p>\n<p><a href=\"https://i.stack.imgur.com/8RG81.png\" rel=\"nofollow noreferrer\">Console output 2</a></p>\n"},{"tags":["java","kubernetes","kubernetes-operator"],"answers":[{"tags":[],"owner":{"account_id":9979280,"reputation":1,"user_id":7382741,"display_name":"user7382741"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684836446,"creation_date":1684746283,"answer_id":76304551,"question_id":74487916,"body_markdown":"client-java version:13.0.1  \r\n \r\nI met the same question several times, and recently find it happends when the machine which has apiserver is down.\r\nThe java client use okhttp: http1.1、long connection.When the server is down, client don&#39;t know. It depends on tcp keep alive to notice,but I don&#39;t know why the client don&#39; receive.So I add caltimeout to finish the conenction.\r\n\r\n      ApiClient apiClient = Config.fromToken(xxx, xxx,false);\r\n\r\n            apiClient.setHttpClient(\r\n                    apiClient\r\n                            .getHttpClient()\r\n                            .newBuilder()\r\n                            .callTimeout(Duration.ofMinutes(10))\r\n                            .build());\r\n\r\nI make the machine down,and find it works.\r\n\r\nThis is the func of caltimeout:\r\n\r\n    /**\r\n     * Sets the default timeout for complete calls. A value of 0 means no timeout, otherwise values\r\n     * must be between 1 and {@link Integer#MAX_VALUE} when converted to milliseconds.\r\n     *\r\n     * &lt;p&gt;The call timeout spans the entire call: resolving DNS, connecting, writing the request\r\n     * body, server processing, and reading the response body. If the call requires redirects or\r\n     * retries all must complete within one timeout period.\r\n     *\r\n     * &lt;p&gt;The default value is 0 which imposes no timeout.\r\n     */\r\n    @IgnoreJRERequirement\r\n    public Builder callTimeout(Duration duration) {\r\n      callTimeout = checkDuration(&quot;timeout&quot;, duration.toMillis(), TimeUnit.MILLISECONDS);\r\n      return this;\r\n    }\r\n\r\n\r\nset 10 minute just because watch last less than 10 minutes:\r\n\r\n          Watchable&lt;ApiType&gt; newWatch =\r\n              listerWatcher.watch(\r\n                  new CallGeneratorParams(\r\n                      Boolean.TRUE,\r\n                      lastSyncResourceVersion,\r\n                      Long.valueOf(jitteredWatchTimeoutSeconds).intValue()));\r\n\r\nlong jitteredWatchTimeoutSeconds =\r\n              Double.valueOf(REFLECTOR_WATCH_CLIENTSIDE_TIMEOUT.getSeconds() * (1 + Math.random()))\r\n.longValue();","title":"SharedIndexInformer (io.kubernetes) not working after few hours randomly","body":"<p>client-java version:13.0.1</p>\n<p>I met the same question several times, and recently find it happends when the machine which has apiserver is down.\nThe java client use okhttp: http1.1、long connection.When the server is down, client don't know. It depends on tcp keep alive to notice,but I don't know why the client don' receive.So I add caltimeout to finish the conenction.</p>\n<pre><code>  ApiClient apiClient = Config.fromToken(xxx, xxx,false);\n\n        apiClient.setHttpClient(\n                apiClient\n                        .getHttpClient()\n                        .newBuilder()\n                        .callTimeout(Duration.ofMinutes(10))\n                        .build());\n</code></pre>\n<p>I make the machine down,and find it works.</p>\n<p>This is the func of caltimeout:</p>\n<pre><code>/**\n * Sets the default timeout for complete calls. A value of 0 means no timeout, otherwise values\n * must be between 1 and {@link Integer#MAX_VALUE} when converted to milliseconds.\n *\n * &lt;p&gt;The call timeout spans the entire call: resolving DNS, connecting, writing the request\n * body, server processing, and reading the response body. If the call requires redirects or\n * retries all must complete within one timeout period.\n *\n * &lt;p&gt;The default value is 0 which imposes no timeout.\n */\n@IgnoreJRERequirement\npublic Builder callTimeout(Duration duration) {\n  callTimeout = checkDuration(&quot;timeout&quot;, duration.toMillis(), TimeUnit.MILLISECONDS);\n  return this;\n}\n</code></pre>\n<p>set 10 minute just because watch last less than 10 minutes:</p>\n<pre><code>      Watchable&lt;ApiType&gt; newWatch =\n          listerWatcher.watch(\n              new CallGeneratorParams(\n                  Boolean.TRUE,\n                  lastSyncResourceVersion,\n                  Long.valueOf(jitteredWatchTimeoutSeconds).intValue()));\n</code></pre>\n<p>long jitteredWatchTimeoutSeconds =\nDouble.valueOf(REFLECTOR_WATCH_CLIENTSIDE_TIMEOUT.getSeconds() * (1 + Math.random()))\n.longValue();</p>\n"}],"owner":{"account_id":6765473,"reputation":1,"user_id":5210610,"display_name":"Gilad Keinan"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":315,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1684836446,"creation_date":1668765709,"question_id":74487916,"body_markdown":"**Background**\r\n\r\nI made a PoC of a Java application using the following library:\r\n\r\n```\r\n&lt;dependency&gt;\r\n  &lt;groupId&gt;io.kubernetes&lt;/groupId&gt;\r\n  &lt;artifactId&gt;client-java-spring-integration&lt;/artifactId&gt;\r\n  &lt;version&gt;11.0.3&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```\r\n\r\nThe application is creating new k8s Jobs and watch for their events using SharedIndexInformer:\r\n\r\n```\r\nBatchV1Api batchV1Api = k8sApiClientService.getK8sBatchV1Api();\r\nreturn sharedInformerFactory.sharedIndexInformerFor(\r\n\t(CallGeneratorParams params) -&gt; {\r\n\t\treturn batchV1Api.listJobForAllNamespacesCall(\r\n\t\t\t\tnull,\r\n\t\t\t\tnull,\r\n\t\t\t\tnull,\r\n\t\t\t\tnull,\r\n\t\t\t\tnull,\r\n\t\t\t\tnull,\r\n\t\t\t\tparams.resourceVersion,\r\n\t\t\t\tnull,\r\n\t\t\t\tparams.timeoutSeconds,\r\n\t\t\t\tparams.watch,\r\n\t\t\t\tnull);\r\n\t},\r\n\tV1Job.class,\r\n\tV1JobList.class,\r\n\t30000);\r\n\r\n```\r\n\r\nI starts all informers this way:\r\n\r\n```\r\nsharedInformerFactory.startAllRegisteredInformers();\r\n```\r\n\r\nAnd initialize the k8s API this way:\r\n\r\n```\r\napiClient = new ClientBuilder()\r\n        .setCertificateAuthority(Base64.decodeBase64(kubernetesCertificateAuthData))\r\n        .setAuthentication(authentication)\r\n        .setVerifyingSsl(true)\r\n        .setBasePath(kubernetesAPI)\r\n        .build();\r\nOkHttpClient httpClient =\r\n        apiClient.getHttpClient().newBuilder().readTimeout(0, TimeUnit.SECONDS).build();\r\napiClient.setHttpClient(httpClient);\r\nio.kubernetes.client.openapi.Configuration.setDefaultApiClient(apiClient);\r\n```\r\n\r\n**What is the problem?**\r\nThe informer works great, I succeed to create new Jobs and get informed about completion/error/running events.\r\nBut, after a while the inform stopped working and I don&#39;t know why.\r\nI see that creation of new Job still works, so this is not a problem of communication.\r\nI thought to upgrade the library to the latest version v16.0.2, but I&#39;m not sure if this will fix the issue.\r\n\r\nCan you please assist?\r\n\r\n\r\n\r\nI have tried different resync duration of 30sec to 10min, the resync seems to work, but it seems that specific Jobs are not getting informed, even in the resync events it is missing.","title":"SharedIndexInformer (io.kubernetes) not working after few hours randomly","body":"<p><strong>Background</strong></p>\n<p>I made a PoC of a Java application using the following library:</p>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;io.kubernetes&lt;/groupId&gt;\n  &lt;artifactId&gt;client-java-spring-integration&lt;/artifactId&gt;\n  &lt;version&gt;11.0.3&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>The application is creating new k8s Jobs and watch for their events using SharedIndexInformer:</p>\n<pre><code>BatchV1Api batchV1Api = k8sApiClientService.getK8sBatchV1Api();\nreturn sharedInformerFactory.sharedIndexInformerFor(\n    (CallGeneratorParams params) -&gt; {\n        return batchV1Api.listJobForAllNamespacesCall(\n                null,\n                null,\n                null,\n                null,\n                null,\n                null,\n                params.resourceVersion,\n                null,\n                params.timeoutSeconds,\n                params.watch,\n                null);\n    },\n    V1Job.class,\n    V1JobList.class,\n    30000);\n\n</code></pre>\n<p>I starts all informers this way:</p>\n<pre><code>sharedInformerFactory.startAllRegisteredInformers();\n</code></pre>\n<p>And initialize the k8s API this way:</p>\n<pre><code>apiClient = new ClientBuilder()\n        .setCertificateAuthority(Base64.decodeBase64(kubernetesCertificateAuthData))\n        .setAuthentication(authentication)\n        .setVerifyingSsl(true)\n        .setBasePath(kubernetesAPI)\n        .build();\nOkHttpClient httpClient =\n        apiClient.getHttpClient().newBuilder().readTimeout(0, TimeUnit.SECONDS).build();\napiClient.setHttpClient(httpClient);\nio.kubernetes.client.openapi.Configuration.setDefaultApiClient(apiClient);\n</code></pre>\n<p><strong>What is the problem?</strong>\nThe informer works great, I succeed to create new Jobs and get informed about completion/error/running events.\nBut, after a while the inform stopped working and I don't know why.\nI see that creation of new Job still works, so this is not a problem of communication.\nI thought to upgrade the library to the latest version v16.0.2, but I'm not sure if this will fix the issue.</p>\n<p>Can you please assist?</p>\n<p>I have tried different resync duration of 30sec to 10min, the resync seems to work, but it seems that specific Jobs are not getting informed, even in the resync events it is missing.</p>\n"},{"tags":["javascript","java","graphics","3d","webgl"],"owner":{"account_id":234688,"reputation":1366,"user_id":501004,"accept_rate":56,"display_name":"Piyush Soni"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":37,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1684836340,"creation_date":1684836042,"question_id":76313514,"body_markdown":"One of the problems I&#39;m facing in the 3d graphics application I&#39;m working on (Client written in Javascript &amp; WebGL 1.*, Server that sends geometry data for each object through web socket written in Java) is the initial model loading efficiency. It is because if the set of geometry objects are too big, we first have to serialize that data from the server, deserialize that on the client, and then process it to create different VBOs for each of them finding suitable space in the client memory pool (to eventually send the graphics data to the GPU). My question is, is there a way I can create VBOs on the server itself and transmit them in their &#39;raw&#39; binary form so that I can just bind them to the GPU buffer data and be done without doing all of it? If I can&#39;t create, can I do something like when I create WebGL Buffers on the client side for the first time I send them back and store them on the server for future use? \r\n\r\nIt will take additional processing on the server to create such buffers but overall it might be time saving if I don&#39;t need to serialize/deserialize and then create webgl buffers every time on the client side. \r\n\r\nThanks!","title":"Can we create/store WebGL VBOs on a Java Server?","body":"<p>One of the problems I'm facing in the 3d graphics application I'm working on (Client written in Javascript &amp; WebGL 1.*, Server that sends geometry data for each object through web socket written in Java) is the initial model loading efficiency. It is because if the set of geometry objects are too big, we first have to serialize that data from the server, deserialize that on the client, and then process it to create different VBOs for each of them finding suitable space in the client memory pool (to eventually send the graphics data to the GPU). My question is, is there a way I can create VBOs on the server itself and transmit them in their 'raw' binary form so that I can just bind them to the GPU buffer data and be done without doing all of it? If I can't create, can I do something like when I create WebGL Buffers on the client side for the first time I send them back and store them on the server for future use?</p>\n<p>It will take additional processing on the server to create such buffers but overall it might be time saving if I don't need to serialize/deserialize and then create webgl buffers every time on the client side.</p>\n<p>Thanks!</p>\n"},{"tags":["java","azure","ant","jackson","jackson-databind"],"comments":[{"owner":{"display_name":"anon"},"score":0,"creation_date":1635316124,"post_id":69666622,"comment_id":123261154,"body_markdown":"Could you provide the `pom.xml` code to see dependencies you are used?","body":"Could you provide the <code>pom.xml</code> code to see dependencies you are used?"},{"owner":{"account_id":2108743,"reputation":161,"user_id":1874435,"accept_rate":28,"display_name":"user1874435"},"score":0,"creation_date":1635378464,"post_id":69666622,"comment_id":123285067,"body_markdown":"There is no pom.xml, this is old application.","body":"There is no pom.xml, this is old application."},{"owner":{"account_id":2108743,"reputation":161,"user_id":1874435,"accept_rate":28,"display_name":"user1874435"},"score":0,"creation_date":1635468838,"post_id":69666622,"comment_id":123313367,"body_markdown":"I finally got this. ```java.lang.LinkageError: Package versions: jackson-annotations=2.9.9, jackson-core=2.9.9, jackson-databind=2.9.9, jackson-dataformat-xml=2.12.5, jackson-datatype-jsr310=2.12.5, azure-core=1.21.0```","body":"I finally got this. <code>java.lang.LinkageError: Package versions: jackson-annotations=2.9.9, jackson-core=2.9.9, jackson-databind=2.9.9, jackson-dataformat-xml=2.12.5, jackson-datatype-jsr310=2.12.5, azure-core=1.21.0</code>"},{"owner":{"display_name":"anon"},"score":0,"creation_date":1635472289,"post_id":69666622,"comment_id":123313873,"body_markdown":"In the Question You mentioned azure Core 1.20 and in the error it is azure-core 1.21.0. Did you updated? And, what all are the dependencies you installed for that, in the project?","body":"In the Question You mentioned azure Core 1.20 and in the error it is azure-core 1.21.0. Did you updated? And, what all are the dependencies you installed for that, in the project?"},{"owner":{"account_id":2108743,"reputation":161,"user_id":1874435,"accept_rate":28,"display_name":"user1874435"},"score":0,"creation_date":1635525763,"post_id":69666622,"comment_id":123330800,"body_markdown":"Yes, I did. I also tried Ivy. code is included above.","body":"Yes, I did. I also tried Ivy. code is included above."},{"owner":{"display_name":"anon"},"score":1,"creation_date":1635554027,"post_id":69666622,"comment_id":123337774,"body_markdown":"Try update to this [dependencies compatibility version](https://azuresdkartifacts.blob.core.windows.net/azure-sdk-for-java/staging/sdk/identity/azure-identity/dependencies.html) package installations.","body":"Try update to this <a href=\"https://azuresdkartifacts.blob.core.windows.net/azure-sdk-for-java/staging/sdk/identity/azure-identity/dependencies.html\" rel=\"nofollow noreferrer\">dependencies compatibility version</a> package installations."},{"owner":{"account_id":2108743,"reputation":161,"user_id":1874435,"accept_rate":28,"display_name":"user1874435"},"score":0,"creation_date":1635927130,"post_id":69666622,"comment_id":123419509,"body_markdown":"lol. finally. azure-core 1.4.0 works. Thank you for the help.","body":"lol. finally. azure-core 1.4.0 works. Thank you for the help."}],"answers":[{"tags":[],"owner":{"display_name":"anon"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1635927321,"creation_date":1635927321,"answer_id":69821535,"question_id":69666622,"body_markdown":"Try update to this [dependencies compatibility version][1] package installations\r\n\r\n\r\n  [1]: https://azuresdkartifacts.blob.core.windows.net/azure-sdk-for-java/staging/sdk/identity/azure-identity/dependencies.html","title":"JacksonAdapter cannot resolve correctly in azure-core-1.20 and Java web app","body":"<p>Try update to this <a href=\"https://azuresdkartifacts.blob.core.windows.net/azure-sdk-for-java/staging/sdk/identity/azure-identity/dependencies.html\" rel=\"nofollow noreferrer\">dependencies compatibility version</a> package installations</p>\n"},{"tags":[],"owner":{"account_id":3590209,"reputation":1021,"user_id":2996452,"accept_rate":62,"display_name":"Jokkeri"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684836244,"creation_date":1684830401,"answer_id":76312682,"question_id":69666622,"body_markdown":"I had the exact same conflict when using azure-storage-file-datalake-12.15.1 where azure-core is requesting jackson versions 2.13.5.\r\n\r\nI forced the jackson libs to use 2.15.1 version and that resolved the problem for me.\r\nJackson libs for me was annotations, core, databind and datatype-jsr310\r\n\r\nI couldn&#39;t reproduce this in Eclipse but happened when running the Java app in prod, so it was quite tricky to resolve.\r\n\r\nStill using IVY as well.\r\n\r\nEdit:\r\nUseful link:\r\n[https://learn.microsoft.com/en-us/azure/developer/java/sdk/troubleshooting-dependency-version-conflict][1]\r\n\r\n\r\n  [1]: https://learn.microsoft.com/en-us/azure/developer/java/sdk/troubleshooting-dependency-version-conflict","title":"JacksonAdapter cannot resolve correctly in azure-core-1.20 and Java web app","body":"<p>I had the exact same conflict when using azure-storage-file-datalake-12.15.1 where azure-core is requesting jackson versions 2.13.5.</p>\n<p>I forced the jackson libs to use 2.15.1 version and that resolved the problem for me.\nJackson libs for me was annotations, core, databind and datatype-jsr310</p>\n<p>I couldn't reproduce this in Eclipse but happened when running the Java app in prod, so it was quite tricky to resolve.</p>\n<p>Still using IVY as well.</p>\n<p>Edit:\nUseful link:\n<a href=\"https://learn.microsoft.com/en-us/azure/developer/java/sdk/troubleshooting-dependency-version-conflict\" rel=\"nofollow noreferrer\">https://learn.microsoft.com/en-us/azure/developer/java/sdk/troubleshooting-dependency-version-conflict</a></p>\n"}],"owner":{"account_id":2108743,"reputation":161,"user_id":1874435,"accept_rate":28,"display_name":"user1874435"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1418,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1684836244,"creation_date":1634838622,"question_id":69666622,"body_markdown":"I am using azure-core-1.20 to connect to Azure KeyVault. \r\nIt is failing on line 35.\r\n\r\nCould anyone see a cause of this conflict?\r\nThank you\r\n\r\nFailing call:\r\n\r\n[![Failing function][1]][1]\r\n```\r\njava.lang.VerifyError: Bad return type\r\nException Details:\r\n  Location:\r\n    com/fasterxml/jackson/databind/cfg/MapperBuilder.streamFactory()Lcom/fasterxml/jackson/core/TokenStreamFactory; @7: areturn\r\n  Reason:\r\n    Type &#39;com/fasterxml/jackson/core/JsonFactory&#39; (current frame, stack[0]) is not assignable to &#39;com/fasterxml/jackson/core/TokenStreamFactory&#39; (from method signature)\r\n  Current Frame:\r\n    bci: @7\r\n    flags: { }\r\n    locals: { &#39;com/fasterxml/jackson/databind/cfg/MapperBuilder&#39; }\r\n    stack: { &#39;com/fasterxml/jackson/core/JsonFactory&#39; }\r\n  Bytecode:\r\n    0x0000000: 2ab4 0002 b600 08b0                    \r\n\r\n\tat com.fasterxml.jackson.databind.json.JsonMapper.builder(JsonMapper.java:114)\r\n\tat com.azure.core.util.serializer.JacksonAdapter.(JacksonAdapter.java:133)\r\n\tat com.azure.core.util.serializer.JacksonAdapter.createDefaultSerializerAdapter(JacksonAdapter.java:192)\r\n\tat com.azure.identity.implementation.IdentityClient.(IdentityClient.java:96)\r\n\tat com.azure.identity.implementation.IdentityClientBuilder.build(IdentityClientBuilder.java:113)\r\n\tat com.azure.identity.ManagedIdentityCredential.(ManagedIdentityCredential.java:39)\r\n\tat com.azure.identity.DefaultAzureCredentialBuilder.getCredentialsChain(DefaultAzureCredentialBuilder.java:129)\r\n\tat com.azure.identity.DefaultAzureCredentialBuilder.build(DefaultAzureCredentialBuilder.java:123)\r\n```\r\nCurrent Lib for the app:\r\n[![azure lib][2]][2]\r\n[![web app libs][3]][3]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/Pq33I.png\r\n  [2]: https://i.stack.imgur.com/UF3VK.png\r\n  [3]: https://i.stack.imgur.com/juSi4.png\r\n\r\nTry Ivy, but now jackson 2.9.9 is conflicting with 2.12.5 .\r\nDont know where jackson 2.9.9 is coming from. The Ivy report show no version 2.9.9\r\n```\r\n&lt;dependencies&gt;\r\n        &lt;dependency org=&quot;com.azure&quot; name=&quot;azure-core&quot; rev=&quot;1.21.0&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;com.novell.ldap&quot; name=&quot;jldap&quot; rev=&quot;2009-10-07&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.springframework&quot; name=&quot;spring-jdbc&quot; rev=&quot;5.3.11&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.apache.tomcat&quot; name=&quot;tomcat-jdbc&quot; rev=&quot;9.0.52&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;com.azure&quot; name=&quot;azure-security-keyvault-secrets&quot; rev=&quot;4.3.3&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;com.azure&quot; name=&quot;azure-identity&quot; rev=&quot;1.3.6&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;javax.resource&quot; name=&quot;javax.resource-api&quot; rev=&quot;1.7.1&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.springframework&quot; name=&quot;spring-webmvc&quot; rev=&quot;5.3.12&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.springframework&quot; name=&quot;spring-context&quot; rev=&quot;5.3.12&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;!-- &lt;dependency org=&quot;org.springframework&quot; name=&quot;spring-jca&quot; rev=&quot;2.0.8&quot; conf=&quot;binaries-&gt;default&quot; &gt;\r\n            &lt;exclude module=&quot;spring-bean&quot;&gt;&lt;/exclude&gt;\r\n            &lt;exclude module=&quot;spring-core&quot;&gt;&lt;/exclude&gt;\r\n            &lt;exclude module=&quot;spring-dao&quot;&gt;&lt;/exclude&gt;\r\n        &lt;/dependency&gt;  --&gt;\r\n        &lt;dependency org=&quot;commons-configuration&quot; name=&quot;commons-configuration&quot; rev=&quot;1.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;commons-collections&quot; name=&quot;commons-collections&quot; rev=&quot;3.2.2&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;displaytag&quot; name=&quot;displaytag&quot; rev=&quot;1.2&quot; conf=&quot;binaries-&gt;default&quot; &gt;\r\n            &lt;exclude  module=&quot;jcl104-over-slf4j&quot;&gt;&lt;/exclude&gt;\r\n            &lt;exclude module=&quot;slf4j-log4j12&quot;&gt;&lt;/exclude&gt;\r\n        &lt;/dependency&gt; \r\n        &lt;dependency org=&quot;com.google.code.gson&quot; name=&quot;gson&quot; rev=&quot;2.8.8&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-core&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-taglib&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-extras&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-tiles&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-el&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-faces&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.apache.logging.log4j&quot; name=&quot;log4j-core&quot; rev=&quot;2.14.1&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.apache.logging.log4j&quot; name=&quot;log4j-api&quot; rev=&quot;2.14.1&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.apache.logging.log4j&quot; name=&quot;log4j-slf4j-impl&quot; rev=&quot;2.14.1&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.slf4j&quot; name=&quot;slf4j-api&quot; rev=&quot;1.7.32&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.slf4j&quot; name=&quot;slf4j-log4j12&quot; rev=&quot;1.7.32&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.slf4j&quot; name=&quot;slf4j-simple&quot; rev=&quot;1.7.32&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\r\n        &lt;dependency org=&quot;org.slf4j&quot; name=&quot;jcl-over-slf4j&quot; rev=&quot;1.7.32&quot; conf=&quot;binaries-&gt;default&quot;  /&gt;\r\n    &lt;/dependencies&gt;\r\n```","title":"JacksonAdapter cannot resolve correctly in azure-core-1.20 and Java web app","body":"<p>I am using azure-core-1.20 to connect to Azure KeyVault.\nIt is failing on line 35.</p>\n<p>Could anyone see a cause of this conflict?\nThank you</p>\n<p>Failing call:</p>\n<p><a href=\"https://i.stack.imgur.com/Pq33I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Pq33I.png\" alt=\"Failing function\" /></a></p>\n<pre><code>java.lang.VerifyError: Bad return type\nException Details:\n  Location:\n    com/fasterxml/jackson/databind/cfg/MapperBuilder.streamFactory()Lcom/fasterxml/jackson/core/TokenStreamFactory; @7: areturn\n  Reason:\n    Type 'com/fasterxml/jackson/core/JsonFactory' (current frame, stack[0]) is not assignable to 'com/fasterxml/jackson/core/TokenStreamFactory' (from method signature)\n  Current Frame:\n    bci: @7\n    flags: { }\n    locals: { 'com/fasterxml/jackson/databind/cfg/MapperBuilder' }\n    stack: { 'com/fasterxml/jackson/core/JsonFactory' }\n  Bytecode:\n    0x0000000: 2ab4 0002 b600 08b0                    \n\n    at com.fasterxml.jackson.databind.json.JsonMapper.builder(JsonMapper.java:114)\n    at com.azure.core.util.serializer.JacksonAdapter.(JacksonAdapter.java:133)\n    at com.azure.core.util.serializer.JacksonAdapter.createDefaultSerializerAdapter(JacksonAdapter.java:192)\n    at com.azure.identity.implementation.IdentityClient.(IdentityClient.java:96)\n    at com.azure.identity.implementation.IdentityClientBuilder.build(IdentityClientBuilder.java:113)\n    at com.azure.identity.ManagedIdentityCredential.(ManagedIdentityCredential.java:39)\n    at com.azure.identity.DefaultAzureCredentialBuilder.getCredentialsChain(DefaultAzureCredentialBuilder.java:129)\n    at com.azure.identity.DefaultAzureCredentialBuilder.build(DefaultAzureCredentialBuilder.java:123)\n</code></pre>\n<p>Current Lib for the app:\n<a href=\"https://i.stack.imgur.com/UF3VK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UF3VK.png\" alt=\"azure lib\" /></a>\n<a href=\"https://i.stack.imgur.com/juSi4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/juSi4.png\" alt=\"web app libs\" /></a></p>\n<p>Try Ivy, but now jackson 2.9.9 is conflicting with 2.12.5 .\nDont know where jackson 2.9.9 is coming from. The Ivy report show no version 2.9.9</p>\n<pre><code>&lt;dependencies&gt;\n        &lt;dependency org=&quot;com.azure&quot; name=&quot;azure-core&quot; rev=&quot;1.21.0&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;com.novell.ldap&quot; name=&quot;jldap&quot; rev=&quot;2009-10-07&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.springframework&quot; name=&quot;spring-jdbc&quot; rev=&quot;5.3.11&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.apache.tomcat&quot; name=&quot;tomcat-jdbc&quot; rev=&quot;9.0.52&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;com.azure&quot; name=&quot;azure-security-keyvault-secrets&quot; rev=&quot;4.3.3&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;com.azure&quot; name=&quot;azure-identity&quot; rev=&quot;1.3.6&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;javax.resource&quot; name=&quot;javax.resource-api&quot; rev=&quot;1.7.1&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.springframework&quot; name=&quot;spring-webmvc&quot; rev=&quot;5.3.12&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.springframework&quot; name=&quot;spring-context&quot; rev=&quot;5.3.12&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;!-- &lt;dependency org=&quot;org.springframework&quot; name=&quot;spring-jca&quot; rev=&quot;2.0.8&quot; conf=&quot;binaries-&gt;default&quot; &gt;\n            &lt;exclude module=&quot;spring-bean&quot;&gt;&lt;/exclude&gt;\n            &lt;exclude module=&quot;spring-core&quot;&gt;&lt;/exclude&gt;\n            &lt;exclude module=&quot;spring-dao&quot;&gt;&lt;/exclude&gt;\n        &lt;/dependency&gt;  --&gt;\n        &lt;dependency org=&quot;commons-configuration&quot; name=&quot;commons-configuration&quot; rev=&quot;1.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;commons-collections&quot; name=&quot;commons-collections&quot; rev=&quot;3.2.2&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;displaytag&quot; name=&quot;displaytag&quot; rev=&quot;1.2&quot; conf=&quot;binaries-&gt;default&quot; &gt;\n            &lt;exclude  module=&quot;jcl104-over-slf4j&quot;&gt;&lt;/exclude&gt;\n            &lt;exclude module=&quot;slf4j-log4j12&quot;&gt;&lt;/exclude&gt;\n        &lt;/dependency&gt; \n        &lt;dependency org=&quot;com.google.code.gson&quot; name=&quot;gson&quot; rev=&quot;2.8.8&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-core&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-taglib&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-extras&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-tiles&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-el&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.apache.struts&quot; name=&quot;struts-faces&quot; rev=&quot;1.3.10&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.apache.logging.log4j&quot; name=&quot;log4j-core&quot; rev=&quot;2.14.1&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.apache.logging.log4j&quot; name=&quot;log4j-api&quot; rev=&quot;2.14.1&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.apache.logging.log4j&quot; name=&quot;log4j-slf4j-impl&quot; rev=&quot;2.14.1&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.slf4j&quot; name=&quot;slf4j-api&quot; rev=&quot;1.7.32&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.slf4j&quot; name=&quot;slf4j-log4j12&quot; rev=&quot;1.7.32&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.slf4j&quot; name=&quot;slf4j-simple&quot; rev=&quot;1.7.32&quot; conf=&quot;binaries-&gt;default&quot; /&gt;\n        &lt;dependency org=&quot;org.slf4j&quot; name=&quot;jcl-over-slf4j&quot; rev=&quot;1.7.32&quot; conf=&quot;binaries-&gt;default&quot;  /&gt;\n    &lt;/dependencies&gt;\n</code></pre>\n"},{"tags":["java","keycloak","keycloak-admin-client"],"owner":{"account_id":9197181,"reputation":81,"user_id":6835528,"display_name":"MCLonips"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":109,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684836010,"creation_date":1684836010,"question_id":76313509,"body_markdown":"Unfortunaly we can not use the keycloak interface directly so we had to build a proxy communicating with the keycloak over the java-admin-client in our application. Currently you are able to login and change your password with our proxy.\r\n\r\nNow we want to detect if a password is expired or temporary to force the user to choose and set a new password. To reach this we catch the possible HttpResponseException due to the authClient.obtainAccessToken(String,String) method. If the StatusCode is 400 we check if the users password is expired.\r\nTo check this we first check if the UserRepresentation contains the required action “UPDATE_PASSWORD”. Additionally we try to validate if the given password is correct.\r\nAs now we remove the UPDATE_PASSWORD action and try to login again. If this works correctly we assume the password may be correct and the user is able to change its password.\r\nThis worked for us when using a temporary password or setting the UPDATE_PASSWORD action manually.\r\n\r\nNow we activated a password policy with an expiration date. but now our approach to detect if a password is valid does not work anymore. The UPDATE_PASSWORD action is set but if we remove it login is still not possible (probably because of the password policy and the reached expiration?).\r\n\r\nI know this is veeeeeeery hacky and we are not happy with this approach. Is there any way to check if a password is valid even if its expired or temprorary?\r\n\r\nWe use the keycloak admin and auth client maven dependency in version 18.0.2 and a keycloak in version 18.0.0\r\n\r\nGreetings from Germany!","title":"Validate a password with keycloak with the java admin client","body":"<p>Unfortunaly we can not use the keycloak interface directly so we had to build a proxy communicating with the keycloak over the java-admin-client in our application. Currently you are able to login and change your password with our proxy.</p>\n<p>Now we want to detect if a password is expired or temporary to force the user to choose and set a new password. To reach this we catch the possible HttpResponseException due to the authClient.obtainAccessToken(String,String) method. If the StatusCode is 400 we check if the users password is expired.\nTo check this we first check if the UserRepresentation contains the required action “UPDATE_PASSWORD”. Additionally we try to validate if the given password is correct.\nAs now we remove the UPDATE_PASSWORD action and try to login again. If this works correctly we assume the password may be correct and the user is able to change its password.\nThis worked for us when using a temporary password or setting the UPDATE_PASSWORD action manually.</p>\n<p>Now we activated a password policy with an expiration date. but now our approach to detect if a password is valid does not work anymore. The UPDATE_PASSWORD action is set but if we remove it login is still not possible (probably because of the password policy and the reached expiration?).</p>\n<p>I know this is veeeeeeery hacky and we are not happy with this approach. Is there any way to check if a password is valid even if its expired or temprorary?</p>\n<p>We use the keycloak admin and auth client maven dependency in version 18.0.2 and a keycloak in version 18.0.0</p>\n<p>Greetings from Germany!</p>\n"},{"tags":["java","ms-word","apache-poi"],"comments":[{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":2,"creation_date":1684845531,"post_id":76313496,"comment_id":134574122,"body_markdown":"https://stackoverflow.com/questions/75259180/how-to-implement-the-hanging-indent-in-word-document-with-apache-poi/75259685#75259685 -&gt; [XWPFParagraph.setIndentFromLeft](https://poi.apache.org/apidocs/dev/org/apache/poi/xwpf/usermodel/XWPFParagraph.html#setIndentFromLeft-int-) without `XWPFParagraph.setIndentationHanging`.","body":"<a href=\"https://stackoverflow.com/questions/75259180/how-to-implement-the-hanging-indent-in-word-document-with-apache-poi/75259685#75259685\" title=\"how to implement the hanging indent in word document with apache poi\">stackoverflow.com/questions/75259180/&hellip;</a> -&gt; <a href=\"https://poi.apache.org/apidocs/dev/org/apache/poi/xwpf/usermodel/XWPFParagraph.html#setIndentFromLeft-int-\" rel=\"nofollow noreferrer\">XWPFParagraph.setIndentFromLeft</a> without <code>XWPFParagraph.setIndentationHanging</code>."},{"owner":{"account_id":19332777,"reputation":921,"user_id":14133995,"display_name":"Charles Kenyon"},"score":2,"creation_date":1684848133,"post_id":76313496,"comment_id":134574802,"body_markdown":"You are adding a Tab character in Word, similar to pressing the Tab key when in text. What you want to do is change the paragraph formatting to set a left indent.","body":"You are adding a Tab character in Word, similar to pressing the Tab key when in text. What you want to do is change the paragraph formatting to set a left indent."}],"owner":{"account_id":11317917,"reputation":51,"user_id":8299076,"display_name":"Bharath Naidu Yenumula"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":103,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1684835894,"creation_date":1684835894,"question_id":76313496,"body_markdown":"I am trying to add indentation(of 3 tabs) to the whole paragraph using Apache poi. Here is the code that i have used to create indentation.\r\n\r\n```\r\n    import org.apache.poi.xwpf.usermodel.*;\r\n    import java.io.FileOutputStream;\r\n    import java.io.IOException;\r\n\r\n    public class ApachePOIExample {\r\n        public static void main(String[] args) {\r\n            // Create a new Word document\r\n            XWPFDocument document = new XWPFDocument();\r\n\r\n            // Create a paragraph\r\n            XWPFParagraph paragraph = document.createParagraph();\r\n\r\n            // Create a run and add text to it\r\n            XWPFRun run = paragraph.createRun();\r\n            run.addTab();\r\n            run.addTab();\r\n            run.addTab();\r\n            run.setText(&quot;A paragraph is a series of sentences that are organized and \r\n    coherent, and are all related to a single topic. Almost every piece of writing you do \r\n    that is longer than a few sentences should be organized into paragraphs. This is because \r\n    paragraphs show a reader where the subdivisions of an essay begin and end, and thus help \r\n    the reader see the organization of the essay and grasp its main points.&quot;);\r\n\r\n        // Save the document to a file\r\n            try (FileOutputStream fileOutputStream = new FileOutputStream(&quot;example.docx&quot;)) {\r\n                document.write(fileOutputStream);\r\n            } catch (IOException e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n    }\r\n\r\n```\r\nAnd this is the output that i got from the above code. The run.addTab() function is indenting only the first line of the paragraph as shown below.\r\n[![code output][1]][1]\r\n\r\n\r\nIs there any way in apache poi that i could have format like this?\r\n[![enter image description here][2]][2]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/PvTAx.png\r\n  [2]: https://i.stack.imgur.com/mPWOP.png\r\nAny help or insights would be much appreciated.","title":"Add indentation to whole paragraph using apache poi","body":"<p>I am trying to add indentation(of 3 tabs) to the whole paragraph using Apache poi. Here is the code that i have used to create indentation.</p>\n<pre><code>    import org.apache.poi.xwpf.usermodel.*;\n    import java.io.FileOutputStream;\n    import java.io.IOException;\n\n    public class ApachePOIExample {\n        public static void main(String[] args) {\n            // Create a new Word document\n            XWPFDocument document = new XWPFDocument();\n\n            // Create a paragraph\n            XWPFParagraph paragraph = document.createParagraph();\n\n            // Create a run and add text to it\n            XWPFRun run = paragraph.createRun();\n            run.addTab();\n            run.addTab();\n            run.addTab();\n            run.setText(&quot;A paragraph is a series of sentences that are organized and \n    coherent, and are all related to a single topic. Almost every piece of writing you do \n    that is longer than a few sentences should be organized into paragraphs. This is because \n    paragraphs show a reader where the subdivisions of an essay begin and end, and thus help \n    the reader see the organization of the essay and grasp its main points.&quot;);\n\n        // Save the document to a file\n            try (FileOutputStream fileOutputStream = new FileOutputStream(&quot;example.docx&quot;)) {\n                document.write(fileOutputStream);\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n\n</code></pre>\n<p>And this is the output that i got from the above code. The run.addTab() function is indenting only the first line of the paragraph as shown below.\n<a href=\"https://i.stack.imgur.com/PvTAx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PvTAx.png\" alt=\"code output\" /></a></p>\n<p>Is there any way in apache poi that i could have format like this?\n<a href=\"https://i.stack.imgur.com/mPWOP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mPWOP.png\" alt=\"enter image description here\" /></a></p>\n<p>Any help or insights would be much appreciated.</p>\n"},{"tags":["java","switch-statement","java.util.scanner"],"comments":[{"owner":{"account_id":9463219,"reputation":9357,"user_id":7036419,"display_name":"Maurice Perry"},"score":0,"creation_date":1506415459,"post_id":46421569,"comment_id":79800626,"body_markdown":"Have you noticed that you have no break in your cases, and that your while loop is inside the switch statement?","body":"Have you noticed that you have no break in your cases, and that your while loop is inside the switch statement?"},{"owner":{"account_id":11781310,"reputation":13,"user_id":8620755,"display_name":"Gege"},"score":0,"creation_date":1506415640,"post_id":46421569,"comment_id":79800757,"body_markdown":"@MauricePerry i had it as default: but it wasn&#39;t reading certain values. Also breaks don&#39;t seem to impact my result(?)","body":"@MauricePerry i had it as default: but it wasn&#39;t reading certain values. Also breaks don&#39;t seem to impact my result(?)"},{"owner":{"account_id":128226,"reputation":10041,"user_id":325900,"accept_rate":78,"display_name":"DaveyDaveDave"},"score":0,"creation_date":1506415759,"post_id":46421569,"comment_id":79800841,"body_markdown":"Are you sure you&#39;ve posted the real code? When I copy and paste it I&#39;m not seeing the results you say you&#39;re seeing. In particular, my stack looks like: `[^, 2.0, -, *, /, ^, 3.0, /, ^, 2.0, 6.0, *, /, ^, 8.0, +, -, *, /, ^, 2.5, 3.0]`, which is consistent with @MauricePerry&#39;s observation that you are missing `break` statements.","body":"Are you sure you&#39;ve posted the real code? When I copy and paste it I&#39;m not seeing the results you say you&#39;re seeing. In particular, my stack looks like: <code>[^, 2.0, -, *, &#47;, ^, 3.0, &#47;, ^, 2.0, 6.0, *, &#47;, ^, 8.0, +, -, *, &#47;, ^, 2.5, 3.0]</code>, which is consistent with @MauricePerry&#39;s observation that you are missing <code>break</code> statements."},{"owner":{"account_id":11781310,"reputation":13,"user_id":8620755,"display_name":"Gege"},"score":1,"creation_date":1506416661,"post_id":46421569,"comment_id":79801466,"body_markdown":"@DaveyDaveDave oh I totally realize what I was doing wrong-- wasn&#39;t reading the stack correctly.. Thanks for your help","body":"@DaveyDaveDave oh I totally realize what I was doing wrong-- wasn&#39;t reading the stack correctly.. Thanks for your help"}],"answers":[{"tags":[],"owner":{"account_id":128226,"reputation":10041,"user_id":325900,"accept_rate":78,"display_name":"DaveyDaveDave"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1506416230,"creation_date":1506416230,"answer_id":46421963,"question_id":46421569,"body_markdown":"Copying your code and modifying slightly to use a `Stack&lt;String&gt;` rather than implementing your `operationNode` and `numberNode` classes, I find that the following works as (I think) you expect:\r\n\r\n    public static void main(String... args) {\r\n        Scanner stackScanner = new Scanner(&quot;^ 2 - 3 / 2 6 * 8 + 2.5 3&quot;);\r\n\r\n        Stack&lt;String&gt; stack = new Stack&lt;&gt;();\r\n\r\n        while (stackScanner.hasNextLine()) {\r\n\r\n            switch (stackScanner.next()) {\r\n                case &quot;+&quot;: {\r\n                    stack.push(&quot;+&quot;);\r\n                    break;\r\n                }\r\n\r\n                case &quot;-&quot;: {\r\n                    stack.push(&quot;-&quot;);\r\n                    break;\r\n                }\r\n\r\n                case &quot;*&quot;: {\r\n                    stack.push(&quot;*&quot;);\r\n                    break;\r\n                }\r\n\r\n                case &quot;/&quot;: {\r\n                    stack.push(&quot;/&quot;);\r\n                    break;\r\n                }\r\n\r\n                case &quot;^&quot;: {\r\n                    stack.push(&quot;^&quot;);\r\n                    break;\r\n                }\r\n            }\r\n\r\n            while (stackScanner.hasNextDouble()) {\r\n                stack.push(Double.toString(stackScanner.nextDouble()));\r\n            }\r\n        }\r\n\r\n        System.out.println(stack);\r\n    }\r\n\r\nThat is, I&#39;ve added the `break;` statements, which you seem to not need (perhaps some sort of JVM difference?) and moved the `while` loop outside of the `switch`.","title":"Java Scanner nextDouble command skipping values with switch case?","body":"<p>Copying your code and modifying slightly to use a <code>Stack&lt;String&gt;</code> rather than implementing your <code>operationNode</code> and <code>numberNode</code> classes, I find that the following works as (I think) you expect:</p>\n\n<pre><code>public static void main(String... args) {\n    Scanner stackScanner = new Scanner(\"^ 2 - 3 / 2 6 * 8 + 2.5 3\");\n\n    Stack&lt;String&gt; stack = new Stack&lt;&gt;();\n\n    while (stackScanner.hasNextLine()) {\n\n        switch (stackScanner.next()) {\n            case \"+\": {\n                stack.push(\"+\");\n                break;\n            }\n\n            case \"-\": {\n                stack.push(\"-\");\n                break;\n            }\n\n            case \"*\": {\n                stack.push(\"*\");\n                break;\n            }\n\n            case \"/\": {\n                stack.push(\"/\");\n                break;\n            }\n\n            case \"^\": {\n                stack.push(\"^\");\n                break;\n            }\n        }\n\n        while (stackScanner.hasNextDouble()) {\n            stack.push(Double.toString(stackScanner.nextDouble()));\n        }\n    }\n\n    System.out.println(stack);\n}\n</code></pre>\n\n<p>That is, I've added the <code>break;</code> statements, which you seem to not need (perhaps some sort of JVM difference?) and moved the <code>while</code> loop outside of the <code>switch</code>.</p>\n"},{"comments":[{"owner":{"account_id":128226,"reputation":10041,"user_id":325900,"accept_rate":78,"display_name":"DaveyDaveDave"},"score":0,"creation_date":1506427051,"post_id":46422070,"comment_id":79808686,"body_markdown":"Sorry - I don&#39;t think this is actually correct. This will only process a single token per line. If the input is a single line - &quot;^ 2 - 3 / 2 6 * 8 + 2.5 3&quot;, it will process the &quot;^&quot; and then stop.","body":"Sorry - I don&#39;t think this is actually correct. This will only process a single token per line. If the input is a single line - &quot;^ 2 - 3 / 2 6 * 8 + 2.5 3&quot;, it will process the &quot;^&quot; and then stop."}],"tags":[],"owner":{"account_id":1135699,"reputation":30287,"user_id":1120793,"accept_rate":35,"display_name":"Darshan Mehta"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1506416519,"creation_date":1506416519,"answer_id":46422070,"question_id":46421569,"body_markdown":"You need to wrap `switch` into `while` and move the handling of `double` into `default` block, e.g.:\r\n\r\n    while (stackScanner.hasNextLine()) {\r\n    \tString nextToken = stackScanner.next();\r\n        switch(nextToken) { \r\n    \r\n        case&quot;+&quot;: {\r\n            System.out.println(&quot;+&quot;);\r\n            break;\r\n            }\r\n    \r\n        case&quot;-&quot;:{\r\n        \tSystem.out.println(&quot;-&quot;);\r\n        \tbreak;\r\n        }\r\n    \r\n        case&quot;*&quot;:{\r\n        \tSystem.out.println(&quot;*&quot;);\r\n        \tbreak;\r\n        }\r\n    \r\n        case&quot;/&quot;:{\r\n        \tSystem.out.println(&quot;/&quot;);\r\n        \tbreak;\r\n        }\r\n    \r\n        case&quot;^&quot;:{\r\n        \tSystem.out.println(&quot;^&quot;);\r\n        \tbreak;\r\n        }\r\n    \r\n        default:\r\n        \tif(isDouble(nextToken)){\r\n        \t\t//Do something\r\n        \t}\r\n        \tbreak;\r\n        }\r\n    }\r\n\r\nYou also need to write a method to check for `double`. It would look something like this:\r\n\r\n    private boolean isDouble(String number){\r\n    \ttry{\r\n            Double.parseDouble(number);\r\n            return true;\r\n        }Catch(Exception e){\r\n            return false;\r\n        }\r\n    }","title":"Java Scanner nextDouble command skipping values with switch case?","body":"<p>You need to wrap <code>switch</code> into <code>while</code> and move the handling of <code>double</code> into <code>default</code> block, e.g.:</p>\n\n<pre><code>while (stackScanner.hasNextLine()) {\n    String nextToken = stackScanner.next();\n    switch(nextToken) { \n\n    case\"+\": {\n        System.out.println(\"+\");\n        break;\n        }\n\n    case\"-\":{\n        System.out.println(\"-\");\n        break;\n    }\n\n    case\"*\":{\n        System.out.println(\"*\");\n        break;\n    }\n\n    case\"/\":{\n        System.out.println(\"/\");\n        break;\n    }\n\n    case\"^\":{\n        System.out.println(\"^\");\n        break;\n    }\n\n    default:\n        if(isDouble(nextToken)){\n            //Do something\n        }\n        break;\n    }\n}\n</code></pre>\n\n<p>You also need to write a method to check for <code>double</code>. It would look something like this:</p>\n\n<pre><code>private boolean isDouble(String number){\n    try{\n        Double.parseDouble(number);\n        return true;\n    }Catch(Exception e){\n        return false;\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":11781310,"reputation":13,"user_id":8620755,"display_name":"Gege"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":173,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":46421963,"answer_count":2,"score":1,"last_activity_date":1684835848,"creation_date":1506415032,"question_id":46421569,"body_markdown":"I&#39;m scanning an argument file with a switch case into a `Stack` and it&#39;s skipping over values with a `.nextDouble` command?\r\n\r\nHere is my code fragment:\r\n\r\n    while (stackScanner.hasNextLine()) {\t\t\r\n\t\t\r\n\t\tswitch(stackScanner.next()) { \r\n\t\t\t\t\r\n\t\tcase&quot;+&quot;: {\r\n\t\t\toperator= new operationNode(&quot;+&quot;);\r\n\t\t\tstack.push(operator);}\r\n\t\t\t\r\n\t\tcase&quot;-&quot;:{\r\n\t\t\toperator= new operationNode(&quot;-&quot;);\r\n\t\t\tstack.push(operator);}\r\n\t\t\t\r\n\t\tcase&quot;*&quot;:{\r\n\t\t\toperator= new operationNode(&quot;*&quot;);\r\n\t\t\tstack.push(operator);}\r\n\t\t\t\r\n\t\tcase&quot;/&quot;:{\r\n\t\t\toperator= new operationNode(&quot;/&quot;);\r\n\t\t\tstack.push(operator);}\r\n\t\t\t\r\n\t\tcase&quot;^&quot;:{\r\n\t\t\toperator= new operationNode(&quot;^&quot;);\r\n\t\t\tstack.push(operator);}\r\n\t\t\r\n\t\twhile(stackScanner.hasNextDouble()) {\r\n\t\t\tstack.push(new numberNode(stackScanner.nextDouble()));\r\n\t\t}\r\n\t}\r\n\r\nThe problem is in this last line here, where the argument file contains the following: `^ 2 - 3 / 2 6 * 8 + 2.5 3`\r\n\r\nYet, the scanner only collects: `^ 2 - 3 / 6 * 8 + 3`.\r\n\r\nSo it&#39;s skipping over the first numbers that come in a pair here (2 and 2.5).\r\n\r\nThing is, when I add `stackScanner.next();` at the end of the while loop, the only numbers that it saves are those values 2 and 2.5?","title":"Java Scanner nextDouble command skipping values with switch case?","body":"<p>I'm scanning an argument file with a switch case into a <code>Stack</code> and it's skipping over values with a <code>.nextDouble</code> command?</p>\n\n<p>Here is my code fragment:</p>\n\n<pre><code>while (stackScanner.hasNextLine()) {        \n\n    switch(stackScanner.next()) { \n\n    case\"+\": {\n        operator= new operationNode(\"+\");\n        stack.push(operator);}\n\n    case\"-\":{\n        operator= new operationNode(\"-\");\n        stack.push(operator);}\n\n    case\"*\":{\n        operator= new operationNode(\"*\");\n        stack.push(operator);}\n\n    case\"/\":{\n        operator= new operationNode(\"/\");\n        stack.push(operator);}\n\n    case\"^\":{\n        operator= new operationNode(\"^\");\n        stack.push(operator);}\n\n    while(stackScanner.hasNextDouble()) {\n        stack.push(new numberNode(stackScanner.nextDouble()));\n    }\n}\n</code></pre>\n\n<p>The problem is in this last line here, where the argument file contains the following: <code>^ 2 - 3 / 2 6 * 8 + 2.5 3</code></p>\n\n<p>Yet, the scanner only collects: <code>^ 2 - 3 / 6 * 8 + 3</code>.</p>\n\n<p>So it's skipping over the first numbers that come in a pair here (2 and 2.5).</p>\n\n<p>Thing is, when I add <code>stackScanner.next();</code> at the end of the while loop, the only numbers that it saves are those values 2 and 2.5?</p>\n"},{"tags":["java","java.util.scanner"],"comments":[{"owner":{"account_id":8153102,"reputation":15213,"user_id":6139527,"display_name":"Nicholas K"},"score":1,"creation_date":1548248298,"post_id":54327660,"comment_id":95473608,"body_markdown":"`cmdScanner.nextLine().split(&quot; &quot;);`","body":"<code>cmdScanner.nextLine().split(&quot; &quot;);</code>"},{"owner":{"account_id":12824720,"reputation":115,"user_id":9278225,"display_name":"CoreNoob"},"score":0,"creation_date":1548248449,"post_id":54327660,"comment_id":95473693,"body_markdown":"Yeah, but then I need to use an array. I want to assign the &quot;argument&quot; to a String.","body":"Yeah, but then I need to use an array. I want to assign the &quot;argument&quot; to a String."},{"owner":{"account_id":8153102,"reputation":15213,"user_id":6139527,"display_name":"Nicholas K"},"score":0,"creation_date":1548248483,"post_id":54327660,"comment_id":95473715,"body_markdown":"What exactly are you trying to do? Please provide a sample input with expected output. *That could be helpful because later on I want to get the &quot;next&quot; BigDecimal in a proper way* -- This is highly unclear.","body":"What exactly are you trying to do? Please provide a sample input with expected output. <i>That could be helpful because later on I want to get the &quot;next&quot; BigDecimal in a proper way</i> -- This is highly unclear."},{"owner":{"account_id":12824720,"reputation":115,"user_id":9278225,"display_name":"CoreNoob"},"score":0,"creation_date":1548249213,"post_id":54327660,"comment_id":95474108,"body_markdown":"I want to let the user enter a command like this: *transact fromWallet toWallet 12.00*. And then a method should be called, for example: *transact(fromWallet, toWallet, new BigDecimal(12.00));* and the last argument will be a *BigDecimal* That is how I implemented *Money* in my code. With my implementation of getting *arguments* for my methods I wouldn&#39;t be able to get the *BigDecimal* in a good way I think.","body":"I want to let the user enter a command like this: <i>transact fromWallet toWallet 12.00</i>. And then a method should be called, for example: <i>transact(fromWallet, toWallet, new BigDecimal(12.00));</i> and the last argument will be a <i>BigDecimal</i> That is how I implemented <i>Money</i> in my code. With my implementation of getting <i>arguments</i> for my methods I wouldn&#39;t be able to get the <i>BigDecimal</i> in a good way I think."}],"answers":[{"comments":[{"owner":{"account_id":12824720,"reputation":115,"user_id":9278225,"display_name":"CoreNoob"},"score":0,"creation_date":1548248843,"post_id":54327891,"comment_id":95473916,"body_markdown":"Thanks for this quick solution. It &quot;almost&quot; works. It fails, if there is no whitespace. That means if I only enter one argument.","body":"Thanks for this quick solution. It &quot;almost&quot; works. It fails, if there is no whitespace. That means if I only enter one argument."},{"owner":{"account_id":12824720,"reputation":115,"user_id":9278225,"display_name":"CoreNoob"},"score":0,"creation_date":1548249042,"post_id":54327891,"comment_id":95474019,"body_markdown":"Same. The problem only appears if I enter a singe &quot;argument&quot;. Means without whitespaces. I try to understand how &quot;Pattern&quot; and &quot;Matcher&quot; works. Your solution looks much better. The only question I have is: How can I reuse the &quot;arguments&quot;? My final goal is to put them as arguments into methods, which the user will define with another input.","body":"Same. The problem only appears if I enter a singe &quot;argument&quot;. Means without whitespaces. I try to understand how &quot;Pattern&quot; and &quot;Matcher&quot; works. Your solution looks much better. The only question I have is: How can I reuse the &quot;arguments&quot;? My final goal is to put them as arguments into methods, which the user will define with another input."},{"owner":{"account_id":4228398,"reputation":17727,"user_id":3461397,"display_name":"Oleg Cherednik"},"score":0,"creation_date":1548249620,"post_id":54327891,"comment_id":95474347,"body_markdown":"Yes. So it seems that you could use `str.split()` instead","body":"Yes. So it seems that you could use <code>str.split()</code> instead"},{"owner":{"account_id":12824720,"reputation":115,"user_id":9278225,"display_name":"CoreNoob"},"score":0,"creation_date":1548252355,"post_id":54327891,"comment_id":95476006,"body_markdown":"Changed the line after the *do{* to *String arguments[] = whiteSpace.split(scan.nextLine().trim());* and now it works perfectly. Thanks a lot!","body":"Changed the line after the <i>do{</i> to <i>String arguments[] = whiteSpace.split(scan.nextLine().trim());</i> and now it works perfectly. Thanks a lot!"}],"tags":[],"owner":{"account_id":4228398,"reputation":17727,"user_id":3461397,"display_name":"Oleg Cherednik"},"comment_count":4,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1548252405,"creation_date":1548248481,"answer_id":54327891,"question_id":54327660,"body_markdown":"    public static void main(String... obj) {\r\n        try (Scanner scan = new Scanner(System.in)) {\r\n            final Pattern whiteSpace = Pattern.compile(&quot;\\\\s+&quot;);\r\n            System.out.println(&quot;Type your command!&quot;);\r\n    \r\n            do {\r\n                String[] args = whiteSpace.split(scan.nextLine().trim());\r\n    \r\n                if (args.length == 1 &amp;&amp; &quot;exit&quot;.equalsIgnoreCase(args[0]))\r\n                    return;\r\n    \r\n                for (int i = 0; i &lt; args.length; i++)\r\n                    System.out.println(&quot;arg&quot; + (i + 1) + &quot; = &quot; + args[i]);\r\n    \r\n                System.out.println(&quot;Type your command!&quot;);\r\n            } while (scan.hasNext());\r\n        }\r\n    }","title":"How to scan &quot;arguments&quot; from a String and leave out whitespaces?","body":"<pre><code>public static void main(String... obj) {\n    try (Scanner scan = new Scanner(System.in)) {\n        final Pattern whiteSpace = Pattern.compile(\"\\\\s+\");\n        System.out.println(\"Type your command!\");\n\n        do {\n            String[] args = whiteSpace.split(scan.nextLine().trim());\n\n            if (args.length == 1 &amp;&amp; \"exit\".equalsIgnoreCase(args[0]))\n                return;\n\n            for (int i = 0; i &lt; args.length; i++)\n                System.out.println(\"arg\" + (i + 1) + \" = \" + args[i]);\n\n            System.out.println(\"Type your command!\");\n        } while (scan.hasNext());\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":12824720,"reputation":115,"user_id":9278225,"display_name":"CoreNoob"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":113,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":54327891,"answer_count":1,"score":0,"last_activity_date":1684835818,"creation_date":1548247741,"question_id":54327660,"body_markdown":"I wanted to make the user type a command (For ex.: `transact fromWallet toWallet 12.00` ) and then get the arguments without whitespaces out of the `Scanner` and pass them to variables to call specific methods with them. I&#39;m still working on it but I managed to extract the arguments from the inputString without the methods that the Scanner provides. The `Scanner` was too problematic. It asked me to make 5 inputs, where I just needed 4 and so on. What is the &quot;better way&quot;? Is my solution okay? I ended up doing it this way (please tell me about &quot;bad practices&quot; in my code):\r\n\r\nHELP METHODS IN THE CLASS:\r\n\r\n    public static String getNextArg(String s) {\r\n\t\t// get last char\r\n\t\tint cut = s.indexOf(&quot; &quot;);\r\n\t\tif (cut == -1)\r\n\t\t\tcut = s.length();\r\n\r\n\t\t// split arg\r\n\t\tString arg = s.substring(0, cut);\r\n\r\n\t\treturn arg;\r\n\t}\r\n\r\n\tpublic static String getLeftOver(String s) {\r\n\t\tint cut = s.indexOf(&quot; &quot;);\r\n\t\tif (cut == -1)\r\n\t\t\tcut = s.length() - 1;\r\n\r\n\t\ts = s.substring(cut + 1);\r\n\t\treturn s;\r\n\t}\r\n\r\n\r\n\r\nCOMMAND PART IN THE MAIN:\r\n\r\n      String cmd = &quot;&quot;;\r\n\t\tString arg1, arg2, arg3, arg4;\r\n\r\n\t\tSystem.out.println(&quot;Type your command!&quot;);\r\n\t\tScanner cmdScanner = new Scanner(System.in);\r\n\t\tdo {\r\n\t\t\tcmd = cmdScanner.nextLine();\r\n\t\t\t\r\n\t\t\t// Check for &quot;exit&quot;\r\n\t\t\tif (cmd.length() &gt;= 4)\r\n\t\t\t\tif(cmd.substring(0, 4).equalsIgnoreCase(&quot;exit&quot;))\r\n\t\t\t\t\tSystem.exit(0); // Is this a good way to exit a program?\r\n\t\t\t\r\n\t\t\tSystem.out.println(&quot;The args passed to cmd are: &quot;);\r\n\t\t\tif (!cmd.trim().isEmpty()) {\r\n\t\t\t\targ1 = getNextArg(cmd);\r\n\t\t\t\tcmd = getLeftOver(cmd);\r\n\t\t\t\tSystem.out.println(&quot;arg1 = &quot; + arg1);\r\n\t\t\t}\r\n\t\t\tif (!cmd.trim().isEmpty()) {\r\n\t\t\t\targ2 = getNextArg(cmd);\r\n\t\t\t\tcmd = getLeftOver(cmd);\r\n\t\t\t\tSystem.out.println(&quot;arg2 = &quot; + arg2);\r\n\t\t\t}\r\n\t\t\tif (!cmd.trim().isEmpty()) {\r\n\t\t\t\targ3 = getNextArg(cmd);\r\n\t\t\t\tcmd = getLeftOver(cmd);\r\n\t\t\t\tSystem.out.println(&quot;arg3 = &quot; + arg3);\r\n\t\t\t}\r\n\t\t\tif (!cmd.trim().isEmpty()) {\r\n\t\t\t\targ4 = getNextArg(cmd);\r\n\t\t\t\tcmd = getLeftOver(cmd);\r\n\t\t\t\tSystem.out.println(&quot;arg4 = &quot; + arg4);\r\n\t\t\t}\r\n\t\t\tSystem.out.println(&quot;Type your command!&quot;);\r\n\t\t} while (cmdScanner.hasNext());\r\n\t}\r\n\r\nThe result fits my expectations. I just want to know how I could do this with the `Scanner`&#39;s `next()` methods. That could be helpful because later on I want to get the &quot;next&quot; `BigDecimal` in a proper way, and implementing own methods for everything would be a little bit to much for a noob like me.\r\n\r\n","title":"How to scan &quot;arguments&quot; from a String and leave out whitespaces?","body":"<p>I wanted to make the user type a command (For ex.: <code>transact fromWallet toWallet 12.00</code> ) and then get the arguments without whitespaces out of the <code>Scanner</code> and pass them to variables to call specific methods with them. I'm still working on it but I managed to extract the arguments from the inputString without the methods that the Scanner provides. The <code>Scanner</code> was too problematic. It asked me to make 5 inputs, where I just needed 4 and so on. What is the \"better way\"? Is my solution okay? I ended up doing it this way (please tell me about \"bad practices\" in my code):</p>\n\n<p>HELP METHODS IN THE CLASS:</p>\n\n<pre><code>public static String getNextArg(String s) {\n    // get last char\n    int cut = s.indexOf(\" \");\n    if (cut == -1)\n        cut = s.length();\n\n    // split arg\n    String arg = s.substring(0, cut);\n\n    return arg;\n}\n\npublic static String getLeftOver(String s) {\n    int cut = s.indexOf(\" \");\n    if (cut == -1)\n        cut = s.length() - 1;\n\n    s = s.substring(cut + 1);\n    return s;\n}\n</code></pre>\n\n<p>COMMAND PART IN THE MAIN:</p>\n\n<pre><code>  String cmd = \"\";\n    String arg1, arg2, arg3, arg4;\n\n    System.out.println(\"Type your command!\");\n    Scanner cmdScanner = new Scanner(System.in);\n    do {\n        cmd = cmdScanner.nextLine();\n\n        // Check for \"exit\"\n        if (cmd.length() &gt;= 4)\n            if(cmd.substring(0, 4).equalsIgnoreCase(\"exit\"))\n                System.exit(0); // Is this a good way to exit a program?\n\n        System.out.println(\"The args passed to cmd are: \");\n        if (!cmd.trim().isEmpty()) {\n            arg1 = getNextArg(cmd);\n            cmd = getLeftOver(cmd);\n            System.out.println(\"arg1 = \" + arg1);\n        }\n        if (!cmd.trim().isEmpty()) {\n            arg2 = getNextArg(cmd);\n            cmd = getLeftOver(cmd);\n            System.out.println(\"arg2 = \" + arg2);\n        }\n        if (!cmd.trim().isEmpty()) {\n            arg3 = getNextArg(cmd);\n            cmd = getLeftOver(cmd);\n            System.out.println(\"arg3 = \" + arg3);\n        }\n        if (!cmd.trim().isEmpty()) {\n            arg4 = getNextArg(cmd);\n            cmd = getLeftOver(cmd);\n            System.out.println(\"arg4 = \" + arg4);\n        }\n        System.out.println(\"Type your command!\");\n    } while (cmdScanner.hasNext());\n}\n</code></pre>\n\n<p>The result fits my expectations. I just want to know how I could do this with the <code>Scanner</code>'s <code>next()</code> methods. That could be helpful because later on I want to get the \"next\" <code>BigDecimal</code> in a proper way, and implementing own methods for everything would be a little bit to much for a noob like me.</p>\n"},{"tags":["java","spring-boot","spring-boot-actuator"],"answers":[{"comments":[{"owner":{"account_id":8932967,"reputation":1,"user_id":6671374,"display_name":"Sam"},"score":0,"creation_date":1655379689,"post_id":72645122,"comment_id":128321451,"body_markdown":"I am aware of this. What I am trying to achieve is to show all the other dependencies on which this project depends on , in the /actuator/info endpoint.  Also I need to modify the values present in the custom properties file a bit before they can be directly used.","body":"I am aware of this. What I am trying to achieve is to show all the other dependencies on which this project depends on , in the /actuator/info endpoint.  Also I need to modify the values present in the custom properties file a bit before they can be directly used."},{"owner":{"account_id":2161358,"reputation":42669,"user_id":1915448,"accept_rate":96,"display_name":"g00glen00b"},"score":0,"creation_date":1655379802,"post_id":72645122,"comment_id":128321486,"body_markdown":"@Sam In that case you may want to check the last paragraph I added. You could read your properties-file programmatically, do your modifications, put it in a `Map&lt;String, String&gt;` and call the `Info.Builder.withDetails()` method.","body":"@Sam In that case you may want to check the last paragraph I added. You could read your properties-file programmatically, do your modifications, put it in a <code>Map&lt;String, String&gt;</code> and call the <code>Info.Builder.withDetails()</code> method."}],"tags":[],"owner":{"account_id":2161358,"reputation":42669,"user_id":1915448,"accept_rate":96,"display_name":"g00glen00b"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1655379622,"creation_date":1655378981,"answer_id":72645122,"question_id":72644265,"body_markdown":"In addition to a git contributor, Spring boot also comes with a [`EnvironmentInfoContributor`](https://github.com/spring-projects/spring-boot/blob/d370d19e7a26623f0076765e257230f28e152ade/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/EnvironmentInfoContributor.java). This contributor automatically includes all application properties starting with `info.*`.\r\n\r\nSo the easiest solution is to make sure your custom properties all start with `info.*` and to treat your custom properties file as an additional application properties file. This can be done by providing the `spring.config.additional-location` VM argument. For example:\r\n\r\n```\r\njava -jar -Dspring.config.additional-location=classpath:custom-properties myApp.jar \r\n```\r\n\r\nNow you only have to enable the environment info contributor by setting:\r\n\r\n```\r\nmanagement.info.env.enabled=true\r\n```\r\n\r\nIf this isn&#39;t possible, you can indeed write your own contributor. One way of doing so is by [programmatically reading your properties](https://stackoverflow.com/q/1771166/1915448) and [converting it to a `Map&lt;String, String&gt;`](https://stackoverflow.com/questions/17209260/converting-java-util-properties-to-hashmapstring-string). Once that&#39;s done, you can call the `Info.Builder.withDetails(..)` method with your `Map` (see the source code of `EnvironmentInfoContributor`).\r\n","title":"Using .properties file in Spring Info contributor","body":"<p>In addition to a git contributor, Spring boot also comes with a <a href=\"https://github.com/spring-projects/spring-boot/blob/d370d19e7a26623f0076765e257230f28e152ade/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/EnvironmentInfoContributor.java\" rel=\"nofollow noreferrer\"><code>EnvironmentInfoContributor</code></a>. This contributor automatically includes all application properties starting with <code>info.*</code>.</p>\n<p>So the easiest solution is to make sure your custom properties all start with <code>info.*</code> and to treat your custom properties file as an additional application properties file. This can be done by providing the <code>spring.config.additional-location</code> VM argument. For example:</p>\n<pre><code>java -jar -Dspring.config.additional-location=classpath:custom-properties myApp.jar \n</code></pre>\n<p>Now you only have to enable the environment info contributor by setting:</p>\n<pre><code>management.info.env.enabled=true\n</code></pre>\n<p>If this isn't possible, you can indeed write your own contributor. One way of doing so is by <a href=\"https://stackoverflow.com/q/1771166/1915448\">programmatically reading your properties</a> and <a href=\"https://stackoverflow.com/questions/17209260/converting-java-util-properties-to-hashmapstring-string\">converting it to a <code>Map&lt;String, String&gt;</code></a>. Once that's done, you can call the <code>Info.Builder.withDetails(..)</code> method with your <code>Map</code> (see the source code of <code>EnvironmentInfoContributor</code>).</p>\n"}],"owner":{"account_id":8932967,"reputation":1,"user_id":6671374,"display_name":"Sam"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":273,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1684835083,"creation_date":1655374690,"question_id":72644265,"body_markdown":"I am writing a custom Info Contributor. I have a properties file that is generated during the build process in target/classes folder.\r\nHow Can I use this generated file in the custom info contributor.\r\n\r\nI checked the below code for [GitInfoContributor][1]\r\n\r\n```\r\npublic class GitInfoContributor extends InfoPropertiesInfoContributor&lt;GitProperties&gt; {\r\n\r\n\tpublic GitInfoContributor(GitProperties properties) {\r\n\t\tthis(properties, Mode.SIMPLE);\r\n\t}\r\n\r\n\tpublic GitInfoContributor(GitProperties properties, Mode mode) {\r\n\t\tsuper(properties, mode);\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void contribute(Info.Builder builder) {\r\n\t\tbuilder.withDetail(&quot;git&quot;, generateContent());\r\n\t}\r\n\r\n\t@Override\r\n\tprotected PropertySource&lt;?&gt; toSimplePropertySource() {\r\n\t\tProperties props = new Properties();\r\n\t\tcopyIfSet(props, &quot;branch&quot;);\r\n\t\tString commitId = getProperties().getShortCommitId();\r\n\t\tif (commitId != null) {\r\n\t\t\tprops.put(&quot;commit.id&quot;, commitId);\r\n\t\t}\r\n\t\tcopyIfSet(props, &quot;commit.time&quot;);\r\n\t\treturn new PropertiesPropertySource(&quot;git&quot;, props);\r\n\t}\r\n\r\n\t/**\r\n\t * Post-process the content to expose. By default, well known keys representing dates\r\n\t * are converted to {@link Instant} instances.\r\n\t * @param content the content to expose\r\n\t */\r\n\t@Override\r\n\tprotected void postProcessContent(Map&lt;String, Object&gt; content) {\r\n\t\treplaceValue(getNestedMap(content, &quot;commit&quot;), &quot;time&quot;, getProperties().getCommitTime());\r\n\t\treplaceValue(getNestedMap(content, &quot;build&quot;), &quot;time&quot;, getProperties().getInstant(&quot;build.time&quot;));\r\n\t}\r\n\r\n}\r\n```\r\n\r\nI am not able to figure out how the git properties are being injected to GitProperties class here ?\r\nI need to do the same for my custom info contributor using my properties file.\r\n\r\n\r\n  [1]: https://github.com/spring-projects/spring-boot/blob/v2.1.7.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/GitInfoContributor.java","title":"Using .properties file in Spring Info contributor","body":"<p>I am writing a custom Info Contributor. I have a properties file that is generated during the build process in target/classes folder.\nHow Can I use this generated file in the custom info contributor.</p>\n<p>I checked the below code for <a href=\"https://github.com/spring-projects/spring-boot/blob/v2.1.7.RELEASE/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/GitInfoContributor.java\" rel=\"nofollow noreferrer\">GitInfoContributor</a></p>\n<pre><code>public class GitInfoContributor extends InfoPropertiesInfoContributor&lt;GitProperties&gt; {\n\n    public GitInfoContributor(GitProperties properties) {\n        this(properties, Mode.SIMPLE);\n    }\n\n    public GitInfoContributor(GitProperties properties, Mode mode) {\n        super(properties, mode);\n    }\n\n    @Override\n    public void contribute(Info.Builder builder) {\n        builder.withDetail(&quot;git&quot;, generateContent());\n    }\n\n    @Override\n    protected PropertySource&lt;?&gt; toSimplePropertySource() {\n        Properties props = new Properties();\n        copyIfSet(props, &quot;branch&quot;);\n        String commitId = getProperties().getShortCommitId();\n        if (commitId != null) {\n            props.put(&quot;commit.id&quot;, commitId);\n        }\n        copyIfSet(props, &quot;commit.time&quot;);\n        return new PropertiesPropertySource(&quot;git&quot;, props);\n    }\n\n    /**\n     * Post-process the content to expose. By default, well known keys representing dates\n     * are converted to {@link Instant} instances.\n     * @param content the content to expose\n     */\n    @Override\n    protected void postProcessContent(Map&lt;String, Object&gt; content) {\n        replaceValue(getNestedMap(content, &quot;commit&quot;), &quot;time&quot;, getProperties().getCommitTime());\n        replaceValue(getNestedMap(content, &quot;build&quot;), &quot;time&quot;, getProperties().getInstant(&quot;build.time&quot;));\n    }\n\n}\n</code></pre>\n<p>I am not able to figure out how the git properties are being injected to GitProperties class here ?\nI need to do the same for my custom info contributor using my properties file.</p>\n"},{"tags":["java","android","multithreading","android-theme"],"comments":[{"owner":{"account_id":13009440,"reputation":81,"user_id":9402979,"display_name":"Isidro Rodriguez"},"score":0,"creation_date":1685034063,"post_id":76313003,"comment_id":134608305,"body_markdown":"Can you share the error stack trace?","body":"Can you share the error stack trace?"}],"answers":[{"comments":[{"owner":{"account_id":22951635,"reputation":45,"user_id":17174960,"display_name":"Arya_"},"score":0,"creation_date":1684834282,"post_id":76313109,"comment_id":134571439,"body_markdown":"how ? There are so many options ? Can u specify which one plz?","body":"how ? There are so many options ? Can u specify which one plz?"},{"owner":{"account_id":6502221,"reputation":1372,"user_id":5032541,"display_name":"Erwan Daniel"},"score":0,"creation_date":1684836108,"post_id":76313109,"comment_id":134571910,"body_markdown":"Give screenshots / names or path for the options","body":"Give screenshots / names or path for the options"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1684836118,"post_id":76313109,"comment_id":134571912,"body_markdown":"As it’s currently written, your answer is unclear. Please [edit] to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"As it’s currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/76313109/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":28652645,"reputation":14,"user_id":21939331,"display_name":"user123 user"},"comment_count":3,"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1684833385,"creation_date":1684833385,"answer_id":76313109,"question_id":76313003,"body_markdown":"It also depends upon the mobile setting in developers option you should change them.\r\n","title":"Android MultiThreading is working in Android 8.0 but not Android 11","body":"<p>It also depends upon the mobile setting in developers option you should change them.</p>\n"}],"owner":{"account_id":22951635,"reputation":45,"user_id":17174960,"display_name":"Arya_"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":41,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1684834847,"creation_date":1684832673,"question_id":76313003,"body_markdown":"```\r\n@Override\r\npublic void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\r\n\r\n        super.onViewCreated(view, savedInstanceState);\r\n        String[] themeStrings = {&quot;Light&quot;,&quot;Dark&quot;,&quot;System Default&quot;};\r\n        ListView lv = requireView().findViewById(R.id.themeChangeLV);\r\n        ArrayAdapter&lt;String&gt; ad = new ArrayAdapter&lt;String&gt;(requireContext(), android.R.layout.simple_list_item_1,themeStrings);\r\n        lv.setAdapter(ad);\r\n        \r\n\r\n        sharedPreferences = requireContext().getSharedPreferences(&quot;MODE&quot;, Context.MODE_PRIVATE);\r\n        nightMODE = sharedPreferences.getBoolean(&quot;night&quot;,false);\r\n\r\n        lv.setOnItemClickListener(new AdapterView.OnItemClickListener() {\r\n            @Override\r\n            public void onItemClick(AdapterView&lt;?&gt; adapterView, View view, int i, long l) {\r\n                editor = sharedPreferences.edit();\r\n                switch (i){\r\n                    case 0:\r\n                        new Thread(new Runnable() {\r\n                            @Override\r\n                            public void run() {\r\n                                AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);\r\n                                editor.putBoolean(getString(R.string.night),false);\r\n                                editor.putBoolean(getString(R.string.sdt),false);\r\n                                editor.apply();\r\n                            }\r\n                        }).start();\r\n                        break;\r\n                    case 1:\r\n                        new Thread(new Runnable() {\r\n                            @Override\r\n                            public void run() {\r\n                                AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);\r\n                                editor.putBoolean(getString(R.string.night),true);\r\n                                editor.putBoolean(getString(R.string.sdt),false);\r\n                                editor.apply();\r\n                            }\r\n                        }).start();\r\n                        break;\r\n                    case 2:\r\n                        editor.putBoolean(getString(R.string.sdt),true);\r\n                        editor.apply();\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n    }\r\n```\r\n\r\nThe code above me uses a new thread to change **APP THEME** so that my app doesn&#39;t go BLACK for around half a second.\r\n\r\nAnd it works in an emulator (Android 8.0), but in my phone (Android 11), what happens is on click, the app stops working? \r\n\r\nCan anyone help me this?","title":"Android MultiThreading is working in Android 8.0 but not Android 11","body":"<pre><code>@Override\npublic void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\n\n        super.onViewCreated(view, savedInstanceState);\n        String[] themeStrings = {&quot;Light&quot;,&quot;Dark&quot;,&quot;System Default&quot;};\n        ListView lv = requireView().findViewById(R.id.themeChangeLV);\n        ArrayAdapter&lt;String&gt; ad = new ArrayAdapter&lt;String&gt;(requireContext(), android.R.layout.simple_list_item_1,themeStrings);\n        lv.setAdapter(ad);\n        \n\n        sharedPreferences = requireContext().getSharedPreferences(&quot;MODE&quot;, Context.MODE_PRIVATE);\n        nightMODE = sharedPreferences.getBoolean(&quot;night&quot;,false);\n\n        lv.setOnItemClickListener(new AdapterView.OnItemClickListener() {\n            @Override\n            public void onItemClick(AdapterView&lt;?&gt; adapterView, View view, int i, long l) {\n                editor = sharedPreferences.edit();\n                switch (i){\n                    case 0:\n                        new Thread(new Runnable() {\n                            @Override\n                            public void run() {\n                                AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);\n                                editor.putBoolean(getString(R.string.night),false);\n                                editor.putBoolean(getString(R.string.sdt),false);\n                                editor.apply();\n                            }\n                        }).start();\n                        break;\n                    case 1:\n                        new Thread(new Runnable() {\n                            @Override\n                            public void run() {\n                                AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);\n                                editor.putBoolean(getString(R.string.night),true);\n                                editor.putBoolean(getString(R.string.sdt),false);\n                                editor.apply();\n                            }\n                        }).start();\n                        break;\n                    case 2:\n                        editor.putBoolean(getString(R.string.sdt),true);\n                        editor.apply();\n                        break;\n                }\n            }\n        });\n    }\n</code></pre>\n<p>The code above me uses a new thread to change <strong>APP THEME</strong> so that my app doesn't go BLACK for around half a second.</p>\n<p>And it works in an emulator (Android 8.0), but in my phone (Android 11), what happens is on click, the app stops working?</p>\n<p>Can anyone help me this?</p>\n"},{"tags":["java","selenium-webdriver","jenkins"],"comments":[{"owner":{"account_id":4599455,"reputation":2892,"user_id":3730626,"display_name":"M B"},"score":0,"creation_date":1684908194,"post_id":76310731,"comment_id":134584157,"body_markdown":"Your description is not clear. Are the tests in a different job that you are trying to trigger?","body":"Your description is not clear. Are the tests in a different job that you are trying to trigger?"},{"owner":{"account_id":20424491,"reputation":29,"user_id":15100491,"display_name":"sneedster"},"score":0,"creation_date":1684967045,"post_id":76310731,"comment_id":134596664,"body_markdown":"Yes they are. @M B","body":"Yes they are. @M B"},{"owner":{"account_id":4599455,"reputation":2892,"user_id":3730626,"display_name":"M B"},"score":0,"creation_date":1684986853,"post_id":76310731,"comment_id":134598489,"body_markdown":"What does your build trigger look like? Have you specified that the pipeline should wait until the downstream build finishes before continuing?","body":"What does your build trigger look like? Have you specified that the pipeline should wait until the downstream build finishes before continuing?"}],"answers":[{"comments":[{"owner":{"account_id":20424491,"reputation":29,"user_id":15100491,"display_name":"sneedster"},"score":0,"creation_date":1684834459,"post_id":76311237,"comment_id":134571490,"body_markdown":"I&#39;ve updated the question with a problem, I think I&#39;m halfway through","body":"I&#39;ve updated the question with a problem, I think I&#39;m halfway through"}],"tags":[],"owner":{"account_id":4599455,"reputation":2892,"user_id":3730626,"display_name":"M B"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684814987,"creation_date":1684814987,"answer_id":76311237,"question_id":76310731,"body_markdown":"You don&#39;t need to go looking for any external libraries or frameworks because Jenkins has an inbuilt `retry` keyword ([doc](https://www.jenkins.io/doc/pipeline/steps/workflow-basic-steps/#retry-retry-the-body-up-to-n-times)).\r\n\r\n```\r\nstage (&#39;selenium-tests&#39;) {\r\n    retry(3) {\r\n        &lt;tests&gt;\r\n    }\r\n}\r\n```\r\n\r\n","title":"Retry mechanism for Selenium Java tests on Jenkins to handle intermittent failures","body":"<p>You don't need to go looking for any external libraries or frameworks because Jenkins has an inbuilt <code>retry</code> keyword (<a href=\"https://www.jenkins.io/doc/pipeline/steps/workflow-basic-steps/#retry-retry-the-body-up-to-n-times\" rel=\"nofollow noreferrer\">doc</a>).</p>\n<pre><code>stage ('selenium-tests') {\n    retry(3) {\n        &lt;tests&gt;\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":20424491,"reputation":29,"user_id":15100491,"display_name":"sneedster"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":52,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1684834591,"creation_date":1684804327,"question_id":76310731,"body_markdown":"I have a set of Selenium Java tests that I run on Jenkins, and I&#39;m experiencing intermittent failures on the Jenkins environment, even though the same tests pass consistently when executed locally. I suspect these failures are caused by factors such as slow remote machines or random timeouts.\r\n\r\nI&#39;ll get reports on an element not appearing, simply due to the website not loading on time, so timeouts are frequent. They don&#39;t happen too often though.\r\n\r\nTo address this issue, I would like to implement a retry mechanism for these tests in order to increase their reliability on Jenkins. Ideally, I would like the tests to automatically retry until they pass, or at most, retry a maximum of three times. It seems that a simple retry often results in a successful execution on the subsequent attempt. Important thing to note that about 80% of the tests pass all the time, but the remaining 20% will fail, randomly, no specific tests.\r\n\r\nIs there a recommended approach or best practice for implementing such a retry mechanism in Selenium Java tests on Jenkins? Are there any libraries, frameworks, or specific techniques that can be leveraged to achieve this goal?\r\n\r\nI would appreciate any insights, suggestions, or code examples that can help me address this intermittent test failure issue on Jenkins. Thank you in advance for your assistance.\r\n\r\nI&#39;m using TestNG.\r\n\r\nEdit:\r\n\r\nI created a new pipeline item that goes as follows:\r\n\r\n```\r\npipeline {\r\n    agent any\r\n    \r\n    stages {\r\n        stage(&#39;Build&#39;) {\r\n            steps {\r\n                sh &#39;ant compile&#39;\r\n            }\r\n        }\r\n        \r\n        stage(&#39;Run Tests&#39;) {\r\n            steps {\r\n                retry(3) {\r\n                    sh &#39;ant runTests&#39;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\nHowever, when I run it, it finishes in 2 seconds, successfully, without actually doing anything. I&#39;m assuming I&#39;m missing some stuff related to the actual repository of my tests, basically, the pipeline has no idea what to run. So, how do I connect my pipeline to the build that&#39;s running my tests?","title":"Retry mechanism for Selenium Java tests on Jenkins to handle intermittent failures","body":"<p>I have a set of Selenium Java tests that I run on Jenkins, and I'm experiencing intermittent failures on the Jenkins environment, even though the same tests pass consistently when executed locally. I suspect these failures are caused by factors such as slow remote machines or random timeouts.</p>\n<p>I'll get reports on an element not appearing, simply due to the website not loading on time, so timeouts are frequent. They don't happen too often though.</p>\n<p>To address this issue, I would like to implement a retry mechanism for these tests in order to increase their reliability on Jenkins. Ideally, I would like the tests to automatically retry until they pass, or at most, retry a maximum of three times. It seems that a simple retry often results in a successful execution on the subsequent attempt. Important thing to note that about 80% of the tests pass all the time, but the remaining 20% will fail, randomly, no specific tests.</p>\n<p>Is there a recommended approach or best practice for implementing such a retry mechanism in Selenium Java tests on Jenkins? Are there any libraries, frameworks, or specific techniques that can be leveraged to achieve this goal?</p>\n<p>I would appreciate any insights, suggestions, or code examples that can help me address this intermittent test failure issue on Jenkins. Thank you in advance for your assistance.</p>\n<p>I'm using TestNG.</p>\n<p>Edit:</p>\n<p>I created a new pipeline item that goes as follows:</p>\n<pre><code>pipeline {\n    agent any\n    \n    stages {\n        stage('Build') {\n            steps {\n                sh 'ant compile'\n            }\n        }\n        \n        stage('Run Tests') {\n            steps {\n                retry(3) {\n                    sh 'ant runTests'\n                }\n            }\n        }\n    }\n}\n</code></pre>\n<p>However, when I run it, it finishes in 2 seconds, successfully, without actually doing anything. I'm assuming I'm missing some stuff related to the actual repository of my tests, basically, the pipeline has no idea what to run. So, how do I connect my pipeline to the build that's running my tests?</p>\n"},{"tags":["java","spring-boot","spring-boot-actuator","spring-data-redis","jedis"],"owner":{"account_id":16257617,"reputation":690,"user_id":11739905,"display_name":"Lavish"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":304,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1684834290,"creation_date":1684834290,"question_id":76313249,"body_markdown":"I&#39;m working with spring boot actuator - 2.6.6 and spring-boot-starter-data-redis - 2.6.6 along with  jedis client - 3.6.3 and I want to enable JMX monitoring so that the metrics of cache hit and misses can be populated in datadog client. I&#39;m creating connection beans in the following way:\r\n\r\n\r\n```\r\n    @Bean\r\n    public JedisClientConfiguration getJedisClientConfiguration() {\r\n        JedisClientConfiguration.JedisClientConfigurationBuilder builder = JedisClientConfiguration.builder();\r\n        JedisPoolConfig poolConfig = new JedisPoolConfig();\r\n        poolConfig.setJmxEnabled(true);\r\n        poolConfig.setJmxNameBase(&quot;com.example:type=Pools,name=&quot;);\r\n        poolConfig.setJmxNamePrefix(&quot;Redis Connection Pool&quot;);\r\n        poolConfig.setMaxTotal(redisPoolSize);\r\n        return builder.usePooling().poolConfig(poolConfig).build();\r\n    }\r\n\r\n    @Bean(&quot;redisTemplate&quot;)\r\n    public RedisTemplate&lt;?, ?&gt; redisTemplate(RedisConnectionFactory redisConnectionFactory) {\r\n        RedisTemplate&lt;byte[], byte[]&gt; template = new RedisTemplate&lt;byte[], byte[]&gt;();\r\n        template.setConnectionFactory(redisConnectionFactory);\r\n        template.setDefaultSerializer(new GenericJackson2JsonRedisSerializer());\r\n        return template;\r\n    }\r\n    @Bean(&quot;redisCacheManager&quot;)\r\n    public RedisCacheManager cacheManager(RedisConnectionFactory connectionFactory) {\r\n        return RedisCacheManager.builder(connectionFactory)\r\n                .cacheDefaults(RedisCacheConfiguration\r\n                        .defaultCacheConfig()\r\n                        .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(new GenericJackson2JsonRedisSerializer())))\r\n                .enableStatistics()\r\n                .build();\r\n    }\r\n```\r\nbut when I open localhost:8080/actuator/metrics, I don&#39;t see any metrics available for Redis connection. Can anyone please help here?\r\n\r\nI tried adding @ManagedAttribute on the bean but it doesn&#39;t work. \r\nI tried adding the following in my application.properties\r\n```\r\nmanagement.endpoints.jmx.domain=example-application-domain\r\nspring.jmx.unique-names=true\r\nspring.jmx.enabled=true\r\nmanagement.metrics.export.jmx.enabled=true\r\nmanagement.endpoints.jmx.exposure.include=*\r\nmanagement.endpoints.web.exposure.include=*\r\nmanagement.endpoints.enabled-by-default=true\r\nspring.redis.cache.enable-statistics=true\r\n```\r\nBut this too didn&#39;t help.","title":"Unable to access actuator metrics for spring data redis in springboot","body":"<p>I'm working with spring boot actuator - 2.6.6 and spring-boot-starter-data-redis - 2.6.6 along with  jedis client - 3.6.3 and I want to enable JMX monitoring so that the metrics of cache hit and misses can be populated in datadog client. I'm creating connection beans in the following way:</p>\n<pre><code>    @Bean\n    public JedisClientConfiguration getJedisClientConfiguration() {\n        JedisClientConfiguration.JedisClientConfigurationBuilder builder = JedisClientConfiguration.builder();\n        JedisPoolConfig poolConfig = new JedisPoolConfig();\n        poolConfig.setJmxEnabled(true);\n        poolConfig.setJmxNameBase(&quot;com.example:type=Pools,name=&quot;);\n        poolConfig.setJmxNamePrefix(&quot;Redis Connection Pool&quot;);\n        poolConfig.setMaxTotal(redisPoolSize);\n        return builder.usePooling().poolConfig(poolConfig).build();\n    }\n\n    @Bean(&quot;redisTemplate&quot;)\n    public RedisTemplate&lt;?, ?&gt; redisTemplate(RedisConnectionFactory redisConnectionFactory) {\n        RedisTemplate&lt;byte[], byte[]&gt; template = new RedisTemplate&lt;byte[], byte[]&gt;();\n        template.setConnectionFactory(redisConnectionFactory);\n        template.setDefaultSerializer(new GenericJackson2JsonRedisSerializer());\n        return template;\n    }\n    @Bean(&quot;redisCacheManager&quot;)\n    public RedisCacheManager cacheManager(RedisConnectionFactory connectionFactory) {\n        return RedisCacheManager.builder(connectionFactory)\n                .cacheDefaults(RedisCacheConfiguration\n                        .defaultCacheConfig()\n                        .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(new GenericJackson2JsonRedisSerializer())))\n                .enableStatistics()\n                .build();\n    }\n</code></pre>\n<p>but when I open localhost:8080/actuator/metrics, I don't see any metrics available for Redis connection. Can anyone please help here?</p>\n<p>I tried adding @ManagedAttribute on the bean but it doesn't work.\nI tried adding the following in my application.properties</p>\n<pre><code>management.endpoints.jmx.domain=example-application-domain\nspring.jmx.unique-names=true\nspring.jmx.enabled=true\nmanagement.metrics.export.jmx.enabled=true\nmanagement.endpoints.jmx.exposure.include=*\nmanagement.endpoints.web.exposure.include=*\nmanagement.endpoints.enabled-by-default=true\nspring.redis.cache.enable-statistics=true\n</code></pre>\n<p>But this too didn't help.</p>\n"},{"tags":["java","spring","spring-security"],"comments":[{"owner":{"account_id":1612518,"reputation":797,"user_id":1491081,"display_name":"sarath"},"score":0,"creation_date":1626778812,"post_id":68453338,"comment_id":120978862,"body_markdown":"Do you have a custom AuthenticationProvider? SO that way you can Override public Authentication authenticate(Authentication authentication) and would be able to get username by String userName = authentication.getName(); and password by String password = authentication.getCredentials().toString();","body":"Do you have a custom AuthenticationProvider? SO that way you can Override public Authentication authenticate(Authentication authentication) and would be able to get username by String userName = authentication.getName(); and password by String password = authentication.getCredentials().toString();"},{"owner":{"account_id":15841746,"reputation":6011,"user_id":11430047,"display_name":"Eleftheria Stein-Kousathana"},"score":5,"creation_date":1626779040,"post_id":68453338,"comment_id":120978925,"body_markdown":"Please be aware that storing the passwords in that way is no longer secure. You can learn more about why, as well as a better approach in the Spring Security [reference documentation](https://docs.spring.io/spring-security/site/docs/current/reference/html5/#authentication-password-storage-history).","body":"Please be aware that storing the passwords in that way is no longer secure. You can learn more about why, as well as a better approach in the Spring Security <a href=\"https://docs.spring.io/spring-security/site/docs/current/reference/html5/#authentication-password-storage-history\" rel=\"nofollow noreferrer\">reference documentation</a>."}],"answers":[{"tags":[],"owner":{"account_id":1140175,"reputation":41,"user_id":1124315,"display_name":"user1124315"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1662203960,"creation_date":1662203960,"answer_id":73591828,"question_id":68453338,"body_markdown":"A clever trick to solve this is to load the user first in your `/authenticate` method\r\n\r\nencrypt the password into the form it was stored in the database and then use a `NoOpPasswordEncoder` to compare.\r\n\r\n----\r\nEnsure you include the salt with your own `CustomUserDetails` impl\r\n\r\n----\r\nWithin your `/authenticate` method\r\nCall\r\n\r\n`final  CustomUserDetails userDetails = (CustomUserDetails) userDetailsService.loadUserByUsername(auth.getUsername());`\r\n\r\n---\r\nExtract your salt and then create an encoded password from the normal password the user provided\r\n\r\n`String encodedPassword = encode(auth.getPassword, userDetails.getSalt());`\r\n\r\n----\r\nthen pass the encodedPassword to the authenticate method\r\n\r\n`authenticationManager.authenticate(new UsernamePasswordAuthenticationToken(username, encodedPassword ));`","title":"Spring Security how to get username from PasswordEncoder?","body":"<p>A clever trick to solve this is to load the user first in your <code>/authenticate</code> method</p>\n<p>encrypt the password into the form it was stored in the database and then use a <code>NoOpPasswordEncoder</code> to compare.</p>\n<hr />\n<p>Ensure you include the salt with your own <code>CustomUserDetails</code> impl</p>\n<hr />\n<p>Within your <code>/authenticate</code> method\nCall</p>\n<p><code>final  CustomUserDetails userDetails = (CustomUserDetails) userDetailsService.loadUserByUsername(auth.getUsername());</code></p>\n<hr />\n<p>Extract your salt and then create an encoded password from the normal password the user provided</p>\n<p><code>String encodedPassword = encode(auth.getPassword, userDetails.getSalt());</code></p>\n<hr />\n<p>then pass the encodedPassword to the authenticate method</p>\n<p><code>authenticationManager.authenticate(new UsernamePasswordAuthenticationToken(username, encodedPassword ));</code></p>\n"},{"tags":[],"owner":{"account_id":28657265,"reputation":21,"user_id":21942966,"display_name":"Ivan JDev"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1684834197,"creation_date":1684786521,"answer_id":76309599,"question_id":68453338,"body_markdown":"I had a similar requirement and solved this problem by using Java thread local variables. Probably it looks ugly but I did not have much time back then and it worked for me. This is my thread local declaration\r\n\r\n        public class MySecurityContext {\r\n        private static final ThreadLocal&lt;String&gt; usernameTL = new ThreadLocal&lt;&gt;();\r\n\r\n        public static void setUsername(String username) {\r\n            usernameTL.set(username);\r\n        }\r\n\r\n        public static String getUsername() {\r\n            return usernameTL.get();\r\n        }\r\n\r\n        public static void clear() {\r\n            usernameTL.remove();\r\n        }\r\n}\r\n\r\nThen I define my UserDetailsService bean where I have the username and can place it in the thread local variable\r\n\r\n        @Bean\r\n    public UserDetailsService userDetailsService(UserRepository userRepository){\r\n        return username -&gt; {\r\n            User user = userRepository.findUserByUsername(username);\r\n            if (user != null) {\r\n                MySecurityContext.setUsername(user.getUsername());\r\n                return user;\r\n            }\r\n            throw new UsernameNotFoundException(&quot;User &#39;&quot; + username + &quot;&#39; not found&quot;);\r\n        };\r\n    }\r\n\r\nAnd finally I have my custom password encoder where I extract the thread variable value\r\n\r\n    public class DatabasePasswordEncoder implements PasswordEncoder {\r\n    private JdbcTemplate jdbcTemplate;\r\n    private String salt;\r\n\r\n    public DatabasePasswordEncoder(JdbcTemplate jdbcTemplate, String salt){\r\n        this.jdbcTemplate = jdbcTemplate;\r\n        this.salt = salt;\r\n    }\r\n\r\n    @Override\r\n    public String encode(CharSequence rawPassword) {\r\n        String username = MySecurityContext.getUsername();\r\n        String passwordString = username + salt + rawPassword.toString();\r\n        MySecurityContext.clear();\r\n\r\n","title":"Spring Security how to get username from PasswordEncoder?","body":"<p>I had a similar requirement and solved this problem by using Java thread local variables. Probably it looks ugly but I did not have much time back then and it worked for me. This is my thread local declaration</p>\n<pre><code>    public class MySecurityContext {\n    private static final ThreadLocal&lt;String&gt; usernameTL = new ThreadLocal&lt;&gt;();\n\n    public static void setUsername(String username) {\n        usernameTL.set(username);\n    }\n\n    public static String getUsername() {\n        return usernameTL.get();\n    }\n\n    public static void clear() {\n        usernameTL.remove();\n    }\n</code></pre>\n<p>}</p>\n<p>Then I define my UserDetailsService bean where I have the username and can place it in the thread local variable</p>\n<pre><code>    @Bean\npublic UserDetailsService userDetailsService(UserRepository userRepository){\n    return username -&gt; {\n        User user = userRepository.findUserByUsername(username);\n        if (user != null) {\n            MySecurityContext.setUsername(user.getUsername());\n            return user;\n        }\n        throw new UsernameNotFoundException(&quot;User '&quot; + username + &quot;' not found&quot;);\n    };\n}\n</code></pre>\n<p>And finally I have my custom password encoder where I extract the thread variable value</p>\n<pre><code>public class DatabasePasswordEncoder implements PasswordEncoder {\nprivate JdbcTemplate jdbcTemplate;\nprivate String salt;\n\npublic DatabasePasswordEncoder(JdbcTemplate jdbcTemplate, String salt){\n    this.jdbcTemplate = jdbcTemplate;\n    this.salt = salt;\n}\n\n@Override\npublic String encode(CharSequence rawPassword) {\n    String username = MySecurityContext.getUsername();\n    String passwordString = username + salt + rawPassword.toString();\n    MySecurityContext.clear();\n</code></pre>\n"}],"owner":{"account_id":10416430,"reputation":353,"user_id":11993600,"display_name":"SorryForAsking"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":590,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":2,"score":0,"last_activity_date":1684834197,"creation_date":1626776876,"question_id":68453338,"body_markdown":"When adding a new user, I save his password in the database, in the form of SHA256 (cleartext_password + salt). The salt value  I save next to it in a separate column for each user. Accordingly, the password check should be performed as follows: we extract the password cleartext from the BasicAuth header, get the salt value for this user from the database, execute SHA256 (cleartext_password + salt) and check that the resulting string and the passwored stored in the database matches. In order to implement this, I to create a custom PasswordEncoder which will perform verification, but I can&#39;t access username from PasswordEncoder. I need username to get salt for this user and execute verifcation. How can I get out of this situation?\r\n\r\nHere&#39;s the current implementation of Security:\r\n\r\n    @Configuration\r\n    public class SecurityConfig extends WebSecurityConfigurerAdapter {\r\n        private final UserDetailsService customUserDetailsService;\r\n    \r\n        public SecurityConfig(UserDetailsService customUserDetailsService) {\r\n            this.customUserDetailsService = customUserDetailsService;\r\n        }\r\n    \r\n        @Override\r\n        protected void configure(HttpSecurity http) throws Exception {\r\n            http\r\n                    .csrf().disable()\r\n                    .authorizeRequests()\r\n                    .requestMatchers(EndpointRequest.toAnyEndpoint()).permitAll()\r\n                    .anyRequest().authenticated()\r\n                    .and().httpBasic();\r\n        }\r\n    \r\n        @Override\r\n        protected void configure(AuthenticationManagerBuilder auth) throws Exception {\r\n            auth.userDetailsService(customUserDetailsService)\r\n            .passwordEncoder(new CustomPasswordEncoder());\r\n        }\r\n    \r\n    }\r\n    \r\n    @Component\r\n    public class CustomUserDetailsService implements UserDetailsService {\r\n        private final UserRepository userRepository;\r\n    \r\n        public CustomUserDetailsService(UserRepository userRepository) {\r\n            this.userRepository = userRepository;\r\n        }\r\n    \r\n        @Override\r\n        public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\r\n            User user = userRepository.findByUserName(username);\r\n            if (user != null) {\r\n                return org.springframework.security.core.userdetails.\r\n                        User.withUsername(username)\r\n                        .password(new CustomPasswordEncoder().encode(user.getPassword()))\r\n                        .roles(&quot;USER&quot;)\r\n                        .build();\r\n            }\r\n            throw new IllegalArgumentException();\r\n        }\r\n    }\r\n    \r\n    public class CustomPasswordEncoder implements PasswordEncoder {\r\n    \r\n        @Override\r\n        public String encode(CharSequence rawPassword) {\r\n            return rawPassword.toString();\r\n        }\r\n    \r\n        @Override\r\n        public boolean matches(CharSequence rawPassword, String encodedPassword) {\r\n            String sha256hex = DigestUtils.sha256Hex(rawPassword.toString()); // Here should be DigestUtils.sha256Hex(rawPassword.toString() + salt)\r\n            return sha256hex.equals(encodedPassword);\r\n        }\r\n    \r\n    }","title":"Spring Security how to get username from PasswordEncoder?","body":"<p>When adding a new user, I save his password in the database, in the form of SHA256 (cleartext_password + salt). The salt value  I save next to it in a separate column for each user. Accordingly, the password check should be performed as follows: we extract the password cleartext from the BasicAuth header, get the salt value for this user from the database, execute SHA256 (cleartext_password + salt) and check that the resulting string and the passwored stored in the database matches. In order to implement this, I to create a custom PasswordEncoder which will perform verification, but I can't access username from PasswordEncoder. I need username to get salt for this user and execute verifcation. How can I get out of this situation?</p>\n<p>Here's the current implementation of Security:</p>\n<pre><code>@Configuration\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n    private final UserDetailsService customUserDetailsService;\n\n    public SecurityConfig(UserDetailsService customUserDetailsService) {\n        this.customUserDetailsService = customUserDetailsService;\n    }\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http\n                .csrf().disable()\n                .authorizeRequests()\n                .requestMatchers(EndpointRequest.toAnyEndpoint()).permitAll()\n                .anyRequest().authenticated()\n                .and().httpBasic();\n    }\n\n    @Override\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\n        auth.userDetailsService(customUserDetailsService)\n        .passwordEncoder(new CustomPasswordEncoder());\n    }\n\n}\n\n@Component\npublic class CustomUserDetailsService implements UserDetailsService {\n    private final UserRepository userRepository;\n\n    public CustomUserDetailsService(UserRepository userRepository) {\n        this.userRepository = userRepository;\n    }\n\n    @Override\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n        User user = userRepository.findByUserName(username);\n        if (user != null) {\n            return org.springframework.security.core.userdetails.\n                    User.withUsername(username)\n                    .password(new CustomPasswordEncoder().encode(user.getPassword()))\n                    .roles(&quot;USER&quot;)\n                    .build();\n        }\n        throw new IllegalArgumentException();\n    }\n}\n\npublic class CustomPasswordEncoder implements PasswordEncoder {\n\n    @Override\n    public String encode(CharSequence rawPassword) {\n        return rawPassword.toString();\n    }\n\n    @Override\n    public boolean matches(CharSequence rawPassword, String encodedPassword) {\n        String sha256hex = DigestUtils.sha256Hex(rawPassword.toString()); // Here should be DigestUtils.sha256Hex(rawPassword.toString() + salt)\n        return sha256hex.equals(encodedPassword);\n    }\n\n}\n</code></pre>\n"},{"tags":["java","android","kotlin","android-13"],"comments":[{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1684754477,"post_id":76305189,"comment_id":134558185,"body_markdown":"Show your code. Tell what not works. It can work on SDK 33 too using the right public directory.","body":"Show your code. Tell what not works. It can work on SDK 33 too using the right public directory."},{"owner":{"account_id":24659405,"reputation":67,"user_id":18555779,"display_name":"WilliamVietnam"},"score":0,"creation_date":1684807005,"post_id":76305189,"comment_id":134567326,"body_markdown":"@blackapps I followed to this source code https://github.com/Truiton/ScreenCapture","body":"@blackapps I followed to this source code <a href=\"https://github.com/Truiton/ScreenCapture\" rel=\"nofollow noreferrer\">github.com/Truiton/ScreenCapture</a>"},{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1684815531,"post_id":76305189,"comment_id":134568017,"body_markdown":"Much too much code. All irrelevant. To demonstrate that you cannot create a file five code lines would be enough.","body":"Much too much code. All irrelevant. To demonstrate that you cannot create a file five code lines would be enough."},{"owner":{"account_id":24659405,"reputation":67,"user_id":18555779,"display_name":"WilliamVietnam"},"score":0,"creation_date":1684817125,"post_id":76305189,"comment_id":134568183,"body_markdown":"@blackapps I mean, I&#39;m in need of screen recording. And I did exactly the same code in this repository https://github.com/Truiton/ScreenCapture. And currently it only works on API 29 and below. As for API 29 and above, it doesn&#39;t work.","body":"@blackapps I mean, I&#39;m in need of screen recording. And I did exactly the same code in this repository <a href=\"https://github.com/Truiton/ScreenCapture\" rel=\"nofollow noreferrer\">github.com/Truiton/ScreenCapture</a>. And currently it only works on API 29 and below. As for API 29 and above, it doesn&#39;t work."},{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1684817260,"post_id":76305189,"comment_id":134568206,"body_markdown":"It does not work becouse you cannot store a file. So only five code lines please to demonstrate that you cannot create a file. Come to the point.","body":"It does not work becouse you cannot store a file. So only five code lines please to demonstrate that you cannot create a file. Come to the point."},{"owner":{"account_id":24659405,"reputation":67,"user_id":18555779,"display_name":"WilliamVietnam"},"score":0,"creation_date":1684817357,"post_id":76305189,"comment_id":134568219,"body_markdown":"I checked and found that WRITE_EXTERNAL_STORAGE was not granted. So I&#39;m looking forward to getting people to come up with a solution. Or the steps to solve my above problem. @blackapps","body":"I checked and found that WRITE_EXTERNAL_STORAGE was not granted. So I&#39;m looking forward to getting people to come up with a solution. Or the steps to solve my above problem. @blackapps"},{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1684833834,"post_id":76305189,"comment_id":134571336,"body_markdown":"On an Android sdk 33 device you will not ask for write exteral storage permission to begin with.","body":"On an Android sdk 33 device you will not ask for write exteral storage permission to begin with."}],"answers":[{"comments":[{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1684754628,"post_id":76305455,"comment_id":134558215,"body_markdown":"`I am guessing that you have added the storage permissions in manifest and also requested them at the runtime.` Unclear. All is not needed using ACTION_CREATE_DOCUMENT.","body":"<code>I am guessing that you have added the storage permissions in manifest and also requested them at the runtime.</code> Unclear. All is not needed using ACTION_CREATE_DOCUMENT."},{"owner":{"account_id":24659405,"reputation":67,"user_id":18555779,"display_name":"WilliamVietnam"},"score":0,"creation_date":1684807880,"post_id":76305455,"comment_id":134567395,"body_markdown":"Sorry, after checked, my this src just active on api 29 and below. On api 29 and above not working. I followed to https://github.com/Truiton/ScreenCapture. Please help me complete this function.","body":"Sorry, after checked, my this src just active on api 29 and below. On api 29 and above not working. I followed to <a href=\"https://github.com/Truiton/ScreenCapture\" rel=\"nofollow noreferrer\">github.com/Truiton/ScreenCapture</a>. Please help me complete this function."}],"tags":[],"owner":{"account_id":25155166,"reputation":864,"user_id":19000086,"display_name":"zaid khan"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1684752949,"creation_date":1684752949,"answer_id":76305455,"question_id":76305189,"body_markdown":"From Api level 29 accessing external storage has been restricted in order to improve user privacy and security so if your app is working with api level 32 then I am guessing that you have added the storage permissions in manifest and also requested them at the runtime.\r\n\r\nI have code snippet in my app that does the same function that you want .\r\n\r\n```\r\nval intent = Intent(Intent.ACTION_CREATE_DOCUMENT).apply {\r\n    addCategory(Intent.CATEGORY_OPENABLE)\r\n    type = &quot;video/mp4&quot;\r\n    putExtra(Intent.EXTRA_TITLE, &quot;my_video.mp4&quot;)\r\n}\r\n\r\nstartActivityForResult(intent, CREATE_DOCUMENT_REQUEST_CODE)\r\n```\r\nintent with the action ACTION_CREATE_DOCUMENT to create a new document.Specify the category CATEGORY_OPENABLE to allow the user to choose a location. The type specifies the MIME type of the file. In this case, we use &quot;video/mp4&quot;. The putExtra method is used to specify the default file name.\r\n\r\n```\r\noverride fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {\r\n    super.onActivityResult(requestCode, resultCode, data)\r\n\r\n    if (requestCode == CREATE_DOCUMENT_REQUEST_CODE &amp;&amp; resultCode == Activity.RESULT_OK) {\r\n        val uri: Uri? = data?.data\r\n        if (uri != null) {\r\n            // Save the video file to the chosen location\r\n            saveVideoToUri(uri)\r\n        }\r\n    }\r\n}\r\n``` \r\nThe result is RESULT_OK. If so, we retrieve the Uri of the chosen location and pass it to the saveVideoToUri function.\r\n\r\n``` \r\nfun saveVideoToUri(uri: Uri,context:Context) {\r\n    try {\r\n        context.contentResolver.openOutputStream(uri)?.use { outputStream -&gt;\r\n            // Write the video data to the output stream\r\n            outputStream.write(videoData)\r\n        }\r\n    } catch (e: IOException) {\r\n        e.printStackTrace()\r\n    }\r\n}\r\n```\r\n\r\n","title":"How to save file to storage (android 13 - API33)","body":"<p>From Api level 29 accessing external storage has been restricted in order to improve user privacy and security so if your app is working with api level 32 then I am guessing that you have added the storage permissions in manifest and also requested them at the runtime.</p>\n<p>I have code snippet in my app that does the same function that you want .</p>\n<pre><code>val intent = Intent(Intent.ACTION_CREATE_DOCUMENT).apply {\n    addCategory(Intent.CATEGORY_OPENABLE)\n    type = &quot;video/mp4&quot;\n    putExtra(Intent.EXTRA_TITLE, &quot;my_video.mp4&quot;)\n}\n\nstartActivityForResult(intent, CREATE_DOCUMENT_REQUEST_CODE)\n</code></pre>\n<p>intent with the action ACTION_CREATE_DOCUMENT to create a new document.Specify the category CATEGORY_OPENABLE to allow the user to choose a location. The type specifies the MIME type of the file. In this case, we use &quot;video/mp4&quot;. The putExtra method is used to specify the default file name.</p>\n<pre><code>override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {\n    super.onActivityResult(requestCode, resultCode, data)\n\n    if (requestCode == CREATE_DOCUMENT_REQUEST_CODE &amp;&amp; resultCode == Activity.RESULT_OK) {\n        val uri: Uri? = data?.data\n        if (uri != null) {\n            // Save the video file to the chosen location\n            saveVideoToUri(uri)\n        }\n    }\n}\n</code></pre>\n<p>The result is RESULT_OK. If so, we retrieve the Uri of the chosen location and pass it to the saveVideoToUri function.</p>\n<pre><code>fun saveVideoToUri(uri: Uri,context:Context) {\n    try {\n        context.contentResolver.openOutputStream(uri)?.use { outputStream -&gt;\n            // Write the video data to the output stream\n            outputStream.write(videoData)\n        }\n    } catch (e: IOException) {\n        e.printStackTrace()\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":22264521,"reputation":329,"user_id":20837030,"display_name":"jcredking"},"comment_count":0,"down_vote_count":1,"up_vote_count":3,"is_accepted":true,"score":2,"last_activity_date":1684752957,"creation_date":1684752957,"answer_id":76305457,"question_id":76305189,"body_markdown":"1. You need these two permissions in your manifest and ask the user for permissions programmatically \r\n\r\n       &lt;uses-permission android:name=&quot;android.permission.READ_MEDIA_VIDEO&quot; /&gt;\r\n       &lt;uses-permission android:name=&quot;android.permission.READ_MEDIA_IMAGES&quot; /&gt;\r\n2. In Android R+ you can not access storage without `MANAGE_EXTERNAL_STORAGE` [see documentation here][1] but you can access **shared storage** Like `Downloads` and your app folder.\r\n\r\n3. now you can create your folder directory using the below code \r\n\r\n        fun createAppDirectoryInDownloads(context: Context): File? {\r\n            val downloadsDirectory = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS)\r\n            val appDirectory = File(downloadsDirectory, &quot;YourAppDirectoryName&quot;)\r\n\r\n            if (!appDirectory.exists()) {\r\n                val directoryCreated = appDirectory.mkdir()\r\n                if (!directoryCreated) {\r\n                    // Failed to create the directory\r\n                    return null\r\n                }\r\n            }\r\n\r\n            return appDirectory\r\n        }\r\n4. now create your video file in your directory using below code\r\n\r\n        companion object {\r\n        @JvmStatic\r\n        fun createFileInAppDirectory(context: Context, fileName: String): File? {\r\n            val appDirectory = createAppDirectoryInDownloads(context)\r\n            if (appDirectory != null) {\r\n                val file = File(appDirectory, fileName)\r\n                try {\r\n                    if (!file.exists()) {\r\n                        val fileCreated = file.createNewFile()\r\n                        if (!fileCreated) {\r\n                            // Failed to create the file\r\n                            return null\r\n                        }\r\n                    }\r\n                    return file\r\n                } catch (e: IOException) {\r\n                    e.printStackTrace()\r\n                }\r\n            }\r\n            return null\r\n        }\r\n\r\n It&#39;s Working For me,I just hope your problem solve with this.\r\n\r\n  [1]: https://developer.android.com/training/data-storage/manage-all-files","title":"How to save file to storage (android 13 - API33)","body":"<ol>\n<li><p>You need these two permissions in your manifest and ask the user for permissions programmatically</p>\n<pre><code>&lt;uses-permission android:name=&quot;android.permission.READ_MEDIA_VIDEO&quot; /&gt;\n&lt;uses-permission android:name=&quot;android.permission.READ_MEDIA_IMAGES&quot; /&gt;\n</code></pre>\n</li>\n<li><p>In Android R+ you can not access storage without <code>MANAGE_EXTERNAL_STORAGE</code> <a href=\"https://developer.android.com/training/data-storage/manage-all-files\" rel=\"nofollow noreferrer\">see documentation here</a> but you can access <strong>shared storage</strong> Like <code>Downloads</code> and your app folder.</p>\n</li>\n<li><p>now you can create your folder directory using the below code</p>\n<pre><code> fun createAppDirectoryInDownloads(context: Context): File? {\n     val downloadsDirectory = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS)\n     val appDirectory = File(downloadsDirectory, &quot;YourAppDirectoryName&quot;)\n\n     if (!appDirectory.exists()) {\n         val directoryCreated = appDirectory.mkdir()\n         if (!directoryCreated) {\n             // Failed to create the directory\n             return null\n         }\n     }\n\n     return appDirectory\n }\n</code></pre>\n</li>\n<li><p>now create your video file in your directory using below code</p>\n<pre><code> companion object {\n @JvmStatic\n fun createFileInAppDirectory(context: Context, fileName: String): File? {\n     val appDirectory = createAppDirectoryInDownloads(context)\n     if (appDirectory != null) {\n         val file = File(appDirectory, fileName)\n         try {\n             if (!file.exists()) {\n                 val fileCreated = file.createNewFile()\n                 if (!fileCreated) {\n                     // Failed to create the file\n                     return null\n                 }\n             }\n             return file\n         } catch (e: IOException) {\n             e.printStackTrace()\n         }\n     }\n     return null\n }\n</code></pre>\n</li>\n</ol>\n<p>It's Working For me,I just hope your problem solve with this.</p>\n"},{"tags":[],"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1684833929,"creation_date":1684833929,"answer_id":76313191,"question_id":76305189,"body_markdown":"On an Android sdk 33 device you will not ask for write exteral storage permission to begin with.\r\n\r\nYou have write permission by default to all public directories on external storage.","title":"How to save file to storage (android 13 - API33)","body":"<p>On an Android sdk 33 device you will not ask for write exteral storage permission to begin with.</p>\n<p>You have write permission by default to all public directories on external storage.</p>\n"}],"owner":{"account_id":24659405,"reputation":67,"user_id":18555779,"display_name":"WilliamVietnam"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":6337,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":76305457,"answer_count":3,"score":3,"last_activity_date":1684833929,"creation_date":1684750912,"question_id":76305189,"body_markdown":"I&#39;m doing screen recording function for my app. So, I need save video mp4 files to external storage. My function active on API 29 and below, but not working on API 32 and above. Please show me steps to resolve this problem.\r\n\r\nI followed to this source code: https://github.com/Truiton/ScreenCapture\r\n\r\nMainActivity.kt\r\n\r\n    class MainActivity : AppCompatActivity() {\r\n    private var mScreenDensity = 0\r\n    private var mProjectionManager: MediaProjectionManager? = null\r\n    private var mMediaProjection: MediaProjection? = null\r\n    private var mVirtualDisplay: VirtualDisplay? = null\r\n    private var mMediaProjectionCallback: MediaProjectionCallback? = null\r\n    private var mMediaRecorder: MediaRecorder? = null\r\n    private lateinit var binding: ActivityMainBinding\r\n    public override fun onCreate(savedInstanceState: Bundle?) {\r\n        super.onCreate(savedInstanceState)\r\n        binding = ActivityMainBinding.inflate(layoutInflater)\r\n        setContentView(binding.root)\r\n        val metrics = DisplayMetrics()\r\n        windowManager.defaultDisplay.getMetrics(metrics)\r\n        mScreenDensity = metrics.densityDpi\r\n        mMediaRecorder = MediaRecorder()\r\n        mProjectionManager = getSystemService(MEDIA_PROJECTION_SERVICE) as MediaProjectionManager\r\n        binding.toggle.setOnClickListener { v: View? -&gt;\r\n            if ((ContextCompat.checkSelfPermission(\r\n                    this@MainActivity,\r\n                    Manifest.permission.WRITE_EXTERNAL_STORAGE\r\n                ) + ContextCompat\r\n                    .checkSelfPermission(\r\n                        this@MainActivity,\r\n                        Manifest.permission.RECORD_AUDIO\r\n                    ) + ContextCompat.checkSelfPermission(\r\n                    this@MainActivity,\r\n                    MANAGE_EXTERNAL_STORAGE\r\n                ))\r\n                != PackageManager.PERMISSION_GRANTED\r\n            ) {\r\n                if (ActivityCompat.shouldShowRequestPermissionRationale(\r\n                        this@MainActivity,\r\n                        Manifest.permission.WRITE_EXTERNAL_STORAGE\r\n                    ) ||\r\n                    ActivityCompat.shouldShowRequestPermissionRationale(\r\n                        this@MainActivity,\r\n                        Manifest.permission.RECORD_AUDIO\r\n                    ) || ActivityCompat.shouldShowRequestPermissionRationale(\r\n                        this@MainActivity,\r\n                        MANAGE_EXTERNAL_STORAGE\r\n                    )\r\n                ) {\r\n                    binding.toggle.isChecked = false\r\n                    Snackbar.make(\r\n                        findViewById(android.R.id.content), R.string.label_permissions,\r\n                        Snackbar.LENGTH_INDEFINITE\r\n                    ).setAction(&quot;ENABLE&quot;,\r\n                        View.OnClickListener { v1: View? -&gt;\r\n                            ActivityCompat.requestPermissions(\r\n                                this@MainActivity,\r\n                                arrayOf(\r\n                                    Manifest.permission.WRITE_EXTERNAL_STORAGE,\r\n                                    Manifest.permission.RECORD_AUDIO,\r\n                                    MANAGE_EXTERNAL_STORAGE\r\n                                ),\r\n                                REQUEST_PERMISSIONS\r\n                            )\r\n                        }).show()\r\n                } else {\r\n                    ActivityCompat.requestPermissions(\r\n                        this@MainActivity,\r\n                        arrayOf(\r\n                            Manifest.permission.WRITE_EXTERNAL_STORAGE,\r\n                            Manifest.permission.RECORD_AUDIO,\r\n                            MANAGE_EXTERNAL_STORAGE\r\n                        ),\r\n                        REQUEST_PERMISSIONS\r\n                    )\r\n                }\r\n            } else {\r\n                onToggleScreenShare(v)\r\n            }\r\n        }\r\n    }\r\n\r\n    public override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {\r\n        super.onActivityResult(requestCode, resultCode, data)\r\n        if (requestCode != REQUEST_CODE) {\r\n            Log.e(TAG, &quot;Unknown request code: $requestCode&quot;)\r\n            return\r\n        }\r\n        if (resultCode != RESULT_OK) {\r\n            Toast.makeText(\r\n                this,\r\n                &quot;Screen Cast Permission Denied&quot;, Toast.LENGTH_SHORT\r\n            ).show()\r\n            binding.toggle.isChecked = false\r\n            return\r\n        }\r\n        mMediaProjectionCallback = MediaProjectionCallback()\r\n        mMediaProjection = mProjectionManager!!.getMediaProjection(resultCode, data!!)\r\n        mMediaProjection?.registerCallback(mMediaProjectionCallback, null)\r\n        mVirtualDisplay = createVirtualDisplay()\r\n        mMediaRecorder!!.start()\r\n    }\r\n\r\n    fun onToggleScreenShare(view: View?) {\r\n        if ((view as ToggleButton?)!!.isChecked) {\r\n            initRecorder()\r\n            shareScreen()\r\n        } else {\r\n            mMediaRecorder!!.stop()\r\n            mMediaRecorder!!.reset()\r\n            Log.v(TAG, &quot;Stopping Recording&quot;)\r\n            stopScreenSharing()\r\n        }\r\n    }\r\n\r\n    private fun shareScreen() {\r\n        if (mMediaProjection == null) {\r\n            startActivityForResult(mProjectionManager!!.createScreenCaptureIntent(), REQUEST_CODE)\r\n            return\r\n        }\r\n        mVirtualDisplay = createVirtualDisplay()\r\n        mMediaRecorder!!.start()\r\n    }\r\n\r\n    private fun createVirtualDisplay(): VirtualDisplay {\r\n        return mMediaProjection!!.createVirtualDisplay(\r\n            &quot;MainActivity&quot;,\r\n            DISPLAY_WIDTH, DISPLAY_HEIGHT, mScreenDensity,\r\n            DisplayManager.VIRTUAL_DISPLAY_FLAG_AUTO_MIRROR,\r\n            mMediaRecorder!!.surface, null /*Callbacks*/, null /*Handler*/\r\n        )\r\n    }\r\n\r\n    @SuppressLint(&quot;SimpleDateFormat&quot;)\r\n    private fun initRecorder() {\r\n        try {\r\n            mMediaRecorder!!.setAudioSource(MediaRecorder.AudioSource.MIC)\r\n            mMediaRecorder!!.setVideoSource(MediaRecorder.VideoSource.SURFACE)\r\n            mMediaRecorder!!.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP)\r\n            mMediaRecorder!!.setOutputFile(\r\n                Environment\r\n                    .getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS)\r\n                    .toString() + &quot;/&quot; + &quot;Prank_Record_&quot; + SimpleDateFormat(&quot;dd-MM-yyyy-hh_mm_ss&quot;).format(\r\n                    Date()\r\n                ) + &quot;.mp4&quot;\r\n            )\r\n            mMediaRecorder!!.setVideoSize(DISPLAY_WIDTH, DISPLAY_HEIGHT)\r\n            mMediaRecorder!!.setVideoEncoder(MediaRecorder.VideoEncoder.H264)\r\n            mMediaRecorder!!.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB)\r\n            mMediaRecorder!!.setVideoEncodingBitRate(512 * 1000)\r\n            mMediaRecorder!!.setVideoFrameRate(30)\r\n            val rotation = windowManager.defaultDisplay.rotation\r\n            val orientation = ORIENTATIONS[rotation + 90]\r\n            mMediaRecorder!!.setOrientationHint(orientation)\r\n            mMediaRecorder!!.prepare()\r\n        } catch (e: IOException) {\r\n            e.printStackTrace()\r\n        }\r\n    }\r\n\r\n    private inner class MediaProjectionCallback : MediaProjection.Callback() {\r\n        override fun onStop() {\r\n            if (binding.toggle.isChecked) {\r\n                binding.toggle.isChecked = false\r\n                mMediaRecorder!!.stop()\r\n                mMediaRecorder!!.reset()\r\n                Log.v(TAG, &quot;Recording Stopped&quot;)\r\n            }\r\n            mMediaProjection = null\r\n            stopScreenSharing()\r\n        }\r\n    }\r\n\r\n    private fun stopScreenSharing() {\r\n        if (mVirtualDisplay == null) {\r\n            return\r\n        }\r\n        mVirtualDisplay!!.release()\r\n        //mMediaRecorder.release(); //If used: mMediaRecorder object cannot\r\n        // be reused again\r\n        destroyMediaProjection()\r\n    }\r\n\r\n    public override fun onDestroy() {\r\n        super.onDestroy()\r\n        destroyMediaProjection()\r\n    }\r\n\r\n    private fun destroyMediaProjection() {\r\n        if (mMediaProjection != null) {\r\n            mMediaProjection!!.unregisterCallback(mMediaProjectionCallback)\r\n            mMediaProjection!!.stop()\r\n            mMediaProjection = null\r\n        }\r\n        Log.i(TAG, &quot;MediaProjection Stopped&quot;)\r\n    }\r\n\r\n    @RequiresApi(Build.VERSION_CODES.R)\r\n    override fun onRequestPermissionsResult(\r\n        requestCode: Int,\r\n        permissions: Array&lt;String&gt;,\r\n        grantResults: IntArray\r\n    ) {\r\n        super.onRequestPermissionsResult(requestCode, permissions, grantResults)\r\n        when (requestCode) {\r\n            REQUEST_PERMISSIONS -&gt; {\r\n                if (true) {\r\n                    onToggleScreenShare(binding.toggle)\r\n                } else {\r\n                    binding.toggle.isChecked = false\r\n                    Snackbar.make(\r\n                        findViewById(android.R.id.content), R.string.label_permissions,\r\n                        Snackbar.LENGTH_INDEFINITE\r\n                    ).setAction(&quot;ENABLE&quot;,\r\n                        View.OnClickListener {\r\n                            val intent = Intent()\r\n                            intent.action = Settings.ACTION_MANAGE_APP_ALL_FILES_ACCESS_PERMISSION\r\n                            intent.addCategory(Intent.CATEGORY_DEFAULT)\r\n                            intent.data = Uri.parse(&quot;package:$packageName&quot;)\r\n                            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)\r\n                            intent.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY)\r\n                            intent.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS)\r\n                            startActivity(intent)\r\n                        }).show()\r\n                }\r\n                return\r\n            }\r\n        }\r\n    }\r\n\r\n    companion object {\r\n        private const val TAG = &quot;MainActivity&quot;\r\n        private const val REQUEST_CODE = 1000\r\n        private const val DISPLAY_WIDTH = 720\r\n        private const val DISPLAY_HEIGHT = 1280\r\n        private val ORIENTATIONS = SparseIntArray()\r\n        private const val REQUEST_PERMISSIONS = 10\r\n\r\n        init {\r\n            ORIENTATIONS.append(Surface.ROTATION_0, 90)\r\n            ORIENTATIONS.append(Surface.ROTATION_90, 0)\r\n            ORIENTATIONS.append(Surface.ROTATION_180, 270)\r\n            ORIENTATIONS.append(Surface.ROTATION_270, 180)\r\n        }\r\n    }\r\n}\r\n\r\n\r\nAndroidManifest.xml\r\n\r\n     &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot;/&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;/&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.RECORD_AUDIO&quot;/&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.MANAGE_EXTERNAL_STORAGE&quot;\r\n        tools:ignore=&quot;ScopedStorage&quot; /&gt;\r\n\r\n","title":"How to save file to storage (android 13 - API33)","body":"<p>I'm doing screen recording function for my app. So, I need save video mp4 files to external storage. My function active on API 29 and below, but not working on API 32 and above. Please show me steps to resolve this problem.</p>\n<p>I followed to this source code: <a href=\"https://github.com/Truiton/ScreenCapture\" rel=\"nofollow noreferrer\">https://github.com/Truiton/ScreenCapture</a></p>\n<p>MainActivity.kt</p>\n<pre><code>class MainActivity : AppCompatActivity() {\nprivate var mScreenDensity = 0\nprivate var mProjectionManager: MediaProjectionManager? = null\nprivate var mMediaProjection: MediaProjection? = null\nprivate var mVirtualDisplay: VirtualDisplay? = null\nprivate var mMediaProjectionCallback: MediaProjectionCallback? = null\nprivate var mMediaRecorder: MediaRecorder? = null\nprivate lateinit var binding: ActivityMainBinding\npublic override fun onCreate(savedInstanceState: Bundle?) {\n    super.onCreate(savedInstanceState)\n    binding = ActivityMainBinding.inflate(layoutInflater)\n    setContentView(binding.root)\n    val metrics = DisplayMetrics()\n    windowManager.defaultDisplay.getMetrics(metrics)\n    mScreenDensity = metrics.densityDpi\n    mMediaRecorder = MediaRecorder()\n    mProjectionManager = getSystemService(MEDIA_PROJECTION_SERVICE) as MediaProjectionManager\n    binding.toggle.setOnClickListener { v: View? -&gt;\n        if ((ContextCompat.checkSelfPermission(\n                this@MainActivity,\n                Manifest.permission.WRITE_EXTERNAL_STORAGE\n            ) + ContextCompat\n                .checkSelfPermission(\n                    this@MainActivity,\n                    Manifest.permission.RECORD_AUDIO\n                ) + ContextCompat.checkSelfPermission(\n                this@MainActivity,\n                MANAGE_EXTERNAL_STORAGE\n            ))\n            != PackageManager.PERMISSION_GRANTED\n        ) {\n            if (ActivityCompat.shouldShowRequestPermissionRationale(\n                    this@MainActivity,\n                    Manifest.permission.WRITE_EXTERNAL_STORAGE\n                ) ||\n                ActivityCompat.shouldShowRequestPermissionRationale(\n                    this@MainActivity,\n                    Manifest.permission.RECORD_AUDIO\n                ) || ActivityCompat.shouldShowRequestPermissionRationale(\n                    this@MainActivity,\n                    MANAGE_EXTERNAL_STORAGE\n                )\n            ) {\n                binding.toggle.isChecked = false\n                Snackbar.make(\n                    findViewById(android.R.id.content), R.string.label_permissions,\n                    Snackbar.LENGTH_INDEFINITE\n                ).setAction(&quot;ENABLE&quot;,\n                    View.OnClickListener { v1: View? -&gt;\n                        ActivityCompat.requestPermissions(\n                            this@MainActivity,\n                            arrayOf(\n                                Manifest.permission.WRITE_EXTERNAL_STORAGE,\n                                Manifest.permission.RECORD_AUDIO,\n                                MANAGE_EXTERNAL_STORAGE\n                            ),\n                            REQUEST_PERMISSIONS\n                        )\n                    }).show()\n            } else {\n                ActivityCompat.requestPermissions(\n                    this@MainActivity,\n                    arrayOf(\n                        Manifest.permission.WRITE_EXTERNAL_STORAGE,\n                        Manifest.permission.RECORD_AUDIO,\n                        MANAGE_EXTERNAL_STORAGE\n                    ),\n                    REQUEST_PERMISSIONS\n                )\n            }\n        } else {\n            onToggleScreenShare(v)\n        }\n    }\n}\n\npublic override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {\n    super.onActivityResult(requestCode, resultCode, data)\n    if (requestCode != REQUEST_CODE) {\n        Log.e(TAG, &quot;Unknown request code: $requestCode&quot;)\n        return\n    }\n    if (resultCode != RESULT_OK) {\n        Toast.makeText(\n            this,\n            &quot;Screen Cast Permission Denied&quot;, Toast.LENGTH_SHORT\n        ).show()\n        binding.toggle.isChecked = false\n        return\n    }\n    mMediaProjectionCallback = MediaProjectionCallback()\n    mMediaProjection = mProjectionManager!!.getMediaProjection(resultCode, data!!)\n    mMediaProjection?.registerCallback(mMediaProjectionCallback, null)\n    mVirtualDisplay = createVirtualDisplay()\n    mMediaRecorder!!.start()\n}\n\nfun onToggleScreenShare(view: View?) {\n    if ((view as ToggleButton?)!!.isChecked) {\n        initRecorder()\n        shareScreen()\n    } else {\n        mMediaRecorder!!.stop()\n        mMediaRecorder!!.reset()\n        Log.v(TAG, &quot;Stopping Recording&quot;)\n        stopScreenSharing()\n    }\n}\n\nprivate fun shareScreen() {\n    if (mMediaProjection == null) {\n        startActivityForResult(mProjectionManager!!.createScreenCaptureIntent(), REQUEST_CODE)\n        return\n    }\n    mVirtualDisplay = createVirtualDisplay()\n    mMediaRecorder!!.start()\n}\n\nprivate fun createVirtualDisplay(): VirtualDisplay {\n    return mMediaProjection!!.createVirtualDisplay(\n        &quot;MainActivity&quot;,\n        DISPLAY_WIDTH, DISPLAY_HEIGHT, mScreenDensity,\n        DisplayManager.VIRTUAL_DISPLAY_FLAG_AUTO_MIRROR,\n        mMediaRecorder!!.surface, null /*Callbacks*/, null /*Handler*/\n    )\n}\n\n@SuppressLint(&quot;SimpleDateFormat&quot;)\nprivate fun initRecorder() {\n    try {\n        mMediaRecorder!!.setAudioSource(MediaRecorder.AudioSource.MIC)\n        mMediaRecorder!!.setVideoSource(MediaRecorder.VideoSource.SURFACE)\n        mMediaRecorder!!.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP)\n        mMediaRecorder!!.setOutputFile(\n            Environment\n                .getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS)\n                .toString() + &quot;/&quot; + &quot;Prank_Record_&quot; + SimpleDateFormat(&quot;dd-MM-yyyy-hh_mm_ss&quot;).format(\n                Date()\n            ) + &quot;.mp4&quot;\n        )\n        mMediaRecorder!!.setVideoSize(DISPLAY_WIDTH, DISPLAY_HEIGHT)\n        mMediaRecorder!!.setVideoEncoder(MediaRecorder.VideoEncoder.H264)\n        mMediaRecorder!!.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB)\n        mMediaRecorder!!.setVideoEncodingBitRate(512 * 1000)\n        mMediaRecorder!!.setVideoFrameRate(30)\n        val rotation = windowManager.defaultDisplay.rotation\n        val orientation = ORIENTATIONS[rotation + 90]\n        mMediaRecorder!!.setOrientationHint(orientation)\n        mMediaRecorder!!.prepare()\n    } catch (e: IOException) {\n        e.printStackTrace()\n    }\n}\n\nprivate inner class MediaProjectionCallback : MediaProjection.Callback() {\n    override fun onStop() {\n        if (binding.toggle.isChecked) {\n            binding.toggle.isChecked = false\n            mMediaRecorder!!.stop()\n            mMediaRecorder!!.reset()\n            Log.v(TAG, &quot;Recording Stopped&quot;)\n        }\n        mMediaProjection = null\n        stopScreenSharing()\n    }\n}\n\nprivate fun stopScreenSharing() {\n    if (mVirtualDisplay == null) {\n        return\n    }\n    mVirtualDisplay!!.release()\n    //mMediaRecorder.release(); //If used: mMediaRecorder object cannot\n    // be reused again\n    destroyMediaProjection()\n}\n\npublic override fun onDestroy() {\n    super.onDestroy()\n    destroyMediaProjection()\n}\n\nprivate fun destroyMediaProjection() {\n    if (mMediaProjection != null) {\n        mMediaProjection!!.unregisterCallback(mMediaProjectionCallback)\n        mMediaProjection!!.stop()\n        mMediaProjection = null\n    }\n    Log.i(TAG, &quot;MediaProjection Stopped&quot;)\n}\n\n@RequiresApi(Build.VERSION_CODES.R)\noverride fun onRequestPermissionsResult(\n    requestCode: Int,\n    permissions: Array&lt;String&gt;,\n    grantResults: IntArray\n) {\n    super.onRequestPermissionsResult(requestCode, permissions, grantResults)\n    when (requestCode) {\n        REQUEST_PERMISSIONS -&gt; {\n            if (true) {\n                onToggleScreenShare(binding.toggle)\n            } else {\n                binding.toggle.isChecked = false\n                Snackbar.make(\n                    findViewById(android.R.id.content), R.string.label_permissions,\n                    Snackbar.LENGTH_INDEFINITE\n                ).setAction(&quot;ENABLE&quot;,\n                    View.OnClickListener {\n                        val intent = Intent()\n                        intent.action = Settings.ACTION_MANAGE_APP_ALL_FILES_ACCESS_PERMISSION\n                        intent.addCategory(Intent.CATEGORY_DEFAULT)\n                        intent.data = Uri.parse(&quot;package:$packageName&quot;)\n                        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)\n                        intent.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY)\n                        intent.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS)\n                        startActivity(intent)\n                    }).show()\n            }\n            return\n        }\n    }\n}\n\ncompanion object {\n    private const val TAG = &quot;MainActivity&quot;\n    private const val REQUEST_CODE = 1000\n    private const val DISPLAY_WIDTH = 720\n    private const val DISPLAY_HEIGHT = 1280\n    private val ORIENTATIONS = SparseIntArray()\n    private const val REQUEST_PERMISSIONS = 10\n\n    init {\n        ORIENTATIONS.append(Surface.ROTATION_0, 90)\n        ORIENTATIONS.append(Surface.ROTATION_90, 0)\n        ORIENTATIONS.append(Surface.ROTATION_180, 270)\n        ORIENTATIONS.append(Surface.ROTATION_270, 180)\n    }\n}\n</code></pre>\n<p>}</p>\n<p>AndroidManifest.xml</p>\n<pre><code> &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot;/&gt;\n&lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;/&gt;\n&lt;uses-permission android:name=&quot;android.permission.RECORD_AUDIO&quot;/&gt;\n&lt;uses-permission android:name=&quot;android.permission.MANAGE_EXTERNAL_STORAGE&quot;\n    tools:ignore=&quot;ScopedStorage&quot; /&gt;\n</code></pre>\n"},{"tags":["java","json","jsonpath","jsonparser","json-path-expression"],"answers":[{"tags":[],"owner":{"account_id":10907310,"reputation":2214,"user_id":8017666,"display_name":"SRJ"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1684833664,"creation_date":1684833664,"answer_id":76313151,"question_id":76313004,"body_markdown":"## Debugging\r\nAfter debugging jsonPath code using breakpoints in intellij IDE, Realised we need to pass Configuration in each instance of DocumentContext.\r\n\r\nFor e.g.\r\n\r\n#### Configuration\r\n\r\n```\r\n    private static final Configuration suppressExceptionConfiguration = Configuration\r\n            .defaultConfiguration()\r\n            .addOptions(Option.DEFAULT_PATH_LEAF_TO_NULL)\r\n            .addOptions(Option.SUPPRESS_EXCEPTIONS);\r\n```\r\n\r\n#### Example\r\nPass above configuration in each instance of DocumentContext to make sure configuration is always applied and not missed.\r\n\r\n```\r\n        DocumentContext jsonContext = JsonPath.using(suppressExceptionConfiguration).parse(json);\r\n        DocumentContext name = JsonPath.parse((String) jsonContext.read(&quot;$.abc.name&quot;), suppressExceptionConfiguration);\r\n\r\n```\r\n\r\n","title":"DEFAULT_PATH_LEAF_TO_NULL in jsonPath not working","body":"<h2>Debugging</h2>\n<p>After debugging jsonPath code using breakpoints in intellij IDE, Realised we need to pass Configuration in each instance of DocumentContext.</p>\n<p>For e.g.</p>\n<h4>Configuration</h4>\n<pre><code>    private static final Configuration suppressExceptionConfiguration = Configuration\n            .defaultConfiguration()\n            .addOptions(Option.DEFAULT_PATH_LEAF_TO_NULL)\n            .addOptions(Option.SUPPRESS_EXCEPTIONS);\n</code></pre>\n<h4>Example</h4>\n<p>Pass above configuration in each instance of DocumentContext to make sure configuration is always applied and not missed.</p>\n<pre><code>        DocumentContext jsonContext = JsonPath.using(suppressExceptionConfiguration).parse(json);\n        DocumentContext name = JsonPath.parse((String) jsonContext.read(&quot;$.abc.name&quot;), suppressExceptionConfiguration);\n\n</code></pre>\n"}],"owner":{"account_id":10907310,"reputation":2214,"user_id":8017666,"display_name":"SRJ"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":123,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76313151,"answer_count":1,"score":1,"last_activity_date":1684833664,"creation_date":1684832677,"question_id":76313004,"body_markdown":"## JSON \r\n```\r\n{\r\n&quot;abc&quot;: {\r\n    &quot;country&quot;: [\r\n      {\r\n        &quot;city&quot;: &quot;JODHPUR&quot;\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n## JSONPath Configuration\r\n```\r\n    private static final Configuration suppressExceptionConfiguration = Configuration\r\n            .defaultConfiguration()\r\n            .addOptions(Option.DEFAULT_PATH_LEAF_TO_NULL)\r\n            .addOptions(Option.SUPPRESS_EXCEPTIONS);\r\n```\r\n\r\n## Accessing fields\r\nI am trying to access a field which can exist in some of my sample json and also may not exist.\r\n\r\nfor e.g.\r\n```\r\n        DocumentContext jsonContext = JsonPath.using(suppressExceptionConfiguration).parse(json);\r\n\r\n        String name = jsonContext.read(&quot;$.abc.name&quot;);\r\n```\r\n\r\n## Error\r\nIt is giving me error and exiting.\r\n```\r\ncom.jayway.jsonpath.PathNotFoundException: No results for path: $[&#39;abc&#39;][&#39;name&#39;]\r\n\r\n```\r\n\r\n### Issue\r\nI would like the program to continue and return `null` for this element and this is why I used option like `Option.DEFAULT_PATH_LEAF_TO_NULL` but it is not working.\r\n\r\n## My environment\r\n#### Java 17\r\n\r\n#### JSONPath version \r\n```\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;com.jayway.jsonpath&lt;/groupId&gt;\r\n            &lt;artifactId&gt;json-path&lt;/artifactId&gt;\r\n            &lt;version&gt;2.7.0&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n```","title":"DEFAULT_PATH_LEAF_TO_NULL in jsonPath not working","body":"<h2>JSON</h2>\n<pre><code>{\n&quot;abc&quot;: {\n    &quot;country&quot;: [\n      {\n        &quot;city&quot;: &quot;JODHPUR&quot;\n      }\n    ]\n  }\n}\n</code></pre>\n<h2>JSONPath Configuration</h2>\n<pre><code>    private static final Configuration suppressExceptionConfiguration = Configuration\n            .defaultConfiguration()\n            .addOptions(Option.DEFAULT_PATH_LEAF_TO_NULL)\n            .addOptions(Option.SUPPRESS_EXCEPTIONS);\n</code></pre>\n<h2>Accessing fields</h2>\n<p>I am trying to access a field which can exist in some of my sample json and also may not exist.</p>\n<p>for e.g.</p>\n<pre><code>        DocumentContext jsonContext = JsonPath.using(suppressExceptionConfiguration).parse(json);\n\n        String name = jsonContext.read(&quot;$.abc.name&quot;);\n</code></pre>\n<h2>Error</h2>\n<p>It is giving me error and exiting.</p>\n<pre><code>com.jayway.jsonpath.PathNotFoundException: No results for path: $['abc']['name']\n\n</code></pre>\n<h3>Issue</h3>\n<p>I would like the program to continue and return <code>null</code> for this element and this is why I used option like <code>Option.DEFAULT_PATH_LEAF_TO_NULL</code> but it is not working.</p>\n<h2>My environment</h2>\n<h4>Java 17</h4>\n<h4>JSONPath version</h4>\n<pre><code>        &lt;dependency&gt;\n            &lt;groupId&gt;com.jayway.jsonpath&lt;/groupId&gt;\n            &lt;artifactId&gt;json-path&lt;/artifactId&gt;\n            &lt;version&gt;2.7.0&lt;/version&gt;\n        &lt;/dependency&gt;\n</code></pre>\n"},{"tags":["java","spring-boot","validation"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1684831086,"post_id":76312573,"comment_id":134570696,"body_markdown":"Show the view, show the controller, show your configuration. Also stating &quot;this doesn&#39;t work&quot; isn&#39;t really helpful, what doesn&#39;t work?","body":"Show the view, show the controller, show your configuration. Also stating &quot;this doesn&#39;t work&quot; isn&#39;t really helpful, what doesn&#39;t work?"}],"owner":{"account_id":19611273,"reputation":3,"user_id":14353731,"display_name":"Cibs84"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":417,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684833451,"creation_date":1684829662,"question_id":76312573,"body_markdown":"I have some problems with validations in Spring Boot 3.\r\nI have 21 fields in 6 Entities that have validations with import jakarta.validation but of these, only 2 with @NotBlank work and return in the Thymeleaf view the message I set. \r\n\r\nAll 6 fields of type LocalDateTime with @Future trigger the error in the view but do not print the message I set in the annotation.\r\nAll other fields do not throw any error in the view.\r\n\r\npom.xml\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n\txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\t&lt;parent&gt;\r\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;3.0.6&lt;/version&gt;\r\n\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n\t&lt;/parent&gt;\r\n\t&lt;groupId&gt;it.la7.travel&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;la7-travel&lt;/artifactId&gt;\r\n\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n\t&lt;name&gt;la7-travel&lt;/name&gt;\r\n\t&lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\r\n\t&lt;properties&gt;\r\n\t\t&lt;java.version&gt;17&lt;/java.version&gt;\r\n\t&lt;/properties&gt;\r\n\t&lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t\t&lt;optional&gt;true&lt;/optional&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;com.mysql&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t\r\n\t\t&lt;!-- Validator spring-boot-starter --&gt;\r\n\t\t&lt;dependency&gt; \r\n\t\t    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; \r\n\t\t    &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt; \r\n\t\t&lt;/dependency&gt;\r\n\t\t\r\n\t\t&lt;!-- Hibernate Validator --&gt;\r\n&lt;!--\t\t&lt;dependency&gt; --&gt;\r\n&lt;!--\t        &lt;groupId&gt;org.hibernate&lt;/groupId&gt;--&gt;\r\n&lt;!--\t        &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;--&gt;\r\n&lt;!--\t        &lt;version&gt;6.0.13.Final&lt;/version&gt;--&gt;\r\n&lt;!--\t    &lt;/dependency&gt; --&gt;\r\n\t\t\r\n\t\t&lt;!-- bootstrap --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t    &lt;groupId&gt;org.webjars&lt;/groupId&gt;\r\n\t\t    &lt;artifactId&gt;bootstrap&lt;/artifactId&gt;\r\n\t\t    &lt;version&gt;5.2.3&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t\r\n\t\t&lt;!-- font-awesome --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t    &lt;groupId&gt;org.webjars&lt;/groupId&gt;\r\n\t\t    &lt;artifactId&gt;font-awesome&lt;/artifactId&gt;\r\n\t\t    &lt;version&gt;6.3.0&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t\r\n\t\t&lt;!-- Vue.js --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t    &lt;groupId&gt;org.webjars.npm&lt;/groupId&gt;\r\n\t\t    &lt;artifactId&gt;vue&lt;/artifactId&gt;\r\n\t\t    &lt;version&gt;3.3.0-alpha.4&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t&lt;/dependencies&gt;\r\n\r\n\t&lt;build&gt;\r\n\t\t&lt;plugins&gt;\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n\t            &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;\r\n\t            &lt;version&gt;2.7&lt;/version&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\t\t&lt;/plugins&gt;\r\n\t&lt;/build&gt;\r\n\r\n&lt;/project&gt;\r\n\r\n```\r\nThis throws the error and prints the error-message I set in the annotation\r\n```\r\nimport jakarta.validation.constraints.Future;\r\nimport jakarta.validation.constraints.NotBlank;\r\nimport jakarta.validation.constraints.Size;\r\n\r\n@Entity\r\npublic class Ticket{\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n\r\n    @Size(max = 100, message = &quot;Max 100 characters&quot;)\r\n    @NotBlank(message = &quot;Field required&quot;)\r\n    @Column(nullable=false, length=100)\r\n    private String placeDeparture;\r\n\r\n```\r\nThis throws the error in the view but do not print the error-message I set in the annotation\r\n```\r\nimport jakarta.validation.constraints.Future;\r\nimport jakarta.validation.constraints.NotBlank;\r\nimport jakarta.validation.constraints.NotNull;\r\nimport jakarta.validation.constraints.Size;\r\n\r\n@Entity\r\npublic class CarRental{\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n    \r\n    @Future(message=&quot;Future Date required&quot;)\r\n    @Column(nullable=false, columnDefinition = &quot;DATETIME&quot;)\r\n    private LocalDateTime dateTimeRedelivery;\r\n```\r\nThis doesn&#39;t throws any error in the view\r\n```\r\nimport jakarta.validation.constraints.Future;\r\nimport jakarta.validation.constraints.NotBlank;\r\nimport jakarta.validation.constraints.NotNull;\r\nimport jakarta.validation.constraints.Size;\r\n\r\n@Entity\r\npublic class CarRental{\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n    \r\n    @Size(max = 100, message = &quot;Max 100 characters&quot;)\r\n    @NotBlank(message = &quot;Field required&quot;)\r\n    @Column(nullable=false, length=100)\r\n    private String placePickup;\r\n```","title":"Spring Boot validation with jakarta.validation doesn&#39;t work","body":"<p>I have some problems with validations in Spring Boot 3.\nI have 21 fields in 6 Entities that have validations with import jakarta.validation but of these, only 2 with @NotBlank work and return in the Thymeleaf view the message I set.</p>\n<p>All 6 fields of type LocalDateTime with @Future trigger the error in the view but do not print the message I set in the annotation.\nAll other fields do not throw any error in the view.</p>\n<p>pom.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.0.6&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;it.la7.travel&lt;/groupId&gt;\n    &lt;artifactId&gt;la7-travel&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;la7-travel&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        \n        &lt;!-- Validator spring-boot-starter --&gt;\n        &lt;dependency&gt; \n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; \n            &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt; \n        &lt;/dependency&gt;\n        \n        &lt;!-- Hibernate Validator --&gt;\n&lt;!--        &lt;dependency&gt; --&gt;\n&lt;!--            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;--&gt;\n&lt;!--            &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;--&gt;\n&lt;!--            &lt;version&gt;6.0.13.Final&lt;/version&gt;--&gt;\n&lt;!--        &lt;/dependency&gt; --&gt;\n        \n        &lt;!-- bootstrap --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.webjars&lt;/groupId&gt;\n            &lt;artifactId&gt;bootstrap&lt;/artifactId&gt;\n            &lt;version&gt;5.2.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        &lt;!-- font-awesome --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.webjars&lt;/groupId&gt;\n            &lt;artifactId&gt;font-awesome&lt;/artifactId&gt;\n            &lt;version&gt;6.3.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        &lt;!-- Vue.js --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.webjars.npm&lt;/groupId&gt;\n            &lt;artifactId&gt;vue&lt;/artifactId&gt;\n            &lt;version&gt;3.3.0-alpha.4&lt;/version&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.7&lt;/version&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n\n</code></pre>\n<p>This throws the error and prints the error-message I set in the annotation</p>\n<pre><code>import jakarta.validation.constraints.Future;\nimport jakarta.validation.constraints.NotBlank;\nimport jakarta.validation.constraints.Size;\n\n@Entity\npublic class Ticket{\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Size(max = 100, message = &quot;Max 100 characters&quot;)\n    @NotBlank(message = &quot;Field required&quot;)\n    @Column(nullable=false, length=100)\n    private String placeDeparture;\n\n</code></pre>\n<p>This throws the error in the view but do not print the error-message I set in the annotation</p>\n<pre><code>import jakarta.validation.constraints.Future;\nimport jakarta.validation.constraints.NotBlank;\nimport jakarta.validation.constraints.NotNull;\nimport jakarta.validation.constraints.Size;\n\n@Entity\npublic class CarRental{\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n    \n    @Future(message=&quot;Future Date required&quot;)\n    @Column(nullable=false, columnDefinition = &quot;DATETIME&quot;)\n    private LocalDateTime dateTimeRedelivery;\n</code></pre>\n<p>This doesn't throws any error in the view</p>\n<pre><code>import jakarta.validation.constraints.Future;\nimport jakarta.validation.constraints.NotBlank;\nimport jakarta.validation.constraints.NotNull;\nimport jakarta.validation.constraints.Size;\n\n@Entity\npublic class CarRental{\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n    \n    @Size(max = 100, message = &quot;Max 100 characters&quot;)\n    @NotBlank(message = &quot;Field required&quot;)\n    @Column(nullable=false, length=100)\n    private String placePickup;\n</code></pre>\n"},{"tags":["java","intellij-idea","java-14","java-record"],"comments":[{"owner":{"account_id":1939636,"reputation":28467,"user_id":1746118,"accept_rate":95,"display_name":"Naman"},"score":0,"creation_date":1597193689,"post_id":63366167,"comment_id":112051913,"body_markdown":"IntelliJ is pretty good at broadcasting and documenting their feature releases. All it would have needed is to search it over the net. Besides the current question, doesn&#39;t have any debugging details.","body":"IntelliJ is pretty good at broadcasting and documenting their feature releases. All it would have needed is to search it over the net. Besides the current question, doesn&#39;t have any debugging details."}],"answers":[{"comments":[{"owner":{"account_id":213468,"reputation":103500,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1684830304,"post_id":63366300,"comment_id":134570511,"body_markdown":"Given records were a preview feature in Java 14 (the feature was finalized with Java 16), and IntelliJ only supports preview features of actively supported Java versions, this will no longer work. And even when it did work, this answer is missing the step to set the language level to _&quot;14 (preview)&quot;_ (which, again, is no longer possible in current IntelliJ versions).","body":"Given records were a preview feature in Java 14 (the feature was finalized with Java 16), and IntelliJ only supports preview features of actively supported Java versions, this will no longer work. And even when it did work, this answer is missing the step to set the language level to <i>&quot;14 (preview)&quot;</i> (which, again, is no longer possible in current IntelliJ versions)."}],"tags":[],"owner":{"account_id":1674243,"reputation":10078,"user_id":1553537,"accept_rate":29,"display_name":"Giorgi Tsiklauri"},"comment_count":1,"down_vote_count":0,"up_vote_count":5,"is_accepted":true,"score":5,"last_activity_date":1597182988,"creation_date":1597179597,"answer_id":63366300,"question_id":63366167,"body_markdown":"1. Make sure you have an updated version of the IntelliJ IDEA (2020.1 or later);\r\n2. Go to the Project Structure and set your *Project Language Level* to `Java 14` (remember, as well, to set `Java 14` as your *Project SDK*, if not done yet).\r\n\r\nSee more [here][1].\r\n\r\n[1]: https://blog.jetbrains.com/idea/2020/03/java-14-and-intellij-idea/#:~:text=Configure%20IntelliJ%20IDEA%202020.1%20to,IntelliJ%20IDEA%20and%20configure%20it.\r\n","title":"How can I enable Java 14 records in IntelliJ IDEA?","body":"<ol>\n<li>Make sure you have an updated version of the IntelliJ IDEA (2020.1 or later);</li>\n<li>Go to the Project Structure and set your <em>Project Language Level</em> to <code>Java 14</code> (remember, as well, to set <code>Java 14</code> as your <em>Project SDK</em>, if not done yet).</li>\n</ol>\n<p>See more <a href=\"https://blog.jetbrains.com/idea/2020/03/java-14-and-intellij-idea/#:%7E:text=Configure%20IntelliJ%20IDEA%202020.1%20to,IntelliJ%20IDEA%20and%20configure%20it.\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}],"owner":{"account_id":7281815,"reputation":168,"user_id":5551321,"display_name":"Ramath"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3623,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"accepted_answer_id":63366300,"answer_count":1,"score":1,"last_activity_date":1684831968,"creation_date":1597178931,"question_id":63366167,"body_markdown":"I cannot create Java record class in IntelliJ, and I could not find the option to enable it.\r\n\r\nIs there a way to enable it?","title":"How can I enable Java 14 records in IntelliJ IDEA?","body":"<p>I cannot create Java record class in IntelliJ, and I could not find the option to enable it.</p>\n<p>Is there a way to enable it?</p>\n"},{"tags":["java","hibernate","jpa","apache-tomee"],"answers":[{"comments":[{"owner":{"account_id":5701984,"reputation":5646,"user_id":4506678,"accept_rate":55,"display_name":"rzo1"},"score":0,"creation_date":1684908511,"post_id":76312857,"comment_id":134584208,"body_markdown":"It is a good question @DDD ! (I also run into it today after an automated update)","body":"It is a good question @DDD ! (I also run into it today after an automated update)"},{"owner":{"account_id":3567133,"reputation":623,"user_id":2978362,"accept_rate":67,"display_name":"vsriram92"},"score":0,"creation_date":1690887188,"post_id":76312857,"comment_id":135412680,"body_markdown":"In my case I was not using UUID generators. I was using conflicting implementation with Spring boot 3.1 and Jakarta Persistence API 3.0 which was causing this issue. After updating Jakarta Persistence API in pom.xml to 3.1, the issue got fixed.","body":"In my case I was not using UUID generators. I was using conflicting implementation with Spring boot 3.1 and Jakarta Persistence API 3.0 which was causing this issue. After updating Jakarta Persistence API in pom.xml to 3.1, the issue got fixed."},{"owner":{"account_id":3395647,"reputation":8928,"user_id":2849346,"accept_rate":50,"display_name":"MWiesner"},"score":0,"creation_date":1698075659,"post_id":76312857,"comment_id":136356277,"body_markdown":"For me, the suggested solution worked fine. Thx for sharing it here.","body":"For me, the suggested solution worked fine. Thx for sharing it here."}],"tags":[],"owner":{"account_id":5701984,"reputation":5646,"user_id":4506678,"accept_rate":55,"display_name":"rzo1"},"comment_count":3,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1684831705,"creation_date":1684831705,"answer_id":76312857,"question_id":76296222,"body_markdown":"TomEE 9.0.0 is compatible with Jakarta EE 9.1, which includes JPA 3.0.\r\n\r\nHibernate 6.2.x implements JPA 3.1 which includes [API changes such as introducing UUID generators][1].\r\n\r\nThese spec changes aren&#39;t included in the API shade, which is used in TomEE 9. To fix your issue, you need to downgrade Hibernate to it&#39;s 6.1 series, which complies with JPA 3.0.\r\n\r\n  [1]: https://projects.eclipse.org/projects/ee4j.jpa/releases/3.1","title":"TomEE 9 fails to load persistence unit with Hibernate 6.2 - NoSuchFieldError: UUID","body":"<p>TomEE 9.0.0 is compatible with Jakarta EE 9.1, which includes JPA 3.0.</p>\n<p>Hibernate 6.2.x implements JPA 3.1 which includes <a href=\"https://projects.eclipse.org/projects/ee4j.jpa/releases/3.1\" rel=\"nofollow noreferrer\">API changes such as introducing UUID generators</a>.</p>\n<p>These spec changes aren't included in the API shade, which is used in TomEE 9. To fix your issue, you need to downgrade Hibernate to it's 6.1 series, which complies with JPA 3.0.</p>\n"}],"owner":{"account_id":26322680,"reputation":23,"user_id":19984474,"display_name":"DDD"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1285,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":76312857,"answer_count":1,"score":2,"last_activity_date":1684831779,"creation_date":1684600008,"question_id":76296222,"body_markdown":"I&#39;m trying to start a TomEE server in version 9.0.0 and deploy a simple webapp.\r\n\r\nI&#39;m using Hibernate 6.2.2 as the provider for jpa and postgres\r\n\r\nWhen i deploy the .war it gives me these errors (the stack is long i just put the severe):\r\n\r\n```\r\n SEVERE [http-nio-8080-exec-3] jdk.internal.reflect.NativeMethodAccessorImpl.invoke Error destroying child org.apache.catalina.LifecycleException: An invalid Lifecycle transition was attempted ([before_destroy]) for component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/servlet-jsp-jdbc-jpa]] in state [STARTING_PREP]\r\n---------------------\r\nSEVERE [http-nio-8080-exec-3] org.apache.openejb.assembler.classic.Assembler.destroyApplication undeployException original cause java.lang.Exception: deployment not found: servlet-jsp-jdbc-jpa.Comp669096535\r\n-------------------------\r\nSEVERE [http-nio-8080-exec-3] org.apache.openejb.assembler.classic.Assembler.destroyApplication undeployException original cause java.lang.Exception: persistence-unit: pu 1912458056localhost: Name &quot;openejb/PersistenceUnit/pu 1912458056localhost&quot; not found. \r\n.... \r\nCaused by: javax.naming.NameNotFoundException: Name &quot;openejb/PersistenceUnit/pu 1912458056localhost&quot; not found.\r\n---------------------------\r\nSEVERE [http-nio-8080-exec-3] org.apache.tomee.catalina.TomcatWebAppBuilder.startInternal Unable to deploy collapsed ear in war StandardEngine[Catalina].StandardHost[localhost].StandardContext[/servlet-jsp-jdbc-jpa] org.apache.openejb.OpenEJBException: Creating application failed: C:\\apache-tomee-microprofile-9.0.0\\webapps\\servlet-jsp-jdbc-jpa: UUID \r\n.......... \r\nCaused by: java.lang.NoSuchFieldError: UUID\r\n----------------------------\r\nSEVERE [http-nio-8080-exec-3] jdk.internal.reflect.NativeMethodAccessorImpl.invoke Error deploying web application archive [C:\\apache-tomee-microprofile-9.0.0\\webapps\\servlet-jsp-jdbc-jpa.war] java.lang.IllegalStateException: Error starting child \r\n........ \r\nCaused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/servlet-jsp-jdbc-jpa]] .............. \r\nCaused by: org.apache.tomee.catalina.TomEERuntimeException: org.apache.openejb.OpenEJBException: Creating application failed: C:\\apache-tomee-microprofile-9.0.0\\webapps\\servlet-jsp-jdbc-jpa: UUID \r\n.........\r\n Caused by: org.apache.openejb.OpenEJBException: Creating application failed: C:\\apache-tomee-microprofile-9.0.0\\webapps\\servlet-jsp-jdbc-jpa: UUID \r\n.......... \r\nCaused by: java.lang.NoSuchFieldError: UUID \r\n.........\r\n```\r\n\r\nThe structure is:\r\n\r\n- webapp\r\n\r\n  - META-INF\r\n\r\n    - persistence.xml\r\n\r\n    - context.xml\r\n\r\n  - WEB-INF\r\n\r\n    - web.xml\r\n\r\n    classes (where i put all the compiled classes)\r\n\r\n    - lib\r\n\r\n      - hibernate-core-6.2.2.Final.jar\r\n\r\n  - index.html\r\n\r\npersistence.xml:\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;persistence version=&quot;2.2&quot;\r\n             xmlns=&quot;http://xmlns.jcp.org/xml/ns/persistence&quot;\r\n             xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n             xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/persistence\r\n                                 http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd&quot;&gt;\r\n\r\n    &lt;!-- NO JNDI --&gt;\r\n    &lt;persistence-unit name=&quot;pu&quot; transaction-type=&quot;RESOURCE_LOCAL&quot;&gt;\r\n        &lt;provider&gt;org.hibernate.jpa.HibernatePersistenceProvider&lt;/provider&gt;\r\n        &lt;properties&gt;\r\n            &lt;property name=&quot;jakarta.persistence.jdbc.driver&quot; value=&quot;org.postgresql.Driver&quot;/&gt;\r\n            &lt;property name=&quot;jakarta.persistence.jdbc.url&quot; value=&quot;jdbc:postgresql://localhost/MVC?currentSchema=public&amp;amp;ssl=false&quot;/&gt;\r\n            &lt;property name=&quot;jakarta.persistence.jdbc.user&quot; value=&quot;******&quot;/&gt;\r\n            &lt;property name=&quot;jakarta.persistence.jdbc.password&quot; value=&quot;********&quot;/&gt;\r\n            &lt;property name=&quot;hibernate.show_sql&quot; value=&quot;true&quot; /&gt;\r\n        &lt;/properties&gt;\r\n    &lt;/persistence-unit&gt;\r\n\r\n&lt;/persistence&gt;\r\n```\r\n\r\ncontext.xml\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;Context path=&quot;/servlet-jsp-jdbc-jpa&quot; &gt;\r\n&lt;/Context&gt;\r\n```\r\n\r\nweb.xml\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;web-app&gt;\r\n    &lt;display-name&gt;servlet_jsp_jdbc_jpa&lt;/display-name&gt;\r\n&lt;/web-app&gt;\r\n```\r\n\r\nThese are the classes that are using the persistence-unit\r\n\r\n```\r\npackage jpa;\r\n\r\nimport jakarta.persistence.EntityManagerFactory;\r\nimport jakarta.persistence.Persistence;\r\nimport jakarta.persistence.PersistenceUnit;\r\n\r\npublic class PersistenceManager {\r\n\r\n    //@PersistenceUnit(unitName=&quot;JTA-pu&quot;)\r\n    private static final EntityManagerFactory emf;\r\n\r\n    static {\r\n        emf = Persistence.createEntityManagerFactory(&quot;pu&quot;);\r\n    }\r\n\r\n    private PersistenceManager() {\r\n    }\r\n\r\n    public static EntityManagerFactory getEmf() {\r\n        return emf;\r\n    }\r\n}\r\n```\r\n\r\n```\r\npackage filters;\r\n\r\nimport jakarta.persistence.EntityManager;\r\nimport jakarta.persistence.EntityManagerFactory;\r\nimport jakarta.persistence.PersistenceContext;\r\nimport jakarta.persistence.PersistenceUnit;\r\nimport jakarta.servlet.*;\r\nimport jakarta.servlet.annotation.WebFilter;\r\nimport jakarta.servlet.http.HttpFilter;\r\nimport jakarta.servlet.http.HttpServletRequest;\r\nimport jakarta.servlet.http.HttpServletResponse;\r\nimport jpa.PersistenceManager;\r\n\r\nimport java.io.IOException;\r\n\r\n@WebFilter(value=&quot;/*&quot;)\r\npublic class SessionBinderFilter extends HttpFilter {\r\n\r\n    // @PersistenceUnit(unitName=&quot;JTA-pu&quot;)\r\n    private EntityManagerFactory emf = PersistenceManager.getEmf();\r\n\r\n    // @PersistenceContext(unitName=&quot;JTA-pu&quot;)\r\n    private EntityManager em = emf.createEntityManager();\r\n\r\n    @Override\r\n    public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException {\r\n\r\n        if (!(request instanceof HttpServletRequest) || !(response instanceof HttpServletResponse)) {\r\n            throw new ServletException(&quot;non-HTTP request or response&quot;);\r\n        }\r\n\r\n        request.setAttribute(&quot;EntityManager&quot;, em);\r\n\r\n        filterChain.doFilter(request, response);\r\n\r\n        if (em.isOpen()) {\r\n            em.close();\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nI can t understand the problem because i&#39;m quite new on jpa and i searched a lot but i didn t find anything.\r\n\r\nI tried also with JTA and RESOURCE_LOCAL with JNDI but nothing works, the problem is the same.\r\n\r\nAny suggest or information is appreciated","title":"TomEE 9 fails to load persistence unit with Hibernate 6.2 - NoSuchFieldError: UUID","body":"<p>I'm trying to start a TomEE server in version 9.0.0 and deploy a simple webapp.</p>\n<p>I'm using Hibernate 6.2.2 as the provider for jpa and postgres</p>\n<p>When i deploy the .war it gives me these errors (the stack is long i just put the severe):</p>\n<pre><code> SEVERE [http-nio-8080-exec-3] jdk.internal.reflect.NativeMethodAccessorImpl.invoke Error destroying child org.apache.catalina.LifecycleException: An invalid Lifecycle transition was attempted ([before_destroy]) for component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/servlet-jsp-jdbc-jpa]] in state [STARTING_PREP]\n---------------------\nSEVERE [http-nio-8080-exec-3] org.apache.openejb.assembler.classic.Assembler.destroyApplication undeployException original cause java.lang.Exception: deployment not found: servlet-jsp-jdbc-jpa.Comp669096535\n-------------------------\nSEVERE [http-nio-8080-exec-3] org.apache.openejb.assembler.classic.Assembler.destroyApplication undeployException original cause java.lang.Exception: persistence-unit: pu 1912458056localhost: Name &quot;openejb/PersistenceUnit/pu 1912458056localhost&quot; not found. \n.... \nCaused by: javax.naming.NameNotFoundException: Name &quot;openejb/PersistenceUnit/pu 1912458056localhost&quot; not found.\n---------------------------\nSEVERE [http-nio-8080-exec-3] org.apache.tomee.catalina.TomcatWebAppBuilder.startInternal Unable to deploy collapsed ear in war StandardEngine[Catalina].StandardHost[localhost].StandardContext[/servlet-jsp-jdbc-jpa] org.apache.openejb.OpenEJBException: Creating application failed: C:\\apache-tomee-microprofile-9.0.0\\webapps\\servlet-jsp-jdbc-jpa: UUID \n.......... \nCaused by: java.lang.NoSuchFieldError: UUID\n----------------------------\nSEVERE [http-nio-8080-exec-3] jdk.internal.reflect.NativeMethodAccessorImpl.invoke Error deploying web application archive [C:\\apache-tomee-microprofile-9.0.0\\webapps\\servlet-jsp-jdbc-jpa.war] java.lang.IllegalStateException: Error starting child \n........ \nCaused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/servlet-jsp-jdbc-jpa]] .............. \nCaused by: org.apache.tomee.catalina.TomEERuntimeException: org.apache.openejb.OpenEJBException: Creating application failed: C:\\apache-tomee-microprofile-9.0.0\\webapps\\servlet-jsp-jdbc-jpa: UUID \n.........\n Caused by: org.apache.openejb.OpenEJBException: Creating application failed: C:\\apache-tomee-microprofile-9.0.0\\webapps\\servlet-jsp-jdbc-jpa: UUID \n.......... \nCaused by: java.lang.NoSuchFieldError: UUID \n.........\n</code></pre>\n<p>The structure is:</p>\n<ul>\n<li><p>webapp</p>\n<ul>\n<li><p>META-INF</p>\n<ul>\n<li><p>persistence.xml</p>\n</li>\n<li><p>context.xml</p>\n</li>\n</ul>\n</li>\n<li><p>WEB-INF</p>\n<ul>\n<li>web.xml</li>\n</ul>\n<p>classes (where i put all the compiled classes)</p>\n<ul>\n<li><p>lib</p>\n<ul>\n<li>hibernate-core-6.2.2.Final.jar</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>index.html</p>\n</li>\n</ul>\n</li>\n</ul>\n<p>persistence.xml:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;persistence version=&quot;2.2&quot;\n             xmlns=&quot;http://xmlns.jcp.org/xml/ns/persistence&quot;\n             xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n             xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/persistence\n                                 http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd&quot;&gt;\n\n    &lt;!-- NO JNDI --&gt;\n    &lt;persistence-unit name=&quot;pu&quot; transaction-type=&quot;RESOURCE_LOCAL&quot;&gt;\n        &lt;provider&gt;org.hibernate.jpa.HibernatePersistenceProvider&lt;/provider&gt;\n        &lt;properties&gt;\n            &lt;property name=&quot;jakarta.persistence.jdbc.driver&quot; value=&quot;org.postgresql.Driver&quot;/&gt;\n            &lt;property name=&quot;jakarta.persistence.jdbc.url&quot; value=&quot;jdbc:postgresql://localhost/MVC?currentSchema=public&amp;amp;ssl=false&quot;/&gt;\n            &lt;property name=&quot;jakarta.persistence.jdbc.user&quot; value=&quot;******&quot;/&gt;\n            &lt;property name=&quot;jakarta.persistence.jdbc.password&quot; value=&quot;********&quot;/&gt;\n            &lt;property name=&quot;hibernate.show_sql&quot; value=&quot;true&quot; /&gt;\n        &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n\n&lt;/persistence&gt;\n</code></pre>\n<p>context.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;Context path=&quot;/servlet-jsp-jdbc-jpa&quot; &gt;\n&lt;/Context&gt;\n</code></pre>\n<p>web.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;web-app&gt;\n    &lt;display-name&gt;servlet_jsp_jdbc_jpa&lt;/display-name&gt;\n&lt;/web-app&gt;\n</code></pre>\n<p>These are the classes that are using the persistence-unit</p>\n<pre><code>package jpa;\n\nimport jakarta.persistence.EntityManagerFactory;\nimport jakarta.persistence.Persistence;\nimport jakarta.persistence.PersistenceUnit;\n\npublic class PersistenceManager {\n\n    //@PersistenceUnit(unitName=&quot;JTA-pu&quot;)\n    private static final EntityManagerFactory emf;\n\n    static {\n        emf = Persistence.createEntityManagerFactory(&quot;pu&quot;);\n    }\n\n    private PersistenceManager() {\n    }\n\n    public static EntityManagerFactory getEmf() {\n        return emf;\n    }\n}\n</code></pre>\n<pre><code>package filters;\n\nimport jakarta.persistence.EntityManager;\nimport jakarta.persistence.EntityManagerFactory;\nimport jakarta.persistence.PersistenceContext;\nimport jakarta.persistence.PersistenceUnit;\nimport jakarta.servlet.*;\nimport jakarta.servlet.annotation.WebFilter;\nimport jakarta.servlet.http.HttpFilter;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport jpa.PersistenceManager;\n\nimport java.io.IOException;\n\n@WebFilter(value=&quot;/*&quot;)\npublic class SessionBinderFilter extends HttpFilter {\n\n    // @PersistenceUnit(unitName=&quot;JTA-pu&quot;)\n    private EntityManagerFactory emf = PersistenceManager.getEmf();\n\n    // @PersistenceContext(unitName=&quot;JTA-pu&quot;)\n    private EntityManager em = emf.createEntityManager();\n\n    @Override\n    public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException {\n\n        if (!(request instanceof HttpServletRequest) || !(response instanceof HttpServletResponse)) {\n            throw new ServletException(&quot;non-HTTP request or response&quot;);\n        }\n\n        request.setAttribute(&quot;EntityManager&quot;, em);\n\n        filterChain.doFilter(request, response);\n\n        if (em.isOpen()) {\n            em.close();\n        }\n    }\n}\n</code></pre>\n<p>I can t understand the problem because i'm quite new on jpa and i searched a lot but i didn t find anything.</p>\n<p>I tried also with JTA and RESOURCE_LOCAL with JNDI but nothing works, the problem is the same.</p>\n<p>Any suggest or information is appreciated</p>\n"},{"tags":["java","android-studio","okhttp"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1677991183,"post_id":75591000,"comment_id":133445280,"body_markdown":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.","body":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking."}],"owner":{"account_id":19789999,"reputation":9,"user_id":14493205,"display_name":"Tsandesh"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":2445,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1684831479,"creation_date":1677581428,"question_id":75591000,"body_markdown":"The error is showing:\r\n\r\n&gt; failed to respond due to okhttp3.internal.http.RealResponseBody@9fce4c6\r\n\r\nThis is my code:\r\n```java\r\n@Override\r\npublic void onResponse(@NonNull Call call, @NonNull Response response) throws IOException {\r\n    if(response.isSuccessful()){\r\n        JSONObject jsonObject = null;\r\n        try {\r\n            jsonObject = new JSONObject(response.body().string());\r\n            JSONArray jsonArray = jsonObject.getJSONArray(&quot;choices&quot;);\r\n            String result = jsonArray.getJSONObject(0).getString(&quot;text&quot;);\r\n            addResponse(result.trim());\r\n\r\n        } catch (JSONException e) {\r\n            e.printStackTrace();\r\n        }\r\n\r\n    }else{\r\n        addResponse(&quot;Failed to response due to &quot;+response.body().toString());\r\n    }\r\n}\r\n```","title":"Failed to respond due to okhttp3.internal.http.RealResponseBody@9fce4c6","body":"<p>The error is showing:</p>\n<blockquote>\n<p>failed to respond due to okhttp3.internal.http.RealResponseBody@9fce4c6</p>\n</blockquote>\n<p>This is my code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Override\npublic void onResponse(@NonNull Call call, @NonNull Response response) throws IOException {\n    if(response.isSuccessful()){\n        JSONObject jsonObject = null;\n        try {\n            jsonObject = new JSONObject(response.body().string());\n            JSONArray jsonArray = jsonObject.getJSONArray(&quot;choices&quot;);\n            String result = jsonArray.getJSONObject(0).getString(&quot;text&quot;);\n            addResponse(result.trim());\n\n        } catch (JSONException e) {\n            e.printStackTrace();\n        }\n\n    }else{\n        addResponse(&quot;Failed to response due to &quot;+response.body().toString());\n    }\n}\n</code></pre>\n"},{"tags":["java","spring","spring-boot","spring-boot-actuator"],"answers":[{"tags":[],"owner":{"account_id":13019257,"reputation":21,"user_id":9409289,"display_name":"McMill"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1571489681,"creation_date":1571489681,"answer_id":58463895,"question_id":58463744,"body_markdown":"Problem solved, needed to add this property to application.yml:\r\n\r\n    management:\r\n      endpoints:\r\n        web:\r\n          path-mapping:\r\n            my-actuator-endpoint: api/v1/my-service/my-actuator-endpoint","title":"How to make Sprint Boot 2 actuator path based on application properties?","body":"<p>Problem solved, needed to add this property to application.yml:</p>\n\n<pre><code>management:\n  endpoints:\n    web:\n      path-mapping:\n        my-actuator-endpoint: api/v1/my-service/my-actuator-endpoint\n</code></pre>\n"},{"tags":[],"owner":{"account_id":14374791,"reputation":743,"user_id":10383493,"display_name":"sovannarith cheav"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1571489759,"creation_date":1571489759,"answer_id":58463904,"question_id":58463744,"body_markdown":"you can expose actuator endpoints&#160;by setting configuration in property file like this\n```\nmanagement.context-path=/manage\n```","title":"How to make Sprint Boot 2 actuator path based on application properties?","body":"<p>you can expose actuator endpoints by setting configuration in property file like this</p>\n\n<pre><code>management.context-path=/manage\n</code></pre>\n"}],"owner":{"account_id":13019257,"reputation":21,"user_id":9409289,"display_name":"McMill"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":737,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1684831302,"creation_date":1571488550,"question_id":58463744,"body_markdown":"I have a microservice application with Spring Boot 2, which used my own library to propagate new endpoint to itself by using actuator functionality - my own actuator implemented an MvcEndpoint interface, and contained &#39;path&#39; variable which got real API mapping from application.yml of microservice that used this library.\r\n\r\nBut after I recoded my library to spring boot 2, I have an issue - **id** property on **@Endpoint** annotation contains only constant value (as every annotation properties), and I haven&#39;t found way to change API path of my actuator endpoint to something like &#39;**/api/v1/my-service/my-actuator-endpoint**&#39;.\r\n\r\nI tried to write this in my application.yml of microservice:\r\n\r\n    endpoints:\r\n      my-actuator-endpoint:\r\n        path: /api/v1/my-service/my-actuator-endpoint\r\n\r\nBut this endpoint still accessible only from /my-actuator-endpoint , which means only by its id.\r\n\r\nHow can I make this be accessible by custom path like /api/v1/my-service/my-actuator-endpoint, which will be configured in application.yml? \r\n","title":"How to make Sprint Boot 2 actuator path based on application properties?","body":"<p>I have a microservice application with Spring Boot 2, which used my own library to propagate new endpoint to itself by using actuator functionality - my own actuator implemented an MvcEndpoint interface, and contained 'path' variable which got real API mapping from application.yml of microservice that used this library.</p>\n\n<p>But after I recoded my library to spring boot 2, I have an issue - <strong>id</strong> property on <strong>@Endpoint</strong> annotation contains only constant value (as every annotation properties), and I haven't found way to change API path of my actuator endpoint to something like '<strong>/api/v1/my-service/my-actuator-endpoint</strong>'.</p>\n\n<p>I tried to write this in my application.yml of microservice:</p>\n\n<pre><code>endpoints:\n  my-actuator-endpoint:\n    path: /api/v1/my-service/my-actuator-endpoint\n</code></pre>\n\n<p>But this endpoint still accessible only from /my-actuator-endpoint , which means only by its id.</p>\n\n<p>How can I make this be accessible by custom path like /api/v1/my-service/my-actuator-endpoint, which will be configured in application.yml? </p>\n"},{"tags":["java","spring","spring-boot","spring-boot-actuator"],"comments":[{"owner":{"account_id":5121316,"reputation":2890,"user_id":4104760,"accept_rate":36,"display_name":"George"},"score":0,"creation_date":1597377402,"post_id":63406277,"comment_id":112118568,"body_markdown":"What&#39;s wrong with making a normal request to `B` and getting an error response back?","body":"What&#39;s wrong with making a normal request to <code>B</code> and getting an error response back?"},{"owner":{"account_id":8529,"reputation":35006,"user_id":15441,"accept_rate":92,"display_name":"hawkeye"},"score":1,"creation_date":1597377595,"post_id":63406277,"comment_id":112118609,"body_markdown":"Because A-&gt;B is replicated in 100 scenarios, and there isn&#39;t a clear view of all those relationships. For the person responsible for keeping these up and available, we need a clear view of what downstream outage has what effect upstream.","body":"Because A-&gt;B is replicated in 100 scenarios, and there isn&#39;t a clear view of all those relationships. For the person responsible for keeping these up and available, we need a clear view of what downstream outage has what effect upstream."}],"answers":[{"tags":[],"owner":{"account_id":960281,"reputation":388,"user_id":9387519,"display_name":"Five"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1597386033,"creation_date":1597386033,"answer_id":63407575,"question_id":63406277,"body_markdown":"Spring boot provides a lot of Health Indicators out of the box. However, you can add your own custom health indicator by implementing `HealthIndicator` interface (`ReactiveHealthIndicator` for reactive apps):\r\n\r\n    @Component\r\n    public class ServiceBHealthIndicator implements HealthIndicator {\r\n        \r\n        private final String message_key = &quot;Service B&quot;;\r\n\r\n        @Override\r\n        public Health health() {\r\n            if (!isRunningServiceB()) {\r\n                return Health.down().withDetail(message_key, &quot;Not Available&quot;).build();\r\n            }\r\n            return Health.up().withDetail(message_key, &quot;Available&quot;).build();\r\n        }\r\n        private Boolean isRunningServiceB() {\r\n            Boolean isRunning = true;\r\n            // Your logic here\r\n            return isRunning;\r\n        }\r\n    }\r\n\r\nIf you combine it with other health indicators like the one before, you can get a health endpoint response in a way like this:\r\n\r\n    {\r\n       &quot;status&quot;:&quot;DOWN&quot;,\r\n       &quot;details&quot;:{\r\n          &quot;serviceB&quot;:{\r\n             &quot;status&quot;:&quot;UP&quot;,\r\n             &quot;details&quot;:{\r\n                &quot;Service B&quot;:&quot;Available&quot;\r\n             }\r\n          },\r\n          &quot;serviceC&quot;:{\r\n             &quot;status&quot;:&quot;DOWN&quot;,\r\n             &quot;details&quot;:{\r\n                &quot;Service C&quot;:&quot;Not Available&quot;\r\n             }\r\n          }\r\n       }\r\n    }\r\n\r\nYou can find more information about [custom health checks][1] and [endpoints][2] in the spring boot documentation.\r\n\r\n\r\n  [1]: https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#writing-custom-healthindicators\r\n  [2]: https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#production-ready-endpoints","title":"Is there a standard way in Spring Boot Actuators of checking the health of child services?","body":"<p>Spring boot provides a lot of Health Indicators out of the box. However, you can add your own custom health indicator by implementing <code>HealthIndicator</code> interface (<code>ReactiveHealthIndicator</code> for reactive apps):</p>\n<pre><code>@Component\npublic class ServiceBHealthIndicator implements HealthIndicator {\n    \n    private final String message_key = &quot;Service B&quot;;\n\n    @Override\n    public Health health() {\n        if (!isRunningServiceB()) {\n            return Health.down().withDetail(message_key, &quot;Not Available&quot;).build();\n        }\n        return Health.up().withDetail(message_key, &quot;Available&quot;).build();\n    }\n    private Boolean isRunningServiceB() {\n        Boolean isRunning = true;\n        // Your logic here\n        return isRunning;\n    }\n}\n</code></pre>\n<p>If you combine it with other health indicators like the one before, you can get a health endpoint response in a way like this:</p>\n<pre><code>{\n   &quot;status&quot;:&quot;DOWN&quot;,\n   &quot;details&quot;:{\n      &quot;serviceB&quot;:{\n         &quot;status&quot;:&quot;UP&quot;,\n         &quot;details&quot;:{\n            &quot;Service B&quot;:&quot;Available&quot;\n         }\n      },\n      &quot;serviceC&quot;:{\n         &quot;status&quot;:&quot;DOWN&quot;,\n         &quot;details&quot;:{\n            &quot;Service C&quot;:&quot;Not Available&quot;\n         }\n      }\n   }\n}\n</code></pre>\n<p>You can find more information about <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#writing-custom-healthindicators\" rel=\"nofollow noreferrer\">custom health checks</a> and <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#production-ready-endpoints\" rel=\"nofollow noreferrer\">endpoints</a> in the spring boot documentation.</p>\n"}],"owner":{"account_id":8529,"reputation":35006,"user_id":15441,"accept_rate":92,"display_name":"hawkeye"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":766,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":63407575,"answer_count":1,"score":3,"last_activity_date":1684831264,"creation_date":1597377206,"question_id":63406277,"body_markdown":"Suppose I have Spring Boot service A which depends on (calls) Spring Boot service B. \r\n\r\n    A -&gt; B\r\n\r\nSpring Boot [Actuators][1] can tell me if A is up. \r\n\r\nhttps://A/health\r\n\r\nWhat I want to know is if B is up, by calling A. \r\n\r\nhttps://A/integratedhealth\r\n\r\nMy question is: **Is there a standard way in Spring Boot Actuators of checking the health of child services?**\r\n(or do I just have to build a custom actuator service?)\r\n\r\n\r\n  [1]: https://spring.io/guides/gs/actuator-service/","title":"Is there a standard way in Spring Boot Actuators of checking the health of child services?","body":"<p>Suppose I have Spring Boot service A which depends on (calls) Spring Boot service B.</p>\n<pre><code>A -&gt; B\n</code></pre>\n<p>Spring Boot <a href=\"https://spring.io/guides/gs/actuator-service/\" rel=\"nofollow noreferrer\">Actuators</a> can tell me if A is up.</p>\n<p>https://A/health</p>\n<p>What I want to know is if B is up, by calling A.</p>\n<p>https://A/integratedhealth</p>\n<p>My question is: <strong>Is there a standard way in Spring Boot Actuators of checking the health of child services?</strong>\n(or do I just have to build a custom actuator service?)</p>\n"},{"tags":["java","log4j2"],"comments":[{"owner":{"account_id":3700031,"reputation":6378,"user_id":3080094,"display_name":"vanOekel"},"score":0,"creation_date":1391176886,"post_id":21475576,"comment_id":32423254,"body_markdown":"[AbstractAppender](http://logging.apache.org/log4j/2.0/log4j-core/apidocs/org/apache/logging/log4j/core/appender/AbstractAppender.html) looks like the equivalent of [AppenderSkeleton](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/AppenderSkeleton.html)","body":"<a href=\"http://logging.apache.org/log4j/2.0/log4j-core/apidocs/org/apache/logging/log4j/core/appender/AbstractAppender.html\" rel=\"nofollow noreferrer\">AbstractAppender</a> looks like the equivalent of <a href=\"http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/AppenderSkeleton.html\" rel=\"nofollow noreferrer\">AppenderSkeleton</a>"}],"answers":[{"tags":[],"owner":{"account_id":1555751,"reputation":35615,"user_id":1446916,"display_name":"Remko Popma"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1391220071,"creation_date":1391220071,"answer_id":21493232,"question_id":21475576,"body_markdown":"It looks like you are trying to do something similar to this: https://issues.apache.org/jira/browse/LOG4J2-303\r\n\r\nThat Jira ticket has a partial solution. You can look at the code for ConsoleAppender to see how to create a custom appender. \r\n\r\nYou can configure your custom appender in your log4j2.xml just like the built-in appenders, but you need to specify the package of your plugin in the _packages_ attribute of the Configuration element (so that the log4j2 PluginManager can find your plugin.) ","title":"append log4j2 output to TextArea","body":"<p>It looks like you are trying to do something similar to this: <a href=\"https://issues.apache.org/jira/browse/LOG4J2-303\" rel=\"nofollow\">https://issues.apache.org/jira/browse/LOG4J2-303</a></p>\n\n<p>That Jira ticket has a partial solution. You can look at the code for ConsoleAppender to see how to create a custom appender. </p>\n\n<p>You can configure your custom appender in your log4j2.xml just like the built-in appenders, but you need to specify the package of your plugin in the <em>packages</em> attribute of the Configuration element (so that the log4j2 PluginManager can find your plugin.) </p>\n"},{"tags":[],"owner":{"account_id":3426706,"reputation":51,"user_id":2872302,"display_name":"Mario Voigt"},"comment_count":0,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1426606874,"creation_date":1426606874,"answer_id":29103454,"question_id":21475576,"body_markdown":"A late answer but i finally found a solution for the problem.\r\nTo append a log4j2 console stream to a JavaFX TextArea, ListView oder similar control or even a swing control is possible. My solution also appends standard System.out to the logger view. See yourself.\r\n\r\nAt first i show you my current result by screenshot (sorry i cannot include it here directly because i have not enough reputation with my user account at stackoverflow...):\r\n[View the screenshot][1]\r\n\r\n**Step 1: Edit your log4j2.xml file and add the attribute follow=&quot;true&quot;:**\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;Configuration status=&quot;WARN&quot;&gt;\r\n\t&lt;Appenders&gt;\r\n\t\t&lt;Console name=&quot;STDOUT&quot; target=&quot;SYSTEM_OUT&quot; follow=&quot;true&quot;&gt;\r\n\t\t\t&lt;PatternLayout pattern=&quot;%d %-5p (%F:%L) - %m%n&quot; /&gt;\r\n\t\t&lt;/Console&gt;\r\n\t&lt;/Appenders&gt;\r\n\t&lt;Loggers&gt;\r\n\t\t&lt;Root level=&quot;DEBUG&quot;&gt;\r\n\t\t\t&lt;AppenderRef ref=&quot;STDOUT&quot; /&gt;\r\n\t\t&lt;/Root&gt;\r\n\t&lt;/Loggers&gt;\r\n    &lt;/Configuration&gt;\r\n\r\n**Step 2: Write a class which use is to append the SYSTEM_OUT to the desired visual control**\r\n\r\nFor my example i made up a small ui control composition like shown in screenshot. Therefore you need a fxml, a controller for the fxml and additionally a LogStringCell, which provides color formatting (this is not needed nut nice gimmick)\r\n\r\n**LoggerConsole.fxml**\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    \r\n    &lt;?import java.lang.*?&gt;\r\n    &lt;?import javafx.scene.control.*?&gt;\r\n    &lt;?import javafx.scene.layout.*?&gt;\r\n    &lt;?import javafx.scene.layout.AnchorPane?&gt;\r\n    \r\n    &lt;VBox prefHeight=&quot;200.0&quot; prefWidth=&quot;800.0&quot; xmlns=&quot;http://javafx.com/javafx/8&quot; xmlns:fx=&quot;http://javafx.com/fxml/1&quot; fx:controller=&quot;tuc.plentyfx.configurator.views.LoggerConsoleController&quot;&gt;\r\n       &lt;children&gt;\r\n          &lt;ListView fx:id=&quot;listViewLog&quot; /&gt;\r\n          &lt;ToolBar prefHeight=&quot;40.0&quot; prefWidth=&quot;200.0&quot;&gt;\r\n            &lt;items&gt;\r\n                &lt;Button mnemonicParsing=&quot;false&quot; onAction=&quot;#handleRemoveSelected&quot; text=&quot;Selektierte l&#246;schen&quot; /&gt;\r\n                &lt;Button fx:id=&quot;buttonClearLog&quot; mnemonicParsing=&quot;false&quot; onAction=&quot;#handleClearLog&quot; text=&quot;Leeren&quot; /&gt;\r\n                &lt;ToggleButton fx:id=&quot;toggleButtonAutoScroll&quot; mnemonicParsing=&quot;false&quot; text=&quot;Auto-Scroll&quot; /&gt;\r\n                &lt;ChoiceBox fx:id=&quot;choiceBoxLogLevel&quot; prefWidth=&quot;150.0&quot; /&gt;\r\n            &lt;/items&gt;\r\n          &lt;/ToolBar&gt;\r\n       &lt;/children&gt;\r\n    &lt;/VBox&gt;\r\n\r\nThe controller class **LoggerConsoleController.java**\r\n    &lt;!-- language: java --&gt;\r\n\r\n    package tuc.plentyfx.configurator.views;\r\n    \r\n    import java.io.BufferedReader;\r\n    import java.io.IOException;\r\n    import java.io.InputStreamReader;\r\n    import java.io.PipedInputStream;\r\n    import java.io.PipedOutputStream;\r\n    import java.io.PrintStream;\r\n    \r\n    import javafx.application.Platform;\r\n    import javafx.beans.value.ChangeListener;\r\n    import javafx.beans.value.ObservableValue;\r\n    import javafx.concurrent.Task;\r\n    import javafx.fxml.FXML;\r\n    import javafx.scene.control.ChoiceBox;\r\n    import javafx.scene.control.ListCell;\r\n    import javafx.scene.control.ListView;\r\n    import javafx.scene.control.SelectionMode;\r\n    import javafx.scene.control.ToggleButton;\r\n    import javafx.util.Callback;\r\n    \r\n    import org.apache.logging.log4j.Level;\r\n    import org.apache.logging.log4j.LogManager;\r\n    import org.apache.logging.log4j.Logger;\r\n    import org.apache.logging.log4j.core.LoggerContext;\r\n    import org.apache.logging.log4j.core.config.Configuration;\r\n    import org.apache.logging.log4j.core.config.LoggerConfig;\r\n    \r\n    import tuc.plentyfx.common.LogStringCell;\r\n    \r\n    public class LoggerConsoleController {\r\n    \tstatic final Logger logger = LogManager.getLogger(LoggerConsoleController.class.getName());\r\n    \r\n    \t@FXML\r\n    \tprivate ListView&lt;String&gt; listViewLog;\r\n    \r\n    \t@FXML\r\n    \tprivate ToggleButton toggleButtonAutoScroll;\r\n    \r\n    \t@FXML\r\n    \tprivate ChoiceBox&lt;Level&gt; choiceBoxLogLevel;\r\n    \r\n    \t@FXML\r\n    \tvoid handleRemoveSelected() {\r\n    \t\tlistViewLog.getItems().removeAll(listViewLog.getSelectionModel().getSelectedItems());\r\n    \t}\r\n    \r\n    \t@FXML\r\n    \tvoid handleClearLog() {\r\n    \t\tlistViewLog.getItems().clear();\r\n    \t}\r\n    \r\n    \t@FXML\r\n    \tvoid initialize() {\r\n    \t\tlistViewLog.getSelectionModel().setSelectionMode(SelectionMode.MULTIPLE);\r\n    \t\tLoggerContext loggerContext = (LoggerContext) LogManager.getContext(false);\r\n    \t\tConfiguration loggerConfiguration = loggerContext.getConfiguration();\r\n    \t\tLoggerConfig loggerConfig = loggerConfiguration.getLoggerConfig(LogManager.ROOT_LOGGER_NAME);\r\n    \t\t/* ChoiceBox f&#252;llen */\r\n    \t\tfor (Level level : Level.values()) {\r\n    \t\t\tchoiceBoxLogLevel.getItems().add(level);\r\n    \t\t}\r\n    \t\t/* Aktuellen LogLevel in der ChoiceBox als Auswahl setzen */\r\n    \t\tchoiceBoxLogLevel.getSelectionModel().select(loggerConfig.getLevel());\r\n    \t\tchoiceBoxLogLevel.getSelectionModel().selectedItemProperty().addListener(new ChangeListener&lt;Level&gt;() {\r\n    \t\t\t@Override\r\n    \t\t\tpublic void changed(ObservableValue&lt;? extends Level&gt; arg0, Level oldLevel, Level newLevel) {\r\n    \t\t\t\tloggerConfig.setLevel(newLevel);\r\n    \t\t\t\tloggerContext.updateLoggers(); // &#252;bernehme aktuellen LogLevel\r\n    \t\t\t}\r\n    \t\t});\r\n    \r\n    \t\tlistViewLog.setCellFactory(new Callback&lt;ListView&lt;String&gt;, ListCell&lt;String&gt;&gt;() {\r\n    \t\t\t@Override\r\n    \t\t\tpublic ListCell&lt;String&gt; call(ListView&lt;String&gt; listView) {\r\n    \t\t\t\treturn new LogStringCell();\r\n    \t\t\t}\r\n    \t\t});\r\n    \r\n    \t\t/* den Origial System.out Stream in die ListView umleiten */\r\n    \t\tPipedOutputStream pOut = new PipedOutputStream();\r\n    \t\tSystem.setOut(new PrintStream(pOut));\r\n    \t\tPipedInputStream pIn = null;\r\n    \t\ttry {\r\n    \t\t\tpIn = new PipedInputStream(pOut);\r\n    \t\t}\r\n    \t\tcatch (IOException e) {\r\n    \t\t\te.printStackTrace();\r\n    \t\t}\r\n    \t\tBufferedReader reader = new BufferedReader(new InputStreamReader(pIn));\r\n    \r\n    \t\tTask&lt;Void&gt; task = new Task&lt;Void&gt;() {\r\n    \t\t\t@Override\r\n    \t\t\tprotected Void call() throws Exception {\r\n    \t\t\t\twhile (!isCancelled()) {\r\n    \t\t\t\t\ttry {\r\n    \t\t\t\t\t\tString line = reader.readLine();\r\n    \t\t\t\t\t\tif (line != null) {\r\n    \t\t\t\t\t\t\tPlatform.runLater(new Runnable() {\r\n    \t\t\t\t\t\t\t\t@Override\r\n    \t\t\t\t\t\t\t\tpublic void run() {\r\n    \t\t\t\t\t\t\t\t\tlistViewLog.getItems().add(line);\r\n    \r\n    \t\t\t\t\t\t\t\t\t/* Auto-Scroll + Select */\r\n    \t\t\t\t\t\t\t\t\tif (toggleButtonAutoScroll.selectedProperty().get()) {\r\n    \t\t\t\t\t\t\t\t\t\tlistViewLog.scrollTo(listViewLog.getItems().size() - 1);\r\n    \t\t\t\t\t\t\t\t\t\tlistViewLog.getSelectionModel().select(listViewLog.getItems().size() - 1);\r\n    \t\t\t\t\t\t\t\t\t}\r\n    \t\t\t\t\t\t\t\t}\r\n    \t\t\t\t\t\t\t});\r\n    \t\t\t\t\t\t}\r\n    \t\t\t\t\t}\r\n    \t\t\t\t\tcatch (IOException e) {\r\n    \t\t\t\t\t\te.printStackTrace();\r\n    \t\t\t\t\t}\r\n    \t\t\t\t}\r\n    \t\t\t\treturn null;\r\n    \t\t\t}\r\n    \t\t};\r\n    \t\tThread thread = new Thread(task);\r\n    \t\tthread.setDaemon(true);\r\n    \t\tthread.start();\r\n    \t}\r\n    }\r\n\r\nThe **LogStringCell.class**\r\n    &lt;!-- language: java --&gt;\r\n\r\n    package tuc.plentyfx.common;\r\n    \r\n    import javafx.scene.control.ListCell;\r\n    import javafx.scene.layout.FlowPane;\r\n    import javafx.scene.text.Text;\r\n    \r\n    public class LogStringCell extends ListCell&lt;String&gt; {\r\n    \r\n    \t@Override\r\n    \tprotected void updateItem(String string, boolean empty) {\r\n    \t\tsuper.updateItem(string, empty);\r\n    \t\tif (string != null &amp;&amp; !isEmpty()) {\r\n    \t\t\tsetGraphic(createAssembledFlowPane(string));\r\n    \t\t}\r\n    \t\telse {\r\n    \t\t\tsetGraphic(null);\r\n    \t\t\tsetText(null);\r\n    \t\t}\r\n    \t}\r\n    \r\n    \t/* Erzeuge ein FlowPane mit gef&#252;llten Textbausteien */\r\n    \tprivate FlowPane createAssembledFlowPane(String... messageTokens) {\r\n    \t\tFlowPane flow = new FlowPane();\r\n    \t\tfor (String token : messageTokens) {\r\n    \t\t\tText text = new Text(token);\r\n    \r\n    \t\t\tif (text.toString().contains(&quot; TRACE &quot;)) {\r\n    \t\t\t\ttext.setStyle(&quot;-fx-fill: #0000FF&quot;);\r\n    \t\t\t}\r\n    \t\t\tif (text.toString().contains(&quot; ALL &quot;)) {\r\n    \t\t\t\ttext.setStyle(&quot;-fx-fill: #FF00FF&quot;);\r\n    \t\t\t}\r\n    \t\t\tif (text.toString().contains(&quot; ERROR &quot;)) {\r\n    \t\t\t\ttext.setStyle(&quot;-fx-fill: #FF8080&quot;);\r\n    \t\t\t}\r\n    \t\t\tif (text.toString().contains(&quot; INFO &quot;)) {\r\n    \t\t\t\ttext.setStyle(&quot;-fx-fill: #000000&quot;);\r\n    \t\t\t}\r\n    \t\t\tif (text.toString().contains(&quot; FATAL &quot;)) {\r\n    \t\t\t\ttext.setStyle(&quot;-fx-fill: #FF0000&quot;);\r\n    \t\t\t}\r\n    \t\t\tif (text.toString().contains(&quot; DEBUG &quot;)) {\r\n    \t\t\t\ttext.setStyle(&quot;-fx-fill: #808080&quot;);\r\n    \t\t\t}\r\n    \t\t\tif (text.toString().contains(&quot; OFF &quot;)) {\r\n    \t\t\t\ttext.setStyle(&quot;-fx-fill: #8040FF&quot;);\r\n    \t\t\t}\r\n    \t\t\tif (text.toString().contains(&quot; WARN &quot;)) {\r\n    \t\t\t\ttext.setStyle(&quot;-fx-fill: #FF8000&quot;);\r\n    \t\t\t}\r\n    \r\n    \t\t\tflow.getChildren().add(text);\r\n    \t\t}\r\n    \t\treturn flow;\r\n    \t}\r\n    }\r\n\r\n**Step 3: Use it in your application. Done...!**\r\n\r\n**Problems/Ideas/Limitations:**\r\nThere are currently some issues with my code when using it with threads: creating a log statement from another thread will break the piped stream and throw an error. maybe there is needed a sync pipe. i found code for that with google but didnt try it yet (look also here: [http://www.certpal.com/blogs/2010/11/using-a-pipedinputstream-and-pipedoutputstream/][2]\r\n):\r\n\r\n    package application.common;\r\n\r\n    import java.io.InputStream;\r\n    import java.io.OutputStream;\r\n    \r\n    public class SyncPipe implements Runnable {\r\n    \r\n    \tprivate final OutputStream outputStream;\r\n    \tprivate final InputStream inputStream;\r\n    \r\n    \tpublic SyncPipe(InputStream inputStream, OutputStream outputStream) {\r\n    \t\tthis.inputStream = inputStream;\r\n    \t\tthis.outputStream = outputStream;\r\n    \t}\r\n    \r\n    \t@Override\r\n    \tpublic void run() {\r\n    \t\ttry {\r\n    \t\t\tfinal byte[] buffer = new byte[1024];\r\n    \t\t\tfor (int length = 0; (length = inputStream.read(buffer)) != -1;) {\r\n    \t\t\t\toutputStream.write(buffer, 0, length);\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tcatch (Exception e) {\r\n    \t\t\te.printStackTrace();\r\n    \t\t}\r\n    \t}\r\n    \r\n    }\r\n\r\nAnother problem: The colored string formatting should be recoded with some better detection for the logging message type (info, debug, trace, etc.). Filtering with things like &quot;text.toString().contains(&quot; TRACE &quot;))&quot; is really ugly.\r\n\r\n***Let me know if you have any questions to this. This thread is really old but if you write here i will receive an email. Then i can answer you directly***\r\n\r\n\r\n  [1]: http://s23.postimg.org/ut5vkh72j/Zwischenablage01.jpg\r\n  [2]: http://www.certpal.com/blogs/2010/11/using-a-pipedinputstream-and-pipedoutputstream/","title":"append log4j2 output to TextArea","body":"<p>A late answer but i finally found a solution for the problem.\nTo append a log4j2 console stream to a JavaFX TextArea, ListView oder similar control or even a swing control is possible. My solution also appends standard System.out to the logger view. See yourself.</p>\n\n<p>At first i show you my current result by screenshot (sorry i cannot include it here directly because i have not enough reputation with my user account at stackoverflow...):\n<a href=\"http://s23.postimg.org/ut5vkh72j/Zwischenablage01.jpg\">View the screenshot</a></p>\n\n<p><strong>Step 1: Edit your log4j2.xml file and add the attribute follow=\"true\":</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Configuration status=\"WARN\"&gt;\n&lt;Appenders&gt;\n    &lt;Console name=\"STDOUT\" target=\"SYSTEM_OUT\" follow=\"true\"&gt;\n        &lt;PatternLayout pattern=\"%d %-5p (%F:%L) - %m%n\" /&gt;\n    &lt;/Console&gt;\n&lt;/Appenders&gt;\n&lt;Loggers&gt;\n    &lt;Root level=\"DEBUG\"&gt;\n        &lt;AppenderRef ref=\"STDOUT\" /&gt;\n    &lt;/Root&gt;\n&lt;/Loggers&gt;\n&lt;/Configuration&gt;\n</code></pre>\n\n<p><strong>Step 2: Write a class which use is to append the SYSTEM_OUT to the desired visual control</strong></p>\n\n<p>For my example i made up a small ui control composition like shown in screenshot. Therefore you need a fxml, a controller for the fxml and additionally a LogStringCell, which provides color formatting (this is not needed nut nice gimmick)</p>\n\n<p><strong>LoggerConsole.fxml</strong>\n    </p>\n\n<pre><code>&lt;?import java.lang.*?&gt;\n&lt;?import javafx.scene.control.*?&gt;\n&lt;?import javafx.scene.layout.*?&gt;\n&lt;?import javafx.scene.layout.AnchorPane?&gt;\n\n&lt;VBox prefHeight=\"200.0\" prefWidth=\"800.0\" xmlns=\"http://javafx.com/javafx/8\" xmlns:fx=\"http://javafx.com/fxml/1\" fx:controller=\"tuc.plentyfx.configurator.views.LoggerConsoleController\"&gt;\n   &lt;children&gt;\n      &lt;ListView fx:id=\"listViewLog\" /&gt;\n      &lt;ToolBar prefHeight=\"40.0\" prefWidth=\"200.0\"&gt;\n        &lt;items&gt;\n            &lt;Button mnemonicParsing=\"false\" onAction=\"#handleRemoveSelected\" text=\"Selektierte löschen\" /&gt;\n            &lt;Button fx:id=\"buttonClearLog\" mnemonicParsing=\"false\" onAction=\"#handleClearLog\" text=\"Leeren\" /&gt;\n            &lt;ToggleButton fx:id=\"toggleButtonAutoScroll\" mnemonicParsing=\"false\" text=\"Auto-Scroll\" /&gt;\n            &lt;ChoiceBox fx:id=\"choiceBoxLogLevel\" prefWidth=\"150.0\" /&gt;\n        &lt;/items&gt;\n      &lt;/ToolBar&gt;\n   &lt;/children&gt;\n&lt;/VBox&gt;\n</code></pre>\n\n<p>The controller class <strong>LoggerConsoleController.java</strong>\n    </p>\n\n<pre><code>package tuc.plentyfx.configurator.views;\n\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.io.PipedInputStream;\nimport java.io.PipedOutputStream;\nimport java.io.PrintStream;\n\nimport javafx.application.Platform;\nimport javafx.beans.value.ChangeListener;\nimport javafx.beans.value.ObservableValue;\nimport javafx.concurrent.Task;\nimport javafx.fxml.FXML;\nimport javafx.scene.control.ChoiceBox;\nimport javafx.scene.control.ListCell;\nimport javafx.scene.control.ListView;\nimport javafx.scene.control.SelectionMode;\nimport javafx.scene.control.ToggleButton;\nimport javafx.util.Callback;\n\nimport org.apache.logging.log4j.Level;\nimport org.apache.logging.log4j.LogManager;\nimport org.apache.logging.log4j.Logger;\nimport org.apache.logging.log4j.core.LoggerContext;\nimport org.apache.logging.log4j.core.config.Configuration;\nimport org.apache.logging.log4j.core.config.LoggerConfig;\n\nimport tuc.plentyfx.common.LogStringCell;\n\npublic class LoggerConsoleController {\n    static final Logger logger = LogManager.getLogger(LoggerConsoleController.class.getName());\n\n    @FXML\n    private ListView&lt;String&gt; listViewLog;\n\n    @FXML\n    private ToggleButton toggleButtonAutoScroll;\n\n    @FXML\n    private ChoiceBox&lt;Level&gt; choiceBoxLogLevel;\n\n    @FXML\n    void handleRemoveSelected() {\n        listViewLog.getItems().removeAll(listViewLog.getSelectionModel().getSelectedItems());\n    }\n\n    @FXML\n    void handleClearLog() {\n        listViewLog.getItems().clear();\n    }\n\n    @FXML\n    void initialize() {\n        listViewLog.getSelectionModel().setSelectionMode(SelectionMode.MULTIPLE);\n        LoggerContext loggerContext = (LoggerContext) LogManager.getContext(false);\n        Configuration loggerConfiguration = loggerContext.getConfiguration();\n        LoggerConfig loggerConfig = loggerConfiguration.getLoggerConfig(LogManager.ROOT_LOGGER_NAME);\n        /* ChoiceBox füllen */\n        for (Level level : Level.values()) {\n            choiceBoxLogLevel.getItems().add(level);\n        }\n        /* Aktuellen LogLevel in der ChoiceBox als Auswahl setzen */\n        choiceBoxLogLevel.getSelectionModel().select(loggerConfig.getLevel());\n        choiceBoxLogLevel.getSelectionModel().selectedItemProperty().addListener(new ChangeListener&lt;Level&gt;() {\n            @Override\n            public void changed(ObservableValue&lt;? extends Level&gt; arg0, Level oldLevel, Level newLevel) {\n                loggerConfig.setLevel(newLevel);\n                loggerContext.updateLoggers(); // übernehme aktuellen LogLevel\n            }\n        });\n\n        listViewLog.setCellFactory(new Callback&lt;ListView&lt;String&gt;, ListCell&lt;String&gt;&gt;() {\n            @Override\n            public ListCell&lt;String&gt; call(ListView&lt;String&gt; listView) {\n                return new LogStringCell();\n            }\n        });\n\n        /* den Origial System.out Stream in die ListView umleiten */\n        PipedOutputStream pOut = new PipedOutputStream();\n        System.setOut(new PrintStream(pOut));\n        PipedInputStream pIn = null;\n        try {\n            pIn = new PipedInputStream(pOut);\n        }\n        catch (IOException e) {\n            e.printStackTrace();\n        }\n        BufferedReader reader = new BufferedReader(new InputStreamReader(pIn));\n\n        Task&lt;Void&gt; task = new Task&lt;Void&gt;() {\n            @Override\n            protected Void call() throws Exception {\n                while (!isCancelled()) {\n                    try {\n                        String line = reader.readLine();\n                        if (line != null) {\n                            Platform.runLater(new Runnable() {\n                                @Override\n                                public void run() {\n                                    listViewLog.getItems().add(line);\n\n                                    /* Auto-Scroll + Select */\n                                    if (toggleButtonAutoScroll.selectedProperty().get()) {\n                                        listViewLog.scrollTo(listViewLog.getItems().size() - 1);\n                                        listViewLog.getSelectionModel().select(listViewLog.getItems().size() - 1);\n                                    }\n                                }\n                            });\n                        }\n                    }\n                    catch (IOException e) {\n                        e.printStackTrace();\n                    }\n                }\n                return null;\n            }\n        };\n        Thread thread = new Thread(task);\n        thread.setDaemon(true);\n        thread.start();\n    }\n}\n</code></pre>\n\n<p>The <strong>LogStringCell.class</strong>\n    </p>\n\n<pre><code>package tuc.plentyfx.common;\n\nimport javafx.scene.control.ListCell;\nimport javafx.scene.layout.FlowPane;\nimport javafx.scene.text.Text;\n\npublic class LogStringCell extends ListCell&lt;String&gt; {\n\n    @Override\n    protected void updateItem(String string, boolean empty) {\n        super.updateItem(string, empty);\n        if (string != null &amp;&amp; !isEmpty()) {\n            setGraphic(createAssembledFlowPane(string));\n        }\n        else {\n            setGraphic(null);\n            setText(null);\n        }\n    }\n\n    /* Erzeuge ein FlowPane mit gefüllten Textbausteien */\n    private FlowPane createAssembledFlowPane(String... messageTokens) {\n        FlowPane flow = new FlowPane();\n        for (String token : messageTokens) {\n            Text text = new Text(token);\n\n            if (text.toString().contains(\" TRACE \")) {\n                text.setStyle(\"-fx-fill: #0000FF\");\n            }\n            if (text.toString().contains(\" ALL \")) {\n                text.setStyle(\"-fx-fill: #FF00FF\");\n            }\n            if (text.toString().contains(\" ERROR \")) {\n                text.setStyle(\"-fx-fill: #FF8080\");\n            }\n            if (text.toString().contains(\" INFO \")) {\n                text.setStyle(\"-fx-fill: #000000\");\n            }\n            if (text.toString().contains(\" FATAL \")) {\n                text.setStyle(\"-fx-fill: #FF0000\");\n            }\n            if (text.toString().contains(\" DEBUG \")) {\n                text.setStyle(\"-fx-fill: #808080\");\n            }\n            if (text.toString().contains(\" OFF \")) {\n                text.setStyle(\"-fx-fill: #8040FF\");\n            }\n            if (text.toString().contains(\" WARN \")) {\n                text.setStyle(\"-fx-fill: #FF8000\");\n            }\n\n            flow.getChildren().add(text);\n        }\n        return flow;\n    }\n}\n</code></pre>\n\n<p><strong>Step 3: Use it in your application. Done...!</strong></p>\n\n<p><strong>Problems/Ideas/Limitations:</strong>\nThere are currently some issues with my code when using it with threads: creating a log statement from another thread will break the piped stream and throw an error. maybe there is needed a sync pipe. i found code for that with google but didnt try it yet (look also here: <a href=\"http://www.certpal.com/blogs/2010/11/using-a-pipedinputstream-and-pipedoutputstream/\">http://www.certpal.com/blogs/2010/11/using-a-pipedinputstream-and-pipedoutputstream/</a>\n):</p>\n\n<pre><code>package application.common;\n\nimport java.io.InputStream;\nimport java.io.OutputStream;\n\npublic class SyncPipe implements Runnable {\n\n    private final OutputStream outputStream;\n    private final InputStream inputStream;\n\n    public SyncPipe(InputStream inputStream, OutputStream outputStream) {\n        this.inputStream = inputStream;\n        this.outputStream = outputStream;\n    }\n\n    @Override\n    public void run() {\n        try {\n            final byte[] buffer = new byte[1024];\n            for (int length = 0; (length = inputStream.read(buffer)) != -1;) {\n                outputStream.write(buffer, 0, length);\n            }\n        }\n        catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n}\n</code></pre>\n\n<p>Another problem: The colored string formatting should be recoded with some better detection for the logging message type (info, debug, trace, etc.). Filtering with things like \"text.toString().contains(\" TRACE \"))\" is really ugly.</p>\n\n<p><strong><em>Let me know if you have any questions to this. This thread is really old but if you write here i will receive an email. Then i can answer you directly</em></strong></p>\n"}],"owner":{"account_id":2019615,"reputation":39,"user_id":1806116,"display_name":"christianPro"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3405,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1684831130,"creation_date":1391157518,"question_id":21475576,"body_markdown":"I&#39;m searching for a simple method in log4j2 to append logs to a textArea. \r\n\r\nIn log4j, this would be possible by extending the AppenderSkeleton class, but I can&#39;t find a similar mechanism in log4j2. \r\n\r\nFurthermore, rerouting the System output with \r\n\r\n    System.setOut(myPrintStream);\r\n\r\ndoesn&#39;t work either. \r\n\r\nIs there a possiblity to get this to work with log4j2?","title":"append log4j2 output to TextArea","body":"<p>I'm searching for a simple method in log4j2 to append logs to a textArea. </p>\n\n<p>In log4j, this would be possible by extending the AppenderSkeleton class, but I can't find a similar mechanism in log4j2. </p>\n\n<p>Furthermore, rerouting the System output with </p>\n\n<pre><code>System.setOut(myPrintStream);\n</code></pre>\n\n<p>doesn't work either. </p>\n\n<p>Is there a possiblity to get this to work with log4j2?</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":21225504,"reputation":1108,"user_id":15611270,"display_name":"Rocco"},"score":1,"creation_date":1621247832,"post_id":67568025,"comment_id":119428992,"body_markdown":"You don&#39;t close the BufferedReader for file1, this is the problem. Insert `br.close();` before `br = new BufferedReader(new FileReader(resultPath+&quot;file2.txt&quot;)); `","body":"You don&#39;t close the BufferedReader for file1, this is the problem. Insert <code>br.close();</code> before <code>br = new BufferedReader(new FileReader(resultPath+&quot;file2.txt&quot;)); </code>"},{"owner":{"account_id":19382678,"reputation":774,"user_id":14173556,"display_name":"paladin"},"score":1,"creation_date":1621248174,"post_id":67568025,"comment_id":119429135,"body_markdown":"No, he needs to close the anonymous `FileReader` -&gt; `new FileReader(resultPath+&quot;...&quot;);`. Better create a `FileReader` object, like `FileReader fr = new FileReader(resultPath+&quot;...&quot;);`, use this object for your `BufferedReader`, like `BufferedReader br = new BufferedReader(fr);`, so you are able to close the `FileReader` independently from the `BufferedReader`, using `fr.close();`.","body":"No, he needs to close the anonymous <code>FileReader</code> -&gt; <code>new FileReader(resultPath+&quot;...&quot;);</code>. Better create a <code>FileReader</code> object, like <code>FileReader fr = new FileReader(resultPath+&quot;...&quot;);</code>, use this object for your <code>BufferedReader</code>, like <code>BufferedReader br = new BufferedReader(fr);</code>, so you are able to close the <code>FileReader</code> independently from the <code>BufferedReader</code>, using <code>fr.close();</code>."},{"owner":{"account_id":3716652,"reputation":75,"user_id":13994935,"display_name":"fairyjee"},"score":0,"creation_date":1621248183,"post_id":67568025,"comment_id":119429141,"body_markdown":"@Rocco you are right. I thought i have used same br for both files so one close statement is enough. Thankyou :)","body":"@Rocco you are right. I thought i have used same br for both files so one close statement is enough. Thankyou :)"}],"answers":[{"comments":[{"owner":{"account_id":3716652,"reputation":75,"user_id":13994935,"display_name":"fairyjee"},"score":0,"creation_date":1621250392,"post_id":67568300,"comment_id":119430026,"body_markdown":"Its a very clean way to merge two files and delete the old ones.","body":"Its a very clean way to merge two files and delete the old ones."},{"owner":{"account_id":5998820,"reputation":12676,"user_id":4712734,"display_name":"DuncG"},"score":0,"creation_date":1621252819,"post_id":67568300,"comment_id":119431040,"body_markdown":"If you do this a lot, or need to include more files you could simplify / shorten further as a method `merge(List&lt;Path&gt; infiles, Path outfile)` and use a for loop through each file.","body":"If you do this a lot, or need to include more files you could simplify / shorten further as a method <code>merge(List&lt;Path&gt; infiles, Path outfile)</code> and use a for loop through each file."}],"tags":[],"owner":{"account_id":5998820,"reputation":12676,"user_id":4712734,"display_name":"DuncG"},"comment_count":2,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1684830931,"creation_date":1621248838,"answer_id":67568300,"question_id":67568025,"body_markdown":"Closing the streams as suggested in the comments will fix. However you are writing a lot of code which is hard to debug / fix later. Instead simplify to NIO calls and add try with resources handling to auto-close everything on the way:\r\n\r\n        String tmp  = System.getProperty(&quot;java.io.tmpdir&quot;);\r\n        Path result = Path.of(tmp, &quot;NewFolder&quot;, &quot;file3.txt&quot;);\r\n        Path file1  = Path.of(tmp,&quot;file1.txt&quot;);\r\n        Path file2  = Path.of(tmp,&quot;file2.txt&quot;);\r\n\r\n        try(OutputStream output = Files.newOutputStream(result)) {\r\n            try(InputStream input = Files.newInputStream(file1))  {\r\n                input.transferTo(output);\r\n            }\r\n            try(InputStream input = Files.newInputStream(file2))  {\r\n                input.transferTo(output);\r\n            }\r\n        }\r\n        Files.deleteIfExists(file1);\r\n        Files.deleteIfExists(file2);\r\n\r\n**EDIT**\r\n\r\nThe above works fine though I am unsure as to why I didn&#39;t suggest using `Files.copy(Path, OutputStream)` which does exactly what is shown above, simplifying the copying as:\r\n\r\n    try(OutputStream output = Files.newOutputStream(result)) {\r\n        // use a loop over the files to copy or:\r\n        Files.copy(file1, output);\r\n        Files.copy(file2, output);\r\n    }\r\n\r\nViewing source of JDK20 `Files.copy(Path, OutputStream)` shows this implementation:\r\n\r\n    public static long copy(Path source, OutputStream out) throws IOException {\r\n        // ensure not null before opening file\r\n        Objects.requireNonNull(out);\r\n\r\n        try (InputStream in = newInputStream(source)) {\r\n            return in.transferTo(out);\r\n        }\r\n    }\r\n","title":"merge file and delete the old file","body":"<p>Closing the streams as suggested in the comments will fix. However you are writing a lot of code which is hard to debug / fix later. Instead simplify to NIO calls and add try with resources handling to auto-close everything on the way:</p>\n<pre><code>    String tmp  = System.getProperty(&quot;java.io.tmpdir&quot;);\n    Path result = Path.of(tmp, &quot;NewFolder&quot;, &quot;file3.txt&quot;);\n    Path file1  = Path.of(tmp,&quot;file1.txt&quot;);\n    Path file2  = Path.of(tmp,&quot;file2.txt&quot;);\n\n    try(OutputStream output = Files.newOutputStream(result)) {\n        try(InputStream input = Files.newInputStream(file1))  {\n            input.transferTo(output);\n        }\n        try(InputStream input = Files.newInputStream(file2))  {\n            input.transferTo(output);\n        }\n    }\n    Files.deleteIfExists(file1);\n    Files.deleteIfExists(file2);\n</code></pre>\n<p><strong>EDIT</strong></p>\n<p>The above works fine though I am unsure as to why I didn't suggest using <code>Files.copy(Path, OutputStream)</code> which does exactly what is shown above, simplifying the copying as:</p>\n<pre><code>try(OutputStream output = Files.newOutputStream(result)) {\n    // use a loop over the files to copy or:\n    Files.copy(file1, output);\n    Files.copy(file2, output);\n}\n</code></pre>\n<p>Viewing source of JDK20 <code>Files.copy(Path, OutputStream)</code> shows this implementation:</p>\n<pre><code>public static long copy(Path source, OutputStream out) throws IOException {\n    // ensure not null before opening file\n    Objects.requireNonNull(out);\n\n    try (InputStream in = newInputStream(source)) {\n        return in.transferTo(out);\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":3716652,"reputation":75,"user_id":13994935,"display_name":"fairyjee"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":354,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":67568300,"answer_count":1,"score":0,"last_activity_date":1684830931,"creation_date":1621247690,"question_id":67568025,"body_markdown":"I have been trying to merge two files into new file and below code does it job. But after the merge i want to delete the old files. The code I am using to delete files just delete 1 file (file2) not the both of them. \r\n``` \r\npublic static void Filemerger() throws IOException  \r\n    { \r\n\t    \r\n\t   String resultPath = System.getProperty(&quot;java.io.tmpdir&quot;);\r\n\t   File result = new File(resultPath+&quot;//NewFolder&quot;, &quot;//file3.txt&quot;); \r\n\t\t\r\n\t\t// PrintWriter object for file3.txt \r\n        PrintWriter pw = new PrintWriter(result); \r\n          \r\n        // BufferedReader object for file1.txt \r\n        BufferedReader br = new BufferedReader(new FileReader(resultPath+&quot;file1.txt&quot;)); \r\n          \r\n        String line = br.readLine(); \r\n          \r\n        // loop to copy each line of  \r\n        // file1.txt to  file3.txt \r\n        while (line != null) \r\n        { \r\n            pw.println(line); \r\n            line = br.readLine(); \r\n        } \r\n        \r\n        pw.flush();\r\n          \r\n        br = new BufferedReader(new FileReader(resultPath+&quot;file2.txt&quot;)); \r\n          \r\n        line = br.readLine(); \r\n          \r\n        // loop to copy each line of  \r\n        // file2.txt to  file3.txt \r\n        while(line != null) \r\n        { \r\n            pw.println(line); \r\n            line = br.readLine(); \r\n        } \r\n          \r\n        pw.flush(); \r\n          \r\n        // closing resources \r\n        br.close(); \r\n         \r\n        pw.close(); \r\n        \r\n        File dir = new File(resultPath);\r\n    \t\r\n    \tFileFilter fileFilter1 = new WildcardFileFilter(new String[] {&quot;file1.txt&quot;, &quot;file2.txt&quot;}, IOCase.SENSITIVE); \r\n    \tFile[] fileList1 = dir.listFiles(fileFilter1);\r\n    \t\t\r\n    \tfor (int i = 0; i &lt; fileList1.length; i++) {\r\n    \t\t  if (fileList1[i].isFile()) {\r\n    \t\t\t  \r\n    \t\t    File file1 = fileList1[i].getAbsoluteFile();\r\n      \t\t    file1.delete();\r\n    \t\t  }\r\n    \t}\r\n    \t\r\n    }\r\n```\r\nI also try this code to delete the file1 as above code delete the file2:\r\n ```\r\n Path fileToDeletePath = Paths.get(resultPath+&quot;file1.txt&quot;);\r\n        Files.delete(fileToDeletePath);\r\n```\r\nbut it throws an exception that **Exception in thread &quot;main&quot; java.nio.file.FileSystemException: C:\\Users\\haya\\AppData\\Local\\Temp\\file1: The process cannot access the file because it is being used by another process.**","title":"merge file and delete the old file","body":"<p>I have been trying to merge two files into new file and below code does it job. But after the merge i want to delete the old files. The code I am using to delete files just delete 1 file (file2) not the both of them.</p>\n<pre><code>public static void Filemerger() throws IOException  \n    { \n        \n       String resultPath = System.getProperty(&quot;java.io.tmpdir&quot;);\n       File result = new File(resultPath+&quot;//NewFolder&quot;, &quot;//file3.txt&quot;); \n        \n        // PrintWriter object for file3.txt \n        PrintWriter pw = new PrintWriter(result); \n          \n        // BufferedReader object for file1.txt \n        BufferedReader br = new BufferedReader(new FileReader(resultPath+&quot;file1.txt&quot;)); \n          \n        String line = br.readLine(); \n          \n        // loop to copy each line of  \n        // file1.txt to  file3.txt \n        while (line != null) \n        { \n            pw.println(line); \n            line = br.readLine(); \n        } \n        \n        pw.flush();\n          \n        br = new BufferedReader(new FileReader(resultPath+&quot;file2.txt&quot;)); \n          \n        line = br.readLine(); \n          \n        // loop to copy each line of  \n        // file2.txt to  file3.txt \n        while(line != null) \n        { \n            pw.println(line); \n            line = br.readLine(); \n        } \n          \n        pw.flush(); \n          \n        // closing resources \n        br.close(); \n         \n        pw.close(); \n        \n        File dir = new File(resultPath);\n        \n        FileFilter fileFilter1 = new WildcardFileFilter(new String[] {&quot;file1.txt&quot;, &quot;file2.txt&quot;}, IOCase.SENSITIVE); \n        File[] fileList1 = dir.listFiles(fileFilter1);\n            \n        for (int i = 0; i &lt; fileList1.length; i++) {\n              if (fileList1[i].isFile()) {\n                  \n                File file1 = fileList1[i].getAbsoluteFile();\n                file1.delete();\n              }\n        }\n        \n    }\n</code></pre>\n<p>I also try this code to delete the file1 as above code delete the file2:</p>\n<pre><code>Path fileToDeletePath = Paths.get(resultPath+&quot;file1.txt&quot;);\n       Files.delete(fileToDeletePath);\n</code></pre>\n<p>but it throws an exception that <strong>Exception in thread &quot;main&quot; java.nio.file.FileSystemException: C:\\Users\\haya\\AppData\\Local\\Temp\\file1: The process cannot access the file because it is being used by another process.</strong></p>\n"},{"tags":["java","eclipse","intellij-idea","configuration","jboss7.x"],"comments":[{"owner":{"account_id":3538058,"reputation":5428,"user_id":2960034,"display_name":"y.bedrov"},"score":1,"creation_date":1618418792,"post_id":67092037,"comment_id":118597606,"body_markdown":"Please check &quot;Settings/Preferences | Build, Execution, Deployment | Application Servers&quot;. As for &quot;launch configuration&quot; - you could configure options in run configuration.","body":"Please check &quot;Settings/Preferences | Build, Execution, Deployment | Application Servers&quot;. As for &quot;launch configuration&quot; - you could configure options in run configuration."}],"answers":[{"comments":[{"owner":{"account_id":18088193,"reputation":595,"user_id":13148560,"display_name":"Japhei"},"score":0,"creation_date":1657449164,"post_id":72888038,"comment_id":128808438,"body_markdown":"While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - [From Review](/review/late-answers/32188744)","body":"While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href=\"/review/late-answers/32188744\">From Review</a>"},{"owner":{"account_id":5466909,"reputation":61,"user_id":4347459,"display_name":"Cary"},"score":0,"creation_date":1675710335,"post_id":72888038,"comment_id":132983551,"body_markdown":"The 2 links provided do, in fact, _not_ answer the question.  I&#39;ve looked over them closely and as a 20+ year user of Eclipse and various server connectors, there does not appear to be any equivalent functionality as asked by the OP from what I&#39;ve seen.  I&#39;ll keep looking and adjust this answer as appropriate.","body":"The 2 links provided do, in fact, <i>not</i> answer the question.  I&#39;ve looked over them closely and as a 20+ year user of Eclipse and various server connectors, there does not appear to be any equivalent functionality as asked by the OP from what I&#39;ve seen.  I&#39;ll keep looking and adjust this answer as appropriate."},{"owner":{"account_id":7425610,"reputation":9,"user_id":7351955,"display_name":"lstan"},"score":0,"creation_date":1675977731,"post_id":72888038,"comment_id":133049699,"body_markdown":"IntelliJ Ultimate does provide server run configurations for JBoss EAP. The links provided show you how to do this. I have added  more details. Note: the free community edition I believe does not provide JBoss EAP support. Also Ultimate comes with free support so take advantage of that","body":"IntelliJ Ultimate does provide server run configurations for JBoss EAP. The links provided show you how to do this. I have added  more details. Note: the free community edition I believe does not provide JBoss EAP support. Also Ultimate comes with free support so take advantage of that"}],"tags":[],"owner":{"account_id":7425610,"reputation":9,"user_id":7351955,"display_name":"lstan"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684830872,"creation_date":1657130418,"answer_id":72888038,"question_id":67092037,"body_markdown":"There are instructions from IntelliJ site:\r\n\r\n[Application Servers][2]\r\n\r\n[Application server run configurations][3]\r\n\r\nUpdate:\r\nBasically you add your JBoss server\r\n\r\nSettings-&gt;Application Servers- click + icon to add server\r\n\r\n![screenshot here][1]\r\n\r\nThen in run configurations you add and config  your JBoss server\r\n![screenshot here][5]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/AWKqp.png\r\n  [2]: https://www.jetbrains.com/help/idea/application-servers-settings.html\r\n  [3]: https://www.jetbrains.com/help/idea/creating-run-debug-configuration-for-application-server.html\r\n  [4]: https://i.stack.imgur.com/z4ghv.png\r\n  [5]: https://i.stack.imgur.com/I0nOL.png","title":"How to configure JBoss server in IntelliJ with server base dir and a settings.xml","body":"<p>There are instructions from IntelliJ site:</p>\n<p><a href=\"https://www.jetbrains.com/help/idea/application-servers-settings.html\" rel=\"nofollow noreferrer\">Application Servers</a></p>\n<p><a href=\"https://www.jetbrains.com/help/idea/creating-run-debug-configuration-for-application-server.html\" rel=\"nofollow noreferrer\">Application server run configurations</a></p>\n<p>Update:\nBasically you add your JBoss server</p>\n<p>Settings-&gt;Application Servers- click + icon to add server</p>\n<p><img src=\"https://i.stack.imgur.com/AWKqp.png\" alt=\"screenshot here\" /></p>\n<p>Then in run configurations you add and config  your JBoss server\n<img src=\"https://i.stack.imgur.com/I0nOL.png\" alt=\"screenshot here\" /></p>\n"}],"owner":{"account_id":8736925,"reputation":73,"user_id":7475630,"display_name":"El Cattivo"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":2233,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1684830872,"creation_date":1618404233,"question_id":67092037,"body_markdown":"I&#39;m trying to switch from Eclipse to IntelliJ Ultimate. But I have trouble configuring an application server.\r\n\r\n**What I have:**\r\n- IntelliJ IDEA Ultimate 2020.3\r\n- a JavaEE application running on JBoss EAP 7.1\r\n\r\n**What I already achieved:**\r\n- Adding an application server in Settings -&gt; Build, Execution, Deployment -&gt; Application Servers: I added a JBoss Server and specified the JBoss home directory\r\n- Adding a Run/Debug Configuration where I chose the JBoss server, added the artifacts which should be deployed, added some VM options, specified the JRE\r\n\r\n**Where I am stuck:**\r\nHere are the things I miss from the Eclipse configuration, and I can&#39;t find any documentation or help about that:\r\n- In Eclipse, there is a &quot;server runtime environment&quot; which specifies a &quot;server base directory&quot; and a &quot;configuration file&quot; (settings.xml) in addition to the server home directory and JRE. Where can I find these settings in IntelliJ?\r\n- Alternatively, there is the &quot;launch configuration&quot; in Eclipse, where you can define &quot;program arguments&quot; in addition to VM arguments. These also seem to set the server config and base dir.\r\n\r\nAny help is highly appreciated. Thanks a lot!","title":"How to configure JBoss server in IntelliJ with server base dir and a settings.xml","body":"<p>I'm trying to switch from Eclipse to IntelliJ Ultimate. But I have trouble configuring an application server.</p>\n<p><strong>What I have:</strong></p>\n<ul>\n<li>IntelliJ IDEA Ultimate 2020.3</li>\n<li>a JavaEE application running on JBoss EAP 7.1</li>\n</ul>\n<p><strong>What I already achieved:</strong></p>\n<ul>\n<li>Adding an application server in Settings -&gt; Build, Execution, Deployment -&gt; Application Servers: I added a JBoss Server and specified the JBoss home directory</li>\n<li>Adding a Run/Debug Configuration where I chose the JBoss server, added the artifacts which should be deployed, added some VM options, specified the JRE</li>\n</ul>\n<p><strong>Where I am stuck:</strong>\nHere are the things I miss from the Eclipse configuration, and I can't find any documentation or help about that:</p>\n<ul>\n<li>In Eclipse, there is a &quot;server runtime environment&quot; which specifies a &quot;server base directory&quot; and a &quot;configuration file&quot; (settings.xml) in addition to the server home directory and JRE. Where can I find these settings in IntelliJ?</li>\n<li>Alternatively, there is the &quot;launch configuration&quot; in Eclipse, where you can define &quot;program arguments&quot; in addition to VM arguments. These also seem to set the server config and base dir.</li>\n</ul>\n<p>Any help is highly appreciated. Thanks a lot!</p>\n"},{"tags":["java","spring","metrics","spring-boot-actuator"],"answers":[{"tags":[],"owner":{"account_id":4657214,"reputation":1415,"user_id":3772478,"accept_rate":83,"display_name":"Hazim"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1548760315,"creation_date":1548760315,"answer_id":54419761,"question_id":54419431,"body_markdown":"You can inject properties which are exposed through actuator endpoints (like `/health`) by injecting instance of endpoint class  using actuator API.\r\n\r\nThis stackoverflow answer explains about it in detail: \r\nhttps://stackoverflow.com/questions/50996603/does-spring-boot-actuator-have-a-java-api","title":"Obtain Spring actuator &#39;health&#39; metrics","body":"<p>You can inject properties which are exposed through actuator endpoints (like <code>/health</code>) by injecting instance of endpoint class  using actuator API.</p>\n\n<p>This stackoverflow answer explains about it in detail: \n<a href=\"https://stackoverflow.com/questions/50996603/does-spring-boot-actuator-have-a-java-api\">Does Spring Boot Actuator have a Java API?</a></p>\n"},{"tags":[],"owner":{"account_id":1709537,"reputation":77,"user_id":1567858,"display_name":"formatqs"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1613567322,"creation_date":1613567322,"answer_id":66242569,"question_id":54419431,"body_markdown":"Take a look on this example\r\n\r\n```\r\npackage ru.formatko;\r\n\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\nimport io.prometheus.client.Collector;\r\nimport io.prometheus.client.exporter.common.TextFormat;\r\nimport java.io.IOException;\r\nimport java.io.StringWriter;\r\nimport java.io.Writer;\r\nimport java.util.ArrayList;\r\nimport java.util.Collections;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\nimport lombok.Data;\r\nimport lombok.SneakyThrows;\r\nimport org.springframework.beans.factory.annotation.Value;\r\nimport org.springframework.boot.actuate.endpoint.annotation.Endpoint;\r\nimport org.springframework.boot.actuate.endpoint.annotation.ReadOperation;\r\nimport org.springframework.boot.actuate.endpoint.web.WebEndpointResponse;\r\nimport org.springframework.boot.actuate.health.HealthEndpoint;\r\nimport org.springframework.boot.actuate.health.HttpCodeStatusMapper;\r\nimport org.springframework.boot.actuate.health.Status;\r\nimport org.springframework.stereotype.Component;\r\n\r\n/**\r\n * Example:\r\n * # HELP health_status HealthCheck result in prometheus&#39;s response format\r\n * # TYPE health_status gauge\r\n * health_status{application=&quot;java-service&quot;,type=&quot;main&quot;,} 1.0\r\n * health_status{application=&quot;java-service&quot;,type=&quot;db&quot;,database=&quot;PostgreSQL&quot;,validationQuery=&quot;isValid()&quot;,} 1.0\r\n * health_status{application=&quot;java-service&quot;,type=&quot;diskSpace&quot;,total=&quot;506332180480&quot;,exists=&quot;true&quot;,threshold=&quot;10485760&quot;,free=&quot;412188921856&quot;,} 1.0\r\n * health_status{application=&quot;java-service&quot;,type=&quot;ping&quot;,} 1.0\r\n*/\r\n@Component\r\n@Endpoint(id = &quot;health-check&quot;)\r\npublic class HeathPrometheusEndpoint {\r\n\r\n    private static final String APPLICATION = &quot;application&quot;;\r\n    private static final String TYPE = &quot;type&quot;;\r\n    public static final String SAMPLE_HEALTH_STATUS = &quot;health_status&quot;;\r\n\r\n    private final HealthEndpoint healthEndpoint;\r\n    private final String appName;\r\n    private final ObjectMapper mapper;\r\n    private final HttpCodeStatusMapper httpCodeStatusMapper;\r\n\r\n    public HeathPrometheusEndpoint(HealthEndpoint healthEndpoint,\r\n                                   ObjectMapper mapper,\r\n                                   @Value(&quot;${spring.application.name:}&quot;) String appName,\r\n                                   HttpCodeStatusMapper httpCodeStatusMapper) {\r\n        this.healthEndpoint = healthEndpoint;\r\n        this.mapper = mapper;\r\n        this.appName = appName;\r\n        this.httpCodeStatusMapper = httpCodeStatusMapper;\r\n    }\r\n\r\n    @ReadOperation(produces = TextFormat.CONTENT_TYPE_004)\r\n    public WebEndpointResponse&lt;String&gt; healthPrometheus() {\r\n        StatusDto status = createStatusDto();\r\n        List&lt;Collector.MetricFamilySamples.Sample&gt; samples = new ArrayList&lt;&gt;();\r\n        samples.add(createMainSample(status));\r\n        samples.addAll(createComponentSamples(status));\r\n        return createStringWebEndpointResponse(status, createMetricFamily(samples));\r\n    }\r\n\r\n    @SneakyThrows\r\n    private StatusDto createStatusDto() {\r\n        return mapper.readValue(mapper.writeValueAsString(healthEndpoint.health()), StatusDto.class);\r\n    }\r\n\r\n\r\n    private Collector.MetricFamilySamples.Sample createMainSample(StatusDto status) {\r\n        Labels labels = new Labels();\r\n        labels.add(APPLICATION, appName);\r\n        labels.add(TYPE, &quot;main&quot;);\r\n\r\n        return createSample(SAMPLE_HEALTH_STATUS, labels, status.getStatus());\r\n    }\r\n\r\n    private List&lt;Collector.MetricFamilySamples.Sample&gt; createComponentSamples(StatusDto status) {\r\n        List&lt;Collector.MetricFamilySamples.Sample&gt; list = new ArrayList&lt;&gt;();\r\n        for (Map.Entry&lt;String, StatusDto&gt; entry : status.components.entrySet()) {\r\n            Labels labels = new Labels();\r\n            labels.add(APPLICATION, appName);\r\n            labels.add(TYPE, entry.getKey());\r\n\r\n            StatusDto statusDto = entry.getValue();\r\n            Map&lt;String, Object&gt; details = statusDto.getDetails();\r\n            if (details != null &amp;&amp; !details.isEmpty()) {\r\n                details.forEach((k, v) -&gt; labels.add(k, String.valueOf(v)));\r\n            }\r\n            list.add(createSample(SAMPLE_HEALTH_STATUS, labels, statusDto.getStatus()));\r\n        }\r\n        return list;\r\n    }\r\n\r\n    private Collector.MetricFamilySamples.Sample createSample(String name, Labels labels, Status status) {\r\n        double v = Status.UP.equals(status) ? 1 : 0;\r\n        return new Collector.MetricFamilySamples.Sample(name, labels.getLabels(), labels.getValues(), v);\r\n    }\r\n\r\n    private Collector.MetricFamilySamples createMetricFamily(List&lt;Collector.MetricFamilySamples.Sample&gt; s) {\r\n        return new Collector.MetricFamilySamples(\r\n            &quot;health_status&quot;, Collector.Type.GAUGE,\r\n            &quot;HealthCheck result in prometheus&#39;s response format&quot;, s);\r\n    }\r\n\r\n    private WebEndpointResponse&lt;String&gt; createStringWebEndpointResponse(\r\n        StatusDto status, Collector.MetricFamilySamples metricFamilySamples\r\n    ) {\r\n        try {\r\n            Writer writer = new StringWriter();\r\n            TextFormat.write004(writer,\r\n                Collections.enumeration(Collections.singletonList(metricFamilySamples)));\r\n\r\n            return wrapResponse(writer.toString(), status);\r\n        } catch (IOException ex) {\r\n            // This actually never happens since StringWriter::write() doesn&#39;t throw any\r\n            // IOException\r\n            throw new RuntimeException(&quot;Writing metrics failed&quot;, ex);\r\n        }\r\n    }\r\n\r\n    private WebEndpointResponse&lt;String&gt; wrapResponse(String body, StatusDto status) {\r\n        if (body == null || body.isEmpty()) {\r\n            return new WebEndpointResponse&lt;&gt;(&quot;&quot;, 500);\r\n        } else {\r\n            int statusCode = httpCodeStatusMapper.getStatusCode(status.getStatus());\r\n            return new WebEndpointResponse&lt;&gt;(body, statusCode);\r\n        }\r\n    }\r\n\r\n    public static class Labels {\r\n        private final Map&lt;String, String&gt; map = new HashMap&lt;&gt;();\r\n\r\n        public void add(String label, String value) {\r\n            if (value != null &amp;&amp; !value.isEmpty()) {\r\n                map.put(label, value);\r\n            }\r\n        }\r\n\r\n        public List&lt;String&gt; getLabels() {\r\n            return new ArrayList&lt;&gt;(map.keySet());\r\n        }\r\n\r\n        public List&lt;String&gt; getValues() {\r\n            return new ArrayList&lt;&gt;(map.values());\r\n        }\r\n    }\r\n\r\n    @Data\r\n    public static class StatusDto {\r\n        private Status status;\r\n        private Map&lt;String, StatusDto&gt; components;\r\n        private Map&lt;String, Object&gt; details;\r\n    }\r\n}\r\n```","title":"Obtain Spring actuator &#39;health&#39; metrics","body":"<p>Take a look on this example</p>\n<pre><code>package ru.formatko;\n\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport io.prometheus.client.Collector;\nimport io.prometheus.client.exporter.common.TextFormat;\nimport java.io.IOException;\nimport java.io.StringWriter;\nimport java.io.Writer;\nimport java.util.ArrayList;\nimport java.util.Collections;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport lombok.Data;\nimport lombok.SneakyThrows;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.boot.actuate.endpoint.annotation.Endpoint;\nimport org.springframework.boot.actuate.endpoint.annotation.ReadOperation;\nimport org.springframework.boot.actuate.endpoint.web.WebEndpointResponse;\nimport org.springframework.boot.actuate.health.HealthEndpoint;\nimport org.springframework.boot.actuate.health.HttpCodeStatusMapper;\nimport org.springframework.boot.actuate.health.Status;\nimport org.springframework.stereotype.Component;\n\n/**\n * Example:\n * # HELP health_status HealthCheck result in prometheus's response format\n * # TYPE health_status gauge\n * health_status{application=&quot;java-service&quot;,type=&quot;main&quot;,} 1.0\n * health_status{application=&quot;java-service&quot;,type=&quot;db&quot;,database=&quot;PostgreSQL&quot;,validationQuery=&quot;isValid()&quot;,} 1.0\n * health_status{application=&quot;java-service&quot;,type=&quot;diskSpace&quot;,total=&quot;506332180480&quot;,exists=&quot;true&quot;,threshold=&quot;10485760&quot;,free=&quot;412188921856&quot;,} 1.0\n * health_status{application=&quot;java-service&quot;,type=&quot;ping&quot;,} 1.0\n*/\n@Component\n@Endpoint(id = &quot;health-check&quot;)\npublic class HeathPrometheusEndpoint {\n\n    private static final String APPLICATION = &quot;application&quot;;\n    private static final String TYPE = &quot;type&quot;;\n    public static final String SAMPLE_HEALTH_STATUS = &quot;health_status&quot;;\n\n    private final HealthEndpoint healthEndpoint;\n    private final String appName;\n    private final ObjectMapper mapper;\n    private final HttpCodeStatusMapper httpCodeStatusMapper;\n\n    public HeathPrometheusEndpoint(HealthEndpoint healthEndpoint,\n                                   ObjectMapper mapper,\n                                   @Value(&quot;${spring.application.name:}&quot;) String appName,\n                                   HttpCodeStatusMapper httpCodeStatusMapper) {\n        this.healthEndpoint = healthEndpoint;\n        this.mapper = mapper;\n        this.appName = appName;\n        this.httpCodeStatusMapper = httpCodeStatusMapper;\n    }\n\n    @ReadOperation(produces = TextFormat.CONTENT_TYPE_004)\n    public WebEndpointResponse&lt;String&gt; healthPrometheus() {\n        StatusDto status = createStatusDto();\n        List&lt;Collector.MetricFamilySamples.Sample&gt; samples = new ArrayList&lt;&gt;();\n        samples.add(createMainSample(status));\n        samples.addAll(createComponentSamples(status));\n        return createStringWebEndpointResponse(status, createMetricFamily(samples));\n    }\n\n    @SneakyThrows\n    private StatusDto createStatusDto() {\n        return mapper.readValue(mapper.writeValueAsString(healthEndpoint.health()), StatusDto.class);\n    }\n\n\n    private Collector.MetricFamilySamples.Sample createMainSample(StatusDto status) {\n        Labels labels = new Labels();\n        labels.add(APPLICATION, appName);\n        labels.add(TYPE, &quot;main&quot;);\n\n        return createSample(SAMPLE_HEALTH_STATUS, labels, status.getStatus());\n    }\n\n    private List&lt;Collector.MetricFamilySamples.Sample&gt; createComponentSamples(StatusDto status) {\n        List&lt;Collector.MetricFamilySamples.Sample&gt; list = new ArrayList&lt;&gt;();\n        for (Map.Entry&lt;String, StatusDto&gt; entry : status.components.entrySet()) {\n            Labels labels = new Labels();\n            labels.add(APPLICATION, appName);\n            labels.add(TYPE, entry.getKey());\n\n            StatusDto statusDto = entry.getValue();\n            Map&lt;String, Object&gt; details = statusDto.getDetails();\n            if (details != null &amp;&amp; !details.isEmpty()) {\n                details.forEach((k, v) -&gt; labels.add(k, String.valueOf(v)));\n            }\n            list.add(createSample(SAMPLE_HEALTH_STATUS, labels, statusDto.getStatus()));\n        }\n        return list;\n    }\n\n    private Collector.MetricFamilySamples.Sample createSample(String name, Labels labels, Status status) {\n        double v = Status.UP.equals(status) ? 1 : 0;\n        return new Collector.MetricFamilySamples.Sample(name, labels.getLabels(), labels.getValues(), v);\n    }\n\n    private Collector.MetricFamilySamples createMetricFamily(List&lt;Collector.MetricFamilySamples.Sample&gt; s) {\n        return new Collector.MetricFamilySamples(\n            &quot;health_status&quot;, Collector.Type.GAUGE,\n            &quot;HealthCheck result in prometheus's response format&quot;, s);\n    }\n\n    private WebEndpointResponse&lt;String&gt; createStringWebEndpointResponse(\n        StatusDto status, Collector.MetricFamilySamples metricFamilySamples\n    ) {\n        try {\n            Writer writer = new StringWriter();\n            TextFormat.write004(writer,\n                Collections.enumeration(Collections.singletonList(metricFamilySamples)));\n\n            return wrapResponse(writer.toString(), status);\n        } catch (IOException ex) {\n            // This actually never happens since StringWriter::write() doesn't throw any\n            // IOException\n            throw new RuntimeException(&quot;Writing metrics failed&quot;, ex);\n        }\n    }\n\n    private WebEndpointResponse&lt;String&gt; wrapResponse(String body, StatusDto status) {\n        if (body == null || body.isEmpty()) {\n            return new WebEndpointResponse&lt;&gt;(&quot;&quot;, 500);\n        } else {\n            int statusCode = httpCodeStatusMapper.getStatusCode(status.getStatus());\n            return new WebEndpointResponse&lt;&gt;(body, statusCode);\n        }\n    }\n\n    public static class Labels {\n        private final Map&lt;String, String&gt; map = new HashMap&lt;&gt;();\n\n        public void add(String label, String value) {\n            if (value != null &amp;&amp; !value.isEmpty()) {\n                map.put(label, value);\n            }\n        }\n\n        public List&lt;String&gt; getLabels() {\n            return new ArrayList&lt;&gt;(map.keySet());\n        }\n\n        public List&lt;String&gt; getValues() {\n            return new ArrayList&lt;&gt;(map.values());\n        }\n    }\n\n    @Data\n    public static class StatusDto {\n        private Status status;\n        private Map&lt;String, StatusDto&gt; components;\n        private Map&lt;String, Object&gt; details;\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":5863731,"reputation":807,"user_id":4618492,"accept_rate":56,"display_name":"littleAlien"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":723,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":54419761,"answer_count":2,"score":0,"last_activity_date":1684830690,"creation_date":1548759239,"question_id":54419431,"body_markdown":"How to obtain Spring actuator `/health` metrics that already working? \r\nFor example, to push them to Grafana. Thus I need them as objects, not text.","title":"Obtain Spring actuator &#39;health&#39; metrics","body":"<p>How to obtain Spring actuator <code>/health</code> metrics that already working? \nFor example, to push them to Grafana. Thus I need them as objects, not text.</p>\n"},{"tags":["java","r","oracle","jdbc","odbc"],"owner":{"account_id":27305922,"reputation":37,"user_id":20821917,"display_name":"avishkar683"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":39,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684830535,"creation_date":1684830535,"question_id":76312699,"body_markdown":"I have created a table in the oracle database from a dataframe using the following code:\r\n\r\n```\r\ndrv_oracle &lt;- JDBC(oracle_driver, oracle_jdbc_jar)  #creating DBI driver\r\nconn_oracle &lt;- dbConnect(drv_oracle, oracle_url,&quot;username&quot;,&quot;password&quot;)  #creating DBIConnection Object\r\n\r\ndbWriteTable(conn_oracle,&quot;DECILE_ANALYSIS_BASE_TABLE&quot;,DECILE_ANALYSIS_FINAL) #DECILE_ANALYSIS_FINAL is dataframe\r\n```\r\nUsing the above code, the table is created in the database.\r\n\r\nBut now I have refreshed the DECILE_ANALYSIS_FINAL dataframe with new data. I want to append this data into my created table. \r\n\r\nThis I try to do using following code:\r\n\r\n```\r\nconn_oracle &lt;- dbConnect(drv_oracle, oracle_url,&quot;username&quot;,&quot;password&quot;) \r\ndbAppendTable(conn_oracle,&quot;DECILE_ANALYSIS_BASE_TABLE&quot;,DECILE_ANALYSIS_FINAL)\r\n```\r\n\r\nBut now I am getting following error:\r\n\r\n```\r\nError in dbSendQuery(conn, statement, ...) : \r\n  Unable to retrieve JDBC result set\r\n  JDBC ERROR: Missing IN or OUT parameter at index:: 1\r\n  Statement: INSERT INTO &quot;DECILE_ANALYSIS_BASE_TABLE&quot;\r\n  (&quot;FISCAL_YEAR&quot;, &quot;MONTH&quot;, &quot;GEO_LEVEL&quot;, &quot;GEO_CODE&quot;, &quot;PRODUCT_LEVEL&quot;, &quot;PRODUCT_CODE&quot;, &quot;CHANNEL_TYPE&quot;, &quot;DECILE&quot;, &quot;UOB&quot;, &quot;TULC&quot;, &quot;TTLC&quot;, &quot;TOTAL_SALES&quot;, &quot;PDO&quot;, &quot;UNIQUE_ID&quot;, &quot;AVG_PDO_DROP&quot;)\r\nVALUES\r\n  (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\r\n```\r\n\r\nPlease help me understand how I can resolve this issue.\r\n\r\nI tried the code mentioned above","title":"Unable to append to an Oracle table from R Server using dbAppendTable()","body":"<p>I have created a table in the oracle database from a dataframe using the following code:</p>\n<pre><code>drv_oracle &lt;- JDBC(oracle_driver, oracle_jdbc_jar)  #creating DBI driver\nconn_oracle &lt;- dbConnect(drv_oracle, oracle_url,&quot;username&quot;,&quot;password&quot;)  #creating DBIConnection Object\n\ndbWriteTable(conn_oracle,&quot;DECILE_ANALYSIS_BASE_TABLE&quot;,DECILE_ANALYSIS_FINAL) #DECILE_ANALYSIS_FINAL is dataframe\n</code></pre>\n<p>Using the above code, the table is created in the database.</p>\n<p>But now I have refreshed the DECILE_ANALYSIS_FINAL dataframe with new data. I want to append this data into my created table.</p>\n<p>This I try to do using following code:</p>\n<pre><code>conn_oracle &lt;- dbConnect(drv_oracle, oracle_url,&quot;username&quot;,&quot;password&quot;) \ndbAppendTable(conn_oracle,&quot;DECILE_ANALYSIS_BASE_TABLE&quot;,DECILE_ANALYSIS_FINAL)\n</code></pre>\n<p>But now I am getting following error:</p>\n<pre><code>Error in dbSendQuery(conn, statement, ...) : \n  Unable to retrieve JDBC result set\n  JDBC ERROR: Missing IN or OUT parameter at index:: 1\n  Statement: INSERT INTO &quot;DECILE_ANALYSIS_BASE_TABLE&quot;\n  (&quot;FISCAL_YEAR&quot;, &quot;MONTH&quot;, &quot;GEO_LEVEL&quot;, &quot;GEO_CODE&quot;, &quot;PRODUCT_LEVEL&quot;, &quot;PRODUCT_CODE&quot;, &quot;CHANNEL_TYPE&quot;, &quot;DECILE&quot;, &quot;UOB&quot;, &quot;TULC&quot;, &quot;TTLC&quot;, &quot;TOTAL_SALES&quot;, &quot;PDO&quot;, &quot;UNIQUE_ID&quot;, &quot;AVG_PDO_DROP&quot;)\nVALUES\n  (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n</code></pre>\n<p>Please help me understand how I can resolve this issue.</p>\n<p>I tried the code mentioned above</p>\n"},{"tags":["java","spring-boot","dependency-injection","integration-testing"],"comments":[{"owner":{"account_id":15064163,"reputation":13516,"user_id":10871900,"display_name":"dan1st is crying"},"score":0,"creation_date":1684829322,"post_id":76312467,"comment_id":134570297,"body_markdown":"Does injecting/autowiring a `MockMvc` bean normally work (Can you inject a `MockMvc` instance in your test) or does that result in an exception as well? What happens when removing the `@ContextConfiguration`?","body":"Does injecting/autowiring a <code>MockMvc</code> bean normally work (Can you inject a <code>MockMvc</code> instance in your test) or does that result in an exception as well? What happens when removing the <code>@ContextConfiguration</code>?"}],"answers":[{"comments":[{"owner":{"account_id":28660254,"reputation":13,"user_id":21945315,"display_name":"abaudat"},"score":0,"creation_date":1684834997,"post_id":76312684,"comment_id":134571627,"body_markdown":"Indeed this was the issue, we were actually misusing `@AutoConfigureAfter` and `@AutoConfigureBefore` in our codebase, which led me to think it would work in nested classes. Thank you very much for the quick answer, Andy.","body":"Indeed this was the issue, we were actually misusing <code>@AutoConfigureAfter</code> and <code>@AutoConfigureBefore</code> in our codebase, which led me to think it would work in nested classes. Thank you very much for the quick answer, Andy."}],"tags":[],"owner":{"account_id":1473276,"reputation":111009,"user_id":1384297,"accept_rate":100,"display_name":"Andy Wilkinson"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1684830404,"creation_date":1684830404,"answer_id":76312684,"question_id":76312467,"body_markdown":"`@AutoConfigureAfter` only works on a top-level class that is listed in `spring.factories`. You haven&#39;t shown your `spring.factories` file, but assuming that it lists `MyAutoConfiguration`, that&#39;s the class on which `@AutoConfigureAfter` should be placed.","title":"@ConditionalOnBean not being triggered even though Bean exists in SpringBootTest","body":"<p><code>@AutoConfigureAfter</code> only works on a top-level class that is listed in <code>spring.factories</code>. You haven't shown your <code>spring.factories</code> file, but assuming that it lists <code>MyAutoConfiguration</code>, that's the class on which <code>@AutoConfigureAfter</code> should be placed.</p>\n"}],"owner":{"account_id":28660254,"reputation":13,"user_id":21945315,"display_name":"abaudat"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":94,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76312684,"answer_count":1,"score":1,"last_activity_date":1684830404,"creation_date":1684828746,"question_id":76312467,"body_markdown":"I have the following AutoConfiguration class:\r\n\r\n```\r\n@Configuration\r\npublic class MyAutoConfiguration {\r\n  @AutoConfigureAfter(MockMvcAutoConfiguration.class)\r\n  class MyNestedAutoConfiguration {\r\n    @ConditionalOnBean(MockMvc.class)\r\n    @Bean\r\n    AugmentedMockMvc augmentedMockMvc(MockMvc mockMvc) {\r\n      return new AugmentedMockMvc(mockMvc);\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nThe class is properly registered in spring.factories, and it is imported as a maven dependency in my Spring Boot application. My Spring Boot application looks like the following:\r\n\r\n```\r\n@SpringBootApplication\r\npublic class MySpringBootApp {\r\n  public static void main(String[] args) {\r\n    SpringApplication.run(MySpringBootApp.class, args);\r\n  }\r\n}\r\n```\r\n\r\nFinally, I have an integration test that is defined like this:\r\n\r\n```\r\n@SpringBootTest(classes = {MySpringBootApp.class})\r\n@AutoConfigureMockMvc\r\n@ContextConfiguration(initializers = {MyInitializer.class})\r\nclass MyTest {\r\n  @Autowired\r\n  private AugmentedMockMvc augmentedMockMvc;\r\n}\r\n```\r\n\r\n`MyInitializer` can be ignored, it doesn&#39;t do anything meaningful here, but it is needed and therefore I need to use both `@SpringBootTest` and `@ContextConfiguration`.\r\n\r\n**The issue is the following**: With this setup, the augmentedMockMvc Bean is not created because it does not match the `@ConditionalOnBean(MockMvc.class)` condition. \r\n\r\nI tried two things:\r\n- Adding `classes = {MockMvcAutoConfiguration.class}` to `@ContextConfiguration`. This works fine and fixes the issue, the augmentedMockMvc Bean is now properly registered\r\n- Removing the `@ConditionalOnBean(MockMvc.class)` annotation from the Bean creation. Weirdly enough, this also works! The MockMvc Bean is actually there, but it is not discovered by Spring when evaluating the `@ConditionalOnBean` annotation.\r\n\r\nI don&#39;t understand why the MockMvc Bean is not found by the `@ConditionalOnBean(MockMvc.class)` even though the Bean exists unless I specifically put the class in the `@ContextConfiguration`, I would think that having `@AutoConfigureMockMvc` on `MyTest` should be enough for the `MockMvcAutoConfiguration.class` class to be in the context","title":"@ConditionalOnBean not being triggered even though Bean exists in SpringBootTest","body":"<p>I have the following AutoConfiguration class:</p>\n<pre><code>@Configuration\npublic class MyAutoConfiguration {\n  @AutoConfigureAfter(MockMvcAutoConfiguration.class)\n  class MyNestedAutoConfiguration {\n    @ConditionalOnBean(MockMvc.class)\n    @Bean\n    AugmentedMockMvc augmentedMockMvc(MockMvc mockMvc) {\n      return new AugmentedMockMvc(mockMvc);\n    }\n  }\n}\n</code></pre>\n<p>The class is properly registered in spring.factories, and it is imported as a maven dependency in my Spring Boot application. My Spring Boot application looks like the following:</p>\n<pre><code>@SpringBootApplication\npublic class MySpringBootApp {\n  public static void main(String[] args) {\n    SpringApplication.run(MySpringBootApp.class, args);\n  }\n}\n</code></pre>\n<p>Finally, I have an integration test that is defined like this:</p>\n<pre><code>@SpringBootTest(classes = {MySpringBootApp.class})\n@AutoConfigureMockMvc\n@ContextConfiguration(initializers = {MyInitializer.class})\nclass MyTest {\n  @Autowired\n  private AugmentedMockMvc augmentedMockMvc;\n}\n</code></pre>\n<p><code>MyInitializer</code> can be ignored, it doesn't do anything meaningful here, but it is needed and therefore I need to use both <code>@SpringBootTest</code> and <code>@ContextConfiguration</code>.</p>\n<p><strong>The issue is the following</strong>: With this setup, the augmentedMockMvc Bean is not created because it does not match the <code>@ConditionalOnBean(MockMvc.class)</code> condition.</p>\n<p>I tried two things:</p>\n<ul>\n<li>Adding <code>classes = {MockMvcAutoConfiguration.class}</code> to <code>@ContextConfiguration</code>. This works fine and fixes the issue, the augmentedMockMvc Bean is now properly registered</li>\n<li>Removing the <code>@ConditionalOnBean(MockMvc.class)</code> annotation from the Bean creation. Weirdly enough, this also works! The MockMvc Bean is actually there, but it is not discovered by Spring when evaluating the <code>@ConditionalOnBean</code> annotation.</li>\n</ul>\n<p>I don't understand why the MockMvc Bean is not found by the <code>@ConditionalOnBean(MockMvc.class)</code> even though the Bean exists unless I specifically put the class in the <code>@ContextConfiguration</code>, I would think that having <code>@AutoConfigureMockMvc</code> on <code>MyTest</code> should be enough for the <code>MockMvcAutoConfiguration.class</code> class to be in the context</p>\n"},{"tags":["java","spring-boot","testing","spring-boot-actuator","dynamic-properties"],"answers":[{"comments":[{"owner":{"account_id":3274061,"reputation":2691,"user_id":2756760,"accept_rate":51,"display_name":"du-it"},"score":0,"creation_date":1634663038,"post_id":69623653,"comment_id":123084110,"body_markdown":"The first version works well. The second doesn&#39;t. This produces a java.lang.IndexOutOfBoundsException: Index 0 out of bounds for length 0","body":"The first version works well. The second doesn&#39;t. This produces a java.lang.IndexOutOfBoundsException: Index 0 out of bounds for length 0"},{"owner":{"account_id":22354823,"reputation":16499,"user_id":16572295,"display_name":"Jo&#227;o Dias"},"score":0,"creation_date":1634663424,"post_id":69623653,"comment_id":123084237,"body_markdown":"Thanks for the feedback. I will remove the second option ;)","body":"Thanks for the feedback. I will remove the second option ;)"}],"tags":[],"owner":{"account_id":22354823,"reputation":16499,"user_id":16572295,"display_name":"Jo&#227;o Dias"},"comment_count":2,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1634663434,"creation_date":1634600511,"answer_id":69623653,"question_id":69620134,"body_markdown":"Try the following:\r\n```java\r\n@ExtendWith(SpringExtension.class)\r\n@EnableConfigurationProperties(value = AdapterHealthCheckConfig.class)\r\n@TestPropertySource(&quot;classpath:application-test.properties&quot;)\r\nclass AppHealthCheckConfigTest {\r\n\r\n    @Autowired\r\n    private AdapterHealthCheckConfig config;\r\n\r\n    @Test\r\n    void healthCheckBeansAreInitialized() {\r\n//        config.init();\r\n        System.out.println(config.getApps().get(0));\r\n\r\n    }\r\n}\r\n```","title":"How to test multiple instance creation of a bean of one class filled with values from application.properties?","body":"<p>Try the following:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@ExtendWith(SpringExtension.class)\n@EnableConfigurationProperties(value = AdapterHealthCheckConfig.class)\n@TestPropertySource(&quot;classpath:application-test.properties&quot;)\nclass AppHealthCheckConfigTest {\n\n    @Autowired\n    private AdapterHealthCheckConfig config;\n\n    @Test\n    void healthCheckBeansAreInitialized() {\n//        config.init();\n        System.out.println(config.getApps().get(0));\n\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":3274061,"reputation":2691,"user_id":2756760,"accept_rate":51,"display_name":"du-it"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":261,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":69623653,"answer_count":1,"score":0,"last_activity_date":1684830396,"creation_date":1634577839,"question_id":69620134,"body_markdown":"After creating multiple beans of a specific class using @PostConstruct according to [Multiple instances of a bean of one class filled with values from application.properties][1]\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/69571749/multiple-instances-of-a-bean-of-one-class-filled-with-values-from-application-pr/69574978?noredirect=1#comment123021394_69574978\r\n\r\nI wonder how I could test the creation of those bean instances.\r\n\r\nI tried it this way:\r\n\r\n    @ActiveProfiles(&quot;test&quot;)\r\n    @RequiredArgsConstructor\r\n    @ExtendWith({SpringExtension.class, MockitoExtension.class})\r\n    @SpringBootTest(classes = {AppHealthCheckContributor.class, AppHealthCheckProperties.class})\r\n    @ConfigurationProperties(prefix = &quot;healthcheck&quot;)\r\n    @ContextConfiguration(classes = { AppHealthCheckConfig.class })\r\n    //@TestPropertySource(properties = &quot;healthcheck.app[0].name=testHealthIndicator, healthcheck.app[0].baseUrl=http://localhost, healthcheck.app[0].basePath=/test&quot;)\r\n    @TestPropertySource(locations = {&quot;/application-test.properties&quot;})\r\n    class AppHealthCheckConfigTest {\r\n    \r\n        @Autowired\r\n        private AdapterHealthCheckConfig config;\r\n    \r\n        @Test\r\n        void healthCheckBeansAreInitialized() {\r\n    //        config.init();\r\n            System.out.println(config.getApps().get(0));\r\n    \r\n        }\r\n    }\r\n\r\nbut this results in: `AppHealthCheckProperties(baseUrl=null, basePath=null, name=null)`\r\n","title":"How to test multiple instance creation of a bean of one class filled with values from application.properties?","body":"<p>After creating multiple beans of a specific class using @PostConstruct according to <a href=\"https://stackoverflow.com/questions/69571749/multiple-instances-of-a-bean-of-one-class-filled-with-values-from-application-pr/69574978?noredirect=1#comment123021394_69574978\">Multiple instances of a bean of one class filled with values from application.properties</a></p>\n<p>I wonder how I could test the creation of those bean instances.</p>\n<p>I tried it this way:</p>\n<pre><code>@ActiveProfiles(&quot;test&quot;)\n@RequiredArgsConstructor\n@ExtendWith({SpringExtension.class, MockitoExtension.class})\n@SpringBootTest(classes = {AppHealthCheckContributor.class, AppHealthCheckProperties.class})\n@ConfigurationProperties(prefix = &quot;healthcheck&quot;)\n@ContextConfiguration(classes = { AppHealthCheckConfig.class })\n//@TestPropertySource(properties = &quot;healthcheck.app[0].name=testHealthIndicator, healthcheck.app[0].baseUrl=http://localhost, healthcheck.app[0].basePath=/test&quot;)\n@TestPropertySource(locations = {&quot;/application-test.properties&quot;})\nclass AppHealthCheckConfigTest {\n\n    @Autowired\n    private AdapterHealthCheckConfig config;\n\n    @Test\n    void healthCheckBeansAreInitialized() {\n//        config.init();\n        System.out.println(config.getApps().get(0));\n\n    }\n}\n</code></pre>\n<p>but this results in: <code>AppHealthCheckProperties(baseUrl=null, basePath=null, name=null)</code></p>\n"},{"tags":["java","environment-variables","redhat","logback","splunk"],"comments":[{"owner":{"account_id":446597,"reputation":22464,"user_id":839733,"accept_rate":69,"display_name":"Abhijit Sarkar"},"score":0,"creation_date":1683794524,"post_id":76120674,"comment_id":134422077,"body_markdown":"VM options aren’t env variables. There’s a separate place for those in IntelliJ. Are you saying you can export it to Splunk from local?","body":"VM options aren’t env variables. There’s a separate place for those in IntelliJ. Are you saying you can export it to Splunk from local?"},{"owner":{"account_id":6383695,"reputation":5206,"user_id":4952262,"accept_rate":71,"display_name":"Michu93"},"score":0,"creation_date":1683798655,"post_id":76120674,"comment_id":134423039,"body_markdown":"in `logback.xml` both are checked (env variables at the end if I recall, JVM options before). Yes, when I put into configuration in IntelliJ into `VM options` `env` and `hostname` then it&#39;s exported to SPLUNK and I can see it there.","body":"in <code>logback.xml</code> both are checked (env variables at the end if I recall, JVM options before). Yes, when I put into configuration in IntelliJ into <code>VM options</code> <code>env</code> and <code>hostname</code> then it&#39;s exported to SPLUNK and I can see it there."}],"answers":[{"tags":[],"owner":{"account_id":6383695,"reputation":5206,"user_id":4952262,"accept_rate":71,"display_name":"Michu93"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1684830208,"creation_date":1684830208,"answer_id":76312658,"question_id":76120674,"body_markdown":"    &lt;source&gt;${env}&lt;/source&gt;\r\n\r\nis perfectly fine, there was discrepancy between start scripts which I was using.\r\n\r\nTo conclude: \r\nIf you use `${variable}` and in start script you use `-Dvariable = something` then it works.","title":"Can&#39;t read one variable in logback.xml but can read another","body":"<pre><code>&lt;source&gt;${env}&lt;/source&gt;\n</code></pre>\n<p>is perfectly fine, there was discrepancy between start scripts which I was using.</p>\n<p>To conclude:\nIf you use <code>${variable}</code> and in start script you use <code>-Dvariable = something</code> then it works.</p>\n"}],"owner":{"account_id":6383695,"reputation":5206,"user_id":4952262,"accept_rate":71,"display_name":"Michu93"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":111,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76312658,"answer_count":1,"score":0,"last_activity_date":1684830208,"creation_date":1682600027,"question_id":76120674,"body_markdown":"I am trying to read env variable in `logback.xml` file.\r\nI can do:\r\n\r\n    &lt;variable name=&quot;JAVA&quot; value=&quot;${JAVA_HOME}&quot; /&gt;\r\n\r\nand the use it later:\r\n\r\n    &lt;source&gt;MY APP ${JAVA}&lt;/source&gt;\r\nand it works however when I created new variable by `setenv ENV TEST` (it&#39;s Red Hat) and I check if it&#39;s in environment variables by `printenv` then I can see it `ENV=TEST`. When I try to define it in `logback.xml` the same way as `JAVA_HOME` so: `&lt;variable name=&quot;ENVIRONMENT&quot; value=&quot;${ENV}&quot; /&gt;` and use here:\r\n    \r\n\r\n    &lt;source&gt;MY APP ${ENVIRONMENT}&lt;/source&gt;\r\n\r\nthen I can see in SPLUNK: `source = MY APP ENV_IS_UNDEFINED`\r\n\r\nOr is there another way to put `ENVIRONMENT` value somewhere and then read `ENVIRONMENT` in `logback.xml`?\r\n\r\nI found: https://stackoverflow.com/questions/41715211/if-condition-in-logback-print-log-messages-in-two-different-folders but my problem is different\r\n\r\n\r\n@Edit\r\n\r\nEven though I am starting process with:\r\n\r\n    $JAVA_HOME/bin/java \\\r\n        -Duser.timezone=GMT \\\r\n        -Denv=&quot;test&quot; \\\r\n        -Dhost=&quot;127.0.0.1&quot; \\\r\n        ...\r\n\r\nand trying to send it to SPLUNK by `&lt;source&gt;MY APP ${env}&lt;/source&gt;` I can see in SPLNUK UI `source = MY APP env_IS_UNDEFINED`\r\n\r\nWhen I run service locally with: [![VM options][1]][1] then it works locally\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/cOJgn.png","title":"Can&#39;t read one variable in logback.xml but can read another","body":"<p>I am trying to read env variable in <code>logback.xml</code> file.\nI can do:</p>\n<pre><code>&lt;variable name=&quot;JAVA&quot; value=&quot;${JAVA_HOME}&quot; /&gt;\n</code></pre>\n<p>and the use it later:</p>\n<pre><code>&lt;source&gt;MY APP ${JAVA}&lt;/source&gt;\n</code></pre>\n<p>and it works however when I created new variable by <code>setenv ENV TEST</code> (it's Red Hat) and I check if it's in environment variables by <code>printenv</code> then I can see it <code>ENV=TEST</code>. When I try to define it in <code>logback.xml</code> the same way as <code>JAVA_HOME</code> so: <code>&lt;variable name=&quot;ENVIRONMENT&quot; value=&quot;${ENV}&quot; /&gt;</code> and use here:</p>\n<pre><code>&lt;source&gt;MY APP ${ENVIRONMENT}&lt;/source&gt;\n</code></pre>\n<p>then I can see in SPLUNK: <code>source = MY APP ENV_IS_UNDEFINED</code></p>\n<p>Or is there another way to put <code>ENVIRONMENT</code> value somewhere and then read <code>ENVIRONMENT</code> in <code>logback.xml</code>?</p>\n<p>I found: <a href=\"https://stackoverflow.com/questions/41715211/if-condition-in-logback-print-log-messages-in-two-different-folders\">if condition in logback - print log messages in two different folders</a> but my problem is different</p>\n<p>@Edit</p>\n<p>Even though I am starting process with:</p>\n<pre><code>$JAVA_HOME/bin/java \\\n    -Duser.timezone=GMT \\\n    -Denv=&quot;test&quot; \\\n    -Dhost=&quot;127.0.0.1&quot; \\\n    ...\n</code></pre>\n<p>and trying to send it to SPLUNK by <code>&lt;source&gt;MY APP ${env}&lt;/source&gt;</code> I can see in SPLNUK UI <code>source = MY APP env_IS_UNDEFINED</code></p>\n<p>When I run service locally with: <a href=\"https://i.stack.imgur.com/cOJgn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cOJgn.png\" alt=\"VM options\" /></a> then it works locally</p>\n"},{"tags":["java","priority-queue","hamming-numbers"],"comments":[{"owner":{"account_id":13949449,"reputation":757,"user_id":10073327,"display_name":"FailingCoder"},"score":0,"creation_date":1570146471,"post_id":58227806,"comment_id":102831173,"body_markdown":"Use the % sign. i.e. n % 2, n % 3, and n % 5","body":"Use the % sign. i.e. n % 2, n % 3, and n % 5"},{"owner":{"account_id":453089,"reputation":70352,"user_id":849891,"accept_rate":100,"display_name":"Will Ness"},"score":0,"creation_date":1684829993,"post_id":58227806,"comment_id":134570437,"body_markdown":"find the pointers at https://stackoverflow.com/questions/tagged/hamming-numbers.","body":"find the pointers at <a href=\"https://stackoverflow.com/questions/tagged/hamming-numbers\">stackoverflow.com/questions/tagged/hamming-numbers</a>."}],"answers":[{"tags":[],"owner":{"account_id":14543637,"reputation":370,"user_id":10504512,"display_name":"LockieR"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1570158879,"creation_date":1570158879,"answer_id":58229444,"question_id":58227806,"body_markdown":"Not sure why the use of PriorityQueue, but a pretty ugly brute force way to solve the question would be something like this.\r\n```\r\nimport java.util.Arrays;\r\nimport java.util.List;\r\nimport java.util.PriorityQueue;\r\nimport java.util.stream.Collectors;\r\n\r\npublic class Driver {\r\n\r\n    public static void main(String[] args) {\r\n        Driver driver = new Driver();\r\n        System.out.println(driver.getRegularNumber(30)\r\n                .toString());\r\n    }\r\n\r\n    public PriorityQueue&lt;Integer&gt; getRegularNumber(int n) {\r\n        PriorityQueue&lt;Integer&gt; regularNumbers = new PriorityQueue&lt;&gt;();\r\n        int count = 0;\r\n        int current = 1;\r\n        List&lt;Integer&gt; pf;\r\n        List&lt;Integer&gt; apf = Arrays.asList(2, 3, 5);\r\n        while (count &lt; n) {\r\n            // Get the prime factors of the current number.\r\n            // If it is a subset of the allowed prime factors then add it to the Queue.\r\n            pf = primeFactors(current);\r\n            if (apf.containsAll(pf)) {\r\n                regularNumbers.add(current);\r\n                count++;\r\n            }\r\n            current++;\r\n        }\r\n        return regularNumbers;\r\n    }\r\n\r\n    public static List&lt;Integer&gt; primeFactors(int n) {\r\n        List&lt;Integer&gt; factors = new ArrayList&lt;&gt;();\r\n        for (int i = 2; i &lt; n; i++) {\r\n            while (n % i == 0) {\r\n                factors.add(i);\r\n                n = n / i;\r\n            }\r\n        }\r\n        if (n &gt; 2) {\r\n            factors.add(n);\r\n        }\r\n\r\n        factors = factors.stream()\r\n                .distinct()\r\n                .collect(Collectors.toList());\r\n        return factors;\r\n    }\r\n}   \r\n```\r\nThis produces ```[1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15, 16, 18, 20, 24, 25, 27, 30, 32, 36, 40, 45, 48, 50, 54, 60, 64, 72, 75, 80]``` as output.","title":"Need help finding nth regular number","body":"<p>Not sure why the use of PriorityQueue, but a pretty ugly brute force way to solve the question would be something like this.</p>\n\n<pre><code>import java.util.Arrays;\nimport java.util.List;\nimport java.util.PriorityQueue;\nimport java.util.stream.Collectors;\n\npublic class Driver {\n\n    public static void main(String[] args) {\n        Driver driver = new Driver();\n        System.out.println(driver.getRegularNumber(30)\n                .toString());\n    }\n\n    public PriorityQueue&lt;Integer&gt; getRegularNumber(int n) {\n        PriorityQueue&lt;Integer&gt; regularNumbers = new PriorityQueue&lt;&gt;();\n        int count = 0;\n        int current = 1;\n        List&lt;Integer&gt; pf;\n        List&lt;Integer&gt; apf = Arrays.asList(2, 3, 5);\n        while (count &lt; n) {\n            // Get the prime factors of the current number.\n            // If it is a subset of the allowed prime factors then add it to the Queue.\n            pf = primeFactors(current);\n            if (apf.containsAll(pf)) {\n                regularNumbers.add(current);\n                count++;\n            }\n            current++;\n        }\n        return regularNumbers;\n    }\n\n    public static List&lt;Integer&gt; primeFactors(int n) {\n        List&lt;Integer&gt; factors = new ArrayList&lt;&gt;();\n        for (int i = 2; i &lt; n; i++) {\n            while (n % i == 0) {\n                factors.add(i);\n                n = n / i;\n            }\n        }\n        if (n &gt; 2) {\n            factors.add(n);\n        }\n\n        factors = factors.stream()\n                .distinct()\n                .collect(Collectors.toList());\n        return factors;\n    }\n}   \n</code></pre>\n\n<p>This produces <code>[1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15, 16, 18, 20, 24, 25, 27, 30, 32, 36, 40, 45, 48, 50, 54, 60, 64, 72, 75, 80]</code> as output.</p>\n"}],"owner":{"account_id":16821406,"reputation":19,"user_id":12161764,"display_name":"jahnpahl"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":242,"favorite_count":0,"down_vote_count":8,"up_vote_count":2,"answer_count":1,"score":-6,"last_activity_date":1684830092,"creation_date":1570142751,"question_id":58227806,"body_markdown":"Problem:\r\n\r\n&gt; &quot;Babylonians use regular numbers to keep time.\r\n&gt;\r\n&gt; A *&quot;regular number&quot;* in math is defined to be a number that is a factor of some power of 60 (60, 3600, etc). Equivalently we can say that a regular number is one whose ONLY prime divisors are 2, 3 and 5. The first 10 regular numbers are:\r\n&gt;\r\n&gt; 1, 2, 3, 4, 5, 6, 8, 9, 10, 12.\r\n&gt;\r\n&gt; Your task is to find the *n*-th regular number.&quot;\r\n\r\nMy professor asked us to specifically use priority queue to solve this problem, and the largest number we&#39;ll test is no more than *`n = 300`*. I&#39;m clueless.\r\n\r\nedit: I&#39;m obviously not asking for the complete code, I just need pointers to get me started.","title":"Need help finding nth regular number","body":"<p>Problem:</p>\n<blockquote>\n<p>&quot;Babylonians use regular numbers to keep time.</p>\n<p>A <em>&quot;regular number&quot;</em> in math is defined to be a number that is a factor of some power of 60 (60, 3600, etc). Equivalently we can say that a regular number is one whose ONLY prime divisors are 2, 3 and 5. The first 10 regular numbers are:</p>\n<p>1, 2, 3, 4, 5, 6, 8, 9, 10, 12.</p>\n<p>Your task is to find the <em>n</em>-th regular number.&quot;</p>\n</blockquote>\n<p>My professor asked us to specifically use priority queue to solve this problem, and the largest number we'll test is no more than <em><code>n = 300</code></em>. I'm clueless.</p>\n<p>edit: I'm obviously not asking for the complete code, I just need pointers to get me started.</p>\n"},{"tags":["java","spring","prometheus","spring-boot-actuator"],"answers":[{"comments":[{"owner":{"account_id":11433301,"reputation":380,"user_id":8381420,"display_name":"saba"},"score":0,"creation_date":1655202398,"post_id":63578224,"comment_id":128270812,"body_markdown":"mine is already 1.5.4 but keep getting this error. i updated to 1.6.1 it worked!","body":"mine is already 1.5.4 but keep getting this error. i updated to 1.6.1 it worked!"}],"tags":[],"owner":{"account_id":5881849,"reputation":158,"user_id":4630958,"display_name":"flo-ferox"},"comment_count":1,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1598356183,"creation_date":1598356183,"answer_id":63578224,"question_id":63575808,"body_markdown":"I solved my problem by updating `micrometer-registry-prometheus` from 1.5.1 to 1.5.4\r\n\r\nWith this update the error message was more speakable:\r\n```\r\nPrometheus requires that all meters with the same name have the same set of tag keys. There is already an existing meter named &#39;jvm_gc_pause_seconds&#39; containing tag keys [username, endpoint]. The meter you are attempting to register has keys [username, endpoint, service].\r\n```\r\n\r\nSo I found the problem. I added a common tag to all metrics. After removing the common tag, the error was solved.","title":"Error from promtheus in java (spring acuator)","body":"<p>I solved my problem by updating <code>micrometer-registry-prometheus</code> from 1.5.1 to 1.5.4</p>\n<p>With this update the error message was more speakable:</p>\n<pre><code>Prometheus requires that all meters with the same name have the same set of tag keys. There is already an existing meter named 'jvm_gc_pause_seconds' containing tag keys [username, endpoint]. The meter you are attempting to register has keys [username, endpoint, service].\n</code></pre>\n<p>So I found the problem. I added a common tag to all metrics. After removing the common tag, the error was solved.</p>\n"}],"owner":{"account_id":5881849,"reputation":158,"user_id":4630958,"display_name":"flo-ferox"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2538,"favorite_count":0,"down_vote_count":0,"up_vote_count":6,"accepted_answer_id":63578224,"answer_count":1,"score":6,"last_activity_date":1684829513,"creation_date":1598347363,"question_id":63575808,"body_markdown":"I enabled and configured Spring Actuator with Prometheus endpoint in my spring boot application. But I receive an error, that Prometheus requires that all meters with the same name have the same set of tag keys. But unfortunately Spring Actuator won&#39;t do that for `jvm_gc_pause_seconds`.\r\n\r\nI&#39;m using:\r\n```\r\n&lt;parent&gt;\r\n\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t&lt;version&gt;2.3.1.RELEASE&lt;/version&gt;\r\n&lt;/parent&gt;\r\n```\r\nwith\r\n```\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\r\n&lt;/dependency&gt;\r\n\r\n....\r\n\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;io.micrometer&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;micrometer-core&lt;/artifactId&gt;\r\n\t&lt;version&gt;1.5.1&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;io.micrometer&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;micrometer-registry-prometheus&lt;/artifactId&gt;\r\n\t&lt;version&gt;1.5.1&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```\r\n\r\n\r\nThis is my error message:\r\n```\r\njava.lang.IllegalArgumentException: Prometheus requires that all meters with the same name have the same set of tag keys. There is already an existing meter named &#39;jvm_gc_pause_seconds&#39;  │\r\n│     at io.micrometer.prometheus.PrometheusMeterRegistry.lambda$applyToCollector$17(PrometheusMeterRegistry.java:429)                                                                       │\r\n│     at java.base/java.util.concurrent.ConcurrentHashMap.compute(Unknown Source)                                                                                                            │\r\n│     at io.micrometer.prometheus.PrometheusMeterRegistry.applyToCollector(PrometheusMeterRegistry.java:413)                                                                                 │\r\n│     at io.micrometer.prometheus.PrometheusMeterRegistry.newTimer(PrometheusMeterRegistry.java:196)                                                                                         │\r\n│     at io.micrometer.core.instrument.MeterRegistry.lambda$timer$2(MeterRegistry.java:308)                                                                                                  │\r\n│     at io.micrometer.core.instrument.MeterRegistry.getOrCreateMeter(MeterRegistry.java:612)                                                                                                │\r\n│     at io.micrometer.core.instrument.MeterRegistry.registerMeterIfNecessary(MeterRegistry.java:566)                                                                                        │\r\n│     at io.micrometer.core.instrument.MeterRegistry.timer(MeterRegistry.java:306)                                                                                                           │\r\n│     at io.micrometer.core.instrument.Timer$Builder.register(Timer.java:539)                                                                                                                │\r\n│     at io.micrometer.core.instrument.binder.jvm.JvmGcMetrics.lambda$bindTo$1(JvmGcMetrics.java:151)                                                                                        │\r\n│     at java.management/sun.management.NotificationEmitterSupport.sendNotification(Unknown Source)                                                                                          │\r\n│     at jdk.management/com.sun.management.internal.GarbageCollectorExtImpl.createGCNotification(Unknown Source)\r\n```\r\n\r\nAny idea?!\r\nI don&#39;t have this error when I remove the Prometheus endpoint configuration (`micrometer-registry-prometheus` dependency).","title":"Error from promtheus in java (spring acuator)","body":"<p>I enabled and configured Spring Actuator with Prometheus endpoint in my spring boot application. But I receive an error, that Prometheus requires that all meters with the same name have the same set of tag keys. But unfortunately Spring Actuator won't do that for <code>jvm_gc_pause_seconds</code>.</p>\n<p>I'm using:</p>\n<pre><code>&lt;parent&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n    &lt;version&gt;2.3.1.RELEASE&lt;/version&gt;\n&lt;/parent&gt;\n</code></pre>\n<p>with</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n....\n\n&lt;dependency&gt;\n    &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\n    &lt;artifactId&gt;micrometer-core&lt;/artifactId&gt;\n    &lt;version&gt;1.5.1&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\n    &lt;artifactId&gt;micrometer-registry-prometheus&lt;/artifactId&gt;\n    &lt;version&gt;1.5.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>This is my error message:</p>\n<pre><code>java.lang.IllegalArgumentException: Prometheus requires that all meters with the same name have the same set of tag keys. There is already an existing meter named 'jvm_gc_pause_seconds'  │\n│     at io.micrometer.prometheus.PrometheusMeterRegistry.lambda$applyToCollector$17(PrometheusMeterRegistry.java:429)                                                                       │\n│     at java.base/java.util.concurrent.ConcurrentHashMap.compute(Unknown Source)                                                                                                            │\n│     at io.micrometer.prometheus.PrometheusMeterRegistry.applyToCollector(PrometheusMeterRegistry.java:413)                                                                                 │\n│     at io.micrometer.prometheus.PrometheusMeterRegistry.newTimer(PrometheusMeterRegistry.java:196)                                                                                         │\n│     at io.micrometer.core.instrument.MeterRegistry.lambda$timer$2(MeterRegistry.java:308)                                                                                                  │\n│     at io.micrometer.core.instrument.MeterRegistry.getOrCreateMeter(MeterRegistry.java:612)                                                                                                │\n│     at io.micrometer.core.instrument.MeterRegistry.registerMeterIfNecessary(MeterRegistry.java:566)                                                                                        │\n│     at io.micrometer.core.instrument.MeterRegistry.timer(MeterRegistry.java:306)                                                                                                           │\n│     at io.micrometer.core.instrument.Timer$Builder.register(Timer.java:539)                                                                                                                │\n│     at io.micrometer.core.instrument.binder.jvm.JvmGcMetrics.lambda$bindTo$1(JvmGcMetrics.java:151)                                                                                        │\n│     at java.management/sun.management.NotificationEmitterSupport.sendNotification(Unknown Source)                                                                                          │\n│     at jdk.management/com.sun.management.internal.GarbageCollectorExtImpl.createGCNotification(Unknown Source)\n</code></pre>\n<p>Any idea?!\nI don't have this error when I remove the Prometheus endpoint configuration (<code>micrometer-registry-prometheus</code> dependency).</p>\n"},{"tags":["java","eclipse","selenium-webdriver","automation","selenium-firefoxdriver"],"answers":[{"tags":[],"owner":{"account_id":10299692,"reputation":5744,"user_id":7598774,"accept_rate":75,"display_name":"Shawn"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684829508,"creation_date":1684829508,"answer_id":76312565,"question_id":76312266,"body_markdown":"Just get rid of the below line, you don&#39;t need to set property and provide the location of `driver.exe` if you are using Selenium `v4.6.0` or above.\r\n\r\n````\r\nSystem.setProperty(&quot;webdriver.gecko.driver&quot;,\r\n                           &quot;D:\\\\Selenium\\\\BrowserJars\\\\geckodriver113.exe&quot;);\r\n````\r\n\r\nReferences: [Introducing Selenium Manager](https://www.selenium.dev/blog/2022/introducing-selenium-manager/)","title":"Unable to launch Firefox browser using Selenium","body":"<p>Just get rid of the below line, you don't need to set property and provide the location of <code>driver.exe</code> if you are using Selenium <code>v4.6.0</code> or above.</p>\n<pre><code>System.setProperty(&quot;webdriver.gecko.driver&quot;,\n                           &quot;D:\\\\Selenium\\\\BrowserJars\\\\geckodriver113.exe&quot;);\n</code></pre>\n<p>References: <a href=\"https://www.selenium.dev/blog/2022/introducing-selenium-manager/\" rel=\"nofollow noreferrer\">Introducing Selenium Manager</a></p>\n"}],"owner":{"account_id":4312379,"reputation":1,"user_id":3523137,"display_name":"sandeeppandita"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":449,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1684829508,"creation_date":1684827190,"question_id":76312266,"body_markdown":"Unable to launch Firefox browser using Selenium.\r\n\r\n\r\nBelow is the code that I executed:\r\n\r\n\r\n    public class BrowserTest {\r\n\t    public static void main(String[] args) {\r\n\t\t    System.setProperty(&quot;webdriver.gecko.driver&quot;,\r\n                               &quot;D:\\\\Selenium\\\\BrowserJars\\\\geckodriver113.exe&quot;);\r\n\t\t    WebDriver driver = new FirefoxDriver();\r\n\t    }\r\n    }\r\n\r\nError that I am getting:\r\n\r\n    Exception in thread &quot;main&quot; org.openqa.selenium.SessionNotCreatedException: Could not start a new session. Response code 500. Message: Expected browser binary location, but unable to find binary in default location, no &#39;moz:firefoxOptions.binary&#39; capability provided, and no binary flag set on the command line \r\n    Host info: host: &#39;XXXXXXXXX&#39;, ip: &#39;XXX.XXX.XXX.XXX&#39;\r\n    Build info: version: &#39;4.9.1&#39;, revision: &#39;eb2032df7f&#39;\r\n    System info: os.name: &#39;Windows 10&#39;, os.arch: &#39;amd64&#39;, os.version: &#39;10.0&#39;, java.version: &#39;1.8.0_172&#39;\r\n    Driver info: org.openqa.selenium.firefox.FirefoxDriver\r\n    Command: [null, newSession {capabilities=[Capabilities {acceptInsecureCerts: true, browserName: firefox, moz:debuggerAddress: true, moz:firefoxOptions: {}}]}]\r\n    \tat org.openqa.selenium.remote.ProtocolHandshake.createSession(ProtocolHandshake.java:136)\r\n    \tat org.openqa.selenium.remote.ProtocolHandshake.createSession(ProtocolHandshake.java:94)\r\n    \tat org.openqa.selenium.remote.ProtocolHandshake.createSession(ProtocolHandshake.java:68)\r\n    \tat org.openqa.selenium.remote.HttpCommandExecutor.execute(HttpCommandExecutor.java:165)\r\n    \tat org.openqa.selenium.remote.service.DriverCommandExecutor.invokeExecute(DriverCommandExecutor.java:183)\r\n    \tat org.openqa.selenium.remote.service.DriverCommandExecutor.execute(DriverCommandExecutor.java:158)\r\n    \tat org.openqa.selenium.remote.RemoteWebDriver.execute(RemoteWebDriver.java:543)\r\n    \tat org.openqa.selenium.remote.RemoteWebDriver.startSession(RemoteWebDriver.java:229)\r\n    \tat org.openqa.selenium.remote.RemoteWebDriver.&lt;init&gt;(RemoteWebDriver.java:157)\r\n    \tat org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:150)\r\n    \tat org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:146)\r\n    \tat org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:131)\r\n    \tat org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:127)\r\n    \tat org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:112)\r\n    \tat org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:102)\r\n    \tat BrowserTest.main(BrowserTest.java:12)\r\n\r\nMore details:\r\n\r\n - Firefox Version: 113\r\n - Gecko Driver Version: geckodriver-v0.33.0-win32 (https://github.com/mozilla/geckodriver/releases)\r\n - Eclipse Version: 2019-06 (4.12.0)|Build id: 20190614-1200\r\n","title":"Unable to launch Firefox browser using Selenium","body":"<p>Unable to launch Firefox browser using Selenium.</p>\n<p>Below is the code that I executed:</p>\n<pre><code>public class BrowserTest {\n    public static void main(String[] args) {\n        System.setProperty(&quot;webdriver.gecko.driver&quot;,\n                           &quot;D:\\\\Selenium\\\\BrowserJars\\\\geckodriver113.exe&quot;);\n        WebDriver driver = new FirefoxDriver();\n    }\n}\n</code></pre>\n<p>Error that I am getting:</p>\n<pre><code>Exception in thread &quot;main&quot; org.openqa.selenium.SessionNotCreatedException: Could not start a new session. Response code 500. Message: Expected browser binary location, but unable to find binary in default location, no 'moz:firefoxOptions.binary' capability provided, and no binary flag set on the command line \nHost info: host: 'XXXXXXXXX', ip: 'XXX.XXX.XXX.XXX'\nBuild info: version: '4.9.1', revision: 'eb2032df7f'\nSystem info: os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_172'\nDriver info: org.openqa.selenium.firefox.FirefoxDriver\nCommand: [null, newSession {capabilities=[Capabilities {acceptInsecureCerts: true, browserName: firefox, moz:debuggerAddress: true, moz:firefoxOptions: {}}]}]\n    at org.openqa.selenium.remote.ProtocolHandshake.createSession(ProtocolHandshake.java:136)\n    at org.openqa.selenium.remote.ProtocolHandshake.createSession(ProtocolHandshake.java:94)\n    at org.openqa.selenium.remote.ProtocolHandshake.createSession(ProtocolHandshake.java:68)\n    at org.openqa.selenium.remote.HttpCommandExecutor.execute(HttpCommandExecutor.java:165)\n    at org.openqa.selenium.remote.service.DriverCommandExecutor.invokeExecute(DriverCommandExecutor.java:183)\n    at org.openqa.selenium.remote.service.DriverCommandExecutor.execute(DriverCommandExecutor.java:158)\n    at org.openqa.selenium.remote.RemoteWebDriver.execute(RemoteWebDriver.java:543)\n    at org.openqa.selenium.remote.RemoteWebDriver.startSession(RemoteWebDriver.java:229)\n    at org.openqa.selenium.remote.RemoteWebDriver.&lt;init&gt;(RemoteWebDriver.java:157)\n    at org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:150)\n    at org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:146)\n    at org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:131)\n    at org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:127)\n    at org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:112)\n    at org.openqa.selenium.firefox.FirefoxDriver.&lt;init&gt;(FirefoxDriver.java:102)\n    at BrowserTest.main(BrowserTest.java:12)\n</code></pre>\n<p>More details:</p>\n<ul>\n<li>Firefox Version: 113</li>\n<li>Gecko Driver Version: geckodriver-v0.33.0-win32 (<a href=\"https://github.com/mozilla/geckodriver/releases\" rel=\"nofollow noreferrer\">https://github.com/mozilla/geckodriver/releases</a>)</li>\n<li>Eclipse Version: 2019-06 (4.12.0)|Build id: 20190614-1200</li>\n</ul>\n"},{"tags":["java","spring","security","spring-boot-actuator"],"comments":[{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":2,"creation_date":1557401411,"post_id":56057707,"comment_id":98757295,"body_markdown":"Ordering of rules is important, your `.anyRequest().authenticated()` is before the more specific rule for the actuator. Hence the first one matches and renders your `actuator` maping useless. Switch the order and make sure the ` `.anyRequest().authenticated()` is the last one.","body":"Ordering of rules is important, your <code>.anyRequest().authenticated()</code> is before the more specific rule for the actuator. Hence the first one matches and renders your <code>actuator</code> maping useless. Switch the order and make sure the ` <code>.anyRequest().authenticated()</code> is the last one."},{"owner":{"account_id":3240077,"reputation":2811,"user_id":2733333,"accept_rate":89,"display_name":"Tomas Bisciak"},"score":0,"creation_date":1557401902,"post_id":56057707,"comment_id":98757611,"body_markdown":"God damnit it worked . I have no idea why since i had the admin and actuator endpoint at first totally at the top and the .anyRequest().authenticated() was set afterwards, Now i listened to you and put it into totally last place (that anyRequest().authenticated()) and it works. Please do post it as answer so i can accept it and you get rep :).","body":"God damnit it worked . I have no idea why since i had the admin and actuator endpoint at first totally at the top and the .anyRequest().authenticated() was set afterwards, Now i listened to you and put it into totally last place (that anyRequest().authenticated()) and it works. Please do post it as answer so i can accept it and you get rep :)."}],"answers":[{"comments":[{"owner":{"account_id":149002,"reputation":2739,"user_id":361172,"accept_rate":20,"display_name":"James Selvakumar"},"score":1,"creation_date":1674808581,"post_id":56073706,"comment_id":132796122,"body_markdown":"Hope this is well documented in Spring Security docs. Thank you Tomas for raising this and M.Deinum for answering.","body":"Hope this is well documented in Spring Security docs. Thank you Tomas for raising this and M.Deinum for answering."}],"tags":[],"owner":{"account_id":3240077,"reputation":2811,"user_id":2733333,"accept_rate":89,"display_name":"Tomas Bisciak"},"comment_count":1,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1557477312,"creation_date":1557477312,"answer_id":56073706,"question_id":56057707,"body_markdown":"&gt; This question was answered in the comment, unfortunately commenter\r\n&gt; didnt post answer so i do it. All credit to  M. Deinum.\r\n\r\nCorrect solution is to move \r\n\r\n    .anyRequest().authenticated()\r\n\r\nInto last position of httpsecurity configuration. Ordering in this case matters.","title":"Spring security , Configuration hasAuthority check on endpoints not working","body":"<blockquote>\n  <p>This question was answered in the comment, unfortunately commenter\n  didnt post answer so i do it. All credit to  M. Deinum.</p>\n</blockquote>\n\n<p>Correct solution is to move </p>\n\n<pre><code>.anyRequest().authenticated()\n</code></pre>\n\n<p>Into last position of httpsecurity configuration. Ordering in this case matters.</p>\n"}],"owner":{"account_id":3240077,"reputation":2811,"user_id":2733333,"accept_rate":89,"display_name":"Tomas Bisciak"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":5321,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":56073706,"answer_count":1,"score":3,"last_activity_date":1684829125,"creation_date":1557398830,"question_id":56057707,"body_markdown":"I have spring actuator and administration endpoint for my web application.\r\n\r\nIn configure of my spring security I have following code :\r\n\r\n     .and()\r\n     .authorizeRequests()\r\n     .antMatchers(&quot;/actuator/**&quot;, &quot;/administration/**&quot;)\r\n     .hasAuthority(Authority.ADMIN.name())\r\nThis does not seem to work, **desired outcome is that only User with a  authority of admin**, can access these endpoints, right now, any authenticated user can do it. I did it with user that has authority of USER and not admin and it works.\r\n\r\nThis is too dangerous for me And i dont want to put password protection in place when this can be managed by Authorities.\r\n\r\n&gt; **So how can i make sure that only users with Authority of ADMIN can access the following endpoints ?**\r\n\r\nI have posted only this small snipped of code , tell me if anything else is required in order for you to be able to help :).\r\n\r\nAnd yes I have debugged this and authorities in my process are set correctly, admin has auth admin and it works for both basic auth and oauth2. Anyone knows what could be happening?\r\n\r\nOnly person that is not logged in at all cant access these endpoints at the moment, Here is my full security config :\r\n\r\n            // @formatter:off\r\n        httpSecurity\r\n                .authorizeRequests()\r\n                .antMatchers(\r\n                        Utils.MAPPING_INDEX,\r\n                        Utils.MAPPING_ARTICLE,\r\n                        Utils.MAPPING_IMAGE,\r\n                        Utils.MAPPING_ERROR,\r\n                        Utils.MAPPING_VERIFY_MAIL,\r\n                        Utils.MAPPING_REGISTER,\r\n                        Utils.MAPPING_LOGIN,\r\n                        Utils.MAPPING_LOGIN_ERROR,\r\n                        Utils.MAPPING_LOGIN_VERIFIED,\r\n                        Utils.MAPPING_LOGIN_VERIFICATION_ERROR,\r\n                        Utils.MAPPING_RESET_PASSWORD,\r\n                        Utils.MAPPING_LOGIN_PASSWORD_RESET_SUCCESS,\r\n                        Utils.MAPPING_LOGIN_PASSWORD_RESET_LOCKED,\r\n                        Utils.MAPPING_RESET_PASSWORD_RESET_MAIL_SEND,\r\n                        Utils.MAPPING_LOGIN_PASSWORD_RESET_FAILURE,\r\n                        Utils.MAPPING_INDEX_LOGOUT_SUCCESS,\r\n                        Utils.MAPPING_REGISTER_SUCCESS,\r\n                        Utils.MAPPING_REGISTER,\r\n                        Utils.MAPPING_RESET_PASSWORD,\r\n                        Utils.MAPPING_RESET_PASSWORD_NEW_PASSWORD,\r\n                        Utils.MAPPING_AUTHOR,\r\n                        Utils.MAPPING_CONTACT,\r\n                        Utils.MAPPING_CONTACT_SUCCESS,\r\n                        Utils.MAPPING_CONTACT_FAILURE,\r\n                        Utils.MAPPING_REPORT_WORKAROUND,\r\n                        &quot;/test&quot;,\r\n                        &quot;/test1&quot;,\r\n                        &quot;/frag1&quot;,\r\n                        &quot;/frag2&quot;,\r\n                        &quot;/css/**&quot;,\r\n                        &quot;/js/**&quot;,\r\n                        &quot;/img/**&quot;,\r\n                        &quot;/fonts/**&quot;,\r\n                        &quot;/external/**&quot;,\r\n                        &quot;/favicon.ico&quot;,\r\n                        &quot;/favicon_32.ico&quot;,\r\n                        &quot;/favicon.svg&quot;\r\n                ).permitAll()\r\n                .anyRequest().authenticated()\r\n\r\n                .and()\r\n                .authorizeRequests()\r\n                .antMatchers(&quot;/actuator/**&quot;, &quot;/administration/**&quot;)\r\n                .hasAuthority(Authority.ADMIN.name())\r\n\r\n\r\n                .and()\r\n\r\n                .formLogin()\r\n                .loginPage(Utils.MAPPING_LOGIN)\r\n                .loginProcessingUrl(Utils.MAPPING_LOGIN)\r\n                .usernameParameter(&quot;email&quot;)\r\n                .passwordParameter(&quot;password&quot;)\r\n                .successHandler(basicAuthenticationSuccessHandlerImpl)\r\n                .failureUrl(Utils.MAPPING_LOGIN_ERROR)\r\n\r\n                .and()\r\n\r\n                .logout()\r\n                .logoutUrl(Utils.MAPPING_INDEX)\r\n                .logoutSuccessUrl(Utils.MAPPING_INDEX_LOGOUT_SUCCESS)\r\n                .invalidateHttpSession(true)\r\n\r\n                .and()\r\n\r\n                .oauth2Login()\r\n                .loginPage(Utils.MAPPING_LOGIN)\r\n                .successHandler(oauth2AuthenticationSuccessHandler);\r\n\r\n        // @formatter:on\r\n    }\r\n\r\n\r\n","title":"Spring security , Configuration hasAuthority check on endpoints not working","body":"<p>I have spring actuator and administration endpoint for my web application.</p>\n\n<p>In configure of my spring security I have following code :</p>\n\n<pre><code> .and()\n .authorizeRequests()\n .antMatchers(\"/actuator/**\", \"/administration/**\")\n .hasAuthority(Authority.ADMIN.name())\n</code></pre>\n\n<p>This does not seem to work, <strong>desired outcome is that only User with a  authority of admin</strong>, can access these endpoints, right now, any authenticated user can do it. I did it with user that has authority of USER and not admin and it works.</p>\n\n<p>This is too dangerous for me And i dont want to put password protection in place when this can be managed by Authorities.</p>\n\n<blockquote>\n  <p><strong>So how can i make sure that only users with Authority of ADMIN can access the following endpoints ?</strong></p>\n</blockquote>\n\n<p>I have posted only this small snipped of code , tell me if anything else is required in order for you to be able to help :).</p>\n\n<p>And yes I have debugged this and authorities in my process are set correctly, admin has auth admin and it works for both basic auth and oauth2. Anyone knows what could be happening?</p>\n\n<p>Only person that is not logged in at all cant access these endpoints at the moment, Here is my full security config :</p>\n\n<pre><code>        // @formatter:off\n    httpSecurity\n            .authorizeRequests()\n            .antMatchers(\n                    Utils.MAPPING_INDEX,\n                    Utils.MAPPING_ARTICLE,\n                    Utils.MAPPING_IMAGE,\n                    Utils.MAPPING_ERROR,\n                    Utils.MAPPING_VERIFY_MAIL,\n                    Utils.MAPPING_REGISTER,\n                    Utils.MAPPING_LOGIN,\n                    Utils.MAPPING_LOGIN_ERROR,\n                    Utils.MAPPING_LOGIN_VERIFIED,\n                    Utils.MAPPING_LOGIN_VERIFICATION_ERROR,\n                    Utils.MAPPING_RESET_PASSWORD,\n                    Utils.MAPPING_LOGIN_PASSWORD_RESET_SUCCESS,\n                    Utils.MAPPING_LOGIN_PASSWORD_RESET_LOCKED,\n                    Utils.MAPPING_RESET_PASSWORD_RESET_MAIL_SEND,\n                    Utils.MAPPING_LOGIN_PASSWORD_RESET_FAILURE,\n                    Utils.MAPPING_INDEX_LOGOUT_SUCCESS,\n                    Utils.MAPPING_REGISTER_SUCCESS,\n                    Utils.MAPPING_REGISTER,\n                    Utils.MAPPING_RESET_PASSWORD,\n                    Utils.MAPPING_RESET_PASSWORD_NEW_PASSWORD,\n                    Utils.MAPPING_AUTHOR,\n                    Utils.MAPPING_CONTACT,\n                    Utils.MAPPING_CONTACT_SUCCESS,\n                    Utils.MAPPING_CONTACT_FAILURE,\n                    Utils.MAPPING_REPORT_WORKAROUND,\n                    \"/test\",\n                    \"/test1\",\n                    \"/frag1\",\n                    \"/frag2\",\n                    \"/css/**\",\n                    \"/js/**\",\n                    \"/img/**\",\n                    \"/fonts/**\",\n                    \"/external/**\",\n                    \"/favicon.ico\",\n                    \"/favicon_32.ico\",\n                    \"/favicon.svg\"\n            ).permitAll()\n            .anyRequest().authenticated()\n\n            .and()\n            .authorizeRequests()\n            .antMatchers(\"/actuator/**\", \"/administration/**\")\n            .hasAuthority(Authority.ADMIN.name())\n\n\n            .and()\n\n            .formLogin()\n            .loginPage(Utils.MAPPING_LOGIN)\n            .loginProcessingUrl(Utils.MAPPING_LOGIN)\n            .usernameParameter(\"email\")\n            .passwordParameter(\"password\")\n            .successHandler(basicAuthenticationSuccessHandlerImpl)\n            .failureUrl(Utils.MAPPING_LOGIN_ERROR)\n\n            .and()\n\n            .logout()\n            .logoutUrl(Utils.MAPPING_INDEX)\n            .logoutSuccessUrl(Utils.MAPPING_INDEX_LOGOUT_SUCCESS)\n            .invalidateHttpSession(true)\n\n            .and()\n\n            .oauth2Login()\n            .loginPage(Utils.MAPPING_LOGIN)\n            .successHandler(oauth2AuthenticationSuccessHandler);\n\n    // @formatter:on\n}\n</code></pre>\n"},{"tags":["java","spring-boot","spring-boot-actuator"],"comments":[{"owner":{"account_id":3540948,"reputation":5877,"user_id":2958086,"display_name":"Compass"},"score":0,"creation_date":1529074943,"post_id":50877746,"comment_id":88758414,"body_markdown":"Sanity check: component scan on?","body":"Sanity check: component scan on?"},{"owner":{"account_id":1425986,"reputation":3033,"user_id":2306595,"display_name":"Innokenty"},"score":0,"creation_date":1529075559,"post_id":50877746,"comment_id":88758751,"body_markdown":"Yeah, checked it. See the answer by me below. I&#39;m actually just stupid.","body":"Yeah, checked it. See the answer by me below. I&#39;m actually just stupid."}],"answers":[{"tags":[],"owner":{"account_id":1425986,"reputation":3033,"user_id":2306595,"display_name":"Innokenty"},"comment_count":0,"down_vote_count":0,"up_vote_count":9,"is_accepted":true,"score":9,"last_activity_date":1529076412,"creation_date":1529075184,"answer_id":50878256,"question_id":50877746,"body_markdown":"After posting the question I found the answer almost immediately. It was a combination of typos in the config and the fact that it&#39;s actually **not exposed by default**. Despite [the official post saying][1]: \r\n\r\n&gt; To configure an endpoint, all that’s required really is to expose it as a @Bean\r\n\r\nThese are the proper ways to define the property:\r\n\r\n    management.endpoints.web.exposure.include=*\r\n    management.endpoints.web.exposure.include=&#39;health,info,metrics,hello&#39;\r\n\r\nOr as a YAML:\r\n\r\n    management:\r\n      endpoints:\r\n        web:\r\n          exposure:\r\n            include: &#39;health,info,metrics,hello&#39;\r\n\r\nHere is the official reference: https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html#production-ready-endpoints-exposing-endpoints\r\n\r\nInteresting, that you can&#39;t use underscores in endpoint names anymore. At least without additional changes.\r\n\r\n  [1]: https://spring.io/blog/2017/08/22/introducing-actuator-endpoints-in-spring-boot-2-0#configuration","title":"Spring Boot 2.0 Not Registering Custom Actuator Endpoint Bean","body":"<p>After posting the question I found the answer almost immediately. It was a combination of typos in the config and the fact that it's actually <strong>not exposed by default</strong>. Despite <a href=\"https://spring.io/blog/2017/08/22/introducing-actuator-endpoints-in-spring-boot-2-0#configuration\" rel=\"noreferrer\">the official post saying</a>: </p>\n\n<blockquote>\n  <p>To configure an endpoint, all that’s required really is to expose it as a @Bean</p>\n</blockquote>\n\n<p>These are the proper ways to define the property:</p>\n\n<pre><code>management.endpoints.web.exposure.include=*\nmanagement.endpoints.web.exposure.include='health,info,metrics,hello'\n</code></pre>\n\n<p>Or as a YAML:</p>\n\n<pre><code>management:\n  endpoints:\n    web:\n      exposure:\n        include: 'health,info,metrics,hello'\n</code></pre>\n\n<p>Here is the official reference: <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html#production-ready-endpoints-exposing-endpoints\" rel=\"noreferrer\">https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html#production-ready-endpoints-exposing-endpoints</a></p>\n\n<p>Interesting, that you can't use underscores in endpoint names anymore. At least without additional changes.</p>\n"}],"owner":{"account_id":1425986,"reputation":3033,"user_id":2306595,"display_name":"Innokenty"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":5439,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"closed_date":1529329032,"accepted_answer_id":50878256,"answer_count":1,"score":3,"last_activity_date":1684829048,"creation_date":1529073436,"question_id":50877746,"body_markdown":"I&#39;m trying to add a custom actuator endpoint in Spring Boot 2.0.2.RELEASE application.\r\nI&#39;m following [the official guidelines][1], [the official migration guide][2] and also [this post][3].\r\n\r\nI am able to configure everything via properties: hide/expose endpoints, change base path etc. Everything works, except my custom endpoint bean is not picked up by `WebMvcEndpointHandlerMapping`. It simply doesn&#39;t show up in these famous logging lines:\r\n\r\n    EndpointLinksResolver        : Exposing 2 endpoint(s) beneath base path &#39;/actuator&#39;\r\n    WebMvcEndpointHandlerMapping : Mapped &quot;{[/actuator/health],methods=[GET],produces=[application/vnd.spring-boot.actuator.v2+json || application/json]}&quot; onto public java.lang.Object org.springframework.boot.actuate.endpoint.web.servlet.AbstractWebMvcEndpointHandlerMapping$OperationHandler.handle(javax.servlet.http.HttpServletRequest,java.util.Map&lt;java.lang.String, java.lang.String&gt;)\r\n    WebMvcEndpointHandlerMapping : Mapped &quot;{[/actuator/info],methods=[GET],produces=[application/vnd.spring-boot.actuator.v2+json || application/json]}&quot; onto public java.lang.Object org.springframework.boot.actuate.endpoint.web.servlet.AbstractWebMvcEndpointHandlerMapping$OperationHandler.handle(javax.servlet.http.HttpServletRequest,java.util.Map&lt;java.lang.String, java.lang.String&gt;)\r\n    WebMvcEndpointHandlerMapping : Mapped &quot;{[/actuator],methods=[GET],produces=[application/vnd.spring-boot.actuator.v2+json || application/json]}&quot; onto protected java.util.Map&lt;java.lang.String, java.util.Map&lt;java.lang.String, org.springframework.boot.actuate.endpoint.web.Link&gt;&gt; org.springframework.boot.actuate.endpoint.web.servlet.WebMvcEndpointHandlerMapping.links(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)\r\n\r\nThese three lines is all I get. I can access `/actuator/health` and `/actuator/info` without any trouble, but not my custom endpoint. I get 404 obviously.\r\n\r\nWhat I tried so far:\r\n\r\n - Checked that my endpoint class is registered in the context as a bean.\r\n - Exposed it explicitly via yaml configuration.\r\n - Exposed everything via `management.endpoints.web.exposure.include=*`\r\n - Removed all the management configuration completely, because it should be actually available by default.\r\n - Triple checked the endpoint id.\r\n - Renamed the endpoint id.\r\n\r\nAny ideas of what I can at least look into? All the questions I found so far end up in person not realizing they need `@Component` annotation too.\r\n\r\nAh, here is my class by the way:\r\n\r\n    @Component\r\n    @Endpoint(id = &quot;hello&quot;)\r\n    public class HelloEndpoint {\r\n\r\n        @ReadOperation\r\n        public String sayHello() {\r\n            return &quot;Hello!&quot;;\r\n        }\r\n    }\r\n\r\n\r\n  [1]: https://spring.io/blog/2017/08/22/introducing-actuator-endpoints-in-spring-boot-2-0\r\n  [2]: https://github.com/spring-projects/spring-boot/wiki/Migrating-a-custom-Actuator-endpoint-to-Spring-Boot-2\r\n  [3]: http://www.baeldung.com/spring-boot-actuators","title":"Spring Boot 2.0 Not Registering Custom Actuator Endpoint Bean","body":"<p>I'm trying to add a custom actuator endpoint in Spring Boot 2.0.2.RELEASE application.\nI'm following <a href=\"https://spring.io/blog/2017/08/22/introducing-actuator-endpoints-in-spring-boot-2-0\" rel=\"nofollow noreferrer\">the official guidelines</a>, <a href=\"https://github.com/spring-projects/spring-boot/wiki/Migrating-a-custom-Actuator-endpoint-to-Spring-Boot-2\" rel=\"nofollow noreferrer\">the official migration guide</a> and also <a href=\"http://www.baeldung.com/spring-boot-actuators\" rel=\"nofollow noreferrer\">this post</a>.</p>\n\n<p>I am able to configure everything via properties: hide/expose endpoints, change base path etc. Everything works, except my custom endpoint bean is not picked up by <code>WebMvcEndpointHandlerMapping</code>. It simply doesn't show up in these famous logging lines:</p>\n\n<pre><code>EndpointLinksResolver        : Exposing 2 endpoint(s) beneath base path '/actuator'\nWebMvcEndpointHandlerMapping : Mapped \"{[/actuator/health],methods=[GET],produces=[application/vnd.spring-boot.actuator.v2+json || application/json]}\" onto public java.lang.Object org.springframework.boot.actuate.endpoint.web.servlet.AbstractWebMvcEndpointHandlerMapping$OperationHandler.handle(javax.servlet.http.HttpServletRequest,java.util.Map&lt;java.lang.String, java.lang.String&gt;)\nWebMvcEndpointHandlerMapping : Mapped \"{[/actuator/info],methods=[GET],produces=[application/vnd.spring-boot.actuator.v2+json || application/json]}\" onto public java.lang.Object org.springframework.boot.actuate.endpoint.web.servlet.AbstractWebMvcEndpointHandlerMapping$OperationHandler.handle(javax.servlet.http.HttpServletRequest,java.util.Map&lt;java.lang.String, java.lang.String&gt;)\nWebMvcEndpointHandlerMapping : Mapped \"{[/actuator],methods=[GET],produces=[application/vnd.spring-boot.actuator.v2+json || application/json]}\" onto protected java.util.Map&lt;java.lang.String, java.util.Map&lt;java.lang.String, org.springframework.boot.actuate.endpoint.web.Link&gt;&gt; org.springframework.boot.actuate.endpoint.web.servlet.WebMvcEndpointHandlerMapping.links(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)\n</code></pre>\n\n<p>These three lines is all I get. I can access <code>/actuator/health</code> and <code>/actuator/info</code> without any trouble, but not my custom endpoint. I get 404 obviously.</p>\n\n<p>What I tried so far:</p>\n\n<ul>\n<li>Checked that my endpoint class is registered in the context as a bean.</li>\n<li>Exposed it explicitly via yaml configuration.</li>\n<li>Exposed everything via <code>management.endpoints.web.exposure.include=*</code></li>\n<li>Removed all the management configuration completely, because it should be actually available by default.</li>\n<li>Triple checked the endpoint id.</li>\n<li>Renamed the endpoint id.</li>\n</ul>\n\n<p>Any ideas of what I can at least look into? All the questions I found so far end up in person not realizing they need <code>@Component</code> annotation too.</p>\n\n<p>Ah, here is my class by the way:</p>\n\n<pre><code>@Component\n@Endpoint(id = \"hello\")\npublic class HelloEndpoint {\n\n    @ReadOperation\n    public String sayHello() {\n        return \"Hello!\";\n    }\n}\n</code></pre>\n"},{"tags":["java","spring","spring-boot","spring-boot-actuator"],"answers":[{"comments":[{"owner":{"account_id":8866557,"reputation":331,"user_id":6621555,"display_name":"Gene Knight"},"score":0,"creation_date":1521559959,"post_id":49388154,"comment_id":85778019,"body_markdown":"Alas, adding &quot;/aname&quot;, &quot;?name=aname&quot; to the URL, or removing the @Selector reference entirely had no effect.","body":"Alas, adding &quot;/aname&quot;, &quot;?name=aname&quot; to the URL, or removing the @Selector reference entirely had no effect."},{"owner":{"account_id":4497262,"reputation":961,"user_id":3656774,"display_name":"Martin van Wingerden"},"score":1,"creation_date":1521562312,"post_id":49388154,"comment_id":85779706,"body_markdown":"I updated to answer your updated question with a reference to the documentation where it is stated that is should be a bean.","body":"I updated to answer your updated question with a reference to the documentation where it is stated that is should be a bean."}],"tags":[],"owner":{"account_id":4497262,"reputation":961,"user_id":3656774,"display_name":"Martin van Wingerden"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1521561811,"creation_date":1521559498,"answer_id":49388154,"question_id":49387867,"body_markdown":"The initial partly problem was that the code did not add an endpoint with no &quot;selector&quot;\r\n\r\n[Source][1]\r\n\r\n    @Endpoint(id = &quot;loggers&quot;)\r\n    @Component\r\n    public class LoggersEndpoint {\r\n    \r\n        @ReadOperation\r\n        public Map&lt;String, Object&gt; loggers() { ... }\r\n    \r\n        @ReadOperation\r\n        public LoggerLevels loggerLevels(@Selector String name) { ... }\r\n    \r\n        @WriteOperation\r\n        public void configureLogLevel(@Selector String name, LogLevel configuredLevel) { ... }\r\n    \r\n    }\r\n\r\n&gt; This endpoint exposes three operations:\r\n&gt; \r\n&gt; GET on /application/loggers: the configuration of all loggers (as it\r\n&gt; has no &quot;selector&quot; parameter):\r\n&gt; \r\n&gt; GET on /application/loggers/{name}: the configuration of a named\r\n&gt; logger (using the name @Selector).\r\n&gt; \r\n&gt; ...\r\n\r\nThe edited question led to the conclusion [that it should be a bean][2] \r\n\r\n&gt; If you add a @Bean annotated with @Endpoint, any methods annotated\r\n&gt; with @ReadOperation, @WriteOperation, or @DeleteOperation are\r\n&gt; automatically exposed over JMX and, in a web application, over HTTP as\r\n&gt; well. Endpoints can be exposed over HTTP using Jersey, Spring MVC, or\r\n&gt; Spring WebFlux.\r\n\r\nOr see [comments in the announcement of the feature][3]\r\n\r\n\r\n  [1]: https://spring.io/blog/2017/08/22/introducing-actuator-endpoints-in-spring-boot-2-0\r\n  [2]: https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html#production-ready-endpoints-custom\r\n  [3]: https://spring.io/blog/2017/08/22/introducing-actuator-endpoints-in-spring-boot-2-0#comment-3481606304","title":"Spring Boot 2 Custom Actuator Endpoints","body":"<p>The initial partly problem was that the code did not add an endpoint with no \"selector\"</p>\n\n<p><a href=\"https://spring.io/blog/2017/08/22/introducing-actuator-endpoints-in-spring-boot-2-0\" rel=\"nofollow noreferrer\">Source</a></p>\n\n<pre><code>@Endpoint(id = \"loggers\")\n@Component\npublic class LoggersEndpoint {\n\n    @ReadOperation\n    public Map&lt;String, Object&gt; loggers() { ... }\n\n    @ReadOperation\n    public LoggerLevels loggerLevels(@Selector String name) { ... }\n\n    @WriteOperation\n    public void configureLogLevel(@Selector String name, LogLevel configuredLevel) { ... }\n\n}\n</code></pre>\n\n<blockquote>\n  <p>This endpoint exposes three operations:</p>\n  \n  <p>GET on /application/loggers: the configuration of all loggers (as it\n  has no \"selector\" parameter):</p>\n  \n  <p>GET on /application/loggers/{name}: the configuration of a named\n  logger (using the name @Selector).</p>\n  \n  <p>...</p>\n</blockquote>\n\n<p>The edited question led to the conclusion <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html#production-ready-endpoints-custom\" rel=\"nofollow noreferrer\">that it should be a bean</a> </p>\n\n<blockquote>\n  <p>If you add a @Bean annotated with @Endpoint, any methods annotated\n  with @ReadOperation, @WriteOperation, or @DeleteOperation are\n  automatically exposed over JMX and, in a web application, over HTTP as\n  well. Endpoints can be exposed over HTTP using Jersey, Spring MVC, or\n  Spring WebFlux.</p>\n</blockquote>\n\n<p>Or see <a href=\"https://spring.io/blog/2017/08/22/introducing-actuator-endpoints-in-spring-boot-2-0#comment-3481606304\" rel=\"nofollow noreferrer\">comments in the announcement of the feature</a></p>\n"},{"tags":[],"owner":{"account_id":8866557,"reputation":331,"user_id":6621555,"display_name":"Gene Knight"},"comment_count":0,"down_vote_count":0,"up_vote_count":13,"is_accepted":false,"score":13,"last_activity_date":1521560814,"creation_date":1521560814,"answer_id":49388589,"question_id":49387867,"body_markdown":"OK, solved:\r\n\r\n\t\t@Endpoint(id=&quot;mypoint&quot;)\r\n\t\t@Component\r\n\t\tpublic class myPointEndPoint {\r\n\t\t\t@ReadOperation\r\n\t\t\tpublic String mypoint(){\r\n\t\t\t\treturn &quot;Hello&quot; ;\r\n\t\t\t}\r\n\t\t}\r\n\r\nWhat was missing was the &quot;@Component&quot; annotation. But, where is this in the docs?","title":"Spring Boot 2 Custom Actuator Endpoints","body":"<p>OK, solved:</p>\n\n<pre><code>    @Endpoint(id=\"mypoint\")\n    @Component\n    public class myPointEndPoint {\n        @ReadOperation\n        public String mypoint(){\n            return \"Hello\" ;\n        }\n    }\n</code></pre>\n\n<p>What was missing was the \"@Component\" annotation. But, where is this in the docs?</p>\n"},{"tags":[],"owner":{"account_id":305881,"reputation":5257,"user_id":616290,"accept_rate":57,"display_name":"Dmytro Boichenko"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1531294599,"creation_date":1531237544,"answer_id":51269469,"question_id":49387867,"body_markdown":"Maybe this will help somebody.\r\n\r\nLooks like `@ReadOperation` doesn&#39;t support return type `Void`. You should return at least an empty string on your `invoke` method. \r\n\r\nspring-boot 2.0.3.RELEASE\r\n\r\n\r\n    @Component\r\n    @Endpoint(id = &quot;heartbeat&quot;)\r\n    public class HeartbeatEndpoint {\r\n\r\n        @ReadOperation\r\n        public String invoke() {\r\n            return &quot;&quot;;\r\n        }\r\n    }\r\n","title":"Spring Boot 2 Custom Actuator Endpoints","body":"<p>Maybe this will help somebody.</p>\n\n<p>Looks like <code>@ReadOperation</code> doesn't support return type <code>Void</code>. You should return at least an empty string on your <code>invoke</code> method. </p>\n\n<p>spring-boot 2.0.3.RELEASE</p>\n\n<pre><code>@Component\n@Endpoint(id = \"heartbeat\")\npublic class HeartbeatEndpoint {\n\n    @ReadOperation\n    public String invoke() {\n        return \"\";\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":8866557,"reputation":331,"user_id":6621555,"display_name":"Gene Knight"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":10060,"favorite_count":0,"down_vote_count":0,"up_vote_count":5,"answer_count":3,"score":5,"last_activity_date":1684828976,"creation_date":1521558729,"question_id":49387867,"body_markdown":"Spring Noob: OK. I start with a STS Spring Starter Project / Maven / Java 8 / Spring Boot 2.0, and select the Web and Actuator dependencies. It builds and runs fine, and reponds to http://localhost:8080/actuator/health. I add an &quot;Endpoint&quot; to the main application class, so that it looks like this.\r\n\r\n\tpackage com.thumbsup;\r\n\t\r\n\timport org.springframework.boot.SpringApplication;\r\n\timport org.springframework.boot.actuate.endpoint.annotation.Endpoint;\r\n\timport org.springframework.boot.actuate.endpoint.annotation.ReadOperation;\r\n\timport org.springframework.boot.actuate.endpoint.annotation.Selector;\r\n\timport org.springframework.boot.autoconfigure.SpringBootApplication;\r\n\t\r\n\t@SpringBootApplication\r\n\tpublic class YourStash11Application {\r\n\t\r\n\t\tpublic static void main(String[] args) {\r\n\t\t\tSpringApplication.run(YourStash11Application.class, args);\r\n\t\t}\r\n\t\t\r\n\t\t@Endpoint(id=&quot;mypoint&quot;)\r\n\t\tpublic class CustomPoint {\r\n\t\t\t@ReadOperation\r\n\t\t\tpublic String getHello(){\r\n\t\t\t\treturn &quot;Hello&quot; ;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\nI try to enable everything in application.properties:\r\n\r\n\tmanagement.endpoints.enabled-by-default=true\r\n\tmanagement.endpoint.conditions.enabled=true\r\n\tmanagement.endpoint.mypoint.enabled=true\r\n\tmanagement.endpoints.web.exposure.include=*\r\n\r\nBut when it builds, there&#39;s no reference to mapping /actuator/mypoint, and  \r\nhttp://localhost:8080/actuator/mypoint and  \r\nhttp://localhost:8080/application/mypoint  \r\nboth return 404 errors.\r\n\r\nWhat am I missing? Thanks!\r\n","title":"Spring Boot 2 Custom Actuator Endpoints","body":"<p>Spring Noob: OK. I start with a STS Spring Starter Project / Maven / Java 8 / Spring Boot 2.0, and select the Web and Actuator dependencies. It builds and runs fine, and reponds to <a href=\"http://localhost:8080/actuator/health\" rel=\"noreferrer\">http://localhost:8080/actuator/health</a>. I add an \"Endpoint\" to the main application class, so that it looks like this.</p>\n\n<pre><code>package com.thumbsup;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.actuate.endpoint.annotation.Endpoint;\nimport org.springframework.boot.actuate.endpoint.annotation.ReadOperation;\nimport org.springframework.boot.actuate.endpoint.annotation.Selector;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class YourStash11Application {\n\n    public static void main(String[] args) {\n        SpringApplication.run(YourStash11Application.class, args);\n    }\n\n    @Endpoint(id=\"mypoint\")\n    public class CustomPoint {\n        @ReadOperation\n        public String getHello(){\n            return \"Hello\" ;\n        }\n    }\n\n}\n</code></pre>\n\n<p>I try to enable everything in application.properties:</p>\n\n<pre><code>management.endpoints.enabled-by-default=true\nmanagement.endpoint.conditions.enabled=true\nmanagement.endpoint.mypoint.enabled=true\nmanagement.endpoints.web.exposure.include=*\n</code></pre>\n\n<p>But when it builds, there's no reference to mapping /actuator/mypoint, and<br>\n<a href=\"http://localhost:8080/actuator/mypoint\" rel=\"noreferrer\">http://localhost:8080/actuator/mypoint</a> and<br>\n<a href=\"http://localhost:8080/application/mypoint\" rel=\"noreferrer\">http://localhost:8080/application/mypoint</a><br>\nboth return 404 errors.</p>\n\n<p>What am I missing? Thanks!</p>\n"},{"tags":["java","spring","spring-boot-actuator"],"comments":[{"owner":{"account_id":8447748,"reputation":38031,"user_id":6337748,"accept_rate":38,"display_name":"notionquest"},"score":0,"creation_date":1520507859,"post_id":49169614,"comment_id":85348490,"body_markdown":"Auto configured health indicators check the database, jmx etc. https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html","body":"Auto configured health indicators check the database, jmx etc. <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html\" rel=\"nofollow noreferrer\">docs.spring.io/spring-boot/docs/current/reference/html/&hellip;</a>"},{"owner":{"account_id":8258676,"reputation":973,"user_id":6210973,"display_name":"Mick"},"score":0,"creation_date":1520509062,"post_id":49169614,"comment_id":85349206,"body_markdown":"So you cannot know when the application context has been fully initialized?","body":"So you cannot know when the application context has been fully initialized?"},{"owner":{"account_id":8447748,"reputation":38031,"user_id":6337748,"accept_rate":38,"display_name":"notionquest"},"score":0,"creation_date":1520509860,"post_id":49169614,"comment_id":85349666,"body_markdown":"it is mainly for endpoints and databases. If you want to check for application context initialization, you can write the listener to check that.","body":"it is mainly for endpoints and databases. If you want to check for application context initialization, you can write the listener to check that."},{"owner":{"account_id":8258676,"reputation":973,"user_id":6210973,"display_name":"Mick"},"score":0,"creation_date":1520601550,"post_id":49169614,"comment_id":85394043,"body_markdown":"ok, thanks! there is a &quot;status&quot; attribut on the top level, though. This must be application wide - and I am wondering what it tells us?\n\n{\n  &quot;status&quot; : &quot;UP&quot;,\n.....","body":"ok, thanks! there is a &quot;status&quot; attribut on the top level, though. This must be application wide - and I am wondering what it tells us?  {   &quot;status&quot; : &quot;UP&quot;, ....."}],"answers":[{"comments":[{"owner":{"account_id":8258676,"reputation":973,"user_id":6210973,"display_name":"Mick"},"score":0,"creation_date":1520608855,"post_id":49195646,"comment_id":85398610,"body_markdown":"Thanks! Please allow to ask what the top-level &quot;status:UP&quot; is for? Is it an aggregated status of all resources maybe? I could not find any documentation on this. Well, I will actually test if that&#39;s the case.","body":"Thanks! Please allow to ask what the top-level &quot;status:UP&quot; is for? Is it an aggregated status of all resources maybe? I could not find any documentation on this. Well, I will actually test if that&#39;s the case."},{"owner":{"account_id":8447748,"reputation":38031,"user_id":6337748,"accept_rate":38,"display_name":"notionquest"},"score":1,"creation_date":1520608967,"post_id":49195646,"comment_id":85398671,"body_markdown":"Yes, it is the aggregated result.","body":"Yes, it is the aggregated result."},{"owner":{"account_id":8258676,"reputation":973,"user_id":6210973,"display_name":"Mick"},"score":0,"creation_date":1520610078,"post_id":49195646,"comment_id":85399388,"body_markdown":"Thanks - very helpful! Still unsure how a Spring actuator can report things before the Spring application context is running. The application context should not be considered a resource itself probably. I was going to add a health indicator to my RestController, but since it is just a Spring bean, it can only be UP as long as the Spring application is running. Should one add a health check for a Spring bean after all?","body":"Thanks - very helpful! Still unsure how a Spring actuator can report things before the Spring application context is running. The application context should not be considered a resource itself probably. I was going to add a health indicator to my RestController, but since it is just a Spring bean, it can only be UP as long as the Spring application is running. Should one add a health check for a Spring bean after all?"},{"owner":{"account_id":8447748,"reputation":38031,"user_id":6337748,"accept_rate":38,"display_name":"notionquest"},"score":1,"creation_date":1520610265,"post_id":49195646,"comment_id":85399508,"body_markdown":"Yes, I thought about it. In that case, actuator should run separately. You can use the properties to configure the server. management.server.port: 8080\nmanagement.server.address: localhost","body":"Yes, I thought about it. In that case, actuator should run separately. You can use the properties to configure the server. management.server.port: 8080 management.server.address: localhost"}],"tags":[],"owner":{"account_id":8447748,"reputation":38031,"user_id":6337748,"accept_rate":38,"display_name":"notionquest"},"comment_count":4,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1520604744,"creation_date":1520604744,"answer_id":49195646,"question_id":49169614,"body_markdown":"In order to test whether the application context is loaded, you can perform this custom implementation.\r\n\r\n`@EventListener` - The method annotated with EventListener is triggered when the context is initialized.\r\n\r\nIn the below code, I have incremented the counter on successful initialization. When you hit the actuator health endpoint, you will get the status as UP.\r\n\r\n**Sample implementation for context initialization health check:-**\r\n\r\n    @Component\r\n    public class ApplicationContextHealthIndicator implements HealthIndicator {\r\n    \r\n        private final Logger LOG = Logger.getLogger(getClass().getName());\r\n    \r\n        public static int counter;\r\n    \r\n        @EventListener\r\n        public void onApplicationEvent(ContextRefreshedEvent event) {\r\n            LOG.info(&quot;Increment counter :&quot; + counter);\r\n            counter++;\r\n        }\r\n    \r\n        @Override\r\n        public Health health() {\r\n            if (counter == 0) {\r\n                return Health.down().withDetail(&quot;Error Code&quot;, 500).build();\r\n            }\r\n            return Health.up().build();\r\n        }\r\n    }\r\n\r\n**Endpoint Spring boot version 5:-**\r\n\r\n&gt; http://localhost:8080/actuator/health\r\n\r\nSpring actuator can check the database, web service endpoints, email server etc. It can provide the status for all these resources which are part of the application.\r\n\r\n[Some default health indicators available][1]\r\n\r\n\r\n  [1]: https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html#_auto_configured_healthindicators","title":"Spring Boot&#39;s health actuator - WHEN is it UP?","body":"<p>In order to test whether the application context is loaded, you can perform this custom implementation.</p>\n\n<p><code>@EventListener</code> - The method annotated with EventListener is triggered when the context is initialized.</p>\n\n<p>In the below code, I have incremented the counter on successful initialization. When you hit the actuator health endpoint, you will get the status as UP.</p>\n\n<p><strong>Sample implementation for context initialization health check:-</strong></p>\n\n<pre><code>@Component\npublic class ApplicationContextHealthIndicator implements HealthIndicator {\n\n    private final Logger LOG = Logger.getLogger(getClass().getName());\n\n    public static int counter;\n\n    @EventListener\n    public void onApplicationEvent(ContextRefreshedEvent event) {\n        LOG.info(\"Increment counter :\" + counter);\n        counter++;\n    }\n\n    @Override\n    public Health health() {\n        if (counter == 0) {\n            return Health.down().withDetail(\"Error Code\", 500).build();\n        }\n        return Health.up().build();\n    }\n}\n</code></pre>\n\n<p><strong>Endpoint Spring boot version 5:-</strong></p>\n\n<blockquote>\n  <p><a href=\"http://localhost:8080/actuator/health\" rel=\"nofollow noreferrer\">http://localhost:8080/actuator/health</a></p>\n</blockquote>\n\n<p>Spring actuator can check the database, web service endpoints, email server etc. It can provide the status for all these resources which are part of the application.</p>\n\n<p><a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html#_auto_configured_healthindicators\" rel=\"nofollow noreferrer\">Some default health indicators available</a></p>\n"}],"owner":{"account_id":8258676,"reputation":973,"user_id":6210973,"display_name":"Mick"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":6012,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"answer_count":1,"score":4,"last_activity_date":1684828788,"creation_date":1520501314,"question_id":49169614,"body_markdown":"I cannot find any documentation on when Springs Health Actuator will return the UP status. Can you rely on all *`@Components`* being initialized? Will a *`@Controller`* be ready to serve requests?","title":"Spring Boot&#39;s health actuator - WHEN is it UP?","body":"<p>I cannot find any documentation on when Springs Health Actuator will return the UP status. Can you rely on all <em><code>@Components</code></em> being initialized? Will a <em><code>@Controller</code></em> be ready to serve requests?</p>\n"},{"tags":["java","mysql","spring-boot","docker","container-image"],"comments":[{"owner":{"account_id":2032415,"reputation":1277,"user_id":1815716,"accept_rate":38,"display_name":"prasad"},"score":0,"creation_date":1684822460,"post_id":76311639,"comment_id":134568856,"body_markdown":"can you please provide complete stacktrace looking some permissions issue","body":"can you please provide complete stacktrace looking some permissions issue"},{"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"score":1,"creation_date":1684825191,"post_id":76311639,"comment_id":134569365,"body_markdown":"Your jdbc url is for a docker service not for running locally. So it probably fails to connect to the database.","body":"Your jdbc url is for a docker service not for running locally. So it probably fails to connect to the database."}],"answers":[{"tags":[],"owner":{"account_id":28177079,"reputation":118,"user_id":21534708,"display_name":"Farfetch&#39;d"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1684828752,"creation_date":1684828752,"answer_id":76312471,"question_id":76311639,"body_markdown":"like M. Deinum suggest it you problably got this error due of a wrong jdbc url inside your application.properties. To solve that add mysql in your container (by adding an image of mysql inside your Dockerfile) or create an another container with mysql (with this second solution you have to modify jdbc url)\r\n","title":"Getting spring boot build error when trying to create jar file using docker container configurations in application.properties","body":"<p>like M. Deinum suggest it you problably got this error due of a wrong jdbc url inside your application.properties. To solve that add mysql in your container (by adding an image of mysql inside your Dockerfile) or create an another container with mysql (with this second solution you have to modify jdbc url)</p>\n"}],"owner":{"account_id":28386002,"reputation":13,"user_id":21712461,"display_name":"Dhruv Singhal"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":147,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76312471,"answer_count":1,"score":1,"last_activity_date":1684828752,"creation_date":1684821324,"question_id":76311639,"body_markdown":"Spring boot build failure when using docker configurations of mysql databases\r\n\r\n**Application.properties**\r\n\r\n    `spring.datasource.url=jdbc:mysql://mysqldb:3306/employeedb?useSSL=false\r\n     spring.datasource.username=sa\r\n     spring.datasource.password=1234\r\n     spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\r\n     spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL5InnoDBDialect\r\n     spring.jpa.hibernate.ddl-auto=update\r\n     spring.jpa.show-sql=true`\r\n\r\n**Dockerfile**\r\n\r\n\r\n    `FROM openjdk:8\r\n     ADD target/demo-0.0.1-SNAPSHOT.jar demo-0.0.1-SNAPSHOT.jar\r\n     EXPOSE 8080\r\n     ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;demo-0.0.1-SNAPSHOT.jar&quot;]`\r\n\r\n\r\nI am very new to docker and I am trying to dockerize my spring boot application which is using Mysql database, I have been following a tutorial, but when i am running mvn clean install to build the jar file, it is giving this error\r\n\r\n\r\n  **Error**\r\n    \r\n                 \r\n    ```Error starting ApplicationContext. To display the conditions \r\n     report re-run your application with &#39;debug&#39; enabled.\r\n     2023-05-22 16:33:55.304 ERROR 6245 --- [           main] \r\n     o.s.boot.SpringApplication               : Application run \r\n     failed\r\n\r\n    org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;entityManagerFactory&#39; defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: Invocation of init method failed; nested exception is javax.persistence.PersistenceException: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1804) ~[spring-beans-5.3.26.jar:5.3.26]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:620) ~[spring-beans-5.3.26.jar:5.3.26]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.26.jar:5.3.26]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.26.jar:5.3.26]\r\n","title":"Getting spring boot build error when trying to create jar file using docker container configurations in application.properties","body":"<p>Spring boot build failure when using docker configurations of mysql databases</p>\n<p><strong>Application.properties</strong></p>\n<pre><code>`spring.datasource.url=jdbc:mysql://mysqldb:3306/employeedb?useSSL=false\n spring.datasource.username=sa\n spring.datasource.password=1234\n spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\n spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL5InnoDBDialect\n spring.jpa.hibernate.ddl-auto=update\n spring.jpa.show-sql=true`\n</code></pre>\n<p><strong>Dockerfile</strong></p>\n<pre><code>`FROM openjdk:8\n ADD target/demo-0.0.1-SNAPSHOT.jar demo-0.0.1-SNAPSHOT.jar\n EXPOSE 8080\n ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;demo-0.0.1-SNAPSHOT.jar&quot;]`\n</code></pre>\n<p>I am very new to docker and I am trying to dockerize my spring boot application which is using Mysql database, I have been following a tutorial, but when i am running mvn clean install to build the jar file, it is giving this error</p>\n<p><strong>Error</strong></p>\n<pre><code>```Error starting ApplicationContext. To display the conditions \n report re-run your application with 'debug' enabled.\n 2023-05-22 16:33:55.304 ERROR 6245 --- [           main] \n o.s.boot.SpringApplication               : Application run \n failed\n\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: Invocation of init method failed; nested exception is javax.persistence.PersistenceException: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1804) ~[spring-beans-5.3.26.jar:5.3.26]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:620) ~[spring-beans-5.3.26.jar:5.3.26]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.26.jar:5.3.26]\nat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.26.jar:5.3.26]\n</code></pre>\n"},{"tags":["java","spring","spring-boot","spring-boot-actuator"],"answers":[{"tags":[],"owner":{"account_id":6089340,"reputation":138,"user_id":4752210,"display_name":"nakul shukla"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1609852005,"creation_date":1609852005,"answer_id":65579506,"question_id":65349051,"body_markdown":"I suppose you are talking about `/actuator/httptrace`.  Spring boot doesn&#39;t publish request and response payload by default. Also you need to provide implementation of &quot;InMemoryHttpTraceRepository&quot; bean to expose custom information for tracing. [This](https://developer.okta.com/blog/2019/07/17/monitoring-with-actuator) blog could be helpful.","title":"Adding response body to Spring Boot Actuator","body":"<p>I suppose you are talking about <code>/actuator/httptrace</code>.  Spring boot doesn't publish request and response payload by default. Also you need to provide implementation of &quot;InMemoryHttpTraceRepository&quot; bean to expose custom information for tracing. <a href=\"https://developer.okta.com/blog/2019/07/17/monitoring-with-actuator\" rel=\"nofollow noreferrer\">This</a> blog could be helpful.</p>\n"}],"owner":{"account_id":330015,"reputation":55,"user_id":6400480,"display_name":"Hesham Abboud"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1523,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":65579506,"answer_count":1,"score":0,"last_activity_date":1684828620,"creation_date":1608243150,"question_id":65349051,"body_markdown":"I&#39;d like to view the response body in Spring Boot Actuator. I have tried couple of tutorials I found but none is working. The most concrete answer I found was using WebRequestTraceFilter which is no longer supported in Spring Boot 2.X.\r\n\r\nAlternatively, if there&#39;s any tool like Laravel Telescope for Spring Boot would be great. I&#39;m already using Spring Boot Admin and it&#39;s great except for the response body part.","title":"Adding response body to Spring Boot Actuator","body":"<p>I'd like to view the response body in Spring Boot Actuator. I have tried couple of tutorials I found but none is working. The most concrete answer I found was using WebRequestTraceFilter which is no longer supported in Spring Boot 2.X.</p>\n<p>Alternatively, if there's any tool like Laravel Telescope for Spring Boot would be great. I'm already using Spring Boot Admin and it's great except for the response body part.</p>\n"},{"tags":["java","maven","quarkus","quarkus-panache"],"comments":[{"owner":{"account_id":3052937,"reputation":17914,"user_id":2587166,"accept_rate":83,"display_name":"Luca Basso Ricci"},"score":0,"creation_date":1684820536,"post_id":76309856,"comment_id":134568569,"body_markdown":"vintage-store is still using quarkus 2.x branch as opposite as other projects using Quarkus 3. Mistery solved.","body":"vintage-store is still using quarkus 2.x branch as opposite as other projects using Quarkus 3. Mistery solved."},{"owner":{"account_id":2922228,"reputation":61034,"user_id":2504224,"display_name":"geoand"},"score":1,"creation_date":1684822210,"post_id":76309856,"comment_id":134568811,"body_markdown":"@LucaBassoRicci why not add that as an answer? That way future readers can know immediately what the fix is instead of reading through comments.","body":"@LucaBassoRicci why not add that as an answer? That way future readers can know immediately what the fix is instead of reading through comments."},{"owner":{"account_id":3052937,"reputation":17914,"user_id":2587166,"accept_rate":83,"display_name":"Luca Basso Ricci"},"score":1,"creation_date":1684827710,"post_id":76309856,"comment_id":134569925,"body_markdown":"@geoand you&#39;re right, done :)","body":"@geoand you&#39;re right, done :)"}],"answers":[{"tags":[],"owner":{"account_id":3052937,"reputation":17914,"user_id":2587166,"accept_rate":83,"display_name":"Luca Basso Ricci"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1684827567,"creation_date":1684827567,"answer_id":76312312,"question_id":76309856,"body_markdown":"As @geoand pointed out of me I&#39;m moving my comment as answer for future readers.\r\n\r\n`vintage-store` is still using Quarkus 2.x branch as opposite as other projects are using Quarkus 3.","title":"java.lang.ClassNotFoundException: javax.inject.Provider - Quarkus","body":"<p>As @geoand pointed out of me I'm moving my comment as answer for future readers.</p>\n<p><code>vintage-store</code> is still using Quarkus 2.x branch as opposite as other projects are using Quarkus 3.</p>\n"}],"owner":{"account_id":10383987,"reputation":2344,"user_id":7657749,"display_name":"Jan D.M."},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":351,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"accepted_answer_id":76312312,"answer_count":1,"score":-2,"last_activity_date":1684828618,"creation_date":1684789065,"question_id":76309856,"body_markdown":"This is my Publisher object:\r\n```package org.agoncal.quarkus.panache.model;\r\n\r\nimport io.quarkus.hibernate.orm.panache.PanacheEntity;\r\n\r\nimport jakarta.persistence.Entity;\r\nimport java.time.Instant;\r\n\r\n@Entity\r\npublic class Publisher extends PanacheEntity {\r\n\r\n    // ======================================\r\n    // =             Attributes             =\r\n    // ======================================\r\n\r\n    public String name;\r\n\r\n    public Instant createdDate = Instant.now();\r\n\r\n    // ======================================\r\n    // =           Constructors             =\r\n    // ======================================\r\n\r\n    public Publisher(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public Publisher() {\r\n    }\r\n\r\n    @Override\r\n    public String toString() {\r\n        return &quot;Publisher{&quot; +\r\n                &quot;name=&#39;&quot; + name + &#39;\\&#39;&#39; +\r\n                &quot;, createdDate=&quot; + createdDate +\r\n                &quot;, id=&quot; + id +\r\n                &#39;}&#39;;\r\n    }\r\n}\r\n```\r\n\r\nThis is my test:\r\n\r\n```package org.agoncal.quarkus.panache.repository;\r\n\r\nimport io.quarkus.test.TestTransaction;\r\nimport io.quarkus.test.junit.QuarkusTest;\r\nimport org.agoncal.quarkus.panache.model.Publisher;\r\nimport org.junit.jupiter.api.Test;\r\n\r\nimport static org.junit.jupiter.api.Assertions.assertEquals;\r\nimport static org.junit.jupiter.api.Assertions.assertNotNull;\r\n\r\n@QuarkusTest\r\npublic class PublisherRepositoryTest {\r\n    @Test\r\n    @TestTransaction\r\n    public void shouldCreateAndFindPublisher() {\r\n        Publisher publisher = new Publisher(&quot;name&quot;);\r\n\r\n        publisher.persist(publisher);\r\n        assertNotNull(publisher.id);\r\n\r\n        publisher = publisher.findById(publisher.id);\r\n        assertEquals(&quot;name&quot;, publisher.name);\r\n\r\n    }\r\n\r\n}\r\n```\r\n\r\n\r\nThis is the error when doing a `mvn clean install`:\r\n```\r\n-------------------------------------------------------------------------------\r\nTest set: org.agoncal.quarkus.panache.repository.PublisherRepositoryTest\r\n-------------------------------------------------------------------------------\r\nTests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 3.755 s &lt;&lt;&lt; FAILURE! - in org.agoncal.quarkus.panache.repository.PublisherRepositoryTest\r\norg.agoncal.quarkus.panache.repository.PublisherRepositoryTest.shouldCreateAndFindPublisher  Time elapsed: 0.002 s  &lt;&lt;&lt; ERROR!\r\njava.lang.RuntimeException: java.lang.NoClassDefFoundError: javax/inject/Provider\r\nCaused by: java.lang.NoClassDefFoundError: javax/inject/Provider\r\nCaused by: java.lang.ClassNotFoundException: javax.inject.Provider\r\n```\r\n\r\nI think the error is quite weird, because I do not use javax in my code...\r\n","title":"java.lang.ClassNotFoundException: javax.inject.Provider - Quarkus","body":"<p>This is my Publisher object:</p>\n<pre><code>\nimport io.quarkus.hibernate.orm.panache.PanacheEntity;\n\nimport jakarta.persistence.Entity;\nimport java.time.Instant;\n\n@Entity\npublic class Publisher extends PanacheEntity {\n\n    // ======================================\n    // =             Attributes             =\n    // ======================================\n\n    public String name;\n\n    public Instant createdDate = Instant.now();\n\n    // ======================================\n    // =           Constructors             =\n    // ======================================\n\n    public Publisher(String name) {\n        this.name = name;\n    }\n\n    public Publisher() {\n    }\n\n    @Override\n    public String toString() {\n        return &quot;Publisher{&quot; +\n                &quot;name='&quot; + name + '\\'' +\n                &quot;, createdDate=&quot; + createdDate +\n                &quot;, id=&quot; + id +\n                '}';\n    }\n}\n</code></pre>\n<p>This is my test:</p>\n<pre><code>\nimport io.quarkus.test.TestTransaction;\nimport io.quarkus.test.junit.QuarkusTest;\nimport org.agoncal.quarkus.panache.model.Publisher;\nimport org.junit.jupiter.api.Test;\n\nimport static org.junit.jupiter.api.Assertions.assertEquals;\nimport static org.junit.jupiter.api.Assertions.assertNotNull;\n\n@QuarkusTest\npublic class PublisherRepositoryTest {\n    @Test\n    @TestTransaction\n    public void shouldCreateAndFindPublisher() {\n        Publisher publisher = new Publisher(&quot;name&quot;);\n\n        publisher.persist(publisher);\n        assertNotNull(publisher.id);\n\n        publisher = publisher.findById(publisher.id);\n        assertEquals(&quot;name&quot;, publisher.name);\n\n    }\n\n}\n</code></pre>\n<p>This is the error when doing a <code>mvn clean install</code>:</p>\n<pre><code>-------------------------------------------------------------------------------\nTest set: org.agoncal.quarkus.panache.repository.PublisherRepositoryTest\n-------------------------------------------------------------------------------\nTests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 3.755 s &lt;&lt;&lt; FAILURE! - in org.agoncal.quarkus.panache.repository.PublisherRepositoryTest\norg.agoncal.quarkus.panache.repository.PublisherRepositoryTest.shouldCreateAndFindPublisher  Time elapsed: 0.002 s  &lt;&lt;&lt; ERROR!\njava.lang.RuntimeException: java.lang.NoClassDefFoundError: javax/inject/Provider\nCaused by: java.lang.NoClassDefFoundError: javax/inject/Provider\nCaused by: java.lang.ClassNotFoundException: javax.inject.Provider\n</code></pre>\n<p>I think the error is quite weird, because I do not use javax in my code...</p>\n"},{"tags":["java","spring-boot","prometheus","metrics","spring-boot-actuator"],"comments":[{"owner":{"account_id":151394,"reputation":52351,"user_id":365237,"accept_rate":96,"display_name":"eis"},"score":0,"creation_date":1612434635,"post_id":66025939,"comment_id":116768040,"body_markdown":"I have no idea what you&#39;re trying to ask here. subject talks about logs but I see no logs in this question whatsoever.","body":"I have no idea what you&#39;re trying to ask here. subject talks about logs but I see no logs in this question whatsoever."},{"owner":{"account_id":20618965,"reputation":1,"user_id":15136395,"display_name":"Tobias Schnupp"},"score":0,"creation_date":1612446287,"post_id":66025939,"comment_id":116773274,"body_markdown":"Thanks for you comment. Spring Boot Actuator is recording the request within it&#39;s metrics.","body":"Thanks for you comment. Spring Boot Actuator is recording the request within it&#39;s metrics."},{"owner":{"account_id":151394,"reputation":52351,"user_id":365237,"accept_rate":96,"display_name":"eis"},"score":0,"creation_date":1612449718,"post_id":66025939,"comment_id":116774989,"body_markdown":"yes, but that&#39;s not related to logging. So you&#39;re worried about naming in metrics? also, are you sure if [simpleclient_spring_boot](https://github.com/prometheus/client_java) is recording the metrics and not spring? and what does your options controller look like?","body":"yes, but that&#39;s not related to logging. So you&#39;re worried about naming in metrics? also, are you sure if <a href=\"https://github.com/prometheus/client_java\" rel=\"nofollow noreferrer\">simpleclient_spring_boot</a> is recording the metrics and not spring? and what does your options controller look like?"},{"owner":{"account_id":151394,"reputation":52351,"user_id":365237,"accept_rate":96,"display_name":"eis"},"score":0,"creation_date":1612449947,"post_id":66025939,"comment_id":116775097,"body_markdown":"if your OPTIONS requests go to unmapped metrics, are they even mapped to any controller...","body":"if your OPTIONS requests go to unmapped metrics, are they even mapped to any controller..."},{"owner":{"account_id":20618965,"reputation":1,"user_id":15136395,"display_name":"Tobias Schnupp"},"score":0,"creation_date":1612533664,"post_id":66025939,"comment_id":116803903,"body_markdown":"The OPTIONS requests are not mapped by me. I&#39;m using the default Spring Mapping for this request.","body":"The OPTIONS requests are not mapped by me. I&#39;m using the default Spring Mapping for this request."}],"answers":[{"tags":[],"owner":{"account_id":20618965,"reputation":1,"user_id":15136395,"display_name":"Tobias Schnupp"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1612431719,"creation_date":1612431719,"answer_id":66043022,"question_id":66025939,"body_markdown":"Seems that updating Spring Boot to 1.5.22.RELEASE\r\n\r\nresults in an output for OPTIONS requests like this:\r\n```\r\n# HELP counter_status_200_unmapped counter_status_200_unmapped\r\n# TYPE counter_status_200_unmapped gauge\r\ncounter_status_200_unmapped 5.0\r\n```\r\n\r\nIt&#39;s not perfect but alle OPTIONS requests are collected into one metric and not each one in a seperate one.","title":"Spring Boot Actuator is recording OPTIONS requests with dynamic parameter of URL","body":"<p>Seems that updating Spring Boot to 1.5.22.RELEASE</p>\n<p>results in an output for OPTIONS requests like this:</p>\n<pre><code># HELP counter_status_200_unmapped counter_status_200_unmapped\n# TYPE counter_status_200_unmapped gauge\ncounter_status_200_unmapped 5.0\n</code></pre>\n<p>It's not perfect but alle OPTIONS requests are collected into one metric and not each one in a seperate one.</p>\n"}],"owner":{"account_id":20618965,"reputation":1,"user_id":15136395,"display_name":"Tobias Schnupp"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":379,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1684828604,"creation_date":1612349357,"question_id":66025939,"body_markdown":"we are unsing Spring Boot 1.5.9 and we do provide metrics for Prometheus.\r\n\r\nWhen we do receive OPTIONS requests the path parameter is not replaced. For GET Requests the parameter is replaced. The controller looks like this:\r\n\r\n```\r\n@Slf4j\r\n@RequestMapping(method = { RequestMethod.GET }, path = &quot;/claims/{token}&quot;)\r\n@RestController\r\npublic class ClaimDetailController {\r\n\r\n    @GetMapping(value = &quot;&quot;, produces = MediaType.APPLICATION_JSON_UTF8_VALUE, params = &quot;token&quot;)\r\n    public ResponseEntity getDetail(@PathVariable(value = &quot;token&quot;) final String token) {\r\n      ...\r\n    }\r\n}\r\n\r\n```\r\n\r\nWhen calling actuator with endpoint &quot;/prometheus&quot; we get:\r\n```\r\n# HELP gauge_response_claims_clgrRFhIRlNDV3pJTXhXRG40dWlPWURrVTJnMU1nPT0 gauge_response_claims_clgrRFhIRlNDV3pJTXhXRG40dWlPWURrVTJnMU1nPT0\r\n# TYPE gauge_response_claims_clgrRFhIRlNDV3pJTXhXRG40dWlPWURrVTJnMU1nPT0 gauge\r\ngauge_response_claims_clgrRFhIRlNDV3pJTXhXRG40dWlPWURrVTJnMU1nPT0 5.0\r\n# HELP gauge_response_claims_token gauge_response_claims_token\r\n# TYPE gauge_response_claims_token gauge\r\ngauge_response_claims_token 1502.0\r\n```\r\n\r\nThe first one is from the OPTIONS request. The second one from the GET request.\r\n\r\nSo why is the token from the OPTIONS request not replaced? Can this be achived?\r\nIf not - is it possible to remove OPTIONS requests from the metrics?\r\n\r\nAnd this is the /metrics output:\r\n\r\n&gt;counter.status.200.claims.clgrRFhIRlNDV3pJTXhXRG40dWlPWURrVTJnMU1nPT0\t2\r\n&gt;counter.status.200.cloudfoundryapplication\t4\r\n\r\nHere are some dependencies used by us:\r\n\r\n```\r\n&lt;parent&gt;\r\n\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t&lt;version&gt;1.5.9.RELEASE&lt;/version&gt;\r\n&lt;/parent&gt;\r\n\t\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-cloud-cloudfoundry-web&lt;/artifactId&gt;\r\n&lt;/dependency&gt;\r\n\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n&lt;/dependency&gt;\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-boot-starter-hateoas&lt;/artifactId&gt;\r\n&lt;/dependency&gt;\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\r\n&lt;/dependency&gt;\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;io.micrometer&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;micrometer-spring-legacy&lt;/artifactId&gt;\r\n\t&lt;version&gt;1.3.16&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;io.prometheus&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;simpleclient_spring_boot&lt;/artifactId&gt;\r\n\t&lt;version&gt;0.3.0&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;io.prometheus&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;simpleclient_servlet&lt;/artifactId&gt;\r\n\t&lt;version&gt;0.3.0&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;io.prometheus&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;simpleclient_hotspot&lt;/artifactId&gt;\r\n\t&lt;version&gt;0.3.0&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```","title":"Spring Boot Actuator is recording OPTIONS requests with dynamic parameter of URL","body":"<p>we are unsing Spring Boot 1.5.9 and we do provide metrics for Prometheus.</p>\n<p>When we do receive OPTIONS requests the path parameter is not replaced. For GET Requests the parameter is replaced. The controller looks like this:</p>\n<pre><code>@Slf4j\n@RequestMapping(method = { RequestMethod.GET }, path = &quot;/claims/{token}&quot;)\n@RestController\npublic class ClaimDetailController {\n\n    @GetMapping(value = &quot;&quot;, produces = MediaType.APPLICATION_JSON_UTF8_VALUE, params = &quot;token&quot;)\n    public ResponseEntity getDetail(@PathVariable(value = &quot;token&quot;) final String token) {\n      ...\n    }\n}\n\n</code></pre>\n<p>When calling actuator with endpoint &quot;/prometheus&quot; we get:</p>\n<pre><code># HELP gauge_response_claims_clgrRFhIRlNDV3pJTXhXRG40dWlPWURrVTJnMU1nPT0 gauge_response_claims_clgrRFhIRlNDV3pJTXhXRG40dWlPWURrVTJnMU1nPT0\n# TYPE gauge_response_claims_clgrRFhIRlNDV3pJTXhXRG40dWlPWURrVTJnMU1nPT0 gauge\ngauge_response_claims_clgrRFhIRlNDV3pJTXhXRG40dWlPWURrVTJnMU1nPT0 5.0\n# HELP gauge_response_claims_token gauge_response_claims_token\n# TYPE gauge_response_claims_token gauge\ngauge_response_claims_token 1502.0\n</code></pre>\n<p>The first one is from the OPTIONS request. The second one from the GET request.</p>\n<p>So why is the token from the OPTIONS request not replaced? Can this be achived?\nIf not - is it possible to remove OPTIONS requests from the metrics?</p>\n<p>And this is the /metrics output:</p>\n<blockquote>\n<p>counter.status.200.claims.clgrRFhIRlNDV3pJTXhXRG40dWlPWURrVTJnMU1nPT0  2\ncounter.status.200.cloudfoundryapplication 4</p>\n</blockquote>\n<p>Here are some dependencies used by us:</p>\n<pre><code>&lt;parent&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n    &lt;version&gt;1.5.9.RELEASE&lt;/version&gt;\n&lt;/parent&gt;\n    \n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-cloudfoundry-web&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-hateoas&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\n    &lt;artifactId&gt;micrometer-spring-legacy&lt;/artifactId&gt;\n    &lt;version&gt;1.3.16&lt;/version&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;io.prometheus&lt;/groupId&gt;\n    &lt;artifactId&gt;simpleclient_spring_boot&lt;/artifactId&gt;\n    &lt;version&gt;0.3.0&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.prometheus&lt;/groupId&gt;\n    &lt;artifactId&gt;simpleclient_servlet&lt;/artifactId&gt;\n    &lt;version&gt;0.3.0&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.prometheus&lt;/groupId&gt;\n    &lt;artifactId&gt;simpleclient_hotspot&lt;/artifactId&gt;\n    &lt;version&gt;0.3.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n"},{"tags":["java","spring","spring-boot","spring-boot-actuator"],"comments":[{"owner":{"account_id":3480040,"reputation":180,"user_id":2912358,"accept_rate":62,"display_name":"I2obiN"},"score":0,"creation_date":1649671091,"post_id":67091134,"comment_id":126926673,"body_markdown":"did you ever get this to work? have been asked to make reloadable configs happen with Springboot and have tried everything seemingly","body":"did you ever get this to work? have been asked to make reloadable configs happen with Springboot and have tried everything seemingly"}],"owner":{"account_id":14797232,"reputation":105,"user_id":10686571,"display_name":"Kropius Dop"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":304,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":0,"score":2,"last_activity_date":1684828546,"creation_date":1618400789,"question_id":67091134,"body_markdown":"i am trying to refresh a refresh scope bean using actuator.The class that needs to be refreshed:\r\n``` \r\n@ConfigurationProperties(prefix = &quot;push-sync&quot;)\r\n@RefreshScope\r\npublic class PushSyncProperties {\r\n\r\n    private boolean available = true;\r\n    private int maxSyncThreads = 5;\r\n    private int maxRequestsPerSecond = 5;\r\n    private int maxRetries = 10;\r\n    private long initialRetryDelay = 7 * 1000L;\r\n    private long maxRetryDelay = 8 * 60 * 60 * 1000L;\r\n    private int retryBackOffMultiplier = 3;\r\n    private long dbCheckInterval = 10 * 1000L;\r\n\r\n    @PostConstruct\r\n    public void refresh()\r\n    {\r\n        log.info(&quot;Application Refreshed!&quot;);\r\n        log.info(String.valueOf(maxSyncThreads));\r\n    } \r\n```\r\npart of the pom\r\n\r\n```\r\n &lt;dependency&gt;\r\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\r\n        &lt;/dependency&gt;\r\n\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-cloud-starter&lt;/artifactId&gt;\r\n            &lt;version&gt;2.2.3.RELEASE&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n\r\n```\r\nand the main class \r\n\r\n```\r\n@EnableConfigurationProperties({PushSyncProperties.class})\r\n@EnableScheduling\r\n@PropertySource(&quot;file:${push.sync.config}&quot;)\r\n@SpringBootApplication\r\npublic class Application extends SpringBootServletInitializer {\r\n\r\n    @Override\r\n    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {\r\n        String pushSyncConfigPath = SystemProperties.get(&quot;push.sync.config&quot;);\r\n        return application.sources(Application.class)\r\n                .properties(\r\n                        &quot;spring.config.location:classpath:/application.yml, &quot; + pushSyncConfigPath\r\n                );\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        SpringApplication.run(Application.class, args);\r\n    }\r\n\r\n}\r\n ```\r\n\r\nhowever, whenever changing a property from that specific file that maps my property class, the postConstruct function is called, but the value is never updated. Any idea why?","title":"Refresh scope not updating properties but refreshing the bean itself","body":"<p>i am trying to refresh a refresh scope bean using actuator.The class that needs to be refreshed:</p>\n<pre><code>@ConfigurationProperties(prefix = &quot;push-sync&quot;)\n@RefreshScope\npublic class PushSyncProperties {\n\n    private boolean available = true;\n    private int maxSyncThreads = 5;\n    private int maxRequestsPerSecond = 5;\n    private int maxRetries = 10;\n    private long initialRetryDelay = 7 * 1000L;\n    private long maxRetryDelay = 8 * 60 * 60 * 1000L;\n    private int retryBackOffMultiplier = 3;\n    private long dbCheckInterval = 10 * 1000L;\n\n    @PostConstruct\n    public void refresh()\n    {\n        log.info(&quot;Application Refreshed!&quot;);\n        log.info(String.valueOf(maxSyncThreads));\n    } \n</code></pre>\n<p>part of the pom</p>\n<pre><code> &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-cloud-starter&lt;/artifactId&gt;\n            &lt;version&gt;2.2.3.RELEASE&lt;/version&gt;\n        &lt;/dependency&gt;\n\n</code></pre>\n<p>and the main class</p>\n<pre><code>@EnableConfigurationProperties({PushSyncProperties.class})\n@EnableScheduling\n@PropertySource(&quot;file:${push.sync.config}&quot;)\n@SpringBootApplication\npublic class Application extends SpringBootServletInitializer {\n\n    @Override\n    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {\n        String pushSyncConfigPath = SystemProperties.get(&quot;push.sync.config&quot;);\n        return application.sources(Application.class)\n                .properties(\n                        &quot;spring.config.location:classpath:/application.yml, &quot; + pushSyncConfigPath\n                );\n    }\n\n    public static void main(String[] args) {\n        SpringApplication.run(Application.class, args);\n    }\n\n}\n</code></pre>\n<p>however, whenever changing a property from that specific file that maps my property class, the postConstruct function is called, but the value is never updated. Any idea why?</p>\n"},{"tags":["java","spring-boot","spring-boot-actuator","health-monitoring","health-check"],"comments":[{"owner":{"account_id":10777133,"reputation":7282,"user_id":7928721,"display_name":"samabcde"},"score":0,"creation_date":1621259539,"post_id":67567665,"comment_id":119434339,"body_markdown":"We can&#39;t help without any knowledge on how &quot;Base Service Servlet&quot; disable the GET.","body":"We can&#39;t help without any knowledge on how &quot;Base Service Servlet&quot; disable the GET."},{"owner":{"account_id":1546187,"reputation":131,"user_id":1439695,"accept_rate":80,"display_name":"Brian Antao"},"score":0,"creation_date":1621330252,"post_id":67567665,"comment_id":119456619,"body_markdown":"Thanks, I have updated the description with these details.","body":"Thanks, I have updated the description with these details."},{"owner":{"account_id":10777133,"reputation":7282,"user_id":7928721,"display_name":"samabcde"},"score":0,"creation_date":1621352114,"post_id":67567665,"comment_id":119467425,"body_markdown":"This is much better, and can you include more details for &quot;Base Service Servlet&quot;, how do you configure it with springboot, such that we can reproduce the problem.","body":"This is much better, and can you include more details for &quot;Base Service Servlet&quot;, how do you configure it with springboot, such that we can reproduce the problem."},{"owner":{"account_id":1546187,"reputation":131,"user_id":1439695,"accept_rate":80,"display_name":"Brian Antao"},"score":0,"creation_date":1621354833,"post_id":67567665,"comment_id":119468822,"body_markdown":"More details added to reproduce the problem","body":"More details added to reproduce the problem"}],"answers":[{"tags":[],"owner":{"account_id":10777133,"reputation":7282,"user_id":7928721,"display_name":"samabcde"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1621396652,"creation_date":1621396652,"answer_id":67596723,"question_id":67567665,"body_markdown":"We can register `DispatcherServlet` with health endpoint in mapping before the `ServiceServlet`.\r\n\r\n```java\r\n@SpringBootApplication\r\npublic class ServletInitializer extends SpringBootServletInitializer implements ServletContextInitializer {\r\n    @Autowired\r\n    private DispatcherServlet dispatcherServlet;\r\n\r\n    @Override\r\n    public void onStartup(ServletContext container) throws ServletException {\r\n        ServletRegistration.Dynamic dispatcher =\r\n                container.addServlet(&quot;dispatcher&quot;, dispatcherServlet);\r\n        dispatcher.setLoadOnStartup(1);\r\n        dispatcher.addMapping(&quot;/manage&quot;, &quot;/manage/health&quot;);\r\n\r\n        ServletRegistration.Dynamic application = container\r\n                .addServlet(&quot;ServiceServlet&quot;, new ServiceServlet());\r\n        application.setLoadOnStartup(2);\r\n        application.addMapping(&quot;/*&quot;);\r\n    }\r\n}\r\n```","title":"SpringBoot Actuator getting overshadowed by BaseService Servlet on same Port","body":"<p>We can register <code>DispatcherServlet</code> with health endpoint in mapping before the <code>ServiceServlet</code>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@SpringBootApplication\npublic class ServletInitializer extends SpringBootServletInitializer implements ServletContextInitializer {\n    @Autowired\n    private DispatcherServlet dispatcherServlet;\n\n    @Override\n    public void onStartup(ServletContext container) throws ServletException {\n        ServletRegistration.Dynamic dispatcher =\n                container.addServlet(&quot;dispatcher&quot;, dispatcherServlet);\n        dispatcher.setLoadOnStartup(1);\n        dispatcher.addMapping(&quot;/manage&quot;, &quot;/manage/health&quot;);\n\n        ServletRegistration.Dynamic application = container\n                .addServlet(&quot;ServiceServlet&quot;, new ServiceServlet());\n        application.setLoadOnStartup(2);\n        application.addMapping(&quot;/*&quot;);\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":1546187,"reputation":131,"user_id":1439695,"accept_rate":80,"display_name":"Brian Antao"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":372,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":67596723,"answer_count":1,"score":1,"last_activity_date":1684828496,"creation_date":1621246111,"question_id":67567665,"body_markdown":"We are Attempting to Migrate Our Existing Spring WebServices App to SpringBoot and ran into an issue for which we seek your advice.\r\n\r\nWe have a Base Service Servlet that disables the GET on the port that the App is deployed on for Security reasons this servlet returns 501 Unimplemented Response as follows:\r\n\r\n```java\r\n @Override\r\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\r\n        log.warn(&quot;GET request received!&quot;);\r\n        response.setStatus(HttpServletResponse.SC_NOT_IMPLEMENTED);\r\n    }\r\n```\r\n```java\r\npublic abstract class BaseServiceServlet extends HttpServlet {\r\n ...\r\n } \r\n  \r\n public class ServiceServlet extends BaseServiceServlet {\r\n ...\r\n } \r\n  \r\n  \r\n  public class ServletInitializer extends SpringBootServletInitializer implements ServletContextInitializer { \r\n  @Override\r\n    public void onStartup(ServletContext container) throws ServletException {\r\n\t\t \r\n      ServletRegistration.Dynamic application = container\r\n                .addServlet(&quot;ServiceServlet&quot;, new ServiceServlet()); \r\n      application.setLoadOnStartup(2);\r\n      application.addMapping(&quot;/*&quot;);\r\n        \r\n    }\r\n }\r\n```\r\nPreviously we had an old-fashioned HealthCheck JSP that we implemented. With the move to SpringBoot we are now using the SpringBoot Actuator.\r\n\r\nBut we find that if we set the Actuator health monitor port to the same one as the App when we try to monitor the health we get the 501 Unimplemented response.\r\n\r\nConfig is as follows:\r\n\r\n```\r\n# Spring-Boot Embedded Tomcat Config\r\nserver.port=8080\r\nserver.connection-timeout=10s\r\nserver.ssl.enabled=false\r\n## Springboot based health monitor\r\nmanagement.endpoints.enabled-by-default=true\r\nmanagement.endpoint.health.enabled=true\r\nmanagement.endpoint.loggers.enabled=true\r\nmanagement.endpoints.web.cors.allowed-methods=GET\r\nmanagement.endpoint.beans.cache.time-to-live=20s\r\nmanagement.endpoints.web.base-path=/manage\r\nmanagement.server.port=8080\r\nmanagement.security.enabled=false \r\n```\r\n\r\nOne way we could get around this problem is if we changed the actuator health check port to something else that Works.\r\n\r\nQuestion:\r\n    How can we set the Actuator port to be the same as the App and make the actuator health check url which is something like http://localhost:8080/manage/health not return 501 Unimplemented from the Base Service Servlet ?","title":"SpringBoot Actuator getting overshadowed by BaseService Servlet on same Port","body":"<p>We are Attempting to Migrate Our Existing Spring WebServices App to SpringBoot and ran into an issue for which we seek your advice.</p>\n<p>We have a Base Service Servlet that disables the GET on the port that the App is deployed on for Security reasons this servlet returns 501 Unimplemented Response as follows:</p>\n<pre class=\"lang-java prettyprint-override\"><code> @Override\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        log.warn(&quot;GET request received!&quot;);\n        response.setStatus(HttpServletResponse.SC_NOT_IMPLEMENTED);\n    }\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>public abstract class BaseServiceServlet extends HttpServlet {\n ...\n } \n  \n public class ServiceServlet extends BaseServiceServlet {\n ...\n } \n  \n  \n  public class ServletInitializer extends SpringBootServletInitializer implements ServletContextInitializer { \n  @Override\n    public void onStartup(ServletContext container) throws ServletException {\n         \n      ServletRegistration.Dynamic application = container\n                .addServlet(&quot;ServiceServlet&quot;, new ServiceServlet()); \n      application.setLoadOnStartup(2);\n      application.addMapping(&quot;/*&quot;);\n        \n    }\n }\n</code></pre>\n<p>Previously we had an old-fashioned HealthCheck JSP that we implemented. With the move to SpringBoot we are now using the SpringBoot Actuator.</p>\n<p>But we find that if we set the Actuator health monitor port to the same one as the App when we try to monitor the health we get the 501 Unimplemented response.</p>\n<p>Config is as follows:</p>\n<pre><code># Spring-Boot Embedded Tomcat Config\nserver.port=8080\nserver.connection-timeout=10s\nserver.ssl.enabled=false\n## Springboot based health monitor\nmanagement.endpoints.enabled-by-default=true\nmanagement.endpoint.health.enabled=true\nmanagement.endpoint.loggers.enabled=true\nmanagement.endpoints.web.cors.allowed-methods=GET\nmanagement.endpoint.beans.cache.time-to-live=20s\nmanagement.endpoints.web.base-path=/manage\nmanagement.server.port=8080\nmanagement.security.enabled=false \n</code></pre>\n<p>One way we could get around this problem is if we changed the actuator health check port to something else that Works.</p>\n<p>Question:\nHow can we set the Actuator port to be the same as the App and make the actuator health check url which is something like http://localhost:8080/manage/health not return 501 Unimplemented from the Base Service Servlet ?</p>\n"},{"tags":["java","spring-boot","spring-boot-actuator","dynamic-properties"],"comments":[{"owner":{"account_id":22354823,"reputation":16499,"user_id":16572295,"display_name":"Jo&#227;o Dias"},"score":0,"creation_date":1634231346,"post_id":69571749,"comment_id":122975957,"body_markdown":"Is the logic in `doHealthCheck` method of `App1HealthCheckContributor` and `MyHealthCheckContributor` exactly the same so that you can have a single class covering both use cases?","body":"Is the logic in <code>doHealthCheck</code> method of <code>App1HealthCheckContributor</code> and <code>MyHealthCheckContributor</code> exactly the same so that you can have a single class covering both use cases?"},{"owner":{"account_id":3274061,"reputation":2691,"user_id":2756760,"accept_rate":51,"display_name":"du-it"},"score":0,"creation_date":1634341064,"post_id":69571749,"comment_id":123006641,"body_markdown":"Yes, the logic is equal.","body":"Yes, the logic is equal."}],"answers":[{"comments":[{"owner":{"account_id":3274061,"reputation":2691,"user_id":2756760,"accept_rate":51,"display_name":"du-it"},"score":1,"creation_date":1634341281,"post_id":69574978,"comment_id":123006661,"body_markdown":"Works like a charm, Jo&#227;o. How could I test that the contributors are generated and registered in the Spring Boot context?","body":"Works like a charm, Jo&#227;o. How could I test that the contributors are generated and registered in the Spring Boot context?"},{"owner":{"account_id":22354823,"reputation":16499,"user_id":16572295,"display_name":"Jo&#227;o Dias"},"score":0,"creation_date":1634422272,"post_id":69574978,"comment_id":123021394,"body_markdown":"You would need to add an `application-test.yml` configuration and use `test` profile in your `@SpringBootTest`.","body":"You would need to add an <code>application-test.yml</code> configuration and use <code>test</code> profile in your <code>@SpringBootTest</code>."},{"owner":{"account_id":3274061,"reputation":2691,"user_id":2756760,"accept_rate":51,"display_name":"du-it"},"score":0,"creation_date":1634503032,"post_id":69574978,"comment_id":123036016,"body_markdown":"I already did but accessing the configuration always results in a NPE.","body":"I already did but accessing the configuration always results in a NPE."},{"owner":{"account_id":22354823,"reputation":16499,"user_id":16572295,"display_name":"Jo&#227;o Dias"},"score":0,"creation_date":1634511934,"post_id":69574978,"comment_id":123037753,"body_markdown":"Then I would suggest you create an additional question and include all your code and tests. Share the link in a comment. Thanks!","body":"Then I would suggest you create an additional question and include all your code and tests. Share the link in a comment. Thanks!"},{"owner":{"account_id":3274061,"reputation":2691,"user_id":2756760,"accept_rate":51,"display_name":"du-it"},"score":0,"creation_date":1634578167,"post_id":69574978,"comment_id":123057426,"body_markdown":"I did so. You can find the link at the end of my original question. Furthermore I found this article about avoiding @PostConstruct:https://levelup.gitconnected.com/stop-using-postconstruct-in-your-java-applications-2a66fb202cb8 \nWhat do you think about?","body":"I did so. You can find the link at the end of my original question. Furthermore I found this article about avoiding @PostConstruct:<a href=\"https://levelup.gitconnected.com/stop-using-postconstruct-in-your-java-applications-2a66fb202cb8\" rel=\"nofollow noreferrer\">levelup.gitconnected.com/&hellip;</a>  What do you think about?"},{"owner":{"account_id":22354823,"reputation":16499,"user_id":16572295,"display_name":"Jo&#227;o Dias"},"score":0,"creation_date":1634585194,"post_id":69574978,"comment_id":123059816,"body_markdown":"I get it and I agree if this is a regular Service or something similar. But this is a configuration class, you will never reuse it and most likely you will not test it directly. Nevertheless, you can always try the constructor approach.","body":"I get it and I agree if this is a regular Service or something similar. But this is a configuration class, you will never reuse it and most likely you will not test it directly. Nevertheless, you can always try the constructor approach."},{"owner":{"account_id":3274061,"reputation":2691,"user_id":2756760,"accept_rate":51,"display_name":"du-it"},"score":0,"creation_date":1634831018,"post_id":69574978,"comment_id":123137998,"body_markdown":"Instantiating the health check indicators this way prevent me from setting @ConditionalOnEnabledHealthIndicator annotation, right? I think I a allowed to put exactly only ONE indicator but not @ConditionalOnEnabledHealthIndicator(aaa,bbb,ccc). Hence, I can&#39;t dis-/enable the indicator in application.properties using management.endpoint.aaa.enabled=true/false ...or is there a possibility to do?","body":"Instantiating the health check indicators this way prevent me from setting @ConditionalOnEnabledHealthIndicator annotation, right? I think I a allowed to put exactly only ONE indicator but not @ConditionalOnEnabledHealthIndicator(aaa,bbb,ccc). Hence, I can&#39;t dis-/enable the indicator in application.properties using management.endpoint.aaa.enabled=true/false ...or is there a possibility to do?"},{"owner":{"account_id":3274061,"reputation":2691,"user_id":2756760,"accept_rate":51,"display_name":"du-it"},"score":0,"creation_date":1634833628,"post_id":69574978,"comment_id":123139204,"body_markdown":"Maybe using @ConditionalOnEnabledHealthIndicator(&quot;app&quot;) with management.endpoint.app.enabled=true/false but this is an all or nothing approach and I can&#39;t disable selectively.","body":"Maybe using @ConditionalOnEnabledHealthIndicator(&quot;app&quot;) with management.endpoint.app.enabled=true/false but this is an all or nothing approach and I can&#39;t disable selectively."},{"owner":{"account_id":22354823,"reputation":16499,"user_id":16572295,"display_name":"Jo&#227;o Dias"},"score":0,"creation_date":1634848898,"post_id":69574978,"comment_id":123144525,"body_markdown":"I would say it should work with the name you configure in your `application.yml`, but not sure to be honest. Never tried that.","body":"I would say it should work with the name you configure in your <code>application.yml</code>, but not sure to be honest. Never tried that."},{"owner":{"account_id":3274061,"reputation":2691,"user_id":2756760,"accept_rate":51,"display_name":"du-it"},"score":0,"creation_date":1634885136,"post_id":69574978,"comment_id":123151152,"body_markdown":"But WHICH name? I defined it as an array. I tried it using @ConditionalOnEnabledHealthIndicator(aaa,bbb,ccc) but this din&#39;t work. Maybe you are able to find a solution!? ;-)","body":"But WHICH name? I defined it as an array. I tried it using @ConditionalOnEnabledHealthIndicator(aaa,bbb,ccc) but this din&#39;t work. Maybe you are able to find a solution!? ;-)"},{"owner":{"account_id":22354823,"reputation":16499,"user_id":16572295,"display_name":"Jo&#227;o Dias"},"score":0,"creation_date":1634893094,"post_id":69574978,"comment_id":123154094,"body_markdown":"`@ConditionalOnEnabledHealthIndicator` does not support multiple names. At least reading the documentation seems that way: &quot;value - The name of the health indicator.&quot;. Maybe you can use multiple `@ConditionalOnEnabledHealthIndicator` but I am not really sure that Spring supports that.","body":"<code>@ConditionalOnEnabledHealthIndicator</code> does not support multiple names. At least reading the documentation seems that way: &quot;value - The name of the health indicator.&quot;. Maybe you can use multiple <code>@ConditionalOnEnabledHealthIndicator</code> but I am not really sure that Spring supports that."},{"owner":{"account_id":3274061,"reputation":2691,"user_id":2756760,"accept_rate":51,"display_name":"du-it"},"score":0,"creation_date":1634893564,"post_id":69574978,"comment_id":123154307,"body_markdown":"No, Spring complains about multiple usage of `@ConditionalOnEnabledHealthIndicator`. I tried already. Would be an improvement if Spring would support this. Seems as if this way of creating indicators was not considered or not wanted.","body":"No, Spring complains about multiple usage of <code>@ConditionalOnEnabledHealthIndicator</code>. I tried already. Would be an improvement if Spring would support this. Seems as if this way of creating indicators was not considered or not wanted."}],"tags":[],"owner":{"account_id":22354823,"reputation":16499,"user_id":16572295,"display_name":"Jo&#227;o Dias"},"comment_count":12,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1634232590,"creation_date":1634232590,"answer_id":69574978,"question_id":69571749,"body_markdown":"Assuming the code in `doHealthCheck` is exactly the same for all apps to be checked you could do the following.\r\n\r\nYou would start by creating a single health check class:\r\n```java\r\n@Slf4j\r\npublic class AppHealthCheckContributor extends AbstractHealthIndicator {\r\n\r\n    private final AppProperties appProperties;\r\n\r\n    public App1HealthCheckContributor(final AppProperties appProperties) {\r\n        this.appProperties = appProperties;\r\n    }\r\n\r\n    @Override\r\n    protected void doHealthCheck(Health.Builder builder) {...}\r\n}\r\n```\r\n\r\nAnd the properties model as follows:\r\n```java\r\n@Slf4j\r\n@Data\r\npublic class AppProperties {\r\n    private String baseUrl;\r\n    private String name;\r\n}\r\n```\r\n\r\nThis means that the configuration would be something like the following (in `application.yml`):\r\n```yml\r\nhealth-check:\r\n  apps:\r\n    - baseUrl: http://localhost:10000\r\n      name: app1\r\n    - baseUrl: http://localhost:10001\r\n      name: app2\r\n```\r\n\r\nFinally, you would need to create a bean for each app and register them in the application context:\r\n```java\r\n@Slf4j\r\n@Data\r\n@Configuration\r\n@ConfigurationProperties(prefix = &quot;health-check&quot;)\r\npublic class AllAppPropertiesConfiguration {\r\n    private List&lt;AppProperties&gt; apps;\r\n\r\n    @Autowired\r\n    private GenericApplicationContext applicationContext;\r\n\r\n    @PostConstruct\r\n    fun init() {\r\n        for (AppProperties app : apps) {\r\n            applicationContext.registerBean(app.getName(), AppHealthCheckContributor.class, app);\r\n        }\r\n    }\r\n}\r\n```","title":"Multiple instances of a bean of one class filled with values from application.properties","body":"<p>Assuming the code in <code>doHealthCheck</code> is exactly the same for all apps to be checked you could do the following.</p>\n<p>You would start by creating a single health check class:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Slf4j\npublic class AppHealthCheckContributor extends AbstractHealthIndicator {\n\n    private final AppProperties appProperties;\n\n    public App1HealthCheckContributor(final AppProperties appProperties) {\n        this.appProperties = appProperties;\n    }\n\n    @Override\n    protected void doHealthCheck(Health.Builder builder) {...}\n}\n</code></pre>\n<p>And the properties model as follows:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Slf4j\n@Data\npublic class AppProperties {\n    private String baseUrl;\n    private String name;\n}\n</code></pre>\n<p>This means that the configuration would be something like the following (in <code>application.yml</code>):</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>health-check:\n  apps:\n    - baseUrl: http://localhost:10000\n      name: app1\n    - baseUrl: http://localhost:10001\n      name: app2\n</code></pre>\n<p>Finally, you would need to create a bean for each app and register them in the application context:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Slf4j\n@Data\n@Configuration\n@ConfigurationProperties(prefix = &quot;health-check&quot;)\npublic class AllAppPropertiesConfiguration {\n    private List&lt;AppProperties&gt; apps;\n\n    @Autowired\n    private GenericApplicationContext applicationContext;\n\n    @PostConstruct\n    fun init() {\n        for (AppProperties app : apps) {\n            applicationContext.registerBean(app.getName(), AppHealthCheckContributor.class, app);\n        }\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":3274061,"reputation":2691,"user_id":2756760,"accept_rate":51,"display_name":"du-it"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":793,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":69574978,"answer_count":1,"score":3,"last_activity_date":1684828423,"creation_date":1634218724,"question_id":69571749,"body_markdown":"I intend to write some `HealtCheckContributors` for a Spring Boot application using *spring-boot-actuator*. Hence, I implemented two of them. they are intended for checking the health of different apps, of course, but have a nearly identical structure, except the configuration properties, ...\r\n\r\nSonarQube complains about that and I wonder if it is possible to have a single health check class but instantiated as many times as defined in `application.properties`. \r\nAn example: \r\n\r\n`application.properties`:\r\n```\r\n# actuator\r\napp1.management.baseUrl=http://localhost:10000\r\napp1.management.name=app1HealthCheckContributor\r\napp2.management.basUrl=http://localhost:10001\r\napp2.management.name=app2HealthCheckContributor\r\n```\r\n\r\n`HealthCheckContributor` for app1:\r\n```java\r\n@Slf4j\r\n@Component(&quot;xxx&quot;)\r\npublic class App1HealthCheckContributor extends AbstractHealthIndicator {\r\n\r\n    private final App1Properties app1Properties;\r\n\r\n    public App1HealthCheckContributor(final App1Properties app1Properties) {\r\n        this.app1Properties = app1Properties;\r\n    }\r\n\r\n    @Override\r\n    protected void doHealthCheck(Health.Builder builder) {...}\r\n}\r\n```\r\n\r\n...and this code for each `HealthCheckContributor` only distinct in its *appXProperties*. \r\n\r\nIsn&#39;t it possible to have some kind of base class like:\r\n```java\r\n@Slf4j\r\n@Component()\r\npublic class MyHealthCheckContributor extends AbstractHealthIndicator {\r\n\r\n    private final MyProperties myProperties;\r\n\r\n    public MyHealthCheckContributor(final MyProperties myProperties) {\r\n        this.myProperties = myProperties;\r\n    }\r\n\r\n    @Override\r\n    protected void doHealthCheck(Health.Builder builder) {...}\r\n}\r\n```\r\n\r\nand let Spring Boot take care of instantiating two `HealthCheckContributors` (in our case `App1HealthCheckContributor` and `App2HealthCheckContributor`)? \r\nThis would eliminate code duplication.\r\n\r\nAn example of the properties class file:\r\n```java\r\n@Slf4j\r\n@Data\r\n@ConfigurationProperties(prefix = &quot;app1.management&quot;)\r\npublic class App1Properties {\r\n    private String baseUrl;\r\n    private String ...;\r\n}\r\n```\r\n\r\nHow can I achieve this and how must an `application.properties` file looks like to achieve what I intend to do?\r\n\r\nThe final question: [How to test multiple instance creation of a bean of one class filled with values from application.properties?][1]\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/69620134/how-to-test-multiple-instance-creation-of-a-bean-of-one-class-filled-with-values","title":"Multiple instances of a bean of one class filled with values from application.properties","body":"<p>I intend to write some <code>HealtCheckContributors</code> for a Spring Boot application using <em>spring-boot-actuator</em>. Hence, I implemented two of them. they are intended for checking the health of different apps, of course, but have a nearly identical structure, except the configuration properties, ...</p>\n<p>SonarQube complains about that and I wonder if it is possible to have a single health check class but instantiated as many times as defined in <code>application.properties</code>.\nAn example:</p>\n<p><code>application.properties</code>:</p>\n<pre><code># actuator\napp1.management.baseUrl=http://localhost:10000\napp1.management.name=app1HealthCheckContributor\napp2.management.basUrl=http://localhost:10001\napp2.management.name=app2HealthCheckContributor\n</code></pre>\n<p><code>HealthCheckContributor</code> for app1:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Slf4j\n@Component(&quot;xxx&quot;)\npublic class App1HealthCheckContributor extends AbstractHealthIndicator {\n\n    private final App1Properties app1Properties;\n\n    public App1HealthCheckContributor(final App1Properties app1Properties) {\n        this.app1Properties = app1Properties;\n    }\n\n    @Override\n    protected void doHealthCheck(Health.Builder builder) {...}\n}\n</code></pre>\n<p>...and this code for each <code>HealthCheckContributor</code> only distinct in its <em>appXProperties</em>.</p>\n<p>Isn't it possible to have some kind of base class like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Slf4j\n@Component()\npublic class MyHealthCheckContributor extends AbstractHealthIndicator {\n\n    private final MyProperties myProperties;\n\n    public MyHealthCheckContributor(final MyProperties myProperties) {\n        this.myProperties = myProperties;\n    }\n\n    @Override\n    protected void doHealthCheck(Health.Builder builder) {...}\n}\n</code></pre>\n<p>and let Spring Boot take care of instantiating two <code>HealthCheckContributors</code> (in our case <code>App1HealthCheckContributor</code> and <code>App2HealthCheckContributor</code>)?\nThis would eliminate code duplication.</p>\n<p>An example of the properties class file:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Slf4j\n@Data\n@ConfigurationProperties(prefix = &quot;app1.management&quot;)\npublic class App1Properties {\n    private String baseUrl;\n    private String ...;\n}\n</code></pre>\n<p>How can I achieve this and how must an <code>application.properties</code> file looks like to achieve what I intend to do?</p>\n<p>The final question: <a href=\"https://stackoverflow.com/questions/69620134/how-to-test-multiple-instance-creation-of-a-bean-of-one-class-filled-with-values\">How to test multiple instance creation of a bean of one class filled with values from application.properties?</a></p>\n"},{"tags":["java","spring","logging","filter","spring-boot-actuator"],"comments":[{"owner":{"account_id":74704,"reputation":11534,"user_id":214525,"accept_rate":100,"display_name":"f1sh"},"score":0,"creation_date":1625655425,"post_id":68284273,"comment_id":120683076,"body_markdown":"I don&#39;t know the answer, but a log level of DEBUG will always be spammy.","body":"I don&#39;t know the answer, but a log level of DEBUG will always be spammy."}],"answers":[{"comments":[{"owner":{"account_id":2259461,"reputation":147,"user_id":1989887,"accept_rate":80,"display_name":"MonitorLizard"},"score":0,"creation_date":1626074370,"post_id":68309373,"comment_id":120785657,"body_markdown":"Thanks a lot for your extensive answer including sample code!!!\nThis seems to remove the log lines &quot;Before request&quot; and &quot;After request&quot;.\nHowever, a lot is logged when AbstractRequestLoggingFilter.doFilterInternal calls filterChain.doFilter. This part is still logged.","body":"Thanks a lot for your extensive answer including sample code!!! This seems to remove the log lines &quot;Before request&quot; and &quot;After request&quot;. However, a lot is logged when AbstractRequestLoggingFilter.doFilterInternal calls filterChain.doFilter. This part is still logged."},{"owner":{"account_id":2259461,"reputation":147,"user_id":1989887,"accept_rate":80,"display_name":"MonitorLizard"},"score":0,"creation_date":1626074737,"post_id":68309373,"comment_id":120785788,"body_markdown":"(6 lines in trace mode, 4 lines in debug mode).","body":"(6 lines in trace mode, 4 lines in debug mode)."},{"owner":{"account_id":11119792,"reputation":2581,"user_id":8163025,"display_name":"saver"},"score":0,"creation_date":1626296035,"post_id":68309373,"comment_id":120858238,"body_markdown":"My answer is like example, you can define your own filter which will be not extended from AbstractRequestLoggingFilter or you can override methods for correct logging, but the main idea of logging requests should be based on filters.","body":"My answer is like example, you can define your own filter which will be not extended from AbstractRequestLoggingFilter or you can override methods for correct logging, but the main idea of logging requests should be based on filters."}],"tags":[],"owner":{"account_id":11119792,"reputation":2581,"user_id":8163025,"display_name":"saver"},"comment_count":3,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1625784239,"creation_date":1625784239,"answer_id":68309373,"question_id":68284273,"body_markdown":"I recommend to use Spring Built-In request logging filter ```CommonsRequestLoggingFilter```. \r\n\r\nTo enable the logging filter, you need to set the property:\r\n```\r\nlogging.level.org.springframework.web.filter.CommonsRequestLoggingFilter=DEBUG\r\n```\r\nBut when you need specify custom rules for enabling logging, you can create custom implementation in following way:\r\n```\r\n@Component\r\npublic class RequestLoggingFilter extends AbstractRequestLoggingFilter {\r\n\r\n    private Set&lt;String&gt; excludedUrls = Set.of(&quot;/health&quot;);\r\n\r\n    @Override\r\n    protected boolean shouldLog(HttpServletRequest request) {\r\n        if(excludedUrls.contains(request.getRequestURI())) {\r\n            return false;\r\n        }\r\n        return logger.isDebugEnabled();\r\n    }\r\n\r\n    @Override\r\n    protected void beforeRequest(HttpServletRequest request, String message) {\r\n        logger.debug(message);\r\n    }\r\n\r\n    @Override\r\n    protected void afterRequest(HttpServletRequest request, String message) {\r\n        logger.debug(message);\r\n    }\r\n}\r\n```\r\nand to enable the filter add the following config property to ```application.properties```:\r\n```\r\nlogging.level.&lt;package_name&gt;.RequestLoggingFilter=DEBUG\r\n```","title":"How to exclude certain HTTP requests from being logged in Java Spring (e.g. /health Endpoint)","body":"<p>I recommend to use Spring Built-In request logging filter <code>CommonsRequestLoggingFilter</code>.</p>\n<p>To enable the logging filter, you need to set the property:</p>\n<pre><code>logging.level.org.springframework.web.filter.CommonsRequestLoggingFilter=DEBUG\n</code></pre>\n<p>But when you need specify custom rules for enabling logging, you can create custom implementation in following way:</p>\n<pre><code>@Component\npublic class RequestLoggingFilter extends AbstractRequestLoggingFilter {\n\n    private Set&lt;String&gt; excludedUrls = Set.of(&quot;/health&quot;);\n\n    @Override\n    protected boolean shouldLog(HttpServletRequest request) {\n        if(excludedUrls.contains(request.getRequestURI())) {\n            return false;\n        }\n        return logger.isDebugEnabled();\n    }\n\n    @Override\n    protected void beforeRequest(HttpServletRequest request, String message) {\n        logger.debug(message);\n    }\n\n    @Override\n    protected void afterRequest(HttpServletRequest request, String message) {\n        logger.debug(message);\n    }\n}\n</code></pre>\n<p>and to enable the filter add the following config property to <code>application.properties</code>:</p>\n<pre><code>logging.level.&lt;package_name&gt;.RequestLoggingFilter=DEBUG\n</code></pre>\n"},{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1681271575,"post_id":75956983,"comment_id":134027877,"body_markdown":"As it’s currently written, your answer is unclear. Please [edit] to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"As it’s currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/75956983/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":24037555,"reputation":1,"user_id":18017655,"display_name":"Couch Potato"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1680858159,"creation_date":1680858159,"answer_id":75956983,"question_id":68284273,"body_markdown":"What if i get this error?\r\n\r\n&gt; 2023-04-07 11:57:05.227 INFO \r\n&gt; org.springframework.aop.framework.CglibAopProxy.doValidateClass():263\r\n&gt; - Unable to proxy interface-implementing method [public final void org.springframework.web.filter.OncePerRequestFilter.doFilter(javax.servlet.ServletRequest,javax.servlet.ServletResponse,javax.servlet.FilterChain)\r\n&gt; throws javax.servlet.ServletException,java.io.IOException] because it\r\n&gt; is marked as final: Consider using interface-based JDK proxies\r\n&gt; instead! 2023-04-07 11:57:05.228 INFO \r\n&gt; org.springframework.aop.framework.CglibAopProxy.doValidateClass():263\r\n&gt; - Unable to proxy interface-implementing method [public final void org.springframework.web.filter.GenericFilterBean.init(javax.servlet.FilterConfig)\r\n&gt; throws javax.servlet.ServletException] because it is marked as final:\r\n&gt; Consider using interface-based JDK proxies instead! 2023-04-07\r\n&gt; 11:57:05.343 ERROR org.apache.juli.logging.DirectJDKLog.log():175 -\r\n&gt; Exception starting filter [requestLoggingFilter]\r\n&gt; java.lang.NullPointerException: Cannot invoke\r\n&gt; &quot;org.apache.commons.logging.Log.isDebugEnabled()&quot; because\r\n&gt; &quot;this.logger&quot; is null\r\n\r\n    @Component\r\n    \r\n    public class RequestLoggingFilter extends AbstractRequestLoggingFilter {\r\n\r\n    @Override\r\n    protected boolean shouldLog(HttpServletRequest request) {\r\n        return !request.getServletPath().contains(&quot;actuator/health&quot;);\r\n    }\r\n\r\n    @Override\r\n    protected void beforeRequest(HttpServletRequest request, String message) {\r\n        logger.debug(message);\r\n    }\r\n\r\n    @Override\r\n    protected void afterRequest(HttpServletRequest request, String message) {\r\n        logger.debug(message);\r\n    }\r\n    }","title":"How to exclude certain HTTP requests from being logged in Java Spring (e.g. /health Endpoint)","body":"<p>What if i get this error?</p>\n<blockquote>\n<p>2023-04-07 11:57:05.227 INFO\norg.springframework.aop.framework.CglibAopProxy.doValidateClass():263</p>\n<ul>\n<li>Unable to proxy interface-implementing method [public final void org.springframework.web.filter.OncePerRequestFilter.doFilter(javax.servlet.ServletRequest,javax.servlet.ServletResponse,javax.servlet.FilterChain)\nthrows javax.servlet.ServletException,java.io.IOException] because it\nis marked as final: Consider using interface-based JDK proxies\ninstead! 2023-04-07 11:57:05.228 INFO\norg.springframework.aop.framework.CglibAopProxy.doValidateClass():263</li>\n<li>Unable to proxy interface-implementing method [public final void org.springframework.web.filter.GenericFilterBean.init(javax.servlet.FilterConfig)\nthrows javax.servlet.ServletException] because it is marked as final:\nConsider using interface-based JDK proxies instead! 2023-04-07\n11:57:05.343 ERROR org.apache.juli.logging.DirectJDKLog.log():175 -\nException starting filter [requestLoggingFilter]\njava.lang.NullPointerException: Cannot invoke\n&quot;org.apache.commons.logging.Log.isDebugEnabled()&quot; because\n&quot;this.logger&quot; is null</li>\n</ul>\n</blockquote>\n<pre><code>@Component\n\npublic class RequestLoggingFilter extends AbstractRequestLoggingFilter {\n\n@Override\nprotected boolean shouldLog(HttpServletRequest request) {\n    return !request.getServletPath().contains(&quot;actuator/health&quot;);\n}\n\n@Override\nprotected void beforeRequest(HttpServletRequest request, String message) {\n    logger.debug(message);\n}\n\n@Override\nprotected void afterRequest(HttpServletRequest request, String message) {\n    logger.debug(message);\n}\n}\n</code></pre>\n"}],"owner":{"account_id":2259461,"reputation":147,"user_id":1989887,"accept_rate":80,"display_name":"MonitorLizard"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4390,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":2,"score":3,"last_activity_date":1684828390,"creation_date":1625653612,"question_id":68284273,"body_markdown":"In my Spring boot application the following setting: \r\n\r\n    logging.org.springframework.web: DEBUG\r\n\r\ncauses all HTTP requests to be logged, which is cool!\r\n\r\nHowever, as the /health endpoint is continuously polled, this spams the logfile.\r\nHow can I disable request logging just for this endpoint?","title":"How to exclude certain HTTP requests from being logged in Java Spring (e.g. /health Endpoint)","body":"<p>In my Spring boot application the following setting:</p>\n<pre><code>logging.org.springframework.web: DEBUG\n</code></pre>\n<p>causes all HTTP requests to be logged, which is cool!</p>\n<p>However, as the /health endpoint is continuously polled, this spams the logfile.\nHow can I disable request logging just for this endpoint?</p>\n"},{"tags":["java","instance-variables"],"comments":[{"owner":{"account_id":4291034,"reputation":452,"user_id":8244977,"display_name":"BingLi224"},"score":2,"creation_date":1549255766,"post_id":54510263,"comment_id":95823866,"body_markdown":"`&lt;class name&gt;.&lt;instance variable&gt;` is static variable?","body":"<code>&lt;class name&gt;.&lt;instance variable&gt;</code> is static variable?"},{"owner":{"account_id":13737414,"reputation":613,"user_id":10147834,"display_name":"Sara"},"score":0,"creation_date":1549255799,"post_id":54510263,"comment_id":95823873,"body_markdown":"No. These are instance variables","body":"No. These are instance variables"},{"owner":{"account_id":7424117,"reputation":56335,"user_id":5647260,"accept_rate":82,"display_name":"Andrew Li"},"score":1,"creation_date":1549255831,"post_id":54510263,"comment_id":95823877,"body_markdown":"@Sara That makes no sense. Instance variables are associated *with instances*, not the class themselves","body":"@Sara That makes no sense. Instance variables are associated <i>with instances</i>, not the class themselves"},{"owner":{"account_id":13737414,"reputation":613,"user_id":10147834,"display_name":"Sara"},"score":0,"creation_date":1549255835,"post_id":54510263,"comment_id":95823879,"body_markdown":"@BingLi224 no. These are instance variables.","body":"@BingLi224 no. These are instance variables."},{"owner":{"account_id":10661768,"reputation":9328,"user_id":7849549,"accept_rate":44,"display_name":"Shubham Dixit"},"score":1,"creation_date":1549255917,"post_id":54510263,"comment_id":95823896,"body_markdown":"Its better if you post some code??","body":"Its better if you post some code??"},{"owner":{"account_id":89056,"reputation":8068,"user_id":2684196,"accept_rate":80,"display_name":"Willis Blackburn"},"score":0,"creation_date":1549256017,"post_id":54510263,"comment_id":95823917,"body_markdown":"Sure it&#39;s not `&lt;class name&gt;.this.&lt;instance variable&gt;`?","body":"Sure it&#39;s not <code>&lt;class name&gt;.this.&lt;instance variable&gt;</code>?"},{"owner":{"account_id":2673407,"reputation":44640,"user_id":2310289,"display_name":"Scary Wombat"},"score":0,"creation_date":1549256450,"post_id":54510263,"comment_id":95823999,"body_markdown":"*no. These are instance variables.* If you are so adamant, please show your code","body":"<i>no. These are instance variables.</i> If you are so adamant, please show your code"},{"owner":{"account_id":10661768,"reputation":9328,"user_id":7849549,"accept_rate":44,"display_name":"Shubham Dixit"},"score":0,"creation_date":1549256500,"post_id":54510263,"comment_id":95824012,"body_markdown":"your variable might be static.","body":"your variable might be static."}],"answers":[{"tags":[],"owner":{"account_id":11839556,"reputation":1520,"user_id":8663811,"display_name":"Rahul sharma"},"comment_count":0,"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1684828049,"creation_date":1549257890,"answer_id":54510522,"question_id":54510263,"body_markdown":"You have to make that variable or method static then you can use through class name.\r\n\r\n    public static int a=5;\r\n    /*declaring static variable*/\r\n\r\n \r\n\r\n      System.out.println(classname.a);\r\n      /*calling static variable*/\r\n\r\n","title":"Accessing object variables by class name instead of this","body":"<p>You have to make that variable or method static then you can use through class name.</p>\n<pre><code>public static int a=5;\n/*declaring static variable*/\n\n\n\n  System.out.println(classname.a);\n  /*calling static variable*/\n</code></pre>\n"}],"owner":{"account_id":13737414,"reputation":613,"user_id":10147834,"display_name":"Sara"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":528,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"answer_count":1,"score":-2,"last_activity_date":1684828049,"creation_date":1549255578,"question_id":54510263,"body_markdown":"Usually when there is getter/setter in a POJO class, the general convention I have seen until now was to use `return this.&lt;instance variable&gt;` / `this.&lt;instance variable&gt; = something`\n\nBut, the current project I am working on uses a strange convention of `return &lt;class name&gt;.&lt;instance variable&gt;`\n\nI understand that this works, but was wondering if this is the right approach at all? ","title":"Accessing object variables by class name instead of this","body":"<p>Usually when there is getter/setter in a POJO class, the general convention I have seen until now was to use <code>return this.&lt;instance variable&gt;</code> / <code>this.&lt;instance variable&gt; = something</code></p>\n\n<p>But, the current project I am working on uses a strange convention of <code>return &lt;class name&gt;.&lt;instance variable&gt;</code></p>\n\n<p>I understand that this works, but was wondering if this is the right approach at all? </p>\n"},{"tags":["java","iterator"],"comments":[{"owner":{"account_id":44379,"reputation":14328,"user_id":130224,"accept_rate":84,"display_name":"reprogrammer"},"score":2,"creation_date":1354558810,"post_id":13689288,"comment_id":18794862,"body_markdown":"Why not create a new iterator?","body":"Why not create a new iterator?"},{"owner":{"account_id":940870,"reputation":20212,"user_id":968969,"display_name":"Tony Hopkinson"},"score":1,"creation_date":1354558915,"post_id":13689288,"comment_id":18794902,"body_markdown":"well you&#39;ve missed something, if you need to do more than next and maybe previous, iterator is not the best choice. Why do you need to reset?","body":"well you&#39;ve missed something, if you need to do more than next and maybe previous, iterator is not the best choice. Why do you need to reset?"},{"owner":{"account_id":1512818,"reputation":1873,"user_id":1414499,"accept_rate":89,"display_name":"Krzysztof"},"score":0,"creation_date":1354561117,"post_id":13689288,"comment_id":18795717,"body_markdown":"I trying to understand the idea of dynamic list in java. A few weeks ago I have a problem with session variable on jsp oage. From EL and taglibs I can use a method of iterator but I cant redefine it (I still have poor knowledge about jsp but I still improving it :)) What do You mind when You wrote &quot;iterator is not the best choice&quot; ? Could You explain it to me? :)","body":"I trying to understand the idea of dynamic list in java. A few weeks ago I have a problem with session variable on jsp oage. From EL and taglibs I can use a method of iterator but I cant redefine it (I still have poor knowledge about jsp but I still improving it :)) What do You mind when You wrote &quot;iterator is not the best choice&quot; ? Could You explain it to me? :)"}],"answers":[{"comments":[{"owner":{"account_id":285969,"reputation":12256,"user_id":584947,"accept_rate":92,"display_name":"fIwJlxSzApHEZIl"},"score":3,"creation_date":1416001685,"post_id":13689311,"comment_id":42422974,"body_markdown":"awesome. it&#39;s not immediately obvious that this call doesn&#39;t just return the same reference to the iterator that you&#39;re already using. But I guess looking into the source would&#39;ve solved that answer as well. Here&#39;s a link for anyone curious as this is a habit I&#39;m trying to be better about: http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/ArrayList.java#ArrayList.listIterator%28%29","body":"awesome. it&#39;s not immediately obvious that this call doesn&#39;t just return the same reference to the iterator that you&#39;re already using. But I guess looking into the source would&#39;ve solved that answer as well. Here&#39;s a link for anyone curious as this is a habit I&#39;m trying to be better about: <a href=\"http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/ArrayList.java#ArrayList.listIterator%28%29\" rel=\"nofollow noreferrer\">grepcode.com/file/repository.grepcode.com/java/root/jdk/open&zwnj;&#8203;jdk/&hellip;</a>"}],"tags":[],"owner":{"account_id":262968,"reputation":767160,"user_id":548225,"accept_rate":90,"display_name":"anubhava"},"comment_count":1,"down_vote_count":0,"up_vote_count":65,"is_accepted":false,"score":65,"last_activity_date":1354558852,"creation_date":1354558852,"answer_id":13689311,"question_id":13689288,"body_markdown":"You can call `listIterator` method again to get an instance of iterator pointing at beginning of list:\r\n\r\n    iter = list.listIterator();","title":"java- reset list iterator to first element of the list","body":"<p>You can call <code>listIterator</code> method again to get an instance of iterator pointing at beginning of list:</p>\n\n<pre><code>iter = list.listIterator();\n</code></pre>\n"},{"comments":[{"owner":{"account_id":2349596,"reputation":196,"user_id":2058834,"display_name":"raceworm"},"score":7,"creation_date":1360531535,"post_id":13689355,"comment_id":20732203,"body_markdown":"when deleting and inserting mainly to front then LinkedList is faster.","body":"when deleting and inserting mainly to front then LinkedList is faster."},{"owner":{"account_id":2143607,"reputation":4606,"user_id":1901744,"accept_rate":74,"display_name":"Sohaib"},"score":4,"creation_date":1465804624,"post_id":13689355,"comment_id":63035633,"body_markdown":"Even removing items from the middle is faster in case of LinkedList. That is if you are iterating through and removing items with iterator.remove(). ArrayList would necessitate shifting of the remaining items.","body":"Even removing items from the middle is faster in case of LinkedList. That is if you are iterating through and removing items with iterator.remove(). ArrayList would necessitate shifting of the remaining items."},{"owner":{"account_id":1005212,"reputation":28568,"user_id":1019167,"accept_rate":92,"display_name":"AlexWien"},"score":0,"creation_date":1465828883,"post_id":13689355,"comment_id":63051355,"body_markdown":"@Sohaib, yes mainly it depends on the size of the list. Up to a specific number of elements System.arraycopy, which internal uses C - memcopy  , which is used to shift the array is faster. Advanced implementation switch the underlying implementation depoending on element size.","body":"@Sohaib, yes mainly it depends on the size of the list. Up to a specific number of elements System.arraycopy, which internal uses C - memcopy  , which is used to shift the array is faster. Advanced implementation switch the underlying implementation depoending on element size."}],"tags":[],"owner":{"account_id":1005212,"reputation":28568,"user_id":1019167,"accept_rate":92,"display_name":"AlexWien"},"comment_count":3,"down_vote_count":3,"up_vote_count":29,"is_accepted":true,"score":26,"last_activity_date":1384203283,"creation_date":1354559024,"answer_id":13689355,"question_id":13689288,"body_markdown":"Best would be not using `LinkedList` at all, usually it is slower in all disciplines, and less handy. (When mainly inserting/deleting to the front, especially for big arrays LinkedList is faster)\r\n\r\nUse `ArrayList`, and iterate with \r\n\r\n    int len = list.size();\r\n    for (int i = 0; i &lt; len; i++) {\r\n      Element ele = list.get(i);\r\n    }\r\n\r\nReset is trivial, just loop again.&lt;br&gt;\r\nIf you insist on using an iterator,  then you have to use a new iterator:\r\n\r\n    iter = list.listIterator();\r\n\r\n(I saw only once in my life an advantage of LinkedList: i could loop through whith a while loop and remove the first element)","title":"java- reset list iterator to first element of the list","body":"<p>Best would be not using <code>LinkedList</code> at all, usually it is slower in all disciplines, and less handy. (When mainly inserting/deleting to the front, especially for big arrays LinkedList is faster)</p>\n\n<p>Use <code>ArrayList</code>, and iterate with </p>\n\n<pre><code>int len = list.size();\nfor (int i = 0; i &lt; len; i++) {\n  Element ele = list.get(i);\n}\n</code></pre>\n\n<p>Reset is trivial, just loop again.<br>\nIf you insist on using an iterator,  then you have to use a new iterator:</p>\n\n<pre><code>iter = list.listIterator();\n</code></pre>\n\n<p>(I saw only once in my life an advantage of LinkedList: i could loop through whith a while loop and remove the first element)</p>\n"},{"comments":[{"owner":{"account_id":11434115,"reputation":2221,"user_id":8382028,"display_name":"ViaTech"},"score":0,"creation_date":1524680427,"post_id":27981306,"comment_id":87073963,"body_markdown":"Hmm @ryenus...I like your idea to iterate backwards from the last element using **hasPrevious()** and **previous()** after the &#39;forward&#39; iteration has occurred. That seems like a perfect solution if you need to use the same iterator instance (not sure why you&#39;d actually need need to use the same instance over and over though). I am curious if looping back to the start of the iteration is less expensive than creating a new iterator instance, but I guess that would also be somewhat dependent on the size of the list.","body":"Hmm @ryenus...I like your idea to iterate backwards from the last element using <b>hasPrevious()</b> and <b>previous()</b> after the &#39;forward&#39; iteration has occurred. That seems like a perfect solution if you need to use the same iterator instance (not sure why you&#39;d actually need need to use the same instance over and over though). I am curious if looping back to the start of the iteration is less expensive than creating a new iterator instance, but I guess that would also be somewhat dependent on the size of the list."}],"tags":[],"owner":{"account_id":256670,"reputation":16061,"user_id":537554,"display_name":"ryenus"},"comment_count":1,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1421497976,"creation_date":1421402115,"answer_id":27981306,"question_id":13689288,"body_markdown":"If the order doesn&#39;t matter, we can re-iterate **backward** with the same iterator using the `hasPrevious()` and `previous()` methods:\r\n\r\n&lt;!-- language-all: java --&gt;\r\n\r\n    ListIterator&lt;T&gt; lit = myList.listIterator(); // create just one iterator\r\n\r\nInitially the iterator sits at the beginning, we do *forward* iteration:\r\n\r\n    while (lit.hasNext()) process(lit.next()); // begin -&gt; end\r\n\r\nThen the iterator sits at the end, we can do **backward** iteration:\r\n\r\n    while (lit.hasPrevious()) process2(lit.previous()); // end -&gt; begin\r\n\r\n\r\n","title":"java- reset list iterator to first element of the list","body":"<p>If the order doesn't matter, we can re-iterate <strong>backward</strong> with the same iterator using the <code>hasPrevious()</code> and <code>previous()</code> methods:</p>\n\n\n\n<pre class=\"lang-java prettyprint-override\"><code>ListIterator&lt;T&gt; lit = myList.listIterator(); // create just one iterator\n</code></pre>\n\n<p>Initially the iterator sits at the beginning, we do <em>forward</em> iteration:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>while (lit.hasNext()) process(lit.next()); // begin -&gt; end\n</code></pre>\n\n<p>Then the iterator sits at the end, we can do <strong>backward</strong> iteration:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>while (lit.hasPrevious()) process2(lit.previous()); // end -&gt; begin\n</code></pre>\n"},{"comments":[{"owner":{"account_id":3209105,"reputation":1422,"user_id":2709454,"display_name":"xpusostomos"},"score":1,"creation_date":1641557758,"post_id":28777539,"comment_id":124840715,"body_markdown":"That sounds like a quirk you discovered rather than something guaranteed by the interface.","body":"That sounds like a quirk you discovered rather than something guaranteed by the interface."},{"owner":{"account_id":5535,"reputation":778,"user_id":8960,"accept_rate":78,"display_name":"Geoff Moller"},"score":0,"creation_date":1668717232,"post_id":28777539,"comment_id":131480658,"body_markdown":"&quot;Returns an iterable whose iterators cycle indefinitely over the elements of iterable&quot;\nhttps://guava.dev/releases/20.0-rc1/api/docs/com/google/common/collect/Iterables.html#cycle-java.lang.Iterable-","body":"&quot;Returns an iterable whose iterators cycle indefinitely over the elements of iterable&quot; <a href=\"https://guava.dev/releases/20.0-rc1/api/docs/com/google/common/collect/Iterables.html#cycle-java.lang.Iterable-\" rel=\"nofollow noreferrer\">guava.dev/releases/20.0-rc1/api/docs/com/google/common/colle&zwnj;&#8203;ct/&hellip;</a>"}],"tags":[],"owner":{"account_id":310422,"reputation":485,"user_id":623388,"accept_rate":75,"display_name":"tkane2000"},"comment_count":2,"down_vote_count":0,"up_vote_count":13,"is_accepted":false,"score":13,"last_activity_date":1425091586,"creation_date":1425091586,"answer_id":28777539,"question_id":13689288,"body_markdown":"This is an alternative solution, but one could argue it doesn&#39;t add enough value to make it worth it:\r\n\r\n    import com.google.common.collect.Iterables;\r\n    ...\r\n    Iterator&lt;String&gt; iter = Iterables.cycle(list).iterator();\r\n    if(iter.hasNext()) {\r\n        str = iter.next();\r\n    }\r\n\r\nCalling hasNext() will reset the iterator cursor to the beginning if it&#39;s a the end.\r\n","title":"java- reset list iterator to first element of the list","body":"<p>This is an alternative solution, but one could argue it doesn't add enough value to make it worth it:</p>\n\n<pre><code>import com.google.common.collect.Iterables;\n...\nIterator&lt;String&gt; iter = Iterables.cycle(list).iterator();\nif(iter.hasNext()) {\n    str = iter.next();\n}\n</code></pre>\n\n<p>Calling hasNext() will reset the iterator cursor to the beginning if it's a the end.</p>\n"},{"tags":[],"owner":{"account_id":1710481,"reputation":22873,"user_id":1568658,"accept_rate":82,"display_name":"Eric"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1546158215,"creation_date":1546158215,"answer_id":53976170,"question_id":13689288,"body_markdown":"Calling `iterator()` on a Collection impl, probably would get a new Iterator on each call.\r\n\r\nThus, you can simply call `iterator()` again to get a new one.\r\n\r\n---\r\nCode\r\n---\r\n\r\n**IteratorLearn.java**\r\n\r\n    \r\n    import org.testng.Assert;\r\n    import org.testng.annotations.Test;\r\n    \r\n    import java.util.Collection;\r\n    import java.util.HashSet;\r\n    import java.util.Iterator;\r\n    \r\n    /**\r\n     * Iterator learn.\r\n     *\r\n     * @author eric\r\n     * @date 12/30/18 4:03 PM\r\n     */\r\n    public class IteratorLearn {\r\n        @Test\r\n        public void test() {\r\n            Collection&lt;Integer&gt; c = new HashSet&lt;&gt;();\r\n            for (int i = 0; i &lt; 10; i++) {\r\n                c.add(i);\r\n            }\r\n    \r\n            Iterator it;\r\n    \r\n            // iterate,\r\n            it = c.iterator();\r\n            System.out.println(&quot;\\niterate:&quot;);\r\n            while (it.hasNext()) {\r\n                System.out.printf(&quot;\\t%d\\n&quot;, it.next());\r\n            }\r\n            Assert.assertFalse(it.hasNext());\r\n    \r\n            // consume,\r\n            it = c.iterator();\r\n            System.out.println(&quot;\\nconsume elements:&quot;);\r\n            it.forEachRemaining(ele -&gt; System.out.printf(&quot;\\t%d\\n&quot;, ele));\r\n            Assert.assertFalse(it.hasNext());\r\n        }\r\n    }\r\n\r\n\r\n**Output:**\r\n\r\n    iterate:\r\n        0\r\n        1\r\n        2\r\n        3\r\n        4\r\n        5\r\n        6\r\n        7\r\n        8\r\n        9\r\n\r\n    consume elements:\r\n        0\r\n        1\r\n        2\r\n        3\r\n        4\r\n        5\r\n        6\r\n        7\r\n        8\r\n        9\r\n","title":"java- reset list iterator to first element of the list","body":"<p>Calling <code>iterator()</code> on a Collection impl, probably would get a new Iterator on each call.</p>\n\n<p>Thus, you can simply call <code>iterator()</code> again to get a new one.</p>\n\n<hr>\n\n<h2>Code</h2>\n\n<p><strong>IteratorLearn.java</strong></p>\n\n<pre><code>import org.testng.Assert;\nimport org.testng.annotations.Test;\n\nimport java.util.Collection;\nimport java.util.HashSet;\nimport java.util.Iterator;\n\n/**\n * Iterator learn.\n *\n * @author eric\n * @date 12/30/18 4:03 PM\n */\npublic class IteratorLearn {\n    @Test\n    public void test() {\n        Collection&lt;Integer&gt; c = new HashSet&lt;&gt;();\n        for (int i = 0; i &lt; 10; i++) {\n            c.add(i);\n        }\n\n        Iterator it;\n\n        // iterate,\n        it = c.iterator();\n        System.out.println(\"\\niterate:\");\n        while (it.hasNext()) {\n            System.out.printf(\"\\t%d\\n\", it.next());\n        }\n        Assert.assertFalse(it.hasNext());\n\n        // consume,\n        it = c.iterator();\n        System.out.println(\"\\nconsume elements:\");\n        it.forEachRemaining(ele -&gt; System.out.printf(\"\\t%d\\n\", ele));\n        Assert.assertFalse(it.hasNext());\n    }\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>iterate:\n    0\n    1\n    2\n    3\n    4\n    5\n    6\n    7\n    8\n    9\n\nconsume elements:\n    0\n    1\n    2\n    3\n    4\n    5\n    6\n    7\n    8\n    9\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2485164,"reputation":2314,"user_id":2163727,"accept_rate":80,"display_name":"MasterHD"},"comment_count":0,"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1567446694,"creation_date":1562068988,"answer_id":56852039,"question_id":13689288,"body_markdown":"What you may actually want to use is an `Iterable` that can return a fresh `Iterator` multiple times by calling `iterator()`.\r\n\r\n    //A function that needs to iterate multiple times can be given one Iterable:\r\n    public void func(Iterable&lt;Type&gt; ible) {\r\n\t\tIterator&lt;Type&gt; it = ible.iterator(); //Gets an iterator\r\n\t\twhile (it.hasNext()) {\r\n\t\t\tit.next();\r\n        }\r\n        it = ible.iterator(); //Gets a NEW iterator, also from the beginning\r\n\t\twhile (it.hasNext()) {\r\n\t\t\tit.next();\r\n        }\r\n    }\r\n\r\nYou must define what the `iterator()` method does just once beforehand:\r\n\r\n    void main() {\r\n        LinkedList&lt;String&gt; list; //This could be any type of object that has an iterator\r\n        //Define an Iterable that knows how to retrieve a fresh iterator\r\n\t\tIterable&lt;Type&gt; ible = new Iterable&lt;Type&gt;() {\r\n            @Override\r\n\t\t    public Iterator&lt;Type&gt; iterator() {\r\n\t\t        return list.listIterator(); //Define how to get a fresh iterator from any object\r\n\t\t    }\r\n\t\t};\r\n        //Now with a single instance of an Iterable,\r\n        func(ible); //you can iterate through it multiple times.\r\n    }","title":"java- reset list iterator to first element of the list","body":"<p>What you may actually want to use is an <code>Iterable</code> that can return a fresh <code>Iterator</code> multiple times by calling <code>iterator()</code>.</p>\n\n<pre><code>//A function that needs to iterate multiple times can be given one Iterable:\npublic void func(Iterable&lt;Type&gt; ible) {\n    Iterator&lt;Type&gt; it = ible.iterator(); //Gets an iterator\n    while (it.hasNext()) {\n        it.next();\n    }\n    it = ible.iterator(); //Gets a NEW iterator, also from the beginning\n    while (it.hasNext()) {\n        it.next();\n    }\n}\n</code></pre>\n\n<p>You must define what the <code>iterator()</code> method does just once beforehand:</p>\n\n<pre><code>void main() {\n    LinkedList&lt;String&gt; list; //This could be any type of object that has an iterator\n    //Define an Iterable that knows how to retrieve a fresh iterator\n    Iterable&lt;Type&gt; ible = new Iterable&lt;Type&gt;() {\n        @Override\n        public Iterator&lt;Type&gt; iterator() {\n            return list.listIterator(); //Define how to get a fresh iterator from any object\n        }\n    };\n    //Now with a single instance of an Iterable,\n    func(ible); //you can iterate through it multiple times.\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":20225378,"reputation":13,"user_id":14833456,"display_name":"Henrique Krever"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1627344904,"creation_date":1627344904,"answer_id":68537581,"question_id":13689288,"body_markdown":"What you can do is, set the iterator to the first position mannualy with a while loop.\r\n\r\n    while(iter.hasPrevious())\r\n    {\r\n        iter.previous();\r\n    }\r\nwhen you get out of the loop you will have your iterator at the position 0\r\n\r\n###### sorry any grammar mistakes ######","title":"java- reset list iterator to first element of the list","body":"<p>What you can do is, set the iterator to the first position mannualy with a while loop.</p>\n<pre><code>while(iter.hasPrevious())\n{\n    iter.previous();\n}\n</code></pre>\n<p>when you get out of the loop you will have your iterator at the position 0</p>\n<h6 id=\"sorry-any-grammar-mistakes-ydm0\">sorry any grammar mistakes</h6>\n"},{"tags":[],"owner":{"account_id":27791953,"reputation":1,"user_id":21218222,"display_name":"Harendra Pratap Singh Sisodia"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1676456110,"creation_date":1676456110,"answer_id":75458265,"question_id":13689288,"body_markdown":"Well some of the version of java does not have a reset method for the iterator, so we are required to use the multiple iterator for number of use cases, which ultimately increases the memory consumption.\r\n\r\nso it&#39;s simple way to use the same iterator again if needed by declaring a global function and pass the collection as argument.\r\n\r\nfor eg.\r\n[enter image description here][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/459UL.jpg\r\n\r\n\r\nfor eg (Written program)\r\npackage com.javalearn;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.Iterator;\r\n\r\npublic class Java_Learn {\r\n\r\n        public static void main(String[] args) {\r\n                ArrayList&lt;String&gt; list = new ArrayList&lt;String&gt;();\r\n                list.add(&quot;Hello&quot;);\r\n                list.add(&quot;World&quot;);\r\n                list.add(&quot;It&#39;s&quot;);\r\n                list.add(&quot;me.&quot;);\r\n\r\n                iter(list);\r\n\r\n                System.out.println(list.size());\r\n                System.out.println(list.indexOf(&quot;me.&quot;));\r\n                System.out.println(list.remove(3));\r\n\r\n                iter(list);\r\n        }\r\n        static void iter(ArrayList&lt;String&gt; arr){\r\n                Iterator itr = arr.iterator();\r\n                while(itr.hasNext()){\r\n                        System.out.println(itr.next());\r\n                }\r\n        }\r\n}\r\n","title":"java- reset list iterator to first element of the list","body":"<p>Well some of the version of java does not have a reset method for the iterator, so we are required to use the multiple iterator for number of use cases, which ultimately increases the memory consumption.</p>\n<p>so it's simple way to use the same iterator again if needed by declaring a global function and pass the collection as argument.</p>\n<p>for eg.\n<a href=\"https://i.stack.imgur.com/459UL.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n<p>for eg (Written program)\npackage com.javalearn;</p>\n<p>import java.util.ArrayList;\nimport java.util.Iterator;</p>\n<p>public class Java_Learn {</p>\n<pre><code>    public static void main(String[] args) {\n            ArrayList&lt;String&gt; list = new ArrayList&lt;String&gt;();\n            list.add(&quot;Hello&quot;);\n            list.add(&quot;World&quot;);\n            list.add(&quot;It's&quot;);\n            list.add(&quot;me.&quot;);\n\n            iter(list);\n\n            System.out.println(list.size());\n            System.out.println(list.indexOf(&quot;me.&quot;));\n            System.out.println(list.remove(3));\n\n            iter(list);\n    }\n    static void iter(ArrayList&lt;String&gt; arr){\n            Iterator itr = arr.iterator();\n            while(itr.hasNext()){\n                    System.out.println(itr.next());\n            }\n    }\n</code></pre>\n<p>}</p>\n"}],"owner":{"account_id":1512818,"reputation":1873,"user_id":1414499,"accept_rate":89,"display_name":"Krzysztof"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":142343,"favorite_count":0,"down_vote_count":1,"up_vote_count":56,"accepted_answer_id":13689355,"answer_count":8,"score":55,"last_activity_date":1684827818,"creation_date":1354558741,"question_id":13689288,"body_markdown":"I need to know how to &quot;reset&quot; LinkedList iterator to its first element.\r\n\r\nFor example:\r\n\r\n    LinkedList&lt;String&gt; list;\r\n    Iterator iter=list.listIterator;\r\n    iter.next();\r\n    iter.next();\r\n\r\nOver and over again and after many moves of the iterator, I need to &quot;reset&quot; the position of the iterator.\r\n\r\nI want to ask how I can &quot;reset&quot; my iterator to the first element.\r\n\r\nI know that I can get list iterator of the first element in this way:\r\n\r\n    iter= list.listIterator(1);\r\n\r\nIs this the best solution? Or maybe I missed something in Oracle docs? \r\n\r\n \r\n\r\n","title":"java- reset list iterator to first element of the list","body":"<p>I need to know how to &quot;reset&quot; LinkedList iterator to its first element.</p>\n<p>For example:</p>\n<pre><code>LinkedList&lt;String&gt; list;\nIterator iter=list.listIterator;\niter.next();\niter.next();\n</code></pre>\n<p>Over and over again and after many moves of the iterator, I need to &quot;reset&quot; the position of the iterator.</p>\n<p>I want to ask how I can &quot;reset&quot; my iterator to the first element.</p>\n<p>I know that I can get list iterator of the first element in this way:</p>\n<pre><code>iter= list.listIterator(1);\n</code></pre>\n<p>Is this the best solution? Or maybe I missed something in Oracle docs?</p>\n"},{"tags":["java","profiler","yourkit"],"comments":[{"owner":{"account_id":5998820,"reputation":12676,"user_id":4712734,"display_name":"DuncG"},"score":0,"creation_date":1684777398,"post_id":76307975,"comment_id":134563305,"body_markdown":"By the way: both methods you list are instance methods - `&quot;abca&quot;.lastIndexOf(&#39;a&#39;)` is 3. Perhaps base your checks on something like &quot;String.format()&quot; which is static.","body":"By the way: both methods you list are instance methods - <code>&quot;abca&quot;.lastIndexOf(&#39;a&#39;)</code> is 3. Perhaps base your checks on something like &quot;String.format()&quot; which is static."}],"owner":{"account_id":14429973,"reputation":2483,"user_id":10423604,"display_name":"Volodya Lombrozo"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":53,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1684827748,"creation_date":1684771061,"question_id":76307975,"body_markdown":"I&#39;m currently using YourKit Java Profiler to gather information about the total number of invoked methods during profiling. However, I&#39;m facing difficulty in distinguishing between static methods and instance methods.\r\n\r\nWhen I perform [CPU profiling (tracing)](https://www.yourkit.com/docs/java/help/tracing.jsp), I obtain a list of methods, but there seems to be no apparent way to identify whether a method is static or instance-based. For instance, here are two sample entries from the method list:\r\n\r\n- Instance `java.lang.String.charAt(int) String.java`\r\n- Static `java.lang.String.lastIndexOf(byte[], byte, int, String, int) String.java`\r\n\r\nBoth methods appear identical and lack any indication of their type (static or instance). I have extensively searched through the official documentation provided by YourKit, but have been unable to find any relevant information on this matter.\r\n\r\nIs it possible to differentiate between static and instance methods during profiling using YourKit? If so, what approach or feature should I utilize to achieve this? I would greatly appreciate any insights or guidance regarding this issue.","title":"How to differentiate between static and instance methods using YourKit Java Profiler?","body":"<p>I'm currently using YourKit Java Profiler to gather information about the total number of invoked methods during profiling. However, I'm facing difficulty in distinguishing between static methods and instance methods.</p>\n<p>When I perform <a href=\"https://www.yourkit.com/docs/java/help/tracing.jsp\" rel=\"nofollow noreferrer\">CPU profiling (tracing)</a>, I obtain a list of methods, but there seems to be no apparent way to identify whether a method is static or instance-based. For instance, here are two sample entries from the method list:</p>\n<ul>\n<li>Instance <code>java.lang.String.charAt(int) String.java</code></li>\n<li>Static <code>java.lang.String.lastIndexOf(byte[], byte, int, String, int) String.java</code></li>\n</ul>\n<p>Both methods appear identical and lack any indication of their type (static or instance). I have extensively searched through the official documentation provided by YourKit, but have been unable to find any relevant information on this matter.</p>\n<p>Is it possible to differentiate between static and instance methods during profiling using YourKit? If so, what approach or feature should I utilize to achieve this? I would greatly appreciate any insights or guidance regarding this issue.</p>\n"},{"tags":["java","android","json","instagram","instagram-api"],"answers":[{"comments":[{"owner":{"account_id":13467879,"reputation":360,"user_id":9717489,"display_name":"Yash Arora"},"score":0,"creation_date":1525008055,"post_id":50087005,"comment_id":87189754,"body_markdown":"And how to get user id from User Name ?","body":"And how to get user id from User Name ?"},{"owner":{"account_id":7096830,"reputation":3555,"user_id":5430055,"display_name":"Ishara Madhawa"},"score":0,"creation_date":1525008468,"post_id":50087005,"comment_id":87189901,"body_markdown":"Easily Get USER ID and User Details using this: \n\n`https://api.instagram.com/v1/users/search?q=[ USER NAME ]&amp;client_id=[ YOU APP Client ID ]` for an example :\n\n\n\n`https://api.instagram.com/v1/users/search?q=isharamadhawa&amp;client_id=[enter your id]`","body":"Easily Get USER ID and User Details using this:   <code>https:&#47;&#47;api.instagram.com&#47;v1&#47;users&#47;search?q=[ USER NAME ]&amp;client_id=[ YOU APP Client ID ]</code> for an example :    <code>https:&#47;&#47;api.instagram.com&#47;v1&#47;users&#47;search?q=isharamadhawa&amp;cl&zwnj;&#8203;ient_id=[enter your id]</code>"},{"owner":{"account_id":7096830,"reputation":3555,"user_id":5430055,"display_name":"Ishara Madhawa"},"score":0,"creation_date":1525011763,"post_id":50087005,"comment_id":87190943,"body_markdown":"Do you have a client_id?","body":"Do you have a client_id?"},{"owner":{"account_id":13467879,"reputation":360,"user_id":9717489,"display_name":"Yash Arora"},"score":0,"creation_date":1525011869,"post_id":50087005,"comment_id":87190976,"body_markdown":"Yes I have Client ID and Access Tocken","body":"Yes I have Client ID and Access Tocken"},{"owner":{"account_id":13467879,"reputation":360,"user_id":9717489,"display_name":"Yash Arora"},"score":0,"creation_date":1525011976,"post_id":50087005,"comment_id":87191007,"body_markdown":"&quot;error_message&quot;: &quot;The access_token provided is invalid.&quot;","body":"&quot;error_message&quot;: &quot;The access_token provided is invalid.&quot;"},{"owner":{"account_id":7096830,"reputation":3555,"user_id":5430055,"display_name":"Ishara Madhawa"},"score":0,"creation_date":1525012284,"post_id":50087005,"comment_id":87191120,"body_markdown":"Check [this](https://stackoverflow.com/questions/37609974/instagram-api-the-access-token-provided-is-invalid)","body":"Check <a href=\"https://stackoverflow.com/questions/37609974/instagram-api-the-access-token-provided-is-invalid\">this</a>"},{"owner":{"account_id":13467879,"reputation":360,"user_id":9717489,"display_name":"Yash Arora"},"score":0,"creation_date":1525012530,"post_id":50087005,"comment_id":87191202,"body_markdown":"I have added public content scope while getting token and its in Sandbox mode","body":"I have added public content scope while getting token and its in Sandbox mode"},{"owner":{"account_id":7096830,"reputation":3555,"user_id":5430055,"display_name":"Ishara Madhawa"},"score":1,"creation_date":1525012788,"post_id":50087005,"comment_id":87191280,"body_markdown":"You should post another Question regarding your specific issue. I think you have received an answer for what you have posted here.","body":"You should post another Question regarding your specific issue. I think you have received an answer for what you have posted here."},{"owner":{"account_id":14333478,"reputation":281,"user_id":10353652,"display_name":"Vikas chhabra"},"score":0,"creation_date":1629317908,"post_id":50087005,"comment_id":121658277,"body_markdown":"Blocked by cors","body":"Blocked by cors"},{"owner":{"account_id":393857,"reputation":5191,"user_id":755934,"accept_rate":73,"display_name":"Daniel Kats"},"score":1,"creation_date":1631304814,"post_id":50087005,"comment_id":122195402,"body_markdown":"@IsharaMadhawa This answer is no longer accurate since this API no longer provides `full_name` or `profile_picture` fields as per https://developers.facebook.com/docs/instagram-basic-display-api/reference/user. The link to the API in the answer is also dead.","body":"@IsharaMadhawa This answer is no longer accurate since this API no longer provides <code>full_name</code> or <code>profile_picture</code> fields as per <a href=\"https://developers.facebook.com/docs/instagram-basic-display-api/reference/user\" rel=\"nofollow noreferrer\">developers.facebook.com/docs/instagram-basic-display-api/&hellip;</a>. The link to the API in the answer is also dead."}],"tags":[],"owner":{"account_id":7096830,"reputation":3555,"user_id":5430055,"display_name":"Ishara Madhawa"},"comment_count":10,"down_vote_count":2,"up_vote_count":2,"is_accepted":false,"score":0,"last_activity_date":1525007917,"creation_date":1525007917,"answer_id":50087005,"question_id":50086945,"body_markdown":"Using the [Instagram API users endpoint][1] (`https://api.instagram.com/v1/users/{user-id}/?access_token=ACCESS-TOKEN` ) you will receive a response like this one:\r\n\r\n    {\r\n        &quot;data&quot;: {\r\n            &quot;id&quot;: &quot;1574083&quot;,\r\n            &quot;username&quot;: &quot;snoopdogg&quot;,\r\n            &quot;full_name&quot;: &quot;Snoop Dogg&quot;,\r\n            &quot;profile_picture&quot;: &quot;http://distillery.s3.amazonaws.com/profiles/profile_1574083_75sq_1295469061.jpg&quot;,\r\n            &quot;bio&quot;: &quot;This is my bio&quot;,\r\n            &quot;website&quot;: &quot;http://snoopdogg.com&quot;,\r\n            &quot;counts&quot;: {\r\n                &quot;media&quot;: 1320,\r\n                &quot;follows&quot;: 420,\r\n                &quot;followed_by&quot;: 3410\r\n            }\r\n    }\r\n\r\n\r\nUsing this you can get the profile picture.\r\n  [1]: https://instagram.com/developer/endpoints/users/#get_users\r\n","title":"How to get Instagram Profile Picture?","body":"<p>Using the <a href=\"https://instagram.com/developer/endpoints/users/#get_users\" rel=\"nofollow noreferrer\">Instagram API users endpoint</a> (<code>https://api.instagram.com/v1/users/{user-id}/?access_token=ACCESS-TOKEN</code> ) you will receive a response like this one:</p>\n\n<pre><code>{\n    \"data\": {\n        \"id\": \"1574083\",\n        \"username\": \"snoopdogg\",\n        \"full_name\": \"Snoop Dogg\",\n        \"profile_picture\": \"http://distillery.s3.amazonaws.com/profiles/profile_1574083_75sq_1295469061.jpg\",\n        \"bio\": \"This is my bio\",\n        \"website\": \"http://snoopdogg.com\",\n        \"counts\": {\n            \"media\": 1320,\n            \"follows\": 420,\n            \"followed_by\": 3410\n        }\n}\n</code></pre>\n\n<p>Using this you can get the profile picture.</p>\n"},{"comments":[{"owner":{"account_id":18036463,"reputation":466,"user_id":13109762,"display_name":"Shrijan Regmi"},"score":2,"creation_date":1621777184,"post_id":57329107,"comment_id":119592414,"body_markdown":"It is not giving me data if I am not logged into Instagram","body":"It is not giving me data if I am not logged into Instagram"},{"owner":{"account_id":10148917,"reputation":2458,"user_id":7496198,"display_name":"Chhaileng"},"score":0,"creation_date":1621780401,"post_id":57329107,"comment_id":119593347,"body_markdown":"@ShrijanRegmi sometimes you need to specify some headers like User-Agent. Eg. `curl -s -H &#39;User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 12_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 Instagram 105.0.0.11.118 (iPhone11,8; iOS 12_3_1; en_US; en-US; scale=2.00; 828x1792; 165586599)&#39; &#39;https://www.instagram.com/USERNAME/?__a=1&#39;`","body":"@ShrijanRegmi sometimes you need to specify some headers like User-Agent. Eg. <code>curl -s -H &#39;User-Agent: Mozilla&#47;5.0 (iPhone; CPU iPhone OS 12_3_1 like Mac OS X) AppleWebKit&#47;605.1.15 (KHTML, like Gecko) Mobile&#47;15E148 Instagram 105.0.0.11.118 (iPhone11,8; iOS 12_3_1; en_US; en-US; scale=2.00; 828x1792; 165586599)&#39; &#39;https:&#47;&#47;www.instagram.com&#47;USERNAME&#47;?__a=1&#39;</code>"},{"owner":{"account_id":393857,"reputation":5191,"user_id":755934,"accept_rate":73,"display_name":"Daniel Kats"},"score":1,"creation_date":1631304477,"post_id":57329107,"comment_id":122195309,"body_markdown":"Neither of these appear to work anymore as of Sep 10, 2021. Perhaps instructions are missing from the answer but more likely instagram has disallowed these APIs","body":"Neither of these appear to work anymore as of Sep 10, 2021. Perhaps instructions are missing from the answer but more likely instagram has disallowed these APIs"},{"owner":{"account_id":13155771,"reputation":192,"user_id":9502991,"display_name":"Krupali Shingala"},"score":0,"creation_date":1650887744,"post_id":57329107,"comment_id":127221964,"body_markdown":"https://www.instagram.com/USERNAME/?__a=1  This is not working in my app. This link returns as error HTML code,","body":"<a href=\"https://www.instagram.com/USERNAME/?__a=1\" rel=\"nofollow noreferrer\">instagram.com/USERNAME/?__a=1</a>  This is not working in my app. This link returns as error HTML code,"},{"owner":{"account_id":20130445,"reputation":61,"user_id":14762883,"display_name":"unknown989"},"score":3,"creation_date":1654463522,"post_id":57329107,"comment_id":128091608,"body_markdown":"as of recently instagram doesn&#39;t allow the use of the public API, I&#39;ve tried it for multiple times all it returns is a redirect to the actual profile","body":"as of recently instagram doesn&#39;t allow the use of the public API, I&#39;ve tried it for multiple times all it returns is a redirect to the actual profile"},{"owner":{"account_id":16282725,"reputation":2256,"user_id":11758183,"display_name":"Vikrant Bhat"},"score":1,"creation_date":1680712517,"post_id":57329107,"comment_id":133946019,"body_markdown":"use https://www.instagram.com/&lt;insta-username&gt;/?__a=1&amp;__d=1, it should work.","body":"use <a href=\"https://www.instagram.com/&lt;insta-username&gt;/?__a=1&amp;__d=1\" rel=\"nofollow noreferrer\">instagram.com/&lt;insta-username&gt;/?__a=1&amp;__d=1</a>, it should work."},{"owner":{"account_id":15830307,"reputation":1432,"user_id":11421839,"display_name":"Terry Windwalker"},"score":0,"creation_date":1686322795,"post_id":57329107,"comment_id":134787530,"body_markdown":"The currently latest noted answer https://www.instagram.com/USERNAME/?__a=1&amp;__d=1 does not work for me since it blocks my access via server. It seems to be a CORS limit blocking data access from other servers (including Postman).","body":"The currently latest noted answer <a href=\"https://www.instagram.com/USERNAME/?__a=1&amp;__d=1\" rel=\"nofollow noreferrer\">instagram.com/USERNAME/?__a=1&amp;__d=1</a> does not work for me since it blocks my access via server. It seems to be a CORS limit blocking data access from other servers (including Postman)."},{"owner":{"account_id":15830307,"reputation":1432,"user_id":11421839,"display_name":"Terry Windwalker"},"score":0,"creation_date":1686473665,"post_id":57329107,"comment_id":134800925,"body_markdown":"OK, perhaps not CORS but it requires a token. It says `{&quot;message&quot;:&quot;Please wait a few minutes before you try again.&quot;,&quot;require_login&quot;:true,&quot;status&quot;:&quot;fail&quot;}` so probably a valid Instagram access token is required.","body":"OK, perhaps not CORS but it requires a token. It says <code>{&quot;message&quot;:&quot;Please wait a few minutes before you try again.&quot;,&quot;require_login&quot;:true,&quot;status&quot;:&quot;fail&quot;}</code> so probably a valid Instagram access token is required."}],"tags":[],"owner":{"account_id":10148917,"reputation":2458,"user_id":7496198,"display_name":"Chhaileng"},"comment_count":8,"down_vote_count":1,"up_vote_count":50,"is_accepted":false,"score":49,"last_activity_date":1684808967,"creation_date":1564758300,"answer_id":57329107,"question_id":50086945,"body_markdown":"By May 2023, to get Instagram profile URL via API, use this:\r\n\r\n[https://www.instagram.com/USERNAME/?__a=1&amp;__d=1][1]\r\n\r\n\r\n  [1]: https://www.instagram.com/USERNAME/?__a=1&amp;__d=1","title":"How to get Instagram Profile Picture?","body":"<p>By May 2023, to get Instagram profile URL via API, use this:</p>\n<p><a href=\"https://www.instagram.com/USERNAME/?__a=1&amp;__d=1\" rel=\"noreferrer\">https://www.instagram.com/USERNAME/?__a=1&amp;__d=1</a></p>\n"},{"comments":[{"owner":{"account_id":931209,"reputation":1170,"user_id":961064,"accept_rate":75,"display_name":"Olav Kokovkin"},"score":2,"creation_date":1575936769,"post_id":57668576,"comment_id":104726016,"body_markdown":"Question was tagged with Java and Android, this is HTML and Javascript","body":"Question was tagged with Java and Android, this is HTML and Javascript"},{"owner":{"account_id":5945872,"reputation":648,"user_id":4675392,"accept_rate":36,"display_name":"Rohit Nair"},"score":4,"creation_date":1619521863,"post_id":57668576,"comment_id":118925287,"body_markdown":"This won&#39;t work because of CORS issue.","body":"This won&#39;t work because of CORS issue."},{"owner":{"account_id":18036463,"reputation":466,"user_id":13109762,"display_name":"Shrijan Regmi"},"score":2,"creation_date":1621777221,"post_id":57668576,"comment_id":119592432,"body_markdown":"It is not giving me data if I am not logged into Instagram","body":"It is not giving me data if I am not logged into Instagram"}],"tags":[],"owner":{"account_id":7302345,"reputation":165,"user_id":5564584,"display_name":"Rodrigo Vieira"},"comment_count":3,"down_vote_count":3,"up_vote_count":17,"is_accepted":false,"score":14,"last_activity_date":1566886802,"creation_date":1566886323,"answer_id":57668576,"question_id":50086945,"body_markdown":"To get profile photo, use the function bellow:\r\n   \r\n\r\n&lt;!-- begin snippet: js hide: false console: true babel: false --&gt;\r\n\r\n&lt;!-- language: lang-js --&gt;\r\n\r\n    function getPhoto(a) {\r\n      \r\n      // validation for instagram usernames\r\n      var regex = new RegExp(/^(?!.*\\.\\.)(?!.*\\.$)[^\\W][\\w.]{0,29}$/);\r\n      var validation = regex.test(a);\r\n\r\n      if(validation) {\r\n      \r\n        $.get(&quot;https://www.instagram.com/&quot;+a+&quot;/?__a=1&quot;)\r\n        .done(function(data) { \r\n\r\n          // getting the url\r\n          var photoURL = data[&quot;graphql&quot;][&quot;user&quot;][&quot;profile_pic_url_hd&quot;];\r\n\r\n          // update img element\r\n          $(&quot;#photoReturn&quot;).attr(&quot;src&quot;,photoURL)\r\n         \r\n         })\r\n        .fail(function() { \r\n          // code for 404 error \r\n          alert(&#39;Username was not found!&#39;)\r\n        })\r\n      \r\n      } else {\r\n      \r\n        alert(&#39;The username is invalid!&#39;)\r\n      }\r\n\r\n    }\r\n\r\n        \r\n\r\n&lt;!-- language: lang-html --&gt;\r\n\r\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js&quot;&gt;&lt;/script&gt;\r\n\r\n    &lt;img src=&quot;&quot; id=&quot;photoReturn&quot;&gt;\r\n\r\n    &lt;br&gt;&lt;br&gt;\r\n\r\n    &lt;input type=&quot;text&quot; id=&quot;usernameInput&quot;&gt;\r\n\r\n    &lt;button onclick=&quot;getPhoto($(&#39;#usernameInput&#39;).val().trim())&quot;&gt;Get profile photo&lt;/button&gt;\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\n","title":"How to get Instagram Profile Picture?","body":"<p>To get profile photo, use the function bellow:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function getPhoto(a) {\r\n  \r\n  // validation for instagram usernames\r\n  var regex = new RegExp(/^(?!.*\\.\\.)(?!.*\\.$)[^\\W][\\w.]{0,29}$/);\r\n  var validation = regex.test(a);\r\n\r\n  if(validation) {\r\n  \r\n    $.get(\"https://www.instagram.com/\"+a+\"/?__a=1\")\r\n    .done(function(data) { \r\n\r\n      // getting the url\r\n      var photoURL = data[\"graphql\"][\"user\"][\"profile_pic_url_hd\"];\r\n\r\n      // update img element\r\n      $(\"#photoReturn\").attr(\"src\",photoURL)\r\n     \r\n     })\r\n    .fail(function() { \r\n      // code for 404 error \r\n      alert('Username was not found!')\r\n    })\r\n  \r\n  } else {\r\n  \r\n    alert('The username is invalid!')\r\n  }\r\n\r\n}\r\n\r\n    </code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js\"&gt;&lt;/script&gt;\r\n\r\n&lt;img src=\"\" id=\"photoReturn\"&gt;\r\n\r\n&lt;br&gt;&lt;br&gt;\r\n\r\n&lt;input type=\"text\" id=\"usernameInput\"&gt;\r\n\r\n&lt;button onclick=\"getPhoto($('#usernameInput').val().trim())\"&gt;Get profile photo&lt;/button&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}],"owner":{"account_id":13467879,"reputation":360,"user_id":9717489,"display_name":"Yash Arora"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":52558,"favorite_count":0,"down_vote_count":2,"up_vote_count":29,"closed_date":1587198951,"answer_count":3,"score":27,"last_activity_date":1684827391,"creation_date":1525007521,"question_id":50086945,"body_markdown":"How to extract Instagram Profile picture using instagram API in android ?\r\nOr any other Method To extract Insta Profile Picture?\r\n ","title":"How to get Instagram Profile Picture?","body":"<p>How to extract Instagram Profile picture using instagram API in android ?\nOr any other Method To extract Insta Profile Picture?</p>\n"},{"tags":["java","graph-databases"],"comments":[{"owner":{"account_id":3391382,"reputation":3687,"user_id":2846138,"display_name":"cyberbrain"},"score":0,"creation_date":1684825834,"post_id":76311950,"comment_id":134569504,"body_markdown":"How an object is written is totally depending on it&#39;s `toString` implementation in your code, so in your case on the implementation of whatever `Object` is returned from your `GremlinResultSet`. As we don&#39;t see any implementation of parsing here, I can&#39;t tell if it&#39;s from the parsing part or from the output part.","body":"How an object is written is totally depending on it&#39;s <code>toString</code> implementation in your code, so in your case on the implementation of whatever <code>Object</code> is returned from your <code>GremlinResultSet</code>. As we don&#39;t see any implementation of parsing here, I can&#39;t tell if it&#39;s from the parsing part or from the output part."}],"answers":[{"tags":[],"owner":{"account_id":25445016,"reputation":647,"user_id":19247339,"display_name":"CreateLink Galaxybase"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1684826312,"creation_date":1684826312,"answer_id":76312171,"question_id":76311950,"body_markdown":"Properties of type double, when written to a file after parsing, will become scientific notation. \r\nThe problem of this scientific notation is that java will automatically convert the data that is too big or too small to scientific notation.It can be solved by BigDecimal class of java.\r\n```\r\nString str=new BigDecimal(num+&quot;&quot;).toString().\r\n```\r\n\r\nFor your case, it can be optimized as follows:\r\n\r\n```\r\n            while (result.hasNext()) {\r\n                Object[] values = result.next();\r\n                for (int i = 0; i &lt; values.length; i++) {\r\n                    Object value = values[i];\r\n                    if (value instanceof Double) {\r\n                        String str = new BigDecimal(Double.toString((Double)value)).toString();\r\n                        fw.write(str);\r\n                    } else {\r\n                        fw.write(value.toString());\r\n                    }\r\n                    if (i &lt; values.length - 1) {\r\n                        fw.write(&quot;,&quot;);\r\n                    }\r\n                }\r\n                fw.write(&quot;\\n&quot;);\r\n            }\r\n```\r\n\r\n","title":"Why do property values appear in scientific notation when parsing and writing results after executing queries on Galaxybase with Java?","body":"<p>Properties of type double, when written to a file after parsing, will become scientific notation.\nThe problem of this scientific notation is that java will automatically convert the data that is too big or too small to scientific notation.It can be solved by BigDecimal class of java.</p>\n<pre><code>String str=new BigDecimal(num+&quot;&quot;).toString().\n</code></pre>\n<p>For your case, it can be optimized as follows:</p>\n<pre><code>            while (result.hasNext()) {\n                Object[] values = result.next();\n                for (int i = 0; i &lt; values.length; i++) {\n                    Object value = values[i];\n                    if (value instanceof Double) {\n                        String str = new BigDecimal(Double.toString((Double)value)).toString();\n                        fw.write(str);\n                    } else {\n                        fw.write(value.toString());\n                    }\n                    if (i &lt; values.length - 1) {\n                        fw.write(&quot;,&quot;);\n                    }\n                }\n                fw.write(&quot;\\n&quot;);\n            }\n</code></pre>\n"}],"owner":{"account_id":25445016,"reputation":647,"user_id":19247339,"display_name":"CreateLink Galaxybase"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":26,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76312171,"answer_count":1,"score":0,"last_activity_date":1684826312,"creation_date":1684824368,"question_id":76311950,"body_markdown":"Why do property values appear in scientific notation when parsing and writing the results returned to the client after executing algorithm queries in Java on Galaxybase? \r\n\r\nHere is the code I wrote：\r\n\r\n```\r\npublic class Test {\r\n    public static void main(String[] args) throws IOException {\r\n        GalaxyBaseClient client = new GalaxyBaseClient(&quot;localhost&quot;, 8180);\r\n\r\n        String query = &quot;g.V().hasLabel(&#39;person&#39;).has(&#39;age&#39;, gt(20)).values(&#39;name&#39;, &#39;age&#39;)&quot;;\r\n        GremlinResultSet result = client.submit(query);\r\n\r\n        FileWriter fw = null;\r\n        try {\r\n            fw = new FileWriter(&quot;test.csv&quot;);\r\n\r\n            String[] columnNames = {&quot;name&quot;, &quot;age&quot;};\r\n            for (int i = 0; i &lt; columnNames.length; i++) {\r\n                fw.write(columnNames[i]);\r\n                if (i &lt; columnNames.length - 1) {\r\n                    fw.write(&quot;,&quot;);\r\n                }\r\n            }\r\n            fw.write(&quot;\\n&quot;);\r\n\r\n            while (result.hasNext()) {\r\n                Object[] values = result.next();\r\n                for (int i = 0; i &lt; values.length; i++) {\r\n                    Object value = values[i];\r\n                    fw.write(value.toString());\r\n                    if (i &lt; values.length - 1) {\r\n                        fw.write(&quot;,&quot;);\r\n                    }\r\n                }\r\n                fw.write(&quot;\\n&quot;);\r\n            }\r\n\r\n        } catch (IOException e) {\r\n            e.printStackTrace();\r\n        } finally {\r\n            if (fw != null) {\r\n                fw.close();\r\n            }\r\n            result.close();\r\n            client.close();\r\n        }\r\n    }\r\n}\r\n```\r\n","title":"Why do property values appear in scientific notation when parsing and writing results after executing queries on Galaxybase with Java?","body":"<p>Why do property values appear in scientific notation when parsing and writing the results returned to the client after executing algorithm queries in Java on Galaxybase?</p>\n<p>Here is the code I wrote：</p>\n<pre><code>public class Test {\n    public static void main(String[] args) throws IOException {\n        GalaxyBaseClient client = new GalaxyBaseClient(&quot;localhost&quot;, 8180);\n\n        String query = &quot;g.V().hasLabel('person').has('age', gt(20)).values('name', 'age')&quot;;\n        GremlinResultSet result = client.submit(query);\n\n        FileWriter fw = null;\n        try {\n            fw = new FileWriter(&quot;test.csv&quot;);\n\n            String[] columnNames = {&quot;name&quot;, &quot;age&quot;};\n            for (int i = 0; i &lt; columnNames.length; i++) {\n                fw.write(columnNames[i]);\n                if (i &lt; columnNames.length - 1) {\n                    fw.write(&quot;,&quot;);\n                }\n            }\n            fw.write(&quot;\\n&quot;);\n\n            while (result.hasNext()) {\n                Object[] values = result.next();\n                for (int i = 0; i &lt; values.length; i++) {\n                    Object value = values[i];\n                    fw.write(value.toString());\n                    if (i &lt; values.length - 1) {\n                        fw.write(&quot;,&quot;);\n                    }\n                }\n                fw.write(&quot;\\n&quot;);\n            }\n\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            if (fw != null) {\n                fw.close();\n            }\n            result.close();\n            client.close();\n        }\n    }\n}\n</code></pre>\n"},{"tags":["java","android","parallel-processing"],"answers":[{"tags":[],"owner":{"account_id":25155166,"reputation":864,"user_id":19000086,"display_name":"zaid khan"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1684826241,"creation_date":1684826241,"answer_id":76312165,"question_id":76309952,"body_markdown":"In Java, you can execute the three functions in parallel using threads or the Executor framework.  Here is an example of ExecutorService\r\n\r\n```\r\n // Create an ExecutorService with a fixed number of threads\r\n ExecutorService executorService = Executors.newFixedThreadPool(3);\r\n\r\n       // Create the tasks\r\n        Callable&lt;List&lt;Integer&gt;&gt; task1 = () -&gt; function1();\r\n        Callable&lt;List&lt;Integer&gt;&gt; task2 = () -&gt; function2();\r\n        Callable&lt;List&lt;Integer&gt;&gt; task3 = () -&gt; function3();\r\n\r\n        // Submit the tasks to the executor\r\n        Future&lt;List&lt;Integer&gt;&gt; result1 = executorService.submit(task1);\r\n        Future&lt;List&lt;Integer&gt;&gt; result2 = executorService.submit(task2);\r\n        Future&lt;List&lt;Integer&gt;&gt; result3 = executorService.submit(task3);\r\n\r\n\r\n           // Retrieve the results asynchronously\r\n        executorService.execute(() -&gt; {\r\n            try {\r\n                List&lt;Integer&gt; resultList1 = result1.get();\r\n                // Process the result of function1\r\n            } catch (Exception e) {\r\n                e.printStackTrace();\r\n            }\r\n        });\r\n\r\n        executorService.execute(() -&gt; {\r\n            try {\r\n                List&lt;Integer&gt; resultList2 = result2.get();\r\n                // Process the result of function2\r\n            } catch (Exception e) {\r\n                e.printStackTrace();\r\n            }\r\n        });\r\n\r\n        executorService.execute(() -&gt; {\r\n            try {\r\n                List&lt;Integer&gt; resultList3 = result3.get();\r\n                // Process the result of function3\r\n            } catch (Exception e) {\r\n                e.printStackTrace();\r\n            }\r\n        });\r\n\r\n        // Shutdown the executor when you&#39;re done\r\n        executorService.shutdown();\r\n}\r\n","title":"Running parallel processes in Android app","body":"<p>In Java, you can execute the three functions in parallel using threads or the Executor framework.  Here is an example of ExecutorService</p>\n<pre><code> // Create an ExecutorService with a fixed number of threads\n ExecutorService executorService = Executors.newFixedThreadPool(3);\n\n       // Create the tasks\n        Callable&lt;List&lt;Integer&gt;&gt; task1 = () -&gt; function1();\n        Callable&lt;List&lt;Integer&gt;&gt; task2 = () -&gt; function2();\n        Callable&lt;List&lt;Integer&gt;&gt; task3 = () -&gt; function3();\n\n        // Submit the tasks to the executor\n        Future&lt;List&lt;Integer&gt;&gt; result1 = executorService.submit(task1);\n        Future&lt;List&lt;Integer&gt;&gt; result2 = executorService.submit(task2);\n        Future&lt;List&lt;Integer&gt;&gt; result3 = executorService.submit(task3);\n\n\n           // Retrieve the results asynchronously\n        executorService.execute(() -&gt; {\n            try {\n                List&lt;Integer&gt; resultList1 = result1.get();\n                // Process the result of function1\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        });\n\n        executorService.execute(() -&gt; {\n            try {\n                List&lt;Integer&gt; resultList2 = result2.get();\n                // Process the result of function2\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        });\n\n        executorService.execute(() -&gt; {\n            try {\n                List&lt;Integer&gt; resultList3 = result3.get();\n                // Process the result of function3\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        });\n\n        // Shutdown the executor when you're done\n        executorService.shutdown();\n}\n</code></pre>\n"}],"owner":{"account_id":11196358,"reputation":77,"user_id":8214882,"display_name":"Mike"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":53,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76312165,"answer_count":1,"score":0,"last_activity_date":1684826241,"creation_date":1684790021,"question_id":76309952,"body_markdown":"I&#39;m new to Android app programming.\r\n\r\nI&#39;m making a native Android app in Java. Inside an Activity, I have some ArrayLists and 3 different functions receiving 2 ArrayLists as parameters and returning an ArrayList based on the content of the 2 parameters. Each function makes different operations and receives different lists as input. Since these 3 functions are independent of each other and since if the 2 ArrayLists are big the execution of these functions can take a while, I would like to execute them in parallel so I don&#39;t wait for the first function to complete in order to launch the second function, etc. \r\n\r\nWhich is the best way to run these functions in parallel and receive their result back in my ViewModel in order to show it in the Activity?","title":"Running parallel processes in Android app","body":"<p>I'm new to Android app programming.</p>\n<p>I'm making a native Android app in Java. Inside an Activity, I have some ArrayLists and 3 different functions receiving 2 ArrayLists as parameters and returning an ArrayList based on the content of the 2 parameters. Each function makes different operations and receives different lists as input. Since these 3 functions are independent of each other and since if the 2 ArrayLists are big the execution of these functions can take a while, I would like to execute them in parallel so I don't wait for the first function to complete in order to launch the second function, etc.</p>\n<p>Which is the best way to run these functions in parallel and receive their result back in my ViewModel in order to show it in the Activity?</p>\n"},{"tags":["java","spring-boot","spring-data-jpa","oracle11g","spring-data-envers"],"comments":[{"owner":{"account_id":2709823,"reputation":10716,"user_id":2338547,"display_name":"markspace"},"score":0,"creation_date":1684697144,"post_id":76301369,"comment_id":134551155,"body_markdown":"What exactly is this type: `Number(10)`.  I&#39;m not an expert in JPA but I don&#39;t see where this comes from.  I see `numeric(p,s)` in the SQL docs but nothing is `Number`.  Being more clear what this is would help here.","body":"What exactly is this type: <code>Number(10)</code>.  I&#39;m not an expert in JPA but I don&#39;t see where this comes from.  I see <code>numeric(p,s)</code> in the SQL docs but nothing is <code>Number</code>.  Being more clear what this is would help here."},{"owner":{"account_id":2712123,"reputation":813,"user_id":2340345,"accept_rate":50,"display_name":"user2340345"},"score":0,"creation_date":1684734981,"post_id":76301369,"comment_id":134554405,"body_markdown":"rev is the column autogenerated in revinfo table from spring data envers, which of type Number(10)","body":"rev is the column autogenerated in revinfo table from spring data envers, which of type Number(10)"},{"owner":{"account_id":3418957,"reputation":1176,"user_id":4029174,"accept_rate":100,"display_name":"bananas"},"score":0,"creation_date":1684736685,"post_id":76301369,"comment_id":134554678,"body_markdown":"did you check in google what Number(10) data type represents in java? You might end up writing converter","body":"did you check in google what Number(10) data type represents in java? You might end up writing converter"},{"owner":{"account_id":2712123,"reputation":813,"user_id":2340345,"accept_rate":50,"display_name":"user2340345"},"score":0,"creation_date":1684738789,"post_id":76301369,"comment_id":134555032,"body_markdown":"at oracle.jdbc.driver.NumberCommonAccessor.throwOverflow(NumberCommonAccessor.java:4139)\n    at oracle.jdbc.driver.NumberCommonAccessor.getInt(NumberCommonAccessor.java:125)\nInteger value is being picked up from Oracle by getInt method, Im not sure which class to extend so that I write the rs.getLong() or rs.getBigInteger().","body":"at oracle.jdbc.driver.NumberCommonAccessor.throwOverflow(Number&zwnj;&#8203;CommonAccessor.java:&zwnj;&#8203;4139)     at oracle.jdbc.driver.NumberCommonAccessor.getInt(NumberCommonA&zwnj;&#8203;ccessor.java:125) Integer value is being picked up from Oracle by getInt method, Im not sure which class to extend so that I write the rs.getLong() or rs.getBigInteger()."}],"answers":[{"comments":[{"owner":{"account_id":2712123,"reputation":813,"user_id":2340345,"accept_rate":50,"display_name":"user2340345"},"score":0,"creation_date":1684753002,"post_id":76304950,"comment_id":134557926,"body_markdown":"Im not defining the audit class, is it auto generated using spring data envers which has the identifer (REV) which it is taking it as int when it should have been long.","body":"Im not defining the audit class, is it auto generated using spring data envers which has the identifer (REV) which it is taking it as int when it should have been long."},{"owner":{"account_id":779805,"reputation":4963,"user_id":836215,"display_name":"ibre5041"},"score":0,"creation_date":1684756339,"post_id":76304950,"comment_id":134558551,"body_markdown":"Hibernate should map Oracle NUMBERs to Java BigDecimal by default. Try to switch the query to `findRevisions(BigDecimal immigrationFileId)`","body":"Hibernate should map Oracle NUMBERs to Java BigDecimal by default. Try to switch the query to <code>findRevisions(BigDecimal immigrationFileId)</code>"},{"owner":{"account_id":2712123,"reputation":813,"user_id":2340345,"accept_rate":50,"display_name":"user2340345"},"score":0,"creation_date":1684758625,"post_id":76304950,"comment_id":134559071,"body_markdown":"I just tried with BigDecimal and it failed with the same exception :(","body":"I just tried with BigDecimal and it failed with the same exception :("}],"tags":[],"owner":{"account_id":779805,"reputation":4963,"user_id":836215,"display_name":"ibre5041"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1684749416,"creation_date":1684749108,"answer_id":76304950,"question_id":76301369,"body_markdown":"Do not use `int` or `long` for identifiers and numbers retrieved from database. Most likely you do not perform any mathematical operations with them anyway.\r\n\r\nOracle stores numbers in decimal format, the corresponding type in Java is `BigDecimal`.\r\n\r\nYour stack trace shows it:\r\n\r\n    at oracle.jdbc.driver.GeneratedResultSet.getInt(GeneratedResultSet.java:556)\r\n    at com.ibm.ws.rsadapter.jdbc.WSJdbcResultSet.getInt(WSJdbcResultSet.java:1089)\r\n\r\nYou&#39;re calling `getInt()` on ResultSet, you should call `getBigDecimal()`","title":"Numeric Overflow exception when calling findRevisions() or even custom audit query - spring-data-jpa with oracle","body":"<p>Do not use <code>int</code> or <code>long</code> for identifiers and numbers retrieved from database. Most likely you do not perform any mathematical operations with them anyway.</p>\n<p>Oracle stores numbers in decimal format, the corresponding type in Java is <code>BigDecimal</code>.</p>\n<p>Your stack trace shows it:</p>\n<pre><code>at oracle.jdbc.driver.GeneratedResultSet.getInt(GeneratedResultSet.java:556)\nat com.ibm.ws.rsadapter.jdbc.WSJdbcResultSet.getInt(WSJdbcResultSet.java:1089)\n</code></pre>\n<p>You're calling <code>getInt()</code> on ResultSet, you should call <code>getBigDecimal()</code></p>\n"},{"tags":[],"owner":{"account_id":5844056,"reputation":141,"user_id":4604665,"display_name":"tausif"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1684823788,"creation_date":1684823788,"answer_id":76311886,"question_id":76301369,"body_markdown":"A revision number(`REV`) value should always be increasing and never overflows.\r\n\r\nThe default implementations provided by Envers use an `int` data type that has an upper bound of `Integer.MAX_VALUE`.\r\n\r\nSince you have already mentioned that your `REV` number has the value of `4686710314` and it exceeds this limit, that&#39;s why you are getting a Numeric Overflow exception.\r\n\r\nTo resolve this issue, you can modify the data type of the `REV` column in the `REVINFO` table to accommodate larger values. But this is not possible in your case as the `REVINFO` is auto-generated. \r\n\r\nSo you should consider using a custom revision entity mapping using a `long` data type.\r\n\r\nBelow is the implementation\r\n\r\n    @Entity\r\n    @Table(name = &quot;REV_INFO&quot;)\r\n    @RevisionEntity\r\n    public  class CustomRevisionEntity implements Serializable {\r\n    \r\n    \tprivate static final long serialVersionUID = 8530213963961662300L;\r\n    \r\n    \t@Id\r\n    \t@GeneratedValue\r\n    \t@RevisionNumber\r\n        @Column(name = &quot;REV&quot;)\r\n    \tprivate long id;\r\n    \r\n    \t@RevisionTimestamp\r\n        @Column(name = &quot;REVTSTMP&quot;)\r\n    \tprivate long timestamp;\r\n    \r\n    \tpublic long getId() {\r\n    \t\treturn id;\r\n    \t}\r\n    \r\n    \tpublic void setId(long id) {\r\n    \t\tthis.id = id;\r\n    \t}\r\n    \r\n    \t@Transient\r\n    \tpublic Date getRevisionDate() {\r\n    \t\treturn new Date( timestamp );\r\n    \t}\r\n    \r\n    \tpublic long getTimestamp() {\r\n    \t\treturn timestamp;\r\n    \t}\r\n    \r\n    \tpublic void setTimestamp(long timestamp) {\r\n    \t\tthis.timestamp = timestamp;\r\n    \t}\r\n    }\r\n\r\n\r\nAnd then `RevisionRepository&lt;ImmigrationFile, Long, Long&gt;`\r\n\r\nNote: Verify the autogenerated `REVINFO` table `REV` column datatype length in Oracle.\r\n\r\n\r\n","title":"Numeric Overflow exception when calling findRevisions() or even custom audit query - spring-data-jpa with oracle","body":"<p>A revision number(<code>REV</code>) value should always be increasing and never overflows.</p>\n<p>The default implementations provided by Envers use an <code>int</code> data type that has an upper bound of <code>Integer.MAX_VALUE</code>.</p>\n<p>Since you have already mentioned that your <code>REV</code> number has the value of <code>4686710314</code> and it exceeds this limit, that's why you are getting a Numeric Overflow exception.</p>\n<p>To resolve this issue, you can modify the data type of the <code>REV</code> column in the <code>REVINFO</code> table to accommodate larger values. But this is not possible in your case as the <code>REVINFO</code> is auto-generated.</p>\n<p>So you should consider using a custom revision entity mapping using a <code>long</code> data type.</p>\n<p>Below is the implementation</p>\n<pre><code>@Entity\n@Table(name = &quot;REV_INFO&quot;)\n@RevisionEntity\npublic  class CustomRevisionEntity implements Serializable {\n\n    private static final long serialVersionUID = 8530213963961662300L;\n\n    @Id\n    @GeneratedValue\n    @RevisionNumber\n    @Column(name = &quot;REV&quot;)\n    private long id;\n\n    @RevisionTimestamp\n    @Column(name = &quot;REVTSTMP&quot;)\n    private long timestamp;\n\n    public long getId() {\n        return id;\n    }\n\n    public void setId(long id) {\n        this.id = id;\n    }\n\n    @Transient\n    public Date getRevisionDate() {\n        return new Date( timestamp );\n    }\n\n    public long getTimestamp() {\n        return timestamp;\n    }\n\n    public void setTimestamp(long timestamp) {\n        this.timestamp = timestamp;\n    }\n}\n</code></pre>\n<p>And then <code>RevisionRepository&lt;ImmigrationFile, Long, Long&gt;</code></p>\n<p>Note: Verify the autogenerated <code>REVINFO</code> table <code>REV</code> column datatype length in Oracle.</p>\n"}],"owner":{"account_id":2712123,"reputation":813,"user_id":2340345,"accept_rate":50,"display_name":"user2340345"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":276,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1684825162,"creation_date":1684693867,"question_id":76301369,"body_markdown":"I&#39;m struggling with exception since the past 4 days and being completely frustrated with it that I&#39;m asking this question, I have referred various answers already on StackoverOverflow but they dont seem to have the issue as mine, so please don&#39;t mark it as duplicate.\r\n\r\nhttps://stackoverflow.com/questions/58570032/hibernate-could-not-fetch-the-sequenceinformation-from-the-database\r\n\r\nI have spring data jpa 2.4.4 version and I&#39;m using spring data envers with spring boot on oracle database, I have ojdbc 7 as a dependency.\r\n\r\nAll my tables are audited using envers and generated automatically by confirguration, so Im facing Numeric overflow exception when Im trying to fetch records whose rev is Number(10), my rev table has 2 columns where rev is a Number(10) digits precision.\r\n\r\nREVINFO table is auto generated by spring data envers and i have not customised it in my code.\r\n\r\n    REVINFO table columns :\r\n    REV            NUMBER(10)\r\n    REVTIMESTAMP   TIMESTAMP\r\n\r\nMain Table - Immigration_file\r\n\r\n    @Entity\r\n    @Audited\r\n    @NoArgsConstructor\r\n    @AllArgsConstructor\r\n    public class ImmigrationFile extends BaseEntity implements ImmigrationFileAware&lt;ImmigrationFile&gt;,Serializable, Cloneable {\r\n    \r\n        @Id\r\n        @SequenceGenerator(name = &quot;IMMIGRATION_FILE_ID_GENERATOR&quot;,\r\n                sequenceName = &quot;SEQ_IMMIGRATION_FILE_ID&quot;,\r\n                allocationSize = 1)\r\n        @GeneratedValue(strategy = GenerationType.AUTO, generator = &quot;IMMIGRATION_FILE_ID_GENERATOR&quot;)\r\n        @Column(name = &quot;ID&quot;, unique = true, nullable = false)\r\n        private Long immigrationFileId;\r\n    \r\n    ...other columns\r\n    }\r\n\r\nAudit table - Immigration_file_hist, having all columns of main table along with REV and REVTYPE, so the error is being thrown when the value of REV is &quot;4686710314&quot;.\r\n\r\nI have tried both the approached of using RevisionRepository and custom Audit Query and I get the same exception with both of them\r\ncode to fetch the revisions of immigration_file_hist repository\r\n\r\n    @Repository\r\n    public interface ImmigrationFileDaoRepository extends RevisionRepository&lt;ImmigrationFile, Long, BigInteger&gt;, JpaRepository&lt;ImmigrationFile, Long&gt; {\r\n    \r\n            Page&lt;Revision&lt;BigInteger, ImmigrationFile&gt;&gt; revisions = immigrationFileDaoRepository.findRevisions(immigrationFile.getImmigrationFileId(), PageRequest.of(Integer.valueOf(startPageIndex), Integer.valueOf(endPageIndex), RevisionSort.desc()));\r\n\r\n\r\nI was using Long earlier and i have changed it to BigInteger and i still face the same issue.\r\n\r\nCustom Audit Query \r\n\r\n    public List&lt;ImmigrationFile&gt; findRevisions(Long immigrationFileId) {\r\n            AuditReader reader = AuditReaderFactory.get(entityManager);\r\n            List&lt;ImmigrationFile&gt; results = reader\r\n                    .createQuery()\r\n                    .forRevisionsOfEntity(ImmigrationFile.class, true, false)\r\n                    .add(AuditEntity.id().eq(immigrationFileId))\r\n                    .addOrder(AuditEntity.property(&quot;version&quot;).desc())\r\n                    .setMaxResults(maxResult)\r\n                    .getResultList();\r\n            return results;\r\n\r\n\r\nIm getting the below exception : \r\n\r\n   \r\n\r\n     Caused by: org.springframework.orm.jpa.JpaSystemException: could not execute query; nested exception is org.hibernate.exception.GenericJDBCException: could not execute query\r\n    \tat org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:331)\r\n    \tat org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)\r\n    \tat org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:548)\r\n    \tat org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)\r\n    \tat org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)\r\n    \tat org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)\r\n    \tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\r\n    \tat org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:174)\r\n    \tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\r\n    \tat org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)\r\n    \tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\r\n    \tat org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)\r\n    \tat com.sun.proxy.$Proxy252.findRevisions(Unknown Source)\r\n    \tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)\r\n    \tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:687)\r\n    \t... 82 common frames omitted\r\n    Caused by: org.hibernate.exception.GenericJDBCException: could not execute query\r\n    \tat org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:47)\r\n    \tat org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)\r\n    \tat org.hibernate.loader.Loader.doList(Loader.java:2853)\r\n    \tat org.hibernate.loader.Loader.doList(Loader.java:2832)\r\n    \tat org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2664)\r\n    \tat org.hibernate.loader.Loader.list(Loader.java:2659)\r\n    \tat org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:506)\r\n    \tat org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)\r\n    \tat org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:219)\r\n    \tat org.hibernate.internal.SessionImpl.list(SessionImpl.java:1414)/\r\n    \tat org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1565)\r\n    \tat org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1533)\r\n    \tat org.hibernate.envers.query.internal.impl.AbstractAuditQuery.buildAndExecuteQuery(AbstractAuditQuery.java:106)\r\n    \tat org.hibernate.envers.query.internal.impl.RevisionsOfEntityQuery.getQueryResults(RevisionsOfEntityQuery.java:173)\r\n    \tat org.hibernate.envers.query.internal.impl.RevisionsOfEntityQuery.list(RevisionsOfEntityQuery.java:136)\r\n    \tat org.hibernate.envers.query.internal.impl.AbstractAuditQuery.getResultList(AbstractAuditQuery.java:112)\r\n    \tat org.springframework.data.envers.repository.support.EnversRevisionRepositoryImpl.findRevisions(EnversRevisionRepositoryImpl.java:155)\r\n    \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n    \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n    \tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n    \tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n    \tat org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:289)\r\n    \tat org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)\r\n    \tat org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)\r\n    \tat org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:524)\r\n    \tat org.springframework.data.repository.core.support.Reposito.ryComposition.invoke(RepositoryComposition.java:285)\r\n    \tat org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:531)\r\n    \tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\r\n    \tat org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:156)\r\n    \tat org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:131)\r\n    \tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\r\n    \tat org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:80)\r\n    \tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\r\n    \tat org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:371)\r\n    \tat org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:134)\r\n    \tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\r\n    \tat org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)\r\n    \t... 97 common frames omitted\r\n    Caused by: java.sql.SQLException: Numeric Overflow\r\n    \tat oracle.jdbc.driver.NumberCommonAccessor.throwOverflow(NumberCommonAccessor.java:4139)\r\n    \tat oracle.jdbc.driver.NumberCommonAccessor.getInt(NumberCommonAccessor.java:125)\r\n    \tat oracle.jdbc.driver.GeneratedStatement.getInt(GeneratedStatement.java:199)\r\n    \tat oracle.jdbc.driver.GeneratedScrollableResultSet.getInt(GeneratedScrollableResultSet.java:246)\r\n    \tat oracle.jdbc.driver.GeneratedResultSet.getInt(GeneratedResultSet.java:556)\r\n    \tat com.ibm.ws.rsadapter.jdbc.WSJdbcResultSet.getInt(WSJdbcResultSet.java:1089)\r\n    \tat org.hibernate.type.descriptor.sql.IntegerTypeDescriptor$2.doExtract(IntegerTypeDescriptor.java:62)\r\n    \tat org.hibernate.type.descriptor.sql.BasicExtractor.extract(BasicExtractor.java:47)\r\n    \tat org.hibernate.type.AbstractStandardBasicType.nullSafeGet(AbstractStandardBasicType.java:257)\r\n    \tat org.hibernate.type.AbstractStandardBasicType.nullSafeGet(AbstractStandardBasicType.java:253)\r\n    \tat org.hibernate.type.AbstractStandardBasicType.nullSafeGet(AbstractStandardBasicType.java:243)\r\n    \tat org.hibernate.type.AbstractStandardBasicType.hydrate(AbstractStandardBasicType.java:329)\r\n    \tat org.hibernate.type.ManyToOneType.hydrate(ManyToOneType.java:184)\r\n    \tat org.hibernate.type.ComponentType.hydrate(ComponentType.java:670)\r\n    \tat org.hibernate.loader.Loader.extractKeysFromResultSet(Loader.java:803)\r\n    \tat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:727)\r\n    \tat org.hibernate.loader.Loader.getRowsFromResultSet(Loader.java:1039)\r\n    \tat org.hibernate.loader.Loader.processResultSet(Loader.java:990)\r\n    \tat org.hibernate.loader.Loader.doQuery(Loader.java:959)\r\n    \tat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:349)\r\n    \tat org.hibernate.loader.Loader.doList(Loader.java:2850)\r\n    \t... 131 common frames omitted\r\n\r\n","title":"Numeric Overflow exception when calling findRevisions() or even custom audit query - spring-data-jpa with oracle","body":"<p>I'm struggling with exception since the past 4 days and being completely frustrated with it that I'm asking this question, I have referred various answers already on StackoverOverflow but they dont seem to have the issue as mine, so please don't mark it as duplicate.</p>\n<p><a href=\"https://stackoverflow.com/questions/58570032/hibernate-could-not-fetch-the-sequenceinformation-from-the-database\">Hibernate could not fetch the SequenceInformation from the database</a></p>\n<p>I have spring data jpa 2.4.4 version and I'm using spring data envers with spring boot on oracle database, I have ojdbc 7 as a dependency.</p>\n<p>All my tables are audited using envers and generated automatically by confirguration, so Im facing Numeric overflow exception when Im trying to fetch records whose rev is Number(10), my rev table has 2 columns where rev is a Number(10) digits precision.</p>\n<p>REVINFO table is auto generated by spring data envers and i have not customised it in my code.</p>\n<pre><code>REVINFO table columns :\nREV            NUMBER(10)\nREVTIMESTAMP   TIMESTAMP\n</code></pre>\n<p>Main Table - Immigration_file</p>\n<pre><code>@Entity\n@Audited\n@NoArgsConstructor\n@AllArgsConstructor\npublic class ImmigrationFile extends BaseEntity implements ImmigrationFileAware&lt;ImmigrationFile&gt;,Serializable, Cloneable {\n\n    @Id\n    @SequenceGenerator(name = &quot;IMMIGRATION_FILE_ID_GENERATOR&quot;,\n            sequenceName = &quot;SEQ_IMMIGRATION_FILE_ID&quot;,\n            allocationSize = 1)\n    @GeneratedValue(strategy = GenerationType.AUTO, generator = &quot;IMMIGRATION_FILE_ID_GENERATOR&quot;)\n    @Column(name = &quot;ID&quot;, unique = true, nullable = false)\n    private Long immigrationFileId;\n\n...other columns\n}\n</code></pre>\n<p>Audit table - Immigration_file_hist, having all columns of main table along with REV and REVTYPE, so the error is being thrown when the value of REV is &quot;4686710314&quot;.</p>\n<p>I have tried both the approached of using RevisionRepository and custom Audit Query and I get the same exception with both of them\ncode to fetch the revisions of immigration_file_hist repository</p>\n<pre><code>@Repository\npublic interface ImmigrationFileDaoRepository extends RevisionRepository&lt;ImmigrationFile, Long, BigInteger&gt;, JpaRepository&lt;ImmigrationFile, Long&gt; {\n\n        Page&lt;Revision&lt;BigInteger, ImmigrationFile&gt;&gt; revisions = immigrationFileDaoRepository.findRevisions(immigrationFile.getImmigrationFileId(), PageRequest.of(Integer.valueOf(startPageIndex), Integer.valueOf(endPageIndex), RevisionSort.desc()));\n</code></pre>\n<p>I was using Long earlier and i have changed it to BigInteger and i still face the same issue.</p>\n<p>Custom Audit Query</p>\n<pre><code>public List&lt;ImmigrationFile&gt; findRevisions(Long immigrationFileId) {\n        AuditReader reader = AuditReaderFactory.get(entityManager);\n        List&lt;ImmigrationFile&gt; results = reader\n                .createQuery()\n                .forRevisionsOfEntity(ImmigrationFile.class, true, false)\n                .add(AuditEntity.id().eq(immigrationFileId))\n                .addOrder(AuditEntity.property(&quot;version&quot;).desc())\n                .setMaxResults(maxResult)\n                .getResultList();\n        return results;\n</code></pre>\n<p>Im getting the below exception :</p>\n<pre><code> Caused by: org.springframework.orm.jpa.JpaSystemException: could not execute query; nested exception is org.hibernate.exception.GenericJDBCException: could not execute query\n    at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:331)\n    at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)\n    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:548)\n    at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)\n    at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)\n    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n    at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:174)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n    at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)\n    at com.sun.proxy.$Proxy252.findRevisions(Unknown Source)\n    at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)\n    at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:687)\n    ... 82 common frames omitted\nCaused by: org.hibernate.exception.GenericJDBCException: could not execute query\n    at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:47)\n    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)\n    at org.hibernate.loader.Loader.doList(Loader.java:2853)\n    at org.hibernate.loader.Loader.doList(Loader.java:2832)\n    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2664)\n    at org.hibernate.loader.Loader.list(Loader.java:2659)\n    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:506)\n    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)\n    at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:219)\n    at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1414)/\n    at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1565)\n    at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1533)\n    at org.hibernate.envers.query.internal.impl.AbstractAuditQuery.buildAndExecuteQuery(AbstractAuditQuery.java:106)\n    at org.hibernate.envers.query.internal.impl.RevisionsOfEntityQuery.getQueryResults(RevisionsOfEntityQuery.java:173)\n    at org.hibernate.envers.query.internal.impl.RevisionsOfEntityQuery.list(RevisionsOfEntityQuery.java:136)\n    at org.hibernate.envers.query.internal.impl.AbstractAuditQuery.getResultList(AbstractAuditQuery.java:112)\n    at org.springframework.data.envers.repository.support.EnversRevisionRepositoryImpl.findRevisions(EnversRevisionRepositoryImpl.java:155)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:566)\n    at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:289)\n    at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)\n    at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)\n    at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:524)\n    at org.springframework.data.repository.core.support.Reposito.ryComposition.invoke(RepositoryComposition.java:285)\n    at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:531)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n    at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:156)\n    at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:131)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n    at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:80)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n    at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:371)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:134)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)\n    ... 97 common frames omitted\nCaused by: java.sql.SQLException: Numeric Overflow\n    at oracle.jdbc.driver.NumberCommonAccessor.throwOverflow(NumberCommonAccessor.java:4139)\n    at oracle.jdbc.driver.NumberCommonAccessor.getInt(NumberCommonAccessor.java:125)\n    at oracle.jdbc.driver.GeneratedStatement.getInt(GeneratedStatement.java:199)\n    at oracle.jdbc.driver.GeneratedScrollableResultSet.getInt(GeneratedScrollableResultSet.java:246)\n    at oracle.jdbc.driver.GeneratedResultSet.getInt(GeneratedResultSet.java:556)\n    at com.ibm.ws.rsadapter.jdbc.WSJdbcResultSet.getInt(WSJdbcResultSet.java:1089)\n    at org.hibernate.type.descriptor.sql.IntegerTypeDescriptor$2.doExtract(IntegerTypeDescriptor.java:62)\n    at org.hibernate.type.descriptor.sql.BasicExtractor.extract(BasicExtractor.java:47)\n    at org.hibernate.type.AbstractStandardBasicType.nullSafeGet(AbstractStandardBasicType.java:257)\n    at org.hibernate.type.AbstractStandardBasicType.nullSafeGet(AbstractStandardBasicType.java:253)\n    at org.hibernate.type.AbstractStandardBasicType.nullSafeGet(AbstractStandardBasicType.java:243)\n    at org.hibernate.type.AbstractStandardBasicType.hydrate(AbstractStandardBasicType.java:329)\n    at org.hibernate.type.ManyToOneType.hydrate(ManyToOneType.java:184)\n    at org.hibernate.type.ComponentType.hydrate(ComponentType.java:670)\n    at org.hibernate.loader.Loader.extractKeysFromResultSet(Loader.java:803)\n    at org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:727)\n    at org.hibernate.loader.Loader.getRowsFromResultSet(Loader.java:1039)\n    at org.hibernate.loader.Loader.processResultSet(Loader.java:990)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:959)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:349)\n    at org.hibernate.loader.Loader.doList(Loader.java:2850)\n    ... 131 common frames omitted\n</code></pre>\n"},{"tags":["java","clipboard"],"comments":[{"owner":{"account_id":956558,"reputation":30924,"user_id":981744,"display_name":"Erwin Bolwidt"},"score":0,"creation_date":1499908946,"post_id":45069475,"comment_id":77112948,"body_markdown":"You can discuss/buy premier or extended support from Oracle, and see if that includes fixing this bug. Jdk7 has been end-of-public-updates for more than 2 years. It&#39;s probably a better idea to migrate to jdk8. http://www.oracle.com/technetwork/java/eol-135779.html","body":"You can discuss/buy premier or extended support from Oracle, and see if that includes fixing this bug. Jdk7 has been end-of-public-updates for more than 2 years. It&#39;s probably a better idea to migrate to jdk8. <a href=\"http://www.oracle.com/technetwork/java/eol-135779.html\" rel=\"nofollow noreferrer\">oracle.com/technetwork/java/eol-135779.html</a>"}],"answers":[{"tags":[],"owner":{"account_id":3025392,"reputation":1695,"user_id":2565527,"accept_rate":100,"display_name":"hiropon"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1684824951,"creation_date":1499906743,"answer_id":45069703,"question_id":45069475,"body_markdown":"My answer is probably useless, but I post.  \r\nAccording to Bugzilla tickets [JDK-7107490][1] and [JDK-7199196][2], these bugs are fixed from jdk8. So, it&#39;s better recommending to migrate to java 8.\r\n\r\nI&#39;m not so familiar with JDK&#39;s updating schedule, but I think JDK7 is no more maintained (EOL: [Java 7 Reaches End of Life][3]). If you created any patches for this bug, it would not be merged.\r\n\r\n\r\n  [1]: http://bugs.java.com/bugdatabase/view_bug.do?bug_id=7107490\r\n  [2]: http://bugs.java.com/bugdatabase/view_bug.do?bug_id=7199196\r\n  [3]: https://www.infoq.com/news/2015/05/Oracle-Ends-Java-7Public-Updates","title":"java.io.IOException: Owner failed to convert data","body":"<p>My answer is probably useless, but I post.<br />\nAccording to Bugzilla tickets <a href=\"http://bugs.java.com/bugdatabase/view_bug.do?bug_id=7107490\" rel=\"nofollow noreferrer\">JDK-7107490</a> and <a href=\"http://bugs.java.com/bugdatabase/view_bug.do?bug_id=7199196\" rel=\"nofollow noreferrer\">JDK-7199196</a>, these bugs are fixed from jdk8. So, it's better recommending to migrate to java 8.</p>\n<p>I'm not so familiar with JDK's updating schedule, but I think JDK7 is no more maintained (EOL: <a href=\"https://www.infoq.com/news/2015/05/Oracle-Ends-Java-7Public-Updates\" rel=\"nofollow noreferrer\">Java 7 Reaches End of Life</a>). If you created any patches for this bug, it would not be merged.</p>\n"}],"owner":{"account_id":2229924,"reputation":5666,"user_id":1967800,"accept_rate":78,"display_name":"Sharcoux"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":468,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":45069703,"answer_count":1,"score":1,"last_activity_date":1684824951,"creation_date":1499904840,"question_id":45069475,"body_markdown":"When copying an image from the clipboard into my application, I get :\r\n\r\n    java.io.IOException: Owner failed to convert data\r\n    \tat sun.awt.X11.XSelection.validateDataGetter(XSelection.java:444)\r\n    \tat sun.awt.X11.XSelection.getData(XSelection.java:305)\r\n    \tat sun.awt.X11.XClipboard.getClipboardData(XClipboard.java:120)\r\n    \tat sun.awt.datatransfer.SunClipboard.getData(SunClipboard.java:225)\r\n\r\nAccording to [this](http://bugs.java.com/bugdatabase/view_bug.do?bug_id=7107490), it appears that the issues is from jdk 1.7.0. Great. But what can I do for my users that are currently using Java 7 (except asking them to migrate to java 8 ?)\r\n\r\nOr maybe I didn&#39;t understand the issue ?","title":"java.io.IOException: Owner failed to convert data","body":"<p>When copying an image from the clipboard into my application, I get :</p>\n\n<pre><code>java.io.IOException: Owner failed to convert data\n    at sun.awt.X11.XSelection.validateDataGetter(XSelection.java:444)\n    at sun.awt.X11.XSelection.getData(XSelection.java:305)\n    at sun.awt.X11.XClipboard.getClipboardData(XClipboard.java:120)\n    at sun.awt.datatransfer.SunClipboard.getData(SunClipboard.java:225)\n</code></pre>\n\n<p>According to <a href=\"http://bugs.java.com/bugdatabase/view_bug.do?bug_id=7107490\" rel=\"nofollow noreferrer\">this</a>, it appears that the issues is from jdk 1.7.0. Great. But what can I do for my users that are currently using Java 7 (except asking them to migrate to java 8 ?)</p>\n\n<p>Or maybe I didn't understand the issue ?</p>\n"}],"has_more":true,"quota_max":10000,"quota_remaining":9808,"page":417,"page_size":100}
