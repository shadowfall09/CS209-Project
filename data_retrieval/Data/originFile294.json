{"items":[{"tags":["java","spring-boot"],"comments":[{"owner":{"account_id":9760,"reputation":85859,"user_id":18157,"accept_rate":100,"display_name":"Jim Garrison"},"score":2,"creation_date":1689975421,"post_id":76740641,"comment_id":135293759,"body_markdown":"In order to fix the input programmatically you need to understand and enumerate the types of errors involved.  It may be that some errors cannot be unambiguously detected, in which case you may be out of luck.  In any event, none of your current approaches will work because you&#39;ll need to process the input stream yourself, and fix the errors, _before_ passing it to any &quot;standard&quot; parser.","body":"In order to fix the input programmatically you need to understand and enumerate the types of errors involved.  It may be that some errors cannot be unambiguously detected, in which case you may be out of luck.  In any event, none of your current approaches will work because you&#39;ll need to process the input stream yourself, and fix the errors, <i>before</i> passing it to any &quot;standard&quot; parser."},{"owner":{"account_id":93689,"reputation":415931,"user_id":256196,"accept_rate":77,"display_name":"Bohemian"},"score":0,"creation_date":1689981898,"post_id":76740641,"comment_id":135294362,"body_markdown":"To &quot;fix&quot; the problem you&#39;ll need to write a non-trivial parser that can detect problems and know how to fix them, which is basically a bad idea because it validates the source of the problem allowing, even encouraging, them to create bad output. IMHO the best approach is to reject invalid input which will force the producer to stop causing problems.","body":"To &quot;fix&quot; the problem you&#39;ll need to write a non-trivial parser that can detect problems and know how to fix them, which is basically a bad idea because it validates the source of the problem allowing, even encouraging, them to create bad output. IMHO the best approach is to reject invalid input which will force the producer to stop causing problems."},{"owner":{"account_id":8463393,"reputation":153,"user_id":6923588,"display_name":"Cyriac George"},"score":0,"creation_date":1689987893,"post_id":76740641,"comment_id":135294687,"body_markdown":"Yeah, I agree that fixing at the source is the best solution. I&#39;ll try for that","body":"Yeah, I agree that fixing at the source is the best solution. I&#39;ll try for that"}],"answers":[{"tags":[],"owner":{"account_id":28850828,"reputation":512,"user_id":22096771,"display_name":"Bademeister"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1689981553,"creation_date":1689970710,"answer_id":76740995,"question_id":76740641,"body_markdown":"I think a regex could be quite complex because there is so much to consider. Specially if the JSON is not available wellformed. \r\n\r\n```json\r\n{&quot;appName&quot;: &quot;Sample \\ &quot;App &quot;  Name&quot;, &quot;foo&quot;\r\n: &quot;Bar App \\ &quot;Name&quot;,\r\n  &quot;test&quot;:[{&quot;a&quot;: &quot;b&quot;}]}\r\n```\r\n\r\nI would format the JSON and then process it line by line. With a RegEx or/and StringMethods you can then repair the values line by line.\r\n\r\n```json\r\n{\r\n&quot;appName&quot;:&quot;Sample \\ &quot;App &quot;  Name&quot;,\r\n&quot;foo&quot;:&quot;Bar App \\ &quot;Name&quot;, \r\n&quot;test&quot;:\r\n[\r\n{\r\n&quot;a&quot;:&quot;b&quot;\r\n}\r\n]\r\n}\r\n```\r\n\r\n\r\n**Example / Proof of Concept**\r\n\r\nYou will have to correct the JSON programmatically because otherwise no JSON parser will be able to process it. The following is a PoC. I would pursue it like this if I had this challenge. I don&#39;t know a library that fixes corrupt JSON. The question would be, how does the corrupt JSON get into your database?\r\n\r\n```java\r\nString corruptJson = &quot;{\\&quot;appName\\&quot;: \\&quot;Sample \\\\ \\&quot;App \\&quot;  Name\\&quot;, \\&quot;foo\\&quot;\\n&quot; +\r\n        &quot;: \\&quot;Bar App \\\\ \\&quot;Name\\&quot;,\\n&quot; +\r\n        &quot;  \\&quot;test\\&quot;:[{\\&quot;a\\&quot;: \\&quot;b\\&quot;}]}&quot;;\r\n\r\nString replacedJson = corruptJson\r\n        .replaceAll(&quot;[\\\\n\\\\s]*:[\\\\n\\\\s]*&quot;, &quot;:&quot;)\r\n        .replaceAll(&quot;([\\\\{\\\\},\\\\[\\\\]])&quot;, &quot;\\n$1\\n&quot;);\r\n\r\nStringBuilder cleanedJson = new StringBuilder();\r\nScanner scanner = new Scanner(replacedJson);\r\nwhile (scanner.hasNextLine()) {\r\n    String line = scanner.nextLine();\r\n    if (line.length() &gt; 0) {\r\n        int posDoublePoint = line.indexOf(&quot;:&quot;);\r\n        if (posDoublePoint &gt; 0) {\r\n            String key = line.substring(0, posDoublePoint);\r\n            String value = line.substring(posDoublePoint + 1).trim();\r\n            if (value.length() &gt; 0) {\r\n                value = value.replaceAll(&quot;^\\&quot;&quot;, &quot;&quot;);\r\n                value = value.replaceAll(&quot;\\&quot;$&quot;, &quot;&quot;);\r\n                value = value.replace(&quot;\\\\&quot;, &quot;&quot;);\r\n                value = value.replace(&quot;\\&quot;&quot;, &quot;\\\\\\&quot;&quot;);\r\n                cleanedJson.append(key).append(&quot;:&quot;).append(String.format(&quot;\\&quot;%s\\&quot;&quot;, value));\r\n                continue;\r\n            }\r\n        }\r\n        cleanedJson.append(line);\r\n    }\r\n}\r\nscanner.close();\r\n\r\nGson gson = new GsonBuilder().setPrettyPrinting().create();\r\nString prettyJson = gson.toJson(JsonParser.parseString(cleanedJson.toString()));\r\n```\r\n\r\n```json\r\n{\r\n  &quot;appName&quot;: &quot;Sample  \\&quot;App \\&quot;  Name&quot;,\r\n  &quot;foo&quot;: &quot;Bar App  \\&quot;Name&quot;,\r\n  &quot;test&quot;: [\r\n    {\r\n      &quot;a&quot;: &quot;b&quot;\r\n    }\r\n  ]\r\n}\r\n```","title":"How to correct an invalid JSON that contains unescaped special characters","body":"<p>I think a regex could be quite complex because there is so much to consider. Specially if the JSON is not available wellformed.</p>\n<pre class=\"lang-json prettyprint-override\"><code>{&quot;appName&quot;: &quot;Sample \\ &quot;App &quot;  Name&quot;, &quot;foo&quot;\n: &quot;Bar App \\ &quot;Name&quot;,\n  &quot;test&quot;:[{&quot;a&quot;: &quot;b&quot;}]}\n</code></pre>\n<p>I would format the JSON and then process it line by line. With a RegEx or/and StringMethods you can then repair the values line by line.</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n&quot;appName&quot;:&quot;Sample \\ &quot;App &quot;  Name&quot;,\n&quot;foo&quot;:&quot;Bar App \\ &quot;Name&quot;, \n&quot;test&quot;:\n[\n{\n&quot;a&quot;:&quot;b&quot;\n}\n]\n}\n</code></pre>\n<p><strong>Example / Proof of Concept</strong></p>\n<p>You will have to correct the JSON programmatically because otherwise no JSON parser will be able to process it. The following is a PoC. I would pursue it like this if I had this challenge. I don't know a library that fixes corrupt JSON. The question would be, how does the corrupt JSON get into your database?</p>\n<pre class=\"lang-java prettyprint-override\"><code>String corruptJson = &quot;{\\&quot;appName\\&quot;: \\&quot;Sample \\\\ \\&quot;App \\&quot;  Name\\&quot;, \\&quot;foo\\&quot;\\n&quot; +\n        &quot;: \\&quot;Bar App \\\\ \\&quot;Name\\&quot;,\\n&quot; +\n        &quot;  \\&quot;test\\&quot;:[{\\&quot;a\\&quot;: \\&quot;b\\&quot;}]}&quot;;\n\nString replacedJson = corruptJson\n        .replaceAll(&quot;[\\\\n\\\\s]*:[\\\\n\\\\s]*&quot;, &quot;:&quot;)\n        .replaceAll(&quot;([\\\\{\\\\},\\\\[\\\\]])&quot;, &quot;\\n$1\\n&quot;);\n\nStringBuilder cleanedJson = new StringBuilder();\nScanner scanner = new Scanner(replacedJson);\nwhile (scanner.hasNextLine()) {\n    String line = scanner.nextLine();\n    if (line.length() &gt; 0) {\n        int posDoublePoint = line.indexOf(&quot;:&quot;);\n        if (posDoublePoint &gt; 0) {\n            String key = line.substring(0, posDoublePoint);\n            String value = line.substring(posDoublePoint + 1).trim();\n            if (value.length() &gt; 0) {\n                value = value.replaceAll(&quot;^\\&quot;&quot;, &quot;&quot;);\n                value = value.replaceAll(&quot;\\&quot;$&quot;, &quot;&quot;);\n                value = value.replace(&quot;\\\\&quot;, &quot;&quot;);\n                value = value.replace(&quot;\\&quot;&quot;, &quot;\\\\\\&quot;&quot;);\n                cleanedJson.append(key).append(&quot;:&quot;).append(String.format(&quot;\\&quot;%s\\&quot;&quot;, value));\n                continue;\n            }\n        }\n        cleanedJson.append(line);\n    }\n}\nscanner.close();\n\nGson gson = new GsonBuilder().setPrettyPrinting().create();\nString prettyJson = gson.toJson(JsonParser.parseString(cleanedJson.toString()));\n</code></pre>\n<pre class=\"lang-json prettyprint-override\"><code>{\n  &quot;appName&quot;: &quot;Sample  \\&quot;App \\&quot;  Name&quot;,\n  &quot;foo&quot;: &quot;Bar App  \\&quot;Name&quot;,\n  &quot;test&quot;: [\n    {\n      &quot;a&quot;: &quot;b&quot;\n    }\n  ]\n}\n</code></pre>\n"}],"owner":{"account_id":8463393,"reputation":153,"user_id":6923588,"display_name":"Cyriac George"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":138,"favorite_count":0,"down_vote_count":3,"up_vote_count":1,"answer_count":1,"score":-2,"last_activity_date":1689981553,"creation_date":1689966606,"question_id":76740641,"body_markdown":"### Context\r\nThe data source (DB) returns CLOB data on one of the columns. It&#39;s supposed to be a valid JSON and most of the time it is. But in certain cases, it may contain JSON-special characters such as `\\` or `&quot;`. \r\n\r\nFor e.x. sourceJson = \r\n```\r\n{\r\n  &quot;appName&quot;: &quot;Sample \\ &quot;App &quot; Name&quot;\r\n}\r\n```\r\n\r\n### Questions\r\nCorrecting this in the data source is probably the right approach. But if that&#39;s infeasible,\r\n1. How to correct an invalid JSON that contains unescaped special characters on the receiver side (Java)?\r\n2. I can handle `\\` by doing `String replaced = sourceJson.replace(&quot;\\\\&quot;, &quot;\\\\\\\\&quot;);` but what about `&quot;`?\r\n3. If the only way is to manually replace, are there characters other than `\\`, `&quot;` that should be replaced this way?\r\n\r\n### What have I tried so far?\r\n1. Escape the source JSON using `org.apache.commons.lang3.StringEscapeUtils` and use that to deserialize\r\n```\r\nString escapeJson = StringEscapeUtils.escapeJson(sourceJson);\r\nGson gson = new Gson();\r\n\r\nMyObject obj = gson.fromJson(escapeJson, MyObject.class);\r\n// produces com.google.gson.stream.MalformedJsonException: Expected name at line 1 column 2 path $.appName=null\r\n```\r\n2. Use `com.fasterxml.jackson.core.io.JsonStringEncoder.getInstance().quoteAsString` and use that to deserialize\r\n```\r\nString quotedJson = String.valueOf(JsonStringEncoder.getInstance().quoteAsString(sourceJson));\r\n\r\nGson gson = new Gson();\r\nMyObject obj = gson.fromJson(quotedJson, MyObject.class);\r\n// produces com.google.gson.stream.MalformedJsonException: Expected name at line 1 column 2 path $.appName=null\r\n```\r\n3. Same as 1 except use ObjectMapper to deserialize\r\n```\r\nString escapeJson = StringEscapeUtils.escapeJson(sourceJson);\r\n\r\nObjectMapper objectMapper = JsonMapper.builder()\r\n          .enable(JsonReadFeature.ALLOW_BACKSLASH_ESCAPING_ANY_CHARACTER,\r\n              JsonReadFeature.ALLOW_UNESCAPED_CONTROL_CHARS)\r\n          .build();\r\nMyObject obj = objectMapper.readValue(escapeJson, MyObject.class);\r\n// produces Unexpected character (&#39;\\&#39; (code 92)): was expecting double-quote to start field name\r\n```\r\n4. Same as 2 except use ObjectMapper to deserialize\r\n```\r\nString quotedJson = String.valueOf(JsonStringEncoder.getInstance().quoteAsString(sourceJson));\r\n\r\nObjectMapper objectMapper = JsonMapper.builder()\r\n          .enable(JsonReadFeature.ALLOW_BACKSLASH_ESCAPING_ANY_CHARACTER,\r\n              JsonReadFeature.ALLOW_UNESCAPED_CONTROL_CHARS)\r\n          .build();\r\nMyObject obj = objectMapper.readValue(escapeJson, MyObject.class);\r\n// produces Unexpected character (&#39;\\&#39; (code 92)): was expecting double-quote to start field name\r\n```\r\n\r\n### Research Inferences\r\n1. I have looked at several SO posts but they all talk about escaping strings at the source side\r\n2. The only way I can think of making it work on the receiver side is by manually replacing it with some regexes. Replacing a single `\\` is easy (probably regex=`\\\\` should do). But I don&#39;t know how to replace a single/unterminated `&quot;` with regex\r\n","title":"How to correct an invalid JSON that contains unescaped special characters","body":"<h3>Context</h3>\n<p>The data source (DB) returns CLOB data on one of the columns. It's supposed to be a valid JSON and most of the time it is. But in certain cases, it may contain JSON-special characters such as <code>\\</code> or <code>&quot;</code>.</p>\n<p>For e.x. sourceJson =</p>\n<pre><code>{\n  &quot;appName&quot;: &quot;Sample \\ &quot;App &quot; Name&quot;\n}\n</code></pre>\n<h3>Questions</h3>\n<p>Correcting this in the data source is probably the right approach. But if that's infeasible,</p>\n<ol>\n<li>How to correct an invalid JSON that contains unescaped special characters on the receiver side (Java)?</li>\n<li>I can handle <code>\\</code> by doing <code>String replaced = sourceJson.replace(&quot;\\\\&quot;, &quot;\\\\\\\\&quot;);</code> but what about <code>&quot;</code>?</li>\n<li>If the only way is to manually replace, are there characters other than <code>\\</code>, <code>&quot;</code> that should be replaced this way?</li>\n</ol>\n<h3>What have I tried so far?</h3>\n<ol>\n<li>Escape the source JSON using <code>org.apache.commons.lang3.StringEscapeUtils</code> and use that to deserialize</li>\n</ol>\n<pre><code>String escapeJson = StringEscapeUtils.escapeJson(sourceJson);\nGson gson = new Gson();\n\nMyObject obj = gson.fromJson(escapeJson, MyObject.class);\n// produces com.google.gson.stream.MalformedJsonException: Expected name at line 1 column 2 path $.appName=null\n</code></pre>\n<ol start=\"2\">\n<li>Use <code>com.fasterxml.jackson.core.io.JsonStringEncoder.getInstance().quoteAsString</code> and use that to deserialize</li>\n</ol>\n<pre><code>String quotedJson = String.valueOf(JsonStringEncoder.getInstance().quoteAsString(sourceJson));\n\nGson gson = new Gson();\nMyObject obj = gson.fromJson(quotedJson, MyObject.class);\n// produces com.google.gson.stream.MalformedJsonException: Expected name at line 1 column 2 path $.appName=null\n</code></pre>\n<ol start=\"3\">\n<li>Same as 1 except use ObjectMapper to deserialize</li>\n</ol>\n<pre><code>String escapeJson = StringEscapeUtils.escapeJson(sourceJson);\n\nObjectMapper objectMapper = JsonMapper.builder()\n          .enable(JsonReadFeature.ALLOW_BACKSLASH_ESCAPING_ANY_CHARACTER,\n              JsonReadFeature.ALLOW_UNESCAPED_CONTROL_CHARS)\n          .build();\nMyObject obj = objectMapper.readValue(escapeJson, MyObject.class);\n// produces Unexpected character ('\\' (code 92)): was expecting double-quote to start field name\n</code></pre>\n<ol start=\"4\">\n<li>Same as 2 except use ObjectMapper to deserialize</li>\n</ol>\n<pre><code>String quotedJson = String.valueOf(JsonStringEncoder.getInstance().quoteAsString(sourceJson));\n\nObjectMapper objectMapper = JsonMapper.builder()\n          .enable(JsonReadFeature.ALLOW_BACKSLASH_ESCAPING_ANY_CHARACTER,\n              JsonReadFeature.ALLOW_UNESCAPED_CONTROL_CHARS)\n          .build();\nMyObject obj = objectMapper.readValue(escapeJson, MyObject.class);\n// produces Unexpected character ('\\' (code 92)): was expecting double-quote to start field name\n</code></pre>\n<h3>Research Inferences</h3>\n<ol>\n<li>I have looked at several SO posts but they all talk about escaping strings at the source side</li>\n<li>The only way I can think of making it work on the receiver side is by manually replacing it with some regexes. Replacing a single <code>\\</code> is easy (probably regex=<code>\\\\</code> should do). But I don't know how to replace a single/unterminated <code>&quot;</code> with regex</li>\n</ol>\n"},{"tags":["java","android","spring","classcastexception","resttemplate"],"comments":[{"owner":{"account_id":1590928,"reputation":484,"user_id":1474261,"accept_rate":75,"display_name":"Emilla"},"score":1,"creation_date":1398065534,"post_id":19463372,"comment_id":35473992,"body_markdown":"Hi Erick, have you found any solution for your problem? I have almost same problem too","body":"Hi Erick, have you found any solution for your problem? I have almost same problem too"},{"owner":{"account_id":435701,"reputation":1565,"user_id":822436,"display_name":"Deepankar Sarkar"},"score":1,"creation_date":1425891472,"post_id":19463372,"comment_id":46131281,"body_markdown":"This answer helped me out to solve the issue. https://stackoverflow.com/a/15453159/822436","body":"This answer helped me out to solve the issue. <a href=\"https://stackoverflow.com/a/15453159/822436\">stackoverflow.com/a/15453159/822436</a>"},{"owner":{"account_id":2102746,"reputation":1404,"user_id":1869908,"accept_rate":56,"display_name":"Robin Sun"},"score":0,"creation_date":1563934483,"post_id":19463372,"comment_id":100861178,"body_markdown":"There is some way to convert List&lt;LinkedHashMap&gt; to List&lt;MyModelClass&gt;. But why it doesn&#39;t throw any exception when restTemplate retruns List&lt;LinkedHashMap&gt; and assgin it to myModelClass[]? They are differnt types. Why?","body":"There is some way to convert List&lt;LinkedHashMap&gt; to List&lt;MyModelClass&gt;. But why it doesn&#39;t throw any exception when restTemplate retruns List&lt;LinkedHashMap&gt; and assgin it to myModelClass[]? They are differnt types. Why?"}],"answers":[{"tags":[],"owner":{"account_id":195331,"reputation":275398,"user_id":438154,"accept_rate":98,"display_name":"Sotirios Delimanolis"},"down_vote_count":0,"up_vote_count":64,"is_accepted":true,"score":64,"last_activity_date":1461885539,"creation_date":1382167690,"answer_id":19463586,"question_id":19463372,"body_markdown":"With the following method call\r\n\r\n    List&lt;MyModelClass&gt; myModelClass=(List&lt;MyModelClass&gt;) restTemplate.postForObject(url,mvm,List.class);\r\n\r\nAll Jackson knows is that you want a `List`, but doesn&#39;t have any restriction on the type. By default Jackson deserializes a JSON object into a `LinkedHashMap`, so that&#39;s why you are getting the `ClassCastException`. \r\n\r\nIf your returned JSON is an array, one way to get it is to use an array\r\n\r\n    MyModelClass[] myModelClasses = restTemplate.postForObject(url,mvm, MyModelClass[].class);\r\n\r\nYou can always add the elements from that array to a `List`.\r\n\r\nI can&#39;t remember since what version, but [`RestTemplate#exchange`][1] now has an overload that accepts a [`ParameterizedTypeReference`][2] argument. The `ParameterizedTypeReference` is the type token hack for suggesting a parameterized type as the target for deserialization.\r\n\r\nYou can refactor the code above to use `exchange` instead of `postForObject`, and use `ParameterizedTypeReference` to get a `List&lt;MyModelClass&gt;`. For example\r\n\r\n    ParameterizedTypeReference&lt;List&lt;MyModelClass&gt;&gt; typeRef = new ParameterizedTypeReference&lt;List&lt;MyModelClass&gt;&gt;() {\r\n    };\r\n    ResponseEntity&lt;List&lt;MyModelClass&gt;&gt; responseEntity = restTemplate.exchange(url, HttpMethod.POST, new HttpEntity&lt;&gt;(mvm), typeRef);\r\n    List&lt;MyModelClass&gt; myModelClasses = responseEntity.getBody();\r\n\r\n\r\n  [1]: http://docs.spring.io/autorepo/docs/spring/current/javadoc-api/org/springframework/web/client/RestTemplate.html#exchange-java.lang.String-org.springframework.http.HttpMethod-org.springframework.http.HttpEntity-org.springframework.core.ParameterizedTypeReference-java.lang.Object...-\r\n  [2]: http://docs.spring.io/autorepo/docs/spring/current/javadoc-api/org/springframework/core/ParameterizedTypeReference.html","title":"ClassCastException: RestTemplate returning List&lt;LinkedHashMap&gt; instead of List&lt;MymodelClass&gt;","body":"<p>With the following method call</p>\n\n<pre><code>List&lt;MyModelClass&gt; myModelClass=(List&lt;MyModelClass&gt;) restTemplate.postForObject(url,mvm,List.class);\n</code></pre>\n\n<p>All Jackson knows is that you want a <code>List</code>, but doesn't have any restriction on the type. By default Jackson deserializes a JSON object into a <code>LinkedHashMap</code>, so that's why you are getting the <code>ClassCastException</code>. </p>\n\n<p>If your returned JSON is an array, one way to get it is to use an array</p>\n\n<pre><code>MyModelClass[] myModelClasses = restTemplate.postForObject(url,mvm, MyModelClass[].class);\n</code></pre>\n\n<p>You can always add the elements from that array to a <code>List</code>.</p>\n\n<p>I can't remember since what version, but <a href=\"http://docs.spring.io/autorepo/docs/spring/current/javadoc-api/org/springframework/web/client/RestTemplate.html#exchange-java.lang.String-org.springframework.http.HttpMethod-org.springframework.http.HttpEntity-org.springframework.core.ParameterizedTypeReference-java.lang.Object...-\"><code>RestTemplate#exchange</code></a> now has an overload that accepts a <a href=\"http://docs.spring.io/autorepo/docs/spring/current/javadoc-api/org/springframework/core/ParameterizedTypeReference.html\"><code>ParameterizedTypeReference</code></a> argument. The <code>ParameterizedTypeReference</code> is the type token hack for suggesting a parameterized type as the target for deserialization.</p>\n\n<p>You can refactor the code above to use <code>exchange</code> instead of <code>postForObject</code>, and use <code>ParameterizedTypeReference</code> to get a <code>List&lt;MyModelClass&gt;</code>. For example</p>\n\n<pre><code>ParameterizedTypeReference&lt;List&lt;MyModelClass&gt;&gt; typeRef = new ParameterizedTypeReference&lt;List&lt;MyModelClass&gt;&gt;() {\n};\nResponseEntity&lt;List&lt;MyModelClass&gt;&gt; responseEntity = restTemplate.exchange(url, HttpMethod.POST, new HttpEntity&lt;&gt;(mvm), typeRef);\nList&lt;MyModelClass&gt; myModelClasses = responseEntity.getBody();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":15246195,"reputation":633,"user_id":11001003,"display_name":"Chiranjaya Denuwan"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1647842962,"creation_date":1647842962,"answer_id":71553407,"question_id":19463372,"body_markdown":"With the following method call , you can convert `LinkedHashMap` to `List`\r\n\r\n\r\n    ObjectMapper mapper = new  ObjectMapper();\r\n    List&lt;Object&gt; list = mapper.convertValue(listResponse, new TypeReference&lt;List&lt;Object&gt;&gt;() {})","title":"ClassCastException: RestTemplate returning List&lt;LinkedHashMap&gt; instead of List&lt;MymodelClass&gt;","body":"<p>With the following method call , you can convert <code>LinkedHashMap</code> to <code>List</code></p>\n<pre><code>ObjectMapper mapper = new  ObjectMapper();\nList&lt;Object&gt; list = mapper.convertValue(listResponse, new TypeReference&lt;List&lt;Object&gt;&gt;() {})\n</code></pre>\n"}],"owner":{"account_id":2188422,"reputation":715,"user_id":1936227,"accept_rate":40,"display_name":"Erick"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":44940,"favorite_count":0,"down_vote_count":0,"up_vote_count":50,"accepted_answer_id":19463586,"answer_count":2,"score":50,"last_activity_date":1689981329,"creation_date":1382166043,"question_id":19463372,"body_markdown":"I&#39;m trying to access getter methods on my MyModelClass but my code is returning `List&lt;LinkedHashMap&gt;` instead of `List&lt;MyModelClass&gt;`. This is my code.\r\n\r\n    List&lt;MyModelClass&gt; myModelClass = \r\n       (List&lt;MyModelClass&gt;) restTemplate.postForObject(url,mvm,List.class);\r\n\r\n    System.out.println(&quot;Response= &quot; +  myModelClass);\r\n\r\nI tried to print the response and I got the JSON Response that I&#39;m expecting. \r\nbut when I tried to run this code.\r\n\r\n    System.out.println(&quot;Response= &quot; +  myModelClass.get(0).getMessage());\r\n\r\n\r\nIt will produce this error.\r\n\r\n    java.lang.ClassCastException: \r\n    java.util.LinkedHashMap cannot be cast to com.XXX.XXX.MyModelClass \r\n\r\nIt is a mismatch. Can someone help me to get rid with this error? thanks.\r\n\r\nMyModelClass\r\n\r\n    public class MyModelClass{\r\n    \t\t\r\n    \t/**\r\n    \t * \r\n    \t */\r\n    \t@JsonProperty(&quot;id&quot;)\r\n    \tpublic String id;\r\n    \t\r\n    \t@JsonProperty(&quot;type&quot;)\r\n    \tpublic String type;\r\n    \t\r\n    \t@JsonProperty(&quot;user&quot;)\r\n    \tpublic String user;\r\n    \t\r\n    \t@JsonProperty(&quot;message&quot;)\r\n    \tpublic String message;\r\n\r\n        //getters\r\n\r\n\r\nError for \r\n\r\n    MyModelClass[] myModelClass= restTemplate.postForObject(url,mvm, myModelClass[].class);\r\n    \r\n    org.springframework.http.converter.HttpMessageNotReadableException:\r\n    Could not read JSON: \r\n    Can not deserialize instance of java.util.ArrayList out of START_OBJECT token\r\n\r\nJSON Response Structure\r\n\r\n        \r\n        [{&quot;key1&quot;:&quot;value1&quot;,&quot;key2&quot;:&quot;value2&quot;,&quot;parameters&quot;:{&quot;key1&quot;:&quot;value1&quot;,&quot;key2&quot;:&quot;value2&quot;,&quot;key3&quot;:&quot;value3&quot;,&quot;key4&quot;:&quot;value4&quot;,&quot;key5&quot;:&quot;value5&quot;}},\r\n    {&quot;key12&quot;:&quot;value12&quot;,&quot;key22&quot;:&quot;value22&quot;,&quot;parameters&quot;:{&quot;key12&quot;:&quot;value12&quot;,&quot;key22&quot;:&quot;value22&quot;,&quot;key32&quot;:&quot;value32&quot;,&quot;key42&quot;:&quot;value42&quot;,&quot;key52&quot;:&quot;value52&quot;}}]\r\n\r\nIf there is any suggestion on how to map this kind of JSON Response in RestTemplate,It would help a lot. thanks\r\n\r\n","title":"ClassCastException: RestTemplate returning List&lt;LinkedHashMap&gt; instead of List&lt;MymodelClass&gt;","body":"<p>I'm trying to access getter methods on my MyModelClass but my code is returning <code>List&lt;LinkedHashMap&gt;</code> instead of <code>List&lt;MyModelClass&gt;</code>. This is my code.</p>\n<pre><code>List&lt;MyModelClass&gt; myModelClass = \n   (List&lt;MyModelClass&gt;) restTemplate.postForObject(url,mvm,List.class);\n\nSystem.out.println(&quot;Response= &quot; +  myModelClass);\n</code></pre>\n<p>I tried to print the response and I got the JSON Response that I'm expecting.\nbut when I tried to run this code.</p>\n<pre><code>System.out.println(&quot;Response= &quot; +  myModelClass.get(0).getMessage());\n</code></pre>\n<p>It will produce this error.</p>\n<pre><code>java.lang.ClassCastException: \njava.util.LinkedHashMap cannot be cast to com.XXX.XXX.MyModelClass \n</code></pre>\n<p>It is a mismatch. Can someone help me to get rid with this error? thanks.</p>\n<p>MyModelClass</p>\n<pre><code>public class MyModelClass{\n        \n    /**\n     * \n     */\n    @JsonProperty(&quot;id&quot;)\n    public String id;\n    \n    @JsonProperty(&quot;type&quot;)\n    public String type;\n    \n    @JsonProperty(&quot;user&quot;)\n    public String user;\n    \n    @JsonProperty(&quot;message&quot;)\n    public String message;\n\n    //getters\n</code></pre>\n<p>Error for</p>\n<pre><code>MyModelClass[] myModelClass= restTemplate.postForObject(url,mvm, myModelClass[].class);\n\norg.springframework.http.converter.HttpMessageNotReadableException:\nCould not read JSON: \nCan not deserialize instance of java.util.ArrayList out of START_OBJECT token\n</code></pre>\n<p>JSON Response Structure</p>\n<pre><code>    [{&quot;key1&quot;:&quot;value1&quot;,&quot;key2&quot;:&quot;value2&quot;,&quot;parameters&quot;:{&quot;key1&quot;:&quot;value1&quot;,&quot;key2&quot;:&quot;value2&quot;,&quot;key3&quot;:&quot;value3&quot;,&quot;key4&quot;:&quot;value4&quot;,&quot;key5&quot;:&quot;value5&quot;}},\n{&quot;key12&quot;:&quot;value12&quot;,&quot;key22&quot;:&quot;value22&quot;,&quot;parameters&quot;:{&quot;key12&quot;:&quot;value12&quot;,&quot;key22&quot;:&quot;value22&quot;,&quot;key32&quot;:&quot;value32&quot;,&quot;key42&quot;:&quot;value42&quot;,&quot;key52&quot;:&quot;value52&quot;}}]\n</code></pre>\n<p>If there is any suggestion on how to map this kind of JSON Response in RestTemplate,It would help a lot. thanks</p>\n"},{"tags":["java","tree"],"comments":[{"owner":{"account_id":3415784,"reputation":60457,"user_id":2864740,"accept_rate":78,"display_name":"user2864740"},"score":0,"creation_date":1385519960,"post_id":20232858,"comment_id":30174309,"body_markdown":"Create a stack - either explicitly or implicitly (as with recursion). This stack will contain the path.","body":"Create a stack - either explicitly or implicitly (as with recursion). This stack will contain the path."},{"owner":{"account_id":9760,"reputation":85859,"user_id":18157,"accept_rate":100,"display_name":"Jim Garrison"},"score":0,"creation_date":1385519961,"post_id":20232858,"comment_id":30174310,"body_markdown":"`SearchTreeNode` is the same class as `Node`?","body":"<code>SearchTreeNode</code> is the same class as <code>Node</code>?"},{"owner":{"account_id":3592546,"reputation":241,"user_id":2998228,"accept_rate":20,"display_name":"user2998228"},"score":0,"creation_date":1385520052,"post_id":20232858,"comment_id":30174329,"body_markdown":"Sorry yes it is. I changed it.","body":"Sorry yes it is. I changed it."}],"answers":[{"tags":[],"owner":{"account_id":165453,"reputation":1984,"user_id":388928,"accept_rate":71,"display_name":"Ari"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1385520985,"creation_date":1385520157,"answer_id":20232929,"question_id":20232858,"body_markdown":"If the nodes only point to their children, you&#39;ll need to keep track of each path on the way down. As mentioned in comment, you can do this with your own stack or with recursion. For example, you could always return find() call on the children of each node.\r\n\r\nIf the nodes point both ways, you can easily re-trace the path up once you find the correct node. ","title":"Find path to node in Tree?","body":"<p>If the nodes only point to their children, you'll need to keep track of each path on the way down. As mentioned in comment, you can do this with your own stack or with recursion. For example, you could always return find() call on the children of each node.</p>\n\n<p>If the nodes point both ways, you can easily re-trace the path up once you find the correct node. </p>\n"},{"tags":[],"owner":{"account_id":2277179,"reputation":2924,"user_id":2003136,"accept_rate":50,"display_name":"Easton L."},"down_vote_count":0,"up_vote_count":14,"is_accepted":false,"score":14,"last_activity_date":1436000665,"creation_date":1385520866,"answer_id":20233033,"question_id":20232858,"body_markdown":"passing a list tracking the path, once find the node, exit the recursion and fill the path one by one.\r\n\r\n        Boolean Search(Node node, String value, List&lt;Node&gt; track)\r\n        {\r\n            if (node == null) return false;\r\n\r\n            if (node.data.equals(value))\r\n            {\r\n                track.add(node);\r\n                return true;\r\n            }\r\n    \r\n            for(Node child : node.children)\r\n            {\r\n                if (Search(child, value, track)\r\n                {\r\n                    track.add(0, node);\r\n                    return true;\r\n                }\r\n            }\r\n    \r\n            return false;\r\n        }","title":"Find path to node in Tree?","body":"<p>passing a list tracking the path, once find the node, exit the recursion and fill the path one by one.</p>\n\n<pre><code>    Boolean Search(Node node, String value, List&lt;Node&gt; track)\n    {\n        if (node == null) return false;\n\n        if (node.data.equals(value))\n        {\n            track.add(node);\n            return true;\n        }\n\n        for(Node child : node.children)\n        {\n            if (Search(child, value, track)\n            {\n                track.add(0, node);\n                return true;\n            }\n        }\n\n        return false;\n    }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1979692,"reputation":41,"user_id":1776604,"display_name":"Neha"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1486566400,"creation_date":1486565184,"answer_id":42116209,"question_id":20232858,"body_markdown":"The following code traces the path, adding nodes to the list and removing them if they are not in the path  \r\n \r\n    boolean getPath(Node root,String targetValue,List&lt;Integer&gt; path)\r\n    {\r\n        // base case root is null so path not available\r\n        if(root==null)\r\n            return false;\r\n        //add the data to the path\r\n        path.add(root.getData());\r\n        //if the root has data return true,path already saved\r\n        if(root.getData().equals(targetValue))\r\n            return true;\r\n        //find the value in all the children\r\n        for(Node child: children){\r\n             if(getPath(child,targetValue,path))\r\n              return true;\r\n        }\r\n        //if this node does not exist in path remove it\r\n        path.remove(path.size()-1);\r\n        return false;\r\n    }","title":"Find path to node in Tree?","body":"<p>The following code traces the path, adding nodes to the list and removing them if they are not in the path  </p>\n\n<pre><code>boolean getPath(Node root,String targetValue,List&lt;Integer&gt; path)\n{\n    // base case root is null so path not available\n    if(root==null)\n        return false;\n    //add the data to the path\n    path.add(root.getData());\n    //if the root has data return true,path already saved\n    if(root.getData().equals(targetValue))\n        return true;\n    //find the value in all the children\n    for(Node child: children){\n         if(getPath(child,targetValue,path))\n          return true;\n    }\n    //if this node does not exist in path remove it\n    path.remove(path.size()-1);\n    return false;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":10343557,"reputation":1253,"user_id":7629178,"display_name":"vedavyasa k"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689980992,"creation_date":1689980992,"answer_id":76741683,"question_id":20232858,"body_markdown":"\tprivate static boolean treePathFinderRecurr(Node root, List&lt;Character&gt; path,Character target){\r\n\t\t\r\n\t\tif(root == null) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tif(root.data == target || (treePathFinderRecurr(root.left,path,target) || treePathFinderRecurr(root.right,path,target))) {\r\n\t\t\tpath.add(root.data);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t\t\r\n\t}","title":"Find path to node in Tree?","body":"<pre><code>private static boolean treePathFinderRecurr(Node root, List&lt;Character&gt; path,Character target){\n    \n    if(root == null) {\n        return false;\n    }\n    \n    if(root.data == target || (treePathFinderRecurr(root.left,path,target) || treePathFinderRecurr(root.right,path,target))) {\n        path.add(root.data);\n        return true;\n    }\n    \n    return false;\n    \n}\n</code></pre>\n"}],"owner":{"account_id":3592546,"reputation":241,"user_id":2998228,"accept_rate":20,"display_name":"user2998228"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":12433,"favorite_count":0,"down_vote_count":0,"up_vote_count":5,"answer_count":4,"score":5,"last_activity_date":1689980992,"creation_date":1385519680,"question_id":20232858,"body_markdown":"I have a tree class that looks like:\r\n\r\n    Class Tree {\r\n       Node root;\r\n       Node curNode;\r\n       public List&lt;String&gt; find(String value) {\r\n          if (curNode == null) curNode = root;\r\n            for (Node child : curNode.children) {\r\n                if (found == false) {\r\n                    if (child.data.equals(value)) {\r\n                        // if it finds it return the path to this node.\r\n                    }\r\n                    curNode = child;\r\n                    findDFS(value);\r\n                }\r\n            }\r\n       }\r\n    \r\n\r\n    class Node {\r\n       List&lt;Node&gt; children;\r\n       String data;\r\n    }\r\n\r\nWhere the tree root contains pointers to children nodes which point to other children etc etc. What I&#39;m having problems with is once it finds the node, I need to return the the path to that node.\r\n    ","title":"Find path to node in Tree?","body":"<p>I have a tree class that looks like:</p>\n\n<pre><code>Class Tree {\n   Node root;\n   Node curNode;\n   public List&lt;String&gt; find(String value) {\n      if (curNode == null) curNode = root;\n        for (Node child : curNode.children) {\n            if (found == false) {\n                if (child.data.equals(value)) {\n                    // if it finds it return the path to this node.\n                }\n                curNode = child;\n                findDFS(value);\n            }\n        }\n   }\n\n\nclass Node {\n   List&lt;Node&gt; children;\n   String data;\n}\n</code></pre>\n\n<p>Where the tree root contains pointers to children nodes which point to other children etc etc. What I'm having problems with is once it finds the node, I need to return the the path to that node.</p>\n"},{"tags":["java","openrewrite"],"comments":[{"owner":{"account_id":2119809,"reputation":50937,"user_id":1883316,"display_name":"Tim Roberts"},"score":0,"creation_date":1689979401,"post_id":76741547,"comment_id":135294170,"body_markdown":"I don&#39;t see any such method in the documentation; maybe I missed it.  Why do you think that exists?","body":"I don&#39;t see any such method in the documentation; maybe I missed it.  Why do you think that exists?"}],"answers":[{"tags":[],"owner":{"account_id":21852,"reputation":19896,"user_id":53444,"accept_rate":70,"display_name":"Tim"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689979502,"creation_date":1689979502,"answer_id":76741619,"question_id":76741547,"body_markdown":"You&#39;ll likely want to [look at JavaTemplate instead][1] of JavaParser. That has an API to actually create the LST elements that you need here.\r\n\r\n\r\n  [1]: https://docs.openrewrite.org/authoring-recipes/modifying-methods-with-javatemplate","title":"Facing Error while creating a custom recipe to add log level guard","body":"<p>You'll likely want to <a href=\"https://docs.openrewrite.org/authoring-recipes/modifying-methods-with-javatemplate\" rel=\"nofollow noreferrer\">look at JavaTemplate instead</a> of JavaParser. That has an API to actually create the LST elements that you need here.</p>\n"}],"owner":{"account_id":29044519,"reputation":3,"user_id":22248665,"display_name":"Bhavya Penumarthi"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":19,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689979502,"creation_date":1689978034,"question_id":76741547,"body_markdown":"I am trying to create a snippet using Java parser to add a if block.\r\n\r\n```java\r\nExpression condition = JavaParser.buildSnippet(\r\n    String.format(&quot;if (logger.%sEnabled())&quot;, logLevel)\r\n    ).get(0);\r\n```\r\n\r\nFor the above code, I am getting error in buildSnippet() method, stating its not found. I am using jdk 17 with rewrite-version 6.1.15\r\n\r\nI am expecting an alternative for JavaParser.buildSnippet() method","title":"Facing Error while creating a custom recipe to add log level guard","body":"<p>I am trying to create a snippet using Java parser to add a if block.</p>\n<pre class=\"lang-java prettyprint-override\"><code>Expression condition = JavaParser.buildSnippet(\n    String.format(&quot;if (logger.%sEnabled())&quot;, logLevel)\n    ).get(0);\n</code></pre>\n<p>For the above code, I am getting error in buildSnippet() method, stating its not found. I am using jdk 17 with rewrite-version 6.1.15</p>\n<p>I am expecting an alternative for JavaParser.buildSnippet() method</p>\n"},{"tags":["java","mysql","hibernate","spring-data-jpa"],"comments":[{"owner":{"account_id":5973669,"reputation":6765,"user_id":4695271,"accept_rate":69,"display_name":"x80486"},"score":1,"creation_date":1548757559,"post_id":54418827,"comment_id":95647374,"body_markdown":"What&#39;s the result if you don&#39;t use `?serverTimezone=UTC` in the connection string?","body":"What&#39;s the result if you don&#39;t use <code>?serverTimezone=UTC</code> in the connection string?"},{"owner":{"account_id":3339332,"reputation":694,"user_id":2805930,"accept_rate":19,"display_name":"Hareesh"},"score":0,"creation_date":1548757865,"post_id":54418827,"comment_id":95647573,"body_markdown":"whats type of column in the table?","body":"whats type of column in the table?"},{"owner":{"account_id":13824888,"reputation":143,"user_id":9979475,"display_name":"George"},"score":0,"creation_date":1548759938,"post_id":54418827,"comment_id":95648868,"body_markdown":"@Hareesh the column is of type date.","body":"@Hareesh the column is of type date."},{"owner":{"account_id":13824888,"reputation":143,"user_id":9979475,"display_name":"George"},"score":0,"creation_date":1548760052,"post_id":54418827,"comment_id":95648933,"body_markdown":"@x80486 without `?serverTimezone=UTC` throws `Caused by: com.mysql.cj.exceptions.InvalidConnectionAttributeException: The server time zone value &#39;Jerusalem Standard Time&#39; is unrecognized or represents more than one time zone. You must configure either the server or JDBC driver (via the serverTimezone configuration property) to use a more specifc time zone value if you want to utilize time zone support.`","body":"@x80486 without <code>?serverTimezone=UTC</code> throws <code>Caused by: com.mysql.cj.exceptions.InvalidConnectionAttributeException: The server time zone value &#39;Jerusalem Standard Time&#39; is unrecognized or represents more than one time zone. You must configure either the server or JDBC driver (via the serverTimezone configuration property) to use a more specifc time zone value if you want to utilize time zone support.</code>"},{"owner":{"account_id":1434762,"reputation":22772,"user_id":1356423,"accept_rate":65,"display_name":"Alan Hay"},"score":0,"creation_date":1548760140,"post_id":54418827,"comment_id":95648984,"body_markdown":"So what&#39;s the value in the database?","body":"So what&#39;s the value in the database?"},{"owner":{"account_id":13824888,"reputation":143,"user_id":9979475,"display_name":"George"},"score":0,"creation_date":1548763954,"post_id":54418827,"comment_id":95651225,"body_markdown":"@AlanHay the value in the database is `2019-01-28`. When save&amp;return by `coupon = repository.saveAndFlush(...)` the date is still `2019-01-29` passing first two assertEquals(...). But, when retrieve from database by `Coupon returned = repository.findByName(...)` the date is changed to `2019-01-28` in both fields and the database.","body":"@AlanHay the value in the database is <code>2019-01-28</code>. When save&amp;return by <code>coupon = repository.saveAndFlush(...)</code> the date is still <code>2019-01-29</code> passing first two assertEquals(...). But, when retrieve from database by <code>Coupon returned = repository.findByName(...)</code> the date is changed to <code>2019-01-28</code> in both fields and the database."},{"owner":{"account_id":1434762,"reputation":22772,"user_id":1356423,"accept_rate":65,"display_name":"Alan Hay"},"score":0,"creation_date":1548765166,"post_id":54418827,"comment_id":95651921,"body_markdown":"Coupon and the coupon returned by saveAndFlush are the same instance so that is not really telling you anything. The first 2 asserts are against the in-memory model and tells you nothing about the database. Your issue is almost certainly around timezones.","body":"Coupon and the coupon returned by saveAndFlush are the same instance so that is not really telling you anything. The first 2 asserts are against the in-memory model and tells you nothing about the database. Your issue is almost certainly around timezones."},{"owner":{"account_id":13824888,"reputation":143,"user_id":9979475,"display_name":"George"},"score":0,"creation_date":1548768544,"post_id":54418827,"comment_id":95654102,"body_markdown":"@AlanHay Thank you I wasn&#39;t aware of that. Misunderstood the repository.save()/.saveAndFlush() functions. Thought they return the object from database after save with generated primary key.    Tested with different dates and all return a day earlier e.g. saving `2019-02-03` becomes `2019-02-02` in db.  \n  Does this help to find the timezone issue ? `SELECT @@GLOBAL.time_zone, @@session.time_zone, @@system_time_zone;` result `SYSTEM\tSYSTEM\tJerusalem Standard Time`.  Additionally, used `SELECT TIMEDIFF(NOW(), UTC_TIMESTAMP) as GMT_TIME_DIFF;` result `02:00:00`","body":"@AlanHay Thank you I wasn&#39;t aware of that. Misunderstood the repository.save()/.saveAndFlush() functions. Thought they return the object from database after save with generated primary key.    Tested with different dates and all return a day earlier e.g. saving <code>2019-02-03</code> becomes <code>2019-02-02</code> in db.     Does this help to find the timezone issue ? <code>SELECT @@GLOBAL.time_zone, @@session.time_zone, @@system_time_zone;</code> result <code>SYSTEM\tSYSTEM\tJerusalem Standard Time</code>.  Additionally, used <code>SELECT TIMEDIFF(NOW(), UTC_TIMESTAMP) as GMT_TIME_DIFF;</code> result <code>02:00:00</code>"},{"owner":{"account_id":8201951,"reputation":1790,"user_id":9424793,"display_name":"Andr&#233; Pacheco"},"score":0,"creation_date":1549545486,"post_id":54418827,"comment_id":95946207,"body_markdown":"I&#39;m facing the same problem and this solution doesn&#39;t work for me. I described what&#39;s happening [here](https://stackoverflow.com/questions/54561638/date-issue-in-spring-boot-data-rest). If you guys have some hint, I&#39;ll appreciate hearing that.","body":"I&#39;m facing the same problem and this solution doesn&#39;t work for me. I described what&#39;s happening <a href=\"https://stackoverflow.com/questions/54561638/date-issue-in-spring-boot-data-rest\">here</a>. If you guys have some hint, I&#39;ll appreciate hearing that."}],"answers":[{"tags":[],"owner":{"account_id":11255785,"reputation":21,"user_id":8255638,"display_name":"Jorik Kozor&#243;h"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1548777055,"creation_date":1548777055,"answer_id":54424813,"question_id":54418827,"body_markdown":"I Have the same problem in Wildfly 13, this is my datasource:\r\n\r\n           &lt;datasource jndi-name=&quot;java:/comp/env/isobit&quot; pool-name=&quot;isobit-dev&quot; enabled=&quot;true&quot; use-java-context=&quot;true&quot;&gt;\r\n                    &lt;connection-url&gt;jdbc:mysql://localhost:3306/isobit?zeroDateTimeBehavior=convertToNull&amp;amp;useUnicode=true&amp;amp;useJDBCCompliantTimezoneShift=true&amp;amp;useLegacyDatetimeCode=false&amp;amp;serverTimezone=UTC&lt;/connection-url&gt;\r\n                    &lt;driver&gt;mysql-connector-java-8.0.13.jar&lt;/driver&gt;\r\n                 \r\nThen change the driver to mysql-connector-java-5.1.23-bin.jar and in my standalone.xml\r\n\r\n                 &lt;datasource jndi-name=&quot;java:/comp/env/isobit&quot; pool-name=&quot;isobit-dev&quot; enabled=&quot;true&quot; use-java-context=&quot;true&quot;&gt;\r\n                    &lt;connection-url&gt;jdbc:mysql://localhost:3306/isobit?zeroDateTimeBehavior=convertToNull&lt;/connection-url&gt;\r\n                    &lt;driver&gt;mysql-connector-java-5.1.23-bin.jar&lt;/driver&gt;\r\n                    &lt;security&gt;\r\n                        &lt;user-name&gt;root&lt;/user-name&gt;\r\n                        &lt;password&gt;root&lt;/password&gt;\r\n                    &lt;/security&gt;\r\n                &lt;/datasource&gt;\r\n\r\nNow the dates are the right. \r\n","title":"MySQL Date Changes to Yesterday&#39;s date After JPA Save","body":"<p>I Have the same problem in Wildfly 13, this is my datasource:</p>\n\n<pre><code>       &lt;datasource jndi-name=\"java:/comp/env/isobit\" pool-name=\"isobit-dev\" enabled=\"true\" use-java-context=\"true\"&gt;\n                &lt;connection-url&gt;jdbc:mysql://localhost:3306/isobit?zeroDateTimeBehavior=convertToNull&amp;amp;useUnicode=true&amp;amp;useJDBCCompliantTimezoneShift=true&amp;amp;useLegacyDatetimeCode=false&amp;amp;serverTimezone=UTC&lt;/connection-url&gt;\n                &lt;driver&gt;mysql-connector-java-8.0.13.jar&lt;/driver&gt;\n</code></pre>\n\n<p>Then change the driver to mysql-connector-java-5.1.23-bin.jar and in my standalone.xml</p>\n\n<pre><code>             &lt;datasource jndi-name=\"java:/comp/env/isobit\" pool-name=\"isobit-dev\" enabled=\"true\" use-java-context=\"true\"&gt;\n                &lt;connection-url&gt;jdbc:mysql://localhost:3306/isobit?zeroDateTimeBehavior=convertToNull&lt;/connection-url&gt;\n                &lt;driver&gt;mysql-connector-java-5.1.23-bin.jar&lt;/driver&gt;\n                &lt;security&gt;\n                    &lt;user-name&gt;root&lt;/user-name&gt;\n                    &lt;password&gt;root&lt;/password&gt;\n                &lt;/security&gt;\n            &lt;/datasource&gt;\n</code></pre>\n\n<p>Now the dates are the right. </p>\n"},{"tags":[],"owner":{"account_id":3339332,"reputation":694,"user_id":2805930,"accept_rate":19,"display_name":"Hareesh"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1548829033,"creation_date":1548829033,"answer_id":54434379,"question_id":54418827,"body_markdown":"I think its because of Timezone problem. Locale Date do not consider the timezone as you already know. But In the database, I guess the date is associated with Timezone. The JPA/Hibernate layer will convert the LocaleDate to TimeStamp( default it will take JVM timezone during the conversion ). The timezone that your running the application is different from the database timezone, due to this there is mismatch.\r\n\r\nTo confirm on this, set the timezone of the running machine to UTC.","title":"MySQL Date Changes to Yesterday&#39;s date After JPA Save","body":"<p>I think its because of Timezone problem. Locale Date do not consider the timezone as you already know. But In the database, I guess the date is associated with Timezone. The JPA/Hibernate layer will convert the LocaleDate to TimeStamp( default it will take JVM timezone during the conversion ). The timezone that your running the application is different from the database timezone, due to this there is mismatch.</p>\n\n<p>To confirm on this, set the timezone of the running machine to UTC.</p>\n"},{"tags":[],"owner":{"account_id":13824888,"reputation":143,"user_id":9979475,"display_name":"George"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1548836360,"creation_date":1548836360,"answer_id":54436027,"question_id":54418827,"body_markdown":"Thanks for your help. As noted and answered above, it was a **Timezone issue**. \n\n## Solution: ##\n1. Set in MySQL `SET GLOBAL time_zone = &#39;+02:00&#39;;&quot;;`\n2. Remove `?serverTimezone=UTC` from `spring.datasource.url=jdbc:mysql://localhost:3306/schema_name`\n\nFound these MySQL commands useful:\n`SELECT @@GLOBAL.time_zone, @@session.time_zone, @@system_time_zone;` and \n`SELECT TIMEDIFF(NOW(), UTC_TIMESTAMP) as GMT_TIME_DIFF;`\n\nAdditional information &lt;https://stackoverflow.com/questions/19023978/should-mysql-have-its-timezone-set-to-utc/19075291#19075291&gt; and in the [MySQL Documentaion](https://dev.mysql.com/doc/mysql-g11n-excerpt/5.7/en/time-zone-support.html).\n \n### Workaround ###\nAs answered above, changing the Spring Boot default `mysql-connector-java` in *pom.xml*:\n```\n&lt;dependency&gt;\n &lt;groupId&gt;mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n            &lt;version&gt;5.1.47&lt;/&gt;\n&lt;/dependency&gt;\n```\nAnd the driver to `spring.datasource.driverClassName=com.mysql.jdbc.Driver` in *properties* file also returned the proper date. ","title":"MySQL Date Changes to Yesterday&#39;s date After JPA Save","body":"<p>Thanks for your help. As noted and answered above, it was a <strong>Timezone issue</strong>.</p>\n<h2>Solution:</h2>\n<ol>\n<li>Set in MySQL <code>SET GLOBAL time_zone = '+02:00';&quot;;</code></li>\n<li>Remove <code>?serverTimezone=UTC</code> from <code>spring.datasource.url=jdbc:mysql://localhost:3306/schema_name</code></li>\n</ol>\n<p>Found these MySQL commands useful:\n<code>SELECT @@GLOBAL.time_zone, @@session.time_zone, @@system_time_zone;</code> and\n<code>SELECT TIMEDIFF(NOW(), UTC_TIMESTAMP) as GMT_TIME_DIFF;</code></p>\n<p>Additional information <a href=\"https://stackoverflow.com/questions/19023978/should-mysql-have-its-timezone-set-to-utc/19075291#19075291\">Should MySQL have its timezone set to UTC?</a> and in the <a href=\"https://dev.mysql.com/doc/mysql-g11n-excerpt/5.7/en/time-zone-support.html\" rel=\"nofollow noreferrer\">MySQL Documentaion</a>.</p>\n<h3>Workaround</h3>\n<p>As answered above, changing the Spring Boot default <code>mysql-connector-java</code> in <em>pom.xml</em>:</p>\n<pre><code>&lt;dependency&gt;\n &lt;groupId&gt;mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n            &lt;version&gt;5.1.47&lt;/&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>And the driver to <code>spring.datasource.driverClassName=com.mysql.jdbc.Driver</code> in <em>properties</em> file also returned the proper date.</p>\n"},{"tags":[],"owner":{"account_id":12663702,"reputation":11,"user_id":9203726,"display_name":"livingobjects"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1565585229,"creation_date":1565585229,"answer_id":57455753,"question_id":54418827,"body_markdown":"Convert the Date field to TimeStamp will fix the issue and make sure you pass the timezone through spring properties file\r\n\r\nspring.jpa.properties.hibernate.jdbc.time_zone=GMT+10\r\n","title":"MySQL Date Changes to Yesterday&#39;s date After JPA Save","body":"<p>Convert the Date field to TimeStamp will fix the issue and make sure you pass the timezone through spring properties file</p>\n\n<p>spring.jpa.properties.hibernate.jdbc.time_zone=GMT+10</p>\n"},{"tags":[],"owner":{"account_id":13483170,"reputation":521,"user_id":9727794,"display_name":"hamza saber"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1571829505,"creation_date":1571829505,"answer_id":58521666,"question_id":54418827,"body_markdown":"In my country, the time is GMT+1 and I had the same issue.\r\n\r\nWhat i did first is `serverTimezone=GMT+1` which gives me error.\r\n\r\nBut JDBC uses a so-called &quot;connection URL&quot;, so you can escape &quot;+&quot; by &quot;%2B&quot;, that is\r\n\r\n    db.url=jdbc:mysql://localhost:3306/MyDB?useSSL=false&amp;serverTimezone=GMT%2B1&amp;useLegacyDatetimeCode=false\r\n\r\nP.S: check this [Why useLegacyDatetimeCode=false][1] to unserstand more.\r\n\r\nHope it helps someone. If it does don&#39;t forget to Up Vote this.\r\n\r\n\r\n  [1]: https://www.baeldung.com/mysql-jdbc-timezone-spring-boot","title":"MySQL Date Changes to Yesterday&#39;s date After JPA Save","body":"<p>In my country, the time is GMT+1 and I had the same issue.</p>\n\n<p>What i did first is <code>serverTimezone=GMT+1</code> which gives me error.</p>\n\n<p>But JDBC uses a so-called \"connection URL\", so you can escape \"+\" by \"%2B\", that is</p>\n\n<pre><code>db.url=jdbc:mysql://localhost:3306/MyDB?useSSL=false&amp;serverTimezone=GMT%2B1&amp;useLegacyDatetimeCode=false\n</code></pre>\n\n<p>P.S: check this <a href=\"https://www.baeldung.com/mysql-jdbc-timezone-spring-boot\" rel=\"nofollow noreferrer\">Why useLegacyDatetimeCode=false</a> to unserstand more.</p>\n\n<p>Hope it helps someone. If it does don't forget to Up Vote this.</p>\n"},{"tags":[],"owner":{"account_id":11657675,"reputation":996,"user_id":8536903,"display_name":"Lukk17s"},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1585424916,"creation_date":1585424916,"answer_id":60906163,"question_id":54418827,"body_markdown":"If your timezone is for example \r\n\r\n    Europe/Warsaw\r\n\r\nyou can set:\r\n\r\n    spring.datasource.url=jdbc:mysql://localhost:3306/database?serverTimezone=Europe/Warsaw\r\n\r\ninstead of this:\r\n\r\n    spring.datasource.url=jdbc:mysql://localhost:3306/database?serverTimezone=UTC\r\n\r\nbut you can also add one more entry in application.properties:\r\n\r\n    spring.jpa.properties.hibernate.jdbc.time_zone=Europe/Warsaw","title":"MySQL Date Changes to Yesterday&#39;s date After JPA Save","body":"<p>If your timezone is for example </p>\n\n<pre><code>Europe/Warsaw\n</code></pre>\n\n<p>you can set:</p>\n\n<pre><code>spring.datasource.url=jdbc:mysql://localhost:3306/database?serverTimezone=Europe/Warsaw\n</code></pre>\n\n<p>instead of this:</p>\n\n<pre><code>spring.datasource.url=jdbc:mysql://localhost:3306/database?serverTimezone=UTC\n</code></pre>\n\n<p>but you can also add one more entry in application.properties:</p>\n\n<pre><code>spring.jpa.properties.hibernate.jdbc.time_zone=Europe/Warsaw\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9228721,"reputation":1203,"user_id":6855603,"display_name":"estn"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1689978391,"creation_date":1588939472,"answer_id":61678763,"question_id":54418827,"body_markdown":"This issue occured again in Spring Boot 2.2.7 - root cause seems to be bug in MySQL Connector version 8.0.20. \r\n\r\nI reported this to Oracle: https://bugs.mysql.com/bug.php?id=99487\r\n\r\nPer the bug, the issue can be worked around by setting `cacheDefaultTimezone=false`.\r\n\r\nAlternatively, downgrading to MySQL Connector to 8.0.19 works:\r\n\r\n```lang-xml\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;mysql&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\r\n\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t&lt;version&gt;8.0.19&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```\r\n","title":"MySQL Date Changes to Yesterday&#39;s date After JPA Save","body":"<p>This issue occured again in Spring Boot 2.2.7 - root cause seems to be bug in MySQL Connector version 8.0.20.</p>\n<p>I reported this to Oracle: <a href=\"https://bugs.mysql.com/bug.php?id=99487\" rel=\"nofollow noreferrer\">https://bugs.mysql.com/bug.php?id=99487</a></p>\n<p>Per the bug, the issue can be worked around by setting <code>cacheDefaultTimezone=false</code>.</p>\n<p>Alternatively, downgrading to MySQL Connector to 8.0.19 works:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;mysql&lt;/groupId&gt;\n    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;version&gt;8.0.19&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":17254818,"reputation":169,"user_id":12494167,"display_name":"Shaikh Nazish"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1596654301,"creation_date":1596654301,"answer_id":63271935,"question_id":54418827,"body_markdown":"To solve this issue we simply have to set the server timezone to UTC as the timezone differs at every place.\r\n\r\nAdd or update the following line in application.properties file:\r\n\r\n**spring.datasource.url=jdbc:mysql://localhost:3306/test_coupon_system?serverTimezone=UTC**","title":"MySQL Date Changes to Yesterday&#39;s date After JPA Save","body":"<p>To solve this issue we simply have to set the server timezone to UTC as the timezone differs at every place.</p>\n<p>Add or update the following line in application.properties file:</p>\n<p><strong>spring.datasource.url=jdbc:mysql://localhost:3306/test_coupon_system?serverTimezone=UTC</strong></p>\n"},{"tags":[],"owner":{"account_id":155681,"reputation":7205,"user_id":372496,"accept_rate":86,"display_name":"Ganesh Krishnan"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1611676893,"creation_date":1611676893,"answer_id":65904767,"question_id":54418827,"body_markdown":"**Timezone mismatch** between your Java code which runs on your Local Timezone vs MySQL which is in UTC timezone.\r\n\r\nDepending on your timezone this day difference only happens during specific hours when your day is different from UTC.\r\n\r\nChange the connection string in MySQL to the same timezone as your computer.\r\n","title":"MySQL Date Changes to Yesterday&#39;s date After JPA Save","body":"<p><strong>Timezone mismatch</strong> between your Java code which runs on your Local Timezone vs MySQL which is in UTC timezone.</p>\n<p>Depending on your timezone this day difference only happens during specific hours when your day is different from UTC.</p>\n<p>Change the connection string in MySQL to the same timezone as your computer.</p>\n"}],"owner":{"account_id":13824888,"reputation":143,"user_id":9979475,"display_name":"George"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":11081,"favorite_count":0,"down_vote_count":0,"up_vote_count":9,"accepted_answer_id":54434379,"answer_count":9,"score":9,"last_activity_date":1689978391,"creation_date":1548757434,"question_id":54418827,"body_markdown":"### I have encountered a problem with a date field/database column while using Spring&#39;s JpaRepository to save an entity to MySQL. ###\nThe entity has LocalDate fields. When testing with LocalDate.now(), encountered a problem with the returned Date field:\n\n1. First save the returned object&#39;s date is correct. \n2. When return the object from MySQL database the date is a day before\n\nExample:\n\nExpected :2019-01-29\n\nActual   :2019-01-28\n\n\nI have tried it yesterday and results were:\n\nExpected :2019-01-28\n\nActual   :2019-01-27\n\nMaybe similar to the this &lt;https://stackoverflow.com/questions/41938999/jpa-saving-wrong-date-in-mysql-database&gt;\n\n### Code ###\n**application-mysql-test-connection.properties**\n```\nspring.jpa.hibernate.ddl-auto=create\n\n# Database url\nspring.datasource.url=jdbc:mysql://localhost:3306/test_coupon_system?serverTimezone=UTC\n\nspring.datasource.driverClassName=com.mysql.cj.jdbc.Driver\n\n# Test Database credentials\nspring.datasource.username=springuser\nspring.datasource.password=springuser\n\n### showing values - for development\nspring.jpa.show-sql=true\n```\n**Coupon** removed constructor &amp; getter/setter for brevity \n```\n@Entity\npublic class Coupon {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = &quot;id&quot;, length = 45)\n    private long id;\n\n\n    @Column(name = &quot;name&quot;, unique = true, nullable = false, length = 45)\n    private String name;\n\n    @Column(name = &quot;description&quot;, length = 100)\n    private String description;\n\n    @Column(name = &quot;imageLocation&quot;)\n    private String imageLocation;\n\n    @Column(name = &quot;startDate&quot;, length = 45)\n    private LocalDate startDate;\n\n    @Column(name = &quot;endDate&quot;, length = 45)\n    private LocalDate endDate;\n\n    @ManyToOne(cascade = CascadeType.PERSIST)\n    @JoinColumn(name = &quot;company_id&quot;)\n    private Company company;\n\n    @ManyToMany(cascade = CascadeType.PERSIST,fetch = FetchType.EAGER)\n    @JoinTable(\n            name = &quot;customer_coupon&quot;,\n            joinColumns = @JoinColumn(name = &quot;coupon_id&quot;),\n            inverseJoinColumns = @JoinColumn(name = &quot;customer_id&quot;)\n    )\n    private List&lt;Customer&gt; customers;\n```\n**CouponRepository**\n```\n@Repository\npublic interface CouponRepository extends JpaRepository&lt;Coupon, Long&gt; {\n\n    Coupon findByName(String name);\n}\n```\n\n**Test Class** with printout\n```\n@SpringBootTest\n@TestPropertySource(locations = {\n        &quot;classpath:application-mysql-test-connection.properties&quot;,\n})\npublic class CouponDateIT {\n\n    @Autowired\n    private CouponRepository repository;\n\n    @BeforeEach\n    void setUp() {\n        repository.deleteAll();\n    }\n\n    @Test\n    void returnsLocalDate() {\n        LocalDate testDate = LocalDate.now();\n\n        DateTime.now();\n        Coupon coupon = new Coupon();\n        String couponName = &quot;test1&quot;;\n        coupon.setName(couponName);\n        coupon.setStartDate(LocalDate.now());\n        coupon.setEndDate(LocalDate.now());\n        coupon = repository.saveAndFlush(coupon);\n\n        System.out.println(&quot;===&gt; test date &quot; + testDate);\n        System.out.println(&quot;===&gt; coupon from db &quot; + coupon);\n\n        assertEquals(testDate, coupon.getStartDate());\n        assertEquals(testDate, coupon.getEndDate());\n\n        Coupon returned = repository.findByName(couponName);\n        System.out.println(&quot;===&gt; after save &quot; + returned);\n        assertEquals(testDate, returned.getStartDate());\n        assertEquals(testDate, returned.getEndDate());\n    }\n```\n\n**Failing Test**\n```\nHibernate: select coupon0_.id as id1_1_, coupon0_.company_id as company_7_1_, coupon0_.description as descript2_1_, coupon0_.end_date as end_date3_1_, coupon0_.image_location as image_lo4_1_, coupon0_.name as name5_1_, coupon0_.start_date as start_da6_1_ from coupon coupon0_\nHibernate: select next_val as id_val from hibernate_sequence for update\nHibernate: update hibernate_sequence set next_val= ? where next_val=?\nHibernate: insert into coupon (company_id, description, end_date, image_location, name, start_date, id) values (?, ?, ?, ?, ?, ?, ?)\n===&gt; test date 2019-01-29\n===&gt; coupon from db Coupon{id=1, name=&#39;test1&#39;, description=&#39;null&#39;, imageLocation=&#39;null&#39;, startDate=2019-01-29, endDate=2019-01-29}\nHibernate: select coupon0_.id as id1_1_, coupon0_.company_id as company_7_1_, coupon0_.description as descript2_1_, coupon0_.end_date as end_date3_1_, coupon0_.image_location as image_lo4_1_, coupon0_.name as name5_1_, coupon0_.start_date as start_da6_1_ from coupon coupon0_ where coupon0_.name=?\nHibernate: select customers0_.coupon_id as coupon_i2_3_0_, customers0_.customer_id as customer1_3_0_, customer1_.id as id1_2_1_, customer1_.email as email2_2_1_, customer1_.name as name3_2_1_ from customer_coupon customers0_ inner join customer customer1_ on customers0_.customer_id=customer1_.id where customers0_.coupon_id=?\n===&gt; after save Coupon{id=1, name=&#39;test1&#39;, description=&#39;null&#39;, imageLocation=&#39;null&#39;, startDate=2019-01-28, endDate=2019-01-28}\n\njava.lang.AssertionError: expected:&lt;2019-01-29&gt; but was:&lt;2019-01-28&gt;\nExpected :2019-01-29\nActual   :2019-01-28\n```\n\n**Log before test with**\n```\n2019-01-29 11:26:07.986  INFO 6576 --- [           main] g.f.d.s.database.CouponDateIT            : No active profile set, falling back to default profiles: default\n2019-01-29 11:26:09.235  INFO 6576 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data repositories in DEFAULT mode.\n2019-01-29 11:26:09.308  INFO 6576 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 73ms. Found 3 repository interfaces.\n2019-01-29 11:26:09.762  INFO 6576 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean &#39;org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration&#39; of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerBySpringCGLIB$$70fe81c1] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)\n2019-01-29 11:26:09.981  INFO 6576 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...\n2019-01-29 11:26:10.894  INFO 6576 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.\n2019-01-29 11:26:10.957  INFO 6576 --- [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [\n    name: default\n    ...]\n2019-01-29 11:26:11.019  INFO 6576 --- [           main] org.hibernate.Version                    : HHH000412: Hibernate Core {5.3.7.Final}\n2019-01-29 11:26:11.019  INFO 6576 --- [           main] org.hibernate.cfg.Environment            : HHH000206: hibernate.properties not found\n2019-01-29 11:26:11.191  INFO 6576 --- [           main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.0.4.Final}\n2019-01-29 11:26:11.341  INFO 6576 --- [           main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5Dialect\n2019-01-29 11:26:11.591  WARN 6576 --- [           main] org.hibernate.mapping.RootClass          : HHH000038: Composite-id class does not override equals(): .entity.Customer_Coupon\n2019-01-29 11:26:11.591  WARN 6576 --- [           main] org.hibernate.mapping.RootClass          : HHH000039: Composite-id class does not override hashCode(): .entity.Customer_Coupon\nHibernate: drop table if exists company\nHibernate: drop table if exists coupon\nHibernate: drop table if exists customer\nHibernate: drop table if exists customer_coupon\nHibernate: drop table if exists hibernate_sequence\nHibernate: create table company (id bigint not null, email varchar(45) not null, name varchar(45) not null, password varchar(45) not null, primary key (id)) engine=MyISAM\nHibernate: alter table company add constraint UK_bma9lv19ba3yjwf12a34xord3 unique (email)\nHibernate: alter table company add constraint UK_niu8sfil2gxywcru9ah3r4ec5 unique (name)\nHibernate: create table coupon (id bigint not null, description varchar(100), end_date date, image_location varchar(255), name varchar(45) not null, start_date date, company_id bigint, primary key (id)) engine=MyISAM\nHibernate: create table customer (id integer not null, email varchar(45) not null, name varchar(45) not null, primary key (id)) engine=MyISAM\nHibernate: create table customer_coupon (customer_id bigint not null, coupon_id bigint not null, primary key (customer_id, coupon_id)) engine=MyISAM\nHibernate: create table hibernate_sequence (next_val bigint) engine=MyISAM\nHibernate: insert into hibernate_sequence values ( 1 )\nHibernate: insert into hibernate_sequence values ( 1 )\nHibernate: insert into hibernate_sequence values ( 1 )\nHibernate: insert into hibernate_sequence values ( 1 )\nHibernate: insert into hibernate_sequence values ( 1 )\nHibernate: alter table coupon add constraint UK_dfikvnp7dxdfishfvpnlc0xc1 unique (name)\nHibernate: alter table customer add constraint UK_dwk6cx0afu8bs9o4t536v1j5v unique (email)\nHibernate: alter table customer add constraint UK_crkjmjk1oj8gb6j6t5kt7gcxm unique (name)\nHibernate: alter table coupon add constraint FKe2v6qnb3w90rekqrae28iiqhm foreign key (company_id) references company (id)\nHibernate: alter table customer_coupon add constraint FKppndqdpydmsumc9yqslm5hss4 foreign key (coupon_id) references coupon (id)\nHibernate: alter table customer_coupon add constraint FKi755t5tde9sf6nrp4rm2rnnmn foreign key (customer_id) references customer (id)\n2019-01-29 11:26:12.515  INFO 6576 --- [           main] o.h.t.schema.internal.SchemaCreatorImpl  : HHH000476: Executing import script &#39;ScriptSourceInputFromUrl(/import.sql)&#39;\n2019-01-29 11:26:12.515  INFO 6576 --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit &#39;default&#39;\n2019-01-29 11:26:12.812  INFO 6576 --- [           main] o.h.h.i.QueryTranslatorFactoryInitiator  : HHH000397: Using ASTQueryTranslatorFactory\n2019-01-29 11:26:13.747  INFO 6576 --- [           main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService &#39;applicationTaskExecutor&#39;\n2019-01-29 11:26:13.793  WARN 6576 --- [           main] aWebConfiguration$JpaWebMvcConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning\n2019-01-29 11:26:14.592  INFO 6576 --- [           main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path &#39;/actuator&#39;\n2019-01-29 11:26:14.655  INFO 6576 --- [           main] g.f.d.s.database.CouponDateIT            : Started CouponDateIT in 6.985 seconds (JVM running for 8.059)\n```\n\n&lt;b&gt;I am expecting the date field not to change after saving and returning it, but the date keeps changing to yesterday&#39;s AFTER saving the coupon.&lt;/b&gt; \n\n","title":"MySQL Date Changes to Yesterday&#39;s date After JPA Save","body":"<h3>I have encountered a problem with a date field/database column while using Spring's JpaRepository to save an entity to MySQL.</h3>\n<p>The entity has LocalDate fields. When testing with LocalDate.now(), encountered a problem with the returned Date field:</p>\n<ol>\n<li>First save the returned object's date is correct.</li>\n<li>When return the object from MySQL database the date is a day before</li>\n</ol>\n<p>Example:</p>\n<p>Expected :2019-01-29</p>\n<p>Actual   :2019-01-28</p>\n<p>I have tried it yesterday and results were:</p>\n<p>Expected :2019-01-28</p>\n<p>Actual   :2019-01-27</p>\n<p>Maybe similar to the this <a href=\"https://stackoverflow.com/questions/41938999/jpa-saving-wrong-date-in-mysql-database\">JPA Saving wrong date in MySQL database</a></p>\n<h3>Code</h3>\n<p><strong>application-mysql-test-connection.properties</strong></p>\n<pre><code>spring.jpa.hibernate.ddl-auto=create\n\n# Database url\nspring.datasource.url=jdbc:mysql://localhost:3306/test_coupon_system?serverTimezone=UTC\n\nspring.datasource.driverClassName=com.mysql.cj.jdbc.Driver\n\n# Test Database credentials\nspring.datasource.username=springuser\nspring.datasource.password=springuser\n\n### showing values - for development\nspring.jpa.show-sql=true\n</code></pre>\n<p><strong>Coupon</strong> removed constructor &amp; getter/setter for brevity</p>\n<pre><code>@Entity\npublic class Coupon {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = &quot;id&quot;, length = 45)\n    private long id;\n\n\n    @Column(name = &quot;name&quot;, unique = true, nullable = false, length = 45)\n    private String name;\n\n    @Column(name = &quot;description&quot;, length = 100)\n    private String description;\n\n    @Column(name = &quot;imageLocation&quot;)\n    private String imageLocation;\n\n    @Column(name = &quot;startDate&quot;, length = 45)\n    private LocalDate startDate;\n\n    @Column(name = &quot;endDate&quot;, length = 45)\n    private LocalDate endDate;\n\n    @ManyToOne(cascade = CascadeType.PERSIST)\n    @JoinColumn(name = &quot;company_id&quot;)\n    private Company company;\n\n    @ManyToMany(cascade = CascadeType.PERSIST,fetch = FetchType.EAGER)\n    @JoinTable(\n            name = &quot;customer_coupon&quot;,\n            joinColumns = @JoinColumn(name = &quot;coupon_id&quot;),\n            inverseJoinColumns = @JoinColumn(name = &quot;customer_id&quot;)\n    )\n    private List&lt;Customer&gt; customers;\n</code></pre>\n<p><strong>CouponRepository</strong></p>\n<pre><code>@Repository\npublic interface CouponRepository extends JpaRepository&lt;Coupon, Long&gt; {\n\n    Coupon findByName(String name);\n}\n</code></pre>\n<p><strong>Test Class</strong> with printout</p>\n<pre><code>@SpringBootTest\n@TestPropertySource(locations = {\n        &quot;classpath:application-mysql-test-connection.properties&quot;,\n})\npublic class CouponDateIT {\n\n    @Autowired\n    private CouponRepository repository;\n\n    @BeforeEach\n    void setUp() {\n        repository.deleteAll();\n    }\n\n    @Test\n    void returnsLocalDate() {\n        LocalDate testDate = LocalDate.now();\n\n        DateTime.now();\n        Coupon coupon = new Coupon();\n        String couponName = &quot;test1&quot;;\n        coupon.setName(couponName);\n        coupon.setStartDate(LocalDate.now());\n        coupon.setEndDate(LocalDate.now());\n        coupon = repository.saveAndFlush(coupon);\n\n        System.out.println(&quot;===&gt; test date &quot; + testDate);\n        System.out.println(&quot;===&gt; coupon from db &quot; + coupon);\n\n        assertEquals(testDate, coupon.getStartDate());\n        assertEquals(testDate, coupon.getEndDate());\n\n        Coupon returned = repository.findByName(couponName);\n        System.out.println(&quot;===&gt; after save &quot; + returned);\n        assertEquals(testDate, returned.getStartDate());\n        assertEquals(testDate, returned.getEndDate());\n    }\n</code></pre>\n<p><strong>Failing Test</strong></p>\n<pre><code>Hibernate: select coupon0_.id as id1_1_, coupon0_.company_id as company_7_1_, coupon0_.description as descript2_1_, coupon0_.end_date as end_date3_1_, coupon0_.image_location as image_lo4_1_, coupon0_.name as name5_1_, coupon0_.start_date as start_da6_1_ from coupon coupon0_\nHibernate: select next_val as id_val from hibernate_sequence for update\nHibernate: update hibernate_sequence set next_val= ? where next_val=?\nHibernate: insert into coupon (company_id, description, end_date, image_location, name, start_date, id) values (?, ?, ?, ?, ?, ?, ?)\n===&gt; test date 2019-01-29\n===&gt; coupon from db Coupon{id=1, name='test1', description='null', imageLocation='null', startDate=2019-01-29, endDate=2019-01-29}\nHibernate: select coupon0_.id as id1_1_, coupon0_.company_id as company_7_1_, coupon0_.description as descript2_1_, coupon0_.end_date as end_date3_1_, coupon0_.image_location as image_lo4_1_, coupon0_.name as name5_1_, coupon0_.start_date as start_da6_1_ from coupon coupon0_ where coupon0_.name=?\nHibernate: select customers0_.coupon_id as coupon_i2_3_0_, customers0_.customer_id as customer1_3_0_, customer1_.id as id1_2_1_, customer1_.email as email2_2_1_, customer1_.name as name3_2_1_ from customer_coupon customers0_ inner join customer customer1_ on customers0_.customer_id=customer1_.id where customers0_.coupon_id=?\n===&gt; after save Coupon{id=1, name='test1', description='null', imageLocation='null', startDate=2019-01-28, endDate=2019-01-28}\n\njava.lang.AssertionError: expected:&lt;2019-01-29&gt; but was:&lt;2019-01-28&gt;\nExpected :2019-01-29\nActual   :2019-01-28\n</code></pre>\n<p><strong>Log before test with</strong></p>\n<pre><code>2019-01-29 11:26:07.986  INFO 6576 --- [           main] g.f.d.s.database.CouponDateIT            : No active profile set, falling back to default profiles: default\n2019-01-29 11:26:09.235  INFO 6576 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data repositories in DEFAULT mode.\n2019-01-29 11:26:09.308  INFO 6576 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 73ms. Found 3 repository interfaces.\n2019-01-29 11:26:09.762  INFO 6576 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerBySpringCGLIB$$70fe81c1] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)\n2019-01-29 11:26:09.981  INFO 6576 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...\n2019-01-29 11:26:10.894  INFO 6576 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.\n2019-01-29 11:26:10.957  INFO 6576 --- [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [\n    name: default\n    ...]\n2019-01-29 11:26:11.019  INFO 6576 --- [           main] org.hibernate.Version                    : HHH000412: Hibernate Core {5.3.7.Final}\n2019-01-29 11:26:11.019  INFO 6576 --- [           main] org.hibernate.cfg.Environment            : HHH000206: hibernate.properties not found\n2019-01-29 11:26:11.191  INFO 6576 --- [           main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.0.4.Final}\n2019-01-29 11:26:11.341  INFO 6576 --- [           main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5Dialect\n2019-01-29 11:26:11.591  WARN 6576 --- [           main] org.hibernate.mapping.RootClass          : HHH000038: Composite-id class does not override equals(): .entity.Customer_Coupon\n2019-01-29 11:26:11.591  WARN 6576 --- [           main] org.hibernate.mapping.RootClass          : HHH000039: Composite-id class does not override hashCode(): .entity.Customer_Coupon\nHibernate: drop table if exists company\nHibernate: drop table if exists coupon\nHibernate: drop table if exists customer\nHibernate: drop table if exists customer_coupon\nHibernate: drop table if exists hibernate_sequence\nHibernate: create table company (id bigint not null, email varchar(45) not null, name varchar(45) not null, password varchar(45) not null, primary key (id)) engine=MyISAM\nHibernate: alter table company add constraint UK_bma9lv19ba3yjwf12a34xord3 unique (email)\nHibernate: alter table company add constraint UK_niu8sfil2gxywcru9ah3r4ec5 unique (name)\nHibernate: create table coupon (id bigint not null, description varchar(100), end_date date, image_location varchar(255), name varchar(45) not null, start_date date, company_id bigint, primary key (id)) engine=MyISAM\nHibernate: create table customer (id integer not null, email varchar(45) not null, name varchar(45) not null, primary key (id)) engine=MyISAM\nHibernate: create table customer_coupon (customer_id bigint not null, coupon_id bigint not null, primary key (customer_id, coupon_id)) engine=MyISAM\nHibernate: create table hibernate_sequence (next_val bigint) engine=MyISAM\nHibernate: insert into hibernate_sequence values ( 1 )\nHibernate: insert into hibernate_sequence values ( 1 )\nHibernate: insert into hibernate_sequence values ( 1 )\nHibernate: insert into hibernate_sequence values ( 1 )\nHibernate: insert into hibernate_sequence values ( 1 )\nHibernate: alter table coupon add constraint UK_dfikvnp7dxdfishfvpnlc0xc1 unique (name)\nHibernate: alter table customer add constraint UK_dwk6cx0afu8bs9o4t536v1j5v unique (email)\nHibernate: alter table customer add constraint UK_crkjmjk1oj8gb6j6t5kt7gcxm unique (name)\nHibernate: alter table coupon add constraint FKe2v6qnb3w90rekqrae28iiqhm foreign key (company_id) references company (id)\nHibernate: alter table customer_coupon add constraint FKppndqdpydmsumc9yqslm5hss4 foreign key (coupon_id) references coupon (id)\nHibernate: alter table customer_coupon add constraint FKi755t5tde9sf6nrp4rm2rnnmn foreign key (customer_id) references customer (id)\n2019-01-29 11:26:12.515  INFO 6576 --- [           main] o.h.t.schema.internal.SchemaCreatorImpl  : HHH000476: Executing import script 'ScriptSourceInputFromUrl(/import.sql)'\n2019-01-29 11:26:12.515  INFO 6576 --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'\n2019-01-29 11:26:12.812  INFO 6576 --- [           main] o.h.h.i.QueryTranslatorFactoryInitiator  : HHH000397: Using ASTQueryTranslatorFactory\n2019-01-29 11:26:13.747  INFO 6576 --- [           main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'applicationTaskExecutor'\n2019-01-29 11:26:13.793  WARN 6576 --- [           main] aWebConfiguration$JpaWebMvcConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning\n2019-01-29 11:26:14.592  INFO 6576 --- [           main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'\n2019-01-29 11:26:14.655  INFO 6576 --- [           main] g.f.d.s.database.CouponDateIT            : Started CouponDateIT in 6.985 seconds (JVM running for 8.059)\n</code></pre>\n<p><b>I am expecting the date field not to change after saving and returning it, but the date keeps changing to yesterday's AFTER saving the coupon.</b></p>\n"},{"tags":["javascript","java","jar","electron"],"owner":{"account_id":27562039,"reputation":287,"user_id":21034926,"display_name":"ICTDEV"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":64,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689977455,"creation_date":1689322110,"question_id":76685845,"body_markdown":"I have this code inside my electron app. I need to run a [jar file][1] and that will do a conversion job of some documents from  docx to pdf\r\n\r\n```lang-js\r\nfor (let p = 0; p &lt; docPaths.length; p++ ) {\r\n    const jar = childProcess.spawn(`java -jar docs-to-pdf-converter-1.7.jar -i ${docPaths[p]}, -o ${docPaths[p].replace(&#39;.docx&#39;, &#39;.pdf&#39;)}`);\r\n    //\r\n    jar.stderr.on(&#39;error&#39;, () =&gt; {\r\n\r\n    });\r\n    //\r\n    jar.stdout.on(&#39;data&#39;, (data) =&gt; {\r\n        console.log(data);\r\n    });\r\n    //\r\n    jar.on(&#39;exit&#39;, (code) =&gt; {\r\n        console.log(&#39;jar ok&#39;, code);\r\n    });\r\n}\r\n```\r\n\r\nWhen I run the electron app I will get always this error\r\n\r\n[![Error screenshot][2]][2]\r\n\r\nIs possible to run a java file from an electron app? what I need to do exactli, use `exec` instead of `spawn`?\r\n\r\n  [1]: https://github.com/yeokm1/docs-to-pdf-converter\r\n  [2]: https://i.stack.imgur.com/E2odc.png","title":"Electron - run jar file from background script","body":"<p>I have this code inside my electron app. I need to run a <a href=\"https://github.com/yeokm1/docs-to-pdf-converter\" rel=\"nofollow noreferrer\">jar file</a> and that will do a conversion job of some documents from  docx to pdf</p>\n<pre class=\"lang-js prettyprint-override\"><code>for (let p = 0; p &lt; docPaths.length; p++ ) {\n    const jar = childProcess.spawn(`java -jar docs-to-pdf-converter-1.7.jar -i ${docPaths[p]}, -o ${docPaths[p].replace('.docx', '.pdf')}`);\n    //\n    jar.stderr.on('error', () =&gt; {\n\n    });\n    //\n    jar.stdout.on('data', (data) =&gt; {\n        console.log(data);\n    });\n    //\n    jar.on('exit', (code) =&gt; {\n        console.log('jar ok', code);\n    });\n}\n</code></pre>\n<p>When I run the electron app I will get always this error</p>\n<p><a href=\"https://i.stack.imgur.com/E2odc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E2odc.png\" alt=\"Error screenshot\" /></a></p>\n<p>Is possible to run a java file from an electron app? what I need to do exactli, use <code>exec</code> instead of <code>spawn</code>?</p>\n"},{"tags":["java","spring-boot","completable-future","spring-cloud-feign","feign"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1690044862,"post_id":76741486,"comment_id":135299504,"body_markdown":"Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer.","body":"Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer."}],"owner":{"account_id":22530700,"reputation":16,"user_id":20444647,"display_name":"rafinhaLQ"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":42,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689977062,"creation_date":1689977062,"question_id":76741486,"body_markdown":"I am trying to use the feign interceptor to the feign requisitions i am calling using completable future, but the ServletRequestAttributes only return null.\r\n\r\n\r\n```\r\npublic class FeignInterceptor implements RequestInterceptor  {\r\n\r\n    @Override\r\n    public void apply(RequestTemplate requestTemplate) {\r\n        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();\r\n        HttpServletRequest request = attributes.getRequest();\r\n        String bearerToken = request.getHeader(AUTHORIZATION);\r\n        requestTemplate.header(AUTHORIZATION, bearerToken);\r\n    }\r\n}\r\n```\r\n\r\n\r\n```\r\n    public Object searchObject() {\r\n        Object[] listFutures;\r\n        try {\r\n            listFutures = Stream.of(getObjectFuture1(), getObjectFuture2(), getObjectFuture3())\r\n                    .map(CompletableFuture::join)\r\n                    .toArray(Object[]::new);\r\n        } catch(Exception e) {\r\n            throw e.getCause();\r\n        }\r\n\r\n        // Rest of the code\r\n\r\n        return listFutures[0];\r\n    }\r\n    \r\n    private CompletableFuture&lt;Object&gt; getObjectFuture1() {\r\n        return CompletableFuture.supplyAsync(() -&gt; feignClient.detailObject(null));\r\n    }\r\n    \r\n    private CompletableFuture&lt;Object&gt; getObjectFuture2() {\r\n        return CompletableFuture.supplyAsync(() -&gt; feignClient.listObject(true));\r\n    }\r\n    \r\n    private CompletableFuture&lt;Object&gt; getObjectFuture3() {\r\n        return CompletableFuture.supplyAsync(() -&gt; feignClient.listObject(true));\r\n    }\r\n\r\n```\r\n\r\n\r\n\r\nI&#39;m looking for an anwser for a long time but couldn&#39;t find it.","title":"Can I use Feign interceptor while calling the feign requisitions with completable future?","body":"<p>I am trying to use the feign interceptor to the feign requisitions i am calling using completable future, but the ServletRequestAttributes only return null.</p>\n<pre><code>public class FeignInterceptor implements RequestInterceptor  {\n\n    @Override\n    public void apply(RequestTemplate requestTemplate) {\n        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();\n        HttpServletRequest request = attributes.getRequest();\n        String bearerToken = request.getHeader(AUTHORIZATION);\n        requestTemplate.header(AUTHORIZATION, bearerToken);\n    }\n}\n</code></pre>\n<pre><code>    public Object searchObject() {\n        Object[] listFutures;\n        try {\n            listFutures = Stream.of(getObjectFuture1(), getObjectFuture2(), getObjectFuture3())\n                    .map(CompletableFuture::join)\n                    .toArray(Object[]::new);\n        } catch(Exception e) {\n            throw e.getCause();\n        }\n\n        // Rest of the code\n\n        return listFutures[0];\n    }\n    \n    private CompletableFuture&lt;Object&gt; getObjectFuture1() {\n        return CompletableFuture.supplyAsync(() -&gt; feignClient.detailObject(null));\n    }\n    \n    private CompletableFuture&lt;Object&gt; getObjectFuture2() {\n        return CompletableFuture.supplyAsync(() -&gt; feignClient.listObject(true));\n    }\n    \n    private CompletableFuture&lt;Object&gt; getObjectFuture3() {\n        return CompletableFuture.supplyAsync(() -&gt; feignClient.listObject(true));\n    }\n\n</code></pre>\n<p>I'm looking for an anwser for a long time but couldn't find it.</p>\n"},{"tags":["java","android","database","sqlite","android-sqlite"],"comments":[{"owner":{"account_id":4726205,"reputation":12248,"user_id":4420967,"display_name":"James Z"},"score":1,"creation_date":1689862677,"post_id":76727969,"comment_id":135275943,"body_markdown":"Please don&#39;t post pictures of code or other text","body":"Please don&#39;t post pictures of code or other text"},{"owner":{"account_id":11779404,"reputation":764,"user_id":8619606,"display_name":"Kirguduck"},"score":0,"creation_date":1689866885,"post_id":76727969,"comment_id":135277108,"body_markdown":"post your code as lines. not like pic","body":"post your code as lines. not like pic"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1689867656,"post_id":76727969,"comment_id":135277299,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."},{"owner":{"account_id":19093226,"reputation":1,"user_id":13943089,"display_name":"sufyan ashraf"},"score":0,"creation_date":1690034537,"post_id":76727969,"comment_id":135298163,"body_markdown":"still failed to insert data @MikeT","body":"still failed to insert data @MikeT"}],"answers":[{"tags":[],"owner":{"account_id":6077735,"reputation":52951,"user_id":4744514,"accept_rate":96,"display_name":"MikeT"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689976570,"creation_date":1689976570,"answer_id":76741457,"question_id":76727969,"body_markdown":"I believe that your issue is that the `onClick` method is starting another Activity before it does anything else, so control will pass to that activity, and as such the subsequent code does not execute and thus never insert the data.\r\n\r\nTry removing or commenting out the line `startActivity(it);`","title":"Data failed to insert in database","body":"<p>I believe that your issue is that the <code>onClick</code> method is starting another Activity before it does anything else, so control will pass to that activity, and as such the subsequent code does not execute and thus never insert the data.</p>\n<p>Try removing or commenting out the line <code>startActivity(it);</code></p>\n"}],"owner":{"account_id":19093226,"reputation":1,"user_id":13943089,"display_name":"sufyan ashraf"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":76,"favorite_count":0,"down_vote_count":8,"up_vote_count":0,"answer_count":1,"score":-8,"last_activity_date":1689976570,"creation_date":1689841460,"question_id":76727969,"body_markdown":"I am facing trouble while inserting data in database. The table was created but data was not inserting\r\n\r\ndbhelpher class func\r\n\r\n[![enter image description here][1]][1]\r\n\r\nmainactivity onlick func\r\n\r\n[![enter image description here][2]][2]\r\n\r\nI have tried to insert data on databse using onclick func with a button, hence the table was created but data was not inserted in the table. \r\n\r\n\r\n  [1]: https://i.stack.imgur.com/rUmI9.png\r\n  [2]: https://i.stack.imgur.com/2AP4f.png","title":"Data failed to insert in database","body":"<p>I am facing trouble while inserting data in database. The table was created but data was not inserting</p>\n<p>dbhelpher class func</p>\n<p><a href=\"https://i.stack.imgur.com/rUmI9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rUmI9.png\" alt=\"enter image description here\" /></a></p>\n<p>mainactivity onlick func</p>\n<p><a href=\"https://i.stack.imgur.com/2AP4f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2AP4f.png\" alt=\"enter image description here\" /></a></p>\n<p>I have tried to insert data on databse using onclick func with a button, hence the table was created but data was not inserted in the table.</p>\n"},{"tags":["java","jackson-databind"],"owner":{"account_id":487587,"reputation":3346,"user_id":1375292,"accept_rate":67,"display_name":"Troy Daniels"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":32,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689975332,"creation_date":1689975332,"question_id":76741371,"body_markdown":"I am using `JsonTypeInfo.As.PROPERTY` to serialize polymorphic data.  I also want to ignore incoming data with unknown types in it.  I am trying to do this with `handleUnknownTypeId` as such:\r\n\r\n**IgnoreInvalidTypeHandler.java**\r\n```\r\npackage com.example.jackson;\r\n\r\nimport java.io.IOException;\r\n\r\nimport com.fasterxml.jackson.databind.DeserializationContext;\r\nimport com.fasterxml.jackson.databind.JavaType;\r\nimport com.fasterxml.jackson.databind.deser.DeserializationProblemHandler;\r\nimport com.fasterxml.jackson.databind.jsontype.TypeIdResolver;\r\nimport com.fasterxml.jackson.databind.type.TypeFactory;\r\n\r\npublic class IgnoreInvalidTypeIdHandler extends DeserializationProblemHandler {\r\n\r\n  @Override\r\n  public JavaType handleUnknownTypeId(DeserializationContext ctxt, JavaType baseType, String subTypeId,\r\n                                      TypeIdResolver idResolver, String failureMsg) throws IOException {\r\n    System.out.println(&quot;failureMsg: &quot; + failureMessage);\r\n    return TypeFactory.defaultInstance().constructSimpleType(Void.class, new JavaType[0]);\r\n  }\r\n\r\n}\r\n```\r\n\r\nI have a unit test to verify that it works:\r\n\r\n**IgnoreInvalidateTypeHanderTest.java**\r\n```\r\npackage com.example.jackson;\r\n\r\nimport org.junit.Test;\r\nimport static org.hamcrest.Matchers.*;\r\nimport static org.hamcrest.MatcherAssert.assertThat;\r\nimport com.fasterxml.jackson.annotation.JsonTypeInfo;\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\n\r\npublic class IgnoreInvalidTypeIdHandlerTest {\r\n\r\n@JsonTypeInfo(\r\n    use = JsonTypeInfo.Id.MINIMAL_CLASS,\r\n    include = JsonTypeInfo.As.PROPERTY,\r\n    property = &quot;@class&quot;)\r\n  public interface Root {\r\n  }\r\n\r\n  public static class Base implements Root {\r\n    public String id;\r\n  }\r\n\r\n  public static class Derived extends Base {\r\n    public String field;\r\n  }\r\n\r\n  public static class Wrapper implements Root {\r\n    public Base base;\r\n  }\r\n\r\n  @Test\r\n  public void basic() throws Exception  {\r\n    ObjectMapper mapper = new ObjectMapper()\r\n        .addHandler(new IgnoreInvalidTypeIdHandler())\r\n        //.disable(DeserializationFeature.FAIL_ON_INVALID_SUBTYPE)\r\n        ;\r\n\r\n    Wrapper wrapper = new Wrapper();\r\n    Derived derived = new Derived();\r\n    derived.id = &quot;foo&quot;;\r\n    derived.field = &quot;123&quot;;\r\n    wrapper.base = derived;\r\n\r\n    String json = mapper.writeValueAsString(wrapper);\r\n    // Verify that we can serialize it\r\n    Wrapper newWrapper = mapper.readValue(json, Wrapper.class);\r\n    assertThat(newWrapper.base.id, is(wrapper.base.id));\r\n    assertThat(newWrapper.base, is(instanceOf(Derived.class)));\r\n    Derived newDerived = (Derived) newWrapper.base;\r\n    assertThat(newDerived.field, is(derived.field));\r\n\r\n    String badJson = &quot;{&#39;@class&#39;:&#39;.IgnoreInvalidTypeIdHandlerTest$Wrapper&#39;,&quot; +\r\n      &quot;&#39;base&#39;:{&#39;@class&#39;:&#39;.UnknownClass&#39;,&#39;id&#39;:&#39;unk-id&#39;,&#39;field&#39;:&#39;unk-field&#39;}}&quot;;\r\n    badJson = badJson.replace(&quot;&#39;&quot;, &quot;\\&quot;&quot;);\r\n\r\n    Wrapper result = mapper.readValue(badJson, Wrapper.class);\r\n    assertThat(result.base, is(nullValue()));\r\n\r\n  }\r\n}\r\n```\r\n\r\nAccording to the documentation on DeserializationProblemHandler, one option is for it to &quot;Indicate that nothing should be deserialized, by return `Void.class`&quot;.  The interface requires that a `JavaType` is returned, not a `Class`, but I think my implementation follows the spirit of the documentation.  \r\n\r\nWhen I run the unit test, my handler is called twice.  The first time, `subTypeId` is &quot;com.example.jackson.UnknownClass&quot;.  The second time, it is &quot;.UnknownClass&quot;.  The test then throws an exception:\r\n\r\n```\r\ncom.fasterxml.jackson.databind.JsonMappingException: Cannot invoke &quot;com.fasterxml.jackson.databind.JsonDeserializer.deserialize(com.fasterxml.jackson.core.JsonParser, com.fasterxml.jackson.databind.DeserializationContext)&quot; because &quot;deser&quot; is null (through reference chain: com.example.jackson.IgnoreInvalidTypeIdHandlerTest$Wrapper[&quot;base&quot;])\r\n\tat com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:394)\r\n\tat com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:353)\r\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializerBase.wrapAndThrow(BeanDeserializerBase.java:1711)\r\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:290)\r\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeOther(BeanDeserializer.java:189)\r\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:161)\r\n\tat com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer._deserializeTypedForId(AsPropertyTypeDeserializer.java:130)\r\n\tat com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer.deserializeTypedFromObject(AsPropertyTypeDeserializer.java:97)\r\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeWithType(BeanDeserializerBase.java:1178)\r\n\tat com.fasterxml.jackson.databind.deser.impl.TypeWrappedDeserializer.deserialize(TypeWrappedDeserializer.java:68)\r\n\tat com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4013)\r\n\tat com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3004)\r\n\tat com.example.jackson.IgnoreInvalidTypeIdHandlerTest.basic(IgnoreInvalidTypeIdHandlerTest.java:77)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568)\r\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)\r\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)\r\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\r\n\tat org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)\r\n\tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)\r\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)\r\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)\r\n\tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)\r\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)\r\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:363)\r\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)\r\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)\r\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)\r\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)\r\n\tat org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)\r\n\tat org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)\r\n\tat org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)\r\n\tat org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)\r\nCaused by: java.lang.NullPointerException: Cannot invoke &quot;com.fasterxml.jackson.databind.JsonDeserializer.deserialize(com.fasterxml.jackson.core.JsonParser, com.fasterxml.jackson.databind.DeserializationContext)&quot; because &quot;deser&quot; is null\r\n\tat com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer._deserializeTypedForId(AsPropertyTypeDeserializer.java:130)\r\n\tat com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer.deserializeTypedFromObject(AsPropertyTypeDeserializer.java:97)\r\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeWithType(BeanDeserializerBase.java:1178)\r\n\tat com.fasterxml.jackson.databind.deser.impl.FieldProperty.deserializeAndSet(FieldProperty.java:145)\r\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:288)\r\n\t... 34 more\r\n```\r\n\r\nAm I using this method correctly? It looks to me like Jackson realizes there is an unknown type and calls my handler as expected, and converts the object being deserialized to `null`.  However, it then seems to continue trying to deserialize it.\r\n\r\nIf I remove the handler and uncomment the `FAIL_ON_INVALID_SUBTYPE` call, then the test passes, although without any indication that it ignored the data.\r\n\r\nI have not tried it, but it seems that if I uncomment the `FAIL` flag and return null from the handler (don&#39;t know what to do), I can log from the handler and then use the built-in behavior to set the field to null, but that seems like a workaround.\r\n\r\nI am using Java 17 and Jackson 2.9.8.  \r\n\r\nMy full use case is that we have a domain model of objects that are passed around between components as JSON.  When we update the domain model, we need to update the pom for every component that uses the model, whether or not it cares about the change.  If we forget a module, it crashes when it receives an object whose type does not exist in its domain model.  So we would like to ignore those objects, but warn that we did so, in case the component does need the current version of the domain model.\r\n","title":"Using `handleUnknownTypeId` to skip unknown types in Jackson","body":"<p>I am using <code>JsonTypeInfo.As.PROPERTY</code> to serialize polymorphic data.  I also want to ignore incoming data with unknown types in it.  I am trying to do this with <code>handleUnknownTypeId</code> as such:</p>\n<p><strong>IgnoreInvalidTypeHandler.java</strong></p>\n<pre><code>package com.example.jackson;\n\nimport java.io.IOException;\n\nimport com.fasterxml.jackson.databind.DeserializationContext;\nimport com.fasterxml.jackson.databind.JavaType;\nimport com.fasterxml.jackson.databind.deser.DeserializationProblemHandler;\nimport com.fasterxml.jackson.databind.jsontype.TypeIdResolver;\nimport com.fasterxml.jackson.databind.type.TypeFactory;\n\npublic class IgnoreInvalidTypeIdHandler extends DeserializationProblemHandler {\n\n  @Override\n  public JavaType handleUnknownTypeId(DeserializationContext ctxt, JavaType baseType, String subTypeId,\n                                      TypeIdResolver idResolver, String failureMsg) throws IOException {\n    System.out.println(&quot;failureMsg: &quot; + failureMessage);\n    return TypeFactory.defaultInstance().constructSimpleType(Void.class, new JavaType[0]);\n  }\n\n}\n</code></pre>\n<p>I have a unit test to verify that it works:</p>\n<p><strong>IgnoreInvalidateTypeHanderTest.java</strong></p>\n<pre><code>package com.example.jackson;\n\nimport org.junit.Test;\nimport static org.hamcrest.Matchers.*;\nimport static org.hamcrest.MatcherAssert.assertThat;\nimport com.fasterxml.jackson.annotation.JsonTypeInfo;\nimport com.fasterxml.jackson.databind.ObjectMapper;\n\npublic class IgnoreInvalidTypeIdHandlerTest {\n\n@JsonTypeInfo(\n    use = JsonTypeInfo.Id.MINIMAL_CLASS,\n    include = JsonTypeInfo.As.PROPERTY,\n    property = &quot;@class&quot;)\n  public interface Root {\n  }\n\n  public static class Base implements Root {\n    public String id;\n  }\n\n  public static class Derived extends Base {\n    public String field;\n  }\n\n  public static class Wrapper implements Root {\n    public Base base;\n  }\n\n  @Test\n  public void basic() throws Exception  {\n    ObjectMapper mapper = new ObjectMapper()\n        .addHandler(new IgnoreInvalidTypeIdHandler())\n        //.disable(DeserializationFeature.FAIL_ON_INVALID_SUBTYPE)\n        ;\n\n    Wrapper wrapper = new Wrapper();\n    Derived derived = new Derived();\n    derived.id = &quot;foo&quot;;\n    derived.field = &quot;123&quot;;\n    wrapper.base = derived;\n\n    String json = mapper.writeValueAsString(wrapper);\n    // Verify that we can serialize it\n    Wrapper newWrapper = mapper.readValue(json, Wrapper.class);\n    assertThat(newWrapper.base.id, is(wrapper.base.id));\n    assertThat(newWrapper.base, is(instanceOf(Derived.class)));\n    Derived newDerived = (Derived) newWrapper.base;\n    assertThat(newDerived.field, is(derived.field));\n\n    String badJson = &quot;{'@class':'.IgnoreInvalidTypeIdHandlerTest$Wrapper',&quot; +\n      &quot;'base':{'@class':'.UnknownClass','id':'unk-id','field':'unk-field'}}&quot;;\n    badJson = badJson.replace(&quot;'&quot;, &quot;\\&quot;&quot;);\n\n    Wrapper result = mapper.readValue(badJson, Wrapper.class);\n    assertThat(result.base, is(nullValue()));\n\n  }\n}\n</code></pre>\n<p>According to the documentation on DeserializationProblemHandler, one option is for it to &quot;Indicate that nothing should be deserialized, by return <code>Void.class</code>&quot;.  The interface requires that a <code>JavaType</code> is returned, not a <code>Class</code>, but I think my implementation follows the spirit of the documentation.</p>\n<p>When I run the unit test, my handler is called twice.  The first time, <code>subTypeId</code> is &quot;com.example.jackson.UnknownClass&quot;.  The second time, it is &quot;.UnknownClass&quot;.  The test then throws an exception:</p>\n<pre><code>com.fasterxml.jackson.databind.JsonMappingException: Cannot invoke &quot;com.fasterxml.jackson.databind.JsonDeserializer.deserialize(com.fasterxml.jackson.core.JsonParser, com.fasterxml.jackson.databind.DeserializationContext)&quot; because &quot;deser&quot; is null (through reference chain: com.example.jackson.IgnoreInvalidTypeIdHandlerTest$Wrapper[&quot;base&quot;])\n    at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:394)\n    at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:353)\n    at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.wrapAndThrow(BeanDeserializerBase.java:1711)\n    at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:290)\n    at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeOther(BeanDeserializer.java:189)\n    at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:161)\n    at com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer._deserializeTypedForId(AsPropertyTypeDeserializer.java:130)\n    at com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer.deserializeTypedFromObject(AsPropertyTypeDeserializer.java:97)\n    at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeWithType(BeanDeserializerBase.java:1178)\n    at com.fasterxml.jackson.databind.deser.impl.TypeWrappedDeserializer.deserialize(TypeWrappedDeserializer.java:68)\n    at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4013)\n    at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3004)\n    at com.example.jackson.IgnoreInvalidTypeIdHandlerTest.basic(IgnoreInvalidTypeIdHandlerTest.java:77)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:568)\n    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)\n    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\n    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:363)\n    at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)\n    at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)\n    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)\n    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)\n    at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)\n    at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)\n    at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)\n    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)\nCaused by: java.lang.NullPointerException: Cannot invoke &quot;com.fasterxml.jackson.databind.JsonDeserializer.deserialize(com.fasterxml.jackson.core.JsonParser, com.fasterxml.jackson.databind.DeserializationContext)&quot; because &quot;deser&quot; is null\n    at com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer._deserializeTypedForId(AsPropertyTypeDeserializer.java:130)\n    at com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer.deserializeTypedFromObject(AsPropertyTypeDeserializer.java:97)\n    at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeWithType(BeanDeserializerBase.java:1178)\n    at com.fasterxml.jackson.databind.deser.impl.FieldProperty.deserializeAndSet(FieldProperty.java:145)\n    at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:288)\n    ... 34 more\n</code></pre>\n<p>Am I using this method correctly? It looks to me like Jackson realizes there is an unknown type and calls my handler as expected, and converts the object being deserialized to <code>null</code>.  However, it then seems to continue trying to deserialize it.</p>\n<p>If I remove the handler and uncomment the <code>FAIL_ON_INVALID_SUBTYPE</code> call, then the test passes, although without any indication that it ignored the data.</p>\n<p>I have not tried it, but it seems that if I uncomment the <code>FAIL</code> flag and return null from the handler (don't know what to do), I can log from the handler and then use the built-in behavior to set the field to null, but that seems like a workaround.</p>\n<p>I am using Java 17 and Jackson 2.9.8.</p>\n<p>My full use case is that we have a domain model of objects that are passed around between components as JSON.  When we update the domain model, we need to update the pom for every component that uses the model, whether or not it cares about the change.  If we forget a module, it crashes when it receives an object whose type does not exist in its domain model.  So we would like to ignore those objects, but warn that we did so, in case the component does need the current version of the domain model.</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":372682,"reputation":22426,"user_id":721855,"display_name":"aled"},"score":0,"creation_date":1689975132,"post_id":76741324,"comment_id":135293715,"body_markdown":"Please provide a https://stackoverflow.com/help/minimal-reproducible-example","body":"Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a>"}],"answers":[{"tags":[],"owner":{"account_id":4228398,"reputation":17727,"user_id":3461397,"display_name":"Oleg Cherednik"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1689975268,"creation_date":1689975268,"answer_id":76741364,"question_id":76741324,"body_markdown":"This value with `.` is `double`. You should parse `double` from the stirng and then convert it to `long`.\r\n```java\r\nString str = &quot;447475.0&quot;;\r\nlong num = (long) Double.parseDouble(str);  // 447475\r\n```","title":"Parsing error from ms excel to java object , java.lang.NumberFormatException: For input string: &quot;447475.0&quot;","body":"<p>This value with <code>.</code> is <code>double</code>. You should parse <code>double</code> from the stirng and then convert it to <code>long</code>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>String str = &quot;447475.0&quot;;\nlong num = (long) Double.parseDouble(str);  // 447475\n</code></pre>\n"}],"owner":{"account_id":3758035,"reputation":1073,"user_id":3123934,"accept_rate":54,"display_name":"user3123934"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":20,"favorite_count":0,"down_vote_count":2,"up_vote_count":2,"accepted_answer_id":76741364,"answer_count":1,"score":0,"last_activity_date":1689975268,"creation_date":1689974670,"question_id":76741324,"body_markdown":"I am reading microsoft excel data as string value [![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/9oGWB.png\r\n\r\nActually, I am reading value in java as string java.lang.NumberFormatException: For input string: &quot;447475.0&quot;\r\n\r\nCode snippet\r\nLong.parseLong(getCellValue(row.getCell(positionMap.get(columnName))))\r\n","title":"Parsing error from ms excel to java object , java.lang.NumberFormatException: For input string: &quot;447475.0&quot;","body":"<p>I am reading microsoft excel data as string value <a href=\"https://i.stack.imgur.com/9oGWB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9oGWB.png\" alt=\"enter image description here\" /></a></p>\n<p>Actually, I am reading value in java as string java.lang.NumberFormatException: For input string: &quot;447475.0&quot;</p>\n<p>Code snippet\nLong.parseLong(getCellValue(row.getCell(positionMap.get(columnName))))</p>\n"},{"tags":["java","inheritance","extends"],"comments":[{"owner":{"account_id":4010701,"reputation":15103,"user_id":4398966,"accept_rate":64,"display_name":"DCR"},"score":0,"creation_date":1689973337,"post_id":76741198,"comment_id":135293501,"body_markdown":"I don&#39;t mind the downvote but a little explanation as to why would be really helpful","body":"I don&#39;t mind the downvote but a little explanation as to why would be really helpful"},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":0,"creation_date":1689973628,"post_id":76741198,"comment_id":135293532,"body_markdown":"Do you know the difference between the static and the dynamic type of an object?","body":"Do you know the difference between the static and the dynamic type of an object?"},{"owner":{"account_id":23428052,"reputation":6895,"user_id":17487348,"display_name":"Mushroomator"},"score":0,"creation_date":1689973653,"post_id":76741198,"comment_id":135293535,"body_markdown":"Take a look at [static vs. dynamic binding](https://www.baeldung.com/java-static-dynamic-binding).","body":"Take a look at <a href=\"https://www.baeldung.com/java-static-dynamic-binding\" rel=\"nofollow noreferrer\">static vs. dynamic binding</a>."},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":0,"creation_date":1689973815,"post_id":76741198,"comment_id":135293558,"body_markdown":"@Mushroomator that is only part of the puzzle (dynamic dispatch/binding). There are more nuances. E.g. when an overloaded method is called, the exact implementation called is determined by the static types of the actual parameters.","body":"@Mushroomator that is only part of the puzzle (dynamic dispatch/binding). There are more nuances. E.g. when an overloaded method is called, the exact implementation called is determined by the static types of the actual parameters."},{"owner":{"account_id":4010701,"reputation":15103,"user_id":4398966,"accept_rate":64,"display_name":"DCR"},"score":0,"creation_date":1689973913,"post_id":76741198,"comment_id":135293569,"body_markdown":"clear as mud.  Does anyone one have a clearer explanation suitable for a highschool classroom","body":"clear as mud.  Does anyone one have a clearer explanation suitable for a highschool classroom"},{"owner":{"account_id":9760,"reputation":85859,"user_id":18157,"accept_rate":100,"display_name":"Jim Garrison"},"score":2,"creation_date":1689973925,"post_id":76741198,"comment_id":135293570,"body_markdown":"The downvotes come from the fact that this a fundamental aspect of Java that is extremely well documented all over the Internet.  One of the SO tenets is that we&#39;d rather not re-document stuff that can already be found elsewhere, and you&#39;re expected to have done the research before asking.","body":"The downvotes come from the fact that this a fundamental aspect of Java that is extremely well documented all over the Internet.  One of the SO tenets is that we&#39;d rather not re-document stuff that can already be found elsewhere, and you&#39;re expected to have done the research before asking."},{"owner":{"account_id":4010701,"reputation":15103,"user_id":4398966,"accept_rate":64,"display_name":"DCR"},"score":2,"creation_date":1689973964,"post_id":76741198,"comment_id":135293579,"body_markdown":"wow, I&#39;ve looked all over the internet and all of the explanations are as I said, clear as mud","body":"wow, I&#39;ve looked all over the internet and all of the explanations are as I said, clear as mud"},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":0,"creation_date":1689974094,"post_id":76741198,"comment_id":135293603,"body_markdown":"[This pdf from `www.cs.cornell.edu`](https://www.cs.cornell.edu/courses/JavaAndDS/files/staticType.pdf) explains static and dynamic types quite well and with a concrete examples. For completeness: the static type determines what we &quot;see&quot; when we write code: When the variable has the static type `Animal`, we only see methods defined in `Animal`. The dynamic type, however, determines (through dynamic dispatch) which implementation of a method is called (aside from overloading, which falls back to the static types and is a separate topic).","body":"<a href=\"https://www.cs.cornell.edu/courses/JavaAndDS/files/staticType.pdf\" rel=\"nofollow noreferrer\">This pdf from <code>www.cs.cornell.edu</code></a> explains static and dynamic types quite well and with a concrete examples. For completeness: the static type determines what we &quot;see&quot; when we write code: When the variable has the static type <code>Animal</code>, we only see methods defined in <code>Animal</code>. The dynamic type, however, determines (through dynamic dispatch) which implementation of a method is called (aside from overloading, which falls back to the static types and is a separate topic)."},{"owner":{"account_id":1691630,"reputation":49583,"user_id":1553851,"accept_rate":73,"display_name":"shmosel"},"score":0,"creation_date":1689974659,"post_id":76741198,"comment_id":135293669,"body_markdown":"The compile-time type is `ClassA`. You can only reference methods that are know to the compile-time type. But the actual invocation is resolved against the runtime type, namely `ClassB`. So if a method declared in `ClassA` is overridden in `ClassB`, it&#39;s the latter version that gets invoked. It&#39;s fundamental to polymorphism that you can have a shared &quot;contract&quot; for multiple types with varying implementations depending on subtype of a particular instance. This is supposed to reflect real-world objects in the sense that you can describe e.g. how to drive a car without knowing the specific model.","body":"The compile-time type is <code>ClassA</code>. You can only reference methods that are know to the compile-time type. But the actual invocation is resolved against the runtime type, namely <code>ClassB</code>. So if a method declared in <code>ClassA</code> is overridden in <code>ClassB</code>, it&#39;s the latter version that gets invoked. It&#39;s fundamental to polymorphism that you can have a shared &quot;contract&quot; for multiple types with varying implementations depending on subtype of a particular instance. This is supposed to reflect real-world objects in the sense that you can describe e.g. how to drive a car without knowing the specific model."},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":0,"creation_date":1689975798,"post_id":76741198,"comment_id":135293810,"body_markdown":"@user16320675 &quot;*it sure can be done in Java*&quot; - Can it be done? yes. Should it be done? Probably not. At least not without at least a preceeding type check. Even then: the uses should be few and far between. See the [Liskov Substitution Principle](https://en.wikipedia.org/wiki/Liskov_substitution_principle).","body":"@user16320675 &quot;<i>it sure can be done in Java</i>&quot; - Can it be done? yes. Should it be done? Probably not. At least not without at least a preceeding type check. Even then: the uses should be few and far between. See the <a href=\"https://en.wikipedia.org/wiki/Liskov_substitution_principle\" rel=\"nofollow noreferrer\">Liskov Substitution Principle</a>."},{"owner":{"account_id":4010701,"reputation":15103,"user_id":4398966,"accept_rate":64,"display_name":"DCR"},"score":0,"creation_date":1689976297,"post_id":76741198,"comment_id":135293870,"body_markdown":"@user16320675, thanks I didn&#39;t realize I need to add the extra set of ()","body":"@user16320675, thanks I didn&#39;t realize I need to add the extra set of ()"},{"owner":{"account_id":3576533,"reputation":16716,"user_id":2985643,"accept_rate":40,"display_name":"skomisa"},"score":0,"creation_date":1689985940,"post_id":76741198,"comment_id":135294602,"body_markdown":"@JimGarrison The information may be _&quot;all over the Internet&quot;_ but that does not, and never should, preclude users from asking here. I&#39;d also note that so far nobody has proposed a duplicate for the OP&#39;s question, which suggests it may not have been asked before on SO. Given that the question is about _&quot;a fundamental aspect of Java&quot;_, if nobody has asked it here before it is actually a good and very useful question.","body":"@JimGarrison The information may be <i>&quot;all over the Internet&quot;</i> but that does not, and never should, preclude users from asking here. I&#39;d also note that so far nobody has proposed a duplicate for the OP&#39;s question, which suggests it may not have been asked before on SO. Given that the question is about <i>&quot;a fundamental aspect of Java&quot;</i>, if nobody has asked it here before it is actually a good and very useful question."},{"owner":{"account_id":10943394,"reputation":111,"user_id":22230072,"display_name":"Mr. Brown"},"score":0,"creation_date":1690239067,"post_id":76741198,"comment_id":135322834,"body_markdown":"“All over the Internet” and doesn’t provide a single reference. Nice job.","body":"“All over the Internet” and doesn’t provide a single reference. Nice job."}],"answers":[{"tags":[],"owner":{"account_id":401843,"reputation":89768,"user_id":768644,"display_name":"rzwitserloot"},"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1689975178,"creation_date":1689975178,"answer_id":76741357,"question_id":76741198,"body_markdown":"Your question is identical to this situation:\r\n\r\nYou see Max, who is a poodle. You ask: So, what&#39;s the deal? Is Max a Poodle, a Dog, or an Animal? Or all three at the same time?\r\n\r\nThe answer is more or less &#39;that question belies a misunderstanding of how we classify living things&#39;. If you must choose from your limited set of options, &quot;It is all 3&quot; is more correct than any other. But that implies you could create a Poodle that is also an Animal but _not_ a Dog, and that is the wrong conclusion: _Anything that is a poodle is __necessarily__ also a Dog_.\r\n\r\nIt also depends on context. If I ask about the &#39;type&#39; of creature that Max is, and the situation calls for just one answer, you always get &#39;Poodle&#39;. Because that&#39;s the most useful answer - knowing that max is a Poodle is enough to determine that max is therefore necessarily also a dog and also an animal because _by definition, __all__ poodles are. You can&#39;t have a non-dog creature that is nevertheless a poodle_.\r\n\r\nHence:\r\n\r\n* `Animal a = new Poodle();` is perfectly legal. Al poodles are animals, so, if you have a job that requires any animal, a poodle will work. So would a chihuahua.\r\n\r\n* Java does everything by reference. `Animal a;` is like declaring the existence of a little post-it note named `a` which is to contain the __adress__ of where some animal lives. The address can even be left blank (`null`). You are guaranteed that, if an actual address is on this post-it note, that it will __definitely__ lead to some sort of animal (it would not lead to, say, an oak tree, the language and runtime __guarantee__ this). In this case, it would, in fact, lead to a poodle. Which works fine: all poodles are animals, after all. The fact that your address postit says &#39;I might lead to any animal&#39; doesn&#39;t magically turn max into a donkey or even into a &#39;generic animal&#39; - max remains a poodle:\r\n\r\n```\r\nPoodle max = new Poodle();\r\nAnimal a = max;\r\nSystem.out.println(a.getClass()); // prints &#39;Poodle&#39;.\r\n```\r\n\r\nRemember, the dot operator is &#39;follow the address on the post-it and ask the thing you find there a question&#39;. `.getClass()` doesn&#39;t &#39;ask the question&#39; to `a`, it asks the question to the thing a is pointing at. Currently, a is pointing at max. And if you ask Max what he is (and if dogs could speak, I guess), max would say &#39;I am a poodle&#39;. Max won&#39;t say &quot;I am an animal&quot;; max has no awareness of the postit note, and really couldn&#39;t: There could be 85 postits all with the address of max. There could be none left (local variables cease existing once a method ends, for example, as if the postit note poofs into oblivion). When asking questions to objects they don&#39;t get the &#39;context&#39; (what route you used to _find_ that object), and thus you know their answer cannot possibly be dependent on it.\r\n\r\n* `Poodle b = a;` __is not__ legal. This means: &quot;Take the address on post-it note a and copy it over to post-it note b, which is restricted such that, if it points to anything, it points to a poodle. __Even if__ a is currently pointing at a poodle, at compile time the compiler doesn&#39;t know that, so it won&#39;t let you do this. Not without a cast: `Poodle b = (Poodle) a;` is fine, because that is interjecting: &quot;Check if a is in fact pointing at a poodle. If it is indeed, then all is well. But if not, stop everything you are doing and exit this procedure abnormally with a &#39;ClassCastException&#39;.\r\n\r\n* Objects always have many, many types. For example, `new ArrayList&lt;String&gt;` is __all__ of these things: `Serializable`, `RandomAccess`, `Iterable&lt;String&gt;`, `ArrayList&lt;String&gt;`, `AbstractList&lt;String&gt;`, `List&lt;String&gt;`, `AbstractCollection&lt;String&gt;`, `Collection&lt;String&gt;`, `Object`, and perhaps a few more I missed. It&#39;s not just the type hierarchy (ArrayList extends AbstractList extends AbstractCollection extends Object), it&#39;s also all the interfaces you pick up along the way - and all of _their_ superinterfaces too. This matches real life. max is a poodle, a dog, an animal, a meat eater, a legged thing, a source of pee, a 2-eared thing, male, and so many other things. All at the same time.\r\n","title":"java do extended classes have two types","body":"<p>Your question is identical to this situation:</p>\n<p>You see Max, who is a poodle. You ask: So, what's the deal? Is Max a Poodle, a Dog, or an Animal? Or all three at the same time?</p>\n<p>The answer is more or less 'that question belies a misunderstanding of how we classify living things'. If you must choose from your limited set of options, &quot;It is all 3&quot; is more correct than any other. But that implies you could create a Poodle that is also an Animal but <em>not</em> a Dog, and that is the wrong conclusion: <em>Anything that is a poodle is <strong>necessarily</strong> also a Dog</em>.</p>\n<p>It also depends on context. If I ask about the 'type' of creature that Max is, and the situation calls for just one answer, you always get 'Poodle'. Because that's the most useful answer - knowing that max is a Poodle is enough to determine that max is therefore necessarily also a dog and also an animal because <em>by definition, <strong>all</strong> poodles are. You can't have a non-dog creature that is nevertheless a poodle</em>.</p>\n<p>Hence:</p>\n<ul>\n<li><p><code>Animal a = new Poodle();</code> is perfectly legal. Al poodles are animals, so, if you have a job that requires any animal, a poodle will work. So would a chihuahua.</p>\n</li>\n<li><p>Java does everything by reference. <code>Animal a;</code> is like declaring the existence of a little post-it note named <code>a</code> which is to contain the <strong>adress</strong> of where some animal lives. The address can even be left blank (<code>null</code>). You are guaranteed that, if an actual address is on this post-it note, that it will <strong>definitely</strong> lead to some sort of animal (it would not lead to, say, an oak tree, the language and runtime <strong>guarantee</strong> this). In this case, it would, in fact, lead to a poodle. Which works fine: all poodles are animals, after all. The fact that your address postit says 'I might lead to any animal' doesn't magically turn max into a donkey or even into a 'generic animal' - max remains a poodle:</p>\n</li>\n</ul>\n<pre><code>Poodle max = new Poodle();\nAnimal a = max;\nSystem.out.println(a.getClass()); // prints 'Poodle'.\n</code></pre>\n<p>Remember, the dot operator is 'follow the address on the post-it and ask the thing you find there a question'. <code>.getClass()</code> doesn't 'ask the question' to <code>a</code>, it asks the question to the thing a is pointing at. Currently, a is pointing at max. And if you ask Max what he is (and if dogs could speak, I guess), max would say 'I am a poodle'. Max won't say &quot;I am an animal&quot;; max has no awareness of the postit note, and really couldn't: There could be 85 postits all with the address of max. There could be none left (local variables cease existing once a method ends, for example, as if the postit note poofs into oblivion). When asking questions to objects they don't get the 'context' (what route you used to <em>find</em> that object), and thus you know their answer cannot possibly be dependent on it.</p>\n<ul>\n<li><p><code>Poodle b = a;</code> <strong>is not</strong> legal. This means: &quot;Take the address on post-it note a and copy it over to post-it note b, which is restricted such that, if it points to anything, it points to a poodle. <strong>Even if</strong> a is currently pointing at a poodle, at compile time the compiler doesn't know that, so it won't let you do this. Not without a cast: <code>Poodle b = (Poodle) a;</code> is fine, because that is interjecting: &quot;Check if a is in fact pointing at a poodle. If it is indeed, then all is well. But if not, stop everything you are doing and exit this procedure abnormally with a 'ClassCastException'.</p>\n</li>\n<li><p>Objects always have many, many types. For example, <code>new ArrayList&lt;String&gt;</code> is <strong>all</strong> of these things: <code>Serializable</code>, <code>RandomAccess</code>, <code>Iterable&lt;String&gt;</code>, <code>ArrayList&lt;String&gt;</code>, <code>AbstractList&lt;String&gt;</code>, <code>List&lt;String&gt;</code>, <code>AbstractCollection&lt;String&gt;</code>, <code>Collection&lt;String&gt;</code>, <code>Object</code>, and perhaps a few more I missed. It's not just the type hierarchy (ArrayList extends AbstractList extends AbstractCollection extends Object), it's also all the interfaces you pick up along the way - and all of <em>their</em> superinterfaces too. This matches real life. max is a poodle, a dog, an animal, a meat eater, a legged thing, a source of pee, a 2-eared thing, male, and so many other things. All at the same time.</p>\n</li>\n</ul>\n"}],"owner":{"account_id":4010701,"reputation":15103,"user_id":4398966,"accept_rate":64,"display_name":"DCR"},"comment_count":13,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":73,"favorite_count":0,"down_vote_count":2,"up_vote_count":2,"accepted_answer_id":76741357,"answer_count":1,"score":0,"last_activity_date":1689975178,"creation_date":1689973067,"question_id":76741198,"body_markdown":"In java I have the following:\r\n\r\n    ClassA obj = new ClassB();\r\n\r\nwhere `ClassB extends ClassA`.\r\nIs obj of type `ClassA` or `ClassB` or both?\r\n\r\nif we have instead:\r\n\r\n    ClassB obj = new ClassB();\r\n    \r\nit seems clear that `obj` is of type `ClassB` but all `ClassB` are `ClassA` too, aren&#39;t they? So is the type both `ClassA` and `ClassB`?\r\n\r\nif we add the following:\r\n\r\n    ClassA [] objects = new ClassA[3];\r\n    ClassA obj = new ClassB();\r\n    objects[0] = obj;\r\n\r\nit seems that `obj` is of type `ClassA`. So we can add it to objects even though obj is a `new ClassB();`\r\n\r\nHere&#39;s my confusion, let say we have an overwritten method in `ClassB` from `ClassA`, I can call the method and I get the expected output from the `ClassB` overwritten method.  But, if I have just a `ClassB` method not also contained in `ClassA` I can&#39;t call it and I don&#39;t seem to be able to upcast it to `ClassB`.  oh wait, `obj` is of type `ClassA` so we can&#39;t cast it to a `ClassB` because all `ClassA`&#39;s aren&#39;t `ClassB`&#39;s.\r\n\r\nSo obj is of type `ClassA` but we set it to `new ClassB()`. so what the heck is it? Is it `ClassA` or `ClassB`, I&#39;m so confused. Why can we access the overwritten methods in `ClassB` but not the non overwritten methods?  Is that just the way polymorphism works?","title":"java do extended classes have two types","body":"<p>In java I have the following:</p>\n<pre><code>ClassA obj = new ClassB();\n</code></pre>\n<p>where <code>ClassB extends ClassA</code>.\nIs obj of type <code>ClassA</code> or <code>ClassB</code> or both?</p>\n<p>if we have instead:</p>\n<pre><code>ClassB obj = new ClassB();\n</code></pre>\n<p>it seems clear that <code>obj</code> is of type <code>ClassB</code> but all <code>ClassB</code> are <code>ClassA</code> too, aren't they? So is the type both <code>ClassA</code> and <code>ClassB</code>?</p>\n<p>if we add the following:</p>\n<pre><code>ClassA [] objects = new ClassA[3];\nClassA obj = new ClassB();\nobjects[0] = obj;\n</code></pre>\n<p>it seems that <code>obj</code> is of type <code>ClassA</code>. So we can add it to objects even though obj is a <code>new ClassB();</code></p>\n<p>Here's my confusion, let say we have an overwritten method in <code>ClassB</code> from <code>ClassA</code>, I can call the method and I get the expected output from the <code>ClassB</code> overwritten method.  But, if I have just a <code>ClassB</code> method not also contained in <code>ClassA</code> I can't call it and I don't seem to be able to upcast it to <code>ClassB</code>.  oh wait, <code>obj</code> is of type <code>ClassA</code> so we can't cast it to a <code>ClassB</code> because all <code>ClassA</code>'s aren't <code>ClassB</code>'s.</p>\n<p>So obj is of type <code>ClassA</code> but we set it to <code>new ClassB()</code>. so what the heck is it? Is it <code>ClassA</code> or <code>ClassB</code>, I'm so confused. Why can we access the overwritten methods in <code>ClassB</code> but not the non overwritten methods?  Is that just the way polymorphism works?</p>\n"},{"tags":["java","spring","spring-boot"],"answers":[{"tags":[],"owner":{"account_id":28850828,"reputation":512,"user_id":22096771,"display_name":"Bademeister"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689974573,"creation_date":1689974573,"answer_id":76741316,"question_id":76740763,"body_markdown":"I had a similar challenge last time. First I excluded `/static/**` in the InterceptorRegistry config because the Interceptor felt responsible for it. After the exclusion I had 404 with the static files.\r\n\r\nAfter I made the following entry in application.properties were the static resources loaded.\r\n\r\n```\r\nspring.mvc.static-path-pattern=/static/**\r\n```","title":"How can I have different context path in spring boot for static pages such as .js or .css?","body":"<p>I had a similar challenge last time. First I excluded <code>/static/**</code> in the InterceptorRegistry config because the Interceptor felt responsible for it. After the exclusion I had 404 with the static files.</p>\n<p>After I made the following entry in application.properties were the static resources loaded.</p>\n<pre><code>spring.mvc.static-path-pattern=/static/**\n</code></pre>\n"}],"owner":{"account_id":12275702,"reputation":23,"user_id":13786905,"display_name":"Coder"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":155,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689974573,"creation_date":1689967987,"question_id":76740763,"body_markdown":"My Spring boot MVC application has,\r\n\r\n**ForgotController.java**\r\n```\r\n@RequestMapping(value = &quot;forgot.do&quot;, method = RequestMethod.GET)\r\npublic ModelAndView forgotCreds(HttpServletRequest request,\r\n\t\t\t\t\t\t\t\t\t  HttpServletResponse response) throws Exception {\r\n\t//returns or calls a view &#39;forgot.jsp&#39; \r\n}\r\n```\r\n\r\n**application.properties**\r\n\r\n```\r\nserver.servlet.context-path=/login\r\nstatic.contextPath=/static\r\n```\r\n\r\n**dispatcher-servlet.xml**\r\n\r\n```\r\n.\r\n.\r\n&lt;bean id=&quot;viewResolver&quot;\r\n\t  class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;\r\n\t&lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/views/&quot;/&gt;\r\n\t&lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;\r\n&lt;/bean&gt;\r\n.\r\n.\r\nother config\r\n```\r\n\r\n**ViewRegistry.java**\r\n\r\n```\r\n@Configuration\r\npublic class ViewRegistry implements WebMvcConfigurer {\r\n\r\n@Override\r\npublic void addResourceHandlers(ResourceHandlerRegistry registry) {\r\n\t\tregistry.addResourceHandler(&quot;/static/**&quot;).addResourceLocations(&quot;classpath:build/dist/static/&quot;);\r\n\t\r\n\t}\r\n}\r\n```\r\n\r\n**Application.java**\r\n\r\n```\r\n@SpringBootApplication\r\n@ImportResource(\r\n        locations = {\r\n                &quot;classpath:/WEB-INF/config/dispatcher-servlet.xml&quot;\r\n})\r\npublic class Application extends SpringBootServletInitializer {\r\n\r\n    public static void main(String[] args) {\r\n        SpringApplication.run(Application.class, args);\r\n    }\r\n}\r\n```\r\n\r\nMy application that initiates as **localhost:8080/login/forgot.do**, should load static resources from **localhost:8080/static/css/style.css**, but instead I&#39;m getting 404 not found for static resources. And, if I manually check for static content as **localhost:8080/login/static/css/style.css**, it&#39;s available. How can i get my spring boot application to serve static pages from &#39;/static&#39; context as **localhost:8080/static/..**?\r\n\r\nAny help would be appreciated. Thanks in advance!","title":"How can I have different context path in spring boot for static pages such as .js or .css?","body":"<p>My Spring boot MVC application has,</p>\n<p><strong>ForgotController.java</strong></p>\n<pre><code>@RequestMapping(value = &quot;forgot.do&quot;, method = RequestMethod.GET)\npublic ModelAndView forgotCreds(HttpServletRequest request,\n                                      HttpServletResponse response) throws Exception {\n    //returns or calls a view 'forgot.jsp' \n}\n</code></pre>\n<p><strong>application.properties</strong></p>\n<pre><code>server.servlet.context-path=/login\nstatic.contextPath=/static\n</code></pre>\n<p><strong>dispatcher-servlet.xml</strong></p>\n<pre><code>.\n.\n&lt;bean id=&quot;viewResolver&quot;\n      class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;\n    &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/views/&quot;/&gt;\n    &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;\n&lt;/bean&gt;\n.\n.\nother config\n</code></pre>\n<p><strong>ViewRegistry.java</strong></p>\n<pre><code>@Configuration\npublic class ViewRegistry implements WebMvcConfigurer {\n\n@Override\npublic void addResourceHandlers(ResourceHandlerRegistry registry) {\n        registry.addResourceHandler(&quot;/static/**&quot;).addResourceLocations(&quot;classpath:build/dist/static/&quot;);\n    \n    }\n}\n</code></pre>\n<p><strong>Application.java</strong></p>\n<pre><code>@SpringBootApplication\n@ImportResource(\n        locations = {\n                &quot;classpath:/WEB-INF/config/dispatcher-servlet.xml&quot;\n})\npublic class Application extends SpringBootServletInitializer {\n\n    public static void main(String[] args) {\n        SpringApplication.run(Application.class, args);\n    }\n}\n</code></pre>\n<p>My application that initiates as <strong>localhost:8080/login/forgot.do</strong>, should load static resources from <strong>localhost:8080/static/css/style.css</strong>, but instead I'm getting 404 not found for static resources. And, if I manually check for static content as <strong>localhost:8080/login/static/css/style.css</strong>, it's available. How can i get my spring boot application to serve static pages from '/static' context as <strong>localhost:8080/static/..</strong>?</p>\n<p>Any help would be appreciated. Thanks in advance!</p>\n"},{"tags":["java","java-8"],"comments":[{"owner":{"display_name":"user6073886"},"score":2,"creation_date":1689864587,"post_id":76731078,"comment_id":135276437,"body_markdown":"`if(obj.isAssignableFrom(entry.getClass()))` might be what you are looking for","body":"<code>if(obj.isAssignableFrom(entry.getClass()))</code> might be what you are looking for"},{"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1689929301,"post_id":76731078,"comment_id":135285586,"body_markdown":"Note that getting a list of entries from `getResourceAsStream` for a package is not a guaranteed behavior. This may work in the development environment and break in production, depending on the form of deployment. Consider using [`ServiceLoader`](https://docs.oracle.com/javase/8/docs/api/?java/util/ServiceLoader.html) instead. But you are also confusing classes and objects. A `Class` object is not an instance of your class, hence you can’t use `instanceof`, neither can you “retrieve the id on(sic) the object”, as there is no object, only a class. And a `Set` is not a `List`.","body":"Note that getting a list of entries from <code>getResourceAsStream</code> for a package is not a guaranteed behavior. This may work in the development environment and break in production, depending on the form of deployment. Consider using <a href=\"https://docs.oracle.com/javase/8/docs/api/?java/util/ServiceLoader.html\" rel=\"nofollow noreferrer\"><code>ServiceLoader</code></a> instead. But you are also confusing classes and objects. A <code>Class</code> object is not an instance of your class, hence you can’t use <code>instanceof</code>, neither can you “retrieve the id on(sic) the object”, as there is no object, only a class. And a <code>Set</code> is not a <code>List</code>."},{"owner":{"account_id":17599454,"reputation":3,"user_id":12769744,"display_name":"Yfoem"},"score":0,"creation_date":1689943292,"post_id":76731078,"comment_id":135288249,"body_markdown":"@OHGODSPIDERS sorry but it&#39;s didn&#39;t work for me, the bool is always false","body":"@OHGODSPIDERS sorry but it&#39;s didn&#39;t work for me, the bool is always false"},{"owner":{"account_id":17599454,"reputation":3,"user_id":12769744,"display_name":"Yfoem"},"score":0,"creation_date":1689943296,"post_id":76731078,"comment_id":135288251,"body_markdown":"@Holger Thanks for the warning. I wil check ServiceLoader","body":"@Holger Thanks for the warning. I wil check ServiceLoader"}],"answers":[{"tags":[],"owner":{"account_id":4228398,"reputation":17727,"user_id":3461397,"display_name":"Oleg Cherednik"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689973963,"creation_date":1689973515,"answer_id":76741240,"question_id":76731078,"body_markdown":"```java\r\npublic Set&lt;Class&lt;?&gt;&gt; findAllClassesUsingClassLoader(String packageName) {}\r\n```\r\n\r\nIf what you want to do is test whether or not `FooChildX` actual type is `Foo` or a subtype, you&#39;ve got it:\r\n\r\n```java\r\nFooChildX.class.isAssignableFrom(Foo.class);\r\n````\r\n----\r\nThere&#39;s a framework [Reflections][1] you can use it to do it very easily:\r\n```java\r\npublic static void main(String... args) {\r\n    Set&lt;Class&lt;? extends FooChild&gt;&gt; classes = findAllClasses(&quot;foo&quot;, FooChild.class);\r\n\r\n    for (Class&lt;?&gt; cls : classes) {\r\n        // do smth\r\n    }\r\n}\r\n\r\npublic static &lt;T&gt; Set&lt;Class&lt;? extends T&gt;&gt; findAllClasses(String packageName, Class&lt;T&gt; cls) {\r\n    return new Reflections(packageName).getSubTypesOf(cls);\r\n}\r\n```\r\n\r\n  [1]: https://github.com/ronmamo/reflections","title":"Check that an object&#39;s class is contained in a specific package and cast it","body":"<pre class=\"lang-java prettyprint-override\"><code>public Set&lt;Class&lt;?&gt;&gt; findAllClassesUsingClassLoader(String packageName) {}\n</code></pre>\n<p>If what you want to do is test whether or not <code>FooChildX</code> actual type is <code>Foo</code> or a subtype, you've got it:</p>\n<pre class=\"lang-java prettyprint-override\"><code>FooChildX.class.isAssignableFrom(Foo.class);\n</code></pre>\n<hr />\n<p>There's a framework <a href=\"https://github.com/ronmamo/reflections\" rel=\"nofollow noreferrer\">Reflections</a> you can use it to do it very easily:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static void main(String... args) {\n    Set&lt;Class&lt;? extends FooChild&gt;&gt; classes = findAllClasses(&quot;foo&quot;, FooChild.class);\n\n    for (Class&lt;?&gt; cls : classes) {\n        // do smth\n    }\n}\n\npublic static &lt;T&gt; Set&lt;Class&lt;? extends T&gt;&gt; findAllClasses(String packageName, Class&lt;T&gt; cls) {\n    return new Reflections(packageName).getSubTypesOf(cls);\n}\n</code></pre>\n"}],"owner":{"account_id":17599454,"reputation":3,"user_id":12769744,"display_name":"Yfoem"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":55,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689973963,"creation_date":1689864358,"question_id":76731078,"body_markdown":"I have a java code (java 8) that call a service returning an object (class Foo)\r\n\r\nThe Foo class is inherited by child classes (FooChild1, FooChild2 ... contained in a package, named &quot;packageFoo&quot;) and other child classes.\r\n\r\nI have an id on FooChildX (from packageFoo). \r\n\r\nI want to retrieve the id on the object if its class is a child class of Foo. \r\nI can&#39;t modify the service or edit the Foo class (or child classes)\r\n\r\nI&#39;ve extracted the list of classes present in packageFoo. I&#39;m using the method on baeldung site for the extraction : \r\n\r\n     public Set&lt;Class&gt; findAllClassesUsingClassLoader(String packageName) {\r\n        InputStream stream = ClassLoader.getSystemClassLoader()\r\n          .getResourceAsStream(packageName.replaceAll(&quot;[.]&quot;, &quot;/&quot;));\r\n        BufferedReader reader = new BufferedReader(new InputStreamReader(stream));\r\n        return reader.lines()\r\n          .filter(line -&gt; line.endsWith(&quot;.class&quot;))\r\n          .map(line -&gt; getClass(line, packageName))\r\n          .collect(Collectors.toSet());\r\n    }\r\n \r\n    private Class getClass(String className, String packageName) {\r\n        try {\r\n            return Class.forName(packageName + &quot;.&quot;\r\n              + className.substring(0, className.lastIndexOf(&#39;.&#39;)));\r\n        } catch (ClassNotFoundException e) {\r\n            // handle the exception\r\n        }\r\n        return null;\r\n    }\r\n\r\nBut I can&#39;t perform instanceof and cast on my extracted list\r\n\r\n    for(Class obj : classesList){\r\n            if(entry instanceof obj ) {\r\n               (obj) entry\r\n            }\r\n    }\r\n \r\n\r\nI don&#39;t want specifying every class in my package to keep light maintainability if possible. \r\n\r\n    if(entry instanceof FooChild1) {...} \r\n    if(entry instanceof FooChild2) {...}\r\n\r\n\r\nDo you have a solution? ","title":"Check that an object&#39;s class is contained in a specific package and cast it","body":"<p>I have a java code (java 8) that call a service returning an object (class Foo)</p>\n<p>The Foo class is inherited by child classes (FooChild1, FooChild2 ... contained in a package, named &quot;packageFoo&quot;) and other child classes.</p>\n<p>I have an id on FooChildX (from packageFoo).</p>\n<p>I want to retrieve the id on the object if its class is a child class of Foo.\nI can't modify the service or edit the Foo class (or child classes)</p>\n<p>I've extracted the list of classes present in packageFoo. I'm using the method on baeldung site for the extraction :</p>\n<pre><code> public Set&lt;Class&gt; findAllClassesUsingClassLoader(String packageName) {\n    InputStream stream = ClassLoader.getSystemClassLoader()\n      .getResourceAsStream(packageName.replaceAll(&quot;[.]&quot;, &quot;/&quot;));\n    BufferedReader reader = new BufferedReader(new InputStreamReader(stream));\n    return reader.lines()\n      .filter(line -&gt; line.endsWith(&quot;.class&quot;))\n      .map(line -&gt; getClass(line, packageName))\n      .collect(Collectors.toSet());\n}\n\nprivate Class getClass(String className, String packageName) {\n    try {\n        return Class.forName(packageName + &quot;.&quot;\n          + className.substring(0, className.lastIndexOf('.')));\n    } catch (ClassNotFoundException e) {\n        // handle the exception\n    }\n    return null;\n}\n</code></pre>\n<p>But I can't perform instanceof and cast on my extracted list</p>\n<pre><code>for(Class obj : classesList){\n        if(entry instanceof obj ) {\n           (obj) entry\n        }\n}\n</code></pre>\n<p>I don't want specifying every class in my package to keep light maintainability if possible.</p>\n<pre><code>if(entry instanceof FooChild1) {...} \nif(entry instanceof FooChild2) {...}\n</code></pre>\n<p>Do you have a solution?</p>\n"},{"tags":["java","spring-boot","deployment","artifactory"],"comments":[{"owner":{"account_id":17138155,"reputation":266,"user_id":12402748,"display_name":"shaibz"},"score":0,"creation_date":1689855952,"post_id":76725936,"comment_id":135274269,"body_markdown":"which kind of client you are using to consume or deploy these files? What are the files which you produce? Are you using Maven or Gradle? What&#39;s wrong with curl?","body":"which kind of client you are using to consume or deploy these files? What are the files which you produce? Are you using Maven or Gradle? What&#39;s wrong with curl?"},{"owner":{"account_id":2683594,"reputation":490,"user_id":2318409,"accept_rate":80,"display_name":"Gary Greenberg"},"score":0,"creation_date":1689872065,"post_id":76725936,"comment_id":135278172,"body_markdown":"I am using Maven. I am creating a REST service that is in its own turn calling other APIs to get data, combine them into a tarball and deploy to the artifactory. Nothing is wrong with curl for someone who is writing a shell script, but I am writing a Java service and JFrog documentation of their REST API is horrible. That is why I am asking question here.","body":"I am using Maven. I am creating a REST service that is in its own turn calling other APIs to get data, combine them into a tarball and deploy to the artifactory. Nothing is wrong with curl for someone who is writing a shell script, but I am writing a Java service and JFrog documentation of their REST API is horrible. That is why I am asking question here."},{"owner":{"account_id":17138155,"reputation":266,"user_id":12402748,"display_name":"shaibz"},"score":0,"creation_date":1690099190,"post_id":76725936,"comment_id":135303637,"body_markdown":"In order to debug it I suggest checking the artifactory-request.log, perhaps the request doesn&#39;t reach Artifactory correctly.\nFor example the PUT request should look like &quot;https://your-artifactory-url/artifactory/repo-name/path/to/file.jar&quot;","body":"In order to debug it I suggest checking the artifactory-request.log, perhaps the request doesn&#39;t reach Artifactory correctly. For example the PUT request should look like &quot;<a href=\"https://your-artifactory-url/artifactory/repo-name/path/to/file.jar\" rel=\"nofollow noreferrer\">your-artifactory-url/artifactory/repo-name/path/to/file.jar</a>&zwnj;&#8203;&quot;"},{"owner":{"account_id":2683594,"reputation":490,"user_id":2318409,"accept_rate":80,"display_name":"Gary Greenberg"},"score":0,"creation_date":1690215321,"post_id":76725936,"comment_id":135319096,"body_markdown":"Sorry, but you are quoting JFrog documentation, which is a) useless, b) incorrect.","body":"Sorry, but you are quoting JFrog documentation, which is a) useless, b) incorrect."}],"owner":{"account_id":2683594,"reputation":490,"user_id":2318409,"accept_rate":80,"display_name":"Gary Greenberg"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":131,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689973309,"creation_date":1689812309,"question_id":76725936,"body_markdown":"I am developing a SpringBoot application that generates some binary data blob.\r\nI can write it to a file, but per my requirements this data shall be stored in the JFrog artifactory in the specified directory with the particular name.\r\n\r\nI spent couple days studying JFrog REST API documentation, but it only provides CURL and CLI interfaces without much of details. It does describe few headers, but it is quite unclear what are request params, body, etc, what would be possible return codes and responses. \r\n \r\nI did find here post regarding downloads from the artifactory:\r\nhttps://stackoverflow.com/questions/73024804/how-to-connect-and-download-artifacts-from-jfrog-artifactory-in-a-spring-boot-ap/73033720#73033720\r\nI did test it for download and it is working. Using it as example I created my own function to do upload (deployment):\r\n\r\n        OperationStatus doUpload(String filePath, String folder, String name) \r\n            throws MalformedURLException, ProtocolException, IOException {\r\n        StringBuilder pathBuilder = new StringBuilder(this.getBaseUrl()).append(&#39;/&#39;)\r\n                .append(this.target);\r\n        if(folder != null) {\r\n            pathBuilder.append(&#39;/&#39;).append(folder);\r\n        }\r\n        pathBuilder.append(&#39;/&#39;).append(name);\r\n        URL repositoryUrl = new URL(pathBuilder.toString());\r\n        HttpURLConnection connection = (HttpURLConnection) repositoryUrl.openConnection();\r\n        connection.addRequestProperty(ARTIFACTORY_TOKEN_HEADER_NAME, token);\r\n        connection.setRequestMethod(&quot;PUT&quot;);\r\n        connection.setDoOutput(true);\r\n        try (OutputStream output = connection.getOutputStream()) {\r\n            try (FileInputStream input = new FileInputStream(new File(filePath))) {\r\n                int b;\r\n                while((b = input.read()) != -1) {\r\n                    output.write(b);\r\n                }\r\n            }\r\n            output.flush();\r\n        }\r\n        connection.connect();\r\n        return new OperationStatus(&quot;success&quot;, &quot;Artifact &quot; + name + &quot; deployed&quot;);\r\n    }\r\n\r\n\r\nFunction works without errors, but artifact does not appear in the artifactory. If someone can point out what I am doing wrong, I will appreciate it.","title":"Deploying data to the JFrog artifactory from Java SpringBoot application","body":"<p>I am developing a SpringBoot application that generates some binary data blob.\nI can write it to a file, but per my requirements this data shall be stored in the JFrog artifactory in the specified directory with the particular name.</p>\n<p>I spent couple days studying JFrog REST API documentation, but it only provides CURL and CLI interfaces without much of details. It does describe few headers, but it is quite unclear what are request params, body, etc, what would be possible return codes and responses.</p>\n<p>I did find here post regarding downloads from the artifactory:\n<a href=\"https://stackoverflow.com/questions/73024804/how-to-connect-and-download-artifacts-from-jfrog-artifactory-in-a-spring-boot-ap/73033720#73033720\">How to connect and download artifacts from JFrog Artifactory in a Spring boot application</a>\nI did test it for download and it is working. Using it as example I created my own function to do upload (deployment):</p>\n<pre><code>    OperationStatus doUpload(String filePath, String folder, String name) \n        throws MalformedURLException, ProtocolException, IOException {\n    StringBuilder pathBuilder = new StringBuilder(this.getBaseUrl()).append('/')\n            .append(this.target);\n    if(folder != null) {\n        pathBuilder.append('/').append(folder);\n    }\n    pathBuilder.append('/').append(name);\n    URL repositoryUrl = new URL(pathBuilder.toString());\n    HttpURLConnection connection = (HttpURLConnection) repositoryUrl.openConnection();\n    connection.addRequestProperty(ARTIFACTORY_TOKEN_HEADER_NAME, token);\n    connection.setRequestMethod(&quot;PUT&quot;);\n    connection.setDoOutput(true);\n    try (OutputStream output = connection.getOutputStream()) {\n        try (FileInputStream input = new FileInputStream(new File(filePath))) {\n            int b;\n            while((b = input.read()) != -1) {\n                output.write(b);\n            }\n        }\n        output.flush();\n    }\n    connection.connect();\n    return new OperationStatus(&quot;success&quot;, &quot;Artifact &quot; + name + &quot; deployed&quot;);\n}\n</code></pre>\n<p>Function works without errors, but artifact does not appear in the artifactory. If someone can point out what I am doing wrong, I will appreciate it.</p>\n"},{"tags":["java","lambda","java-8"],"answers":[{"tags":[],"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"down_vote_count":1,"up_vote_count":93,"is_accepted":true,"score":92,"last_activity_date":1399487119,"creation_date":1399487119,"answer_id":23525446,"question_id":23523946,"body_markdown":"The place to look is [JLS &#167;15.27.1. Lambda Parameters](http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.27.1)\n\n&gt; **It is a compile-time error if a lambda parameter has the name _ (that is, a single underscore character).**\n&gt;\n&gt; &lt;sup&gt;The use of the variable name _ in any context is discouraged. Future versions of the Java programming language may reserve this name as a keyword and/or give it special semantics.\n&lt;/sup&gt;\n\nSo the Eclipse message is misleading, especially as the same message is used for both cases, when an error is generated for a lambda parameter or when a warning is generated for any other `_` identifier.\n","title":"_ (underscore) is a reserved keyword","body":"<p>The place to look is <a href=\"http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.27.1\" rel=\"noreferrer\">JLS §15.27.1. Lambda Parameters</a></p>\n<blockquote>\n<p><strong>It is a compile-time error if a lambda parameter has the name _ (that is, a single underscore character).</strong></p>\n<p><sup>The use of the variable name _ in any context is discouraged. Future versions of the Java programming language may reserve this name as a keyword and/or give it special semantics.\n</sup></p>\n</blockquote>\n<p>So the Eclipse message is misleading, especially as the same message is used for both cases, when an error is generated for a lambda parameter or when a warning is generated for any other <code>_</code> identifier.</p>\n"},{"tags":[],"owner":{"account_id":540573,"reputation":12635,"user_id":908821,"accept_rate":68,"display_name":"Angel Koh"},"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1506512904,"creation_date":1506512904,"answer_id":46447095,"question_id":23523946,"body_markdown":"**Java Language Changes for Java SE 9**\nhttps://docs.oracle.com/javase/9/language/toc.htm#JSLAN-GUID-16A5183A-DC0D-4A96-B9D8-AAC9671222DD \n\n\nFrom Java 9, the _ character cannot be used as an identifier anymore, not just within the lambda context\n\n&gt;The underscore character is not a legal name.\n&gt;\n&gt;If you use the underscore character (&quot;_&quot;) an identifier, your source code can no longer be compiled.","title":"_ (underscore) is a reserved keyword","body":"<p><strong>Java Language Changes for Java SE 9</strong>\n<a href=\"https://docs.oracle.com/javase/9/language/toc.htm#JSLAN-GUID-16A5183A-DC0D-4A96-B9D8-AAC9671222DD\" rel=\"noreferrer\">https://docs.oracle.com/javase/9/language/toc.htm#JSLAN-GUID-16A5183A-DC0D-4A96-B9D8-AAC9671222DD</a></p>\n<p>From Java 9, the _ character cannot be used as an identifier anymore, not just within the lambda context</p>\n<blockquote>\n<p>The underscore character is not a legal name.</p>\n<p>If you use the underscore character (&quot;_&quot;) an identifier, your source code can no longer be compiled.</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":1509064,"reputation":1842,"user_id":1411628,"accept_rate":100,"display_name":"Alexandre de Champeaux"},"down_vote_count":0,"up_vote_count":36,"is_accepted":false,"score":36,"last_activity_date":1531283329,"creation_date":1531175696,"answer_id":51254912,"question_id":23523946,"body_markdown":"It is the Phase 2 of [JEP 302][1], that is going to add underscore as a special character to denote unused parameters in lambda expressions.\r\n\r\n\r\n&gt; ### Treatment of underscores\r\n&gt;\r\n&gt; In many languages, it is common to use an underscore (`_`) to denote an unnamed lambda parameter (and similarly for method and exception parameters):\r\n&gt; \r\n&gt; `BiFunction&lt;Integer, String, String&gt; biss = (i, _) -&gt; String.valueOf(i);`\r\n&gt; \r\n&gt; This allows stronger static checking of unused arguments, and also allows multiple arguments to be marked as unused. However, because underscore was a valid identifier as of Java 8, compatibility required us to take a more indirect path to getting to where underscore could serve this role in Java. Phase 1 was forbidding underscore as a lambda formal parameter name in Java 8 (this had no compatibility consequence, since lambdas did not exist previously) and a warning was issued for using underscore as an identifier in other places. Phase 2 came in Java 9, when this warning became an error. We are now free to complete the planned rehabilitation of underscore to indicate an unused lambda, method, or catch formal parameter.\r\n\r\n  [1]: http://openjdk.java.net/jeps/302","title":"_ (underscore) is a reserved keyword","body":"<p>It is the Phase 2 of <a href=\"http://openjdk.java.net/jeps/302\" rel=\"noreferrer\">JEP 302</a>, that is going to add underscore as a special character to denote unused parameters in lambda expressions.</p>\n\n<blockquote>\n  <h3>Treatment of underscores</h3>\n  \n  <p>In many languages, it is common to use an underscore (<code>_</code>) to denote an unnamed lambda parameter (and similarly for method and exception parameters):</p>\n  \n  <p><code>BiFunction&lt;Integer, String, String&gt; biss = (i, _) -&gt; String.valueOf(i);</code></p>\n  \n  <p>This allows stronger static checking of unused arguments, and also allows multiple arguments to be marked as unused. However, because underscore was a valid identifier as of Java 8, compatibility required us to take a more indirect path to getting to where underscore could serve this role in Java. Phase 1 was forbidding underscore as a lambda formal parameter name in Java 8 (this had no compatibility consequence, since lambdas did not exist previously) and a warning was issued for using underscore as an identifier in other places. Phase 2 came in Java 9, when this warning became an error. We are now free to complete the planned rehabilitation of underscore to indicate an unused lambda, method, or catch formal parameter.</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":322981,"reputation":310745,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1689973121,"creation_date":1684982132,"answer_id":76328541,"question_id":23523946,"body_markdown":"# tl;dr\r\n\r\nAs Java evolves, the underscore character takes on a special new meaning: elide the type and name of a `record` component.\r\n\r\n\r\n# Underscore = eliding type and name\r\n\r\nAs a preview feature in [Java 21][1], we see the underscore character used to:\r\n\r\n - [elide][2] the type and name of a [record][3] component in pattern matching.\r\n - elide the identifier which follows the type or var in a type pattern.\r\n\r\nSee [*JEP 443: Unnamed Patterns and Variables (Preview)*](https://openjdk.org/jeps/443).\r\n\r\n## Underscore as identifier disallowed in Java 9+\r\n\r\nThe underscore character (`_`) is code point 95 decimal, 5F hex. Formally named `LOW LINE` in the [Unicode][4] standard. \r\n\r\nUsing underscore as an identifier throws:\r\n\r\n - a warning in Java 8.\r\n - an error in Java 9+. \r\n\r\nSee: [*JEP 213: Milling Project Coin*](https://openjdk.org/jeps/213).\r\n\r\n\r\n  [1]: https://openjdk.org/projects/jdk/21/\r\n  [2]: https://en.wiktionary.org/wiki/elide\r\n  [3]: https://openjdk.org/jeps/395\r\n  [4]: https://en.wikipedia.org/wiki/Unicode","title":"_ (underscore) is a reserved keyword","body":"<h1>tl;dr</h1>\n<p>As Java evolves, the underscore character takes on a special new meaning: elide the type and name of a <code>record</code> component.</p>\n<h1>Underscore = eliding type and name</h1>\n<p>As a preview feature in <a href=\"https://openjdk.org/projects/jdk/21/\" rel=\"nofollow noreferrer\">Java 21</a>, we see the underscore character used to:</p>\n<ul>\n<li><a href=\"https://en.wiktionary.org/wiki/elide\" rel=\"nofollow noreferrer\">elide</a> the type and name of a <a href=\"https://openjdk.org/jeps/395\" rel=\"nofollow noreferrer\">record</a> component in pattern matching.</li>\n<li>elide the identifier which follows the type or var in a type pattern.</li>\n</ul>\n<p>See <a href=\"https://openjdk.org/jeps/443\" rel=\"nofollow noreferrer\"><em>JEP 443: Unnamed Patterns and Variables (Preview)</em></a>.</p>\n<h2>Underscore as identifier disallowed in Java 9+</h2>\n<p>The underscore character (<code>_</code>) is code point 95 decimal, 5F hex. Formally named <code>LOW LINE</code> in the <a href=\"https://en.wikipedia.org/wiki/Unicode\" rel=\"nofollow noreferrer\">Unicode</a> standard.</p>\n<p>Using underscore as an identifier throws:</p>\n<ul>\n<li>a warning in Java 8.</li>\n<li>an error in Java 9+.</li>\n</ul>\n<p>See: <a href=\"https://openjdk.org/jeps/213\" rel=\"nofollow noreferrer\"><em>JEP 213: Milling Project Coin</em></a>.</p>\n"}],"owner":{"account_id":1781872,"reputation":14665,"user_id":1624376,"accept_rate":76,"display_name":"Aubin"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":33626,"favorite_count":0,"down_vote_count":0,"up_vote_count":106,"accepted_answer_id":23525446,"answer_count":4,"score":106,"last_activity_date":1689973121,"creation_date":1399482140,"question_id":23523946,"body_markdown":"I&#39;ve just replaced `s` in the following lambda expression by `_`:\r\n\r\n    s -&gt; Integer.parseInt(s)\r\n\r\nEclipse compiler says:\r\n&gt;&#39;_&#39; should not be used as an identifier, since it is a reserved keyword from source level 1.8 on.\r\n\r\nI haven&#39;t found any explanation in the [JLS &#167;3.9][1] Lexical Structure / Keywords.\r\n\r\n  [1]: http://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html#jls-3.9","title":"_ (underscore) is a reserved keyword","body":"<p>I've just replaced <code>s</code> in the following lambda expression by <code>_</code>:</p>\n\n<pre><code>s -&gt; Integer.parseInt(s)\n</code></pre>\n\n<p>Eclipse compiler says:</p>\n\n<blockquote>\n  <p>'_' should not be used as an identifier, since it is a reserved keyword from source level 1.8 on.</p>\n</blockquote>\n\n<p>I haven't found any explanation in the <a href=\"http://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html#jls-3.9\" rel=\"noreferrer\">JLS §3.9</a> Lexical Structure / Keywords.</p>\n"},{"tags":["java","sharepoint","microsoft-graph-api"],"comments":[{"owner":{"account_id":3741438,"reputation":12025,"user_id":3111149,"accept_rate":87,"display_name":"Matteo NNZ"},"score":0,"creation_date":1689971355,"post_id":76740961,"comment_id":135293276,"body_markdown":"Considering that 401 means unauthorized, it seems you can&#39;t access the resource because you don&#39;t have a valid token to read it. Where does the token come from? Are you sure it&#39;s a bearer (usually Microsoft uses Oauth)?","body":"Considering that 401 means unauthorized, it seems you can&#39;t access the resource because you don&#39;t have a valid token to read it. Where does the token come from? Are you sure it&#39;s a bearer (usually Microsoft uses Oauth)?"},{"owner":{"account_id":367805,"reputation":143,"user_id":714212,"display_name":"rread"},"score":0,"creation_date":1689972990,"post_id":76740961,"comment_id":135293455,"body_markdown":"i added my code to get the token, and its the same one i use for my calls to graphclient","body":"i added my code to get the token, and its the same one i use for my calls to graphclient"}],"owner":{"account_id":367805,"reputation":143,"user_id":714212,"display_name":"rread"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":74,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689972963,"creation_date":1689970204,"question_id":76740961,"body_markdown":"My company has a system that uploads files to a sharepoint site asynchronous, and save the url to a data base.\r\n\r\nbut now it seems system is not 100% reliable, and i need now to check all the entried in the database and list the ones that do not exists in the sharepoint.\r\n\r\nSo how can i having the complete url for the file check if the file exists.\r\n\r\nThis was the code i was triying but for some reason i keep getting 401 only.\r\n\r\n```\r\nimport java.net.*;\r\nimport java.net.http.HttpClient;\r\nimport java.net.http.HttpRequest;\r\nimport java.net.http.HttpResponse;\r\n\r\n...\r\n\r\npublic static boolean checkFileExists(String fileUrl, String accessToken) {\r\n\ttry {\r\n\t\tString encodedFileUrl = fileUrl.replace(&quot; &quot;,&quot;%20&quot;);\r\n\t\tURI uri = new URI(encodedFileUrl);\r\n\t\tHttpRequest request = HttpRequest.newBuilder()\r\n\t\t\t.GET()\r\n\t\t\t.uri(uri)\r\n\t\t\t.header(&quot;Authorization&quot;, &quot;Bearer &quot; + accessToken)\r\n\t\t\t.build();\r\n\r\n\t\tHttpClient httpClient = HttpClient.newHttpClient();\r\n\t\tHttpResponse&lt;String&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());\r\n\t\tint statusCode = response.statusCode();\r\n\r\n\t\treturn (statusCode &gt;= 200 &amp;&amp; statusCode &lt; 300);\r\n\t} catch (IOException | URISyntaxException | InterruptedException e) {\r\n\t\te.printStackTrace();\r\n\t\treturn false;\r\n\t}\r\n}\r\n```\r\n\r\ni tried using the microsoft graph client that i have, but i found no way to do this using the java sdk client.\r\n\r\nHere is how i get my token\r\n```\r\npublic String getAccessTokenFromUserCredentials(String username, String password) throws Exception {\r\n   AuthenticationContext context;\r\n   AuthenticationResult result;\r\n   ExecutorService service = null;\r\n   try {\r\n      service = Executors.newFixedThreadPool(1);\r\n      context = new AuthenticationContext(authority, false, service);\r\n      Future&lt;AuthenticationResult&gt; future = context.acquireToken(&quot;https://graph.microsoft.com&quot;, clientId, username, password, null);\r\n      result = future.get();\r\n   } finally {\r\n      assert service != null;\r\n      service.shutdown();\r\n   }\r\n   if (result == null) {\r\n      throw new ServiceUnavailableException(&quot;authentication result was null&quot;);\r\n   }\r\n   return result.getAccessToken();\r\n}\r\n```","title":"Using file url, and credential check if file exists","body":"<p>My company has a system that uploads files to a sharepoint site asynchronous, and save the url to a data base.</p>\n<p>but now it seems system is not 100% reliable, and i need now to check all the entried in the database and list the ones that do not exists in the sharepoint.</p>\n<p>So how can i having the complete url for the file check if the file exists.</p>\n<p>This was the code i was triying but for some reason i keep getting 401 only.</p>\n<pre><code>import java.net.*;\nimport java.net.http.HttpClient;\nimport java.net.http.HttpRequest;\nimport java.net.http.HttpResponse;\n\n...\n\npublic static boolean checkFileExists(String fileUrl, String accessToken) {\n    try {\n        String encodedFileUrl = fileUrl.replace(&quot; &quot;,&quot;%20&quot;);\n        URI uri = new URI(encodedFileUrl);\n        HttpRequest request = HttpRequest.newBuilder()\n            .GET()\n            .uri(uri)\n            .header(&quot;Authorization&quot;, &quot;Bearer &quot; + accessToken)\n            .build();\n\n        HttpClient httpClient = HttpClient.newHttpClient();\n        HttpResponse&lt;String&gt; response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());\n        int statusCode = response.statusCode();\n\n        return (statusCode &gt;= 200 &amp;&amp; statusCode &lt; 300);\n    } catch (IOException | URISyntaxException | InterruptedException e) {\n        e.printStackTrace();\n        return false;\n    }\n}\n</code></pre>\n<p>i tried using the microsoft graph client that i have, but i found no way to do this using the java sdk client.</p>\n<p>Here is how i get my token</p>\n<pre><code>public String getAccessTokenFromUserCredentials(String username, String password) throws Exception {\n   AuthenticationContext context;\n   AuthenticationResult result;\n   ExecutorService service = null;\n   try {\n      service = Executors.newFixedThreadPool(1);\n      context = new AuthenticationContext(authority, false, service);\n      Future&lt;AuthenticationResult&gt; future = context.acquireToken(&quot;https://graph.microsoft.com&quot;, clientId, username, password, null);\n      result = future.get();\n   } finally {\n      assert service != null;\n      service.shutdown();\n   }\n   if (result == null) {\n      throw new ServiceUnavailableException(&quot;authentication result was null&quot;);\n   }\n   return result.getAccessToken();\n}\n</code></pre>\n"},{"tags":["java","guice"],"comments":[{"owner":{"account_id":4603196,"reputation":1932,"user_id":3733369,"accept_rate":44,"display_name":"rodridevops"},"score":0,"creation_date":1528179841,"post_id":50693221,"comment_id":88396139,"body_markdown":"Maybe, you could share with us that &quot;main&quot; function","body":"Maybe, you could share with us that &quot;main&quot; function"},{"owner":{"account_id":10538195,"reputation":45,"user_id":7765309,"accept_rate":25,"display_name":"wege"},"score":0,"creation_date":1528180115,"post_id":50693221,"comment_id":88396258,"body_markdown":"Sure, just edited the post","body":"Sure, just edited the post"},{"owner":{"account_id":4603196,"reputation":1932,"user_id":3733369,"accept_rate":44,"display_name":"rodridevops"},"score":0,"creation_date":1528180133,"post_id":50693221,"comment_id":88396266,"body_markdown":"What about line 31? could you mark it on the question?","body":"What about line 31? could you mark it on the question?"},{"owner":{"account_id":10538195,"reputation":45,"user_id":7765309,"accept_rate":25,"display_name":"wege"},"score":0,"creation_date":1528180562,"post_id":50693221,"comment_id":88396470,"body_markdown":"Line 31 is not include in the code above, but it was `exception.printStackTrace()`.","body":"Line 31 is not include in the code above, but it was <code>exception.printStackTrace()</code>."},{"owner":{"account_id":4603196,"reputation":1932,"user_id":3733369,"accept_rate":44,"display_name":"rodridevops"},"score":0,"creation_date":1528180961,"post_id":50693221,"comment_id":88396660,"body_markdown":"I can&#39;t see the big picture. Please add the code related to that stackTrace printing","body":"I can&#39;t see the big picture. Please add the code related to that stackTrace printing"},{"owner":{"account_id":4124531,"reputation":732,"user_id":5928411,"display_name":"Programmer Dancuk"},"score":0,"creation_date":1528181417,"post_id":50693221,"comment_id":88396919,"body_markdown":"Can you please tell Java version you are using? Java 9+ is breaking most of things","body":"Can you please tell Java version you are using? Java 9+ is breaking most of things"},{"owner":{"account_id":10538195,"reputation":45,"user_id":7765309,"accept_rate":25,"display_name":"wege"},"score":0,"creation_date":1528181567,"post_id":50693221,"comment_id":88396988,"body_markdown":"I use Java 10, but also tried 8 and 9. Nothing helped.","body":"I use Java 10, but also tried 8 and 9. Nothing helped."},{"owner":{"account_id":4603196,"reputation":1932,"user_id":3733369,"accept_rate":44,"display_name":"rodridevops"},"score":0,"creation_date":1528182936,"post_id":50693221,"comment_id":88397756,"body_markdown":"which version of guice are you using?","body":"which version of guice are you using?"},{"owner":{"account_id":10538195,"reputation":45,"user_id":7765309,"accept_rate":25,"display_name":"wege"},"score":0,"creation_date":1528183155,"post_id":50693221,"comment_id":88397897,"body_markdown":"I&#39;m using Guice 4.2.0","body":"I&#39;m using Guice 4.2.0"}],"answers":[{"tags":[],"owner":{"account_id":5989141,"reputation":5020,"user_id":7725621,"accept_rate":77,"display_name":"Kohei TAMURA"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1528254150,"creation_date":1528253836,"answer_id":50711635,"question_id":50693221,"body_markdown":"&gt; I use Java 10, but also tried 8 and 9. Nothing helped. \r\n\r\nI think you didn&#39;t use Java 8 or 9 because the exception is thrown from `ClassReader` due to using Java version 10 or later .\r\n\r\nhttps://gitlab.ow2.org/asm/asm/blob/f7f44a8e306dd2bd70f0db50194f6366938579c5/src/org/objectweb/asm/ClassReader.java#L160\r\n\r\n`Opcodes.V9` means Java 9. So please check your Java version again and run with Java 9 or earlier.","title":"Guice caused throwing UncaughtExceptionHandler","body":"<blockquote>\n  <p>I use Java 10, but also tried 8 and 9. Nothing helped. </p>\n</blockquote>\n\n<p>I think you didn't use Java 8 or 9 because the exception is thrown from <code>ClassReader</code> due to using Java version 10 or later .</p>\n\n<p><a href=\"https://gitlab.ow2.org/asm/asm/blob/f7f44a8e306dd2bd70f0db50194f6366938579c5/src/org/objectweb/asm/ClassReader.java#L160\" rel=\"nofollow noreferrer\">https://gitlab.ow2.org/asm/asm/blob/f7f44a8e306dd2bd70f0db50194f6366938579c5/src/org/objectweb/asm/ClassReader.java#L160</a></p>\n\n<p><code>Opcodes.V9</code> means Java 9. So please check your Java version again and run with Java 9 or earlier.</p>\n"},{"tags":[],"owner":{"account_id":8576980,"reputation":21,"user_id":6426032,"display_name":"Naman Sachdeva"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1643400978,"creation_date":1643400978,"answer_id":70899799,"question_id":50693221,"body_markdown":"I understand this is an old post. Posting the solution here for visibility -\r\n\r\nThe issue should be JDK11 incompatibility with GoogleGuice 4.0.\r\n\r\nGuice 4.0 does not support Java 9 (or above), but Guice 4.2 does. So, you should add an explicit dependency on GoogleGuice-4.2, and everything should work!","title":"Guice caused throwing UncaughtExceptionHandler","body":"<p>I understand this is an old post. Posting the solution here for visibility -</p>\n<p>The issue should be JDK11 incompatibility with GoogleGuice 4.0.</p>\n<p>Guice 4.0 does not support Java 9 (or above), but Guice 4.2 does. So, you should add an explicit dependency on GoogleGuice-4.2, and everything should work!</p>\n"},{"tags":[],"owner":{"account_id":29066382,"reputation":11,"user_id":22265865,"display_name":"user22265865"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689972717,"creation_date":1689972717,"answer_id":76741171,"question_id":50693221,"body_markdown":"If you are using JDK9 and above upgrade GoogleGuice version to 4.2 or above. I would suggest &gt;5. \r\nIt would show the actual underlying problems such as missing bindings or missing implementations. Hope this helps. ","title":"Guice caused throwing UncaughtExceptionHandler","body":"<p>If you are using JDK9 and above upgrade GoogleGuice version to 4.2 or above. I would suggest &gt;5.\nIt would show the actual underlying problems such as missing bindings or missing implementations. Hope this helps.</p>\n"}],"owner":{"account_id":10538195,"reputation":45,"user_id":7765309,"accept_rate":25,"display_name":"wege"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":10774,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":3,"score":1,"last_activity_date":1689972717,"creation_date":1528179255,"question_id":50693221,"body_markdown":"I would like to use Guice in my application but it throws following exception when I want to run it:\r\n\r\n    Exception in thread &quot;main&quot; \r\n    Exception: com.google.common.util.concurrent.UncheckedExecutionException thrown from the UncaughtExceptionHandler in thread &quot;main&quot;\r\n\r\nWhen I wrap `main()` function with try... catch block I receive folloving stackTrace:\r\n\r\n    Exception in thread &quot;main&quot; com.google.common.util.concurrent.UncheckedExecutionException: java.lang.IllegalArgumentException\r\n\t    at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2047)\r\n\t    at com.google.common.cache.LocalCache.get(LocalCache.java:3869)\r\n\t    at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3873)\r\n\t    at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4798)\r\n\t    at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4804)\r\n\t    at com.google.inject.internal.util.StackTraceElements.forMember(StackTraceElements.java:71)\r\n\t    at com.google.inject.internal.Messages.formatSource(Messages.java:241)\r\n\t    at com.google.inject.internal.Messages.formatSource(Messages.java:220)\r\n\t    at com.google.inject.internal.Messages.formatMessages(Messages.java:90)\r\n\t    at com.google.inject.CreationException.getMessage(CreationException.java:50)\r\n\t    at java.base/java.lang.Throwable.getLocalizedMessage(Throwable.java:396)\r\n\t    at java.base/java.lang.Throwable.toString(Throwable.java:485)\r\n\t    at java.base/java.lang.String.valueOf(String.java:2788)\r\n\t    at java.base/java.io.PrintStream.println(PrintStream.java:897)\r\n\t    at java.base/java.lang.Throwable$WrappedPrintStream.println(Throwable.java:752)\r\n\t    at java.base/java.lang.Throwable.printStackTrace(Throwable.java:659)\r\n\t    at java.base/java.lang.Throwable.printStackTrace(Throwable.java:648)\r\n\t    at java.base/java.lang.Throwable.printStackTrace(Throwable.java:639)\r\n\t    at com.github.blackjack.Main.main(Main.java:31)\r\n    Caused by: java.lang.IllegalArgumentException\r\n\t    at com.google.inject.internal.asm.$ClassReader.&lt;init&gt;(ClassReader.java:160)\r\n\t    at com.google.inject.internal.asm.$ClassReader.&lt;init&gt;(ClassReader.java:143)\r\n\t    at com.google.inject.internal.asm.$ClassReader.&lt;init&gt;(ClassReader.java:418)\r\n\t    at com.google.inject.internal.util.LineNumbers.&lt;init&gt;(LineNumbers.java:64)\r\n\t    at com.google.inject.internal.util.StackTraceElements$1.load(StackTraceElements.java:49)\r\n\t    at com.google.inject.internal.util.StackTraceElements$1.load(StackTraceElements.java:45)\r\n\t    at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3443)\r\n\t    at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2169)\r\n\t    at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2128)\r\n\t    at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2041)\r\n\t    ... 18 more\r\n\r\nFrom the information I found this exception was caused by method contains a lambda definition, is thrown by Provides method. Nevertheless it should be fixed with Guice 4.0. Maybe someone know how to fix it and can help?\r\nThanks in advance!\r\n\r\n`main()` function:\r\n\r\n    public static void main (String[] args){\r\n        try{\r\n            MainModule module = new MainModule();\r\n            Injector injector = Guice.createInjector(module);\r\n\r\n            GameFactory gameFactory = injector.getInstance(GameFactory.class);\r\n            DeckFactory blackjackDeckFactory = injector.getInstance(BlackjackDeckCreator.class);\r\n            PlayerFactory playerFactory = injector.getInstance(PlayerFactory.class);\r\n\r\n            Player player = playerFactory.createPlayer(&quot;Paul&quot;);\r\n            Player dealer = playerFactory.createPlayer(&quot;Dealer&quot;, true);\r\n\r\n            Deck deck = blackjackDeckFactory.createDeck();\r\n\r\n            Game game = gameFactory.createGame(player, dealer, deck);\r\n            game.start();\r\n        } catch (Exception e){\r\n            e.printStackTrace(); // line 31\r\n        }\r\n    }","title":"Guice caused throwing UncaughtExceptionHandler","body":"<p>I would like to use Guice in my application but it throws following exception when I want to run it:</p>\n\n<pre><code>Exception in thread \"main\" \nException: com.google.common.util.concurrent.UncheckedExecutionException thrown from the UncaughtExceptionHandler in thread \"main\"\n</code></pre>\n\n<p>When I wrap <code>main()</code> function with try... catch block I receive folloving stackTrace:</p>\n\n<pre><code>Exception in thread \"main\" com.google.common.util.concurrent.UncheckedExecutionException: java.lang.IllegalArgumentException\n    at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2047)\n    at com.google.common.cache.LocalCache.get(LocalCache.java:3869)\n    at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3873)\n    at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4798)\n    at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4804)\n    at com.google.inject.internal.util.StackTraceElements.forMember(StackTraceElements.java:71)\n    at com.google.inject.internal.Messages.formatSource(Messages.java:241)\n    at com.google.inject.internal.Messages.formatSource(Messages.java:220)\n    at com.google.inject.internal.Messages.formatMessages(Messages.java:90)\n    at com.google.inject.CreationException.getMessage(CreationException.java:50)\n    at java.base/java.lang.Throwable.getLocalizedMessage(Throwable.java:396)\n    at java.base/java.lang.Throwable.toString(Throwable.java:485)\n    at java.base/java.lang.String.valueOf(String.java:2788)\n    at java.base/java.io.PrintStream.println(PrintStream.java:897)\n    at java.base/java.lang.Throwable$WrappedPrintStream.println(Throwable.java:752)\n    at java.base/java.lang.Throwable.printStackTrace(Throwable.java:659)\n    at java.base/java.lang.Throwable.printStackTrace(Throwable.java:648)\n    at java.base/java.lang.Throwable.printStackTrace(Throwable.java:639)\n    at com.github.blackjack.Main.main(Main.java:31)\nCaused by: java.lang.IllegalArgumentException\n    at com.google.inject.internal.asm.$ClassReader.&lt;init&gt;(ClassReader.java:160)\n    at com.google.inject.internal.asm.$ClassReader.&lt;init&gt;(ClassReader.java:143)\n    at com.google.inject.internal.asm.$ClassReader.&lt;init&gt;(ClassReader.java:418)\n    at com.google.inject.internal.util.LineNumbers.&lt;init&gt;(LineNumbers.java:64)\n    at com.google.inject.internal.util.StackTraceElements$1.load(StackTraceElements.java:49)\n    at com.google.inject.internal.util.StackTraceElements$1.load(StackTraceElements.java:45)\n    at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3443)\n    at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2169)\n    at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2128)\n    at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2041)\n    ... 18 more\n</code></pre>\n\n<p>From the information I found this exception was caused by method contains a lambda definition, is thrown by Provides method. Nevertheless it should be fixed with Guice 4.0. Maybe someone know how to fix it and can help?\nThanks in advance!</p>\n\n<p><code>main()</code> function:</p>\n\n<pre><code>public static void main (String[] args){\n    try{\n        MainModule module = new MainModule();\n        Injector injector = Guice.createInjector(module);\n\n        GameFactory gameFactory = injector.getInstance(GameFactory.class);\n        DeckFactory blackjackDeckFactory = injector.getInstance(BlackjackDeckCreator.class);\n        PlayerFactory playerFactory = injector.getInstance(PlayerFactory.class);\n\n        Player player = playerFactory.createPlayer(\"Paul\");\n        Player dealer = playerFactory.createPlayer(\"Dealer\", true);\n\n        Deck deck = blackjackDeckFactory.createDeck();\n\n        Game game = gameFactory.createGame(player, dealer, deck);\n        game.start();\n    } catch (Exception e){\n        e.printStackTrace(); // line 31\n    }\n}\n</code></pre>\n"},{"tags":["java","spring","cas"],"answers":[{"tags":[],"owner":{"account_id":1656067,"reputation":496,"user_id":1525602,"display_name":"Petr Bodn&#225;r"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689972383,"creation_date":1689972383,"answer_id":76741142,"question_id":76731244,"body_markdown":"## The Problem\r\n\r\nThe main problem seems to be that you try to access field `phoneNumber` inside object `phoneNumber` of type `String` (see [Thymeleaf documentation][1] if unsure about the asterisk syntax):\r\n\r\nJava:\r\n\r\n```java\r\n            createFlowVariable(flow, &quot;phoneNumber&quot;, String.class);\r\n```\r\n\r\nThymeleaf:\r\n\r\n```thymeleaf\r\n        &lt;form method=&quot;post&quot; id=&quot;fm1&quot; th:action=&quot;@{/login}&quot; th:object=&quot;${phoneNumber}&quot;&gt;\r\n            ...\r\n                            &lt;input class=&quot;mdc-text-field__input form-control pwd&quot;\r\n                                   ...\r\n                                   th:field=&quot;*{phoneNumber}&quot;\r\n```\r\n\r\nNote that the last line above is referenced from the logs you provided (while `th:field` being a Spring extension to Thymeleaf):\r\n\r\n```\r\n2023-07-20 16:51:33,812 ERROR [org.thymeleaf.TemplateEngine] - &lt;[THYMELEAF][https-jsse-nio-8443-exec-1] Exception processing template &quot;phoneNumberEntry&quot;: Error during execution of processor &#39;org.thymeleaf.spring5.processor.SpringInputGeneralFieldTagProcessor&#39; (template: &quot;phoneNumberEntry&quot; - line 42, col 36)&gt;\r\n```\r\n\r\n## The Fix\r\n\r\nI think the simplest fix should be to change the web flow object from `String` to a proper &quot;form bean class&quot; with 1 field (and potentially other fields when more input is needed in the future). I.e., when we focus just on the key parts of the code again, it could look like this:\r\n\r\nJava:\r\n\r\n```java\r\n            createFlowVariable(flow, &quot;phoneNumberForm&quot;, PhoneNumberForm.class);\r\n```\r\n\r\nThymeleaf:\r\n\r\n```thymeleaf\r\n        &lt;form method=&quot;post&quot; id=&quot;fm1&quot; th:action=&quot;@{/login}&quot; th:object=&quot;${phoneNumberForm}&quot;&gt;\r\n            ...\r\n                            &lt;input class=&quot;mdc-text-field__input form-control pwd&quot;\r\n                                   ...\r\n                                   th:field=&quot;*{phoneNumber}&quot;\r\n```\r\n\r\n[1]: https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#expressions-on-selections-asterisk-syntax","title":"Customizing CAS server with a custom MFA provider and a custom flow","body":"<h2>The Problem</h2>\n<p>The main problem seems to be that you try to access field <code>phoneNumber</code> inside object <code>phoneNumber</code> of type <code>String</code> (see <a href=\"https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#expressions-on-selections-asterisk-syntax\" rel=\"nofollow noreferrer\">Thymeleaf documentation</a> if unsure about the asterisk syntax):</p>\n<p>Java:</p>\n<pre class=\"lang-java prettyprint-override\"><code>            createFlowVariable(flow, &quot;phoneNumber&quot;, String.class);\n</code></pre>\n<p>Thymeleaf:</p>\n<pre><code>        &lt;form method=&quot;post&quot; id=&quot;fm1&quot; th:action=&quot;@{/login}&quot; th:object=&quot;${phoneNumber}&quot;&gt;\n            ...\n                            &lt;input class=&quot;mdc-text-field__input form-control pwd&quot;\n                                   ...\n                                   th:field=&quot;*{phoneNumber}&quot;\n</code></pre>\n<p>Note that the last line above is referenced from the logs you provided (while <code>th:field</code> being a Spring extension to Thymeleaf):</p>\n<pre><code>2023-07-20 16:51:33,812 ERROR [org.thymeleaf.TemplateEngine] - &lt;[THYMELEAF][https-jsse-nio-8443-exec-1] Exception processing template &quot;phoneNumberEntry&quot;: Error during execution of processor 'org.thymeleaf.spring5.processor.SpringInputGeneralFieldTagProcessor' (template: &quot;phoneNumberEntry&quot; - line 42, col 36)&gt;\n</code></pre>\n<h2>The Fix</h2>\n<p>I think the simplest fix should be to change the web flow object from <code>String</code> to a proper &quot;form bean class&quot; with 1 field (and potentially other fields when more input is needed in the future). I.e., when we focus just on the key parts of the code again, it could look like this:</p>\n<p>Java:</p>\n<pre class=\"lang-java prettyprint-override\"><code>            createFlowVariable(flow, &quot;phoneNumberForm&quot;, PhoneNumberForm.class);\n</code></pre>\n<p>Thymeleaf:</p>\n<pre><code>        &lt;form method=&quot;post&quot; id=&quot;fm1&quot; th:action=&quot;@{/login}&quot; th:object=&quot;${phoneNumberForm}&quot;&gt;\n            ...\n                            &lt;input class=&quot;mdc-text-field__input form-control pwd&quot;\n                                   ...\n                                   th:field=&quot;*{phoneNumber}&quot;\n</code></pre>\n"}],"owner":{"account_id":29058049,"reputation":1,"user_id":22259410,"display_name":"R3dSh4d0vv"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":58,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689972383,"creation_date":1689865433,"question_id":76731244,"body_markdown":"I am trying to customize a CAS server by adding a custom multi-factor authentication (MFA) provider. Specifically, I want to modify the flow of the Authy provider. After login, I want users to arrive at a page where they can enter a phone number. This phone number will then be used to send a verification code.\r\n\r\nHere is my webflow configurer:\r\n\r\n```\r\npublic class AuthyMultifactorWebflowConfigurer extends AbstractCasMultifactorWebflowConfigurer {\r\n\r\n    /**\r\n     * Webflow event id.\r\n     */\r\n    public static final String MFA_AUTHY_EVENT_ID = &quot;mfa-authy&quot;;\r\n\r\n    public AuthyMultifactorWebflowConfigurer(final FlowBuilderServices flowBuilderServices,\r\n                                             final FlowDefinitionRegistry loginFlowDefinitionRegistry,\r\n                                             final FlowDefinitionRegistry flowDefinitionRegistry,\r\n                                             final ConfigurableApplicationContext applicationContext,\r\n                                             final CasConfigurationProperties casProperties,\r\n                                             final List&lt;CasMultifactorWebflowCustomizer&gt; mfaFlowCustomizers) {\r\n        super(flowBuilderServices, loginFlowDefinitionRegistry, applicationContext,\r\n                casProperties, Optional.of(flowDefinitionRegistry), mfaFlowCustomizers);\r\n    }\r\n\r\n    @Override\r\n    protected void doInitialize() {\r\n        multifactorAuthenticationFlowDefinitionRegistries.forEach(registry -&gt; {\r\n\r\n            val flow = getFlow(registry, MFA_AUTHY_EVENT_ID);\r\n            createFlowVariable(flow, &quot;phoneNumber&quot;, String.class);\r\n\r\n            flow.getStartActionList().add(createEvaluateAction(CasWebflowConstants.ACTION_ID_INITIAL_FLOW_SETUP));\r\n\r\n            createEndState(flow, CasWebflowConstants.STATE_ID_SUCCESS);\r\n\r\n            val initLoginFormState = createActionState(flow, CasWebflowConstants.STATE_ID_INIT_LOGIN_FORM,\r\n                    createEvaluateAction(CasWebflowConstants.ACTION_ID_INIT_LOGIN_ACTION));\r\n\r\n            createTransitionForState(initLoginFormState, CasWebflowConstants.TRANSITION_ID_SUCCESS, &quot;phoneNumberEntryState&quot;);\r\n\r\n            val phoneNumberProperties = CollectionUtils.wrapList(&quot;phoneNumber&quot;);\r\n            val phoneNumberBinder = createStateBinderConfiguration(phoneNumberProperties);\r\n\r\n            val phoneNumberEntryState = createViewState(flow, &quot;phoneNumberEntryState&quot;, &quot;phoneNumberEntry&quot;, phoneNumberBinder);\r\n            createStateModelBinding(phoneNumberEntryState, &quot;phoneNumber&quot;, String.class);\r\n            val setPrincipalAction = createSetAction(&quot;viewScope.principal&quot;, &quot;conversationScope.authentication.principal&quot;);\r\n            phoneNumberEntryState.getEntryActionList().addAll(setPrincipalAction);\r\n            createTransitionForState(phoneNumberEntryState, CasWebflowConstants.TRANSITION_ID_SUBMIT,&quot;phoneNumberEntryAction&quot;);\r\n            \r\n            val phoneNumberEntryActionState = createActionState(flow, &quot;phoneNumberEntryAction&quot;,\r\n                    createEvaluateAction(&quot;phoneNumberEntryAction&quot;));\r\n\r\n            createTransitionForState(phoneNumberEntryActionState, CasWebflowConstants.TRANSITION_ID_SUCCESS, CasWebflowConstants.STATE_ID_SUCCESS);\r\n            createTransitionForState(phoneNumberEntryActionState, CasWebflowConstants.TRANSITION_ID_ERROR, &quot;phoneNumberEntryState&quot;);\r\n\r\n            setStartState(flow, initLoginFormState);\r\n\r\n            registerMultifactorProviderAuthenticationWebflow(getLoginFlow(), MFA_AUTHY_EVENT_ID,\r\n                    casProperties.getAuthn().getMfa().getAuthy().getId());\r\n        });\r\n    }\r\n}\r\n```\r\n\r\nAnd here is the Thymeleaf view for the page where users enter their phone number\r\n\r\n```\r\n&lt;!DOCTYPE html&gt;\r\n&lt;html xmlns:layout=&quot;http://www.ultraq.net.nz/thymeleaf/layout&quot; xmlns:th=&quot;http://www.w3.org/1999/xhtml&quot;\r\n      layout:decorate=&quot;~{layout}&quot;&gt;\r\n\r\n&lt;head&gt;\r\n    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;/&gt;\r\n    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;/&gt;\r\n\r\n    &lt;title th:text=&quot;#{cas.mfa.authy.pagetitle}&quot;&gt;Authy Login View&lt;/title&gt;\r\n    &lt;link href=&quot;./cas.css&quot; rel=&quot;stylesheet&quot; th:remove=&quot;tag&quot;/&gt;\r\n&lt;/head&gt;\r\n\r\n&lt;body&gt;\r\n&lt;main role=&quot;main&quot; class=&quot;container mt-3 mb-3&quot;&gt;\r\n    &lt;div layout:fragment=&quot;content&quot; class=&quot;mdc-card card p-4 m-auto w-lg-66&quot;&gt;\r\n        &lt;form method=&quot;post&quot; id=&quot;fm1&quot; th:action=&quot;@{/login}&quot; th:object=&quot;${phoneNumber}&quot;&gt;\r\n            &lt;input type=&quot;hidden&quot; name=&quot;_eventId_submit&quot; value=&quot;LOGIN&quot; /&gt;\r\n            &lt;input type=&quot;hidden&quot; name=&quot;execution&quot; th:value=&quot;${flowExecutionKey}&quot; /&gt;\r\n            &lt;input type=&quot;hidden&quot; name=&quot;geolocation&quot; /&gt;\r\n            &lt;div id=&quot;msg&quot; class=&quot;banner banner-danger alert alert-danger my-2&quot; role=&quot;alert&quot;\r\n                 th:if=&quot;${#fields.hasErrors(&#39;*&#39;)}&quot;&gt;\r\n                &lt;span th:each=&quot;err : ${#fields.errors(&#39;*&#39;)}&quot; th:utext=&quot;${err + &#39; &#39;}&quot;&gt;this error block and text is only shown\r\n                    if there are errors&lt;/span&gt;\r\n            &lt;/div&gt;\r\n\r\n            &lt;div class=&quot;cas-field form-group my-3 mdc-input-group d-flex&quot;&gt;\r\n                &lt;div class=&quot;mdc-input-group-field mdc-input-group-field-append&quot;&gt;\r\n                    &lt;div class=&quot;d-flex caps-check&quot;&gt;\r\n                        &lt;label for=&quot;phoneNumber&quot;\r\n                               class=&quot;mdc-text-field mdc-text-field--outlined control-label mdc-text-field--with-trailing-icon&quot;&gt;\r\n                            &lt;span class=&quot;mdc-notched-outline&quot;&gt;\r\n                                &lt;span class=&quot;mdc-notched-outline__leading&quot;&gt;&lt;/span&gt;\r\n                                &lt;span class=&quot;mdc-notched-outline__notch&quot;&gt;\r\n                                    &lt;span class=&quot;mdc-floating-label&quot;&gt;Number&lt;/span&gt;\r\n                                &lt;/span&gt;\r\n                                &lt;span class=&quot;mdc-notched-outline__trailing&quot;&gt;&lt;/span&gt;\r\n                            &lt;/span&gt;\r\n                            &lt;input class=&quot;mdc-text-field__input form-control pwd&quot;\r\n                                   type=&quot;text&quot;\r\n                                   name=&quot;phoneNumber&quot;\r\n                                   id=&quot;phoneNumber&quot;\r\n                                   th:field=&quot;*{phoneNumber}&quot;\r\n                                   size=&quot;25&quot;\r\n                                   autocomplete=&quot;off&quot; required /&gt;\r\n                        &lt;/label&gt;\r\n\r\n                    &lt;/div&gt;\r\n                &lt;/div&gt;\r\n\r\n                &lt;button class=&quot;mdc-button mdc-button--raised&quot; accesskey=&quot;l&quot;&gt;\r\n                    &lt;span class=&quot;mdc-button__label&quot;&gt;Validate&lt;/span&gt;\r\n                &lt;/button&gt;\r\n            &lt;/div&gt;\r\n        &lt;/form&gt;\r\n    &lt;/div&gt;\r\n&lt;/main&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt; \r\n```\r\n\r\nWhen I launch the server, I can log in, but after that, I receive a page without the field to enter the phone number. The console logs the following error:\r\n\r\n```\r\n2023-07-20 16:51:33,812 ERROR [org.thymeleaf.TemplateEngine] - &lt;[THYMELEAF][https-jsse-nio-8443-exec-1] Exception processing template &quot;phoneNumberEntry&quot;: Error during execution of processor &#39;org.thymeleaf.spring5.processor.SpringInputGeneralFieldTagProcessor&#39; (template: &quot;phoneNumberEntry&quot; - line 42, col 36)&gt;\r\n2023-07-20 16:51:33,817 ERROR [org.springframework.boot.web.servlet.support.ErrorPageFilter] - &lt;Cannot forward to error page for request [/login] as the response has already been committed. As a result, the response may have the wrong status code. If your application is running on WebSphere Application Server you may be able to resolve this problem by setting com.ibm.ws.webcontainer.invokeFlushAfterService to false&gt;\r\n```\r\n\r\nI&#39;m not familiar with Spring Web Flow, so I&#39;m unsure how to proceed. Any help would be great!","title":"Customizing CAS server with a custom MFA provider and a custom flow","body":"<p>I am trying to customize a CAS server by adding a custom multi-factor authentication (MFA) provider. Specifically, I want to modify the flow of the Authy provider. After login, I want users to arrive at a page where they can enter a phone number. This phone number will then be used to send a verification code.</p>\n<p>Here is my webflow configurer:</p>\n<pre><code>public class AuthyMultifactorWebflowConfigurer extends AbstractCasMultifactorWebflowConfigurer {\n\n    /**\n     * Webflow event id.\n     */\n    public static final String MFA_AUTHY_EVENT_ID = &quot;mfa-authy&quot;;\n\n    public AuthyMultifactorWebflowConfigurer(final FlowBuilderServices flowBuilderServices,\n                                             final FlowDefinitionRegistry loginFlowDefinitionRegistry,\n                                             final FlowDefinitionRegistry flowDefinitionRegistry,\n                                             final ConfigurableApplicationContext applicationContext,\n                                             final CasConfigurationProperties casProperties,\n                                             final List&lt;CasMultifactorWebflowCustomizer&gt; mfaFlowCustomizers) {\n        super(flowBuilderServices, loginFlowDefinitionRegistry, applicationContext,\n                casProperties, Optional.of(flowDefinitionRegistry), mfaFlowCustomizers);\n    }\n\n    @Override\n    protected void doInitialize() {\n        multifactorAuthenticationFlowDefinitionRegistries.forEach(registry -&gt; {\n\n            val flow = getFlow(registry, MFA_AUTHY_EVENT_ID);\n            createFlowVariable(flow, &quot;phoneNumber&quot;, String.class);\n\n            flow.getStartActionList().add(createEvaluateAction(CasWebflowConstants.ACTION_ID_INITIAL_FLOW_SETUP));\n\n            createEndState(flow, CasWebflowConstants.STATE_ID_SUCCESS);\n\n            val initLoginFormState = createActionState(flow, CasWebflowConstants.STATE_ID_INIT_LOGIN_FORM,\n                    createEvaluateAction(CasWebflowConstants.ACTION_ID_INIT_LOGIN_ACTION));\n\n            createTransitionForState(initLoginFormState, CasWebflowConstants.TRANSITION_ID_SUCCESS, &quot;phoneNumberEntryState&quot;);\n\n            val phoneNumberProperties = CollectionUtils.wrapList(&quot;phoneNumber&quot;);\n            val phoneNumberBinder = createStateBinderConfiguration(phoneNumberProperties);\n\n            val phoneNumberEntryState = createViewState(flow, &quot;phoneNumberEntryState&quot;, &quot;phoneNumberEntry&quot;, phoneNumberBinder);\n            createStateModelBinding(phoneNumberEntryState, &quot;phoneNumber&quot;, String.class);\n            val setPrincipalAction = createSetAction(&quot;viewScope.principal&quot;, &quot;conversationScope.authentication.principal&quot;);\n            phoneNumberEntryState.getEntryActionList().addAll(setPrincipalAction);\n            createTransitionForState(phoneNumberEntryState, CasWebflowConstants.TRANSITION_ID_SUBMIT,&quot;phoneNumberEntryAction&quot;);\n            \n            val phoneNumberEntryActionState = createActionState(flow, &quot;phoneNumberEntryAction&quot;,\n                    createEvaluateAction(&quot;phoneNumberEntryAction&quot;));\n\n            createTransitionForState(phoneNumberEntryActionState, CasWebflowConstants.TRANSITION_ID_SUCCESS, CasWebflowConstants.STATE_ID_SUCCESS);\n            createTransitionForState(phoneNumberEntryActionState, CasWebflowConstants.TRANSITION_ID_ERROR, &quot;phoneNumberEntryState&quot;);\n\n            setStartState(flow, initLoginFormState);\n\n            registerMultifactorProviderAuthenticationWebflow(getLoginFlow(), MFA_AUTHY_EVENT_ID,\n                    casProperties.getAuthn().getMfa().getAuthy().getId());\n        });\n    }\n}\n</code></pre>\n<p>And here is the Thymeleaf view for the page where users enter their phone number</p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html xmlns:layout=&quot;http://www.ultraq.net.nz/thymeleaf/layout&quot; xmlns:th=&quot;http://www.w3.org/1999/xhtml&quot;\n      layout:decorate=&quot;~{layout}&quot;&gt;\n\n&lt;head&gt;\n    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;/&gt;\n    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;/&gt;\n\n    &lt;title th:text=&quot;#{cas.mfa.authy.pagetitle}&quot;&gt;Authy Login View&lt;/title&gt;\n    &lt;link href=&quot;./cas.css&quot; rel=&quot;stylesheet&quot; th:remove=&quot;tag&quot;/&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;main role=&quot;main&quot; class=&quot;container mt-3 mb-3&quot;&gt;\n    &lt;div layout:fragment=&quot;content&quot; class=&quot;mdc-card card p-4 m-auto w-lg-66&quot;&gt;\n        &lt;form method=&quot;post&quot; id=&quot;fm1&quot; th:action=&quot;@{/login}&quot; th:object=&quot;${phoneNumber}&quot;&gt;\n            &lt;input type=&quot;hidden&quot; name=&quot;_eventId_submit&quot; value=&quot;LOGIN&quot; /&gt;\n            &lt;input type=&quot;hidden&quot; name=&quot;execution&quot; th:value=&quot;${flowExecutionKey}&quot; /&gt;\n            &lt;input type=&quot;hidden&quot; name=&quot;geolocation&quot; /&gt;\n            &lt;div id=&quot;msg&quot; class=&quot;banner banner-danger alert alert-danger my-2&quot; role=&quot;alert&quot;\n                 th:if=&quot;${#fields.hasErrors('*')}&quot;&gt;\n                &lt;span th:each=&quot;err : ${#fields.errors('*')}&quot; th:utext=&quot;${err + ' '}&quot;&gt;this error block and text is only shown\n                    if there are errors&lt;/span&gt;\n            &lt;/div&gt;\n\n            &lt;div class=&quot;cas-field form-group my-3 mdc-input-group d-flex&quot;&gt;\n                &lt;div class=&quot;mdc-input-group-field mdc-input-group-field-append&quot;&gt;\n                    &lt;div class=&quot;d-flex caps-check&quot;&gt;\n                        &lt;label for=&quot;phoneNumber&quot;\n                               class=&quot;mdc-text-field mdc-text-field--outlined control-label mdc-text-field--with-trailing-icon&quot;&gt;\n                            &lt;span class=&quot;mdc-notched-outline&quot;&gt;\n                                &lt;span class=&quot;mdc-notched-outline__leading&quot;&gt;&lt;/span&gt;\n                                &lt;span class=&quot;mdc-notched-outline__notch&quot;&gt;\n                                    &lt;span class=&quot;mdc-floating-label&quot;&gt;Number&lt;/span&gt;\n                                &lt;/span&gt;\n                                &lt;span class=&quot;mdc-notched-outline__trailing&quot;&gt;&lt;/span&gt;\n                            &lt;/span&gt;\n                            &lt;input class=&quot;mdc-text-field__input form-control pwd&quot;\n                                   type=&quot;text&quot;\n                                   name=&quot;phoneNumber&quot;\n                                   id=&quot;phoneNumber&quot;\n                                   th:field=&quot;*{phoneNumber}&quot;\n                                   size=&quot;25&quot;\n                                   autocomplete=&quot;off&quot; required /&gt;\n                        &lt;/label&gt;\n\n                    &lt;/div&gt;\n                &lt;/div&gt;\n\n                &lt;button class=&quot;mdc-button mdc-button--raised&quot; accesskey=&quot;l&quot;&gt;\n                    &lt;span class=&quot;mdc-button__label&quot;&gt;Validate&lt;/span&gt;\n                &lt;/button&gt;\n            &lt;/div&gt;\n        &lt;/form&gt;\n    &lt;/div&gt;\n&lt;/main&gt;\n&lt;/body&gt;\n&lt;/html&gt; \n</code></pre>\n<p>When I launch the server, I can log in, but after that, I receive a page without the field to enter the phone number. The console logs the following error:</p>\n<pre><code>2023-07-20 16:51:33,812 ERROR [org.thymeleaf.TemplateEngine] - &lt;[THYMELEAF][https-jsse-nio-8443-exec-1] Exception processing template &quot;phoneNumberEntry&quot;: Error during execution of processor 'org.thymeleaf.spring5.processor.SpringInputGeneralFieldTagProcessor' (template: &quot;phoneNumberEntry&quot; - line 42, col 36)&gt;\n2023-07-20 16:51:33,817 ERROR [org.springframework.boot.web.servlet.support.ErrorPageFilter] - &lt;Cannot forward to error page for request [/login] as the response has already been committed. As a result, the response may have the wrong status code. If your application is running on WebSphere Application Server you may be able to resolve this problem by setting com.ibm.ws.webcontainer.invokeFlushAfterService to false&gt;\n</code></pre>\n<p>I'm not familiar with Spring Web Flow, so I'm unsure how to proceed. Any help would be great!</p>\n"},{"tags":["java"],"answers":[{"tags":[],"owner":{"account_id":23740623,"reputation":1,"user_id":17758716,"display_name":"Reilas"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689968976,"creation_date":1689968976,"answer_id":76740862,"question_id":76740774,"body_markdown":"&gt; _&quot;java.lang.Integer, Integer.compare does it only return the values of -1,0 and 1. ...&quot;_\r\n\r\nYes, it does.&amp;nbsp; Here is the code from the _OpenJDK_.\r\n\r\n_[GitHub &amp;ndash; jdk/src/java.base/share/classes/java/lang/Integer.java](https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes/java/lang/Integer.java#L1486)_.\r\n\r\n```java\r\npublic static int compare(int x, int y) {\r\n    return (x &lt; y) ? -1 : ((x == y) ? 0 : 1);\r\n}\r\n```\r\n\r\n&gt; _&quot;If so why does java documentation say a value less than 0 if x &lt; y; and a value greater than 0 if x &gt; y. Why can&#39;t they just say it returns -1, 0, 1? ...&quot;_\r\n\r\nBecause technically those conditional statements would suffice.\r\n\r\n&gt; _&quot;... Im pretty sure it only return values of -1,0, 1 and not sure if I want to do a comparison should I do if(Integer.compare(2,1) == 1) or if(Integer.compare(2,1) &gt; 0)&quot;_\r\n\r\nEither will work; there wouldn&#39;t be any performance impact here.","title":"java.lang.Integer, Integer.compare does it only return the values of -1,0 and 1. If so","body":"<blockquote>\n<p><em>&quot;java.lang.Integer, Integer.compare does it only return the values of -1,0 and 1. ...&quot;</em></p>\n</blockquote>\n<p>Yes, it does.  Here is the code from the <em>OpenJDK</em>.</p>\n<p><em><a href=\"https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes/java/lang/Integer.java#L1486\" rel=\"nofollow noreferrer\">GitHub – jdk/src/java.base/share/classes/java/lang/Integer.java</a></em>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static int compare(int x, int y) {\n    return (x &lt; y) ? -1 : ((x == y) ? 0 : 1);\n}\n</code></pre>\n<blockquote>\n<p><em>&quot;If so why does java documentation say a value less than 0 if x &lt; y; and a value greater than 0 if x &gt; y. Why can't they just say it returns -1, 0, 1? ...&quot;</em></p>\n</blockquote>\n<p>Because technically those conditional statements would suffice.</p>\n<blockquote>\n<p><em>&quot;... Im pretty sure it only return values of -1,0, 1 and not sure if I want to do a comparison should I do if(Integer.compare(2,1) == 1) or if(Integer.compare(2,1) &gt; 0)&quot;</em></p>\n</blockquote>\n<p>Either will work; there wouldn't be any performance impact here.</p>\n"},{"tags":[],"owner":{"account_id":372682,"reputation":22426,"user_id":721855,"display_name":"aled"},"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1689970151,"creation_date":1689970151,"answer_id":76740955,"question_id":76740774,"body_markdown":"The implementation could change as long as it complies with the [documented behavior][1]. Return values of -1, 0, 1 are values consistent with that. Although it is unlikely to change the future safe way of comparing would be to compare with less than zero, equal to zero, or greater than zero.\r\n\r\n\r\n  [1]: https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html#compare(int,int)","title":"java.lang.Integer, Integer.compare does it only return the values of -1,0 and 1. If so","body":"<p>The implementation could change as long as it complies with the <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html#compare(int,int)\" rel=\"nofollow noreferrer\">documented behavior</a>. Return values of -1, 0, 1 are values consistent with that. Although it is unlikely to change the future safe way of comparing would be to compare with less than zero, equal to zero, or greater than zero.</p>\n"},{"tags":[],"owner":{"account_id":4228398,"reputation":17727,"user_id":3461397,"display_name":"Oleg Cherednik"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1689972162,"creation_date":1689972162,"answer_id":76741112,"question_id":76740774,"body_markdown":"In case you check the implemenation, you will see:\r\n```java\r\npublic static int compare(int x, int y) {\r\n    return (x &lt; y) ? -1 : ((x == y) ? 0 : 1);\r\n}\r\n```\r\nBut in java doc of this method it says, that:\r\n```\r\n@return the value {@code 0} if {@code x == y};\r\n        a value less than {@code 0} if {@code x &lt; y}; and\r\n        a value greater than {@code 0} if {@code x &gt; y}\r\n```\r\n\r\nYou definitely can check for `-1,0,1`, but I recommend you to check `&lt;0,0,&gt;0` - this is **much more reliable**. Just to protect the code.\r\n\r\n```java\r\nif(Integer.compare(2,1) == 1) {} // this is 100% correct\r\nif(Integer.compare(2,1) &gt; 0)  {} // this is 999% correct\r\n```","title":"java.lang.Integer, Integer.compare does it only return the values of -1,0 and 1. If so","body":"<p>In case you check the implemenation, you will see:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static int compare(int x, int y) {\n    return (x &lt; y) ? -1 : ((x == y) ? 0 : 1);\n}\n</code></pre>\n<p>But in java doc of this method it says, that:</p>\n<pre><code>@return the value {@code 0} if {@code x == y};\n        a value less than {@code 0} if {@code x &lt; y}; and\n        a value greater than {@code 0} if {@code x &gt; y}\n</code></pre>\n<p>You definitely can check for <code>-1,0,1</code>, but I recommend you to check <code>&lt;0,0,&gt;0</code> - this is <strong>much more reliable</strong>. Just to protect the code.</p>\n<pre class=\"lang-java prettyprint-override\"><code>if(Integer.compare(2,1) == 1) {} // this is 100% correct\nif(Integer.compare(2,1) &gt; 0)  {} // this is 999% correct\n</code></pre>\n"}],"owner":{"account_id":29066094,"reputation":11,"user_id":22265642,"display_name":"Joey Zheng"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":33,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":3,"score":0,"last_activity_date":1689972162,"creation_date":1689968046,"question_id":76740774,"body_markdown":"If so why does java documentation say a value less than `0` if `x &lt; y`; and a value greater than `0` if `x &gt; y`. Why can&#39;t they just say it returns `-1`,`0`,`1`? \r\n\r\n\r\nIm pretty sure it only return values of `-1`,`0`,`1` and not sure if I want to do a comparison should I do \r\n`if(Integer.compare(2,1) == 1)` or\r\n`if(Integer.compare(2,1) &gt; 0)`","title":"java.lang.Integer, Integer.compare does it only return the values of -1,0 and 1. If so","body":"<p>If so why does java documentation say a value less than <code>0</code> if <code>x &lt; y</code>; and a value greater than <code>0</code> if <code>x &gt; y</code>. Why can't they just say it returns <code>-1</code>,<code>0</code>,<code>1</code>?</p>\n<p>Im pretty sure it only return values of <code>-1</code>,<code>0</code>,<code>1</code> and not sure if I want to do a comparison should I do\n<code>if(Integer.compare(2,1) == 1)</code> or\n<code>if(Integer.compare(2,1) &gt; 0)</code></p>\n"},{"tags":["java","hibernate","jpa","hibernate-criteria","criteriaquery"],"owner":{"account_id":25938029,"reputation":11,"user_id":19657948,"display_name":"Arash"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":25,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1689970845,"creation_date":1689970812,"question_id":76741002,"body_markdown":"I&#39;m trying to create a generified *get* method for my DAO implementation that takes a predicate of that generic type and returns an object that makes the respective predicate.test() return true\r\n\r\nis there a way to create a valid Criteria Query that can be later passed as argument to the where() function, with a predicate defined on an Entity class ?\r\n\r\nfor example :\r\n\r\n\r\n```\r\nClass User {\r\nString name;\r\n}\r\n\r\n\r\nvar predicate = new Predicate&lt;User&gt; {\r\npublic boolean test(User user) {return user.name.equals(...);}\r\n\r\nother methods...\r\n}\r\n\r\n\r\npublic T get(Predicate&lt;T&gt; predicate, Class&lt;?&gt; outputClass) {\r\n\r\nCriteriaQuery cq = entityManager.getCriteriaBuilder.createQuery();\r\nRoot&lt;T&gt; root = cq.from(someClass);\r\ncq.select(root).where(predicet) // I need to somehow pipe the predicate into this method\r\n\r\n\r\nblah blah blah\r\n}\r\n```\r\n\r\nif there was a way to get the entity representing the root object and pass that into the test method that would have been fine as well\r\n\r\nfor example I need to get the user with a specific name (NAME)\r\n\r\nthe valid criteria query :\r\n\r\n```\r\nvar builder0 = session.getCriteriaBuilder();\r\nvar cQuery0 = builder0.createQuery(User.class);\r\nvar root0 = cQuery0.from(User.class);\r\ncQuery0.select(root0).where(builder0.equal(root0.get(&quot;name&quot;), &quot;NAME&quot;));\r\n```\r\n\r\nbut I&#39;d like to implement\r\nthat using a predicate with the following test method...\r\n\r\n```\r\npublic boolean test(User user) {\r\nreturn user.name.equals(&quot;NAME&quot;);\r\n}\r\n```","title":"creating a Criteria Query using java predicate","body":"<p>I'm trying to create a generified <em>get</em> method for my DAO implementation that takes a predicate of that generic type and returns an object that makes the respective predicate.test() return true</p>\n<p>is there a way to create a valid Criteria Query that can be later passed as argument to the where() function, with a predicate defined on an Entity class ?</p>\n<p>for example :</p>\n<pre><code>Class User {\nString name;\n}\n\n\nvar predicate = new Predicate&lt;User&gt; {\npublic boolean test(User user) {return user.name.equals(...);}\n\nother methods...\n}\n\n\npublic T get(Predicate&lt;T&gt; predicate, Class&lt;?&gt; outputClass) {\n\nCriteriaQuery cq = entityManager.getCriteriaBuilder.createQuery();\nRoot&lt;T&gt; root = cq.from(someClass);\ncq.select(root).where(predicet) // I need to somehow pipe the predicate into this method\n\n\nblah blah blah\n}\n</code></pre>\n<p>if there was a way to get the entity representing the root object and pass that into the test method that would have been fine as well</p>\n<p>for example I need to get the user with a specific name (NAME)</p>\n<p>the valid criteria query :</p>\n<pre><code>var builder0 = session.getCriteriaBuilder();\nvar cQuery0 = builder0.createQuery(User.class);\nvar root0 = cQuery0.from(User.class);\ncQuery0.select(root0).where(builder0.equal(root0.get(&quot;name&quot;), &quot;NAME&quot;));\n</code></pre>\n<p>but I'd like to implement\nthat using a predicate with the following test method...</p>\n<pre><code>public boolean test(User user) {\nreturn user.name.equals(&quot;NAME&quot;);\n}\n</code></pre>\n"},{"tags":["java","spring","spring-boot","spring-security","keycloak"],"comments":[{"owner":{"account_id":3380632,"reputation":14294,"user_id":2837741,"accept_rate":100,"display_name":"daniu"},"score":0,"creation_date":1689962615,"post_id":76740223,"comment_id":135291996,"body_markdown":"You can use `.hasRole(rolename)` in your posted code instead of `.authenticated()`.","body":"You can use <code>.hasRole(rolename)</code> in your posted code instead of <code>.authenticated()</code>."},{"owner":{"account_id":308139,"reputation":8199,"user_id":619830,"accept_rate":75,"display_name":"ch4mp"},"score":0,"creation_date":1690314300,"post_id":76740223,"comment_id":135335489,"body_markdown":"I&#39;m curious why the answer below is neither accepted nor upvoted.","body":"I&#39;m curious why the answer below is neither accepted nor upvoted."},{"owner":{"account_id":9056575,"reputation":747,"user_id":6744675,"display_name":"IndyStef"},"score":0,"creation_date":1690448601,"post_id":76740223,"comment_id":135356288,"body_markdown":"because I&#39;m currently very busy. I will do that as soon as I find time to deal with this issue again. Sorry for the delay ...","body":"because I&#39;m currently very busy. I will do that as soon as I find time to deal with this issue again. Sorry for the delay ..."}],"answers":[{"tags":[],"owner":{"account_id":308139,"reputation":8199,"user_id":619830,"accept_rate":75,"display_name":"ch4mp"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689969313,"creation_date":1689965499,"answer_id":76740530,"question_id":76740223,"body_markdown":"First, and most importantly, Mapping Keycloak roles to Spring authorities has nothing to do with Keycloak version.\r\n\r\nSecond, you are using `oauth2Login` =&gt; you are configuring an OAuth2 client (not an OAuth2 resource server) and **the requests are secured with sessions**, not access tokens (just check in your browser debugging tools, you&#39;ll find a session cookie but no header with a `Bearer` token). You should definitely read the [OAuth2 essentials section of my tutorials][1].\r\n\r\nAbout Keycloak roles mapping to Spring authorities, what you have not read, apparently is the [Spring Security manual][2]. No more than the accepted answer to [this question][3] here on stackoverflow.\r\n\r\nInstead of writing a `GrantedAuthoritiesMapper` or an `OAuth2UserService` yourself as instructed in the doc, you could use the `GrantedAuthoritiesMapper` which is auto-configured by the [additional starter I wrote][4], which configures OpenID provider (Keycloak or whatever) roles to Spring authorities mapping with just application properties:\r\n```xml\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-boot-starter-oauth2-client&lt;/artifactId&gt;\r\n&lt;/dependency&gt;\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;com.c4-soft.springaddons&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;spring-addons-starter-oidc&lt;/artifactId&gt;\r\n\t&lt;version&gt;7.0.6&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```\r\n```yaml\r\noauth2-issuer: http://locahost:8080/realms/master\r\noauth2-client-id: change-me\r\noauth2-client-secret: change-me\r\n\r\nspring:\r\n  security:\r\n    oauth2:\r\n      client:\r\n        provider:\r\n          keycloak:\r\n            issuer-uri: ${oauth2-issuer}\r\n            user-name-attribute: preferred_username\r\n        registration:\r\n          keycloak-authorization-code:\r\n            authorization-grant-type: authorization_code\r\n            client-id: ${oauth2-client-id}\r\n            client-secret: ${oauth2-secret}\r\n            provider: keycloak\r\n            scope: openid,profile,email,offline_access\r\ncom:\r\n  c4-soft:\r\n    springaddons:\r\n      oidc:\r\n        ops:\r\n        - iss: ${oauth2-issuer}\r\n          username-claim: $.preferred_username\r\n          authorities:\r\n          # In addition to JSON path, you may define prefix and case transformation\r\n          # for each claim to map to spring authorities\r\n          - path: $.realm_access.roles\r\n          - path: $.resource_access.${oauth2-client-id}.roles\r\n        client:\r\n          security-matchers:\r\n          - /**\r\n          permit-all:\r\n          - /login/**\r\n          - /oauth2/**\r\n```\r\nThat simple. And this works in both reactive and servlet applications configured as OAuth2 clients with `oauth2Login`.\r\n\r\n\r\n  [1]: https://github.com/ch4mpy/spring-addons/tree/master/samples/tutorials#1-oauth2-essentials\r\n  [2]: https://docs.spring.io/spring-security/reference/servlet/oauth2/login/advanced.html#oauth2login-advanced-map-authoritieshttps://docs.spring.io/spring-security/reference/servlet/oauth2/login/advanced.html#oauth2login-advanced-map-authorities\r\n  [3]: https://stackoverflow.com/q/74571191/619830\r\n  [4]: https://github.com/ch4mpy/spring-addons","title":"How to get roles in token from an OAuth2 login from a Spring Boot application?","body":"<p>First, and most importantly, Mapping Keycloak roles to Spring authorities has nothing to do with Keycloak version.</p>\n<p>Second, you are using <code>oauth2Login</code> =&gt; you are configuring an OAuth2 client (not an OAuth2 resource server) and <strong>the requests are secured with sessions</strong>, not access tokens (just check in your browser debugging tools, you'll find a session cookie but no header with a <code>Bearer</code> token). You should definitely read the <a href=\"https://github.com/ch4mpy/spring-addons/tree/master/samples/tutorials#1-oauth2-essentials\" rel=\"nofollow noreferrer\">OAuth2 essentials section of my tutorials</a>.</p>\n<p>About Keycloak roles mapping to Spring authorities, what you have not read, apparently is the <a href=\"https://docs.spring.io/spring-security/reference/servlet/oauth2/login/advanced.html#oauth2login-advanced-map-authoritieshttps://docs.spring.io/spring-security/reference/servlet/oauth2/login/advanced.html#oauth2login-advanced-map-authorities\" rel=\"nofollow noreferrer\">Spring Security manual</a>. No more than the accepted answer to <a href=\"https://stackoverflow.com/q/74571191/619830\">this question</a> here on stackoverflow.</p>\n<p>Instead of writing a <code>GrantedAuthoritiesMapper</code> or an <code>OAuth2UserService</code> yourself as instructed in the doc, you could use the <code>GrantedAuthoritiesMapper</code> which is auto-configured by the <a href=\"https://github.com/ch4mpy/spring-addons\" rel=\"nofollow noreferrer\">additional starter I wrote</a>, which configures OpenID provider (Keycloak or whatever) roles to Spring authorities mapping with just application properties:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-oauth2-client&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.c4-soft.springaddons&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-addons-starter-oidc&lt;/artifactId&gt;\n    &lt;version&gt;7.0.6&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<pre class=\"lang-yaml prettyprint-override\"><code>oauth2-issuer: http://locahost:8080/realms/master\noauth2-client-id: change-me\noauth2-client-secret: change-me\n\nspring:\n  security:\n    oauth2:\n      client:\n        provider:\n          keycloak:\n            issuer-uri: ${oauth2-issuer}\n            user-name-attribute: preferred_username\n        registration:\n          keycloak-authorization-code:\n            authorization-grant-type: authorization_code\n            client-id: ${oauth2-client-id}\n            client-secret: ${oauth2-secret}\n            provider: keycloak\n            scope: openid,profile,email,offline_access\ncom:\n  c4-soft:\n    springaddons:\n      oidc:\n        ops:\n        - iss: ${oauth2-issuer}\n          username-claim: $.preferred_username\n          authorities:\n          # In addition to JSON path, you may define prefix and case transformation\n          # for each claim to map to spring authorities\n          - path: $.realm_access.roles\n          - path: $.resource_access.${oauth2-client-id}.roles\n        client:\n          security-matchers:\n          - /**\n          permit-all:\n          - /login/**\n          - /oauth2/**\n</code></pre>\n<p>That simple. And this works in both reactive and servlet applications configured as OAuth2 clients with <code>oauth2Login</code>.</p>\n"}],"owner":{"account_id":9056575,"reputation":747,"user_id":6744675,"display_name":"IndyStef"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":432,"favorite_count":0,"down_vote_count":3,"up_vote_count":0,"answer_count":1,"score":-3,"last_activity_date":1689969313,"creation_date":1689962299,"question_id":76740223,"body_markdown":"I know this question has been answered a number of times ... but all the answers I found refer to earlier versions of Keycloak, and I cannot find the equivalents in the current versions (22.0.1).\r\n\r\nI am trying to develop an application that uses OAuth2 login, where the login is referred to keycloak. That&#39;s pretty simple to do with the use of org.springframework.boot:spring-boot-starter-oauth2-client, and a security config like this:\r\n\r\n    public SecurityFilterChain securityFilterChain(HttpSecurity httpSecurity) {\r\n            httpSecurity.authorizeHttpRequests()\r\n                    .anyRequest().authenticated()\r\n                    .and()\r\n                    .oauth2Login();\r\n    \r\n           return  httpSecurity.build();\r\n        }\r\n\r\nSo far, so good. When I navigate to any page, I first have to log in through keycloak, and get forwarded to the page successfully. A call to `SecurityContextHolder.getContext().getAuthentication()` gets me the content of the token ... but what is missing are the roles that I assigned to the user in Keycloak. So I cannot use role based API access control.\r\n\r\nWhen I follow the many examples that obtain the token through Postman (through /realms/{realm}/protocol/openid-connect/token, the roles are present. I could technically just write my own login screen, and use that approach, but I&#39;d rather let keycloak handle the login (to cover for MFA and stuff).\r\n\r\nIs it even possible to get the roles defined in Keycloak through a Spring boot OAuth2 login?\r\n\r\nThx,\r\n\r\nStefan","title":"How to get roles in token from an OAuth2 login from a Spring Boot application?","body":"<p>I know this question has been answered a number of times ... but all the answers I found refer to earlier versions of Keycloak, and I cannot find the equivalents in the current versions (22.0.1).</p>\n<p>I am trying to develop an application that uses OAuth2 login, where the login is referred to keycloak. That's pretty simple to do with the use of org.springframework.boot:spring-boot-starter-oauth2-client, and a security config like this:</p>\n<pre><code>public SecurityFilterChain securityFilterChain(HttpSecurity httpSecurity) {\n        httpSecurity.authorizeHttpRequests()\n                .anyRequest().authenticated()\n                .and()\n                .oauth2Login();\n\n       return  httpSecurity.build();\n    }\n</code></pre>\n<p>So far, so good. When I navigate to any page, I first have to log in through keycloak, and get forwarded to the page successfully. A call to <code>SecurityContextHolder.getContext().getAuthentication()</code> gets me the content of the token ... but what is missing are the roles that I assigned to the user in Keycloak. So I cannot use role based API access control.</p>\n<p>When I follow the many examples that obtain the token through Postman (through /realms/{realm}/protocol/openid-connect/token, the roles are present. I could technically just write my own login screen, and use that approach, but I'd rather let keycloak handle the login (to cover for MFA and stuff).</p>\n<p>Is it even possible to get the roles defined in Keycloak through a Spring boot OAuth2 login?</p>\n<p>Thx,</p>\n<p>Stefan</p>\n"},{"tags":["java","maven","noclassdeffounderror","plexus"],"comments":[{"owner":{"account_id":112317,"reputation":93939,"user_id":296328,"accept_rate":60,"display_name":"khmarbaise"},"score":0,"creation_date":1689967948,"post_id":76740744,"comment_id":135292763,"body_markdown":"Why have you added the plexus-utils as a dependency for the plugin? Also I would suggest to use most recent version of maven-compiler-plugin (3.11.0) See https://maven.apache.org/plugins/ ... and remove the supplemental dependency ...Furthermore I would suggest to use most recent version of Maven (https://maven.apache.org/download.cgi)","body":"Why have you added the plexus-utils as a dependency for the plugin? Also I would suggest to use most recent version of maven-compiler-plugin (3.11.0) See <a href=\"https://maven.apache.org/plugins/\" rel=\"nofollow noreferrer\">maven.apache.org/plugins</a> ... and remove the supplemental dependency ...Furthermore I would suggest to use most recent version of Maven (<a href=\"https://maven.apache.org/download.cgi\" rel=\"nofollow noreferrer\">maven.apache.org/download.cgi</a>)"},{"owner":{"account_id":1623729,"reputation":5190,"user_id":1499766,"accept_rate":86,"display_name":"Scott Kurz"},"score":0,"creation_date":1689968043,"post_id":76740744,"comment_id":135292781,"body_markdown":"This looks like you might have stumbled upon a workaround to an older problem.  Are you sure you even need this dependency?","body":"This looks like you might have stumbled upon a workaround to an older problem.  Are you sure you even need this dependency?"},{"owner":{"account_id":15605231,"reputation":1,"user_id":11258179,"display_name":"Ariane Leite"},"score":0,"creation_date":1689968335,"post_id":76740744,"comment_id":135292825,"body_markdown":"I tried with this version of maven compiler and deleted plugin, but still show this error","body":"I tried with this version of maven compiler and deleted plugin, but still show this error"}],"owner":{"account_id":15605231,"reputation":1,"user_id":11258179,"display_name":"Ariane Leite"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":483,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689968542,"creation_date":1689967816,"question_id":76740744,"body_markdown":"Im trying compile the project but this error showing: \r\n\r\njava.lang.NoClassDefFoundError: org/codehaus/plexus/util/Scanner\r\n\r\nUsing Java 11 and Maven v3.8.1 by Intellij\r\n\r\n\r\nI set: \r\n\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n                &lt;version&gt;3.6.1&lt;/version&gt;\r\n                &lt;configuration&gt;\r\n                    &lt;source&gt;11&lt;/source&gt;\r\n                    &lt;target&gt;11&lt;/target&gt;\r\n                &lt;/configuration&gt;\r\n                &lt;dependencies&gt;\r\n                &lt;dependency&gt;\r\n                    &lt;groupId&gt;org.codehaus.plexus&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;plexus-utils&lt;/artifactId&gt;\r\n                    &lt;version&gt;3.0.15&lt;/version&gt;\r\n                &lt;/dependency&gt;\r\n            &lt;/dependencies&gt;\r\n            &lt;/plugin&gt;\r\n\r\nBut not working.\r\n\r\nI tried with version maven compiler more recent too\r\n\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n                &lt;version&gt;3.11.0&lt;/version&gt;\r\n                &lt;configuration&gt;\r\n                    &lt;source&gt;11&lt;/source&gt;\r\n                    &lt;target&gt;11&lt;/target&gt;\r\n                &lt;/configuration&gt;\r\n            &lt;/plugin&gt;","title":"Error mvn install java.lang.NoClassDefFoundError: org/codehaus/plexus/util/Scanner","body":"<p>Im trying compile the project but this error showing:</p>\n<p>java.lang.NoClassDefFoundError: org/codehaus/plexus/util/Scanner</p>\n<p>Using Java 11 and Maven v3.8.1 by Intellij</p>\n<p>I set:</p>\n<pre><code>        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.6.1&lt;/version&gt;\n            &lt;configuration&gt;\n                &lt;source&gt;11&lt;/source&gt;\n                &lt;target&gt;11&lt;/target&gt;\n            &lt;/configuration&gt;\n            &lt;dependencies&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.codehaus.plexus&lt;/groupId&gt;\n                &lt;artifactId&gt;plexus-utils&lt;/artifactId&gt;\n                &lt;version&gt;3.0.15&lt;/version&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n        &lt;/plugin&gt;\n</code></pre>\n<p>But not working.</p>\n<p>I tried with version maven compiler more recent too</p>\n<pre><code>        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.11.0&lt;/version&gt;\n            &lt;configuration&gt;\n                &lt;source&gt;11&lt;/source&gt;\n                &lt;target&gt;11&lt;/target&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n</code></pre>\n"},{"tags":["java","spring-boot","rest","spring-cloud-feign"],"comments":[{"owner":{"account_id":10164387,"reputation":4961,"user_id":7506820,"display_name":"Nico Van Belle"},"score":0,"creation_date":1687253781,"post_id":76513234,"comment_id":134907312,"body_markdown":"Did you check this answer yet? https://stackoverflow.com/a/54841998/7506820","body":"Did you check this answer yet? <a href=\"https://stackoverflow.com/a/54841998/7506820\">stackoverflow.com/a/54841998/7506820</a>"},{"owner":{"account_id":7392763,"reputation":3367,"user_id":5625696,"accept_rate":50,"display_name":"Borislav Stoilov"},"score":0,"creation_date":1687253959,"post_id":76513234,"comment_id":134907355,"body_markdown":"Yes it didn&#39;t works and I assumed that the data there is a bit outdated","body":"Yes it didn&#39;t works and I assumed that the data there is a bit outdated"}],"answers":[{"tags":[],"owner":{"account_id":26186343,"reputation":70,"user_id":19868833,"display_name":"Oussama Abouzid"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1687255247,"creation_date":1687255247,"answer_id":76513540,"question_id":76513234,"body_markdown":"you can try ```@SpringQueryMap```: \r\n\r\n```\r\n@PostMapping(value = &quot;url&quot;, consumes = MediaType.MULTIPART_FORM_DATA_VALUE)\r\nMpcsAuthResponse obtainAccessToken(@SpringQueryMap MpcsTokenRequest request);\r\n```\r\nbut make sure to add ```consumes = MediaType.MULTIPART_FORM_DATA_VALUE ``` at the resource you want to consume : ```@PostMapping(value = &quot;/url&quot;,consumes = MediaType.MULTIPART_FORM_DATA_VALUE)```\r\n\r\n","title":"Spring open feign not sending body (empty body) when content type is application/x-www-form-urlencoded","body":"<p>you can try <code>@SpringQueryMap</code>:</p>\n<pre><code>@PostMapping(value = &quot;url&quot;, consumes = MediaType.MULTIPART_FORM_DATA_VALUE)\nMpcsAuthResponse obtainAccessToken(@SpringQueryMap MpcsTokenRequest request);\n</code></pre>\n<p>but make sure to add <code>consumes = MediaType.MULTIPART_FORM_DATA_VALUE </code> at the resource you want to consume : <code>@PostMapping(value = &quot;/url&quot;,consumes = MediaType.MULTIPART_FORM_DATA_VALUE)</code></p>\n"}],"owner":{"account_id":7392763,"reputation":3367,"user_id":5625696,"accept_rate":50,"display_name":"Borislav Stoilov"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":766,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1689968413,"creation_date":1687253038,"question_id":76513234,"body_markdown":"This is my feign endpoint\r\n\r\n    @PostMapping(value = &quot;url&quot;, consumes = MediaType.APPLICATION_FORM_URLENCODED_VALUE)\r\n    MpcsAuthResponse obtainAccessToken(@RequestBody MpcsTokenRequest request);\r\n\r\nand when I enable feign full logs I see that the body is empty\r\n\r\n    c.k.c.t.m.m.client.mpcs.MpcsClient -- [MpcsClient#obtainAccessToken] ---&gt; POST &lt;url&gt; HTTP/1.1\r\n    11:16:47.532 [main] DEBUG c.k.c.t.m.m.client.mpcs.MpcsClient -- [MpcsClient#obtainAccessToken] Content-Type: application/x-www-form-urlencoded; charset=UTF-8\r\n    11:16:47.532 [main] DEBUG c.k.c.t.m.m.client.mpcs.MpcsClient -- [MpcsClient#obtainAccessToken] \r\n    11:16:47.532 [main] DEBUG c.k.c.t.m.m.client.mpcs.MpcsClient -- [MpcsClient#obtainAccessToken] \r\n    11:16:47.532 [main] DEBUG c.k.c.t.m.m.client.mpcs.MpcsClient -- [MpcsClient#obtainAccessToken] ---&gt; END HTTP (0-byte body)\r\n\r\n\r\nI have other feign clients that are working fine. The only time this happens is when I use APPLICATION_FORM_URLENCODED_VALUE.\r\n\r\nI am on Java 17, spring boot 3.1.0 and fiegn comes from\r\n\r\n    org.springframework.cloud:spring-cloud-starter-openfeign:4.0.3\r\n\r\nNOTE: If I use just String instead of the MpcsTokenRequest dto it works, so it is probably something with the encoders, but I can&#39;t figure it out\r\n\r\nEDIT: this is how my DTO looks like\r\n\r\n    public record MpcsTokenRequest(@FormProperty(&quot;client_id&quot;)\r\n                                   String clientId,\r\n                                   @FormProperty(&quot;client_secret&quot;)\r\n                                   String clientSecret,\r\n                                   @FormProperty(&quot;grant_type&quot;)\r\n                                   String grantType) {\r\n    }\r\n\r\nMy client configuration\r\n\r\n    public class MpcsClientConfiguration {\r\n    \r\n        @Bean\r\n        Encoder formEncoder() {\r\n            return new feign.form.FormEncoder();\r\n        }\r\n    \r\n        @Bean\r\n        Logger.Level feignLoggerLevel() {\r\n            return Logger.Level.FULL;\r\n        }\r\n    }\r\n\r\nThe problem was that feign doesn&#39;t serialize the form if its a record. \r\nhttps://github.com/OpenFeign/feign-form/issues/105\r\n\r\nConverting my DTO to POJO solved it.","title":"Spring open feign not sending body (empty body) when content type is application/x-www-form-urlencoded","body":"<p>This is my feign endpoint</p>\n<pre><code>@PostMapping(value = &quot;url&quot;, consumes = MediaType.APPLICATION_FORM_URLENCODED_VALUE)\nMpcsAuthResponse obtainAccessToken(@RequestBody MpcsTokenRequest request);\n</code></pre>\n<p>and when I enable feign full logs I see that the body is empty</p>\n<pre><code>c.k.c.t.m.m.client.mpcs.MpcsClient -- [MpcsClient#obtainAccessToken] ---&gt; POST &lt;url&gt; HTTP/1.1\n11:16:47.532 [main] DEBUG c.k.c.t.m.m.client.mpcs.MpcsClient -- [MpcsClient#obtainAccessToken] Content-Type: application/x-www-form-urlencoded; charset=UTF-8\n11:16:47.532 [main] DEBUG c.k.c.t.m.m.client.mpcs.MpcsClient -- [MpcsClient#obtainAccessToken] \n11:16:47.532 [main] DEBUG c.k.c.t.m.m.client.mpcs.MpcsClient -- [MpcsClient#obtainAccessToken] \n11:16:47.532 [main] DEBUG c.k.c.t.m.m.client.mpcs.MpcsClient -- [MpcsClient#obtainAccessToken] ---&gt; END HTTP (0-byte body)\n</code></pre>\n<p>I have other feign clients that are working fine. The only time this happens is when I use APPLICATION_FORM_URLENCODED_VALUE.</p>\n<p>I am on Java 17, spring boot 3.1.0 and fiegn comes from</p>\n<pre><code>org.springframework.cloud:spring-cloud-starter-openfeign:4.0.3\n</code></pre>\n<p>NOTE: If I use just String instead of the MpcsTokenRequest dto it works, so it is probably something with the encoders, but I can't figure it out</p>\n<p>EDIT: this is how my DTO looks like</p>\n<pre><code>public record MpcsTokenRequest(@FormProperty(&quot;client_id&quot;)\n                               String clientId,\n                               @FormProperty(&quot;client_secret&quot;)\n                               String clientSecret,\n                               @FormProperty(&quot;grant_type&quot;)\n                               String grantType) {\n}\n</code></pre>\n<p>My client configuration</p>\n<pre><code>public class MpcsClientConfiguration {\n\n    @Bean\n    Encoder formEncoder() {\n        return new feign.form.FormEncoder();\n    }\n\n    @Bean\n    Logger.Level feignLoggerLevel() {\n        return Logger.Level.FULL;\n    }\n}\n</code></pre>\n<p>The problem was that feign doesn't serialize the form if its a record.\n<a href=\"https://github.com/OpenFeign/feign-form/issues/105\" rel=\"nofollow noreferrer\">https://github.com/OpenFeign/feign-form/issues/105</a></p>\n<p>Converting my DTO to POJO solved it.</p>\n"},{"tags":["java","naming-conventions"],"comments":[{"owner":{"account_id":48334,"reputation":19092,"user_id":143585,"accept_rate":67,"display_name":"Denis Tulskiy"},"score":51,"creation_date":1310444525,"post_id":6659455,"comment_id":7872331,"body_markdown":"“There are only two hard things in Computer Science: cache invalidation and naming things”","body":"“There are only two hard things in Computer Science: cache invalidation and naming things”"},{"owner":{"account_id":6051,"reputation":26236,"user_id":10018,"display_name":"Rich Adams"},"score":20,"creation_date":1310444691,"post_id":6659455,"comment_id":7872357,"body_markdown":"...and off-by-one errors.","body":"...and off-by-one errors."},{"owner":{"account_id":169793,"reputation":1135,"user_id":396089,"accept_rate":46,"display_name":"user396089"},"score":3,"creation_date":1310446887,"post_id":6659455,"comment_id":7872628,"body_markdown":"also, add de-referencing de-allocated memory, you never know when it will crash.","body":"also, add de-referencing de-allocated memory, you never know when it will crash."},{"owner":{"account_id":113326,"reputation":2445,"user_id":298522,"accept_rate":71,"display_name":"Logan"},"score":1,"creation_date":1310446959,"post_id":6659455,"comment_id":7872636,"body_markdown":"You can name it as countiesInState","body":"You can name it as countiesInState"},{"owner":{"account_id":1130669,"reputation":584,"user_id":6853900,"display_name":"Domi W"},"score":1,"creation_date":1556025925,"post_id":6659455,"comment_id":98291358,"body_markdown":"Possible duplicate of [How should I name a java.util.Map?](https://stackoverflow.com/questions/2253453/how-should-i-name-a-java-util-map)","body":"Possible duplicate of <a href=\"https://stackoverflow.com/questions/2253453/how-should-i-name-a-java-util-map\">How should I name a java.util.Map?</a>"}],"answers":[{"tags":[],"owner":{"account_id":204988,"reputation":6870,"user_id":453513,"accept_rate":72,"display_name":"RAY"},"down_vote_count":0,"up_vote_count":48,"is_accepted":false,"score":48,"last_activity_date":1310550382,"creation_date":1310444553,"answer_id":6659471,"question_id":6659455,"body_markdown":"I don&#39;t believe there is a hard-written rule anywhere that tells you how to name your map, so as long as you come up with a rule that makes sense to you (and your teammates), then it should be fine.\r\n\r\nPersonally, I like to call my maps `keyToValue` or `valueByKey`.","title":"How to name a HashMap in Java?","body":"<p>I don't believe there is a hard-written rule anywhere that tells you how to name your map, so as long as you come up with a rule that makes sense to you (and your teammates), then it should be fine.</p>\n\n<p>Personally, I like to call my maps <code>keyToValue</code> or <code>valueByKey</code>.</p>\n"},{"tags":[],"owner":{"account_id":46972,"reputation":356179,"user_id":139010,"accept_rate":81,"display_name":"Matt Ball"},"down_vote_count":1,"up_vote_count":10,"is_accepted":false,"score":9,"last_activity_date":1310444555,"creation_date":1310444555,"answer_id":6659472,"question_id":6659455,"body_markdown":"I would call it `numCounties` or `countyCounts`.","title":"How to name a HashMap in Java?","body":"<p>I would call it <code>numCounties</code> or <code>countyCounts</code>.</p>\n"},{"tags":[],"owner":{"account_id":6832,"reputation":6763,"user_id":11614,"accept_rate":67,"display_name":"Nrj"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1310444557,"creation_date":1310444557,"answer_id":6659473,"question_id":6659455,"body_markdown":"Whatever explains it best - In this case `stateToCountyMap` is ok or else `countiesInStateMap` can be used.","title":"How to name a HashMap in Java?","body":"<p>Whatever explains it best - In this case <code>stateToCountyMap</code> is ok or else <code>countiesInStateMap</code> can be used.</p>\n"},{"tags":[],"owner":{"account_id":208636,"reputation":26513,"user_id":459233,"accept_rate":87,"display_name":"Tudor Constantin"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1310444580,"creation_date":1310444580,"answer_id":6659476,"question_id":6659455,"body_markdown":"Storing states and counties in that variable it would be confusing to name it map - call it `stateCountyHash` or `numCountiesByState`","title":"How to name a HashMap in Java?","body":"<p>Storing states and counties in that variable it would be confusing to name it map - call it <code>stateCountyHash</code> or <code>numCountiesByState</code></p>\n"},{"tags":[],"owner":{"account_id":441661,"reputation":86528,"user_id":831878,"accept_rate":92,"display_name":"Ray Toal"},"down_vote_count":3,"up_vote_count":44,"is_accepted":true,"score":41,"last_activity_date":1310449975,"creation_date":1310445231,"answer_id":6659535,"question_id":6659455,"body_markdown":"I like this question because Java does not allow map access via an operator like `[]`.  In other languages we could say things like\r\n\r\n    numberOfCountiesIn[&quot;HI&quot;]\r\n\r\nor\r\n\r\n    countyCountOf[&quot;CA&quot;]\r\n\r\nor\r\n\r\n    numCountiesIn-&gt;{&quot;MA&quot;}\r\n\r\nor (in Scala, this is cool)\r\n\r\n    numCountiesIn(&quot;WA&quot;)\r\n\r\nand on and on.  None of these work in Java, because of that silly `get` word!\r\n\r\n    countyCounts.get(&quot;NY&quot;)\r\n\r\nIndeed!\r\n\r\nEDIT: I actually think `countyCounts` is the _best_ answer (IMHO); I was just making the point that the need for `get` limits one&#39;s choices.\r\n\r\n\r\n\r\n","title":"How to name a HashMap in Java?","body":"<p>I like this question because Java does not allow map access via an operator like <code>[]</code>.  In other languages we could say things like</p>\n\n<pre><code>numberOfCountiesIn[\"HI\"]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>countyCountOf[\"CA\"]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>numCountiesIn-&gt;{\"MA\"}\n</code></pre>\n\n<p>or (in Scala, this is cool)</p>\n\n<pre><code>numCountiesIn(\"WA\")\n</code></pre>\n\n<p>and on and on.  None of these work in Java, because of that silly <code>get</code> word!</p>\n\n<pre><code>countyCounts.get(\"NY\")\n</code></pre>\n\n<p>Indeed!</p>\n\n<p>EDIT: I actually think <code>countyCounts</code> is the <em>best</em> answer (IMHO); I was just making the point that the need for <code>get</code> limits one's choices.</p>\n"},{"tags":[],"owner":{"account_id":50410,"reputation":3979,"user_id":150371,"accept_rate":54,"display_name":"raksja"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1310446285,"creation_date":1310446285,"answer_id":6659625,"question_id":6659455,"body_markdown":"My opinion would be to have it `countiesCountOfStateMap` or simply `countiesOfStateMap` since we will be getting the counties count using the State. \r\n\r\nIt would be more meaningful to have it like this, so when new person looks into your code atleast he would be aware of what is contained in it. \r\n\r\nBut at the end of the day its your decision to have the appropriate name and as @tulskiy mentioned naming the class and variable appropriately is one of the harder things. ","title":"How to name a HashMap in Java?","body":"<p>My opinion would be to have it <code>countiesCountOfStateMap</code> or simply <code>countiesOfStateMap</code> since we will be getting the counties count using the State. </p>\n\n<p>It would be more meaningful to have it like this, so when new person looks into your code atleast he would be aware of what is contained in it. </p>\n\n<p>But at the end of the day its your decision to have the appropriate name and as @tulskiy mentioned naming the class and variable appropriately is one of the harder things. </p>\n"},{"tags":[],"owner":{"account_id":370300,"reputation":3680,"user_id":718149,"accept_rate":87,"display_name":"Charith De Silva"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1310452621,"creation_date":1310452621,"answer_id":6660364,"question_id":6659455,"body_markdown":"I would call it **mapStatesbyCountyCount**, then again its bit lengthy variable name... ","title":"How to name a HashMap in Java?","body":"<p>I would call it <strong>mapStatesbyCountyCount</strong>, then again its bit lengthy variable name... </p>\n"},{"tags":[],"owner":{"account_id":353544,"reputation":3326,"user_id":691308,"accept_rate":40,"display_name":"Dimitar Bonev"},"down_vote_count":0,"up_vote_count":16,"is_accepted":false,"score":16,"last_activity_date":1330683018,"creation_date":1330682563,"answer_id":9531324,"question_id":6659455,"body_markdown":"Firstly avoid putting implementation details in the name of a variable, e.g. &lt;code&gt;StateToCounty&lt;strong&gt;Map&lt;/strong&gt;&lt;/code&gt;. Today you are using a &lt;code&gt;Map&lt;/code&gt; interface but tomorrow you can decide to store your data in another type and the name of your variable has to be refactored otherwise it will become invalid and misleading. \r\n\r\nYour data represents association of a state to its number of counties, so my advice is to name the variable as &lt;code&gt;&lt;strong&gt;stateToNumberOfCounties&lt;/strong&gt;&lt;/code&gt;. The key point in this name is &lt;code&gt;&lt;strong&gt;to&lt;/strong&gt;&lt;/code&gt; which designates that this variable stores an association, the part before that is the &lt;code&gt;key&lt;/code&gt; and the part after is the &lt;code&gt;value&lt;/code&gt; or &lt;code&gt;values&lt;/code&gt; that are associated to the corresponding &lt;code&gt;key&lt;/code&gt;. Also it would be indistinct to name the variable as &lt;code&gt;stateToCountyNumber&lt;/code&gt; because one could not tell if it stores relation between a state and its number of counties or it stores a single number that represents the number of state to county associations, thus you would have to go back and forth in your code to check if it is of type &lt;code&gt;Map&lt;/code&gt; or of type &lt;code&gt;int&lt;/code&gt;.","title":"How to name a HashMap in Java?","body":"<p>Firstly avoid putting implementation details in the name of a variable, e.g. <code>StateToCounty<strong>Map</strong></code>. Today you are using a <code>Map</code> interface but tomorrow you can decide to store your data in another type and the name of your variable has to be refactored otherwise it will become invalid and misleading. </p>\n\n<p>Your data represents association of a state to its number of counties, so my advice is to name the variable as <code><strong>stateToNumberOfCounties</strong></code>. The key point in this name is <code><strong>to</strong></code> which designates that this variable stores an association, the part before that is the <code>key</code> and the part after is the <code>value</code> or <code>values</code> that are associated to the corresponding <code>key</code>. Also it would be indistinct to name the variable as <code>stateToCountyNumber</code> because one could not tell if it stores relation between a state and its number of counties or it stores a single number that represents the number of state to county associations, thus you would have to go back and forth in your code to check if it is of type <code>Map</code> or of type <code>int</code>.</p>\n"},{"tags":[],"owner":{"account_id":379606,"reputation":5664,"user_id":733092,"accept_rate":86,"display_name":"Noumenon"},"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1486499389,"creation_date":1486499389,"answer_id":42099394,"question_id":6659455,"body_markdown":"I found a great case for `countiesByState` [here](http://softwareas.com/naming-conventions-for-key-value-maps/):\r\n\r\n&gt; `valuesByKeys`, as in teamsByCaptains. If you&#39;re going to include both key and value, this seems to read best. At a high level, you can read it as just &quot;teams&quot;, so anything that&#39;s performed on it is being performed on teams. The &quot;byCaptains&quot; prefix reads as it should do: a less significant qualifier that follows the teams around to help someone understand the structure if they need to.\r\n\r\nThis also allows you to access a value in a JSP with the nice notation `countiesByState[myState]`.","title":"How to name a HashMap in Java?","body":"<p>I found a great case for <code>countiesByState</code> <a href=\"http://softwareas.com/naming-conventions-for-key-value-maps/\" rel=\"noreferrer\">here</a>:</p>\n\n<blockquote>\n  <p><code>valuesByKeys</code>, as in teamsByCaptains. If you're going to include both key and value, this seems to read best. At a high level, you can read it as just \"teams\", so anything that's performed on it is being performed on teams. The \"byCaptains\" prefix reads as it should do: a less significant qualifier that follows the teams around to help someone understand the structure if they need to.</p>\n</blockquote>\n\n<p>This also allows you to access a value in a JSP with the nice notation <code>countiesByState[myState]</code>.</p>\n"},{"tags":[],"owner":{"account_id":23691091,"reputation":17,"user_id":17715425,"display_name":"Forrest Wei"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689968254,"creation_date":1689968254,"answer_id":76740795,"question_id":6659455,"body_markdown":"`stateToCountyNumber`. More generally, `keyToValue` for any map.\r\n\r\nThis naming rule is deeply rooted in the essence of a map — a map is a function in disguise. A map transforms a key to the corresponding value. Who also does the transformation work? Functions! `toString`, `toDouble`, to name a few. So I believe a map variable should be named in the same way functions are named.","title":"How to name a HashMap in Java?","body":"<p><code>stateToCountyNumber</code>. More generally, <code>keyToValue</code> for any map.</p>\n<p>This naming rule is deeply rooted in the essence of a map — a map is a function in disguise. A map transforms a key to the corresponding value. Who also does the transformation work? Functions! <code>toString</code>, <code>toDouble</code>, to name a few. So I believe a map variable should be named in the same way functions are named.</p>\n"}],"owner":{"account_id":169793,"reputation":1135,"user_id":396089,"accept_rate":46,"display_name":"user396089"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":36992,"favorite_count":0,"down_vote_count":3,"up_vote_count":78,"accepted_answer_id":6659535,"answer_count":10,"score":75,"last_activity_date":1689968254,"creation_date":1310444393,"question_id":6659455,"body_markdown":"This might be a silly question, but I have never found a satisfying way to name a variable of type `HashMap&lt;K,V&gt;` in Java. For example - lets say I have a `HashMap` where every bucket is a `&lt;K,V&gt;` pair where `K` is a `String` say representing &quot;State&quot; and `V` is an `Integer` representing the number of counties the state has.\r\n\r\nShould the `HashMap` be named as &quot;`mapStateCounty`&quot;, &quot;`stateToCountyMap`&quot;, etc. ?\r\nWhich one seems logically more appealing and intuitive to understand without sounding confusing and verbose?\r\n","title":"How to name a HashMap in Java?","body":"<p>This might be a silly question, but I have never found a satisfying way to name a variable of type <code>HashMap&lt;K,V&gt;</code> in Java. For example - lets say I have a <code>HashMap</code> where every bucket is a <code>&lt;K,V&gt;</code> pair where <code>K</code> is a <code>String</code> say representing \"State\" and <code>V</code> is an <code>Integer</code> representing the number of counties the state has.</p>\n\n<p>Should the <code>HashMap</code> be named as \"<code>mapStateCounty</code>\", \"<code>stateToCountyMap</code>\", etc. ?\nWhich one seems logically more appealing and intuitive to understand without sounding confusing and verbose?</p>\n"},{"tags":["java","spring-boot","integration-testing","wiremock"],"comments":[{"owner":{"account_id":290683,"reputation":12512,"user_id":592355,"display_name":"xerx593"},"score":0,"creation_date":1683461800,"post_id":76193384,"comment_id":134367423,"body_markdown":"so for a 404 it is sufficient, that (the url or) *one* of the (`withXXX` *before* , not inside `willReturn(...)`) conditions doesn&#39;t match.","body":"so for a 404 it is sufficient, that (the url or) <i>one</i> of the (<code>withXXX</code> <i>before</i> , not inside <code>willReturn(...)</code>) conditions doesn&#39;t match."},{"owner":{"account_id":290683,"reputation":12512,"user_id":592355,"display_name":"xerx593"},"score":0,"creation_date":1683462191,"post_id":76193384,"comment_id":134367467,"body_markdown":"tips (regarding post): 1. obfuscate &quot;api key&quot;! 2. please prefer &quot;real json&quot; (/error/code/text/curl(!)...) to &quot;image json(/...)&quot; 3. add client/reproduction code. Regarding the issue:  start with very basic stub (comment all .withXXX *before* willReturn), successively add/test them back","body":"tips (regarding post): 1. obfuscate &quot;api key&quot;! 2. please prefer &quot;real json&quot; (/error/code/text/curl(!)...) to &quot;image json(/...)&quot; 3. add client/reproduction code. Regarding the issue:  start with very basic stub (comment all .withXXX <i>before</i> willReturn), successively add/test them back"},{"owner":{"account_id":25847958,"reputation":21,"user_id":19582453,"display_name":"Shruti Mishra"},"score":0,"creation_date":1683522300,"post_id":76193384,"comment_id":134373927,"body_markdown":"As suggested, I have removed all the checks before will return and just tried to pass the url with get method, but still recieved the same result. Can you please suggest some solution on this.","body":"As suggested, I have removed all the checks before will return and just tried to pass the url with get method, but still recieved the same result. Can you please suggest some solution on this."},{"owner":{"account_id":991044,"reputation":3556,"user_id":1008361,"display_name":"Tom"},"score":0,"creation_date":1683539929,"post_id":76193384,"comment_id":134377023,"body_markdown":"Is there any chance you have another instance of WireMock running in the background (e.g. standalone) and you&#39;re accidentally connecting to that one instead of the one you&#39;re starting as an extension?","body":"Is there any chance you have another instance of WireMock running in the background (e.g. standalone) and you&#39;re accidentally connecting to that one instead of the one you&#39;re starting as an extension?"},{"owner":{"account_id":25847958,"reputation":21,"user_id":19582453,"display_name":"Shruti Mishra"},"score":0,"creation_date":1683542873,"post_id":76193384,"comment_id":134377569,"body_markdown":"No, Actually wiremock is being running on port 8082, and the other application (which is java spring boot application is being run on port 8080). In 8082, no other instance is running.","body":"No, Actually wiremock is being running on port 8082, and the other application (which is java spring boot application is being run on port 8080). In 8082, no other instance is running."}],"answers":[{"tags":[],"owner":{"account_id":290683,"reputation":12512,"user_id":592355,"display_name":"xerx593"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1683644168,"creation_date":1683558905,"answer_id":76201954,"question_id":76193384,"body_markdown":"Pheeew, that was not that easy one!\r\n\r\n1. https://wiremock.org/docs/spring-boot/ points (currently) &quot;to nirvana&quot; (404)\r\n2. We want to test &quot;multiple backend&quot; integration, which is complicated per se.\r\n\r\nI could update https://rieckpil.de/spring-boot-integration-tests-with-wiremock-and-junit-5/ (which looks very like your question) to latest versions and got it working like so:\r\n\r\n- [(spring-boot)started simple (current, maven, java17, webflux+lombok)](https://start.spring.io/#!type=maven-project&amp;language=java&amp;platformVersion=3.0.6&amp;packaging=jar&amp;jvmVersion=17&amp;groupId=com.example&amp;artifactId=demo&amp;name=demo&amp;description=Demo%20project%20for%20Spring%20Boot&amp;packageName=com.example.demo&amp;dependencies=lombok,webflux)\r\n- Main, (fictive) demo application, which calls (get on) &quot;some&quot; `${ext_base_url}` REST API, and (tries to) returns its results as a `Flux` of `SomeDto`:\r\n  ```lang-java\r\n  package com.example;\r\n\r\n  import lombok.EqualsAndHashCode;\r\n  import org.springframework.beans.factory.annotation.Value;\r\n  import org.springframework.boot.SpringApplication;\r\n  import org.springframework.boot.autoconfigure.SpringBootApplication;\r\n  import org.springframework.stereotype.Service;\r\n  import org.springframework.web.reactive.function.client.WebClient;\r\n  import reactor.core.publisher.Flux;\r\n\r\n  @SpringBootApplication\r\n  public class DemoApp {\r\n\r\n    public static void main(String[] args) {\r\n      SpringApplication.run(DemoApp.class, args);\r\n    }\r\n\r\n    @Service // 1.\r\n    static class MyService {\r\n\r\n      private final WebClient webClient;\r\n\r\n      public MyService(WebClient.Builder webClientBuilder,\r\n          @Value(&quot;${ext_base_url}&quot;) String baseUrl) { // 2.\r\n        this.webClient = webClientBuilder.baseUrl(baseUrl).build();\r\n      }\r\n\r\n      public Flux&lt;SomeDto&gt; someRestCall() { // 3.\r\n        return this.webClient.get().uri(&quot;/parties&quot;)\r\n            .retrieve().bodyToFlux(SomeDto.class);\r\n      }\r\n    }\r\n\r\n    @lombok.Value(staticConstructor = &quot;of&quot;)\r\n    @EqualsAndHashCode(onlyExplicitlyIncluded = true) \r\n    static class SomeDto { // dto\r\n\r\n      @EqualsAndHashCode.Include // consider only this, lazy, sorry\r\n      Integer id;\r\n      Integer userId;\r\n      String title;\r\n      boolean completed;\r\n    }\r\n  }\r\n  ```\r\n- To mock the &quot;external&quot; API for integration tests we add (current, latest):\r\n  ```lang-xml\r\n  &lt;dependency&gt;\r\n    &lt;groupId&gt;com.github.tomakehurst&lt;/groupId&gt;\r\n    &lt;artifactId&gt;wiremock&lt;/artifactId&gt;\r\n    &lt;version&gt;3.0.0-beta-8&lt;/version&gt; &lt;!-- update! --&gt;\r\n    &lt;scope&gt;test&lt;/scope&gt;\r\n  &lt;/dependency&gt;\r\n  ```\r\n- This (&quot;full&quot; spring boot application) test passes:\r\n  ```lang-java\r\n  package com.example;\r\n\r\n  import com.example.DemoApp.MyService;\r\n  import com.example.DemoApp.SomeDto;\r\n  import org.junit.jupiter.api.Test;\r\n\r\n  import static com.github.tomakehurst.wiremock.client.WireMock.*;\r\n  import com.github.tomakehurst.wiremock.junit5.WireMockExtension;\r\n  import java.io.IOException;\r\n  import org.junit.jupiter.api.AfterEach;\r\n  import org.junit.jupiter.api.extension.RegisterExtension;\r\n  import org.springframework.beans.factory.annotation.Autowired;\r\n  import org.springframework.boot.test.context.SpringBootTest;\r\n  import org.springframework.test.context.DynamicPropertyRegistry;\r\n  import org.springframework.test.context.DynamicPropertySource;\r\n  import reactor.core.publisher.Flux;\r\n  import reactor.test.StepVerifier;\r\n\r\n  @SpringBootTest\r\n  class MyWireMockTest {\r\n\r\n    @RegisterExtension\r\n    static WireMockExtension wm = WireMockExtension.newInstance()\r\n        // dynamic port is the default\r\n        .build();\r\n\r\n    @DynamicPropertySource\r\n    static void configureProperties(DynamicPropertyRegistry registry) {\r\n      registry.add(&quot;ext_base_url&quot;, wm::baseUrl); // replaces spring property with actual wire mock value\r\n    }\r\n\r\n    @Autowired\r\n    MyService testee;\r\n\r\n    @Test\r\n    void test_something_with_wiremock() throws IOException {\r\n      // given:\r\n      wm.stubFor(get(&quot;/parties&quot;) // static instance!\r\n       // add *successively* &quot;withXXX&quot; conditions here...\r\n       .willReturn(aResponse()\r\n         .withHeader(&quot;Content-Type&quot;, &quot;application/json&quot;)\r\n         .withBody(&quot;&quot;&quot;\r\n          [\r\n            {&quot;userId&quot;: 1,&quot;id&quot;: 1,&quot;title&quot;: &quot;Learn Spring Boot 3.0&quot;, &quot;completed&quot;: false},\r\n            {&quot;userId&quot;: 1,&quot;id&quot;: 2,&quot;title&quot;: &quot;Learn WireMock&quot;, &quot;completed&quot;: true}\r\n          ]\r\n          &quot;&quot;&quot;)\r\n        )\r\n      );\r\n      // when:\r\n      Flux&lt;SomeDto&gt; response = testee.someRestCall();\r\n      // then:\r\n      StepVerifier.create(response)\r\n          .expectNext(SomeDto.of(1, null, null, false))\r\n          .expectNext(SomeDto.of(2, null, null, false))\r\n          .verifyComplete();\r\n    }\r\n\r\n    @AfterEach // cleanup (per test method)\r\n    void afterEach() {\r\n        wm.resetAll();\r\n    }\r\n  }\r\n  ```\r\n\r\nRefs:\r\n- https://rieckpil.de/spring-boot-integration-tests-with-wiremock-and-junit-5/\r\n- https://medium.com/reactive-programming-in-springboot-using-webflux/testing-flux-mono-with-junit-e6150bf3635","title":"Wiremock integration with spring boot is throwing 404 exception as &quot;Request did not match as stub is not registered&quot;","body":"<p>Pheeew, that was not that easy one!</p>\n<ol>\n<li><a href=\"https://wiremock.org/docs/spring-boot/\" rel=\"nofollow noreferrer\">https://wiremock.org/docs/spring-boot/</a> points (currently) &quot;to nirvana&quot; (404)</li>\n<li>We want to test &quot;multiple backend&quot; integration, which is complicated per se.</li>\n</ol>\n<p>I could update <a href=\"https://rieckpil.de/spring-boot-integration-tests-with-wiremock-and-junit-5/\" rel=\"nofollow noreferrer\">https://rieckpil.de/spring-boot-integration-tests-with-wiremock-and-junit-5/</a> (which looks very like your question) to latest versions and got it working like so:</p>\n<ul>\n<li><a href=\"https://start.spring.io/#!type=maven-project&amp;language=java&amp;platformVersion=3.0.6&amp;packaging=jar&amp;jvmVersion=17&amp;groupId=com.example&amp;artifactId=demo&amp;name=demo&amp;description=Demo%20project%20for%20Spring%20Boot&amp;packageName=com.example.demo&amp;dependencies=lombok,webflux\" rel=\"nofollow noreferrer\">(spring-boot)started simple (current, maven, java17, webflux+lombok)</a></li>\n<li>Main, (fictive) demo application, which calls (get on) &quot;some&quot; <code>${ext_base_url}</code> REST API, and (tries to) returns its results as a <code>Flux</code> of <code>SomeDto</code>:\n<pre class=\"lang-java prettyprint-override\"><code>package com.example;\n\nimport lombok.EqualsAndHashCode;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.stereotype.Service;\nimport org.springframework.web.reactive.function.client.WebClient;\nimport reactor.core.publisher.Flux;\n\n@SpringBootApplication\npublic class DemoApp {\n\n  public static void main(String[] args) {\n    SpringApplication.run(DemoApp.class, args);\n  }\n\n  @Service // 1.\n  static class MyService {\n\n    private final WebClient webClient;\n\n    public MyService(WebClient.Builder webClientBuilder,\n        @Value(&quot;${ext_base_url}&quot;) String baseUrl) { // 2.\n      this.webClient = webClientBuilder.baseUrl(baseUrl).build();\n    }\n\n    public Flux&lt;SomeDto&gt; someRestCall() { // 3.\n      return this.webClient.get().uri(&quot;/parties&quot;)\n          .retrieve().bodyToFlux(SomeDto.class);\n    }\n  }\n\n  @lombok.Value(staticConstructor = &quot;of&quot;)\n  @EqualsAndHashCode(onlyExplicitlyIncluded = true) \n  static class SomeDto { // dto\n\n    @EqualsAndHashCode.Include // consider only this, lazy, sorry\n    Integer id;\n    Integer userId;\n    String title;\n    boolean completed;\n  }\n}\n</code></pre>\n</li>\n<li>To mock the &quot;external&quot; API for integration tests we add (current, latest):\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n  &lt;groupId&gt;com.github.tomakehurst&lt;/groupId&gt;\n  &lt;artifactId&gt;wiremock&lt;/artifactId&gt;\n  &lt;version&gt;3.0.0-beta-8&lt;/version&gt; &lt;!-- update! --&gt;\n  &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>\n</li>\n<li>This (&quot;full&quot; spring boot application) test passes:\n<pre class=\"lang-java prettyprint-override\"><code>package com.example;\n\nimport com.example.DemoApp.MyService;\nimport com.example.DemoApp.SomeDto;\nimport org.junit.jupiter.api.Test;\n\nimport static com.github.tomakehurst.wiremock.client.WireMock.*;\nimport com.github.tomakehurst.wiremock.junit5.WireMockExtension;\nimport java.io.IOException;\nimport org.junit.jupiter.api.AfterEach;\nimport org.junit.jupiter.api.extension.RegisterExtension;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.test.context.DynamicPropertyRegistry;\nimport org.springframework.test.context.DynamicPropertySource;\nimport reactor.core.publisher.Flux;\nimport reactor.test.StepVerifier;\n\n@SpringBootTest\nclass MyWireMockTest {\n\n  @RegisterExtension\n  static WireMockExtension wm = WireMockExtension.newInstance()\n      // dynamic port is the default\n      .build();\n\n  @DynamicPropertySource\n  static void configureProperties(DynamicPropertyRegistry registry) {\n    registry.add(&quot;ext_base_url&quot;, wm::baseUrl); // replaces spring property with actual wire mock value\n  }\n\n  @Autowired\n  MyService testee;\n\n  @Test\n  void test_something_with_wiremock() throws IOException {\n    // given:\n    wm.stubFor(get(&quot;/parties&quot;) // static instance!\n     // add *successively* &quot;withXXX&quot; conditions here...\n     .willReturn(aResponse()\n       .withHeader(&quot;Content-Type&quot;, &quot;application/json&quot;)\n       .withBody(&quot;&quot;&quot;\n        [\n          {&quot;userId&quot;: 1,&quot;id&quot;: 1,&quot;title&quot;: &quot;Learn Spring Boot 3.0&quot;, &quot;completed&quot;: false},\n          {&quot;userId&quot;: 1,&quot;id&quot;: 2,&quot;title&quot;: &quot;Learn WireMock&quot;, &quot;completed&quot;: true}\n        ]\n        &quot;&quot;&quot;)\n      )\n    );\n    // when:\n    Flux&lt;SomeDto&gt; response = testee.someRestCall();\n    // then:\n    StepVerifier.create(response)\n        .expectNext(SomeDto.of(1, null, null, false))\n        .expectNext(SomeDto.of(2, null, null, false))\n        .verifyComplete();\n  }\n\n  @AfterEach // cleanup (per test method)\n  void afterEach() {\n      wm.resetAll();\n  }\n}\n</code></pre>\n</li>\n</ul>\n<p>Refs:</p>\n<ul>\n<li><a href=\"https://rieckpil.de/spring-boot-integration-tests-with-wiremock-and-junit-5/\" rel=\"nofollow noreferrer\">https://rieckpil.de/spring-boot-integration-tests-with-wiremock-and-junit-5/</a></li>\n<li><a href=\"https://medium.com/reactive-programming-in-springboot-using-webflux/testing-flux-mono-with-junit-e6150bf3635\" rel=\"nofollow noreferrer\">https://medium.com/reactive-programming-in-springboot-using-webflux/testing-flux-mono-with-junit-e6150bf3635</a></li>\n</ul>\n"},{"tags":[],"owner":{"account_id":290683,"reputation":12512,"user_id":592355,"display_name":"xerx593"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1683645295,"creation_date":1683639679,"answer_id":76210003,"question_id":76193384,"body_markdown":"According to comments, here a sample &quot;docker/standalone&quot; solution:\r\n\r\n1. (Optional) Pull the image. I used `main-alpine` tag, but hope it works also well with [the others][1]:\r\n   ```lang-bash\r\n   docker pull wiremock/wiremock:main-alpine\r\n   ```\r\n2. (Optional) Create a docker volume ([1][2], [2][3]):\r\n   ```lang-bash\r\n   docker volume create wiremock_data\r\n   ```\r\n3. Create &quot;wiremock mappings&quot; (in docker volume or dedicated path).\r\n   I placed a `parties.json` file in my `${docker_volumes_location}/wiremock_data[/_data]/mappings`:\r\n   ```lang-json\r\n   {\r\n      &quot;request&quot;: {\r\n        &quot;method&quot;: &quot;GET&quot;,\r\n        &quot;url&quot;: &quot;/parties&quot;\r\n      },\r\n      &quot;response&quot;: {\r\n        &quot;status&quot;: 200,\r\n        &quot;jsonBody&quot;: [\r\n            {&quot;userId&quot;: 1,&quot;id&quot;: 1,&quot;title&quot;: &quot;Learn Spring Boot 3.0&quot;, &quot;completed&quot;: false},\r\n            {&quot;userId&quot;: 1,&quot;id&quot;: 2,&quot;title&quot;: &quot;Learn WireMock&quot;, &quot;completed&quot;: true}\r\n         ],\r\n         &quot;headers&quot;: {\r\n             &quot;Content-Type&quot;: &quot;application/json&quot;\r\n         }\r\n      }\r\n   }\r\n   ```\r\n   ..it should result in `/home/wiremock/mappings/parties.json` in container&#39;s file system, where &quot;parties&quot; is freely chosen/all jsons in this folder get &quot;scanned&quot;.\r\n4. After:\r\n   ```lang-bash\r\n   docker run \\\r\n     -it --rm \\\r\n     -p 8443:8443 \\\r\n     -v wiremock_data:/home/wiremock \\\r\n     wiremock/wiremock:main-alpine \\\r\n     --https-port 8443 --verbose  \r\n   ```\r\n   with arguments for:\r\n   - interactive, clean up (`-it`, `--rm`)\r\n   - publish port (`-p`)\r\n   - volume mount (`-v`)\r\n   - image name/id/tag \r\n   - container arguments (`https-port, verbose`)\r\n5. ..and successful container start, we can &quot;browse&quot; `https://localhost:8443/parties`:\r\n   - with curl:\r\n     ```lang-bash\r\n     &gt;curl --insecure &#39;https://localhost:8443/parties&#39;           \r\n     [{&quot;userId&quot;:1,&quot;id&quot;:1,&quot;title&quot;:&quot;Learn Spring Boot 3.0&quot;,&quot;completed&quot;:false}, \r\n     {&quot;userId&quot;:1,&quot;id&quot;:2,&quot;title&quot;:&quot;Learn WireMock&quot;,&quot;completed&quot;:true}]\r\n     ```\r\n   - , postman:\r\n      [![postman screenshot][4]][4]\r\n   - and browser:\r\n      [![browser screenshot][5]][5]\r\n\r\n   ... after disabling (self-signed) SSL validation.\r\n6. (`https://localhost:8443/__admin/` shows a (JSON) overview of all current mappings.)\r\n7. (For mapping modifications, we have to restart the container.)\r\n\r\n### Details and References:\r\n\r\n- https://hub.docker.com/r/wiremock/wiremock\r\n- https://docs.docker.com/\r\n- https://wiremock.org/\r\n\r\n### To run (shown) spring boot test against docker (wiremock)\r\nWe:\r\n1. Run the docker instance as described (1. - 7.), on `https://localhost:8443`.\r\n2. Remove &quot;wiremock&quot; dependency(/ies) from (spring-boot) pom.xml.\r\n3. (Without changing the application,) Adjust test to:\r\n   ```lang-java\r\n   package com.example;\r\n\r\n   import javax.net.ssl.SSLException;\r\n\r\n   import org.junit.jupiter.api.Test;\r\n   import org.springframework.beans.factory.annotation.Autowired;\r\n   import org.springframework.boot.test.context.SpringBootTest;\r\n   import org.springframework.boot.test.context.TestConfiguration;\r\n   import org.springframework.boot.web.reactive.function.client.WebClientCustomizer;\r\n   import org.springframework.context.annotation.Bean;\r\n   import org.springframework.http.client.reactive.ReactorClientHttpConnector;\r\n\r\n   import com.example.DemoApp.MyService;\r\n   import com.example.DemoApp.SomeDto;\r\n\r\n   import io.netty.handler.ssl.SslContext;\r\n   import io.netty.handler.ssl.SslContextBuilder;\r\n   import io.netty.handler.ssl.util.InsecureTrustManagerFactory;\r\n   import reactor.core.publisher.Flux;\r\n   import reactor.netty.http.client.HttpClient;\r\n   import reactor.test.StepVerifier;\r\n\r\n   @SpringBootTest(\r\n     /* this sets base url for the client: */\r\n     properties = &quot;ext_base_url=https://localhost:8443&quot;\r\n   )\r\n   class MyWireMockTest {\r\n\r\n     // RE: How to disable SSL validation for springboot-webclient test? Voila:\r\n     @TestConfiguration // 1. (test configuration!) &quot;Adds to&quot; current spring context (doesn&#39;t &quot;replace&quot;)\r\n     static class MyInsecureWebClientConfig { // should be static!\r\n      @Bean // WC customizer bean! (spring-boot, babe)\r\n      WebClientCustomizer wcCustomizr() throws SSLException {\r\n        // combining with [6]:\r\n        SslContext context = SslContextBuilder.forClient()\r\n           .trustManager(InsecureTrustManagerFactory.INSTANCE)\r\n           .build();\r\n        return wcb -&gt; {\r\n         wcb.clientConnector(new ReactorClientHttpConnector(\r\n            HttpClient.create().secure(t -&gt; t.sslContext(context))));\r\n        };\r\n      }\r\n     }\r\n\r\n     @Autowired\r\n     MyService testee;\r\n\r\n     @Test\r\n     void test_something_with_wiremock() throws InterruptedException {\r\n      // given: config, wiremock instance...\r\n      // when:\r\n      Flux&lt;SomeDto&gt; response = testee.someRestCall();\r\n      // then:\r\n      StepVerifier.create(response)\r\n         .expectNext(SomeDto.of(1, null, null, false))\r\n         .expectNext(SomeDto.of(2, null, null, false))\r\n         .verifyComplete();\r\n     }\r\n\r\n   }\r\n   ```\r\n   [\\[6\\]][6]\r\n\r\n\r\n  [1]: https://hub.docker.com/r/wiremock/wiremock\r\n  [2]: https://docs.docker.com/engine/reference/commandline/volume_create/\r\n  [3]: https://docs.docker.com/storage/volumes/\r\n  [4]: https://i.stack.imgur.com/eNuXH.png\r\n  [5]: https://i.stack.imgur.com/VO3BW.png\r\n  [6]: https://stackoverflow.com/q/45418523/592355","title":"Wiremock integration with spring boot is throwing 404 exception as &quot;Request did not match as stub is not registered&quot;","body":"<p>According to comments, here a sample &quot;docker/standalone&quot; solution:</p>\n<ol>\n<li><p>(Optional) Pull the image. I used <code>main-alpine</code> tag, but hope it works also well with <a href=\"https://hub.docker.com/r/wiremock/wiremock\" rel=\"nofollow noreferrer\">the others</a>:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>docker pull wiremock/wiremock:main-alpine\n</code></pre>\n</li>\n<li><p>(Optional) Create a docker volume (<a href=\"https://docs.docker.com/engine/reference/commandline/volume_create/\" rel=\"nofollow noreferrer\">1</a>, <a href=\"https://docs.docker.com/storage/volumes/\" rel=\"nofollow noreferrer\">2</a>):</p>\n<pre class=\"lang-bash prettyprint-override\"><code>docker volume create wiremock_data\n</code></pre>\n</li>\n<li><p>Create &quot;wiremock mappings&quot; (in docker volume or dedicated path).\nI placed a <code>parties.json</code> file in my <code>${docker_volumes_location}/wiremock_data[/_data]/mappings</code>:</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n   &quot;request&quot;: {\n     &quot;method&quot;: &quot;GET&quot;,\n     &quot;url&quot;: &quot;/parties&quot;\n   },\n   &quot;response&quot;: {\n     &quot;status&quot;: 200,\n     &quot;jsonBody&quot;: [\n         {&quot;userId&quot;: 1,&quot;id&quot;: 1,&quot;title&quot;: &quot;Learn Spring Boot 3.0&quot;, &quot;completed&quot;: false},\n         {&quot;userId&quot;: 1,&quot;id&quot;: 2,&quot;title&quot;: &quot;Learn WireMock&quot;, &quot;completed&quot;: true}\n      ],\n      &quot;headers&quot;: {\n          &quot;Content-Type&quot;: &quot;application/json&quot;\n      }\n   }\n}\n</code></pre>\n<p>..it should result in <code>/home/wiremock/mappings/parties.json</code> in container's file system, where &quot;parties&quot; is freely chosen/all jsons in this folder get &quot;scanned&quot;.</p>\n</li>\n<li><p>After:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>docker run \\\n  -it --rm \\\n  -p 8443:8443 \\\n  -v wiremock_data:/home/wiremock \\\n  wiremock/wiremock:main-alpine \\\n  --https-port 8443 --verbose  \n</code></pre>\n<p>with arguments for:</p>\n<ul>\n<li>interactive, clean up (<code>-it</code>, <code>--rm</code>)</li>\n<li>publish port (<code>-p</code>)</li>\n<li>volume mount (<code>-v</code>)</li>\n<li>image name/id/tag</li>\n<li>container arguments (<code>https-port, verbose</code>)</li>\n</ul>\n</li>\n<li><p>..and successful container start, we can &quot;browse&quot; <code>https://localhost:8443/parties</code>:</p>\n<ul>\n<li>with curl:\n<pre class=\"lang-bash prettyprint-override\"><code>&gt;curl --insecure 'https://localhost:8443/parties'           \n[{&quot;userId&quot;:1,&quot;id&quot;:1,&quot;title&quot;:&quot;Learn Spring Boot 3.0&quot;,&quot;completed&quot;:false}, \n{&quot;userId&quot;:1,&quot;id&quot;:2,&quot;title&quot;:&quot;Learn WireMock&quot;,&quot;completed&quot;:true}]\n</code></pre>\n</li>\n<li>, postman:\n<a href=\"https://i.stack.imgur.com/eNuXH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eNuXH.png\" alt=\"postman screenshot\" /></a></li>\n<li>and browser:\n<a href=\"https://i.stack.imgur.com/VO3BW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VO3BW.png\" alt=\"browser screenshot\" /></a></li>\n</ul>\n<p>... after disabling (self-signed) SSL validation.</p>\n</li>\n<li><p>(<code>https://localhost:8443/__admin/</code> shows a (JSON) overview of all current mappings.)</p>\n</li>\n<li><p>(For mapping modifications, we have to restart the container.)</p>\n</li>\n</ol>\n<h3>Details and References:</h3>\n<ul>\n<li><a href=\"https://hub.docker.com/r/wiremock/wiremock\" rel=\"nofollow noreferrer\">https://hub.docker.com/r/wiremock/wiremock</a></li>\n<li><a href=\"https://docs.docker.com/\" rel=\"nofollow noreferrer\">https://docs.docker.com/</a></li>\n<li><a href=\"https://wiremock.org/\" rel=\"nofollow noreferrer\">https://wiremock.org/</a></li>\n</ul>\n<h3>To run (shown) spring boot test against docker (wiremock)</h3>\n<p>We:</p>\n<ol>\n<li>Run the docker instance as described (1. - 7.), on <code>https://localhost:8443</code>.</li>\n<li>Remove &quot;wiremock&quot; dependency(/ies) from (spring-boot) pom.xml.</li>\n<li>(Without changing the application,) Adjust test to:\n<pre class=\"lang-java prettyprint-override\"><code>package com.example;\n\nimport javax.net.ssl.SSLException;\n\nimport org.junit.jupiter.api.Test;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.boot.test.context.TestConfiguration;\nimport org.springframework.boot.web.reactive.function.client.WebClientCustomizer;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.http.client.reactive.ReactorClientHttpConnector;\n\nimport com.example.DemoApp.MyService;\nimport com.example.DemoApp.SomeDto;\n\nimport io.netty.handler.ssl.SslContext;\nimport io.netty.handler.ssl.SslContextBuilder;\nimport io.netty.handler.ssl.util.InsecureTrustManagerFactory;\nimport reactor.core.publisher.Flux;\nimport reactor.netty.http.client.HttpClient;\nimport reactor.test.StepVerifier;\n\n@SpringBootTest(\n  /* this sets base url for the client: */\n  properties = &quot;ext_base_url=https://localhost:8443&quot;\n)\nclass MyWireMockTest {\n\n  // RE: How to disable SSL validation for springboot-webclient test? Voila:\n  @TestConfiguration // 1. (test configuration!) &quot;Adds to&quot; current spring context (doesn't &quot;replace&quot;)\n  static class MyInsecureWebClientConfig { // should be static!\n   @Bean // WC customizer bean! (spring-boot, babe)\n   WebClientCustomizer wcCustomizr() throws SSLException {\n     // combining with [6]:\n     SslContext context = SslContextBuilder.forClient()\n        .trustManager(InsecureTrustManagerFactory.INSTANCE)\n        .build();\n     return wcb -&gt; {\n      wcb.clientConnector(new ReactorClientHttpConnector(\n         HttpClient.create().secure(t -&gt; t.sslContext(context))));\n     };\n   }\n  }\n\n  @Autowired\n  MyService testee;\n\n  @Test\n  void test_something_with_wiremock() throws InterruptedException {\n   // given: config, wiremock instance...\n   // when:\n   Flux&lt;SomeDto&gt; response = testee.someRestCall();\n   // then:\n   StepVerifier.create(response)\n      .expectNext(SomeDto.of(1, null, null, false))\n      .expectNext(SomeDto.of(2, null, null, false))\n      .verifyComplete();\n  }\n\n}\n</code></pre>\n<a href=\"https://stackoverflow.com/q/45418523/592355\">[6]</a></li>\n</ol>\n"},{"tags":[],"owner":{"account_id":17134703,"reputation":11,"user_id":12400032,"display_name":"Simon Heavens"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689968199,"creation_date":1689968199,"answer_id":76740789,"question_id":76193384,"body_markdown":"After updating my dependancy to \r\n\r\n```\r\n&lt;dependency&gt;\r\n  &lt;groupId&gt;com.github.tomakehurst&lt;/groupId&gt;\r\n  &lt;artifactId&gt;wiremock&lt;/artifactId&gt;\r\n  &lt;version&gt;3.0.0-beta-8&lt;/version&gt; &lt;!-- update! --&gt;\r\n  &lt;scope&gt;test&lt;/scope&gt;\r\n&lt;/dependency&gt;\r\n```\r\n\r\nIt worked for me","title":"Wiremock integration with spring boot is throwing 404 exception as &quot;Request did not match as stub is not registered&quot;","body":"<p>After updating my dependancy to</p>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;com.github.tomakehurst&lt;/groupId&gt;\n  &lt;artifactId&gt;wiremock&lt;/artifactId&gt;\n  &lt;version&gt;3.0.0-beta-8&lt;/version&gt; &lt;!-- update! --&gt;\n  &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>It worked for me</p>\n"}],"owner":{"account_id":25847958,"reputation":21,"user_id":19582453,"display_name":"Shruti Mishra"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1360,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":3,"score":2,"last_activity_date":1689968199,"creation_date":1683455571,"question_id":76193384,"body_markdown":"I have been using wiremock for integration testing with spring boot, getting 404 exception.\r\n\r\nWith message as &quot;Request did not match, as no stubs registered&quot;\r\n\r\nI have tried with wiremock server and wiremock rule instance.\r\n\r\nTried with Wiremock&#39;s JUnit jupiter extension approach and Application context initializer approach, nothing seems to be work.\r\n```\r\npackage fi.op.bcsio.application.wiremock;\r\n\r\nimport static com.github.tomakehurst.wiremock.client.WireMock.aResponse;\r\nimport static com.github.tomakehurst.wiremock.client.WireMock.configureFor;\r\nimport static com.github.tomakehurst.wiremock.client.WireMock.containing;\r\nimport static com.github.tomakehurst.wiremock.client.WireMock.equalTo;\r\nimport static com.github.tomakehurst.wiremock.client.WireMock.get;\r\nimport static com.github.tomakehurst.wiremock.client.WireMock.urlEqualTo;\r\nimport static com.github.tomakehurst.wiremock.core.WireMockConfiguration.options;\r\nimport static org.junit.Assert.assertEquals;\r\nimport static org.junit.Assert.assertThat;\r\nimport static org.junit.jupiter.api.Assertions.assertAll;\r\nimport static org.springframework.http.MediaType.APPLICATION_JSON_VALUE;\r\n\r\nimport java.util.function.Supplier;\r\n\r\nimport static com.github.tomakehurst.wiremock.client.WireMock.*;\r\n\r\nimport javax.annotation.PostConstruct;\r\n\r\nimport org.junit.Assert;\r\nimport org.junit.ClassRule;\r\nimport org.junit.Rule;\r\nimport org.junit.Test;\r\nimport org.junit.jupiter.api.AfterEach;\r\nimport org.junit.jupiter.api.extension.RegisterExtension;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.boot.test.context.SpringBootTest;\r\nimport org.springframework.http.HttpStatus;\r\nimport org.springframework.http.MediaType;\r\nimport org.springframework.http.ResponseEntity;\r\nimport org.springframework.stereotype.Component;\r\nimport org.springframework.test.context.ContextConfiguration;\r\nimport org.springframework.test.context.DynamicPropertyRegistry;\r\nimport org.springframework.test.context.DynamicPropertySource;\r\nimport org.springframework.test.web.reactive.server.WebTestClient;\r\nimport org.springframework.web.client.RestTemplate;\r\n\r\nimport com.github.tomakehurst.wiremock.WireMockServer;\r\nimport com.github.tomakehurst.wiremock.client.WireMock;\r\nimport com.github.tomakehurst.wiremock.common.ConsoleNotifier;\r\nimport com.github.tomakehurst.wiremock.core.WireMockConfiguration;\r\nimport com.github.tomakehurst.wiremock.junit.WireMockClassRule;\r\nimport com.github.tomakehurst.wiremock.junit.WireMockRule;\r\nimport com.github.tomakehurst.wiremock.junit5.WireMockExtension;\r\n\r\nimport org.assertj.core.api.Assertions;\r\n\r\n@Component\r\n//@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\r\n//@ContextConfiguration(initializers = {WireMockInitializer.class})\r\npublic class LuukuWiremockStub {\r\n\r\n//\t  @Autowired\r\n//\t  private WebTestClient webTestClient;\r\n\t\r\n\t\r\n//\t@ClassRule\r\n//\tpublic static WireMockRule wireMockRule = new WireMockRule(WireMockConfiguration.DYNAMIC_PORT);\r\n\r\n\t  @RegisterExtension\r\n\t  static WireMockExtension wireMockServer = WireMockExtension.newInstance()\r\n\t    .options(WireMockConfiguration.options().dynamicPort())\r\n\t    .build();\r\n\r\n//\t  @DynamicPropertySource\r\n//\t  static void configureProperties(DynamicPropertyRegistry registry) {\r\n//\t    registry.add(&quot;http://op-common.apis.jty.op-palvelut.net/bankingparties/basic/info/v1/parties?context=Pankin ostopolku&quot;, wireMockServer::baseUrl);\r\n//\t  }\r\n\r\n//\t  @AfterEach\r\n//\t  void resetAll() {\r\n//\t    // we&#39;re using one WireMock server for the test class (see static on the WireMockExtension definition)\r\n//\t\t  wireMockRule.resetAll();\r\n//\t  }\r\n\r\n\t  @Test\r\n\t  void testGetAllTodosShouldReturnDataFromClient() {\r\n\t\t  wireMockServer.stubFor(\r\n\t      WireMock.get(&quot;/parties&quot;)\r\n\t      \r\n\t      .withHeader(&quot;x-request-id&quot;, matching(&quot;[0-9a-fA-F]{8}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{12}&quot;))\r\n\t\t  \r\n\t        .withHeader(&quot;x-session-id&quot;, matching(&quot;[0-9a-fA-F]{8}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{12}&quot;))\r\n\t    \t\t\t  \r\n\t        .withHeader(&quot;x-api-key&quot;, equalTo(&quot;X8Jy6AEXqJjdBx&quot;))\r\n\t    \t\t\t  \r\n\t    \t.withHeader(&quot;Authorization&quot;, matching(&quot;Bearer [a-zA-Z0-9&amp;._-]{1,}&quot;))\r\n\t    \t\r\n\t        .withQueryParam(&quot;context&quot;, equalTo(&quot;Pankin ostopolku&quot;))\r\n\t      \r\n\t        .willReturn(aResponse()\r\n            \r\n\t        .withHeader(&quot;Content-Type&quot;, MediaType.APPLICATION_JSON_VALUE)\r\n\t          \r\n\t        .withBody(&quot;[{\\&quot;userId\\&quot;: 1,\\&quot;id\\&quot;: 1,\\&quot;title\\&quot;: \\&quot;Learn Spring Boot 3.0\\&quot;, \\&quot;completed\\&quot;: false},&quot; +\r\n\t            &quot;{\\&quot;userId\\&quot;: 1,\\&quot;id\\&quot;: 2,\\&quot;title\\&quot;: \\&quot;Learn WireMock\\&quot;, \\&quot;completed\\&quot;: true}]&quot;))\r\n\t    );\r\n\t    \r\n\t    // ... controller invocation using the WebTestClient\r\n\t  }\r\n}\r\n\r\n```\r\nPostman console error:\r\n![Postman console error](https://i.stack.imgur.com/MhEgU.png)\r\nEclipse Console error:\r\n![Eclipse Console error](https://i.stack.imgur.com/ggDNV.png)","title":"Wiremock integration with spring boot is throwing 404 exception as &quot;Request did not match as stub is not registered&quot;","body":"<p>I have been using wiremock for integration testing with spring boot, getting 404 exception.</p>\n<p>With message as &quot;Request did not match, as no stubs registered&quot;</p>\n<p>I have tried with wiremock server and wiremock rule instance.</p>\n<p>Tried with Wiremock's JUnit jupiter extension approach and Application context initializer approach, nothing seems to be work.</p>\n<pre><code>package fi.op.bcsio.application.wiremock;\n\nimport static com.github.tomakehurst.wiremock.client.WireMock.aResponse;\nimport static com.github.tomakehurst.wiremock.client.WireMock.configureFor;\nimport static com.github.tomakehurst.wiremock.client.WireMock.containing;\nimport static com.github.tomakehurst.wiremock.client.WireMock.equalTo;\nimport static com.github.tomakehurst.wiremock.client.WireMock.get;\nimport static com.github.tomakehurst.wiremock.client.WireMock.urlEqualTo;\nimport static com.github.tomakehurst.wiremock.core.WireMockConfiguration.options;\nimport static org.junit.Assert.assertEquals;\nimport static org.junit.Assert.assertThat;\nimport static org.junit.jupiter.api.Assertions.assertAll;\nimport static org.springframework.http.MediaType.APPLICATION_JSON_VALUE;\n\nimport java.util.function.Supplier;\n\nimport static com.github.tomakehurst.wiremock.client.WireMock.*;\n\nimport javax.annotation.PostConstruct;\n\nimport org.junit.Assert;\nimport org.junit.ClassRule;\nimport org.junit.Rule;\nimport org.junit.Test;\nimport org.junit.jupiter.api.AfterEach;\nimport org.junit.jupiter.api.extension.RegisterExtension;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.MediaType;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.stereotype.Component;\nimport org.springframework.test.context.ContextConfiguration;\nimport org.springframework.test.context.DynamicPropertyRegistry;\nimport org.springframework.test.context.DynamicPropertySource;\nimport org.springframework.test.web.reactive.server.WebTestClient;\nimport org.springframework.web.client.RestTemplate;\n\nimport com.github.tomakehurst.wiremock.WireMockServer;\nimport com.github.tomakehurst.wiremock.client.WireMock;\nimport com.github.tomakehurst.wiremock.common.ConsoleNotifier;\nimport com.github.tomakehurst.wiremock.core.WireMockConfiguration;\nimport com.github.tomakehurst.wiremock.junit.WireMockClassRule;\nimport com.github.tomakehurst.wiremock.junit.WireMockRule;\nimport com.github.tomakehurst.wiremock.junit5.WireMockExtension;\n\nimport org.assertj.core.api.Assertions;\n\n@Component\n//@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\n//@ContextConfiguration(initializers = {WireMockInitializer.class})\npublic class LuukuWiremockStub {\n\n//    @Autowired\n//    private WebTestClient webTestClient;\n    \n    \n//  @ClassRule\n//  public static WireMockRule wireMockRule = new WireMockRule(WireMockConfiguration.DYNAMIC_PORT);\n\n      @RegisterExtension\n      static WireMockExtension wireMockServer = WireMockExtension.newInstance()\n        .options(WireMockConfiguration.options().dynamicPort())\n        .build();\n\n//    @DynamicPropertySource\n//    static void configureProperties(DynamicPropertyRegistry registry) {\n//      registry.add(&quot;http://op-common.apis.jty.op-palvelut.net/bankingparties/basic/info/v1/parties?context=Pankin ostopolku&quot;, wireMockServer::baseUrl);\n//    }\n\n//    @AfterEach\n//    void resetAll() {\n//      // we're using one WireMock server for the test class (see static on the WireMockExtension definition)\n//        wireMockRule.resetAll();\n//    }\n\n      @Test\n      void testGetAllTodosShouldReturnDataFromClient() {\n          wireMockServer.stubFor(\n          WireMock.get(&quot;/parties&quot;)\n          \n          .withHeader(&quot;x-request-id&quot;, matching(&quot;[0-9a-fA-F]{8}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{12}&quot;))\n          \n            .withHeader(&quot;x-session-id&quot;, matching(&quot;[0-9a-fA-F]{8}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{4}\\\\\\\\-[0-9a-fA-F]{12}&quot;))\n                      \n            .withHeader(&quot;x-api-key&quot;, equalTo(&quot;X8Jy6AEXqJjdBx&quot;))\n                      \n            .withHeader(&quot;Authorization&quot;, matching(&quot;Bearer [a-zA-Z0-9&amp;._-]{1,}&quot;))\n            \n            .withQueryParam(&quot;context&quot;, equalTo(&quot;Pankin ostopolku&quot;))\n          \n            .willReturn(aResponse()\n            \n            .withHeader(&quot;Content-Type&quot;, MediaType.APPLICATION_JSON_VALUE)\n              \n            .withBody(&quot;[{\\&quot;userId\\&quot;: 1,\\&quot;id\\&quot;: 1,\\&quot;title\\&quot;: \\&quot;Learn Spring Boot 3.0\\&quot;, \\&quot;completed\\&quot;: false},&quot; +\n                &quot;{\\&quot;userId\\&quot;: 1,\\&quot;id\\&quot;: 2,\\&quot;title\\&quot;: \\&quot;Learn WireMock\\&quot;, \\&quot;completed\\&quot;: true}]&quot;))\n        );\n        \n        // ... controller invocation using the WebTestClient\n      }\n}\n\n</code></pre>\n<p>Postman console error:\n<img src=\"https://i.stack.imgur.com/MhEgU.png\" alt=\"Postman console error\" />\nEclipse Console error:\n<img src=\"https://i.stack.imgur.com/ggDNV.png\" alt=\"Eclipse Console error\" /></p>\n"},{"tags":["java","apache-kafka","kafka-producer-api"],"answers":[{"tags":[],"owner":{"account_id":9605621,"reputation":37107,"user_id":7131757,"accept_rate":77,"display_name":"Giorgos Myrianthous"},"down_vote_count":1,"up_vote_count":10,"is_accepted":true,"score":9,"last_activity_date":1582199444,"creation_date":1582198664,"answer_id":60319079,"question_id":60318519,"body_markdown":"In contrast to consumers, it is **not** possible to retrieve such information since Kafka brokers don&#39;t store any kind of information about the producers connected to them.  \r\n\r\n","title":"How to list all producers of a kafka cluster?","body":"<p>In contrast to consumers, it is <strong>not</strong> possible to retrieve such information since Kafka brokers don't store any kind of information about the producers connected to them.  </p>\n"},{"tags":[],"owner":{"account_id":10081405,"reputation":3033,"user_id":7451566,"display_name":"senjin.hajrulahovic"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689967778,"creation_date":1689967778,"answer_id":76740741,"question_id":60318519,"body_markdown":"It is possible to get all active producer using AdminClient API:\r\n\r\n```java\r\nCollection&lt;TopicPartition&gt; topicPartitions = ...\r\n\r\nDescribeProducersResult result = adminClient.describeProducers(\r\n  Collections.singleton(topicPartition)\r\n);\r\n\r\nMap&lt;TopicPartition, DescribeProducersResult.PartitionProducerState&gt; producerStateMap = result.all().get();\r\n```\r\n\r\nhttps://kafka.apache.org/32/javadoc/org/apache/kafka/clients/admin/KafkaAdminClient.html#describeProducers(java.util.Collection,org.apache.kafka.clients.admin.DescribeProducersOptions)","title":"How to list all producers of a kafka cluster?","body":"<p>It is possible to get all active producer using AdminClient API:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Collection&lt;TopicPartition&gt; topicPartitions = ...\n\nDescribeProducersResult result = adminClient.describeProducers(\n  Collections.singleton(topicPartition)\n);\n\nMap&lt;TopicPartition, DescribeProducersResult.PartitionProducerState&gt; producerStateMap = result.all().get();\n</code></pre>\n<p><a href=\"https://kafka.apache.org/32/javadoc/org/apache/kafka/clients/admin/KafkaAdminClient.html#describeProducers(java.util.Collection,org.apache.kafka.clients.admin.DescribeProducersOptions)\" rel=\"nofollow noreferrer\">https://kafka.apache.org/32/javadoc/org/apache/kafka/clients/admin/KafkaAdminClient.html#describeProducers(java.util.Collection,org.apache.kafka.clients.admin.DescribeProducersOptions)</a></p>\n"}],"owner":{"account_id":8806171,"reputation":480,"user_id":6580775,"display_name":"kaiffeetasse"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":8182,"favorite_count":0,"down_vote_count":0,"up_vote_count":11,"accepted_answer_id":60319079,"answer_count":2,"score":11,"last_activity_date":1689967778,"creation_date":1582196751,"question_id":60318519,"body_markdown":"I am able to list all Kafka Consumer with `KafkaAdminClient`:\r\n\r\n    AdminClient client = AdminClient.create(conf);\r\n    ListTopicsResult ltr = client.listTopics();\r\n    KafkaFuture&lt;Set&lt;String&gt;&gt; names = ltr.names();\r\n    \r\n    ArrayList&lt;ConsumerGroupListing&gt; consumerGroups = new ArrayList&lt;&gt;(client.listConsumerGroups().all().get());\r\n    ConsumerGroupListing consumerGroup = consumerGroups.get(0);\r\n\r\nIs it possible to list all registrated producers in a similar way?","title":"How to list all producers of a kafka cluster?","body":"<p>I am able to list all Kafka Consumer with <code>KafkaAdminClient</code>:</p>\n\n<pre><code>AdminClient client = AdminClient.create(conf);\nListTopicsResult ltr = client.listTopics();\nKafkaFuture&lt;Set&lt;String&gt;&gt; names = ltr.names();\n\nArrayList&lt;ConsumerGroupListing&gt; consumerGroups = new ArrayList&lt;&gt;(client.listConsumerGroups().all().get());\nConsumerGroupListing consumerGroup = consumerGroups.get(0);\n</code></pre>\n\n<p>Is it possible to list all registrated producers in a similar way?</p>\n"},{"tags":["java","spring","spring-boot"],"comments":[{"owner":{"account_id":1771189,"reputation":32923,"user_id":1615903,"display_name":"1615903"},"score":0,"creation_date":1689912276,"post_id":76734902,"comment_id":135283109,"body_markdown":"Does this answer your question? [@Conditionalonproperty for complex objects to yaml](https://stackoverflow.com/questions/64228084/conditionalonproperty-for-complex-objects-to-yaml)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/64228084/conditionalonproperty-for-complex-objects-to-yaml\">@Conditionalonproperty for complex objects to yaml</a>"},{"owner":{"account_id":28480293,"reputation":95,"user_id":21794356,"display_name":"Emiya Elien"},"score":0,"creation_date":1689918229,"post_id":76734902,"comment_id":135283710,"body_markdown":"@1615903 thanks but not yet, I wanna to specify one or more upper layer prefix which not considered lower layer what really need. To be exact, what I really want is spreate the `Prefix` and `Config`, in my Configuration class, I just assure the prefix is immutable and others will be dealed by Properties and Parser, though some property will change it&#39;s name or even new or deleted, but configuration don&#39;t care, that&#39;s my expects","body":"@1615903 thanks but not yet, I wanna to specify one or more upper layer prefix which not considered lower layer what really need. To be exact, what I really want is spreate the <code>Prefix</code> and <code>Config</code>, in my Configuration class, I just assure the prefix is immutable and others will be dealed by Properties and Parser, though some property will change it&#39;s name or even new or deleted, but configuration don&#39;t care, that&#39;s my expects"}],"answers":[{"tags":[],"owner":{"account_id":18535178,"reputation":340,"user_id":13505007,"display_name":"Spyros Palaiokostas"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1689944893,"creation_date":1689944893,"answer_id":76738299,"question_id":76734902,"body_markdown":"The `@ConditionalOnProperty` enables bean registration only if an environment property is present and has a specific value.\r\n\r\nThis means that you cannot use it to check if the property is present in the `application.yml` or `application.properties` file.\r\n\r\nI think you have 2 options\r\n\r\n\r\n----------\r\n**Option 1: Add a new property in the application properties**\r\n\r\nYou can add a new property in the application properties file. \r\n\r\nFor example:\r\n```yaml\r\nmy:\r\n  redis:\r\n    enabled: true\r\n    connections:\r\n      - name: redis-1\r\n        address: 127.0.0.1:6379\r\n        mode: master\r\n      - name: redis-2\r\n        address: 127.0.0.1:6479\r\n        mode: slave\r\n        ofSlave: redis-1\r\n      - name: redis-3\r\n        address: 127.0.0.1:6579\r\n        mode: slave\r\n        ofSlave: redis-1\r\n```\r\n\r\nThe new property `my.redis.enabled` is not required to be mapped by the object used to map the connection properties, so it should not affect how you read the configuration. \r\n\r\nNow you can use `my.redis.enabled`\r\n```java\r\n@ConditionalOnProperty(&quot;my.redis.enabled&quot;)\r\npublic class MyRedisAutoConfiguration {}\r\n```\r\n\r\nThis is the simplest and better solution IMO\r\n\r\n\r\n----------\r\n**Option 2: Implement Custom Condition**\r\n\r\nYou can map the configuration in a class, for example:\r\n\r\n```java\r\n@ConfigurationProperties(prefix = &quot;my.redis&quot;)\r\npublic class RedisConnectionProperties {\r\n    \r\n    private Map&lt;String, String&gt; connections;\r\n\r\n    public Map&lt;String, String&gt; getConnections() {\r\n        return connections;\r\n    }\r\n\r\n    public void setConnections(Map&lt;String, String&gt; connections) {\r\n        this.connections = connections;\r\n    }\r\n\r\n}\r\n```\r\n\r\nAnd then implement a custom condition that will check if the `Map` of Redis connection that was mapped to `RedisConnectionProperties` is empty:\r\n\r\n```java\r\npublic class RedisConnection implements Condition {\r\n\r\n  @Override\r\n  public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {\r\n    RedisConnectionProperties config = Binder.get(context.getEnvironment())\r\n        .bind(&quot;my.redis&quot;,RedisConnectionProperties.class)\r\n        .orElse(null);\r\n    return config != null &amp;&amp; config.getConnections() != null &amp;&amp; !config.getConnections().isEmpty();\r\n  }\r\n}\r\n```\r\n\r\nFinally, you can use this condition on `MyRedisAutoConfiguration`:\r\n\r\n```java\r\n@Conditional(RedisConnection.class)\r\npublic class MyRedisAutoConfiguration {}\r\n```\r\n\r\n","title":"How to make Spring @ConditionalOnProperty check by if an property is present without value","body":"<p>The <code>@ConditionalOnProperty</code> enables bean registration only if an environment property is present and has a specific value.</p>\n<p>This means that you cannot use it to check if the property is present in the <code>application.yml</code> or <code>application.properties</code> file.</p>\n<p>I think you have 2 options</p>\n<hr />\n<p><strong>Option 1: Add a new property in the application properties</strong></p>\n<p>You can add a new property in the application properties file.</p>\n<p>For example:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>my:\n  redis:\n    enabled: true\n    connections:\n      - name: redis-1\n        address: 127.0.0.1:6379\n        mode: master\n      - name: redis-2\n        address: 127.0.0.1:6479\n        mode: slave\n        ofSlave: redis-1\n      - name: redis-3\n        address: 127.0.0.1:6579\n        mode: slave\n        ofSlave: redis-1\n</code></pre>\n<p>The new property <code>my.redis.enabled</code> is not required to be mapped by the object used to map the connection properties, so it should not affect how you read the configuration.</p>\n<p>Now you can use <code>my.redis.enabled</code></p>\n<pre class=\"lang-java prettyprint-override\"><code>@ConditionalOnProperty(&quot;my.redis.enabled&quot;)\npublic class MyRedisAutoConfiguration {}\n</code></pre>\n<p>This is the simplest and better solution IMO</p>\n<hr />\n<p><strong>Option 2: Implement Custom Condition</strong></p>\n<p>You can map the configuration in a class, for example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@ConfigurationProperties(prefix = &quot;my.redis&quot;)\npublic class RedisConnectionProperties {\n    \n    private Map&lt;String, String&gt; connections;\n\n    public Map&lt;String, String&gt; getConnections() {\n        return connections;\n    }\n\n    public void setConnections(Map&lt;String, String&gt; connections) {\n        this.connections = connections;\n    }\n\n}\n</code></pre>\n<p>And then implement a custom condition that will check if the <code>Map</code> of Redis connection that was mapped to <code>RedisConnectionProperties</code> is empty:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class RedisConnection implements Condition {\n\n  @Override\n  public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {\n    RedisConnectionProperties config = Binder.get(context.getEnvironment())\n        .bind(&quot;my.redis&quot;,RedisConnectionProperties.class)\n        .orElse(null);\n    return config != null &amp;&amp; config.getConnections() != null &amp;&amp; !config.getConnections().isEmpty();\n  }\n}\n</code></pre>\n<p>Finally, you can use this condition on <code>MyRedisAutoConfiguration</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Conditional(RedisConnection.class)\npublic class MyRedisAutoConfiguration {}\n</code></pre>\n"}],"owner":{"account_id":28480293,"reputation":95,"user_id":21794356,"display_name":"Emiya Elien"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":672,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"accepted_answer_id":76738299,"answer_count":1,"score":1,"last_activity_date":1689966895,"creation_date":1689909140,"question_id":76734902,"body_markdown":"Well, my own project has a special config file, it can set multi-source of Redis\r\n\r\n```yaml\r\nmy:\r\n  redis:\r\n    connections:\r\n      - name: redis-1\r\n        address: 127.0.0.1:6379\r\n        mode: master\r\n      - name: redis-2\r\n        address: 127.0.0.1:6479\r\n        mode: slave\r\n        ofSlave: redis-1\r\n      - name: redis-3\r\n        address: 127.0.0.1:6579\r\n        mode: slave\r\n        ofSlave: redis-1\r\n\r\n```\r\n\r\nI try to build an Auto-Configuration Class and it will be loaded on property detected\r\n\r\n```\r\n// @Configuration // controll by @EnableMyRedis\r\n@ConditionalOnProperty(&quot;my.redis.connections&quot;)\r\npublic class MyRedisAutoConfiguration {\r\n\r\n}\r\n```\r\n\r\nSo I want to load this Configuration and other Components when my `application.yml` file contains the property `my.redis.connections`, even though is does not have value.\r\n\r\n---\r\nAddition:\r\n\r\nThings I really want can be expressed as this example, an `AutoConfiguration` and a `PropertyBeanDefinitionRegistrar`\r\n\r\n```\r\n@Import(AutoConfiguration.class)\r\npublic @annotation EnableMyRedis {\r\n}\r\n\r\n@MyConditionalOnProperty(prefix = &quot;my.redis.connections&quot;)\r\n@Import(PropertyBeanDefinitionRegistrar.class)\r\npublic class AutoConfiguration {\r\n\r\n}\r\n\r\npublic class PropertyBeanDefinitionRegistrar implements\r\n    EnvironmentAware, BeanDefinitionRegistrar {\r\n\r\n}\r\n```\r\n\r\nIt&#39;s very clear to see their relationship;\r\n\r\n1. If Have Enabled, then load `AutoConfiguration`, otherwise not\r\n2. If Have property-prefix &#39;my.redis.connections&#39;, then load `PropertyBeanDefinitionRegistrar`, otherwise not\r\n3. In this step, property-file will be really dealed and generating beans.\r\n\r\n---\r\n\r\nBut I enabled `debug: true` and found it doesn&#39;t work, the `PropertyResolver` or Environment in method `getMatchOutcome` of Class `OnPropertyCondition` only checked the real property instead of layer relation\r\n\r\nHow can I achieve my needs?","title":"How to make Spring @ConditionalOnProperty check by if an property is present without value","body":"<p>Well, my own project has a special config file, it can set multi-source of Redis</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>my:\n  redis:\n    connections:\n      - name: redis-1\n        address: 127.0.0.1:6379\n        mode: master\n      - name: redis-2\n        address: 127.0.0.1:6479\n        mode: slave\n        ofSlave: redis-1\n      - name: redis-3\n        address: 127.0.0.1:6579\n        mode: slave\n        ofSlave: redis-1\n\n</code></pre>\n<p>I try to build an Auto-Configuration Class and it will be loaded on property detected</p>\n<pre><code>// @Configuration // controll by @EnableMyRedis\n@ConditionalOnProperty(&quot;my.redis.connections&quot;)\npublic class MyRedisAutoConfiguration {\n\n}\n</code></pre>\n<p>So I want to load this Configuration and other Components when my <code>application.yml</code> file contains the property <code>my.redis.connections</code>, even though is does not have value.</p>\n<hr />\n<p>Addition:</p>\n<p>Things I really want can be expressed as this example, an <code>AutoConfiguration</code> and a <code>PropertyBeanDefinitionRegistrar</code></p>\n<pre><code>@Import(AutoConfiguration.class)\npublic @annotation EnableMyRedis {\n}\n\n@MyConditionalOnProperty(prefix = &quot;my.redis.connections&quot;)\n@Import(PropertyBeanDefinitionRegistrar.class)\npublic class AutoConfiguration {\n\n}\n\npublic class PropertyBeanDefinitionRegistrar implements\n    EnvironmentAware, BeanDefinitionRegistrar {\n\n}\n</code></pre>\n<p>It's very clear to see their relationship;</p>\n<ol>\n<li>If Have Enabled, then load <code>AutoConfiguration</code>, otherwise not</li>\n<li>If Have property-prefix 'my.redis.connections', then load <code>PropertyBeanDefinitionRegistrar</code>, otherwise not</li>\n<li>In this step, property-file will be really dealed and generating beans.</li>\n</ol>\n<hr />\n<p>But I enabled <code>debug: true</code> and found it doesn't work, the <code>PropertyResolver</code> or Environment in method <code>getMatchOutcome</code> of Class <code>OnPropertyCondition</code> only checked the real property instead of layer relation</p>\n<p>How can I achieve my needs?</p>\n"},{"tags":["java","string","search","substring"],"comments":[{"owner":{"account_id":7871558,"reputation":5,"user_id":5948666,"display_name":"Laurenţiu Roşu"},"score":0,"creation_date":1455892936,"post_id":35507908,"comment_id":58706752,"body_markdown":"Sorry about the ok=1 and i=1; I have removed them from the code.","body":"Sorry about the ok=1 and i=1; I have removed them from the code."},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":1,"creation_date":1455892940,"post_id":35507908,"comment_id":58706758,"body_markdown":"Code review is off-topic for SO. For review, there is [Code Review](http://codereview.stackexchange.com/). If your code is not working, please describe your input, your expected output and your observed output.","body":"Code review is off-topic for SO. For review, there is <a href=\"http://codereview.stackexchange.com/\">Code Review</a>. If your code is not working, please describe your input, your expected output and your observed output."},{"owner":{"account_id":1936546,"reputation":133665,"user_id":1743880,"accept_rate":100,"display_name":"Tunaki"},"score":2,"creation_date":1455892960,"post_id":35507908,"comment_id":58706767,"body_markdown":"@Turing85 Don&#39;t recommend CR, this is off-topic there.","body":"@Turing85 Don&#39;t recommend CR, this is off-topic there."},{"owner":{"account_id":476178,"reputation":2048,"user_id":886945,"display_name":"Steve Wong"},"score":0,"creation_date":1455893077,"post_id":35507908,"comment_id":58706851,"body_markdown":"Why doesn&#39;t it work?  Does the code print 4 and you expect 1?","body":"Why doesn&#39;t it work?  Does the code print 4 and you expect 1?"},{"owner":{"account_id":40721,"reputation":357288,"user_id":118068,"display_name":"Marc B"},"score":2,"creation_date":1455893128,"post_id":35507908,"comment_id":58706892,"body_markdown":"Not working **HOW**?","body":"Not working <b>HOW</b>?"}],"answers":[{"tags":[],"owner":{"account_id":2915811,"reputation":10602,"user_id":2499035,"accept_rate":100,"display_name":"resueman"},"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1455893040,"creation_date":1455893040,"answer_id":35507962,"question_id":35507908,"body_markdown":"The problem is you&#39;re using the wrong end condition on your `for` loop. The highest index in `s2` that you attempt to access is `i + s1.length()`, so you need to make sure that&#39;s always at most `s2.length() - 1`.\r\n\r\nChange your `for` loop to this:\r\n\r\n    for(i = 0; i + s1.length() &lt; s2.length(); i++)\r\n\r\nAnd it will work.","title":"How many times there is a substring in a string [Java]","body":"<p>The problem is you're using the wrong end condition on your <code>for</code> loop. The highest index in <code>s2</code> that you attempt to access is <code>i + s1.length()</code>, so you need to make sure that's always at most <code>s2.length() - 1</code>.</p>\n\n<p>Change your <code>for</code> loop to this:</p>\n\n<pre><code>for(i = 0; i + s1.length() &lt; s2.length(); i++)\n</code></pre>\n\n<p>And it will work.</p>\n"},{"tags":[],"owner":{"account_id":4217278,"reputation":799,"user_id":3453066,"accept_rate":92,"display_name":"Jure"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1455893173,"creation_date":1455893173,"answer_id":35507998,"question_id":35507908,"body_markdown":"This is a little diffrent approach, but it should also work. You just split the string and check it&#39;s size -1:\r\n\r\n    String s1 = &quot;si&quot;;\r\n    String s2 = &quot;sir1 si cu sir2 fac un sir3&quot;;\r\n    String[] split = s2.split(s1);\r\n    System.out.println(&quot;number of substrings: &quot; + (split.length - 1));","title":"How many times there is a substring in a string [Java]","body":"<p>This is a little diffrent approach, but it should also work. You just split the string and check it's size -1:</p>\n\n<pre><code>String s1 = \"si\";\nString s2 = \"sir1 si cu sir2 fac un sir3\";\nString[] split = s2.split(s1);\nSystem.out.println(\"number of substrings: \" + (split.length - 1));\n</code></pre>\n"},{"tags":[],"owner":{"account_id":162699,"reputation":138060,"user_id":3788176,"accept_rate":54,"display_name":"Andy Turner"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1455893441,"creation_date":1455893296,"answer_id":35508046,"question_id":35507908,"body_markdown":"I would count how many times [`String.indexOf`](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#indexOf-java.lang.String-int-) returns a non-negative number:\r\n\r\n    int lastPos = -1;\r\n    int count = 0;\r\n    while (true) {\r\n      lastPos = s2.indexOf(s1, lastPos + 1);\r\n      if (lastPos &lt; 0) break;\r\n      ++count;\r\n    }\r\n\r\nThis is much more efficient than using `String.split` (or `String.substring`) because it doesn&#39;t construct any additional objects.","title":"How many times there is a substring in a string [Java]","body":"<p>I would count how many times <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#indexOf-java.lang.String-int-\" rel=\"nofollow\"><code>String.indexOf</code></a> returns a non-negative number:</p>\n\n<pre><code>int lastPos = -1;\nint count = 0;\nwhile (true) {\n  lastPos = s2.indexOf(s1, lastPos + 1);\n  if (lastPos &lt; 0) break;\n  ++count;\n}\n</code></pre>\n\n<p>This is much more efficient than using <code>String.split</code> (or <code>String.substring</code>) because it doesn't construct any additional objects.</p>\n"},{"tags":[],"owner":{"account_id":23703015,"reputation":1,"user_id":17725932,"display_name":"Akash Patel"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689966779,"creation_date":1689966779,"answer_id":76740655,"question_id":35507908,"body_markdown":"fix of your soultion\r\n\r\n    public class Main {\r\n\r\n    public static void main(String[] args) {\r\n        String s1 = &quot;si&quot;;\r\n        String s2 = &quot;sir1 si cu sir2 fac un sir3&quot;;\r\n\r\n        int count = 0;\r\n        int i=1;\r\n        for(i=0;i&lt;s2.length()-s1.length();i++) {\r\n            if (s2.substring(i, i + s1.length()).equals(s1))\r\n                count++;\r\n        }\r\n        System.out.println(count);\r\n    }}\r\n\r\nonly for loop line is wrong\r\n\r\n    for(i=0;i&lt;s2.length()-s1.length();i++)\r\n\r\n","title":"How many times there is a substring in a string [Java]","body":"<p>fix of your soultion</p>\n<pre><code>public class Main {\n\npublic static void main(String[] args) {\n    String s1 = &quot;si&quot;;\n    String s2 = &quot;sir1 si cu sir2 fac un sir3&quot;;\n\n    int count = 0;\n    int i=1;\n    for(i=0;i&lt;s2.length()-s1.length();i++) {\n        if (s2.substring(i, i + s1.length()).equals(s1))\n            count++;\n    }\n    System.out.println(count);\n}}\n</code></pre>\n<p>only for loop line is wrong</p>\n<pre><code>for(i=0;i&lt;s2.length()-s1.length();i++)\n</code></pre>\n"}],"owner":{"account_id":7871558,"reputation":5,"user_id":5948666,"display_name":"Laurenţiu Roşu"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":645,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"accepted_answer_id":35507962,"answer_count":4,"score":-2,"last_activity_date":1689966779,"creation_date":1455892870,"question_id":35507908,"body_markdown":"I am trying to write a code in order to determine how many times there is the string s1 in the string s2.\r\n\r\nThis is the code I have written,but doesn&#39;t work:\r\n\r\n    package lab2_1;\r\n\r\n    public class Main {\r\n    \r\n        public static void main(String[] args) {\r\n            String s1 = &quot;si&quot;;\r\n            String s2 = &quot;sir1 si cu sir2 fac un sir3&quot;;\r\n    \r\n            int count = 0;\r\n            int ok=1;\r\n            int i=1;\r\n            for(i=0;i&lt;=s2.length()-1;i++)\r\n                if (s2.substring(i,i+s1.length()).equals(s1))\r\n                    count++;\r\n    \r\n    \r\n            System.out.println(count);\r\n    \r\n        }\r\n    }\r\n\r\nCan you anyone please review my code and tell me what is my mistake?","title":"How many times there is a substring in a string [Java]","body":"<p>I am trying to write a code in order to determine how many times there is the string s1 in the string s2.</p>\n\n<p>This is the code I have written,but doesn't work:</p>\n\n<pre><code>package lab2_1;\n\npublic class Main {\n\n    public static void main(String[] args) {\n        String s1 = \"si\";\n        String s2 = \"sir1 si cu sir2 fac un sir3\";\n\n        int count = 0;\n        int ok=1;\n        int i=1;\n        for(i=0;i&lt;=s2.length()-1;i++)\n            if (s2.substring(i,i+s1.length()).equals(s1))\n                count++;\n\n\n        System.out.println(count);\n\n    }\n}\n</code></pre>\n\n<p>Can you anyone please review my code and tell me what is my mistake?</p>\n"},{"tags":["java","android","google-cloud-platform","google-drive-api"],"comments":[{"owner":{"account_id":2066403,"reputation":109410,"user_id":1841839,"accept_rate":71,"display_name":"Linda Lawton - DaImTo"},"score":0,"creation_date":1689746692,"post_id":76717954,"comment_id":135255022,"body_markdown":"remove spaces drive if that doesn&#39;t work remove the name in the q parm to see what happens.   let me know","body":"remove spaces drive if that doesn&#39;t work remove the name in the q parm to see what happens.   let me know"},{"owner":{"account_id":29045854,"reputation":1,"user_id":22249718,"display_name":"Vinicbr123"},"score":0,"creation_date":1689918243,"post_id":76717954,"comment_id":135283715,"body_markdown":"@LindaLawton-DaImTo I did both things but it doesn&#39;t work, the list of folders continues with size 0, I even changed my google account and set everything up again, but the same thing happened.","body":"@LindaLawton-DaImTo I did both things but it doesn&#39;t work, the list of folders continues with size 0, I even changed my google account and set everything up again, but the same thing happened."},{"owner":{"account_id":2066403,"reputation":109410,"user_id":1841839,"accept_rate":71,"display_name":"Linda Lawton - DaImTo"},"score":0,"creation_date":1689927383,"post_id":76717954,"comment_id":135285241,"body_markdown":"are you using a service account?","body":"are you using a service account?"},{"owner":{"account_id":29045854,"reputation":1,"user_id":22249718,"display_name":"Vinicbr123"},"score":0,"creation_date":1689963665,"post_id":76717954,"comment_id":135292149,"body_markdown":"@LindaLawton-DaImTo yes","body":"@LindaLawton-DaImTo yes"},{"owner":{"account_id":29045854,"reputation":1,"user_id":22249718,"display_name":"Vinicbr123"},"score":1,"creation_date":1690010530,"post_id":76717954,"comment_id":135295883,"body_markdown":"@LindaLawton-DaImTo i changed &quot;Scopes.DRIVE_FILE&quot; for &quot;DriveScopes.DRIVE&quot; and it worked","body":"@LindaLawton-DaImTo i changed &quot;Scopes.DRIVE_FILE&quot; for &quot;DriveScopes.DRIVE&quot; and it worked"}],"answers":[{"tags":[],"owner":{"account_id":2066403,"reputation":109410,"user_id":1841839,"accept_rate":71,"display_name":"Linda Lawton - DaImTo"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689966286,"creation_date":1689966286,"answer_id":76740606,"question_id":76717954,"body_markdown":"Remember a service account isn&#39;t you.   its a dummy account it has its own drive account with nothing in it.   It doesn&#39;t have access to anything until you give it access.\r\n\r\nTake the service account email address and share the directory with it.","title":"Unable to locate specific folder using Google Drive API","body":"<p>Remember a service account isn't you.   its a dummy account it has its own drive account with nothing in it.   It doesn't have access to anything until you give it access.</p>\n<p>Take the service account email address and share the directory with it.</p>\n"}],"owner":{"account_id":29045854,"reputation":1,"user_id":22249718,"display_name":"Vinicbr123"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":61,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689966286,"creation_date":1689740114,"question_id":76717954,"body_markdown":"I&#39;m trying to get the url of a file that is on my drive, knowing its name and the name of the parent folder. But the result is always null.\r\n\r\nI&#39;m using a service account with owner permission, I already put the correct credentials inside the project and shared the folder and file with the service account email and still the problem continues. When debugging the code it is possible to see that the size of `List&lt;File&gt; folders = result.getFiles(); ` is 0.\r\n\r\nHere is the complete code:\r\n\r\n```\r\nimport android.content.Context;\r\n\r\nimport com.google.api.client.googleapis.javanet.GoogleNetHttpTransport;\r\nimport com.google.api.client.http.HttpRequestInitializer;\r\nimport com.google.api.client.http.HttpTransport;\r\nimport com.google.api.client.json.JsonFactory;\r\nimport com.google.api.client.json.gson.GsonFactory;\r\nimport com.google.api.services.drive.Drive;\r\nimport com.google.api.services.drive.DriveScopes;\r\nimport com.google.api.services.drive.model.File;\r\nimport com.google.api.services.drive.model.FileList;\r\nimport com.google.auth.http.HttpCredentialsAdapter;\r\nimport com.google.auth.oauth2.GoogleCredentials;\r\n\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.security.GeneralSecurityException;\r\nimport java.util.Collections;\r\nimport java.util.List;\r\n\r\npublic class DriveAccessRunnable implements Runnable {\r\n\r\n   private static final String APPLICATION_NAME = &quot;School Grade&quot;;\r\n\r\n   private static final JsonFactory JSON_FACTORY = GsonFactory.getDefaultInstance();\r\n\r\n   private static Drive driveService;\r\n   private final Context context;\r\n   private final String parentFolderTitle;\r\n   private final String fileName;\r\n   private final DriveAccessCallback callback;\r\n\r\n   public DriveAccessRunnable(Context context, String parentFolderTitle, String fileName, DriveAccessCallback callback) {\r\n      this.context = context;\r\n      this.parentFolderTitle = parentFolderTitle;\r\n      this.fileName = fileName;\r\n      this.callback = callback;\r\n   }\r\n\r\n   @Override\r\n   public void run() {\r\n      try {\r\n         // Google Drive access code\r\n         HttpTransport httpTransport = GoogleNetHttpTransport.newTrustedTransport();\r\n         driveService = new Drive.Builder(httpTransport, JSON_FACTORY, getHttpRequestInitializer())\r\n                 .setApplicationName(APPLICATION_NAME)\r\n                 .build();\r\n\r\n         // Get the URL of the file or null if not found\r\n         String fileUrl = getFileUrl(parentFolderTitle, fileName);\r\n\r\n        \r\n         // Call the callback with the result\r\n         callback.onFileUrlReceived(fileUrl);\r\n      } catch (IOException | GeneralSecurityException e) {\r\n         e.printStackTrace();\r\n         // Call the callback with an error result\r\n         callback.onError(e.getMessage());\r\n      }\r\n\r\n   }\r\n\r\n   private HttpRequestInitializer getHttpRequestInitializer() throws IOException {\r\n      InputStream credentialsStream = context.getResources().openRawResource(R.raw.credentials);\r\n\r\n      GoogleCredentials credentials = GoogleCredentials.fromStream(credentialsStream)\r\n              .createScoped(Collections.singletonList(DriveScopes.DRIVE_FILE));\r\n\r\n      return new HttpCredentialsAdapter(credentials);\r\n   }\r\n\r\n   private String getFileUrl(String parentFolderTitle, String fileName) throws IOException {\r\n     \r\n       // Search parent folder by title\r\n      FileList result = driveService.files().list()\r\n              .setQ(&quot;mimeType=&#39;application/vnd.google-apps.folder&#39; and trashed=false and name=&#39;&quot; + parentFolderTitle + &quot;&#39;&quot;)\r\n              .setSpaces(&quot;drive&quot;)\r\n              .setFields(&quot;files(id)&quot;)\r\n              .execute();\r\n\r\n      List&lt;File&gt; folders = result.getFiles();\r\n\r\n      if (!folders.isEmpty()) {\r\n         String parentFolderId = folders.get(0).getId();\r\n\r\n         \r\n         // Browse files inside the parent folder\r\n         result = driveService.files().list()\r\n                 .setQ(&quot;&#39;&quot; + parentFolderId + &quot;&#39; in parents and trashed=false&quot;)\r\n                 .setFields(&quot;files(name, webViewLink)&quot;)\r\n                 .execute();\r\n\r\n         List&lt;File&gt; files = result.getFiles();\r\n         for (File file : files) {\r\n            if (file.getName().equals(fileName)) {\r\n               return file.getWebViewLink();\r\n            }\r\n         }\r\n      }\r\n\r\n      return null;\r\n   }\r\n\r\n\r\n   public interface DriveAccessCallback {\r\n      void onFileUrlReceived(String fileUrl);\r\n      void onError(String errorMessage);\r\n   }\r\n}\r\n```\r\n\r\n\r\n\r\n","title":"Unable to locate specific folder using Google Drive API","body":"<p>I'm trying to get the url of a file that is on my drive, knowing its name and the name of the parent folder. But the result is always null.</p>\n<p>I'm using a service account with owner permission, I already put the correct credentials inside the project and shared the folder and file with the service account email and still the problem continues. When debugging the code it is possible to see that the size of <code>List&lt;File&gt; folders = result.getFiles(); </code> is 0.</p>\n<p>Here is the complete code:</p>\n<pre><code>import android.content.Context;\n\nimport com.google.api.client.googleapis.javanet.GoogleNetHttpTransport;\nimport com.google.api.client.http.HttpRequestInitializer;\nimport com.google.api.client.http.HttpTransport;\nimport com.google.api.client.json.JsonFactory;\nimport com.google.api.client.json.gson.GsonFactory;\nimport com.google.api.services.drive.Drive;\nimport com.google.api.services.drive.DriveScopes;\nimport com.google.api.services.drive.model.File;\nimport com.google.api.services.drive.model.FileList;\nimport com.google.auth.http.HttpCredentialsAdapter;\nimport com.google.auth.oauth2.GoogleCredentials;\n\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.security.GeneralSecurityException;\nimport java.util.Collections;\nimport java.util.List;\n\npublic class DriveAccessRunnable implements Runnable {\n\n   private static final String APPLICATION_NAME = &quot;School Grade&quot;;\n\n   private static final JsonFactory JSON_FACTORY = GsonFactory.getDefaultInstance();\n\n   private static Drive driveService;\n   private final Context context;\n   private final String parentFolderTitle;\n   private final String fileName;\n   private final DriveAccessCallback callback;\n\n   public DriveAccessRunnable(Context context, String parentFolderTitle, String fileName, DriveAccessCallback callback) {\n      this.context = context;\n      this.parentFolderTitle = parentFolderTitle;\n      this.fileName = fileName;\n      this.callback = callback;\n   }\n\n   @Override\n   public void run() {\n      try {\n         // Google Drive access code\n         HttpTransport httpTransport = GoogleNetHttpTransport.newTrustedTransport();\n         driveService = new Drive.Builder(httpTransport, JSON_FACTORY, getHttpRequestInitializer())\n                 .setApplicationName(APPLICATION_NAME)\n                 .build();\n\n         // Get the URL of the file or null if not found\n         String fileUrl = getFileUrl(parentFolderTitle, fileName);\n\n        \n         // Call the callback with the result\n         callback.onFileUrlReceived(fileUrl);\n      } catch (IOException | GeneralSecurityException e) {\n         e.printStackTrace();\n         // Call the callback with an error result\n         callback.onError(e.getMessage());\n      }\n\n   }\n\n   private HttpRequestInitializer getHttpRequestInitializer() throws IOException {\n      InputStream credentialsStream = context.getResources().openRawResource(R.raw.credentials);\n\n      GoogleCredentials credentials = GoogleCredentials.fromStream(credentialsStream)\n              .createScoped(Collections.singletonList(DriveScopes.DRIVE_FILE));\n\n      return new HttpCredentialsAdapter(credentials);\n   }\n\n   private String getFileUrl(String parentFolderTitle, String fileName) throws IOException {\n     \n       // Search parent folder by title\n      FileList result = driveService.files().list()\n              .setQ(&quot;mimeType='application/vnd.google-apps.folder' and trashed=false and name='&quot; + parentFolderTitle + &quot;'&quot;)\n              .setSpaces(&quot;drive&quot;)\n              .setFields(&quot;files(id)&quot;)\n              .execute();\n\n      List&lt;File&gt; folders = result.getFiles();\n\n      if (!folders.isEmpty()) {\n         String parentFolderId = folders.get(0).getId();\n\n         \n         // Browse files inside the parent folder\n         result = driveService.files().list()\n                 .setQ(&quot;'&quot; + parentFolderId + &quot;' in parents and trashed=false&quot;)\n                 .setFields(&quot;files(name, webViewLink)&quot;)\n                 .execute();\n\n         List&lt;File&gt; files = result.getFiles();\n         for (File file : files) {\n            if (file.getName().equals(fileName)) {\n               return file.getWebViewLink();\n            }\n         }\n      }\n\n      return null;\n   }\n\n\n   public interface DriveAccessCallback {\n      void onFileUrlReceived(String fileUrl);\n      void onError(String errorMessage);\n   }\n}\n</code></pre>\n"},{"tags":["java","list","java-8"],"comments":[{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":3,"creation_date":1689855108,"post_id":76729712,"comment_id":135274029,"body_markdown":"Please provice a [mcve]. I guess, listB is immutable","body":"Please provice a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. I guess, listB is immutable"},{"owner":{"account_id":5404,"reputation":22089,"user_id":8681,"accept_rate":67,"display_name":"Jorn"},"score":0,"creation_date":1689855134,"post_id":76729712,"comment_id":135274034,"body_markdown":"Guava has `Comparators.explicit` which might be useful here","body":"Guava has <code>Comparators.explicit</code> which might be useful here"},{"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"score":1,"creation_date":1689881332,"post_id":76729712,"comment_id":135279984,"body_markdown":"`But was getting UnsupportedOperationException as ListB doesn&#39;t have all elements of listA.`  Why should `listB` contain any elements of A?  `ListB` is supposed to contain indexes into ListA?  The only exception I would expect would be an `IndexOutofBoundsException` since 8 would be be an illegal index into A.","body":"<code>But was getting UnsupportedOperationException as ListB doesn&#39;t have all elements of listA.</code>  Why should <code>listB</code> contain any elements of A?  <code>ListB</code> is supposed to contain indexes into ListA?  The only exception I would expect would be an <code>IndexOutofBoundsException</code> since 8 would be be an illegal index into A."},{"owner":{"account_id":1691630,"reputation":49583,"user_id":1553851,"accept_rate":73,"display_name":"shmosel"},"score":0,"creation_date":1689965903,"post_id":76729712,"comment_id":135292477,"body_markdown":"There&#39;s no streaming in your code. Also note `element -&gt; listA.indexOf(element)` can be reduced to `listA::indexOf`.","body":"There&#39;s no streaming in your code. Also note <code>element -&gt; listA.indexOf(element)</code> can be reduced to <code>listA::indexOf</code>."}],"answers":[{"tags":[],"owner":{"account_id":5404,"reputation":22089,"user_id":8681,"accept_rate":67,"display_name":"Jorn"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689855255,"creation_date":1689855255,"answer_id":76729745,"question_id":76729712,"body_markdown":"`List.indexOf` doesn&#39;t throw `UnsupportedOperationException` if the element isn&#39;t there, it returns `-1`. So all you need to do is make sure that an index of -1 will result in &quot;somewhere at the end&quot;, meaning a high number (such as the list size or `Integer.MAX_VALUE`.\r\n\r\nIf you are getting an `UnsupportedOperationException`, it&#39;s most likely because `listB` isn&#39;t mutable, so it won&#39;t support sorting in-place.","title":"Sort list elements by another list","body":"<p><code>List.indexOf</code> doesn't throw <code>UnsupportedOperationException</code> if the element isn't there, it returns <code>-1</code>. So all you need to do is make sure that an index of -1 will result in &quot;somewhere at the end&quot;, meaning a high number (such as the list size or <code>Integer.MAX_VALUE</code>.</p>\n<p>If you are getting an <code>UnsupportedOperationException</code>, it's most likely because <code>listB</code> isn't mutable, so it won't support sorting in-place.</p>\n"},{"tags":[],"owner":{"account_id":13170666,"reputation":78669,"user_id":9513184,"display_name":"Unmitigated"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1689855762,"creation_date":1689855762,"answer_id":76729825,"question_id":76729712,"body_markdown":"To improve performance, the indexes of all the elements in `listB` can be stored in a `Map` first. Then, to order elements that are not in `listB` to the end of the result, they can all be given `Integer.MAX_VALUE` as the sort key.\r\n\r\n```java\r\nvar listA = Arrays.asList(1,2,4,5,6,7,8,9);\r\nvar listB = List.of(6,3,8,2);\r\nvar index = IntStream.range(0, listB.size()).boxed()\r\n                     .collect(Collectors.toMap(listB::get, i -&gt; i));\r\nlistA.sort(Comparator.comparingInt(x -&gt; index.getOrDefault(x, Integer.MAX_VALUE)));\r\n// listA = [6, 8, 2, 1, 4, 5, 7, 9]\r\n```","title":"Sort list elements by another list","body":"<p>To improve performance, the indexes of all the elements in <code>listB</code> can be stored in a <code>Map</code> first. Then, to order elements that are not in <code>listB</code> to the end of the result, they can all be given <code>Integer.MAX_VALUE</code> as the sort key.</p>\n<pre class=\"lang-java prettyprint-override\"><code>var listA = Arrays.asList(1,2,4,5,6,7,8,9);\nvar listB = List.of(6,3,8,2);\nvar index = IntStream.range(0, listB.size()).boxed()\n                     .collect(Collectors.toMap(listB::get, i -&gt; i));\nlistA.sort(Comparator.comparingInt(x -&gt; index.getOrDefault(x, Integer.MAX_VALUE)));\n// listA = [6, 8, 2, 1, 4, 5, 7, 9]\n</code></pre>\n"}],"owner":{"account_id":26661181,"reputation":9,"user_id":20273989,"display_name":"sreenu yalam"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":72,"favorite_count":0,"down_vote_count":3,"up_vote_count":1,"accepted_answer_id":76729825,"answer_count":2,"score":-2,"last_activity_date":1689965802,"creation_date":1689855047,"question_id":76729712,"body_markdown":"I have two lists `A[1,2,4,5,6,7,8,9]` and `B[6,3,8,2]`. I need to sort the `A` list by `B` list indexes. So that the `A` list will be `[6,8,2,1,4,5,7,9]`. Is there any efficient way to do that?\r\n\r\nTried using java8 streaming and comparators \r\n```java\r\nlistB.sort(Comparator.comparingInt(element -&gt; listA.indexOf(element)));\r\n```\r\nBut was getting UnsupportedOperationException as listB doesn&#39;t have all elements of listA.","title":"Sort list elements by another list","body":"<p>I have two lists <code>A[1,2,4,5,6,7,8,9]</code> and <code>B[6,3,8,2]</code>. I need to sort the <code>A</code> list by <code>B</code> list indexes. So that the <code>A</code> list will be <code>[6,8,2,1,4,5,7,9]</code>. Is there any efficient way to do that?</p>\n<p>Tried using java8 streaming and comparators</p>\n<pre class=\"lang-java prettyprint-override\"><code>listB.sort(Comparator.comparingInt(element -&gt; listA.indexOf(element)));\n</code></pre>\n<p>But was getting UnsupportedOperationException as listB doesn't have all elements of listA.</p>\n"},{"tags":["java","spring","spring-annotations"],"comments":[{"owner":{"account_id":3192259,"reputation":117599,"user_id":2696260,"display_name":"M. Deinum"},"score":2,"creation_date":1421840290,"post_id":28065994,"comment_id":44512359,"body_markdown":"Annotate the preferred one with `@Primary`. No need to use a `@Qualifier` that way.","body":"Annotate the preferred one with <code>@Primary</code>. No need to use a <code>@Qualifier</code> that way."},{"owner":{"account_id":4130036,"reputation":3449,"user_id":3388227,"accept_rate":71,"display_name":"Nazaret K."},"score":0,"creation_date":1421842737,"post_id":28065994,"comment_id":44513799,"body_markdown":"Thanks for the comment. Yes, that is actually one way I have found to overcome the problem, but I am just wondering how come there is no equivalent of autowire-candidate in annotations.","body":"Thanks for the comment. Yes, that is actually one way I have found to overcome the problem, but I am just wondering how come there is no equivalent of autowire-candidate in annotations."},{"owner":{"account_id":9181659,"reputation":1746,"user_id":6825250,"display_name":"Sergey Bespalov"},"score":3,"creation_date":1476241820,"post_id":28065994,"comment_id":67258333,"body_markdown":"Looks like Spring refused `autowire-candidate=false` concept and it no longer supported. There is no analogue with annotations, so `@Primary` is only way as you noticed.","body":"Looks like Spring refused <code>autowire-candidate=false</code> concept and it no longer supported. There is no analogue with annotations, so <code>@Primary</code> is only way as you noticed."},{"owner":{"account_id":6751261,"reputation":907,"user_id":5201186,"accept_rate":50,"display_name":"Николай Митропольский"},"score":0,"creation_date":1476255030,"post_id":28065994,"comment_id":67262348,"body_markdown":"Sergey Bespalov, probably you should write it as answer, because seemed that it is the only truth.","body":"Sergey Bespalov, probably you should write it as answer, because seemed that it is the only truth."},{"owner":{"account_id":9181659,"reputation":1746,"user_id":6825250,"display_name":"Sergey Bespalov"},"score":0,"creation_date":1476324787,"post_id":28065994,"comment_id":67300339,"body_markdown":"@НиколайМитропольский, done with some additional suggestion.","body":"@НиколайМитропольский, done with some additional suggestion."}],"answers":[{"tags":[],"owner":{"account_id":9181659,"reputation":1746,"user_id":6825250,"display_name":"Sergey Bespalov"},"down_vote_count":2,"up_vote_count":11,"is_accepted":false,"score":9,"last_activity_date":1476324744,"creation_date":1476323983,"answer_id":40011075,"question_id":28065994,"body_markdown":"Looks like Spring refused `autowire-candidate=false` concept and it no longer supported. There is no analogue with annotations, so `@Primary` is the best work-around as you noticed.\r\n\r\nAnother way is to use custom `org.springframework.beans.factory.support.AutowireCandidateResolver`, which is used in `DefaultListableBeanFactory`, with logic that exclude undesirable beans from autowire candidates. In such case, the  technology will be similar to that used for `autowire-candidate=false` in `SimpleAutowireCandidateResolver`.","title":"How to declare a Spring bean autowire-candidate=&quot;false&quot; when using annotations?","body":"<p>Looks like Spring refused <code>autowire-candidate=false</code> concept and it no longer supported. There is no analogue with annotations, so <code>@Primary</code> is the best work-around as you noticed.</p>\n\n<p>Another way is to use custom <code>org.springframework.beans.factory.support.AutowireCandidateResolver</code>, which is used in <code>DefaultListableBeanFactory</code>, with logic that exclude undesirable beans from autowire candidates. In such case, the  technology will be similar to that used for <code>autowire-candidate=false</code> in <code>SimpleAutowireCandidateResolver</code>.</p>\n"},{"tags":[],"owner":{"account_id":1591496,"reputation":1127,"user_id":1474729,"display_name":"Ghurdyl"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1543940814,"creation_date":1515576830,"answer_id":48184250,"question_id":28065994,"body_markdown":"You can also use the bean accessor to tune it&#39;s visibiltiy.\r\n\r\nsee [Bean visibility][1]\r\n\r\n    @Configuration\r\n    public abstract class VisibilityConfiguration {\r\n\r\n        @Bean\r\n        public Bean publicBean() {\r\n            Bean bean = new Bean();\r\n            bean.setDependency(hiddenBean());\r\n            return bean;\r\n        }\r\n\r\n        @Bean\r\n        protected Bean hiddenBean() {\r\n            return new Bean(&quot;protected bean&quot;);\r\n        }\r\n    }\r\n\r\nYou can then `@Autowire` the `Bean` class and it will autowire the **`public`** bean (without complaining about multiple matching beans)\r\n\r\nAs a class&#39; definition (unless embedded) does not allow **`private`** / **`protected`** accessor the work around would be to use an `@Configuration` class that would instantiate all the beans an publish the public beans while hiding the private/protected (instead of directly annotating the classes `@Component` \\ `@Service`)\r\n\r\nAlso package-protected accessor may worth a try to hide `@Component` annotated classes. I don&#39;t know if that may work.\r\n\r\n  [1]: https://docs.spring.io/spring-javaconfig/docs/1.0.0.m3/reference/html/creating-bean-definitions.html#bean-visibility","title":"How to declare a Spring bean autowire-candidate=&quot;false&quot; when using annotations?","body":"<p>You can also use the bean accessor to tune it's visibiltiy.</p>\n\n<p>see <a href=\"https://docs.spring.io/spring-javaconfig/docs/1.0.0.m3/reference/html/creating-bean-definitions.html#bean-visibility\" rel=\"nofollow noreferrer\">Bean visibility</a></p>\n\n<pre><code>@Configuration\npublic abstract class VisibilityConfiguration {\n\n    @Bean\n    public Bean publicBean() {\n        Bean bean = new Bean();\n        bean.setDependency(hiddenBean());\n        return bean;\n    }\n\n    @Bean\n    protected Bean hiddenBean() {\n        return new Bean(\"protected bean\");\n    }\n}\n</code></pre>\n\n<p>You can then <code>@Autowire</code> the <code>Bean</code> class and it will autowire the <strong><code>public</code></strong> bean (without complaining about multiple matching beans)</p>\n\n<p>As a class' definition (unless embedded) does not allow <strong><code>private</code></strong> / <strong><code>protected</code></strong> accessor the work around would be to use an <code>@Configuration</code> class that would instantiate all the beans an publish the public beans while hiding the private/protected (instead of directly annotating the classes <code>@Component</code> \\ <code>@Service</code>)</p>\n\n<p>Also package-protected accessor may worth a try to hide <code>@Component</code> annotated classes. I don't know if that may work.</p>\n"},{"tags":[],"owner":{"account_id":136251,"reputation":87506,"user_id":339637,"accept_rate":55,"display_name":"Ken Chan"},"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1571426880,"creation_date":1571424568,"answer_id":58456618,"question_id":28065994,"body_markdown":"Since Spring 5.1 , you can configure `autowire-candidate` in `@Bean` through  `autowireCandidate` attribute: \r\n\r\n``` java\r\n@Bean(autowireCandidate = false)\r\npublic FooBean foo() {\r\n      return newFooBean();\r\n}\r\n```","title":"How to declare a Spring bean autowire-candidate=&quot;false&quot; when using annotations?","body":"<p>Since Spring 5.1 , you can configure <code>autowire-candidate</code> in <code>@Bean</code> through  <code>autowireCandidate</code> attribute: </p>\n\n<pre class=\"lang-java prettyprint-override\"><code>@Bean(autowireCandidate = false)\npublic FooBean foo() {\n      return newFooBean();\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":22085194,"reputation":466,"user_id":16344146,"display_name":"A D"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1633450094,"creation_date":1633450094,"answer_id":69453886,"question_id":28065994,"body_markdown":"We can do this by using the ```@Qualifier``` annotations with name mentioned in the ```@Component``` annotations\r\nBean classes - \r\n```\r\n@Component(&quot;fooFormatter&quot;)\r\npublic class FooFormatter implements Formatter {\r\n    public String format() {\r\n        return &quot;foo&quot;;\r\n    }\r\n}\r\n@Component(&quot;barFormatter&quot;)\r\npublic class BarFormatter implements Formatter {\r\n    public String format() {\r\n        return &quot;bar&quot;;\r\n    }\r\n}\r\n```\r\nInjecting bean in service class - \r\n```\r\npublic class FooService {\r\n    @Autowired\r\n    @Qualifier(&quot;fooFormatter&quot;)\r\n    private Formatter formatter;\r\n}\r\n```\r\nFor more details please refer - https://www.baeldung.com/spring-autowire#disambiguation. Above example taken from this link.","title":"How to declare a Spring bean autowire-candidate=&quot;false&quot; when using annotations?","body":"<p>We can do this by using the <code>@Qualifier</code> annotations with name mentioned in the <code>@Component</code> annotations\nBean classes -</p>\n<pre><code>@Component(&quot;fooFormatter&quot;)\npublic class FooFormatter implements Formatter {\n    public String format() {\n        return &quot;foo&quot;;\n    }\n}\n@Component(&quot;barFormatter&quot;)\npublic class BarFormatter implements Formatter {\n    public String format() {\n        return &quot;bar&quot;;\n    }\n}\n</code></pre>\n<p>Injecting bean in service class -</p>\n<pre><code>public class FooService {\n    @Autowired\n    @Qualifier(&quot;fooFormatter&quot;)\n    private Formatter formatter;\n}\n</code></pre>\n<p>For more details please refer - <a href=\"https://www.baeldung.com/spring-autowire#disambiguation\" rel=\"nofollow noreferrer\">https://www.baeldung.com/spring-autowire#disambiguation</a>. Above example taken from this link.</p>\n"},{"tags":[],"owner":{"account_id":1448634,"reputation":540,"user_id":1366298,"display_name":"cfillol"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689965690,"creation_date":1689965690,"answer_id":76740547,"question_id":28065994,"body_markdown":"Use Object type to create the Bean you want to hide\r\n\r\n    @Configuration\r\n    public class MyConfiguration {\r\n\r\n        @Bean\r\n        public MyInterface publicBean() {\r\n            return new MyInterfaceImpl1();\r\n        }\r\n\r\n        @Bean\r\n        protected Object hiddenBean() {\r\n           return new MyInterfaceImpl2();\r\n        }\r\n    }\r\n\r\nThen you can use a simple @Autowired to inject publicBean \r\n\r\n    @Component\r\n    public class MyService {\r\n\r\n        @Autowired\r\n        MyInterface publicBean;\r\n\r\n    }\r\n\r\nAnd even if you wanted to inject also hiddenBean in other place, then you could using @Qualifier\r\n\r\n    @Component\r\n    public class OtherComponent {\r\n\r\n        @Autowired\r\n        @Qualifier(&quot;hiddenBean&quot;)\r\n        MyInterface hiddenBean;\r\n\r\n    }","title":"How to declare a Spring bean autowire-candidate=&quot;false&quot; when using annotations?","body":"<p>Use Object type to create the Bean you want to hide</p>\n<pre><code>@Configuration\npublic class MyConfiguration {\n\n    @Bean\n    public MyInterface publicBean() {\n        return new MyInterfaceImpl1();\n    }\n\n    @Bean\n    protected Object hiddenBean() {\n       return new MyInterfaceImpl2();\n    }\n}\n</code></pre>\n<p>Then you can use a simple @Autowired to inject publicBean</p>\n<pre><code>@Component\npublic class MyService {\n\n    @Autowired\n    MyInterface publicBean;\n\n}\n</code></pre>\n<p>And even if you wanted to inject also hiddenBean in other place, then you could using @Qualifier</p>\n<pre><code>@Component\npublic class OtherComponent {\n\n    @Autowired\n    @Qualifier(&quot;hiddenBean&quot;)\n    MyInterface hiddenBean;\n\n}\n</code></pre>\n"}],"owner":{"account_id":4130036,"reputation":3449,"user_id":3388227,"accept_rate":71,"display_name":"Nazaret K."},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":12123,"favorite_count":0,"down_vote_count":0,"up_vote_count":12,"answer_count":5,"score":12,"last_activity_date":1689965690,"creation_date":1421839312,"question_id":28065994,"body_markdown":"I am using `@ComponentScan` and `@Component` to define my spring beans. What I would like is to declare one of these beans to be `autowire-candidate=false`. \r\n\r\nThis could be done with this attribute in xml. Isn&#39;t there the equivalent in annotations? \r\n\r\nThe reason I want this is because I have 2 implementations of the same interface and I don&#39;t want to use `@Qualifier`.\r\n\r\nEDIT: Using @Primary is a valid work-around, but autowire-candidate seems to me like a useful feature with its own semantics.\r\n\r\nThanks","title":"How to declare a Spring bean autowire-candidate=&quot;false&quot; when using annotations?","body":"<p>I am using <code>@ComponentScan</code> and <code>@Component</code> to define my spring beans. What I would like is to declare one of these beans to be <code>autowire-candidate=false</code>. </p>\n\n<p>This could be done with this attribute in xml. Isn't there the equivalent in annotations? </p>\n\n<p>The reason I want this is because I have 2 implementations of the same interface and I don't want to use <code>@Qualifier</code>.</p>\n\n<p>EDIT: Using @Primary is a valid work-around, but autowire-candidate seems to me like a useful feature with its own semantics.</p>\n\n<p>Thanks</p>\n"},{"tags":["java","unit-testing","junit","mockachino"],"answers":[{"tags":[],"owner":{"account_id":261539,"reputation":19938,"user_id":981715,"accept_rate":74,"display_name":"Eugen Martynov"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1384260516,"creation_date":1384260516,"answer_id":19929642,"question_id":19925467,"body_markdown":"My preferred mocking framework is **Mockito**. But you can try this with **Mockachino**:\r\n\r\n    @Test\r\n    public void providedNameAndEmptyValueCookieSetToResponse() {\r\n       String name = &quot;name&quot;;\r\n       HttpServletResponse responseMock = mock(HttpServletResponse.class, RETURNS_DEEP_STUBS);\r\n\r\n       removeCookie(responseMock, name);\r\n\r\n       Cookie cookie = catchCookie(mock);\r\n       assertEquals(name, cookie.getName());\r\n       assertEquals(&quot;&quot;, cookie.getValue());\r\n    }\r\n\r\n    private Cookie catchCookie() {\r\n       ArgumentCatcher&lt;Cookie&gt; catcher = ArgumentCatcher.create(new AnyMatcher(Cookie.class));\r\n       verifyOnce().on(responseMock).addCookie(match(catcher));\r\n\r\n      return catcher.getValue();\r\n    }\r\n\r\n    @Test\r\n    public void zeroMaxAgeCookieSetToResponse() {\r\n       HttpServletResponse responseMock = mock(HttpServletResponse.class, RETURNS_DEEP_STUBS);\r\n\r\n       removeCookie(responseMock, &quot;any&quot;);\r\n\r\n       Cookie cookie = catchCookie(mock);\r\n       assertEquals(Integer.valueOf(0), cookie.getMaxAge());\r\n    }","title":"Testing HttpServletResponse addCookie","body":"<p>My preferred mocking framework is <strong>Mockito</strong>. But you can try this with <strong>Mockachino</strong>:</p>\n\n<pre><code>@Test\npublic void providedNameAndEmptyValueCookieSetToResponse() {\n   String name = \"name\";\n   HttpServletResponse responseMock = mock(HttpServletResponse.class, RETURNS_DEEP_STUBS);\n\n   removeCookie(responseMock, name);\n\n   Cookie cookie = catchCookie(mock);\n   assertEquals(name, cookie.getName());\n   assertEquals(\"\", cookie.getValue());\n}\n\nprivate Cookie catchCookie() {\n   ArgumentCatcher&lt;Cookie&gt; catcher = ArgumentCatcher.create(new AnyMatcher(Cookie.class));\n   verifyOnce().on(responseMock).addCookie(match(catcher));\n\n  return catcher.getValue();\n}\n\n@Test\npublic void zeroMaxAgeCookieSetToResponse() {\n   HttpServletResponse responseMock = mock(HttpServletResponse.class, RETURNS_DEEP_STUBS);\n\n   removeCookie(responseMock, \"any\");\n\n   Cookie cookie = catchCookie(mock);\n   assertEquals(Integer.valueOf(0), cookie.getMaxAge());\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":329602,"reputation":3748,"user_id":653211,"accept_rate":100,"display_name":"Ashwin Krishnamurthy"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1490294652,"creation_date":1490294652,"answer_id":42984468,"question_id":19925467,"body_markdown":"A late answer for posterity&#39;s sake. Here is a snippet I used to test the `addCookie` functionality using EasyMock and the awesomeness that is [Capture][1]:\r\n    \r\n    Capture&lt;Cookie&gt; getCookie = new Capture&lt;Cookie&gt;();\r\n    \r\n    //mocking\r\n    HttpServletRequest request = new MockHttpServletRequest();\r\n    Model model = new ExtendedModelMap();\r\n    HttpServletResponse response = createNiceMock(HttpServletResponse.class);\r\n    MyController controller = createMock(MyController.class);\r\n    \t\t\r\n    \r\n    // expectation\r\n    response.addCookie( capture(getCookie) ); //Capture would look for a Cookie object being sent to the addCookie method and grab that for you\r\n    \r\n    // invocation\r\n    replay(controller, response);\r\n    String result = controller.someAction(request, response, model);\r\n    verify(controller, response);\r\n    \r\n    // assertions\r\n    Cookie cookie = getCookie.getValue();\r\n    assertEquals(&quot;myCookie&quot;, cookie.getName());\r\n\r\n\r\nGood luck.\r\n    \t\t\r\n\r\n  [1]: http://easymock.org/api/org/easymock/Capture.html","title":"Testing HttpServletResponse addCookie","body":"<p>A late answer for posterity's sake. Here is a snippet I used to test the <code>addCookie</code> functionality using EasyMock and the awesomeness that is <a href=\"http://easymock.org/api/org/easymock/Capture.html\" rel=\"nofollow noreferrer\">Capture</a>:</p>\n\n<pre><code>Capture&lt;Cookie&gt; getCookie = new Capture&lt;Cookie&gt;();\n\n//mocking\nHttpServletRequest request = new MockHttpServletRequest();\nModel model = new ExtendedModelMap();\nHttpServletResponse response = createNiceMock(HttpServletResponse.class);\nMyController controller = createMock(MyController.class);\n\n\n// expectation\nresponse.addCookie( capture(getCookie) ); //Capture would look for a Cookie object being sent to the addCookie method and grab that for you\n\n// invocation\nreplay(controller, response);\nString result = controller.someAction(request, response, model);\nverify(controller, response);\n\n// assertions\nCookie cookie = getCookie.getValue();\nassertEquals(\"myCookie\", cookie.getName());\n</code></pre>\n\n<p>Good luck.</p>\n"},{"tags":[],"owner":{"account_id":21960464,"reputation":294,"user_id":16238436,"display_name":"Todd"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689965671,"creation_date":1689965671,"answer_id":76740545,"question_id":19925467,"body_markdown":"Wow. Ancient topic I&#39;ve landed on here. For what it&#39;s worth I&#39;ve found the MockHttpServletRequest and MockHttpServletResponse classes from Spring to be VERY helpful for this sort of stuff.  They can be used even if your project is NOT a Spring project.  Only one dependency is needed:\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.springframework&lt;/groupId&gt;\r\n        &lt;artifactId&gt;spring-test&lt;/artifactId&gt;\r\n        &lt;version&gt;5.3.20&lt;/version&gt;\r\n        &lt;scope&gt;test&lt;/scope&gt;\r\n    &lt;/dependency&gt;\r\n\r\nThen I do stuff like this:\r\n\r\n\t\tMockHttpServletRequest request = new MockHttpServletRequest();\r\n\t\tMockHttpServletResponse response = new MockHttpServletResponse();\r\n\r\n\t\tmethodThatTakesRequestOrResponse(request, response);\r\n\r\n\t\t// Validate state (cookies, attributes, etc.)\r\n\t\tString attribute = (String)request.getAttribute(&quot;expected attribute name&quot;);\r\n\t\tassertNotNull(attribute);\r\n\t\tString cookie = response.getCookie(&quot;expected cookie name&quot;).getValue();\r\n\t\tassertNotNull(cookie);\r\n","title":"Testing HttpServletResponse addCookie","body":"<p>Wow. Ancient topic I've landed on here. For what it's worth I've found the MockHttpServletRequest and MockHttpServletResponse classes from Spring to be VERY helpful for this sort of stuff.  They can be used even if your project is NOT a Spring project.  Only one dependency is needed:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-test&lt;/artifactId&gt;\n    &lt;version&gt;5.3.20&lt;/version&gt;\n    &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Then I do stuff like this:</p>\n<pre><code>    MockHttpServletRequest request = new MockHttpServletRequest();\n    MockHttpServletResponse response = new MockHttpServletResponse();\n\n    methodThatTakesRequestOrResponse(request, response);\n\n    // Validate state (cookies, attributes, etc.)\n    String attribute = (String)request.getAttribute(&quot;expected attribute name&quot;);\n    assertNotNull(attribute);\n    String cookie = response.getCookie(&quot;expected cookie name&quot;).getValue();\n    assertNotNull(cookie);\n</code></pre>\n"}],"owner":{"account_id":76211,"reputation":1536,"user_id":218372,"accept_rate":80,"display_name":"heffaklump"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3107,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":3,"score":0,"last_activity_date":1689965671,"creation_date":1384248689,"question_id":19925467,"body_markdown":"I have this method I want to test with JUnit and Mockachino.\r\n\r\n    public void removeCookie(HttpServletResponse response, String name) {\r\n        Cookie cookie = new Cookie(name, &quot;&quot;);\r\n        cookie.setMaxAge(0);\r\n        response.addCookie(cookie);\r\n    }\r\n\r\nBut how?","title":"Testing HttpServletResponse addCookie","body":"<p>I have this method I want to test with JUnit and Mockachino.</p>\n\n<pre><code>public void removeCookie(HttpServletResponse response, String name) {\n    Cookie cookie = new Cookie(name, \"\");\n    cookie.setMaxAge(0);\n    response.addCookie(cookie);\n}\n</code></pre>\n\n<p>But how?</p>\n"},{"tags":["java","spring-boot","jpa","pageable"],"comments":[{"owner":{"account_id":23128,"reputation":13127,"user_id":57719,"display_name":"Chin Huang"},"score":1,"creation_date":1689965089,"post_id":76740469,"comment_id":135292366,"body_markdown":"Your `countQuery` does not have a WHERE clause so it counts every row in the table. In newer Spring Data JPA versions, you [don&#39;t need to specify a countQuery for a native query](https://stackoverflow.com/questions/38349930/spring-data-and-native-query-with-pagination).","body":"Your <code>countQuery</code> does not have a WHERE clause so it counts every row in the table. In newer Spring Data JPA versions, you <a href=\"https://stackoverflow.com/questions/38349930/spring-data-and-native-query-with-pagination\">don&#39;t need to specify a countQuery for a native query</a>."},{"owner":{"account_id":28881418,"reputation":21,"user_id":22120821,"display_name":"GyeongEun Kim"},"score":0,"creation_date":1690017893,"post_id":76740469,"comment_id":135296489,"body_markdown":"thank you so much. by deleting countQuery, It works well","body":"thank you so much. by deleting countQuery, It works well"}],"owner":{"account_id":28881418,"reputation":21,"user_id":22120821,"display_name":"GyeongEun Kim"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":185,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1689965656,"creation_date":1689964774,"question_id":76740469,"body_markdown":"hi Iam using spring boot, JPA\r\n\r\nI used Pageable objects to do Pagination\r\n\r\nand when I get each Page, I got totalElements by using `getTotalElements()`\r\n\r\nI expected to get the number of searching result, but I got the total number of table&#39;s record.\r\n\r\nfor example, if i have 14 records in my db table and the number of searching result  is `6` ,\r\n\r\n- request page =0 size =20\r\n\r\ngetTotalElements() method returns 6 and getNumberOfElements() method returns 6 so it has no problem in this case\r\n\r\n- request page =1 size =20\r\n\r\n  getTotalElements() method **returns 14** and getNumberOfElements() method returns 0 so it has **problem in this case**\r\n\r\n- request page =0 size =4\r\n\r\n  getTotalElements() method **returns 14** and getNumberOfElements() method returns 4 so it has **problem in this case**\r\n\r\n- request page =1 size =4\r\n\r\n  getTotalElements() method returns 6 and getNumberOfElements() method returns 2 so it has no problem in this case\r\n\r\nI don&#39;t know why it happens...\r\n\r\ndata from query is correct but i have no idea why getTotalElements returns the total elements of db records. (and even it&#39;s not all the time..)\r\n\r\n## service layer\r\n\r\n```\r\n Optional&lt;Page&lt;Club&gt;&gt; clubList = searchRepository.findByConditionsOrderByDate(pointWKT, distance * 1000, state, category, memberNum, regexpTag, pageable);\r\n\r\n//and I call getTotalElements() here\r\n```\r\n\r\n## repository\r\n\r\n```\r\n @Query(nativeQuery = true, value = searchDefaultQuery+ WhereOptionQuery +\r\n            &quot;ORDER BY created_date DESC&quot;,\r\n            countQuery = &quot;SELECT COUNT(club_id) FROM club&quot;)\r\n    Optional&lt;Page&lt;Club&gt;&gt; findByConditionsOrderByDate (@Param(&quot;standard_point&quot;) String point, @Param(&quot;distance&quot;)Integer distance,\r\n                                                      @Param(&quot;state&quot;)String state, @Param(&quot;category&quot;)String category, @Param(&quot;memberNum&quot;)Integer memberNum,\r\n                                                      @Param(&quot;tags&quot;)String tags, Pageable pageable);\r\n```","title":"Page.getTotalElements() returns the number of total data in table not the number of result of query","body":"<p>hi Iam using spring boot, JPA</p>\n<p>I used Pageable objects to do Pagination</p>\n<p>and when I get each Page, I got totalElements by using <code>getTotalElements()</code></p>\n<p>I expected to get the number of searching result, but I got the total number of table's record.</p>\n<p>for example, if i have 14 records in my db table and the number of searching result  is <code>6</code> ,</p>\n<ul>\n<li>request page =0 size =20</li>\n</ul>\n<p>getTotalElements() method returns 6 and getNumberOfElements() method returns 6 so it has no problem in this case</p>\n<ul>\n<li><p>request page =1 size =20</p>\n<p>getTotalElements() method <strong>returns 14</strong> and getNumberOfElements() method returns 0 so it has <strong>problem in this case</strong></p>\n</li>\n<li><p>request page =0 size =4</p>\n<p>getTotalElements() method <strong>returns 14</strong> and getNumberOfElements() method returns 4 so it has <strong>problem in this case</strong></p>\n</li>\n<li><p>request page =1 size =4</p>\n<p>getTotalElements() method returns 6 and getNumberOfElements() method returns 2 so it has no problem in this case</p>\n</li>\n</ul>\n<p>I don't know why it happens...</p>\n<p>data from query is correct but i have no idea why getTotalElements returns the total elements of db records. (and even it's not all the time..)</p>\n<h2>service layer</h2>\n<pre><code> Optional&lt;Page&lt;Club&gt;&gt; clubList = searchRepository.findByConditionsOrderByDate(pointWKT, distance * 1000, state, category, memberNum, regexpTag, pageable);\n\n//and I call getTotalElements() here\n</code></pre>\n<h2>repository</h2>\n<pre><code> @Query(nativeQuery = true, value = searchDefaultQuery+ WhereOptionQuery +\n            &quot;ORDER BY created_date DESC&quot;,\n            countQuery = &quot;SELECT COUNT(club_id) FROM club&quot;)\n    Optional&lt;Page&lt;Club&gt;&gt; findByConditionsOrderByDate (@Param(&quot;standard_point&quot;) String point, @Param(&quot;distance&quot;)Integer distance,\n                                                      @Param(&quot;state&quot;)String state, @Param(&quot;category&quot;)String category, @Param(&quot;memberNum&quot;)Integer memberNum,\n                                                      @Param(&quot;tags&quot;)String tags, Pageable pageable);\n</code></pre>\n"},{"tags":["java","azure","azure-web-app-service"],"comments":[{"owner":{"account_id":3430916,"reputation":3799,"user_id":3059385,"accept_rate":40,"display_name":"Christopher Schneider"},"score":0,"creation_date":1689554524,"post_id":76700896,"comment_id":135225446,"body_markdown":"Time to run a profiler.","body":"Time to run a profiler."},{"owner":{"account_id":6520,"reputation":10523,"user_id":11002,"accept_rate":75,"display_name":"tgdavies"},"score":0,"creation_date":1689563694,"post_id":76700896,"comment_id":135226056,"body_markdown":"Or get a thread dump.","body":"Or get a thread dump."}],"answers":[{"tags":[],"owner":{"account_id":11166237,"reputation":2917,"user_id":8194837,"display_name":"AjayKumar"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689965586,"creation_date":1689965586,"answer_id":76740538,"question_id":76700896,"body_markdown":"Adding to the above suggestions, if you haven’t done this already, kindly leverage `Diagnose and Solve Problems` to fetch more details on `Web App Restarted`\r\n \r\n\r\n\r\nI understand a simple code change is causing the restart and as you mentioned auto-heal is enabled.\r\n\r\nYou have mentioned about, BRANCH-X  and BRANCH-Y on UAT and Prod, if these are slots swaps. \r\n\r\nTo minimize these types of restarts, set the `WEBSITE_ADD_SITENAME_BINDINGS_IN_APPHOST_CONFIG=1` app setting on all slots and see if it makes any difference. \r\n\r\n Just to isolate the issue, you may try to use [proactive CPU monitoring][1] to set your own CPU threshold rules to temporarily mitigate a high CPU issue ( to narrow-down until the real cause for the issue is found)\r\n\r\n\r\nJust to highlight, on the other hand, restarting an application could cause a possible increase in resource consumption, and depending on the application sometimes those extra resources can be high, so be aware that even though restarting a slot should not affect the other slots, resources are still shared, so it can indirectly affect the other slots if the App Service Plan does not have enough resources.\r\n\r\nMost of the configuration changes trigger some sort of restart. \r\n\r\n\r\n[App Service Restarts][2]  - This document covers some common operations that can be performed in an App Service and the effects in terms of availability and restart operations. Restarts on an App Service can be triggered either manually or by configuration changes.\r\n\r\n\r\nRef: [Troubleshoot swaps][3]\r\n\r\n\r\n  [1]: https://azure.github.io/AppService/2019/10/07/Mitigate-your-CPU-problems-before-they-even-happen.html\r\n  [2]: https://azure.github.io/AppService/2021/09/16/App-Service-Restarts.html\r\n  [3]: https://learn.microsoft.com/azure/app-service/deploy-staging-slots?tabs=portal#troubleshoot-swaps","title":"Adding any simple code to the old code causes Azure App restarts","body":"<p>Adding to the above suggestions, if you haven’t done this already, kindly leverage <code>Diagnose and Solve Problems</code> to fetch more details on <code>Web App Restarted</code></p>\n<p>I understand a simple code change is causing the restart and as you mentioned auto-heal is enabled.</p>\n<p>You have mentioned about, BRANCH-X  and BRANCH-Y on UAT and Prod, if these are slots swaps.</p>\n<p>To minimize these types of restarts, set the <code>WEBSITE_ADD_SITENAME_BINDINGS_IN_APPHOST_CONFIG=1</code> app setting on all slots and see if it makes any difference.</p>\n<p>Just to isolate the issue, you may try to use <a href=\"https://azure.github.io/AppService/2019/10/07/Mitigate-your-CPU-problems-before-they-even-happen.html\" rel=\"nofollow noreferrer\">proactive CPU monitoring</a> to set your own CPU threshold rules to temporarily mitigate a high CPU issue ( to narrow-down until the real cause for the issue is found)</p>\n<p>Just to highlight, on the other hand, restarting an application could cause a possible increase in resource consumption, and depending on the application sometimes those extra resources can be high, so be aware that even though restarting a slot should not affect the other slots, resources are still shared, so it can indirectly affect the other slots if the App Service Plan does not have enough resources.</p>\n<p>Most of the configuration changes trigger some sort of restart.</p>\n<p><a href=\"https://azure.github.io/AppService/2021/09/16/App-Service-Restarts.html\" rel=\"nofollow noreferrer\">App Service Restarts</a>  - This document covers some common operations that can be performed in an App Service and the effects in terms of availability and restart operations. Restarts on an App Service can be triggered either manually or by configuration changes.</p>\n<p>Ref: <a href=\"https://learn.microsoft.com/azure/app-service/deploy-staging-slots?tabs=portal#troubleshoot-swaps\" rel=\"nofollow noreferrer\">Troubleshoot swaps</a></p>\n"}],"owner":{"account_id":29030389,"reputation":1,"user_id":22237472,"display_name":"Brijesh Narayana Punjari"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":57,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689965586,"creation_date":1689553248,"question_id":76700896,"body_markdown":"We had a branch, **BRANCH-X** on UAT and Prod for a while now. When I deploy a new branch **BRANCH-Y** on UAT, the CPU utilization hits 100% and restarts the app as Azure Auto-heal is ON, which results in thousands of 503-Service Unavailable errors. Initially I thought my new changes would&#39;ve caused this but when I look at the code, nothing seems to be the problem- functionality was good, all the exceptions are handled and no application exits. \r\n\r\n\r\n\r\nFor debugging if it&#39;s a code issue or something is happening internally, I made a small change to BRANCH-X and deployed on UAT. The change was a small as below-\r\n\r\n\r\nBranch-X : \r\n\r\n```\r\nreturn 5;\r\n```\r\n\r\nNew code on UAT for debugging:\r\n\r\n```\r\nint x = 5;\r\nreturn x;\r\n```\r\n\r\n\r\nNow anyone would think the new code would work just like Branch-X, with no 503s. But that&#39;s not the case, the new code auto restarts, hits CPU 100% and throws 503s. To confirm, I again deployed BRANCH-X - No auto restarts, no 100% CPU and no 503s. I don&#39;t understand why any new code changes are giving me 503s on Azure. I have tried to browse for a good answer, but had no luck. So posting it here. ","title":"Adding any simple code to the old code causes Azure App restarts","body":"<p>We had a branch, <strong>BRANCH-X</strong> on UAT and Prod for a while now. When I deploy a new branch <strong>BRANCH-Y</strong> on UAT, the CPU utilization hits 100% and restarts the app as Azure Auto-heal is ON, which results in thousands of 503-Service Unavailable errors. Initially I thought my new changes would've caused this but when I look at the code, nothing seems to be the problem- functionality was good, all the exceptions are handled and no application exits.</p>\n<p>For debugging if it's a code issue or something is happening internally, I made a small change to BRANCH-X and deployed on UAT. The change was a small as below-</p>\n<p>Branch-X :</p>\n<pre><code>return 5;\n</code></pre>\n<p>New code on UAT for debugging:</p>\n<pre><code>int x = 5;\nreturn x;\n</code></pre>\n<p>Now anyone would think the new code would work just like Branch-X, with no 503s. But that's not the case, the new code auto restarts, hits CPU 100% and throws 503s. To confirm, I again deployed BRANCH-X - No auto restarts, no 100% CPU and no 503s. I don't understand why any new code changes are giving me 503s on Azure. I have tried to browse for a good answer, but had no luck. So posting it here.</p>\n"},{"tags":["java","encryption","telegram"],"comments":[{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1689948069,"post_id":76738572,"comment_id":135289259,"body_markdown":"That&#39;s *not* Java","body":"That&#39;s <i>not</i> Java"},{"owner":{"account_id":213468,"reputation":103489,"user_id":466862,"display_name":"Mark Rotteveel"},"score":2,"creation_date":1689948250,"post_id":76738572,"comment_id":135289295,"body_markdown":"@g00se Why do you think it&#39;s not Java? `HmacUtils` is a class from Apache Commons Codec.","body":"@g00se Why do you think it&#39;s not Java? <code>HmacUtils</code> is a class from Apache Commons Codec."},{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1689948544,"post_id":76738572,"comment_id":135289358,"body_markdown":"Sorry - didn&#39;t look far enough down the page","body":"Sorry - didn&#39;t look far enough down the page"},{"owner":{"account_id":213468,"reputation":103489,"user_id":466862,"display_name":"Mark Rotteveel"},"score":2,"creation_date":1689948547,"post_id":76738572,"comment_id":135289360,"body_markdown":"You probably need to use the raw key bytes, not the hex-encoded form.","body":"You probably need to use the raw key bytes, not the hex-encoded form."},{"owner":{"account_id":13294099,"reputation":49274,"user_id":9597706,"display_name":"Richard Heap"},"score":1,"creation_date":1689948840,"post_id":76738572,"comment_id":135289421,"body_markdown":"change `var secretKey = new HmacUtils(&quot;HmacSHA256&quot;, &quot;WebAppData&quot;).hmacHex(&quot;k&quot;);` to `var secretKey = new HmacUtils(&quot;HmacSHA256&quot;, &quot;WebAppData&quot;).hmac(&quot;k&quot;);`","body":"change <code>var secretKey = new HmacUtils(&quot;HmacSHA256&quot;, &quot;WebAppData&quot;).hmacHex(&quot;k&quot;);</code> to <code>var secretKey = new HmacUtils(&quot;HmacSHA256&quot;, &quot;WebAppData&quot;).hmac(&quot;k&quot;);</code>"}],"answers":[{"tags":[],"owner":{"account_id":213468,"reputation":103489,"user_id":466862,"display_name":"Mark Rotteveel"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1689948873,"creation_date":1689948873,"answer_id":76738773,"question_id":76738572,"body_markdown":"The problem is that you take the hex-encoded form of the secret key as the key of the hash. The `HmacUtils(String, String)` constructor will encode the string to bytes using UTF-8, which is not what you want here, so you need to use the `HmacUtils(String, byte[])` constructor. \r\n\r\nSo, you need to use the raw byte form:\r\n\r\n```java\r\nbyte[] secretKey = new HmacUtils(&quot;HmacSHA256&quot;, &quot;WebAppData&quot;).hmac(&quot;k&quot;);\r\nString hash = new HmacUtils(&quot;HmacSHA256&quot;, secretKey).hmacHex(&quot;data&quot;);\r\n\r\nSystem.out.println(HexFormat.of().formatHex(secretKey));\r\nSystem.out.println(hash);\r\n```\r\n\r\nOutput:\r\n\r\n```none\r\n3db03151d3fb2678c9fc0f24ee15817bfd1ff922a712a055f63066f875e43fc1\r\n9158b0aeb1e882c075ea46a0d5302cffba1a9b66b0df40f5f01eef614f7d9f94\r\n```\r\n\r\nThis matches the hash from the JavaScript code.","title":"Telegram hash validation in Java","body":"<p>The problem is that you take the hex-encoded form of the secret key as the key of the hash. The <code>HmacUtils(String, String)</code> constructor will encode the string to bytes using UTF-8, which is not what you want here, so you need to use the <code>HmacUtils(String, byte[])</code> constructor.</p>\n<p>So, you need to use the raw byte form:</p>\n<pre class=\"lang-java prettyprint-override\"><code>byte[] secretKey = new HmacUtils(&quot;HmacSHA256&quot;, &quot;WebAppData&quot;).hmac(&quot;k&quot;);\nString hash = new HmacUtils(&quot;HmacSHA256&quot;, secretKey).hmacHex(&quot;data&quot;);\n\nSystem.out.println(HexFormat.of().formatHex(secretKey));\nSystem.out.println(hash);\n</code></pre>\n<p>Output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>3db03151d3fb2678c9fc0f24ee15817bfd1ff922a712a055f63066f875e43fc1\n9158b0aeb1e882c075ea46a0d5302cffba1a9b66b0df40f5f01eef614f7d9f94\n</code></pre>\n<p>This matches the hash from the JavaScript code.</p>\n"}],"owner":{"account_id":441129,"reputation":2872,"user_id":831061,"accept_rate":75,"display_name":"luso"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":95,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76738773,"answer_count":1,"score":1,"last_activity_date":1689965572,"creation_date":1689947256,"question_id":76738572,"body_markdown":"For the sake of me, I can&#39;t get to [validate a Telegram hash][1] in Java.\r\n\r\nI have a working JS example compiled from different sources that I&#39;ve reduced to barebones to illustrate this question.    \r\n\r\n&lt;!-- begin snippet: js hide: false console: true babel: false --&gt;\r\n\r\n&lt;!-- language: lang-js --&gt;\r\n\r\n    function main() {\r\n      var k = CryptoJS.HmacSHA256(&#39;k&#39;, &#39;WebAppData&#39;);\r\n      console.log(&quot;k: &quot; + k);\r\n\r\n      var h = CryptoJS.HmacSHA256(&#39;data&#39;, k);\r\n      console.log(&quot;h: &quot; + h);\r\n    }\r\n\r\n    main();\r\n\r\n&lt;!-- language: lang-html --&gt;\r\n\r\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js&quot;&gt;&lt;/script&gt;\r\n\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\nThe response of the complete example matches the expected hash\r\n\r\n    &quot;k: 3db03151d3fb2678c9fc0f24ee15817bfd1ff922a712a055f63066f875e43fc1&quot;\r\n    &quot;h: 9158b0aeb1e882c075ea46a0d5302cffba1a9b66b0df40f5f01eef614f7d9f94&quot;\r\n\r\nTrying to do the same thing using Apache commons&#39; Hmac method\r\n\r\n    var secretKey = new HmacUtils(&quot;HmacSHA256&quot;, &quot;WebAppData&quot;).hmacHex(&quot;k&quot;);\r\n    var hash = new HmacUtils(&quot;HmacSHA256&quot;, secretKey).hmacHex(&quot;data&quot;);\r\n\r\nI end up with the first one being correct but not the second one, that differs from the other implementation.\r\n\r\n    secretKey: 3db03151d3fb2678c9fc0f24ee15817bfd1ff922a712a055f63066f875e43fc1\r\n    hash: 2c73ad3290e04a382b29edea6cb0ef4b1454592429336c32e98ad611452581b2\r\n\r\nwhat am I failing to see?\r\n\r\nIsn&#39;t there a method to handle this validation in the [Telegram SDK][2] I missed to avoid doing this by hand?\r\n\r\n\r\n  [1]: https://core.telegram.org/bots/webapps#validating-data-received-via-the-web-app\r\n  [2]: https://github.com/rubenlagus/TelegramBots","title":"Telegram hash validation in Java","body":"<p>For the sake of me, I can't get to <a href=\"https://core.telegram.org/bots/webapps#validating-data-received-via-the-web-app\" rel=\"nofollow noreferrer\">validate a Telegram hash</a> in Java.</p>\n<p>I have a working JS example compiled from different sources that I've reduced to barebones to illustrate this question.</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function main() {\n  var k = CryptoJS.HmacSHA256('k', 'WebAppData');\n  console.log(\"k: \" + k);\n\n  var h = CryptoJS.HmacSHA256('data', k);\n  console.log(\"h: \" + h);\n}\n\nmain();</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js\"&gt;&lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n<p>The response of the complete example matches the expected hash</p>\n<pre><code>&quot;k: 3db03151d3fb2678c9fc0f24ee15817bfd1ff922a712a055f63066f875e43fc1&quot;\n&quot;h: 9158b0aeb1e882c075ea46a0d5302cffba1a9b66b0df40f5f01eef614f7d9f94&quot;\n</code></pre>\n<p>Trying to do the same thing using Apache commons' Hmac method</p>\n<pre><code>var secretKey = new HmacUtils(&quot;HmacSHA256&quot;, &quot;WebAppData&quot;).hmacHex(&quot;k&quot;);\nvar hash = new HmacUtils(&quot;HmacSHA256&quot;, secretKey).hmacHex(&quot;data&quot;);\n</code></pre>\n<p>I end up with the first one being correct but not the second one, that differs from the other implementation.</p>\n<pre><code>secretKey: 3db03151d3fb2678c9fc0f24ee15817bfd1ff922a712a055f63066f875e43fc1\nhash: 2c73ad3290e04a382b29edea6cb0ef4b1454592429336c32e98ad611452581b2\n</code></pre>\n<p>what am I failing to see?</p>\n<p>Isn't there a method to handle this validation in the <a href=\"https://github.com/rubenlagus/TelegramBots\" rel=\"nofollow noreferrer\">Telegram SDK</a> I missed to avoid doing this by hand?</p>\n"},{"tags":["java","dropwizard"],"answers":[{"tags":[],"owner":{"account_id":7547772,"reputation":8583,"user_id":5730279,"display_name":"hc_dev"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1689964843,"creation_date":1689962655,"answer_id":76740265,"question_id":76739734,"body_markdown":"Technically, it should be possible.\r\n\r\n## How to enable it\r\nYou could use the constructor [`EnvironmentVariableSubstitutor​(boolean strict, boolean substitutionInVariables)`][1] with the second argument as `true` to enable substitution inside variables.\r\n\r\nFor bootsrapping your app with this special `EnvironmentVariableSubstitutor​` instance, see [*WarFox*&#39;s answer](https://stackoverflow.com/a/32231630/5730279) in related question https://stackoverflow.com/questions/23464451/overriding-server-connector-config-with-env-variables-with-dropwizard/32231630#32231630.\r\n\r\nThe `SubstitutingSourceProvider` to use environment variables inside YAML files is explained here: https://stackoverflow.com/questions/53831014/can-i-specify-default-values-for-a-config-yml-on-my-java-application/53832360#53832360.\r\n\r\n## How it works \r\n### Dropwizard Configuration uses Apache Commons Text\r\n\r\nResponsible for environment variable substitution is the class [`EnvironmentVariableSubstitutor`][2].\r\n\r\nIt is implemented by inheritance and uses Apache Commons Text: ` extends StringSubstitutor`.\r\n\r\n### StringSubstitutor allows recursive resolution\r\nFrom [`StringSubstitutor`][3] &#39;s JavaDoc:\r\n&gt; ### Using Recursive Variable Replacement\r\n&gt;\r\n&gt; Variable replacement can work recursively by calling `setEnableSubstitutionInVariables(boolean)` with `true`. If a variable value contains a variable then that variable will also be replaced. Cyclic replacements are detected and will throw an exception.\r\n&gt;\r\n&gt; You can get the replace result to contain a variable prefix. For example:\r\n&gt;\r\n&gt; `&quot;The variable ${${name}} must be used.&quot;`\r\n&gt;\r\n&gt; If the value of the &quot;name&quot; variable is &quot;x&quot;, then only the variable &quot;name&quot; is replaced resulting in:\r\n&gt;\r\n&gt; `&quot;The variable ${x} must be used.&quot;`\r\n\r\n\r\n  [1]: https://javadoc.io/doc/io.dropwizard/dropwizard-project/latest/io/dropwizard/configuration/EnvironmentVariableSubstitutor.html\r\n  [2]: https://github.com/dropwizard/dropwizard/blob/release/4.0.x/dropwizard-configuration/src/main/java/io/dropwizard/configuration/EnvironmentVariableSubstitutor.java\r\n  [3]: https://commons.apache.org/proper/commons-text/javadocs/api-release/org/apache/commons/text/StringSubstitutor.html","title":"In dropwizard configuration am I allowed to use environment variable as default?","body":"<p>Technically, it should be possible.</p>\n<h2>How to enable it</h2>\n<p>You could use the constructor <a href=\"https://javadoc.io/doc/io.dropwizard/dropwizard-project/latest/io/dropwizard/configuration/EnvironmentVariableSubstitutor.html\" rel=\"nofollow noreferrer\"><code>EnvironmentVariableSubstitutor​(boolean strict, boolean substitutionInVariables)</code></a> with the second argument as <code>true</code> to enable substitution inside variables.</p>\n<p>For bootsrapping your app with this special <code>EnvironmentVariableSubstitutor​</code> instance, see <a href=\"https://stackoverflow.com/a/32231630/5730279\"><em>WarFox</em>'s answer</a> in related question <a href=\"https://stackoverflow.com/questions/23464451/overriding-server-connector-config-with-env-variables-with-dropwizard/32231630#32231630\">Overriding server connector config with env variables with dropwizard</a>.</p>\n<p>The <code>SubstitutingSourceProvider</code> to use environment variables inside YAML files is explained here: <a href=\"https://stackoverflow.com/questions/53831014/can-i-specify-default-values-for-a-config-yml-on-my-java-application/53832360#53832360\">Can I specify default values for a config.yml on my java application?</a>.</p>\n<h2>How it works</h2>\n<h3>Dropwizard Configuration uses Apache Commons Text</h3>\n<p>Responsible for environment variable substitution is the class <a href=\"https://github.com/dropwizard/dropwizard/blob/release/4.0.x/dropwizard-configuration/src/main/java/io/dropwizard/configuration/EnvironmentVariableSubstitutor.java\" rel=\"nofollow noreferrer\"><code>EnvironmentVariableSubstitutor</code></a>.</p>\n<p>It is implemented by inheritance and uses Apache Commons Text: <code> extends StringSubstitutor</code>.</p>\n<h3>StringSubstitutor allows recursive resolution</h3>\n<p>From <a href=\"https://commons.apache.org/proper/commons-text/javadocs/api-release/org/apache/commons/text/StringSubstitutor.html\" rel=\"nofollow noreferrer\"><code>StringSubstitutor</code></a> 's JavaDoc:</p>\n<blockquote>\n<h3>Using Recursive Variable Replacement</h3>\n<p>Variable replacement can work recursively by calling <code>setEnableSubstitutionInVariables(boolean)</code> with <code>true</code>. If a variable value contains a variable then that variable will also be replaced. Cyclic replacements are detected and will throw an exception.</p>\n<p>You can get the replace result to contain a variable prefix. For example:</p>\n<p><code>&quot;The variable ${${name}} must be used.&quot;</code></p>\n<p>If the value of the &quot;name&quot; variable is &quot;x&quot;, then only the variable &quot;name&quot; is replaced resulting in:</p>\n<p><code>&quot;The variable ${x} must be used.&quot;</code></p>\n</blockquote>\n"}],"owner":{"account_id":9143631,"reputation":145,"user_id":6800688,"accept_rate":50,"display_name":"user6800688"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":204,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76740265,"answer_count":1,"score":0,"last_activity_date":1689964843,"creation_date":1689957214,"question_id":76739734,"body_markdown":"I couldn&#39;t find any documentation for this. For example, I know this is possible:\r\n\r\n```\r\ndefaultSetting: ${DW_DEFAULT_SETTING:-default value}\r\n```\r\n\r\nBut what if I want logic to say if DW_DEFAULT_SETTING is not defined, then use another env variable\r\n\r\n```\r\ndefaultSetting: ${DW_DEFAULT_SETTING:-${ANOTHER_SETTING}}\r\n```\r\n\r\nIs this possible? The only other alternative I can think of is defining a custom getter for defaultSetting in my Configuration class which would read system env variables. ","title":"In dropwizard configuration am I allowed to use environment variable as default?","body":"<p>I couldn't find any documentation for this. For example, I know this is possible:</p>\n<pre><code>defaultSetting: ${DW_DEFAULT_SETTING:-default value}\n</code></pre>\n<p>But what if I want logic to say if DW_DEFAULT_SETTING is not defined, then use another env variable</p>\n<pre><code>defaultSetting: ${DW_DEFAULT_SETTING:-${ANOTHER_SETTING}}\n</code></pre>\n<p>Is this possible? The only other alternative I can think of is defining a custom getter for defaultSetting in my Configuration class which would read system env variables.</p>\n"},{"tags":["java","spring-boot","kotlin","apache-kafka","sasl"],"comments":[{"owner":{"account_id":17100074,"reputation":67,"user_id":12374210,"display_name":"Liu"},"score":0,"creation_date":1698420191,"post_id":71112179,"comment_id":136407720,"body_markdown":"I&#39;m also looking for a solution to this issue, any idea you&#39;ve got now?","body":"I&#39;m also looking for a solution to this issue, any idea you&#39;ve got now?"}],"answers":[{"tags":[],"owner":{"account_id":4073503,"reputation":23,"user_id":3345744,"display_name":"Bala Kalyan"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689964825,"creation_date":1689964825,"answer_id":76740473,"question_id":71112179,"body_markdown":"Kafka provides support for custom SASL call back handler. You can override the default SASL call back handler for name and password call back and return the username and password values from AWS secret manager without reconstructing consumer or producer.\r\n\r\nCheck this https://cwiki.apache.org/confluence/display/KAFKA/KIP-86%3A+Configurable+SASL+callback+handlers\r\n\r\nYou can extend the  class ‘org.apache.kafka.common.security.authenticator.SaslClientCAllbackHandler’ and provide your own implementation for Namecallback or passwordcallback \r\n","title":"How to handle AWS Secret Manager rotation in a Spring boot project for Kafka consumers with SASL Authentication Strategy","body":"<p>Kafka provides support for custom SASL call back handler. You can override the default SASL call back handler for name and password call back and return the username and password values from AWS secret manager without reconstructing consumer or producer.</p>\n<p>Check this <a href=\"https://cwiki.apache.org/confluence/display/KAFKA/KIP-86%3A+Configurable+SASL+callback+handlers\" rel=\"nofollow noreferrer\">https://cwiki.apache.org/confluence/display/KAFKA/KIP-86%3A+Configurable+SASL+callback+handlers</a></p>\n<p>You can extend the  class ‘org.apache.kafka.common.security.authenticator.SaslClientCAllbackHandler’ and provide your own implementation for Namecallback or passwordcallback</p>\n"}],"owner":{"account_id":305053,"reputation":939,"user_id":614953,"accept_rate":100,"display_name":"Saeed Afshari"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":531,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1689964825,"creation_date":1644842967,"question_id":71112179,"body_markdown":"I have a spring boot application with the following configuration for Kafka consumers:\r\n```\r\n@EnableKafka\r\n@Configuration\r\nclass KafkaConsumerConfig(\r\n    @Value(&quot;\\${aws.secret-manager.sasl-auth.secret-name}&quot;) private val kafkaAuthSecretName: String,\r\n    private val kafkaProperties: KafkaProperties,\r\n    private val awsSecretManagerAdaptor: AwsSecretManagerAdaptor,\r\n    private val applicationContext: ApplicationContext\r\n) {\r\n\r\n    private val logger = KotlinLogging.logger { }\r\n\r\n    @Bean\r\n    fun kafkaListenerContainerFactory():\r\n        KafkaListenerContainerFactory&lt;ConcurrentMessageListenerContainer&lt;String, String&gt;&gt; {\r\n        val factory = ConcurrentKafkaListenerContainerFactory&lt;String, String&gt;()\r\n        factory.consumerFactory = consumerFactory()\r\n        factory.containerProperties.isMissingTopicsFatal = false\r\n        factory.setRetryTemplate(retryTemplate())\r\n        factory.setErrorHandler { exception, data -&gt;\r\n            logger.error(&quot;Error in process with Exception {} and the record is {}&quot;, exception, data)\r\n            SpringApplication.exit(applicationContext)\r\n        }\r\n        return factory\r\n    }\r\n\r\n    fun consumerFactory(): ConsumerFactory&lt;String, String&gt; {\r\n        return DefaultKafkaConsumerFactory(consumerConfig())\r\n    }\r\n\r\n    fun consumerConfig(): Map&lt;String, Any&gt; {\r\n        val props = kafkaProperties.buildConsumerProperties()\r\n        props[ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG] = StringDeserializer::class.java\r\n        props[ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG] = KafkaAvroDeserializer::class.java\r\n\r\n        val secretValue = awsSecretManagerAdaptor.getSecretValue(kafkaAuthSecretName)\r\n        val username = getUsername()\r\n        val saslJaasConfig =\r\n            &quot;&quot;&quot;org.apache.kafka.common.security.scram.ScramLoginModule required username=&quot;$username&quot; password=&quot;$secretValue&quot;;&quot;&quot;&quot;\r\n        props[SaslConfigs.SASL_JAAS_CONFIG] = saslJaasConfig\r\n\r\n        return props\r\n    }\r\n\r\n    private fun getUsername(): String? {\r\n        val secretTags = awsSecretManagerAdaptor.getSecretTags(kafkaAuthSecretName)\r\n        return secretTags.firstOrNull { it.key().equals(&quot;username&quot;) }?.value()\r\n    }\r\n\r\n    private fun retryTemplate(): RetryTemplate {\r\n        val retryTemplate = RetryTemplate()\r\n        retryTemplate.setBackOffPolicy(getFixedBackOffPolicy())\r\n        retryTemplate.setRetryPolicy(getSimpleRetryPolicy())\r\n\r\n        return retryTemplate\r\n    }\r\n\r\n    private fun getFixedBackOffPolicy(): BackOffPolicy {\r\n        val fixedBackOffPolicy = FixedBackOffPolicy()\r\n        fixedBackOffPolicy.backOffPeriod = 3000\r\n        return fixedBackOffPolicy\r\n    }\r\n\r\n    private fun getSimpleRetryPolicy(): SimpleRetryPolicy {\r\n        val simpleRetryPolicy = SimpleRetryPolicy()\r\n        simpleRetryPolicy.maxAttempts = 3\r\n        return simpleRetryPolicy\r\n    }\r\n}\r\n```\r\n\r\nThe Kafka server provides SASL Authentication with username and password. As You can see the username and password are fetched using a service called AwsSecretManagerAdaptor from AWS secret manager.\r\nThe configuration works like charm, however, once the Secret is rotated, and the Kafka consumers are restarted the SASL authentication fails. To solve the issue I am now restarting the SpringBoot Application in order to read the rotated key correctly from AWS Secret Manager.\r\n\r\nThe solution works but as you can see restarting the application is very ugly and error-prone.\r\nI wonder do you have any better suggestions for the improvement?","title":"How to handle AWS Secret Manager rotation in a Spring boot project for Kafka consumers with SASL Authentication Strategy","body":"<p>I have a spring boot application with the following configuration for Kafka consumers:</p>\n<pre><code>@EnableKafka\n@Configuration\nclass KafkaConsumerConfig(\n    @Value(&quot;\\${aws.secret-manager.sasl-auth.secret-name}&quot;) private val kafkaAuthSecretName: String,\n    private val kafkaProperties: KafkaProperties,\n    private val awsSecretManagerAdaptor: AwsSecretManagerAdaptor,\n    private val applicationContext: ApplicationContext\n) {\n\n    private val logger = KotlinLogging.logger { }\n\n    @Bean\n    fun kafkaListenerContainerFactory():\n        KafkaListenerContainerFactory&lt;ConcurrentMessageListenerContainer&lt;String, String&gt;&gt; {\n        val factory = ConcurrentKafkaListenerContainerFactory&lt;String, String&gt;()\n        factory.consumerFactory = consumerFactory()\n        factory.containerProperties.isMissingTopicsFatal = false\n        factory.setRetryTemplate(retryTemplate())\n        factory.setErrorHandler { exception, data -&gt;\n            logger.error(&quot;Error in process with Exception {} and the record is {}&quot;, exception, data)\n            SpringApplication.exit(applicationContext)\n        }\n        return factory\n    }\n\n    fun consumerFactory(): ConsumerFactory&lt;String, String&gt; {\n        return DefaultKafkaConsumerFactory(consumerConfig())\n    }\n\n    fun consumerConfig(): Map&lt;String, Any&gt; {\n        val props = kafkaProperties.buildConsumerProperties()\n        props[ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG] = StringDeserializer::class.java\n        props[ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG] = KafkaAvroDeserializer::class.java\n\n        val secretValue = awsSecretManagerAdaptor.getSecretValue(kafkaAuthSecretName)\n        val username = getUsername()\n        val saslJaasConfig =\n            &quot;&quot;&quot;org.apache.kafka.common.security.scram.ScramLoginModule required username=&quot;$username&quot; password=&quot;$secretValue&quot;;&quot;&quot;&quot;\n        props[SaslConfigs.SASL_JAAS_CONFIG] = saslJaasConfig\n\n        return props\n    }\n\n    private fun getUsername(): String? {\n        val secretTags = awsSecretManagerAdaptor.getSecretTags(kafkaAuthSecretName)\n        return secretTags.firstOrNull { it.key().equals(&quot;username&quot;) }?.value()\n    }\n\n    private fun retryTemplate(): RetryTemplate {\n        val retryTemplate = RetryTemplate()\n        retryTemplate.setBackOffPolicy(getFixedBackOffPolicy())\n        retryTemplate.setRetryPolicy(getSimpleRetryPolicy())\n\n        return retryTemplate\n    }\n\n    private fun getFixedBackOffPolicy(): BackOffPolicy {\n        val fixedBackOffPolicy = FixedBackOffPolicy()\n        fixedBackOffPolicy.backOffPeriod = 3000\n        return fixedBackOffPolicy\n    }\n\n    private fun getSimpleRetryPolicy(): SimpleRetryPolicy {\n        val simpleRetryPolicy = SimpleRetryPolicy()\n        simpleRetryPolicy.maxAttempts = 3\n        return simpleRetryPolicy\n    }\n}\n</code></pre>\n<p>The Kafka server provides SASL Authentication with username and password. As You can see the username and password are fetched using a service called AwsSecretManagerAdaptor from AWS secret manager.\nThe configuration works like charm, however, once the Secret is rotated, and the Kafka consumers are restarted the SASL authentication fails. To solve the issue I am now restarting the SpringBoot Application in order to read the rotated key correctly from AWS Secret Manager.</p>\n<p>The solution works but as you can see restarting the application is very ugly and error-prone.\nI wonder do you have any better suggestions for the improvement?</p>\n"},{"tags":["java","spring-boot","multithreading","hibernate"],"comments":[{"owner":{"account_id":23128,"reputation":13127,"user_id":57719,"display_name":"Chin Huang"},"score":0,"creation_date":1689960219,"post_id":76739966,"comment_id":135291600,"body_markdown":"The [HikariCP maximum pool size](https://github.com/brettwooldridge/HikariCP#frequently-used) default is 10. This limits the number of database connections. What happens when you set [application property](https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html#application-properties.data.spring.datasource.hikari) `spring.datasource.hikari.maximum-pool-size=20` ?","body":"The <a href=\"https://github.com/brettwooldridge/HikariCP#frequently-used\" rel=\"nofollow noreferrer\">HikariCP maximum pool size</a> default is 10. This limits the number of database connections. What happens when you set <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html#application-properties.data.spring.datasource.hikari\" rel=\"nofollow noreferrer\">application property</a> <code>spring.datasource.hikari.maximum-pool-size=20</code> ?"},{"owner":{"account_id":29065435,"reputation":11,"user_id":22265152,"display_name":"Parth Atara"},"score":0,"creation_date":1689962854,"post_id":76739966,"comment_id":135292035,"body_markdown":"This didn&#39;t work. Getting the same results. I&#39;m using C3P0 ComboPooledDataSource with  max pool size = 200","body":"This didn&#39;t work. Getting the same results. I&#39;m using C3P0 ComboPooledDataSource with  max pool size = 200"},{"owner":{"account_id":29065435,"reputation":11,"user_id":22265152,"display_name":"Parth Atara"},"score":0,"creation_date":1689964334,"post_id":76739966,"comment_id":135292249,"body_markdown":"It is resolved. I had hikariCP config class which wasn&#39;t being used but had @Primay defined so I guess it was creating its pool instead of C3P0. After commenting it, The logic works as expected. Thank you","body":"It is resolved. I had hikariCP config class which wasn&#39;t being used but had @Primay defined so I guess it was creating its pool instead of C3P0. After commenting it, The logic works as expected. Thank you"}],"owner":{"account_id":29065435,"reputation":11,"user_id":22265152,"display_name":"Parth Atara"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":28,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1689963816,"creation_date":1689959816,"question_id":76739966,"body_markdown":"I&#39;m using hibernate in my springboot application. I&#39;m trying to execute one api on multithreading. But at one point when hibernate findBy() method is called only 10 threads are able to move after that line of code at a time while I want all the threads to run parallelly. \r\n\r\nThis is that line of code\r\n\r\n    System.out.println(&quot;Step 0 - &quot; + System.currentTimeMillis());\r\n    Optional&lt;RuleMaster&gt; master = ruleMasterDao.findByRuleId(id);\r\n    System.out.println(&quot;Step 1 - &quot; + System.currentTimeMillis());\r\n\r\nHere when I try to execute multithreading with 20 threads all the requests reach Step - 0 at the same time but only 10 reaches step - 1. Once the whole execution completes and requests start getting final response and finishes execution only then next set of requests reaches step - 1. \r\n\r\nBelow is the console output of above code.\r\n\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805814\r\n    Step - 0 :1689945805814\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805815\r\n    Step - 0 :1689945805814\r\n    Step - 0 :1689945805814\r\n    Step - 0 :1689945805814\r\n    Step - 0 :1689945805814\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805813\r\n    Step - 0 :1689945805813\r\n    Step - 1 :1689945805868\r\n    Step - 1 :1689945805868\r\n    Step - 1 :1689945805868\r\n    Step - 1 :1689945805868\r\n    Step - 1 :1689945805868\r\n    Step - 1 :1689945805869\r\n    Step - 1 :1689945805869\r\n    Step - 1 :1689945805868\r\n    Step - 1 :1689945805869\r\n    Step - 1 :1689945805869\r\n    Final Response At : 1689945810355\r\n    Final Response At : 1689945810355\r\n    Step - 1 :1689945810402\r\n    Step - 1 :1689945810402\r\n    Final Response At : 1689945810564\r\n    Step - 1 :1689945810574\r\n    Final Response At : 1689945810675\r\n    Step - 1 :1689945810690\r\n    Final Response At : 1689945810706\r\n    Step - 1 :1689945810722\r\n    Final Response At : 1689945810722\r\n    Final Response At : 1689945810722\r\n    Step - 1 :1689945810731\r\n    Step - 1 :1689945810738\r\n    Final Response At : 1689945810738\r\n    Step - 1 :1689945810754\r\n    Final Response At : 1689945810770\r\n    Step - 1 :1689945810770\r\n    Final Response At : 1689945810793\r\n    Step - 1 :1689945810793\r\n    Final Response At : 1689945814180\r\n    Final Response At : 1689945814243\r\n    Final Response At : 1689945814337\r\n    Final Response At : 1689945814352\r\n    Final Response At : 1689945814449\r\n    Final Response At : 1689945814463\r\n    Final Response At : 1689945814574\r\n    Final Response At : 1689945814668\r\n    Final Response At : 1689945814715\r\n    Final Response At : 1689945814746\r\n\r\nPlease help me with this issue. I want all the threads to reach step - 1 parallelly.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","title":"Hibernate not allowing multiple threads execution","body":"<p>I'm using hibernate in my springboot application. I'm trying to execute one api on multithreading. But at one point when hibernate findBy() method is called only 10 threads are able to move after that line of code at a time while I want all the threads to run parallelly.</p>\n<p>This is that line of code</p>\n<pre><code>System.out.println(&quot;Step 0 - &quot; + System.currentTimeMillis());\nOptional&lt;RuleMaster&gt; master = ruleMasterDao.findByRuleId(id);\nSystem.out.println(&quot;Step 1 - &quot; + System.currentTimeMillis());\n</code></pre>\n<p>Here when I try to execute multithreading with 20 threads all the requests reach Step - 0 at the same time but only 10 reaches step - 1. Once the whole execution completes and requests start getting final response and finishes execution only then next set of requests reaches step - 1.</p>\n<p>Below is the console output of above code.</p>\n<pre><code>Step - 0 :1689945805813\nStep - 0 :1689945805813\nStep - 0 :1689945805813\nStep - 0 :1689945805813\nStep - 0 :1689945805813\nStep - 0 :1689945805813\nStep - 0 :1689945805814\nStep - 0 :1689945805814\nStep - 0 :1689945805813\nStep - 0 :1689945805815\nStep - 0 :1689945805814\nStep - 0 :1689945805814\nStep - 0 :1689945805814\nStep - 0 :1689945805814\nStep - 0 :1689945805813\nStep - 0 :1689945805813\nStep - 0 :1689945805813\nStep - 0 :1689945805813\nStep - 0 :1689945805813\nStep - 0 :1689945805813\nStep - 1 :1689945805868\nStep - 1 :1689945805868\nStep - 1 :1689945805868\nStep - 1 :1689945805868\nStep - 1 :1689945805868\nStep - 1 :1689945805869\nStep - 1 :1689945805869\nStep - 1 :1689945805868\nStep - 1 :1689945805869\nStep - 1 :1689945805869\nFinal Response At : 1689945810355\nFinal Response At : 1689945810355\nStep - 1 :1689945810402\nStep - 1 :1689945810402\nFinal Response At : 1689945810564\nStep - 1 :1689945810574\nFinal Response At : 1689945810675\nStep - 1 :1689945810690\nFinal Response At : 1689945810706\nStep - 1 :1689945810722\nFinal Response At : 1689945810722\nFinal Response At : 1689945810722\nStep - 1 :1689945810731\nStep - 1 :1689945810738\nFinal Response At : 1689945810738\nStep - 1 :1689945810754\nFinal Response At : 1689945810770\nStep - 1 :1689945810770\nFinal Response At : 1689945810793\nStep - 1 :1689945810793\nFinal Response At : 1689945814180\nFinal Response At : 1689945814243\nFinal Response At : 1689945814337\nFinal Response At : 1689945814352\nFinal Response At : 1689945814449\nFinal Response At : 1689945814463\nFinal Response At : 1689945814574\nFinal Response At : 1689945814668\nFinal Response At : 1689945814715\nFinal Response At : 1689945814746\n</code></pre>\n<p>Please help me with this issue. I want all the threads to reach step - 1 parallelly.</p>\n"},{"tags":["java","firebase","microsoft-oauth"],"owner":{"account_id":29040856,"reputation":1,"user_id":22245739,"display_name":"ChingHeng Tan"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":14,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689963658,"creation_date":1689963658,"question_id":76740358,"body_markdown":"I am new to using firebase auth with providers so bear with me.\r\n\r\nIn the documentation for FirebaseAuth using microsoft, it says:\r\n\r\n*\r\nAuthenticate with Firebase using the OAuth provider object. Note that unlike other FirebaseAuth operations, this will take control of your UI by popping up a Custom Chrome Tab. As a result, do not reference your Activity in the OnSuccessListener and OnFailureListener that you attach as they will immediately detach when the operation starts the UI.*\r\n\r\nI am not quite sure what it means by &quot;do not reference your Activity&quot;. Does it mean I cannot start an activity in the onSuccess listener? if so what is the proper way for me to redirect the users to another activity?\r\n\r\n\r\n```\r\nfirebaseAuth\r\n        .startActivityForSignInWithProvider(/* activity= */ this, provider.build())\r\n        .addOnSuccessListener(\r\n                new OnSuccessListener&lt;AuthResult&gt;() {\r\n                    @Override\r\n                    public void onSuccess(AuthResult authResult) {\r\n                        // User is signed in.\r\n                        // DO I NOT REDIRECT THE USER HERE?\r\n                        Intent intent= new Intent(AuthActivity.this,MainActivity.class);\r\n                        startActivity(intent);\r\n                        //Is the above a code a No-No?\r\n\r\n                    }\r\n                })\r\n        .addOnFailureListener(\r\n                new OnFailureListener() {\r\n                    @Override\r\n                    public void onFailure(@NonNull Exception e) {\r\n                        // Handle failure.\r\n                    }\r\n                });\r\n```\r\n","title":"Proper way to redirect user to another activity after when using startActivityForSignInWithProvider?","body":"<p>I am new to using firebase auth with providers so bear with me.</p>\n<p>In the documentation for FirebaseAuth using microsoft, it says:</p>\n<p>*\nAuthenticate with Firebase using the OAuth provider object. Note that unlike other FirebaseAuth operations, this will take control of your UI by popping up a Custom Chrome Tab. As a result, do not reference your Activity in the OnSuccessListener and OnFailureListener that you attach as they will immediately detach when the operation starts the UI.*</p>\n<p>I am not quite sure what it means by &quot;do not reference your Activity&quot;. Does it mean I cannot start an activity in the onSuccess listener? if so what is the proper way for me to redirect the users to another activity?</p>\n<pre><code>firebaseAuth\n        .startActivityForSignInWithProvider(/* activity= */ this, provider.build())\n        .addOnSuccessListener(\n                new OnSuccessListener&lt;AuthResult&gt;() {\n                    @Override\n                    public void onSuccess(AuthResult authResult) {\n                        // User is signed in.\n                        // DO I NOT REDIRECT THE USER HERE?\n                        Intent intent= new Intent(AuthActivity.this,MainActivity.class);\n                        startActivity(intent);\n                        //Is the above a code a No-No?\n\n                    }\n                })\n        .addOnFailureListener(\n                new OnFailureListener() {\n                    @Override\n                    public void onFailure(@NonNull Exception e) {\n                        // Handle failure.\n                    }\n                });\n</code></pre>\n"},{"tags":["java","spring-boot","junit","microservices","junit5"],"comments":[{"owner":{"account_id":27597790,"reputation":11,"user_id":21063641,"display_name":"Vinod"},"score":0,"creation_date":1689962141,"post_id":76740183,"comment_id":135291930,"body_markdown":"added annotations as like \n\n@ExtendWith(SpringExtension.class)\n@ContextConfiguration(classes = {RulesApiController.class},\n        loader = AnnotationConfigContextLoader.class)\n@TestPropertySource(locations = {&quot;classpath:properties/test/application-test-normal-flow.properties&quot;})\n@ActiveProfiles(profiles = &quot;test&quot;)\n@SpringBootTest(webEnvironment = WebEnvironment.DEFINED_PORT)","body":"added annotations as like   @ExtendWith(SpringExtension.class) @ContextConfiguration(classes = {RulesApiController.class},         loader = AnnotationConfigContextLoader.class) @TestPropertySource(locations = {&quot;classpath:properties/test/application-test-normal-flow.pro&zwnj;&#8203;perties&quot;}) @ActiveProfiles(profiles = &quot;test&quot;) @SpringBootTest(webEnvironment = WebEnvironment.DEFINED_PORT)"},{"owner":{"account_id":2709823,"reputation":10716,"user_id":2338547,"display_name":"markspace"},"score":1,"creation_date":1689962315,"post_id":76740183,"comment_id":135291954,"body_markdown":"Please edit your question and add that information, don&#39;t try to add long pieces of code in a comment, the formatting is terrible.","body":"Please edit your question and add that information, don&#39;t try to add long pieces of code in a comment, the formatting is terrible."},{"owner":{"account_id":15361,"reputation":4976,"user_id":32352,"accept_rate":62,"display_name":"johanneslink"},"score":0,"creation_date":1690007273,"post_id":76740183,"comment_id":135295670,"body_markdown":"Also, add at least the failing test and the controller class that’s supposed to handle it.","body":"Also, add at least the failing test and the controller class that’s supposed to handle it."}],"owner":{"account_id":27597790,"reputation":11,"user_id":21063641,"display_name":"Vinod"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":61,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689962064,"creation_date":1689961983,"question_id":76740183,"body_markdown":"`your text`M controller class is like \r\n\r\nmy Test class is something like this:\r\n\r\n\r\n    public class ApiControllerTest {\r\n    \r\n        @Autowired\r\n        private TestRestTemplate testRestTemplate;\r\n\r\ngetting this error msg:\r\n\r\n    org.springframework.web.client.ResourceAccessException: I/O error on GET request for &quot;http://localhost:8080/pharmacyrules-specialty/pharmacyrules-specialty/v1/pac&quot;: Connect to localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: connect; nested exception is org.apache.http.conn.HttpHostConnectException: Connect to localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: connect\r\n\r\n\tat org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:785)\r\n\tat org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)\r\n\tat org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:361)\r\n\tat org.springframework.boot.test.web.client.TestRestTemplate.getForEntity(TestRestTemplate.java:231)\r\n\tat com.esrx.services.pacRulesEngine.api.RulesApiControllerTest.emptyValueStateCodeBadRequestHttp400Error(RulesApiControllerTest.java:110)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)\r\n\tat org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)\r\n\tat org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)\r\n\tat org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)\r\n\tat org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)\r\n\tat org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)\r\n\tat org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)\r\n\tat org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)\r\n\tat org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)\r\n\tat org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)\r\n\tat org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)\r\n\tat org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)\r\n\tat org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)\r\n\tat org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)\r\n\tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)\r\n\tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)\r\n\tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)\r\n\tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)\r\n\tat java.util.ArrayList.forEach(ArrayList.java:1249)\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)\r\n\tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)\r\n\tat java.util.ArrayList.forEach(ArrayList.java:1249)\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)\r\n\tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)\r\n\tat org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)\r\n\tat org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)\r\n\tat com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)\r\n\tat com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)\r\n\tat com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)\r\n\tat com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)\r\n\tat com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:235)\r\n\tat com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:54)\r\nCaused by: org.apache.http.conn.HttpHostConnectException: Connect to localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: connect\r\n\tat org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:156)\r\n\t\r\n    \r\n    \r\ntried changing the top annotations however it did not work.\r\n\r\n\r\nexpecting any leads to get this issue resolved for controller JUnit test cases.\r\n\r\n\r\n\r\n","title":"ResourceAccessException: I/O error on GET request receving in case of controller testcases junit","body":"<p><code>your text</code>M controller class is like</p>\n<p>my Test class is something like this:</p>\n<pre><code>public class ApiControllerTest {\n\n    @Autowired\n    private TestRestTemplate testRestTemplate;\n</code></pre>\n<p>getting this error msg:</p>\n<pre><code>org.springframework.web.client.ResourceAccessException: I/O error on GET request for &quot;http://localhost:8080/pharmacyrules-specialty/pharmacyrules-specialty/v1/pac&quot;: Connect to localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: connect; nested exception is org.apache.http.conn.HttpHostConnectException: Connect to localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: connect\n\nat org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:785)\nat org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)\nat org.springframework.web.client.RestTemplate.getForEntity(RestTemplate.java:361)\nat org.springframework.boot.test.web.client.TestRestTemplate.getForEntity(TestRestTemplate.java:231)\nat com.esrx.services.pacRulesEngine.api.RulesApiControllerTest.emptyValueStateCodeBadRequestHttp400Error(RulesApiControllerTest.java:110)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:498)\nat org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)\nat org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)\nat org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)\nat org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)\nat org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)\nat org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)\nat org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)\nat org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)\nat org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)\nat org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)\nat org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)\nat org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)\nat org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)\nat org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)\nat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)\nat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\nat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)\nat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)\nat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)\nat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)\nat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)\nat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)\nat java.util.ArrayList.forEach(ArrayList.java:1249)\nat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)\nat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)\nat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)\nat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)\nat java.util.ArrayList.forEach(ArrayList.java:1249)\nat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)\nat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)\nat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)\nat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)\nat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)\nat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)\nat org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)\nat org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)\nat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)\nat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)\nat org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)\nat org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)\nat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)\nat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)\nat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)\nat com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)\nat com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)\nat com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)\nat com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)\nat com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:235)\nat com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:54)\n</code></pre>\n<p>Caused by: org.apache.http.conn.HttpHostConnectException: Connect to localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: connect\nat org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:156)</p>\n<p>tried changing the top annotations however it did not work.</p>\n<p>expecting any leads to get this issue resolved for controller JUnit test cases.</p>\n"},{"tags":["java","pdf","pdfbox"],"answers":[{"tags":[],"owner":{"account_id":255529,"reputation":17950,"user_id":535646,"accept_rate":40,"display_name":"Tilman Hausherr"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689960786,"creation_date":1689960786,"answer_id":76740063,"question_id":76738878,"body_markdown":"call\r\n\r\n    txtLink.setConstantOpacity(ca);\r\n\r\nca is a float value between 0 and 1. 0 is fully transparent (invisible), 1 fully visible (opaque), all between is transparent.","title":"Add PDAnnotationLink to a PDF With pdfbox","body":"<p>call</p>\n<pre><code>txtLink.setConstantOpacity(ca);\n</code></pre>\n<p>ca is a float value between 0 and 1. 0 is fully transparent (invisible), 1 fully visible (opaque), all between is transparent.</p>\n"},{"tags":[],"owner":{"account_id":1916831,"reputation":91511,"user_id":1729265,"display_name":"mkl"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689961572,"creation_date":1689961572,"answer_id":76740142,"question_id":76738878,"body_markdown":"Your code actually explicitly draws that _black rectangle_!\r\n\r\nIt requests an underline with a line width of 10:\r\n```\r\nlinkBorder.setStyle (PDBorderStyleDictionary.STYLE_UNDERLINE);\r\nlinkBorder.setWidth (10);\r\ntxtLink.setBorderStyle (linkBorder);\r\n```\r\nAs the underlying text has a font size of also 10, you can expect it to be half covered by that thick underline.\r\n\r\nThus, if you actually don&#39;t want that black rectangle, don&#39;t draw such a thick underline. You may want to try values of 1 or 2 there...","title":"Add PDAnnotationLink to a PDF With pdfbox","body":"<p>Your code actually explicitly draws that <em>black rectangle</em>!</p>\n<p>It requests an underline with a line width of 10:</p>\n<pre><code>linkBorder.setStyle (PDBorderStyleDictionary.STYLE_UNDERLINE);\nlinkBorder.setWidth (10);\ntxtLink.setBorderStyle (linkBorder);\n</code></pre>\n<p>As the underlying text has a font size of also 10, you can expect it to be half covered by that thick underline.</p>\n<p>Thus, if you actually don't want that black rectangle, don't draw such a thick underline. You may want to try values of 1 or 2 there...</p>\n"}],"owner":{"account_id":23207499,"reputation":49,"user_id":17301498,"display_name":"Mario Rovelli"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":40,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1689961572,"creation_date":1689949706,"question_id":76738878,"body_markdown":"I want to add a PDAnnotationLink with an action to a pdf.\r\n\r\nI write this code\r\n```\r\n            ...\r\n            PDPageContentStream contentStream = new PDPageContentStream (doc, page,true,true);\r\n\t      \r\n\t        final PDAnnotationLink txtLink = new PDAnnotationLink ();\r\n\r\n\t        // border style\r\n\t        final PDBorderStyleDictionary linkBorder = new PDBorderStyleDictionary ();\r\n\t        linkBorder.setStyle (PDBorderStyleDictionary.STYLE_UNDERLINE);\r\n\t        linkBorder.setWidth (10);\r\n\t        txtLink.setBorderStyle (linkBorder);\r\n\t        \r\n\t        // Destination URI\r\n\t        final PDActionURI action = new PDActionURI ();\r\n\t        action.setURI (&quot;https://www.test.com&quot;);\r\n\t        txtLink.setAction (action); \r\n\r\n\t        // Position\r\n\t        final PDRectangle position = new PDRectangle (200,302,100,11);\r\n\t        txtLink.setRectangle (position);\r\n\t        page.getAnnotations ().add (txtLink);\r\n\r\n\t        // Main page content\r\n\t        contentStream.beginText ();\r\n\t        contentStream.newLineAtOffset (102, 302);\r\n\t        contentStream.setFont (PDType1Font.COURIER_BOLD, 10);\r\n\t        contentStream.showText (&quot;This is linked to the outside world&quot;);\r\n\t        contentStream.endText ();\r\n\t        contentStream.close(); \r\n```\r\n\r\nPDAnnotationLink is added with a black rectangle over the text &quot;This is linked to the outside world&quot;. \r\n\r\nHow can i make this rectangle trasparent?\r\n\r\nThanks\r\n","title":"Add PDAnnotationLink to a PDF With pdfbox","body":"<p>I want to add a PDAnnotationLink with an action to a pdf.</p>\n<p>I write this code</p>\n<pre><code>            ...\n            PDPageContentStream contentStream = new PDPageContentStream (doc, page,true,true);\n          \n            final PDAnnotationLink txtLink = new PDAnnotationLink ();\n\n            // border style\n            final PDBorderStyleDictionary linkBorder = new PDBorderStyleDictionary ();\n            linkBorder.setStyle (PDBorderStyleDictionary.STYLE_UNDERLINE);\n            linkBorder.setWidth (10);\n            txtLink.setBorderStyle (linkBorder);\n            \n            // Destination URI\n            final PDActionURI action = new PDActionURI ();\n            action.setURI (&quot;https://www.test.com&quot;);\n            txtLink.setAction (action); \n\n            // Position\n            final PDRectangle position = new PDRectangle (200,302,100,11);\n            txtLink.setRectangle (position);\n            page.getAnnotations ().add (txtLink);\n\n            // Main page content\n            contentStream.beginText ();\n            contentStream.newLineAtOffset (102, 302);\n            contentStream.setFont (PDType1Font.COURIER_BOLD, 10);\n            contentStream.showText (&quot;This is linked to the outside world&quot;);\n            contentStream.endText ();\n            contentStream.close(); \n</code></pre>\n<p>PDAnnotationLink is added with a black rectangle over the text &quot;This is linked to the outside world&quot;.</p>\n<p>How can i make this rectangle trasparent?</p>\n<p>Thanks</p>\n"},{"tags":["java","spring","spring-boot","hibernate","spring-data-jpa"],"owner":{"account_id":105522,"reputation":43,"user_id":281540,"accept_rate":25,"display_name":"denlab"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":19,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689961344,"creation_date":1689960787,"question_id":76740064,"body_markdown":"I have a generic jpa `AttributeConverter` that converts a dbValue to the specified `ConvertableDbConstant`:\r\n```\r\n@Converter(autoApply = true) // this would only work on the concrete Converter implementation\r\npublic class GenericDbValueToEnumConverter&lt;E extends ConvertableDbConstant&lt;DbValue&gt;, DbValue&gt; implements AttributeConverter&lt;E, DbValue&gt; {\r\n\r\n\r\n  @Getter\r\n  private Class&lt;E&gt; clazz;\r\n\r\n  @Override\r\n  public DbValue convertToDatabaseColumn(E attribute) {\r\n    return attribute.getDbValue(); \r\n  }\r\n\r\n  @Override\r\n  public E convertToEntityAttribute(DbValue dbData) {\r\n    return Arrays.stream(clazz.getEnumConstants())\r\n                 .filter(v -&gt; v.getDbValue().equals(dbData)).findFirst()\r\n                 .orElse(null));\r\n  }\r\n```\r\nRather than have to create a bunch of empty concrete classes, I was hoping to create the required converters during startup through Springs BeanFactoryPostProcessor; \r\n\r\n```\r\npublic class DbValueEnumConstantsBeanFactory implements BeanFactoryPostProcessor {\r\n  \r\n  @Override\r\n  public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {\r\n    final var scanner = new ClassPathScanningCandidateComponentProvider(false);\r\n\r\n    scanner.addIncludeFilter(new AssignableTypeFilter(ConvertableDbConstant.class));\r\n    scanner.findCandidateComponents(&quot;com.org.base.package&quot;)\r\n           .forEach(x -&gt; {\r\n             try {\r\n               final var clazz = Class.forName(x.getBeanClassName());\r\n               final var converter = new GenericDbValueToEnumConverter(clazz);\r\n               beanFactory.registerSingleton(GenericDbValueToEnumConverter.getBeanName(clazz.getName()), converter);\r\n               log.info(&quot;Registering AttributeConverter for {} with name {}&quot;, x.getClass().getSimpleName(), x);\r\n\r\n             } catch (ClassNotFoundException e) {}\r\n           });\r\n  }\r\n}\r\n```\r\n\r\nWhile the Converters are being registered into the applicationContext, they&#39;re being ignored by (whichever) persistence hooks used to add the AttributeConverter(s) to the persistence provider.  How can I achieve this during the `postProcessBeanFactory` invocation?  All of the examples I&#39;ve seen would require the concrete classes I am trying to avoid. \r\n\r\nBy the way, I am using Springboot version &#39;3.1.1&#39;, and spring-boot-starter-data-jpa.","title":"Creating Anonymous AttributeConverter during context initialization","body":"<p>I have a generic jpa <code>AttributeConverter</code> that converts a dbValue to the specified <code>ConvertableDbConstant</code>:</p>\n<pre><code>@Converter(autoApply = true) // this would only work on the concrete Converter implementation\npublic class GenericDbValueToEnumConverter&lt;E extends ConvertableDbConstant&lt;DbValue&gt;, DbValue&gt; implements AttributeConverter&lt;E, DbValue&gt; {\n\n\n  @Getter\n  private Class&lt;E&gt; clazz;\n\n  @Override\n  public DbValue convertToDatabaseColumn(E attribute) {\n    return attribute.getDbValue(); \n  }\n\n  @Override\n  public E convertToEntityAttribute(DbValue dbData) {\n    return Arrays.stream(clazz.getEnumConstants())\n                 .filter(v -&gt; v.getDbValue().equals(dbData)).findFirst()\n                 .orElse(null));\n  }\n</code></pre>\n<p>Rather than have to create a bunch of empty concrete classes, I was hoping to create the required converters during startup through Springs BeanFactoryPostProcessor;</p>\n<pre><code>public class DbValueEnumConstantsBeanFactory implements BeanFactoryPostProcessor {\n  \n  @Override\n  public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {\n    final var scanner = new ClassPathScanningCandidateComponentProvider(false);\n\n    scanner.addIncludeFilter(new AssignableTypeFilter(ConvertableDbConstant.class));\n    scanner.findCandidateComponents(&quot;com.org.base.package&quot;)\n           .forEach(x -&gt; {\n             try {\n               final var clazz = Class.forName(x.getBeanClassName());\n               final var converter = new GenericDbValueToEnumConverter(clazz);\n               beanFactory.registerSingleton(GenericDbValueToEnumConverter.getBeanName(clazz.getName()), converter);\n               log.info(&quot;Registering AttributeConverter for {} with name {}&quot;, x.getClass().getSimpleName(), x);\n\n             } catch (ClassNotFoundException e) {}\n           });\n  }\n}\n</code></pre>\n<p>While the Converters are being registered into the applicationContext, they're being ignored by (whichever) persistence hooks used to add the AttributeConverter(s) to the persistence provider.  How can I achieve this during the <code>postProcessBeanFactory</code> invocation?  All of the examples I've seen would require the concrete classes I am trying to avoid.</p>\n<p>By the way, I am using Springboot version '3.1.1', and spring-boot-starter-data-jpa.</p>\n"},{"tags":["java","java-bytecode-asm"],"comments":[{"owner":{"account_id":137237,"reputation":13989,"user_id":341291,"accept_rate":76,"display_name":"Axel"},"score":2,"creation_date":1444337069,"post_id":33025409,"comment_id":53873602,"body_markdown":"Well, just write a parser. I think ANTLR has example grammars to get you started.","body":"Well, just write a parser. I think ANTLR has example grammars to get you started."},{"owner":{"account_id":7054036,"reputation":479,"user_id":5406207,"display_name":"triadiktyo"},"score":1,"creation_date":1444337144,"post_id":33025409,"comment_id":53873634,"body_markdown":"Well the first thing that comes to mind is to use a regular expression with the right capture groups. That should give you the right information in each group. But you know what they say... a programmer has a problem and decides to solve it with regular expressions. Now he has two problems! Alternatively you could just code a parser method to return you an object containing the fields you need. Getting the pretty output could be as simple (?) as using the toString to format it as you like... And yes I also like the ANTLR proposal by @Axel","body":"Well the first thing that comes to mind is to use a regular expression with the right capture groups. That should give you the right information in each group. But you know what they say... a programmer has a problem and decides to solve it with regular expressions. Now he has two problems! Alternatively you could just code a parser method to return you an object containing the fields you need. Getting the pretty output could be as simple (?) as using the toString to format it as you like... And yes I also like the ANTLR proposal by @Axel"}],"answers":[{"tags":[],"owner":{"account_id":3211603,"reputation":289297,"user_id":2711488,"display_name":"Holger"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1689960127,"creation_date":1444396105,"answer_id":33039128,"question_id":33025409,"body_markdown":"If you implement the [method](http://asm.ow2.org/asm50/javadoc/user/org/objectweb/asm/ClassVisitor.html#visitMethod(int,%20java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String[]))\r\n\r\n    public MethodVisitor visitMethod(\r\n      int access, String name, String desc, String signature, String[] exceptions)\r\n\r\nyou already have most of the needed information which you can assemble to a human readable declaration. The biggest obstacle is the signature, but thankfully, the ASM library already provides tools helping on this purpose.\r\n\r\nThe following code uses [`SignatureReader`](http://asm.ow2.org/asm50/javadoc/user/?org/objectweb/asm/signature/SignatureReader.html) and [`TraceSignatureVisitor`](http://asm.ow2.org/asm50/javadoc/user/?org/objectweb/asm/util/TraceSignatureVisitor.html) to format them. Unfortunately, it requires a bit of post processing as it does not separate type parameters and method parameters and it omits `Object` return types for non-generic methods. Further, it generates an exception list only if there are generic exceptions, so we have to do it manually otherwise.\r\n\r\n```java\r\nstatic String decode(int access, String name, String desc,\r\n                     String signature, String[] exceptions) {\r\n\r\n    if(signature == null) signature = desc;\r\n    StringBuilder sb = new StringBuilder();\r\n    appendModifiers(sb, access);\r\n    TraceSignatureVisitor v = new TraceSignatureVisitor(0);\r\n    new SignatureReader(signature).accept(v);\r\n\r\n    String declaration = v.getDeclaration(), rType = v.getReturnType();\r\n    if(declaration.charAt(0) == &#39;&lt;&#39;)\r\n        sb.append(declaration, 0, declaration.indexOf(&quot;(&quot;)).append(&#39; &#39;);\r\n    else if(rType.isEmpty() || rType.charAt(0) == &#39;[&#39;)\r\n        sb.append(&quot;java.lang.Object&quot;);\r\n    sb.append(rType).append(&#39; &#39;).append(name)\r\n      .append(declaration, declaration.indexOf(&#39;(&#39;), declaration.length());\r\n    if((access &amp; Opcodes.ACC_VARARGS) != 0 &amp;&amp; declaration.endsWith(&quot;[])&quot;))\r\n        sb.replace(sb.length() - 3, sb.length(), &quot;...)&quot;);\r\n    String genericExceptions = v.getExceptions();\r\n    if(genericExceptions != null &amp;&amp; !v.getDeclaration().isEmpty())\r\n        sb.append(&quot; throws &quot;).append(genericExceptions);\r\n    else if(exceptions != null &amp;&amp; exceptions.length &gt; 0) {\r\n        sb.append(&quot; throws &quot;);\r\n        int pos = sb.length();\r\n        for(String e:exceptions) sb.append(e).append(&quot;, &quot;);\r\n        int e = sb.length() - 2;\r\n        sb.setLength(e);\r\n        for(; pos &lt; e; pos++) if(sb.charAt(pos) == &#39;/&#39;) sb.setCharAt(pos, &#39;.&#39;);\r\n    }\r\n    return sb.toString();\r\n}\r\n\r\nprivate static void appendModifiers(StringBuilder buf, int access) {\r\n    for(int bit; access != 0; access -= bit) {\r\n        bit = access &amp; -access;\r\n        buf.append(switch(bit) {\r\n            case Opcodes.ACC_PUBLIC -&gt; &quot;public &quot;;\r\n            case Opcodes.ACC_PRIVATE -&gt; &quot;private &quot;;\r\n            case Opcodes.ACC_PROTECTED -&gt; &quot;protected &quot;;\r\n            case Opcodes.ACC_STATIC -&gt; &quot;static &quot;;\r\n            case Opcodes.ACC_FINAL -&gt; &quot;final &quot;;\r\n            case Opcodes.ACC_ABSTRACT -&gt; &quot;abstract &quot;;\r\n            case Opcodes.ACC_NATIVE -&gt; &quot;native &quot;;\r\n            case Opcodes.ACC_SYNCHRONIZED -&gt; &quot;synchronized &quot;;\r\n            default -&gt; &quot;&quot;;\r\n        });\r\n    }\r\n}\r\n```\r\n&lt;sup&gt;The `appendModifiers` method has been adapted for recent Java versions, for old versions look [here](https://stackoverflow.com/revisions/33039128/1)&lt;/sup&gt;\r\n\r\nIt also decodes the modifiers manually, as you can see at the end, but that’s not such a big deal.\r\n\r\nIf you test it with:\r\n\r\n    String[] exceptions={&quot;java/lang/Exception&quot;};\r\n    System.out.println(decode(9, &quot;testMethod&quot;,\r\n        &quot;(Ljava/lang/Object;)Ljava/lang/Object;&quot;,\r\n        &quot;&lt;T:Ljava/lang/Object;&gt;(TT;)TT;&quot;, exceptions));\r\nit will print:\r\n\r\n&lt;!-- language: lang-none --&gt;\r\n\r\n    public static &lt;T&gt; T testMethod(T) throws java.lang.Exception\r\n\r\n---\r\n\r\nWhen it comes to parsing such a declaration, it gets more complicated. Since you are going to implement an *editor* rather than an assembler, you may think about the alternative of just providing distinct editors components for the different features, e.g. checkboxes and comboboxes for the modifiers, a textfield for the name and a list editor for the parameter types.\r\n\r\nAt this point, I’d recommend studying the [`Type`](http://asm.ow2.org/asm50/javadoc/user/?org/objectweb/asm/Type.html) class. It allows extracting the [parameter types](http://asm.ow2.org/asm50/javadoc/user/org/objectweb/asm/Type.html#getArgumentTypes(java.lang.String)) and [return type](http://asm.ow2.org/asm50/javadoc/user/org/objectweb/asm/Type.html#getReturnType(java.lang.String)) from a signature and after applying changes you may [recreate a signature](http://asm.ow2.org/asm50/javadoc/user/org/objectweb/asm/Type.html#getMethodDescriptor(org.objectweb.asm.Type,%20org.objectweb.asm.Type...)).\r\n\r\nSimilarly, [`SignatureReader`](http://asm.ow2.org/asm50/javadoc/user/?org/objectweb/asm/signature/SignatureReader.html) and [`SignatureWriter`](http://asm.ow2.org/asm50/javadoc/user/?org/objectweb/asm/signature/SignatureWriter.html) may help dealing with generic signature in a structural way rather than converting them to textual form and reparsing this form back.\r\n","title":"Pretty-print Java method signature and parse back","body":"<p>If you implement the <a href=\"http://asm.ow2.org/asm50/javadoc/user/org/objectweb/asm/ClassVisitor.html#visitMethod(int,%20java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String%5B%5D)\" rel=\"nofollow noreferrer\">method</a></p>\n<pre><code>public MethodVisitor visitMethod(\n  int access, String name, String desc, String signature, String[] exceptions)\n</code></pre>\n<p>you already have most of the needed information which you can assemble to a human readable declaration. The biggest obstacle is the signature, but thankfully, the ASM library already provides tools helping on this purpose.</p>\n<p>The following code uses <a href=\"http://asm.ow2.org/asm50/javadoc/user/?org/objectweb/asm/signature/SignatureReader.html\" rel=\"nofollow noreferrer\"><code>SignatureReader</code></a> and <a href=\"http://asm.ow2.org/asm50/javadoc/user/?org/objectweb/asm/util/TraceSignatureVisitor.html\" rel=\"nofollow noreferrer\"><code>TraceSignatureVisitor</code></a> to format them. Unfortunately, it requires a bit of post processing as it does not separate type parameters and method parameters and it omits <code>Object</code> return types for non-generic methods. Further, it generates an exception list only if there are generic exceptions, so we have to do it manually otherwise.</p>\n<pre class=\"lang-java prettyprint-override\"><code>static String decode(int access, String name, String desc,\n                     String signature, String[] exceptions) {\n\n    if(signature == null) signature = desc;\n    StringBuilder sb = new StringBuilder();\n    appendModifiers(sb, access);\n    TraceSignatureVisitor v = new TraceSignatureVisitor(0);\n    new SignatureReader(signature).accept(v);\n\n    String declaration = v.getDeclaration(), rType = v.getReturnType();\n    if(declaration.charAt(0) == '&lt;')\n        sb.append(declaration, 0, declaration.indexOf(&quot;(&quot;)).append(' ');\n    else if(rType.isEmpty() || rType.charAt(0) == '[')\n        sb.append(&quot;java.lang.Object&quot;);\n    sb.append(rType).append(' ').append(name)\n      .append(declaration, declaration.indexOf('('), declaration.length());\n    if((access &amp; Opcodes.ACC_VARARGS) != 0 &amp;&amp; declaration.endsWith(&quot;[])&quot;))\n        sb.replace(sb.length() - 3, sb.length(), &quot;...)&quot;);\n    String genericExceptions = v.getExceptions();\n    if(genericExceptions != null &amp;&amp; !v.getDeclaration().isEmpty())\n        sb.append(&quot; throws &quot;).append(genericExceptions);\n    else if(exceptions != null &amp;&amp; exceptions.length &gt; 0) {\n        sb.append(&quot; throws &quot;);\n        int pos = sb.length();\n        for(String e:exceptions) sb.append(e).append(&quot;, &quot;);\n        int e = sb.length() - 2;\n        sb.setLength(e);\n        for(; pos &lt; e; pos++) if(sb.charAt(pos) == '/') sb.setCharAt(pos, '.');\n    }\n    return sb.toString();\n}\n\nprivate static void appendModifiers(StringBuilder buf, int access) {\n    for(int bit; access != 0; access -= bit) {\n        bit = access &amp; -access;\n        buf.append(switch(bit) {\n            case Opcodes.ACC_PUBLIC -&gt; &quot;public &quot;;\n            case Opcodes.ACC_PRIVATE -&gt; &quot;private &quot;;\n            case Opcodes.ACC_PROTECTED -&gt; &quot;protected &quot;;\n            case Opcodes.ACC_STATIC -&gt; &quot;static &quot;;\n            case Opcodes.ACC_FINAL -&gt; &quot;final &quot;;\n            case Opcodes.ACC_ABSTRACT -&gt; &quot;abstract &quot;;\n            case Opcodes.ACC_NATIVE -&gt; &quot;native &quot;;\n            case Opcodes.ACC_SYNCHRONIZED -&gt; &quot;synchronized &quot;;\n            default -&gt; &quot;&quot;;\n        });\n    }\n}\n</code></pre>\n<p><sup>The <code>appendModifiers</code> method has been adapted for recent Java versions, for old versions look <a href=\"https://stackoverflow.com/revisions/33039128/1\">here</a></sup></p>\n<p>It also decodes the modifiers manually, as you can see at the end, but that’s not such a big deal.</p>\n<p>If you test it with:</p>\n<pre><code>String[] exceptions={&quot;java/lang/Exception&quot;};\nSystem.out.println(decode(9, &quot;testMethod&quot;,\n    &quot;(Ljava/lang/Object;)Ljava/lang/Object;&quot;,\n    &quot;&lt;T:Ljava/lang/Object;&gt;(TT;)TT;&quot;, exceptions));\n</code></pre>\n<p>it will print:</p>\n<pre class=\"lang-none prettyprint-override\"><code>public static &lt;T&gt; T testMethod(T) throws java.lang.Exception\n</code></pre>\n<hr />\n<p>When it comes to parsing such a declaration, it gets more complicated. Since you are going to implement an <em>editor</em> rather than an assembler, you may think about the alternative of just providing distinct editors components for the different features, e.g. checkboxes and comboboxes for the modifiers, a textfield for the name and a list editor for the parameter types.</p>\n<p>At this point, I’d recommend studying the <a href=\"http://asm.ow2.org/asm50/javadoc/user/?org/objectweb/asm/Type.html\" rel=\"nofollow noreferrer\"><code>Type</code></a> class. It allows extracting the <a href=\"http://asm.ow2.org/asm50/javadoc/user/org/objectweb/asm/Type.html#getArgumentTypes(java.lang.String)\" rel=\"nofollow noreferrer\">parameter types</a> and <a href=\"http://asm.ow2.org/asm50/javadoc/user/org/objectweb/asm/Type.html#getReturnType(java.lang.String)\" rel=\"nofollow noreferrer\">return type</a> from a signature and after applying changes you may <a href=\"http://asm.ow2.org/asm50/javadoc/user/org/objectweb/asm/Type.html#getMethodDescriptor(org.objectweb.asm.Type,%20org.objectweb.asm.Type...)\" rel=\"nofollow noreferrer\">recreate a signature</a>.</p>\n<p>Similarly, <a href=\"http://asm.ow2.org/asm50/javadoc/user/?org/objectweb/asm/signature/SignatureReader.html\" rel=\"nofollow noreferrer\"><code>SignatureReader</code></a> and <a href=\"http://asm.ow2.org/asm50/javadoc/user/?org/objectweb/asm/signature/SignatureWriter.html\" rel=\"nofollow noreferrer\"><code>SignatureWriter</code></a> may help dealing with generic signature in a structural way rather than converting them to textual form and reparsing this form back.</p>\n"}],"owner":{"account_id":5782371,"reputation":108,"user_id":4562591,"display_name":"BeforeBigBang"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2249,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1689960127,"creation_date":1444336199,"question_id":33025409,"body_markdown":"I&#39;m making a Java bytecode editor that translates bytecode to some sort of intermediate code that can be changed by user, then parse that code back to bytecode. For now, the method declaration looks terrible and hard to read. But, well, it works.\r\n\r\n    method [public,static] testMethod (Ljava/lang/Object;)Ljava/lang/Object; throws [java/lang/Exception] &lt;T:Ljava/lang/Object;&gt;(TT;)TT; \r\n\r\nAs you can see there is a access flags, method name, method description, generics signature and exception that I get from  \r\n\r\n    org.objectweb.asm.ClassVisitor#visitMethod\r\n\r\nIs there a convenient way to make it looks like in a original source code, and then extract from that pretty string all that information back?\r\nThe method above should be like this:\r\n\r\n    public static &lt;T&gt; T testMethod(T) throws Exception\r\nThank you!","title":"Pretty-print Java method signature and parse back","body":"<p>I'm making a Java bytecode editor that translates bytecode to some sort of intermediate code that can be changed by user, then parse that code back to bytecode. For now, the method declaration looks terrible and hard to read. But, well, it works.</p>\n\n<pre><code>method [public,static] testMethod (Ljava/lang/Object;)Ljava/lang/Object; throws [java/lang/Exception] &lt;T:Ljava/lang/Object;&gt;(TT;)TT; \n</code></pre>\n\n<p>As you can see there is a access flags, method name, method description, generics signature and exception that I get from  </p>\n\n<pre><code>org.objectweb.asm.ClassVisitor#visitMethod\n</code></pre>\n\n<p>Is there a convenient way to make it looks like in a original source code, and then extract from that pretty string all that information back?\nThe method above should be like this:</p>\n\n<pre><code>public static &lt;T&gt; T testMethod(T) throws Exception\n</code></pre>\n\n<p>Thank you!</p>\n"},{"tags":["java","maven","maven-3","maven-embedder"],"comments":[{"owner":{"account_id":112317,"reputation":93939,"user_id":296328,"accept_rate":60,"display_name":"khmarbaise"},"score":0,"creation_date":1491515011,"post_id":43264732,"comment_id":73601069,"body_markdown":"What is the purpose of this?","body":"What is the purpose of this?"},{"owner":{"account_id":993136,"reputation":173,"user_id":1009816,"accept_rate":62,"display_name":"xandout"},"score":0,"creation_date":1491538044,"post_id":43264732,"comment_id":73607420,"body_markdown":"I am running this inside of an in house automation system and want to avoid using a process wrapper.","body":"I am running this inside of an in house automation system and want to avoid using a process wrapper."},{"owner":{"account_id":112317,"reputation":93939,"user_id":296328,"accept_rate":60,"display_name":"khmarbaise"},"score":0,"creation_date":1491556725,"post_id":43264732,"comment_id":73616571,"body_markdown":"What is the problem? Why not simply calling maven as usual from command line which works ...The question is what kind of problem are you trying to solve?","body":"What is the problem? Why not simply calling maven as usual from command line which works ...The question is what kind of problem are you trying to solve?"},{"owner":{"account_id":993136,"reputation":173,"user_id":1009816,"accept_rate":62,"display_name":"xandout"},"score":1,"creation_date":1491565138,"post_id":43264732,"comment_id":73622130,"body_markdown":"Because the environments this will run in do not have a maven installation. If I can get this to work then it solves a lot of issues with distribution.","body":"Because the environments this will run in do not have a maven installation. If I can get this to work then it solves a lot of issues with distribution."},{"owner":{"account_id":404649,"reputation":57172,"user_id":773113,"accept_rate":72,"display_name":"Mike Nakis"},"score":0,"creation_date":1613225442,"post_id":43264732,"comment_id":117012957,"body_markdown":"did you get it to work?","body":"did you get it to work?"}],"answers":[{"tags":[],"owner":{"account_id":1428765,"reputation":61,"user_id":1351660,"display_name":"Gonzalo G&#243;mez Garc&#237;a"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1567777656,"creation_date":1501754233,"answer_id":45480847,"question_id":43264732,"body_markdown":"I&#39;ve just hit the same problem as you. I hope it&#39;s not too late for a solution.\r\n\r\nThe problem you got is related to use maven-embedder inside a shade/fatjat/jarwithdependencies\r\n\r\nWhen you create the jar-with-dependencies, some resources may be defined in many jars but only one is packed inside the jar (the last one processed). Here is where the problem lays with the ```META-INF/plexus/components.xml``` and ```META-INF/sisu/javax.inject.Named``` files required by Maven and Plexus\r\n\r\nThe fix this problem you should:\r\n\r\n - Exclude all this files when building the jar-with-dependencies\r\n - Create this files in your project as the concatenations of the files contained in you dependencies. \r\n\r\nIn my case, I use maven-shade-plugin to build the jar-with-dependecies. So to exclude the files from the dependency jars is done this way:\r\n\r\n    \t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\r\n\t\t\t\t&lt;executions&gt;\r\n\t\t\t\t\t&lt;execution&gt;\r\n\t\t\t\t\t\t&lt;phase&gt;package&lt;/phase&gt;\r\n\t\t\t\t\t\t&lt;goals&gt;\r\n\t\t\t\t\t\t\t&lt;goal&gt;shade&lt;/goal&gt;\r\n\t\t\t\t\t\t&lt;/goals&gt;\r\n\t\t\t\t\t\t&lt;configuration&gt;\r\n\t\t\t\t\t\t\t&lt;transformers&gt;\r\n\t\t\t\t\t\t\t\t&lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;manifestEntries&gt;\r\n\t\t\t\t\t\t\t\t\t\t&lt;Main-Class&gt;io.vertx.core.Starter&lt;/Main-Class&gt;\r\n\t\t\t\t\t\t\t\t\t\t&lt;Main-Verticle&gt;main.Main&lt;/Main-Verticle&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;/manifestEntries&gt;\r\n\t\t\t\t\t\t\t\t&lt;/transformer&gt;\r\n\t\t\t\t\t\t\t&lt;/transformers&gt;\r\n\t\t\t\t\t\t\t&lt;filters&gt;\r\n\t\t\t\t\t\t\t\t&lt;filter&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;artifact&gt;*:*&lt;/artifact&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;excludes&gt;\r\n\t\t\t\t\t\t\t\t\t\t&lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t\t&lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t\t&lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;/excludes&gt;\r\n\t\t\t\t\t\t\t\t&lt;/filter&gt;\r\n\t\t\t\t\t\t\t\t&lt;filter&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;artifact&gt;org.sonatype.plexus:*&lt;/artifact&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;excludes&gt;\r\n\t\t\t\t\t\t\t\t\t\t&lt;exclude&gt;META-INF/plexus/components.xml&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t\t&lt;exclude&gt;META-INF/sisu/javax.inject.Named&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;/excludes&gt;\r\n\t\t\t\t\t\t\t\t&lt;/filter&gt;\r\n\t\t\t\t\t\t\t\t&lt;filter&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;artifact&gt;org.apache.maven:*&lt;/artifact&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;excludes&gt;\r\n\t\t\t\t\t\t\t\t\t\t&lt;exclude&gt;META-INF/plexus/components.xml&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t\t&lt;exclude&gt;META-INF/sisu/javax.inject.Named&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;/excludes&gt;\r\n\t\t\t\t\t\t\t\t&lt;/filter&gt;\r\n\t\t\t\t\t\t\t\t&lt;filter&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;artifact&gt;org.eclipse.aether:*&lt;/artifact&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;excludes&gt;\r\n\t\t\t\t\t\t\t\t\t\t&lt;exclude&gt;META-INF/sisu/javax.inject.Named&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;/excludes&gt;\r\n\t\t\t\t\t\t\t\t&lt;/filter&gt;\r\n\t\t\t\t\t\t\t\t&lt;filter&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;artifact&gt;io.vertx:*&lt;/artifact&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;excludes&gt;\r\n\t\t\t\t\t\t\t\t\t\t&lt;exclude&gt;META-INF/sisu/javax.inject.Named&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;/excludes&gt;\r\n\t\t\t\t\t\t\t\t&lt;/filter&gt;\r\n\t\t\t\t\t\t\t&lt;/filters&gt;\r\n\t\t\t\t\t\t\t&lt;artifactSet&gt;\r\n\t\t\t\t\t\t\t\t&lt;excludes&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;exclude&gt;org.eclipse.xpand:*&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;exclude&gt;org.mod4j.org.eclipse.xtend.util:*&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;exclude&gt;com.ibm.icu:*&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;exclude&gt;org.mod4j.*:*&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t\t&lt;exclude&gt;*:*:tests&lt;/exclude&gt;\r\n\t\t\t\t\t\t\t\t&lt;/excludes&gt;\r\n\t\t\t\t\t\t\t&lt;/artifactSet&gt;\r\n\t\t\t              \t\t\t&lt;shadedArtifactAttached&gt;true&lt;/shadedArtifactAttached&gt;\r\n\t\t\t              \t\t\t&lt;shadedClassifierName&gt;fat&lt;/shadedClassifierName&gt;\r\n\t\t\t\t\t\t&lt;/configuration&gt;\r\n\t\t\t\t\t&lt;/execution&gt;\r\n\t\t\t\t&lt;/executions&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\r\nThis way only the ```META-INF/plexus/components.xml``` and ```META-INF/sisu/javax.inject.Named``` created in your project are included in the fatjar\r\n","title":"Maven Embedded 3.3.9 - Is it possible?","body":"<p>I've just hit the same problem as you. I hope it's not too late for a solution.</p>\n\n<p>The problem you got is related to use maven-embedder inside a shade/fatjat/jarwithdependencies</p>\n\n<p>When you create the jar-with-dependencies, some resources may be defined in many jars but only one is packed inside the jar (the last one processed). Here is where the problem lays with the <code>META-INF/plexus/components.xml</code> and <code>META-INF/sisu/javax.inject.Named</code> files required by Maven and Plexus</p>\n\n<p>The fix this problem you should:</p>\n\n<ul>\n<li>Exclude all this files when building the jar-with-dependencies</li>\n<li>Create this files in your project as the concatenations of the files contained in you dependencies. </li>\n</ul>\n\n<p>In my case, I use maven-shade-plugin to build the jar-with-dependecies. So to exclude the files from the dependency jars is done this way:</p>\n\n<pre><code>            &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n            &lt;executions&gt;\n                &lt;execution&gt;\n                    &lt;phase&gt;package&lt;/phase&gt;\n                    &lt;goals&gt;\n                        &lt;goal&gt;shade&lt;/goal&gt;\n                    &lt;/goals&gt;\n                    &lt;configuration&gt;\n                        &lt;transformers&gt;\n                            &lt;transformer implementation=\"org.apache.maven.plugins.shade.resource.ManifestResourceTransformer\"&gt;\n                                &lt;manifestEntries&gt;\n                                    &lt;Main-Class&gt;io.vertx.core.Starter&lt;/Main-Class&gt;\n                                    &lt;Main-Verticle&gt;main.Main&lt;/Main-Verticle&gt;\n                                &lt;/manifestEntries&gt;\n                            &lt;/transformer&gt;\n                        &lt;/transformers&gt;\n                        &lt;filters&gt;\n                            &lt;filter&gt;\n                                &lt;artifact&gt;*:*&lt;/artifact&gt;\n                                &lt;excludes&gt;\n                                    &lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;\n                                    &lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;\n                                    &lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt;\n                                &lt;/excludes&gt;\n                            &lt;/filter&gt;\n                            &lt;filter&gt;\n                                &lt;artifact&gt;org.sonatype.plexus:*&lt;/artifact&gt;\n                                &lt;excludes&gt;\n                                    &lt;exclude&gt;META-INF/plexus/components.xml&lt;/exclude&gt;\n                                    &lt;exclude&gt;META-INF/sisu/javax.inject.Named&lt;/exclude&gt;\n                                &lt;/excludes&gt;\n                            &lt;/filter&gt;\n                            &lt;filter&gt;\n                                &lt;artifact&gt;org.apache.maven:*&lt;/artifact&gt;\n                                &lt;excludes&gt;\n                                    &lt;exclude&gt;META-INF/plexus/components.xml&lt;/exclude&gt;\n                                    &lt;exclude&gt;META-INF/sisu/javax.inject.Named&lt;/exclude&gt;\n                                &lt;/excludes&gt;\n                            &lt;/filter&gt;\n                            &lt;filter&gt;\n                                &lt;artifact&gt;org.eclipse.aether:*&lt;/artifact&gt;\n                                &lt;excludes&gt;\n                                    &lt;exclude&gt;META-INF/sisu/javax.inject.Named&lt;/exclude&gt;\n                                &lt;/excludes&gt;\n                            &lt;/filter&gt;\n                            &lt;filter&gt;\n                                &lt;artifact&gt;io.vertx:*&lt;/artifact&gt;\n                                &lt;excludes&gt;\n                                    &lt;exclude&gt;META-INF/sisu/javax.inject.Named&lt;/exclude&gt;\n                                &lt;/excludes&gt;\n                            &lt;/filter&gt;\n                        &lt;/filters&gt;\n                        &lt;artifactSet&gt;\n                            &lt;excludes&gt;\n                                &lt;exclude&gt;org.eclipse.xpand:*&lt;/exclude&gt;\n                                &lt;exclude&gt;org.mod4j.org.eclipse.xtend.util:*&lt;/exclude&gt;\n                                &lt;exclude&gt;com.ibm.icu:*&lt;/exclude&gt;\n                                &lt;exclude&gt;org.mod4j.*:*&lt;/exclude&gt;\n                                &lt;exclude&gt;*:*:tests&lt;/exclude&gt;\n                            &lt;/excludes&gt;\n                        &lt;/artifactSet&gt;\n                                &lt;shadedArtifactAttached&gt;true&lt;/shadedArtifactAttached&gt;\n                                &lt;shadedClassifierName&gt;fat&lt;/shadedClassifierName&gt;\n                    &lt;/configuration&gt;\n                &lt;/execution&gt;\n            &lt;/executions&gt;\n        &lt;/plugin&gt;\n</code></pre>\n\n<p>This way only the <code>META-INF/plexus/components.xml</code> and <code>META-INF/sisu/javax.inject.Named</code> created in your project are included in the fatjar</p>\n"},{"tags":[],"owner":{"account_id":17207292,"reputation":1,"user_id":12457562,"display_name":"Ian Page"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689958964,"creation_date":1689958938,"answer_id":76739882,"question_id":43264732,"body_markdown":"I had the same issue.  However I was using Spring Boot, so was able to use the repackage goal of the spring-boot-maven-plugin to build my fat jar, rather than the maven-assembly-plugin or the maven-shade-plugin.\r\n\r\n&lt;!-- begin snippet: js hide: false console: true babel: false --&gt;\r\n&lt;!-- language: xml --&gt;\r\n\r\n      &lt;build&gt;\r\n        &lt;plugins&gt;\r\n          &lt;plugin&gt;\r\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n            &lt;configuration&gt;    \r\n              &lt;mainClass&gt;com.acme.test.Application&lt;/mainClass&gt;\r\n            &lt;/configuration&gt;\r\n            &lt;executions&gt;\r\n              &lt;execution&gt;\r\n                &lt;goals&gt;\r\n                  &lt;goal&gt;repackage&lt;/goal&gt;\r\n                &lt;/goals&gt;\r\n              &lt;/execution&gt;\r\n            &lt;/executions&gt;\r\n          &lt;/plugin&gt;\r\n        &lt;/plugins&gt;\r\n      &lt;/build&gt;\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\n","title":"Maven Embedded 3.3.9 - Is it possible?","body":"<p>I had the same issue.  However I was using Spring Boot, so was able to use the repackage goal of the spring-boot-maven-plugin to build my fat jar, rather than the maven-assembly-plugin or the maven-shade-plugin.</p>\n<pre class=\"lang-xml prettyprint-override\"><code>  &lt;build&gt;\n    &lt;plugins&gt;\n      &lt;plugin&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n        &lt;configuration&gt;    \n          &lt;mainClass&gt;com.acme.test.Application&lt;/mainClass&gt;\n        &lt;/configuration&gt;\n        &lt;executions&gt;\n          &lt;execution&gt;\n            &lt;goals&gt;\n              &lt;goal&gt;repackage&lt;/goal&gt;\n            &lt;/goals&gt;\n          &lt;/execution&gt;\n        &lt;/executions&gt;\n      &lt;/plugin&gt;\n    &lt;/plugins&gt;\n  &lt;/build&gt;\n</code></pre>\n"}],"owner":{"account_id":993136,"reputation":173,"user_id":1009816,"accept_rate":62,"display_name":"xandout"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1569,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1689958964,"creation_date":1491508760,"question_id":43264732,"body_markdown":"So I am trying to embed maven in my code rather than use a shell wrapper however I am having issues getting it to actually work.\r\n\r\n[Source Code](https://github.com/tc-turner/maven-embedder-otg/tree/339)\r\n\r\nThe `master` branch works however it is an older version of maven (3.1.1) and I would like to use a more recent version.\r\n\r\nThe `339` branch has every dependency that I can pin down for that version defined in pom.xml.\r\n\r\nHowever no amount of playing with the dependencies will help avoid the following error.\r\n\r\n    java -jar maven-embedder-example-1-jar-with-dependencies.jar package\r\n    [main] WARN Sisu - Error injecting: org.apache.maven.project.DefaultProjectBuildingHelper\r\n    com.google.inject.ProvisionException: Unable to provision, see the following errors:\r\n    \r\n    1) No implementation for org.apache.maven.classrealm.ClassRealmManager was bound.\r\n      while locating org.apache.maven.project.DefaultProjectBuildingHelper\r\n    \r\n    1 error\r\n        at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1025)\r\n        at com.google.inject.internal.InjectorImpl.getInstance(InjectorImpl.java:1051)\r\n        at org.eclipse.sisu.space.AbstractDeferredClass.get(AbstractDeferredClass.java:48)\r\n        at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81)\r\n        at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53)\r\n        at com.google.inject.internal.ProviderInternalFactory$1.call(ProviderInternalFactory.java:65)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:115)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:133)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback.provision(ProvisionListenerStackCallback.java:68)\r\n        at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:63)\r\n        at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45)\r\n        at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)\r\n        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\r\n        at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)\r\n        at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145)\r\n        at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)\r\n        at com.google.inject.internal.InjectorImpl$2$1.call(InjectorImpl.java:1016)\r\n        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\r\n        at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1012)\r\n        at org.eclipse.sisu.inject.LazyBeanEntry.getValue(LazyBeanEntry.java:81)\r\n        at org.eclipse.sisu.plexus.LazyPlexusBean.getValue(LazyPlexusBean.java:51)\r\n        at org.eclipse.sisu.plexus.PlexusRequirements$RequirementProvider.get(PlexusRequirements.java:250)\r\n        at org.eclipse.sisu.plexus.ProvidedPropertyBinding.injectProperty(ProvidedPropertyBinding.java:48)\r\n        at org.eclipse.sisu.bean.BeanInjector.injectMembers(BeanInjector.java:52)\r\n        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:140)\r\n        at com.google.inject.internal.ConstructorInjector.provision(ConstructorInjector.java:114)\r\n        at com.google.inject.internal.ConstructorInjector.access$000(ConstructorInjector.java:32)\r\n        at com.google.inject.internal.ConstructorInjector$1.call(ConstructorInjector.java:89)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:115)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:133)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback.provision(ProvisionListenerStackCallback.java:68)\r\n        at com.google.inject.internal.ConstructorInjector.construct(ConstructorInjector.java:87)\r\n        at com.google.inject.internal.ConstructorBindingImpl$Factory.get(ConstructorBindingImpl.java:267)\r\n        at com.google.inject.internal.InjectorImpl$2$1.call(InjectorImpl.java:1016)\r\n        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\r\n        at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1012)\r\n        at com.google.inject.internal.InjectorImpl.getInstance(InjectorImpl.java:1051)\r\n        at org.eclipse.sisu.space.AbstractDeferredClass.get(AbstractDeferredClass.java:48)\r\n        at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81)\r\n        at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53)\r\n        at com.google.inject.internal.ProviderInternalFactory$1.call(ProviderInternalFactory.java:65)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:115)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:133)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback.provision(ProvisionListenerStackCallback.java:68)\r\n        at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:63)\r\n        at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45)\r\n        at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)\r\n        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\r\n        at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)\r\n        at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145)\r\n        at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)\r\n        at com.google.inject.internal.InjectorImpl$2$1.call(InjectorImpl.java:1016)\r\n        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\r\n        at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1012)\r\n        at org.eclipse.sisu.inject.LazyBeanEntry.getValue(LazyBeanEntry.java:81)\r\n        at org.eclipse.sisu.plexus.LazyPlexusBean.getValue(LazyPlexusBean.java:51)\r\n        at org.eclipse.sisu.plexus.PlexusRequirements$RequirementProvider.get(PlexusRequirements.java:250)\r\n        at org.eclipse.sisu.plexus.ProvidedPropertyBinding.injectProperty(ProvidedPropertyBinding.java:48)\r\n        at org.eclipse.sisu.bean.BeanInjector.injectMembers(BeanInjector.java:52)\r\n        at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:140)\r\n        at com.google.inject.internal.ConstructorInjector.provision(ConstructorInjector.java:114)\r\n        at com.google.inject.internal.ConstructorInjector.access$000(ConstructorInjector.java:32)\r\n        at com.google.inject.internal.ConstructorInjector$1.call(ConstructorInjector.java:89)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:115)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:133)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback.provision(ProvisionListenerStackCallback.java:68)\r\n        at com.google.inject.internal.ConstructorInjector.construct(ConstructorInjector.java:87)\r\n        at com.google.inject.internal.ConstructorBindingImpl$Factory.get(ConstructorBindingImpl.java:267)\r\n        at com.google.inject.internal.InjectorImpl$2$1.call(InjectorImpl.java:1016)\r\n        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\r\n        at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1012)\r\n        at com.google.inject.internal.InjectorImpl.getInstance(InjectorImpl.java:1051)\r\n        at org.eclipse.sisu.space.AbstractDeferredClass.get(AbstractDeferredClass.java:48)\r\n        at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81)\r\n        at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53)\r\n        at com.google.inject.internal.ProviderInternalFactory$1.call(ProviderInternalFactory.java:65)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:115)\r\n        at org.eclipse.sisu.bean.BeanScheduler$Activator.onProvision(BeanScheduler.java:176)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:126)\r\n        at com.google.inject.internal.ProvisionListenerStackCallback.provision(ProvisionListenerStackCallback.java:68)\r\n        at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:63)\r\n        at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45)\r\n        at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)\r\n        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\r\n        at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)\r\n        at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145)\r\n        at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)\r\n        at com.google.inject.internal.InjectorImpl$2$1.call(InjectorImpl.java:1016)\r\n        at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1092)\r\n        at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1012)\r\n        at org.eclipse.sisu.inject.LazyBeanEntry.getValue(LazyBeanEntry.java:81)\r\n        at org.eclipse.sisu.plexus.LazyPlexusBean.getValue(LazyPlexusBean.java:51)\r\n        at org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:263)\r\n        at org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:255)\r\n        at org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:249)\r\n        at org.apache.maven.cli.MavenCli.container(MavenCli.java:585)\r\n        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:281)\r\n        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:243)\r\n        at tc_turner.maven_embedder_example.Main.main(Main.java:10)\r\n    [main] WARN Sisu - Error injecting: org.apache.maven.project.DefaultProjectBuilder\r\n    com.google.inject.ProvisionException: Unable to provision, see the following errors: ....... More of the same\r\n\r\n\r\n\r\nI have gone through every SO question I can find and read lots of mailing lists but it seems like very few people want to do this or I am just failing.\r\n\r\nDo you fine folks have any idea?","title":"Maven Embedded 3.3.9 - Is it possible?","body":"<p>So I am trying to embed maven in my code rather than use a shell wrapper however I am having issues getting it to actually work.</p>\n\n<p><a href=\"https://github.com/tc-turner/maven-embedder-otg/tree/339\" rel=\"nofollow noreferrer\">Source Code</a></p>\n\n<p>The <code>master</code> branch works however it is an older version of maven (3.1.1) and I would like to use a more recent version.</p>\n\n<p>The <code>339</code> branch has every dependency that I can pin down for that version defined in pom.xml.</p>\n\n<p>However no amount of playing with the dependencies will help avoid the following error.</p>\n\n<pre><code>java -jar maven-embedder-example-1-jar-with-dependencies.jar package\n[main] WARN Sisu - Error injecting: org.apache.maven.project.DefaultProjectBuildingHelper\ncom.google.inject.ProvisionException: Unable to provision, see the following errors:\n\n1) No implementation for org.apache.maven.classrealm.ClassRealmManager was bound.\n  while locating org.apache.maven.project.DefaultProjectBuildingHelper\n\n1 error\n    at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1025)\n    at com.google.inject.internal.InjectorImpl.getInstance(InjectorImpl.java:1051)\n    at org.eclipse.sisu.space.AbstractDeferredClass.get(AbstractDeferredClass.java:48)\n    at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81)\n    at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53)\n    at com.google.inject.internal.ProviderInternalFactory$1.call(ProviderInternalFactory.java:65)\n    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:115)\n    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:133)\n    at com.google.inject.internal.ProvisionListenerStackCallback.provision(ProvisionListenerStackCallback.java:68)\n    at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:63)\n    at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45)\n    at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)\n    at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\n    at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)\n    at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145)\n    at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)\n    at com.google.inject.internal.InjectorImpl$2$1.call(InjectorImpl.java:1016)\n    at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\n    at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1012)\n    at org.eclipse.sisu.inject.LazyBeanEntry.getValue(LazyBeanEntry.java:81)\n    at org.eclipse.sisu.plexus.LazyPlexusBean.getValue(LazyPlexusBean.java:51)\n    at org.eclipse.sisu.plexus.PlexusRequirements$RequirementProvider.get(PlexusRequirements.java:250)\n    at org.eclipse.sisu.plexus.ProvidedPropertyBinding.injectProperty(ProvidedPropertyBinding.java:48)\n    at org.eclipse.sisu.bean.BeanInjector.injectMembers(BeanInjector.java:52)\n    at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:140)\n    at com.google.inject.internal.ConstructorInjector.provision(ConstructorInjector.java:114)\n    at com.google.inject.internal.ConstructorInjector.access$000(ConstructorInjector.java:32)\n    at com.google.inject.internal.ConstructorInjector$1.call(ConstructorInjector.java:89)\n    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:115)\n    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:133)\n    at com.google.inject.internal.ProvisionListenerStackCallback.provision(ProvisionListenerStackCallback.java:68)\n    at com.google.inject.internal.ConstructorInjector.construct(ConstructorInjector.java:87)\n    at com.google.inject.internal.ConstructorBindingImpl$Factory.get(ConstructorBindingImpl.java:267)\n    at com.google.inject.internal.InjectorImpl$2$1.call(InjectorImpl.java:1016)\n    at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\n    at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1012)\n    at com.google.inject.internal.InjectorImpl.getInstance(InjectorImpl.java:1051)\n    at org.eclipse.sisu.space.AbstractDeferredClass.get(AbstractDeferredClass.java:48)\n    at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81)\n    at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53)\n    at com.google.inject.internal.ProviderInternalFactory$1.call(ProviderInternalFactory.java:65)\n    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:115)\n    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:133)\n    at com.google.inject.internal.ProvisionListenerStackCallback.provision(ProvisionListenerStackCallback.java:68)\n    at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:63)\n    at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45)\n    at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)\n    at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\n    at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)\n    at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145)\n    at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)\n    at com.google.inject.internal.InjectorImpl$2$1.call(InjectorImpl.java:1016)\n    at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\n    at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1012)\n    at org.eclipse.sisu.inject.LazyBeanEntry.getValue(LazyBeanEntry.java:81)\n    at org.eclipse.sisu.plexus.LazyPlexusBean.getValue(LazyPlexusBean.java:51)\n    at org.eclipse.sisu.plexus.PlexusRequirements$RequirementProvider.get(PlexusRequirements.java:250)\n    at org.eclipse.sisu.plexus.ProvidedPropertyBinding.injectProperty(ProvidedPropertyBinding.java:48)\n    at org.eclipse.sisu.bean.BeanInjector.injectMembers(BeanInjector.java:52)\n    at com.google.inject.internal.MembersInjectorImpl.injectMembers(MembersInjectorImpl.java:140)\n    at com.google.inject.internal.ConstructorInjector.provision(ConstructorInjector.java:114)\n    at com.google.inject.internal.ConstructorInjector.access$000(ConstructorInjector.java:32)\n    at com.google.inject.internal.ConstructorInjector$1.call(ConstructorInjector.java:89)\n    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:115)\n    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:133)\n    at com.google.inject.internal.ProvisionListenerStackCallback.provision(ProvisionListenerStackCallback.java:68)\n    at com.google.inject.internal.ConstructorInjector.construct(ConstructorInjector.java:87)\n    at com.google.inject.internal.ConstructorBindingImpl$Factory.get(ConstructorBindingImpl.java:267)\n    at com.google.inject.internal.InjectorImpl$2$1.call(InjectorImpl.java:1016)\n    at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\n    at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1012)\n    at com.google.inject.internal.InjectorImpl.getInstance(InjectorImpl.java:1051)\n    at org.eclipse.sisu.space.AbstractDeferredClass.get(AbstractDeferredClass.java:48)\n    at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:81)\n    at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:53)\n    at com.google.inject.internal.ProviderInternalFactory$1.call(ProviderInternalFactory.java:65)\n    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:115)\n    at org.eclipse.sisu.bean.BeanScheduler$Activator.onProvision(BeanScheduler.java:176)\n    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:126)\n    at com.google.inject.internal.ProvisionListenerStackCallback.provision(ProvisionListenerStackCallback.java:68)\n    at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:63)\n    at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45)\n    at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46)\n    at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1103)\n    at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40)\n    at com.google.inject.internal.SingletonScope$1.get(SingletonScope.java:145)\n    at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:41)\n    at com.google.inject.internal.InjectorImpl$2$1.call(InjectorImpl.java:1016)\n    at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1092)\n    at com.google.inject.internal.InjectorImpl$2.get(InjectorImpl.java:1012)\n    at org.eclipse.sisu.inject.LazyBeanEntry.getValue(LazyBeanEntry.java:81)\n    at org.eclipse.sisu.plexus.LazyPlexusBean.getValue(LazyPlexusBean.java:51)\n    at org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:263)\n    at org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:255)\n    at org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:249)\n    at org.apache.maven.cli.MavenCli.container(MavenCli.java:585)\n    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:281)\n    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:243)\n    at tc_turner.maven_embedder_example.Main.main(Main.java:10)\n[main] WARN Sisu - Error injecting: org.apache.maven.project.DefaultProjectBuilder\ncom.google.inject.ProvisionException: Unable to provision, see the following errors: ....... More of the same\n</code></pre>\n\n<p>I have gone through every SO question I can find and read lots of mailing lists but it seems like very few people want to do this or I am just failing.</p>\n\n<p>Do you fine folks have any idea?</p>\n"},{"tags":["java","python","jython"],"comments":[{"owner":{"account_id":220789,"reputation":114430,"user_id":478399,"accept_rate":83,"display_name":"AlexR"},"score":4,"creation_date":1326820546,"post_id":8898765,"comment_id":11128734,"body_markdown":"Please take a look on similar question and read the answer. http://bytes.com/topic/python/answers/22390-executing-jython-function-java","body":"Please take a look on similar question and read the answer. <a href=\"http://bytes.com/topic/python/answers/22390-executing-jython-function-java\" rel=\"nofollow noreferrer\">bytes.com/topic/python/answers/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":255877,"reputation":6710,"user_id":536205,"accept_rate":83,"display_name":"nidhin"},"down_vote_count":2,"up_vote_count":5,"is_accepted":false,"score":3,"last_activity_date":1326820669,"creation_date":1326820669,"answer_id":8898882,"question_id":8898765,"body_markdown":"You can call any language from java using [Java Native Interface][1]\r\n\r\n\r\n  [1]: http://en.wikipedia.org/wiki/Java_Native_Interface","title":"Calling Python in Java?","body":"<p>You can call any language from java using <a href=\"http://en.wikipedia.org/wiki/Java_Native_Interface\" rel=\"nofollow noreferrer\">Java Native Interface</a></p>\n"},{"tags":[],"owner":{"account_id":48693,"reputation":29189,"user_id":144746,"accept_rate":93,"display_name":"Voo"},"down_vote_count":2,"up_vote_count":114,"is_accepted":true,"score":112,"last_activity_date":1623240702,"creation_date":1326821481,"answer_id":8899042,"question_id":8898765,"body_markdown":"Jython: Python for the Java Platform - http://www.jython.org/index.html\r\n\r\nYou can easily call python functions from Java code with Jython. That is as long as your python code itself runs under jython, i.e. doesn&#39;t use some c-extensions that aren&#39;t supported.\r\n\r\nIf that works for you, it&#39;s certainly the simplest solution you can get. Otherwise you can use `org.python.util.PythonInterpreter` from the new Java6 interpreter support.\r\n\r\nA simple example from the top of my head - but should work I hope: (no error checking done for brevity)\r\n\r\n    PythonInterpreter interpreter = new PythonInterpreter();\r\n    interpreter.exec(&quot;import sys\\nsys.path.append(&#39;pathToModules if they are not there by default&#39;)\\nimport yourModule&quot;);\r\n    // execute a function that takes a string and returns a string\r\n    PyObject someFunc = interpreter.get(&quot;funcName&quot;);\r\n    PyObject result = someFunc.__call__(new PyString(&quot;Test!&quot;));\r\n    String realResult = (String) result.__tojava__(String.class);\r\n\r\nAs of 2021, Jython does not support Python 3.x","title":"Calling Python in Java?","body":"<p>Jython: Python for the Java Platform - <a href=\"http://www.jython.org/index.html\" rel=\"noreferrer\">http://www.jython.org/index.html</a></p>\n<p>You can easily call python functions from Java code with Jython. That is as long as your python code itself runs under jython, i.e. doesn't use some c-extensions that aren't supported.</p>\n<p>If that works for you, it's certainly the simplest solution you can get. Otherwise you can use <code>org.python.util.PythonInterpreter</code> from the new Java6 interpreter support.</p>\n<p>A simple example from the top of my head - but should work I hope: (no error checking done for brevity)</p>\n<pre><code>PythonInterpreter interpreter = new PythonInterpreter();\ninterpreter.exec(&quot;import sys\\nsys.path.append('pathToModules if they are not there by default')\\nimport yourModule&quot;);\n// execute a function that takes a string and returns a string\nPyObject someFunc = interpreter.get(&quot;funcName&quot;);\nPyObject result = someFunc.__call__(new PyString(&quot;Test!&quot;));\nString realResult = (String) result.__tojava__(String.class);\n</code></pre>\n<p>As of 2021, Jython does not support Python 3.x</p>\n"},{"tags":[],"owner":{"account_id":4581,"reputation":86504,"user_id":6946,"accept_rate":89,"display_name":"Anurag Uniyal"},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1326821708,"creation_date":1326821708,"answer_id":8899086,"question_id":8898765,"body_markdown":"It depends on what do you mean by python functions? if they were written in [cpython][1] you can not directly call them you will have to use [JNI][2], but if they were written in [Jython][3] you can easily call them from java, as jython ultimately generates java byte code.\r\n\r\nNow when I say written in cpython or jython it doesn&#39;t make much sense because python is python and most code will run on both implementations unless you are using specific libraries which relies on cpython or java.\r\n\r\nsee here [how to use Python interpreter in Java.][4]\r\n\r\n\r\n  [1]: http://python.org/\r\n  [2]: http://en.wikipedia.org/wiki/Java_Native_Interface\r\n  [3]: http://www.jython.org/\r\n  [4]: http://www.jython.org/jythonbook/en/1.0/JythonAndJavaIntegration.html#utilizing-pythoninterpreter","title":"Calling Python in Java?","body":"<p>It depends on what do you mean by python functions? if they were written in <a href=\"http://python.org/\" rel=\"noreferrer\">cpython</a> you can not directly call them you will have to use <a href=\"http://en.wikipedia.org/wiki/Java_Native_Interface\" rel=\"noreferrer\">JNI</a>, but if they were written in <a href=\"http://www.jython.org/\" rel=\"noreferrer\">Jython</a> you can easily call them from java, as jython ultimately generates java byte code.</p>\n\n<p>Now when I say written in cpython or jython it doesn't make much sense because python is python and most code will run on both implementations unless you are using specific libraries which relies on cpython or java.</p>\n\n<p>see here <a href=\"http://www.jython.org/jythonbook/en/1.0/JythonAndJavaIntegration.html#utilizing-pythoninterpreter\" rel=\"noreferrer\">how to use Python interpreter in Java.</a></p>\n"},{"tags":[],"owner":{"account_id":309464,"reputation":5258,"user_id":621917,"accept_rate":88,"display_name":"Timo"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1354796744,"creation_date":1354796744,"answer_id":13743612,"question_id":8898765,"body_markdown":"Depending on your requirements, options like [XML-RPC][1] could be useful, which can be used to remotely call functions virtually in any language supporting the protocol.\r\n\r\n\r\n  [1]: http://en.wikipedia.org/wiki/XML-RPC","title":"Calling Python in Java?","body":"<p>Depending on your requirements, options like <a href=\"http://en.wikipedia.org/wiki/XML-RPC\" rel=\"noreferrer\">XML-RPC</a> could be useful, which can be used to remotely call functions virtually in any language supporting the protocol.</p>\n"},{"tags":[],"owner":{"account_id":5019425,"reputation":7741,"user_id":4033292,"accept_rate":81,"display_name":"Derrops"},"down_vote_count":0,"up_vote_count":73,"is_accepted":false,"score":73,"last_activity_date":1689958229,"creation_date":1415197562,"answer_id":26759569,"question_id":8898765,"body_markdown":"I think there are some important things to consider first with how strong you wish to have the linking between Java and Python.\r\n\r\n**Firstly**  Do you only want to call functions or do you actually want Python code to change the data in your java objects? This is very important. If you only want to call some Python code with or without arguments, then that is not very difficult. If your arguments are primitives it makes it even more easy. However, if you want to have Java class implement member functions in Python, which change the data of the Java object, then this is not so easy or straight forward.\r\n\r\n**Secondly** are we talking CPython, or will Jython do? I would say CPython is where its at! I would advocate this is why Python is so kool! Having such high abstractions however access to C or C++ when needed. Imagine if you could have that in Java. This question is not even worth asking if Jython is ok because then it is easy anyway.\r\n\r\nSo I have played with the following methods, and listed them from easy to difficult:\r\n\r\n\r\n\r\n\r\n**Java to Jython**\r\n\r\n*Advantages:* Trivially easy. Have actual references to Java objects\r\n\r\n*Disadvantages:* No CPython, Extremely Slow!\r\n\r\nJython from Java is so easy, and if this is really enough then great. However it is very slow and no CPython! Is life worth living without CPython? I don&#39;t think so! You can easily have Python code implementing your member functions for you Java objects.\r\n\r\n**Java to Jython to CPython via Pyro**\r\n\r\n\r\nPyro is the remote object module for Python. You have some object on a CPython interpreter, and you can send it objects which are transferred via serialization and it can also return objects via this method. Note that if you send a serialized Python object from Jython and then call some functions which change the data in its members, then you will not see those changes in Java. You just need to remember to send back the data which you want from Pyro. This, I believe, is the easiest way to get to CPython! You do not need any JNI or JNA or SWIG or .... You don&#39;t need to know any C, or C++. Kool huh?\r\n\r\n*Advantages:*\r\n\r\n - Access to CPython\r\n - Not as difficult as following methods\r\n\r\n*Disadvantages:*\r\n - Cannot change the member data of Java objects directly from Python\r\n - Is somewhat indirect (Jython is middle man)\r\n\r\n**Java to C/C++ via JNI/JNA/SWIG to Python via Embedded interpreter (maybe using BOOST Libraries?)**\r\n\r\n  OMG this method is not for the faint of heart. And I can tell you it has taken me very long to achieve this in with a decent method. Main reason you would want to do this is so that you can run CPython code which as full rein over you java object. There are  major things to consider before deciding to try and breed Java (which is like a chimp) with Python (which is like a horse). Firstly if you crash the interpreter, that&#39;s lights out for you program! And don&#39;t get me started on concurrency issues! In addition, there is a lot of boiler, I believe I have found the best configuration to minimize this boiler but it is still a lot! So how to go about this:\r\nConsider that C++ is your middle man, your objects are actually C++ objects! Good that you know that now. Just write your object as if your program is in C++ and not Java, with the data you want to access from both worlds. Then you can use the wrapper generator called [SWIG](http://www.swig.org/Doc1.3/Java.html) to make this accessible to java and compile a dll which you call (`System.load(dllNameHere)`) in Java. Get this working first, then move on to the hard part!\r\nTo get to Python you need to embed an interpreter. Firstly I suggest doing some hello interpreter programs or this tutorial [Embedding Python in C/C][2]. Once you have that working, its time to make the horse and the monkey dance! You can send you C++ object to Python via [boost][3] . I know I have not given you the fish, merely told you where to find the fish. Some pointers to note for this when compiling.\r\n\r\nWhen you compile boost you will need to compile a shared library. And you need to include and link to the stuff you need from jdk, ie jawt.lib, jvm.lib, (you will also need the client jvm.dll in your path when launching the application) As well as the python27.lib or whatever and the boost_python-vc100-mt-1_55.lib.\r\nThen include Python/include, jdk/include, boost and only use shared libraries (dlls) otherwise boost has a teary. And yeah full on I know. There are so many ways in which this can go sour. So make sure you get each thing done block by block. Then put them together. \r\n\r\n\r\n  [1]: http://www.codeproject.com/Articles/11805/Embedding-Python-in-C-C-Part-I\r\n  [2]: http://www.boost.org/doc/libs/1_57_0/libs/python/doc/tutorial/doc/html/python","title":"Calling Python in Java?","body":"<p>I think there are some important things to consider first with how strong you wish to have the linking between Java and Python.</p>\n<p><strong>Firstly</strong>  Do you only want to call functions or do you actually want Python code to change the data in your java objects? This is very important. If you only want to call some Python code with or without arguments, then that is not very difficult. If your arguments are primitives it makes it even more easy. However, if you want to have Java class implement member functions in Python, which change the data of the Java object, then this is not so easy or straight forward.</p>\n<p><strong>Secondly</strong> are we talking CPython, or will Jython do? I would say CPython is where its at! I would advocate this is why Python is so kool! Having such high abstractions however access to C or C++ when needed. Imagine if you could have that in Java. This question is not even worth asking if Jython is ok because then it is easy anyway.</p>\n<p>So I have played with the following methods, and listed them from easy to difficult:</p>\n<p><strong>Java to Jython</strong></p>\n<p><em>Advantages:</em> Trivially easy. Have actual references to Java objects</p>\n<p><em>Disadvantages:</em> No CPython, Extremely Slow!</p>\n<p>Jython from Java is so easy, and if this is really enough then great. However it is very slow and no CPython! Is life worth living without CPython? I don't think so! You can easily have Python code implementing your member functions for you Java objects.</p>\n<p><strong>Java to Jython to CPython via Pyro</strong></p>\n<p>Pyro is the remote object module for Python. You have some object on a CPython interpreter, and you can send it objects which are transferred via serialization and it can also return objects via this method. Note that if you send a serialized Python object from Jython and then call some functions which change the data in its members, then you will not see those changes in Java. You just need to remember to send back the data which you want from Pyro. This, I believe, is the easiest way to get to CPython! You do not need any JNI or JNA or SWIG or .... You don't need to know any C, or C++. Kool huh?</p>\n<p><em>Advantages:</em></p>\n<ul>\n<li>Access to CPython</li>\n<li>Not as difficult as following methods</li>\n</ul>\n<p><em>Disadvantages:</em></p>\n<ul>\n<li>Cannot change the member data of Java objects directly from Python</li>\n<li>Is somewhat indirect (Jython is middle man)</li>\n</ul>\n<p><strong>Java to C/C++ via JNI/JNA/SWIG to Python via Embedded interpreter (maybe using BOOST Libraries?)</strong></p>\n<p>OMG this method is not for the faint of heart. And I can tell you it has taken me very long to achieve this in with a decent method. Main reason you would want to do this is so that you can run CPython code which as full rein over you java object. There are  major things to consider before deciding to try and breed Java (which is like a chimp) with Python (which is like a horse). Firstly if you crash the interpreter, that's lights out for you program! And don't get me started on concurrency issues! In addition, there is a lot of boiler, I believe I have found the best configuration to minimize this boiler but it is still a lot! So how to go about this:\nConsider that C++ is your middle man, your objects are actually C++ objects! Good that you know that now. Just write your object as if your program is in C++ and not Java, with the data you want to access from both worlds. Then you can use the wrapper generator called <a href=\"http://www.swig.org/Doc1.3/Java.html\" rel=\"nofollow noreferrer\">SWIG</a> to make this accessible to java and compile a dll which you call (<code>System.load(dllNameHere)</code>) in Java. Get this working first, then move on to the hard part!\nTo get to Python you need to embed an interpreter. Firstly I suggest doing some hello interpreter programs or this tutorial <a href=\"http://www.boost.org/doc/libs/1_57_0/libs/python/doc/tutorial/doc/html/python\" rel=\"nofollow noreferrer\">Embedding Python in C/C</a>. Once you have that working, its time to make the horse and the monkey dance! You can send you C++ object to Python via [boost][3] . I know I have not given you the fish, merely told you where to find the fish. Some pointers to note for this when compiling.</p>\n<p>When you compile boost you will need to compile a shared library. And you need to include and link to the stuff you need from jdk, ie jawt.lib, jvm.lib, (you will also need the client jvm.dll in your path when launching the application) As well as the python27.lib or whatever and the boost_python-vc100-mt-1_55.lib.\nThen include Python/include, jdk/include, boost and only use shared libraries (dlls) otherwise boost has a teary. And yeah full on I know. There are so many ways in which this can go sour. So make sure you get each thing done block by block. Then put them together.</p>\n"},{"tags":[],"owner":{"account_id":55163,"reputation":1777,"user_id":165130,"accept_rate":40,"display_name":"alex"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1444081031,"creation_date":1444080729,"answer_id":32958257,"question_id":8898765,"body_markdown":"Jython has some limitations:\r\n\r\n&gt; There are a number of differences. First, Jython programs cannot use CPython \r\nextension modules written in C. These modules usually have files with the\r\nextension .so, .pyd or .dll. If you want to use such a module, you should look \r\nfor an equivalent written in pure Python or Java. Although it is technically \r\nfeasible to support such extensions - IronPython does so - there are no plans \r\nto do so in Jython.\r\n\r\nhttps://stackoverflow.com/questions/1252965/distributing-my-python-scripts-as-jars-with-jython\r\n\r\nyou can simply call python scripts (or bash or Perl scripts) from Java using Runtime or ProcessBuilder and pass output back to Java:\r\n\r\nhttps://stackoverflow.com/questions/13707519/running-a-bash-shell-script-in-java \r\n\r\nhttps://stackoverflow.com/questions/8496494/running-command-line-in-java\r\n\r\nhttps://stackoverflow.com/questions/5711084/java-runtime-getruntime-getting-output-from-executing-a-command-line-program","title":"Calling Python in Java?","body":"<p>Jython has some limitations:</p>\n\n<blockquote>\n  <p>There are a number of differences. First, Jython programs cannot use CPython \n  extension modules written in C. These modules usually have files with the\n  extension .so, .pyd or .dll. If you want to use such a module, you should look \n  for an equivalent written in pure Python or Java. Although it is technically \n  feasible to support such extensions - IronPython does so - there are no plans \n  to do so in Jython.</p>\n</blockquote>\n\n<p><a href=\"https://stackoverflow.com/questions/1252965/distributing-my-python-scripts-as-jars-with-jython\">Distributing my Python scripts as JAR files with Jython?</a></p>\n\n<p>you can simply call python scripts (or bash or Perl scripts) from Java using Runtime or ProcessBuilder and pass output back to Java:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/13707519/running-a-bash-shell-script-in-java\">Running a bash shell script in java</a> </p>\n\n<p><a href=\"https://stackoverflow.com/questions/8496494/running-command-line-in-java\">Running Command Line in Java</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/5711084/java-runtime-getruntime-getting-output-from-executing-a-command-line-program\">java runtime.getruntime() getting output from executing a command line program</a></p>\n"},{"tags":[],"owner":{"account_id":6629189,"reputation":517,"user_id":5118359,"display_name":"Peiming Hu"},"down_vote_count":2,"up_vote_count":30,"is_accepted":false,"score":28,"last_activity_date":1631876578,"creation_date":1488083920,"answer_id":42464815,"question_id":8898765,"body_markdown":"It&#39;s not smart to have python code inside java. Wrap your python code with flask or another web framework to make it a microservice. This makes your java program able to call this microservice (e.g. via REST).\r\n\r\nThis approach is simple and it will save you tons of issues. And the codes are loosely coupled so they are scalable.\r\n\r\nUpdated on Mar 24th 2020:\r\nAccording to @stx&#39;s comment, the above approach is not suitable for massive data transfer between client and server. \r\nHere is another approach I recommended: \r\nConnecting Python and Java with Rust(C/C++ also ok).\r\nhttps://medium.com/@shmulikamar/https-medium-com-shmulikamar-connecting-python-and-java-with-rust-11c256a1dfb0","title":"Calling Python in Java?","body":"<p>It's not smart to have python code inside java. Wrap your python code with flask or another web framework to make it a microservice. This makes your java program able to call this microservice (e.g. via REST).</p>\n<p>This approach is simple and it will save you tons of issues. And the codes are loosely coupled so they are scalable.</p>\n<p>Updated on Mar 24th 2020:\nAccording to @stx's comment, the above approach is not suitable for massive data transfer between client and server.\nHere is another approach I recommended:\nConnecting Python and Java with Rust(C/C++ also ok).\n<a href=\"https://medium.com/@shmulikamar/https-medium-com-shmulikamar-connecting-python-and-java-with-rust-11c256a1dfb0\" rel=\"noreferrer\">https://medium.com/@shmulikamar/https-medium-com-shmulikamar-connecting-python-and-java-with-rust-11c256a1dfb0</a></p>\n"},{"tags":[],"owner":{"account_id":10477676,"reputation":371,"user_id":7723708,"display_name":"bsteffen"},"down_vote_count":0,"up_vote_count":12,"is_accepted":false,"score":12,"last_activity_date":1489697310,"creation_date":1489697310,"answer_id":42844490,"question_id":8898765,"body_markdown":"Several of the answers mention that you can use JNI or JNA to access cpython but I would not recommend starting from scratch because there are already open source libraries for accessing cpython from java. For example:\r\n\r\n* [JEP](https://github.com/mrj0/jep/)\r\n* [JPY](https://github.com/bcdev/jpy)\r\n","title":"Calling Python in Java?","body":"<p>Several of the answers mention that you can use JNI or JNA to access cpython but I would not recommend starting from scratch because there are already open source libraries for accessing cpython from java. For example:</p>\n\n<ul>\n<li><a href=\"https://github.com/mrj0/jep/\" rel=\"noreferrer\">JEP</a></li>\n<li><a href=\"https://github.com/bcdev/jpy\" rel=\"noreferrer\">JPY</a></li>\n</ul>\n"},{"tags":[],"owner":{"account_id":26053,"reputation":1832,"user_id":67492,"accept_rate":62,"display_name":"subes"},"down_vote_count":1,"up_vote_count":8,"is_accepted":false,"score":7,"last_activity_date":1623239095,"creation_date":1497094725,"answer_id":44472897,"question_id":8898765,"body_markdown":"Here a library that lets you write your python scripts once and decide which integration method (Jython, CPython/PyPy via Jep and Py4j) to use at runtime: \r\n\r\nhttps://github.com/subes/invesdwin-context-python \r\n\r\nSince each method has its own benefits/drawbacks as explained in the link.  \r\n (3 modules: jep,  Py4J, jython )","title":"Calling Python in Java?","body":"<p>Here a library that lets you write your python scripts once and decide which integration method (Jython, CPython/PyPy via Jep and Py4j) to use at runtime:</p>\n<p><a href=\"https://github.com/subes/invesdwin-context-python\" rel=\"nofollow noreferrer\">https://github.com/subes/invesdwin-context-python</a></p>\n<p>Since each method has its own benefits/drawbacks as explained in the link.<br />\n(3 modules: jep,  Py4J, jython )</p>\n"},{"tags":[],"owner":{"account_id":2979311,"reputation":592,"user_id":2529666,"accept_rate":40,"display_name":"Flummiboy"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1662315141,"creation_date":1590744653,"answer_id":62082797,"question_id":8898765,"body_markdown":"[This][1] gives a pretty good overview over the current options. Some of which are named in other answers. Jython is not usable until they decide to not implement Python 3. Many of the other projects are coming from the python side and want to access java. But there are a few options still, to name something which has not been named yet: [gRPC][2]\r\n\r\n  [1]: https://web.archive.org/web/20200501221233/https://talvi.net/a-brief-overview-of-python-java-bridges-in-2020.html\r\n  [2]: https://grpc.io/","title":"Calling Python in Java?","body":"<p><a href=\"https://web.archive.org/web/20200501221233/https://talvi.net/a-brief-overview-of-python-java-bridges-in-2020.html\" rel=\"nofollow noreferrer\">This</a> gives a pretty good overview over the current options. Some of which are named in other answers. Jython is not usable until they decide to not implement Python 3. Many of the other projects are coming from the python side and want to access java. But there are a few options still, to name something which has not been named yet: <a href=\"https://grpc.io/\" rel=\"nofollow noreferrer\">gRPC</a></p>\n"},{"tags":[],"owner":{"account_id":3047300,"reputation":2037,"user_id":2582581,"display_name":"Wildhammer"},"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1623240230,"creation_date":1596241974,"answer_id":63200642,"question_id":8898765,"body_markdown":"[GraalVM][1] is a good choice. I&#39;ve done Java+Javascript combination with GraalVM for microservice design (Java with Javascript reflection). They recently added support for python, I&#39;d give it a try especially with how big its community has grown over the years.\r\n\r\nUPDATE June 2021\r\n\r\nhttps://www.graalvm.org/reference-manual/python/ says\r\n\r\n&gt; GraalVM provides a Python 3.8 compliant runtime. A primary goal of the GraalVM Python runtime is to support SciPy and its constituent libraries, as well as to work with other data science and machine learning libraries from the rich Python ecosystem. At this point, the Python runtime is made available for experimentation and curious end-users.\r\n\r\n  [1]: https://www.graalvm.org/getting-started/#running-python","title":"Calling Python in Java?","body":"<p><a href=\"https://www.graalvm.org/getting-started/#running-python\" rel=\"nofollow noreferrer\">GraalVM</a> is a good choice. I've done Java+Javascript combination with GraalVM for microservice design (Java with Javascript reflection). They recently added support for python, I'd give it a try especially with how big its community has grown over the years.</p>\n<p>UPDATE June 2021</p>\n<p><a href=\"https://www.graalvm.org/reference-manual/python/\" rel=\"nofollow noreferrer\">https://www.graalvm.org/reference-manual/python/</a> says</p>\n<blockquote>\n<p>GraalVM provides a Python 3.8 compliant runtime. A primary goal of the GraalVM Python runtime is to support SciPy and its constituent libraries, as well as to work with other data science and machine learning libraries from the rich Python ecosystem. At this point, the Python runtime is made available for experimentation and curious end-users.</p>\n</blockquote>\n"},{"tags":[],"owner":{"account_id":19341163,"reputation":119,"user_id":14140634,"display_name":"towith"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1625912550,"creation_date":1625912550,"answer_id":68326816,"question_id":8898765,"body_markdown":"I have similar requirement, I think best solution is `thrift` for me(also a rpc solution),  just run test passed successfully right now, and can use [thrift-generator](https://github.com/hongliuliao/thrift-generator) to gen thrift file from java interface, then gen python files and java client files from the thrift file","title":"Calling Python in Java?","body":"<p>I have similar requirement, I think best solution is <code>thrift</code> for me(also a rpc solution),  just run test passed successfully right now, and can use <a href=\"https://github.com/hongliuliao/thrift-generator\" rel=\"nofollow noreferrer\">thrift-generator</a> to gen thrift file from java interface, then gen python files and java client files from the thrift file</p>\n"},{"tags":[],"owner":{"account_id":23945000,"reputation":1,"user_id":17937464,"display_name":"Ashfaq"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1679300519,"creation_date":1679300519,"answer_id":75787885,"question_id":8898765,"body_markdown":"In in terms of data exchange from python to Java we can make it a rest services and exchange the data in the XML or Json format but sometimes we need to call automated script is easily created with python to called in java file. ","title":"Calling Python in Java?","body":"<p>In in terms of data exchange from python to Java we can make it a rest services and exchange the data in the XML or Json format but sometimes we need to call automated script is easily created with python to called in java file.</p>\n"}],"owner":{"account_id":447451,"reputation":1987,"user_id":841072,"accept_rate":65,"display_name":"Shahab"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":230624,"favorite_count":0,"down_vote_count":0,"up_vote_count":139,"accepted_answer_id":8899042,"answer_count":13,"score":139,"last_activity_date":1689958229,"creation_date":1326820228,"question_id":8898765,"body_markdown":"I am wondering if it is possible to call Python functions from Java code using Jython, or is it only for calling Java code from Python?\r\n","title":"Calling Python in Java?","body":"<p>I am wondering if it is possible to call Python functions from Java code using Jython, or is it only for calling Java code from Python?</p>\n"},{"tags":["java","spring","hibernate","spring-mvc","spring-data-jpa"],"owner":{"account_id":25853606,"reputation":1,"user_id":19587254,"display_name":"Oxygensend"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":33,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689958092,"creation_date":1689868815,"question_id":76731705,"body_markdown":"I am new to Spring boot and hibernate. I am creating a simple project with a micro services architecture. While creating entities I&#39;ve faced a problem with many to many relationship, I&#39;ve searched whole internet and I couldn&#39;t find the answer so maybe someone here can help me. I am using postgres 15 database if it help somehow. spring-boot-jpa version: 3.1, hibernate version: 6.2.2.Final.\r\n\r\nI have two entities - `Restaurant` and `Category`:\r\n\r\n```\r\npackage food.domain.entity;\r\n\r\nimport food.infrastructure.hibernate.UUIDConverter;\r\nimport jakarta.persistence.*;\r\nimport lombok.Builder;\r\nimport lombok.Data;\r\n\r\nimport java.util.HashSet;\r\nimport java.util.Set;\r\nimport java.util.UUID;\r\n\r\n@Data\r\n@Builder\r\n@Entity\r\n@Table(name = &quot;food_category&quot;)\r\npublic class Category {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n\r\n    @Column(nullable = false)\r\n    private String name;\r\n\r\n    @Column(nullable = false)\r\n    private String description;\r\n\r\n    @ManyToMany(mappedBy = &quot;categories&quot;, cascade = CascadeType.ALL, fetch = FetchType.EAGER)\r\n    private Set&lt;Restaurant&gt; restaurants = new HashSet&lt;&gt;();\r\n\r\n    public Category() {\r\n    }\r\n\r\n    public Category(Long id, String name, String description, Set&lt;Restaurant&gt; restaurants) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.description = description;\r\n        this.restaurants = restaurants;\r\n    }\r\n\r\n    public void addRestaurant(Restaurant restaurant) {\r\n        restaurants.add(restaurant);\r\n    }\r\n\r\n}\r\npackage food.domain.entity;\r\n\r\nimport jakarta.persistence.*;\r\nimport lombok.*;\r\nimport org.springframework.lang.NonNull;\r\n\r\nimport java.util.HashSet;\r\nimport java.util.Set;\r\n\r\n@Data\r\n@Builder\r\n@Entity\r\n@Table(name = &quot;food_restaurant&quot;)\r\npublic class Restaurant {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n\r\n    @NonNull\r\n    @Column(nullable = false)\r\n    private String name;\r\n\r\n    private String description;\r\n\r\n    @NonNull\r\n    @Column(nullable = false)\r\n    private String openingTime;\r\n\r\n    @NonNull\r\n    @Column(nullable = false)\r\n    private String closingTime;\r\n\r\n    @OneToMany(mappedBy = &quot;restaurant&quot;)\r\n    private Set&lt;Course&gt; courses = new HashSet&lt;&gt;();\r\n\r\n    @ManyToMany(cascade = CascadeType.ALL, fetch = FetchType.EAGER)\r\n    @JoinTable(name = &quot;food_restaurant_category&quot;,\r\n            joinColumns = @JoinColumn(name = &quot;restaurant_id&quot;),\r\n            inverseJoinColumns = @JoinColumn(name = &quot;category_id&quot;))\r\n    private Set&lt;Category&gt; categories = new HashSet&lt;&gt;();\r\n\r\n\r\n    public Restaurant() {\r\n    }\r\n//\r\n    public Restaurant(Long id, @NonNull String name, String description, @NonNull String openingTime, @NonNull String closingTime, Set&lt;Course&gt; courses, Set&lt;Category&gt; categories) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.description = description;\r\n        this.openingTime = openingTime;\r\n        this.closingTime = closingTime;\r\n        this.courses = courses;\r\n        this.categories = categories;\r\n    }\r\n\r\n\r\n    public void addCategory(Category category) {\r\n        this.categories.add(category);\r\n        category.getRestaurants().add(this);\r\n    }\r\n\r\n}\r\n```\r\n\r\nFor linking restaurant with category it works pretty well(from the restaurant side -  that what i wanted to achive)I can see the results in the pivot\r\n\r\n```\r\npackage food.domain.command.restaurant.create;\r\n\r\nimport commons.cqrs.command.CommandHandler;\r\nimport food.application.response.RestaurantIdResponse;\r\nimport food.domain.entity.Restaurant;\r\nimport food.infrastructure.repository.CategoryRepository;\r\nimport food.infrastructure.repository.RestaurantRepository;\r\nimport lombok.RequiredArgsConstructor;\r\nimport org.springframework.stereotype.Component;\r\n\r\nimport java.util.HashSet;\r\nimport java.util.UUID;\r\n\r\n@RequiredArgsConstructor\r\n@Component\r\npublic class CreateRestaurantCommandHandler implements CommandHandler&lt;RestaurantIdResponse, CreateRestaurantCommand&gt; {\r\n\r\n    private final CategoryRepository categoryRepository;\r\n    private final RestaurantRepository restaurantRepository;\r\n\r\n    @Override\r\n    public RestaurantIdResponse handle(CreateRestaurantCommand command) {\r\n        var request = command.request();\r\n        var categories = new HashSet&lt;&gt;(categoryRepository.findAllById(request.categories()));\r\n        var restaurant = Restaurant.builder()\r\n                .name(request.name())\r\n                .description(request.description())\r\n                .openingTime(request.openingTime())\r\n                .closingTime(request.closingTime())\r\n                .categories(categories)\r\n                .build();\r\n\r\n        restaurantRepository.save(restaurant);\r\n\r\n        return new RestaurantIdResponse(restaurant.getId());\r\n    }\r\n}\r\n```\r\n\r\nBut when it comes to reading it doesnt work, every time i&#39;ve got empty set\r\n\r\n```\r\npackage food.domain.query.restaurant.get;\r\n\r\nimport commons.cqrs.query.QueryHandler;\r\nimport food.application.response.GetRestaurantResponse;\r\nimport food.domain.entity.Category;\r\nimport food.domain.entity.Restaurant;\r\nimport food.domain.exception.RestaurantNotFoundException;\r\nimport food.infrastructure.repository.CategoryRepository;\r\nimport food.infrastructure.repository.RestaurantRepository;\r\nimport lombok.RequiredArgsConstructor;\r\nimport org.springframework.stereotype.Component;\r\n\r\nimport java.util.List;\r\nimport java.util.Optional;\r\nimport java.util.Set;\r\nimport java.util.stream.Collectors;\r\n\r\n@RequiredArgsConstructor\r\n@Component\r\npublic class GetRestaurantQueryHandler implements QueryHandler&lt;GetRestaurantResponse, GetRestaurantQuery&gt; {\r\n\r\n    private final RestaurantRepository repository;\r\n    private final CategoryRepository categoryRepository;\r\n\r\n    @Override\r\n    public GetRestaurantResponse handle(GetRestaurantQuery query) {\r\n        Restaurant restaurant = repository.findById(query.restaurantId()).orElseThrow(() -&gt; new RestaurantNotFoundException(&quot;Restaurant with id: &quot; + query.restaurantId() + &quot; not found&quot;));\r\n\r\n        int z = restaurant.getCategories().size(); // This will trigger the loading of categories from the database\r\n        List&lt;Restaurant&gt; all = repository.findAll();\r\n        Optional&lt;Category&gt; byId = categoryRepository.findById(1L);\r\n\r\n\r\n        Set&lt;String&gt; categories = restaurant.getCategories().stream().map(Category::getName).collect(Collectors.toSet());\r\n\r\n\r\n        return new GetRestaurantResponse(\r\n                restaurant.getId(),\r\n                restaurant.getName(),\r\n                restaurant.getDescription(),\r\n                restaurant.getOpeningTime(),\r\n                restaurant.getClosingTime(),\r\n                categories\r\n        );\r\n    }\r\n}\r\n```\r\n\r\nHere are also all queries that in executed from GetRestaurantQueryHandler:\r\n\r\n```\r\n2023-07-20T17:37:06.730+02:00 DEBUG 61831 --- [nio-8081-exec-2] org.hibernate.SQL                        : select r1_0.id,r1_0.closing_time,r1_0.description,r1_0.name,r1_0.opening_time from food_restaurant r1_0\r\n2023-07-20T17:37:06.742+02:00 DEBUG 61831 --- [nio-8081-exec-2] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\r\n2023-07-20T17:37:06.743+02:00 TRACE 61831 --- [nio-8081-exec-2] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [9]\r\n2023-07-20T17:37:06.748+02:00 DEBUG 61831 --- [nio-8081-exec-2] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\r\n2023-07-20T17:37:06.749+02:00 TRACE 61831 --- [nio-8081-exec-2] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [4]\r\n2023-07-20T17:37:37.858+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select r1_0.id,c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name,r1_0.closing_time,r1_0.description,r1_0.name,r1_0.opening_time from food_restaurant r1_0 left join (food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id) on r1_0.id=c1_0.restaurant_id where r1_0.id=?\r\n2023-07-20T17:37:37.860+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [7]\r\n2023-07-20T17:37:37.868+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time from food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id where r1_0.category_id=?\r\n2023-07-20T17:37:37.870+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [1]\r\n2023-07-20T17:37:37.878+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_0.id,c1_0.availability,c2_0.id,c2_0.description,c2_0.name,r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time,c1_0.cost,c1_0.description,c1_0.name from food_food c1_0 left join food_category c2_0 on c2_0.id=c1_0.category_id left join (food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id) on c2_0.id=r1_0.category_id where c1_0.restaurant_id=?\r\n2023-07-20T17:37:37.879+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [5]\r\n2023-07-20T17:37:37.885+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\r\n2023-07-20T17:37:37.886+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [5]\r\n2023-07-20T17:37:37.893+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time from food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id where r1_0.category_id=?\r\n2023-07-20T17:37:37.895+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [1]\r\n2023-07-20T17:37:37.901+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_0.id,c1_0.availability,c2_0.id,c2_0.description,c2_0.name,r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time,c1_0.cost,c1_0.description,c1_0.name from food_food c1_0 left join food_category c2_0 on c2_0.id=c1_0.category_id left join (food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id) on c2_0.id=r1_0.category_id where c1_0.restaurant_id=?\r\n2023-07-20T17:37:37.902+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [6]\r\n2023-07-20T17:37:37.908+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\r\n2023-07-20T17:37:37.909+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [6]\r\n2023-07-20T17:37:37.914+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_0.id,c1_0.availability,c2_0.id,c2_0.description,c2_0.name,r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time,c1_0.cost,c1_0.description,c1_0.name from food_food c1_0 left join food_category c2_0 on c2_0.id=c1_0.category_id left join (food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id) on c2_0.id=r1_0.category_id where c1_0.restaurant_id=?\r\n2023-07-20T17:37:37.915+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [7]\r\n2023-07-20T17:37:37.919+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\r\n2023-07-20T17:37:37.920+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [7]\r\n2023-07-20T17:37:37.925+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time from food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id where r1_0.category_id=?\r\n2023-07-20T17:37:37.926+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [2]\r\n2023-07-20T17:37:56.784+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select r1_0.id,r1_0.closing_time,r1_0.description,r1_0.name,r1_0.opening_time from food_restaurant r1_0\r\n2023-07-20T17:37:56.799+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\r\n2023-07-20T17:37:56.800+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [9]\r\n2023-07-20T17:37:56.807+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\r\n2023-07-20T17:37:56.808+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [4]\r\n```\r\n\r\nIn `GetRestaurantQueryHandler`, &#39;z&#39;,&#39;all&#39;, &#39;byId&#39; objects are just debugging ones. `Restaurant` object doesn&#39;t contain any category, but the `byId` object contains  this restaurant... So I&#39;ve tried to reverse the mapping, so maybe then I will got any categories in the restaurant object but nothing really changed. In the beginning I was using UUID instead of Long, I read that it maybe because the issue but unfortunately not. I also tried to remove new `HashSet&lt;&gt;()` from definition, remove `JoinTable`, create pivot entity, nothing worked... Do you have any idea why it works like this?\r\n\r\n[enter image description here](https://i.stack.imgur.com/xBxdv.png)","title":"Hibernate Many To Many Relationship - Data is not fetched for many to many relationship","body":"<p>I am new to Spring boot and hibernate. I am creating a simple project with a micro services architecture. While creating entities I've faced a problem with many to many relationship, I've searched whole internet and I couldn't find the answer so maybe someone here can help me. I am using postgres 15 database if it help somehow. spring-boot-jpa version: 3.1, hibernate version: 6.2.2.Final.</p>\n<p>I have two entities - <code>Restaurant</code> and <code>Category</code>:</p>\n<pre><code>package food.domain.entity;\n\nimport food.infrastructure.hibernate.UUIDConverter;\nimport jakarta.persistence.*;\nimport lombok.Builder;\nimport lombok.Data;\n\nimport java.util.HashSet;\nimport java.util.Set;\nimport java.util.UUID;\n\n@Data\n@Builder\n@Entity\n@Table(name = &quot;food_category&quot;)\npublic class Category {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column(nullable = false)\n    private String name;\n\n    @Column(nullable = false)\n    private String description;\n\n    @ManyToMany(mappedBy = &quot;categories&quot;, cascade = CascadeType.ALL, fetch = FetchType.EAGER)\n    private Set&lt;Restaurant&gt; restaurants = new HashSet&lt;&gt;();\n\n    public Category() {\n    }\n\n    public Category(Long id, String name, String description, Set&lt;Restaurant&gt; restaurants) {\n        this.id = id;\n        this.name = name;\n        this.description = description;\n        this.restaurants = restaurants;\n    }\n\n    public void addRestaurant(Restaurant restaurant) {\n        restaurants.add(restaurant);\n    }\n\n}\npackage food.domain.entity;\n\nimport jakarta.persistence.*;\nimport lombok.*;\nimport org.springframework.lang.NonNull;\n\nimport java.util.HashSet;\nimport java.util.Set;\n\n@Data\n@Builder\n@Entity\n@Table(name = &quot;food_restaurant&quot;)\npublic class Restaurant {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @NonNull\n    @Column(nullable = false)\n    private String name;\n\n    private String description;\n\n    @NonNull\n    @Column(nullable = false)\n    private String openingTime;\n\n    @NonNull\n    @Column(nullable = false)\n    private String closingTime;\n\n    @OneToMany(mappedBy = &quot;restaurant&quot;)\n    private Set&lt;Course&gt; courses = new HashSet&lt;&gt;();\n\n    @ManyToMany(cascade = CascadeType.ALL, fetch = FetchType.EAGER)\n    @JoinTable(name = &quot;food_restaurant_category&quot;,\n            joinColumns = @JoinColumn(name = &quot;restaurant_id&quot;),\n            inverseJoinColumns = @JoinColumn(name = &quot;category_id&quot;))\n    private Set&lt;Category&gt; categories = new HashSet&lt;&gt;();\n\n\n    public Restaurant() {\n    }\n//\n    public Restaurant(Long id, @NonNull String name, String description, @NonNull String openingTime, @NonNull String closingTime, Set&lt;Course&gt; courses, Set&lt;Category&gt; categories) {\n        this.id = id;\n        this.name = name;\n        this.description = description;\n        this.openingTime = openingTime;\n        this.closingTime = closingTime;\n        this.courses = courses;\n        this.categories = categories;\n    }\n\n\n    public void addCategory(Category category) {\n        this.categories.add(category);\n        category.getRestaurants().add(this);\n    }\n\n}\n</code></pre>\n<p>For linking restaurant with category it works pretty well(from the restaurant side -  that what i wanted to achive)I can see the results in the pivot</p>\n<pre><code>package food.domain.command.restaurant.create;\n\nimport commons.cqrs.command.CommandHandler;\nimport food.application.response.RestaurantIdResponse;\nimport food.domain.entity.Restaurant;\nimport food.infrastructure.repository.CategoryRepository;\nimport food.infrastructure.repository.RestaurantRepository;\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.stereotype.Component;\n\nimport java.util.HashSet;\nimport java.util.UUID;\n\n@RequiredArgsConstructor\n@Component\npublic class CreateRestaurantCommandHandler implements CommandHandler&lt;RestaurantIdResponse, CreateRestaurantCommand&gt; {\n\n    private final CategoryRepository categoryRepository;\n    private final RestaurantRepository restaurantRepository;\n\n    @Override\n    public RestaurantIdResponse handle(CreateRestaurantCommand command) {\n        var request = command.request();\n        var categories = new HashSet&lt;&gt;(categoryRepository.findAllById(request.categories()));\n        var restaurant = Restaurant.builder()\n                .name(request.name())\n                .description(request.description())\n                .openingTime(request.openingTime())\n                .closingTime(request.closingTime())\n                .categories(categories)\n                .build();\n\n        restaurantRepository.save(restaurant);\n\n        return new RestaurantIdResponse(restaurant.getId());\n    }\n}\n</code></pre>\n<p>But when it comes to reading it doesnt work, every time i've got empty set</p>\n<pre><code>package food.domain.query.restaurant.get;\n\nimport commons.cqrs.query.QueryHandler;\nimport food.application.response.GetRestaurantResponse;\nimport food.domain.entity.Category;\nimport food.domain.entity.Restaurant;\nimport food.domain.exception.RestaurantNotFoundException;\nimport food.infrastructure.repository.CategoryRepository;\nimport food.infrastructure.repository.RestaurantRepository;\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.stereotype.Component;\n\nimport java.util.List;\nimport java.util.Optional;\nimport java.util.Set;\nimport java.util.stream.Collectors;\n\n@RequiredArgsConstructor\n@Component\npublic class GetRestaurantQueryHandler implements QueryHandler&lt;GetRestaurantResponse, GetRestaurantQuery&gt; {\n\n    private final RestaurantRepository repository;\n    private final CategoryRepository categoryRepository;\n\n    @Override\n    public GetRestaurantResponse handle(GetRestaurantQuery query) {\n        Restaurant restaurant = repository.findById(query.restaurantId()).orElseThrow(() -&gt; new RestaurantNotFoundException(&quot;Restaurant with id: &quot; + query.restaurantId() + &quot; not found&quot;));\n\n        int z = restaurant.getCategories().size(); // This will trigger the loading of categories from the database\n        List&lt;Restaurant&gt; all = repository.findAll();\n        Optional&lt;Category&gt; byId = categoryRepository.findById(1L);\n\n\n        Set&lt;String&gt; categories = restaurant.getCategories().stream().map(Category::getName).collect(Collectors.toSet());\n\n\n        return new GetRestaurantResponse(\n                restaurant.getId(),\n                restaurant.getName(),\n                restaurant.getDescription(),\n                restaurant.getOpeningTime(),\n                restaurant.getClosingTime(),\n                categories\n        );\n    }\n}\n</code></pre>\n<p>Here are also all queries that in executed from GetRestaurantQueryHandler:</p>\n<pre><code>2023-07-20T17:37:06.730+02:00 DEBUG 61831 --- [nio-8081-exec-2] org.hibernate.SQL                        : select r1_0.id,r1_0.closing_time,r1_0.description,r1_0.name,r1_0.opening_time from food_restaurant r1_0\n2023-07-20T17:37:06.742+02:00 DEBUG 61831 --- [nio-8081-exec-2] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\n2023-07-20T17:37:06.743+02:00 TRACE 61831 --- [nio-8081-exec-2] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [9]\n2023-07-20T17:37:06.748+02:00 DEBUG 61831 --- [nio-8081-exec-2] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\n2023-07-20T17:37:06.749+02:00 TRACE 61831 --- [nio-8081-exec-2] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [4]\n2023-07-20T17:37:37.858+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select r1_0.id,c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name,r1_0.closing_time,r1_0.description,r1_0.name,r1_0.opening_time from food_restaurant r1_0 left join (food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id) on r1_0.id=c1_0.restaurant_id where r1_0.id=?\n2023-07-20T17:37:37.860+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [7]\n2023-07-20T17:37:37.868+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time from food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id where r1_0.category_id=?\n2023-07-20T17:37:37.870+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [1]\n2023-07-20T17:37:37.878+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_0.id,c1_0.availability,c2_0.id,c2_0.description,c2_0.name,r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time,c1_0.cost,c1_0.description,c1_0.name from food_food c1_0 left join food_category c2_0 on c2_0.id=c1_0.category_id left join (food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id) on c2_0.id=r1_0.category_id where c1_0.restaurant_id=?\n2023-07-20T17:37:37.879+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [5]\n2023-07-20T17:37:37.885+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\n2023-07-20T17:37:37.886+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [5]\n2023-07-20T17:37:37.893+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time from food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id where r1_0.category_id=?\n2023-07-20T17:37:37.895+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [1]\n2023-07-20T17:37:37.901+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_0.id,c1_0.availability,c2_0.id,c2_0.description,c2_0.name,r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time,c1_0.cost,c1_0.description,c1_0.name from food_food c1_0 left join food_category c2_0 on c2_0.id=c1_0.category_id left join (food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id) on c2_0.id=r1_0.category_id where c1_0.restaurant_id=?\n2023-07-20T17:37:37.902+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [6]\n2023-07-20T17:37:37.908+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\n2023-07-20T17:37:37.909+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [6]\n2023-07-20T17:37:37.914+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_0.id,c1_0.availability,c2_0.id,c2_0.description,c2_0.name,r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time,c1_0.cost,c1_0.description,c1_0.name from food_food c1_0 left join food_category c2_0 on c2_0.id=c1_0.category_id left join (food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id) on c2_0.id=r1_0.category_id where c1_0.restaurant_id=?\n2023-07-20T17:37:37.915+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [7]\n2023-07-20T17:37:37.919+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\n2023-07-20T17:37:37.920+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [7]\n2023-07-20T17:37:37.925+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select r1_0.category_id,r1_1.id,r1_1.closing_time,r1_1.description,r1_1.name,r1_1.opening_time from food_restaurant_category r1_0 join food_restaurant r1_1 on r1_1.id=r1_0.restaurant_id where r1_0.category_id=?\n2023-07-20T17:37:37.926+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [2]\n2023-07-20T17:37:56.784+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select r1_0.id,r1_0.closing_time,r1_0.description,r1_0.name,r1_0.opening_time from food_restaurant r1_0\n2023-07-20T17:37:56.799+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\n2023-07-20T17:37:56.800+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [9]\n2023-07-20T17:37:56.807+02:00 DEBUG 61831 --- [nio-8081-exec-3] org.hibernate.SQL                        : select c1_0.restaurant_id,c1_1.id,c1_1.description,c1_1.name from food_restaurant_category c1_0 join food_category c1_1 on c1_1.id=c1_0.category_id where c1_0.restaurant_id=?\n2023-07-20T17:37:56.808+02:00 TRACE 61831 --- [nio-8081-exec-3] org.hibernate.orm.jdbc.bind              : binding parameter [1] as [BIGINT] - [4]\n</code></pre>\n<p>In <code>GetRestaurantQueryHandler</code>, 'z','all', 'byId' objects are just debugging ones. <code>Restaurant</code> object doesn't contain any category, but the <code>byId</code> object contains  this restaurant... So I've tried to reverse the mapping, so maybe then I will got any categories in the restaurant object but nothing really changed. In the beginning I was using UUID instead of Long, I read that it maybe because the issue but unfortunately not. I also tried to remove new <code>HashSet&lt;&gt;()</code> from definition, remove <code>JoinTable</code>, create pivot entity, nothing worked... Do you have any idea why it works like this?</p>\n<p><a href=\"https://i.stack.imgur.com/xBxdv.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"},{"tags":["java","tar","minio"],"owner":{"account_id":29065337,"reputation":1,"user_id":22265076,"display_name":"Diogo Eira"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":116,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689957874,"creation_date":1689957874,"question_id":76739788,"body_markdown":"I can extract the files to minio root folder but not elsewhere\r\n\r\n\r\nHello all.\r\nI&#39;m using MinIO Java Client API:\r\n  &lt;name&gt;minio&lt;/name&gt;\r\n  &lt;version&gt;8.4.5&lt;/version&gt;\r\n\r\n\r\n\r\nI use:\r\nMap&lt;String, String&gt; headers = new HashMap&lt;&gt;();\r\nheaders.put(&quot;X-Amz-Meta-Snowball-Auto-Extract&quot;, &quot;true&quot;);\r\n\r\nin the PutObjectArgs and Minio extracts the contents to the root folder (of the Bucket).\r\n\r\n\r\n    public ObjectWriteResponse createObject(MinioClient minioClient, String bucket, String objectPath, InputStream inputStream,\r\n                                            Map&lt;String, String&gt; headers) throws\r\n            ServerException, InsufficientDataException, ErrorResponseException,\r\n            IOException, NoSuchAlgorithmException, InvalidKeyException, InvalidResponseException,\r\n            XmlParserException, InternalException {\r\n        try {\r\n            PutObjectArgs.Builder builder = PutObjectArgs.builder().bucket(bucket).object(safeUrl(objectPath)).\r\n                    stream(inputStream, inputStream.available(), -1);\r\n            if (!CollectionUtils.isEmpty(headers)) {\r\n                builder = builder.headers(headers);\r\n            }\r\n            return minioClient.putObject(builder.build());\r\n        } finally {\r\n            inputStream.close();\r\n        }\r\n    }\r\n\r\n\r\nHow to define an extract destination folder for my tar?\r\n\r\nIs it possible to extract a tar already present in the Minio server, without a new upload?\r\n\r\nBest Regards\r\n\r\n","title":"Minio define Extract Path","body":"<p>I can extract the files to minio root folder but not elsewhere</p>\n<p>Hello all.\nI'm using MinIO Java Client API:\nminio\n8.4.5</p>\n<p>I use:\nMap&lt;String, String&gt; headers = new HashMap&lt;&gt;();\nheaders.put(&quot;X-Amz-Meta-Snowball-Auto-Extract&quot;, &quot;true&quot;);</p>\n<p>in the PutObjectArgs and Minio extracts the contents to the root folder (of the Bucket).</p>\n<pre><code>public ObjectWriteResponse createObject(MinioClient minioClient, String bucket, String objectPath, InputStream inputStream,\n                                        Map&lt;String, String&gt; headers) throws\n        ServerException, InsufficientDataException, ErrorResponseException,\n        IOException, NoSuchAlgorithmException, InvalidKeyException, InvalidResponseException,\n        XmlParserException, InternalException {\n    try {\n        PutObjectArgs.Builder builder = PutObjectArgs.builder().bucket(bucket).object(safeUrl(objectPath)).\n                stream(inputStream, inputStream.available(), -1);\n        if (!CollectionUtils.isEmpty(headers)) {\n            builder = builder.headers(headers);\n        }\n        return minioClient.putObject(builder.build());\n    } finally {\n        inputStream.close();\n    }\n}\n</code></pre>\n<p>How to define an extract destination folder for my tar?</p>\n<p>Is it possible to extract a tar already present in the Minio server, without a new upload?</p>\n<p>Best Regards</p>\n"},{"tags":["java","file-io","symlink"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1689961712,"post_id":76739670,"comment_id":135291865,"body_markdown":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.","body":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking."},{"owner":{"account_id":5998820,"reputation":12656,"user_id":4712734,"display_name":"DuncG"},"score":0,"creation_date":1689961836,"post_id":76739670,"comment_id":135291886,"body_markdown":"Not sure what your problem is here: it&#39;s quite common to see `IllegalArgumentException` when a method has found problems when doing very basic checks on arguments, but in your case file system has been accessed so it isn&#39;t unreasonable to see `IOException`. Admittedly its not a very good error message.","body":"Not sure what your problem is here: it&#39;s quite common to see <code>IllegalArgumentException</code> when a method has found problems when doing very basic checks on arguments, but in your case file system has been accessed so it isn&#39;t unreasonable to see <code>IOException</code>. Admittedly its not a very good error message."}],"answers":[{"tags":[],"owner":{"account_id":6466355,"reputation":488,"user_id":5008145,"display_name":"NorthernSky"},"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1689957555,"creation_date":1689957555,"answer_id":76739768,"question_id":76739670,"body_markdown":"The expected behavior for I/O errors is that an IOException is thrown, which it is, as you have seen.\r\n\r\nIllegalArgumentException is not a good fit here. It is used when there is something wrong with the arguments that can be detected before attempting to do anything.\r\nFor example, Files.newInputStream throws this exception &#39;if an invalid combination of options is specified&#39;.\r\n\r\nUnsupportedOperationException is also used for something different, it is used in cases where the entire operation is unsupported. For example, attempting to remove an element from an unmodifiable collection.\r\n\r\n","title":"Files.newInputStream with NOFOLLOW_LINKS option","body":"<p>The expected behavior for I/O errors is that an IOException is thrown, which it is, as you have seen.</p>\n<p>IllegalArgumentException is not a good fit here. It is used when there is something wrong with the arguments that can be detected before attempting to do anything.\nFor example, Files.newInputStream throws this exception 'if an invalid combination of options is specified'.</p>\n<p>UnsupportedOperationException is also used for something different, it is used in cases where the entire operation is unsupported. For example, attempting to remove an element from an unmodifiable collection.</p>\n"}],"owner":{"account_id":29064968,"reputation":13,"user_id":22264782,"display_name":"Daniel"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":65,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76739768,"answer_count":1,"score":1,"last_activity_date":1689957555,"creation_date":1689956679,"question_id":76739670,"body_markdown":"I wonder what is the expected behavior of java.nio.file.Files.newInputStream with java.nio.file.LinkOption.NOFOLLOW_LINKS option when used on symbolic links. I could not find it in documentation.\r\n\r\nI created two files. Regular empty file called &quot;file&quot; and a symbolic link called &quot;link&quot;:\r\n\r\n```\r\ntouch file\r\nln -s file link\r\n```\r\nWhen I try to open input stream for the link file:\r\n\r\n```\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.nio.file.Files;\r\nimport java.nio.file.LinkOption;\r\nimport java.nio.file.Path;\r\n\r\npublic class Main {\r\n    public static void main(String[] args) throws IOException {\r\n        try (\r\n            InputStream stream = Files.newInputStream(Path.of(&quot;src&quot;, &quot;link&quot;), LinkOption.NOFOLLOW_LINKS)\r\n        ) {}\r\n    }\r\n}\r\n```\r\nthen I get an error:\r\n\r\n```\r\nException in thread &quot;main&quot; java.io.IOException: Too many levels of symbolic links (NOFOLLOW_LINKS specified)\r\n\tat java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:86)\r\n\tat java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)\r\n\tat java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:116)\r\n\tat java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:219)\r\n\tat java.base/java.nio.file.Files.newByteChannel(Files.java:371)\r\n\tat java.base/java.nio.file.Files.newByteChannel(Files.java:422)\r\n\tat java.base/java.nio.file.spi.FileSystemProvider.newInputStream(FileSystemProvider.java:420)\r\n\tat java.base/java.nio.file.Files.newInputStream(Files.java:156)\r\n\tat Main.main(Main.java:10)\r\n```\r\nIf I either remove the NOFOLLOW_LINKS option or change path to the regular file, then no error is thrown.\r\n\r\nIf NOFOLLOW_LINKS option cannot be used on symbolic links, then I would expect either IllegalArgumentException or UnsupportedOperationException to be thrown. Why is IOexception with message &quot;Too many levels of symbolic links&quot; thrown instead?\r\n\r\nI use openjdk version &quot;11.0.19&quot; in case that was relevant.","title":"Files.newInputStream with NOFOLLOW_LINKS option","body":"<p>I wonder what is the expected behavior of java.nio.file.Files.newInputStream with java.nio.file.LinkOption.NOFOLLOW_LINKS option when used on symbolic links. I could not find it in documentation.</p>\n<p>I created two files. Regular empty file called &quot;file&quot; and a symbolic link called &quot;link&quot;:</p>\n<pre><code>touch file\nln -s file link\n</code></pre>\n<p>When I try to open input stream for the link file:</p>\n<pre><code>import java.io.IOException;\nimport java.io.InputStream;\nimport java.nio.file.Files;\nimport java.nio.file.LinkOption;\nimport java.nio.file.Path;\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        try (\n            InputStream stream = Files.newInputStream(Path.of(&quot;src&quot;, &quot;link&quot;), LinkOption.NOFOLLOW_LINKS)\n        ) {}\n    }\n}\n</code></pre>\n<p>then I get an error:</p>\n<pre><code>Exception in thread &quot;main&quot; java.io.IOException: Too many levels of symbolic links (NOFOLLOW_LINKS specified)\n    at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:86)\n    at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)\n    at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:116)\n    at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:219)\n    at java.base/java.nio.file.Files.newByteChannel(Files.java:371)\n    at java.base/java.nio.file.Files.newByteChannel(Files.java:422)\n    at java.base/java.nio.file.spi.FileSystemProvider.newInputStream(FileSystemProvider.java:420)\n    at java.base/java.nio.file.Files.newInputStream(Files.java:156)\n    at Main.main(Main.java:10)\n</code></pre>\n<p>If I either remove the NOFOLLOW_LINKS option or change path to the regular file, then no error is thrown.</p>\n<p>If NOFOLLOW_LINKS option cannot be used on symbolic links, then I would expect either IllegalArgumentException or UnsupportedOperationException to be thrown. Why is IOexception with message &quot;Too many levels of symbolic links&quot; thrown instead?</p>\n<p>I use openjdk version &quot;11.0.19&quot; in case that was relevant.</p>\n"},{"tags":["java","spring"],"owner":{"account_id":4926772,"reputation":45,"user_id":3967827,"display_name":"M.Ghanem"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":16,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689957338,"creation_date":1689957338,"question_id":76739746,"body_markdown":"I would like to write a multimodule library that contains a portion built with spring (and not spring boot) and another portion built with java native.\r\n\r\nI am a beginner at Spring and I would appreciate any advice on how to proceed.\r\n\r\n","title":"Creating a multimodule spring library using Java","body":"<p>I would like to write a multimodule library that contains a portion built with spring (and not spring boot) and another portion built with java native.</p>\n<p>I am a beginner at Spring and I would appreciate any advice on how to proceed.</p>\n"},{"tags":["java","spring-boot","ehcache","graalvm"],"comments":[{"owner":{"account_id":1674328,"reputation":2652,"user_id":1540177,"display_name":"grekier"},"score":0,"creation_date":1674401574,"post_id":75201538,"comment_id":132702219,"body_markdown":"I assume that it also runs fine when you are not building it as &quot;native&quot;. The problem probably comes from the missing hints for EHcache for the GraalVM. Maybe try the tracing agent to help you on the way (doc: https://docs.spring.io/spring-boot/docs/current/reference/html/native-image.html#native-image.advanced.using-the-tracing-agent)","body":"I assume that it also runs fine when you are not building it as &quot;native&quot;. The problem probably comes from the missing hints for EHcache for the GraalVM. Maybe try the tracing agent to help you on the way (doc: <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/native-image.html#native-image.advanced.using-the-tracing-agent\" rel=\"nofollow noreferrer\">docs.spring.io/spring-boot/docs/current/reference/html/&hellip;</a>)"},{"owner":{"account_id":27593689,"reputation":11,"user_id":21060344,"display_name":"John Dillard"},"score":0,"creation_date":1674403769,"post_id":75201538,"comment_id":132702600,"body_markdown":"@grekier correct, it will run fine if I don&#39;t run it as a native image.\nI edited my post to add that information.","body":"@grekier correct, it will run fine if I don&#39;t run it as a native image. I edited my post to add that information."},{"owner":{"account_id":27593689,"reputation":11,"user_id":21060344,"display_name":"John Dillard"},"score":0,"creation_date":1674403816,"post_id":75201538,"comment_id":132702609,"body_markdown":"@grekier I will try the tracing agent as you suggested. Thanks.","body":"@grekier I will try the tracing agent as you suggested. Thanks."}],"answers":[{"tags":[],"owner":{"account_id":27593689,"reputation":11,"user_id":21060344,"display_name":"John Dillard"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1674495403,"creation_date":1674417773,"answer_id":75203521,"question_id":75201538,"body_markdown":"Thanks to @grekier for suggesting to try the GraalVM native image tracing agent.\r\nFirstly I changed that part of code:\r\n```\r\n&lt;plugin&gt;\r\n    &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;\r\n    &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;\r\n    &lt;executions&gt;\r\n        &lt;execution&gt;\r\n            &lt;id&gt;build-native&lt;/id&gt;\r\n            &lt;goals&gt;\r\n                &lt;goal&gt;compile-no-fork&lt;/goal&gt;\r\n            &lt;/goals&gt;\r\n            &lt;phase&gt;package&lt;/phase&gt;\r\n        &lt;/execution&gt;\r\n    &lt;/executions&gt;\r\n&lt;/plugin&gt;\r\n```\r\n\r\ninto that:\r\n```\r\n&lt;plugin&gt;\r\n    &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;\r\n    &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;\r\n&lt;/plugin&gt;\r\n```\r\n\r\nThen I run locally (on my host, not inside the docker container) the folllowing command:\r\n```\r\n./mvnw clean package -DskipTests -Pnative\r\n```\r\nThen I run the following command:\r\n```\r\njava -Dspring.aot.enabled=true -agentlib:native-image-agent=config-output-dir=/myPathOne -jar target/test-app-one-1.0.0.jar\r\n```\r\nand while the app was running I tested it by calling the simple one endpoint that it has. After that I closed the `test-app-one` app via `CTRL+C`.\r\nAfter that, I checked on my directory: `/myPathOne` (that I declaed) and there were some `.json` files.\r\nI took all those `.json` files and copied them on my project, on the following path:\r\n`src/main/resources/META-INF/native-image`\r\nAfter that, I reverted my code, into:\r\n```\r\n&lt;plugin&gt;\r\n    &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;\r\n    &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;\r\n    &lt;executions&gt;\r\n        &lt;execution&gt;\r\n            &lt;id&gt;build-native&lt;/id&gt;\r\n            &lt;goals&gt;\r\n                &lt;goal&gt;compile-no-fork&lt;/goal&gt;\r\n            &lt;/goals&gt;\r\n            &lt;phase&gt;package&lt;/phase&gt;\r\n        &lt;/execution&gt;\r\n    &lt;/executions&gt;\r\n&lt;/plugin&gt;\r\n```\r\nand then I run the `docker-compose.yml` file, by:\r\n```\r\ndocker-compose up --build\r\n```\r\nand then the app started correctly without producing any error.\r\nThe endpoint also works ok.\r\n\r\nI updated my GitHub repository with the new `.json` files that make the app work.","title":"Error when trying to run Java 17 - Spring Boot 3 project with ehcache using GraalVM native image","body":"<p>Thanks to @grekier for suggesting to try the GraalVM native image tracing agent.\nFirstly I changed that part of code:</p>\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;\n    &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;build-native&lt;/id&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;compile-no-fork&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>into that:</p>\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;\n    &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>Then I run locally (on my host, not inside the docker container) the folllowing command:</p>\n<pre><code>./mvnw clean package -DskipTests -Pnative\n</code></pre>\n<p>Then I run the following command:</p>\n<pre><code>java -Dspring.aot.enabled=true -agentlib:native-image-agent=config-output-dir=/myPathOne -jar target/test-app-one-1.0.0.jar\n</code></pre>\n<p>and while the app was running I tested it by calling the simple one endpoint that it has. After that I closed the <code>test-app-one</code> app via <code>CTRL+C</code>.\nAfter that, I checked on my directory: <code>/myPathOne</code> (that I declaed) and there were some <code>.json</code> files.\nI took all those <code>.json</code> files and copied them on my project, on the following path:\n<code>src/main/resources/META-INF/native-image</code>\nAfter that, I reverted my code, into:</p>\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;\n    &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;build-native&lt;/id&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;compile-no-fork&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>and then I run the <code>docker-compose.yml</code> file, by:</p>\n<pre><code>docker-compose up --build\n</code></pre>\n<p>and then the app started correctly without producing any error.\nThe endpoint also works ok.</p>\n<p>I updated my GitHub repository with the new <code>.json</code> files that make the app work.</p>\n"},{"tags":[],"owner":{"account_id":20586516,"reputation":31,"user_id":15111268,"display_name":"Guilherme Pisco"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689956764,"creation_date":1689956764,"answer_id":76739682,"question_id":75201538,"body_markdown":"I think this might also help a few people.\r\n\r\nAdd the classifier as `jakarta` in ehcache dependency, as shown below. Otherwise ehcache will still depend on some `javax` packages.\r\n\r\n    &lt;dependency&gt;\r\n    \t&lt;groupId&gt;org.ehcache&lt;/groupId&gt;\r\n    \t&lt;artifactId&gt;ehcache&lt;/artifactId&gt;\r\n    \t&lt;version&gt;3.10.8&lt;/version&gt;\r\n    \t&lt;classifier&gt;jakarta&lt;/classifier&gt;\r\n    &lt;/dependency&gt;\r\n\r\nhttps://github.com/ehcache/ehcache3/issues/2946#issuecomment-1033796898","title":"Error when trying to run Java 17 - Spring Boot 3 project with ehcache using GraalVM native image","body":"<p>I think this might also help a few people.</p>\n<p>Add the classifier as <code>jakarta</code> in ehcache dependency, as shown below. Otherwise ehcache will still depend on some <code>javax</code> packages.</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.ehcache&lt;/groupId&gt;\n    &lt;artifactId&gt;ehcache&lt;/artifactId&gt;\n    &lt;version&gt;3.10.8&lt;/version&gt;\n    &lt;classifier&gt;jakarta&lt;/classifier&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p><a href=\"https://github.com/ehcache/ehcache3/issues/2946#issuecomment-1033796898\" rel=\"nofollow noreferrer\">https://github.com/ehcache/ehcache3/issues/2946#issuecomment-1033796898</a></p>\n"}],"owner":{"account_id":27593689,"reputation":11,"user_id":21060344,"display_name":"John Dillard"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3073,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75203521,"answer_count":2,"score":0,"last_activity_date":1689956764,"creation_date":1674400588,"question_id":75201538,"body_markdown":"I&#39;m trying to run an app with Java 17 and Spring Boot 3 using GraalVM native image support.\r\nIt&#39;s a very simple app with just a GET endpoint.\r\nThe app uses ehcache and Spring Boot cache to cache the result of one method.\r\nMore specifically, I&#39;m using the following Maven dependencies for cache:\r\n\r\n```\r\n&lt;dependency&gt;\r\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n    &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;\r\n&lt;/dependency&gt;\r\n\r\n&lt;dependency&gt;\r\n    &lt;groupId&gt;org.ehcache&lt;/groupId&gt;\r\n    &lt;artifactId&gt;ehcache&lt;/artifactId&gt;\r\n    &lt;version&gt;3.10.8&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```\r\n\r\nand here is my ehcache config which seems to be the problem:\r\n\r\n```\r\nimport java.time.Duration;\r\nimport javax.cache.CacheManager;\r\nimport javax.cache.Caching;\r\nimport org.ehcache.config.builders.CacheConfigurationBuilder;\r\nimport org.ehcache.config.builders.ExpiryPolicyBuilder;\r\nimport org.ehcache.config.builders.ResourcePoolsBuilder;\r\nimport org.ehcache.config.units.MemoryUnit;\r\nimport org.ehcache.jsr107.Eh107Configuration;\r\nimport org.springframework.cache.annotation.EnableCaching;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\n\r\n@EnableCaching\r\n@Configuration\r\npublic class EhcacheConfiguration {\r\n\r\n  @Bean\r\n  public CacheManager EhcacheManager() {\r\n    var cachingProvider = Caching.getCachingProvider();\r\n    var cacheManager = cachingProvider.getCacheManager();\r\n\r\n    cacheManager.createCache(&quot;myTestOne&quot;,\r\n        Eh107Configuration.fromEhcacheCacheConfiguration(\r\n            CacheConfigurationBuilder\r\n                .newCacheConfigurationBuilder(Integer.class,\r\n                    MyObject.class,\r\n                    ResourcePoolsBuilder.newResourcePoolsBuilder()\r\n                        .offheap(100, MemoryUnit.MB)\r\n                        .build())\r\n                .withExpiry(ExpiryPolicyBuilder.timeToIdleExpiration(Duration.ofHours(23)))\r\n                .build()\r\n        )\r\n    );\r\n\r\n    return cacheManager;\r\n  }\r\n\r\n}\r\n```\r\n\r\nalso here is the part where I declare the spring native maven plugin:\r\n```\r\n&lt;plugin&gt;\r\n    &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;\r\n    &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;\r\n    &lt;executions&gt;\r\n        &lt;execution&gt;\r\n            &lt;id&gt;build-native&lt;/id&gt;\r\n            &lt;goals&gt;\r\n                &lt;goal&gt;compile-no-fork&lt;/goal&gt;\r\n            &lt;/goals&gt;\r\n            &lt;phase&gt;package&lt;/phase&gt;\r\n        &lt;/execution&gt;\r\n    &lt;/executions&gt;\r\n&lt;/plugin&gt;\r\n```\r\n\r\nand I&#39;m trying to build and run the app using docker-compose,\r\nhere is the Dockerfile:\r\n\r\n```\r\nFROM ghcr.io/graalvm/graalvm-ce:ol7-java17-22.3.0 as build\r\n\r\nRUN gu install native-image\r\n\r\nRUN yum install -y zip unzip libstdc++-static freetype-devel\r\n\r\nWORKDIR /app\r\n\r\nCOPY mvnw .\r\nCOPY .mvn .mvn\r\n\r\nCOPY pom.xml .\r\n\r\nRUN chmod +x ./mvnw\r\n\r\nCOPY src src\r\n\r\nRUN ./mvnw clean package -DskipTests -Pnative\r\n\r\nENTRYPOINT [&quot;sh&quot;, &quot;-c&quot; ,&quot;./target/test-app-one&quot;]\r\n```\r\n\r\nand here is the docker-compose.yml file:\r\n\r\n```\r\nservices:\r\n  app-server:\r\n    build:\r\n      context: .\r\n      dockerfile: Dockerfile\r\n    ports:\r\n      - &quot;8080:8080&quot;\r\n    restart: always\r\n```\r\n\r\nI&#39;m trying to start the docker-compose.yml by the following command:\r\n\r\n```\r\ndocker-compose up --build\r\n```\r\n\r\nthe build will finish successfully, but when it will try to start the app (on the last step of the Dockerfile), it will produce the following error.\r\nHere is the full log:\r\n\r\n```\r\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.554Z  INFO 1 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)\r\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.554Z  INFO 1 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]\r\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.554Z  INFO 1 --- [           main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.5]\r\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.559Z  INFO 1 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext\r\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.559Z  INFO 1 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 39 ms\r\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.568Z  WARN 1 --- [           main] w.s.c.ServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh a\r\nttempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;EhcacheManager&#39;: Instantiation of supplied bean failed\r\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.569Z  INFO 1 --- [           main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]\r\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.570Z ERROR 1 --- [           main] o.s.boot.SpringApplication               : Application run failed\r\ncache-test-app-one-app-server-1  | \r\ncache-test-app-one-app-server-1  | org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;EhcacheManager&#39;: Instantiation of supplied bean failed\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1236) ~[test-app-one\r\n:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1210) ~[test-app-one:6.0.4] \r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1157) ~[test-app-one:6.0.4] \r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:561) ~[test-app-one:6.0.4]        \r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:521) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:961) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:915) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:584) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[test-app-one:3.0.2]\r\ncache-test-app-one-app-server-1  |      at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:730) ~[test-app-one:3.0.2]\r\ncache-test-app-one-app-server-1  |      at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:432) ~[test-app-one:3.0.2]\r\ncache-test-app-one-app-server-1  |      at org.springframework.boot.SpringApplication.run(SpringApplication.java:308) ~[test-app-one:3.0.2]\r\ncache-test-app-one-app-server-1  |      at org.springframework.boot.SpringApplication.run(SpringApplication.java:1302) ~[test-app-one:3.0.2]\r\ncache-test-app-one-app-server-1  |      at org.springframework.boot.SpringApplication.run(SpringApplication.java:1291) ~[test-app-one:3.0.2]\r\ncache-test-app-one-app-server-1  |      at com.test.testappone.TestAppOneApplication.main(TestAppOneApplication.java:10) ~[test-app-one:na]\r\ncache-test-app-one-app-server-1  | Caused by: java.lang.IllegalArgumentException: The serializer: org.ehcache.impl.serialization.PlainJavaSerializer does not have a constructor that takes in a ClassLoader.  \r\ncache-test-app-one-app-server-1  |      at org.ehcache.impl.config.serializer.DefaultSerializationProviderConfiguration.addSerializerFor(DefaultSerializationProviderConfiguration.java:99) ~[test-app-one:3.10\r\n.8]\r\ncache-test-app-one-app-server-1  |      at org.ehcache.impl.config.serializer.DefaultSerializationProviderConfiguration.addSerializerFor(DefaultSerializationProviderConfiguration.java:75) ~[test-app-one:3.10\r\n.8]\r\ncache-test-app-one-app-server-1  |      at org.ehcache.jsr107.EhcacheCachingProvider.createCacheManager(EhcacheCachingProvider.java:148) ~[test-app-one:3.10.8]\r\ncache-test-app-one-app-server-1  |      at org.ehcache.jsr107.EhcacheCachingProvider.getCacheManager(EhcacheCachingProvider.java:134) ~[test-app-one:3.10.8]\r\ncache-test-app-one-app-server-1  |      at org.ehcache.jsr107.EhcacheCachingProvider.getCacheManager(EhcacheCachingProvider.java:85) ~[test-app-one:3.10.8]\r\ncache-test-app-one-app-server-1  |      at org.ehcache.jsr107.EhcacheCachingProvider.getCacheManager(EhcacheCachingProvider.java:194) ~[test-app-one:3.10.8]\r\ncache-test-app-one-app-server-1  |      at org.ehcache.jsr107.EhcacheCachingProvider.getCacheManager(EhcacheCachingProvider.java:202) ~[test-app-one:3.10.8]\r\ncache-test-app-one-app-server-1  |      at com.test.testappone.EhcacheConfiguration.EhcacheManager(EhcacheConfiguration.java:22) ~[test-app-one:na]\r\ncache-test-app-one-app-server-1  |      at com.test.testappone.EhcacheConfiguration$$SpringCGLIB$$0.CGLIB$EhcacheManager$0(&lt;generated&gt;) ~[test-app-one:na]\r\ncache-test-app-one-app-server-1  |      at com.test.testappone.EhcacheConfiguration$$SpringCGLIB$$2.invoke(&lt;generated&gt;) ~[test-app-one:na]\r\ncache-test-app-one-app-server-1  |      at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:258) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:331) ~[na:na]\r\ncache-test-app-one-app-server-1  |      at com.test.testappone.EhcacheConfiguration$$SpringCGLIB$$0.EhcacheManager(&lt;generated&gt;) ~[test-app-one:na]\r\ncache-test-app-one-app-server-1  |      at com.test.testappone.EhcacheConfiguration__BeanDefinitions.lambda$getEhcacheManagerInstanceSupplier$0(EhcacheConfiguration__BeanDefinitions.java:30) ~[na:na]        \r\ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:63) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:51) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.aot.BeanInstanceSupplier.lambda$withGenerator$0(BeanInstanceSupplier.java:173) ~[na:na]\r\ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingBiFunction.apply(ThrowingBiFunction.java:68) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingBiFunction.apply(ThrowingBiFunction.java:54) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.aot.BeanInstanceSupplier.lambda$get$2(BeanInstanceSupplier.java:208) ~[na:na]\r\ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:59) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:47) ~[test-app-one:6.0.4]\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.aot.BeanInstanceSupplier.invokeBeanSupplier(BeanInstanceSupplier.java:220) ~[na:na]\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.aot.BeanInstanceSupplier.get(BeanInstanceSupplier.java:208) ~[na:na]\r\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1225) ~[test-app-one\r\n:6.0.4]\r\ncache-test-app-one-app-server-1  |      ... 18 common frames omitted\r\n```\r\n\r\nif I try to remove the caching maven dependencies and the caching functionality, the app will run and start just fine.\r\nIt will also run fine as it is now if I don&#39;t run it as native image.\r\n\r\nHere you can find the full code on my GitHub repository:\r\n&lt;https://github.com/ndil101/cache-test-app-one&gt;","title":"Error when trying to run Java 17 - Spring Boot 3 project with ehcache using GraalVM native image","body":"<p>I'm trying to run an app with Java 17 and Spring Boot 3 using GraalVM native image support.\nIt's a very simple app with just a GET endpoint.\nThe app uses ehcache and Spring Boot cache to cache the result of one method.\nMore specifically, I'm using the following Maven dependencies for cache:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.ehcache&lt;/groupId&gt;\n    &lt;artifactId&gt;ehcache&lt;/artifactId&gt;\n    &lt;version&gt;3.10.8&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>and here is my ehcache config which seems to be the problem:</p>\n<pre><code>import java.time.Duration;\nimport javax.cache.CacheManager;\nimport javax.cache.Caching;\nimport org.ehcache.config.builders.CacheConfigurationBuilder;\nimport org.ehcache.config.builders.ExpiryPolicyBuilder;\nimport org.ehcache.config.builders.ResourcePoolsBuilder;\nimport org.ehcache.config.units.MemoryUnit;\nimport org.ehcache.jsr107.Eh107Configuration;\nimport org.springframework.cache.annotation.EnableCaching;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@EnableCaching\n@Configuration\npublic class EhcacheConfiguration {\n\n  @Bean\n  public CacheManager EhcacheManager() {\n    var cachingProvider = Caching.getCachingProvider();\n    var cacheManager = cachingProvider.getCacheManager();\n\n    cacheManager.createCache(&quot;myTestOne&quot;,\n        Eh107Configuration.fromEhcacheCacheConfiguration(\n            CacheConfigurationBuilder\n                .newCacheConfigurationBuilder(Integer.class,\n                    MyObject.class,\n                    ResourcePoolsBuilder.newResourcePoolsBuilder()\n                        .offheap(100, MemoryUnit.MB)\n                        .build())\n                .withExpiry(ExpiryPolicyBuilder.timeToIdleExpiration(Duration.ofHours(23)))\n                .build()\n        )\n    );\n\n    return cacheManager;\n  }\n\n}\n</code></pre>\n<p>also here is the part where I declare the spring native maven plugin:</p>\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;\n    &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;build-native&lt;/id&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;compile-no-fork&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>and I'm trying to build and run the app using docker-compose,\nhere is the Dockerfile:</p>\n<pre><code>FROM ghcr.io/graalvm/graalvm-ce:ol7-java17-22.3.0 as build\n\nRUN gu install native-image\n\nRUN yum install -y zip unzip libstdc++-static freetype-devel\n\nWORKDIR /app\n\nCOPY mvnw .\nCOPY .mvn .mvn\n\nCOPY pom.xml .\n\nRUN chmod +x ./mvnw\n\nCOPY src src\n\nRUN ./mvnw clean package -DskipTests -Pnative\n\nENTRYPOINT [&quot;sh&quot;, &quot;-c&quot; ,&quot;./target/test-app-one&quot;]\n</code></pre>\n<p>and here is the docker-compose.yml file:</p>\n<pre><code>services:\n  app-server:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    ports:\n      - &quot;8080:8080&quot;\n    restart: always\n</code></pre>\n<p>I'm trying to start the docker-compose.yml by the following command:</p>\n<pre><code>docker-compose up --build\n</code></pre>\n<p>the build will finish successfully, but when it will try to start the app (on the last step of the Dockerfile), it will produce the following error.\nHere is the full log:</p>\n<pre><code>cache-test-app-one-app-server-1  | 2023-01-22T14:21:04.554Z  INFO 1 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.554Z  INFO 1 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.554Z  INFO 1 --- [           main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.5]\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.559Z  INFO 1 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.559Z  INFO 1 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 39 ms\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.568Z  WARN 1 --- [           main] w.s.c.ServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh a\nttempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'EhcacheManager': Instantiation of supplied bean failed\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.569Z  INFO 1 --- [           main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]\ncache-test-app-one-app-server-1  | 2023-01-22T14:21:04.570Z ERROR 1 --- [           main] o.s.boot.SpringApplication               : Application run failed\ncache-test-app-one-app-server-1  | \ncache-test-app-one-app-server-1  | org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'EhcacheManager': Instantiation of supplied bean failed\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1236) ~[test-app-one\n:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1210) ~[test-app-one:6.0.4] \ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1157) ~[test-app-one:6.0.4] \ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:561) ~[test-app-one:6.0.4]        \ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:521) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:961) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:915) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:584) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[test-app-one:3.0.2]\ncache-test-app-one-app-server-1  |      at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:730) ~[test-app-one:3.0.2]\ncache-test-app-one-app-server-1  |      at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:432) ~[test-app-one:3.0.2]\ncache-test-app-one-app-server-1  |      at org.springframework.boot.SpringApplication.run(SpringApplication.java:308) ~[test-app-one:3.0.2]\ncache-test-app-one-app-server-1  |      at org.springframework.boot.SpringApplication.run(SpringApplication.java:1302) ~[test-app-one:3.0.2]\ncache-test-app-one-app-server-1  |      at org.springframework.boot.SpringApplication.run(SpringApplication.java:1291) ~[test-app-one:3.0.2]\ncache-test-app-one-app-server-1  |      at com.test.testappone.TestAppOneApplication.main(TestAppOneApplication.java:10) ~[test-app-one:na]\ncache-test-app-one-app-server-1  | Caused by: java.lang.IllegalArgumentException: The serializer: org.ehcache.impl.serialization.PlainJavaSerializer does not have a constructor that takes in a ClassLoader.  \ncache-test-app-one-app-server-1  |      at org.ehcache.impl.config.serializer.DefaultSerializationProviderConfiguration.addSerializerFor(DefaultSerializationProviderConfiguration.java:99) ~[test-app-one:3.10\n.8]\ncache-test-app-one-app-server-1  |      at org.ehcache.impl.config.serializer.DefaultSerializationProviderConfiguration.addSerializerFor(DefaultSerializationProviderConfiguration.java:75) ~[test-app-one:3.10\n.8]\ncache-test-app-one-app-server-1  |      at org.ehcache.jsr107.EhcacheCachingProvider.createCacheManager(EhcacheCachingProvider.java:148) ~[test-app-one:3.10.8]\ncache-test-app-one-app-server-1  |      at org.ehcache.jsr107.EhcacheCachingProvider.getCacheManager(EhcacheCachingProvider.java:134) ~[test-app-one:3.10.8]\ncache-test-app-one-app-server-1  |      at org.ehcache.jsr107.EhcacheCachingProvider.getCacheManager(EhcacheCachingProvider.java:85) ~[test-app-one:3.10.8]\ncache-test-app-one-app-server-1  |      at org.ehcache.jsr107.EhcacheCachingProvider.getCacheManager(EhcacheCachingProvider.java:194) ~[test-app-one:3.10.8]\ncache-test-app-one-app-server-1  |      at org.ehcache.jsr107.EhcacheCachingProvider.getCacheManager(EhcacheCachingProvider.java:202) ~[test-app-one:3.10.8]\ncache-test-app-one-app-server-1  |      at com.test.testappone.EhcacheConfiguration.EhcacheManager(EhcacheConfiguration.java:22) ~[test-app-one:na]\ncache-test-app-one-app-server-1  |      at com.test.testappone.EhcacheConfiguration$$SpringCGLIB$$0.CGLIB$EhcacheManager$0(&lt;generated&gt;) ~[test-app-one:na]\ncache-test-app-one-app-server-1  |      at com.test.testappone.EhcacheConfiguration$$SpringCGLIB$$2.invoke(&lt;generated&gt;) ~[test-app-one:na]\ncache-test-app-one-app-server-1  |      at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:258) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:331) ~[na:na]\ncache-test-app-one-app-server-1  |      at com.test.testappone.EhcacheConfiguration$$SpringCGLIB$$0.EhcacheManager(&lt;generated&gt;) ~[test-app-one:na]\ncache-test-app-one-app-server-1  |      at com.test.testappone.EhcacheConfiguration__BeanDefinitions.lambda$getEhcacheManagerInstanceSupplier$0(EhcacheConfiguration__BeanDefinitions.java:30) ~[na:na]        \ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:63) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:51) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.aot.BeanInstanceSupplier.lambda$withGenerator$0(BeanInstanceSupplier.java:173) ~[na:na]\ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingBiFunction.apply(ThrowingBiFunction.java:68) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingBiFunction.apply(ThrowingBiFunction.java:54) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.aot.BeanInstanceSupplier.lambda$get$2(BeanInstanceSupplier.java:208) ~[na:na]\ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:59) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:47) ~[test-app-one:6.0.4]\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.aot.BeanInstanceSupplier.invokeBeanSupplier(BeanInstanceSupplier.java:220) ~[na:na]\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.aot.BeanInstanceSupplier.get(BeanInstanceSupplier.java:208) ~[na:na]\ncache-test-app-one-app-server-1  |      at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1225) ~[test-app-one\n:6.0.4]\ncache-test-app-one-app-server-1  |      ... 18 common frames omitted\n</code></pre>\n<p>if I try to remove the caching maven dependencies and the caching functionality, the app will run and start just fine.\nIt will also run fine as it is now if I don't run it as native image.</p>\n<p>Here you can find the full code on my GitHub repository:\n<a href=\"https://github.com/ndil101/cache-test-app-one\" rel=\"nofollow noreferrer\">https://github.com/ndil101/cache-test-app-one</a></p>\n"},{"tags":["java","mariadb"],"comments":[{"owner":{"account_id":29026558,"reputation":11,"user_id":22234575,"display_name":"Eric"},"score":0,"creation_date":1689902493,"post_id":76697232,"comment_id":135282339,"body_markdown":"Thank you for your instruction to improve the quality of my question. I edited the question trying to fullfil the aspects you mentioned.","body":"Thank you for your instruction to improve the quality of my question. I edited the question trying to fullfil the aspects you mentioned."},{"owner":{"account_id":108033,"reputation":17201,"user_id":286934,"display_name":"Progman"},"score":0,"creation_date":1689955795,"post_id":76697232,"comment_id":135290821,"body_markdown":"Is this the error message you get when you try to connect to the MariaDB server from your local host or do you get this message when you deploy your application on the layershift host? Usually the database provider does not give access to external IPs to their database, that would be a security risk. That&#39;s why you can&#39;t even reach the host from &quot;locally&quot;.","body":"Is this the error message you get when you try to connect to the MariaDB server from your local host or do you get this message when you deploy your application on the layershift host? Usually the database provider does not give access to external IPs to their database, that would be a security risk. That&#39;s why you can&#39;t even reach the host from &quot;locally&quot;."},{"owner":{"account_id":29026558,"reputation":11,"user_id":22234575,"display_name":"Eric"},"score":0,"creation_date":1690094359,"post_id":76697232,"comment_id":135303198,"body_markdown":"The console in eclipse shows this error:\njava.sql.SQLNonTransientConnectionException: Socket fail to connect to host:address=(host=node495323-studiquizv3.j.layershift.co.uk)(port=3306)(type=primary). Connection timed out: no further information\nwhen I run program locally, which begins with the initialization of the database (Class.forName(&quot;org.mariadb.jdbc.Driver&quot;); and creation of the tables and entries needed from beginning).\nWhen I deploy the .war-file, the deployment process seems to work and I can open the website, but inputs needing the database for checking don&#39;t work.","body":"The console in eclipse shows this error: java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:address=(host=node495323-studiquizv3.j.layershift.co.uk&zwnj;&#8203;)(port=3306)(type=pr&zwnj;&#8203;imary). Connection timed out: no further information when I run program locally, which begins with the initialization of the database (Class.forName(&quot;org.mariadb.jdbc.Driver&quot;); and creation of the tables and entries needed from beginning). When I deploy the .war-file, the deployment process seems to work and I can open the website, but inputs needing the database for checking don&#39;t work."},{"owner":{"account_id":29026558,"reputation":11,"user_id":22234575,"display_name":"Eric"},"score":0,"creation_date":1690094859,"post_id":76697232,"comment_id":135303242,"body_markdown":"When I run the program after deploying, I don&#39;t have any console to get debugging or logging information. I have tried to use Log4j but couldn&#39;t bring it to work.\n\nIf the database provider doesn&#39;t give access to external IPs, I understand that running the program locally doesn&#39;t let it connect to the database. But then it should work for the version I deployed on the layershift server, shouldn&#39;t it?","body":"When I run the program after deploying, I don&#39;t have any console to get debugging or logging information. I have tried to use Log4j but couldn&#39;t bring it to work.  If the database provider doesn&#39;t give access to external IPs, I understand that running the program locally doesn&#39;t let it connect to the database. But then it should work for the version I deployed on the layershift server, shouldn&#39;t it?"},{"owner":{"account_id":108033,"reputation":17201,"user_id":286934,"display_name":"Progman"},"score":0,"creation_date":1690100740,"post_id":76697232,"comment_id":135303785,"body_markdown":"When it doesn&#39;t work on the layershift servers as well, you have to check the error messages to see the issue. It might be a different problem, which we don&#39;t see. You have to figure out how to get logging to work and/or how to get any error/exception messages. Depending on your setup, the error/exception messages might get logged in a general error file of the server (assuming your don&#39;t catch the exceptions yourself). Or you use any logging frameworks which are available to java like slf4j+logback or log4j as you already mentioned.","body":"When it doesn&#39;t work on the layershift servers as well, you have to check the error messages to see the issue. It might be a different problem, which we don&#39;t see. You have to figure out how to get logging to work and/or how to get any error/exception messages. Depending on your setup, the error/exception messages might get logged in a general error file of the server (assuming your don&#39;t catch the exceptions yourself). Or you use any logging frameworks which are available to java like slf4j+logback or log4j as you already mentioned."}],"owner":{"account_id":29026558,"reputation":11,"user_id":22234575,"display_name":"Eric"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":44,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1689955406,"creation_date":1689494348,"question_id":76697232,"body_markdown":"I&#39;m using layershift for the deployment of a .war-file (program written in Java using eclipse-19), but the connection to the database doesn&#39;t work. So I&#39;m trying to run the program locally and connect to the database lying on the layershift server (using a local database works out without problems).\r\n\r\nI have added the connector mariadb-java-client-3.1.4.jar to the projects classpath as well as the tomcat/lib.\r\n\r\n    Class.forName(&quot;org.mariadb.jdbc.Driver&quot;);\r\n\r\nWhile configuring the layershift server I choose the MariaDB version I used when I ran the program locally, 10.4.28.\r\n\r\n    public String URLAbrufen() {\r\n\r\n\t    //String server = &quot;mysql://localhost&quot;;\r\n\t    String server = &quot;mariadb://node495323-studiquizv3.j.layershift.co.uk&quot;;\r\n\t    String port = &quot;3306&quot;;\r\n\t    String database = &quot;studiquiz&quot;;\t    \r\n\t    String URL = &quot;jdbc:&quot; + server + &quot;:&quot; + port + &quot;/&quot; + database;\r\n\t    System.out.println(URL);\r\n\r\n    \treturn URL;    \t \t\r\n    }\r\n\r\ncreates this URL:\r\n*jdbc:mariadb://node495323-studiquizv3.j.layershift.co.uk:3306/studiquiz*\r\n\r\nWith which I try to connect the database like this:\r\n\r\n*Connection connection = DriverManager.getConnection(url, BenutzerDB, PasswortDB);*\r\n\r\nusing the credentials provided by layershift while setting up the server.\r\n\r\nIf I run the programm, the following exception is thrown:\r\n*java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:address=(host=node495323-studiquizv3.j.layershift.co.uk)(port=3306)(type=primary). Connection timed out: no further information*\r\n\r\nThe connection to the database on the layershift server doesn&#39;t seem to work, how can I establish this connection successfully?\r\n\r\nMinimal reproducible example of my code:\r\n\r\n    package studiquiz_test_p1;\r\n    \r\n    import java.sql.*;\r\n    \r\n    public class main {\r\n    \t\r\n        public static void main(String[] args) {\r\n    \r\n    \t\ttry {\r\n    \t\t\tClass.forName(&quot;org.mariadb.jdbc.Driver&quot;);\r\n    \t\t\t\r\n    \t\t    String server = &quot;mariadb://node495323-studiquizv3.j.layershift.co.uk&quot;;\r\n    \t\t    String port = &quot;3306&quot;;\r\n    \t\t    String database = &quot;studiquiz&quot;;\t    \r\n    \t\t    String URL = &quot;jdbc:&quot; + server + &quot;:&quot; + port + &quot;/&quot; + database;\r\n    \t\t    \r\n    \t\t\tString BenutzerDB = &quot;root&quot;;\r\n    \t\t\tString PasswortDB = &quot;password&quot;;\t\r\n    \t\t\t\r\n    \t\t\tConnection connection = DriverManager.getConnection(URL, BenutzerDB, PasswortDB);            \r\n    \t\t\t//Statement statement = connection.createStatement();\r\n    \t\t\t\r\n    \t\t\tSystem.out.println(&quot;Connection successful.&quot;);\t\t\r\n    \t\t} catch (ClassNotFoundException e) {\r\n    \t\t\tSystem.out.println(&quot;Connection failed [ClassNotFoundException].&quot;);\r\n    \t\t\te.printStackTrace();\r\n    \t\t} catch (SQLException e) {\r\n    \t\t\tSystem.out.println(&quot;Connection failed [SQLException].&quot;);\r\n    \t\t\te.printStackTrace();\r\n    \t\t}\r\n    \t}\r\n    }\r\n\r\nThank you for your support!\r\n","title":"Connection to database fails using layershift and MariaDB","body":"<p>I'm using layershift for the deployment of a .war-file (program written in Java using eclipse-19), but the connection to the database doesn't work. So I'm trying to run the program locally and connect to the database lying on the layershift server (using a local database works out without problems).</p>\n<p>I have added the connector mariadb-java-client-3.1.4.jar to the projects classpath as well as the tomcat/lib.</p>\n<pre><code>Class.forName(&quot;org.mariadb.jdbc.Driver&quot;);\n</code></pre>\n<p>While configuring the layershift server I choose the MariaDB version I used when I ran the program locally, 10.4.28.</p>\n<pre><code>public String URLAbrufen() {\n\n    //String server = &quot;mysql://localhost&quot;;\n    String server = &quot;mariadb://node495323-studiquizv3.j.layershift.co.uk&quot;;\n    String port = &quot;3306&quot;;\n    String database = &quot;studiquiz&quot;;      \n    String URL = &quot;jdbc:&quot; + server + &quot;:&quot; + port + &quot;/&quot; + database;\n    System.out.println(URL);\n\n    return URL;         \n}\n</code></pre>\n<p>creates this URL:\n<em>jdbc:mariadb://node495323-studiquizv3.j.layershift.co.uk:3306/studiquiz</em></p>\n<p>With which I try to connect the database like this:</p>\n<p><em>Connection connection = DriverManager.getConnection(url, BenutzerDB, PasswortDB);</em></p>\n<p>using the credentials provided by layershift while setting up the server.</p>\n<p>If I run the programm, the following exception is thrown:\n<em>java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:address=(host=node495323-studiquizv3.j.layershift.co.uk)(port=3306)(type=primary). Connection timed out: no further information</em></p>\n<p>The connection to the database on the layershift server doesn't seem to work, how can I establish this connection successfully?</p>\n<p>Minimal reproducible example of my code:</p>\n<pre><code>package studiquiz_test_p1;\n\nimport java.sql.*;\n\npublic class main {\n    \n    public static void main(String[] args) {\n\n        try {\n            Class.forName(&quot;org.mariadb.jdbc.Driver&quot;);\n            \n            String server = &quot;mariadb://node495323-studiquizv3.j.layershift.co.uk&quot;;\n            String port = &quot;3306&quot;;\n            String database = &quot;studiquiz&quot;;      \n            String URL = &quot;jdbc:&quot; + server + &quot;:&quot; + port + &quot;/&quot; + database;\n            \n            String BenutzerDB = &quot;root&quot;;\n            String PasswortDB = &quot;password&quot;; \n            \n            Connection connection = DriverManager.getConnection(URL, BenutzerDB, PasswortDB);            \n            //Statement statement = connection.createStatement();\n            \n            System.out.println(&quot;Connection successful.&quot;);       \n        } catch (ClassNotFoundException e) {\n            System.out.println(&quot;Connection failed [ClassNotFoundException].&quot;);\n            e.printStackTrace();\n        } catch (SQLException e) {\n            System.out.println(&quot;Connection failed [SQLException].&quot;);\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<p>Thank you for your support!</p>\n"},{"tags":["java","data-structures","hashmap"],"comments":[{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1689941669,"post_id":76737851,"comment_id":135287895,"body_markdown":"[I then switched int with long but I am getting the exception error.](https://technojeeves.com/index.php/aliasjava1/17-errors)","body":"<a href=\"https://technojeeves.com/index.php/aliasjava1/17-errors\" rel=\"nofollow noreferrer\">I then switched int with long but I am getting the exception error.</a>"}],"answers":[{"tags":[],"owner":{"account_id":10728079,"reputation":1543,"user_id":7895005,"display_name":"Pramod H G"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689944388,"creation_date":1689944388,"answer_id":76738237,"question_id":76737851,"body_markdown":"To convert **Integer** to **long** use the **longValue()** method available in the Integer class.\r\nWhich returns the value of the Integer as a long after a widening primitive conversion.\r\n\r\nExample:\r\n\r\n     Integer intVal = 10;\r\n\r\n     long longVal = intVal.longValue();","title":"Exception in converting Integer wrapper class to primitive long data type","body":"<p>To convert <strong>Integer</strong> to <strong>long</strong> use the <strong>longValue()</strong> method available in the Integer class.\nWhich returns the value of the Integer as a long after a widening primitive conversion.</p>\n<p>Example:</p>\n<pre><code> Integer intVal = 10;\n\n long longVal = intVal.longValue();\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4228398,"reputation":17727,"user_id":3461397,"display_name":"Oleg Cherednik"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1689955055,"creation_date":1689952348,"answer_id":76739196,"question_id":76737851,"body_markdown":"The problem is you do `int + int` which can be `long`. You should keep in the `Map` `long` value insted of `int`.\r\n\r\n```java\r\npublic static long gridProblem(int m, int n, Map&lt;String, Long&gt; map) {\r\n    if (n == 0 || m == 0) return 0;\r\n    if (n == 1 &amp;&amp; m == 1) return 1;\r\n\r\n    String s = m + &quot;,&quot; + n;\r\n\r\n    if (map.containsKey(s)) return map.get(s);\r\n\r\n    long nth = gridProblem(m - 1, n, map) + gridProblem(m, n - 1, map);\r\n    map.put(s, nth);\r\n    return nth;\r\n}\r\n\r\npublic static void main(String... args) {\r\n    Map&lt;String, Long&gt; h = new HashMap&lt;&gt;();\r\n    System.out.println(gridProblem(11, 8, h));\r\n}\r\n```\r\n\r\n***P.S.** I know that using recursion is quite intuitive and simple, but only for test tasks. For big input, you can get `StackOverflowError`. It&#39;s better to use iterations instead. Check this out!*\r\n```java\r\npublic static long gridProblem(int rows, int cols) {\r\n    int[][] b = new int[rows][cols];\r\n    long sum = 0;\r\n\r\n    for (int row = 0; row &lt; rows; row++) {\r\n        for (int col = 0; col &lt; cols; col++) {\r\n            if (row == 0 || col == 0) b[row][col] = 0;\r\n            else if (row == 1 &amp;&amp; col == 1) b[row][col] = 1;\r\n            else b[row][col] = b[row][col - 1] + b[row - 1][col];\r\n\r\n            sum += b[row][col];\r\n        }\r\n    }\r\n\r\n    return sum;\r\n}\r\n````","title":"Exception in converting Integer wrapper class to primitive long data type","body":"<p>The problem is you do <code>int + int</code> which can be <code>long</code>. You should keep in the <code>Map</code> <code>long</code> value insted of <code>int</code>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static long gridProblem(int m, int n, Map&lt;String, Long&gt; map) {\n    if (n == 0 || m == 0) return 0;\n    if (n == 1 &amp;&amp; m == 1) return 1;\n\n    String s = m + &quot;,&quot; + n;\n\n    if (map.containsKey(s)) return map.get(s);\n\n    long nth = gridProblem(m - 1, n, map) + gridProblem(m, n - 1, map);\n    map.put(s, nth);\n    return nth;\n}\n\npublic static void main(String... args) {\n    Map&lt;String, Long&gt; h = new HashMap&lt;&gt;();\n    System.out.println(gridProblem(11, 8, h));\n}\n</code></pre>\n<p><em><strong>P.S.</strong> I know that using recursion is quite intuitive and simple, but only for test tasks. For big input, you can get <code>StackOverflowError</code>. It's better to use iterations instead. Check this out!</em></p>\n<pre class=\"lang-java prettyprint-override\"><code>public static long gridProblem(int rows, int cols) {\n    int[][] b = new int[rows][cols];\n    long sum = 0;\n\n    for (int row = 0; row &lt; rows; row++) {\n        for (int col = 0; col &lt; cols; col++) {\n            if (row == 0 || col == 0) b[row][col] = 0;\n            else if (row == 1 &amp;&amp; col == 1) b[row][col] = 1;\n            else b[row][col] = b[row][col - 1] + b[row - 1][col];\n\n            sum += b[row][col];\n        }\n    }\n\n    return sum;\n}\n</code></pre>\n"}],"owner":{"account_id":28733733,"reputation":3,"user_id":22005141,"display_name":"Naman Bajaj"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":50,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76739196,"answer_count":2,"score":0,"last_activity_date":1689955055,"creation_date":1689941195,"question_id":76737851,"body_markdown":"I am writing a simple program related to the grid problem using Dynamic programming where I have used HashMap. I used integer as the return type and it worked just fine but for smaller values, when the values of rows of columns is big enough for the answer to be many digits long then the answer isn&#39;t returned properly.\r\n\r\nI then switched int with long but I am getting the exception error. I have tried various ways to sort this out but it&#39;s still not getting passed. I was easily able to convert the Integer object to int value, but here I can&#39;t do it via any method.\r\n\r\nAre there any alternative ways to sort this out?\r\n\r\n    import java.util.*;\r\n\r\n\r\n    public class Grid{\r\n\t\r\n    public static long grid_problem(int m, int n, HashMap h)\r\n    {   \r\n\r\n    // Convert the integers to string so as to create a unique key for every combination\r\n\r\n\tString s1 = Integer.toString(m);\r\n\tString s2 = Integer.toString(n);\r\n\tString s=s1 + &#39;,&#39; + s2;\r\n\tif(n==0||m==0)\r\n\t{\r\n\t\treturn 0; // Base Case\r\n\t}\r\n\telse if(n==1&amp;&amp;m==1)\r\n\t{\r\n\t\treturn 1; // Base Case\r\n\t}\r\n\telse if(h.containsKey(s)) // If the value is already stored\r\n\t{\r\n\t\t \r\n\t\tInteger i = (Integer) h.get(s); // This step works fine \r\n\t\tlong l = i.longValue();         // I can&#39;t find any way to cast Integer to Long or     \r\n\t\treturn l;                          int to long.\r\n\t}\r\n\telse\r\n\t{\r\n\t        long nth=grid_problem(m-1,n,h) + grid_problem(m,n-1,h); \r\n\t\th.put(s,nth);\r\n\t\treturn nth; // return both halves of the binary tree\r\n\t}\r\n    }\r\n\r\n    public static void main(String args[])\r\n    {\r\n\t HashMap&lt;String, Integer&gt; h = new HashMap&lt;&gt;();\r\n\t System.out.println(grid_problem(11,8,h));\r\n    }\r\n    }","title":"Exception in converting Integer wrapper class to primitive long data type","body":"<p>I am writing a simple program related to the grid problem using Dynamic programming where I have used HashMap. I used integer as the return type and it worked just fine but for smaller values, when the values of rows of columns is big enough for the answer to be many digits long then the answer isn't returned properly.</p>\n<p>I then switched int with long but I am getting the exception error. I have tried various ways to sort this out but it's still not getting passed. I was easily able to convert the Integer object to int value, but here I can't do it via any method.</p>\n<p>Are there any alternative ways to sort this out?</p>\n<pre><code>import java.util.*;\n\n\npublic class Grid{\n\npublic static long grid_problem(int m, int n, HashMap h)\n{   \n\n// Convert the integers to string so as to create a unique key for every combination\n\nString s1 = Integer.toString(m);\nString s2 = Integer.toString(n);\nString s=s1 + ',' + s2;\nif(n==0||m==0)\n{\n    return 0; // Base Case\n}\nelse if(n==1&amp;&amp;m==1)\n{\n    return 1; // Base Case\n}\nelse if(h.containsKey(s)) // If the value is already stored\n{\n     \n    Integer i = (Integer) h.get(s); // This step works fine \n    long l = i.longValue();         // I can't find any way to cast Integer to Long or     \n    return l;                          int to long.\n}\nelse\n{\n        long nth=grid_problem(m-1,n,h) + grid_problem(m,n-1,h); \n    h.put(s,nth);\n    return nth; // return both halves of the binary tree\n}\n}\n\npublic static void main(String args[])\n{\n HashMap&lt;String, Integer&gt; h = new HashMap&lt;&gt;();\n System.out.println(grid_problem(11,8,h));\n}\n}\n</code></pre>\n"},{"tags":["java","android","kotlin","gradle","resources"],"comments":[{"owner":{"account_id":1790714,"reputation":91128,"user_id":1631193,"accept_rate":71,"display_name":"Gabe Sechan"},"score":0,"creation_date":1689895048,"post_id":76734143,"comment_id":135281729,"body_markdown":"Are these files in the assets folder?  If not, they won&#39;t be accessible as assets.","body":"Are these files in the assets folder?  If not, they won&#39;t be accessible as assets."},{"owner":{"account_id":5784158,"reputation":312,"user_id":4563960,"display_name":"Lucas Sousa"},"score":0,"creation_date":1689899933,"post_id":76734143,"comment_id":135282152,"body_markdown":"The files is in a arbitrary directory. In my example of the question, inside a neighbor module. Is necessary the folder have the name &quot;assets&quot;? This example something like that: https://stackoverflow.com/a/62693361/4563960. Other related example: https://stackoverflow.com/a/68246046/4563960","body":"The files is in a arbitrary directory. In my example of the question, inside a neighbor module. Is necessary the folder have the name &quot;assets&quot;? This example something like that: <a href=\"https://stackoverflow.com/a/62693361/4563960\">stackoverflow.com/a/62693361/4563960</a>. Other related example: <a href=\"https://stackoverflow.com/a/68246046/4563960\">stackoverflow.com/a/68246046/4563960</a>"},{"owner":{"account_id":1790714,"reputation":91128,"user_id":1631193,"accept_rate":71,"display_name":"Gabe Sechan"},"score":0,"creation_date":1689924363,"post_id":76734143,"comment_id":135284692,"body_markdown":"The files in your directory on your PC have no bearing in the format of the APK.  None of those files are directly copied over.  The kotlin and java files are compiled and combined into a couple of .dex files.  The resources are similarly combined and compiled.  Anything else in the src directory would just be dropped-  except for the files in the assets directory, which will be put into the special assets section of the APK.  Which is the only data that AssetManager (like you use above) can access.","body":"The files in your directory on your PC have no bearing in the format of the APK.  None of those files are directly copied over.  The kotlin and java files are compiled and combined into a couple of .dex files.  The resources are similarly combined and compiled.  Anything else in the src directory would just be dropped-  except for the files in the assets directory, which will be put into the special assets section of the APK.  Which is the only data that AssetManager (like you use above) can access."},{"owner":{"account_id":1790714,"reputation":91128,"user_id":1631193,"accept_rate":71,"display_name":"Gabe Sechan"},"score":0,"creation_date":1689924404,"post_id":76734143,"comment_id":135284698,"body_markdown":"So yes, if you want to put a file into your apk, it must be in an assets directory.  The srcSet stuff is a way to include other Java/Kotlin code, not files.  Which is why it&#39;s called sourceSets-  it&#39;s sets of source code.  Not of random files.","body":"So yes, if you want to put a file into your apk, it must be in an assets directory.  The srcSet stuff is a way to include other Java/Kotlin code, not files.  Which is why it&#39;s called sourceSets-  it&#39;s sets of source code.  Not of random files."},{"owner":{"account_id":5784158,"reputation":312,"user_id":4563960,"display_name":"Lucas Sousa"},"score":0,"creation_date":1689954655,"post_id":76734143,"comment_id":135290614,"body_markdown":"Hi Gabe, I just droped an answer detailing how I achieved that. For now, using my custom directory to hold general files seems to work on both android and jvm modules. Feel free to point me something to improve it!","body":"Hi Gabe, I just droped an answer detailing how I achieved that. For now, using my custom directory to hold general files seems to work on both android and jvm modules. Feel free to point me something to improve it!"}],"answers":[{"tags":[],"owner":{"account_id":5784158,"reputation":312,"user_id":4563960,"display_name":"Lucas Sousa"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1689954889,"creation_date":1689954567,"answer_id":76739454,"question_id":76734143,"body_markdown":"After the unfortunate response &quot;not possible to use arbitrary directory&quot; as holder for common files to be accesed by android and/or other kotlin modules I started to study a bit about Gradle Source Sets possibilities.\r\n\r\nAfter that I found that we make a module look and use some folder as resources/assets (general files, not source code) by doing this in its `build.gradle.kts` file:\r\n\r\n```kotlin\r\nandroid {\r\n  //...\r\n\r\n  // get access to configs about the &quot;main&quot; source set\r\n  sourceSets.getByName(&quot;main&quot;) {\r\n    // creates an empty directories paths holder\r\n    val allNeededDirectories = mutableListOf&lt;String&gt;()\r\n\r\n    // adds all current existing defined dirs of the gradle defaults\r\n    allNeededDirectories.addAll(assets.srcDirs.map { it.toString() })\r\n    \r\n    // adds a custom and user-created directory\r\n    allNeededDirectories += project\r\n      .layout\r\n      .projectDirectory\r\n      .dir(&quot;../my_awsome_custom_directory&quot;)\r\n      .toString()\r\n    \r\n    // defines the dirs list above to be the main [assets] srcDirs\r\n    assets.setSrcDirs(allNeededDirectories)\r\n  }\r\n}\r\n```\r\n\r\nNote to the `../` prefix to access `my_awsome_custom_directory`, which is in a previous level from the current gradle module/sub project.\r\n\r\nAlso, note to the `android` block. This means that external general files (e.g.: fonts, binaries) are treated as &quot;assets&quot;, while &quot;resources&quot; are pre-indexed files, through the `R` class. For this reason, inside android activity to access a file named &quot;`my_file.test`&quot; from the `my_awsome_custom_directory` we can do:\r\n\r\n```kotlin\r\noverride fun onCreate(savedInstanceState: Bundle?) {\r\n  val resultStreamOfFile = assets.open(&quot;my_file.test&quot;)\r\n  println(resultStreamOfFile.readText())\r\n}\r\n```\r\n\r\nIn addition, when setting the custom `my_awsome_custom_directory` to be acceced by other module different of android, e.g., pure Jvm, is very similar:\r\n\r\n```kotlin\r\nkotlin {\r\n  //...\r\n\r\n  // get access to configs about the &quot;main&quot; source set\r\n  sourceSets.getByName(&quot;main&quot;) {\r\n    // creates an empty directories paths holder\r\n    val allNeededDirectories = mutableListOf&lt;String&gt;()\r\n\r\n    // adds all current existing defined dirs of the gradle defaults\r\n    allNeededDirectories.addAll(resources.srcDirs.map { it.toString() })\r\n    \r\n    // adds a custom and user-created directory\r\n    allNeededDirectories += project\r\n      .layout\r\n      .projectDirectory\r\n      .dir(&quot;../my_awsome_custom_directory&quot;)\r\n      .toString()\r\n    \r\n    // defines the dirs list above to be the main [resources] srcDirs\r\n    resources.setSrcDirs(allNeededDirectories)\r\n  }\r\n}\r\n```\r\n\r\nThe difference is that we need to define the paths to `resources` instead of `assets`. This is due to the `assets` is only provided by the `android` plugin, when the `kotlin(&quot;jvm&quot;)` provides `resources`.\r\n\r\nBy the end, all experiments above I made in a application of mine and is working well. However, if some point of my explanations are messy or if this could not work well in a specific scnenario, please, feel free to correct then!","title":"How to access files from some folder inside an android application module?","body":"<p>After the unfortunate response &quot;not possible to use arbitrary directory&quot; as holder for common files to be accesed by android and/or other kotlin modules I started to study a bit about Gradle Source Sets possibilities.</p>\n<p>After that I found that we make a module look and use some folder as resources/assets (general files, not source code) by doing this in its <code>build.gradle.kts</code> file:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>android {\n  //...\n\n  // get access to configs about the &quot;main&quot; source set\n  sourceSets.getByName(&quot;main&quot;) {\n    // creates an empty directories paths holder\n    val allNeededDirectories = mutableListOf&lt;String&gt;()\n\n    // adds all current existing defined dirs of the gradle defaults\n    allNeededDirectories.addAll(assets.srcDirs.map { it.toString() })\n    \n    // adds a custom and user-created directory\n    allNeededDirectories += project\n      .layout\n      .projectDirectory\n      .dir(&quot;../my_awsome_custom_directory&quot;)\n      .toString()\n    \n    // defines the dirs list above to be the main [assets] srcDirs\n    assets.setSrcDirs(allNeededDirectories)\n  }\n}\n</code></pre>\n<p>Note to the <code>../</code> prefix to access <code>my_awsome_custom_directory</code>, which is in a previous level from the current gradle module/sub project.</p>\n<p>Also, note to the <code>android</code> block. This means that external general files (e.g.: fonts, binaries) are treated as &quot;assets&quot;, while &quot;resources&quot; are pre-indexed files, through the <code>R</code> class. For this reason, inside android activity to access a file named &quot;<code>my_file.test</code>&quot; from the <code>my_awsome_custom_directory</code> we can do:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>override fun onCreate(savedInstanceState: Bundle?) {\n  val resultStreamOfFile = assets.open(&quot;my_file.test&quot;)\n  println(resultStreamOfFile.readText())\n}\n</code></pre>\n<p>In addition, when setting the custom <code>my_awsome_custom_directory</code> to be acceced by other module different of android, e.g., pure Jvm, is very similar:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>kotlin {\n  //...\n\n  // get access to configs about the &quot;main&quot; source set\n  sourceSets.getByName(&quot;main&quot;) {\n    // creates an empty directories paths holder\n    val allNeededDirectories = mutableListOf&lt;String&gt;()\n\n    // adds all current existing defined dirs of the gradle defaults\n    allNeededDirectories.addAll(resources.srcDirs.map { it.toString() })\n    \n    // adds a custom and user-created directory\n    allNeededDirectories += project\n      .layout\n      .projectDirectory\n      .dir(&quot;../my_awsome_custom_directory&quot;)\n      .toString()\n    \n    // defines the dirs list above to be the main [resources] srcDirs\n    resources.setSrcDirs(allNeededDirectories)\n  }\n}\n</code></pre>\n<p>The difference is that we need to define the paths to <code>resources</code> instead of <code>assets</code>. This is due to the <code>assets</code> is only provided by the <code>android</code> plugin, when the <code>kotlin(&quot;jvm&quot;)</code> provides <code>resources</code>.</p>\n<p>By the end, all experiments above I made in a application of mine and is working well. However, if some point of my explanations are messy or if this could not work well in a specific scnenario, please, feel free to correct then!</p>\n"}],"owner":{"account_id":5784158,"reputation":312,"user_id":4563960,"display_name":"Lucas Sousa"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":79,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76739454,"answer_count":1,"score":0,"last_activity_date":1689954889,"creation_date":1689893303,"question_id":76734143,"body_markdown":"Consider a gradle project that contains 3 sub-projects:\r\n\r\n```\r\nroot\r\n    |\r\n    |&gt; androidModule\r\n    |&gt; coreModule\r\n    |&gt; desktopModule\r\n```\r\n\r\nI decided to centralize some project files (e.g. fonts, binaries) inside the `coreModule` but I can&#39;t load then inside the `androidModule`. This was chosen once those files are being used either in `androidModule`, either in `desktopModule`, as well.\r\n\r\nI tried a lot of ways of declaring custom `sourceSets` in the `androidModule/build.gradle.kts` but I still can&#39;t access the files. One attempt I tried so far:\r\n\r\n```kotlin\r\nandroid {\r\n  sourceSets[&quot;main&quot;].resources {\r\n    srcDirs(arrayOf(&quot;coreModule/example/targeted/folder&quot;, &quot;other/path&quot;, &quot;etc&quot;))\r\n  }\r\n}\r\n```\r\n\r\nAlso, my attempt to load the file inside some android activity code is:\r\n\r\n```kotlin\r\nval resultStream = assets.open(&quot;file-from-the-custom-folder&quot;) //no such file or directory here\r\nprintln(resultStream)\r\n```\r\n\r\nThen, how to deal with that multiple resources directories in android gradle module?\r\n\r\nI was trying to avoid centralize the files to be in the androidModule because I think they can be accessed by the other modules easly if living in that module, by the way I also really think that the files should be inside the core module, making this place more consistent about locations/pathing. What the best way to handle this?","title":"How to access files from some folder inside an android application module?","body":"<p>Consider a gradle project that contains 3 sub-projects:</p>\n<pre><code>root\n    |\n    |&gt; androidModule\n    |&gt; coreModule\n    |&gt; desktopModule\n</code></pre>\n<p>I decided to centralize some project files (e.g. fonts, binaries) inside the <code>coreModule</code> but I can't load then inside the <code>androidModule</code>. This was chosen once those files are being used either in <code>androidModule</code>, either in <code>desktopModule</code>, as well.</p>\n<p>I tried a lot of ways of declaring custom <code>sourceSets</code> in the <code>androidModule/build.gradle.kts</code> but I still can't access the files. One attempt I tried so far:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>android {\n  sourceSets[&quot;main&quot;].resources {\n    srcDirs(arrayOf(&quot;coreModule/example/targeted/folder&quot;, &quot;other/path&quot;, &quot;etc&quot;))\n  }\n}\n</code></pre>\n<p>Also, my attempt to load the file inside some android activity code is:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>val resultStream = assets.open(&quot;file-from-the-custom-folder&quot;) //no such file or directory here\nprintln(resultStream)\n</code></pre>\n<p>Then, how to deal with that multiple resources directories in android gradle module?</p>\n<p>I was trying to avoid centralize the files to be in the androidModule because I think they can be accessed by the other modules easly if living in that module, by the way I also really think that the files should be inside the core module, making this place more consistent about locations/pathing. What the best way to handle this?</p>\n"},{"tags":["java","kotlin","inputstream","fileinputstream","oscilloscope"],"comments":[{"owner":{"account_id":2574017,"reputation":4150,"user_id":2232127,"accept_rate":100,"display_name":"JensV"},"score":1,"creation_date":1689948854,"post_id":76738748,"comment_id":135289425,"body_markdown":"That doesn&#39;t sound like a standard file format, we would probably need to know which oscilloscope this is and get related documentation to that. A sample of the file could also prove helpful","body":"That doesn&#39;t sound like a standard file format, we would probably need to know which oscilloscope this is and get related documentation to that. A sample of the file could also prove helpful"},{"owner":{"account_id":2353259,"reputation":163,"user_id":2061650,"accept_rate":67,"display_name":"sergii.gudym"},"score":0,"creation_date":1689950149,"post_id":76738748,"comment_id":135289725,"body_markdown":"I don&#39;t have an app. A friend sent me a file. There are several formats, now I looked, there is an option *.mt4","body":"I don&#39;t have an app. A friend sent me a file. There are several formats, now I looked, there is an option *.mt4"},{"owner":{"account_id":5404,"reputation":22089,"user_id":8681,"accept_rate":67,"display_name":"Jorn"},"score":0,"creation_date":1689950257,"post_id":76738748,"comment_id":135289739,"body_markdown":"Maybe your friend can give you enough information about the oscilloscope so that you can find out how to parse the file.","body":"Maybe your friend can give you enough information about the oscilloscope so that you can find out how to parse the file."},{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1689950747,"post_id":76738748,"comment_id":135289831,"body_markdown":"Why not post a link to the file?","body":"Why not post a link to the file?"},{"owner":{"account_id":2163224,"reputation":6602,"user_id":1916917,"accept_rate":60,"display_name":"Holloway"},"score":0,"creation_date":1689951843,"post_id":76738748,"comment_id":135290062,"body_markdown":"Can you edit the question with first 20 bytes or so (`print(list(open(&#39;filename&#39;, &#39;rb&#39;).read(20)))` in python). I&#39;d rather not be opening random files from dropbox.","body":"Can you edit the question with first 20 bytes or so (<code>print(list(open(&#39;filename&#39;, &#39;rb&#39;).read(20)))</code> in python). I&#39;d rather not be opening random files from dropbox."},{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":0,"creation_date":1689952276,"post_id":76738748,"comment_id":135290154,"body_markdown":"So how did the &quot;weird&quot; stuff manifest itself? If that&#39;s a file of 64 bit values, it could be big-endian *or* little-endian","body":"So how did the &quot;weird&quot; stuff manifest itself? If that&#39;s a file of 64 bit values, it could be big-endian <i>or</i> little-endian"},{"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"score":1,"creation_date":1689953270,"post_id":76738748,"comment_id":135290334,"body_markdown":"First eight values as doubles, little-endian: `-4.56, -4.61, -4.66, -4.55, -4.61, -4.56, -4.64, -4.55` Big-endian ones are *crazy* ;)","body":"First eight values as doubles, little-endian: <code>-4.56, -4.61, -4.66, -4.55, -4.61, -4.56, -4.64, -4.55</code> Big-endian ones are <i>crazy</i> ;)"}],"answers":[{"tags":[],"owner":{"account_id":22124137,"reputation":3297,"user_id":16376827,"display_name":"g00se"},"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1689954151,"creation_date":1689953439,"answer_id":76739313,"question_id":76738748,"body_markdown":"You can read it with this. The values are in line with your expectations:\r\n\r\n```\r\nimport java.nio.ByteBuffer;\r\nimport static java.nio.ByteOrder.*;\r\nimport java.nio.file.Path;\r\nimport java.nio.file.Files;\r\nimport java.io.InputStream;\r\n\r\npublic class Doubler {\r\n    public static void main(String[] args) throws Exception {\r\n        int count = -1;\r\n        byte[] buff = new byte[8];\r\n        ByteBuffer bb = ByteBuffer.allocate(8).order(LITTLE_ENDIAN);\r\n        try (InputStream in = Files.newInputStream(Path.of(args[0]))) {\r\n            while ((count = in.read(buff)) &gt; -1) {\r\n                bb.put(buff);\r\n                bb.rewind();\r\n                System.out.printf(&quot;%.2f%n&quot;, bb.getDouble());\r\n                bb.rewind();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n```","title":"how to get values from *.dbl/*.mt4","body":"<p>You can read it with this. The values are in line with your expectations:</p>\n<pre><code>import java.nio.ByteBuffer;\nimport static java.nio.ByteOrder.*;\nimport java.nio.file.Path;\nimport java.nio.file.Files;\nimport java.io.InputStream;\n\npublic class Doubler {\n    public static void main(String[] args) throws Exception {\n        int count = -1;\n        byte[] buff = new byte[8];\n        ByteBuffer bb = ByteBuffer.allocate(8).order(LITTLE_ENDIAN);\n        try (InputStream in = Files.newInputStream(Path.of(args[0]))) {\n            while ((count = in.read(buff)) &gt; -1) {\n                bb.put(buff);\n                bb.rewind();\n                System.out.printf(&quot;%.2f%n&quot;, bb.getDouble());\n                bb.rewind();\n            }\n        }\n    }\n}\n\n</code></pre>\n"}],"owner":{"account_id":2353259,"reputation":163,"user_id":2061650,"accept_rate":67,"display_name":"sergii.gudym"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":36,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"accepted_answer_id":76739313,"answer_count":1,"score":-2,"last_activity_date":1689954151,"creation_date":1689948676,"question_id":76738748,"body_markdown":"I received data from the oscilloscope in 64-bit doubles (*.dbl) or in &quot;measured data&quot; (*.mt4) format. How can I parse it (preferably Java or Kotlin) or where can I find documentation for this format?\r\n\r\nI tried using DataInputStream.readDouble but the results were weird\r\n\r\nc5 12 52 9b ec 3f 12 c0 17 29 e9 87 4e 71 12 c0 6a 3f 80 74 \r\nb0 a2 12 c0 b8 39 8e 9e b1 37 12 c0 17 29 e9 87 4e 71 12 c0\r\nc5 12 52 9b ec 3f 12 c0 4e 8d f8 7a 3a 92 12 c0 aa 60 ca a1 ","title":"how to get values from *.dbl/*.mt4","body":"<p>I received data from the oscilloscope in 64-bit doubles (<em>.dbl) or in &quot;measured data&quot; (</em>.mt4) format. How can I parse it (preferably Java or Kotlin) or where can I find documentation for this format?</p>\n<p>I tried using DataInputStream.readDouble but the results were weird</p>\n<p>c5 12 52 9b ec 3f 12 c0 17 29 e9 87 4e 71 12 c0 6a 3f 80 74\nb0 a2 12 c0 b8 39 8e 9e b1 37 12 c0 17 29 e9 87 4e 71 12 c0\nc5 12 52 9b ec 3f 12 c0 4e 8d f8 7a 3a 92 12 c0 aa 60 ca a1</p>\n"},{"tags":["java","javafx","game-development","fxgl"],"comments":[{"owner":{"account_id":81822,"reputation":204250,"user_id":230513,"accept_rate":100,"display_name":"trashgod"},"score":0,"creation_date":1690050636,"post_id":76739396,"comment_id":135300213,"body_markdown":"See also [_Game Development Stack Exchange_](https://gamedev.stackexchange.com), which may offer insight on arbitrarily large models.","body":"See also <a href=\"https://gamedev.stackexchange.com\"><i>Game Development Stack Exchange</i></a>, which may offer insight on arbitrarily large models."},{"owner":{"account_id":1180113,"reputation":152325,"user_id":1155209,"display_name":"jewelsea"},"score":0,"creation_date":1690054309,"post_id":76739396,"comment_id":135300578,"body_markdown":"You could use a [tile engine](https://www.javacodegeeks.com/2013/01/writing-a-tile-engine-in-javafx.html), (careful the link has a lot of advertising spam I cannot control but is the only available link because the original blog post no longer exists). The link outlines the concept and provides snippets of example code for an implementation, but not a complete implementation. FXGL may have a similar concept built-in, so I suggest investigating that before trying to build your own (non-trivial) or searching for a [3rd party solution](https://github.com/Kogs/JavaFXTileMap).","body":"You could use a <a href=\"https://www.javacodegeeks.com/2013/01/writing-a-tile-engine-in-javafx.html\" rel=\"nofollow noreferrer\">tile engine</a>, (careful the link has a lot of advertising spam I cannot control but is the only available link because the original blog post no longer exists). The link outlines the concept and provides snippets of example code for an implementation, but not a complete implementation. FXGL may have a similar concept built-in, so I suggest investigating that before trying to build your own (non-trivial) or searching for a <a href=\"https://github.com/Kogs/JavaFXTileMap\" rel=\"nofollow noreferrer\">3rd party solution</a>."},{"owner":{"account_id":1180113,"reputation":152325,"user_id":1155209,"display_name":"jewelsea"},"score":1,"creation_date":1690054420,"post_id":76739396,"comment_id":135300589,"body_markdown":"I did a quick search on FXGL and tile map, and [the first link that turned up was [Building Levels Using Tiled Map Editor (FXGL 11)](https://github.com/AlmasB/FXGL/wiki/Building-Levels-Using-Tiled-Map-Editor-(FXGL-11))","body":"I did a quick search on FXGL and tile map, and <a href=\"https://github.com/AlmasB/FXGL/wiki/Building-Levels-Using-Tiled-Map-Editor-(FXGL-11)\" rel=\"nofollow noreferrer\">the first link that turned up was [Building Levels Using Tiled Map Editor (FXGL 11)</a>"}],"owner":{"account_id":29064992,"reputation":1,"user_id":22264802,"display_name":"Pourya Aliannejadi"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":42,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689954113,"creation_date":1689954113,"question_id":76739396,"body_markdown":"I am trying to recreate a game like Splix.io using FXGL, I have implemented the logic of the game for one player and it works.\r\nAnd for my game window I am using a 800*800 window. My problem is my game should be &quot;unbounded&quot; which means that the player should be able to move till infinity if it desires it and I have been trying different stuff to make this happen but none of them work.\r\n\r\nAs you know Splix.io has a gird like board so to create this grid I created Light Gray cells of 20 pixels like this:\r\n\r\n```\r\n@Spawns(&quot;cell&quot;)\r\npublic Entity newCell(SpawnData data) {\r\n    return FXGL.entityBuilder(data)\r\n            .view(new Rectangle(BLOCK_SIZE,BLOCK_SIZE, Color.LIGHTGRAY))\r\n            .with(new CellComponent())\r\n            .build();\r\n}\r\n\r\n@Spawns(&quot;player&quot;)\r\npublic Entity newPlayer(SpawnData data) {\r\n    return FXGL.entityBuilder(data)\r\n            .view(&quot;steve.png&quot;)\r\n            .zIndex(100)\r\n            .build();\r\n}\r\n```\r\n\r\nand this is how I initialize the game board at the start:\r\n\r\n```\r\n    cells = new Entity[40][40];\r\n\r\n    player = spawn(&quot;player&quot;, 400, 400);\r\n    for (int y = 0; y &lt; 40; y++) {\r\n        for (int x = 0; x &lt; 40; x++) {\r\n            cells[x][y] = spawn(&quot;cell&quot;, x * BLOCK_SIZE, y * BLOCK_SIZE);\r\n        }\r\n    }\r\n```\r\n\r\nCan someone tell me how I can make this fixed size game unbounded?\r\nOne idea that I had was to check if the player comes close to any side of the window and if they get close I make the game window bigger and move the board but I don&#39;t know if this is the right way or not and even if it is, I don&#39;t know how to properly implement it.","title":"Having trouble creating an unbound game using FXGL","body":"<p>I am trying to recreate a game like Splix.io using FXGL, I have implemented the logic of the game for one player and it works.\nAnd for my game window I am using a 800*800 window. My problem is my game should be &quot;unbounded&quot; which means that the player should be able to move till infinity if it desires it and I have been trying different stuff to make this happen but none of them work.</p>\n<p>As you know Splix.io has a gird like board so to create this grid I created Light Gray cells of 20 pixels like this:</p>\n<pre><code>@Spawns(&quot;cell&quot;)\npublic Entity newCell(SpawnData data) {\n    return FXGL.entityBuilder(data)\n            .view(new Rectangle(BLOCK_SIZE,BLOCK_SIZE, Color.LIGHTGRAY))\n            .with(new CellComponent())\n            .build();\n}\n\n@Spawns(&quot;player&quot;)\npublic Entity newPlayer(SpawnData data) {\n    return FXGL.entityBuilder(data)\n            .view(&quot;steve.png&quot;)\n            .zIndex(100)\n            .build();\n}\n</code></pre>\n<p>and this is how I initialize the game board at the start:</p>\n<pre><code>    cells = new Entity[40][40];\n\n    player = spawn(&quot;player&quot;, 400, 400);\n    for (int y = 0; y &lt; 40; y++) {\n        for (int x = 0; x &lt; 40; x++) {\n            cells[x][y] = spawn(&quot;cell&quot;, x * BLOCK_SIZE, y * BLOCK_SIZE);\n        }\n    }\n</code></pre>\n<p>Can someone tell me how I can make this fixed size game unbounded?\nOne idea that I had was to check if the player comes close to any side of the window and if they get close I make the game window bigger and move the board but I don't know if this is the right way or not and even if it is, I don't know how to properly implement it.</p>\n"},{"tags":["java","hamcrest"],"comments":[{"owner":{"account_id":1688935,"reputation":2244,"user_id":1551685,"display_name":"Steve Smith"},"score":0,"creation_date":1485261070,"post_id":41828198,"comment_id":70843333,"body_markdown":"You will need to tell us what you have tried.","body":"You will need to tell us what you have tried."}],"answers":[{"tags":[],"owner":{"account_id":8869342,"reputation":638,"user_id":6623474,"display_name":"Florian Link"},"down_vote_count":0,"up_vote_count":7,"is_accepted":true,"score":7,"last_activity_date":1535023260,"creation_date":1485261361,"answer_id":41828389,"question_id":41828198,"body_markdown":"# Update\r\n\r\nAfter checking this old answer, I found that you can use a better combination of built-in matchers making both the assertion and the error messages more readable:\r\n\r\n    expectedStrings.forEach(expectedString -&gt; \r\n        assertThat(strings, hasItem(containsString(expectedString))));\r\n\r\n---\r\n# Original answer for reference\r\n\r\nYou can do it quite easily with streams:\r\n\r\n    assertThat(expectedStrings.stream().allMatch(\r\n        expectedString -&gt; strings.stream()\r\n                                 .anyMatch(string -&gt; string.contains(expectedString))),\r\n        is(true));\r\n\r\n`allMatch` will make sure all of the `expectedStrings` will be checked, and with using `anyMatch` on `strings` you can efficiently check if any of the strings contains the expected string.","title":"Assert that one of string in array contains substring","body":"<h1>Update</h1>\n\n<p>After checking this old answer, I found that you can use a better combination of built-in matchers making both the assertion and the error messages more readable:</p>\n\n<pre><code>expectedStrings.forEach(expectedString -&gt; \n    assertThat(strings, hasItem(containsString(expectedString))));\n</code></pre>\n\n<hr>\n\n<h1>Original answer for reference</h1>\n\n<p>You can do it quite easily with streams:</p>\n\n<pre><code>assertThat(expectedStrings.stream().allMatch(\n    expectedString -&gt; strings.stream()\n                             .anyMatch(string -&gt; string.contains(expectedString))),\n    is(true));\n</code></pre>\n\n<p><code>allMatch</code> will make sure all of the <code>expectedStrings</code> will be checked, and with using <code>anyMatch</code> on <code>strings</code> you can efficiently check if any of the strings contains the expected string.</p>\n"},{"tags":[],"owner":{"account_id":6087813,"reputation":15135,"user_id":4751165,"accept_rate":96,"display_name":"Pau"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1495016705,"creation_date":1495016705,"answer_id":44022215,"question_id":41828198,"body_markdown":"At the moment there isn&#39;t any matcher in hamcrest with this requeriment, despite you can combine multiple this is not possible yet.\r\n\r\nSo, in cases like yours the best solution in my opinion is to **create your own matcher** Why? \r\n\r\n - It can be reused\r\n - Is maintainable \r\n - Is more readable\r\n\r\n----\r\n\r\nSo in your case you need to match the first list contains any string of the second one, you can create a Matcher like next:\r\n\r\n\r\n    public class ContainsStringsOf extends BaseMatcher&lt;List&lt;String&gt;&gt; {\r\n    \r\n        private final List&lt;String&gt; valuesToCompare;\r\n    \r\n        public ContainsStringsOf(List&lt;String&gt; valuesToCompare) {\r\n            this.valuesToCompare = valuesToCompare;\r\n        }\r\n    \r\n        @Override\r\n        public void describeTo(Description description) {\r\n            description.appendText(&quot;doesn&#39;t contains all of &quot; + valuesToCompare.toString() + &quot; text&quot;);\r\n        }\r\n    \r\n        @Override\r\n        public boolean matches(Object o) {\r\n            List&lt;String&gt; values = (List&lt;String&gt;) o;\r\n            for (String valueToCompare : valuesToCompare) {\r\n                boolean containsText = false;\r\n                for (String value : values) {\r\n                    if (value.contains(valueToCompare)) {\r\n                        containsText = true;\r\n                    }\r\n                }\r\n                if (!containsText) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n           //note: you can replace this impl with java-8 @florian answer comparison\r\n           //return valuesToCompare.stream().allMatch(exp -&gt; strings.stream().anyMatch(st-&gt; st.contains(exp)))\r\n        }\r\n    \r\n        @Factory\r\n        public static Matcher&lt;List&lt;String&gt;&gt; containsStringsOf(List&lt;String&gt; collection) {\r\n            return new ContainsStringsOf(collection);\r\n        }\r\n    }\r\n\r\nThen you can use it is just as hamcrest matcher is used:\r\n\r\n    List&lt;String&gt; expectedStrings = Arrays.asList(&quot;link1&quot;, &quot;link2&quot;);\r\n    List&lt;String&gt; strings = Arrays.asList(&quot;lalala link1 lalalla&quot;, &quot;lalalal link2 lalalla&quot;);\r\n    Assert.assertThat(strings , containsStringsOf(expectedStrings));\r\n\r\n","title":"Assert that one of string in array contains substring","body":"<p>At the moment there isn't any matcher in hamcrest with this requeriment, despite you can combine multiple this is not possible yet.</p>\n\n<p>So, in cases like yours the best solution in my opinion is to <strong>create your own matcher</strong> Why? </p>\n\n<ul>\n<li>It can be reused</li>\n<li>Is maintainable </li>\n<li>Is more readable</li>\n</ul>\n\n<hr>\n\n<p>So in your case you need to match the first list contains any string of the second one, you can create a Matcher like next:</p>\n\n<pre><code>public class ContainsStringsOf extends BaseMatcher&lt;List&lt;String&gt;&gt; {\n\n    private final List&lt;String&gt; valuesToCompare;\n\n    public ContainsStringsOf(List&lt;String&gt; valuesToCompare) {\n        this.valuesToCompare = valuesToCompare;\n    }\n\n    @Override\n    public void describeTo(Description description) {\n        description.appendText(\"doesn't contains all of \" + valuesToCompare.toString() + \" text\");\n    }\n\n    @Override\n    public boolean matches(Object o) {\n        List&lt;String&gt; values = (List&lt;String&gt;) o;\n        for (String valueToCompare : valuesToCompare) {\n            boolean containsText = false;\n            for (String value : values) {\n                if (value.contains(valueToCompare)) {\n                    containsText = true;\n                }\n            }\n            if (!containsText) {\n                return false;\n            }\n        }\n        return true;\n       //note: you can replace this impl with java-8 @florian answer comparison\n       //return valuesToCompare.stream().allMatch(exp -&gt; strings.stream().anyMatch(st-&gt; st.contains(exp)))\n    }\n\n    @Factory\n    public static Matcher&lt;List&lt;String&gt;&gt; containsStringsOf(List&lt;String&gt; collection) {\n        return new ContainsStringsOf(collection);\n    }\n}\n</code></pre>\n\n<p>Then you can use it is just as hamcrest matcher is used:</p>\n\n<pre><code>List&lt;String&gt; expectedStrings = Arrays.asList(\"link1\", \"link2\");\nList&lt;String&gt; strings = Arrays.asList(\"lalala link1 lalalla\", \"lalalal link2 lalalla\");\nAssert.assertThat(strings , containsStringsOf(expectedStrings));\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6667122,"reputation":11,"user_id":5144453,"display_name":"Stephen Gissendaner"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689953812,"creation_date":1689953177,"answer_id":76739290,"question_id":41828198,"body_markdown":"I like the idea of a custom matcher. You could use the streams mechanism as the core of that. Here is a simple (inefficient) example:\r\n\r\n     assertThat( infoLogs.stream().filter(logItem -&gt; logItem.contains(&quot;writing out group&quot;)).collect(Collectors.toList()).size()).isNotZero();","title":"Assert that one of string in array contains substring","body":"<p>I like the idea of a custom matcher. You could use the streams mechanism as the core of that. Here is a simple (inefficient) example:</p>\n<pre><code> assertThat( infoLogs.stream().filter(logItem -&gt; logItem.contains(&quot;writing out group&quot;)).collect(Collectors.toList()).size()).isNotZero();\n</code></pre>\n"}],"owner":{"account_id":10097795,"reputation":129,"user_id":7462612,"display_name":"Hamster"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":8763,"favorite_count":0,"down_vote_count":0,"up_vote_count":7,"accepted_answer_id":41828389,"answer_count":3,"score":7,"last_activity_date":1689953812,"creation_date":1485260651,"question_id":41828198,"body_markdown":"    List&lt;String&gt; expectedStrings = Arrays.asList(&quot;link1&quot;, &quot;link2&quot;);\r\n    List&lt;String&gt; strings = Arrays.asList(&quot;lalala link1 lalalla&quot;, &quot;lalalal link2 lalalla&quot;);\r\n\r\nFor each expectedString, I need assert that any of string in the &#39;strings&#39; contains expectedString.\r\nHow I may assert this with Hamcrest?\r\nThanks for your attention.","title":"Assert that one of string in array contains substring","body":"<pre><code>List&lt;String&gt; expectedStrings = Arrays.asList(\"link1\", \"link2\");\nList&lt;String&gt; strings = Arrays.asList(\"lalala link1 lalalla\", \"lalalal link2 lalalla\");\n</code></pre>\n\n<p>For each expectedString, I need assert that any of string in the 'strings' contains expectedString.\nHow I may assert this with Hamcrest?\nThanks for your attention.</p>\n"},{"tags":["java","junit","mockito","powermockito","pmd"],"comments":[{"owner":{"account_id":886614,"reputation":29561,"user_id":925913,"accept_rate":82,"display_name":"Andrew Cheong"},"score":0,"creation_date":1690453611,"post_id":66115120,"comment_id":135357364,"body_markdown":"I came across this question when I was trying to figure out how to mock the response of the send / sendAsync method on HttpClient. For an answer to that, see https://stackoverflow.com/a/76778792/925913.","body":"I came across this question when I was trying to figure out how to mock the response of the send / sendAsync method on HttpClient. For an answer to that, see <a href=\"https://stackoverflow.com/a/76778792/925913\">stackoverflow.com/a/76778792/925913</a>."}],"answers":[{"tags":[],"owner":{"account_id":12259853,"reputation":53,"user_id":8947900,"display_name":"Shubham Anand"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1612859260,"creation_date":1612859260,"answer_id":66115353,"question_id":66115120,"body_markdown":"One of the ways to test a HTTP client code would be to not mock your HTTPClient object, but to create mock responses for the http calls and then let your HPPTClient make calls to those URLs.\r\nTake a look at Wiremock. [http://wiremock.org/docs/][1]\r\nIt helps you create a simple mock server and you can stub responses for your URLs.\r\nThen invoke your URLs using your client for the test.\r\n\r\n\r\n  [1]: http://wiremock.org/docs/","title":"How to mock HttpClient using Mockito","body":"<p>One of the ways to test a HTTP client code would be to not mock your HTTPClient object, but to create mock responses for the http calls and then let your HPPTClient make calls to those URLs.\nTake a look at Wiremock. <a href=\"http://wiremock.org/docs/\" rel=\"nofollow noreferrer\">http://wiremock.org/docs/</a>\nIt helps you create a simple mock server and you can stub responses for your URLs.\nThen invoke your URLs using your client for the test.</p>\n"},{"tags":[],"owner":{"account_id":84846,"reputation":5030,"user_id":236936,"accept_rate":67,"display_name":"TrueDub"},"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1612859333,"creation_date":1612859333,"answer_id":66115370,"question_id":66115120,"body_markdown":"You can&#39;t mock a final instance using plain mocking. You need something like [PowerMock][1].\r\n\r\nSee the answer to [this question][2]for implementation.\r\n\r\n\r\n  [1]: https://github.com/powermock/powermock\r\n  [2]: https://stackoverflow.com/questions/45034464/powermock-static-final-method-in-final-class","title":"How to mock HttpClient using Mockito","body":"<p>You can't mock a final instance using plain mocking. You need something like <a href=\"https://github.com/powermock/powermock\" rel=\"nofollow noreferrer\">PowerMock</a>.</p>\n<p>See the answer to <a href=\"https://stackoverflow.com/questions/45034464/powermock-static-final-method-in-final-class\">this question</a>for implementation.</p>\n"},{"tags":[],"owner":{"account_id":3732234,"reputation":672,"user_id":3104218,"display_name":"Acanda"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1612988132,"creation_date":1612988132,"answer_id":66144358,"question_id":66115120,"body_markdown":"A simple way to use a mocked HttpClient for your tests is to add a second constructor that takes a HttpClient.\r\n\r\n```java\r\npublic class KMSHttpClientImpl implements KMSHttpClient\r\n{\r\n\r\n  private final HttpClient httpClient;\r\n\r\n  public KMSHttpClientImpl ()\r\n  {\r\n    final PoolingHttpClientConnectionManager connectionManager =\r\n            kmsHttpConnectionManager.getConnectionManager();\r\n    httpClient = HttpClients.custom()\r\n            .setConnectionManager(connectionManager)\r\n            .build();\r\n  }\r\n\r\n  // This constructor is package private instead\r\n  // of public so it is not accidentally used by\r\n  // classes outside of this package. If your test\r\n  // class is not in the same package, then you\r\n  // need to make this a public constructor.\r\n  KMSHttpClientImpl (final HttpClient httpClient)\r\n  {\r\n    this.httpClient = httpClient;\r\n  }\r\n\r\n}\r\n```\r\n\r\nYou then inject your mocked HttpClient using this constructor and will need neither `@InjectMocks` nor `@Mock` in your tests.\r\n\r\n```java\r\n@Test\r\npublic void testPostRequest () throws KMSClientException\r\n{\r\n  final HttpClient httpClient = Mockito.mock(HttpClient.class);\r\n  final HttpResponse response = prepareResponse(HttpStatus.SC_OK);\r\n  Mockito.when(httpClient.execute(Mockito.any())).thenReturn(response);\r\n  final KMSHttpClientImpl kmsHttpClientImpl = new KMSHttpClientImpl(httpClient);\r\n\r\n  // run your test...\r\n}\r\n```","title":"How to mock HttpClient using Mockito","body":"<p>A simple way to use a mocked HttpClient for your tests is to add a second constructor that takes a HttpClient.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class KMSHttpClientImpl implements KMSHttpClient\n{\n\n  private final HttpClient httpClient;\n\n  public KMSHttpClientImpl ()\n  {\n    final PoolingHttpClientConnectionManager connectionManager =\n            kmsHttpConnectionManager.getConnectionManager();\n    httpClient = HttpClients.custom()\n            .setConnectionManager(connectionManager)\n            .build();\n  }\n\n  // This constructor is package private instead\n  // of public so it is not accidentally used by\n  // classes outside of this package. If your test\n  // class is not in the same package, then you\n  // need to make this a public constructor.\n  KMSHttpClientImpl (final HttpClient httpClient)\n  {\n    this.httpClient = httpClient;\n  }\n\n}\n</code></pre>\n<p>You then inject your mocked HttpClient using this constructor and will need neither <code>@InjectMocks</code> nor <code>@Mock</code> in your tests.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Test\npublic void testPostRequest () throws KMSClientException\n{\n  final HttpClient httpClient = Mockito.mock(HttpClient.class);\n  final HttpResponse response = prepareResponse(HttpStatus.SC_OK);\n  Mockito.when(httpClient.execute(Mockito.any())).thenReturn(response);\n  final KMSHttpClientImpl kmsHttpClientImpl = new KMSHttpClientImpl(httpClient);\n\n  // run your test...\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1961640,"reputation":12136,"user_id":1763035,"accept_rate":56,"display_name":"Andy Brown"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689953681,"creation_date":1689953681,"answer_id":76739352,"question_id":66115120,"body_markdown":"Apache HTTP client 5 deprecates the single argument `HttpClient.execute()` method in favour of the methods that take a `ResponseHandler` so that the library can ensure that the request is cleaned up.\r\n\r\nTo mock those calls, do this:\r\n```java\r\n// mock the http client\r\nCloseableHttpClient httpClient = mock(CloseableHttpClient.class);\r\n\r\n// mock the response object\r\nCloseableHttpResponse response = mock(CloseableHttpResponse.class);\r\nwhen(response.getCode()).thenReturn(200);\r\n// [...] add other mocks, e.g. response headers and body entity\r\n\r\n// provide the mock response object when your mock HttpClient is executed\r\n// replace any() with more specific matchers if you need to\r\n\r\nwhen(httpClient.execute(any(ClassicHttpRequest.class), any(HttpClientResponseHandler.class))).thenAnswer(invocation -&gt;\r\n  invocation.getArgument(1, HttpClientResponseHandler.class).handleResponse(response));\r\n```","title":"How to mock HttpClient using Mockito","body":"<p>Apache HTTP client 5 deprecates the single argument <code>HttpClient.execute()</code> method in favour of the methods that take a <code>ResponseHandler</code> so that the library can ensure that the request is cleaned up.</p>\n<p>To mock those calls, do this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>// mock the http client\nCloseableHttpClient httpClient = mock(CloseableHttpClient.class);\n\n// mock the response object\nCloseableHttpResponse response = mock(CloseableHttpResponse.class);\nwhen(response.getCode()).thenReturn(200);\n// [...] add other mocks, e.g. response headers and body entity\n\n// provide the mock response object when your mock HttpClient is executed\n// replace any() with more specific matchers if you need to\n\nwhen(httpClient.execute(any(ClassicHttpRequest.class), any(HttpClientResponseHandler.class))).thenAnswer(invocation -&gt;\n  invocation.getArgument(1, HttpClientResponseHandler.class).handleResponse(response));\n</code></pre>\n"}],"owner":{"account_id":8085618,"reputation":422,"user_id":6093274,"accept_rate":33,"display_name":"priyanka"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4620,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":4,"score":0,"last_activity_date":1689953681,"creation_date":1612858065,"question_id":66115120,"body_markdown":"This is my Actual class for which i am writing junit. I have HtpClient as private and final.\r\n\r\n     public class KMSHttpClientImpl implements KMSHttpClient\r\n     {\r\n    /**\r\n     * ObjectMapper Instance.\r\n     */\r\n    private final ObjectMapper objectMapper = new ObjectMapper ();\r\n\r\n    /**\r\n     * KMS ConnectionManager Instance.\r\n     */\r\n    private final KMSHttpConnectionManager kmsHttpConnectionManager =\r\n            new KMSHttpConnectionManagerImpl ();\r\n\r\n    /**\r\n     * HttpClient object.\r\n     */\r\n   \r\n    private final HttpClient httpClient;\r\n\r\n    /**\r\n     * KMSHttpClient constructor.\r\n     */\r\n    public KMSHttpClientImpl ()\r\n    {\r\n        // TODO PoolingHttpClientConnectionManager object should be closed after use.\r\n        // TODO This needs to be either singleton or should be kept in static block\r\n        final PoolingHttpClientConnectionManager connectionManager =\r\n                kmsHttpConnectionManager.getConnectionManager();\r\n        httpClient = HttpClients.custom()\r\n                .setConnectionManager(connectionManager)\r\n                .build();\r\n    }\r\n\r\n    @Override\r\n    public &lt;T&gt; T invokeGETRequest (final String url, final Class&lt;T&gt; clazz)\r\n            throws KMSClientException\r\n    {\r\n        final HttpGet httpGet = new HttpGet(url);\r\n        try {\r\n            final HttpResponse response = httpClient.execute(httpGet);\r\n            return objectMapper.readValue(\r\n                    response.getEntity().getContent(), clazz);\r\n        } catch (IOException e) {\r\n            throw new KMSClientException(&quot;Unable to get the result&quot;, e);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public &lt;T&gt; T invokePOSTRequest (final String url, final Object object, final Class&lt;T&gt; clazz)\r\n            throws KMSClientException\r\n    {\r\n        final HttpPost httpPost = new HttpPost(url);\r\n        try {\r\n            final HttpResponse response = httpClient.execute(httpPost);\r\n            return objectMapper.readValue(\r\n                    response.getEntity().getContent(), clazz);\r\n        } catch (IOException e) {\r\n            throw new KMSClientException(&quot;Unable to create the request&quot;, e);\r\n        }\r\n    }\r\n     }\r\n\r\nThis is my testclass. I am trying to Mock HttpClient but as it is final i cant mock it. And if i remove final from HttpClient in my KMSHttpClientImpl.java class. I am getting PMd issue saying\r\nPrivate field &#39;httpClient&#39; could be made final; it is only initialized in the declaration or constructor. What can i do to fix this issue?\r\n\r\n    public class KMSHttpClientImplTest\r\n    {\r\n\r\n    /**\r\n     * Injecting mocks KMSHttpClientImpl.\r\n     */\r\n    @InjectMocks\r\n    private KMSHttpClientImpl kmsHttpClientImpl;\r\n\r\n    /**\r\n     * Mock HttpClient.\r\n     */\r\n    @Mock\r\n    private HttpClient httpClient;\r\n\r\n\r\n    /**\r\n     * Initial SetUp Method.\r\n     */\r\n    @Before\r\n    public void setUp ()\r\n    {\r\n        initMocks(this);\r\n    }\r\n\r\n    /**\r\n     * Method to test postRequest Method.\r\n     * @throws KMSClientException\r\n     */\r\n    @Test\r\n    public void testPostRequest () throws KMSClientException\r\n    {\r\n        final OrganizationRequest request = getOrganizationRequest();\r\n        final HttpResponse response = prepareResponse(HttpStatus.SC_OK);\r\n        try {\r\n            Mockito.when(httpClient.execute(Mockito.any())).thenReturn(response);\r\n            final OrganizationResponse organizationResponse = kmsHttpClientImpl.invokePOSTRequest(\r\n                    ORG_TEST_URL, request, OrganizationResponse.class);\r\n            assertEquals(&quot;Id should match&quot;, ORG_ID, organizationResponse.getId());\r\n        } catch (IOException e) {\r\n            throw new KMSClientException(&quot;Unable to create the request&quot;, e);\r\n        }\r\n          }\r\n\r\n    /**\r\n     * Method to test getRequest Method.\r\n     * @throws KMSClientException\r\n     */\r\n    @Test\r\n    public void testGetRequest () throws KMSClientException\r\n    {\r\n        try {\r\n            final HttpResponse response = prepareResponse(HttpStatus.SC_OK);\r\n            Mockito.when(httpClient.execute(Mockito.any())).thenReturn(response);\r\n            final OrganizationResponse organizationResponse = kmsHttpClientImpl.invokeGETRequest\r\n                    (ORG_TEST_URL, OrganizationResponse.class);\r\n            assertEquals(&quot;Id should match&quot;, ORG_ID, organizationResponse.getId());\r\n        }  catch (IOException e) {\r\n            throw new KMSClientException(&quot;Unable to create the request&quot;, e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Method to organizationRequest Object.\r\n     * @return OrganizationRequest object\r\n     */\r\n    public OrganizationRequest getOrganizationRequest ()\r\n    {\r\n        return OrganizationRequest.builder().id(&quot;test&quot;).build();\r\n    }\r\n\r\n    /**\r\n     * Method to getOrganizationResponse String.\r\n     * @return String Object\r\n     */\r\n    public String getOrganizationResponse ()\r\n    {\r\n        final Map obj=new HashMap();\r\n        obj.put(&quot;id&quot;, ORG_ID);\r\n        obj.put(&quot;uuid&quot;, ORG_UUID);\r\n        obj.put(&quot;orgKeyId&quot;, ORG_KEYID);\r\n        return JSONValue.toJSONString(obj);\r\n    }\r\n\r\n    /**\r\n     * Method to prepare Response.\r\n     * @param expectedResponseStatus\r\n     * @return HttpResponse\r\n     */\r\n    private HttpResponse prepareResponse (final int expectedResponseStatus)\r\n    {\r\n        final HttpResponse response = new BasicHttpResponse(new BasicStatusLine(\r\n                new ProtocolVersion(&quot;HTTP&quot;, 1, 1),\r\n                expectedResponseStatus, &quot;&quot;));\r\n        response.setStatusCode(expectedResponseStatus);\r\n        final HttpEntity httpEntity = new StringEntity(getOrganizationResponse(),\r\n                ContentType.APPLICATION_JSON);\r\n        response.setEntity(httpEntity);\r\n        return response;\r\n         }\r\n        }\r\n","title":"How to mock HttpClient using Mockito","body":"<p>This is my Actual class for which i am writing junit. I have HtpClient as private and final.</p>\n<pre><code> public class KMSHttpClientImpl implements KMSHttpClient\n {\n/**\n * ObjectMapper Instance.\n */\nprivate final ObjectMapper objectMapper = new ObjectMapper ();\n\n/**\n * KMS ConnectionManager Instance.\n */\nprivate final KMSHttpConnectionManager kmsHttpConnectionManager =\n        new KMSHttpConnectionManagerImpl ();\n\n/**\n * HttpClient object.\n */\n\nprivate final HttpClient httpClient;\n\n/**\n * KMSHttpClient constructor.\n */\npublic KMSHttpClientImpl ()\n{\n    // TODO PoolingHttpClientConnectionManager object should be closed after use.\n    // TODO This needs to be either singleton or should be kept in static block\n    final PoolingHttpClientConnectionManager connectionManager =\n            kmsHttpConnectionManager.getConnectionManager();\n    httpClient = HttpClients.custom()\n            .setConnectionManager(connectionManager)\n            .build();\n}\n\n@Override\npublic &lt;T&gt; T invokeGETRequest (final String url, final Class&lt;T&gt; clazz)\n        throws KMSClientException\n{\n    final HttpGet httpGet = new HttpGet(url);\n    try {\n        final HttpResponse response = httpClient.execute(httpGet);\n        return objectMapper.readValue(\n                response.getEntity().getContent(), clazz);\n    } catch (IOException e) {\n        throw new KMSClientException(&quot;Unable to get the result&quot;, e);\n    }\n}\n\n@Override\npublic &lt;T&gt; T invokePOSTRequest (final String url, final Object object, final Class&lt;T&gt; clazz)\n        throws KMSClientException\n{\n    final HttpPost httpPost = new HttpPost(url);\n    try {\n        final HttpResponse response = httpClient.execute(httpPost);\n        return objectMapper.readValue(\n                response.getEntity().getContent(), clazz);\n    } catch (IOException e) {\n        throw new KMSClientException(&quot;Unable to create the request&quot;, e);\n    }\n}\n }\n</code></pre>\n<p>This is my testclass. I am trying to Mock HttpClient but as it is final i cant mock it. And if i remove final from HttpClient in my KMSHttpClientImpl.java class. I am getting PMd issue saying\nPrivate field 'httpClient' could be made final; it is only initialized in the declaration or constructor. What can i do to fix this issue?</p>\n<pre><code>public class KMSHttpClientImplTest\n{\n\n/**\n * Injecting mocks KMSHttpClientImpl.\n */\n@InjectMocks\nprivate KMSHttpClientImpl kmsHttpClientImpl;\n\n/**\n * Mock HttpClient.\n */\n@Mock\nprivate HttpClient httpClient;\n\n\n/**\n * Initial SetUp Method.\n */\n@Before\npublic void setUp ()\n{\n    initMocks(this);\n}\n\n/**\n * Method to test postRequest Method.\n * @throws KMSClientException\n */\n@Test\npublic void testPostRequest () throws KMSClientException\n{\n    final OrganizationRequest request = getOrganizationRequest();\n    final HttpResponse response = prepareResponse(HttpStatus.SC_OK);\n    try {\n        Mockito.when(httpClient.execute(Mockito.any())).thenReturn(response);\n        final OrganizationResponse organizationResponse = kmsHttpClientImpl.invokePOSTRequest(\n                ORG_TEST_URL, request, OrganizationResponse.class);\n        assertEquals(&quot;Id should match&quot;, ORG_ID, organizationResponse.getId());\n    } catch (IOException e) {\n        throw new KMSClientException(&quot;Unable to create the request&quot;, e);\n    }\n      }\n\n/**\n * Method to test getRequest Method.\n * @throws KMSClientException\n */\n@Test\npublic void testGetRequest () throws KMSClientException\n{\n    try {\n        final HttpResponse response = prepareResponse(HttpStatus.SC_OK);\n        Mockito.when(httpClient.execute(Mockito.any())).thenReturn(response);\n        final OrganizationResponse organizationResponse = kmsHttpClientImpl.invokeGETRequest\n                (ORG_TEST_URL, OrganizationResponse.class);\n        assertEquals(&quot;Id should match&quot;, ORG_ID, organizationResponse.getId());\n    }  catch (IOException e) {\n        throw new KMSClientException(&quot;Unable to create the request&quot;, e);\n    }\n}\n\n/**\n * Method to organizationRequest Object.\n * @return OrganizationRequest object\n */\npublic OrganizationRequest getOrganizationRequest ()\n{\n    return OrganizationRequest.builder().id(&quot;test&quot;).build();\n}\n\n/**\n * Method to getOrganizationResponse String.\n * @return String Object\n */\npublic String getOrganizationResponse ()\n{\n    final Map obj=new HashMap();\n    obj.put(&quot;id&quot;, ORG_ID);\n    obj.put(&quot;uuid&quot;, ORG_UUID);\n    obj.put(&quot;orgKeyId&quot;, ORG_KEYID);\n    return JSONValue.toJSONString(obj);\n}\n\n/**\n * Method to prepare Response.\n * @param expectedResponseStatus\n * @return HttpResponse\n */\nprivate HttpResponse prepareResponse (final int expectedResponseStatus)\n{\n    final HttpResponse response = new BasicHttpResponse(new BasicStatusLine(\n            new ProtocolVersion(&quot;HTTP&quot;, 1, 1),\n            expectedResponseStatus, &quot;&quot;));\n    response.setStatusCode(expectedResponseStatus);\n    final HttpEntity httpEntity = new StringEntity(getOrganizationResponse(),\n            ContentType.APPLICATION_JSON);\n    response.setEntity(httpEntity);\n    return response;\n     }\n    }\n</code></pre>\n"},{"tags":["java"],"comments":[{"owner":{"display_name":"user6073886"},"score":2,"creation_date":1689951107,"post_id":76739007,"comment_id":135289932,"body_markdown":"There are literally infinite possible Runtime Exceptions that can happen in java. So I&#39;m afraid unless you can provide us with more information about what that Runtime Error is that is happening, the chances of anyone figuring out what is wrong are rather small.","body":"There are literally infinite possible Runtime Exceptions that can happen in java. So I&#39;m afraid unless you can provide us with more information about what that Runtime Error is that is happening, the chances of anyone figuring out what is wrong are rather small."},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":0,"creation_date":1689951145,"post_id":76739007,"comment_id":135289941,"body_markdown":"Please [edit] the code and add the full stack trace of the exception. Please also highlight the line of code where the exception is thrown.","body":"Please <a href=\"https://stackoverflow.com/posts/76739007/edit\">edit</a> the code and add the full stack trace of the exception. Please also highlight the line of code where the exception is thrown."}],"answers":[{"tags":[],"owner":{"account_id":4228398,"reputation":17727,"user_id":3461397,"display_name":"Oleg Cherednik"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1689951546,"creation_date":1689951130,"answer_id":76739053,"question_id":76739007,"body_markdown":" - `for(int i = 0; i &lt;= 3; i++)` - you should iterate **exactly 3 times**. The correct is `for(int i = 0; i &lt; 3; i++)`.\r\n - Another big problem, you **shoule not close** the scanner `user.close();`. It is not an external resource, this is build-in java `System.in`. You close the scanner, i.e. you close this stream and anyone cannot use it anymore. But HackerRank framework you is afterwards.\r\n\r\n**P.S.** By the way. Let me show you more elegant and efficient solution. You can use `String.format()` to build required string.\r\n\r\n```java\r\npublic static void main(String... args) {\r\n    Scanner sc = new Scanner(System.in);\r\n    System.out.println(&quot;================================&quot;);\r\n    for (int i = 0; i &lt; 3; i++) {\r\n        String s1 = sc.next();\r\n        int x = sc.nextInt();\r\n        System.out.println(String.format(&quot;%-15s%03d&quot;, s1, x));\r\n    }\r\n    System.out.println(&quot;================================&quot;);\r\n}\r\n```","title":"How can I solve the runtime error problem in hacker rank while the same code runs successfully in VScode?","body":"<ul>\n<li><code>for(int i = 0; i &lt;= 3; i++)</code> - you should iterate <strong>exactly 3 times</strong>. The correct is <code>for(int i = 0; i &lt; 3; i++)</code>.</li>\n<li>Another big problem, you <strong>shoule not close</strong> the scanner <code>user.close();</code>. It is not an external resource, this is build-in java <code>System.in</code>. You close the scanner, i.e. you close this stream and anyone cannot use it anymore. But HackerRank framework you is afterwards.</li>\n</ul>\n<p><strong>P.S.</strong> By the way. Let me show you more elegant and efficient solution. You can use <code>String.format()</code> to build required string.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static void main(String... args) {\n    Scanner sc = new Scanner(System.in);\n    System.out.println(&quot;================================&quot;);\n    for (int i = 0; i &lt; 3; i++) {\n        String s1 = sc.next();\n        int x = sc.nextInt();\n        System.out.println(String.format(&quot;%-15s%03d&quot;, s1, x));\n    }\n    System.out.println(&quot;================================&quot;);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":23740623,"reputation":1,"user_id":17758716,"display_name":"Reilas"},"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1689953572,"creation_date":1689953263,"answer_id":76739297,"question_id":76739007,"body_markdown":"Firstly, the format would be,\r\n\r\n```java\r\nSystem.out.printf(&quot;%-15s%03d%n&quot;, s1, x);\r\n```\r\n\r\nOutput\r\n\r\n```none\r\n================================\r\njava           100\r\ncpp            065\r\npython         050\r\n================================\r\n```\r\n\r\nThe full list of _printf_ format specifiers can be found on the _[Formatter](https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/Formatter.html)_ class _JavaDoc_.\r\n\r\nIf you&#39;re not familiar, the _[printf](https://en.wikipedia.org/wiki/Printf)_ syntax is mostly inherited from the _[C](https://en.wikipedia.org/wiki/C_(programming_language))_ _printf_ format.\r\n\r\nHere is a relevant excerpt from the _JavaDoc_.\r\n\r\n&gt; _&quot;... Formatted printing for the Java language is heavily inspired by C&#39;s printf. Although the format strings are similar to C, some customizations have been made to accommodate the Java language and exploit some of its features. ...&quot;_\r\n\r\nIt&#39;s very simple to use, a specifier is denoted by a `%`, followed by a letter.  \r\nAn `s` represents a _String_, a `d` represents an integer value, and an `f` represents a floating-point value.  \r\nThere are additional specifiers as well.\r\n\r\nYou can modify the specifier with width, padding, and justification attributes.\r\n\r\n&gt; _&quot;... The format specifiers for general, character, and numeric types have the following syntax: ...&quot;_\r\n\r\n```none\r\n%[argument_index$][flags][width]_[.precision]conversion\r\n```\r\n\r\nAlthough, to answer your question specifically, as to why it is erroring.\r\n\r\nThe error is an _[InputMismatchException](https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/InputMismatchException.html)_, which is caused by the following line.\r\n\r\n```java\r\nint x=user.nextInt();\r\n```\r\n\r\nThis is because your preceding _Scanner_ capture uses the _[nextLine](https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/Scanner.html#nextLine())_ method, instead of the _[next](https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/Scanner.html#next())_ method.  \r\nIn the original _HackerRank_ example, they are using _next_.\r\n\r\n```java\r\nString s1=user.nextLine();\r\n```\r\n\r\nThe difference between the two is that the _nextLine_ method will return the entire line,\r\n\r\n```none\r\njava 100\r\n```\r\n\r\nAnd, the _next_ method will return just the token; in this case _&quot;java&quot;_.  \r\nThe default delimiter is a white-space character.\r\n\r\n_[Scanner (Java SE 20 &amp;amp; JDK 20)](https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/Scanner.html)_.\r\n\r\n&gt; _&quot;... A Scanner breaks its input into tokens using a delimiter pattern, which by default matches whitespace. The resulting tokens may then be converted into values of different types using the various next methods. ...&quot;_\r\n\r\nThus, calling _nextInt_ will attempt to return _&quot;cpp&quot;_ as an _int_, which doesn&#39;t parse.\r\n\r\nSubsequently, you are making another call to _nextLine_ after this; which will cause it to error further.","title":"How can I solve the runtime error problem in hacker rank while the same code runs successfully in VScode?","body":"<p>Firstly, the format would be,</p>\n<pre class=\"lang-java prettyprint-override\"><code>System.out.printf(&quot;%-15s%03d%n&quot;, s1, x);\n</code></pre>\n<p>Output</p>\n<pre class=\"lang-none prettyprint-override\"><code>================================\njava           100\ncpp            065\npython         050\n================================\n</code></pre>\n<p>The full list of <em>printf</em> format specifiers can be found on the <em><a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/Formatter.html\" rel=\"nofollow noreferrer\">Formatter</a></em> class <em>JavaDoc</em>.</p>\n<p>If you're not familiar, the <em><a href=\"https://en.wikipedia.org/wiki/Printf\" rel=\"nofollow noreferrer\">printf</a></em> syntax is mostly inherited from the <em><a href=\"https://en.wikipedia.org/wiki/C_(programming_language)\" rel=\"nofollow noreferrer\">C</a></em> <em>printf</em> format.</p>\n<p>Here is a relevant excerpt from the <em>JavaDoc</em>.</p>\n<blockquote>\n<p><em>&quot;... Formatted printing for the Java language is heavily inspired by C's printf. Although the format strings are similar to C, some customizations have been made to accommodate the Java language and exploit some of its features. ...&quot;</em></p>\n</blockquote>\n<p>It's very simple to use, a specifier is denoted by a <code>%</code>, followed by a letter.<br />\nAn <code>s</code> represents a <em>String</em>, a <code>d</code> represents an integer value, and an <code>f</code> represents a floating-point value.<br />\nThere are additional specifiers as well.</p>\n<p>You can modify the specifier with width, padding, and justification attributes.</p>\n<blockquote>\n<p><em>&quot;... The format specifiers for general, character, and numeric types have the following syntax: ...&quot;</em></p>\n</blockquote>\n<pre class=\"lang-none prettyprint-override\"><code>%[argument_index$][flags][width]_[.precision]conversion\n</code></pre>\n<p>Although, to answer your question specifically, as to why it is erroring.</p>\n<p>The error is an <em><a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/InputMismatchException.html\" rel=\"nofollow noreferrer\">InputMismatchException</a></em>, which is caused by the following line.</p>\n<pre class=\"lang-java prettyprint-override\"><code>int x=user.nextInt();\n</code></pre>\n<p>This is because your preceding <em>Scanner</em> capture uses the <em><a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/Scanner.html#nextLine()\" rel=\"nofollow noreferrer\">nextLine</a></em> method, instead of the <em><a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/Scanner.html#next()\" rel=\"nofollow noreferrer\">next</a></em> method.<br />\nIn the original <em>HackerRank</em> example, they are using <em>next</em>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>String s1=user.nextLine();\n</code></pre>\n<p>The difference between the two is that the <em>nextLine</em> method will return the entire line,</p>\n<pre class=\"lang-none prettyprint-override\"><code>java 100\n</code></pre>\n<p>And, the <em>next</em> method will return just the token; in this case <em>&quot;java&quot;</em>.<br />\nThe default delimiter is a white-space character.</p>\n<p><em><a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/Scanner.html\" rel=\"nofollow noreferrer\">Scanner (Java SE 20 &amp; JDK 20)</a></em>.</p>\n<blockquote>\n<p><em>&quot;... A Scanner breaks its input into tokens using a delimiter pattern, which by default matches whitespace. The resulting tokens may then be converted into values of different types using the various next methods. ...&quot;</em></p>\n</blockquote>\n<p>Thus, calling <em>nextInt</em> will attempt to return <em>&quot;cpp&quot;</em> as an <em>int</em>, which doesn't parse.</p>\n<p>Subsequently, you are making another call to <em>nextLine</em> after this; which will cause it to error further.</p>\n"}],"owner":{"account_id":24710538,"reputation":25,"user_id":18600791,"display_name":"Ebram Shereen"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":138,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"closed_date":1689954059,"accepted_answer_id":76739053,"answer_count":2,"score":2,"last_activity_date":1689953572,"creation_date":1689950786,"question_id":76739007,"body_markdown":"```\r\n\r\n\r\nimport java.util.*;\r\npublic class App {\r\n    public static void main(String[] args){\r\n        Scanner user=new Scanner(System.in);\r\n        int i,j;\r\n        for(i=0;i&lt;=3;i++){\r\n            String s1=user.nextLine();\r\n            int x=user.nextInt();\r\n            user.nextLine();\r\n            String space =&quot; &quot;;\r\n            for(j=0;j&lt;=15-s1.length();j++){\r\n                space =space+&quot; &quot;;\r\n            }\r\n            if(x&lt;100){\r\n                System.out.println(&quot;================================\\n&quot;);\r\n                String.valueOf(x);\r\n                String new_x=&quot;0&quot;+x;\r\n                System.out.println(s1+space+new_x+&quot;\\n&quot;);\r\n                System.out.println(&quot;================================\\n&quot;);\r\n            }\r\n            else if(x&lt;10){\r\n                System.out.println(&quot;================================\\n&quot;);\r\n                String.valueOf(x);\r\n                String new_x=&quot;00&quot;+x;\r\n                System.out.println(s1+space+new_x+&quot;\\n&quot;);\r\n                System.out.println(&quot;================================\\n&quot;);\r\n            }\r\n            else{\r\n                System.out.println(&quot;================================\\n&quot;);\r\n                System.out.println(s1+space+x+&quot;\\n&quot;);\r\n                System.out.println(&quot;================================\\n&quot;);\r\n            }\r\n        }\r\n        user.close();\r\n        }\r\n}\r\n```\r\n\r\nThe problem in hacker rank talked about writing strings and integers in input and making space between strings and integers.\r\n\r\nSpace + String must equal 15 index, and I put the link to the hacker rank question under the code.\r\n\r\nThis is Hacker rank link:&lt;https://www.hackerrank.com/challenges/java-output-formatting/problem?isFullScreen=true&gt;\r\n\r\nI tried to solve a HackerRank question on their website using Java, and it ran successfully in VS Code.\r\n\r\nHowever, when I attempted to run the same code on HackerRank, I encountered a runtime error.\r\n\r\nWhen I deleted all the for loops in the code, it gave me the wrong answer, not a runtime error.","title":"How can I solve the runtime error problem in hacker rank while the same code runs successfully in VScode?","body":"<pre><code>\n\nimport java.util.*;\npublic class App {\n    public static void main(String[] args){\n        Scanner user=new Scanner(System.in);\n        int i,j;\n        for(i=0;i&lt;=3;i++){\n            String s1=user.nextLine();\n            int x=user.nextInt();\n            user.nextLine();\n            String space =&quot; &quot;;\n            for(j=0;j&lt;=15-s1.length();j++){\n                space =space+&quot; &quot;;\n            }\n            if(x&lt;100){\n                System.out.println(&quot;================================\\n&quot;);\n                String.valueOf(x);\n                String new_x=&quot;0&quot;+x;\n                System.out.println(s1+space+new_x+&quot;\\n&quot;);\n                System.out.println(&quot;================================\\n&quot;);\n            }\n            else if(x&lt;10){\n                System.out.println(&quot;================================\\n&quot;);\n                String.valueOf(x);\n                String new_x=&quot;00&quot;+x;\n                System.out.println(s1+space+new_x+&quot;\\n&quot;);\n                System.out.println(&quot;================================\\n&quot;);\n            }\n            else{\n                System.out.println(&quot;================================\\n&quot;);\n                System.out.println(s1+space+x+&quot;\\n&quot;);\n                System.out.println(&quot;================================\\n&quot;);\n            }\n        }\n        user.close();\n        }\n}\n</code></pre>\n<p>The problem in hacker rank talked about writing strings and integers in input and making space between strings and integers.</p>\n<p>Space + String must equal 15 index, and I put the link to the hacker rank question under the code.</p>\n<p>This is Hacker rank link:<a href=\"https://www.hackerrank.com/challenges/java-output-formatting/problem?isFullScreen=true\" rel=\"nofollow noreferrer\">https://www.hackerrank.com/challenges/java-output-formatting/problem?isFullScreen=true</a></p>\n<p>I tried to solve a HackerRank question on their website using Java, and it ran successfully in VS Code.</p>\n<p>However, when I attempted to run the same code on HackerRank, I encountered a runtime error.</p>\n<p>When I deleted all the for loops in the code, it gave me the wrong answer, not a runtime error.</p>\n"},{"tags":["java","apache-kafka","jvm","apache-kafka-connect"],"comments":[{"owner":{"account_id":309588,"reputation":1743,"user_id":622121,"accept_rate":100,"display_name":"Kenji Noguchi"},"score":0,"creation_date":1486064286,"post_id":41964676,"comment_id":71197211,"body_markdown":"The &quot;default size&quot; seems to be [determined at run time](http://stackoverflow.com/questions/4667483/how-is-the-default-java-heap-size-determined).  It appears to be large enough in my machine (8G).  I still get the OOM error.  Besides, there are all sorts of other exceptions in the connector log, and the server stalls.  Very frustrating.","body":"The &quot;default size&quot; seems to be <a href=\"http://stackoverflow.com/questions/4667483/how-is-the-default-java-heap-size-determined\">determined at run time</a>.  It appears to be large enough in my machine (8G).  I still get the OOM error.  Besides, there are all sorts of other exceptions in the connector log, and the server stalls.  Very frustrating."},{"owner":{"account_id":294141,"reputation":7274,"user_id":1589422,"accept_rate":100,"display_name":"Robin Daugherty"},"score":1,"creation_date":1486158481,"post_id":41964676,"comment_id":71241598,"body_markdown":"From what I found, it&#39;s hard-coded to 256M: https://github.com/apache/kafka/blob/trunk/bin/kafka-run-class.sh#L209","body":"From what I found, it&#39;s hard-coded to 256M: <a href=\"https://github.com/apache/kafka/blob/trunk/bin/kafka-run-class.sh#L209\" rel=\"nofollow noreferrer\">github.com/apache/kafka/blob/trunk/bin/kafka-run-class.sh#L2&zwnj;&#8203;09</a>"},{"owner":{"account_id":309588,"reputation":1743,"user_id":622121,"accept_rate":100,"display_name":"Kenji Noguchi"},"score":0,"creation_date":1486170557,"post_id":41964676,"comment_id":71245106,"body_markdown":"ohhh! thank you.  That explains.","body":"ohhh! thank you.  That explains."}],"answers":[{"tags":[],"owner":{"account_id":294141,"reputation":7274,"user_id":1589422,"accept_rate":100,"display_name":"Robin Daugherty"},"down_vote_count":2,"up_vote_count":59,"is_accepted":true,"score":57,"last_activity_date":1547739908,"creation_date":1485886548,"answer_id":41964677,"question_id":41964676,"body_markdown":"You can control the max and initial heap size by setting the `KAFKA_HEAP_OPTS` environment variable.\r\n\r\nThe following example sets a starting size of 512 MB and a maximum size of 1 GB:\r\n\r\n    KAFKA_HEAP_OPTS=&quot;-Xms512m -Xmx1g&quot; connect-standalone connect-worker.properties connect-s3-sink.properties\r\n\r\nWhen running a Kafka command such as `connect-standalone`, the `kafka-run-class` script is invoked, which [sets a default heap size of 256 MB](https://github.com/apache/kafka/blob/trunk/bin/kafka-run-class.sh#L233) in the `KAFKA_HEAP_OPTS` environment variable if it is not already set.","title":"Kafka Connect running out of heap space","body":"<p>You can control the max and initial heap size by setting the <code>KAFKA_HEAP_OPTS</code> environment variable.</p>\n\n<p>The following example sets a starting size of 512 MB and a maximum size of 1 GB:</p>\n\n<pre><code>KAFKA_HEAP_OPTS=\"-Xms512m -Xmx1g\" connect-standalone connect-worker.properties connect-s3-sink.properties\n</code></pre>\n\n<p>When running a Kafka command such as <code>connect-standalone</code>, the <code>kafka-run-class</code> script is invoked, which <a href=\"https://github.com/apache/kafka/blob/trunk/bin/kafka-run-class.sh#L233\" rel=\"noreferrer\">sets a default heap size of 256 MB</a> in the <code>KAFKA_HEAP_OPTS</code> environment variable if it is not already set.</p>\n"},{"tags":[],"owner":{"account_id":7965404,"reputation":65,"user_id":6011762,"display_name":"Sagarmatha"},"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1528345527,"creation_date":1528343931,"answer_id":50732745,"question_id":41964676,"body_markdown":"Even I was facing the issue could not start my producer and consumer for a given topic. Also deleted all unnecessary log files and topics.Even though that&#39;s not related to the issue.\r\n\r\nChanging the `kafka-run-class.sh` did not work for me. I changed the below files \r\n\r\n&gt; kafka-console-consumer.sh\r\n&gt; \r\n&gt; kafka-console-producer.sh\r\n\r\nand stopped getting OOM error. Both consumer and producer worked fine after this.\r\n\r\nIncreased the size to `KAFKA_HEAP_OPTS=&quot;-Xmx1G&quot;` was 512m earlier.\r\n","title":"Kafka Connect running out of heap space","body":"<p>Even I was facing the issue could not start my producer and consumer for a given topic. Also deleted all unnecessary log files and topics.Even though that's not related to the issue.</p>\n\n<p>Changing the <code>kafka-run-class.sh</code> did not work for me. I changed the below files </p>\n\n<blockquote>\n  <p>kafka-console-consumer.sh</p>\n  \n  <p>kafka-console-producer.sh</p>\n</blockquote>\n\n<p>and stopped getting OOM error. Both consumer and producer worked fine after this.</p>\n\n<p>Increased the size to <code>KAFKA_HEAP_OPTS=\"-Xmx1G\"</code> was 512m earlier.</p>\n"},{"tags":[],"owner":{"account_id":1555104,"reputation":3384,"user_id":1446479,"accept_rate":45,"display_name":"peedee"},"down_vote_count":0,"up_vote_count":112,"is_accepted":false,"score":112,"last_activity_date":1587648771,"creation_date":1587550127,"answer_id":61362427,"question_id":41964676,"body_markdown":"When you have Kafka problems with \r\n\r\n    java.lang.OutOfMemoryError: Java heap space\r\n\r\nit doesn&#39;t necessarily mean that it&#39;s a memory problem. Several Kafka admin tools like `kafka-topics.sh` will mask the true error with this when trying to connect to an SSL PORT. The true (masked) error is `SSL handshake failed` !\r\n\r\nSee this issue: https://issues.apache.org/jira/browse/KAFKA-4090\r\n\r\nThe solution is to include a properties file in your command (for `kafka-topics.sh` this would be `--command-config`) and to absolutely include this line:\r\n\r\n    security.protocol=SSL","title":"Kafka Connect running out of heap space","body":"<p>When you have Kafka problems with </p>\n\n<pre><code>java.lang.OutOfMemoryError: Java heap space\n</code></pre>\n\n<p>it doesn't necessarily mean that it's a memory problem. Several Kafka admin tools like <code>kafka-topics.sh</code> will mask the true error with this when trying to connect to an SSL PORT. The true (masked) error is <code>SSL handshake failed</code> !</p>\n\n<p>See this issue: <a href=\"https://issues.apache.org/jira/browse/KAFKA-4090\" rel=\"noreferrer\">https://issues.apache.org/jira/browse/KAFKA-4090</a></p>\n\n<p>The solution is to include a properties file in your command (for <code>kafka-topics.sh</code> this would be <code>--command-config</code>) and to absolutely include this line:</p>\n\n<pre><code>security.protocol=SSL\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1419566,"reputation":694,"user_id":1344481,"accept_rate":79,"display_name":"Alex N."},"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1627326858,"creation_date":1627326858,"answer_id":68535319,"question_id":41964676,"body_markdown":"I found another cause of this issue this morning.  I was seeing this same exception except that I&#39;m not using SSL and my messages are very small.  The issue in my case turned out to be a misconfigured `bootstrap-servers` url.  If you configure that URL to be a server and port that is open but incorrect, you can cause this same exception.  The Kafka folks are aware of the general issue and are tracking it here: https://cwiki.apache.org/confluence/display/KAFKA/KIP-498%3A+Add+client-side+configuration+for+maximum+response+size+to+protect+against+OOM","title":"Kafka Connect running out of heap space","body":"<p>I found another cause of this issue this morning.  I was seeing this same exception except that I'm not using SSL and my messages are very small.  The issue in my case turned out to be a misconfigured <code>bootstrap-servers</code> url.  If you configure that URL to be a server and port that is open but incorrect, you can cause this same exception.  The Kafka folks are aware of the general issue and are tracking it here: <a href=\"https://cwiki.apache.org/confluence/display/KAFKA/KIP-498%3A+Add+client-side+configuration+for+maximum+response+size+to+protect+against+OOM\" rel=\"noreferrer\">https://cwiki.apache.org/confluence/display/KAFKA/KIP-498%3A+Add+client-side+configuration+for+maximum+response+size+to+protect+against+OOM</a></p>\n"},{"tags":[],"owner":{"account_id":133310,"reputation":6104,"user_id":334569,"accept_rate":73,"display_name":"Marco Lackovic"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1674655823,"creation_date":1674653900,"answer_id":75234814,"question_id":41964676,"body_markdown":"In my case, using a **Spring Boot 2.7.8** application leveraging Spring Boot **Kafka auto-configuration** (no configuration in Java code), the problem was caused by the security protocol not being set (apparently the default value is `PLAINTEXT`). Other errors I got together with `java.lang.OutOfMemoryError: Java heap space` are:\r\n\r\n```\r\nStopping container due to an Error\r\nError while stopping the container: \r\nUncaught exception in thread &#39;kafka-producer-network-thread | producer-&#39;:\r\n```\r\n\r\nThe solution was to add the following lines to my `application.properties`:\r\n\r\n```\r\nspring.kafka.consumer.security.protocol=SSL\r\nspring.kafka.producer.security.protocol=SSL\r\n```\r\n\r\nMy attempt to fix it with just:\r\n\r\n```\r\nspring.kafka.security.protocol=SSL \r\n```\r\n\r\ndid not work.","title":"Kafka Connect running out of heap space","body":"<p>In my case, using a <strong>Spring Boot 2.7.8</strong> application leveraging Spring Boot <strong>Kafka auto-configuration</strong> (no configuration in Java code), the problem was caused by the security protocol not being set (apparently the default value is <code>PLAINTEXT</code>). Other errors I got together with <code>java.lang.OutOfMemoryError: Java heap space</code> are:</p>\n<pre><code>Stopping container due to an Error\nError while stopping the container: \nUncaught exception in thread 'kafka-producer-network-thread | producer-':\n</code></pre>\n<p>The solution was to add the following lines to my <code>application.properties</code>:</p>\n<pre><code>spring.kafka.consumer.security.protocol=SSL\nspring.kafka.producer.security.protocol=SSL\n</code></pre>\n<p>My attempt to fix it with just:</p>\n<pre><code>spring.kafka.security.protocol=SSL \n</code></pre>\n<p>did not work.</p>\n"}],"owner":{"account_id":294141,"reputation":7274,"user_id":1589422,"accept_rate":100,"display_name":"Robin Daugherty"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":109683,"favorite_count":0,"down_vote_count":0,"up_vote_count":60,"accepted_answer_id":41964677,"answer_count":5,"score":60,"last_activity_date":1689953274,"creation_date":1485886548,"question_id":41964676,"body_markdown":"After starting Kafka Connect (`connect-standalone`), my task fails immediately after starting with:\r\n\r\n    java.lang.OutOfMemoryError: Java heap space\r\n    \tat java.nio.HeapByteBuffer.&lt;init&gt;(HeapByteBuffer.java:57)\r\n    \tat java.nio.ByteBuffer.allocate(ByteBuffer.java:335)\r\n    \tat org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:93)\r\n    \tat org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:71)\r\n    \tat org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:154)\r\n    \tat org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:135)\r\n    \tat org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:343)\r\n    \tat org.apache.kafka.common.network.Selector.poll(Selector.java:291)\r\n    \tat org.apache.kafka.clients.NetworkClient.poll(NetworkClient.java:260)\r\n    \tat org.apache.kafka.clients.consumer.internals.ConsumerNetworkClient.poll(ConsumerNetworkClient.java:232)\r\n    \tat org.apache.kafka.clients.consumer.internals.ConsumerNetworkClient.poll(ConsumerNetworkClient.java:180)\r\n    \tat org.apache.kafka.clients.consumer.internals.AbstractCoordinator.ensureCoordinatorReady(AbstractCoordinator.java:193)\r\n    \tat org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.poll(ConsumerCoordinator.java:248)\r\n    \tat org.apache.kafka.clients.consumer.KafkaConsumer.pollOnce(KafkaConsumer.java:1013)\r\n    \tat org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:979)\r\n    \tat org.apache.kafka.connect.runtime.WorkerSinkTask.pollConsumer(WorkerSinkTask.java:316)\r\n    \tat org.apache.kafka.connect.runtime.WorkerSinkTask.poll(WorkerSinkTask.java:222)\r\n    \tat org.apache.kafka.connect.runtime.WorkerSinkTask.iteration(WorkerSinkTask.java:170)\r\n    \tat org.apache.kafka.connect.runtime.WorkerSinkTask.execute(WorkerSinkTask.java:142)\r\n    \tat org.apache.kafka.connect.runtime.WorkerTask.doRun(WorkerTask.java:140)\r\n    \tat org.apache.kafka.connect.runtime.WorkerTask.run(WorkerTask.java:175)\r\n    \tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n    \tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n    \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n    \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n    \tat java.lang.Thread.run(Thread.java:745)\r\n\r\nThere&#39;s a mention of heap space in some Kafka documentation, telling you to try it with &quot;the default&quot; and only modifying it if there are problems, but there are no instructions to modify the heap space.","title":"Kafka Connect running out of heap space","body":"<p>After starting Kafka Connect (<code>connect-standalone</code>), my task fails immediately after starting with:</p>\n\n<pre><code>java.lang.OutOfMemoryError: Java heap space\n    at java.nio.HeapByteBuffer.&lt;init&gt;(HeapByteBuffer.java:57)\n    at java.nio.ByteBuffer.allocate(ByteBuffer.java:335)\n    at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:93)\n    at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:71)\n    at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:154)\n    at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:135)\n    at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:343)\n    at org.apache.kafka.common.network.Selector.poll(Selector.java:291)\n    at org.apache.kafka.clients.NetworkClient.poll(NetworkClient.java:260)\n    at org.apache.kafka.clients.consumer.internals.ConsumerNetworkClient.poll(ConsumerNetworkClient.java:232)\n    at org.apache.kafka.clients.consumer.internals.ConsumerNetworkClient.poll(ConsumerNetworkClient.java:180)\n    at org.apache.kafka.clients.consumer.internals.AbstractCoordinator.ensureCoordinatorReady(AbstractCoordinator.java:193)\n    at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.poll(ConsumerCoordinator.java:248)\n    at org.apache.kafka.clients.consumer.KafkaConsumer.pollOnce(KafkaConsumer.java:1013)\n    at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:979)\n    at org.apache.kafka.connect.runtime.WorkerSinkTask.pollConsumer(WorkerSinkTask.java:316)\n    at org.apache.kafka.connect.runtime.WorkerSinkTask.poll(WorkerSinkTask.java:222)\n    at org.apache.kafka.connect.runtime.WorkerSinkTask.iteration(WorkerSinkTask.java:170)\n    at org.apache.kafka.connect.runtime.WorkerSinkTask.execute(WorkerSinkTask.java:142)\n    at org.apache.kafka.connect.runtime.WorkerTask.doRun(WorkerTask.java:140)\n    at org.apache.kafka.connect.runtime.WorkerTask.run(WorkerTask.java:175)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\n</code></pre>\n\n<p>There's a mention of heap space in some Kafka documentation, telling you to try it with \"the default\" and only modifying it if there are problems, but there are no instructions to modify the heap space.</p>\n"},{"tags":["java","spring-boot","apache-camel","bindy"],"answers":[{"tags":[],"owner":{"account_id":1901420,"reputation":3763,"user_id":1717210,"display_name":"TacheDeChoco"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689854521,"creation_date":1689854521,"answer_id":76729649,"question_id":76725803,"body_markdown":"Have a look at the two following classes:\r\n\r\nhttps://github.com/apache/camel-spring-boot/tree/main/components-starter/camel-bindy-starter/src/main/java/org/apache/camel/dataformat/bindy/csv/springboot\r\n\r\nAs you will see, Camel will &quot;auto-mount&quot; several Bindy-oriented classes, so that they will be auto-wired when Spring(Boot) is going to instantiate the bindy component. \r\n\r\nAnd that case, you should of course NOT create your beans using the vanilla constructor (eg `new BindyCsvDataFormat`)","title":"Spring Boot auto-configuration not working for Apache Camel Bindy","body":"<p>Have a look at the two following classes:</p>\n<p><a href=\"https://github.com/apache/camel-spring-boot/tree/main/components-starter/camel-bindy-starter/src/main/java/org/apache/camel/dataformat/bindy/csv/springboot\" rel=\"nofollow noreferrer\">https://github.com/apache/camel-spring-boot/tree/main/components-starter/camel-bindy-starter/src/main/java/org/apache/camel/dataformat/bindy/csv/springboot</a></p>\n<p>As you will see, Camel will &quot;auto-mount&quot; several Bindy-oriented classes, so that they will be auto-wired when Spring(Boot) is going to instantiate the bindy component.</p>\n<p>And that case, you should of course NOT create your beans using the vanilla constructor (eg <code>new BindyCsvDataFormat</code>)</p>\n"}],"owner":{"account_id":5072657,"reputation":3280,"user_id":4071001,"display_name":"lcnicolau"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":158,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689953134,"creation_date":1689809679,"question_id":76725803,"body_markdown":"As described [here][1], and in the official documentation itself: the [`unwrapSingleInstance`][2] property allows us to establish *&quot;when unmarshalling should a single instance be unwrapped and returned instead of wrapped in a java.util.List&quot;*.\r\n\r\nHowever, the [`camel.dataformat.bindy-csv.unwrap-single-instance`][3] auto-configuration property of Spring Boot has no effect on the documentation example:\r\n\r\n    BindyCsvDataFormat bindy = new BindyCsvDataFormat(com.acme.model.MyModel.class);\r\n\r\n    from(&quot;file://inbox&quot;)\r\n      .unmarshal(bindy)\r\n      .to(&quot;direct:handleOrders&quot;);\r\n\r\nThe above example only works by setting the property this way, directly in the code:\r\n\r\n    bindy.setUnwrapSingleInstance(false);\r\n\r\nI guess this is because the `new BindyCsvDataFormat` object is not managed by Spring, so how can I get Spring to create and manage it for auto-configuration to take effect in Apache Camel?\r\n\r\n\r\n----------\r\n\r\n\r\nI tried to create a regular bean in Spring and set the reference in `unmarshal`, and auto-configuration has no effect either:\r\n\r\n    @Bean\r\n    public DataFormat bindyCsvDataFormat() {\r\n        return new BindyCsvDataFormat(com.acme.model.MyModel.class);\r\n    }\r\n\r\n    from(&quot;file://inbox&quot;)\r\n      .unmarshal(&quot;bindyCsvDataFormat&quot;)\r\n      .to(&quot;direct:handleOrders&quot;);\r\n\r\n----------\r\n\r\nI have this dependency in `pom.xml` with Apache Camel version `3.20.5`:\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.apache.camel.springboot&lt;/groupId&gt;\r\n        &lt;artifactId&gt;camel-bindy-starter&lt;/artifactId&gt;\r\n    &lt;/dependency&gt;\r\n\r\n  [1]: https://stackoverflow.com/a/49108296/4071001\r\n  [2]: https://camel.apache.org/components/3.20.x/dataformats/bindy-dataformat.html#_dataformat_option_unwrapSingleInstance\r\n  [3]: https://camel.apache.org/components/3.20.x/dataformats/bindy-dataformat.html#_sb_option_camel_dataformat_bindy-csv_unwrap-single-instance","title":"Spring Boot auto-configuration not working for Apache Camel Bindy","body":"<p>As described <a href=\"https://stackoverflow.com/a/49108296/4071001\">here</a>, and in the official documentation itself: the <a href=\"https://camel.apache.org/components/3.20.x/dataformats/bindy-dataformat.html#_dataformat_option_unwrapSingleInstance\" rel=\"nofollow noreferrer\"><code>unwrapSingleInstance</code></a> property allows us to establish <em>&quot;when unmarshalling should a single instance be unwrapped and returned instead of wrapped in a java.util.List&quot;</em>.</p>\n<p>However, the <a href=\"https://camel.apache.org/components/3.20.x/dataformats/bindy-dataformat.html#_sb_option_camel_dataformat_bindy-csv_unwrap-single-instance\" rel=\"nofollow noreferrer\"><code>camel.dataformat.bindy-csv.unwrap-single-instance</code></a> auto-configuration property of Spring Boot has no effect on the documentation example:</p>\n<pre><code>BindyCsvDataFormat bindy = new BindyCsvDataFormat(com.acme.model.MyModel.class);\n\nfrom(&quot;file://inbox&quot;)\n  .unmarshal(bindy)\n  .to(&quot;direct:handleOrders&quot;);\n</code></pre>\n<p>The above example only works by setting the property this way, directly in the code:</p>\n<pre><code>bindy.setUnwrapSingleInstance(false);\n</code></pre>\n<p>I guess this is because the <code>new BindyCsvDataFormat</code> object is not managed by Spring, so how can I get Spring to create and manage it for auto-configuration to take effect in Apache Camel?</p>\n<hr />\n<p>I tried to create a regular bean in Spring and set the reference in <code>unmarshal</code>, and auto-configuration has no effect either:</p>\n<pre><code>@Bean\npublic DataFormat bindyCsvDataFormat() {\n    return new BindyCsvDataFormat(com.acme.model.MyModel.class);\n}\n\nfrom(&quot;file://inbox&quot;)\n  .unmarshal(&quot;bindyCsvDataFormat&quot;)\n  .to(&quot;direct:handleOrders&quot;);\n</code></pre>\n<hr />\n<p>I have this dependency in <code>pom.xml</code> with Apache Camel version <code>3.20.5</code>:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.camel.springboot&lt;/groupId&gt;\n    &lt;artifactId&gt;camel-bindy-starter&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n"},{"tags":["java","security","encryption","bouncycastle","pgp"],"owner":{"account_id":23669507,"reputation":5,"user_id":17696490,"display_name":"Semih"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":211,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689953085,"creation_date":1689953085,"question_id":76739276,"body_markdown":"I have an encrypted csv type file that I created via [pgptool][1] and I want to decrypt this file in my java application using the [Bouncy Castle][2] library, but I get the error &quot;Encrypted message contains a signed message not literal data&quot;, what could be the reason for this? \r\n\r\nWhen I debug my code, it enters the following if block &quot;if (message instanceof PGPOnePassSignatureList)&quot; but I don&#39;t understand why it enters, I expect the type of my message to be &quot;PGPLiteralData&quot;?\r\n\r\nThis is my pgp message I want to decrypt:\r\n\r\n&gt; -----BEGIN PGP MESSAGE-----\r\n&gt;\r\n&gt; Version: Keybase OpenPGP v2.0.76 \r\n&gt; \r\n&gt; Comment: https://keybase.io/crypto\r\n&gt; \r\n&gt; wYwDLAyGLP4eR3cBA/43VKG4RcqQCFaJcy60+B0C/ZuyDtbgyYvU2DMA5h0F1wMY\r\n&gt; 2zT+XtBMp7ZFt8M9KuPiGzFKR/DvAtWgaTYKpJWqjlQmZVeRkEDauDnEn7ZIICBK\r\n&gt; rWgalv/pN8Odl6WHfGZ0qL4aPNDGfUiqkNmMhTZSj1oaMOgv/GZHItNX4iBGMtLA\r\n&gt; 9wGcGj9iyMK8LfV/wX2n0Bz7h21O64MO+ob7VhQej96xjpAS1NIU55o6ipI0YDam\r\n&gt; 8mxVZJPMMAAIVaXuzRygmMkhWyWX2tfTqSm1A9f6t7hvomw9SAdgc0Lvb7Qd8/aT\r\n&gt; 1UaGAIZgSX9AiWa+WuTVDO3uFszH2VD/ZhjhDDUhJFZNjdfikkQv1FMF6ysRuGkd\r\n&gt; 2PpzezqU4f5uwhgxK/qMRAtJEVkNtZfcRDQdSM/miuOF6ooQRtD7LJT7JzsFIAMW\r\n&gt; +nEkht9g6RT0LHbQMylGl5aJY9pAskmWbPO3mlL56XAWj7Owi2b8RKIrb92UoteS JkbzRoLBGzvyLaJ9RoE9i/bZqMxTvWVJrFQWEnAms0r/ZGP8gC8i4NtPROH6RdTk\r\n&gt; XJrUrg+zy+sizUemMcCiHQ0O+tVlV2biQ67DpAQJa6GHcvrryHygjPzaIPg+lJkS\r\n&gt; XHyCwafXedPY5eWhi1jdYyGOgvRZRrztTEb5QprDHBvONQv1cZcS55/DkC/iNT1y\r\n&gt; IHFoqgj20TsYcI47RR1Ejm6ey1DzZ2dOlHJrcdkhJOHYM7VVLDHR1cPBXDewP8t+\r\n&gt; \r\n&gt; 72Irzz2+SSE=\r\n&gt; \r\n&gt; =+pp7\r\n&gt; \r\n&gt; -----END PGP MESSAGE-----\r\n\r\nThese are my decryption codes:\r\n\r\n&gt; I.\r\n\r\n        public String decrypt(String encryptedData) {\r\n        try {\r\n            PgpDecryptionUtil pgpDecryptionUtil = new PgpDecryptionUtil(PRIVATE_KEY, PRIVATE_KEY_PASSWORD);\r\n            byte[] encryptedBytes = encryptedData.getBytes();\r\n            byte[] decryptedBytes = pgpDecryptionUtil.decrypt(encryptedBytes);\r\n            return new String(decryptedBytes, Charset.defaultCharset());\r\n        } catch (IOException | PGPException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n\r\n\r\n&gt; II.\r\n\r\n        public byte[] decrypt(byte[] encryptedBytes) throws PGPException, IOException {\r\n        ByteArrayInputStream encryptedIn = new ByteArrayInputStream(encryptedBytes);\r\n        ByteArrayOutputStream clearOut = new ByteArrayOutputStream();\r\n        decrypt(encryptedIn, clearOut);\r\n        return clearOut.toByteArray();\r\n    }\r\n\r\n&gt; III.\r\n\r\n        public void decrypt(InputStream encryptedIn, OutputStream clearOut)\r\n            throws PGPException, IOException {\r\n        // Removing armour and returning the underlying binary encrypted stream\r\n        encryptedIn = PGPUtil.getDecoderStream(encryptedIn);\r\n        JcaPGPObjectFactory pgpObjectFactory = new JcaPGPObjectFactory(encryptedIn);\r\n\r\n        Object obj = pgpObjectFactory.nextObject();\r\n        //The first object might be a marker packet\r\n        PGPEncryptedDataList pgpEncryptedDataList = (obj instanceof PGPEncryptedDataList)\r\n                ? (PGPEncryptedDataList) obj : (PGPEncryptedDataList) pgpObjectFactory.nextObject();\r\n\r\n        PGPPrivateKey pgpPrivateKey = null;\r\n        PGPPublicKeyEncryptedData publicKeyEncryptedData = null;\r\n\r\n        Iterator&lt;PGPEncryptedData&gt; encryptedDataItr = pgpEncryptedDataList.getEncryptedDataObjects();\r\n        while (pgpPrivateKey == null &amp;&amp; encryptedDataItr.hasNext()) {\r\n            publicKeyEncryptedData = (PGPPublicKeyEncryptedData) encryptedDataItr.next();\r\n            pgpPrivateKey = findSecretKey(publicKeyEncryptedData.getKeyID());\r\n        }\r\n\r\n        if (Objects.isNull(publicKeyEncryptedData)) {\r\n            throw new PGPException(&quot;Could not generate PGPPublicKeyEncryptedData object&quot;);\r\n        }\r\n\r\n        if (pgpPrivateKey == null) {\r\n            throw new PGPException(&quot;Could Not Extract private key&quot;);\r\n        }\r\n        CommonUtils.decrypt(clearOut, pgpPrivateKey, publicKeyEncryptedData);\r\n    }\r\n\r\n&gt; IV.\r\n\r\n        public static void decrypt(OutputStream clearOut, PGPPrivateKey pgpPrivateKey, PGPPublicKeyEncryptedData publicKeyEncryptedData) throws IOException, PGPException {\r\n        PublicKeyDataDecryptorFactory decryptorFactory = new JcePublicKeyDataDecryptorFactoryBuilder()\r\n                .setProvider(BouncyCastleProvider.PROVIDER_NAME).build(pgpPrivateKey);\r\n        InputStream decryptedCompressedIn = publicKeyEncryptedData.getDataStream(decryptorFactory);\r\n\r\n        JcaPGPObjectFactory decCompObjFac = new JcaPGPObjectFactory(decryptedCompressedIn);\r\n        PGPCompressedData pgpCompressedData = (PGPCompressedData) decCompObjFac.nextObject();\r\n\r\n        InputStream compressedDataStream = new BufferedInputStream(pgpCompressedData.getDataStream());\r\n        JcaPGPObjectFactory pgpCompObjFac = new JcaPGPObjectFactory(compressedDataStream);\r\n\r\n        Object message = pgpCompObjFac.nextObject();\r\n\r\n        if (message instanceof PGPLiteralData) {\r\n            PGPLiteralData pgpLiteralData = (PGPLiteralData) message;\r\n            InputStream decDataStream = pgpLiteralData.getInputStream();\r\n            IOUtils.copy(decDataStream, clearOut);\r\n            clearOut.close();\r\n        } else if (message instanceof PGPOnePassSignatureList) {\r\n            throw new PGPException(&quot;Encrypted message contains a signed message not literal data&quot;);\r\n        } else {\r\n            throw new PGPException(&quot;Message is not a simple encrypted file - Type Unknown&quot;);\r\n        }\r\n        // Performing Integrity check\r\n        if (publicKeyEncryptedData.isIntegrityProtected()) {\r\n            if (!publicKeyEncryptedData.verify()) {\r\n                throw new PGPException(&quot;Message failed integrity check&quot;);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n  [1]: https://pgptool.org/\r\n  [2]: https://www.bouncycastle.org/\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","title":"org.bouncycastle.openpgp.PGPException: Encrypted message contains a signed message not literal data","body":"<p>I have an encrypted csv type file that I created via <a href=\"https://pgptool.org/\" rel=\"nofollow noreferrer\">pgptool</a> and I want to decrypt this file in my java application using the <a href=\"https://www.bouncycastle.org/\" rel=\"nofollow noreferrer\">Bouncy Castle</a> library, but I get the error &quot;Encrypted message contains a signed message not literal data&quot;, what could be the reason for this?</p>\n<p>When I debug my code, it enters the following if block &quot;if (message instanceof PGPOnePassSignatureList)&quot; but I don't understand why it enters, I expect the type of my message to be &quot;PGPLiteralData&quot;?</p>\n<p>This is my pgp message I want to decrypt:</p>\n<blockquote>\n<p>-----BEGIN PGP MESSAGE-----</p>\n<p>Version: Keybase OpenPGP v2.0.76</p>\n<p>Comment: <a href=\"https://keybase.io/crypto\" rel=\"nofollow noreferrer\">https://keybase.io/crypto</a></p>\n<p>wYwDLAyGLP4eR3cBA/43VKG4RcqQCFaJcy60+B0C/ZuyDtbgyYvU2DMA5h0F1wMY\n2zT+XtBMp7ZFt8M9KuPiGzFKR/DvAtWgaTYKpJWqjlQmZVeRkEDauDnEn7ZIICBK\nrWgalv/pN8Odl6WHfGZ0qL4aPNDGfUiqkNmMhTZSj1oaMOgv/GZHItNX4iBGMtLA\n9wGcGj9iyMK8LfV/wX2n0Bz7h21O64MO+ob7VhQej96xjpAS1NIU55o6ipI0YDam\n8mxVZJPMMAAIVaXuzRygmMkhWyWX2tfTqSm1A9f6t7hvomw9SAdgc0Lvb7Qd8/aT\n1UaGAIZgSX9AiWa+WuTVDO3uFszH2VD/ZhjhDDUhJFZNjdfikkQv1FMF6ysRuGkd\n2PpzezqU4f5uwhgxK/qMRAtJEVkNtZfcRDQdSM/miuOF6ooQRtD7LJT7JzsFIAMW\n+nEkht9g6RT0LHbQMylGl5aJY9pAskmWbPO3mlL56XAWj7Owi2b8RKIrb92UoteS JkbzRoLBGzvyLaJ9RoE9i/bZqMxTvWVJrFQWEnAms0r/ZGP8gC8i4NtPROH6RdTk\nXJrUrg+zy+sizUemMcCiHQ0O+tVlV2biQ67DpAQJa6GHcvrryHygjPzaIPg+lJkS\nXHyCwafXedPY5eWhi1jdYyGOgvRZRrztTEb5QprDHBvONQv1cZcS55/DkC/iNT1y\nIHFoqgj20TsYcI47RR1Ejm6ey1DzZ2dOlHJrcdkhJOHYM7VVLDHR1cPBXDewP8t+</p>\n<p>72Irzz2+SSE=</p>\n<p>=+pp7</p>\n<p>-----END PGP MESSAGE-----</p>\n</blockquote>\n<p>These are my decryption codes:</p>\n<blockquote>\n<p>I.</p>\n</blockquote>\n<pre><code>    public String decrypt(String encryptedData) {\n    try {\n        PgpDecryptionUtil pgpDecryptionUtil = new PgpDecryptionUtil(PRIVATE_KEY, PRIVATE_KEY_PASSWORD);\n        byte[] encryptedBytes = encryptedData.getBytes();\n        byte[] decryptedBytes = pgpDecryptionUtil.decrypt(encryptedBytes);\n        return new String(decryptedBytes, Charset.defaultCharset());\n    } catch (IOException | PGPException e) {\n        throw new RuntimeException(e);\n    }\n}\n</code></pre>\n<blockquote>\n<p>II.</p>\n</blockquote>\n<pre><code>    public byte[] decrypt(byte[] encryptedBytes) throws PGPException, IOException {\n    ByteArrayInputStream encryptedIn = new ByteArrayInputStream(encryptedBytes);\n    ByteArrayOutputStream clearOut = new ByteArrayOutputStream();\n    decrypt(encryptedIn, clearOut);\n    return clearOut.toByteArray();\n}\n</code></pre>\n<blockquote>\n<p>III.</p>\n</blockquote>\n<pre><code>    public void decrypt(InputStream encryptedIn, OutputStream clearOut)\n        throws PGPException, IOException {\n    // Removing armour and returning the underlying binary encrypted stream\n    encryptedIn = PGPUtil.getDecoderStream(encryptedIn);\n    JcaPGPObjectFactory pgpObjectFactory = new JcaPGPObjectFactory(encryptedIn);\n\n    Object obj = pgpObjectFactory.nextObject();\n    //The first object might be a marker packet\n    PGPEncryptedDataList pgpEncryptedDataList = (obj instanceof PGPEncryptedDataList)\n            ? (PGPEncryptedDataList) obj : (PGPEncryptedDataList) pgpObjectFactory.nextObject();\n\n    PGPPrivateKey pgpPrivateKey = null;\n    PGPPublicKeyEncryptedData publicKeyEncryptedData = null;\n\n    Iterator&lt;PGPEncryptedData&gt; encryptedDataItr = pgpEncryptedDataList.getEncryptedDataObjects();\n    while (pgpPrivateKey == null &amp;&amp; encryptedDataItr.hasNext()) {\n        publicKeyEncryptedData = (PGPPublicKeyEncryptedData) encryptedDataItr.next();\n        pgpPrivateKey = findSecretKey(publicKeyEncryptedData.getKeyID());\n    }\n\n    if (Objects.isNull(publicKeyEncryptedData)) {\n        throw new PGPException(&quot;Could not generate PGPPublicKeyEncryptedData object&quot;);\n    }\n\n    if (pgpPrivateKey == null) {\n        throw new PGPException(&quot;Could Not Extract private key&quot;);\n    }\n    CommonUtils.decrypt(clearOut, pgpPrivateKey, publicKeyEncryptedData);\n}\n</code></pre>\n<blockquote>\n<p>IV.</p>\n</blockquote>\n<pre><code>    public static void decrypt(OutputStream clearOut, PGPPrivateKey pgpPrivateKey, PGPPublicKeyEncryptedData publicKeyEncryptedData) throws IOException, PGPException {\n    PublicKeyDataDecryptorFactory decryptorFactory = new JcePublicKeyDataDecryptorFactoryBuilder()\n            .setProvider(BouncyCastleProvider.PROVIDER_NAME).build(pgpPrivateKey);\n    InputStream decryptedCompressedIn = publicKeyEncryptedData.getDataStream(decryptorFactory);\n\n    JcaPGPObjectFactory decCompObjFac = new JcaPGPObjectFactory(decryptedCompressedIn);\n    PGPCompressedData pgpCompressedData = (PGPCompressedData) decCompObjFac.nextObject();\n\n    InputStream compressedDataStream = new BufferedInputStream(pgpCompressedData.getDataStream());\n    JcaPGPObjectFactory pgpCompObjFac = new JcaPGPObjectFactory(compressedDataStream);\n\n    Object message = pgpCompObjFac.nextObject();\n\n    if (message instanceof PGPLiteralData) {\n        PGPLiteralData pgpLiteralData = (PGPLiteralData) message;\n        InputStream decDataStream = pgpLiteralData.getInputStream();\n        IOUtils.copy(decDataStream, clearOut);\n        clearOut.close();\n    } else if (message instanceof PGPOnePassSignatureList) {\n        throw new PGPException(&quot;Encrypted message contains a signed message not literal data&quot;);\n    } else {\n        throw new PGPException(&quot;Message is not a simple encrypted file - Type Unknown&quot;);\n    }\n    // Performing Integrity check\n    if (publicKeyEncryptedData.isIntegrityProtected()) {\n        if (!publicKeyEncryptedData.verify()) {\n            throw new PGPException(&quot;Message failed integrity check&quot;);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["java","time","localization","java-17","datetimeformatter"],"comments":[{"owner":{"account_id":6714862,"reputation":16230,"user_id":5176992,"display_name":"Eritrean"},"score":0,"creation_date":1648135714,"post_id":71604798,"comment_id":126552779,"body_markdown":"Are you sure that worked with java 11 without a custom formater? I don&#39;t think so. You have probably used a `DateTimeFormatterBuilder` and appended a custom `ChronoField.AMPM_OF_DAY` to it. I would be surprised if it worked since it is not usual to format dates having `vorm.` and `nachm.`  as a subtitute for `am/pm`. Besides `HH` is for 24 hour format; it should be `hh:mm ....`","body":"Are you sure that worked with java 11 without a custom formater? I don&#39;t think so. You have probably used a <code>DateTimeFormatterBuilder</code> and appended a custom <code>ChronoField.AMPM_OF_DAY</code> to it. I would be surprised if it worked since it is not usual to format dates having <code>vorm.</code> and <code>nachm.</code>  as a subtitute for <code>am&#47;pm</code>. Besides <code>HH</code> is for 24 hour format; it should be <code>hh:mm ....</code>"},{"owner":{"account_id":6714862,"reputation":16230,"user_id":5176992,"display_name":"Eritrean"},"score":0,"creation_date":1648136631,"post_id":71604798,"comment_id":126553200,"body_markdown":"https://stackoverflow.com/questions/44411475/how-to-change-am-pm-symbol-to-my-own-alphabet-when-using-java-8-date-time-api","body":"<a href=\"https://stackoverflow.com/questions/44411475/how-to-change-am-pm-symbol-to-my-own-alphabet-when-using-java-8-date-time-api\" title=\"how to change am pm symbol to my own alphabet when using java 8 date time api\">stackoverflow.com/questions/44411475/&hellip;</a>"},{"owner":{"account_id":4262172,"reputation":23,"user_id":3486252,"display_name":"domkol"},"score":0,"creation_date":1648140714,"post_id":71604798,"comment_id":126554941,"body_markdown":"@Eritrean Yes, I&#39;m sure that it worked under Java 11 without any custom formatter because the code has not been changed and it really is as mentioned in the question. No, the code is not using `DateTimeFormatterBuilder` but I have now looked into that method `ofPattern` and that is using the builder: `return new DateTimeFormatterBuilder().appendPattern(pattern).toFormatter(locale);` I agree that localised substitutes are rare but it&#39;s a requirement. You&#39;re right about the pattern but I didn&#39;t define mine.","body":"@Eritrean Yes, I&#39;m sure that it worked under Java 11 without any custom formatter because the code has not been changed and it really is as mentioned in the question. No, the code is not using <code>DateTimeFormatterBuilder</code> but I have now looked into that method <code>ofPattern</code> and that is using the builder: <code>return new DateTimeFormatterBuilder().appendPattern(pattern).toFormatte&zwnj;&#8203;r(locale);</code> I agree that localised substitutes are rare but it&#39;s a requirement. You&#39;re right about the pattern but I didn&#39;t define mine."},{"owner":{"account_id":4262172,"reputation":23,"user_id":3486252,"display_name":"domkol"},"score":0,"creation_date":1648140895,"post_id":71604798,"comment_id":126555021,"body_markdown":"Just in case of someone asking: Replacing the pattern `HH:mm:ss a` to `hh:mm:ss a` did not change the output in this case.","body":"Just in case of someone asking: Replacing the pattern <code>HH:mm:ss a</code> to <code>hh:mm:ss a</code> did not change the output in this case."},{"owner":{"account_id":7612423,"reputation":82486,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1648236392,"post_id":71604798,"comment_id":126582023,"body_markdown":"It’s probably the locale data bundled with Java 17 being different, not the formatter class itself.","body":"It’s probably the locale data bundled with Java 17 being different, not the formatter class itself."},{"owner":{"account_id":7612423,"reputation":82486,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1648237066,"post_id":71604798,"comment_id":126582204,"body_markdown":"I can only partially reproduce your observations in my Java 17.  While for locales `Locale.GERMAN` and `Locale.GERMANY` I do get `PM`, for many other locales I do not. Including locales of language codes he, lv, yi, cs, el, af, sa, fa, lb and no.","body":"I can only partially reproduce your observations in my Java 17.  While for locales <code>Locale.GERMAN</code> and <code>Locale.GERMANY</code> I do get <code>PM</code>, for many other locales I do not. Including locales of language codes he, lv, yi, cs, el, af, sa, fa, lb and no."},{"owner":{"account_id":185127,"reputation":2955,"user_id":2471311,"display_name":"Klara"},"score":0,"creation_date":1669209823,"post_id":71604798,"comment_id":131592210,"body_markdown":"It seems the locale data is the same - for example https://github.com/openjdk/jdk11/blob/master/src/jdk.localedata/share/classes/sun/text/resources/ext/JavaTimeSupplementary_de.java#L84 vs https://github.com/openjdk/jdk17/blob/master/src/jdk.localedata/share/classes/sun/text/resources/ext/JavaTimeSupplementary_de.java#L84 is both nachm. for German","body":"It seems the locale data is the same - for example <a href=\"https://github.com/openjdk/jdk11/blob/master/src/jdk.localedata/share/classes/sun/text/resources/ext/JavaTimeSupplementary_de.java#L84\" rel=\"nofollow noreferrer\">github.com/openjdk/jdk11/blob/master/src/jdk.localedata/shar&zwnj;&#8203;e/&hellip;</a> vs <a href=\"https://github.com/openjdk/jdk17/blob/master/src/jdk.localedata/share/classes/sun/text/resources/ext/JavaTimeSupplementary_de.java#L84\" rel=\"nofollow noreferrer\">github.com/openjdk/jdk17/blob/master/src/jdk.localedata/shar&zwnj;&#8203;e/&hellip;</a> is both nachm. for German"}],"answers":[{"tags":[],"owner":{"account_id":9047217,"reputation":31,"user_id":6738996,"display_name":"Prateek Vyas"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689952848,"creation_date":1688979956,"answer_id":76652262,"question_id":71604798,"body_markdown":"Creating proper datetime format with correct `Chronology` and `Locale` will give am/pm in desired locale. For Germany and Chinese, I was able to get correct data, but for Hindi and Italy it’s not giving expected output. May be this is how data is showed in their respective region.\r\n\r\n    final String pattern = DateTimeFormatterBuilder.getLocalizedDateTimePattern(FormatStyle.FULL, FormatStyle.FULL, Chronology.ofLocale(Locale.GERMAN),Locale.GERMAN);\r\n    final DateTimeFormatter targetFormat = DateTimeFormatter.ofPattern(pattern).withLocale(Locale.GERMAN);\r\n    final String value = ZonedDateTime.now().format(targetFormat);","title":"Java 17: DateTimeFormatter not localising AM/PM marker","body":"<p>Creating proper datetime format with correct <code>Chronology</code> and <code>Locale</code> will give am/pm in desired locale. For Germany and Chinese, I was able to get correct data, but for Hindi and Italy it’s not giving expected output. May be this is how data is showed in their respective region.</p>\n<pre><code>final String pattern = DateTimeFormatterBuilder.getLocalizedDateTimePattern(FormatStyle.FULL, FormatStyle.FULL, Chronology.ofLocale(Locale.GERMAN),Locale.GERMAN);\nfinal DateTimeFormatter targetFormat = DateTimeFormatter.ofPattern(pattern).withLocale(Locale.GERMAN);\nfinal String value = ZonedDateTime.now().format(targetFormat);\n</code></pre>\n"}],"owner":{"account_id":4262172,"reputation":23,"user_id":3486252,"display_name":"domkol"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":863,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1689952848,"creation_date":1648133937,"question_id":71604798,"body_markdown":"I currently am migrating a piece of software from Java 11 to Java 17 and noticed that `DateTimeFormatter` has changed its behaviour when formatting time that contains the AM/PM marker. Earlier, that marker would have been localised (e.g. `vorm.` for AM in German) and now, it stays AM. This is not a locale-specific issue, because I already have tried this with other locales. The pattern that is being tried here is `HH:mm:ss a`, where `a` is the place holder of the marker. How can the previous behaviour be restored?\r\n\r\nThe `DateTimeFormatter` is being called using the `ofPattern` method as follows:\r\n`ofPattern(&quot;HH:mm:ss a&quot;, Locale.GERMANY).format(now)`.\r\nThe variable `now` is a LocalDateTime object.","title":"Java 17: DateTimeFormatter not localising AM/PM marker","body":"<p>I currently am migrating a piece of software from Java 11 to Java 17 and noticed that <code>DateTimeFormatter</code> has changed its behaviour when formatting time that contains the AM/PM marker. Earlier, that marker would have been localised (e.g. <code>vorm.</code> for AM in German) and now, it stays AM. This is not a locale-specific issue, because I already have tried this with other locales. The pattern that is being tried here is <code>HH:mm:ss a</code>, where <code>a</code> is the place holder of the marker. How can the previous behaviour be restored?</p>\n<p>The <code>DateTimeFormatter</code> is being called using the <code>ofPattern</code> method as follows:\n<code>ofPattern(&quot;HH:mm:ss a&quot;, Locale.GERMANY).format(now)</code>.\nThe variable <code>now</code> is a LocalDateTime object.</p>\n"},{"tags":["java","apache-poi","mapi"],"answers":[{"tags":[],"owner":{"account_id":131793,"reputation":64005,"user_id":332059,"accept_rate":57,"display_name":"Dmitry Streblechenko"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689952574,"creation_date":1689952574,"answer_id":76739220,"question_id":76737743,"body_markdown":"The error is very specific - you are feeding the converter class a text file as if it were MSG. `6465766965636552` is `&quot;devieceR&quot;`, so yes, it is definitely not an MSG file. \r\n\r\nOpen it in Notepad to see what kind of data you have.","title":"How to convert .eml to .msg in java for free","body":"<p>The error is very specific - you are feeding the converter class a text file as if it were MSG. <code>6465766965636552</code> is <code>&quot;devieceR&quot;</code>, so yes, it is definitely not an MSG file.</p>\n<p>Open it in Notepad to see what kind of data you have.</p>\n"}],"owner":{"account_id":22875455,"reputation":1,"user_id":17017862,"display_name":"preet leelaramani"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":114,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1690300101,"answer_count":1,"score":0,"last_activity_date":1689952574,"creation_date":1689940305,"question_id":76737743,"body_markdown":"Requirement\r\nWe are calling API..The API need .msg file in request.\r\n\r\nLogic\r\nI have .eml file in my local diskspace, I want to convert into .msg in java for free.\r\nCode Snippet :\r\n\r\nString msg_file_path=&quot;C:\\\\temp\\\\msg_email.msg&quot;;\r\n\r\nFileOutputStream msg_file = new FileOutputStream(msg_file_path);\r\n\r\ntry {\r\n\r\nMAPIMessage msgObj = new MAPIMessage(&quot;C:\\\\temp\\\\_emai.eml&quot;);\r\n\r\nmsgObj.write(msg_file);\r\n\r\nSystem.out.println(&quot;EML file converted to MSG: &quot; + msg_file);\r\n\r\n}\r\n\r\ncatch (Exception e) {\r\n\r\ne.printStackTrace();\r\n\r\n}\r\n\r\nGetting below error:\r\n\r\nrg.apache.poi.poifs.filesystem.NotOLE2FileException: Invalid header signature; read 0x6465766965636552, expected 0xE11AB1A1E011CFD0 - Your file appears not to be a valid OLE2 document\r\n","title":"How to convert .eml to .msg in java for free","body":"<p>Requirement\nWe are calling API..The API need .msg file in request.</p>\n<p>Logic\nI have .eml file in my local diskspace, I want to convert into .msg in java for free.\nCode Snippet :</p>\n<p>String msg_file_path=&quot;C:\\temp\\msg_email.msg&quot;;</p>\n<p>FileOutputStream msg_file = new FileOutputStream(msg_file_path);</p>\n<p>try {</p>\n<p>MAPIMessage msgObj = new MAPIMessage(&quot;C:\\temp\\_emai.eml&quot;);</p>\n<p>msgObj.write(msg_file);</p>\n<p>System.out.println(&quot;EML file converted to MSG: &quot; + msg_file);</p>\n<p>}</p>\n<p>catch (Exception e) {</p>\n<p>e.printStackTrace();</p>\n<p>}</p>\n<p>Getting below error:</p>\n<p>rg.apache.poi.poifs.filesystem.NotOLE2FileException: Invalid header signature; read 0x6465766965636552, expected 0xE11AB1A1E011CFD0 - Your file appears not to be a valid OLE2 document</p>\n"},{"tags":["java","mockito"],"comments":[{"owner":{"account_id":212417,"reputation":43614,"user_id":465223,"accept_rate":75,"display_name":"dunni"},"score":0,"creation_date":1665653890,"post_id":74053211,"comment_id":130752155,"body_markdown":"Is it actually a problem? To me it just looks like a debug or informational message from Mockito. Do you get an exception or error in the first case?","body":"Is it actually a problem? To me it just looks like a debug or informational message from Mockito. Do you get an exception or error in the first case?"},{"owner":{"account_id":18068865,"reputation":23,"user_id":13133976,"display_name":"climy007"},"score":0,"creation_date":1665716301,"post_id":74053211,"comment_id":130768600,"body_markdown":"I didn&#39;t get any exception in the first case. But the method is called 2 times, and the test case should be passed, while it just told me that `Condition not satisfied`. When I change the `times(2)` to `times(1)`, the error message is just like the second case.","body":"I didn&#39;t get any exception in the first case. But the method is called 2 times, and the test case should be passed, while it just told me that <code>Condition not satisfied</code>. When I change the <code>times(2)</code> to <code>times(1)</code>, the error message is just like the second case."},{"owner":{"account_id":18068865,"reputation":23,"user_id":13133976,"display_name":"climy007"},"score":0,"creation_date":1665999710,"post_id":74053211,"comment_id":130822854,"body_markdown":"No, I didn&#39;t Mock the native/system class.","body":"No, I didn&#39;t Mock the native/system class."}],"answers":[{"tags":[],"owner":{"account_id":1534622,"reputation":1593,"user_id":1430991,"display_name":"gce"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689952311,"creation_date":1689952311,"answer_id":76739188,"question_id":74053211,"body_markdown":"Adding `|| true` helped me resolve similar issue:\r\n\r\n    verify(mock, times(2)).methodName(captor.capture()) || true","title":"When using Mockito verify method `times` got null","body":"<p>Adding <code>|| true</code> helped me resolve similar issue:</p>\n<pre><code>verify(mock, times(2)).methodName(captor.capture()) || true\n</code></pre>\n"}],"owner":{"account_id":18068865,"reputation":23,"user_id":13133976,"display_name":"climy007"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":173,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1689952311,"creation_date":1665652197,"question_id":74053211,"body_markdown":"When I trying to use Mockito verify to test extral call times of testMethod(indeed this method is just execute 2 times), but I got following message.\r\n```\r\nverify(XXXXXXX, times(2)).testMethod(any(XXXXXX.class))\r\n|      |          |         |        |        |\r\n|      |          |         null    null      class XXXXXX\r\n|      |          Wanted invocations count: 2\r\n|      Mock for XXXXXXX, hashCode: 292294397\r\nMock for XXXXXXX, hashCode: 292294397\r\n```\r\nIf I change the times to 1, and the error message is:\r\n```\r\nverify(XXXXXXX, times(1)).testMethod(any(XXXXXX.class))\r\n|      |          |         |     |         |\r\n|      |          |         |     null      class XXX\r\n|      |          |         org.mockito.exceptions.verification.TooManyActualInvocations: \r\n|      |          |         XXX.XXXX(\r\n|      |          |             &lt;any XXX&gt;\r\n|      |          |         );\r\n|      |          |         Wanted 1 time:\r\n|      |          |         -&gt; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n|      |          |         But was 2 times:\r\n|      |          |         -&gt; at XXXX.XXX(XXX.java:129)\r\n|      |          |         -&gt; at XXXXX.XXX(XXX.java:129)\r\n|      |          |          \r\n|      |          |         \r\n|      |          Wanted invocations count: 1\r\n```\r\nDoes anybody have met this problem before?","title":"When using Mockito verify method `times` got null","body":"<p>When I trying to use Mockito verify to test extral call times of testMethod(indeed this method is just execute 2 times), but I got following message.</p>\n<pre><code>verify(XXXXXXX, times(2)).testMethod(any(XXXXXX.class))\n|      |          |         |        |        |\n|      |          |         null    null      class XXXXXX\n|      |          Wanted invocations count: 2\n|      Mock for XXXXXXX, hashCode: 292294397\nMock for XXXXXXX, hashCode: 292294397\n</code></pre>\n<p>If I change the times to 1, and the error message is:</p>\n<pre><code>verify(XXXXXXX, times(1)).testMethod(any(XXXXXX.class))\n|      |          |         |     |         |\n|      |          |         |     null      class XXX\n|      |          |         org.mockito.exceptions.verification.TooManyActualInvocations: \n|      |          |         XXX.XXXX(\n|      |          |             &lt;any XXX&gt;\n|      |          |         );\n|      |          |         Wanted 1 time:\n|      |          |         -&gt; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n|      |          |         But was 2 times:\n|      |          |         -&gt; at XXXX.XXX(XXX.java:129)\n|      |          |         -&gt; at XXXXX.XXX(XXX.java:129)\n|      |          |          \n|      |          |         \n|      |          Wanted invocations count: 1\n</code></pre>\n<p>Does anybody have met this problem before?</p>\n"},{"tags":["java","string","concatenation","string.format"],"comments":[{"owner":{"account_id":1612962,"reputation":2478,"user_id":1491414,"accept_rate":56,"display_name":"Ganesa Vijayakumar"},"score":0,"creation_date":1559214673,"post_id":925423,"comment_id":99354853,"body_markdown":"I think we can go with MessageFormat.format. Please see the answer https://stackoverflow.com/a/56377112/1491414 for more info.","body":"I think we can go with MessageFormat.format. Please see the answer <a href=\"https://stackoverflow.com/a/56377112/1491414\">stackoverflow.com/a/56377112/1491414</a> for more info."}],"answers":[{"tags":[],"owner":{"account_id":8817,"reputation":25201,"user_id":16035,"accept_rate":100,"display_name":"workmad3"},"down_vote_count":5,"up_vote_count":288,"is_accepted":true,"score":283,"last_activity_date":1413221237,"creation_date":1243594594,"answer_id":925444,"question_id":925423,"body_markdown":"I&#39;d suggest that it is better practice to use `String.format()`. The main reason is that `String.format()` can be more easily localised with text loaded from resource files whereas concatenation can&#39;t be localised without producing a new executable with different code for each language.\r\n\r\nIf you plan on your app being localisable you should also get into the habit of specifying argument positions for your format tokens as well:\r\n\r\n    &quot;Hello %1$s the time is %2$t&quot;\r\n\r\nThis can then be localised and have the name and time tokens swapped without requiring a recompile of the executable to account for the different ordering. With argument positions you can also re-use the same argument without passing it into the function twice:\r\n\r\n    String.format(&quot;Hello %1$s, your name is %1$s and the time is %2$t&quot;, name, time)\r\n\r\n","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>I'd suggest that it is better practice to use <code>String.format()</code>. The main reason is that <code>String.format()</code> can be more easily localised with text loaded from resource files whereas concatenation can't be localised without producing a new executable with different code for each language.</p>\n\n<p>If you plan on your app being localisable you should also get into the habit of specifying argument positions for your format tokens as well:</p>\n\n<pre><code>\"Hello %1$s the time is %2$t\"\n</code></pre>\n\n<p>This can then be localised and have the name and time tokens swapped without requiring a recompile of the executable to account for the different ordering. With argument positions you can also re-use the same argument without passing it into the function twice:</p>\n\n<pre><code>String.format(\"Hello %1$s, your name is %1$s and the time is %2$t\", name, time)\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8326,"reputation":258545,"user_id":14955,"accept_rate":55,"display_name":"Thilo"},"down_vote_count":2,"up_vote_count":26,"is_accepted":false,"score":24,"last_activity_date":1243594609,"creation_date":1243594609,"answer_id":925445,"question_id":925423,"body_markdown":"&gt; Which one is more readable depends on how your head works. \r\n\r\nYou got your answer right there. \r\n\r\nIt&#39;s a matter of personal taste.\r\n\r\nString concatenation is marginally faster, I suppose, but that should be negligible.","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<blockquote>\n  <p>Which one is more readable depends on how your head works. </p>\n</blockquote>\n\n<p>You got your answer right there. </p>\n\n<p>It's a matter of personal taste.</p>\n\n<p>String concatenation is marginally faster, I suppose, but that should be negligible.</p>\n"},{"tags":[],"owner":{"account_id":38309,"reputation":19501,"user_id":109880,"accept_rate":76,"display_name":"Fortega"},"down_vote_count":1,"up_vote_count":10,"is_accepted":false,"score":9,"last_activity_date":1651614336,"creation_date":1243594879,"answer_id":925457,"question_id":925423,"body_markdown":"`String.format()` is more than just concatenating strings. For example, you can display numbers in a specific locale using `String.format()`.\r\n\r\nHowever, if you don&#39;t care about localisation, there is no functional difference.\r\nMaybe the concatenation is faster than the other but, in most cases, it will be negligible.","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p><code>String.format()</code> is more than just concatenating strings. For example, you can display numbers in a specific locale using <code>String.format()</code>.</p>\n<p>However, if you don't care about localisation, there is no functional difference.\nMaybe the concatenation is faster than the other but, in most cases, it will be negligible.</p>\n"},{"tags":[],"owner":{"account_id":39617,"reputation":6179,"user_id":114340,"display_name":"AngerClown"},"down_vote_count":2,"up_vote_count":4,"is_accepted":false,"score":2,"last_activity_date":1243608943,"creation_date":1243608943,"answer_id":926420,"question_id":925423,"body_markdown":"I haven&#39;t done any specific benchmarks, but I would think that concatenation may be faster. String.format() creates a new Formatter which, in turn, creates a new StringBuilder (with a size of only 16 chars). That&#39;s a fair amount of overhead especially if you are formatting a longer string and StringBuilder keeps having to resize.\r\n\r\nHowever, concatenation is less useful and harder to read. As always, it&#39;s worth doing a benchmark on your code to see which is better. The differences may be negligible in server app after your resource bundles, locales, etc are loaded in memory and the code is JITted.\r\n\r\nMaybe as a best practice, it would be a good idea to create your own Formatter with a properly sized StringBuilder (Appendable) and Locale and use that if you have a lot of formatting to do.","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>I haven't done any specific benchmarks, but I would think that concatenation may be faster. String.format() creates a new Formatter which, in turn, creates a new StringBuilder (with a size of only 16 chars). That's a fair amount of overhead especially if you are formatting a longer string and StringBuilder keeps having to resize.</p>\n\n<p>However, concatenation is less useful and harder to read. As always, it's worth doing a benchmark on your code to see which is better. The differences may be negligible in server app after your resource bundles, locales, etc are loaded in memory and the code is JITted.</p>\n\n<p>Maybe as a best practice, it would be a good idea to create your own Formatter with a properly sized StringBuilder (Appendable) and Locale and use that if you have a lot of formatting to do.</p>\n"},{"tags":[],"owner":{"account_id":36667,"reputation":2637,"user_id":104653,"display_name":"Icaro"},"down_vote_count":1,"up_vote_count":242,"is_accepted":false,"score":241,"last_activity_date":1534980300,"creation_date":1263833886,"answer_id":2087703,"question_id":925423,"body_markdown":"About performance:\r\n\r\n    public static void main(String[] args) throws Exception {      \r\n      long start = System.currentTimeMillis();\r\n      for(int i = 0; i &lt; 1000000; i++){\r\n        String s = &quot;Hi &quot; + i + &quot;; Hi to you &quot; + i*2;\r\n      }\r\n      long end = System.currentTimeMillis();\r\n      System.out.println(&quot;Concatenation = &quot; + ((end - start)) + &quot; millisecond&quot;) ;\r\n    \r\n      start = System.currentTimeMillis();\r\n      for(int i = 0; i &lt; 1000000; i++){\r\n        String s = String.format(&quot;Hi %s; Hi to you %s&quot;,i, + i*2);\r\n      }\r\n      end = System.currentTimeMillis();\r\n      System.out.println(&quot;Format = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n    }\r\n\r\nThe timing results are as follows:\r\n\r\n - Concatenation = 265 millisecond\r\n - Format = 4141 millisecond\r\n\r\nTherefore, concatenation is much faster than String.format.\r\n","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>About performance:</p>\n\n<pre><code>public static void main(String[] args) throws Exception {      \n  long start = System.currentTimeMillis();\n  for(int i = 0; i &lt; 1000000; i++){\n    String s = \"Hi \" + i + \"; Hi to you \" + i*2;\n  }\n  long end = System.currentTimeMillis();\n  System.out.println(\"Concatenation = \" + ((end - start)) + \" millisecond\") ;\n\n  start = System.currentTimeMillis();\n  for(int i = 0; i &lt; 1000000; i++){\n    String s = String.format(\"Hi %s; Hi to you %s\",i, + i*2);\n  }\n  end = System.currentTimeMillis();\n  System.out.println(\"Format = \" + ((end - start)) + \" millisecond\");\n}\n</code></pre>\n\n<p>The timing results are as follows:</p>\n\n<ul>\n<li>Concatenation = 265 millisecond</li>\n<li>Format = 4141 millisecond</li>\n</ul>\n\n<p>Therefore, concatenation is much faster than String.format.</p>\n"},{"tags":[],"owner":{"account_id":940135,"reputation":23,"user_id":968348,"display_name":"DotNetUser"},"down_vote_count":4,"up_vote_count":3,"is_accepted":false,"score":-1,"last_activity_date":1411965455,"creation_date":1317185086,"answer_id":7578413,"question_id":925423,"body_markdown":"You cannot compare String Concatenation and String.Format by the program above.\r\n\r\nYou may try this also be interchanging the position of using your String.Format and Concatenation in your code block like the below\r\n\r\n    public static void main(String[] args) throws Exception {      \r\n      long start = System.currentTimeMillis();\r\n\r\n      for( int i=0;i&lt;1000000; i++){\r\n        String s = String.format( &quot;Hi %s; Hi to you %s&quot;,i, + i*2);\r\n      }\r\n\r\n      long end = System.currentTimeMillis();\r\n      System.out.println(&quot;Format = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n      start = System.currentTimeMillis();\r\n    \r\n      for( int i=0;i&lt;1000000; i++){\r\n        String s = &quot;Hi &quot; + i + &quot;; Hi to you &quot; + i*2;\r\n      }\r\n\r\n      end = System.currentTimeMillis();\r\n      System.out.println(&quot;Concatenation = &quot; + ((end - start)) + &quot; millisecond&quot;) ;\r\n    }\r\n\r\nYou will be surprised to see that Format works faster here. This is since the intial objects created might not be released and there can be an issue with memory allocation and thereby the performance.\r\n","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>You cannot compare String Concatenation and String.Format by the program above.</p>\n\n<p>You may try this also be interchanging the position of using your String.Format and Concatenation in your code block like the below</p>\n\n<pre><code>public static void main(String[] args) throws Exception {      \n  long start = System.currentTimeMillis();\n\n  for( int i=0;i&lt;1000000; i++){\n    String s = String.format( \"Hi %s; Hi to you %s\",i, + i*2);\n  }\n\n  long end = System.currentTimeMillis();\n  System.out.println(\"Format = \" + ((end - start)) + \" millisecond\");\n  start = System.currentTimeMillis();\n\n  for( int i=0;i&lt;1000000; i++){\n    String s = \"Hi \" + i + \"; Hi to you \" + i*2;\n  }\n\n  end = System.currentTimeMillis();\n  System.out.println(\"Concatenation = \" + ((end - start)) + \" millisecond\") ;\n}\n</code></pre>\n\n<p>You will be surprised to see that Format works faster here. This is since the intial objects created might not be released and there can be an issue with memory allocation and thereby the performance.</p>\n"},{"tags":[],"owner":{"account_id":953817,"reputation":493,"user_id":979478,"display_name":"Pawel Zieminski"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1352535595,"creation_date":1317772716,"answer_id":7655335,"question_id":925423,"body_markdown":"There could be a perceptible difference. \r\n\r\n`String.format` is quite complex and uses a regular expression underneath, so don&#39;t make it a habit to use it everywhere, but only where you need it. \r\n\r\n`StringBuilder` would be an order of magnitude faster (as someone here already pointed out).","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>There could be a perceptible difference. </p>\n\n<p><code>String.format</code> is quite complex and uses a regular expression underneath, so don't make it a habit to use it everywhere, but only where you need it. </p>\n\n<p><code>StringBuilder</code> would be an order of magnitude faster (as someone here already pointed out).</p>\n"},{"tags":[],"owner":{"account_id":1165974,"reputation":4349,"user_id":1144275,"display_name":"TechTrip"},"down_vote_count":2,"up_vote_count":49,"is_accepted":false,"score":47,"last_activity_date":1326322022,"creation_date":1326322022,"answer_id":8827854,"question_id":925423,"body_markdown":"Since there is discussion about performance I figured I&#39;d add in a comparison that included StringBuilder. It is in fact faster than the concat and, naturally the String.format option. \r\n\r\nTo make this a sort of apples to apples comparison I instantiate a new StringBuilder in the loop rather than outside (this is actually faster than doing just one instantiation most likely due to the overhead of re-allocating space for the looping append at the end of one builder).\r\n\r\n\t\tString formatString = &quot;Hi %s; Hi to you %s&quot;;\r\n\r\n\t\tlong start = System.currentTimeMillis();\r\n\t\tfor (int i = 0; i &lt; 1000000; i++) {\r\n\t\t\tString s = String.format(formatString, i, +i * 2);\r\n\t\t}\r\n\r\n\t\tlong end = System.currentTimeMillis();\r\n\t\tlog.info(&quot;Format = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n\r\n\t\tstart = System.currentTimeMillis();\r\n\r\n\t\tfor (int i = 0; i &lt; 1000000; i++) {\r\n\t\t\tString s = &quot;Hi &quot; + i + &quot;; Hi to you &quot; + i * 2;\r\n\t\t}\r\n\r\n\t\tend = System.currentTimeMillis();\r\n\r\n\t\tlog.info(&quot;Concatenation = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n\r\n\t\tstart = System.currentTimeMillis();\r\n\r\n\t\tfor (int i = 0; i &lt; 1000000; i++) {\r\n\t\t\tStringBuilder bldString = new StringBuilder(&quot;Hi &quot;);\r\n\t\t\tbldString.append(i).append(&quot;; Hi to you &quot;).append(i * 2);\r\n\t\t}\r\n\r\n\t\tend = System.currentTimeMillis();\r\n\r\n\t\tlog.info(&quot;String Builder = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n\r\n - 2012-01-11 16:30:46,058 INFO [TestMain] - Format = 1416 millisecond\r\n - 2012-01-11 16:30:46,190 INFO [TestMain] - Concatenation = 134 millisecond\r\n - 2012-01-11 16:30:46,313 INFO [TestMain] - String Builder = 117 millisecond\r\n","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>Since there is discussion about performance I figured I'd add in a comparison that included StringBuilder. It is in fact faster than the concat and, naturally the String.format option. </p>\n\n<p>To make this a sort of apples to apples comparison I instantiate a new StringBuilder in the loop rather than outside (this is actually faster than doing just one instantiation most likely due to the overhead of re-allocating space for the looping append at the end of one builder).</p>\n\n<pre><code>    String formatString = \"Hi %s; Hi to you %s\";\n\n    long start = System.currentTimeMillis();\n    for (int i = 0; i &lt; 1000000; i++) {\n        String s = String.format(formatString, i, +i * 2);\n    }\n\n    long end = System.currentTimeMillis();\n    log.info(\"Format = \" + ((end - start)) + \" millisecond\");\n\n    start = System.currentTimeMillis();\n\n    for (int i = 0; i &lt; 1000000; i++) {\n        String s = \"Hi \" + i + \"; Hi to you \" + i * 2;\n    }\n\n    end = System.currentTimeMillis();\n\n    log.info(\"Concatenation = \" + ((end - start)) + \" millisecond\");\n\n    start = System.currentTimeMillis();\n\n    for (int i = 0; i &lt; 1000000; i++) {\n        StringBuilder bldString = new StringBuilder(\"Hi \");\n        bldString.append(i).append(\"; Hi to you \").append(i * 2);\n    }\n\n    end = System.currentTimeMillis();\n\n    log.info(\"String Builder = \" + ((end - start)) + \" millisecond\");\n</code></pre>\n\n<ul>\n<li>2012-01-11 16:30:46,058 INFO [TestMain] - Format = 1416 millisecond</li>\n<li>2012-01-11 16:30:46,190 INFO [TestMain] - Concatenation = 134 millisecond</li>\n<li>2012-01-11 16:30:46,313 INFO [TestMain] - String Builder = 117 millisecond</li>\n</ul>\n"},{"tags":[],"owner":{"account_id":435063,"reputation":4304,"user_id":821436,"accept_rate":79,"display_name":"Martin Schr&#246;der"},"down_vote_count":0,"up_vote_count":61,"is_accepted":false,"score":61,"last_activity_date":1583776964,"creation_date":1330008990,"answer_id":9415430,"question_id":925423,"body_markdown":"One problem with `.format` is that you lose static type safety. You can have too few arguments for your format, and you can have the wrong types for the format specifiers - both leading to an `IllegalFormatException` *at runtime*, so you might end up with logging code that breaks production.\r\n\r\nIn contrast, the arguments to `+` can be tested by the compiler.\r\n\r\nThe [security history][1] of [tag:printf] (on which the `format` function is modeled) is long and frightening.\r\n\r\n\r\n  [1]: https://en.wikipedia.org/wiki/Printf_format_string#Vulnerabilities","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>One problem with <code>.format</code> is that you lose static type safety. You can have too few arguments for your format, and you can have the wrong types for the format specifiers - both leading to an <code>IllegalFormatException</code> <em>at runtime</em>, so you might end up with logging code that breaks production.</p>\n\n<p>In contrast, the arguments to <code>+</code> can be tested by the compiler.</p>\n\n<p>The <a href=\"https://en.wikipedia.org/wiki/Printf_format_string#Vulnerabilities\" rel=\"noreferrer\">security history</a> of <a href=\"/questions/tagged/printf\" class=\"post-tag\" title=\"show questions tagged &#39;printf&#39;\" rel=\"tag\">printf</a> (on which the <code>format</code> function is modeled) is long and frightening.</p>\n"},{"tags":[],"owner":{"account_id":209914,"reputation":12741,"user_id":461237,"display_name":"Akos Cz"},"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1386106173,"creation_date":1386106173,"answer_id":20362065,"question_id":925423,"body_markdown":"Here&#39;s the same test as above with the modification of calling the ***toString()*** method on the *StringBuilder*.  The results below show that the StringBuilder approach is just a bit slower than String concatenation using the **+** operator.\r\n\r\n***file: StringTest.java***\r\n\r\n    class StringTest {\r\n    \r\n      public static void main(String[] args) {\r\n       \r\n        String formatString = &quot;Hi %s; Hi to you %s&quot;;\r\n    \r\n        long start = System.currentTimeMillis();\r\n        for (int i = 0; i &lt; 1000000; i++) {\r\n            String s = String.format(formatString, i, +i * 2);\r\n        }\r\n    \r\n        long end = System.currentTimeMillis();\r\n        System.out.println(&quot;Format = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n    \r\n        start = System.currentTimeMillis();\r\n    \r\n        for (int i = 0; i &lt; 1000000; i++) {\r\n            String s = &quot;Hi &quot; + i + &quot;; Hi to you &quot; + i * 2;\r\n        }\r\n    \r\n        end = System.currentTimeMillis();\r\n    \r\n        System.out.println(&quot;Concatenation = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n    \r\n        start = System.currentTimeMillis();\r\n    \r\n        for (int i = 0; i &lt; 1000000; i++) {\r\n            StringBuilder bldString = new StringBuilder(&quot;Hi &quot;);\r\n            bldString.append(i).append(&quot;Hi to you &quot;).append(i * 2).toString();\r\n        }\r\n    \r\n        end = System.currentTimeMillis();\r\n    \r\n        System.out.println(&quot;String Builder = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n    \r\n      }\r\n    }\r\n\r\n\r\n\r\n***Shell Commands : (compile and run StringTest 5 times)***\r\n\r\n    &gt; javac StringTest.java\r\n    &gt; sh -c &quot;for i in \\$(seq 1 5); do echo \\&quot;Run \\${i}\\&quot;; java StringTest; done&quot;\r\n\r\n***Results :***\r\n\r\n    Run 1\r\n    Format = 1290 millisecond\r\n    Concatenation = 115 millisecond\r\n    String Builder = 130 millisecond\r\n\r\n    Run 2\r\n    Format = 1265 millisecond\r\n    Concatenation = 114 millisecond\r\n    String Builder = 126 millisecond\r\n\r\n    Run 3\r\n    Format = 1303 millisecond\r\n    Concatenation = 114 millisecond\r\n    String Builder = 127 millisecond\r\n\r\n    Run 4\r\n    Format = 1297 millisecond\r\n    Concatenation = 114 millisecond\r\n    String Builder = 127 millisecond\r\n\r\n    Run 5\r\n    Format = 1270 millisecond\r\n    Concatenation = 114 millisecond\r\n    String Builder = 126 millisecond","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>Here's the same test as above with the modification of calling the <strong><em>toString()</em></strong> method on the <em>StringBuilder</em>.  The results below show that the StringBuilder approach is just a bit slower than String concatenation using the <strong>+</strong> operator.</p>\n\n<p><em><strong>file: StringTest.java</em></strong></p>\n\n<pre><code>class StringTest {\n\n  public static void main(String[] args) {\n\n    String formatString = \"Hi %s; Hi to you %s\";\n\n    long start = System.currentTimeMillis();\n    for (int i = 0; i &lt; 1000000; i++) {\n        String s = String.format(formatString, i, +i * 2);\n    }\n\n    long end = System.currentTimeMillis();\n    System.out.println(\"Format = \" + ((end - start)) + \" millisecond\");\n\n    start = System.currentTimeMillis();\n\n    for (int i = 0; i &lt; 1000000; i++) {\n        String s = \"Hi \" + i + \"; Hi to you \" + i * 2;\n    }\n\n    end = System.currentTimeMillis();\n\n    System.out.println(\"Concatenation = \" + ((end - start)) + \" millisecond\");\n\n    start = System.currentTimeMillis();\n\n    for (int i = 0; i &lt; 1000000; i++) {\n        StringBuilder bldString = new StringBuilder(\"Hi \");\n        bldString.append(i).append(\"Hi to you \").append(i * 2).toString();\n    }\n\n    end = System.currentTimeMillis();\n\n    System.out.println(\"String Builder = \" + ((end - start)) + \" millisecond\");\n\n  }\n}\n</code></pre>\n\n<p><em><strong>Shell Commands : (compile and run StringTest 5 times)</em></strong></p>\n\n<pre><code>&gt; javac StringTest.java\n&gt; sh -c \"for i in \\$(seq 1 5); do echo \\\"Run \\${i}\\\"; java StringTest; done\"\n</code></pre>\n\n<p><em><strong>Results :</em></strong></p>\n\n<pre><code>Run 1\nFormat = 1290 millisecond\nConcatenation = 115 millisecond\nString Builder = 130 millisecond\n\nRun 2\nFormat = 1265 millisecond\nConcatenation = 114 millisecond\nString Builder = 126 millisecond\n\nRun 3\nFormat = 1303 millisecond\nConcatenation = 114 millisecond\nString Builder = 127 millisecond\n\nRun 4\nFormat = 1297 millisecond\nConcatenation = 114 millisecond\nString Builder = 127 millisecond\n\nRun 5\nFormat = 1270 millisecond\nConcatenation = 114 millisecond\nString Builder = 126 millisecond\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3135278,"reputation":2495,"user_id":2651894,"accept_rate":17,"display_name":"Derek Ziemba"},"down_vote_count":1,"up_vote_count":21,"is_accepted":false,"score":20,"last_activity_date":1413961601,"creation_date":1413961601,"answer_id":26502023,"question_id":925423,"body_markdown":"Here&#39;s a test with multiple sample sizes in milliseconds.  \r\n\r\n    public class Time {\r\n\t\r\n\tpublic static String sysFile = &quot;/sys/class/camera/rear/rear_flash&quot;;\r\n\tpublic static String cmdString = &quot;echo %s &gt; &quot; + sysFile;\r\n\r\n\tpublic static void main(String[] args) {\r\n\r\n\t  int i = 1;\r\n\t  for(int run=1; run &lt;= 12; run++){\r\n\t\t  for(int test =1; test &lt;= 2 ; test++){\r\n\t\t\tSystem.out.println(\r\n\t\t\t\t\tString.format(&quot;\\nTEST: %s, RUN: %s, Iterations: %s&quot;,run,test,i));\r\n\t\t    test(run, i);\r\n\t\t  }\r\n\t\t  System.out.println(&quot;\\n____________________________&quot;);\r\n\t\t  i = i*3;\r\n\t  }\r\n\t}\r\n\t\t\r\n\tpublic static void test(int run, int iterations){\r\n\t\t  \r\n\t\t  long start = System.nanoTime();\r\n\t\t  for( int i=0;i&lt;iterations; i++){\r\n\t\t      String s = &quot;echo &quot; + i + &quot; &gt; &quot;+ sysFile;\r\n\t\t  }\r\n\t\t  long t = System.nanoTime() - start;\t\r\n\t\t  String r = String.format(&quot;  %-13s =%10d %s&quot;, &quot;Concatenation&quot;,t,&quot;nanosecond&quot;);\r\n\t\t  System.out.println(r) ;\r\n\r\n\t\t  \r\n\t\t start = System.nanoTime();\t\t  \r\n\t\t for( int i=0;i&lt;iterations; i++){\r\n\t\t     String s =  String.format(cmdString, i);\r\n\t\t }\r\n\t\t t = System.nanoTime() - start;\t\r\n\t\t r = String.format(&quot;  %-13s =%10d %s&quot;, &quot;Format&quot;,t,&quot;nanosecond&quot;);\r\n\t\t System.out.println(r);\r\n\t\t\t\t\t\t\t  \r\n\t\t  start = System.nanoTime();\t\t  \r\n\t\t  for( int i=0;i&lt;iterations; i++){\r\n\t\t\t  StringBuilder b = new StringBuilder(&quot;echo &quot;);\r\n\t\t\t  b.append(i).append(&quot; &gt; &quot;).append(sysFile);\r\n\t\t      String s = b.toString();\r\n\t\t  }\r\n\t\t t = System.nanoTime() - start;\t\r\n\t\t r = String.format(&quot;  %-13s =%10d %s&quot;, &quot;StringBuilder&quot;,t,&quot;nanosecond&quot;);\r\n\t\t System.out.println(r);\r\n\t}\r\n}\r\n\r\n\r\n\r\n    TEST: 1, RUN: 1, Iterations: 1\r\n      Concatenation =     14911 nanosecond\r\n      Format        =     45026 nanosecond\r\n      StringBuilder =      3509 nanosecond\r\n    \r\n    TEST: 1, RUN: 2, Iterations: 1\r\n      Concatenation =      3509 nanosecond\r\n      Format        =     38594 nanosecond\r\n      StringBuilder =      3509 nanosecond\r\n    \r\n    ____________________________\r\n    \r\n    TEST: 2, RUN: 1, Iterations: 3\r\n      Concatenation =      8479 nanosecond\r\n      Format        =     94438 nanosecond\r\n      StringBuilder =      5263 nanosecond\r\n    \r\n    TEST: 2, RUN: 2, Iterations: 3\r\n      Concatenation =      4970 nanosecond\r\n      Format        =     92976 nanosecond\r\n      StringBuilder =      5848 nanosecond\r\n    \r\n    ____________________________\r\n    \r\n    TEST: 3, RUN: 1, Iterations: 9\r\n      Concatenation =     11403 nanosecond\r\n      Format        =    287115 nanosecond\r\n      StringBuilder =     14326 nanosecond\r\n    \r\n    TEST: 3, RUN: 2, Iterations: 9\r\n      Concatenation =     12280 nanosecond\r\n      Format        =    209051 nanosecond\r\n      StringBuilder =     11818 nanosecond\r\n    \r\n    ____________________________\r\n    \r\n    TEST: 5, RUN: 1, Iterations: 81\r\n      Concatenation =     54383 nanosecond\r\n      Format        =   1503113 nanosecond\r\n      StringBuilder =     40056 nanosecond\r\n    \r\n    TEST: 5, RUN: 2, Iterations: 81\r\n      Concatenation =     44149 nanosecond\r\n      Format        =   1264241 nanosecond\r\n      StringBuilder =     34208 nanosecond\r\n    \r\n    ____________________________\r\n    \r\n    TEST: 6, RUN: 1, Iterations: 243\r\n      Concatenation =     76018 nanosecond\r\n      Format        =   3210891 nanosecond\r\n      StringBuilder =     76603 nanosecond\r\n    \r\n    TEST: 6, RUN: 2, Iterations: 243\r\n      Concatenation =     91222 nanosecond\r\n      Format        =   2716773 nanosecond\r\n      StringBuilder =     73972 nanosecond\r\n    \r\n    ____________________________\r\n    \r\n    TEST: 8, RUN: 1, Iterations: 2187\r\n      Concatenation =    527450 nanosecond\r\n      Format        =  10291108 nanosecond\r\n      StringBuilder =    885027 nanosecond\r\n    \r\n    TEST: 8, RUN: 2, Iterations: 2187\r\n      Concatenation =    526865 nanosecond\r\n      Format        =   6294307 nanosecond\r\n      StringBuilder =    591773 nanosecond\r\n    \r\n    ____________________________\r\n    \r\n    TEST: 10, RUN: 1, Iterations: 19683\r\n      Concatenation =   4592961 nanosecond\r\n      Format        =  60114307 nanosecond\r\n      StringBuilder =   2129387 nanosecond\r\n    \r\n    TEST: 10, RUN: 2, Iterations: 19683\r\n      Concatenation =   1850166 nanosecond\r\n      Format        =  35940524 nanosecond\r\n      StringBuilder =   1885544 nanosecond\r\n      \r\n      ____________________________\r\n    \r\n    TEST: 12, RUN: 1, Iterations: 177147\r\n      Concatenation =  26847286 nanosecond\r\n      Format        = 126332877 nanosecond\r\n      StringBuilder =  17578914 nanosecond\r\n    \r\n    TEST: 12, RUN: 2, Iterations: 177147\r\n      Concatenation =  24405056 nanosecond\r\n      Format        = 129707207 nanosecond\r\n      StringBuilder =  12253840 nanosecond","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>Here's a test with multiple sample sizes in milliseconds.  </p>\n\n<pre><code>public class Time {\n\npublic static String sysFile = \"/sys/class/camera/rear/rear_flash\";\npublic static String cmdString = \"echo %s &gt; \" + sysFile;\n\npublic static void main(String[] args) {\n\n  int i = 1;\n  for(int run=1; run &lt;= 12; run++){\n      for(int test =1; test &lt;= 2 ; test++){\n        System.out.println(\n                String.format(\"\\nTEST: %s, RUN: %s, Iterations: %s\",run,test,i));\n        test(run, i);\n      }\n      System.out.println(\"\\n____________________________\");\n      i = i*3;\n  }\n}\n\npublic static void test(int run, int iterations){\n\n      long start = System.nanoTime();\n      for( int i=0;i&lt;iterations; i++){\n          String s = \"echo \" + i + \" &gt; \"+ sysFile;\n      }\n      long t = System.nanoTime() - start;   \n      String r = String.format(\"  %-13s =%10d %s\", \"Concatenation\",t,\"nanosecond\");\n      System.out.println(r) ;\n\n\n     start = System.nanoTime();       \n     for( int i=0;i&lt;iterations; i++){\n         String s =  String.format(cmdString, i);\n     }\n     t = System.nanoTime() - start; \n     r = String.format(\"  %-13s =%10d %s\", \"Format\",t,\"nanosecond\");\n     System.out.println(r);\n\n      start = System.nanoTime();          \n      for( int i=0;i&lt;iterations; i++){\n          StringBuilder b = new StringBuilder(\"echo \");\n          b.append(i).append(\" &gt; \").append(sysFile);\n          String s = b.toString();\n      }\n     t = System.nanoTime() - start; \n     r = String.format(\"  %-13s =%10d %s\", \"StringBuilder\",t,\"nanosecond\");\n     System.out.println(r);\n}\n</code></pre>\n\n<p>}</p>\n\n<pre><code>TEST: 1, RUN: 1, Iterations: 1\n  Concatenation =     14911 nanosecond\n  Format        =     45026 nanosecond\n  StringBuilder =      3509 nanosecond\n\nTEST: 1, RUN: 2, Iterations: 1\n  Concatenation =      3509 nanosecond\n  Format        =     38594 nanosecond\n  StringBuilder =      3509 nanosecond\n\n____________________________\n\nTEST: 2, RUN: 1, Iterations: 3\n  Concatenation =      8479 nanosecond\n  Format        =     94438 nanosecond\n  StringBuilder =      5263 nanosecond\n\nTEST: 2, RUN: 2, Iterations: 3\n  Concatenation =      4970 nanosecond\n  Format        =     92976 nanosecond\n  StringBuilder =      5848 nanosecond\n\n____________________________\n\nTEST: 3, RUN: 1, Iterations: 9\n  Concatenation =     11403 nanosecond\n  Format        =    287115 nanosecond\n  StringBuilder =     14326 nanosecond\n\nTEST: 3, RUN: 2, Iterations: 9\n  Concatenation =     12280 nanosecond\n  Format        =    209051 nanosecond\n  StringBuilder =     11818 nanosecond\n\n____________________________\n\nTEST: 5, RUN: 1, Iterations: 81\n  Concatenation =     54383 nanosecond\n  Format        =   1503113 nanosecond\n  StringBuilder =     40056 nanosecond\n\nTEST: 5, RUN: 2, Iterations: 81\n  Concatenation =     44149 nanosecond\n  Format        =   1264241 nanosecond\n  StringBuilder =     34208 nanosecond\n\n____________________________\n\nTEST: 6, RUN: 1, Iterations: 243\n  Concatenation =     76018 nanosecond\n  Format        =   3210891 nanosecond\n  StringBuilder =     76603 nanosecond\n\nTEST: 6, RUN: 2, Iterations: 243\n  Concatenation =     91222 nanosecond\n  Format        =   2716773 nanosecond\n  StringBuilder =     73972 nanosecond\n\n____________________________\n\nTEST: 8, RUN: 1, Iterations: 2187\n  Concatenation =    527450 nanosecond\n  Format        =  10291108 nanosecond\n  StringBuilder =    885027 nanosecond\n\nTEST: 8, RUN: 2, Iterations: 2187\n  Concatenation =    526865 nanosecond\n  Format        =   6294307 nanosecond\n  StringBuilder =    591773 nanosecond\n\n____________________________\n\nTEST: 10, RUN: 1, Iterations: 19683\n  Concatenation =   4592961 nanosecond\n  Format        =  60114307 nanosecond\n  StringBuilder =   2129387 nanosecond\n\nTEST: 10, RUN: 2, Iterations: 19683\n  Concatenation =   1850166 nanosecond\n  Format        =  35940524 nanosecond\n  StringBuilder =   1885544 nanosecond\n\n  ____________________________\n\nTEST: 12, RUN: 1, Iterations: 177147\n  Concatenation =  26847286 nanosecond\n  Format        = 126332877 nanosecond\n  StringBuilder =  17578914 nanosecond\n\nTEST: 12, RUN: 2, Iterations: 177147\n  Concatenation =  24405056 nanosecond\n  Format        = 129707207 nanosecond\n  StringBuilder =  12253840 nanosecond\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2443149,"reputation":750,"user_id":3623290,"accept_rate":100,"display_name":"Stephane Bersier"},"down_vote_count":3,"up_vote_count":9,"is_accepted":false,"score":6,"last_activity_date":1451742072,"creation_date":1451742072,"answer_id":34566522,"question_id":925423,"body_markdown":"Generally, string concatenation should be prefered over `String.format`. The latter has two main disadvantages:\r\n\r\n 1. It does not encode the string to be built in a local manner.\r\n 2. The building process is encoded in a string.\r\n\r\nBy point 1, I mean that it is not possible to understand what a `String.format()` call is doing in a single sequential pass. One is forced to go back and forth between the format string and the arguments, while counting the position of the arguments. For short concatenations, this is not much of an issue. In these cases however, string concatenation is less verbose.\r\n\r\nBy point 2, I mean that the important part of the building process is encoded in the *format string* (using a DSL). Using strings to represent code has many disadvantages. It is not inherently type-safe, and complicates syntax-highlighting, code analysis, optimization, etc.\r\n\r\nOf course, when using tools or frameworks external to the Java language, new factors can come into play.","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>Generally, string concatenation should be prefered over <code>String.format</code>. The latter has two main disadvantages:</p>\n\n<ol>\n<li>It does not encode the string to be built in a local manner.</li>\n<li>The building process is encoded in a string.</li>\n</ol>\n\n<p>By point 1, I mean that it is not possible to understand what a <code>String.format()</code> call is doing in a single sequential pass. One is forced to go back and forth between the format string and the arguments, while counting the position of the arguments. For short concatenations, this is not much of an issue. In these cases however, string concatenation is less verbose.</p>\n\n<p>By point 2, I mean that the important part of the building process is encoded in the <em>format string</em> (using a DSL). Using strings to represent code has many disadvantages. It is not inherently type-safe, and complicates syntax-highlighting, code analysis, optimization, etc.</p>\n\n<p>Of course, when using tools or frameworks external to the Java language, new factors can come into play.</p>\n"},{"tags":[],"owner":{"account_id":337034,"reputation":56,"user_id":665056,"display_name":"CalisNight"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1557503773,"creation_date":1557503773,"answer_id":56081086,"question_id":925423,"body_markdown":"It takes a little time to get used to String.Format, but it&#39;s worth it in most cases. In the world of NRA (never repeat anything) it&#39;s extremely useful to keep your tokenized messages (logging or user) in a Constant library (I prefer what amounts to a static class) and call them as necessary with String.Format regardless of whether you are localizing or not. Trying to use such a library with a concatenation method is harder to read, troubleshoot, proofread, and manage with any any approach that requires concatenation. Replacement is an option, but I doubt it&#39;s performant. After years of use, my biggest problem with String.Format is the length of the call is inconveniently long when I&#39;m passing it into another function (like Msg), but that&#39;s easy to get around with a custom function to serve as an alias.","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>It takes a little time to get used to String.Format, but it's worth it in most cases. In the world of NRA (never repeat anything) it's extremely useful to keep your tokenized messages (logging or user) in a Constant library (I prefer what amounts to a static class) and call them as necessary with String.Format regardless of whether you are localizing or not. Trying to use such a library with a concatenation method is harder to read, troubleshoot, proofread, and manage with any any approach that requires concatenation. Replacement is an option, but I doubt it's performant. After years of use, my biggest problem with String.Format is the length of the call is inconveniently long when I'm passing it into another function (like Msg), but that's easy to get around with a custom function to serve as an alias.</p>\n"},{"tags":[],"owner":{"account_id":1612962,"reputation":2478,"user_id":1491414,"accept_rate":56,"display_name":"Ganesa Vijayakumar"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1572442547,"creation_date":1559214564,"answer_id":56377112,"question_id":925423,"body_markdown":"I think we can go with `MessageFormat.format` as it should be good at both readability and also performance aspects.\r\n\r\nI used the same program which one used by *Icaro* in his above answer and I enhanced it with appending code for using `MessageFormat` to explain the performance numbers.\r\n\r\n      public static void main(String[] args) {\r\n        long start = System.currentTimeMillis();\r\n        for (int i = 0; i &lt; 1000000; i++) {\r\n          String s = &quot;Hi &quot; + i + &quot;; Hi to you &quot; + i * 2;\r\n        }\r\n        long end = System.currentTimeMillis();\r\n        System.out.println(&quot;Concatenation = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n    \r\n        start = System.currentTimeMillis();\r\n        for (int i = 0; i &lt; 1000000; i++) {\r\n          String s = String.format(&quot;Hi %s; Hi to you %s&quot;, i, +i * 2);\r\n        }\r\n        end = System.currentTimeMillis();\r\n        System.out.println(&quot;Format = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n    \r\n        start = System.currentTimeMillis();\r\n        for (int i = 0; i &lt; 1000000; i++) {\r\n          String s = MessageFormat.format(&quot;Hi %s; Hi to you %s&quot;, i, +i * 2);\r\n        }\r\n        end = System.currentTimeMillis();\r\n        System.out.println(&quot;MessageFormat = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n      }\r\n\r\n&gt; Concatenation = 69 millisecond\r\n&gt; \r\n&gt; Format = 1435 millisecond\r\n&gt; \r\n&gt; MessageFormat = 200 millisecond\r\n\r\n\r\n**UPDATES:** \r\n\r\nAs per SonarLint Report, Printf-style format strings should be used correctly (squid:S3457)\r\n\r\nBecause `printf-style` format strings are interpreted at runtime, rather than validated by the compiler, they can contain errors that result in the wrong strings being created. This rule statically validates the correlation of `printf-style` format strings to their arguments when calling the format(...) methods of `java.util.Formatter`, `java.lang.String`, `java.io.PrintStream`, `MessageFormat`, and `java.io.PrintWriter` classes and the `printf(...)` methods of `java.io.PrintStream` or `java.io.PrintWriter` classes. \r\n\r\nI replace the printf-style with the curly-brackets and I got something interesting results as below.\r\n\r\n&gt; Concatenation = 69 millisecond&lt;br&gt; Format = 1107 millisecond&lt;br&gt;\r\n&gt; **Format:curly-brackets = 416 millisecond**&lt;br&gt; MessageFormat = 215\r\n&gt; millisecond&lt;br&gt; MessageFormat:curly-brackets = 2517 millisecond&lt;br&gt;\r\n\r\n**My Conclusion:**&lt;br&gt;\r\nAs I highlighted above, using String.format with curly-brackets should be a good choice to get benefits of good readability and also performance.\r\n","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>I think we can go with <code>MessageFormat.format</code> as it should be good at both readability and also performance aspects.</p>\n\n<p>I used the same program which one used by <em>Icaro</em> in his above answer and I enhanced it with appending code for using <code>MessageFormat</code> to explain the performance numbers.</p>\n\n<pre><code>  public static void main(String[] args) {\n    long start = System.currentTimeMillis();\n    for (int i = 0; i &lt; 1000000; i++) {\n      String s = \"Hi \" + i + \"; Hi to you \" + i * 2;\n    }\n    long end = System.currentTimeMillis();\n    System.out.println(\"Concatenation = \" + ((end - start)) + \" millisecond\");\n\n    start = System.currentTimeMillis();\n    for (int i = 0; i &lt; 1000000; i++) {\n      String s = String.format(\"Hi %s; Hi to you %s\", i, +i * 2);\n    }\n    end = System.currentTimeMillis();\n    System.out.println(\"Format = \" + ((end - start)) + \" millisecond\");\n\n    start = System.currentTimeMillis();\n    for (int i = 0; i &lt; 1000000; i++) {\n      String s = MessageFormat.format(\"Hi %s; Hi to you %s\", i, +i * 2);\n    }\n    end = System.currentTimeMillis();\n    System.out.println(\"MessageFormat = \" + ((end - start)) + \" millisecond\");\n  }\n</code></pre>\n\n<blockquote>\n  <p>Concatenation = 69 millisecond</p>\n  \n  <p>Format = 1435 millisecond</p>\n  \n  <p>MessageFormat = 200 millisecond</p>\n</blockquote>\n\n<p><strong>UPDATES:</strong> </p>\n\n<p>As per SonarLint Report, Printf-style format strings should be used correctly (squid:S3457)</p>\n\n<p>Because <code>printf-style</code> format strings are interpreted at runtime, rather than validated by the compiler, they can contain errors that result in the wrong strings being created. This rule statically validates the correlation of <code>printf-style</code> format strings to their arguments when calling the format(...) methods of <code>java.util.Formatter</code>, <code>java.lang.String</code>, <code>java.io.PrintStream</code>, <code>MessageFormat</code>, and <code>java.io.PrintWriter</code> classes and the <code>printf(...)</code> methods of <code>java.io.PrintStream</code> or <code>java.io.PrintWriter</code> classes. </p>\n\n<p>I replace the printf-style with the curly-brackets and I got something interesting results as below.</p>\n\n<blockquote>\n  <p>Concatenation = 69 millisecond<br> Format = 1107 millisecond<br>\n  <strong>Format:curly-brackets = 416 millisecond</strong><br> MessageFormat = 215\n  millisecond<br> MessageFormat:curly-brackets = 2517 millisecond<br></p>\n</blockquote>\n\n<p><strong>My Conclusion:</strong><br>\nAs I highlighted above, using String.format with curly-brackets should be a good choice to get benefits of good readability and also performance.</p>\n"},{"tags":[],"owner":{"account_id":3663387,"reputation":3549,"user_id":3058581,"display_name":"Adam111p"},"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1649417575,"creation_date":1649417575,"answer_id":71796284,"question_id":925423,"body_markdown":"**Wrong test repeated many times**\r\nYou should use {} no %s .\r\n\r\n    public static void main(String[] args) throws Exception {\r\n    long start = System.currentTimeMillis();\r\n    for (int i = 0; i &lt; 1000000; i++) {\r\n      String s = &quot;Hi &quot; + i + &quot;; Hi to you &quot; + i * 2;\r\n    }\r\n    long end = System.currentTimeMillis();\r\n    System.out.println(&quot;Concatenation = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n\r\n    start = System.currentTimeMillis();\r\n    for (int i = 0; i &lt; 1000000; i++) {\r\n      String s = String.format(&quot;Hi %s; Hi to you %s&quot;, i, +i * 2);\r\n    }\r\n    end = System.currentTimeMillis();\r\n    System.out.println(&quot;Wrong use of the message format  = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n\r\n    start = System.currentTimeMillis();\r\n    for (int i = 0; i &lt; 1000000; i++) {\r\n      String s = String.format(&quot;Hi {0}; Hi to you {1}&quot;, i, +i * 2);\r\n    }\r\n    end = System.currentTimeMillis();\r\n    System.out.println(&quot;Good use of the message format = &quot; + ((end - start)) + &quot; millisecond&quot;);\r\n  }\r\n\r\n    Concatenation = 88 millisecond\r\n    Wrong use of the message format  = 1075 millisecond \r\n    Good use of the message format = 376 millisecond","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p><strong>Wrong test repeated many times</strong>\nYou should use {} no %s .</p>\n<pre><code>public static void main(String[] args) throws Exception {\nlong start = System.currentTimeMillis();\nfor (int i = 0; i &lt; 1000000; i++) {\n  String s = &quot;Hi &quot; + i + &quot;; Hi to you &quot; + i * 2;\n}\nlong end = System.currentTimeMillis();\nSystem.out.println(&quot;Concatenation = &quot; + ((end - start)) + &quot; millisecond&quot;);\n\nstart = System.currentTimeMillis();\nfor (int i = 0; i &lt; 1000000; i++) {\n  String s = String.format(&quot;Hi %s; Hi to you %s&quot;, i, +i * 2);\n}\nend = System.currentTimeMillis();\nSystem.out.println(&quot;Wrong use of the message format  = &quot; + ((end - start)) + &quot; millisecond&quot;);\n\nstart = System.currentTimeMillis();\nfor (int i = 0; i &lt; 1000000; i++) {\n  String s = String.format(&quot;Hi {0}; Hi to you {1}&quot;, i, +i * 2);\n}\nend = System.currentTimeMillis();\nSystem.out.println(&quot;Good use of the message format = &quot; + ((end - start)) + &quot; millisecond&quot;);\n</code></pre>\n<p>}</p>\n<pre><code>Concatenation = 88 millisecond\nWrong use of the message format  = 1075 millisecond \nGood use of the message format = 376 millisecond\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8947578,"reputation":1,"user_id":6674434,"display_name":"Cesar Estrada"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689952210,"creation_date":1689952210,"answer_id":76739176,"question_id":925423,"body_markdown":"Format = 1508 millisecond\r\nConcatenation = 31 millisecond\r\n\r\nProcess finished with exit code 0\r\n\r\nConcat is much better than format.","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>Format = 1508 millisecond\nConcatenation = 31 millisecond</p>\n<p>Process finished with exit code 0</p>\n<p>Concat is much better than format.</p>\n"}],"owner":{"account_id":10732,"reputation":54820,"user_id":20400,"accept_rate":72,"display_name":"Omar Kooheji"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":260758,"favorite_count":0,"down_vote_count":0,"up_vote_count":346,"accepted_answer_id":925444,"answer_count":16,"score":346,"last_activity_date":1689952210,"creation_date":1243594281,"question_id":925423,"body_markdown":"Is there a perceptible difference between using `String.format` and String concatenation in Java?\r\n\r\nI tend to use `String.format` but occasionally will slip and use a concatenation. I was wondering if one was better than the other.\r\n\r\nThe way I see it, `String.format` gives you more power in &quot;formatting&quot; the string; and concatenation means you don&#39;t have to worry about accidentally putting in an extra %s or missing one out.\r\n\r\n`String.format` is also shorter.\r\n\r\nWhich one is more readable depends on how your head works.","title":"Is it better practice to use String.format over string Concatenation in Java?","body":"<p>Is there a perceptible difference between using <code>String.format</code> and String concatenation in Java?</p>\n\n<p>I tend to use <code>String.format</code> but occasionally will slip and use a concatenation. I was wondering if one was better than the other.</p>\n\n<p>The way I see it, <code>String.format</code> gives you more power in \"formatting\" the string; and concatenation means you don't have to worry about accidentally putting in an extra %s or missing one out.</p>\n\n<p><code>String.format</code> is also shorter.</p>\n\n<p>Which one is more readable depends on how your head works.</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":39846,"reputation":991133,"user_id":115145,"accept_rate":84,"display_name":"CommonsWare"},"score":0,"creation_date":1689940530,"post_id":76737596,"comment_id":135287665,"body_markdown":"&quot;but fails for android 12/13&quot; -- what *exactly* does &quot;fails&quot; mean? For example, are you crashing? If so, [use Logcat to examine the stack trace associated with the crash](https://commonsware.com/Jetpack/pages/chap-debug-001.html).","body":"&quot;but fails for android 12/13&quot; -- what <i>exactly</i> does &quot;fails&quot; mean? For example, are you crashing? If so, <a href=\"https://commonsware.com/Jetpack/pages/chap-debug-001.html\" rel=\"nofollow noreferrer\">use Logcat to examine the stack trace associated with the crash</a>."},{"owner":{"account_id":16291299,"reputation":89,"user_id":11764718,"display_name":"Rameswar Tarai"},"score":0,"creation_date":1689941836,"post_id":76737596,"comment_id":135287931,"body_markdown":"not able to get the video that I just recorded using the intent. The URI that i get using &quot;data.getData();&quot; is of a empty file. (len = inputStream.read(buffer)) != -1 is false.","body":"not able to get the video that I just recorded using the intent. The URI that i get using &quot;data.getData();&quot; is of a empty file. (len = inputStream.read(buffer)) != -1 is false."},{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1689944346,"post_id":76737596,"comment_id":135288489,"body_markdown":"Tell the value of your file uri. You use a wrong uri we think. Post the code that generates the uri too.","body":"Tell the value of your file uri. You use a wrong uri we think. Post the code that generates the uri too."},{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1689944661,"post_id":76737596,"comment_id":135288544,"body_markdown":"`To do so, I have created a video file` You should not already create an empty file. You only need a File instance for your file. The File instance has the same path of the -now not- created file.","body":"<code>To do so, I have created a video file</code> You should not already create an empty file. You only need a File instance for your file. The File instance has the same path of the -now not- created file."},{"owner":{"account_id":16291299,"reputation":89,"user_id":11764718,"display_name":"Rameswar Tarai"},"score":0,"creation_date":1689947081,"post_id":76737596,"comment_id":135289039,"body_markdown":"The same code works fine in Android 9 (Redmi 6). What could be wrong in Android 12 or Android 13?","body":"The same code works fine in Android 9 (Redmi 6). What could be wrong in Android 12 or Android 13?"}],"answers":[{"tags":[],"owner":{"account_id":39846,"reputation":991133,"user_id":115145,"accept_rate":84,"display_name":"CommonsWare"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1689951998,"creation_date":1689951998,"answer_id":76739155,"question_id":76737596,"body_markdown":"&gt; The same code works fine in Android 9 (Redmi 6)\r\n\r\nNo, it works fine on one device with one video recorder app, out of tens of thousands of devices and hundreds of video recorder apps. That app is being generous and is returning a `Uri` to you. [The app does not have to do that if you provide `EXTRA_OUTPUT` on the `Intent`](https://developer.android.com/reference/kotlin/android/provider/MediaStore?hl=en#action_video_capture), as you are doing.\r\n\r\nPlus, these video recorder apps have bugs.\r\n\r\nIf you fail to get a usable `Uri` back, try looking in the location that you provided in `EXTRA_OUTPUT` and see if the video is there. If it is, use it.","title":"not able to fetch video from the URI that I have sent in new Intent(MediaStore.ACTION_VIDEO_CAPTURE); in android 12/13","body":"<blockquote>\n<p>The same code works fine in Android 9 (Redmi 6)</p>\n</blockquote>\n<p>No, it works fine on one device with one video recorder app, out of tens of thousands of devices and hundreds of video recorder apps. That app is being generous and is returning a <code>Uri</code> to you. <a href=\"https://developer.android.com/reference/kotlin/android/provider/MediaStore?hl=en#action_video_capture\" rel=\"nofollow noreferrer\">The app does not have to do that if you provide <code>EXTRA_OUTPUT</code> on the <code>Intent</code></a>, as you are doing.</p>\n<p>Plus, these video recorder apps have bugs.</p>\n<p>If you fail to get a usable <code>Uri</code> back, try looking in the location that you provided in <code>EXTRA_OUTPUT</code> and see if the video is there. If it is, use it.</p>\n"}],"owner":{"account_id":16291299,"reputation":89,"user_id":11764718,"display_name":"Rameswar Tarai"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":48,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76739155,"answer_count":1,"score":1,"last_activity_date":1689951998,"creation_date":1689939200,"question_id":76737596,"body_markdown":"I want to capture video for 60 sec using Intent.\r\nTo do so, I have created a video file and sent it&#39;s URI in the Intent object.\r\nThe bellow code works fine in android 9 but fails for android 12/13.\r\n\r\nIntent object and its parameters:-\r\n\r\n```\r\nIntent intent = new Intent(MediaStore.ACTION_VIDEO_CAPTURE);\r\n                intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION);\r\n                intent.putExtra(MediaStore.EXTRA_DURATION_LIMIT, 60);\r\n                intent.putExtra(MediaStore.EXTRA_VIDEO_QUALITY, 0);\r\n                intent.putExtra(MediaStore.EXTRA_OUTPUT, getFileUri(&quot;&quot; + System.currentTimeMillis())); // set the video file\r\n\r\n\r\n                if (intent.resolveActivity(getPackageManager()) != null) {\r\n                    videoCaptureResultLauncher.launch(intent);\r\n                }\r\n```\r\n\r\n\r\n\r\nActivityResultLauncher code:-\r\n\r\n```\r\n        ActivityResultLauncher&lt;Intent&gt; videoCaptureResultLauncher = registerForActivityResult(\r\n                new ActivityResultContracts.StartActivityForResult(),\r\n                new ActivityResultCallback&lt;ActivityResult&gt;() {\r\n                    @Override\r\n                    public void onActivityResult(ActivityResult result) {\r\n                        try {\r\n                            if (result.getResultCode() == Activity.RESULT_OK) {\r\n                                // There are no request codes\r\n                                Intent data = result.getData();\r\n                                videoCaptureResponse(data);//intent result response is sent here\r\n                            }\r\n                        } catch (Exception e) {\r\n                            e.printStackTrace();\r\n                            FirebaseCrashlytics.getInstance().recordException(e);\r\n                        }\r\n                    }\r\n                });\r\n\r\n    private void videoCaptureResponse(Intent data) throws IOException {\r\n        Uri selectedVideoUri = data.getData();\r\n        InputStream inputStream = getContentResolver().openInputStream(selectedVideoUri);\r\n        \r\n        ByteArrayOutputStream byteBuffer = new ByteArrayOutputStream();\r\n        int bufferSize = 1024;\r\n        byte[] buffer = new byte[bufferSize];\r\n        int len = 0;\r\n        while ((len = inputStream.read(buffer)) != -1) {\r\n            byteBuffer.write(buffer, 0, len);\r\n        }\r\n        byte[] arr = byteBuffer.toByteArray();\r\n        int sizeOfInputStram = arr.length;\r\n\r\n        stringEncoded = android.util.Base64.encodeToString(arr, android.util.Base64.DEFAULT);\r\n        \r\n        MediaMetadataRetriever mMMR = new MediaMetadataRetriever();\r\n        mMMR.setDataSource(WitnessCRPCActivity.this, selectedVideoUri);\r\n        Bitmap bmp = mMMR.getFrameAtTime();\r\n        filecamera.setImageBitmap(bmp);\r\n    }\r\n```\r\n\r\n\r\nI expect the to read the video URI having video data in it in android OS 12/13. I tried by giving read/write access to URI using flag `intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION);` but it did not work.","title":"not able to fetch video from the URI that I have sent in new Intent(MediaStore.ACTION_VIDEO_CAPTURE); in android 12/13","body":"<p>I want to capture video for 60 sec using Intent.\nTo do so, I have created a video file and sent it's URI in the Intent object.\nThe bellow code works fine in android 9 but fails for android 12/13.</p>\n<p>Intent object and its parameters:-</p>\n<pre><code>Intent intent = new Intent(MediaStore.ACTION_VIDEO_CAPTURE);\n                intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION);\n                intent.putExtra(MediaStore.EXTRA_DURATION_LIMIT, 60);\n                intent.putExtra(MediaStore.EXTRA_VIDEO_QUALITY, 0);\n                intent.putExtra(MediaStore.EXTRA_OUTPUT, getFileUri(&quot;&quot; + System.currentTimeMillis())); // set the video file\n\n\n                if (intent.resolveActivity(getPackageManager()) != null) {\n                    videoCaptureResultLauncher.launch(intent);\n                }\n</code></pre>\n<p>ActivityResultLauncher code:-</p>\n<pre><code>        ActivityResultLauncher&lt;Intent&gt; videoCaptureResultLauncher = registerForActivityResult(\n                new ActivityResultContracts.StartActivityForResult(),\n                new ActivityResultCallback&lt;ActivityResult&gt;() {\n                    @Override\n                    public void onActivityResult(ActivityResult result) {\n                        try {\n                            if (result.getResultCode() == Activity.RESULT_OK) {\n                                // There are no request codes\n                                Intent data = result.getData();\n                                videoCaptureResponse(data);//intent result response is sent here\n                            }\n                        } catch (Exception e) {\n                            e.printStackTrace();\n                            FirebaseCrashlytics.getInstance().recordException(e);\n                        }\n                    }\n                });\n\n    private void videoCaptureResponse(Intent data) throws IOException {\n        Uri selectedVideoUri = data.getData();\n        InputStream inputStream = getContentResolver().openInputStream(selectedVideoUri);\n        \n        ByteArrayOutputStream byteBuffer = new ByteArrayOutputStream();\n        int bufferSize = 1024;\n        byte[] buffer = new byte[bufferSize];\n        int len = 0;\n        while ((len = inputStream.read(buffer)) != -1) {\n            byteBuffer.write(buffer, 0, len);\n        }\n        byte[] arr = byteBuffer.toByteArray();\n        int sizeOfInputStram = arr.length;\n\n        stringEncoded = android.util.Base64.encodeToString(arr, android.util.Base64.DEFAULT);\n        \n        MediaMetadataRetriever mMMR = new MediaMetadataRetriever();\n        mMMR.setDataSource(WitnessCRPCActivity.this, selectedVideoUri);\n        Bitmap bmp = mMMR.getFrameAtTime();\n        filecamera.setImageBitmap(bmp);\n    }\n</code></pre>\n<p>I expect the to read the video URI having video data in it in android OS 12/13. I tried by giving read/write access to URI using flag <code>intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION);</code> but it did not work.</p>\n"},{"tags":["java","enums"],"comments":[{"owner":{"account_id":7247195,"reputation":742,"user_id":5528725,"accept_rate":60,"display_name":"Thomas W."},"score":0,"creation_date":1689943227,"post_id":76737957,"comment_id":135288238,"body_markdown":"Do I get your code right, you want the fromErrorPatternt to return the Enum value depending on the filter and not a &#39;dynamic&#39; enum?","body":"Do I get your code right, you want the fromErrorPatternt to return the Enum value depending on the filter and not a &#39;dynamic&#39; enum?"},{"owner":{"account_id":195854,"reputation":159194,"user_id":438992,"accept_rate":90,"display_name":"Dave Newton"},"score":0,"creation_date":1689943488,"post_id":76737957,"comment_id":135288291,"body_markdown":"You want an `if` statement? What is `ErrorConstants`?","body":"You want an <code>if</code> statement? What is <code>ErrorConstants</code>?"},{"owner":{"account_id":28334748,"reputation":11,"user_id":21668464,"display_name":"Mohammed Muntazim"},"score":0,"creation_date":1689943756,"post_id":76737957,"comment_id":135288360,"body_markdown":"@ThomasW.  yes you are correct.","body":"@ThomasW.  yes you are correct."},{"owner":{"account_id":28334748,"reputation":11,"user_id":21668464,"display_name":"Mohammed Muntazim"},"score":0,"creation_date":1689943815,"post_id":76737957,"comment_id":135288370,"body_markdown":"@Dave Newton Sorry its ErrorDemo the enum class name.","body":"@Dave Newton Sorry its ErrorDemo the enum class name."},{"owner":{"account_id":7247195,"reputation":742,"user_id":5528725,"accept_rate":60,"display_name":"Thomas W."},"score":0,"creation_date":1690180114,"post_id":76737957,"comment_id":135311718,"body_markdown":"The answer of MC Emperor with the lambda looks really good...thumbs up...as an alternative you could store the enums in a map. Key could be a combination of the pattern and source. Retrieving the enum is then easily possible with a get on the map. If you are interested, just let me know and I will provide a sample code for that","body":"The answer of MC Emperor with the lambda looks really good...thumbs up...as an alternative you could store the enums in a map. Key could be a combination of the pattern and source. Retrieving the enum is then easily possible with a get on the map. If you are interested, just let me know and I will provide a sample code for that"}],"answers":[{"tags":[],"owner":{"account_id":238684,"reputation":22543,"user_id":507738,"accept_rate":71,"display_name":"MC Emperor"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1689943567,"creation_date":1689943191,"answer_id":76738097,"question_id":76737957,"body_markdown":"Well, you could walk over all enum values, and then match them with the given values:\r\n\r\n```java\r\nreturn Arrays.stream(ErrorConstants.values())\r\n    .filter(ec -&gt; Objects.equals(errorPattern, ec.getErrorMessagePattern()) &amp;&amp; Objects.equals(errorSource, ec.getSystemErrorSource()))\r\n    .findFirst()\r\n    .orElseThrow();\r\n```\r\n\r\nRegarding `findFirst` — it could be that multiple enums match. `findFirst()` is just returning the first one. If it is desired to have just a single element matching the errorPattern-errorSource combination, then you have to manually ensure that.\r\n\r\nIf nothing matches, then it throws a `NoSuchElementException`.\r\n\r\n---\r\n\r\nA classic (enhanced) for loop would look like this:\r\n\r\n```java\r\nfor (var ec : ErrorConstants.values()) {\r\n    if (Objects.equals(errorPattern, ec.getErrorMessagePattern()) &amp;&amp; Objects.equals(errorSource, ec.getSystemErrorSource())) {\r\n        return ec;\r\n    }\r\n}\r\nthrow new NoSuchElementException();\r\n```\r\n\r\n---\r\n\r\n&lt;sup&gt;Note: Your question mentions both `ErrorDemo` and `ErrorConstants`. I assume this is a mistake and they refer to the same thing.&lt;/sup&gt;","title":"Dynamic enum return based on condition","body":"<p>Well, you could walk over all enum values, and then match them with the given values:</p>\n<pre class=\"lang-java prettyprint-override\"><code>return Arrays.stream(ErrorConstants.values())\n    .filter(ec -&gt; Objects.equals(errorPattern, ec.getErrorMessagePattern()) &amp;&amp; Objects.equals(errorSource, ec.getSystemErrorSource()))\n    .findFirst()\n    .orElseThrow();\n</code></pre>\n<p>Regarding <code>findFirst</code> — it could be that multiple enums match. <code>findFirst()</code> is just returning the first one. If it is desired to have just a single element matching the errorPattern-errorSource combination, then you have to manually ensure that.</p>\n<p>If nothing matches, then it throws a <code>NoSuchElementException</code>.</p>\n<hr />\n<p>A classic (enhanced) for loop would look like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>for (var ec : ErrorConstants.values()) {\n    if (Objects.equals(errorPattern, ec.getErrorMessagePattern()) &amp;&amp; Objects.equals(errorSource, ec.getSystemErrorSource())) {\n        return ec;\n    }\n}\nthrow new NoSuchElementException();\n</code></pre>\n<hr />\n<p><sup>Note: Your question mentions both <code>ErrorDemo</code> and <code>ErrorConstants</code>. I assume this is a mistake and they refer to the same thing.</sup></p>\n"}],"owner":{"account_id":28334748,"reputation":11,"user_id":21668464,"display_name":"Mohammed Muntazim"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":58,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76738097,"answer_count":1,"score":0,"last_activity_date":1689951845,"creation_date":1689942043,"question_id":76737957,"body_markdown":"```java\r\n@Getter\r\n@RequiredArgsConstructor(access = AccessLevel.PACKAGE)\r\npublic enum ErrorDemo {\r\n\r\n    PCAT_DEMO(&quot;PC01&quot;, &quot;this demo&quot;, &quot;BAD_AUTH&quot;, &quot;TMN&quot;),\r\n    PCAT_DEMO1(&quot;PC03&quot;, &quot;this demo1&quot;, &quot;NOT FOUND&quot;, &quot;TOP&quot;),\r\n    PCAT_DEMO(&quot;PC02&quot;, &quot;this demo&quot;, &quot;NOT AVAILABLE&quot;, &quot;TMN&quot;);\r\n\r\n    private final String errorCode;\r\n    private final String errorMessage;\r\n    private final String errorMessagePattern;\r\n    private final String systemErrorSource;\r\n\r\n    // This method will return specific enum which field is matching with the passed arguments\r\n    public static ErrorConstants fromErrorPatternt(String errorPattern, String errorSource) {\r\n        ...\r\n    }\r\n}\r\n```\r\n\r\ncalling from here\r\nErrorConstants err = ErrorConstants.fromErrorPatternt(errorMsg, &quot;TMN&quot;);\r\n\r\nwhere the errorMsg to be matched errorMessagePattern  and &quot;TMN&quot; to be matched with systemErrorSource, then it will return the specific enum","title":"Dynamic enum return based on condition","body":"<pre class=\"lang-java prettyprint-override\"><code>@Getter\n@RequiredArgsConstructor(access = AccessLevel.PACKAGE)\npublic enum ErrorDemo {\n\n    PCAT_DEMO(&quot;PC01&quot;, &quot;this demo&quot;, &quot;BAD_AUTH&quot;, &quot;TMN&quot;),\n    PCAT_DEMO1(&quot;PC03&quot;, &quot;this demo1&quot;, &quot;NOT FOUND&quot;, &quot;TOP&quot;),\n    PCAT_DEMO(&quot;PC02&quot;, &quot;this demo&quot;, &quot;NOT AVAILABLE&quot;, &quot;TMN&quot;);\n\n    private final String errorCode;\n    private final String errorMessage;\n    private final String errorMessagePattern;\n    private final String systemErrorSource;\n\n    // This method will return specific enum which field is matching with the passed arguments\n    public static ErrorConstants fromErrorPatternt(String errorPattern, String errorSource) {\n        ...\n    }\n}\n</code></pre>\n<p>calling from here\nErrorConstants err = ErrorConstants.fromErrorPatternt(errorMsg, &quot;TMN&quot;);</p>\n<p>where the errorMsg to be matched errorMessagePattern  and &quot;TMN&quot; to be matched with systemErrorSource, then it will return the specific enum</p>\n"},{"tags":["java","hibernate","pojo","primitive-types"],"comments":[{"owner":{"account_id":200821,"reputation":4765,"user_id":446885,"accept_rate":93,"display_name":"Shahzeb"},"score":1,"creation_date":1316643529,"post_id":7506802,"comment_id":9091119,"body_markdown":"You can do all of that with hibernate without using JSR303.While being great and a right stepforward JSR303 has limitations but hibernate is there to sort that out.If you use Wrappers you will have so many issues and code will look dirty at the end when you will have so many getIntValue and Parse etc statments.Do not use wrappers.","body":"You can do all of that with hibernate without using JSR303.While being great and a right stepforward JSR303 has limitations but hibernate is there to sort that out.If you use Wrappers you will have so many issues and code will look dirty at the end when you will have so many getIntValue and Parse etc statments.Do not use wrappers."}],"answers":[{"tags":[],"owner":{"account_id":11683,"reputation":1438179,"user_id":22656,"accept_rate":86,"display_name":"Jon Skeet"},"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1316640239,"creation_date":1316640239,"answer_id":7506846,"question_id":7506802,"body_markdown":"The [Hibernate documentation][1] (just the first version I happened to find) states:\n\n&gt;  The property might have been called anything, and its type might have been any primitive type, any primitive &quot;wrapper&quot; type, java.lang.String or java.util.Date.\n&gt;\n&gt; ...\n&gt;\n&gt; We recommend that you declare consistently-named identifier properties on persistent classes and that you use a nullable (i.e., non-primitive) type.\n\nSo the &quot;expert&#39;s voice&quot; suggests using `Integer` / `Long`... but it&#39;s not described *why* this is the case.\n\nI wonder whether it&#39;s so that an object which hasn&#39;t been persisted yet can be created *without* an identifier (i.e. with a property value of `null`), distinguishing it from persisted entities.\n\n  [1]: http://docs.jboss.org/hibernate/core/3.3/reference/en/html/persistent-classes.html#persistent-classes-pojo-identifier","title":"Using wrapper Integer class or int primitive in hibernate mapping","body":"<p>The <a href=\"http://docs.jboss.org/hibernate/core/3.3/reference/en/html/persistent-classes.html#persistent-classes-pojo-identifier\" rel=\"noreferrer\">Hibernate documentation</a> (just the first version I happened to find) states:</p>\n<blockquote>\n<p>The property might have been called anything, and its type might have been any primitive type, any primitive &quot;wrapper&quot; type, java.lang.String or java.util.Date.</p>\n<p>...</p>\n<p>We recommend that you declare consistently-named identifier properties on persistent classes and that you use a nullable (i.e., non-primitive) type.</p>\n</blockquote>\n<p>So the &quot;expert's voice&quot; suggests using <code>Integer</code> / <code>Long</code>... but it's not described <em>why</em> this is the case.</p>\n<p>I wonder whether it's so that an object which hasn't been persisted yet can be created <em>without</em> an identifier (i.e. with a property value of <code>null</code>), distinguishing it from persisted entities.</p>\n"},{"tags":[],"owner":{"account_id":1376,"reputation":61107,"user_id":1836,"accept_rate":90,"display_name":"Matthew Farwell"},"down_vote_count":0,"up_vote_count":48,"is_accepted":false,"score":48,"last_activity_date":1316640590,"creation_date":1316640590,"answer_id":7506904,"question_id":7506802,"body_markdown":"Use wrappers, make your life simple.\r\n\r\nYour data model should dictate this. You should be enforcing nullability in the database anyway.\r\n\r\nIf they are nullable in the database, then use wrappers. If they are not nullable, and you use wrappers, then you&#39;ll get an exception if you try and insert a null into the database.\r\n\r\nIf your data model doesn&#39;t dictate it, then go for a convention, use wrappers all of the time. That way people don&#39;t have to think, or decide that a value of 0 means null.\r\n\r\nI would also query your assertion that it would less performant. Have you measured this? I mean really measured it? When you&#39;re talking to a database, there are a lot more considerations than the difference between 16 bits and 32 bits.\r\n\r\nJust use the simple, consistent solution. Use wrappers everywhere, unless somebody gives you a *very* good reason (with accurate measured statistics) to do otherwise.","title":"Using wrapper Integer class or int primitive in hibernate mapping","body":"<p>Use wrappers, make your life simple.</p>\n\n<p>Your data model should dictate this. You should be enforcing nullability in the database anyway.</p>\n\n<p>If they are nullable in the database, then use wrappers. If they are not nullable, and you use wrappers, then you'll get an exception if you try and insert a null into the database.</p>\n\n<p>If your data model doesn't dictate it, then go for a convention, use wrappers all of the time. That way people don't have to think, or decide that a value of 0 means null.</p>\n\n<p>I would also query your assertion that it would less performant. Have you measured this? I mean really measured it? When you're talking to a database, there are a lot more considerations than the difference between 16 bits and 32 bits.</p>\n\n<p>Just use the simple, consistent solution. Use wrappers everywhere, unless somebody gives you a <em>very</em> good reason (with accurate measured statistics) to do otherwise.</p>\n"},{"tags":[],"owner":{"account_id":952653,"reputation":9035,"user_id":978502,"accept_rate":67,"display_name":"yair"},"down_vote_count":0,"up_vote_count":16,"is_accepted":false,"score":16,"last_activity_date":1320672455,"creation_date":1320602731,"answer_id":8029152,"question_id":7506802,"body_markdown":"Thought it should be mentioned:\r\n\r\nHibernate recommendation (section 4.1.2) using non-primitive properties in persistent classes actually refers - as titled - to **identifier properties**:\r\n&gt; ## 4.1.2. Provide an identifier property ##\r\nCat has a property called id. This property maps to the primary key column(s) of a database table. The property might have been called anything, and its type might have been any primitive type, any primitive &quot;wrapper&quot; type, java.lang.String or java.util.Date.\r\n\r\n&gt; ...\r\n\r\n&gt; We recommend that you declare consistently-named identifier properties on persistent classes and that you use a nullable (i.e., non-primitive) type.\r\n\r\nNonetheless, the advantages of primitives aren&#39;t strong:\r\n\r\n1. Having an inconsistent non-null value in a property is worse than NullPointerException, as the lurking bug is harder to track: more time will pass since the code is written until a problem is detected and it may show up in a totally different code context than its source.\r\n2. Regarding performance: before testing the code - it is generally a premature consideration. Safety should come first.\r\n\r\n","title":"Using wrapper Integer class or int primitive in hibernate mapping","body":"<p>Thought it should be mentioned:</p>\n\n<p>Hibernate recommendation (section 4.1.2) using non-primitive properties in persistent classes actually refers - as titled - to <strong>identifier properties</strong>:</p>\n\n<blockquote>\n  <h2>4.1.2. Provide an identifier property</h2>\n  \n  <p>Cat has a property called id. This property maps to the primary key column(s) of a database table. The property might have been called anything, and its type might have been any primitive type, any primitive \"wrapper\" type, java.lang.String or java.util.Date.</p>\n  \n  <p>...</p>\n  \n  <p>We recommend that you declare consistently-named identifier properties on persistent classes and that you use a nullable (i.e., non-primitive) type.</p>\n</blockquote>\n\n<p>Nonetheless, the advantages of primitives aren't strong:</p>\n\n<ol>\n<li>Having an inconsistent non-null value in a property is worse than NullPointerException, as the lurking bug is harder to track: more time will pass since the code is written until a problem is detected and it may show up in a totally different code context than its source.</li>\n<li>Regarding performance: before testing the code - it is generally a premature consideration. Safety should come first.</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":6898784,"reputation":518,"user_id":5299082,"accept_rate":0,"display_name":"Krusty the Clown"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689951185,"creation_date":1689951185,"answer_id":76739069,"question_id":7506802,"body_markdown":"I&#39;m gonna go out on a limb and disagree with all of the other answers here. If the field is nullable in the database, use a wrapper. If it can&#39;t be null, use a primitive. Now you get the performance benefits, AND it&#39;s much easier to distinguish between fields that can and can&#39;t be null in your code. ","title":"Using wrapper Integer class or int primitive in hibernate mapping","body":"<p>I'm gonna go out on a limb and disagree with all of the other answers here. If the field is nullable in the database, use a wrapper. If it can't be null, use a primitive. Now you get the performance benefits, AND it's much easier to distinguish between fields that can and can't be null in your code.</p>\n"},{"tags":[],"owner":{"account_id":8022626,"reputation":112,"user_id":6050814,"display_name":"Pritam Rajput"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689951681,"creation_date":1689951681,"answer_id":76739121,"question_id":7506802,"body_markdown":"If you are using a database like **mongo db**, OR the data has meaning when its **null** go with **Wrapper**,\r\n\r\n**Tip**: If you are doing calculations just create an extraNullChecked getter and use that to avoid null checks all over the codebase.\r\n\r\nIf the Data point **has to have a value all the time** and can&#39;t be null, **use primitive**.","title":"Using wrapper Integer class or int primitive in hibernate mapping","body":"<p>If you are using a database like <strong>mongo db</strong>, OR the data has meaning when its <strong>null</strong> go with <strong>Wrapper</strong>,</p>\n<p><strong>Tip</strong>: If you are doing calculations just create an extraNullChecked getter and use that to avoid null checks all over the codebase.</p>\n<p>If the Data point <strong>has to have a value all the time</strong> and can't be null, <strong>use primitive</strong>.</p>\n"}],"owner":{"account_id":482678,"reputation":959,"user_id":897225,"accept_rate":17,"display_name":"vanvasquez"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":27270,"favorite_count":0,"down_vote_count":0,"up_vote_count":50,"answer_count":5,"score":50,"last_activity_date":1689951681,"creation_date":1316639977,"question_id":7506802,"body_markdown":"In the company that I work for we have this major discussion on whether it should be better to use wrapping classes for primitives (java.lang.Integer, java.lang.Long) or whether to use the primitive types directly in the POJOs that map Entities to Tables in Hibernate.\r\n \r\nThe idea is that we want these values to not be null in the database.\r\n\r\n**The arguments in favor of using primitives:**\r\n\r\n - Handling these values as int means that they can never be null, in\r\n   this way making it impossible to inadvertently get a null reference\r\n   on the field. \r\n - int=32/64 bits of memory.  Integer = 16 bytes of memory\r\n   and is also slower\r\n\r\n**The arguments in favor of using wrapper objects:**\r\n\r\n - We can add a constraint at the database level to always prevent null\r\n   values from getting there \r\n - We can end up with misleading data, we can\r\n   have 0&#39;s instead of nulls in the database whenever the user doesn&#39;t\r\n   set a value and buggy data is a tough catch. \r\n - Objects have more expressive power than primitives.  We have null values and also\r\n   integer values, so we can validate them easier using  annotations for\r\n   example (javax.validation.constraints.NotNull).\r\n\r\n   ","title":"Using wrapper Integer class or int primitive in hibernate mapping","body":"<p>In the company that I work for we have this major discussion on whether it should be better to use wrapping classes for primitives (java.lang.Integer, java.lang.Long) or whether to use the primitive types directly in the POJOs that map Entities to Tables in Hibernate.</p>\n\n<p>The idea is that we want these values to not be null in the database.</p>\n\n<p><strong>The arguments in favor of using primitives:</strong></p>\n\n<ul>\n<li>Handling these values as int means that they can never be null, in\nthis way making it impossible to inadvertently get a null reference\non the field. </li>\n<li>int=32/64 bits of memory.  Integer = 16 bytes of memory\nand is also slower</li>\n</ul>\n\n<p><strong>The arguments in favor of using wrapper objects:</strong></p>\n\n<ul>\n<li>We can add a constraint at the database level to always prevent null\nvalues from getting there </li>\n<li>We can end up with misleading data, we can\nhave 0's instead of nulls in the database whenever the user doesn't\nset a value and buggy data is a tough catch. </li>\n<li>Objects have more expressive power than primitives.  We have null values and also\ninteger values, so we can validate them easier using  annotations for\nexample (javax.validation.constraints.NotNull).</li>\n</ul>\n"},{"tags":["java","amazon-web-services","amazon-s3"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1689867801,"post_id":76728465,"comment_id":135277338,"body_markdown":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.","body":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking."},{"owner":{"account_id":303420,"reputation":10129,"user_id":2378643,"display_name":"Anon Coward"},"score":1,"creation_date":1689870868,"post_id":76728465,"comment_id":135277983,"body_markdown":"Why is a key that starts with `/` invalid?  Also, S3 is not eventually consistent.","body":"Why is a key that starts with <code>&#47;</code> invalid?  Also, S3 is not eventually consistent."},{"owner":{"account_id":29055596,"reputation":1,"user_id":22257445,"display_name":"fifan"},"score":0,"creation_date":1689926738,"post_id":76728465,"comment_id":135285122,"body_markdown":"My probleme is that doesObjectExist returns true even if the object does not exists in S3.","body":"My probleme is that doesObjectExist returns true even if the object does not exists in S3."},{"owner":{"account_id":100740,"reputation":73217,"user_id":271415,"accept_rate":91,"display_name":"jarmod"},"score":0,"creation_date":1689943669,"post_id":76728465,"comment_id":135288333,"body_markdown":"@fifan I think you&#39;re mistaken. The object *does* exist.","body":"@fifan I think you&#39;re mistaken. The object <i>does</i> exist."},{"owner":{"account_id":29055596,"reputation":1,"user_id":22257445,"display_name":"fifan"},"score":0,"creation_date":1689945739,"post_id":76728465,"comment_id":135288757,"body_markdown":"I&#39;ve verified on S3 browser, that does not existe , and I know why , that&#39;s because the key starts with &#39;/&#39;.","body":"I&#39;ve verified on S3 browser, that does not existe , and I know why , that&#39;s because the key starts with &#39;/&#39;."},{"owner":{"account_id":100740,"reputation":73217,"user_id":271415,"accept_rate":91,"display_name":"jarmod"},"score":0,"creation_date":1689949765,"post_id":76728465,"comment_id":135289621,"body_markdown":"I think you are mis-reading the situation. I don&#39;t use S3Browser, and it&#39;s not an authoritative source, but it might show an unnamed top-level folder or one simply named `/`. If so, click on it to see your object. Or, as mentioned, use the awscli to authoritatively verify the object&#39;s existence","body":"I think you are mis-reading the situation. I don&#39;t use S3Browser, and it&#39;s not an authoritative source, but it might show an unnamed top-level folder or one simply named <code>&#47;</code>. If so, click on it to see your object. Or, as mentioned, use the awscli to authoritatively verify the object&#39;s existence"}],"answers":[{"tags":[],"owner":{"account_id":100740,"reputation":73217,"user_id":271415,"accept_rate":91,"display_name":"jarmod"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689951070,"creation_date":1689898396,"answer_id":76734386,"question_id":76728465,"body_markdown":"Your code is working correctly.\r\n\r\nWhen you upload to a key such as `/dog.png`, you do indeed get an S3 object with the key `/dog.png`. You can see this if you run `aws s3 ls s3://mybucket//` (with extra trailing slash) instead of `aws s3 ls s3://mybucket/`. You can also verify this by issuing a HeadObject request for the key `/dog.png`, which is effectively what the `doesObjectExist()` method does.\r\n\r\nTo verify the object exists using the awscli, run:\r\n\r\n    aws s3api head-object --bucket mybucket --key /dog.png\r\n\r\nSo the upload succeeds and `doesObjectExist()` correctly returns true.\r\n\r\nAs a general rule, you probably want to avoid leading slash because it is confusing for people.","title":"check existance of object after uploading it to S3","body":"<p>Your code is working correctly.</p>\n<p>When you upload to a key such as <code>/dog.png</code>, you do indeed get an S3 object with the key <code>/dog.png</code>. You can see this if you run <code>aws s3 ls s3://mybucket//</code> (with extra trailing slash) instead of <code>aws s3 ls s3://mybucket/</code>. You can also verify this by issuing a HeadObject request for the key <code>/dog.png</code>, which is effectively what the <code>doesObjectExist()</code> method does.</p>\n<p>To verify the object exists using the awscli, run:</p>\n<pre><code>aws s3api head-object --bucket mybucket --key /dog.png\n</code></pre>\n<p>So the upload succeeds and <code>doesObjectExist()</code> correctly returns true.</p>\n<p>As a general rule, you probably want to avoid leading slash because it is confusing for people.</p>\n"}],"owner":{"account_id":29055596,"reputation":1,"user_id":22257445,"display_name":"fifan"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":61,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1689951070,"creation_date":1689845247,"question_id":76728465,"body_markdown":"I want to check if an object us successfuly uploaded to S3 just after uploading it.\r\n\r\n```\r\nPutObjectRequest putObjReq = new PutObjectRequest(bucketName, s3Key, tmpArchivePath.toFile());\r\nUpload upload = transferManager.upload(putObjReq);\r\nupload.waitForCompletion();\r\nboolean fileExistsAfter = s3Client.doesObjectExist(bucketName, s3Key);\r\n```\r\n\r\nthat returns always true ,even if the object is not successfully uploaded. I think that is because of the Eventual Consistency,\r\nexample:\r\nwhen the s3Key starts with / , it is not a valid key ,so the object will not be uploaded however it returns true\r\n","title":"check existance of object after uploading it to S3","body":"<p>I want to check if an object us successfuly uploaded to S3 just after uploading it.</p>\n<pre><code>PutObjectRequest putObjReq = new PutObjectRequest(bucketName, s3Key, tmpArchivePath.toFile());\nUpload upload = transferManager.upload(putObjReq);\nupload.waitForCompletion();\nboolean fileExistsAfter = s3Client.doesObjectExist(bucketName, s3Key);\n</code></pre>\n<p>that returns always true ,even if the object is not successfully uploaded. I think that is because of the Eventual Consistency,\nexample:\nwhen the s3Key starts with / , it is not a valid key ,so the object will not be uploaded however it returns true</p>\n"},{"tags":["java","eclipse","gradle","jar"],"comments":[{"owner":{"account_id":5404,"reputation":22089,"user_id":8681,"accept_rate":67,"display_name":"Jorn"},"score":0,"creation_date":1689950978,"post_id":76739023,"comment_id":135289901,"body_markdown":"Is 4.3 the Gradle version declared in your app? What does `./gradlew --version` print on the command line?","body":"Is 4.3 the Gradle version declared in your app? What does <code>.&#47;gradlew --version</code> print on the command line?"},{"owner":{"account_id":18888609,"reputation":33,"user_id":13779404,"display_name":"Mandar Remane"},"score":0,"creation_date":1689951173,"post_id":76739023,"comment_id":135289946,"body_markdown":"gradle --version on cmd prints 6.8.3, and yes in build.gradle in dependencies it is written &quot;classpath &quot;some-website:build-info-extractor-gradle:4.31.8&quot;","body":"gradle --version on cmd prints 6.8.3, and yes in build.gradle in dependencies it is written &quot;classpath &quot;some-website:build-info-extractor-gradle:4.31.8&quot;"}],"owner":{"account_id":18888609,"reputation":33,"user_id":13779404,"display_name":"Mandar Remane"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":58,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689950902,"creation_date":1689950902,"question_id":76739023,"body_markdown":"I am trying to add Gradle Nature into my Eclipse Project.\r\nGradle build is successfully running from my command prompt, but giving following error when tried to add Gradle Nature through Eclipse.\r\n\r\nError : \r\n&gt; Synchronize Gradle projects with workspace failed due to an error in the referenced Gradle build.\r\n&gt; Could not run build action using Gradle distribution &#39;https://services.gradle.org/distributions/gradle-4.3-bin.zip&#39;.\r\n\r\nNote - \r\n1. I am running Eclipse as admin.\r\n2. from eclipse -&gt; properties -&gt; I am not able to see gradle option to change the &quot;Specific Gradle Version&quot; \r\n\r\nTried deleting the gradle-4.3-bin from C:/Users/name/.gradle/wrapper/dists","title":"Could not run build action using Gradle distribution - Eclipse","body":"<p>I am trying to add Gradle Nature into my Eclipse Project.\nGradle build is successfully running from my command prompt, but giving following error when tried to add Gradle Nature through Eclipse.</p>\n<p>Error :</p>\n<blockquote>\n<p>Synchronize Gradle projects with workspace failed due to an error in the referenced Gradle build.\nCould not run build action using Gradle distribution 'https://services.gradle.org/distributions/gradle-4.3-bin.zip'.</p>\n</blockquote>\n<p>Note -</p>\n<ol>\n<li>I am running Eclipse as admin.</li>\n<li>from eclipse -&gt; properties -&gt; I am not able to see gradle option to change the &quot;Specific Gradle Version&quot;</li>\n</ol>\n<p>Tried deleting the gradle-4.3-bin from C:/Users/name/.gradle/wrapper/dists</p>\n"},{"tags":["java","quicksort","swap","partition"],"comments":[{"owner":{"account_id":1888781,"reputation":2007,"user_id":1707427,"display_name":"S&#246;ren"},"score":0,"creation_date":1689949155,"post_id":76738704,"comment_id":135289485,"body_markdown":"Well, have you tried it? Either on paper, or with a debugger? Take one example, go through it, and look at the state of the array after the while loop has finished.","body":"Well, have you tried it? Either on paper, or with a debugger? Take one example, go through it, and look at the state of the array after the while loop has finished."},{"owner":{"account_id":14673420,"reputation":13,"user_id":10597289,"display_name":"user10597289"},"score":0,"creation_date":1689949814,"post_id":76738704,"comment_id":135289634,"body_markdown":"Thank you. Yes i tried it but i dont have clue now. I will try it on Monday again.","body":"Thank you. Yes i tried it but i dont have clue now. I will try it on Monday again."}],"answers":[{"tags":[],"owner":{"account_id":27668746,"reputation":233,"user_id":21120027,"display_name":"Dulan Jayawickrama"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1689950315,"creation_date":1689950315,"answer_id":76738949,"question_id":76738704,"body_markdown":"The second swap in the partition function is there to place the pivot element in its correct sorted position in the array.\r\n\r\nOnce the loop in the partition function finishes, it means that i and j have crossed each other, and the elements to the left of j are less than or equal to the pivot, while the elements to the right of j are greater than the pivot.\r\n\r\nHowever, the pivot element is still at array[links]. To place the pivot in its correct sorted position, you need to swap it with the element at index j. After this swap, the pivot element is at its correct position, and all elements to the left of it are smaller or equal, and all elements to the right are greater.","title":"I implemented a quicksort in Java and it works properly but i dont understand the second swap in the partition function?","body":"<p>The second swap in the partition function is there to place the pivot element in its correct sorted position in the array.</p>\n<p>Once the loop in the partition function finishes, it means that i and j have crossed each other, and the elements to the left of j are less than or equal to the pivot, while the elements to the right of j are greater than the pivot.</p>\n<p>However, the pivot element is still at array[links]. To place the pivot in its correct sorted position, you need to swap it with the element at index j. After this swap, the pivot element is at its correct position, and all elements to the left of it are smaller or equal, and all elements to the right are greater.</p>\n"},{"tags":[],"owner":{"account_id":4228398,"reputation":17727,"user_id":3461397,"display_name":"Oleg Cherednik"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689950871,"creation_date":1689950401,"answer_id":76738955,"question_id":76738704,"body_markdown":"Yes have to do the last `swap()`, because you return `j` - is the first element of the second half (which is higher than pivot element). The pivot element is the first one `arr[0]`, so you shoul move it to the end of the first path.\r\n\r\n```java\r\nprivate static int partition(int[] arr, int lo, int hi) {\r\n    // A\r\n    int i = lo, j = hi;\r\n    int v = arr[lo];\r\n\r\n    while (i &lt;= j) {\r\n        if (arr[i] &lt;= v) i++;\r\n        else if (arr[j] &gt; v) j--;\r\n        else swap(arr, ++i, --j);\r\n    }\r\n    \r\n    // B\r\n    swap(arr, lo, j);\r\n    \r\n    // C\r\n    return j;\r\n}\r\n\r\npublic static void swap(int[] arr, int i, int j) {\r\n    int tmp = arr[i];\r\n    arr[i] = arr[j];\r\n    arr[j] = tmp;\r\n}\r\n```\r\n\r\n`step A: [7, 6, 1, 3, 5, 10, 15, 11, 1, 2, 18, 11, 4, 5, 17, 20, 25, 3, 8, 16]`, the pivot elemnt is `arr[0] = 7`, so we have to move all elements `&lt;= 7` to the left part, and `&gt; 7` -  to the right. And return the index of the first element of the right part.\r\n\r\n`step B: [7, 6, 1, 3, 5, 10, 25, 4, 1, 2, 18, 11, 11, 5, 17, 20, 15, 3, 8, 16]`, the `j = 9 =&gt; arr[9] = 2`. So you either should do `j++`, but this is dangerout, in case `j = arr.length -1`. Or do not change it and `swap(arr, 0, 9)`.\r\n\r\n`step C: [2, 6, 1, 3, 5, 10, 25, 4, 1, 7, 18, 11, 11, 5, 17, 20, 15, 3, 8, 16]`\r\n\r\n","title":"I implemented a quicksort in Java and it works properly but i dont understand the second swap in the partition function?","body":"<p>Yes have to do the last <code>swap()</code>, because you return <code>j</code> - is the first element of the second half (which is higher than pivot element). The pivot element is the first one <code>arr[0]</code>, so you shoul move it to the end of the first path.</p>\n<pre class=\"lang-java prettyprint-override\"><code>private static int partition(int[] arr, int lo, int hi) {\n    // A\n    int i = lo, j = hi;\n    int v = arr[lo];\n\n    while (i &lt;= j) {\n        if (arr[i] &lt;= v) i++;\n        else if (arr[j] &gt; v) j--;\n        else swap(arr, ++i, --j);\n    }\n    \n    // B\n    swap(arr, lo, j);\n    \n    // C\n    return j;\n}\n\npublic static void swap(int[] arr, int i, int j) {\n    int tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n</code></pre>\n<p><code>step A: [7, 6, 1, 3, 5, 10, 15, 11, 1, 2, 18, 11, 4, 5, 17, 20, 25, 3, 8, 16]</code>, the pivot elemnt is <code>arr[0] = 7</code>, so we have to move all elements <code>&lt;= 7</code> to the left part, and <code>&gt; 7</code> -  to the right. And return the index of the first element of the right part.</p>\n<p><code>step B: [7, 6, 1, 3, 5, 10, 25, 4, 1, 2, 18, 11, 11, 5, 17, 20, 15, 3, 8, 16]</code>, the <code>j = 9 =&gt; arr[9] = 2</code>. So you either should do <code>j++</code>, but this is dangerout, in case <code>j = arr.length -1</code>. Or do not change it and <code>swap(arr, 0, 9)</code>.</p>\n<p><code>step C: [2, 6, 1, 3, 5, 10, 25, 4, 1, 7, 18, 11, 11, 5, 17, 20, 15, 3, 8, 16]</code></p>\n"}],"owner":{"account_id":14673420,"reputation":13,"user_id":10597289,"display_name":"user10597289"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":38,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":76738949,"answer_count":2,"score":1,"last_activity_date":1689950871,"creation_date":1689948387,"question_id":76738704,"body_markdown":"```\r\n    private static int partition(int[] array,int links, int rechts) \r\n    {\r\n        int pivotelement = array[links];  //pivotelement on the left\r\n        int i = links;                    // links means leftside\r\n        int j = rechts;                   // rechts means rightside\r\n                                         \r\n        while (i &lt;= j) \r\n        {\r\n            if (array[i] &lt;= pivotelement) \r\n            {\r\n                i++;\r\n            }\r\n            else if (array[j] &gt; pivotelement)\r\n            {\r\n                j--;\r\n            }\r\n            else\r\n            {\r\n            \tswap(array,i,j);   **//first swap makes sense to me**\r\n                i++;\r\n                j--;\r\n            }\r\n        }\r\n        swap(array,links,j);    **//Here is the second swap. Im not sure about that but it works**.\r\n        return j;\r\n   \t}\r\n    \r\n    public static void swap(int[] array, int i, int j) {\r\n        int temp = array[i];\r\n        array[i] = array[j];\r\n        array[j] = temp;\r\n    }\r\n```\r\n\r\n# **Im expecting a explanation of the second swap. Why is it necessary?** \r\n\r\nI found out that in a sorted list i dont need the second swap. Sorry thats my first Question in Stack Overflow. When you need more Information just ask for it. \r\n\r\nThese are the  arrays i try it with and it works.\r\n\r\n\t\tint[] array = {1,2,3,4,5,6,7,8,9,10};\r\n\t\tint[] array = {4,7,4,6,8,2,3,4,6,2};\r\n\t\tint[] array = {8,4,6,3,7,1,0,9,5,22};\r\n\t\tint[] array = {1};                                                                             ","title":"I implemented a quicksort in Java and it works properly but i dont understand the second swap in the partition function?","body":"<pre><code>    private static int partition(int[] array,int links, int rechts) \n    {\n        int pivotelement = array[links];  //pivotelement on the left\n        int i = links;                    // links means leftside\n        int j = rechts;                   // rechts means rightside\n                                         \n        while (i &lt;= j) \n        {\n            if (array[i] &lt;= pivotelement) \n            {\n                i++;\n            }\n            else if (array[j] &gt; pivotelement)\n            {\n                j--;\n            }\n            else\n            {\n                swap(array,i,j);   **//first swap makes sense to me**\n                i++;\n                j--;\n            }\n        }\n        swap(array,links,j);    **//Here is the second swap. Im not sure about that but it works**.\n        return j;\n    }\n    \n    public static void swap(int[] array, int i, int j) {\n        int temp = array[i];\n        array[i] = array[j];\n        array[j] = temp;\n    }\n</code></pre>\n<h1><strong>Im expecting a explanation of the second swap. Why is it necessary?</strong></h1>\n<p>I found out that in a sorted list i dont need the second swap. Sorry thats my first Question in Stack Overflow. When you need more Information just ask for it.</p>\n<p>These are the  arrays i try it with and it works.</p>\n<pre><code>    int[] array = {1,2,3,4,5,6,7,8,9,10};\n    int[] array = {4,7,4,6,8,2,3,4,6,2};\n    int[] array = {8,4,6,3,7,1,0,9,5,22};\n    int[] array = {1};                                                                             \n</code></pre>\n"},{"tags":["java","kotlin","apache-kafka","kafka-consumer-api","apache-kafka-streams"],"owner":{"account_id":7209594,"reputation":1,"user_id":5504151,"display_name":"Antoine Michaud"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":124,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689950865,"creation_date":1686134586,"question_id":76422441,"body_markdown":"# Context:\r\n\r\nWe have currently a stateful kafka streams application in a kubernetes environment and aws msk cluster. We are joining a total of 7 topics, creating a 13 sub-topologies topology, with 21 internal topics (excluding changelogs), and 36 stores. Each input topic have tens of millions of events (compacted topics), where we are receiving from 60 events/s to 2k events/s. Everything on 12 instances.\r\n\r\n# Problem:\r\n\r\nEven if we have a big cpu, a lot of memory, a performant disk or a big msk cluster, we are not able to maximize the consumption:\r\n- we are far from 100% of cpu\r\n- the GC is not bursting\r\n- the disk is far from maximum use\r\n- the msk cluster is sleeping regarding network, disk and cpu uses\r\n\r\nWhen we reconsume all the topics at the same time, we are well using the maximum resources and be able to consume 100k+ events/s, use the disk at 100% iops or burst the cpu or memory of the msk cluster, but only temporary, where at 10% of the reconsumption, we are near to 30% cpu and 30% of disk iops.\r\n\r\nWhen we reset the offset of a 1 partition input topic, it&#39;s obvious: we are consuming like 2k events/s where the only instance consuming this topic is sleeping (30% cpu, network at less than 1MB/s, disk at 5%) and the msk cluster also sleeping.\r\n\r\nWhen we restore 1 partition only, it seems the same problems: We can see bumps every 30-40 seconds of thousand events per second consumed (and between bumps, we restore nothing), so the restore process is always very, very long.\r\n\r\n# Configurations\r\nCurrent configurations on pastebin (consumer, restore consumer, streams &amp; rocksdb) to not pollute the message, but stack overflow don&#39;t want to accept my link... Here it is as code: `pastebin.com/Z8kcX6YG`\r\n\r\n# What we did\r\nWe discovered that when we increase the number of streams threads from 1 to more (tested with 3 and 5 threads), we can go to 100% of disk and cpu usage during reconsumptions and restores, but still with the same issue when we are consumption big amount of events in 1 partition only: not at maximum regarding network, cpu, disk and msk cluster.\r\n\r\nWe also analysed with JFR, but it seems no throttling point, except the big amount of time spent for socket selector.\r\n\r\nRegarding all of that, we are not able to scale properly, so each reconsumption is a pain because we need hours and days to finish the process.\r\n\r\n# Question\r\nHow can we improve the consumption performances to be able to scale up ?","title":"Throttling on kafka-streams consumption, how to improve it?","body":"<h1>Context:</h1>\n<p>We have currently a stateful kafka streams application in a kubernetes environment and aws msk cluster. We are joining a total of 7 topics, creating a 13 sub-topologies topology, with 21 internal topics (excluding changelogs), and 36 stores. Each input topic have tens of millions of events (compacted topics), where we are receiving from 60 events/s to 2k events/s. Everything on 12 instances.</p>\n<h1>Problem:</h1>\n<p>Even if we have a big cpu, a lot of memory, a performant disk or a big msk cluster, we are not able to maximize the consumption:</p>\n<ul>\n<li>we are far from 100% of cpu</li>\n<li>the GC is not bursting</li>\n<li>the disk is far from maximum use</li>\n<li>the msk cluster is sleeping regarding network, disk and cpu uses</li>\n</ul>\n<p>When we reconsume all the topics at the same time, we are well using the maximum resources and be able to consume 100k+ events/s, use the disk at 100% iops or burst the cpu or memory of the msk cluster, but only temporary, where at 10% of the reconsumption, we are near to 30% cpu and 30% of disk iops.</p>\n<p>When we reset the offset of a 1 partition input topic, it's obvious: we are consuming like 2k events/s where the only instance consuming this topic is sleeping (30% cpu, network at less than 1MB/s, disk at 5%) and the msk cluster also sleeping.</p>\n<p>When we restore 1 partition only, it seems the same problems: We can see bumps every 30-40 seconds of thousand events per second consumed (and between bumps, we restore nothing), so the restore process is always very, very long.</p>\n<h1>Configurations</h1>\n<p>Current configurations on pastebin (consumer, restore consumer, streams &amp; rocksdb) to not pollute the message, but stack overflow don't want to accept my link... Here it is as code: <code>pastebin.com/Z8kcX6YG</code></p>\n<h1>What we did</h1>\n<p>We discovered that when we increase the number of streams threads from 1 to more (tested with 3 and 5 threads), we can go to 100% of disk and cpu usage during reconsumptions and restores, but still with the same issue when we are consumption big amount of events in 1 partition only: not at maximum regarding network, cpu, disk and msk cluster.</p>\n<p>We also analysed with JFR, but it seems no throttling point, except the big amount of time spent for socket selector.</p>\n<p>Regarding all of that, we are not able to scale properly, so each reconsumption is a pain because we need hours and days to finish the process.</p>\n<h1>Question</h1>\n<p>How can we improve the consumption performances to be able to scale up ?</p>\n"},{"tags":["java","tomcat7","java-websocket","cometd"],"answers":[{"tags":[],"owner":{"account_id":1255537,"reputation":17217,"user_id":1215076,"display_name":"sbordet"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689950052,"creation_date":1689950052,"answer_id":76738918,"question_id":76732744,"body_markdown":"CometD does not support streaming of message content, as messages are formatted in JSON following the Bayeux protocol.\r\n\r\nThe typical case of wanting to stream content is for large contents, to reduce memory footprint.\r\n\r\nUsing messaging for large uploads/downloads is not really the use case for CometD: it would be far better to exchange an upload/download URI, and use HTTP (or even WebSocket, but with a different protocol than Bayeux) for the upload/download of large content.\r\n\r\nIf you specify what is exactly your use case, the answer could be more precise. ","title":"Does CometD support partial websocket messaging","body":"<p>CometD does not support streaming of message content, as messages are formatted in JSON following the Bayeux protocol.</p>\n<p>The typical case of wanting to stream content is for large contents, to reduce memory footprint.</p>\n<p>Using messaging for large uploads/downloads is not really the use case for CometD: it would be far better to exchange an upload/download URI, and use HTTP (or even WebSocket, but with a different protocol than Bayeux) for the upload/download of large content.</p>\n<p>If you specify what is exactly your use case, the answer could be more precise.</p>\n"}],"owner":{"account_id":6301107,"reputation":1,"user_id":4895735,"display_name":"kavish jain"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":10,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689950052,"creation_date":1689877463,"question_id":76732744,"body_markdown":"I have application using CometD version 5 that does not support partial messages over websocket. Is it supported in newer version or else do i need to do it in my application. Any java libraries that provide partial messaging OOB with CometD\r\n\r\nNo support in CometD version 5. \r\nMay consider upgrading the version 7 if it is supported or if third library exists","title":"Does CometD support partial websocket messaging","body":"<p>I have application using CometD version 5 that does not support partial messages over websocket. Is it supported in newer version or else do i need to do it in my application. Any java libraries that provide partial messaging OOB with CometD</p>\n<p>No support in CometD version 5.\nMay consider upgrading the version 7 if it is supported or if third library exists</p>\n"},{"tags":["java","linux"],"comments":[{"owner":{"account_id":9463219,"reputation":9357,"user_id":7036419,"display_name":"Maurice Perry"},"score":1,"creation_date":1494566431,"post_id":43929744,"comment_id":74892442,"body_markdown":"I don&#39;t get it: getResource() returns a URL, why would you use it if you already have an URL?","body":"I don&#39;t get it: getResource() returns a URL, why would you use it if you already have an URL?"},{"owner":{"account_id":3468356,"reputation":4510,"user_id":2903371,"accept_rate":92,"display_name":"patrik"},"score":0,"creation_date":1494566565,"post_id":43929744,"comment_id":74892495,"body_markdown":"@MauricePerry Yes agreed! The URLs have some complicated sorting since there are dependencies between the resources. The function which reads the resources and sorts them takes a string input. The reason for this is that it is allowed to add resources as strings as well in this function. This is not my choice, but I have to comply with it. Also, I prefer to not rewrite another library just to make my implmentation work.","body":"@MauricePerry Yes agreed! The URLs have some complicated sorting since there are dependencies between the resources. The function which reads the resources and sorts them takes a string input. The reason for this is that it is allowed to add resources as strings as well in this function. This is not my choice, but I have to comply with it. Also, I prefer to not rewrite another library just to make my implmentation work."}],"owner":{"account_id":3468356,"reputation":4510,"user_id":2903371,"accept_rate":92,"display_name":"patrik"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":65,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689949931,"creation_date":1494566033,"question_id":43929744,"body_markdown":"I need to get a resource from within a jar file using `getClass().getResource()`. The problem is that I have a URL as input and there seems to be some compatibility issues between URL and getResource()\r\n\r\nSo what I do currently is,\r\n\r\n    getClass().getResource(url.getPath());\r\n\r\nThis does however not work (and neither does getResourceAsStream()) since the output from `url.getPath()` looks something like this,\r\n\r\n    file:/mavenPath/repository/myJar.jar!/path/to/resource/myResource.ext\r\n\r\nHowever the path\r\n\r\n    /path/to/resource/myResource.ext\r\n\r\nwould work. I also noted that\r\n\r\n    url.toURI()\r\n\r\nworks but,\r\n\r\n    url.toURI().getPath()\r\n\r\nreturns null (I am not sure if this is related). So the problem seems to be this first path,\r\n\r\n    file:/mavenPath/repository/myJar.jar!\r\n\r\nWhich causes problems with the classloader.\r\n\r\nDoes anyone have a solution to this? I doubt I am to be the first one with the problem so there should be some solution I hope. The problem is that this notation probably differs from Windows to Linux I am afraid to cause compatibility between windows and linux if I manually modify the path.\r\n\r\nIt might be worth noting that I use Linux and the resources is included in the classpath, but not inside the same jar file as the method where I have problems.\r\n\r\n**EDIT**\r\n\r\nSomeone pointed out that getResource() returns a URL. The problem is that I have multiple URLs with dependencies (actually they are MIBs). The function reading the URLs is located in another library and takes a String input. It also includes some IANA and IETF standard MIBs.","title":"Compatibility problems with using getResource() together with URL","body":"<p>I need to get a resource from within a jar file using <code>getClass().getResource()</code>. The problem is that I have a URL as input and there seems to be some compatibility issues between URL and getResource()</p>\n\n<p>So what I do currently is,</p>\n\n<pre><code>getClass().getResource(url.getPath());\n</code></pre>\n\n<p>This does however not work (and neither does getResourceAsStream()) since the output from <code>url.getPath()</code> looks something like this,</p>\n\n<pre><code>file:/mavenPath/repository/myJar.jar!/path/to/resource/myResource.ext\n</code></pre>\n\n<p>However the path</p>\n\n<pre><code>/path/to/resource/myResource.ext\n</code></pre>\n\n<p>would work. I also noted that</p>\n\n<pre><code>url.toURI()\n</code></pre>\n\n<p>works but,</p>\n\n<pre><code>url.toURI().getPath()\n</code></pre>\n\n<p>returns null (I am not sure if this is related). So the problem seems to be this first path,</p>\n\n<pre><code>file:/mavenPath/repository/myJar.jar!\n</code></pre>\n\n<p>Which causes problems with the classloader.</p>\n\n<p>Does anyone have a solution to this? I doubt I am to be the first one with the problem so there should be some solution I hope. The problem is that this notation probably differs from Windows to Linux I am afraid to cause compatibility between windows and linux if I manually modify the path.</p>\n\n<p>It might be worth noting that I use Linux and the resources is included in the classpath, but not inside the same jar file as the method where I have problems.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Someone pointed out that getResource() returns a URL. The problem is that I have multiple URLs with dependencies (actually they are MIBs). The function reading the URLs is located in another library and takes a String input. It also includes some IANA and IETF standard MIBs.</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":0,"creation_date":1689949712,"post_id":76738855,"comment_id":135289613,"body_markdown":"Does this answer your question? [Non-static variable cannot be referenced from a static context](https://stackoverflow.com/questions/2559527/non-static-variable-cannot-be-referenced-from-a-static-context)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/2559527/non-static-variable-cannot-be-referenced-from-a-static-context\">Non-static variable cannot be referenced from a static context</a>"},{"owner":{"display_name":"user6073886"},"score":1,"creation_date":1689949741,"post_id":76738855,"comment_id":135289615,"body_markdown":"`Complex cAdd=Complex.add(c1,c2);` &lt;- this is simply not how you call instance methods on objects. I strongly recommend going back and reading a basic tutorial about how instance methods are called in java: https://docs.oracle.com/javase/tutorial/java/javaOO/usingobject.html and also reading up about [what static means in java](https://stackoverflow.com/questions/413898/what-does-the-static-keyword-do-in-a-class)","body":"<code>Complex cAdd=Complex.add(c1,c2);</code> &lt;- this is simply not how you call instance methods on objects. I strongly recommend going back and reading a basic tutorial about how instance methods are called in java: <a href=\"https://docs.oracle.com/javase/tutorial/java/javaOO/usingobject.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/tutorial/java/javaOO/usingobject.html</a> and also reading up about <a href=\"https://stackoverflow.com/questions/413898/what-does-the-static-keyword-do-in-a-class\">what static means in java</a>"},{"owner":{"account_id":5404,"reputation":22089,"user_id":8681,"accept_rate":67,"display_name":"Jorn"},"score":1,"creation_date":1689949796,"post_id":76738855,"comment_id":135289630,"body_markdown":"You are mixing two options. Either declare `static Complex add(Complex c1, Complex c2)` or `Complex add(Complex other)`.","body":"You are mixing two options. Either declare <code>static Complex add(Complex c1, Complex c2)</code> or <code>Complex add(Complex other)</code>."},{"owner":{"account_id":10836,"reputation":196641,"user_id":20654,"accept_rate":80,"display_name":"OscarRyz"},"score":0,"creation_date":1689950112,"post_id":76738855,"comment_id":135289715,"body_markdown":"Add `static` to your `add` method: `static Complex add(Complex a, Complex b) { ...`","body":"Add <code>static</code> to your <code>add</code> method: <code>static Complex add(Complex a, Complex b) { ...</code>"},{"owner":{"account_id":401843,"reputation":89768,"user_id":768644,"display_name":"rzwitserloot"},"score":1,"creation_date":1689950800,"post_id":76738855,"comment_id":135289844,"body_markdown":"When making a method that takes 2 complex, you don&#39;t need the &#39;context&#39; of a complex number. This isn&#39;t OO and isn&#39;t proper java style. What would be much better is `public Complex plus(Complex other) { return new Complex(this.real + other.real, this.imag + other.imag); }` - instead of &quot;A function that is given 2 complex numbers that makes a new one&quot;, you now have: &quot;A function you can call _on an instance of Complex_, you pass another instance of Complex, and as a result the instance of Complex adds the other number to itself and returns that.","body":"When making a method that takes 2 complex, you don&#39;t need the &#39;context&#39; of a complex number. This isn&#39;t OO and isn&#39;t proper java style. What would be much better is <code>public Complex plus(Complex other) { return new Complex(this.real + other.real, this.imag + other.imag); }</code> - instead of &quot;A function that is given 2 complex numbers that makes a new one&quot;, you now have: &quot;A function you can call <i>on an instance of Complex</i>, you pass another instance of Complex, and as a result the instance of Complex adds the other number to itself and returns that."}],"owner":{"account_id":29064453,"reputation":1,"user_id":22264386,"display_name":"VaccinalShip"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":24,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1689949697,"answer_count":0,"score":0,"last_activity_date":1689949587,"creation_date":1689949587,"question_id":76738855,"body_markdown":"I created a class Complex to do Complex operators. Inside the Complex class I made a method add which uses two Complex class parameters. But when I create two instances in main() and then try to add them.\r\n```\r\npublic class ComplexNo {\r\n    public static void main(String[] args){\r\n        Complex c1=new Complex(1,1);\r\n        Complex c2=new Complex(2,3);\r\n        Complex cAdd=Complex.add(c1,c2);\r\n    }\r\n}\r\nclass Complex{\r\n    float real; float imag;\r\n    Complex(float a, float b){\r\n        real = a;\r\n        imag = b;\r\n    }\r\n    Complex add(Complex a, Complex b){\r\n        return new Complex(a.real+b.real, a.imag+b.imag);\r\n    }\r\n}\r\n```\r\nIt shows the error &quot;Non-static method &#39;add(Complex, Complex)&#39; cannot be referenced from a static context&quot;. It is corrected by adding static keyword. How does it help?","title":"Use of static keyword for methods to call them in main()","body":"<p>I created a class Complex to do Complex operators. Inside the Complex class I made a method add which uses two Complex class parameters. But when I create two instances in main() and then try to add them.</p>\n<pre><code>public class ComplexNo {\n    public static void main(String[] args){\n        Complex c1=new Complex(1,1);\n        Complex c2=new Complex(2,3);\n        Complex cAdd=Complex.add(c1,c2);\n    }\n}\nclass Complex{\n    float real; float imag;\n    Complex(float a, float b){\n        real = a;\n        imag = b;\n    }\n    Complex add(Complex a, Complex b){\n        return new Complex(a.real+b.real, a.imag+b.imag);\n    }\n}\n</code></pre>\n<p>It shows the error &quot;Non-static method 'add(Complex, Complex)' cannot be referenced from a static context&quot;. It is corrected by adding static keyword. How does it help?</p>\n"},{"tags":["java","dropwizard"],"comments":[{"owner":{"account_id":5404,"reputation":22089,"user_id":8681,"accept_rate":67,"display_name":"Jorn"},"score":0,"creation_date":1686642327,"post_id":76462671,"comment_id":134823182,"body_markdown":"Dropwizard uses Jackson, right? You should be able to add a custom deserializer: https://stackoverflow.com/a/19167145/8681","body":"Dropwizard uses Jackson, right? You should be able to add a custom deserializer: <a href=\"https://stackoverflow.com/a/19167145/8681\">stackoverflow.com/a/19167145/8681</a>"},{"owner":{"account_id":10543957,"reputation":21,"user_id":7768885,"display_name":"Hani"},"score":0,"creation_date":1686677016,"post_id":76462671,"comment_id":134831004,"body_markdown":"that&#39;s a good start, but the problem is that MyObject is a class in a library i dont own","body":"that&#39;s a good start, but the problem is that MyObject is a class in a library i dont own"}],"answers":[{"tags":[],"owner":{"account_id":29064427,"reputation":11,"user_id":22264366,"display_name":"snowy"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689949437,"creation_date":1689949437,"answer_id":76738841,"question_id":76462671,"body_markdown":"There are a couple of different ways you might want to consider when approaching:\r\n\r\n(1) Use an enumeration in the configuration and then provide a mapping to the `MyObject` class which controls the instantiation of the fields driven by the country. This will make it clear which countries are supported (and for which you have mappings).\r\n\r\n```\r\npublic class MyConfig extends Configuration {\r\n\r\n    enum Country {\r\n        USA;\r\n\r\n        MyObject toObject() {\r\n            switch (this) {\r\n                case USA:\r\n                    return new MyObject(&quot;+1&quot;, &quot;North America&quot;...);\r\n            }\r\n            ...\r\n        }\r\n    }\r\n    \r\n    public Country country;\r\n}\r\n```\r\n\r\n\r\n(2) Register a custom deserialiser. Even if you don&#39;t own the `MyObject` class you will still be able to register a custom deserialiser either directly on the `ObjectMapper` or by using the `JsonDeserializer(using = MyObjectDeserializer)` annotation on the field in your application configuration (rather than on the `MyObject` class declaration which as you say - is not editable by you) - example:\r\n  \r\n```\r\npublic class MyConfig extends Configuration {\r\n\r\n    @JsonDeserialize(using = MyObjectDeserializer.class)\r\n    public MyObject country;\r\n}\r\n  ```\r\n\r\n\r\n","title":"Dropwizard conf file automatically convert value to custom object","body":"<p>There are a couple of different ways you might want to consider when approaching:</p>\n<p>(1) Use an enumeration in the configuration and then provide a mapping to the <code>MyObject</code> class which controls the instantiation of the fields driven by the country. This will make it clear which countries are supported (and for which you have mappings).</p>\n<pre><code>public class MyConfig extends Configuration {\n\n    enum Country {\n        USA;\n\n        MyObject toObject() {\n            switch (this) {\n                case USA:\n                    return new MyObject(&quot;+1&quot;, &quot;North America&quot;...);\n            }\n            ...\n        }\n    }\n    \n    public Country country;\n}\n</code></pre>\n<p>(2) Register a custom deserialiser. Even if you don't own the <code>MyObject</code> class you will still be able to register a custom deserialiser either directly on the <code>ObjectMapper</code> or by using the <code>JsonDeserializer(using = MyObjectDeserializer)</code> annotation on the field in your application configuration (rather than on the <code>MyObject</code> class declaration which as you say - is not editable by you) - example:</p>\n<pre><code>public class MyConfig extends Configuration {\n\n    @JsonDeserialize(using = MyObjectDeserializer.class)\n    public MyObject country;\n}\n</code></pre>\n"}],"owner":{"account_id":10543957,"reputation":21,"user_id":7768885,"display_name":"Hani"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":43,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689949437,"creation_date":1686642070,"question_id":76462671,"body_markdown":"I have a dropwizard application that parses conf files to construct the application&#39;s configuration.\r\n\r\nbase.conf file has:\r\n\r\n    country: USA\r\n\r\nin the configuration java file:\r\n\r\n    @NotNull\r\n    private MyObject country;\r\n\r\nMyObject is not an enum in this case. It is a regular object.\r\n\r\nHow can I configure it to have dropwizard automatically convert the parsed string value to MyObject based on some logic I define, like:\r\n\r\n    MyObject convertStringToMyObject(String value) {\r\n        if (value.equals(&quot;USA&quot;) {\r\n            return new MyObject(&quot;+1&quot;, &quot;North America&quot;, &quot;USA&quot;);\r\n        }\r\n    }\r\n\r\nThis is obviously just the simplest dumb sample I could think of for what I&#39;m trying to achieve.","title":"Dropwizard conf file automatically convert value to custom object","body":"<p>I have a dropwizard application that parses conf files to construct the application's configuration.</p>\n<p>base.conf file has:</p>\n<pre><code>country: USA\n</code></pre>\n<p>in the configuration java file:</p>\n<pre><code>@NotNull\nprivate MyObject country;\n</code></pre>\n<p>MyObject is not an enum in this case. It is a regular object.</p>\n<p>How can I configure it to have dropwizard automatically convert the parsed string value to MyObject based on some logic I define, like:</p>\n<pre><code>MyObject convertStringToMyObject(String value) {\n    if (value.equals(&quot;USA&quot;) {\n        return new MyObject(&quot;+1&quot;, &quot;North America&quot;, &quot;USA&quot;);\n    }\n}\n</code></pre>\n<p>This is obviously just the simplest dumb sample I could think of for what I'm trying to achieve.</p>\n"},{"tags":["java","rabbitmq","messagebroker","rabbitmq-exchange"],"comments":[{"owner":{"account_id":1581534,"reputation":9020,"user_id":1466825,"display_name":"Luke Bakken"},"score":0,"creation_date":1673886560,"post_id":75112978,"comment_id":132592104,"body_markdown":"Version 4.x.x of the Java client is out-of-date and no longer supported. The current version supports automatic consumer recovery.","body":"Version 4.x.x of the Java client is out-of-date and no longer supported. The current version supports automatic consumer recovery."},{"owner":{"account_id":24136324,"reputation":23,"user_id":18103179,"display_name":"fa gsc"},"score":0,"creation_date":1673886889,"post_id":75112978,"comment_id":132592226,"body_markdown":"Automatic recovery isn&#39;t triggered in all cases though? Also, this should be 5.5.3. Its only the api link that happens to be 4.x.x","body":"Automatic recovery isn&#39;t triggered in all cases though? Also, this should be 5.5.3. Its only the api link that happens to be 4.x.x"},{"owner":{"account_id":1581534,"reputation":9020,"user_id":1466825,"display_name":"Luke Bakken"},"score":0,"creation_date":1673969792,"post_id":75112978,"comment_id":132612407,"body_markdown":"Thanks for clarifying. I can ask the maintainer of the Java client to assist us if you ask your question [here](https://github.com/rabbitmq/rabbitmq-java-client/discussions). Please provide as much code as possible, ideally something we can compile and run.","body":"Thanks for clarifying. I can ask the maintainer of the Java client to assist us if you ask your question <a href=\"https://github.com/rabbitmq/rabbitmq-java-client/discussions\" rel=\"nofollow noreferrer\">here</a>. Please provide as much code as possible, ideally something we can compile and run."}],"answers":[{"tags":[],"owner":{"account_id":4898046,"reputation":1463,"user_id":3946976,"accept_rate":90,"display_name":"Erick Boshoff"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689949299,"creation_date":1689949299,"answer_id":76738828,"question_id":75112978,"body_markdown":"I know this might be a late answer, but I&#39;ve found an easy way is to keep the consumer connected to the rabbitmq broker and just drop my internet connection manually for a few seconds and reconnect.\r\n\r\nAfter that the `shudown handler` is triggered. ","title":"How to trigger rabbit mq shutdown signal for testing?","body":"<p>I know this might be a late answer, but I've found an easy way is to keep the consumer connected to the rabbitmq broker and just drop my internet connection manually for a few seconds and reconnect.</p>\n<p>After that the <code>shudown handler</code> is triggered.</p>\n"}],"owner":{"account_id":24136324,"reputation":23,"user_id":18103179,"display_name":"fa gsc"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":174,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689949299,"creation_date":1673633329,"question_id":75112978,"body_markdown":"Faced an issue on prod system where 1 message was left unacked for 30 mins which lead to consumer being shutdown. Now I have added shutdownlisteners as described in rabbit mq docs -\r\nhttps://rabbitmq.github.io/rabbitmq-java-client/api/4.x.x/com/rabbitmq/client/ShutdownListener.html\r\n\r\n```channel.addShutdownListener(cause -&gt; {\r\n                if (cause.isHardError()) {\r\n                    log.error(&quot;Connection error with cause : {}&quot;, cause);\r\n                    Connection conn = (Connection) cause.getReference();\r\n                    if (!cause.isInitiatedByApplication()) {\r\n                        Method reason = cause.getReason();\r\n                        log.error(&quot;Rabbit Mq Consumer Connection Shutdown : {} {}&quot;, reason, cause);\r\n                    }\r\n                } else{\r\n                    Channel ch = (Channel)cause.getReference();\r\n                    log.error(&quot;Channel error details : {}&quot;, ch);\r\n                }\r\n            });\r\n```\r\nThe issue is it&#39;s not getting invoked at all in testing. I tried triggering it through 2 ways-\r\n1) Through unacked delivery timeout. Basically threw a general excption and never acked it(these were the original conditions of the bug). However, this didn&#39;t work.\r\n2) I used channel.close() to shutdown the consumer but still didn&#39;t receive an event.\r\n\r\nLooking for any way to replicate the issue I faced and test/trigger the shutdownlisteners. Thanks","title":"How to trigger rabbit mq shutdown signal for testing?","body":"<p>Faced an issue on prod system where 1 message was left unacked for 30 mins which lead to consumer being shutdown. Now I have added shutdownlisteners as described in rabbit mq docs -\n<a href=\"https://rabbitmq.github.io/rabbitmq-java-client/api/4.x.x/com/rabbitmq/client/ShutdownListener.html\" rel=\"nofollow noreferrer\">https://rabbitmq.github.io/rabbitmq-java-client/api/4.x.x/com/rabbitmq/client/ShutdownListener.html</a></p>\n<pre><code>                if (cause.isHardError()) {\n                    log.error(&quot;Connection error with cause : {}&quot;, cause);\n                    Connection conn = (Connection) cause.getReference();\n                    if (!cause.isInitiatedByApplication()) {\n                        Method reason = cause.getReason();\n                        log.error(&quot;Rabbit Mq Consumer Connection Shutdown : {} {}&quot;, reason, cause);\n                    }\n                } else{\n                    Channel ch = (Channel)cause.getReference();\n                    log.error(&quot;Channel error details : {}&quot;, ch);\n                }\n            });\n</code></pre>\n<p>The issue is it's not getting invoked at all in testing. I tried triggering it through 2 ways-</p>\n<ol>\n<li>Through unacked delivery timeout. Basically threw a general excption and never acked it(these were the original conditions of the bug). However, this didn't work.</li>\n<li>I used channel.close() to shutdown the consumer but still didn't receive an event.</li>\n</ol>\n<p>Looking for any way to replicate the issue I faced and test/trigger the shutdownlisteners. Thanks</p>\n"},{"tags":["java","exception","ssh","io","jsch"],"answers":[{"tags":[],"owner":{"account_id":2449170,"reputation":1315,"user_id":2135838,"display_name":"Sascha"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689948996,"creation_date":1689667471,"answer_id":76710675,"question_id":76622161,"body_markdown":"##### 1. You can separate a channel from a session, so it&#39;s safer to explicit close the channel\r\n\r\n```\r\nSession session = null;\r\nChannelExec channel = null;\r\nSession session2 = null;\r\nChannelExec2 channel = null;\r\n\r\ntry {\r\n  session = new JSch().getSession(username, host, port);\r\n  ...\r\n  channel = (ChannelExec) session.openChannel(&quot;exec&quot;);\r\n  ...\r\n  session2 = new JSch().getSession(username, host, port);\r\n  channel.setSession(session2);\r\n  ...\r\n} finally {\r\n  if (session != null) {\r\n\tsession.disconnect();\r\n  }\r\n  if (channel != null) {\r\n\tchannel.disconnect();\r\n  }\r\n}\r\ntry {\r\n  channel2 = (ChannelExec) session.openChannel(&quot;exec&quot;);\r\n  ...\r\n} finally {\r\n  if (session2 != null) {\r\n\tsession2.disconnect();\r\n  }\r\n  if (channel2 != null) {\r\n\tchannel2.disconnect();\r\n  }\r\n}\r\n```\r\n##### 2. `disconnect` calls [close][1], which may throw an `IOException`.  \r\nSo to be safe, you should handle this case.\r\n\r\n```\r\nSession session = null;\r\nChannelExec channel = null;\r\ntry {\r\n  session = new JSch().getSession(username, host, port);\r\n  ...\r\n  channel = (ChannelExec) session.openChannel(&quot;exec&quot;);\r\n  ...\r\n} catch(Exception ex) {\r\n  ex.printStacktrace();\r\n} finally {\r\n  try {\r\n    if (session != null) {\r\n      session.disconnect();\r\n    }\r\n  } catch(Exception e1) {\r\n    e1.printStackTrace();\r\n  }\r\n  try {\r\n    if (channel != null) {\r\n     channel.disconnect();\r\n    }\r\n  } catch(Exception e2) {\r\n    e2.printStacktrace();\r\n  }\r\n}\r\n```\r\n##### 3. Examples are often simplified to focus on a use case. So don&#39;t take everything in them as gospel.\r\n\r\n\r\n  [1]: https://github.com/rtyley/jsch/blob/master/src/com/jcraft/jsch/Channel.java#L341","title":"How to handle resources in JSCH exec correctly?","body":"<h5>1. You can separate a channel from a session, so it's safer to explicit close the channel</h5>\n<pre><code>Session session = null;\nChannelExec channel = null;\nSession session2 = null;\nChannelExec2 channel = null;\n\ntry {\n  session = new JSch().getSession(username, host, port);\n  ...\n  channel = (ChannelExec) session.openChannel(&quot;exec&quot;);\n  ...\n  session2 = new JSch().getSession(username, host, port);\n  channel.setSession(session2);\n  ...\n} finally {\n  if (session != null) {\n    session.disconnect();\n  }\n  if (channel != null) {\n    channel.disconnect();\n  }\n}\ntry {\n  channel2 = (ChannelExec) session.openChannel(&quot;exec&quot;);\n  ...\n} finally {\n  if (session2 != null) {\n    session2.disconnect();\n  }\n  if (channel2 != null) {\n    channel2.disconnect();\n  }\n}\n</code></pre>\n<h5>2. <code>disconnect</code> calls <a href=\"https://github.com/rtyley/jsch/blob/master/src/com/jcraft/jsch/Channel.java#L341\" rel=\"nofollow noreferrer\">close</a>, which may throw an <code>IOException</code>.</h5>\n<p>So to be safe, you should handle this case.</p>\n<pre><code>Session session = null;\nChannelExec channel = null;\ntry {\n  session = new JSch().getSession(username, host, port);\n  ...\n  channel = (ChannelExec) session.openChannel(&quot;exec&quot;);\n  ...\n} catch(Exception ex) {\n  ex.printStacktrace();\n} finally {\n  try {\n    if (session != null) {\n      session.disconnect();\n    }\n  } catch(Exception e1) {\n    e1.printStackTrace();\n  }\n  try {\n    if (channel != null) {\n     channel.disconnect();\n    }\n  } catch(Exception e2) {\n    e2.printStacktrace();\n  }\n}\n</code></pre>\n<h5>3. Examples are often simplified to focus on a use case. So don't take everything in them as gospel.</h5>\n"}],"owner":{"account_id":3163862,"reputation":36940,"user_id":2674303,"accept_rate":62,"display_name":"gstackoverflow"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":94,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689948996,"creation_date":1688573390,"question_id":76622161,"body_markdown":"\r\nI&#39;ve found [example][1] of ssh connection:\r\n\r\n     public static void listFolderStructure(String username, String password, \r\n          String host, int port, String command) throws Exception {\r\n            \r\n            Session session = null;\r\n            ChannelExec channel = null;\r\n            \r\n            try {\r\n                session = new JSch().getSession(username, host, port);\r\n                session.setPassword(password);\r\n                session.setConfig(&quot;StrictHostKeyChecking&quot;, &quot;no&quot;);\r\n                session.connect();\r\n                \r\n                channel = (ChannelExec) session.openChannel(&quot;exec&quot;);\r\n                channel.setCommand(command);\r\n                ByteArrayOutputStream responseStream = new ByteArrayOutputStream();\r\n                channel.setOutputStream(responseStream);\r\n                channel.connect();\r\n                \r\n                while (channel.isConnected()) {\r\n                    Thread.sleep(100);\r\n                }\r\n                \r\n                String responseString = new String(responseStream.toByteArray());\r\n                System.out.println(responseString);\r\n            } finally {\r\n                if (session != null) {\r\n                    session.disconnect();\r\n                }\r\n                if (channel != null) {\r\n                    channel.disconnect();\r\n                }\r\n            }\r\n        }\r\n\r\nI have couple of questions about the code:\r\n\r\n 1. Is there any reason to call `disconnect` on a channel after seesion is disconnected ?\r\n looks like [this line][2] will disconnect all channels \r\n\r\n\r\n```\r\n    public void disconnect(){\r\n        if(!isConnected) return;\r\n    \r\n        ...\r\n        Channel.disconnect(this);\r\n    \r\n        ...\r\n    \r\n ```\r\n\r\n 2. Should `session.disconnect()` throw any Runtime Exception ? Should I handle this case ?\r\n\r\n\r\n 3. Example in lib repo also have both(session and channel close) and even not in finally block. Is it correct ?\r\n\r\n https://github.com/rtyley/jsch/blob/master/examples/Exec.java#L77\r\n\r\n  [1]: https://www.baeldung.com/java-ssh-connection#1-implementation\r\n  [2]: https://github.com/rtyley/jsch/blob/master/src/com/jcraft/jsch/Session.java#L1564","title":"How to handle resources in JSCH exec correctly?","body":"<p>I've found <a href=\"https://www.baeldung.com/java-ssh-connection#1-implementation\" rel=\"nofollow noreferrer\">example</a> of ssh connection:</p>\n<pre><code> public static void listFolderStructure(String username, String password, \n      String host, int port, String command) throws Exception {\n        \n        Session session = null;\n        ChannelExec channel = null;\n        \n        try {\n            session = new JSch().getSession(username, host, port);\n            session.setPassword(password);\n            session.setConfig(&quot;StrictHostKeyChecking&quot;, &quot;no&quot;);\n            session.connect();\n            \n            channel = (ChannelExec) session.openChannel(&quot;exec&quot;);\n            channel.setCommand(command);\n            ByteArrayOutputStream responseStream = new ByteArrayOutputStream();\n            channel.setOutputStream(responseStream);\n            channel.connect();\n            \n            while (channel.isConnected()) {\n                Thread.sleep(100);\n            }\n            \n            String responseString = new String(responseStream.toByteArray());\n            System.out.println(responseString);\n        } finally {\n            if (session != null) {\n                session.disconnect();\n            }\n            if (channel != null) {\n                channel.disconnect();\n            }\n        }\n    }\n</code></pre>\n<p>I have couple of questions about the code:</p>\n<ol>\n<li>Is there any reason to call <code>disconnect</code> on a channel after seesion is disconnected ?\nlooks like <a href=\"https://github.com/rtyley/jsch/blob/master/src/com/jcraft/jsch/Session.java#L1564\" rel=\"nofollow noreferrer\">this line</a> will disconnect all channels</li>\n</ol>\n<pre><code>    public void disconnect(){\n        if(!isConnected) return;\n    \n        ...\n        Channel.disconnect(this);\n    \n        ...\n    \n</code></pre>\n<ol start=\"2\">\n<li><p>Should <code>session.disconnect()</code> throw any Runtime Exception ? Should I handle this case ?</p>\n</li>\n<li><p>Example in lib repo also have both(session and channel close) and even not in finally block. Is it correct ?</p>\n</li>\n</ol>\n<p><a href=\"https://github.com/rtyley/jsch/blob/master/examples/Exec.java#L77\" rel=\"nofollow noreferrer\">https://github.com/rtyley/jsch/blob/master/examples/Exec.java#L77</a></p>\n"},{"tags":["java","java-stream"],"comments":[{"owner":{"account_id":6520,"reputation":10523,"user_id":11002,"accept_rate":75,"display_name":"tgdavies"},"score":3,"creation_date":1689944638,"post_id":76738264,"comment_id":135288537,"body_markdown":"Use a for loop.","body":"Use a for loop."},{"owner":{"account_id":1992310,"reputation":11172,"user_id":1786065,"accept_rate":91,"display_name":"Rogue"},"score":0,"creation_date":1689948194,"post_id":76738264,"comment_id":135289284,"body_markdown":"`consumers.forEach(c -&gt; c.accept(myvalue));` would do it. No streams, loop is tucked away.","body":"<code>consumers.forEach(c -&gt; c.accept(myvalue));</code> would do it. No streams, loop is tucked away."}],"answers":[{"tags":[],"owner":{"account_id":27668746,"reputation":233,"user_id":21120027,"display_name":"Dulan Jayawickrama"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1689948962,"creation_date":1689944935,"answer_id":76738305,"question_id":76738264,"body_markdown":"Loop through the list and apply each consumer to myValue.\r\n\r\n```java\r\nfor (Consumer&lt;MyObject&gt; consumer : consumerList) {\r\n    consumer.accept(myValue);\r\n}\r\n```","title":"Execute Consumers in a row","body":"<p>Loop through the list and apply each consumer to myValue.</p>\n<pre class=\"lang-java prettyprint-override\"><code>for (Consumer&lt;MyObject&gt; consumer : consumerList) {\n    consumer.accept(myValue);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":238684,"reputation":22543,"user_id":507738,"accept_rate":71,"display_name":"MC Emperor"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689946786,"creation_date":1689946786,"answer_id":76738515,"question_id":76738264,"body_markdown":"You could also use `Stream::reduce` to build a composed `Consumer`:\r\n\r\n```java\r\nconsumerList.stream()\r\n    .reduce(Consumer::andThen)\r\n    .ifPresent(consumer -&gt; consumer.accept(myValue));\r\n```\r\n","title":"Execute Consumers in a row","body":"<p>You could also use <code>Stream::reduce</code> to build a composed <code>Consumer</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>consumerList.stream()\n    .reduce(Consumer::andThen)\n    .ifPresent(consumer -&gt; consumer.accept(myValue));\n</code></pre>\n"}],"owner":{"account_id":9213198,"reputation":97,"user_id":15110545,"display_name":"user15110545"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":79,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":76738305,"answer_count":2,"score":0,"last_activity_date":1689948962,"creation_date":1689944598,"question_id":76738264,"body_markdown":"I have a couple of `Consumer&lt;MyObject&gt;` classes I want to execute in sequence. I know I can do this with `myConsumer1.andThen(myConsumer2).accept(myvalue)`. How can I do this if I have a `List&lt;Consumer&lt;MyObject&gt;&gt;` and the number of consumers is unknown?\r\n\r\nHere is a for-loop solution that I think is not concise:\r\n\r\n```java\r\nConsumer&lt;MyObject&gt; result;\r\nfor (Consumer&lt;MyObject&gt; consumer : consumers) {\r\n    if(result == null) {\r\n        result = consumer;\r\n    } else {\r\n        result.andThen(consumer);\r\n    }\r\n}\r\nresult.apply(myvalue);\r\n```","title":"Execute Consumers in a row","body":"<p>I have a couple of <code>Consumer&lt;MyObject&gt;</code> classes I want to execute in sequence. I know I can do this with <code>myConsumer1.andThen(myConsumer2).accept(myvalue)</code>. How can I do this if I have a <code>List&lt;Consumer&lt;MyObject&gt;&gt;</code> and the number of consumers is unknown?</p>\n<p>Here is a for-loop solution that I think is not concise:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Consumer&lt;MyObject&gt; result;\nfor (Consumer&lt;MyObject&gt; consumer : consumers) {\n    if(result == null) {\n        result = consumer;\n    } else {\n        result.andThen(consumer);\n    }\n}\nresult.apply(myvalue);\n</code></pre>\n"},{"tags":["java","unit-testing","jmockit"],"owner":{"account_id":3686002,"reputation":531,"user_id":3069750,"accept_rate":64,"display_name":"Neuromante"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":16,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689948902,"creation_date":1689948564,"question_id":76738737,"body_markdown":"I have this setup:\r\n\r\n    @Tested\r\n    private ClassUnderTest classUnderTest;\r\n\r\n    @Mocked\r\n    private MockedType1 mockedType1;\r\n\r\n    @Mocked\r\n    private MockedType2 mockedType2;\r\n\r\n    public class CustomExpectations extends Expectations {\r\n    \r\n        public CustomExpectations() {\r\n            mockedType1.function1();\r\n            result = result1;\r\n            \r\n            result1.function2();\r\n            result = mockedType2;\r\n\r\n            mockedType2.functionMockedType2();\r\n            result = result2;\r\n        }\r\n    }\r\n\r\nThen, I have some tests that use this CustomExpectations class to do some setup, and then a more generic inline expectation with the rest of the code covered. The issue I&#39;m finding is that, when the expectation \r\n\r\n            mockedType2.functionMockedType2();\r\n            result = result2;\r\n\r\nis on the CustomExpectations class, the function call always returns null. If I move that expectation to the inline expectation, it works fine.\r\n\r\nIt is possible to do what I&#39;m trying to do? I&#39;ve tried to pass mockedType2 as a parameters to the CustomExpectations, but it still returns null.","title":"JMockit: Special cases for reusing expectations","body":"<p>I have this setup:</p>\n<pre><code>@Tested\nprivate ClassUnderTest classUnderTest;\n\n@Mocked\nprivate MockedType1 mockedType1;\n\n@Mocked\nprivate MockedType2 mockedType2;\n\npublic class CustomExpectations extends Expectations {\n\n    public CustomExpectations() {\n        mockedType1.function1();\n        result = result1;\n        \n        result1.function2();\n        result = mockedType2;\n\n        mockedType2.functionMockedType2();\n        result = result2;\n    }\n}\n</code></pre>\n<p>Then, I have some tests that use this CustomExpectations class to do some setup, and then a more generic inline expectation with the rest of the code covered. The issue I'm finding is that, when the expectation</p>\n<pre><code>        mockedType2.functionMockedType2();\n        result = result2;\n</code></pre>\n<p>is on the CustomExpectations class, the function call always returns null. If I move that expectation to the inline expectation, it works fine.</p>\n<p>It is possible to do what I'm trying to do? I've tried to pass mockedType2 as a parameters to the CustomExpectations, but it still returns null.</p>\n"},{"tags":["java","spring-boot","graalvm"],"comments":[{"owner":{"account_id":58650,"reputation":3399,"user_id":175554,"accept_rate":40,"display_name":"ozkanpakdil"},"score":0,"creation_date":1681666027,"post_id":76026874,"comment_id":134089684,"body_markdown":"delete maven-jar-plugin which is not required for spring nor graalvm.","body":"delete maven-jar-plugin which is not required for spring nor graalvm."}],"answers":[{"tags":[],"owner":{"account_id":14446626,"reputation":2578,"user_id":10435528,"display_name":"devatherock"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689948686,"creation_date":1689948686,"answer_id":76738750,"question_id":76026874,"body_markdown":"The error you are seeing is due to the fact that the executable fat jar generated by the `spring-boot` maven plugin doesn&#39;t have the main class in the path `com/example/Main`. The class ends up being located inside `BOOT-INF/classes/com/example/Main` which gets loaded using spring-boot&#39;s own main class `org.springframework.boot.loader.JarLauncher`. Instead of using the spring boot plugin to generate the fat jar, you can use the `maven-shade` plugin in which case the main class would be present in the expected path.\r\n\r\n**Shade plugin usage:**\r\n\r\n```xml\r\n    &lt;plugin&gt;\r\n        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n        &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\r\n        &lt;version&gt;3.5.0&lt;/version&gt;\r\n        &lt;executions&gt;\r\n            &lt;execution&gt;\r\n                &lt;phase&gt;package&lt;/phase&gt;\r\n                &lt;goals&gt;\r\n                    &lt;goal&gt;shade&lt;/goal&gt;\r\n                &lt;/goals&gt;\r\n            &lt;/execution&gt;\r\n        &lt;/executions&gt;\r\n    &lt;/plugin&gt;\r\n```\r\n\r\nAfter using the shade plugin, instead of the spring-boot plugin, I didn&#39;t get this error and I was able to generate the native image successfully with a command like below:\r\n\r\n```\r\nnative-image --no-fallback -J-Xmx3072m -H:Name=springbootdemo -cp target/spring-boot-demo-0.0.1-SNAPSHOT.jar io.github.devatherock.Application\r\n```\r\n\r\nThe generated native image did run into an exception when executing, but that is probably related to missing reflection config. You can find the sample application on [github](https://github.com/devatherock/spring-boot-demo/tree/maven-graal)","title":"GraalVM Error: Main entry point class &#39;org.example.Main&#39; neither found on the classpath","body":"<p>The error you are seeing is due to the fact that the executable fat jar generated by the <code>spring-boot</code> maven plugin doesn't have the main class in the path <code>com/example/Main</code>. The class ends up being located inside <code>BOOT-INF/classes/com/example/Main</code> which gets loaded using spring-boot's own main class <code>org.springframework.boot.loader.JarLauncher</code>. Instead of using the spring boot plugin to generate the fat jar, you can use the <code>maven-shade</code> plugin in which case the main class would be present in the expected path.</p>\n<p><strong>Shade plugin usage:</strong></p>\n<pre class=\"lang-xml prettyprint-override\"><code>    &lt;plugin&gt;\n        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n        &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n        &lt;version&gt;3.5.0&lt;/version&gt;\n        &lt;executions&gt;\n            &lt;execution&gt;\n                &lt;phase&gt;package&lt;/phase&gt;\n                &lt;goals&gt;\n                    &lt;goal&gt;shade&lt;/goal&gt;\n                &lt;/goals&gt;\n            &lt;/execution&gt;\n        &lt;/executions&gt;\n    &lt;/plugin&gt;\n</code></pre>\n<p>After using the shade plugin, instead of the spring-boot plugin, I didn't get this error and I was able to generate the native image successfully with a command like below:</p>\n<pre><code>native-image --no-fallback -J-Xmx3072m -H:Name=springbootdemo -cp target/spring-boot-demo-0.0.1-SNAPSHOT.jar io.github.devatherock.Application\n</code></pre>\n<p>The generated native image did run into an exception when executing, but that is probably related to missing reflection config. You can find the sample application on <a href=\"https://github.com/devatherock/spring-boot-demo/tree/maven-graal\" rel=\"nofollow noreferrer\">github</a></p>\n"}],"owner":{"account_id":28287609,"reputation":21,"user_id":21628283,"display_name":"Andrey Picasso"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1556,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1689948686,"creation_date":1681636738,"question_id":76026874,"body_markdown":"I have a problem. I want to build a native -image Jar file, for this I write this command\r\n```\r\nnative-image --no-server -cp C:\\Users\\Andrey\\IdeaProjects\\example\\target\\example-0.0.1-SNAPSHOT.jar org.example.Main\r\n```\r\nI am writing all this in the program &quot;x64 NATIVE Tools Command Prompt for VS 2022&quot;. It is running on behalf of my administrator. After entering the command, I get the error:\r\n```\r\n========================================================================================================================\r\nGraalVM Native Image: Generating &#39;org.example.main&#39; (executable)...\r\n========================================================================================================================\r\n[1/7] Initializing...                                                                                    (0,0s @ 0,13GB)\r\nError: Main entry point class &#39;org.example.Main&#39; neither found on the classpath nor on the modulepath.\r\nclasspath: &#39;C:\\Users\\Andrey\\IdeaProjects\\example\\target\\example-0.0.1-SNAPSHOT.jar&#39;\r\nmodulepath: &#39;C:\\Program Files (x86)\\graalvm-ce-java17-22.3.1\\lib\\svm\\library-support.jar&#39;\r\nError: Use -H:+ReportExceptionStackTraces to print stacktrace of underlying exception\r\nError: Image build request failed with exit status 1\r\n```\r\nBut my directories look like this:\r\n[enter image description here](https://i.stack.imgur.com/QavbI.png)\r\n\r\nHelp me please. Ordinary non-SPRING applications are quietly building\r\nMy pom.xml\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n\txsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\t&lt;parent&gt;\r\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;3.0.5&lt;/version&gt;\r\n\t\t&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\r\n\t&lt;/parent&gt;\r\n\t&lt;groupId&gt;org&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;example&lt;/artifactId&gt;\r\n\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n\t&lt;name&gt;example&lt;/name&gt;\r\n\t&lt;description&gt;example&lt;/description&gt;\r\n\t&lt;properties&gt;\r\n\t\t&lt;java.version&gt;17&lt;/java.version&gt;\r\n\t\t&lt;start-class&gt;org.example.Main&lt;/start-class&gt;\r\n\t&lt;/properties&gt;\r\n\t&lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t\t&lt;optional&gt;true&lt;/optional&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t&lt;/dependencies&gt;\r\n\r\n\t&lt;build&gt;\r\n\t\t&lt;plugins&gt;\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\r\n\t\t\t\t&lt;version&gt;3.2.0&lt;/version&gt;\r\n\t\t\t\t&lt;configuration&gt;\r\n\t\t\t\t\t&lt;archive&gt;\r\n\t\t\t\t\t\t&lt;manifest&gt;\r\n\t\t\t\t\t\t\t&lt;mainClass&gt;org.example.Main&lt;/mainClass&gt;\r\n\t\t\t\t\t\t&lt;/manifest&gt;\r\n\t\t\t\t\t&lt;/archive&gt;\r\n\t\t\t\t&lt;/configuration&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\r\n\t\t&lt;/plugins&gt;\r\n\t&lt;/build&gt;\r\n\r\n&lt;/project&gt;\r\n```\r\njava - version:\r\n```\r\nopenjdk version &quot;17.0.6&quot; 2023-01-17\r\nOpenJDK Runtime Environment GraalVM CE 22.3.1 (build 17.0.6+10-jvmci-22.3-b13)\r\nOpenJDK 64-Bit Server VM GraalVM CE 22.3.1 (build 17.0.6+10-jvmci-22.3-b13, mixed mode, sharing)\r\n```\r\n\r\n\r\n","title":"GraalVM Error: Main entry point class &#39;org.example.Main&#39; neither found on the classpath","body":"<p>I have a problem. I want to build a native -image Jar file, for this I write this command</p>\n<pre><code>native-image --no-server -cp C:\\Users\\Andrey\\IdeaProjects\\example\\target\\example-0.0.1-SNAPSHOT.jar org.example.Main\n</code></pre>\n<p>I am writing all this in the program &quot;x64 NATIVE Tools Command Prompt for VS 2022&quot;. It is running on behalf of my administrator. After entering the command, I get the error:</p>\n<pre><code>========================================================================================================================\nGraalVM Native Image: Generating 'org.example.main' (executable)...\n========================================================================================================================\n[1/7] Initializing...                                                                                    (0,0s @ 0,13GB)\nError: Main entry point class 'org.example.Main' neither found on the classpath nor on the modulepath.\nclasspath: 'C:\\Users\\Andrey\\IdeaProjects\\example\\target\\example-0.0.1-SNAPSHOT.jar'\nmodulepath: 'C:\\Program Files (x86)\\graalvm-ce-java17-22.3.1\\lib\\svm\\library-support.jar'\nError: Use -H:+ReportExceptionStackTraces to print stacktrace of underlying exception\nError: Image build request failed with exit status 1\n</code></pre>\n<p>But my directories look like this:\n<a href=\"https://i.stack.imgur.com/QavbI.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n<p>Help me please. Ordinary non-SPRING applications are quietly building\nMy pom.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.0.5&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;org&lt;/groupId&gt;\n    &lt;artifactId&gt;example&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;example&lt;/name&gt;\n    &lt;description&gt;example&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n        &lt;start-class&gt;org.example.Main&lt;/start-class&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;\n                &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.2.0&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;archive&gt;\n                        &lt;manifest&gt;\n                            &lt;mainClass&gt;org.example.Main&lt;/mainClass&gt;\n                        &lt;/manifest&gt;\n                    &lt;/archive&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p>java - version:</p>\n<pre><code>openjdk version &quot;17.0.6&quot; 2023-01-17\nOpenJDK Runtime Environment GraalVM CE 22.3.1 (build 17.0.6+10-jvmci-22.3-b13)\nOpenJDK 64-Bit Server VM GraalVM CE 22.3.1 (build 17.0.6+10-jvmci-22.3-b13, mixed mode, sharing)\n</code></pre>\n"},{"tags":["java","google-cloud-platform","google-bigquery"],"answers":[{"tags":[],"owner":{"account_id":25595958,"reputation":1,"user_id":19371728,"display_name":"Poala Astrid"},"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1689892357,"creation_date":1689892357,"answer_id":76734095,"question_id":76677737,"body_markdown":"The issue you are encountering with duplicate and missing rows when reading data from BigQuery using TableResult.iterateAll() is likely related to the way pagination is handled and how the query results are ordered. As you mentioned that you get the correct total number of rows, it indicates that the issue is not with the query itself but likely with the pagination.\n\n`TableResult.iterateAll()` internally handles pagination to retrieve all the rows from the query results. When the result set is large, BigQuery may split the results into **multiple pages**. As you iterate through these pages, it&#39;s possible for some rows to appear more than once or be skipped altogether if there are overlapping pages or if the pagination mechanism encounters any issues.\n\nYou can also modify your query to include an `ORDER BY` clause based on a unique identifier or a stable column in your dataset. This will ensure consistent ordering of the results and may help eliminate the issue of duplicates. Using explicit ordering in your query should provide a more consistent and reliable result.\n","title":"BigQuery Java read reliability for larger queries","body":"<p>The issue you are encountering with duplicate and missing rows when reading data from BigQuery using TableResult.iterateAll() is likely related to the way pagination is handled and how the query results are ordered. As you mentioned that you get the correct total number of rows, it indicates that the issue is not with the query itself but likely with the pagination.</p>\n<p><code>TableResult.iterateAll()</code> internally handles pagination to retrieve all the rows from the query results. When the result set is large, BigQuery may split the results into <strong>multiple pages</strong>. As you iterate through these pages, it's possible for some rows to appear more than once or be skipped altogether if there are overlapping pages or if the pagination mechanism encounters any issues.</p>\n<p>You can also modify your query to include an <code>ORDER BY</code> clause based on a unique identifier or a stable column in your dataset. This will ensure consistent ordering of the results and may help eliminate the issue of duplicates. Using explicit ordering in your query should provide a more consistent and reliable result.</p>\n"}],"owner":{"account_id":16845,"reputation":5501,"user_id":37134,"accept_rate":80,"display_name":"Sophie Gage"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":77,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":76734095,"answer_count":1,"score":2,"last_activity_date":1689948657,"creation_date":1689239579,"question_id":76677737,"body_markdown":"I am reading 20,000+ rows of data from BigQuery in Java and using `TableResult.iterateAll()` to iterate through these. I am finding that a handful of the rows are returned twice and some are not returned at all by the iterator. I get the correct total number of rows.\r\n\r\nThe input rows include two arrays of STRUCTs so I wonder if I am hitting a size constraint. How can I verify this, or if not, why is this happening?\r\n\r\nWhen I order my input query, the problem goes away, leading me to suspect that BQ is repeating the query internally after it hits some limit and getting the rows back in a slightly different order, unless the query is explicitly ordered.\r\n\r\n```java\r\nQueryJobConfiguration queryConfig = QueryJobConfiguration.newBuilder(query).setUseLegacySql(false).build();\r\nJobId jobId = JobId.of(UUID.randomUUID().toString());\r\nJob queryJob = bigQueryService.create(JobInfo.newBuilder(queryConfig).setJobId(jobId).build());\r\nTableResult queryResults = queryJob.getQueryResults();\r\n\r\nfor (FieldValueList row : queryResult.iterateAll()) {\r\n    // Process row\r\n}\r\n```","title":"BigQuery Java read reliability for larger queries","body":"<p>I am reading 20,000+ rows of data from BigQuery in Java and using <code>TableResult.iterateAll()</code> to iterate through these. I am finding that a handful of the rows are returned twice and some are not returned at all by the iterator. I get the correct total number of rows.</p>\n<p>The input rows include two arrays of STRUCTs so I wonder if I am hitting a size constraint. How can I verify this, or if not, why is this happening?</p>\n<p>When I order my input query, the problem goes away, leading me to suspect that BQ is repeating the query internally after it hits some limit and getting the rows back in a slightly different order, unless the query is explicitly ordered.</p>\n<pre class=\"lang-java prettyprint-override\"><code>QueryJobConfiguration queryConfig = QueryJobConfiguration.newBuilder(query).setUseLegacySql(false).build();\nJobId jobId = JobId.of(UUID.randomUUID().toString());\nJob queryJob = bigQueryService.create(JobInfo.newBuilder(queryConfig).setJobId(jobId).build());\nTableResult queryResults = queryJob.getQueryResults();\n\nfor (FieldValueList row : queryResult.iterateAll()) {\n    // Process row\n}\n</code></pre>\n"},{"tags":["java","xml","fortify"],"answers":[{"tags":[],"owner":{"account_id":1898627,"reputation":547,"user_id":1715003,"accept_rate":63,"display_name":"Jack Parker"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1689948433,"creation_date":1689948433,"answer_id":76738713,"question_id":76680788,"body_markdown":"This is how I resolved it.\r\n\r\n     &lt;http auto-config=&quot;true&quot; request-matcher=&quot;mvc&quot;&gt;\r\n     &lt;intercept-url pattern=&quot;/fubar.jsp&quot;  /&gt;\r\n     &lt;/http&gt;\r\n\r\nIt did leave me with an application context error that I had to go about resolving later on.","title":"How to Convert Ant Matcher to Spring MVC Matchers?","body":"<p>This is how I resolved it.</p>\n<pre><code> &lt;http auto-config=&quot;true&quot; request-matcher=&quot;mvc&quot;&gt;\n &lt;intercept-url pattern=&quot;/fubar.jsp&quot;  /&gt;\n &lt;/http&gt;\n</code></pre>\n<p>It did leave me with an application context error that I had to go about resolving later on.</p>\n"}],"owner":{"account_id":1898627,"reputation":547,"user_id":1715003,"accept_rate":63,"display_name":"Jack Parker"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":119,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":76738713,"answer_count":1,"score":0,"last_activity_date":1689948433,"creation_date":1689260023,"question_id":76680788,"body_markdown":"I am working with Fortify on my latest project, and have a recommendation to update my pattern matcher from an Ant Matcher for Spring MVC endpoints to MVC request matchers. The actual text of the recommendation is this...\r\n\r\nFortify Recommendation:\r\n\r\nTo protect Spring MVC endpoints, use the MVC request matcher instead of the Ant matcher.\r\n\r\nEvery example of the use of MVC matchers is in a Java context, and this file is an XML file, and the lines that Fortify is specifically calling out are formatted like this. I am  not sure what to update or do to get rid of this recommendation and would take any suggestions.\r\n\r\n    &lt;http pattern=&quot;/fu.jsp&quot; sfuecurity=&quot;none&quot; /&gt;\r\n\t&lt;http pattern=&quot;/bar/**&quot; security=&quot;none&quot; /&gt;\r\n\t&lt;intercept-url pattern=&quot;/fubarLogins&quot; access=&quot;allAccess&quot; /&gt;","title":"How to Convert Ant Matcher to Spring MVC Matchers?","body":"<p>I am working with Fortify on my latest project, and have a recommendation to update my pattern matcher from an Ant Matcher for Spring MVC endpoints to MVC request matchers. The actual text of the recommendation is this...</p>\n<p>Fortify Recommendation:</p>\n<p>To protect Spring MVC endpoints, use the MVC request matcher instead of the Ant matcher.</p>\n<p>Every example of the use of MVC matchers is in a Java context, and this file is an XML file, and the lines that Fortify is specifically calling out are formatted like this. I am  not sure what to update or do to get rid of this recommendation and would take any suggestions.</p>\n<pre><code>&lt;http pattern=&quot;/fu.jsp&quot; sfuecurity=&quot;none&quot; /&gt;\n&lt;http pattern=&quot;/bar/**&quot; security=&quot;none&quot; /&gt;\n&lt;intercept-url pattern=&quot;/fubarLogins&quot; access=&quot;allAccess&quot; /&gt;\n</code></pre>\n"},{"tags":["java","hex","decimal","number-systems"],"comments":[{"owner":{"account_id":2709823,"reputation":10716,"user_id":2338547,"display_name":"markspace"},"score":1,"creation_date":1689800811,"post_id":76725182,"comment_id":135266760,"body_markdown":"`String.valueOf(n)` Um, if `n` is your input, it already is &quot;decimal.&quot;  Just use it.","body":"<code>String.valueOf(n)</code> Um, if <code>n</code> is your input, it already is &quot;decimal.&quot;  Just use it."},{"owner":{"account_id":341129,"reputation":39091,"user_id":671543,"accept_rate":55,"display_name":"njzk2"},"score":0,"creation_date":1689800887,"post_id":76725182,"comment_id":135266770,"body_markdown":"those 2 things don&#39;t do the same thing. In fact, I&#39;m not sure your second function does anything at all?","body":"those 2 things don&#39;t do the same thing. In fact, I&#39;m not sure your second function does anything at all?"},{"owner":{"account_id":28919003,"reputation":11,"user_id":22150393,"display_name":"user22150393"},"score":0,"creation_date":1689800977,"post_id":76725182,"comment_id":135266789,"body_markdown":"@markspace changed the post","body":"@markspace changed the post"},{"owner":{"account_id":2709823,"reputation":10716,"user_id":2338547,"display_name":"markspace"},"score":0,"creation_date":1689801004,"post_id":76725182,"comment_id":135266794,"body_markdown":"It&#39;s still decimal.  The `0x` part does the conversion for you.  In other words if you print that value it&#39;ll print &quot;16&quot;.","body":"It&#39;s still decimal.  The <code>0x</code> part does the conversion for you.  In other words if you print that value it&#39;ll print &quot;16&quot;."},{"owner":{"account_id":28919003,"reputation":11,"user_id":22150393,"display_name":"user22150393"},"score":0,"creation_date":1689801094,"post_id":76725182,"comment_id":135266810,"body_markdown":"@markspace I know, but I don&#39;t specify the number in advance, I don&#39;t know it","body":"@markspace I know, but I don&#39;t specify the number in advance, I don&#39;t know it"},{"owner":{"account_id":2709823,"reputation":10716,"user_id":2338547,"display_name":"markspace"},"score":2,"creation_date":1689801157,"post_id":76725182,"comment_id":135266818,"body_markdown":"You&#39;re not making any sense.  I think you&#39;ll most likely need to clarify what your input is, but if it&#39;s a &quot;number&quot; then it&#39;s just a number and decimal or hex doesn&#39;t matter until you choose to print it.  Numbers internally are all the same.","body":"You&#39;re not making any sense.  I think you&#39;ll most likely need to clarify what your input is, but if it&#39;s a &quot;number&quot; then it&#39;s just a number and decimal or hex doesn&#39;t matter until you choose to print it.  Numbers internally are all the same."},{"owner":{"account_id":23428052,"reputation":6895,"user_id":17487348,"display_name":"Mushroomator"},"score":7,"creation_date":1689801186,"post_id":76725182,"comment_id":135266826,"body_markdown":"Hexadecimal and decimal as well as binary are just different representations of the same number. You cannot convert from an *hexadecimal int* to a *decimal int* because there is no such thing as a *hexadecimal int* or *decimal int*. There is only one `int` datatype which will be stored in binary, the rest is just how it&#39;s represented as a String.","body":"Hexadecimal and decimal as well as binary are just different representations of the same number. You cannot convert from an <i>hexadecimal int</i> to a <i>decimal int</i> because there is no such thing as a <i>hexadecimal int</i> or <i>decimal int</i>. There is only one <code>int</code> datatype which will be stored in binary, the rest is just how it&#39;s represented as a String."},{"owner":{"account_id":465573,"reputation":192694,"user_id":869736,"accept_rate":82,"display_name":"Louis Wasserman"},"score":2,"creation_date":1689801611,"post_id":76725182,"comment_id":135266890,"body_markdown":"Here is a 100% correct line of code that will take `int hex = 0x10` and properly give you the value of that in hexadecimal.  This line of code is _absolutely correct_ and will be correct for all inputs.  Here it is: `int decimal = hex;`  I can even guarantee that it&#39;ll be extremely efficient, and a proper benchmark will show you that it takes zero nanoseconds.","body":"Here is a 100% correct line of code that will take <code>int hex = 0x10</code> and properly give you the value of that in hexadecimal.  This line of code is <i>absolutely correct</i> and will be correct for all inputs.  Here it is: <code>int decimal = hex;</code>  I can even guarantee that it&#39;ll be extremely efficient, and a proper benchmark will show you that it takes zero nanoseconds."},{"owner":{"account_id":20470,"reputation":21695,"user_id":48933,"accept_rate":90,"display_name":"Neil Coffey"},"score":0,"creation_date":1689801760,"post_id":76725182,"comment_id":135266916,"body_markdown":"Have you determined that Integer.parseInt(x, 16) is actually using &quot;too many resources&quot; for your intended purpose (and identified what said &quot;resources&quot; actually are...?).","body":"Have you determined that Integer.parseInt(x, 16) is actually using &quot;too many resources&quot; for your intended purpose (and identified what said &quot;resources&quot; actually are...?)."},{"owner":{"account_id":28919003,"reputation":11,"user_id":22150393,"display_name":"user22150393"},"score":0,"creation_date":1689801862,"post_id":76725182,"comment_id":135266933,"body_markdown":"@NeilCoffey In my case, this will be a load on the garbage collector, since the conversion to String requires the creation of an array","body":"@NeilCoffey In my case, this will be a load on the garbage collector, since the conversion to String requires the creation of an array"},{"owner":{"account_id":6606677,"reputation":1024,"user_id":5103317,"display_name":"Old Dog Programmer"},"score":0,"creation_date":1689801910,"post_id":76725182,"comment_id":135266940,"body_markdown":"&quot;convert from hexadecimal to decimal java&quot; makes sense if your input is in character format, and you want the output to be in character format.  But, your example code doesn&#39;t show or otherwise indicate that is the case. Note I deleted both occurrences of &quot;integer&quot; in the quote.","body":"&quot;convert from hexadecimal to decimal java&quot; makes sense if your input is in character format, and you want the output to be in character format.  But, your example code doesn&#39;t show or otherwise indicate that is the case. Note I deleted both occurrences of &quot;integer&quot; in the quote."},{"owner":{"account_id":28919003,"reputation":11,"user_id":22150393,"display_name":"user22150393"},"score":0,"creation_date":1689802209,"post_id":76725182,"comment_id":135266976,"body_markdown":"@OldDogProgrammer This is the point that the Integer value is in the hexadecimal system in advance, and I need to convert to the decimal system","body":"@OldDogProgrammer This is the point that the Integer value is in the hexadecimal system in advance, and I need to convert to the decimal system"},{"owner":{"account_id":6606677,"reputation":1024,"user_id":5103317,"display_name":"Old Dog Programmer"},"score":0,"creation_date":1689802355,"post_id":76725182,"comment_id":135266990,"body_markdown":"If we are confused, it is because you are not telling us enough about what it is you are trying to do, or what problem you are actually trying to solve.","body":"If we are confused, it is because you are not telling us enough about what it is you are trying to do, or what problem you are actually trying to solve."},{"owner":{"account_id":14357,"reputation":9128,"user_id":29470,"display_name":"Tim Moore"},"score":0,"creation_date":1689802671,"post_id":76725182,"comment_id":135267022,"body_markdown":"With your update, how would it convert a hexValue of 10?","body":"With your update, how would it convert a hexValue of 10?"},{"owner":{"account_id":6606677,"reputation":1024,"user_id":5103317,"display_name":"Old Dog Programmer"},"score":0,"creation_date":1689803449,"post_id":76725182,"comment_id":135267121,"body_markdown":"`int hex = 0x10;`, `int hex = 020;`, `int hex = 0b10000`, and `int hex = 16;` all do *exactly* the same thing.","body":"<code>int hex = 0x10;</code>, <code>int hex = 020;</code>, <code>int hex = 0b10000</code>, and <code>int hex = 16;</code> all do <i>exactly</i> the same thing."},{"owner":{"account_id":14357,"reputation":9128,"user_id":29470,"display_name":"Tim Moore"},"score":1,"creation_date":1689803645,"post_id":76725182,"comment_id":135267147,"body_markdown":"I guess they want to convert `0x10` to `10`, `0x16` to `16`, etc. for some reason, but it’s unclear how to handle hexadecimal digits greater than 9.","body":"I guess they want to convert <code>0x10</code> to <code>10</code>, <code>0x16</code> to <code>16</code>, etc. for some reason, but it’s unclear how to handle hexadecimal digits greater than 9."},{"owner":{"account_id":28919003,"reputation":11,"user_id":22150393,"display_name":"user22150393"},"score":0,"creation_date":1689803856,"post_id":76725182,"comment_id":135267168,"body_markdown":"@TimMoore It&#39;s true. I&#39;m already confused myself, but that&#39;s what I wanted","body":"@TimMoore It&#39;s true. I&#39;m already confused myself, but that&#39;s what I wanted"},{"owner":{"account_id":6606677,"reputation":1024,"user_id":5103317,"display_name":"Old Dog Programmer"},"score":1,"creation_date":1689804318,"post_id":76725182,"comment_id":135267230,"body_markdown":"Suggested reading: [How to Ask a Good Queston](https://stackoverflow.com/help/how-to-ask) and [Complete, Minimal, Reproducible Example](https://stackoverflow.com/help/minimal-reproducible-example)  . The example you have given is sub-minimal and incomplete.","body":"Suggested reading: <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask a Good Queston</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Complete, Minimal, Reproducible Example</a>  . The example you have given is sub-minimal and incomplete."},{"owner":{"account_id":14357,"reputation":9128,"user_id":29470,"display_name":"Tim Moore"},"score":1,"creation_date":1689805601,"post_id":76725182,"comment_id":135267365,"body_markdown":"I don’t know what “ a full-fledged index for the array” means. What array? Why are its indices specified in this way? What should happen if the number provided can’t be converted this way?","body":"I don’t know what “ a full-fledged index for the array” means. What array? Why are its indices specified in this way? What should happen if the number provided can’t be converted this way?"},{"owner":{"account_id":6606677,"reputation":1024,"user_id":5103317,"display_name":"Old Dog Programmer"},"score":3,"creation_date":1689805853,"post_id":76725182,"comment_id":135267399,"body_markdown":"I suspect this is an [XY Problem](https://en.wikipedia.org/wiki/XY_problem).   The explanations need to be expanded. The examples need to be expanded. We need more explanation of what is trying to be done. Where do the numbers come from?  If they are from a file, show code that reads the file. Show an example of the contents of the file. Show code for the array that needs to be indexed.","body":"I suspect this is an <a href=\"https://en.wikipedia.org/wiki/XY_problem\" rel=\"nofollow noreferrer\">XY Problem</a>.   The explanations need to be expanded. The examples need to be expanded. We need more explanation of what is trying to be done. Where do the numbers come from?  If they are from a file, show code that reads the file. Show an example of the contents of the file. Show code for the array that needs to be indexed."},{"owner":{"account_id":28104689,"reputation":512,"user_id":21473475,"display_name":"Arfur Narf"},"score":1,"creation_date":1689822608,"post_id":76725182,"comment_id":135268777,"body_markdown":"When you say you want to get the value &#39;10&#39; from `int hex = 16`, what value do you mean?  Do you want the value we call &#39;ten&#39; or the value we call &#39;sixteen&#39;, both of which can represented by the sequence of characters &#39;digit one followed by digit zero&#39;.  As others have said, you are confusing the actual number, which is fixed at sixteen, with some sequence of characters, which sequence depends on how you decide to convert the number to characters.","body":"When you say you want to get the value &#39;10&#39; from <code>int hex = 16</code>, what value do you mean?  Do you want the value we call &#39;ten&#39; or the value we call &#39;sixteen&#39;, both of which can represented by the sequence of characters &#39;digit one followed by digit zero&#39;.  As others have said, you are confusing the actual number, which is fixed at sixteen, with some sequence of characters, which sequence depends on how you decide to convert the number to characters."},{"owner":{"account_id":6128339,"reputation":4087,"user_id":4779472,"accept_rate":89,"display_name":"Rohit Gupta"},"score":0,"creation_date":1690262397,"post_id":76725182,"comment_id":135324751,"body_markdown":"Why have you removed your code ?","body":"Why have you removed your code ?"},{"owner":{"account_id":6606677,"reputation":1024,"user_id":5103317,"display_name":"Old Dog Programmer"},"score":1,"creation_date":1690303623,"post_id":76725182,"comment_id":135333454,"body_markdown":"Do you still want help with this? If so, you need to edit the question again. Go back, start at the beginning. Tell us where these numbers come from. Explain the problem you have with indexing the array with these numbers.","body":"Do you still want help with this? If so, you need to edit the question again. Go back, start at the beginning. Tell us where these numbers come from. Explain the problem you have with indexing the array with these numbers."},{"owner":{"account_id":6520,"reputation":10523,"user_id":11002,"accept_rate":75,"display_name":"tgdavies"},"score":1,"creation_date":1690351420,"post_id":76725182,"comment_id":135339373,"body_markdown":"Your revision does not explain why you think you need the number `10` to index your array, or even what you think the number `10` is. Please show much more of your code: where the number comes from, and what you do with it.","body":"Your revision does not explain why you think you need the number <code>10</code> to index your array, or even what you think the number <code>10</code> is. Please show much more of your code: where the number comes from, and what you do with it."}],"answers":[{"tags":[],"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1689948297,"creation_date":1689801213,"answer_id":76725233,"question_id":76725182,"body_markdown":"Hex, binary, octal, etc are all visual presentations of a number in a specific base. Any `int` is already in &quot;binary.&quot;  It could be +5 (1) and ground (0) if you want to go that deep into it.\r\n\r\nSo converting an `int` to another base does not make sense unless it is for display purposes.\r\n\r\nOr given a string in a particular base and converting that to an `int` so it can be used in mathematical expressions or data structures is also an option.\r\n\r\nPer your comment I still believe you are somewhat confused about numeric representation.  But here is how to convert a `hex string` to an `int`. This does not handle signed values.\r\n```\r\nString hexString = &quot;2A4&quot;;\r\n \r\nString hexDigits = &quot;0123456789ABCDEF&quot;;\r\nint result = 0;\r\nfor (char c : hexString.toCharArray()) {\r\n     result = result * 16 + hexDigits.indexOf(c);\r\n}\r\nSystem.out.println(result);\r\n```\r\nprints\r\n```\r\n676\r\n```\r\nAnd let me repeat that it does not make sense to try and convert any `int` from one base to an `int` in another base, as int&#39;s are not really in any base at all.  `ints` are treated as `decimal` by the compiler and we talk about them as though they are `binary` because it provides a common and accepted way to describe them.\r\n\r\n**Updated**\r\n\r\nYou may want to check out [Integer.decode](https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/lang/Integer.html#decode(java.lang.String)). If you are reading in encoded strings with prefixes of `x,X, and #` for hex ,`0` for octal, and a non-zero digit for decimal, you can do the following.\r\n```\r\nString [] codes = {&quot;0x11&quot;, &quot;021&quot;, &quot;#11&quot;, &quot;17&quot;};\r\n \r\nfor (String code : codes) {\r\n     System.out.println(Integer.decode(code));\r\n}\r\n```\r\nprints\r\n``` \r\n17\r\n17\r\n17\r\n17\r\n \r\n","title":"Convert from hexadecimal integer to decimal java","body":"<p>Hex, binary, octal, etc are all visual presentations of a number in a specific base. Any <code>int</code> is already in &quot;binary.&quot;  It could be +5 (1) and ground (0) if you want to go that deep into it.</p>\n<p>So converting an <code>int</code> to another base does not make sense unless it is for display purposes.</p>\n<p>Or given a string in a particular base and converting that to an <code>int</code> so it can be used in mathematical expressions or data structures is also an option.</p>\n<p>Per your comment I still believe you are somewhat confused about numeric representation.  But here is how to convert a <code>hex string</code> to an <code>int</code>. This does not handle signed values.</p>\n<pre><code>String hexString = &quot;2A4&quot;;\n \nString hexDigits = &quot;0123456789ABCDEF&quot;;\nint result = 0;\nfor (char c : hexString.toCharArray()) {\n     result = result * 16 + hexDigits.indexOf(c);\n}\nSystem.out.println(result);\n</code></pre>\n<p>prints</p>\n<pre><code>676\n</code></pre>\n<p>And let me repeat that it does not make sense to try and convert any <code>int</code> from one base to an <code>int</code> in another base, as int's are not really in any base at all.  <code>ints</code> are treated as <code>decimal</code> by the compiler and we talk about them as though they are <code>binary</code> because it provides a common and accepted way to describe them.</p>\n<p><strong>Updated</strong></p>\n<p>You may want to check out <a href=\"https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/lang/Integer.html#decode(java.lang.String)\" rel=\"nofollow noreferrer\">Integer.decode</a>. If you are reading in encoded strings with prefixes of <code>x,X, and #</code> for hex ,<code>0</code> for octal, and a non-zero digit for decimal, you can do the following.</p>\n<pre><code>String [] codes = {&quot;0x11&quot;, &quot;021&quot;, &quot;#11&quot;, &quot;17&quot;};\n \nfor (String code : codes) {\n     System.out.println(Integer.decode(code));\n}\n</code></pre>\n<p>prints</p>\n<pre><code>17\n17\n17\n17\n \n</code></pre>\n"}],"owner":{"account_id":28919003,"reputation":11,"user_id":22150393,"display_name":"user22150393"},"comment_count":24,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":136,"favorite_count":0,"down_vote_count":3,"up_vote_count":0,"closed_date":1689801781,"answer_count":1,"score":-3,"last_activity_date":1689948297,"creation_date":1689800541,"question_id":76725182,"body_markdown":"There are pre-translated numbers from hexadecimal to decimal. For example, 0x01, 0x10 and so on. I need to extract from it everything that is after x, so that I get a number that could fit as an index to the array.\r\n\r\nThe difficulty lies in the fact that the hex value is an Integer (NOT AS a String), that is, it is in this format:\r\n\r\n```\r\nint hexValue = 16; // 0x10 \r\n```\r\nAnd I need to get the answer 10.\r\n\r\nWhy is this necessary? I need the hexadecimal value to be a full-fledged index for the array","title":"Convert from hexadecimal integer to decimal java","body":"<p>There are pre-translated numbers from hexadecimal to decimal. For example, 0x01, 0x10 and so on. I need to extract from it everything that is after x, so that I get a number that could fit as an index to the array.</p>\n<p>The difficulty lies in the fact that the hex value is an Integer (NOT AS a String), that is, it is in this format:</p>\n<pre><code>int hexValue = 16; // 0x10 \n</code></pre>\n<p>And I need to get the answer 10.</p>\n<p>Why is this necessary? I need the hexadecimal value to be a full-fledged index for the array</p>\n"},{"tags":["java","vert.x"],"comments":[{"owner":{"account_id":10496592,"reputation":3058,"user_id":7736617,"display_name":"Arnaud Claudel"},"score":0,"creation_date":1689882733,"post_id":76732807,"comment_id":135280214,"body_markdown":"Does this answer your question? [Using Jackson ObjectMapper with Java 8 Optional values](https://stackoverflow.com/questions/25693309/using-jackson-objectmapper-with-java-8-optional-values)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/25693309/using-jackson-objectmapper-with-java-8-optional-values\">Using Jackson ObjectMapper with Java 8 Optional values</a>"},{"owner":{"account_id":2270024,"reputation":1657,"user_id":1997707,"accept_rate":80,"display_name":"John Mercier"},"score":0,"creation_date":1689945406,"post_id":76732807,"comment_id":135288689,"body_markdown":"@ArnaudClaudel partially. This is the right direction but how do I get the jdk8 module to work with vertx JsonObject?","body":"@ArnaudClaudel partially. This is the right direction but how do I get the jdk8 module to work with vertx JsonObject?"}],"answers":[{"tags":[],"owner":{"account_id":2270024,"reputation":1657,"user_id":1997707,"accept_rate":80,"display_name":"John Mercier"},"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1689947936,"creation_date":1689947936,"answer_id":76738656,"question_id":76732807,"body_markdown":"Add support for Optional to the mapper used by vertx. This has to be done in the application and before running tests. As an example, it can be added to an `@Before` method in these tests.\r\n\r\n```\r\n    @Before\r\n    public void setup() {\r\n        DatabindCodec.mapper()\r\n            .registerModule(new ParameterNamesModule())\r\n            .registerModule(new Jdk8Module())\r\n            .registerModule(new JavaTimeModule());\r\n    }\r\n```","title":"How to test vertx serialization/deserialization","body":"<p>Add support for Optional to the mapper used by vertx. This has to be done in the application and before running tests. As an example, it can be added to an <code>@Before</code> method in these tests.</p>\n<pre><code>    @Before\n    public void setup() {\n        DatabindCodec.mapper()\n            .registerModule(new ParameterNamesModule())\n            .registerModule(new Jdk8Module())\n            .registerModule(new JavaTimeModule());\n    }\n</code></pre>\n"}],"owner":{"account_id":2270024,"reputation":1657,"user_id":1997707,"accept_rate":80,"display_name":"John Mercier"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":50,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76738656,"answer_count":1,"score":0,"last_activity_date":1689947936,"creation_date":1689878013,"question_id":76732807,"body_markdown":"I&#39;m trying to test vertx mapping between JsonObject and a pojo. I added methods `fromJson` and `toJson` which will be added to json-mappers.properties. for use in vertx. The class is immutable and using lombok `@Value` and `@Builder`.\r\n\r\n```\r\n@Value\r\n@Jacksonized\r\n@Builder\r\npublic class AdSystem {\r\n    String version;\r\n    String system;\r\n\r\n    public Optional&lt;String&gt; getVersion() {\r\n        return Optional.ofNullable(version);\r\n    }\r\n\r\n    public Optional&lt;String&gt; getSystem() {\r\n        return Optional.ofNullable(system);\r\n    }\r\n\r\n    public JsonObject toJson() {\r\n        return JsonObject.mapFrom(this);\r\n    }\r\n\r\n    public static AdSystem fromJson(JsonObject jsonObject) {\r\n        return jsonObject.mapTo(AdSystem.class);\r\n    }\r\n}\r\n```\r\n\r\nWhen I test this deserialization works but serialization does not.\r\n\r\n```\r\n    @Test\r\n    public void toJson_passes() {\r\n        var system = new AdSystem(&quot;1&quot;, &quot;iabtechlab&quot;);\r\n        var json = system.toJson();\r\n        assertThat(json).isEqualTo(new JsonObject().put(&quot;version&quot;, &quot;1&quot;).put(&quot;system&quot;, &quot;iabtechlab&quot;));\r\n    }\r\n\r\n    @Test\r\n    public void fromJson_passes() {\r\n        var json = new JsonObject().put(&quot;version&quot;, &quot;1&quot;).put(&quot;system&quot;, &quot;iabtechlab&quot;);\r\n        var system = AdSystem.fromJson(json);\r\n        assertThat(system).isEqualTo(new AdSystem(&quot;1&quot;, &quot;iabtechlab&quot;));\r\n    }\r\n```\r\n\r\n`toJson` fails and this is the result.\r\n\r\n```\r\norg.junit.ComparisonFailure: \r\nExpected :{&quot;version&quot;:&quot;1&quot;,&quot;system&quot;:&quot;iabtechlab&quot;}\r\nActual   :{&quot;version&quot;:{&quot;empty&quot;:false,&quot;present&quot;:true},&quot;system&quot;:{&quot;empty&quot;:false,&quot;present&quot;:true}}\r\n```\r\n\r\nWhat am I doing wrong?","title":"How to test vertx serialization/deserialization","body":"<p>I'm trying to test vertx mapping between JsonObject and a pojo. I added methods <code>fromJson</code> and <code>toJson</code> which will be added to json-mappers.properties. for use in vertx. The class is immutable and using lombok <code>@Value</code> and <code>@Builder</code>.</p>\n<pre><code>@Value\n@Jacksonized\n@Builder\npublic class AdSystem {\n    String version;\n    String system;\n\n    public Optional&lt;String&gt; getVersion() {\n        return Optional.ofNullable(version);\n    }\n\n    public Optional&lt;String&gt; getSystem() {\n        return Optional.ofNullable(system);\n    }\n\n    public JsonObject toJson() {\n        return JsonObject.mapFrom(this);\n    }\n\n    public static AdSystem fromJson(JsonObject jsonObject) {\n        return jsonObject.mapTo(AdSystem.class);\n    }\n}\n</code></pre>\n<p>When I test this deserialization works but serialization does not.</p>\n<pre><code>    @Test\n    public void toJson_passes() {\n        var system = new AdSystem(&quot;1&quot;, &quot;iabtechlab&quot;);\n        var json = system.toJson();\n        assertThat(json).isEqualTo(new JsonObject().put(&quot;version&quot;, &quot;1&quot;).put(&quot;system&quot;, &quot;iabtechlab&quot;));\n    }\n\n    @Test\n    public void fromJson_passes() {\n        var json = new JsonObject().put(&quot;version&quot;, &quot;1&quot;).put(&quot;system&quot;, &quot;iabtechlab&quot;);\n        var system = AdSystem.fromJson(json);\n        assertThat(system).isEqualTo(new AdSystem(&quot;1&quot;, &quot;iabtechlab&quot;));\n    }\n</code></pre>\n<p><code>toJson</code> fails and this is the result.</p>\n<pre><code>org.junit.ComparisonFailure: \nExpected :{&quot;version&quot;:&quot;1&quot;,&quot;system&quot;:&quot;iabtechlab&quot;}\nActual   :{&quot;version&quot;:{&quot;empty&quot;:false,&quot;present&quot;:true},&quot;system&quot;:{&quot;empty&quot;:false,&quot;present&quot;:true}}\n</code></pre>\n<p>What am I doing wrong?</p>\n"},{"tags":["java","jpa","spring-data-jpa","spring-data","eclipselink"],"comments":[{"owner":{"account_id":231721,"reputation":20460,"user_id":496099,"display_name":"Chris"},"score":0,"creation_date":1663181574,"post_id":73719352,"comment_id":130181418,"body_markdown":"This is trivial in JPQL/SQL strings by building a string, or with criteria queries if you dynamically build the query. What you are asking though is how to do it statically with Spring generating the query for you - you cannot. You have to build the query yourself, adding in &#39;OR&#39; clauses for each pair of inputs.","body":"This is trivial in JPQL/SQL strings by building a string, or with criteria queries if you dynamically build the query. What you are asking though is how to do it statically with Spring generating the query for you - you cannot. You have to build the query yourself, adding in &#39;OR&#39; clauses for each pair of inputs."}],"answers":[{"tags":[],"owner":{"account_id":324951,"reputation":935,"user_id":6722664,"display_name":"Sagar Gandhi"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1663171211,"creation_date":1663171211,"answer_id":73719962,"question_id":73719352,"body_markdown":"I had same problem. I am writing the custom query using @Query to solve this problem. You can write custom where causes,\r\n\r\n      @Query(&quot;SELECT wftr FROM WorkflowActivityRequestEntity wftr WHERE wftr.status IN :status&quot;)\r\n    List&lt;WorkflowActivityRequestEntity&gt; findWorkflowActivityRequestsByStatus(\r\n            @Param(&quot;status&quot;)\r\n            List&lt;String&gt; status);\r\n\r\n    @Query(&quot;SELECT wftr FROM WorkflowActivityRequestEntity wftr WHERE wftr.owner NOT IN :owners&quot;)\r\n    List&lt;WorkflowActivityRequestEntity&gt; findWorkflowActivityRequestsNotOwnedBy(\r\n            @Param(&quot;owners&quot;)\r\n            List&lt;String&gt; owners);\r\n\r\n\r\nFor AND and OR combination you can also extend your repository interface with `JpaSpecificationExecutor`\r\n\r\nand then use Criteria builder. I referred https://www.baeldung.com/spring-data-criteria-queries while doing this in my projects.\r\n\r\nHope it helps.\r\n\r\n","title":"select rows using pair of columns with JPA (provider eclipselink) and Spring Data","body":"<p>I had same problem. I am writing the custom query using @Query to solve this problem. You can write custom where causes,</p>\n<pre><code>  @Query(&quot;SELECT wftr FROM WorkflowActivityRequestEntity wftr WHERE wftr.status IN :status&quot;)\nList&lt;WorkflowActivityRequestEntity&gt; findWorkflowActivityRequestsByStatus(\n        @Param(&quot;status&quot;)\n        List&lt;String&gt; status);\n\n@Query(&quot;SELECT wftr FROM WorkflowActivityRequestEntity wftr WHERE wftr.owner NOT IN :owners&quot;)\nList&lt;WorkflowActivityRequestEntity&gt; findWorkflowActivityRequestsNotOwnedBy(\n        @Param(&quot;owners&quot;)\n        List&lt;String&gt; owners);\n</code></pre>\n<p>For AND and OR combination you can also extend your repository interface with <code>JpaSpecificationExecutor</code></p>\n<p>and then use Criteria builder. I referred <a href=\"https://www.baeldung.com/spring-data-criteria-queries\" rel=\"nofollow noreferrer\">https://www.baeldung.com/spring-data-criteria-queries</a> while doing this in my projects.</p>\n<p>Hope it helps.</p>\n"},{"tags":[],"owner":{"account_id":52517,"reputation":6279,"user_id":156973,"display_name":"izogfif"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689947383,"creation_date":1689947383,"answer_id":76738587,"question_id":73719352,"body_markdown":"Try this:\r\n\r\nCreate an `@Embeddable` class to hold your `col1` and `col2`:\r\n\r\n```lang-java\r\nimport jakarta.persistence.Column;\r\nimport jakarta.persistence.Embeddable;\r\nimport java.io.Serializable;\r\nimport lombok.AccessLevel;\r\nimport lombok.AllArgsConstructor;\r\nimport lombok.EqualsAndHashCode;\r\nimport lombok.Getter;\r\nimport lombok.NoArgsConstructor;\r\nimport lombok.Setter;\r\nimport lombok.ToString;\r\n\r\n@Embeddable\r\n@NoArgsConstructor(access = AccessLevel.PROTECTED)\r\n@AllArgsConstructor\r\n@Getter\r\n@Setter(AccessLevel.PROTECTED)\r\n@EqualsAndHashCode\r\n@ToString\r\npublic class ColWrapper implements Serializable {\r\n  private @Column(name = &quot;col1&quot;) Integer col1;\r\n  private @Column(name = &quot;col2&quot;) Integer col2;\r\n}\r\n\r\n```\r\n\r\nAdd a field of this type in your entity:\r\n\r\n```lang-java\r\nimport jakarta.persistence.AttributeOverride;\r\nimport jakarta.persistence.AttributeOverrides;\r\nimport jakarta.persistence.Column;\r\nimport jakarta.persistence.Entity;\r\nimport jakarta.persistence.GeneratedValue;\r\nimport jakarta.persistence.GenerationType;\r\nimport jakarta.persistence.Id;\r\nimport jakarta.persistence.Table;\r\nimport java.io.Serializable;\r\nimport lombok.AccessLevel;\r\nimport lombok.Getter;\r\nimport lombok.NoArgsConstructor;\r\nimport lombok.Setter;\r\n\r\n@NoArgsConstructor(access = AccessLevel.PROTECTED)\r\n@Getter\r\n// Fields should not be modifiable from outside, you can add\r\n// @Setter(AccessLevel.PUBLIC) on those fields that should be modifiable\r\n@Setter(AccessLevel.PACKAGE)\r\n@Table(name = &quot;t1&quot;)\r\n@Entity\r\npublic class T1Entity implements Serializable {\r\n  // Using &quot;strategy = GenerationType.IDENTITY&quot; to prevent Hibernate from \r\n  // creating columns in database upon initialization.\r\n  // Integer is used instead of int here and below to distinguish between\r\n  // uninitialized field and field that has value of 0.\r\n  private @Id @GeneratedValue(strategy = GenerationType.IDENTITY) Integer id;\r\n  private @Column Integer col1;\r\n  private @Column Integer col2;\r\n\r\n  // Needed only to add &quot;updatable=false&quot; and &quot;insertable=false&quot;\r\n  // on @Column annotations for ColWrapper. If you don&#39;t want to use\r\n  // ColWrapper anywhere else, you can add &quot;updatable = false&quot; and\r\n  // &quot;insertable = false&quot; in @Column annotations in ColWrapper declaration \r\n  // and omit the entire @AttributeOverrides annotation here\r\n  @AttributeOverrides({\r\n    @AttributeOverride(\r\n        name = &quot;col1&quot;,\r\n        column = @Column(name = &quot;col1&quot;, updatable = false, insertable = false)),\r\n    @AttributeOverride(\r\n        name = &quot;col2&quot;,\r\n        column = @Column(name = &quot;col2&quot;, updatable = false, insertable = false))\r\n  })\r\n  private ColWrapper colWrapper;\r\n\r\n  public T1Entity(int id, int col1, int col2) {\r\n    setId(id);\r\n    setCol1(col1);\r\n    setCol2(col2);\r\n    // Just for consistency\r\n    setColWrapper(new ColWrapper(col1, col2));\r\n  }\r\n```\r\n\r\nSpring Data JPA Repository code:\r\n```lang-java\r\nimport java.util.List;\r\nimport lombok.NonNull;\r\nimport org.springframework.data.jpa.repository.JpaRepository;\r\n\r\npublic interface T1Repository extends JpaRepository&lt;T1Entity, Long&gt; {\r\n  @NonNull\r\n  List&lt;T1Entity&gt; findByColWrapperIn(@NonNull Iterable&lt;ColWrapper&gt; pairs);\r\n}\r\n\r\n```\r\n\r\nSample service:\r\n\r\n```java-lang\r\nimport java.util.List;\r\nimport lombok.NonNull;\r\nimport lombok.RequiredArgsConstructor;\r\nimport org.springframework.stereotype.Service;\r\nimport org.springframework.transaction.annotation.Transactional;\r\n\r\n@Service\r\n@RequiredArgsConstructor\r\npublic class T1Service {\r\n  private final @NonNull T1Repository t1Repository;\r\n\r\n  @Transactional\r\n  public void test() {\r\n    final var result =\r\n        t1Repository.findByColWrapperIn(List.of(new ColWrapper(25, 661), new ColWrapper(89, 741)));\r\n    for (var entity : result) {\r\n      System.out.println(entity.getCol1() + &quot;, &quot; + entity.getCol2());\r\n    }\r\n  }\r\n}\r\n\r\n```\r\n\r\nCalling `test()` should result in this SQL request being (newlines added by me, you can view this SQL in logs if you enable `DEBUG`-level logging for `org.hibernate.SQL` logger):\r\n```lang-sql\r\nselect\r\nt1_0.id,\r\nt1_0.col1,\r\nt1_0.col2\r\nfrom t1 t1_0\r\nwhere (t1_0.col1,t1_0.col2) in ((?,?),(?,?))\r\n```\r\n\r\nConsole output:\r\n```\r\n25, 661\r\n89, 741\r\n```\r\n\r\nAnother way is to use specifications like mentioned in [this answer](https://stackoverflow.com/a/69736182/156973).","title":"select rows using pair of columns with JPA (provider eclipselink) and Spring Data","body":"<p>Try this:</p>\n<p>Create an <code>@Embeddable</code> class to hold your <code>col1</code> and <code>col2</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import jakarta.persistence.Column;\nimport jakarta.persistence.Embeddable;\nimport java.io.Serializable;\nimport lombok.AccessLevel;\nimport lombok.AllArgsConstructor;\nimport lombok.EqualsAndHashCode;\nimport lombok.Getter;\nimport lombok.NoArgsConstructor;\nimport lombok.Setter;\nimport lombok.ToString;\n\n@Embeddable\n@NoArgsConstructor(access = AccessLevel.PROTECTED)\n@AllArgsConstructor\n@Getter\n@Setter(AccessLevel.PROTECTED)\n@EqualsAndHashCode\n@ToString\npublic class ColWrapper implements Serializable {\n  private @Column(name = &quot;col1&quot;) Integer col1;\n  private @Column(name = &quot;col2&quot;) Integer col2;\n}\n\n</code></pre>\n<p>Add a field of this type in your entity:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import jakarta.persistence.AttributeOverride;\nimport jakarta.persistence.AttributeOverrides;\nimport jakarta.persistence.Column;\nimport jakarta.persistence.Entity;\nimport jakarta.persistence.GeneratedValue;\nimport jakarta.persistence.GenerationType;\nimport jakarta.persistence.Id;\nimport jakarta.persistence.Table;\nimport java.io.Serializable;\nimport lombok.AccessLevel;\nimport lombok.Getter;\nimport lombok.NoArgsConstructor;\nimport lombok.Setter;\n\n@NoArgsConstructor(access = AccessLevel.PROTECTED)\n@Getter\n// Fields should not be modifiable from outside, you can add\n// @Setter(AccessLevel.PUBLIC) on those fields that should be modifiable\n@Setter(AccessLevel.PACKAGE)\n@Table(name = &quot;t1&quot;)\n@Entity\npublic class T1Entity implements Serializable {\n  // Using &quot;strategy = GenerationType.IDENTITY&quot; to prevent Hibernate from \n  // creating columns in database upon initialization.\n  // Integer is used instead of int here and below to distinguish between\n  // uninitialized field and field that has value of 0.\n  private @Id @GeneratedValue(strategy = GenerationType.IDENTITY) Integer id;\n  private @Column Integer col1;\n  private @Column Integer col2;\n\n  // Needed only to add &quot;updatable=false&quot; and &quot;insertable=false&quot;\n  // on @Column annotations for ColWrapper. If you don't want to use\n  // ColWrapper anywhere else, you can add &quot;updatable = false&quot; and\n  // &quot;insertable = false&quot; in @Column annotations in ColWrapper declaration \n  // and omit the entire @AttributeOverrides annotation here\n  @AttributeOverrides({\n    @AttributeOverride(\n        name = &quot;col1&quot;,\n        column = @Column(name = &quot;col1&quot;, updatable = false, insertable = false)),\n    @AttributeOverride(\n        name = &quot;col2&quot;,\n        column = @Column(name = &quot;col2&quot;, updatable = false, insertable = false))\n  })\n  private ColWrapper colWrapper;\n\n  public T1Entity(int id, int col1, int col2) {\n    setId(id);\n    setCol1(col1);\n    setCol2(col2);\n    // Just for consistency\n    setColWrapper(new ColWrapper(col1, col2));\n  }\n</code></pre>\n<p>Spring Data JPA Repository code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.List;\nimport lombok.NonNull;\nimport org.springframework.data.jpa.repository.JpaRepository;\n\npublic interface T1Repository extends JpaRepository&lt;T1Entity, Long&gt; {\n  @NonNull\n  List&lt;T1Entity&gt; findByColWrapperIn(@NonNull Iterable&lt;ColWrapper&gt; pairs);\n}\n\n</code></pre>\n<p>Sample service:</p>\n<pre><code>import java.util.List;\nimport lombok.NonNull;\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\n@Service\n@RequiredArgsConstructor\npublic class T1Service {\n  private final @NonNull T1Repository t1Repository;\n\n  @Transactional\n  public void test() {\n    final var result =\n        t1Repository.findByColWrapperIn(List.of(new ColWrapper(25, 661), new ColWrapper(89, 741)));\n    for (var entity : result) {\n      System.out.println(entity.getCol1() + &quot;, &quot; + entity.getCol2());\n    }\n  }\n}\n\n</code></pre>\n<p>Calling <code>test()</code> should result in this SQL request being (newlines added by me, you can view this SQL in logs if you enable <code>DEBUG</code>-level logging for <code>org.hibernate.SQL</code> logger):</p>\n<pre class=\"lang-sql prettyprint-override\"><code>select\nt1_0.id,\nt1_0.col1,\nt1_0.col2\nfrom t1 t1_0\nwhere (t1_0.col1,t1_0.col2) in ((?,?),(?,?))\n</code></pre>\n<p>Console output:</p>\n<pre><code>25, 661\n89, 741\n</code></pre>\n<p>Another way is to use specifications like mentioned in <a href=\"https://stackoverflow.com/a/69736182/156973\">this answer</a>.</p>\n"}],"owner":{"account_id":6840202,"reputation":344,"user_id":5260862,"display_name":"SJ1"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":945,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1689947383,"creation_date":1663168660,"question_id":73719352,"body_markdown":"I have a table like below in MSSQL - \r\n\r\n```\r\ncreate table t1 (\r\n\r\n  id   int   IDENTITY(1,1),\r\n  col1 int   not null,\r\n  col2 int   not null, \r\n  \r\n  constraint t1_UK UNIQUE (col1, col2)\r\n\r\n)\r\n```\r\n\r\nand data like below - \r\n\r\n```\r\n   id    col1     col2\r\n    1      25      661\r\n    2      25      741\r\n    3      89      661\r\n    4      89      741\r\n```\r\n\r\nhow do I select rows with id 1 and id 4 with where clause only on col1 and col2 ?\r\n\r\nEntity Def- \r\n\r\n```\r\n@Entity\r\n@Table\r\nclass T1Entity {\r\n   @Id\r\n   @GeneratedValue\r\n   private int id;\r\n\r\n   @Column\r\n   private int col1;\r\n\r\n   @Column\r\n   private int col2;\r\n\r\n   // getters, setters\r\n}\r\n```\r\n\r\nNote that assuming I have `T1EntityRepository`, I can&#39;t define a method like `findByCol1InAndCol2In(List.of(25, 89), List.of(661, 741)` as it will return all rows in sample data. \r\n\r\n\r\nI know I need something like `Select col1, col2 from t1 where (col1=25 and col2 = 661) OR (col1=89 and col2=741)` but how to do this using JPA. (also, is there a way in SQL itself without using OR of AND)\r\n\r\n","title":"select rows using pair of columns with JPA (provider eclipselink) and Spring Data","body":"<p>I have a table like below in MSSQL -</p>\n<pre><code>create table t1 (\n\n  id   int   IDENTITY(1,1),\n  col1 int   not null,\n  col2 int   not null, \n  \n  constraint t1_UK UNIQUE (col1, col2)\n\n)\n</code></pre>\n<p>and data like below -</p>\n<pre><code>   id    col1     col2\n    1      25      661\n    2      25      741\n    3      89      661\n    4      89      741\n</code></pre>\n<p>how do I select rows with id 1 and id 4 with where clause only on col1 and col2 ?</p>\n<p>Entity Def-</p>\n<pre><code>@Entity\n@Table\nclass T1Entity {\n   @Id\n   @GeneratedValue\n   private int id;\n\n   @Column\n   private int col1;\n\n   @Column\n   private int col2;\n\n   // getters, setters\n}\n</code></pre>\n<p>Note that assuming I have <code>T1EntityRepository</code>, I can't define a method like <code>findByCol1InAndCol2In(List.of(25, 89), List.of(661, 741)</code> as it will return all rows in sample data.</p>\n<p>I know I need something like <code>Select col1, col2 from t1 where (col1=25 and col2 = 661) OR (col1=89 and col2=741)</code> but how to do this using JPA. (also, is there a way in SQL itself without using OR of AND)</p>\n"},{"tags":["java","schedule","optaplanner","timefold"],"comments":[{"owner":{"account_id":14879486,"reputation":964,"user_id":10744614,"display_name":"Radovan Synek"},"score":0,"creation_date":1690182727,"post_id":76738562,"comment_id":135312148,"body_markdown":"Could you please clarify why both the `start` and `duration` are planning variables? I would expect that the `RoutineInstance`  comes with a fixed duration (e.g. average duration or worst case duration per routine type) and the planning variable is only its `start`.\nAs for the solver running infinitely, have you tried turning on `debug` (shows steps) and then also `trace` (shows evaluated moves) logging?","body":"Could you please clarify why both the <code>start</code> and <code>duration</code> are planning variables? I would expect that the <code>RoutineInstance</code>  comes with a fixed duration (e.g. average duration or worst case duration per routine type) and the planning variable is only its <code>start</code>. As for the solver running infinitely, have you tried turning on <code>debug</code> (shows steps) and then also <code>trace</code> (shows evaluated moves) logging?"},{"owner":{"account_id":10241648,"reputation":11,"user_id":7558886,"display_name":"Luca K"},"score":0,"creation_date":1690291085,"post_id":76738562,"comment_id":135330464,"body_markdown":"@RadovanSynek certainly, as opposed to how a routine may be defined in other cases, in my application I want the duration to be flexible, depending on how busy the schedule is - e.g. imagine a routine &quot;Yoga&quot; with min duration 30mins, max 2hrs. If there&#39;s enough space in the schedule it should schedule e.g. a 2hrs or 1,5hrs session whereas if the schedule is already busy, it would maybe fit in at least a 30 mins session.","body":"@RadovanSynek certainly, as opposed to how a routine may be defined in other cases, in my application I want the duration to be flexible, depending on how busy the schedule is - e.g. imagine a routine &quot;Yoga&quot; with min duration 30mins, max 2hrs. If there&#39;s enough space in the schedule it should schedule e.g. a 2hrs or 1,5hrs session whereas if the schedule is already busy, it would maybe fit in at least a 30 mins session."},{"owner":{"account_id":10241648,"reputation":11,"user_id":7558886,"display_name":"Luca K"},"score":0,"creation_date":1690291090,"post_id":76738562,"comment_id":135330468,"body_markdown":"I have definitely looked at the debug logs but can&#39;t really identify any indication for what I&#39;m doing wrong - attached for [solution 1](https://gist.github.com/lucatk/decab81a53981afdd50599528372ce56#file-log_solution1-txt) and [solution 2](https://gist.github.com/lucatk/decab81a53981afdd50599528372ce56#file-log_solution2-txt)","body":"I have definitely looked at the debug logs but can&#39;t really identify any indication for what I&#39;m doing wrong - attached for <a href=\"https://gist.github.com/lucatk/decab81a53981afdd50599528372ce56#file-log_solution1-txt\" rel=\"nofollow noreferrer\">solution 1</a> and <a href=\"https://gist.github.com/lucatk/decab81a53981afdd50599528372ce56#file-log_solution2-txt\" rel=\"nofollow noreferrer\">solution 2</a>"},{"owner":{"account_id":10241648,"reputation":11,"user_id":7558886,"display_name":"Luca K"},"score":0,"creation_date":1690403068,"post_id":76738562,"comment_id":135350521,"body_markdown":"I&#39;ve now configured a cartesianProductMoveSelector to make start and duration changes in one step. Again - if I use sorted selection, what happens is that it only cycles the initial values in the moves, never proceeding - see this [log](https://gist.github.com/lucatk/c28984b71fdb91bb66e0732d7f284b51)","body":"I&#39;ve now configured a cartesianProductMoveSelector to make start and duration changes in one step. Again - if I use sorted selection, what happens is that it only cycles the initial values in the moves, never proceeding - see this <a href=\"https://gist.github.com/lucatk/c28984b71fdb91bb66e0732d7f284b51\" rel=\"nofollow noreferrer\">log</a>"}],"owner":{"account_id":10241648,"reputation":11,"user_id":7558886,"display_name":"Luca K"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":102,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689947131,"creation_date":1689947131,"question_id":76738562,"body_markdown":"First of all, sorry for this long ass question, but I am trying to include all relevant facts for getting accurate help with my configuration. If yet I am missing something, I&#39;m happy to clarify!\r\n\r\nI’m trying to use Timefold to schedule user-created routines into a calendar repeatedly, avoiding clashes with existing fixed events in the calendar.\r\n\r\nThe fixed events have set `start` and `end` dates and are problem facts.\r\n\r\nThe routines to be scheduled are supposed to be somewhat flexible so we can create a schedule even if the calendar is already quite full with fixed events. For this, the routine configurations have the problem facts `minDuration` and `maxDuration`, and given `timeRanges` in which they can be scheduled, e.g. `Monday 12-5pm`, `Tuesday 9-3pm`, `Friday 12-9pm`. Nonetheless this doesn&#39;t mean the routine should be scheduled every Monday, Tuesday and Friday during these times, but rather once a week in between any one of the `timeRanges`.\r\nTherefore what I want to solve for are `start` and `duration`/`end` (though I discovered I can model the constraints more easily if I use duration) problem variables for a list of `routines` (planning entities).\r\n\r\nThe value range providers I use are bound on the entities, as they differ based on the routine configuration. The `start` VRP is a `CompositeCountableValueRange` joining all start timestamps of the time ranges.\r\nThe `duration` VRP creates a Long VR between `minDuration` and `maxDuration`. Both valueRangeProviders have a 5 minute increment, because I don&#39;t want routines to start at e.g. 11:38 and don&#39;t need minute granularity.\r\n\r\nI have setup a hard penalty for partially scheduled routines (only start OR duration set), hard overlap penalties between routines and fixedEvents and between two routines (RoutineInstance::getEnd is a simple helper that adds `duration` to `start`):\r\n```java\r\nprivate Constraint fixedEventRoutineOverlap(ConstraintFactory constraintFactory) {\r\n  return constraintFactory.forEach(FixedEvent.class)\r\n        .join(\r\n                RoutineInstance.class,\r\n                Joiners.overlapping(\r\n                  FixedEvent::getStart,\r\n                  FixedEvent::getEnd,\r\n                  RoutineInstance::getStart,\r\n                  RoutineInstance::getEnd\r\n                ))\r\n        .penalize(HardSoftLongScore.ONE_HARD)\r\n        .asConstraint(&quot;FixedEvent-Routine overlap&quot;);\r\n}\r\n\r\nprivate Constraint routinesOverlap(ConstraintFactory constraintFactory) {\r\n  return constraintFactory.forEach(RoutineInstance.class)\r\n        .join(\r\n                RoutineInstance.class,\r\n                Joiners.overlapping(\r\n                  RoutineInstance::getStart,\r\n                  RoutineInstance::getEnd\r\n                ),\r\n                Joiners.filtering((a, b) -&gt; a.getConfiguration().getId() != b.getConfiguration().getId() || a.getInstanceIndex() != b.getInstanceIndex())\r\n          ).penalize(HardSoftLongScore.ONE_HARD)\r\n          .asConstraint(&quot;Routines overlap&quot;);\r\n}\r\n```\r\n\r\n... and soft constraints maximizing the count of scheduled routines and the routine durations.\r\n```java\r\nprivate Constraint maximizeRoutinesScheduled(ConstraintFactory constraintFactory) {\r\n  return constraintFactory.forEach(RoutineInstance.class)\r\n          .filter(RoutineInstance::isScheduled)\r\n          .reward(HardSoftLongScore.ONE_SOFT)\r\n          .asConstraint(&quot;Maximize Routines scheduled&quot;);\r\n}\r\n\r\nprivate Constraint maximizeRoutineDurations(ConstraintFactory constraintFactory) {\r\n  return constraintFactory.forEach(RoutineInstance.class)\r\n          .filter(RoutineInstance::isScheduled)\r\n          .reward(HardSoftLongScore.ONE_SOFT)\r\n          .asConstraint(&quot;Maximize Routine durations&quot;);\r\n}\r\n```\r\n\r\nFor now, I&#39;m just testing with a simple setup of 3 fixed events and one routine configuration:\r\n```java\r\nRoutineConfiguration routine1 = new RoutineConfiguration(UUID.randomUUID(), 1, Duration.ofMinutes(30), Duration.ofHours(2), 2, List.of(\r\n        new TimeRange(LocalDateTime.of(2023, 7, 4, 9, 0), LocalDateTime.of(2023, 7, 4, 18, 0)),\r\n        new TimeRange(LocalDateTime.of(2023, 7, 5, 9, 0), LocalDateTime.of(2023, 7, 5, 18, 0))\r\n));\r\n```\r\nJust running this with the default optimization settings yields me a result, however it is not optimal (I expect one instance at 11-12:30 4/7/23, the other at 9:00-11:00 5/7/23):\r\n```text\r\nSolved schedule: Schedule{fixedEvents=[FixedEvent{start=2023-07-04T10:00, end=2023-07-04T11:00}, FixedEvent{start=2023-07-04T12:30, end=2023-07-04T16:30}, FixedEvent{start=2023-07-05T12:00, end=2023-07-05T18:00}], routineInstances=[RoutineInstance{configurationId=&#39;43b28b84-9785-4904-b77d-1cb52a8cae4a&#39;, instanceIndex=0, start=2023-07-05T09:55, duration=7200}, RoutineInstance{configurationId=&#39;43b28b84-9785-4904-b77d-1cb52a8cae4a&#39;, instanceIndex=1, start=2023-07-04T16:45, duration=3000}], score=0hard/10202soft}\r\nExplanation: Explanation of score (0hard/10202soft):\r\n    Constraint match totals:\r\n        2soft: constraint (Maximize Routines scheduled) has 2 matches:\r\n            1soft: justifications ([RoutineInstance{configurationId=&#39;43b28b84-9785-4904-b77d-1cb52a8cae4a&#39;, instanceIndex=0, start=2023-07-05T09:55, duration=7200}])\r\n            1soft: justifications ([RoutineInstance{configurationId=&#39;43b28b84-9785-4904-b77d-1cb52a8cae4a&#39;, instanceIndex=1, start=2023-07-04T16:45, duration=3000}])\r\n        10200soft: constraint (Maximize Routine durations) has 2 matches:\r\n            3000soft: justifications ([RoutineInstance{configurationId=&#39;43b28b84-9785-4904-b77d-1cb52a8cae4a&#39;, instanceIndex=1, start=2023-07-04T16:45, duration=3000}])\r\n            7200soft: justifications ([RoutineInstance{configurationId=&#39;43b28b84-9785-4904-b77d-1cb52a8cae4a&#39;, instanceIndex=0, start=2023-07-05T09:55, duration=7200}])\r\n    Indictments:\r\n        3001soft: indicted object (RoutineInstance{configurationId=&#39;43b28b84-9785-4904-b77d-1cb52a8cae4a&#39;, instanceIndex=1, start=2023-07-04T16:45, duration=3000}) has 2 matches:\r\n            1soft: constraint (Maximize Routines scheduled)\r\n            3000soft: constraint (Maximize Routine durations)\r\n        7201soft: indicted object (RoutineInstance{configurationId=&#39;43b28b84-9785-4904-b77d-1cb52a8cae4a&#39;, instanceIndex=0, start=2023-07-05T09:55, duration=7200}) has 2 matches:\r\n            1soft: constraint (Maximize Routines scheduled)\r\n            7200soft: constraint (Maximize Routine durations)\r\n\r\n```\r\n\r\nI get a result reliably, however I assume it just finds it randomly, hence the random start times.\r\n\r\nOne solution I tried, was adding a soft constraint to minimize start times:\r\n```java\r\nprivate Constraint minimizeRoutineStartTimes(ConstraintFactory constraintFactory) {\r\n    return constraintFactory.forEach(RoutineInstance.class)\r\n            .filter(RoutineInstance::isScheduled)\r\n            .penalizeLong(HardSoftLongScore.ONE_SOFT, debugConstraint(&quot;Minimize Routine start times SOFT-&quot;, r -&gt; {\r\n              if (r.getConfiguration().getEarliestPossibleStart() == null) return 0;\r\n              return ChronoUnit.SECONDS.between(r.getConfiguration().getEarliestPossibleStart(), r.getStart());\r\n            }))\r\n            .asConstraint(&quot;Minimize Routine start times&quot;);\r\n}\r\n```\r\nThe other one, was using sorted valueSelectors for start and duration (since this would mean - by my interpretation - that the solver would first try the lowest start time, highest duration, 2nd lowest start time, 2nd highest duration and so on).\r\nUsing this solver configuration:\r\n\r\n```xml\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;solver xmlns=&quot;https://timefold.ai/xsd/solver&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n        xsi:schemaLocation=&quot;https://timefold.ai/xsd/solver https://timefold.ai/xsd/solver/solver.xsd&quot;&gt;\r\n    &lt;solutionClass&gt;org.lucatk.tempus.scheduler.Schedule&lt;/solutionClass&gt;\r\n    &lt;entityClass&gt;org.lucatk.tempus.domain.RoutineInstance&lt;/entityClass&gt;\r\n\r\n    &lt;scoreDirectorFactory&gt;\r\n        &lt;constraintProviderClass&gt;org.lucatk.tempus.scheduler.ScheduleConstraintProvider&lt;/constraintProviderClass&gt;\r\n    &lt;/scoreDirectorFactory&gt;\r\n\r\n    &lt;termination&gt;\r\n        &lt;secondsSpentLimit&gt;60&lt;/secondsSpentLimit&gt;\r\n    &lt;/termination&gt;\r\n\r\n    &lt;constructionHeuristic&gt;\r\n        &lt;queuedEntityPlacer&gt;\r\n            &lt;unionMoveSelector&gt;\r\n                &lt;changeMoveSelector&gt;\r\n                    &lt;entitySelector&gt;\r\n                        &lt;entityClass&gt;org.lucatk.tempus.domain.RoutineInstance&lt;/entityClass&gt;\r\n                    &lt;/entitySelector&gt;\r\n                    &lt;valueSelector variableName=&quot;start&quot;&gt;\r\n                        &lt;cacheType&gt;STEP&lt;/cacheType&gt;\r\n                        &lt;selectionOrder&gt;SORTED&lt;/selectionOrder&gt;\r\n                        &lt;sorterComparatorClass&gt;org.lucatk.tempus.scheduler.EarliestStartComparator&lt;/sorterComparatorClass&gt;\r\n                    &lt;/valueSelector&gt;\r\n                &lt;/changeMoveSelector&gt;\r\n                &lt;changeMoveSelector&gt;\r\n                    &lt;entitySelector&gt;\r\n                        &lt;entityClass&gt;org.lucatk.tempus.domain.RoutineInstance&lt;/entityClass&gt;\r\n                    &lt;/entitySelector&gt;\r\n                    &lt;valueSelector variableName=&quot;duration&quot;&gt;\r\n                        &lt;cacheType&gt;STEP&lt;/cacheType&gt;\r\n                        &lt;selectionOrder&gt;SORTED&lt;/selectionOrder&gt;\r\n                        &lt;sorterComparatorClass&gt;org.lucatk.tempus.scheduler.LongestDurationComparator&lt;/sorterComparatorClass&gt;\r\n                    &lt;/valueSelector&gt;\r\n                &lt;/changeMoveSelector&gt;\r\n            &lt;/unionMoveSelector&gt;\r\n        &lt;/queuedEntityPlacer&gt;\r\n    &lt;/constructionHeuristic&gt;\r\n\r\n    &lt;localSearch&gt;\r\n        &lt;unionMoveSelector&gt;\r\n            &lt;changeMoveSelector&gt;\r\n                &lt;entitySelector&gt;\r\n                    &lt;entityClass&gt;org.lucatk.tempus.domain.RoutineInstance&lt;/entityClass&gt;\r\n                &lt;/entitySelector&gt;\r\n                &lt;valueSelector variableName=&quot;start&quot;&gt;\r\n                    &lt;cacheType&gt;STEP&lt;/cacheType&gt;\r\n                    &lt;selectionOrder&gt;SORTED&lt;/selectionOrder&gt;\r\n                    &lt;sorterComparatorClass&gt;org.lucatk.tempus.scheduler.EarliestStartComparator&lt;/sorterComparatorClass&gt;\r\n                &lt;/valueSelector&gt;\r\n            &lt;/changeMoveSelector&gt;\r\n            &lt;changeMoveSelector&gt;\r\n                &lt;entitySelector&gt;\r\n                    &lt;entityClass&gt;org.lucatk.tempus.domain.RoutineInstance&lt;/entityClass&gt;\r\n                &lt;/entitySelector&gt;\r\n                &lt;valueSelector variableName=&quot;duration&quot;&gt;\r\n                    &lt;cacheType&gt;STEP&lt;/cacheType&gt;\r\n                    &lt;selectionOrder&gt;SORTED&lt;/selectionOrder&gt;\r\n                    &lt;sorterComparatorClass&gt;org.lucatk.tempus.scheduler.LongestDurationComparator&lt;/sorterComparatorClass&gt;\r\n                &lt;/valueSelector&gt;\r\n            &lt;/changeMoveSelector&gt;\r\n        &lt;/unionMoveSelector&gt;\r\n    &lt;/localSearch&gt;\r\n&lt;/solver&gt;\r\n```\r\n\r\nHowever, both approaches just result in the solver running infinitely.\r\nWith the minimization constraint, I can&#39;t really identify what it&#39;s doing (just random steps), however with the valueSelector approach, it seems like it&#39;s always cycling the first two values of the ranges instead of &quot;remembering&quot; the value didn&#39;t provide a solution.\r\n\r\nSo, my problem is, I set up the solver to the best of my abilities, but I am not able to pinpoint what issues my configuration could have so as to not reach a valid solution.\r\n","title":"Configuration issues when generating schedule of flexible routines without overlapping other events, when optimizing on specific constraints","body":"<p>First of all, sorry for this long ass question, but I am trying to include all relevant facts for getting accurate help with my configuration. If yet I am missing something, I'm happy to clarify!</p>\n<p>I’m trying to use Timefold to schedule user-created routines into a calendar repeatedly, avoiding clashes with existing fixed events in the calendar.</p>\n<p>The fixed events have set <code>start</code> and <code>end</code> dates and are problem facts.</p>\n<p>The routines to be scheduled are supposed to be somewhat flexible so we can create a schedule even if the calendar is already quite full with fixed events. For this, the routine configurations have the problem facts <code>minDuration</code> and <code>maxDuration</code>, and given <code>timeRanges</code> in which they can be scheduled, e.g. <code>Monday 12-5pm</code>, <code>Tuesday 9-3pm</code>, <code>Friday 12-9pm</code>. Nonetheless this doesn't mean the routine should be scheduled every Monday, Tuesday and Friday during these times, but rather once a week in between any one of the <code>timeRanges</code>.\nTherefore what I want to solve for are <code>start</code> and <code>duration</code>/<code>end</code> (though I discovered I can model the constraints more easily if I use duration) problem variables for a list of <code>routines</code> (planning entities).</p>\n<p>The value range providers I use are bound on the entities, as they differ based on the routine configuration. The <code>start</code> VRP is a <code>CompositeCountableValueRange</code> joining all start timestamps of the time ranges.\nThe <code>duration</code> VRP creates a Long VR between <code>minDuration</code> and <code>maxDuration</code>. Both valueRangeProviders have a 5 minute increment, because I don't want routines to start at e.g. 11:38 and don't need minute granularity.</p>\n<p>I have setup a hard penalty for partially scheduled routines (only start OR duration set), hard overlap penalties between routines and fixedEvents and between two routines (RoutineInstance::getEnd is a simple helper that adds <code>duration</code> to <code>start</code>):</p>\n<pre class=\"lang-java prettyprint-override\"><code>private Constraint fixedEventRoutineOverlap(ConstraintFactory constraintFactory) {\n  return constraintFactory.forEach(FixedEvent.class)\n        .join(\n                RoutineInstance.class,\n                Joiners.overlapping(\n                  FixedEvent::getStart,\n                  FixedEvent::getEnd,\n                  RoutineInstance::getStart,\n                  RoutineInstance::getEnd\n                ))\n        .penalize(HardSoftLongScore.ONE_HARD)\n        .asConstraint(&quot;FixedEvent-Routine overlap&quot;);\n}\n\nprivate Constraint routinesOverlap(ConstraintFactory constraintFactory) {\n  return constraintFactory.forEach(RoutineInstance.class)\n        .join(\n                RoutineInstance.class,\n                Joiners.overlapping(\n                  RoutineInstance::getStart,\n                  RoutineInstance::getEnd\n                ),\n                Joiners.filtering((a, b) -&gt; a.getConfiguration().getId() != b.getConfiguration().getId() || a.getInstanceIndex() != b.getInstanceIndex())\n          ).penalize(HardSoftLongScore.ONE_HARD)\n          .asConstraint(&quot;Routines overlap&quot;);\n}\n</code></pre>\n<p>... and soft constraints maximizing the count of scheduled routines and the routine durations.</p>\n<pre class=\"lang-java prettyprint-override\"><code>private Constraint maximizeRoutinesScheduled(ConstraintFactory constraintFactory) {\n  return constraintFactory.forEach(RoutineInstance.class)\n          .filter(RoutineInstance::isScheduled)\n          .reward(HardSoftLongScore.ONE_SOFT)\n          .asConstraint(&quot;Maximize Routines scheduled&quot;);\n}\n\nprivate Constraint maximizeRoutineDurations(ConstraintFactory constraintFactory) {\n  return constraintFactory.forEach(RoutineInstance.class)\n          .filter(RoutineInstance::isScheduled)\n          .reward(HardSoftLongScore.ONE_SOFT)\n          .asConstraint(&quot;Maximize Routine durations&quot;);\n}\n</code></pre>\n<p>For now, I'm just testing with a simple setup of 3 fixed events and one routine configuration:</p>\n<pre class=\"lang-java prettyprint-override\"><code>RoutineConfiguration routine1 = new RoutineConfiguration(UUID.randomUUID(), 1, Duration.ofMinutes(30), Duration.ofHours(2), 2, List.of(\n        new TimeRange(LocalDateTime.of(2023, 7, 4, 9, 0), LocalDateTime.of(2023, 7, 4, 18, 0)),\n        new TimeRange(LocalDateTime.of(2023, 7, 5, 9, 0), LocalDateTime.of(2023, 7, 5, 18, 0))\n));\n</code></pre>\n<p>Just running this with the default optimization settings yields me a result, however it is not optimal (I expect one instance at 11-12:30 4/7/23, the other at 9:00-11:00 5/7/23):</p>\n<pre><code>Solved schedule: Schedule{fixedEvents=[FixedEvent{start=2023-07-04T10:00, end=2023-07-04T11:00}, FixedEvent{start=2023-07-04T12:30, end=2023-07-04T16:30}, FixedEvent{start=2023-07-05T12:00, end=2023-07-05T18:00}], routineInstances=[RoutineInstance{configurationId='43b28b84-9785-4904-b77d-1cb52a8cae4a', instanceIndex=0, start=2023-07-05T09:55, duration=7200}, RoutineInstance{configurationId='43b28b84-9785-4904-b77d-1cb52a8cae4a', instanceIndex=1, start=2023-07-04T16:45, duration=3000}], score=0hard/10202soft}\nExplanation: Explanation of score (0hard/10202soft):\n    Constraint match totals:\n        2soft: constraint (Maximize Routines scheduled) has 2 matches:\n            1soft: justifications ([RoutineInstance{configurationId='43b28b84-9785-4904-b77d-1cb52a8cae4a', instanceIndex=0, start=2023-07-05T09:55, duration=7200}])\n            1soft: justifications ([RoutineInstance{configurationId='43b28b84-9785-4904-b77d-1cb52a8cae4a', instanceIndex=1, start=2023-07-04T16:45, duration=3000}])\n        10200soft: constraint (Maximize Routine durations) has 2 matches:\n            3000soft: justifications ([RoutineInstance{configurationId='43b28b84-9785-4904-b77d-1cb52a8cae4a', instanceIndex=1, start=2023-07-04T16:45, duration=3000}])\n            7200soft: justifications ([RoutineInstance{configurationId='43b28b84-9785-4904-b77d-1cb52a8cae4a', instanceIndex=0, start=2023-07-05T09:55, duration=7200}])\n    Indictments:\n        3001soft: indicted object (RoutineInstance{configurationId='43b28b84-9785-4904-b77d-1cb52a8cae4a', instanceIndex=1, start=2023-07-04T16:45, duration=3000}) has 2 matches:\n            1soft: constraint (Maximize Routines scheduled)\n            3000soft: constraint (Maximize Routine durations)\n        7201soft: indicted object (RoutineInstance{configurationId='43b28b84-9785-4904-b77d-1cb52a8cae4a', instanceIndex=0, start=2023-07-05T09:55, duration=7200}) has 2 matches:\n            1soft: constraint (Maximize Routines scheduled)\n            7200soft: constraint (Maximize Routine durations)\n\n</code></pre>\n<p>I get a result reliably, however I assume it just finds it randomly, hence the random start times.</p>\n<p>One solution I tried, was adding a soft constraint to minimize start times:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private Constraint minimizeRoutineStartTimes(ConstraintFactory constraintFactory) {\n    return constraintFactory.forEach(RoutineInstance.class)\n            .filter(RoutineInstance::isScheduled)\n            .penalizeLong(HardSoftLongScore.ONE_SOFT, debugConstraint(&quot;Minimize Routine start times SOFT-&quot;, r -&gt; {\n              if (r.getConfiguration().getEarliestPossibleStart() == null) return 0;\n              return ChronoUnit.SECONDS.between(r.getConfiguration().getEarliestPossibleStart(), r.getStart());\n            }))\n            .asConstraint(&quot;Minimize Routine start times&quot;);\n}\n</code></pre>\n<p>The other one, was using sorted valueSelectors for start and duration (since this would mean - by my interpretation - that the solver would first try the lowest start time, highest duration, 2nd lowest start time, 2nd highest duration and so on).\nUsing this solver configuration:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;solver xmlns=&quot;https://timefold.ai/xsd/solver&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n        xsi:schemaLocation=&quot;https://timefold.ai/xsd/solver https://timefold.ai/xsd/solver/solver.xsd&quot;&gt;\n    &lt;solutionClass&gt;org.lucatk.tempus.scheduler.Schedule&lt;/solutionClass&gt;\n    &lt;entityClass&gt;org.lucatk.tempus.domain.RoutineInstance&lt;/entityClass&gt;\n\n    &lt;scoreDirectorFactory&gt;\n        &lt;constraintProviderClass&gt;org.lucatk.tempus.scheduler.ScheduleConstraintProvider&lt;/constraintProviderClass&gt;\n    &lt;/scoreDirectorFactory&gt;\n\n    &lt;termination&gt;\n        &lt;secondsSpentLimit&gt;60&lt;/secondsSpentLimit&gt;\n    &lt;/termination&gt;\n\n    &lt;constructionHeuristic&gt;\n        &lt;queuedEntityPlacer&gt;\n            &lt;unionMoveSelector&gt;\n                &lt;changeMoveSelector&gt;\n                    &lt;entitySelector&gt;\n                        &lt;entityClass&gt;org.lucatk.tempus.domain.RoutineInstance&lt;/entityClass&gt;\n                    &lt;/entitySelector&gt;\n                    &lt;valueSelector variableName=&quot;start&quot;&gt;\n                        &lt;cacheType&gt;STEP&lt;/cacheType&gt;\n                        &lt;selectionOrder&gt;SORTED&lt;/selectionOrder&gt;\n                        &lt;sorterComparatorClass&gt;org.lucatk.tempus.scheduler.EarliestStartComparator&lt;/sorterComparatorClass&gt;\n                    &lt;/valueSelector&gt;\n                &lt;/changeMoveSelector&gt;\n                &lt;changeMoveSelector&gt;\n                    &lt;entitySelector&gt;\n                        &lt;entityClass&gt;org.lucatk.tempus.domain.RoutineInstance&lt;/entityClass&gt;\n                    &lt;/entitySelector&gt;\n                    &lt;valueSelector variableName=&quot;duration&quot;&gt;\n                        &lt;cacheType&gt;STEP&lt;/cacheType&gt;\n                        &lt;selectionOrder&gt;SORTED&lt;/selectionOrder&gt;\n                        &lt;sorterComparatorClass&gt;org.lucatk.tempus.scheduler.LongestDurationComparator&lt;/sorterComparatorClass&gt;\n                    &lt;/valueSelector&gt;\n                &lt;/changeMoveSelector&gt;\n            &lt;/unionMoveSelector&gt;\n        &lt;/queuedEntityPlacer&gt;\n    &lt;/constructionHeuristic&gt;\n\n    &lt;localSearch&gt;\n        &lt;unionMoveSelector&gt;\n            &lt;changeMoveSelector&gt;\n                &lt;entitySelector&gt;\n                    &lt;entityClass&gt;org.lucatk.tempus.domain.RoutineInstance&lt;/entityClass&gt;\n                &lt;/entitySelector&gt;\n                &lt;valueSelector variableName=&quot;start&quot;&gt;\n                    &lt;cacheType&gt;STEP&lt;/cacheType&gt;\n                    &lt;selectionOrder&gt;SORTED&lt;/selectionOrder&gt;\n                    &lt;sorterComparatorClass&gt;org.lucatk.tempus.scheduler.EarliestStartComparator&lt;/sorterComparatorClass&gt;\n                &lt;/valueSelector&gt;\n            &lt;/changeMoveSelector&gt;\n            &lt;changeMoveSelector&gt;\n                &lt;entitySelector&gt;\n                    &lt;entityClass&gt;org.lucatk.tempus.domain.RoutineInstance&lt;/entityClass&gt;\n                &lt;/entitySelector&gt;\n                &lt;valueSelector variableName=&quot;duration&quot;&gt;\n                    &lt;cacheType&gt;STEP&lt;/cacheType&gt;\n                    &lt;selectionOrder&gt;SORTED&lt;/selectionOrder&gt;\n                    &lt;sorterComparatorClass&gt;org.lucatk.tempus.scheduler.LongestDurationComparator&lt;/sorterComparatorClass&gt;\n                &lt;/valueSelector&gt;\n            &lt;/changeMoveSelector&gt;\n        &lt;/unionMoveSelector&gt;\n    &lt;/localSearch&gt;\n&lt;/solver&gt;\n</code></pre>\n<p>However, both approaches just result in the solver running infinitely.\nWith the minimization constraint, I can't really identify what it's doing (just random steps), however with the valueSelector approach, it seems like it's always cycling the first two values of the ranges instead of &quot;remembering&quot; the value didn't provide a solution.</p>\n<p>So, my problem is, I set up the solver to the best of my abilities, but I am not able to pinpoint what issues my configuration could have so as to not reach a valid solution.</p>\n"},{"tags":["java","docker","jvm","bamboo"],"comments":[{"owner":{"account_id":8840348,"reputation":305,"user_id":6878796,"display_name":"Paul"},"score":0,"creation_date":1689948483,"post_id":76738558,"comment_id":135289337,"body_markdown":"The error is not very readable, but it looks like it&#39;s the same as this one https://community.atlassian.com/t5/Bamboo-questions/FATAL-ERROR-Bamboo-Remote-Agent-is-loading-constently/qaq-p/1041828 In your stacktrace you have `Caused by: java.net.UnknownHostException: bamboosrv`","body":"The error is not very readable, but it looks like it&#39;s the same as this one <a href=\"https://community.atlassian.com/t5/Bamboo-questions/FATAL-ERROR-Bamboo-Remote-Agent-is-loading-constently/qaq-p/1041828\" rel=\"nofollow noreferrer\">community.atlassian.com/t5/Bamboo-questions/&hellip;</a> In your stacktrace you have <code>Caused by: java.net.UnknownHostException: bamboosrv</code>"}],"owner":{"account_id":21993592,"reputation":41,"user_id":16266520,"display_name":"ykursatkara"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":192,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689947104,"creation_date":1689947104,"question_id":76738558,"body_markdown":"I am trying to run the Bamboo agent in the newly set up server. However, when I start running it, it keeps repeating the same things over and over again. And at the end of all, it says &#39;JVM exited unexpectedly.&#39; Below, I am providing the log output.\r\n\r\n    \r\n\r\n&gt; INFO   | jvm 1    | 2023/07/21 14:10:57 | 2023-07-21 14:10:57,474 INFO [AgentRunnerThread] [AgentRegistrationBean] Current agent remote definition: prometaubuntu Remote agent on host prometaubuntu\r\nINFO   | jvm 1    | 2023/07/21 14:10:57 | 2023-07-21 14:10:57,489 INFO [AgentRunnerThread] [PerforceManager] Could not find system variable. If you wish to use perforce please set the location as a capability.\r\nINFO   | jvm 1    | 2023/07/21 14:10:58 | 2023-07-21 14:10:58,853 INFO [AgentRunnerThread] [AgentRegistrationBean] Registering agent on the server,\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,149 ERROR [ActiveMQ Task-1] [FailoverTransport] Failed to connect to [tcp://bamboosrv:54663?wireFormat.maxInactivityDuration=300000] after: 10 attempt(s)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,161 INFO [ActiveMQ Connection Executor: unconnected] [PooledConnectionFactory] Expiring connection ActiveMQConnection {id=ID:prometaubuntu-46739-1689937858912-1:1,clientId=ID:prometaubuntu-46739-1689937858912-0:1,started=false} on IOException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,171 WARN [AgentRunnerThread] [RemoteAgent$1] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;agentRegistrationBean&#39;: Invocation of init method failed; nested exception is org.springframework.remoting.RemoteAccessException: Could not access JMS invoker queue [queue://com.atlassian.bamboo.registrationQueue]; nested exception is javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,174 INFO [AgentRunnerThread] [SVNClientManagerFactory] Destroying SVNClientManagerFactories...\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,183 INFO [AgentRunnerThread] [QuartzScheduler] Scheduler scheduler_$_NON_CLUSTERED shutting down.\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,184 INFO [AgentRunnerThread] [QuartzScheduler] Scheduler scheduler_$_NON_CLUSTERED paused.\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,185 INFO [AgentRunnerThread] [QuartzScheduler] Scheduler scheduler_$_NON_CLUSTERED shutdown complete.\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Exiting due to fatal exception.\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | java.lang.reflect.InvocationTargetException\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.lang.reflect.Method.invoke(Method.java:498)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.atlassian.bamboo.agent.bootstrap.AgentRunner.run(AgentRunner.java:26)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.lang.Thread.run(Thread.java:750)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;agentRegistrationBean&#39;: Invocation of init method failed; nested exception is org.springframework.remoting.RemoteAccessException: Could not access JMS invoker queue [queue://com.atlassian.bamboo.registrationQueue]; nested exception is javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:139)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:414)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1763)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:593)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:847)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:877)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:549)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:144)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:95)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent$1.&lt;init&gt;(RemoteAgent.java:241)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent.initApplicationContext(RemoteAgent.java:241)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent.start(RemoteAgent.java:97)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \t... 6 more\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: org.springframework.remoting.RemoteAccessException: Could not access JMS invoker queue [queue://com.atlassian.bamboo.registrationQueue]; nested exception is javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.jms.remoting.JmsInvokerClientInterceptor.convertJmsInvokerAccessException(JmsInvokerClientInterceptor.java:432)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.jms.remoting.JmsInvokerClientInterceptor.invoke(JmsInvokerClientInterceptor.java:207)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.sun.proxy.$Proxy22.registerAgent(Unknown Source)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.atlassian.bamboo.v2.build.agent.remote.AgentRegistrationBean.registerAgent(AgentRegistrationBean.java:52)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.lang.reflect.Method.invoke(Method.java:498)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleElement.invoke(InitDestroyAnnotationBeanPostProcessor.java:363)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeInitMethods(InitDestroyAnnotationBeanPostProcessor.java:307)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:136)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \t... 22 more\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.ConnectionPool.createSession(ConnectionPool.java:162)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.PooledConnection.createSession(PooledConnection.java:167)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.jms.remoting.JmsInvokerClientInterceptor.createSession(JmsInvokerClientInterceptor.java:281)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.jms.remoting.JmsInvokerClientInterceptor.executeRequest(JmsInvokerClientInterceptor.java:250)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.jms.remoting.JmsInvokerClientInterceptor.invoke(JmsInvokerClientInterceptor.java:204)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \t... 33 more\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: javax.jms.JMSException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:72)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1421)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.ActiveMQConnection.ensureConnectionInfoSent(ActiveMQConnection.java:1486)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.ActiveMQConnection.createSession(ActiveMQConnection.java:329)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.ConnectionPool.makeSession(ConnectionPool.java:112)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.ConnectionPool$1.makeObject(ConnectionPool.java:82)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.ConnectionPool$1.makeObject(ConnectionPool.java:78)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.commons.pool2.impl.GenericKeyedObjectPool.create(GenericKeyedObjectPool.java:1073)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:348)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:271)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.ConnectionPool.createSession(ConnectionPool.java:144)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \t... 37 more\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: java.net.UnknownHostException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:184)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.net.Socket.connect(Socket.java:607)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.tcp.TcpTransport.connect(TcpTransport.java:525)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.tcp.TcpTransport.doStart(TcpTransport.java:488)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.util.ServiceSupport.start(ServiceSupport.java:55)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.AbstractInactivityMonitor.start(AbstractInactivityMonitor.java:169)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.InactivityMonitor.start(InactivityMonitor.java:52)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.TransportFilter.start(TransportFilter.java:64)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.WireFormatNegotiator.start(WireFormatNegotiator.java:72)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.failover.FailoverTransport.doReconnect(FailoverTransport.java:1017)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.failover.FailoverTransport$2.iterate(FailoverTransport.java:148)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:133)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:48)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \t... 1 more\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,226 FATAL [AgentRunnerThread] [AgentBootstrap] Exiting due to fatal exception.\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | java.lang.reflect.InvocationTargetException\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.lang.reflect.Method.invoke(Method.java:498)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.atlassian.bamboo.agent.bootstrap.AgentRunner.run(AgentRunner.java:26)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.lang.Thread.run(Thread.java:750)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;agentRegistrationBean&#39;: Invocation of init method failed; nested exception is org.springframework.remoting.RemoteAccessException: Could not access JMS invoker queue [queue://com.atlassian.bamboo.registrationQueue]; nested exception is javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:139)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:414)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1763)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:593)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:847)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:877)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:549)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:144)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:95)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent$1.&lt;init&gt;(RemoteAgent.java:241)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent.initApplicationContext(RemoteAgent.java:241)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent.start(RemoteAgent.java:97)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \t... 6 more\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: org.springframework.remoting.RemoteAccessException: Could not access JMS invoker queue [queue://com.atlassian.bamboo.registrationQueue]; nested exception is javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.jms.remoting.JmsInvokerClientInterceptor.convertJmsInvokerAccessException(JmsInvokerClientInterceptor.java:432)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.jms.remoting.JmsInvokerClientInterceptor.invoke(JmsInvokerClientInterceptor.java:207)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.sun.proxy.$Proxy22.registerAgent(Unknown Source)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat com.atlassian.bamboo.v2.build.agent.remote.AgentRegistrationBean.registerAgent(AgentRegistrationBean.java:52)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.lang.reflect.Method.invoke(Method.java:498)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleElement.invoke(InitDestroyAnnotationBeanPostProcessor.java:363)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeInitMethods(InitDestroyAnnotationBeanPostProcessor.java:307)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:136)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \t... 22 more\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.ConnectionPool.createSession(ConnectionPool.java:162)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.PooledConnection.createSession(PooledConnection.java:167)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.jms.remoting.JmsInvokerClientInterceptor.createSession(JmsInvokerClientInterceptor.java:281)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.jms.remoting.JmsInvokerClientInterceptor.executeRequest(JmsInvokerClientInterceptor.java:250)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.springframework.jms.remoting.JmsInvokerClientInterceptor.invoke(JmsInvokerClientInterceptor.java:204)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \t... 33 more\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: javax.jms.JMSException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:72)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1421)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.ActiveMQConnection.ensureConnectionInfoSent(ActiveMQConnection.java:1486)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.ActiveMQConnection.createSession(ActiveMQConnection.java:329)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.ConnectionPool.makeSession(ConnectionPool.java:112)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.ConnectionPool$1.makeObject(ConnectionPool.java:82)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.ConnectionPool$1.makeObject(ConnectionPool.java:78)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.commons.pool2.impl.GenericKeyedObjectPool.create(GenericKeyedObjectPool.java:1073)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:348)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:271)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.jms.pool.ConnectionPool.createSession(ConnectionPool.java:144)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \t... 37 more\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: java.net.UnknownHostException: bamboosrv\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:184)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.net.Socket.connect(Socket.java:607)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.tcp.TcpTransport.connect(TcpTransport.java:525)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.tcp.TcpTransport.doStart(TcpTransport.java:488)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.util.ServiceSupport.start(ServiceSupport.java:55)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.AbstractInactivityMonitor.start(AbstractInactivityMonitor.java:169)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.InactivityMonitor.start(InactivityMonitor.java:52)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.TransportFilter.start(TransportFilter.java:64)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.WireFormatNegotiator.start(WireFormatNegotiator.java:72)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.failover.FailoverTransport.doReconnect(FailoverTransport.java:1017)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.transport.failover.FailoverTransport$2.iterate(FailoverTransport.java:148)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:133)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:48)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\nINFO   | jvm 1    | 2023/07/21 14:15:14 | \t... 1 more\r\nERROR  | wrapper  | 2023/07/21 14:15:14 | JVM exited unexpectedly.\r\nSTATUS | wrapper  | 2023/07/21 14:15:20 | JVM process is gone.","title":"Bamboo agent JVM exited unexpectedly","body":"<p>I am trying to run the Bamboo agent in the newly set up server. However, when I start running it, it keeps repeating the same things over and over again. And at the end of all, it says 'JVM exited unexpectedly.' Below, I am providing the log output.</p>\n<blockquote>\n<p>INFO   | jvm 1    | 2023/07/21 14:10:57 | 2023-07-21 14:10:57,474 INFO [AgentRunnerThread] [AgentRegistrationBean] Current agent remote definition: prometaubuntu Remote agent on host prometaubuntu\nINFO   | jvm 1    | 2023/07/21 14:10:57 | 2023-07-21 14:10:57,489 INFO [AgentRunnerThread] [PerforceManager] Could not find system variable. If you wish to use perforce please set the location as a capability.\nINFO   | jvm 1    | 2023/07/21 14:10:58 | 2023-07-21 14:10:58,853 INFO [AgentRunnerThread] [AgentRegistrationBean] Registering agent on the server,\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,149 ERROR [ActiveMQ Task-1] [FailoverTransport] Failed to connect to [tcp://bamboosrv:54663?wireFormat.maxInactivityDuration=300000] after: 10 attempt(s)\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,161 INFO [ActiveMQ Connection Executor: unconnected] [PooledConnectionFactory] Expiring connection ActiveMQConnection {id=ID:prometaubuntu-46739-1689937858912-1:1,clientId=ID:prometaubuntu-46739-1689937858912-0:1,started=false} on IOException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,171 WARN [AgentRunnerThread] [RemoteAgent$1] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'agentRegistrationBean': Invocation of init method failed; nested exception is org.springframework.remoting.RemoteAccessException: Could not access JMS invoker queue [queue://com.atlassian.bamboo.registrationQueue]; nested exception is javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,174 INFO [AgentRunnerThread] [SVNClientManagerFactory] Destroying SVNClientManagerFactories...\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,183 INFO [AgentRunnerThread] [QuartzScheduler] Scheduler scheduler_$<em>NON_CLUSTERED shutting down.\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,184 INFO [AgentRunnerThread] [QuartzScheduler] Scheduler scheduler</em>$<em>NON_CLUSTERED paused.\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,185 INFO [AgentRunnerThread] [QuartzScheduler] Scheduler scheduler</em>$_NON_CLUSTERED shutdown complete.\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Exiting due to fatal exception.\nINFO   | jvm 1    | 2023/07/21 14:15:14 | java.lang.reflect.InvocationTargetException\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.lang.reflect.Method.invoke(Method.java:498)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.atlassian.bamboo.agent.bootstrap.AgentRunner.run(AgentRunner.java:26)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.lang.Thread.run(Thread.java:750)\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'agentRegistrationBean': Invocation of init method failed; nested exception is org.springframework.remoting.RemoteAccessException: Could not access JMS invoker queue [queue://com.atlassian.bamboo.registrationQueue]; nested exception is javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:139)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:414)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1763)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:593)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:847)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:877)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:549)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.context.support.ClassPathXmlApplicationContext.(ClassPathXmlApplicationContext.java:144)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.context.support.ClassPathXmlApplicationContext.(ClassPathXmlApplicationContext.java:95)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent$1.(RemoteAgent.java:241)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent.initApplicationContext(RemoteAgent.java:241)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent.start(RemoteAgent.java:97)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   ... 6 more\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: org.springframework.remoting.RemoteAccessException: Could not access JMS invoker queue [queue://com.atlassian.bamboo.registrationQueue]; nested exception is javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.jms.remoting.JmsInvokerClientInterceptor.convertJmsInvokerAccessException(JmsInvokerClientInterceptor.java:432)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.jms.remoting.JmsInvokerClientInterceptor.invoke(JmsInvokerClientInterceptor.java:207)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.sun.proxy.$Proxy22.registerAgent(Unknown Source)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.atlassian.bamboo.v2.build.agent.remote.AgentRegistrationBean.registerAgent(AgentRegistrationBean.java:52)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.lang.reflect.Method.invoke(Method.java:498)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleElement.invoke(InitDestroyAnnotationBeanPostProcessor.java:363)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeInitMethods(InitDestroyAnnotationBeanPostProcessor.java:307)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:136)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   ... 22 more\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.ConnectionPool.createSession(ConnectionPool.java:162)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.PooledConnection.createSession(PooledConnection.java:167)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.jms.remoting.JmsInvokerClientInterceptor.createSession(JmsInvokerClientInterceptor.java:281)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.jms.remoting.JmsInvokerClientInterceptor.executeRequest(JmsInvokerClientInterceptor.java:250)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.jms.remoting.JmsInvokerClientInterceptor.invoke(JmsInvokerClientInterceptor.java:204)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   ... 33 more\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: javax.jms.JMSException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:72)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1421)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.ActiveMQConnection.ensureConnectionInfoSent(ActiveMQConnection.java:1486)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.ActiveMQConnection.createSession(ActiveMQConnection.java:329)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.ConnectionPool.makeSession(ConnectionPool.java:112)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.ConnectionPool$1.makeObject(ConnectionPool.java:82)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.ConnectionPool$1.makeObject(ConnectionPool.java:78)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.commons.pool2.impl.GenericKeyedObjectPool.create(GenericKeyedObjectPool.java:1073)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:348)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:271)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.ConnectionPool.createSession(ConnectionPool.java:144)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   ... 37 more\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: java.net.UnknownHostException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:184)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.net.Socket.connect(Socket.java:607)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.tcp.TcpTransport.connect(TcpTransport.java:525)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.tcp.TcpTransport.doStart(TcpTransport.java:488)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.util.ServiceSupport.start(ServiceSupport.java:55)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.AbstractInactivityMonitor.start(AbstractInactivityMonitor.java:169)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.InactivityMonitor.start(InactivityMonitor.java:52)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.TransportFilter.start(TransportFilter.java:64)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.WireFormatNegotiator.start(WireFormatNegotiator.java:72)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.failover.FailoverTransport.doReconnect(FailoverTransport.java:1017)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.failover.FailoverTransport$2.iterate(FailoverTransport.java:148)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:133)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:48)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   ... 1 more\nINFO   | jvm 1    | 2023/07/21 14:15:14 | 2023-07-21 14:15:14,226 FATAL [AgentRunnerThread] [AgentBootstrap] Exiting due to fatal exception.\nINFO   | jvm 1    | 2023/07/21 14:15:14 | java.lang.reflect.InvocationTargetException\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.lang.reflect.Method.invoke(Method.java:498)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.atlassian.bamboo.agent.bootstrap.AgentRunner.run(AgentRunner.java:26)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.lang.Thread.run(Thread.java:750)\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'agentRegistrationBean': Invocation of init method failed; nested exception is org.springframework.remoting.RemoteAccessException: Could not access JMS invoker queue [queue://com.atlassian.bamboo.registrationQueue]; nested exception is javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:139)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:414)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1763)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:593)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:515)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:847)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:877)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:549)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.context.support.ClassPathXmlApplicationContext.(ClassPathXmlApplicationContext.java:144)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.context.support.ClassPathXmlApplicationContext.(ClassPathXmlApplicationContext.java:95)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent$1.(RemoteAgent.java:241)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent.initApplicationContext(RemoteAgent.java:241)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.atlassian.bamboo.v2.build.agent.remote.RemoteAgent.start(RemoteAgent.java:97)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   ... 6 more\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: org.springframework.remoting.RemoteAccessException: Could not access JMS invoker queue [queue://com.atlassian.bamboo.registrationQueue]; nested exception is javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.jms.remoting.JmsInvokerClientInterceptor.convertJmsInvokerAccessException(JmsInvokerClientInterceptor.java:432)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.jms.remoting.JmsInvokerClientInterceptor.invoke(JmsInvokerClientInterceptor.java:207)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.sun.proxy.$Proxy22.registerAgent(Unknown Source)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at com.atlassian.bamboo.v2.build.agent.remote.AgentRegistrationBean.registerAgent(AgentRegistrationBean.java:52)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.lang.reflect.Method.invoke(Method.java:498)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleElement.invoke(InitDestroyAnnotationBeanPostProcessor.java:363)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeInitMethods(InitDestroyAnnotationBeanPostProcessor.java:307)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:136)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   ... 22 more\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: javax.jms.IllegalStateException: javax.jms.JMSException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.ConnectionPool.createSession(ConnectionPool.java:162)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.PooledConnection.createSession(PooledConnection.java:167)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.jms.remoting.JmsInvokerClientInterceptor.createSession(JmsInvokerClientInterceptor.java:281)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.jms.remoting.JmsInvokerClientInterceptor.executeRequest(JmsInvokerClientInterceptor.java:250)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.springframework.jms.remoting.JmsInvokerClientInterceptor.invoke(JmsInvokerClientInterceptor.java:204)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   ... 33 more\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: javax.jms.JMSException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:72)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1421)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.ActiveMQConnection.ensureConnectionInfoSent(ActiveMQConnection.java:1486)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.ActiveMQConnection.createSession(ActiveMQConnection.java:329)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.ConnectionPool.makeSession(ConnectionPool.java:112)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.ConnectionPool$1.makeObject(ConnectionPool.java:82)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.ConnectionPool$1.makeObject(ConnectionPool.java:78)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.commons.pool2.impl.GenericKeyedObjectPool.create(GenericKeyedObjectPool.java:1073)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:348)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.commons.pool2.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:271)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.jms.pool.ConnectionPool.createSession(ConnectionPool.java:144)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   ... 37 more\nINFO   | jvm 1    | 2023/07/21 14:15:14 | Caused by: java.net.UnknownHostException: bamboosrv\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:184)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.net.Socket.connect(Socket.java:607)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.tcp.TcpTransport.connect(TcpTransport.java:525)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.tcp.TcpTransport.doStart(TcpTransport.java:488)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.util.ServiceSupport.start(ServiceSupport.java:55)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.AbstractInactivityMonitor.start(AbstractInactivityMonitor.java:169)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.InactivityMonitor.start(InactivityMonitor.java:52)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.TransportFilter.start(TransportFilter.java:64)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.WireFormatNegotiator.start(WireFormatNegotiator.java:72)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.failover.FailoverTransport.doReconnect(FailoverTransport.java:1017)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.transport.failover.FailoverTransport$2.iterate(FailoverTransport.java:148)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:133)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:48)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\nINFO   | jvm 1    | 2023/07/21 14:15:14 |   ... 1 more\nERROR  | wrapper  | 2023/07/21 14:15:14 | JVM exited unexpectedly.\nSTATUS | wrapper  | 2023/07/21 14:15:20 | JVM process is gone.</p>\n</blockquote>\n"},{"tags":["java","mongodb","spring-data"],"comments":[{"owner":{"account_id":2843470,"reputation":4620,"user_id":2442526,"display_name":"xtratic"},"score":0,"creation_date":1566479878,"post_id":57610243,"comment_id":101675833,"body_markdown":"My guess is that the UserDocument has a definition requiring certain fields to make a key or id but those are not present. The solution may be to check those values are set on the UserDocument","body":"My guess is that the UserDocument has a definition requiring certain fields to make a key or id but those are not present. The solution may be to check those values are set on the UserDocument"},{"owner":{"account_id":1760367,"reputation":4807,"user_id":1607660,"accept_rate":70,"display_name":"FazoM"},"score":0,"creation_date":1566480694,"post_id":57610243,"comment_id":101676357,"body_markdown":"Id is autogenerated, I will update question","body":"Id is autogenerated, I will update question"},{"owner":{"account_id":2843470,"reputation":4620,"user_id":2442526,"display_name":"xtratic"},"score":0,"creation_date":1566481913,"post_id":57610243,"comment_id":101677076,"body_markdown":"Perhaps make sure you have a public getter/setter for your id, also possibly annotate it with  `@GeneratedValue(...)`","body":"Perhaps make sure you have a public getter/setter for your id, also possibly annotate it with  <code>@GeneratedValue(...)</code>"}],"answers":[{"tags":[],"owner":{"account_id":1760367,"reputation":4807,"user_id":1607660,"accept_rate":70,"display_name":"FazoM"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1566484256,"creation_date":1566484256,"answer_id":57611686,"question_id":57610243,"body_markdown":"For anyone that is struggling with this problem - in my case it was problem with `mapstruct` `Mapper` that as a side effect was populating fields in super class:\r\n\r\n    import org.springframework.data.annotation.CreatedDate;\r\n    import org.springframework.data.annotation.LastModifiedDate;\r\n    import org.springframework.data.annotation.Version;\r\n\r\n    @Data\r\n    @NoArgsConstructor(access = AccessLevel.PROTECTED)\r\n    @AllArgsConstructor(access = AccessLevel.PROTECTED)\r\n    @Accessors(chain = true)\r\n    @SuperBuilder\r\n    public abstract class BaseDocument&lt;ID extends Serializable&gt; implements Persistable&lt;ID&gt; {\r\n    \r\n      @Version\r\n      private Long revision;\r\n    \r\n      @CreatedDate\r\n      private Instant createdDateTime;\r\n    \r\n      @LastModifiedDate\r\n      private Instant lastModifiedDateTime;\r\n    \r\n      @Override\r\n      public boolean isNew() {\r\n        return isNull(createdDateTime);\r\n      }\r\n    }\r\n\r\nSo make sure these fields are `null` when you are saving a new entity!","title":"Could not obtain identifier from","body":"<p>For anyone that is struggling with this problem - in my case it was problem with <code>mapstruct</code> <code>Mapper</code> that as a side effect was populating fields in super class:</p>\n\n<pre><code>import org.springframework.data.annotation.CreatedDate;\nimport org.springframework.data.annotation.LastModifiedDate;\nimport org.springframework.data.annotation.Version;\n\n@Data\n@NoArgsConstructor(access = AccessLevel.PROTECTED)\n@AllArgsConstructor(access = AccessLevel.PROTECTED)\n@Accessors(chain = true)\n@SuperBuilder\npublic abstract class BaseDocument&lt;ID extends Serializable&gt; implements Persistable&lt;ID&gt; {\n\n  @Version\n  private Long revision;\n\n  @CreatedDate\n  private Instant createdDateTime;\n\n  @LastModifiedDate\n  private Instant lastModifiedDateTime;\n\n  @Override\n  public boolean isNew() {\n    return isNull(createdDateTime);\n  }\n}\n</code></pre>\n\n<p>So make sure these fields are <code>null</code> when you are saving a new entity!</p>\n"},{"tags":[],"owner":{"account_id":3253983,"reputation":1481,"user_id":2743585,"display_name":"wi2ard"},"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1609272277,"creation_date":1609272277,"answer_id":65498073,"question_id":57610243,"body_markdown":"I struggled with this too. In my case, the problem was the `@Version` field in the object I was trying to save was set to 0. After I set it to null I didn&#39;t have this anymore. \r\nI noticed the methods in the trace getQueryForVersion, doSaveVersioned...\r\n\r\n```\r\njava.lang.IllegalStateException: Could not obtain identifier from .....\r\n\tat org.springframework.data.mapping.TargetAwareIdentifierAccessor.getRequiredIdentifier(TargetAwareIdentifierAccessor.java:48)\r\n\tat org.springframework.data.mongodb.core.EntityOperations$MappedEntity.getId(EntityOperations.java:527)\r\n\tat org.springframework.data.mongodb.core.EntityOperations$MappedEntity.getQueryForVersion(EntityOperations.java:556)\r\n\tat org.springframework.data.mongodb.core.MongoTemplate.doSaveVersioned(MongoTemplate.java:1383)\r\n\tat org.springframework.data.mongodb.core.MongoTemplate.save(MongoTemplate.java:1370)\r\n\tat org.springframework.data.mongodb.repository.support.SimpleMongoRepository.save(SimpleMongoRepository.java:88)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:564)\r\n```","title":"Could not obtain identifier from","body":"<p>I struggled with this too. In my case, the problem was the <code>@Version</code> field in the object I was trying to save was set to 0. After I set it to null I didn't have this anymore.\nI noticed the methods in the trace getQueryForVersion, doSaveVersioned...</p>\n<pre><code>java.lang.IllegalStateException: Could not obtain identifier from .....\n    at org.springframework.data.mapping.TargetAwareIdentifierAccessor.getRequiredIdentifier(TargetAwareIdentifierAccessor.java:48)\n    at org.springframework.data.mongodb.core.EntityOperations$MappedEntity.getId(EntityOperations.java:527)\n    at org.springframework.data.mongodb.core.EntityOperations$MappedEntity.getQueryForVersion(EntityOperations.java:556)\n    at org.springframework.data.mongodb.core.MongoTemplate.doSaveVersioned(MongoTemplate.java:1383)\n    at org.springframework.data.mongodb.core.MongoTemplate.save(MongoTemplate.java:1370)\n    at org.springframework.data.mongodb.repository.support.SimpleMongoRepository.save(SimpleMongoRepository.java:88)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:564)\n</code></pre>\n"},{"tags":[],"owner":{"account_id":13161401,"reputation":333,"user_id":9506781,"display_name":"Oskarro"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689946956,"creation_date":1689946956,"answer_id":76738539,"question_id":57610243,"body_markdown":"The problem most often occurs when you are using a Mongo database inside Spring application and you are trying to save (or overwrite) a document whose mandatory value is empty.\r\n\r\nIt is worth paying attention to the type of error that appears in the logs and check these top lines:\r\n\r\n    java.lang.IllegalStateException: Could not obtain identifier from XXX\r\n    at org.springframework.data.mapping.TargetAwareIdentifierAccessor.getRequiredIdentifier(TargetAwareIdentifierAccessor.java:48)\r\n    at org.springframework.data.mongodb.core.EntityOperations$MappedEntity.getId(EntityOperations.java:527)\r\n    at org.springframework.data.mongodb.core.EntityOperations$MappedEntity.getQueryForVersion(EntityOperations.java:556)\r\n    at org.springframework.data.mongodb.core.MongoTemplate.doSaveVersioned(MongoTemplate.java:1383)\r\n    at org.springframework.data.mongodb.core.MongoTemplate.save(MongoTemplate.java:1370)\r\n\r\nThe save method, instead of making a direct save to the database, makes an additional series of calls inside the spring mongo data library.\r\n\r\nThe **doSaveVersioned()** method catches our eye in particular. Inside this function, our service (unwittingly for us) tries to find an already existing record based on the ID to be able to verify and update the version. This of course causes an error, because such a document does not yet exist in the mongo database.\r\n\r\nThis app behavior is because one of your entities must have **@Version** annotation for one of the fields, for example:\r\n\r\n    public class YoursEntity {\r\n\r\n       protected String id;\r\n\r\n       protected String lastUpdateBy;\r\n\r\n       protected Instant lastUpdateOn;\r\n\r\n       protected String name;\r\n\r\n       @Version\r\n       protected Long version;\r\n    }\r\n\r\nTo fix this, you can do one of several things:\r\n- get rid of the **@Version** annotation\r\n- set the required field as null each time before saving\r\n\r\n      yoursEntity.setId(null);\r\n      yoursEntityRepo.save(yoursEntity);\r\n\r\n- when passing data in the request body, do not include this field (e.g. in json) and add the following annotation above the class:\r\n\r\n      @JsonInclude(JsonInclude.Include.NON_NULL)\r\n      public class YoursEntity {}\r\n\r\n","title":"Could not obtain identifier from","body":"<p>The problem most often occurs when you are using a Mongo database inside Spring application and you are trying to save (or overwrite) a document whose mandatory value is empty.</p>\n<p>It is worth paying attention to the type of error that appears in the logs and check these top lines:</p>\n<pre><code>java.lang.IllegalStateException: Could not obtain identifier from XXX\nat org.springframework.data.mapping.TargetAwareIdentifierAccessor.getRequiredIdentifier(TargetAwareIdentifierAccessor.java:48)\nat org.springframework.data.mongodb.core.EntityOperations$MappedEntity.getId(EntityOperations.java:527)\nat org.springframework.data.mongodb.core.EntityOperations$MappedEntity.getQueryForVersion(EntityOperations.java:556)\nat org.springframework.data.mongodb.core.MongoTemplate.doSaveVersioned(MongoTemplate.java:1383)\nat org.springframework.data.mongodb.core.MongoTemplate.save(MongoTemplate.java:1370)\n</code></pre>\n<p>The save method, instead of making a direct save to the database, makes an additional series of calls inside the spring mongo data library.</p>\n<p>The <strong>doSaveVersioned()</strong> method catches our eye in particular. Inside this function, our service (unwittingly for us) tries to find an already existing record based on the ID to be able to verify and update the version. This of course causes an error, because such a document does not yet exist in the mongo database.</p>\n<p>This app behavior is because one of your entities must have <strong>@Version</strong> annotation for one of the fields, for example:</p>\n<pre><code>public class YoursEntity {\n\n   protected String id;\n\n   protected String lastUpdateBy;\n\n   protected Instant lastUpdateOn;\n\n   protected String name;\n\n   @Version\n   protected Long version;\n}\n</code></pre>\n<p>To fix this, you can do one of several things:</p>\n<ul>\n<li><p>get rid of the <strong>@Version</strong> annotation</p>\n</li>\n<li><p>set the required field as null each time before saving</p>\n<pre><code>yoursEntity.setId(null);\nyoursEntityRepo.save(yoursEntity);\n</code></pre>\n</li>\n<li><p>when passing data in the request body, do not include this field (e.g. in json) and add the following annotation above the class:</p>\n<pre><code>@JsonInclude(JsonInclude.Include.NON_NULL)\npublic class YoursEntity {}\n</code></pre>\n</li>\n</ul>\n"}],"owner":{"account_id":1760367,"reputation":4807,"user_id":1607660,"accept_rate":70,"display_name":"FazoM"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4289,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"answer_count":3,"score":4,"last_activity_date":1689946956,"creation_date":1566479750,"question_id":57610243,"body_markdown":"I am getting following problem when trying to save an Entity into `MongoDB` database.\r\n\r\nI am using `Spring` `CrudRepository`\r\n\r\nAn my code looks as follow:\r\n\r\n    UserDocument user = processUser();\r\n    userRepository.save(user);\r\n\r\nThis is the error I am getting:\r\n\r\n    java.lang.IllegalStateException: Could not obtain identifier from UserDocument(id=null, ownerId=..., ...)!\r\n    \tat o.s.d.m.TargetAwareIdentifierAccessor.getRequiredIdentifier(TargetAwareIdentifierAccessor.java:47)\r\n    \tat o.s.d.m.c.EntityOperations$MappedEntity.getId(EntityOperations.java:466)\r\n    \t... 53 frames excluded\r\n\r\nUserDocument class:\r\n\r\n    import lombok.AllArgsConstructor;\r\n    import lombok.Data;\r\n    import lombok.EqualsAndHashCode;\r\n    import lombok.NoArgsConstructor;\r\n    import lombok.experimental.Accessors;\r\n    import lombok.experimental.SuperBuilder;\r\n    import org.bson.types.ObjectId;\r\n    import org.springframework.data.annotation.Id;\r\n    import org.springframework.data.mongodb.core.index.CompoundIndex;\r\n    import org.springframework.data.mongodb.core.index.CompoundIndexes;\r\n    import org.springframework.data.mongodb.core.mapping.Document;\r\n\r\n    @Data\r\n    @EqualsAndHashCode(callSuper = true)\r\n    @NoArgsConstructor\r\n    @AllArgsConstructor\r\n    @Accessors(chain = true)\r\n    @SuperBuilder\r\n    @Document(collection = UserDocument.COLLECTION)\r\n    public class UserDocument extends BaseDocument&lt;ObjectId&gt; {\r\n    \r\n      public static final String COLLECTION = &quot;users&quot;;\r\n    \r\n      @Id\r\n      private ObjectId id;\r\n\r\n     .....\r\n    }","title":"Could not obtain identifier from","body":"<p>I am getting following problem when trying to save an Entity into <code>MongoDB</code> database.</p>\n\n<p>I am using <code>Spring</code> <code>CrudRepository</code></p>\n\n<p>An my code looks as follow:</p>\n\n<pre><code>UserDocument user = processUser();\nuserRepository.save(user);\n</code></pre>\n\n<p>This is the error I am getting:</p>\n\n<pre><code>java.lang.IllegalStateException: Could not obtain identifier from UserDocument(id=null, ownerId=..., ...)!\n    at o.s.d.m.TargetAwareIdentifierAccessor.getRequiredIdentifier(TargetAwareIdentifierAccessor.java:47)\n    at o.s.d.m.c.EntityOperations$MappedEntity.getId(EntityOperations.java:466)\n    ... 53 frames excluded\n</code></pre>\n\n<p>UserDocument class:</p>\n\n<pre><code>import lombok.AllArgsConstructor;\nimport lombok.Data;\nimport lombok.EqualsAndHashCode;\nimport lombok.NoArgsConstructor;\nimport lombok.experimental.Accessors;\nimport lombok.experimental.SuperBuilder;\nimport org.bson.types.ObjectId;\nimport org.springframework.data.annotation.Id;\nimport org.springframework.data.mongodb.core.index.CompoundIndex;\nimport org.springframework.data.mongodb.core.index.CompoundIndexes;\nimport org.springframework.data.mongodb.core.mapping.Document;\n\n@Data\n@EqualsAndHashCode(callSuper = true)\n@NoArgsConstructor\n@AllArgsConstructor\n@Accessors(chain = true)\n@SuperBuilder\n@Document(collection = UserDocument.COLLECTION)\npublic class UserDocument extends BaseDocument&lt;ObjectId&gt; {\n\n  public static final String COLLECTION = \"users\";\n\n  @Id\n  private ObjectId id;\n\n .....\n}\n</code></pre>\n"},{"tags":["java","fileoutputstream","bytearrayoutputstream"],"comments":[{"owner":{"account_id":18256279,"reputation":659,"user_id":13290159,"display_name":"0x150"},"score":0,"creation_date":1682405729,"post_id":76098334,"comment_id":134205575,"body_markdown":"If you need to store a file that big in memory, it&#39;s probably time to rethink your program&#39;s structure.","body":"If you need to store a file that big in memory, it&#39;s probably time to rethink your program&#39;s structure."},{"owner":{"display_name":"user13121564"},"score":0,"creation_date":1682408987,"post_id":76098334,"comment_id":134206265,"body_markdown":"I am not storing file in memory. I am adding 3 files to one output stream which is creating/appending it to the final file in azure storage account. But it overflows in between to file is never creates the file.","body":"I am not storing file in memory. I am adding 3 files to one output stream which is creating/appending it to the final file in azure storage account. But it overflows in between to file is never creates the file."},{"owner":{"account_id":47283,"reputation":703817,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1682409074,"post_id":76098334,"comment_id":134206283,"body_markdown":"Please update the question to explain what you are doing.  Edit the question.","body":"Please update the question to explain what you are doing.  Edit the question."},{"owner":{"account_id":71739,"reputation":307142,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":1,"creation_date":1682409127,"post_id":76098334,"comment_id":134206294,"body_markdown":"&quot;I am not storing file in memory. &quot; Yes you are. Otherwise you wouldn&#39;t need a byte array output stream at all. And you can&#39;t describe using more than 2^31 bytes as &#39;memory efficient&#39;. There is never any reason for buffers this size.","body":"&quot;I am not storing file in memory. &quot; Yes you are. Otherwise you wouldn&#39;t need a byte array output stream at all. And you can&#39;t describe using more than 2^31 bytes as &#39;memory efficient&#39;. There is never any reason for buffers this size."},{"owner":{"account_id":213468,"reputation":103489,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1682413760,"post_id":76098334,"comment_id":134207400,"body_markdown":"If you want to send three files to one outputstream, then you can open a file, use its `transferTo` method to send it to the outputstream, then open the next file, send it to the outputstream and then the last file and send it to the outputstream. Unless there is something you&#39;re not telling us, you really don&#39;t need to load all three files into memory to transfer them to an outputstream.","body":"If you want to send three files to one outputstream, then you can open a file, use its <code>transferTo</code> method to send it to the outputstream, then open the next file, send it to the outputstream and then the last file and send it to the outputstream. Unless there is something you&#39;re not telling us, you really don&#39;t need to load all three files into memory to transfer them to an outputstream."},{"owner":{"display_name":"user13121564"},"score":0,"creation_date":1682414714,"post_id":76098334,"comment_id":134207630,"body_markdown":"@StephenC  I have updated the question but it doesn&#39;t really affect the inital question. Purpose of this is to pass a file to output stream which creates block size greater than Integer max.","body":"@StephenC  I have updated the question but it doesn&#39;t really affect the inital question. Purpose of this is to pass a file to output stream which creates block size greater than Integer max."},{"owner":{"account_id":71739,"reputation":307142,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1682416186,"post_id":76098334,"comment_id":134207979,"body_markdown":"No, that&#39;s not the purpose. The purpose is just the part about &#39;pass a file to output stream&#39;. The part about &#39;which creates block size greater than Integer max&#39; is just your misconceived idea about what a solution would look like. Lose it and your problem disappears.","body":"No, that&#39;s not the purpose. The purpose is just the part about &#39;pass a file to output stream&#39;. The part about &#39;which creates block size greater than Integer max&#39; is just your misconceived idea about what a solution would look like. Lose it and your problem disappears."},{"owner":{"display_name":"user13121564"},"score":0,"creation_date":1682416834,"post_id":76098334,"comment_id":134208143,"body_markdown":"@user207421 Can you please suggest a solution? I might be wrong in explaining but I&#39;m trying my best here. Like my comment in the answer below :\n&quot;I am reading 3 sub files created from a larger file and writing it to a file in azure storage.To write a file to a file in azure storage account, I don&#39;t know what other than Output Stream I can use. I was also wondering if there is anything else which uses Long as input to create block size. &quot;. If I should lose the idea of passing it to outputstream, Can you suggest what else can I use in this senario","body":"@user207421 Can you please suggest a solution? I might be wrong in explaining but I&#39;m trying my best here. Like my comment in the answer below : &quot;I am reading 3 sub files created from a larger file and writing it to a file in azure storage.To write a file to a file in azure storage account, I don&#39;t know what other than Output Stream I can use. I was also wondering if there is anything else which uses Long as input to create block size. &quot;. If I should lose the idea of passing it to outputstream, Can you suggest what else can I use in this senario"},{"owner":{"account_id":71739,"reputation":307142,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1682417036,"post_id":76098334,"comment_id":134208193,"body_markdown":"So your question is about how to write to a file in Azure storage. Not about huge byte array output streams. What output stream are you *presently* using? and what makes you think you need a different one? and what does &#39;us[ing] `Long` as input to create block size&#39; have to do with anything? All you have to do is adopt the `transferTo()` suggestion above with the successive input streams. I don&#39;t know why you haven&#39;t tried it already. You need to exhibit some *relevant* code here.","body":"So your question is about how to write to a file in Azure storage. Not about huge byte array output streams. What output stream are you <i>presently</i> using? and what makes you think you need a different one? and what does &#39;us[ing] <code>Long</code> as input to create block size&#39; have to do with anything? All you have to do is adopt the <code>transferTo()</code> suggestion above with the successive input streams. I don&#39;t know why you haven&#39;t tried it already. You need to exhibit some <i>relevant</i> code here."},{"owner":{"account_id":1689973,"reputation":37280,"user_id":1552534,"display_name":"WJS"},"score":0,"creation_date":1689947181,"post_id":76098334,"comment_id":135289058,"body_markdown":"The classes mentioned in this question don&#39;t appear to be part of the standard java API.  Are they Azure, Spring?  Please update the tags to reflect the third party platform.","body":"The classes mentioned in this question don&#39;t appear to be part of the standard java API.  Are they Azure, Spring?  Please update the tags to reflect the third party platform."}],"answers":[{"tags":[],"owner":{"account_id":47283,"reputation":703817,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1682411838,"creation_date":1682408942,"answer_id":76098767,"question_id":76098334,"body_markdown":"`FastByteArrayOutputStream` will not work for your use-case.  While it uses a `Deque&lt;byte[]&gt;` internally, that is just an optimization to reduce the amount of copying.  If you look at the source code, you will see that there are a number of places that limit the size to the maximum size of a `byte[]` ... which is 2^31 - 1 bytes; i.e. 2GB - 1.\r\n\r\n&gt; I&#39;ve got a file greater than max size ...\r\n\r\nPossible solutions:\r\n\r\n  1.  If you are outputting the file, write the data directly to the file or socket.  There is no obvious reason to write to use a `ByteArrayOutputStream` variant for this.  It won&#39;t improve performance!\r\n\r\n  2.  Take the source code for `FastByteArrayOutputStream` and modify it for your own purposes.  However, you will run into the problem that the `getByteArray` and `unsafeGetByteArray` methods are unimplementable for 2GB and larger content.  And similar issues.\r\n\r\nThere may be other solutions, but it is hard to say.  You don&#39;t explain what you are actually doing.\r\n\r\n","title":"Memory efficient FastByteArrayOutputStream with minCapacity greater than max size of Integer i.e 2147483647","body":"<p><code>FastByteArrayOutputStream</code> will not work for your use-case.  While it uses a <code>Deque&lt;byte[]&gt;</code> internally, that is just an optimization to reduce the amount of copying.  If you look at the source code, you will see that there are a number of places that limit the size to the maximum size of a <code>byte[]</code> ... which is 2^31 - 1 bytes; i.e. 2GB - 1.</p>\n<blockquote>\n<p>I've got a file greater than max size ...</p>\n</blockquote>\n<p>Possible solutions:</p>\n<ol>\n<li><p>If you are outputting the file, write the data directly to the file or socket.  There is no obvious reason to write to use a <code>ByteArrayOutputStream</code> variant for this.  It won't improve performance!</p>\n</li>\n<li><p>Take the source code for <code>FastByteArrayOutputStream</code> and modify it for your own purposes.  However, you will run into the problem that the <code>getByteArray</code> and <code>unsafeGetByteArray</code> methods are unimplementable for 2GB and larger content.  And similar issues.</p>\n</li>\n</ol>\n<p>There may be other solutions, but it is hard to say.  You don't explain what you are actually doing.</p>\n"}],"owner":{"display_name":"user13121564"},"comment_count":10,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":188,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":1,"score":0,"last_activity_date":1689945516,"creation_date":1682405577,"question_id":76098334,"body_markdown":"FastByteArrayOutputStream has a write function which has addBuffer which accepts minCapacity in integer and allocates next block size as next power of 2 of minCapacity. So, block size keeps increasing in order to accomodate the file in buffer.\r\n\r\nI have a file greater than max size, (Internally diving it to 3 files, pushing them to outputstream an finally creating it a file in azure storage) so while writing it to buffer the minCapacity goes over max integer value of 2147483647 and starts assigning block size in signed integer -2147483648, which is invalid and gives exception as in the image attached. \r\n","title":"Memory efficient FastByteArrayOutputStream with minCapacity greater than max size of Integer i.e 2147483647","body":"<p>FastByteArrayOutputStream has a write function which has addBuffer which accepts minCapacity in integer and allocates next block size as next power of 2 of minCapacity. So, block size keeps increasing in order to accomodate the file in buffer.</p>\n<p>I have a file greater than max size, (Internally diving it to 3 files, pushing them to outputstream an finally creating it a file in azure storage) so while writing it to buffer the minCapacity goes over max integer value of 2147483647 and starts assigning block size in signed integer -2147483648, which is invalid and gives exception as in the image attached.</p>\n"},{"tags":["java","ios","appium"],"comments":[{"owner":{"account_id":969227,"reputation":1332,"user_id":992094,"accept_rate":43,"display_name":"Gaurav"},"score":0,"creation_date":1439821423,"post_id":32048031,"comment_id":52004712,"body_markdown":"Make sure only one instance of appium server is running on your machine. Close all the appium server, start the server and try again.","body":"Make sure only one instance of appium server is running on your machine. Close all the appium server, start the server and try again."}],"answers":[{"tags":[],"owner":{"account_id":1448286,"reputation":2682,"user_id":1366056,"accept_rate":83,"display_name":"Shambu"},"down_vote_count":0,"up_vote_count":8,"is_accepted":true,"score":8,"last_activity_date":1439914184,"creation_date":1439914184,"answer_id":32077464,"question_id":32048031,"body_markdown":"This happens because the previous session wasn&#39;t shutdown properly and it happens when there is exception thrown in your test. Restart the appium server and try it , it should resolve the issue.\r\n\r\nAlternatively if you starting appium as node process, you can give option `&#39;--session-override true&#39;` and this would avoid this problem","title":"org.openqa.selenium.SessionNotCreatedException: A new session could not be created. (Original error: Requested a new session but one was in progress)","body":"<p>This happens because the previous session wasn't shutdown properly and it happens when there is exception thrown in your test. Restart the appium server and try it , it should resolve the issue.</p>\n\n<p>Alternatively if you starting appium as node process, you can give option <code>'--session-override true'</code> and this would avoid this problem</p>\n"},{"tags":[],"owner":{"account_id":5122312,"reputation":719,"user_id":4105475,"accept_rate":100,"display_name":"Humble_PrOgRaMeR"},"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1453205737,"creation_date":1453205015,"answer_id":34876357,"question_id":32048031,"body_markdown":"The following is working for me. I am testing by connecting Android device. Please make changes as per your need and apply, this should work now.\r\n\r\n            DesiredCapabilities capabilities = new DesiredCapabilities().android();\r\n\t\t\tcapabilities.setCapability(&quot;no&quot;,true);\r\n\t\t\tcapabilities.setCapability(&quot;newCommandTimeout&quot;, 100000);\r\n\t\t\tcapabilities.setCapability(&quot;noReset&quot;, true);\r\n\t\t\tcapabilities.setCapability(CapabilityType.BROWSER_NAME, &quot;&quot;);\r\n\t\t\tcapabilities.setCapability(CapabilityType.VERSION, &quot;4.4.2&quot;);\r\n\t\t\tcapabilities.setCapability(&quot;deviceName&quot;, &quot;Galaxy nexus&quot;);\r\n\t\t\tcapabilities.setCapability(&quot;app&quot;, application.getAbsolutePath());\r\n\t\t\tcapabilities.setCapability(&quot;automationName&quot;, &quot;selendroid&quot;);\r\n\t\t\tcapabilities.setCapability(&quot;noRest&quot;, true);\r\n\t\t\tdriver = new AndroidDriver&lt;MobileElement&gt;(new URL(&quot;http://127.0.0.1:4723/wd/hub&quot;), capabilities);\r\n\t\t\t\r\n\r\n\r\n","title":"org.openqa.selenium.SessionNotCreatedException: A new session could not be created. (Original error: Requested a new session but one was in progress)","body":"<p>The following is working for me. I am testing by connecting Android device. Please make changes as per your need and apply, this should work now.</p>\n\n<pre><code>        DesiredCapabilities capabilities = new DesiredCapabilities().android();\n        capabilities.setCapability(\"no\",true);\n        capabilities.setCapability(\"newCommandTimeout\", 100000);\n        capabilities.setCapability(\"noReset\", true);\n        capabilities.setCapability(CapabilityType.BROWSER_NAME, \"\");\n        capabilities.setCapability(CapabilityType.VERSION, \"4.4.2\");\n        capabilities.setCapability(\"deviceName\", \"Galaxy nexus\");\n        capabilities.setCapability(\"app\", application.getAbsolutePath());\n        capabilities.setCapability(\"automationName\", \"selendroid\");\n        capabilities.setCapability(\"noRest\", true);\n        driver = new AndroidDriver&lt;MobileElement&gt;(new URL(\"http://127.0.0.1:4723/wd/hub\"), capabilities);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":5009268,"reputation":353,"user_id":4025989,"display_name":"Gloria Rampur"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1481715372,"creation_date":1481715372,"answer_id":41141596,"question_id":32048031,"body_markdown":"Adding the deviceName in the capabilities helped.\r\nIn the appium logs I could figure out the missing thing.","title":"org.openqa.selenium.SessionNotCreatedException: A new session could not be created. (Original error: Requested a new session but one was in progress)","body":"<p>Adding the deviceName in the capabilities helped.\nIn the appium logs I could figure out the missing thing.</p>\n"},{"tags":[],"owner":{"account_id":100473,"reputation":3456,"user_id":270835,"accept_rate":80,"display_name":"Tarun"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1484143710,"creation_date":1484143710,"answer_id":41593079,"question_id":32048031,"body_markdown":"If on appium app then select `Override Existing Sessions` checkbox under Settings - \r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/8PvBT.png","title":"org.openqa.selenium.SessionNotCreatedException: A new session could not be created. (Original error: Requested a new session but one was in progress)","body":"<p>If on appium app then select <code>Override Existing Sessions</code> checkbox under Settings - </p>\n\n<p><a href=\"https://i.stack.imgur.com/8PvBT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8PvBT.png\" alt=\"enter image description here\"></a></p>\n"},{"tags":[],"owner":{"account_id":22767721,"reputation":1,"user_id":16925540,"display_name":"Fayaz"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1631775325,"creation_date":1631775325,"answer_id":69203676,"question_id":32048031,"body_markdown":"Kill running servers in the task manager like appium , basically end the task of cmd.","title":"org.openqa.selenium.SessionNotCreatedException: A new session could not be created. (Original error: Requested a new session but one was in progress)","body":"<p>Kill running servers in the task manager like appium , basically end the task of cmd.</p>\n"},{"tags":[],"owner":{"account_id":4905500,"reputation":46,"user_id":3952356,"display_name":"Aakash Jaiswal"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1649995723,"creation_date":1649995723,"answer_id":71879973,"question_id":32048031,"body_markdown":"The easiest way that I found was stop the Appium server, Quit it wait for some seconds and again start it and run your script. If needed can do with emulator as well","title":"org.openqa.selenium.SessionNotCreatedException: A new session could not be created. (Original error: Requested a new session but one was in progress)","body":"<p>The easiest way that I found was stop the Appium server, Quit it wait for some seconds and again start it and run your script. If needed can do with emulator as well</p>\n"},{"tags":[],"owner":{"account_id":29032933,"reputation":1,"user_id":22239432,"display_name":"Yogesh Prakash Shinde"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689945488,"creation_date":1689663958,"answer_id":76710252,"question_id":32048031,"body_markdown":"I have faced the same error many time. By following simple below steps I was able to fix the issue.\r\n\r\n1. Restart eclipse\r\n2. Close your emulator and android studio\r\n3. Quit `appium` on terminal\r\n4. Start the android studio \r\n5. Delete the device and crate new device\r\n6. Now launch the emulator and run the script\r\n","title":"org.openqa.selenium.SessionNotCreatedException: A new session could not be created. (Original error: Requested a new session but one was in progress)","body":"<p>I have faced the same error many time. By following simple below steps I was able to fix the issue.</p>\n<ol>\n<li>Restart eclipse</li>\n<li>Close your emulator and android studio</li>\n<li>Quit <code>appium</code> on terminal</li>\n<li>Start the android studio</li>\n<li>Delete the device and crate new device</li>\n<li>Now launch the emulator and run the script</li>\n</ol>\n"}],"owner":{"account_id":4921899,"reputation":55,"user_id":3964266,"display_name":"amitav"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":70706,"favorite_count":0,"down_vote_count":0,"up_vote_count":5,"accepted_answer_id":32077464,"answer_count":7,"score":5,"last_activity_date":1689945488,"creation_date":1439807143,"question_id":32048031,"body_markdown":"I am using Appium 1.4.8 for iOS . I have build the code in simulator using xcode and successfully able to launch the server as well as Appium Inspector. But while running my code it is throwing the below error.\r\n\r\nMy capabilities are \r\n@BeforeMethod\r\npublic void setUp() throws MalformedURLException{\r\n\t\r\n\t\r\n\tDesiredCapabilities capabilities = new DesiredCapabilities();\r\n\tcapabilities.setCapability(&quot;appium-version&quot;, &quot;1.0&quot;);\r\n\tcapabilities.setCapability(&quot;platformName&quot;, &quot;iOS&quot;);\r\n\tcapabilities.setCapability(&quot;platformVersion&quot;, &quot;8.4&quot;);\r\n\tcapabilities.setCapability(&quot;deviceName&quot;, &quot;iPad 2&quot;);\r\n\tcapabilities.setCapability(&quot;app&quot;, &quot;/Users/arunhs/Desktop/AppiumReq/SRC/build/Debug-iphonesimulator/ComplianceWire.app&quot;);\r\n\tdriver = new AppiumDriver(new URL(&quot;http://127.0.0.1:4723/wd/hub&quot;), capabilities);\r\n\tdriver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);\r\n\t\r\n\t\r\n}\r\n\r\n    Error is: \r\n    FAILED CONFIGURATION: @BeforeMethod setUp\r\n    org.openqa.selenium.SessionNotCreatedException: A new session could not be created. (Original error: Requested a new session but one was in progress) (WARNING: The server did not provide any stacktrace information)\r\n    Command duration or timeout: 447 milliseconds\r\n    Build info: version: &#39;2.47.1&#39;, revision: &#39;411b314&#39;, time: &#39;2015-07-30 03:03:16&#39;\r\n    System info: host: &#39;N/A&#39;, ip: &#39;N/A&#39;, os.name: &#39;Mac OS X&#39;, os.arch: &#39;x86_64&#39;, os.version: &#39;10.10.4&#39;, java.version: &#39;1.7.0_79&#39;\r\n    Driver info: io.appium.java_client.AppiumDriver\r\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)\r\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:526)\r\n    at org.openqa.selenium.remote.ErrorHandler.createThrowable(ErrorHandler.java:206)\r\n    at org.openqa.selenium.remote.ErrorHandler.throwIfResponseFailed(ErrorHandler.java:158)\r\n    at org.openqa.selenium.remote.RemoteWebDriver.execute(RemoteWebDriver.java:595)\r\n    at io.appium.java_client.AppiumDriver.execute(AppiumDriver.java:88)\r\n    at org.openqa.selenium.remote.RemoteWebDriver.startSession(RemoteWebDriver.java:242)\r\n    at org.openqa.selenium.remote.RemoteWebDriver.(RemoteWebDriver.java:128)\r\n    at org.openqa.selenium.remote.RemoteWebDriver.(RemoteWebDriver.java:155)\r\n    at io.appium.java_client.AppiumDriver.(AppiumDriver.java:44)\r\n    at com.selenium.test.DriverScript.setUp(DriverScript.java:68)\r\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n    at java.lang.reflect.Method.invoke(Method.java:606)\r\n    at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:85)\r\n    at org.testng.internal.Invoker.invokeConfigurationMethod(Invoker.java:515)\r\n    at org.testng.internal.Invoker.invokeConfigurations(Invoker.java:213)\r\n    at org.testng.internal.Invoker.invokeMethod(Invoker.java:590)\r\n    at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:834)\r\n    at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1142)\r\n    at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:124)\r\n    at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:108)\r\n    at org.testng.TestRunner.privateRun(TestRunner.java:771)\r\n    at org.testng.TestRunner.run(TestRunner.java:621)\r\n    at org.testng.SuiteRunner.runTest(SuiteRunner.java:357)\r\n    at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:352)\r\n    at org.testng.SuiteRunner.privateRun(SuiteRunner.java:310)\r\n    at org.testng.SuiteRunner.run(SuiteRunner.java:259)\r\n    at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)\r\n    at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)\r\n    at org.testng.TestNG.runSuitesSequentially(TestNG.java:1176)\r\n    at org.testng.TestNG.runSuitesLocally(TestNG.java:1101)\r\n    at org.testng.TestNG.run(TestNG.java:1009)\r\n    at org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)\r\n    at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)\r\n    at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175)","title":"org.openqa.selenium.SessionNotCreatedException: A new session could not be created. (Original error: Requested a new session but one was in progress)","body":"<p>I am using Appium 1.4.8 for iOS . I have build the code in simulator using xcode and successfully able to launch the server as well as Appium Inspector. But while running my code it is throwing the below error.</p>\n\n<p>My capabilities are \n@BeforeMethod\npublic void setUp() throws MalformedURLException{</p>\n\n<pre><code>DesiredCapabilities capabilities = new DesiredCapabilities();\ncapabilities.setCapability(\"appium-version\", \"1.0\");\ncapabilities.setCapability(\"platformName\", \"iOS\");\ncapabilities.setCapability(\"platformVersion\", \"8.4\");\ncapabilities.setCapability(\"deviceName\", \"iPad 2\");\ncapabilities.setCapability(\"app\", \"/Users/arunhs/Desktop/AppiumReq/SRC/build/Debug-iphonesimulator/ComplianceWire.app\");\ndriver = new AppiumDriver(new URL(\"http://127.0.0.1:4723/wd/hub\"), capabilities);\ndriver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);\n</code></pre>\n\n<p>}</p>\n\n<pre><code>Error is: \nFAILED CONFIGURATION: @BeforeMethod setUp\norg.openqa.selenium.SessionNotCreatedException: A new session could not be created. (Original error: Requested a new session but one was in progress) (WARNING: The server did not provide any stacktrace information)\nCommand duration or timeout: 447 milliseconds\nBuild info: version: '2.47.1', revision: '411b314', time: '2015-07-30 03:03:16'\nSystem info: host: 'N/A', ip: 'N/A', os.name: 'Mac OS X', os.arch: 'x86_64', os.version: '10.10.4', java.version: '1.7.0_79'\nDriver info: io.appium.java_client.AppiumDriver\nat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\nat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)\nat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\nat java.lang.reflect.Constructor.newInstance(Constructor.java:526)\nat org.openqa.selenium.remote.ErrorHandler.createThrowable(ErrorHandler.java:206)\nat org.openqa.selenium.remote.ErrorHandler.throwIfResponseFailed(ErrorHandler.java:158)\nat org.openqa.selenium.remote.RemoteWebDriver.execute(RemoteWebDriver.java:595)\nat io.appium.java_client.AppiumDriver.execute(AppiumDriver.java:88)\nat org.openqa.selenium.remote.RemoteWebDriver.startSession(RemoteWebDriver.java:242)\nat org.openqa.selenium.remote.RemoteWebDriver.(RemoteWebDriver.java:128)\nat org.openqa.selenium.remote.RemoteWebDriver.(RemoteWebDriver.java:155)\nat io.appium.java_client.AppiumDriver.(AppiumDriver.java:44)\nat com.selenium.test.DriverScript.setUp(DriverScript.java:68)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:85)\nat org.testng.internal.Invoker.invokeConfigurationMethod(Invoker.java:515)\nat org.testng.internal.Invoker.invokeConfigurations(Invoker.java:213)\nat org.testng.internal.Invoker.invokeMethod(Invoker.java:590)\nat org.testng.internal.Invoker.invokeTestMethod(Invoker.java:834)\nat org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1142)\nat org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:124)\nat org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:108)\nat org.testng.TestRunner.privateRun(TestRunner.java:771)\nat org.testng.TestRunner.run(TestRunner.java:621)\nat org.testng.SuiteRunner.runTest(SuiteRunner.java:357)\nat org.testng.SuiteRunner.runSequentially(SuiteRunner.java:352)\nat org.testng.SuiteRunner.privateRun(SuiteRunner.java:310)\nat org.testng.SuiteRunner.run(SuiteRunner.java:259)\nat org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)\nat org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)\nat org.testng.TestNG.runSuitesSequentially(TestNG.java:1176)\nat org.testng.TestNG.runSuitesLocally(TestNG.java:1101)\nat org.testng.TestNG.run(TestNG.java:1009)\nat org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)\nat org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)\nat org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175)\n</code></pre>\n"},{"tags":["java","exception","apache-kafka"],"comments":[{"owner":{"account_id":174366,"reputation":12158,"user_id":403682,"accept_rate":95,"display_name":"Kenny Cason"},"score":0,"creation_date":1434039176,"post_id":22756144,"comment_id":49621948,"body_markdown":"You happen to find a solution to this? It&#39;s been a small burden for an auditing app I&#39;m working on.","body":"You happen to find a solution to this? It&#39;s been a small burden for an auditing app I&#39;m working on."}],"answers":[{"tags":[],"owner":{"account_id":3224137,"reputation":8035,"user_id":2720864,"accept_rate":43,"display_name":"user2720864"},"down_vote_count":2,"up_vote_count":0,"is_accepted":false,"score":-2,"last_activity_date":1396372056,"creation_date":1396372056,"answer_id":22792400,"question_id":22756144,"body_markdown":"I think the one thing you could do is to use a try/catch to log all `Throwable` in your producer code.","title":"How can I handle IOException when Kafka is down?","body":"<p>I think the one thing you could do is to use a try/catch to log all <code>Throwable</code> in your producer code.</p>\n"},{"tags":[],"owner":{"account_id":227595,"reputation":761,"user_id":489363,"display_name":"Peter Davis"},"down_vote_count":0,"up_vote_count":5,"is_accepted":true,"score":5,"last_activity_date":1460068225,"creation_date":1460068225,"answer_id":36488344,"question_id":22756144,"body_markdown":"Call `get()` on the future returned by [Producer.send(...)](https://kafka.apache.org/090/javadoc/org/apache/kafka/clients/producer/KafkaProducer.html#send(org.apache.kafka.clients.producer.ProducerRecord)), or if you don&#39;t want to block your code, pass a [callback](https://kafka.apache.org/090/javadoc/org/apache/kafka/clients/producer/KafkaProducer.html#send(org.apache.kafka.clients.producer.ProducerRecord,%20org.apache.kafka.clients.producer.Callback)).\r\n\r\n```try {\r\n  producer.send(new ProducerRecord(&quot;mytopic&quot;, key, value))\r\n     .get(); // block until acknowledged\r\n} catch(Exception e) {\r\n  // handle message wasn&#39;t acknowledged\r\n}\r\n```","title":"How can I handle IOException when Kafka is down?","body":"<p>Call <code>get()</code> on the future returned by <a href=\"https://kafka.apache.org/090/javadoc/org/apache/kafka/clients/producer/KafkaProducer.html#send(org.apache.kafka.clients.producer.ProducerRecord)\" rel=\"noreferrer\">Producer.send(...)</a>, or if you don't want to block your code, pass a <a href=\"https://kafka.apache.org/090/javadoc/org/apache/kafka/clients/producer/KafkaProducer.html#send(org.apache.kafka.clients.producer.ProducerRecord,%20org.apache.kafka.clients.producer.Callback)\" rel=\"noreferrer\">callback</a>.</p>\n\n<p><code>try {\n  producer.send(new ProducerRecord(\"mytopic\", key, value))\n     .get(); // block until acknowledged\n} catch(Exception e) {\n  // handle message wasn't acknowledged\n}\n</code></p>\n"}],"owner":{"account_id":2570598,"reputation":13282,"user_id":2229438,"accept_rate":94,"display_name":"Grzegorz Piwowarek"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4502,"favorite_count":0,"down_vote_count":0,"up_vote_count":14,"accepted_answer_id":36488344,"answer_count":2,"score":14,"last_activity_date":1689945185,"creation_date":1396252084,"question_id":22756144,"body_markdown":"I am trying to publish message, and Apache Kafka is down.\r\nHow should I handle an emergency situation like this?\r\n\r\nKafkaProducer::send() method doesn&#39;t throw any exceptions that could be handled. Producer swallows them and logs errors instead, so I get flooded with messages like this, and everything hangs until Kafka gets connected again.\r\n\r\n    2014-03-31 09:38:23.752 ERROR o.a.kafka.common.network.Selector - Error in I/O: \r\n    java.net.ConnectException: Connection refused\r\n\t    at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.7.0_51]\r\n\t    at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:739) ~[na:1.7.0_51]\r\n\t    at org.apache.kafka.common.network.Selector.poll(Selector.java:205) ~[kafka-clients-0.8.1.jar:na]\r\n\t    at org.apache.kafka.clients.producer.internals.Sender.run(Sender.java:212) [kafka-clients-0.8.1.jar:na]\r\n\t    at org.apache.kafka.clients.producer.internals.Sender.run(Sender.java:150) [kafka-clients-0.8.1.jar:na]\r\n\t    at java.lang.Thread.run(Thread.java:744) [na:1.7.0_51]\r\n\r\n","title":"How can I handle IOException when Kafka is down?","body":"<p>I am trying to publish message, and Apache Kafka is down.\nHow should I handle an emergency situation like this?</p>\n\n<p>KafkaProducer::send() method doesn't throw any exceptions that could be handled. Producer swallows them and logs errors instead, so I get flooded with messages like this, and everything hangs until Kafka gets connected again.</p>\n\n<pre><code>2014-03-31 09:38:23.752 ERROR o.a.kafka.common.network.Selector - Error in I/O: \njava.net.ConnectException: Connection refused\n    at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[na:1.7.0_51]\n    at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:739) ~[na:1.7.0_51]\n    at org.apache.kafka.common.network.Selector.poll(Selector.java:205) ~[kafka-clients-0.8.1.jar:na]\n    at org.apache.kafka.clients.producer.internals.Sender.run(Sender.java:212) [kafka-clients-0.8.1.jar:na]\n    at org.apache.kafka.clients.producer.internals.Sender.run(Sender.java:150) [kafka-clients-0.8.1.jar:na]\n    at java.lang.Thread.run(Thread.java:744) [na:1.7.0_51]\n</code></pre>\n"},{"tags":["java","velocity"],"answers":[{"tags":[],"owner":{"account_id":302948,"reputation":12394,"user_id":611600,"accept_rate":86,"display_name":"Ali"},"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1429793739,"creation_date":1312903145,"answer_id":6998572,"question_id":6998412,"body_markdown":"You could just create 2 methods `getName()` and `getname()`\r\nthen when you use `${s_attribute.name}` velocity will use `getname()` and when you use `${s_attribute.Name}` velocity will use the `getName()` method.\r\n\r\n**From the [Velocity guide][1]:**\r\n\r\n&gt; Property Lookup Rules \r\n&gt; \r\n&gt; As was mentioned earlier, properties often refer to methods of the\r\n&gt; parent object. Velocity is quite clever when figuring out which method\r\n&gt; corresponds to a requested property. It tries out different\r\n&gt; alternatives based on several established naming conventions. The\r\n&gt; exact lookup sequence depends on whether or not the property name\r\n&gt; starts with an upper-case letter. For lower-case names, such as\r\n&gt; $customer.address, the sequence is\r\n\r\n&gt;     getaddress()\r\n    getAddress()\r\n    get(&quot;address&quot;)\r\n    isAddress()\r\n    \r\n&gt; For upper-case property names like $customer.Address, it is slightly different:\r\n\r\n&gt;     getAddress()\r\n    getaddress()\r\n    get(&quot;Address&quot;)\r\n    isAddress()\r\n\r\n\r\nWhat i&#39;m suggesting is that you handle it in your object on the backend.\r\n\r\n\r\n  [1]: https://velocity.apache.org/engine/devel/user-guide.html#propertylookuprules","title":"Velocity string function","body":"<p>You could just create 2 methods <code>getName()</code> and <code>getname()</code>\nthen when you use <code>${s_attribute.name}</code> velocity will use <code>getname()</code> and when you use <code>${s_attribute.Name}</code> velocity will use the <code>getName()</code> method.</p>\n\n<p><strong>From the <a href=\"https://velocity.apache.org/engine/devel/user-guide.html#propertylookuprules\" rel=\"nofollow\">Velocity guide</a>:</strong></p>\n\n<blockquote>\n  <p>Property Lookup Rules </p>\n  \n  <p>As was mentioned earlier, properties often refer to methods of the\n  parent object. Velocity is quite clever when figuring out which method\n  corresponds to a requested property. It tries out different\n  alternatives based on several established naming conventions. The\n  exact lookup sequence depends on whether or not the property name\n  starts with an upper-case letter. For lower-case names, such as\n  $customer.address, the sequence is</p>\n\n<pre><code>getaddress()\ngetAddress()\nget(\"address\")\nisAddress()\n</code></pre>\n  \n  <p>For upper-case property names like $customer.Address, it is slightly different:</p>\n\n<pre><code>getAddress()\ngetaddress()\nget(\"Address\")\nisAddress()\n</code></pre>\n</blockquote>\n\n<p>What i'm suggesting is that you handle it in your object on the backend.</p>\n"},{"tags":[],"owner":{"account_id":171452,"reputation":7936,"user_id":398885,"display_name":"d-live"},"down_vote_count":0,"up_vote_count":43,"is_accepted":true,"score":43,"last_activity_date":1312904271,"creation_date":1312903188,"answer_id":6998581,"question_id":6998412,"body_markdown":"You can invoke standard java methods on these objects. If `s_attribute.name` is type String you can directly use `$s_attribute.name.toUpperCase()` or for your specific case use `$s_attribute.name.substring(0,1).toUpperCase()` and `$s_attribute.name.substring(1).toLowerCase()`","title":"Velocity string function","body":"<p>You can invoke standard java methods on these objects. If <code>s_attribute.name</code> is type String you can directly use <code>$s_attribute.name.toUpperCase()</code> or for your specific case use <code>$s_attribute.name.substring(0,1).toUpperCase()</code> and <code>$s_attribute.name.substring(1).toLowerCase()</code></p>\n"},{"tags":[],"owner":{"account_id":10611,"reputation":110107,"user_id":20128,"accept_rate":73,"display_name":"serg"},"down_vote_count":0,"up_vote_count":14,"is_accepted":false,"score":14,"last_activity_date":1689945074,"creation_date":1312903331,"answer_id":6998616,"question_id":6998412,"body_markdown":"There is `capitalize()` method in [`DisplayTool`][1]. In the template you can do:\r\n\r\n\tget${display.capitalize($s_attribute.name)}()\r\n\r\nYou will need the extra dependency on the classpath:\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.apache.velocity.tools&lt;/groupId&gt;\r\n        &lt;artifactId&gt;velocity-tools-generic&lt;/artifactId&gt;\r\n        &lt;version&gt;3.1&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nAnd you need to add a the `display` instance to the context\r\n\r\n        VelocityContext context = new VelocityContext();\r\n        context.put(&quot;display&quot;, new DisplayTool());\r\n\r\n  [1]: https://velocity.apache.org/tools/3.1/apidocs/org/apache/velocity/tools/generic/DisplayTool.html#capitalize-java.lang.Object-","title":"Velocity string function","body":"<p>There is <code>capitalize()</code> method in <a href=\"https://velocity.apache.org/tools/3.1/apidocs/org/apache/velocity/tools/generic/DisplayTool.html#capitalize-java.lang.Object-\" rel=\"nofollow noreferrer\"><code>DisplayTool</code></a>. In the template you can do:</p>\n<pre><code>get${display.capitalize($s_attribute.name)}()\n</code></pre>\n<p>You will need the extra dependency on the classpath:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.velocity.tools&lt;/groupId&gt;\n    &lt;artifactId&gt;velocity-tools-generic&lt;/artifactId&gt;\n    &lt;version&gt;3.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>And you need to add a the <code>display</code> instance to the context</p>\n<pre><code>    VelocityContext context = new VelocityContext();\n    context.put(&quot;display&quot;, new DisplayTool());\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6543678,"reputation":3232,"user_id":5060325,"display_name":"naimdjon"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1453366695,"creation_date":1453366695,"answer_id":34919228,"question_id":6998412,"body_markdown":"If you are using `commons-lang` you can use the `StringUtils` class: \r\n\r\n    context.put(&quot;StringUtils&quot;, org.apache.commons.lang3.StringUtils.class);\r\n\r\nThen in your template:\r\n\r\n    ...\r\n    return  get$StringUtils.capitalize(s_attribute.name)();\r\n    ...","title":"Velocity string function","body":"<p>If you are using <code>commons-lang</code> you can use the <code>StringUtils</code> class: </p>\n\n<pre><code>context.put(\"StringUtils\", org.apache.commons.lang3.StringUtils.class);\n</code></pre>\n\n<p>Then in your template:</p>\n\n<pre><code>...\nreturn  get$StringUtils.capitalize(s_attribute.name)();\n...\n</code></pre>\n"}],"owner":{"account_id":427992,"reputation":383,"user_id":810037,"display_name":"Yiming"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":60773,"favorite_count":0,"down_vote_count":0,"up_vote_count":34,"accepted_answer_id":6998581,"answer_count":4,"score":34,"last_activity_date":1689945074,"creation_date":1312902456,"question_id":6998412,"body_markdown":"I just start using Java Velocity. \r\nNow I want to create a java class template. \r\n\r\n    package $app.package_namespace\r\n    public class ${app.name}Station\r\n\r\n    {\r\n    \t#foreach($s_attribute in $app.station)\r\n    \t     $s_attribute.type $s_attribute.name,\r\n    \t#end\r\n    \tpublic $app.name Station(#foreach($s_attribute in $app.station)\r\n\t                                 $s_attribute.type $s_attribute.name;\r\n\t                             #end)\r\n\t{\r\n\t\t#foreach($s_attribute in $app.station)\r\n\t\t      $s_attribute.name=$s_attribute.name;\r\n\t\t#end\r\n\t}\r\n\t#foreach($s_attribute in $app.station)\r\n\t\tpublic ${s_attribute.type} get${s_attribute.name}()\r\n\t\t{\r\n\t\t\treturn  get${s_attribute.name}();\r\n\t\t}\r\n\t#end\r\n    }\r\n\r\n\r\n    \r\n\r\nThe problem is s_attribute.name first character is lowercase. When I create getter and setter function for attributes. I need change first character to uppercase. \r\n\r\nDid anyone know how to do it?","title":"Velocity string function","body":"<p>I just start using Java Velocity. \nNow I want to create a java class template. </p>\n\n<pre><code>package $app.package_namespace\npublic class ${app.name}Station\n\n{\n    #foreach($s_attribute in $app.station)\n         $s_attribute.type $s_attribute.name,\n    #end\n    public $app.name Station(#foreach($s_attribute in $app.station)\n                                 $s_attribute.type $s_attribute.name;\n                             #end)\n{\n    #foreach($s_attribute in $app.station)\n          $s_attribute.name=$s_attribute.name;\n    #end\n}\n#foreach($s_attribute in $app.station)\n    public ${s_attribute.type} get${s_attribute.name}()\n    {\n        return  get${s_attribute.name}();\n    }\n#end\n}\n</code></pre>\n\n<p>The problem is s_attribute.name first character is lowercase. When I create getter and setter function for attributes. I need change first character to uppercase. </p>\n\n<p>Did anyone know how to do it?</p>\n"},{"tags":["java","libgdx","game-physics"],"answers":[{"tags":[],"owner":{"account_id":4322016,"reputation":36,"user_id":3529898,"display_name":"Tony Immanuvel"},"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1689945048,"creation_date":1689646794,"answer_id":76709152,"question_id":76697270,"body_markdown":"X velocity should be based on the pull the ball experiences along X axis.  \r\nY Velocity should be the pull the ball experiences along Y axis.\r\n\r\n   xPull = ballRestPositionX - ballPulledPositionX\r\n   yPull = ballRestPositionY - ballPulledPositionY\r\n \r\n    Xvelocity = xPull * powerFactor * -1. \r\n    Yvelocity = yPull * powerFactor * -1. \r\n\r\n(power factor 3 should let the ball travel 3 times more in the direction if time is 1 sec)\r\n\r\nI don&#39;t think, sin(Q) or Cos(Q) are required at this point of time.\r\n\r\n\r\nThis way you can calculate the peak only after time (t).\r\n\r\ntime T is proportional to the length of pull. Longer one pulls, more time it will travel.\r\n\r\n    timeOfTravlel = SQRT(Xpull^2 + yPull^2) * someFactor.\r\n\r\nSo destination peak will be \r\n\r\n    ballNewX = ballPulledPositionX + timeOfTravel * xVelocity\r\n    ballNewY = ballPulledPositionY + timeOfTravel * yVelocity\r\n\r\nFor trajectory, apply some gravity. Break time into slices. Reduce velocity against gravity in each time slice and as we move in time velocity becomes closer to gravity and touches ground. That will be giving you trajectory.\r\n\r\nTypically calculations should be out of render method, ideally at `ClickEvent` or Time based update events.","title":"What am I doing wrongly in calculating the projection of a ball (java and libgdx)","body":"<p>X velocity should be based on the pull the ball experiences along X axis.<br />\nY Velocity should be the pull the ball experiences along Y axis.</p>\n<p>xPull = ballRestPositionX - ballPulledPositionX\nyPull = ballRestPositionY - ballPulledPositionY</p>\n<pre><code>Xvelocity = xPull * powerFactor * -1. \nYvelocity = yPull * powerFactor * -1. \n</code></pre>\n<p>(power factor 3 should let the ball travel 3 times more in the direction if time is 1 sec)</p>\n<p>I don't think, sin(Q) or Cos(Q) are required at this point of time.</p>\n<p>This way you can calculate the peak only after time (t).</p>\n<p>time T is proportional to the length of pull. Longer one pulls, more time it will travel.</p>\n<pre><code>timeOfTravlel = SQRT(Xpull^2 + yPull^2) * someFactor.\n</code></pre>\n<p>So destination peak will be</p>\n<pre><code>ballNewX = ballPulledPositionX + timeOfTravel * xVelocity\nballNewY = ballPulledPositionY + timeOfTravel * yVelocity\n</code></pre>\n<p>For trajectory, apply some gravity. Break time into slices. Reduce velocity against gravity in each time slice and as we move in time velocity becomes closer to gravity and touches ground. That will be giving you trajectory.</p>\n<p>Typically calculations should be out of render method, ideally at <code>ClickEvent</code> or Time based update events.</p>\n"}],"owner":{"account_id":26991848,"reputation":62,"user_id":20554626,"display_name":"sammy medawar"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":43,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":76709152,"answer_count":1,"score":0,"last_activity_date":1689945048,"creation_date":1689495068,"question_id":76697270,"body_markdown":"I am working on an Angry Birds-like game where the user can drag a ball to launch it in the opposite direction with power proportional to the duration of the drag. However, I&#39;m encountering two problems. Firstly, the ball doesn&#39;t go in the opposite direction of the drag motion. Secondly, the new x position of the ball doesn&#39;t seem correct; it appears to be too close to the initial point. I am currently setting the new y position to always be 0 for testing purposes. Please note that I only want to teleport the ball to its new position and will handle the trajectory later.\r\nThis is the concerned code:\r\n\r\n\r\n      `      private void renderGame() {\r\n        batch.begin();\r\n        batch.draw(background, 0, 0, Gdx.graphics.getWidth(), Gdx.graphics.getHeight());\r\n        if (inputProcessor.isShotCompleted()) {\r\n            /// Calculate the new ball position based on the shot parameters\r\n            float power = inputProcessor.getPower();\r\n            float angle = inputProcessor.getAngle();\r\n            float initialBallX = inputProcessor.getBallX();\r\n            float initialBallY = inputProcessor.getBallY();\r\n            // Calculate the initial velocity components\r\n            float velocityX = power * BALL_SPEED * MathUtils.cos(angle);\r\n            float velocityY = power * BALL_SPEED * MathUtils.sin(angle);\r\n            // Calculate the time of flight\r\n            float time = (2 * power * MathUtils.sin(angle)) / 9.8f;\r\n            // Calculate the new ball position\r\n            float newBallX = initialBallX + (velocityX * time);\r\n            float newBallY = 0;\r\n            // Update the ball&#39;s position\r\n            inputProcessor.setBallX(newBallX);\r\n            inputProcessor.setBallY(newBallY);\r\n            ballX = newBallX;\r\n            ballY = newBallY;\r\n            // Reset shot completion flag\r\n            inputProcessor.isShotCompleted = false;\r\n        }\r\n        else{\r\n            // Draw the ball at its current position with rotation\r\n            float ballX = inputProcessor.getBallX();\r\n            float ballY = inputProcessor.getBallY();\r\n        }\r\n        // Update the rotation angle of the ball\r\n        rotationAngle = (rotationAngle + Gdx.graphics.getDeltaTime() * 100) % 360;\r\n        batch.draw(playerCharacter, ballX - BALL_RADIUS, ballY - BALL_RADIUS,\r\n                BALL_RADIUS, BALL_RADIUS, BALL_RADIUS * 2,\r\n                BALL_RADIUS * 2, 1, 1, rotationAngle);\r\n        batch.end();\r\n    }`\r\n\r\n\r\nHeres the link to my code I have a problem with posting it on stackoverflow with format errors:\r\nhttps://pastebin.com/WMRB229i\r\n[![Initial Position of ball](https://i.stack.imgur.com/x8IwM.png)](https://i.stack.imgur.com/x8IwM.png)\r\n[![The trajectory I want to change the ball to (blue dashes) and the strength of the drag (white line)](https://i.stack.imgur.com/xxVSt.png)](https://i.stack.imgur.com/xxVSt.png)\r\n[![Final Position of ball](https://i.stack.imgur.com/ljctH.png)](https://i.stack.imgur.com/ljctH.png)\r\n\r\n\r\nEdit: In general, it seems to be going in the same direction as the white line even though it should be the opposite. Additionally, rather than throwing the ball, it just acts like it shoots it down directly even though I shot it up\r\n","title":"What am I doing wrongly in calculating the projection of a ball (java and libgdx)","body":"<p>I am working on an Angry Birds-like game where the user can drag a ball to launch it in the opposite direction with power proportional to the duration of the drag. However, I'm encountering two problems. Firstly, the ball doesn't go in the opposite direction of the drag motion. Secondly, the new x position of the ball doesn't seem correct; it appears to be too close to the initial point. I am currently setting the new y position to always be 0 for testing purposes. Please note that I only want to teleport the ball to its new position and will handle the trajectory later.\nThis is the concerned code:</p>\n<pre><code>  `      private void renderGame() {\n    batch.begin();\n    batch.draw(background, 0, 0, Gdx.graphics.getWidth(), Gdx.graphics.getHeight());\n    if (inputProcessor.isShotCompleted()) {\n        /// Calculate the new ball position based on the shot parameters\n        float power = inputProcessor.getPower();\n        float angle = inputProcessor.getAngle();\n        float initialBallX = inputProcessor.getBallX();\n        float initialBallY = inputProcessor.getBallY();\n        // Calculate the initial velocity components\n        float velocityX = power * BALL_SPEED * MathUtils.cos(angle);\n        float velocityY = power * BALL_SPEED * MathUtils.sin(angle);\n        // Calculate the time of flight\n        float time = (2 * power * MathUtils.sin(angle)) / 9.8f;\n        // Calculate the new ball position\n        float newBallX = initialBallX + (velocityX * time);\n        float newBallY = 0;\n        // Update the ball's position\n        inputProcessor.setBallX(newBallX);\n        inputProcessor.setBallY(newBallY);\n        ballX = newBallX;\n        ballY = newBallY;\n        // Reset shot completion flag\n        inputProcessor.isShotCompleted = false;\n    }\n    else{\n        // Draw the ball at its current position with rotation\n        float ballX = inputProcessor.getBallX();\n        float ballY = inputProcessor.getBallY();\n    }\n    // Update the rotation angle of the ball\n    rotationAngle = (rotationAngle + Gdx.graphics.getDeltaTime() * 100) % 360;\n    batch.draw(playerCharacter, ballX - BALL_RADIUS, ballY - BALL_RADIUS,\n            BALL_RADIUS, BALL_RADIUS, BALL_RADIUS * 2,\n            BALL_RADIUS * 2, 1, 1, rotationAngle);\n    batch.end();\n}`\n</code></pre>\n<p>Heres the link to my code I have a problem with posting it on stackoverflow with format errors:\n<a href=\"https://pastebin.com/WMRB229i\" rel=\"nofollow noreferrer\">https://pastebin.com/WMRB229i</a>\n<a href=\"https://i.stack.imgur.com/x8IwM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x8IwM.png\" alt=\"Initial Position of ball\" /></a>\n<a href=\"https://i.stack.imgur.com/xxVSt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xxVSt.png\" alt=\"The trajectory I want to change the ball to (blue dashes) and the strength of the drag (white line)\" /></a>\n<a href=\"https://i.stack.imgur.com/ljctH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ljctH.png\" alt=\"Final Position of ball\" /></a></p>\n<p>Edit: In general, it seems to be going in the same direction as the white line even though it should be the opposite. Additionally, rather than throwing the ball, it just acts like it shoots it down directly even though I shot it up</p>\n"},{"tags":["java","android-studio","runtime-permissions"],"owner":{"account_id":1608382,"reputation":767,"user_id":1487979,"accept_rate":68,"display_name":"Luigino"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":64,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689944739,"creation_date":1689944739,"question_id":76738278,"body_markdown":"I have this simple code: \r\n\r\n    public class MainActivity externds AppCompatActivity {\r\n    \r\n        final String[] PERMISSIONS = {\r\n                Manifest.permission.ACCESS_FINE_LOCATION,\r\n                Manifest.permission.BLUETOOTH_CONNECT\r\n        };\r\n    \r\n        private ActivityResultLauncher&lt;String[]&gt; permission = registerForActivityResult(\r\n                new ActivityResultContracts.RequestMultiplePermissions(),\r\n                isGranted -&gt; { System.out.println(&quot;PERMISSIONS - &quot; + isGranted ); } \r\n        );\r\n    \t\r\n    \t@Override\r\n        protected void onCreate(Bundle savedInstanceState) {\r\n            super.onCreate(savedInstanceState);\r\n    \r\n            getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);\r\n            binding = ActivityMainBinding.inflate(getLayoutInflater());\r\n            setContentView(binding.getRoot());\r\n    \r\n    \t\tpermission.launch(PERMISSIONS);\r\n    \r\n    \t\tbinding.fab.setOnClickListener(new View.OnClickListener() { .... });\r\n    \t\t\r\n    \t}\r\n    }\r\n\r\nas I read somewhere about `registerForActivityResult` (due the old `onRequestPermissionsResult` is deprecated...) it should wait until user has completed grant/refuse permissions requests but in my debug it looks like it doesn&#39;t wait....shall I have missed something when I am threatening `isGranted` variable? Thanks in advance! Cheers! :-)","title":"Java - shouldn&#39;t registerForActivityResult wait until permissions request are done?","body":"<p>I have this simple code:</p>\n<pre><code>public class MainActivity externds AppCompatActivity {\n\n    final String[] PERMISSIONS = {\n            Manifest.permission.ACCESS_FINE_LOCATION,\n            Manifest.permission.BLUETOOTH_CONNECT\n    };\n\n    private ActivityResultLauncher&lt;String[]&gt; permission = registerForActivityResult(\n            new ActivityResultContracts.RequestMultiplePermissions(),\n            isGranted -&gt; { System.out.println(&quot;PERMISSIONS - &quot; + isGranted ); } \n    );\n    \n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n\n        getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);\n        binding = ActivityMainBinding.inflate(getLayoutInflater());\n        setContentView(binding.getRoot());\n\n        permission.launch(PERMISSIONS);\n\n        binding.fab.setOnClickListener(new View.OnClickListener() { .... });\n        \n    }\n}\n</code></pre>\n<p>as I read somewhere about <code>registerForActivityResult</code> (due the old <code>onRequestPermissionsResult</code> is deprecated...) it should wait until user has completed grant/refuse permissions requests but in my debug it looks like it doesn't wait....shall I have missed something when I am threatening <code>isGranted</code> variable? Thanks in advance! Cheers! :-)</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":9165235,"reputation":15414,"user_id":6815131,"display_name":"Joe C"},"score":0,"creation_date":1479053583,"post_id":40574892,"comment_id":68387242,"body_markdown":"Have you captured what was sent with a tool like Wireshark to confirm that the header is actually absent?","body":"Have you captured what was sent with a tool like Wireshark to confirm that the header is actually absent?"}],"answers":[{"tags":[],"owner":{"account_id":2111260,"reputation":4443,"user_id":5651109,"accept_rate":75,"display_name":"Navoneel Talukdar"},"down_vote_count":1,"up_vote_count":121,"is_accepted":true,"score":120,"last_activity_date":1501735566,"creation_date":1479054697,"answer_id":40576153,"question_id":40574892,"body_markdown":"As you set `application/x-www-form-urlencoded` as content type so data sent must be like this format.\r\n\r\n    String urlParameters  = &quot;param1=data1&amp;param2=data2&amp;param3=data3&quot;;\r\n\r\nSending part now is quite straightforward.\r\n\r\n    byte[] postData = urlParameters.getBytes( StandardCharsets.UTF_8 );\r\n    int postDataLength = postData.length;\r\n    String request = &quot;&lt;Url here&gt;&quot;;\r\n    URL url = new URL( request );\r\n    HttpURLConnection conn= (HttpURLConnection) url.openConnection();           \r\n    conn.setDoOutput(true);\r\n    conn.setInstanceFollowRedirects(false);\r\n    conn.setRequestMethod(&quot;POST&quot;);\r\n    conn.setRequestProperty(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;); \r\n    conn.setRequestProperty(&quot;charset&quot;, &quot;utf-8&quot;);\r\n    conn.setRequestProperty(&quot;Content-Length&quot;, Integer.toString(postDataLength ));\r\n    conn.setUseCaches(false);\r\n    try(DataOutputStream wr = new DataOutputStream(conn.getOutputStream())) {\r\n       wr.write( postData );\r\n    }\r\n\r\nOr you can create a generic method to build key value pattern which is required for `application/x-www-form-urlencoded`.\r\n\r\n    private String getDataString(HashMap&lt;String, String&gt; params) throws UnsupportedEncodingException{\r\n        StringBuilder result = new StringBuilder();\r\n        boolean first = true;\r\n        for(Map.Entry&lt;String, String&gt; entry : params.entrySet()){\r\n            if (first)\r\n                first = false;\r\n            else\r\n                result.append(&quot;&amp;&quot;);    \r\n            result.append(URLEncoder.encode(entry.getKey(), &quot;UTF-8&quot;));\r\n            result.append(&quot;=&quot;);\r\n            result.append(URLEncoder.encode(entry.getValue(), &quot;UTF-8&quot;));\r\n        }    \r\n        return result.toString();\r\n    }\r\n\r\n","title":"How to send post request with x-www-form-urlencoded body","body":"<p>As you set <code>application/x-www-form-urlencoded</code> as content type so data sent must be like this format.</p>\n\n<pre><code>String urlParameters  = \"param1=data1&amp;param2=data2&amp;param3=data3\";\n</code></pre>\n\n<p>Sending part now is quite straightforward.</p>\n\n<pre><code>byte[] postData = urlParameters.getBytes( StandardCharsets.UTF_8 );\nint postDataLength = postData.length;\nString request = \"&lt;Url here&gt;\";\nURL url = new URL( request );\nHttpURLConnection conn= (HttpURLConnection) url.openConnection();           \nconn.setDoOutput(true);\nconn.setInstanceFollowRedirects(false);\nconn.setRequestMethod(\"POST\");\nconn.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\"); \nconn.setRequestProperty(\"charset\", \"utf-8\");\nconn.setRequestProperty(\"Content-Length\", Integer.toString(postDataLength ));\nconn.setUseCaches(false);\ntry(DataOutputStream wr = new DataOutputStream(conn.getOutputStream())) {\n   wr.write( postData );\n}\n</code></pre>\n\n<p>Or you can create a generic method to build key value pattern which is required for <code>application/x-www-form-urlencoded</code>.</p>\n\n<pre><code>private String getDataString(HashMap&lt;String, String&gt; params) throws UnsupportedEncodingException{\n    StringBuilder result = new StringBuilder();\n    boolean first = true;\n    for(Map.Entry&lt;String, String&gt; entry : params.entrySet()){\n        if (first)\n            first = false;\n        else\n            result.append(\"&amp;\");    \n        result.append(URLEncoder.encode(entry.getKey(), \"UTF-8\"));\n        result.append(\"=\");\n        result.append(URLEncoder.encode(entry.getValue(), \"UTF-8\"));\n    }    \n    return result.toString();\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":5003993,"reputation":1317,"user_id":4022159,"accept_rate":50,"display_name":"Nutan"},"down_vote_count":1,"up_vote_count":39,"is_accepted":false,"score":38,"last_activity_date":1502176021,"creation_date":1502092254,"answer_id":45541862,"question_id":40574892,"body_markdown":"For `HttpEntity`, the below answer works\r\n\r\n    HttpHeaders headers = new HttpHeaders();\r\n    headers.setContentType(MediaType.APPLICATION_FORM_URLENCODED);\r\n    \r\n    MultiValueMap&lt;String, String&gt; map= new LinkedMultiValueMap&lt;String, String&gt;();\r\n    map.add(&quot;email&quot;, &quot;first.last@example.com&quot;);\r\n    \r\n    HttpEntity&lt;MultiValueMap&lt;String, String&gt;&gt; request = new HttpEntity&lt;MultiValueMap&lt;String, String&gt;&gt;(map, headers);\r\n    \r\n    ResponseEntity&lt;String&gt; response = restTemplate.postForEntity( url, request , String.class );\r\n\r\nFor reference:\r\nhttps://stackoverflow.com/questions/38372422/how-to-post-form-data-with-spring-resttemplate","title":"How to send post request with x-www-form-urlencoded body","body":"<p>For <code>HttpEntity</code>, the below answer works</p>\n\n<pre><code>HttpHeaders headers = new HttpHeaders();\nheaders.setContentType(MediaType.APPLICATION_FORM_URLENCODED);\n\nMultiValueMap&lt;String, String&gt; map= new LinkedMultiValueMap&lt;String, String&gt;();\nmap.add(\"email\", \"first.last@example.com\");\n\nHttpEntity&lt;MultiValueMap&lt;String, String&gt;&gt; request = new HttpEntity&lt;MultiValueMap&lt;String, String&gt;&gt;(map, headers);\n\nResponseEntity&lt;String&gt; response = restTemplate.postForEntity( url, request , String.class );\n</code></pre>\n\n<p>For reference:\n<a href=\"https://stackoverflow.com/questions/38372422/how-to-post-form-data-with-spring-resttemplate\">How to POST form data with Spring RestTemplate?</a></p>\n"},{"tags":[],"owner":{"account_id":18829289,"reputation":1,"user_id":13733478,"display_name":"Mohsen Miri"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1611149416,"creation_date":1611149416,"answer_id":65810532,"question_id":40574892,"body_markdown":"    string urlParameters = &quot;param1=value1&amp;param2=value2&quot;;\r\n    string _endPointName = &quot;your url post api&quot;;\r\n    \r\n    var httpWebRequest = (HttpWebRequest)WebRequest.Create(_endPointName);\r\n    \r\n    httpWebRequest.ContentType = &quot;application/x-www-form-urlencoded&quot;;\r\n    httpWebRequest.Method = &quot;POST&quot;;\r\n    httpWebRequest.Headers[&quot;ContentType&quot;] = &quot;application/x-www-form-urlencoded&quot;;\r\n    \r\n    System.Net.ServicePointManager.ServerCertificateValidationCallback +=\r\n                                                      (se, cert, chain, sslerror) =&gt;\r\n                                                      {\r\n                                                          return true;\r\n                                                      };\r\n    \r\n    \r\n    using (var streamWriter = new StreamWriter(httpWebRequest.GetRequestStream()))\r\n                    {\r\n                        streamWriter.Write(urlParameters);\r\n                        streamWriter.Flush();\r\n                        streamWriter.Close();\r\n                    }\r\n    var httpResponse = (HttpWebResponse)httpWebRequest.GetResponse();\r\n    \r\n    using (var streamReader = new StreamReader(httpResponse.GetResponseStream()))\r\n                    {\r\n                        var result = streamReader.ReadToEnd();\r\n                    }","title":"How to send post request with x-www-form-urlencoded body","body":"<pre><code>string urlParameters = &quot;param1=value1&amp;param2=value2&quot;;\nstring _endPointName = &quot;your url post api&quot;;\n\nvar httpWebRequest = (HttpWebRequest)WebRequest.Create(_endPointName);\n\nhttpWebRequest.ContentType = &quot;application/x-www-form-urlencoded&quot;;\nhttpWebRequest.Method = &quot;POST&quot;;\nhttpWebRequest.Headers[&quot;ContentType&quot;] = &quot;application/x-www-form-urlencoded&quot;;\n\nSystem.Net.ServicePointManager.ServerCertificateValidationCallback +=\n                                                  (se, cert, chain, sslerror) =&gt;\n                                                  {\n                                                      return true;\n                                                  };\n\n\nusing (var streamWriter = new StreamWriter(httpWebRequest.GetRequestStream()))\n                {\n                    streamWriter.Write(urlParameters);\n                    streamWriter.Flush();\n                    streamWriter.Close();\n                }\nvar httpResponse = (HttpWebResponse)httpWebRequest.GetResponse();\n\nusing (var streamReader = new StreamReader(httpResponse.GetResponseStream()))\n                {\n                    var result = streamReader.ReadToEnd();\n                }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":111410,"reputation":8252,"user_id":294317,"accept_rate":69,"display_name":"Nathan"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1646859299,"creation_date":1646859299,"answer_id":71415884,"question_id":40574892,"body_markdown":"Building off of [Navoneel&#39;s answer][1], I like to use [StreamEx&#39;s][2] [EntryStream][3].\r\n\r\nHere is Naveoneel&#39;s method re-written.\r\n\r\n```java\r\nprivate String getDataString(HashMap&lt;String, String&gt; params)\r\n{\r\n   return EntryStream.\r\n      of(data).\r\n      mapKeys(key -&gt; URLEncoder.encode(key, StandardCharsets.UTF_8)).        // Encode the keys\r\n      mapValues(value -&gt; URLEncoder.encode(value, StandardCharsets.UTF_8)).  // Encode the values\r\n      join(&quot;=&quot;).                                                             // Create a key=value\r\n      joining(&quot;&amp;&quot;);                                                          // Assemble into key1=value1&amp;key2=value2...\r\n}\r\n```\r\n\r\n  [1]: https://stackoverflow.com/a/40576153/294317\r\n  [2]: https://github.com/amaembo/streamex\r\n  [3]: https://amaembo.github.io/streamex/javadoc/one/util/streamex/EntryStream.html","title":"How to send post request with x-www-form-urlencoded body","body":"<p>Building off of <a href=\"https://stackoverflow.com/a/40576153/294317\">Navoneel's answer</a>, I like to use <a href=\"https://github.com/amaembo/streamex\" rel=\"nofollow noreferrer\">StreamEx's</a> <a href=\"https://amaembo.github.io/streamex/javadoc/one/util/streamex/EntryStream.html\" rel=\"nofollow noreferrer\">EntryStream</a>.</p>\n<p>Here is Naveoneel's method re-written.</p>\n<pre class=\"lang-java prettyprint-override\"><code>private String getDataString(HashMap&lt;String, String&gt; params)\n{\n   return EntryStream.\n      of(data).\n      mapKeys(key -&gt; URLEncoder.encode(key, StandardCharsets.UTF_8)).        // Encode the keys\n      mapValues(value -&gt; URLEncoder.encode(value, StandardCharsets.UTF_8)).  // Encode the values\n      join(&quot;=&quot;).                                                             // Create a key=value\n      joining(&quot;&amp;&quot;);                                                          // Assemble into key1=value1&amp;key2=value2...\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1106279,"reputation":9834,"user_id":1097600,"accept_rate":80,"display_name":"Sorter"},"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1651397650,"creation_date":1651397650,"answer_id":72075557,"question_id":40574892,"body_markdown":"### Use Java 11 HttpClient\r\n\r\n&gt; The HTTP Client was added in Java 11. It can be used to request HTTP resources over the network. It supports HTTP/1.1 and HTTP/2, both synchronous and asynchronous programming models, handles request and response bodies as reactive-streams, and follows the familiar builder pattern.\r\n\r\nhttps://openjdk.java.net/groups/net/httpclient/intro.html\r\n\r\n```java\r\nHttpClient client = HttpClient.newHttpClient();;\r\nHttpRequest request = HttpRequest.newBuilder()\r\n        .uri(new URI(targetUrl))\r\n        .POST(urlParameters)\r\n        .headers(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;)\r\n        .build();\r\nHttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());\r\n```","title":"How to send post request with x-www-form-urlencoded body","body":"<h3>Use Java 11 HttpClient</h3>\n<blockquote>\n<p>The HTTP Client was added in Java 11. It can be used to request HTTP resources over the network. It supports HTTP/1.1 and HTTP/2, both synchronous and asynchronous programming models, handles request and response bodies as reactive-streams, and follows the familiar builder pattern.</p>\n</blockquote>\n<p><a href=\"https://openjdk.java.net/groups/net/httpclient/intro.html\" rel=\"nofollow noreferrer\">https://openjdk.java.net/groups/net/httpclient/intro.html</a></p>\n<pre class=\"lang-java prettyprint-override\"><code>HttpClient client = HttpClient.newHttpClient();;\nHttpRequest request = HttpRequest.newBuilder()\n        .uri(new URI(targetUrl))\n        .POST(urlParameters)\n        .headers(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;)\n        .build();\nHttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8056033,"reputation":2316,"user_id":6073148,"accept_rate":75,"display_name":"Zahid Khan"},"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1665385599,"creation_date":1665385599,"answer_id":74011255,"question_id":40574892,"body_markdown":"# Problem with the Response!\r\nI had a similar issue when I was sending the request of media type `application/x-www-form-urlencoded` from Postman I was receiving a correct response.\r\n\r\nHowever, when sending the request using code, I was receiving jargon somewhat like:\r\n\r\n```\r\n�-�YO�`:ur���g�\r\n.n��l���u)�i�h3J%Gl�?����k  \r\n\r\n```\r\n\r\n---\r\n#### What I tried: \r\nOut of frustration for multiple days tried all the possible solutions from changing character sets to changing header values to code changes and whatnot.\r\n\r\n---\r\n\r\n# Solution lies in Postman.\r\n\r\n[![Code Generation][1]][1]\r\n\r\n\r\n## Select Java-OkHttp\r\n\r\n[![enter image description here][2]][2]\r\n\r\nCopy the code and paste it into IDE.\r\n\r\nThat&#39;s it.\r\n\r\nReference for HttpOk:\r\nhttps://www.vogella.com/tutorials/JavaLibrary-OkHttp/article.html\r\n\r\n  [1]: https://i.stack.imgur.com/03ohB.png\r\n  [2]: https://i.stack.imgur.com/7yx4Y.png","title":"How to send post request with x-www-form-urlencoded body","body":"<h1>Problem with the Response!</h1>\n<p>I had a similar issue when I was sending the request of media type <code>application/x-www-form-urlencoded</code> from Postman I was receiving a correct response.</p>\n<p>However, when sending the request using code, I was receiving jargon somewhat like:</p>\n<pre><code>�-�YO�`:ur���g�\n.n��l���u)�i�h3J%Gl�?����k  \n\n</code></pre>\n<hr />\n<h4>What I tried:</h4>\n<p>Out of frustration for multiple days tried all the possible solutions from changing character sets to changing header values to code changes and whatnot.</p>\n<hr />\n<h1>Solution lies in Postman.</h1>\n<p><a href=\"https://i.stack.imgur.com/03ohB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/03ohB.png\" alt=\"Code Generation\" /></a></p>\n<h2>Select Java-OkHttp</h2>\n<p><a href=\"https://i.stack.imgur.com/7yx4Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7yx4Y.png\" alt=\"enter image description here\" /></a></p>\n<p>Copy the code and paste it into IDE.</p>\n<p>That's it.</p>\n<p>Reference for HttpOk:\n<a href=\"https://www.vogella.com/tutorials/JavaLibrary-OkHttp/article.html\" rel=\"nofollow noreferrer\">https://www.vogella.com/tutorials/JavaLibrary-OkHttp/article.html</a></p>\n"},{"tags":[],"owner":{"account_id":20739013,"reputation":1,"user_id":15237082,"display_name":"gabriel vieira do nascimento"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689943563,"creation_date":1689943563,"answer_id":76738145,"question_id":40574892,"body_markdown":"\r\n    HttpClient httpClient = HttpClientBuilder.create().build();\r\n    HttpPost httpPost = new HttpPost(uri);\r\n    httpPost.setHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;); // Alterado para x-www-form-urlencoded\r\n\r\n    HttpResponse response;\r\n\r\n    List&lt;NameValuePair&gt; params = new ArrayList&lt;&gt;();\r\n    params.add(new BasicNameValuePair(&quot;email&quot;, usuario));\r\n    params.add(new BasicNameValuePair(&quot;password&quot;, senha));\r\n    params.add(new BasicNameValuePair(&quot;tenantId&quot;, tenantId));\r\n\r\n    UrlEncodedFormEntity urlEncodedFormEntity = new UrlEncodedFormEntity(params);\r\n\r\n    httpPost.getRequestLine();\r\n    httpPost.setEntity(urlEncodedFormEntity);\r\n\r\n    MainActivity.logMainRequest(&quot;UriRequest:&quot; + uri);\r\n    MainActivity.logMainRequest(&quot;JsonRequest:&quot; + params);\r\n\r\n    response = httpClient.execute(httpPost);","title":"How to send post request with x-www-form-urlencoded body","body":"<pre><code>HttpClient httpClient = HttpClientBuilder.create().build();\nHttpPost httpPost = new HttpPost(uri);\nhttpPost.setHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;); // Alterado para x-www-form-urlencoded\n\nHttpResponse response;\n\nList&lt;NameValuePair&gt; params = new ArrayList&lt;&gt;();\nparams.add(new BasicNameValuePair(&quot;email&quot;, usuario));\nparams.add(new BasicNameValuePair(&quot;password&quot;, senha));\nparams.add(new BasicNameValuePair(&quot;tenantId&quot;, tenantId));\n\nUrlEncodedFormEntity urlEncodedFormEntity = new UrlEncodedFormEntity(params);\n\nhttpPost.getRequestLine();\nhttpPost.setEntity(urlEncodedFormEntity);\n\nMainActivity.logMainRequest(&quot;UriRequest:&quot; + uri);\nMainActivity.logMainRequest(&quot;JsonRequest:&quot; + params);\n\nresponse = httpClient.execute(httpPost);\n</code></pre>\n"}],"owner":{"account_id":8704382,"reputation":953,"user_id":6514477,"display_name":"mari"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":292578,"favorite_count":0,"down_vote_count":2,"up_vote_count":95,"accepted_answer_id":40576153,"answer_count":7,"score":93,"last_activity_date":1689943563,"creation_date":1479047070,"question_id":40574892,"body_markdown":"![Request in postman][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/azap0.png\r\n\r\nHow in java, can I send a request with `x-www-form-urlencoded header`. I don&#39;t understand how to send a body with a key-value, like in the above screenshot.\r\n\r\nI have tried this code:\r\n\r\n    String urlParameters =\r\n      cafedra_name+ data_to_send;\r\n    URL url;\r\n        HttpURLConnection connection = null;  \r\n        try {\r\n          //Create connection\r\n          url = new URL(targetURL);\r\n          connection = (HttpURLConnection)url.openConnection();\r\n          connection.setRequestMethod(&quot;POST&quot;);\r\n          connection.setRequestProperty(&quot;Content-Type&quot;, \r\n               &quot;application/x-www-form-urlencoded&quot;);\r\n    \t\t\t\r\n          connection.setRequestProperty(&quot;Content-Length&quot;, &quot;&quot; + \r\n                   Integer.toString(urlParameters.getBytes().length));\r\n          connection.setRequestProperty(&quot;Content-Language&quot;, &quot;en-US&quot;);  \r\n    \t\t\t\r\n          connection.setUseCaches (false);\r\n          connection.setDoInput(true);\r\n          connection.setDoOutput(true);\r\n    \r\n          //Send request\r\n          DataOutputStream wr = new DataOutputStream (\r\n                      connection.getOutputStream ());\r\n          wr.writeBytes (urlParameters);\r\n          wr.flush ();\r\n          wr.close ();\r\n\r\nBut in the response, I don&#39;t receive the correct data.","title":"How to send post request with x-www-form-urlencoded body","body":"<p><img src=\"https://i.stack.imgur.com/azap0.png\" alt=\"Request in postman\"></p>\n\n<p>How in java, can I send a request with <code>x-www-form-urlencoded header</code>. I don't understand how to send a body with a key-value, like in the above screenshot.</p>\n\n<p>I have tried this code:</p>\n\n<pre><code>String urlParameters =\n  cafedra_name+ data_to_send;\nURL url;\n    HttpURLConnection connection = null;  \n    try {\n      //Create connection\n      url = new URL(targetURL);\n      connection = (HttpURLConnection)url.openConnection();\n      connection.setRequestMethod(\"POST\");\n      connection.setRequestProperty(\"Content-Type\", \n           \"application/x-www-form-urlencoded\");\n\n      connection.setRequestProperty(\"Content-Length\", \"\" + \n               Integer.toString(urlParameters.getBytes().length));\n      connection.setRequestProperty(\"Content-Language\", \"en-US\");  \n\n      connection.setUseCaches (false);\n      connection.setDoInput(true);\n      connection.setDoOutput(true);\n\n      //Send request\n      DataOutputStream wr = new DataOutputStream (\n                  connection.getOutputStream ());\n      wr.writeBytes (urlParameters);\n      wr.flush ();\n      wr.close ();\n</code></pre>\n\n<p>But in the response, I don't receive the correct data.</p>\n"},{"tags":["java","excel","spring-boot","jxls"],"answers":[{"tags":[],"owner":{"account_id":23702888,"reputation":11,"user_id":17725834,"display_name":"Abhishek"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689942204,"creation_date":1689942204,"answer_id":76737973,"question_id":76737413,"body_markdown":"I have found the solution. In my service class, I need to add this line of code before reading the excel to avoid the `org.jxls.reader.XLSDataReadException` exception: `ReaderConfig.getInstance().setSkipErrors(true);`. With this adjustment, the code will read the empty cell and return 0 without any issues.","title":"How do I handle empty cells while reading Excel with org.jxls in Spring Boot?","body":"<p>I have found the solution. In my service class, I need to add this line of code before reading the excel to avoid the <code>org.jxls.reader.XLSDataReadException</code> exception: <code>ReaderConfig.getInstance().setSkipErrors(true);</code>. With this adjustment, the code will read the empty cell and return 0 without any issues.</p>\n"}],"owner":{"account_id":23702888,"reputation":11,"user_id":17725834,"display_name":"Abhishek"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":83,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1689942508,"creation_date":1689937622,"question_id":76737413,"body_markdown":"I am using the org.jxls library in a Spring Boot project to read an Excel file. The reading process is working fine, but when it encounters an empty cell, it throws an org.jxls.reader.XLSDataReadException exception. I would like to skip reading the empty cell and continue with the next cell.\r\n\r\nHere is my XML configuration file.\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;\r\n    &lt;workbook&gt;\r\n        &lt;worksheet name=&quot;Sheet1&quot;&gt;\r\n            &lt;section startRow=&quot;0&quot; endRow=&quot;0&quot; /&gt;\r\n            &lt;loop startRow=&quot;1&quot; endRow=&quot;1&quot; items=&quot;estimations&quot; var=&quot;estimation&quot;\r\n                varType=&quot;com.osi.exceljxls.entities.Estimation&quot;&gt;\r\n                &lt;section startRow=&quot;1&quot; endRow=&quot;1&quot;&gt;\r\n                    &lt;mapping row=&quot;1&quot; col=&quot;0&quot;&gt;estimation.role&lt;/mapping&gt;\r\n                    &lt;mapping row=&quot;1&quot; col=&quot;1&quot;&gt;estimation.noOfResources&lt;/mapping&gt;\r\n                    &lt;mapping row=&quot;1&quot; col=&quot;3&quot;&gt;estimation.projectLocation&lt;/mapping&gt;\r\n                    &lt;!-- Other mappings --&gt;\r\n                    &lt;!-- ... --&gt;\r\n                    &lt;cellcheck offset=&quot;0&quot; evaluator=&quot;org.jxls.common.cell.reader.IsEmptyCellCheck&quot; /&gt;\r\n                &lt;/section&gt;\r\n                &lt;loopbreakcondition&gt;\r\n                    &lt;rowcheck offset=&quot;0&quot;&gt;\r\n                        &lt;cellcheck offset=&quot;0&quot; /&gt;\r\n                    &lt;/rowcheck&gt;\r\n                &lt;/loopbreakcondition&gt;\r\n            &lt;/loop&gt;\r\n          &lt;/worksheet&gt;\r\n      &lt;/workbook&gt;\r\n\r\nI have already tried adding the `&lt;cellcheck /&gt;` tag as shown above, but it doesn&#39;t seem to be working.\r\n\r\nI also considered handling the exception, but I am unsure how to proceed in that case.\r\n\r\nI would appreciate any insights or suggestions on how to skip reading empty cells or how to handle the XLSDataReadException when an empty cell is encountered. Thank you in advance!\r\n\r\n","title":"How do I handle empty cells while reading Excel with org.jxls in Spring Boot?","body":"<p>I am using the org.jxls library in a Spring Boot project to read an Excel file. The reading process is working fine, but when it encounters an empty cell, it throws an org.jxls.reader.XLSDataReadException exception. I would like to skip reading the empty cell and continue with the next cell.</p>\n<p>Here is my XML configuration file.</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;\n&lt;workbook&gt;\n    &lt;worksheet name=&quot;Sheet1&quot;&gt;\n        &lt;section startRow=&quot;0&quot; endRow=&quot;0&quot; /&gt;\n        &lt;loop startRow=&quot;1&quot; endRow=&quot;1&quot; items=&quot;estimations&quot; var=&quot;estimation&quot;\n            varType=&quot;com.osi.exceljxls.entities.Estimation&quot;&gt;\n            &lt;section startRow=&quot;1&quot; endRow=&quot;1&quot;&gt;\n                &lt;mapping row=&quot;1&quot; col=&quot;0&quot;&gt;estimation.role&lt;/mapping&gt;\n                &lt;mapping row=&quot;1&quot; col=&quot;1&quot;&gt;estimation.noOfResources&lt;/mapping&gt;\n                &lt;mapping row=&quot;1&quot; col=&quot;3&quot;&gt;estimation.projectLocation&lt;/mapping&gt;\n                &lt;!-- Other mappings --&gt;\n                &lt;!-- ... --&gt;\n                &lt;cellcheck offset=&quot;0&quot; evaluator=&quot;org.jxls.common.cell.reader.IsEmptyCellCheck&quot; /&gt;\n            &lt;/section&gt;\n            &lt;loopbreakcondition&gt;\n                &lt;rowcheck offset=&quot;0&quot;&gt;\n                    &lt;cellcheck offset=&quot;0&quot; /&gt;\n                &lt;/rowcheck&gt;\n            &lt;/loopbreakcondition&gt;\n        &lt;/loop&gt;\n      &lt;/worksheet&gt;\n  &lt;/workbook&gt;\n</code></pre>\n<p>I have already tried adding the <code>&lt;cellcheck /&gt;</code> tag as shown above, but it doesn't seem to be working.</p>\n<p>I also considered handling the exception, but I am unsure how to proceed in that case.</p>\n<p>I would appreciate any insights or suggestions on how to skip reading empty cells or how to handle the XLSDataReadException when an empty cell is encountered. Thank you in advance!</p>\n"},{"tags":["java","sonarqube"],"owner":{"account_id":17161389,"reputation":1,"user_id":12425000,"display_name":"TrustThisRobot"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":14,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689942310,"creation_date":1689942310,"question_id":76737987,"body_markdown":"So, i am trying to write a custom rule for sonarqube that it rise an isuess if it detect an REGEX that i pass them,\r\n\r\n\r\n```\r\npublic class AvoidHardCodedUsers extends IssuableSubscriptionVisitor implements JavaFileScanner {\r\nprivate static final String PATTERN = &quot;ESOP\\\\d{7}&quot;;\r\n\r\n@Override\r\npublic List&lt;Tree.Kind&gt; nodesToVisit() {\r\nreturn Arrays.asList(Tree.Kind.STRING_LITERAL);\r\n}\r\n\r\n@Override\r\npublic void visitNode(Tree tree) {\r\nLiteralTree literalTree = (LiteralTree) tree;\r\nString literalValue = literalTree.value();\r\nif (literalValue.matches(PATTERN)) {\r\ncontext.reportIssue(this, literalTree, String.format(&quot;Avoid using hard coded user in code @%s&quot;));\r\n}\r\n}\r\n\r\n}\r\n```\r\n\r\n\r\nOn the test file of the plugin i put some error like the pattern, but the error messaje says there are not test failure, \r\n\r\n\r\n\r\nI pass every type of String into the test class to match that pattern, but nothing taking the pattern as error.","title":"Sonarqube custom rule giving back not failed test","body":"<p>So, i am trying to write a custom rule for sonarqube that it rise an isuess if it detect an REGEX that i pass them,</p>\n<pre><code>public class AvoidHardCodedUsers extends IssuableSubscriptionVisitor implements JavaFileScanner {\nprivate static final String PATTERN = &quot;ESOP\\\\d{7}&quot;;\n\n@Override\npublic List&lt;Tree.Kind&gt; nodesToVisit() {\nreturn Arrays.asList(Tree.Kind.STRING_LITERAL);\n}\n\n@Override\npublic void visitNode(Tree tree) {\nLiteralTree literalTree = (LiteralTree) tree;\nString literalValue = literalTree.value();\nif (literalValue.matches(PATTERN)) {\ncontext.reportIssue(this, literalTree, String.format(&quot;Avoid using hard coded user in code @%s&quot;));\n}\n}\n\n}\n</code></pre>\n<p>On the test file of the plugin i put some error like the pattern, but the error messaje says there are not test failure,</p>\n<p>I pass every type of String into the test class to match that pattern, but nothing taking the pattern as error.</p>\n"},{"tags":["java","reactjs","cookies","jax-rs","cookie-httponly"],"comments":[{"owner":{"account_id":174208,"reputation":5254,"user_id":403425,"accept_rate":71,"display_name":"Kevin Renskers"},"score":0,"creation_date":1635448569,"post_id":64747157,"comment_id":123308423,"body_markdown":"I&#39;m having the exact same problem! Logging in and setting a HttpOnly cookie works just fine, but removing that cookie when logging out is impossible? Can&#39;t set it to an empty value, changing the max-age to 0 doesn&#39;t help either. Have you managed to solve it?","body":"I&#39;m having the exact same problem! Logging in and setting a HttpOnly cookie works just fine, but removing that cookie when logging out is impossible? Can&#39;t set it to an empty value, changing the max-age to 0 doesn&#39;t help either. Have you managed to solve it?"}],"answers":[{"tags":[],"owner":{"account_id":19705290,"reputation":954,"user_id":14427125,"display_name":"Ntshembo Hlongwane"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1604912817,"creation_date":1604912817,"answer_id":64748656,"question_id":64747157,"body_markdown":"From what you are saying is your are using httpOnly cookie so you have to understand one thing is that from the client-side you wont achieve that because then that then would defeat the purpose of having an httpOnly cookie than that would have just been the same as having a regular cookie.\r\n\r\n- So now your solution to get rid of the cookie when a user logs out is on your back-end where I am to believe the cookie was made is where you want want to delete that specific cookie. ","title":"How do I delete a HttpOnly Cookie on the client?","body":"<p>From what you are saying is your are using httpOnly cookie so you have to understand one thing is that from the client-side you wont achieve that because then that then would defeat the purpose of having an httpOnly cookie than that would have just been the same as having a regular cookie.</p>\n<ul>\n<li>So now your solution to get rid of the cookie when a user logs out is on your back-end where I am to believe the cookie was made is where you want want to delete that specific cookie.</li>\n</ul>\n"},{"tags":[],"owner":{"account_id":2632663,"reputation":387,"user_id":2278206,"display_name":"psq"},"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1689942307,"creation_date":1689942307,"answer_id":76737985,"question_id":64747157,"body_markdown":"From [MDN][1]:\r\n\r\n&gt; Max-Age=\\&lt;number&gt;\r\n&gt;\r\n&gt; Indicates the number of seconds until the cookie expires. A zero or negative number will expire the cookie immediately. If both Expires and Max-Age are set, Max-Age has precedence.\r\n\r\nMake sure that other attributes (i.e. `Path`) are set correctly: if the client&#39;s cookie is set with `Path=/`, the server should set that same value before sending the cookie. Same goes for the other attributes.\r\n\r\nThis is how I have done it, in Go:\r\n```lang-go\r\n// Taken from the handler that logs users in:\r\nsession_id := generateRandomString()\r\ncookie := &amp;http.Cookie{\r\n\tName:     &quot;session&quot;,\r\n\tValue:    session_id,\r\n\tMaxAge:   int(time.Hour.Seconds()),\r\n\tSecure:   r.TLS != nil, // r is the typical *http.Request\r\n\tHttpOnly: true,\r\n\tSameSite: http.SameSiteStrictMode,\r\n\tPath:     &quot;/&quot;,\r\n}\r\nhttp.SetCookie(w, cookie)\r\n```\r\n```lang-go\r\n// Taken from the handler that logs users out:\r\ncookie, err := r.Cookie(&quot;session&quot;)\r\nif err != nil {\r\n\thttp.Error(w, &quot;cookie not found&quot;, http.StatusUnauthorized)\r\n\treturn\r\n}\r\n// Here goes the logic to log out the user.\r\n// Once that is done, it is time to send an expired cookie back:\r\nnewCookie := &amp;http.Cookie{\r\n\tName:     &quot;session&quot;,\r\n\tValue:    cookie.Value,\r\n\tMaxAge:   -1,\r\n\tSecure:   r.TLS != nil,\r\n\tHttpOnly: true,\r\n\tSameSite: http.SameSiteStrictMode,\r\n\tPath:     &quot;/&quot;,\r\n}\r\nhttp.SetCookie(w, newCookie)\r\n```\r\n\r\nFrom Go&#39;s source code for type `Cookie`:\r\n\r\n```lang-go\r\n// MaxAge=0 means no &#39;Max-Age&#39; attribute specified.\r\n// MaxAge&lt;0 means delete cookie now, equivalently &#39;Max-Age: 0&#39;\r\n```\r\n\r\n\r\n  [1]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie","title":"How do I delete a HttpOnly Cookie on the client?","body":"<p>From <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie\" rel=\"nofollow noreferrer\">MDN</a>:</p>\n<blockquote>\n<p>Max-Age=&lt;number&gt;</p>\n<p>Indicates the number of seconds until the cookie expires. A zero or negative number will expire the cookie immediately. If both Expires and Max-Age are set, Max-Age has precedence.</p>\n</blockquote>\n<p>Make sure that other attributes (i.e. <code>Path</code>) are set correctly: if the client's cookie is set with <code>Path=/</code>, the server should set that same value before sending the cookie. Same goes for the other attributes.</p>\n<p>This is how I have done it, in Go:</p>\n<pre class=\"lang-go prettyprint-override\"><code>// Taken from the handler that logs users in:\nsession_id := generateRandomString()\ncookie := &amp;http.Cookie{\n    Name:     &quot;session&quot;,\n    Value:    session_id,\n    MaxAge:   int(time.Hour.Seconds()),\n    Secure:   r.TLS != nil, // r is the typical *http.Request\n    HttpOnly: true,\n    SameSite: http.SameSiteStrictMode,\n    Path:     &quot;/&quot;,\n}\nhttp.SetCookie(w, cookie)\n</code></pre>\n<pre class=\"lang-go prettyprint-override\"><code>// Taken from the handler that logs users out:\ncookie, err := r.Cookie(&quot;session&quot;)\nif err != nil {\n    http.Error(w, &quot;cookie not found&quot;, http.StatusUnauthorized)\n    return\n}\n// Here goes the logic to log out the user.\n// Once that is done, it is time to send an expired cookie back:\nnewCookie := &amp;http.Cookie{\n    Name:     &quot;session&quot;,\n    Value:    cookie.Value,\n    MaxAge:   -1,\n    Secure:   r.TLS != nil,\n    HttpOnly: true,\n    SameSite: http.SameSiteStrictMode,\n    Path:     &quot;/&quot;,\n}\nhttp.SetCookie(w, newCookie)\n</code></pre>\n<p>From Go's source code for type <code>Cookie</code>:</p>\n<pre class=\"lang-go prettyprint-override\"><code>// MaxAge=0 means no 'Max-Age' attribute specified.\n// MaxAge&lt;0 means delete cookie now, equivalently 'Max-Age: 0'\n</code></pre>\n"}],"owner":{"account_id":18150538,"reputation":159,"user_id":13203322,"display_name":"BaraKanske"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":2950,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1689942307,"creation_date":1604905778,"question_id":64747157,"body_markdown":"I have a website that, when a user logs in, creates an Access token which is stored in memory and a Refresh token that is stored in an HttpOnly cookie. When a user logs out I want to delete the HttpOnly cookie. however, since it&#39;s HttpOnly I am not able to do this with JavaScript, so instead my plan is to send another cookie from the server that is expired and overwrite the valid cookie. Unfortunately, for some reason, this does not work. \r\n\r\nThis is how I create the cookie in the first place:\r\n````\r\n String refreshToken = issueRefreshToken(username);\r\n long currentDate = Calendar.getInstance().getTimeInMillis();\r\n Date expDate = new Date(currentDate + 60 * 24 * 7 * ONE_MINUTE_IN_MILLIS);\r\n\r\n NewCookie newCookie = new NewCookie(&quot;RefreshCookie&quot;,\r\n                    refreshToken,\r\n                    &quot;/&quot;,\r\n                    null,\r\n                    NewCookie.DEFAULT_VERSION,\r\n                    &quot;Comment&quot;,\r\n                    60 * 60 * 24 * 7,\r\n                    expDate,\r\n                    false,\r\n                    true);\r\n\r\n            // Return the token  on the response\r\n return Response.ok(accessToken).cookie(newCookie).header(&quot;Access-Control-Allow-Credentials&quot;, true).build();\r\n\r\n````\r\nThis works as intended and creates a Refresh cookie that is valid for one week. \r\n\r\nI have another endpoint (/logout) that creates another cookie, which is suppose to overwrite the first one. \r\n\r\n`````\r\n @POST\r\n public Response logout(){\r\n        NewCookie logoutCookie = new NewCookie(\r\n                &quot;RefreshCookie&quot;,\r\n                null,\r\n                &quot;/&quot;,\r\n                null,\r\n                NewCookie.DEFAULT_VERSION,\r\n                &quot;&quot;,\r\n                0,\r\n                new Date(),\r\n                false,\r\n                true);\r\n        return Response.ok().cookie(logoutCookie).header(&quot;Access-Control-Allow-Credentials&quot;, true).build();\r\n    }\r\n`````\r\nThis cookie does not even get saved to the frontend when the first client is not set. I have tried to send it from a subpath of where the first cookie is set, with no luck. Is there something that I&#39;m missing here? Is this the wrong way to do it?","title":"How do I delete a HttpOnly Cookie on the client?","body":"<p>I have a website that, when a user logs in, creates an Access token which is stored in memory and a Refresh token that is stored in an HttpOnly cookie. When a user logs out I want to delete the HttpOnly cookie. however, since it's HttpOnly I am not able to do this with JavaScript, so instead my plan is to send another cookie from the server that is expired and overwrite the valid cookie. Unfortunately, for some reason, this does not work.</p>\n<p>This is how I create the cookie in the first place:</p>\n<pre><code> String refreshToken = issueRefreshToken(username);\n long currentDate = Calendar.getInstance().getTimeInMillis();\n Date expDate = new Date(currentDate + 60 * 24 * 7 * ONE_MINUTE_IN_MILLIS);\n\n NewCookie newCookie = new NewCookie(&quot;RefreshCookie&quot;,\n                    refreshToken,\n                    &quot;/&quot;,\n                    null,\n                    NewCookie.DEFAULT_VERSION,\n                    &quot;Comment&quot;,\n                    60 * 60 * 24 * 7,\n                    expDate,\n                    false,\n                    true);\n\n            // Return the token  on the response\n return Response.ok(accessToken).cookie(newCookie).header(&quot;Access-Control-Allow-Credentials&quot;, true).build();\n\n</code></pre>\n<p>This works as intended and creates a Refresh cookie that is valid for one week.</p>\n<p>I have another endpoint (/logout) that creates another cookie, which is suppose to overwrite the first one.</p>\n<pre><code> @POST\n public Response logout(){\n        NewCookie logoutCookie = new NewCookie(\n                &quot;RefreshCookie&quot;,\n                null,\n                &quot;/&quot;,\n                null,\n                NewCookie.DEFAULT_VERSION,\n                &quot;&quot;,\n                0,\n                new Date(),\n                false,\n                true);\n        return Response.ok().cookie(logoutCookie).header(&quot;Access-Control-Allow-Credentials&quot;, true).build();\n    }\n</code></pre>\n<p>This cookie does not even get saved to the frontend when the first client is not set. I have tried to send it from a subpath of where the first cookie is set, with no luck. Is there something that I'm missing here? Is this the wrong way to do it?</p>\n"},{"tags":["java","eclipse","qr-code","zxing"],"comments":[{"owner":{"account_id":401843,"reputation":89768,"user_id":768644,"display_name":"rzwitserloot"},"score":1,"creation_date":1689945196,"post_id":76737922,"comment_id":135288645,"body_markdown":"You did not import the right libraries. `com.google` is not from `javafx`. It&#39;s from some google library, hence why the package name includes `google`.","body":"You did not import the right libraries. <code>com.google</code> is not from <code>javafx</code>. It&#39;s from some google library, hence why the package name includes <code>google</code>."},{"owner":{"account_id":29063733,"reputation":1,"user_id":22263807,"display_name":"kfpcraft"},"score":0,"creation_date":1690034705,"post_id":76737922,"comment_id":135298188,"body_markdown":"So I cannot use the library in my JavaFX project... I&#39;m going to have to find another way to implement the QR code scanner and generator.","body":"So I cannot use the library in my JavaFX project... I&#39;m going to have to find another way to implement the QR code scanner and generator."},{"owner":{"account_id":401843,"reputation":89768,"user_id":768644,"display_name":"rzwitserloot"},"score":0,"creation_date":1690041965,"post_id":76737922,"comment_id":135299133,"body_markdown":"Of course you can. just add the dependency to the project&#39;s dependency list.","body":"Of course you can. just add the dependency to the project&#39;s dependency list."},{"owner":{"account_id":29063733,"reputation":1,"user_id":22263807,"display_name":"kfpcraft"},"score":0,"creation_date":1690616377,"post_id":76737922,"comment_id":135380918,"body_markdown":"How do I &quot;add the dependency&quot; to the project&#39;s dependency list? I am using a JavaFXML in an Eclipse IDE. I already added the Jar files to the project&#39;s Java Build Path.","body":"How do I &quot;add the dependency&quot; to the project&#39;s dependency list? I am using a JavaFXML in an Eclipse IDE. I already added the Jar files to the project&#39;s Java Build Path."},{"owner":{"account_id":401843,"reputation":89768,"user_id":768644,"display_name":"rzwitserloot"},"score":0,"creation_date":1690638985,"post_id":76737922,"comment_id":135383245,"body_markdown":"In your gradle or maven build description file. Adding the jars to the build path _will_ get rid of those errors, so double check that you really did that.","body":"In your gradle or maven build description file. Adding the jars to the build path <i>will</i> get rid of those errors, so double check that you really did that."}],"owner":{"account_id":29063733,"reputation":1,"user_id":22263807,"display_name":"kfpcraft"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":55,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1689942074,"creation_date":1689941747,"question_id":76737922,"body_markdown":"I am trying to implement a QR code generator and scanner in a desktop application written in Java from the Eclipse IDE. I am following this tutorial: [Java code to Generate QR Code and Read QR Code using Camera https://www.youtube.com/watch?v=oBibVwgi09g&amp;t=193s](https://www.youtube.com/watch?v=oBibVwgi09g&amp;t=193s)\r\n\r\nHere is my code for generating the QR code:\r\n\r\n```\r\npackage application;\r\n\r\nimport java.io.File;\r\nimport java.io.IOException;\r\nimport java.util.Map;\r\n\r\nimport com.google.zxing.BarcodeFormat;\r\nimport com.google.zxing.MultiFormatWriter;\r\nimport com.google.zxing.WriterException;\r\nimport com.google.zxing.client.j2se.MatrixToImageWriter;\r\nimport com.google.zxing.common.BitMatrix;\r\n\r\npublic class QRGenerator {\r\n    \r\n    public void generateQRcode(String data, String path, String charset, Map map, int h, int w) throws WriterException, IOException {\r\n        BitMatrix matrix = new MultiFormatWriter().encode(new String(data.getBytes(charset), charset), BarcodeFormat.QR_CODE, w, h);\r\n        MatrixToImageWriter.writeToFile(matrix, path.substring(path.lastIndexOf(&#39;.&#39;) + 1), new File(path));\r\n    } \r\n    \r\n}\r\n\r\n```\r\n\r\nI already imported the Jar Libraries into Eclipse using this other tutorial: [How to Import or Add Jar Libraries in Eclipse https://www.youtube.com/watch?v=zWTzZ4sNAFw] (https://www.youtube.com/watch?v=zWTzZ4sNAFw)\r\n\r\nThis is what my project folder looks like. The project name is Splogurt_OOP_MiniProject.\r\n[Jar files are imported into the project](https://i.stack.imgur.com/Kwho6.png)\r\n\r\nThe code should have no errors, but there are sqwiggly red lines under text like `com.google.zxing`, `com.google.zxing.client.j2se`, `com.google.zxing.common` and a few other parts of the code.\r\n\r\nThe errors say things like &quot;The package from com.google.zxing is not accessible.&quot;\r\n\r\n[Screenshot of my QR generator code.](https://i.stack.imgur.com/mYhjR.png)\r\n\r\nI already deleted and re-made my module-info.java file to try and fix this:\r\n\r\n```\r\nmodule Splogurt_OOP_MiniProject {\r\n    exports application;\r\n\r\n    requires javafx.base;\r\n    requires javafx.controls;\r\n    requires javafx.fxml;\r\n    requires javafx.graphics;\r\n    requires javase;\r\n    \r\n    opens application to javafx.graphics, javafx.fxml;\r\n    \r\n    requires Webcam;\r\n}\r\n```\r\n\r\nHow do I solve these errors?","title":"Eclipse IDE: The package com.google.zxing is not accessible, despite importing the right libraries","body":"<p>I am trying to implement a QR code generator and scanner in a desktop application written in Java from the Eclipse IDE. I am following this tutorial: <a href=\"https://www.youtube.com/watch?v=oBibVwgi09g&amp;t=193s\" rel=\"nofollow noreferrer\">Java code to Generate QR Code and Read QR Code using Camera https://www.youtube.com/watch?v=oBibVwgi09g&amp;t=193s</a></p>\n<p>Here is my code for generating the QR code:</p>\n<pre><code>package application;\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.util.Map;\n\nimport com.google.zxing.BarcodeFormat;\nimport com.google.zxing.MultiFormatWriter;\nimport com.google.zxing.WriterException;\nimport com.google.zxing.client.j2se.MatrixToImageWriter;\nimport com.google.zxing.common.BitMatrix;\n\npublic class QRGenerator {\n    \n    public void generateQRcode(String data, String path, String charset, Map map, int h, int w) throws WriterException, IOException {\n        BitMatrix matrix = new MultiFormatWriter().encode(new String(data.getBytes(charset), charset), BarcodeFormat.QR_CODE, w, h);\n        MatrixToImageWriter.writeToFile(matrix, path.substring(path.lastIndexOf('.') + 1), new File(path));\n    } \n    \n}\n\n</code></pre>\n<p>I already imported the Jar Libraries into Eclipse using this other tutorial: [How to Import or Add Jar Libraries in Eclipse https://www.youtube.com/watch?v=zWTzZ4sNAFw] (<a href=\"https://www.youtube.com/watch?v=zWTzZ4sNAFw\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=zWTzZ4sNAFw</a>)</p>\n<p>This is what my project folder looks like. The project name is Splogurt_OOP_MiniProject.\n<a href=\"https://i.stack.imgur.com/Kwho6.png\" rel=\"nofollow noreferrer\">Jar files are imported into the project</a></p>\n<p>The code should have no errors, but there are sqwiggly red lines under text like <code>com.google.zxing</code>, <code>com.google.zxing.client.j2se</code>, <code>com.google.zxing.common</code> and a few other parts of the code.</p>\n<p>The errors say things like &quot;The package from com.google.zxing is not accessible.&quot;</p>\n<p><a href=\"https://i.stack.imgur.com/mYhjR.png\" rel=\"nofollow noreferrer\">Screenshot of my QR generator code.</a></p>\n<p>I already deleted and re-made my module-info.java file to try and fix this:</p>\n<pre><code>module Splogurt_OOP_MiniProject {\n    exports application;\n\n    requires javafx.base;\n    requires javafx.controls;\n    requires javafx.fxml;\n    requires javafx.graphics;\n    requires javase;\n    \n    opens application to javafx.graphics, javafx.fxml;\n    \n    requires Webcam;\n}\n</code></pre>\n<p>How do I solve these errors?</p>\n"}],"has_more":true,"quota_max":10000,"quota_remaining":9698,"page":294,"page_size":100}
