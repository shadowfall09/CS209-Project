{"items":[{"tags":["java","spring-boot","aws-sdk","spring-cloud-aws"],"answers":[{"tags":[],"owner":{"account_id":26281505,"reputation":427,"user_id":19949926,"display_name":"rlhagerm"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1700060267,"creation_date":1700060267,"answer_id":77488776,"question_id":77474771,"body_markdown":"It looks like this is an issue that is [being tracked here][1] for the Java v2 SDK. There are also several workarounds in that thread that you may find helpful, including importing the definition from v1 or adding the class yourself.\r\n\r\n  [1]: https://github.com/aws/aws-sdk-java-v2/issues/1197","title":"SQS Listener for S3 CreateEvent in AWS Java SDK v2","body":"<p>It looks like this is an issue that is <a href=\"https://github.com/aws/aws-sdk-java-v2/issues/1197\" rel=\"nofollow noreferrer\">being tracked here</a> for the Java v2 SDK. There are also several workarounds in that thread that you may find helpful, including importing the definition from v1 or adding the class yourself.</p>\n"}],"owner":{"account_id":2115025,"reputation":384,"user_id":1879536,"display_name":"Martin Bamford"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":87,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"accepted_answer_id":77488776,"answer_count":1,"score":-1,"last_activity_date":1700060267,"creation_date":1699887136,"question_id":77474771,"body_markdown":"In our Java Spring Boot application using aws-spring-cloud v2.4.4 and AWS SDK v1 we have the following code which listens for S3 Events, checks whether the Event Name of the triggering event is &quot;ObjectCreated&quot; and if so performs an action....\r\n\r\n```\r\n@SqsListener(value = &quot;[the physical id]&quot;, deletionPolicy = SqsMessageDeletionPolicy.ON_SUCCESS)\r\n    public void handleMessage(final S3EventNotification s3EventNotification) throws IOException {\r\n        final List&lt;S3EventNotification.S3EventNotificationRecord&gt; records = \r\n           s3EventNotification.getRecords();\r\n        if (records.get(0).getEventName().startsWith(&quot;ObjectCreated&quot;))) {\r\n           [process the S3 createObject event]\r\n\r\n```\r\n\r\nGiven that the class &quot;S3EventNotification&quot; does not exist any more in AWS SDK v2, how can I rewrite the above method when migrating to v2?","title":"SQS Listener for S3 CreateEvent in AWS Java SDK v2","body":"<p>In our Java Spring Boot application using aws-spring-cloud v2.4.4 and AWS SDK v1 we have the following code which listens for S3 Events, checks whether the Event Name of the triggering event is &quot;ObjectCreated&quot; and if so performs an action....</p>\n<pre><code>@SqsListener(value = &quot;[the physical id]&quot;, deletionPolicy = SqsMessageDeletionPolicy.ON_SUCCESS)\n    public void handleMessage(final S3EventNotification s3EventNotification) throws IOException {\n        final List&lt;S3EventNotification.S3EventNotificationRecord&gt; records = \n           s3EventNotification.getRecords();\n        if (records.get(0).getEventName().startsWith(&quot;ObjectCreated&quot;))) {\n           [process the S3 createObject event]\n\n</code></pre>\n<p>Given that the class &quot;S3EventNotification&quot; does not exist any more in AWS SDK v2, how can I rewrite the above method when migrating to v2?</p>\n"},{"tags":["java","javafx"],"comments":[{"owner":{"account_id":1180113,"reputation":152335,"user_id":1155209,"display_name":"jewelsea"},"score":3,"creation_date":1700046855,"post_id":77487115,"comment_id":136606045,"body_markdown":"You can&#39;t customize the title bar of a decorated window using the standard JavaFX API.","body":"You can&#39;t customize the title bar of a decorated window using the standard JavaFX API."},{"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"score":1,"creation_date":1700071439,"post_id":77487115,"comment_id":136610833,"body_markdown":"If you&#39;re willing to put in the work and try to access native code, then it may be possible to do this via JNI or JNA (or maybe even the currently-incubating _Foreign Function and Memory API_). [This Q&amp;A](https://stackoverflow.com/questions/75533171/how-does-javafx-integrate-the-title-bar-and-menu-bar) seems to show at least the beginnings of customizing the title bar on Windows.","body":"If you&#39;re willing to put in the work and try to access native code, then it may be possible to do this via JNI or JNA (or maybe even the currently-incubating <i>Foreign Function and Memory API</i>). <a href=\"https://stackoverflow.com/questions/75533171/how-does-javafx-integrate-the-title-bar-and-menu-bar\">This Q&amp;A</a> seems to show at least the beginnings of customizing the title bar on Windows."},{"owner":{"account_id":1180113,"reputation":152335,"user_id":1155209,"display_name":"jewelsea"},"score":0,"creation_date":1700105399,"post_id":77487115,"comment_id":136614823,"body_markdown":"You could create *another* undecorated stage and, listening to the stage x and y and width properties, set the x and y of the undecorated stage (making the undecorated stage non-modal and owned by the main stage).  It might work (I didn&#39;t try), it is a hacky solution and won&#39;t work quite right if the OS defaulted decorated layout isn&#39;t exactly as you expected to be (that layout will change depending on the OS version or Linux window manager theme used).","body":"You could create <i>another</i> undecorated stage and, listening to the stage x and y and width properties, set the x and y of the undecorated stage (making the undecorated stage non-modal and owned by the main stage).  It might work (I didn&#39;t try), it is a hacky solution and won&#39;t work quite right if the OS defaulted decorated layout isn&#39;t exactly as you expected to be (that layout will change depending on the OS version or Linux window manager theme used)."},{"owner":{"account_id":1180113,"reputation":152335,"user_id":1155209,"display_name":"jewelsea"},"score":0,"creation_date":1700105509,"post_id":77487115,"comment_id":136614831,"body_markdown":"My suggestion is to abandon your idea to put a help icon in the title bar.  Instead, put the help icon in the main window (look at your StackOverflow window and see where the help question mark is located on the top right - something like that).","body":"My suggestion is to abandon your idea to put a help icon in the title bar.  Instead, put the help icon in the main window (look at your StackOverflow window and see where the help question mark is located on the top right - something like that)."},{"owner":{"account_id":26746945,"reputation":91,"user_id":21110009,"display_name":"Алексей Жуков"},"score":1,"creation_date":1700112885,"post_id":77487115,"comment_id":136615358,"body_markdown":"Thanks a lot. It is a pity that there are no standard tools","body":"Thanks a lot. It is a pity that there are no standard tools"}],"answers":[{"comments":[{"owner":{"account_id":2053598,"reputation":41316,"user_id":1831987,"display_name":"VGR"},"score":3,"creation_date":1700058662,"post_id":77487647,"comment_id":136608267,"body_markdown":"Of course, it’s a little harder than that.  (I assume you meant BorderPane, not BorderLayout, by the way.)  Simulating a menu bar requires adding the application icon, title (using the platform’s title bar font), and minimize/maximize/close buttons (ideally using the platform’s own icons).  And changing appearance based on whether the window is focused.  And supporting window dragging, title bar double-clicking, and simulating the system’s context menu for window title bars.  All doable, but not a trivial effort.","body":"Of course, it’s a little harder than that.  (I assume you meant BorderPane, not BorderLayout, by the way.)  Simulating a menu bar requires adding the application icon, title (using the platform’s title bar font), and minimize/maximize/close buttons (ideally using the platform’s own icons).  And changing appearance based on whether the window is focused.  And supporting window dragging, title bar double-clicking, and simulating the system’s context menu for window title bars.  All doable, but not a trivial effort."},{"owner":{"account_id":21741636,"reputation":1162,"user_id":16048914,"display_name":"David Weber"},"score":1,"creation_date":1700060318,"post_id":77487647,"comment_id":136608648,"body_markdown":"Thank you because Layout!=Pane! Yes, you are right. Everything must be created by hand. Close, maximize, minimize is not hard, but dragging will require some effort.","body":"Thank you because Layout!=Pane! Yes, you are right. Everything must be created by hand. Close, maximize, minimize is not hard, but dragging will require some effort."},{"owner":{"account_id":81822,"reputation":204250,"user_id":230513,"accept_rate":100,"display_name":"trashgod"},"score":2,"creation_date":1700075031,"post_id":77487647,"comment_id":136611389,"body_markdown":"See also [_JavaFX entirely customized windows?_](https://stackoverflow.com/q/12874664/230513)","body":"See also <a href=\"https://stackoverflow.com/q/12874664/230513\"><i>JavaFX entirely customized windows?</i></a>"}],"tags":[],"owner":{"account_id":21741636,"reputation":1162,"user_id":16048914,"display_name":"David Weber"},"comment_count":3,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1700060219,"creation_date":1700050726,"answer_id":77487647,"question_id":77487115,"body_markdown":"**Preface:** \r\n\r\nYou can&#39;t modify the title bar of Stages in JavaFX.\r\n\r\n**Workaround solution:**\r\n\r\nBuild your own title bar, add it to top of your Scene, and remove the original title bar.\r\n\r\n1. Use `BorderPane` as root node of your `Scene`.\r\n2. Create your title bar in the &quot;top&quot; Part of the `BorderPane`.\r\n3. Remove the original `Stage` title bar with `stage.initStyle(StageStyle.UNDECORATED);`.","title":"JavaFX add button (icon HELP) to the title Stage","body":"<p><strong>Preface:</strong></p>\n<p>You can't modify the title bar of Stages in JavaFX.</p>\n<p><strong>Workaround solution:</strong></p>\n<p>Build your own title bar, add it to top of your Scene, and remove the original title bar.</p>\n<ol>\n<li>Use <code>BorderPane</code> as root node of your <code>Scene</code>.</li>\n<li>Create your title bar in the &quot;top&quot; Part of the <code>BorderPane</code>.</li>\n<li>Remove the original <code>Stage</code> title bar with <code>stage.initStyle(StageStyle.UNDECORATED);</code>.</li>\n</ol>\n"}],"owner":{"account_id":26746945,"reputation":91,"user_id":21110009,"display_name":"Алексей Жуков"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":56,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"accepted_answer_id":77487647,"answer_count":1,"score":1,"last_activity_date":1700060219,"creation_date":1700045551,"question_id":77487115,"body_markdown":"Tell me please, how add button HELP to the title Stage with JavaFX.\r\nI&#39;m use Linux.\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/5d0L4.png","title":"JavaFX add button (icon HELP) to the title Stage","body":"<p>Tell me please, how add button HELP to the title Stage with JavaFX.\nI'm use Linux.</p>\n<p><a href=\"https://i.stack.imgur.com/5d0L4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5d0L4.png\" alt=\"enter image description here\" /></a></p>\n"},{"tags":["java","non-nullable","jsr305"],"comments":[{"owner":{"account_id":58050,"reputation":7570,"user_id":173852,"display_name":"mernst"},"score":1,"creation_date":1700154338,"post_id":77488761,"comment_id":136622584,"body_markdown":"Is the use of Sonar essential?  There are other tools like the [Checker Framework](https://checkerframework.org/) that guarantees no null pointer exceptions and [NullAway](https://github.com/uber/NullAway) that prevents most null pointer exceptions.","body":"Is the use of Sonar essential?  There are other tools like the <a href=\"https://checkerframework.org/\" rel=\"nofollow noreferrer\">Checker Framework</a> that guarantees no null pointer exceptions and <a href=\"https://github.com/uber/NullAway\" rel=\"nofollow noreferrer\">NullAway</a> that prevents most null pointer exceptions."},{"owner":{"account_id":968335,"reputation":1099,"user_id":991368,"accept_rate":75,"display_name":"cp5"},"score":0,"creation_date":1700435604,"post_id":77488761,"comment_id":136650918,"body_markdown":"@mernst thanks will check it out. Unfortunately I have to use Sonar as it is part of the enterprise standards.","body":"@mernst thanks will check it out. Unfortunately I have to use Sonar as it is part of the enterprise standards."}],"owner":{"account_id":968335,"reputation":1099,"user_id":991368,"accept_rate":75,"display_name":"cp5"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":22,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700060122,"creation_date":1700060122,"question_id":77488761,"body_markdown":"I would like to check for possible null parameters, variables and return objects in Sonar. The Sonar we use do not support the jakarta annotations but it does support JSR305 javax annotations.\r\n\r\nI could add `@Nonnull` annotations everywhere but that seems like a lot of boiler plate coding. \r\n\r\nI could create a `package-info.java` file:\r\n\r\n    @ParametersAreNonnullByDefault\r\n    package my.base.package;\r\n    \r\n    import javax.annotation.ParametersAreNonnullByDefault;\r\n\r\nAnd then only do explicit `@Nullable` where it is required. \r\n\r\nBut the `package-info` does not work for subpackages.\r\n\r\nI come accross another [stackoverlow][1] article from 7 years ago where a gradle script is used to duplicate the `package-info.java` files in every single directory that contains a java file.\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/40084203/intellij-idea-parametersarenonnullbydefault-for-all-subpackages \r\n\r\nThis seems so much boiler plate again with files that I do not really want to see.\r\n\r\nIs there no better way to do this?","title":"Check overall for Nonnull in Sonar using JSR305?","body":"<p>I would like to check for possible null parameters, variables and return objects in Sonar. The Sonar we use do not support the jakarta annotations but it does support JSR305 javax annotations.</p>\n<p>I could add <code>@Nonnull</code> annotations everywhere but that seems like a lot of boiler plate coding.</p>\n<p>I could create a <code>package-info.java</code> file:</p>\n<pre><code>@ParametersAreNonnullByDefault\npackage my.base.package;\n\nimport javax.annotation.ParametersAreNonnullByDefault;\n</code></pre>\n<p>And then only do explicit <code>@Nullable</code> where it is required.</p>\n<p>But the <code>package-info</code> does not work for subpackages.</p>\n<p>I come accross another <a href=\"https://stackoverflow.com/questions/40084203/intellij-idea-parametersarenonnullbydefault-for-all-subpackages\">stackoverlow</a> article from 7 years ago where a gradle script is used to duplicate the <code>package-info.java</code> files in every single directory that contains a java file.</p>\n<p>This seems so much boiler plate again with files that I do not really want to see.</p>\n<p>Is there no better way to do this?</p>\n"},{"tags":["java","android","flutter","dart","gradle"],"comments":[{"owner":{"account_id":17616291,"reputation":123,"user_id":12783266,"display_name":"Shahed Emon"},"score":0,"creation_date":1700060389,"post_id":77488735,"comment_id":136608657,"body_markdown":"Can you provide the code inside `android -&gt; app -&gt;  src -&gt; main -&gt; res -&gt; values -&gt; values.xml` ?","body":"Can you provide the code inside <code>android -&gt; app -&gt;  src -&gt; main -&gt; res -&gt; values -&gt; values.xml</code> ?"},{"owner":{"account_id":20430298,"reputation":251,"user_id":14989303,"display_name":"lewiseman"},"score":0,"creation_date":1700060642,"post_id":77488735,"comment_id":136608700,"body_markdown":"have you tried running `flutter clean` then `flutter pub get` at the root folder of your project ?","body":"have you tried running <code>flutter clean</code> then <code>flutter pub get</code> at the root folder of your project ?"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1700161378,"post_id":77488735,"comment_id":136623808,"body_markdown":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.","body":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking."}],"owner":{"account_id":29909895,"reputation":1,"user_id":22921590,"display_name":"pavel boss"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":36,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700059931,"creation_date":1700059931,"question_id":77488735,"body_markdown":"I have been looking for a long time to find out how to solve this problem from my Android project, in fact I have a problem like ...., I have looked at all the possible tutorials and articles but nothing helps, I wonder if you can help me thank you\r\n\r\n* What went wrong:\r\nExecution failed for task &#39;:app:mergeReleaseResources&#39;.\r\n&gt; A failure occurred while executing com.android.build.gradle.internal.res.ResourceCompilerRunnable\r\n   &gt; Resource compilation failed (Failed to compile values resource file C:\\Driverapp\\build\\app\\intermediates\\incremental\\release\\mergeReleaseResources\\merged.dir\\values\\values.xml. Cause: java.nio.file.InvalidPathException: Illegal char &lt;:&gt; at index 49: com.mighty.taxidriver.app-mergeReleaseResources-5:/values/values.xml). Check logs for more details.\r\n     ","title":"Execution failed for task &#39;:app:mergeReleaseResources&#39;. , Cause: java.nio.file.InvalidPathException: Illegal char &lt;:&gt; at index 49:","body":"<p>I have been looking for a long time to find out how to solve this problem from my Android project, in fact I have a problem like ...., I have looked at all the possible tutorials and articles but nothing helps, I wonder if you can help me thank you</p>\n<ul>\n<li>What went wrong:\nExecution failed for task ':app:mergeReleaseResources'.</li>\n</ul>\n<blockquote>\n<p>A failure occurred while executing com.android.build.gradle.internal.res.ResourceCompilerRunnable\nResource compilation failed (Failed to compile values resource file C:\\Driverapp\\build\\app\\intermediates\\incremental\\release\\mergeReleaseResources\\merged.dir\\values\\values.xml. Cause: java.nio.file.InvalidPathException: Illegal char &lt;:&gt; at index 49: com.mighty.taxidriver.app-mergeReleaseResources-5:/values/values.xml). Check logs for more details.</p>\n</blockquote>\n"},{"tags":["java","centos","wildfly","war","jaas"],"owner":{"account_id":29805188,"reputation":11,"user_id":22841995,"display_name":"Alex Gonzaga"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":8,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700059566,"creation_date":1700059566,"question_id":77488689,"body_markdown":"\r\nI have a wildfly 29 built in my local environment, with Windows 11 in which I deploy an application that logs in through JAAS and if the login is successful it redirects me to the application, everything works OK at this environment.\r\n\r\nI have the same wildly 29 with exactly the same configuration in a virtual machine with Centos, I deploy exactly the same artifact but on this server when I try to log in, although it recognizes the users (since if it is wrong I get the message of incorrect credentials) it does not redirects me to the application, it redirects me to the same login page, I don&#39;t get any errors in the browser console or in the wildfly log, what could it be? Thank you so much.","title":"Wildfly 29 - War artifact doesn&#39;t work in a Remote Virtual Machine but it does in a local environment","body":"<p>I have a wildfly 29 built in my local environment, with Windows 11 in which I deploy an application that logs in through JAAS and if the login is successful it redirects me to the application, everything works OK at this environment.</p>\n<p>I have the same wildly 29 with exactly the same configuration in a virtual machine with Centos, I deploy exactly the same artifact but on this server when I try to log in, although it recognizes the users (since if it is wrong I get the message of incorrect credentials) it does not redirects me to the application, it redirects me to the same login page, I don't get any errors in the browser console or in the wildfly log, what could it be? Thank you so much.</p>\n"},{"tags":["java","javafx"],"comments":[{"owner":{"account_id":1180113,"reputation":152335,"user_id":1155209,"display_name":"jewelsea"},"score":3,"creation_date":1700062715,"post_id":77488664,"comment_id":136609116,"body_markdown":"This path is wrong -&gt; `&quot;Obrazky//default.png&quot;` -&gt; it has two slashes.  Here is a space cat image [https://hd.wallpaperswide.com/thumbs/lovely_space_kitten-t2.jpg](https://hd.wallpaperswide.com/thumbs/lovely_space_kitten-t2.jpg).  Try setting the image to that exact URL.  If it works, the problem is with where you are placing your local image, or with the path you are using to find it; in which case, see [how to find resources for Java](https://stackoverflow.com/questions/61531317/how-do-i-determine-the-correct-path-for-fxml-files-css-files-images-and-other).","body":"This path is wrong -&gt; <code>&quot;Obrazky&#47;&#47;default.png&quot;</code> -&gt; it has two slashes.  Here is a space cat image <a href=\"https://hd.wallpaperswide.com/thumbs/lovely_space_kitten-t2.jpg\" rel=\"nofollow noreferrer\">https://hd.wallpaperswide.com/thumbs/lovely_space_kitten-t2.&zwnj;&#8203;jpg</a>.  Try setting the image to that exact URL.  If it works, the problem is with where you are placing your local image, or with the path you are using to find it; in which case, see <a href=\"https://stackoverflow.com/questions/61531317/how-do-i-determine-the-correct-path-for-fxml-files-css-files-images-and-other\">how to find resources for Java</a>."},{"owner":{"account_id":28250019,"reputation":11,"user_id":21596415,"display_name":"Marek Dvorsk&#253;"},"score":0,"creation_date":1700064500,"post_id":77488664,"comment_id":136609482,"body_markdown":"I tried but the issue has to do something that I am creating new instance of the BorderPane so instead I am changing imageview of the &quot;other&quot; BorderPane which is not shown.","body":"I tried but the issue has to do something that I am creating new instance of the BorderPane so instead I am changing imageview of the &quot;other&quot; BorderPane which is not shown."},{"owner":{"account_id":2518243,"reputation":203472,"user_id":2189127,"display_name":"James_D"},"score":0,"creation_date":1700065082,"post_id":77488664,"comment_id":136609584,"body_markdown":"Create and post a [mre].","body":"Create and post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."},{"owner":{"account_id":2518243,"reputation":203472,"user_id":2189127,"display_name":"James_D"},"score":1,"creation_date":1700065165,"post_id":77488664,"comment_id":136609595,"body_markdown":"If your `insertImagePath()` method is complete, then of course nothing will happen: you are loading the FXML but not displaying its content anywhere, so you will not see the image.","body":"If your <code>insertImagePath()</code> method is complete, then of course nothing will happen: you are loading the FXML but not displaying its content anywhere, so you will not see the image."},{"owner":{"account_id":2518243,"reputation":203472,"user_id":2189127,"display_name":"James_D"},"score":0,"creation_date":1700065239,"post_id":77488664,"comment_id":136609612,"body_markdown":"Probably the best approach to this is to use a [MVC approach](https://stackoverflow.com/questions/32342864/applying-mvc-with-javafx)  where your model class has an observable `Property&lt;Image&gt;` which is observed by one controller and modified by the other.","body":"Probably the best approach to this is to use a <a href=\"https://stackoverflow.com/questions/32342864/applying-mvc-with-javafx\">MVC approach</a>  where your model class has an observable <code>Property&lt;Image&gt;</code> which is observed by one controller and modified by the other."}],"owner":{"account_id":28250019,"reputation":11,"user_id":21596415,"display_name":"Marek Dvorsk&#253;"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":57,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1700059372,"creation_date":1700059372,"question_id":77488664,"body_markdown":"What I have:\r\n\r\nI have a BorderPane, my BorderPane consists of 2 parts, top and center. Inside top part I have ImageView which i want to set and inside center part I have a pane in which I have a button and this button should change the image inside ImageView. The BorderPane as a whole is one FXML file controlled with BorderPaneController but the center part (pane) is another FXML file controlled wtih CenterPaneController.\r\n\r\nWhat I want to do:\r\nThe imageview show my new image after i click the button\r\n\r\nWhat is my problem:\r\n\r\nWhen I click the button the image path is successfuly transfered from CenterPaneController to BorderPaneController and also the ImageView is successfuly set, because it contains the image path but the Image View is still empty\r\n\r\n\r\n\r\n\r\n\r\nthis is the FXML file of the center part (pane) of the BorderPane where I have the button:\r\n\r\n\r\n```\r\n&lt;Pane maxHeight=&quot;-Infinity&quot; maxWidth=&quot;-Infinity&quot; minHeight=&quot;-Infinity&quot; minWidth=&quot;-Infinity&quot; prefHeight=&quot;400.0&quot; prefWidth=&quot;600.0&quot; xmlns=&quot;http://javafx.com/javafx/8&quot; xmlns:fx=&quot;http://javafx.com/fxml/1&quot; fx:controller=&quot;ProfilPouzivatelaController&quot;&gt;\r\n   &lt;children&gt;\r\n      &lt;Button layoutX=&quot;434.0&quot; layoutY=&quot;227.0&quot; mnemonicParsing=&quot;false&quot; onAction=&quot;#insertImagePath&quot; onMouseClicked=&quot;#vlozFotku&quot; text=&quot;Zmeniť profilov&#250; fotku&quot; /&gt;\r\n   &lt;/children&gt;\r\n&lt;/Pane&gt;\r\n```\r\nthis is the FXML file of the BorderPane where I have my ImageView in the top part:\r\n\r\n\r\n```\r\n&lt;BorderPane fx:id=&quot;borderPane&quot; maxHeight=&quot;-Infinity&quot; maxWidth=&quot;-Infinity&quot; minHeight=&quot;-Infinity&quot; minWidth=&quot;-Infinity&quot; prefHeight=&quot;700.0&quot; prefWidth=&quot;1400.0&quot; stylesheets=&quot;hlavnePouzivatelskeRozhranie.css&quot; xmlns=&quot;http://javafx.com/javafx/8&quot; xmlns:fx=&quot;http://javafx.com/fxml/1&quot; fx:controller=&quot;PouzivatelskeRozhranieController&quot;&gt;\r\n   &lt;top&gt;\r\n      &lt;HBox fx:id=&quot;topHBox&quot; prefHeight=&quot;57.0&quot; prefWidth=&quot;800.0&quot; BorderPane.alignment=&quot;CENTER&quot;&gt;\r\n         &lt;children&gt;            \r\n            &lt;HBox fx:id=&quot;innerHbox&quot; alignment=&quot;CENTER_LEFT&quot; nodeOrientation=&quot;RIGHT_TO_LEFT&quot; prefHeight=&quot;54.0&quot; prefWidth=&quot;148.0&quot;&gt;\r\n               &lt;children&gt;\r\n                  &lt;ImageView fx:id=&quot;image&quot; fitHeight=&quot;50.0&quot; fitWidth=&quot;60.0&quot; pickOnBounds=&quot;true&quot; preserveRatio=&quot;true&quot; /&gt;                                       \r\n               &lt;/children&gt;\r\n         &lt;/children&gt;\r\n      &lt;/HBox&gt;\r\n   &lt;/top&gt;\r\n```\r\ncode of my BorderPaneController:\r\n\r\n```\r\npublic class BorderPaneController  {\r\n    @FXML\r\n    private ImageView image;\r\n\r\n    public void setImage(String imagePath) {\r\n        this.image.setImage(new Image(imagePath));\r\n     \r\n    }    \r\n\r\n}\r\n```\r\nThis is the code of my CenterPaneController:\r\n\r\n\r\n```\r\npublic class CenterPaneController {\r\n    private BorderPaneController borderPane; \r\n    \r\n    @FXML\r\n    public void insertImagePath(ActionEvent e) throws IOException {\r\n\r\n        FXMLLoader loader = new   FXMLLoader(getClass().getResource(&quot;borderPane.fxml&quot;));\r\n        Parent root = loader.load();\r\n        borderPane = loader.getController();\r\n        borderPane.setImage(&quot;Obrazky//default.png&quot;);\r\n}\r\n```  \r\n\r\n\r\n\r\n","title":"Javafx problem setting ImageView inside my BorderPane","body":"<p>What I have:</p>\n<p>I have a BorderPane, my BorderPane consists of 2 parts, top and center. Inside top part I have ImageView which i want to set and inside center part I have a pane in which I have a button and this button should change the image inside ImageView. The BorderPane as a whole is one FXML file controlled with BorderPaneController but the center part (pane) is another FXML file controlled wtih CenterPaneController.</p>\n<p>What I want to do:\nThe imageview show my new image after i click the button</p>\n<p>What is my problem:</p>\n<p>When I click the button the image path is successfuly transfered from CenterPaneController to BorderPaneController and also the ImageView is successfuly set, because it contains the image path but the Image View is still empty</p>\n<p>this is the FXML file of the center part (pane) of the BorderPane where I have the button:</p>\n<pre><code>&lt;Pane maxHeight=&quot;-Infinity&quot; maxWidth=&quot;-Infinity&quot; minHeight=&quot;-Infinity&quot; minWidth=&quot;-Infinity&quot; prefHeight=&quot;400.0&quot; prefWidth=&quot;600.0&quot; xmlns=&quot;http://javafx.com/javafx/8&quot; xmlns:fx=&quot;http://javafx.com/fxml/1&quot; fx:controller=&quot;ProfilPouzivatelaController&quot;&gt;\n   &lt;children&gt;\n      &lt;Button layoutX=&quot;434.0&quot; layoutY=&quot;227.0&quot; mnemonicParsing=&quot;false&quot; onAction=&quot;#insertImagePath&quot; onMouseClicked=&quot;#vlozFotku&quot; text=&quot;Zmeniť profilovú fotku&quot; /&gt;\n   &lt;/children&gt;\n&lt;/Pane&gt;\n</code></pre>\n<p>this is the FXML file of the BorderPane where I have my ImageView in the top part:</p>\n<pre><code>&lt;BorderPane fx:id=&quot;borderPane&quot; maxHeight=&quot;-Infinity&quot; maxWidth=&quot;-Infinity&quot; minHeight=&quot;-Infinity&quot; minWidth=&quot;-Infinity&quot; prefHeight=&quot;700.0&quot; prefWidth=&quot;1400.0&quot; stylesheets=&quot;hlavnePouzivatelskeRozhranie.css&quot; xmlns=&quot;http://javafx.com/javafx/8&quot; xmlns:fx=&quot;http://javafx.com/fxml/1&quot; fx:controller=&quot;PouzivatelskeRozhranieController&quot;&gt;\n   &lt;top&gt;\n      &lt;HBox fx:id=&quot;topHBox&quot; prefHeight=&quot;57.0&quot; prefWidth=&quot;800.0&quot; BorderPane.alignment=&quot;CENTER&quot;&gt;\n         &lt;children&gt;            \n            &lt;HBox fx:id=&quot;innerHbox&quot; alignment=&quot;CENTER_LEFT&quot; nodeOrientation=&quot;RIGHT_TO_LEFT&quot; prefHeight=&quot;54.0&quot; prefWidth=&quot;148.0&quot;&gt;\n               &lt;children&gt;\n                  &lt;ImageView fx:id=&quot;image&quot; fitHeight=&quot;50.0&quot; fitWidth=&quot;60.0&quot; pickOnBounds=&quot;true&quot; preserveRatio=&quot;true&quot; /&gt;                                       \n               &lt;/children&gt;\n         &lt;/children&gt;\n      &lt;/HBox&gt;\n   &lt;/top&gt;\n</code></pre>\n<p>code of my BorderPaneController:</p>\n<pre><code>public class BorderPaneController  {\n    @FXML\n    private ImageView image;\n\n    public void setImage(String imagePath) {\n        this.image.setImage(new Image(imagePath));\n     \n    }    \n\n}\n</code></pre>\n<p>This is the code of my CenterPaneController:</p>\n<pre><code>public class CenterPaneController {\n    private BorderPaneController borderPane; \n    \n    @FXML\n    public void insertImagePath(ActionEvent e) throws IOException {\n\n        FXMLLoader loader = new   FXMLLoader(getClass().getResource(&quot;borderPane.fxml&quot;));\n        Parent root = loader.load();\n        borderPane = loader.getController();\n        borderPane.setImage(&quot;Obrazky//default.png&quot;);\n}\n</code></pre>\n"},{"tags":["java","junit"],"comments":[{"owner":{"account_id":3430916,"reputation":3799,"user_id":3059385,"accept_rate":40,"display_name":"Christopher Schneider"},"score":0,"creation_date":1657553868,"post_id":72941084,"comment_id":128832447,"body_markdown":"What field is null? That&#39;s where your problem is. I&#39;m guessing `key` since you don&#39;t initialize it and have commented out `@Mock`","body":"What field is null? That&#39;s where your problem is. I&#39;m guessing <code>key</code> since you don&#39;t initialize it and have commented out <code>@Mock</code>"},{"owner":{"account_id":24845980,"reputation":1,"user_id":18723513,"display_name":"Satish Prasad"},"score":0,"creation_date":1657597621,"post_id":72941084,"comment_id":128842488,"body_markdown":"Key and IdpsClient both are interfaces, also tried with @Mock or without Mock both cases its making null on this &quot;idpsClient.newKeyHandleLatest(idpsKey))&quot;\n\nMockito.when(idpsClient.newKeyHandleLatest(idpsKey)).thenReturn(key);\n\nMockito.when(idpsClient.newKeyHandleLatest(Mockito.any())).thenReturn(key);","body":"Key and IdpsClient both are interfaces, also tried with @Mock or without Mock both cases its making null on this &quot;idpsClient.newKeyHandleLatest(idpsKey))&quot;  Mockito.when(idpsClient.newKeyHandleLatest(idpsKey)).thenRet&zwnj;&#8203;urn(key);  Mockito.when(idpsClient.newKeyHandleLatest(Mockito.any())).t&zwnj;&#8203;henReturn(key);"}],"answers":[{"tags":[],"owner":{"account_id":29909837,"reputation":1,"user_id":22921547,"display_name":"user22921547"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700059020,"creation_date":1700059020,"answer_id":77488618,"question_id":72941084,"body_markdown":"Your @Test should be from org.junit.jupiter.api.Test package not org.junit.Test\r\nPlease check\r\n","title":"@RunWith test cases was working fine, once i change with @ExtendWith, it start giving null pointer","body":"<p>Your @Test should be from org.junit.jupiter.api.Test package not org.junit.Test\nPlease check</p>\n"}],"owner":{"account_id":24845980,"reputation":1,"user_id":18723513,"display_name":"Satish Prasad"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":59,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1700059020,"creation_date":1657553675,"question_id":72941084,"body_markdown":"I am writing JUnit test cases, In starting only I have written with @RunWith(MockitoJUnitRunner.class), and it was working fine. \r\n\r\nAnd later I changed with @ExtendWith(MockitoExtension.class), and it started giving the null pointer, I don&#39;t understand why it&#39;s happening. whats wrong with here.\r\n\r\n\r\n Base code:\r\n    ----------------\r\n    \r\n    \r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    import org.springframework.beans.factory.annotation.Value;\r\n    import org.springframework.stereotype.Component;\r\n    \r\n    import java.nio.charset.StandardCharsets;\r\n    \r\n    @Component\r\n    public class IdpsDecryptorImpl implements IdpsDecryptor {\r\n    \r\n        @Value(&quot;${idps.key}&quot;)\r\n        private String idpsKey;\r\n    \r\n        @Autowired\r\n        private IdpsClient idpsClient;\r\n    \r\n        private Key retrieveKey() {\r\n            return idpsClient.newKeyHandleLatest(idpsKey);\r\n        }\r\n    \r\n        public String decrypt(byte[] encryptedBytes) {\r\n            byte[] decryptedBytes;\r\n            Key keyHandle = retrieveKey();\r\n            try {\r\n                decryptedBytes = keyHandle.deriveTwiceAndDecryptLocal(encryptedBytes);\r\n            } catch (IdpsException | IdpsCommunicationException ex) {\r\n                throw new StorageException(ErrorCode.IDPS_DECRYPT_ERROR, ex.getMessage());\r\n            }\r\n            return new String(decryptedBytes, StandardCharsets.UTF_8);\r\n        }\r\n    }\r\n    \r\n       \r\n    ------------------\r\n    Test case:\r\n    \r\n    \r\n    import junit.framework.TestCase;\r\n    import org.junit.Assert;\r\n    import org.junit.Test;\r\n    import org.junit.jupiter.api.extension.ExtendWith;\r\n    import org.junit.runner.RunWith;\r\n    import org.mockito.InjectMocks;\r\n    import org.mockito.Mock;\r\n    import org.mockito.Mockito;\r\n    import org.mockito.junit.MockitoJUnitRunner;\r\n    import org.mockito.junit.jupiter.MockitoExtension;\r\n    import org.springframework.test.util.ReflectionTestUtils;\r\n    \r\n    \r\n    /**\r\n     * @author : sprasad13\r\n     * @created : 11/07/22, Monday\r\n     **/\r\n    \r\n    @ExtendWith(MockitoExtension.class)\r\n    //@RunWith(MockitoJUnitRunner.class)\r\n    public class IdpsDecryptorImplTest extends TestCase {\r\n    \r\n        @InjectMocks\r\n        private IdpsDecryptorImpl idpsDecryptorimpl;\r\n        //@Mock\r\n        Key key;\r\n    \r\n        @Mock\r\n        IdpsClient idpsClient;\r\n    \r\n        private String idpsKey = &quot;testKey&quot;;\r\n    \r\n        @Test\r\n        public void testDecrypt() throws IdpsCommunicationException, IdpsException {\r\n            ReflectionTestUtils.setField(idpsDecryptorimpl,&quot;key&quot;,key);\r\n            byte[] encryptedBytes = new byte[2];\r\n            encryptedBytes[0] = 20;\r\n            encryptedBytes[1] = 30;\r\n    \r\n            byte[] decryptedBytes = new byte[2];\r\n            decryptedBytes[0] = 97;\r\n            decryptedBytes[1] = 98;\r\n    \r\n            Mockito.when(idpsClient.newKeyHandleLatest(idpsKey)).thenReturn(key);\r\n            Mockito.when(key.deriveTwiceAndDecryptLocal(encryptedBytes)).thenReturn(decryptedBytes);\r\n    \r\n            Assert.assertNotNull(idpsDecryptorimpl.decrypt(encryptedBytes));\r\n    \r\n        }\r\n    \r\n        @Test(expected = StorageException.class)\r\n        public void testDecryptException() throws IdpsCommunicationException, IdpsException {\r\n            byte[] encryptedBytes = new byte[1];\r\n            encryptedBytes[0] = 20;\r\n    \r\n            byte[] decryptedBytes = new byte[1];\r\n            decryptedBytes[0] = 97;\r\n    \r\n            Mockito.when(idpsClient.newKeyHandleLatest(idpsKey)).thenReturn(key);\r\n            Mockito.when(key.deriveTwiceAndDecryptLocal(encryptedBytes)).thenThrow(new IdpsException());\r\n            String result = idpsDecryptorimpl.decrypt(encryptedBytes);\r\n            Assert.assertNull(result);\r\n        }\r\n    }\r\n\r\n","title":"@RunWith test cases was working fine, once i change with @ExtendWith, it start giving null pointer","body":"<p>I am writing JUnit test cases, In starting only I have written with @RunWith(MockitoJUnitRunner.class), and it was working fine.</p>\n<p>And later I changed with @ExtendWith(MockitoExtension.class), and it started giving the null pointer, I don't understand why it's happening. whats wrong with here.</p>\n<p>Base code:\n----------------</p>\n<pre><code>import org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.stereotype.Component;\n\nimport java.nio.charset.StandardCharsets;\n\n@Component\npublic class IdpsDecryptorImpl implements IdpsDecryptor {\n\n    @Value(&quot;${idps.key}&quot;)\n    private String idpsKey;\n\n    @Autowired\n    private IdpsClient idpsClient;\n\n    private Key retrieveKey() {\n        return idpsClient.newKeyHandleLatest(idpsKey);\n    }\n\n    public String decrypt(byte[] encryptedBytes) {\n        byte[] decryptedBytes;\n        Key keyHandle = retrieveKey();\n        try {\n            decryptedBytes = keyHandle.deriveTwiceAndDecryptLocal(encryptedBytes);\n        } catch (IdpsException | IdpsCommunicationException ex) {\n            throw new StorageException(ErrorCode.IDPS_DECRYPT_ERROR, ex.getMessage());\n        }\n        return new String(decryptedBytes, StandardCharsets.UTF_8);\n    }\n}\n\n   \n------------------\nTest case:\n\n\nimport junit.framework.TestCase;\nimport org.junit.Assert;\nimport org.junit.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.junit.runner.RunWith;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.Mockito;\nimport org.mockito.junit.MockitoJUnitRunner;\nimport org.mockito.junit.jupiter.MockitoExtension;\nimport org.springframework.test.util.ReflectionTestUtils;\n\n\n/**\n * @author : sprasad13\n * @created : 11/07/22, Monday\n **/\n\n@ExtendWith(MockitoExtension.class)\n//@RunWith(MockitoJUnitRunner.class)\npublic class IdpsDecryptorImplTest extends TestCase {\n\n    @InjectMocks\n    private IdpsDecryptorImpl idpsDecryptorimpl;\n    //@Mock\n    Key key;\n\n    @Mock\n    IdpsClient idpsClient;\n\n    private String idpsKey = &quot;testKey&quot;;\n\n    @Test\n    public void testDecrypt() throws IdpsCommunicationException, IdpsException {\n        ReflectionTestUtils.setField(idpsDecryptorimpl,&quot;key&quot;,key);\n        byte[] encryptedBytes = new byte[2];\n        encryptedBytes[0] = 20;\n        encryptedBytes[1] = 30;\n\n        byte[] decryptedBytes = new byte[2];\n        decryptedBytes[0] = 97;\n        decryptedBytes[1] = 98;\n\n        Mockito.when(idpsClient.newKeyHandleLatest(idpsKey)).thenReturn(key);\n        Mockito.when(key.deriveTwiceAndDecryptLocal(encryptedBytes)).thenReturn(decryptedBytes);\n\n        Assert.assertNotNull(idpsDecryptorimpl.decrypt(encryptedBytes));\n\n    }\n\n    @Test(expected = StorageException.class)\n    public void testDecryptException() throws IdpsCommunicationException, IdpsException {\n        byte[] encryptedBytes = new byte[1];\n        encryptedBytes[0] = 20;\n\n        byte[] decryptedBytes = new byte[1];\n        decryptedBytes[0] = 97;\n\n        Mockito.when(idpsClient.newKeyHandleLatest(idpsKey)).thenReturn(key);\n        Mockito.when(key.deriveTwiceAndDecryptLocal(encryptedBytes)).thenThrow(new IdpsException());\n        String result = idpsDecryptorimpl.decrypt(encryptedBytes);\n        Assert.assertNull(result);\n    }\n}\n</code></pre>\n"},{"tags":["java","android","firebase","firebase-cloud-messaging"],"comments":[{"owner":{"account_id":6819231,"reputation":132861,"user_id":5246885,"accept_rate":78,"display_name":"Alex Mamo"},"score":0,"creation_date":1700038123,"post_id":77486145,"comment_id":136604561,"body_markdown":"Aside from my answer, if you understand Kotlin, I think that this [resource](https://medium.com/firebase-tips-tricks/how-to-use-firebase-cloud-messaging-on-android-d92cb4b53cfe) will help. Here is the corresponding [repo](https://github.com/alexmamo/FirebaseCloudMessaging).","body":"Aside from my answer, if you understand Kotlin, I think that this <a href=\"https://medium.com/firebase-tips-tricks/how-to-use-firebase-cloud-messaging-on-android-d92cb4b53cfe\" rel=\"nofollow noreferrer\">resource</a> will help. Here is the corresponding <a href=\"https://github.com/alexmamo/FirebaseCloudMessaging\" rel=\"nofollow noreferrer\">repo</a>."}],"answers":[{"comments":[{"owner":{"account_id":4033079,"reputation":5307,"user_id":3318489,"accept_rate":65,"display_name":"quma"},"score":0,"creation_date":1700117658,"post_id":77486273,"comment_id":136615783,"body_markdown":"I have tried to understand 1. Notification messages but I don&#39;t. Is it not possible to write Java code in my Java backend? Do I have to write code in the FCM? I would be very happy for another hint. Thanks a lot!","body":"I have tried to understand 1. Notification messages but I don&#39;t. Is it not possible to write Java code in my Java backend? Do I have to write code in the FCM? I would be very happy for another hint. Thanks a lot!"},{"owner":{"account_id":6819231,"reputation":132861,"user_id":5246885,"accept_rate":78,"display_name":"Alex Mamo"},"score":0,"creation_date":1700119660,"post_id":77486273,"comment_id":136616033,"body_markdown":"If you have a new question that derives from this one, or you tried something that doesn&#39;t work the way you expect, then please post a new question, here on StackOverflow, using its own [MCVE](https://stackoverflow.com/help/mcve), so I and other Firebase developers can help you.","body":"If you have a new question that derives from this one, or you tried something that doesn&#39;t work the way you expect, then please post a new question, here on StackOverflow, using its own <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>, so I and other Firebase developers can help you."},{"owner":{"account_id":4033079,"reputation":5307,"user_id":3318489,"accept_rate":65,"display_name":"quma"},"score":0,"creation_date":1700980989,"post_id":77486273,"comment_id":136717007,"body_markdown":"Actually I do not find a sample code for 1. Notification messages. I read a lot but this I guess all was about Data messages. Is there any example for Notification messages? Thanks!","body":"Actually I do not find a sample code for 1. Notification messages. I read a lot but this I guess all was about Data messages. Is there any example for Notification messages? Thanks!"},{"owner":{"account_id":6819231,"reputation":132861,"user_id":5246885,"accept_rate":78,"display_name":"Alex Mamo"},"score":0,"creation_date":1701001886,"post_id":77486273,"comment_id":136718625,"body_markdown":"If you understand Kotlin, try to check that repo. You&#39;ll be able to receive notifications even if the app is killed.","body":"If you understand Kotlin, try to check that repo. You&#39;ll be able to receive notifications even if the app is killed."}],"tags":[],"owner":{"account_id":6819231,"reputation":132861,"user_id":5246885,"accept_rate":78,"display_name":"Alex Mamo"},"comment_count":4,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1700038040,"creation_date":1700038040,"answer_id":77486273,"question_id":77486145,"body_markdown":"There are two types of [notification messages][1]:\r\n\r\n1. **Notification messages**, which are considered high-level messages and are handled directly by the Firebase Cloud Messaging SDK automatically. This means that if the application is in the background or killed, the notifications are going directly to the system tray notification. On the other hand, if the application is in the foreground then it will get delivered to the `onMessageReceived()` callback.\r\n\r\n2. **Data messages**, which are handled by the client application and can carry only the data payload. Besides that, the notifications are delivered to the app’s `onMessageReceived()` callback regardless of whether the app is in the foreground or in the background.\r\n\r\nSo if you need to receive messages even if the app is in the background or even killed, you have to send notification messages, and for that, I recommend you use [Cloud Functions for Firebase][2].\r\n\r\n\r\n  [1]: https://firebase.google.com/docs/cloud-messaging/android/receive\r\n  [2]: https://firebase.google.com/docs/functions","title":"firebase messages over firebase console vs. with Java Code","body":"<p>There are two types of <a href=\"https://firebase.google.com/docs/cloud-messaging/android/receive\" rel=\"nofollow noreferrer\">notification messages</a>:</p>\n<ol>\n<li><p><strong>Notification messages</strong>, which are considered high-level messages and are handled directly by the Firebase Cloud Messaging SDK automatically. This means that if the application is in the background or killed, the notifications are going directly to the system tray notification. On the other hand, if the application is in the foreground then it will get delivered to the <code>onMessageReceived()</code> callback.</p>\n</li>\n<li><p><strong>Data messages</strong>, which are handled by the client application and can carry only the data payload. Besides that, the notifications are delivered to the app’s <code>onMessageReceived()</code> callback regardless of whether the app is in the foreground or in the background.</p>\n</li>\n</ol>\n<p>So if you need to receive messages even if the app is in the background or even killed, you have to send notification messages, and for that, I recommend you use <a href=\"https://firebase.google.com/docs/functions\" rel=\"nofollow noreferrer\">Cloud Functions for Firebase</a>.</p>\n"}],"owner":{"account_id":4033079,"reputation":5307,"user_id":3318489,"accept_rate":65,"display_name":"quma"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":45,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77486273,"answer_count":1,"score":0,"last_activity_date":1700058729,"creation_date":1700036427,"question_id":77486145,"body_markdown":"1. If I send a Firebase message to my mobile over https://console.firebase.google.com/... the message appears on my mobile no matter whether the app is open on the device or not.\r\n\r\n2. If I send a Firebase message with this Java code: \r\n\r\n       public void sendFirebaseMessage() {\r\n        try {\r\n\r\n            String registrationToken = &quot;c4QGdbL_TTqZXaBC3F...&quot;;\r\n            Message message = Message.builder().putData(&quot;score&quot;, &quot;850&quot;).putData(&quot;time&quot;, &quot;11:06&quot;).setToken(registrationToken).build();\r\n\r\n            final FirebaseApp app = FirebaseApp.getInstancemy-app&quot;);\r\n            String response = FirebaseMessaging.getInstance(app).send(message);\r\n            logger.info(&quot;successfully sent firebase message with response &#39;{}&#39; in FirebaseServiceImpl#sendFirebaseMessage&quot;, response);\r\n          } catch ...\r\n         }\r\n\r\nthen the app must be open so that the message appears. \r\n\r\nMy question would be what do I have to do so that I can send Firebase messages over Java code that behave like in 1.?","title":"firebase messages over firebase console vs. with Java Code","body":"<ol>\n<li><p>If I send a Firebase message to my mobile over <a href=\"https://console.firebase.google.com/..\" rel=\"nofollow noreferrer\">https://console.firebase.google.com/..</a>. the message appears on my mobile no matter whether the app is open on the device or not.</p>\n</li>\n<li><p>If I send a Firebase message with this Java code:</p>\n<pre><code>public void sendFirebaseMessage() {\n try {\n\n     String registrationToken = &quot;c4QGdbL_TTqZXaBC3F...&quot;;\n     Message message = Message.builder().putData(&quot;score&quot;, &quot;850&quot;).putData(&quot;time&quot;, &quot;11:06&quot;).setToken(registrationToken).build();\n\n     final FirebaseApp app = FirebaseApp.getInstancemy-app&quot;);\n     String response = FirebaseMessaging.getInstance(app).send(message);\n     logger.info(&quot;successfully sent firebase message with response '{}' in FirebaseServiceImpl#sendFirebaseMessage&quot;, response);\n   } catch ...\n  }\n</code></pre>\n</li>\n</ol>\n<p>then the app must be open so that the message appears.</p>\n<p>My question would be what do I have to do so that I can send Firebase messages over Java code that behave like in 1.?</p>\n"},{"tags":["java","android","firebase","firebase-authentication"],"comments":[{"owner":{"account_id":426109,"reputation":302042,"user_id":807126,"display_name":"Doug Stevenson"},"score":1,"creation_date":1700055820,"post_id":77488149,"comment_id":136607667,"body_markdown":"What do you mean &quot;not returning anything&quot;?  Please edit the question to explain in more detail what exactly isn&#39;t working the way you expect. You could also add some logging statements and share the output to illustrate.","body":"What do you mean &quot;not returning anything&quot;?  Please edit the question to explain in more detail what exactly isn&#39;t working the way you expect. You could also add some logging statements and share the output to illustrate."},{"owner":{"account_id":14722107,"reputation":5143,"user_id":10632369,"display_name":"tomerpacific"},"score":1,"creation_date":1700058470,"post_id":77488149,"comment_id":136608218,"body_markdown":"Have you thought about adding an onFailureListener to see if that gets triggered? It would allow you to see the error (if one exists).","body":"Have you thought about adding an onFailureListener to see if that gets triggered? It would allow you to see the error (if one exists)."},{"owner":{"account_id":29909333,"reputation":1,"user_id":22921159,"display_name":"SkyBlob"},"score":0,"creation_date":1700058787,"post_id":77488149,"comment_id":136608293,"body_markdown":"@DougStevenson i just edit the question","body":"@DougStevenson i just edit the question"},{"owner":{"account_id":426109,"reputation":302042,"user_id":807126,"display_name":"Doug Stevenson"},"score":1,"creation_date":1700059233,"post_id":77488149,"comment_id":136608418,"body_markdown":"@tomerpacific has a point - you&#39;re not checking for errors at all, so you would never know if something is going wrong.","body":"@tomerpacific has a point - you&#39;re not checking for errors at all, so you would never know if something is going wrong."}],"owner":{"account_id":29909333,"reputation":1,"user_id":22921159,"display_name":"SkyBlob"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":37,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700058605,"creation_date":1700055468,"question_id":77488149,"body_markdown":"I&#39;m creating a login and register page for my application on android studio with Firebase and I have a problem when I&#39;m creating an account. My task doesn&#39;t get what I am supposed to have.\r\n\r\n\r\n```\r\npackage com.example.wheretowork;\r\n\r\npublic class Inscription extends AppCompatActivity {\r\n\r\n    EditText editTextEmail, editTextMdp;\r\n    Button btnInscription;\r\n    TextView clickConnexion;\r\n    FirebaseAuth mAuth;\r\n\r\n        btnInscription.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                String email, mdp;\r\n                email = String.valueOf(editTextEmail.getText());\r\n                mdp = String.valueOf(editTextMdp.getText());\r\n\r\n                if (TextUtils.isEmpty(email)){\r\n                    Toast.makeText(Inscription.this,&quot;Entrez votre email&quot;, Toast.LENGTH_SHORT).show();\r\n                    return;\r\n                }\r\n\r\n                if (TextUtils.isEmpty(mdp)){\r\n                    Toast.makeText(Inscription.this,&quot;Entrez votre mot de passe&quot;, Toast.LENGTH_SHORT).show();\r\n                    return;\r\n                }\r\n\r\n                mAuth.createUserWithEmailAndPassword(email, mdp).addOnCompleteListener(new OnCompleteListener&lt;AuthResult&gt;() {\r\n                            @Override\r\n                            public void onComplete(@NonNull Task&lt;AuthResult&gt; task) {\r\n                                if (task.isSuccessful()) {\r\n                                    // Sign in success, update UI with the signed-in user&#39;s information\r\n                                    Toast.makeText(Inscription.this, &quot;Compte cr&#233;&#233;.&quot;, Toast.LENGTH_SHORT).show();\r\n                                    Intent intent = new Intent(getApplicationContext(), Connexion.class);\r\n                                    startActivity(intent);\r\n                                    finish();\r\n                                } else {\r\n                                    // If sign in fails, display a message to the user.\r\n                                    Toast.makeText(Inscription.this, &quot;Compte non cr&#233;&#233;.&quot;, Toast.LENGTH_SHORT).show();\r\n                                }\r\n                            }\r\n                });\r\n            }\r\n        });\r\n    }\r\n}\r\n```\r\n\r\nDo you have an idea why my task isn&#39;t returning anything? \r\n\r\n`public void onComplete(@NonNull Task&lt;AuthResult&gt; task)`\r\n\r\nI have used logs and I saw that&#39;s my Email and Mdp (pwd) were found.\r\nHowever the exact problem is that this line of code (under) always return false, and so my userAccount is never created.\r\n\r\n`if (task.isSuccessful())`\r\n\r\n[LOG.screenshot][1]\r\n \r\nI would know if someone know why it never return true\r\n\r\nThx for ur answer.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/WysWL.png","title":"Firebase (@NonNull Task&lt;AuthResult&gt; task) return nothing","body":"<p>I'm creating a login and register page for my application on android studio with Firebase and I have a problem when I'm creating an account. My task doesn't get what I am supposed to have.</p>\n<pre><code>package com.example.wheretowork;\n\npublic class Inscription extends AppCompatActivity {\n\n    EditText editTextEmail, editTextMdp;\n    Button btnInscription;\n    TextView clickConnexion;\n    FirebaseAuth mAuth;\n\n        btnInscription.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                String email, mdp;\n                email = String.valueOf(editTextEmail.getText());\n                mdp = String.valueOf(editTextMdp.getText());\n\n                if (TextUtils.isEmpty(email)){\n                    Toast.makeText(Inscription.this,&quot;Entrez votre email&quot;, Toast.LENGTH_SHORT).show();\n                    return;\n                }\n\n                if (TextUtils.isEmpty(mdp)){\n                    Toast.makeText(Inscription.this,&quot;Entrez votre mot de passe&quot;, Toast.LENGTH_SHORT).show();\n                    return;\n                }\n\n                mAuth.createUserWithEmailAndPassword(email, mdp).addOnCompleteListener(new OnCompleteListener&lt;AuthResult&gt;() {\n                            @Override\n                            public void onComplete(@NonNull Task&lt;AuthResult&gt; task) {\n                                if (task.isSuccessful()) {\n                                    // Sign in success, update UI with the signed-in user's information\n                                    Toast.makeText(Inscription.this, &quot;Compte créé.&quot;, Toast.LENGTH_SHORT).show();\n                                    Intent intent = new Intent(getApplicationContext(), Connexion.class);\n                                    startActivity(intent);\n                                    finish();\n                                } else {\n                                    // If sign in fails, display a message to the user.\n                                    Toast.makeText(Inscription.this, &quot;Compte non créé.&quot;, Toast.LENGTH_SHORT).show();\n                                }\n                            }\n                });\n            }\n        });\n    }\n}\n</code></pre>\n<p>Do you have an idea why my task isn't returning anything?</p>\n<p><code>public void onComplete(@NonNull Task&lt;AuthResult&gt; task)</code></p>\n<p>I have used logs and I saw that's my Email and Mdp (pwd) were found.\nHowever the exact problem is that this line of code (under) always return false, and so my userAccount is never created.</p>\n<p><code>if (task.isSuccessful())</code></p>\n<p><a href=\"https://i.stack.imgur.com/WysWL.png\" rel=\"nofollow noreferrer\">LOG.screenshot</a></p>\n<p>I would know if someone know why it never return true</p>\n<p>Thx for ur answer.</p>\n"},{"tags":["java","algorithm","permutation"],"answers":[{"tags":[],"owner":{"account_id":87165,"reputation":3549,"user_id":241899,"accept_rate":92,"display_name":"Vitaly Olegovitch"},"comment_count":0,"down_vote_count":1,"up_vote_count":3,"is_accepted":false,"score":2,"last_activity_date":1627033357,"creation_date":1335298268,"answer_id":10305309,"question_id":10305153,"body_markdown":"The problem is that you have to [clone][1] the ArrayList before making the recursive call. Otherwise you will be adding always to the same ArrayList.\r\n\r\n```java\r\n//allPossibleItems is an AL of all items\r\n\r\n//this is called with generatePerm(null, new ArrayList&lt;Item&gt;);\r\n\r\nprivate void generatePerm(Item i, ArrayList&lt;Item&gt; a) {\r\n    if (i != null) { a.add(i); }\r\n    if (a.size() == DESIRED_SIZE) {\r\n        permutations.add(a);\r\n        return;\r\n    }\r\n    for (int j = 0; j &lt; allPossibleItems.size(); j++) {\r\n        if (!a.contains(allPossibleItems.get(j))) {\r\n            ArrayList&lt;Item&gt; b = clone(a);\r\n            generatePerm(allPossibleItems.get(j), b);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/715650/how-to-clone-arraylist-and-also-clone-its-contents\r\n","title":"Generating all possible permutations of a list recursively","body":"<p>The problem is that you have to <a href=\"https://stackoverflow.com/questions/715650/how-to-clone-arraylist-and-also-clone-its-contents\">clone</a> the ArrayList before making the recursive call. Otherwise you will be adding always to the same ArrayList.</p>\n<pre class=\"lang-java prettyprint-override\"><code>//allPossibleItems is an AL of all items\n\n//this is called with generatePerm(null, new ArrayList&lt;Item&gt;);\n\nprivate void generatePerm(Item i, ArrayList&lt;Item&gt; a) {\n    if (i != null) { a.add(i); }\n    if (a.size() == DESIRED_SIZE) {\n        permutations.add(a);\n        return;\n    }\n    for (int j = 0; j &lt; allPossibleItems.size(); j++) {\n        if (!a.contains(allPossibleItems.get(j))) {\n            ArrayList&lt;Item&gt; b = clone(a);\n            generatePerm(allPossibleItems.get(j), b);\n        }\n    }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":18464101,"reputation":92,"user_id":18466656,"display_name":"moritz"},"score":0,"creation_date":1656241143,"post_id":10305419,"comment_id":128518974,"body_markdown":"How would I change the code if I want not all permutations of the same length but I have a given parameter n which reflects the desired size the individual sublists should contain? For example I give the list [1,2,3,4] with n of 2 the I want [[1,2],[1,3], ...] and so forth ?","body":"How would I change the code if I want not all permutations of the same length but I have a given parameter n which reflects the desired size the individual sublists should contain? For example I give the list [1,2,3,4] with n of 2 the I want [[1,2],[1,3], ...] and so forth ?"}],"tags":[],"owner":{"account_id":390363,"reputation":7217,"user_id":750378,"accept_rate":69,"display_name":"DaveFar"},"comment_count":1,"down_vote_count":0,"up_vote_count":25,"is_accepted":true,"score":25,"last_activity_date":1626994297,"creation_date":1335298782,"answer_id":10305419,"question_id":10305153,"body_markdown":"If `allPossibleItems` contains two different elements, x and y, then you successively write x and y to the list until it reaches `DESIRED_SIZE`. Is that what you really want? If you pick `DESIRED_SIZE` sufficiently large, you will have too many recursive calls on the stack, hence the SO exception.\r\n\r\nWhat I&#39;d do (if original has no douplets / duplicates) is: \r\n\r\n```java\r\npublic &lt;E&gt; List&lt;List&lt;E&gt;&gt; generatePerm(List&lt;E&gt; original) {\r\n  if (original.isEmpty()) {\r\n    List&lt;List&lt;E&gt;&gt; result = new ArrayList&lt;&gt;();\r\n    result.add(new ArrayList&lt;&gt;());\r\n    return result;\r\n  }\r\n  E firstElement = original.remove(0);\r\n  List&lt;List&lt;E&gt;&gt; returnValue = new ArrayList&lt;&gt;();\r\n  List&lt;List&lt;E&gt;&gt; permutations = generatePerm(original);\r\n  for (List&lt;E&gt; smallerPermutated : permutations) {\r\n    for (int index = 0; index &lt;= smallerPermutated.size(); index++) {\r\n      List&lt;E&gt; temp = new ArrayList&lt;&gt;(smallerPermutated);\r\n      temp.add(index, firstElement);\r\n      returnValue.add(temp);\r\n    }\r\n  }\r\n  return returnValue;\r\n}\r\n```\r\n","title":"Generating all possible permutations of a list recursively","body":"<p>If <code>allPossibleItems</code> contains two different elements, x and y, then you successively write x and y to the list until it reaches <code>DESIRED_SIZE</code>. Is that what you really want? If you pick <code>DESIRED_SIZE</code> sufficiently large, you will have too many recursive calls on the stack, hence the SO exception.</p>\n<p>What I'd do (if original has no douplets / duplicates) is:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public &lt;E&gt; List&lt;List&lt;E&gt;&gt; generatePerm(List&lt;E&gt; original) {\n  if (original.isEmpty()) {\n    List&lt;List&lt;E&gt;&gt; result = new ArrayList&lt;&gt;();\n    result.add(new ArrayList&lt;&gt;());\n    return result;\n  }\n  E firstElement = original.remove(0);\n  List&lt;List&lt;E&gt;&gt; returnValue = new ArrayList&lt;&gt;();\n  List&lt;List&lt;E&gt;&gt; permutations = generatePerm(original);\n  for (List&lt;E&gt; smallerPermutated : permutations) {\n    for (int index = 0; index &lt;= smallerPermutated.size(); index++) {\n      List&lt;E&gt; temp = new ArrayList&lt;&gt;(smallerPermutated);\n      temp.add(index, firstElement);\n      returnValue.add(temp);\n    }\n  }\n  return returnValue;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6724128,"reputation":303,"user_id":5182863,"display_name":"Rahul Madhavan"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1629095516,"creation_date":1522788894,"answer_id":49639008,"question_id":10305153,"body_markdown":"Googling lead me to this question. i found the below method faster than other methods. \r\n\r\nBasically I use a Set to recursively generate the permutations. To illustrate, the first position can hold all possible values, the second all possible values except the first value, and so on. When we get to the last position, there is only one possibility.\r\n\r\nIn terms of parameters to the recursive function, (1) we pass down what has already been recorded as currentstring. (2) We pass the Arraylist which holds the results - list_of_permutes (3) We pass set from which to choose the current number - currentnums.\r\nAt the last level, we have a complete permutation, which is then added to the arraylist - list_of_permutes and this is returned upwards.\r\n\r\n```java\r\npublic static ArrayList recurse_nums(Set&lt;Integer&gt; currentnums,\r\n                                     String currentstring,\r\n                                     ArrayList list_of_permutes) {\r\n    if (currentnums.size() == 1) {\r\n        int elem = currentnums.iterator().next();\r\n        list_of_permutes.add(currentstring + Integer.toString(elem));\r\n        return list_of_permutes;\r\n    }\r\n    for (int a : currentnums) {\r\n        String newstring = currentstring + a;\r\n        Set&lt;Integer&gt; newnums = new HashSet&lt;&gt;();\r\n        newnums.addAll(currentnums);\r\n        newnums.remove(a);\r\n        recurse_nums(newnums, newstring, list_of_permutes);\r\n    }\r\n    return list_of_permutes;\r\n}\r\n```\r\nThis can be called from something like the following:\r\n```java\r\npublic static ArrayList permute_array(int[] arr) {\r\n    Set&lt;Integer&gt; currentnums = new HashSet&lt;&gt;();\r\n    for (int i = 0; i &lt; arr.length; i++) {\r\n        currentnums.add(arr[i]);\r\n    }\r\n    ArrayList permutations = new ArrayList();\r\n    recurse_nums(currentnums, &quot;&quot;, permutations);\r\n    return permutations;\r\n}\r\n```\r\n","title":"Generating all possible permutations of a list recursively","body":"<p>Googling lead me to this question. i found the below method faster than other methods.</p>\n<p>Basically I use a Set to recursively generate the permutations. To illustrate, the first position can hold all possible values, the second all possible values except the first value, and so on. When we get to the last position, there is only one possibility.</p>\n<p>In terms of parameters to the recursive function, (1) we pass down what has already been recorded as currentstring. (2) We pass the Arraylist which holds the results - list_of_permutes (3) We pass set from which to choose the current number - currentnums.\nAt the last level, we have a complete permutation, which is then added to the arraylist - list_of_permutes and this is returned upwards.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static ArrayList recurse_nums(Set&lt;Integer&gt; currentnums,\n                                     String currentstring,\n                                     ArrayList list_of_permutes) {\n    if (currentnums.size() == 1) {\n        int elem = currentnums.iterator().next();\n        list_of_permutes.add(currentstring + Integer.toString(elem));\n        return list_of_permutes;\n    }\n    for (int a : currentnums) {\n        String newstring = currentstring + a;\n        Set&lt;Integer&gt; newnums = new HashSet&lt;&gt;();\n        newnums.addAll(currentnums);\n        newnums.remove(a);\n        recurse_nums(newnums, newstring, list_of_permutes);\n    }\n    return list_of_permutes;\n}\n</code></pre>\n<p>This can be called from something like the following:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static ArrayList permute_array(int[] arr) {\n    Set&lt;Integer&gt; currentnums = new HashSet&lt;&gt;();\n    for (int i = 0; i &lt; arr.length; i++) {\n        currentnums.add(arr[i]);\n    }\n    ArrayList permutations = new ArrayList();\n    recurse_nums(currentnums, &quot;&quot;, permutations);\n    return permutations;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1592127,"reputation":18171,"user_id":1475228,"accept_rate":84,"display_name":"Pritam Banerjee"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1627124500,"creation_date":1559108643,"answer_id":56353820,"question_id":10305153,"body_markdown":"You can keep the start fixed and then keep swapping. It is one of the easiest approaches to understand.\r\n\r\n```java\r\npublic class PermutationListRecursion {\r\n    private Set&lt;List&lt;Integer&gt;&gt; permList = new HashSet&lt;&gt;();\r\n\r\n    public static void main(String[] args) {\r\n        PermutationListRecursion pt = new PermutationListRecursion();\r\n        Integer[] nums = {1, 2, 3};\r\n        pt.permute(nums);\r\n        System.out.println(pt.permList);\r\n    }\r\n\r\n    public void permute(Integer[] nums) {\r\n        permutation(0, nums.length - 1, nums);\r\n    }\r\n\r\n    public void permutation(int start, int end, Integer[] nums) {\r\n        if (start == end) {\r\n            permList.add(new ArrayList&lt;Integer&gt;(Arrays.asList(nums)));\r\n        }\r\n        for (int i = start; i &lt;= end; i++) {\r\n            permList.add(swap(nums, start, i));\r\n            permutation(start + 1, end, nums);\r\n            permList.add(swap(nums, start, i));\r\n        }\r\n    }\r\n\r\n    private List&lt;Integer&gt; swap(Integer[] arr, int a, int b) {\r\n        if (a == b) {\r\n            return new ArrayList&lt;&gt;(Arrays.asList(arr));\r\n        }\r\n        Integer temp = arr[b];\r\n        arr[b] = arr[a];\r\n        arr[a] = temp;\r\n        return new ArrayList&lt;&gt;(Arrays.asList(arr));\r\n    }\r\n}\r\n```\r\n","title":"Generating all possible permutations of a list recursively","body":"<p>You can keep the start fixed and then keep swapping. It is one of the easiest approaches to understand.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class PermutationListRecursion {\n    private Set&lt;List&lt;Integer&gt;&gt; permList = new HashSet&lt;&gt;();\n\n    public static void main(String[] args) {\n        PermutationListRecursion pt = new PermutationListRecursion();\n        Integer[] nums = {1, 2, 3};\n        pt.permute(nums);\n        System.out.println(pt.permList);\n    }\n\n    public void permute(Integer[] nums) {\n        permutation(0, nums.length - 1, nums);\n    }\n\n    public void permutation(int start, int end, Integer[] nums) {\n        if (start == end) {\n            permList.add(new ArrayList&lt;Integer&gt;(Arrays.asList(nums)));\n        }\n        for (int i = start; i &lt;= end; i++) {\n            permList.add(swap(nums, start, i));\n            permutation(start + 1, end, nums);\n            permList.add(swap(nums, start, i));\n        }\n    }\n\n    private List&lt;Integer&gt; swap(Integer[] arr, int a, int b) {\n        if (a == b) {\n            return new ArrayList&lt;&gt;(Arrays.asList(arr));\n        }\n        Integer temp = arr[b];\n        arr[b] = arr[a];\n        arr[a] = temp;\n        return new ArrayList&lt;&gt;(Arrays.asList(arr));\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11449673,"reputation":1,"user_id":8392389,"display_name":"CornelPaun"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1607269371,"creation_date":1607163954,"answer_id":65155940,"question_id":10305153,"body_markdown":"I looked into this thread and I analyzed the solutions which are correct. Unfortunately, i need this recursion for a huge input which will result in creating a lot of objects which I don&#39;t need stored, I want to apply a method on every permutation and keep only those which satisfy my algorithm so I came up with this solution. Hope it will help others.\r\n\r\n    public static &lt;E&gt; void iteratePermutations(List&lt;E&gt; original, Consumer&lt;List&lt;E&gt;&gt; consumer) {\r\n        Objects.requireNonNull(original);\r\n        consumer.accept(original);\r\n        iteratePermutationsRecursively(original, 0, consumer);\r\n    }\r\n\r\n    public static &lt;E&gt; void iteratePermutationsRecursively(List&lt;E&gt; original, int start, Consumer&lt;List&lt;E&gt;&gt; consumer) {\r\n        Objects.requireNonNull(original);\r\n        for (int i = start; i &lt; original.size() - 1; i++) {\r\n            for (int j = i + 1; j &lt; original.size(); j++) {\r\n                List&lt;E&gt; temp = new ArrayList&lt;&gt;(original);\r\n                E tempVal = temp.get(i);\r\n                temp.set(i, temp.get(j));\r\n                temp.set(j, tempVal);\r\n                consumer.accept(temp);\r\n                iteratePermutationsRecursively(temp, i + 1, consumer);\r\n            }\r\n        }\r\n    }\r\n\r\nI can be called as:\r\n\r\n    List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5);\r\n    List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();\r\n    iteratePermutations(list, result::add);\r\n\r\nor:\r\n\r\n    List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5);\r\n    iteratePermutations(list, System.out::println);\r\n\r\n ","title":"Generating all possible permutations of a list recursively","body":"<p>I looked into this thread and I analyzed the solutions which are correct. Unfortunately, i need this recursion for a huge input which will result in creating a lot of objects which I don't need stored, I want to apply a method on every permutation and keep only those which satisfy my algorithm so I came up with this solution. Hope it will help others.</p>\n<pre><code>public static &lt;E&gt; void iteratePermutations(List&lt;E&gt; original, Consumer&lt;List&lt;E&gt;&gt; consumer) {\n    Objects.requireNonNull(original);\n    consumer.accept(original);\n    iteratePermutationsRecursively(original, 0, consumer);\n}\n\npublic static &lt;E&gt; void iteratePermutationsRecursively(List&lt;E&gt; original, int start, Consumer&lt;List&lt;E&gt;&gt; consumer) {\n    Objects.requireNonNull(original);\n    for (int i = start; i &lt; original.size() - 1; i++) {\n        for (int j = i + 1; j &lt; original.size(); j++) {\n            List&lt;E&gt; temp = new ArrayList&lt;&gt;(original);\n            E tempVal = temp.get(i);\n            temp.set(i, temp.get(j));\n            temp.set(j, tempVal);\n            consumer.accept(temp);\n            iteratePermutationsRecursively(temp, i + 1, consumer);\n        }\n    }\n}\n</code></pre>\n<p>I can be called as:</p>\n<pre><code>List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5);\nList&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();\niteratePermutations(list, result::add);\n</code></pre>\n<p>or:</p>\n<pre><code>List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5);\niteratePermutations(list, System.out::println);\n</code></pre>\n"},{"tags":[],"owner":{"display_name":"user16497917"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1627379191,"creation_date":1627184045,"answer_id":68515320,"question_id":10305153,"body_markdown":"### The *map and reduce* approach\r\n\r\n- The input list, may contain duplicates.\r\n\r\n    ```java\r\n    List&lt;String&gt; list = Arrays.asList(&quot;&#120813;&quot;, &quot;&#120814;&quot;, &quot;&#120815;&quot;);\r\n    ```\r\n\r\n- The `map` method represents each element of a list as a *list of permutation maps*.\r\n\r\n    ```\r\n    1: [{0=&#120813;}, {1=&#120814;}, {2=&#120815;}]\r\n    2: [{0=&#120813;}, {1=&#120814;}, {2=&#120815;}]\r\n    3: [{0=&#120813;}, {1=&#120814;}, {2=&#120815;}]\r\n    ```\r\n\r\n- The `reduce` method sequentially sums pairs of these lists and concatenates pairs of maps into a single *list of maps of permutations*.\r\n\r\n    ```\r\n    {0=&#120813;, 1=&#120814;, 2=&#120815;}\r\n    {0=&#120813;, 2=&#120815;, 1=&#120814;}\r\n    {1=&#120814;, 0=&#120813;, 2=&#120815;}\r\n    {1=&#120814;, 2=&#120815;, 0=&#120813;}\r\n    {2=&#120815;, 0=&#120813;, 1=&#120814;}\r\n    {2=&#120815;, 1=&#120814;, 0=&#120813;}\r\n    ```\r\n\r\n[Try it online!][1]\r\n\r\n```java\r\npublic static void main(String[] args) {\r\n    // input list\r\n    List&lt;String&gt; list = Arrays.asList(&quot;&#120813;&quot;, &quot;&#120814;&quot;, &quot;&#120815;&quot;);\r\n    // possible permutations\r\n    List&lt;Map&lt;Integer, String&gt;&gt; pp = possiblePermutations(list);\r\n    // output\r\n    pp.forEach(System.out::println);\r\n}\r\n```\r\n```java\r\n/**\r\n * @param list the input list, may contain duplicates\r\n * @param &lt;E&gt;  the type of the element of the list\r\n * @return the list of possible permutations\r\n */\r\npublic static &lt;E&gt; List&lt;Map&lt;Integer, E&gt;&gt; possiblePermutations(List&lt;E&gt; list) {\r\n    // check if the list is non-null and non-empty\r\n    if (list == null || list.size() == 0) return Collections.emptyList();\r\n    return IntStream.range(0, list.size())\r\n            // represent each list element as a list of permutation maps\r\n            .mapToObj(i -&gt; IntStream.range(0, list.size())\r\n                    // key - element position, value - element itself\r\n                    .mapToObj(j -&gt; Collections.singletonMap(j, list.get(j)))\r\n                    // Stream&lt;List&lt;Map&lt;Integer,E&gt;&gt;&gt;\r\n                    .collect(Collectors.toList()))\r\n            // reduce a stream of lists to a single list\r\n            .reduce((list1, list2) -&gt; list1.stream()\r\n                    .flatMap(map1 -&gt; list2.stream()\r\n                            // filter out those keys that are already present\r\n                            .filter(map2 -&gt; map2.keySet().stream()\r\n                                    .noneMatch(map1::containsKey))\r\n                            // concatenate entries of two maps, order matters\r\n                            .map(map2 -&gt; new LinkedHashMap&lt;Integer, E&gt;() {{\r\n                                putAll(map1);\r\n                                putAll(map2);\r\n                            }}))\r\n                    // list of combinations\r\n                    .collect(Collectors.toList()))\r\n            // otherwise an empty collection\r\n            .orElse(Collections.emptyList());\r\n}\r\n```\r\n\r\n---\r\n\r\n&lt;sup&gt;See also: [String permutations using recursion in Java][2]&lt;/sup&gt;\r\n\r\n\r\n  [1]: https://tio.run/##pVVRb9owEH7vrzj1KUEQWh4ZRasmpE1btUnsbdqDSQ4wOLZlO61Yy0@Z9gu2/bX9A3Z2QkihtEyLhEzOd@fvvjt/WbBb1lEa5SJbbjY818o4WJAxKRwXSevV2YHNOoMs91tnupgInkIqmLVww7iE@zOgp7Jbxxwtt4pnkNNuNHaGy9mXr8DMzMaVs3@6XeBSFw4Et662fqCXQRkzDDtwBdfGsJVNmPWb0fmf7z9@nrfBr7@q9fd5/KqZWCtr@UQgaDR54SEpaR@fccP04J10OEPThurAIWhN522jPzWCI4/l8SGqcAS/tmidTJUZsXQejVfWYZ6QQ7@vKbMTsgpdn4Wl22qVcS14rZlheVmqm2ODkzYRuIJUSedZzgpN/DKHdi9yMBpCiHQrjaCm4T8KzFG67euOYgoz6Aoja7v3eYavVveJ9vozD1kceQKf4i64jsp@7o1AOsd0CXwHE7gFqWRHFkIAk1l4wVy7VR1G3lE5GlcQ3B4eQmhi@TeMYm@@iKEq840SAtOAIwlpwhA1Oln5URXjcsoNkzOMLtrNnHHt3sBuUBu0nmakrpfot8QzC2xH744M6qm2B8kSsn5WHyeLiENn@M9YGpiWuIJOjYK6wf2pbbhlosDGDncWxfRoph2ghQfUJNHSTRHolKTeR4sK2QxdtIifh1aWNDiYGxqb4XEgaXl0VEFQxiZOlT081pWsSJHYL0XL8@8hWnDKGwP6x5pTn1WGRmG4LsvKerGvPxgqFYyOF5lMBXOeFmLvchvXezmugX7KhUPjtYVuhLLoG0rQ54xGylBVglJlK6gG78WMSZnPA@p5QH5NKOWY@hWfDqxOR5cRb5gjjfMl9vuVOtn3uIpPqo8CvIhJ@gEVYDjaIFJ3KtyMNiiTUf05cwTbvlxfXrIdipN4R6okl5i9ZXa@J02kC/f3JxVK@nstRCiwIROnRfROiFivn78nW9VIVT7hcu/b9f/3Q5HSmjtOo8UkBEWEtL7eh3eCPmnCYnRERuvP2nqz@Qs &quot;Java (OpenJDK 8) – Try It Online&quot;\r\n  [2]: https://stackoverflow.com/a/67114390/16497917\r\n","title":"Generating all possible permutations of a list recursively","body":"<h3 id=\"the-map-and-reduce-approach-h89w\">The <em>map and reduce</em> approach</h3>\n<ul>\n<li><p>The input list, may contain duplicates.</p>\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;String&gt; list = Arrays.asList(&quot;𝟭&quot;, &quot;𝟮&quot;, &quot;𝟯&quot;);\n</code></pre>\n</li>\n<li><p>The <code>map</code> method represents each element of a list as a <em>list of permutation maps</em>.</p>\n<pre><code>1: [{0=𝟭}, {1=𝟮}, {2=𝟯}]\n2: [{0=𝟭}, {1=𝟮}, {2=𝟯}]\n3: [{0=𝟭}, {1=𝟮}, {2=𝟯}]\n</code></pre>\n</li>\n<li><p>The <code>reduce</code> method sequentially sums pairs of these lists and concatenates pairs of maps into a single <em>list of maps of permutations</em>.</p>\n<pre><code>{0=𝟭, 1=𝟮, 2=𝟯}\n{0=𝟭, 2=𝟯, 1=𝟮}\n{1=𝟮, 0=𝟭, 2=𝟯}\n{1=𝟮, 2=𝟯, 0=𝟭}\n{2=𝟯, 0=𝟭, 1=𝟮}\n{2=𝟯, 1=𝟮, 0=𝟭}\n</code></pre>\n</li>\n</ul>\n<p><a href=\"https://tio.run/##pVVRb9owEH7vrzj1KUEQWh4ZRasmpE1btUnsbdqDSQ4wOLZlO61Yy0@Z9gu2/bX9A3Z2QkihtEyLhEzOd@fvvjt/WbBb1lEa5SJbbjY818o4WJAxKRwXSevV2YHNOoMs91tnupgInkIqmLVww7iE@zOgp7Jbxxwtt4pnkNNuNHaGy9mXr8DMzMaVs3@6XeBSFw4Et662fqCXQRkzDDtwBdfGsJVNmPWb0fmf7z9@nrfBr7@q9fd5/KqZWCtr@UQgaDR54SEpaR@fccP04J10OEPThurAIWhN522jPzWCI4/l8SGqcAS/tmidTJUZsXQejVfWYZ6QQ7@vKbMTsgpdn4Wl22qVcS14rZlheVmqm2ODkzYRuIJUSedZzgpN/DKHdi9yMBpCiHQrjaCm4T8KzFG67euOYgoz6Aoja7v3eYavVveJ9vozD1kceQKf4i64jsp@7o1AOsd0CXwHE7gFqWRHFkIAk1l4wVy7VR1G3lE5GlcQ3B4eQmhi@TeMYm@@iKEq840SAtOAIwlpwhA1Oln5URXjcsoNkzOMLtrNnHHt3sBuUBu0nmakrpfot8QzC2xH744M6qm2B8kSsn5WHyeLiENn@M9YGpiWuIJOjYK6wf2pbbhlosDGDncWxfRoph2ghQfUJNHSTRHolKTeR4sK2QxdtIifh1aWNDiYGxqb4XEgaXl0VEFQxiZOlT081pWsSJHYL0XL8@8hWnDKGwP6x5pTn1WGRmG4LsvKerGvPxgqFYyOF5lMBXOeFmLvchvXezmugX7KhUPjtYVuhLLoG0rQ54xGylBVglJlK6gG78WMSZnPA@p5QH5NKOWY@hWfDqxOR5cRb5gjjfMl9vuVOtn3uIpPqo8CvIhJ@gEVYDjaIFJ3KtyMNiiTUf05cwTbvlxfXrIdipN4R6okl5i9ZXa@J02kC/f3JxVK@nstRCiwIROnRfROiFivn78nW9VIVT7hcu/b9f/3Q5HSmjtOo8UkBEWEtL7eh3eCPmnCYnRERuvP2nqz@Qs\" rel=\"nofollow noreferrer\" title=\"Java (OpenJDK 8) – Try It Online\">Try it online!</a></p>\n<pre class=\"lang-java prettyprint-override\"><code>public static void main(String[] args) {\n    // input list\n    List&lt;String&gt; list = Arrays.asList(&quot;𝟭&quot;, &quot;𝟮&quot;, &quot;𝟯&quot;);\n    // possible permutations\n    List&lt;Map&lt;Integer, String&gt;&gt; pp = possiblePermutations(list);\n    // output\n    pp.forEach(System.out::println);\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>/**\n * @param list the input list, may contain duplicates\n * @param &lt;E&gt;  the type of the element of the list\n * @return the list of possible permutations\n */\npublic static &lt;E&gt; List&lt;Map&lt;Integer, E&gt;&gt; possiblePermutations(List&lt;E&gt; list) {\n    // check if the list is non-null and non-empty\n    if (list == null || list.size() == 0) return Collections.emptyList();\n    return IntStream.range(0, list.size())\n            // represent each list element as a list of permutation maps\n            .mapToObj(i -&gt; IntStream.range(0, list.size())\n                    // key - element position, value - element itself\n                    .mapToObj(j -&gt; Collections.singletonMap(j, list.get(j)))\n                    // Stream&lt;List&lt;Map&lt;Integer,E&gt;&gt;&gt;\n                    .collect(Collectors.toList()))\n            // reduce a stream of lists to a single list\n            .reduce((list1, list2) -&gt; list1.stream()\n                    .flatMap(map1 -&gt; list2.stream()\n                            // filter out those keys that are already present\n                            .filter(map2 -&gt; map2.keySet().stream()\n                                    .noneMatch(map1::containsKey))\n                            // concatenate entries of two maps, order matters\n                            .map(map2 -&gt; new LinkedHashMap&lt;Integer, E&gt;() {{\n                                putAll(map1);\n                                putAll(map2);\n                            }}))\n                    // list of combinations\n                    .collect(Collectors.toList()))\n            // otherwise an empty collection\n            .orElse(Collections.emptyList());\n}\n</code></pre>\n<hr />\n<p><sup>See also: <a href=\"https://stackoverflow.com/a/67114390/16497917\">String permutations using recursion in Java</a></sup></p>\n"},{"tags":[],"owner":{"account_id":23897665,"reputation":1,"user_id":17896346,"display_name":"Arshad Mayet"},"comment_count":0,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1655028690,"creation_date":1654019841,"answer_id":72452245,"question_id":10305153,"body_markdown":"Here is my solution to this permutation challenge, I use the DFS Algorithm to build a permutations tree, which I prune depending on the size of the required subset.\r\n\r\n\r\n```\r\nimport java.util.ArrayList;\r\nimport java.util.Arrays;\r\nimport java.util.List;\r\nimport java.util.stream.Collectors;\r\n\r\n\t/**\r\n    * Permuation Application\r\n    * This class works out all permutations of a given set of elements\r\n    * \r\n    * @author arshadmayet\r\n    *\r\n    */\r\n    public class Permutation {\r\n    \r\n    public static final String EMPTY_STRING = &quot;&quot;;\r\n    \r\n    /**\r\n     * DFS Algorithm to find all permutaions on a sequence of elements\r\n     * \r\n     * @param pref        path of current element in permutation tree\r\n     * @param result      to store permutations\r\n     * @param sequence    list of elements to permutate\r\n     * @param subset      subset size, use size of sequence for the \r\n     *                    entire size per permutation.\r\n     * @return all permutations of the given sequence as a String List                    \r\n     */\r\n     public List&lt;String&gt; permutate(String pref, List&lt;String&gt; result, \r\n            List&lt;String&gt; sequence, int subset) {\r\n            \r\n        /*\r\n         * Get just the unvisited children for tree element\r\n         */\r\n        List&lt;String&gt; diff = sequence.stream().filter(x -&gt; ! \r\n                     (pref).contains(x)).collect(Collectors.toList());\r\n\r\n        /*\r\n         * No more children therefore reached end of branch store branch paths\r\n         */\r\n         int limit = sequence.size() - subset;\r\n         if(diff.size()==limit){\r\n            result.add(pref);\r\n         }\r\n\r\n        /*\r\n         * Loop thru each child\r\n         */\r\n         for (String s : diff) {\r\n            if(pref.length()&gt;subset) break; // to trim permuatation tree based on \r\n                                          // result sequence limit\r\n            permutate(pref + s, result,sequence,subset); // recursively traverse \r\n                                                       //tree\r\n        }\r\n        return result;\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n    \r\n        Permutation permutation = new Permutation();\r\n        \r\n        // Test 1\r\n        String[] sequenceArray1 = { &quot;1&quot;, &quot;2&quot;, &quot;3&quot; };\r\n        List&lt;String&gt; sequence1 = Arrays.asList(sequenceArray1);\r\n        int subset1= sequence1.size();  //subset\r\n        List&lt;String&gt; results1 =  permutation.permutate(EMPTY_STRING,\r\n                                        new ArrayList&lt;String&gt;(),\r\n                                        sequence1,\r\n                                        subset1);\r\n        \r\n        //Display Logic\r\n        System.out.println(&quot;Test 1&quot;);\r\n        System.out.println(&quot;Sequence &quot;+sequence1);\r\n        System.out.println(&quot;Subset &quot;+subset1);\r\n        System.out.println(results1);\r\n        System.out.println(&quot;results size = &quot; + results1.size());\r\n\r\n        System.out.println();\r\n\r\n        //Test 2\r\n        String[] sequenceArray2 = {&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;};\r\n        List&lt;String&gt; sequence2 = Arrays.asList(sequenceArray2);\r\n        int subset2= 2;  //subset\r\n        List&lt;String&gt; results2 =  permutation.permutate(EMPTY_STRING,\r\n                                        new ArrayList&lt;String&gt;(),\r\n                                        sequence2,\r\n                                        subset2);\r\n        \r\n        //Display Logic\r\n        System.out.println(&quot;Test 2&quot;);\r\n        System.out.println(&quot;Sequence &quot;+sequence2);\r\n        System.out.println(&quot;Subset &quot;+subset2);\r\n        System.out.println(results2);\r\n        System.out.println(&quot;results size = &quot; + results2.size());\r\n    }\r\n}\r\n```\r\n\r\n\r\n\r\n**Output:** \r\n\r\nTest 1 &lt;br&gt;\r\nSequence [1, 2, 3] &lt;br&gt;\r\nSubset 3 &lt;br&gt;\r\n[123] &lt;br&gt;\r\n[132] &lt;br&gt; \r\n[213] &lt;br&gt;\r\n[231] &lt;br&gt; \r\n[312] &lt;br&gt; \r\n[321] &lt;br&gt;\r\nresults size = 6 &lt;br&gt;\r\n\r\n&lt;br&gt;\r\n\r\nTest 2 &lt;br&gt;\r\nSequence [1, 2, 3, 4] &lt;br&gt;\r\nSubset 2 &lt;br&gt;\r\n[12] &lt;br&gt; \r\n[13] &lt;br&gt; \r\n[14] &lt;br&gt;\r\n[21] &lt;br&gt;\r\n[23] &lt;br&gt;\r\n[24] &lt;br&gt;\r\n[31] &lt;br&gt;\r\n[32] &lt;br&gt;\r\n[34] &lt;br&gt;\r\n[41] &lt;br&gt;\r\n[42] &lt;br&gt;\r\n[43] &lt;br&gt;\r\nresults size = 12 &lt;br&gt;\r\n\r\n","title":"Generating all possible permutations of a list recursively","body":"<p>Here is my solution to this permutation challenge, I use the DFS Algorithm to build a permutations tree, which I prune depending on the size of the required subset.</p>\n<pre><code>import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.List;\nimport java.util.stream.Collectors;\n\n    /**\n    * Permuation Application\n    * This class works out all permutations of a given set of elements\n    * \n    * @author arshadmayet\n    *\n    */\n    public class Permutation {\n    \n    public static final String EMPTY_STRING = &quot;&quot;;\n    \n    /**\n     * DFS Algorithm to find all permutaions on a sequence of elements\n     * \n     * @param pref        path of current element in permutation tree\n     * @param result      to store permutations\n     * @param sequence    list of elements to permutate\n     * @param subset      subset size, use size of sequence for the \n     *                    entire size per permutation.\n     * @return all permutations of the given sequence as a String List                    \n     */\n     public List&lt;String&gt; permutate(String pref, List&lt;String&gt; result, \n            List&lt;String&gt; sequence, int subset) {\n            \n        /*\n         * Get just the unvisited children for tree element\n         */\n        List&lt;String&gt; diff = sequence.stream().filter(x -&gt; ! \n                     (pref).contains(x)).collect(Collectors.toList());\n\n        /*\n         * No more children therefore reached end of branch store branch paths\n         */\n         int limit = sequence.size() - subset;\n         if(diff.size()==limit){\n            result.add(pref);\n         }\n\n        /*\n         * Loop thru each child\n         */\n         for (String s : diff) {\n            if(pref.length()&gt;subset) break; // to trim permuatation tree based on \n                                          // result sequence limit\n            permutate(pref + s, result,sequence,subset); // recursively traverse \n                                                       //tree\n        }\n        return result;\n    }\n\n    public static void main(String[] args) {\n    \n        Permutation permutation = new Permutation();\n        \n        // Test 1\n        String[] sequenceArray1 = { &quot;1&quot;, &quot;2&quot;, &quot;3&quot; };\n        List&lt;String&gt; sequence1 = Arrays.asList(sequenceArray1);\n        int subset1= sequence1.size();  //subset\n        List&lt;String&gt; results1 =  permutation.permutate(EMPTY_STRING,\n                                        new ArrayList&lt;String&gt;(),\n                                        sequence1,\n                                        subset1);\n        \n        //Display Logic\n        System.out.println(&quot;Test 1&quot;);\n        System.out.println(&quot;Sequence &quot;+sequence1);\n        System.out.println(&quot;Subset &quot;+subset1);\n        System.out.println(results1);\n        System.out.println(&quot;results size = &quot; + results1.size());\n\n        System.out.println();\n\n        //Test 2\n        String[] sequenceArray2 = {&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;};\n        List&lt;String&gt; sequence2 = Arrays.asList(sequenceArray2);\n        int subset2= 2;  //subset\n        List&lt;String&gt; results2 =  permutation.permutate(EMPTY_STRING,\n                                        new ArrayList&lt;String&gt;(),\n                                        sequence2,\n                                        subset2);\n        \n        //Display Logic\n        System.out.println(&quot;Test 2&quot;);\n        System.out.println(&quot;Sequence &quot;+sequence2);\n        System.out.println(&quot;Subset &quot;+subset2);\n        System.out.println(results2);\n        System.out.println(&quot;results size = &quot; + results2.size());\n    }\n}\n</code></pre>\n<p><strong>Output:</strong></p>\n<p>Test 1 <br>\nSequence [1, 2, 3] <br>\nSubset 3 <br>\n[123] <br>\n[132] <br>\n[213] <br>\n[231] <br>\n[312] <br>\n[321] <br>\nresults size = 6 <br></p>\n<br>\n<p>Test 2 <br>\nSequence [1, 2, 3, 4] <br>\nSubset 2 <br>\n[12] <br>\n[13] <br>\n[14] <br>\n[21] <br>\n[23] <br>\n[24] <br>\n[31] <br>\n[32] <br>\n[34] <br>\n[41] <br>\n[42] <br>\n[43] <br>\nresults size = 12 <br></p>\n"},{"tags":[],"owner":{"account_id":37614,"reputation":28196,"user_id":107591,"accept_rate":91,"display_name":"RobV"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700058353,"creation_date":1700057787,"answer_id":77488465,"question_id":10305153,"body_markdown":"[Apache Commons Collections][1] actually provides a [`PermutationIterator`][2] (since `4.0`) which can be used to solve this:\r\n\r\n```java\r\npublic static void main(String[] args) {\r\n    // Input list\r\n    List&lt;String&gt; list = Arrays.asList(&quot;&#120813;&quot;, &quot;&#120814;&quot;, &quot;&#120815;&quot;);\r\n\r\n    // Use the PermutationIterator\r\n    PermutationIterator&lt;String&gt; permutations = new PermutationIterator&lt;&gt;(list);\r\n    while (permutations.hasNext()) {\r\n      System.out.println(permutations.next());\r\n    }\r\n}\r\n```\r\n\r\n[1]: https://commons.apache.org/proper/commons-collections/\r\n[2]: https://commons.apache.org/proper/commons-collections/javadocs/api-4.4/org/apache/commons/collections4/iterators/PermutationIterator.html","title":"Generating all possible permutations of a list recursively","body":"<p><a href=\"https://commons.apache.org/proper/commons-collections/\" rel=\"nofollow noreferrer\">Apache Commons Collections</a> actually provides a <a href=\"https://commons.apache.org/proper/commons-collections/javadocs/api-4.4/org/apache/commons/collections4/iterators/PermutationIterator.html\" rel=\"nofollow noreferrer\"><code>PermutationIterator</code></a> (since <code>4.0</code>) which can be used to solve this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static void main(String[] args) {\n    // Input list\n    List&lt;String&gt; list = Arrays.asList(&quot;𝟭&quot;, &quot;𝟮&quot;, &quot;𝟯&quot;);\n\n    // Use the PermutationIterator\n    PermutationIterator&lt;String&gt; permutations = new PermutationIterator&lt;&gt;(list);\n    while (permutations.hasNext()) {\n      System.out.println(permutations.next());\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":798725,"reputation":14554,"user_id":872150,"accept_rate":93,"display_name":"varatis"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":47578,"favorite_count":0,"down_vote_count":2,"up_vote_count":19,"accepted_answer_id":10305419,"answer_count":8,"score":17,"last_activity_date":1700058353,"creation_date":1335297611,"question_id":10305153,"body_markdown":"I&#39;m trying to recursively generate all items in a list recursively. I&#39;ve seen a few solutions to similar questions to this, but I haven&#39;t been able to get my code to work. Could someone point out how I can fix my code?\r\n\r\nThis is open to all S/O&#39;ers, not just Java people.\r\n\r\n(Also I should note that it crashes with a SO exception).\r\n\r\n\r\nSample input:\r\n```\r\n[1, 2, 3]\r\n```\r\nOutput:\r\n```\r\n[1, 2, 3]\r\n[1, 3, 2]\r\n[2, 1, 3]\r\n[2, 3, 1]\r\n[3, 1, 2]\r\n[3, 2, 1]\r\n```\r\n\r\n```java\r\n//allPossibleItems is an AL of all items \r\n\r\n//this is called with generatePerm(null, new ArrayList&lt;Item&gt;);\r\n\r\nprivate void generatePerm(Item i, ArrayList&lt;Item&gt; a) {\r\n    if (i != null) { a.add(i); }\r\n    if (a.size() == DESIRED_SIZE) {\r\n        permutations.add(a);\r\n        return;\r\n    }\r\n    for (int j = 0; j &lt; allPossibleItems.size(); j++) {\r\n        if (allPossibleItems.get(j) != i)\r\n            generatePerm(allPossibleItems.get(j), a);\r\n    }\r\n}\r\n```\r\n","title":"Generating all possible permutations of a list recursively","body":"<p>I'm trying to recursively generate all items in a list recursively. I've seen a few solutions to similar questions to this, but I haven't been able to get my code to work. Could someone point out how I can fix my code?</p>\n<p>This is open to all S/O'ers, not just Java people.</p>\n<p>(Also I should note that it crashes with a SO exception).</p>\n<p>Sample input:</p>\n<pre><code>[1, 2, 3]\n</code></pre>\n<p>Output:</p>\n<pre><code>[1, 2, 3]\n[1, 3, 2]\n[2, 1, 3]\n[2, 3, 1]\n[3, 1, 2]\n[3, 2, 1]\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>//allPossibleItems is an AL of all items \n\n//this is called with generatePerm(null, new ArrayList&lt;Item&gt;);\n\nprivate void generatePerm(Item i, ArrayList&lt;Item&gt; a) {\n    if (i != null) { a.add(i); }\n    if (a.size() == DESIRED_SIZE) {\n        permutations.add(a);\n        return;\n    }\n    for (int j = 0; j &lt; allPossibleItems.size(); j++) {\n        if (allPossibleItems.get(j) != i)\n            generatePerm(allPossibleItems.get(j), a);\n    }\n}\n</code></pre>\n"},{"tags":["java","android","firebase-realtime-database","bar-chart"],"comments":[{"owner":{"account_id":6819231,"reputation":132861,"user_id":5246885,"accept_rate":78,"display_name":"Alex Mamo"},"score":1,"creation_date":1700050148,"post_id":77487559,"comment_id":136606634,"body_markdown":"First of all, stop ignoring errors. At a minimum, please add `Log.d(TAG, error.getMessage());`. Do you get something printed out in the logcat?","body":"First of all, stop ignoring errors. At a minimum, please add <code>Log.d(TAG, error.getMessage());</code>. Do you get something printed out in the logcat?"},{"owner":{"account_id":72426,"reputation":573804,"user_id":209103,"accept_rate":73,"display_name":"Frank van Puffelen"},"score":0,"creation_date":1700058299,"post_id":77487559,"comment_id":136608186,"body_markdown":"Aside from what Alex said, you will need to move the code that builds the chart *into* the `onDataChange` to ensure it runs *after* the data has been loaded. For more on this see https://stackoverflow.com/questions/50434836/getcontactsfromfirebase-method-return-an-empty-list/50435519#50435519 and https://stackoverflow.com/questions/33203379/setting-singleton-property-value-in-firebase-listener","body":"Aside from what Alex said, you will need to move the code that builds the chart <i>into</i> the <code>onDataChange</code> to ensure it runs <i>after</i> the data has been loaded. For more on this see <a href=\"https://stackoverflow.com/questions/50434836/getcontactsfromfirebase-method-return-an-empty-list/50435519#50435519\" title=\"getcontactsfromfirebase method return an empty list\">stackoverflow.com/questions/50434836/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/33203379/setting-singleton-property-value-in-firebase-listener\" title=\"setting singleton property value in firebase listener\">stackoverflow.com/questions/33203379/&hellip;</a>"}],"owner":{"account_id":29785481,"reputation":1,"user_id":22826935,"display_name":"Nouf "},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":14,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1700058308,"answer_count":0,"score":0,"last_activity_date":1700058319,"creation_date":1700049904,"question_id":77487559,"body_markdown":"This is data in firebase:\r\n\r\n![enter image description here](https://i.stack.imgur.com/mleyl.png)\r\n\r\nand in java the code does not draw column in the chart to represent hour and num of parking.\r\n```\r\nprivate void getDataDAY() {\r\n//       we make for loop to matching\r\n\r\n        ArrayList&lt;String&gt; X_realTime = new ArrayList&lt;&gt;();\r\n        ArrayList&lt;Integer&gt; x = new ArrayList&lt;&gt;();\r\n        ArrayList&lt;Integer&gt; y = new ArrayList&lt;&gt;();\r\n        ArrayList&lt;String&gt; y_realTime = new ArrayList&lt;&gt;();\r\n//        barlistX = new ArrayList&lt;&gt;();\r\n//        axis = barChart.getXAxis();\r\n\r\n        databaseReference1.child(&quot;AStatistics&quot;).addListenerForSingleValueEvent(new ValueEventListener() {\r\n\r\n            @RequiresApi(api = Build.VERSION_CODES.N)\r\n            @Override\r\n            public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                //check if username is exist OR not in database\r\n                final String NameDay = snapshot.child(&quot;Day&quot;).child(&quot;NameDay&quot;).getValue(String.class);\r\n                final String hour = snapshot.child(&quot;Day&quot;).child(&quot;hour&quot;).getValue().toString();\r\n                X_realTime.add(hour);\r\n                final String NumOfParking = snapshot.child(&quot;Day&quot;).child(&quot;Num Parkinglot&quot;).getValue().toString();\r\n                y_realTime.add(NumOfParking);\r\n                //switch case each hour\r\n\r\n                if (X_realTime.get(count).equals(&quot;7&quot;)) {\r\n                    x.add(1);\r\n                } else {\r\n                    if (X_realTime.get(count).equals(&quot;8&quot;)) {\r\n                        x.add(2);\r\n                    } else {\r\n                        if (X_realTime.get(count).equals(&quot;9&quot;)) {\r\n                            x.add(3);\r\n                        } else {\r\n                            if (X_realTime.get(count).equals(&quot;10&quot;)) {\r\n                                x.add(4);\r\n                            } else {\r\n                                if (X_realTime.get(count).equals(&quot;11&quot;)) {\r\n                                    x.add(5);\r\n                                } else {\r\n                                    if (X_realTime.get(count).equals(&quot;12&quot;)) {\r\n                                        x.add(6);\r\n                                    } else {\r\n                                        x.add(7);\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                        }\r\n\r\n                    }\r\n                }\r\n\r\n                //for y\r\n\r\n\r\n                if (y_realTime.get(count).equals(&quot;1&quot;)) {\r\n                    y.add(1);\r\n                } else {\r\n                    if (y_realTime.get(count).equals(&quot;2&quot;)) {\r\n                        y.add(2);\r\n                    }\r\n                }\r\n                count++;\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n            }\r\n\r\n        });\r\n\r\n        barlistX = new ArrayList&lt;&gt;();\r\n//      enter graph x-&gt; number of parking\r\n\r\n//   to format in general shape in X\r\n        axis = barChart.getXAxis();\r\n\r\n\r\n        for (int i = 0; i &lt; x.size(); ++i) {\r\n            barlistX.add(new BarEntry(x.get(i), y.get(i)));\r\n        }\r\n        axis.setValueFormatter(new IndexAxisValueFormatter(times));\r\n\r\n\r\n        axis.setPosition(XAxis.XAxisPosition.BOTTOM);\r\n        axis.setGranularity(1);\r\n        Description XAxisDescription = new Description();\r\n        XAxisDescription.setText(DayName);\r\n        barChart.setDescription(XAxisDescription);\r\n        axis.setGranularityEnabled(true);\r\n\r\n    }\r\n}\r\n```\r\nI want to draw the column in bar chart ","title":"Retrive data from firebase and draw barchart in android studio MPAndroidChart","body":"<p>This is data in firebase:</p>\n<p><img src=\"https://i.stack.imgur.com/mleyl.png\" alt=\"enter image description here\" /></p>\n<p>and in java the code does not draw column in the chart to represent hour and num of parking.</p>\n<pre><code>private void getDataDAY() {\n//       we make for loop to matching\n\n        ArrayList&lt;String&gt; X_realTime = new ArrayList&lt;&gt;();\n        ArrayList&lt;Integer&gt; x = new ArrayList&lt;&gt;();\n        ArrayList&lt;Integer&gt; y = new ArrayList&lt;&gt;();\n        ArrayList&lt;String&gt; y_realTime = new ArrayList&lt;&gt;();\n//        barlistX = new ArrayList&lt;&gt;();\n//        axis = barChart.getXAxis();\n\n        databaseReference1.child(&quot;AStatistics&quot;).addListenerForSingleValueEvent(new ValueEventListener() {\n\n            @RequiresApi(api = Build.VERSION_CODES.N)\n            @Override\n            public void onDataChange(@NonNull DataSnapshot snapshot) {\n                //check if username is exist OR not in database\n                final String NameDay = snapshot.child(&quot;Day&quot;).child(&quot;NameDay&quot;).getValue(String.class);\n                final String hour = snapshot.child(&quot;Day&quot;).child(&quot;hour&quot;).getValue().toString();\n                X_realTime.add(hour);\n                final String NumOfParking = snapshot.child(&quot;Day&quot;).child(&quot;Num Parkinglot&quot;).getValue().toString();\n                y_realTime.add(NumOfParking);\n                //switch case each hour\n\n                if (X_realTime.get(count).equals(&quot;7&quot;)) {\n                    x.add(1);\n                } else {\n                    if (X_realTime.get(count).equals(&quot;8&quot;)) {\n                        x.add(2);\n                    } else {\n                        if (X_realTime.get(count).equals(&quot;9&quot;)) {\n                            x.add(3);\n                        } else {\n                            if (X_realTime.get(count).equals(&quot;10&quot;)) {\n                                x.add(4);\n                            } else {\n                                if (X_realTime.get(count).equals(&quot;11&quot;)) {\n                                    x.add(5);\n                                } else {\n                                    if (X_realTime.get(count).equals(&quot;12&quot;)) {\n                                        x.add(6);\n                                    } else {\n                                        x.add(7);\n                                    }\n                                }\n                            }\n\n                        }\n\n                    }\n                }\n\n                //for y\n\n\n                if (y_realTime.get(count).equals(&quot;1&quot;)) {\n                    y.add(1);\n                } else {\n                    if (y_realTime.get(count).equals(&quot;2&quot;)) {\n                        y.add(2);\n                    }\n                }\n                count++;\n\n            }\n\n            @Override\n            public void onCancelled(@NonNull DatabaseError error) {\n\n            }\n\n        });\n\n        barlistX = new ArrayList&lt;&gt;();\n//      enter graph x-&gt; number of parking\n\n//   to format in general shape in X\n        axis = barChart.getXAxis();\n\n\n        for (int i = 0; i &lt; x.size(); ++i) {\n            barlistX.add(new BarEntry(x.get(i), y.get(i)));\n        }\n        axis.setValueFormatter(new IndexAxisValueFormatter(times));\n\n\n        axis.setPosition(XAxis.XAxisPosition.BOTTOM);\n        axis.setGranularity(1);\n        Description XAxisDescription = new Description();\n        XAxisDescription.setText(DayName);\n        barChart.setDescription(XAxisDescription);\n        axis.setGranularityEnabled(true);\n\n    }\n}\n</code></pre>\n<p>I want to draw the column in bar chart</p>\n"},{"tags":["python","java","sql-server","apache-spark","sqlconnection"],"comments":[{"owner":{"account_id":17972905,"reputation":5290,"user_id":13061224,"display_name":"siggemannen"},"score":0,"creation_date":1700059061,"post_id":77488306,"comment_id":136608369,"body_markdown":"`host None, port 1433 has failed` in the error message seems to point to the problem, your os.getenv(&quot;DB_SERVER&quot;) doesn&#39;t exist.","body":"<code>host None, port 1433 has failed</code> in the error message seems to point to the problem, your os.getenv(&quot;DB_SERVER&quot;) doesn&#39;t exist."},{"owner":{"account_id":24331254,"reputation":7,"user_id":18270066,"display_name":"Richard Kadey"},"score":0,"creation_date":1700059742,"post_id":77488306,"comment_id":136608526,"body_markdown":"@siggemannen I am using windows authentication and not sql server so no need to bring password and username. The Server name are correct and exist in a .env file.","body":"@siggemannen I am using windows authentication and not sql server so no need to bring password and username. The Server name are correct and exist in a .env file."},{"owner":{"account_id":17972905,"reputation":5290,"user_id":13061224,"display_name":"siggemannen"},"score":0,"creation_date":1700060135,"post_id":77488306,"comment_id":136608610,"body_markdown":"the problem seems to be in the hostname. what does: `print(jdbc_url)` prints? is that string a valid jdbc url","body":"the problem seems to be in the hostname. what does: <code>print(jdbc_url)</code> prints? is that string a valid jdbc url"},{"owner":{"account_id":24331254,"reputation":7,"user_id":18270066,"display_name":"Richard Kadey"},"score":0,"creation_date":1700062014,"post_id":77488306,"comment_id":136608969,"body_markdown":"So unknowingly it was None. I corrected it and I get `Py4JJavaError: An error occurred while calling o94.jdbc.\n: com.microsoft.sqlserver.jdbc.SQLServerException: This driver is not configured for integrated authentication. ClientConnectionId:84229433-a615-4f2d-8543-c410f3e46`.\n Thanks though @siggemannen","body":"So unknowingly it was None. I corrected it and I get <code>Py4JJavaError: An error occurred while calling o94.jdbc. : com.microsoft.sqlserver.jdbc.SQLServerException: This driver is not configured for integrated authentication. ClientConnectionId:84229433-a615-4f2d-8543-c410f3e46</code>.  Thanks though @siggemannen"},{"owner":{"account_id":17972905,"reputation":5290,"user_id":13061224,"display_name":"siggemannen"},"score":0,"creation_date":1700062111,"post_id":77488306,"comment_id":136608992,"body_markdown":"that error means you need to download the additional windows auth dll corresponding to the jdbc driver version. it&#39;s probably in maven if you look for it","body":"that error means you need to download the additional windows auth dll corresponding to the jdbc driver version. it&#39;s probably in maven if you look for it"},{"owner":{"account_id":24331254,"reputation":7,"user_id":18270066,"display_name":"Richard Kadey"},"score":0,"creation_date":1700128292,"post_id":77488306,"comment_id":136617470,"body_markdown":"Great! @siggemannen. I spent the whole of yesterday on this. I have downloaded the mssql-jdbc_auth-12.4.2.x64.dll and copied it to the c:\\windows\\systems32 and C:\\Program Files\\Java\\jdk-21\\bin folder but I still get the same error. Please any help?","body":"Great! @siggemannen. I spent the whole of yesterday on this. I have downloaded the mssql-jdbc_auth-12.4.2.x64.dll and copied it to the c:\\windows\\systems32 and C:\\Program Files\\Java\\jdk-21\\bin folder but I still get the same error. Please any help?"},{"owner":{"account_id":17972905,"reputation":5290,"user_id":13061224,"display_name":"siggemannen"},"score":0,"creation_date":1700129147,"post_id":77488306,"comment_id":136617648,"body_markdown":"i think it&#39;s supposed to go to the same folder your ms driver jar is in. But i&#39;m not sure, i have only used the &quot;real&quot; jdbc, not this python wrapper. Note that the version of the dll must exactly match the jar version!","body":"i think it&#39;s supposed to go to the same folder your ms driver jar is in. But i&#39;m not sure, i have only used the &quot;real&quot; jdbc, not this python wrapper. Note that the version of the dll must exactly match the jar version!"},{"owner":{"account_id":17972905,"reputation":5290,"user_id":13061224,"display_name":"siggemannen"},"score":0,"creation_date":1700129300,"post_id":77488306,"comment_id":136617674,"body_markdown":"You can read more here: https://stackoverflow.com/questions/57606298/using-windows-authentication-for-sql-server-jdbc-with-pyspark","body":"You can read more here: <a href=\"https://stackoverflow.com/questions/57606298/using-windows-authentication-for-sql-server-jdbc-with-pyspark\" title=\"using windows authentication for sql server jdbc with pyspark\">stackoverflow.com/questions/57606298/&hellip;</a>"},{"owner":{"account_id":24331254,"reputation":7,"user_id":18270066,"display_name":"Richard Kadey"},"score":0,"creation_date":1700133439,"post_id":77488306,"comment_id":136618437,"body_markdown":"Great! it works now. I followed the instructions in [link](https://stackoverflow.com/questions/57606298/using-windows-authentication-for-sql-server-jdbc-with-pyspark) and it works. Thank you very much @siggemannen","body":"Great! it works now. I followed the instructions in <a href=\"https://stackoverflow.com/questions/57606298/using-windows-authentication-for-sql-server-jdbc-with-pyspark\">link</a> and it works. Thank you very much @siggemannen"},{"owner":{"account_id":17972905,"reputation":5290,"user_id":13061224,"display_name":"siggemannen"},"score":0,"creation_date":1700137445,"post_id":77488306,"comment_id":136619102,"body_markdown":"Great to hear, good luck with your project!","body":"Great to hear, good luck with your project!"}],"owner":{"account_id":24331254,"reputation":7,"user_id":18270066,"display_name":"Richard Kadey"},"comment_count":10,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":49,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"closed_date":1700133466,"answer_count":0,"score":-1,"last_activity_date":1700058270,"creation_date":1700056595,"question_id":77488306,"body_markdown":"I have data in sql warehouse about 90 million rows. I want to connect pyspark to it and analyze in jupyter notebook. but I get an error.\r\n\r\nThis is my code.\r\n\r\n    server_name = os.getenv(&quot;DB_SERVER&quot;)\r\n    database_name = os.getenv(&quot;DB_DATABASE&quot;)\r\n    username = os.getenv(&quot;DB_USERNAME&quot;)\r\n    password = os.getenv(&quot;DB_PASSWORD&quot;)\r\n\r\n\r\n    spark = SparkSession.builder\\\r\n       .appName(&quot;voda_loan&quot;)\\\r\n       .getOrCreate()\r\n\r\n    jdbc_url = f&quot;jdbc:sqlserver://{server_name};databaseName={database_name}&quot;\r\n\r\n    connection_properties = {\r\n    &quot;driver&quot;: &quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;\r\n    }\r\n\r\n    df = spark.read.jdbc(jdbc_url, &quot;Ready_Cash_Disbursed_trial&quot;, \r\n            properties=connection_properties)\r\n    df.show(30)\r\n\r\n\r\nAnd this is the error message I am getting.\r\n\r\n    ---------------------------------------------------------------------------\r\n    Py4JJavaError                             Traceback (most recent call last)\r\n    Cell In[16], line 18\r\n     12 jdbc_url = f&quot;jdbc:sqlserver://{server_name};databaseName={database_name}&quot;\r\n     14 connection_properties = {\r\n     15     &quot;driver&quot;: &quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;\r\n     16 }\r\n    ---&gt; 18 df = spark.read.jdbc(jdbc_url, &quot;Ready_Cash_Disbursed_trial&quot;, \r\n     properties=connection_properties)\r\n     19 df.show(30)\r\n\r\nAnd this is the output message.\r\n\r\n    Py4JJavaError: An error occurred while calling o68.jdbc.\r\n    : com.microsoft.sqlserver.jdbc.SQLServerException: The TCP/IP connection \r\n    to the host None, port 1433 has failed. Error: &quot;No such host is known \r\n    (None). Verify the connection properties. Make sure that an instance of \r\n    SQL Server is running on the host and accepting TCP/IP connections at \r\n    the port. Make sure that TCP connections to the port are not blocked by \r\n    a firewall.&quot;.","title":"I have an error connecting pyspark to mssql","body":"<p>I have data in sql warehouse about 90 million rows. I want to connect pyspark to it and analyze in jupyter notebook. but I get an error.</p>\n<p>This is my code.</p>\n<pre><code>server_name = os.getenv(&quot;DB_SERVER&quot;)\ndatabase_name = os.getenv(&quot;DB_DATABASE&quot;)\nusername = os.getenv(&quot;DB_USERNAME&quot;)\npassword = os.getenv(&quot;DB_PASSWORD&quot;)\n\n\nspark = SparkSession.builder\\\n   .appName(&quot;voda_loan&quot;)\\\n   .getOrCreate()\n\njdbc_url = f&quot;jdbc:sqlserver://{server_name};databaseName={database_name}&quot;\n\nconnection_properties = {\n&quot;driver&quot;: &quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;\n}\n\ndf = spark.read.jdbc(jdbc_url, &quot;Ready_Cash_Disbursed_trial&quot;, \n        properties=connection_properties)\ndf.show(30)\n</code></pre>\n<p>And this is the error message I am getting.</p>\n<pre><code>---------------------------------------------------------------------------\nPy4JJavaError                             Traceback (most recent call last)\nCell In[16], line 18\n 12 jdbc_url = f&quot;jdbc:sqlserver://{server_name};databaseName={database_name}&quot;\n 14 connection_properties = {\n 15     &quot;driver&quot;: &quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;\n 16 }\n---&gt; 18 df = spark.read.jdbc(jdbc_url, &quot;Ready_Cash_Disbursed_trial&quot;, \n properties=connection_properties)\n 19 df.show(30)\n</code></pre>\n<p>And this is the output message.</p>\n<pre><code>Py4JJavaError: An error occurred while calling o68.jdbc.\n: com.microsoft.sqlserver.jdbc.SQLServerException: The TCP/IP connection \nto the host None, port 1433 has failed. Error: &quot;No such host is known \n(None). Verify the connection properties. Make sure that an instance of \nSQL Server is running on the host and accepting TCP/IP connections at \nthe port. Make sure that TCP connections to the port are not blocked by \na firewall.&quot;.\n</code></pre>\n"},{"tags":["java","android","gradle"],"answers":[{"tags":[],"owner":{"account_id":29902941,"reputation":1,"user_id":22916226,"display_name":"Laurence"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700058236,"creation_date":1700058236,"answer_id":77488521,"question_id":77483397,"body_markdown":"SOLUTION:\r\n*I was able to fix this by altering my Java version to 11 and using AGP Android upgrade assistant\r\nusing these dependencies:\r\n```\r\n    dependencies {\r\n        classpath(&quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.6.21&quot;)\r\n        // https://mvnrepository.com/artifact/com.android.tools.build/gradle\r\n        classpath(&quot;com.android.tools.build:gradle:8.1.0&quot;)\r\n\r\n    }\r\n```\r\n\r\nThese plugin versions:\r\n![image_2023-11-15_141744055|592x170](upload://wNLNu64ObSCPR6IGILgLZhQ9s4X.png)\r\n\r\n\r\nand this in gradle-wrapper.properties:\r\n`distributionUrl=https\\://services.gradle.org/distributions/gradle-8.4-bin.zip`\r\n\r\nThen I went to Tools &gt; AGP Upgrade Assistant and pressed run, then it sorted itself out!\r\n[Docs for this tool](https://developer.android.com/build/releases/gradle-plugin)\r\nSo take my versions with a pinch of salt.\r\n\r\n*\r\n","title":"SOLVED Could not create task &#39;:app:compileDebugKotlin&#39;","body":"<p>SOLUTION:\n*I was able to fix this by altering my Java version to 11 and using AGP Android upgrade assistant\nusing these dependencies:</p>\n<pre><code>    dependencies {\n        classpath(&quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.6.21&quot;)\n        // https://mvnrepository.com/artifact/com.android.tools.build/gradle\n        classpath(&quot;com.android.tools.build:gradle:8.1.0&quot;)\n\n    }\n</code></pre>\n<p>These plugin versions:\n</p>\n<p>and this in gradle-wrapper.properties:\n<code>distributionUrl=https\\://services.gradle.org/distributions/gradle-8.4-bin.zip</code></p>\n<p>Then I went to Tools &gt; AGP Upgrade Assistant and pressed run, then it sorted itself out!\n<a href=\"https://developer.android.com/build/releases/gradle-plugin\" rel=\"nofollow noreferrer\">Docs for this tool</a>\nSo take my versions with a pinch of salt.</p>\n<p>*</p>\n"}],"owner":{"account_id":29902941,"reputation":1,"user_id":22916226,"display_name":"Laurence"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":108,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1700058236,"creation_date":1699990831,"question_id":77483397,"body_markdown":"I have been developing an android app using Kotlin in Android studio.\r\n\r\nHere is my error when trying to sync gradle files:\r\n\r\n```\r\nA build operation failed.\r\n    Could not create task &#39;:app:compileDebugKotlin&#39;.\r\nCould not create task &#39;:app:compileDebugKotlin&#39;.\r\nCannot use @TaskAction annotation on method AbstractKotlinCompile.execute() because interface org.gradle.api.tasks.incremental.IncrementalTaskInputs is not a valid parameter to an action method.\r\n\r\n```\r\n\r\n`./gradlew build --stacktrace &gt; logs.txt 2&gt;logErrors.txt`\r\n\r\nLog errors:\r\n\r\n\r\n**[https://pastebin.com/SjQDgVex]**\r\n\r\n\r\n**app/build.gradle.kts**\r\n\r\n\r\n```\r\nplugins {\r\n    id(&quot;com.android.application&quot;)\r\n    id(&quot;org.jetbrains.kotlin.android&quot;)\r\n}\r\n\r\nandroid {\r\n    namespace = &quot;com.example.wherehouse&quot;\r\n    compileSdk = 33\r\n\r\n    defaultConfig {\r\n        applicationId = &quot;com.example.wherehouse&quot;\r\n        minSdk = 24\r\n        targetSdk = 33\r\n        versionCode = 1\r\n        versionName = &quot;1.0&quot;\r\n\r\n        testInstrumentationRunner = &quot;androidx.test.runner.AndroidJUnitRunner&quot;\r\n    }\r\n\r\n    buildTypes {\r\n        getByName(&quot;release&quot;) {\r\n            isMinifyEnabled = false\r\n            proguardFiles(\r\n                getDefaultProguardFile(&quot;proguard-android-optimize.txt&quot;),\r\n                &quot;proguard-rules.pro&quot;\r\n            )\r\n        }\r\n    }\r\n\r\n    compileOptions {\r\n        sourceCompatibility = JavaVersion.VERSION_1_8\r\n        targetCompatibility = JavaVersion.VERSION_1_8\r\n    }\r\n\r\n    kotlinOptions {\r\n        jvmTarget = &quot;11&quot;\r\n    }\r\n}\r\n\r\ndependencies {\r\n    implementation(&quot;androidx.core:core-ktx:1.9.0&quot;)\r\n    implementation(&quot;androidx.appcompat:appcompat:1.6.1&quot;)\r\n    implementation(&quot;com.google.android.material:material:1.9.0&quot;)\r\n    implementation(&quot;androidx.constraintlayout:constraintlayout:2.1.4&quot;)\r\n    implementation(&quot;com.journeyapps:zxing-android-embedded:4.2.0&quot;)\r\n    implementation(&quot;com.squareup.retrofit2:retrofit:2.9.0&quot;)\r\n    implementation(&quot;com.squareup.retrofit2:converter-gson:2.9.0&quot;)\r\n    implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib:1.5.21&quot;)\r\n}\r\n\r\n```\r\n\r\n**root/build.gradle.kts**\r\n\r\nA Top-level build file where you can add configuration options common to all sub-projects/modules.\r\n```\r\nbuildscript {\r\n    val agp_version by extra(&quot;7.4.2&quot;)\r\n    val agp_version1 by extra(&quot;8.0.0&quot;)\r\n    val agp_version2 by extra(&quot;8.1.3&quot;)\r\n    val agp_version3 by extra(agp_version2)\r\n\r\n    repositories {\r\n        google()\r\n        jcenter()\r\n    }\r\n    dependencies {\r\n        classpath(&quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.5.21&quot;)\r\n        classpath(&quot;com.android.tools.build:gradle:$agp_version2&quot;)\r\n    }\r\n}\r\n\r\n```\r\n\r\n\r\n[Gradle plugin version and Gradle version](https://i.stack.imgur.com/gJPAD.png)\r\n\r\n\r\n\r\nAttempted solutions:\r\ninvalidating caches, restarting, project rebuilding etc..\r\n\r\nUpdating gradle version, downgrading gradle version\r\nupdating java jdk, downgrading java jdk\r\n\r\naltering compileOptions do different java versions.\r\n\r\nI end up in a circle, coming back to the same problem after trying to fix new ones.\r\n\r\n","title":"SOLVED Could not create task &#39;:app:compileDebugKotlin&#39;","body":"<p>I have been developing an android app using Kotlin in Android studio.</p>\n<p>Here is my error when trying to sync gradle files:</p>\n<pre><code>A build operation failed.\n    Could not create task ':app:compileDebugKotlin'.\nCould not create task ':app:compileDebugKotlin'.\nCannot use @TaskAction annotation on method AbstractKotlinCompile.execute() because interface org.gradle.api.tasks.incremental.IncrementalTaskInputs is not a valid parameter to an action method.\n\n</code></pre>\n<p><code>./gradlew build --stacktrace &gt; logs.txt 2&gt;logErrors.txt</code></p>\n<p>Log errors:</p>\n<p><strong>[https://pastebin.com/SjQDgVex]</strong></p>\n<p><strong>app/build.gradle.kts</strong></p>\n<pre><code>plugins {\n    id(&quot;com.android.application&quot;)\n    id(&quot;org.jetbrains.kotlin.android&quot;)\n}\n\nandroid {\n    namespace = &quot;com.example.wherehouse&quot;\n    compileSdk = 33\n\n    defaultConfig {\n        applicationId = &quot;com.example.wherehouse&quot;\n        minSdk = 24\n        targetSdk = 33\n        versionCode = 1\n        versionName = &quot;1.0&quot;\n\n        testInstrumentationRunner = &quot;androidx.test.runner.AndroidJUnitRunner&quot;\n    }\n\n    buildTypes {\n        getByName(&quot;release&quot;) {\n            isMinifyEnabled = false\n            proguardFiles(\n                getDefaultProguardFile(&quot;proguard-android-optimize.txt&quot;),\n                &quot;proguard-rules.pro&quot;\n            )\n        }\n    }\n\n    compileOptions {\n        sourceCompatibility = JavaVersion.VERSION_1_8\n        targetCompatibility = JavaVersion.VERSION_1_8\n    }\n\n    kotlinOptions {\n        jvmTarget = &quot;11&quot;\n    }\n}\n\ndependencies {\n    implementation(&quot;androidx.core:core-ktx:1.9.0&quot;)\n    implementation(&quot;androidx.appcompat:appcompat:1.6.1&quot;)\n    implementation(&quot;com.google.android.material:material:1.9.0&quot;)\n    implementation(&quot;androidx.constraintlayout:constraintlayout:2.1.4&quot;)\n    implementation(&quot;com.journeyapps:zxing-android-embedded:4.2.0&quot;)\n    implementation(&quot;com.squareup.retrofit2:retrofit:2.9.0&quot;)\n    implementation(&quot;com.squareup.retrofit2:converter-gson:2.9.0&quot;)\n    implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib:1.5.21&quot;)\n}\n\n</code></pre>\n<p><strong>root/build.gradle.kts</strong></p>\n<p>A Top-level build file where you can add configuration options common to all sub-projects/modules.</p>\n<pre><code>buildscript {\n    val agp_version by extra(&quot;7.4.2&quot;)\n    val agp_version1 by extra(&quot;8.0.0&quot;)\n    val agp_version2 by extra(&quot;8.1.3&quot;)\n    val agp_version3 by extra(agp_version2)\n\n    repositories {\n        google()\n        jcenter()\n    }\n    dependencies {\n        classpath(&quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.5.21&quot;)\n        classpath(&quot;com.android.tools.build:gradle:$agp_version2&quot;)\n    }\n}\n\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/gJPAD.png\" rel=\"nofollow noreferrer\">Gradle plugin version and Gradle version</a></p>\n<p>Attempted solutions:\ninvalidating caches, restarting, project rebuilding etc..</p>\n<p>Updating gradle version, downgrading gradle version\nupdating java jdk, downgrading java jdk</p>\n<p>altering compileOptions do different java versions.</p>\n<p>I end up in a circle, coming back to the same problem after trying to fix new ones.</p>\n"},{"tags":["java","arrays","json","spring","json-patch"],"comments":[{"owner":{"account_id":4663157,"reputation":15229,"user_id":3776927,"display_name":"derpirscher"},"score":0,"creation_date":1700060496,"post_id":77487735,"comment_id":136608673,"body_markdown":"For your first problem: Any comparison can only point out the differences. How you deal with those differences is up to you. If something was modified or replaced with something new is a semantic issue that cannot be decided automatically.","body":"For your first problem: Any comparison can only point out the differences. How you deal with those differences is up to you. If something was modified or replaced with something new is a semantic issue that cannot be decided automatically."},{"owner":{"account_id":4277335,"reputation":554,"user_id":3497657,"accept_rate":30,"display_name":"Subhomoy Sikdar"},"score":0,"creation_date":1700064635,"post_id":77487735,"comment_id":136609506,"body_markdown":"@derpirscher I agree with you. If the differences are on any field other than the `id` it means the object was modified but if the `id` changes it would mean a new object is created with the fields and the old one is removed. This is a deeply nested json which represents a java class with a large number of nested references and object creation/removal would have its own flows. I am trying to figure out what would be a good approach to handle this problem","body":"@derpirscher I agree with you. If the differences are on any field other than the <code>id</code> it means the object was modified but if the <code>id</code> changes it would mean a new object is created with the fields and the old one is removed. This is a deeply nested json which represents a java class with a large number of nested references and object creation/removal would have its own flows. I am trying to figure out what would be a good approach to handle this problem"},{"owner":{"account_id":9235242,"reputation":1488,"user_id":6860078,"display_name":"tbatch"},"score":0,"creation_date":1700149727,"post_id":77487735,"comment_id":136621601,"body_markdown":"What you are asking for can&#39;t be done via String comparison. As you said, order matters here.  For instance, consider a diff tool.  Any diff tool, such as Beyond Compare, will only compare each line of a string with its corresponding line of a different string (with some capabilities to determine new lines).  If you want to determine the difference in these deeply nested structures, you will need to deserialize the json into an object and compare the resulting object fields.","body":"What you are asking for can&#39;t be done via String comparison. As you said, order matters here.  For instance, consider a diff tool.  Any diff tool, such as Beyond Compare, will only compare each line of a string with its corresponding line of a different string (with some capabilities to determine new lines).  If you want to determine the difference in these deeply nested structures, you will need to deserialize the json into an object and compare the resulting object fields."}],"owner":{"account_id":4277335,"reputation":554,"user_id":3497657,"accept_rate":30,"display_name":"Subhomoy Sikdar"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":54,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1700058091,"creation_date":1700051520,"question_id":77487735,"body_markdown":"I have a usecase where I want to figure out how a json was modified. I have to compare 2 json objects, one before it was modifed and one object representing the state after modfication. The json have many nested objects and arrays in it. \r\nThe json comparison can be done through [RFC 6902][1] and [RFC 7396][2] which has standard implementations.\r\n\r\nThe JSON is actually a Java object which has many properties and references to other objects. This causes 2 problems. If the reference id of any child object is updated it would mean the whole object has been replaced rather than just the id field. The other is ordering of objects in collections. I would try to explain the 2 scenarios:\r\n\r\nLets say the `id` of a child object (car in this case) is modified like below\r\n```\r\n// initial state\r\n{\r\n  &quot;employee&quot;: {\r\n    &quot;id&quot;: 1,\r\n    &quot;car&quot;: {\r\n      &quot;id&quot;: 11,\r\n      &quot;field1&quot;: &quot;foo&quot;\r\n    }\r\n  }\r\n}\r\n// modified state\r\n{\r\n  &quot;employee&quot;: {\r\n    &quot;id&quot;: 1,\r\n    &quot;car&quot;: {\r\n      &quot;id&quot;: 12,\r\n      &quot;field1&quot;: &quot;foo&quot;\r\n    }\r\n  }\r\n}\r\n```\r\nThen the JSON patch would return \r\n`{&quot;employee&quot;:{&quot;car&quot;:{&quot;id&quot;:12}}}`\r\nor\r\n`[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/employee/car/id&quot;,&quot;value&quot;:12}]`\r\nindicating the `id` was updated. But in my usecase it would mean the existing child object `car` with id 11 was removed and a new object car with id 12 was placed in its place.\r\n\r\nThe second problem is in case of collections, the order should not matter. So, the below 2 json comparison would return that the object was not modified.\r\n```\r\n{\r\n  &quot;employee&quot;: {\r\n    &quot;id&quot;: 1,\r\n    &quot;cars&quot;: [\r\n      {\r\n        &quot;id&quot;: 11,\r\n        &quot;field1&quot;: &quot;foo&quot;\r\n      },\r\n      {\r\n        &quot;id&quot;: 12,\r\n        &quot;field1&quot;: &quot;bar&quot;\r\n      }\r\n    ]\r\n  }\r\n}\r\n// modified json\r\n{\r\n  &quot;employee&quot;: {\r\n    &quot;id&quot;: 1,\r\n    &quot;cars&quot;: [\r\n      {\r\n        &quot;id&quot;: 12,\r\n        &quot;field1&quot;: &quot;bar&quot;\r\n      },\r\n      {\r\n        &quot;id&quot;: 11,\r\n        &quot;field1&quot;: &quot;foo&quot;\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\nBut according to the RFC&#39;s the order of the collection matter and changing the index of an item would return an update. For the above change the patch would return\r\n`{&quot;employee&quot;:{&quot;cars&quot;:[{&quot;id&quot;:12,&quot;field1&quot;:&quot;bar&quot;},{&quot;id&quot;:11,&quot;field1&quot;:&quot;foo&quot;}]}}`\r\nor \r\n```\r\n[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/employee/cars/1/id&quot;,&quot;value&quot;:11},\r\n{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/employee/cars/1/field1&quot;,&quot;value&quot;:&quot;foo&quot;},\r\n{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/employee/cars/0/id&quot;,&quot;value&quot;:12},\r\n{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/employee/cars/0/field1&quot;,&quot;value&quot;:&quot;bar&quot;}]\r\n```\r\n\r\nI can probably write custom code for these two scenarios but I wanted to understand if any json patch implementation (java) can be handle these 2 cases or if there is some library which can support this. Or if someone has an idea how to best approach the problems.\r\n\r\nThanks in advance.\r\n\r\n\r\n  [1]: https://datatracker.ietf.org/doc/html/rfc6902\r\n  [2]: https://datatracker.ietf.org/doc/html/rfc7396","title":"Compare a json with nested elements after it has been modifed","body":"<p>I have a usecase where I want to figure out how a json was modified. I have to compare 2 json objects, one before it was modifed and one object representing the state after modfication. The json have many nested objects and arrays in it.\nThe json comparison can be done through <a href=\"https://datatracker.ietf.org/doc/html/rfc6902\" rel=\"nofollow noreferrer\">RFC 6902</a> and <a href=\"https://datatracker.ietf.org/doc/html/rfc7396\" rel=\"nofollow noreferrer\">RFC 7396</a> which has standard implementations.</p>\n<p>The JSON is actually a Java object which has many properties and references to other objects. This causes 2 problems. If the reference id of any child object is updated it would mean the whole object has been replaced rather than just the id field. The other is ordering of objects in collections. I would try to explain the 2 scenarios:</p>\n<p>Lets say the <code>id</code> of a child object (car in this case) is modified like below</p>\n<pre><code>// initial state\n{\n  &quot;employee&quot;: {\n    &quot;id&quot;: 1,\n    &quot;car&quot;: {\n      &quot;id&quot;: 11,\n      &quot;field1&quot;: &quot;foo&quot;\n    }\n  }\n}\n// modified state\n{\n  &quot;employee&quot;: {\n    &quot;id&quot;: 1,\n    &quot;car&quot;: {\n      &quot;id&quot;: 12,\n      &quot;field1&quot;: &quot;foo&quot;\n    }\n  }\n}\n</code></pre>\n<p>Then the JSON patch would return\n<code>{&quot;employee&quot;:{&quot;car&quot;:{&quot;id&quot;:12}}}</code>\nor\n<code>[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/employee/car/id&quot;,&quot;value&quot;:12}]</code>\nindicating the <code>id</code> was updated. But in my usecase it would mean the existing child object <code>car</code> with id 11 was removed and a new object car with id 12 was placed in its place.</p>\n<p>The second problem is in case of collections, the order should not matter. So, the below 2 json comparison would return that the object was not modified.</p>\n<pre><code>{\n  &quot;employee&quot;: {\n    &quot;id&quot;: 1,\n    &quot;cars&quot;: [\n      {\n        &quot;id&quot;: 11,\n        &quot;field1&quot;: &quot;foo&quot;\n      },\n      {\n        &quot;id&quot;: 12,\n        &quot;field1&quot;: &quot;bar&quot;\n      }\n    ]\n  }\n}\n// modified json\n{\n  &quot;employee&quot;: {\n    &quot;id&quot;: 1,\n    &quot;cars&quot;: [\n      {\n        &quot;id&quot;: 12,\n        &quot;field1&quot;: &quot;bar&quot;\n      },\n      {\n        &quot;id&quot;: 11,\n        &quot;field1&quot;: &quot;foo&quot;\n      }\n    ]\n  }\n}\n</code></pre>\n<p>But according to the RFC's the order of the collection matter and changing the index of an item would return an update. For the above change the patch would return\n<code>{&quot;employee&quot;:{&quot;cars&quot;:[{&quot;id&quot;:12,&quot;field1&quot;:&quot;bar&quot;},{&quot;id&quot;:11,&quot;field1&quot;:&quot;foo&quot;}]}}</code>\nor</p>\n<pre><code>[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/employee/cars/1/id&quot;,&quot;value&quot;:11},\n{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/employee/cars/1/field1&quot;,&quot;value&quot;:&quot;foo&quot;},\n{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/employee/cars/0/id&quot;,&quot;value&quot;:12},\n{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/employee/cars/0/field1&quot;,&quot;value&quot;:&quot;bar&quot;}]\n</code></pre>\n<p>I can probably write custom code for these two scenarios but I wanted to understand if any json patch implementation (java) can be handle these 2 cases or if there is some library which can support this. Or if someone has an idea how to best approach the problems.</p>\n<p>Thanks in advance.</p>\n"},{"tags":["java","spring-boot","apache-camel","prometheus"],"answers":[{"comments":[{"owner":{"display_name":"user12267177"},"score":0,"creation_date":1572152102,"post_id":58552048,"comment_id":103469053,"body_markdown":"I have added this but I am having a problem having the Camel metrics appear in the `/actutator/prometheus` page. I have tried setting `camel.component.micrometer.metrics-registry` to `metricsRegistry`, `io.micrometer.prometheus.PrometheusRegistry`and `prometheusRegistry` but still no go. Do I need to define a bean in a configuration class for the metrics to appear in Prometheus Actuator endpoint?","body":"I have added this but I am having a problem having the Camel metrics appear in the <code>&#47;actutator&#47;prometheus</code> page. I have tried setting <code>camel.component.micrometer.metrics-registry</code> to <code>metricsRegistry</code>, <code>io.micrometer.prometheus.PrometheusRegistry</code>and <code>prometheusRegistry</code> but still no go. Do I need to define a bean in a configuration class for the metrics to appear in Prometheus Actuator endpoint?"},{"owner":{"display_name":"user12267177"},"score":0,"creation_date":1572154640,"post_id":58552048,"comment_id":103469314,"body_markdown":"I tried adding this to my configuration class but the `/actuator/prometheus` page bacame blank: ```@Bean(MicrometerConstants.METRICS_REGISTRY_NAME)\n\tpublic PrometheusMeterRegistry meterRegistry() {\n\t\treturn new PrometheusMeterRegistry(PrometheusConfig.DEFAULT);\n\t}```","body":"I tried adding this to my configuration class but the <code>&#47;actuator&#47;prometheus</code> page bacame blank: <code>@Bean(MicrometerConstants.METRICS_REGISTRY_NAME) \tpublic PrometheusMeterRegistry meterRegistry() { \t\treturn new PrometheusMeterRegistry(PrometheusConfig.DEFAULT); \t}</code>"},{"owner":{"display_name":"user12267177"},"score":0,"creation_date":1572173973,"post_id":58552048,"comment_id":103472453,"body_markdown":"I tried setting `camel.component.micrometer.metrics-registry=prometheusMeterRegistry` and got the Prometheus Actuator endpoint working again but nothing seems to be added relating to Camel.","body":"I tried setting <code>camel.component.micrometer.metrics-registry=prometheusMeterR&zwnj;&#8203;egistry</code> and got the Prometheus Actuator endpoint working again but nothing seems to be added relating to Camel."},{"owner":{"account_id":176018,"reputation":56316,"user_id":406429,"display_name":"Claus Ibsen"},"score":0,"creation_date":1572181415,"post_id":58552048,"comment_id":103474057,"body_markdown":"You also need the route policy factory to have it monitor the Camel routes","body":"You also need the route policy factory to have it monitor the Camel routes"},{"owner":{"display_name":"user12267177"},"score":0,"creation_date":1572182652,"post_id":58552048,"comment_id":103474296,"body_markdown":"Added my config class but still no change: `@Bean\n    public CamelContextConfiguration contextConfiguration() {\n        return new CamelContextConfiguration() {\n            @Override\n            public void beforeApplicationStart(CamelContext camelContext) {\n                camelContext.addRoutePolicyFactory(new MicrometerRoutePolicyFactory());\n                camelContext.setMessageHistoryFactory(new MicrometerMessageHistoryFactory());\n            }\n\n            @Override\n            public void afterApplicationStart(CamelContext camelContext) {\n\n            }\n        };\n    }`","body":"Added my config class but still no change: <code>@Bean     public CamelContextConfiguration contextConfiguration() {         return new CamelContextConfiguration() {             @Override             public void beforeApplicationStart(CamelContext camelContext) {                 camelContext.addRoutePolicyFactory(new MicrometerRoutePolicyFactory());                 camelContext.setMessageHistoryFactory(new MicrometerMessageHistoryFactory());             }              @Override             public void afterApplicationStart(CamelContext camelContext) {              }         };     }</code>"}],"tags":[],"owner":{"account_id":176018,"reputation":56316,"user_id":406429,"display_name":"Claus Ibsen"},"comment_count":5,"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1571976328,"creation_date":1571976328,"answer_id":58552048,"question_id":58536192,"body_markdown":"There is a `camel-micrometer-starter` dependency you should use instead that integrates with micrometer. And then you can use the micrometer route policy from that dependency to let it monitor all your routes. See the docs at: https://camel.apache.org/components/2.x/micrometer-component.html","title":"Send Apache Camel Actuator Metrics to Prometheus","body":"<p>There is a <code>camel-micrometer-starter</code> dependency you should use instead that integrates with micrometer. And then you can use the micrometer route policy from that dependency to let it monitor all your routes. See the docs at: <a href=\"https://camel.apache.org/components/2.x/micrometer-component.html\" rel=\"nofollow noreferrer\">https://camel.apache.org/components/2.x/micrometer-component.html</a></p>\n"},{"comments":[{"owner":{"account_id":6320045,"reputation":597,"user_id":5239351,"accept_rate":62,"display_name":"bencampbell_14"},"score":0,"creation_date":1588923976,"post_id":58587066,"comment_id":109092232,"body_markdown":"Im trying to implement this as well and thanks for your post, i was able to see the above metrics that you posted. just wondering, in your implementation, are these the only camel metrics that you&#39;re monitoring? Were you able to implement your own PrometheusMeterRegistry bean?","body":"Im trying to implement this as well and thanks for your post, i was able to see the above metrics that you posted. just wondering, in your implementation, are these the only camel metrics that you&#39;re monitoring? Were you able to implement your own PrometheusMeterRegistry bean?"},{"owner":{"account_id":4228050,"reputation":1228,"user_id":3461120,"display_name":"prashant.kr.mod"},"score":0,"creation_date":1596827260,"post_id":58587066,"comment_id":111946312,"body_markdown":"can you please share the pom dependency for MicrometerRouterPolicyFactory and MicrometerMessageHistoryFactory.","body":"can you please share the pom dependency for MicrometerRouterPolicyFactory and MicrometerMessageHistoryFactory."},{"owner":{"account_id":1956083,"reputation":4432,"user_id":1759063,"accept_rate":53,"display_name":"Eljah"},"score":0,"creation_date":1605043675,"post_id":58587066,"comment_id":114531218,"body_markdown":"@prashant.kr.mod it is `&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;\n    &lt;artifactId&gt;camel-micrometer&lt;/artifactId&gt;\n&lt;/dependency&gt;`","body":"@prashant.kr.mod it is <code>&lt;dependency&gt;     &lt;groupId&gt;org.apache.camel&lt;&#47;groupId&gt;     &lt;artifactId&gt;camel-micrometer&lt;&#47;artifactId&gt; &lt;&#47;dependency&gt;</code>"}],"tags":[],"owner":{"display_name":"user12267177"},"comment_count":3,"down_vote_count":0,"up_vote_count":5,"is_accepted":true,"score":5,"last_activity_date":1572247790,"creation_date":1572247790,"answer_id":58587066,"question_id":58536192,"body_markdown":"Got the Camel Routes metrics working in the `/actuator/prometheus` endpoint.\r\n\r\nUse the **camel-micrometer-starter** dependency as stated by @claus-ibsen &#39;s comment.\r\n```xml\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;\r\n            &lt;artifactId&gt;camel-metrics-starter&lt;/artifactId&gt;\r\n        &lt;/dependency&gt;\r\n```\r\n\r\nSet the following in your properties file:\r\n```\r\ncamel.component.metrics.metric-registry=prometheusMeterRegistry\r\n```\r\n\r\nThen add set the Camel Context to use the MicrometerRouterPolicyFactory and MicrometerMessageHistoryFactory. Code seen below is places in a Configuration class:\r\n\r\n```java\r\n@Configuration\r\npublic class AppConfig {\r\n\r\n    @Bean\r\n    public CamelContextConfiguration camelContextConfiguration() {\r\n\r\n\t\treturn new CamelContextConfiguration() {\r\n\t\t\t@Override\r\n\t\t\tpublic void beforeApplicationStart(CamelContext camelContext) {\r\n\t\t\t\tcamelContext.addRoutePolicyFactory(new MicrometerRoutePolicyFactory());\r\n\t\t\t\tcamelContext.setMessageHistoryFactory(new MicrometerMessageHistoryFactory());\r\n\t\t\t}\r\n\r\n\t\t\t@Override\r\n\t\t\tpublic void afterApplicationStart(CamelContext camelContext) {\r\n\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n}\r\n\r\n```\r\n\r\nYou need to trigger an exchange in a route for the metrics to appear in `/actuator/prometheus`.\r\n\r\nHere are the metrics made available to Prometheus:\r\n\r\n 1. CamelMessageHistory_seconds_count\r\n 2. CamelMessageHistory_seconds_max\r\n 3. CamelRoutePolicy_seconds_max\r\n 4. CamelRoutePolicy_seconds_count\r\n 5. CamelRoutePolicy_seconds_sum\r\n\r\n**You can use the JMX Exporter jar for Prometheus to get the more detailed metrics from the JMX of Camel.** I wanted to avoid this approach as it would mean that for each Camel Spring Boot App I have would use 2 ports; 1 for the JMX Metrics and 1 for the Actuator Metrics.","title":"Send Apache Camel Actuator Metrics to Prometheus","body":"<p>Got the Camel Routes metrics working in the <code>/actuator/prometheus</code> endpoint.</p>\n\n<p>Use the <strong>camel-micrometer-starter</strong> dependency as stated by @claus-ibsen 's comment.</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;\n            &lt;artifactId&gt;camel-metrics-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n</code></pre>\n\n<p>Set the following in your properties file:</p>\n\n<pre><code>camel.component.metrics.metric-registry=prometheusMeterRegistry\n</code></pre>\n\n<p>Then add set the Camel Context to use the MicrometerRouterPolicyFactory and MicrometerMessageHistoryFactory. Code seen below is places in a Configuration class:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\npublic class AppConfig {\n\n    @Bean\n    public CamelContextConfiguration camelContextConfiguration() {\n\n        return new CamelContextConfiguration() {\n            @Override\n            public void beforeApplicationStart(CamelContext camelContext) {\n                camelContext.addRoutePolicyFactory(new MicrometerRoutePolicyFactory());\n                camelContext.setMessageHistoryFactory(new MicrometerMessageHistoryFactory());\n            }\n\n            @Override\n            public void afterApplicationStart(CamelContext camelContext) {\n\n            }\n        };\n    }\n\n}\n\n</code></pre>\n\n<p>You need to trigger an exchange in a route for the metrics to appear in <code>/actuator/prometheus</code>.</p>\n\n<p>Here are the metrics made available to Prometheus:</p>\n\n<ol>\n<li>CamelMessageHistory_seconds_count</li>\n<li>CamelMessageHistory_seconds_max</li>\n<li>CamelRoutePolicy_seconds_max</li>\n<li>CamelRoutePolicy_seconds_count</li>\n<li>CamelRoutePolicy_seconds_sum</li>\n</ol>\n\n<p><strong>You can use the JMX Exporter jar for Prometheus to get the more detailed metrics from the JMX of Camel.</strong> I wanted to avoid this approach as it would mean that for each Camel Spring Boot App I have would use 2 ports; 1 for the JMX Metrics and 1 for the Actuator Metrics.</p>\n"},{"tags":[],"owner":{"account_id":1705504,"reputation":149,"user_id":1564626,"accept_rate":20,"display_name":"srikant_mantha"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1624528880,"creation_date":1624528880,"answer_id":68113617,"question_id":58536192,"body_markdown":"I can see the metrics by keeping these dependencies intact\r\n\r\n```\r\n&lt;dependency&gt;\r\n  &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;\r\n  &lt;artifactId&gt;camel-management&lt;/artifactId&gt;\r\n&lt;/dependency&gt;\r\n&lt;dependency&gt;\r\n  &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;\r\n  &lt;artifactId&gt;camel-metrics&lt;/artifactId&gt;\r\n&lt;/dependency&gt;\r\n&lt;dependency&gt;\r\n  &lt;groupId&gt;org.apache.camel.springboot&lt;/groupId&gt;\r\n  &lt;artifactId&gt;camel-micrometer-starter&lt;/artifactId&gt;\r\n&lt;/dependency&gt;\r\n&lt;dependency&gt;\r\n  &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\r\n  &lt;artifactId&gt;micrometer-registry-prometheus&lt;/artifactId&gt;\r\n&lt;/dependency&gt;\r\n  ```\r\nWhy dont I see the actual process and bean names rather than like process3, bean1 etc ??\r\n\r\n```  CamelMessageHistory_seconds_count{camelContext=&quot;AppName&quot;,nodeId=&quot;process3&quot;,routeId=&quot;AppNameRoute&quot;,serviceName=&quot;MicrometerMessageHistoryService&quot;,} 100.0\r\n    CamelMessageHistory_seconds_sum{camelContext=&quot;AppName&quot;,nodeId=&quot;process3&quot;,routeId=&quot;AppNameRoute&quot;,serviceName=&quot;MicrometerMessageHistoryService&quot;,} 0.041466\r\n    CamelMessageHistory_seconds_count{camelContext=&quot;AppName&quot;,nodeId=&quot;bean1&quot;,routeId=&quot;AppNameRoute&quot;,serviceName=&quot;MicrometerMessageHistoryService&quot;,} 100.0\r\n    CamelMessageHistory_seconds_sum{camelContext=&quot;AppName&quot;,nodeId=&quot;bean1&quot;,routeId=&quot;AppNameRoute&quot;,serviceName=&quot;MicrometerMessageHistoryService&quot;,} 4.8417576\r\n```\r\n","title":"Send Apache Camel Actuator Metrics to Prometheus","body":"<p>I can see the metrics by keeping these dependencies intact</p>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;\n  &lt;artifactId&gt;camel-management&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;\n  &lt;artifactId&gt;camel-metrics&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.apache.camel.springboot&lt;/groupId&gt;\n  &lt;artifactId&gt;camel-micrometer-starter&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\n  &lt;artifactId&gt;micrometer-registry-prometheus&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Why dont I see the actual process and bean names rather than like process3, bean1 etc ??</p>\n<pre><code>    CamelMessageHistory_seconds_sum{camelContext=&quot;AppName&quot;,nodeId=&quot;process3&quot;,routeId=&quot;AppNameRoute&quot;,serviceName=&quot;MicrometerMessageHistoryService&quot;,} 0.041466\n    CamelMessageHistory_seconds_count{camelContext=&quot;AppName&quot;,nodeId=&quot;bean1&quot;,routeId=&quot;AppNameRoute&quot;,serviceName=&quot;MicrometerMessageHistoryService&quot;,} 100.0\n    CamelMessageHistory_seconds_sum{camelContext=&quot;AppName&quot;,nodeId=&quot;bean1&quot;,routeId=&quot;AppNameRoute&quot;,serviceName=&quot;MicrometerMessageHistoryService&quot;,} 4.8417576\n</code></pre>\n"},{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":1,"creation_date":1700115789,"post_id":77488489,"comment_id":136615613,"body_markdown":"As it’s currently written, your answer is unclear. Please [edit] to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"As it’s currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/77488489/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"display_name":"user18196814"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700057970,"creation_date":1700057970,"answer_id":77488489,"question_id":58536192,"body_markdown":"I am currently working with Apache Camel and using the Micrometer component for metrics. I have added the necessary dependency, but I am facing an issue where the metric is not showing up in the /actuator/prometheus endpoint.\r\n\r\n","title":"Send Apache Camel Actuator Metrics to Prometheus","body":"<p>I am currently working with Apache Camel and using the Micrometer component for metrics. I have added the necessary dependency, but I am facing an issue where the metric is not showing up in the /actuator/prometheus endpoint.</p>\n"}],"owner":{"display_name":"user12267177"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":8078,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":58587066,"answer_count":4,"score":3,"last_activity_date":1700057970,"creation_date":1571901860,"question_id":58536192,"body_markdown":"I am trying to forward/add the Actuator Camel metrics from `/actuator/camelroutes` (route metrics like number of exchanges/transactions) to the Prometheus Actuator endpoint. Is there a way for me to configure Camel to add those metrics to the PrometheusMeterRegistry?\r\n\r\nI have tried adding:\r\n```\r\ncamel.component.metrics.metric-registry=io.micrometer.prometheus.PrometheusMeterRegistry\r\n```\r\nin my `application.properties` according to the documentation here: https://camel.apache.org/components/latest/metrics-component.html\r\n\r\nBut still nothing relating to Apache Camel is displayed in `actuator/prometheus`\r\n\r\nHere are the dependencies I am using with **Spring Boot 2.1.9** and **Apache Camel 2.24.2**:\r\n```xml\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n\t    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;\r\n            &lt;artifactId&gt;camel-metrics-starter&lt;/artifactId&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\r\n            &lt;artifactId&gt;micrometer-registry-prometheus&lt;/artifactId&gt;\r\n        &lt;/dependency&gt;\r\n```","title":"Send Apache Camel Actuator Metrics to Prometheus","body":"<p>I am trying to forward/add the Actuator Camel metrics from <code>/actuator/camelroutes</code> (route metrics like number of exchanges/transactions) to the Prometheus Actuator endpoint. Is there a way for me to configure Camel to add those metrics to the PrometheusMeterRegistry?</p>\n\n<p>I have tried adding:</p>\n\n<pre><code>camel.component.metrics.metric-registry=io.micrometer.prometheus.PrometheusMeterRegistry\n</code></pre>\n\n<p>in my <code>application.properties</code> according to the documentation here: <a href=\"https://camel.apache.org/components/latest/metrics-component.html\" rel=\"nofollow noreferrer\">https://camel.apache.org/components/latest/metrics-component.html</a></p>\n\n<p>But still nothing relating to Apache Camel is displayed in <code>actuator/prometheus</code></p>\n\n<p>Here are the dependencies I am using with <strong>Spring Boot 2.1.9</strong> and <strong>Apache Camel 2.24.2</strong>:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;\n            &lt;artifactId&gt;camel-metrics-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\n            &lt;artifactId&gt;micrometer-registry-prometheus&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n</code></pre>\n"},{"tags":["java","telegram","telegram-bot"],"answers":[{"tags":[],"owner":{"account_id":2413326,"reputation":1,"user_id":2107949,"display_name":"Andrey Litvinenko"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700057836,"creation_date":1700057836,"answer_id":77488471,"question_id":74438334,"body_markdown":"Question is too old, but :)\r\n\r\nYou need to use `stopPoll`.\r\n\r\nDetails: https://core.telegram.org/bots/api#stoppoll","title":"How to close Telegram poll (that was created by bot) after few days and manually","body":"<p>Question is too old, but :)</p>\n<p>You need to use <code>stopPoll</code>.</p>\n<p>Details: <a href=\"https://core.telegram.org/bots/api#stoppoll\" rel=\"nofollow noreferrer\">https://core.telegram.org/bots/api#stoppoll</a></p>\n"}],"owner":{"account_id":15310320,"reputation":1,"user_id":16455003,"display_name":"Dmitriy Komar"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":353,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1700057836,"creation_date":1668463126,"question_id":74438334,"body_markdown":"```\r\n@Scheduled(cron = &quot;* * * * * *&quot;)\r\nprivate void sendFriPoll(){\r\n    SendPoll sendPoll = new PollService().getPoll(String.valueOf(chatIdPoll), &quot;friday&quot;);\r\n    sendPoll.enableNotification();\r\n    sendSchPoll(sendPoll);\r\n}\r\n\r\nprivate void sendSchPoll(SendPoll sendPoll){\r\n    sendPoll.setChatId(String.valueOf(chatIdPoll));\r\n    try {\r\n        if (!isPollExist){\r\n            execute(sendPoll);\r\n            //isPollExist = true;\r\n        }\r\n    } catch (TelegramApiException e) {\r\n        System.out.println(e.getMessage());\r\n    }\r\n}\r\n```\r\n\r\nHow to close Telegram poll after few days if poll was created by bot?  \r\n  \r\nRelated with [close_date ](https://core.telegram.org/api/poll) max value is 600 sec.\r\n\r\n```\r\n @Override\r\n    public void onUpdateReceived(Update update) \r\n```\r\n\r\nDoes not track updated from bot.\r\n\r\nI have tried get &quot;.getMessageId()&quot; but I need new instance of &quot;Update&quot; and as I said &quot;onUpdateReceived&quot; does not tracked message from bot.  \r\nAlso I tried send command for bot by bot.  \r\n  \r\nI expect that poll will automatically closed after 2 days or I can close it with command /stop (using .getMessageId())","title":"How to close Telegram poll (that was created by bot) after few days and manually","body":"<pre><code>@Scheduled(cron = &quot;* * * * * *&quot;)\nprivate void sendFriPoll(){\n    SendPoll sendPoll = new PollService().getPoll(String.valueOf(chatIdPoll), &quot;friday&quot;);\n    sendPoll.enableNotification();\n    sendSchPoll(sendPoll);\n}\n\nprivate void sendSchPoll(SendPoll sendPoll){\n    sendPoll.setChatId(String.valueOf(chatIdPoll));\n    try {\n        if (!isPollExist){\n            execute(sendPoll);\n            //isPollExist = true;\n        }\n    } catch (TelegramApiException e) {\n        System.out.println(e.getMessage());\n    }\n}\n</code></pre>\n<p>How to close Telegram poll after few days if poll was created by bot?</p>\n<p>Related with <a href=\"https://core.telegram.org/api/poll\" rel=\"nofollow noreferrer\">close_date </a> max value is 600 sec.</p>\n<pre><code> @Override\n    public void onUpdateReceived(Update update) \n</code></pre>\n<p>Does not track updated from bot.</p>\n<p>I have tried get &quot;.getMessageId()&quot; but I need new instance of &quot;Update&quot; and as I said &quot;onUpdateReceived&quot; does not tracked message from bot.<br />\nAlso I tried send command for bot by bot.</p>\n<p>I expect that poll will automatically closed after 2 days or I can close it with command /stop (using .getMessageId())</p>\n"},{"tags":["java","intellij-idea","intellij-14"],"comments":[{"owner":{"account_id":960307,"reputation":107861,"user_id":984823,"display_name":"Joop Eggen"},"score":0,"creation_date":1658755743,"post_id":73109657,"comment_id":129123274,"body_markdown":"**SonarLint** might mark this renaming of overriden parameters. It does that for C#. And you might do more with SonarLint, making a list of company checked violations.","body":"<b>SonarLint</b> might mark this renaming of overriden parameters. It does that for C#. And you might do more with SonarLint, making a list of company checked violations."},{"owner":{"account_id":7128588,"reputation":97,"user_id":5450689,"display_name":"horato"},"score":0,"creation_date":1658757324,"post_id":73109657,"comment_id":129124036,"body_markdown":"@Joop Sadly it doesn&#39;t report it. I couldn&#39;t find any similar rule in the settings either.","body":"@Joop Sadly it doesn&#39;t report it. I couldn&#39;t find any similar rule in the settings either."}],"answers":[{"comments":[{"owner":{"account_id":7128588,"reputation":97,"user_id":5450689,"display_name":"horato"},"score":0,"creation_date":1658756190,"post_id":73109861,"comment_id":129123494,"body_markdown":"Thank you for the suggestion. I have older unsupported version of intellij so I can&#39;t test, but I don&#39;t think this solves my problem. The issue for me is that the interface is auto generated from swagger and only the interface implementation is in our code. Nobody actually calls the interface directly. It is used by spring to create a rest api.","body":"Thank you for the suggestion. I have older unsupported version of intellij so I can&#39;t test, but I don&#39;t think this solves my problem. The issue for me is that the interface is auto generated from swagger and only the interface implementation is in our code. Nobody actually calls the interface directly. It is used by spring to create a rest api."},{"owner":{"account_id":371244,"reputation":443,"user_id":17825391,"display_name":"user213769"},"score":0,"creation_date":1700057768,"post_id":73109861,"comment_id":136608074,"body_markdown":"@Horato the plugin is no longer compatible nor supported, because this inspection is now provided in core IntelliJ inspection bunch (just disabled by default AFAIK)","body":"@Horato the plugin is no longer compatible nor supported, because this inspection is now provided in core IntelliJ inspection bunch (just disabled by default AFAIK)"}],"tags":[],"owner":{"account_id":2918786,"reputation":637,"user_id":3576968,"display_name":"Daniel Schr&#246;der"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1658754883,"creation_date":1658754883,"answer_id":73109861,"question_id":73109657,"body_markdown":"There is a plugin in the Jetbrains&#39; marketplace that implements this feature.\r\nYou can find it [in this link][1].\r\n\r\nIf you want to see the implementation of that plugin, you can take a look at its [GitHub&#39;s repository][2].\r\n\r\n\r\n  [1]: https://plugins.jetbrains.com/plugin/15354-method-parameter-order-inspection\r\n  [2]: https://github.com/johnnyleitrim/IntelliJParameterOrderInspection","title":"Validate method parameter name between interface declaration and implementation","body":"<p>There is a plugin in the Jetbrains' marketplace that implements this feature.\nYou can find it <a href=\"https://plugins.jetbrains.com/plugin/15354-method-parameter-order-inspection\" rel=\"nofollow noreferrer\">in this link</a>.</p>\n<p>If you want to see the implementation of that plugin, you can take a look at its <a href=\"https://github.com/johnnyleitrim/IntelliJParameterOrderInspection\" rel=\"nofollow noreferrer\">GitHub's repository</a>.</p>\n"},{"comments":[{"owner":{"account_id":7128588,"reputation":97,"user_id":5450689,"display_name":"horato"},"score":1,"creation_date":1700165109,"post_id":77488456,"comment_id":136624360,"body_markdown":"Thank you, this is probably as close to a solution as I can get. Unfortunately it doesn&#39;t abort compilation yet. https://youtrack.jetbrains.com/issue/IDEA-78625","body":"Thank you, this is probably as close to a solution as I can get. Unfortunately it doesn&#39;t abort compilation yet. <a href=\"https://youtrack.jetbrains.com/issue/IDEA-78625\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/IDEA-78625</a>"}],"tags":[],"owner":{"account_id":371244,"reputation":443,"user_id":17825391,"display_name":"user213769"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1700057714,"creation_date":1700057714,"answer_id":77488456,"question_id":73109657,"body_markdown":"In newer IntelliJ versions, this is under _Editor-&gt;Inspections-&gt;Java-&gt;Naming conventions-&gt;Parameter name differs from parameter in overriden or overloaded method_ - no need for external plugins anymore for this:[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/YNJx1.png","title":"Validate method parameter name between interface declaration and implementation","body":"<p>In newer IntelliJ versions, this is under <em>Editor-&gt;Inspections-&gt;Java-&gt;Naming conventions-&gt;Parameter name differs from parameter in overriden or overloaded method</em> - no need for external plugins anymore for this:<a href=\"https://i.stack.imgur.com/YNJx1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YNJx1.png\" alt=\"enter image description here\" /></a></p>\n"}],"owner":{"account_id":7128588,"reputation":97,"user_id":5450689,"display_name":"horato"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":154,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":77488456,"answer_count":2,"score":2,"last_activity_date":1700057714,"creation_date":1658753962,"question_id":73109657,"body_markdown":"**Issue**:\r\n``` \r\npublic interface ITest\r\n{\r\n    String JoinString(String first, String second);\r\n}\r\n\r\npublic class Test implements ITest\r\n{\r\n\r\n    @Override\r\n    public String JoinString(String first, String second)\r\n    {\r\n        return first + second;\r\n    }\r\n}\r\n\r\npublic class Main\r\n{\r\n    public static int Main(Object[] args)\r\n    {\r\n        var inst = (ITest) new Test();\r\n        inst.JoinString(&quot;a&quot;, &quot;b&quot;);\r\n    }\r\n}\r\n```\r\nThis correctly returns string &quot;ab&quot;. But if you change the interface and swap the parameters\r\n``` \r\npublic interface ITest\r\n{\r\n    String JoinString(String second, String first);\r\n}\r\n``` \r\n\r\nthen the method still returns &quot;ab&quot; instead of expected &quot;ba&quot;. This expectation is based on the parameter name &quot;first&quot; and &quot;second&quot;.\r\n\r\n**Question**: How do you validate that parameter names from interfaces match the names in implementation? Preferably during build time with a build error.","title":"Validate method parameter name between interface declaration and implementation","body":"<p><strong>Issue</strong>:</p>\n<pre><code>public interface ITest\n{\n    String JoinString(String first, String second);\n}\n\npublic class Test implements ITest\n{\n\n    @Override\n    public String JoinString(String first, String second)\n    {\n        return first + second;\n    }\n}\n\npublic class Main\n{\n    public static int Main(Object[] args)\n    {\n        var inst = (ITest) new Test();\n        inst.JoinString(&quot;a&quot;, &quot;b&quot;);\n    }\n}\n</code></pre>\n<p>This correctly returns string &quot;ab&quot;. But if you change the interface and swap the parameters</p>\n<pre><code>public interface ITest\n{\n    String JoinString(String second, String first);\n}\n</code></pre>\n<p>then the method still returns &quot;ab&quot; instead of expected &quot;ba&quot;. This expectation is based on the parameter name &quot;first&quot; and &quot;second&quot;.</p>\n<p><strong>Question</strong>: How do you validate that parameter names from interfaces match the names in implementation? Preferably during build time with a build error.</p>\n"},{"tags":["java","aws-lambda","http-headers","quarkus","resteasy"],"comments":[{"owner":{"account_id":9504657,"reputation":7440,"user_id":7064617,"display_name":"JCompetence"},"score":0,"creation_date":1700122202,"post_id":77488436,"comment_id":136616383,"body_markdown":"Do you have anything infront of the Lambda? Like API Gateway for example?","body":"Do you have anything infront of the Lambda? Like API Gateway for example?"},{"owner":{"account_id":28906563,"reputation":1,"user_id":22140491,"display_name":"Venkit"},"score":0,"creation_date":1700186960,"post_id":77488436,"comment_id":136626717,"body_markdown":"I have an ALB, through which the path is routed to lambda service. There are no additional filters configured on the ALB. If I try using lambda function handler, its able to identify the headers @JCompetence","body":"I have an ALB, through which the path is routed to lambda service. There are no additional filters configured on the ALB. If I try using lambda function handler, its able to identify the headers @JCompetence"},{"owner":{"account_id":28906563,"reputation":1,"user_id":22140491,"display_name":"Venkit"},"score":0,"creation_date":1700194882,"post_id":77488436,"comment_id":136627230,"body_markdown":"Found the root cause, I missed to enable multivalue headers in the target group for the ec2 instance. Thanks","body":"Found the root cause, I missed to enable multivalue headers in the target group for the ec2 instance. Thanks"}],"owner":{"account_id":28906563,"reputation":1,"user_id":22140491,"display_name":"Venkit"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":51,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700057595,"creation_date":1700057595,"question_id":77488436,"body_markdown":"I am facing an issue while deploying the quarkus java code as native build. I am using java 17 with quarkus bom version of 3.5.1. The header propagation is working when I try from my local environment, but when I try to deploy as a native build to lambda its not working. Am I missing something here.\r\n\r\nThe following are the pom dependencies\r\n\r\n```\r\n&lt;dependency&gt;\r\n      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;\r\n      &lt;artifactId&gt;quarkus-amazon-lambda-rest&lt;/artifactId&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;\r\n      &lt;artifactId&gt;quarkus-resteasy-jsonb&lt;/artifactId&gt;\r\n    &lt;/dependency&gt;\r\n```\r\n\r\nThe following is the controller code\r\n\r\n```\r\n@Path(“/path&quot;)\r\n@RegisterForReflection(serialization = true)\r\n@Slf4j\r\npublic class Controller {\r\n\r\n@Inject\r\nService service;\r\n\r\n@POST\r\n@Path(“/getHeader”)\r\npublic String getHeader(@HeaderParam(“firstHeader”) String headerField, RequestObject request) {\r\nlog.info(&quot;firstHeader: {}&quot;, headerField); // headerField is null\r\nlog.info(&quot;request name: {}&quot;, request.getName()); // this is working\r\nreturn firstHeader;\r\n}\r\n```\r\n\r\n\r\n\r\nI have tried the following approaches.\r\n1) Tried to use interceptor to see if header was getting propagated. I am only able to see 2 header fields. Header fields that are visible are localhost and transfer-encoding.\r\n2. Tried to implement a custom container Filter class to see if header is getting propagated. (ContainerRequestFilter)","title":"Header propagation with quarkus amazon-lambda-rest not working","body":"<p>I am facing an issue while deploying the quarkus java code as native build. I am using java 17 with quarkus bom version of 3.5.1. The header propagation is working when I try from my local environment, but when I try to deploy as a native build to lambda its not working. Am I missing something here.</p>\n<p>The following are the pom dependencies</p>\n<pre><code>&lt;dependency&gt;\n      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;\n      &lt;artifactId&gt;quarkus-amazon-lambda-rest&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;\n      &lt;artifactId&gt;quarkus-resteasy-jsonb&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<p>The following is the controller code</p>\n<pre><code>@Path(“/path&quot;)\n@RegisterForReflection(serialization = true)\n@Slf4j\npublic class Controller {\n\n@Inject\nService service;\n\n@POST\n@Path(“/getHeader”)\npublic String getHeader(@HeaderParam(“firstHeader”) String headerField, RequestObject request) {\nlog.info(&quot;firstHeader: {}&quot;, headerField); // headerField is null\nlog.info(&quot;request name: {}&quot;, request.getName()); // this is working\nreturn firstHeader;\n}\n</code></pre>\n<p>I have tried the following approaches.</p>\n<ol>\n<li>Tried to use interceptor to see if header was getting propagated. I am only able to see 2 header fields. Header fields that are visible are localhost and transfer-encoding.</li>\n</ol>\n<ol start=\"2\">\n<li>Tried to implement a custom container Filter class to see if header is getting propagated. (ContainerRequestFilter)</li>\n</ol>\n"},{"tags":["java","android","service","notifications","android-notifications"],"answers":[{"tags":[],"owner":{"account_id":29776118,"reputation":269,"user_id":22820043,"display_name":"Cloverleaf"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1700054804,"creation_date":1700048721,"answer_id":77487433,"question_id":77485816,"body_markdown":"What do you **realy** want to start? A foreground service or a notification (or both)?\r\nIf a foreground service, you can do this with an intent (and **not** a notification):\r\n\r\n    Intent serviceIntent = new Intent(this, ForegroundService.class);\r\n    startForegroundService(serviceIntent);\r\n\r\nIf you want to show a notification, then the line \r\n\r\n    notificationManager.notify(NOTIFICATION_ID, notification);\r\n\r\nis missing.\r\n\r\n\r\n\r\n\r\n","title":"Android 11: android.app.RemoteServiceException: Bad notification for startForeground","body":"<p>What do you <strong>realy</strong> want to start? A foreground service or a notification (or both)?\nIf a foreground service, you can do this with an intent (and <strong>not</strong> a notification):</p>\n<pre><code>Intent serviceIntent = new Intent(this, ForegroundService.class);\nstartForegroundService(serviceIntent);\n</code></pre>\n<p>If you want to show a notification, then the line</p>\n<pre><code>notificationManager.notify(NOTIFICATION_ID, notification);\n</code></pre>\n<p>is missing.</p>\n"}],"owner":{"account_id":3908301,"reputation":730,"user_id":3234357,"accept_rate":73,"display_name":"iammrmehul"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":40,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1700057593,"creation_date":1700032108,"question_id":77485816,"body_markdown":"Trying to start foreground service as per the code : \r\n```\r\nfinal Notification.Builder notificationBuilder;\r\nif (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {\r\n  final NotificationChannel channel = new NotificationChannel(CHANNEL_ID,\r\n                    getApplicationContext().getPackageName(), NotificationManager.IMPORTANCE_HIGH);\r\n  mNotificationManager.createNotificationChannel(channel);\r\n  notificationBuilder = new Notification.Builder(mAppContext, CHANNEL_ID);\r\n} else {\r\n  notificationBuilder = new Notification.Builder(mAppContext);\r\n}\r\nfinal Notification notification = notificationBuilder\r\n            .setContentTitle(mAppContext.getResources()\r\n            .getString(R.string.initiate_partner_apps))\r\n            .setSmallIcon(R.drawable.ic_launcher)\r\n            .build();\r\nstartForeground(NOTIFICATION_ID, notification);\r\n```\r\n\r\nBut I am faced with the below error : \r\n```\r\nD AndroidRuntime: Shutting down VM\r\nE AndroidRuntime: FATAL EXCEPTION: main\r\nE AndroidRuntime: Process: com.my.package, PID: 8320\r\nE AndroidRuntime: android.app.RemoteServiceException: Bad notification for startForeground\r\nE AndroidRuntime: \tat android.app.ActivityThread$H.handleMessage(ActivityThread.java:2020)\r\nE AndroidRuntime: \tat android.os.Handler.dispatchMessage(Handler.java:106)\r\nE AndroidRuntime: \tat android.os.Looper.loop(Looper.java:223)\r\nE AndroidRuntime: \tat android.app.ActivityThread.main(ActivityThread.java:7719)\r\nE AndroidRuntime: \tat java.lang.reflect.Method.invoke(Native Method)\r\nE AndroidRuntime: \tat com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:592)\r\nE AndroidRuntime: \tat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:947)\r\n```\r\n\r\nThe above code didn&#39;t cause any issues in Android 8.1 but started seeing this in Android 11 only.\r\n\r\nSo far whatever I have seen online, the error message also lists a reason pointing out invalid channel Id. In my case not only is there no reason listed out but also I have been using the same constant `CHANNEL_ID` so I know I am not making that mistake.\r\n\r\nI am not able to understand what could be the possible reason for this error","title":"Android 11: android.app.RemoteServiceException: Bad notification for startForeground","body":"<p>Trying to start foreground service as per the code :</p>\n<pre><code>final Notification.Builder notificationBuilder;\nif (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {\n  final NotificationChannel channel = new NotificationChannel(CHANNEL_ID,\n                    getApplicationContext().getPackageName(), NotificationManager.IMPORTANCE_HIGH);\n  mNotificationManager.createNotificationChannel(channel);\n  notificationBuilder = new Notification.Builder(mAppContext, CHANNEL_ID);\n} else {\n  notificationBuilder = new Notification.Builder(mAppContext);\n}\nfinal Notification notification = notificationBuilder\n            .setContentTitle(mAppContext.getResources()\n            .getString(R.string.initiate_partner_apps))\n            .setSmallIcon(R.drawable.ic_launcher)\n            .build();\nstartForeground(NOTIFICATION_ID, notification);\n</code></pre>\n<p>But I am faced with the below error :</p>\n<pre><code>D AndroidRuntime: Shutting down VM\nE AndroidRuntime: FATAL EXCEPTION: main\nE AndroidRuntime: Process: com.my.package, PID: 8320\nE AndroidRuntime: android.app.RemoteServiceException: Bad notification for startForeground\nE AndroidRuntime:   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2020)\nE AndroidRuntime:   at android.os.Handler.dispatchMessage(Handler.java:106)\nE AndroidRuntime:   at android.os.Looper.loop(Looper.java:223)\nE AndroidRuntime:   at android.app.ActivityThread.main(ActivityThread.java:7719)\nE AndroidRuntime:   at java.lang.reflect.Method.invoke(Native Method)\nE AndroidRuntime:   at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:592)\nE AndroidRuntime:   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:947)\n</code></pre>\n<p>The above code didn't cause any issues in Android 8.1 but started seeing this in Android 11 only.</p>\n<p>So far whatever I have seen online, the error message also lists a reason pointing out invalid channel Id. In my case not only is there no reason listed out but also I have been using the same constant <code>CHANNEL_ID</code> so I know I am not making that mistake.</p>\n<p>I am not able to understand what could be the possible reason for this error</p>\n"},{"tags":["java","eclipse","user-interface","eclipse-rcp","e4"],"comments":[{"owner":{"account_id":3159259,"reputation":109678,"user_id":2670892,"display_name":"greg-449"},"score":0,"creation_date":1698303420,"post_id":77364590,"comment_id":136388576,"body_markdown":"As far as I can see `EPartService.showPart` always puts the part at the `MPlaceholder` location (found using `EModelService.findPlaceholderFor`). So I think this would be difficult.","body":"As far as I can see <code>EPartService.showPart</code> always puts the part at the <code>MPlaceholder</code> location (found using <code>EModelService.findPlaceholderFor</code>). So I think this would be difficult."},{"owner":{"account_id":4084752,"reputation":355,"user_id":3354299,"accept_rate":54,"display_name":"Sangli"},"score":0,"creation_date":1698305664,"post_id":77364590,"comment_id":136389044,"body_markdown":"Is there any way or any suggestions I could try? All that I have tried so far have been futile","body":"Is there any way or any suggestions I could try? All that I have tried so far have been futile"},{"owner":{"account_id":3159259,"reputation":109678,"user_id":2670892,"display_name":"greg-449"},"score":0,"creation_date":1698307361,"post_id":77364590,"comment_id":136389355,"body_markdown":"As I said this is difficult. You could perhaps study `org.eclipse.e4.ui.internal.workbench.PartServiceImpl` to work out how to set the desired parent but this is complicated code.","body":"As I said this is difficult. You could perhaps study <code>org.eclipse.e4.ui.internal.workbench.PartServiceImpl</code> to work out how to set the desired parent but this is complicated code."}],"answers":[{"tags":[],"owner":{"account_id":2583747,"reputation":3916,"user_id":2239897,"accept_rate":76,"display_name":"Stefan Winkler"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1700057484,"creation_date":1700057484,"answer_id":77488423,"question_id":77364590,"body_markdown":"This should work (and does not even use internal API):\r\n\r\n```java\r\n// We need to find the PartStack of our activePart so we know where we need to create the new view\r\n// get the active part site to access to the ServiceLocator\r\nIWorkbenchPartSite currentPartSite = activePart.getSite();\r\n\r\n// get the IEclipseContext via the ServiceLocator - this is the context that is associated with the active part\r\nIEclipseContext context = currentPartSite.getService(IEclipseContext.class);\r\n\r\n// get the current perspective (since we are in the context of the active part, the MPerspective key gives us the current perspective)\r\n// The current perspective is used below in the find() calls to search for placeholders only in the current perspective\r\nMPerspective currentPerspective = context.get(MPerspective.class);\r\n\r\n// get the current MPart (as with the perspective, this can be acquired simply via the context)\r\nMPart currentPart = context.get(MPart.class);\r\n\r\n// the MPart is actually shared across multiple perspectives. So it is not contained directly in the part stack itself.\r\n// Instead it is contained in a special place in the model and referenced by a placeholder in the actual PartStack where the view is rendered.\r\n// So, we get the placeholder for this shared view by calling getCurSharedRef()\r\nMPlaceholder currentPlaceholder = currentPart.getCurSharedRef();\r\n\r\n// the parent of that placeholder is the PartStack that we want to create our new View in\r\nvar targetPartStack = currentPlaceholder.getParent();\r\n\r\n// The next step is to find our placeholder in the current perspective\r\nEModelService modelService = context.get(EModelService.class);\r\nMUIElement placeholder = modelService.find(&quot;com.example.myView:*&quot;, currentPerspective);\r\n\r\n// now that we have identified the target stack we want our View to appear in\r\n// and the placeholder that will be used to create the View, we can move the placeholder\r\n// to the target part stack (if it is not yet there anyways)\r\nif (!placeholder.getParent().equals(targetPartStack)) {\r\n  // this is an EMF add operation. It will automatically remove placeholder from its previous parent,\r\n  // so this is actually a MOVE operation:\r\n  targetPartStack.getChildren().add(placeholder);\r\n}\r\n\r\n// and finally, we can create our secondary view with the default API\r\npage.showView(&quot;com.example.myView&quot;, getNextSecondaryId(), IWorkbenchPage.VIEW_ACTIVATE);\r\n```\r\n\r\nNote that if a view is opened and cloded again, it will leave an MPlaceholder behind. So only views that did not exist before will be created in the correct Part Stack. If you want to make this work even after opening and closing views, you could try to find the concrete MPlaceholder for the newly created View first and if it exists, then place that instead of the general placeholder.","title":"Open multiple instances of same view (part in Eclipse E4 terms) next to each other in the same part stack on Eclipse E4","body":"<p>This should work (and does not even use internal API):</p>\n<pre class=\"lang-java prettyprint-override\"><code>// We need to find the PartStack of our activePart so we know where we need to create the new view\n// get the active part site to access to the ServiceLocator\nIWorkbenchPartSite currentPartSite = activePart.getSite();\n\n// get the IEclipseContext via the ServiceLocator - this is the context that is associated with the active part\nIEclipseContext context = currentPartSite.getService(IEclipseContext.class);\n\n// get the current perspective (since we are in the context of the active part, the MPerspective key gives us the current perspective)\n// The current perspective is used below in the find() calls to search for placeholders only in the current perspective\nMPerspective currentPerspective = context.get(MPerspective.class);\n\n// get the current MPart (as with the perspective, this can be acquired simply via the context)\nMPart currentPart = context.get(MPart.class);\n\n// the MPart is actually shared across multiple perspectives. So it is not contained directly in the part stack itself.\n// Instead it is contained in a special place in the model and referenced by a placeholder in the actual PartStack where the view is rendered.\n// So, we get the placeholder for this shared view by calling getCurSharedRef()\nMPlaceholder currentPlaceholder = currentPart.getCurSharedRef();\n\n// the parent of that placeholder is the PartStack that we want to create our new View in\nvar targetPartStack = currentPlaceholder.getParent();\n\n// The next step is to find our placeholder in the current perspective\nEModelService modelService = context.get(EModelService.class);\nMUIElement placeholder = modelService.find(&quot;com.example.myView:*&quot;, currentPerspective);\n\n// now that we have identified the target stack we want our View to appear in\n// and the placeholder that will be used to create the View, we can move the placeholder\n// to the target part stack (if it is not yet there anyways)\nif (!placeholder.getParent().equals(targetPartStack)) {\n  // this is an EMF add operation. It will automatically remove placeholder from its previous parent,\n  // so this is actually a MOVE operation:\n  targetPartStack.getChildren().add(placeholder);\n}\n\n// and finally, we can create our secondary view with the default API\npage.showView(&quot;com.example.myView&quot;, getNextSecondaryId(), IWorkbenchPage.VIEW_ACTIVATE);\n</code></pre>\n<p>Note that if a view is opened and cloded again, it will leave an MPlaceholder behind. So only views that did not exist before will be created in the correct Part Stack. If you want to make this work even after opening and closing views, you could try to find the concrete MPlaceholder for the newly created View first and if it exists, then place that instead of the general placeholder.</p>\n"}],"owner":{"account_id":4084752,"reputation":355,"user_id":3354299,"accept_rate":54,"display_name":"Sangli"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":38,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77488423,"answer_count":1,"score":0,"last_activity_date":1700057484,"creation_date":1698301796,"question_id":77364590,"body_markdown":"I have my view and the corresponding placeholder (to support opening multiple instances of the same view) created by implementing IPerspectiveFactory as follows -\r\n```\r\n @Override\r\n  public void createInitialLayout(final IPageLayout layout)\r\n  {\r\n    String editorArea = layout.getEditorArea();\r\n    IFolderLayout right = layout.createFolder(&quot;myViewLayout&quot;, IPageLayout.RIGHT, 0.22, IPageLayout.ID_PROJECT_EXPLORER);\r\n    right.addView(&quot;com.example.myView&quot;);\r\n    right.addPlaceholder(&quot;com.example.myView:*&quot;);\r\n }\r\n```\r\nThen I have a simple menu button attached to my view that when triggered should open the duplicate instance of the view next to the original view location (same partstack) like &#39;tabbed&#39; views and I tried the following in Eclipse e4 way -\r\n```\r\n public class NewMyView extends AbstractHandler {\r\n int counter = 1;\r\n @Override\r\n  public Object execute(final ExecutionEvent event) throws ExecutionException\r\n  {\r\n    IWorkbenchPart activePart = HandlerUtil.getActivePart(event);\r\n    for (; activePart.getSite().getPage().findViewReference(&quot;com.example.myView&quot;, getNextSecondaryId()) != null; this.counter++) \r\n    {\r\n    \r\n    }\r\n\r\n    IEclipseContext serviceContext = E4Workbench.getServiceContext();\r\n    final IEclipseContext appContext = serviceContext.getActiveChild();\r\n\r\n    EModelService modelService = appContext.get(EModelService.class);\r\n    MApplication app = serviceContext.get(MApplication.class);\r\n    EPartService partService = serviceContext.get(EPartService.class);\r\n\r\n    MPart part = partService.findPart(&quot;com.example.myView&quot;);\r\n    if (part == null)\r\n    {\r\n      MPlaceholder placeholder = partService.createSharedPart(&quot;com.example.myView&quot;);\r\n      part = (MPart) placeholder.getRef();\r\n    }\r\n    partService.showPart(part, PartState.ACTIVATE);\r\n    this.counter++;\r\n }\r\n\r\nprivate String getNextSecondaryId()\r\n  {\r\n    return &quot;myView#&quot; + this.counter;\r\n  }\r\n}\r\n```\r\nI&#39;m not sure if what I&#39;m doing is right using Eclipse e4 way to open the duplicate instance of &#39;myView&#39; next to each other in the same part stack, ideally I want the duplicate instances of the view to open in the same location next to each other from where I trigger the action to open the duplicate instance of the view, so if I drag and drop one of the instances of my view to a different layout/part stack and then again I try to open the duplicate instance of my view then it should open the new location/currently active part from where I trigger the action to open the view.\r\nThis can be achieved partially using Eclipse E3 way (for example Eclipse&#39;s Console view in E3 works this way) -\r\n```\r\npage.showView(&quot;com.example.myView&quot;, getNextSecondaryId(), IWorkbenchPage.VIEW_ACTIVATE);\r\nthis.counter++\r\n```\r\nBut the problem with Eclipse E3 approach is that when I drag and drop one of the instances of the view to another part stack and then I again trigger the command to open a duplicate instance of my view from the new location then the new instance would be opened at the default location where it was initially added using IFolderLayout. Eclipse&#39;s Console view in E3 where it supports opening multiple instances behaves in a similar way.\r\n\r\nIs this behavior achievable using Eclipse E4? If so then am I doing it correctly in my code by using EPartService and MPlaceHolder?","title":"Open multiple instances of same view (part in Eclipse E4 terms) next to each other in the same part stack on Eclipse E4","body":"<p>I have my view and the corresponding placeholder (to support opening multiple instances of the same view) created by implementing IPerspectiveFactory as follows -</p>\n<pre><code> @Override\n  public void createInitialLayout(final IPageLayout layout)\n  {\n    String editorArea = layout.getEditorArea();\n    IFolderLayout right = layout.createFolder(&quot;myViewLayout&quot;, IPageLayout.RIGHT, 0.22, IPageLayout.ID_PROJECT_EXPLORER);\n    right.addView(&quot;com.example.myView&quot;);\n    right.addPlaceholder(&quot;com.example.myView:*&quot;);\n }\n</code></pre>\n<p>Then I have a simple menu button attached to my view that when triggered should open the duplicate instance of the view next to the original view location (same partstack) like 'tabbed' views and I tried the following in Eclipse e4 way -</p>\n<pre><code> public class NewMyView extends AbstractHandler {\n int counter = 1;\n @Override\n  public Object execute(final ExecutionEvent event) throws ExecutionException\n  {\n    IWorkbenchPart activePart = HandlerUtil.getActivePart(event);\n    for (; activePart.getSite().getPage().findViewReference(&quot;com.example.myView&quot;, getNextSecondaryId()) != null; this.counter++) \n    {\n    \n    }\n\n    IEclipseContext serviceContext = E4Workbench.getServiceContext();\n    final IEclipseContext appContext = serviceContext.getActiveChild();\n\n    EModelService modelService = appContext.get(EModelService.class);\n    MApplication app = serviceContext.get(MApplication.class);\n    EPartService partService = serviceContext.get(EPartService.class);\n\n    MPart part = partService.findPart(&quot;com.example.myView&quot;);\n    if (part == null)\n    {\n      MPlaceholder placeholder = partService.createSharedPart(&quot;com.example.myView&quot;);\n      part = (MPart) placeholder.getRef();\n    }\n    partService.showPart(part, PartState.ACTIVATE);\n    this.counter++;\n }\n\nprivate String getNextSecondaryId()\n  {\n    return &quot;myView#&quot; + this.counter;\n  }\n}\n</code></pre>\n<p>I'm not sure if what I'm doing is right using Eclipse e4 way to open the duplicate instance of 'myView' next to each other in the same part stack, ideally I want the duplicate instances of the view to open in the same location next to each other from where I trigger the action to open the duplicate instance of the view, so if I drag and drop one of the instances of my view to a different layout/part stack and then again I try to open the duplicate instance of my view then it should open the new location/currently active part from where I trigger the action to open the view.\nThis can be achieved partially using Eclipse E3 way (for example Eclipse's Console view in E3 works this way) -</p>\n<pre><code>page.showView(&quot;com.example.myView&quot;, getNextSecondaryId(), IWorkbenchPage.VIEW_ACTIVATE);\nthis.counter++\n</code></pre>\n<p>But the problem with Eclipse E3 approach is that when I drag and drop one of the instances of the view to another part stack and then I again trigger the command to open a duplicate instance of my view from the new location then the new instance would be opened at the default location where it was initially added using IFolderLayout. Eclipse's Console view in E3 where it supports opening multiple instances behaves in a similar way.</p>\n<p>Is this behavior achievable using Eclipse E4? If so then am I doing it correctly in my code by using EPartService and MPlaceHolder?</p>\n"},{"tags":["java","swing","paint","paintcomponent"],"comments":[{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700014479,"post_id":77484818,"comment_id":136602189,"body_markdown":"Well, I&#39;m studying this in my University and i do understand the basics of Swing but i just have problem with connecting the dots here. @davidalayachew","body":"Well, I&#39;m studying this in my University and i do understand the basics of Swing but i just have problem with connecting the dots here. @davidalayachew"},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700014989,"post_id":77484818,"comment_id":136602218,"body_markdown":"I realize now that you were asking a wildly different question than what I had assumed. I am typing up an answer to your actual question now.","body":"I realize now that you were asking a wildly different question than what I had assumed. I am typing up an answer to your actual question now."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700015093,"post_id":77484818,"comment_id":136602222,"body_markdown":"That said, the wording of the text is not very clear either. What you are really trying to say is that &quot;I used the method `drawLine` to attempt to draw lines, but I only got a bunch of dots in the shape of a line instead of actual lines. How do I connect the dots?&quot; I would encourage you to edit your question to say that instead.","body":"That said, the wording of the text is not very clear either. What you are really trying to say is that &quot;I used the method <code>drawLine</code> to attempt to draw lines, but I only got a bunch of dots in the shape of a line instead of actual lines. How do I connect the dots?&quot; I would encourage you to edit your question to say that instead."},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700015171,"post_id":77484818,"comment_id":136602227,"body_markdown":"@davidalayachew Wow, i appreciate it a lot. Yeah, as you said, I&#39;m still a first year Uni student and I&#39;m still not comfortable enough with Swing, specially with Paint Component but i have to finish my assignment for my professor so i really do need help.","body":"@davidalayachew Wow, i appreciate it a lot. Yeah, as you said, I&#39;m still a first year Uni student and I&#39;m still not comfortable enough with Swing, specially with Paint Component but i have to finish my assignment for my professor so i really do need help."},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700015238,"post_id":77484818,"comment_id":136602231,"body_markdown":"@davidalayachew Ah, no no, this is because i edited to question. Actually i have another code that i wrote but because i feel like that one is even worse than the original so i edited my post.","body":"@davidalayachew Ah, no no, this is because i edited to question. Actually i have another code that i wrote but because i feel like that one is even worse than the original so i edited my post."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700015240,"post_id":77484818,"comment_id":136602232,"body_markdown":"np. One thing that would help -- in your screenshots, was the image with a bunch of dots created by the code snippet you pasted above? And if so, please also post the code for the one that created the lines. Or are you saying that you hand-drew that second screenshot?","body":"np. One thing that would help -- in your screenshots, was the image with a bunch of dots created by the code snippet you pasted above? And if so, please also post the code for the one that created the lines. Or are you saying that you hand-drew that second screenshot?"},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700015322,"post_id":77484818,"comment_id":136602240,"body_markdown":"Hmmmm, we may be talking past each other then. Please edit your question to include more detail about what you are looking for. Why didn&#39;t `drawLine` work for you?","body":"Hmmmm, we may be talking past each other then. Please edit your question to include more detail about what you are looking for. Why didn&#39;t <code>drawLine</code> work for you?"},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700015402,"post_id":77484818,"comment_id":136602246,"body_markdown":"Ah yeah, the image with a bunch of dots is created by the code snippet I pasted above. For the second screenshot, that&#39;s my goal. And it&#39;s my professor&#39; picture of his finished code. @davidalayachew","body":"Ah yeah, the image with a bunch of dots is created by the code snippet I pasted above. For the second screenshot, that&#39;s my goal. And it&#39;s my professor&#39; picture of his finished code. @davidalayachew"},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700015508,"post_id":77484818,"comment_id":136602257,"body_markdown":"Ok, then that is very easy to solve. You must do a call to `drawLine` connecting the current point in the `Vector` with the next point in the `Vector`. I would post a code example, but that would be giving you the entire answer. I thought your problem was much more complex.","body":"Ok, then that is very easy to solve. You must do a call to <code>drawLine</code> connecting the current point in the <code>Vector</code> with the next point in the <code>Vector</code>. I would post a code example, but that would be giving you the entire answer. I thought your problem was much more complex."},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700015605,"post_id":77484818,"comment_id":136602265,"body_markdown":"@davidalayachew Ah yeah, i tried that: \npublic void paintComponent(Graphics g) {\n            super.paintComponent(g);\n            for (int i = 0; i &lt; list.size() - 1; i++) {\n                Point p1 = list.get(i);\n                Point p2 = list.get(i + 1);\n                g.drawLine(p1.x, p1.y, p2.x, p2.y);  \n\t\t\t}\n        }\n    }\nBut the problem is after i did this, the lines are all connected so i cannot create another words.","body":"@davidalayachew Ah yeah, i tried that:  public void paintComponent(Graphics g) {             super.paintComponent(g);             for (int i = 0; i &lt; list.size() - 1; i++) {                 Point p1 = list.get(i);                 Point p2 = list.get(i + 1);                 g.drawLine(p1.x, p1.y, p2.x, p2.y);   \t\t\t}         }     } But the problem is after i did this, the lines are all connected so i cannot create another words."},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700015729,"post_id":77484818,"comment_id":136602278,"body_markdown":"@davidalayachew Also, the lines are too smooth so it didn&#39;t look like my professor&#39;s request so i didn&#39;t use it.","body":"@davidalayachew Also, the lines are too smooth so it didn&#39;t look like my professor&#39;s request so i didn&#39;t use it."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700015808,"post_id":77484818,"comment_id":136602285,"body_markdown":"Ah, so it was as complicated as I originally thought. Ok, smooth lines are likely not a problem. But connected, &quot;cursive-like&quot; words probably are. In that case, we will have to use *some* of that complicated stuff I talked about and then deleted. Post your snippet into the original post, and I will write an answer.","body":"Ah, so it was as complicated as I originally thought. Ok, smooth lines are likely not a problem. But connected, &quot;cursive-like&quot; words probably are. In that case, we will have to use <i>some</i> of that complicated stuff I talked about and then deleted. Post your snippet into the original post, and I will write an answer."},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700015985,"post_id":77484818,"comment_id":136602301,"body_markdown":"@davidalayachew yeah, i just edited it.","body":"@davidalayachew yeah, i just edited it."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700016224,"post_id":77484818,"comment_id":136602316,"body_markdown":"Ok, ty. And finally, just to confirm, can you explain the MouseListener part of your code? It looks like you are creating dots, and then trying to connect them. Why draw dots in the first place? Why not start by drawing lines? Is that just what your professor wants you to do for this assignment? Seems a little backwards to me.","body":"Ok, ty. And finally, just to confirm, can you explain the MouseListener part of your code? It looks like you are creating dots, and then trying to connect them. Why draw dots in the first place? Why not start by drawing lines? Is that just what your professor wants you to do for this assignment? Seems a little backwards to me."},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700016451,"post_id":77484818,"comment_id":136602334,"body_markdown":"@davidalayachew Uhm, yeah, the original code was provided by my professor and i have to fix it so it can match the second screen-shot.","body":"@davidalayachew Uhm, yeah, the original code was provided by my professor and i have to fix it so it can match the second screen-shot."},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700016621,"post_id":77484818,"comment_id":136602350,"body_markdown":"@davidalayachew Uhm, yeah, i can.","body":"@davidalayachew Uhm, yeah, i can."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700016625,"post_id":77484818,"comment_id":136602351,"body_markdown":"LOL, then you can swap out the Vector creation with drawLine. I don&#39;t know if your professor would be happy with that","body":"LOL, then you can swap out the Vector creation with drawLine. I don&#39;t know if your professor would be happy with that"},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700016671,"post_id":77484818,"comment_id":136602355,"body_markdown":"Doing it that way would be 4 lines of code to solve this entire problem lol","body":"Doing it that way would be 4 lines of code to solve this entire problem lol"},{"owner":{"account_id":44852,"reputation":322224,"user_id":131872,"accept_rate":100,"display_name":"camickr"},"score":0,"creation_date":1700016716,"post_id":77484818,"comment_id":136602360,"body_markdown":"If you want multiple distinct lines then you need a Vector of Vectors to contain the points for each line. See: https://stackoverflow.com/a/65327350/131872 for a basic example.","body":"If you want multiple distinct lines then you need a Vector of Vectors to contain the points for each line. See: <a href=\"https://stackoverflow.com/a/65327350/131872\">stackoverflow.com/a/65327350/131872</a> for a basic example."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700016818,"post_id":77484818,"comment_id":136602369,"body_markdown":"@camickr Yes, you and I are saying the exact same thing. However, the OP can avoid the Vector entirely, unless their assignment requires them to save the points too.","body":"@camickr Yes, you and I are saying the exact same thing. However, the OP can avoid the Vector entirely, unless their assignment requires them to save the points too."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700016913,"post_id":77484818,"comment_id":136602374,"body_markdown":"Deleting my answer since it is no longer relevant. After all, we can just use drawLine and get the solution","body":"Deleting my answer since it is no longer relevant. After all, we can just use drawLine and get the solution"},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700017123,"post_id":77484818,"comment_id":136602394,"body_markdown":"If you are having trouble visualizing it, lmk","body":"If you are having trouble visualizing it, lmk"},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700018905,"post_id":77484818,"comment_id":136602564,"body_markdown":"@Davidalayachew So you are saying that using drawLine would be a better solution for my problem? Then, is there a way to modify the lines too? Like to make them bigger or sth. Sorry, i just came to uni so i couldn&#39;t respond until now.","body":"@Davidalayachew So you are saying that using drawLine would be a better solution for my problem? Then, is there a way to modify the lines too? Like to make them bigger or sth. Sorry, i just came to uni so i couldn&#39;t respond until now."},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700018931,"post_id":77484818,"comment_id":136602567,"body_markdown":"@camickr Thanks for the example, i will try it that way.","body":"@camickr Thanks for the example, i will try it that way."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700019271,"post_id":77484818,"comment_id":136602605,"body_markdown":"No problem. Yes, that is exactly like what I am saying. I will write an answer anyways.","body":"No problem. Yes, that is exactly like what I am saying. I will write an answer anyways."},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700019482,"post_id":77484818,"comment_id":136602620,"body_markdown":"@davidalayachew Ohh, thanks. I will look at it after finishing my course.","body":"@davidalayachew Ohh, thanks. I will look at it after finishing my course."},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1700023342,"post_id":77484818,"comment_id":136602914,"body_markdown":"Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer.","body":"Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer."}],"answers":[{"comments":[{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700026076,"post_id":77485369,"comment_id":136603105,"body_markdown":"Hmm, it says something like the method add(Point) in the type Vector&lt;Point&gt; is not applicable for the arguments (java.awt.Point). And as a second thought, i think my professor will make us keep the class Point too i think.","body":"Hmm, it says something like the method add(Point) in the type Vector&lt;Point&gt; is not applicable for the arguments (java.awt.Point). And as a second thought, i think my professor will make us keep the class Point too i think."},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700028725,"post_id":77485369,"comment_id":136603338,"body_markdown":"Can you paste your first answer again? I want to look into it a little bit.","body":"Can you paste your first answer again? I want to look into it a little bit."},{"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"score":0,"creation_date":1700038799,"post_id":77485369,"comment_id":136604674,"body_markdown":"I have fixed my code like this and I think it&#39;s quite ok now but it still looks a bit different from the example, but i think this might be close what my prof requested so I just want to post to confirm a little bit:","body":"I have fixed my code like this and I think it&#39;s quite ok now but it still looks a bit different from the example, but i think this might be close what my prof requested so I just want to post to confirm a little bit:"},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1700269812,"post_id":77485369,"comment_id":136637771,"body_markdown":"Hello, sorry I missed your questions. Do you still have unresolved requests? As a fair warning, MadProgrammer is one of the experts on Swing, so their answer will by higher quaality than mine.","body":"Hello, sorry I missed your questions. Do you still have unresolved requests? As a fair warning, MadProgrammer is one of the experts on Swing, so their answer will by higher quaality than mine."}],"tags":[],"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"comment_count":4,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700024460,"creation_date":1700024460,"answer_id":77485369,"question_id":77484818,"body_markdown":"```java\r\nimport java.util.Vector;\r\nimport javax.swing.*;\r\n\r\nimport java.awt.*;\r\n\r\nimport java.awt.event.*;\r\n\r\n\r\npublic class MyPaintApp extends JFrame {\r\n   Vector&lt;Point&gt; list = new Vector&lt;&gt;();\r\n   Vector&lt;Vector&lt;Point&gt;&gt; list1 = new Vector&lt;&gt;();\r\n\r\n   class MyPanel extends JPanel {\r\n      public MyPanel() {\r\n      \r\n         final MouseAdapter mouseAdapter =\r\n            new MouseAdapter() {\r\n               public void mouseDragged(MouseEvent event) {\r\n                  repaint();\r\n                  list.add(event.getPoint());\r\n               }\r\n               public void mouseMoved(MouseEvent event) {\r\n                  repaint();\r\n               }\r\n               public void mouseReleased(MouseEvent event) {\r\n                  if (list.isEmpty()){\r\n                     return;\r\n                  }\r\n               \r\n                  list1.add(list);\r\n                  list = new Vector&lt;&gt;();\r\n                  repaint();\r\n               }\r\n            }\r\n            ;\r\n      \r\n         this.addMouseMotionListener(mouseAdapter);\r\n         this.addMouseListener(mouseAdapter);\r\n      }\r\n   \r\n      public void paintComponent(Graphics g) {\r\n         super.paintComponent(g);\r\n         for (final Vector&lt;Point&gt; listA : list1) {\r\n            for (int i = 0; i &lt; listA.size() - 1; i++) {\r\n               Point p1 = listA.get(i);\r\n               Point p2 = listA.get(i + 1);\r\n               g.drawLine(p1.x, p1.y, p2.x, p2.y);\r\n            }\r\n         }\r\n      }\r\n   }\r\n\r\n   @SuppressWarnings(&quot;this-escape&quot;)\r\n   public MyPaintApp() {\r\n      setSize(600, 450);\r\n      setLocation(400, 0);\r\n      setTitle(&quot;My Paint&quot;);\r\n      add(new MyPanel());\r\n      setVisible(true);\r\n      setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\r\n   }\r\n\r\n   public static void main(String[] args)\r\n   {\r\n   \r\n      new MyPaintApp();\r\n   \r\n   }\r\n\r\n}\r\n\r\n```\r\n\r\nIn this case, we don&#39;t even create any of the dots that you did. All we did is grab the point from the event using `MouseEvent.getPoint()`, then add it to our `Vector`. I also changed your `MouseMotionAdapter` to just be a plain `MouseAdapter`. Doing so gives us the `mouseMoved`, which I just used to reset our `Vector` and start a new one. Have to run, so I can answer questions when I get back.","title":"I want to create a simple Paint in Java","body":"<pre class=\"lang-java prettyprint-override\"><code>import java.util.Vector;\nimport javax.swing.*;\n\nimport java.awt.*;\n\nimport java.awt.event.*;\n\n\npublic class MyPaintApp extends JFrame {\n   Vector&lt;Point&gt; list = new Vector&lt;&gt;();\n   Vector&lt;Vector&lt;Point&gt;&gt; list1 = new Vector&lt;&gt;();\n\n   class MyPanel extends JPanel {\n      public MyPanel() {\n      \n         final MouseAdapter mouseAdapter =\n            new MouseAdapter() {\n               public void mouseDragged(MouseEvent event) {\n                  repaint();\n                  list.add(event.getPoint());\n               }\n               public void mouseMoved(MouseEvent event) {\n                  repaint();\n               }\n               public void mouseReleased(MouseEvent event) {\n                  if (list.isEmpty()){\n                     return;\n                  }\n               \n                  list1.add(list);\n                  list = new Vector&lt;&gt;();\n                  repaint();\n               }\n            }\n            ;\n      \n         this.addMouseMotionListener(mouseAdapter);\n         this.addMouseListener(mouseAdapter);\n      }\n   \n      public void paintComponent(Graphics g) {\n         super.paintComponent(g);\n         for (final Vector&lt;Point&gt; listA : list1) {\n            for (int i = 0; i &lt; listA.size() - 1; i++) {\n               Point p1 = listA.get(i);\n               Point p2 = listA.get(i + 1);\n               g.drawLine(p1.x, p1.y, p2.x, p2.y);\n            }\n         }\n      }\n   }\n\n   @SuppressWarnings(&quot;this-escape&quot;)\n   public MyPaintApp() {\n      setSize(600, 450);\n      setLocation(400, 0);\n      setTitle(&quot;My Paint&quot;);\n      add(new MyPanel());\n      setVisible(true);\n      setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n   }\n\n   public static void main(String[] args)\n   {\n   \n      new MyPaintApp();\n   \n   }\n\n}\n\n</code></pre>\n<p>In this case, we don't even create any of the dots that you did. All we did is grab the point from the event using <code>MouseEvent.getPoint()</code>, then add it to our <code>Vector</code>. I also changed your <code>MouseMotionAdapter</code> to just be a plain <code>MouseAdapter</code>. Doing so gives us the <code>mouseMoved</code>, which I just used to reset our <code>Vector</code> and start a new one. Have to run, so I can answer questions when I get back.</p>\n"},{"tags":[],"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"comment_count":0,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1700057428,"creation_date":1700038852,"answer_id":77486364,"question_id":77484818,"body_markdown":"```java\r\nimport java.awt.BasicStroke;\r\nimport java.awt.Graphics;\r\nimport java.awt.Graphics2D;\r\nimport java.awt.RenderingHints;\r\nimport java.awt.event.MouseAdapter;\r\nimport java.awt.event.MouseEvent;\r\nimport java.awt.event.MouseMotionAdapter;\r\nimport java.util.Vector;\r\n\r\nimport javax.swing.JFrame;\r\nimport javax.swing.JPanel;\r\n\r\nclass Point {\r\n\tint x, y;\r\n\r\n\tpublic Point(int x, int y) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n}\r\n\r\npublic class MyPaintApp extends JFrame {\r\n\tint x, y;\r\n\tVector&lt;Point&gt; list = new Vector&lt;&gt;();\r\n\tboolean isMousePressed = false;\r\n\r\n\tclass MyPanel extends JPanel {\r\n\t\tpublic MyPanel() {\r\n\t\t\taddMouseListener(new MouseAdapter() {\r\n\t\t\t\tpublic void mousePressed(MouseEvent event) {\r\n\t\t\t\t\tisMousePressed = true;\r\n\t\t\t\t\tx = event.getX();\r\n\t\t\t\t\ty = event.getY();\r\n\t\t\t\t\tlist.add(new Point(x, y));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tpublic void mouseReleased(MouseEvent event) {\r\n\t\t\t\t\tisMousePressed = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\taddMouseMotionListener(new MouseMotionAdapter() {\r\n\t\t\t\tpublic void mouseDragged(MouseEvent event) {\r\n\t\t\t\t\tif(isMousePressed) {\r\n\t\t\t\t\tx = event.getX();\r\n\t\t\t\t\ty = event.getY();\r\n\t\t\t\t\tlist.add(new Point(x, y));\r\n\t\t\t\t\trepaint();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tpublic void mouseMoved(MouseEvent event) {\r\n\t\t\t\t\tif(isMousePressed) {\r\n                    x = event.getX();\r\n\t\t\t\t\ty = event.getY();\r\n\t\t\t\t\tlist.add(new Point(x, y));\r\n                    repaint();\r\n\t\t\t\t\t}\r\n                }\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tpublic void paintComponent(Graphics g) {\r\n\r\n\t\t\tsuper.paintComponent(g);\r\n\r\n\t\t\tGraphics2D g2d = (Graphics2D) g;\r\n            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);\r\n\r\n            g2d.setStroke(new BasicStroke(2.0f)); \r\n\t\t\tfor (Point p : list)\r\n\t\t\t\tg.fillOval(p.x, p.y, 4, 4);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic MyPaintApp() {\r\n\t\tsetSize(600, 450);\r\n\t\tsetLocation(400, 0);\r\n\t\tsetTitle(&quot;My Paint&quot;);\r\n\t\tadd(new MyPanel());\r\n\t\tsetVisible(true);\r\n\t\tsetDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\r\n\t}\r\n}\r\n```","title":"I want to create a simple Paint in Java","body":"<pre class=\"lang-java prettyprint-override\"><code>import java.awt.BasicStroke;\nimport java.awt.Graphics;\nimport java.awt.Graphics2D;\nimport java.awt.RenderingHints;\nimport java.awt.event.MouseAdapter;\nimport java.awt.event.MouseEvent;\nimport java.awt.event.MouseMotionAdapter;\nimport java.util.Vector;\n\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\n\nclass Point {\n    int x, y;\n\n    public Point(int x, int y) {\n        this.x = x;\n        this.y = y;\n    }\n\n}\n\npublic class MyPaintApp extends JFrame {\n    int x, y;\n    Vector&lt;Point&gt; list = new Vector&lt;&gt;();\n    boolean isMousePressed = false;\n\n    class MyPanel extends JPanel {\n        public MyPanel() {\n            addMouseListener(new MouseAdapter() {\n                public void mousePressed(MouseEvent event) {\n                    isMousePressed = true;\n                    x = event.getX();\n                    y = event.getY();\n                    list.add(new Point(x, y));\n                }\n                \n                public void mouseReleased(MouseEvent event) {\n                    isMousePressed = false;\n                }\n            });\n            addMouseMotionListener(new MouseMotionAdapter() {\n                public void mouseDragged(MouseEvent event) {\n                    if(isMousePressed) {\n                    x = event.getX();\n                    y = event.getY();\n                    list.add(new Point(x, y));\n                    repaint();\n                    }\n                }\n                public void mouseMoved(MouseEvent event) {\n                    if(isMousePressed) {\n                    x = event.getX();\n                    y = event.getY();\n                    list.add(new Point(x, y));\n                    repaint();\n                    }\n                }\n            });\n            \n        }\n\n        public void paintComponent(Graphics g) {\n\n            super.paintComponent(g);\n\n            Graphics2D g2d = (Graphics2D) g;\n            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);\n\n            g2d.setStroke(new BasicStroke(2.0f)); \n            for (Point p : list)\n                g.fillOval(p.x, p.y, 4, 4);\n        }\n    }\n\n    public MyPaintApp() {\n        setSize(600, 450);\n        setLocation(400, 0);\n        setTitle(&quot;My Paint&quot;);\n        add(new MyPanel());\n        setVisible(true);\n        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":969721,"reputation":344527,"user_id":992484,"accept_rate":60,"display_name":"MadProgrammer"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1700040143,"creation_date":1700040143,"answer_id":77486490,"question_id":77484818,"body_markdown":"# Drag (multiple shapes)\r\n\r\n[![enter image description here][1]][1]\r\n\r\n    import java.awt.Dimension;\r\n    import java.awt.EventQueue;\r\n    import java.awt.Graphics;\r\n    import java.awt.Graphics2D;\r\n    import java.awt.Point;\r\n    import java.awt.event.MouseAdapter;\r\n    import java.awt.event.MouseEvent;\r\n    import java.util.ArrayList;\r\n    import java.util.List;\r\n    import javax.swing.JFrame;\r\n    import javax.swing.JPanel;\r\n\r\n    public class Main {\r\n        public static void main(String[] args) {\r\n            new Main();\r\n        }\r\n\r\n        public Main() {\r\n            EventQueue.invokeLater(new Runnable() {\r\n                @Override\r\n                public void run() {\r\n                    JFrame frame = new JFrame();\r\n                    frame.add(new MyPanel());\r\n                    frame.pack();\r\n                    frame.setLocationRelativeTo(null);\r\n                    frame.setVisible(true);\r\n                }\r\n            });\r\n        }\r\n\r\n        class MyPanel extends JPanel {\r\n            private List&lt;List&lt;Point&gt;&gt; shapes = new ArrayList&lt;&gt;(8);\r\n            private List&lt;Point&gt; currentShape;\r\n\r\n            public MyPanel() {\r\n                MouseAdapter handler = new MouseAdapter() {\r\n                    @Override\r\n                    public void mousePressed(MouseEvent e) {\r\n                        currentShape = new ArrayList&lt;&gt;(64);\r\n                    }\r\n\r\n                    @Override\r\n                    public void mouseReleased(MouseEvent e) {\r\n                        shapes.add(currentShape);\r\n                        currentShape = null;\r\n                    }\r\n\r\n                    @Override\r\n                    public void mouseDragged(MouseEvent e) {\r\n                        currentShape.add(new Point(e.getX(), e.getY()));\r\n                        repaint();\r\n                    }\r\n                };\r\n\r\n                addMouseMotionListener(handler);\r\n                addMouseListener(handler);\r\n            }\r\n\r\n            @Override\r\n            public Dimension getPreferredSize() {\r\n                return new Dimension(800, 600);\r\n            }\r\n\r\n            @Override\r\n            protected void paintComponent(Graphics g) {\r\n                Graphics2D g2d = (Graphics2D) g.create();\r\n                super.paintComponent(g2d);\r\n                for (List&lt;Point&gt; shape : shapes) {\r\n                    paintShape(shape, g2d);\r\n                }\r\n                if (currentShape != null) {\r\n                    paintShape(currentShape, g2d);\r\n                }\r\n                g2d.dispose();\r\n            }\r\n\r\n            protected void paintShape(List&lt;Point&gt; shape, Graphics2D g2d) {\r\n                Point from = null;\r\n                for (Point p : shape) {\r\n                    Point to = p;\r\n                    if (from != null) {\r\n                        g2d.drawLine(from.x, from.y, to.x, to.y);\r\n                    }\r\n                    from = to;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n# Connected lines\r\n\r\n[![enter image description here][2]][2]\r\n\r\n    import java.awt.Color;\r\n    import java.awt.Dimension;\r\n    import java.awt.EventQueue;\r\n    import java.awt.Graphics;\r\n    import java.awt.Graphics2D;\r\n    import java.awt.Point;\r\n    import java.awt.event.MouseAdapter;\r\n    import java.awt.event.MouseEvent;\r\n    import java.awt.geom.Line2D;\r\n    import java.util.ArrayList;\r\n    import java.util.List;\r\n    import javax.swing.JFrame;\r\n    import javax.swing.JPanel;\r\n\r\n    public class Main {\r\n        public static void main(String[] args) {\r\n            new Main();\r\n        }\r\n\r\n        public Main() {\r\n            EventQueue.invokeLater(new Runnable() {\r\n                @Override\r\n                public void run() {\r\n                    JFrame frame = new JFrame();\r\n                    frame.add(new MyPanel());\r\n                    frame.pack();\r\n                    frame.setLocationRelativeTo(null);\r\n                    frame.setVisible(true);\r\n                }\r\n            });\r\n        }\r\n\r\n        class MyPanel extends JPanel {\r\n            private List&lt;Line2D&gt; lines = new ArrayList&lt;&gt;(8);\r\n            private Line2D nextLine;\r\n\r\n            public MyPanel() {\r\n                MouseAdapter handler = new MouseAdapter() {\r\n                    @Override\r\n                    public void mouseClicked(MouseEvent e) {\r\n                        if (nextLine != null) {\r\n                            lines.add(nextLine);\r\n                        }\r\n                        nextLine = new Line2D.Double(e.getPoint(), e.getPoint());\r\n                        repaint();\r\n                    }\r\n\r\n                    @Override\r\n                    public void mouseMoved(MouseEvent e) {\r\n                        if (nextLine == null) {\r\n                            return;\r\n                        }\r\n                        nextLine.setLine(nextLine.getP1(), e.getPoint());\r\n                        repaint();\r\n                    }\r\n                };\r\n\r\n                addMouseListener(handler);\r\n                addMouseMotionListener(handler);\r\n            }\r\n\r\n            @Override\r\n            public Dimension getPreferredSize() {\r\n                return new Dimension(800, 600);\r\n            }\r\n\r\n            @Override\r\n            protected void paintComponent(Graphics g) {\r\n                Graphics2D g2d = (Graphics2D) g.create();\r\n                super.paintComponent(g2d);\r\n                for (Line2D line : lines) {\r\n                    g2d.draw(line);\r\n                }\r\n                if (nextLine != null) {\r\n                    g2d.setColor(Color.RED);\r\n                    g2d.draw(nextLine);\r\n                }\r\n                g2d.dispose();\r\n            }\r\n\r\n            protected void paintShape(List&lt;Point&gt; shape, Graphics2D g2d) {\r\n                Point from = null;\r\n                for (Point p : shape) {\r\n                    Point to = p;\r\n                    if (from != null) {\r\n                        g2d.drawLine(from.x, from.y, to.x, to.y);\r\n                    }\r\n                    from = to;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n# Disconnected lines\r\n\r\n[![enter image description here][3]][3]\r\n\r\n\r\n    import java.awt.Color;\r\n    import java.awt.Dimension;\r\n    import java.awt.EventQueue;\r\n    import java.awt.Graphics;\r\n    import java.awt.Graphics2D;\r\n    import java.awt.Point;\r\n    import java.awt.event.MouseAdapter;\r\n    import java.awt.event.MouseEvent;\r\n    import java.awt.geom.Line2D;\r\n    import java.util.ArrayList;\r\n    import java.util.List;\r\n    import javax.swing.JFrame;\r\n    import javax.swing.JPanel;\r\n\r\n    public class Main {\r\n        public static void main(String[] args) {\r\n            new Main();\r\n        }\r\n\r\n        public Main() {\r\n            EventQueue.invokeLater(new Runnable() {\r\n                @Override\r\n                public void run() {\r\n                    JFrame frame = new JFrame();\r\n                    frame.add(new MyPanel());\r\n                    frame.pack();\r\n                    frame.setLocationRelativeTo(null);\r\n                    frame.setVisible(true);\r\n                }\r\n            });\r\n        }\r\n\r\n        class MyPanel extends JPanel {\r\n            private List&lt;Line2D&gt; lines = new ArrayList&lt;&gt;(8);\r\n            private Line2D nextLine;\r\n\r\n            public MyPanel() {\r\n                MouseAdapter handler = new MouseAdapter() {\r\n                    @Override\r\n                    public void mouseClicked(MouseEvent e) {\r\n                        if (nextLine != null) {\r\n                            lines.add(nextLine);\r\n                            nextLine = null;\r\n                        } else {\r\n                            nextLine = new Line2D.Double(e.getPoint(), e.getPoint());\r\n                        }\r\n                        repaint();\r\n                    }\r\n\r\n                    @Override\r\n                    public void mouseMoved(MouseEvent e) {\r\n                        if (nextLine == null) {\r\n                            return;\r\n                        }\r\n                        nextLine.setLine(nextLine.getP1(), e.getPoint());\r\n                        repaint();\r\n                    }\r\n                };\r\n\r\n                addMouseListener(handler);\r\n                addMouseMotionListener(handler);\r\n            }\r\n\r\n            @Override\r\n            public Dimension getPreferredSize() {\r\n                return new Dimension(800, 600);\r\n            }\r\n\r\n            @Override\r\n            protected void paintComponent(Graphics g) {\r\n                Graphics2D g2d = (Graphics2D) g.create();\r\n                super.paintComponent(g2d);\r\n                for (Line2D line : lines) {\r\n                    g2d.draw(line);\r\n                }\r\n                if (nextLine != null) {\r\n                    g2d.setColor(Color.RED);\r\n                    g2d.draw(nextLine);\r\n                }\r\n                g2d.dispose();\r\n            }\r\n\r\n            protected void paintShape(List&lt;Point&gt; shape, Graphics2D g2d) {\r\n                Point from = null;\r\n                for (Point p : shape) {\r\n                    Point to = p;\r\n                    if (from != null) {\r\n                        g2d.drawLine(from.x, from.y, to.x, to.y);\r\n                    }\r\n                    from = to;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/EnWtb.png\r\n  [2]: https://i.stack.imgur.com/t5Mqj.png\r\n  [3]: https://i.stack.imgur.com/nZwJr.png\r\n\r\n# Some notes\r\n\r\n* Don&#39;t use `Vector`, use `ArrayList`, you probably won&#39;t notice it, but `ArrayList` will be faster\r\n* The Graphics 2D API already has a `Point` class, don&#39;t re-invent the wheel\r\n* The &quot;state&quot; information the panel uses to paint the contents should be relative to it (or provide via some kind of model)\r\n* `paintComponent` should be `protected`, there&#39;s no reason for anyone else to be calling it","title":"I want to create a simple Paint in Java","body":"<h1>Drag (multiple shapes)</h1>\n<p><a href=\"https://i.stack.imgur.com/EnWtb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EnWtb.png\" alt=\"enter image description here\" /></a></p>\n<pre><code>import java.awt.Dimension;\nimport java.awt.EventQueue;\nimport java.awt.Graphics;\nimport java.awt.Graphics2D;\nimport java.awt.Point;\nimport java.awt.event.MouseAdapter;\nimport java.awt.event.MouseEvent;\nimport java.util.ArrayList;\nimport java.util.List;\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\n\npublic class Main {\n    public static void main(String[] args) {\n        new Main();\n    }\n\n    public Main() {\n        EventQueue.invokeLater(new Runnable() {\n            @Override\n            public void run() {\n                JFrame frame = new JFrame();\n                frame.add(new MyPanel());\n                frame.pack();\n                frame.setLocationRelativeTo(null);\n                frame.setVisible(true);\n            }\n        });\n    }\n\n    class MyPanel extends JPanel {\n        private List&lt;List&lt;Point&gt;&gt; shapes = new ArrayList&lt;&gt;(8);\n        private List&lt;Point&gt; currentShape;\n\n        public MyPanel() {\n            MouseAdapter handler = new MouseAdapter() {\n                @Override\n                public void mousePressed(MouseEvent e) {\n                    currentShape = new ArrayList&lt;&gt;(64);\n                }\n\n                @Override\n                public void mouseReleased(MouseEvent e) {\n                    shapes.add(currentShape);\n                    currentShape = null;\n                }\n\n                @Override\n                public void mouseDragged(MouseEvent e) {\n                    currentShape.add(new Point(e.getX(), e.getY()));\n                    repaint();\n                }\n            };\n\n            addMouseMotionListener(handler);\n            addMouseListener(handler);\n        }\n\n        @Override\n        public Dimension getPreferredSize() {\n            return new Dimension(800, 600);\n        }\n\n        @Override\n        protected void paintComponent(Graphics g) {\n            Graphics2D g2d = (Graphics2D) g.create();\n            super.paintComponent(g2d);\n            for (List&lt;Point&gt; shape : shapes) {\n                paintShape(shape, g2d);\n            }\n            if (currentShape != null) {\n                paintShape(currentShape, g2d);\n            }\n            g2d.dispose();\n        }\n\n        protected void paintShape(List&lt;Point&gt; shape, Graphics2D g2d) {\n            Point from = null;\n            for (Point p : shape) {\n                Point to = p;\n                if (from != null) {\n                    g2d.drawLine(from.x, from.y, to.x, to.y);\n                }\n                from = to;\n            }\n        }\n    }\n}\n</code></pre>\n<h1>Connected lines</h1>\n<p><a href=\"https://i.stack.imgur.com/t5Mqj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t5Mqj.png\" alt=\"enter image description here\" /></a></p>\n<pre><code>import java.awt.Color;\nimport java.awt.Dimension;\nimport java.awt.EventQueue;\nimport java.awt.Graphics;\nimport java.awt.Graphics2D;\nimport java.awt.Point;\nimport java.awt.event.MouseAdapter;\nimport java.awt.event.MouseEvent;\nimport java.awt.geom.Line2D;\nimport java.util.ArrayList;\nimport java.util.List;\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\n\npublic class Main {\n    public static void main(String[] args) {\n        new Main();\n    }\n\n    public Main() {\n        EventQueue.invokeLater(new Runnable() {\n            @Override\n            public void run() {\n                JFrame frame = new JFrame();\n                frame.add(new MyPanel());\n                frame.pack();\n                frame.setLocationRelativeTo(null);\n                frame.setVisible(true);\n            }\n        });\n    }\n\n    class MyPanel extends JPanel {\n        private List&lt;Line2D&gt; lines = new ArrayList&lt;&gt;(8);\n        private Line2D nextLine;\n\n        public MyPanel() {\n            MouseAdapter handler = new MouseAdapter() {\n                @Override\n                public void mouseClicked(MouseEvent e) {\n                    if (nextLine != null) {\n                        lines.add(nextLine);\n                    }\n                    nextLine = new Line2D.Double(e.getPoint(), e.getPoint());\n                    repaint();\n                }\n\n                @Override\n                public void mouseMoved(MouseEvent e) {\n                    if (nextLine == null) {\n                        return;\n                    }\n                    nextLine.setLine(nextLine.getP1(), e.getPoint());\n                    repaint();\n                }\n            };\n\n            addMouseListener(handler);\n            addMouseMotionListener(handler);\n        }\n\n        @Override\n        public Dimension getPreferredSize() {\n            return new Dimension(800, 600);\n        }\n\n        @Override\n        protected void paintComponent(Graphics g) {\n            Graphics2D g2d = (Graphics2D) g.create();\n            super.paintComponent(g2d);\n            for (Line2D line : lines) {\n                g2d.draw(line);\n            }\n            if (nextLine != null) {\n                g2d.setColor(Color.RED);\n                g2d.draw(nextLine);\n            }\n            g2d.dispose();\n        }\n\n        protected void paintShape(List&lt;Point&gt; shape, Graphics2D g2d) {\n            Point from = null;\n            for (Point p : shape) {\n                Point to = p;\n                if (from != null) {\n                    g2d.drawLine(from.x, from.y, to.x, to.y);\n                }\n                from = to;\n            }\n        }\n    }\n}\n</code></pre>\n<h1>Disconnected lines</h1>\n<p><a href=\"https://i.stack.imgur.com/nZwJr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nZwJr.png\" alt=\"enter image description here\" /></a></p>\n<pre><code>import java.awt.Color;\nimport java.awt.Dimension;\nimport java.awt.EventQueue;\nimport java.awt.Graphics;\nimport java.awt.Graphics2D;\nimport java.awt.Point;\nimport java.awt.event.MouseAdapter;\nimport java.awt.event.MouseEvent;\nimport java.awt.geom.Line2D;\nimport java.util.ArrayList;\nimport java.util.List;\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\n\npublic class Main {\n    public static void main(String[] args) {\n        new Main();\n    }\n\n    public Main() {\n        EventQueue.invokeLater(new Runnable() {\n            @Override\n            public void run() {\n                JFrame frame = new JFrame();\n                frame.add(new MyPanel());\n                frame.pack();\n                frame.setLocationRelativeTo(null);\n                frame.setVisible(true);\n            }\n        });\n    }\n\n    class MyPanel extends JPanel {\n        private List&lt;Line2D&gt; lines = new ArrayList&lt;&gt;(8);\n        private Line2D nextLine;\n\n        public MyPanel() {\n            MouseAdapter handler = new MouseAdapter() {\n                @Override\n                public void mouseClicked(MouseEvent e) {\n                    if (nextLine != null) {\n                        lines.add(nextLine);\n                        nextLine = null;\n                    } else {\n                        nextLine = new Line2D.Double(e.getPoint(), e.getPoint());\n                    }\n                    repaint();\n                }\n\n                @Override\n                public void mouseMoved(MouseEvent e) {\n                    if (nextLine == null) {\n                        return;\n                    }\n                    nextLine.setLine(nextLine.getP1(), e.getPoint());\n                    repaint();\n                }\n            };\n\n            addMouseListener(handler);\n            addMouseMotionListener(handler);\n        }\n\n        @Override\n        public Dimension getPreferredSize() {\n            return new Dimension(800, 600);\n        }\n\n        @Override\n        protected void paintComponent(Graphics g) {\n            Graphics2D g2d = (Graphics2D) g.create();\n            super.paintComponent(g2d);\n            for (Line2D line : lines) {\n                g2d.draw(line);\n            }\n            if (nextLine != null) {\n                g2d.setColor(Color.RED);\n                g2d.draw(nextLine);\n            }\n            g2d.dispose();\n        }\n\n        protected void paintShape(List&lt;Point&gt; shape, Graphics2D g2d) {\n            Point from = null;\n            for (Point p : shape) {\n                Point to = p;\n                if (from != null) {\n                    g2d.drawLine(from.x, from.y, to.x, to.y);\n                }\n                from = to;\n            }\n        }\n    }\n}\n</code></pre>\n<h1>Some notes</h1>\n<ul>\n<li>Don't use <code>Vector</code>, use <code>ArrayList</code>, you probably won't notice it, but <code>ArrayList</code> will be faster</li>\n<li>The Graphics 2D API already has a <code>Point</code> class, don't re-invent the wheel</li>\n<li>The &quot;state&quot; information the panel uses to paint the contents should be relative to it (or provide via some kind of model)</li>\n<li><code>paintComponent</code> should be <code>protected</code>, there's no reason for anyone else to be calling it</li>\n</ul>\n"}],"owner":{"account_id":29650914,"reputation":11,"user_id":22724828,"display_name":"Hưng Nguyễn Th&#224;nh"},"comment_count":27,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":122,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":3,"score":1,"last_activity_date":1700057428,"creation_date":1700013432,"question_id":77484818,"body_markdown":"I want to modify the program to connect the series of dots that make up one stroke of a letter with a straight line so that words can be drawn but i don&#39;t really have a idea of how to do it so i want some references. I tried to draw them using drawLine but it&#39;s not what i really wanted. \r\n\r\n[![https://i.stack.imgur.com/1MZpB.png][1]][1]\r\n\r\nThis is my code:\r\n\r\n```\r\npackage tool;\r\nimport java.awt.Graphics;\r\nimport java.awt.event.MouseEvent;\r\nimport java.awt.event.MouseMotionAdapter;\r\nimport java.util.Vector;\r\n\r\nimport javax.swing.JFrame;\r\nimport javax.swing.JPanel;\r\n\r\nclass Point {\r\n\tint x, y;\r\n\r\n\tpublic Point(int x, int y) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n}\r\n\r\npublic class MyPaintApp extends JFrame {\r\n\tint x, y;\r\n\tVector&lt;Point&gt; list = new Vector&lt;&gt;();\r\n\r\n\tclass MyPanel extends JPanel {\r\n\t\tpublic MyPanel() {\r\n\t\t\taddMouseMotionListener(new MouseMotionAdapter() {\r\n\t\t\t\tpublic void mouseDragged(MouseEvent event) {\r\n\t\t\t\t\tx = event.getX();\r\n\t\t\t\t\ty = event.getY();\r\n\t\t\t\t\tlist.add(new Point(x, y));\r\n\t\t\t\t\trepaint();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tpublic void paintComponent(Graphics g) {\r\n\r\n\t\t\tsuper.paintComponent(g);\r\n\t\t\tfor (Point p : list)\r\n\t\t\t\tg.fillOval(p.x, p.y, 4, 4);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic MyPaintApp() {\r\n\t\tsetSize(600, 450);\r\n\t\tsetLocation(400, 0);\r\n\t\tsetTitle(&quot;My Paint&quot;);\r\n\t\tadd(new MyPanel());\r\n\t\tsetVisible(true);\r\n\t\tsetDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\r\n\t}\r\n}\r\n```\r\n```\r\nimport java.awt.Graphics;\r\nimport java.awt.event.MouseEvent;\r\nimport java.awt.event.MouseMotionAdapter;\r\nimport java.util.Vector;\r\n\r\nimport javax.swing.JFrame;\r\nimport javax.swing.JPanel;\r\n\r\nclass Point {\r\n\tint x, y;\r\n\r\n\tpublic Point(int x, int y) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n}\r\n\r\npublic class MyPaintApp extends JFrame {\r\n\tint x, y;\r\n\tVector&lt;Point&gt; list = new Vector&lt;&gt;();\r\n\tVector&lt;Vector&lt;Point&gt;&gt; list1 = new Vector&lt;&gt;();\r\n\r\n\tclass MyPanel extends JPanel {\r\n\t\tpublic MyPanel() {\r\n\t\t\taddMouseMotionListener(new MouseMotionAdapter() {\r\n\t\t\t\tpublic void mouseDragged(MouseEvent event) {\r\n\t\t\t\t\tx = event.getX();\r\n\t\t\t\t\ty = event.getY();\r\n\t\t\t\t\tlist.add(new Point(x, y));\r\n\t\t\t\t\trepaint();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tpublic void paintComponent(Graphics g) {\r\n            super.paintComponent(g);\r\n            for (int i = 0; i &lt; list.size() - 1; i++) {\r\n                Point p1 = list.get(i);\r\n                Point p2 = list.get(i + 1);\r\n                g.drawLine(p1.x, p1.y, p2.x, p2.y);  \r\n\t\t\t}\r\n        }\r\n    }\r\n\r\n\tpublic MyPaintApp() {\r\n\t\tsetSize(600, 450);\r\n\t\tsetLocation(400, 0);\r\n\t\tsetTitle(&quot;My Paint&quot;);\r\n\t\tadd(new MyPanel());\r\n\t\tsetVisible(true);\r\n\t\tsetDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\r\n\t}\r\n}\r\n```\r\n    \r\n\r\n\r\n  [1]: https://i.stack.imgur.com/1MZpB.png","title":"I want to create a simple Paint in Java","body":"<p>I want to modify the program to connect the series of dots that make up one stroke of a letter with a straight line so that words can be drawn but i don't really have a idea of how to do it so i want some references. I tried to draw them using drawLine but it's not what i really wanted.</p>\n<p><a href=\"https://i.stack.imgur.com/1MZpB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1MZpB.png\" alt=\"https://i.stack.imgur.com/1MZpB.png\" /></a></p>\n<p>This is my code:</p>\n<pre><code>package tool;\nimport java.awt.Graphics;\nimport java.awt.event.MouseEvent;\nimport java.awt.event.MouseMotionAdapter;\nimport java.util.Vector;\n\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\n\nclass Point {\n    int x, y;\n\n    public Point(int x, int y) {\n        this.x = x;\n        this.y = y;\n    }\n\n}\n\npublic class MyPaintApp extends JFrame {\n    int x, y;\n    Vector&lt;Point&gt; list = new Vector&lt;&gt;();\n\n    class MyPanel extends JPanel {\n        public MyPanel() {\n            addMouseMotionListener(new MouseMotionAdapter() {\n                public void mouseDragged(MouseEvent event) {\n                    x = event.getX();\n                    y = event.getY();\n                    list.add(new Point(x, y));\n                    repaint();\n                }\n            });\n        }\n\n        public void paintComponent(Graphics g) {\n\n            super.paintComponent(g);\n            for (Point p : list)\n                g.fillOval(p.x, p.y, 4, 4);\n        }\n    }\n\n    public MyPaintApp() {\n        setSize(600, 450);\n        setLocation(400, 0);\n        setTitle(&quot;My Paint&quot;);\n        add(new MyPanel());\n        setVisible(true);\n        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n    }\n}\n</code></pre>\n<pre><code>import java.awt.Graphics;\nimport java.awt.event.MouseEvent;\nimport java.awt.event.MouseMotionAdapter;\nimport java.util.Vector;\n\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\n\nclass Point {\n    int x, y;\n\n    public Point(int x, int y) {\n        this.x = x;\n        this.y = y;\n    }\n\n}\n\npublic class MyPaintApp extends JFrame {\n    int x, y;\n    Vector&lt;Point&gt; list = new Vector&lt;&gt;();\n    Vector&lt;Vector&lt;Point&gt;&gt; list1 = new Vector&lt;&gt;();\n\n    class MyPanel extends JPanel {\n        public MyPanel() {\n            addMouseMotionListener(new MouseMotionAdapter() {\n                public void mouseDragged(MouseEvent event) {\n                    x = event.getX();\n                    y = event.getY();\n                    list.add(new Point(x, y));\n                    repaint();\n                }\n            });\n        }\n\n        public void paintComponent(Graphics g) {\n            super.paintComponent(g);\n            for (int i = 0; i &lt; list.size() - 1; i++) {\n                Point p1 = list.get(i);\n                Point p2 = list.get(i + 1);\n                g.drawLine(p1.x, p1.y, p2.x, p2.y);  \n            }\n        }\n    }\n\n    public MyPaintApp() {\n        setSize(600, 450);\n        setLocation(400, 0);\n        setTitle(&quot;My Paint&quot;);\n        add(new MyPanel());\n        setVisible(true);\n        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n    }\n}\n</code></pre>\n"},{"tags":["java","spring","spring-boot","sockets","stomp"],"comments":[{"owner":{"account_id":21222460,"reputation":326,"user_id":15608713,"display_name":"i_m_js"},"score":0,"creation_date":1697611467,"post_id":77295121,"comment_id":136299949,"body_markdown":"can you set log-level to debug and check the exception stack-trace","body":"can you set log-level to debug and check the exception stack-trace"},{"owner":{"account_id":20537440,"reputation":253,"user_id":15073157,"display_name":"thebluepandabear"},"score":0,"creation_date":1697689232,"post_id":77295121,"comment_id":136312040,"body_markdown":"@i_m_js Ok done","body":"@i_m_js Ok done"},{"owner":{"account_id":11377012,"reputation":12772,"user_id":8340997,"display_name":"Anish B."},"score":0,"creation_date":1697697434,"post_id":77295121,"comment_id":136312876,"body_markdown":"Are you using this org.apache.tomcat.util anywhere in your code? I see class not found exception in the logs that you have provided.","body":"Are you using this org.apache.tomcat.util anywhere in your code? I see class not found exception in the logs that you have provided."},{"owner":{"account_id":11377012,"reputation":12772,"user_id":8340997,"display_name":"Anish B."},"score":0,"creation_date":1697697525,"post_id":77295121,"comment_id":136312888,"body_markdown":"Can you provide your codebase via github to fix the issue quickly.","body":"Can you provide your codebase via github to fix the issue quickly."}],"answers":[{"comments":[{"owner":{"account_id":20537440,"reputation":253,"user_id":15073157,"display_name":"thebluepandabear"},"score":0,"creation_date":1697933547,"post_id":77329186,"comment_id":136341705,"body_markdown":"Still not working","body":"Still not working"},{"owner":{"account_id":8884226,"reputation":514,"user_id":6633045,"display_name":"phuongnq1995"},"score":0,"creation_date":1697960053,"post_id":77329186,"comment_id":136343028,"body_markdown":"@thebluepandabear And make sure that you&#39;re allowing cors and security for path `/ws` because there are some http call for checking socket info.","body":"@thebluepandabear And make sure that you&#39;re allowing cors and security for path <code>&#47;ws</code> because there are some http call for checking socket info."}],"tags":[],"owner":{"account_id":8884226,"reputation":514,"user_id":6633045,"display_name":"phuongnq1995"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1697960182,"creation_date":1697788282,"answer_id":77329186,"question_id":77295121,"body_markdown":"You are configuring `registry.setApplicationDestinationPrefixes(&quot;/app&quot;);` This means topics have to include the prefix `/app`.\r\nInstead of \r\n```\r\nclient.send(&#39;/chat.addUser&#39;, {}, JSON.stringify({ content: &#39;&#39;, sender: props.username, type: &#39;JOIN&#39; }))\r\nstompClient.send(&#39;/chat.sendMessage&#39;, {}, JSON.stringify(chatMessage))\r\n```\r\nTry this \r\n```\r\nclient.send(&#39;/app/chat.addUser&#39;, {}, JSON.stringify({ content: &#39;&#39;, sender: props.username, type: &#39;JOIN&#39; }))\r\nstompClient.send(&#39;/app/chat.sendMessage&#39;, {}, JSON.stringify(chatMessage))\r\n```\r\nThis is the definition in spring [doc](https://docs.spring.io/spring-framework/docs/4.0.1.RELEASE_to_4.0.2.RELEASE/Spring%20Framework%204.0.1.RELEASE/org/springframework/messaging/simp/config/MessageBrokerRegistry.html)\r\n&gt; Configure one or more prefixes to filter destinations targeting\r\n&gt; application annotated methods. For example destinations prefixed with\r\n&gt; &quot;/app&quot; may be processed by annotated methods while other destinations\r\n&gt; may target the message broker (e.g. &quot;/topic&quot;, &quot;/queue&quot;). When messages\r\n&gt; are processed, the matching prefix is removed from the destination in\r\n&gt; order to form the lookup path. This means annotations should not\r\n&gt; contain the destination prefix.\r\n&gt; \r\n&gt; Prefixes that do not have a trailing slash will have one automatically\r\n&gt; appended.\r\n\r\nAlso make sure that you&#39;re allowing `cors` and security permission for path `/ws` because there is http call for checking socket info.\r\n\r\nI hope it helps.","title":"SocketJS + Spring Boot &gt; Uncaught Error: InvalidStateError: The connection has not been established yet","body":"<p>You are configuring <code>registry.setApplicationDestinationPrefixes(&quot;/app&quot;);</code> This means topics have to include the prefix <code>/app</code>.\nInstead of</p>\n<pre><code>client.send('/chat.addUser', {}, JSON.stringify({ content: '', sender: props.username, type: 'JOIN' }))\nstompClient.send('/chat.sendMessage', {}, JSON.stringify(chatMessage))\n</code></pre>\n<p>Try this</p>\n<pre><code>client.send('/app/chat.addUser', {}, JSON.stringify({ content: '', sender: props.username, type: 'JOIN' }))\nstompClient.send('/app/chat.sendMessage', {}, JSON.stringify(chatMessage))\n</code></pre>\n<p>This is the definition in spring <a href=\"https://docs.spring.io/spring-framework/docs/4.0.1.RELEASE_to_4.0.2.RELEASE/Spring%20Framework%204.0.1.RELEASE/org/springframework/messaging/simp/config/MessageBrokerRegistry.html\" rel=\"nofollow noreferrer\">doc</a></p>\n<blockquote>\n<p>Configure one or more prefixes to filter destinations targeting\napplication annotated methods. For example destinations prefixed with\n&quot;/app&quot; may be processed by annotated methods while other destinations\nmay target the message broker (e.g. &quot;/topic&quot;, &quot;/queue&quot;). When messages\nare processed, the matching prefix is removed from the destination in\norder to form the lookup path. This means annotations should not\ncontain the destination prefix.</p>\n<p>Prefixes that do not have a trailing slash will have one automatically\nappended.</p>\n</blockquote>\n<p>Also make sure that you're allowing <code>cors</code> and security permission for path <code>/ws</code> because there is http call for checking socket info.</p>\n<p>I hope it helps.</p>\n"},{"tags":[],"owner":{"account_id":3535009,"reputation":387,"user_id":2953547,"display_name":"Jordi"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1697971294,"creation_date":1697970368,"answer_id":77339549,"question_id":77295121,"body_markdown":"As a starting point, i would suggest you to read the official Stompjs guide page, and avoid SockJs as it states here, because it generates more problems than it solves:\r\n\r\n&gt; In reality, there is very little chance that you need SockJS. Unless you know, for sure, you do not need SockJS.\r\n\r\n [Stomp-js docs][1]\r\n\r\nSo, in your spring config file, you can remove the &quot;.withSockJS();&quot; part. The rest of the config looks fine.\r\n\r\nYou can create the websocket client on front end, directly from Stompjs, like that:\r\n\r\n    import { Client } from &#39;@stomp/stompjs&#39;;\r\n\r\n    const newClient = new Client({\r\n      // Remember Stomp goes over WS protocol, not on HTTP like SockJs\r\n      brokerURL: &quot;ws://localhost:8080/ws&quot;, \r\n\r\n      // Optional configurations\r\n      connectHeaders: {\r\n        login: &quot;yyy&quot;,\r\n        passcode: &quot;xxx&quot;\r\n      },\r\n      debug: function (str) {\r\n        console.log(str);\r\n      },\r\n      reconnectDelay: 5000,\r\n      heartbeatIncoming: 4000,\r\n      heartbeatOutgoing: 4000,\r\n\r\n      // Custom onConnect function (whatever you like, useState, etc.)\r\n      onConnect: () =&gt; setConnected(true),\r\n\r\n      onStompError: (frame) =&gt; {\r\n        console.log(&#39;Broker reported error: &#39; + frame.headers[&#39;message&#39;]);\r\n        console.log(&#39;Additional details: &#39; + frame.body);\r\n      },\r\n      onWebSocketError: (it) =&gt; {\r\n        console.log(JSON.stringify(it));\r\n      }\r\n    });\r\n    \r\n    newClient.activate();\r\n\r\nOther functions (subscribe, unsubscribe, publish, deactivate) are pretty straight forward.\r\n\r\n(I strongly suggest you to use a React Context for the websocket operations, and be really aware where/when do you connect/disconnect,  if you want to avoid multiple socket connections per user nightmare)\r\n\r\nThe connectivity problem should still keep going with this changes, in my opinion, you should first test, that socket is connecting correctly without doing anything else.\r\n\r\nI would remove the &quot;client.send&quot; and &quot;client.subscribe&quot; that you have in your onConnect function, and I would see if simple connection is working.\r\n\r\nCheck on your front-end dev-tools if, on network section, requests to /ws are successful or not. If not, provide also front-end logs or network requests statuses.\r\n\r\n  [1]: https://stomp-js.github.io/guide/stompjs/rx-stomp/using-stomp-with-sockjs.html#do-you-need-sockjs","title":"SocketJS + Spring Boot &gt; Uncaught Error: InvalidStateError: The connection has not been established yet","body":"<p>As a starting point, i would suggest you to read the official Stompjs guide page, and avoid SockJs as it states here, because it generates more problems than it solves:</p>\n<blockquote>\n<p>In reality, there is very little chance that you need SockJS. Unless you know, for sure, you do not need SockJS.</p>\n</blockquote>\n<p><a href=\"https://stomp-js.github.io/guide/stompjs/rx-stomp/using-stomp-with-sockjs.html#do-you-need-sockjs\" rel=\"nofollow noreferrer\">Stomp-js docs</a></p>\n<p>So, in your spring config file, you can remove the &quot;.withSockJS();&quot; part. The rest of the config looks fine.</p>\n<p>You can create the websocket client on front end, directly from Stompjs, like that:</p>\n<pre><code>import { Client } from '@stomp/stompjs';\n\nconst newClient = new Client({\n  // Remember Stomp goes over WS protocol, not on HTTP like SockJs\n  brokerURL: &quot;ws://localhost:8080/ws&quot;, \n\n  // Optional configurations\n  connectHeaders: {\n    login: &quot;yyy&quot;,\n    passcode: &quot;xxx&quot;\n  },\n  debug: function (str) {\n    console.log(str);\n  },\n  reconnectDelay: 5000,\n  heartbeatIncoming: 4000,\n  heartbeatOutgoing: 4000,\n\n  // Custom onConnect function (whatever you like, useState, etc.)\n  onConnect: () =&gt; setConnected(true),\n\n  onStompError: (frame) =&gt; {\n    console.log('Broker reported error: ' + frame.headers['message']);\n    console.log('Additional details: ' + frame.body);\n  },\n  onWebSocketError: (it) =&gt; {\n    console.log(JSON.stringify(it));\n  }\n});\n\nnewClient.activate();\n</code></pre>\n<p>Other functions (subscribe, unsubscribe, publish, deactivate) are pretty straight forward.</p>\n<p>(I strongly suggest you to use a React Context for the websocket operations, and be really aware where/when do you connect/disconnect,  if you want to avoid multiple socket connections per user nightmare)</p>\n<p>The connectivity problem should still keep going with this changes, in my opinion, you should first test, that socket is connecting correctly without doing anything else.</p>\n<p>I would remove the &quot;client.send&quot; and &quot;client.subscribe&quot; that you have in your onConnect function, and I would see if simple connection is working.</p>\n<p>Check on your front-end dev-tools if, on network section, requests to /ws are successful or not. If not, provide also front-end logs or network requests statuses.</p>\n"}],"owner":{"account_id":20537440,"reputation":253,"user_id":15073157,"display_name":"thebluepandabear"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":215,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1700057306,"creation_date":1697336798,"question_id":77295121,"body_markdown":"I&#39;m creating a SocketJS (that uses STOMP) app with Spring Boot, and I keep getting this error whenever my app starts:\r\n\r\n```\r\ncaught Error: InvalidStateError: The connection has not been established yet\r\n    at SockJS.send (main.js:161:1)\r\n    at Client._transmit (stomp.js:159:1)\r\n    at Client.disconnect (stomp.js:341:1)\r\n    at ChatRoom.tsx:37:1\r\n    at safelyCallDestroy (react-dom.development.js:22932:1)\r\n    at commitHookEffectListUnmount (react-dom.development.js:23100:1)\r\n    at invokePassiveEffectUnmountInDEV (react-dom.development.js:25207:1)\r\n    at invokeEffectsInDev (react-dom.development.js:27351:1)\r\n    at commitDoubleInvokeEffectsInDEV (react-dom.development.js:27324:1)\r\n    at flushPassiveEffectsImpl (react-dom.development.js:27056:1)\r\nS\r\n```\r\n\r\nThen, on the backend I get this error:\r\n\r\n```\r\n WebSocketSession[2 current WS(2)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 16, active threads = 0, queued tasks = 0, completed tasks = 18], outboundChannel[pool size = 2, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 8, active threads = 1, queued tasks = 3, completed tasks = 9]\r\n2023-10-15T15:13:35.507+13:00 ERROR 10628 --- [nio-8080-exec-9] o.s.w.s.m.StompSubProtocolHandler        : Error publishing SessionDisconnectEvent[sessionId=stpnlchb, CloseStatus[code=1000, reason=null]]\r\n```\r\n\r\nFront-end React code:\r\n\r\n```TypeScript\r\nimport { Button, Flex, Input, Text } from &quot;@chakra-ui/react&quot;;\r\nimport { Suspense, useEffect, useState } from &quot;react&quot;;\r\nimport SockJS from &quot;sockjs-client&quot;;\r\nimport { Client, Message, over } from &quot;stompjs&quot;;\r\n\r\ninterface ChatMessage {\r\n    content: string\r\n    sender: string\r\n    type: &#39;CHAT&#39; | &#39;JOIN&#39; | &#39;LEAVE&#39;\r\n}\r\n\r\ninterface ChatRoomProps {\r\n    username: string\r\n}\r\n\r\nexport default function ChatRoom(props: ChatRoomProps) {\r\n    const [loading, setIsLoading] = useState(true)\r\n    const [error, setError] = useState(false)\r\n    const [message, setMessage] = useState&lt;string | null&gt;(null)\r\n    const [messageStream, setMessageStream] = useState&lt;ChatMessage[]&gt;([])\r\n    const [stompClient, setStompClient] = useState&lt;Client | null&gt;(null)\r\n\r\n    useEffect(() =&gt; {\r\n        const socket = new SockJS(&#39;http://localhost:8080/ws&#39;)\r\n        const client: Client = over(socket)\r\n\r\n        client.connect({}, () =&gt; {\r\n            client.send(&#39;/chat.addUser&#39;, {}, JSON.stringify({ content: &#39;&#39;, sender: props.username, type: &#39;JOIN&#39; }))\r\n            client.subscribe(&#39;/topic/public&#39;, messageReceivedCallbackHandler)\r\n\r\n            setIsLoading(false)\r\n        }, errorCallbackHandler)\r\n\r\n        setStompClient(client)\r\n\r\n        return () =&gt; {\r\n            socket.close()\r\n            client.disconnect(() =&gt; {})\r\n        }\r\n    }, [])\r\n\r\n    function messageReceivedCallbackHandler(payload: Message): void {\r\n        const message: ChatMessage = JSON.parse(payload.body)\r\n\r\n        setMessageStream(prevMessageStream =&gt; [...prevMessageStream, message])\r\n    }\r\n\r\n    function errorCallbackHandler(): void {\r\n        setError(true)\r\n    }\r\n\r\n    function messageChangeHandler(e: React.ChangeEvent&lt;HTMLInputElement&gt;): void {\r\n        setMessage(e.target.value)\r\n    }\r\n\r\n    function sendClickHandler(): void {\r\n        if (message &amp;&amp; stompClient) {\r\n            const chatMessage: ChatMessage = {\r\n                content: message,\r\n                sender: props.username,\r\n                type: &#39;CHAT&#39;\r\n            }\r\n\r\n            stompClient.send(&#39;/chat.sendMessage&#39;, {}, JSON.stringify(chatMessage))\r\n\r\n            setMessage(null)\r\n            \r\n            const inputElement = document.getElementById(&#39;msg-input&#39;) as HTMLInputElement\r\n            inputElement.value = &#39;&#39;\r\n        }\r\n    }\r\n\r\n    return (\r\n        &lt;Flex\r\n            width=&#39;750px&#39;\r\n            height=&#39;750px&#39;\r\n            flexDirection=&#39;column&#39;\r\n            gap=&#39;16px&#39;\r\n            background=&#39;white&#39;\r\n            alignItems=&#39;center&#39;\r\n            padding=&#39;42px&#39;\r\n            overflow=&#39;clip&#39;\r\n        &gt;\r\n            &lt;Text fontSize=&#39;lg&#39; fontWeight=&#39;bold&#39;&gt;Spring WebSocket Chat Demo - By Alibou&lt;/Text&gt;\r\n\r\n            {error &amp;&amp; &lt;Text&gt;Error connecting to server&lt;/Text&gt;}\r\n\r\n            {loading ? &lt;Text&gt;Loading...&lt;/Text&gt; : (\r\n                &lt;Flex flexDirection=&#39;column&#39; textAlign=&#39;center&#39; overflowY=&#39;scroll&#39; width=&#39;100%&#39;&gt;\r\n                    {messageStream.map((message, index) =&gt; (\r\n                        &lt;&gt;\r\n                            {message.type === &#39;CHAT&#39; &amp;&amp; &lt;Text key={index}&gt;&lt;b&gt;{message.sender}&lt;/b&gt;: {message.content}&lt;/Text&gt;}\r\n                            {message.type === &#39;JOIN&#39; &amp;&amp; &lt;Text key={index}&gt;&lt;b&gt;{message.sender}&lt;/b&gt; joined&lt;/Text&gt;}\r\n                            {message.type === &#39;LEAVE&#39; &amp;&amp; &lt;Text key={index}&gt;&lt;b&gt;{message.sender}&lt;/b&gt; left&lt;/Text&gt;}\r\n                        &lt;/&gt;\r\n                    ))}\r\n                &lt;/Flex&gt;\r\n            )}\r\n\r\n\r\n            &lt;Flex marginTop=&#39;auto&#39; width=&#39;100%&#39; gap=&#39;16px&#39;&gt;\r\n                &lt;Input id=&#39;msg-input&#39; placeholder=&#39;Type a message&#39; marginTop=&#39;auto&#39; onChange={messageChangeHandler} /&gt;\r\n                \r\n                &lt;Button colorScheme=&#39;blue&#39; onClick={sendClickHandler}&gt;Send&lt;/Button&gt;\r\n            &lt;/Flex&gt;\r\n        &lt;/Flex&gt;\r\n    )\r\n} \r\n```\r\n\r\nJava backend:\r\n\r\n```Java\r\npackage com.example.socket.controller;\r\n\r\nimport com.example.socket.controller.model.ChatMessage;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.messaging.handler.annotation.MessageMapping;\r\nimport org.springframework.messaging.handler.annotation.Payload;\r\nimport org.springframework.messaging.handler.annotation.SendTo;\r\nimport org.springframework.messaging.simp.SimpMessageHeaderAccessor;\r\nimport org.springframework.web.bind.annotation.RestController;\r\n\r\nimport java.util.Objects;\r\n\r\n@RestController\r\n@Slf4j\r\npublic class ChatController {\r\n\r\n    @MessageMapping(&quot;/chat.sendMessage&quot;)\r\n    @SendTo(&quot;/topic/public&quot;)\r\n    public ChatMessage sendMessage(@Payload ChatMessage chatMessage) {\r\n        return chatMessage;\r\n    }\r\n\r\n    @MessageMapping(&quot;/chat.addUser&quot;)\r\n    @SendTo(&quot;/topic/public&quot;)\r\n    public ChatMessage addUser(\r\n        @Payload ChatMessage chatMessage,\r\n        SimpMessageHeaderAccessor headerAccessor\r\n    ) {\r\n        Objects.requireNonNull(headerAccessor.getSessionAttributes()).put(&quot;username&quot;, chatMessage.getSender());\r\n\r\n        return chatMessage;\r\n    }\r\n}\r\n```\r\n\r\n```Java\r\npackage com.example.socket.config;\r\n\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.messaging.simp.config.MessageBrokerRegistry;\r\nimport org.springframework.web.socket.config.annotation.EnableWebSocketMessageBroker;\r\nimport org.springframework.web.socket.config.annotation.StompEndpointRegistry;\r\nimport org.springframework.web.socket.config.annotation.WebSocketMessageBrokerConfigurer;\r\n\r\n@Configuration\r\n@EnableWebSocketMessageBroker\r\npublic class WebSocketConfig implements WebSocketMessageBrokerConfigurer {\r\n\r\n    @Override\r\n    public void registerStompEndpoints(StompEndpointRegistry registry) {\r\n        registry.addEndpoint(&quot;/ws&quot;).setAllowedOriginPatterns(&quot;*&quot;).withSockJS();\r\n    }\r\n\r\n    @Override\r\n    public void configureMessageBroker(MessageBrokerRegistry registry) {\r\n        registry.setApplicationDestinationPrefixes(&quot;/app&quot;);\r\n        registry.enableSimpleBroker(&quot;/topic&quot;);\r\n    }\r\n}\r\n```\r\n\r\n```Java\r\npackage com.example.socket.config;\r\n\r\nimport com.example.socket.controller.model.ChatMessage;\r\nimport com.example.socket.controller.model.MessageType;\r\nimport lombok.RequiredArgsConstructor;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.context.event.EventListener;\r\nimport org.springframework.messaging.simp.SimpMessageSendingOperations;\r\nimport org.springframework.messaging.simp.stomp.StompHeaderAccessor;\r\nimport org.springframework.stereotype.Component;\r\nimport org.springframework.web.socket.messaging.SessionDisconnectEvent;\r\n\r\nimport java.util.Objects;\r\n\r\n@Component\r\n@Slf4j\r\npublic class WebSocketEventListener {\r\n\r\n    private final SimpMessageSendingOperations messageTemplate;\r\n\r\n    @Autowired\r\n    public WebSocketEventListener(SimpMessageSendingOperations messageTemplate) {\r\n        this.messageTemplate = messageTemplate;\r\n    }\r\n\r\n    @EventListener\r\n    public void handleWebSocketDisconnectListener(SessionDisconnectEvent event) {\r\n        StompHeaderAccessor headerAccessor = StompHeaderAccessor.wrap(event.getMessage());\r\n        String username = Objects.requireNonNull(headerAccessor.getSessionAttributes()).get(&quot;username&quot;).toString();\r\n\r\n        log.info(STR.&quot;User disconnected: \\{username}&quot;);\r\n\r\n        ChatMessage chatMessage = new ChatMessage();\r\n        chatMessage.setType(MessageType.LEAVE);\r\n        chatMessage.setSender(username);\r\n\r\n        messageTemplate.convertAndSend(&quot;/topic/public&quot;, chatMessage);\r\n    }\r\n}\r\n```\r\n\r\nI&#39;ve got no idea why this is happening. I&#39;ve tried to solve it for some time, but I don&#39;t know what the source of the problem is. I suspect the issue is somewhere on the frontend though.\r\n\r\n**Update:**\r\n\r\nAfter refactoring the code to something like this:\r\n\r\n```TypeScript\r\nuseEffect(() =&gt; {\r\n        const socket = new SockJS(&#39;http://localhost:8080/ws&#39;)\r\n\r\n        socket.onopen = () =&gt; {\r\n            const client = over(socket)\r\n            setStompClient(client)\r\n\r\n            client.connect({}, () =&gt; {\r\n                client.send(&#39;/chat.addUser&#39;, {}, JSON.stringify({ content: &#39;&#39;, sender: props.username, type: &#39;JOIN&#39; }))\r\n                client.subscribe(&#39;/topic/public&#39;, messageReceivedCallbackHandler)\r\n\r\n                setIsLoading(false)\r\n            }, errorCallbackHandler)\r\n        }\r\n\r\n        return () =&gt; {\r\n            socket.close()\r\n            stompClient?.disconnect(() =&gt; {})\r\n        }\r\n    }, [])\r\n```\r\n\r\nIt seems to just be stuck on &#39;CONNECTING...&#39;, which is odd.\r\n\r\nStack trace:\r\n\r\n```\r\n2023-10-19T17:23:06.840+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.authenticator.AuthenticatorBase    : Security checking request GET /ws/463/evl1y24y/websocket\r\n2023-10-19T17:23:06.840+13:00 DEBUG 26253 --- [nio-8080-exec-3] org.apache.catalina.realm.RealmBase      :   No applicable constraints defined\r\n2023-10-19T17:23:06.840+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.authenticator.AuthenticatorBase    : Not subject to any constraint\r\n2023-10-19T17:23:06.841+13:00 DEBUG 26253 --- [nio-8080-exec-3] org.apache.tomcat.util.http.Parameters   : Set encoding to UTF-8\r\n2023-10-19T17:23:06.841+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET &quot;/ws/463/evl1y24y/websocket&quot;, parameters={}\r\n2023-10-19T17:23:06.841+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.s.w.s.s.s.WebSocketHandlerMapping      : Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@6b350309\r\n2023-10-19T17:23:06.842+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.s.w.s.s.t.h.DefaultSockJsService       : Processing transport request: GET http://localhost:8080/ws/463/evl1y24y/websocket\r\n2023-10-19T17:23:06.938+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     findClass(org.apache.tomcat.util.collections.LocalStrings)\r\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     --&gt; Returning ClassNotFoundException\r\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       : getResource(org/apache/tomcat/util/collections/LocalStrings.properties)\r\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   Delegating to parent classloader jdk.internal.loader.ClassLoaders$AppClassLoader@4e0e2f2a\r\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   --&gt; Resource not found, returning null\r\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     findClass(org.apache.tomcat.util.collections.LocalStrings_en)\r\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     --&gt; Returning ClassNotFoundException\r\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       : getResource(org/apache/tomcat/util/collections/LocalStrings_en.properties)\r\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   Delegating to parent classloader jdk.internal.loader.ClassLoaders$AppClassLoader@4e0e2f2a\r\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   --&gt; Resource not found, returning null\r\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     findClass(org.apache.tomcat.util.collections.LocalStrings_en_NZ)\r\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     --&gt; Returning ClassNotFoundException\r\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       : getResource(org/apache/tomcat/util/collections/LocalStrings_en_NZ.properties)\r\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   Delegating to parent classloader jdk.internal.loader.ClassLoaders$AppClassLoader@4e0e2f2a\r\n2023-10-19T17:23:06.941+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   --&gt; Resource not found, returning null\r\n2023-10-19T17:23:06.962+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 101 SWITCHING_PROTOCOLS\r\n2023-10-19T17:23:06.964+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.apache.coyote.http11.Http11Processor   : Socket: [org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper@718be7b6:org.apache.tomcat.util.net.NioChannel@7f4c17f7:java.nio.channels.SocketChannel[connected local=/[0:0:0:0:0:0:0:1]:8080 remote=/[0:0:0:0:0:0:0:1]:55430]], Status in: [OPEN_READ], State out: [UPGRADING]\r\n2023-10-19T17:23:07.001+13:00 DEBUG 26253 --- [nio-8080-exec-3] org.apache.tomcat.websocket.WsSession    : Created WebSocket session [0]\r\n2023-10-19T17:23:07.006+13:00 DEBUG 26253 --- [nio-8080-exec-3] s.w.s.h.LoggingWebSocketHandlerDecorator : New WebSocketServerSockJsSession[id=evl1y24y]\r\n2023-10-19T17:23:07.027+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.t.websocket.server.WsFrameServer     : wsFrameServer.onDataAvailable\r\n2023-10-19T17:23:07.028+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.tomcat.util.net.SocketWrapperBase    : Socket: [org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper@718be7b6:org.apache.tomcat.util.net.NioChannel@7f4c17f7:java.nio.channels.SocketChannel[connected local=/[0:0:0:0:0:0:0:1]:8080 remote=/[0:0:0:0:0:0:0:1]:55430]], Read from buffer: [0]\r\n2023-10-19T17:23:07.028+13:00 DEBUG 26253 --- [nio-8080-exec-3] org.apache.tomcat.util.net.NioEndpoint   : Socket: [org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper@718be7b6:org.apache.tomcat.util.net.NioChannel@7f4c17f7:java.nio.channels.SocketChannel[connected local=/[0:0:0:0:0:0:0:1]:8080 remote=/[0:0:0:0:0:0:0:1]:55430]], Read direct from socket: [0]\r\n2023-10-19T17:23:07.028+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.h.u.UpgradeProcessorInternal       : Socket: [org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper@718be7b6:org.apache.tomcat.util.net.NioChannel@7f4c17f7:java.nio.channels.SocketChannel[connected local=/[0:0:0:0:0:0:0:1]:8080 remote=/[0:0:0:0:0:0:0:1]:55430]], Status in: [OPEN_READ], State out: [UPGRADED]\r\n2023-10-19T17:23:07.029+13:00 DEBUG 26253 --- [nio-8080-exec-3] org.apache.tomcat.util.net.NioEndpoint   : Registered read interest for [org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper@718be7b6:org.apache.tomcat.util.net.NioChannel@7f4c17f7:java.nio.channels.SocketChannel[connected local=/[0:0:0:0:0:0:0:1]:8080 remote=/[0:0:0:0:0:0:0:1]:55430]]\r\n2023-10-19T17:23:44.841+13:00 DEBUG 26253 --- [alina-utility-1] o.apache.catalina.session.ManagerBase    : Start expire sessions StandardManager at 1697689424841 sessioncount 0\r\n2023-10-19T17:23:44.842+13:00 DEBUG 26253 --- [alina-utility-1] o.apache.catalina.session.ManagerBase    : End expire sessions StandardManager processingTime 1 expired sessions: 0\r\n```\r\n\r\nI also discovered these logs which could be indicating something:\r\n\r\n```\r\n2023-10-22T12:39:58.952+13:00 DEBUG 6918 --- [on(3)-127.0.0.1] sun.rmi.transport.tcp                    : RMI TCP Connection(3)-127.0.0.1: (port 42091) connection closed\r\n2023-10-22T12:39:58.952+13:00 DEBUG 6918 --- [on(3)-127.0.0.1] sun.rmi.transport.tcp                    : RMI TCP Connection(3)-127.0.0.1: close connection, socket: Socket[addr=/127.0.0.1,port=46880,localport=42091]\r\n2023-10-22T12:39:58.952+13:00 DEBUG 6918 --- [on(3)-127.0.0.1] sun.rmi.transport.tcp                    : RMI TCP Connection(3)-127.0.0.1: socket close: Socket[addr=/127.0.0.1,port=46880,localport=42091]\r\n```","title":"SocketJS + Spring Boot &gt; Uncaught Error: InvalidStateError: The connection has not been established yet","body":"<p>I'm creating a SocketJS (that uses STOMP) app with Spring Boot, and I keep getting this error whenever my app starts:</p>\n<pre><code>caught Error: InvalidStateError: The connection has not been established yet\n    at SockJS.send (main.js:161:1)\n    at Client._transmit (stomp.js:159:1)\n    at Client.disconnect (stomp.js:341:1)\n    at ChatRoom.tsx:37:1\n    at safelyCallDestroy (react-dom.development.js:22932:1)\n    at commitHookEffectListUnmount (react-dom.development.js:23100:1)\n    at invokePassiveEffectUnmountInDEV (react-dom.development.js:25207:1)\n    at invokeEffectsInDev (react-dom.development.js:27351:1)\n    at commitDoubleInvokeEffectsInDEV (react-dom.development.js:27324:1)\n    at flushPassiveEffectsImpl (react-dom.development.js:27056:1)\nS\n</code></pre>\n<p>Then, on the backend I get this error:</p>\n<pre><code> WebSocketSession[2 current WS(2)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 16, active threads = 0, queued tasks = 0, completed tasks = 18], outboundChannel[pool size = 2, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 8, active threads = 1, queued tasks = 3, completed tasks = 9]\n2023-10-15T15:13:35.507+13:00 ERROR 10628 --- [nio-8080-exec-9] o.s.w.s.m.StompSubProtocolHandler        : Error publishing SessionDisconnectEvent[sessionId=stpnlchb, CloseStatus[code=1000, reason=null]]\n</code></pre>\n<p>Front-end React code:</p>\n<pre><code>import { Button, Flex, Input, Text } from &quot;@chakra-ui/react&quot;;\nimport { Suspense, useEffect, useState } from &quot;react&quot;;\nimport SockJS from &quot;sockjs-client&quot;;\nimport { Client, Message, over } from &quot;stompjs&quot;;\n\ninterface ChatMessage {\n    content: string\n    sender: string\n    type: 'CHAT' | 'JOIN' | 'LEAVE'\n}\n\ninterface ChatRoomProps {\n    username: string\n}\n\nexport default function ChatRoom(props: ChatRoomProps) {\n    const [loading, setIsLoading] = useState(true)\n    const [error, setError] = useState(false)\n    const [message, setMessage] = useState&lt;string | null&gt;(null)\n    const [messageStream, setMessageStream] = useState&lt;ChatMessage[]&gt;([])\n    const [stompClient, setStompClient] = useState&lt;Client | null&gt;(null)\n\n    useEffect(() =&gt; {\n        const socket = new SockJS('http://localhost:8080/ws')\n        const client: Client = over(socket)\n\n        client.connect({}, () =&gt; {\n            client.send('/chat.addUser', {}, JSON.stringify({ content: '', sender: props.username, type: 'JOIN' }))\n            client.subscribe('/topic/public', messageReceivedCallbackHandler)\n\n            setIsLoading(false)\n        }, errorCallbackHandler)\n\n        setStompClient(client)\n\n        return () =&gt; {\n            socket.close()\n            client.disconnect(() =&gt; {})\n        }\n    }, [])\n\n    function messageReceivedCallbackHandler(payload: Message): void {\n        const message: ChatMessage = JSON.parse(payload.body)\n\n        setMessageStream(prevMessageStream =&gt; [...prevMessageStream, message])\n    }\n\n    function errorCallbackHandler(): void {\n        setError(true)\n    }\n\n    function messageChangeHandler(e: React.ChangeEvent&lt;HTMLInputElement&gt;): void {\n        setMessage(e.target.value)\n    }\n\n    function sendClickHandler(): void {\n        if (message &amp;&amp; stompClient) {\n            const chatMessage: ChatMessage = {\n                content: message,\n                sender: props.username,\n                type: 'CHAT'\n            }\n\n            stompClient.send('/chat.sendMessage', {}, JSON.stringify(chatMessage))\n\n            setMessage(null)\n            \n            const inputElement = document.getElementById('msg-input') as HTMLInputElement\n            inputElement.value = ''\n        }\n    }\n\n    return (\n        &lt;Flex\n            width='750px'\n            height='750px'\n            flexDirection='column'\n            gap='16px'\n            background='white'\n            alignItems='center'\n            padding='42px'\n            overflow='clip'\n        &gt;\n            &lt;Text fontSize='lg' fontWeight='bold'&gt;Spring WebSocket Chat Demo - By Alibou&lt;/Text&gt;\n\n            {error &amp;&amp; &lt;Text&gt;Error connecting to server&lt;/Text&gt;}\n\n            {loading ? &lt;Text&gt;Loading...&lt;/Text&gt; : (\n                &lt;Flex flexDirection='column' textAlign='center' overflowY='scroll' width='100%'&gt;\n                    {messageStream.map((message, index) =&gt; (\n                        &lt;&gt;\n                            {message.type === 'CHAT' &amp;&amp; &lt;Text key={index}&gt;&lt;b&gt;{message.sender}&lt;/b&gt;: {message.content}&lt;/Text&gt;}\n                            {message.type === 'JOIN' &amp;&amp; &lt;Text key={index}&gt;&lt;b&gt;{message.sender}&lt;/b&gt; joined&lt;/Text&gt;}\n                            {message.type === 'LEAVE' &amp;&amp; &lt;Text key={index}&gt;&lt;b&gt;{message.sender}&lt;/b&gt; left&lt;/Text&gt;}\n                        &lt;/&gt;\n                    ))}\n                &lt;/Flex&gt;\n            )}\n\n\n            &lt;Flex marginTop='auto' width='100%' gap='16px'&gt;\n                &lt;Input id='msg-input' placeholder='Type a message' marginTop='auto' onChange={messageChangeHandler} /&gt;\n                \n                &lt;Button colorScheme='blue' onClick={sendClickHandler}&gt;Send&lt;/Button&gt;\n            &lt;/Flex&gt;\n        &lt;/Flex&gt;\n    )\n} \n</code></pre>\n<p>Java backend:</p>\n<pre><code>package com.example.socket.controller;\n\nimport com.example.socket.controller.model.ChatMessage;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.messaging.handler.annotation.MessageMapping;\nimport org.springframework.messaging.handler.annotation.Payload;\nimport org.springframework.messaging.handler.annotation.SendTo;\nimport org.springframework.messaging.simp.SimpMessageHeaderAccessor;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport java.util.Objects;\n\n@RestController\n@Slf4j\npublic class ChatController {\n\n    @MessageMapping(&quot;/chat.sendMessage&quot;)\n    @SendTo(&quot;/topic/public&quot;)\n    public ChatMessage sendMessage(@Payload ChatMessage chatMessage) {\n        return chatMessage;\n    }\n\n    @MessageMapping(&quot;/chat.addUser&quot;)\n    @SendTo(&quot;/topic/public&quot;)\n    public ChatMessage addUser(\n        @Payload ChatMessage chatMessage,\n        SimpMessageHeaderAccessor headerAccessor\n    ) {\n        Objects.requireNonNull(headerAccessor.getSessionAttributes()).put(&quot;username&quot;, chatMessage.getSender());\n\n        return chatMessage;\n    }\n}\n</code></pre>\n<pre><code>package com.example.socket.config;\n\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.messaging.simp.config.MessageBrokerRegistry;\nimport org.springframework.web.socket.config.annotation.EnableWebSocketMessageBroker;\nimport org.springframework.web.socket.config.annotation.StompEndpointRegistry;\nimport org.springframework.web.socket.config.annotation.WebSocketMessageBrokerConfigurer;\n\n@Configuration\n@EnableWebSocketMessageBroker\npublic class WebSocketConfig implements WebSocketMessageBrokerConfigurer {\n\n    @Override\n    public void registerStompEndpoints(StompEndpointRegistry registry) {\n        registry.addEndpoint(&quot;/ws&quot;).setAllowedOriginPatterns(&quot;*&quot;).withSockJS();\n    }\n\n    @Override\n    public void configureMessageBroker(MessageBrokerRegistry registry) {\n        registry.setApplicationDestinationPrefixes(&quot;/app&quot;);\n        registry.enableSimpleBroker(&quot;/topic&quot;);\n    }\n}\n</code></pre>\n<pre><code>package com.example.socket.config;\n\nimport com.example.socket.controller.model.ChatMessage;\nimport com.example.socket.controller.model.MessageType;\nimport lombok.RequiredArgsConstructor;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.context.event.EventListener;\nimport org.springframework.messaging.simp.SimpMessageSendingOperations;\nimport org.springframework.messaging.simp.stomp.StompHeaderAccessor;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.socket.messaging.SessionDisconnectEvent;\n\nimport java.util.Objects;\n\n@Component\n@Slf4j\npublic class WebSocketEventListener {\n\n    private final SimpMessageSendingOperations messageTemplate;\n\n    @Autowired\n    public WebSocketEventListener(SimpMessageSendingOperations messageTemplate) {\n        this.messageTemplate = messageTemplate;\n    }\n\n    @EventListener\n    public void handleWebSocketDisconnectListener(SessionDisconnectEvent event) {\n        StompHeaderAccessor headerAccessor = StompHeaderAccessor.wrap(event.getMessage());\n        String username = Objects.requireNonNull(headerAccessor.getSessionAttributes()).get(&quot;username&quot;).toString();\n\n        log.info(STR.&quot;User disconnected: \\{username}&quot;);\n\n        ChatMessage chatMessage = new ChatMessage();\n        chatMessage.setType(MessageType.LEAVE);\n        chatMessage.setSender(username);\n\n        messageTemplate.convertAndSend(&quot;/topic/public&quot;, chatMessage);\n    }\n}\n</code></pre>\n<p>I've got no idea why this is happening. I've tried to solve it for some time, but I don't know what the source of the problem is. I suspect the issue is somewhere on the frontend though.</p>\n<p><strong>Update:</strong></p>\n<p>After refactoring the code to something like this:</p>\n<pre><code>useEffect(() =&gt; {\n        const socket = new SockJS('http://localhost:8080/ws')\n\n        socket.onopen = () =&gt; {\n            const client = over(socket)\n            setStompClient(client)\n\n            client.connect({}, () =&gt; {\n                client.send('/chat.addUser', {}, JSON.stringify({ content: '', sender: props.username, type: 'JOIN' }))\n                client.subscribe('/topic/public', messageReceivedCallbackHandler)\n\n                setIsLoading(false)\n            }, errorCallbackHandler)\n        }\n\n        return () =&gt; {\n            socket.close()\n            stompClient?.disconnect(() =&gt; {})\n        }\n    }, [])\n</code></pre>\n<p>It seems to just be stuck on 'CONNECTING...', which is odd.</p>\n<p>Stack trace:</p>\n<pre><code>2023-10-19T17:23:06.840+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.authenticator.AuthenticatorBase    : Security checking request GET /ws/463/evl1y24y/websocket\n2023-10-19T17:23:06.840+13:00 DEBUG 26253 --- [nio-8080-exec-3] org.apache.catalina.realm.RealmBase      :   No applicable constraints defined\n2023-10-19T17:23:06.840+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.authenticator.AuthenticatorBase    : Not subject to any constraint\n2023-10-19T17:23:06.841+13:00 DEBUG 26253 --- [nio-8080-exec-3] org.apache.tomcat.util.http.Parameters   : Set encoding to UTF-8\n2023-10-19T17:23:06.841+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET &quot;/ws/463/evl1y24y/websocket&quot;, parameters={}\n2023-10-19T17:23:06.841+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.s.w.s.s.s.WebSocketHandlerMapping      : Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@6b350309\n2023-10-19T17:23:06.842+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.s.w.s.s.t.h.DefaultSockJsService       : Processing transport request: GET http://localhost:8080/ws/463/evl1y24y/websocket\n2023-10-19T17:23:06.938+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     findClass(org.apache.tomcat.util.collections.LocalStrings)\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     --&gt; Returning ClassNotFoundException\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       : getResource(org/apache/tomcat/util/collections/LocalStrings.properties)\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   Delegating to parent classloader jdk.internal.loader.ClassLoaders$AppClassLoader@4e0e2f2a\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   --&gt; Resource not found, returning null\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     findClass(org.apache.tomcat.util.collections.LocalStrings_en)\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     --&gt; Returning ClassNotFoundException\n2023-10-19T17:23:06.939+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       : getResource(org/apache/tomcat/util/collections/LocalStrings_en.properties)\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   Delegating to parent classloader jdk.internal.loader.ClassLoaders$AppClassLoader@4e0e2f2a\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   --&gt; Resource not found, returning null\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     findClass(org.apache.tomcat.util.collections.LocalStrings_en_NZ)\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :     --&gt; Returning ClassNotFoundException\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       : getResource(org/apache/tomcat/util/collections/LocalStrings_en_NZ.properties)\n2023-10-19T17:23:06.940+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   Delegating to parent classloader jdk.internal.loader.ClassLoaders$AppClassLoader@4e0e2f2a\n2023-10-19T17:23:06.941+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.loader.WebappClassLoaderBase       :   --&gt; Resource not found, returning null\n2023-10-19T17:23:06.962+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 101 SWITCHING_PROTOCOLS\n2023-10-19T17:23:06.964+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.apache.coyote.http11.Http11Processor   : Socket: [org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper@718be7b6:org.apache.tomcat.util.net.NioChannel@7f4c17f7:java.nio.channels.SocketChannel[connected local=/[0:0:0:0:0:0:0:1]:8080 remote=/[0:0:0:0:0:0:0:1]:55430]], Status in: [OPEN_READ], State out: [UPGRADING]\n2023-10-19T17:23:07.001+13:00 DEBUG 26253 --- [nio-8080-exec-3] org.apache.tomcat.websocket.WsSession    : Created WebSocket session [0]\n2023-10-19T17:23:07.006+13:00 DEBUG 26253 --- [nio-8080-exec-3] s.w.s.h.LoggingWebSocketHandlerDecorator : New WebSocketServerSockJsSession[id=evl1y24y]\n2023-10-19T17:23:07.027+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.t.websocket.server.WsFrameServer     : wsFrameServer.onDataAvailable\n2023-10-19T17:23:07.028+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.tomcat.util.net.SocketWrapperBase    : Socket: [org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper@718be7b6:org.apache.tomcat.util.net.NioChannel@7f4c17f7:java.nio.channels.SocketChannel[connected local=/[0:0:0:0:0:0:0:1]:8080 remote=/[0:0:0:0:0:0:0:1]:55430]], Read from buffer: [0]\n2023-10-19T17:23:07.028+13:00 DEBUG 26253 --- [nio-8080-exec-3] org.apache.tomcat.util.net.NioEndpoint   : Socket: [org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper@718be7b6:org.apache.tomcat.util.net.NioChannel@7f4c17f7:java.nio.channels.SocketChannel[connected local=/[0:0:0:0:0:0:0:1]:8080 remote=/[0:0:0:0:0:0:0:1]:55430]], Read direct from socket: [0]\n2023-10-19T17:23:07.028+13:00 DEBUG 26253 --- [nio-8080-exec-3] o.a.c.h.u.UpgradeProcessorInternal       : Socket: [org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper@718be7b6:org.apache.tomcat.util.net.NioChannel@7f4c17f7:java.nio.channels.SocketChannel[connected local=/[0:0:0:0:0:0:0:1]:8080 remote=/[0:0:0:0:0:0:0:1]:55430]], Status in: [OPEN_READ], State out: [UPGRADED]\n2023-10-19T17:23:07.029+13:00 DEBUG 26253 --- [nio-8080-exec-3] org.apache.tomcat.util.net.NioEndpoint   : Registered read interest for [org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper@718be7b6:org.apache.tomcat.util.net.NioChannel@7f4c17f7:java.nio.channels.SocketChannel[connected local=/[0:0:0:0:0:0:0:1]:8080 remote=/[0:0:0:0:0:0:0:1]:55430]]\n2023-10-19T17:23:44.841+13:00 DEBUG 26253 --- [alina-utility-1] o.apache.catalina.session.ManagerBase    : Start expire sessions StandardManager at 1697689424841 sessioncount 0\n2023-10-19T17:23:44.842+13:00 DEBUG 26253 --- [alina-utility-1] o.apache.catalina.session.ManagerBase    : End expire sessions StandardManager processingTime 1 expired sessions: 0\n</code></pre>\n<p>I also discovered these logs which could be indicating something:</p>\n<pre><code>2023-10-22T12:39:58.952+13:00 DEBUG 6918 --- [on(3)-127.0.0.1] sun.rmi.transport.tcp                    : RMI TCP Connection(3)-127.0.0.1: (port 42091) connection closed\n2023-10-22T12:39:58.952+13:00 DEBUG 6918 --- [on(3)-127.0.0.1] sun.rmi.transport.tcp                    : RMI TCP Connection(3)-127.0.0.1: close connection, socket: Socket[addr=/127.0.0.1,port=46880,localport=42091]\n2023-10-22T12:39:58.952+13:00 DEBUG 6918 --- [on(3)-127.0.0.1] sun.rmi.transport.tcp                    : RMI TCP Connection(3)-127.0.0.1: socket close: Socket[addr=/127.0.0.1,port=46880,localport=42091]\n</code></pre>\n"},{"tags":["java","spring-boot","kotlin","neo4j","spring-data-neo4j"],"comments":[{"owner":{"account_id":3133300,"reputation":7957,"user_id":2650436,"accept_rate":80,"display_name":"meistermeier"},"score":1,"creation_date":1691682144,"post_id":76873735,"comment_id":135527409,"body_markdown":"If you are defining a `@GeneratedValue` `@Id` of type `Long` on the domain class, it will still use the `id` function.","body":"If you are defining a <code>@GeneratedValue</code> <code>@Id</code> of type <code>Long</code> on the domain class, it will still use the <code>id</code> function."},{"owner":{"account_id":10868035,"reputation":332,"user_id":7990795,"display_name":"LeadingMoominExpert"},"score":0,"creation_date":1691993021,"post_id":76873735,"comment_id":135560304,"body_markdown":"@meistermeier I&#39;m not defining `@GeneratedValue` and the id&#39;s are strings not longs","body":"@meistermeier I&#39;m not defining <code>@GeneratedValue</code> and the id&#39;s are strings not longs"}],"owner":{"account_id":10868035,"reputation":332,"user_id":7990795,"display_name":"LeadingMoominExpert"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":211,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"answer_count":0,"score":4,"last_activity_date":1700057253,"creation_date":1691654520,"question_id":76873735,"body_markdown":"When upgrading to Neo4j v5.9.0 I tried to enforce the Neo4j v5 dialect as the documentation suggests by creating the following configuration\r\n```kotlin\r\nimport org.neo4j.cypherdsl.core.renderer.Dialect\r\nimport org.springframework.context.annotation.Bean\r\nimport org.springframework.context.annotation.Configuration\r\nimport org.neo4j.cypherdsl.core.renderer.Configuration as CypherConfiguration\r\n\r\n@Configuration\r\nclass Neo4jConfiguration {\r\n\r\n    @Bean\r\n    fun cypherDslConfiguration(): CypherConfiguration =\r\n        CypherConfiguration.newConfig().withDialect(Dialect.NEO4J_5).build()\r\n}\r\n```\r\nWhen checking from spring actuator, the following bean seems to be present\r\n```json\r\n&quot;cypherDslConfiguration&quot;: {\r\n  &quot;aliases&quot;: [],\r\n  &quot;scope&quot;: &quot;singleton&quot;,\r\n  &quot;type&quot;: &quot;org.neo4j.cypherdsl.core.renderer.Configuration&quot;,\r\n  &quot;resource&quot;: &quot;class path resource [com/foo/infra/neo4j/Neo4jConfiguration.class]&quot;,\r\n  &quot;dependencies&quot;: [\r\n    &quot;neo4jConfiguration&quot;\r\n  ]\r\n}\r\n```\r\nand when using repository queries I&#39;m still getting the following warning from all sorts of different queries\r\n```\r\nNeo.ClientNotification.Statement.FeatureDeprecationWarning: This feature is deprecated and will be removed in future versions.\r\n\tUNWIND $__relationships__ AS relationship WITH relationship MATCH (startNode:`MyNode`) WHERE startNode.entityId = relationship.fromId MATCH (endNode) WHERE id(endNode) = relationship.toId MERGE (startNode)-[relProps:`BELONGS`]-&gt;(endNode) RETURN elementId(relProps) AS __elementId__\r\n\t                                                                                                                                                                   ^\r\nThe query used a deprecated function: `id`.\r\n```\r\nWhere the `entityId` field on the node is annotated with the `@Id` annotation.\r\n\r\nIs there some configuration I&#39;m still missing or is my cypherDslConfiguration bean incorrect?\r\n\r\nRelevant versions:\r\n - org.springframework.boot:spring-boot-starter-data-neo4j 3.1.2\r\n - org.springframework.data:spring-data-neo4j 7.1.2\r\n - kotlin 1.9.0\r\n\r\n","title":"Spring data neo4j cypher dialect is not enforced everywhere","body":"<p>When upgrading to Neo4j v5.9.0 I tried to enforce the Neo4j v5 dialect as the documentation suggests by creating the following configuration</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>import org.neo4j.cypherdsl.core.renderer.Dialect\nimport org.springframework.context.annotation.Bean\nimport org.springframework.context.annotation.Configuration\nimport org.neo4j.cypherdsl.core.renderer.Configuration as CypherConfiguration\n\n@Configuration\nclass Neo4jConfiguration {\n\n    @Bean\n    fun cypherDslConfiguration(): CypherConfiguration =\n        CypherConfiguration.newConfig().withDialect(Dialect.NEO4J_5).build()\n}\n</code></pre>\n<p>When checking from spring actuator, the following bean seems to be present</p>\n<pre class=\"lang-json prettyprint-override\"><code>&quot;cypherDslConfiguration&quot;: {\n  &quot;aliases&quot;: [],\n  &quot;scope&quot;: &quot;singleton&quot;,\n  &quot;type&quot;: &quot;org.neo4j.cypherdsl.core.renderer.Configuration&quot;,\n  &quot;resource&quot;: &quot;class path resource [com/foo/infra/neo4j/Neo4jConfiguration.class]&quot;,\n  &quot;dependencies&quot;: [\n    &quot;neo4jConfiguration&quot;\n  ]\n}\n</code></pre>\n<p>and when using repository queries I'm still getting the following warning from all sorts of different queries</p>\n<pre><code>Neo.ClientNotification.Statement.FeatureDeprecationWarning: This feature is deprecated and will be removed in future versions.\n    UNWIND $__relationships__ AS relationship WITH relationship MATCH (startNode:`MyNode`) WHERE startNode.entityId = relationship.fromId MATCH (endNode) WHERE id(endNode) = relationship.toId MERGE (startNode)-[relProps:`BELONGS`]-&gt;(endNode) RETURN elementId(relProps) AS __elementId__\n                                                                                                                                                                       ^\nThe query used a deprecated function: `id`.\n</code></pre>\n<p>Where the <code>entityId</code> field on the node is annotated with the <code>@Id</code> annotation.</p>\n<p>Is there some configuration I'm still missing or is my cypherDslConfiguration bean incorrect?</p>\n<p>Relevant versions:</p>\n<ul>\n<li>org.springframework.boot:spring-boot-starter-data-neo4j 3.1.2</li>\n<li>org.springframework.data:spring-data-neo4j 7.1.2</li>\n<li>kotlin 1.9.0</li>\n</ul>\n"},{"tags":["java","graph","charts","gral-plots"],"answers":[{"tags":[],"owner":{"account_id":9740087,"reputation":11,"user_id":7222003,"display_name":"Chris Koss"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1480555552,"creation_date":1480555552,"answer_id":40901143,"question_id":40852386,"body_markdown":"I figured it out! (with the help of a co-worker)\r\n\r\nThe Inset area defaults to being transparent black (RGBA(0,0,0,0)).  Because of this, when the graph is exported as JPEG (which does not support transparency) it drops the alpha value and renders it all as black.  By exporting as a png, I was able to preserve transparency and the graphs now look good when embedded into a document with a white background. \r\n\r\n\r\n\r\n    private static void getPng(XYPlot plot, String fileName) {\r\n        BufferedImage bImage = new BufferedImage(800, 600, BufferedImage.TYPE_INT_RGB);\r\n        Graphics2D g2d = (Graphics2D) bImage.getGraphics();\r\n        DrawingContext context = new DrawingContext(g2d);\r\n        plot.draw(context);\r\n        DrawableWriter wr = DrawableWriterFactory.getInstance().get(&quot;image/png&quot;);\r\n        try {\r\n            wr.write(plot, new FileOutputStream(fileName + &quot;.png&quot;), 800, 600);\r\n        } catch (IOException err) {\r\n            System.out.println(err);\r\n        }\r\n    }","title":"How to change Inset color in GRAL?","body":"<p>I figured it out! (with the help of a co-worker)</p>\n\n<p>The Inset area defaults to being transparent black (RGBA(0,0,0,0)).  Because of this, when the graph is exported as JPEG (which does not support transparency) it drops the alpha value and renders it all as black.  By exporting as a png, I was able to preserve transparency and the graphs now look good when embedded into a document with a white background. </p>\n\n<pre><code>private static void getPng(XYPlot plot, String fileName) {\n    BufferedImage bImage = new BufferedImage(800, 600, BufferedImage.TYPE_INT_RGB);\n    Graphics2D g2d = (Graphics2D) bImage.getGraphics();\n    DrawingContext context = new DrawingContext(g2d);\n    plot.draw(context);\n    DrawableWriter wr = DrawableWriterFactory.getInstance().get(\"image/png\");\n    try {\n        wr.write(plot, new FileOutputStream(fileName + \".png\"), 800, 600);\n    } catch (IOException err) {\n        System.out.println(err);\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":9740087,"reputation":11,"user_id":7222003,"display_name":"Chris Koss"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":67,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1700056817,"creation_date":1480362814,"question_id":40852386,"body_markdown":"I&#39;m trying to create GRAL graphs and export them as JPGs.  \r\n\r\nNot sure why, but the color of the &#39;Inset&#39; areas (outside the border) seems to be defaulting to black.  This is particularly confusing, as the docs seem to indicate that insets default to being white. \r\n\r\nHow can I change the color of the Inset?  \r\n\r\nHere is how I&#39;m exporting the jpg\r\n\r\n    private void getJpg(BarPlot plot) {\r\n        BufferedImage bImage = new BufferedImage(800, 600, BufferedImage.TYPE_INT_ARGB);\r\n        Graphics2D g2d = (Graphics2D) bImage.getGraphics();\r\n        DrawingContext context = new DrawingContext(g2d);\r\n        plot.draw(context);\r\n        DrawableWriter wr = DrawableWriterFactory.getInstance().get(&quot;image/jpeg&quot;);\r\n        try {\r\n            wr.write(plot, new FileOutputStream(&quot;/path/out.jpg&quot;), 800, 600);\r\n        } catch (IOException err) {\r\n            System.out.println(err);\r\n        }\r\n    }\r\n\r\nHere is my current result (using white text on black bg for now, but want black text on white bg). \r\n![current output](http://i.stack.imgur.com/1oCF3.jpg)","title":"How to change Inset color in GRAL?","body":"<p>I'm trying to create GRAL graphs and export them as JPGs.</p>\n<p>Not sure why, but the color of the 'Inset' areas (outside the border) seems to be defaulting to black.  This is particularly confusing, as the docs seem to indicate that insets default to being white.</p>\n<p>How can I change the color of the Inset?</p>\n<p>Here is how I'm exporting the jpg</p>\n<pre><code>private void getJpg(BarPlot plot) {\n    BufferedImage bImage = new BufferedImage(800, 600, BufferedImage.TYPE_INT_ARGB);\n    Graphics2D g2d = (Graphics2D) bImage.getGraphics();\n    DrawingContext context = new DrawingContext(g2d);\n    plot.draw(context);\n    DrawableWriter wr = DrawableWriterFactory.getInstance().get(&quot;image/jpeg&quot;);\n    try {\n        wr.write(plot, new FileOutputStream(&quot;/path/out.jpg&quot;), 800, 600);\n    } catch (IOException err) {\n        System.out.println(err);\n    }\n}\n</code></pre>\n<p>Here is my current result (using white text on black bg for now, but want black text on white bg).\n<img src=\"https://i.stack.imgur.com/1oCF3.jpg\" alt=\"current output\" /></p>\n"},{"tags":["java","mysql","debezium","cdc","debezium-engine"],"comments":[{"owner":{"account_id":1714975,"reputation":20238,"user_id":1572269,"accept_rate":43,"display_name":"Naros"},"score":0,"creation_date":1682409691,"post_id":76060713,"comment_id":134206432,"body_markdown":"It would appear that your code isn&#39;t finding the `debezium-embedded` artifact on the classpath where the `BuidlerFactory` implementation&#39;s service loader registration is defined.","body":"It would appear that your code isn&#39;t finding the <code>debezium-embedded</code> artifact on the classpath where the <code>BuidlerFactory</code> implementation&#39;s service loader registration is defined."}],"answers":[{"tags":[],"owner":{"account_id":15282082,"reputation":704,"user_id":11026123,"display_name":"RusJaI"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700056495,"creation_date":1700056495,"answer_id":77488297,"question_id":76060713,"body_markdown":"The above issue happened when packing the Debezium into my source code. Root cause was that my source code was compatible with Java 11 while the corresponding Debezium version has been built on Java 17","title":"Error &quot;No implementation of Debezium engine builder was found&quot; while connecting Debezium to the Java code","body":"<p>The above issue happened when packing the Debezium into my source code. Root cause was that my source code was compatible with Java 11 while the corresponding Debezium version has been built on Java 17</p>\n"}],"owner":{"account_id":15282082,"reputation":704,"user_id":11026123,"display_name":"RusJaI"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":248,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1700056495,"creation_date":1681967018,"question_id":76060713,"body_markdown":"I&#39;m trying to connect Debezium to my Java code and expose the event messages in json format. I&#39;m delivering this a a jar file which will be embedded into another application.\r\n\r\nHere when I setup params and trying to initialize the Debezium with the `DebeziumEngine.create(Json.class)` method, a DebeziumException comes out with following message.\r\n\r\n&gt; No implementation of Debezium engine builder was found\r\n\r\nFollowing is my Java method:\r\n\r\n    private void setupDebezium() throws DebeziumException {\r\n        log.info(&quot;Setting up debezium&quot;);\r\n        //start debezium\r\n        final Properties props = new Properties();\r\n        props.setProperty(&quot;name&quot;, &quot;engine&quot;);\r\n        props.setProperty(&quot;offset.storage&quot;, &quot;org.apache.kafka.connect.storage.FileOffsetBackingStore&quot;);\r\n        props.setProperty(&quot;offset.storage.file.filename&quot;, &quot;/Users/abc/mytemp1/offsets.dat&quot;);\r\n        props.setProperty(&quot;offset.flush.interval.ms&quot;, &quot;1000&quot;);\r\n        /* begin connector properties */\r\n        props.setProperty(&quot;connector.class&quot;, &quot;io.debezium.connector.mysql.MySqlConnector&quot;);\r\n        props.setProperty(&quot;database.hostname&quot;, &quot;localhost&quot;);\r\n        props.setProperty(&quot;database.port&quot;, &quot;3306&quot;);\r\n        props.setProperty(&quot;database.user&quot;, &quot;root&quot;);\r\n        props.setProperty(&quot;database.password&quot;, &quot;root&quot;);\r\n        props.setProperty(&quot;database.dbname&quot;, &quot;students&quot;);\r\n        props.setProperty(&quot;database.server.id&quot;, &quot;85744&quot;);\r\n        props.setProperty(&quot;topic.prefix&quot;, &quot;my-app-connector&quot;);\r\n        props.setProperty(&quot;schema.history.internal&quot;,\r\n                &quot;io.debezium.storage.file.history.FileSchemaHistory&quot;);\r\n        props.setProperty(&quot;schema.history.internal.file.filename&quot;,\r\n                &quot;/Users/abc/mytemp1/schemahistory.dat&quot;);\r\n    \r\n    \r\n        try (DebeziumEngine&lt;ChangeEvent&lt;String, String&gt;&gt; engine = DebeziumEngine.create(Json.class)\r\n                .using(props)\r\n                .notifying(record -&gt; {\r\n                    System.out.println(record);\r\n                }).build()\r\n        ) {\r\n            // Run the engine asynchronously ...\r\n            ExecutorService executor = Executors.newSingleThreadExecutor();\r\n            executor.execute(engine);\r\n    \r\n            // Do something else or wait for a signal or an event\r\n            Thread.sleep(10000000);\r\n        } catch (IOException e) {\r\n            throw new RuntimeException(e);\r\n        } catch (InterruptedException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n\r\nFollowing are the Debezium dependencies used: \r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;io.debezium&lt;/groupId&gt;\r\n        &lt;artifactId&gt;debezium-api&lt;/artifactId&gt;\r\n        &lt;version&gt;${version.debezium}&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;io.debezium&lt;/groupId&gt;\r\n        &lt;artifactId&gt;debezium-core&lt;/artifactId&gt;\r\n        &lt;version&gt;${version.debezium}&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;io.debezium&lt;/groupId&gt;\r\n        &lt;artifactId&gt;debezium-embedded&lt;/artifactId&gt;\r\n        &lt;version&gt;${version.debezium}&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;io.debezium&lt;/groupId&gt;\r\n        &lt;artifactId&gt;debezium-connector-mysql&lt;/artifactId&gt;\r\n        &lt;version&gt;${version.debezium}&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nps:\r\n\r\n    &lt;version.debezium&gt;2.1.4.Final&lt;/version.debezium&gt;\r\n\r\nWhat&#39;s wrong with my code?","title":"Error &quot;No implementation of Debezium engine builder was found&quot; while connecting Debezium to the Java code","body":"<p>I'm trying to connect Debezium to my Java code and expose the event messages in json format. I'm delivering this a a jar file which will be embedded into another application.</p>\n<p>Here when I setup params and trying to initialize the Debezium with the <code>DebeziumEngine.create(Json.class)</code> method, a DebeziumException comes out with following message.</p>\n<blockquote>\n<p>No implementation of Debezium engine builder was found</p>\n</blockquote>\n<p>Following is my Java method:</p>\n<pre><code>private void setupDebezium() throws DebeziumException {\n    log.info(&quot;Setting up debezium&quot;);\n    //start debezium\n    final Properties props = new Properties();\n    props.setProperty(&quot;name&quot;, &quot;engine&quot;);\n    props.setProperty(&quot;offset.storage&quot;, &quot;org.apache.kafka.connect.storage.FileOffsetBackingStore&quot;);\n    props.setProperty(&quot;offset.storage.file.filename&quot;, &quot;/Users/abc/mytemp1/offsets.dat&quot;);\n    props.setProperty(&quot;offset.flush.interval.ms&quot;, &quot;1000&quot;);\n    /* begin connector properties */\n    props.setProperty(&quot;connector.class&quot;, &quot;io.debezium.connector.mysql.MySqlConnector&quot;);\n    props.setProperty(&quot;database.hostname&quot;, &quot;localhost&quot;);\n    props.setProperty(&quot;database.port&quot;, &quot;3306&quot;);\n    props.setProperty(&quot;database.user&quot;, &quot;root&quot;);\n    props.setProperty(&quot;database.password&quot;, &quot;root&quot;);\n    props.setProperty(&quot;database.dbname&quot;, &quot;students&quot;);\n    props.setProperty(&quot;database.server.id&quot;, &quot;85744&quot;);\n    props.setProperty(&quot;topic.prefix&quot;, &quot;my-app-connector&quot;);\n    props.setProperty(&quot;schema.history.internal&quot;,\n            &quot;io.debezium.storage.file.history.FileSchemaHistory&quot;);\n    props.setProperty(&quot;schema.history.internal.file.filename&quot;,\n            &quot;/Users/abc/mytemp1/schemahistory.dat&quot;);\n\n\n    try (DebeziumEngine&lt;ChangeEvent&lt;String, String&gt;&gt; engine = DebeziumEngine.create(Json.class)\n            .using(props)\n            .notifying(record -&gt; {\n                System.out.println(record);\n            }).build()\n    ) {\n        // Run the engine asynchronously ...\n        ExecutorService executor = Executors.newSingleThreadExecutor();\n        executor.execute(engine);\n\n        // Do something else or wait for a signal or an event\n        Thread.sleep(10000000);\n    } catch (IOException e) {\n        throw new RuntimeException(e);\n    } catch (InterruptedException e) {\n        throw new RuntimeException(e);\n    }\n}\n</code></pre>\n<p>Following are the Debezium dependencies used:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;io.debezium&lt;/groupId&gt;\n    &lt;artifactId&gt;debezium-api&lt;/artifactId&gt;\n    &lt;version&gt;${version.debezium}&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.debezium&lt;/groupId&gt;\n    &lt;artifactId&gt;debezium-core&lt;/artifactId&gt;\n    &lt;version&gt;${version.debezium}&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.debezium&lt;/groupId&gt;\n    &lt;artifactId&gt;debezium-embedded&lt;/artifactId&gt;\n    &lt;version&gt;${version.debezium}&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.debezium&lt;/groupId&gt;\n    &lt;artifactId&gt;debezium-connector-mysql&lt;/artifactId&gt;\n    &lt;version&gt;${version.debezium}&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>ps:</p>\n<pre><code>&lt;version.debezium&gt;2.1.4.Final&lt;/version.debezium&gt;\n</code></pre>\n<p>What's wrong with my code?</p>\n"},{"tags":["java","android","hotspot"],"comments":[{"owner":{"account_id":17879033,"reputation":154,"user_id":12988325,"display_name":"wolf"},"score":0,"creation_date":1692784231,"post_id":76959481,"comment_id":135670366,"body_markdown":"Please include the code which you have tried.","body":"Please include the code which you have tried."},{"owner":{"account_id":29281060,"reputation":1,"user_id":22433664,"display_name":"Han Wei Ho"},"score":0,"creation_date":1692929315,"post_id":76959481,"comment_id":135694465,"body_markdown":"@wolf added the code for ip neigh, actually there is nothing wrong in the code. The problem is i need an alternative to get the device list in target SDK version 33","body":"@wolf added the code for ip neigh, actually there is nothing wrong in the code. The problem is i need an alternative to get the device list in target SDK version 33"}],"owner":{"account_id":29281060,"reputation":1,"user_id":22433664,"display_name":"Han Wei Ho"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":160,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700056382,"creation_date":1692778136,"question_id":76959481,"body_markdown":"I am working on an android app that based on java that need the list of devices connected to hotspot which has been using arp table and ip neigh command. In the target SDK version 33, arp table and ip neigh are both not working. My app will need the IP and MAC Address of the devices while pinging the subnet mask can only know the IP Address of the devices. \r\n```\r\n                BufferedReader br = null;\r\n                List&lt;String&gt; args = new ArrayList&lt;String&gt; ();\r\n                args.add(&quot;ip&quot;);\r\n                args.add(&quot;neigh&quot;);\r\n                String args = listOf(&quot;ip&quot;, &quot;neigh&quot;);\r\n                ProcessBuilder cmd = new ProcessBuilder(args);\r\n                Process process = cmd.start();\r\n                br = new BufferedReader(new \r\n                InputStreamReader(process.getInputStream()));\r\n                String line;\r\n\r\n                while ((line = br.readLine()) != null) {\r\n                    System.out.println(&quot;line=&quot;+line.toString()); }\r\n\r\n                BufferedReader errReader = new BufferedReader(new \r\n                InputStreamReader(process.getErrorStream()));\r\n                br.close();\r\n                errReader.close();\r\n                process.destroy();\r\n```\r\n\r\nIs there any alternative to get the list of devices connected to hotspot without root?","title":"List of devices connected to hotspot on Android 13","body":"<p>I am working on an android app that based on java that need the list of devices connected to hotspot which has been using arp table and ip neigh command. In the target SDK version 33, arp table and ip neigh are both not working. My app will need the IP and MAC Address of the devices while pinging the subnet mask can only know the IP Address of the devices.</p>\n<pre><code>                BufferedReader br = null;\n                List&lt;String&gt; args = new ArrayList&lt;String&gt; ();\n                args.add(&quot;ip&quot;);\n                args.add(&quot;neigh&quot;);\n                String args = listOf(&quot;ip&quot;, &quot;neigh&quot;);\n                ProcessBuilder cmd = new ProcessBuilder(args);\n                Process process = cmd.start();\n                br = new BufferedReader(new \n                InputStreamReader(process.getInputStream()));\n                String line;\n\n                while ((line = br.readLine()) != null) {\n                    System.out.println(&quot;line=&quot;+line.toString()); }\n\n                BufferedReader errReader = new BufferedReader(new \n                InputStreamReader(process.getErrorStream()));\n                br.close();\n                errReader.close();\n                process.destroy();\n</code></pre>\n<p>Is there any alternative to get the list of devices connected to hotspot without root?</p>\n"},{"tags":["java","apache-flink","flink-streaming","flink-sql","flink-batch"],"answers":[{"tags":[],"owner":{"account_id":21886042,"reputation":1703,"user_id":16173669,"display_name":"Martijn Visser"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1700056116,"creation_date":1700056116,"answer_id":77488256,"question_id":77486871,"body_markdown":"You should just use the FileSource that&#39;s available and documented at https://nightlies.apache.org/flink/flink-docs-master/docs/connectors/datastream/filesystem/\r\n\r\nSomething like:\r\n```\r\nCsvReaderFormat&lt;SomePojo&gt; csvFormat = CsvReaderFormat.forPojo(SomePojo.class);\r\nFileSource&lt;SomePojo&gt; source = \r\n        FileSource.forRecordStreamFormat(csvFormat, Path.fromLocalFile(...)).build();\r\n```","title":"How to consume files from S3 bucket using Flink with checkpoints for failure recovery","body":"<p>You should just use the FileSource that's available and documented at <a href=\"https://nightlies.apache.org/flink/flink-docs-master/docs/connectors/datastream/filesystem/\" rel=\"nofollow noreferrer\">https://nightlies.apache.org/flink/flink-docs-master/docs/connectors/datastream/filesystem/</a></p>\n<p>Something like:</p>\n<pre><code>CsvReaderFormat&lt;SomePojo&gt; csvFormat = CsvReaderFormat.forPojo(SomePojo.class);\nFileSource&lt;SomePojo&gt; source = \n        FileSource.forRecordStreamFormat(csvFormat, Path.fromLocalFile(...)).build();\n</code></pre>\n"}],"owner":{"account_id":13253201,"reputation":419,"user_id":9570144,"display_name":"efex09"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":33,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77488256,"answer_count":1,"score":0,"last_activity_date":1700056116,"creation_date":1700043452,"question_id":77486871,"body_markdown":"I have a usecase to consume the files present in given S3 bucket.\r\nThe problem is that I want to ensure that the Flink job process each line of the file only once in case the job is restarted.\r\n\r\nIf it was a streaming source like Kafka then checkpointing mechanism should have worked. Do we have a way to achieve checkpointing for a job consuming files from S3.\r\n\r\n```\r\nimport org.apache.flink.api.common.functions.MapFunction;\r\nimport org.apache.flink.api.java.DataSet;\r\nimport org.apache.flink.api.java.ExecutionEnvironment;\r\nimport org.apache.flink.api.java.io.TextFileResult;\r\nimport org.apache.flink.api.java.operators.DataSource;\r\nimport org.apache.flink.api.java.tuple.Tuple2;\r\nimport org.apache.flink.core.fs.Path;\r\n\r\npublic class FlinkReadFileAndSendToAPI {\r\n\r\n    public static void main(String[] args) throws Exception {\r\n\r\n        // Set up the Flink execution environment\r\n        ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();\r\n\r\n        // Read the file from S3\r\n        DataSource&lt;String&gt; text = env.readTextFile(new Path(&quot;s3://my-bucket/my-file.txt&quot;));\r\n\r\n        // Map the file content to a tuple containing the file name and content\r\n        DataSet&lt;Tuple2&lt;String, String&gt;&gt; fileContent = text.map(new MapFunction&lt;String, Tuple2&lt;String, String&gt;&gt;() {\r\n            @Override\r\n            public Tuple2&lt;String, String&gt; map(String line) throws Exception {\r\n                return new Tuple2&lt;String, String&gt;(&quot;my-file.txt&quot;, line);\r\n            }\r\n        });\r\n\r\n        // Send the file content to the API endpoint\r\n        fileContent.forEach(new FileContentSender());\r\n\r\n        // Execute the Flink job\r\n        env.execute(&quot;Read File and Send to API&quot;);\r\n    }\r\n\r\n    private static class FileContentSender implements MapFunction&lt;Tuple2&lt;String, String&gt;, Object&gt; {\r\n\r\n        @Override\r\n        public Object map(Tuple2&lt;String, String&gt; fileContent) throws Exception {\r\n\r\n            // Create the HTTP client\r\n            CloseableHttpClient httpClient = HttpClients.createDefault();\r\n\r\n            // Create the POST request\r\n            HttpPost httpPost = new HttpPost(&quot;https://my-api-endpoint.com/api/file&quot;);\r\n\r\n            // Set the request body\r\n            HttpEntity entity = new StringEntity(&quot;{\\&quot;filename\\&quot;: \\&quot;&quot; + fileContent.f0 + &quot;\\&quot;, \\&quot;content\\&quot;: \\&quot;&quot; + fileContent.f1 + &quot;\\&quot;}&quot;);\r\n            httpPost.setEntity(entity);\r\n\r\n            // Execute the POST request\r\n            CloseableHttpResponse response = httpClient.execute(httpPost);\r\n\r\n            // Check the response status code\r\n            if (response.getStatusLine().getStatusCode() != 200) {\r\n                throw new Exception(&quot;API request failed with status code: &quot; + response.getStatusLine().getStatusCode());\r\n            }\r\n\r\n            // Close the response\r\n            response.close();\r\n\r\n            // Close the HTTP client\r\n            httpClient.close();\r\n\r\n            return null;\r\n        }\r\n    }\r\n}\r\n\r\n```","title":"How to consume files from S3 bucket using Flink with checkpoints for failure recovery","body":"<p>I have a usecase to consume the files present in given S3 bucket.\nThe problem is that I want to ensure that the Flink job process each line of the file only once in case the job is restarted.</p>\n<p>If it was a streaming source like Kafka then checkpointing mechanism should have worked. Do we have a way to achieve checkpointing for a job consuming files from S3.</p>\n<pre><code>import org.apache.flink.api.common.functions.MapFunction;\nimport org.apache.flink.api.java.DataSet;\nimport org.apache.flink.api.java.ExecutionEnvironment;\nimport org.apache.flink.api.java.io.TextFileResult;\nimport org.apache.flink.api.java.operators.DataSource;\nimport org.apache.flink.api.java.tuple.Tuple2;\nimport org.apache.flink.core.fs.Path;\n\npublic class FlinkReadFileAndSendToAPI {\n\n    public static void main(String[] args) throws Exception {\n\n        // Set up the Flink execution environment\n        ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();\n\n        // Read the file from S3\n        DataSource&lt;String&gt; text = env.readTextFile(new Path(&quot;s3://my-bucket/my-file.txt&quot;));\n\n        // Map the file content to a tuple containing the file name and content\n        DataSet&lt;Tuple2&lt;String, String&gt;&gt; fileContent = text.map(new MapFunction&lt;String, Tuple2&lt;String, String&gt;&gt;() {\n            @Override\n            public Tuple2&lt;String, String&gt; map(String line) throws Exception {\n                return new Tuple2&lt;String, String&gt;(&quot;my-file.txt&quot;, line);\n            }\n        });\n\n        // Send the file content to the API endpoint\n        fileContent.forEach(new FileContentSender());\n\n        // Execute the Flink job\n        env.execute(&quot;Read File and Send to API&quot;);\n    }\n\n    private static class FileContentSender implements MapFunction&lt;Tuple2&lt;String, String&gt;, Object&gt; {\n\n        @Override\n        public Object map(Tuple2&lt;String, String&gt; fileContent) throws Exception {\n\n            // Create the HTTP client\n            CloseableHttpClient httpClient = HttpClients.createDefault();\n\n            // Create the POST request\n            HttpPost httpPost = new HttpPost(&quot;https://my-api-endpoint.com/api/file&quot;);\n\n            // Set the request body\n            HttpEntity entity = new StringEntity(&quot;{\\&quot;filename\\&quot;: \\&quot;&quot; + fileContent.f0 + &quot;\\&quot;, \\&quot;content\\&quot;: \\&quot;&quot; + fileContent.f1 + &quot;\\&quot;}&quot;);\n            httpPost.setEntity(entity);\n\n            // Execute the POST request\n            CloseableHttpResponse response = httpClient.execute(httpPost);\n\n            // Check the response status code\n            if (response.getStatusLine().getStatusCode() != 200) {\n                throw new Exception(&quot;API request failed with status code: &quot; + response.getStatusLine().getStatusCode());\n            }\n\n            // Close the response\n            response.close();\n\n            // Close the HTTP client\n            httpClient.close();\n\n            return null;\n        }\n    }\n}\n\n</code></pre>\n"},{"tags":["java","annotations","code-generation"],"owner":{"account_id":23753819,"reputation":21,"user_id":17770182,"display_name":"sixwaay"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":13,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700056035,"creation_date":1700056035,"question_id":77488245,"body_markdown":"I need to implement an Annotation Processor that generates a Java class related to the annotated class. However, my biggest challenge at the moment is understanding how to use Maven to implement such an Annotation Processor and make it work.\r\n\r\nAnnotation is like:\r\n```java\r\n@Retention(RetentionPolicy.CLASS)\r\n@Target(ElementType.TYPE)\r\npublic @interface Tag {\r\n    String value() default &quot;&quot;;\r\n}\r\n```\r\n\r\nprocessor is like:\r\n```java\r\n@SupportedAnnotationTypes({&quot;Tag&quot;})\r\n@SupportedSourceVersion(SourceVersion.RELEASE_11)\r\npublic class TagProcessor extends AbstractProcessor {\r\n    @Override\r\n    public boolean process(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv) {\r\n        for (TypeElement annotation : annotations) {\r\n            var annotatedElements = roundEnv.getElementsAnnotatedWith(annotation);\r\n            for (var element : annotatedElements) {\r\n                if (element.getKind() == ElementKind.CLASS) {\r\n                    var className = ((TypeElement) element).getQualifiedName().toString();\r\n                    var packageName = className.substring(0, className.lastIndexOf(&#39;.&#39;));\r\n                    var simpleClassName = className.substring(className.lastIndexOf(&#39;.&#39;) + 1);\r\n                    var infoClassName = simpleClassName + &quot;Info&quot;;\r\n                    var tagValue = element.getAnnotation(Tag.class).value();\r\n\r\n                    // Generate the source code for the new class\r\n                    var infoClassSource = generateInfoClass(packageName, infoClassName, tagValue);\r\n\r\n                    // Write the generated source code to a new file\r\n                    try {\r\n                        writeSourceFile(packageName, infoClassName, infoClassSource);\r\n                    } catch (IOException e) {\r\n                        processingEnv.getMessager().printMessage(Diagnostic.Kind.ERROR,\r\n                                &quot;Error generating &quot; + infoClassName + &quot;: &quot; + e.getMessage());\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private String generateInfoClass(String packageName, String infoClassName, String tagValue) {\r\n        return &quot;package &quot; + packageName + &quot;;\\n\\n&quot; +\r\n                &quot;public class &quot; + infoClassName + &quot; {\\n&quot; +\r\n                &quot;    private String tag = \\&quot;&quot; + tagValue + &quot;\\&quot;;\\n\\n&quot; +\r\n                &quot;    public String getTag() {\\n&quot; +\r\n                &quot;        return tag;\\n&quot; +\r\n                &quot;    }\\n&quot; +\r\n                &quot;}&quot;;\r\n    }\r\n\r\n    private void writeSourceFile(String packageName, String className, String source) throws IOException {\r\n        var filer = processingEnv.getFiler();\r\n        var fileObject = filer.createSourceFile(packageName + &quot;.&quot; + className);\r\n        try (var writer = fileObject.openWriter()) {\r\n            writer.write(source);\r\n        }\r\n    }\r\n}\r\n```","title":"how to write a small, complete example of an Annotation Processor with maven?","body":"<p>I need to implement an Annotation Processor that generates a Java class related to the annotated class. However, my biggest challenge at the moment is understanding how to use Maven to implement such an Annotation Processor and make it work.</p>\n<p>Annotation is like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Retention(RetentionPolicy.CLASS)\n@Target(ElementType.TYPE)\npublic @interface Tag {\n    String value() default &quot;&quot;;\n}\n</code></pre>\n<p>processor is like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@SupportedAnnotationTypes({&quot;Tag&quot;})\n@SupportedSourceVersion(SourceVersion.RELEASE_11)\npublic class TagProcessor extends AbstractProcessor {\n    @Override\n    public boolean process(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv) {\n        for (TypeElement annotation : annotations) {\n            var annotatedElements = roundEnv.getElementsAnnotatedWith(annotation);\n            for (var element : annotatedElements) {\n                if (element.getKind() == ElementKind.CLASS) {\n                    var className = ((TypeElement) element).getQualifiedName().toString();\n                    var packageName = className.substring(0, className.lastIndexOf('.'));\n                    var simpleClassName = className.substring(className.lastIndexOf('.') + 1);\n                    var infoClassName = simpleClassName + &quot;Info&quot;;\n                    var tagValue = element.getAnnotation(Tag.class).value();\n\n                    // Generate the source code for the new class\n                    var infoClassSource = generateInfoClass(packageName, infoClassName, tagValue);\n\n                    // Write the generated source code to a new file\n                    try {\n                        writeSourceFile(packageName, infoClassName, infoClassSource);\n                    } catch (IOException e) {\n                        processingEnv.getMessager().printMessage(Diagnostic.Kind.ERROR,\n                                &quot;Error generating &quot; + infoClassName + &quot;: &quot; + e.getMessage());\n                    }\n                }\n            }\n        }\n        return true;\n    }\n\n    private String generateInfoClass(String packageName, String infoClassName, String tagValue) {\n        return &quot;package &quot; + packageName + &quot;;\\n\\n&quot; +\n                &quot;public class &quot; + infoClassName + &quot; {\\n&quot; +\n                &quot;    private String tag = \\&quot;&quot; + tagValue + &quot;\\&quot;;\\n\\n&quot; +\n                &quot;    public String getTag() {\\n&quot; +\n                &quot;        return tag;\\n&quot; +\n                &quot;    }\\n&quot; +\n                &quot;}&quot;;\n    }\n\n    private void writeSourceFile(String packageName, String className, String source) throws IOException {\n        var filer = processingEnv.getFiler();\n        var fileObject = filer.createSourceFile(packageName + &quot;.&quot; + className);\n        try (var writer = fileObject.openWriter()) {\n            writer.write(source);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["java","spring","spring-boot","spring-mvc"],"answers":[{"tags":[],"owner":{"account_id":17994687,"reputation":63,"user_id":13078026,"display_name":"smeds"},"comment_count":0,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1700055734,"creation_date":1700055734,"answer_id":77488197,"question_id":77488106,"body_markdown":"You’re on the right track with creating a custom filter. However, the issue you’re facing is that the content type of the response is not set until after the controller method is executed. Therefore, when your filter is checking the content type, it’s still null.\r\n\r\nTo solve this, you can create a wrapper for the `HttpServletResponse` and override the `setContentType` method. In this method, you can check if the content type being set is “`application/json`” and if so, add the charset to the response headers.\r\n\r\nHere’s an example of how you can do it:\r\n\r\n\r\n    public class CharEncodingFilter extends OncePerRequestFilter {\r\n    \r\n        @Override\r\n        protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)\r\n                throws ServletException, IOException {\r\n            HttpServletResponseWrapper responseWrapper = new HttpServletResponseWrapper(response) {\r\n                @Override\r\n                public void setContentType(String type) {\r\n                    if (MediaType.APPLICATION_JSON_VALUE.equals(type)) {\r\n                        super.setContentType(type + &quot;;charset=UTF-8&quot;);\r\n                    } else {\r\n                        super.setContentType(type);\r\n                    }\r\n                }\r\n            };\r\n            filterChain.doFilter(request, responseWrapper);\r\n        }\r\n    }\r\n\r\nIn this code, `OncePerRequestFilter` is a type of filter provided by Spring that ensures the filter is only applied once per request. When the `setContentType` method is called on the responseWrapper, it checks if the type is “`application/json`”. If it is, it sets the content type with the UTF-8 charset. Otherwise, it sets the content type as usual.\r\n\r\nRemember to register this filter in your configuration:\r\n\r\n    @Configuration\r\n    public class WebConfig {\r\n    \r\n        @Bean\r\n        public FilterRegistrationBean&lt;CharEncodingFilter&gt; charEncodingFilter() {\r\n            FilterRegistrationBean&lt;CharEncodingFilter&gt; registrationBean = new FilterRegistrationBean&lt;&gt;();\r\n            registrationBean.setFilter(new CharEncodingFilter());\r\n            registrationBean.addUrlPatterns(&quot;/*&quot;);\r\n            return registrationBean;\r\n        }\r\n    }","title":"add UTF-8 charset to to response headers in spring boot","body":"<p>You’re on the right track with creating a custom filter. However, the issue you’re facing is that the content type of the response is not set until after the controller method is executed. Therefore, when your filter is checking the content type, it’s still null.</p>\n<p>To solve this, you can create a wrapper for the <code>HttpServletResponse</code> and override the <code>setContentType</code> method. In this method, you can check if the content type being set is “<code>application/json</code>” and if so, add the charset to the response headers.</p>\n<p>Here’s an example of how you can do it:</p>\n<pre><code>public class CharEncodingFilter extends OncePerRequestFilter {\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)\n            throws ServletException, IOException {\n        HttpServletResponseWrapper responseWrapper = new HttpServletResponseWrapper(response) {\n            @Override\n            public void setContentType(String type) {\n                if (MediaType.APPLICATION_JSON_VALUE.equals(type)) {\n                    super.setContentType(type + &quot;;charset=UTF-8&quot;);\n                } else {\n                    super.setContentType(type);\n                }\n            }\n        };\n        filterChain.doFilter(request, responseWrapper);\n    }\n}\n</code></pre>\n<p>In this code, <code>OncePerRequestFilter</code> is a type of filter provided by Spring that ensures the filter is only applied once per request. When the <code>setContentType</code> method is called on the responseWrapper, it checks if the type is “<code>application/json</code>”. If it is, it sets the content type with the UTF-8 charset. Otherwise, it sets the content type as usual.</p>\n<p>Remember to register this filter in your configuration:</p>\n<pre><code>@Configuration\npublic class WebConfig {\n\n    @Bean\n    public FilterRegistrationBean&lt;CharEncodingFilter&gt; charEncodingFilter() {\n        FilterRegistrationBean&lt;CharEncodingFilter&gt; registrationBean = new FilterRegistrationBean&lt;&gt;();\n        registrationBean.setFilter(new CharEncodingFilter());\n        registrationBean.addUrlPatterns(&quot;/*&quot;);\n        return registrationBean;\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":21831314,"reputation":1,"user_id":18754015,"display_name":"Mohammad"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":70,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1700055734,"creation_date":1700055157,"question_id":77488106,"body_markdown":"I have a spring boot application which sends and receives data in various forms such as application/json , application/xml , application/x-www-form-urlencoded , ... .\r\n\r\nI want to write a custom filter to set UTF-8 charset to response headers. But I want to apply this only to the responses where the contentType header is set to &quot;application/json&quot; .\r\n\r\nHow Can I achieve this goal ?\r\n\r\nI tried to add the following to application.yml :\r\n\r\n```\r\nserver:\r\n  servlet:\r\n    encoding:\r\n      charset: UTF-8\r\n      force-response: true\r\n```\r\n\r\nBut I doubt that it will apply to all responses(not just &quot;application/json&quot; ones).\r\n\r\nAnother thing I have done so far is writing a filter :\r\n\r\n``` Java\r\npublic class CharEncodingFilter extends CharacterEncodingFilter {\r\n    @Override\r\n    protected void doFilterInternal(HttpServletRequest request,\r\n                                    HttpServletResponse response,\r\n                                    FilterChain filterChain) throws ServletException, IOException {\r\n\r\n        filterChain.doFilter(request , response);\r\n\r\n        if (response.getContentType().equals(MediaType.APPLICATION_JSON_VALUE)) {\r\n            String encoding = getEncoding();\r\n            if (encoding != null) {\r\n                if (isForceRequestEncoding() || request.getCharacterEncoding() == null) {\r\n                    request.setCharacterEncoding(encoding);\r\n                }\r\n                if (isForceResponseEncoding()) {\r\n                    response.setCharacterEncoding(encoding);\r\n                }\r\n            }\r\n            filterChain.doFilter(request, response);\r\n        }\r\n\r\n    }\r\n\r\n}\r\n```\r\n\r\nbut it fails to fulfill my request, because ```response.getContentType()``` is null and the if-statement will produce nullPointerException :( .\r\n\r\n\r\nI know somewhere in the application, the contentType is set for the responses by springboot, and I want to add UTF-8 encoding charset header right after that.\r\n\r\n\r\nP.S: I want a global solution. I know it&#39;s applicable to set the response type of each of the controller methods seperately, but it&#39;s time consuming to fix all controllers.\r\nThanks.","title":"add UTF-8 charset to to response headers in spring boot","body":"<p>I have a spring boot application which sends and receives data in various forms such as application/json , application/xml , application/x-www-form-urlencoded , ... .</p>\n<p>I want to write a custom filter to set UTF-8 charset to response headers. But I want to apply this only to the responses where the contentType header is set to &quot;application/json&quot; .</p>\n<p>How Can I achieve this goal ?</p>\n<p>I tried to add the following to application.yml :</p>\n<pre><code>server:\n  servlet:\n    encoding:\n      charset: UTF-8\n      force-response: true\n</code></pre>\n<p>But I doubt that it will apply to all responses(not just &quot;application/json&quot; ones).</p>\n<p>Another thing I have done so far is writing a filter :</p>\n<pre><code>public class CharEncodingFilter extends CharacterEncodingFilter {\n    @Override\n    protected void doFilterInternal(HttpServletRequest request,\n                                    HttpServletResponse response,\n                                    FilterChain filterChain) throws ServletException, IOException {\n\n        filterChain.doFilter(request , response);\n\n        if (response.getContentType().equals(MediaType.APPLICATION_JSON_VALUE)) {\n            String encoding = getEncoding();\n            if (encoding != null) {\n                if (isForceRequestEncoding() || request.getCharacterEncoding() == null) {\n                    request.setCharacterEncoding(encoding);\n                }\n                if (isForceResponseEncoding()) {\n                    response.setCharacterEncoding(encoding);\n                }\n            }\n            filterChain.doFilter(request, response);\n        }\n\n    }\n\n}\n</code></pre>\n<p>but it fails to fulfill my request, because <code>response.getContentType()</code> is null and the if-statement will produce nullPointerException :( .</p>\n<p>I know somewhere in the application, the contentType is set for the responses by springboot, and I want to add UTF-8 encoding charset header right after that.</p>\n<p>P.S: I want a global solution. I know it's applicable to set the response type of each of the controller methods seperately, but it's time consuming to fix all controllers.\nThanks.</p>\n"},{"tags":["java","maven-2","amazon-s3"],"comments":[{"owner":{"account_id":216689,"reputation":1500,"user_id":7171967,"display_name":"James Render"},"score":0,"creation_date":1557484731,"post_id":850570,"comment_id":98789986,"body_markdown":"There is also some information about S3 wagon providers [on this question](https://stackoverflow.com/questions/49737238/mvn-deploy-not-loading-the-s3-credentials/)","body":"There is also some information about S3 wagon providers <a href=\"https://stackoverflow.com/questions/49737238/mvn-deploy-not-loading-the-s3-credentials/\">on this question</a>"}],"answers":[{"comments":[{"owner":{"account_id":4105,"reputation":281434,"user_id":6068,"accept_rate":65,"display_name":"Pablo Fernandez"},"score":0,"creation_date":1523360257,"post_id":4379444,"comment_id":86519742,"body_markdown":"This extension is now very old and doesn&#39;t seem to work any more with the current AWS: https://stackoverflow.com/questions/49737238/mvn-deploy-not-loading-the-s3-credentials","body":"This extension is now very old and doesn&#39;t seem to work any more with the current AWS: <a href=\"https://stackoverflow.com/questions/49737238/mvn-deploy-not-loading-the-s3-credentials\" title=\"mvn deploy not loading the s3 credentials\">stackoverflow.com/questions/49737238/&hellip;</a>"}],"tags":[],"owner":{"account_id":254516,"reputation":4626,"user_id":533981,"display_name":"elek"},"comment_count":1,"down_vote_count":0,"up_vote_count":13,"is_accepted":false,"score":13,"last_activity_date":1347202174,"creation_date":1291741673,"answer_id":4379444,"question_id":850570,"body_markdown":"There is a newer s3 provider by spring which works:\r\n&lt;!-- language: xml --&gt;\r\n\r\n    &lt;build&gt;\r\n        &lt;extensions&gt;\r\n            &lt;extension&gt;\r\n                &lt;groupId&gt;org.springframework.build.aws&lt;/groupId&gt;\r\n                &lt;artifactId&gt;org.springframework.build.aws.maven&lt;/artifactId&gt;\r\n                &lt;version&gt;3.0.0.RELEASE&lt;/version&gt;\r\n            &lt;/extension&gt;\r\n        &lt;/extensions&gt;\r\n    &lt;/build&gt;\r\n\r\nIf you would like to use it with maven 3, you need encrypt you passphrase in your settings.xml.\r\n\r\nStep-by-step instructions are [here][1].\r\n\r\n\r\n  [1]: https://github.com/SpringSource/aws-maven\r\n","title":"maven s3 wagon provider","body":"<p>There is a newer s3 provider by spring which works:\n</p>\n\n<pre><code>&lt;build&gt;\n    &lt;extensions&gt;\n        &lt;extension&gt;\n            &lt;groupId&gt;org.springframework.build.aws&lt;/groupId&gt;\n            &lt;artifactId&gt;org.springframework.build.aws.maven&lt;/artifactId&gt;\n            &lt;version&gt;3.0.0.RELEASE&lt;/version&gt;\n        &lt;/extension&gt;\n    &lt;/extensions&gt;\n&lt;/build&gt;\n</code></pre>\n\n<p>If you would like to use it with maven 3, you need encrypt you passphrase in your settings.xml.</p>\n\n<p>Step-by-step instructions are <a href=\"https://github.com/SpringSource/aws-maven\">here</a>.</p>\n"},{"comments":[{"owner":{"account_id":57244,"reputation":489,"user_id":171452,"display_name":"ksclarke"},"score":0,"creation_date":1426170047,"post_id":7889912,"comment_id":46269481,"body_markdown":"I tried this one but it doesn&#39;t seem to set the files to public view like the kuali one does.  I had to go into s3 after the upload to set them manually.","body":"I tried this one but it doesn&#39;t seem to set the files to public view like the kuali one does.  I had to go into s3 after the upload to set them manually."}],"tags":[],"owner":{"account_id":63162,"reputation":102381,"user_id":187141,"accept_rate":82,"display_name":"yegor256"},"comment_count":1,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1319548890,"creation_date":1319548890,"answer_id":7889912,"question_id":850570,"body_markdown":"Another alternative:\r\n\r\n    &lt;build&gt;\r\n      &lt;extensions&gt;\r\n        &lt;extension&gt;\r\n          &lt;groupId&gt;org.cyclopsgroup&lt;/groupId&gt;\r\n          &lt;artifactId&gt;awss3-maven-wagon&lt;/artifactId&gt;\r\n          &lt;version&gt;0.1&lt;/version&gt;\r\n        &lt;/extension&gt;\r\n      &lt;/extensions&gt;\r\n      [...]\r\n    &lt;/build&gt;\r\n\r\nThen in `settings.xml`:\r\n\r\n    &lt;servers&gt;\r\n      &lt;server&gt;\r\n        &lt;id&gt;foo.s3&lt;/id&gt;\r\n        &lt;username&gt;AKIAJ.......OLVBA&lt;/username&gt;\r\n        &lt;password&gt;PsndORui..............KGZtDpeIYjsA/&lt;/password&gt;\r\n      &lt;/server&gt;\r\n    &lt;/servers&gt;\r\n\r\nAnd then in your `pom.xml`:\r\n\r\n    &lt;distributionManagement&gt;\r\n      &lt;repository&gt;\r\n        &lt;id&gt;foo&lt;/id&gt;\r\n        &lt;url&gt;s3://foo.s3/&lt;/url&gt;\r\n      &lt;/repository&gt;\r\n    &lt;/distributionManagement&gt;\r\n\r\nShould work.","title":"maven s3 wagon provider","body":"<p>Another alternative:</p>\n\n<pre><code>&lt;build&gt;\n  &lt;extensions&gt;\n    &lt;extension&gt;\n      &lt;groupId&gt;org.cyclopsgroup&lt;/groupId&gt;\n      &lt;artifactId&gt;awss3-maven-wagon&lt;/artifactId&gt;\n      &lt;version&gt;0.1&lt;/version&gt;\n    &lt;/extension&gt;\n  &lt;/extensions&gt;\n  [...]\n&lt;/build&gt;\n</code></pre>\n\n<p>Then in <code>settings.xml</code>:</p>\n\n<pre><code>&lt;servers&gt;\n  &lt;server&gt;\n    &lt;id&gt;foo.s3&lt;/id&gt;\n    &lt;username&gt;AKIAJ.......OLVBA&lt;/username&gt;\n    &lt;password&gt;PsndORui..............KGZtDpeIYjsA/&lt;/password&gt;\n  &lt;/server&gt;\n&lt;/servers&gt;\n</code></pre>\n\n<p>And then in your <code>pom.xml</code>:</p>\n\n<pre><code>&lt;distributionManagement&gt;\n  &lt;repository&gt;\n    &lt;id&gt;foo&lt;/id&gt;\n    &lt;url&gt;s3://foo.s3/&lt;/url&gt;\n  &lt;/repository&gt;\n&lt;/distributionManagement&gt;\n</code></pre>\n\n<p>Should work.</p>\n"},{"comments":[{"owner":{"account_id":192003,"reputation":30422,"user_id":432903,"accept_rate":64,"display_name":"prayagupa"},"score":1,"creation_date":1414064412,"post_id":8713383,"comment_id":41681388,"body_markdown":"Hi @Jeff Caddel - What if I wanted to pull/download already uploaded jar in my current project from s3 repository?","body":"Hi @Jeff Caddel - What if I wanted to pull/download already uploaded jar in my current project from s3 repository?"},{"owner":{"account_id":4105,"reputation":281434,"user_id":6068,"accept_rate":65,"display_name":"Pablo Fernandez"},"score":0,"creation_date":1523360263,"post_id":8713383,"comment_id":86519749,"body_markdown":"This extension is now very old and doesn&#39;t seem to work any more with the current AWS: https://stackoverflow.com/questions/49737238/mvn-deploy-not-loading-the-s3-credentials","body":"This extension is now very old and doesn&#39;t seem to work any more with the current AWS: <a href=\"https://stackoverflow.com/questions/49737238/mvn-deploy-not-loading-the-s3-credentials\" title=\"mvn deploy not loading the s3 credentials\">stackoverflow.com/questions/49737238/&hellip;</a>"},{"owner":{"account_id":85429,"reputation":9406,"user_id":238190,"accept_rate":71,"display_name":"emeraldhieu"},"score":0,"creation_date":1659686994,"post_id":8713383,"comment_id":129357964,"body_markdown":"It doesn&#39;t seem to work with existing buckets of other regions. I&#39;ve tried with other region like &quot;ap-southeast-3&quot; and got &quot;IllegalLocationConstraintException, AWS Error Message: The ap-southeast-3 location constraint is incompatible for the region specific endpoint this request was sent to&quot;.","body":"It doesn&#39;t seem to work with existing buckets of other regions. I&#39;ve tried with other region like &quot;ap-southeast-3&quot; and got &quot;IllegalLocationConstraintException, AWS Error Message: The ap-southeast-3 location constraint is incompatible for the region specific endpoint this request was sent to&quot;."}],"tags":[],"owner":{"account_id":242527,"reputation":334,"user_id":514096,"display_name":"Jeff Caddel"},"comment_count":3,"down_vote_count":1,"up_vote_count":13,"is_accepted":false,"score":12,"last_activity_date":1424390529,"creation_date":1325599351,"answer_id":8713383,"question_id":850570,"body_markdown":"[This wagon][1] is what we are using to deploy to S3.  It&#39;s similar to Spring&#39;s, but has multi-threaded upload support.\r\n\r\nThis lets the CI server push a lot of Maven content out to S3 very quickly.  (22k files and 400mb&#39;s of content in ~50 seconds)\r\n\r\nhttps://github.com/jcaddel/maven-s3-wagon\r\n\r\n    &lt;build&gt;\r\n     &lt;extensions&gt;\r\n       &lt;extension&gt;\r\n        &lt;groupId&gt;org.kuali.maven.wagons&lt;/groupId&gt;\r\n        &lt;artifactId&gt;maven-s3-wagon&lt;/artifactId&gt;\r\n        &lt;version&gt;1.2.1&lt;/version&gt;\r\n       &lt;/extension&gt;\r\n     &lt;/extensions&gt;\r\n    &lt;/build&gt;\r\n\r\n\r\n  [1]: https://github.com/jcaddel/maven-s3-wagon/","title":"maven s3 wagon provider","body":"<p><a href=\"https://github.com/jcaddel/maven-s3-wagon/\" rel=\"noreferrer\">This wagon</a> is what we are using to deploy to S3.  It's similar to Spring's, but has multi-threaded upload support.</p>\n\n<p>This lets the CI server push a lot of Maven content out to S3 very quickly.  (22k files and 400mb's of content in ~50 seconds)</p>\n\n<p><a href=\"https://github.com/jcaddel/maven-s3-wagon\" rel=\"noreferrer\">https://github.com/jcaddel/maven-s3-wagon</a></p>\n\n<pre><code>&lt;build&gt;\n &lt;extensions&gt;\n   &lt;extension&gt;\n    &lt;groupId&gt;org.kuali.maven.wagons&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-s3-wagon&lt;/artifactId&gt;\n    &lt;version&gt;1.2.1&lt;/version&gt;\n   &lt;/extension&gt;\n &lt;/extensions&gt;\n&lt;/build&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":297150,"reputation":1073,"user_id":602506,"accept_rate":40,"display_name":"Shannon"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1540328519,"creation_date":1540328519,"answer_id":52957793,"question_id":850570,"body_markdown":"Another option, which is a fork of the jcaddel plugin, was last updated March 2016 but works for me:\r\n\r\n    &lt;extension&gt;\r\n        &lt;groupId&gt;co.axiomzen.maven.wagons&lt;/groupId&gt;\r\n        &lt;artifactId&gt;maven-s3-wagon&lt;/artifactId&gt;\r\n        &lt;version&gt;1.2.6&lt;/version&gt;\r\n    &lt;/extension&gt;\r\n\r\nLooks like the main weaknesses are: old AWS SDK version, doesn&#39;t use the Default AWS Credentials Chain, so lacks support for things like credentials from ECS. Also, characters like &quot;@&quot; and &quot;:&quot; in the URL don&#39;t get encoded properly, though I&#39;m not sure if that&#39;s a problem with the wagon or with Maven.","title":"maven s3 wagon provider","body":"<p>Another option, which is a fork of the jcaddel plugin, was last updated March 2016 but works for me:</p>\n\n<pre><code>&lt;extension&gt;\n    &lt;groupId&gt;co.axiomzen.maven.wagons&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-s3-wagon&lt;/artifactId&gt;\n    &lt;version&gt;1.2.6&lt;/version&gt;\n&lt;/extension&gt;\n</code></pre>\n\n<p>Looks like the main weaknesses are: old AWS SDK version, doesn't use the Default AWS Credentials Chain, so lacks support for things like credentials from ECS. Also, characters like \"@\" and \":\" in the URL don't get encoded properly, though I'm not sure if that's a problem with the wagon or with Maven.</p>\n"},{"tags":[],"owner":{"account_id":792188,"reputation":1564,"user_id":800001,"display_name":"Markus T"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700055711,"creation_date":1700055711,"answer_id":77488191,"question_id":850570,"body_markdown":"I made one that supports AWS SSO (OIDC auth) that uses the second version of the SDK. Maybe it can be useful for you too. \r\n\r\nhttps://github.com/embriq-nordic/aws-oidc-s3-maven-wagon\r\n\r\n```\r\n&lt;extension&gt;\r\n    &lt;groupId&gt;io.github.embriq-nordic&lt;/groupId&gt;\r\n    &lt;artifactId&gt;aws-oidc-s3-maven-wagon&lt;/artifactId&gt;\r\n    &lt;version&gt;1.1.0&lt;/version&gt;\r\n&lt;/extension&gt;\r\n```\r\n\r\nSince it uses the second version of the SDK it uses the credentials provider chain used by that one. ","title":"maven s3 wagon provider","body":"<p>I made one that supports AWS SSO (OIDC auth) that uses the second version of the SDK. Maybe it can be useful for you too.</p>\n<p><a href=\"https://github.com/embriq-nordic/aws-oidc-s3-maven-wagon\" rel=\"nofollow noreferrer\">https://github.com/embriq-nordic/aws-oidc-s3-maven-wagon</a></p>\n<pre><code>&lt;extension&gt;\n    &lt;groupId&gt;io.github.embriq-nordic&lt;/groupId&gt;\n    &lt;artifactId&gt;aws-oidc-s3-maven-wagon&lt;/artifactId&gt;\n    &lt;version&gt;1.1.0&lt;/version&gt;\n&lt;/extension&gt;\n</code></pre>\n<p>Since it uses the second version of the SDK it uses the credentials provider chain used by that one.</p>\n"}],"owner":{"account_id":32251,"reputation":114942,"user_id":89266,"accept_rate":91,"display_name":"dfa"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":20135,"favorite_count":0,"down_vote_count":0,"up_vote_count":17,"answer_count":5,"score":17,"last_activity_date":1700055711,"creation_date":1242085802,"question_id":850570,"body_markdown":"How to deploy with wagon s3 provider?\r\n\r\nI&#39;ve found several plugins, most of them are incomplete, some of them are not maintaned. There is also a sandbox plugin from official maven SVN repository but I&#39;m figuring how to use it. \r\n\r\nAny hint?","title":"maven s3 wagon provider","body":"<p>How to deploy with wagon s3 provider?</p>\n\n<p>I've found several plugins, most of them are incomplete, some of them are not maintaned. There is also a sandbox plugin from official maven SVN repository but I'm figuring how to use it. </p>\n\n<p>Any hint?</p>\n"},{"tags":["java","json","jackson","deserialization","rest-assured"],"answers":[{"comments":[{"owner":{"account_id":10324546,"reputation":128,"user_id":7616393,"display_name":"baadnews"},"score":1,"creation_date":1487937453,"post_id":42436872,"comment_id":72020071,"body_markdown":"I mentioned that this value field can be array or object, that is why I used custom deserializer and I&#39;m using this construction \n@JsonDeserialize(using =ValueDeserializer.class)\nprivate Object value;\n\nvalue is just a one of the many field in my target object.","body":"I mentioned that this value field can be array or object, that is why I used custom deserializer and I&#39;m using this construction  @JsonDeserialize(using =ValueDeserializer.class) private Object value;  value is just a one of the many field in my target object."},{"owner":{"account_id":10324546,"reputation":128,"user_id":7616393,"display_name":"baadnews"},"score":0,"creation_date":1487946649,"post_id":42436872,"comment_id":72026087,"body_markdown":"Thank you for your answer. It works ok. I noticed in the different case that when I was using JsonPath to retrieve the objects from specific node there are decimal parts missing. According to issues list from the rest-assured project, JsonPath(string) will round decimal values.","body":"Thank you for your answer. It works ok. I noticed in the different case that when I was using JsonPath to retrieve the objects from specific node there are decimal parts missing. According to issues list from the rest-assured project, JsonPath(string) will round decimal values."}],"tags":[],"owner":{"account_id":4475914,"reputation":14398,"user_id":3641067,"accept_rate":73,"display_name":"bur&#230;quete"},"comment_count":2,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1487938067,"creation_date":1487933746,"answer_id":42436872,"question_id":42436666,"body_markdown":"Why not use `ObjectMapper` from Jackson? You can add `DeserializationFeature` to it unlike `ObjectCodec`. Mapper is actually extending Codec, but with more features that you need in this case.\r\n\r\n    ObjectMapper mapper = new ObjectMapper();\r\n    mapper.enable(DeserializationFeature.USE_BIG_DECIMAL_FOR_FLOATS);\r\n    \r\n    JsonNode node = //node where the value is defined as Double\r\n    \r\n    Double value = null;\r\n    try {\r\n        value = mapper.treeToValue(node, Double.class);\r\n    }\r\n    catch (IOException e) {\r\n        e.printStackTrace();\r\n    }\r\n    \r\n    System.out.println(value);\r\n\r\nUse the above logic in your `node.isDouble()` case","title":"Jackson deserialize Double","body":"<p>Why not use <code>ObjectMapper</code> from Jackson? You can add <code>DeserializationFeature</code> to it unlike <code>ObjectCodec</code>. Mapper is actually extending Codec, but with more features that you need in this case.</p>\n\n<pre><code>ObjectMapper mapper = new ObjectMapper();\nmapper.enable(DeserializationFeature.USE_BIG_DECIMAL_FOR_FLOATS);\n\nJsonNode node = //node where the value is defined as Double\n\nDouble value = null;\ntry {\n    value = mapper.treeToValue(node, Double.class);\n}\ncatch (IOException e) {\n    e.printStackTrace();\n}\n\nSystem.out.println(value);\n</code></pre>\n\n<p>Use the above logic in your <code>node.isDouble()</code> case</p>\n"},{"tags":[],"owner":{"account_id":29909316,"reputation":1,"user_id":22921146,"display_name":"Denys"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700055007,"creation_date":1700054879,"answer_id":77488084,"question_id":42436666,"body_markdown":"I managed to deserialize the doubles after adding **@AllArgsConstructor**\r\n\r\n\r\n    @AllArgsConstructor\r\n    public class Data {\r\n        private final Double first;\r\n        private final Double second;\r\n        private final Double third;\r\n    }","title":"Jackson deserialize Double","body":"<p>I managed to deserialize the doubles after adding <strong>@AllArgsConstructor</strong></p>\n<pre><code>@AllArgsConstructor\npublic class Data {\n    private final Double first;\n    private final Double second;\n    private final Double third;\n}\n</code></pre>\n"}],"owner":{"account_id":10324546,"reputation":128,"user_id":7616393,"display_name":"baadnews"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":7574,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":42436872,"answer_count":2,"score":2,"last_activity_date":1700055007,"creation_date":1487933143,"question_id":42436666,"body_markdown":"I have a problem with deserialization of the JSON using Jackson in my rest-assured tests. \r\nIn my JSON I have a key &quot;value&quot; that can be an array of Strings or object like Boolean. \r\n\r\n    {\r\n     &quot;value&quot;: [&quot;value1&quot;, &quot;value2&quot;]\r\n    }\r\nor \r\n\r\n    {\r\n    &quot;value&quot;: 2272204.2426\r\n    }\r\n\r\nSo I wrote custom deserializer for this field: \r\n\r\n    public Object deserialize(JsonParser jp, DeserializationContext ctxt) throws IOException {\r\n    \t\tObjectCodec oc = jp.getCodec();\r\n    \t\tJsonNode node = oc.readTree(jp);\r\n    \t\tif (node.isArray()) {\r\n    \t\t\tList&lt;String&gt; list = new ArrayList&lt;&gt;();\r\n    \t\t\tfor (JsonNode elementNode : node) {\r\n    \t\t\t\tlist.add(oc.treeToValue(elementNode, String.class));\r\n    \t\t\t}\r\n    \t\t\treturn list;\r\n    \t\t} else {\r\n    \t\t\tif(node.isDouble()) {\r\n    \t\t\t\treturn oc.treeToValue(node, Double.class);\r\n    \t\t\t}\r\n    \t\t\telse if(node.isBoolean()){\r\n    \t\t\t\treturn oc.treeToValue(node, Boolean.class);\r\n    \t\t\t}\r\n    \t\t\telse {\r\n    \t\t\t\treturn oc.treeToValue(node, String.class);\r\n    \t\t\t}\r\n    \t\t}\r\n    \t}\r\n\r\nIn the end I&#39;ve noticed that numeric value like 2272204.2426 is deserialized to 2272204.2 \r\nI tried to desierialize it using Gson and it works well. Do you have any idea why using Jackson there is lack of decimal part? \r\nI&#39;ve tried to debug the code and I&#39;ve noticed that on this step JsonNode node = oc.readTree(jp); the value is 2272204.2 ","title":"Jackson deserialize Double","body":"<p>I have a problem with deserialization of the JSON using Jackson in my rest-assured tests. \nIn my JSON I have a key \"value\" that can be an array of Strings or object like Boolean. </p>\n\n<pre><code>{\n \"value\": [\"value1\", \"value2\"]\n}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>{\n\"value\": 2272204.2426\n}\n</code></pre>\n\n<p>So I wrote custom deserializer for this field: </p>\n\n<pre><code>public Object deserialize(JsonParser jp, DeserializationContext ctxt) throws IOException {\n        ObjectCodec oc = jp.getCodec();\n        JsonNode node = oc.readTree(jp);\n        if (node.isArray()) {\n            List&lt;String&gt; list = new ArrayList&lt;&gt;();\n            for (JsonNode elementNode : node) {\n                list.add(oc.treeToValue(elementNode, String.class));\n            }\n            return list;\n        } else {\n            if(node.isDouble()) {\n                return oc.treeToValue(node, Double.class);\n            }\n            else if(node.isBoolean()){\n                return oc.treeToValue(node, Boolean.class);\n            }\n            else {\n                return oc.treeToValue(node, String.class);\n            }\n        }\n    }\n</code></pre>\n\n<p>In the end I've noticed that numeric value like 2272204.2426 is deserialized to 2272204.2 \nI tried to desierialize it using Gson and it works well. Do you have any idea why using Jackson there is lack of decimal part? \nI've tried to debug the code and I've noticed that on this step JsonNode node = oc.readTree(jp); the value is 2272204.2 </p>\n"},{"tags":["java","android","node.js","onesignal"],"answers":[{"tags":[],"owner":{"account_id":22773148,"reputation":6705,"user_id":16930239,"display_name":"user16930239"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700054983,"creation_date":1700054983,"answer_id":77488091,"question_id":77487619,"body_markdown":"&gt;The OneSignal ID is UUID generated by OneSignal to represent a user. The OneSignal ID will always be associated with a Subscription ID and/or alias, otherwise it will be deleted.\r\n\r\n&gt;A subscription refers to the ways a user can receive messages sent from OneSignal, like push notifications, SMS, and email. These messaging channels are each assigned a Subscription ID to uniquely identify that specific channel. In-app messages do not have a Subscription ID.\r\n\r\nYou can [Create alias (by subscription)][1] then use the Alias to send message.\r\n\r\n[create-notification][2]\r\n&gt;Target specific users by aliases assigned via API. An alias can be an external_id, onesignal_id, or a custom alias.\r\n\r\n\r\n  [1]: https://documentation.onesignal.com/reference/create-alias-by-subscription\r\n  [2]: https://documentation.onesignal.com/reference/create-notification","title":"Does onesignal subscription id work with a player id API","body":"<blockquote>\n<p>The OneSignal ID is UUID generated by OneSignal to represent a user. The OneSignal ID will always be associated with a Subscription ID and/or alias, otherwise it will be deleted.</p>\n</blockquote>\n<blockquote>\n<p>A subscription refers to the ways a user can receive messages sent from OneSignal, like push notifications, SMS, and email. These messaging channels are each assigned a Subscription ID to uniquely identify that specific channel. In-app messages do not have a Subscription ID.</p>\n</blockquote>\n<p>You can <a href=\"https://documentation.onesignal.com/reference/create-alias-by-subscription\" rel=\"nofollow noreferrer\">Create alias (by subscription)</a> then use the Alias to send message.</p>\n<p><a href=\"https://documentation.onesignal.com/reference/create-notification\" rel=\"nofollow noreferrer\">create-notification</a></p>\n<blockquote>\n<p>Target specific users by aliases assigned via API. An alias can be an external_id, onesignal_id, or a custom alias.</p>\n</blockquote>\n"}],"owner":{"account_id":17256253,"reputation":129,"user_id":12495265,"display_name":"jamesmungai"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":39,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1700054983,"creation_date":1700050493,"question_id":77487619,"body_markdown":"In my Java android SDK I&#39;m getting the subscription ID as follows and then sending it to my backend where im storing these subscription IDs in my DB but it doesnt seem to work when I try to send a notification using \r\n```\r\nIUserManager user = OneSignal.getUser();\r\nString subscriptionId = user.getPushSubscription().getId();\r\n```\r\nThis is my node js api code snippet\r\n```\r\nnotification.app_id = config.ONESIG_APP_ID;\r\n    notification.include_player_ids = subscriptionIds;\r\n    notification.contents = {\r\n      en: message,\r\n    };\r\n    client\r\n      .createNotification(notification)\r\n      .then((result) =&gt; {\r\n        resolve(result);\r\n      })\r\n      .catch((error) =&gt; {\r\n        resolve({ status: &#39;Failure&#39; });\r\n      });\r\n```","title":"Does onesignal subscription id work with a player id API","body":"<p>In my Java android SDK I'm getting the subscription ID as follows and then sending it to my backend where im storing these subscription IDs in my DB but it doesnt seem to work when I try to send a notification using</p>\n<pre><code>IUserManager user = OneSignal.getUser();\nString subscriptionId = user.getPushSubscription().getId();\n</code></pre>\n<p>This is my node js api code snippet</p>\n<pre><code>notification.app_id = config.ONESIG_APP_ID;\n    notification.include_player_ids = subscriptionIds;\n    notification.contents = {\n      en: message,\n    };\n    client\n      .createNotification(notification)\n      .then((result) =&gt; {\n        resolve(result);\n      })\n      .catch((error) =&gt; {\n        resolve({ status: 'Failure' });\n      });\n</code></pre>\n"},{"tags":["java","spring","spring-boot","java-8","spring-batch"],"comments":[{"owner":{"account_id":6482932,"reputation":29552,"user_id":5019386,"display_name":"Mahmoud Ben Hassine"},"score":0,"creation_date":1700125577,"post_id":77487955,"comment_id":136616954,"body_markdown":"`i to query from this 2 databases from different tables`: will queries produce the same item type, `CustomerCredit`? How should the reading happen, ie read from the first table, then the second table in sequence? Please provide more details. There is an open feature request for a composite reader (with an experimental implementation), see https://github.com/spring-projects/spring-batch/issues/757, but I am not sure it is what you are looking for.","body":"<code>i to query from this 2 databases from different tables</code>: will queries produce the same item type, <code>CustomerCredit</code>? How should the reading happen, ie read from the first table, then the second table in sequence? Please provide more details. There is an open feature request for a composite reader (with an experimental implementation), see <a href=\"https://github.com/spring-projects/spring-batch/issues/757\" rel=\"nofollow noreferrer\">github.com/spring-projects/spring-batch/issues/757</a>, but I am not sure it is what you are looking for."}],"owner":{"account_id":22894340,"reputation":17,"user_id":17034062,"display_name":"tarun singh"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":40,"favorite_count":0,"down_vote_count":2,"up_vote_count":1,"answer_count":0,"score":-1,"last_activity_date":1700054980,"creation_date":1700053697,"question_id":77487955,"body_markdown":"I&#39;m new to spring batch, I have a requirement like i have 2 different database/servers and i to query from this 2 databases from different tables for this i need to create a simple composite item reader which can fetch data from this 2 different tables of different databases. It would be helpful if someone provide a sample example in spring boot.\r\n        \r\nEx:\r\n```\r\n    @Bean\r\npublic JdbcPagingItemReader itemReader(DataSource dataSource, PagingQueryProvider queryProvider) {\r\n\tMap&lt;String, Object&gt; parameterValues = new HashMap&lt;&gt;();\r\n\tparameterValues.put(&quot;status&quot;, &quot;NEW&quot;);\r\n\r\n\treturn new JdbcPagingItemReaderBuilder&lt;CustomerCredit&gt;()\r\n           \t\t\t\t.name(&quot;creditReader&quot;)\r\n           \t\t\t\t.dataSource(dataSource)\r\n           \t\t\t\t.queryProvider(queryProvider)\r\n           \t\t\t\t.parameterValues(parameterValues)\r\n           \t\t\t\t.rowMapper(customerCreditMapper())\r\n           \t\t\t\t.pageSize(1000)\r\n           \t\t\t\t.build();\r\n}\r\n```\r\n    \r\nplease skip above example., it is not allowing to post without code.\r\nI googled but didn&#39;t get correct answers.","title":"Composite item reader in spring batch","body":"<p>I'm new to spring batch, I have a requirement like i have 2 different database/servers and i to query from this 2 databases from different tables for this i need to create a simple composite item reader which can fetch data from this 2 different tables of different databases. It would be helpful if someone provide a sample example in spring boot.</p>\n<p>Ex:</p>\n<pre><code>    @Bean\npublic JdbcPagingItemReader itemReader(DataSource dataSource, PagingQueryProvider queryProvider) {\n    Map&lt;String, Object&gt; parameterValues = new HashMap&lt;&gt;();\n    parameterValues.put(&quot;status&quot;, &quot;NEW&quot;);\n\n    return new JdbcPagingItemReaderBuilder&lt;CustomerCredit&gt;()\n                        .name(&quot;creditReader&quot;)\n                        .dataSource(dataSource)\n                        .queryProvider(queryProvider)\n                        .parameterValues(parameterValues)\n                        .rowMapper(customerCreditMapper())\n                        .pageSize(1000)\n                        .build();\n}\n</code></pre>\n<p>please skip above example., it is not allowing to post without code.\nI googled but didn't get correct answers.</p>\n"},{"tags":["java","maven","github-actions","gnupg","maven-gpg-plugin"],"comments":[{"owner":{"account_id":10402418,"reputation":12349,"user_id":7670262,"display_name":"Azeem"},"score":1,"creation_date":1700115943,"post_id":77488046,"comment_id":136615621,"body_markdown":"See https://gist.github.com/sualeh/ae78dc16123899d7942bc38baba5203c.","body":"See <a href=\"https://gist.github.com/sualeh/ae78dc16123899d7942bc38baba5203c\" rel=\"nofollow noreferrer\">gist.github.com/sualeh/ae78dc16123899d7942bc38baba5203c</a>."},{"owner":{"account_id":12324147,"reputation":121,"user_id":10013088,"display_name":"Hugo Bois"},"score":0,"creation_date":1700219211,"post_id":77488046,"comment_id":136630248,"body_markdown":"Thanks! I&#39;ve stumbled on upon that way of doing earlier but I&#39;d rather prefer to use the provided built-in parameter of setup-java action for the sake of consistency. That will be my last option for sure if there is no other way around","body":"Thanks! I&#39;ve stumbled on upon that way of doing earlier but I&#39;d rather prefer to use the provided built-in parameter of setup-java action for the sake of consistency. That will be my last option for sure if there is no other way around"},{"owner":{"account_id":10402418,"reputation":12349,"user_id":7670262,"display_name":"Azeem"},"score":0,"creation_date":1700220122,"post_id":77488046,"comment_id":136630397,"body_markdown":"No problem. Yes, that seems to be right way to automate this. You have already an active issue (https://github.com/actions/setup-java/issues/554) on the repo. Hopefully, you&#39;ll get the way forward with `actions/setup-java`.","body":"No problem. Yes, that seems to be right way to automate this. You have already an active issue (<a href=\"https://github.com/actions/setup-java/issues/554\" rel=\"nofollow noreferrer\">github.com/actions/setup-java/issues/554</a>) on the repo. Hopefully, you&#39;ll get the way forward with <code>actions&#47;setup-java</code>."},{"owner":{"account_id":12324147,"reputation":121,"user_id":10013088,"display_name":"Hugo Bois"},"score":0,"creation_date":1700220572,"post_id":77488046,"comment_id":136630469,"body_markdown":"Yes! I will make sure to update here as soon as I have hints about what&#39;s wrong ;)","body":"Yes! I will make sure to update here as soon as I have hints about what&#39;s wrong ;)"}],"owner":{"account_id":12324147,"reputation":121,"user_id":10013088,"display_name":"Hugo Bois"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":56,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700054513,"creation_date":1700054513,"question_id":77488046,"body_markdown":"**Objective** - I am currently trying to automate the deployment of a Java package to Maven Central through GitHub Actions. As publishing requires to sign artifacts I added **maven-gpg-plugin** to `pom.xml`. So far, so good.\r\n\r\n**Situation** - When the plugin got loaded, it fails on execution and then prompting this:\r\n\r\n    gpg: Sorry, no terminal at all requested - can&#39;t get input\r\n\r\nA solution suggested by [this another post][1] on the same topic is to remove the `--no-tty` option set by default in the **gpg.conf** file.\r\n\r\n**Problem** - Here is the thing. It doesn&#39;t appear we can alter this file using the actions/setup-java@v3 from GitHub Actions which yet exposes the possibility to provide GPG private key and passphrase.\r\n\r\n[Here][2] is the GitHub actions deployment workflow file and [here][3] the associated pom.xml. Am I missing something?\r\n\r\n\r\n  [1]: https://stackoverflow.com/a/40393581/10013088\r\n  [2]: https://github.com/Lycoon/clash-api/blob/dev/.github/workflows/deploy.yml\r\n  [3]: https://github.com/Lycoon/clash-api/blob/dev/pom.xml","title":"GitHub Actions - gpg: Sorry, no terminal at all requested - can&#39;t get input","body":"<p><strong>Objective</strong> - I am currently trying to automate the deployment of a Java package to Maven Central through GitHub Actions. As publishing requires to sign artifacts I added <strong>maven-gpg-plugin</strong> to <code>pom.xml</code>. So far, so good.</p>\n<p><strong>Situation</strong> - When the plugin got loaded, it fails on execution and then prompting this:</p>\n<pre><code>gpg: Sorry, no terminal at all requested - can't get input\n</code></pre>\n<p>A solution suggested by <a href=\"https://stackoverflow.com/a/40393581/10013088\">this another post</a> on the same topic is to remove the <code>--no-tty</code> option set by default in the <strong>gpg.conf</strong> file.</p>\n<p><strong>Problem</strong> - Here is the thing. It doesn't appear we can alter this file using the actions/setup-java@v3 from GitHub Actions which yet exposes the possibility to provide GPG private key and passphrase.</p>\n<p><a href=\"https://github.com/Lycoon/clash-api/blob/dev/.github/workflows/deploy.yml\" rel=\"nofollow noreferrer\">Here</a> is the GitHub actions deployment workflow file and <a href=\"https://github.com/Lycoon/clash-api/blob/dev/pom.xml\" rel=\"nofollow noreferrer\">here</a> the associated pom.xml. Am I missing something?</p>\n"},{"tags":["java","oracle","jdbc","ojdbc"],"answers":[{"tags":[],"owner":{"account_id":247217,"reputation":213465,"user_id":521799,"accept_rate":89,"display_name":"Lukas Eder"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1700054131,"creation_date":1645806222,"answer_id":71268782,"question_id":71268781,"body_markdown":"In my opinion, it used to be a bug in ojdbc. It no longer appears in version `23.3.0.23.09`. Workarounds for older ojdbc driver versions include:\r\n\r\n### Cast the bind variable\r\n\r\n```java\r\ntry (PreparedStatement s = connection.prepareStatement(\r\n    &quot;&quot;&quot;\r\n    select\r\n      json_arrayagg(\r\n        json_array(\r\n          (select json_arrayagg(json_array(?) format json) from dual) format json,\r\n          cast(? as number) -- cast here\r\n        )\r\n        format json\r\n      )\r\n    from dual\r\n    &quot;&quot;&quot;\r\n)) {\r\n    s.setInt(1, 1);\r\n    s.setInt(2, 2);\r\n\r\n    try (ResultSet rs = s.executeQuery()) {\r\n        while (rs.next())\r\n            System.out.println(rs.getString(1));\r\n    }\r\n}\r\n```\r\n\r\n### Remove the `FORMAT JSON` directive just before the bind parameter marker\r\n\r\n```java\r\ntry (PreparedStatement s = connection.prepareStatement(\r\n    &quot;&quot;&quot;\r\n    select\r\n      json_arrayagg(\r\n        json_array(\r\n          (select json_arrayagg(json_array(?) format json) from dual) /* no format json here */,\r\n          ?\r\n        )\r\n        format json\r\n      )\r\n    from dual\r\n    &quot;&quot;&quot;\r\n)) {\r\n    s.setInt(1, 1);\r\n    s.setInt(2, 2);\r\n\r\n    try (ResultSet rs = s.executeQuery()) {\r\n        while (rs.next())\r\n            System.out.println(rs.getString(1));\r\n    }\r\n}\r\n```\r\n\r\n### Using a dummy expression around the bind variable\r\n\r\n```java\r\ntry (PreparedStatement s = connection.prepareStatement(\r\n    &quot;&quot;&quot;\r\n    select\r\n      json_arrayagg(\r\n        json_array(\r\n          (select json_arrayagg(json_array(?) format json) from dual) format json,\r\n          nvl(null, ?) -- Dummy expression here\r\n        )\r\n        format json\r\n      )\r\n    from dual\r\n    &quot;&quot;&quot;\r\n)) {\r\n    s.setInt(1, 1);\r\n    s.setInt(2, 2);\r\n\r\n    try (ResultSet rs = s.executeQuery()) {\r\n        while (rs.next())\r\n            System.out.println(rs.getString(1));\r\n    }\r\n}\r\n```\r\n\r\n### Interleave a `null` value, and remove it again with `absent on null`\r\n\r\n```java\r\ntry (PreparedStatement s = connection.prepareStatement(\r\n    &quot;&quot;&quot;\r\n    select\r\n      json_arrayagg(\r\n        json_array(\r\n          (select json_arrayagg(json_array(?) format json) from dual) format json,\r\n          null, -- This is ignored\r\n          ?\r\n          absent on null\r\n        )\r\n        format json\r\n      )\r\n    from dual\r\n    &quot;&quot;&quot;\r\n)) {\r\n    s.setInt(1, 1);\r\n    s.setInt(2, 2);\r\n\r\n    try (ResultSet rs = s.executeQuery()) {\r\n        while (rs.next())\r\n            System.out.println(rs.getString(1));\r\n    }\r\n}\r\n```","title":"Why can&#39;t a bind variable be used from ojdbc with Oracle JSON_ARRAY() in the presence of FORMAT JSON","body":"<p>In my opinion, it used to be a bug in ojdbc. It no longer appears in version <code>23.3.0.23.09</code>. Workarounds for older ojdbc driver versions include:</p>\n<h3>Cast the bind variable</h3>\n<pre class=\"lang-java prettyprint-override\"><code>try (PreparedStatement s = connection.prepareStatement(\n    &quot;&quot;&quot;\n    select\n      json_arrayagg(\n        json_array(\n          (select json_arrayagg(json_array(?) format json) from dual) format json,\n          cast(? as number) -- cast here\n        )\n        format json\n      )\n    from dual\n    &quot;&quot;&quot;\n)) {\n    s.setInt(1, 1);\n    s.setInt(2, 2);\n\n    try (ResultSet rs = s.executeQuery()) {\n        while (rs.next())\n            System.out.println(rs.getString(1));\n    }\n}\n</code></pre>\n<h3>Remove the <code>FORMAT JSON</code> directive just before the bind parameter marker</h3>\n<pre class=\"lang-java prettyprint-override\"><code>try (PreparedStatement s = connection.prepareStatement(\n    &quot;&quot;&quot;\n    select\n      json_arrayagg(\n        json_array(\n          (select json_arrayagg(json_array(?) format json) from dual) /* no format json here */,\n          ?\n        )\n        format json\n      )\n    from dual\n    &quot;&quot;&quot;\n)) {\n    s.setInt(1, 1);\n    s.setInt(2, 2);\n\n    try (ResultSet rs = s.executeQuery()) {\n        while (rs.next())\n            System.out.println(rs.getString(1));\n    }\n}\n</code></pre>\n<h3>Using a dummy expression around the bind variable</h3>\n<pre class=\"lang-java prettyprint-override\"><code>try (PreparedStatement s = connection.prepareStatement(\n    &quot;&quot;&quot;\n    select\n      json_arrayagg(\n        json_array(\n          (select json_arrayagg(json_array(?) format json) from dual) format json,\n          nvl(null, ?) -- Dummy expression here\n        )\n        format json\n      )\n    from dual\n    &quot;&quot;&quot;\n)) {\n    s.setInt(1, 1);\n    s.setInt(2, 2);\n\n    try (ResultSet rs = s.executeQuery()) {\n        while (rs.next())\n            System.out.println(rs.getString(1));\n    }\n}\n</code></pre>\n<h3>Interleave a <code>null</code> value, and remove it again with <code>absent on null</code></h3>\n<pre class=\"lang-java prettyprint-override\"><code>try (PreparedStatement s = connection.prepareStatement(\n    &quot;&quot;&quot;\n    select\n      json_arrayagg(\n        json_array(\n          (select json_arrayagg(json_array(?) format json) from dual) format json,\n          null, -- This is ignored\n          ?\n          absent on null\n        )\n        format json\n      )\n    from dual\n    &quot;&quot;&quot;\n)) {\n    s.setInt(1, 1);\n    s.setInt(2, 2);\n\n    try (ResultSet rs = s.executeQuery()) {\n        while (rs.next())\n            System.out.println(rs.getString(1));\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":247217,"reputation":213465,"user_id":521799,"accept_rate":89,"display_name":"Lukas Eder"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":366,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":71268782,"answer_count":1,"score":2,"last_activity_date":1700054131,"creation_date":1645806222,"question_id":71268781,"body_markdown":"In Oracle, the following query:\r\n\r\n```sql\r\nselect\r\n  json_arrayagg(\r\n    json_array(\r\n      (select json_arrayagg(json_array(1) format json) from dual) format json,\r\n      2\r\n    )\r\n    format json\r\n  )\r\nfrom dual\r\n```\r\n\r\nProduces the following JSON document:\r\n\r\n```none\r\n[[[[1]],2]]\r\n```\r\n\r\nWhen I try to run this query with bind variables from JDBC like this:\r\n\r\n```java\r\ntry (PreparedStatement s = connection.prepareStatement(\r\n    &quot;&quot;&quot;\r\n    select\r\n      json_arrayagg(\r\n        json_array(\r\n          (select json_arrayagg(json_array(?) format json) from dual) format json,\r\n          ?\r\n        )\r\n        format json\r\n      )\r\n    from dual\r\n    &quot;&quot;&quot;\r\n)) {\r\n    s.setInt(1, 1);\r\n    s.setInt(2, 2); // This fails\r\n\r\n    try (ResultSet rs = s.executeQuery()) {\r\n        while (rs.next())\r\n            System.out.println(rs.getString(1));\r\n    }\r\n}\r\n```\r\n\r\nThen I&#39;m getting:\r\n\r\n```none\r\nException in thread &quot;main&quot; java.sql.SQLException: Invalid column index\r\n\tat oracle.jdbc.driver.OraclePreparedStatement.setIntInternal(OraclePreparedStatement.java:4956)\r\n\tat oracle.jdbc.driver.OraclePreparedStatement.setInt(OraclePreparedStatement.java:4947)\r\n\tat oracle.jdbc.driver.OraclePreparedStatementWrapper.setInt(OraclePreparedStatementWrapper.java:202)\r\n\tat org.jooq.testscripts.JDBC.main(JDBC.java:50)\r\n```\r\n\r\nI&#39;m using these versions:\r\n\r\n- Database: Oracle Database 21c Express Edition Release 21.0.0.0.0 - Production\r\n- ojdbc: com.oracle.database.jdbc:ojdbc11:21.5.0.0\r\n\r\nIs this a bug? Can it be worked around?","title":"Why can&#39;t a bind variable be used from ojdbc with Oracle JSON_ARRAY() in the presence of FORMAT JSON","body":"<p>In Oracle, the following query:</p>\n<pre class=\"lang-sql prettyprint-override\"><code>select\n  json_arrayagg(\n    json_array(\n      (select json_arrayagg(json_array(1) format json) from dual) format json,\n      2\n    )\n    format json\n  )\nfrom dual\n</code></pre>\n<p>Produces the following JSON document:</p>\n<pre class=\"lang-none prettyprint-override\"><code>[[[[1]],2]]\n</code></pre>\n<p>When I try to run this query with bind variables from JDBC like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>try (PreparedStatement s = connection.prepareStatement(\n    &quot;&quot;&quot;\n    select\n      json_arrayagg(\n        json_array(\n          (select json_arrayagg(json_array(?) format json) from dual) format json,\n          ?\n        )\n        format json\n      )\n    from dual\n    &quot;&quot;&quot;\n)) {\n    s.setInt(1, 1);\n    s.setInt(2, 2); // This fails\n\n    try (ResultSet rs = s.executeQuery()) {\n        while (rs.next())\n            System.out.println(rs.getString(1));\n    }\n}\n</code></pre>\n<p>Then I'm getting:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Exception in thread &quot;main&quot; java.sql.SQLException: Invalid column index\n    at oracle.jdbc.driver.OraclePreparedStatement.setIntInternal(OraclePreparedStatement.java:4956)\n    at oracle.jdbc.driver.OraclePreparedStatement.setInt(OraclePreparedStatement.java:4947)\n    at oracle.jdbc.driver.OraclePreparedStatementWrapper.setInt(OraclePreparedStatementWrapper.java:202)\n    at org.jooq.testscripts.JDBC.main(JDBC.java:50)\n</code></pre>\n<p>I'm using these versions:</p>\n<ul>\n<li>Database: Oracle Database 21c Express Edition Release 21.0.0.0.0 - Production</li>\n<li>ojdbc: com.oracle.database.jdbc:ojdbc11:21.5.0.0</li>\n</ul>\n<p>Is this a bug? Can it be worked around?</p>\n"},{"tags":["java","unit-testing","dependency-injection","mockito","guice"],"answers":[{"comments":[{"owner":{"account_id":1736824,"reputation":5410,"user_id":1589188,"accept_rate":66,"display_name":"user1589188"},"score":0,"creation_date":1700045945,"post_id":77487106,"comment_id":136605906,"body_markdown":"Thanks knittl, I can confirm what you said about the `MockitoJUnitRunner` sets up the mocks already is true. However, it does not assign `classA` for me (even though `classToTest` is created), thats why I needed that extra `openMocks()`. Seems the question can be &quot;how to tell Mockito to also assign `classA` by the `MockitoJUnitRunner`?","body":"Thanks knittl, I can confirm what you said about the <code>MockitoJUnitRunner</code> sets up the mocks already is true. However, it does not assign <code>classA</code> for me (even though <code>classToTest</code> is created), thats why I needed that extra <code>openMocks()</code>. Seems the question can be &quot;how to tell Mockito to also assign <code>classA</code> by the <code>MockitoJUnitRunner</code>?"},{"owner":{"account_id":39208,"reputation":251260,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"score":0,"creation_date":1700046207,"post_id":77487106,"comment_id":136605943,"body_markdown":"@user1589188 What is `classA` (`mockClassA`)? It should be created and assigned by Mockito. Is it a class or an interface? You generally shouldn&#39;t mock classes. Does it have a public constructor? (It&#39;s weird that `openMocks` would create it, but the annotation does not – I&#39;d expect the annotation to perform the same method call behind the scenes)","body":"@user1589188 What is <code>classA</code> (<code>mockClassA</code>)? It should be created and assigned by Mockito. Is it a class or an interface? You generally shouldn&#39;t mock classes. Does it have a public constructor? (It&#39;s weird that <code>openMocks</code> would create it, but the annotation does not – I&#39;d expect the annotation to perform the same method call behind the scenes)"},{"owner":{"account_id":39208,"reputation":251260,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"score":0,"creation_date":1700046428,"post_id":77487106,"comment_id":136605972,"body_markdown":"@user1589188 find the updated answer, maybe that&#39;s helpful. Without seeing `ClassA` and `ClassB`, it&#39;s difficult to given an answer. It might also be worthwhile to migrate to JUnit 5, as JUnit 4 is already outdated.","body":"@user1589188 find the updated answer, maybe that&#39;s helpful. Without seeing <code>ClassA</code> and <code>ClassB</code>, it&#39;s difficult to given an answer. It might also be worthwhile to migrate to JUnit 5, as JUnit 4 is already outdated."},{"owner":{"account_id":1736824,"reputation":5410,"user_id":1589188,"accept_rate":66,"display_name":"user1589188"},"score":0,"creation_date":1700053342,"post_id":77487106,"comment_id":136607155,"body_markdown":"Thank you! That `mock()` without using annotation worked!","body":"Thank you! That <code>mock()</code> without using annotation worked!"}],"tags":[],"owner":{"account_id":39208,"reputation":251260,"user_id":112968,"accept_rate":68,"display_name":"knittl"},"comment_count":4,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1700046387,"creation_date":1700045496,"answer_id":77487106,"question_id":77486947,"body_markdown":"`@RunWith(MockitoJUnitRunner.class)` should already initialize all `@Mock`-and `@InjectMocks`-annotated fields.\r\n\r\n`MockitoAnnotations.openMocks` is only required if you do not use the annotation and must manually initialize the fields.\r\n\r\n```\r\n@RunWith(MockitoJUnitRunner.class)\r\npublic class MyTest {\r\n    @Mock ClassA mockClassA;\r\n    @Mock ClassB mockClassB;\r\n    @InjectMocks ClassToTest classToTest;\r\n    @Before public void setup() {\r\n        when(mockClassB.someCall()).thenReturn(whatever);\r\n    }\r\n\r\n    @Test public void test() {\r\n        // use this.classToTest\r\n    }\r\n}\r\n```\r\n\r\nIt might be possible to do it without the `@Mock` annotations by assigning the fields directly:\r\n\r\n```\r\n@RunWith(MockitoJUnitRunner.class)\r\npublic class MyTest {\r\n    ClassA mockClassA = mock(ClassA.class);\r\n    ClassB mockClassB = mock(ClassB.class);\r\n    @InjectMocks ClassToTest classToTest;\r\n    @Before public void setup() {\r\n        when(mockClassB.someCall()).thenReturn(whatever);\r\n    }\r\n\r\n    @Test public void test() {\r\n        // use this.classToTest\r\n    }\r\n}\r\n```\r\n\r\nor\r\n\r\n```\r\npublic class MyTest {\r\n    ClassA mockClassA = mock(ClassA.class);\r\n    ClassB mockClassB = mock(ClassB.class);\r\n    @InjectMocks ClassToTest classToTest;\r\n    AutoCloseable closeable;\r\n    @Before public void setup() {\r\n        closeable = MockitoAnnotations.openMocks(this);\r\n        when(mockClassB.someCall()).thenReturn(whatever);\r\n    }\r\n\r\n    @Test public void test() {\r\n        // use this.classToTest\r\n    }\r\n}\r\n```\r\n\r\nAlternatively, create all mock objects manually and use reflection to assign the fields of your class under test.\r\n\r\nOf course it always pays off to design your classes to be testable, which means that their dependencies are passed via the constructor.\r\n\r\nThis is similar to https://stackoverflow.com/questions/74027324/why-are-my-mocked-methods-not-called-when-executing-a-unit-test (distinct references to two distinct mock objects, with your test referencing one and your class referencing a different one).","title":"Mockito replaced already mocked objects with new ones after calling openMocks for InjectMocks annotated object","body":"<p><code>@RunWith(MockitoJUnitRunner.class)</code> should already initialize all <code>@Mock</code>-and <code>@InjectMocks</code>-annotated fields.</p>\n<p><code>MockitoAnnotations.openMocks</code> is only required if you do not use the annotation and must manually initialize the fields.</p>\n<pre><code>@RunWith(MockitoJUnitRunner.class)\npublic class MyTest {\n    @Mock ClassA mockClassA;\n    @Mock ClassB mockClassB;\n    @InjectMocks ClassToTest classToTest;\n    @Before public void setup() {\n        when(mockClassB.someCall()).thenReturn(whatever);\n    }\n\n    @Test public void test() {\n        // use this.classToTest\n    }\n}\n</code></pre>\n<p>It might be possible to do it without the <code>@Mock</code> annotations by assigning the fields directly:</p>\n<pre><code>@RunWith(MockitoJUnitRunner.class)\npublic class MyTest {\n    ClassA mockClassA = mock(ClassA.class);\n    ClassB mockClassB = mock(ClassB.class);\n    @InjectMocks ClassToTest classToTest;\n    @Before public void setup() {\n        when(mockClassB.someCall()).thenReturn(whatever);\n    }\n\n    @Test public void test() {\n        // use this.classToTest\n    }\n}\n</code></pre>\n<p>or</p>\n<pre><code>public class MyTest {\n    ClassA mockClassA = mock(ClassA.class);\n    ClassB mockClassB = mock(ClassB.class);\n    @InjectMocks ClassToTest classToTest;\n    AutoCloseable closeable;\n    @Before public void setup() {\n        closeable = MockitoAnnotations.openMocks(this);\n        when(mockClassB.someCall()).thenReturn(whatever);\n    }\n\n    @Test public void test() {\n        // use this.classToTest\n    }\n}\n</code></pre>\n<p>Alternatively, create all mock objects manually and use reflection to assign the fields of your class under test.</p>\n<p>Of course it always pays off to design your classes to be testable, which means that their dependencies are passed via the constructor.</p>\n<p>This is similar to <a href=\"https://stackoverflow.com/questions/74027324/why-are-my-mocked-methods-not-called-when-executing-a-unit-test\">Why are my mocked methods not called when executing a unit test?</a> (distinct references to two distinct mock objects, with your test referencing one and your class referencing a different one).</p>\n"},{"tags":[],"owner":{"account_id":1736824,"reputation":5410,"user_id":1589188,"accept_rate":66,"display_name":"user1589188"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700054117,"creation_date":1700054117,"answer_id":77488006,"question_id":77486947,"body_markdown":"Thanks to @knittl&#39;s idea, I ended up with this refined solution:\r\n\r\n    //@RunWith(MockitoJUnitRunner.class) no need\r\n    public class MyTest {\r\n        @Mock ClassA mockClassA;\r\n        ClassB mockClassB = mock(ClassB.class);\r\n        @InjectMocks ClassToTest classToTest = new ClassToTest(mockClassB);\r\n        AutoCloseable closeable;\r\n        @Before public void openMocks() {\r\n            closeable = MockitoAnnotations.openMocks(this);\r\n        }\r\n        //...\r\n    }","title":"Mockito replaced already mocked objects with new ones after calling openMocks for InjectMocks annotated object","body":"<p>Thanks to @knittl's idea, I ended up with this refined solution:</p>\n<pre><code>//@RunWith(MockitoJUnitRunner.class) no need\npublic class MyTest {\n    @Mock ClassA mockClassA;\n    ClassB mockClassB = mock(ClassB.class);\n    @InjectMocks ClassToTest classToTest = new ClassToTest(mockClassB);\n    AutoCloseable closeable;\n    @Before public void openMocks() {\n        closeable = MockitoAnnotations.openMocks(this);\n    }\n    //...\n}\n</code></pre>\n"}],"owner":{"account_id":1736824,"reputation":5410,"user_id":1589188,"accept_rate":66,"display_name":"user1589188"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":28,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77487106,"answer_count":2,"score":0,"last_activity_date":1700054117,"creation_date":1700044056,"question_id":77486947,"body_markdown":"I have this weird situation that Mockito is replacing already mocked objects with new ones after calling `openMocks()` for `@InjectMocks` annotated object.\r\n\r\nHere is my setup:\r\n\r\n    @RunWith(MockitoJUnitRunner.class) public class MyTest {\r\n        @Mock ClassA mockClassA;\r\n        @Mock ClassB mockClassB;\r\n        @InjectMocks ClassToTest classToTest;\r\n        AutoCloseable closeable;\r\n        @Before public void openMocks() {\r\n            closeable = MockitoAnnotations.openMocks(this);\r\n        }\r\n        //...\r\n    }\r\n\r\n    public class ClassToTest {\r\n        @Inject private ClassA classA;\r\n        private final ClassB classB;\r\n        @Inject public ClassToTest(ClassB classB) {\r\n            this.classB = classB;\r\n        }\r\n    }\r\n\r\nP.S. I don&#39;t have control over `ClassToTest`, I can&#39;t rewrite it to move the private member `classA` to the constructor.\r\n\r\nHere I want to mock both `classA` and `classB`, while the test is for `ClassToTest`. Since `classA` is not set via constructor, I need to use `@InjectMocks` for Mockito to set it for me. And it did set it correctly with `mockClassA` I have in the test.\r\n\r\nHowever, the problem is with `classB`. I set a breakpoint before `openMocks()`, there I could see `classToTest.classA` = `null` and `classToTest.classB` = `mockClassB`, which is expected. Then after calling `openMocks()`, I could see `classToTest.classA` = `mockClassA`, which is nice. But `classToTest.classB` now becomes a new mock object not `mockClassB` anymore. Since I need to setup the mock returns for `mockClassB`, replacing it with a new mock is not going to work.\r\n\r\nIs there a way to tell Mockito not to swap `classB` with a new mock?","title":"Mockito replaced already mocked objects with new ones after calling openMocks for InjectMocks annotated object","body":"<p>I have this weird situation that Mockito is replacing already mocked objects with new ones after calling <code>openMocks()</code> for <code>@InjectMocks</code> annotated object.</p>\n<p>Here is my setup:</p>\n<pre><code>@RunWith(MockitoJUnitRunner.class) public class MyTest {\n    @Mock ClassA mockClassA;\n    @Mock ClassB mockClassB;\n    @InjectMocks ClassToTest classToTest;\n    AutoCloseable closeable;\n    @Before public void openMocks() {\n        closeable = MockitoAnnotations.openMocks(this);\n    }\n    //...\n}\n\npublic class ClassToTest {\n    @Inject private ClassA classA;\n    private final ClassB classB;\n    @Inject public ClassToTest(ClassB classB) {\n        this.classB = classB;\n    }\n}\n</code></pre>\n<p>P.S. I don't have control over <code>ClassToTest</code>, I can't rewrite it to move the private member <code>classA</code> to the constructor.</p>\n<p>Here I want to mock both <code>classA</code> and <code>classB</code>, while the test is for <code>ClassToTest</code>. Since <code>classA</code> is not set via constructor, I need to use <code>@InjectMocks</code> for Mockito to set it for me. And it did set it correctly with <code>mockClassA</code> I have in the test.</p>\n<p>However, the problem is with <code>classB</code>. I set a breakpoint before <code>openMocks()</code>, there I could see <code>classToTest.classA</code> = <code>null</code> and <code>classToTest.classB</code> = <code>mockClassB</code>, which is expected. Then after calling <code>openMocks()</code>, I could see <code>classToTest.classA</code> = <code>mockClassA</code>, which is nice. But <code>classToTest.classB</code> now becomes a new mock object not <code>mockClassB</code> anymore. Since I need to setup the mock returns for <code>mockClassB</code>, replacing it with a new mock is not going to work.</p>\n<p>Is there a way to tell Mockito not to swap <code>classB</code> with a new mock?</p>\n"},{"tags":["java","dependencies","apache-commons-logging"],"answers":[{"tags":[],"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1699947063,"creation_date":1699947063,"answer_id":77478841,"question_id":77475966,"body_markdown":"&gt; I am looking for help to fix this error and understand why it occurs.\r\n\r\nIt is happening because *something* in your application and/or its dependencies depends on that `LogFactory` class.  That is indisputable.\r\n\r\nAs best as I can tell, your class `TokenGenerator` is still making use of Apache Commons Logging. That is what the stacktrace seems to say. \r\n\r\nSo either:\r\n\r\n1. the stacktrace is out of date, \r\n2. the copy of `TokenGenerator.class` that is being used at runtime is out of date, or \r\n3. you forgot to update `TokenGenerator.java`. \r\n\r\nOn the other hand, if `TokenGenerator.java` is not your code, then you need to modify the project configuration so that the JAR file for Apache Commons Logging is present at runtime!\r\n\r\n&gt;  Is there something I&#39;m overlooking in my configuration or dependency management?\r\n\r\nQuite possibly.  For example, you have only told us what *you think* you did and checked.  You haven&#39;t shown us the configuration or dependency management stuff, etc.\r\n\r\n&gt; How can I resolve this issue and run my application without this error?\r\n\r\nEither remove the remaining references to the dependency from your application and its (transitive!) dependencies **that must exist**, or make sure that the requisite JAR is included.\r\n\r\n----------------------\r\n\r\n(I am assuming that there aren&#39;t other exceptions that you haven&#39;t told us about; i.e. exceptions resulting from failed static initialization that happened **before** this one.  A static initialization failure for a class will render other classes uninitializable, and that can result in cascading exceptions.)","title":"Error running Java EE application with GlassFish: NoClassDefFoundError: org/apache/commons/logging/LogFactory","body":"<blockquote>\n<p>I am looking for help to fix this error and understand why it occurs.</p>\n</blockquote>\n<p>It is happening because <em>something</em> in your application and/or its dependencies depends on that <code>LogFactory</code> class.  That is indisputable.</p>\n<p>As best as I can tell, your class <code>TokenGenerator</code> is still making use of Apache Commons Logging. That is what the stacktrace seems to say.</p>\n<p>So either:</p>\n<ol>\n<li>the stacktrace is out of date,</li>\n<li>the copy of <code>TokenGenerator.class</code> that is being used at runtime is out of date, or</li>\n<li>you forgot to update <code>TokenGenerator.java</code>.</li>\n</ol>\n<p>On the other hand, if <code>TokenGenerator.java</code> is not your code, then you need to modify the project configuration so that the JAR file for Apache Commons Logging is present at runtime!</p>\n<blockquote>\n<p>Is there something I'm overlooking in my configuration or dependency management?</p>\n</blockquote>\n<p>Quite possibly.  For example, you have only told us what <em>you think</em> you did and checked.  You haven't shown us the configuration or dependency management stuff, etc.</p>\n<blockquote>\n<p>How can I resolve this issue and run my application without this error?</p>\n</blockquote>\n<p>Either remove the remaining references to the dependency from your application and its (transitive!) dependencies <strong>that must exist</strong>, or make sure that the requisite JAR is included.</p>\n<hr />\n<p>(I am assuming that there aren't other exceptions that you haven't told us about; i.e. exceptions resulting from failed static initialization that happened <strong>before</strong> this one.  A static initialization failure for a class will render other classes uninitializable, and that can result in cascading exceptions.)</p>\n"},{"tags":[],"owner":{"account_id":29692301,"reputation":21,"user_id":22756413,"display_name":"Miguel"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1700053940,"creation_date":1700053940,"answer_id":77487985,"question_id":77475966,"body_markdown":"What I did was reload all the JAR into the lib of the payara domains, restart it and from there, clean and build the project and it worked.","title":"Error running Java EE application with GlassFish: NoClassDefFoundError: org/apache/commons/logging/LogFactory","body":"<p>What I did was reload all the JAR into the lib of the payara domains, restart it and from there, clean and build the project and it worked.</p>\n"}],"owner":{"account_id":29692301,"reputation":21,"user_id":22756413,"display_name":"Miguel"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":40,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":77487985,"answer_count":2,"score":1,"last_activity_date":1700053940,"creation_date":1699899038,"question_id":77475966,"body_markdown":"When trying to run a Java EE application with GlassFish, I encounter the following error on the server:\r\n```java\r\nCaused by: java.lang.NoClassDefFoundError: org/apache/commons/logging/LogFactory\r\n\tat org.apache.http.conn.ssl.DefaultHostnameVerifier.&lt;init&gt;(DefaultHostnameVerifier.java:72)\r\n\t...\r\n...\r\nCaused by: java.lang.ClassNotFoundException: org.apache.commons.logging.LogFactory\r\n\tat dynamics365.TokenGenerator.ejecutarTokenGenerator(TokenGenerator.java:62)\r\n\tat sessionBeans.ParametroFacade.buscarCliente(ParametroFacade.java:103)\r\n\t\tat com.sun.enterprise.loader.ASURLClassLoader.findClassData(ASURLClassLoader.java:808)\r\n\t...\r\n```\r\n\r\nWhat I&#39;ve tried:\r\n\r\n- I have reviewed the project configuration to make sure all dependencies are configured correctly.\r\n- I have removed the use of Apache Commons Logging as it appears to be the cause of the problem.\r\n- I have cleaned and rebuilt the project to make sure there are no outdated build artifacts.\r\n- I&#39;ve reviewed the project structure and GlassFish server configuration to ensure everything is in order.\r\n\r\nWait:\r\n\r\nI am looking for help to fix this error and understand why it occurs. Is there something I&#39;m overlooking in my configuration or dependency management? How can I resolve this issue and run my application without this error?","title":"Error running Java EE application with GlassFish: NoClassDefFoundError: org/apache/commons/logging/LogFactory","body":"<p>When trying to run a Java EE application with GlassFish, I encounter the following error on the server:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Caused by: java.lang.NoClassDefFoundError: org/apache/commons/logging/LogFactory\n    at org.apache.http.conn.ssl.DefaultHostnameVerifier.&lt;init&gt;(DefaultHostnameVerifier.java:72)\n    ...\n...\nCaused by: java.lang.ClassNotFoundException: org.apache.commons.logging.LogFactory\n    at dynamics365.TokenGenerator.ejecutarTokenGenerator(TokenGenerator.java:62)\n    at sessionBeans.ParametroFacade.buscarCliente(ParametroFacade.java:103)\n        at com.sun.enterprise.loader.ASURLClassLoader.findClassData(ASURLClassLoader.java:808)\n    ...\n</code></pre>\n<p>What I've tried:</p>\n<ul>\n<li>I have reviewed the project configuration to make sure all dependencies are configured correctly.</li>\n<li>I have removed the use of Apache Commons Logging as it appears to be the cause of the problem.</li>\n<li>I have cleaned and rebuilt the project to make sure there are no outdated build artifacts.</li>\n<li>I've reviewed the project structure and GlassFish server configuration to ensure everything is in order.</li>\n</ul>\n<p>Wait:</p>\n<p>I am looking for help to fix this error and understand why it occurs. Is there something I'm overlooking in my configuration or dependency management? How can I resolve this issue and run my application without this error?</p>\n"},{"tags":["java","apache-spark","kubernetes","distributed-computing","distributed-system"],"owner":{"account_id":7629544,"reputation":335,"user_id":5785058,"display_name":"Shiv Krishna Jaiswal"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":20,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700053498,"creation_date":1700052315,"question_id":77487811,"body_markdown":"I have a function and list of dictionaries. Each dictionary represent some configuration. Function takes one configuration and processes it.\r\n\r\nI wanted to distribute tasks/jobs (each task consists of function and a configuration) over, say `n` servers and was wondering if this can be done using Apache Spark.\r\n\r\nI googled resources but they were mostly around SQL, processing the data frame etc.\r\n\r\n**Question:** \r\n1. Can this be done using Apache Spark? if yes, can we also control number of cores that can be used by each task running on a server?\r\n2. Is Apache Spark the right tool for this setup?\r\n\r\nEdit: Seems like [Kubernetes](https://johndanielraines.medium.com/workload-parallelization-in-kubernetes-with-python-diy-style-1dfd32cf4366) is the right choice for such setups.","title":"Running Custom Jobs in parallet/distributed manner in Apache Spark","body":"<p>I have a function and list of dictionaries. Each dictionary represent some configuration. Function takes one configuration and processes it.</p>\n<p>I wanted to distribute tasks/jobs (each task consists of function and a configuration) over, say <code>n</code> servers and was wondering if this can be done using Apache Spark.</p>\n<p>I googled resources but they were mostly around SQL, processing the data frame etc.</p>\n<p><strong>Question:</strong></p>\n<ol>\n<li>Can this be done using Apache Spark? if yes, can we also control number of cores that can be used by each task running on a server?</li>\n<li>Is Apache Spark the right tool for this setup?</li>\n</ol>\n<p>Edit: Seems like <a href=\"https://johndanielraines.medium.com/workload-parallelization-in-kubernetes-with-python-diy-style-1dfd32cf4366\" rel=\"nofollow noreferrer\">Kubernetes</a> is the right choice for such setups.</p>\n"},{"tags":["java","spring-boot","keycloak","role-base-authorization"],"owner":{"account_id":29527287,"reputation":1,"user_id":22628618,"display_name":"Shivani Chappidi"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":84,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700052996,"creation_date":1700052786,"question_id":77487857,"body_markdown":"I have a spring boot application implemented with keycloak security \r\nso i want to display a error message when a user having no roles  tries to login  \r\n I have this login.ftl page \r\n\r\n\r\n```\r\n&lt;#import &quot;template.ftl&quot; as layout&gt;\r\n&lt;@layout.registrationLayout displayMessage=!messagesPerField.existsError(&#39;username&#39;,&#39;password&#39;) displayInfo=realm.password &amp;&amp; realm.registrationAllowed &amp;&amp; !registrationDisabled??; section&gt;\r\n    &lt;#if section = &quot;header&quot;&gt;\r\n        ${msg(&quot;loginAccountTitle&quot;)}\r\n    &lt;#elseif section = &quot;form&quot;&gt;\r\n    &lt;div id=&quot;kc-form&quot;&gt;\r\n      &lt;div id=&quot;kc-form-wrapper&quot;&gt;\r\n      &lt;marquee behavior=&quot;scroll&quot; direction=&quot;left&quot; scrollamount=&quot;5&quot;&gt;\r\n    This is a scrolling text using the marquee tag.\r\n&lt;/marquee&gt;\r\n        &lt;#if realm.password&gt;\r\n            &lt;form id=&quot;kc-form-login&quot; onsubmit=&quot;login.disabled = true; return true;&quot; action=&quot;${url.loginAction}&quot; method=&quot;post&quot;&gt;\r\n                &lt;#if !usernameHidden??&gt;\r\n                    &lt;div class=&quot;${properties.kcFormGroupClass!}&quot;&gt;\r\n                        &lt;label for=&quot;username&quot; class=&quot;${properties.kcLabelClass!}&quot;&gt;&lt;#if !realm.loginWithEmailAllowed&gt;${msg(&quot;username&quot;)}&lt;#elseif !realm.registrationEmailAsUsername&gt;${msg(&quot;usernameOrEmail&quot;)}&lt;#else&gt;${msg(&quot;email&quot;)}&lt;/#if&gt;&lt;/label&gt;\r\n\r\n                        &lt;input tabindex=&quot;1&quot; id=&quot;username&quot; class=&quot;${properties.kcInputClass!}&quot; name=&quot;username&quot; value=&quot;${(login.username!&#39;&#39;)}&quot;  type=&quot;text&quot; autofocus autocomplete=&quot;off&quot;\r\n                               aria-invalid=&quot;&lt;#if messagesPerField.existsError(&#39;username&#39;,&#39;password&#39;)&gt;true&lt;/#if&gt;&quot;\r\n                        /&gt;\r\n\r\n                        &lt;#if messagesPerField.existsError(&#39;username&#39;,&#39;password&#39;)&gt;\r\n                            &lt;span id=&quot;input-error&quot; class=&quot;${properties.kcInputErrorMessageClass!}&quot; aria-live=&quot;polite&quot;&gt;\r\n                                    ${kcSanitize(messagesPerField.getFirstError(&#39;username&#39;,&#39;password&#39;))?no_esc}\r\n                            &lt;/span&gt;\r\n                        &lt;/#if&gt;\r\n\r\n                    &lt;/div&gt;\r\n                &lt;/#if&gt;\r\n\r\n                &lt;div class=&quot;${properties.kcFormGroupClass!}&quot;&gt;\r\n                    &lt;label for=&quot;password&quot; class=&quot;${properties.kcLabelClass!}&quot;&gt;${msg(&quot;password&quot;)}&lt;/label&gt;\r\n\r\n                    &lt;input tabindex=&quot;2&quot; id=&quot;password&quot; class=&quot;${properties.kcInputClass!}&quot; name=&quot;password&quot; type=&quot;password&quot; autocomplete=&quot;off&quot;\r\n                           aria-invalid=&quot;&lt;#if messagesPerField.existsError(&#39;username&#39;,&#39;password&#39;)&gt;true&lt;/#if&gt;&quot;\r\n                    /&gt;\r\n\r\n                    &lt;#if usernameHidden?? &amp;&amp; messagesPerField.existsError(&#39;username&#39;,&#39;password&#39;)&gt;\r\n                        &lt;span id=&quot;input-error&quot; class=&quot;${properties.kcInputErrorMessageClass!}&quot; aria-live=&quot;polite&quot;&gt;\r\n                                ${kcSanitize(messagesPerField.getFirstError(&#39;username&#39;,&#39;password&#39;))?no_esc}\r\n                        &lt;/span&gt;\r\n                    &lt;/#if&gt;\r\n\r\n                &lt;/div&gt;\r\n\r\n                &lt;div class=&quot;${properties.kcFormGroupClass!} ${properties.kcFormSettingClass!}&quot;&gt;\r\n                    &lt;div id=&quot;kc-form-options&quot;&gt;\r\n                        &lt;#if realm.rememberMe &amp;&amp; !usernameHidden??&gt;\r\n                            &lt;div class=&quot;checkbox&quot;&gt;\r\n                                &lt;label&gt;\r\n                                    &lt;#if login.rememberMe??&gt;\r\n                                        &lt;input tabindex=&quot;3&quot; id=&quot;rememberMe&quot; name=&quot;rememberMe&quot; type=&quot;checkbox&quot; checked&gt; ${msg(&quot;rememberMe&quot;)}\r\n                                    &lt;#else&gt;\r\n                                        &lt;input tabindex=&quot;3&quot; id=&quot;rememberMe&quot; name=&quot;rememberMe&quot; type=&quot;checkbox&quot;&gt; ${msg(&quot;rememberMe&quot;)}\r\n                                    &lt;/#if&gt;\r\n                                &lt;/label&gt;\r\n                            &lt;/div&gt;\r\n                        &lt;/#if&gt;\r\n                        &lt;/div&gt;\r\n                        &lt;div class=&quot;${properties.kcFormOptionsWrapperClass!}&quot;&gt;\r\n                            &lt;#if realm.resetPasswordAllowed&gt;\r\n                                &lt;span&gt;&lt;a tabindex=&quot;5&quot; href=&quot;${url.loginResetCredentialsUrl}&quot;&gt;${msg(&quot;doForgotPassword&quot;)}&lt;/a&gt;&lt;/span&gt;\r\n                            &lt;/#if&gt;\r\n                        &lt;/div&gt;\r\n\r\n                  &lt;/div&gt;\r\n\r\n                  &lt;div id=&quot;kc-form-buttons&quot; class=&quot;${properties.kcFormGroupClass!}&quot;&gt;\r\n                      &lt;input type=&quot;hidden&quot; id=&quot;id-hidden-input&quot; name=&quot;credentialId&quot; &lt;#if auth.selectedCredential?has_content&gt;value=&quot;${auth.selectedCredential}&quot;&lt;/#if&gt;/&gt;\r\n                      &lt;input tabindex=&quot;4&quot; class=&quot;${properties.kcButtonClass!} ${properties.kcButtonPrimaryClass!} ${properties.kcButtonBlockClass!} ${properties.kcButtonLargeClass!}&quot; name=&quot;login&quot; id=&quot;kc-login&quot; type=&quot;submit&quot; value=&quot;${msg(&quot;doLogIn&quot;)}&quot;/&gt;\r\n                  &lt;/div&gt;\r\n            &lt;/form&gt;\r\n        &lt;/#if&gt;\r\n        &lt;/div&gt;\r\n\r\n    &lt;/div&gt;\r\n    &lt;#elseif section = &quot;info&quot; &gt;\r\n        &lt;#if realm.password &amp;&amp; realm.registrationAllowed &amp;&amp; !registrationDisabled??&gt;\r\n            &lt;div id=&quot;kc-registration-container&quot;&gt;\r\n                &lt;div id=&quot;kc-registration&quot;&gt;\r\n                    &lt;span&gt;${msg(&quot;noAccount&quot;)} &lt;a tabindex=&quot;6&quot;\r\n                                                 href=&quot;${url.registrationUrl}&quot;&gt;${msg(&quot;doRegister&quot;)}&lt;/a&gt;&lt;/span&gt;\r\n                &lt;/div&gt;\r\n            &lt;/div&gt;\r\n        &lt;/#if&gt;\r\n    &lt;#elseif section = &quot;socialProviders&quot; &gt;\r\n        &lt;#if realm.password &amp;&amp; social.providers??&gt;\r\n            &lt;div id=&quot;kc-social-providers&quot; class=&quot;${properties.kcFormSocialAccountSectionClass!}&quot;&gt;\r\n                &lt;hr/&gt;\r\n                &lt;h4&gt;${msg(&quot;identity-provider-login-label&quot;)}&lt;/h4&gt;\r\n\r\n                &lt;ul class=&quot;${properties.kcFormSocialAccountListClass!} &lt;#if social.providers?size gt 3&gt;${properties.kcFormSocialAccountListGridClass!}&lt;/#if&gt;&quot;&gt;\r\n                    &lt;#list social.providers as p&gt;\r\n                        &lt;li&gt;\r\n                            &lt;a id=&quot;social-${p.alias}&quot; class=&quot;${properties.kcFormSocialAccountListButtonClass!} &lt;#if social.providers?size gt 3&gt;${properties.kcFormSocialAccountGridItem!}&lt;/#if&gt;&quot;\r\n                                    type=&quot;button&quot; href=&quot;${p.loginUrl}&quot;&gt;\r\n                                &lt;#if p.iconClasses?has_content&gt;\r\n                                    &lt;i class=&quot;${properties.kcCommonLogoIdP!} ${p.iconClasses!}&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;\r\n                                    &lt;span class=&quot;${properties.kcFormSocialAccountNameClass!} kc-social-icon-text&quot;&gt;${p.displayName!}&lt;/span&gt;\r\n                                &lt;#else&gt;\r\n                                    &lt;span class=&quot;${properties.kcFormSocialAccountNameClass!}&quot;&gt;${p.displayName!}&lt;/span&gt;\r\n                                &lt;/#if&gt;\r\n                            &lt;/a&gt;\r\n                        &lt;/li&gt;\r\n                    &lt;/#list&gt;\r\n                &lt;/ul&gt;\r\n            &lt;/div&gt;\r\n        &lt;/#if&gt;\r\n    &lt;/#if&gt;\r\n\r\n&lt;/@layout.registrationLayout&gt;\r\n\r\n\r\nand this is my config class \r\n\r\n@Configuration\r\n@EnableWebSecurity\r\npublic class KeycloakSecurity extends KeycloakWebSecurityConfigurerAdapter {\r\n\r\n    @Bean\r\n    @Override\r\n    protected SessionAuthenticationStrategy sessionAuthenticationStrategy() {\r\n        return new RegisterSessionAuthenticationStrategy(\r\n                new SessionRegistryImpl());\r\n    }\r\n\r\n    @Override\r\n    protected void configure(HttpSecurity http) throws Exception {\r\n        super.configure(http);\r\n        http.authorizeRequests()\r\n                .antMatchers(&quot;/dashboard&quot;).hasAnyRole(&quot;Employee&quot;, &quot;Manager&quot;)\r\n                .antMatchers(&quot;/logout&quot;).permitAll()\r\n                .anyRequest().permitAll()\r\n                .and()\r\n                .formLogin()\r\n                .successHandler(successHandler()) // Set custom success handler\r\n                .and()\r\n                .csrf().disable();\r\n    }\r\n\r\n    @Autowired\r\n    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\r\n        KeycloakAuthenticationProvider keycloakAuthenticationProvider = keycloakAuthenticationProvider();\r\n        keycloakAuthenticationProvider.setGrantedAuthoritiesMapper(new SimpleAuthorityMapper());\r\n        auth.authenticationProvider(keycloakAuthenticationProvider);\r\n    }\r\n    @Bean\r\n    public AuthenticationSuccessHandler successHandler1() {\r\n        return new SimpleUrlAuthenticationSuccessHandler() {\r\n            @Override\r\n            protected String determineTargetUrl(HttpServletRequest request, HttpServletResponse response) {\r\n                Collection&lt;? extends GrantedAuthority&gt; authorities = SecurityContextHolder.getContext().getAuthentication().getAuthorities();\r\n                List&lt;String&gt; roles = authorities.stream()\r\n                        .map(GrantedAuthority::getAuthority)\r\n                        .collect(Collectors.toList());\r\n\r\n                System.out.println(&quot;User successfully authenticated. Roles: &quot; + roles);\r\n\r\n                // You can add logic to check for roles here\r\n                // For simplicity, assume no roles for now\r\n                return request.getContextPath() + &quot;/noRoles&quot;;\r\n            }\r\n        };\r\n    }\r\n}\r\n\r\n```\r\n\r\n\r\nif i change anyting in this i am getting internal server error in keycloak \r\n\r\n\r\nI tried in this way \r\n\r\n&lt;#if !authentication?.account?.roles?has_content&gt;\r\n            &lt;div class=&quot;alert alert-danger&quot; role=&quot;alert&quot;&gt;\r\n                You don&#39;t have any roles. Please contact the administrator for assistance.\r\n            &lt;/div&gt;\r\n        &lt;/#if&gt;\r\nbut I am getting this error\r\n        \r\n        \r\n       Failed to load resource: the server responded with a status of 404 (Not Found)\r\nauth:1 Refused to execute script from &#39;http://localhost:8080/resources/1gs7r/login/keycloak%20-%20Copy/js/script.js&#39; because its MIME type (&#39;&#39;) is not executable, and strict MIME type checking is enabled.","title":"How to display a custom message in keycloak login page if no roles assigned user tries to login","body":"<p>I have a spring boot application implemented with keycloak security\nso i want to display a error message when a user having no roles  tries to login<br />\nI have this login.ftl page</p>\n<pre><code>&lt;#import &quot;template.ftl&quot; as layout&gt;\n&lt;@layout.registrationLayout displayMessage=!messagesPerField.existsError('username','password') displayInfo=realm.password &amp;&amp; realm.registrationAllowed &amp;&amp; !registrationDisabled??; section&gt;\n    &lt;#if section = &quot;header&quot;&gt;\n        ${msg(&quot;loginAccountTitle&quot;)}\n    &lt;#elseif section = &quot;form&quot;&gt;\n    &lt;div id=&quot;kc-form&quot;&gt;\n      &lt;div id=&quot;kc-form-wrapper&quot;&gt;\n      &lt;marquee behavior=&quot;scroll&quot; direction=&quot;left&quot; scrollamount=&quot;5&quot;&gt;\n    This is a scrolling text using the marquee tag.\n&lt;/marquee&gt;\n        &lt;#if realm.password&gt;\n            &lt;form id=&quot;kc-form-login&quot; onsubmit=&quot;login.disabled = true; return true;&quot; action=&quot;${url.loginAction}&quot; method=&quot;post&quot;&gt;\n                &lt;#if !usernameHidden??&gt;\n                    &lt;div class=&quot;${properties.kcFormGroupClass!}&quot;&gt;\n                        &lt;label for=&quot;username&quot; class=&quot;${properties.kcLabelClass!}&quot;&gt;&lt;#if !realm.loginWithEmailAllowed&gt;${msg(&quot;username&quot;)}&lt;#elseif !realm.registrationEmailAsUsername&gt;${msg(&quot;usernameOrEmail&quot;)}&lt;#else&gt;${msg(&quot;email&quot;)}&lt;/#if&gt;&lt;/label&gt;\n\n                        &lt;input tabindex=&quot;1&quot; id=&quot;username&quot; class=&quot;${properties.kcInputClass!}&quot; name=&quot;username&quot; value=&quot;${(login.username!'')}&quot;  type=&quot;text&quot; autofocus autocomplete=&quot;off&quot;\n                               aria-invalid=&quot;&lt;#if messagesPerField.existsError('username','password')&gt;true&lt;/#if&gt;&quot;\n                        /&gt;\n\n                        &lt;#if messagesPerField.existsError('username','password')&gt;\n                            &lt;span id=&quot;input-error&quot; class=&quot;${properties.kcInputErrorMessageClass!}&quot; aria-live=&quot;polite&quot;&gt;\n                                    ${kcSanitize(messagesPerField.getFirstError('username','password'))?no_esc}\n                            &lt;/span&gt;\n                        &lt;/#if&gt;\n\n                    &lt;/div&gt;\n                &lt;/#if&gt;\n\n                &lt;div class=&quot;${properties.kcFormGroupClass!}&quot;&gt;\n                    &lt;label for=&quot;password&quot; class=&quot;${properties.kcLabelClass!}&quot;&gt;${msg(&quot;password&quot;)}&lt;/label&gt;\n\n                    &lt;input tabindex=&quot;2&quot; id=&quot;password&quot; class=&quot;${properties.kcInputClass!}&quot; name=&quot;password&quot; type=&quot;password&quot; autocomplete=&quot;off&quot;\n                           aria-invalid=&quot;&lt;#if messagesPerField.existsError('username','password')&gt;true&lt;/#if&gt;&quot;\n                    /&gt;\n\n                    &lt;#if usernameHidden?? &amp;&amp; messagesPerField.existsError('username','password')&gt;\n                        &lt;span id=&quot;input-error&quot; class=&quot;${properties.kcInputErrorMessageClass!}&quot; aria-live=&quot;polite&quot;&gt;\n                                ${kcSanitize(messagesPerField.getFirstError('username','password'))?no_esc}\n                        &lt;/span&gt;\n                    &lt;/#if&gt;\n\n                &lt;/div&gt;\n\n                &lt;div class=&quot;${properties.kcFormGroupClass!} ${properties.kcFormSettingClass!}&quot;&gt;\n                    &lt;div id=&quot;kc-form-options&quot;&gt;\n                        &lt;#if realm.rememberMe &amp;&amp; !usernameHidden??&gt;\n                            &lt;div class=&quot;checkbox&quot;&gt;\n                                &lt;label&gt;\n                                    &lt;#if login.rememberMe??&gt;\n                                        &lt;input tabindex=&quot;3&quot; id=&quot;rememberMe&quot; name=&quot;rememberMe&quot; type=&quot;checkbox&quot; checked&gt; ${msg(&quot;rememberMe&quot;)}\n                                    &lt;#else&gt;\n                                        &lt;input tabindex=&quot;3&quot; id=&quot;rememberMe&quot; name=&quot;rememberMe&quot; type=&quot;checkbox&quot;&gt; ${msg(&quot;rememberMe&quot;)}\n                                    &lt;/#if&gt;\n                                &lt;/label&gt;\n                            &lt;/div&gt;\n                        &lt;/#if&gt;\n                        &lt;/div&gt;\n                        &lt;div class=&quot;${properties.kcFormOptionsWrapperClass!}&quot;&gt;\n                            &lt;#if realm.resetPasswordAllowed&gt;\n                                &lt;span&gt;&lt;a tabindex=&quot;5&quot; href=&quot;${url.loginResetCredentialsUrl}&quot;&gt;${msg(&quot;doForgotPassword&quot;)}&lt;/a&gt;&lt;/span&gt;\n                            &lt;/#if&gt;\n                        &lt;/div&gt;\n\n                  &lt;/div&gt;\n\n                  &lt;div id=&quot;kc-form-buttons&quot; class=&quot;${properties.kcFormGroupClass!}&quot;&gt;\n                      &lt;input type=&quot;hidden&quot; id=&quot;id-hidden-input&quot; name=&quot;credentialId&quot; &lt;#if auth.selectedCredential?has_content&gt;value=&quot;${auth.selectedCredential}&quot;&lt;/#if&gt;/&gt;\n                      &lt;input tabindex=&quot;4&quot; class=&quot;${properties.kcButtonClass!} ${properties.kcButtonPrimaryClass!} ${properties.kcButtonBlockClass!} ${properties.kcButtonLargeClass!}&quot; name=&quot;login&quot; id=&quot;kc-login&quot; type=&quot;submit&quot; value=&quot;${msg(&quot;doLogIn&quot;)}&quot;/&gt;\n                  &lt;/div&gt;\n            &lt;/form&gt;\n        &lt;/#if&gt;\n        &lt;/div&gt;\n\n    &lt;/div&gt;\n    &lt;#elseif section = &quot;info&quot; &gt;\n        &lt;#if realm.password &amp;&amp; realm.registrationAllowed &amp;&amp; !registrationDisabled??&gt;\n            &lt;div id=&quot;kc-registration-container&quot;&gt;\n                &lt;div id=&quot;kc-registration&quot;&gt;\n                    &lt;span&gt;${msg(&quot;noAccount&quot;)} &lt;a tabindex=&quot;6&quot;\n                                                 href=&quot;${url.registrationUrl}&quot;&gt;${msg(&quot;doRegister&quot;)}&lt;/a&gt;&lt;/span&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/#if&gt;\n    &lt;#elseif section = &quot;socialProviders&quot; &gt;\n        &lt;#if realm.password &amp;&amp; social.providers??&gt;\n            &lt;div id=&quot;kc-social-providers&quot; class=&quot;${properties.kcFormSocialAccountSectionClass!}&quot;&gt;\n                &lt;hr/&gt;\n                &lt;h4&gt;${msg(&quot;identity-provider-login-label&quot;)}&lt;/h4&gt;\n\n                &lt;ul class=&quot;${properties.kcFormSocialAccountListClass!} &lt;#if social.providers?size gt 3&gt;${properties.kcFormSocialAccountListGridClass!}&lt;/#if&gt;&quot;&gt;\n                    &lt;#list social.providers as p&gt;\n                        &lt;li&gt;\n                            &lt;a id=&quot;social-${p.alias}&quot; class=&quot;${properties.kcFormSocialAccountListButtonClass!} &lt;#if social.providers?size gt 3&gt;${properties.kcFormSocialAccountGridItem!}&lt;/#if&gt;&quot;\n                                    type=&quot;button&quot; href=&quot;${p.loginUrl}&quot;&gt;\n                                &lt;#if p.iconClasses?has_content&gt;\n                                    &lt;i class=&quot;${properties.kcCommonLogoIdP!} ${p.iconClasses!}&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;\n                                    &lt;span class=&quot;${properties.kcFormSocialAccountNameClass!} kc-social-icon-text&quot;&gt;${p.displayName!}&lt;/span&gt;\n                                &lt;#else&gt;\n                                    &lt;span class=&quot;${properties.kcFormSocialAccountNameClass!}&quot;&gt;${p.displayName!}&lt;/span&gt;\n                                &lt;/#if&gt;\n                            &lt;/a&gt;\n                        &lt;/li&gt;\n                    &lt;/#list&gt;\n                &lt;/ul&gt;\n            &lt;/div&gt;\n        &lt;/#if&gt;\n    &lt;/#if&gt;\n\n&lt;/@layout.registrationLayout&gt;\n\n\nand this is my config class \n\n@Configuration\n@EnableWebSecurity\npublic class KeycloakSecurity extends KeycloakWebSecurityConfigurerAdapter {\n\n    @Bean\n    @Override\n    protected SessionAuthenticationStrategy sessionAuthenticationStrategy() {\n        return new RegisterSessionAuthenticationStrategy(\n                new SessionRegistryImpl());\n    }\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        super.configure(http);\n        http.authorizeRequests()\n                .antMatchers(&quot;/dashboard&quot;).hasAnyRole(&quot;Employee&quot;, &quot;Manager&quot;)\n                .antMatchers(&quot;/logout&quot;).permitAll()\n                .anyRequest().permitAll()\n                .and()\n                .formLogin()\n                .successHandler(successHandler()) // Set custom success handler\n                .and()\n                .csrf().disable();\n    }\n\n    @Autowired\n    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n        KeycloakAuthenticationProvider keycloakAuthenticationProvider = keycloakAuthenticationProvider();\n        keycloakAuthenticationProvider.setGrantedAuthoritiesMapper(new SimpleAuthorityMapper());\n        auth.authenticationProvider(keycloakAuthenticationProvider);\n    }\n    @Bean\n    public AuthenticationSuccessHandler successHandler1() {\n        return new SimpleUrlAuthenticationSuccessHandler() {\n            @Override\n            protected String determineTargetUrl(HttpServletRequest request, HttpServletResponse response) {\n                Collection&lt;? extends GrantedAuthority&gt; authorities = SecurityContextHolder.getContext().getAuthentication().getAuthorities();\n                List&lt;String&gt; roles = authorities.stream()\n                        .map(GrantedAuthority::getAuthority)\n                        .collect(Collectors.toList());\n\n                System.out.println(&quot;User successfully authenticated. Roles: &quot; + roles);\n\n                // You can add logic to check for roles here\n                // For simplicity, assume no roles for now\n                return request.getContextPath() + &quot;/noRoles&quot;;\n            }\n        };\n    }\n}\n\n</code></pre>\n<p>if i change anyting in this i am getting internal server error in keycloak</p>\n<p>I tried in this way</p>\n<p>&lt;#if !authentication?.account?.roles?has_content&gt;\n\nYou don't have any roles. Please contact the administrator for assistance.\n\n&lt;/#if&gt;\nbut I am getting this error</p>\n<pre><code>   Failed to load resource: the server responded with a status of 404 (Not Found)\n</code></pre>\n<p>auth:1 Refused to execute script from 'http://localhost:8080/resources/1gs7r/login/keycloak%20-%20Copy/js/script.js' because its MIME type ('') is not executable, and strict MIME type checking is enabled.</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1699991153,"post_id":77481074,"comment_id":136599376,"body_markdown":"`they always get saved in the app and I want to see them in the Gallery` Two misconceptions. An app cannot save files in itself. Only to storage locations of the device. Further you cannot store in the gallery as an alp can store only files in the storage of the device. Once the files land in the device storage they can be scanned by the media store. Gallery apps request the media store to give a list of pictures.","body":"<code>they always get saved in the app and I want to see them in the Gallery</code> Two misconceptions. An app cannot save files in itself. Only to storage locations of the device. Further you cannot store in the gallery as an alp can store only files in the storage of the device. Once the files land in the device storage they can be scanned by the media store. Gallery apps request the media store to give a list of pictures."},{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":1,"creation_date":1699991264,"post_id":77481074,"comment_id":136599394,"body_markdown":"getExternalFilesDir() is private storage of your app. It will not be scanned.","body":"getExternalFilesDir() is private storage of your app. It will not be scanned."}],"answers":[{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1700046438,"post_id":77485683,"comment_id":136605973,"body_markdown":"As it’s currently written, your answer is unclear. Please [edit] to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"As it’s currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/77485683/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."},{"owner":{"account_id":29900604,"reputation":1,"user_id":22914446,"display_name":"Huraweurg"},"score":0,"creation_date":1700053915,"post_id":77485683,"comment_id":136607280,"body_markdown":"I have two more Questions. First one is how I can change how big the picture is in the files its only 1 byte and i think thats why I cant open it. Secondly this gets marked Toast.makeText(getContext(), &quot;No apps found to open downloaded file&quot;, Toast.LENGTH_SHORT).show(); and i dont know how to fix it.","body":"I have two more Questions. First one is how I can change how big the picture is in the files its only 1 byte and i think thats why I cant open it. Secondly this gets marked Toast.makeText(getContext(), &quot;No apps found to open downloaded file&quot;, Toast.LENGTH_SHORT).show(); and i dont know how to fix it."},{"owner":{"account_id":21625375,"reputation":1,"user_id":15949785,"display_name":"Roshan Jha"},"score":0,"creation_date":1700116689,"post_id":77485683,"comment_id":136615677,"body_markdown":"@Huraweurg Make sure to convert your imageCapture into bytes before donwloading the file. Kindly send me your logcat details so that I can help you to resolve that error?","body":"@Huraweurg Make sure to convert your imageCapture into bytes before donwloading the file. Kindly send me your logcat details so that I can help you to resolve that error?"},{"owner":{"account_id":29900604,"reputation":1,"user_id":22914446,"display_name":"Huraweurg"},"score":0,"creation_date":1700214409,"post_id":77485683,"comment_id":136629374,"body_markdown":"I solved the problem thanks for your help","body":"I solved the problem thanks for your help"}],"tags":[],"owner":{"account_id":21625375,"reputation":1,"user_id":15949785,"display_name":"Roshan Jha"},"comment_count":4,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700046430,"creation_date":1700030205,"answer_id":77485683,"question_id":77481074,"body_markdown":"You can use this code to save an image into your Downloads/AppName folder:   \r\n\r\n       try {\r\n            File root = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS + &quot;/AppName&quot;);\r\n            File dir = new File(root.getAbsolutePath() + File.separator);\r\n            if (!dir.exists()){\r\n                dir.mkdir();\r\n            }\r\n\r\n            //Create file..\r\n            File file = new File(root.getAbsolutePath() + File.separator + &quot;fileName&quot; + System.currentTimeMillis() + &quot;.jpeg&quot;);\r\n            file.createNewFile();\r\n\r\n            FileOutputStream out = new FileOutputStream(file);\r\n            out.write(bytes);\r\n            out.close();\r\n\r\n            Toast.makeText(requireContext(), &quot;File Downloaded...&quot;, Toast.LENGTH_SHORT).show();\r\n\r\n            // OPENING FOLDER LOCATION\r\n\r\n            // getting download/appName folder permission\r\n\r\n            if (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.Q) {\r\n                String path = Environment.getExternalStorageDirectory() + &quot;/Download/AppName&quot;;\r\n                File folder = new File(path);\r\n                String startDir = &quot;&quot;, secondDir, finalDirPath;\r\n\r\n                if (folder.exists()) {\r\n                    startDir = &quot;Download%2FAppName&quot;;\r\n                }\r\n\r\n                StorageManager sm = (StorageManager) requireContext().getSystemService(Context.STORAGE_SERVICE);\r\n\r\n                Intent intent = sm.getPrimaryStorageVolume().createOpenDocumentTreeIntent();\r\n\r\n                Uri uri = intent.getParcelableExtra(&quot;android.provider.extra.INITIAL_URI&quot;);\r\n\r\n                String scheme = uri.toString();\r\n\r\n                scheme = scheme.replace(&quot;/root/&quot;, &quot;/document/&quot;);\r\n\r\n                finalDirPath = scheme + &quot;%3A&quot; + startDir;\r\n\r\n                uri = Uri.parse(finalDirPath);\r\n\r\n                intent.putExtra(&quot;android.provider.extra.INITIAL_URI&quot;, uri);\r\n\r\n                startActivity(intent);\r\n\r\n            }else{\r\n                Uri data = FileProvider.getUriForFile(requireContext(),\r\n                        requireContext().getPackageName() + &quot;.provider&quot;,\r\n                        file);\r\n\r\n                Intent intent = new Intent(Intent.ACTION_VIEW);\r\n                intent.setDataAndType(data, &quot;application/jpeg&quot;);\r\n\r\n                startActivity(intent);\r\n            }\r\n\r\n        } catch (Exception e) {\r\n            Toast.makeText(getContext(), &quot;No apps found to open downloaded file&quot;, Toast.LENGTH_SHORT).show();\r\n            Log.d(&quot;error&quot;, &quot;downloadPdf: error&quot; + e.getMessage());\r\n            e.printStackTrace();\r\n        }\r\n","title":"How can I save the picture in the gallery","body":"<p>You can use this code to save an image into your Downloads/AppName folder:</p>\n<pre><code>   try {\n        File root = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS + &quot;/AppName&quot;);\n        File dir = new File(root.getAbsolutePath() + File.separator);\n        if (!dir.exists()){\n            dir.mkdir();\n        }\n\n        //Create file..\n        File file = new File(root.getAbsolutePath() + File.separator + &quot;fileName&quot; + System.currentTimeMillis() + &quot;.jpeg&quot;);\n        file.createNewFile();\n\n        FileOutputStream out = new FileOutputStream(file);\n        out.write(bytes);\n        out.close();\n\n        Toast.makeText(requireContext(), &quot;File Downloaded...&quot;, Toast.LENGTH_SHORT).show();\n\n        // OPENING FOLDER LOCATION\n\n        // getting download/appName folder permission\n\n        if (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.Q) {\n            String path = Environment.getExternalStorageDirectory() + &quot;/Download/AppName&quot;;\n            File folder = new File(path);\n            String startDir = &quot;&quot;, secondDir, finalDirPath;\n\n            if (folder.exists()) {\n                startDir = &quot;Download%2FAppName&quot;;\n            }\n\n            StorageManager sm = (StorageManager) requireContext().getSystemService(Context.STORAGE_SERVICE);\n\n            Intent intent = sm.getPrimaryStorageVolume().createOpenDocumentTreeIntent();\n\n            Uri uri = intent.getParcelableExtra(&quot;android.provider.extra.INITIAL_URI&quot;);\n\n            String scheme = uri.toString();\n\n            scheme = scheme.replace(&quot;/root/&quot;, &quot;/document/&quot;);\n\n            finalDirPath = scheme + &quot;%3A&quot; + startDir;\n\n            uri = Uri.parse(finalDirPath);\n\n            intent.putExtra(&quot;android.provider.extra.INITIAL_URI&quot;, uri);\n\n            startActivity(intent);\n\n        }else{\n            Uri data = FileProvider.getUriForFile(requireContext(),\n                    requireContext().getPackageName() + &quot;.provider&quot;,\n                    file);\n\n            Intent intent = new Intent(Intent.ACTION_VIEW);\n            intent.setDataAndType(data, &quot;application/jpeg&quot;);\n\n            startActivity(intent);\n        }\n\n    } catch (Exception e) {\n        Toast.makeText(getContext(), &quot;No apps found to open downloaded file&quot;, Toast.LENGTH_SHORT).show();\n        Log.d(&quot;error&quot;, &quot;downloadPdf: error&quot; + e.getMessage());\n        e.printStackTrace();\n    }\n</code></pre>\n"}],"owner":{"account_id":29900604,"reputation":1,"user_id":22914446,"display_name":"Huraweurg"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":87,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1700052789,"creation_date":1699969383,"question_id":77481074,"body_markdown":"My camera app makes photos but they always get saved in the app and I want to see them in the Gallery, but I want to stay with ImageCapture. I use Android 14.\r\n```java\r\npublic void takePicture(ImageCapture imageCapture) {\r\n    File file = new File(getExternalFilesDir(Environment.DIRECTORY_DCIM) + &quot;/&quot; + System.currentTimeMillis() + &quot;.jpg&quot;);\r\n    ImageCapture.OutputFileOptions outputFileOptions = new ImageCapture.OutputFileOptions.Builder(file).build();\r\n    imageCapture.takePicture(outputFileOptions, Executors.newSingleThreadExecutor(), new ImageCapture.OnImageSavedCallback() {\r\n\r\n            @Override\r\n            public void onImageSaved(ImageCapture.OutputFileResults outputFileResults) {\r\n                runOnUiThread(new Runnable() {\r\n                    @Override\r\n                    public void run() {\r\n                        Toast.makeText(MainActivity.this, &quot;Image saved at: &quot; + file.getPath(), Toast.LENGTH_SHORT).show();\r\n                    }\r\n                });\r\n                startCamera(cameraFacing);\r\n            }\r\n    \r\n            @Override\r\n            public void onError(ImageCaptureException exception) {\r\n                runOnUiThread(new Runnable() {\r\n                    @Override\r\n                    public void run() {\r\n                        Toast.makeText(MainActivity.this, &quot;Failed to save: &quot; + exception.getMessage(), Toast.LENGTH_SHORT).show();\r\n                    }\r\n                });\r\n                startCamera(cameraFacing);\r\n            }\r\n    \r\n        });\r\n```","title":"How can I save the picture in the gallery","body":"<p>My camera app makes photos but they always get saved in the app and I want to see them in the Gallery, but I want to stay with ImageCapture. I use Android 14.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public void takePicture(ImageCapture imageCapture) {\n    File file = new File(getExternalFilesDir(Environment.DIRECTORY_DCIM) + &quot;/&quot; + System.currentTimeMillis() + &quot;.jpg&quot;);\n    ImageCapture.OutputFileOptions outputFileOptions = new ImageCapture.OutputFileOptions.Builder(file).build();\n    imageCapture.takePicture(outputFileOptions, Executors.newSingleThreadExecutor(), new ImageCapture.OnImageSavedCallback() {\n\n            @Override\n            public void onImageSaved(ImageCapture.OutputFileResults outputFileResults) {\n                runOnUiThread(new Runnable() {\n                    @Override\n                    public void run() {\n                        Toast.makeText(MainActivity.this, &quot;Image saved at: &quot; + file.getPath(), Toast.LENGTH_SHORT).show();\n                    }\n                });\n                startCamera(cameraFacing);\n            }\n    \n            @Override\n            public void onError(ImageCaptureException exception) {\n                runOnUiThread(new Runnable() {\n                    @Override\n                    public void run() {\n                        Toast.makeText(MainActivity.this, &quot;Failed to save: &quot; + exception.getMessage(), Toast.LENGTH_SHORT).show();\n                    }\n                });\n                startCamera(cameraFacing);\n            }\n    \n        });\n</code></pre>\n"},{"tags":["java","java.util.scanner","bufferedreader","fileinputstream"],"comments":[{"owner":{"account_id":318670,"reputation":15681,"user_id":636009,"display_name":"David Conrad"},"score":1,"creation_date":1700022834,"post_id":77485125,"comment_id":136602874,"body_markdown":"Do you understand that BufferedReader&#39;s readLine() method returns null to indicate end of file?","body":"Do you understand that BufferedReader&#39;s readLine() method returns null to indicate end of file?"},{"owner":{"account_id":2485939,"reputation":19426,"user_id":2164365,"accept_rate":40,"display_name":"Abra"},"score":0,"creation_date":1700023673,"post_id":77485125,"comment_id":136602928,"body_markdown":"You wrote (in your question): _Here are ... screenshots of the data file_ Pardon me but I cannot find those screenshots. If the file is a text file, then post (at least part of) its contents as text and **not** as an [image](https://meta.stackoverflow.com/questions/285551/why-should-i-not-upload-images-of-code-data-errors).","body":"You wrote (in your question): <i>Here are ... screenshots of the data file</i> Pardon me but I cannot find those screenshots. If the file is a text file, then post (at least part of) its contents as text and <b>not</b> as an <a href=\"https://meta.stackoverflow.com/questions/285551/why-should-i-not-upload-images-of-code-data-errors\">image</a>."},{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1700024164,"post_id":77485125,"comment_id":136602965,"body_markdown":"It’s not impossible for `line` to be null in this code. You have to use it inside the loop, not afterwards.","body":"It’s not impossible for <code>line</code> to be null in this code. You have to use it inside the loop, not afterwards."},{"owner":{"account_id":18256279,"reputation":659,"user_id":13290159,"display_name":"0x150"},"score":0,"creation_date":1700029981,"post_id":77485125,"comment_id":136603470,"body_markdown":"There&#39;s obviously other code that is missing from this example. Please post the full code snippet, including your usage of `String.split` (it&#39;s missing here, and that function is the issue)","body":"There&#39;s obviously other code that is missing from this example. Please post the full code snippet, including your usage of <code>String.split</code> (it&#39;s missing here, and that function is the issue)"},{"owner":{"account_id":6017640,"reputation":8919,"user_id":4725875,"display_name":"DevilsHnd - 退した"},"score":1,"creation_date":1700037141,"post_id":77485125,"comment_id":136604391,"body_markdown":"The true story...there is nothing wrong with the code you have **shown**. All you need to do now is post the code that **is** giving the problem.","body":"The true story...there is nothing wrong with the code you have <b>shown</b>. All you need to do now is post the code that <b>is</b> giving the problem."},{"owner":{"account_id":29905463,"reputation":1,"user_id":22918091,"display_name":"zqy"},"score":0,"creation_date":1700050790,"post_id":77485125,"comment_id":136606732,"body_markdown":"Guys, thank you so much! I finally found that there was nothing wrong with my codes and the problem derives from the .data file that my friend gave me...  somewhere of the file had a wrong format(for our project) and everything got stuck there when debugging the codes.... Thank you all for your help!","body":"Guys, thank you so much! I finally found that there was nothing wrong with my codes and the problem derives from the .data file that my friend gave me...  somewhere of the file had a wrong format(for our project) and everything got stuck there when debugging the codes.... Thank you all for your help!"},{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1700054466,"post_id":77485125,"comment_id":136607394,"body_markdown":"That would not cause `line` to become null. You had a bug in your code.","body":"That would not cause <code>line</code> to become null. You had a bug in your code."}],"owner":{"account_id":29905463,"reputation":1,"user_id":22918091,"display_name":"zqy"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":52,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"closed_date":1700052793,"answer_count":0,"score":-2,"last_activity_date":1700052781,"creation_date":1700019677,"question_id":77485125,"body_markdown":"I want to load a .data file for my group project (Java), and previously I used java.io.BufferedReader to solve this problem. I encountered an error which says _&quot;Cannot invoke &quot;String.split(String)&quot; because the return value of &quot;java.io.BufferedReader.readLine()&quot; is null&quot;_.  My idea is to read every line of the .data file until it reached the end. Here are the related part of the codes and screenshots of the data file:\r\n\r\n```java\r\ntry (BufferedReader bufferedReader = new BufferedReader(new FileReader(path))) {\r\n    String line;\r\n    while ((line = bufferedReader.readLine()) != null) {\r\n        //the content\r\n    } \r\n}\r\n```\r\n\r\nI want to read every line of the .data file (all of them should be in the format of strings). None of the lines are empty, so it&#39;s impossible to have a null return value in theory.","title":"Failed to read lines from a .data file in my Java Project","body":"<p>I want to load a .data file for my group project (Java), and previously I used java.io.BufferedReader to solve this problem. I encountered an error which says <em>&quot;Cannot invoke &quot;String.split(String)&quot; because the return value of &quot;java.io.BufferedReader.readLine()&quot; is null&quot;</em>.  My idea is to read every line of the .data file until it reached the end. Here are the related part of the codes and screenshots of the data file:</p>\n<pre class=\"lang-java prettyprint-override\"><code>try (BufferedReader bufferedReader = new BufferedReader(new FileReader(path))) {\n    String line;\n    while ((line = bufferedReader.readLine()) != null) {\n        //the content\n    } \n}\n</code></pre>\n<p>I want to read every line of the .data file (all of them should be in the format of strings). None of the lines are empty, so it's impossible to have a null return value in theory.</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":401843,"reputation":89863,"user_id":768644,"display_name":"rzwitserloot"},"score":0,"creation_date":1700053791,"post_id":77487791,"comment_id":136607253,"body_markdown":"Rendering HTML is incredibly complicated: There are pretty much 2 major browser engines out there, period. Should it support all HTML? Should it support CSS? Javascript? Or just very very basic HTML?","body":"Rendering HTML is incredibly complicated: There are pretty much 2 major browser engines out there, period. Should it support all HTML? Should it support CSS? Javascript? Or just very very basic HTML?"},{"owner":{"account_id":29908939,"reputation":1,"user_id":22920855,"display_name":"郭乐源"},"score":0,"creation_date":1700106654,"post_id":77487791,"comment_id":136614909,"body_markdown":"Only simple html is included, and the rich text generated by the front end is a piece of html that exists in the database. Now I want to convert this to a formatted string on the back end in order to retain the format when exporting to Excel cells.","body":"Only simple html is included, and the rich text generated by the front end is a piece of html that exists in the database. Now I want to convert this to a formatted string on the back end in order to retain the format when exporting to Excel cells."}],"owner":{"account_id":29908939,"reputation":1,"user_id":22920855,"display_name":"郭乐源"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":42,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700052320,"creation_date":1700052017,"question_id":77487791,"body_markdown":"The SpringBoot framework is used. I now get a string with an html tag, such as `&quot;&lt;p&gt;Hello&lt;/p&gt;&lt;p&gt;Good afternoon&lt;/p&gt;&quot;`. I want to parse it into a formatted String on the back end and export it to an Excel spreadsheet to preserve the format. \r\n\r\nSuch as:\r\n\r\n    Hello\r\n    Good afternoon\r\n\r\nHow to solve it.\r\n\r\nI am now using EasyExcel export, but the premise is to have this String with format, how to solve","title":"How to convert Html to a formatted string","body":"<p>The SpringBoot framework is used. I now get a string with an html tag, such as <code>&quot;&lt;p&gt;Hello&lt;/p&gt;&lt;p&gt;Good afternoon&lt;/p&gt;&quot;</code>. I want to parse it into a formatted String on the back end and export it to an Excel spreadsheet to preserve the format.</p>\n<p>Such as:</p>\n<pre><code>Hello\nGood afternoon\n</code></pre>\n<p>How to solve it.</p>\n<p>I am now using EasyExcel export, but the premise is to have this String with format, how to solve</p>\n"},{"tags":["java","selenium-webdriver","azure-pipelines"],"comments":[{"owner":{"account_id":21897459,"reputation":971,"user_id":16183552,"display_name":"Ziyang Liu-MSFT"},"score":0,"creation_date":1700118519,"post_id":77487719,"comment_id":136615885,"body_markdown":"Whether you can run the test successfully on your local machine? If you can, try to set up a self-hosted agent on this local machine and use it to run the pipeline. Then check if it works.","body":"Whether you can run the test successfully on your local machine? If you can, try to set up a self-hosted agent on this local machine and use it to run the pipeline. Then check if it works."},{"owner":{"account_id":23881045,"reputation":87,"user_id":17881743,"display_name":"Techie_Taks"},"score":0,"creation_date":1700143481,"post_id":77487719,"comment_id":136620260,"body_markdown":"when I run the test suite directly from spring tool suite then also it executes but facing this issue while executing from azure-pipeline","body":"when I run the test suite directly from spring tool suite then also it executes but facing this issue while executing from azure-pipeline"},{"owner":{"account_id":21897459,"reputation":971,"user_id":16183552,"display_name":"Ziyang Liu-MSFT"},"score":0,"creation_date":1700553401,"post_id":77487719,"comment_id":136665608,"body_markdown":"When you run your test on the pipeline, it essentially calls some commands on the agent. This is the same as running the test directly through command on your local machine. The main difference is the running environment. In order to know whether this issue is related to your project itself or the environment, please use command directly on your local machine to run your test.  If the test can run successfully using commands locally, set up a self-hosted agent on this machine, run the same commands in the pipeline and use this self-hosted agent to run the pipeline.","body":"When you run your test on the pipeline, it essentially calls some commands on the agent. This is the same as running the test directly through command on your local machine. The main difference is the running environment. In order to know whether this issue is related to your project itself or the environment, please use command directly on your local machine to run your test.  If the test can run successfully using commands locally, set up a self-hosted agent on this machine, run the same commands in the pipeline and use this self-hosted agent to run the pipeline."}],"answers":[{"comments":[{"owner":{"account_id":23881045,"reputation":87,"user_id":17881743,"display_name":"Techie_Taks"},"score":0,"creation_date":1700051845,"post_id":77487757,"comment_id":136606887,"body_markdown":"due to policy, wasn&#39;t able to share complete url here but in the code I&#39;m passing fully qualified URL to driver","body":"due to policy, wasn&#39;t able to share complete url here but in the code I&#39;m passing fully qualified URL to driver"},{"owner":{"account_id":10299692,"reputation":5744,"user_id":7598774,"accept_rate":75,"display_name":"Shawn"},"score":0,"creation_date":1700051953,"post_id":77487757,"comment_id":136606904,"body_markdown":"Does the URL open successfully if you open it manually from a browser?","body":"Does the URL open successfully if you open it manually from a browser?"},{"owner":{"account_id":23881045,"reputation":87,"user_id":17881743,"display_name":"Techie_Taks"},"score":0,"creation_date":1700052049,"post_id":77487757,"comment_id":136606929,"body_markdown":"yes it opens. Also when I run the test suite directly from spring tool suite then also it executes but facing this issue while executing from azure-pipeline","body":"yes it opens. Also when I run the test suite directly from spring tool suite then also it executes but facing this issue while executing from azure-pipeline"},{"owner":{"account_id":23881045,"reputation":87,"user_id":17881743,"display_name":"Techie_Taks"},"score":0,"creation_date":1700152154,"post_id":77487757,"comment_id":136622143,"body_markdown":"Also in local browser able to access the URL properly but in azure-pipeline, I checked the error message screenshot and it is showing as &quot;can&#39;t reach this page&quot;","body":"Also in local browser able to access the URL properly but in azure-pipeline, I checked the error message screenshot and it is showing as &quot;can&#39;t reach this page&quot;"}],"tags":[],"owner":{"account_id":10299692,"reputation":5744,"user_id":7598774,"accept_rate":75,"display_name":"Shawn"},"comment_count":4,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700051769,"creation_date":1700051769,"answer_id":77487757,"question_id":77487719,"body_markdown":"My hunch is that the URL you have provided is not a fully qualified URL.\r\n\r\nExample:\r\n\r\nIncorrect:\r\n````\r\ndriver.get(&quot;www.google.com/&quot;);\r\n````\r\n\r\nCorrect:\r\n````\r\ndriver.get(&quot;https://www.google.com/&quot;);\r\n````","title":"org.openqa.selenium.WebDriverException: unknown error: net::ERR_NAME_NOT_RESOLVED","body":"<p>My hunch is that the URL you have provided is not a fully qualified URL.</p>\n<p>Example:</p>\n<p>Incorrect:</p>\n<pre><code>driver.get(&quot;www.google.com/&quot;);\n</code></pre>\n<p>Correct:</p>\n<pre><code>driver.get(&quot;https://www.google.com/&quot;);\n</code></pre>\n"}],"owner":{"account_id":23881045,"reputation":87,"user_id":17881743,"display_name":"Techie_Taks"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":89,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":1,"score":0,"last_activity_date":1700051769,"creation_date":1700051422,"question_id":77487719,"body_markdown":"I want to configure selenium test automation suite(selenium cucumber maven project) as pipeline and run it in Azure-Devops. While running the pipeline faced below error:\r\n````\r\nVerification of Weblogin_TC1(Login to Web Application)  Time elapsed: 42.601 sec  &lt;&lt;&lt; ERROR!\r\norg.openqa.selenium.WebDriverException: unknown error: net::ERR_NAME_NOT_RESOLVED\r\n````\r\n\r\nThis error is pointing to the below line of code:\r\n````\r\ndriver.get(&quot;app url&quot;);\r\n````\r\n\r\nPlease provide me the way to overcome this","title":"org.openqa.selenium.WebDriverException: unknown error: net::ERR_NAME_NOT_RESOLVED","body":"<p>I want to configure selenium test automation suite(selenium cucumber maven project) as pipeline and run it in Azure-Devops. While running the pipeline faced below error:</p>\n<pre><code>Verification of Weblogin_TC1(Login to Web Application)  Time elapsed: 42.601 sec  &lt;&lt;&lt; ERROR!\norg.openqa.selenium.WebDriverException: unknown error: net::ERR_NAME_NOT_RESOLVED\n</code></pre>\n<p>This error is pointing to the below line of code:</p>\n<pre><code>driver.get(&quot;app url&quot;);\n</code></pre>\n<p>Please provide me the way to overcome this</p>\n"},{"tags":["java","design-patterns","strategy-pattern","command-pattern"],"comments":[{"owner":{"account_id":8834,"reputation":297144,"user_id":16076,"display_name":"Mitch Wheat"},"score":0,"creation_date":1296272219,"post_id":4834979,"comment_id":5366311,"body_markdown":"first search hit: http://www.coderanch.com/t/100214/patterns/Command-vs-Strategy-Pattern","body":"first search hit: <a href=\"http://www.coderanch.com/t/100214/patterns/Command-vs-Strategy-Pattern\" rel=\"nofollow noreferrer\">coderanch.com/t/100214/patterns/Command-vs-Strategy-Pattern</a>"},{"owner":{"account_id":52822,"reputation":1089035,"user_id":157882,"accept_rate":93,"display_name":"BalusC"},"score":2,"creation_date":1296275009,"post_id":4834979,"comment_id":5366527,"body_markdown":"Related: http://stackoverflow.com/questions/1673841/examples-of-gof-design-patterns","body":"Related: <a href=\"http://stackoverflow.com/questions/1673841/examples-of-gof-design-patterns\" title=\"examples of gof design patterns\">stackoverflow.com/questions/1673841/&hellip;</a>"},{"owner":{"account_id":17919,"reputation":1594,"user_id":40614,"accept_rate":78,"display_name":"pramodc84"},"score":0,"creation_date":1418913879,"post_id":4834979,"comment_id":43524486,"body_markdown":"possible duplicate of [Strategy pattern vs. Command pattern](http://stackoverflow.com/questions/3883692/strategy-pattern-vs-command-pattern)","body":"possible duplicate of <a href=\"http://stackoverflow.com/questions/3883692/strategy-pattern-vs-command-pattern\">Strategy pattern vs. Command pattern</a>"}],"answers":[{"comments":[{"owner":{"account_id":6244113,"reputation":156,"user_id":4856695,"display_name":"Hien Nguyen"},"score":65,"creation_date":1505126088,"post_id":4835013,"comment_id":79268775,"body_markdown":"Just brief, a command has different purpose. For example: CutCommand, DeleteCommand, CopyCommand, SortCommand,.... A strategy has same purpose but different approach. In sorting algorithm, we have: BubbleSort, SelectionSort,...","body":"Just brief, a command has different purpose. For example: CutCommand, DeleteCommand, CopyCommand, SortCommand,.... A strategy has same purpose but different approach. In sorting algorithm, we have: BubbleSort, SelectionSort,..."},{"owner":{"account_id":2575514,"reputation":1525,"user_id":2233336,"accept_rate":80,"display_name":"Utsav T"},"score":2,"creation_date":1676483997,"post_id":4835013,"comment_id":133147700,"body_markdown":"Just to top up with an explanation that has been with me for a long time: &quot;If I tell my driver that I want to reach destination A by 10 AM - that&#39;s command pattern. If I tell my driver to drive at 60km/hr for 10mins and then 20km/hr for 20 mins - that&#39;s strategy pattern&quot;","body":"Just to top up with an explanation that has been with me for a long time: &quot;If I tell my driver that I want to reach destination A by 10 AM - that&#39;s command pattern. If I tell my driver to drive at 60km/hr for 10mins and then 20km/hr for 20 mins - that&#39;s strategy pattern&quot;"}],"tags":[],"owner":{"account_id":22521,"reputation":35904,"user_id":55637,"accept_rate":67,"display_name":"Jeffrey Hantin"},"comment_count":2,"down_vote_count":0,"up_vote_count":153,"is_accepted":true,"score":153,"last_activity_date":1296272773,"creation_date":1296272773,"answer_id":4835013,"question_id":4834979,"body_markdown":"Typically the Command pattern is used to make an object out of *what needs to be done* -- to take an operation and its arguments and wrap them up in an object to be logged, held for undo, sent to a remote site, etc.  There will tend to be a large number of distinct Command objects that pass through a given point in a system over time, and the Command objects will hold varying parameters describing the operation requested.\r\n\r\nThe Strategy pattern, on the other hand, is used to specify *how* something should be done, and plugs into a larger object or method to provide a specific algorithm.  A Strategy for sorting might be a merge sort, might be an insertion sort, or perhaps something more complex like only using merge sort if the list is larger than some minimum size.  Strategy objects are rarely subjected to the sort of mass shuffling about that Command objects are, instead often being used for configuration or tuning purposes.\r\n\r\nBoth patterns involve factoring the code and possibly parameters for individual operations out of the original class that contained them into another object to provide for independent variability.  The differences are in the use cases encountered in practice and the intent behind each pattern.","title":"Difference between Strategy pattern and Command pattern","body":"<p>Typically the Command pattern is used to make an object out of <em>what needs to be done</em> -- to take an operation and its arguments and wrap them up in an object to be logged, held for undo, sent to a remote site, etc.  There will tend to be a large number of distinct Command objects that pass through a given point in a system over time, and the Command objects will hold varying parameters describing the operation requested.</p>\n\n<p>The Strategy pattern, on the other hand, is used to specify <em>how</em> something should be done, and plugs into a larger object or method to provide a specific algorithm.  A Strategy for sorting might be a merge sort, might be an insertion sort, or perhaps something more complex like only using merge sort if the list is larger than some minimum size.  Strategy objects are rarely subjected to the sort of mass shuffling about that Command objects are, instead often being used for configuration or tuning purposes.</p>\n\n<p>Both patterns involve factoring the code and possibly parameters for individual operations out of the original class that contained them into another object to provide for independent variability.  The differences are in the use cases encountered in practice and the intent behind each pattern.</p>\n"},{"comments":[{"owner":{"account_id":1403300,"reputation":3934,"user_id":1331672,"display_name":"Gerard ONeill"},"score":4,"creation_date":1637728965,"post_id":4835168,"comment_id":123901467,"body_markdown":"Nice answer - but a little too terse.  Your comments in the code about which objects are worked on is the key, but since you don&#39;t break it out people don&#39;t give you credit.  It&#39;s probably the best answer here.","body":"Nice answer - but a little too terse.  Your comments in the code about which objects are worked on is the key, but since you don&#39;t break it out people don&#39;t give you credit.  It&#39;s probably the best answer here."},{"owner":{"account_id":22521,"reputation":35904,"user_id":55637,"accept_rate":67,"display_name":"Jeffrey Hantin"},"score":0,"creation_date":1678028614,"post_id":4835168,"comment_id":133449813,"body_markdown":"@GerardONeill Fair enough. I suppose what I was driving at is that in the absence of clear intent hints, the two patterns are not the easiest thing to pull apart, because they both reify choice of code path into an object but do little else otherwise.","body":"@GerardONeill Fair enough. I suppose what I was driving at is that in the absence of clear intent hints, the two patterns are not the easiest thing to pull apart, because they both reify choice of code path into an object but do little else otherwise."},{"owner":{"account_id":1403300,"reputation":3934,"user_id":1331672,"display_name":"Gerard ONeill"},"score":0,"creation_date":1678230524,"post_id":4835168,"comment_id":133492583,"body_markdown":"@JeffreyHantin Hah - your answer is fine; but it needs to be more concrete.  This answer was fine, but it needed more of an explanation.  I&#39;m glad we get to see both answers on the same question :)","body":"@JeffreyHantin Hah - your answer is fine; but it needs to be more concrete.  This answer was fine, but it needed more of an explanation.  I&#39;m glad we get to see both answers on the same question :)"}],"tags":[],"owner":{"account_id":52822,"reputation":1089035,"user_id":157882,"accept_rate":93,"display_name":"BalusC"},"comment_count":3,"down_vote_count":2,"up_vote_count":88,"is_accepted":false,"score":86,"last_activity_date":1665496477,"creation_date":1296275422,"answer_id":4835168,"question_id":4834979,"body_markdown":"Words are already given in [the other answer][1]. Here is the difference in concrete code.\r\n\r\n    public class ConcreteStrategy implements BaseStrategy {\r\n\r\n        @Override\r\n        public void execute(Object argument) {\r\n\r\n            // Work with passed-in argument.\r\n\r\n        }\r\n\r\n    }\r\n\r\n---\r\n\r\n    public class ConcreteCommand implements BaseCommand {\r\n\r\n        private Object argument;\r\n\r\n        public ConcreteCommand(Object argument) {\r\n            this.argument = argument;\r\n        }\r\n\r\n        @Override\r\n        public void execute() {\r\n\r\n            // Work with own state.\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n  [1]: https://stackoverflow.com/a/4835013","title":"Difference between Strategy pattern and Command pattern","body":"<p>Words are already given in <a href=\"https://stackoverflow.com/a/4835013\">the other answer</a>. Here is the difference in concrete code.</p>\n<pre><code>public class ConcreteStrategy implements BaseStrategy {\n\n    @Override\n    public void execute(Object argument) {\n\n        // Work with passed-in argument.\n\n    }\n\n}\n</code></pre>\n<hr />\n<pre><code>public class ConcreteCommand implements BaseCommand {\n\n    private Object argument;\n\n    public ConcreteCommand(Object argument) {\n        this.argument = argument;\n    }\n\n    @Override\n    public void execute() {\n\n        // Work with own state.\n\n    }\n\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":10961577,"reputation":964,"user_id":8054721,"display_name":"amarnath harish"},"score":0,"creation_date":1612856487,"post_id":4835892,"comment_id":116890092,"body_markdown":"SOAP webservices are one example for command pattern .","body":"SOAP webservices are one example for command pattern ."}],"tags":[],"owner":{"account_id":93911,"reputation":5846,"user_id":256717,"accept_rate":80,"display_name":"Fakrudeen"},"comment_count":1,"down_vote_count":2,"up_vote_count":58,"is_accepted":false,"score":56,"last_activity_date":1296289895,"creation_date":1296289895,"answer_id":4835892,"question_id":4834979,"body_markdown":"Strategy - Quicksort or Mergesort [algo change]\r\n\r\nCommand - Open or Close [action change]","title":"Difference between Strategy pattern and Command pattern","body":"<p>Strategy - Quicksort or Mergesort [algo change]</p>\n\n<p>Command - Open or Close [action change]</p>\n"},{"tags":[],"owner":{"account_id":5889359,"reputation":169,"user_id":4870176,"display_name":"Asif Malek"},"comment_count":0,"down_vote_count":0,"up_vote_count":14,"is_accepted":false,"score":14,"last_activity_date":1444028453,"creation_date":1444028453,"answer_id":32942916,"question_id":4834979,"body_markdown":"The main difference is , the command does some action over the object.\r\nIt may change the state of an object.\r\n\r\nWhile Strategy decides how to process the object.\r\nIt encapsulates some business logic.","title":"Difference between Strategy pattern and Command pattern","body":"<p>The main difference is , the command does some action over the object.\nIt may change the state of an object.</p>\n\n<p>While Strategy decides how to process the object.\nIt encapsulates some business logic.</p>\n"},{"tags":[],"owner":{"account_id":6453072,"reputation":37996,"user_id":4999394,"accept_rate":98,"display_name":"Ravindra babu"},"comment_count":0,"down_vote_count":1,"up_vote_count":9,"is_accepted":false,"score":8,"last_activity_date":1680290156,"creation_date":1453830548,"answer_id":35020443,"question_id":4834979,"body_markdown":"*Strategy* pattern is useful when you have multiple implementations (algorithms) for a given feature and you want to change the algorithm at runtime depending on parameter type.  \r\n\r\n*Salient features of Strategy pattern*\r\n\r\n1. It&#39;s a behavioural pattern\r\n2. It&#39;s based on delegation\r\n3. It changes guts of the object by modifying method behaviour\r\n4. It&#39;s used to switch between family of algorithms\r\n5. It changes the behaviour of the object at run time\r\n\r\nhttps://stackoverflow.com/questions/370258/real-world-example-of-the-strategy-pattern/35180265#35180265\r\n\r\n*Command* pattern is used to enable loose coupling between Invoker and Receiver. Command, ConcreteCommand, Receiver, Invoker and Client are major components of this pattern.\r\n\r\nDifferent Receivers will execute same Command through Invoker &amp; Concrete Command but the implementation of Command will vary in each Receiver. \r\n\r\ne.g. You have to implement &quot;On&quot; and &quot;Off&quot; functionality for *TV &amp; DVDPlayer*. But TV and DVDPlayer will have different implementation for these commands.\r\n\r\nHave a look at below posts with code examples :\r\n\r\nhttps://stackoverflow.com/questions/2015549/using-command-design-pattern/34789979#34789979\r\n\r\n\r\n  [1]: http://grepcode.com/file_/repo1.maven.org/maven2/javax.servlet/servlet-api/2.5/javax/servlet/http/HttpServlet.java/?v=source\r\n","title":"Difference between Strategy pattern and Command pattern","body":"<p><em>Strategy</em> pattern is useful when you have multiple implementations (algorithms) for a given feature and you want to change the algorithm at runtime depending on parameter type.</p>\n<p><em>Salient features of Strategy pattern</em></p>\n<ol>\n<li>It's a behavioural pattern</li>\n<li>It's based on delegation</li>\n<li>It changes guts of the object by modifying method behaviour</li>\n<li>It's used to switch between family of algorithms</li>\n<li>It changes the behaviour of the object at run time</li>\n</ol>\n<p><a href=\"https://stackoverflow.com/questions/370258/real-world-example-of-the-strategy-pattern/35180265#35180265\">Real World Example of the Strategy Pattern</a></p>\n<p><em>Command</em> pattern is used to enable loose coupling between Invoker and Receiver. Command, ConcreteCommand, Receiver, Invoker and Client are major components of this pattern.</p>\n<p>Different Receivers will execute same Command through Invoker &amp; Concrete Command but the implementation of Command will vary in each Receiver.</p>\n<p>e.g. You have to implement &quot;On&quot; and &quot;Off&quot; functionality for <em>TV &amp; DVDPlayer</em>. But TV and DVDPlayer will have different implementation for these commands.</p>\n<p>Have a look at below posts with code examples :</p>\n<p><a href=\"https://stackoverflow.com/questions/2015549/using-command-design-pattern/34789979#34789979\">Using Command Design pattern</a></p>\n"},{"tags":[],"owner":{"account_id":17038954,"reputation":1,"user_id":13809457,"display_name":"Ahmed Shalaby"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1605921133,"creation_date":1605921133,"answer_id":64938865,"question_id":4834979,"body_markdown":"I think a big difference here is that **Strategy pattern** is used when you need to shuffle between different objects that implement the ***same interface***, but **Command Pattern** is used  to shuffle between some objects that implement ***different interfaces*** ( as it encapsulates them into other objects called &quot;Command Objects&quot; ) and pass these command objects just like Strategy pattern does. ","title":"Difference between Strategy pattern and Command pattern","body":"<p>I think a big difference here is that <strong>Strategy pattern</strong> is used when you need to shuffle between different objects that implement the <em><strong>same interface</strong></em>, but <strong>Command Pattern</strong> is used  to shuffle between some objects that implement <em><strong>different interfaces</strong></em> ( as it encapsulates them into other objects called &quot;Command Objects&quot; ) and pass these command objects just like Strategy pattern does.</p>\n"},{"comments":[{"owner":{"account_id":194308,"reputation":66745,"user_id":436560,"accept_rate":87,"display_name":"Lajos Arpad"},"score":0,"creation_date":1700312861,"post_id":77487748,"comment_id":136640518,"body_markdown":"This is a paste-only answer. The question wondered about the difference between two patterns.","body":"This is a paste-only answer. The question wondered about the difference between two patterns."},{"owner":{"account_id":13638740,"reputation":1,"user_id":9839156,"display_name":"Front-end Padavan"},"score":0,"creation_date":1700660325,"post_id":77487748,"comment_id":136681689,"body_markdown":"&quot;... I am also looking for some examples in Java.&quot;","body":"&quot;... I am also looking for some examples in Java.&quot;"},{"owner":{"account_id":194308,"reputation":66745,"user_id":436560,"accept_rate":87,"display_name":"Lajos Arpad"},"score":0,"creation_date":1700660657,"post_id":77487748,"comment_id":136681756,"body_markdown":"&quot;Also&quot; means &quot;besides something else&quot;. Like an answer, an explanation.","body":"&quot;Also&quot; means &quot;besides something else&quot;. Like an answer, an explanation."}],"tags":[],"owner":{"account_id":13638740,"reputation":1,"user_id":9839156,"display_name":"Front-end Padavan"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700051664,"creation_date":1700051664,"answer_id":77487748,"question_id":4834979,"body_markdown":"The one of possible solutions for strategy pattern\r\n\r\n    @Service\r\n    @RequiredArgsConstructor\r\n    public class StrategyService {\r\n    \r\n      private final FirstWay firstWay;\r\n      private final SecondWay secondWay;\r\n    \r\n      private final Map&lt;Operation, Strategy&gt; strategies = new HashMap&lt;&gt;();\r\n    \r\n      @FunctionalInterface\r\n      interface Strategy {\r\n        Message execute(Entity entity);\r\n      }\r\n    \r\n      @PostConstruct\r\n      private void init() {\r\n        strategies.put(\r\n            Operation.FIRST_STRATEGY,\r\n            entity -&gt;\r\n                firstWay.process(entity.getId()));\r\n        strategies.put(\r\n            Operation.SECOND_STRATEGY,\r\n            entity -&gt;\r\n                secondWay.process(entity.getId()));\r\n      }\r\n    \r\n      public Message execute(Entity entity) {\r\n        Strategy strategy = strategies.get(entity.getOperation());\r\n    \r\n        if (Objects.isNull(strategy)) {\r\n          throw new TechnicalException(\r\n                  TechnicalException.NO_STRATEGY_OPERATION);\r\n        }\r\n        return strategy.execute(entity);\r\n      }\r\n    }","title":"Difference between Strategy pattern and Command pattern","body":"<p>The one of possible solutions for strategy pattern</p>\n<pre><code>@Service\n@RequiredArgsConstructor\npublic class StrategyService {\n\n  private final FirstWay firstWay;\n  private final SecondWay secondWay;\n\n  private final Map&lt;Operation, Strategy&gt; strategies = new HashMap&lt;&gt;();\n\n  @FunctionalInterface\n  interface Strategy {\n    Message execute(Entity entity);\n  }\n\n  @PostConstruct\n  private void init() {\n    strategies.put(\n        Operation.FIRST_STRATEGY,\n        entity -&gt;\n            firstWay.process(entity.getId()));\n    strategies.put(\n        Operation.SECOND_STRATEGY,\n        entity -&gt;\n            secondWay.process(entity.getId()));\n  }\n\n  public Message execute(Entity entity) {\n    Strategy strategy = strategies.get(entity.getOperation());\n\n    if (Objects.isNull(strategy)) {\n      throw new TechnicalException(\n              TechnicalException.NO_STRATEGY_OPERATION);\n    }\n    return strategy.execute(entity);\n  }\n}\n</code></pre>\n"}],"owner":{"account_id":185198,"reputation":7184,"user_id":421753,"accept_rate":78,"display_name":"Krishna"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":49666,"favorite_count":0,"down_vote_count":1,"up_vote_count":114,"accepted_answer_id":4835013,"answer_count":7,"score":113,"last_activity_date":1700051664,"creation_date":1296272039,"question_id":4834979,"body_markdown":"What is the difference between the [Strategy pattern][1] and the [Command pattern][2]?  I am also looking for some examples in Java. \r\n\r\n\r\n  [1]: http://en.wikipedia.org/wiki/Strategy_pattern\r\n  [2]: http://en.wikipedia.org/wiki/Command_pattern","title":"Difference between Strategy pattern and Command pattern","body":"<p>What is the difference between the <a href=\"http://en.wikipedia.org/wiki/Strategy_pattern\" rel=\"noreferrer\">Strategy pattern</a> and the <a href=\"http://en.wikipedia.org/wiki/Command_pattern\" rel=\"noreferrer\">Command pattern</a>?  I am also looking for some examples in Java. </p>\n"},{"tags":["java","libgdx","game-physics","box2d"],"answers":[{"tags":[],"owner":{"account_id":422872,"reputation":656,"user_id":801899,"display_name":"londonBadger"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700049187,"creation_date":1700049187,"answer_id":77487484,"question_id":77483385,"body_markdown":"You could check the x position of the ball on contact i.e. ballX &lt; minX+margin for left and ballX &gt;maxX-margin for right.\r\n","title":"How to know which side of a ChainShape is being collided with?","body":"<p>You could check the x position of the ball on contact i.e. ballX &lt; minX+margin for left and ballX &gt;maxX-margin for right.</p>\n"}],"owner":{"account_id":29723909,"reputation":23,"user_id":22780465,"display_name":"Copha"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":17,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1700051323,"creation_date":1699990672,"question_id":77483385,"body_markdown":"I&#39;m learning LibGDX and trying to use Box2D for collision and movement. I&#39;m making a simple Pong game. When the ball hits the left or right wall (i.e. the other side scores), I want the ball&#39;s body to be destroyed and replaced with a new one in the center of the screen. Obviously this should not happen when the ball hits the top or bottom.\r\n\r\nI have created a body with a ChainShape fixture to represent the game&#39;s border. This chain has 4 vertexes and forms a loop. I&#39;ve also created a ContactListener, where the collision between border and ball is handled. The question is: how can I trigger the desired behavior only when the left or right wall is involved in the collision?\r\n\r\nIt seems to me that somehow the left or right wall should be isolated, perhaps as an EdgeShape. But I can&#39;t find any way to do that. The Contact, Fixture and ChainShape all seem to have no relevant methods for this. I also can&#39;t find any info about this online.\r\n\r\nBelow is the code I currently have for the ContactListener:\r\n\r\n\r\n```\r\npublic final class CollisionListener implements ContactListener {\r\n  @Override\r\n  public void beginContact(Contact contact) {\r\n    var fixtureA = contact.getFixtureA();\r\n    var fixtureB = contact.getFixtureB();\r\n    \r\n    if (fixtureA.getUserData() != &quot;border&quot; &amp;&amp; fixtureB.getUserData() != &quot;border&quot;) {\r\n      return;\r\n    }\r\n\r\n    //TODO: Only trigger for left and right walls\r\n\r\n    var object = fixtureA.getUserData() == &quot;border&quot; ? fixtureB : fixtureA;\r\n    Entity entity = (Entity)object.getUserData();\r\n\r\n    // Logic for creating new body\r\n  }\r\n}\r\n```\r\n\r\nAnd the ChainShape:\r\n\r\n\r\n```\r\n  private void createBorders() {\r\n    var bodyDef = new BodyDef();\r\n    bodyDef.type = BodyType.StaticBody\r\n    bodyDef.position.set(0, 0);\r\n\r\n    var body = world.createBody(bodyDef);\r\n\r\n    var chain = new ChainShape();\r\n    chain.createLoop(\r\n      new Vector2[] {\r\n        new Vector2(Constants.VIEWPORT_MAX_X, Constants.VIEWPORT_MAX_Y),\r\n        new Vector2(Constants.VIEWPORT_MAX_X, Constants.VIEWPORT_MIN_Y),\r\n        new Vector2(Constants.VIEWPORT_MIN_X, Constants.VIEWPORT_MIN_Y),\r\n        new Vector2(Constants.VIEWPORT_MIN_X, Constants.VIEWPORT_MAX_Y)\r\n      }\r\n    );\r\n\r\n    body.createFixture(chain, 0f);\r\n    body.setUserData(&quot;border&quot;);\r\n    chain.dispose();\r\n  }\r\n```\r\n","title":"How to know which side of a ChainShape is being collided with?","body":"<p>I'm learning LibGDX and trying to use Box2D for collision and movement. I'm making a simple Pong game. When the ball hits the left or right wall (i.e. the other side scores), I want the ball's body to be destroyed and replaced with a new one in the center of the screen. Obviously this should not happen when the ball hits the top or bottom.</p>\n<p>I have created a body with a ChainShape fixture to represent the game's border. This chain has 4 vertexes and forms a loop. I've also created a ContactListener, where the collision between border and ball is handled. The question is: how can I trigger the desired behavior only when the left or right wall is involved in the collision?</p>\n<p>It seems to me that somehow the left or right wall should be isolated, perhaps as an EdgeShape. But I can't find any way to do that. The Contact, Fixture and ChainShape all seem to have no relevant methods for this. I also can't find any info about this online.</p>\n<p>Below is the code I currently have for the ContactListener:</p>\n<pre><code>public final class CollisionListener implements ContactListener {\n  @Override\n  public void beginContact(Contact contact) {\n    var fixtureA = contact.getFixtureA();\n    var fixtureB = contact.getFixtureB();\n    \n    if (fixtureA.getUserData() != &quot;border&quot; &amp;&amp; fixtureB.getUserData() != &quot;border&quot;) {\n      return;\n    }\n\n    //TODO: Only trigger for left and right walls\n\n    var object = fixtureA.getUserData() == &quot;border&quot; ? fixtureB : fixtureA;\n    Entity entity = (Entity)object.getUserData();\n\n    // Logic for creating new body\n  }\n}\n</code></pre>\n<p>And the ChainShape:</p>\n<pre><code>  private void createBorders() {\n    var bodyDef = new BodyDef();\n    bodyDef.type = BodyType.StaticBody\n    bodyDef.position.set(0, 0);\n\n    var body = world.createBody(bodyDef);\n\n    var chain = new ChainShape();\n    chain.createLoop(\n      new Vector2[] {\n        new Vector2(Constants.VIEWPORT_MAX_X, Constants.VIEWPORT_MAX_Y),\n        new Vector2(Constants.VIEWPORT_MAX_X, Constants.VIEWPORT_MIN_Y),\n        new Vector2(Constants.VIEWPORT_MIN_X, Constants.VIEWPORT_MIN_Y),\n        new Vector2(Constants.VIEWPORT_MIN_X, Constants.VIEWPORT_MAX_Y)\n      }\n    );\n\n    body.createFixture(chain, 0f);\n    body.setUserData(&quot;border&quot;);\n    chain.dispose();\n  }\n</code></pre>\n"},{"tags":["java","spring-boot","apache-poi"],"answers":[{"comments":[{"owner":{"account_id":14831756,"reputation":83,"user_id":10711074,"display_name":"raymax"},"score":0,"creation_date":1700051961,"post_id":77487674,"comment_id":136606906,"body_markdown":"Hi @Axel Richter is it possible to have a fixed starting position for legends ?","body":"Hi @Axel Richter is it possible to have a fixed starting position for legends ?"},{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":1,"creation_date":1700053563,"post_id":77487674,"comment_id":136607202,"body_markdown":"@raymax: Don&#39;t understand that requirement. By `.addNewX().setVal(0.0)` and `.addNewY().setVal(0.70)` you set the start position. You mean a fixed position in pixels, points, centimeters or so? What advantage would that have?","body":"@raymax: Don&#39;t understand that requirement. By <code>.addNewX().setVal(0.0)</code> and <code>.addNewY().setVal(0.70)</code> you set the start position. You mean a fixed position in pixels, points, centimeters or so? What advantage would that have?"},{"owner":{"account_id":14831756,"reputation":83,"user_id":10711074,"display_name":"raymax"},"score":0,"creation_date":1700054583,"post_id":77487674,"comment_id":136607420,"body_markdown":"I want to start the legends from a specific Row and Col. But yes I can also do this  by .addNewX().setVal(0.0) and .addNewY().setVal(0.70) .","body":"I want to start the legends from a specific Row and Col. But yes I can also do this  by .addNewX().setVal(0.0) and .addNewY().setVal(0.70) ."},{"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"score":1,"creation_date":1700054782,"post_id":77487674,"comment_id":136607454,"body_markdown":"@raymax: &quot;start the legends from a specific Row and Col&quot;: Not possible. Chart legends are not anchored to the sheet. Chart legends are part of the chart and only the whole chart shape is anchored to the sheet.","body":"@raymax: &quot;start the legends from a specific Row and Col&quot;: Not possible. Chart legends are not anchored to the sheet. Chart legends are part of the chart and only the whole chart shape is anchored to the sheet."}],"tags":[],"owner":{"account_id":4853829,"reputation":57305,"user_id":3915431,"display_name":"Axel Richter"},"comment_count":4,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1700050998,"creation_date":1700050998,"answer_id":77487674,"question_id":77487288,"body_markdown":"This has nothing to do with positioning the legend. This is done via `legend.setPosition(LegendPosition.BOTTOM);` which means legend is positioned at bottom of chart space and grows up to top. \r\n\r\nBut as often, there never is enough space. And so legend grows into the plot area to fit content in. \r\n\r\nTo avoid this, only possibility is to shrink the legend area size. That is similar to set plot area size, what you already do.\r\n\r\n\r\n    XSSFChart chart = ...\r\n\r\n    // set legend area size\r\n    if (!chart.getCTChart().getLegend().isSetLayout()) {\r\n      chart.getCTChart().getLegend().addNewLayout();\r\n    }\r\n    if (chart.getCTChart().getLegend().getLayout().isSetManualLayout()) {\r\n      chart.getCTChart().getLegend().getLayout().unsetManualLayout();\r\n    }\r\n    chart.getCTChart().getLegend().getLayout().addNewManualLayout();\r\n    chart.getCTChart().getLegend().getLayout().getManualLayout().addNewXMode().setVal(\r\n      org.openxmlformats.schemas.drawingml.x2006.chart.STLayoutMode.EDGE);\r\n    chart.getCTChart().getLegend().getLayout().getManualLayout().addNewYMode().setVal(\r\n      org.openxmlformats.schemas.drawingml.x2006.chart.STLayoutMode.EDGE);\r\n    chart.getCTChart().getLegend().getLayout().getManualLayout().addNewX().setVal(0.0); //0% from left\r\n    chart.getCTChart().getLegend().getLayout().getManualLayout().addNewY().setVal(0.70); //70% from top\r\n    chart.getCTChart().getLegend().getLayout().getManualLayout().addNewW().setVal(1.00); //100% width\r\n    chart.getCTChart().getLegend().getLayout().getManualLayout().addNewH().setVal(0.30); //30% height\r\n\r\n\r\nBut now the legend content will not more fit into the legend size.\r\n\r\nOne could set smaller font size for legend content, like so:\r\n\r\n    //set legend default font size\r\n    if (chart.getCTChart().getLegend().isSetTxPr()) {\r\n      chart.getCTChart().getLegend().unsetTxPr();\r\n    }\r\n    chart.getCTChart().getLegend().addNewTxPr();\r\n    chart.getCTChart().getLegend().getTxPr().addNewBodyPr();\r\n    chart.getCTChart().getLegend().getTxPr().addNewP();\r\n    chart.getCTChart().getLegend().getTxPr().getPArray(0).addNewPPr();\r\n    chart.getCTChart().getLegend().getTxPr().getPArray(0).getPPr().addNewDefRPr().setSz(600); // default font size 6pt\r\n\r\n\r\nBut this quickly leads to be the legend text impossible to read.\r\n\r\nThen the chart space must be set bigger by making anchor&#39;s `row2` bigger.","title":"How to reposition XDDFChartLegend legends in Apache poi chart","body":"<p>This has nothing to do with positioning the legend. This is done via <code>legend.setPosition(LegendPosition.BOTTOM);</code> which means legend is positioned at bottom of chart space and grows up to top.</p>\n<p>But as often, there never is enough space. And so legend grows into the plot area to fit content in.</p>\n<p>To avoid this, only possibility is to shrink the legend area size. That is similar to set plot area size, what you already do.</p>\n<pre><code>XSSFChart chart = ...\n\n// set legend area size\nif (!chart.getCTChart().getLegend().isSetLayout()) {\n  chart.getCTChart().getLegend().addNewLayout();\n}\nif (chart.getCTChart().getLegend().getLayout().isSetManualLayout()) {\n  chart.getCTChart().getLegend().getLayout().unsetManualLayout();\n}\nchart.getCTChart().getLegend().getLayout().addNewManualLayout();\nchart.getCTChart().getLegend().getLayout().getManualLayout().addNewXMode().setVal(\n  org.openxmlformats.schemas.drawingml.x2006.chart.STLayoutMode.EDGE);\nchart.getCTChart().getLegend().getLayout().getManualLayout().addNewYMode().setVal(\n  org.openxmlformats.schemas.drawingml.x2006.chart.STLayoutMode.EDGE);\nchart.getCTChart().getLegend().getLayout().getManualLayout().addNewX().setVal(0.0); //0% from left\nchart.getCTChart().getLegend().getLayout().getManualLayout().addNewY().setVal(0.70); //70% from top\nchart.getCTChart().getLegend().getLayout().getManualLayout().addNewW().setVal(1.00); //100% width\nchart.getCTChart().getLegend().getLayout().getManualLayout().addNewH().setVal(0.30); //30% height\n</code></pre>\n<p>But now the legend content will not more fit into the legend size.</p>\n<p>One could set smaller font size for legend content, like so:</p>\n<pre><code>//set legend default font size\nif (chart.getCTChart().getLegend().isSetTxPr()) {\n  chart.getCTChart().getLegend().unsetTxPr();\n}\nchart.getCTChart().getLegend().addNewTxPr();\nchart.getCTChart().getLegend().getTxPr().addNewBodyPr();\nchart.getCTChart().getLegend().getTxPr().addNewP();\nchart.getCTChart().getLegend().getTxPr().getPArray(0).addNewPPr();\nchart.getCTChart().getLegend().getTxPr().getPArray(0).getPPr().addNewDefRPr().setSz(600); // default font size 6pt\n</code></pre>\n<p>But this quickly leads to be the legend text impossible to read.</p>\n<p>Then the chart space must be set bigger by making anchor's <code>row2</code> bigger.</p>\n"}],"owner":{"account_id":14831756,"reputation":83,"user_id":10711074,"display_name":"raymax"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":44,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77487674,"answer_count":1,"score":0,"last_activity_date":1700050998,"creation_date":1700047248,"question_id":77487288,"body_markdown":"I am creating multiple doughnut charts using Apache POI. I face problems when the label String size is big and when more labels are added. In the Apache POI documentation, I found no method in XDDFChartLegend where the margin can be adjusted. I also want those labels to fit in the space allocated for the Legends, regardless of size.\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/CN0CE.png\r\n\r\nIn the above picture, one can observe \r\n 1. When the legend&#39;s string size is big, then it overlays on the chart. Also, there are 10 legends. But only 8 are being displayed. \r\n 2. When The legends are small in string size, then all the legends are displayed.\r\n\r\n\r\n     \r\n        \r\n        public static XSSFChart createDoughnutChart(XSSFSheet sheet, String[] categories,Number[] values, String titleText, int col1, int row1, int col2, int row2) {\r\n        XSSFDrawing drawing = sheet.createDrawingPatriarch();\r\n        XSSFClientAnchor anchor = drawing.createAnchor(0, 0, 0, 0, col1, row1, col2, row2);\r\n\r\n        XSSFChart chart = drawing.createChart(anchor);\r\n        chart.setTitleText(titleText);\r\n        chart.setTitleOverlay(false);\r\n\r\n        XDDFChartLegend legend = chart.getOrAddLegend();\r\n        legend.setPosition(LegendPosition.BOTTOM);\r\n        legend.setOverlay(true);\r\n\r\n        //setting legend size\r\n        XDDFTextBody legendTextBody = new XDDFTextBody(legend);\r\n        legendTextBody.getXmlObject().addNewBodyPr();\r\n        legendTextBody.addNewParagraph().addDefaultRunProperties().setFontSize(6d);\r\n        legend.setTextBody(legendTextBody);\r\n\r\n\r\n        XDDFDataSource&lt;String&gt; cat = XDDFDataSourcesFactory.fromArray(categories);\r\n        XDDFNumericalDataSource&lt;Number&gt; val = XDDFDataSourcesFactory.fromArray(values);\r\n        XDDFDoughnutChartData data = (XDDFDoughnutChartData)chart.createData(ChartTypes.DOUGHNUT, null, null);\r\n        data.setVaryColors(false);\r\n        data.setHoleSize(50);\r\n        XDDFChartData.Series series = data.addSeries(cat, val);\r\n\r\n        chart.plot(data);\r\n\r\n        // Do not auto delete the title; is necessary for showing title in Calc\r\n        if (chart.getCTChart().getAutoTitleDeleted() == null) chart.getCTChart().addNewAutoTitleDeleted();\r\n        chart.getCTChart().getAutoTitleDeleted().setVal(false);\r\n\r\n        // Data point colors; is necessary for showing data points in Calc\r\n        int pointCount = series.getCategoryData().getPointCount();\r\n        for (int p = 0; p &lt; pointCount; p++) {\r\n            chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).addNewDPt().addNewIdx().setVal(p);\r\n            chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDPtArray(p)\r\n                    .addNewSpPr().addNewSolidFill().addNewSrgbClr().setVal(XlsxService.getColor(p));\r\n        }\r\n\r\n        // Add data labels\r\n        if (!chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).isSetDLbls()) {\r\n            chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).addNewDLbls();\r\n        }\r\n        chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDLbls().addNewShowVal().setVal(true);\r\n        chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDLbls().addNewShowSerName().setVal(false);\r\n        chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDLbls().addNewShowCatName().setVal(false);\r\n        chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDLbls().addNewShowPercent().setVal(false);\r\n        chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDLbls().addNewShowLegendKey().setVal(false);\r\n\r\n        // chart area (chartspace) without border line\r\n        chart.getCTChartSpace().addNewSpPr().addNewLn().addNewNoFill();\r\n        // changing background color\r\n        if (chart.getCTChartSpace().getSpPr() == null) chart.getCTChartSpace().addNewSpPr();\r\n        if (chart.getCTChartSpace().getSpPr().isSetSolidFill()) chart.getCTChartSpace().getSpPr().unsetSolidFill();\r\n        chart.getCTChartSpace().getSpPr().addNewSolidFill().addNewSrgbClr().setVal(new byte[]{(byte)242, (byte)242, (byte)242});\r\n        // set plot area size\r\n        if (!chart.getCTChart().getPlotArea().isSetLayout()) {\r\n            chart.getCTChart().getPlotArea().addNewLayout();\r\n        }\r\n        if (chart.getCTChart().getPlotArea().getLayout().isSetManualLayout()) {\r\n            chart.getCTChart().getPlotArea().getLayout().unsetManualLayout();\r\n        }\r\n        chart.getCTChart().getPlotArea().getLayout().addNewManualLayout();\r\n        chart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewLayoutTarget().setVal(\r\n                org.openxmlformats.schemas.drawingml.x2006.chart.STLayoutTarget.INNER);\r\n        chart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewXMode().setVal(\r\n                org.openxmlformats.schemas.drawingml.x2006.chart.STLayoutMode.EDGE);\r\n        chart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewYMode().setVal(\r\n                org.openxmlformats.schemas.drawingml.x2006.chart.STLayoutMode.EDGE);\r\n        chart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewX().setVal(0.10); //10% from left\r\n        chart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewY().setVal(0.10); //10% from top\r\n        chart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewW().setVal(0.80); //80% width\r\n        chart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewH().setVal(0.60); //60% height\r\n\r\n        return chart;\r\n    }\r\n\r\n","title":"How to reposition XDDFChartLegend legends in Apache poi chart","body":"<p>I am creating multiple doughnut charts using Apache POI. I face problems when the label String size is big and when more labels are added. In the Apache POI documentation, I found no method in XDDFChartLegend where the margin can be adjusted. I also want those labels to fit in the space allocated for the Legends, regardless of size.</p>\n<p><a href=\"https://i.stack.imgur.com/CN0CE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CN0CE.png\" alt=\"enter image description here\" /></a></p>\n<p>In the above picture, one can observe</p>\n<ol>\n<li><p>When the legend's string size is big, then it overlays on the chart. Also, there are 10 legends. But only 8 are being displayed.</p>\n</li>\n<li><p>When The legends are small in string size, then all the legends are displayed.</p>\n<pre><code>public static XSSFChart createDoughnutChart(XSSFSheet sheet, String[] categories,Number[] values, String titleText, int col1, int row1, int col2, int row2) {\nXSSFDrawing drawing = sheet.createDrawingPatriarch();\nXSSFClientAnchor anchor = drawing.createAnchor(0, 0, 0, 0, col1, row1, col2, row2);\n\nXSSFChart chart = drawing.createChart(anchor);\nchart.setTitleText(titleText);\nchart.setTitleOverlay(false);\n\nXDDFChartLegend legend = chart.getOrAddLegend();\nlegend.setPosition(LegendPosition.BOTTOM);\nlegend.setOverlay(true);\n\n//setting legend size\nXDDFTextBody legendTextBody = new XDDFTextBody(legend);\nlegendTextBody.getXmlObject().addNewBodyPr();\nlegendTextBody.addNewParagraph().addDefaultRunProperties().setFontSize(6d);\nlegend.setTextBody(legendTextBody);\n\n\nXDDFDataSource&lt;String&gt; cat = XDDFDataSourcesFactory.fromArray(categories);\nXDDFNumericalDataSource&lt;Number&gt; val = XDDFDataSourcesFactory.fromArray(values);\nXDDFDoughnutChartData data = (XDDFDoughnutChartData)chart.createData(ChartTypes.DOUGHNUT, null, null);\ndata.setVaryColors(false);\ndata.setHoleSize(50);\nXDDFChartData.Series series = data.addSeries(cat, val);\n\nchart.plot(data);\n\n// Do not auto delete the title; is necessary for showing title in Calc\nif (chart.getCTChart().getAutoTitleDeleted() == null) chart.getCTChart().addNewAutoTitleDeleted();\nchart.getCTChart().getAutoTitleDeleted().setVal(false);\n\n// Data point colors; is necessary for showing data points in Calc\nint pointCount = series.getCategoryData().getPointCount();\nfor (int p = 0; p &lt; pointCount; p++) {\n    chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).addNewDPt().addNewIdx().setVal(p);\n    chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDPtArray(p)\n            .addNewSpPr().addNewSolidFill().addNewSrgbClr().setVal(XlsxService.getColor(p));\n}\n\n// Add data labels\nif (!chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).isSetDLbls()) {\n    chart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).addNewDLbls();\n}\nchart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDLbls().addNewShowVal().setVal(true);\nchart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDLbls().addNewShowSerName().setVal(false);\nchart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDLbls().addNewShowCatName().setVal(false);\nchart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDLbls().addNewShowPercent().setVal(false);\nchart.getCTChart().getPlotArea().getDoughnutChartArray(0).getSerArray(0).getDLbls().addNewShowLegendKey().setVal(false);\n\n// chart area (chartspace) without border line\nchart.getCTChartSpace().addNewSpPr().addNewLn().addNewNoFill();\n// changing background color\nif (chart.getCTChartSpace().getSpPr() == null) chart.getCTChartSpace().addNewSpPr();\nif (chart.getCTChartSpace().getSpPr().isSetSolidFill()) chart.getCTChartSpace().getSpPr().unsetSolidFill();\nchart.getCTChartSpace().getSpPr().addNewSolidFill().addNewSrgbClr().setVal(new byte[]{(byte)242, (byte)242, (byte)242});\n// set plot area size\nif (!chart.getCTChart().getPlotArea().isSetLayout()) {\n    chart.getCTChart().getPlotArea().addNewLayout();\n}\nif (chart.getCTChart().getPlotArea().getLayout().isSetManualLayout()) {\n    chart.getCTChart().getPlotArea().getLayout().unsetManualLayout();\n}\nchart.getCTChart().getPlotArea().getLayout().addNewManualLayout();\nchart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewLayoutTarget().setVal(\n        org.openxmlformats.schemas.drawingml.x2006.chart.STLayoutTarget.INNER);\nchart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewXMode().setVal(\n        org.openxmlformats.schemas.drawingml.x2006.chart.STLayoutMode.EDGE);\nchart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewYMode().setVal(\n        org.openxmlformats.schemas.drawingml.x2006.chart.STLayoutMode.EDGE);\nchart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewX().setVal(0.10); //10% from left\nchart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewY().setVal(0.10); //10% from top\nchart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewW().setVal(0.80); //80% width\nchart.getCTChart().getPlotArea().getLayout().getManualLayout().addNewH().setVal(0.60); //60% height\n\nreturn chart;\n</code></pre>\n<p>}</p>\n</li>\n</ol>\n"},{"tags":["java","spring-boot","spring-security","spring-data-jpa"],"owner":{"account_id":9009497,"reputation":21,"user_id":22851473,"display_name":"Prototype"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":37,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1700050991,"creation_date":1700050991,"question_id":77487673,"body_markdown":"I need to get the current profile of an authorized user.\r\n\r\n`build.gradle`:\r\n```gradle\r\nplugins {\r\n\tid &#39;java&#39;\r\n\tid &#39;org.springframework.boot&#39; version &#39;3.1.5&#39;\r\n\tid &#39;io.spring.dependency-management&#39; version &#39;1.1.3&#39;\r\n}\r\n\r\njava {\r\n\tsourceCompatibility = &#39;21&#39;\r\n}\r\n\r\nconfigurations {\r\n\tcompileOnly {\r\n\t\textendsFrom annotationProcessor\r\n\t}\r\n}\r\n\r\nrepositories {\r\n\tmavenCentral()\r\n}\r\n\r\ndependencies {\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-batch&#39;\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-security&#39;\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-validation&#39;\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-web&#39;\r\n\timplementation &#39;org.springframework.session:spring-session-jdbc&#39;\r\n\r\n\timplementation &#39;org.flywaydb:flyway-core&#39;\r\n\timplementation &#39;org.modelmapper:modelmapper:3.2.0&#39;\r\n\timplementation &#39;org.springdoc:springdoc-openapi-starter-webmvc-ui:2.2.0&#39;\r\n\r\n\tcompileOnly &#39;org.projectlombok:lombok&#39;\r\n\tdevelopmentOnly &#39;org.springframework.boot:spring-boot-devtools&#39;\r\n\t// developmentOnly &#39;org.springframework.boot:spring-boot-docker-compose&#39;\r\n\truntimeOnly &#39;org.postgresql:postgresql&#39;\r\n\tannotationProcessor &#39;org.springframework.boot:spring-boot-configuration-processor&#39;\r\n\tannotationProcessor &#39;org.projectlombok:lombok&#39;\r\n\ttestImplementation &#39;org.springframework.boot:spring-boot-starter-test&#39;\r\n\ttestImplementation &#39;org.springframework.batch:spring-batch-test&#39;\r\n\ttestImplementation &#39;org.springframework.security:spring-security-test&#39;\r\n}\r\n```\r\n\r\nThere is a controller for this:\r\n\r\n\r\n```java\r\n@RestController\r\npublic class UserController {\r\n\r\n    @Operation(summary = &quot;Get user profile&quot;)\r\n    @PreAuthorize(&quot;hasRole(&#39;USER&#39;)&quot;)\r\n    @GetMapping(path = &quot;/profile&quot;, produces = MediaType.APPLICATION_JSON_VALUE)\r\n    public ResponseEntity&lt;UserDTO&gt; profile(@AuthenticationPrincipal User user) {\r\n        System.out.println(&quot;user.getId() = &quot; + user.getId()); // always null\r\n        return ResponseEntity.ok(mapper.map(user, UserDTO.class));\r\n    }\r\n\r\n}\r\n```\r\n\r\nconsole output always:\r\n`user.getId() = null`\r\n\r\ntable `users`:\r\n\r\n[![table users](https://i.stack.imgur.com/Ko3Ar.png)](https://i.stack.imgur.com/Ko3Ar.png)\r\n\r\n`User`:\r\n```java\r\n@Entity(name = &quot;user&quot;)\r\n@Table(name = &quot;users&quot;)\r\n@Getter\r\n@Setter\r\npublic class User extends BaseEntity&lt;Integer&gt; implements UserDetails {\r\n\r\n    @Column(name = &quot;email&quot;, nullable = false, unique = true)\r\n    private String email;\r\n\r\n    @Column(name = &quot;password&quot;, nullable = false)\r\n    private String password;\r\n\r\n    @Column(name = &quot;name&quot;, nullable = false)\r\n    private String name;\r\n\r\n    @Column(name = &quot;phone&quot;)\r\n    private String phone;\r\n\r\n    @Column(name = &quot;enabled&quot;, nullable = false)\r\n    private boolean enabled;\r\n\r\n    @ManyToMany(fetch = FetchType.EAGER)\r\n    @JoinTable(\r\n            name = &quot;users_roles&quot;,\r\n            joinColumns = @JoinColumn(name = &quot;user_id&quot;, referencedColumnName = &quot;id&quot;),\r\n            inverseJoinColumns = @JoinColumn(name = &quot;role_id&quot;, referencedColumnName = &quot;id&quot;)\r\n    )\r\n    private Collection&lt;Role&gt; roles;\r\n\r\n    @Override\r\n    public String getUsername() {\r\n        return this.email;\r\n    }\r\n\r\n    @Override\r\n    public Collection&lt;Role&gt; getAuthorities() {\r\n        return this.roles;\r\n    }\r\n\r\n    @Override\r\n    public boolean isAccountNonExpired() {\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean isAccountNonLocked() {\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean isCredentialsNonExpired() {\r\n        return true;\r\n    }\r\n\r\n}\r\n```\r\n\r\n`BaseEntity`:\r\n```java\r\n@Getter\r\n@Setter\r\n@MappedSuperclass\r\npublic abstract class BaseEntity&lt;ID extends Serializable&gt; {\r\n\r\n    @Id\r\n    @Column(name = &quot;id&quot;)\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Access(AccessType.PROPERTY)\r\n    private ID id;\r\n\r\n    // generated equals and hashCode with JPA Buddy ommited\r\n\r\n}\r\n```\r\n\r\n\r\nI tried to get rid of `@MappedSuperclass`, removed inheritance from BaseEntity and created an id field by analogy from BaseEntity and everything worked as it should.\r\nWhat could be the problem when using `@MappedSuperclass`?","title":"@AuthenticationPrincipal does not fill fields from the base entity @MappedSuperclass","body":"<p>I need to get the current profile of an authorized user.</p>\n<p><code>build.gradle</code>:</p>\n<pre><code>plugins {\n    id 'java'\n    id 'org.springframework.boot' version '3.1.5'\n    id 'io.spring.dependency-management' version '1.1.3'\n}\n\njava {\n    sourceCompatibility = '21'\n}\n\nconfigurations {\n    compileOnly {\n        extendsFrom annotationProcessor\n    }\n}\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    implementation 'org.springframework.boot:spring-boot-starter-batch'\n    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'\n    implementation 'org.springframework.boot:spring-boot-starter-security'\n    implementation 'org.springframework.boot:spring-boot-starter-validation'\n    implementation 'org.springframework.boot:spring-boot-starter-web'\n    implementation 'org.springframework.session:spring-session-jdbc'\n\n    implementation 'org.flywaydb:flyway-core'\n    implementation 'org.modelmapper:modelmapper:3.2.0'\n    implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.2.0'\n\n    compileOnly 'org.projectlombok:lombok'\n    developmentOnly 'org.springframework.boot:spring-boot-devtools'\n    // developmentOnly 'org.springframework.boot:spring-boot-docker-compose'\n    runtimeOnly 'org.postgresql:postgresql'\n    annotationProcessor 'org.springframework.boot:spring-boot-configuration-processor'\n    annotationProcessor 'org.projectlombok:lombok'\n    testImplementation 'org.springframework.boot:spring-boot-starter-test'\n    testImplementation 'org.springframework.batch:spring-batch-test'\n    testImplementation 'org.springframework.security:spring-security-test'\n}\n</code></pre>\n<p>There is a controller for this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@RestController\npublic class UserController {\n\n    @Operation(summary = &quot;Get user profile&quot;)\n    @PreAuthorize(&quot;hasRole('USER')&quot;)\n    @GetMapping(path = &quot;/profile&quot;, produces = MediaType.APPLICATION_JSON_VALUE)\n    public ResponseEntity&lt;UserDTO&gt; profile(@AuthenticationPrincipal User user) {\n        System.out.println(&quot;user.getId() = &quot; + user.getId()); // always null\n        return ResponseEntity.ok(mapper.map(user, UserDTO.class));\n    }\n\n}\n</code></pre>\n<p>console output always:\n<code>user.getId() = null</code></p>\n<p>table <code>users</code>:</p>\n<p><a href=\"https://i.stack.imgur.com/Ko3Ar.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ko3Ar.png\" alt=\"table users\" /></a></p>\n<p><code>User</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Entity(name = &quot;user&quot;)\n@Table(name = &quot;users&quot;)\n@Getter\n@Setter\npublic class User extends BaseEntity&lt;Integer&gt; implements UserDetails {\n\n    @Column(name = &quot;email&quot;, nullable = false, unique = true)\n    private String email;\n\n    @Column(name = &quot;password&quot;, nullable = false)\n    private String password;\n\n    @Column(name = &quot;name&quot;, nullable = false)\n    private String name;\n\n    @Column(name = &quot;phone&quot;)\n    private String phone;\n\n    @Column(name = &quot;enabled&quot;, nullable = false)\n    private boolean enabled;\n\n    @ManyToMany(fetch = FetchType.EAGER)\n    @JoinTable(\n            name = &quot;users_roles&quot;,\n            joinColumns = @JoinColumn(name = &quot;user_id&quot;, referencedColumnName = &quot;id&quot;),\n            inverseJoinColumns = @JoinColumn(name = &quot;role_id&quot;, referencedColumnName = &quot;id&quot;)\n    )\n    private Collection&lt;Role&gt; roles;\n\n    @Override\n    public String getUsername() {\n        return this.email;\n    }\n\n    @Override\n    public Collection&lt;Role&gt; getAuthorities() {\n        return this.roles;\n    }\n\n    @Override\n    public boolean isAccountNonExpired() {\n        return true;\n    }\n\n    @Override\n    public boolean isAccountNonLocked() {\n        return true;\n    }\n\n    @Override\n    public boolean isCredentialsNonExpired() {\n        return true;\n    }\n\n}\n</code></pre>\n<p><code>BaseEntity</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Getter\n@Setter\n@MappedSuperclass\npublic abstract class BaseEntity&lt;ID extends Serializable&gt; {\n\n    @Id\n    @Column(name = &quot;id&quot;)\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Access(AccessType.PROPERTY)\n    private ID id;\n\n    // generated equals and hashCode with JPA Buddy ommited\n\n}\n</code></pre>\n<p>I tried to get rid of <code>@MappedSuperclass</code>, removed inheritance from BaseEntity and created an id field by analogy from BaseEntity and everything worked as it should.\nWhat could be the problem when using <code>@MappedSuperclass</code>?</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1700050759,"post_id":77487599,"comment_id":136606728,"body_markdown":"Better: `if(!dir.mkdir()) return;` Display a toast too to inform the user. And mkdirs() does not throw. It returns true or false.","body":"Better: <code>if(!dir.mkdir()) return;</code> Display a toast too to inform the user. And mkdirs() does not throw. It returns true or false."}],"answers":[{"comments":[{"owner":{"account_id":416909,"reputation":5244,"user_id":792589,"accept_rate":72,"display_name":"aarelovich"},"score":0,"creation_date":1700050937,"post_id":77487630,"comment_id":136606754,"body_markdown":"Ok. Two questions is there a way to get the default Path for say, Documents? And question two hwo can I find out the android version so that I know where I need to create the file or look for it? Because I need it to keep it compatible with previous versions that already had the file in that location","body":"Ok. Two questions is there a way to get the default Path for say, Documents? And question two hwo can I find out the android version so that I know where I need to create the file or look for it? Because I need it to keep it compatible with previous versions that already had the file in that location"},{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1700051376,"post_id":77487630,"comment_id":136606811,"body_markdown":"File dir = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOCUMENTS), &quot;this_is_a_test&quot;);","body":"File dir = Environment.getExternalStoragePublicDirectory(Environment.DI&zwnj;&#8203;RECTORY_DOCUMENTS), &quot;this_is_a_test&quot;);"},{"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"score":0,"creation_date":1700051441,"post_id":77487630,"comment_id":136606823,"body_markdown":"Build.VERSION.SDK_INT.","body":"Build.VERSION.SDK_INT."}],"tags":[],"owner":{"account_id":16768304,"reputation":8503,"user_id":12121419,"display_name":"blackapps"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700050602,"creation_date":1700050602,"answer_id":77487630,"question_id":77487599,"body_markdown":"You cannot create files and directories in root of external storage for Android 11+ devices.\r\n\r\nInstead use one of the public directories that are already there.\r\n\r\nLike DCIM, Pictures, Documents,...","title":"Unable to create a directory or file for my app even though the permissions are there","body":"<p>You cannot create files and directories in root of external storage for Android 11+ devices.</p>\n<p>Instead use one of the public directories that are already there.</p>\n<p>Like DCIM, Pictures, Documents,...</p>\n"}],"owner":{"account_id":416909,"reputation":5244,"user_id":792589,"accept_rate":72,"display_name":"aarelovich"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":21,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1700050602,"creation_date":1700050309,"question_id":77487599,"body_markdown":"I have an App that I made years ago. Recently I just recompiled it with a very few changes just so that I could change the target SDK and still be listed in the play store.\r\n\r\nAs it turns out this fundamentally broke the app in certain phones including my own.I tested it on another phone before I uploaded it and it worked fine (Android Version 8.1.0). My phone has Android 11 (where it doesn&#39;t work). \r\n\r\nThe problem seems to be in the ability to create and read files in the internal storage and whole point of the app is to maintain a single file. \r\n\r\nHere is a function that I made that attemps to create a directory. This is just a test function that I call on creation, it wasn&#39;t part of the original app:\r\n\r\n     public static void AttemptDirCreate(){\r\n        String dirname = Environment.getExternalStorageDirectory().toString() + &quot;/this_is_a_test&quot;;\r\n        File dir = new File(dirname);\r\n\r\n        System.err.println(&quot;Attempting to create directory: &#39;&quot; + dirname + &quot;&#39;&quot;);\r\n\r\n        boolean make_result = false;\r\n        if (!dir.exists()) {\r\n            try {\r\n                make_result = dir.mkdir();\r\n            }\r\n            catch (SecurityException se) {\r\n                System.err.println(&quot;ERROR. Could not make dir. Reason: &quot; + se.getMessage());\r\n            }\r\n        }\r\n\r\n        if (make_result){\r\n            System.err.println(&quot;MKDir result is true&quot;);\r\n        }\r\n        else {\r\n            System.err.println(&quot;MKDir result is false&quot;);\r\n        }\r\n\r\n        if (dir.exists()){\r\n            System.err.println(&quot;Dir has been created&quot;);\r\n        }\r\n        else {\r\n            System.err.println(&quot;Was unable to create dir&quot;);\r\n        }\r\n\r\n    }\r\n\r\nThe problem is that directory is not created and NO exception is thrown. When I go into app info I see the permissions for Files and Media.\r\n\r\nThe path where the directory is being tried to be created is: &#39;/storage/emulated/0/this_is_a_test&#39; \r\n\r\nWhich as far as I cant tell is the correct path. The app did ask me for permissions when first installed.\r\n\r\nSo why can&#39;t it create the directory? How can I find out the issue and fix it?\r\n\r\nJust to clarify, this exact same function WORKS on Android 8.1.0, but it does nto work on Android 11. Not sure, what the cutoff point is. \r\n","title":"Unable to create a directory or file for my app even though the permissions are there","body":"<p>I have an App that I made years ago. Recently I just recompiled it with a very few changes just so that I could change the target SDK and still be listed in the play store.</p>\n<p>As it turns out this fundamentally broke the app in certain phones including my own.I tested it on another phone before I uploaded it and it worked fine (Android Version 8.1.0). My phone has Android 11 (where it doesn't work).</p>\n<p>The problem seems to be in the ability to create and read files in the internal storage and whole point of the app is to maintain a single file.</p>\n<p>Here is a function that I made that attemps to create a directory. This is just a test function that I call on creation, it wasn't part of the original app:</p>\n<pre><code> public static void AttemptDirCreate(){\n    String dirname = Environment.getExternalStorageDirectory().toString() + &quot;/this_is_a_test&quot;;\n    File dir = new File(dirname);\n\n    System.err.println(&quot;Attempting to create directory: '&quot; + dirname + &quot;'&quot;);\n\n    boolean make_result = false;\n    if (!dir.exists()) {\n        try {\n            make_result = dir.mkdir();\n        }\n        catch (SecurityException se) {\n            System.err.println(&quot;ERROR. Could not make dir. Reason: &quot; + se.getMessage());\n        }\n    }\n\n    if (make_result){\n        System.err.println(&quot;MKDir result is true&quot;);\n    }\n    else {\n        System.err.println(&quot;MKDir result is false&quot;);\n    }\n\n    if (dir.exists()){\n        System.err.println(&quot;Dir has been created&quot;);\n    }\n    else {\n        System.err.println(&quot;Was unable to create dir&quot;);\n    }\n\n}\n</code></pre>\n<p>The problem is that directory is not created and NO exception is thrown. When I go into app info I see the permissions for Files and Media.</p>\n<p>The path where the directory is being tried to be created is: '/storage/emulated/0/this_is_a_test'</p>\n<p>Which as far as I cant tell is the correct path. The app did ask me for permissions when first installed.</p>\n<p>So why can't it create the directory? How can I find out the issue and fix it?</p>\n<p>Just to clarify, this exact same function WORKS on Android 8.1.0, but it does nto work on Android 11. Not sure, what the cutoff point is.</p>\n"},{"tags":["java","collections"],"comments":[{"owner":{"account_id":221272,"reputation":6281,"user_id":479156,"accept_rate":92,"display_name":"Ivar"},"score":1,"creation_date":1700046882,"post_id":77487187,"comment_id":136606051,"body_markdown":"If you check the `node(int)` implementation in that same class you have your answer. It will start at either the first node, or last node (depending on if the index you&#39;re looking for is closer to the start or to the end) and then it loops until it finds the index you are requesting.","body":"If you check the <code>node(int)</code> implementation in that same class you have your answer. It will start at either the first node, or last node (depending on if the index you&#39;re looking for is closer to the start or to the end) and then it loops until it finds the index you are requesting."},{"owner":{"account_id":13758071,"reputation":61,"user_id":9928438,"display_name":"Er Rahul Raj"},"score":0,"creation_date":1700047078,"post_id":77487187,"comment_id":136606082,"body_markdown":"Does that means, Linked List internally uses Array concept ?","body":"Does that means, Linked List internally uses Array concept ?"},{"owner":{"account_id":221272,"reputation":6281,"user_id":479156,"accept_rate":92,"display_name":"Ivar"},"score":3,"creation_date":1700047172,"post_id":77487187,"comment_id":136606100,"body_markdown":"No, it does not.","body":"No, it does not."}],"answers":[{"comments":[{"owner":{"account_id":13758071,"reputation":61,"user_id":9928438,"display_name":"Er Rahul Raj"},"score":0,"creation_date":1700047468,"post_id":77487270,"comment_id":136606163,"body_markdown":"Thank you very much  Georgii Lvov!! It really helped me understanding internal mechanism -","body":"Thank you very much  Georgii Lvov!! It really helped me understanding internal mechanism -"}],"tags":[],"owner":{"account_id":18586978,"reputation":2220,"user_id":15000097,"display_name":"Georgii Lvov"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1700047067,"creation_date":1700047067,"answer_id":77487270,"question_id":77487187,"body_markdown":"This index is not like the array index in `ArrayList`\r\n.\r\nIn a `LinkedList`, the get by index method under the hood is just a **for loop**, and since the list is ordered, it will simply return the element you need by looping through elements of the list.\r\n\r\nLook inside `LinkedList` for the `Node&lt;E&gt; node(int index)` method, which is called in the `get(int index)` method.","title":"Accessing Element In linkedList","body":"<p>This index is not like the array index in <code>ArrayList</code>\n.\nIn a <code>LinkedList</code>, the get by index method under the hood is just a <strong>for loop</strong>, and since the list is ordered, it will simply return the element you need by looping through elements of the list.</p>\n<p>Look inside <code>LinkedList</code> for the <code>Node&lt;E&gt; node(int index)</code> method, which is called in the <code>get(int index)</code> method.</p>\n"}],"owner":{"account_id":13758071,"reputation":61,"user_id":9928438,"display_name":"Er Rahul Raj"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":162,"favorite_count":0,"down_vote_count":2,"up_vote_count":1,"closed_date":1700050484,"accepted_answer_id":77487270,"answer_count":1,"score":-1,"last_activity_date":1700050556,"creation_date":1700046203,"question_id":77487187,"body_markdown":"    LinkedList&lt;String&gt; linkedList = new LinkedList&lt;&gt;();\r\n\r\n    linkedList.add(&quot;Java&quot;);\r\n    linkedList.add(&quot;Python&quot;);\r\n    linkedList.get(1); \r\n\r\nInternal code flows for get\r\n\r\n    public E get(int index) {\r\n        checkElementIndex(index);\r\n        return node(index).item;\r\n    }\r\n\r\n    private void checkElementIndex(int index) {\r\n         if (!isElementIndex(index))\r\n         throw new IndexOutOfBoundsException(outOfBoundsMsg(index));\r\n    }\r\n\r\nI am calling, linkedList.get(1); to get the second element in an linked list. My question is, uf LinkedList internally created nodes for each element, then how does an indexing concept come into consideration for accessing the element (`linkedList.get(1)`)?","title":"Accessing Element In linkedList","body":"<pre><code>LinkedList&lt;String&gt; linkedList = new LinkedList&lt;&gt;();\n\nlinkedList.add(&quot;Java&quot;);\nlinkedList.add(&quot;Python&quot;);\nlinkedList.get(1); \n</code></pre>\n<p>Internal code flows for get</p>\n<pre><code>public E get(int index) {\n    checkElementIndex(index);\n    return node(index).item;\n}\n\nprivate void checkElementIndex(int index) {\n     if (!isElementIndex(index))\n     throw new IndexOutOfBoundsException(outOfBoundsMsg(index));\n}\n</code></pre>\n<p>I am calling, linkedList.get(1); to get the second element in an linked list. My question is, uf LinkedList internally created nodes for each element, then how does an indexing concept come into consideration for accessing the element (<code>linkedList.get(1)</code>)?</p>\n"},{"tags":["java","spring","spring-boot","testing","spring-data-jpa"],"comments":[{"owner":{"account_id":3116234,"reputation":9296,"user_id":2636929,"display_name":"Stultuske"},"score":2,"creation_date":1668597406,"post_id":74459521,"comment_id":131442675,"body_markdown":"do you understand what mocking is? It seems that&#39;s where your confusion starts","body":"do you understand what mocking is? It seems that&#39;s where your confusion starts"},{"owner":{"account_id":23310329,"reputation":41,"user_id":17389688,"display_name":"leo___"},"score":0,"creation_date":1668597511,"post_id":74459521,"comment_id":131442709,"body_markdown":"you mock something when is needed for a complex object and has already been tested like a repository","body":"you mock something when is needed for a complex object and has already been tested like a repository"},{"owner":{"account_id":3116234,"reputation":9296,"user_id":2636929,"display_name":"Stultuske"},"score":0,"creation_date":1668597559,"post_id":74459521,"comment_id":131442728,"body_markdown":"yes, but do you actually understand what mocking is? Not when to apply it.","body":"yes, but do you actually understand what mocking is? Not when to apply it."},{"owner":{"account_id":23310329,"reputation":41,"user_id":17389688,"display_name":"leo___"},"score":0,"creation_date":1668597825,"post_id":74459521,"comment_id":131442810,"body_markdown":"simulated object that simulate the behavior of an object (i think) but are not the real one","body":"simulated object that simulate the behavior of an object (i think) but are not the real one"},{"owner":{"account_id":3116234,"reputation":9296,"user_id":2636929,"display_name":"Stultuske"},"score":1,"creation_date":1668599558,"post_id":74459521,"comment_id":131443370,"body_markdown":"indeed, keyword: simulated; You don&#39;t write (save) to the db, you merely simulate. so: it&#39;s quite normal that nothing is saved. You should not call your repository from within your test, you just need to tell your mock how to behave when it is called within your service","body":"indeed, keyword: simulated; You don&#39;t write (save) to the db, you merely simulate. so: it&#39;s quite normal that nothing is saved. You should not call your repository from within your test, you just need to tell your mock how to behave when it is called within your service"}],"answers":[{"tags":[],"owner":{"account_id":26555431,"reputation":558,"user_id":20184128,"display_name":"berse2212"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1700050469,"creation_date":1668600077,"answer_id":74460108,"question_id":74459521,"body_markdown":"A mock is just a mock. It&#39;s never actually doing something. It just can behave like a real thing, but you have to tell the mock how to do it.\r\n\r\nSo if you mock the UserRepository and try to save something nothing will happen. Because again, a mock never actually does something. The advantage of this is that you don&#39;t actually need the whole infrastructure to unit test a tiny method. Additionally the test gets independent of data. What you can do now is return some data if some method is called.\r\n\r\nIn your case, you don&#39;t need a whole database to test the functionality of the UserService. Thus mocking the repository is a good option. Now since it&#39;s a mock you have to tell the mock how to behave for your test case:\r\n\r\n    @Test\r\n    void itShouldLoadUsernameByName() {\r\n        AppUser appUser = new AppUser(\r\n                ApplicationRole.USER,\r\n                &quot;leonardo&quot;,\r\n                &quot;rossi&quot;,\r\n                &quot;leo__&quot;,\r\n                &quot;a@gmail.com&quot;,\r\n                &quot;password&quot;\r\n        );\r\n\r\n\t\twhen(standortRepository.searchByUserName(any())).thenReturn(appUser);\r\n    \r\n        userService.loadUserByUsername(appUser.getUsername());\r\n\r\n        //More expectations ...\r\n\r\n        verify(repository).searchByUserName(appUser.getUsername());    \r\n    }\r\n\r\nNow what I have done is to tell the mock it should return the appUser, when the Method `searchByUserName` is called.\r\n\r\nP.s. these are the static imports I used:\r\n\r\n    import static org.mockito.ArgumentMatchers.any;\r\n    import static org.mockito.Mockito.when;","title":"Why i can&#39;t save anything in my mocked repository","body":"<p>A mock is just a mock. It's never actually doing something. It just can behave like a real thing, but you have to tell the mock how to do it.</p>\n<p>So if you mock the UserRepository and try to save something nothing will happen. Because again, a mock never actually does something. The advantage of this is that you don't actually need the whole infrastructure to unit test a tiny method. Additionally the test gets independent of data. What you can do now is return some data if some method is called.</p>\n<p>In your case, you don't need a whole database to test the functionality of the UserService. Thus mocking the repository is a good option. Now since it's a mock you have to tell the mock how to behave for your test case:</p>\n<pre><code>@Test\nvoid itShouldLoadUsernameByName() {\n    AppUser appUser = new AppUser(\n            ApplicationRole.USER,\n            &quot;leonardo&quot;,\n            &quot;rossi&quot;,\n            &quot;leo__&quot;,\n            &quot;a@gmail.com&quot;,\n            &quot;password&quot;\n    );\n\n    when(standortRepository.searchByUserName(any())).thenReturn(appUser);\n\n    userService.loadUserByUsername(appUser.getUsername());\n\n    //More expectations ...\n\n    verify(repository).searchByUserName(appUser.getUsername());    \n}\n</code></pre>\n<p>Now what I have done is to tell the mock it should return the appUser, when the Method <code>searchByUserName</code> is called.</p>\n<p>P.s. these are the static imports I used:</p>\n<pre><code>import static org.mockito.ArgumentMatchers.any;\nimport static org.mockito.Mockito.when;\n</code></pre>\n"}],"owner":{"account_id":23310329,"reputation":41,"user_id":17389688,"display_name":"leo___"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":238,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":74460108,"answer_count":1,"score":0,"last_activity_date":1700050469,"creation_date":1668597310,"question_id":74459521,"body_markdown":"I&#39;m learning testing in spring boot, i have this test:\r\n\r\n     @ExtendWith(MockitoExtension.class)\r\n     @SpringBootTest\r\n    class AppUserServiceTest {\r\n\r\n    @Mock\r\n    private UserRepository repository;\r\n    private UserService userService;\r\n\r\n    @BeforeEach\r\n    void setUp() {\r\n        userService = new UserService(repository);\r\n    }\r\n\r\n\r\n    @Test\r\n    void itShouldLoadUsernameByName() {\r\n        AppUser appUser = new AppUser(\r\n                ApplicationRole.USER,\r\n                &quot;leonardo&quot;,\r\n                &quot;rossi&quot;,\r\n                &quot;leo__&quot;,\r\n                &quot;a@gmail.com&quot;,\r\n                &quot;password&quot;\r\n        );\r\n\r\n        repository.save(appUser);\r\n\r\n        userService.loadUserByUsername(appUser.getUsername());\r\n        verify(repository).searchByUserName(appUser.getUsername());\r\n\r\n    }\r\n\r\n    }\r\n\r\nit keep throwing me an exception because it doesn&#39;t find any user in the database, in fact even if i save the user the repository.findAll() return 0 element.\r\n\r\nThis is my User service that i&#39;m trying to test:\r\n\r\n    @AllArgsConstructor\r\n    @Service\r\n    public class UserService\r\n        implements UserDetailsService {\r\n\r\n    private final UserRepository repository;\r\n\r\n    @Override\r\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\r\n        return repository.searchByUserName(username)\r\n                .orElseThrow(\r\n                        ()-&gt; new UsernameNotFoundException(&quot;The username &quot; + username + &quot; has not been found&quot;)\r\n                );\r\n    }\r\n\r\nThis is my H2 databse for testing configuration:\r\n\r\n    spring.datasource.url=jdbc:h2:mem:testdb\r\n    spring.datasource.driverClassName=org.h2.Driver\r\n    spring.datasource.username=sa\r\n    spring.datasource.password=password\r\n    spring.jpa.database-platform=org.hibernate.dialect.H2Dialect\r\n\r\n","title":"Why i can&#39;t save anything in my mocked repository","body":"<p>I'm learning testing in spring boot, i have this test:</p>\n<pre><code> @ExtendWith(MockitoExtension.class)\n @SpringBootTest\nclass AppUserServiceTest {\n\n@Mock\nprivate UserRepository repository;\nprivate UserService userService;\n\n@BeforeEach\nvoid setUp() {\n    userService = new UserService(repository);\n}\n\n\n@Test\nvoid itShouldLoadUsernameByName() {\n    AppUser appUser = new AppUser(\n            ApplicationRole.USER,\n            &quot;leonardo&quot;,\n            &quot;rossi&quot;,\n            &quot;leo__&quot;,\n            &quot;a@gmail.com&quot;,\n            &quot;password&quot;\n    );\n\n    repository.save(appUser);\n\n    userService.loadUserByUsername(appUser.getUsername());\n    verify(repository).searchByUserName(appUser.getUsername());\n\n}\n\n}\n</code></pre>\n<p>it keep throwing me an exception because it doesn't find any user in the database, in fact even if i save the user the repository.findAll() return 0 element.</p>\n<p>This is my User service that i'm trying to test:</p>\n<pre><code>@AllArgsConstructor\n@Service\npublic class UserService\n    implements UserDetailsService {\n\nprivate final UserRepository repository;\n\n@Override\npublic UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n    return repository.searchByUserName(username)\n            .orElseThrow(\n                    ()-&gt; new UsernameNotFoundException(&quot;The username &quot; + username + &quot; has not been found&quot;)\n            );\n}\n</code></pre>\n<p>This is my H2 databse for testing configuration:</p>\n<pre><code>spring.datasource.url=jdbc:h2:mem:testdb\nspring.datasource.driverClassName=org.h2.Driver\nspring.datasource.username=sa\nspring.datasource.password=password\nspring.jpa.database-platform=org.hibernate.dialect.H2Dialect\n</code></pre>\n"},{"tags":["java","javafx","scenebuilder"],"comments":[{"owner":{"account_id":2485939,"reputation":19426,"user_id":2164365,"accept_rate":40,"display_name":"Abra"},"score":0,"creation_date":1700051371,"post_id":77487394,"comment_id":136606810,"body_markdown":"Class [Polygon](https://openjfx.io/javadoc/21/javafx.graphics/javafx/scene/shape/Polygon.html) extends class `Node` which has [getProperties](https://openjfx.io/javadoc/21/javafx.graphics/javafx/scene/Node.html#getProperties()) method and [getUserData](https://openjfx.io/javadoc/21/javafx.graphics/javafx/scene/Node.html#setUserData(java.lang.Object)) method, both of which can be used for storing extra information. Perhaps you can utilize those methods rather than having to extend class `Polygon`?","body":"Class <a href=\"https://openjfx.io/javadoc/21/javafx.graphics/javafx/scene/shape/Polygon.html\" rel=\"nofollow noreferrer\">Polygon</a> extends class <code>Node</code> which has <a href=\"https://openjfx.io/javadoc/21/javafx.graphics/javafx/scene/Node.html#getProperties()\" rel=\"nofollow noreferrer\">getProperties</a> method and <a href=\"https://openjfx.io/javadoc/21/javafx.graphics/javafx/scene/Node.html#setUserData(java.lang.Object)\" rel=\"nofollow noreferrer\">getUserData</a> method, both of which can be used for storing extra information. Perhaps you can utilize those methods rather than having to extend class <code>Polygon</code>?"}],"answers":[{"tags":[],"owner":{"account_id":21741636,"reputation":1162,"user_id":16048914,"display_name":"David Weber"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1700050460,"creation_date":1700050460,"answer_id":77487617,"question_id":77487394,"body_markdown":"Looks Like you want to create a custom component for the SceneBuilder.\r\n\r\nStep 1: Create the custom vomponent\r\nhttps://docs.oracle.com/javafx/2/fxml_get_started/custom_control.htm\r\n\r\nStep 2: Import the custom component into SceneBuilder\r\nhttps://www.google.com/amp/s/staticfinal.blog/2014/05/21/adding-custom-javafx-components-to-scene-builder-2-0/amp/\r\n\r\n**Alternative solution:**\r\n\r\nYou could create a custom component in plain Java and add it to the fxml scene programatically in your controller.\r\n","title":"Is there a way to add Subclasses from a certain JavaFX Class in Scenebuilder/FXML?","body":"<p>Looks Like you want to create a custom component for the SceneBuilder.</p>\n<p>Step 1: Create the custom vomponent\n<a href=\"https://docs.oracle.com/javafx/2/fxml_get_started/custom_control.htm\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javafx/2/fxml_get_started/custom_control.htm</a></p>\n<p>Step 2: Import the custom component into SceneBuilder\n<a href=\"https://www.google.com/amp/s/staticfinal.blog/2014/05/21/adding-custom-javafx-components-to-scene-builder-2-0/amp/\" rel=\"nofollow noreferrer\">https://www.google.com/amp/s/staticfinal.blog/2014/05/21/adding-custom-javafx-components-to-scene-builder-2-0/amp/</a></p>\n<p><strong>Alternative solution:</strong></p>\n<p>You could create a custom component in plain Java and add it to the fxml scene programatically in your controller.</p>\n"}],"owner":{"account_id":25843762,"reputation":1,"user_id":19578941,"display_name":"Marco R."},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":46,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1700050999,"accepted_answer_id":77487617,"answer_count":1,"score":0,"last_activity_date":1700050460,"creation_date":1700048286,"question_id":77487394,"body_markdown":"Following Background: For our project we need to implement the famous german boardgame &quot;Settlers of Catan&quot; with Java and JavaFX. The board consists of 19 hexagonal tiles. To spare some complicated calculations for the nodes (City Spots) and edges (Streets) of the hexagon I wanted to create the board in Scenebuilder as fixed FXML.\r\nFor the hexagons I use JavaFX-Polygons. But the problem is, that I need much more information in the Polygon-Class (e.g. ressource type, nodes, edges).\r\n\r\nIs there a way to create a subclass (Tile extends Polygon) and use this class in Scenebuilder or FXML?\r\n\r\nAlso I tried to cast the Polygons as Tiles, but didnt work either.\r\n\r\nI can provide some code later, if necessary.\r\n\r\nThanks in advance!\r\n\r\n\r\nI tried importing my class in the beginning of the FXML.\r\n\r\n`&lt;?import package.Tile?`\r\n\r\nBut it wasnt that simple, sadly.","title":"Is there a way to add Subclasses from a certain JavaFX Class in Scenebuilder/FXML?","body":"<p>Following Background: For our project we need to implement the famous german boardgame &quot;Settlers of Catan&quot; with Java and JavaFX. The board consists of 19 hexagonal tiles. To spare some complicated calculations for the nodes (City Spots) and edges (Streets) of the hexagon I wanted to create the board in Scenebuilder as fixed FXML.\nFor the hexagons I use JavaFX-Polygons. But the problem is, that I need much more information in the Polygon-Class (e.g. ressource type, nodes, edges).</p>\n<p>Is there a way to create a subclass (Tile extends Polygon) and use this class in Scenebuilder or FXML?</p>\n<p>Also I tried to cast the Polygons as Tiles, but didnt work either.</p>\n<p>I can provide some code later, if necessary.</p>\n<p>Thanks in advance!</p>\n<p>I tried importing my class in the beginning of the FXML.</p>\n<p><code>&lt;?import package.Tile?</code></p>\n<p>But it wasnt that simple, sadly.</p>\n"},{"tags":["java","scala","hibernate","validation","hibernate-validator"],"comments":[{"owner":{"account_id":6366204,"reputation":2197,"user_id":4940126,"display_name":"mark_o"},"score":0,"creation_date":1516355120,"post_id":48334644,"comment_id":83661362,"body_markdown":"I&#39;m not really a Scala person but by looking at the error that you;ve provided and checking the Scala doc - http://www.scala-lang.org/api/2.9.3/scala/collection/mutable/HashMap.html the problem is that you are trying to place an annotation on a scala type, for which there&#39;s no validator implemented, as it&#39;s a scala collection. Here&#39;s also an answer that you might find helpful - https://stackoverflow.com/a/24291593/4940126\nSo I think if you&#39;d like to use BeanValidation for your scala types you will need to implement validators for those types.","body":"I&#39;m not really a Scala person but by looking at the error that you;ve provided and checking the Scala doc - <a href=\"http://www.scala-lang.org/api/2.9.3/scala/collection/mutable/HashMap.html\" rel=\"nofollow noreferrer\">scala-lang.org/api/2.9.3/scala/collection/mutable/HashMap.ht&zwnj;&#8203;ml</a> the problem is that you are trying to place an annotation on a scala type, for which there&#39;s no validator implemented, as it&#39;s a scala collection. Here&#39;s also an answer that you might find helpful - <a href=\"https://stackoverflow.com/a/24291593/4940126\">stackoverflow.com/a/24291593/4940126</a> So I think if you&#39;d like to use BeanValidation for your scala types you will need to implement validators for those types."},{"owner":{"account_id":5111197,"reputation":882,"user_id":4097712,"accept_rate":57,"display_name":"Tonny Tc"},"score":0,"creation_date":1516373467,"post_id":48334644,"comment_id":83672914,"body_markdown":"Yes, the problem is just as what you said, Scala does not support JSR303. Those links are all some time ago, so I just want to get some new info. about the case to see whether there&#39;s any changes in Scala.","body":"Yes, the problem is just as what you said, Scala does not support JSR303. Those links are all some time ago, so I just want to get some new info. about the case to see whether there&#39;s any changes in Scala."}],"answers":[{"comments":[{"owner":{"account_id":5111197,"reputation":882,"user_id":4097712,"accept_rate":57,"display_name":"Tonny Tc"},"score":0,"creation_date":1516341775,"post_id":48334779,"comment_id":83655024,"body_markdown":"Thanks a lot for your reply, but what I concerned is not how to check a map collection is empty or not. I just ask about how to use JSR 303 in Scala. There&#39;re some related question like  [this](https://stackoverflow.com/questions/24284592/does-scala-suport-jsr-303-validation)  and [this](http://www.scala-lang.org/old/node/3251), and further more, there&#39;s a [bean-validation-scala](https://github.com/bean-validation-scala/bean-validation-scala). But all of them seems past a period time, and so, I want to know whether there&#39;s new update for using JSR 303 in Scala.","body":"Thanks a lot for your reply, but what I concerned is not how to check a map collection is empty or not. I just ask about how to use JSR 303 in Scala. There&#39;re some related question like  <a href=\"https://stackoverflow.com/questions/24284592/does-scala-suport-jsr-303-validation\">this</a>  and <a href=\"http://www.scala-lang.org/old/node/3251\" rel=\"nofollow noreferrer\">this</a>, and further more, there&#39;s a <a href=\"https://github.com/bean-validation-scala/bean-validation-scala\" rel=\"nofollow noreferrer\">bean-validation-scala</a>. But all of them seems past a period time, and so, I want to know whether there&#39;s new update for using JSR 303 in Scala."},{"owner":{"account_id":12471572,"reputation":638,"user_id":9134510,"display_name":"Alex Cuadr&#243;n"},"score":0,"creation_date":1516342500,"post_id":48334779,"comment_id":83655299,"body_markdown":"@TonnyTc check it out now. If it&#39;s not the answer you were looking for just let me know and I&#39;ll work out other way. :D","body":"@TonnyTc check it out now. If it&#39;s not the answer you were looking for just let me know and I&#39;ll work out other way. :D"},{"owner":{"account_id":5111197,"reputation":882,"user_id":4097712,"accept_rate":57,"display_name":"Tonny Tc"},"score":0,"creation_date":1516342972,"post_id":48334779,"comment_id":83655475,"body_markdown":"Actually,  `@NotNull` works fine, but `@NotEmpty` means both `@NotNull` and `@Size(min=1)`. The exception indicates that the `@Size` cannot validate the Scala&#39;s Map. Meanwhile, for Java&#39;s Map, everything works because JSR 303 is a Java specification ...","body":"Actually,  <code>@NotNull</code> works fine, but <code>@NotEmpty</code> means both <code>@NotNull</code> and <code>@Size(min=1)</code>. The exception indicates that the <code>@Size</code> cannot validate the Scala&#39;s Map. Meanwhile, for Java&#39;s Map, everything works because JSR 303 is a Java specification ..."},{"owner":{"account_id":5111197,"reputation":882,"user_id":4097712,"accept_rate":57,"display_name":"Tonny Tc"},"score":0,"creation_date":1516343469,"post_id":48334779,"comment_id":83655692,"body_markdown":"It also makes the same exception. And I don&#39;t think the exception is just about the validation&#39;s result (whether the map is empty or not), but there&#39;s something wrong about the validator itself.","body":"It also makes the same exception. And I don&#39;t think the exception is just about the validation&#39;s result (whether the map is empty or not), but there&#39;s something wrong about the validator itself."},{"owner":{"account_id":12471572,"reputation":638,"user_id":9134510,"display_name":"Alex Cuadr&#243;n"},"score":0,"creation_date":1516343996,"post_id":48334779,"comment_id":83655910,"body_markdown":"@TonnyTc `@NotNull` checks that the object is &quot;pointing&quot; to a reference in memory while `@NotEmpty` checks if it contains at least one value added. So the exception is being fired due to the lack of `@Size(min value,max value)` try adding it and let me know if it&#39;d worked","body":"@TonnyTc <code>@NotNull</code> checks that the object is &quot;pointing&quot; to a reference in memory while <code>@NotEmpty</code> checks if it contains at least one value added. So the exception is being fired due to the lack of <code>@Size(min value,max value)</code> try adding it and let me know if it&#39;d worked"},{"owner":{"account_id":5111197,"reputation":882,"user_id":4097712,"accept_rate":57,"display_name":"Tonny Tc"},"score":0,"creation_date":1516345007,"post_id":48334779,"comment_id":83656312,"body_markdown":"As I&#39;ve said, `@NotEmpty` means both `@NotNull` and `@Size(min=1)`, why should I add `@Size` again? And the same exception occurs when I change `@NotEmpty` to `@Size(min = 1)`.","body":"As I&#39;ve said, <code>@NotEmpty</code> means both <code>@NotNull</code> and <code>@Size(min=1)</code>, why should I add <code>@Size</code> again? And the same exception occurs when I change <code>@NotEmpty</code> to <code>@Size(min = 1)</code>."},{"owner":{"account_id":12471572,"reputation":638,"user_id":9134510,"display_name":"Alex Cuadr&#243;n"},"score":0,"creation_date":1516345166,"post_id":48334779,"comment_id":83656379,"body_markdown":"@TonnyTc I&#39;m afraid I have no clue why is that happening sorry :(. If it works with NotNull could you use it? Or you need to check for the Size compulsory?","body":"@TonnyTc I&#39;m afraid I have no clue why is that happening sorry :(. If it works with NotNull could you use it? Or you need to check for the Size compulsory?"},{"owner":{"account_id":5111197,"reputation":882,"user_id":4097712,"accept_rate":57,"display_name":"Tonny Tc"},"score":0,"creation_date":1516345464,"post_id":48334779,"comment_id":83656496,"body_markdown":"Let us [continue this discussion in chat](http://chat.stackoverflow.com/rooms/163459/discussion-between-tonny-tc-and-alex-cuadron).","body":"Let us <a href=\"http://chat.stackoverflow.com/rooms/163459/discussion-between-tonny-tc-and-alex-cuadron\">continue this discussion in chat</a>."}],"tags":[],"owner":{"account_id":12471572,"reputation":638,"user_id":9134510,"display_name":"Alex Cuadr&#243;n"},"comment_count":8,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1516342425,"creation_date":1516340464,"answer_id":48334779,"question_id":48334644,"body_markdown":"If you want to check if a map collection is empty or not you could do this: `if(mapVariable.isEmpty() || mapVariable == null){...}`\r\n\r\nOr write `traversable shouldBe empty` or `javaMap should not be empty` as stated in the second link (link to the API). Check out [this][1] or [this][2] for further information.\r\n\r\n**EDIT**\r\n\r\nTry to add&#160;@Valid&#160;to the collection.\r\n\r\nHere is&#160;an example&#160;from the [Hibernate Validator Reference][3].\r\n\r\n    public class Car { \r\n    @NotNull \r\n    @Valid \r\n    private List&lt;Person&gt; passengers = new ArrayList&lt;Person&gt;(); \r\n    }\r\n\r\nThis is standard JSR-303 behavior. See Section 3.1.3 of the&#160;[spec][4].\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/12721076/best-practice-to-validate-null-and-empty-collection-in-java\r\n  [2]: http://www.scalatest.org/user_guide/using_matchers\r\n  [3]: http://docs.jboss.org/hibernate/validator/4.2/reference/en-US/html_single/#d0e496\r\n  [4]: http://download.oracle.com/otndocs/jcp/bean_validation-1.0-fr-oth-JSpec/","title":"Throw javax.validation.UnexpectedTypeException: HV000030 exception when validating Scala&#39;s Map with @NotEmpty","body":"<p>If you want to check if a map collection is empty or not you could do this: <code>if(mapVariable.isEmpty() || mapVariable == null){...}</code></p>\n\n<p>Or write <code>traversable shouldBe empty</code> or <code>javaMap should not be empty</code> as stated in the second link (link to the API). Check out <a href=\"https://stackoverflow.com/questions/12721076/best-practice-to-validate-null-and-empty-collection-in-java\">this</a> or <a href=\"http://www.scalatest.org/user_guide/using_matchers\" rel=\"nofollow noreferrer\">this</a> for further information.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Try to add @Valid to the collection.</p>\n\n<p>Here is an example from the <a href=\"http://docs.jboss.org/hibernate/validator/4.2/reference/en-US/html_single/#d0e496\" rel=\"nofollow noreferrer\">Hibernate Validator Reference</a>.</p>\n\n<pre><code>public class Car { \n@NotNull \n@Valid \nprivate List&lt;Person&gt; passengers = new ArrayList&lt;Person&gt;(); \n}\n</code></pre>\n\n<p>This is standard JSR-303 behavior. See Section 3.1.3 of the <a href=\"http://download.oracle.com/otndocs/jcp/bean_validation-1.0-fr-oth-JSpec/\" rel=\"nofollow noreferrer\">spec</a>.</p>\n"},{"comments":[{"owner":{"account_id":5111197,"reputation":882,"user_id":4097712,"accept_rate":57,"display_name":"Tonny Tc"},"score":0,"creation_date":1516372995,"post_id":48341215,"comment_id":83672590,"body_markdown":"Thanks a lot for your detail explanation, Guillaume. Actually, JSR303 is a Java specification, and I will not complain if it doesn&#39;t work in Scala. I&#39;ll try to post the case in Scala&#39;s forums.","body":"Thanks a lot for your detail explanation, Guillaume. Actually, JSR303 is a Java specification, and I will not complain if it doesn&#39;t work in Scala. I&#39;ll try to post the case in Scala&#39;s forums."}],"tags":[],"owner":{"account_id":6518696,"reputation":10106,"user_id":5043585,"display_name":"Guillaume Smet"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1516374490,"creation_date":1516365119,"answer_id":48341215,"question_id":48334644,"body_markdown":"So what you have to understand is that in Hibernate Validator, for a given constraint, you register constraint validators for different types.\r\n\r\nTypically, for the @Size constraint, we will register constraint validators for String, Collection, Map, arrays...\r\n\r\nThe issue you have here is that the Scala types don&#39;t implement the classical Java interfaces so we can&#39;t find a constraint validator for them. That&#39;s why you get your exception: HV recognizes the constraint but can&#39;t find a constraint validator to apply it on your Scala Map.\r\n\r\nAs far as I can see from the code, https://github.com/bean-validation-scala/bean-validation-scala would be the way to go to get BV and HV support for Scala. It delegates the validation to the original HV implementations so you should have a very similar behavior to what is done with Java.\r\n\r\nI don&#39;t think it&#39;s outdated as keep in mind that the BV/HV project didn&#39;t change too much for a while, before we started the work on BV 2.0 and HV 6.0. It might be a good idea to ping the original author regarding the BV 2.0 and HV 6.0 support (we have new constraints and so on).","title":"Throw javax.validation.UnexpectedTypeException: HV000030 exception when validating Scala&#39;s Map with @NotEmpty","body":"<p>So what you have to understand is that in Hibernate Validator, for a given constraint, you register constraint validators for different types.</p>\n\n<p>Typically, for the @Size constraint, we will register constraint validators for String, Collection, Map, arrays...</p>\n\n<p>The issue you have here is that the Scala types don't implement the classical Java interfaces so we can't find a constraint validator for them. That's why you get your exception: HV recognizes the constraint but can't find a constraint validator to apply it on your Scala Map.</p>\n\n<p>As far as I can see from the code, <a href=\"https://github.com/bean-validation-scala/bean-validation-scala\" rel=\"nofollow noreferrer\">https://github.com/bean-validation-scala/bean-validation-scala</a> would be the way to go to get BV and HV support for Scala. It delegates the validation to the original HV implementations so you should have a very similar behavior to what is done with Java.</p>\n\n<p>I don't think it's outdated as keep in mind that the BV/HV project didn't change too much for a while, before we started the work on BV 2.0 and HV 6.0. It might be a good idea to ping the original author regarding the BV 2.0 and HV 6.0 support (we have new constraints and so on).</p>\n"}],"owner":{"account_id":5111197,"reputation":882,"user_id":4097712,"accept_rate":57,"display_name":"Tonny Tc"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1064,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":48341215,"answer_count":2,"score":0,"last_activity_date":1700050103,"creation_date":1516339757,"question_id":48334644,"body_markdown":"When I tried to validate a Scala&#39;s Map, no matter mutable or immutable, I got an exception like:\r\n\r\n    javax.validation.UnexpectedTypeException: HV000030: No validator could be found for constraint &#39;javax.validation.constraints.Size&#39; validating type &#39;scala.collection.mutable.Map&lt;java.lang.String, java.lang.String&gt;&#39;. Check configuration for &#39;corporationSecrets&#39;\r\n    \tat org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.throwExceptionForNullValidator(ConstraintTree.java:229) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.getConstraintValidatorNoUnwrapping(ConstraintTree.java:310) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.getConstraintValidatorInstanceForAutomaticUnwrapping(ConstraintTree.java:244) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.getInitializedConstraintValidator(ConstraintTree.java:163) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.validateConstraints(ConstraintTree.java:116) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.validateComposingConstraints(ConstraintTree.java:398) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.validateConstraints(ConstraintTree.java:98) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.validateConstraints(ConstraintTree.java:87) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.metadata.core.MetaConstraint.validateConstraint(MetaConstraint.java:73) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.ValidatorImpl.validateMetaConstraint(ValidatorImpl.java:621) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.ValidatorImpl.validateConstraint(ValidatorImpl.java:584) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.ValidatorImpl.validateConstraintsForSingleDefaultGroupElement(ValidatorImpl.java:528) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.ValidatorImpl.validateConstraintsForDefaultGroup(ValidatorImpl.java:496) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.ValidatorImpl.validateConstraintsForCurrentGroup(ValidatorImpl.java:461) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.ValidatorImpl.validateInContext(ValidatorImpl.java:411) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.hibernate.validator.internal.engine.ValidatorImpl.validate(ValidatorImpl.java:208) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\r\n    \tat org.springframework.validation.beanvalidation.SpringValidatorAdapter.validate(SpringValidatorAdapter.java:102) ~[spring-context-4.3.13.RELEASE.jar:4.3.13.RELEASE]\r\n    \tat org.springframework.validation.DataBinder.validate(DataBinder.java:877) ~[spring-context-4.3.13.RELEASE.jar:4.3.13.RELEASE]\r\n    \tat org.springframework.boot.bind.PropertiesConfigurationFactory.doBindPropertiesToTarget(PropertiesConfigurationFactory.java:274) ~[spring-boot-1.5.9.RELEASE.jar:1.5.9.RELEASE]\r\n    \tat org.springframework.boot.bind.PropertiesConfigurationFactory.bindPropertiesToTarget(PropertiesConfigurationFactory.java:240) ~[spring-boot-1.5.9.RELEASE.jar:1.5.9.RELEASE]\r\n    \tat org.springframework.boot.context.properties.ConfigurationPropertiesBindingPostProcessor.postProcessBeforeInitialization(ConfigurationPropertiesBindingPostProcessor.java:330) ~[spring-boot-1.5.9.RELEASE.jar:1.5.9.RELEASE]\r\n    \t... 29 common frames omitted\r\n\r\n\r\nMy code is very simple, like\r\n\r\n    @NotEmpty\r\n\tval corporationSecrets : scala.collection.mutable.Map[String, String] = new scala.collection.mutable.HashMap[String, String]\r\n\r\nHow can I validate a scala&#39;s map to check whether it is empty or not?","title":"Throw javax.validation.UnexpectedTypeException: HV000030 exception when validating Scala&#39;s Map with @NotEmpty","body":"<p>When I tried to validate a Scala's Map, no matter mutable or immutable, I got an exception like:</p>\n\n<pre><code>javax.validation.UnexpectedTypeException: HV000030: No validator could be found for constraint 'javax.validation.constraints.Size' validating type 'scala.collection.mutable.Map&lt;java.lang.String, java.lang.String&gt;'. Check configuration for 'corporationSecrets'\n    at org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.throwExceptionForNullValidator(ConstraintTree.java:229) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.getConstraintValidatorNoUnwrapping(ConstraintTree.java:310) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.getConstraintValidatorInstanceForAutomaticUnwrapping(ConstraintTree.java:244) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.getInitializedConstraintValidator(ConstraintTree.java:163) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.validateConstraints(ConstraintTree.java:116) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.validateComposingConstraints(ConstraintTree.java:398) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.validateConstraints(ConstraintTree.java:98) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.validateConstraints(ConstraintTree.java:87) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.metadata.core.MetaConstraint.validateConstraint(MetaConstraint.java:73) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.ValidatorImpl.validateMetaConstraint(ValidatorImpl.java:621) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.ValidatorImpl.validateConstraint(ValidatorImpl.java:584) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.ValidatorImpl.validateConstraintsForSingleDefaultGroupElement(ValidatorImpl.java:528) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.ValidatorImpl.validateConstraintsForDefaultGroup(ValidatorImpl.java:496) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.ValidatorImpl.validateConstraintsForCurrentGroup(ValidatorImpl.java:461) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.ValidatorImpl.validateInContext(ValidatorImpl.java:411) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.hibernate.validator.internal.engine.ValidatorImpl.validate(ValidatorImpl.java:208) ~[hibernate-validator-5.3.6.Final.jar:5.3.6.Final]\n    at org.springframework.validation.beanvalidation.SpringValidatorAdapter.validate(SpringValidatorAdapter.java:102) ~[spring-context-4.3.13.RELEASE.jar:4.3.13.RELEASE]\n    at org.springframework.validation.DataBinder.validate(DataBinder.java:877) ~[spring-context-4.3.13.RELEASE.jar:4.3.13.RELEASE]\n    at org.springframework.boot.bind.PropertiesConfigurationFactory.doBindPropertiesToTarget(PropertiesConfigurationFactory.java:274) ~[spring-boot-1.5.9.RELEASE.jar:1.5.9.RELEASE]\n    at org.springframework.boot.bind.PropertiesConfigurationFactory.bindPropertiesToTarget(PropertiesConfigurationFactory.java:240) ~[spring-boot-1.5.9.RELEASE.jar:1.5.9.RELEASE]\n    at org.springframework.boot.context.properties.ConfigurationPropertiesBindingPostProcessor.postProcessBeforeInitialization(ConfigurationPropertiesBindingPostProcessor.java:330) ~[spring-boot-1.5.9.RELEASE.jar:1.5.9.RELEASE]\n    ... 29 common frames omitted\n</code></pre>\n\n<p>My code is very simple, like</p>\n\n<pre><code>@NotEmpty\nval corporationSecrets : scala.collection.mutable.Map[String, String] = new scala.collection.mutable.HashMap[String, String]\n</code></pre>\n\n<p>How can I validate a scala's map to check whether it is empty or not?</p>\n"},{"tags":["java","apache-flink","flink-streaming","fault-tolerance","apache-iceberg"],"answers":[{"comments":[{"owner":{"account_id":16236176,"reputation":41,"user_id":11723625,"display_name":"Netrunner"},"score":0,"creation_date":1688031041,"post_id":76579740,"comment_id":135020272,"body_markdown":"Yes, but how to use it in Iceberg streaming ? It works well with, e. g., Kinesis. Additionally, I need to restore processing from last snapshot even if the stream was stopped for few days.","body":"Yes, but how to use it in Iceberg streaming ? It works well with, e. g., Kinesis. Additionally, I need to restore processing from last snapshot even if the stream was stopped for few days."},{"owner":{"account_id":21886042,"reputation":1703,"user_id":16173669,"display_name":"Martijn Visser"},"score":0,"creation_date":1688114559,"post_id":76579740,"comment_id":135033296,"body_markdown":"If Iceberg has implemented its connector in the right way (e.g. it&#39;s implemented using one of Flink&#39;s Sink interfaces), it works out of the box.","body":"If Iceberg has implemented its connector in the right way (e.g. it&#39;s implemented using one of Flink&#39;s Sink interfaces), it works out of the box."},{"owner":{"account_id":16236176,"reputation":41,"user_id":11723625,"display_name":"Netrunner"},"score":0,"creation_date":1695584028,"post_id":76579740,"comment_id":136040504,"body_markdown":"It doesn&#39;t. It has to be done manually. It is still @Experimental. I&#39;ve done it based on timestamps.","body":"It doesn&#39;t. It has to be done manually. It is still @Experimental. I&#39;ve done it based on timestamps."}],"tags":[],"owner":{"account_id":21886042,"reputation":1703,"user_id":16173669,"display_name":"Martijn Visser"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1688030451,"creation_date":1688030451,"answer_id":76579740,"question_id":76558115,"body_markdown":"Flink has a snapshotting mechanism (checkpointing and savepointing). It&#39;s used to write Flink&#39;s state to durable storage, for recovery purposes in case of an error or in situations where you want to perform an upgrade (of either your Flink cluster, or the business logic in your application). See https://nightlies.apache.org/flink/flink-docs-stable/docs/ops/state/checkpoints/ for more details","title":"How to start Flink application from last snapshot-id in DB streaming when application was stopped","body":"<p>Flink has a snapshotting mechanism (checkpointing and savepointing). It's used to write Flink's state to durable storage, for recovery purposes in case of an error or in situations where you want to perform an upgrade (of either your Flink cluster, or the business logic in your application). See <a href=\"https://nightlies.apache.org/flink/flink-docs-stable/docs/ops/state/checkpoints/\" rel=\"nofollow noreferrer\">https://nightlies.apache.org/flink/flink-docs-stable/docs/ops/state/checkpoints/</a> for more details</p>\n"}],"owner":{"account_id":16236176,"reputation":41,"user_id":11723625,"display_name":"Netrunner"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":112,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1700049524,"creation_date":1687793135,"question_id":76558115,"body_markdown":"I&#39;m creating an AWS Flink application in Java that stream from Iceberg and wondering if Flink has mechanism that providing possibility of restarting stream from last snapshot-id that was successfully processed, if the whole application is down. Should I sink snapshot-id to database or there is a better solution for that ?\r\n\r\nExpected scenario:\r\n- Flink stream processing messages from Iceberg table (application is scalable and can run in many processes) and store results in Kinesis and another IcebergTable\r\n- application has died unexpectedly\r\n- I&#39;m starting application again\r\n- it continues to processing messages without any data loss and without any manual interference\r\n\r\nI don&#39;t use dedicated IcebergSource. Perhaps this implementation could solve it somehow. Right now I&#39;m using FlinkSource. Both of source implementations has method for set snapshot-id, but it have to be set manually and store somewhere during processing. Is there any way to avoid it and use internal Flink mechanism ?","title":"How to start Flink application from last snapshot-id in DB streaming when application was stopped","body":"<p>I'm creating an AWS Flink application in Java that stream from Iceberg and wondering if Flink has mechanism that providing possibility of restarting stream from last snapshot-id that was successfully processed, if the whole application is down. Should I sink snapshot-id to database or there is a better solution for that ?</p>\n<p>Expected scenario:</p>\n<ul>\n<li>Flink stream processing messages from Iceberg table (application is scalable and can run in many processes) and store results in Kinesis and another IcebergTable</li>\n<li>application has died unexpectedly</li>\n<li>I'm starting application again</li>\n<li>it continues to processing messages without any data loss and without any manual interference</li>\n</ul>\n<p>I don't use dedicated IcebergSource. Perhaps this implementation could solve it somehow. Right now I'm using FlinkSource. Both of source implementations has method for set snapshot-id, but it have to be set manually and store somewhere during processing. Is there any way to avoid it and use internal Flink mechanism ?</p>\n"},{"tags":["java","hibernate","jpa","criteria","hibernate-criteria"],"answers":[{"tags":[],"owner":{"account_id":2736255,"reputation":111,"user_id":7776101,"display_name":"david"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700049297,"creation_date":1700049297,"answer_id":77487499,"question_id":77458803,"body_markdown":"To use the Array-Aggregation available in Postgres an extended Postgres-Dialect with a defined array_agg function.\r\n```java\r\npublic class ExtendedPostgreSQL9Dialect extends PostgreSQL9Dialect {\r\n\r\n\tpublic ExtendedPostgreSQL9Dialect() {\r\n\t\tsuper();\r\n\t\tregisterFunction(&quot;array_agg&quot;, new StandardSQLFunction(&quot;array_agg&quot;, StandardBasicTypes.STRING));\r\n\t}\r\n}\r\n```\r\n\r\nThe dialect has to be configured at the configuration yml or in code at\r\n```\r\njpa.hibernate.dialect:ExtendedPostgreSQL9Dialect\r\n```\r\n\r\nWith this a subquery for inverse joins can be constructed\r\n\r\n```java\r\n\t\tSubquery&lt;String&gt; subquery = query.subquery(String.class);\r\n\t\tRoot&lt;&gt; subFrom = subquery.from(parentClass);\r\n\t\tJoin&lt;Object, Object&gt; join = subFrom.join(fieldName);\r\n\t\tjoin.on(criteriaBuilder.equal(entryRoot.get(&quot;id&quot;), join.get(&quot;id&quot;)));\r\n\t\tExpression&lt;String&gt; function = criteriaBuilder.function(&quot;array_agg&quot;, String.class, join.getParent()\r\n\t\t                                                                                      .get(&quot;id&quot;));\r\n\t\tsubquery.select(function);\r\n\r\n```\r\n\r\nIn the query itself the selection of the subquery has to be added\r\n\r\n```java\r\nquery.multiselect(..., subquery.getSelection());\r\n```","title":"CriteriaQuery with array aggregation","body":"<p>To use the Array-Aggregation available in Postgres an extended Postgres-Dialect with a defined array_agg function.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class ExtendedPostgreSQL9Dialect extends PostgreSQL9Dialect {\n\n    public ExtendedPostgreSQL9Dialect() {\n        super();\n        registerFunction(&quot;array_agg&quot;, new StandardSQLFunction(&quot;array_agg&quot;, StandardBasicTypes.STRING));\n    }\n}\n</code></pre>\n<p>The dialect has to be configured at the configuration yml or in code at</p>\n<pre><code>jpa.hibernate.dialect:ExtendedPostgreSQL9Dialect\n</code></pre>\n<p>With this a subquery for inverse joins can be constructed</p>\n<pre class=\"lang-java prettyprint-override\"><code>        Subquery&lt;String&gt; subquery = query.subquery(String.class);\n        Root&lt;&gt; subFrom = subquery.from(parentClass);\n        Join&lt;Object, Object&gt; join = subFrom.join(fieldName);\n        join.on(criteriaBuilder.equal(entryRoot.get(&quot;id&quot;), join.get(&quot;id&quot;)));\n        Expression&lt;String&gt; function = criteriaBuilder.function(&quot;array_agg&quot;, String.class, join.getParent()\n                                                                                              .get(&quot;id&quot;));\n        subquery.select(function);\n\n</code></pre>\n<p>In the query itself the selection of the subquery has to be added</p>\n<pre class=\"lang-java prettyprint-override\"><code>query.multiselect(..., subquery.getSelection());\n</code></pre>\n"}],"owner":{"account_id":2736255,"reputation":111,"user_id":7776101,"display_name":"david"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":30,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1700049297,"creation_date":1699606989,"question_id":77458803,"body_markdown":"I want to perform a Query into a custom Data-Access-Class. Unfortunately I am stuck midway.\r\n```java\r\nclass User {\r\n  private Long id\r\n  private String name\r\n  private Set&lt;Group&gt; groups\r\n...\r\n}\r\n\r\nclass Group {\r\n  private Long id\r\n  private String name\r\n...\r\n}\r\n```\r\n\r\nI want to construct the equivalent to the following sql-Statement\r\n```sql\r\nselect user.id, user.name, ARRAY_AGG(user_groups.groups_id) from user left join user_groups ON user_groups.user_id = user.id group by user.id\r\n```\r\n\r\nI tried the following\r\n```java\r\nCriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();\r\nCriteriaQuery query = criteriaBuilder.createQuery(CustomUser.class)\r\nRoot&lt;ENTITY&gt; entryRoot = query.from(User.class);\r\nquery.groupBy(entryRoot.get(&quot;ident&quot;);\r\n```\r\n\r\nIf I multiselect with a join, it fails, because an aggregate function is missing\r\n```java\r\nquery.multiselect(entryRoot.get(&quot;id&quot;), entryRoot.get(&quot;name&quot;), entryRoot.join(&quot;groups&quot;, JoinType.Left)\r\n```\r\n\r\nI tried to add an array aggregation into multiselect\r\n```java\r\narraySelection = CompoundSelection&lt;Object[]&gt; array = criteriaBuilder.array(entryRoot.join(&quot;groups&quot;, JoinType.LEFT));\r\nquery.multiselect(entryRoot.get(&quot;id&quot;), entryRoot.get(&quot;name&quot;), arraySelection)\r\n```\r\n\r\nThis unfortunately fails because Compound-Selections are not allowed with other Selections in a multiselect.\r\n\r\nHow can I perform an array aggregation with a CriteriaQuery?\r\n\r\n\r\nI am aware, that I could simply use\r\n```java\r\nCriteriaQuery query = criteriaBuilder.createQuery(User.class)\r\n```\r\ninstead of\r\n```java\r\nCriteriaQuery query = criteriaBuilder.createQuery(CustomUser.class)\r\n```\r\nbut I want to add further joins of only inversely related Entities. Actually I am stuck in reconstructing the things done automatically, do add more functionality later.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","title":"CriteriaQuery with array aggregation","body":"<p>I want to perform a Query into a custom Data-Access-Class. Unfortunately I am stuck midway.</p>\n<pre class=\"lang-java prettyprint-override\"><code>class User {\n  private Long id\n  private String name\n  private Set&lt;Group&gt; groups\n...\n}\n\nclass Group {\n  private Long id\n  private String name\n...\n}\n</code></pre>\n<p>I want to construct the equivalent to the following sql-Statement</p>\n<pre class=\"lang-sql prettyprint-override\"><code>select user.id, user.name, ARRAY_AGG(user_groups.groups_id) from user left join user_groups ON user_groups.user_id = user.id group by user.id\n</code></pre>\n<p>I tried the following</p>\n<pre class=\"lang-java prettyprint-override\"><code>CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();\nCriteriaQuery query = criteriaBuilder.createQuery(CustomUser.class)\nRoot&lt;ENTITY&gt; entryRoot = query.from(User.class);\nquery.groupBy(entryRoot.get(&quot;ident&quot;);\n</code></pre>\n<p>If I multiselect with a join, it fails, because an aggregate function is missing</p>\n<pre class=\"lang-java prettyprint-override\"><code>query.multiselect(entryRoot.get(&quot;id&quot;), entryRoot.get(&quot;name&quot;), entryRoot.join(&quot;groups&quot;, JoinType.Left)\n</code></pre>\n<p>I tried to add an array aggregation into multiselect</p>\n<pre class=\"lang-java prettyprint-override\"><code>arraySelection = CompoundSelection&lt;Object[]&gt; array = criteriaBuilder.array(entryRoot.join(&quot;groups&quot;, JoinType.LEFT));\nquery.multiselect(entryRoot.get(&quot;id&quot;), entryRoot.get(&quot;name&quot;), arraySelection)\n</code></pre>\n<p>This unfortunately fails because Compound-Selections are not allowed with other Selections in a multiselect.</p>\n<p>How can I perform an array aggregation with a CriteriaQuery?</p>\n<p>I am aware, that I could simply use</p>\n<pre class=\"lang-java prettyprint-override\"><code>CriteriaQuery query = criteriaBuilder.createQuery(User.class)\n</code></pre>\n<p>instead of</p>\n<pre class=\"lang-java prettyprint-override\"><code>CriteriaQuery query = criteriaBuilder.createQuery(CustomUser.class)\n</code></pre>\n<p>but I want to add further joins of only inversely related Entities. Actually I am stuck in reconstructing the things done automatically, do add more functionality later.</p>\n"},{"tags":["java","spring","date","thymeleaf","dto"],"answers":[{"comments":[{"owner":{"account_id":123802,"reputation":37785,"user_id":318493,"accept_rate":67,"display_name":"RoToRa"},"score":0,"creation_date":1700057324,"post_id":77487434,"comment_id":136607981,"body_markdown":"With Thymeleaf you should not set `name`, `id` or `value` yourself. `th:field` will set all of those correctly for you. If you need to reference an `id` (for example &quot;`for`&quot; a `label`) use the [#ids](https://www.thymeleaf.org/doc/tutorials/3.1/usingthymeleaf.html#ids) helper functions.","body":"With Thymeleaf you should not set <code>name</code>, <code>id</code> or <code>value</code> yourself. <code>th:field</code> will set all of those correctly for you. If you need to reference an <code>id</code> (for example &quot;<code>for</code>&quot; a <code>label</code>) use the <a href=\"https://www.thymeleaf.org/doc/tutorials/3.1/usingthymeleaf.html#ids\" rel=\"nofollow noreferrer\">#ids</a> helper functions."},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1700163175,"post_id":77487434,"comment_id":136624090,"body_markdown":"As it’s currently written, your answer is unclear. Please [edit] to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"As it’s currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/77487434/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":29908417,"reputation":11,"user_id":22920424,"display_name":"Michal Bažant"},"comment_count":2,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1700048737,"creation_date":1700048737,"answer_id":77487434,"question_id":77487385,"body_markdown":"I found the solution.\r\n\r\n    &lt;input name=&quot;birthday&quot; id=&quot;birthday&quot; type=&quot;date&quot; th:value=&quot;*{birthday}&quot; class=&quot;form-control&quot;/&gt;\r\n\r\nThe property name matters!\r\nI didn&#39;t know that.\r\n\r\nI got rid of th:field and let there only th:value, added name and it is magically working.","title":"Problem with display of date in a html/thymeleaf edit form","body":"<p>I found the solution.</p>\n<pre><code>&lt;input name=&quot;birthday&quot; id=&quot;birthday&quot; type=&quot;date&quot; th:value=&quot;*{birthday}&quot; class=&quot;form-control&quot;/&gt;\n</code></pre>\n<p>The property name matters!\nI didn't know that.</p>\n<p>I got rid of th:field and let there only th:value, added name and it is magically working.</p>\n"}],"owner":{"account_id":29908417,"reputation":11,"user_id":22920424,"display_name":"Michal Bažant"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":28,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1700048737,"creation_date":1700048181,"question_id":77487385,"body_markdown":"I have this little problem, that bothers me very much.\r\n\r\nI am working on a blog, that runs it&#39;s backend in java (spring), whereas frontend is in html/css/thymeleaf.\r\n\r\nI am working on displaying of user&#39;s profile and it&#39;s editing.\r\n\r\nOn my page, if you click on &quot;edit profile&quot;, you will be redirected to form with valueas as firstName, lastName, etc. and finally birthday.\r\nIn that edit form, you should not see blank rows, but you should see filled in all the data from your profile, that are in database, and you can edit them.\r\n\r\nAnd it is working, only the birthday is not shown! The value of birthday is blank in the form, despite it&#39;s saved in DB.\r\n\r\nMy thymeleaf form is like that:\r\n\r\n```\r\n&lt;form class=&quot;d-flex flex-column gap-2&quot; method=&quot;post&quot;\r\n                  th:action=&quot;@{&#39;/profile/edit/&#39; + ${profileId}}&quot; th:object=&quot;${profileDTO}&quot;&gt;\r\n                &lt;div class=&quot;form-group&quot;&gt;\r\n                    &lt;label for=&quot;firstName&quot; class=&quot;control-label&quot;&gt;First Name&lt;/label&gt;\r\n                    &lt;input id=&quot;firstName&quot; th:field=&quot;*{firstName}&quot; class=&quot;form-control&quot; /&gt;\r\n                    &lt;small class=&quot;text-danger&quot; th:if=&quot;${#fields.hasErrors(&#39;firstName&#39;)}&quot;\r\n                           th:errors=&quot;*{firstName}&quot;&gt;&lt;/small&gt;\r\n                &lt;/div&gt;\r\n\r\n                &lt;div class=&quot;form-group&quot;&gt;\r\n                    &lt;label for=&quot;lastName&quot; class=&quot;control-label&quot;&gt;Last Name&lt;/label&gt;\r\n                    &lt;input id=&quot;lastName&quot; th:field=&quot;*{lastName}&quot; class=&quot;form-control&quot; /&gt;\r\n                    &lt;small class=&quot;text-danger&quot; th:if=&quot;${#fields.hasErrors(&#39;lastName&#39;)}&quot;\r\n                           th:errors=&quot;*{lastName}&quot;&gt;&lt;/small&gt;\r\n                &lt;/div&gt;\r\n\r\n                &lt;div class=&quot;form-group&quot;&gt;\r\n                    &lt;label for=&quot;birthday&quot; class=&quot;control-label&quot;&gt;Birthday&lt;/label&gt;\r\n                    &lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:value=&quot;*{birthday}&quot; th:field=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\r\n                    &lt;small class=&quot;text-danger&quot; th:if=&quot;${#fields.hasErrors(&#39;birthday&#39;)}&quot;\r\n                           th:errors=&quot;*{birthday}&quot;&gt;&lt;/small&gt;\r\n                &lt;/div&gt;\r\n\r\n                &lt;div class=&quot;form-group&quot;&gt;\r\n                    &lt;label for=&quot;interests&quot; class=&quot;control-label&quot;&gt;Interests&lt;/label&gt;\r\n                    &lt;input id=&quot;interests&quot; th:field=&quot;*{interests}&quot; class=&quot;form-control&quot; /&gt;\r\n                    &lt;small class=&quot;text-danger&quot; th:if=&quot;${#fields.hasErrors(&#39;interests&#39;)}&quot;\r\n                           th:errors=&quot;*{interests}&quot;&gt;&lt;/small&gt;\r\n                &lt;/div&gt;\r\n\r\n                &lt;div class=&quot;form-group&quot;&gt;\r\n                    &lt;label for=&quot;aboutMe&quot; class=&quot;control-label&quot;&gt;About Me&lt;/label&gt;\r\n                    &lt;textarea id=&quot;aboutMe&quot; class=&quot;form-control&quot; th:field=&quot;*{aboutMe}&quot;&gt;&lt;/textarea&gt;\r\n                    &lt;small class=&quot;text-danger&quot; th:if=&quot;${#fields.hasErrors(&#39;aboutMe&#39;)}&quot;\r\n                           th:errors=&quot;*{aboutMe}&quot;&gt;&lt;/small&gt;\r\n                &lt;/div&gt;\r\n\r\n                &lt;div class=&quot;form-group&quot;&gt;\r\n                    &lt;button type=&quot;submit&quot; class=&quot;clanky-tlacitko&quot;&gt;Save&lt;/button&gt;\r\n                &lt;/div&gt;\r\n            &lt;/form&gt;\r\n```\r\n\r\nI tried to modify code in many ways.\r\nIf i change this:\r\n\r\n```\r\n&lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:value=&quot;*{birthday}&quot; th:field=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\r\n```\r\n\r\nTo this:\r\n\r\n```\r\n&lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:value=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\r\n```\r\n(which means if I get rid of parameter th:field)\r\nIt&#39;s magically working! The birthday is shown properly, when I click on &quot;edit form&quot;. But on the other hand, because I got rid of th:field, after saving the form, birthday is not sent to server, so you actually cannot change it.\r\n\r\nI know for sure, that the problem is not with my DTO. DTO is filled properly from DB, otherwise you would not see it in that last example.\r\n\r\nThere must be some problem with that thymeleaf form or something.\r\nBut I ran out of ideas.\r\n\r\nAny ideas?\r\nThank you very much.\r\n\r\n\r\n\r\n\r\nI tried many things:\r\n\r\n```\r\n&lt;input type=&quot;text&quot; id=&quot;birthday&quot; th:value=&quot;${#temporals.format(profileDTO.birthday, &#39;yyyy-MM-dd&#39;)}&quot; class=&quot;form-control datepicker&quot; /&gt;\r\n```\r\nWhich lead to the fact, the new values were not sent to server.\r\n\r\n\r\n```\r\n &lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:value=&quot;*{birthday}&quot; th:field=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\r\n```\r\nIn this case, the new data is sent to server, but you don&#39;t see the pre-filled value in the form, when you go to edit.\r\n\r\n \r\n```\r\n&lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:field=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\r\n```\r\nThe same.\r\n\r\n\r\n```\r\n&lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:value=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\r\n```\r\n\r\nIn this case, when you go to &quot;edit profile&quot;, you see the value of birthday in the form, but you don&#39;t send a new value to the server.\r\n","title":"Problem with display of date in a html/thymeleaf edit form","body":"<p>I have this little problem, that bothers me very much.</p>\n<p>I am working on a blog, that runs it's backend in java (spring), whereas frontend is in html/css/thymeleaf.</p>\n<p>I am working on displaying of user's profile and it's editing.</p>\n<p>On my page, if you click on &quot;edit profile&quot;, you will be redirected to form with valueas as firstName, lastName, etc. and finally birthday.\nIn that edit form, you should not see blank rows, but you should see filled in all the data from your profile, that are in database, and you can edit them.</p>\n<p>And it is working, only the birthday is not shown! The value of birthday is blank in the form, despite it's saved in DB.</p>\n<p>My thymeleaf form is like that:</p>\n<pre><code>&lt;form class=&quot;d-flex flex-column gap-2&quot; method=&quot;post&quot;\n                  th:action=&quot;@{'/profile/edit/' + ${profileId}}&quot; th:object=&quot;${profileDTO}&quot;&gt;\n                &lt;div class=&quot;form-group&quot;&gt;\n                    &lt;label for=&quot;firstName&quot; class=&quot;control-label&quot;&gt;First Name&lt;/label&gt;\n                    &lt;input id=&quot;firstName&quot; th:field=&quot;*{firstName}&quot; class=&quot;form-control&quot; /&gt;\n                    &lt;small class=&quot;text-danger&quot; th:if=&quot;${#fields.hasErrors('firstName')}&quot;\n                           th:errors=&quot;*{firstName}&quot;&gt;&lt;/small&gt;\n                &lt;/div&gt;\n\n                &lt;div class=&quot;form-group&quot;&gt;\n                    &lt;label for=&quot;lastName&quot; class=&quot;control-label&quot;&gt;Last Name&lt;/label&gt;\n                    &lt;input id=&quot;lastName&quot; th:field=&quot;*{lastName}&quot; class=&quot;form-control&quot; /&gt;\n                    &lt;small class=&quot;text-danger&quot; th:if=&quot;${#fields.hasErrors('lastName')}&quot;\n                           th:errors=&quot;*{lastName}&quot;&gt;&lt;/small&gt;\n                &lt;/div&gt;\n\n                &lt;div class=&quot;form-group&quot;&gt;\n                    &lt;label for=&quot;birthday&quot; class=&quot;control-label&quot;&gt;Birthday&lt;/label&gt;\n                    &lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:value=&quot;*{birthday}&quot; th:field=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\n                    &lt;small class=&quot;text-danger&quot; th:if=&quot;${#fields.hasErrors('birthday')}&quot;\n                           th:errors=&quot;*{birthday}&quot;&gt;&lt;/small&gt;\n                &lt;/div&gt;\n\n                &lt;div class=&quot;form-group&quot;&gt;\n                    &lt;label for=&quot;interests&quot; class=&quot;control-label&quot;&gt;Interests&lt;/label&gt;\n                    &lt;input id=&quot;interests&quot; th:field=&quot;*{interests}&quot; class=&quot;form-control&quot; /&gt;\n                    &lt;small class=&quot;text-danger&quot; th:if=&quot;${#fields.hasErrors('interests')}&quot;\n                           th:errors=&quot;*{interests}&quot;&gt;&lt;/small&gt;\n                &lt;/div&gt;\n\n                &lt;div class=&quot;form-group&quot;&gt;\n                    &lt;label for=&quot;aboutMe&quot; class=&quot;control-label&quot;&gt;About Me&lt;/label&gt;\n                    &lt;textarea id=&quot;aboutMe&quot; class=&quot;form-control&quot; th:field=&quot;*{aboutMe}&quot;&gt;&lt;/textarea&gt;\n                    &lt;small class=&quot;text-danger&quot; th:if=&quot;${#fields.hasErrors('aboutMe')}&quot;\n                           th:errors=&quot;*{aboutMe}&quot;&gt;&lt;/small&gt;\n                &lt;/div&gt;\n\n                &lt;div class=&quot;form-group&quot;&gt;\n                    &lt;button type=&quot;submit&quot; class=&quot;clanky-tlacitko&quot;&gt;Save&lt;/button&gt;\n                &lt;/div&gt;\n            &lt;/form&gt;\n</code></pre>\n<p>I tried to modify code in many ways.\nIf i change this:</p>\n<pre><code>&lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:value=&quot;*{birthday}&quot; th:field=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\n</code></pre>\n<p>To this:</p>\n<pre><code>&lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:value=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\n</code></pre>\n<p>(which means if I get rid of parameter th:field)\nIt's magically working! The birthday is shown properly, when I click on &quot;edit form&quot;. But on the other hand, because I got rid of th:field, after saving the form, birthday is not sent to server, so you actually cannot change it.</p>\n<p>I know for sure, that the problem is not with my DTO. DTO is filled properly from DB, otherwise you would not see it in that last example.</p>\n<p>There must be some problem with that thymeleaf form or something.\nBut I ran out of ideas.</p>\n<p>Any ideas?\nThank you very much.</p>\n<p>I tried many things:</p>\n<pre><code>&lt;input type=&quot;text&quot; id=&quot;birthday&quot; th:value=&quot;${#temporals.format(profileDTO.birthday, 'yyyy-MM-dd')}&quot; class=&quot;form-control datepicker&quot; /&gt;\n</code></pre>\n<p>Which lead to the fact, the new values were not sent to server.</p>\n<pre><code> &lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:value=&quot;*{birthday}&quot; th:field=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\n</code></pre>\n<p>In this case, the new data is sent to server, but you don't see the pre-filled value in the form, when you go to edit.</p>\n<pre><code>&lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:field=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\n</code></pre>\n<p>The same.</p>\n<pre><code>&lt;input type=&quot;date&quot; id=&quot;birthday&quot; th:value=&quot;*{birthday}&quot; class=&quot;form-control&quot; /&gt;\n</code></pre>\n<p>In this case, when you go to &quot;edit profile&quot;, you see the value of birthday in the form, but you don't send a new value to the server.</p>\n"},{"tags":["java"],"answers":[{"tags":[],"owner":{"account_id":2818342,"reputation":299906,"user_id":2422776,"display_name":"Mureinik"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1700043954,"creation_date":1700043954,"answer_id":77486933,"question_id":77486891,"body_markdown":"`Scanner` is a `Closable`, so your IDE correctly recognizes that you&#39;ve opened it but haven&#39;t explicitly called `close()` on it when you&#39;re done with it, so there&#39;s a theoretical resource leak here.\r\n\r\nHowever, in this case, `input` is a `Scanner` based on `System.in`, which you should never close explicitly.\r\n\r\nTo make a long story short, you should dismiss this warning.","title":"Resource leak: &#39;input&#39; is never closed in vscode","body":"<p><code>Scanner</code> is a <code>Closable</code>, so your IDE correctly recognizes that you've opened it but haven't explicitly called <code>close()</code> on it when you're done with it, so there's a theoretical resource leak here.</p>\n<p>However, in this case, <code>input</code> is a <code>Scanner</code> based on <code>System.in</code>, which you should never close explicitly.</p>\n<p>To make a long story short, you should dismiss this warning.</p>\n"},{"comments":[{"owner":{"account_id":213468,"reputation":103500,"user_id":466862,"display_name":"Mark Rotteveel"},"score":1,"creation_date":1700048648,"post_id":77486941,"comment_id":136606369,"body_markdown":"`Closeable` is a specialization of `AutoCloseable`, so your argument is a bit weird IMO (that is, considering `AutoCloseable` and `Closeable` separately).","body":"<code>Closeable</code> is a specialization of <code>AutoCloseable</code>, so your argument is a bit weird IMO (that is, considering <code>AutoCloseable</code> and <code>Closeable</code> separately)."},{"owner":{"account_id":31180,"reputation":29173,"user_id":85421,"display_name":"user85421"},"score":1,"creation_date":1700054492,"post_id":77486941,"comment_id":136607398,"body_markdown":"BTW closing `System.in` most often is not recommended - and closing the `Scanner` using `System.in` as source, will also close it aswell","body":"BTW closing <code>System.in</code> most often is not recommended - and closing the <code>Scanner</code> using <code>System.in</code> as source, will also close it aswell"}],"tags":[],"owner":{"account_id":13832344,"reputation":1457,"user_id":9984846,"display_name":"Christian"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700045344,"creation_date":1700044015,"answer_id":77486941,"question_id":77486891,"body_markdown":"`Scanner` implements the `Closeable` interface, i.e. it has a method called `close`. You would have to guarantee, that this will always be called as otherwise this might lead to memory-leaks as your IDE is suggesting here.. \r\nIn its most explicit way, this would look like this:\r\n\r\n```\r\nScanner scanner = new Scanner(System.in);\r\ntry {\r\n   &lt;&lt; do your stuff&gt;&gt;\r\n} catch (Exception ex) {\r\n   &lt;&lt;Handle exception&gt;&gt;\r\n} finally {\r\n   scanner.close();\r\n}\r\n```\r\n\r\nHowever, it is also AutoCloseable, which allows this convenience solution:\r\n```\r\ntry(Scanner scanner = new Scanner()) {\r\n   &lt;&lt; do your stuff&gt;&gt;\r\n} catch (Exception ex) {\r\n   &lt;&lt;Handle exception&gt;&gt;\r\n} \r\n```\r\n\r\nHere you don&#39;t have to call close() explicitly anymore as Java will already do this as you are creating the Scanner in the try.\r\n\r\nThe term you might want to look at if you are more interested is &quot;try-with-resources&quot;","title":"Resource leak: &#39;input&#39; is never closed in vscode","body":"<p><code>Scanner</code> implements the <code>Closeable</code> interface, i.e. it has a method called <code>close</code>. You would have to guarantee, that this will always be called as otherwise this might lead to memory-leaks as your IDE is suggesting here..\nIn its most explicit way, this would look like this:</p>\n<pre><code>Scanner scanner = new Scanner(System.in);\ntry {\n   &lt;&lt; do your stuff&gt;&gt;\n} catch (Exception ex) {\n   &lt;&lt;Handle exception&gt;&gt;\n} finally {\n   scanner.close();\n}\n</code></pre>\n<p>However, it is also AutoCloseable, which allows this convenience solution:</p>\n<pre><code>try(Scanner scanner = new Scanner()) {\n   &lt;&lt; do your stuff&gt;&gt;\n} catch (Exception ex) {\n   &lt;&lt;Handle exception&gt;&gt;\n} \n</code></pre>\n<p>Here you don't have to call close() explicitly anymore as Java will already do this as you are creating the Scanner in the try.</p>\n<p>The term you might want to look at if you are more interested is &quot;try-with-resources&quot;</p>\n"}],"owner":{"account_id":29907098,"reputation":1,"user_id":22919358,"display_name":"Saeid Lorian"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":58,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1700048710,"answer_count":2,"score":0,"last_activity_date":1700048705,"creation_date":1700043620,"question_id":77486891,"body_markdown":"Why does vs code give me the warming &quot;Resource leak: &#39;input&#39; is never closed&quot; in the following code?\r\nMy code runs correctly but still gives this error.\r\nproblem in (ln 5,col 17)\r\n\r\n````\r\npackage JAVA;\r\nimport java.util.Scanner;\r\npublic class FirstProgram2 {\r\n    public static void main(String[] args) {\r\n        Scanner input = new Scanner(System.in);\r\n        System.out.print(&quot;Enter the first number: &quot;);\r\n        int num1 = input.nextInt();\r\n        System.out.print(&quot;Enter the second number: &quot;);\r\n        int num2 = input.nextInt();\r\n        System.out.println(&quot;Before swapping:&quot;);\r\n        System.out.println(&quot;First number: &quot; + num1);\r\n        System.out.println(&quot;Second number: &quot; + num2);\r\n        // Swapping the numbers\r\n        int temp = num1;\r\n        num1 = num2;\r\n        num2 = temp;\r\n        System.out.println(&quot;After swapping:&quot;);\r\n        System.out.println(&quot;First number: &quot; + num1);\r\n        System.out.println(&quot;Second number: &quot; + num2);\r\n    }\r\n}","title":"Resource leak: &#39;input&#39; is never closed in vscode","body":"<p>Why does vs code give me the warming &quot;Resource leak: 'input' is never closed&quot; in the following code?\nMy code runs correctly but still gives this error.\nproblem in (ln 5,col 17)</p>\n<pre><code>package JAVA;\nimport java.util.Scanner;\npublic class FirstProgram2 {\n    public static void main(String[] args) {\n        Scanner input = new Scanner(System.in);\n        System.out.print(&quot;Enter the first number: &quot;);\n        int num1 = input.nextInt();\n        System.out.print(&quot;Enter the second number: &quot;);\n        int num2 = input.nextInt();\n        System.out.println(&quot;Before swapping:&quot;);\n        System.out.println(&quot;First number: &quot; + num1);\n        System.out.println(&quot;Second number: &quot; + num2);\n        // Swapping the numbers\n        int temp = num1;\n        num1 = num2;\n        num2 = temp;\n        System.out.println(&quot;After swapping:&quot;);\n        System.out.println(&quot;First number: &quot; + num1);\n        System.out.println(&quot;Second number: &quot; + num2);\n    }\n}\n</code></pre>\n"},{"tags":["java","spring-boot","logging","log4j2"],"comments":[{"owner":{"account_id":7423601,"reputation":18712,"user_id":5646962,"display_name":"Thomas Kl&#228;ger"},"score":2,"creation_date":1679903816,"post_id":75853264,"comment_id":133797731,"body_markdown":"While there are surely ways to log in this way I would recommend against it. One point of using logging is to be able to trace how some request was processed, and that involves requires looking up the logs of several method calls in different classes. When you split the log files by class name this because incredibly hard. i.e. the request started in class A, was handed over to some method in class B, which again calls methods in classes C, D and E: how will you bring these logs together?","body":"While there are surely ways to log in this way I would recommend against it. One point of using logging is to be able to trace how some request was processed, and that involves requires looking up the logs of several method calls in different classes. When you split the log files by class name this because incredibly hard. i.e. the request started in class A, was handed over to some method in class B, which again calls methods in classes C, D and E: how will you bring these logs together?"},{"owner":{"account_id":16878,"reputation":306143,"user_id":37213,"accept_rate":81,"display_name":"duffymo"},"score":0,"creation_date":1679935418,"post_id":75853264,"comment_id":133806482,"body_markdown":"Why would you want to?","body":"Why would you want to?"},{"owner":{"account_id":27906986,"reputation":27,"user_id":21309960,"display_name":"Mustafa Dahodwala"},"score":0,"creation_date":1679983829,"post_id":75853264,"comment_id":133814141,"body_markdown":"Actually what i am looking for is when I specify the class which log should be in separate file then all the method invoked in that class then it should be log in that same file.Example Class A in specified then A.log file should be created and if class A has b.method() then that method log also should be present in the A.log file","body":"Actually what i am looking for is when I specify the class which log should be in separate file then all the method invoked in that class then it should be log in that same file.Example Class A in specified then A.log file should be created and if class A has b.method() then that method log also should be present in the A.log file"}],"answers":[{"comments":[{"owner":{"account_id":27906986,"reputation":27,"user_id":21309960,"display_name":"Mustafa Dahodwala"},"score":0,"creation_date":1679933779,"post_id":75853353,"comment_id":133806078,"body_markdown":"Thanks for this approach but the ${filename} is not working can you please help me why?","body":"Thanks for this approach but the ${filename} is not working can you please help me why?"},{"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"score":0,"creation_date":1679935405,"post_id":75853353,"comment_id":133806480,"body_markdown":"I&#39;m sorry - that is a reference to a property. I replaced it with some example filename. You will have to put your filename anyway. Explanation is in the documentation I referenced.","body":"I&#39;m sorry - that is a reference to a property. I replaced it with some example filename. You will have to put your filename anyway. Explanation is in the documentation I referenced."}],"tags":[],"owner":{"account_id":5289146,"reputation":8128,"user_id":4222206,"display_name":"queeg"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1700048613,"creation_date":1679903935,"answer_id":75853353,"question_id":75853264,"body_markdown":"In java code, you do not just have the log statements but also some initializer for the `log` instance, like so:\r\n\r\n    class A {\r\n        private static Logger log = LogManager.getLogger(A.class);\r\n\r\n        public void test() {\r\n            log.info(&quot;blah&quot;);\r\n        }\r\n    }\r\n\r\n    class B {\r\n        private static Logger log = LogManager.getLogger(B.class);\r\n\r\n        public void test() {\r\n            log.info(&quot;blah&quot;);\r\n        }\r\n    }\r\n\r\n    class C {\r\n        private static Logger log = LogManager.getLogger(C.class);\r\n\r\n        public void test() {\r\n            log.info(&quot;blah&quot;);\r\n        }\r\n    }\r\n\r\nNow in your logging configuration (log4j2.xml) the loggers match categories, and you can define which category goes to which appender. Finally you can setup appenders to write to file or console or other destinations, like so:\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;Configuration&gt;\r\n        &lt;Appenders&gt;\r\n            &lt;Console name=&quot;Console&quot; target=&quot;SYSTEM_OUT&quot;&gt;\r\n                &lt;PatternLayout pattern=&quot;%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n&quot;/&gt;\r\n            &lt;/Console&gt;\r\n            &lt;Appender type=&quot;File&quot; name=&quot;File&quot; fileName=&quot;/path/to/logfiles/AandB.log&quot;&gt;\r\n                &lt;Layout type=&quot;PatternLayout&quot;&gt;\r\n                    &lt;Pattern&gt;%d %p %C{1.} [%t] %m%n&lt;/Pattern&gt;\r\n                &lt;/Layout&gt;\r\n            &lt;/Appender&gt;\r\n        &lt;/Appenders&gt;\r\n        &lt;Loggers&gt;\r\n            &lt;Logger level=&quot;info&quot;  name=&quot;A&quot;&gt;&lt;!-- speficially route these messages to the file appender only --&gt;\r\n                &lt;AppenderRef ref=&quot;File&quot;/&gt; \r\n            &lt;/Logger&gt;\r\n            &lt;Logger level=&quot;info&quot;  name=&quot;B&quot;&gt;&lt;!-- speficially route these messages to the file and console appenders --&gt;\r\n                &lt;AppenderRef ref=&quot;Console&quot;/&gt; \r\n                &lt;AppenderRef ref=&quot;File&quot;/&gt; \r\n            &lt;/Logger&gt;\r\n            &lt;Root level=&quot;trace&quot;&gt; &lt;!-- per default route all log statements to the console, which is where logging for C will end up --&gt;\r\n                &lt;AppenderRef ref=&quot;Console&quot;/&gt;\r\n            &lt;/Root&gt;\r\n        &lt;/Loggers&gt;    \r\n    &lt;/Configuration&gt;\r\n\r\nWhile it is possible, I do not see it very efficient to create a separate logfile (=&gt; file appender) for each single class. But on library level this can make sense.\r\n\r\nSee details on https://logging.apache.org/log4j/2.x/manual/configuration.html","title":"How can I make Log Files for every Class using Log4j2?","body":"<p>In java code, you do not just have the log statements but also some initializer for the <code>log</code> instance, like so:</p>\n<pre><code>class A {\n    private static Logger log = LogManager.getLogger(A.class);\n\n    public void test() {\n        log.info(&quot;blah&quot;);\n    }\n}\n\nclass B {\n    private static Logger log = LogManager.getLogger(B.class);\n\n    public void test() {\n        log.info(&quot;blah&quot;);\n    }\n}\n\nclass C {\n    private static Logger log = LogManager.getLogger(C.class);\n\n    public void test() {\n        log.info(&quot;blah&quot;);\n    }\n}\n</code></pre>\n<p>Now in your logging configuration (log4j2.xml) the loggers match categories, and you can define which category goes to which appender. Finally you can setup appenders to write to file or console or other destinations, like so:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;Configuration&gt;\n    &lt;Appenders&gt;\n        &lt;Console name=&quot;Console&quot; target=&quot;SYSTEM_OUT&quot;&gt;\n            &lt;PatternLayout pattern=&quot;%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n&quot;/&gt;\n        &lt;/Console&gt;\n        &lt;Appender type=&quot;File&quot; name=&quot;File&quot; fileName=&quot;/path/to/logfiles/AandB.log&quot;&gt;\n            &lt;Layout type=&quot;PatternLayout&quot;&gt;\n                &lt;Pattern&gt;%d %p %C{1.} [%t] %m%n&lt;/Pattern&gt;\n            &lt;/Layout&gt;\n        &lt;/Appender&gt;\n    &lt;/Appenders&gt;\n    &lt;Loggers&gt;\n        &lt;Logger level=&quot;info&quot;  name=&quot;A&quot;&gt;&lt;!-- speficially route these messages to the file appender only --&gt;\n            &lt;AppenderRef ref=&quot;File&quot;/&gt; \n        &lt;/Logger&gt;\n        &lt;Logger level=&quot;info&quot;  name=&quot;B&quot;&gt;&lt;!-- speficially route these messages to the file and console appenders --&gt;\n            &lt;AppenderRef ref=&quot;Console&quot;/&gt; \n            &lt;AppenderRef ref=&quot;File&quot;/&gt; \n        &lt;/Logger&gt;\n        &lt;Root level=&quot;trace&quot;&gt; &lt;!-- per default route all log statements to the console, which is where logging for C will end up --&gt;\n            &lt;AppenderRef ref=&quot;Console&quot;/&gt;\n        &lt;/Root&gt;\n    &lt;/Loggers&gt;    \n&lt;/Configuration&gt;\n</code></pre>\n<p>While it is possible, I do not see it very efficient to create a separate logfile (=&gt; file appender) for each single class. But on library level this can make sense.</p>\n<p>See details on <a href=\"https://logging.apache.org/log4j/2.x/manual/configuration.html\" rel=\"nofollow noreferrer\">https://logging.apache.org/log4j/2.x/manual/configuration.html</a></p>\n"}],"owner":{"account_id":27906986,"reputation":27,"user_id":21309960,"display_name":"Mustafa Dahodwala"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":526,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":75853353,"answer_count":1,"score":0,"last_activity_date":1700048613,"creation_date":1679903320,"question_id":75853264,"body_markdown":"I am currently using a Spring Boot Application, where I am logging out every Log into the console.\r\n\r\nBut Now I wanted to log every log into a specific class file name.\r\n\r\nExample\r\n\r\n \r\n\r\n    class A {\r\n        public void test() {\r\n            log.info(&quot;Test method&quot;);\r\n        }\r\n    }\r\n\r\nSo the log for this code will be in one of the log folder, where the file name will be `A` (the class Name) and log &quot;Test method&quot; will be inside the file `A`.","title":"How can I make Log Files for every Class using Log4j2?","body":"<p>I am currently using a Spring Boot Application, where I am logging out every Log into the console.</p>\n<p>But Now I wanted to log every log into a specific class file name.</p>\n<p>Example</p>\n<pre><code>class A {\n    public void test() {\n        log.info(&quot;Test method&quot;);\n    }\n}\n</code></pre>\n<p>So the log for this code will be in one of the log folder, where the file name will be <code>A</code> (the class Name) and log &quot;Test method&quot; will be inside the file <code>A</code>.</p>\n"},{"tags":["java","debugging","logging","resttemplate"],"comments":[{"owner":{"account_id":256980,"reputation":3763,"user_id":1071757,"display_name":"davidfrancis"},"score":46,"creation_date":1516123653,"post_id":7952154,"comment_id":83558192,"body_markdown":"Warning to anyone reading in 2018: There isn&#39;t a simple answer to this!","body":"Warning to anyone reading in 2018: There isn&#39;t a simple answer to this!"},{"owner":{"account_id":1310846,"reputation":1407,"user_id":1258873,"accept_rate":86,"display_name":"Sergey Chepurnov"},"score":4,"creation_date":1516884840,"post_id":7952154,"comment_id":83878045,"body_markdown":"Most easy way is to use a breakpoint in write(...) method of AbstractHttpMessageConverter class, there is a outputMessage object where you could see the data. P.S. You can copy the value and then format it with online formatter.","body":"Most easy way is to use a breakpoint in write(...) method of AbstractHttpMessageConverter class, there is a outputMessage object where you could see the data. P.S. You can copy the value and then format it with online formatter."},{"owner":{"account_id":198768,"reputation":1124,"user_id":443633,"display_name":"michaelok"},"score":2,"creation_date":1550098074,"post_id":7952154,"comment_id":96150140,"body_markdown":"seems like this should be easy to do in Spring, but, judging from the answers here - not the case. So one other solution, would be to bypass Spring entirely and use a tool like Fiddler to capture the request/response.","body":"seems like this should be easy to do in Spring, but, judging from the answers here - not the case. So one other solution, would be to bypass Spring entirely and use a tool like Fiddler to capture the request/response."},{"owner":{"account_id":12735021,"reputation":459,"user_id":9250232,"display_name":"Solanki Vaibhav"},"score":0,"creation_date":1557138177,"post_id":7952154,"comment_id":98652298,"body_markdown":"read the answer to this question from the following a link : [spring-resttemplate-how-to-enable-full-debugging-logging-of-requests-responses](https://stackoverflow.com/questions/3892018/how-do-i-log-response-in-spring-resttemplate/56003085#56003085)","body":"read the answer to this question from the following a link : <a href=\"https://stackoverflow.com/questions/3892018/how-do-i-log-response-in-spring-resttemplate/56003085#56003085\">spring-resttemplate-how-to-enable-full-debugging-logging-of-&zwnj;&#8203;requests-responses</a>"},{"owner":{"account_id":141852,"reputation":4322,"user_id":349169,"accept_rate":78,"display_name":"Chris"},"score":0,"creation_date":1564398631,"post_id":7952154,"comment_id":101005039,"body_markdown":"July 2019: As there is still no simple solution to this question, I tried to give a summary of the other 24 answers (so far) and their comments and discussions in [my own answer below](https://stackoverflow.com/a/57252427/349169). Hope it helps.","body":"July 2019: As there is still no simple solution to this question, I tried to give a summary of the other 24 answers (so far) and their comments and discussions in <a href=\"https://stackoverflow.com/a/57252427/349169\">my own answer below</a>. Hope it helps."},{"owner":{"account_id":9553438,"reputation":3539,"user_id":7096763,"display_name":"MikaelF"},"score":0,"creation_date":1564862416,"post_id":7952154,"comment_id":101171711,"body_markdown":"Nothing seemed to work with my Intellij/gradle/Spring Boot config, but I managed to fix my issue with the online [webhook.site](https://webhook.site/) logger.","body":"Nothing seemed to work with my Intellij/gradle/Spring Boot config, but I managed to fix my issue with the online <a href=\"https://webhook.site/\" rel=\"nofollow noreferrer\">webhook.site</a> logger."},{"owner":{"account_id":9540,"reputation":25179,"user_id":17675,"accept_rate":81,"display_name":"Zombies"},"score":0,"creation_date":1588618935,"post_id":7952154,"comment_id":108963186,"body_markdown":"I think it&#39;s time to walk down the path of &quot;restTemplate alternatives&quot;","body":"I think it&#39;s time to walk down the path of &quot;restTemplate alternatives&quot;"}],"answers":[{"comments":[{"owner":{"account_id":4089780,"reputation":1489,"user_id":3358126,"accept_rate":44,"display_name":"Pavel Niedoba"},"score":8,"creation_date":1434724554,"post_id":7964142,"comment_id":49916577,"body_markdown":"This doesn&#39;t work for me, I did both things. I don&#39;t understand why do I need to put log4j.properties when it&#39;s not used anyway in my project (checked by mvn dependency:tree)","body":"This doesn&#39;t work for me, I did both things. I don&#39;t understand why do I need to put log4j.properties when it&#39;s not used anyway in my project (checked by mvn dependency:tree)"},{"owner":{"account_id":2372918,"reputation":4836,"user_id":2077101,"accept_rate":64,"display_name":"James Watkins"},"score":0,"creation_date":1456855574,"post_id":7964142,"comment_id":59135193,"body_markdown":"This doesn&#39;t work for me either. I even tried setting the root logger to Debug mode and still nothing.","body":"This doesn&#39;t work for me either. I even tried setting the root logger to Debug mode and still nothing."},{"owner":{"account_id":1280178,"reputation":3130,"user_id":2356160,"accept_rate":55,"display_name":"lathspell"},"score":0,"creation_date":1489160786,"post_id":7964142,"comment_id":72564512,"body_markdown":"&quot;httpclient.wire.content&quot; and &quot;httpclient.wire.header&quot; are logger names from the Axis2 framework. They can be used to log e.g. SOAP requests in a Spring project *if* those are done using Axis2.","body":"&quot;httpclient.wire.content&quot; and &quot;httpclient.wire.header&quot; are logger names from the Axis2 framework. They can be used to log e.g. SOAP requests in a Spring project <i>if</i> those are done using Axis2."},{"owner":{"account_id":1362416,"reputation":4479,"user_id":1299533,"display_name":"Scott Frederick"},"score":12,"creation_date":1497038292,"post_id":7964142,"comment_id":75928385,"body_markdown":"`httpclient.wire` is actually from the Apache HttpComponents HttpClient library (see https://hc.apache.org/httpcomponents-client-ga/logging.html). This technique will only work if you have `RestTemplate` configured to use the `HttpComponentsClientHttpRequestFactory`","body":"<code>httpclient.wire</code> is actually from the Apache HttpComponents HttpClient library (see <a href=\"https://hc.apache.org/httpcomponents-client-ga/logging.html\" rel=\"nofollow noreferrer\">hc.apache.org/httpcomponents-client-ga/logging.html</a>). This technique will only work if you have <code>RestTemplate</code> configured to use the <code>HttpComponentsClientHttpRequestFactory</code>"}],"tags":[],"owner":{"account_id":307979,"reputation":3127,"user_id":619596,"display_name":"Paul Sabou"},"comment_count":4,"down_vote_count":6,"up_vote_count":31,"is_accepted":true,"score":25,"last_activity_date":1320136908,"creation_date":1320136908,"answer_id":7964142,"question_id":7952154,"body_markdown":"I finally found a way to do this in the right way.\r\nMost of the solution comes from \r\nhttps://stackoverflow.com/questions/3387441/how-do-i-configure-spring-and-slf4j-so-that-i-can-get-logging\r\n\r\nIt seems there are two things that need to be done :\r\n\r\n 1. Add the following line in log4j.properties : `log4j.logger.httpclient.wire=DEBUG`\r\n 2. Make sure spring doesn&#39;t ignore your logging config\r\n\r\nThe second issue happens mostly to spring environments where slf4j is used (as it was my case).\r\nAs such, when slf4j is used make sure that the following two things happen :\r\n\r\n 1. There is no commons-logging library in your classpath : this can be done by adding the exclusion descriptors in your pom :&lt;exclusions&gt;\r\n\r\n\t\t\t\t&lt;exclusions&gt;&lt;exclusion&gt;\r\n\t\t\t\t\t&lt;groupId&gt;commons-logging&lt;/groupId&gt;\r\n\t\t\t\t\t&lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\r\n\t\t\t\t&lt;/exclusion&gt;\r\n\t\t\t&lt;/exclusions&gt;\r\n\r\n 2. The log4j.properties file is stored somewhere in the classpath where spring can find/see it. If you have problems with this, a last resort solution would be to put the log4j.properties file in the default package (not a good practice but just to see that things work as you expect)\r\n\r\n \r\n\r\n","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>I finally found a way to do this in the right way.\nMost of the solution comes from \n<a href=\"https://stackoverflow.com/questions/3387441/how-do-i-configure-spring-and-slf4j-so-that-i-can-get-logging\">How do I configure Spring and SLF4J so that I can get logging?</a></p>\n\n<p>It seems there are two things that need to be done :</p>\n\n<ol>\n<li>Add the following line in log4j.properties : <code>log4j.logger.httpclient.wire=DEBUG</code></li>\n<li>Make sure spring doesn't ignore your logging config</li>\n</ol>\n\n<p>The second issue happens mostly to spring environments where slf4j is used (as it was my case).\nAs such, when slf4j is used make sure that the following two things happen :</p>\n\n<ol>\n<li><p>There is no commons-logging library in your classpath : this can be done by adding the exclusion descriptors in your pom :</p>\n\n<pre><code>        &lt;exclusions&gt;&lt;exclusion&gt;\n            &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n        &lt;/exclusion&gt;\n    &lt;/exclusions&gt;\n</code></pre></li>\n<li><p>The log4j.properties file is stored somewhere in the classpath where spring can find/see it. If you have problems with this, a last resort solution would be to put the log4j.properties file in the default package (not a good practice but just to see that things work as you expect)</p></li>\n</ol>\n"},{"tags":[],"owner":{"account_id":11209,"reputation":25528,"user_id":21499,"accept_rate":56,"display_name":"Dr. Hans-Peter St&#246;rr"},"comment_count":0,"down_vote_count":0,"up_vote_count":12,"is_accepted":false,"score":12,"last_activity_date":1393339325,"creation_date":1393339325,"answer_id":22017478,"question_id":7952154,"body_markdown":"Besides the HttpClient logging described [in the other answer][1], you can also introduce a ClientHttpRequestInterceptor that reads the body of the request and the response and logs it. You might want to do this if other stuff also uses the HttpClient, or if you want a custom logging format. Caution: you will want to give the RestTemplate a BufferingClientHttpRequestFactory such that you can read the response twice.\r\n\r\n\r\n  [1]: https://stackoverflow.com/a/7964142/21499","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Besides the HttpClient logging described <a href=\"https://stackoverflow.com/a/7964142/21499\">in the other answer</a>, you can also introduce a ClientHttpRequestInterceptor that reads the body of the request and the response and logs it. You might want to do this if other stuff also uses the HttpClient, or if you want a custom logging format. Caution: you will want to give the RestTemplate a BufferingClientHttpRequestFactory such that you can read the response twice.</p>\n"},{"comments":[{"owner":{"account_id":270103,"reputation":1176,"user_id":559849,"accept_rate":100,"display_name":"Gyan"},"score":0,"creation_date":1403697358,"post_id":22620168,"comment_id":37757088,"body_markdown":"This is not available until spring-3.1 version.","body":"This is not available until spring-3.1 version."},{"owner":{"account_id":4357035,"reputation":3235,"user_id":3555300,"display_name":"Jiang YD"},"score":4,"creation_date":1432785106,"post_id":22620168,"comment_id":49070824,"body_markdown":"it not answer the question of &#39;logging response&#39;, but leave a //do logging comment instead.","body":"it not answer the question of &#39;logging response&#39;, but leave a //do logging comment instead."},{"owner":{"account_id":4089780,"reputation":1489,"user_id":3358126,"accept_rate":44,"display_name":"Pavel Niedoba"},"score":1,"creation_date":1435570421,"post_id":22620168,"comment_id":50238189,"body_markdown":"doing the logging was easy, but this works only for requests, I don&#39;t see response bodies, suppose I have response object, but reading it&#39;s stream is not good idea.","body":"doing the logging was easy, but this works only for requests, I don&#39;t see response bodies, suppose I have response object, but reading it&#39;s stream is not good idea."},{"owner":{"account_id":4184307,"reputation":368,"user_id":3428424,"display_name":"Uhla"},"score":0,"creation_date":1438450343,"post_id":22620168,"comment_id":51460752,"body_markdown":"@PavelNiedoba Why would you say that reading its stream is not a good idea?","body":"@PavelNiedoba Why would you say that reading its stream is not a good idea?"},{"owner":{"account_id":4184307,"reputation":368,"user_id":3428424,"display_name":"Uhla"},"score":0,"creation_date":1438450407,"post_id":22620168,"comment_id":51460775,"body_markdown":"By the way, I was able to manage logging both request and response via this approach - requests were a bit tricky as they have the outputstream, which you have to parse as bytearrayoutputstream. I am using springTemplate.exchange method, because I need to send some authentication headers as well.","body":"By the way, I was able to manage logging both request and response via this approach - requests were a bit tricky as they have the outputstream, which you have to parse as bytearrayoutputstream. I am using springTemplate.exchange method, because I need to send some authentication headers as well."},{"owner":{"account_id":4089780,"reputation":1489,"user_id":3358126,"accept_rate":44,"display_name":"Pavel Niedoba"},"score":0,"creation_date":1438550548,"post_id":22620168,"comment_id":51483406,"body_markdown":"Reading stream of response is not good because if you do it you actually consume the data and original receiver will not receive it. I solved it by employing king of stream splitter added to the filter chain","body":"Reading stream of response is not good because if you do it you actually consume the data and original receiver will not receive it. I solved it by employing king of stream splitter added to the filter chain"},{"owner":{"account_id":1481793,"reputation":3085,"user_id":1391004,"accept_rate":45,"display_name":"mjj1409"},"score":11,"creation_date":1438617682,"post_id":22620168,"comment_id":51511625,"body_markdown":"@PavelNiedoba  The BufferClientHttpRequestFactory allows the response to be read more than one time.","body":"@PavelNiedoba  The BufferClientHttpRequestFactory allows the response to be read more than one time."},{"owner":{"account_id":1720411,"reputation":1802,"user_id":1576467,"accept_rate":62,"display_name":"GameSalutes"},"score":2,"creation_date":1454170787,"post_id":22620168,"comment_id":57928931,"body_markdown":"This works well if you need to store info about request/response in a database for debugging and regular logging doesn&#39;t suit your needs.","body":"This works well if you need to store info about request/response in a database for debugging and regular logging doesn&#39;t suit your needs."},{"owner":{"account_id":2372918,"reputation":4836,"user_id":2077101,"accept_rate":64,"display_name":"James Watkins"},"score":0,"creation_date":1456864390,"post_id":22620168,"comment_id":59140312,"body_markdown":"The crux of this problem is how to log the response string. This answer conveniently skips over that detail.","body":"The crux of this problem is how to log the response string. This answer conveniently skips over that detail."}],"tags":[],"owner":{"account_id":1481793,"reputation":3085,"user_id":1391004,"accept_rate":45,"display_name":"mjj1409"},"comment_count":9,"down_vote_count":4,"up_vote_count":87,"is_accepted":false,"score":83,"last_activity_date":1424698591,"creation_date":1395693704,"answer_id":22620168,"question_id":7952154,"body_markdown":"Extending @hstoerr answer with some code:\r\n\r\n\r\n----------\r\n\r\n\r\nCreate LoggingRequestInterceptor to log requests responses\r\n\r\n    public class LoggingRequestInterceptor implements ClientHttpRequestInterceptor {\r\n\r\n        private static final Logger log = LoggerFactory.getLogger(LoggingRequestInterceptor.class);\r\n\t\r\n        @Override\r\n        public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\r\n\t\t\r\n            ClientHttpResponse response = execution.execute(request, body);\r\n\t\t\r\n            log(request,body,response);\r\n\r\n            return response;\r\n        }\r\n\t\r\n        private void log(HttpRequest request, byte[] body, ClientHttpResponse response) throws IOException {\r\n            //do logging\r\n        }\r\n    }\r\n\r\nSetup RestTemplate\r\n\r\n    RestTemplate rt = new RestTemplate();\r\n\t\t\r\n    //set interceptors/requestFactory\r\n    ClientHttpRequestInterceptor ri = new LoggingRequestInterceptor();\r\n    List&lt;ClientHttpRequestInterceptor&gt; ris = new ArrayList&lt;ClientHttpRequestInterceptor&gt;();\r\n    ris.add(ri);\r\n    rt.setInterceptors(ris);\r\n    rt.setRequestFactory(new BufferingClientHttpRequestFactory(new SimpleClientHttpRequestFactory());","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Extending @hstoerr answer with some code:</p>\n\n<hr>\n\n<p>Create LoggingRequestInterceptor to log requests responses</p>\n\n<pre><code>public class LoggingRequestInterceptor implements ClientHttpRequestInterceptor {\n\n    private static final Logger log = LoggerFactory.getLogger(LoggingRequestInterceptor.class);\n\n    @Override\n    public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\n\n        ClientHttpResponse response = execution.execute(request, body);\n\n        log(request,body,response);\n\n        return response;\n    }\n\n    private void log(HttpRequest request, byte[] body, ClientHttpResponse response) throws IOException {\n        //do logging\n    }\n}\n</code></pre>\n\n<p>Setup RestTemplate</p>\n\n<pre><code>RestTemplate rt = new RestTemplate();\n\n//set interceptors/requestFactory\nClientHttpRequestInterceptor ri = new LoggingRequestInterceptor();\nList&lt;ClientHttpRequestInterceptor&gt; ris = new ArrayList&lt;ClientHttpRequestInterceptor&gt;();\nris.add(ri);\nrt.setInterceptors(ris);\nrt.setRequestFactory(new BufferingClientHttpRequestFactory(new SimpleClientHttpRequestFactory());\n</code></pre>\n"},{"tags":[],"owner":{"account_id":304772,"reputation":11223,"user_id":614482,"accept_rate":80,"display_name":"Emerson Farrugia"},"comment_count":0,"down_vote_count":1,"up_vote_count":7,"is_accepted":false,"score":6,"last_activity_date":1415892318,"creation_date":1415891629,"answer_id":26912139,"question_id":7952154,"body_markdown":"Assuming `RestTemplate` is [configured][1] to use HttpClient 4.x, you can read up on HttpClient&#39;s logging documentation [here][2]. The loggers are different than those specified in the other answers.\r\n\r\nThe logging configuration for HttpClient 3.x is available [here][3].\r\n\r\n  [1]: http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#rest-resttemplate\r\n  [2]: http://hc.apache.org/httpcomponents-client-4.3.x/logging.html\r\n  [3]: http://hc.apache.org/httpclient-3.x/logging.html","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Assuming <code>RestTemplate</code> is <a href=\"http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#rest-resttemplate\" rel=\"noreferrer\">configured</a> to use HttpClient 4.x, you can read up on HttpClient's logging documentation <a href=\"http://hc.apache.org/httpcomponents-client-4.3.x/logging.html\" rel=\"noreferrer\">here</a>. The loggers are different than those specified in the other answers.</p>\n\n<p>The logging configuration for HttpClient 3.x is available <a href=\"http://hc.apache.org/httpclient-3.x/logging.html\" rel=\"noreferrer\">here</a>.</p>\n"},{"comments":[{"owner":{"account_id":1395355,"reputation":855,"user_id":1325237,"accept_rate":80,"display_name":"Alex"},"score":1,"creation_date":1451512225,"post_id":33009822,"comment_id":56817659,"body_markdown":"Good answer! Though an issue is that if the response code is not a 200, traceResponse will throw.","body":"Good answer! Though an issue is that if the response code is not a 200, traceResponse will throw."},{"owner":{"account_id":2372918,"reputation":4836,"user_id":2077101,"accept_rate":64,"display_name":"James Watkins"},"score":39,"creation_date":1456864331,"post_id":33009822,"comment_id":59140275,"body_markdown":"This is wrong. If you read the stream, the application code will not be able to read the response.","body":"This is wrong. If you read the stream, the application code will not be able to read the response."},{"owner":{"account_id":2841072,"reputation":3118,"user_id":2440682,"display_name":"sofiene zaghdoudi"},"score":39,"creation_date":1456870671,"post_id":33009822,"comment_id":59143781,"body_markdown":"we have given the RestTemplate a BufferingClientHttpRequestFactory so we can read the response twice.","body":"we have given the RestTemplate a BufferingClientHttpRequestFactory so we can read the response twice."},{"owner":{"account_id":1316707,"reputation":949,"user_id":1263369,"accept_rate":86,"display_name":"RubesMN"},"score":18,"creation_date":1462390720,"post_id":33009822,"comment_id":61623305,"body_markdown":"We have been using this technique for about 3 months now.  It only works with RestTemplate configured with a `BufferingClientHttpResponseWrapper` as @sofienezaghdoudi implies.  However, it does not work when used in tests using spring&#39;s mockServer framework since `MockRestServiceServer.createServer(restTemplate)` overwrites the RequestFactory to `InterceptingClientHttpRequestFactory`.","body":"We have been using this technique for about 3 months now.  It only works with RestTemplate configured with a <code>BufferingClientHttpResponseWrapper</code> as @sofienezaghdoudi implies.  However, it does not work when used in tests using spring&#39;s mockServer framework since <code>MockRestServiceServer.createServer(restTemplate)</code> overwrites the RequestFactory to <code>InterceptingClientHttpRequestFactory</code>."},{"owner":{"account_id":7509110,"reputation":280,"user_id":5704707,"display_name":"MilacH"},"score":13,"creation_date":1485438730,"post_id":33009822,"comment_id":70931606,"body_markdown":"The technique is good, implementation is wrong. 404 case, response.getBody() throw IOException -&gt; you never get the log for out and even worst, it will become a ResourceAccessException in your further code, instead of a RestClientResponseException","body":"The technique is good, implementation is wrong. 404 case, response.getBody() throw IOException -&gt; you never get the log for out and even worst, it will become a ResourceAccessException in your further code, instead of a RestClientResponseException"},{"owner":{"account_id":230960,"reputation":151,"user_id":494893,"display_name":"Turcogj"},"score":1,"creation_date":1495772493,"post_id":33009822,"comment_id":75400632,"body_markdown":"Side note: as of the time of commenting this will not work for OAuth2RestTemplate. See [Oauth2RestTemplate should propagate its requestFactory, messageConverters and interceptors to its accessTokenProvider](https://github.com/spring-projects/spring-security-oauth/issues/459)","body":"Side note: as of the time of commenting this will not work for OAuth2RestTemplate. See <a href=\"https://github.com/spring-projects/spring-security-oauth/issues/459\" rel=\"nofollow noreferrer\">Oauth2RestTemplate should propagate its requestFactory, messageConverters and interceptors to its accessTokenProvider</a>"},{"owner":{"account_id":2849695,"reputation":277,"user_id":2447161,"accept_rate":44,"display_name":"user2447161"},"score":8,"creation_date":1501583902,"post_id":33009822,"comment_id":77831756,"body_markdown":"thanks for the reply. But this is bad practice to have multiple &quot;log.debug&quot; as it could be spread over a lot of other logs. It&#39;s better to use a single log.debug instruction so you&#39;re sure everything is on the same place","body":"thanks for the reply. But this is bad practice to have multiple &quot;log.debug&quot; as it could be spread over a lot of other logs. It&#39;s better to use a single log.debug instruction so you&#39;re sure everything is on the same place"},{"owner":{"account_id":3072521,"reputation":1252,"user_id":2602807,"accept_rate":41,"display_name":"user2602807"},"score":1,"creation_date":1507888030,"post_id":33009822,"comment_id":80400076,"body_markdown":"How to use ClientHttpRequestInterceptor without RestTemplate? Using simple @RestController","body":"How to use ClientHttpRequestInterceptor without RestTemplate? Using simple @RestController"},{"owner":{"account_id":2385716,"reputation":379,"user_id":3586682,"display_name":"stiebrs"},"score":1,"creation_date":1513852223,"post_id":33009822,"comment_id":82813483,"body_markdown":"Nice solution, except it crashes on 5xx, which might be undesirable. \n\nYou can use StreamUtils.copyToString to copy response body and then print it out, instead of bufferedReader:\nString bodyText = StreamUtils.copyToString(response.getBody(), StandardCharsets.UTF_8);\nlog.debug(&quot;Response body: {}&quot;, bodyText);","body":"Nice solution, except it crashes on 5xx, which might be undesirable.   You can use StreamUtils.copyToString to copy response body and then print it out, instead of bufferedReader: String bodyText = StreamUtils.copyToString(response.getBody(), StandardCharsets.UTF_8); log.debug(&quot;Response body: {}&quot;, bodyText);"},{"owner":{"account_id":4064255,"reputation":754,"user_id":3339812,"display_name":"Joshua H"},"score":0,"creation_date":1516590497,"post_id":33009822,"comment_id":83735456,"body_markdown":"@Turcogj This method doesn&#39;t work on Oauth2RestTemplate. As an alternative you can change the requestFactory according to this answer https://stackoverflow.com/questions/16573501/resttemplate-logging-post-data","body":"@Turcogj This method doesn&#39;t work on Oauth2RestTemplate. As an alternative you can change the requestFactory according to this answer <a href=\"https://stackoverflow.com/questions/16573501/resttemplate-logging-post-data\" title=\"resttemplate logging post data\">stackoverflow.com/questions/16573501/&hellip;</a>"},{"owner":{"account_id":56218,"reputation":23259,"user_id":168367,"accept_rate":41,"display_name":"Pashec"},"score":5,"creation_date":1522664972,"post_id":33009822,"comment_id":86225513,"body_markdown":"new RestTemplate(new BufferingClientHttpRequestFactory(new HttpComponentsClientHttpRequestFactory())) works better to me as long as is logs non-success responses as well. Note, that you need to add org.apache.httpcomponents:httpclient into dependencies","body":"new RestTemplate(new BufferingClientHttpRequestFactory(new HttpComponentsClientHttpRequestFactory())) works better to me as long as is logs non-success responses as well. Note, that you need to add org.apache.httpcomponents:httpclient into dependencies"},{"owner":{"account_id":2402834,"reputation":380,"user_id":2100121,"display_name":"Tony Findeisen"},"score":1,"creation_date":1536922590,"post_id":33009822,"comment_id":91607707,"body_markdown":"As @MilacH already mentioned, the implementation leads to that the errorHandler is not invoked.","body":"As @MilacH already mentioned, the implementation leads to that the errorHandler is not invoked."},{"owner":{"account_id":198768,"reputation":1124,"user_id":443633,"display_name":"michaelok"},"score":2,"creation_date":1551205693,"post_id":33009822,"comment_id":96552892,"body_markdown":"Kind of amusing to see, with all the suggestions and comments here, that someone appears to have copied the above code lock, stock and barrel and passed it off without attribution. Oh, wait, they changed the C style logging from &#39;info&#39; to &#39;debug&#39; - call it good! #sad https://objectpartners.com/2018/03/01/log-your-resttemplate-request-and-response-without-destroying-the-body/","body":"Kind of amusing to see, with all the suggestions and comments here, that someone appears to have copied the above code lock, stock and barrel and passed it off without attribution. Oh, wait, they changed the C style logging from &#39;info&#39; to &#39;debug&#39; - call it good! #sad <a href=\"https://objectpartners.com/2018/03/01/log-your-resttemplate-request-and-response-without-destroying-the-body/\" rel=\"nofollow noreferrer\">objectpartners.com/2018/03/01/&hellip;</a>"},{"owner":{"account_id":1780785,"reputation":405,"user_id":1623597,"accept_rate":100,"display_name":"Geniy"},"score":0,"creation_date":1551276442,"post_id":33009822,"comment_id":96581616,"body_markdown":"When I added new BufferingClientHttpRequestFactory(new SimpleClientHttpRequestFactory()) to restTemplate I got new problem related https://stackoverflow.com/questions/25163131/httpurlconnection-invalid-http-method-patch . Then I configured new HttpClient that added new fails in my integration test, because some behaviour related to cookies where changed. Actually, the easiest solution is to reuse(copy/paste) org.springframework.http.client.BufferingClientHttpResponseWrapper instead of configuring new requestFactory","body":"When I added new BufferingClientHttpRequestFactory(new SimpleClientHttpRequestFactory()) to restTemplate I got new problem related <a href=\"https://stackoverflow.com/questions/25163131/httpurlconnection-invalid-http-method-patch\" title=\"httpurlconnection invalid http method patch\">stackoverflow.com/questions/25163131/&hellip;</a> . Then I configured new HttpClient that added new fails in my integration test, because some behaviour related to cookies where changed. Actually, the easiest solution is to reuse(copy/paste) org.springframework.http.client.BufferingClientHttpResponseW&zwnj;&#8203;rapper instead of configuring new requestFactory"},{"owner":{"account_id":11682765,"reputation":465,"user_id":8553816,"display_name":"Khwaja Sanjari"},"score":0,"creation_date":1553196298,"post_id":33009822,"comment_id":97305311,"body_markdown":"How do I write a Unit Test for this class?","body":"How do I write a Unit Test for this class?"},{"owner":{"account_id":3248847,"reputation":1579,"user_id":2739681,"accept_rate":82,"display_name":"PeMa"},"score":2,"creation_date":1563525386,"post_id":33009822,"comment_id":100736836,"body_markdown":"For people using `RestTemplateBuilder` after building better use `restTemplate.getInterceptors().add(new LoggingRequestInterceptor());` just to avoid loosing the other interceptors, like auth, ... .","body":"For people using <code>RestTemplateBuilder</code> after building better use <code>restTemplate.getInterceptors().add(new LoggingRequestInterceptor());</code> just to avoid loosing the other interceptors, like auth, ... ."},{"owner":{"account_id":219437,"reputation":1321,"user_id":476345,"accept_rate":78,"display_name":"Fr&#233;d&#233;ric Camblor"},"score":0,"creation_date":1566915398,"post_id":33009822,"comment_id":101800346,"body_markdown":"for performance and memory consumption reasons, it would be better avoiding reading body lines into memory when debug log level is not enabled","body":"for performance and memory consumption reasons, it would be better avoiding reading body lines into memory when debug log level is not enabled"},{"owner":{"account_id":2798279,"reputation":103,"user_id":2407057,"accept_rate":75,"display_name":"WorkInProgress"},"score":0,"creation_date":1580307608,"post_id":33009822,"comment_id":106054859,"body_markdown":"@Pashec your fix works for me! :)\nI saw the blog post and I was very annoyed : copy pasting without attribution + no update about this bug, what a waste of time !","body":"@Pashec your fix works for me! :) I saw the blog post and I was very annoyed : copy pasting without attribution + no update about this bug, what a waste of time !"},{"owner":{"account_id":12959354,"reputation":205,"user_id":9369080,"display_name":"Coder"},"score":0,"creation_date":1585157407,"post_id":33009822,"comment_id":107667131,"body_markdown":"If I am using RestTemplateBuilder instead, how should I approach the instantiating of the requestFactory?","body":"If I am using RestTemplateBuilder instead, how should I approach the instantiating of the requestFactory?"},{"owner":{"account_id":5636901,"reputation":171,"user_id":4462119,"display_name":"Thomas Carlisle"},"score":1,"creation_date":1630769151,"post_id":33009822,"comment_id":122048858,"body_markdown":"@michaelok an others raising this issue of plagiarism. The answerer posted this in 2015. The article that was linked was published in 2018. Also, if you pick a snippet of this code and google it, you will find more than a handful of hits. As much of a problem as answers without attribution is, also is the problem of SEO people ripping answers from SO and turning into a blog post also without attribution.","body":"@michaelok an others raising this issue of plagiarism. The answerer posted this in 2015. The article that was linked was published in 2018. Also, if you pick a snippet of this code and google it, you will find more than a handful of hits. As much of a problem as answers without attribution is, also is the problem of SEO people ripping answers from SO and turning into a blog post also without attribution."},{"owner":{"account_id":3581540,"reputation":987,"user_id":2989643,"display_name":"Shayan Ahmad"},"score":0,"creation_date":1657754916,"post_id":33009822,"comment_id":128888802,"body_markdown":"How can this be a solution? it can easily lead to potential memory leaks (because of BufferingClientHttpRequestFactory). Also, can easily exhaust the memory.","body":"How can this be a solution? it can easily lead to potential memory leaks (because of BufferingClientHttpRequestFactory). Also, can easily exhaust the memory."},{"owner":{"account_id":9941523,"reputation":1018,"user_id":7357959,"display_name":"Tsvetoslav Tsvetkov"},"score":0,"creation_date":1675756262,"post_id":33009822,"comment_id":132991750,"body_markdown":"If we read it in the interceptor using stream, the body won’t be available for RestTemplate to deserialize it into object model","body":"If we read it in the interceptor using stream, the body won’t be available for RestTemplate to deserialize it into object model"},{"owner":{"account_id":3508394,"reputation":2007,"user_id":2933389,"accept_rate":100,"display_name":"Paramesh Korrakuti"},"score":0,"creation_date":1695842743,"post_id":33009822,"comment_id":136079534,"body_markdown":"It&#39;s giving IOException for PATCH http methods at `ClientHttpResponse response = execution.execute(request, body);`","body":"It&#39;s giving IOException for PATCH http methods at <code>ClientHttpResponse response = execution.execute(request, body);</code>"}],"tags":[],"owner":{"account_id":2841072,"reputation":3118,"user_id":2440682,"display_name":"sofiene zaghdoudi"},"comment_count":23,"down_vote_count":4,"up_vote_count":241,"is_accepted":false,"score":237,"last_activity_date":1540368052,"creation_date":1444290870,"answer_id":33009822,"question_id":7952154,"body_markdown":"Just to complete the example with a full implementation of `ClientHttpRequestInterceptor` to trace request and response: \r\n\r\n    import java.io.BufferedReader;\r\n    import java.io.IOException;\r\n    import java.io.InputStreamReader;\r\n    \r\n    import org.slf4j.Logger;\r\n    import org.slf4j.LoggerFactory;\r\n    import org.springframework.http.HttpRequest;\r\n    import org.springframework.http.client.ClientHttpRequestExecution;\r\n    import org.springframework.http.client.ClientHttpRequestInterceptor;\r\n    import org.springframework.http.client.ClientHttpResponse;\r\n    \r\n    public class LoggingRequestInterceptor implements ClientHttpRequestInterceptor {\r\n        \r\n        final static Logger log = LoggerFactory.getLogger(LoggingRequestInterceptor.class);\r\n        \r\n        @Override\r\n        public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\r\n            traceRequest(request, body);\r\n            ClientHttpResponse response = execution.execute(request, body);\r\n            traceResponse(response);\r\n            return response;\r\n        }\r\n    \r\n        private void traceRequest(HttpRequest request, byte[] body) throws IOException {\r\n            log.info(&quot;===========================request begin================================================&quot;);\r\n            log.debug(&quot;URI         : {}&quot;, request.getURI());\r\n            log.debug(&quot;Method      : {}&quot;, request.getMethod());\r\n            log.debug(&quot;Headers     : {}&quot;, request.getHeaders() );\r\n            log.debug(&quot;Request body: {}&quot;, new String(body, &quot;UTF-8&quot;));\r\n            log.info(&quot;==========================request end================================================&quot;);\r\n        }\r\n        \r\n        private void traceResponse(ClientHttpResponse response) throws IOException {\r\n            StringBuilder inputStringBuilder = new StringBuilder();\r\n            BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(response.getBody(), &quot;UTF-8&quot;));\r\n            String line = bufferedReader.readLine();\r\n            while (line != null) {\r\n                inputStringBuilder.append(line);\r\n                inputStringBuilder.append(&#39;\\n&#39;);\r\n                line = bufferedReader.readLine();\r\n            }\r\n            log.info(&quot;============================response begin==========================================&quot;);\r\n            log.debug(&quot;Status code  : {}&quot;, response.getStatusCode());\r\n            log.debug(&quot;Status text  : {}&quot;, response.getStatusText());\r\n            log.debug(&quot;Headers      : {}&quot;, response.getHeaders());\r\n            log.debug(&quot;Response body: {}&quot;, inputStringBuilder.toString());\r\n            log.info(&quot;=======================response end=================================================&quot;);\r\n        }\r\n        \r\n    }\r\n\r\nThen instantiate `RestTemplate` using a `BufferingClientHttpRequestFactory` and the `LoggingRequestInterceptor`:\r\n\r\n    RestTemplate restTemplate = new RestTemplate(new BufferingClientHttpRequestFactory(new SimpleClientHttpRequestFactory()));\r\n    List&lt;ClientHttpRequestInterceptor&gt; interceptors = new ArrayList&lt;&gt;();\r\n    interceptors.add(new LoggingRequestInterceptor());\r\n    restTemplate.setInterceptors(interceptors);\r\n\r\nThe `BufferingClientHttpRequestFactory` is required as we want to use the response body both in the interceptor and for the initial calling code. The default implementation allows to read the response body only once.","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Just to complete the example with a full implementation of <code>ClientHttpRequestInterceptor</code> to trace request and response: </p>\n\n<pre><code>import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.http.HttpRequest;\nimport org.springframework.http.client.ClientHttpRequestExecution;\nimport org.springframework.http.client.ClientHttpRequestInterceptor;\nimport org.springframework.http.client.ClientHttpResponse;\n\npublic class LoggingRequestInterceptor implements ClientHttpRequestInterceptor {\n\n    final static Logger log = LoggerFactory.getLogger(LoggingRequestInterceptor.class);\n\n    @Override\n    public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\n        traceRequest(request, body);\n        ClientHttpResponse response = execution.execute(request, body);\n        traceResponse(response);\n        return response;\n    }\n\n    private void traceRequest(HttpRequest request, byte[] body) throws IOException {\n        log.info(\"===========================request begin================================================\");\n        log.debug(\"URI         : {}\", request.getURI());\n        log.debug(\"Method      : {}\", request.getMethod());\n        log.debug(\"Headers     : {}\", request.getHeaders() );\n        log.debug(\"Request body: {}\", new String(body, \"UTF-8\"));\n        log.info(\"==========================request end================================================\");\n    }\n\n    private void traceResponse(ClientHttpResponse response) throws IOException {\n        StringBuilder inputStringBuilder = new StringBuilder();\n        BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(response.getBody(), \"UTF-8\"));\n        String line = bufferedReader.readLine();\n        while (line != null) {\n            inputStringBuilder.append(line);\n            inputStringBuilder.append('\\n');\n            line = bufferedReader.readLine();\n        }\n        log.info(\"============================response begin==========================================\");\n        log.debug(\"Status code  : {}\", response.getStatusCode());\n        log.debug(\"Status text  : {}\", response.getStatusText());\n        log.debug(\"Headers      : {}\", response.getHeaders());\n        log.debug(\"Response body: {}\", inputStringBuilder.toString());\n        log.info(\"=======================response end=================================================\");\n    }\n\n}\n</code></pre>\n\n<p>Then instantiate <code>RestTemplate</code> using a <code>BufferingClientHttpRequestFactory</code> and the <code>LoggingRequestInterceptor</code>:</p>\n\n<pre><code>RestTemplate restTemplate = new RestTemplate(new BufferingClientHttpRequestFactory(new SimpleClientHttpRequestFactory()));\nList&lt;ClientHttpRequestInterceptor&gt; interceptors = new ArrayList&lt;&gt;();\ninterceptors.add(new LoggingRequestInterceptor());\nrestTemplate.setInterceptors(interceptors);\n</code></pre>\n\n<p>The <code>BufferingClientHttpRequestFactory</code> is required as we want to use the response body both in the interceptor and for the initial calling code. The default implementation allows to read the response body only once.</p>\n"},{"comments":[{"owner":{"account_id":7509110,"reputation":280,"user_id":5704707,"display_name":"MilacH"},"score":0,"creation_date":1485438816,"post_id":35733521,"comment_id":70931652,"body_markdown":"same, responseCopy.getBody() throw IOexception in case of 404, so you never send back to your further code the response and the normally RestClientResponseException become a ResourceAccessException","body":"same, responseCopy.getBody() throw IOexception in case of 404, so you never send back to your further code the response and the normally RestClientResponseException become a ResourceAccessException"},{"owner":{"account_id":83518,"reputation":6215,"user_id":234110,"accept_rate":67,"display_name":"Anand Rockzz"},"score":1,"creation_date":1485684683,"post_id":35733521,"comment_id":71020441,"body_markdown":"You should check `status==200`, before `responseCopy.getBody()`","body":"You should check <code>status==200</code>, before <code>responseCopy.getBody()</code>"},{"owner":{"account_id":149896,"reputation":1052,"user_id":362721,"accept_rate":74,"display_name":"zbstof"},"score":4,"creation_date":1496320851,"post_id":35733521,"comment_id":75620812,"body_markdown":"But it&#39;s package-private. Did you put your LoggingRequestInterceptor in package &#39;org.springframework.http.client&#39;?","body":"But it&#39;s package-private. Did you put your LoggingRequestInterceptor in package &#39;org.springframework.http.client&#39;?"},{"owner":{"account_id":1827040,"reputation":3802,"user_id":1659451,"accept_rate":82,"display_name":"&#214;mer Faruk Almalı"},"score":2,"creation_date":1517666757,"post_id":35733521,"comment_id":84192884,"body_markdown":"what about `asyncRestTemplate`? It would require to return a `ListenableFuture` when you intercept it which is not possible to alter with `BufferingClientHttpResponseWrapper` in a callback.","body":"what about <code>asyncRestTemplate</code>? It would require to return a <code>ListenableFuture</code> when you intercept it which is not possible to alter with <code>BufferingClientHttpResponseWrapper</code> in a callback."},{"owner":{"account_id":2372918,"reputation":4836,"user_id":2077101,"accept_rate":64,"display_name":"James Watkins"},"score":0,"creation_date":1517844652,"post_id":35733521,"comment_id":84248713,"body_markdown":"@&#214;merFarukAlmalı In that case you will need to use chain or transform depending on the version of Guava you&#39;re using. See: https://stackoverflow.com/questions/8191891/is-it-possible-to-chain-async-calls-using-guava","body":"@&#214;merFarukAlmalı In that case you will need to use chain or transform depending on the version of Guava you&#39;re using. See: <a href=\"https://stackoverflow.com/questions/8191891/is-it-possible-to-chain-async-calls-using-guava\" title=\"is it possible to chain async calls using guava\">stackoverflow.com/questions/8191891/&hellip;</a>"},{"owner":{"account_id":317530,"reputation":2420,"user_id":634265,"display_name":"Tobias"},"score":0,"creation_date":1657004202,"post_id":35733521,"comment_id":128699829,"body_markdown":"Note that this library also uses a buffer to keep the response in memory, causing potential memory issues with large responses.","body":"Note that this library also uses a buffer to keep the response in memory, causing potential memory issues with large responses."}],"tags":[],"owner":{"account_id":2372918,"reputation":4836,"user_id":2077101,"accept_rate":64,"display_name":"James Watkins"},"comment_count":6,"down_vote_count":1,"up_vote_count":33,"is_accepted":false,"score":32,"last_activity_date":1474722967,"creation_date":1456866440,"answer_id":35733521,"question_id":7952154,"body_markdown":"None of these answers actually solve 100% of the problem. mjj1409 gets most of it, but conveniently avoids the issue of logging the response, which takes a bit more work. Paul Sabou provides a solution that seems realistic, but doesn&#39;t provide enough details to actually implement (and it didn&#39;t work at all for me). Sofiene got the logging but with a critical problem: the response is no longer readable because the input stream has already been consumed!\r\n\r\nI recommend using a BufferingClientHttpResponseWrapper to wrap the response object to allow reading the response body multiple times:\r\n\r\n    public class LoggingRequestInterceptor implements ClientHttpRequestInterceptor {\r\n\r\n        private static final Logger logger = LoggerFactory.getLogger(LoggingRequestInterceptor.class);\r\n\r\n        @Override\r\n        public ClientHttpResponse intercept(final HttpRequest request, final byte[] body,\r\n                final ClientHttpRequestExecution execution) throws IOException {\r\n            ClientHttpResponse response = execution.execute(request, body);\r\n\r\n            response = log(request, body, response);\r\n\r\n            return response;\r\n        }\r\n\r\n        private ClientHttpResponse log(final HttpRequest request, final byte[] body, final ClientHttpResponse response) {\r\n            final ClientHttpResponse responseCopy = new BufferingClientHttpResponseWrapper(response);\r\n            logger.debug(&quot;Method: &quot;, request.getMethod().toString());\r\n            logger.debug(&quot;URI: &quot;, , request.getURI().toString());\r\n            logger.debug(&quot;Request Body: &quot; + new String(body));\r\n            logger.debug(&quot;Response body: &quot; + IOUtils.toString(responseCopy.getBody()));\r\n            return responseCopy;\r\n        }\r\n\r\n    }\r\n\r\nThis will not consume the InputStream because the response body is loaded into memory and can be read multiple times. If you do not have the BufferingClientHttpResponseWrapper on your classpath, you can find the simple implementation here:\r\n\r\nhttps://github.com/spring-projects/spring-android/blob/master/spring-android-rest-template/src/main/java/org/springframework/http/client/BufferingClientHttpResponseWrapper.java\r\n\r\nFor setting up the RestTemplate:\r\n\r\n    LoggingRequestInterceptor loggingInterceptor = new LoggingRequestInterceptor();\r\n    restTemplate.getInterceptors().add(loggingInterceptor);","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>None of these answers actually solve 100% of the problem. mjj1409 gets most of it, but conveniently avoids the issue of logging the response, which takes a bit more work. Paul Sabou provides a solution that seems realistic, but doesn't provide enough details to actually implement (and it didn't work at all for me). Sofiene got the logging but with a critical problem: the response is no longer readable because the input stream has already been consumed!</p>\n\n<p>I recommend using a BufferingClientHttpResponseWrapper to wrap the response object to allow reading the response body multiple times:</p>\n\n<pre><code>public class LoggingRequestInterceptor implements ClientHttpRequestInterceptor {\n\n    private static final Logger logger = LoggerFactory.getLogger(LoggingRequestInterceptor.class);\n\n    @Override\n    public ClientHttpResponse intercept(final HttpRequest request, final byte[] body,\n            final ClientHttpRequestExecution execution) throws IOException {\n        ClientHttpResponse response = execution.execute(request, body);\n\n        response = log(request, body, response);\n\n        return response;\n    }\n\n    private ClientHttpResponse log(final HttpRequest request, final byte[] body, final ClientHttpResponse response) {\n        final ClientHttpResponse responseCopy = new BufferingClientHttpResponseWrapper(response);\n        logger.debug(\"Method: \", request.getMethod().toString());\n        logger.debug(\"URI: \", , request.getURI().toString());\n        logger.debug(\"Request Body: \" + new String(body));\n        logger.debug(\"Response body: \" + IOUtils.toString(responseCopy.getBody()));\n        return responseCopy;\n    }\n\n}\n</code></pre>\n\n<p>This will not consume the InputStream because the response body is loaded into memory and can be read multiple times. If you do not have the BufferingClientHttpResponseWrapper on your classpath, you can find the simple implementation here:</p>\n\n<p><a href=\"https://github.com/spring-projects/spring-android/blob/master/spring-android-rest-template/src/main/java/org/springframework/http/client/BufferingClientHttpResponseWrapper.java\">https://github.com/spring-projects/spring-android/blob/master/spring-android-rest-template/src/main/java/org/springframework/http/client/BufferingClientHttpResponseWrapper.java</a></p>\n\n<p>For setting up the RestTemplate:</p>\n\n<pre><code>LoggingRequestInterceptor loggingInterceptor = new LoggingRequestInterceptor();\nrestTemplate.getInterceptors().add(loggingInterceptor);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":97204,"reputation":4979,"user_id":263801,"accept_rate":74,"display_name":"Archie"},"comment_count":0,"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1459895344,"creation_date":1459895344,"answer_id":36438213,"question_id":7952154,"body_markdown":"The trick of configuring your `RestTemplate` with a `BufferingClientHttpRequestFactory` doesn&#39;t work if you are using any `ClientHttpRequestInterceptor`, which you will if you are trying to log via interceptors. This is due to the way that `InterceptingHttpAccessor` (which `RestTemplate` subclasses) works.\r\n\r\nLong story short... just use this class in place of `RestTemplate` (note this uses the SLF4J logging API, edit as needed):\r\n\r\n    import java.io.ByteArrayOutputStream;\r\n    import java.io.IOException;\r\n    import java.io.InputStream;\r\n    import java.lang.reflect.Constructor;\r\n    import java.nio.charset.StandardCharsets;\r\n    import java.util.List;\r\n    import java.util.Map;\r\n    \r\n    import javax.annotation.PostConstruct;\r\n    \r\n    import org.slf4j.Logger;\r\n    import org.slf4j.LoggerFactory;\r\n    import org.springframework.http.HttpHeaders;\r\n    import org.springframework.http.HttpRequest;\r\n    import org.springframework.http.HttpStatus;\r\n    import org.springframework.http.client.ClientHttpRequestExecution;\r\n    import org.springframework.http.client.ClientHttpRequestInterceptor;\r\n    import org.springframework.http.client.ClientHttpResponse;\r\n    import org.springframework.web.client.RestTemplate;\r\n    \r\n    /**\r\n     * A {@link RestTemplate} that logs every request and response.\r\n     */\r\n    public class LoggingRestTemplate extends RestTemplate {\r\n    \r\n        // Bleh, this class is not public\r\n        private static final String RESPONSE_WRAPPER_CLASS = &quot;org.springframework.http.client.BufferingClientHttpResponseWrapper&quot;;\r\n    \r\n        private Logger log = LoggerFactory.getLogger(this.getClass());\r\n    \r\n        private boolean hideAuthorizationHeaders = true;\r\n        private Class&lt;?&gt; wrapperClass;\r\n        private Constructor&lt;?&gt; wrapperConstructor;\r\n    \r\n        /**\r\n         * Configure the logger to log requests and responses to.\r\n         *\r\n         * @param log log destination, or null to disable\r\n         */\r\n        public void setLogger(Logger log) {\r\n            this.log = log;\r\n        }\r\n    \r\n        /**\r\n         * Configure the logger to log requests and responses to by name.\r\n         *\r\n         * @param name name of the log destination, or null to disable\r\n         */\r\n        public void setLoggerName(String name) {\r\n            this.setLogger(name != null ? LoggerFactory.getLogger(name) : null);\r\n        }\r\n    \r\n        /**\r\n         * Configure whether to hide the contents of {@code Authorization} headers.\r\n         *\r\n         * &lt;p&gt;\r\n         * Default true.\r\n         *\r\n         * @param hideAuthorizationHeaders true to hide, otherwise false\r\n         */\r\n        public void setHideAuthorizationHeaders(boolean hideAuthorizationHeaders) {\r\n            this.hideAuthorizationHeaders = hideAuthorizationHeaders;\r\n        }\r\n    \r\n        /**\r\n         * Log a request.\r\n         */\r\n        protected void traceRequest(HttpRequest request, byte[] body) {\r\n            this.log.debug(&quot;xmit: {} {}\\n{}{}&quot;, request.getMethod(), request.getURI(), this.toString(request.getHeaders()),\r\n              body != null &amp;&amp; body.length &gt; 0 ? &quot;\\n\\n&quot; + new String(body, StandardCharsets.UTF_8) : &quot;&quot;);\r\n        }\r\n    \r\n        /**\r\n         * Log a response.\r\n         */\r\n        protected void traceResponse(ClientHttpResponse response) {\r\n            final ByteArrayOutputStream bodyBuf = new ByteArrayOutputStream();\r\n            HttpStatus statusCode = null;\r\n            try {\r\n                statusCode = response.getStatusCode();\r\n            } catch (IOException e) {\r\n                // ignore\r\n            }\r\n            String statusText = null;\r\n            try {\r\n                statusText = response.getStatusText();\r\n            } catch (IOException e) {\r\n                // ignore\r\n            }\r\n            try (final InputStream input = response.getBody()) {\r\n                byte[] b = new byte[1024];\r\n                int r;\r\n                while ((r = input.read(b)) != -1)\r\n                    bodyBuf.write(b, 0, r);\r\n            } catch (IOException e) {\r\n                // ignore\r\n            }\r\n            this.log.debug(&quot;recv: {} {}\\n{}{}&quot;, statusCode, statusText, this.toString(response.getHeaders()),\r\n              bodyBuf.size() &gt; 0 ? &quot;\\n\\n&quot; + new String(bodyBuf.toByteArray(), StandardCharsets.UTF_8) : &quot;&quot;);\r\n        }\r\n    \r\n        @PostConstruct\r\n        private void addLoggingInterceptor() {\r\n            this.getInterceptors().add(new ClientHttpRequestInterceptor() {\r\n                @Override\r\n                public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution)\r\n                  throws IOException {\r\n    \r\n                    // Log request\r\n                    if (LoggingRestTemplate.this.log != null &amp;&amp; LoggingRestTemplate.this.log.isDebugEnabled())\r\n                        LoggingRestTemplate.this.traceRequest(request, body);\r\n    \r\n                    // Perform request\r\n                    ClientHttpResponse response = execution.execute(request, body);\r\n    \r\n                    // Log response\r\n                    if (LoggingRestTemplate.this.log != null &amp;&amp; LoggingRestTemplate.this.log.isDebugEnabled()) {\r\n                        final ClientHttpResponse bufferedResponse = LoggingRestTemplate.this.ensureBuffered(response);\r\n                        if (bufferedResponse != null) {\r\n                            LoggingRestTemplate.this.traceResponse(bufferedResponse);\r\n                            response = bufferedResponse;\r\n                        }\r\n                    }\r\n    \r\n                    // Done\r\n                    return response;\r\n                }\r\n            });\r\n        }\r\n    \r\n        private ClientHttpResponse ensureBuffered(ClientHttpResponse response) {\r\n            try {\r\n                if (this.wrapperClass == null)\r\n                    this.wrapperClass = Class.forName(RESPONSE_WRAPPER_CLASS, false, ClientHttpResponse.class.getClassLoader());\r\n                if (!this.wrapperClass.isInstance(response)) {\r\n                    if (this.wrapperConstructor == null) {\r\n                        this.wrapperConstructor = this.wrapperClass.getDeclaredConstructor(ClientHttpResponse.class);\r\n                        this.wrapperConstructor.setAccessible(true);\r\n                    }\r\n                    response = (ClientHttpResponse)this.wrapperConstructor.newInstance(response);\r\n                }\r\n                return response;\r\n            } catch (Exception e) {\r\n                this.log.error(&quot;error creating {} instance: {}&quot;, RESPONSE_WRAPPER_CLASS, e);\r\n                return null;\r\n            }\r\n        }\r\n    \r\n        private String toString(HttpHeaders headers) {\r\n            final StringBuilder headerBuf = new StringBuilder();\r\n            for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : headers.entrySet()) {\r\n                if (headerBuf.length() &gt; 0)\r\n                    headerBuf.append(&#39;\\n&#39;);\r\n                final String name = entry.getKey();\r\n                for (String value : entry.getValue()) {\r\n                    if (this.hideAuthorizationHeaders &amp;&amp; name.equalsIgnoreCase(HttpHeaders.AUTHORIZATION))\r\n                        value = &quot;[omitted]&quot;;\r\n                    headerBuf.append(name).append(&quot;: &quot;).append(value);\r\n                }\r\n            }\r\n            return headerBuf.toString();\r\n        }\r\n    }\r\n\r\nI agree it&#39;s silly that it takes this much work just to do this.","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>The trick of configuring your <code>RestTemplate</code> with a <code>BufferingClientHttpRequestFactory</code> doesn't work if you are using any <code>ClientHttpRequestInterceptor</code>, which you will if you are trying to log via interceptors. This is due to the way that <code>InterceptingHttpAccessor</code> (which <code>RestTemplate</code> subclasses) works.</p>\n\n<p>Long story short... just use this class in place of <code>RestTemplate</code> (note this uses the SLF4J logging API, edit as needed):</p>\n\n<pre><code>import java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.lang.reflect.Constructor;\nimport java.nio.charset.StandardCharsets;\nimport java.util.List;\nimport java.util.Map;\n\nimport javax.annotation.PostConstruct;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.http.HttpHeaders;\nimport org.springframework.http.HttpRequest;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.client.ClientHttpRequestExecution;\nimport org.springframework.http.client.ClientHttpRequestInterceptor;\nimport org.springframework.http.client.ClientHttpResponse;\nimport org.springframework.web.client.RestTemplate;\n\n/**\n * A {@link RestTemplate} that logs every request and response.\n */\npublic class LoggingRestTemplate extends RestTemplate {\n\n    // Bleh, this class is not public\n    private static final String RESPONSE_WRAPPER_CLASS = \"org.springframework.http.client.BufferingClientHttpResponseWrapper\";\n\n    private Logger log = LoggerFactory.getLogger(this.getClass());\n\n    private boolean hideAuthorizationHeaders = true;\n    private Class&lt;?&gt; wrapperClass;\n    private Constructor&lt;?&gt; wrapperConstructor;\n\n    /**\n     * Configure the logger to log requests and responses to.\n     *\n     * @param log log destination, or null to disable\n     */\n    public void setLogger(Logger log) {\n        this.log = log;\n    }\n\n    /**\n     * Configure the logger to log requests and responses to by name.\n     *\n     * @param name name of the log destination, or null to disable\n     */\n    public void setLoggerName(String name) {\n        this.setLogger(name != null ? LoggerFactory.getLogger(name) : null);\n    }\n\n    /**\n     * Configure whether to hide the contents of {@code Authorization} headers.\n     *\n     * &lt;p&gt;\n     * Default true.\n     *\n     * @param hideAuthorizationHeaders true to hide, otherwise false\n     */\n    public void setHideAuthorizationHeaders(boolean hideAuthorizationHeaders) {\n        this.hideAuthorizationHeaders = hideAuthorizationHeaders;\n    }\n\n    /**\n     * Log a request.\n     */\n    protected void traceRequest(HttpRequest request, byte[] body) {\n        this.log.debug(\"xmit: {} {}\\n{}{}\", request.getMethod(), request.getURI(), this.toString(request.getHeaders()),\n          body != null &amp;&amp; body.length &gt; 0 ? \"\\n\\n\" + new String(body, StandardCharsets.UTF_8) : \"\");\n    }\n\n    /**\n     * Log a response.\n     */\n    protected void traceResponse(ClientHttpResponse response) {\n        final ByteArrayOutputStream bodyBuf = new ByteArrayOutputStream();\n        HttpStatus statusCode = null;\n        try {\n            statusCode = response.getStatusCode();\n        } catch (IOException e) {\n            // ignore\n        }\n        String statusText = null;\n        try {\n            statusText = response.getStatusText();\n        } catch (IOException e) {\n            // ignore\n        }\n        try (final InputStream input = response.getBody()) {\n            byte[] b = new byte[1024];\n            int r;\n            while ((r = input.read(b)) != -1)\n                bodyBuf.write(b, 0, r);\n        } catch (IOException e) {\n            // ignore\n        }\n        this.log.debug(\"recv: {} {}\\n{}{}\", statusCode, statusText, this.toString(response.getHeaders()),\n          bodyBuf.size() &gt; 0 ? \"\\n\\n\" + new String(bodyBuf.toByteArray(), StandardCharsets.UTF_8) : \"\");\n    }\n\n    @PostConstruct\n    private void addLoggingInterceptor() {\n        this.getInterceptors().add(new ClientHttpRequestInterceptor() {\n            @Override\n            public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution)\n              throws IOException {\n\n                // Log request\n                if (LoggingRestTemplate.this.log != null &amp;&amp; LoggingRestTemplate.this.log.isDebugEnabled())\n                    LoggingRestTemplate.this.traceRequest(request, body);\n\n                // Perform request\n                ClientHttpResponse response = execution.execute(request, body);\n\n                // Log response\n                if (LoggingRestTemplate.this.log != null &amp;&amp; LoggingRestTemplate.this.log.isDebugEnabled()) {\n                    final ClientHttpResponse bufferedResponse = LoggingRestTemplate.this.ensureBuffered(response);\n                    if (bufferedResponse != null) {\n                        LoggingRestTemplate.this.traceResponse(bufferedResponse);\n                        response = bufferedResponse;\n                    }\n                }\n\n                // Done\n                return response;\n            }\n        });\n    }\n\n    private ClientHttpResponse ensureBuffered(ClientHttpResponse response) {\n        try {\n            if (this.wrapperClass == null)\n                this.wrapperClass = Class.forName(RESPONSE_WRAPPER_CLASS, false, ClientHttpResponse.class.getClassLoader());\n            if (!this.wrapperClass.isInstance(response)) {\n                if (this.wrapperConstructor == null) {\n                    this.wrapperConstructor = this.wrapperClass.getDeclaredConstructor(ClientHttpResponse.class);\n                    this.wrapperConstructor.setAccessible(true);\n                }\n                response = (ClientHttpResponse)this.wrapperConstructor.newInstance(response);\n            }\n            return response;\n        } catch (Exception e) {\n            this.log.error(\"error creating {} instance: {}\", RESPONSE_WRAPPER_CLASS, e);\n            return null;\n        }\n    }\n\n    private String toString(HttpHeaders headers) {\n        final StringBuilder headerBuf = new StringBuilder();\n        for (Map.Entry&lt;String, List&lt;String&gt;&gt; entry : headers.entrySet()) {\n            if (headerBuf.length() &gt; 0)\n                headerBuf.append('\\n');\n            final String name = entry.getKey();\n            for (String value : entry.getValue()) {\n                if (this.hideAuthorizationHeaders &amp;&amp; name.equalsIgnoreCase(HttpHeaders.AUTHORIZATION))\n                    value = \"[omitted]\";\n                headerBuf.append(name).append(\": \").append(value);\n            }\n        }\n        return headerBuf.toString();\n    }\n}\n</code></pre>\n\n<p>I agree it's silly that it takes this much work just to do this.</p>\n"},{"tags":[],"owner":{"account_id":1406827,"reputation":1134,"user_id":1334305,"accept_rate":29,"display_name":"user666"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1460036608,"creation_date":1460036608,"answer_id":36478051,"question_id":7952154,"body_markdown":"Adding to above discussion this only represents Happy scenarios. probably you will not be able to log the response if an **Error** comes .\r\n\r\nIn this case plus all the cases above you must override **DefaultResponseErrorHandler** and set it like below \r\n\r\n    restTemplate.setErrorHandler(new DefaultResponseErrorHandlerImpl());\r\n\r\n","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Adding to above discussion this only represents Happy scenarios. probably you will not be able to log the response if an <strong>Error</strong> comes .</p>\n\n<p>In this case plus all the cases above you must override <strong>DefaultResponseErrorHandler</strong> and set it like below </p>\n\n<pre><code>restTemplate.setErrorHandler(new DefaultResponseErrorHandlerImpl());\n</code></pre>\n"},{"comments":[{"owner":{"account_id":3071475,"reputation":371,"user_id":2602034,"accept_rate":36,"display_name":"dve"},"score":7,"creation_date":1467726792,"post_id":38185706,"comment_id":63834464,"body_markdown":"This is not logging the request and response body, just the url and request type (spring-web-4.2.6)","body":"This is not logging the request and response body, just the url and request type (spring-web-4.2.6)"},{"owner":{"account_id":273794,"reputation":3600,"user_id":565637,"accept_rate":76,"display_name":"gamliela"},"score":1,"creation_date":1467729471,"post_id":38185706,"comment_id":63836459,"body_markdown":"You are right, it is not a `wire` logging, it only includes essential information like url, resepone code, POST parameters etc.","body":"You are right, it is not a <code>wire</code> logging, it only includes essential information like url, resepone code, POST parameters etc."},{"owner":{"account_id":71353,"reputation":16394,"user_id":206466,"accept_rate":70,"display_name":"xenoterracide"},"score":1,"creation_date":1471983064,"post_id":38185706,"comment_id":65567085,"body_markdown":"what you really want is this http://stackoverflow.com/a/39109538/206466","body":"what you really want is this <a href=\"http://stackoverflow.com/a/39109538/206466\">stackoverflow.com/a/39109538/206466</a>"},{"owner":{"account_id":1951203,"reputation":10695,"user_id":1755242,"accept_rate":80,"display_name":"sunleo"},"score":0,"creation_date":1503037575,"post_id":38185706,"comment_id":78456861,"body_markdown":"This is fine but response body could not be seen!","body":"This is fine but response body could not be seen!"},{"owner":{"account_id":141852,"reputation":4322,"user_id":349169,"accept_rate":78,"display_name":"Chris"},"score":0,"creation_date":1564329168,"post_id":38185706,"comment_id":100986032,"body_markdown":"Brilliant. Although it doesn&#39;t print the response body, it&#39;s still very useful. Thank You.","body":"Brilliant. Although it doesn&#39;t print the response body, it&#39;s still very useful. Thank You."},{"owner":{"account_id":2697635,"reputation":1299,"user_id":2329241,"accept_rate":67,"display_name":"Narendra Jaggi"},"score":0,"creation_date":1601479688,"post_id":38185706,"comment_id":113422752,"body_markdown":"will it print headers as well","body":"will it print headers as well"}],"tags":[],"owner":{"account_id":273794,"reputation":3600,"user_id":565637,"accept_rate":76,"display_name":"gamliela"},"comment_count":6,"down_vote_count":3,"up_vote_count":52,"is_accepted":false,"score":49,"last_activity_date":1467639276,"creation_date":1467638120,"answer_id":38185706,"question_id":7952154,"body_markdown":"Your best bet is to add `logging.level.org.springframework.web.client.RestTemplate=DEBUG` to the `application.properties` file.\r\n\r\nOther solutions like setting `log4j.logger.httpclient.wire` will not always work because they assume you use `log4j` and Apache `HttpClient`, which is not always true.\r\n\r\nNote, however, that this syntax will work only on latest versions of Spring Boot.","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Your best bet is to add <code>logging.level.org.springframework.web.client.RestTemplate=DEBUG</code> to the <code>application.properties</code> file.</p>\n\n<p>Other solutions like setting <code>log4j.logger.httpclient.wire</code> will not always work because they assume you use <code>log4j</code> and Apache <code>HttpClient</code>, which is not always true.</p>\n\n<p>Note, however, that this syntax will work only on latest versions of Spring Boot.</p>\n"},{"comments":[{"owner":{"account_id":43738,"reputation":1059,"user_id":127977,"accept_rate":40,"display_name":"michaelavila"},"score":6,"creation_date":1480533424,"post_id":39109538,"comment_id":69006656,"body_markdown":"This was the simplest thing that did what I wanted. I highly encourage including this in the accepted answer.","body":"This was the simplest thing that did what I wanted. I highly encourage including this in the accepted answer."},{"owner":{"account_id":2021629,"reputation":57953,"user_id":1807667,"accept_rate":60,"display_name":"Ortomala Lokni"},"score":26,"creation_date":1485960042,"post_id":39109538,"comment_id":71142622,"body_markdown":"According to the javadoc of [RestTemplate](http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html) : `by default the RestTemplate relies on standard JDK facilities to establish HTTP connections. You can switch to use a different HTTP library such as Apache HttpComponents`","body":"According to the javadoc of <a href=\"http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html\" rel=\"nofollow noreferrer\">RestTemplate</a> : <code>by default the RestTemplate relies on standard JDK facilities to establish HTTP connections. You can switch to use a different HTTP library such as Apache HttpComponents</code>"},{"owner":{"account_id":2087834,"reputation":7167,"user_id":1858327,"accept_rate":71,"display_name":"Captain Man"},"score":26,"creation_date":1493667281,"post_id":39109538,"comment_id":74494223,"body_markdown":"RestTemplate doesn&#39;t use these Apache classes be default, as pointed out by @OrtomalaLokni, so you should also include *how* to use them in addition to how to print the debug when they are being used.","body":"RestTemplate doesn&#39;t use these Apache classes be default, as pointed out by @OrtomalaLokni, so you should also include <i>how</i> to use them in addition to how to print the debug when they are being used."},{"owner":{"account_id":6371269,"reputation":11056,"user_id":4943598,"accept_rate":88,"display_name":"Partha Sarathi Ghosh"},"score":0,"creation_date":1534844216,"post_id":39109538,"comment_id":90840821,"body_markdown":"I am getting like this : `http-outgoing-0 &lt;&lt; &quot;[0x1f][0x8b][0x8][0x0][0x0][0x0][0x0][0x0]`","body":"I am getting like this : <code>http-outgoing-0 &lt;&lt; &quot;[0x1f][0x8b][0x8][0x0][0x0][0x0][0x0][0x0]</code>"},{"owner":{"account_id":88507,"reputation":4193,"user_id":244744,"accept_rate":33,"display_name":"Matthew Buckett"},"score":2,"creation_date":1548070402,"post_id":39109538,"comment_id":95398890,"body_markdown":"@ParthaSarathiGhosh The content is probably gzip encoded which is why you&#39;re not seeing the raw text.","body":"@ParthaSarathiGhosh The content is probably gzip encoded which is why you&#39;re not seeing the raw text."},{"owner":{"account_id":1480499,"reputation":2636,"user_id":1390015,"display_name":"tbraun"},"score":2,"creation_date":1561631728,"post_id":39109538,"comment_id":100132488,"body_markdown":"This simple solution works if your app is configured to use Apache","body":"This simple solution works if your app is configured to use Apache"},{"owner":{"account_id":7247002,"reputation":495,"user_id":5528589,"display_name":"moussesj94"},"score":0,"creation_date":1598314278,"post_id":39109538,"comment_id":112412482,"body_markdown":"How should I use this if I using spring 4","body":"How should I use this if I using spring 4"},{"owner":{"account_id":8986718,"reputation":2467,"user_id":6700081,"accept_rate":73,"display_name":"firstpostcommenter"},"score":0,"creation_date":1608734854,"post_id":39109538,"comment_id":115670464,"body_markdown":"In my case, each field of the request seems to be printing in a separate line... not sure why","body":"In my case, each field of the request seems to be printing in a separate line... not sure why"},{"owner":{"account_id":61884,"reputation":22496,"user_id":184184,"accept_rate":67,"display_name":"Raj"},"score":1,"creation_date":1625371814,"post_id":39109538,"comment_id":120607724,"body_markdown":"Is there a way log only the request body and not the response?","body":"Is there a way log only the request body and not the response?"}],"tags":[],"owner":{"account_id":71353,"reputation":16394,"user_id":206466,"accept_rate":70,"display_name":"xenoterracide"},"comment_count":9,"down_vote_count":9,"up_vote_count":182,"is_accepted":false,"score":173,"last_activity_date":1471983102,"creation_date":1471981700,"answer_id":39109538,"question_id":7952154,"body_markdown":"in Spring Boot you can get the full request/response by setting this in properties (or other 12 factor method)\r\n\r\n    logging.level.org.apache.http=DEBUG\r\n\r\nthis outputs\r\n\r\n    -DEBUG .i.c.DefaultHttpClientConnectionOperator : Connecting to localhost/127.0.0.1:41827\r\n    -DEBUG .i.c.DefaultHttpClientConnectionOperator : Connection established 127.0.0.1:39546&lt;-&gt;127.0.0.1:41827\r\n    -DEBUG o.a.http.impl.execchain.MainClientExec   : Executing request POST /v0/users HTTP/1.1\r\n    -DEBUG o.a.http.impl.execchain.MainClientExec   : Target auth state: UNCHALLENGED\r\n    -DEBUG o.a.http.impl.execchain.MainClientExec   : Proxy auth state: UNCHALLENGED\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; POST /v0/users HTTP/1.1\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Content-Type: application/json;charset=UTF-8\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Content-Length: 56\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Host: localhost:41827\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Connection: Keep-Alive\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; User-Agent: Apache-HttpClient/4.5.2 (Java/1.8.0_102)\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Accept-Encoding: gzip,deflate\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;POST /v0/users HTTP/1.1[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Content-Type: application/json;charset=UTF-8[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Content-Length: 56[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Host: localhost:41827[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Connection: Keep-Alive[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;User-Agent: Apache-HttpClient/4.5.2 (Java/1.8.0_102)[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Accept-Encoding: gzip,deflate[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;{&quot;id&quot;:null,&quot;email&quot;:&quot;xenoterracide@gmail.com&quot;,&quot;new&quot;:true}&quot;\r\n\r\nand response\r\n\r\n    -DEBUG .i.c.DefaultHttpClientConnectionOperator : Connecting to localhost/127.0.0.1:41827\r\n    -DEBUG .i.c.DefaultHttpClientConnectionOperator : Connection established 127.0.0.1:39546&lt;-&gt;127.0.0.1:41827\r\n    -DEBUG o.a.http.impl.execchain.MainClientExec   : Executing request POST /v0/users HTTP/1.1\r\n    -DEBUG o.a.http.impl.execchain.MainClientExec   : Target auth state: UNCHALLENGED\r\n    -DEBUG o.a.http.impl.execchain.MainClientExec   : Proxy auth state: UNCHALLENGED\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; POST /v0/users HTTP/1.1\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Content-Type: application/json;charset=UTF-8\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Content-Length: 56\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Host: localhost:41827\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Connection: Keep-Alive\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; User-Agent: Apache-HttpClient/4.5.2 (Java/1.8.0_102)\r\n    -DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Accept-Encoding: gzip,deflate\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;POST /v0/users HTTP/1.1[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Content-Type: application/json;charset=UTF-8[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Content-Length: 56[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Host: localhost:41827[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Connection: Keep-Alive[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;User-Agent: Apache-HttpClient/4.5.2 (Java/1.8.0_102)[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Accept-Encoding: gzip,deflate[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;[\\r][\\n]&quot;\r\n    -DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;{&quot;id&quot;:null,&quot;email&quot;:&quot;xenoterracide@gmail.com&quot;,&quot;new&quot;:true}&quot;\r\n\r\nor just `logging.level.org.apache.http.wire=DEBUG` which seems to contain all of the relevant information\r\n","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>in Spring Boot you can get the full request/response by setting this in properties (or other 12 factor method)</p>\n\n<pre><code>logging.level.org.apache.http=DEBUG\n</code></pre>\n\n<p>this outputs</p>\n\n<pre><code>-DEBUG .i.c.DefaultHttpClientConnectionOperator : Connecting to localhost/127.0.0.1:41827\n-DEBUG .i.c.DefaultHttpClientConnectionOperator : Connection established 127.0.0.1:39546&lt;-&gt;127.0.0.1:41827\n-DEBUG o.a.http.impl.execchain.MainClientExec   : Executing request POST /v0/users HTTP/1.1\n-DEBUG o.a.http.impl.execchain.MainClientExec   : Target auth state: UNCHALLENGED\n-DEBUG o.a.http.impl.execchain.MainClientExec   : Proxy auth state: UNCHALLENGED\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; POST /v0/users HTTP/1.1\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Content-Type: application/json;charset=UTF-8\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Content-Length: 56\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Host: localhost:41827\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Connection: Keep-Alive\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; User-Agent: Apache-HttpClient/4.5.2 (Java/1.8.0_102)\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Accept-Encoding: gzip,deflate\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"POST /v0/users HTTP/1.1[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"Content-Type: application/json;charset=UTF-8[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"Content-Length: 56[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"Host: localhost:41827[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"Connection: Keep-Alive[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"User-Agent: Apache-HttpClient/4.5.2 (Java/1.8.0_102)[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"Accept-Encoding: gzip,deflate[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"{\"id\":null,\"email\":\"xenoterracide@gmail.com\",\"new\":true}\"\n</code></pre>\n\n<p>and response</p>\n\n<pre><code>-DEBUG .i.c.DefaultHttpClientConnectionOperator : Connecting to localhost/127.0.0.1:41827\n-DEBUG .i.c.DefaultHttpClientConnectionOperator : Connection established 127.0.0.1:39546&lt;-&gt;127.0.0.1:41827\n-DEBUG o.a.http.impl.execchain.MainClientExec   : Executing request POST /v0/users HTTP/1.1\n-DEBUG o.a.http.impl.execchain.MainClientExec   : Target auth state: UNCHALLENGED\n-DEBUG o.a.http.impl.execchain.MainClientExec   : Proxy auth state: UNCHALLENGED\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; POST /v0/users HTTP/1.1\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Content-Type: application/json;charset=UTF-8\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Content-Length: 56\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Host: localhost:41827\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Connection: Keep-Alive\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; User-Agent: Apache-HttpClient/4.5.2 (Java/1.8.0_102)\n-DEBUG org.apache.http.headers                  : http-outgoing-0 &gt;&gt; Accept-Encoding: gzip,deflate\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"POST /v0/users HTTP/1.1[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"Content-Type: application/json;charset=UTF-8[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"Content-Length: 56[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"Host: localhost:41827[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"Connection: Keep-Alive[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"User-Agent: Apache-HttpClient/4.5.2 (Java/1.8.0_102)[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"Accept-Encoding: gzip,deflate[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"[\\r][\\n]\"\n-DEBUG org.apache.http.wire                     : http-outgoing-0 &gt;&gt; \"{\"id\":null,\"email\":\"xenoterracide@gmail.com\",\"new\":true}\"\n</code></pre>\n\n<p>or just <code>logging.level.org.apache.http.wire=DEBUG</code> which seems to contain all of the relevant information</p>\n"},{"comments":[{"owner":{"account_id":6409849,"reputation":295,"user_id":4969960,"display_name":"Gervasio Amy"},"score":0,"creation_date":1505915205,"post_id":41732816,"comment_id":79608375,"body_markdown":"trace logging might be too much verbose... what if there&#39;s thousands of requests per second??","body":"trace logging might be too much verbose... what if there&#39;s thousands of requests per second??"}],"tags":[],"owner":{"account_id":9516325,"reputation":1,"user_id":7072565,"display_name":"danshijin"},"comment_count":1,"down_vote_count":3,"up_vote_count":0,"is_accepted":false,"score":-3,"last_activity_date":1484793416,"creation_date":1484793416,"answer_id":41732816,"question_id":7952154,"body_markdown":"my logger config used xml\r\n\r\n    &lt;logger name=&quot;org.springframework.web.client.RestTemplate&quot;&gt;\r\n        &lt;level value=&quot;trace&quot;/&gt;\r\n    &lt;/logger&gt;\r\n\r\n\r\nthen you will get something like below:\r\n\r\n    DEBUG org.springframework.web.client.HttpMessageConverterExtractor.extractData(HttpMessageConverterExtractor.java:92) : Reading [com.test.java.MyClass] as &quot;application/json&quot; using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@604525f1]\r\n\r\nthrough HttpMessageConverterExtractor.java:92,you need continue to debug,and in my case,i got this:\r\n\r\n    genericMessageConverter.write(requestBody, requestBodyType, requestContentType, httpRequest);\r\nand this:\r\n\r\n    outputMessage.getBody().flush();\r\noutputMessage.getBody() contains the message http(post type) sends\r\n","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>my logger config used xml</p>\n\n<pre><code>&lt;logger name=\"org.springframework.web.client.RestTemplate\"&gt;\n    &lt;level value=\"trace\"/&gt;\n&lt;/logger&gt;\n</code></pre>\n\n<p>then you will get something like below:</p>\n\n<pre><code>DEBUG org.springframework.web.client.HttpMessageConverterExtractor.extractData(HttpMessageConverterExtractor.java:92) : Reading [com.test.java.MyClass] as \"application/json\" using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@604525f1]\n</code></pre>\n\n<p>through HttpMessageConverterExtractor.java:92,you need continue to debug,and in my case,i got this:</p>\n\n<pre><code>genericMessageConverter.write(requestBody, requestBodyType, requestContentType, httpRequest);\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>outputMessage.getBody().flush();\n</code></pre>\n\n<p>outputMessage.getBody() contains the message http(post type) sends</p>\n"},{"comments":[{"owner":{"account_id":149896,"reputation":1052,"user_id":362721,"accept_rate":74,"display_name":"zbstof"},"score":0,"creation_date":1496323254,"post_id":41983744,"comment_id":75622656,"body_markdown":"Easiest way, I&#39;ll only add that it doesn&#39;t work with MockRestServiceServer, as it overwrites requestFactory.","body":"Easiest way, I&#39;ll only add that it doesn&#39;t work with MockRestServiceServer, as it overwrites requestFactory."},{"owner":{"account_id":1951203,"reputation":10695,"user_id":1755242,"accept_rate":80,"display_name":"sunleo"},"score":1,"creation_date":1503038850,"post_id":41983744,"comment_id":78457553,"body_markdown":"Working well and no issues less config !","body":"Working well and no issues less config !"}],"tags":[],"owner":{"account_id":2021629,"reputation":57953,"user_id":1807667,"accept_rate":60,"display_name":"Ortomala Lokni"},"comment_count":2,"down_vote_count":0,"up_vote_count":33,"is_accepted":false,"score":33,"last_activity_date":1485963531,"creation_date":1485963531,"answer_id":41983744,"question_id":7952154,"body_markdown":"The solution given by xenoterracide to use\r\n\r\n    logging.level.org.apache.http=DEBUG\r\nis good but the problem is that by default Apache HttpComponents is not used.\r\n\r\nTo use Apache HttpComponents add to your pom.xml\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\r\n        &lt;artifactId&gt;httpasyncclient&lt;/artifactId&gt;\r\n    &lt;/dependency&gt;\r\n\r\nand configure [`RestTemplate`](http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html) with :\r\n\r\n    RestTemplate restTemplate = new RestTemplate();\r\n    restTemplate.setRequestFactory(new HttpComponentsAsyncClientHttpRequestFactory());","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>The solution given by xenoterracide to use</p>\n\n<pre><code>logging.level.org.apache.http=DEBUG\n</code></pre>\n\n<p>is good but the problem is that by default Apache HttpComponents is not used.</p>\n\n<p>To use Apache HttpComponents add to your pom.xml</p>\n\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\n    &lt;artifactId&gt;httpasyncclient&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>and configure <a href=\"http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html\" rel=\"noreferrer\"><code>RestTemplate</code></a> with :</p>\n\n<pre><code>RestTemplate restTemplate = new RestTemplate();\nrestTemplate.setRequestFactory(new HttpComponentsAsyncClientHttpRequestFactory());\n</code></pre>\n"},{"comments":[{"owner":{"account_id":279921,"reputation":7224,"user_id":575350,"accept_rate":91,"display_name":"qwazer"},"score":0,"creation_date":1503396698,"post_id":45812721,"comment_id":78587047,"body_markdown":"what is the released version?","body":"what is the released version?"},{"owner":{"account_id":11602307,"reputation":1,"user_id":8499057,"display_name":"Moses Meyer"},"score":0,"creation_date":1503580246,"post_id":45812721,"comment_id":78683201,"body_markdown":"released version now is 0.2","body":"released version now is 0.2"},{"owner":{"account_id":1497205,"reputation":1673,"user_id":1402861,"accept_rate":60,"display_name":"WrRaThY"},"score":1,"creation_date":1513258149,"post_id":45812721,"comment_id":82590397,"body_markdown":"ease of use is great, but it lacks headers","body":"ease of use is great, but it lacks headers"},{"owner":{"account_id":1497205,"reputation":1673,"user_id":1402861,"accept_rate":60,"display_name":"WrRaThY"},"score":0,"creation_date":1513258432,"post_id":45812721,"comment_id":82590583,"body_markdown":"additionally: all useful methods in LoggingRequestInterceptor are private, which is a problem when it comes to extension (could be protected)","body":"additionally: all useful methods in LoggingRequestInterceptor are private, which is a problem when it comes to extension (could be protected)"},{"owner":{"account_id":1497205,"reputation":1673,"user_id":1402861,"accept_rate":60,"display_name":"WrRaThY"},"score":0,"creation_date":1513259433,"post_id":45812721,"comment_id":82591247,"body_markdown":"sadly, I can&#39;t edit comments after 5 minutes. All you have to do to log headers is this: `log(&quot;Headers: {}&quot;, request.headers)` in `LoggingRequestInterceptor:traceRequest` and `log(&quot;Headers: {}&quot;, response.headers)` in `LoggingRequestInterceptor:logResponse`. You might want to think about adding some flags for logging headers and body. Also - you may want to check body content type for logging (for example log only application/json*). This should be also configurable.\nall in all, with those little tweaks you&#39;ll have a nice library to spread. good work :)","body":"sadly, I can&#39;t edit comments after 5 minutes. All you have to do to log headers is this: <code>log(&quot;Headers: {}&quot;, request.headers)</code> in <code>LoggingRequestInterceptor:traceRequest</code> and <code>log(&quot;Headers: {}&quot;, response.headers)</code> in <code>LoggingRequestInterceptor:logResponse</code>. You might want to think about adding some flags for logging headers and body. Also - you may want to check body content type for logging (for example log only application/json*). This should be also configurable. all in all, with those little tweaks you&#39;ll have a nice library to spread. good work :)"}],"tags":[],"owner":{"account_id":11602307,"reputation":1,"user_id":8499057,"display_name":"Moses Meyer"},"comment_count":5,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1503580370,"creation_date":1503390901,"answer_id":45812721,"question_id":7952154,"body_markdown":"Best solution now, just add dependency :\r\n\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;com.github.zg2pro&lt;/groupId&gt;\r\n      &lt;artifactId&gt;spring-rest-basis&lt;/artifactId&gt;\r\n      &lt;version&gt;v.x&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nIt contains a LoggingRequestInterceptor class you can add that way to your RestTemplate:\r\n\r\nintegrate this utility by adding it as an interceptor to a spring RestTemplate, in the following manner:\r\n\r\n    restTemplate.setRequestFactory(LoggingRequestFactoryFactory.build());\r\n\r\nand add an slf4j implementation to your framework like log4j.\r\n\r\nor **directly use &quot;Zg2proRestTemplate&quot;**. The &quot;best answer&quot; by @PaulSabou looks so so, since httpclient and all apache.http libs are not necessarily loaded when using a spring RestTemplate.\r\n","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Best solution now, just add dependency :</p>\n\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;com.github.zg2pro&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-rest-basis&lt;/artifactId&gt;\n  &lt;version&gt;v.x&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>It contains a LoggingRequestInterceptor class you can add that way to your RestTemplate:</p>\n\n<p>integrate this utility by adding it as an interceptor to a spring RestTemplate, in the following manner:</p>\n\n<pre><code>restTemplate.setRequestFactory(LoggingRequestFactoryFactory.build());\n</code></pre>\n\n<p>and add an slf4j implementation to your framework like log4j.</p>\n\n<p>or <strong>directly use \"Zg2proRestTemplate\"</strong>. The \"best answer\" by @PaulSabou looks so so, since httpclient and all apache.http libs are not necessarily loaded when using a spring RestTemplate.</p>\n"},{"comments":[{"owner":{"account_id":3412463,"reputation":1246,"user_id":2862100,"accept_rate":33,"display_name":"Luke"},"score":0,"creation_date":1532973008,"post_id":46801797,"comment_id":90165283,"body_markdown":"What if body is multipart/form-data, is there an easy way to filter out binary data (file content) from the log ?","body":"What if body is multipart/form-data, is there an easy way to filter out binary data (file content) from the log ?"}],"tags":[],"owner":{"account_id":215223,"reputation":2949,"user_id":469718,"accept_rate":12,"display_name":"kisna"},"comment_count":1,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1508292680,"creation_date":1508292680,"answer_id":46801797,"question_id":7952154,"body_markdown":"Strangely, none of these solutions work as RestTemplate does not seem to return the response on some client and server 500x errors. In which case, you will have log those as well by implementing ResponseErrorHandler as follows. Here is a draft code, but you get the point:\r\n\r\nYou can set the same interceptor as the error handler:\r\n\r\n    restTemplate.getInterceptors().add(interceptor);\r\n    restTemplate.setRequestFactory(new BufferingClientHttpRequestFactory(new SimpleClientHttpRequestFactory()));\r\n    restTemplate.setErrorHandler(interceptor);\r\n\r\nAnd the intercept implements both interfaces:\r\n\r\n    import java.io.BufferedReader;\r\n    import java.io.IOException;\r\n    import java.io.InputStreamReader;\r\n    import java.util.HashSet;\r\n    import java.util.Set;\r\n    import org.slf4j.Logger;\r\n    import org.slf4j.LoggerFactory;\r\n    import org.springframework.http.HttpRequest;\r\n    import org.springframework.http.HttpStatus.Series;\r\n    import org.springframework.http.client.ClientHttpRequestExecution;\r\n    import org.springframework.http.client.ClientHttpRequestInterceptor;\r\n    import org.springframework.http.client.ClientHttpResponse;\r\n    import org.springframework.web.client.DefaultResponseErrorHandler;\r\n    import org.springframework.web.client.ResponseErrorHandler;\r\n\r\n    public class LoggingRequestInterceptor implements ClientHttpRequestInterceptor, ResponseErrorHandler {\r\n        static final Logger log = LoggerFactory.getLogger(LoggingRequestInterceptor.class);\r\n        static final DefaultResponseErrorHandler defaultResponseErrorHandler = new DefaultResponseErrorHandler();\r\n        final Set&lt;Series&gt; loggableStatuses = new HashSet();\r\n\r\n        public LoggingRequestInterceptor() {\r\n        }\r\n\r\n        public LoggingRequestInterceptor(Set&lt;Series&gt; loggableStatuses) {\r\n            loggableStatuses.addAll(loggableStatuses);\r\n        }\r\n\r\n        public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\r\n            this.traceRequest(request, body);\r\n            ClientHttpResponse response = execution.execute(request, body);\r\n            if(response != null) {\r\n                this.traceResponse(response);\r\n            }\r\n\r\n            return response;\r\n        }\r\n\r\n        private void traceRequest(HttpRequest request, byte[] body) throws IOException {\r\n            log.debug(&quot;===========================request begin================================================&quot;);\r\n            log.debug(&quot;URI         : {}&quot;, request.getURI());\r\n            log.debug(&quot;Method      : {}&quot;, request.getMethod());\r\n            log.debug(&quot;Headers     : {}&quot;, request.getHeaders());\r\n            log.debug(&quot;Request body: {}&quot;, new String(body, &quot;UTF-8&quot;));\r\n            log.debug(&quot;==========================request end================================================&quot;);\r\n        }\r\n\r\n        private void traceResponse(ClientHttpResponse response) throws IOException {\r\n            if(this.loggableStatuses.isEmpty() || this.loggableStatuses.contains(response.getStatusCode().series())) {\r\n                StringBuilder inputStringBuilder = new StringBuilder();\r\n\r\n                try {\r\n                    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(response.getBody(), &quot;UTF-8&quot;));\r\n\r\n                    for(String line = bufferedReader.readLine(); line != null; line = bufferedReader.readLine()) {\r\n                        inputStringBuilder.append(line);\r\n                        inputStringBuilder.append(&#39;\\n&#39;);\r\n                    }\r\n                } catch (Throwable var5) {\r\n                    log.error(&quot;cannot read response due to error&quot;, var5);\r\n                }\r\n\r\n                log.debug(&quot;============================response begin==========================================&quot;);\r\n                log.debug(&quot;Status code  : {}&quot;, response.getStatusCode());\r\n                log.debug(&quot;Status text  : {}&quot;, response.getStatusText());\r\n                log.debug(&quot;Headers      : {}&quot;, response.getHeaders());\r\n                log.debug(&quot;Response body: {}&quot;, inputStringBuilder.toString());\r\n                log.debug(&quot;=======================response end=================================================&quot;);\r\n            }\r\n\r\n        }\r\n\r\n        public boolean hasError(ClientHttpResponse response) throws IOException {\r\n            return defaultResponseErrorHandler.hasError(response);\r\n        }\r\n\r\n        public void handleError(ClientHttpResponse response) throws IOException {\r\n            this.traceResponse(response);\r\n            defaultResponseErrorHandler.handleError(response);\r\n        }\r\n    }\r\n","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Strangely, none of these solutions work as RestTemplate does not seem to return the response on some client and server 500x errors. In which case, you will have log those as well by implementing ResponseErrorHandler as follows. Here is a draft code, but you get the point:</p>\n\n<p>You can set the same interceptor as the error handler:</p>\n\n<pre><code>restTemplate.getInterceptors().add(interceptor);\nrestTemplate.setRequestFactory(new BufferingClientHttpRequestFactory(new SimpleClientHttpRequestFactory()));\nrestTemplate.setErrorHandler(interceptor);\n</code></pre>\n\n<p>And the intercept implements both interfaces:</p>\n\n<pre><code>import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.HashSet;\nimport java.util.Set;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.http.HttpRequest;\nimport org.springframework.http.HttpStatus.Series;\nimport org.springframework.http.client.ClientHttpRequestExecution;\nimport org.springframework.http.client.ClientHttpRequestInterceptor;\nimport org.springframework.http.client.ClientHttpResponse;\nimport org.springframework.web.client.DefaultResponseErrorHandler;\nimport org.springframework.web.client.ResponseErrorHandler;\n\npublic class LoggingRequestInterceptor implements ClientHttpRequestInterceptor, ResponseErrorHandler {\n    static final Logger log = LoggerFactory.getLogger(LoggingRequestInterceptor.class);\n    static final DefaultResponseErrorHandler defaultResponseErrorHandler = new DefaultResponseErrorHandler();\n    final Set&lt;Series&gt; loggableStatuses = new HashSet();\n\n    public LoggingRequestInterceptor() {\n    }\n\n    public LoggingRequestInterceptor(Set&lt;Series&gt; loggableStatuses) {\n        loggableStatuses.addAll(loggableStatuses);\n    }\n\n    public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\n        this.traceRequest(request, body);\n        ClientHttpResponse response = execution.execute(request, body);\n        if(response != null) {\n            this.traceResponse(response);\n        }\n\n        return response;\n    }\n\n    private void traceRequest(HttpRequest request, byte[] body) throws IOException {\n        log.debug(\"===========================request begin================================================\");\n        log.debug(\"URI         : {}\", request.getURI());\n        log.debug(\"Method      : {}\", request.getMethod());\n        log.debug(\"Headers     : {}\", request.getHeaders());\n        log.debug(\"Request body: {}\", new String(body, \"UTF-8\"));\n        log.debug(\"==========================request end================================================\");\n    }\n\n    private void traceResponse(ClientHttpResponse response) throws IOException {\n        if(this.loggableStatuses.isEmpty() || this.loggableStatuses.contains(response.getStatusCode().series())) {\n            StringBuilder inputStringBuilder = new StringBuilder();\n\n            try {\n                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(response.getBody(), \"UTF-8\"));\n\n                for(String line = bufferedReader.readLine(); line != null; line = bufferedReader.readLine()) {\n                    inputStringBuilder.append(line);\n                    inputStringBuilder.append('\\n');\n                }\n            } catch (Throwable var5) {\n                log.error(\"cannot read response due to error\", var5);\n            }\n\n            log.debug(\"============================response begin==========================================\");\n            log.debug(\"Status code  : {}\", response.getStatusCode());\n            log.debug(\"Status text  : {}\", response.getStatusText());\n            log.debug(\"Headers      : {}\", response.getHeaders());\n            log.debug(\"Response body: {}\", inputStringBuilder.toString());\n            log.debug(\"=======================response end=================================================\");\n        }\n\n    }\n\n    public boolean hasError(ClientHttpResponse response) throws IOException {\n        return defaultResponseErrorHandler.hasError(response);\n    }\n\n    public void handleError(ClientHttpResponse response) throws IOException {\n        this.traceResponse(response);\n        defaultResponseErrorHandler.handleError(response);\n    }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":5406670,"reputation":1601,"user_id":4304958,"display_name":"Mark Hobson"},"score":3,"creation_date":1519505004,"post_id":47052529,"comment_id":84940420,"body_markdown":"Glad it helped @RaffaelBecharaRameh. It was initially downvoted because I didn&#39;t embed instructions from the linked project. Feel free to upvote if you found it useful!","body":"Glad it helped @RaffaelBecharaRameh. It was initially downvoted because I didn&#39;t embed instructions from the linked project. Feel free to upvote if you found it useful!"},{"owner":{"account_id":1342401,"reputation":23303,"user_id":1283845,"accept_rate":65,"display_name":"BlackHatSamurai"},"score":1,"creation_date":1559760710,"post_id":47052529,"comment_id":99524175,"body_markdown":"Do you support via Gradle?","body":"Do you support via Gradle?"},{"owner":{"account_id":5406670,"reputation":1601,"user_id":4304958,"display_name":"Mark Hobson"},"score":1,"creation_date":1559848723,"post_id":47052529,"comment_id":99557864,"body_markdown":"@BlackHatSamurai spring-rest-template-logger is a regular Maven artifact, so it should work fine with Gradle.","body":"@BlackHatSamurai spring-rest-template-logger is a regular Maven artifact, so it should work fine with Gradle."},{"owner":{"account_id":5100679,"reputation":2687,"user_id":4090386,"display_name":"attacomsian"},"score":0,"creation_date":1580843915,"post_id":47052529,"comment_id":106229222,"body_markdown":"For Spring Boot 2, you need to add `logging.level.org.hobsoft.spring.resttemplatelogger.LoggingCustomizer=DEBUG` to `application.properties` to view the log.","body":"For Spring Boot 2, you need to add <code>logging.level.org.hobsoft.spring.resttemplatelogger.LoggingC&zwnj;&#8203;ustomizer=DEBUG</code> to <code>application.properties</code> to view the log."},{"owner":{"account_id":5406670,"reputation":1601,"user_id":4304958,"display_name":"Mark Hobson"},"score":0,"creation_date":1580935154,"post_id":47052529,"comment_id":106265597,"body_markdown":"Thanks @attacomsian - I&#39;ve updated the answer and project README.","body":"Thanks @attacomsian - I&#39;ve updated the answer and project README."},{"owner":{"account_id":64621,"reputation":1685,"user_id":190674,"accept_rate":50,"display_name":"erhanasikoglu"},"score":0,"creation_date":1581054625,"post_id":47052529,"comment_id":106308761,"body_markdown":"Hi Mark, thanks for developing this library, I would like to learn how did you handle inputstream ? did you use BufferingClientHttpRequestFactory ?","body":"Hi Mark, thanks for developing this library, I would like to learn how did you handle inputstream ? did you use BufferingClientHttpRequestFactory ?"},{"owner":{"account_id":5406670,"reputation":1601,"user_id":4304958,"display_name":"Mark Hobson"},"score":1,"creation_date":1581155710,"post_id":47052529,"comment_id":106341944,"body_markdown":"Hi @erhanasikoglu, you&#39;re welcome! That&#39;s right, you can see it in use here: https://github.com/markhobson/spring-rest-template-logger/blob/master/src/main/java/org/hobsoft/spring/resttemplatelogger/LoggingCustomizer.java#L62","body":"Hi @erhanasikoglu, you&#39;re welcome! That&#39;s right, you can see it in use here: <a href=\"https://github.com/markhobson/spring-rest-template-logger/blob/master/src/main/java/org/hobsoft/spring/resttemplatelogger/LoggingCustomizer.java#L62\" rel=\"nofollow noreferrer\">github.com/markhobson/spring-rest-template-logger/blob/maste&zwnj;&#8203;r/&hellip;</a>"}],"tags":[],"owner":{"account_id":5406670,"reputation":1601,"user_id":4304958,"display_name":"Mark Hobson"},"comment_count":7,"down_vote_count":1,"up_vote_count":42,"is_accepted":false,"score":41,"last_activity_date":1580935270,"creation_date":1509531375,"answer_id":47052529,"question_id":7952154,"body_markdown":"You can use [spring-rest-template-logger][1] to log `RestTemplate` HTTP traffic.\r\n\r\nAdd a dependency to your Maven project:\r\n\r\n    &lt;dependency&gt;\r\n    \t&lt;groupId&gt;org.hobsoft.spring&lt;/groupId&gt;\r\n    \t&lt;artifactId&gt;spring-rest-template-logger&lt;/artifactId&gt;\r\n    \t&lt;version&gt;2.0.0&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nThen customize your `RestTemplate` as follows:\r\n\r\n    RestTemplate restTemplate = new RestTemplateBuilder()\r\n    \t.customizers(new LoggingCustomizer())\r\n    \t.build()\r\n\r\nEnsure that debug logging is enabled in `application.properties`:\r\n\r\n    logging.level.org.hobsoft.spring.resttemplatelogger.LoggingCustomizer = DEBUG\r\n\r\nNow all RestTemplate HTTP traffic will be logged to `org.hobsoft.spring.resttemplatelogger.LoggingCustomizer` at debug level.\r\n\r\nDISCLAIMER: I wrote this library.\r\n\r\n  [1]: https://github.com/markhobson/spring-rest-template-logger\r\n","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>You can use <a href=\"https://github.com/markhobson/spring-rest-template-logger\" rel=\"noreferrer\">spring-rest-template-logger</a> to log <code>RestTemplate</code> HTTP traffic.</p>\n\n<p>Add a dependency to your Maven project:</p>\n\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.hobsoft.spring&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-rest-template-logger&lt;/artifactId&gt;\n    &lt;version&gt;2.0.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>Then customize your <code>RestTemplate</code> as follows:</p>\n\n<pre><code>RestTemplate restTemplate = new RestTemplateBuilder()\n    .customizers(new LoggingCustomizer())\n    .build()\n</code></pre>\n\n<p>Ensure that debug logging is enabled in <code>application.properties</code>:</p>\n\n<pre><code>logging.level.org.hobsoft.spring.resttemplatelogger.LoggingCustomizer = DEBUG\n</code></pre>\n\n<p>Now all RestTemplate HTTP traffic will be logged to <code>org.hobsoft.spring.resttemplatelogger.LoggingCustomizer</code> at debug level.</p>\n\n<p>DISCLAIMER: I wrote this library.</p>\n"},{"comments":[{"owner":{"account_id":26156,"reputation":1305,"user_id":67814,"accept_rate":71,"display_name":"kingoleg"},"score":0,"creation_date":1537545327,"post_id":47467572,"comment_id":91837408,"body_markdown":"Just note: if you&#39;d like to configure `TestRestTemplate`, configure `RestTemplateBuilder`:\n\n\n\t@Bean\n\tpublic RestTemplateBuilder restTemplateBuilder() {\n\t\treturn new RestTemplateBuilder().additionalInterceptors(Collections.singletonList(new LoggingRestTemplate()));\n\t}","body":"Just note: if you&#39;d like to configure <code>TestRestTemplate</code>, configure <code>RestTemplateBuilder</code>:   \t@Bean \tpublic RestTemplateBuilder restTemplateBuilder() { \t\treturn new RestTemplateBuilder().additionalInterceptors(Collections.sin&zwnj;&#8203;gletonList(new LoggingRestTemplate())); \t}"},{"owner":{"account_id":1976638,"reputation":2858,"user_id":1774291,"accept_rate":75,"display_name":"PeterS"},"score":0,"creation_date":1539087531,"post_id":47467572,"comment_id":92366866,"body_markdown":"Note also that new InputStreamReader(responseWrapper.getBody(), StandardCharsets.UTF_8)); can throw an error if the &quot;other end&quot; returned an error. You may want to place it into a try block.","body":"Note also that new InputStreamReader(responseWrapper.getBody(), StandardCharsets.UTF_8)); can throw an error if the &quot;other end&quot; returned an error. You may want to place it into a try block."}],"tags":[],"owner":{"account_id":3260335,"reputation":23,"user_id":2746033,"display_name":"user2746033"},"comment_count":2,"down_vote_count":2,"up_vote_count":28,"is_accepted":false,"score":26,"last_activity_date":1511505251,"creation_date":1511505251,"answer_id":47467572,"question_id":7952154,"body_markdown":"# Logging RestTemplate\r\n\r\n## Option 1. Open debug logging.\r\n\r\n### Configurate RestTemplate\r\n\r\n* By default the [RestTemplate](http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html) relies on standard JDK facilities to establish HTTP connections. You can switch to use a different HTTP library such as Apache HttpComponents\r\n\r\n    @Bean\r\n    public RestTemplate restTemplate(RestTemplateBuilder builder) {\r\n        RestTemplate restTemplate = builder.build();\r\n        return restTemplate;\r\n    }\r\n\r\n### Configurate logging\r\n\r\n* `application.yml`\r\n\r\n    logging:\r\n      level:\r\n          org.springframework.web.client.RestTemplate: DEBUG\r\n\r\n## Option 2. Using Interceptor\r\n\r\n### Wrapper Response\r\n\r\n    import java.io.ByteArrayInputStream;\r\n    import java.io.IOException;\r\n    import java.io.InputStream;\r\n\r\n    import org.springframework.http.HttpHeaders;\r\n    import org.springframework.http.HttpStatus;\r\n    import org.springframework.http.client.ClientHttpResponse;\r\n    import org.springframework.util.StreamUtils;\r\n\r\n    public final class BufferingClientHttpResponseWrapper implements ClientHttpResponse {\r\n\r\n        private final ClientHttpResponse response;\r\n\r\n        private byte[] body;\r\n\r\n\r\n        BufferingClientHttpResponseWrapper(ClientHttpResponse response) {\r\n            this.response = response;\r\n        }\r\n\r\n        public HttpStatus getStatusCode() throws IOException {\r\n            return this.response.getStatusCode();\r\n        }\r\n\r\n        public int getRawStatusCode() throws IOException {\r\n            return this.response.getRawStatusCode();\r\n        }\r\n\r\n        public String getStatusText() throws IOException {\r\n            return this.response.getStatusText();\r\n        }\r\n\r\n        public HttpHeaders getHeaders() {\r\n            return this.response.getHeaders();\r\n        }\r\n\r\n        public InputStream getBody() throws IOException {\r\n            if (this.body == null) {\r\n                this.body = StreamUtils.copyToByteArray(this.response.getBody());\r\n            }\r\n            return new ByteArrayInputStream(this.body);\r\n        }\r\n\r\n        public void close() {\r\n            this.response.close();\r\n        }\r\n    }\r\n\r\n### Implement Interceptor\r\n\r\n    package com.example.logging;\r\n\r\n    import java.io.BufferedReader;\r\n    import java.io.IOException;\r\n    import java.io.InputStreamReader;\r\n\r\n    import org.slf4j.Logger;\r\n    import org.slf4j.LoggerFactory;\r\n    import org.springframework.http.HttpRequest;\r\n    import org.springframework.http.client.ClientHttpRequestExecution;\r\n    import org.springframework.http.client.ClientHttpRequestInterceptor;\r\n    import org.springframework.http.client.ClientHttpResponse;\r\n\r\n    public class LoggingRestTemplate implements ClientHttpRequestInterceptor {\r\n\r\n        private final static Logger LOGGER = LoggerFactory.getLogger(LoggingRestTemplate.class);\r\n\r\n        @Override\r\n        public ClientHttpResponse intercept(HttpRequest request, byte[] body,\r\n                ClientHttpRequestExecution execution) throws IOException {\r\n            traceRequest(request, body);\r\n            ClientHttpResponse response = execution.execute(request, body);\r\n            return traceResponse(response);\r\n        }\r\n\r\n        private void traceRequest(HttpRequest request, byte[] body) throws IOException {\r\n            if (!LOGGER.isDebugEnabled()) {\r\n                return;\r\n            }\r\n            LOGGER.debug(\r\n                    &quot;==========================request begin==============================================&quot;);\r\n            LOGGER.debug(&quot;URI                 : {}&quot;, request.getURI());\r\n            LOGGER.debug(&quot;Method            : {}&quot;, request.getMethod());\r\n            LOGGER.debug(&quot;Headers         : {}&quot;, request.getHeaders());\r\n            LOGGER.debug(&quot;Request body: {}&quot;, new String(body, &quot;UTF-8&quot;));\r\n            LOGGER.debug(\r\n                    &quot;==========================request end================================================&quot;);\r\n        }\r\n\r\n        private ClientHttpResponse traceResponse(ClientHttpResponse response) throws IOException {\r\n            if (!LOGGER.isDebugEnabled()) {\r\n                return response;\r\n            }\r\n            final ClientHttpResponse responseWrapper = new BufferingClientHttpResponseWrapper(response);\r\n            StringBuilder inputStringBuilder = new StringBuilder();\r\n            BufferedReader bufferedReader = new BufferedReader(\r\n                    new InputStreamReader(responseWrapper.getBody(), &quot;UTF-8&quot;));\r\n            String line = bufferedReader.readLine();\r\n            while (line != null) {\r\n                inputStringBuilder.append(line);\r\n                inputStringBuilder.append(&#39;\\n&#39;);\r\n                line = bufferedReader.readLine();\r\n            }\r\n            LOGGER.debug(\r\n                    &quot;==========================response begin=============================================&quot;);\r\n            LOGGER.debug(&quot;Status code    : {}&quot;, responseWrapper.getStatusCode());\r\n            LOGGER.debug(&quot;Status text    : {}&quot;, responseWrapper.getStatusText());\r\n            LOGGER.debug(&quot;Headers            : {}&quot;, responseWrapper.getHeaders());\r\n            LOGGER.debug(&quot;Response body: {}&quot;, inputStringBuilder.toString());\r\n            LOGGER.debug(\r\n                    &quot;==========================response end===============================================&quot;);\r\n            return responseWrapper;\r\n        }\r\n\r\n    }\r\n\r\n### Configurate RestTemplate\r\n\r\n    @Bean\r\n    public RestTemplate restTemplate(RestTemplateBuilder builder) {\r\n        RestTemplate restTemplate = builder.build();\r\n        restTemplate.setInterceptors(Collections.singletonList(new LoggingRestTemplate()));\r\n        return restTemplate;\r\n    }\r\n\r\n### Configurate logging\r\n\r\n* Check the package of LoggingRestTemplate, for example in `application.yml`:\r\n\r\n    logging:\r\n      level:\r\n          com.example.logging: DEBUG\r\n\r\n## Option 3. Using httpcomponent\r\n\r\n### Import httpcomponent dependency\r\n\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\r\n      &lt;artifactId&gt;httpasyncclient&lt;/artifactId&gt;\r\n  &lt;/dependency&gt;\r\n\r\n\r\n### Configurate RestTemplate\r\n\r\n    @Bean\r\n    public RestTemplate restTemplate(RestTemplateBuilder builder) {\r\n        RestTemplate restTemplate = builder.build();\r\n        restTemplate.setRequestFactory(new HttpComponentsAsyncClientHttpRequestFactory());\r\n        return restTemplate;\r\n    }\r\n\r\n\r\n### Configurate logging\r\n\r\n* Check the package of LoggingRestTemplate, for example in `application.yml`:\r\n\r\n    logging:\r\n    level:\r\n        org.apache.http: DEBUG\r\n","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<h1>Logging RestTemplate</h1>\n\n<h2>Option 1. Open debug logging.</h2>\n\n<h3>Configurate RestTemplate</h3>\n\n<ul>\n<li><p>By default the <a href=\"http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html\" rel=\"noreferrer\">RestTemplate</a> relies on standard JDK facilities to establish HTTP connections. You can switch to use a different HTTP library such as Apache HttpComponents</p>\n\n<p>@Bean\npublic RestTemplate restTemplate(RestTemplateBuilder builder) {\n    RestTemplate restTemplate = builder.build();\n    return restTemplate;\n}</p></li>\n</ul>\n\n<h3>Configurate logging</h3>\n\n<ul>\n<li><p><code>application.yml</code></p>\n\n<p>logging:\n  level:\n      org.springframework.web.client.RestTemplate: DEBUG</p></li>\n</ul>\n\n<h2>Option 2. Using Interceptor</h2>\n\n<h3>Wrapper Response</h3>\n\n<pre><code>import java.io.ByteArrayInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\n\nimport org.springframework.http.HttpHeaders;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.client.ClientHttpResponse;\nimport org.springframework.util.StreamUtils;\n\npublic final class BufferingClientHttpResponseWrapper implements ClientHttpResponse {\n\n    private final ClientHttpResponse response;\n\n    private byte[] body;\n\n\n    BufferingClientHttpResponseWrapper(ClientHttpResponse response) {\n        this.response = response;\n    }\n\n    public HttpStatus getStatusCode() throws IOException {\n        return this.response.getStatusCode();\n    }\n\n    public int getRawStatusCode() throws IOException {\n        return this.response.getRawStatusCode();\n    }\n\n    public String getStatusText() throws IOException {\n        return this.response.getStatusText();\n    }\n\n    public HttpHeaders getHeaders() {\n        return this.response.getHeaders();\n    }\n\n    public InputStream getBody() throws IOException {\n        if (this.body == null) {\n            this.body = StreamUtils.copyToByteArray(this.response.getBody());\n        }\n        return new ByteArrayInputStream(this.body);\n    }\n\n    public void close() {\n        this.response.close();\n    }\n}\n</code></pre>\n\n<h3>Implement Interceptor</h3>\n\n<pre><code>package com.example.logging;\n\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.http.HttpRequest;\nimport org.springframework.http.client.ClientHttpRequestExecution;\nimport org.springframework.http.client.ClientHttpRequestInterceptor;\nimport org.springframework.http.client.ClientHttpResponse;\n\npublic class LoggingRestTemplate implements ClientHttpRequestInterceptor {\n\n    private final static Logger LOGGER = LoggerFactory.getLogger(LoggingRestTemplate.class);\n\n    @Override\n    public ClientHttpResponse intercept(HttpRequest request, byte[] body,\n            ClientHttpRequestExecution execution) throws IOException {\n        traceRequest(request, body);\n        ClientHttpResponse response = execution.execute(request, body);\n        return traceResponse(response);\n    }\n\n    private void traceRequest(HttpRequest request, byte[] body) throws IOException {\n        if (!LOGGER.isDebugEnabled()) {\n            return;\n        }\n        LOGGER.debug(\n                \"==========================request begin==============================================\");\n        LOGGER.debug(\"URI                 : {}\", request.getURI());\n        LOGGER.debug(\"Method            : {}\", request.getMethod());\n        LOGGER.debug(\"Headers         : {}\", request.getHeaders());\n        LOGGER.debug(\"Request body: {}\", new String(body, \"UTF-8\"));\n        LOGGER.debug(\n                \"==========================request end================================================\");\n    }\n\n    private ClientHttpResponse traceResponse(ClientHttpResponse response) throws IOException {\n        if (!LOGGER.isDebugEnabled()) {\n            return response;\n        }\n        final ClientHttpResponse responseWrapper = new BufferingClientHttpResponseWrapper(response);\n        StringBuilder inputStringBuilder = new StringBuilder();\n        BufferedReader bufferedReader = new BufferedReader(\n                new InputStreamReader(responseWrapper.getBody(), \"UTF-8\"));\n        String line = bufferedReader.readLine();\n        while (line != null) {\n            inputStringBuilder.append(line);\n            inputStringBuilder.append('\\n');\n            line = bufferedReader.readLine();\n        }\n        LOGGER.debug(\n                \"==========================response begin=============================================\");\n        LOGGER.debug(\"Status code    : {}\", responseWrapper.getStatusCode());\n        LOGGER.debug(\"Status text    : {}\", responseWrapper.getStatusText());\n        LOGGER.debug(\"Headers            : {}\", responseWrapper.getHeaders());\n        LOGGER.debug(\"Response body: {}\", inputStringBuilder.toString());\n        LOGGER.debug(\n                \"==========================response end===============================================\");\n        return responseWrapper;\n    }\n\n}\n</code></pre>\n\n<h3>Configurate RestTemplate</h3>\n\n<pre><code>@Bean\npublic RestTemplate restTemplate(RestTemplateBuilder builder) {\n    RestTemplate restTemplate = builder.build();\n    restTemplate.setInterceptors(Collections.singletonList(new LoggingRestTemplate()));\n    return restTemplate;\n}\n</code></pre>\n\n<h3>Configurate logging</h3>\n\n<ul>\n<li><p>Check the package of LoggingRestTemplate, for example in <code>application.yml</code>:</p>\n\n<p>logging:\n  level:\n      com.example.logging: DEBUG</p></li>\n</ul>\n\n<h2>Option 3. Using httpcomponent</h2>\n\n<h3>Import httpcomponent dependency</h3>\n\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\n  &lt;artifactId&gt;httpasyncclient&lt;/artifactId&gt;\n</code></pre>\n\n<p></p>\n\n<h3>Configurate RestTemplate</h3>\n\n<pre><code>@Bean\npublic RestTemplate restTemplate(RestTemplateBuilder builder) {\n    RestTemplate restTemplate = builder.build();\n    restTemplate.setRequestFactory(new HttpComponentsAsyncClientHttpRequestFactory());\n    return restTemplate;\n}\n</code></pre>\n\n<h3>Configurate logging</h3>\n\n<ul>\n<li><p>Check the package of LoggingRestTemplate, for example in <code>application.yml</code>:</p>\n\n<p>logging:\nlevel:\n    org.apache.http: DEBUG</p></li>\n</ul>\n"},{"tags":[],"owner":{"account_id":13052518,"reputation":1,"user_id":9432355,"display_name":"NenadTzar"},"comment_count":0,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1519998128,"creation_date":1519965155,"answer_id":49062863,"question_id":7952154,"body_markdown":"Related to the response using ClientHttpInterceptor, I found a way of keeping the whole response without Buffering factories. Just store the response body input stream inside byte array using some utils method that will copy that array from body, but important, surround this method with try catch because it will break if response is empty (that is the cause of Resource Access Exception) and in catch just create empty byte array, and than just create anonymous inner class of ClientHttpResponse using that array and other parameters from the original response. Than you can return that new ClientHttpResponse object to the rest template execution chain and you can log response using body byte array that is previously stored. That way you will avoid consuming InputStream in the actual response and you can use Rest Template response as it is. Note, this may be dangerous if your&#39;s response is too big ","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Related to the response using ClientHttpInterceptor, I found a way of keeping the whole response without Buffering factories. Just store the response body input stream inside byte array using some utils method that will copy that array from body, but important, surround this method with try catch because it will break if response is empty (that is the cause of Resource Access Exception) and in catch just create empty byte array, and than just create anonymous inner class of ClientHttpResponse using that array and other parameters from the original response. Than you can return that new ClientHttpResponse object to the rest template execution chain and you can log response using body byte array that is previously stored. That way you will avoid consuming InputStream in the actual response and you can use Rest Template response as it is. Note, this may be dangerous if your's response is too big </p>\n"},{"tags":[],"owner":{"account_id":7450965,"reputation":1416,"user_id":5665753,"display_name":"Jason Slobotski"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1524248685,"creation_date":1524246959,"answer_id":49947302,"question_id":7952154,"body_markdown":"Wanted to add my implementation of this as well. I apologize for all the missing semi-colons, this is written in Groovy. \r\n\r\nI needed something more configurable than the accepted answer provided. Here&#39;s a rest template bean that&#39;s very agile and will log everything like the OP is looking for.\r\n\r\nCustom Logging Interceptor Class:\r\n\r\n    import org.springframework.http.HttpRequest\r\n    import org.springframework.http.client.ClientHttpRequestExecution\r\n    import org.springframework.http.client.ClientHttpRequestInterceptor\r\n    import org.springframework.http.client.ClientHttpResponse\r\n    import org.springframework.util.StreamUtils\r\n    \r\n    import java.nio.charset.Charset\r\n    \r\n    class HttpLoggingInterceptor implements ClientHttpRequestInterceptor {\r\n\r\n        private final static Logger log = LoggerFactory.getLogger(HttpLoggingInterceptor.class)\r\n    \r\n        @Override\r\n        ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\r\n            logRequest(request, body)\r\n            ClientHttpResponse response = execution.execute(request, body)\r\n            logResponse(response)\r\n            return response\r\n        }\r\n    \r\n        private void logRequest(HttpRequest request, byte[] body) throws IOException {\r\n            if (log.isDebugEnabled()) {\r\n                log.debug(&quot;===========================request begin================================================&quot;)\r\n                log.debug(&quot;URI         : {}&quot;, request.getURI())\r\n                log.debug(&quot;Method      : {}&quot;, request.getMethod())\r\n                log.debug(&quot;Headers     : {}&quot;, request.getHeaders())\r\n                log.debug(&quot;Request body: {}&quot;, new String(body, &quot;UTF-8&quot;))\r\n                log.debug(&quot;==========================request end================================================&quot;)\r\n            }\r\n        }\r\n    \r\n        private void logResponse(ClientHttpResponse response) throws IOException {\r\n            if (log.isDebugEnabled()) {\r\n                log.debug(&quot;============================response begin==========================================&quot;)\r\n                log.debug(&quot;Status code  : {}&quot;, response.getStatusCode())\r\n                log.debug(&quot;Status text  : {}&quot;, response.getStatusText())\r\n                log.debug(&quot;Headers      : {}&quot;, response.getHeaders())\r\n                log.debug(&quot;Response body: {}&quot;, StreamUtils.copyToString(response.getBody(), Charset.defaultCharset()))\r\n                log.debug(&quot;=======================response end=================================================&quot;)\r\n            }\r\n        }\r\n    }\r\n\r\nRest Template Bean Definition:\r\n\r\n    @Bean(name = &#39;myRestTemplate&#39;)\r\n    RestTemplate myRestTemplate(RestTemplateBuilder builder) {\r\n    \r\n        RequestConfig requestConfig = RequestConfig.custom()\r\n                .setConnectTimeout(10 * 1000) // 10 seconds\r\n                .setSocketTimeout(300 * 1000) // 300 seconds\r\n                .build()\r\n    \r\n        PoolingHttpClientConnectionManager connectionManager = new PoolingHttpClientConnectionManager()\r\n        connectionManager.setMaxTotal(10)\r\n        connectionManager.closeIdleConnections(5, TimeUnit.MINUTES)\r\n    \r\n        CloseableHttpClient httpClient = HttpClients.custom()\r\n                .setConnectionManager(connectionManager)\r\n                .setDefaultRequestConfig(requestConfig)\r\n                .disableRedirectHandling()\r\n                .build()\r\n    \r\n        RestTemplate restTemplate = builder\r\n                .rootUri(&quot;https://domain.server.com&quot;)\r\n                .basicAuthorization(&quot;username&quot;, &quot;password&quot;)\r\n                .requestFactory(new BufferingClientHttpRequestFactory(new HttpComponentsClientHttpRequestFactory(httpClient)))\r\n                .interceptors(new HttpLoggingInterceptor())\r\n                .build()\r\n    \r\n        return restTemplate\r\n    }\r\n\r\nImplementation:\r\n\r\n    @Component\r\n    class RestService {\r\n    \r\n        private final RestTemplate restTemplate\r\n        private final static Logger log = LoggerFactory.getLogger(RestService.class)\r\n    \r\n        @Autowired\r\n        RestService(\r\n                @Qualifier(&quot;myRestTemplate&quot;) RestTemplate restTemplate\r\n        ) {\r\n            this.restTemplate = restTemplate\r\n        }\r\n\r\n        // add specific methods to your service that access the GET and PUT methods\r\n    \r\n        private &lt;T&gt; T getForObject(String path, Class&lt;T&gt; object, Map&lt;String, ?&gt; params = [:]) {\r\n            try {\r\n                return restTemplate.getForObject(path, object, params)\r\n            } catch (HttpClientErrorException e) {\r\n                log.warn(&quot;Client Error (${path}): ${e.responseBodyAsString}&quot;)\r\n            } catch (HttpServerErrorException e) {\r\n                String msg = &quot;Server Error (${path}): ${e.responseBodyAsString}&quot;\r\n                log.error(msg, e)\r\n            } catch (RestClientException e) {\r\n                String msg = &quot;Error (${path})&quot;\r\n                log.error(msg, e)\r\n            }\r\n            return null\r\n        }\r\n    \r\n        private &lt;T&gt; T putForObject(String path, T object) {\r\n            try {\r\n                HttpEntity&lt;T&gt; request = new HttpEntity&lt;&gt;(object)\r\n                HttpEntity&lt;T&gt; response = restTemplate.exchange(path, HttpMethod.PUT, request, T)\r\n                return response.getBody()\r\n            } catch (HttpClientErrorException e) {\r\n                log.warn(&quot;Error (${path}): ${e.responseBodyAsString}&quot;)\r\n            } catch (HttpServerErrorException e) {\r\n                String msg = &quot;Error (${path}): ${e.responseBodyAsString}&quot;\r\n                log.error(msg, e)\r\n            } catch (RestClientException e) {\r\n                String msg = &quot;Error (${path})&quot;\r\n                log.error(msg, e)\r\n            }\r\n            return null\r\n        }\r\n    }","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Wanted to add my implementation of this as well. I apologize for all the missing semi-colons, this is written in Groovy. </p>\n\n<p>I needed something more configurable than the accepted answer provided. Here's a rest template bean that's very agile and will log everything like the OP is looking for.</p>\n\n<p>Custom Logging Interceptor Class:</p>\n\n<pre><code>import org.springframework.http.HttpRequest\nimport org.springframework.http.client.ClientHttpRequestExecution\nimport org.springframework.http.client.ClientHttpRequestInterceptor\nimport org.springframework.http.client.ClientHttpResponse\nimport org.springframework.util.StreamUtils\n\nimport java.nio.charset.Charset\n\nclass HttpLoggingInterceptor implements ClientHttpRequestInterceptor {\n\n    private final static Logger log = LoggerFactory.getLogger(HttpLoggingInterceptor.class)\n\n    @Override\n    ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\n        logRequest(request, body)\n        ClientHttpResponse response = execution.execute(request, body)\n        logResponse(response)\n        return response\n    }\n\n    private void logRequest(HttpRequest request, byte[] body) throws IOException {\n        if (log.isDebugEnabled()) {\n            log.debug(\"===========================request begin================================================\")\n            log.debug(\"URI         : {}\", request.getURI())\n            log.debug(\"Method      : {}\", request.getMethod())\n            log.debug(\"Headers     : {}\", request.getHeaders())\n            log.debug(\"Request body: {}\", new String(body, \"UTF-8\"))\n            log.debug(\"==========================request end================================================\")\n        }\n    }\n\n    private void logResponse(ClientHttpResponse response) throws IOException {\n        if (log.isDebugEnabled()) {\n            log.debug(\"============================response begin==========================================\")\n            log.debug(\"Status code  : {}\", response.getStatusCode())\n            log.debug(\"Status text  : {}\", response.getStatusText())\n            log.debug(\"Headers      : {}\", response.getHeaders())\n            log.debug(\"Response body: {}\", StreamUtils.copyToString(response.getBody(), Charset.defaultCharset()))\n            log.debug(\"=======================response end=================================================\")\n        }\n    }\n}\n</code></pre>\n\n<p>Rest Template Bean Definition:</p>\n\n<pre><code>@Bean(name = 'myRestTemplate')\nRestTemplate myRestTemplate(RestTemplateBuilder builder) {\n\n    RequestConfig requestConfig = RequestConfig.custom()\n            .setConnectTimeout(10 * 1000) // 10 seconds\n            .setSocketTimeout(300 * 1000) // 300 seconds\n            .build()\n\n    PoolingHttpClientConnectionManager connectionManager = new PoolingHttpClientConnectionManager()\n    connectionManager.setMaxTotal(10)\n    connectionManager.closeIdleConnections(5, TimeUnit.MINUTES)\n\n    CloseableHttpClient httpClient = HttpClients.custom()\n            .setConnectionManager(connectionManager)\n            .setDefaultRequestConfig(requestConfig)\n            .disableRedirectHandling()\n            .build()\n\n    RestTemplate restTemplate = builder\n            .rootUri(\"https://domain.server.com\")\n            .basicAuthorization(\"username\", \"password\")\n            .requestFactory(new BufferingClientHttpRequestFactory(new HttpComponentsClientHttpRequestFactory(httpClient)))\n            .interceptors(new HttpLoggingInterceptor())\n            .build()\n\n    return restTemplate\n}\n</code></pre>\n\n<p>Implementation:</p>\n\n<pre><code>@Component\nclass RestService {\n\n    private final RestTemplate restTemplate\n    private final static Logger log = LoggerFactory.getLogger(RestService.class)\n\n    @Autowired\n    RestService(\n            @Qualifier(\"myRestTemplate\") RestTemplate restTemplate\n    ) {\n        this.restTemplate = restTemplate\n    }\n\n    // add specific methods to your service that access the GET and PUT methods\n\n    private &lt;T&gt; T getForObject(String path, Class&lt;T&gt; object, Map&lt;String, ?&gt; params = [:]) {\n        try {\n            return restTemplate.getForObject(path, object, params)\n        } catch (HttpClientErrorException e) {\n            log.warn(\"Client Error (${path}): ${e.responseBodyAsString}\")\n        } catch (HttpServerErrorException e) {\n            String msg = \"Server Error (${path}): ${e.responseBodyAsString}\"\n            log.error(msg, e)\n        } catch (RestClientException e) {\n            String msg = \"Error (${path})\"\n            log.error(msg, e)\n        }\n        return null\n    }\n\n    private &lt;T&gt; T putForObject(String path, T object) {\n        try {\n            HttpEntity&lt;T&gt; request = new HttpEntity&lt;&gt;(object)\n            HttpEntity&lt;T&gt; response = restTemplate.exchange(path, HttpMethod.PUT, request, T)\n            return response.getBody()\n        } catch (HttpClientErrorException e) {\n            log.warn(\"Error (${path}): ${e.responseBodyAsString}\")\n        } catch (HttpServerErrorException e) {\n            String msg = \"Error (${path}): ${e.responseBodyAsString}\"\n            log.error(msg, e)\n        } catch (RestClientException e) {\n            String msg = \"Error (${path})\"\n            log.error(msg, e)\n        }\n        return null\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4255029,"reputation":603,"user_id":3480947,"accept_rate":20,"display_name":"maya16"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1524799267,"creation_date":1524799267,"answer_id":50054731,"question_id":7952154,"body_markdown":"Refer the Q/A for logging the request and response for the rest template by enabling the multiple reads on the HttpInputStream\r\n\r\nhttps://stackoverflow.com/questions/50023708/why-my-custom-clienthttprequestinterceptor-with-empty-response/50054698#50054698","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Refer the Q/A for logging the request and response for the rest template by enabling the multiple reads on the HttpInputStream</p>\n\n<p><a href=\"https://stackoverflow.com/questions/50023708/why-my-custom-clienthttprequestinterceptor-with-empty-response/50054698#50054698\">Why my custom ClientHttpRequestInterceptor with empty response</a></p>\n"},{"comments":[{"owner":{"account_id":5123021,"reputation":1495,"user_id":4106030,"accept_rate":85,"display_name":"badera"},"score":0,"creation_date":1551206067,"post_id":50588160,"comment_id":96553083,"body_markdown":"Logging responses does not work for me. It just Logs Statuscode. Should it log payload?","body":"Logging responses does not work for me. It just Logs Statuscode. Should it log payload?"},{"owner":{"account_id":141852,"reputation":4322,"user_id":349169,"accept_rate":78,"display_name":"Chris"},"score":0,"creation_date":1564391440,"post_id":50588160,"comment_id":101001136,"body_markdown":"The class HttpEntityMethodProcessor (v5.1.8) doesn&#39;t log anything.","body":"The class HttpEntityMethodProcessor (v5.1.8) doesn&#39;t log anything."}],"tags":[],"owner":{"account_id":10062933,"reputation":215,"user_id":7438923,"display_name":"Viggi"},"comment_count":2,"down_vote_count":2,"up_vote_count":12,"is_accepted":false,"score":10,"last_activity_date":1579296659,"creation_date":1527608249,"answer_id":50588160,"question_id":7952154,"body_markdown":"This might not be the correct way to do it, but I think this is the most simple approach to print requests and responses without filling too much in logs.\r\n\r\nBy adding below 2 lines application.properties logs all requests and responses 1st line in order to log the requests and 2nd line to log the responses.\r\n\r\n    logging.level.org.springframework.web.client.RestTemplate=DEBUG\r\n    logging.level.org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor=DEBUG","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>This might not be the correct way to do it, but I think this is the most simple approach to print requests and responses without filling too much in logs.</p>\n\n<p>By adding below 2 lines application.properties logs all requests and responses 1st line in order to log the requests and 2nd line to log the responses.</p>\n\n<pre><code>logging.level.org.springframework.web.client.RestTemplate=DEBUG\nlogging.level.org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor=DEBUG\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2402834,"reputation":380,"user_id":2100121,"display_name":"Tony Findeisen"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1536922989,"creation_date":1536922989,"answer_id":52330648,"question_id":7952154,"body_markdown":"As @MilacH pointed out, there is an error in the implementation. If an statusCode &gt; 400 is returned a IOException is thrown, as the errorHandler is not invoked, from interceptors. The exception can be ignored and is then caught again in the handler method.\r\n\r\n    package net.sprd.fulfillment.common;\r\n    \r\n    import org.slf4j.Logger;\r\n    import org.slf4j.LoggerFactory;\r\n    import org.springframework.http.HttpRequest;\r\n    import org.springframework.http.client.ClientHttpRequestExecution;\r\n    import org.springframework.http.client.ClientHttpRequestInterceptor;\r\n    import org.springframework.http.client.ClientHttpResponse;\r\n    \r\n    import java.io.BufferedReader;\r\n    import java.io.IOException;\r\n    import java.io.InputStreamReader;\r\n    \r\n    import static java.nio.charset.StandardCharsets.UTF_8;\r\n    \r\n    public class LoggingRequestInterceptor implements ClientHttpRequestInterceptor {\r\n    \r\n        final static Logger log = LoggerFactory.getLogger(LoggingRequestInterceptor.class);\r\n    \r\n        @SuppressWarnings(&quot;HardcodedLineSeparator&quot;)\r\n        public static final char LINE_BREAK = &#39;\\n&#39;;\r\n    \r\n        @Override\r\n        public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\r\n            try {\r\n                traceRequest(request, body);\r\n            } catch (Exception e) {\r\n                log.warn(&quot;Exception in LoggingRequestInterceptor while tracing request&quot;, e);\r\n            }\r\n    \r\n            ClientHttpResponse response = execution.execute(request, body);\r\n    \r\n            try {\r\n                traceResponse(response);\r\n            } catch (IOException e) {\r\n                // ignore the exception here, as it will be handled by the error handler of the restTemplate\r\n                log.warn(&quot;Exception in LoggingRequestInterceptor&quot;, e);\r\n            }\r\n            return response;\r\n        }\r\n    \r\n        private void traceRequest(HttpRequest request, byte[] body) {\r\n            log.info(&quot;===========================request begin================================================&quot;);\r\n            log.info(&quot;URI         : {}&quot;, request.getURI());\r\n            log.info(&quot;Method      : {}&quot;, request.getMethod());\r\n            log.info(&quot;Headers     : {}&quot;, request.getHeaders());\r\n            log.info(&quot;Request body: {}&quot;, new String(body, UTF_8));\r\n            log.info(&quot;==========================request end================================================&quot;);\r\n        }\r\n    \r\n        private void traceResponse(ClientHttpResponse response) throws IOException {\r\n            StringBuilder inputStringBuilder = new StringBuilder();\r\n            try (BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(response.getBody(), UTF_8))) {\r\n                String line = bufferedReader.readLine();\r\n                while (line != null) {\r\n                    inputStringBuilder.append(line);\r\n                    inputStringBuilder.append(LINE_BREAK);\r\n                    line = bufferedReader.readLine();\r\n                }\r\n            }\r\n    \r\n            log.info(&quot;============================response begin==========================================&quot;);\r\n            log.info(&quot;Status code  : {}&quot;, response.getStatusCode());\r\n            log.info(&quot;Status text  : {}&quot;, response.getStatusText());\r\n            log.info(&quot;Headers      : {}&quot;, response.getHeaders());\r\n            log.info(&quot;Response body: {}&quot;, inputStringBuilder);\r\n            log.info(&quot;=======================response end=================================================&quot;);\r\n        }\r\n    \r\n    }","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>As @MilacH pointed out, there is an error in the implementation. If an statusCode > 400 is returned a IOException is thrown, as the errorHandler is not invoked, from interceptors. The exception can be ignored and is then caught again in the handler method.</p>\n\n<pre><code>package net.sprd.fulfillment.common;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.http.HttpRequest;\nimport org.springframework.http.client.ClientHttpRequestExecution;\nimport org.springframework.http.client.ClientHttpRequestInterceptor;\nimport org.springframework.http.client.ClientHttpResponse;\n\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\nimport static java.nio.charset.StandardCharsets.UTF_8;\n\npublic class LoggingRequestInterceptor implements ClientHttpRequestInterceptor {\n\n    final static Logger log = LoggerFactory.getLogger(LoggingRequestInterceptor.class);\n\n    @SuppressWarnings(\"HardcodedLineSeparator\")\n    public static final char LINE_BREAK = '\\n';\n\n    @Override\n    public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\n        try {\n            traceRequest(request, body);\n        } catch (Exception e) {\n            log.warn(\"Exception in LoggingRequestInterceptor while tracing request\", e);\n        }\n\n        ClientHttpResponse response = execution.execute(request, body);\n\n        try {\n            traceResponse(response);\n        } catch (IOException e) {\n            // ignore the exception here, as it will be handled by the error handler of the restTemplate\n            log.warn(\"Exception in LoggingRequestInterceptor\", e);\n        }\n        return response;\n    }\n\n    private void traceRequest(HttpRequest request, byte[] body) {\n        log.info(\"===========================request begin================================================\");\n        log.info(\"URI         : {}\", request.getURI());\n        log.info(\"Method      : {}\", request.getMethod());\n        log.info(\"Headers     : {}\", request.getHeaders());\n        log.info(\"Request body: {}\", new String(body, UTF_8));\n        log.info(\"==========================request end================================================\");\n    }\n\n    private void traceResponse(ClientHttpResponse response) throws IOException {\n        StringBuilder inputStringBuilder = new StringBuilder();\n        try (BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(response.getBody(), UTF_8))) {\n            String line = bufferedReader.readLine();\n            while (line != null) {\n                inputStringBuilder.append(line);\n                inputStringBuilder.append(LINE_BREAK);\n                line = bufferedReader.readLine();\n            }\n        }\n\n        log.info(\"============================response begin==========================================\");\n        log.info(\"Status code  : {}\", response.getStatusCode());\n        log.info(\"Status text  : {}\", response.getStatusText());\n        log.info(\"Headers      : {}\", response.getHeaders());\n        log.info(\"Response body: {}\", inputStringBuilder);\n        log.info(\"=======================response end=================================================\");\n    }\n\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":1009178,"reputation":12360,"user_id":1022141,"accept_rate":96,"display_name":"Udo Held"},"score":1,"creation_date":1568859182,"post_id":52698745,"comment_id":102411056,"body_markdown":"This one works with the 2019 Spring version keeping the body intact.","body":"This one works with the 2019 Spring version keeping the body intact."},{"owner":{"account_id":13384813,"reputation":955,"user_id":9659035,"display_name":"Moler"},"score":1,"creation_date":1589460326,"post_id":52698745,"comment_id":109306956,"body_markdown":"Works on Spring 2.1.10 :) Thanks","body":"Works on Spring 2.1.10 :) Thanks"},{"owner":{"account_id":1993212,"reputation":51,"user_id":1786741,"display_name":"Bruno T. Abrah&#227;o"},"score":1,"creation_date":1654204130,"post_id":52698745,"comment_id":128042205,"body_markdown":"I was struggling when trying this solution, I thought it wasn&#39;t working, then I figured out that the logs were added as Debug, so after I set my log level to DEBUG, the logs showed up.\nI know it&#39;s kinda obvious (my bad I didn&#39;t notice that), but I think it&#39;s worth to include this info on your solution, which is pretty good, BTW. For me, this info would have saved some investigation time lol.\nAfter that, I could find out what I was doing wrong in my request body. Excellent approach! Thanks. :)","body":"I was struggling when trying this solution, I thought it wasn&#39;t working, then I figured out that the logs were added as Debug, so after I set my log level to DEBUG, the logs showed up. I know it&#39;s kinda obvious (my bad I didn&#39;t notice that), but I think it&#39;s worth to include this info on your solution, which is pretty good, BTW. For me, this info would have saved some investigation time lol. After that, I could find out what I was doing wrong in my request body. Excellent approach! Thanks. :)"},{"owner":{"account_id":10798342,"reputation":318,"user_id":7943248,"display_name":"Zeuzif"},"score":0,"creation_date":1679399623,"post_id":52698745,"comment_id":133711316,"body_markdown":"`BufferedClientHttpResponse` causes a memory leak because you have a reference to response objet","body":"<code>BufferedClientHttpResponse</code> causes a memory leak because you have a reference to response objet"}],"tags":[],"owner":{"account_id":24801,"reputation":15286,"user_id":63293,"accept_rate":50,"display_name":"Peter Walser"},"comment_count":4,"down_vote_count":0,"up_vote_count":19,"is_accepted":false,"score":19,"last_activity_date":1590498083,"creation_date":1538989271,"answer_id":52698745,"question_id":7952154,"body_markdown":"As stated in the other responses, the response body needs special treatment so it can be read repeatedly (by default, its contents get consumed on the first read).\r\n\r\nInstead of using the `BufferingClientHttpRequestFactory` when setting up the request, the interceptor itself can **wrap the response and make sure the content is retained and can be repeatedly read** (by the logger as well as by the consumer of the response):\r\n\r\nMy interceptor, which\r\n\r\n- **buffers the response body** using a wrapper\r\n- logs in a **more compact way**\r\n- logs the **status code identifier** as well (e.g. 201 Created)\r\n- includes a **request sequence number** allowing to easily distinguish concurrent log entries from multiple threads\r\n\r\nCode:\r\n\r\n    public class LoggingInterceptor implements ClientHttpRequestInterceptor {\r\n    \r\n        private final Logger log = LoggerFactory.getLogger(getClass());\r\n        private AtomicInteger requestNumberSequence = new AtomicInteger(0);\r\n    \r\n        @Override\r\n        public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\r\n            int requestNumber = requestNumberSequence.incrementAndGet();\r\n            logRequest(requestNumber, request, body);\r\n            ClientHttpResponse response = execution.execute(request, body);\r\n            response = new BufferedClientHttpResponse(response);\r\n            logResponse(requestNumber, response);\r\n            return response;\r\n        }\r\n    \r\n        private void logRequest(int requestNumber, HttpRequest request, byte[] body) {\r\n            if (log.isDebugEnabled()) {\r\n                String prefix = requestNumber + &quot; &gt; &quot;;\r\n                log.debug(&quot;{} Request: {} {}&quot;, prefix, request.getMethod(), request.getURI());\r\n                log.debug(&quot;{} Headers: {}&quot;, prefix, request.getHeaders());\r\n                if (body.length &gt; 0) {\r\n                    log.debug(&quot;{} Body: \\n{}&quot;, prefix, new String(body, StandardCharsets.UTF_8));\r\n                }\r\n            }\r\n        }\r\n    \r\n        private void logResponse(int requestNumber, ClientHttpResponse response) throws IOException {\r\n            if (log.isDebugEnabled()) {\r\n                String prefix = requestNumber + &quot; &lt; &quot;;\r\n                log.debug(&quot;{} Response: {} {} {}&quot;, prefix, response.getStatusCode(), response.getStatusCode().name(), response.getStatusText());\r\n                log.debug(&quot;{} Headers: {}&quot;, prefix, response.getHeaders());\r\n                String body = StreamUtils.copyToString(response.getBody(), StandardCharsets.UTF_8);\r\n                if (body.length() &gt; 0) {\r\n                    log.debug(&quot;{} Body: \\n{}&quot;, prefix, body);\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Wrapper around ClientHttpResponse, buffers the body so it can be read repeatedly (for logging &amp; consuming the result).\r\n         */\r\n        private static class BufferedClientHttpResponse implements ClientHttpResponse {\r\n    \r\n            private final ClientHttpResponse response;\r\n            private byte[] body;\r\n    \r\n            public BufferedClientHttpResponse(ClientHttpResponse response) {\r\n                this.response = response;\r\n            }\r\n    \r\n            @Override\r\n            public HttpStatus getStatusCode() throws IOException {\r\n                return response.getStatusCode();\r\n            }\r\n    \r\n            @Override\r\n            public int getRawStatusCode() throws IOException {\r\n                return response.getRawStatusCode();\r\n            }\r\n    \r\n            @Override\r\n            public String getStatusText() throws IOException {\r\n                return response.getStatusText();\r\n            }\r\n    \r\n            @Override\r\n            public void close() {\r\n                response.close();\r\n            }\r\n    \r\n            @Override\r\n            public InputStream getBody() throws IOException {\r\n                if (body == null) {\r\n                    body = StreamUtils.copyToByteArray(response.getBody());\r\n                }\r\n                return new ByteArrayInputStream(body);\r\n            }\r\n    \r\n            @Override\r\n            public HttpHeaders getHeaders() {\r\n                return response.getHeaders();\r\n            }\r\n        }\r\n    }\r\n\r\nConfiguration:\r\n\r\n     @Bean\r\n        public RestTemplateBuilder restTemplateBuilder() {\r\n            return new RestTemplateBuilder()\r\n                    .additionalInterceptors(Collections.singletonList(new LoggingInterceptor()));\r\n        }\r\n\r\nExample log output:\r\n\r\n    2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &gt;  Request: POST http://localhost:53969/payment/v4/private/payment-lists/10022/templates\r\n    2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &gt;  Headers: {Accept=[application/json, application/json], Content-Type=[application/json;charset=UTF-8], Content-Length=[986]}\r\n    2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &gt;  Body: \r\n    {&quot;idKey&quot;:null, ...}\r\n    2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &lt;  Response: 200 OK \r\n    2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &lt;  Headers: {Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Date=[Mon, 08 Oct 2018 08:58:53 GMT]}\r\n    2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &lt;  Body: \r\n    { &quot;idKey&quot; : &quot;10022&quot;, ...  }","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>As stated in the other responses, the response body needs special treatment so it can be read repeatedly (by default, its contents get consumed on the first read).</p>\n\n<p>Instead of using the <code>BufferingClientHttpRequestFactory</code> when setting up the request, the interceptor itself can <strong>wrap the response and make sure the content is retained and can be repeatedly read</strong> (by the logger as well as by the consumer of the response):</p>\n\n<p>My interceptor, which</p>\n\n<ul>\n<li><strong>buffers the response body</strong> using a wrapper</li>\n<li>logs in a <strong>more compact way</strong></li>\n<li>logs the <strong>status code identifier</strong> as well (e.g. 201 Created)</li>\n<li>includes a <strong>request sequence number</strong> allowing to easily distinguish concurrent log entries from multiple threads</li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>public class LoggingInterceptor implements ClientHttpRequestInterceptor {\n\n    private final Logger log = LoggerFactory.getLogger(getClass());\n    private AtomicInteger requestNumberSequence = new AtomicInteger(0);\n\n    @Override\n    public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {\n        int requestNumber = requestNumberSequence.incrementAndGet();\n        logRequest(requestNumber, request, body);\n        ClientHttpResponse response = execution.execute(request, body);\n        response = new BufferedClientHttpResponse(response);\n        logResponse(requestNumber, response);\n        return response;\n    }\n\n    private void logRequest(int requestNumber, HttpRequest request, byte[] body) {\n        if (log.isDebugEnabled()) {\n            String prefix = requestNumber + \" &gt; \";\n            log.debug(\"{} Request: {} {}\", prefix, request.getMethod(), request.getURI());\n            log.debug(\"{} Headers: {}\", prefix, request.getHeaders());\n            if (body.length &gt; 0) {\n                log.debug(\"{} Body: \\n{}\", prefix, new String(body, StandardCharsets.UTF_8));\n            }\n        }\n    }\n\n    private void logResponse(int requestNumber, ClientHttpResponse response) throws IOException {\n        if (log.isDebugEnabled()) {\n            String prefix = requestNumber + \" &lt; \";\n            log.debug(\"{} Response: {} {} {}\", prefix, response.getStatusCode(), response.getStatusCode().name(), response.getStatusText());\n            log.debug(\"{} Headers: {}\", prefix, response.getHeaders());\n            String body = StreamUtils.copyToString(response.getBody(), StandardCharsets.UTF_8);\n            if (body.length() &gt; 0) {\n                log.debug(\"{} Body: \\n{}\", prefix, body);\n            }\n        }\n    }\n\n    /**\n     * Wrapper around ClientHttpResponse, buffers the body so it can be read repeatedly (for logging &amp; consuming the result).\n     */\n    private static class BufferedClientHttpResponse implements ClientHttpResponse {\n\n        private final ClientHttpResponse response;\n        private byte[] body;\n\n        public BufferedClientHttpResponse(ClientHttpResponse response) {\n            this.response = response;\n        }\n\n        @Override\n        public HttpStatus getStatusCode() throws IOException {\n            return response.getStatusCode();\n        }\n\n        @Override\n        public int getRawStatusCode() throws IOException {\n            return response.getRawStatusCode();\n        }\n\n        @Override\n        public String getStatusText() throws IOException {\n            return response.getStatusText();\n        }\n\n        @Override\n        public void close() {\n            response.close();\n        }\n\n        @Override\n        public InputStream getBody() throws IOException {\n            if (body == null) {\n                body = StreamUtils.copyToByteArray(response.getBody());\n            }\n            return new ByteArrayInputStream(body);\n        }\n\n        @Override\n        public HttpHeaders getHeaders() {\n            return response.getHeaders();\n        }\n    }\n}\n</code></pre>\n\n<p>Configuration:</p>\n\n<pre><code> @Bean\n    public RestTemplateBuilder restTemplateBuilder() {\n        return new RestTemplateBuilder()\n                .additionalInterceptors(Collections.singletonList(new LoggingInterceptor()));\n    }\n</code></pre>\n\n<p>Example log output:</p>\n\n<pre><code>2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &gt;  Request: POST http://localhost:53969/payment/v4/private/payment-lists/10022/templates\n2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &gt;  Headers: {Accept=[application/json, application/json], Content-Type=[application/json;charset=UTF-8], Content-Length=[986]}\n2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &gt;  Body: \n{\"idKey\":null, ...}\n2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &lt;  Response: 200 OK \n2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &lt;  Headers: {Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Date=[Mon, 08 Oct 2018 08:58:53 GMT]}\n2018-10-08 10:58:53 [main] DEBUG x.y.z.LoggingInterceptor - 2 &lt;  Body: \n{ \"idKey\" : \"10022\", ...  }\n</code></pre>\n"},{"comments":[{"owner":{"account_id":1773692,"reputation":452,"user_id":1617955,"display_name":"J.D"},"score":1,"creation_date":1554828558,"post_id":52708677,"comment_id":97891757,"body_markdown":"This worked for me using intellij and the regular install of fiddle. I edited the Run Configuration and set VM options to `-DproxySet=true -Dhttp.proxyHost=localhost -Dhttp.proxyPort=8888`.","body":"This worked for me using intellij and the regular install of fiddle. I edited the Run Configuration and set VM options to <code>-DproxySet=true -Dhttp.proxyHost=localhost -Dhttp.proxyPort=8888</code>."},{"owner":{"account_id":141852,"reputation":4322,"user_id":349169,"accept_rate":78,"display_name":"Chris"},"score":0,"creation_date":1564391989,"post_id":52708677,"comment_id":101001439,"body_markdown":"Thanks! This is a pretty elegant solution compared to writing your own Interceptor.","body":"Thanks! This is a pretty elegant solution compared to writing your own Interceptor."},{"owner":{"account_id":198768,"reputation":1124,"user_id":443633,"display_name":"michaelok"},"score":0,"creation_date":1632076768,"post_id":52708677,"comment_id":122390071,"body_markdown":"Yes, this is the direction we went and haven&#39;t gone back to messing w/ Spring / Interceptors / logging and so on. Though not Fiddler - we&#39;ve been using the TCP/IP Monitor eclipse plugin, likely there is something similar in IntelliJ. For me Fiddler is great, but causes various issues with certificates, VPNs, so, depending on your environment, it might not be the ideal solution.","body":"Yes, this is the direction we went and haven&#39;t gone back to messing w/ Spring / Interceptors / logging and so on. Though not Fiddler - we&#39;ve been using the TCP/IP Monitor eclipse plugin, likely there is something similar in IntelliJ. For me Fiddler is great, but causes various issues with certificates, VPNs, so, depending on your environment, it might not be the ideal solution."}],"tags":[],"owner":{"account_id":13731912,"reputation":51,"user_id":10474951,"display_name":"Lee Burch"},"comment_count":3,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1539025929,"creation_date":1539025929,"answer_id":52708677,"question_id":7952154,"body_markdown":"So many responses here require coding changes and customized classes and it really is not necessary.  Gte a debugging proxy such as fiddler and set your java environment to use the proxy on the command line (-Dhttp.proxyHost and -Dhttp.proxyPort) then run fiddler and you can see the requests and responses in their entirety.  Also comes with many ancillary advantages such as the ability to tinker with the results and responses before and after they are sent to run experiments before committing to modification of the server.\r\n\r\nLast bit of an issue that can come up is if you must use HTTPS, you will need to export the SSL cert from fiddler and import it into the java keystore (cacerts) hint: default java keystore password is usually &quot;changeit&quot;.","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>So many responses here require coding changes and customized classes and it really is not necessary.  Gte a debugging proxy such as fiddler and set your java environment to use the proxy on the command line (-Dhttp.proxyHost and -Dhttp.proxyPort) then run fiddler and you can see the requests and responses in their entirety.  Also comes with many ancillary advantages such as the ability to tinker with the results and responses before and after they are sent to run experiments before committing to modification of the server.</p>\n\n<p>Last bit of an issue that can come up is if you must use HTTPS, you will need to export the SSL cert from fiddler and import it into the java keystore (cacerts) hint: default java keystore password is usually \"changeit\".</p>\n"},{"tags":[],"owner":{"account_id":9326848,"reputation":402,"user_id":6923823,"display_name":"Elton Sandr&#233;"},"comment_count":0,"down_vote_count":2,"up_vote_count":15,"is_accepted":false,"score":13,"last_activity_date":1564043509,"creation_date":1547152291,"answer_id":54136474,"question_id":7952154,"body_markdown":"\r\n**application.properties**\r\n\r\n    logging.level.org.springframework.web.client=DEBUG\r\n\r\n\r\n\r\n**application.yml**\r\n\r\n    logging:\r\n      level:  \r\n        root: WARN\r\n        org.springframework.web.client: DEBUG\r\n\r\n","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p><strong>application.properties</strong></p>\n\n<pre><code>logging.level.org.springframework.web.client=DEBUG\n</code></pre>\n\n<p><strong>application.yml</strong></p>\n\n<pre><code>logging:\n  level:  \n    root: WARN\n    org.springframework.web.client: DEBUG\n</code></pre>\n"},{"comments":[{"owner":{"account_id":2200953,"reputation":3860,"user_id":2661700,"accept_rate":86,"display_name":"Yubaraj"},"score":3,"creation_date":1565328365,"post_id":57252427,"comment_id":101326312,"body_markdown":"No. 4 is the easiest way to debug.","body":"No. 4 is the easiest way to debug."},{"owner":{"account_id":1221842,"reputation":380,"user_id":1188345,"display_name":"caglar"},"score":2,"creation_date":1574926831,"post_id":57252427,"comment_id":104403673,"body_markdown":"No. 2 worked for me. It logs body of request. Thank you!","body":"No. 2 worked for me. It logs body of request. Thank you!"},{"owner":{"account_id":14725244,"reputation":482,"user_id":10634487,"display_name":"Bill Naylor"},"score":1,"creation_date":1581098794,"post_id":57252427,"comment_id":106329451,"body_markdown":"I found No. 3 an easy way to do this when I came to this issue.","body":"I found No. 3 an easy way to do this when I came to this issue."}],"tags":[],"owner":{"account_id":141852,"reputation":4322,"user_id":349169,"accept_rate":78,"display_name":"Chris"},"comment_count":3,"down_vote_count":0,"up_vote_count":24,"is_accepted":false,"score":24,"last_activity_date":1564860015,"creation_date":1564398010,"answer_id":57252427,"question_id":7952154,"body_markdown":"# ---- July 2019 ---- \n# *(using Spring Boot)*\n\nI was surprised that Spring Boot, with all it&#39;s Zero Configuration magic, doesn&#39;t provide an easy way to inspect or log a simple JSON response body with RestTemplate. I looked through the various answers and comments provided here, and am sharing my own distilled version of what (still) works and seems to me like a reasonable solution, given the current options (I&#39;m using Spring Boot 2.1.6 with Gradle 4.4)\n\n## 1. Using Fiddler as http proxy\n\nThis is actually quite an elegant solution, as it bypasses all the cumbersome efforts of creating your own interceptor or changing the underlying http client to apache (see below).\n\n&gt; Install and run [Fiddler][1]\n\nand then\n\n&gt; add `-DproxySet=true -Dhttp.proxyHost=localhost -Dhttp.proxyPort=8888` to your VM Options\n\n## 2. Using Apache HttpClient\n\nAdd Apache HttpClient to your Maven or Gradle dependencies.\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\n        &lt;artifactId&gt;httpclient&lt;/artifactId&gt;\n        &lt;version&gt;4.5.9&lt;/version&gt;\n    &lt;/dependency&gt;\n\nUse `HttpComponentsClientHttpRequestFactory` as RequestFactory for RestTemplate. The simplest way to do that would be: \n\n&gt; `RestTemplate restTemplate = new RestTemplate();`\n&gt;\n&gt; `restTemplate.setRequestFactory(new HttpComponentsClientHttpRequestFactory());`\n\nEnable DEBUG in your `application.properties` file (if you&#39;re using Spring Boot)\n\n&gt; `logging.level.org.apache.http=DEBUG`\n\nIf you&#39;re using Spring Boot, you&#39;ll need to make sure you have a logging framework set up, e.g. by using a spring-boot-starter dependency that includes `spring-boot-starter-logging`.\n\n## 3. Use an Interceptor\n\nI&#39;ll let you read through the proposals, counter-proposals, and gotchas in the other answers and comments and decide for yourself if you want to go down that path.\n\n## 4. Log URL and Response Status without Body\n\nAlthough this doesn&#39;t meet the stated requirements of logging the body, it&#39;s a quick and simple way to start logging your REST calls. It displays the full URL and response status.\n\nSimply add the following line to your `application.properties` file (assuming you&#39;re using Spring Boot, and assuming you are using a spring boot starter dependency that includes `spring-boot-starter-logging`)\n\n&gt; logging.level.org.springframework.web.client.RestTemplate=DEBUG\n\nThe output will look something like this:\n\n    2019-07-29 11:53:50.265 DEBUG o.s.web.client.RestTemplate : HTTP GET http://www.myrestservice.com/Endpoint?myQueryParam=myValue\n    2019-07-29 11:53:50.276 DEBUG o.s.web.client.RestTemplate : Accept=[application/json]\n    2019-07-29 11:53:50.584 DEBUG o.s.web.client.RestTemplate : Response 200 OK\n    2019-07-29 11:53:50.585 DEBUG o.s.web.client.RestTemplate : Reading to [org.mynamespace.MyJsonModelClass]\n\n\n  [1]: https://www.telerik.com/fiddler","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<h1>---- July 2019 ----</h1>\n<h1><em>(using Spring Boot)</em></h1>\n<p>I was surprised that Spring Boot, with all it's Zero Configuration magic, doesn't provide an easy way to inspect or log a simple JSON response body with RestTemplate. I looked through the various answers and comments provided here, and am sharing my own distilled version of what (still) works and seems to me like a reasonable solution, given the current options (I'm using Spring Boot 2.1.6 with Gradle 4.4)</p>\n<h2>1. Using Fiddler as http proxy</h2>\n<p>This is actually quite an elegant solution, as it bypasses all the cumbersome efforts of creating your own interceptor or changing the underlying http client to apache (see below).</p>\n<blockquote>\n<p>Install and run <a href=\"https://www.telerik.com/fiddler\" rel=\"noreferrer\">Fiddler</a></p>\n</blockquote>\n<p>and then</p>\n<blockquote>\n<p>add <code>-DproxySet=true -Dhttp.proxyHost=localhost -Dhttp.proxyPort=8888</code> to your VM Options</p>\n</blockquote>\n<h2>2. Using Apache HttpClient</h2>\n<p>Add Apache HttpClient to your Maven or Gradle dependencies.</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\n    &lt;artifactId&gt;httpclient&lt;/artifactId&gt;\n    &lt;version&gt;4.5.9&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Use <code>HttpComponentsClientHttpRequestFactory</code> as RequestFactory for RestTemplate. The simplest way to do that would be:</p>\n<blockquote>\n<p><code>RestTemplate restTemplate = new RestTemplate();</code></p>\n<p><code>restTemplate.setRequestFactory(new HttpComponentsClientHttpRequestFactory());</code></p>\n</blockquote>\n<p>Enable DEBUG in your <code>application.properties</code> file (if you're using Spring Boot)</p>\n<blockquote>\n<p><code>logging.level.org.apache.http=DEBUG</code></p>\n</blockquote>\n<p>If you're using Spring Boot, you'll need to make sure you have a logging framework set up, e.g. by using a spring-boot-starter dependency that includes <code>spring-boot-starter-logging</code>.</p>\n<h2>3. Use an Interceptor</h2>\n<p>I'll let you read through the proposals, counter-proposals, and gotchas in the other answers and comments and decide for yourself if you want to go down that path.</p>\n<h2>4. Log URL and Response Status without Body</h2>\n<p>Although this doesn't meet the stated requirements of logging the body, it's a quick and simple way to start logging your REST calls. It displays the full URL and response status.</p>\n<p>Simply add the following line to your <code>application.properties</code> file (assuming you're using Spring Boot, and assuming you are using a spring boot starter dependency that includes <code>spring-boot-starter-logging</code>)</p>\n<blockquote>\n<p>logging.level.org.springframework.web.client.RestTemplate=DEBUG</p>\n</blockquote>\n<p>The output will look something like this:</p>\n<pre><code>2019-07-29 11:53:50.265 DEBUG o.s.web.client.RestTemplate : HTTP GET http://www.myrestservice.com/Endpoint?myQueryParam=myValue\n2019-07-29 11:53:50.276 DEBUG o.s.web.client.RestTemplate : Accept=[application/json]\n2019-07-29 11:53:50.584 DEBUG o.s.web.client.RestTemplate : Response 200 OK\n2019-07-29 11:53:50.585 DEBUG o.s.web.client.RestTemplate : Reading to [org.mynamespace.MyJsonModelClass]\n</code></pre>\n"},{"comments":[{"owner":{"account_id":4182503,"reputation":2396,"user_id":3427079,"accept_rate":87,"display_name":"G_V"},"score":0,"creation_date":1588839144,"post_id":58187536,"comment_id":109055478,"body_markdown":"What logback configuration file?","body":"What logback configuration file?"},{"owner":{"account_id":1577409,"reputation":16015,"user_id":1463522,"accept_rate":64,"display_name":"holmis83"},"score":1,"creation_date":1588843682,"post_id":58187536,"comment_id":109057850,"body_markdown":"@G_V logback.xml or logback-test.xml for tests.","body":"@G_V logback.xml or logback-test.xml for tests."},{"owner":{"account_id":4182503,"reputation":2396,"user_id":3427079,"accept_rate":87,"display_name":"G_V"},"score":1,"creation_date":1588850481,"post_id":58187536,"comment_id":109061558,"body_markdown":"It also works with `org.apache.http.wire=DEBUG` in your `application.properties` now","body":"It also works with <code>org.apache.http.wire=DEBUG</code> in your <code>application.properties</code> now"},{"owner":{"account_id":1577409,"reputation":16015,"user_id":1463522,"accept_rate":64,"display_name":"holmis83"},"score":0,"creation_date":1588928455,"post_id":58187536,"comment_id":109094218,"body_markdown":"@G_V if you are using Spring-Boot. My answer works without Boot.","body":"@G_V if you are using Spring-Boot. My answer works without Boot."}],"tags":[],"owner":{"account_id":1577409,"reputation":16015,"user_id":1463522,"accept_rate":64,"display_name":"holmis83"},"comment_count":4,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1569941865,"creation_date":1569941865,"answer_id":58187536,"question_id":7952154,"body_markdown":"For logging to **Logback** with help from Apache HttpClient:\r\n\r\nYou need Apache HttpClient in classpath:\r\n\r\n&lt;!-- language: lang-xml --&gt;\r\n\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\r\n      &lt;artifactId&gt;httpclient&lt;/artifactId&gt;\r\n      &lt;version&gt;4.5.10&lt;/version&gt;\r\n    &lt;/dependency&gt;\r\n\r\nConfigure your `RestTemplate` to use HttpClient:\r\n\r\n&lt;!-- language: lang-java --&gt;\r\n\r\n    restTemplate.setRequestFactory(new HttpComponentsClientHttpRequestFactory());\r\n\r\nTo log requests and responses, add to Logback configuration file:\r\n\r\n&lt;!-- language: lang-xml --&gt;\r\n\r\n    &lt;logger name=&quot;org.apache.http.wire&quot; level=&quot;DEBUG&quot;/&gt;\r\n\r\nOr to log even more:\r\n\r\n&lt;!-- language: lang-xml --&gt;\r\n\r\n    &lt;logger name=&quot;org.apache.http&quot; level=&quot;DEBUG&quot;/&gt;\r\n","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>For logging to <strong>Logback</strong> with help from Apache HttpClient:</p>\n\n<p>You need Apache HttpClient in classpath:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\n  &lt;artifactId&gt;httpclient&lt;/artifactId&gt;\n  &lt;version&gt;4.5.10&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>Configure your <code>RestTemplate</code> to use HttpClient:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>restTemplate.setRequestFactory(new HttpComponentsClientHttpRequestFactory());\n</code></pre>\n\n<p>To log requests and responses, add to Logback configuration file:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;logger name=\"org.apache.http.wire\" level=\"DEBUG\"/&gt;\n</code></pre>\n\n<p>Or to log even more:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;logger name=\"org.apache.http\" level=\"DEBUG\"/&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4356026,"reputation":1989,"user_id":3554624,"display_name":"panser"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1617786090,"creation_date":1580295632,"answer_id":59965640,"question_id":7952154,"body_markdown":" `org.apache.http.wire` gives too unreadable logs, so I use [logbook][1] to log application Servlet and RestTemplate requests &amp; responses with payloads.\r\n\r\n`build.gradle`:\r\n```groovy\r\ncompile group: &#39;org.zalando&#39;, name: &#39;logbook-spring-boot-starter&#39;, version: &#39;2.6.2&#39;\r\n```\r\n\r\nor Maven dependency:\r\n```xml\r\n&lt;dependency&gt;\r\n    &lt;groupId&gt;org.zalando&lt;/groupId&gt;\r\n    &lt;artifactId&gt;logbook-spring-boot-starter&lt;/artifactId&gt;\r\n    &lt;version&gt;2.6.2&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```\r\n\r\n`application.properties` (or trough YAML):\r\n```properties\r\nlogging.level.org.zalando.logbook = TRACE\r\n```\r\n\r\n`RestTemplate.java`:\r\n```java\r\nimport java.util.function.Supplier;\r\n\r\nimport org.apache.http.impl.client.CloseableHttpClient;\r\nimport org.apache.http.impl.client.HttpClientBuilder;\r\nimport org.springframework.boot.web.client.RestTemplateBuilder;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.http.client.ClientHttpRequestFactory;\r\nimport org.springframework.http.client.HttpComponentsClientHttpRequestFactory;\r\nimport org.springframework.web.client.RestTemplate;\r\nimport org.zalando.logbook.httpclient.LogbookHttpRequestInterceptor;\r\nimport org.zalando.logbook.httpclient.LogbookHttpResponseInterceptor;\r\n\r\n@Configuration\r\npublic class RestTemplateConfiguration {\r\n    private final LogbookHttpRequestInterceptor logbookHttpRequestInterceptor;\r\n    private final LogbookHttpResponseInterceptor logbookHttpResponseInterceptor;\r\n\r\n    public RestTemplateConfiguration(LogbookHttpRequestInterceptor logbookHttpRequestInterceptor,\r\n            LogbookHttpResponseInterceptor logbookHttpResponseInterceptor) {\r\n        this.logbookHttpRequestInterceptor = logbookHttpRequestInterceptor;\r\n        this.logbookHttpResponseInterceptor = logbookHttpResponseInterceptor;\r\n    }\r\n\r\n    @Bean\r\n    public RestTemplate restTemplate(RestTemplateBuilder restTemplateBuilder) {\r\n        return restTemplateBuilder\r\n                .requestFactory(new MyRequestFactorySupplier())\r\n                .build();\r\n    }\r\n\r\n    class MyRequestFactorySupplier implements Supplier&lt;ClientHttpRequestFactory&gt; {\r\n        @Override\r\n        public ClientHttpRequestFactory get() {\r\n            // Using Apache HTTP client\r\n            CloseableHttpClient client = HttpClientBuilder.create()\r\n                    .addInterceptorFirst(logbookHttpRequestInterceptor)\r\n                    .addInterceptorFirst(logbookHttpResponseInterceptor)\r\n                    .build();\r\n            return new HttpComponentsClientHttpRequestFactory(client);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n\r\n  [1]: https://github.com/zalando/logbook","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p><code>org.apache.http.wire</code> gives too unreadable logs, so I use <a href=\"https://github.com/zalando/logbook\" rel=\"nofollow noreferrer\">logbook</a> to log application Servlet and RestTemplate requests &amp; responses with payloads.</p>\n<p><code>build.gradle</code>:</p>\n<pre><code>compile group: 'org.zalando', name: 'logbook-spring-boot-starter', version: '2.6.2'\n</code></pre>\n<p>or Maven dependency:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.zalando&lt;/groupId&gt;\n    &lt;artifactId&gt;logbook-spring-boot-starter&lt;/artifactId&gt;\n    &lt;version&gt;2.6.2&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p><code>application.properties</code> (or trough YAML):</p>\n<pre><code>logging.level.org.zalando.logbook = TRACE\n</code></pre>\n<p><code>RestTemplate.java</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.function.Supplier;\n\nimport org.apache.http.impl.client.CloseableHttpClient;\nimport org.apache.http.impl.client.HttpClientBuilder;\nimport org.springframework.boot.web.client.RestTemplateBuilder;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.http.client.ClientHttpRequestFactory;\nimport org.springframework.http.client.HttpComponentsClientHttpRequestFactory;\nimport org.springframework.web.client.RestTemplate;\nimport org.zalando.logbook.httpclient.LogbookHttpRequestInterceptor;\nimport org.zalando.logbook.httpclient.LogbookHttpResponseInterceptor;\n\n@Configuration\npublic class RestTemplateConfiguration {\n    private final LogbookHttpRequestInterceptor logbookHttpRequestInterceptor;\n    private final LogbookHttpResponseInterceptor logbookHttpResponseInterceptor;\n\n    public RestTemplateConfiguration(LogbookHttpRequestInterceptor logbookHttpRequestInterceptor,\n            LogbookHttpResponseInterceptor logbookHttpResponseInterceptor) {\n        this.logbookHttpRequestInterceptor = logbookHttpRequestInterceptor;\n        this.logbookHttpResponseInterceptor = logbookHttpResponseInterceptor;\n    }\n\n    @Bean\n    public RestTemplate restTemplate(RestTemplateBuilder restTemplateBuilder) {\n        return restTemplateBuilder\n                .requestFactory(new MyRequestFactorySupplier())\n                .build();\n    }\n\n    class MyRequestFactorySupplier implements Supplier&lt;ClientHttpRequestFactory&gt; {\n        @Override\n        public ClientHttpRequestFactory get() {\n            // Using Apache HTTP client\n            CloseableHttpClient client = HttpClientBuilder.create()\n                    .addInterceptorFirst(logbookHttpRequestInterceptor)\n                    .addInterceptorFirst(logbookHttpResponseInterceptor)\n                    .build();\n            return new HttpComponentsClientHttpRequestFactory(client);\n        }\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":20506220,"reputation":1455,"user_id":15048947,"display_name":"Md. Shahariar Hossen"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1642151125,"creation_date":1642151125,"answer_id":70708226,"question_id":7952154,"body_markdown":"**An easy way to solve the problem:**&lt;br&gt;\r\n1. **Create a Bean of RestTemplate using RestTemplateBuilder:** It will give you more control over connection time and reading time.\r\n```\r\n@Configuration\r\npublic class RestTemplateConfig {\r\n  @Bean\r\n  public RestTemplate restTemplate(RestTemplateBuilder builder) {\r\n    return builder\r\n      .setConnectTimeout(Duration.ofMillis(60000))\r\n      .setReadTimeout(Duration.ofMillis(60000))\r\n      .build();\r\n  }\r\n\r\n}\r\n```\r\n2. **Add this line to the `resources/application.properties` file**:\r\n```logging.level.org.springframework.web.client.RestTemplate=DEBUG```\r\n&lt;br&gt;Hope the problem will be resolved! ","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p><strong>An easy way to solve the problem:</strong><br></p>\n<ol>\n<li><strong>Create a Bean of RestTemplate using RestTemplateBuilder:</strong> It will give you more control over connection time and reading time.</li>\n</ol>\n<pre><code>@Configuration\npublic class RestTemplateConfig {\n  @Bean\n  public RestTemplate restTemplate(RestTemplateBuilder builder) {\n    return builder\n      .setConnectTimeout(Duration.ofMillis(60000))\n      .setReadTimeout(Duration.ofMillis(60000))\n      .build();\n  }\n\n}\n</code></pre>\n<ol start=\"2\">\n<li><strong>Add this line to the <code>resources/application.properties</code> file</strong>:\n<code>logging.level.org.springframework.web.client.RestTemplate=DEBUG</code>\n<br>Hope the problem will be resolved!</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":78239,"reputation":3012,"user_id":1904217,"accept_rate":95,"display_name":"Mostafa"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1657943702,"creation_date":1657943031,"answer_id":73001361,"question_id":7952154,"body_markdown":"I went through all answers, In case you need to set authentication type or connection time out, then you can do like this : \r\n\r\n\r\n    SimpleClientHttpRequestFactory factory = new SimpleClientHttpRequestFactory();\r\n    factory.setConnectTimeout(Integer.valueOf(YOUR_VALUE));\r\n    factory.setReadTimeout(Integer.valueOf(YOUR_VALUE));\r\n    \r\n    RestTemplate restTemplate = new RestTemplate(new BufferingClientHttpRequestFactory(factory));\r\n    restTemplate.getInterceptors().add(new LoggingRequestInterceptor());\r\n    restTemplate.getInterceptors().add(new BasicAuthenticationInterceptor(USER_NAME,PASSWORD,StandardCharsets.UTF_8));\r\n    return restTemplate;","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>I went through all answers, In case you need to set authentication type or connection time out, then you can do like this :</p>\n<pre><code>SimpleClientHttpRequestFactory factory = new SimpleClientHttpRequestFactory();\nfactory.setConnectTimeout(Integer.valueOf(YOUR_VALUE));\nfactory.setReadTimeout(Integer.valueOf(YOUR_VALUE));\n\nRestTemplate restTemplate = new RestTemplate(new BufferingClientHttpRequestFactory(factory));\nrestTemplate.getInterceptors().add(new LoggingRequestInterceptor());\nrestTemplate.getInterceptors().add(new BasicAuthenticationInterceptor(USER_NAME,PASSWORD,StandardCharsets.UTF_8));\nreturn restTemplate;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9941523,"reputation":1018,"user_id":7357959,"display_name":"Tsvetoslav Tsvetkov"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1676455380,"creation_date":1675758793,"answer_id":75370732,"question_id":7952154,"body_markdown":"Most of the above solution doesn&#39;t work properly when RestTemplate is used and there is a `4xx` or `5xx` response type as `ClientHttpResponse`&#39;s body is empty. Here is the solution that I used to log the whole HTTP request/response in RestTemplate without losing the response body information in all cases. The Spring boot version is `&lt;version&gt;2.7.5&lt;/version&gt;`\r\n\r\n1.Create `LoggingInterceptor` class\r\n\r\n    import lombok.extern.slf4j.Slf4j;\r\n    import org.springframework.http.HttpHeaders;\r\n    import org.springframework.http.HttpRequest;\r\n    import org.springframework.http.HttpStatus;\r\n    import org.springframework.http.client.ClientHttpRequestExecution;\r\n    import org.springframework.http.client.ClientHttpRequestInterceptor;\r\n    import org.springframework.http.client.ClientHttpResponse;\r\n    import org.springframework.stereotype.Component;\r\n    import org.springframework.util.StreamUtils;\r\n\r\n    import java.io.*;\r\n\r\n    @Component\r\n    @Slf4j\r\n    public class LoggingInterceptor implements ClientHttpRequestInterceptor {\r\n\r\n    @Override\r\n    public ClientHttpResponse intercept(final HttpRequest request, final byte[] body, final ClientHttpRequestExecution execution) throws IOException {\r\n        traceRequest(request, body);\r\n        ClientHttpResponse response = execution.execute(request, body);\r\n        response = traceResponse(response);\r\n        return response;\r\n    }\r\n\r\n    private void traceRequest(HttpRequest request, byte[] body) throws IOException {\r\n        if (!log.isDebugEnabled()) {\r\n            return;\r\n        }\r\n        log.debug(&quot;=========================== Request Begin ===========================&quot;);\r\n        log.debug(&quot;URI          : &quot; + request.getURI());\r\n        log.debug(&quot;Method       : &quot; + request.getMethod());\r\n        log.debug(&quot;Headers      : &quot; + request.getHeaders());\r\n        log.debug(&quot;Body : &quot; + new String(body, &quot;utf-8&quot;));\r\n        log.debug(&quot;============================ Request End ============================&quot;);\r\n\r\n    }\r\n\r\n    private ClientHttpResponse traceResponse(ClientHttpResponse response) throws IOException {\r\n        if (!log.isDebugEnabled()) {\r\n            return response;\r\n        }\r\n        ClientHttpResponse newCopiedResponse = new BufferingClientHttpResponseWrapper(response);\r\n        StringBuilder inputStringBuilder = new StringBuilder();\r\n        // ClientHttpResponse there is no body in response in case of 4xx or 5xx code, so we skip the body part\r\n        if (isSuccessStatus(response.getRawStatusCode())) {\r\n            inputStringBuilder = new StringBuilder();\r\n            BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(newCopiedResponse.getBody(), &quot;UTF-8&quot;));\r\n            String line = bufferedReader.readLine();\r\n            while (line != null) {\r\n                inputStringBuilder.append(line);\r\n                line = bufferedReader.readLine();\r\n            }\r\n        }\r\n\r\n        log.debug(&quot;=========================== Response Begin ===========================&quot;);\r\n        log.debug(&quot;Status code   : {}&quot;, response.getStatusCode());\r\n        log.debug(&quot;Status text   : {}&quot;, response.getStatusText());\r\n        log.debug(&quot;Headers       : {}&quot;, response.getHeaders());\r\n        if (isSuccessStatus(response.getRawStatusCode())) {\r\n            log.debug(&quot;Response Body : {}&quot;, inputStringBuilder.toString());\r\n            log.debug(&quot;============================ Response End ============================&quot;);\r\n        }\r\n\r\n        return newCopiedResponse;\r\n\r\n    }\r\n\r\n    private static boolean isSuccessStatus(int statusCode) {\r\n        return (statusCode / 100) == 2;\r\n    }\r\n\r\n\r\n    /**\r\n     * Wrapper around ClientHttpResponse, buffers the body so it can be read repeatedly (for logging &amp; consuming the result).\r\n     */\r\n    private static class BufferingClientHttpResponseWrapper implements ClientHttpResponse {\r\n\r\n        private final ClientHttpResponse response;\r\n        private byte[] body;\r\n\r\n        public BufferingClientHttpResponseWrapper(ClientHttpResponse response) {\r\n            this.response = response;\r\n        }\r\n\r\n        @Override\r\n        public InputStream getBody() throws IOException {\r\n            if (body == null) {\r\n                body = StreamUtils.copyToByteArray(response.getBody());\r\n            }\r\n            return new ByteArrayInputStream(body);\r\n        }\r\n\r\n        @Override\r\n        public HttpStatus getStatusCode() throws IOException {\r\n            return this.response.getStatusCode();\r\n        }\r\n\r\n        @Override\r\n        public int getRawStatusCode() throws IOException {\r\n            return this.response.getRawStatusCode();\r\n        }\r\n\r\n        @Override\r\n        public String getStatusText() throws IOException {\r\n            return this.response.getStatusText();\r\n        }\r\n\r\n        @Override\r\n        public HttpHeaders getHeaders() {\r\n            return this.response.getHeaders();\r\n        }\r\n\r\n        @Override\r\n        public void close() {\r\n            this.response.close();\r\n        }\r\n    }\r\n\r\n}\r\n\r\n2.Attach it to the `RestTemplate` bean\r\n\r\n    @Configuration\r\n    public class RestTemplateConfig {\r\n    \r\n        @Bean\r\n        public RestTemplate createRestTemplate(LoggingInterceptor loggingInterceptor) {\r\n    \r\n            RestTemplate restTemplate = new RestTemplate();\r\n            restTemplate.setInterceptors(Collections.singletonList(loggingInterceptor));\r\n    \r\n            return restTemplate;\r\n        }\r\n    }\r\n\r\n3.Apply the appropriate level in the application \r\n\r\n    logging:\r\n      level:\r\n        com:\r\n          test: DEBUG","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>Most of the above solution doesn't work properly when RestTemplate is used and there is a <code>4xx</code> or <code>5xx</code> response type as <code>ClientHttpResponse</code>'s body is empty. Here is the solution that I used to log the whole HTTP request/response in RestTemplate without losing the response body information in all cases. The Spring boot version is <code>&lt;version&gt;2.7.5&lt;/version&gt;</code></p>\n<p>1.Create <code>LoggingInterceptor</code> class</p>\n<pre><code>import lombok.extern.slf4j.Slf4j;\nimport org.springframework.http.HttpHeaders;\nimport org.springframework.http.HttpRequest;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.client.ClientHttpRequestExecution;\nimport org.springframework.http.client.ClientHttpRequestInterceptor;\nimport org.springframework.http.client.ClientHttpResponse;\nimport org.springframework.stereotype.Component;\nimport org.springframework.util.StreamUtils;\n\nimport java.io.*;\n\n@Component\n@Slf4j\npublic class LoggingInterceptor implements ClientHttpRequestInterceptor {\n\n@Override\npublic ClientHttpResponse intercept(final HttpRequest request, final byte[] body, final ClientHttpRequestExecution execution) throws IOException {\n    traceRequest(request, body);\n    ClientHttpResponse response = execution.execute(request, body);\n    response = traceResponse(response);\n    return response;\n}\n\nprivate void traceRequest(HttpRequest request, byte[] body) throws IOException {\n    if (!log.isDebugEnabled()) {\n        return;\n    }\n    log.debug(&quot;=========================== Request Begin ===========================&quot;);\n    log.debug(&quot;URI          : &quot; + request.getURI());\n    log.debug(&quot;Method       : &quot; + request.getMethod());\n    log.debug(&quot;Headers      : &quot; + request.getHeaders());\n    log.debug(&quot;Body : &quot; + new String(body, &quot;utf-8&quot;));\n    log.debug(&quot;============================ Request End ============================&quot;);\n\n}\n\nprivate ClientHttpResponse traceResponse(ClientHttpResponse response) throws IOException {\n    if (!log.isDebugEnabled()) {\n        return response;\n    }\n    ClientHttpResponse newCopiedResponse = new BufferingClientHttpResponseWrapper(response);\n    StringBuilder inputStringBuilder = new StringBuilder();\n    // ClientHttpResponse there is no body in response in case of 4xx or 5xx code, so we skip the body part\n    if (isSuccessStatus(response.getRawStatusCode())) {\n        inputStringBuilder = new StringBuilder();\n        BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(newCopiedResponse.getBody(), &quot;UTF-8&quot;));\n        String line = bufferedReader.readLine();\n        while (line != null) {\n            inputStringBuilder.append(line);\n            line = bufferedReader.readLine();\n        }\n    }\n\n    log.debug(&quot;=========================== Response Begin ===========================&quot;);\n    log.debug(&quot;Status code   : {}&quot;, response.getStatusCode());\n    log.debug(&quot;Status text   : {}&quot;, response.getStatusText());\n    log.debug(&quot;Headers       : {}&quot;, response.getHeaders());\n    if (isSuccessStatus(response.getRawStatusCode())) {\n        log.debug(&quot;Response Body : {}&quot;, inputStringBuilder.toString());\n        log.debug(&quot;============================ Response End ============================&quot;);\n    }\n\n    return newCopiedResponse;\n\n}\n\nprivate static boolean isSuccessStatus(int statusCode) {\n    return (statusCode / 100) == 2;\n}\n\n\n/**\n * Wrapper around ClientHttpResponse, buffers the body so it can be read repeatedly (for logging &amp; consuming the result).\n */\nprivate static class BufferingClientHttpResponseWrapper implements ClientHttpResponse {\n\n    private final ClientHttpResponse response;\n    private byte[] body;\n\n    public BufferingClientHttpResponseWrapper(ClientHttpResponse response) {\n        this.response = response;\n    }\n\n    @Override\n    public InputStream getBody() throws IOException {\n        if (body == null) {\n            body = StreamUtils.copyToByteArray(response.getBody());\n        }\n        return new ByteArrayInputStream(body);\n    }\n\n    @Override\n    public HttpStatus getStatusCode() throws IOException {\n        return this.response.getStatusCode();\n    }\n\n    @Override\n    public int getRawStatusCode() throws IOException {\n        return this.response.getRawStatusCode();\n    }\n\n    @Override\n    public String getStatusText() throws IOException {\n        return this.response.getStatusText();\n    }\n\n    @Override\n    public HttpHeaders getHeaders() {\n        return this.response.getHeaders();\n    }\n\n    @Override\n    public void close() {\n        this.response.close();\n    }\n}\n</code></pre>\n<p>}</p>\n<p>2.Attach it to the <code>RestTemplate</code> bean</p>\n<pre><code>@Configuration\npublic class RestTemplateConfig {\n\n    @Bean\n    public RestTemplate createRestTemplate(LoggingInterceptor loggingInterceptor) {\n\n        RestTemplate restTemplate = new RestTemplate();\n        restTemplate.setInterceptors(Collections.singletonList(loggingInterceptor));\n\n        return restTemplate;\n    }\n}\n</code></pre>\n<p>3.Apply the appropriate level in the application</p>\n<pre><code>logging:\n  level:\n    com:\n      test: DEBUG\n</code></pre>\n"},{"tags":[],"owner":{"account_id":25661568,"reputation":43,"user_id":19427242,"display_name":"BigMouse"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700048264,"creation_date":1700048264,"answer_id":77487391,"question_id":7952154,"body_markdown":"From `spring boot 3`, the apache dependency is more recent and it is: `&lt;artifactId&gt;httpclient5&lt;/artifactId&gt;` which is used\r\n\r\nYou must then use the following property:`org.apache.hc.client5.http:DEBUG`. ","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>From <code>spring boot 3</code>, the apache dependency is more recent and it is: <code>&lt;artifactId&gt;httpclient5&lt;/artifactId&gt;</code> which is used</p>\n<p>You must then use the following property:<code>org.apache.hc.client5.http:DEBUG</code>.</p>\n"}],"owner":{"account_id":307979,"reputation":3127,"user_id":619596,"display_name":"Paul Sabou"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":349499,"favorite_count":0,"down_vote_count":0,"up_vote_count":271,"accepted_answer_id":7964142,"answer_count":31,"score":271,"last_activity_date":1700048264,"creation_date":1320055128,"question_id":7952154,"body_markdown":"I have been using the Spring RestTemplate for a while and I consistently hit a wall when I&#39;am trying to debug it&#39;s requests and responses. I&#39;m basically looking to see the same things as I see when I use curl with the &quot;verbose&quot; option turned on. For example :\r\n\r\n    curl -v http://twitter.com/statuses/public_timeline.rss\r\n\r\nWould display both the sent data and the received data (including the headers, cookies, etc.).\r\n\r\nI have checked some related posts like :\r\nhttps://stackoverflow.com/questions/3892018/how-do-i-log-response-in-spring-resttemplate\r\nbut I haven&#39;t managed to solve this issue.\r\n\r\nOne way to do this would be to actually change the RestTemplate source code and add some extra logging statements there, but I would find this approach really a last resort thing. There should be some way to tell Spring Web Client/RestTemplate to log everything in a much friendlier way.\r\n\r\n\r\nMy goal would be to be able to do this with code like :\r\n\r\n    restTemplate.put(&quot;http://someurl&quot;, objectToPut, urlPathValues);\r\nand then to get the same type of debug information (as I get with curl) in the log file or in the console.\r\nI believe this would be extremely useful for anyone that uses the Spring RestTemplate and has problems. Using curl to debug your RestTemplate problems just doesn&#39;t work (in some cases). \r\n\r\n\r\n","title":"Spring RestTemplate - how to enable full debugging/logging of requests/responses?","body":"<p>I have been using the Spring RestTemplate for a while and I consistently hit a wall when I'am trying to debug it's requests and responses. I'm basically looking to see the same things as I see when I use curl with the \"verbose\" option turned on. For example :</p>\n\n<pre><code>curl -v http://twitter.com/statuses/public_timeline.rss\n</code></pre>\n\n<p>Would display both the sent data and the received data (including the headers, cookies, etc.).</p>\n\n<p>I have checked some related posts like :\n<a href=\"https://stackoverflow.com/questions/3892018/how-do-i-log-response-in-spring-resttemplate\">How do I log response in Spring RestTemplate?</a>\nbut I haven't managed to solve this issue.</p>\n\n<p>One way to do this would be to actually change the RestTemplate source code and add some extra logging statements there, but I would find this approach really a last resort thing. There should be some way to tell Spring Web Client/RestTemplate to log everything in a much friendlier way.</p>\n\n<p>My goal would be to be able to do this with code like :</p>\n\n<pre><code>restTemplate.put(\"http://someurl\", objectToPut, urlPathValues);\n</code></pre>\n\n<p>and then to get the same type of debug information (as I get with curl) in the log file or in the console.\nI believe this would be extremely useful for anyone that uses the Spring RestTemplate and has problems. Using curl to debug your RestTemplate problems just doesn't work (in some cases). </p>\n"},{"tags":["java","azul-zulu","azul-zing","crac"],"answers":[{"tags":[],"owner":{"account_id":11106749,"reputation":3227,"user_id":8153713,"display_name":"Speakjava"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1684868330,"creation_date":1684868330,"answer_id":76317863,"question_id":76317788,"body_markdown":"This is not the way CRaC works. You need to think of it as a running application that has been paused. Just as you can&#39;t change the arguments to `main()` of a running application, you can&#39;t do this with CRaC.\r\n\r\nWhat you could do is use the `afterRestore()` method of a class that implements the `Resource` interface and read new values from some source (e.g. a file). \r\n","title":"Java CRaC resume from checkpoint with arguments","body":"<p>This is not the way CRaC works. You need to think of it as a running application that has been paused. Just as you can't change the arguments to <code>main()</code> of a running application, you can't do this with CRaC.</p>\n<p>What you could do is use the <code>afterRestore()</code> method of a class that implements the <code>Resource</code> interface and read new values from some source (e.g. a file).</p>\n"},{"tags":[],"owner":{"account_id":3221113,"reputation":33,"user_id":2718551,"display_name":"antonkozlov"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700048140,"creation_date":1700048140,"answer_id":77487382,"question_id":76317788,"body_markdown":"In theory, you can build this functionallity by adding a Resource into your program, that will read arguments from a file and call some java code. And then, prior restore, write the parameters to the file. \r\n\r\nIt all looks general enough to be implemented in the JDK. So since https://github.com/openjdk/crac/pull/16, you can pass a class name and arguments to run on restore. Please check the supplied JavaCompilerCRaC.java. \r\n\r\nAbility to run some java code is inteded to do some post-restore actions. For example, setting some parameters, etc. The command line looks like:\r\n\r\n```\r\njava -XX:CRaCRestoreFrom=cr ClassName arg1 arg2 ...\r\n```\r\n\r\nCRaC allows to set properties on restore by \r\n```\r\njava -XX:CRaCRestoreFrom=cr -DpropName=propValue\r\n```\r\n\r\nBut you can implement it yourself:\r\n\r\n```\r\npublic class Props {\r\n    public static void main(String[] args) throws Exception {\r\n        for (int i = 0; i &lt; args.length; i += 2) {\r\n            System.setProperty(args[i], args[i + 1]);\r\n        }\r\n        printProperties();\r\n    }\r\n}\r\n```\r\n\r\n```\r\njava -XX:CRaCRestoreFrom=cr Props propName propValue\r\n```\r\n\r\nSo the limit is what you can express with java code.\r\n\r\nFeedback on this functionallity would be appreciated.","title":"Java CRaC resume from checkpoint with arguments","body":"<p>In theory, you can build this functionallity by adding a Resource into your program, that will read arguments from a file and call some java code. And then, prior restore, write the parameters to the file.</p>\n<p>It all looks general enough to be implemented in the JDK. So since <a href=\"https://github.com/openjdk/crac/pull/16\" rel=\"nofollow noreferrer\">https://github.com/openjdk/crac/pull/16</a>, you can pass a class name and arguments to run on restore. Please check the supplied JavaCompilerCRaC.java.</p>\n<p>Ability to run some java code is inteded to do some post-restore actions. For example, setting some parameters, etc. The command line looks like:</p>\n<pre><code>java -XX:CRaCRestoreFrom=cr ClassName arg1 arg2 ...\n</code></pre>\n<p>CRaC allows to set properties on restore by</p>\n<pre><code>java -XX:CRaCRestoreFrom=cr -DpropName=propValue\n</code></pre>\n<p>But you can implement it yourself:</p>\n<pre><code>public class Props {\n    public static void main(String[] args) throws Exception {\n        for (int i = 0; i &lt; args.length; i += 2) {\n            System.setProperty(args[i], args[i + 1]);\n        }\n        printProperties();\n    }\n}\n</code></pre>\n<pre><code>java -XX:CRaCRestoreFrom=cr Props propName propValue\n</code></pre>\n<p>So the limit is what you can express with java code.</p>\n<p>Feedback on this functionallity would be appreciated.</p>\n"}],"owner":{"account_id":510727,"reputation":3230,"user_id":1062189,"display_name":"erdos"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":120,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1700048140,"creation_date":1684867484,"question_id":76317788,"body_markdown":"I am experimenting with CRaC on Azul JVM. I have built a checkpoint of my program with\r\n\r\n```\r\n$JAVA_CMD -XX:CRaCCheckpointTo=cr -jar target/cractest-0.1.0-standalone.jar\r\n```\r\n\r\nAnd I can restore it successfully with \r\n\r\n```\r\n$JAVA_CMD -XX:CRaCRestoreFrom=cr\r\n```\r\n\r\nIt works all right. In the next step, I want to pass arguments to the program on restore, so the program can pick it up, ideally just like the following:\r\n\r\n```\r\n$JAVA_CMD -XX:CRaCRestoreFrom=cr -- arg1 arg2 arg3\r\n```\r\n\r\nAnd normally I would access `arg1 arg2 arg3` in the `String[] args` parameter of `main`, but since we are resuming a checkpoint, we don&#39;t have access to that array anymore.\r\n\r\nHow could I still access the parameters on checkpoint restore? Is it available in some context object during runtime?\r\n\r\n","title":"Java CRaC resume from checkpoint with arguments","body":"<p>I am experimenting with CRaC on Azul JVM. I have built a checkpoint of my program with</p>\n<pre><code>$JAVA_CMD -XX:CRaCCheckpointTo=cr -jar target/cractest-0.1.0-standalone.jar\n</code></pre>\n<p>And I can restore it successfully with</p>\n<pre><code>$JAVA_CMD -XX:CRaCRestoreFrom=cr\n</code></pre>\n<p>It works all right. In the next step, I want to pass arguments to the program on restore, so the program can pick it up, ideally just like the following:</p>\n<pre><code>$JAVA_CMD -XX:CRaCRestoreFrom=cr -- arg1 arg2 arg3\n</code></pre>\n<p>And normally I would access <code>arg1 arg2 arg3</code> in the <code>String[] args</code> parameter of <code>main</code>, but since we are resuming a checkpoint, we don't have access to that array anymore.</p>\n<p>How could I still access the parameters on checkpoint restore? Is it available in some context object during runtime?</p>\n"},{"tags":["java","java-8","nio2"],"answers":[{"comments":[{"owner":{"account_id":1336579,"reputation":5252,"user_id":1279180,"accept_rate":74,"display_name":"nimo23"},"score":0,"creation_date":1409223635,"post_id":25546890,"comment_id":39889245,"body_markdown":"thanks, I made the changes in the source code. Do you know, how I can retain the format of the merged files into &quot;mergedFile&quot;-File? For example, the merged files have carriage returns or blank lines. When using the method above, all of this is not copied into the &quot;mergedFile&quot;.","body":"thanks, I made the changes in the source code. Do you know, how I can retain the format of the merged files into &quot;mergedFile&quot;-File? For example, the merged files have carriage returns or blank lines. When using the method above, all of this is not copied into the &quot;mergedFile&quot;."},{"owner":{"account_id":1098379,"reputation":14720,"user_id":1091466,"accept_rate":78,"display_name":"Marco Acierno"},"score":0,"creation_date":1409223715,"post_id":25546890,"comment_id":39889290,"body_markdown":"Not sure what you mean, but you can append manually new-line using writer.write(System.lineSeparator());","body":"Not sure what you mean, but you can append manually new-line using writer.write(System.lineSeparator());"},{"owner":{"account_id":1336579,"reputation":5252,"user_id":1279180,"accept_rate":74,"display_name":"nimo23"},"score":0,"creation_date":1409224339,"post_id":25546890,"comment_id":39889666,"body_markdown":"I am wondering which is more performant. The above solution or the solution in http://www.programcreek.com/2012/09/merge-files-in-java/. Do you know, which one is more performant?","body":"I am wondering which is more performant. The above solution or the solution in <a href=\"http://www.programcreek.com/2012/09/merge-files-in-java/\" rel=\"nofollow noreferrer\">programcreek.com/2012/09/merge-files-in-java</a>. Do you know, which one is more performant?"},{"owner":{"account_id":277144,"reputation":522,"user_id":570941,"display_name":"Michal Gruca"},"score":0,"creation_date":1409258086,"post_id":25546890,"comment_id":39909995,"body_markdown":"@nimo23 write a test for it. You&#39;ve got a large file so execute copying couple of times and check how much time one method took and how much the other.","body":"@nimo23 write a test for it. You&#39;ve got a large file so execute copying couple of times and check how much time one method took and how much the other."}],"tags":[],"owner":{"account_id":1098379,"reputation":14720,"user_id":1091466,"accept_rate":78,"display_name":"Marco Acierno"},"comment_count":4,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1409222720,"creation_date":1409222720,"answer_id":25546890,"question_id":25546750,"body_markdown":"With\r\n\r\n    Files.newBufferedReader(file).readLine()\r\n\r\nyou create a new Buffer everytime and it gets always reset in the first line.\r\n\r\nReplace with\r\n\r\n    BufferedReader reader = Files.newBufferedReader(file);\r\n    while ((line = reader.readLine()) != null) {\r\n      writer.write(line);\r\n    }\r\n\r\nand `.close()` the reader when done.","title":"Merge huge files without loading whole file into memory?","body":"<p>With</p>\n\n<pre><code>Files.newBufferedReader(file).readLine()\n</code></pre>\n\n<p>you create a new Buffer everytime and it gets always reset in the first line.</p>\n\n<p>Replace with</p>\n\n<pre><code>BufferedReader reader = Files.newBufferedReader(file);\nwhile ((line = reader.readLine()) != null) {\n  writer.write(line);\n}\n</code></pre>\n\n<p>and <code>.close()</code> the reader when done.</p>\n"},{"tags":[],"owner":{"account_id":960307,"reputation":107861,"user_id":984823,"display_name":"Joop Eggen"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1409224150,"creation_date":1409224150,"answer_id":25547362,"question_id":25546750,"body_markdown":"`readLine()` does not yield the line ending (&quot;\\n&quot; or &quot;\\r\\n&quot;). That was the error.\r\n\r\n    while ((line = reader.readLine()) != null) {\r\n        writer.write(line);\r\n        writer.write(&quot;\\r\\n&quot;); // Windows\r\n    }\r\n\r\nYou might also disregard this filtering of (possibly different) line endings, and use\r\n\r\n    try (OutputStream out = new FileOutputStream(file);\r\n        for (Path source : filesToBeMerged) {\r\n            Files.copy(path, out);\r\n            out.write(&quot;\\r\\n&quot;.getBytes(StandardCharsets.US_ASCII));\r\n        }\r\n    }\r\n\r\nThis writes a newline explicitly, in the case that the last line does not end with a line break.\r\n\r\nThere might still be a problem with the optional, ugly Unicode BOM character to mark the text as UTF-8/UTF-16LE/UTF-16BE at the beginning of the file.\r\n","title":"Merge huge files without loading whole file into memory?","body":"<p><code>readLine()</code> does not yield the line ending (\"\\n\" or \"\\r\\n\"). That was the error.</p>\n\n<pre><code>while ((line = reader.readLine()) != null) {\n    writer.write(line);\n    writer.write(\"\\r\\n\"); // Windows\n}\n</code></pre>\n\n<p>You might also disregard this filtering of (possibly different) line endings, and use</p>\n\n<pre><code>try (OutputStream out = new FileOutputStream(file);\n    for (Path source : filesToBeMerged) {\n        Files.copy(path, out);\n        out.write(\"\\r\\n\".getBytes(StandardCharsets.US_ASCII));\n    }\n}\n</code></pre>\n\n<p>This writes a newline explicitly, in the case that the last line does not end with a line break.</p>\n\n<p>There might still be a problem with the optional, ugly Unicode BOM character to mark the text as UTF-8/UTF-16LE/UTF-16BE at the beginning of the file.</p>\n"},{"comments":[{"owner":{"account_id":1336579,"reputation":5252,"user_id":1279180,"accept_rate":74,"display_name":"nimo23"},"score":1,"creation_date":1409230378,"post_id":25548570,"comment_id":39893527,"body_markdown":"Wow, this solution is really great - and the source code is so short. Thanks! Do you know a solution based on nio2 for SPLITTING A LARGE FILE into a set of smaller files? Actually, I am using something like that http://todayguesswhat.blogspot.de/2014/05/java-split-large-file-sample-code-high.html.","body":"Wow, this solution is really great - and the source code is so short. Thanks! Do you know a solution based on nio2 for SPLITTING A LARGE FILE into a set of smaller files? Actually, I am using something like that <a href=\"http://todayguesswhat.blogspot.de/2014/05/java-split-large-file-sample-code-high.html\" rel=\"nofollow noreferrer\">todayguesswhat.blogspot.de/2014/05/&hellip;</a>."},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":1,"creation_date":1409233225,"post_id":25548570,"comment_id":39895492,"body_markdown":"@nimo23: well, I think, when you try to understand the code of my answer, especially what [`FileChannel.transferTo`](http://docs.oracle.com/javase/7/docs/api/java/nio/channels/FileChannel.html#transferTo(long,%20long,%20java.nio.channels.WritableByteChannel)) does, you will realize how a solution for splitting can look like (read: very similar). If you have difficulties implementing it, you can open a new question.","body":"@nimo23: well, I think, when you try to understand the code of my answer, especially what <a href=\"http://docs.oracle.com/javase/7/docs/api/java/nio/channels/FileChannel.html#transferTo(long,%20long,%20java.nio.channels.WritableByteChannel)\" rel=\"nofollow noreferrer\"><code>FileChannel.transferTo</code></a> does, you will realize how a solution for splitting can look like (read: very similar). If you have difficulties implementing it, you can open a new question."},{"owner":{"account_id":1336579,"reputation":5252,"user_id":1279180,"accept_rate":74,"display_name":"nimo23"},"score":1,"creation_date":1409233599,"post_id":25548570,"comment_id":39895776,"body_markdown":"Okay, I will try it by my own and will provide a solution here!","body":"Okay, I will try it by my own and will provide a solution here!"},{"owner":{"account_id":1336579,"reputation":5252,"user_id":1279180,"accept_rate":74,"display_name":"nimo23"},"score":1,"creation_date":1409243481,"post_id":25548570,"comment_id":39902467,"body_markdown":"Okay I have posted a solution: http://stackoverflow.com/questions/25553673/split-very-large-text-file-by-max-rows. I cannot find a solution with nio2, as with nio2 the size of the splitted files can only be reduced by filesize. However, I want to split the text files by row numbers. Do you find a (better) solution for the splitTextFiles()-Method with nio2?","body":"Okay I have posted a solution: <a href=\"http://stackoverflow.com/questions/25553673/split-very-large-text-file-by-max-rows\" title=\"split very large text file by max rows\">stackoverflow.com/questions/25553673/&hellip;</a>. I cannot find a solution with nio2, as with nio2 the size of the splitted files can only be reduced by filesize. However, I want to split the text files by row numbers. Do you find a (better) solution for the splitTextFiles()-Method with nio2?"}],"tags":[],"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"comment_count":4,"down_vote_count":0,"up_vote_count":22,"is_accepted":true,"score":22,"last_activity_date":1409228016,"creation_date":1409228016,"answer_id":25548570,"question_id":25546750,"body_markdown":"If you want to merge two or more files efficiently you should ask yourself, why on earth are you using `char` based `Reader` and `Writer` to perform that task.\r\n\r\nBy using these classes you are performing a conversion of the file’s bytes to characters from the system’s default encoding to unicode and back from unicode to the system’s default encoding. This means the program has to perform two data conversion on the entire files.\r\n\r\nAnd, by the way, `BufferedReader` and `BufferedWriter` are by no means `NIO2` artifacts. These classes exists since the very first version of Java.\r\n\r\nWhen you are using byte-wise copying via real NIO functions, the files can be transferred without being touched by the Java application, in the best case the transfer will be performed directly in the file system’s buffer:\r\n\r\n    import static java.nio.file.StandardOpenOption.*;\r\n    \r\n    import java.io.IOException;\r\n    import java.nio.channels.FileChannel;\r\n    import java.nio.file.Path;\r\n    import java.nio.file.Paths;\r\n    \r\n    public class MergeFiles\r\n    {\r\n      public static void main(String[] arg) throws IOException {\r\n        if(arg.length&lt;2) {\r\n          System.err.println(&quot;Syntax: infiles... outfile&quot;);\r\n          System.exit(1);\r\n        }\r\n        Path outFile=Paths.get(arg[arg.length-1]);\r\n        System.out.println(&quot;TO &quot;+outFile);\r\n        try(FileChannel out=FileChannel.open(outFile, CREATE, WRITE)) {\r\n          for(int ix=0, n=arg.length-1; ix&lt;n; ix++) {\r\n            Path inFile=Paths.get(arg[ix]);\r\n            System.out.println(inFile+&quot;...&quot;);\r\n            try(FileChannel in=FileChannel.open(inFile, READ)) {\r\n              for(long p=0, l=in.size(); p&lt;l; )\r\n                p+=in.transferTo(p, l-p, out);\r\n            }\r\n          }\r\n        }\r\n        System.out.println(&quot;DONE.&quot;);\r\n      }\r\n    }\r\n\r\n","title":"Merge huge files without loading whole file into memory?","body":"<p>If you want to merge two or more files efficiently you should ask yourself, why on earth are you using <code>char</code> based <code>Reader</code> and <code>Writer</code> to perform that task.</p>\n\n<p>By using these classes you are performing a conversion of the file’s bytes to characters from the system’s default encoding to unicode and back from unicode to the system’s default encoding. This means the program has to perform two data conversion on the entire files.</p>\n\n<p>And, by the way, <code>BufferedReader</code> and <code>BufferedWriter</code> are by no means <code>NIO2</code> artifacts. These classes exists since the very first version of Java.</p>\n\n<p>When you are using byte-wise copying via real NIO functions, the files can be transferred without being touched by the Java application, in the best case the transfer will be performed directly in the file system’s buffer:</p>\n\n<pre><code>import static java.nio.file.StandardOpenOption.*;\n\nimport java.io.IOException;\nimport java.nio.channels.FileChannel;\nimport java.nio.file.Path;\nimport java.nio.file.Paths;\n\npublic class MergeFiles\n{\n  public static void main(String[] arg) throws IOException {\n    if(arg.length&lt;2) {\n      System.err.println(\"Syntax: infiles... outfile\");\n      System.exit(1);\n    }\n    Path outFile=Paths.get(arg[arg.length-1]);\n    System.out.println(\"TO \"+outFile);\n    try(FileChannel out=FileChannel.open(outFile, CREATE, WRITE)) {\n      for(int ix=0, n=arg.length-1; ix&lt;n; ix++) {\n        Path inFile=Paths.get(arg[ix]);\n        System.out.println(inFile+\"...\");\n        try(FileChannel in=FileChannel.open(inFile, READ)) {\n          for(long p=0, l=in.size(); p&lt;l; )\n            p+=in.transferTo(p, l-p, out);\n        }\n      }\n    }\n    System.out.println(\"DONE.\");\n  }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9090809,"reputation":21,"user_id":6766780,"display_name":"spearkkk"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700048134,"creation_date":1700048134,"answer_id":77487381,"question_id":25546750,"body_markdown":"I try to merge files to a file with 3 ways.\r\nI test these ways but I do not know which one is best...still.\r\nI thought that FileChannel is faster than others but it was not for me.\r\nPlease let me know if you guys have any concern.\r\n\r\n1. BufferedReader &amp; BufferedWrtier\r\n```java\r\n    private static void mergeFiles(List&lt;Path&gt; sources, Path destination) {\r\n        try (BufferedWriter writer = new BufferedWriter(new FileWriter(destination.toFile(), true))) {\r\n            for (Path path : sources) {\r\n                try (BufferedReader reader = new BufferedReader(new InputStreamReader(new FileInputStream(path.toFile())))) {\r\n                    String line;\r\n                    while ((line = reader.readLine()) != null) {\r\n                        writer.write(line);\r\n                        writer.newLine();\r\n                    }\r\n                } catch (IOException e) {\r\n                    throw new RuntimeException(e);\r\n                }\r\n            }\r\n        } catch (IOException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n```\r\n\r\n2. InputStream &amp; Files.copy\r\n```java\r\n    private static void mergeFiles2(List&lt;Path&gt; sources, Path destination) {\r\n        try {\r\n            BinaryOperator&lt;InputStream&gt; sequenceInputStream = SequenceInputStream::new;\r\n            List&lt;InputStream&gt; inputStreams = new ArrayList&lt;&gt;();\r\n\r\n            for (Path path : sources) {\r\n                InputStream is = Files.newInputStream(path, StandardOpenOption.READ);\r\n                inputStreams.add(is);\r\n            }\r\n\r\n            InputStream streams = inputStreams.parallelStream().reduce(sequenceInputStream).orElseThrow(() -&gt; new IllegalStateException(&quot;inputStreams reduce exception&quot;));\r\n            Files.copy(streams, destination, StandardCopyOption.REPLACE_EXISTING);\r\n        } catch (IOException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n```\r\n\r\n3. File Channel\r\n```java\r\n    private static void mergeFiles3(List&lt;Path&gt; sources, Path destination) {\r\n        try (FileChannel desChannel = FileChannel.open(destination, StandardOpenOption.WRITE, StandardOpenOption.CREATE)) {\r\n            for (Path path : sources) {\r\n                try (FileChannel srcChannel = FileChannel.open(path, StandardOpenOption.READ)) {\r\n                    for (long position = 0, size = srcChannel.size(); position &lt; size; ) {\r\n                        position += srcChannel.transferTo(position, size - position, desChannel);\r\n                    }\r\n                }\r\n            }\r\n        } catch (IOException e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n```","title":"Merge huge files without loading whole file into memory?","body":"<p>I try to merge files to a file with 3 ways.\nI test these ways but I do not know which one is best...still.\nI thought that FileChannel is faster than others but it was not for me.\nPlease let me know if you guys have any concern.</p>\n<ol>\n<li>BufferedReader &amp; BufferedWrtier</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>    private static void mergeFiles(List&lt;Path&gt; sources, Path destination) {\n        try (BufferedWriter writer = new BufferedWriter(new FileWriter(destination.toFile(), true))) {\n            for (Path path : sources) {\n                try (BufferedReader reader = new BufferedReader(new InputStreamReader(new FileInputStream(path.toFile())))) {\n                    String line;\n                    while ((line = reader.readLine()) != null) {\n                        writer.write(line);\n                        writer.newLine();\n                    }\n                } catch (IOException e) {\n                    throw new RuntimeException(e);\n                }\n            }\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n    }\n</code></pre>\n<ol start=\"2\">\n<li>InputStream &amp; Files.copy</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>    private static void mergeFiles2(List&lt;Path&gt; sources, Path destination) {\n        try {\n            BinaryOperator&lt;InputStream&gt; sequenceInputStream = SequenceInputStream::new;\n            List&lt;InputStream&gt; inputStreams = new ArrayList&lt;&gt;();\n\n            for (Path path : sources) {\n                InputStream is = Files.newInputStream(path, StandardOpenOption.READ);\n                inputStreams.add(is);\n            }\n\n            InputStream streams = inputStreams.parallelStream().reduce(sequenceInputStream).orElseThrow(() -&gt; new IllegalStateException(&quot;inputStreams reduce exception&quot;));\n            Files.copy(streams, destination, StandardCopyOption.REPLACE_EXISTING);\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n    }\n</code></pre>\n<ol start=\"3\">\n<li>File Channel</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>    private static void mergeFiles3(List&lt;Path&gt; sources, Path destination) {\n        try (FileChannel desChannel = FileChannel.open(destination, StandardOpenOption.WRITE, StandardOpenOption.CREATE)) {\n            for (Path path : sources) {\n                try (FileChannel srcChannel = FileChannel.open(path, StandardOpenOption.READ)) {\n                    for (long position = 0, size = srcChannel.size(); position &lt; size; ) {\n                        position += srcChannel.transferTo(position, size - position, desChannel);\n                    }\n                }\n            }\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n    }\n</code></pre>\n"}],"owner":{"account_id":1336579,"reputation":5252,"user_id":1279180,"accept_rate":74,"display_name":"nimo23"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":12708,"favorite_count":0,"down_vote_count":0,"up_vote_count":7,"accepted_answer_id":25548570,"answer_count":4,"score":7,"last_activity_date":1700048134,"creation_date":1409222318,"question_id":25546750,"body_markdown":"I want to merge huge files containing strings into one file and tried to use nio2. I do not want to load the whole file into memory, so I tried it with BufferedReader:\r\n\r\n    public void mergeFiles(filesToBeMerged) throws IOException{\r\n\r\n    Path mergedFile = Paths.get(&quot;mergedFile&quot;);\r\n    Files.createFile(mergedFile);\r\n\r\n    List&lt;Path&gt; _filesToBeMerged = filesToBeMerged;\r\n\r\n    try (BufferedWriter writer = Files.newBufferedWriter(mergedFile,StandardOpenOption.APPEND)) {\r\n\t\t\tfor (Path file : _filesToBeMerged) {\r\n    // this does not work as write()-method does not accept a BufferedReader\r\n\t\t\t\twriter.append(Files.newBufferedReader(file));\r\n\t\t\t}\r\n\t\t} catch (IOException e) {\r\n\t\t\tSystem.err.println(e);\r\n\t\t}\r\n\r\n    }\r\n\r\nI tried it with this, this works, hower, the format of the strings (e.g. new lines, etc is not copied to the merged file):\r\n\r\n\r\n    ...\r\n    try (BufferedWriter writer = Files.newBufferedWriter(mergedFile,StandardOpenOption.APPEND)) {\r\n\t\t\tfor (Path file : _filesToBeMerged) {\r\n    //\t\t\t\twriter.write(Files.newBufferedReader(file));\r\n\t\t\t\tString line = null;\r\n\r\n\r\n    BufferedReader reader = Files.newBufferedReader(file);\r\n\t\t\t    while ((line = reader.readLine()) != null) {\r\n\t\t\t            writer.append(line);\r\n                        writer.append(System.lineSeparator());\r\n\t\t\t     }\r\n    reader.close();\r\n\t\t\t}\r\n\t\t} catch (IOException e) {\r\n\t\t\tSystem.err.println(e);\r\n\t\t}\r\n    ...\r\n\r\nHow can I merge huge Files with NIO2 without loading the whole file into memory? ","title":"Merge huge files without loading whole file into memory?","body":"<p>I want to merge huge files containing strings into one file and tried to use nio2. I do not want to load the whole file into memory, so I tried it with BufferedReader:</p>\n\n<pre><code>public void mergeFiles(filesToBeMerged) throws IOException{\n\nPath mergedFile = Paths.get(\"mergedFile\");\nFiles.createFile(mergedFile);\n\nList&lt;Path&gt; _filesToBeMerged = filesToBeMerged;\n\ntry (BufferedWriter writer = Files.newBufferedWriter(mergedFile,StandardOpenOption.APPEND)) {\n        for (Path file : _filesToBeMerged) {\n// this does not work as write()-method does not accept a BufferedReader\n            writer.append(Files.newBufferedReader(file));\n        }\n    } catch (IOException e) {\n        System.err.println(e);\n    }\n\n}\n</code></pre>\n\n<p>I tried it with this, this works, hower, the format of the strings (e.g. new lines, etc is not copied to the merged file):</p>\n\n<pre><code>...\ntry (BufferedWriter writer = Files.newBufferedWriter(mergedFile,StandardOpenOption.APPEND)) {\n        for (Path file : _filesToBeMerged) {\n//              writer.write(Files.newBufferedReader(file));\n            String line = null;\n\n\nBufferedReader reader = Files.newBufferedReader(file);\n            while ((line = reader.readLine()) != null) {\n                    writer.append(line);\n                    writer.append(System.lineSeparator());\n             }\nreader.close();\n        }\n    } catch (IOException e) {\n        System.err.println(e);\n    }\n...\n</code></pre>\n\n<p>How can I merge huge Files with NIO2 without loading the whole file into memory? </p>\n"},{"tags":["java","docker","docker-java"],"answers":[{"comments":[{"owner":{"account_id":4180449,"reputation":2218,"user_id":3425640,"display_name":"trust512"},"score":2,"creation_date":1530798227,"post_id":51192901,"comment_id":89367253,"body_markdown":"Markus you are not right. With docker 17.05 there is a major change. Please adjust your answer. [Ref](https://docs.docker.com/develop/develop-images/multistage-build/)","body":"Markus you are not right. With docker 17.05 there is a major change. Please adjust your answer. <a href=\"https://docs.docker.com/develop/develop-images/multistage-build/\" rel=\"nofollow noreferrer\">Ref</a>"},{"owner":{"account_id":508927,"reputation":2023,"user_id":1251613,"accept_rate":100,"display_name":"Markus"},"score":0,"creation_date":1530798492,"post_id":51192901,"comment_id":89367441,"body_markdown":"Thank you for the advice. I was not aware of that feature. :)","body":"Thank you for the advice. I was not aware of that feature. :)"},{"owner":{"account_id":4180449,"reputation":2218,"user_id":3425640,"display_name":"trust512"},"score":2,"creation_date":1530798609,"post_id":51192901,"comment_id":89367526,"body_markdown":"Sure, no problem, and the answer is correct now - `curl` will not be available as its wiped out.","body":"Sure, no problem, and the answer is correct now - <code>curl</code> will not be available as its wiped out."},{"owner":{"account_id":2087834,"reputation":7167,"user_id":1858327,"accept_rate":71,"display_name":"Captain Man"},"score":0,"creation_date":1561144235,"post_id":51192901,"comment_id":99981711,"body_markdown":"Curl is not unavailable because it has been &quot;wiped out&quot;, curl just is not part of Alpine by default.","body":"Curl is not unavailable because it has been &quot;wiped out&quot;, curl just is not part of Alpine by default."},{"owner":{"account_id":508927,"reputation":2023,"user_id":1251613,"accept_rate":100,"display_name":"Markus"},"score":0,"creation_date":1561230241,"post_id":51192901,"comment_id":99998138,"body_markdown":"@CaptainMan: But it is going to be installed in the Dockerfile and will be wiped after the second FROM statement.","body":"@CaptainMan: But it is going to be installed in the Dockerfile and will be wiped after the second FROM statement."},{"owner":{"account_id":2087834,"reputation":7167,"user_id":1858327,"accept_rate":71,"display_name":"Captain Man"},"score":0,"creation_date":1561398947,"post_id":51192901,"comment_id":100042349,"body_markdown":"@Markus The build&#39;s first stage using Ubuntu should still produce an image that has curl installed though.","body":"@Markus The build&#39;s first stage using Ubuntu should still produce an image that has curl installed though."},{"owner":{"account_id":508927,"reputation":2023,"user_id":1251613,"accept_rate":100,"display_name":"Markus"},"score":0,"creation_date":1561410683,"post_id":51192901,"comment_id":100046841,"body_markdown":"Yes, but it is wiped after the second FROM switching to Alpine. See [reference link](https://docs.docker.com/develop/develop-images/multistage-build/) in first comment.","body":"Yes, but it is wiped after the second FROM switching to Alpine. See <a href=\"https://docs.docker.com/develop/develop-images/multistage-build/\" rel=\"nofollow noreferrer\">reference link</a> in first comment."},{"owner":{"account_id":2087834,"reputation":7167,"user_id":1858327,"accept_rate":71,"display_name":"Captain Man"},"score":0,"creation_date":1561563542,"post_id":51192901,"comment_id":100108406,"body_markdown":"Unfortunately the laptop I am on right now can&#39;t run Docker (Windows 7) so I cannot test, but I could&#39;ve sworn running `docker images` would show the intermediate stages as unnamed images. Maybe this is just an issue of word usage though. When I see &quot;wiped out&quot; I think deleted, but as I&#39;m saying I don&#39;t think it is. That said, the *state* of the build is wiped, but it seems like a moot point to mention it when talking about installed packages as opposed to things like `WORKDIR` or `ADD` -- especially since Ubuntu and Alpine don&#39;t use the same package manager so the commands would be different.","body":"Unfortunately the laptop I am on right now can&#39;t run Docker (Windows 7) so I cannot test, but I could&#39;ve sworn running <code>docker images</code> would show the intermediate stages as unnamed images. Maybe this is just an issue of word usage though. When I see &quot;wiped out&quot; I think deleted, but as I&#39;m saying I don&#39;t think it is. That said, the <i>state</i> of the build is wiped, but it seems like a moot point to mention it when talking about installed packages as opposed to things like <code>WORKDIR</code> or <code>ADD</code> -- especially since Ubuntu and Alpine don&#39;t use the same package manager so the commands would be different."}],"tags":[],"owner":{"account_id":508927,"reputation":2023,"user_id":1251613,"accept_rate":100,"display_name":"Markus"},"comment_count":8,"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1530798670,"creation_date":1530798176,"answer_id":51192901,"question_id":51192713,"body_markdown":"Your example dockerfile contains multiple `FROM` statements. This is valid but as the documentation says each `FROM` clears the state from previous [instructions][1]. And so the fresh installed curl is wiped after the second `FROM`.\r\n\r\n\r\n  [1]: https://docs.docker.com/develop/develop-images/multistage-build/#use-multi-stage-builds","title":"How to make curl available in Docker image based java:8-jdk-alpine and keep the image clean?","body":"<p>Your example dockerfile contains multiple <code>FROM</code> statements. This is valid but as the documentation says each <code>FROM</code> clears the state from previous <a href=\"https://docs.docker.com/develop/develop-images/multistage-build/#use-multi-stage-builds\" rel=\"noreferrer\">instructions</a>. And so the fresh installed curl is wiped after the second <code>FROM</code>.</p>\n"},{"comments":[{"owner":{"account_id":49554,"reputation":17677,"user_id":147562,"accept_rate":70,"display_name":"boatcoder"},"score":1,"creation_date":1582222581,"post_id":51200785,"comment_id":106712467,"body_markdown":"Sometimes you don&#39;t want to build a product to see what response the webserver is returning.  The question is about installing curl, this answer isn&#39;t one.","body":"Sometimes you don&#39;t want to build a product to see what response the webserver is returning.  The question is about installing curl, this answer isn&#39;t one."},{"owner":{"account_id":12194665,"reputation":3483,"user_id":8900780,"display_name":"Xavier D"},"score":1,"creation_date":1593554821,"post_id":51200785,"comment_id":110821853,"body_markdown":"i.e. curl is usefull to implement a quick healthcheck for swarm.","body":"i.e. curl is usefull to implement a quick healthcheck for swarm."}],"tags":[],"owner":{"account_id":13863020,"reputation":137043,"user_id":10008173,"display_name":"David Maze"},"comment_count":2,"down_vote_count":11,"up_vote_count":3,"is_accepted":false,"score":-8,"last_activity_date":1530830392,"creation_date":1530830392,"answer_id":51200785,"question_id":51192713,"body_markdown":"Most languages have readily available HTTP clients these days; you should almost never be calling out to `curl` from a program in a language more sophisticated than a shell script.  [java.net.URLConnection](https://docs.oracle.com/javase/8/docs/api/java/net/URLConnection.html) has been a part of Java since Java 1.0 and (without knowing why you&#39;re trying to shell out for this) it&#39;s almost definitely the right tool here.\r\n\r\nAssuming you control the `executeCoreAPI` method from your backtrace, you should change it to use the built-in Java HTTP client, and just delete all of the Dockerfile parts that try to install `curl`.","title":"How to make curl available in Docker image based java:8-jdk-alpine and keep the image clean?","body":"<p>Most languages have readily available HTTP clients these days; you should almost never be calling out to <code>curl</code> from a program in a language more sophisticated than a shell script.  <a href=\"https://docs.oracle.com/javase/8/docs/api/java/net/URLConnection.html\" rel=\"nofollow noreferrer\">java.net.URLConnection</a> has been a part of Java since Java 1.0 and (without knowing why you're trying to shell out for this) it's almost definitely the right tool here.</p>\n\n<p>Assuming you control the <code>executeCoreAPI</code> method from your backtrace, you should change it to use the built-in Java HTTP client, and just delete all of the Dockerfile parts that try to install <code>curl</code>.</p>\n"},{"comments":[{"owner":{"account_id":1122893,"reputation":2272,"user_id":1110815,"display_name":"Daniel Dietrich"},"score":7,"creation_date":1558003588,"post_id":51209115,"comment_id":98960113,"body_markdown":"Recent versions of apk support a more concise syntax: apk --no-cache add curl","body":"Recent versions of apk support a more concise syntax: apk --no-cache add curl"},{"owner":{"account_id":13215612,"reputation":1059,"user_id":10183880,"display_name":"MehmedB"},"score":0,"creation_date":1570619345,"post_id":51209115,"comment_id":102967856,"body_markdown":"No matter I tried it keeps saying &quot;/bin/sh: curl: not found&quot;","body":"No matter I tried it keeps saying &quot;/bin/sh: curl: not found&quot;"},{"owner":{"account_id":251459,"reputation":1087,"user_id":528858,"accept_rate":74,"display_name":"Zhasulan Berdibekov"},"score":0,"creation_date":1589870348,"post_id":51209115,"comment_id":109456298,"body_markdown":"network error (check Internet connection and firewall)","body":"network error (check Internet connection and firewall)"}],"tags":[],"owner":{"account_id":6499292,"reputation":5620,"user_id":5030709,"accept_rate":40,"display_name":"Imran"},"comment_count":3,"down_vote_count":0,"up_vote_count":166,"is_accepted":false,"score":166,"last_activity_date":1558013183,"creation_date":1530875465,"answer_id":51209115,"question_id":51192713,"body_markdown":"The Java base image you are using is Alpine Linux one and curl package also needs to be downloaded from there. Here is Dockerfile I have used for Production deployments.\n\n    FROM openjdk:8-jre-alpine\n    \n    RUN apk add --update \\\n        curl \\\n        &amp;&amp; rm -rf /var/cache/apk/*\n\n\n----------\n# **Update 05/2019** #\n\nAs of Alpine Linux 3.3 there exists a new `--no-cache` option for `apk`. It allows users to install packages with an index that is updated and used on-the-fly and not cached locally:\n\n    FROM openjdk:8-jre-alpine\n        \n    RUN apk --no-cache add curl\n\nThis avoids the need to use `--update` and remove `/var/cache/apk/*` when done installing packages.\n\nReference - \nhttps://github.com/gliderlabs/docker-alpine/blob/master/docs/usage.md and Thank you @Daniel for the comment.","title":"How to make curl available in Docker image based java:8-jdk-alpine and keep the image clean?","body":"<p>The Java base image you are using is Alpine Linux one and curl package also needs to be downloaded from there. Here is Dockerfile I have used for Production deployments.</p>\n<pre><code>FROM openjdk:8-jre-alpine\n\nRUN apk add --update \\\n    curl \\\n    &amp;&amp; rm -rf /var/cache/apk/*\n</code></pre>\n<hr />\n<h1><strong>Update 05/2019</strong></h1>\n<p>As of Alpine Linux 3.3 there exists a new <code>--no-cache</code> option for <code>apk</code>. It allows users to install packages with an index that is updated and used on-the-fly and not cached locally:</p>\n<pre><code>FROM openjdk:8-jre-alpine\n    \nRUN apk --no-cache add curl\n</code></pre>\n<p>This avoids the need to use <code>--update</code> and remove <code>/var/cache/apk/*</code> when done installing packages.</p>\n<p>Reference -\n<a href=\"https://github.com/gliderlabs/docker-alpine/blob/master/docs/usage.md\" rel=\"noreferrer\">https://github.com/gliderlabs/docker-alpine/blob/master/docs/usage.md</a> and Thank you @Daniel for the comment.</p>\n"},{"tags":[],"owner":{"account_id":19099786,"reputation":59,"user_id":13948316,"display_name":"deep bajaj"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700047822,"creation_date":1700047822,"answer_id":77487350,"question_id":51192713,"body_markdown":"Use this Command -- &gt; `apk add curl`","title":"How to make curl available in Docker image based java:8-jdk-alpine and keep the image clean?","body":"<p>Use this Command -- &gt; <code>apk add curl</code></p>\n"}],"owner":{"account_id":4087139,"reputation":793,"user_id":3356164,"display_name":"user3356164"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":151773,"favorite_count":0,"down_vote_count":0,"up_vote_count":79,"answer_count":4,"score":79,"last_activity_date":1700047822,"creation_date":1530797628,"question_id":51192713,"body_markdown":"We are having java code that runs curl command to fetch the some result.\r\n\r\nWe have built a jar file and the jar file executes fine\r\n\r\nNow, when we try to dokerize the java program (using jar) and run the application in docker we get this error:\r\n\r\n    errorjava.io.IOException: Cannot run program &quot;curl&quot;: error=2, No such file or directory\r\n    \tat java.lang.ProcessBuilder.start(ProcessBuilder.java:1048)\r\n    \tat com.ps.api.common.CoreAPI_Spec.executeCoreAPI(CoreAPI_Spec.java:295)\r\n    \tat com.ps.api.common.CoreAPI_Spec.getAccessTokens(CoreAPI_Spec.java:319)\r\n\r\n\r\n\r\nDockerfile used :\r\n\r\n    FROM ubuntu:16.04\r\n    MAINTAINER niro;\r\n    \r\n    # Install prerequisites\r\n    RUN apt-get update &amp;&amp; apt-get install -y \\\r\n    curl\r\n    \r\n    FROM java:8-jdk-alpine\r\n    # Set the working directory to /app\r\n    WORKDIR /Users/******/Desktop/CoreAPI_Jar\r\n    \r\n    # Copy the current directory contents into the container at /app\r\n    ADD *******_Automation-0.0.1-SNAPSHOT-jar-with-dependencies.jar ******_Automation-0.0.1-SNAPSHOT-jar-with-dependencies.jar\r\n    \r\n    # Run app.py when the container launches\r\n    CMD [&quot;java&quot;, &quot;-jar&quot;, &quot;******-0.0.1-SNAPSHOT-jar-with-dependencies.jar&quot;]\r\n\r\n","title":"How to make curl available in Docker image based java:8-jdk-alpine and keep the image clean?","body":"<p>We are having java code that runs curl command to fetch the some result.</p>\n\n<p>We have built a jar file and the jar file executes fine</p>\n\n<p>Now, when we try to dokerize the java program (using jar) and run the application in docker we get this error:</p>\n\n<pre><code>errorjava.io.IOException: Cannot run program \"curl\": error=2, No such file or directory\n    at java.lang.ProcessBuilder.start(ProcessBuilder.java:1048)\n    at com.ps.api.common.CoreAPI_Spec.executeCoreAPI(CoreAPI_Spec.java:295)\n    at com.ps.api.common.CoreAPI_Spec.getAccessTokens(CoreAPI_Spec.java:319)\n</code></pre>\n\n<p>Dockerfile used :</p>\n\n<pre><code>FROM ubuntu:16.04\nMAINTAINER niro;\n\n# Install prerequisites\nRUN apt-get update &amp;&amp; apt-get install -y \\\ncurl\n\nFROM java:8-jdk-alpine\n# Set the working directory to /app\nWORKDIR /Users/******/Desktop/CoreAPI_Jar\n\n# Copy the current directory contents into the container at /app\nADD *******_Automation-0.0.1-SNAPSHOT-jar-with-dependencies.jar ******_Automation-0.0.1-SNAPSHOT-jar-with-dependencies.jar\n\n# Run app.py when the container launches\nCMD [\"java\", \"-jar\", \"******-0.0.1-SNAPSHOT-jar-with-dependencies.jar\"]\n</code></pre>\n"},{"tags":["java","unit-testing","groovy","migration","java-17"],"owner":{"account_id":15828600,"reputation":1,"user_id":11420682,"display_name":"Ridhi Bhat"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":49,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700047564,"creation_date":1700047564,"question_id":77487321,"body_markdown":"I am getting this error when I am updating java version from 11 to 17.\r\n\r\n    SpecInternals.SpyImpl:168-&gt;SpecInternals.createMockImpl:295-&gt;SpecInternals.createMockImpl:305-   \r\n    &gt;SpecInternals.createMock:50 &#187; NoClassDefFound Could not initialize class \r\n    org.spockframework.mock.runtime.CglibMockFactory$ConstructorFriendlyEnhancer\r\n\r\nI updated to following versions:\r\n- spock - 2.3-groovy-3.0\r\n- groovy-all - 3.0.19\r\n- gmavenplus-plugin - 3.0.2\r\n- maven-surefire-plugin - 3.2.2\r\n- cglib-nodep.version - 3.2.9\r\n- maven-compiler-plugin - 3.9.0\r\n- jacoco-maven-plugin - 0.8.10\r\n\r\nBut I am still facing the issue. Please let me know if anyone has come across this error while migrating from java 11 to 17.\r\n","title":"Test case in groovy failing while migrating from java 11 to 17","body":"<p>I am getting this error when I am updating java version from 11 to 17.</p>\n<pre><code>SpecInternals.SpyImpl:168-&gt;SpecInternals.createMockImpl:295-&gt;SpecInternals.createMockImpl:305-   \n&gt;SpecInternals.createMock:50 » NoClassDefFound Could not initialize class \norg.spockframework.mock.runtime.CglibMockFactory$ConstructorFriendlyEnhancer\n</code></pre>\n<p>I updated to following versions:</p>\n<ul>\n<li>spock - 2.3-groovy-3.0</li>\n<li>groovy-all - 3.0.19</li>\n<li>gmavenplus-plugin - 3.0.2</li>\n<li>maven-surefire-plugin - 3.2.2</li>\n<li>cglib-nodep.version - 3.2.9</li>\n<li>maven-compiler-plugin - 3.9.0</li>\n<li>jacoco-maven-plugin - 0.8.10</li>\n</ul>\n<p>But I am still facing the issue. Please let me know if anyone has come across this error while migrating from java 11 to 17.</p>\n"},{"tags":["java","algorithm","random","sampling"],"comments":[{"owner":{"account_id":125128,"reputation":51999,"user_id":320700,"accept_rate":74,"display_name":"Yanick Rochon"},"score":0,"creation_date":1295124990,"post_id":4702036,"comment_id":5189279,"body_markdown":"what have you got so far? If you get another x elements, can you pick elements from the previous set again, or must be all different all the time until ALL elements are picked? (Then, what next?)","body":"what have you got so far? If you get another x elements, can you pick elements from the previous set again, or must be all different all the time until ALL elements are picked? (Then, what next?)"},{"owner":{"display_name":"user568866"},"score":0,"creation_date":1295186574,"post_id":4702036,"comment_id":5194221,"body_markdown":"Without replacement.  When you have no more left, you should get nothing back.","body":"Without replacement.  When you have no more left, you should get nothing back."}],"answers":[{"comments":[{"owner":{"account_id":279365,"reputation":49126,"user_id":574479,"accept_rate":87,"display_name":"biziclop"},"score":3,"creation_date":1295124511,"post_id":4702049,"comment_id":5189237,"body_markdown":"And the easiest way to do this is to call java.util.Collections.shuffle()","body":"And the easiest way to do this is to call java.util.Collections.shuffle()"}],"tags":[],"owner":{"account_id":235018,"reputation":364854,"user_id":501557,"accept_rate":90,"display_name":"templatetypedef"},"comment_count":1,"down_vote_count":1,"up_vote_count":12,"is_accepted":false,"score":11,"last_activity_date":1314751403,"creation_date":1295124399,"answer_id":4702049,"question_id":4702036,"body_markdown":"If you want to successively pick n elements from the list and be able to do so without replacement over and over and over again, you are probably best of randomly permuting the elements, then taking chunks off in blocks of n.  If you randomly permute the list you guarantee statistical randomness for each block you pick out.  Perhaps the easiest way to do this would be to use [`Collections.shuffle`][1].\r\n\r\n\r\n  [1]: http://download.oracle.com/javase/6/docs/api/java/util/Collections.html#shuffle%28java.util.List%29","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>If you want to successively pick n elements from the list and be able to do so without replacement over and over and over again, you are probably best of randomly permuting the elements, then taking chunks off in blocks of n.  If you randomly permute the list you guarantee statistical randomness for each block you pick out.  Perhaps the easiest way to do this would be to use <a href=\"http://download.oracle.com/javase/6/docs/api/java/util/Collections.html#shuffle%28java.util.List%29\" rel=\"noreferrer\"><code>Collections.shuffle</code></a>.</p>\n"},{"comments":[{"owner":{"account_id":1628065,"reputation":3943,"user_id":1503130,"accept_rate":90,"display_name":"Prateek"},"score":0,"creation_date":1371558424,"post_id":4702061,"comment_id":24857046,"body_markdown":"I have got a list of 4000 words and I have to get 5 words out of that list each time I press the refresh button, am using the 2nd option of your answer. How much does it guarantee that I will get unique values all the time i.e. what&#39;s the probability ?","body":"I have got a list of 4000 words and I have to get 5 words out of that list each time I press the refresh button, am using the 2nd option of your answer. How much does it guarantee that I will get unique values all the time i.e. what&#39;s the probability ?"},{"owner":{"account_id":52822,"reputation":1089035,"user_id":157882,"accept_rate":93,"display_name":"BalusC"},"score":1,"creation_date":1371558710,"post_id":4702061,"comment_id":24857212,"body_markdown":"@Prateek: If you have a question, press &quot;Ask Question&quot; button. Do not press &quot;Add comment&quot; or &quot;Post Answer&quot; button.","body":"@Prateek: If you have a question, press &quot;Ask Question&quot; button. Do not press &quot;Add comment&quot; or &quot;Post Answer&quot; button."},{"owner":{"account_id":1628065,"reputation":3943,"user_id":1503130,"accept_rate":90,"display_name":"Prateek"},"score":4,"creation_date":1371560657,"post_id":4702061,"comment_id":24858490,"body_markdown":"I know when to use which button, my comment is somewhat related to your already posted answer so I didn&#39;t want to create a new thread of if and was looking for a response inline, thanks anyways.","body":"I know when to use which button, my comment is somewhat related to your already posted answer so I didn&#39;t want to create a new thread of if and was looking for a response inline, thanks anyways."},{"owner":{"account_id":1319167,"reputation":529,"user_id":1265352,"display_name":"Matunos"},"score":13,"creation_date":1432798953,"post_id":4702061,"comment_id":49076644,"body_markdown":"Keep in mind that Collections.shuffle() uses a version of the Fisher-Yates shuffle algorithm, with an internal instance of Random.\n\nThe Random class uses a long for its seed value, meaning it can only offer you up to 2^32 possible permutations. This is insufficient for shuffling any more than 12 elements with uniform probability of all permutations (that is, some permutations will never come up). You&#39;ll want to use Collections.shuffle(list,random) instead, where random is either and instance of SecureRandom or your own custom Random extension, if you&#39;re up to that task.","body":"Keep in mind that Collections.shuffle() uses a version of the Fisher-Yates shuffle algorithm, with an internal instance of Random.  The Random class uses a long for its seed value, meaning it can only offer you up to 2^32 possible permutations. This is insufficient for shuffling any more than 12 elements with uniform probability of all permutations (that is, some permutations will never come up). You&#39;ll want to use Collections.shuffle(list,random) instead, where random is either and instance of SecureRandom or your own custom Random extension, if you&#39;re up to that task."},{"owner":{"account_id":20470,"reputation":21695,"user_id":48933,"accept_rate":90,"display_name":"Neil Coffey"},"score":0,"creation_date":1454970380,"post_id":4702061,"comment_id":58272589,"body_markdown":"Matunos - for what it&#39;s worth, the effective seed size of java.util.Random is 2^48, but as you say, it&#39;s still worth bearing in mind that you may need to select a better generator. I would still advocate the method I mention of simply picking the items with the relevant probability (you still need the same number of random numbers as a shuffle, but you don&#39;t have to swap all the pointers, potentially better memory locality, and there&#39;s a chance of terminating the loop &quot;early&quot; once you have selected all of the required elements).","body":"Matunos - for what it&#39;s worth, the effective seed size of java.util.Random is 2^48, but as you say, it&#39;s still worth bearing in mind that you may need to select a better generator. I would still advocate the method I mention of simply picking the items with the relevant probability (you still need the same number of random numbers as a shuffle, but you don&#39;t have to swap all the pointers, potentially better memory locality, and there&#39;s a chance of terminating the loop &quot;early&quot; once you have selected all of the required elements)."},{"owner":{"account_id":182955,"reputation":2403,"user_id":418031,"accept_rate":89,"display_name":"Zavael"},"score":0,"creation_date":1474897869,"post_id":4702061,"comment_id":66707504,"body_markdown":"could you provide another sollution using Stream api and findAny()? it would make the answer up-to-date :)","body":"could you provide another sollution using Stream api and findAny()? it would make the answer up-to-date :)"},{"owner":{"account_id":52822,"reputation":1089035,"user_id":157882,"accept_rate":93,"display_name":"BalusC"},"score":0,"creation_date":1474899223,"post_id":4702061,"comment_id":66708516,"body_markdown":"@Zavael: findAny() is not suitable here. Using Stream would only add extra code because it doesn&#39;t have a builtin random based comparator.","body":"@Zavael: findAny() is not suitable here. Using Stream would only add extra code because it doesn&#39;t have a builtin random based comparator."},{"owner":{"account_id":182955,"reputation":2403,"user_id":418031,"accept_rate":89,"display_name":"Zavael"},"score":0,"creation_date":1474963566,"post_id":4702061,"comment_id":66736121,"body_markdown":"@BalusC yep thats right, I realized it while trying to implement","body":"@BalusC yep thats right, I realized it while trying to implement"}],"tags":[],"owner":{"account_id":52822,"reputation":1089035,"user_id":157882,"accept_rate":93,"display_name":"BalusC"},"comment_count":8,"down_vote_count":2,"up_vote_count":123,"is_accepted":true,"score":121,"last_activity_date":1474899734,"creation_date":1295124547,"answer_id":4702061,"question_id":4702036,"body_markdown":"Two main ways.\r\n\r\n1. Use [`Random#nextInt(int)`][1]:\r\n\r\n        List&lt;Foo&gt; list = createItSomehow();\r\n        Random random = new Random();\r\n        Foo foo = list.get(random.nextInt(list.size()));\r\n\r\n   It&#39;s however not guaranteed that successive `n` calls returns unique elements.\r\n\r\n2. Use [`Collections#shuffle()`][2]:\r\n\r\n        List&lt;Foo&gt; list = createItSomehow();\r\n        Collections.shuffle(list);\r\n        Foo foo = list.get(0);\r\n\r\n   It enables you to get `n` unique elements by an incremented index (assuming that the list itself contains unique elements).\r\n\r\n---\r\n\r\nIn case you&#39;re wondering if there&#39;s a Java 8 Stream approach; no, there isn&#39;t a built-in one. There&#39;s no such thing as `Comparator#randomOrder()` in standard API (yet?). You could try something like below while still satisfying the strict `Comparator` contract (although the distribution is pretty terrible):\r\n\r\n    List&lt;Foo&gt; list = createItSomehow();\r\n    int random = new Random().nextInt();\r\n    Foo foo = list.stream().sorted(Comparator.comparingInt(o -&gt; System.identityHashCode(o) ^ random)).findFirst().get();\r\n\r\nBetter use `Collections#shuffle()` instead.\r\n\r\n\r\n  [1]: http://download.oracle.com/javase/6/docs/api/java/util/Random.html#nextInt%28int%29\r\n  [2]: http://download.oracle.com/javase/6/docs/api/java/util/Collections.html#shuffle%28java.util.List%29","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>Two main ways.</p>\n\n<ol>\n<li><p>Use <a href=\"http://download.oracle.com/javase/6/docs/api/java/util/Random.html#nextInt%28int%29\" rel=\"noreferrer\"><code>Random#nextInt(int)</code></a>:</p>\n\n<pre><code>List&lt;Foo&gt; list = createItSomehow();\nRandom random = new Random();\nFoo foo = list.get(random.nextInt(list.size()));\n</code></pre>\n\n<p>It's however not guaranteed that successive <code>n</code> calls returns unique elements.</p></li>\n<li><p>Use <a href=\"http://download.oracle.com/javase/6/docs/api/java/util/Collections.html#shuffle%28java.util.List%29\" rel=\"noreferrer\"><code>Collections#shuffle()</code></a>:</p>\n\n<pre><code>List&lt;Foo&gt; list = createItSomehow();\nCollections.shuffle(list);\nFoo foo = list.get(0);\n</code></pre>\n\n<p>It enables you to get <code>n</code> unique elements by an incremented index (assuming that the list itself contains unique elements).</p></li>\n</ol>\n\n<hr>\n\n<p>In case you're wondering if there's a Java 8 Stream approach; no, there isn't a built-in one. There's no such thing as <code>Comparator#randomOrder()</code> in standard API (yet?). You could try something like below while still satisfying the strict <code>Comparator</code> contract (although the distribution is pretty terrible):</p>\n\n<pre><code>List&lt;Foo&gt; list = createItSomehow();\nint random = new Random().nextInt();\nFoo foo = list.stream().sorted(Comparator.comparingInt(o -&gt; System.identityHashCode(o) ^ random)).findFirst().get();\n</code></pre>\n\n<p>Better use <code>Collections#shuffle()</code> instead.</p>\n"},{"comments":[{"owner":{"account_id":4913442,"reputation":411,"user_id":3958082,"accept_rate":43,"display_name":"Drew O&#39;Meara"},"score":0,"creation_date":1596478169,"post_id":4702547,"comment_id":111818042,"body_markdown":"bravo -- this should be the awarded answer as it is most modular and portable","body":"bravo -- this should be the awarded answer as it is most modular and portable"}],"tags":[],"owner":{"account_id":20470,"reputation":21695,"user_id":48933,"accept_rate":90,"display_name":"Neil Coffey"},"comment_count":1,"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1295131194,"creation_date":1295131194,"answer_id":4702547,"question_id":4702036,"body_markdown":"A fair way to do this is to go through the list, on the nth iteration calculating the probability of whether or not to pick the nth element, which is essentially the fraction of the number of items you still need to pick over the number of elements available in the rest of the list. For example:\r\n\r\n    public static &lt;T&gt; T[] pickSample(T[] population, int nSamplesNeeded, Random r) {\r\n      T[] ret = (T[]) Array.newInstance(population.getClass().getComponentType(),\r\n                                        nSamplesNeeded);\r\n      int nPicked = 0, i = 0, nLeft = population.length;\r\n      while (nSamplesNeeded &gt; 0) {\r\n        int rand = r.nextInt(nLeft);\r\n        if (rand &lt; nSamplesNeeded) {\r\n          ret[nPicked++] = population[i];\r\n          nSamplesNeeded--;\r\n        }\r\n        nLeft--;\r\n        i++;\r\n      }\r\n      return ret;\r\n    }\r\n\r\n(This code copied from a page I wrote a while ago on [picking a random sample from a list][1].)\r\n\r\n\r\n  [1]: http://www.javamex.com/tutorials/random_numbers/random_sample.shtml","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>A fair way to do this is to go through the list, on the nth iteration calculating the probability of whether or not to pick the nth element, which is essentially the fraction of the number of items you still need to pick over the number of elements available in the rest of the list. For example:</p>\n\n<pre><code>public static &lt;T&gt; T[] pickSample(T[] population, int nSamplesNeeded, Random r) {\n  T[] ret = (T[]) Array.newInstance(population.getClass().getComponentType(),\n                                    nSamplesNeeded);\n  int nPicked = 0, i = 0, nLeft = population.length;\n  while (nSamplesNeeded &gt; 0) {\n    int rand = r.nextInt(nLeft);\n    if (rand &lt; nSamplesNeeded) {\n      ret[nPicked++] = population[i];\n      nSamplesNeeded--;\n    }\n    nLeft--;\n    i++;\n  }\n  return ret;\n}\n</code></pre>\n\n<p>(This code copied from a page I wrote a while ago on <a href=\"http://www.javamex.com/tutorials/random_numbers/random_sample.shtml\" rel=\"noreferrer\">picking a random sample from a list</a>.)</p>\n"},{"comments":[{"owner":{"account_id":427720,"reputation":3987,"user_id":809623,"accept_rate":78,"display_name":"David"},"score":0,"creation_date":1408523742,"post_id":19070874,"comment_id":39617324,"body_markdown":"I did not see the correlation between `arrayList` and `targetList`.","body":"I did not see the correlation between <code>arrayList</code> and <code>targetList</code>."},{"owner":{"account_id":909998,"reputation":5552,"user_id":944055,"display_name":"nomad"},"score":0,"creation_date":1435168917,"post_id":19070874,"comment_id":50092055,"body_markdown":"It should&#39;ve been targetList.add(arrayList.get(j))","body":"It should&#39;ve been targetList.add(arrayList.get(j))"}],"tags":[],"owner":{"account_id":2273733,"reputation":1040,"user_id":2000539,"accept_rate":90,"display_name":"Valknut"},"comment_count":2,"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1444920242,"creation_date":1380396624,"answer_id":19070874,"question_id":4702036,"body_markdown":"Simple and clear\r\n \r\n       // define ArrayList to hold Integer objects\r\n        ArrayList&lt;Integer&gt; arrayList = new ArrayList&lt;&gt;();\r\n\r\n        for (int i = 0; i &lt; maxRange; i++) {\r\n            arrayList.add(i + 1);\r\n        }\r\n\r\n        // shuffle list\r\n        Collections.shuffle(arrayList);\r\n\r\n        // adding defined amount of numbers to target list\r\n        ArrayList&lt;Integer&gt; targetList = new ArrayList&lt;&gt;();\r\n        for (int j = 0; j &lt; amount; j++) {\r\n            targetList.add(arrayList.get(j)); \r\n        }\r\n        \r\n        return targetList;","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>Simple and clear</p>\n\n<pre><code>   // define ArrayList to hold Integer objects\n    ArrayList&lt;Integer&gt; arrayList = new ArrayList&lt;&gt;();\n\n    for (int i = 0; i &lt; maxRange; i++) {\n        arrayList.add(i + 1);\n    }\n\n    // shuffle list\n    Collections.shuffle(arrayList);\n\n    // adding defined amount of numbers to target list\n    ArrayList&lt;Integer&gt; targetList = new ArrayList&lt;&gt;();\n    for (int j = 0; j &lt; amount; j++) {\n        targetList.add(arrayList.get(j)); \n    }\n\n    return targetList;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2792590,"reputation":469,"user_id":2402537,"display_name":"aykutfirat"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1426818739,"creation_date":1426818739,"answer_id":29158423,"question_id":4702036,"body_markdown":"Use the following class:\r\n\r\n    import java.util.Enumeration;\r\n    import java.util.Random;\r\n    \r\n    public class RandomPermuteIterator implements Enumeration&lt;Long&gt; {\r\n        int c = 1013904223, a = 1664525;\r\n        long seed, N, m, next;\r\n        boolean hasNext = true;\r\n    \r\n        public RandomPermuteIterator(long N) throws Exception {\r\n            if (N &lt;= 0 || N &gt; Math.pow(2, 62)) throw new Exception(&quot;Unsupported size: &quot; + N);\r\n            this.N = N;\r\n            m = (long) Math.pow(2, Math.ceil(Math.log(N) / Math.log(2)));\r\n            next = seed = new Random().nextInt((int) Math.min(N, Integer.MAX_VALUE));\r\n        }\r\n    \r\n        public static void main(String[] args) throws Exception {\r\n            RandomPermuteIterator r = new RandomPermuteIterator(100);\r\n            while (r.hasMoreElements()) System.out.print(r.nextElement() + &quot; &quot;);\r\n        }\r\n    \r\n        @Override\r\n        public boolean hasMoreElements() {\r\n            return hasNext;\r\n        }\r\n    \r\n        @Override\r\n        public Long nextElement() {\r\n            next = (a * next + c) % m;\r\n            while (next &gt;= N) next = (a * next + c) % m;\r\n            if (next == seed) hasNext = false;\r\n            return  next;\r\n        }\r\n    }\r\n\r\n","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>Use the following class:</p>\n\n<pre><code>import java.util.Enumeration;\nimport java.util.Random;\n\npublic class RandomPermuteIterator implements Enumeration&lt;Long&gt; {\n    int c = 1013904223, a = 1664525;\n    long seed, N, m, next;\n    boolean hasNext = true;\n\n    public RandomPermuteIterator(long N) throws Exception {\n        if (N &lt;= 0 || N &gt; Math.pow(2, 62)) throw new Exception(\"Unsupported size: \" + N);\n        this.N = N;\n        m = (long) Math.pow(2, Math.ceil(Math.log(N) / Math.log(2)));\n        next = seed = new Random().nextInt((int) Math.min(N, Integer.MAX_VALUE));\n    }\n\n    public static void main(String[] args) throws Exception {\n        RandomPermuteIterator r = new RandomPermuteIterator(100);\n        while (r.hasMoreElements()) System.out.print(r.nextElement() + \" \");\n    }\n\n    @Override\n    public boolean hasMoreElements() {\n        return hasNext;\n    }\n\n    @Override\n    public Long nextElement() {\n        next = (a * next + c) % m;\n        while (next &gt;= N) next = (a * next + c) % m;\n        if (next == seed) hasNext = false;\n        return  next;\n    }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":210454,"reputation":1319,"user_id":462077,"accept_rate":40,"display_name":"Matt"},"score":1,"creation_date":1517873921,"post_id":35278327,"comment_id":84263575,"body_markdown":"Thanks for pointing this out. I have a situation where I need to remove a small number of elements from a large list, and I was sure shuffling the whole list wasn&#39;t the best way to do it, but I was getting hung up on how to remove multiple elements from a list in one fell swoop. Swapping them to the end of the list, and then truncating it, is an elegant solution.","body":"Thanks for pointing this out. I have a situation where I need to remove a small number of elements from a large list, and I was sure shuffling the whole list wasn&#39;t the best way to do it, but I was getting hung up on how to remove multiple elements from a list in one fell swoop. Swapping them to the end of the list, and then truncating it, is an elegant solution."}],"tags":[],"owner":{"account_id":3997984,"reputation":4081,"user_id":3294902,"display_name":"Kostas Kryptos"},"comment_count":1,"down_vote_count":0,"up_vote_count":40,"is_accepted":false,"score":40,"last_activity_date":1494972403,"creation_date":1454961951,"answer_id":35278327,"question_id":4702036,"body_markdown":"Most of the proposed solutions till now suggest either a full list shuffle or successive random picking by checking uniqueness and retry if required.\r\n\r\nBut, we can take advantage of the Durstenfeld&#39;s algorithm (the most popular Fisher-Yates variant in our days).\r\n\r\n&gt; Durstenfeld&#39;s solution is to move the &quot;struck&quot; numbers to the end of\r\n&gt; the list by swapping them with the last unstruck number at each\r\n&gt; iteration.\r\n\r\nDue to the above, **we don&#39;t need to shuffle the whole list**, but run the loop for as many steps as the number of elements required to return. The algorithm ensures that the last N elements at the end of the list are 100% random if we used a perfect random function.\r\n\r\nAmong the many real-world scenarios where we need to pick a predetermined (max) amount of random elements from arrays/lists, this optimized method is very useful for various card games, such as Texas Poker, where you a-priori know the number of cards to be used per game; only a limited number of cards is usually required from the deck.\r\n\r\n\tpublic static &lt;E&gt; List&lt;E&gt; pickNRandomElements(List&lt;E&gt; list, int n, Random r) {\r\n\t\tint length = list.size();\r\n\t\t\r\n\t\tif (length &lt; n) return null;\r\n\t\t\r\n\t\t//We don&#39;t need to shuffle the whole list\r\n\t\tfor (int i = length - 1; i &gt;= length - n; --i)\r\n\t\t{\r\n\t\t\tCollections.swap(list, i , r.nextInt(i + 1));\r\n\t\t}\r\n\t\treturn list.subList(length - n, length);\r\n\t}\r\n\t\r\n\tpublic static &lt;E&gt; List&lt;E&gt; pickNRandomElements(List&lt;E&gt; list, int n) {\r\n\t\treturn pickNRandomElements(list, n, ThreadLocalRandom.current());\r\n\t}","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>Most of the proposed solutions till now suggest either a full list shuffle or successive random picking by checking uniqueness and retry if required.</p>\n\n<p>But, we can take advantage of the Durstenfeld's algorithm (the most popular Fisher-Yates variant in our days).</p>\n\n<blockquote>\n  <p>Durstenfeld's solution is to move the \"struck\" numbers to the end of\n  the list by swapping them with the last unstruck number at each\n  iteration.</p>\n</blockquote>\n\n<p>Due to the above, <strong>we don't need to shuffle the whole list</strong>, but run the loop for as many steps as the number of elements required to return. The algorithm ensures that the last N elements at the end of the list are 100% random if we used a perfect random function.</p>\n\n<p>Among the many real-world scenarios where we need to pick a predetermined (max) amount of random elements from arrays/lists, this optimized method is very useful for various card games, such as Texas Poker, where you a-priori know the number of cards to be used per game; only a limited number of cards is usually required from the deck.</p>\n\n<pre><code>public static &lt;E&gt; List&lt;E&gt; pickNRandomElements(List&lt;E&gt; list, int n, Random r) {\n    int length = list.size();\n\n    if (length &lt; n) return null;\n\n    //We don't need to shuffle the whole list\n    for (int i = length - 1; i &gt;= length - n; --i)\n    {\n        Collections.swap(list, i , r.nextInt(i + 1));\n    }\n    return list.subList(length - n, length);\n}\n\npublic static &lt;E&gt; List&lt;E&gt; pickNRandomElements(List&lt;E&gt; list, int n) {\n    return pickNRandomElements(list, n, ThreadLocalRandom.current());\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4646767,"reputation":17781,"user_id":3764804,"accept_rate":59,"display_name":"BullyWiiPlaza"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1482681542,"creation_date":1482681542,"answer_id":41322569,"question_id":4702036,"body_markdown":"Keep selecting a random element and make sure you do not choose the same element again:\r\n\r\n    public static &lt;E&gt; List&lt;E&gt; selectRandomElements(List&lt;E&gt; list, int amount)\r\n    {\r\n    \t// Avoid a deadlock\r\n    \tif (amount &gt;= list.size())\r\n    \t{\r\n    \t\treturn list;\r\n    \t}\r\n    \r\n    \tList&lt;E&gt; selected = new ArrayList&lt;&gt;();\r\n    \tRandom random = new Random();\r\n    \tint listSize = list.size();\r\n    \r\n    \t// Get a random item until we got the requested amount\r\n    \twhile (selected.size() &lt; amount)\r\n    \t{\r\n    \t\tint randomIndex = random.nextInt(listSize);\r\n    \t\tE element = list.get(randomIndex);\r\n    \r\n    \t\tif (!selected.contains(element))\r\n    \t\t{\r\n    \t\t\tselected.add(element);\r\n    \t\t}\r\n    \t}\r\n    \r\n    \treturn selected;\r\n    }\r\n\r\nIn theory this could run endlessly but in practise it is fine. The closer you get the whole original list the slower the runtime of this gets obviously but that is not the point of selecting a random sublist, is it?","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>Keep selecting a random element and make sure you do not choose the same element again:</p>\n\n<pre><code>public static &lt;E&gt; List&lt;E&gt; selectRandomElements(List&lt;E&gt; list, int amount)\n{\n    // Avoid a deadlock\n    if (amount &gt;= list.size())\n    {\n        return list;\n    }\n\n    List&lt;E&gt; selected = new ArrayList&lt;&gt;();\n    Random random = new Random();\n    int listSize = list.size();\n\n    // Get a random item until we got the requested amount\n    while (selected.size() &lt; amount)\n    {\n        int randomIndex = random.nextInt(listSize);\n        E element = list.get(randomIndex);\n\n        if (!selected.contains(element))\n        {\n            selected.add(element);\n        }\n    }\n\n    return selected;\n}\n</code></pre>\n\n<p>In theory this could run endlessly but in practise it is fine. The closer you get the whole original list the slower the runtime of this gets obviously but that is not the point of selecting a random sublist, is it?</p>\n"},{"tags":[],"owner":{"account_id":2576623,"reputation":3906,"user_id":2234161,"accept_rate":0,"display_name":"Memin"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1530555066,"creation_date":1530555066,"answer_id":51141641,"question_id":4702036,"body_markdown":"The following class retrieve N items from a list of any type. If you provide a seed then on each run it will return the same list, otherwise, the items of the new list will change on each run. You can check its behaviour my running the main methods. \r\n\r\n\r\n\timport java.util.ArrayList;\r\n\timport java.util.Arrays;\r\n\timport java.util.Collections;\r\n\timport java.util.List;\r\n\timport java.util.Random;\r\n\t\r\n\tpublic class NRandomItem&lt;T&gt; {\r\n\t\tprivate final List&lt;T&gt; initialList;\r\n\t\r\n\t\tpublic NRandomItem(List&lt;T&gt; list) {\r\n\t\t\tthis.initialList = list;\r\n\t\t}\r\n\t\r\n\t\t/**\r\n\t\t * Do not provide seed, if you want different items on each run.\r\n\t\t * \r\n\t\t * @param numberOfItem\r\n\t\t * @return\r\n\t\t */\r\n\t\tpublic List&lt;T&gt; retrieve(int numberOfItem) {\r\n\t\t\tint seed = new Random().nextInt();\r\n\t\t\treturn retrieve(seed, numberOfItem);\r\n\t\t}\r\n\t\r\n\t\t/**\r\n\t\t * The same seed will always return the same random list.\r\n\t\t * \r\n\t\t * @param seed,\r\n\t\t *            the seed of random item generator.\r\n\t\t * @param numberOfItem,\r\n\t\t *            the number of items to be retrieved from the list\r\n\t\t * @return the list of random items\r\n\t\t */\r\n\t\tpublic List&lt;T&gt; retrieve(int seed, int numberOfItem) {\r\n\t\t\tRandom rand = new Random(seed);\r\n\t\r\n\t\t\tCollections.shuffle(initialList, rand);\r\n\t\t\t// Create new list with the number of item size\r\n\t\t\tList&lt;T&gt; newList = new ArrayList&lt;&gt;();\r\n\t\t\tfor (int i = 0; i &lt; numberOfItem; i++) {\r\n\t\t\t\tnewList.add(initialList.get(i));\r\n\t\t\t}\r\n\t\t\treturn newList;\r\n\t\t}\r\n\t\r\n\t\tpublic static void main(String[] args) {\r\n\t\t\tList&lt;String&gt; l1 = Arrays.asList(&quot;Foo&quot;, &quot;Bar&quot;, &quot;Baz&quot;, &quot;Qux&quot;);\r\n\t\t\tint seedValue = 10;\r\n\t\t\tNRandomItem&lt;String&gt; r1 = new NRandomItem&lt;&gt;(l1);\r\n\t\r\n\t\t\tSystem.out.println(String.format(&quot;%s&quot;, r1.retrieve(seedValue, 2)));\r\n\t\t}\r\n\t}\r\n","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>The following class retrieve N items from a list of any type. If you provide a seed then on each run it will return the same list, otherwise, the items of the new list will change on each run. You can check its behaviour my running the main methods. </p>\n\n<pre><code>import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collections;\nimport java.util.List;\nimport java.util.Random;\n\npublic class NRandomItem&lt;T&gt; {\n    private final List&lt;T&gt; initialList;\n\n    public NRandomItem(List&lt;T&gt; list) {\n        this.initialList = list;\n    }\n\n    /**\n     * Do not provide seed, if you want different items on each run.\n     * \n     * @param numberOfItem\n     * @return\n     */\n    public List&lt;T&gt; retrieve(int numberOfItem) {\n        int seed = new Random().nextInt();\n        return retrieve(seed, numberOfItem);\n    }\n\n    /**\n     * The same seed will always return the same random list.\n     * \n     * @param seed,\n     *            the seed of random item generator.\n     * @param numberOfItem,\n     *            the number of items to be retrieved from the list\n     * @return the list of random items\n     */\n    public List&lt;T&gt; retrieve(int seed, int numberOfItem) {\n        Random rand = new Random(seed);\n\n        Collections.shuffle(initialList, rand);\n        // Create new list with the number of item size\n        List&lt;T&gt; newList = new ArrayList&lt;&gt;();\n        for (int i = 0; i &lt; numberOfItem; i++) {\n            newList.add(initialList.get(i));\n        }\n        return newList;\n    }\n\n    public static void main(String[] args) {\n        List&lt;String&gt; l1 = Arrays.asList(\"Foo\", \"Bar\", \"Baz\", \"Qux\");\n        int seedValue = 10;\n        NRandomItem&lt;String&gt; r1 = new NRandomItem&lt;&gt;(l1);\n\n        System.out.println(String.format(\"%s\", r1.retrieve(seedValue, 2)));\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":52549,"reputation":1687,"user_id":157053,"display_name":"smok"},"comment_count":0,"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1545859476,"creation_date":1545849651,"answer_id":53935842,"question_id":4702036,"body_markdown":"As noted in other answers, `Collections.shuffle` is not very efficient when the source list is big, because of the copying. Here is a Java 8 one-liner that:\r\n\r\n - efficient enough on random access lists like ArrayList if you don&#39;t need many elements from the source\r\n - doesn&#39;t modify the source\r\n - DOES NOT guarantee uniqueness, if it&#39;s not super important for you. If you pick 5 from a hundred, there&#39;s a very good chance the elements will be unique.\r\n\r\nCode:\r\n\r\n    private static &lt;E&gt; List&lt;E&gt; pickRandom(List&lt;E&gt; list, int n) {\r\n      return new Random().ints(n, 0, list.size()).mapToObj(list::get).collect(Collectors.toList());\r\n    }\r\n\r\nHowever, for a list with no quick random access (like LinkedList) the complexity would be `n*O(list_size)`.\r\n","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>As noted in other answers, <code>Collections.shuffle</code> is not very efficient when the source list is big, because of the copying. Here is a Java 8 one-liner that:</p>\n\n<ul>\n<li>efficient enough on random access lists like ArrayList if you don't need many elements from the source</li>\n<li>doesn't modify the source</li>\n<li>DOES NOT guarantee uniqueness, if it's not super important for you. If you pick 5 from a hundred, there's a very good chance the elements will be unique.</li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>private static &lt;E&gt; List&lt;E&gt; pickRandom(List&lt;E&gt; list, int n) {\n  return new Random().ints(n, 0, list.size()).mapToObj(list::get).collect(Collectors.toList());\n}\n</code></pre>\n\n<p>However, for a list with no quick random access (like LinkedList) the complexity would be <code>n*O(list_size)</code>.</p>\n"},{"tags":[],"owner":{"account_id":1899638,"reputation":1454,"user_id":1715765,"accept_rate":87,"display_name":"H.v.M."},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1587047334,"creation_date":1587047334,"answer_id":61252750,"question_id":4702036,"body_markdown":"This solution doesn&#39;t modify the original list or otherwise scale in complexity with the list size. \r\n\r\nTo get a sample of 4 from a list of 7, we just select a random element out of all 7, then select a random element out of the remaining 6, and so on. If we&#39;ve already selected indices 4, 0, 3, next we generate a random number out of 0, 1, 2, 3, respectively representing index 1, 2, 5, 6.\r\n\r\n\tstatic Random rand = new Random();\r\n\r\n\tstatic &lt;T&gt; List&lt;T&gt; randomSample(List&lt;T&gt; list, int size) {\r\n\t\tList&lt;T&gt; sample = new ArrayList&lt;&gt;();\r\n\t\t\r\n\t\tfor (int sortedSampleIndices[] = new int[size], i = 0; i &lt; size; i++) {\r\n\t\t\tint index = rand.nextInt(list.size() - i);\r\n\t\t\t\r\n\t\t\tint j = 0;\r\n\t\t\tfor (; j &lt; i &amp;&amp; index &gt;= sortedSampleIndices[j]; j++)\r\n\t\t\t\tindex++;\r\n\t\t\tsample.add(list.get(index));\r\n\t\t\t\r\n\t\t\tfor (; j &lt;= i; j++) {\r\n\t\t\t\tint temp = sortedSampleIndices[j];\r\n\t\t\t\tsortedSampleIndices[j] = index;\r\n\t\t\t\tindex = temp;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn sample;\r\n\t}","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>This solution doesn't modify the original list or otherwise scale in complexity with the list size. </p>\n\n<p>To get a sample of 4 from a list of 7, we just select a random element out of all 7, then select a random element out of the remaining 6, and so on. If we've already selected indices 4, 0, 3, next we generate a random number out of 0, 1, 2, 3, respectively representing index 1, 2, 5, 6.</p>\n\n<pre><code>static Random rand = new Random();\n\nstatic &lt;T&gt; List&lt;T&gt; randomSample(List&lt;T&gt; list, int size) {\n    List&lt;T&gt; sample = new ArrayList&lt;&gt;();\n\n    for (int sortedSampleIndices[] = new int[size], i = 0; i &lt; size; i++) {\n        int index = rand.nextInt(list.size() - i);\n\n        int j = 0;\n        for (; j &lt; i &amp;&amp; index &gt;= sortedSampleIndices[j]; j++)\n            index++;\n        sample.add(list.get(index));\n\n        for (; j &lt;= i; j++) {\n            int temp = sortedSampleIndices[j];\n            sortedSampleIndices[j] = index;\n            index = temp;\n        }\n    }\n\n    return sample;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":15414363,"reputation":414,"user_id":11120290,"display_name":"Vitalii Shvetsov"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1595673304,"creation_date":1595673304,"answer_id":63087292,"question_id":4702036,"body_markdown":"All of these answers require a modifiable list or run into performance issued\r\n\r\n  \r\nHere&#39;s a swift snippet that required O(k) additional space and is guaranteed to run in O(k) time and doesn&#39;t need a modifiable array. (Performs shuffles in a map)\r\n\r\n      func getRandomElementsFrom(array: [Int], count: Int = 8) -&gt; [Int] {\r\n        if array.count &lt;= count {\r\n            return array\r\n        }\r\n    \r\n        var mapper = [Int: Int]()\r\n        var results = [Int]()\r\n    \r\n        for i in 0..&lt;count {\r\n            let randomIndex = Int.random(in: 0..&lt;array.count - i)\r\n    \r\n            if let existing = mapper[randomIndex] {\r\n                results.append(array[existing])\r\n            } else {\r\n                let element = array[randomIndex]\r\n                results.append(element)\r\n            }\r\n    \r\n            let targetIndex = array.count - 1 - i\r\n            mapper[randomIndex] = mapper[targetIndex] ?? targetIndex \r\n        }\r\n    \r\n        return results\r\n    }","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>All of these answers require a modifiable list or run into performance issued</p>\n<p>Here's a swift snippet that required O(k) additional space and is guaranteed to run in O(k) time and doesn't need a modifiable array. (Performs shuffles in a map)</p>\n<pre><code>  func getRandomElementsFrom(array: [Int], count: Int = 8) -&gt; [Int] {\n    if array.count &lt;= count {\n        return array\n    }\n\n    var mapper = [Int: Int]()\n    var results = [Int]()\n\n    for i in 0..&lt;count {\n        let randomIndex = Int.random(in: 0..&lt;array.count - i)\n\n        if let existing = mapper[randomIndex] {\n            results.append(array[existing])\n        } else {\n            let element = array[randomIndex]\n            results.append(element)\n        }\n\n        let targetIndex = array.count - 1 - i\n        mapper[randomIndex] = mapper[targetIndex] ?? targetIndex \n    }\n\n    return results\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":753717,"reputation":646,"user_id":747004,"display_name":"Justin Cranford"},"score":0,"creation_date":1641495602,"post_id":64041624,"comment_id":124825037,"body_markdown":"It looks like each call to nextRandomN() removes elements from the original list. Any additional calls to nextRandomN() will return an empty list.","body":"It looks like each call to nextRandomN() removes elements from the original list. Any additional calls to nextRandomN() will return an empty list."}],"tags":[],"owner":{"account_id":6522954,"reputation":1831,"user_id":5046586,"display_name":"Aldo Canepa"},"comment_count":1,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1606445759,"creation_date":1600933093,"answer_id":64041624,"question_id":4702036,"body_markdown":"The following method returns a new **List&lt;T&gt; of Min(n, list.size()) random elements** taken from the paramenter List&lt;T&gt; list. Have in mind that the List&lt;T&gt; list is being modified after each call. Therefore, each call will be &quot;consuming&quot; the original list returning **n** random elements from it:\r\n  \r\n\r\n    public static &lt;T&gt; List&lt;T&gt; nextRandomN(List&lt;T&gt; list, int n) {\r\n      return Stream\r\n        .generate(() -&gt; list.remove((int) (list.size() * Math.random())))\r\n        .limit(Math.min(list.size(), n))\r\n        .collect(Collectors.toList());\r\n    }\r\n\r\nSample usage:\r\n\r\n\r\n    List&lt;Integer&gt; list = new ArrayList&lt;&gt;(Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10));\r\n\r\n    System.out.println(nextRandomN(list, 3).toString());\r\n    System.out.println(nextRandomN(list, 3).toString());\r\n    System.out.println(nextRandomN(list, 3).toString());\r\n    System.out.println(nextRandomN(list, 3).toString());\r\n\r\nSample output:\r\n\r\n    [8, 2, 3]\r\n    [4, 10, 7]\r\n    [1, 5, 9]\r\n    [6]\r\n","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>The following method returns a new <strong>List of Min(n, list.size()) random elements</strong> taken from the paramenter List list. Have in mind that the List list is being modified after each call. Therefore, each call will be &quot;consuming&quot; the original list returning <strong>n</strong> random elements from it:</p>\n<pre><code>public static &lt;T&gt; List&lt;T&gt; nextRandomN(List&lt;T&gt; list, int n) {\n  return Stream\n    .generate(() -&gt; list.remove((int) (list.size() * Math.random())))\n    .limit(Math.min(list.size(), n))\n    .collect(Collectors.toList());\n}\n</code></pre>\n<p>Sample usage:</p>\n<pre><code>List&lt;Integer&gt; list = new ArrayList&lt;&gt;(Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10));\n\nSystem.out.println(nextRandomN(list, 3).toString());\nSystem.out.println(nextRandomN(list, 3).toString());\nSystem.out.println(nextRandomN(list, 3).toString());\nSystem.out.println(nextRandomN(list, 3).toString());\n</code></pre>\n<p>Sample output:</p>\n<pre><code>[8, 2, 3]\n[4, 10, 7]\n[1, 5, 9]\n[6]\n</code></pre>\n"},{"tags":[],"owner":{"account_id":17380199,"reputation":21,"user_id":12592592,"display_name":"Rinke"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700047473,"creation_date":1700047473,"answer_id":77487315,"question_id":4702036,"body_markdown":"I&#39;ve benchmarked this, focusing on the methods which give k unique results. I compared 3 methods from this page: \r\n\r\n1) the swapping method by Kostas Kryptos\r\n2) just plain iterating, and drawing again if the item has already been chosen, as shown by BullyWiiPlaza\r\n3) use aykutfirat&#39;s Enumerator to create the indexes to retrieve from the list.\r\n\r\nI didn&#39;t add the shuffle approach, because I guessed it would clearly be slower than method 1 or 2. \r\n\r\nResults with getting 3 items out of a list of 10: \r\n\r\n1: 150 ns\r\n2: 145 ns\r\n3: 260 ns\r\n\r\nResults with getting 5 items out of a list of 1000:\r\n\r\n1: 1362 ns\r\n2: 209 ns\r\n3: 312 ns\r\n\r\n\r\n\r\nIt appears that the plain method doesn&#39;t really show significantly slower performances with bigger original lists, whereas the swap method does. Apparently the swapping gets expensive with bigger lists.\r\n\r\nSo best performance is just plain selecting each random item, and doing the draw again if the item was already selected. ","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>I've benchmarked this, focusing on the methods which give k unique results. I compared 3 methods from this page:</p>\n<ol>\n<li>the swapping method by Kostas Kryptos</li>\n<li>just plain iterating, and drawing again if the item has already been chosen, as shown by BullyWiiPlaza</li>\n<li>use aykutfirat's Enumerator to create the indexes to retrieve from the list.</li>\n</ol>\n<p>I didn't add the shuffle approach, because I guessed it would clearly be slower than method 1 or 2.</p>\n<p>Results with getting 3 items out of a list of 10:</p>\n<p>1: 150 ns\n2: 145 ns\n3: 260 ns</p>\n<p>Results with getting 5 items out of a list of 1000:</p>\n<p>1: 1362 ns\n2: 209 ns\n3: 312 ns</p>\n<p>It appears that the plain method doesn't really show significantly slower performances with bigger original lists, whereas the swap method does. Apparently the swapping gets expensive with bigger lists.</p>\n<p>So best performance is just plain selecting each random item, and doing the draw again if the item was already selected.</p>\n"}],"owner":{"display_name":"user568866"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":73215,"favorite_count":0,"down_vote_count":0,"up_vote_count":92,"accepted_answer_id":4702061,"answer_count":13,"score":92,"last_activity_date":1700047473,"creation_date":1295124247,"question_id":4702036,"body_markdown":"How can I take n random elements from an `ArrayList&lt;E&gt;`?  Ideally, I&#39;d like to be able to make successive calls to the `take()` method to get another x elements, without replacement.","title":"Take n random elements from a List&lt;E&gt;?","body":"<p>How can I take n random elements from an <code>ArrayList&lt;E&gt;</code>?  Ideally, I'd like to be able to make successive calls to the <code>take()</code> method to get another x elements, without replacement.</p>\n"},{"tags":["java","spring-boot","intellij-idea","redis","runtimeexception"],"comments":[{"owner":{"account_id":4111447,"reputation":377,"user_id":3374126,"display_name":"Adrian Madaras"},"score":0,"creation_date":1699964220,"post_id":77304264,"comment_id":136594154,"body_markdown":"I have the same issue on the same MacOS.","body":"I have the same issue on the same MacOS."}],"answers":[{"comments":[{"owner":{"account_id":14152906,"reputation":59,"user_id":10224427,"display_name":"Tajib Smajlović"},"score":0,"creation_date":1698739024,"post_id":77306917,"comment_id":136440106,"body_markdown":"Thank you, your answer helped a lot! By adding this configuration the problem was resolved:\n\n`\n  redis:\n    host: localhost\n    port: 6379\n    database: 2\n    timeout: 30000ms\n    lettuce:\n      pool:\n        max-active: -1\n        max-idle: 500\n`","body":"Thank you, your answer helped a lot! By adding this configuration the problem was resolved:  `   redis:     host: localhost     port: 6379     database: 2     timeout: 30000ms     lettuce:       pool:         max-active: -1         max-idle: 500 `"}],"tags":[],"owner":{"account_id":22986933,"reputation":23,"user_id":17113008,"display_name":"dean7"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1697527418,"creation_date":1697527418,"answer_id":77306917,"question_id":77304264,"body_markdown":"Did you configure the application.yml file to load your redis server&#39;s host, port and password?\r\nFor example: \r\n\r\n    Spring:\r\n      redis:\r\n        host: 192.168.150.123\r\n        port: 6379\r\n        password: abcdef\r\n        database: 2\r\n        timeout: 30000ms\r\n        lettuce:\r\n          pool:\r\n            max-active: -1\r\n            max-idle: 500\r\n\r\n","title":"&quot;Can&#39;t start redis server&quot; exception occurs when trying to run Spring Boot on my MacBook M1 (Sonoma 14.0)","body":"<p>Did you configure the application.yml file to load your redis server's host, port and password?\nFor example:</p>\n<pre><code>Spring:\n  redis:\n    host: 192.168.150.123\n    port: 6379\n    password: abcdef\n    database: 2\n    timeout: 30000ms\n    lettuce:\n      pool:\n        max-active: -1\n        max-idle: 500\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2676787,"reputation":1086,"user_id":2352196,"accept_rate":67,"display_name":"Bojan Trajkovski"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1700047340,"creation_date":1700047340,"answer_id":77487299,"question_id":77304264,"body_markdown":"After upgrading to MacOS Sonoma (v14.x) I&#39;ve had the same issue. Its a common problem which is reported [here][1]\r\n\r\nFix that worked for me is to use different and upgraded repo for Redis embedded server: `com.github.codemonstur:embedded-redis:1.0.0`\r\n\r\n[Link to mvnrepostiory][2]\r\n\r\n\r\n  [1]: https://github.com/kstyrc/embedded-redis/issues/135#issuecomment-1773899523\r\n  [2]: https://mvnrepository.com/artifact/com.github.codemonstur/embedded-redis/1.0.0","title":"&quot;Can&#39;t start redis server&quot; exception occurs when trying to run Spring Boot on my MacBook M1 (Sonoma 14.0)","body":"<p>After upgrading to MacOS Sonoma (v14.x) I've had the same issue. Its a common problem which is reported <a href=\"https://github.com/kstyrc/embedded-redis/issues/135#issuecomment-1773899523\" rel=\"nofollow noreferrer\">here</a></p>\n<p>Fix that worked for me is to use different and upgraded repo for Redis embedded server: <code>com.github.codemonstur:embedded-redis:1.0.0</code></p>\n<p><a href=\"https://mvnrepository.com/artifact/com.github.codemonstur/embedded-redis/1.0.0\" rel=\"nofollow noreferrer\">Link to mvnrepostiory</a></p>\n"}],"owner":{"account_id":14152906,"reputation":59,"user_id":10224427,"display_name":"Tajib Smajlović"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":706,"favorite_count":0,"down_vote_count":1,"up_vote_count":2,"answer_count":2,"score":1,"last_activity_date":1700047340,"creation_date":1697481597,"question_id":77304264,"body_markdown":"When I try to run my Spring Boot app using IntelliJ IDE, everything builds properly and no warning and errors are show. Once the app starts running the following runtime exception occurs:\r\n\r\n`Can&#39;t start redis server. Check logs for details. Redis process log:`\r\n\r\nThis is the line where the exception is thrown:\r\n\r\n[![enter image description here](https://i.stack.imgur.com/3AqhW.png)](https://i.stack.imgur.com/3AqhW.png)\r\n\r\nThe funny thing is that `outputStringBuffer.toString()` returns empty string.\r\n\r\nNow, I am running Redis via the Docker. Now to be sure that the Redis is indeed up and running and that there is no issue with the Docker, I added Redis as a database in IntelliJ IDE and when I execute the following command: `SET &#39;foo&#39; &#39;bar&#39;` the appropriate key/value data was added successfully.\r\n\r\n[![enter image description here](https://i.stack.imgur.com/D2vQ4.png)](https://i.stack.imgur.com/D2vQ4.png)\r\n\r\nI even tried to install and run Redis locally but nothing changed, I still received the same error as above.\r\n\r\nI double checked that every possible configuration is OK and indeed it is. I can connect to Redis via IntelliJ and DBeaver but I cannot connect it from my Spring Boot appplication.","title":"&quot;Can&#39;t start redis server&quot; exception occurs when trying to run Spring Boot on my MacBook M1 (Sonoma 14.0)","body":"<p>When I try to run my Spring Boot app using IntelliJ IDE, everything builds properly and no warning and errors are show. Once the app starts running the following runtime exception occurs:</p>\n<p><code>Can't start redis server. Check logs for details. Redis process log:</code></p>\n<p>This is the line where the exception is thrown:</p>\n<p><a href=\"https://i.stack.imgur.com/3AqhW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3AqhW.png\" alt=\"enter image description here\" /></a></p>\n<p>The funny thing is that <code>outputStringBuffer.toString()</code> returns empty string.</p>\n<p>Now, I am running Redis via the Docker. Now to be sure that the Redis is indeed up and running and that there is no issue with the Docker, I added Redis as a database in IntelliJ IDE and when I execute the following command: <code>SET 'foo' 'bar'</code> the appropriate key/value data was added successfully.</p>\n<p><a href=\"https://i.stack.imgur.com/D2vQ4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D2vQ4.png\" alt=\"enter image description here\" /></a></p>\n<p>I even tried to install and run Redis locally but nothing changed, I still received the same error as above.</p>\n<p>I double checked that every possible configuration is OK and indeed it is. I can connect to Redis via IntelliJ and DBeaver but I cannot connect it from my Spring Boot appplication.</p>\n"},{"tags":["java","maven","devops","semantic-versioning","commitizen"],"comments":[{"owner":{"account_id":1466941,"reputation":1440,"user_id":1379528,"display_name":"Norbert"},"score":0,"creation_date":1677712705,"post_id":74936097,"comment_id":133394681,"body_markdown":"I have no working solution so far, but at least a idea how this could work. There is a `pre_bump_hook` and in that script you can use different environment variables that provide the new version. And with `mvn versions:set` it should be possible to change the version in the pom.xml. I have the same problem, but not enough time so far to solve it :D","body":"I have no working solution so far, but at least a idea how this could work. There is a <code>pre_bump_hook</code> and in that script you can use different environment variables that provide the new version. And with <code>mvn versions:set</code> it should be possible to change the version in the pom.xml. I have the same problem, but not enough time so far to solve it :D"}],"answers":[{"tags":[],"owner":{"account_id":1466941,"reputation":1440,"user_id":1379528,"display_name":"Norbert"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1678145061,"creation_date":1678145061,"answer_id":75656723,"question_id":74936097,"body_markdown":"As I mentioned in my comment above, there is a way to solve this problem and after some testing I&#39;d like to provide you a simple solution now.\r\n\r\nI assume you have `.cz.toml` file in place and already configured and use maven as build system for your Java project.\r\n\r\nFirst you should add a `scripts` folder to the maven root. And put 2 shell scripts in there. The first is `prepare_java_version.sh` and the content is:\r\n\r\n    #!/bin/bash\r\n    mvn versions:set -DnewVersion=$CZ_PRE_NEW_VERSION\r\n\r\nThe second file is `commit_java_version.sh` and in that file you put the content:\r\n\r\n    #!/bin/bash\r\n    mvn versions:commit\r\n\r\nNow you have to edit the `.cz.toml` file and append these two sections:\r\n\r\n    pre_bump_hooks = [\r\n       &quot;scripts/prepare_java_version.sh&quot;\r\n    ]\r\n    post_bump_hooks = [\r\n       &quot;scripts/commit_java_version.sh&quot;\r\n    ]\r\n\r\nAnd now, you are ready to go.\r\n\r\n*Explanation*:\r\nCommitizen calls the `pre_bump_hooks` just before the tag is created, and the shell script modifies the `pom.xml` to the given version. The Version used in the shell script is an environment variable provided by commitizen.\r\n\r\nAfter the commit and the tag are created the `post_bump_hooks` are called and this shell script clean up the maven repo again. The version backup file is removed for example.\r\n\r\n*Hint*: \r\nIf there is a problem, and you need to revert the version change in the pom.xml just call `mvn versions:revert` and you have the old version. But this only works before the commit is called. ","title":"Can Commitizen update pom.xml file?","body":"<p>As I mentioned in my comment above, there is a way to solve this problem and after some testing I'd like to provide you a simple solution now.</p>\n<p>I assume you have <code>.cz.toml</code> file in place and already configured and use maven as build system for your Java project.</p>\n<p>First you should add a <code>scripts</code> folder to the maven root. And put 2 shell scripts in there. The first is <code>prepare_java_version.sh</code> and the content is:</p>\n<pre><code>#!/bin/bash\nmvn versions:set -DnewVersion=$CZ_PRE_NEW_VERSION\n</code></pre>\n<p>The second file is <code>commit_java_version.sh</code> and in that file you put the content:</p>\n<pre><code>#!/bin/bash\nmvn versions:commit\n</code></pre>\n<p>Now you have to edit the <code>.cz.toml</code> file and append these two sections:</p>\n<pre><code>pre_bump_hooks = [\n   &quot;scripts/prepare_java_version.sh&quot;\n]\npost_bump_hooks = [\n   &quot;scripts/commit_java_version.sh&quot;\n]\n</code></pre>\n<p>And now, you are ready to go.</p>\n<p><em>Explanation</em>:\nCommitizen calls the <code>pre_bump_hooks</code> just before the tag is created, and the shell script modifies the <code>pom.xml</code> to the given version. The Version used in the shell script is an environment variable provided by commitizen.</p>\n<p>After the commit and the tag are created the <code>post_bump_hooks</code> are called and this shell script clean up the maven repo again. The version backup file is removed for example.</p>\n<p><em>Hint</em>:\nIf there is a problem, and you need to revert the version change in the pom.xml just call <code>mvn versions:revert</code> and you have the old version. But this only works before the commit is called.</p>\n"},{"tags":[],"owner":{"account_id":29908326,"reputation":1,"user_id":22920357,"display_name":"MrAlucardDante"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700046986,"creation_date":1700046986,"answer_id":77487261,"question_id":74936097,"body_markdown":"There is an even simpler solution, that works for any language.\r\n\r\nIn your pom.xml, add a properties that stores the version number (for instance app.version)\r\n\r\n    &lt;app.version&gt;1.0.0&lt;/app.version&gt;\r\n\r\nThen in your commitizen configuration, add the version_files element and point to the newly added property in your pom:\r\n\r\n    version_files = [\r\n        &quot;pom.xml:app.version&quot;\r\n    ]\r\n[Commitizen documentation][1]\r\n\r\n\r\n  [1]: https://commitizen-tools.github.io/commitizen/bump/#version_files","title":"Can Commitizen update pom.xml file?","body":"<p>There is an even simpler solution, that works for any language.</p>\n<p>In your pom.xml, add a properties that stores the version number (for instance app.version)</p>\n<pre><code>&lt;app.version&gt;1.0.0&lt;/app.version&gt;\n</code></pre>\n<p>Then in your commitizen configuration, add the version_files element and point to the newly added property in your pom:</p>\n<pre><code>version_files = [\n    &quot;pom.xml:app.version&quot;\n]\n</code></pre>\n<p><a href=\"https://commitizen-tools.github.io/commitizen/bump/#version_files\" rel=\"nofollow noreferrer\">Commitizen documentation</a></p>\n"}],"owner":{"account_id":19831416,"reputation":21,"user_id":15837776,"display_name":"Bianca Torres"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":254,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1700046986,"creation_date":1672199691,"question_id":74936097,"body_markdown":"I am working on a Java project and I&#39;m using commitizen to enforce semantic version in CI, when I run the command `cz bump` and `cz changelog` update the .cz.yaml and changelog files with the new version but is not updating the version in pom.xml. Is there a functionality in Commitizen to update this file too?\r\n\r\nAdditionally: the application is currently being built by Maven ","title":"Can Commitizen update pom.xml file?","body":"<p>I am working on a Java project and I'm using commitizen to enforce semantic version in CI, when I run the command <code>cz bump</code> and <code>cz changelog</code> update the .cz.yaml and changelog files with the new version but is not updating the version in pom.xml. Is there a functionality in Commitizen to update this file too?</p>\n<p>Additionally: the application is currently being built by Maven</p>\n"},{"tags":["java","spring"],"answers":[{"tags":[],"owner":{"account_id":7548042,"reputation":1536,"user_id":5730424,"display_name":"Deepak"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1699882497,"creation_date":1699882497,"answer_id":77474279,"question_id":77473901,"body_markdown":"    UserAccountDetails userAccountDetails = (UserAccountDetails) auth.getPrincipal();\r\n    UUID id = userAccountDetails.getId()","title":"Accessing field in springSecurity.userAccountDetails","body":"<pre><code>UserAccountDetails userAccountDetails = (UserAccountDetails) auth.getPrincipal();\nUUID id = userAccountDetails.getId()\n</code></pre>\n"},{"comments":[{"owner":{"account_id":29890109,"reputation":3,"user_id":22906470,"display_name":"xenia"},"score":0,"creation_date":1699992448,"post_id":77475400,"comment_id":136599579,"body_markdown":"I&#39;m sorry if this is obvious, but is UserAccountDetails a spring package I need to import or something I need to define in one of my own classes? Because I really didn&#39;t find anything named &quot;UserAccountDetails&quot; in spring security and am slightly confused. Thanks for your detailed help though.","body":"I&#39;m sorry if this is obvious, but is UserAccountDetails a spring package I need to import or something I need to define in one of my own classes? Because I really didn&#39;t find anything named &quot;UserAccountDetails&quot; in spring security and am slightly confused. Thanks for your detailed help though."},{"owner":{"account_id":26729789,"reputation":73,"user_id":20332351,"display_name":"Xuan Chen"},"score":0,"creation_date":1700045720,"post_id":77475400,"comment_id":136605869,"body_markdown":"@xenia Sorry, since you wrote `SpringSecurityAuthenticationManagement.UserAccountDetails` in your question, I thought that you had written your entity class which is named &quot;UserAccountDetails&quot;. Please see my updated answer.","body":"@xenia Sorry, since you wrote <code>SpringSecurityAuthenticationManagement.UserAccountDetails</code> in your question, I thought that you had written your entity class which is named &quot;UserAccountDetails&quot;. Please see my updated answer."}],"tags":[],"owner":{"account_id":26729789,"reputation":73,"user_id":20332351,"display_name":"Xuan Chen"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1700046481,"creation_date":1699893156,"answer_id":77475400,"question_id":77473901,"body_markdown":"Thanks for the question. There are several ways to display the currently logged-in user&#39;s information. \r\n 1. From SecurityContextHolder\r\n\r\nThe SecurityContextHolder is where Spring Security stores the details of who is authenticated. Spring Security does not care how the SecurityContextHolder is populated. If it contains a value, it is used as the currently authenticated user.\r\n```java\r\n@GetMapping(&quot;/account/your-custom-path-0&quot;)\r\npublic String getAccountIdFromSecurityContextHolder() {\r\n    Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\r\n    UserAccountDetails userAccountDetails = (UserAccountDetails) authentication.getPrincipal();\r\n    UUID uuid = userAccountDetails.getId();\r\n    return uuid.toString();\r\n}\r\n```\r\nPlease refer to [Spring Document][1].\r\n \r\n2. From HttpServletRequest\r\n\r\nHttpServletRequest.getUserPrincipal() returns the result of SecurityContextHolder.getContext().getAuthentication(). This means that it is an Authentication, which is typically an instance of UsernamePasswordAuthenticationToken when using username- and password-based authentication. This can be useful if you need additional information about your user.\r\n```java\r\n@GetMapping(&quot;/account/your-custom-path-1&quot;)\r\npublic String getAccountIdFromHttpServletRequest(HttpServletRequest httpServletRequest) {\r\n    UserAccountDetails userAccountDetails = (UserAccountDetails) httpServletRequest.getUserPrincipal();\r\n    UUID uuid = userAccountDetails.getId();\r\n    return uuid.toString();\r\n}\r\n```\r\nPlease refer to [Spring Document][2].\r\n\r\n 3. Using AuthenticationPrincipal Annotation\r\n\r\nSpring Security provides AuthenticationPrincipalArgumentResolver, which can automatically resolve the current Authentication.getPrincipal() for Spring MVC arguments. By using @EnableWebSecurity, you automatically have this added to your Spring MVC configuration.\r\n```java\r\n@GetMapping(&quot;/account/your-custom-path-2&quot;)\r\npublic String getAccountIdUsingAuthenticationPrincipalAnnotation(@AuthenticationPrincipal UserDetails userDetails) {\r\n    UserAccountDetails userAccountDetails = (UserAccountDetails) userDetails;\r\n    UUID uuid = userAccountDetails.getId();\r\n    return uuid.toString();\r\n}\r\n```\r\nPlease refer to [Spring Document][3].\r\n\r\n 4. From Authentication\r\n\r\nThe Authentication contains ... principal: Identifies the user. When authenticating with a username/password this is often an instance of UserDetails.\r\n```java\r\n@GetMapping(&quot;/account/your-custom-path-3&quot;)\r\npublic String getAccountIdFromAuthentication(Authentication authentication) {\r\n    UserAccountDetails userAccountDetails = (UserAccountDetails) authentication.getPrincipal();\r\n    UUID uuid = userAccountDetails.getId();\r\n    return uuid.toString();\r\n}\r\n```\r\n\r\nPlease refer to [Spring Document][4].\r\n\r\nYou may also refer to [Baeldung - Retrieve User Information in Spring Security][5], which also gives you some information on this issue.\r\nPlease tell me if the links above become invalid in the future.\r\n\r\n---\r\n\r\n**Updated**\r\n\r\nThe class `UserAccountDetails` needs to implement `UserDetails` like this:\r\n```java\r\nimport org.springframework.security.core.GrantedAuthority;\r\nimport org.springframework.security.core.userdetails.UserDetails;\r\n\r\nimport java.util.Collection;\r\nimport java.util.Objects;\r\nimport java.util.UUID;\r\n\r\npublic class UserAccountDetails implements UserDetails {\r\n    private UUID id;\r\n    private String username;\r\n    private String password;\r\n\r\n    public UserAccountDetails(UUID id) {\r\n        this.id = id;\r\n    }\r\n\r\n    // getters and setters\r\n    public UUID getId() {\r\n        return id;\r\n    }\r\n\r\n    public void setId(UUID id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public void setUsername(String username) {\r\n        this.username = username;\r\n    }\r\n\r\n    public void setPassword(String password) {\r\n        this.password = password;\r\n    }\r\n\r\n    @Override\r\n    public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {\r\n        return null; // please use your own settings \r\n    }\r\n\r\n    @Override\r\n    public String getPassword() {\r\n        return password;\r\n    }\r\n\r\n    @Override\r\n    public String getUsername() {\r\n        return username;\r\n    }\r\n\r\n    @Override\r\n    public boolean isAccountNonExpired() {\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean isAccountNonLocked() {\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean isCredentialsNonExpired() {\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean isEnabled() {\r\n        return true;\r\n    }\r\n\r\n    @Override\r\n    public boolean equals(Object object) {\r\n        if (this == object) {\r\n            return true;\r\n        }\r\n        if (object == null || getClass() != object.getClass()) {\r\n            return false;\r\n        }\r\n        UserAccountDetails that = (UserAccountDetails) object;\r\n        return Objects.equals(id, that.id)\r\n                &amp;&amp; Objects.equals(username, that.username)\r\n                &amp;&amp; Objects.equals(password, that.password);\r\n    }\r\n\r\n    @Override\r\n    public int hashCode() {\r\n        return Objects.hash(id, username, password);\r\n    }\r\n\r\n    @Override\r\n    public String toString() {\r\n        // may be useful when debugging\r\n        return &quot;UserAccountDetails {&quot; +\r\n                &quot;id=&quot; + id +\r\n                &quot;, username=&#39;&quot; + username + &#39;\\&#39;&#39; +\r\n                &quot;, password=&#39;&quot; + password + &#39;\\&#39;&#39; +\r\n                &#39;}&#39;;\r\n    }\r\n}\r\n```\r\n\r\n\r\n  [1]: https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder\r\n  [2]: https://docs.spring.io/spring-security/reference/servlet/integrations/servlet-api.html#servletapi-user-principal\r\n  [3]: https://docs.spring.io/spring-security/reference/servlet/integrations/mvc.html#mvc-authentication-principal\r\n  [4]: https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authentication\r\n  [5]: https://www.baeldung.com/get-user-in-spring-security","title":"Accessing field in springSecurity.userAccountDetails","body":"<p>Thanks for the question. There are several ways to display the currently logged-in user's information.</p>\n<ol>\n<li>From SecurityContextHolder</li>\n</ol>\n<p>The SecurityContextHolder is where Spring Security stores the details of who is authenticated. Spring Security does not care how the SecurityContextHolder is populated. If it contains a value, it is used as the currently authenticated user.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@GetMapping(&quot;/account/your-custom-path-0&quot;)\npublic String getAccountIdFromSecurityContextHolder() {\n    Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\n    UserAccountDetails userAccountDetails = (UserAccountDetails) authentication.getPrincipal();\n    UUID uuid = userAccountDetails.getId();\n    return uuid.toString();\n}\n</code></pre>\n<p>Please refer to <a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder\" rel=\"nofollow noreferrer\">Spring Document</a>.</p>\n<ol start=\"2\">\n<li>From HttpServletRequest</li>\n</ol>\n<p>HttpServletRequest.getUserPrincipal() returns the result of SecurityContextHolder.getContext().getAuthentication(). This means that it is an Authentication, which is typically an instance of UsernamePasswordAuthenticationToken when using username- and password-based authentication. This can be useful if you need additional information about your user.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@GetMapping(&quot;/account/your-custom-path-1&quot;)\npublic String getAccountIdFromHttpServletRequest(HttpServletRequest httpServletRequest) {\n    UserAccountDetails userAccountDetails = (UserAccountDetails) httpServletRequest.getUserPrincipal();\n    UUID uuid = userAccountDetails.getId();\n    return uuid.toString();\n}\n</code></pre>\n<p>Please refer to <a href=\"https://docs.spring.io/spring-security/reference/servlet/integrations/servlet-api.html#servletapi-user-principal\" rel=\"nofollow noreferrer\">Spring Document</a>.</p>\n<ol start=\"3\">\n<li>Using AuthenticationPrincipal Annotation</li>\n</ol>\n<p>Spring Security provides AuthenticationPrincipalArgumentResolver, which can automatically resolve the current Authentication.getPrincipal() for Spring MVC arguments. By using @EnableWebSecurity, you automatically have this added to your Spring MVC configuration.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@GetMapping(&quot;/account/your-custom-path-2&quot;)\npublic String getAccountIdUsingAuthenticationPrincipalAnnotation(@AuthenticationPrincipal UserDetails userDetails) {\n    UserAccountDetails userAccountDetails = (UserAccountDetails) userDetails;\n    UUID uuid = userAccountDetails.getId();\n    return uuid.toString();\n}\n</code></pre>\n<p>Please refer to <a href=\"https://docs.spring.io/spring-security/reference/servlet/integrations/mvc.html#mvc-authentication-principal\" rel=\"nofollow noreferrer\">Spring Document</a>.</p>\n<ol start=\"4\">\n<li>From Authentication</li>\n</ol>\n<p>The Authentication contains ... principal: Identifies the user. When authenticating with a username/password this is often an instance of UserDetails.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@GetMapping(&quot;/account/your-custom-path-3&quot;)\npublic String getAccountIdFromAuthentication(Authentication authentication) {\n    UserAccountDetails userAccountDetails = (UserAccountDetails) authentication.getPrincipal();\n    UUID uuid = userAccountDetails.getId();\n    return uuid.toString();\n}\n</code></pre>\n<p>Please refer to <a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-authentication\" rel=\"nofollow noreferrer\">Spring Document</a>.</p>\n<p>You may also refer to <a href=\"https://www.baeldung.com/get-user-in-spring-security\" rel=\"nofollow noreferrer\">Baeldung - Retrieve User Information in Spring Security</a>, which also gives you some information on this issue.\nPlease tell me if the links above become invalid in the future.</p>\n<hr />\n<p><strong>Updated</strong></p>\n<p>The class <code>UserAccountDetails</code> needs to implement <code>UserDetails</code> like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.springframework.security.core.GrantedAuthority;\nimport org.springframework.security.core.userdetails.UserDetails;\n\nimport java.util.Collection;\nimport java.util.Objects;\nimport java.util.UUID;\n\npublic class UserAccountDetails implements UserDetails {\n    private UUID id;\n    private String username;\n    private String password;\n\n    public UserAccountDetails(UUID id) {\n        this.id = id;\n    }\n\n    // getters and setters\n    public UUID getId() {\n        return id;\n    }\n\n    public void setId(UUID id) {\n        this.id = id;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    @Override\n    public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {\n        return null; // please use your own settings \n    }\n\n    @Override\n    public String getPassword() {\n        return password;\n    }\n\n    @Override\n    public String getUsername() {\n        return username;\n    }\n\n    @Override\n    public boolean isAccountNonExpired() {\n        return true;\n    }\n\n    @Override\n    public boolean isAccountNonLocked() {\n        return true;\n    }\n\n    @Override\n    public boolean isCredentialsNonExpired() {\n        return true;\n    }\n\n    @Override\n    public boolean isEnabled() {\n        return true;\n    }\n\n    @Override\n    public boolean equals(Object object) {\n        if (this == object) {\n            return true;\n        }\n        if (object == null || getClass() != object.getClass()) {\n            return false;\n        }\n        UserAccountDetails that = (UserAccountDetails) object;\n        return Objects.equals(id, that.id)\n                &amp;&amp; Objects.equals(username, that.username)\n                &amp;&amp; Objects.equals(password, that.password);\n    }\n\n    @Override\n    public int hashCode() {\n        return Objects.hash(id, username, password);\n    }\n\n    @Override\n    public String toString() {\n        // may be useful when debugging\n        return &quot;UserAccountDetails {&quot; +\n                &quot;id=&quot; + id +\n                &quot;, username='&quot; + username + '\\'' +\n                &quot;, password='&quot; + password + '\\'' +\n                '}';\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":29890109,"reputation":3,"user_id":22906470,"display_name":"xenia"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":53,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77475400,"answer_count":2,"score":0,"last_activity_date":1700046481,"creation_date":1699878588,"question_id":77473901,"body_markdown":"To display the currently logged in user&#39;s information, I need access to the user&#39;s ID as the username is not unique. The User details I get from getPrincipal() already contain an &quot;id&quot; field, yet I can&#39;t access it using this method (throws NoSuchFieldException).\r\n\r\n\r\n```\r\n@GetMapping(&quot;/account&quot;)\r\n\tString account(Model model){\r\n\t\tAuthentication auth = SecurityContextHolder.getContext().getAuthentication();\r\n\t\tString userName= auth.getName();\r\n\t\tObject Principal = auth.getPrincipal();\r\n\t\tUUID id = Principal.getClass().getField(&quot;id&quot;);\r\n```\r\n\r\n The structure printed in the console looks like this: SpringSecurityAuthenticationManagement.UserAccountDetails(id=..., username=..., password=..., isEnabled=..., authorities=...). How can I access only the ID property?","title":"Accessing field in springSecurity.userAccountDetails","body":"<p>To display the currently logged in user's information, I need access to the user's ID as the username is not unique. The User details I get from getPrincipal() already contain an &quot;id&quot; field, yet I can't access it using this method (throws NoSuchFieldException).</p>\n<pre><code>@GetMapping(&quot;/account&quot;)\n    String account(Model model){\n        Authentication auth = SecurityContextHolder.getContext().getAuthentication();\n        String userName= auth.getName();\n        Object Principal = auth.getPrincipal();\n        UUID id = Principal.getClass().getField(&quot;id&quot;);\n</code></pre>\n<p>The structure printed in the console looks like this: SpringSecurityAuthenticationManagement.UserAccountDetails(id=..., username=..., password=..., isEnabled=..., authorities=...). How can I access only the ID property?</p>\n"},{"tags":["java","android-source","robolectric","android.mk"],"answers":[{"comments":[{"owner":{"account_id":16625231,"reputation":23,"user_id":12014509,"display_name":"For tez"},"score":0,"creation_date":1574070805,"post_id":58884200,"comment_id":104085762,"body_markdown":"Thank you for this answer.\nI tried it and it worked like a charm.","body":"Thank you for this answer. I tried it and it worked like a charm."}],"tags":[],"owner":{"account_id":8320825,"reputation":96,"user_id":6252607,"display_name":"Владимир Дивјак"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1573923057,"creation_date":1573849471,"answer_id":58884200,"question_id":57785695,"body_markdown":"    $ mma RunRoboTestExampleTest-jacoco","title":"How to get Code Coverage in AOSP Java and Robolectric with Android.mk","body":"<pre><code>$ mma RunRoboTestExampleTest-jacoco\n</code></pre>\n"}],"owner":{"account_id":16625231,"reputation":23,"user_id":12014509,"display_name":"For tez"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1576,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":58884200,"answer_count":1,"score":2,"last_activity_date":1700046438,"creation_date":1567590167,"question_id":57785695,"body_markdown":"I&#39;m writing an Application in AOSP. I need to make a unit test for this app. For this purpose I used robolectric. The app and the test is compiled with make (Android.mk).\r\nI need a code coverage report and don&#39;t know a way to get this. I only found solutions with the usage of gradle, which we don&#39;t use at the Project.\r\n\r\nDo someone know a solution how to get the Code coverage? \r\n\r\n```java\r\npublic class Example extends Service\r\n{\r\n   @Override\r\n   public void onCreate() {\r\n     Log.d(&quot;Example&quot;,&quot; onCreate&quot;);\r\n   }\r\n\t\r\n   public boolean foo(){\r\n     Log.d(&quot;Example&quot;,&quot; foo&quot;);\r\n     return true;\r\n   }\r\n\r\n   @Override\r\n   public IBinder onBind(Intent intent) {\r\n     return new ExampleBinder();\r\n   }\r\n\r\n    public class ExampleBinder extends Binder {\r\n      // Returns service object\r\n      public Example getService() {\r\n        return Example.this;\r\n      }\r\n    }\r\n}\r\n```\r\n\r\n```\r\nLOCAL_PATH := $(call my-dir)\r\ninclude $(CLEAR_VARS)\r\n\r\nLOCAL_PACKAGE_NAME := RoboTestExampleImpl\r\nLOCAL_MODULE := RoboTestExampleImpl\r\n\r\nLOCAL_MODULE_TAGS := tests\r\nLOCAL_JACK_ENABLED := disabled\r\n\r\nLOCAL_SRC_FILES := $(call all-java-files-under, java)\r\n\r\nLOCAL_COMPATIBILITY_SUITE := e-tests\r\nLOCAL_INSTRUMENTATION_FOR := RoboTestExample\r\n\r\ninclude $(BUILD_STATIC_JAVA_LIBRARY)\r\n````\r\n\r\n```java\r\n@RunWith(RobolectricTestRunner.class)\r\n@Config(shadows = {ShadowBinder.class, manifest=Config.NONE)\r\npublic class ExampleRoboTest {\r\n    private static final String TAG = &quot;ExampleRoboTest&quot;;\r\n    private ServiceController&lt;Example&gt; controller;\r\n    Example service;\r\n\r\n    @Before\r\n    public void setUp() {\r\n        controller = Robolectric.buildService(Example.class);\r\n        service = controller.create().get();\r\n    }\r\n\r\n    @After\r\n    public void tearDown() {\r\n    }\r\n\r\n    @Test\r\n    public void foo()\r\n    {\r\n      assertTrue(service.foo());\r\n    }\r\n\r\n}\r\n```\r\n\r\n```\r\n#############################################\r\n# RoboExample Robolectric test target.         #\r\n#############################################\r\nLOCAL_PATH := $(call my-dir)\r\ninclude $(CLEAR_VARS)\r\n\r\nLOCAL_PACKAGE_NAME := RoboTestExampleTest\r\nLOCAL_MODULE := RoboTestExampleTest\r\n\r\nLOCAL_MODULE_TAGS := tests\r\n\r\nLOCAL_JACK_ENABLED := disabled\r\nLOCAL_PROGUARD_ENABLED := disabled\r\n\r\nLOCAL_SRC_FILES := \\\r\n        $(call all-java-files-under, src) \\\r\nLOCAL_JAVA_LIBRARIES := \\\r\n    robolectric_android-all-stub \\\r\n    Robolectric_all-target \\\r\nLOCAL_STATIC_JAVA_LIBRARIES := \\\r\n     jacocoagent \\\r\n\r\nLOCAL_COMPATIBILITY_SUITE := e-tests\r\nLOCAL_INSTRUMENTATION_FOR := RoboTestExample\r\n\r\ninclude $(BUILD_STATIC_JAVA_LIBRARY)\r\n\r\n#############################################################\r\n# runner target to run the previous target.                 #\r\n#############################################################\r\ninclude $(CLEAR_VARS)\r\n\r\nLOCAL_MODULE := RunRoboTestExampleTest\r\nLOCAL_PROGUARD_ENABLED := disabled\r\n\r\nLOCAL_JAVA_LIBRARIES := \\\r\n    RoboTestExampleTest\\\r\n    robolectric_android-all-stub \\\r\n    Robolectric_all-target \\\r\n\r\nLOCAL_TEST_PACKAGE := RoboTestExample\r\nLOCAL_INSTRUMENT_SOURCE_DIRS := $(dir $(LOCAL_PATH))../main/java\r\nLOCAL_ROBOTEST_TIMEOUT := 36000\r\n\r\ninclude external/robolectric-shadows/run_robotests.mk\r\n```","title":"How to get Code Coverage in AOSP Java and Robolectric with Android.mk","body":"<p>I'm writing an Application in AOSP. I need to make a unit test for this app. For this purpose I used robolectric. The app and the test is compiled with make (Android.mk).\nI need a code coverage report and don't know a way to get this. I only found solutions with the usage of gradle, which we don't use at the Project.</p>\n\n<p>Do someone know a solution how to get the Code coverage? </p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public class Example extends Service\n{\n   @Override\n   public void onCreate() {\n     Log.d(\"Example\",\" onCreate\");\n   }\n\n   public boolean foo(){\n     Log.d(\"Example\",\" foo\");\n     return true;\n   }\n\n   @Override\n   public IBinder onBind(Intent intent) {\n     return new ExampleBinder();\n   }\n\n    public class ExampleBinder extends Binder {\n      // Returns service object\n      public Example getService() {\n        return Example.this;\n      }\n    }\n}\n</code></pre>\n\n<pre><code>LOCAL_PATH := $(call my-dir)\ninclude $(CLEAR_VARS)\n\nLOCAL_PACKAGE_NAME := RoboTestExampleImpl\nLOCAL_MODULE := RoboTestExampleImpl\n\nLOCAL_MODULE_TAGS := tests\nLOCAL_JACK_ENABLED := disabled\n\nLOCAL_SRC_FILES := $(call all-java-files-under, java)\n\nLOCAL_COMPATIBILITY_SUITE := e-tests\nLOCAL_INSTRUMENTATION_FOR := RoboTestExample\n\ninclude $(BUILD_STATIC_JAVA_LIBRARY)\n</code></pre>\n\n<pre class=\"lang-java prettyprint-override\"><code>@RunWith(RobolectricTestRunner.class)\n@Config(shadows = {ShadowBinder.class, manifest=Config.NONE)\npublic class ExampleRoboTest {\n    private static final String TAG = \"ExampleRoboTest\";\n    private ServiceController&lt;Example&gt; controller;\n    Example service;\n\n    @Before\n    public void setUp() {\n        controller = Robolectric.buildService(Example.class);\n        service = controller.create().get();\n    }\n\n    @After\n    public void tearDown() {\n    }\n\n    @Test\n    public void foo()\n    {\n      assertTrue(service.foo());\n    }\n\n}\n</code></pre>\n\n<pre><code>#############################################\n# RoboExample Robolectric test target.         #\n#############################################\nLOCAL_PATH := $(call my-dir)\ninclude $(CLEAR_VARS)\n\nLOCAL_PACKAGE_NAME := RoboTestExampleTest\nLOCAL_MODULE := RoboTestExampleTest\n\nLOCAL_MODULE_TAGS := tests\n\nLOCAL_JACK_ENABLED := disabled\nLOCAL_PROGUARD_ENABLED := disabled\n\nLOCAL_SRC_FILES := \\\n        $(call all-java-files-under, src) \\\nLOCAL_JAVA_LIBRARIES := \\\n    robolectric_android-all-stub \\\n    Robolectric_all-target \\\nLOCAL_STATIC_JAVA_LIBRARIES := \\\n     jacocoagent \\\n\nLOCAL_COMPATIBILITY_SUITE := e-tests\nLOCAL_INSTRUMENTATION_FOR := RoboTestExample\n\ninclude $(BUILD_STATIC_JAVA_LIBRARY)\n\n#############################################################\n# runner target to run the previous target.                 #\n#############################################################\ninclude $(CLEAR_VARS)\n\nLOCAL_MODULE := RunRoboTestExampleTest\nLOCAL_PROGUARD_ENABLED := disabled\n\nLOCAL_JAVA_LIBRARIES := \\\n    RoboTestExampleTest\\\n    robolectric_android-all-stub \\\n    Robolectric_all-target \\\n\nLOCAL_TEST_PACKAGE := RoboTestExample\nLOCAL_INSTRUMENT_SOURCE_DIRS := $(dir $(LOCAL_PATH))../main/java\nLOCAL_ROBOTEST_TIMEOUT := 36000\n\ninclude external/robolectric-shadows/run_robotests.mk\n</code></pre>\n"},{"tags":["java","maven","jar","transitive-dependency"],"comments":[{"owner":{"account_id":18182,"reputation":33673,"user_id":41423,"accept_rate":100,"display_name":"Nick Holt"},"score":1,"creation_date":1700047490,"post_id":77487203,"comment_id":136606172,"body_markdown":"I don&#39;t believe this is possible - the transitive dependencies are the result of the pom hierarchy, not your custom jar. While you could try to concoct something using the `dependencyManagement` section in the &#39;mother&#39; pom, this will likely just move the problem and so I think the best option would be to break out the &#39;models&#39; into their own project with their own pom and then depend on this new artifact (project) from the existing project and wherever else as needed.","body":"I don&#39;t believe this is possible - the transitive dependencies are the result of the pom hierarchy, not your custom jar. While you could try to concoct something using the <code>dependencyManagement</code> section in the &#39;mother&#39; pom, this will likely just move the problem and so I think the best option would be to break out the &#39;models&#39; into their own project with their own pom and then depend on this new artifact (project) from the existing project and wherever else as needed."},{"owner":{"account_id":112317,"reputation":93949,"user_id":296328,"accept_rate":60,"display_name":"khmarbaise"},"score":3,"creation_date":1700055733,"post_id":77487203,"comment_id":136607649,"body_markdown":"If you have a separate intention for reuse i would strongly recommend to make a separate module which contains only those model classes and use the defaut to package your jar file ... which includes the dependencies (defined in the pom file) and that separate module you can configure in the way you need to...","body":"If you have a separate intention for reuse i would strongly recommend to make a separate module which contains only those model classes and use the defaut to package your jar file ... which includes the dependencies (defined in the pom file) and that separate module you can configure in the way you need to..."}],"owner":{"account_id":210082,"reputation":19409,"user_id":461499,"accept_rate":73,"display_name":"Rob Audenaerde"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":25,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700046412,"creation_date":1700046412,"question_id":77487203,"body_markdown":"I&#39;m creating some additional jar file in my pom.xml of a big project (basically, some model classes)\r\n\r\nI&#39;m using the maven-jar-plugin with this configuration:\r\n\r\n\r\n                    &lt;execution&gt;\r\n                        &lt;id&gt;issue-models-jar&lt;/id&gt;\r\n                        &lt;goals&gt;\r\n                            &lt;goal&gt;jar&lt;/goal&gt;\r\n                        &lt;/goals&gt;\r\n                        &lt;configuration&gt;\r\n                            &lt;archive&gt;\r\n                                &lt;addMavenDescriptor&gt;false&lt;/addMavenDescriptor&gt;\r\n                            &lt;/archive&gt;\r\n                            &lt;classifier&gt;issue-models&lt;/classifier&gt;\r\n                            &lt;includes&gt;\r\n                                &lt;include&gt;**/api/issues/models/**&lt;/include&gt;\r\n                            &lt;/includes&gt;\r\n                        &lt;/configuration&gt;\r\n                    &lt;/execution&gt;\r\n\r\n\r\nThis gives me nice clean jars. However, when I use these jars as dependencies in another project (after installing them in a repo), the dependencies of the &#39;mother&#39; pom also appear. \r\n\r\nI know I can exclude these depedencies, but I don&#39;t want to do that in each project where I use these jars.\r\n\r\nIs such a thing feasable in maven? Or am I just taking the wrong approach(tm)?\r\n\r\n\r\n","title":"maven-jar-plugin and excluding transitive dependencies","body":"<p>I'm creating some additional jar file in my pom.xml of a big project (basically, some model classes)</p>\n<p>I'm using the maven-jar-plugin with this configuration:</p>\n<pre><code>                &lt;execution&gt;\n                    &lt;id&gt;issue-models-jar&lt;/id&gt;\n                    &lt;goals&gt;\n                        &lt;goal&gt;jar&lt;/goal&gt;\n                    &lt;/goals&gt;\n                    &lt;configuration&gt;\n                        &lt;archive&gt;\n                            &lt;addMavenDescriptor&gt;false&lt;/addMavenDescriptor&gt;\n                        &lt;/archive&gt;\n                        &lt;classifier&gt;issue-models&lt;/classifier&gt;\n                        &lt;includes&gt;\n                            &lt;include&gt;**/api/issues/models/**&lt;/include&gt;\n                        &lt;/includes&gt;\n                    &lt;/configuration&gt;\n                &lt;/execution&gt;\n</code></pre>\n<p>This gives me nice clean jars. However, when I use these jars as dependencies in another project (after installing them in a repo), the dependencies of the 'mother' pom also appear.</p>\n<p>I know I can exclude these depedencies, but I don't want to do that in each project where I use these jars.</p>\n<p>Is such a thing feasable in maven? Or am I just taking the wrong approach(tm)?</p>\n"},{"tags":["java","spring-boot","jackson","mapstruct"],"comments":[{"owner":{"account_id":4776151,"reputation":2653,"user_id":3859199,"display_name":"Bwvolleyball"},"score":0,"creation_date":1584567181,"post_id":60746717,"comment_id":107479724,"body_markdown":"Can you also add a sample Json object that you are trying to deserialize?","body":"Can you also add a sample Json object that you are trying to deserialize?"},{"owner":{"account_id":18003189,"reputation":31,"user_id":13084642,"display_name":"Latesh"},"score":0,"creation_date":1584567807,"post_id":60746717,"comment_id":107479909,"body_markdown":"{\n  &quot;quote_type&quot;: &quot;auto&quot;,\n  &quot;quote_value&quot;: {\n    &quot;quote_id&quot;: 10,\n    &quot;quote_description&quot;: &quot;This is my first quote&quot;\n  }\n}","body":"{   &quot;quote_type&quot;: &quot;auto&quot;,   &quot;quote_value&quot;: {     &quot;quote_id&quot;: 10,     &quot;quote_description&quot;: &quot;This is my first quote&quot;   } }"}],"answers":[{"comments":[{"owner":{"account_id":18003189,"reputation":31,"user_id":13084642,"display_name":"Latesh"},"score":0,"creation_date":1584647717,"post_id":60747997,"comment_id":107508522,"body_markdown":"I found the issue. I was using the JsonProperty names instead of the actual variable name. After changing mapper class with variable name it worked.                                             @Mappings({\n            @Mapping(target = &quot;type&quot;, source = &quot;quoteFromSource.type&quot;)\n    })\n    QuoteDestination sourceToDestination(QuoteFromSource quoteFromSource);\n\n    @Mappings({\n            @Mapping(target = &quot;type&quot;, source= &quot;quoteDestination.type&quot;)\n    })","body":"I found the issue. I was using the JsonProperty names instead of the actual variable name. After changing mapper class with variable name it worked.                                             @Mappings({             @Mapping(target = &quot;type&quot;, source = &quot;quoteFromSource.type&quot;)     })     QuoteDestination sourceToDestination(QuoteFromSource quoteFromSource);      @Mappings({             @Mapping(target = &quot;type&quot;, source= &quot;quoteDestination.type&quot;)     })"}],"tags":[],"owner":{"account_id":4776151,"reputation":2653,"user_id":3859199,"display_name":"Bwvolleyball"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1584568759,"creation_date":1584568248,"answer_id":60747997,"question_id":60746717,"body_markdown":"I think your mapper might be backwards.\r\n\r\nThe class that directly correlates to your JSON structure is `Quote`.\r\n\r\nThe error makes it appear as if you are attempting to instead deserialize `QuoteFromSource`.\r\n\r\n**Additionally**, you need to make sure your classes have standard / default getters and setters because by default, Jackson makes use of those when deserializing unless you configure it to do property injection directly (not default)\r\n\r\nExample:\r\n\r\n```java\r\npublic class Quote {\r\n\r\n    private String type;\r\n\r\n    private Value value;\r\n\r\n    @JsonSetter(&quot;quote_type&quot;)\r\n    public void setType(String type) {\r\n        this.type = type;\r\n    }\r\n\r\n    @JsonGetter(&quot;quote_type&quot;)\r\n    public String getType() {\r\n        return type;\r\n    }\r\n\r\n    @JsonSetter(&quot;quote_value&quot;)\r\n    public void setValue(Value value) {\r\n        this.value = value;\r\n    }\r\n\r\n    @JsonGetter(&quot;quote_value&quot;)\r\n    public Value getValue() {\r\n        return value;\r\n    }\r\n}\r\n```","title":"Mapping using mapstruct : Error:(22,48) java: The type of parameter &quot;quote&quot; has no property named &quot;quote_type&quot;","body":"<p>I think your mapper might be backwards.</p>\n\n<p>The class that directly correlates to your JSON structure is <code>Quote</code>.</p>\n\n<p>The error makes it appear as if you are attempting to instead deserialize <code>QuoteFromSource</code>.</p>\n\n<p><strong>Additionally</strong>, you need to make sure your classes have standard / default getters and setters because by default, Jackson makes use of those when deserializing unless you configure it to do property injection directly (not default)</p>\n\n<p>Example:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public class Quote {\n\n    private String type;\n\n    private Value value;\n\n    @JsonSetter(\"quote_type\")\n    public void setType(String type) {\n        this.type = type;\n    }\n\n    @JsonGetter(\"quote_type\")\n    public String getType() {\n        return type;\n    }\n\n    @JsonSetter(\"quote_value\")\n    public void setValue(Value value) {\n        this.value = value;\n    }\n\n    @JsonGetter(\"quote_value\")\n    public Value getValue() {\n        return value;\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":18003189,"reputation":31,"user_id":13084642,"display_name":"Latesh"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":8673,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":1,"score":3,"last_activity_date":1700046125,"creation_date":1584561568,"question_id":60746717,"body_markdown":"Getting the below error when trying to build the mapper class.     \r\n\r\n```\r\nError:(20,48) java: The type of parameter &quot;quote&quot; has no property named &quot;quote_type&quot;.\r\nError:(15,53) java: Unknown property &quot;quote_type&quot; in return type.\r\nError:(20,48) java: Property &quot;type&quot; has no write accessor.\r\n```\r\n\r\nMapper class is given below \r\n      \r\n```java\r\n@Mapper(componentModel = &quot;spring&quot;)\r\npublic interface SourceDestinationMapper {\r\n        \r\n    @Mappings({\r\n        @Mapping(target = &quot;quote_type&quot;, source= &quot;quoteFromSource.type&quot;)\r\n    })\r\n    Quote sourceToDestination(QuoteFromSource quoteFromSource);\r\n        \r\n    @Mappings({\r\n        @Mapping(target = &quot;type&quot;, source = &quot;quote.quote_type&quot;)\r\n    })\r\n    QuoteFromSource destinationToSource(Quote quote);\r\n        \r\n    Value sourceValueToDestinationValue(ValueFromSource valueFromSource);\r\n        \r\n    ValueFromSource sourceValueToDestinationValue(Value value);\r\n}\r\n```    \r\n \r\nThe Source class is given below \r\n \r\n```java\r\npublic class Quote {\r\n\r\n    @JsonProperty(&quot;quote_type&quot;)\r\n    private String type;\r\n\r\n    @JsonProperty(&quot;quote_value&quot;)\r\n    private Value value;\r\n}\r\n```\r\n\r\nThe Destination class is given below\r\n\r\n```java\r\npublic class QuoteFromSource {\r\n\r\n    @JsonProperty(&quot;type&quot;)\r\n    private String type;\r\n\r\n    @JsonProperty(&quot;value&quot;)\r\n    private ValueFromSource value;\r\n}\r\n```\r\n\r\nsource class\r\n```java\r\npublic class Value {\r\n\r\n    @JsonProperty(&quot;quote_id&quot;)\r\n    private Integer id;\r\n\r\n    @JsonProperty(&quot;quote_description&quot;)\r\n    private String quote;\r\n}\r\n```\r\n\r\ndestination class\r\n\r\n```java\r\npublic class ValueFromSource {\r\n\r\n    @JsonProperty(&quot;id&quot;)\r\n    private Integer id;\r\n\r\n    @JsonProperty(&quot;quote&quot;)\r\n    private String quote;\r\n}\r\n```\r\n\r\nExample JSON to be deserialized:\r\n```json\r\n{ \r\n    &quot;quote_type&quot;: &quot;auto&quot;,\r\n    &quot;quote_value&quot;: {\r\n        &quot;quote_id&quot;: 10,\r\n        &quot;quote_description&quot;: &quot;This is my first quote&quot;\r\n    } \r\n}\r\n```","title":"Mapping using mapstruct : Error:(22,48) java: The type of parameter &quot;quote&quot; has no property named &quot;quote_type&quot;","body":"<p>Getting the below error when trying to build the mapper class.     </p>\n\n<pre><code>Error:(20,48) java: The type of parameter \"quote\" has no property named \"quote_type\".\nError:(15,53) java: Unknown property \"quote_type\" in return type.\nError:(20,48) java: Property \"type\" has no write accessor.\n</code></pre>\n\n<p>Mapper class is given below </p>\n\n<pre class=\"lang-java prettyprint-override\"><code>@Mapper(componentModel = \"spring\")\npublic interface SourceDestinationMapper {\n\n    @Mappings({\n        @Mapping(target = \"quote_type\", source= \"quoteFromSource.type\")\n    })\n    Quote sourceToDestination(QuoteFromSource quoteFromSource);\n\n    @Mappings({\n        @Mapping(target = \"type\", source = \"quote.quote_type\")\n    })\n    QuoteFromSource destinationToSource(Quote quote);\n\n    Value sourceValueToDestinationValue(ValueFromSource valueFromSource);\n\n    ValueFromSource sourceValueToDestinationValue(Value value);\n}\n</code></pre>\n\n<p>The Source class is given below </p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public class Quote {\n\n    @JsonProperty(\"quote_type\")\n    private String type;\n\n    @JsonProperty(\"quote_value\")\n    private Value value;\n}\n</code></pre>\n\n<p>The Destination class is given below</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public class QuoteFromSource {\n\n    @JsonProperty(\"type\")\n    private String type;\n\n    @JsonProperty(\"value\")\n    private ValueFromSource value;\n}\n</code></pre>\n\n<p>source class</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public class Value {\n\n    @JsonProperty(\"quote_id\")\n    private Integer id;\n\n    @JsonProperty(\"quote_description\")\n    private String quote;\n}\n</code></pre>\n\n<p>destination class</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public class ValueFromSource {\n\n    @JsonProperty(\"id\")\n    private Integer id;\n\n    @JsonProperty(\"quote\")\n    private String quote;\n}\n</code></pre>\n\n<p>Example JSON to be deserialized:</p>\n\n<pre><code>{ \n    \"quote_type\": \"auto\",\n    \"quote_value\": {\n        \"quote_id\": 10,\n        \"quote_description\": \"This is my first quote\"\n    } \n}\n</code></pre>\n"},{"tags":["java","spring-boot","maven","jasypt"],"answers":[{"tags":[],"owner":{"account_id":10777133,"reputation":7282,"user_id":7928721,"display_name":"samabcde"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1632149697,"creation_date":1632149697,"answer_id":69256560,"question_id":69255586,"body_markdown":"According to [Using Maven properties in application.properties in Spring Boot][1], you can add the property in `application.properties` as\r\n```\r\njasypt.encryptor.password=@jasypt.encryptor.password@\r\n```\r\nAnd add below in pom.xml\r\n```xml\r\n\t&lt;build&gt;\r\n\t\t&lt;resources&gt;\r\n\t\t\t&lt;resource&gt;\r\n\t\t\t\t&lt;directory&gt;src/main/resources&lt;/directory&gt;\r\n\t\t\t\t&lt;filtering&gt;true&lt;/filtering&gt;\r\n\t\t\t&lt;/resource&gt;\r\n\t\t&lt;/resources&gt;\r\n   ...\r\n   &lt;/build&gt;\r\n```\r\nThen run\r\n```\r\nclean -Djasypt.encryptor.password=foo spring-boot:run\r\n```\r\nWhat this does is replace `@jasypt.encryptor.password@` by `foo` in `application.properties` inside your target folder.\r\n\r\n  [1]: https://stackoverflow.com/questions/36703499/using-maven-properties-in-application-properties-in-spring-boot","title":"-Djasypt.encryptor.password maven&#39;s option doesn&#39;t work","body":"<p>According to <a href=\"https://stackoverflow.com/questions/36703499/using-maven-properties-in-application-properties-in-spring-boot\">Using Maven properties in application.properties in Spring Boot</a>, you can add the property in <code>application.properties</code> as</p>\n<pre><code>jasypt.encryptor.password=@jasypt.encryptor.password@\n</code></pre>\n<p>And add below in pom.xml</p>\n<pre class=\"lang-xml prettyprint-override\"><code>    &lt;build&gt;\n        &lt;resources&gt;\n            &lt;resource&gt;\n                &lt;directory&gt;src/main/resources&lt;/directory&gt;\n                &lt;filtering&gt;true&lt;/filtering&gt;\n            &lt;/resource&gt;\n        &lt;/resources&gt;\n   ...\n   &lt;/build&gt;\n</code></pre>\n<p>Then run</p>\n<pre><code>clean -Djasypt.encryptor.password=foo spring-boot:run\n</code></pre>\n<p>What this does is replace <code>@jasypt.encryptor.password@</code> by <code>foo</code> in <code>application.properties</code> inside your target folder.</p>\n"},{"tags":[],"owner":{"account_id":109278,"reputation":9687,"user_id":289625,"accept_rate":100,"display_name":"Dave G"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700045985,"creation_date":1700045985,"answer_id":77487168,"question_id":69255586,"body_markdown":"The &quot;-D&quot; options you are passing are actually passed to the maven process.\r\n\r\nI think what you are looking for is the run goal parameters needed to pass to the JVM launching the spring-boot process.\r\n\r\nTry this reference:\r\n\r\nhttps://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/htmlsingle/#run.run-goal.parameter-details.jvm-arguments\r\n\r\n","title":"-Djasypt.encryptor.password maven&#39;s option doesn&#39;t work","body":"<p>The &quot;-D&quot; options you are passing are actually passed to the maven process.</p>\n<p>I think what you are looking for is the run goal parameters needed to pass to the JVM launching the spring-boot process.</p>\n<p>Try this reference:</p>\n<p><a href=\"https://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/htmlsingle/#run.run-goal.parameter-details.jvm-arguments\" rel=\"nofollow noreferrer\">https://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/htmlsingle/#run.run-goal.parameter-details.jvm-arguments</a></p>\n"}],"owner":{"account_id":14661131,"reputation":85,"user_id":10588294,"display_name":"vanR"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":3424,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":2,"score":1,"last_activity_date":1700045985,"creation_date":1632145808,"question_id":69255586,"body_markdown":"I have an application with encrypted password for database connection, but when I want to run it with the secret key in maven options it doesn&#39;t work. I have added the jasypt plugin in the pom.xml.\r\n\r\nThe command I run:\r\n\r\n    mvn -Djasypt.encryptor.password=foo spring-boot:run\r\n\r\n\r\napplication.properties:\r\n\r\n    spring.datasource.url=jdbc:mysql://localhost:3306/my_database\r\n    spring.datasource.username=root\r\n    spring.datasource.password=ENC(Hu76tW6HJjEp730PNXSFOQ==)\r\n\r\n    jasypt.encryptor.algorithm=PBEWithMD5AndDES\r\n    jasypt.encryptor.iv-generator-classname=org.jasypt.iv.NoIvGenerator\r\n\r\n----\r\n\r\nWhen I provide the secret key in the application.properties file, it does work.\r\n\r\nThe command I run when the secret key is provided:\r\n\r\n    mvn spring-boot:run\r\n\r\napplication.properties when the secret key is provided:\r\n\r\n    spring.datasource.url=jdbc:mysql://localhost:3306/my_database\r\n    spring.datasource.username=root\r\n    spring.datasource.password=ENC(Hu76tW6HJjEp730PNXSFOQ==)\r\n\r\n    jasypt.encryptor.algorithm=PBEWithMD5AndDES\r\n    jasypt.encryptor.iv-generator-classname=org.jasypt.iv.NoIvGenerator\r\n    jasypt.encryptor.password=foo\r\n\r\n----\r\npom.xml:\r\n```xml\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n\t...&gt;\r\n    ...\r\n\t&lt;properties&gt;\r\n\t\t...\r\n\t\t&lt;jasypt.version&gt;3.0.4&lt;/jasypt.version&gt;\r\n\t&lt;/properties&gt;\r\n\r\n\t&lt;dependencies&gt;\r\n\t\t...\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;com.github.ulisesbocchio&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;jasypt-spring-boot-starter&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;${jasypt.version}&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t&lt;/dependencies&gt;\r\n\r\n\t&lt;build&gt;\r\n\t\t&lt;plugins&gt;\r\n            ....\r\n\t\t\t&lt;plugin&gt;\r\n\t\t\t\t&lt;groupId&gt;com.github.ulisesbocchio&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;jasypt-maven-plugin&lt;/artifactId&gt;\r\n\t\t\t\t&lt;version&gt;${jasypt.version}&lt;/version&gt;\r\n\t\t\t&lt;/plugin&gt;\r\n\t\t&lt;/plugins&gt;\r\n\t&lt;/build&gt;\r\n&lt;/project&gt;\r\n\r\n```\r\n\r\nThe error I get:\r\n```\r\n***************************\r\nAPPLICATION FAILED TO START\r\n***************************\r\n\r\nDescription:\r\n\r\nFailed to bind properties under &#39;spring.datasource.password&#39; to java.lang.String:\r\n\r\n    Reason: either &#39;jasypt.encryptor.password&#39;, one of [&#39;jasypt.encryptor.private-key-string&#39;, &#39;jasypt.encryptor.private-key-location&#39;] for asymmetric encryption, or one of [&#39;jasypt.encryptor.gcm-secret-key-string&#39;, &#39;jasypt.encryptor.gcm-secret-key-location&#39;, &#39;jasypt.encryptor.gcm-secret-key-password&#39;] for AES/GCM encryption must be provided for Password-based or Asymmetric encryption\r\n\r\nAction:\r\n\r\nUpdate your application&#39;s configuration\r\n\r\n```","title":"-Djasypt.encryptor.password maven&#39;s option doesn&#39;t work","body":"<p>I have an application with encrypted password for database connection, but when I want to run it with the secret key in maven options it doesn't work. I have added the jasypt plugin in the pom.xml.</p>\n<p>The command I run:</p>\n<pre><code>mvn -Djasypt.encryptor.password=foo spring-boot:run\n</code></pre>\n<p>application.properties:</p>\n<pre><code>spring.datasource.url=jdbc:mysql://localhost:3306/my_database\nspring.datasource.username=root\nspring.datasource.password=ENC(Hu76tW6HJjEp730PNXSFOQ==)\n\njasypt.encryptor.algorithm=PBEWithMD5AndDES\njasypt.encryptor.iv-generator-classname=org.jasypt.iv.NoIvGenerator\n</code></pre>\n<hr />\n<p>When I provide the secret key in the application.properties file, it does work.</p>\n<p>The command I run when the secret key is provided:</p>\n<pre><code>mvn spring-boot:run\n</code></pre>\n<p>application.properties when the secret key is provided:</p>\n<pre><code>spring.datasource.url=jdbc:mysql://localhost:3306/my_database\nspring.datasource.username=root\nspring.datasource.password=ENC(Hu76tW6HJjEp730PNXSFOQ==)\n\njasypt.encryptor.algorithm=PBEWithMD5AndDES\njasypt.encryptor.iv-generator-classname=org.jasypt.iv.NoIvGenerator\njasypt.encryptor.password=foo\n</code></pre>\n<hr />\n<p>pom.xml:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n    ...&gt;\n    ...\n    &lt;properties&gt;\n        ...\n        &lt;jasypt.version&gt;3.0.4&lt;/jasypt.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        ...\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.github.ulisesbocchio&lt;/groupId&gt;\n            &lt;artifactId&gt;jasypt-spring-boot-starter&lt;/artifactId&gt;\n            &lt;version&gt;${jasypt.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            ....\n            &lt;plugin&gt;\n                &lt;groupId&gt;com.github.ulisesbocchio&lt;/groupId&gt;\n                &lt;artifactId&gt;jasypt-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;${jasypt.version}&lt;/version&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n\n</code></pre>\n<p>The error I get:</p>\n<pre><code>***************************\nAPPLICATION FAILED TO START\n***************************\n\nDescription:\n\nFailed to bind properties under 'spring.datasource.password' to java.lang.String:\n\n    Reason: either 'jasypt.encryptor.password', one of ['jasypt.encryptor.private-key-string', 'jasypt.encryptor.private-key-location'] for asymmetric encryption, or one of ['jasypt.encryptor.gcm-secret-key-string', 'jasypt.encryptor.gcm-secret-key-location', 'jasypt.encryptor.gcm-secret-key-password'] for AES/GCM encryption must be provided for Password-based or Asymmetric encryption\n\nAction:\n\nUpdate your application's configuration\n\n</code></pre>\n"},{"tags":["java","spring","spring-boot","stream"],"comments":[{"owner":{"account_id":10499788,"reputation":91,"user_id":7738825,"display_name":"Robin Camus"},"score":0,"creation_date":1700045476,"post_id":77486297,"comment_id":136605827,"body_markdown":"Not sure, if you want the philosophy or the concret fact, but the method KeySet() returns the actual Set inside your Map and not a clone of it. https://github.com/AdoptOpenJDK/openjdk-jdk8u/blob/master/jdk/src/share/classes/java/util/HashMap.java","body":"Not sure, if you want the philosophy or the concret fact, but the method KeySet() returns the actual Set inside your Map and not a clone of it. <a href=\"https://github.com/AdoptOpenJDK/openjdk-jdk8u/blob/master/jdk/src/share/classes/java/util/HashMap.java\" rel=\"nofollow noreferrer\">github.com/AdoptOpenJDK/openjdk-jdk8u/blob/master/jdk/src/sh&zwnj;&#8203;are/&hellip;</a>"}],"answers":[{"tags":[],"owner":{"account_id":18586978,"reputation":2220,"user_id":15000097,"display_name":"Georgii Lvov"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1700045962,"creation_date":1700045506,"answer_id":77487107,"question_id":77486297,"body_markdown":"It is changed, due to implementation of `keySet()`. From the javadoc of `HashMap#keySet`:\r\n\r\n&gt; Returns a Set view of the keys contained in this map. The set is\r\n&gt; backed by the map, so changes to the map are reflected in the set, and\r\n&gt; vice-versa.\r\n\r\nTo keep the value unchanged, you need to create a new set based on the keyset of locMap:\r\n\r\n```\r\nSet&lt;String&gt; l = new HashSet&lt;&gt;(locMap.keySet());\r\n```","title":"Value of list changing inside for loop while using stream","body":"<p>It is changed, due to implementation of <code>keySet()</code>. From the javadoc of <code>HashMap#keySet</code>:</p>\n<blockquote>\n<p>Returns a Set view of the keys contained in this map. The set is\nbacked by the map, so changes to the map are reflected in the set, and\nvice-versa.</p>\n</blockquote>\n<p>To keep the value unchanged, you need to create a new set based on the keyset of locMap:</p>\n<pre><code>Set&lt;String&gt; l = new HashSet&lt;&gt;(locMap.keySet());\n</code></pre>\n"}],"owner":{"account_id":10702060,"reputation":23,"user_id":8797280,"display_name":"shashwat"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":53,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1700045962,"creation_date":1700038241,"question_id":77486297,"body_markdown":"```\r\nSet&lt;String&gt; l = locMap.keySet();\r\nfor (Map.Entry&lt;String, String&gt; ven : venderAndFactoryLocMap.entrySet()) {\r\n  if (ven.getValue().equals(VENDOR)) {\r\n    Map&lt;String, String&gt; x1 = l.stream().collect(Collectors.toMap(x -&gt; x + &quot;-&quot; + ven.getKey(), x -&gt; PROCESS));\r\n    locMap.putAll(x1);\r\n  }\r\n}\r\n```\r\n\r\nIn the above , the value of locMap keeps changing but also the value of L (which is the hashset) also changes, I was in the view that once we have assigned a variable its value will not be changed in the stack , why this is happening ?\r\n\r\nI was expecting that the Set remains constant , while we are changing the locMap","title":"Value of list changing inside for loop while using stream","body":"<pre><code>Set&lt;String&gt; l = locMap.keySet();\nfor (Map.Entry&lt;String, String&gt; ven : venderAndFactoryLocMap.entrySet()) {\n  if (ven.getValue().equals(VENDOR)) {\n    Map&lt;String, String&gt; x1 = l.stream().collect(Collectors.toMap(x -&gt; x + &quot;-&quot; + ven.getKey(), x -&gt; PROCESS));\n    locMap.putAll(x1);\n  }\n}\n</code></pre>\n<p>In the above , the value of locMap keeps changing but also the value of L (which is the hashset) also changes, I was in the view that once we have assigned a variable its value will not be changed in the stack , why this is happening ?</p>\n<p>I was expecting that the Set remains constant , while we are changing the locMap</p>\n"},{"tags":["java","log4j"],"comments":[{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1700048971,"post_id":77487142,"comment_id":136606404,"body_markdown":"Log4j is end-of-life and obsolete.  You should not be writing code to use it.","body":"Log4j is end-of-life and obsolete.  You should not be writing code to use it."},{"owner":{"account_id":16269349,"reputation":13452,"user_id":11748454,"display_name":"Piotr P. Karwasz"},"score":0,"creation_date":1700217182,"post_id":77487142,"comment_id":136629900,"body_markdown":"Version 1.x of Log4j reached EOL. This configuration file uses the 2.x syntax.","body":"Version 1.x of Log4j reached EOL. This configuration file uses the 2.x syntax."}],"owner":{"account_id":29908173,"reputation":1,"user_id":22920225,"display_name":"Matthias"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":19,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700045774,"creation_date":1700045774,"question_id":77487142,"body_markdown":"I have a multi threaded application in which I want to log to different directories based on the context from where the log message was generated.\r\n\r\nI don&#39;t want or need a single directory for each thread. In my case I have multiple threads that belong to the same context and should share the same log directory. The context is identified by a named object.\r\n\r\nI did find multiple solutions explaining how to separate your log into multiple files using the LogLevel, Thread name and system variables.\r\n\r\nIn fact I already use a system variable to write to different directories based on the application that is currently running (multiple applications share this config). Here it is:\r\n\r\n\r\n```\r\n&lt;Configuration&gt;\r\n    &lt;Appenders&gt;    \r\n        &lt;RollingFile name=&quot;RollingFile&quot; fileName=&quot;${sys:logfiledir}/out.log&quot; filePattern=&quot;${sys:logfiledir}/out-%d{yyyy-MM-dd}-%i.log&quot;&gt;\r\n\t        &lt;PatternLayout&gt;\r\n\t            &lt;pattern&gt;%-5p %d{yyyy-MM-dd HH:mm:ss.SSS}{GMT+0} UTC %C:%L - %msg%n&lt;/pattern&gt;\r\n\t        &lt;/PatternLayout&gt;\r\n\t        &lt;Policies&gt;\r\n\t            &lt;SizeBasedTriggeringPolicy size=&quot;10 MB&quot; /&gt;\r\n\t        &lt;/Policies&gt;\r\n\t        &lt;DefaultRolloverStrategy&gt;\r\n        \t\t&lt;Delete basePath=&quot;${sys:logfiledir}&quot; &gt;\r\n          \t\t\t&lt;IfLastModified age=&quot;10d&quot; /&gt;\r\n       \t\t\t&lt;/Delete&gt;\r\n      \t\t&lt;/DefaultRolloverStrategy&gt;\r\n\t    &lt;/RollingFile&gt;\r\n        &lt;Console name=&quot;Console&quot;&gt;\r\n\t        &lt;PatternLayout&gt;\r\n\t            &lt;pattern&gt;%-5p %d{yyyy-MM-dd HH:mm:ss.SSS}{GMT+0} UTC %C:%L - %msg%n&lt;/pattern&gt;\r\n\t        &lt;/PatternLayout&gt;\r\n\t    &lt;/Console&gt;\r\n    &lt;/Appenders&gt;\r\n    \r\n    &lt;Loggers&gt;\r\n        &lt;Logger name=&quot;de&quot; level=&quot;${sys:loglevel}&quot; additivity=&quot;false&quot;&gt;\r\n            &lt;appender-ref ref=&quot;RollingFile&quot;/&gt;\r\n            &lt;appender-ref ref=&quot;Console&quot;/&gt;\r\n        &lt;/Logger&gt;\r\n    &lt;/Loggers&gt;\r\n&lt;/Configuration&gt;\r\n```\r\n\r\nIt would be great if I could pass a string parameter into the `LogManager.getLogger()` function that would be used to determine the subdirectory in which to log into. But for what I can tell that is not an option.\r\n\r\nIf all fails I guess I could give up on the XML configuration and build multiple appenders and loggers programatically based on the contexts I have.","title":"Logging to different directories using log4j based on context","body":"<p>I have a multi threaded application in which I want to log to different directories based on the context from where the log message was generated.</p>\n<p>I don't want or need a single directory for each thread. In my case I have multiple threads that belong to the same context and should share the same log directory. The context is identified by a named object.</p>\n<p>I did find multiple solutions explaining how to separate your log into multiple files using the LogLevel, Thread name and system variables.</p>\n<p>In fact I already use a system variable to write to different directories based on the application that is currently running (multiple applications share this config). Here it is:</p>\n<pre><code>&lt;Configuration&gt;\n    &lt;Appenders&gt;    \n        &lt;RollingFile name=&quot;RollingFile&quot; fileName=&quot;${sys:logfiledir}/out.log&quot; filePattern=&quot;${sys:logfiledir}/out-%d{yyyy-MM-dd}-%i.log&quot;&gt;\n            &lt;PatternLayout&gt;\n                &lt;pattern&gt;%-5p %d{yyyy-MM-dd HH:mm:ss.SSS}{GMT+0} UTC %C:%L - %msg%n&lt;/pattern&gt;\n            &lt;/PatternLayout&gt;\n            &lt;Policies&gt;\n                &lt;SizeBasedTriggeringPolicy size=&quot;10 MB&quot; /&gt;\n            &lt;/Policies&gt;\n            &lt;DefaultRolloverStrategy&gt;\n                &lt;Delete basePath=&quot;${sys:logfiledir}&quot; &gt;\n                    &lt;IfLastModified age=&quot;10d&quot; /&gt;\n                &lt;/Delete&gt;\n            &lt;/DefaultRolloverStrategy&gt;\n        &lt;/RollingFile&gt;\n        &lt;Console name=&quot;Console&quot;&gt;\n            &lt;PatternLayout&gt;\n                &lt;pattern&gt;%-5p %d{yyyy-MM-dd HH:mm:ss.SSS}{GMT+0} UTC %C:%L - %msg%n&lt;/pattern&gt;\n            &lt;/PatternLayout&gt;\n        &lt;/Console&gt;\n    &lt;/Appenders&gt;\n    \n    &lt;Loggers&gt;\n        &lt;Logger name=&quot;de&quot; level=&quot;${sys:loglevel}&quot; additivity=&quot;false&quot;&gt;\n            &lt;appender-ref ref=&quot;RollingFile&quot;/&gt;\n            &lt;appender-ref ref=&quot;Console&quot;/&gt;\n        &lt;/Logger&gt;\n    &lt;/Loggers&gt;\n&lt;/Configuration&gt;\n</code></pre>\n<p>It would be great if I could pass a string parameter into the <code>LogManager.getLogger()</code> function that would be used to determine the subdirectory in which to log into. But for what I can tell that is not an option.</p>\n<p>If all fails I guess I could give up on the XML configuration and build multiple appenders and loggers programatically based on the contexts I have.</p>\n"},{"tags":["java"],"answers":[{"comments":[{"owner":{"account_id":45664,"reputation":906,"user_id":134711,"accept_rate":89,"display_name":"Anthony"},"score":15,"creation_date":1315445838,"post_id":7342244,"comment_id":8856453,"body_markdown":"The % operator is called modulo.","body":"The % operator is called modulo."},{"owner":{"account_id":446547,"reputation":126635,"user_id":839646,"accept_rate":70,"display_name":"Ryan Stewart"},"score":4,"creation_date":1315446115,"post_id":7342244,"comment_id":8856481,"body_markdown":"@Anthony: Actually, it&#39;s the [&quot;remainder operator&quot;](http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#15.17.3).","body":"@Anthony: Actually, it&#39;s the <a href=\"http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#15.17.3\" rel=\"nofollow noreferrer\">&quot;remainder operator&quot;</a>."},{"owner":{"account_id":29046,"reputation":66704,"user_id":78182,"accept_rate":94,"display_name":"Stefan Kendall"},"score":4,"creation_date":1315447146,"post_id":7342244,"comment_id":8856590,"body_markdown":"The mathematical term is modulus, and it has wider-applicability than getting the remainder. `(A % B)` itself can be used as an expression, and that&#39;s when things get fun.","body":"The mathematical term is modulus, and it has wider-applicability than getting the remainder. <code>(A % B)</code> itself can be used as an expression, and that&#39;s when things get fun."},{"owner":{"account_id":446547,"reputation":126635,"user_id":839646,"accept_rate":70,"display_name":"Ryan Stewart"},"score":2,"creation_date":1315447656,"post_id":7342244,"comment_id":8856650,"body_markdown":"@Stefan: I won&#39;t belabor the point, but mathematicians tend to point out that in [modular arithmetic](http://en.wikipedia.org/wiki/Modular_arithmetic) the modulus and the remainder [aren&#39;t the same thing](http://mathforum.org/library/drmath/view/54363.html).","body":"@Stefan: I won&#39;t belabor the point, but mathematicians tend to point out that in <a href=\"http://en.wikipedia.org/wiki/Modular_arithmetic\" rel=\"nofollow noreferrer\">modular arithmetic</a> the modulus and the remainder <a href=\"http://mathforum.org/library/drmath/view/54363.html\" rel=\"nofollow noreferrer\">aren&#39;t the same thing</a>."},{"owner":{"account_id":29046,"reputation":66704,"user_id":78182,"accept_rate":94,"display_name":"Stefan Kendall"},"score":0,"creation_date":1315452620,"post_id":7342244,"comment_id":8857164,"body_markdown":"Google &quot;modulus operator&quot; (language). Correct the few thousand results and I&#39;ll reconsider my comment.","body":"Google &quot;modulus operator&quot; (language). Correct the few thousand results and I&#39;ll reconsider my comment."},{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":2,"creation_date":1491955619,"post_id":7342244,"comment_id":73778956,"body_markdown":"@StefanKendall Check the [Java Language Specification #15.17.3](http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.17.3). Google is not a normative reference.","body":"@StefanKendall Check the <a href=\"http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.17.3\" rel=\"nofollow noreferrer\">Java Language Specification #15.17.3</a>. Google is not a normative reference."},{"owner":{"account_id":2805226,"reputation":777,"user_id":2412606,"display_name":"Happy"},"score":0,"creation_date":1629270619,"post_id":7342244,"comment_id":121639063,"body_markdown":"`%` is very slow. Use the bit operation instead, as the comment bellow","body":"<code>%</code> is very slow. Use the bit operation instead, as the comment bellow"}],"tags":[],"owner":{"account_id":446547,"reputation":126635,"user_id":839646,"accept_rate":70,"display_name":"Ryan Stewart"},"comment_count":7,"down_vote_count":1,"up_vote_count":32,"is_accepted":false,"score":31,"last_activity_date":1315445785,"creation_date":1315445785,"answer_id":7342244,"question_id":7342237,"body_markdown":"If the remainder when you divide by 2 is 0, it&#39;s even. `%` is the operator to get a remainder.","title":"Check whether number is even or odd","body":"<p>If the remainder when you divide by 2 is 0, it's even. <code>%</code> is the operator to get a remainder.</p>\n"},{"comments":[{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":1,"creation_date":1491955674,"post_id":7342247,"comment_id":73778967,"body_markdown":"&#39;Regardless of if it&#39;s a decimal&#39; is meaningless. Decimal is a radix. Do you mean &#39;contains a fractional part&#39;?","body":"&#39;Regardless of if it&#39;s a decimal&#39; is meaningless. Decimal is a radix. Do you mean &#39;contains a fractional part&#39;?"}],"tags":[],"owner":{"account_id":261035,"reputation":6348,"user_id":544963,"accept_rate":100,"display_name":"fireshadow52"},"comment_count":1,"down_vote_count":1,"up_vote_count":24,"is_accepted":false,"score":23,"last_activity_date":1501573990,"creation_date":1315445811,"answer_id":7342247,"question_id":7342237,"body_markdown":"Every even number is divisible by two, regardless of if it&#39;s a decimal (but the decimal, if present, must also be even). So you can use the `%` (modulo) operator, which divides the number on the left by the number on the right and returns the remainder...\r\n\r\n    boolean isEven(double num) { return ((num % 2) == 0); }","title":"Check whether number is even or odd","body":"<p>Every even number is divisible by two, regardless of if it's a decimal (but the decimal, if present, must also be even). So you can use the <code>%</code> (modulo) operator, which divides the number on the left by the number on the right and returns the remainder...</p>\n\n<pre><code>boolean isEven(double num) { return ((num % 2) == 0); }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":532326,"reputation":706,"user_id":903376,"display_name":"Phil"},"comment_count":0,"down_vote_count":0,"up_vote_count":26,"is_accepted":false,"score":26,"last_activity_date":1491955633,"creation_date":1315445833,"answer_id":7342251,"question_id":7342237,"body_markdown":"The remainder operator, %, will give you the remainder after dividing by a number.\r\n\r\nSo `n % 2 == 0` will be true if n is even and false if n is odd.","title":"Check whether number is even or odd","body":"<p>The remainder operator, %, will give you the remainder after dividing by a number.</p>\n\n<p>So <code>n % 2 == 0</code> will be true if n is even and false if n is odd.</p>\n"},{"tags":[],"owner":{"account_id":343738,"reputation":10191,"user_id":675637,"accept_rate":77,"display_name":"poy"},"comment_count":0,"down_vote_count":2,"up_vote_count":125,"is_accepted":false,"score":123,"last_activity_date":1622722968,"creation_date":1315445859,"answer_id":7342253,"question_id":7342237,"body_markdown":"    if ((x % 2) == 0) {\r\n       // even\r\n    } else {\r\n       // odd\r\n    }","title":"Check whether number is even or odd","body":"<pre><code>if ((x % 2) == 0) {\n   // even\n} else {\n   // odd\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":1230575,"reputation":16783,"user_id":1195273,"accept_rate":81,"display_name":"crush"},"score":29,"creation_date":1392328034,"post_id":7342273,"comment_id":32926881,"body_markdown":"It still amazes me that people prefer modulus over simply checking the first bit of the number. Obviously if the first bit is set, then the number must be odd. It&#39;s usually faster, and it reads just as well in my opinion. I think the reason others don&#39;t prefer it over modulus comes down to a lack of understanding of binary.","body":"It still amazes me that people prefer modulus over simply checking the first bit of the number. Obviously if the first bit is set, then the number must be odd. It&#39;s usually faster, and it reads just as well in my opinion. I think the reason others don&#39;t prefer it over modulus comes down to a lack of understanding of binary."},{"owner":{"account_id":278189,"reputation":13863,"user_id":572635,"accept_rate":75,"display_name":"dtech"},"score":2,"creation_date":1399281769,"post_id":7342273,"comment_id":35980706,"body_markdown":"@crush The compiler/JVM is (probably) smart enough to optimize `N % 2`. Premature optimization is the root of all evil...","body":"@crush The compiler/JVM is (probably) smart enough to optimize <code>N % 2</code>. Premature optimization is the root of all evil..."},{"owner":{"account_id":1230575,"reputation":16783,"user_id":1195273,"accept_rate":81,"display_name":"crush"},"score":5,"creation_date":1399289232,"post_id":7342273,"comment_id":35985006,"body_markdown":"@dtech I think you misunderstand the meaning of premature optimization. If you know beforehand that one method is more performant than another, then it&#39;s not premature optimization to use the more performant method. It&#39;s intelligent. That said, my comment was more about how checking the first bit is more logical than using modulus when simply checking for even/odd. The problem is that many programmers don&#39;t understand what either method does, and just follow tutorials.","body":"@dtech I think you misunderstand the meaning of premature optimization. If you know beforehand that one method is more performant than another, then it&#39;s not premature optimization to use the more performant method. It&#39;s intelligent. That said, my comment was more about how checking the first bit is more logical than using modulus when simply checking for even/odd. The problem is that many programmers don&#39;t understand what either method does, and just follow tutorials."},{"owner":{"account_id":278189,"reputation":13863,"user_id":572635,"accept_rate":75,"display_name":"dtech"},"score":75,"creation_date":1399293397,"post_id":7342273,"comment_id":35987472,"body_markdown":"@crush `n % 2 == 0` semantically means `Divide by 2 and check if the remainder is 0`, which is much clearer than `n &amp; 1 == 0` which means `Zero all the bits but leave the least significant bit unchanged and check if the result is 0`. The improved clarity of the first is worth the (probably non-existant) overhead. That is what I meant with premature optimization. If something is slow and you profile it in that part changing `n % 2` to `n &amp; 1` is certainly justified, but doing it beforehand isn&#39;t. In general working with the bit operators is a bad idea before profiling.","body":"@crush <code>n % 2 == 0</code> semantically means <code>Divide by 2 and check if the remainder is 0</code>, which is much clearer than <code>n &amp; 1 == 0</code> which means <code>Zero all the bits but leave the least significant bit unchanged and check if the result is 0</code>. The improved clarity of the first is worth the (probably non-existant) overhead. That is what I meant with premature optimization. If something is slow and you profile it in that part changing <code>n % 2</code> to <code>n &amp; 1</code> is certainly justified, but doing it beforehand isn&#39;t. In general working with the bit operators is a bad idea before profiling."},{"owner":{"account_id":1230575,"reputation":16783,"user_id":1195273,"accept_rate":81,"display_name":"crush"},"score":19,"creation_date":1399297778,"post_id":7342273,"comment_id":35990257,"body_markdown":"@dtech First of all, your opinion is completely subjective. Second of all, you still don&#39;t understand what &quot;premature optimization&quot; means. It is a micro optimization, sure. It&#39;s not a premature optimization. Premature optimization is revising existing code with &quot;optimizations&quot; without first profiling the existing code to see that it is inefficient. However, knowing beforehand that writing code one way vs. another way is more efficient, and choosing to use the more efficient code, is NOT premature optimization. It is your subjective opinion that `n % 2 == 0` is *cleaner* than `n &amp; 1 == 0`.","body":"@dtech First of all, your opinion is completely subjective. Second of all, you still don&#39;t understand what &quot;premature optimization&quot; means. It is a micro optimization, sure. It&#39;s not a premature optimization. Premature optimization is revising existing code with &quot;optimizations&quot; without first profiling the existing code to see that it is inefficient. However, knowing beforehand that writing code one way vs. another way is more efficient, and choosing to use the more efficient code, is NOT premature optimization. It is your subjective opinion that <code>n % 2 == 0</code> is <i>cleaner</i> than <code>n &amp; 1 == 0</code>."},{"owner":{"account_id":1230575,"reputation":16783,"user_id":1195273,"accept_rate":81,"display_name":"crush"},"score":2,"creation_date":1399298531,"post_id":7342273,"comment_id":35990700,"body_markdown":"@dtech Anyone with an understanding of base 2 would understand quite clearly that `n &amp; 1 == 0` is checking for even. I like how you tried really hard to make `n &amp; 1 == 0` sound much more complex and obtuse than it really is. Let&#39;s be honest. `n &amp; 1 == 0` Is doing a bitwise AND on the first bit. Where modulus shines is when you have `x % n` scenarios.","body":"@dtech Anyone with an understanding of base 2 would understand quite clearly that <code>n &amp; 1 == 0</code> is checking for even. I like how you tried really hard to make <code>n &amp; 1 == 0</code> sound much more complex and obtuse than it really is. Let&#39;s be honest. <code>n &amp; 1 == 0</code> Is doing a bitwise AND on the first bit. Where modulus shines is when you have <code>x % n</code> scenarios."},{"owner":{"account_id":375461,"reputation":2234,"user_id":726315,"accept_rate":89,"display_name":"arkon"},"score":4,"creation_date":1407955655,"post_id":7342273,"comment_id":39419999,"body_markdown":"@dtech Never _assume_ that your compiler is smarter than you. Because as it turns out, in this case, it isn&#39;t. If you actually look through the assembly, a bit check in this scenario requires less instructions than a mod check. See top answer &amp; comments here &gt;&gt;&gt; http://stackoverflow.com/questions/16969220/what-is-the-most-efficent-way-to-detect-even-numbers-in-java","body":"@dtech Never <i>assume</i> that your compiler is smarter than you. Because as it turns out, in this case, it isn&#39;t. If you actually look through the assembly, a bit check in this scenario requires less instructions than a mod check. See top answer &amp; comments here &gt;&gt;&gt; <a href=\"http://stackoverflow.com/questions/16969220/what-is-the-most-efficent-way-to-detect-even-numbers-in-java\" title=\"what is the most efficent way to detect even numbers in java\">stackoverflow.com/questions/16969220/&hellip;</a>"},{"owner":{"account_id":1540226,"reputation":1045,"user_id":1435079,"display_name":"Lawrence"},"score":5,"creation_date":1409563814,"post_id":7342273,"comment_id":39993634,"body_markdown":"If optimization is that important, let&#39;s all go back to C. Runs about 40x faster than Java... And we can again do everything JAVA does for us, ourselves :-)  Sorry guys don&#39;t kill me had to say this :-)","body":"If optimization is that important, let&#39;s all go back to C. Runs about 40x faster than Java... And we can again do everything JAVA does for us, ourselves :-)  Sorry guys don&#39;t kill me had to say this :-)"},{"owner":{"account_id":1843710,"reputation":1371,"user_id":3293816,"accept_rate":94,"display_name":"user99999991"},"score":1,"creation_date":1411364300,"post_id":7342273,"comment_id":40658280,"body_markdown":"@Lawrence - ... that&#39;s ~exactly~ why C is still use A TON today. No one needs to go &quot;back&quot; when we&#39;re still here using C for the reason you stated yourself :P","body":"@Lawrence - ... that&#39;s ~exactly~ why C is still use A TON today. No one needs to go &quot;back&quot; when we&#39;re still here using C for the reason you stated yourself :P"},{"owner":{"account_id":151394,"reputation":52351,"user_id":365237,"accept_rate":96,"display_name":"eis"},"score":4,"creation_date":1416552849,"post_id":7342273,"comment_id":42627501,"body_markdown":"funny, top voted answer with 41 upvotes and it doesn&#39;t even compile.","body":"funny, top voted answer with 41 upvotes and it doesn&#39;t even compile."},{"owner":{"account_id":151394,"reputation":52351,"user_id":365237,"accept_rate":96,"display_name":"eis"},"score":1,"creation_date":1416553200,"post_id":7342273,"comment_id":42627628,"body_markdown":"@Lawrence except that it doesn&#39;t. For some programs, C is faster, for some Java. The difference tends to be around 10-20%, hardly 40x of anything.","body":"@Lawrence except that it doesn&#39;t. For some programs, C is faster, for some Java. The difference tends to be around 10-20%, hardly 40x of anything."},{"owner":{"account_id":2900402,"reputation":512,"user_id":2487254,"accept_rate":100,"display_name":"Jxek"},"score":23,"creation_date":1420709881,"post_id":7342273,"comment_id":44078188,"body_markdown":"I&#39;d just like to point out for people coming here that using the modulo operator is fine, but if you&#39;re using it to test oddness, write n % 2 != 0, not n % 2 == 1, because the latter doesn&#39;t work for negative numbers in Java.","body":"I&#39;d just like to point out for people coming here that using the modulo operator is fine, but if you&#39;re using it to test oddness, write n % 2 != 0, not n % 2 == 1, because the latter doesn&#39;t work for negative numbers in Java."},{"owner":{"account_id":535038,"reputation":567,"user_id":904735,"accept_rate":64,"display_name":"Grigor Nazaryan"},"score":0,"creation_date":1462491277,"post_id":7342273,"comment_id":61670739,"body_markdown":"Guys why you are assuming that applying and operator to any number with 1 will produce 0 if even? Say 4 &amp; 1, 00000100 &amp; 00000001 = 11111010, so not 0","body":"Guys why you are assuming that applying and operator to any number with 1 will produce 0 if even? Say 4 &amp; 1, 00000100 &amp; 00000001 = 11111010, so not 0"},{"owner":{"account_id":1540226,"reputation":1045,"user_id":1435079,"display_name":"Lawrence"},"score":0,"creation_date":1466610110,"post_id":7342273,"comment_id":63391562,"body_markdown":"@eis, I think you are mixing C++ with C. C++ is about 10-20% faster than JAVA. And C is another 10 to 20% faster than C++ :-D Not that it matters, I prefer JAVA anyway but if we&#39;re bit-screwing anyway.. haha :-) I still have to encounter the first JAVA program that beats C in performance. Stability is another issue where skills will be more important. To write a stable C program requires better dev skills I feel. No insult intended...","body":"@eis, I think you are mixing C++ with C. C++ is about 10-20% faster than JAVA. And C is another 10 to 20% faster than C++ :-D Not that it matters, I prefer JAVA anyway but if we&#39;re bit-screwing anyway.. haha :-) I still have to encounter the first JAVA program that beats C in performance. Stability is another issue where skills will be more important. To write a stable C program requires better dev skills I feel. No insult intended..."},{"owner":{"account_id":151394,"reputation":52351,"user_id":365237,"accept_rate":96,"display_name":"eis"},"score":2,"creation_date":1466632138,"post_id":7342273,"comment_id":63403605,"body_markdown":"@Lawrence If you haven&#39;t seen any, I guess you haven&#39;t looked at the actual benchmarks like [this](http://scribblethink.org/Computer/javaCbenchmark.html), combining several results. Despite the title it quotes several C examples.","body":"@Lawrence If you haven&#39;t seen any, I guess you haven&#39;t looked at the actual benchmarks like <a href=\"http://scribblethink.org/Computer/javaCbenchmark.html\" rel=\"nofollow noreferrer\">this</a>, combining several results. Despite the title it quotes several C examples."},{"owner":{"account_id":1730551,"reputation":13017,"user_id":1584255,"accept_rate":65,"display_name":"The Coordinator"},"score":0,"creation_date":1476575199,"post_id":7342273,"comment_id":67404725,"body_markdown":"@GrigorNazaryan Check your binary function. The 00000100 &amp; 00000001 = 00000000. You were doing a &#39;nor&#39; see https://en.wikipedia.org/wiki/NOR_gate.","body":"@GrigorNazaryan Check your binary function. The 00000100 &amp; 00000001 = 00000000. You were doing a &#39;nor&#39; see <a href=\"https://en.wikipedia.org/wiki/NOR_gate\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/NOR_gate</a>."},{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1491955519,"post_id":7342273,"comment_id":73778932,"body_markdown":"@dtech Re &#39;premature optimization&#39;, I suggest you look up what Knuth actually wrote. You will get quite a surprise. This is one of the most persistently misused partial quotations in computer science.","body":"@dtech Re &#39;premature optimization&#39;, I suggest you look up what Knuth actually wrote. You will get quite a surprise. This is one of the most persistently misused partial quotations in computer science."},{"owner":{"account_id":3200251,"reputation":1508,"user_id":2702433,"display_name":"Volker Seibt"},"score":0,"creation_date":1495617820,"post_id":7342273,"comment_id":75325120,"body_markdown":"Just for fun I did a little benchmarking: I tested with a stream of 1.000.000.000 ints (JDK 8_131 64bit) on my windows machine. I got an average difference of about 500 milliseconds, that means a performance gain of 0.5 nanoseconds per operation. So be careful, using modulo will really slow down your application!  ;-)  That&#39;s a pitty, then IMHO the modulo variant is more readable.","body":"Just for fun I did a little benchmarking: I tested with a stream of 1.000.000.000 ints (JDK 8_131 64bit) on my windows machine. I got an average difference of about 500 milliseconds, that means a performance gain of 0.5 nanoseconds per operation. So be careful, using modulo will really slow down your application!  ;-)  That&#39;s a pitty, then IMHO the modulo variant is more readable."},{"owner":{"account_id":372647,"reputation":2159,"user_id":721809,"accept_rate":100,"display_name":"Matej Kormuth"},"score":0,"creation_date":1498166387,"post_id":7342273,"comment_id":76401974,"body_markdown":"JMH Benchmark: `and1: 2146187,616 ops/s  mod2: 1347458,546 ops/s`","body":"JMH Benchmark: <code>and1: 2146187,616 ops&#47;s  mod2: 1347458,546 ops&#47;s</code>"},{"owner":{"account_id":3700527,"reputation":318,"user_id":3080438,"display_name":"RaymondM"},"score":0,"creation_date":1517198484,"post_id":7342273,"comment_id":83981478,"body_markdown":"So bitwise check actually wins. i guess if the code will be shown to smart people only, then bitwise checking will be the choice since it is a programming ABC that every programmer familiar of. Otherwise, use % 2.","body":"So bitwise check actually wins. i guess if the code will be shown to smart people only, then bitwise checking will be the choice since it is a programming ABC that every programmer familiar of. Otherwise, use % 2."},{"owner":{"account_id":2147264,"reputation":1017,"user_id":1904631,"accept_rate":57,"display_name":"Sergii"},"score":0,"creation_date":1659531169,"post_id":7342273,"comment_id":129316618,"body_markdown":"How about 0 ?\nIn this case 0 would be even ( (x &amp; 1) == 0 is true ).\nIs it possible to rewrite condition so it would consider 0 odd? (Other then writing new if statement).","body":"How about 0 ? In this case 0 would be even ( (x &amp; 1) == 0 is true ). Is it possible to rewrite condition so it would consider 0 odd? (Other then writing new if statement)."},{"owner":{"account_id":1553846,"reputation":375,"user_id":1445585,"accept_rate":80,"display_name":"Meadowlark Bradsher"},"score":0,"creation_date":1670456354,"post_id":7342273,"comment_id":131882915,"body_markdown":"I like this option. Unfortunately some code reviews will punish this approach for &quot;lack of readability&quot; by people unfamiliar or forgetful of bitwise operations so there is also something to be said for doing as the Romans do.","body":"I like this option. Unfortunately some code reviews will punish this approach for &quot;lack of readability&quot; by people unfamiliar or forgetful of bitwise operations so there is also something to be said for doing as the Romans do."}],"tags":[],"owner":{"account_id":46614,"reputation":5934,"user_id":137764,"accept_rate":80,"display_name":"lucasmo"},"comment_count":22,"down_vote_count":4,"up_vote_count":238,"is_accepted":false,"score":234,"last_activity_date":1427737058,"creation_date":1315446014,"answer_id":7342273,"question_id":7342237,"body_markdown":"You can use the modulus operator, but that can be slow. If it&#39;s an integer, you can do:\r\n\r\n    if ( (x &amp; 1) == 0 ) { even... } else { odd... }\r\n\r\nThis is because the low bit will always be set on an odd number.","title":"Check whether number is even or odd","body":"<p>You can use the modulus operator, but that can be slow. If it's an integer, you can do:</p>\n\n<pre><code>if ( (x &amp; 1) == 0 ) { even... } else { odd... }\n</code></pre>\n\n<p>This is because the low bit will always be set on an odd number.</p>\n"},{"tags":[],"owner":{"account_id":5466634,"reputation":31,"user_id":4347270,"display_name":"Kiran G"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1475701006,"creation_date":1475697359,"answer_id":39882619,"question_id":7342237,"body_markdown":"Works for positive or negative numbers   \r\n    \r\n    int start = -3;\r\n    int end = 6;\r\n    \r\n    for (int val = start; val &lt; end; val++)\r\n    {\r\n        // Condition to Check Even, Not condition (!) will give Odd number\r\n        if (val % 2 == 0) \r\n        {\r\n            System.out.println(&quot;Even&quot; + val);\r\n        }\r\n        else\r\n        {\r\n            System.out.println(&quot;Odd&quot; + val);\r\n        }\r\n    }","title":"Check whether number is even or odd","body":"<p>Works for positive or negative numbers   </p>\n\n<pre><code>int start = -3;\nint end = 6;\n\nfor (int val = start; val &lt; end; val++)\n{\n    // Condition to Check Even, Not condition (!) will give Odd number\n    if (val % 2 == 0) \n    {\n        System.out.println(\"Even\" + val);\n    }\n    else\n    {\n        System.out.println(\"Odd\" + val);\n    }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":4677071,"reputation":435,"user_id":3787011,"accept_rate":86,"display_name":"Rana Talha Tariq"},"score":0,"creation_date":1508655620,"post_id":43357789,"comment_id":80689880,"body_markdown":"What is the purpose of &#39;?&#39; sign","body":"What is the purpose of &#39;?&#39; sign"}],"tags":[],"owner":{"account_id":10667392,"reputation":1,"user_id":7853499,"display_name":"Bob"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1491953048,"creation_date":1491953048,"answer_id":43357789,"question_id":7342237,"body_markdown":"    package isevenodd;\r\n    import java.util.Scanner;\r\n    public class IsEvenOdd {\r\n        public static void main(String[] args) {\r\n            Scanner scan = new Scanner(System.in);\r\n            System.out.println(&quot;Enter number: &quot;);\r\n            int y = scan.nextInt();       \r\n            boolean isEven = (y % 2 == 0) ? true : false;\r\n            String x = (isEven) ? &quot;even&quot; : &quot;odd&quot;;  \r\n            System.out.println(&quot;Your number is &quot; + x);\r\n        }\r\n    }","title":"Check whether number is even or odd","body":"<pre><code>package isevenodd;\nimport java.util.Scanner;\npublic class IsEvenOdd {\n    public static void main(String[] args) {\n        Scanner scan = new Scanner(System.in);\n        System.out.println(\"Enter number: \");\n        int y = scan.nextInt();       \n        boolean isEven = (y % 2 == 0) ? true : false;\n        String x = (isEven) ? \"even\" : \"odd\";  \n        System.out.println(\"Your number is \" + x);\n    }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":11932407,"reputation":701,"user_id":8914959,"display_name":"Mark"},"score":1,"creation_date":1512406146,"post_id":43717562,"comment_id":82234431,"body_markdown":"This question was tagged as JAVA. You posted an answer in Python. Not that useful really.","body":"This question was tagged as JAVA. You posted an answer in Python. Not that useful really."},{"owner":{"account_id":5376896,"reputation":758,"user_id":5014339,"display_name":"Aseem Yadav"},"score":0,"creation_date":1513002608,"post_id":43717562,"comment_id":82470788,"body_markdown":"Hey @Mark ! Thanks for pointing that out, edited the answer. Hope, it can still be of any help to someone this time.","body":"Hey @Mark ! Thanks for pointing that out, edited the answer. Hope, it can still be of any help to someone this time."},{"owner":{"account_id":6383695,"reputation":5206,"user_id":4952262,"accept_rate":71,"display_name":"Michu93"},"score":1,"creation_date":1535023828,"post_id":43717562,"comment_id":90918881,"body_markdown":"It can be easily crashed for example by: `int n = -3;`. As @Camilo mentioned below - when the remainder operation return a nonzero result, it has the same sign as its left operand so generelly we have `System.out.println(messages.get(-1));` what gives us `java.lang.ArrayIndexOutOfBoundsException`","body":"It can be easily crashed for example by: <code>int n = -3;</code>. As @Camilo mentioned below - when the remainder operation return a nonzero result, it has the same sign as its left operand so generelly we have <code>System.out.println(messages.get(-1));</code> what gives us <code>java.lang.ArrayIndexOutOfBoundsException</code>"}],"tags":[],"owner":{"account_id":5376896,"reputation":758,"user_id":5014339,"display_name":"Aseem Yadav"},"comment_count":3,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1535040785,"creation_date":1493634063,"answer_id":43717562,"question_id":7342237,"body_markdown":"Another easy way to do it without using if/else condition (works for both positive and negative numbers):\r\n\r\n    int n = 8;\r\n    List&lt;String&gt; messages = Arrays.asList(&quot;even&quot;, &quot;odd&quot;);\r\n    \r\n    System.out.println(messages.get(Math.abs(n%2)));\r\nFor an Odd no., the expression will return &#39;1&#39; as remainder, giving\r\n\r\n&gt; messages.get(1) = &#39;odd&#39; and hence printing &#39;odd&#39;\r\n\r\nelse, &#39;even&#39; is printed when the expression comes up with result &#39;0&#39;\r\n\r\n\r\n\r\n","title":"Check whether number is even or odd","body":"<p>Another easy way to do it without using if/else condition (works for both positive and negative numbers):</p>\n\n<pre><code>int n = 8;\nList&lt;String&gt; messages = Arrays.asList(\"even\", \"odd\");\n\nSystem.out.println(messages.get(Math.abs(n%2)));\n</code></pre>\n\n<p>For an Odd no., the expression will return '1' as remainder, giving</p>\n\n<blockquote>\n  <p>messages.get(1) = 'odd' and hence printing 'odd'</p>\n</blockquote>\n\n<p>else, 'even' is printed when the expression comes up with result '0'</p>\n"},{"tags":[],"owner":{"account_id":11593971,"reputation":11,"user_id":8493261,"display_name":"Slap Chukandar Singh"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1503294051,"creation_date":1503294051,"answer_id":45789981,"question_id":7342237,"body_markdown":"You can use the modulus operator, but that can be slow. A more efficient way would be to check the lowest bit because that determines whether a number is even or odd. The code would look something like this:\r\n\r\n    public static void main(String[] args) {        \r\n        System.out.println(&quot;Enter a number to check if it is even or odd&quot;);        \r\n        System.out.println(&quot;Your number is &quot; + (((new Scanner(System.in).nextInt() &amp; 1) == 0) ? &quot;even&quot; : &quot;odd&quot;));        \r\n    }\r\n\r\n","title":"Check whether number is even or odd","body":"<p>You can use the modulus operator, but that can be slow. A more efficient way would be to check the lowest bit because that determines whether a number is even or odd. The code would look something like this:</p>\n\n<pre><code>public static void main(String[] args) {        \n    System.out.println(\"Enter a number to check if it is even or odd\");        \n    System.out.println(\"Your number is \" + (((new Scanner(System.in).nextInt() &amp; 1) == 0) ? \"even\" : \"odd\"));        \n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9591825,"reputation":37,"user_id":8180066,"display_name":"Titus Roby K"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1566849222,"creation_date":1520934089,"answer_id":49252788,"question_id":7342237,"body_markdown":"This following program can handle large numbers ( number of digits greater than 20 )\r\n\r\n    package com.isEven.java;\r\n    import java.util.Scanner;\r\n\r\n    public class isEvenValuate{\r\n\t\r\n    public static void main(String[] args) {\t\t\t\r\n\t\t\t\r\n\t\t\tScanner in = new Scanner(System.in);\r\n\t\t\tString digit = in.next();\r\n\t\t\t\r\n\t\t\tint y = Character.getNumericValue(digit.charAt(digit.length()-1));\r\n\t\t\t\r\n\t\t\tboolean isEven = (y&amp;1)==0;\r\n\t\t\t\r\n\t\t\tif(isEven)\r\n\t\t\t\tSystem.out.println(&quot;Even&quot;);\r\n\t\t\telse\r\n\t\t\t\tSystem.out.println(&quot;Odd&quot;);\r\n\r\n\t    }\r\n    }\r\n\r\nHere is the output ::\r\n\r\n      122873215981652362153862153872138721637272\r\n      Even\r\n","title":"Check whether number is even or odd","body":"<p>This following program can handle large numbers ( number of digits greater than 20 )</p>\n\n<pre><code>package com.isEven.java;\nimport java.util.Scanner;\n\npublic class isEvenValuate{\n\npublic static void main(String[] args) {            \n\n        Scanner in = new Scanner(System.in);\n        String digit = in.next();\n\n        int y = Character.getNumericValue(digit.charAt(digit.length()-1));\n\n        boolean isEven = (y&amp;1)==0;\n\n        if(isEven)\n            System.out.println(\"Even\");\n        else\n            System.out.println(\"Odd\");\n\n    }\n}\n</code></pre>\n\n<p>Here is the output ::</p>\n\n<pre><code>  122873215981652362153862153872138721637272\n  Even\n</code></pre>\n"},{"comments":[{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1525065409,"post_id":50094061,"comment_id":87204655,"body_markdown":"It is called the [remainder operator](http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.17.3), not the modulo operator.","body":"It is called the <a href=\"http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.17.3\" rel=\"nofollow noreferrer\">remainder operator</a>, not the modulo operator."}],"tags":[],"owner":{"account_id":8315755,"reputation":449,"user_id":6249116,"accept_rate":10,"display_name":"Camilo"},"comment_count":1,"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1531576419,"creation_date":1525063237,"answer_id":50094061,"question_id":7342237,"body_markdown":"You can do like this:\r\n\r\n    boolean is_odd(int n) {\r\n        return n % 2 == 1 || n % 2 == -1;\r\n    }\r\n\r\nThis is because Java has in its modulo operation the sign of the dividend, the left side: n.\r\nSo for negatives and positives dividends, the modulo has the sign of them.\r\n\r\nOf course, the bitwise operation is faster and optimized, simply document the line of code with two or three short words, which does it for readability.","title":"Check whether number is even or odd","body":"<p>You can do like this:</p>\n\n<pre><code>boolean is_odd(int n) {\n    return n % 2 == 1 || n % 2 == -1;\n}\n</code></pre>\n\n<p>This is because Java has in its modulo operation the sign of the dividend, the left side: n.\nSo for negatives and positives dividends, the modulo has the sign of them.</p>\n\n<p>Of course, the bitwise operation is faster and optimized, simply document the line of code with two or three short words, which does it for readability.</p>\n"},{"tags":[],"owner":{"account_id":1079267,"reputation":776,"user_id":1076703,"display_name":"Vipul Gulhane"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1531577650,"creation_date":1531577650,"answer_id":51340310,"question_id":7342237,"body_markdown":"Here is full example:-\r\n\r\n    import java.text.ParseException;\r\n    \r\n    public class TestOddEvenExample {\r\n    \tpublic static void main(String args[]) throws ParseException {\r\n    \r\n    \t\tint x = 24;\r\n    \t\toddEvenChecker(x);\r\n    \r\n    \t\tint xx = 3;\r\n    \t\toddEvenChecker(xx);\r\n    \t}\r\n    \r\n    \tstatic void oddEvenChecker(int x) {\r\n    \t\tif (x % 2 == 0)\r\n    \t\t\tSystem.out.println(&quot;You entered an even number.&quot; + x);\r\n    \t\telse\r\n    \t\t\tSystem.out.println(&quot;You entered an odd number.&quot; + x);\r\n    \t}\r\n    }\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/fWAqv.png","title":"Check whether number is even or odd","body":"<p>Here is full example:-</p>\n\n<pre><code>import java.text.ParseException;\n\npublic class TestOddEvenExample {\n    public static void main(String args[]) throws ParseException {\n\n        int x = 24;\n        oddEvenChecker(x);\n\n        int xx = 3;\n        oddEvenChecker(xx);\n    }\n\n    static void oddEvenChecker(int x) {\n        if (x % 2 == 0)\n            System.out.println(\"You entered an even number.\" + x);\n        else\n            System.out.println(\"You entered an odd number.\" + x);\n    }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fWAqv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fWAqv.png\" alt=\"enter image description here\"></a></p>\n"},{"tags":[],"owner":{"account_id":6383695,"reputation":5206,"user_id":4952262,"accept_rate":71,"display_name":"Michu93"},"comment_count":0,"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1548539650,"creation_date":1535092741,"answer_id":51998794,"question_id":7342237,"body_markdown":"I would recommend \r\n\r\n&gt; Java Puzzlers: Traps, Pitfalls, and Corner Cases Book by Joshua Bloch\r\n&gt; and Neal Gafter\r\n\r\nThere is a briefly explanation how to check if number is odd.\r\nFirst try is something similar what @AseemYadav tried:\r\n\r\n    public static boolean isOdd(int i) {\r\n         return i % 2 == 1;\r\n    }\r\n\r\nbut as was mentioned in book: \r\n\r\n&gt; when the remainder operation returns a nonzero result, it has the same\r\n&gt; sign as its left operand\r\n\r\nso generally when we have negative odd number then instead of `1` we&#39;ll get `-1` as result of `i%2`. So we can use @Camilo solution or just do:\r\n\r\n    public static boolean isOdd(int i) {\r\n         return i % 2 != 0;\r\n    }\r\n\r\nbut generally the fastest solution is using AND operator like @lucasmo write above:\r\n\r\n    public static boolean isOdd(int i) {\r\n         return (i &amp; 1) != 0;\r\n    }\r\n\r\n@Edit\r\nIt also worth to point `Math.floorMod(int x, int y);` which deals good with negative the dividend but also can return `-1` if the divisor is negative","title":"Check whether number is even or odd","body":"<p>I would recommend </p>\n\n<blockquote>\n  <p>Java Puzzlers: Traps, Pitfalls, and Corner Cases Book by Joshua Bloch\n  and Neal Gafter</p>\n</blockquote>\n\n<p>There is a briefly explanation how to check if number is odd.\nFirst try is something similar what @AseemYadav tried:</p>\n\n<pre><code>public static boolean isOdd(int i) {\n     return i % 2 == 1;\n}\n</code></pre>\n\n<p>but as was mentioned in book: </p>\n\n<blockquote>\n  <p>when the remainder operation returns a nonzero result, it has the same\n  sign as its left operand</p>\n</blockquote>\n\n<p>so generally when we have negative odd number then instead of <code>1</code> we'll get <code>-1</code> as result of <code>i%2</code>. So we can use @Camilo solution or just do:</p>\n\n<pre><code>public static boolean isOdd(int i) {\n     return i % 2 != 0;\n}\n</code></pre>\n\n<p>but generally the fastest solution is using AND operator like @lucasmo write above:</p>\n\n<pre><code>public static boolean isOdd(int i) {\n     return (i &amp; 1) != 0;\n}\n</code></pre>\n\n<p>@Edit\nIt also worth to point <code>Math.floorMod(int x, int y);</code> which deals good with negative the dividend but also can return <code>-1</code> if the divisor is negative</p>\n"},{"tags":[],"owner":{"display_name":"user10544847"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1540281664,"creation_date":1540281664,"answer_id":52943992,"question_id":7342237,"body_markdown":"Least significant bit (rightmost) can be used to check if the number is even or odd.\r\nFor all Odd numbers, rightmost bit is always 1 in binary representation.\r\n\r\n    public static boolean checkOdd(long number){\r\n       return ((number &amp; 0x1) == 1);\r\n    }","title":"Check whether number is even or odd","body":"<p>Least significant bit (rightmost) can be used to check if the number is even or odd.\nFor all Odd numbers, rightmost bit is always 1 in binary representation.</p>\n\n<pre><code>public static boolean checkOdd(long number){\n   return ((number &amp; 0x1) == 1);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":8761211,"reputation":149,"user_id":6552341,"display_name":"corneliouz Bett"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1565718041,"creation_date":1565718041,"answer_id":57482837,"question_id":7342237,"body_markdown":"If the modulus of the given number is equal to zero, the number is even else odd number. Below is the method that does that:\r\n\r\n    public void evenOrOddNumber(int number) {\r\n      if (number % 2 == 0) {\r\n        System.out.println(&quot;Number is Even&quot;);\r\n       } else {\r\n        System.out.println(&quot;Number is odd&quot;);\r\n      }\r\n     }","title":"Check whether number is even or odd","body":"<p>If the modulus of the given number is equal to zero, the number is even else odd number. Below is the method that does that:</p>\n\n<pre><code>public void evenOrOddNumber(int number) {\n  if (number % 2 == 0) {\n    System.out.println(\"Number is Even\");\n   } else {\n    System.out.println(\"Number is odd\");\n  }\n }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":12511931,"reputation":3963,"user_id":9106684,"display_name":"duyuanchao"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1601315333,"creation_date":1601315333,"answer_id":64107144,"question_id":7342237,"body_markdown":"``` java\r\n    /**\r\n     * Check if a number is even or not using modulus operator.\r\n     *\r\n     * @param number the number to be checked.\r\n     * @return {@code true} if the given number is even, otherwise {@code false}.\r\n     */\r\n    public static boolean isEven(int number) {\r\n        return number % 2 == 0;\r\n    }\r\n\r\n    /**\r\n     * Check if a number is even or not using &amp; operator.\r\n     *\r\n     * @param number the number to be checked.\r\n     * @return {@code true} if the given number is even, otherwise {@code false}.\r\n     */\r\n    public static boolean isEvenFaster(int number) {\r\n        return (number &amp; 1) == 0;\r\n    }\r\n```\r\n[source](https://github.com/examplehub/Java/blob/master/src/main/java/com/examplehub/maths/EvenCheck.java)","title":"Check whether number is even or odd","body":"<pre class=\"lang-java prettyprint-override\"><code>    /**\n     * Check if a number is even or not using modulus operator.\n     *\n     * @param number the number to be checked.\n     * @return {@code true} if the given number is even, otherwise {@code false}.\n     */\n    public static boolean isEven(int number) {\n        return number % 2 == 0;\n    }\n\n    /**\n     * Check if a number is even or not using &amp; operator.\n     *\n     * @param number the number to be checked.\n     * @return {@code true} if the given number is even, otherwise {@code false}.\n     */\n    public static boolean isEvenFaster(int number) {\n        return (number &amp; 1) == 0;\n    }\n</code></pre>\n<p><a href=\"https://github.com/examplehub/Java/blob/master/src/main/java/com/examplehub/maths/EvenCheck.java\" rel=\"nofollow noreferrer\">source</a></p>\n"},{"tags":[],"owner":{"account_id":6965335,"reputation":65,"user_id":5367626,"display_name":"Alejandro Kolio"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700045688,"creation_date":1700045688,"answer_id":77487125,"question_id":7342237,"body_markdown":"    if ((x &amp; 1) == 0) {\r\n       // even\r\n    } else {\r\n       // odd\r\n    }\r\n\r\n    or\r\n    \r\n    if ((x % 2) == 0) {\r\n       // even\r\n    } else {\r\n       // odd\r\n    }\r\n\r\nPros:\r\n\r\nPerformance: Bitwise operations are usually faster than arithmetic operations like modulo. This is because they are performed directly on the binary representation of the number, which is a more efficient process at the hardware level. The behavior of bitwise operations is consistent across different programming languages and platforms.\r\n\r\nCons:\r\n\r\nReadability: For those not familiar with bitwise operations, this method might be less intuitive. It requires understanding how numbers are represented in binary form and how bitwise operations work.","title":"Check whether number is even or odd","body":"<pre><code>if ((x &amp; 1) == 0) {\n   // even\n} else {\n   // odd\n}\n\nor\n\nif ((x % 2) == 0) {\n   // even\n} else {\n   // odd\n}\n</code></pre>\n<p>Pros:</p>\n<p>Performance: Bitwise operations are usually faster than arithmetic operations like modulo. This is because they are performed directly on the binary representation of the number, which is a more efficient process at the hardware level. The behavior of bitwise operations is consistent across different programming languages and platforms.</p>\n<p>Cons:</p>\n<p>Readability: For those not familiar with bitwise operations, this method might be less intuitive. It requires understanding how numbers are represented in binary form and how bitwise operations work.</p>\n"}],"owner":{"account_id":896807,"reputation":1649,"user_id":933878,"display_name":"Josh"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":537196,"favorite_count":0,"down_vote_count":7,"up_vote_count":166,"answer_count":17,"score":159,"last_activity_date":1700045688,"creation_date":1315445714,"question_id":7342237,"body_markdown":"How would I determine whether a given number is even or odd? I&#39;ve been wanting to figure this out for a long time now and haven&#39;t gotten anywhere.","title":"Check whether number is even or odd","body":"<p>How would I determine whether a given number is even or odd? I've been wanting to figure this out for a long time now and haven't gotten anywhere.</p>\n"},{"tags":["java","algorithm","puzzle"],"comments":[{"owner":{"account_id":2373933,"reputation":1989,"user_id":2077834,"display_name":"Gunjan Juyal"},"score":1,"creation_date":1396439984,"post_id":4703047,"comment_id":34786641,"body_markdown":"Your solution is O(N^2). You can do it in linear time instead of square using the following logic:\n1. Keep a running sum of odds/evens encountered\n2. For each odd number, additional pairs = number of odds encountered till now.\n\n\tpublic int findPairSumCount(int[] input) {\n\t\tint totPairsFoundTillNow = 0;\n\t\tint oddNosFound = 0, evenNosFound = 0;\n\n\t\tfor (int i = 0; i &lt; input.length; i++) {\n\t\t\tif (input[i] % 2 == 0) {\n\t\t\t\ttotPairsFoundTillNow += evenNosFound;\n\t\t\t\tevenNosFound++;\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttotPairsFoundTillNow += oddNosFound;\n\t\t\t\toddNosFound++;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn totPairsFoundTillNow;\n\t}","body":"Your solution is O(N^2). You can do it in linear time instead of square using the following logic: 1. Keep a running sum of odds/evens encountered 2. For each odd number, additional pairs = number of odds encountered till now.  \tpublic int findPairSumCount(int[] input) { \t\tint totPairsFoundTillNow = 0; \t\tint oddNosFound = 0, evenNosFound = 0;  \t\tfor (int i = 0; i &lt; input.length; i++) { \t\t\tif (input[i] % 2 == 0) { \t\t\t\ttotPairsFoundTillNow += evenNosFound; \t\t\t\tevenNosFound++; \t\t\t} \t\t\telse { \t\t\t\ttotPairsFoundTillNow += oddNosFound; \t\t\t\toddNosFound++; \t\t\t} \t\t} \t\t \t\treturn totPairsFoundTillNow; \t}"}],"answers":[{"comments":[{"owner":{"account_id":34723,"reputation":1520,"user_id":98155,"accept_rate":49,"display_name":"geoaxis"},"score":0,"creation_date":1295142740,"post_id":4703214,"comment_id":5190906,"body_markdown":"I think you meant A[j] in the if condition. Where does this account for i&lt; j , can you apply the case I provided and produce an answer of 4, I can not deduce from your solution.","body":"I think you meant A[j] in the if condition. Where does this account for i&lt; j , can you apply the case I provided and produce an answer of 4, I can not deduce from your solution."},{"owner":{"account_id":113085,"reputation":18448,"user_id":298029,"display_name":"fgb"},"score":0,"creation_date":1295146278,"post_id":4703214,"comment_id":5191178,"body_markdown":"Yes, I corrected the condition. i&lt;j is enforced because odd/even only includes numbers with an index before j.","body":"Yes, I corrected the condition. i&lt;j is enforced because odd/even only includes numbers with an index before j."}],"tags":[],"owner":{"account_id":113085,"reputation":18448,"user_id":298029,"display_name":"fgb"},"comment_count":2,"down_vote_count":0,"up_vote_count":12,"is_accepted":false,"score":12,"last_activity_date":1487594184,"creation_date":1295140636,"answer_id":4703214,"question_id":4703047,"body_markdown":"You can find the sum without calculating every pair individually.\r\n\r\n`A[i]+A[j]` is even **if A[i] is even and A[j] is even**; or **A[i] is odd and A[j] is odd**.\r\n\r\nA running total of odd and even numbers up to j can be kept, and added to sum depending on whether **A[j] is odd or even**:\r\n\r\n\r\n\tint sum = 0;\r\n\r\n\tint odd = 0;\r\n\tint even = 0;\r\n\tfor(int j = 0; j &lt; A.length; j++) {\r\n\t\tif(A[j] % 2 == 0) {\r\n\t\t\tsum += even;\r\n\t\t\teven++;\r\n\t\t} else {\r\n\t\t\tsum += odd;\r\n\t\t\todd++;\r\n\t\t}\r\n\t}\r\n\r\n**Edit:**\r\n\r\nIf you look at `A={1,2,3,4,5}`, each value of j would add the number of pairs with `A[j]` as the second number.\r\n\r\n\tEven values:\r\n\tA[j]=2 - sum += 0\r\n\tA[j]=4 - sum += 1 - [2+4]\r\n\r\n\tOdd values:\r\n\tA[j]=1 - sum += 0\r\n\tA[j]=3 - sum += 1 - [1+3]\r\n\tA[j]=5 - sum += 2 - [1+5, 3+5]","title":"review of a codility test - pair_sum_even_count","body":"<p>You can find the sum without calculating every pair individually.</p>\n\n<p><code>A[i]+A[j]</code> is even <strong>if A[i] is even and A[j] is even</strong>; or <strong>A[i] is odd and A[j] is odd</strong>.</p>\n\n<p>A running total of odd and even numbers up to j can be kept, and added to sum depending on whether <strong>A[j] is odd or even</strong>:</p>\n\n<pre><code>int sum = 0;\n\nint odd = 0;\nint even = 0;\nfor(int j = 0; j &lt; A.length; j++) {\n    if(A[j] % 2 == 0) {\n        sum += even;\n        even++;\n    } else {\n        sum += odd;\n        odd++;\n    }\n}\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>If you look at <code>A={1,2,3,4,5}</code>, each value of j would add the number of pairs with <code>A[j]</code> as the second number.</p>\n\n<pre><code>Even values:\nA[j]=2 - sum += 0\nA[j]=4 - sum += 1 - [2+4]\n\nOdd values:\nA[j]=1 - sum += 0\nA[j]=3 - sum += 1 - [1+3]\nA[j]=5 - sum += 2 - [1+5, 3+5]\n</code></pre>\n"},{"tags":[],"owner":{"account_id":15120,"reputation":50844,"user_id":31615,"display_name":"Svante"},"comment_count":0,"down_vote_count":0,"up_vote_count":32,"is_accepted":true,"score":32,"last_activity_date":1295144653,"creation_date":1295144653,"answer_id":4703443,"question_id":4703047,"body_markdown":"The sum of two integers is even if and only if they are either both even or both odd.  You can simply go through the array and count evens and odds.  The number of possibilities to combine k numbers from a set of size _N_ is _N! / ((N - k)! &amp;middot; k!)_.  You just need to put the number of evens/odds as _N_ and 2 as _k_.  For this, the above simplifies to _(N &amp;middot; (N - 1)) / 2_.  All the condition `i &lt; j` does is to specify that each combination counts only once.\r\n","title":"review of a codility test - pair_sum_even_count","body":"<p>The sum of two integers is even if and only if they are either both even or both odd.  You can simply go through the array and count evens and odds.  The number of possibilities to combine k numbers from a set of size <em>N</em> is <em>N! / ((N - k)! &middot; k!)</em>.  You just need to put the number of evens/odds as <em>N</em> and 2 as <em>k</em>.  For this, the above simplifies to <em>(N &middot; (N - 1)) / 2</em>.  All the condition <code>i &lt; j</code> does is to specify that each combination counts only once.</p>\n"},{"comments":[{"owner":{"account_id":131043,"reputation":1129,"user_id":330754,"display_name":"Pz."},"score":0,"creation_date":1299933642,"post_id":4935657,"comment_id":5953043,"body_markdown":"I think that you could (should :)) simplify the enumeration of N!/(N-k)! * k!, since you know that k = 2. You don&#39;t need to count factorials at all, and the recursion might be also performance problem.\n\nYou might count it as N*(N-1)/2 (where N is numEven or numOdd]), as Svante correctly figured out. That&#39;s it. You might run into serious outofrange exceptions when counting bigger factorials.","body":"I think that you could (should :)) simplify the enumeration of N!/(N-k)! * k!, since you know that k = 2. You don&#39;t need to count factorials at all, and the recursion might be also performance problem.  You might count it as N*(N-1)/2 (where N is numEven or numOdd]), as Svante correctly figured out. That&#39;s it. You might run into serious outofrange exceptions when counting bigger factorials."}],"tags":[],"owner":{"account_id":195529,"reputation":2593,"user_id":438466,"display_name":"Rabi"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1297182973,"creation_date":1297182973,"answer_id":4935657,"question_id":4703047,"body_markdown":"A Java implementation that works great based on the answer by &quot;Svante&quot;:\r\n\r\n    int getNumSumsOfTwoEven(int[] a) {\r\n\r\n        long numOdd = 0;\r\n        long numEven = 0;\r\n        for(int i = 0; i &lt; a.length; i++) {\r\n            if(a[i] % 2 == 0) { //even\r\n                numOdd++;\r\n            } else {\r\n                numEven++;\r\n            }\r\n        }\r\n\r\n        //N! / ((N - k)! &#183; k!), where N = num. even nums or num odd nums, k = 2\r\n        long numSumOfTwoEven = (long)(fact(numOdd) / (fact(numOdd - 2) * 2));\r\n        numSumOfTwoEven += (long)(fact(numEven) / (fact(numEven - 2) * 2));\r\n\r\n        if(numSumOfTwoEven &gt; ((long)1e9)) {\r\n            return -1;\r\n        }\r\n        return numSumOfTwoEven;\r\n\r\n    }\r\n    // This is a recursive function to calculate factorials\r\n    long fact(int i) {\r\n        if(i == 0) {\r\n            return 1;\r\n        }\r\n        return i * fact(i-1);\r\n    }","title":"review of a codility test - pair_sum_even_count","body":"<p>A Java implementation that works great based on the answer by \"Svante\":</p>\n\n<pre><code>int getNumSumsOfTwoEven(int[] a) {\n\n    long numOdd = 0;\n    long numEven = 0;\n    for(int i = 0; i &lt; a.length; i++) {\n        if(a[i] % 2 == 0) { //even\n            numOdd++;\n        } else {\n            numEven++;\n        }\n    }\n\n    //N! / ((N - k)! · k!), where N = num. even nums or num odd nums, k = 2\n    long numSumOfTwoEven = (long)(fact(numOdd) / (fact(numOdd - 2) * 2));\n    numSumOfTwoEven += (long)(fact(numEven) / (fact(numEven - 2) * 2));\n\n    if(numSumOfTwoEven &gt; ((long)1e9)) {\n        return -1;\n    }\n    return numSumOfTwoEven;\n\n}\n// This is a recursive function to calculate factorials\nlong fact(int i) {\n    if(i == 0) {\n        return 1;\n    }\n    return i * fact(i-1);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":396764,"reputation":35,"user_id":760511,"display_name":"user760511"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1328821408,"creation_date":1308140288,"answer_id":6357558,"question_id":4703047,"body_markdown":"See this answer also\r\n\r\n    int returnNumOFOddEvenSum(int [] A){\r\n        int sumOdd=0;\r\n        int sumEven=0;\r\n\r\n        if(A.length==0)\r\n            return 0;\r\n\r\n        for(int i=0; i&lt;A.length; i++)\r\n        {\r\n            if(A[i]%2==0)\r\n                sumEven++;\r\n            else\r\n                sumOdd++;\r\n        }\r\n        return factSum(sumEven)+factSum(sumOdd);\r\n    }\r\n\r\n    int factSum(int num){\r\n        int sum=0;\r\n        for(int i=1; i&lt;=num-1; i++)\r\n        {\r\n            sum+=i;\r\n        }\r\n        return sum;\r\n    }","title":"review of a codility test - pair_sum_even_count","body":"<p>See this answer also</p>\n\n<pre><code>int returnNumOFOddEvenSum(int [] A){\n    int sumOdd=0;\n    int sumEven=0;\n\n    if(A.length==0)\n        return 0;\n\n    for(int i=0; i&lt;A.length; i++)\n    {\n        if(A[i]%2==0)\n            sumEven++;\n        else\n            sumOdd++;\n    }\n    return factSum(sumEven)+factSum(sumOdd);\n}\n\nint factSum(int num){\n    int sum=0;\n    for(int i=1; i&lt;=num-1; i++)\n    {\n        sum+=i;\n    }\n    return sum;\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":443372,"reputation":1423,"user_id":834552,"display_name":"AlexT"},"score":0,"creation_date":1445257401,"post_id":7900493,"comment_id":54232545,"body_markdown":"Please consider overflow - for 50000 elements it gives negative value. The simplest solution is to store counters and result in long datatype","body":"Please consider overflow - for 50000 elements it gives negative value. The simplest solution is to store counters and result in long datatype"}],"tags":[],"owner":{"account_id":105356,"reputation":2071,"user_id":281191,"accept_rate":0,"display_name":"goroncy"},"comment_count":1,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1319619180,"creation_date":1319618825,"answer_id":7900493,"question_id":4703047,"body_markdown":"Please check this\r\n\r\n    if (A == null || A.length &lt; 2) {\r\n      return 0;\r\n    }\r\n\r\n    int evenNumbersCount = 0;\r\n    int oddNumberCount = 0;\r\n\r\n    for (int aA : A) {\r\n      if (aA % 2 == 0) {\r\n        evenNumbersCount++;\r\n      } else {\r\n        oddNumberCount++;\r\n      }\r\n    }\r\n\r\n    int i = (evenNumbersCount * (evenNumbersCount - 1)) / 2 + (oddNumberCount * (oddNumberCount - 1)) / 2;\r\n    return i &gt; 1000000000 ? -1 : i;\r\n\r\nIf someone has a problem with understanding what Sante said here is another explanation:\r\nOnly odd+odd and even+even gives even. You have to find how many even and odd numbers are there. When you have it imagine that this as a problem with a meeting. How many people distinkt pairs are in the odd numbers list and even numbers list. This is the same problem as how many pairs will say hallo to each other at the party. This is also the number of edges in full graph. The answer is n*(n-1)/2 because there are n people, and you have to shake n-1 peoples hands and divide by 2 because the other person cant count your shake as distinct one. As you have here two separate &quot;parties&quot; going on you have to count them independently.","title":"review of a codility test - pair_sum_even_count","body":"<p>Please check this</p>\n\n<pre><code>if (A == null || A.length &lt; 2) {\n  return 0;\n}\n\nint evenNumbersCount = 0;\nint oddNumberCount = 0;\n\nfor (int aA : A) {\n  if (aA % 2 == 0) {\n    evenNumbersCount++;\n  } else {\n    oddNumberCount++;\n  }\n}\n\nint i = (evenNumbersCount * (evenNumbersCount - 1)) / 2 + (oddNumberCount * (oddNumberCount - 1)) / 2;\nreturn i &gt; 1000000000 ? -1 : i;\n</code></pre>\n\n<p>If someone has a problem with understanding what Sante said here is another explanation:\nOnly odd+odd and even+even gives even. You have to find how many even and odd numbers are there. When you have it imagine that this as a problem with a meeting. How many people distinkt pairs are in the odd numbers list and even numbers list. This is the same problem as how many pairs will say hallo to each other at the party. This is also the number of edges in full graph. The answer is n*(n-1)/2 because there are n people, and you have to shake n-1 peoples hands and divide by 2 because the other person cant count your shake as distinct one. As you have here two separate \"parties\" going on you have to count them independently.</p>\n"},{"tags":[],"owner":{"account_id":1313029,"reputation":11,"user_id":1260598,"display_name":"Mathew_Kurian"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1331388663,"creation_date":1331353685,"answer_id":9643933,"question_id":4703047,"body_markdown":"    public int getEvenSumPairs(int[] array){\r\n\r\n        int even=0;\r\n        int odd=0;\r\n        int evenSum=0;\r\n\r\n         for(int j=0; j&lt;array.length; ++j){\r\n   \r\n               if(array[j]%2==0) even++;\r\n               else odd++;\r\n         }\r\n         evenSum=((even*(even-1)/2) + (odd *(odd-1)/2) ;\r\n         return evenSum;\r\n    }","title":"review of a codility test - pair_sum_even_count","body":"<pre><code>public int getEvenSumPairs(int[] array){\n\n    int even=0;\n    int odd=0;\n    int evenSum=0;\n\n     for(int j=0; j&lt;array.length; ++j){\n\n           if(array[j]%2==0) even++;\n           else odd++;\n     }\n     evenSum=((even*(even-1)/2) + (odd *(odd-1)/2) ;\n     return evenSum;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1440212,"reputation":7,"user_id":1360581,"display_name":"Subha Roy"},"comment_count":0,"down_vote_count":2,"up_vote_count":1,"is_accepted":false,"score":-1,"last_activity_date":1335513179,"creation_date":1335513179,"answer_id":10346842,"question_id":4703047,"body_markdown":"\t\tint total = 0;\r\n\t\tint size = A.length;\r\n\t\tfor(int i=0; i &lt; size; i++) {\r\n\t\t\ttotal += (A[size-1] - A[i]) / 2;\r\n\t\t}\r\n\t\tSystem.out.println(&quot;Total : &quot; + total); ","title":"review of a codility test - pair_sum_even_count","body":"<pre><code>    int total = 0;\n    int size = A.length;\n    for(int i=0; i &lt; size; i++) {\n        total += (A[size-1] - A[i]) / 2;\n    }\n    System.out.println(\"Total : \" + total); \n</code></pre>\n"},{"tags":[],"owner":{"account_id":148524,"reputation":9330,"user_id":360362,"accept_rate":80,"display_name":"Meitham"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1377556033,"creation_date":1377556033,"answer_id":18454061,"question_id":4703047,"body_markdown":"Algorithms are boring, here is a python solution.\r\n\r\n    &gt;&gt;&gt; A = range(5)\r\n    &gt;&gt;&gt; A\r\n    [0, 1, 2, 3, 4]\r\n    &gt;&gt;&gt; even = lambda n: n % 2 == 0\r\n    &gt;&gt;&gt; [(i, j) for i in A for j in A[i+1:] if even(i+j)]\r\n    [(0, 2), (0, 4), (1, 3), (2, 4)]\r\n\r\nI will attempt another solution using vim.","title":"review of a codility test - pair_sum_even_count","body":"<p>Algorithms are boring, here is a python solution.</p>\n\n<pre><code>&gt;&gt;&gt; A = range(5)\n&gt;&gt;&gt; A\n[0, 1, 2, 3, 4]\n&gt;&gt;&gt; even = lambda n: n % 2 == 0\n&gt;&gt;&gt; [(i, j) for i in A for j in A[i+1:] if even(i+j)]\n[(0, 2), (0, 4), (1, 3), (2, 4)]\n</code></pre>\n\n<p>I will attempt another solution using vim.</p>\n"},{"tags":[],"owner":{"account_id":4896325,"reputation":41,"user_id":3945836,"display_name":"Slawomir Karczewski"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1408136048,"creation_date":1408136048,"answer_id":25334073,"question_id":4703047,"body_markdown":"It&#39;s very simple\r\nFirst you need to find the number of odds and even number in collection.\r\neg. x is odd if x&amp;1 ==1, even otherwise,\r\nif you have this, knowing that adding two even or two odds to each you get even.\r\nYou need to calc the sum of Combinations of two elements from Even numbers and Odd numbers.\r\n\r\nhaving int A[] = {1,2,3,4,5};\r\n\r\n    int odds=0, evens=0;\r\n    for (int i=0; i&lt; A.length; ++i)\r\n    {\r\n    if (A[i]&amp;1==1) odds++;\r\n    else evens++;\r\n    }\r\n    return odds*(odds-1)/2 + evens*(evens-1)/2;  \r\n\r\n// Above goes from fact that the number of possibilities to combine k numbers from a set of size N is N! / ((N - k)! &#183; k!). For k=2 this simplifies to (N &#183; (N - 1)) / 2\r\n\r\n","title":"review of a codility test - pair_sum_even_count","body":"<p>It's very simple\nFirst you need to find the number of odds and even number in collection.\neg. x is odd if x&amp;1 ==1, even otherwise,\nif you have this, knowing that adding two even or two odds to each you get even.\nYou need to calc the sum of Combinations of two elements from Even numbers and Odd numbers.</p>\n\n<p>having int A[] = {1,2,3,4,5};</p>\n\n<pre><code>int odds=0, evens=0;\nfor (int i=0; i&lt; A.length; ++i)\n{\nif (A[i]&amp;1==1) odds++;\nelse evens++;\n}\nreturn odds*(odds-1)/2 + evens*(evens-1)/2;  \n</code></pre>\n\n<p>// Above goes from fact that the number of possibilities to combine k numbers from a set of size N is N! / ((N - k)! · k!). For k=2 this simplifies to (N · (N - 1)) / 2</p>\n"},{"tags":[],"owner":{"account_id":5120276,"reputation":1,"user_id":4104094,"display_name":"msar"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1412286752,"creation_date":1412286752,"answer_id":26170226,"question_id":4703047,"body_markdown":"You can get rid of the if/else statement and just have the following:\r\n\r\n    int pair_sum_v2( int A[], int N ) {\r\n    int totals[2] = { 0, 0 };\r\n\r\n    for (int i = 0; i &lt; N; i++ ) {\r\n        totals[ A[i] &amp; 0x01 ]++;\r\n        }\r\n\r\n    return ( totals[0] * (totals[0]-1) + totals[1] * (totals[1]-1) ) / 2;\r\n    }\r\n","title":"review of a codility test - pair_sum_even_count","body":"<p>You can get rid of the if/else statement and just have the following:</p>\n\n<pre><code>int pair_sum_v2( int A[], int N ) {\nint totals[2] = { 0, 0 };\n\nfor (int i = 0; i &lt; N; i++ ) {\n    totals[ A[i] &amp; 0x01 ]++;\n    }\n\nreturn ( totals[0] * (totals[0]-1) + totals[1] * (totals[1]-1) ) / 2;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":5607989,"reputation":1,"user_id":4441813,"display_name":"Shahbaz Alam"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1453364123,"creation_date":1453360239,"answer_id":34917449,"question_id":4703047,"body_markdown":"Let count odd numbers as *n1* and count even numbers as *n2*.\r\n\r\nThe sum of `Pair(x,y)` is even, only if we choose both `x` and `y` from the set of even numbers or both `x` and `y` from odd set (selecting `x` from even set and `y` from odd set or vice-versa will always result in the pair&#39;s sum to be an odd number).\r\n \r\nSo total combination such that each pair&#39;s sum is even = `n1C2 + n2C2`.  \r\n\r\n    = (n1!) / ((n1-2)! * 2!) + (n2!) / ((n2-2)! * 2!)  \r\n    = (n1 * (n1 - 1)) / 2 + (n2 * (n2 - 1)) / 2 \r\n\r\n--- Equation 1.  \r\ne.g :  let the array be like: `{1,2,3,4,5}`  \r\nnumber of even numbers = *n1* = 2  \r\nnumber of odd numbers = *n2* = 2\r\n\r\nTotal pair such that the pair&#39;s sum is even from equation: `1 = (2*1)/2 + (3*2)/2 = 4`\r\nand the pairs are: `(1,3), (1,5), (2,4), (3,5)`.  \r\nGoing by traditional approach of adding and then checking might result in an integer overflow in programming on both positive as well as on negative extremes.","title":"review of a codility test - pair_sum_even_count","body":"<p>Let count odd numbers as <em>n1</em> and count even numbers as <em>n2</em>.</p>\n\n<p>The sum of <code>Pair(x,y)</code> is even, only if we choose both <code>x</code> and <code>y</code> from the set of even numbers or both <code>x</code> and <code>y</code> from odd set (selecting <code>x</code> from even set and <code>y</code> from odd set or vice-versa will always result in the pair's sum to be an odd number).</p>\n\n<p>So total combination such that each pair's sum is even = <code>n1C2 + n2C2</code>.  </p>\n\n<pre><code>= (n1!) / ((n1-2)! * 2!) + (n2!) / ((n2-2)! * 2!)  \n= (n1 * (n1 - 1)) / 2 + (n2 * (n2 - 1)) / 2 \n</code></pre>\n\n<p>--- Equation 1.<br>\ne.g :  let the array be like: <code>{1,2,3,4,5}</code><br>\nnumber of even numbers = <em>n1</em> = 2<br>\nnumber of odd numbers = <em>n2</em> = 2</p>\n\n<p>Total pair such that the pair's sum is even from equation: <code>1 = (2*1)/2 + (3*2)/2 = 4</code>\nand the pairs are: <code>(1,3), (1,5), (2,4), (3,5)</code>.<br>\nGoing by traditional approach of adding and then checking might result in an integer overflow in programming on both positive as well as on negative extremes.</p>\n"},{"tags":[],"owner":{"account_id":14807415,"reputation":1,"user_id":10693951,"display_name":"Emeka"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1542950131,"creation_date":1542950131,"answer_id":53440963,"question_id":4703047,"body_markdown":"This is some pythonic solution\r\n\r\n    x = [1,3,56,4,3,2,0,6,78,90]\r\n\r\n    def solution(x):\r\n        sumadjacent = [x[i]+x[i+1] for i in range(len(x)-1) if x[i] &lt; x[i+1]]\r\n        evenpairslist = [ True for j in sumadjacent if j%2==0]\r\n        return evenpairslist\r\n\r\n    if __name__==&quot;__main__&quot;:\r\n        result=solution(x)\r\n        print(len(result))","title":"review of a codility test - pair_sum_even_count","body":"<p>This is some pythonic solution</p>\n\n<pre><code>x = [1,3,56,4,3,2,0,6,78,90]\n\ndef solution(x):\n    sumadjacent = [x[i]+x[i+1] for i in range(len(x)-1) if x[i] &lt; x[i+1]]\n    evenpairslist = [ True for j in sumadjacent if j%2==0]\n    return evenpairslist\n\nif __name__==\"__main__\":\n    result=solution(x)\n    print(len(result))\n</code></pre>\n"},{"tags":[],"owner":{"account_id":29908223,"reputation":1,"user_id":22920269,"display_name":"Sini Gireesh"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700045296,"creation_date":1700045296,"answer_id":77487088,"question_id":4703047,"body_markdown":"In C# language,\r\n\r\n     public static int findEvenPair(int[] a)\r\n     {\r\n         int odd = 0;\r\n         int even = 0;\r\n         for (int i = 0;i&lt;=a.Length;i++)\r\n         {\r\n             for (int j = 0; j &lt;= a.Length - 1; j++)\r\n             {\r\n                 if (i&lt;j)\r\n                 {\r\n                   \r\n                     int sum = a[i] + a[j];\r\n                     if (sum % 2 == 0)\r\n                         even++;\r\n                     else\r\n                         odd++;\r\n                 }\r\n             }\r\n\r\n         }\r\n             return even;\r\n     }","title":"review of a codility test - pair_sum_even_count","body":"<p>In C# language,</p>\n<pre><code> public static int findEvenPair(int[] a)\n {\n     int odd = 0;\n     int even = 0;\n     for (int i = 0;i&lt;=a.Length;i++)\n     {\n         for (int j = 0; j &lt;= a.Length - 1; j++)\n         {\n             if (i&lt;j)\n             {\n               \n                 int sum = a[i] + a[j];\n                 if (sum % 2 == 0)\n                     even++;\n                 else\n                     odd++;\n             }\n         }\n\n     }\n         return even;\n }\n</code></pre>\n"}],"owner":{"account_id":34723,"reputation":1520,"user_id":98155,"accept_rate":49,"display_name":"geoaxis"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":36938,"favorite_count":0,"down_vote_count":0,"up_vote_count":11,"accepted_answer_id":4703443,"answer_count":13,"score":11,"last_activity_date":1700045296,"creation_date":1295138021,"question_id":4703047,"body_markdown":"I recently took an online test on codility as part of a recruitment process. I was given two simple problems to solve in 1 hour. For those who don&#39;t know codility, its an online coding test site where you can solve ACM style problems in many different languages.\r\n\r\nIf you have 30 or so mins then check this http://codility.com/demo/run/\r\n\r\nMy weapon of choice is usually Java.\r\n\r\nSo, one of the problems I have is as follows (I will try to remember, should have taken a screenshot)\r\n\r\nLets say you have array A[0]=1 A[1]=-1 ....A[n]=x\r\n\r\nThen what would be the smartest way to find out the number of times when A[i]+A[j] is even where i &lt; j\r\n\r\nSo if we have {1,2,3,4,5}\r\nwe have 1+3 1+5 2+4 3+5 = 4 pairs which are even\r\n\r\nThe code I wrote was some thing along the lines \r\n\r\n    int sum=0;\r\n    for(int i=0;i&lt;A.length-1;i++){\r\n     for (int j=i+1;j&lt;A.length;j++){\r\n       if( ((A[i]+A[j])%2) == 0 &amp;&amp; i&lt;j) {\r\n           sum++;\r\n        }\r\n      }\r\n    }\r\n\r\nThere was one more restriction that if the number of pairs is greater than 1e9 then it should retrun -1, but lets forget it.\r\n\r\nCan you suggest a better solution for this. The number of elements won&#39;t exceed 1e9 in normal cases.\r\n\r\nI think I got 27 points deducted for the above code (ie it&#39;s not perfect). Codility gives out a detailed assessment of what went wrong, I don&#39;t have that right now.\r\n       \r\n","title":"review of a codility test - pair_sum_even_count","body":"<p>I recently took an online test on codility as part of a recruitment process. I was given two simple problems to solve in 1 hour. For those who don't know codility, its an online coding test site where you can solve ACM style problems in many different languages.</p>\n\n<p>If you have 30 or so mins then check this <a href=\"http://codility.com/demo/run/\" rel=\"noreferrer\">http://codility.com/demo/run/</a></p>\n\n<p>My weapon of choice is usually Java.</p>\n\n<p>So, one of the problems I have is as follows (I will try to remember, should have taken a screenshot)</p>\n\n<p>Lets say you have array A[0]=1 A[1]=-1 ....A[n]=x</p>\n\n<p>Then what would be the smartest way to find out the number of times when A[i]+A[j] is even where i &lt; j</p>\n\n<p>So if we have {1,2,3,4,5}\nwe have 1+3 1+5 2+4 3+5 = 4 pairs which are even</p>\n\n<p>The code I wrote was some thing along the lines </p>\n\n<pre><code>int sum=0;\nfor(int i=0;i&lt;A.length-1;i++){\n for (int j=i+1;j&lt;A.length;j++){\n   if( ((A[i]+A[j])%2) == 0 &amp;&amp; i&lt;j) {\n       sum++;\n    }\n  }\n}\n</code></pre>\n\n<p>There was one more restriction that if the number of pairs is greater than 1e9 then it should retrun -1, but lets forget it.</p>\n\n<p>Can you suggest a better solution for this. The number of elements won't exceed 1e9 in normal cases.</p>\n\n<p>I think I got 27 points deducted for the above code (ie it's not perfect). Codility gives out a detailed assessment of what went wrong, I don't have that right now.</p>\n"},{"tags":["java","html","url","uri","query-string"],"comments":[{"owner":{"account_id":62355,"reputation":12202,"user_id":185322,"accept_rate":67,"display_name":"martinez314"},"score":1,"creation_date":1403294942,"post_id":24334436,"comment_id":37618815,"body_markdown":"Fails how?  Can you give an example of the URI string?","body":"Fails how?  Can you give an example of the URI string?"},{"owner":{"account_id":44852,"reputation":322224,"user_id":131872,"accept_rate":100,"display_name":"camickr"},"score":1,"creation_date":1403295191,"post_id":24334436,"comment_id":37618918,"body_markdown":"Works fine for me using JDK7 on Windows 7. Download and run the demo code from [How to Integrate with the Desktop Class](http://docs.oracle.com/javase/tutorial/uiswing/misc/desktop.html) and paste your URI into the demo for a test. Post your [SSCCE](http://sscce.org/) that demonstrates how you are testing your code and how you build the URI if you still need more help.","body":"Works fine for me using JDK7 on Windows 7. Download and run the demo code from <a href=\"http://docs.oracle.com/javase/tutorial/uiswing/misc/desktop.html\" rel=\"nofollow noreferrer\">How to Integrate with the Desktop Class</a> and paste your URI into the demo for a test. Post your <a href=\"http://sscce.org/\" rel=\"nofollow noreferrer\">SSCCE</a> that demonstrates how you are testing your code and how you build the URI if you still need more help."},{"owner":{"account_id":44852,"reputation":322224,"user_id":131872,"accept_rate":100,"display_name":"camickr"},"score":0,"creation_date":1403298705,"post_id":24334436,"comment_id":37620281,"body_markdown":"Did you look at the code from the tutorial? The code just accepts a string for the URI. Did you try that for your program? Did you print out the toString() representation to compare a hardcoded string with a generated String? Post your SSCCE that demonstrates the problem using a URI that we can access on the web. The code you provided doesn&#39;t tell us anything. We have no idea what programPath is.","body":"Did you look at the code from the tutorial? The code just accepts a string for the URI. Did you try that for your program? Did you print out the toString() representation to compare a hardcoded string with a generated String? Post your SSCCE that demonstrates the problem using a URI that we can access on the web. The code you provided doesn&#39;t tell us anything. We have no idea what programPath is."},{"owner":{"account_id":211735,"reputation":9951,"user_id":1202394,"accept_rate":88,"display_name":"smuggledPancakes"},"score":0,"creation_date":1403298906,"post_id":24334436,"comment_id":37620369,"body_markdown":"It is a local path on my computer, the program is an offline desktop application.","body":"It is a local path on my computer, the program is an offline desktop application."},{"owner":{"account_id":44852,"reputation":322224,"user_id":131872,"accept_rate":100,"display_name":"camickr"},"score":1,"creation_date":1403299978,"post_id":24334436,"comment_id":37620814,"body_markdown":"I don&#39;t think a file URI supports a query string. I thought that was only for an HTTP URI. The query string is handled by the HTTP server, so unless you are running a server on your computer I don&#39;t think is will work. If you want to pass the version number then you need to build that into your file name, maybe by having a directory structure for each version. Again post your SSCCE that shows how the code works for a hardcoded URI.","body":"I don&#39;t think a file URI supports a query string. I thought that was only for an HTTP URI. The query string is handled by the HTTP server, so unless you are running a server on your computer I don&#39;t think is will work. If you want to pass the version number then you need to build that into your file name, maybe by having a directory structure for each version. Again post your SSCCE that shows how the code works for a hardcoded URI."},{"owner":{"account_id":935202,"reputation":49046,"user_id":964243,"accept_rate":66,"display_name":"Boann"},"score":1,"creation_date":1403352039,"post_id":24334436,"comment_id":37630547,"body_markdown":"Could you put the version variable in a hashbang fragment instead of the query? Since you have to handle it with JavaScript anyway, it is just as useful.","body":"Could you put the version variable in a hashbang fragment instead of the query? Since you have to handle it with JavaScript anyway, it is just as useful."},{"owner":{"account_id":211735,"reputation":9951,"user_id":1202394,"accept_rate":88,"display_name":"smuggledPancakes"},"score":0,"creation_date":1403445811,"post_id":24334436,"comment_id":37651559,"body_markdown":"I am not even sure what a hashbag fragment is. I am guessing that you are referring to the fragment parameter in the URI class. It appears after the pound sign... I will have to try that when I have a chance at work tomorrow.","body":"I am not even sure what a hashbag fragment is. I am guessing that you are referring to the fragment parameter in the URI class. It appears after the pound sign... I will have to try that when I have a chance at work tomorrow."}],"answers":[{"tags":[],"owner":{"account_id":211735,"reputation":9951,"user_id":1202394,"accept_rate":88,"display_name":"smuggledPancakes"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1403536610,"creation_date":1403536610,"answer_id":24369499,"question_id":24334436,"body_markdown":"Okay so I never got it working the way I wanted to, but if I use the URI constructor that just takes a string and then I feed it the path as normal which always worked and then add &quot;# + versionNumberVar&quot;; then it works! It is frustrating because it won&#39;t work with &quot;?version=&quot; + versionNumberVar but I have what I need finally. Also, those other constructors do not work for me which is surprising. Unfortunately the URI error messages are cryptic and it just says &quot;Failed to show URI&quot;.","title":"Setting a query string from Java&#39;s Desktop.getDesktop().browse(URI uri);","body":"<p>Okay so I never got it working the way I wanted to, but if I use the URI constructor that just takes a string and then I feed it the path as normal which always worked and then add \"# + versionNumberVar\"; then it works! It is frustrating because it won't work with \"?version=\" + versionNumberVar but I have what I need finally. Also, those other constructors do not work for me which is surprising. Unfortunately the URI error messages are cryptic and it just says \"Failed to show URI\".</p>\n"},{"tags":[],"owner":{"account_id":95465,"reputation":1155,"user_id":259988,"display_name":"Francois Marot"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700044673,"creation_date":1700044673,"answer_id":77487011,"question_id":24334436,"body_markdown":"I think it comes from the way windows handle (or removes) query params for local html files. It may be related to security issues... Nevertheless I had the exact same requirements as you and finally found this answer by @arcticLord: https://stackoverflow.com/a/36387920/259988\r\n\r\nYou have to introduce a temporary ","title":"Setting a query string from Java&#39;s Desktop.getDesktop().browse(URI uri);","body":"<p>I think it comes from the way windows handle (or removes) query params for local html files. It may be related to security issues... Nevertheless I had the exact same requirements as you and finally found this answer by @arcticLord: <a href=\"https://stackoverflow.com/a/36387920/259988\">https://stackoverflow.com/a/36387920/259988</a></p>\n<p>You have to introduce a temporary</p>\n"}],"owner":{"account_id":211735,"reputation":9951,"user_id":1202394,"accept_rate":88,"display_name":"smuggledPancakes"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":683,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"accepted_answer_id":24369499,"answer_count":2,"score":4,"last_activity_date":1700044673,"creation_date":1403292821,"question_id":24334436,"body_markdown":"I have tried googling but I cannot find an answer. I am writing a pure Java Desktop application. The help system launches by using the Desktop class browse function and giving it a URI. When I add a &quot;?&lt;someQueryString&gt; then the URI fails in Java. I want to pass the program version number to my offline help page in the browser, but I cannot figure out how to set a query string.\r\n\r\nI am running on RedHat 6. I am using this code:\r\n\r\n    uri = new URI(&quot;file&quot;, &quot;&quot;, programPath, &quot;version=1.0.3&quot;, &quot;&quot;);\r\n    Desktop.getDesktop().browse(uri);\r\n\r\nI get an IOException on the browse function. All it says is that &quot;Failed to show URI:&lt;full uri path&gt;&quot;\r\n\r\nIf I take that full uri path and paste it in my browser, it works. I am completely stumped by this...\r\n\r\n","title":"Setting a query string from Java&#39;s Desktop.getDesktop().browse(URI uri);","body":"<p>I have tried googling but I cannot find an answer. I am writing a pure Java Desktop application. The help system launches by using the Desktop class browse function and giving it a URI. When I add a \"? then the URI fails in Java. I want to pass the program version number to my offline help page in the browser, but I cannot figure out how to set a query string.</p>\n\n<p>I am running on RedHat 6. I am using this code:</p>\n\n<pre><code>uri = new URI(\"file\", \"\", programPath, \"version=1.0.3\", \"\");\nDesktop.getDesktop().browse(uri);\n</code></pre>\n\n<p>I get an IOException on the browse function. All it says is that \"Failed to show URI:\"</p>\n\n<p>If I take that full uri path and paste it in my browser, it works. I am completely stumped by this...</p>\n"},{"tags":["java","list"],"comments":[{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":3,"creation_date":1699878804,"post_id":77473755,"comment_id":136582187,"body_markdown":"To the person recommending &quot;Close&quot; due to being &quot;opinion-based&quot;: how can it _possibly_ be opinion-based? It either is or isn&#39;t unsafe to omit copying the list. If it is unsafe, you should be able to describe a scenario whereby the safety can be compromised. If it is safe, you should be able to prove it. Nothing opinion-based there.","body":"To the person recommending &quot;Close&quot; due to being &quot;opinion-based&quot;: how can it <i>possibly</i> be opinion-based? It either is or isn&#39;t unsafe to omit copying the list. If it is unsafe, you should be able to describe a scenario whereby the safety can be compromised. If it is safe, you should be able to prove it. Nothing opinion-based there."},{"owner":{"account_id":3273747,"reputation":20852,"user_id":2756409,"accept_rate":100,"display_name":"TylerH"},"score":0,"creation_date":1699977869,"post_id":77473755,"comment_id":136596964,"body_markdown":"Probably because you have not defined with &#39;safe&#39; means. What you consider safe someone else might consider unsafe. Until that is defined this question is a matter of opinion. It&#39;s also more than a little broad. Furthermore, what do you mean by &quot;sufficient&quot; in your first question? Sufficient for what? To compile? To run? To achieve the desired outcome? Something else?","body":"Probably because you have not defined with &#39;safe&#39; means. What you consider safe someone else might consider unsafe. Until that is defined this question is a matter of opinion. It&#39;s also more than a little broad. Furthermore, what do you mean by &quot;sufficient&quot; in your first question? Sufficient for what? To compile? To run? To achieve the desired outcome? Something else?"}],"answers":[{"comments":[{"owner":{"account_id":1881735,"reputation":7688,"user_id":1701776,"accept_rate":71,"display_name":"BambooleanLogic"},"score":8,"creation_date":1699879042,"post_id":77473887,"comment_id":136582233,"body_markdown":"The `ArrayList` used in `Arrays` is not the normal `java.util.ArrayList`, but an unrelated implementation defined inside `Arrays` itself that just happens to also be called `ArrayList`. As such, a `j.u.ArrayList` being created using an `Arrays.ArrayList` is nothing strange.","body":"The <code>ArrayList</code> used in <code>Arrays</code> is not the normal <code>java.util.ArrayList</code>, but an unrelated implementation defined inside <code>Arrays</code> itself that just happens to also be called <code>ArrayList</code>. As such, a <code>j.u.ArrayList</code> being created using an <code>Arrays.ArrayList</code> is nothing strange."}],"tags":[],"owner":{"account_id":5559246,"reputation":3573,"user_id":4409319,"accept_rate":70,"display_name":"JSelser"},"comment_count":1,"down_vote_count":3,"up_vote_count":0,"is_accepted":false,"score":-3,"last_activity_date":1699880008,"creation_date":1699878454,"answer_id":77473887,"question_id":77473755,"body_markdown":"I don&#39;t have an answer but I find the implementation of `Arrays.asList()` funny, since it also creates a list inside:\r\n\r\n```\r\n    public static &lt;T&gt; List&lt;T&gt; asList(T... a) {\r\n        return new ArrayList&lt;&gt;(a);\r\n    }\r\n```\r\n\r\nI wonder what happened, maybe its one of those: &quot;this only applies to certain VMs so cant be guaranteed&quot;\r\n\r\nIf you are not writing a library I wouldn&#39;t mind to much to be honest. `T` would also need to be immutable for true safety btw.\r\n\r\nEDIT: intresting stuff, apparently this `ArrayList` is a different `ArrayList`, *nothing strange*","title":"Is it necessary to copy a list to be safe?","body":"<p>I don't have an answer but I find the implementation of <code>Arrays.asList()</code> funny, since it also creates a list inside:</p>\n<pre><code>    public static &lt;T&gt; List&lt;T&gt; asList(T... a) {\n        return new ArrayList&lt;&gt;(a);\n    }\n</code></pre>\n<p>I wonder what happened, maybe its one of those: &quot;this only applies to certain VMs so cant be guaranteed&quot;</p>\n<p>If you are not writing a library I wouldn't mind to much to be honest. <code>T</code> would also need to be immutable for true safety btw.</p>\n<p>EDIT: intresting stuff, apparently this <code>ArrayList</code> is a different <code>ArrayList</code>, <em>nothing strange</em></p>\n"},{"comments":[{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":0,"creation_date":1699879377,"post_id":77473921,"comment_id":136582286,"body_markdown":"&quot;it is still possible to modify the backing list&quot; - yes, but what is this backing list? It is the list returned by `Arrays.asList(this.toArray())`. How can you possibly modify this list? It seems quite unmodifiable to me, as it&#39;s not accessible, it&#39;s something that gets created inside an API method and never gets out except through the `unmodifiable` wrapper.","body":"&quot;it is still possible to modify the backing list&quot; - yes, but what is this backing list? It is the list returned by <code>Arrays.asList(this.toArray())</code>. How can you possibly modify this list? It seems quite unmodifiable to me, as it&#39;s not accessible, it&#39;s something that gets created inside an API method and never gets out except through the <code>unmodifiable</code> wrapper."},{"owner":{"account_id":1881735,"reputation":7688,"user_id":1701776,"accept_rate":71,"display_name":"BambooleanLogic"},"score":3,"creation_date":1699879622,"post_id":77473921,"comment_id":136582331,"body_markdown":"@k314159 This is a default method in an interface. There is no guarantee that `toArray` will return a brand new array. If the `Stream` implementation reuses array instances, that will retroactively change the list returned by `Arrays.asList` (since it&#39;s only a wrapper around the underlying array). As such, the point is to 1) get the array, 2) create an adapter to make it usable as a list, and 3) make a safe copy of that list without any connection to the original array.\n\n(Yes, reusing arrays is silly, but a default method can&#39;t just make wild assumptions about implementation details.)","body":"@k314159 This is a default method in an interface. There is no guarantee that <code>toArray</code> will return a brand new array. If the <code>Stream</code> implementation reuses array instances, that will retroactively change the list returned by <code>Arrays.asList</code> (since it&#39;s only a wrapper around the underlying array). As such, the point is to 1) get the array, 2) create an adapter to make it usable as a list, and 3) make a safe copy of that list without any connection to the original array.  (Yes, reusing arrays is silly, but a default method can&#39;t just make wild assumptions about implementation details.)"},{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":2,"creation_date":1699881149,"post_id":77473921,"comment_id":136582646,"body_markdown":"Thanks. It seems that all the Stream implementations inside the Java API (in the OpenJDK) define `toArray()` to create a brand new array. However, I guess you&#39;re saying there&#39;s nothing to prevent a user from writing their own Stream implementation that returns an existing array, and therefore it has to be copied.","body":"Thanks. It seems that all the Stream implementations inside the Java API (in the OpenJDK) define <code>toArray()</code> to create a brand new array. However, I guess you&#39;re saying there&#39;s nothing to prevent a user from writing their own Stream implementation that returns an existing array, and therefore it has to be copied."},{"owner":{"account_id":1211967,"reputation":7024,"user_id":1180351,"display_name":"Rob Spoor"},"score":1,"creation_date":1699882036,"post_id":77473921,"comment_id":136582823,"body_markdown":"@k314159 correct. The implementations create brand new arrays, but as said before, the specification doesn&#39;t require it, and that allows other implementations to return the same instance.","body":"@k314159 correct. The implementations create brand new arrays, but as said before, the specification doesn&#39;t require it, and that allows other implementations to return the same instance."}],"tags":[],"owner":{"account_id":11244318,"reputation":389,"user_id":8247530,"display_name":"Rifat Rubayatul Islam"},"comment_count":4,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1699902350,"creation_date":1699878779,"answer_id":77473921,"question_id":77473755,"body_markdown":"## Unmodifiable *view* backed by a modifiable collection\r\n\r\nFrom the [Javadoc](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Collection.html#unmodview) (emphasis mine):\r\n\r\n&gt; An unmodifiable view collection is a collection that is unmodifiable and that is also a view onto a backing collection. Its mutator methods throw UnsupportedOperationException, as described above, while reading and querying methods are delegated to the backing collection. The effect is to provide read-only access to the backing collection. This is useful for a component to provide users with read access to an internal collection, while preventing them from modifying such collections unexpectedly. Examples of unmodifiable view collections are those returned by the Collections.unmodifiableCollection, Collections.unmodifiableList, and related methods.\r\n\r\n&gt; Note that **changes to the backing collection might still be possible, and if they occur, they are visible through the unmodifiable view**. Thus, an unmodifiable view collection is not necessarily immutable. However, if the backing collection of an unmodifiable view is effectively immutable, or if the only reference to the backing collection is through an unmodifiable view, the view can be considered effectively immutable. \r\n\r\nAs the `Collections.unmodifiableList` returns a `unmodifiable view` of the backing list, it is still possible to modify the backing list which will impact the unmodifiable list. Now, the list is in turn backed by the array provided in the `Arrays.asList` method. So, everything depends on `this.toArray()`. As it is inside a default method of the `Stream` interface, it is dependent on the actual implementation of the stream whether `toArray()` returns a something modifiable or not. That&#39;s why it needs to be copied. \r\n","title":"Is it necessary to copy a list to be safe?","body":"<h2>Unmodifiable <em>view</em> backed by a modifiable collection</h2>\n<p>From the <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Collection.html#unmodview\" rel=\"nofollow noreferrer\">Javadoc</a> (emphasis mine):</p>\n<blockquote>\n<p>An unmodifiable view collection is a collection that is unmodifiable and that is also a view onto a backing collection. Its mutator methods throw UnsupportedOperationException, as described above, while reading and querying methods are delegated to the backing collection. The effect is to provide read-only access to the backing collection. This is useful for a component to provide users with read access to an internal collection, while preventing them from modifying such collections unexpectedly. Examples of unmodifiable view collections are those returned by the Collections.unmodifiableCollection, Collections.unmodifiableList, and related methods.</p>\n</blockquote>\n<blockquote>\n<p>Note that <strong>changes to the backing collection might still be possible, and if they occur, they are visible through the unmodifiable view</strong>. Thus, an unmodifiable view collection is not necessarily immutable. However, if the backing collection of an unmodifiable view is effectively immutable, or if the only reference to the backing collection is through an unmodifiable view, the view can be considered effectively immutable.</p>\n</blockquote>\n<p>As the <code>Collections.unmodifiableList</code> returns a <code>unmodifiable view</code> of the backing list, it is still possible to modify the backing list which will impact the unmodifiable list. Now, the list is in turn backed by the array provided in the <code>Arrays.asList</code> method. So, everything depends on <code>this.toArray()</code>. As it is inside a default method of the <code>Stream</code> interface, it is dependent on the actual implementation of the stream whether <code>toArray()</code> returns a something modifiable or not. That's why it needs to be copied.</p>\n"},{"comments":[{"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"score":1,"creation_date":1699880916,"post_id":77473925,"comment_id":136582585,"body_markdown":"Thanks, that&#39;s an interesting reminder about the existence of `toUnmodifiableList()`. However `Stream.toList()`, introduced in Java 16, is more &quot;modern&quot; than `Collectors.toUnmodifiableList()` (Java 10). And when you write `collect(Collectors.toUnmodifiableList())` IntelliJ IDEA suggests to change it to `toList()`.","body":"Thanks, that&#39;s an interesting reminder about the existence of <code>toUnmodifiableList()</code>. However <code>Stream.toList()</code>, introduced in Java 16, is more &quot;modern&quot; than <code>Collectors.toUnmodifiableList()</code> (Java 10). And when you write <code>collect(Collectors.toUnmodifiableList())</code> IntelliJ IDEA suggests to change it to <code>toList()</code>."},{"owner":{"account_id":31180,"reputation":29173,"user_id":85421,"display_name":"user85421"},"score":1,"creation_date":1699881791,"post_id":77473925,"comment_id":136582783,"body_markdown":"also be aware that `Collectors.toUnmodifiableList()` does **not** allow `null` elements; while these are allowed by `toList()`","body":"also be aware that <code>Collectors.toUnmodifiableList()</code> does <b>not</b> allow <code>null</code> elements; while these are allowed by <code>toList()</code>"}],"tags":[],"owner":{"account_id":24672893,"reputation":73,"user_id":18567686,"display_name":"Magic Developement"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1699878803,"creation_date":1699878803,"answer_id":77473925,"question_id":77473755,"body_markdown":"The reason for creating a new ArrayList in the implementation you provided is to ensure that the returned list is truly unmodifiable. The Arrays.asList method returns a fixed-size list backed by the original array.\r\n\r\nAn alternative and more modern approach to obtaining an unmodifiable list is to use the Collectors.toUnmodifiableList() method from the Stream API. For example:\r\n\r\n&gt; Arrays.stream(this.toArray()).collect(Collectors.toUnmodifiableList());\r\n\r\nThis approach directly produces an unmodifiable list without the need for creating an intermediate ArrayList. I hope this suggestion proves helpful.\r\n\r\n\r\n\r\n\r\n\r\n","title":"Is it necessary to copy a list to be safe?","body":"<p>The reason for creating a new ArrayList in the implementation you provided is to ensure that the returned list is truly unmodifiable. The Arrays.asList method returns a fixed-size list backed by the original array.</p>\n<p>An alternative and more modern approach to obtaining an unmodifiable list is to use the Collectors.toUnmodifiableList() method from the Stream API. For example:</p>\n<blockquote>\n<p>Arrays.stream(this.toArray()).collect(Collectors.toUnmodifiableList());</p>\n</blockquote>\n<p>This approach directly produces an unmodifiable list without the need for creating an intermediate ArrayList. I hope this suggestion proves helpful.</p>\n"},{"comments":[{"owner":{"account_id":1211967,"reputation":7024,"user_id":1180351,"display_name":"Rob Spoor"},"score":1,"creation_date":1699881893,"post_id":77474199,"comment_id":136582804,"body_markdown":"&quot;Use `List.of` instead&quot; is great advise if you know that no element will be `null`. Since `Stream`&#39;s default method must assume the stream can contain `null` elements it cannot be used. That makes `Collections.unmodifiableList(new ArrayList&lt;&gt;(Arrays.asList(array)))` a good alternative to create an unmodifiable list based on a potentially mutable array.","body":"&quot;Use <code>List.of</code> instead&quot; is great advise if you know that no element will be <code>null</code>. Since <code>Stream</code>&#39;s default method must assume the stream can contain <code>null</code> elements it cannot be used. That makes <code>Collections.unmodifiableList(new ArrayList&lt;&gt;(Arrays.asList(array)))</code> a good alternative to create an unmodifiable list based on a potentially mutable array."},{"owner":{"account_id":1881735,"reputation":7688,"user_id":1701776,"accept_rate":71,"display_name":"BambooleanLogic"},"score":1,"creation_date":1699882456,"post_id":77474199,"comment_id":136582904,"body_markdown":"One can also note that the default `Stream.toList()` implementation (which was tacked on many years later) is likely a compromise where the priorities (from high to low) were 1) make absolutely sure this works with every single contract-abiding implementation that has been written over the last several years, 2) since this only exists for backwards compatibility and it&#39;ll often be overridden with better implementations, don&#39;t make it smarter or more complicated than it has to be, and 3) just make sure it&#39;s not _painfully_ slow. Personally, I find the implementation to be a good balance.","body":"One can also note that the default <code>Stream.toList()</code> implementation (which was tacked on many years later) is likely a compromise where the priorities (from high to low) were 1) make absolutely sure this works with every single contract-abiding implementation that has been written over the last several years, 2) since this only exists for backwards compatibility and it&#39;ll often be overridden with better implementations, don&#39;t make it smarter or more complicated than it has to be, and 3) just make sure it&#39;s not <i>painfully</i> slow. Personally, I find the implementation to be a good balance."}],"tags":[],"owner":{"account_id":401843,"reputation":89863,"user_id":768644,"display_name":"rzwitserloot"},"comment_count":2,"down_vote_count":0,"up_vote_count":9,"is_accepted":true,"score":9,"last_activity_date":1699915581,"creation_date":1699881593,"answer_id":77474199,"question_id":77473755,"body_markdown":"## It has a purpose\r\n\r\n&gt; I&#39;m wondering why the list returned by Arrays.asList needs to be copied to a new ArrayList. Would it not be sufficient to just return the following?\r\n\r\nWhich `.toArray()` are we talking about? If we&#39;re talking about the one from `j.u.Collection`, you&#39;re right: The javadoc of that `toArray()` method _guarantees_ that it is a newly allocated array, hence, no need to make a defensive copy. However, that&#39;s not the `toArray()` involved here: We&#39;re talking about `j.u.s.Stream`&#39;s `.toArray()`. Its javadoc is a lot shorter:\r\n\r\n```\r\n    /**\r\n     * Returns an array containing the elements of this stream.\r\n     *\r\n     * &lt;p&gt;This is a &lt;a href=&quot;package-summary.html#StreamOps&quot;&gt;terminal\r\n     * operation&lt;/a&gt;.\r\n     *\r\n     * @return an array, whose {@linkplain Class#getComponentType runtime component\r\n     * type} is {@code Object}, containing the elements of this stream\r\n     */\r\n```\r\n\r\nUnlike `j.u.Collection toArray()`, this javadoc makes no notes either way about the nature of that array. Hence, evidently, the default impl in the `Stream` javadoc does not presume the array is necessarily &#39;safe&#39; (&#39;safe&#39; in the sense: Will not later be modified).\r\n\r\nI think you know, but just to be crystal clear:\r\n\r\n`Arrays.asList` is almost always a mistake. It&#39;s a worst-of-both-worlds list: It creates a light wrapper around the array you pass to it. So, `set()` works (because `foo[x] = value;` is possible and indeed, is how that is implemented), but `.add()` doesn&#39;t (because you can&#39;t change the size of an array). The list is not immutable (i.e. if passing it to code outside of your direct control you need to extensively document, or, make a defensive copy), but also not a fully featured list. Use `List.of` instead, which makes fully immutable lists - lists you can pass around to whomever you like without worrying about losing control of integrity.\r\n\r\nEDIT: And to explain why its `Collections.unmodifiableList(new ArrayList&lt;...`) instead of `List.copyOf` - The immutable lists that those static methods on `List` make throw NPEs when `null` is in there, but streams can have `null`, so you can&#39;t use that. This edit brought to you by a comment from @Rob Spoor :)\r\n\r\n## This is not as big an issue as you think, though\r\n\r\nNote that the code you found is merely the default implementation - any particular implementation of stream is free to come up with a better way to do this. Just about every implementation you are bound to run into overrides the definition. For example, if you call an arraylist&#39;s `stream()`, you end up with this implementation instead, which is from streamops and is the same code path used by all the collections in the core libs. Hence, the actual code you end up using, is this:\r\n\r\n```\r\n    @Override\r\n    public List&lt;P_OUT&gt; toList() {\r\n        return SharedSecrets.getJavaUtilCollectionAccess()\r\n        .listFromTrustedArrayNullsAllowed(this.toArray());\r\n    }\r\n```\r\n\r\n&#39;trusted array&#39; here refers to the notion that the array passed to it is guaranteed not going to change out from under you. There is no way the compiler can enforce that guarantee, but arraylist&#39;s (and indeed, all non-broken collections, given that the javadoc of `j.u.Collection` demands it!) `toArray()` makes new arrays so it&#39;s safe to do that, and this is far more efficient (avoids a bunch of needless copies).\r\n","title":"Is it necessary to copy a list to be safe?","body":"<h2>It has a purpose</h2>\n<blockquote>\n<p>I'm wondering why the list returned by Arrays.asList needs to be copied to a new ArrayList. Would it not be sufficient to just return the following?</p>\n</blockquote>\n<p>Which <code>.toArray()</code> are we talking about? If we're talking about the one from <code>j.u.Collection</code>, you're right: The javadoc of that <code>toArray()</code> method <em>guarantees</em> that it is a newly allocated array, hence, no need to make a defensive copy. However, that's not the <code>toArray()</code> involved here: We're talking about <code>j.u.s.Stream</code>'s <code>.toArray()</code>. Its javadoc is a lot shorter:</p>\n<pre><code>    /**\n     * Returns an array containing the elements of this stream.\n     *\n     * &lt;p&gt;This is a &lt;a href=&quot;package-summary.html#StreamOps&quot;&gt;terminal\n     * operation&lt;/a&gt;.\n     *\n     * @return an array, whose {@linkplain Class#getComponentType runtime component\n     * type} is {@code Object}, containing the elements of this stream\n     */\n</code></pre>\n<p>Unlike <code>j.u.Collection toArray()</code>, this javadoc makes no notes either way about the nature of that array. Hence, evidently, the default impl in the <code>Stream</code> javadoc does not presume the array is necessarily 'safe' ('safe' in the sense: Will not later be modified).</p>\n<p>I think you know, but just to be crystal clear:</p>\n<p><code>Arrays.asList</code> is almost always a mistake. It's a worst-of-both-worlds list: It creates a light wrapper around the array you pass to it. So, <code>set()</code> works (because <code>foo[x] = value;</code> is possible and indeed, is how that is implemented), but <code>.add()</code> doesn't (because you can't change the size of an array). The list is not immutable (i.e. if passing it to code outside of your direct control you need to extensively document, or, make a defensive copy), but also not a fully featured list. Use <code>List.of</code> instead, which makes fully immutable lists - lists you can pass around to whomever you like without worrying about losing control of integrity.</p>\n<p>EDIT: And to explain why its <code>Collections.unmodifiableList(new ArrayList&lt;...</code>) instead of <code>List.copyOf</code> - The immutable lists that those static methods on <code>List</code> make throw NPEs when <code>null</code> is in there, but streams can have <code>null</code>, so you can't use that. This edit brought to you by a comment from @Rob Spoor :)</p>\n<h2>This is not as big an issue as you think, though</h2>\n<p>Note that the code you found is merely the default implementation - any particular implementation of stream is free to come up with a better way to do this. Just about every implementation you are bound to run into overrides the definition. For example, if you call an arraylist's <code>stream()</code>, you end up with this implementation instead, which is from streamops and is the same code path used by all the collections in the core libs. Hence, the actual code you end up using, is this:</p>\n<pre><code>    @Override\n    public List&lt;P_OUT&gt; toList() {\n        return SharedSecrets.getJavaUtilCollectionAccess()\n        .listFromTrustedArrayNullsAllowed(this.toArray());\n    }\n</code></pre>\n<p>'trusted array' here refers to the notion that the array passed to it is guaranteed not going to change out from under you. There is no way the compiler can enforce that guarantee, but arraylist's (and indeed, all non-broken collections, given that the javadoc of <code>j.u.Collection</code> demands it!) <code>toArray()</code> makes new arrays so it's safe to do that, and this is far more efficient (avoids a bunch of needless copies).</p>\n"},{"tags":[],"owner":{"account_id":10777133,"reputation":7282,"user_id":7928721,"display_name":"samabcde"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1699890065,"creation_date":1699890065,"answer_id":77475089,"question_id":77473755,"body_markdown":"## When talking about **_safe_**, we usually refer to whether the object is [immutable][1]\r\n\r\n- `unmodifiableList` -&gt; **unmodifiable** here only guarantee caller can not change the state of wrapped list, and change of source will still be reflected in the wrapped list.  \r\n- `new ArrayList&lt;&gt;` -&gt; **defensive copy** means modifying source will not change the state of the copy and vice versa.\r\n- **unmodifiable** + **defensive copy** -&gt; **immutable**, you can assume the list always hold the same list of object reference.\r\n\r\n## Concrete example to demonstrate the difference\r\n\r\n```java\r\nimport java.util.ArrayList;\r\nimport java.util.Arrays;\r\nimport java.util.Collections;\r\nimport java.util.List;\r\n\r\npublic class UnmodifiableListCopy {\r\n    public static void main(String[] args) {\r\n        String[] source = new String[]{&quot;dummy&quot;};\r\n        List&lt;String&gt; unmodifiable = unmodifiableListWithoutCopy(source);\r\n        List&lt;String&gt; immutable = unmodifiableListWithCopy(source);\r\n        System.out.println(&quot;unmodifiable:&quot; + unmodifiable);\r\n        System.out.println(&quot;immutable:&quot; + immutable);\r\n        source[0] = &quot;modified&quot;;\r\n        System.out.println(&quot;--- change source ---&quot;);\r\n        System.out.println(&quot;unmodifiable:&quot; + unmodifiable);\r\n        System.out.println(&quot;immutable:&quot; + immutable);\r\n    }\r\n\r\n    private static &lt;T&gt; List&lt;T&gt; unmodifiableListWithoutCopy(T[] arr) {\r\n        return Collections.unmodifiableList(Arrays.asList(arr));\r\n    }\r\n\r\n    private static &lt;T&gt; List&lt;T&gt; unmodifiableListWithCopy(T[] arr) {\r\n        return Collections.unmodifiableList(new ArrayList&lt;&gt;(Arrays.asList(arr)));\r\n    }\r\n}\r\n```\r\nYou should see below when you run the code. \r\n```\r\nunmodifiable:[dummy]\r\nimmutable:[dummy]\r\n--- change source ---\r\nunmodifiable:[modified]\r\nimmutable:[dummy]\r\n```\r\n\r\nReference\r\n- https://stackoverflow.com/q/8892350/7928721\r\n\r\n  [1]: https://docs.oracle.com/javase/tutorial/essential/concurrency/immutable.html","title":"Is it necessary to copy a list to be safe?","body":"<h2>When talking about <strong><em>safe</em></strong>, we usually refer to whether the object is <a href=\"https://docs.oracle.com/javase/tutorial/essential/concurrency/immutable.html\" rel=\"nofollow noreferrer\">immutable</a></h2>\n<ul>\n<li><code>unmodifiableList</code> -&gt; <strong>unmodifiable</strong> here only guarantee caller can not change the state of wrapped list, and change of source will still be reflected in the wrapped list.</li>\n<li><code>new ArrayList&lt;&gt;</code> -&gt; <strong>defensive copy</strong> means modifying source will not change the state of the copy and vice versa.</li>\n<li><strong>unmodifiable</strong> + <strong>defensive copy</strong> -&gt; <strong>immutable</strong>, you can assume the list always hold the same list of object reference.</li>\n</ul>\n<h2>Concrete example to demonstrate the difference</h2>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collections;\nimport java.util.List;\n\npublic class UnmodifiableListCopy {\n    public static void main(String[] args) {\n        String[] source = new String[]{&quot;dummy&quot;};\n        List&lt;String&gt; unmodifiable = unmodifiableListWithoutCopy(source);\n        List&lt;String&gt; immutable = unmodifiableListWithCopy(source);\n        System.out.println(&quot;unmodifiable:&quot; + unmodifiable);\n        System.out.println(&quot;immutable:&quot; + immutable);\n        source[0] = &quot;modified&quot;;\n        System.out.println(&quot;--- change source ---&quot;);\n        System.out.println(&quot;unmodifiable:&quot; + unmodifiable);\n        System.out.println(&quot;immutable:&quot; + immutable);\n    }\n\n    private static &lt;T&gt; List&lt;T&gt; unmodifiableListWithoutCopy(T[] arr) {\n        return Collections.unmodifiableList(Arrays.asList(arr));\n    }\n\n    private static &lt;T&gt; List&lt;T&gt; unmodifiableListWithCopy(T[] arr) {\n        return Collections.unmodifiableList(new ArrayList&lt;&gt;(Arrays.asList(arr)));\n    }\n}\n</code></pre>\n<p>You should see below when you run the code.</p>\n<pre><code>unmodifiable:[dummy]\nimmutable:[dummy]\n--- change source ---\nunmodifiable:[modified]\nimmutable:[dummy]\n</code></pre>\n<p>Reference</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/q/8892350/7928721\">Immutable vs Unmodifiable collection</a></li>\n</ul>\n"}],"owner":{"account_id":19118721,"reputation":6319,"user_id":13963086,"display_name":"k314159"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":171,"favorite_count":0,"down_vote_count":2,"up_vote_count":5,"accepted_answer_id":77474199,"answer_count":5,"score":3,"last_activity_date":1700044495,"creation_date":1699876965,"question_id":77473755,"body_markdown":"The implementation (and documentation) of [Stream.toList][1] is like this:\r\n\r\n```java\r\nCollections.unmodifiableList(new ArrayList&lt;&gt;(Arrays.asList(this.toArray())))\r\n```\r\n\r\nI&#39;m wondering why the list returned by `Arrays.asList` needs to be copied to a new `ArrayList`. Would it not be sufficient to just return the following?\r\n\r\n```java\r\nCollections.unmodifiableList(Arrays.asList(this.toArray()))\r\n```\r\n\r\nI would like to know, if I write a method that returns a list that it creates like this, would there be any issues if I didn&#39;t bother to make a defensive copy of it?\r\n\r\n  [1]: https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/stream/Stream.html#toList()","title":"Is it necessary to copy a list to be safe?","body":"<p>The implementation (and documentation) of <a href=\"https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/stream/Stream.html#toList()\" rel=\"nofollow noreferrer\">Stream.toList</a> is like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Collections.unmodifiableList(new ArrayList&lt;&gt;(Arrays.asList(this.toArray())))\n</code></pre>\n<p>I'm wondering why the list returned by <code>Arrays.asList</code> needs to be copied to a new <code>ArrayList</code>. Would it not be sufficient to just return the following?</p>\n<pre class=\"lang-java prettyprint-override\"><code>Collections.unmodifiableList(Arrays.asList(this.toArray()))\n</code></pre>\n<p>I would like to know, if I write a method that returns a list that it creates like this, would there be any issues if I didn't bother to make a defensive copy of it?</p>\n"},{"tags":["java","unit-testing","mocking"],"owner":{"account_id":29772902,"reputation":49,"user_id":22817655,"display_name":"Kodigas"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":23,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700044000,"creation_date":1700043357,"question_id":77486853,"body_markdown":"***Note.** I read a number of SO posts on the matter, including [this one][1]*\r\n\r\nHere&#39;s the [classification][2] Martin Fowler uses:\r\n\r\n&gt; **Dummy** objects are passed around but never actually used. Usually they are just used to fill parameter lists.\r\n&gt; \r\n&gt; **Fake** objects actually have working implementations, but usually take\r\n&gt; some shortcut which makes them not suitable for production (an in\r\n&gt; memory database is a good example). \r\n&gt;\r\n&gt; **Stubs** provide canned answers to\r\n&gt; calls made during the test, usually not responding at all to anything\r\n&gt; outside what&#39;s programmed in for the test. \r\n&gt;\r\n&gt; **Spies** are stubs that also\r\n&gt; record some information based on how they were called. One form of\r\n&gt; this might be an email service that records how many messages it was\r\n&gt; sent.\r\n&gt;\r\n&gt; **Mocks** are what we are talking about here: objects pre-programmed\r\n&gt; with expectations which form a specification of the calls they are\r\n&gt; expected to receive.\r\n&gt;\r\n&gt; Of these kinds of doubles, *only mocks insist upon behavior verification*.\r\n\r\nSo dummies are used in conjunction with *state verification*, mocks are used with *behavior verification*. But then where do spies go here? I know how the term is used by Mockito (a real object with partially mocked behavior), but what is a mock in the &quot;standard&quot; test double classification as described by Fowler (who took it from the [&quot;xUnit Test Patterns&quot; book][3] by Gerard Meszaros)?\r\n\r\nAlso, how do the three relate to each other? Is, for example, one a special case of another? Fowler said spy *is a* stub (spy is a special case of stub), whereas [this article][4] says a mock *is a combination* of stub and spy (mock = stub + spy)\r\n\r\nI made a number of attempts at resolving all of this in my head, but so far haven&#39;t managed that\r\n\r\nJava examples with Junit + Mockito (+ AssertJ, if you want) would be great\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/346372/whats-the-difference-between-faking-mocking-and-stubbing/61209739#61209739\r\n  [2]: https://martinfowler.com/articles/mocksArentStubs.html\r\n  [3]: https://martinfowler.com/books/meszaros.html\r\n  [4]: https://tanzu.vmware.com/developer/guides/test-doubles/","title":"What is the difference between stubs, mocks, and spies as described by Meszaros?","body":"<p><em><strong>Note.</strong> I read a number of SO posts on the matter, including <a href=\"https://stackoverflow.com/questions/346372/whats-the-difference-between-faking-mocking-and-stubbing/61209739#61209739\">this one</a></em></p>\n<p>Here's the <a href=\"https://martinfowler.com/articles/mocksArentStubs.html\" rel=\"nofollow noreferrer\">classification</a> Martin Fowler uses:</p>\n<blockquote>\n<p><strong>Dummy</strong> objects are passed around but never actually used. Usually they are just used to fill parameter lists.</p>\n<p><strong>Fake</strong> objects actually have working implementations, but usually take\nsome shortcut which makes them not suitable for production (an in\nmemory database is a good example).</p>\n<p><strong>Stubs</strong> provide canned answers to\ncalls made during the test, usually not responding at all to anything\noutside what's programmed in for the test.</p>\n<p><strong>Spies</strong> are stubs that also\nrecord some information based on how they were called. One form of\nthis might be an email service that records how many messages it was\nsent.</p>\n<p><strong>Mocks</strong> are what we are talking about here: objects pre-programmed\nwith expectations which form a specification of the calls they are\nexpected to receive.</p>\n<p>Of these kinds of doubles, <em>only mocks insist upon behavior verification</em>.</p>\n</blockquote>\n<p>So dummies are used in conjunction with <em>state verification</em>, mocks are used with <em>behavior verification</em>. But then where do spies go here? I know how the term is used by Mockito (a real object with partially mocked behavior), but what is a mock in the &quot;standard&quot; test double classification as described by Fowler (who took it from the <a href=\"https://martinfowler.com/books/meszaros.html\" rel=\"nofollow noreferrer\">&quot;xUnit Test Patterns&quot; book</a> by Gerard Meszaros)?</p>\n<p>Also, how do the three relate to each other? Is, for example, one a special case of another? Fowler said spy <em>is a</em> stub (spy is a special case of stub), whereas <a href=\"https://tanzu.vmware.com/developer/guides/test-doubles/\" rel=\"nofollow noreferrer\">this article</a> says a mock <em>is a combination</em> of stub and spy (mock = stub + spy)</p>\n<p>I made a number of attempts at resolving all of this in my head, but so far haven't managed that</p>\n<p>Java examples with Junit + Mockito (+ AssertJ, if you want) would be great</p>\n"},{"tags":["java","spring","maven","slf4j"],"comments":[{"owner":{"account_id":3192259,"reputation":117609,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1700031657,"post_id":77484800,"comment_id":136603642,"body_markdown":"The SLF4J warning is the least of your problems, you also have an error indicating you are mixing incompatible versions of Spring and/or other liblraries. For starters remove `spring-data-jpa` that comes with `spring-boot-starter-data-jpa`. Remove `jackson-core` which is already included in `spring-boot-starter-web` and conflicts with the version used in there. Which Spring Boot version are you using? If you are on 3 then `hibernate-types-52` won&#39;t work as that is using Hibernate 6. Some other dependencies seem old as well.","body":"The SLF4J warning is the least of your problems, you also have an error indicating you are mixing incompatible versions of Spring and/or other liblraries. For starters remove <code>spring-data-jpa</code> that comes with <code>spring-boot-starter-data-jpa</code>. Remove <code>jackson-core</code> which is already included in <code>spring-boot-starter-web</code> and conflicts with the version used in there. Which Spring Boot version are you using? If you are on 3 then <code>hibernate-types-52</code> won&#39;t work as that is using Hibernate 6. Some other dependencies seem old as well."},{"owner":{"account_id":5220351,"reputation":117,"user_id":4449489,"display_name":"Vishwanath Gulabal"},"score":0,"creation_date":1700032290,"post_id":77484800,"comment_id":136603715,"body_markdown":"HI @M.Deinum, removed those dependencies(old as well), still getting the error. I am using 2.0.4.RELEASE as spring version.","body":"HI @M.Deinum, removed those dependencies(old as well), still getting the error. I am using 2.0.4.RELEASE as spring version."},{"owner":{"account_id":3192259,"reputation":117609,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1700036520,"post_id":77484800,"comment_id":136604313,"body_markdown":"As stated that is the least of your problems. Judging from the error. Do a `mvn dependecy:tree` and post the output here.","body":"As stated that is the least of your problems. Judging from the error. Do a <code>mvn dependecy:tree</code> and post the output here."},{"owner":{"account_id":5220351,"reputation":117,"user_id":4449489,"display_name":"Vishwanath Gulabal"},"score":0,"creation_date":1700042041,"post_id":77484800,"comment_id":136605216,"body_markdown":"I have added the tree @M.Deinum","body":"I have added the tree @M.Deinum"},{"owner":{"account_id":3192259,"reputation":117609,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1700042336,"post_id":77484800,"comment_id":136605267,"body_markdown":"You didn&#39;t add the tree, yu added an eclipse screenshot. Please add the output from running `mvn dependency:tree` on the command line. What you posted here also shows you still have the mentioned dependencies (like jackson) in there.","body":"You didn&#39;t add the tree, yu added an eclipse screenshot. Please add the output from running <code>mvn dependency:tree</code> on the command line. What you posted here also shows you still have the mentioned dependencies (like jackson) in there."},{"owner":{"account_id":5220351,"reputation":117,"user_id":4449489,"display_name":"Vishwanath Gulabal"},"score":0,"creation_date":1700043153,"post_id":77484800,"comment_id":136605421,"body_markdown":"It&#39;s very much probably 450 lines of text in notepad. Stackoverflow is not allowing to add here. Is there any other way ?","body":"It&#39;s very much probably 450 lines of text in notepad. Stackoverflow is not allowing to add here. Is there any other way ?"},{"owner":{"account_id":3192259,"reputation":117609,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1700043777,"post_id":77484800,"comment_id":136605529,"body_markdown":"Well you need to find the conflicting one (the fact that you get a warning on Elasticsearch for overriding the version is probably part of it).","body":"Well you need to find the conflicting one (the fact that you get a warning on Elasticsearch for overriding the version is probably part of it)."},{"owner":{"account_id":5220351,"reputation":117,"user_id":4449489,"display_name":"Vishwanath Gulabal"},"score":0,"creation_date":1700043853,"post_id":77484800,"comment_id":136605552,"body_markdown":"Let us [continue this discussion in chat](https://chat.stackoverflow.com/rooms/255948/discussion-between-vishwanath-gulabal-and-m-deinum).","body":"Let us <a href=\"https://chat.stackoverflow.com/rooms/255948/discussion-between-vishwanath-gulabal-and-m-deinum\">continue this discussion in chat</a>."}],"owner":{"account_id":5220351,"reputation":117,"user_id":4449489,"display_name":"Vishwanath Gulabal"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":60,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":0,"score":-1,"last_activity_date":1700043835,"creation_date":1700013066,"question_id":77484800,"body_markdown":"When i run my maven application.. i am getting the following error.\r\n\r\n[![enter image description here][1]][1]\r\nSLF4J: The requested version 1.7.16 by your slf4j binding is not compatible with [1.6]\r\nSLF4J: See http://www.slf4j.org/codes.html#version_mismatch for further details.\r\n06:48:43.432 [main] DEBUG org.jboss.logging - Logging Provider: org.jboss.logging.Log4j2LoggerProvider\r\n06:48:43.440 [main] INFO com.indusface.tasks.TasksApplication - debug task msg\r\ndebug task msg\r\nException in thread &quot;main&quot; java.lang.NoSuchMethodError: org.springframework.util.MultiValueMap.addAll(Ljava/lang/Object;Ljava/util/List;)V\r\n\tat org.springframework.core.io.support.SpringFactoriesLoader.loadSpringFactories(SpringFactoriesLoader.java:140)\r\n\tat org.springframework.core.io.support.SpringFactoriesLoader.loadFactoryNames(SpringFactoriesLoader.java:119)\r\n\tat org.springframework.boot.SpringApplication.getSpringFactoriesInstances(SpringApplication.java:429)\r\n\tat org.springframework.boot.SpringApplication.getSpringFactoriesInstances(SpringApplication.java:421)\r\n\tat org.springframework.boot.SpringApplication.&lt;init&gt;(SpringApplication.java:268)\r\n\tat org.springframework.boot.SpringApplication.&lt;init&gt;(SpringApplication.java:249)\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1258)\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1246)\r\n\tat com.indusface.tasks.TasksApplication.main(TasksApplication.java:49)\r\n\r\n\r\nI tried to add multiple versions of slf4j  dependencies in pom.xml but it seems that it is not helping out.\r\n\r\n\r\n```\r\n&lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-properties-migrator&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n    \t\t&lt;groupId&gt;org.springframework.data&lt;/groupId&gt;\r\n    \t\t&lt;artifactId&gt;spring-data-jpa&lt;/artifactId&gt;\r\n    \t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.postgresql&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;postgresql&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-data-rest&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;com.vladmihalcea&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;hibernate-types-52&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.9.11&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.json&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;json&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;20080701&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;io.swagger.parser.v3&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;swagger-parser&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.0.17&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n            &lt;artifactId&gt;spring-boot-starter-freemarker&lt;/artifactId&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.elasticsearch&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;elasticsearch&lt;/artifactId&gt;\r\n\t\t\t &lt;version&gt;6.4.3&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt;\r\n\t\t\t &lt;version&gt;6.4.3&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n        &lt;!-- https://mvnrepository.com/artifact/com.stripe/stripe-java --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t    &lt;groupId&gt;com.stripe&lt;/groupId&gt;\r\n\t\t    &lt;artifactId&gt;stripe-java&lt;/artifactId&gt;\r\n\t\t    &lt;version&gt;7.2.0&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n  \t\t\t&lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n  \t\t\t&lt;artifactId&gt;aws-sdk-java&lt;/artifactId&gt;\r\n  \t\t\t&lt;version&gt;2.13.19&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n    \t\t&lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\r\n    \t\t&lt;artifactId&gt;httpclient&lt;/artifactId&gt;\r\n    \t\t&lt;!-- &lt;version&gt;4.5&lt;/version&gt; --&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n    \t\t&lt;groupId&gt;commons-io&lt;/groupId&gt;\r\n   \t\t\t &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\r\n    \t\t&lt;version&gt;2.7&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;com.google.guava&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;guava&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;30.1-jre&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t    &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\r\n\t\t    &lt;artifactId&gt;jackson-core&lt;/artifactId&gt;\r\n\t\t    &lt;version&gt;2.12.5&lt;/version&gt;&lt;!--$NO-MVN-MAN-VER$--&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt; \r\n\t\t\t&lt;groupId&gt;com.opencsv&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;opencsv&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;4.1&lt;/version&gt; \r\n\t\t&lt;/dependency&gt;\r\n\t&lt;/dependencies&gt;\r\n```\r\n\r\nPlease find the above pom.xml as reference.\r\n\r\n\r\nhttps://docs.google.com/document/d/13P8pa3gP0YfkYGTrR56AEWmIU_6dswlwlSdVcOfNQGM/edit","title":"Error while running maven project : SLF4J: The requested version 1.7.16 by your slf4j binding is not compatible with [1.6]","body":"<p>When i run my maven application.. i am getting the following error.</p>\n<p>[![enter image description here][1]][1]\nSLF4J: The requested version 1.7.16 by your slf4j binding is not compatible with [1.6]\nSLF4J: See http://www.slf4j.org/codes.html#version_mismatch for further details.\n06:48:43.432 [main] DEBUG org.jboss.logging - Logging Provider: org.jboss.logging.Log4j2LoggerProvider\n06:48:43.440 [main] INFO com.indusface.tasks.TasksApplication - debug task msg\ndebug task msg\nException in thread &quot;main&quot; java.lang.NoSuchMethodError: org.springframework.util.MultiValueMap.addAll(Ljava/lang/Object;Ljava/util/List;)V\nat org.springframework.core.io.support.SpringFactoriesLoader.loadSpringFactories(SpringFactoriesLoader.java:140)\nat org.springframework.core.io.support.SpringFactoriesLoader.loadFactoryNames(SpringFactoriesLoader.java:119)\nat org.springframework.boot.SpringApplication.getSpringFactoriesInstances(SpringApplication.java:429)\nat org.springframework.boot.SpringApplication.getSpringFactoriesInstances(SpringApplication.java:421)\nat org.springframework.boot.SpringApplication.(SpringApplication.java:268)\nat org.springframework.boot.SpringApplication.(SpringApplication.java:249)\nat org.springframework.boot.SpringApplication.run(SpringApplication.java:1258)\nat org.springframework.boot.SpringApplication.run(SpringApplication.java:1246)\nat com.indusface.tasks.TasksApplication.main(TasksApplication.java:49)</p>\n<p>I tried to add multiple versions of slf4j  dependencies in pom.xml but it seems that it is not helping out.</p>\n<pre><code>&lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-properties-migrator&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-rest&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.vladmihalcea&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-types-52&lt;/artifactId&gt;\n            &lt;version&gt;2.9.11&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.json&lt;/groupId&gt;\n            &lt;artifactId&gt;json&lt;/artifactId&gt;\n            &lt;version&gt;20080701&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.swagger.parser.v3&lt;/groupId&gt;\n            &lt;artifactId&gt;swagger-parser&lt;/artifactId&gt;\n            &lt;version&gt;2.0.17&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-freemarker&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.elasticsearch&lt;/groupId&gt;\n            &lt;artifactId&gt;elasticsearch&lt;/artifactId&gt;\n             &lt;version&gt;6.4.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;\n            &lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt;\n             &lt;version&gt;6.4.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/com.stripe/stripe-java --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.stripe&lt;/groupId&gt;\n            &lt;artifactId&gt;stripe-java&lt;/artifactId&gt;\n            &lt;version&gt;7.2.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;aws-sdk-java&lt;/artifactId&gt;\n            &lt;version&gt;2.13.19&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\n            &lt;artifactId&gt;httpclient&lt;/artifactId&gt;\n            &lt;!-- &lt;version&gt;4.5&lt;/version&gt; --&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-io&lt;/groupId&gt;\n             &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\n            &lt;version&gt;2.7&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.google.guava&lt;/groupId&gt;\n            &lt;artifactId&gt;guava&lt;/artifactId&gt;\n            &lt;version&gt;30.1-jre&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n            &lt;artifactId&gt;jackson-core&lt;/artifactId&gt;\n            &lt;version&gt;2.12.5&lt;/version&gt;&lt;!--$NO-MVN-MAN-VER$--&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt; \n            &lt;groupId&gt;com.opencsv&lt;/groupId&gt;\n            &lt;artifactId&gt;opencsv&lt;/artifactId&gt;\n            &lt;version&gt;4.1&lt;/version&gt; \n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n</code></pre>\n<p>Please find the above pom.xml as reference.</p>\n<p><a href=\"https://docs.google.com/document/d/13P8pa3gP0YfkYGTrR56AEWmIU_6dswlwlSdVcOfNQGM/edit\" rel=\"nofollow noreferrer\">https://docs.google.com/document/d/13P8pa3gP0YfkYGTrR56AEWmIU_6dswlwlSdVcOfNQGM/edit</a></p>\n"},{"tags":["java","spring-boot","hibernate","liquibase","liquibase-hibernate"],"answers":[{"tags":[],"owner":{"account_id":14461800,"reputation":177,"user_id":10446433,"display_name":"SimpleJack"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700043643,"creation_date":1699997418,"answer_id":77483940,"question_id":76588487,"body_markdown":"To be honest, i&#39;m wondering why this is even working. Since you&#39;re using a Postgres you must provide at least a username. Not quiet sure about password. Can you have a user wihtout a password in Postgres? Anyway... More important, in combination with spring you must point to your package with your **Entity** classes, as explained [**here**][1].\r\n\r\nTry it again with this updated version of your Gradle file:\r\n\r\n```groovy\r\nplugins {\r\n\t// The WAR plugin extends the Java plugin\r\n    id &#39;war&#39;\r\n\r\n    id &#39;org.springframework.boot&#39; version &#39;3.1.5&#39;\r\n    id &#39;io.spring.dependency-management&#39; version &#39;1.1.3&#39;\r\n\tid &#39;org.liquibase.gradle&#39; version &#39;2.2.0&#39;\r\n}\r\n\r\ngroup = &#39;com.example&#39;\r\nversion = &#39;0.0.1-SNAPSHOT&#39;\r\n\r\njava {\r\n    sourceCompatibility = JavaVersion.VERSION_17\r\n}\r\n\r\nrepositories {\r\n    mavenCentral()\r\n}\r\n\r\ndependencies {\r\n\t// Web already contains Tomcat as Webserver\r\n    implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;\r\n\t// Data JPA already contains Hibernate\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;\r\n\t\r\n    // jackson-databind has jackson-core as dependency\r\n    implementation &#39;com.fasterxml.jackson.core:jackson-databind&#39;\r\n    implementation &#39;com.fasterxml.jackson.dataformat:jackson-dataformat-yaml&#39;\r\n\r\n    implementation &#39;org.postgresql:postgresql:42.6.0&#39;\r\n\t\r\n    // The Liquibase dependency has to be noted twice: One time for Spring &amp; one time for Liquibase Gradle Plugin\r\n    implementation &#39;org.liquibase:liquibase-core:4.24.0&#39;\r\n    liquibaseRuntime &#39;org.liquibase:liquibase-core:4.24.0&#39;\r\n    liquibaseRuntime &#39;org.liquibase:ext.liquibase-hibernate6:4.24.0&#39;\r\n    liquibaseRuntime &#39;info.picocli:picocli:4.7.5&#39;\r\n    liquibaseRuntime sourceSets.main.output\r\n}\r\n\r\ntasks.named(&#39;test&#39;) {\r\n    useJUnitPlatform()\r\n}\r\n\r\nliquibase {\r\n    activities {\r\n\t\tdef springProperties = new Properties()\r\n        file(&#39;src/main/resources/application.properties&#39;).withInputStream { springProperties.load(it) }\r\n\t\tmain {\r\n            url springProperties.getProperty(&#39;spring.datasource.url&#39;)\r\n            username springProperties.getProperty(&#39;spring.datasource.username&#39;)\r\n            // Comment the password out, if there is no password\r\n            password springProperties.getProperty(&#39;spring.datasource.password&#39;)\r\n            // Assumption here: Your entity classes live in the &quot;persistence&quot; package\r\n            referenceUrl &quot;hibernate:spring:${group}.persistence?dialect=org.hibernate.dialect.PostgreSQLDialect&quot;\r\n            changelogFile &#39;src/main/resources/config/liquibase/changelog/0.1.0/000000_00000000_initial-changelog.xml&#39;\r\n            logLevel &#39;info&#39;\r\n        }\r\n    }\r\n}\r\n\r\ndiffChangelog.configure {\r\n\t// Keep Java byte code up to date\r\n    dependsOn(compileJava)\r\n}\r\n```\r\n\r\n\r\n  [1]: https://github.com/liquibase/liquibase-hibernate/wiki/#hibernatespring","title":"Using SpringBoot 3 and Hibernate 6 any generated Liquibase changelogs based on my Java Entity classes are empty","body":"<p>To be honest, i'm wondering why this is even working. Since you're using a Postgres you must provide at least a username. Not quiet sure about password. Can you have a user wihtout a password in Postgres? Anyway... More important, in combination with spring you must point to your package with your <strong>Entity</strong> classes, as explained <a href=\"https://github.com/liquibase/liquibase-hibernate/wiki/#hibernatespring\" rel=\"nofollow noreferrer\"><strong>here</strong></a>.</p>\n<p>Try it again with this updated version of your Gradle file:</p>\n<pre><code>plugins {\n    // The WAR plugin extends the Java plugin\n    id 'war'\n\n    id 'org.springframework.boot' version '3.1.5'\n    id 'io.spring.dependency-management' version '1.1.3'\n    id 'org.liquibase.gradle' version '2.2.0'\n}\n\ngroup = 'com.example'\nversion = '0.0.1-SNAPSHOT'\n\njava {\n    sourceCompatibility = JavaVersion.VERSION_17\n}\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    // Web already contains Tomcat as Webserver\n    implementation 'org.springframework.boot:spring-boot-starter-web'\n    // Data JPA already contains Hibernate\n    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'\n    \n    // jackson-databind has jackson-core as dependency\n    implementation 'com.fasterxml.jackson.core:jackson-databind'\n    implementation 'com.fasterxml.jackson.dataformat:jackson-dataformat-yaml'\n\n    implementation 'org.postgresql:postgresql:42.6.0'\n    \n    // The Liquibase dependency has to be noted twice: One time for Spring &amp; one time for Liquibase Gradle Plugin\n    implementation 'org.liquibase:liquibase-core:4.24.0'\n    liquibaseRuntime 'org.liquibase:liquibase-core:4.24.0'\n    liquibaseRuntime 'org.liquibase:ext.liquibase-hibernate6:4.24.0'\n    liquibaseRuntime 'info.picocli:picocli:4.7.5'\n    liquibaseRuntime sourceSets.main.output\n}\n\ntasks.named('test') {\n    useJUnitPlatform()\n}\n\nliquibase {\n    activities {\n        def springProperties = new Properties()\n        file('src/main/resources/application.properties').withInputStream { springProperties.load(it) }\n        main {\n            url springProperties.getProperty('spring.datasource.url')\n            username springProperties.getProperty('spring.datasource.username')\n            // Comment the password out, if there is no password\n            password springProperties.getProperty('spring.datasource.password')\n            // Assumption here: Your entity classes live in the &quot;persistence&quot; package\n            referenceUrl &quot;hibernate:spring:${group}.persistence?dialect=org.hibernate.dialect.PostgreSQLDialect&quot;\n            changelogFile 'src/main/resources/config/liquibase/changelog/0.1.0/000000_00000000_initial-changelog.xml'\n            logLevel 'info'\n        }\n    }\n}\n\ndiffChangelog.configure {\n    // Keep Java byte code up to date\n    dependsOn(compileJava)\n}\n</code></pre>\n"}],"owner":{"account_id":292835,"reputation":6407,"user_id":595833,"accept_rate":94,"display_name":"bobbyrne01"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":560,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":1,"score":3,"last_activity_date":1700043643,"creation_date":1688124223,"question_id":76588487,"body_markdown":"I have a SpringBoot 3 based Gradle project that uses Hibernate 6 and Liquibase.\r\n\r\nThe goal is to use the `liquibase-hibernate6` dependency to generate an initial Liquibase changelog containing the details of my Java Entity class i.e `Item.java`.\r\n\r\nThe problem is that the generated changelog is basically empty.\r\n\r\nWhat is missing in order to generate Liquibase changelog from my Java Entity class?\r\n\r\n```\r\nval liquibaseVersion: String = &quot;4.23.0&quot;\r\nval liquibaseGradlePluginVersion: String = &quot;2.2.0&quot;\r\n\r\nplugins {\r\n\tjava\r\n\twar\r\n\r\n\tid(&quot;org.springframework.boot&quot;) version &quot;3.1.1&quot;\r\n\tid(&quot;io.spring.dependency-management&quot;) version &quot;1.1.0&quot;\r\n\tid(&quot;org.liquibase.gradle&quot;) version &quot;2.2.0&quot;\r\n}\r\n\r\ngroup = &quot;com.example&quot;\r\nversion = &quot;0.0.1-SNAPSHOT&quot;\r\n\r\njava {\r\n\tsourceCompatibility = JavaVersion.VERSION_17\r\n}\r\n\r\nrepositories {\r\n\tmavenCentral()\r\n}\r\n\r\ndependencies {\r\n\r\n\timplementation(&quot;org.postgresql:postgresql:42.6.0&quot;)\r\n\timplementation(&quot;info.picocli:picocli:4.6.3&quot;)\r\n\r\n\timplementation(&quot;org.springframework.boot:spring-boot-starter-data-jpa&quot;)\r\n\timplementation(&quot;org.springframework.boot:spring-boot-starter-web&quot;)\r\n\r\n\timplementation(&quot;org.liquibase:liquibase-core:$liquibaseVersion&quot;)\r\n\timplementation(&quot;org.liquibase:liquibase-gradle-plugin:$liquibaseGradlePluginVersion&quot;)\r\n\timplementation(&quot;org.hibernate.orm:hibernate-core:6.2.5.Final&quot;)\r\n\timplementation(&quot;org.liquibase.ext:liquibase-hibernate6:$liquibaseVersion&quot;)\r\n\r\n\timplementation(&quot;com.fasterxml.jackson.core:jackson-core&quot;)\r\n\timplementation(&quot;com.fasterxml.jackson.core:jackson-databind&quot;)\r\n\timplementation(&quot;com.fasterxml.jackson.dataformat:jackson-dataformat-yaml&quot;)\r\n\r\n\tprovidedRuntime(&quot;org.springframework.boot:spring-boot-starter-tomcat&quot;)\r\n\r\n    liquibaseRuntime(&quot;org.postgresql:postgresql:42.6.0&quot;)\r\n\tliquibaseRuntime(&quot;info.picocli:picocli:4.6.3&quot;)\r\n\tliquibaseRuntime(&quot;org.liquibase:liquibase-core:$liquibaseVersion&quot;)\r\n\tliquibaseRuntime(&quot;org.liquibase.ext:liquibase-hibernate6:$liquibaseVersion&quot;)\r\n\tliquibaseRuntime(&quot;org.hibernate.orm:hibernate-core:6.2.5.Final&quot;)\r\n\tliquibaseRuntime(&quot;org.springframework.boot:spring-boot-starter-data-jpa&quot;)\r\n\tliquibaseRuntime(sourceSets.getByName(&quot;main&quot;).output)\r\n}\r\n\r\ntasks.withType&lt;Test&gt; {\r\n\tuseJUnitPlatform()\r\n}\r\n\r\nliquibase {\r\n\tactivities.register(&quot;main&quot;) {\r\n\t\tthis.arguments = mapOf(\r\n\t\t\t&quot;changelogFile&quot; to &quot;src/main/resources/config/liquibase/changelog/0.1.0/000000_00000000_initial-changelog.xml&quot;,\r\n\t\t\t&quot;url&quot; to &quot;hibernate:spring:com.example?dialect=org.hibernate.dialect.PostgreSQLDialect&quot;\r\n\t\t)\r\n\t}\r\n}\r\n```\r\n\r\nI have a Java Entity:\r\n\r\n```java\r\npackage com.example.demo;\r\n\r\nimport jakarta.persistence.*;\r\n\r\n@Entity\r\npublic class Item {\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.AUTO)\r\n    @Column(name = &quot;id&quot;, nullable = false)\r\n    private Long id;\r\n\r\n    public Long getId() {\r\n        return id;\r\n    }\r\n\r\n    public void setId(Long id) {\r\n        this.id = id;\r\n    }\r\n}\r\n```\r\n\r\nContents of Liquibase changelog after running `generateChangeLog` via Gradle:\r\n\r\n```xml\r\n&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;\r\n&lt;databaseChangeLog xmlns=&quot;http://www.liquibase.org/xml/ns/dbchangelog&quot; xmlns:ext=&quot;http://www.liquibase.org/xml/ns/dbchangelog-ext&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd&quot;/&gt;\r\n```","title":"Using SpringBoot 3 and Hibernate 6 any generated Liquibase changelogs based on my Java Entity classes are empty","body":"<p>I have a SpringBoot 3 based Gradle project that uses Hibernate 6 and Liquibase.</p>\n<p>The goal is to use the <code>liquibase-hibernate6</code> dependency to generate an initial Liquibase changelog containing the details of my Java Entity class i.e <code>Item.java</code>.</p>\n<p>The problem is that the generated changelog is basically empty.</p>\n<p>What is missing in order to generate Liquibase changelog from my Java Entity class?</p>\n<pre><code>val liquibaseVersion: String = &quot;4.23.0&quot;\nval liquibaseGradlePluginVersion: String = &quot;2.2.0&quot;\n\nplugins {\n    java\n    war\n\n    id(&quot;org.springframework.boot&quot;) version &quot;3.1.1&quot;\n    id(&quot;io.spring.dependency-management&quot;) version &quot;1.1.0&quot;\n    id(&quot;org.liquibase.gradle&quot;) version &quot;2.2.0&quot;\n}\n\ngroup = &quot;com.example&quot;\nversion = &quot;0.0.1-SNAPSHOT&quot;\n\njava {\n    sourceCompatibility = JavaVersion.VERSION_17\n}\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n\n    implementation(&quot;org.postgresql:postgresql:42.6.0&quot;)\n    implementation(&quot;info.picocli:picocli:4.6.3&quot;)\n\n    implementation(&quot;org.springframework.boot:spring-boot-starter-data-jpa&quot;)\n    implementation(&quot;org.springframework.boot:spring-boot-starter-web&quot;)\n\n    implementation(&quot;org.liquibase:liquibase-core:$liquibaseVersion&quot;)\n    implementation(&quot;org.liquibase:liquibase-gradle-plugin:$liquibaseGradlePluginVersion&quot;)\n    implementation(&quot;org.hibernate.orm:hibernate-core:6.2.5.Final&quot;)\n    implementation(&quot;org.liquibase.ext:liquibase-hibernate6:$liquibaseVersion&quot;)\n\n    implementation(&quot;com.fasterxml.jackson.core:jackson-core&quot;)\n    implementation(&quot;com.fasterxml.jackson.core:jackson-databind&quot;)\n    implementation(&quot;com.fasterxml.jackson.dataformat:jackson-dataformat-yaml&quot;)\n\n    providedRuntime(&quot;org.springframework.boot:spring-boot-starter-tomcat&quot;)\n\n    liquibaseRuntime(&quot;org.postgresql:postgresql:42.6.0&quot;)\n    liquibaseRuntime(&quot;info.picocli:picocli:4.6.3&quot;)\n    liquibaseRuntime(&quot;org.liquibase:liquibase-core:$liquibaseVersion&quot;)\n    liquibaseRuntime(&quot;org.liquibase.ext:liquibase-hibernate6:$liquibaseVersion&quot;)\n    liquibaseRuntime(&quot;org.hibernate.orm:hibernate-core:6.2.5.Final&quot;)\n    liquibaseRuntime(&quot;org.springframework.boot:spring-boot-starter-data-jpa&quot;)\n    liquibaseRuntime(sourceSets.getByName(&quot;main&quot;).output)\n}\n\ntasks.withType&lt;Test&gt; {\n    useJUnitPlatform()\n}\n\nliquibase {\n    activities.register(&quot;main&quot;) {\n        this.arguments = mapOf(\n            &quot;changelogFile&quot; to &quot;src/main/resources/config/liquibase/changelog/0.1.0/000000_00000000_initial-changelog.xml&quot;,\n            &quot;url&quot; to &quot;hibernate:spring:com.example?dialect=org.hibernate.dialect.PostgreSQLDialect&quot;\n        )\n    }\n}\n</code></pre>\n<p>I have a Java Entity:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.demo;\n\nimport jakarta.persistence.*;\n\n@Entity\npublic class Item {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = &quot;id&quot;, nullable = false)\n    private Long id;\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n}\n</code></pre>\n<p>Contents of Liquibase changelog after running <code>generateChangeLog</code> via Gradle:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;\n&lt;databaseChangeLog xmlns=&quot;http://www.liquibase.org/xml/ns/dbchangelog&quot; xmlns:ext=&quot;http://www.liquibase.org/xml/ns/dbchangelog-ext&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd&quot;/&gt;\n</code></pre>\n"},{"tags":["java","spring-boot","graphql","postman","graphql-java"],"owner":{"account_id":19462220,"reputation":25,"user_id":14236284,"display_name":"Mayar"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":38,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700043252,"creation_date":1700043252,"question_id":77486842,"body_markdown":"I am using graphQL for my APIs and now I need to receive a file in the request as a **multipart file**, so how to send that file using **Postman** to my controller? \r\n```\r\n@Data\r\npublic class FileDTO {\r\n    private MultipartFile smsFile;\r\n}\r\n```\r\n```\r\n@Controller\r\npublic class SMSBulkController {\r\n    @Autowired\r\n    ParsingService parsingService;\r\n\r\n    @MutationMapping\r\n    public ApiResponse&lt;String&gt; uploadFile(@Argument FileDTO file) throws IOException {\r\n        parsingService.upload(file);\r\n        return ApiResponse.success(&quot;success&quot;);\r\n    }\r\n}\r\n```\r\nand this is my graphql file:\r\n```\r\nscalar Upload\r\ninput smsFileInput{\r\n    smsFile: Upload\r\n}\r\ntype Mutation{upload(file: smsFileInput):MutateApiResponse}\r\n```","title":"How to send a file in the request body for GraphQL API and Spring-boot application using postman?","body":"<p>I am using graphQL for my APIs and now I need to receive a file in the request as a <strong>multipart file</strong>, so how to send that file using <strong>Postman</strong> to my controller?</p>\n<pre><code>@Data\npublic class FileDTO {\n    private MultipartFile smsFile;\n}\n</code></pre>\n<pre><code>@Controller\npublic class SMSBulkController {\n    @Autowired\n    ParsingService parsingService;\n\n    @MutationMapping\n    public ApiResponse&lt;String&gt; uploadFile(@Argument FileDTO file) throws IOException {\n        parsingService.upload(file);\n        return ApiResponse.success(&quot;success&quot;);\n    }\n}\n</code></pre>\n<p>and this is my graphql file:</p>\n<pre><code>scalar Upload\ninput smsFileInput{\n    smsFile: Upload\n}\ntype Mutation{upload(file: smsFileInput):MutateApiResponse}\n</code></pre>\n"},{"tags":["java","checkstyle","google-java-format"],"answers":[{"comments":[{"owner":{"account_id":15508322,"reputation":473,"user_id":11187813,"display_name":"nathaner"},"score":0,"creation_date":1643046143,"post_id":70838045,"comment_id":125230637,"body_markdown":"Thanks for your answer. I was wondering if there were some kind of built-in mechanisms to achieve this. I&#39;ll try using a script. I&#39;ve already tried to configure Eclipse to use the plugin but it seems it doesn&#39;t work properly. Maybe my Eclipse configuration is wrong somewhere. I&#39;ll dig into that and maybe raise an issue if it still doesn&#39;t work.","body":"Thanks for your answer. I was wondering if there were some kind of built-in mechanisms to achieve this. I&#39;ll try using a script. I&#39;ve already tried to configure Eclipse to use the plugin but it seems it doesn&#39;t work properly. Maybe my Eclipse configuration is wrong somewhere. I&#39;ll dig into that and maybe raise an issue if it still doesn&#39;t work."}],"tags":[],"owner":{"account_id":204659,"reputation":37559,"user_id":453005,"accept_rate":100,"display_name":"DwB"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1643045605,"creation_date":1643045605,"answer_id":70838045,"question_id":70837778,"body_markdown":"After a quick read of the google-java-format documentation,\r\nit is intended to function one file at a time\r\nor on a group of files,\r\neach listed on the command line.\r\n\r\nThere appears to be plugins for intelliJ and Eclipse.\r\n\r\nIf you need to format every file in your project,\r\nyou will need to do one of the following:\r\n\r\n 1. Feed a list of every file.  This is fairly easy with a script; use xargs.\r\n 1. If you use IntelliJ, check the plugin options.  It likely has some kind of selection mechanism.\r\n 1. As above, the Eclipse plugin likely has some kind of selection mechanism, as well.\r\n","title":"google-java-format: format whole project","body":"<p>After a quick read of the google-java-format documentation,\nit is intended to function one file at a time\nor on a group of files,\neach listed on the command line.</p>\n<p>There appears to be plugins for intelliJ and Eclipse.</p>\n<p>If you need to format every file in your project,\nyou will need to do one of the following:</p>\n<ol>\n<li>Feed a list of every file.  This is fairly easy with a script; use xargs.</li>\n<li>If you use IntelliJ, check the plugin options.  It likely has some kind of selection mechanism.</li>\n<li>As above, the Eclipse plugin likely has some kind of selection mechanism, as well.</li>\n</ol>\n"},{"tags":[],"owner":{"account_id":28587115,"reputation":1,"user_id":21887117,"display_name":"Chris Walker"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700042785,"creation_date":1700042785,"answer_id":77486789,"question_id":70837778,"body_markdown":"The answer above suggests using `xargs`, so here&#39;s the command that I used:\r\n\r\n    find my_java_project/ -name &quot;*.java&quot; -type f -print | xargs java -jar google-java-format-1.18.1-all-deps.jar --replace\r\n\r\n...where my current working directory contains my Java project (in the `my_java_project` folder) and the Google Java Format JAR.","title":"google-java-format: format whole project","body":"<p>The answer above suggests using <code>xargs</code>, so here's the command that I used:</p>\n<pre><code>find my_java_project/ -name &quot;*.java&quot; -type f -print | xargs java -jar google-java-format-1.18.1-all-deps.jar --replace\n</code></pre>\n<p>...where my current working directory contains my Java project (in the <code>my_java_project</code> folder) and the Google Java Format JAR.</p>\n"}],"owner":{"account_id":15508322,"reputation":473,"user_id":11187813,"display_name":"nathaner"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":1604,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1700042785,"creation_date":1643044426,"question_id":70837778,"body_markdown":"I&#39;m using google-java-format to format Java code according to Google Java Style. However, I only find documentation and examples showing how to format one file using the CLI. \r\n\r\nIs there a built-in way to format an entire Java project directly using the CLI (without looping using a shell script or something else)? ","title":"google-java-format: format whole project","body":"<p>I'm using google-java-format to format Java code according to Google Java Style. However, I only find documentation and examples showing how to format one file using the CLI.</p>\n<p>Is there a built-in way to format an entire Java project directly using the CLI (without looping using a shell script or something else)?</p>\n"},{"tags":["java","apache-camel"],"comments":[{"owner":{"account_id":213468,"reputation":103500,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1683120042,"post_id":76164090,"comment_id":134317556,"body_markdown":"Please show the code of what you did in Camel 3 which you can no longer do in Camel 4. That might help people to understand what you&#39;re trying to do and provide an alternative.","body":"Please show the code of what you did in Camel 3 which you can no longer do in Camel 4. That might help people to understand what you&#39;re trying to do and provide an alternative."},{"owner":{"account_id":1116645,"reputation":1415,"user_id":1105832,"display_name":"JanM"},"score":0,"creation_date":1683120909,"post_id":76164090,"comment_id":134317803,"body_markdown":"Hi Mark, well in general I need to access RouteDefinition for a given routeId. This used to be a trivial task, is it not possible anymore for some reason? Posting the whole code of the testing framework is not practical in this case.","body":"Hi Mark, well in general I need to access RouteDefinition for a given routeId. This used to be a trivial task, is it not possible anymore for some reason? Posting the whole code of the testing framework is not practical in this case."},{"owner":{"account_id":213468,"reputation":103500,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1683123476,"post_id":76164090,"comment_id":134318565,"body_markdown":"I don&#39;t use Camel, so I can&#39;t comment to the specifics, but illustrating your question with what you&#39;re doing usually goes a long way towards getting an answer.","body":"I don&#39;t use Camel, so I can&#39;t comment to the specifics, but illustrating your question with what you&#39;re doing usually goes a long way towards getting an answer."},{"owner":{"account_id":1290399,"reputation":523,"user_id":5374740,"accept_rate":0,"display_name":"Lex Luthor"},"score":1,"creation_date":1684890393,"post_id":76164090,"comment_id":134582552,"body_markdown":"Agree with Mark.. more information! In my case, I used `adapt` to advice a Route by first getting the RouteDefinition from the context.. In the process of upgrading to Camel4-M3 I got rid of both the adapt() call and the call to get the RouteDefinition instead passing the `routeId` parameter directly to `AdviceWith.adviceWith`.","body":"Agree with Mark.. more information! In my case, I used <code>adapt</code> to advice a Route by first getting the RouteDefinition from the context.. In the process of upgrading to Camel4-M3 I got rid of both the adapt() call and the call to get the RouteDefinition instead passing the <code>routeId</code> parameter directly to <code>AdviceWith.adviceWith</code>."},{"owner":{"account_id":1290399,"reputation":523,"user_id":5374740,"accept_rate":0,"display_name":"Lex Luthor"},"score":0,"creation_date":1684891129,"post_id":76164090,"comment_id":134582629,"body_markdown":"I found you can still access `RouteDefinition` by _routeId_ by doing as follows (Kotlin):\n\n`\nval routeDefinition = (camelContext as ModelCamelContext).getRouteDefinition(routeId)\n`","body":"I found you can still access <code>RouteDefinition</code> by <i>routeId</i> by doing as follows (Kotlin):  ` val routeDefinition = (camelContext as ModelCamelContext).getRouteDefinition(routeId) `"},{"owner":{"account_id":1104972,"reputation":9652,"user_id":1096567,"accept_rate":100,"display_name":"Lovis"},"score":0,"creation_date":1697445411,"post_id":76164090,"comment_id":136276157,"body_markdown":"@JanM did you find a solution for this?","body":"@JanM did you find a solution for this?"}],"answers":[{"tags":[],"owner":{"account_id":1116645,"reputation":1415,"user_id":1105832,"display_name":"JanM"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700042613,"creation_date":1700042613,"answer_id":77486770,"question_id":76164090,"body_markdown":"Camel migration guide https://camel.apache.org/manual/camel-4-migration-guide.html\r\nmentions following piece of migration code:\r\n\r\n    Removed getExtension from the interface CamelContext\r\n    \r\n    Use getCamelContextExtension instead. For example ManagedCamelContext managed = context.getCamelContextExtension().getContextPlugin(ManagedCamelContext.class);\r\n\r\nBased on that we were able to get the model extension via:\r\n\r\n    var model = context.getCamelContextExtension().getContextPlugin(Model.class);\r\n\r\n","title":"Apache Camel adapt() method removed in version 4","body":"<p>Camel migration guide <a href=\"https://camel.apache.org/manual/camel-4-migration-guide.html\" rel=\"nofollow noreferrer\">https://camel.apache.org/manual/camel-4-migration-guide.html</a>\nmentions following piece of migration code:</p>\n<pre><code>Removed getExtension from the interface CamelContext\n\nUse getCamelContextExtension instead. For example ManagedCamelContext managed = context.getCamelContextExtension().getContextPlugin(ManagedCamelContext.class);\n</code></pre>\n<p>Based on that we were able to get the model extension via:</p>\n<pre><code>var model = context.getCamelContextExtension().getContextPlugin(Model.class);\n</code></pre>\n"}],"owner":{"account_id":1116645,"reputation":1415,"user_id":1105832,"display_name":"JanM"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":642,"favorite_count":0,"down_vote_count":0,"up_vote_count":5,"answer_count":1,"score":5,"last_activity_date":1700042613,"creation_date":1683118587,"question_id":76164090,"body_markdown":"While migrating from Apache Camel 3 to version 4, I&#39;ve ran into the fact that method adapt() was removed from the camel context and it&#39;s no longer possible to adapt into the ModelCamelContext\r\n\r\n    ModelCamelContext modelContext = context.adapt(ModelCamelContext.class);\t\t\r\n\tRouteDefinition route = modelContext.getRouteDefinition(routeId);\r\n\r\nThe  [official migration guide][1] only mentions that \r\n\r\n&gt; Replaced adapt() from org.apache.camel.CamelContext with getCamelContextExtension\r\n\r\nBut sadly does not elaborate on how the APIs are compatible. I&#39;m struggling with a use case where I need to dynamically manipulate route definitions, which was fairly simple with the old ModelCamelContext approach. **I need to get route definition**, remove it from context, add different one again and manipulate outputs (getOutputs method) on it.\r\n\r\nAny ideas how this could be achieved in Apache Camel version 4?\r\n\r\n  [1]: https://camel.apache.org/manual/camel-4-migration-guide.html","title":"Apache Camel adapt() method removed in version 4","body":"<p>While migrating from Apache Camel 3 to version 4, I've ran into the fact that method adapt() was removed from the camel context and it's no longer possible to adapt into the ModelCamelContext</p>\n<pre><code>ModelCamelContext modelContext = context.adapt(ModelCamelContext.class);        \nRouteDefinition route = modelContext.getRouteDefinition(routeId);\n</code></pre>\n<p>The  <a href=\"https://camel.apache.org/manual/camel-4-migration-guide.html\" rel=\"noreferrer\">official migration guide</a> only mentions that</p>\n<blockquote>\n<p>Replaced adapt() from org.apache.camel.CamelContext with getCamelContextExtension</p>\n</blockquote>\n<p>But sadly does not elaborate on how the APIs are compatible. I'm struggling with a use case where I need to dynamically manipulate route definitions, which was fairly simple with the old ModelCamelContext approach. <strong>I need to get route definition</strong>, remove it from context, add different one again and manipulate outputs (getOutputs method) on it.</p>\n<p>Any ideas how this could be achieved in Apache Camel version 4?</p>\n"},{"tags":["java","spring","gradle","profiling","spring-profiles"],"answers":[{"comments":[{"owner":{"account_id":2635104,"reputation":1293,"user_id":2280027,"accept_rate":39,"display_name":"yazabara"},"score":0,"creation_date":1496133626,"post_id":44257253,"comment_id":75522873,"body_markdown":"Thanks, but it doesn&#39;t help me","body":"Thanks, but it doesn&#39;t help me"},{"owner":{"account_id":12210699,"reputation":694,"user_id":8912565,"display_name":"Ravik"},"score":0,"creation_date":1630486508,"post_id":44257253,"comment_id":121966272,"body_markdown":"Just a note this property needs to be added in the build.gradle file","body":"Just a note this property needs to be added in the build.gradle file"}],"tags":[],"owner":{"account_id":1096470,"reputation":26066,"user_id":1089967,"accept_rate":59,"display_name":"lance-java"},"comment_count":2,"down_vote_count":1,"up_vote_count":25,"is_accepted":false,"score":24,"last_activity_date":1496133073,"creation_date":1496133073,"answer_id":44257253,"question_id":44256956,"body_markdown":"I think you are wanting to set a system property in the runtime/test JVM but you are incorrectly setting a system property in the build-time JVM (ie the Gradle daemon).\r\n\r\nSee [Test.systemProperty(String, Object)](https://docs.gradle.org/current/javadoc/org/gradle/api/tasks/testing/Test.html#systemProperty%28java.lang.String,%20java.lang.Object%29)\r\n\r\nEg:\r\n\r\n    test {\r\n        systemProperty &#39;spring.profiles.active&#39;, &#39;DEV&#39;\r\n    }\r\n\r\n... and another note on your attempt. Please note that tasks have a `doFirst` and a `doLast` method so you wouldn&#39;t need a separate task for what you were attempting.","title":"Run gradle task with Spring Profiles (Integration tests)","body":"<p>I think you are wanting to set a system property in the runtime/test JVM but you are incorrectly setting a system property in the build-time JVM (ie the Gradle daemon).</p>\n\n<p>See <a href=\"https://docs.gradle.org/current/javadoc/org/gradle/api/tasks/testing/Test.html#systemProperty%28java.lang.String,%20java.lang.Object%29\" rel=\"noreferrer\">Test.systemProperty(String, Object)</a></p>\n\n<p>Eg:</p>\n\n<pre><code>test {\n    systemProperty 'spring.profiles.active', 'DEV'\n}\n</code></pre>\n\n<p>... and another note on your attempt. Please note that tasks have a <code>doFirst</code> and a <code>doLast</code> method so you wouldn't need a separate task for what you were attempting.</p>\n"},{"comments":[{"owner":{"account_id":1096470,"reputation":26066,"user_id":1089967,"accept_rate":59,"display_name":"lance-java"},"score":1,"creation_date":1633227748,"post_id":50008227,"comment_id":122702450,"body_markdown":"You shouldn&#39;t do this in a `doFirst {...}`it&#39;s task config which should be done in the configuration phase, not the execution phase. See [build phases](https://docs.gradle.org/current/userguide/build_lifecycle.html#sec:build_phases)","body":"You shouldn&#39;t do this in a <code>doFirst {...}</code>it&#39;s task config which should be done in the configuration phase, not the execution phase. See <a href=\"https://docs.gradle.org/current/userguide/build_lifecycle.html#sec:build_phases\" rel=\"nofollow noreferrer\">build phases</a>"}],"tags":[],"owner":{"account_id":200630,"reputation":27386,"user_id":446591,"accept_rate":65,"display_name":"Brad Mace"},"comment_count":1,"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1671259235,"creation_date":1524593194,"answer_id":50008227,"question_id":44256956,"body_markdown":"This works for me:\r\n\r\n    test {\r\n    \tsystemProperty &#39;spring.profiles.active&#39;, &#39;ci&#39;\r\n    }\r\n\r\nNow when I do `gradlew test` it runs with the `ci` profile.","title":"Run gradle task with Spring Profiles (Integration tests)","body":"<p>This works for me:</p>\n<pre><code>test {\n    systemProperty 'spring.profiles.active', 'ci'\n}\n</code></pre>\n<p>Now when I do <code>gradlew test</code> it runs with the <code>ci</code> profile.</p>\n"},{"tags":[],"owner":{"account_id":4824120,"reputation":748,"user_id":3893990,"display_name":"Han"},"comment_count":0,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1532825757,"creation_date":1532825757,"answer_id":51576389,"question_id":44256956,"body_markdown":"Wonder if this is a very late reply? But I have encountered the similar problem with situation.\r\n\r\n 1. Using @Profiles in springboot src/test/* folder.\r\n 2. The @ActiveProfiles is actually activated (when viewing logs), but it doesn&#39;t use the @Profile when executed with gradle test. However, the @Profile was working in Eclipse Editor when JUnit test was executed.\r\n\r\nSo in the end i found that @Profile needs to be in **src/main/*** folder. Gradle test seems to have precedence over /src/main rather than /src/test. With this my @Profile(&quot;test&quot;) was converted into @Profile(&quot;!test&quot;). There was no added spring.profiles.active into the gradle built.\r\n\r\n[Negating profile][1]\r\n\r\n\r\n  [1]: http://www.baeldung.com/spring-profiles","title":"Run gradle task with Spring Profiles (Integration tests)","body":"<p>Wonder if this is a very late reply? But I have encountered the similar problem with situation.</p>\n\n<ol>\n<li>Using @Profiles in springboot src/test/* folder.</li>\n<li>The @ActiveProfiles is actually activated (when viewing logs), but it doesn't use the @Profile when executed with gradle test. However, the @Profile was working in Eclipse Editor when JUnit test was executed.</li>\n</ol>\n\n<p>So in the end i found that @Profile needs to be in <strong>src/main/*</strong> folder. Gradle test seems to have precedence over /src/main rather than /src/test. With this my @Profile(\"test\") was converted into @Profile(\"!test\"). There was no added spring.profiles.active into the gradle built.</p>\n\n<p><a href=\"http://www.baeldung.com/spring-profiles\" rel=\"nofollow noreferrer\">Negating profile</a></p>\n"},{"tags":[],"owner":{"account_id":27316050,"reputation":51,"user_id":20830519,"display_name":"Joseph Mbera"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1700042359,"creation_date":1700042359,"answer_id":77486746,"question_id":44256956,"body_markdown":"this worked for me\r\n\r\n    tasks.withType&lt;Test&gt; {\r\n        systemProperty(&quot;spring.profiles.active&quot;, &quot;DEV&quot;)\r\n    }\r\n\r\n","title":"Run gradle task with Spring Profiles (Integration tests)","body":"<p>this worked for me</p>\n<pre><code>tasks.withType&lt;Test&gt; {\n    systemProperty(&quot;spring.profiles.active&quot;, &quot;DEV&quot;)\n}\n</code></pre>\n"}],"owner":{"account_id":2635104,"reputation":1293,"user_id":2280027,"accept_rate":39,"display_name":"yazabara"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":19196,"favorite_count":0,"down_vote_count":0,"up_vote_count":13,"answer_count":4,"score":13,"last_activity_date":1700042359,"creation_date":1496132059,"question_id":44256956,"body_markdown":"Need to run tests via gradle with spring profiles.\r\n\r\n    gradle clean build\r\n\r\nI&#39;ve added task:\r\n\r\n    task beforeTest() {\r\n        doLast {\r\n          System.setProperty(&quot;spring.profiles.active&quot;, &quot;DEV&quot;)\r\n        }\r\n    }\r\n    \r\n    test.dependsOn beforeTest\r\n\r\nAnd my test definition is:\r\n\r\n    @RunWith(SpringRunner.class)\r\n    @SpringBootTest\r\n    @ActiveProfiles(&quot;TestProfile&quot;)\r\n    public class SomeTest {\r\n\r\nBut this construction doesn&#39;t work for me.\r\n\r\nGradle runs tests.","title":"Run gradle task with Spring Profiles (Integration tests)","body":"<p>Need to run tests via gradle with spring profiles.</p>\n\n<pre><code>gradle clean build\n</code></pre>\n\n<p>I've added task:</p>\n\n<pre><code>task beforeTest() {\n    doLast {\n      System.setProperty(\"spring.profiles.active\", \"DEV\")\n    }\n}\n\ntest.dependsOn beforeTest\n</code></pre>\n\n<p>And my test definition is:</p>\n\n<pre><code>@RunWith(SpringRunner.class)\n@SpringBootTest\n@ActiveProfiles(\"TestProfile\")\npublic class SomeTest {\n</code></pre>\n\n<p>But this construction doesn't work for me.</p>\n\n<p>Gradle runs tests.</p>\n"},{"tags":["java","ios","swift","rsa","public-key"],"answers":[{"comments":[{"owner":{"account_id":541417,"reputation":71857,"user_id":148357,"accept_rate":75,"display_name":"Antonio"},"score":0,"creation_date":1545611783,"post_id":53906561,"comment_id":94661026,"body_markdown":"Awesome, the error is gone. Checking if the key is actually usable, I need to close the circle by completing an encryption/decryption process before accepting the answer. For now, thanks a lot.","body":"Awesome, the error is gone. Checking if the key is actually usable, I need to close the circle by completing an encryption/decryption process before accepting the answer. For now, thanks a lot."},{"owner":{"account_id":5427869,"reputation":2070,"user_id":4319615,"accept_rate":37,"display_name":"zakjma"},"score":0,"creation_date":1610094456,"post_id":53906561,"comment_id":116028263,"body_markdown":"exportImportManager.exportPublicKeyToDER  doesn&#39;t work for me `let statusPublic: OSStatus = SecItemCopyMatching(publicKeyAttributes as CFDictionary, &amp;publickey)\n\n            if statusPublic == noErr {\n                let privatekeydata = _publickey as? Data\n                if let publicKeyDER = exportImportManager.exportPublicKeyToDER(privatekeydata!!, keyType: kSecAttrKeyTypeRSA as String, keySize: keySize) {\n\t\t            print(publicKeyDER.base64EncodedString())\n\t\t        }\n            }`","body":"exportImportManager.exportPublicKeyToDER  doesn&#39;t work for me <code>let statusPublic: OSStatus = SecItemCopyMatching(publicKeyAttributes as CFDictionary, &amp;publickey)              if statusPublic == noErr {                 let privatekeydata = _publickey as? Data                 if let publicKeyDER = exportImportManager.exportPublicKeyToDER(privatekeydata!!, keyType: kSecAttrKeyTypeRSA as String, keySize: keySize) { \t\t            print(publicKeyDER.base64EncodedString()) \t\t        }             }</code>"}],"tags":[],"owner":{"account_id":8497217,"reputation":37844,"user_id":6371459,"accept_rate":25,"display_name":"pedrofb"},"comment_count":2,"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1545593190,"creation_date":1545593190,"answer_id":53906561,"question_id":53906275,"body_markdown":"Java requires a public key encoded in DER format. Unfortunately iOS does not support this standard format and it is needed an additional conversion (I do not know if this will have improved in the latest versions of swift)\r\n\r\nSee my answer [here](https://stackoverflow.com/a/37736209/6371459) You can convert the key using [CryptoExportImportManager](https://github.com/DigitalLeaves/CryptoExportImportManager)\r\n\r\n    func exportPublicKeyToDER(keyId:String) -&gt; NSData?{\r\n\r\n        let publicKey = loadKeyStringFromKeyChainAsNSData(PUBLIC_KEY + keyId)\r\n        let keyType = kSecAttrKeyTypeRSA\r\n        let keySize = 2048\r\n        let exportImportManager = CryptoExportImportManager()\r\n        if let exportableDERKey = exportImportManager.exportPublicKeyToDER(publicKey, keyType: keyType as String, keySize: keySize) {\r\n            return exportableDERKey\r\n        } else {\r\n            return nil\r\n        }\r\n    }\r\n\r\n","title":"RSA public key created in iOS/Swift and exported as base64 not recognized in Java","body":"<p>Java requires a public key encoded in DER format. Unfortunately iOS does not support this standard format and it is needed an additional conversion (I do not know if this will have improved in the latest versions of swift)</p>\n\n<p>See my answer <a href=\"https://stackoverflow.com/a/37736209/6371459\">here</a> You can convert the key using <a href=\"https://github.com/DigitalLeaves/CryptoExportImportManager\" rel=\"noreferrer\">CryptoExportImportManager</a></p>\n\n<pre><code>func exportPublicKeyToDER(keyId:String) -&gt; NSData?{\n\n    let publicKey = loadKeyStringFromKeyChainAsNSData(PUBLIC_KEY + keyId)\n    let keyType = kSecAttrKeyTypeRSA\n    let keySize = 2048\n    let exportImportManager = CryptoExportImportManager()\n    if let exportableDERKey = exportImportManager.exportPublicKeyToDER(publicKey, keyType: keyType as String, keySize: keySize) {\n        return exportableDERKey\n    } else {\n        return nil\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":15470798,"reputation":151,"user_id":11588352,"display_name":"Next Increment"},"comment_count":0,"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1567853988,"creation_date":1559551064,"answer_id":56423749,"question_id":53906275,"body_markdown":"We ran into the exact same problem when connecting an iOS app to a Java backend. And the [CryptoExportImportManager](https://github.com/DigitalLeaves/CryptoExportImportManager) mentioned by _pedrofb_ helped us out too, which is awesome. However, the code in the `CryptoExportImportManager` class is a bit elaborated and might be hard to maintain. This is because a top-down approach is used when adding new components to the DER encoding. As a result, numbers contained by length fields must be calculated ahead (i.e. before the contents to which the length applies has been defined). I therefore created a new class that we now use to convert the DER encoding of an RSA public key:\r\n\r\n&lt;!-- language-all: lang-swift --&gt;\r\n\r\n    class RSAKeyEncoding: NSObject {\r\n\r\n      // ASN.1 identifiers\r\n      private let bitStringIdentifier: UInt8 = 0x03\r\n      private let sequenceIdentifier: UInt8 = 0x30\r\n\r\n      // ASN.1 AlgorithmIdentfier for RSA encryption: OID 1 2 840 113549 1 1 1 and NULL\r\n      private let algorithmIdentifierForRSAEncryption: [UInt8] = [0x30, 0x0d, 0x06,\r\n        0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05, 0x00]\r\n\r\n      /// Converts the DER encoding of an RSA public key that is either fetched from the\r\n      /// keychain (e.g. by using `SecItemCopyMatching(_:_:)`) or retrieved in another way\r\n      /// (e.g. by using `SecKeyCopyExternalRepresentation(_:_:)`), to a format typically\r\n      /// used by tools and programming languages outside the Apple ecosystem (such as\r\n      /// OpenSSL, Java, PHP and Perl). The DER encoding of an RSA public key created by\r\n      /// iOS is represented with the ASN.1 RSAPublicKey type as defined by PKCS #1.\r\n      /// However, many systems outside the Apple ecosystem expect the DER encoding of a\r\n      /// key to be represented with the ASN.1 SubjectPublicKeyInfo type as defined by\r\n      /// X.509. The two types are related in a way that if the SubjectPublicKeyInfo’s\r\n      /// algorithm field contains the rsaEncryption object identifier as defined by\r\n      /// PKCS #1, the subjectPublicKey field shall contain the DER encoding of an\r\n      /// RSAPublicKey type.\r\n      ///\r\n      /// - Parameter rsaPublicKeyData: A data object containing the DER encoding of an\r\n      ///     RSA public key, which is represented with the ASN.1 RSAPublicKey type.\r\n      /// - Returns: A data object containing the DER encoding of an RSA public key, which\r\n      ///     is represented with the ASN.1 SubjectPublicKeyInfo type.\r\n      func convertToX509EncodedKey(_ rsaPublicKeyData: Data) -&gt; Data {\r\n        var derEncodedKeyBytes = [UInt8](rsaPublicKeyData)\r\n\r\n        // Insert ASN.1 BIT STRING bytes at the beginning of the array\r\n        derEncodedKeyBytes.insert(0x00, at: 0)\r\n        derEncodedKeyBytes.insert(contentsOf: lengthField(of: derEncodedKeyBytes), at: 0)\r\n        derEncodedKeyBytes.insert(bitStringIdentifier, at: 0)\r\n\r\n        // Insert ASN.1 AlgorithmIdentifier bytes at the beginning of the array\r\n        derEncodedKeyBytes.insert(contentsOf: algorithmIdentifierForRSAEncryption, at: 0)\r\n\r\n        // Insert ASN.1 SEQUENCE bytes at the beginning of the array\r\n        derEncodedKeyBytes.insert(contentsOf: lengthField(of: derEncodedKeyBytes), at: 0)\r\n        derEncodedKeyBytes.insert(sequenceIdentifier, at: 0)\r\n\r\n        return Data(derEncodedKeyBytes)\r\n      }\r\n\r\n      private func lengthField(of valueField: [UInt8]) -&gt; [UInt8] {\r\n        var length = valueField.count\r\n\r\n        if length &lt; 128 {\r\n          return [ UInt8(length) ]\r\n        }\r\n\r\n        // Number of bytes needed to encode the length\r\n        let lengthBytesCount = Int((log2(Double(length)) / 8) + 1)\r\n\r\n        // First byte encodes the number of remaining bytes in this field\r\n        let firstLengthFieldByte = UInt8(128 + lengthBytesCount)\r\n\r\n        var lengthField: [UInt8] = []\r\n        for _ in 0..&lt;lengthBytesCount {\r\n          // Take the last 8 bits of length\r\n          let lengthByte = UInt8(length &amp; 0xff)\r\n          // Insert them at the beginning of the array\r\n          lengthField.insert(lengthByte, at: 0)\r\n          // Delete the last 8 bits of length\r\n          length = length &gt;&gt; 8\r\n        }\r\n\r\n        // Insert firstLengthFieldByte at the beginning of the array\r\n        lengthField.insert(firstLengthFieldByte, at: 0)\r\n\r\n        return lengthField\r\n      }\r\n    }\r\n\r\nUsage\r\n-----\r\n\r\nYou could use this class in the function `asBase64()` like this:\r\n\r\n    extension SecKey {\r\n      func asBase64() throws -&gt; String {\r\n        var dataPtr: CFTypeRef?\r\n        let query: [String:Any] = [\r\n          kSecClass as String: kSecClassKey,\r\n          kSecAttrApplicationTag as String: &quot;...&quot;, // Same unique tag here\r\n          kSecAttrKeyType as String: kSecAttrKeyTypeRSA,\r\n          kSecReturnData as String: kCFBooleanTrue\r\n        ]\r\n        let result = SecItemCopyMatching(query as CFDictionary, &amp;dataPtr)\r\n\r\n        switch (result, dataPtr) {\r\n        case (errSecSuccess, .some(let data)):\r\n\r\n          // convert to X509 encoded key\r\n          let convertedData = RSAKeyEncoding().convertToX509EncodedKey(data)\r\n\r\n          // convert to Base64 string\r\n          let base64PublicKey = convertedData.base64EncodedString(options: [])\r\n          return base64PublicKey\r\n        default:\r\n          throw CryptoError.keyConversionError\r\n        }\r\n      }\r\n    }\r\n\r\nUPDATE - Other Issue\r\n--------------------\r\n\r\nAfter using the above class for a while, we stumbled upon another issue. Occasionally, the public key that is fetched from the keychain seems to be invalid because, for some reason, it has grown in size. This behavior matches with findings described in the question (although in our case the Base64 encoded key has grown to a size of 392 characters instead of 360 characters). Unfortunately, we didn’t find the exact cause of this strange behavior, but we found two solutions. The first solution is to specify `kSecAttrKeySizeInBits` along with `kSecAttrEffectiveKeySize` when defining the query, like in the below code snippet:\r\n\r\n    let keySize = ... // Key size specified when storing the key, for example: 2048\r\n\r\n    let query: [String: Any] = [\r\n        kSecAttrKeySizeInBits as String: keySize,\r\n        kSecAttrEffectiveKeySize as String: keySize,\r\n        ... // More attributes\r\n    ]\r\n\r\n    var dataPtr: CFTypeRef?\r\n\r\n    let result = SecItemCopyMatching(query as CFDictionary, &amp;dataPtr)\r\n\r\nThe second solution is to always delete the old key from the keychain (if any) before adding a new key with the same tag.\r\n\r\nUPDATE - Alternative Solution\r\n-----------------------------\r\n\r\nI published [this project](https://github.com/nextincrement/rsa-public-key-importer-exporter) on GitHub that can be used as an alternative to the above class.\r\n\r\nReferences\r\n----------\r\n\r\n[A Layman’s Guide to a Subset of ASN.1, BER, and DER](http://luca.ntop.org/Teaching/Appunti/asn1.html)\r\n\r\n[RFC 5280](https://www.rfc-editor.org/rfc/rfc5280) (X.509 v3)\r\n\r\n[RFC 8017](https://www.rfc-editor.org/rfc/rfc8017) (PKCS #1 v2.2)\r\n\r\nSome code I found [here](https://github.com/airsidemobile/JOSESwift) inspired me when creating the `lengthField(...)` function.","title":"RSA public key created in iOS/Swift and exported as base64 not recognized in Java","body":"<p>We ran into the exact same problem when connecting an iOS app to a Java backend. And the <a href=\"https://github.com/DigitalLeaves/CryptoExportImportManager\" rel=\"noreferrer\">CryptoExportImportManager</a> mentioned by <em>pedrofb</em> helped us out too, which is awesome. However, the code in the <code>CryptoExportImportManager</code> class is a bit elaborated and might be hard to maintain. This is because a top-down approach is used when adding new components to the DER encoding. As a result, numbers contained by length fields must be calculated ahead (i.e. before the contents to which the length applies has been defined). I therefore created a new class that we now use to convert the DER encoding of an RSA public key:</p>\n\n<pre class=\"lang-swift prettyprint-override\"><code>class RSAKeyEncoding: NSObject {\n\n  // ASN.1 identifiers\n  private let bitStringIdentifier: UInt8 = 0x03\n  private let sequenceIdentifier: UInt8 = 0x30\n\n  // ASN.1 AlgorithmIdentfier for RSA encryption: OID 1 2 840 113549 1 1 1 and NULL\n  private let algorithmIdentifierForRSAEncryption: [UInt8] = [0x30, 0x0d, 0x06,\n    0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05, 0x00]\n\n  /// Converts the DER encoding of an RSA public key that is either fetched from the\n  /// keychain (e.g. by using `SecItemCopyMatching(_:_:)`) or retrieved in another way\n  /// (e.g. by using `SecKeyCopyExternalRepresentation(_:_:)`), to a format typically\n  /// used by tools and programming languages outside the Apple ecosystem (such as\n  /// OpenSSL, Java, PHP and Perl). The DER encoding of an RSA public key created by\n  /// iOS is represented with the ASN.1 RSAPublicKey type as defined by PKCS #1.\n  /// However, many systems outside the Apple ecosystem expect the DER encoding of a\n  /// key to be represented with the ASN.1 SubjectPublicKeyInfo type as defined by\n  /// X.509. The two types are related in a way that if the SubjectPublicKeyInfo’s\n  /// algorithm field contains the rsaEncryption object identifier as defined by\n  /// PKCS #1, the subjectPublicKey field shall contain the DER encoding of an\n  /// RSAPublicKey type.\n  ///\n  /// - Parameter rsaPublicKeyData: A data object containing the DER encoding of an\n  ///     RSA public key, which is represented with the ASN.1 RSAPublicKey type.\n  /// - Returns: A data object containing the DER encoding of an RSA public key, which\n  ///     is represented with the ASN.1 SubjectPublicKeyInfo type.\n  func convertToX509EncodedKey(_ rsaPublicKeyData: Data) -&gt; Data {\n    var derEncodedKeyBytes = [UInt8](rsaPublicKeyData)\n\n    // Insert ASN.1 BIT STRING bytes at the beginning of the array\n    derEncodedKeyBytes.insert(0x00, at: 0)\n    derEncodedKeyBytes.insert(contentsOf: lengthField(of: derEncodedKeyBytes), at: 0)\n    derEncodedKeyBytes.insert(bitStringIdentifier, at: 0)\n\n    // Insert ASN.1 AlgorithmIdentifier bytes at the beginning of the array\n    derEncodedKeyBytes.insert(contentsOf: algorithmIdentifierForRSAEncryption, at: 0)\n\n    // Insert ASN.1 SEQUENCE bytes at the beginning of the array\n    derEncodedKeyBytes.insert(contentsOf: lengthField(of: derEncodedKeyBytes), at: 0)\n    derEncodedKeyBytes.insert(sequenceIdentifier, at: 0)\n\n    return Data(derEncodedKeyBytes)\n  }\n\n  private func lengthField(of valueField: [UInt8]) -&gt; [UInt8] {\n    var length = valueField.count\n\n    if length &lt; 128 {\n      return [ UInt8(length) ]\n    }\n\n    // Number of bytes needed to encode the length\n    let lengthBytesCount = Int((log2(Double(length)) / 8) + 1)\n\n    // First byte encodes the number of remaining bytes in this field\n    let firstLengthFieldByte = UInt8(128 + lengthBytesCount)\n\n    var lengthField: [UInt8] = []\n    for _ in 0..&lt;lengthBytesCount {\n      // Take the last 8 bits of length\n      let lengthByte = UInt8(length &amp; 0xff)\n      // Insert them at the beginning of the array\n      lengthField.insert(lengthByte, at: 0)\n      // Delete the last 8 bits of length\n      length = length &gt;&gt; 8\n    }\n\n    // Insert firstLengthFieldByte at the beginning of the array\n    lengthField.insert(firstLengthFieldByte, at: 0)\n\n    return lengthField\n  }\n}\n</code></pre>\n<h2>Usage</h2>\n<p>You could use this class in the function <code>asBase64()</code> like this:</p>\n<pre class=\"lang-swift prettyprint-override\"><code>extension SecKey {\n  func asBase64() throws -&gt; String {\n    var dataPtr: CFTypeRef?\n    let query: [String:Any] = [\n      kSecClass as String: kSecClassKey,\n      kSecAttrApplicationTag as String: &quot;...&quot;, // Same unique tag here\n      kSecAttrKeyType as String: kSecAttrKeyTypeRSA,\n      kSecReturnData as String: kCFBooleanTrue\n    ]\n    let result = SecItemCopyMatching(query as CFDictionary, &amp;dataPtr)\n\n    switch (result, dataPtr) {\n    case (errSecSuccess, .some(let data)):\n\n      // convert to X509 encoded key\n      let convertedData = RSAKeyEncoding().convertToX509EncodedKey(data)\n\n      // convert to Base64 string\n      let base64PublicKey = convertedData.base64EncodedString(options: [])\n      return base64PublicKey\n    default:\n      throw CryptoError.keyConversionError\n    }\n  }\n}\n</code></pre>\n<h2>UPDATE - Other Issue</h2>\n<p>After using the above class for a while, we stumbled upon another issue. Occasionally, the public key that is fetched from the keychain seems to be invalid because, for some reason, it has grown in size. This behavior matches with findings described in the question (although in our case the Base64 encoded key has grown to a size of 392 characters instead of 360 characters). Unfortunately, we didn’t find the exact cause of this strange behavior, but we found two solutions. The first solution is to specify <code>kSecAttrKeySizeInBits</code> along with <code>kSecAttrEffectiveKeySize</code> when defining the query, like in the below code snippet:</p>\n<pre class=\"lang-swift prettyprint-override\"><code>let keySize = ... // Key size specified when storing the key, for example: 2048\n\nlet query: [String: Any] = [\n    kSecAttrKeySizeInBits as String: keySize,\n    kSecAttrEffectiveKeySize as String: keySize,\n    ... // More attributes\n]\n\nvar dataPtr: CFTypeRef?\n\nlet result = SecItemCopyMatching(query as CFDictionary, &amp;dataPtr)\n</code></pre>\n<p>The second solution is to always delete the old key from the keychain (if any) before adding a new key with the same tag.</p>\n<h2>UPDATE - Alternative Solution</h2>\n<p>I published <a href=\"https://github.com/nextincrement/rsa-public-key-importer-exporter\" rel=\"noreferrer\">this project</a> on GitHub that can be used as an alternative to the above class.</p>\n<h2>References</h2>\n<p><a href=\"http://luca.ntop.org/Teaching/Appunti/asn1.html\" rel=\"noreferrer\">A Layman’s Guide to a Subset of ASN.1, BER, and DER</a></p>\n<p><a href=\"https://www.rfc-editor.org/rfc/rfc5280\" rel=\"noreferrer\">RFC 5280</a> (X.509 v3)</p>\n<p><a href=\"https://www.rfc-editor.org/rfc/rfc8017\" rel=\"noreferrer\">RFC 8017</a> (PKCS #1 v2.2)</p>\n<p>Some code I found <a href=\"https://github.com/airsidemobile/JOSESwift\" rel=\"noreferrer\">here</a> inspired me when creating the <code>lengthField(...)</code> function.</p>\n"},{"tags":[],"owner":{"account_id":428143,"reputation":765,"user_id":810268,"display_name":"Olivier Michel"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700041889,"creation_date":1700041889,"answer_id":77486690,"question_id":53906275,"body_markdown":"If you are using a 2048-bit RSA key, exporting the X509 PEM public key is as simple as prepending the string `MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A` to the PKCS#1 PEM public key generated by iOS. Here is my code written in Objective-C which produces both the PKCS#1 (RSA PUBLIC KEY) and X509 (PUBLIC KEY) versions of the PEM file:\r\n```objectivec\r\nNSString* alias = @&quot;MyKeyAlias&quot;;\r\nNSData* tag = [alias dataUsingEncoding:NSUTF8StringEncoding];\r\n// delete any existing key pair with the same tag name\r\nNSDictionary *deleteQuery = @{\r\n  (id)kSecClass: (id)kSecClassKey,\r\n  (id)kSecAttrApplicationTag: tag,\r\n  (id)kSecAttrKeyType: (id)kSecAttrKeyTypeRSA\r\n};\r\nSecItemDelete((__bridge CFDictionaryRef)deleteQuery);\r\n// create a new key pair\r\nNSDictionary* attributes = @{\r\n  (id)kSecAttrKeyType: (id)kSecAttrKeyTypeRSA,\r\n  (id)kSecAttrKeySizeInBits: @2048,\r\n  (id)kSecPrivateKeyAttrs: @{(id)kSecAttrIsPermanent: @YES, (id)kSecAttrApplicationTag: tag}\r\n};\r\nCFErrorRef error = NULL;\r\nSecKeyRef privateKey = SecKeyCreateRandomKey((__bridge CFDictionaryRef)attributes, &amp;error);\r\nif (!privateKey) {\r\n  NSError *err = CFBridgingRelease(error);\r\n  NSString *message = [NSString stringWithFormat:@&quot;Cannot generate key pair: %@&quot;, [err localizedDescription]];\r\n  NSLog(message);\r\n} else {\r\n  SecKeyRef publicKey = SecKeyCopyPublicKey(privateKey);\r\n  if (!publicKey)\r\n    NSLog(@&quot;Cannot export public key&quot;);\r\n  else {\r\n    NSData* keyData = (NSData*)CFBridgingRelease(SecKeyCopyExternalRepresentation(publicKey, &amp;error));\r\n    if (!keyData)\r\n      NSLog(@&quot;Failed to export public key&quot;);\r\n    else {\r\n      NSLog(@&quot;-----BEGIN RSA PUBLIC KEY-----\\n%@\\n-----END RSA PUBLIC KEY-----\\n&quot;, [keyData base64EncodedStringWithOptions:0]];\r\n      NSString *pem_x509 = [NSString stringWithFormat:@&quot;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A%@&quot;, [keyData base64EncodedStringWithOptions:0]];\r\n      NSLog(@&quot;-----BEGIN PUBLIC KEY-----\\n%@\\n-----END PUBLIC KEY-----\\n&quot;, messageAsString:pem_x509];\r\n    }\r\n  }\r\n  CFRelease(privateKey);\r\n}\r\n```","title":"RSA public key created in iOS/Swift and exported as base64 not recognized in Java","body":"<p>If you are using a 2048-bit RSA key, exporting the X509 PEM public key is as simple as prepending the string <code>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A</code> to the PKCS#1 PEM public key generated by iOS. Here is my code written in Objective-C which produces both the PKCS#1 (RSA PUBLIC KEY) and X509 (PUBLIC KEY) versions of the PEM file:</p>\n<pre class=\"lang-objectivec prettyprint-override\"><code>NSString* alias = @&quot;MyKeyAlias&quot;;\nNSData* tag = [alias dataUsingEncoding:NSUTF8StringEncoding];\n// delete any existing key pair with the same tag name\nNSDictionary *deleteQuery = @{\n  (id)kSecClass: (id)kSecClassKey,\n  (id)kSecAttrApplicationTag: tag,\n  (id)kSecAttrKeyType: (id)kSecAttrKeyTypeRSA\n};\nSecItemDelete((__bridge CFDictionaryRef)deleteQuery);\n// create a new key pair\nNSDictionary* attributes = @{\n  (id)kSecAttrKeyType: (id)kSecAttrKeyTypeRSA,\n  (id)kSecAttrKeySizeInBits: @2048,\n  (id)kSecPrivateKeyAttrs: @{(id)kSecAttrIsPermanent: @YES, (id)kSecAttrApplicationTag: tag}\n};\nCFErrorRef error = NULL;\nSecKeyRef privateKey = SecKeyCreateRandomKey((__bridge CFDictionaryRef)attributes, &amp;error);\nif (!privateKey) {\n  NSError *err = CFBridgingRelease(error);\n  NSString *message = [NSString stringWithFormat:@&quot;Cannot generate key pair: %@&quot;, [err localizedDescription]];\n  NSLog(message);\n} else {\n  SecKeyRef publicKey = SecKeyCopyPublicKey(privateKey);\n  if (!publicKey)\n    NSLog(@&quot;Cannot export public key&quot;);\n  else {\n    NSData* keyData = (NSData*)CFBridgingRelease(SecKeyCopyExternalRepresentation(publicKey, &amp;error));\n    if (!keyData)\n      NSLog(@&quot;Failed to export public key&quot;);\n    else {\n      NSLog(@&quot;-----BEGIN RSA PUBLIC KEY-----\\n%@\\n-----END RSA PUBLIC KEY-----\\n&quot;, [keyData base64EncodedStringWithOptions:0]];\n      NSString *pem_x509 = [NSString stringWithFormat:@&quot;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A%@&quot;, [keyData base64EncodedStringWithOptions:0]];\n      NSLog(@&quot;-----BEGIN PUBLIC KEY-----\\n%@\\n-----END PUBLIC KEY-----\\n&quot;, messageAsString:pem_x509];\n    }\n  }\n  CFRelease(privateKey);\n}\n</code></pre>\n"}],"owner":{"account_id":541417,"reputation":71857,"user_id":148357,"accept_rate":75,"display_name":"Antonio"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4399,"favorite_count":0,"down_vote_count":0,"up_vote_count":9,"answer_count":3,"score":9,"last_activity_date":1700041889,"creation_date":1545591004,"question_id":53906275,"body_markdown":"*TL;DR: RSA public key generated in iOS and stored in the keychain, exported as base64 and sent to a java backend, is not recognized.*\r\n\r\nI&#39;m implementing a chat encryption feature in an iOS app, and I&#39;m using symmetric + asymmetric keys to handle it.\r\n\r\nWithout going too much into details, at backend I use the user&#39;s public key to encrypt a symmetric key used to encrypt and decrypt messages.\r\n\r\nI created two frameworks, respectively in Swift and in Java (backend) to handle key generation, encryption, decryption, etc. I also have tests for them, so I&#39;m 100% everything works as expected.\r\n\r\nHowever, it looks like the backend is unable to recognize the format of the public key passed from iOS. Using RSA both sides, this is the code I use in Swift to generate the key:\r\n\r\n\r\n    // private key parameters\r\n    static let privateKeyParams: [String : Any] = [\r\n    \t\tkSecAttrIsPermanent as String: true,\r\n    \t\tkSecAttrApplicationTag as String: &quot;...&quot; // I have a proper unique tag here\r\n    ]\r\n    \r\n    // public  key parameters\r\n    static let publicKeyParams: [String : Any] = [\r\n    \t\tkSecAttrIsPermanent as String: true,\r\n    \t\tkSecAttrApplicationTag as String: &quot;...&quot; // I have a proper unique tag here\r\n    ]\r\n    \r\n    // global parameters for our key generation\r\n    static let keyCreationParameters: [String : Any] = [\r\n    \t\tkSecAttrKeyType as String: kSecAttrKeyTypeRSA,\r\n    \t\tkSecAttrKeySizeInBits as String: 2048,\r\n    \t\tkSecPublicKeyAttrs as String: publicKeyParams,\r\n    \t\tkSecPrivateKeyAttrs as String: privateKeyParams\r\n    ]\r\n    \r\n    ...\r\n    \r\n    var publicKey, privateKey: SecKey?\r\n    let status = SecKeyGeneratePair(Constants.keyCreationParameters as CFDictionary, &amp;publicKey, &amp;privateKey)\r\n    \r\n\r\n\r\n\r\nI use specular code to read the keys from the keychain.\r\n\r\nThis is the piece of code I use to export the public key as a base64 string:\r\n\r\n    extension SecKey {\r\n      func asBase64() throws -&gt; String {\r\n        var dataPtr: CFTypeRef?\r\n        let query: [String:Any] = [\r\n          kSecClass as String: kSecClassKey,\r\n          kSecAttrApplicationTag as String: &quot;...&quot;, // Same unique tag here\r\n          kSecAttrKeyType as String: kSecAttrKeyTypeRSA,\r\n          kSecReturnData as String: kCFBooleanTrue\r\n        ]\r\n        let result = SecItemCopyMatching(query as CFDictionary, &amp;dataPtr)\r\n        \r\n        switch (result, dataPtr) {\r\n        case (errSecSuccess, .some(let data)):\r\n          // convert to Base64 string\r\n          let base64PublicKey = data.base64EncodedString(options: [])\r\n          return base64PublicKey\r\n        default:\r\n          throw CryptoError.keyConversionError\r\n        }\r\n      }\r\n    }\r\n\r\nAt backend level I use this Java code to convert the base64 string to a public key:\r\n\r\n    public PublicKey publicKeyFrom(String data) throws NoSuchAlgorithmException, InvalidKeySpecException {\r\n    \tbyte[] publicBytes = Base64.decodeBase64(data);\r\n    \tX509EncodedKeySpec keySpec = new X509EncodedKeySpec(publicBytes);\r\n    \tKeyFactory keyFactory = KeyFactory.getInstance(&quot;RSA&quot;);\r\n    \treturn keyFactory.generatePublic(keySpec);\r\n    }\r\n\r\nBut this fails at the last line, with this exception:\r\n\r\n    java.security.spec.InvalidKeySpecException: java.security.InvalidKeyException: IOException: algid parse error, not a sequence\r\n\r\nDoing some manual debugging, I noticed that the format of the public key is different - when I generate a key in iOS and then export as base 64, it looks like this:\r\n\r\n    MIIBCgKCAQEA4M/bRDdH0f6qFIXxOg13RHka+g4Yv8u9PpPp1IR6pSwrM1aq8B6cyKRwnLe/MOkvODvDfJzvGXGQ01zSTxYWAW1B4uc/NCEemCmZqMosSB/VUJdNxxWtt2hJxpz06hAawqV+6HmweAB2dUn9tDEsQLsNHdwYouOKpyRZGimcF9qRFn1RjR0Q54sUh1tQAj/EwmgY2S2bI5TqtZnZw7X7Waji7wWi6Gz88IkuzLAzB9VBNDeV1cfJFiWsZ/MIixSvhpW3dMNCrJShvBouIG8nS+vykBlbFVRGy3gJr8+OcmIq5vuHVhqrWwHNOs+WR87K/qTFO/CB7MiyiIV1b1x5DQIDAQAB\r\n\r\nfor a total of 360 characters, whereas doing the same in Java (still using RSA) it&#39;s like:\r\n\r\n    MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCAAnWO4BXUGP0qM3Op36YXkWNxb4I2pPZuZ7jJtfUO7v+IO1mq43WzNaxLqqLPkTnMrv2ACRDK55vin+leQlL1z0LzVxjtZ9F6pajQo1r7PqBlL5N8bzBFKpagEf0QfyHPw0/0kG9DMnvQ+Im881QyN2zdl33wp5Fi+jRT7cunFQIDAQAB\r\n\r\nwith a length of 216 characters.\r\n\r\nI&#39;m unable to figure out what&#39;s wrong - apparently I wouldn&#39;t be surprised if iOS handles keys in a different key, and require special processing in order to talk with other folks.\r\n\r\nAny idea?","title":"RSA public key created in iOS/Swift and exported as base64 not recognized in Java","body":"<p><em>TL;DR: RSA public key generated in iOS and stored in the keychain, exported as base64 and sent to a java backend, is not recognized.</em></p>\n\n<p>I'm implementing a chat encryption feature in an iOS app, and I'm using symmetric + asymmetric keys to handle it.</p>\n\n<p>Without going too much into details, at backend I use the user's public key to encrypt a symmetric key used to encrypt and decrypt messages.</p>\n\n<p>I created two frameworks, respectively in Swift and in Java (backend) to handle key generation, encryption, decryption, etc. I also have tests for them, so I'm 100% everything works as expected.</p>\n\n<p>However, it looks like the backend is unable to recognize the format of the public key passed from iOS. Using RSA both sides, this is the code I use in Swift to generate the key:</p>\n\n<pre><code>// private key parameters\nstatic let privateKeyParams: [String : Any] = [\n        kSecAttrIsPermanent as String: true,\n        kSecAttrApplicationTag as String: \"...\" // I have a proper unique tag here\n]\n\n// public  key parameters\nstatic let publicKeyParams: [String : Any] = [\n        kSecAttrIsPermanent as String: true,\n        kSecAttrApplicationTag as String: \"...\" // I have a proper unique tag here\n]\n\n// global parameters for our key generation\nstatic let keyCreationParameters: [String : Any] = [\n        kSecAttrKeyType as String: kSecAttrKeyTypeRSA,\n        kSecAttrKeySizeInBits as String: 2048,\n        kSecPublicKeyAttrs as String: publicKeyParams,\n        kSecPrivateKeyAttrs as String: privateKeyParams\n]\n\n...\n\nvar publicKey, privateKey: SecKey?\nlet status = SecKeyGeneratePair(Constants.keyCreationParameters as CFDictionary, &amp;publicKey, &amp;privateKey)\n</code></pre>\n\n<p>I use specular code to read the keys from the keychain.</p>\n\n<p>This is the piece of code I use to export the public key as a base64 string:</p>\n\n<pre><code>extension SecKey {\n  func asBase64() throws -&gt; String {\n    var dataPtr: CFTypeRef?\n    let query: [String:Any] = [\n      kSecClass as String: kSecClassKey,\n      kSecAttrApplicationTag as String: \"...\", // Same unique tag here\n      kSecAttrKeyType as String: kSecAttrKeyTypeRSA,\n      kSecReturnData as String: kCFBooleanTrue\n    ]\n    let result = SecItemCopyMatching(query as CFDictionary, &amp;dataPtr)\n\n    switch (result, dataPtr) {\n    case (errSecSuccess, .some(let data)):\n      // convert to Base64 string\n      let base64PublicKey = data.base64EncodedString(options: [])\n      return base64PublicKey\n    default:\n      throw CryptoError.keyConversionError\n    }\n  }\n}\n</code></pre>\n\n<p>At backend level I use this Java code to convert the base64 string to a public key:</p>\n\n<pre><code>public PublicKey publicKeyFrom(String data) throws NoSuchAlgorithmException, InvalidKeySpecException {\n    byte[] publicBytes = Base64.decodeBase64(data);\n    X509EncodedKeySpec keySpec = new X509EncodedKeySpec(publicBytes);\n    KeyFactory keyFactory = KeyFactory.getInstance(\"RSA\");\n    return keyFactory.generatePublic(keySpec);\n}\n</code></pre>\n\n<p>But this fails at the last line, with this exception:</p>\n\n<pre><code>java.security.spec.InvalidKeySpecException: java.security.InvalidKeyException: IOException: algid parse error, not a sequence\n</code></pre>\n\n<p>Doing some manual debugging, I noticed that the format of the public key is different - when I generate a key in iOS and then export as base 64, it looks like this:</p>\n\n<pre><code>MIIBCgKCAQEA4M/bRDdH0f6qFIXxOg13RHka+g4Yv8u9PpPp1IR6pSwrM1aq8B6cyKRwnLe/MOkvODvDfJzvGXGQ01zSTxYWAW1B4uc/NCEemCmZqMosSB/VUJdNxxWtt2hJxpz06hAawqV+6HmweAB2dUn9tDEsQLsNHdwYouOKpyRZGimcF9qRFn1RjR0Q54sUh1tQAj/EwmgY2S2bI5TqtZnZw7X7Waji7wWi6Gz88IkuzLAzB9VBNDeV1cfJFiWsZ/MIixSvhpW3dMNCrJShvBouIG8nS+vykBlbFVRGy3gJr8+OcmIq5vuHVhqrWwHNOs+WR87K/qTFO/CB7MiyiIV1b1x5DQIDAQAB\n</code></pre>\n\n<p>for a total of 360 characters, whereas doing the same in Java (still using RSA) it's like:</p>\n\n<pre><code>MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCAAnWO4BXUGP0qM3Op36YXkWNxb4I2pPZuZ7jJtfUO7v+IO1mq43WzNaxLqqLPkTnMrv2ACRDK55vin+leQlL1z0LzVxjtZ9F6pajQo1r7PqBlL5N8bzBFKpagEf0QfyHPw0/0kG9DMnvQ+Im881QyN2zdl33wp5Fi+jRT7cunFQIDAQAB\n</code></pre>\n\n<p>with a length of 216 characters.</p>\n\n<p>I'm unable to figure out what's wrong - apparently I wouldn't be surprised if iOS handles keys in a different key, and require special processing in order to talk with other folks.</p>\n\n<p>Any idea?</p>\n"},{"tags":["java","collections","indexing"],"comments":[{"owner":{"account_id":21994,"reputation":73808,"user_id":53897,"accept_rate":56,"display_name":"Thorbj&#248;rn Ravn Andersen"},"score":0,"creation_date":1269623438,"post_id":2501449,"comment_id":2523061,"body_markdown":"I do not fully understand what you mean by &quot;multiple indexes&quot;.  Do you want several different lookup methods - one per index - or do you want that e.g. HashMap uses a new Collection (e.g. a hashmap) for those entries with the same hash key?","body":"I do not fully understand what you mean by &quot;multiple indexes&quot;.  Do you want several different lookup methods - one per index - or do you want that e.g. HashMap uses a new Collection (e.g. a hashmap) for those entries with the same hash key?"},{"owner":{"account_id":110220,"reputation":37362,"user_id":291741,"accept_rate":87,"display_name":"Chris Lercher"},"score":0,"creation_date":1269626143,"post_id":2501449,"comment_id":2523473,"body_markdown":"It should be similar to what you can do with a database table: One primary key (e.g. `user_id`), plus other unique indexes (e.g. on `username`). Both can be used to access a user row. When the user is deleted, then the id and the username are removed from the indexes together with the entry.","body":"It should be similar to what you can do with a database table: One primary key (e.g. <code>user_id</code>), plus other unique indexes (e.g. on <code>username</code>). Both can be used to access a user row. When the user is deleted, then the id and the username are removed from the indexes together with the entry."},{"owner":{"display_name":"user177800"},"score":0,"creation_date":1269894309,"post_id":2501449,"comment_id":2541611,"body_markdown":"you just defined a in memory database, which your requirements state you don&#39;t want.","body":"you just defined a in memory database, which your requirements state you don&#39;t want."},{"owner":{"account_id":6664,"reputation":85927,"user_id":11296,"display_name":"Bert F"},"score":1,"creation_date":1270215861,"post_id":2501449,"comment_id":2571407,"body_markdown":"Related - &quot;How to implement a Map with multiple keys?&quot;  http://stackoverflow.com/questions/822322/how-to-implement-a-map-with-multiple-keys.  No clear solutions there either - it looks like some of the answers are for using a map with a composite key, but the OP there indicated he wants to be able look up by a single-value key.  Nevertheless, seems like a good idea to link the questions in the unlikely event a viable answer turns up over there later.  Also, if the OP here decides on a custom solution, this related question provides some additional ideas on potential implementations.","body":"Related - &quot;How to implement a Map with multiple keys?&quot;  <a href=\"http://stackoverflow.com/questions/822322/how-to-implement-a-map-with-multiple-keys\" title=\"how to implement a map with multiple keys\">stackoverflow.com/questions/822322/&hellip;</a>.  No clear solutions there either - it looks like some of the answers are for using a map with a composite key, but the OP there indicated he wants to be able look up by a single-value key.  Nevertheless, seems like a good idea to link the questions in the unlikely event a viable answer turns up over there later.  Also, if the OP here decides on a custom solution, this related question provides some additional ideas on potential implementations."},{"owner":{"account_id":3432851,"reputation":1818,"user_id":2876739,"display_name":"RickHigh"},"score":0,"creation_date":1383391010,"post_id":2501449,"comment_id":29332933,"body_markdown":"When a Value is removed, all index entries associated with that value must be removed. CHECK! Boon Repo does this.\nIndex lookup must be faster than linear search (at least as fast as a TreeMap). CHECK Boon Repo does this!\nSide conditions:\n\nNo dependencies on large (like Lucene) libraries. No uncommon or not well tested libraries. No database. Boon depends on nothing! CHECK! Boon Repo does all of this. And a lot more, and it is small and tight. :) http://richardhightower.github.io/site/Boon/Welcome.html","body":"When a Value is removed, all index entries associated with that value must be removed. CHECK! Boon Repo does this. Index lookup must be faster than linear search (at least as fast as a TreeMap). CHECK Boon Repo does this! Side conditions:  No dependencies on large (like Lucene) libraries. No uncommon or not well tested libraries. No database. Boon depends on nothing! CHECK! Boon Repo does all of this. And a lot more, and it is small and tight. :) <a href=\"http://richardhightower.github.io/site/Boon/Welcome.html\" rel=\"nofollow noreferrer\">richardhightower.github.io/site/Boon/Welcome.html</a>"},{"owner":{"account_id":166766,"reputation":1040,"user_id":391113,"accept_rate":82,"display_name":"decimus phostle"},"score":0,"creation_date":1390419258,"post_id":2501449,"comment_id":32086776,"body_markdown":"@ChrisLercher: Being a frequent (ab)user of the [Boost Multi-Index Container](http://www.boost.org/doc/libs/1_55_0/libs/multi_index/doc/index.html), not having that capability in Java seems quite crippling. In the (almost) three years since this question was first posed, has any decent/viable options emerged that are reasonably stable? (continued...)","body":"@ChrisLercher: Being a frequent (ab)user of the <a href=\"http://www.boost.org/doc/libs/1_55_0/libs/multi_index/doc/index.html\" rel=\"nofollow noreferrer\">Boost Multi-Index Container</a>, not having that capability in Java seems quite crippling. In the (almost) three years since this question was first posed, has any decent/viable options emerged that are reasonably stable? (continued...)"},{"owner":{"account_id":166766,"reputation":1040,"user_id":391113,"accept_rate":82,"display_name":"decimus phostle"},"score":0,"creation_date":1390419407,"post_id":2501449,"comment_id":32086852,"body_markdown":"I have briefly looked into this and my findings are: i) [CQEngine](https://code.google.com/p/cqengine/) seems to be the most promising at this time. ii) [Guava&#39;s Table](https://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Table) abstraction seems a bit limited. (continued...)","body":"I have briefly looked into this and my findings are: i) <a href=\"https://code.google.com/p/cqengine/\" rel=\"nofollow noreferrer\">CQEngine</a> seems to be the most promising at this time. ii) <a href=\"https://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Table\" rel=\"nofollow noreferrer\">Guava&#39;s Table</a> abstraction seems a bit limited. (continued...)"},{"owner":{"account_id":166766,"reputation":1040,"user_id":391113,"accept_rate":82,"display_name":"decimus phostle"},"score":0,"creation_date":1390419436,"post_id":2501449,"comment_id":32086876,"body_markdown":"iii) Neither did using filtering(say with [JFilter](https://code.google.com/p/jfilter/) or with [Guava Predicates](https://code.google.com/p/guava-libraries/wiki/FunctionalExplained#Predicates)) or using SQL-like([JoSQL](http://josql.sourceforge.net/)) abstractions seem as appealing. iv) [Boon](http://richardhightower.github.io/site/Boon/Welcome.html) seems promising, but at this time seems like a work-in-progress compared to CQEngine. (continued...)","body":"iii) Neither did using filtering(say with <a href=\"https://code.google.com/p/jfilter/\" rel=\"nofollow noreferrer\">JFilter</a> or with <a href=\"https://code.google.com/p/guava-libraries/wiki/FunctionalExplained#Predicates\" rel=\"nofollow noreferrer\">Guava Predicates</a>) or using SQL-like(<a href=\"http://josql.sourceforge.net/\" rel=\"nofollow noreferrer\">JoSQL</a>) abstractions seem as appealing. iv) <a href=\"http://richardhightower.github.io/site/Boon/Welcome.html\" rel=\"nofollow noreferrer\">Boon</a> seems promising, but at this time seems like a work-in-progress compared to CQEngine. (continued...)"},{"owner":{"account_id":166766,"reputation":1040,"user_id":391113,"accept_rate":82,"display_name":"decimus phostle"},"score":0,"creation_date":1390419477,"post_id":2501449,"comment_id":32086901,"body_markdown":"Please let me know if you or anyone else has any new insights/knowledge of alternate/better solutions. Thanks.","body":"Please let me know if you or anyone else has any new insights/knowledge of alternate/better solutions. Thanks."}],"answers":[{"comments":[{"owner":{"account_id":12478,"reputation":23673,"user_id":24582,"display_name":"extraneon"},"score":1,"creation_date":1269360656,"post_id":2501490,"comment_id":2496081,"body_markdown":"A Map is tricky though when the indexed values (the key of the map) can be double, e.g. are not unique. Then you&#39;d need Maps with Lists inside. It&#39;s the same problem with TreeSets with custom Comparators which was what I was thinking of- in implementation also a TreeMap :)","body":"A Map is tricky though when the indexed values (the key of the map) can be double, e.g. are not unique. Then you&#39;d need Maps with Lists inside. It&#39;s the same problem with TreeSets with custom Comparators which was what I was thinking of- in implementation also a TreeMap :)"},{"owner":{"account_id":7445,"reputation":62274,"user_id":12943,"accept_rate":84,"display_name":"Bill K"},"score":0,"creation_date":1269360658,"post_id":2501490,"comment_id":2496083,"body_markdown":"Good answer.  It wouldn&#39;t be too hard to create a library class with createIndex/destroyIndex where you pass createIndex a class that does nothing but implement equals and hash.  You&#39;d have to store an array of everything that&#39;s ever been added so that when someone called createIndex you could quickly add everything in your array into that new hash.  destroyIndex would just delete the hash.  Meh, doesn&#39;t seem worth it.  I guess that&#39;s why it&#39;s never been done.","body":"Good answer.  It wouldn&#39;t be too hard to create a library class with createIndex/destroyIndex where you pass createIndex a class that does nothing but implement equals and hash.  You&#39;d have to store an array of everything that&#39;s ever been added so that when someone called createIndex you could quickly add everything in your array into that new hash.  destroyIndex would just delete the hash.  Meh, doesn&#39;t seem worth it.  I guess that&#39;s why it&#39;s never been done."},{"owner":{"account_id":110220,"reputation":37362,"user_id":291741,"accept_rate":87,"display_name":"Chris Lercher"},"score":0,"creation_date":1269360699,"post_id":2501490,"comment_id":2496093,"body_markdown":"@cletus: Also not in any (small, common and well tested) library?","body":"@cletus: Also not in any (small, common and well tested) library?"},{"owner":{"account_id":110220,"reputation":37362,"user_id":291741,"accept_rate":87,"display_name":"Chris Lercher"},"score":3,"creation_date":1269360953,"post_id":2501490,"comment_id":2496130,"body_markdown":"@extraneon: The functionality &quot;Multiple values for one key&quot; is provided by Apache Commons Collections MultiMap https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/MultiMap.html","body":"@extraneon: The functionality &quot;Multiple values for one key&quot; is provided by Apache Commons Collections MultiMap <a href=\"https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/MultiMap.html\" rel=\"nofollow noreferrer\">commons.apache.org/proper/commons-collections/apidocs/org/&hellip;</a>"},{"owner":{"account_id":9867,"reputation":618201,"user_id":18393,"accept_rate":82,"display_name":"cletus"},"score":0,"creation_date":1269388721,"post_id":2501490,"comment_id":2499421,"body_markdown":"The multiple values per key problem can be solved in a number of ways: 1. use a multimap type data structure (requires external library like Google Collections) 2. Store buckets (probably a List) at each value or 3. use an alternate structure like a sorted List.","body":"The multiple values per key problem can be solved in a number of ways: 1. use a multimap type data structure (requires external library like Google Collections) 2. Store buckets (probably a List) at each value or 3. use an alternate structure like a sorted List."},{"owner":{"account_id":4596,"reputation":1302,"user_id":6973,"accept_rate":62,"display_name":"TREE"},"score":1,"creation_date":1269875577,"post_id":2501490,"comment_id":2539199,"body_markdown":"Sets (probably HashSets) are better than Lists for the buckets. You don&#39;t need order, and probably do need fast insertion, removal, and uniqueness checking.","body":"Sets (probably HashSets) are better than Lists for the buckets. You don&#39;t need order, and probably do need fast insertion, removal, and uniqueness checking."},{"owner":{"account_id":110220,"reputation":37362,"user_id":291741,"accept_rate":87,"display_name":"Chris Lercher"},"score":0,"creation_date":1270225720,"post_id":2501490,"comment_id":2572457,"body_markdown":"@cletus: You provided the first answer. At first I doubted it (can&#39;t be true ;-), but now I believe it.","body":"@cletus: You provided the first answer. At first I doubted it (can&#39;t be true ;-), but now I believe it."}],"tags":[],"owner":{"account_id":9867,"reputation":618201,"user_id":18393,"accept_rate":82,"display_name":"cletus"},"comment_count":7,"down_vote_count":1,"up_vote_count":25,"is_accepted":true,"score":24,"last_activity_date":1269360118,"creation_date":1269360118,"answer_id":2501490,"question_id":2501449,"body_markdown":"Each index will basically be a separate `Map`. You can (and probably should) abstract this behind a class that manages the searches, indexing, updates and removals for you. It wouldn&#39;t be hard to do this fairly generically. But no, there&#39;s no standard out of the box class for this although it can easily be built from the Java Collections classes.","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>Each index will basically be a separate <code>Map</code>. You can (and probably should) abstract this behind a class that manages the searches, indexing, updates and removals for you. It wouldn't be hard to do this fairly generically. But no, there's no standard out of the box class for this although it can easily be built from the Java Collections classes.</p>\n"},{"tags":[],"owner":{"account_id":36232,"reputation":26946,"user_id":103206,"accept_rate":67,"display_name":"Jay"},"comment_count":0,"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1269361698,"creation_date":1269361698,"answer_id":2501721,"question_id":2501449,"body_markdown":"My first thought would be to create a class for the thing being indexed, then create multiple HashMap&#39;s to hold the indexes, with the same object added to each of the HashMaps. For an add, you&#39;d then simply add the same object to each HashMap. A delete would require searching each HashMap for the reference to the destination object. If deletes need to be fast, you might want to create two HashMaps for each index: one for index-to-value and the other for value-to-index. Of course I&#39;d wrap whatever you do in a class with a clearly-defined interface.\r\n\r\nDoesn&#39;t seem like this would be hard. If you know the numbers and types of the indexes and the class of the widget up front, it would be pretty easy, like:\r\n\r\n    public class MultiIndex\r\n    {\r\n      HashMap&lt;String,Widget&gt; index1=new HashMap&lt;String,Widget&gt;();\r\n      HashMap&lt;String,Widget&gt; index2=new HashMap&lt;String,Widget&gt;();\r\n      HashMap&lt;Integer,Widget&gt; index3=new HashMap&lt;Integer,Widget&gt;();\r\n    \r\n      public void add(String index1Value, String index2Value, Integer index3Value, Widget widget)\r\n      {\r\n        index1.put(index1Value, widget);\r\n        index2.put(index2Value, widget);\r\n        index3.put(index3Value, widget);\r\n      }\r\n      public void delete(Widget widget)\r\n      {\r\n        Iterator i=index1.keySet().iterator(); \r\n        while (i.hasNext())\r\n        {\r\n          String index1Value=(String)i.next();\r\n          Widget gotWidget=(Widget) index1.get(index1Value);\r\n          if (gotWidget.equals(widget))\r\n            i.remove();\r\n        }\r\n        ... similarly for other indexes ...\r\n      }\r\n      public Widget getByIndex1(String index1Value)\r\n      {\r\n        return index1.get(index1Value);\r\n      }\r\n      ... similarly for other indexes ...\r\n    \r\n      }\r\n    }\r\n\r\nIf you want to make it generic and accept any object, have variable number and types of indexes, etc., it&#39;s a little more complicated, but not much.\r\n","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>My first thought would be to create a class for the thing being indexed, then create multiple HashMap's to hold the indexes, with the same object added to each of the HashMaps. For an add, you'd then simply add the same object to each HashMap. A delete would require searching each HashMap for the reference to the destination object. If deletes need to be fast, you might want to create two HashMaps for each index: one for index-to-value and the other for value-to-index. Of course I'd wrap whatever you do in a class with a clearly-defined interface.</p>\n\n<p>Doesn't seem like this would be hard. If you know the numbers and types of the indexes and the class of the widget up front, it would be pretty easy, like:</p>\n\n<pre><code>public class MultiIndex\n{\n  HashMap&lt;String,Widget&gt; index1=new HashMap&lt;String,Widget&gt;();\n  HashMap&lt;String,Widget&gt; index2=new HashMap&lt;String,Widget&gt;();\n  HashMap&lt;Integer,Widget&gt; index3=new HashMap&lt;Integer,Widget&gt;();\n\n  public void add(String index1Value, String index2Value, Integer index3Value, Widget widget)\n  {\n    index1.put(index1Value, widget);\n    index2.put(index2Value, widget);\n    index3.put(index3Value, widget);\n  }\n  public void delete(Widget widget)\n  {\n    Iterator i=index1.keySet().iterator(); \n    while (i.hasNext())\n    {\n      String index1Value=(String)i.next();\n      Widget gotWidget=(Widget) index1.get(index1Value);\n      if (gotWidget.equals(widget))\n        i.remove();\n    }\n    ... similarly for other indexes ...\n  }\n  public Widget getByIndex1(String index1Value)\n  {\n    return index1.get(index1Value);\n  }\n  ... similarly for other indexes ...\n\n  }\n}\n</code></pre>\n\n<p>If you want to make it generic and accept any object, have variable number and types of indexes, etc., it's a little more complicated, but not much.</p>\n"},{"comments":[{"owner":{"account_id":110220,"reputation":37362,"user_id":291741,"accept_rate":87,"display_name":"Chris Lercher"},"score":0,"creation_date":1269784294,"post_id":2531604,"comment_id":2532409,"body_markdown":"@Jared Levy: Thanks, good to hear, that Guava is considering this topic! I&#39;m considering to switch from Apache Commons Collections to Guava :-) Can you expand a little bit on the usage of the table interface? At first glance, it looks more like it provides something similar to what a composite primary key for a database table does (where you have to get *both* parts of the key right to access the value)? Or does it also provide multiple indexes (where you choose *one* part of the key, and then only need to get that part right to access the value)?","body":"@Jared Levy: Thanks, good to hear, that Guava is considering this topic! I&#39;m considering to switch from Apache Commons Collections to Guava :-) Can you expand a little bit on the usage of the table interface? At first glance, it looks more like it provides something similar to what a composite primary key for a database table does (where you have to get <i>both</i> parts of the key right to access the value)? Or does it also provide multiple indexes (where you choose <i>one</i> part of the key, and then only need to get that part right to access the value)?"},{"owner":{"account_id":50088,"reputation":2016,"user_id":149282,"display_name":"Jared Levy"},"score":0,"creation_date":1269801243,"post_id":2531604,"comment_id":2533513,"body_markdown":"You can specify 0, 1, or 2 keys when accessing a Table.\n\nUnfortunately, it might be a while until we open-source it.","body":"You can specify 0, 1, or 2 keys when accessing a Table.  Unfortunately, it might be a while until we open-source it."},{"owner":{"account_id":110220,"reputation":37362,"user_id":291741,"accept_rate":87,"display_name":"Chris Lercher"},"score":0,"creation_date":1269805718,"post_id":2531604,"comment_id":2533789,"body_markdown":"That&#39;s a nice data structure, which I believe will show its strength especially, when applied recursively (tables in tables)! It seems to be different from the structure I&#39;m looking for in this question, though. Jay&#39;s example is what I&#39;m basically looking for (multiple *unique* indexes; delete an element, and it&#39;s deleted from all indexes) But I want to find something like that in a common library, because lots of people seem to find it strikingly normal, that they have to re-implement the same thing over and over again.","body":"That&#39;s a nice data structure, which I believe will show its strength especially, when applied recursively (tables in tables)! It seems to be different from the structure I&#39;m looking for in this question, though. Jay&#39;s example is what I&#39;m basically looking for (multiple <i>unique</i> indexes; delete an element, and it&#39;s deleted from all indexes) But I want to find something like that in a common library, because lots of people seem to find it strikingly normal, that they have to re-implement the same thing over and over again."}],"tags":[],"owner":{"account_id":50088,"reputation":2016,"user_id":149282,"display_name":"Jared Levy"},"comment_count":3,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1269801413,"creation_date":1269740456,"answer_id":2531604,"question_id":2501449,"body_markdown":"I&#39;ve written a Table interface that includes methods like \r\n\r\n    V put(R rowKey, C columnKey, V value) \r\n    V get(Object rowKey, Object columnKey) \r\n    Map&lt;R,V&gt; column(C columnKey) \r\n    Set&lt;C&gt; columnKeySet()\r\n    Map&lt;C,V&gt; row(R rowKey)\r\n    Set&lt;R&gt; rowKeySet()\r\n    Set&lt;Table.Cell&lt;R,C,V&gt;&gt; cellSet()\r\n\r\nWe&#39;d like to include it in a future Guava release, but I don&#39;t know when that would happen.\r\nhttp://code.google.com/p/guava-libraries/issues/detail?id=173","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>I've written a Table interface that includes methods like </p>\n\n<pre><code>V put(R rowKey, C columnKey, V value) \nV get(Object rowKey, Object columnKey) \nMap&lt;R,V&gt; column(C columnKey) \nSet&lt;C&gt; columnKeySet()\nMap&lt;C,V&gt; row(R rowKey)\nSet&lt;R&gt; rowKeySet()\nSet&lt;Table.Cell&lt;R,C,V&gt;&gt; cellSet()\n</code></pre>\n\n<p>We'd like to include it in a future Guava release, but I don't know when that would happen.\n<a href=\"http://code.google.com/p/guava-libraries/issues/detail?id=173\" rel=\"nofollow noreferrer\">http://code.google.com/p/guava-libraries/issues/detail?id=173</a></p>\n"},{"tags":[],"owner":{"account_id":43546,"reputation":33497,"user_id":127359,"accept_rate":85,"display_name":"Arthur Ronald"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1269892981,"creation_date":1269892981,"answer_id":2540868,"question_id":2501449,"body_markdown":"[Google Collections][1] [LinkedListMultimap][2]\r\n\r\nAbout your first requirement\r\n\r\n - When a Value is removed, all index entries associated with that value must be removed.\r\n\r\nI think There is neither a library nor a Helper that supports it.\r\n\r\nHere is how i have done by using LinkedListMultimap\r\n\r\n    Multimap&lt;Integer, String&gt; multimap = LinkedListMultimap.create();\r\n\r\n    // Three duplicates entries\r\n    multimap.put(1, &quot;A&quot;);\r\n    multimap.put(2, &quot;B&quot;);\r\n    multimap.put(1, &quot;A&quot;);\r\n    multimap.put(4, &quot;C&quot;);\r\n    multimap.put(1, &quot;A&quot;);\r\n\r\n    System.out.println(multimap.size()); // outputs 5\r\n\r\nTo get your first requirement, a Helper can play a good job\r\n\r\n    public static &lt;K, V&gt; void removeAllIndexEntriesAssociatedWith(Multimap&lt;K, V&gt; multimap, V value) {\r\n        Collection&lt;Map.Entry&lt;K, V&gt;&gt; eCollection = multimap.entries();\r\n        for (Map.Entry&lt;K, V&gt; entry : eCollection)\r\n            if(entry.getValue().equals(value))\r\n                eCollection.remove(entry);\r\n    }\r\n    \r\n...\r\n \r\n    removeAllIndexEntriesAssociatedWith(multimap, &quot;A&quot;);\r\n\r\n    System.out.println(multimap.size()); // outputs 2\r\n\r\nGoogle collections is\r\n\r\n - lightweight\r\n - Supported by Joshua Block (Effective Java)\r\n - Nice features as ImmutableList, ImmutableMap and so on\r\n\r\n\r\n  [1]: http://code.google.com/p/google-collections/\r\n  [2]: http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/LinkedListMultimap.html#entries%28%29","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p><a href=\"http://code.google.com/p/google-collections/\" rel=\"nofollow noreferrer\">Google Collections</a> <a href=\"http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/LinkedListMultimap.html#entries%28%29\" rel=\"nofollow noreferrer\">LinkedListMultimap</a></p>\n\n<p>About your first requirement</p>\n\n<ul>\n<li>When a Value is removed, all index entries associated with that value must be removed.</li>\n</ul>\n\n<p>I think There is neither a library nor a Helper that supports it.</p>\n\n<p>Here is how i have done by using LinkedListMultimap</p>\n\n<pre><code>Multimap&lt;Integer, String&gt; multimap = LinkedListMultimap.create();\n\n// Three duplicates entries\nmultimap.put(1, \"A\");\nmultimap.put(2, \"B\");\nmultimap.put(1, \"A\");\nmultimap.put(4, \"C\");\nmultimap.put(1, \"A\");\n\nSystem.out.println(multimap.size()); // outputs 5\n</code></pre>\n\n<p>To get your first requirement, a Helper can play a good job</p>\n\n<pre><code>public static &lt;K, V&gt; void removeAllIndexEntriesAssociatedWith(Multimap&lt;K, V&gt; multimap, V value) {\n    Collection&lt;Map.Entry&lt;K, V&gt;&gt; eCollection = multimap.entries();\n    for (Map.Entry&lt;K, V&gt; entry : eCollection)\n        if(entry.getValue().equals(value))\n            eCollection.remove(entry);\n}\n</code></pre>\n\n<p>...</p>\n\n<pre><code>removeAllIndexEntriesAssociatedWith(multimap, \"A\");\n\nSystem.out.println(multimap.size()); // outputs 2\n</code></pre>\n\n<p>Google collections is</p>\n\n<ul>\n<li>lightweight</li>\n<li>Supported by Joshua Block (Effective Java)</li>\n<li>Nice features as ImmutableList, ImmutableMap and so on</li>\n</ul>\n"},{"comments":[{"owner":{"account_id":110220,"reputation":37362,"user_id":291741,"accept_rate":87,"display_name":"Chris Lercher"},"score":1,"creation_date":1269896859,"post_id":2541012,"comment_id":2541937,"body_markdown":"That&#39;s a very good point: I need part of the functionality of a database in memory! I don&#39;t need ACID, I don&#39;t even need multiple tables, I don&#39;t need to access it using a comfortable query language. But I do need one piece of it: Multiple unique indexes. It&#39;s possible, that Space4J is currently the best answer to that. I must admit, that I haven&#39;t heard of that project before - +1 for the link! However, I do think, that the problem is very common, just as common as invoking a &quot;CREATE UNIQUE INDEX ... ON ...&quot; in SQL.","body":"That&#39;s a very good point: I need part of the functionality of a database in memory! I don&#39;t need ACID, I don&#39;t even need multiple tables, I don&#39;t need to access it using a comfortable query language. But I do need one piece of it: Multiple unique indexes. It&#39;s possible, that Space4J is currently the best answer to that. I must admit, that I haven&#39;t heard of that project before - +1 for the link! However, I do think, that the problem is very common, just as common as invoking a &quot;CREATE UNIQUE INDEX ... ON ...&quot; in SQL."},{"owner":{"account_id":42768,"reputation":6215,"user_id":124708,"accept_rate":79,"display_name":"TraderJoeChicago"},"score":3,"creation_date":1315500600,"post_id":2541012,"comment_id":8869135,"body_markdown":"Space4J has a good approach to indexation, because even in memory you may want indexed searches when your table starts to grow. Take a look here: http://forum.space4j.org/posts/list/5.page","body":"Space4J has a good approach to indexation, because even in memory you may want indexed searches when your table starts to grow. Take a look here: <a href=\"http://forum.space4j.org/posts/list/5.page\" rel=\"nofollow noreferrer\">forum.space4j.org/posts/list/5.page</a>"}],"tags":[],"owner":{"display_name":"user177800"},"comment_count":2,"down_vote_count":1,"up_vote_count":6,"is_accepted":false,"score":5,"last_activity_date":1269897106,"creation_date":1269894241,"answer_id":2541012,"question_id":2501449,"body_markdown":"You have a lot of really constrictive requirements are appear to be very particular to your needs. Most of the things you are saying aren&#39;t viable are because a lot so of people have the same exact needs which basically defines a basic database engine. That is why they are &quot;large&quot; libraries. You say &quot;no database&quot; but at its core every indexing system is a &quot;database&quot; of terms and documents. I would argue that a Collection is a &quot;database&quot;. I would say take a look at [Space4J][1].  \r\n\r\nI would say if you don&#39;t find what you are looking for, start a project on GitHub and get on with coding it yourself and sharing the results.\r\n\r\n\r\n  [1]: http://www.space4j.org/","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>You have a lot of really constrictive requirements are appear to be very particular to your needs. Most of the things you are saying aren't viable are because a lot so of people have the same exact needs which basically defines a basic database engine. That is why they are \"large\" libraries. You say \"no database\" but at its core every indexing system is a \"database\" of terms and documents. I would argue that a Collection is a \"database\". I would say take a look at <a href=\"http://www.space4j.org/\" rel=\"nofollow noreferrer\">Space4J</a>.  </p>\n\n<p>I would say if you don't find what you are looking for, start a project on GitHub and get on with coding it yourself and sharing the results.</p>\n"},{"comments":[{"owner":{"account_id":56079,"reputation":7550,"user_id":167973,"accept_rate":82,"display_name":"Carl"},"score":0,"creation_date":1269898515,"post_id":2541424,"comment_id":2542114,"body_markdown":"note, this does not do multiple values per key, but could straightforwardly enough with forward being a multimap, and adding a get(Object...keys) method which also did some collection intersection operations.","body":"note, this does not do multiple values per key, but could straightforwardly enough with forward being a multimap, and adding a get(Object...keys) method which also did some collection intersection operations."},{"owner":{"account_id":1649573,"reputation":1949,"user_id":1520422,"accept_rate":36,"display_name":"Frederic Leitenberger"},"score":0,"creation_date":1486748291,"post_id":2541424,"comment_id":71495744,"body_markdown":"This implementation does not support modification via `entrySet()`, `values()` and `keySet()`. These methods offer `clear()` and `iterator().remove()` and Entry&#39;s have `setValue(...)`. And i probably missed some more. All these modifications are not considered in the index.","body":"This implementation does not support modification via <code>entrySet()</code>, <code>values()</code> and <code>keySet()</code>. These methods offer <code>clear()</code> and <code>iterator().remove()</code> and Entry&#39;s have <code>setValue(...)</code>. And i probably missed some more. All these modifications are not considered in the index."}],"tags":[],"owner":{"account_id":56079,"reputation":7550,"user_id":167973,"accept_rate":82,"display_name":"Carl"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1269898249,"creation_date":1269898249,"answer_id":2541424,"question_id":2501449,"body_markdown":"I&#39;m not sure I understand the question, but I think what you&#39;re asking for is multiple ways to map from different, unique keys to values and appropriate clean-up when a value goes away.\r\n\r\nI see that you don&#39;t want to roll your own, but there&#39;s a simple enough composition of map and multimap (I used the Guava multimap below, but the Apache one should work as well) to do what you want.  I have a quick and dirty solution below (skipped the constructors, since that depends on what sort of underlying map/multimap you want to use):\r\n\r\n    package edu.cap10.common.collect;\r\n    \r\n    import java.util.Collection;\r\n    import java.util.Map;\r\n    \r\n    import com.google.common.collect.ForwardingMap;\r\n    import com.google.common.collect.Multimap;\r\n    \r\n    public class MIndexLookupMap&lt;T&gt; extends ForwardingMap&lt;Object,T&gt;{\r\n    \r\n    \tMap&lt;Object,T&gt; delegate;\r\n    \tMultimap&lt;T,Object&gt; reverse;\r\n    \t\r\n    \t@Override protected Map&lt;Object, T&gt; delegate() { return delegate; }\r\n    \r\n    \t@Override public void clear() {\r\n    \t\tdelegate.clear();\r\n    \t\treverse.clear();\r\n    \t}\r\n    \r\n    \t@Override public boolean containsValue(Object value) { return reverse.containsKey(value); }\r\n    \r\n    \t@Override public T put(Object key, T value) {\r\n    \t\tif (containsKey(key) &amp;&amp; !get(key).equals(value)) reverse.remove(get(key), key); \r\n    \t\treverse.put(value, key);\r\n    \t\treturn delegate.put(key, value);\r\n    \t}\r\n    \r\n    \t@Override public void putAll(Map&lt;? extends Object, ? extends T&gt; m) {\r\n    \t\tfor (Entry&lt;? extends Object,? extends T&gt; e : m.entrySet()) put(e.getKey(),e.getValue());\r\n    \t}\r\n    \r\n    \tpublic T remove(Object key) {\r\n    \t\tT result = delegate.remove(key);\r\n    \t\treverse.remove(result, key);\r\n    \t\treturn result;\r\n    \t}\r\n    \t\r\n    \tpublic void removeValue(T value) {\r\n    \t\tfor (Object key : reverse.removeAll(value)) delegate.remove(key);\r\n    \t}\r\n    \r\n    \tpublic Collection&lt;T&gt; values() {\r\n    \t\treturn reverse.keySet();\r\n    \t}\t\r\n    \t\r\n    }\r\n\r\nremoval is O(number of keys), but everything else is the same order as a typical map implementation (some extra constant scaling, since you also have to add things to the reverse).\r\n\r\nI just used `Object` keys (should be fine with appropriate implementations of `equals()` and `hashCode()` and key distinction) - but you could also have a more specific type of key. ","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>I'm not sure I understand the question, but I think what you're asking for is multiple ways to map from different, unique keys to values and appropriate clean-up when a value goes away.</p>\n\n<p>I see that you don't want to roll your own, but there's a simple enough composition of map and multimap (I used the Guava multimap below, but the Apache one should work as well) to do what you want.  I have a quick and dirty solution below (skipped the constructors, since that depends on what sort of underlying map/multimap you want to use):</p>\n\n<pre><code>package edu.cap10.common.collect;\n\nimport java.util.Collection;\nimport java.util.Map;\n\nimport com.google.common.collect.ForwardingMap;\nimport com.google.common.collect.Multimap;\n\npublic class MIndexLookupMap&lt;T&gt; extends ForwardingMap&lt;Object,T&gt;{\n\n    Map&lt;Object,T&gt; delegate;\n    Multimap&lt;T,Object&gt; reverse;\n\n    @Override protected Map&lt;Object, T&gt; delegate() { return delegate; }\n\n    @Override public void clear() {\n        delegate.clear();\n        reverse.clear();\n    }\n\n    @Override public boolean containsValue(Object value) { return reverse.containsKey(value); }\n\n    @Override public T put(Object key, T value) {\n        if (containsKey(key) &amp;&amp; !get(key).equals(value)) reverse.remove(get(key), key); \n        reverse.put(value, key);\n        return delegate.put(key, value);\n    }\n\n    @Override public void putAll(Map&lt;? extends Object, ? extends T&gt; m) {\n        for (Entry&lt;? extends Object,? extends T&gt; e : m.entrySet()) put(e.getKey(),e.getValue());\n    }\n\n    public T remove(Object key) {\n        T result = delegate.remove(key);\n        reverse.remove(result, key);\n        return result;\n    }\n\n    public void removeValue(T value) {\n        for (Object key : reverse.removeAll(value)) delegate.remove(key);\n    }\n\n    public Collection&lt;T&gt; values() {\n        return reverse.keySet();\n    }   \n\n}\n</code></pre>\n\n<p>removal is O(number of keys), but everything else is the same order as a typical map implementation (some extra constant scaling, since you also have to add things to the reverse).</p>\n\n<p>I just used <code>Object</code> keys (should be fine with appropriate implementations of <code>equals()</code> and <code>hashCode()</code> and key distinction) - but you could also have a more specific type of key. </p>\n"},{"tags":[],"owner":{"account_id":8546,"reputation":17688,"user_id":15472,"accept_rate":87,"display_name":"tucuxi"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1269986590,"creation_date":1269986590,"answer_id":2549060,"question_id":2501449,"body_markdown":"Use [Prefuse][1] [Tables][2]. They support as many indices as you want, are fast (indices are TreeMaps), and have nice filtering options (boolean filters? no problem!). No database required, tested with large data-sets in many information visualization applications. \r\n\r\nIn their raw form, they are not as convenient as standard containers (you need to deal with rows and columns), but you can surely write a small wrapper around that. Plus, they plug nicely into UI components such as Swing&#39;s JTables.\r\n\r\n  [1]: http://prefuse.org/\r\n  [2]: http://prefuse.org/doc/api/prefuse/data/Table.html","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>Use <a href=\"http://prefuse.org/\" rel=\"nofollow noreferrer\">Prefuse</a> <a href=\"http://prefuse.org/doc/api/prefuse/data/Table.html\" rel=\"nofollow noreferrer\">Tables</a>. They support as many indices as you want, are fast (indices are TreeMaps), and have nice filtering options (boolean filters? no problem!). No database required, tested with large data-sets in many information visualization applications. </p>\n\n<p>In their raw form, they are not as convenient as standard containers (you need to deal with rows and columns), but you can surely write a small wrapper around that. Plus, they plug nicely into UI components such as Swing's JTables.</p>\n"},{"comments":[{"owner":{"account_id":110220,"reputation":37362,"user_id":291741,"accept_rate":87,"display_name":"Chris Lercher"},"score":0,"creation_date":1270222155,"post_id":2567407,"comment_id":2572065,"body_markdown":"These are good points about things to consider when writing an implementation (+1).","body":"These are good points about things to consider when writing an implementation (+1)."}],"tags":[],"owner":{"account_id":600464,"reputation":345,"user_id":294905,"display_name":"Anon"},"comment_count":1,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1270221883,"creation_date":1270221336,"answer_id":2567407,"question_id":2501449,"body_markdown":"Your main goal seems to be that you&#39;ll remove the object from all indexes when you remove it from one.\r\n\r\nThe simplest approach will be to add another layer of indirection: you store your actual object in a `Map&lt;Long,Value&gt;`, and use a bidirectional map (which you&#39;ll find in Jakarta Commons and probably Google Code) for your indexes as `Map&lt;Key,Long&gt;`. When you remove an entry from a particular index, you&#39;ll take the `Long` value from that index and use it to remove the corresponding entries from the main map and the other indexes.\r\n\r\nOne alternative to the BIDIMap is to define your &quot;index&quot; maps as `Map&lt;Key,WeakReference&lt;Long&gt;&gt;`; however, this will require you to implement a `ReferenceQueue` for cleanup.\r\n\r\n----\r\n\r\nAnother alternative is to create a key object that can take an arbitrary tuple, define its `equals()` method to match on any element in the tuple, and use that with a `TreeMap`. You can&#39;t use a `HashMap`, because you won&#39;t be able to compute a hashcode based on just one element of the tuple.\r\n\r\n    public class MultiKey\r\n    implements Comparable&lt;Object&gt;\r\n    {\r\n       private Comparable&lt;?&gt;[] _keys;\r\n       private Comparable _matchKey;\r\n       private int _matchPosition;\r\n    \r\n       /**\r\n        *  This constructor is for inserting values into the map.\r\n        */\r\n       public MultiKey(Comparable&lt;?&gt;... keys)\r\n       {\r\n          // yes, this is making the object dependent on externally-changable\r\n          // data; if you&#39;re paranoid, copy the array\r\n          _keys = keys;\r\n       }\r\n    \r\n    \r\n       /**\r\n        *  This constructor is for map probes.\r\n        */\r\n       public MultiKey(Comparable key, int position)\r\n       {\r\n          _matchKey = key;\r\n          _matchPosition = position;\r\n       }\r\n    \r\n    \r\n       @Override\r\n       public boolean equals(Object obj)\r\n       {\r\n          // verify that obj != null and is castable to MultiKey\r\n          if (_keys != null)\r\n          {\r\n             // check every element\r\n          }\r\n          else\r\n          {\r\n             // check single element\r\n          }\r\n       }\r\n    \r\n    \r\n       public int compareTo(Object o)\r\n       {\r\n          // follow same pattern as equals()\r\n       }\r\n    }\r\n\r\n ","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>Your main goal seems to be that you'll remove the object from all indexes when you remove it from one.</p>\n\n<p>The simplest approach will be to add another layer of indirection: you store your actual object in a <code>Map&lt;Long,Value&gt;</code>, and use a bidirectional map (which you'll find in Jakarta Commons and probably Google Code) for your indexes as <code>Map&lt;Key,Long&gt;</code>. When you remove an entry from a particular index, you'll take the <code>Long</code> value from that index and use it to remove the corresponding entries from the main map and the other indexes.</p>\n\n<p>One alternative to the BIDIMap is to define your \"index\" maps as <code>Map&lt;Key,WeakReference&lt;Long&gt;&gt;</code>; however, this will require you to implement a <code>ReferenceQueue</code> for cleanup.</p>\n\n<hr>\n\n<p>Another alternative is to create a key object that can take an arbitrary tuple, define its <code>equals()</code> method to match on any element in the tuple, and use that with a <code>TreeMap</code>. You can't use a <code>HashMap</code>, because you won't be able to compute a hashcode based on just one element of the tuple.</p>\n\n<pre><code>public class MultiKey\nimplements Comparable&lt;Object&gt;\n{\n   private Comparable&lt;?&gt;[] _keys;\n   private Comparable _matchKey;\n   private int _matchPosition;\n\n   /**\n    *  This constructor is for inserting values into the map.\n    */\n   public MultiKey(Comparable&lt;?&gt;... keys)\n   {\n      // yes, this is making the object dependent on externally-changable\n      // data; if you're paranoid, copy the array\n      _keys = keys;\n   }\n\n\n   /**\n    *  This constructor is for map probes.\n    */\n   public MultiKey(Comparable key, int position)\n   {\n      _matchKey = key;\n      _matchPosition = position;\n   }\n\n\n   @Override\n   public boolean equals(Object obj)\n   {\n      // verify that obj != null and is castable to MultiKey\n      if (_keys != null)\n      {\n         // check every element\n      }\n      else\n      {\n         // check single element\n      }\n   }\n\n\n   public int compareTo(Object o)\n   {\n      // follow same pattern as equals()\n   }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":148949,"reputation":361,"user_id":361092,"accept_rate":80,"display_name":"Fekete Kamosh"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1300824875,"creation_date":1300743671,"answer_id":5384089,"question_id":2501449,"body_markdown":"lets look at project http://code.google.com/p/multiindexcontainer/wiki/MainPage\r\nThis is generalized way how to use maps for JavaBean getters and perform lookups over indexed values.\r\nI think this is what you are looking for. Lets give it a try.\r\n","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>lets look at project <a href=\"http://code.google.com/p/multiindexcontainer/wiki/MainPage\" rel=\"nofollow\">http://code.google.com/p/multiindexcontainer/wiki/MainPage</a>\nThis is generalized way how to use maps for JavaBean getters and perform lookups over indexed values.\nI think this is what you are looking for. Lets give it a try.</p>\n"},{"comments":[{"owner":{"account_id":110220,"reputation":37362,"user_id":291741,"accept_rate":87,"display_name":"Chris Lercher"},"score":0,"creation_date":1348917618,"post_id":12649579,"comment_id":17066758,"body_markdown":"Not sure, if it&#39;s really an exact fit to my (old!) question, but the project looks interesting.","body":"Not sure, if it&#39;s really an exact fit to my (old!) question, but the project looks interesting."}],"tags":[],"owner":{"account_id":429234,"reputation":3009,"user_id":812018,"display_name":"npgall"},"comment_count":1,"down_vote_count":0,"up_vote_count":13,"is_accepted":false,"score":13,"last_activity_date":1348887648,"creation_date":1348887648,"answer_id":12649579,"question_id":2501449,"body_markdown":"Take a look at [CQEngine (Collection Query Engine)](http://code.google.com/p/cqengine/), it&#39;s an exact fit for this kind of requirement, being based around an `IndexedCollection`.\r\n\r\nAlso see related question [How do you query object collections in Java (Criteria/SQL-like)?](https://stackoverflow.com/questions/93417/how-do-you-query-object-collections-in-java-criteria-sql-like/11712925#11712925) for more background.","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>Take a look at <a href=\"http://code.google.com/p/cqengine/\" rel=\"nofollow noreferrer\">CQEngine (Collection Query Engine)</a>, it's an exact fit for this kind of requirement, being based around an <code>IndexedCollection</code>.</p>\n\n<p>Also see related question <a href=\"https://stackoverflow.com/questions/93417/how-do-you-query-object-collections-in-java-criteria-sql-like/11712925#11712925\">How do you query object collections in Java (Criteria/SQL-like)?</a> for more background.</p>\n"},{"tags":[],"owner":{"account_id":1221414,"reputation":31,"user_id":1187999,"display_name":"Jan Wiemer"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1366388583,"creation_date":1366388583,"answer_id":16109192,"question_id":2501449,"body_markdown":"Basically a solution based on multiple hash maps would be possible, but in this case all of them have to be keped up-to-date manually. A very simple integrated solution can be found here: [http://insidecoffe.blogspot.de/2013/04/indexable-hashmap-implementation.html][1]\r\n\r\n\r\n  [1]: http://insidecoffe.blogspot.de/2013/04/indexable-hashmap-implementation.html","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>Basically a solution based on multiple hash maps would be possible, but in this case all of them have to be keped up-to-date manually. A very simple integrated solution can be found here: <a href=\"http://insidecoffe.blogspot.de/2013/04/indexable-hashmap-implementation.html\" rel=\"nofollow\">http://insidecoffe.blogspot.de/2013/04/indexable-hashmap-implementation.html</a></p>\n"},{"tags":[],"owner":{"account_id":3432851,"reputation":1818,"user_id":2876739,"display_name":"RickHigh"},"comment_count":0,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1383390926,"creation_date":1383390926,"answer_id":19741310,"question_id":2501449,"body_markdown":"You need to check out Boon. :)\r\n\r\nhttp://rick-hightower.blogspot.com/2013/11/what-if-java-collections-and-java.html\r\n\r\n\r\nYou can add n number of search indexes and lookup indexes. It also allows you to efficiently query primitive properties. \r\n\r\nHere is an example take from the wiki (I am the author).\r\n\r\n      repoBuilder.primaryKey(&quot;ssn&quot;)\r\n              .searchIndex(&quot;firstName&quot;).searchIndex(&quot;lastName&quot;)\r\n              .searchIndex(&quot;salary&quot;).searchIndex(&quot;empNum&quot;, true)\r\n              .usePropertyForAccess(true);\r\n\r\nYou can override that by providing a true flag as the second argument to searchIndex.\r\n\r\nNotice empNum is a searchable unique index.\r\n\r\n\r\nWhat if it were easy to query a complex set of Java objects at runtime? What if there were an API that kept your object indexes (really just TreeMaps, and HashMaps) in sync.? Well then you would have Boon&#39;s data repo. This article shows how to use Boon&#39;s data repo utilities to query Java objects. This is part one. There can be many, many parts. :)\r\nBoon&#39;s data repo makes doing index based queries on collections a lot easier.\r\nWhy Boon data repo\r\n\r\nBoon&#39;s data repo allows you to treat Java collections more like a database at least when it comes to querying the collections. Boon&#39;s data repo is not an in-memory database, and cannot substitute arranging your objects into data structures optimized for your application.\r\nIf you want to spend your time providing customer value and building your objects and classes and using the Collections API for your data structures, then DataRepo is meant for you. This does not preclude breaking out the Knuth books and coming up with an optimized data structure. It just helps keep the mundane things easy so you can spend your time making the hard things possible.\r\nBorn out of need\r\n\r\nThis project came out of a need. I was working on a project that planned to store large collection of domain objects in-memory for speed, and somebody asked an all to important question that I overlooked. How are we going to query this data. My answer was we will use the Collections API and the Streaming API. Then I tried to do this... Hmmm...\r\nI also tired using the JDK 8 stream API on a large data set, and it was slow. (Boon&#39;s data repo works with JDK7 and JDK8). It was a linear search/filter. This is by design, but for what I was doing, it did not work. I needed indexes to support arbitrary queries.\r\nBoon&#39;s data repo augments the streaming API.\r\n\r\nBoon&#39;s data repo does not endeavor to replace the JDK 8 stream API, and in fact it works well with it. Boon&#39;s data repo allows you to create indexed collections. The indexes can be anything (it is pluggable).\r\nAt this moment in time, Boon&#39;s data repo indexes are based on ConcurrentHashMap and ConcurrentSkipListMap.\r\nBy design, Boon&#39;s data repo works with standard collection libraries. There is no plan to create a set of custom collections. One should be able to plug in Guava, Concurrent Trees or Trove if one desires to do so.\r\nIt provides a simplified API for doing so. It allows linear search for a sense of completion but I recommend using it primarily for using indexes and then using the streaming API for the rest (for type safety and speed).\r\n\r\n\r\n\r\n\r\n\r\nsneak peak before the step by step\r\n\r\nLet&#39;s say you have a method that creates 200,000 employee objects like this:\r\n \r\n     List&lt;Employee&gt; employees = TestHelper.createMetricTonOfEmployees(200_000);\r\n\r\nSo now we have 200,000 employees. Let&#39;s search them...\r\n\r\n\r\nFirst wrap Employees in a searchable query:\r\n\r\n\r\n       employees = query(employees);\r\n\r\n\r\nNow search:\r\n\r\n\r\n      List&lt;Employee&gt; results = query(employees, eq(&quot;firstName&quot;, firstName));\r\n\r\n\r\nSo what is the main difference between the above and the stream API?\r\n\r\n\r\n      employees.stream().filter(emp -&gt; emp.getFirstName().equals(firstName)\r\n\r\n\r\nAbout a factor of 20,000% faster to use Boon&#39;s DataRepo! Ah the power of HashMaps and TreeMaps. :)\r\nThere is an API that looks just like your built-in collections. There is also an API that looks more like a DAO object or a Repo Object.\r\n\r\n\r\nA simple query with the Repo/DAO object looks like this:\r\n\r\n\r\n      List&lt;Employee&gt; employees = repo.query(eq(&quot;firstName&quot;, &quot;Diana&quot;));\r\n\r\n\r\nA more involved query would look like this:\r\n\r\n\r\n      List&lt;Employee&gt; employees = repo.query(\r\n          and(eq(&quot;firstName&quot;, &quot;Diana&quot;), eq(&quot;lastName&quot;, &quot;Smith&quot;), eq(&quot;ssn&quot;, &quot;21785999&quot;)));\r\n\r\nOr this:\r\n\r\n\r\n      List&lt;Employee&gt; employees = repo.query(\r\n          and(startsWith(&quot;firstName&quot;, &quot;Bob&quot;), eq(&quot;lastName&quot;, &quot;Smith&quot;), lte(&quot;salary&quot;, 200_000),\r\n                  gte(&quot;salary&quot;, 190_000)));\r\n\r\nOr even this:\r\n\r\n\r\n      List&lt;Employee&gt; employees = repo.query(\r\n          and(startsWith(&quot;firstName&quot;, &quot;Bob&quot;), eq(&quot;lastName&quot;, &quot;Smith&quot;), between(&quot;salary&quot;, 190_000, 200_000)));\r\n\r\n\r\nOr if you want to use JDK 8 stream API, this works with it not against it:\r\n\r\n      int sum = repo.query(eq(&quot;lastName&quot;, &quot;Smith&quot;)).stream().filter(emp -&gt; emp.getSalary()&gt;50_000)\r\n          .mapToInt(b -&gt; b.getSalary())\r\n          .sum();\r\n\r\n\r\nThe above would be much faster if the number of employees was quite large. It would narrow down the employees whose name started with Smith and had a salary above 50,000. Let&#39;s say you had 100,000 employees and only 50 named Smith so now you narrow to 50 quickly by using the index which effectively pulls 50 employees out of 100,000, then we do the filter over just 50 instead of the whole 100,000.\r\n\r\nHere is a benchmark run from data repo of a linear search versus an indexed search in nano seconds:\r\n\r\n    Name index  Time 218 \r\n    Name linear  Time 3709120 \r\n    Name index  Time 213 \r\n    Name linear  Time 3606171 \r\n    Name index  Time 219 \r\n    Name linear  Time 3528839\r\n\r\nSomeone recently said to me: &quot;But with the streaming API, you can run the filter in parralel).\r\n\r\nLet&#39;s see how the math holds up:\r\n\r\n\r\n    3,528,839 / 16 threads vs. 219\r\n\r\n    201,802 vs. 219 (nano-seconds).\r\n\r\nIndexes win, but it was a photo finish. NOT! :) \r\n\r\nIt was only 9,500% faster instead of 40,000% faster. So close.....\r\n\r\n\r\n\r\n\r\nI added some more features. They are make heavy use of indexes. :)\r\n\r\n repo.updateByFilter(values(value(&quot;firstName&quot;, &quot;Di&quot;)),\r\n                and( eq(&quot;firstName&quot;, &quot;Diana&quot;),\r\n                        eq(&quot;lastName&quot;, &quot;Smith&quot;),\r\n                        eq(&quot;ssn&quot;, &quot;21785999&quot;) ) );\r\n\r\n\r\nThe above would be equivalent to\r\n\r\n  UPDATE Employee e\r\n   SET e.firstName=&#39;Di&#39;\r\n  WHERE e.firstName = &#39;Diana&#39;\r\n    and e.lastName = &#39;Smith&#39;\r\n    and e.ssn = &#39;21785999&#39;\r\n\r\n\r\nThis allows you to set multiple fields at once on multiple records so if you were doing a bulk update.\r\n\r\n\r\nThere are overloaded methods for all basic types so if you have one value to update on each items returned from a Filter:\r\n\r\n      repo.updateByFilter(&quot;firstName&quot;, &quot;Di&quot;,\r\n              and( eq(&quot;firstName&quot;, &quot;Diana&quot;),\r\n              eq(&quot;lastName&quot;, &quot;Smith&quot;),\r\n                      eq(&quot;ssn&quot;, &quot;21785999&quot;) ) );\r\n\r\n\r\nHere is some basic selection capabilities:\r\n\r\n      List &lt;Map&lt;String, Object&gt;&gt; list =\r\n         repo.query(selects(select(&quot;firstName&quot;)), eq(&quot;lastName&quot;, &quot;Hightower&quot;));\r\n\r\n\r\nYou can have as many selects as you like. You can also bring the list back sorted:\r\n\r\n      List &lt;Map&lt;String, Object&gt;&gt; list =\r\n         repo.sortedQuery(&quot;firstName&quot;,selects(select(&quot;firstName&quot;)),\r\n           eq(&quot;lastName&quot;, &quot;Hightower&quot;));\r\n\r\n\r\nYou can select properties of related properties (i.e., employee.department.name).\r\n\r\n      List &lt;Map&lt;String, Object&gt;&gt; list = repo.query(\r\n              selects(select(&quot;department&quot;, &quot;name&quot;)),\r\n              eq(&quot;lastName&quot;, &quot;Hightower&quot;));\r\n\r\n      assertEquals(&quot;engineering&quot;, list.get(0).get(&quot;department.name&quot;));\r\n\r\n\r\nThe above would try to use the fields of the classes. If you want to use the actual properties (emp.getFoo() vs. emp.foo), then you need to use the selectPropertyPath.\r\n\r\n      List &lt;Map&lt;String, Object&gt;&gt; list = repo.query(\r\n              selects(selectPropPath(&quot;department&quot;, &quot;name&quot;)),\r\n              eq(&quot;lastName&quot;, &quot;Hightower&quot;));\r\n\r\n\r\nNote that select(&quot;department&quot;, &quot;name&quot;) is much faster than selectPropPath(&quot;department&quot;, &quot;name&quot;), which could matter in a tight loop.\r\n\r\nBy default all search indexes and lookup indexes allow duplicates (except for primary key index).\r\n\r\n      repoBuilder.primaryKey(&quot;ssn&quot;)\r\n              .searchIndex(&quot;firstName&quot;).searchIndex(&quot;lastName&quot;)\r\n              .searchIndex(&quot;salary&quot;).searchIndex(&quot;empNum&quot;, true)\r\n              .usePropertyForAccess(true);\r\n\r\n\r\nYou can override that by providing a true flag as the second argument to searchIndex.\r\n\r\nNotice empNum is a searchable unique index.\r\n\r\nIf you prefer or need, you can get even simple searches back as maps:\r\n\r\n      List&lt;Map&lt;String, Object&gt;&gt; employees = repo.queryAsMaps(eq(&quot;firstName&quot;, &quot;Diana&quot;));\r\n\r\n\r\nI am not sure if this is a feature or a misfeature. My thought was that once you are dealing with data, you need to present that data in a way that does not ties consumers of data to your actual API. Having a Map of String / basic types seems to be a way to achieve this.\r\nNote that the object to map conversion goes deep as in:\r\n\r\n      System.out.println(employees.get(0).get(&quot;department&quot;));\r\n\r\n\r\nYields:\r\n\r\n    {class=Department, name=engineering}\r\n\r\nThis can be useful for debugging and ad hoc queries for tooling. I am considering adding support to easily convert to a JSON string.\r\n\r\nAdded the ability to query collection properties. This should work with collections and arrays as deeply nested as you like. Read that again because it was a real MF to implement!\r\n\r\n      List &lt;Map&lt;String, Object&gt;&gt; list = repo.query(\r\n              selects(select(&quot;tags&quot;, &quot;metas&quot;, &quot;metas2&quot;, &quot;metas3&quot;, &quot;name3&quot;)),\r\n              eq(&quot;lastName&quot;, &quot;Hightower&quot;));\r\n\r\n      print(&quot;list&quot;, list);\r\n\r\n      assertEquals(&quot;3tag1&quot;, idx(list.get(0).get(&quot;tags.metas.metas2.metas3.name3&quot;), 0));\r\n\r\nThe print out of the above looks like this:\r\n\r\n    list [{tags.metas.metas2.metas3.name3=[3tag1, 3tag2, 3tag3,\r\n    3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\r\n    3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\r\n    3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\r\n    3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\r\n    3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\r\n    3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\r\n    3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\r\n    3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\r\n    3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3]},\r\n    ...\r\n\r\nI created several relationship classes to test this:\r\n\r\n    public class Employee {\r\n    List &lt;Tag&gt; tags = new ArrayList&lt;&gt;();\r\n    {\r\n        tags.add(new Tag(&quot;tag1&quot;));\r\n        tags.add(new Tag(&quot;tag2&quot;));\r\n        tags.add(new Tag(&quot;tag3&quot;));\r\n\r\n    }\r\n    ...\r\n    public class Tag {\r\n    ...\r\n    List&lt;Meta&gt; metas = new ArrayList&lt;&gt;();\r\n    {\r\n        metas.add(new Meta(&quot;mtag1&quot;));\r\n        metas.add(new Meta(&quot;mtag2&quot;));\r\n        metas.add(new Meta(&quot;mtag3&quot;));\r\n\r\n    }\r\n\r\n    }\r\n    public class Meta {\r\n     ...\r\n       List&lt;Meta2&gt; metas2 = new ArrayList&lt;&gt;();\r\n       {\r\n           metas2.add(new Meta2(&quot;2tag1&quot;));\r\n           metas2.add(new Meta2(&quot;2tag2&quot;));\r\n           metas2.add(new Meta2(&quot;2tag3&quot;));\r\n\r\n       }\r\n\r\n    }\r\n\r\n    ...\r\n    public class Meta2 {\r\n\r\n\r\n\r\n    List&lt;Meta3&gt; metas3 = new ArrayList&lt;&gt;();\r\n    {\r\n        metas3.add(new Meta3(&quot;3tag1&quot;));\r\n        metas3.add(new Meta3(&quot;3tag2&quot;));\r\n        metas3.add(new Meta3(&quot;3tag3&quot;));\r\n\r\n    }\r\n    public class Meta3 {\r\n\r\n    ...\r\n\r\nYou can also search by type:\r\n\r\n      List&lt;Employee&gt; results = sortedQuery(queryableList, &quot;firstName&quot;, typeOf(&quot;SalesEmployee&quot;));\r\n\r\n      assertEquals(1, results.size());\r\n      assertEquals(&quot;SalesEmployee&quot;, results.get(0).getClass().getSimpleName());\r\nThe above finds all employees with the simple classname of SalesEmployee. It also works with full class name as in:\r\n\r\n      List&lt;Employee&gt; results = sortedQuery(queryableList, &quot;firstName&quot;, typeOf(&quot;SalesEmployee&quot;));\r\n\r\n      assertEquals(1, results.size());\r\n      assertEquals(&quot;SalesEmployee&quot;, results.get(0).getClass().getSimpleName());\r\nYou can search by the actual class too:\r\n\r\n      List&lt;Employee&gt; results = sortedQuery(queryableList, &quot;firstName&quot;, instanceOf(SalesEmployee.class));\r\n\r\n      assertEquals(1, results.size());\r\n      assertEquals(&quot;SalesEmployee&quot;, results.get(0).getClass().getSimpleName());\r\n\r\n\r\nYou can also query classes that implement certain interfaces:\r\n\r\n      List&lt;Employee&gt; results = sortedQuery(queryableList, &quot;firstName&quot;,      \r\n                                  implementsInterface(Comparable.class));\r\n\r\n      assertEquals(1, results.size());\r\n      assertEquals(&quot;SalesEmployee&quot;, results.get(0).getClass().getSimpleName());\r\n\r\n\r\nYou can also index nested fields/properties and they can be collection fields or property non collection fields as deeply nested as you would like:\r\n\r\n      /* Create a repo, and decide what to index. */\r\n      RepoBuilder repoBuilder = RepoBuilder.getInstance();\r\n\r\n      /* Look at the nestedIndex. */\r\n      repoBuilder.primaryKey(&quot;id&quot;)\r\n              .searchIndex(&quot;firstName&quot;).searchIndex(&quot;lastName&quot;)\r\n              .searchIndex(&quot;salary&quot;).uniqueSearchIndex(&quot;empNum&quot;)\r\n              .nestedIndex(&quot;tags&quot;, &quot;metas&quot;, &quot;metas2&quot;, &quot;name2&quot;);\r\n\r\n\r\nLater you can use the nestedIndex to search.\r\n\r\n      List&lt;Map&lt;String, Object&gt;&gt; list = repo.query(\r\n              selects(select(&quot;tags&quot;, &quot;metas&quot;, &quot;metas2&quot;, &quot;name2&quot;)),\r\n              eqNested(&quot;2tag1&quot;, &quot;tags&quot;, &quot;metas&quot;, &quot;metas2&quot;, &quot;name2&quot;));\r\n\r\n\r\nThe safe way to use the nestedIndex is to use eqNested. You can use eq, gt, gte, etc. if you have the index like so:\r\n\r\n      List&lt;Map&lt;String, Object&gt;&gt; list = repo.query(\r\n              selects(select(&quot;tags&quot;, &quot;metas&quot;, &quot;metas2&quot;, &quot;name2&quot;)),\r\n              eq(&quot;tags.metas.metas2.name2&quot;, &quot;2tag1&quot;));\r\n\r\nYou can also add support for subclasses\r\n\r\n      List&lt;Employee&gt; queryableList = $q(h_list, Employee.class, SalesEmployee.class,  \r\n                      HourlyEmployee.class);\r\n      List&lt;Employee&gt; results = sortedQuery(queryableList, &quot;firstName&quot;, eq(&quot;commissionRate&quot;, 1));\r\n      assertEquals(1, results.size());\r\n      assertEquals(&quot;SalesEmployee&quot;, results.get(0).getClass().getSimpleName());\r\n\r\n      results = sortedQuery(queryableList, &quot;firstName&quot;, eq(&quot;weeklyHours&quot;, 40));\r\n      assertEquals(1, results.size());\r\n      assertEquals(&quot;HourlyEmployee&quot;, results.get(0).getClass().getSimpleName());\r\n\r\nThe data repo has a similar feature in its DataRepoBuilder.build(...) method for specifying subclasses. This allows you to seemless query fields form subclasses and classes in the same repo or searchable collection.","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>You need to check out Boon. :)</p>\n\n<p><a href=\"http://rick-hightower.blogspot.com/2013/11/what-if-java-collections-and-java.html\" rel=\"noreferrer\">http://rick-hightower.blogspot.com/2013/11/what-if-java-collections-and-java.html</a></p>\n\n<p>You can add n number of search indexes and lookup indexes. It also allows you to efficiently query primitive properties. </p>\n\n<p>Here is an example take from the wiki (I am the author).</p>\n\n<pre><code>  repoBuilder.primaryKey(\"ssn\")\n          .searchIndex(\"firstName\").searchIndex(\"lastName\")\n          .searchIndex(\"salary\").searchIndex(\"empNum\", true)\n          .usePropertyForAccess(true);\n</code></pre>\n\n<p>You can override that by providing a true flag as the second argument to searchIndex.</p>\n\n<p>Notice empNum is a searchable unique index.</p>\n\n<p>What if it were easy to query a complex set of Java objects at runtime? What if there were an API that kept your object indexes (really just TreeMaps, and HashMaps) in sync.? Well then you would have Boon's data repo. This article shows how to use Boon's data repo utilities to query Java objects. This is part one. There can be many, many parts. :)\nBoon's data repo makes doing index based queries on collections a lot easier.\nWhy Boon data repo</p>\n\n<p>Boon's data repo allows you to treat Java collections more like a database at least when it comes to querying the collections. Boon's data repo is not an in-memory database, and cannot substitute arranging your objects into data structures optimized for your application.\nIf you want to spend your time providing customer value and building your objects and classes and using the Collections API for your data structures, then DataRepo is meant for you. This does not preclude breaking out the Knuth books and coming up with an optimized data structure. It just helps keep the mundane things easy so you can spend your time making the hard things possible.\nBorn out of need</p>\n\n<p>This project came out of a need. I was working on a project that planned to store large collection of domain objects in-memory for speed, and somebody asked an all to important question that I overlooked. How are we going to query this data. My answer was we will use the Collections API and the Streaming API. Then I tried to do this... Hmmm...\nI also tired using the JDK 8 stream API on a large data set, and it was slow. (Boon's data repo works with JDK7 and JDK8). It was a linear search/filter. This is by design, but for what I was doing, it did not work. I needed indexes to support arbitrary queries.\nBoon's data repo augments the streaming API.</p>\n\n<p>Boon's data repo does not endeavor to replace the JDK 8 stream API, and in fact it works well with it. Boon's data repo allows you to create indexed collections. The indexes can be anything (it is pluggable).\nAt this moment in time, Boon's data repo indexes are based on ConcurrentHashMap and ConcurrentSkipListMap.\nBy design, Boon's data repo works with standard collection libraries. There is no plan to create a set of custom collections. One should be able to plug in Guava, Concurrent Trees or Trove if one desires to do so.\nIt provides a simplified API for doing so. It allows linear search for a sense of completion but I recommend using it primarily for using indexes and then using the streaming API for the rest (for type safety and speed).</p>\n\n<p>sneak peak before the step by step</p>\n\n<p>Let's say you have a method that creates 200,000 employee objects like this:</p>\n\n<pre><code> List&lt;Employee&gt; employees = TestHelper.createMetricTonOfEmployees(200_000);\n</code></pre>\n\n<p>So now we have 200,000 employees. Let's search them...</p>\n\n<p>First wrap Employees in a searchable query:</p>\n\n<pre><code>   employees = query(employees);\n</code></pre>\n\n<p>Now search:</p>\n\n<pre><code>  List&lt;Employee&gt; results = query(employees, eq(\"firstName\", firstName));\n</code></pre>\n\n<p>So what is the main difference between the above and the stream API?</p>\n\n<pre><code>  employees.stream().filter(emp -&gt; emp.getFirstName().equals(firstName)\n</code></pre>\n\n<p>About a factor of 20,000% faster to use Boon's DataRepo! Ah the power of HashMaps and TreeMaps. :)\nThere is an API that looks just like your built-in collections. There is also an API that looks more like a DAO object or a Repo Object.</p>\n\n<p>A simple query with the Repo/DAO object looks like this:</p>\n\n<pre><code>  List&lt;Employee&gt; employees = repo.query(eq(\"firstName\", \"Diana\"));\n</code></pre>\n\n<p>A more involved query would look like this:</p>\n\n<pre><code>  List&lt;Employee&gt; employees = repo.query(\n      and(eq(\"firstName\", \"Diana\"), eq(\"lastName\", \"Smith\"), eq(\"ssn\", \"21785999\")));\n</code></pre>\n\n<p>Or this:</p>\n\n<pre><code>  List&lt;Employee&gt; employees = repo.query(\n      and(startsWith(\"firstName\", \"Bob\"), eq(\"lastName\", \"Smith\"), lte(\"salary\", 200_000),\n              gte(\"salary\", 190_000)));\n</code></pre>\n\n<p>Or even this:</p>\n\n<pre><code>  List&lt;Employee&gt; employees = repo.query(\n      and(startsWith(\"firstName\", \"Bob\"), eq(\"lastName\", \"Smith\"), between(\"salary\", 190_000, 200_000)));\n</code></pre>\n\n<p>Or if you want to use JDK 8 stream API, this works with it not against it:</p>\n\n<pre><code>  int sum = repo.query(eq(\"lastName\", \"Smith\")).stream().filter(emp -&gt; emp.getSalary()&gt;50_000)\n      .mapToInt(b -&gt; b.getSalary())\n      .sum();\n</code></pre>\n\n<p>The above would be much faster if the number of employees was quite large. It would narrow down the employees whose name started with Smith and had a salary above 50,000. Let's say you had 100,000 employees and only 50 named Smith so now you narrow to 50 quickly by using the index which effectively pulls 50 employees out of 100,000, then we do the filter over just 50 instead of the whole 100,000.</p>\n\n<p>Here is a benchmark run from data repo of a linear search versus an indexed search in nano seconds:</p>\n\n<pre><code>Name index  Time 218 \nName linear  Time 3709120 \nName index  Time 213 \nName linear  Time 3606171 \nName index  Time 219 \nName linear  Time 3528839\n</code></pre>\n\n<p>Someone recently said to me: \"But with the streaming API, you can run the filter in parralel).</p>\n\n<p>Let's see how the math holds up:</p>\n\n<pre><code>3,528,839 / 16 threads vs. 219\n\n201,802 vs. 219 (nano-seconds).\n</code></pre>\n\n<p>Indexes win, but it was a photo finish. NOT! :) </p>\n\n<p>It was only 9,500% faster instead of 40,000% faster. So close.....</p>\n\n<p>I added some more features. They are make heavy use of indexes. :)</p>\n\n<p>repo.updateByFilter(values(value(\"firstName\", \"Di\")),\n                and( eq(\"firstName\", \"Diana\"),\n                        eq(\"lastName\", \"Smith\"),\n                        eq(\"ssn\", \"21785999\") ) );</p>\n\n<p>The above would be equivalent to</p>\n\n<p>UPDATE Employee e\n   SET e.firstName='Di'\n  WHERE e.firstName = 'Diana'\n    and e.lastName = 'Smith'\n    and e.ssn = '21785999'</p>\n\n<p>This allows you to set multiple fields at once on multiple records so if you were doing a bulk update.</p>\n\n<p>There are overloaded methods for all basic types so if you have one value to update on each items returned from a Filter:</p>\n\n<pre><code>  repo.updateByFilter(\"firstName\", \"Di\",\n          and( eq(\"firstName\", \"Diana\"),\n          eq(\"lastName\", \"Smith\"),\n                  eq(\"ssn\", \"21785999\") ) );\n</code></pre>\n\n<p>Here is some basic selection capabilities:</p>\n\n<pre><code>  List &lt;Map&lt;String, Object&gt;&gt; list =\n     repo.query(selects(select(\"firstName\")), eq(\"lastName\", \"Hightower\"));\n</code></pre>\n\n<p>You can have as many selects as you like. You can also bring the list back sorted:</p>\n\n<pre><code>  List &lt;Map&lt;String, Object&gt;&gt; list =\n     repo.sortedQuery(\"firstName\",selects(select(\"firstName\")),\n       eq(\"lastName\", \"Hightower\"));\n</code></pre>\n\n<p>You can select properties of related properties (i.e., employee.department.name).</p>\n\n<pre><code>  List &lt;Map&lt;String, Object&gt;&gt; list = repo.query(\n          selects(select(\"department\", \"name\")),\n          eq(\"lastName\", \"Hightower\"));\n\n  assertEquals(\"engineering\", list.get(0).get(\"department.name\"));\n</code></pre>\n\n<p>The above would try to use the fields of the classes. If you want to use the actual properties (emp.getFoo() vs. emp.foo), then you need to use the selectPropertyPath.</p>\n\n<pre><code>  List &lt;Map&lt;String, Object&gt;&gt; list = repo.query(\n          selects(selectPropPath(\"department\", \"name\")),\n          eq(\"lastName\", \"Hightower\"));\n</code></pre>\n\n<p>Note that select(\"department\", \"name\") is much faster than selectPropPath(\"department\", \"name\"), which could matter in a tight loop.</p>\n\n<p>By default all search indexes and lookup indexes allow duplicates (except for primary key index).</p>\n\n<pre><code>  repoBuilder.primaryKey(\"ssn\")\n          .searchIndex(\"firstName\").searchIndex(\"lastName\")\n          .searchIndex(\"salary\").searchIndex(\"empNum\", true)\n          .usePropertyForAccess(true);\n</code></pre>\n\n<p>You can override that by providing a true flag as the second argument to searchIndex.</p>\n\n<p>Notice empNum is a searchable unique index.</p>\n\n<p>If you prefer or need, you can get even simple searches back as maps:</p>\n\n<pre><code>  List&lt;Map&lt;String, Object&gt;&gt; employees = repo.queryAsMaps(eq(\"firstName\", \"Diana\"));\n</code></pre>\n\n<p>I am not sure if this is a feature or a misfeature. My thought was that once you are dealing with data, you need to present that data in a way that does not ties consumers of data to your actual API. Having a Map of String / basic types seems to be a way to achieve this.\nNote that the object to map conversion goes deep as in:</p>\n\n<pre><code>  System.out.println(employees.get(0).get(\"department\"));\n</code></pre>\n\n<p>Yields:</p>\n\n<pre><code>{class=Department, name=engineering}\n</code></pre>\n\n<p>This can be useful for debugging and ad hoc queries for tooling. I am considering adding support to easily convert to a JSON string.</p>\n\n<p>Added the ability to query collection properties. This should work with collections and arrays as deeply nested as you like. Read that again because it was a real MF to implement!</p>\n\n<pre><code>  List &lt;Map&lt;String, Object&gt;&gt; list = repo.query(\n          selects(select(\"tags\", \"metas\", \"metas2\", \"metas3\", \"name3\")),\n          eq(\"lastName\", \"Hightower\"));\n\n  print(\"list\", list);\n\n  assertEquals(\"3tag1\", idx(list.get(0).get(\"tags.metas.metas2.metas3.name3\"), 0));\n</code></pre>\n\n<p>The print out of the above looks like this:</p>\n\n<pre><code>list [{tags.metas.metas2.metas3.name3=[3tag1, 3tag2, 3tag3,\n3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\n3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\n3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\n3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\n3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\n3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\n3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\n3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3,\n3tag1, 3tag2, 3tag3, 3tag1, 3tag2, 3tag3]},\n...\n</code></pre>\n\n<p>I created several relationship classes to test this:</p>\n\n<pre><code>public class Employee {\nList &lt;Tag&gt; tags = new ArrayList&lt;&gt;();\n{\n    tags.add(new Tag(\"tag1\"));\n    tags.add(new Tag(\"tag2\"));\n    tags.add(new Tag(\"tag3\"));\n\n}\n...\npublic class Tag {\n...\nList&lt;Meta&gt; metas = new ArrayList&lt;&gt;();\n{\n    metas.add(new Meta(\"mtag1\"));\n    metas.add(new Meta(\"mtag2\"));\n    metas.add(new Meta(\"mtag3\"));\n\n}\n\n}\npublic class Meta {\n ...\n   List&lt;Meta2&gt; metas2 = new ArrayList&lt;&gt;();\n   {\n       metas2.add(new Meta2(\"2tag1\"));\n       metas2.add(new Meta2(\"2tag2\"));\n       metas2.add(new Meta2(\"2tag3\"));\n\n   }\n\n}\n\n...\npublic class Meta2 {\n\n\n\nList&lt;Meta3&gt; metas3 = new ArrayList&lt;&gt;();\n{\n    metas3.add(new Meta3(\"3tag1\"));\n    metas3.add(new Meta3(\"3tag2\"));\n    metas3.add(new Meta3(\"3tag3\"));\n\n}\npublic class Meta3 {\n\n...\n</code></pre>\n\n<p>You can also search by type:</p>\n\n<pre><code>  List&lt;Employee&gt; results = sortedQuery(queryableList, \"firstName\", typeOf(\"SalesEmployee\"));\n\n  assertEquals(1, results.size());\n  assertEquals(\"SalesEmployee\", results.get(0).getClass().getSimpleName());\n</code></pre>\n\n<p>The above finds all employees with the simple classname of SalesEmployee. It also works with full class name as in:</p>\n\n<pre><code>  List&lt;Employee&gt; results = sortedQuery(queryableList, \"firstName\", typeOf(\"SalesEmployee\"));\n\n  assertEquals(1, results.size());\n  assertEquals(\"SalesEmployee\", results.get(0).getClass().getSimpleName());\n</code></pre>\n\n<p>You can search by the actual class too:</p>\n\n<pre><code>  List&lt;Employee&gt; results = sortedQuery(queryableList, \"firstName\", instanceOf(SalesEmployee.class));\n\n  assertEquals(1, results.size());\n  assertEquals(\"SalesEmployee\", results.get(0).getClass().getSimpleName());\n</code></pre>\n\n<p>You can also query classes that implement certain interfaces:</p>\n\n<pre><code>  List&lt;Employee&gt; results = sortedQuery(queryableList, \"firstName\",      \n                              implementsInterface(Comparable.class));\n\n  assertEquals(1, results.size());\n  assertEquals(\"SalesEmployee\", results.get(0).getClass().getSimpleName());\n</code></pre>\n\n<p>You can also index nested fields/properties and they can be collection fields or property non collection fields as deeply nested as you would like:</p>\n\n<pre><code>  /* Create a repo, and decide what to index. */\n  RepoBuilder repoBuilder = RepoBuilder.getInstance();\n\n  /* Look at the nestedIndex. */\n  repoBuilder.primaryKey(\"id\")\n          .searchIndex(\"firstName\").searchIndex(\"lastName\")\n          .searchIndex(\"salary\").uniqueSearchIndex(\"empNum\")\n          .nestedIndex(\"tags\", \"metas\", \"metas2\", \"name2\");\n</code></pre>\n\n<p>Later you can use the nestedIndex to search.</p>\n\n<pre><code>  List&lt;Map&lt;String, Object&gt;&gt; list = repo.query(\n          selects(select(\"tags\", \"metas\", \"metas2\", \"name2\")),\n          eqNested(\"2tag1\", \"tags\", \"metas\", \"metas2\", \"name2\"));\n</code></pre>\n\n<p>The safe way to use the nestedIndex is to use eqNested. You can use eq, gt, gte, etc. if you have the index like so:</p>\n\n<pre><code>  List&lt;Map&lt;String, Object&gt;&gt; list = repo.query(\n          selects(select(\"tags\", \"metas\", \"metas2\", \"name2\")),\n          eq(\"tags.metas.metas2.name2\", \"2tag1\"));\n</code></pre>\n\n<p>You can also add support for subclasses</p>\n\n<pre><code>  List&lt;Employee&gt; queryableList = $q(h_list, Employee.class, SalesEmployee.class,  \n                  HourlyEmployee.class);\n  List&lt;Employee&gt; results = sortedQuery(queryableList, \"firstName\", eq(\"commissionRate\", 1));\n  assertEquals(1, results.size());\n  assertEquals(\"SalesEmployee\", results.get(0).getClass().getSimpleName());\n\n  results = sortedQuery(queryableList, \"firstName\", eq(\"weeklyHours\", 40));\n  assertEquals(1, results.size());\n  assertEquals(\"HourlyEmployee\", results.get(0).getClass().getSimpleName());\n</code></pre>\n\n<p>The data repo has a similar feature in its DataRepoBuilder.build(...) method for specifying subclasses. This allows you to seemless query fields form subclasses and classes in the same repo or searchable collection.</p>\n"},{"tags":[],"owner":{"account_id":2348840,"reputation":1502,"user_id":2058260,"accept_rate":84,"display_name":"H4SN"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1491903738,"creation_date":1491903738,"answer_id":43342262,"question_id":2501449,"body_markdown":"Here is how i am achieving this, right now only put,remove and get methods are working for rest you need to override desired methods.\r\n\r\n\r\n\r\nExample:\r\n\r\n    MultiKeyMap&lt;MultiKeyMap.Key,String&gt; map = new MultiKeyMap&lt;&gt;();\r\n    MultiKeyMap.Key key1 = map.generatePrimaryKey(&quot;keyA&quot;,&quot;keyB&quot;,&quot;keyC&quot;);\r\n    MultiKeyMap.Key key2 = map.generatePrimaryKey(&quot;keyD&quot;,&quot;keyE&quot;,&quot;keyF&quot;);\r\n\r\n    map.put(key1,&quot;This is value 1&quot;);\r\n    map.put(key2,&quot;This is value 2&quot;);\r\n\r\n    Log.i(&quot;MultiKeyMapDebug&quot;,map.get(&quot;keyA&quot;));\r\n    Log.i(&quot;MultiKeyMapDebug&quot;,map.get(&quot;keyB&quot;));\r\n    Log.i(&quot;MultiKeyMapDebug&quot;,map.get(&quot;keyC&quot;));\r\n\r\n    Log.i(&quot;MultiKeyMapDebug&quot;,&quot;&quot;+map.get(&quot;keyD&quot;));\r\n    Log.i(&quot;MultiKeyMapDebug&quot;,&quot;&quot;+map.get(&quot;keyE&quot;));\r\n    Log.i(&quot;MultiKeyMapDebug&quot;,&quot;&quot;+map.get(&quot;keyF&quot;));\r\n\r\nOutput:\r\n\r\n    MultiKeyMapDebug: This is value 1\r\n    MultiKeyMapDebug: This is value 1\r\n    MultiKeyMapDebug: This is value 1\r\n    MultiKeyMapDebug: This is value 2\r\n    MultiKeyMapDebug: This is value 2\r\n    MultiKeyMapDebug: This is value 2\r\n\r\nMultiKeyMap.java:\r\n\r\n    /**\r\n     * Created by hsn on 11/04/17.\r\n     */\r\n\r\n\r\n    public class MultiKeyMap&lt;K extends MultiKeyMap.Key, V&gt; extends HashMap&lt;MultiKeyMap.Key, V&gt; {\r\n    \r\n        private Map&lt;String, MultiKeyMap.Key&gt; keyMap = new HashMap&lt;&gt;();\r\n    \r\n        @Override\r\n        public V get(Object key) {\r\n            return super.get(keyMap.get(key));\r\n        }\r\n    \r\n        @Override\r\n        public V put(MultiKeyMap.Key key, V value) {\r\n            List&lt;String&gt; keyArray = (List&lt;String&gt;) key;\r\n            for (String keyS : keyArray) {\r\n                keyMap.put(keyS, key);\r\n            }\r\n            return super.put(key, value);\r\n        }\r\n    \r\n        @Override\r\n        public V remove(Object key) {\r\n            return super.remove(keyMap.get(key));\r\n        }\r\n    \r\n        public Key generatePrimaryKey(String... keys) {\r\n            Key singleKey = new Key();\r\n            for (String key : keys) {\r\n                singleKey.add(key);\r\n            }\r\n            return singleKey;\r\n        }\r\n    \r\n        public class Key extends ArrayList&lt;String&gt; {\r\n    \r\n        }\r\n    \r\n    }\r\n\r\n","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>Here is how i am achieving this, right now only put,remove and get methods are working for rest you need to override desired methods.</p>\n\n<p>Example:</p>\n\n<pre><code>MultiKeyMap&lt;MultiKeyMap.Key,String&gt; map = new MultiKeyMap&lt;&gt;();\nMultiKeyMap.Key key1 = map.generatePrimaryKey(\"keyA\",\"keyB\",\"keyC\");\nMultiKeyMap.Key key2 = map.generatePrimaryKey(\"keyD\",\"keyE\",\"keyF\");\n\nmap.put(key1,\"This is value 1\");\nmap.put(key2,\"This is value 2\");\n\nLog.i(\"MultiKeyMapDebug\",map.get(\"keyA\"));\nLog.i(\"MultiKeyMapDebug\",map.get(\"keyB\"));\nLog.i(\"MultiKeyMapDebug\",map.get(\"keyC\"));\n\nLog.i(\"MultiKeyMapDebug\",\"\"+map.get(\"keyD\"));\nLog.i(\"MultiKeyMapDebug\",\"\"+map.get(\"keyE\"));\nLog.i(\"MultiKeyMapDebug\",\"\"+map.get(\"keyF\"));\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>MultiKeyMapDebug: This is value 1\nMultiKeyMapDebug: This is value 1\nMultiKeyMapDebug: This is value 1\nMultiKeyMapDebug: This is value 2\nMultiKeyMapDebug: This is value 2\nMultiKeyMapDebug: This is value 2\n</code></pre>\n\n<p>MultiKeyMap.java:</p>\n\n<pre><code>/**\n * Created by hsn on 11/04/17.\n */\n\n\npublic class MultiKeyMap&lt;K extends MultiKeyMap.Key, V&gt; extends HashMap&lt;MultiKeyMap.Key, V&gt; {\n\n    private Map&lt;String, MultiKeyMap.Key&gt; keyMap = new HashMap&lt;&gt;();\n\n    @Override\n    public V get(Object key) {\n        return super.get(keyMap.get(key));\n    }\n\n    @Override\n    public V put(MultiKeyMap.Key key, V value) {\n        List&lt;String&gt; keyArray = (List&lt;String&gt;) key;\n        for (String keyS : keyArray) {\n            keyMap.put(keyS, key);\n        }\n        return super.put(key, value);\n    }\n\n    @Override\n    public V remove(Object key) {\n        return super.remove(keyMap.get(key));\n    }\n\n    public Key generatePrimaryKey(String... keys) {\n        Key singleKey = new Key();\n        for (String key : keys) {\n            singleKey.add(key);\n        }\n        return singleKey;\n    }\n\n    public class Key extends ArrayList&lt;String&gt; {\n\n    }\n\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":10634936,"reputation":141,"user_id":7831933,"display_name":"Syed Belal Jafri"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1528821287,"creation_date":1528821287,"answer_id":50821977,"question_id":2501449,"body_markdown":"If you want multiple indexes on your data, you can create and maintain multiple hash maps or use a library like Data Store:\n\nhttps://github.com/jparams/data-store\n\nExample:\n\n    Store&lt;Person&gt; store = new MemoryStore&lt;&gt;() ;\n    store.add(new Person(1, &quot;Ed&quot;, 3));\n    store.add(new Person(2, &quot;Fred&quot;, 7));\n    store.add(new Person(3, &quot;Freda&quot;, 5));\n    store.index(&quot;name&quot;, Person::getName);\n    Person person = store.getFirst(&quot;name&quot;, &quot;Ed&quot;);\n\nWith data store you can create case-insensitive indexes and all sorts of cool stuff. Worth checking out. ","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>If you want multiple indexes on your data, you can create and maintain multiple hash maps or use a library like Data Store:</p>\n\n<p><a href=\"https://github.com/jparams/data-store\" rel=\"nofollow noreferrer\">https://github.com/jparams/data-store</a></p>\n\n<p>Example:</p>\n\n<pre><code>Store&lt;Person&gt; store = new MemoryStore&lt;&gt;() ;\nstore.add(new Person(1, \"Ed\", 3));\nstore.add(new Person(2, \"Fred\", 7));\nstore.add(new Person(3, \"Freda\", 5));\nstore.index(\"name\", Person::getName);\nPerson person = store.getFirst(\"name\", \"Ed\");\n</code></pre>\n\n<p>With data store you can create case-insensitive indexes and all sorts of cool stuff. Worth checking out. </p>\n"},{"tags":[],"owner":{"account_id":1149936,"reputation":14493,"user_id":1131857,"accept_rate":76,"display_name":"wutzebaer"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1629627828,"creation_date":1629627828,"answer_id":68880408,"question_id":2501449,"body_markdown":"I found this code years ago (can&#39;t remember where). Just use this to build your key from different values.\r\n\r\n    import java.util.Arrays;\r\n    public final class MultiKey {\r\n        private static final int PRIME = 31;\r\n    \r\n        private final Object[] values;\r\n    \r\n        private final int hashCode;\r\n    \r\n        /**\r\n         * Creates a new instance from the provided values. It is assumed that the\r\n         * values provided are good map keys themselves -- immutable, with proper\r\n         * implementations of equals() and hashCode().\r\n         *\r\n         * @param values\r\n         */\r\n        public MultiKey(Object... values) {\r\n            this.values = values;\r\n            hashCode = PRIME * Arrays.hashCode(this.values);\r\n        }\r\n    \r\n        @Override\r\n        public int hashCode() {\r\n            return hashCode;\r\n        }\r\n    \r\n        @Override\r\n        public boolean equals(Object obj) {\r\n            if (this == obj)\r\n                return true;\r\n            if (obj == null)\r\n                return false;\r\n            if (getClass() != obj.getClass())\r\n                return false;\r\n            final MultiKey other = (MultiKey) obj;\r\n    \r\n            return Arrays.equals(values, other.values);\r\n        }\r\n    \r\n        @Override\r\n        public String toString() {\r\n            StringBuilder builder = new StringBuilder(&quot;MultiKey[&quot;);\r\n    \r\n            boolean first = true;\r\n    \r\n            for (Object o : values) {\r\n                if (!first)\r\n                    builder.append(&quot;, &quot;);\r\n    \r\n                builder.append(o);\r\n    \r\n                first = false;\r\n            }\r\n    \r\n            builder.append(&quot;]&quot;);\r\n    \r\n            return builder.toString();\r\n        }\r\n    \r\n    }","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>I found this code years ago (can't remember where). Just use this to build your key from different values.</p>\n<pre><code>import java.util.Arrays;\npublic final class MultiKey {\n    private static final int PRIME = 31;\n\n    private final Object[] values;\n\n    private final int hashCode;\n\n    /**\n     * Creates a new instance from the provided values. It is assumed that the\n     * values provided are good map keys themselves -- immutable, with proper\n     * implementations of equals() and hashCode().\n     *\n     * @param values\n     */\n    public MultiKey(Object... values) {\n        this.values = values;\n        hashCode = PRIME * Arrays.hashCode(this.values);\n    }\n\n    @Override\n    public int hashCode() {\n        return hashCode;\n    }\n\n    @Override\n    public boolean equals(Object obj) {\n        if (this == obj)\n            return true;\n        if (obj == null)\n            return false;\n        if (getClass() != obj.getClass())\n            return false;\n        final MultiKey other = (MultiKey) obj;\n\n        return Arrays.equals(values, other.values);\n    }\n\n    @Override\n    public String toString() {\n        StringBuilder builder = new StringBuilder(&quot;MultiKey[&quot;);\n\n        boolean first = true;\n\n        for (Object o : values) {\n            if (!first)\n                builder.append(&quot;, &quot;);\n\n            builder.append(o);\n\n            first = false;\n        }\n\n        builder.append(&quot;]&quot;);\n\n        return builder.toString();\n    }\n\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1700163272,"post_id":77486681,"comment_id":136624107,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/77486681/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":1248933,"reputation":133,"user_id":1209768,"accept_rate":50,"display_name":"mishka"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700041830,"creation_date":1700041830,"answer_id":77486681,"question_id":2501449,"body_markdown":"CompositeMap of commons collections 4 does the job\r\n\r\n","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>CompositeMap of commons collections 4 does the job</p>\n"}],"owner":{"account_id":110220,"reputation":37362,"user_id":291741,"accept_rate":87,"display_name":"Chris Lercher"},"comment_count":9,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":34057,"favorite_count":0,"down_vote_count":0,"up_vote_count":65,"accepted_answer_id":2501490,"answer_count":16,"score":65,"last_activity_date":1700041830,"creation_date":1269359852,"question_id":2501449,"body_markdown":"I&#39;m looking for the most basic solution to create multiple indexes on a Java Collection.\r\n\r\nRequired functionality:\r\n\r\n- When a Value is removed, all index entries associated with that value must be removed.\r\n- Index lookup must be faster than linear search (at least as fast as a TreeMap).\r\n\r\nSide conditions:\r\n\r\n- No dependencies on large (like Lucene) libraries. No uncommon or not well tested libraries. No database.\r\n- A library like Apache Commons Collections etc. would be ok.\r\n- Even better, if it works with JavaSE (6.0) alone.\r\n- **Edit:** No self-implemented solution (thanks for the answers suggesting this - it&#39;s good to have them here for completeness, but I already have a solution very similar to Jay&#39;s) *Whenever several people find out, that they implemented the same thing, this should be part of some common library.*\r\n\r\nOf course, I could write a class that manages multiple Maps myself *(that&#39;s not hard, but it feels like reinventing the wheel)*. So I&#39;d like to know, if it can be done without - while still getting a simple usage similar to using a single indexed java.util.Map. \r\n\r\nThanks, Chris\r\n\r\n&lt;h2&gt;Update&lt;/h2&gt;\r\n\r\nIt looks very much as if we haven&#39;t found anything. I like all your answers - the self developed versions, the links to database-like libraries.\r\n\r\nHere&#39;s what I really want: To have the functionality in (a) Apache Commons Collections or (b) in Google Collections/Guava. Or maybe a very good alternative.\r\n\r\nDo other people miss this functionality in these libraries, too? They do provide all sorts of things like MultiMaps, MulitKeyMaps, BidiMaps, ... I feel, it would fit in those libraries nicely - it could be called `MultiIndexMap`. What do you think?","title":"Multiple indexes for a Java Collection - most basic solution?","body":"<p>I'm looking for the most basic solution to create multiple indexes on a Java Collection.</p>\n\n<p>Required functionality:</p>\n\n<ul>\n<li>When a Value is removed, all index entries associated with that value must be removed.</li>\n<li>Index lookup must be faster than linear search (at least as fast as a TreeMap).</li>\n</ul>\n\n<p>Side conditions:</p>\n\n<ul>\n<li>No dependencies on large (like Lucene) libraries. No uncommon or not well tested libraries. No database.</li>\n<li>A library like Apache Commons Collections etc. would be ok.</li>\n<li>Even better, if it works with JavaSE (6.0) alone.</li>\n<li><strong>Edit:</strong> No self-implemented solution (thanks for the answers suggesting this - it's good to have them here for completeness, but I already have a solution very similar to Jay's) <em>Whenever several people find out, that they implemented the same thing, this should be part of some common library.</em></li>\n</ul>\n\n<p>Of course, I could write a class that manages multiple Maps myself <em>(that's not hard, but it feels like reinventing the wheel)</em>. So I'd like to know, if it can be done without - while still getting a simple usage similar to using a single indexed java.util.Map. </p>\n\n<p>Thanks, Chris</p>\n\n<h2>Update</h2>\n\n<p>It looks very much as if we haven't found anything. I like all your answers - the self developed versions, the links to database-like libraries.</p>\n\n<p>Here's what I really want: To have the functionality in (a) Apache Commons Collections or (b) in Google Collections/Guava. Or maybe a very good alternative.</p>\n\n<p>Do other people miss this functionality in these libraries, too? They do provide all sorts of things like MultiMaps, MulitKeyMaps, BidiMaps, ... I feel, it would fit in those libraries nicely - it could be called <code>MultiIndexMap</code>. What do you think?</p>\n"},{"tags":["java","csv","delimiter","separator"],"comments":[{"owner":{"account_id":279943,"reputation":202411,"user_id":575376,"accept_rate":82,"display_name":"juergen d"},"score":0,"creation_date":1325062976,"post_id":8653797,"comment_id":10751940,"body_markdown":"You could write your own lib. There is not much to it. Read every line from the file and split it with your regex or delimiters.","body":"You could write your own lib. There is not much to it. Read every line from the file and split it with your regex or delimiters."},{"owner":{"account_id":378959,"reputation":19465,"user_id":834316,"accept_rate":82,"display_name":"PNS"},"score":4,"creation_date":1325063574,"post_id":8653797,"comment_id":10752076,"body_markdown":"Not so straightforward, because CSV can have quoted fields, multiline records, etc. Also, there are countless options on quotes, escape characters, etc. Have a look at http://secretgeek.net/csv_trouble.asp for a funny overview fo the issues you may run into.","body":"Not so straightforward, because CSV can have quoted fields, multiline records, etc. Also, there are countless options on quotes, escape characters, etc. Have a look at <a href=\"http://secretgeek.net/csv_trouble.asp\" rel=\"nofollow noreferrer\">secretgeek.net/csv_trouble.asp</a> for a funny overview fo the issues you may run into."},{"owner":{"account_id":446514,"reputation":6212,"user_id":839601,"display_name":"gnat"},"score":0,"creation_date":1325063577,"post_id":8653797,"comment_id":10752079,"body_markdown":"did you check [FlatPack](http://flatpack.sourceforge.net/)? I ask because per [my past research](http://stackoverflow.com/a/6657525/839601) this library seemed to have much richer API than OpenCSV","body":"did you check <a href=\"http://flatpack.sourceforge.net/\" rel=\"nofollow noreferrer\">FlatPack</a>? I ask because per <a href=\"http://stackoverflow.com/a/6657525/839601\">my past research</a> this library seemed to have much richer API than OpenCSV"},{"owner":{"account_id":294406,"reputation":24602,"user_id":598289,"accept_rate":85,"display_name":"SJuan76"},"score":0,"creation_date":1325063783,"post_id":8653797,"comment_id":10752123,"body_markdown":"If you need to allow for the separator to be part of the data, either by quoting `007,&quot;My name is Bond, James Bond&quot;` or by escaping `007,My name is Bond\\, James Bond` then it becomes a lot more complicated (most in the former case). The Asker does not specify if it is needed, though.","body":"If you need to allow for the separator to be part of the data, either by quoting <code>007,&quot;My name is Bond, James Bond&quot;</code> or by escaping <code>007,My name is Bond\\, James Bond</code> then it becomes a lot more complicated (most in the former case). The Asker does not specify if it is needed, though."},{"owner":{"account_id":378959,"reputation":19465,"user_id":834316,"accept_rate":82,"display_name":"PNS"},"score":1,"creation_date":1325063944,"post_id":8653797,"comment_id":10752149,"body_markdown":"That would be a need, indeed, which is why (among many other reasons) a mature library is preferable, but all the ones I have played with seem to support on single-character separators.","body":"That would be a need, indeed, which is why (among many other reasons) a mature library is preferable, but all the ones I have played with seem to support on single-character separators."},{"owner":{"account_id":378959,"reputation":19465,"user_id":834316,"accept_rate":82,"display_name":"PNS"},"score":1,"creation_date":1325064054,"post_id":8653797,"comment_id":10752176,"body_markdown":"@gnat FlatPack seems to support only single-character separators, as well.","body":"@gnat FlatPack seems to support only single-character separators, as well."},{"owner":{"account_id":446514,"reputation":6212,"user_id":839601,"display_name":"gnat"},"score":0,"creation_date":1325064728,"post_id":8653797,"comment_id":10752331,"body_markdown":"I see. Did you consider _two-step approach_, then? I mean 1) replace your multi-character sequence with single char of your choice then 2) feed the result to openCSV or whatever lib","body":"I see. Did you consider <i>two-step approach</i>, then? I mean 1) replace your multi-character sequence with single char of your choice then 2) feed the result to openCSV or whatever lib"},{"owner":{"account_id":378959,"reputation":19465,"user_id":834316,"accept_rate":82,"display_name":"PNS"},"score":2,"creation_date":1325064960,"post_id":8653797,"comment_id":10752386,"body_markdown":"@gnat As I say in the question, &quot;So, for data separated with strings like &quot;|||&quot; there is no other option that preprocessing the input in order to transform the string to a single-character delimiter.&quot; :-)","body":"@gnat As I say in the question, &quot;So, for data separated with strings like &quot;|||&quot; there is no other option that preprocessing the input in order to transform the string to a single-character delimiter.&quot; :-)"}],"answers":[{"comments":[{"owner":{"account_id":378959,"reputation":19465,"user_id":834316,"accept_rate":82,"display_name":"PNS"},"score":3,"creation_date":1325063822,"post_id":8653909,"comment_id":10752131,"body_markdown":"OpenCSV is an excellent library, but it only supports single-character separators, not multi-character ones.","body":"OpenCSV is an excellent library, but it only supports single-character separators, not multi-character ones."},{"owner":{"account_id":378959,"reputation":19465,"user_id":834316,"accept_rate":82,"display_name":"PNS"},"score":0,"creation_date":1325066220,"post_id":8653909,"comment_id":10752634,"body_markdown":"The issue is not handling any form of single-character delimiters (including embedded ones), but handling multi-character delimiters. :-)","body":"The issue is not handling any form of single-character delimiters (including embedded ones), but handling multi-character delimiters. :-)"},{"owner":{"account_id":378959,"reputation":19465,"user_id":834316,"accept_rate":82,"display_name":"PNS"},"score":0,"creation_date":1325067850,"post_id":8653909,"comment_id":10752969,"body_markdown":"Yes, that&#39;s the &quot;preprocessing&quot; step I was talking about in the question, thanks.","body":"Yes, that&#39;s the &quot;preprocessing&quot; step I was talking about in the question, thanks."},{"owner":{"account_id":20937,"reputation":167576,"user_id":50476,"accept_rate":100,"display_name":"Bart Kiers"},"score":0,"creation_date":1325071994,"post_id":8653909,"comment_id":10753874,"body_markdown":"But such a replacement would not make a distinction between delimiters in- or outside quoted values.","body":"But such a replacement would not make a distinction between delimiters in- or outside quoted values."},{"owner":{"account_id":378959,"reputation":19465,"user_id":834316,"accept_rate":82,"display_name":"PNS"},"score":0,"creation_date":1325077700,"post_id":8653909,"comment_id":10755199,"body_markdown":"It won&#39;t, but the &quot;restoration&quot; of the original value fixes that. In general, preprocessing is doable but not optimal, which is why I posted the question in the first place.","body":"It won&#39;t, but the &quot;restoration&quot; of the original value fixes that. In general, preprocessing is doable but not optimal, which is why I posted the question in the first place."}],"tags":[],"owner":{"account_id":93689,"reputation":415951,"user_id":256196,"accept_rate":77,"display_name":"Bohemian"},"comment_count":5,"down_vote_count":3,"up_vote_count":1,"is_accepted":false,"score":-2,"last_activity_date":1325067072,"creation_date":1325063587,"answer_id":8653909,"question_id":8653797,"body_markdown":"Try [opencsv][1].\n\nIt does everything you need, including (and especially) handling embedded delimiters within quoted values (eg `&quot;a,b&quot;, &quot;c&quot;` parses as `[&quot;a,b&quot;, &quot;c&quot;]`)\n\nI&#39;ve used it successfully and I liked it.\n\n### Edited:\n\nSince opencsv handles only single-character separators, you could work around this thus:\n\n    String input;\n    char someCharNotInInput = &#39;|&#39;;\n    String delimiter = &quot;abc&quot;; // or whatever\n    input.replaceAll(delimiter, someCharNotInInput);\n    new CSVReader(input, someCharNotInInput); // etc\n    // Put it back into each value read\n    value.replaceAll(someCharNotInInput, delimiter); // in case it&#39;s inside delimiters\n    \n    \n\n  [1]: http://opencsv.sourceforge.net/","title":"Java CSV parser with string separator (multi-character)","body":"<p>Try <a href=\"http://opencsv.sourceforge.net/\" rel=\"nofollow noreferrer\">opencsv</a>.</p>\n<p>It does everything you need, including (and especially) handling embedded delimiters within quoted values (eg <code>&quot;a,b&quot;, &quot;c&quot;</code> parses as <code>[&quot;a,b&quot;, &quot;c&quot;]</code>)</p>\n<p>I've used it successfully and I liked it.</p>\n<h3>Edited:</h3>\n<p>Since opencsv handles only single-character separators, you could work around this thus:</p>\n<pre><code>String input;\nchar someCharNotInInput = '|';\nString delimiter = &quot;abc&quot;; // or whatever\ninput.replaceAll(delimiter, someCharNotInInput);\nnew CSVReader(input, someCharNotInInput); // etc\n// Put it back into each value read\nvalue.replaceAll(someCharNotInInput, delimiter); // in case it's inside delimiters\n</code></pre>\n"},{"comments":[{"owner":{"account_id":378959,"reputation":19465,"user_id":834316,"accept_rate":82,"display_name":"PNS"},"score":0,"creation_date":1325506081,"post_id":8689450,"comment_id":10824698,"body_markdown":"Mark, the &quot;field ignoring&quot; approach is clever, but it won&#39;t work for strings that consist of more than 1 different characters.\n\nWhat I have also thought is using the first (or last) character of the string delimiter as the separator and then remove the remaining part of the delimiter, which would appear at the start of every field. Still, this won&#39;t work if that character is a common one, i.e. it is encountered in more places than the number of delimiters.\n\nThe &quot;rolling your own option&quot; is not as easy as it first seems. Check secretgeek.net/csv_trouble.asp for some good reasons why.","body":"Mark, the &quot;field ignoring&quot; approach is clever, but it won&#39;t work for strings that consist of more than 1 different characters.  What I have also thought is using the first (or last) character of the string delimiter as the separator and then remove the remaining part of the delimiter, which would appear at the start of every field. Still, this won&#39;t work if that character is a common one, i.e. it is encountered in more places than the number of delimiters.  The &quot;rolling your own option&quot; is not as easy as it first seems. Check secretgeek.net/csv_trouble.asp for some good reasons why."},{"owner":{"account_id":93866,"reputation":76253,"user_id":256618,"display_name":"Mark O&#39;Connor"},"score":1,"creation_date":1325532565,"post_id":8689450,"comment_id":10831229,"body_markdown":"I understand the limitations with both solutions. As stated the &quot;field ignoring&quot; approach is really only good for parsing well behaved data. As you noted if someone uses an incorrect number of separation characters it breaks assumptions you&#39;ve made about the data. The &quot;rolling your own&quot; option is really to prove that it can be done, I&#39;d never bother, again, unless the data is incredibly well behaved. In my experience CSV data rarely is.....","body":"I understand the limitations with both solutions. As stated the &quot;field ignoring&quot; approach is really only good for parsing well behaved data. As you noted if someone uses an incorrect number of separation characters it breaks assumptions you&#39;ve made about the data. The &quot;rolling your own&quot; option is really to prove that it can be done, I&#39;d never bother, again, unless the data is incredibly well behaved. In my experience CSV data rarely is....."},{"owner":{"account_id":378959,"reputation":19465,"user_id":834316,"accept_rate":82,"display_name":"PNS"},"score":0,"creation_date":1325768724,"post_id":8689450,"comment_id":10890169,"body_markdown":"You are right. My experience, too, concurs that CSV data is often not well-formed. +1","body":"You are right. My experience, too, concurs that CSV data is often not well-formed. +1"},{"owner":{"account_id":1397052,"reputation":4689,"user_id":1326627,"accept_rate":72,"display_name":"Luis Mu&#241;iz"},"score":0,"creation_date":1354701355,"post_id":8689450,"comment_id":18846692,"body_markdown":"FWIW, here&#39;s my €0.02: Create a preprocessing Reader that will transform whatever String sequence into a Character, and feed this reader to openCSV.","body":"FWIW, here&#39;s my €0.02: Create a preprocessing Reader that will transform whatever String sequence into a Character, and feed this reader to openCSV."},{"owner":{"account_id":3183722,"reputation":661,"user_id":2689892,"display_name":"Mark Teese"},"score":0,"creation_date":1541416680,"post_id":8689450,"comment_id":93197010,"body_markdown":"Apache Commons CSV doesn&#39;t seem to have this function either. According to [withRecordSeparator](https://commons.apache.org/proper/commons-csv/apidocs/org/apache/commons/csv/CSVFormat.html#withRecordSeparator-char-) documentation, Parsing currently only works for inputs with &#39;\\n&#39;, &#39;\\r&#39; and &quot;\\r\\n&quot;.","body":"Apache Commons CSV doesn&#39;t seem to have this function either. According to <a href=\"https://commons.apache.org/proper/commons-csv/apidocs/org/apache/commons/csv/CSVFormat.html#withRecordSeparator-char-\" rel=\"nofollow noreferrer\">withRecordSeparator</a> documentation, Parsing currently only works for inputs with &#39;\\n&#39;, &#39;\\r&#39; and &quot;\\r\\n&quot;."}],"tags":[],"owner":{"account_id":93866,"reputation":76253,"user_id":256618,"display_name":"Mark O&#39;Connor"},"comment_count":5,"down_vote_count":0,"up_vote_count":5,"is_accepted":true,"score":5,"last_activity_date":1325532779,"creation_date":1325351838,"answer_id":8689450,"question_id":8653797,"body_markdown":"This is a good question. The problem was not obvious to me until I looked at the [javadocs][1] and realised that opencsv only supports a character as a separator, not a string....\r\n\r\nHere&#39;s a couple of suggested work-arounds (Examples in Groovy can be converted to java).\r\n\r\nIgnore implicit intermediary fields\r\n====================================\r\nContinue to Use OpenCSV, but ignore the empty fields. Obviously this is a cheat, but it will work fine for parsing well-behaved data. \r\n\r\n        CSVParser csv = new CSVParser((char)&#39;|&#39;)\r\n\r\n        String[] result = csv.parseLine(&#39;J||Project report||&quot;F, G, I&quot;||1&#39;)\r\n\r\n        assert result[0] == &quot;J&quot;\r\n        assert result[2] == &quot;Project report&quot;\r\n        assert result[4] == &quot;F, G, I&quot;\r\n        assert result[6] == &quot;1&quot;\r\n\r\nor\r\n\r\n        CSVParser csv = new CSVParser((char)&#39;|&#39;)\r\n\r\n        String[] result = csv.parseLine(&#39;J|||Project report|||&quot;F, G, I&quot;|||1&#39;)\r\n\r\n        assert result[0] == &quot;J&quot;\r\n        assert result[3] == &quot;Project report&quot;\r\n        assert result[6] == &quot;F, G, I&quot;\r\n        assert result[9] == &quot;1&quot;\r\n\r\n\r\nRoll your own\r\n=============\r\nUse the Java String [tokenizer][2] method. \r\n\r\n        def result = &#39;J|||Project report|||&quot;F, G, I&quot;|||1&#39;.tokenize(&#39;|||&#39;)\r\n\r\n        assert result[0] == &quot;J&quot;\r\n        assert result[1] == &quot;Project report&quot;\r\n        assert result[2] == &quot;\\&quot;F, G, I\\&quot;&quot;\r\n        assert result[3] == &quot;1&quot;\r\n\r\nDisadvantage of this approach is that you lose the ability to ignore quote characters or escape separators..\r\n\r\nUpdate\r\n======\r\nInstead of pre-processing the data, altering it&#39;s content, why not combine both of the above approaches in a two step process:\r\n\r\n 1. Use the &quot;roll your own&quot; to first validate the data. Split each line and prove that it contains the requiste number of fields.\r\n 2. Use the &quot;field ignoring&quot; approach to parse the validated data, secure in the knowledge that the correct number of fields have been specified.\r\n\r\nNot very efficient, but possibly easier that writing your own CSV parser :-)\r\n\r\n  [1]: http://opencsv.sourceforge.net/apidocs/au/com/bytecode/opencsv/CSVParser.html\r\n  [2]: http://docs.oracle.com/javase/1.4.2/docs/api/java/util/StringTokenizer.html","title":"Java CSV parser with string separator (multi-character)","body":"<p>This is a good question. The problem was not obvious to me until I looked at the <a href=\"http://opencsv.sourceforge.net/apidocs/au/com/bytecode/opencsv/CSVParser.html\" rel=\"nofollow\">javadocs</a> and realised that opencsv only supports a character as a separator, not a string....</p>\n\n<p>Here's a couple of suggested work-arounds (Examples in Groovy can be converted to java).</p>\n\n<h1>Ignore implicit intermediary fields</h1>\n\n<p>Continue to Use OpenCSV, but ignore the empty fields. Obviously this is a cheat, but it will work fine for parsing well-behaved data. </p>\n\n<pre><code>    CSVParser csv = new CSVParser((char)'|')\n\n    String[] result = csv.parseLine('J||Project report||\"F, G, I\"||1')\n\n    assert result[0] == \"J\"\n    assert result[2] == \"Project report\"\n    assert result[4] == \"F, G, I\"\n    assert result[6] == \"1\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>    CSVParser csv = new CSVParser((char)'|')\n\n    String[] result = csv.parseLine('J|||Project report|||\"F, G, I\"|||1')\n\n    assert result[0] == \"J\"\n    assert result[3] == \"Project report\"\n    assert result[6] == \"F, G, I\"\n    assert result[9] == \"1\"\n</code></pre>\n\n<h1>Roll your own</h1>\n\n<p>Use the Java String <a href=\"http://docs.oracle.com/javase/1.4.2/docs/api/java/util/StringTokenizer.html\" rel=\"nofollow\">tokenizer</a> method. </p>\n\n<pre><code>    def result = 'J|||Project report|||\"F, G, I\"|||1'.tokenize('|||')\n\n    assert result[0] == \"J\"\n    assert result[1] == \"Project report\"\n    assert result[2] == \"\\\"F, G, I\\\"\"\n    assert result[3] == \"1\"\n</code></pre>\n\n<p>Disadvantage of this approach is that you lose the ability to ignore quote characters or escape separators..</p>\n\n<h1>Update</h1>\n\n<p>Instead of pre-processing the data, altering it's content, why not combine both of the above approaches in a two step process:</p>\n\n<ol>\n<li>Use the \"roll your own\" to first validate the data. Split each line and prove that it contains the requiste number of fields.</li>\n<li>Use the \"field ignoring\" approach to parse the validated data, secure in the knowledge that the correct number of fields have been specified.</li>\n</ol>\n\n<p>Not very efficient, but possibly easier that writing your own CSV parser :-)</p>\n"},{"tags":[],"owner":{"account_id":130009,"reputation":9672,"user_id":328968,"accept_rate":70,"display_name":"Peter"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1539371190,"creation_date":1539371190,"answer_id":52785658,"question_id":8653797,"body_markdown":"None of these solutions worked for me, because they all assumed you could store the entire CSV file in memory allowing for easy `replaceAll` type actions.\r\n\r\nI know it&#39;s slow, but I went with `Scanner`. It has a surprising number of features, and makes rolling your own simple CSV reader with any string you want as a record delimiter. It also lets you parse very large CSV files (I&#39;ve done 10GB single files before), since you can read records one at a time.\r\n\r\n    Scanner s = new Scanner(inputStream, &quot;UTF-8&quot;).useDelimiter(&quot;&gt;|\\n&quot;);\r\n\r\nI would prefer a faster solution, but no library I&#39;ve found supports it. FasterXML has had an open ticket to add this funcitonality since early 2017: https://github.com/FasterXML/jackson-dataformats-text/issues/14","title":"Java CSV parser with string separator (multi-character)","body":"<p>None of these solutions worked for me, because they all assumed you could store the entire CSV file in memory allowing for easy <code>replaceAll</code> type actions.</p>\n\n<p>I know it's slow, but I went with <code>Scanner</code>. It has a surprising number of features, and makes rolling your own simple CSV reader with any string you want as a record delimiter. It also lets you parse very large CSV files (I've done 10GB single files before), since you can read records one at a time.</p>\n\n<pre><code>Scanner s = new Scanner(inputStream, \"UTF-8\").useDelimiter(\"&gt;|\\n\");\n</code></pre>\n\n<p>I would prefer a faster solution, but no library I've found supports it. FasterXML has had an open ticket to add this funcitonality since early 2017: <a href=\"https://github.com/FasterXML/jackson-dataformats-text/issues/14\" rel=\"nofollow noreferrer\">https://github.com/FasterXML/jackson-dataformats-text/issues/14</a></p>\n"},{"tags":[],"owner":{"account_id":26036073,"reputation":11,"user_id":19741500,"display_name":"Niranjan Ravichandran"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1660206309,"creation_date":1660206309,"answer_id":73317533,"question_id":8653797,"body_markdown":"\r\n\r\nWorkAround to use delimiter || : Add dummy fields in between the needed columns\r\n\r\n    public class ClassName {\r\n    \t@CsvBindByPosition(position = 0)\r\n    \tprivate String column1;\r\n    \t@CsvBindByPosition(position = 1)\r\n    \tprivate String dummy1;\r\n    \t@CsvBindByPosition(position = 2)\r\n    \tprivate String column2;\r\n    \t@CsvBindByPosition(position = 3)\r\n    \tprivate String dummy2;\r\n    \t@CsvBindByPosition(position = 4)\r\n    \tprivate String column3;\r\n    \t@CsvBindByPosition(position = 5)\r\n    \tprivate String dummy5;\r\n        @CsvBindByPosition(position = 6)\r\n    \tprivate String column4;\r\n    }\r\n    And then parse them using \r\n    List&lt;ClassName&gt; responses = new CsvToBeanBuilder&lt;ClassName&gt;(new FileReader(&quot;test.csv&quot;))\r\n                    .withType(ClassName.class)\r\n                    .withSkipLines(1) // to skip header\r\n                    .withSeparator(&#39;|&#39;)\r\n                    // to parse || , we use |\r\n                    .build()\r\n                    .parse();","title":"Java CSV parser with string separator (multi-character)","body":"<p>WorkAround to use delimiter || : Add dummy fields in between the needed columns</p>\n<pre><code>public class ClassName {\n    @CsvBindByPosition(position = 0)\n    private String column1;\n    @CsvBindByPosition(position = 1)\n    private String dummy1;\n    @CsvBindByPosition(position = 2)\n    private String column2;\n    @CsvBindByPosition(position = 3)\n    private String dummy2;\n    @CsvBindByPosition(position = 4)\n    private String column3;\n    @CsvBindByPosition(position = 5)\n    private String dummy5;\n    @CsvBindByPosition(position = 6)\n    private String column4;\n}\nAnd then parse them using \nList&lt;ClassName&gt; responses = new CsvToBeanBuilder&lt;ClassName&gt;(new FileReader(&quot;test.csv&quot;))\n                .withType(ClassName.class)\n                .withSkipLines(1) // to skip header\n                .withSeparator('|')\n                // to parse || , we use |\n                .build()\n                .parse();\n</code></pre>\n"},{"comments":[{"owner":{"account_id":5401349,"reputation":698,"user_id":8137610,"display_name":"Shuai Liu"},"score":0,"creation_date":1698732554,"post_id":74181990,"comment_id":136439208,"body_markdown":"This should be the simplist solution, it work for me,","body":"This should be the simplist solution, it work for me,"},{"owner":{"account_id":5401349,"reputation":698,"user_id":8137610,"display_name":"Shuai Liu"},"score":0,"creation_date":1700038680,"post_id":74181990,"comment_id":136604649,"body_markdown":"if the input stream is gzip stream, the commons-csv 1.10.0 will parse the column  which delimited by   multiple-characters  incorrectly, use carefully","body":"if the input stream is gzip stream, the commons-csv 1.10.0 will parse the column  which delimited by   multiple-characters  incorrectly, use carefully"}],"tags":[],"owner":{"account_id":2578634,"reputation":162,"user_id":2235787,"accept_rate":100,"display_name":"Andrei Filipchyk"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1666618863,"creation_date":1666618863,"answer_id":74181990,"question_id":8653797,"body_markdown":"In 2022 openCSV version 5.7.1 still doesn&#39;t support multi-character separator.\r\n\r\nSolution - use appache commons-csv, version 1.9.0 support multi-character separator!\r\n\r\nCSVFormat.Builder.create().setDelimiter(separator);","title":"Java CSV parser with string separator (multi-character)","body":"<p>In 2022 openCSV version 5.7.1 still doesn't support multi-character separator.</p>\n<p>Solution - use appache commons-csv, version 1.9.0 support multi-character separator!</p>\n<p>CSVFormat.Builder.create().setDelimiter(separator);</p>\n"},{"tags":[],"owner":{"account_id":5401349,"reputation":698,"user_id":8137610,"display_name":"Shuai Liu"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1700041776,"creation_date":1700039250,"answer_id":77486397,"question_id":8653797,"body_markdown":"Try [**univocity-parsers**][1], which supports multi-character delimiters and has the best performance.\r\n\r\nAs for **commons-csv**: If the input stream is a **gzip stream**, commons-csv 1.10.0 will incorrectly parse columns delimited by multiple characters, so use it carefully.\r\n\r\n\r\n  [1]: https://github.com/uniVocity/univocity-parsers","title":"Java CSV parser with string separator (multi-character)","body":"<p>Try <a href=\"https://github.com/uniVocity/univocity-parsers\" rel=\"nofollow noreferrer\"><strong>univocity-parsers</strong></a>, which supports multi-character delimiters and has the best performance.</p>\n<p>As for <strong>commons-csv</strong>: If the input stream is a <strong>gzip stream</strong>, commons-csv 1.10.0 will incorrectly parse columns delimited by multiple characters, so use it carefully.</p>\n"}],"owner":{"account_id":378959,"reputation":19465,"user_id":834316,"accept_rate":82,"display_name":"PNS"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":22638,"favorite_count":0,"down_vote_count":0,"up_vote_count":20,"accepted_answer_id":8689450,"answer_count":6,"score":20,"last_activity_date":1700041776,"creation_date":1325062817,"question_id":8653797,"body_markdown":"Is there any Java open source library that supports **multi-character** (i.e., String with length &gt; 1) separators (delimiters) for CSV?\r\n\r\nBy definition, CSV = Comma-Separated Values data with a single character (&#39;,&#39;) as the delimiter. However, many other single-character alternatives exist (e.g., tab), making CSV to stand for &quot;Character-Separated Values&quot; data (essentially, DSV: Delimiter-Separated Values data).\r\n\r\nMain Java open source libraries for CSV (e.g., [OpenCSV][1]) support virtually any character as the delimiter, but not string (multi-character) delimiters. So, for data separated with strings like &quot;|||&quot; there is no other option than preprocessing the input in order to transform the string to a single-character delimiter. From then on, the data can be parsed as single-character separated values.\r\n\r\nIt would therefore be nice if there was a library that supported string separators natively, so that no preprocessing was necessary. This would mean that CSV now standed for &quot;CharSequence-Separated Values&quot; data. :-)\r\n\r\n\r\n  [1]: http://opencsv.sourceforge.net/","title":"Java CSV parser with string separator (multi-character)","body":"<p>Is there any Java open source library that supports <strong>multi-character</strong> (i.e., String with length > 1) separators (delimiters) for CSV?</p>\n\n<p>By definition, CSV = Comma-Separated Values data with a single character (',') as the delimiter. However, many other single-character alternatives exist (e.g., tab), making CSV to stand for \"Character-Separated Values\" data (essentially, DSV: Delimiter-Separated Values data).</p>\n\n<p>Main Java open source libraries for CSV (e.g., <a href=\"http://opencsv.sourceforge.net/\" rel=\"noreferrer\">OpenCSV</a>) support virtually any character as the delimiter, but not string (multi-character) delimiters. So, for data separated with strings like \"|||\" there is no other option than preprocessing the input in order to transform the string to a single-character delimiter. From then on, the data can be parsed as single-character separated values.</p>\n\n<p>It would therefore be nice if there was a library that supported string separators natively, so that no preprocessing was necessary. This would mean that CSV now standed for \"CharSequence-Separated Values\" data. :-)</p>\n"},{"tags":["java","object","compiler-errors","pattern-matching","instanceof"],"comments":[{"owner":{"account_id":2709823,"reputation":10716,"user_id":2338547,"display_name":"markspace"},"score":0,"creation_date":1699535604,"post_id":77453336,"comment_id":136546035,"body_markdown":"`but why is pattern matching not doing it?` It&#39;s new syntax that does the initialization for you.  If you don&#39;t have new features available or enabled, you won&#39;t be able to compile and run that code.","body":"<code>but why is pattern matching not doing it?</code> It&#39;s new syntax that does the initialization for you.  If you don&#39;t have new features available or enabled, you won&#39;t be able to compile and run that code."},{"owner":{"account_id":29161129,"reputation":86,"user_id":22339877,"display_name":"Flavian Diol D"},"score":0,"creation_date":1699536891,"post_id":77453336,"comment_id":136546326,"body_markdown":"I use JDK 17, which has the feature, it&#39;s not about enabling or disabling, I believe. It&#39;s about using &#39;&amp;&#39; or &#39;&amp;&amp;&#39;. I would want you to try the code out, and let me know if you find anything. Thank you.","body":"I use JDK 17, which has the feature, it&#39;s not about enabling or disabling, I believe. It&#39;s about using &#39;&amp;&#39; or &#39;&amp;&amp;&#39;. I would want you to try the code out, and let me know if you find anything. Thank you."},{"owner":{"account_id":204515,"reputation":11679,"user_id":452775,"accept_rate":63,"display_name":"Lii"},"score":1,"creation_date":1700151039,"post_id":77453336,"comment_id":136621905,"body_markdown":"The author of the bock you cite, Herbert Schildt, apparently has [quite a reputation](https://en.wikipedia.org/wiki/Herbert_Schildt#Reception) for writing programmings books on various languages that are riddled with errors. For example, [the following has been said](https://www.seebs.net/c/c_tcn3e.html) about his C book from the 90:s: _&quot;describing a language subtly but quite definitely different from C&quot;_. Your quote seems to confirm that. It is not only wrong about `&amp;`, it has horrible formatting and fail to use auto-boxing, which as been in the language for 20 years.","body":"The author of the bock you cite, Herbert Schildt, apparently has <a href=\"https://en.wikipedia.org/wiki/Herbert_Schildt#Reception\" rel=\"nofollow noreferrer\">quite a reputation</a> for writing programmings books on various languages that are riddled with errors. For example, <a href=\"https://www.seebs.net/c/c_tcn3e.html\" rel=\"nofollow noreferrer\">the following has been said</a> about his C book from the 90:s: <i>&quot;describing a language subtly but quite definitely different from C&quot;</i>. Your quote seems to confirm that. It is not only wrong about <code>&amp;</code>, it has horrible formatting and fail to use auto-boxing, which as been in the language for 20 years."},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":2,"creation_date":1702029662,"post_id":77453336,"comment_id":136850206,"body_markdown":"In addition to @Lii’s comment, you should note that even the first example is wrong. The comment says “*myOb is both an Integer and nonnegative*” but the condition did not check whether the value is nonnegative. My guess is that the author copied the example from somewhere else and it originally was `myOb instanceof Integer iObj &amp;&amp; iObj &gt;= 0` where everything made sense, the value was guaranteed to be non-negative and it can’t work that way with `&amp;`. Then, he decided to modify the example to create his own, but broke it completely.","body":"In addition to @Lii’s comment, you should note that even the first example is wrong. The comment says “<i>myOb is both an Integer and nonnegative</i>” but the condition did not check whether the value is nonnegative. My guess is that the author copied the example from somewhere else and it originally was <code>myOb instanceof Integer iObj &amp;&amp; iObj &gt;= 0</code> where everything made sense, the value was guaranteed to be non-negative and it can’t work that way with <code>&amp;</code>. Then, he decided to modify the example to create his own, but broke it completely."}],"answers":[{"comments":[{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1699538279,"post_id":77453728,"comment_id":136546622,"body_markdown":"The `&amp;` in the question is a BITWISE Operation. It is meant to take in 2 values and produce a numeric value. That can work fine with pattern-matching, but requires the OP to use it correctly, and they didn&#39;t","body":"The <code>&amp;</code> in the question is a BITWISE Operation. It is meant to take in 2 values and produce a numeric value. That can work fine with pattern-matching, but requires the OP to use it correctly, and they didn&#39;t"},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1699538842,"post_id":77453728,"comment_id":136546750,"body_markdown":"I see your edit. No, it is not a bug. Here, I&#39;ll finish up my answer and post.","body":"I see your edit. No, it is not a bug. Here, I&#39;ll finish up my answer and post."},{"owner":{"account_id":1692034,"reputation":3196,"user_id":1554195,"display_name":"tquadrat"},"score":0,"creation_date":1699539299,"post_id":77453728,"comment_id":136546827,"body_markdown":"It is bitwise operation, but it can be used for `boolean` operations, too. Read the JLS, 15.22.2! Ok, it is bitwise `boolean` …","body":"It is bitwise operation, but it can be used for <code>boolean</code> operations, too. Read the JLS, 15.22.2! Ok, it is bitwise <code>boolean</code> …"},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1699539350,"post_id":77453728,"comment_id":136546844,"body_markdown":"I know, but that&#39;s my point. `boolean` is a primitive, and that&#39;s the problem. Like I said, I am typing up my answer, and I will address this then.","body":"I know, but that&#39;s my point. <code>boolean</code> is a primitive, and that&#39;s the problem. Like I said, I am typing up my answer, and I will address this then."},{"owner":{"account_id":29161129,"reputation":86,"user_id":22339877,"display_name":"Flavian Diol D"},"score":0,"creation_date":1699541984,"post_id":77453728,"comment_id":136547472,"body_markdown":"I&#39;m sorry but I guess you mistook the question, - @tquadrat. &quot;But when I use &amp;&amp;, it complains about the assignment/declaration in the body, because &#180;iObj` was already declared … strange!!&quot;. This is not strange, as the whole idea of pattern matching was not to initialise a variable by seperate typecasting. Kindly refer https://docs.oracle.com/en/java/javase/17/language/pattern-matching.html to know more.","body":"I&#39;m sorry but I guess you mistook the question, - @tquadrat. &quot;But when I use &amp;&amp;, it complains about the assignment/declaration in the body, because &#180;iObj` was already declared … strange!!&quot;. This is not strange, as the whole idea of pattern matching was not to initialise a variable by seperate typecasting. Kindly refer <a href=\"https://docs.oracle.com/en/java/javase/17/language/pattern-matching.html\" rel=\"nofollow noreferrer\">docs.oracle.com/en/java/javase/17/language/&hellip;</a> to know more."},{"owner":{"account_id":29161129,"reputation":86,"user_id":22339877,"display_name":"Flavian Diol D"},"score":0,"creation_date":1699542362,"post_id":77453728,"comment_id":136547578,"body_markdown":"@tquadrat, the quotes is taken from a book which is updated upto JDK 17. So I don&#39;t think the issue is with the book being outdated.","body":"@tquadrat, the quotes is taken from a book which is updated upto JDK 17. So I don&#39;t think the issue is with the book being outdated."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1699543512,"post_id":77453728,"comment_id":136547813,"body_markdown":"@FlavianDiolD When I said out-of-date, I meant in relation to Java 21. But either way, that&#39;s not the main problem. I am still typing up my answer. It is a very lengthy answer.","body":"@FlavianDiolD When I said out-of-date, I meant in relation to Java 21. But either way, that&#39;s not the main problem. I am still typing up my answer. It is a very lengthy answer."},{"owner":{"account_id":1692034,"reputation":3196,"user_id":1554195,"display_name":"tquadrat"},"score":0,"creation_date":1699544455,"post_id":77453728,"comment_id":136548002,"body_markdown":"@FlavianDiolD – Strange is the behaviour  of the `&amp;` version in comparison to the `&amp;&amp;` variant … obviously it got not fully clear.","body":"@FlavianDiolD – Strange is the behaviour  of the <code>&amp;</code> version in comparison to the <code>&amp;&amp;</code> variant … obviously it got not fully clear."},{"owner":{"account_id":1692034,"reputation":3196,"user_id":1554195,"display_name":"tquadrat"},"score":0,"creation_date":1699544845,"post_id":77453728,"comment_id":136548108,"body_markdown":"@FlavianDiolD – I never said &quot;outdated&quot;, I said &quot;crap&quot;. Translate that to wrong! The description on how `&amp;&amp;`/`||` works in comparison to `&amp;`/`|` given there is invalid.","body":"@FlavianDiolD – I never said &quot;outdated&quot;, I said &quot;crap&quot;. Translate that to wrong! The description on how <code>&amp;&amp;</code>/<code>||</code> works in comparison to <code>&amp;</code>/<code>|</code> given there is invalid."},{"owner":{"account_id":29161129,"reputation":86,"user_id":22339877,"display_name":"Flavian Diol D"},"score":0,"creation_date":1699619116,"post_id":77453728,"comment_id":136557899,"body_markdown":"@tquadrat - I totally understand that the comparison given there is not valid for the usual cases, but I believe that somehow pattern matching seems to be somewhat of an exception. And I want to know why, and your answer solves the error, which I myself did. I want to know why such an illogical error occurs, for I strongly believe that it is not a bug.","body":"@tquadrat - I totally understand that the comparison given there is not valid for the usual cases, but I believe that somehow pattern matching seems to be somewhat of an exception. And I want to know why, and your answer solves the error, which I myself did. I want to know why such an illogical error occurs, for I strongly believe that it is not a bug."},{"owner":{"account_id":204515,"reputation":11679,"user_id":452775,"accept_rate":63,"display_name":"Lii"},"score":0,"creation_date":1699653942,"post_id":77453728,"comment_id":136563470,"body_markdown":"*&quot;with Java 21, and it works – unexpectedly! But when I use &amp;&amp;, it complains about the assignment/declaration in the body, because `iObj` was already declared … strange!!&quot;* I think I have finally figured this out: With `&amp;&amp;` the pattern declares `iObj`, and there are rules in [JLS 6.3.1](https://docs.oracle.com/javase/specs/jls/se21/html/jls-6.html#jls-6.3.1) to propagate the pattern variable to the if-body. Because of this you can&#39;t use that name again, so the error is natural.","body":"<i>&quot;with Java 21, and it works – unexpectedly! But when I use &amp;&amp;, it complains about the assignment/declaration in the body, because <code>iObj</code> was already declared … strange!!&quot;</i> I think I have finally figured this out: With <code>&amp;&amp;</code> the pattern declares <code>iObj</code>, and there are rules in <a href=\"https://docs.oracle.com/javase/specs/jls/se21/html/jls-6.html#jls-6.3.1\" rel=\"nofollow noreferrer\">JLS 6.3.1</a> to propagate the pattern variable to the if-body. Because of this you can&#39;t use that name again, so the error is natural."},{"owner":{"account_id":204515,"reputation":11679,"user_id":452775,"accept_rate":63,"display_name":"Lii"},"score":1,"creation_date":1699654031,"post_id":77453728,"comment_id":136563484,"body_markdown":"But `&amp;` isn&#39;t mentioned in JLS 6.3.1. You can still use a pattern with `&amp;`, but the pattern variable `iObj` is not propagated to the if-body. Your can only use the pattern variable in the if-test-expression. Because of this the name `iObj` can be reused to declare another variable in the body. What do you think?","body":"But <code>&amp;</code> isn&#39;t mentioned in JLS 6.3.1. You can still use a pattern with <code>&amp;</code>, but the pattern variable <code>iObj</code> is not propagated to the if-body. Your can only use the pattern variable in the if-test-expression. Because of this the name <code>iObj</code> can be reused to declare another variable in the body. What do you think?"},{"owner":{"account_id":1692034,"reputation":3196,"user_id":1554195,"display_name":"tquadrat"},"score":0,"creation_date":1699700811,"post_id":77453728,"comment_id":136566291,"body_markdown":"@Lii – Have you tried that? Something like `if( a instanceof B aB &amp; aB.isValid() ) { …`? I cannot try it myself currently …","body":"@Lii – Have you tried that? Something like <code>if( a instanceof B aB &amp; aB.isValid() ) { …</code>? I cannot try it myself currently …"},{"owner":{"account_id":29161129,"reputation":86,"user_id":22339877,"display_name":"Flavian Diol D"},"score":0,"creation_date":1699707999,"post_id":77453728,"comment_id":136566883,"body_markdown":"@Lii - I kinda accept your concept, about `iObj` not propagating to the `if` body, if that was really the case, then should we never use `&amp;` while pattern matching. If you know more about this, kindly post it as an answer. Thank you.","body":"@Lii - I kinda accept your concept, about <code>iObj</code> not propagating to the <code>if</code> body, if that was really the case, then should we never use <code>&amp;</code> while pattern matching. If you know more about this, kindly post it as an answer. Thank you."},{"owner":{"account_id":31180,"reputation":29173,"user_id":85421,"display_name":"user85421"},"score":5,"creation_date":1699717678,"post_id":77453728,"comment_id":136567848,"body_markdown":"JLS 6.3.1 - &quot;Scope for Pattern Variables in Expressions&quot; - states that no scope rules apply to `&amp;` (as opposed to `&amp;&amp;` and `instanceof`) - so in `a instanceof B aB &amp; aB.isValid()`, the sub-expression `a instanceof B aB` is allowed and introduces a Pattern Variable (PV), but since there is no scope rule for `&amp;`, `aB.isValid()` will not compile (&quot;cannot find symbol&quot;)","body":"JLS 6.3.1 - &quot;Scope for Pattern Variables in Expressions&quot; - states that no scope rules apply to <code>&amp;</code> (as opposed to <code>&amp;&amp;</code> and <code>instanceof</code>) - so in <code>a instanceof B aB &amp; aB.isValid()</code>, the sub-expression <code>a instanceof B aB</code> is allowed and introduces a Pattern Variable (PV), but since there is no scope rule for <code>&amp;</code>, <code>aB.isValid()</code> will not compile (&quot;cannot find symbol&quot;)"},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1699718147,"post_id":77453728,"comment_id":136567892,"body_markdown":"@user85421 Stole it from my mouth. I am talking to the amber dev team to get the terminology right in my post. But this is the crux of it.","body":"@user85421 Stole it from my mouth. I am talking to the amber dev team to get the terminology right in my post. But this is the crux of it."},{"owner":{"account_id":204515,"reputation":11679,"user_id":452775,"accept_rate":63,"display_name":"Lii"},"score":1,"creation_date":1699719969,"post_id":77453728,"comment_id":136568108,"body_markdown":"@tquadrat I tried it right now. user85421 is right: It doesn&#39;t work, I was wrong about that. It seems that `a instanceof B b` is allowed but useless together with `&amp;`.","body":"@tquadrat I tried it right now. user85421 is right: It doesn&#39;t work, I was wrong about that. It seems that <code>a instanceof B b</code> is allowed but useless together with <code>&amp;</code>."},{"owner":{"account_id":29161129,"reputation":86,"user_id":22339877,"display_name":"Flavian Diol D"},"score":1,"creation_date":1699723071,"post_id":77453728,"comment_id":136568422,"body_markdown":"@user85421 would you mind posting this as an answer with examples and detailed explanation?. Would be a great help. Thank you","body":"@user85421 would you mind posting this as an answer with examples and detailed explanation?. Would be a great help. Thank you"},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1699740064,"post_id":77453728,"comment_id":136570099,"body_markdown":"@Lii Again, it&#39;s definitely not useless. There&#39;s a right way and a wrong way to use it. I almost regret announcing that I was going to write an answer because of how long it has taken me. But I jumped in here so many times because I do not want misinformation to be spread, and the 2 threads on this question have been full of it. Every conversation you all are having has already been had before by the people actually putting pattern-matching in Java. And the book in question is made by someone who talks to the Java team regularly for decades. There are no bugs here - either in the book or Java.","body":"@Lii Again, it&#39;s definitely not useless. There&#39;s a right way and a wrong way to use it. I almost regret announcing that I was going to write an answer because of how long it has taken me. But I jumped in here so many times because I do not want misinformation to be spread, and the 2 threads on this question have been full of it. Every conversation you all are having has already been had before by the people actually putting pattern-matching in Java. And the book in question is made by someone who talks to the Java team regularly for decades. There are no bugs here - either in the book or Java."},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1699740250,"post_id":77453728,"comment_id":136570115,"body_markdown":"Though, the book picked a horribly confusing example for beginners. While the book may be correct, it picked a horrifically beginner-unfriendly example that so many people in this thread have understandably mixed themselves up on. I promise, I will post an answer that will get this all explained. I simply refuse to put out something that I am not 100% certain, so I am fact-checking everything before I click post.","body":"Though, the book picked a horribly confusing example for beginners. While the book may be correct, it picked a horrifically beginner-unfriendly example that so many people in this thread have understandably mixed themselves up on. I promise, I will post an answer that will get this all explained. I simply refuse to put out something that I am not 100% certain, so I am fact-checking everything before I click post."},{"owner":{"account_id":204515,"reputation":11679,"user_id":452775,"accept_rate":63,"display_name":"Lii"},"score":1,"creation_date":1699807035,"post_id":77453728,"comment_id":136574755,"body_markdown":"Comment threads are not meant for long discussions, but I enjoy this one... :)  @davidalayachew *&quot;it&#39;s definitely not useless&quot;* The thing I think is useless is to combine `a instanceof B b`, and `instanceof` with a pattern that declares a variable, with `&amp;`. There seems to be no point at all to the variable because it it not propagated anywhere, so you can&#39;t use it. Logical `&amp;` by itself can be occasionally useful, and `instanceof` that declares a variable is very useful, but not the combination in this example. Or is there something I have missed about `&amp;` and `instanceof`?","body":"Comment threads are not meant for long discussions, but I enjoy this one... :)  @davidalayachew <i>&quot;it&#39;s definitely not useless&quot;</i> The thing I think is useless is to combine <code>a instanceof B b</code>, and <code>instanceof</code> with a pattern that declares a variable, with <code>&amp;</code>. There seems to be no point at all to the variable because it it not propagated anywhere, so you can&#39;t use it. Logical <code>&amp;</code> by itself can be occasionally useful, and <code>instanceof</code> that declares a variable is very useful, but not the combination in this example. Or is there something I have missed about <code>&amp;</code> and <code>instanceof</code>?"},{"owner":{"account_id":204515,"reputation":11679,"user_id":452775,"accept_rate":63,"display_name":"Lii"},"score":1,"creation_date":1699807375,"post_id":77453728,"comment_id":136574795,"body_markdown":"@davidalayachew: *&quot;In this case, the compiler cannot know whether or not iObj will be in scope in the if block because the right side of the &amp; will not necessarily be evaluated.&quot;* This statement in the book is clearly wrong. The difference between `&amp;&amp;` and boolean `&amp;` is that both sides of `&amp;` are always evaluated, while for `&amp;&amp;` the right side is only evaluated when the left side is `true`.","body":"@davidalayachew: <i>&quot;In this case, the compiler cannot know whether or not iObj will be in scope in the if block because the right side of the &amp; will not necessarily be evaluated.&quot;</i> This statement in the book is clearly wrong. The difference between <code>&amp;&amp;</code> and boolean <code>&amp;</code> is that both sides of <code>&amp;</code> are always evaluated, while for <code>&amp;&amp;</code> the right side is only evaluated when the left side is <code>true</code>."},{"owner":{"account_id":204515,"reputation":11679,"user_id":452775,"accept_rate":63,"display_name":"Lii"},"score":0,"creation_date":1699807929,"post_id":77453728,"comment_id":136574854,"body_markdown":"@davidalayachew &quot;*I will post an answer that will get this all explained*&quot;. I think you are wrong in some ways but I&#39;m looking forward to your answer and I hope you get some information from the Amber experts. :)","body":"@davidalayachew &quot;<i>I will post an answer that will get this all explained</i>&quot;. I think you are wrong in some ways but I&#39;m looking forward to your answer and I hope you get some information from the Amber experts. :)"},{"owner":{"account_id":14010051,"reputation":1143,"user_id":10118965,"display_name":"davidalayachew"},"score":0,"creation_date":1699820111,"post_id":77453728,"comment_id":136576210,"body_markdown":"@Lii I assert all of my original claims, including that the quote you are talking about from the book is correct. But yes, I am open to being wrong, and will admit it if it comes to be false. I will be sure to notify everyone here once I post my answer.","body":"@Lii I assert all of my original claims, including that the quote you are talking about from the book is correct. But yes, I am open to being wrong, and will admit it if it comes to be false. I will be sure to notify everyone here once I post my answer."}],"tags":[],"owner":{"account_id":1692034,"reputation":3196,"user_id":1554195,"display_name":"tquadrat"},"comment_count":24,"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1699715274,"creation_date":1699537915,"answer_id":77453728,"question_id":77453336,"body_markdown":"First, the quote as presented in the question is crap!\r\n\r\nThe `&amp;&amp;` is the &quot;shortcut&quot; form that does not guarantee that both sides will be executed; in this case, if the first term evaluates to `false`, the second one will never be touched. `&amp;` guarantees that both terms are evaluated.\r\n\r\nNevertheless, it is possible that Pattern Matching does not work with single `&amp;` for some reason (but not for that one given in the quote!!)\r\n\r\nPattern matching for `instanceof` was introduced in Java 14 as a preview, a second preview was started in Java 15, until it was finalised in Java 16. And the JEP talks in fact only about `&amp;&amp;` and `||`, not about `&amp;` and `|`. But to have that behaving different than the shortcuts does not make much sense.\r\n\r\nMeanwhile, I tried\r\n\r\n```Java\r\nif( (count &lt; 100) &amp; myOb instanceof Integer iObj ) \r\n{\r\n   int iObj = (Integer) myOb;\r\n}\r\n```\r\nwith Java 21, and it works – unexpectedly! But when I use `&amp;&amp;`, it complains about the assignment/declaration in the body, because `iObj` was already declared … strange!!\r\n\r\nBut the [JLS 6.3.1](https://docs.oracle.com/javase/specs/jls/se21/html/jls-6.html#jls-6.3.1) also talk about the shortcuts only …\r\n\r\nPerhaps [JLS 15.22.2](https://docs.oracle.com/javase/specs/jls/se21/html/jls-15.html#jls-15.22.2) gives the answer: there `&amp;` and `|` are labeled as &quot;boolean logical operators&quot;, while 6.3.1 talked about `&amp;&amp;` and `||` as &quot;Conditional-And&quot; or &quot;Conditional-Or&quot; operators, respectively.\r\n\r\nBut then the question arises why the dangling `iObj` in the `instanceof` term with the single `&amp;` does not cause a syntax error?","title":"instanceof Pattern matching in Java, not compiling","body":"<p>First, the quote as presented in the question is crap!</p>\n<p>The <code>&amp;&amp;</code> is the &quot;shortcut&quot; form that does not guarantee that both sides will be executed; in this case, if the first term evaluates to <code>false</code>, the second one will never be touched. <code>&amp;</code> guarantees that both terms are evaluated.</p>\n<p>Nevertheless, it is possible that Pattern Matching does not work with single <code>&amp;</code> for some reason (but not for that one given in the quote!!)</p>\n<p>Pattern matching for <code>instanceof</code> was introduced in Java 14 as a preview, a second preview was started in Java 15, until it was finalised in Java 16. And the JEP talks in fact only about <code>&amp;&amp;</code> and <code>||</code>, not about <code>&amp;</code> and <code>|</code>. But to have that behaving different than the shortcuts does not make much sense.</p>\n<p>Meanwhile, I tried</p>\n<pre><code>if( (count &lt; 100) &amp; myOb instanceof Integer iObj ) \n{\n   int iObj = (Integer) myOb;\n}\n</code></pre>\n<p>with Java 21, and it works – unexpectedly! But when I use <code>&amp;&amp;</code>, it complains about the assignment/declaration in the body, because <code>iObj</code> was already declared … strange!!</p>\n<p>But the <a href=\"https://docs.oracle.com/javase/specs/jls/se21/html/jls-6.html#jls-6.3.1\" rel=\"nofollow noreferrer\">JLS 6.3.1</a> also talk about the shortcuts only …</p>\n<p>Perhaps <a href=\"https://docs.oracle.com/javase/specs/jls/se21/html/jls-15.html#jls-15.22.2\" rel=\"nofollow noreferrer\">JLS 15.22.2</a> gives the answer: there <code>&amp;</code> and <code>|</code> are labeled as &quot;boolean logical operators&quot;, while 6.3.1 talked about <code>&amp;&amp;</code> and <code>||</code> as &quot;Conditional-And&quot; or &quot;Conditional-Or&quot; operators, respectively.</p>\n<p>But then the question arises why the dangling <code>iObj</code> in the <code>instanceof</code> term with the single <code>&amp;</code> does not cause a syntax error?</p>\n"},{"comments":[{"owner":{"account_id":29161129,"reputation":86,"user_id":22339877,"display_name":"Flavian Diol D"},"score":0,"creation_date":1700065475,"post_id":77486636,"comment_id":136609656,"body_markdown":"So basically it is because they haven&#39;t perfected the feature, and the design for `&amp;` in Java is incomplete for pattern matching?","body":"So basically it is because they haven&#39;t perfected the feature, and the design for <code>&amp;</code> in Java is incomplete for pattern matching?"},{"owner":{"account_id":11899205,"reputation":171,"user_id":8707677,"display_name":"Kroppeb"},"score":1,"creation_date":1700123094,"post_id":77486636,"comment_id":136616553,"body_markdown":"@FlavianDiolD I think it&#39;s a design decision they made. The way pattern introducing works is quite similar to how definite assignment works (chapter 16 of the java spec). This part of the spec also doesn&#39;t have any special casing for `&amp;` like they have for `&amp;&amp;`. But that just changes the question into &quot;why is there no special casing for stuff like `&amp;` in definite assignment analysis?&quot;, to which I don&#39;t have the answer.","body":"@FlavianDiolD I think it&#39;s a design decision they made. The way pattern introducing works is quite similar to how definite assignment works (chapter 16 of the java spec). This part of the spec also doesn&#39;t have any special casing for <code>&amp;</code> like they have for <code>&amp;&amp;</code>. But that just changes the question into &quot;why is there no special casing for stuff like <code>&amp;</code> in definite assignment analysis?&quot;, to which I don&#39;t have the answer."},{"owner":{"account_id":29161129,"reputation":86,"user_id":22339877,"display_name":"Flavian Diol D"},"score":0,"creation_date":1700139963,"post_id":77486636,"comment_id":136619594,"body_markdown":"Okay thanks a lot @Kroppeb","body":"Okay thanks a lot @Kroppeb"}],"tags":[],"owner":{"account_id":11899205,"reputation":171,"user_id":8707677,"display_name":"Kroppeb"},"comment_count":3,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1700041477,"creation_date":1700041477,"answer_id":77486636,"question_id":77453336,"body_markdown":"The way the quote explains why the second case does not compile is worded extremely strange, maybe even wrong. So here is my way of explaining it.\r\n\r\nThe way you have to look at pattern match variables is that they are only declared if they are assigned (in the spec they call this &#39;introducing&#39; a pattern variable).\r\n\r\nLet&#39;s look at an example:\r\n```java\r\nif(myOb instanceof Integer iObj) {\r\n    // ...\r\n}\r\n```\r\nNow inside this if statement, the `instanceof` must have returned `true`, so `iObj` is &#39;introduced&#39; and therefore declared. This means you can both read from it, and write to it (as it isn&#39;t a final variable, note that `myOb instanceof final Integer iObj` is valid Java).\r\n\r\nLet&#39;s now jump to the first case given:\r\n```java\r\nif((count &lt; 100) &amp;&amp; myOb instanceof Integer iObj) {\r\n    // ...\r\n}\r\n```\r\nSo why does this work? The language designers made sure that if you have a statement in the form of:\r\n```java\r\nif (exprA &amp;&amp; exprB) {\r\n  // ...\r\n}\r\n```\r\nthat it is equivalent to:\r\n```java\r\nif (exprA) {\r\n  if (exprB) {\r\n    // ...\r\n  }\r\n}\r\n```\r\nThis why you have short circuiting in Java and so many other languages.\r\nDoing this to the 1st case we get:\r\n```java\r\nif (count &lt; 100) {\r\n  if (myOb instanceof Integer iObj) {\r\n    // ...\r\n  }\r\n}\r\n```\r\nBecause the inner if matches the first example I gave, it makes sense that again inside the if block the pattern variable must have been &#39;introduced&#39; and is therefore assignable.\r\n\r\nSo why doesn&#39;t this work with `&amp;` just like with `&amp;&amp;`? Well, because the language designers decided not to I suppose. \r\n\r\nI do have an argument as to why they decided this. Given a statement like this:\r\n```java\r\nif (exprA &amp; exprB) {\r\n  // ...\r\n}\r\n```\r\nIt is essentially the same as:\r\n```java\r\nboolean tempA = exprA;\r\nboolean tempB = exprB;\r\nif (tempA &amp;&amp; tempB) {\r\n  // ...\r\n}\r\n```\r\n\r\nAnd although we can split the `&amp;&amp;` operator here again, it doesn&#39;t matter. In the case you gave, we would get `boolean tempB = myOb instanceof Integer iObj`.\r\nThis statement can&#39;t &#39;introduce&#39; a pattern variable because it could be that `myOb` wasn&#39;t an Integer which means that it can&#39;t guarantee that `iObj` would be assigned.\r\n\r\nSo even though &#39;myOb instanceof Integer iObj&#39; in both cases must have returned true for the code in the if block to be run, because the language designers didn&#39;t make rules for how pattern variables get introduced by `&amp;` like they did with `&amp;&amp;`, the 2nd case in the book won&#39;t compile like the first one.\r\n\r\nSo why can you use `int iObj = ...` in the if block with `&amp;` but not with `&amp;&amp;`?\r\nWell, as we just saw with `&amp;`, the compiler doesn&#39;t consider the pattern variable to be &#39;introduced&#39; to the block, so you can define it inside, but with `&amp;&amp;` that is illegal because the pattern variable IS introduced, which means you can&#39;t redeclare it.\r\n","title":"instanceof Pattern matching in Java, not compiling","body":"<p>The way the quote explains why the second case does not compile is worded extremely strange, maybe even wrong. So here is my way of explaining it.</p>\n<p>The way you have to look at pattern match variables is that they are only declared if they are assigned (in the spec they call this 'introducing' a pattern variable).</p>\n<p>Let's look at an example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>if(myOb instanceof Integer iObj) {\n    // ...\n}\n</code></pre>\n<p>Now inside this if statement, the <code>instanceof</code> must have returned <code>true</code>, so <code>iObj</code> is 'introduced' and therefore declared. This means you can both read from it, and write to it (as it isn't a final variable, note that <code>myOb instanceof final Integer iObj</code> is valid Java).</p>\n<p>Let's now jump to the first case given:</p>\n<pre class=\"lang-java prettyprint-override\"><code>if((count &lt; 100) &amp;&amp; myOb instanceof Integer iObj) {\n    // ...\n}\n</code></pre>\n<p>So why does this work? The language designers made sure that if you have a statement in the form of:</p>\n<pre class=\"lang-java prettyprint-override\"><code>if (exprA &amp;&amp; exprB) {\n  // ...\n}\n</code></pre>\n<p>that it is equivalent to:</p>\n<pre class=\"lang-java prettyprint-override\"><code>if (exprA) {\n  if (exprB) {\n    // ...\n  }\n}\n</code></pre>\n<p>This why you have short circuiting in Java and so many other languages.\nDoing this to the 1st case we get:</p>\n<pre class=\"lang-java prettyprint-override\"><code>if (count &lt; 100) {\n  if (myOb instanceof Integer iObj) {\n    // ...\n  }\n}\n</code></pre>\n<p>Because the inner if matches the first example I gave, it makes sense that again inside the if block the pattern variable must have been 'introduced' and is therefore assignable.</p>\n<p>So why doesn't this work with <code>&amp;</code> just like with <code>&amp;&amp;</code>? Well, because the language designers decided not to I suppose.</p>\n<p>I do have an argument as to why they decided this. Given a statement like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>if (exprA &amp; exprB) {\n  // ...\n}\n</code></pre>\n<p>It is essentially the same as:</p>\n<pre class=\"lang-java prettyprint-override\"><code>boolean tempA = exprA;\nboolean tempB = exprB;\nif (tempA &amp;&amp; tempB) {\n  // ...\n}\n</code></pre>\n<p>And although we can split the <code>&amp;&amp;</code> operator here again, it doesn't matter. In the case you gave, we would get <code>boolean tempB = myOb instanceof Integer iObj</code>.\nThis statement can't 'introduce' a pattern variable because it could be that <code>myOb</code> wasn't an Integer which means that it can't guarantee that <code>iObj</code> would be assigned.</p>\n<p>So even though 'myOb instanceof Integer iObj' in both cases must have returned true for the code in the if block to be run, because the language designers didn't make rules for how pattern variables get introduced by <code>&amp;</code> like they did with <code>&amp;&amp;</code>, the 2nd case in the book won't compile like the first one.</p>\n<p>So why can you use <code>int iObj = ...</code> in the if block with <code>&amp;</code> but not with <code>&amp;&amp;</code>?\nWell, as we just saw with <code>&amp;</code>, the compiler doesn't consider the pattern variable to be 'introduced' to the block, so you can define it inside, but with <code>&amp;&amp;</code> that is illegal because the pattern variable IS introduced, which means you can't redeclare it.</p>\n"}],"owner":{"account_id":29161129,"reputation":86,"user_id":22339877,"display_name":"Flavian Diol D"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":282,"favorite_count":0,"down_vote_count":2,"up_vote_count":4,"accepted_answer_id":77486636,"answer_count":2,"score":2,"last_activity_date":1700041477,"creation_date":1699534198,"question_id":77453336,"body_markdown":"Below is a paragraph taken from &#39;Java - The Complete Reference&#39; book, 12th edition.\r\n\r\n&gt; ```\r\n&gt; Number myOb = Integer.valueOf(9);\r\n&gt; int count = 10; \r\n&gt; if((count &lt; 100) &amp;&amp; myOb instanceof Integer iObj) { // is OK \r\n&gt; // myOb is both an Integer and nonnegative, and count is less than 100. \r\n&gt; iObj = count; \r\n&gt; //.. \r\n&gt; }\r\n&gt; ```\r\n&gt;\r\n&gt; This fragment compiles because the if block will execute only when both sides of the &amp;&amp; are\r\n&gt;\r\n&gt; true. Thus, the use of iObj in the if block is valid. However, a compilation error will result if\r\n&gt;\r\n&gt; you tried to use the &amp; rather than the &amp;&amp;, as shown here:\r\n&gt;\r\n&gt; ```\r\n&gt; if((count &lt; 100) &amp; myOb instanceof Integer iObj) { // Error!\r\n&gt; ```\r\n&gt;\r\n&gt; In this case, the compiler cannot know whether or not iObj will be in scope in the if block\r\n&gt;\r\n&gt; because the right side of the &amp; will not necessarily be evaluated.\r\n\r\nI completely do not understand the last few lines, why would the code even enter the if block if the pattern matching fails, if it succeeds and the first condition is true, then what&#39;s wrong with using &#39;&amp;&#39; instead of &#39;&amp;&amp;&#39;.\r\n\r\nThe code works if I initialise iObj manually inside the if block, but why is pattern matching not doing it? When it&#39;s whole idea was to create a reference variable, pointing to the extracted object of mentioned type.\r\n\r\nWhat I get before manual initialization\r\n\r\n`Compile Error: iObj may not be initialized`\r\n\r\nWhat I tried\r\n\r\n```\r\nif((count &lt; 100) &amp; myOb instanceof Integer iObj) {\r\nint iObj = (Integer) myOb;\r\n}\r\n```\r\n\r\nAnd now it works.\r\n\r\nI want to know why, this happens.\r\n\r\nI am using JDK 20 in Windows\r\n\r\n```\r\njava version &quot;20.0.1&quot; 2023-04-18\r\nJava(TM) SE Runtime Environment (build 20.0.1+9-29)\r\nJava HotSpot(TM) 64-Bit Server VM (build 20.0.1+9-29, mixed mode, sharing)\r\n```","title":"instanceof Pattern matching in Java, not compiling","body":"<p>Below is a paragraph taken from 'Java - The Complete Reference' book, 12th edition.</p>\n<blockquote>\n<pre><code>Number myOb = Integer.valueOf(9);\nint count = 10; \nif((count &lt; 100) &amp;&amp; myOb instanceof Integer iObj) { // is OK \n// myOb is both an Integer and nonnegative, and count is less than 100. \niObj = count; \n//.. \n}\n</code></pre>\n<p>This fragment compiles because the if block will execute only when both sides of the &amp;&amp; are</p>\n<p>true. Thus, the use of iObj in the if block is valid. However, a compilation error will result if</p>\n<p>you tried to use the &amp; rather than the &amp;&amp;, as shown here:</p>\n<pre><code>if((count &lt; 100) &amp; myOb instanceof Integer iObj) { // Error!\n</code></pre>\n<p>In this case, the compiler cannot know whether or not iObj will be in scope in the if block</p>\n<p>because the right side of the &amp; will not necessarily be evaluated.</p>\n</blockquote>\n<p>I completely do not understand the last few lines, why would the code even enter the if block if the pattern matching fails, if it succeeds and the first condition is true, then what's wrong with using '&amp;' instead of '&amp;&amp;'.</p>\n<p>The code works if I initialise iObj manually inside the if block, but why is pattern matching not doing it? When it's whole idea was to create a reference variable, pointing to the extracted object of mentioned type.</p>\n<p>What I get before manual initialization</p>\n<p><code>Compile Error: iObj may not be initialized</code></p>\n<p>What I tried</p>\n<pre><code>if((count &lt; 100) &amp; myOb instanceof Integer iObj) {\nint iObj = (Integer) myOb;\n}\n</code></pre>\n<p>And now it works.</p>\n<p>I want to know why, this happens.</p>\n<p>I am using JDK 20 in Windows</p>\n<pre><code>java version &quot;20.0.1&quot; 2023-04-18\nJava(TM) SE Runtime Environment (build 20.0.1+9-29)\nJava HotSpot(TM) 64-Bit Server VM (build 20.0.1+9-29, mixed mode, sharing)\n</code></pre>\n"},{"tags":["java","generics"],"comments":[{"owner":{"account_id":8532578,"reputation":39918,"user_id":6395627,"display_name":"Slaw"},"score":6,"creation_date":1699988035,"post_id":77482932,"comment_id":136598923,"body_markdown":"Perhaps, instead of having a varargs of functions, it would be better to build a single `Function` via calls to [`Function#andThen(Function)`](https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Function.html#andThen(java.util.function.Function)).","body":"Perhaps, instead of having a varargs of functions, it would be better to build a single <code>Function</code> via calls to <a href=\"https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Function.html#andThen(java.util.function.Function)\" rel=\"nofollow noreferrer\"><code>Function#andThen(Function)</code></a>."},{"owner":{"account_id":162699,"reputation":138060,"user_id":3788176,"accept_rate":54,"display_name":"Andy Turner"},"score":1,"creation_date":1699991465,"post_id":77482932,"comment_id":136599424,"body_markdown":"If you need to pass the result of one function as the input to the next element of a `Function&lt;T, R&gt;` array, the functions have to have the same input and output types, so `T` and `R` need to be the same.","body":"If you need to pass the result of one function as the input to the next element of a <code>Function&lt;T, R&gt;</code> array, the functions have to have the same input and output types, so <code>T</code> and <code>R</code> need to be the same."},{"owner":{"account_id":2497295,"reputation":3931,"user_id":2173392,"display_name":"pdem"},"score":0,"creation_date":1700043825,"post_id":77482932,"comment_id":136605545,"body_markdown":"T and R are resolved at compile time and can only reflect 2 types. If you want a chain of call with dIfferent T R at each level, you can&#39;t do this with java generic (but with old untyped Object it will work), or you have to use a different pattern: when I saw the cast, I I suspected the problem. To put it simple you cannot have varargs with mixed type (Function&lt;A,B&gt;x,Function&lt;B,C&gt; y)","body":"T and R are resolved at compile time and can only reflect 2 types. If you want a chain of call with dIfferent T R at each level, you can&#39;t do this with java generic (but with old untyped Object it will work), or you have to use a different pattern: when I saw the cast, I I suspected the problem. To put it simple you cannot have varargs with mixed type (Function&lt;A,B&gt;x,Function&lt;B,C&gt; y)"}],"owner":{"account_id":29573145,"reputation":1,"user_id":22664793,"display_name":"Yurben"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":72,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700041440,"creation_date":1699985542,"question_id":77482932,"body_markdown":"I need to create generic method convertBy which will accept var args of Function&lt;T,K&gt; and looping through those methods passing it&#39;s result to the next method passed as parameter.\r\nHere is the example of code as I wrote:\r\n\r\n```\r\npublic &lt;R&gt; R convertBy( Function&lt;T, R&gt;... funs) {\r\n        R result = null;\r\n        for (Function&lt;T, R&gt; fun : funs) {\r\n            result = fun.apply( inputData);\r\n            inputData = (T) result;\r\n        }\r\n        return result;\r\n    }\r\n```\r\nAnd it should work, example: \r\n```\r\nList&lt;Integer&gt; ints = fileConv.convertBy(flines, join, collectInts);\r\n```\r\nAs example\r\n\r\nflines - returns a list of lines from a text file\r\n\r\njoin - combines a string list (returns a string of interconnected elements of the list)\r\n\r\ncollectInts - returns a list of integers contained in the string\r\netc etc\r\n\r\nBut It gives me below error\r\n\r\n    java: method convertBy in class InputConverter&lt;T&gt; cannot be applied to given types;\r\n      required: java.util.function.Function&lt;java.lang.String,R&gt;[]\r\n      found:    java.util.function.Function&lt;java.lang.String,java.util.List&lt;java.lang.String&gt;&gt;,java.util.function.Function&lt;java.util.List&lt;java.lang.String&gt;,java.lang.String&gt;\r\n      reason: cannot infer type-variable(s) R\r\n        (varargs mismatch; java.util.function.Function&lt;java.util.List&lt;java.lang.String&gt;,java.lang.String&gt; cannot be converted to java.util.function.Function&lt;java.lang.String,R&gt;)\r\n\r\nI understand that it register a T as an String and maybe that causes a problem but how to deal with it I&#39;ve no idea.\r\n\r\n\r\n```\r\npublic class InputConverter&lt;T&gt; {\r\n    private T inputData;\r\n\r\n    public InputConverter(T inputData) {\r\n        this.inputData = inputData;\r\n    }\r\n    \r\n    public &lt;R&gt; R convertBy( Function&lt;T, R&gt;... funs) {\r\n        R result = null;\r\n        for (Function&lt;T, R&gt; fun : funs) {\r\n            result = fun.apply( inputData);\r\n            inputData = (T) result;\r\n        }\r\n        return result;\r\n    }\r\n```\r\nHere my class InputConverter and here the code I&#39;ve tried with\r\n\r\n```\r\nInputConverter&lt;String&gt; fileConv = new InputConverter&lt;&gt;(fname);\r\nList&lt;String&gt; lines = fileConv.convertBy(flines);\r\nString text = fileConv.convertBy(flines, join);\r\nList&lt;Integer&gt; ints = fileConv.convertBy(flines, join, collectInts);\r\n```\r\nflines, join, collectInts are the lambdas that do actions as I wrote it on the top\r\n","title":"Java Generics, converting types","body":"<p>I need to create generic method convertBy which will accept var args of Function&lt;T,K&gt; and looping through those methods passing it's result to the next method passed as parameter.\nHere is the example of code as I wrote:</p>\n<pre><code>public &lt;R&gt; R convertBy( Function&lt;T, R&gt;... funs) {\n        R result = null;\n        for (Function&lt;T, R&gt; fun : funs) {\n            result = fun.apply( inputData);\n            inputData = (T) result;\n        }\n        return result;\n    }\n</code></pre>\n<p>And it should work, example:</p>\n<pre><code>List&lt;Integer&gt; ints = fileConv.convertBy(flines, join, collectInts);\n</code></pre>\n<p>As example</p>\n<p>flines - returns a list of lines from a text file</p>\n<p>join - combines a string list (returns a string of interconnected elements of the list)</p>\n<p>collectInts - returns a list of integers contained in the string\netc etc</p>\n<p>But It gives me below error</p>\n<pre><code>java: method convertBy in class InputConverter&lt;T&gt; cannot be applied to given types;\n  required: java.util.function.Function&lt;java.lang.String,R&gt;[]\n  found:    java.util.function.Function&lt;java.lang.String,java.util.List&lt;java.lang.String&gt;&gt;,java.util.function.Function&lt;java.util.List&lt;java.lang.String&gt;,java.lang.String&gt;\n  reason: cannot infer type-variable(s) R\n    (varargs mismatch; java.util.function.Function&lt;java.util.List&lt;java.lang.String&gt;,java.lang.String&gt; cannot be converted to java.util.function.Function&lt;java.lang.String,R&gt;)\n</code></pre>\n<p>I understand that it register a T as an String and maybe that causes a problem but how to deal with it I've no idea.</p>\n<pre><code>public class InputConverter&lt;T&gt; {\n    private T inputData;\n\n    public InputConverter(T inputData) {\n        this.inputData = inputData;\n    }\n    \n    public &lt;R&gt; R convertBy( Function&lt;T, R&gt;... funs) {\n        R result = null;\n        for (Function&lt;T, R&gt; fun : funs) {\n            result = fun.apply( inputData);\n            inputData = (T) result;\n        }\n        return result;\n    }\n</code></pre>\n<p>Here my class InputConverter and here the code I've tried with</p>\n<pre><code>InputConverter&lt;String&gt; fileConv = new InputConverter&lt;&gt;(fname);\nList&lt;String&gt; lines = fileConv.convertBy(flines);\nString text = fileConv.convertBy(flines, join);\nList&lt;Integer&gt; ints = fileConv.convertBy(flines, join, collectInts);\n</code></pre>\n<p>flines, join, collectInts are the lambdas that do actions as I wrote it on the top</p>\n"},{"tags":["java","eclipse","selenium-webdriver","tomcat8","testng-eclipse"],"comments":[{"owner":{"account_id":27938804,"reputation":102,"user_id":21335232,"display_name":"Bhairu"},"score":0,"creation_date":1700026338,"post_id":77484653,"comment_id":136603127,"body_markdown":"have you configured your Java with your system configuration? also, you can switch back to the accepted Java version by right-clicking on the project and going to build path and edit and apply.","body":"have you configured your Java with your system configuration? also, you can switch back to the accepted Java version by right-clicking on the project and going to build path and edit and apply."}],"owner":{"account_id":29904739,"reputation":11,"user_id":22917540,"display_name":"thy nguyen"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":38,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1700041250,"creation_date":1700010092,"question_id":77484653,"body_markdown":"I have applied the `jdk21` library instead of the default, and selenium server `4.15.0` and also installed tomcat `8.5` but when I run it I get an error.\r\n````\r\nError opening zip file or JAR manifest missing : C:\\Users\\Admin\\.m2\\repository/org/aspectj/aspectjweaver/1.9.2/aspectjweaver-1.9.2.jar\r\nError occurred during initialization of VM\r\nagent library failed Agent_OnLoad: instrument\r\n````\r\nI tried downloading `aspectjweaver-1.9.2.jar` into the `aspectjweaver` folder but running it again still got the error.","title":"I&#39;m running the project to test using TestNG java in eclipse but I get an error","body":"<p>I have applied the <code>jdk21</code> library instead of the default, and selenium server <code>4.15.0</code> and also installed tomcat <code>8.5</code> but when I run it I get an error.</p>\n<pre><code>Error opening zip file or JAR manifest missing : C:\\Users\\Admin\\.m2\\repository/org/aspectj/aspectjweaver/1.9.2/aspectjweaver-1.9.2.jar\nError occurred during initialization of VM\nagent library failed Agent_OnLoad: instrument\n</code></pre>\n<p>I tried downloading <code>aspectjweaver-1.9.2.jar</code> into the <code>aspectjweaver</code> folder but running it again still got the error.</p>\n"},{"tags":["java","spring","spring-boot","multithreading","unit-testing"],"comments":[{"owner":{"account_id":3192259,"reputation":117609,"user_id":2696260,"display_name":"M. Deinum"},"score":0,"creation_date":1700037748,"post_id":77486220,"comment_id":136604484,"body_markdown":"1, you cannot. 2. use the `applicationcontext.getBean` method to provide the constructor arguments. Why do you want to use autowired in the first place, there is nothing wrong with using `new`. You could move this to a factory that you autowire, this factory you could mock in your test.","body":"1, you cannot. 2. use the <code>applicationcontext.getBean</code> method to provide the constructor arguments. Why do you want to use autowired in the first place, there is nothing wrong with using <code>new</code>. You could move this to a factory that you autowire, this factory you could mock in your test."}],"answers":[{"tags":[],"owner":{"account_id":29726894,"reputation":313,"user_id":22782586,"display_name":"Sahab"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1700040889,"creation_date":1700040889,"answer_id":77486575,"question_id":77486220,"body_markdown":"**Let see how we can solve this:**\r\n\r\n- Configure a bean to supply `dynamicStirngValue`, `dynamicIntValue` and we can use tread safety list using `CopyOnWriteArrayList`\r\n\r\n```\r\n@Configuration\r\npublic class ParamsKeyVal  {\r\n    @Bean\r\n    public List&lt;HashMap&lt;String, Integer&gt;&gt;  getParams() {\r\n        HashMap&lt;String, Integer&gt; params = new HashMap&lt;&gt;();\r\n        List&lt;HashMap&lt;String, Integer&gt;&gt; list = new CopyOnWriteArrayList&lt;&gt;();\r\n\r\n        list.add(Map.of(&quot;key1&quot;, 10));\r\n        list.add(Map.of(&quot;key2&quot;, 13));\r\n\r\n        // this params can found form other source like properties file/database\r\n        return list;\r\n    }\r\n}\r\n\r\n```\r\n- update component A so that it can be test friendly \r\n\r\n```\r\n@Component\r\nclass A {\r\n    private final List&lt;HashMap&lt;String, Integer&gt;&gt; params;\r\n    private final B b;\r\n\r\n    @Autowired\r\n    public A(List&lt;HashMap&lt;String, Integer&gt;&gt; params, B b) {\r\n\r\n        this.params = params;\r\n        this.b = b;\r\n    }\r\n\r\n    public void classAMethod() {\r\n        for(int i=0; i&lt;params.size(); i++) {\r\n\r\n            HashMap&lt;String, Integer&gt; entrySet = params.get(i);\r\n            String dynamicStirngValue = null;\r\n            Integer dynamicIntValue = null;\r\n            for (Map.Entry&lt;String, Integer&gt; entry : entrySet) {\r\n\r\n                dynamicStirngValue =  entry.getKey();\r\n                dynamicIntValue = entry.getValue();\r\n                break;\r\n            }\r\n\r\n            b.setDynamicStirngValue(dynamicStirngValue);\r\n            b.setDynamicIntValue(dynamicIntValue);\r\n            b.setDynamicInt(i);\r\n\r\n            Object xyz = b.execute();\r\n        }\r\n    }\r\n\r\n}\r\n\r\n```\r\n- update component B for no argument constructor \r\n\r\n```\r\n\r\n@Component\r\n@Scope(&quot;prototype&quot;)\r\nclass B {\r\n\r\n    public B() {\r\n\r\n    }\r\n    public B(String str1, int int1, int int2) {\r\n        // setting up the passed parameters\r\n    }\r\n    public Object execute() {\r\n        // some code to use the class variables\r\n    }\r\n}\r\n ","title":"Get different instance of autowired class bean in for loop","body":"<p><strong>Let see how we can solve this:</strong></p>\n<ul>\n<li>Configure a bean to supply <code>dynamicStirngValue</code>, <code>dynamicIntValue</code> and we can use tread safety list using <code>CopyOnWriteArrayList</code></li>\n</ul>\n<pre><code>@Configuration\npublic class ParamsKeyVal  {\n    @Bean\n    public List&lt;HashMap&lt;String, Integer&gt;&gt;  getParams() {\n        HashMap&lt;String, Integer&gt; params = new HashMap&lt;&gt;();\n        List&lt;HashMap&lt;String, Integer&gt;&gt; list = new CopyOnWriteArrayList&lt;&gt;();\n\n        list.add(Map.of(&quot;key1&quot;, 10));\n        list.add(Map.of(&quot;key2&quot;, 13));\n\n        // this params can found form other source like properties file/database\n        return list;\n    }\n}\n\n</code></pre>\n<ul>\n<li>update component A so that it can be test friendly</li>\n</ul>\n<pre><code>@Component\nclass A {\n    private final List&lt;HashMap&lt;String, Integer&gt;&gt; params;\n    private final B b;\n\n    @Autowired\n    public A(List&lt;HashMap&lt;String, Integer&gt;&gt; params, B b) {\n\n        this.params = params;\n        this.b = b;\n    }\n\n    public void classAMethod() {\n        for(int i=0; i&lt;params.size(); i++) {\n\n            HashMap&lt;String, Integer&gt; entrySet = params.get(i);\n            String dynamicStirngValue = null;\n            Integer dynamicIntValue = null;\n            for (Map.Entry&lt;String, Integer&gt; entry : entrySet) {\n\n                dynamicStirngValue =  entry.getKey();\n                dynamicIntValue = entry.getValue();\n                break;\n            }\n\n            b.setDynamicStirngValue(dynamicStirngValue);\n            b.setDynamicIntValue(dynamicIntValue);\n            b.setDynamicInt(i);\n\n            Object xyz = b.execute();\n        }\n    }\n\n}\n\n</code></pre>\n<ul>\n<li>update component B for no argument constructor</li>\n</ul>\n<pre><code>\n@Component\n@Scope(&quot;prototype&quot;)\nclass B {\n\n    public B() {\n\n    }\n    public B(String str1, int int1, int int2) {\n        // setting up the passed parameters\n    }\n    public Object execute() {\n        // some code to use the class variables\n    }\n}\n \n</code></pre>\n"}],"owner":{"account_id":10375359,"reputation":45,"user_id":7909628,"display_name":"Akshay Borse"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":26,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":77486575,"answer_count":1,"score":1,"last_activity_date":1700040889,"creation_date":1700037480,"question_id":77486220,"body_markdown":"I am new to Spring Boot, learning autowire annotation, dependency injection and unit testing\r\n\r\nI have a code in Spring Boot something like below\r\n\r\n```\r\n@Component\r\nclass A {\r\n  public void classAMethod() {\r\n    for(int i=0; i&lt;10; i++) {\r\n      B b = new B(dynamicStirngValue,dynamicIntValue, i);\r\n      Object xyz = b.execute();\r\n    }\r\n  }\r\n}\r\n\r\n@Component\r\n@Scope(&quot;prototype&quot;)\r\nclass B {\r\n\r\n  public B(String str1, int int1, int int2) {\r\n    // setting up the passed parameters\r\n  }\r\n  public Object execute() {\r\n    // some code to use the class variables\r\n  }\r\n}\r\n```\r\n\r\nI want to achieve 3 things with the code:\r\n\r\n 1. Instead of creating an object of B using the new keyword I want it to be using @autowired (Dependency injection), this will be helpful so that I can mock B and mock the return of execute() method while unit testing.\r\n\r\n 2. Since B has a parameterized constructor, I want the ability to get bean by passing the parameters, the parameter values will be dynamic, i.e., for each iteration of the loop the values passed will be different. The examples I found online are using values from the properties files.\r\n\r\n 3. The classAMethod() is being called in multi-threaded environment, that&#39;s why in for loop I am every time creating a new instance of class B, so as to avoid concurrency issues, so using autowire I want to get a new instance of class B. I cannot use synchronized keyword inside B because it internally performs lots of operations, so creating a new instance every time is more simpler than locking and unlocking blocks of code and it will lead to a decrease in performance issues as only one thread will have access to that block of code.\r\n\r\nCan you provided an example for this scenario? Or is there any other way.\r\n\r\nI want to do this for 2 reasons:\r\n 1. Unit test\r\n 2. Make the application completely with Spring Boot concepts (DI) and avoid new keyword\r\n\r\nI can do the unit tests by constructor mocking, but the problem with this approach is that we need to do @PrepareForTest(A.class), which has its own problem like code coverage which shows as 0%.\r\n\r\nThanks","title":"Get different instance of autowired class bean in for loop","body":"<p>I am new to Spring Boot, learning autowire annotation, dependency injection and unit testing</p>\n<p>I have a code in Spring Boot something like below</p>\n<pre><code>@Component\nclass A {\n  public void classAMethod() {\n    for(int i=0; i&lt;10; i++) {\n      B b = new B(dynamicStirngValue,dynamicIntValue, i);\n      Object xyz = b.execute();\n    }\n  }\n}\n\n@Component\n@Scope(&quot;prototype&quot;)\nclass B {\n\n  public B(String str1, int int1, int int2) {\n    // setting up the passed parameters\n  }\n  public Object execute() {\n    // some code to use the class variables\n  }\n}\n</code></pre>\n<p>I want to achieve 3 things with the code:</p>\n<ol>\n<li><p>Instead of creating an object of B using the new keyword I want it to be using @autowired (Dependency injection), this will be helpful so that I can mock B and mock the return of execute() method while unit testing.</p>\n</li>\n<li><p>Since B has a parameterized constructor, I want the ability to get bean by passing the parameters, the parameter values will be dynamic, i.e., for each iteration of the loop the values passed will be different. The examples I found online are using values from the properties files.</p>\n</li>\n<li><p>The classAMethod() is being called in multi-threaded environment, that's why in for loop I am every time creating a new instance of class B, so as to avoid concurrency issues, so using autowire I want to get a new instance of class B. I cannot use synchronized keyword inside B because it internally performs lots of operations, so creating a new instance every time is more simpler than locking and unlocking blocks of code and it will lead to a decrease in performance issues as only one thread will have access to that block of code.</p>\n</li>\n</ol>\n<p>Can you provided an example for this scenario? Or is there any other way.</p>\n<p>I want to do this for 2 reasons:</p>\n<ol>\n<li>Unit test</li>\n<li>Make the application completely with Spring Boot concepts (DI) and avoid new keyword</li>\n</ol>\n<p>I can do the unit tests by constructor mocking, but the problem with this approach is that we need to do @PrepareForTest(A.class), which has its own problem like code coverage which shows as 0%.</p>\n<p>Thanks</p>\n"},{"tags":["java","compiler-errors","return"],"comments":[{"owner":{"account_id":4362282,"reputation":92954,"user_id":3558960,"accept_rate":60,"display_name":"Robby Cornelissen"},"score":1,"creation_date":1700040948,"post_id":77486571,"comment_id":136605019,"body_markdown":"Don&#39;t post pictures of code. Your `if` branch does not have a `return` statement.","body":"Don&#39;t post pictures of code. Your <code>if</code> branch does not have a <code>return</code> statement."},{"owner":{"account_id":45213,"reputation":26348,"user_id":133203,"accept_rate":97,"display_name":"Federico klez Culloca"},"score":0,"creation_date":1700040953,"post_id":77486571,"comment_id":136605020,"body_markdown":"1) please share your code as text inside the question, not as pictures. 2) what does your method return if that first `if` is true?","body":"1) please share your code as text inside the question, not as pictures. 2) what does your method return if that first <code>if</code> is true?"},{"owner":{"account_id":3741438,"reputation":12025,"user_id":3111149,"accept_rate":87,"display_name":"Matteo NNZ"},"score":0,"creation_date":1700041038,"post_id":77486571,"comment_id":136605038,"body_markdown":"If Seitenlange &lt; 0 is true, your function doesn&#39;t return any double. P.s.: add code as code, not as image. P.p.s.: write code in English, it&#39;s always better.","body":"If Seitenlange &lt; 0 is true, your function doesn&#39;t return any double. P.s.: add code as code, not as image. P.p.s.: write code in English, it&#39;s always better."}],"owner":{"account_id":29907628,"reputation":1,"user_id":22919766,"display_name":"D.Bur"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":31,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"closed_date":1700041029,"answer_count":0,"score":-2,"last_activity_date":1700040864,"creation_date":1700040864,"question_id":77486571,"body_markdown":"How can there be a missing return if it is already stated in the &quot;else-if&quot; operation?\r\nI already have 2 return statements in the else-if operation, so why is there a missing return statement?\r\n \r\n(https://i.stack.imgur.com/0fWM0.jpg)\r\n\r\n\r\nDo not know how to solve it","title":"how do I fix this missing return statement error","body":"<p>How can there be a missing return if it is already stated in the &quot;else-if&quot; operation?\nI already have 2 return statements in the else-if operation, so why is there a missing return statement?</p>\n<p>(<a href=\"https://i.stack.imgur.com/0fWM0.jpg\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/0fWM0.jpg</a>)</p>\n<p>Do not know how to solve it</p>\n"},{"tags":["java","azure","apache-kafka"],"comments":[{"owner":{"account_id":390441,"reputation":32048,"user_id":750510,"accept_rate":98,"display_name":"madhead"},"score":0,"creation_date":1592744945,"post_id":62496128,"comment_id":110528152,"body_markdown":"Is you Azure VM exposed to the internet? Did you configured advertised host in Kafka&#39;s `server.properties` correctly?","body":"Is you Azure VM exposed to the internet? Did you configured advertised host in Kafka&#39;s <code>server.properties</code> correctly?"},{"owner":{"account_id":18895650,"reputation":1,"user_id":13784880,"display_name":"Rishabh Singh"},"score":0,"creation_date":1592757120,"post_id":62496128,"comment_id":110532527,"body_markdown":"I tried pinging the VM from my local machine and it was responding correctly. I only modified this property and placed public IP instead of the text advertised.listeners=PLAINTEXT://&lt;public ip&gt;:9092","body":"I tried pinging the VM from my local machine and it was responding correctly. I only modified this property and placed public IP instead of the text advertised.listeners=PLAINTEXT://&lt;public ip&gt;:9092"}],"owner":{"account_id":18895650,"reputation":1,"user_id":13784880,"display_name":"Rishabh Singh"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":162,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700040821,"creation_date":1592727671,"question_id":62496128,"body_markdown":"I have created a Virtual Machine in Azure and setup Apache Kafka inside it. Now I want to access the Kafka from my local machine but it keeps on giving me the connection not established error after stucking for a while in **kafkaProducer.send(record)**, this is the producer code :\r\n\r\n```java \r\nProperties props = new Properties();\r\n\t\tprops.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, KafkaIP);\r\n\t\tprops.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());\r\n\t\tprops.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());\r\n\r\n\t\tKafkaProducer&lt;String, String&gt; kafkaProducer = new KafkaProducer&lt;String, String&gt;(props);\r\n\t\ttry {\r\n\r\n\t\t\tfor(int i = 0; i &lt; 5; i++){\r\n\r\n\t\t\t\tProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;String, String&gt;(&quot;sec&quot;, Integer.toString(1),&quot;Hello&quot;); \r\n/* GETS STUCK IN THE FOLLOWING LINE FOR VERY LONG*/\r\n\t\t\t\tkafkaProducer.send(record);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t} catch (Exception e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n```\r\nI have uncommented and placed the public IP in the property **advertised.listeners** inside **server.properties** file. Both 9092 &amp; 2181 ports are open for the source.\r\nThe same thing worked for the AWS EC2 instance. Is there any other modification that I have to do for accessing Kafka which inside Azure VM?","title":"Problem in accessing Kafka present in Azure VM","body":"<p>I have created a Virtual Machine in Azure and setup Apache Kafka inside it. Now I want to access the Kafka from my local machine but it keeps on giving me the connection not established error after stucking for a while in <strong>kafkaProducer.send(record)</strong>, this is the producer code :</p>\n<pre class=\"lang-java prettyprint-override\"><code>Properties props = new Properties();\n        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, KafkaIP);\n        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());\n        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());\n\n        KafkaProducer&lt;String, String&gt; kafkaProducer = new KafkaProducer&lt;String, String&gt;(props);\n        try {\n\n            for(int i = 0; i &lt; 5; i++){\n\n                ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;String, String&gt;(&quot;sec&quot;, Integer.toString(1),&quot;Hello&quot;); \n/* GETS STUCK IN THE FOLLOWING LINE FOR VERY LONG*/\n                kafkaProducer.send(record);\n            }\n            \n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n</code></pre>\n<p>I have uncommented and placed the public IP in the property <strong>advertised.listeners</strong> inside <strong>server.properties</strong> file. Both 9092 &amp; 2181 ports are open for the source.\nThe same thing worked for the AWS EC2 instance. Is there any other modification that I have to do for accessing Kafka which inside Azure VM?</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":5376192,"reputation":9447,"user_id":4283005,"display_name":"dev.bmax"},"score":0,"creation_date":1700042403,"post_id":77486561,"comment_id":136605283,"body_markdown":"You might find this useful: https://developer.android.com/training/id-auth/identify","body":"You might find this useful: <a href=\"https://developer.android.com/training/id-auth/identify\" rel=\"nofollow noreferrer\">developer.android.com/training/id-auth/identify</a>"},{"owner":{"account_id":17183107,"reputation":245,"user_id":12438238,"display_name":"Vasant Raval"},"score":0,"creation_date":1700044870,"post_id":77486561,"comment_id":136605720,"body_markdown":"the problem is if i use any kind of sign despite google facebook or manual , user will know that i have there names in the app , so revealing there names will not effect much as if i take no data from them and then reveal it , you can look something similar here with this game https://pixeldough.itch.io/start-survey for windows where it takes username from  C:/Users:/&lt;CurrentUser&gt;, thought it is also not accurate , as people can put any name for the user name,so sometimes it just dosent make sense, but i neither have an option too","body":"the problem is if i use any kind of sign despite google facebook or manual , user will know that i have there names in the app , so revealing there names will not effect much as if i take no data from them and then reveal it , you can look something similar here with this game <a href=\"https://pixeldough.itch.io/start-survey\" rel=\"nofollow noreferrer\">pixeldough.itch.io/start-survey</a> for windows where it takes username from  C:/Users:/&lt;CurrentUser&gt;, thought it is also not accurate , as people can put any name for the user name,so sometimes it just dosent make sense, but i neither have an option too"},{"owner":{"account_id":5376192,"reputation":9447,"user_id":4283005,"display_name":"dev.bmax"},"score":1,"creation_date":1700048953,"post_id":77486561,"comment_id":136606401,"body_markdown":"Privacy is a big deal in Android. Apps have very limited access to sensitive information and almost always after requesting a permission.","body":"Privacy is a big deal in Android. Apps have very limited access to sensitive information and almost always after requesting a permission."}],"owner":{"account_id":17183107,"reputation":245,"user_id":12438238,"display_name":"Vasant Raval"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":37,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700040757,"creation_date":1700040757,"question_id":77486561,"body_markdown":"I&#39;m developing a game/app where I aim to identify the current user without directly asking for their name. Instead, I want to retrieve their name from the Android system. I&#39;m uncertain about the potential sources, but two possibilities come to mind:\r\n\r\n1) The user&#39;s self-entered name in their contacts.\r\n2) The registered name in the Android OS, especially during the initial boot if available.\r\n\r\nRest assured, I&#39;m not using this information for any misleading purposes; it&#39;s purely for the game&#39;s functionality. At a certain point in the game, I plan to reveal their name within the app itself. Could someone please assist me with this?","title":"How can I retrieve the device owner/user name?","body":"<p>I'm developing a game/app where I aim to identify the current user without directly asking for their name. Instead, I want to retrieve their name from the Android system. I'm uncertain about the potential sources, but two possibilities come to mind:</p>\n<ol>\n<li>The user's self-entered name in their contacts.</li>\n<li>The registered name in the Android OS, especially during the initial boot if available.</li>\n</ol>\n<p>Rest assured, I'm not using this information for any misleading purposes; it's purely for the game's functionality. At a certain point in the game, I plan to reveal their name within the app itself. Could someone please assist me with this?</p>\n"},{"tags":["java","linux","apache-kafka"],"comments":[{"owner":{"account_id":5932124,"reputation":355,"user_id":4666265,"accept_rate":80,"display_name":"appchemist"},"score":0,"creation_date":1699960312,"post_id":77457247,"comment_id":136593438,"body_markdown":"Have you checked what user &amp; group the process was running by?","body":"Have you checked what user &amp; group the process was running by?"},{"owner":{"account_id":2688763,"reputation":99,"user_id":2322525,"accept_rate":60,"display_name":"Dnyaneshwar"},"score":0,"creation_date":1699964208,"post_id":77457247,"comment_id":136594151,"body_markdown":"@appchemist Yes, the process is running with `kafka` user which has read permission to /proc/self/io.\n\n`\nps -p 2400932 -o user,group\nUSER     GROUP\nkafka    kafkagrp\n`","body":"@appchemist Yes, the process is running with <code>kafka</code> user which has read permission to /proc/self/io.  ` ps -p 2400932 -o user,group USER     GROUP kafka    kafkagrp `"},{"owner":{"account_id":1136217,"reputation":14336,"user_id":1121249,"accept_rate":86,"display_name":"rkosegi"},"score":0,"creation_date":1700029392,"post_id":77457247,"comment_id":136603392,"body_markdown":"`/proc/self` is always tied to process accessing it. attempt to change it for other program is like sharing http://localhost to someone in internet","body":"<code>&#47;proc&#47;self</code> is always tied to process accessing it. attempt to change it for other program is like sharing <a href=\"http://localhost\" rel=\"nofollow noreferrer\">localhost</a> to someone in internet"}],"answers":[{"tags":[],"owner":{"account_id":5932124,"reputation":355,"user_id":4666265,"accept_rate":80,"display_name":"appchemist"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700040629,"creation_date":1700028740,"answer_id":77485591,"question_id":77457247,"body_markdown":"`/proc/self` means `/proc/{pid}`\r\n\r\ncheck it out [here][1]\r\n\r\nSo, chmod command&#39;s `/proc/self` is not kafka process&#39;s `/proc/self`\r\n\r\nExactly, you change `/proc/{kafka process pid}/io`\r\n\r\nBut changing permissions is not a perfect solution because OS creates a new `/proc/{pid}` every time you run the program.\r\n\r\nThe link below looks like a similar issue, check it out\r\nhttps://unix.stackexchange.com/questions/297190/owner-cant-read-proc-pid-io\r\n\r\n  [1]: https://man7.org/linux/man-pages/man5/proc.5.html","title":"Kafka cluster startup warning | Unable to update IO metrics | AccessDeniedException: /proc/self/io","body":"<p><code>/proc/self</code> means <code>/proc/{pid}</code></p>\n<p>check it out <a href=\"https://man7.org/linux/man-pages/man5/proc.5.html\" rel=\"nofollow noreferrer\">here</a></p>\n<p>So, chmod command's <code>/proc/self</code> is not kafka process's <code>/proc/self</code></p>\n<p>Exactly, you change <code>/proc/{kafka process pid}/io</code></p>\n<p>But changing permissions is not a perfect solution because OS creates a new <code>/proc/{pid}</code> every time you run the program.</p>\n<p>The link below looks like a similar issue, check it out\n<a href=\"https://unix.stackexchange.com/questions/297190/owner-cant-read-proc-pid-io\">https://unix.stackexchange.com/questions/297190/owner-cant-read-proc-pid-io</a></p>\n"}],"owner":{"account_id":2688763,"reputation":99,"user_id":2322525,"accept_rate":60,"display_name":"Dnyaneshwar"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":96,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1700040629,"creation_date":1699580059,"question_id":77457247,"body_markdown":"I have a setup consisting of a 2-node Kafka KRaft Cluster on an OEL8 server, with following details :\r\n\r\nKafka Version : kafka_2.13-3.4.0\r\nJava Version : OpenJDK 17\r\n\r\nvmhost1 : server.properties\r\n```\r\nprocess.roles=broker,controller\r\nnode.id=1\r\ncontroller.quorum.voters=1@vmhost1:9093,2@vmhost2:9093\r\nlisteners=PLAINTEXT://vmhost1:9092,CONTROLLER://vmhost1:9093\r\nadvertised.listeners=PLAINTEXT://vmhost1:9092\r\n```\r\n\r\nvmhost2 : server.properties\r\n```\r\nprocess.roles=broker,controller\r\nnode.id=2\r\ncontroller.quorum.voters=1@vmhost1:9093,2@vmhost2:9093\r\nlisteners=PLAINTEXT://vmhost2:9092,CONTROLLER://vmhost2:9093\r\nadvertised.listeners=PLAINTEXT://vmhost2:9092\r\n```\r\n\r\n```\r\nls -la /proc/self/io\r\n-r--------. 1 kafka kafkagrp 0 Nov 10 01:18 /proc/self/io\r\n```\r\n\r\nUpon starting the Kafka server, I&#39;ve come across the following error.\r\n\r\n```\r\n[kafka@vmhost1 kafka_2.13-3.4.0]$ ./bin/kafka-server-start.sh ./config/kraft/server.properties\r\n[2023-11-10 00:56:43,631] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)\r\n[2023-11-10 00:56:43,902] INFO Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation (org.apache.zookeeper.common.X509Util)\r\n[2023-11-10 00:56:44,041] WARN Unable to update IO metrics (kafka.server.BrokerServer)\r\njava.nio.file.AccessDeniedException: /proc/self/io\r\n        at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:90)\r\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)\r\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)\r\n        at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:218)\r\n        at java.base/java.nio.file.Files.newByteChannel(Files.java:380)\r\n        at java.base/java.nio.file.Files.newByteChannel(Files.java:432)\r\n        at java.base/java.nio.file.spi.FileSystemProvider.newInputStream(FileSystemProvider.java:422)\r\n        at java.base/java.nio.file.Files.newInputStream(Files.java:160)\r\n        at java.base/java.nio.file.Files.newBufferedReader(Files.java:2922)\r\n        at java.base/java.nio.file.Files.readAllLines(Files.java:3412)\r\n        at java.base/java.nio.file.Files.readAllLines(Files.java:3453)\r\n        at kafka.metrics.LinuxIoMetricsCollector.updateValues(LinuxIoMetricsCollector.scala:71)\r\n        at kafka.metrics.LinuxIoMetricsCollector.usable(LinuxIoMetricsCollector.scala:91)\r\n        at kafka.server.KafkaBroker.$init$(KafkaBroker.scala:106)\r\n        at kafka.server.BrokerServer.&lt;init&gt;(BrokerServer.scala:74)\r\n        at kafka.server.KafkaRaftServer.&lt;init&gt;(KafkaRaftServer.scala:80)\r\n        at kafka.Kafka$.buildServer(Kafka.scala:85)\r\n        at kafka.Kafka$.main(Kafka.scala:93)\r\n        at kafka.Kafka.main(Kafka.scala)\r\n[2023-11-10 00:56:44,050] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)\r\n[2023-11-10 00:56:44,053] INFO Starting controller (kafka.server.ControllerServer)\r\n[2023-11-10 00:56:44,064] WARN Unable to update IO metrics (kafka.server.ControllerServer)\r\njava.nio.file.AccessDeniedException: /proc/self/io\r\n        at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:90)\r\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)\r\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)\r\n        at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:218)\r\n        at java.base/java.nio.file.Files.newByteChannel(Files.java:380)\r\n        at java.base/java.nio.file.Files.newByteChannel(Files.java:432)\r\n        at java.base/java.nio.file.spi.FileSystemProvider.newInputStream(FileSystemProvider.java:422)\r\n        at java.base/java.nio.file.Files.newInputStream(Files.java:160)\r\n        at java.base/java.nio.file.Files.newBufferedReader(Files.java:2922)\r\n        at java.base/java.nio.file.Files.readAllLines(Files.java:3412)\r\n        at java.base/java.nio.file.Files.readAllLines(Files.java:3453)\r\n        at kafka.metrics.LinuxIoMetricsCollector.updateValues(LinuxIoMetricsCollector.scala:71)\r\n        at kafka.metrics.LinuxIoMetricsCollector.usable(LinuxIoMetricsCollector.scala:91)\r\n        at kafka.server.ControllerServer.startup(ControllerServer.scala:142)\r\n        at kafka.server.KafkaRaftServer.$anonfun$startup$1(KafkaRaftServer.scala:98)\r\n        at kafka.server.KafkaRaftServer.$anonfun$startup$1$adapted(KafkaRaftServer.scala:98)\r\n        at scala.Option.foreach(Option.scala:437)\r\n        at kafka.server.KafkaRaftServer.startup(KafkaRaftServer.scala:98)\r\n        at kafka.Kafka$.main(Kafka.scala:115)\r\n        at kafka.Kafka.main(Kafka.scala)\r\n```\r\n\r\nI have tried changing permissions but it&#39;s not permitted even with sudo\r\n```\r\nchmod 640 /proc/self/io\r\nchmod: changing permissions of ‘/proc/self/io’: Operation not permitted\r\n```\r\n\r\nKindly help me with solution or some suggestions.","title":"Kafka cluster startup warning | Unable to update IO metrics | AccessDeniedException: /proc/self/io","body":"<p>I have a setup consisting of a 2-node Kafka KRaft Cluster on an OEL8 server, with following details :</p>\n<p>Kafka Version : kafka_2.13-3.4.0\nJava Version : OpenJDK 17</p>\n<p>vmhost1 : server.properties</p>\n<pre><code>process.roles=broker,controller\nnode.id=1\ncontroller.quorum.voters=1@vmhost1:9093,2@vmhost2:9093\nlisteners=PLAINTEXT://vmhost1:9092,CONTROLLER://vmhost1:9093\nadvertised.listeners=PLAINTEXT://vmhost1:9092\n</code></pre>\n<p>vmhost2 : server.properties</p>\n<pre><code>process.roles=broker,controller\nnode.id=2\ncontroller.quorum.voters=1@vmhost1:9093,2@vmhost2:9093\nlisteners=PLAINTEXT://vmhost2:9092,CONTROLLER://vmhost2:9093\nadvertised.listeners=PLAINTEXT://vmhost2:9092\n</code></pre>\n<pre><code>ls -la /proc/self/io\n-r--------. 1 kafka kafkagrp 0 Nov 10 01:18 /proc/self/io\n</code></pre>\n<p>Upon starting the Kafka server, I've come across the following error.</p>\n<pre><code>[kafka@vmhost1 kafka_2.13-3.4.0]$ ./bin/kafka-server-start.sh ./config/kraft/server.properties\n[2023-11-10 00:56:43,631] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)\n[2023-11-10 00:56:43,902] INFO Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation (org.apache.zookeeper.common.X509Util)\n[2023-11-10 00:56:44,041] WARN Unable to update IO metrics (kafka.server.BrokerServer)\njava.nio.file.AccessDeniedException: /proc/self/io\n        at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:90)\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)\n        at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:218)\n        at java.base/java.nio.file.Files.newByteChannel(Files.java:380)\n        at java.base/java.nio.file.Files.newByteChannel(Files.java:432)\n        at java.base/java.nio.file.spi.FileSystemProvider.newInputStream(FileSystemProvider.java:422)\n        at java.base/java.nio.file.Files.newInputStream(Files.java:160)\n        at java.base/java.nio.file.Files.newBufferedReader(Files.java:2922)\n        at java.base/java.nio.file.Files.readAllLines(Files.java:3412)\n        at java.base/java.nio.file.Files.readAllLines(Files.java:3453)\n        at kafka.metrics.LinuxIoMetricsCollector.updateValues(LinuxIoMetricsCollector.scala:71)\n        at kafka.metrics.LinuxIoMetricsCollector.usable(LinuxIoMetricsCollector.scala:91)\n        at kafka.server.KafkaBroker.$init$(KafkaBroker.scala:106)\n        at kafka.server.BrokerServer.&lt;init&gt;(BrokerServer.scala:74)\n        at kafka.server.KafkaRaftServer.&lt;init&gt;(KafkaRaftServer.scala:80)\n        at kafka.Kafka$.buildServer(Kafka.scala:85)\n        at kafka.Kafka$.main(Kafka.scala:93)\n        at kafka.Kafka.main(Kafka.scala)\n[2023-11-10 00:56:44,050] INFO Registered signal handlers for TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)\n[2023-11-10 00:56:44,053] INFO Starting controller (kafka.server.ControllerServer)\n[2023-11-10 00:56:44,064] WARN Unable to update IO metrics (kafka.server.ControllerServer)\njava.nio.file.AccessDeniedException: /proc/self/io\n        at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:90)\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)\n        at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:218)\n        at java.base/java.nio.file.Files.newByteChannel(Files.java:380)\n        at java.base/java.nio.file.Files.newByteChannel(Files.java:432)\n        at java.base/java.nio.file.spi.FileSystemProvider.newInputStream(FileSystemProvider.java:422)\n        at java.base/java.nio.file.Files.newInputStream(Files.java:160)\n        at java.base/java.nio.file.Files.newBufferedReader(Files.java:2922)\n        at java.base/java.nio.file.Files.readAllLines(Files.java:3412)\n        at java.base/java.nio.file.Files.readAllLines(Files.java:3453)\n        at kafka.metrics.LinuxIoMetricsCollector.updateValues(LinuxIoMetricsCollector.scala:71)\n        at kafka.metrics.LinuxIoMetricsCollector.usable(LinuxIoMetricsCollector.scala:91)\n        at kafka.server.ControllerServer.startup(ControllerServer.scala:142)\n        at kafka.server.KafkaRaftServer.$anonfun$startup$1(KafkaRaftServer.scala:98)\n        at kafka.server.KafkaRaftServer.$anonfun$startup$1$adapted(KafkaRaftServer.scala:98)\n        at scala.Option.foreach(Option.scala:437)\n        at kafka.server.KafkaRaftServer.startup(KafkaRaftServer.scala:98)\n        at kafka.Kafka$.main(Kafka.scala:115)\n        at kafka.Kafka.main(Kafka.scala)\n</code></pre>\n<p>I have tried changing permissions but it's not permitted even with sudo</p>\n<pre><code>chmod 640 /proc/self/io\nchmod: changing permissions of ‘/proc/self/io’: Operation not permitted\n</code></pre>\n<p>Kindly help me with solution or some suggestions.</p>\n"},{"tags":["java","docx4j","pdf-conversion","trailing-whitespace","docx-to-pdf-conversion"],"comments":[{"owner":{"account_id":5907283,"reputation":1489,"user_id":4648586,"accept_rate":60,"display_name":"Bagus Tesa"},"score":0,"creation_date":1700040711,"post_id":77486537,"comment_id":136604978,"body_markdown":"Does this answer your question? [docx4j - Why is the text truncated of spaces?](https://stackoverflow.com/questions/27400878/docx4j-why-is-the-text-truncated-of-spaces)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/27400878/docx4j-why-is-the-text-truncated-of-spaces\">docx4j - Why is the text truncated of spaces?</a>"},{"owner":{"account_id":9659484,"reputation":1,"user_id":7168044,"display_name":"Guglio"},"score":0,"creation_date":1700040817,"post_id":77486537,"comment_id":136604996,"body_markdown":"No, i&#39;m already doing t.setSpace(&quot;preserve&quot;); but still no right result. In this post that you have linked the problem is when creating text part, in my case i have to update my text part and not create new ones.","body":"No, i&#39;m already doing t.setSpace(&quot;preserve&quot;); but still no right result. In this post that you have linked the problem is when creating text part, in my case i have to update my text part and not create new ones."},{"owner":{"account_id":5907283,"reputation":1489,"user_id":4648586,"accept_rate":60,"display_name":"Bagus Tesa"},"score":0,"creation_date":1700041091,"post_id":77486537,"comment_id":136605046,"body_markdown":"thing is, the software producing the xml might be doing weird thing by [forgetting preserve flag](https://stackoverflow.com/a/70292576). that or the particular docx4j had a bug, [happened before](https://stackoverflow.com/questions/58802818/docx4j-pdf-export-adds-leading-spaces). maybe you should inspect the docx file, both the original and the one you added `t.setSpace(..`.","body":"thing is, the software producing the xml might be doing weird thing by <a href=\"https://stackoverflow.com/a/70292576\">forgetting preserve flag</a>. that or the particular docx4j had a bug, <a href=\"https://stackoverflow.com/questions/58802818/docx4j-pdf-export-adds-leading-spaces\">happened before</a>. maybe you should inspect the docx file, both the original and the one you added <code>t.setSpace(..</code>."},{"owner":{"account_id":9659484,"reputation":1,"user_id":7168044,"display_name":"Guglio"},"score":0,"creation_date":1700042786,"post_id":77486537,"comment_id":136605349,"body_markdown":"i have inspected the docx file that i give in input and right before the spaces there is\n&lt;w:t xml:space=&quot;preserve&quot;&gt; so the problem is in my code or it is a problem with docx4j.","body":"i have inspected the docx file that i give in input and right before the spaces there is &lt;w:t xml:space=&quot;preserve&quot;&gt; so the problem is in my code or it is a problem with docx4j."}],"owner":{"account_id":9659484,"reputation":1,"user_id":7168044,"display_name":"Guglio"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":30,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700040558,"creation_date":1700040558,"question_id":77486537,"body_markdown":"i have a problem with docx4j. The output pdf is cutted and all spaces or tabs are now replaced with only one. For example if in the docx there is a string like\r\n&quot;  a            a                  a&quot;\r\nthe output will be &quot;a a a&quot;. Same with tabs. My code and my pom below. What am i doing wrong? Thank you.\r\n\r\n\r\n```\r\n           InputStream isNodo = new ByteArrayInputStream(contentNodoTempl);\r\n\r\n            WordprocessingMLPackage wordMLPackage = WordprocessingMLPackage.load(isNodo);\r\n            VariablePrepare.prepare(wordMLPackage);\r\n\r\n            // output file\r\n            ByteArrayOutputStream bos = new ByteArrayOutputStream();\r\n            Docx4J.toPDF(wordMLPackage, bos);\r\n            bos.flush();\r\n            isNodo.close();\r\n            return bos.toByteArray();\r\n```\r\n\r\n\r\nWith my pom looking like\r\n```\r\n      &lt;dependency&gt;\r\n         &lt;groupId&gt;org.docx4j&lt;/groupId&gt;\r\n         &lt;artifactId&gt;docx4j-JAXB-ReferenceImpl&lt;/artifactId&gt;\r\n         &lt;version&gt;8.3.9&lt;/version&gt;\r\n      &lt;/dependency&gt;\r\n      &lt;dependency&gt;\r\n         &lt;groupId&gt;org.docx4j&lt;/groupId&gt;\r\n         &lt;artifactId&gt;docx4j-export-fo&lt;/artifactId&gt;\r\n         &lt;version&gt;8.3.9&lt;/version&gt;\r\n      &lt;/dependency&gt;\r\n```\r\n\r\n\r\n\r\ni have tried with t.setSpace(&quot;preserve&quot;) (code below) but the spaces are still cutted.\r\n\r\n```\r\n    public static void findAndReplace(WordprocessingMLPackage doc){\r\n        List&lt;Object&gt; paragraphs = getAllElementFromObject(doc.getMainDocumentPart(), P.class);\r\n        for(Object par : paragraphs){\r\n            P p = (P) par;\r\n            List&lt;Object&gt; texts = getAllElementFromObject(p, Text.class);\r\n            for(Object text : texts){\r\n                Text t = (Text)text;\r\n                t.setSpace(&quot;preserve&quot;);\r\n            }\r\n        }\r\n    }\r\n\r\n    public static List&lt;Object&gt; getAllElementFromObject(Object obj, Class&lt;?&gt; toSearch) {\r\n        List&lt;Object&gt; result = new ArrayList&lt;Object&gt;();\r\n        if (obj instanceof JAXBElement) obj = ((JAXBElement&lt;?&gt;) obj).getValue();\r\n\r\n        if (obj.getClass().equals(toSearch))\r\n            result.add(obj);\r\n        else if (obj instanceof ContentAccessor) {\r\n            List&lt;?&gt; children = ((ContentAccessor) obj).getContent();\r\n            for (Object child : children) {\r\n                result.addAll(getAllElementFromObject(child, toSearch));\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n```","title":"Docx4j docx toPdf don&#39;t preserve whitespaces","body":"<p>i have a problem with docx4j. The output pdf is cutted and all spaces or tabs are now replaced with only one. For example if in the docx there is a string like\n&quot;  a            a                  a&quot;\nthe output will be &quot;a a a&quot;. Same with tabs. My code and my pom below. What am i doing wrong? Thank you.</p>\n<pre><code>           InputStream isNodo = new ByteArrayInputStream(contentNodoTempl);\n\n            WordprocessingMLPackage wordMLPackage = WordprocessingMLPackage.load(isNodo);\n            VariablePrepare.prepare(wordMLPackage);\n\n            // output file\n            ByteArrayOutputStream bos = new ByteArrayOutputStream();\n            Docx4J.toPDF(wordMLPackage, bos);\n            bos.flush();\n            isNodo.close();\n            return bos.toByteArray();\n</code></pre>\n<p>With my pom looking like</p>\n<pre><code>      &lt;dependency&gt;\n         &lt;groupId&gt;org.docx4j&lt;/groupId&gt;\n         &lt;artifactId&gt;docx4j-JAXB-ReferenceImpl&lt;/artifactId&gt;\n         &lt;version&gt;8.3.9&lt;/version&gt;\n      &lt;/dependency&gt;\n      &lt;dependency&gt;\n         &lt;groupId&gt;org.docx4j&lt;/groupId&gt;\n         &lt;artifactId&gt;docx4j-export-fo&lt;/artifactId&gt;\n         &lt;version&gt;8.3.9&lt;/version&gt;\n      &lt;/dependency&gt;\n</code></pre>\n<p>i have tried with t.setSpace(&quot;preserve&quot;) (code below) but the spaces are still cutted.</p>\n<pre><code>    public static void findAndReplace(WordprocessingMLPackage doc){\n        List&lt;Object&gt; paragraphs = getAllElementFromObject(doc.getMainDocumentPart(), P.class);\n        for(Object par : paragraphs){\n            P p = (P) par;\n            List&lt;Object&gt; texts = getAllElementFromObject(p, Text.class);\n            for(Object text : texts){\n                Text t = (Text)text;\n                t.setSpace(&quot;preserve&quot;);\n            }\n        }\n    }\n\n    public static List&lt;Object&gt; getAllElementFromObject(Object obj, Class&lt;?&gt; toSearch) {\n        List&lt;Object&gt; result = new ArrayList&lt;Object&gt;();\n        if (obj instanceof JAXBElement) obj = ((JAXBElement&lt;?&gt;) obj).getValue();\n\n        if (obj.getClass().equals(toSearch))\n            result.add(obj);\n        else if (obj instanceof ContentAccessor) {\n            List&lt;?&gt; children = ((ContentAccessor) obj).getContent();\n            for (Object child : children) {\n                result.addAll(getAllElementFromObject(child, toSearch));\n            }\n        }\n        return result;\n    }\n</code></pre>\n"},{"tags":["java","intellij-idea","java-17"],"comments":[{"owner":{"account_id":36734,"reputation":392137,"user_id":104891,"display_name":"CrazyCoder"},"score":0,"creation_date":1699972149,"post_id":77481218,"comment_id":136595702,"body_markdown":"What is the exact Java 17 build you are using? Does it help if you install a more recent build? Does it help if you try with a more recent JDK version?","body":"What is the exact Java 17 build you are using? Does it help if you install a more recent build? Does it help if you try with a more recent JDK version?"},{"owner":{"account_id":8147390,"reputation":55,"user_id":6135644,"display_name":"Robin Silv&#233;rio"},"score":0,"creation_date":1700037353,"post_id":77481218,"comment_id":136604426,"body_markdown":"I will try that","body":"I will try that"},{"owner":{"account_id":8147390,"reputation":55,"user_id":6135644,"display_name":"Robin Silv&#233;rio"},"score":0,"creation_date":1700040394,"post_id":77481218,"comment_id":136604923,"body_markdown":"@CrazyCoder Turns out it worked!!","body":"@CrazyCoder Turns out it worked!!"}],"answers":[{"tags":[],"owner":{"account_id":8147390,"reputation":55,"user_id":6135644,"display_name":"Robin Silv&#233;rio"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1700040459,"creation_date":1700040459,"answer_id":77486519,"question_id":77481218,"body_markdown":"Turns out, updating the jdk version worked to solve the problem.","title":"Abnormal build process termination Intellij","body":"<p>Turns out, updating the jdk version worked to solve the problem.</p>\n"}],"owner":{"account_id":8147390,"reputation":55,"user_id":6135644,"display_name":"Robin Silv&#233;rio"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":57,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1700040459,"creation_date":1699970607,"question_id":77481218,"body_markdown":"I&#39;ve come across the problem that intellij won&#39;t start the java application as it give me an error of abnormal build process termination. Keep in mind that the java application is using JDK 17. Did anyone came across this problem before?\r\n\r\n\r\n\r\n**Steps to reproduce**\r\n\r\n1. Starting the intellij and picking the java project.\r\n2. Starting the application\r\n\r\n**Expected behaviour**\r\n\r\nApplication starts after compilation\r\n\r\n**Actual behaviour**\r\n\r\n*Short error:*\r\n\r\nCompiler intrinsic is defined for method [jdk.internal.misc.Unsafe.storeStoreFence()V], but the method is not annotated with @IntrinsicCandidate. Method will not be inlined.\r\nError occurred during initialization of VM\r\n\r\n*Logs*\r\n```\r\nAbnormal build process termination: \r\n&quot;C:\\Program Files\\Java\\jdk-17\\bin\\java.exe&quot; -Xmx700m -Djava.awt.headless=true &quot;-Djna.boot.library.path=C:\\Program Files\\JetBrains\\IntelliJ IDEA 2023.1.3/lib/jna/amd64&quot; -Djna.nosys=true -Djna.noclasspath=true --add-opens jdk.compiler/com.sun.tools.javac.api=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.util=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.code=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.comp=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.file=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.main=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.model=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.parser=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.processing=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.tree=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.jvm=ALL-UNNAMED -Dexternal.project.config=C:\\Users\\T14832\\AppData\\Local\\JetBrains\\IntelliJIdea2023.1\\projects\\campaign-admin-backend.b1b76b30\\external_build_system -Dcompile.parallel=false -Drebuild.on.dependency.change=true -Didea.IntToIntBtree.page.size=32768 -Djdt.compiler.useSingleThread=true -Daether.connector.resumeDownloads=false -Dio.netty.initialSeedUniquifier=8663416678261986006 -Dfile.encoding=windows-1252 -Duser.language=nl -Duser.country=NL -Didea.paths.selector=IntelliJIdea2023.1 &quot;-Didea.home.path=C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3&quot; -Didea.config.path=C:/Users/T14832/AppData/Roaming/JetBrains/IntelliJIdea2023.1 -Didea.plugins.path=C:/Users/T14832/AppData/Roaming/JetBrains/IntelliJIdea2023.1/plugins -Djps.log.dir=C:/Users/T14832/AppData/Local/JetBrains/IntelliJIdea2023.1/log/build-log &quot;-Djps.fallback.jdk.home=C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/jbr&quot; -Djps.fallback.jdk.version=17.0.7 -Dio.netty.noUnsafe=true -Djava.io.tmpdir=C:/Users/T14832/AppData/Local/JetBrains/IntelliJIdea2023.1/compile-server/campaign-admin-backend_c3241ff3/_temp_ -Djps.backward.ref.index.builder=true -Dtmh.instrument.annotations=true -Dtmh.generate.line.numbers=true &quot;-Djps.kotlin.home=C:\\Program Files\\JetBrains\\IntelliJ IDEA 2023.1.3\\plugins\\Kotlin\\kotlinc&quot; -Dkotlin.incremental.compilation=true -Dkotlin.incremental.compilation.js=true -Dkotlin.daemon.enabled -Dkotlin.daemon.client.alive.path=\\&quot;C:\\Users\\T14832\\AppData\\Local\\Temp\\kotlin-idea-12702813341039359777-is-running\\&quot; -Dide.propagate.context=false -classpath &quot;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/jps-launcher.jar&quot; org.jetbrains.jps.cmdline.Launcher &quot;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/jps-builders.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/jps-builders-6.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/jps-javac-extension.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/util.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/util-8.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/util_rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/annotations.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/3rd-party-rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/protobuf.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/jps-model.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/javac2.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/forms_rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/aether-dependency-resolver.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/idea_rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/JavaEE/lib/jasper-v2-rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/Kotlin/lib/jps/kotlin-jps-plugin.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/util.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/eclipse/lib/eclipse-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/eclipse/lib/eclipse-common.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/ant/lib/ant-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/JavaEE/lib/javaee-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/uiDesigner/lib/jps/java-guiForms-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/space/lib/space-java-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/devkit/lib/devkit-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/platform-langInjection/lib/java-langInjection-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/javaFX/lib/javaFX-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/javaFX/lib/javaFX-common.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/Groovy/lib/groovy-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/Groovy/lib/groovy-constants-rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/maven/lib/maven-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/gradle-java/lib/gradle-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/JPA/lib/jps/javaee-jpa-jps.jar&quot; org.jetbrains.jps.cmdline.BuildMain 127.0.0.1 61846 cd083bf2-f7fe-4805-bc19-f1d0e7163e17 C:/Users/T14832/AppData/Local/JetBrains/IntelliJIdea2023.1/compile-server\r\nCompiler intrinsic is defined for method [jdk.internal.misc.Unsafe.storeStoreFence()V], but the method is not annotated with @IntrinsicCandidate. Method will not be inlined.\r\nError occurred during initialization of VM\r\njava.lang.ExceptionInInitializerError\r\n\tat jdk.internal.loader.BootLoader.&lt;clinit&gt;(java.base/BootLoader.java:62)\r\n\tat java.lang.ClassLoader.findNative(java.base/ClassLoader.java:2437)\r\n\tat java.lang.Thread.isAlive(java.base/Native Method)\r\n\tat java.lang.Thread.setDaemon(java.base/Thread.java:1402)\r\n\tat java.lang.ref.Reference.&lt;clinit&gt;(java.base/Reference.java:313)\r\n\tat java.security.AccessController.doPrivileged(java.base/AccessController.java:318)\r\n\tat java.lang.reflect.AccessibleObject.&lt;clinit&gt;(java.base/AccessibleObject.java:489)\r\nCaused by: java.lang.NullPointerException\r\n\tat jdk.internal.util.StaticProperty.getProperty(java.base/StaticProperty.java:71)\r\n\tat jdk.internal.util.StaticProperty.&lt;clinit&gt;(java.base/StaticProperty.java:58)\r\n\tat jdk.internal.loader.BootLoader.&lt;clinit&gt;(java.base/BootLoader.java:62)\r\n\tat java.lang.ClassLoader.findNative(java.base/ClassLoader.java:2437)\r\n\tat java.lang.Thread.isAlive(java.base/Native Method)\r\n\tat java.lang.Thread.setDaemon(java.base/Thread.java:1402)\r\n\tat java.lang.ref.Reference.&lt;clinit&gt;(java.base/Reference.java:313)\r\n\tat java.security.AccessController.doPrivileged(java.base/AccessController.java:318)\r\n\tat java.lang.reflect.AccessibleObject.&lt;clinit&gt;(java.base/AccessibleObject.java:489)\r\n\r\n```\r\n\r\n","title":"Abnormal build process termination Intellij","body":"<p>I've come across the problem that intellij won't start the java application as it give me an error of abnormal build process termination. Keep in mind that the java application is using JDK 17. Did anyone came across this problem before?</p>\n<p><strong>Steps to reproduce</strong></p>\n<ol>\n<li>Starting the intellij and picking the java project.</li>\n<li>Starting the application</li>\n</ol>\n<p><strong>Expected behaviour</strong></p>\n<p>Application starts after compilation</p>\n<p><strong>Actual behaviour</strong></p>\n<p><em>Short error:</em></p>\n<p>Compiler intrinsic is defined for method [jdk.internal.misc.Unsafe.storeStoreFence()V], but the method is not annotated with @IntrinsicCandidate. Method will not be inlined.\nError occurred during initialization of VM</p>\n<p><em>Logs</em></p>\n<pre><code>Abnormal build process termination: \n&quot;C:\\Program Files\\Java\\jdk-17\\bin\\java.exe&quot; -Xmx700m -Djava.awt.headless=true &quot;-Djna.boot.library.path=C:\\Program Files\\JetBrains\\IntelliJ IDEA 2023.1.3/lib/jna/amd64&quot; -Djna.nosys=true -Djna.noclasspath=true --add-opens jdk.compiler/com.sun.tools.javac.api=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.util=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.code=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.comp=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.file=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.main=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.model=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.parser=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.processing=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.tree=ALL-UNNAMED --add-opens jdk.compiler/com.sun.tools.javac.jvm=ALL-UNNAMED -Dexternal.project.config=C:\\Users\\T14832\\AppData\\Local\\JetBrains\\IntelliJIdea2023.1\\projects\\campaign-admin-backend.b1b76b30\\external_build_system -Dcompile.parallel=false -Drebuild.on.dependency.change=true -Didea.IntToIntBtree.page.size=32768 -Djdt.compiler.useSingleThread=true -Daether.connector.resumeDownloads=false -Dio.netty.initialSeedUniquifier=8663416678261986006 -Dfile.encoding=windows-1252 -Duser.language=nl -Duser.country=NL -Didea.paths.selector=IntelliJIdea2023.1 &quot;-Didea.home.path=C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3&quot; -Didea.config.path=C:/Users/T14832/AppData/Roaming/JetBrains/IntelliJIdea2023.1 -Didea.plugins.path=C:/Users/T14832/AppData/Roaming/JetBrains/IntelliJIdea2023.1/plugins -Djps.log.dir=C:/Users/T14832/AppData/Local/JetBrains/IntelliJIdea2023.1/log/build-log &quot;-Djps.fallback.jdk.home=C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/jbr&quot; -Djps.fallback.jdk.version=17.0.7 -Dio.netty.noUnsafe=true -Djava.io.tmpdir=C:/Users/T14832/AppData/Local/JetBrains/IntelliJIdea2023.1/compile-server/campaign-admin-backend_c3241ff3/_temp_ -Djps.backward.ref.index.builder=true -Dtmh.instrument.annotations=true -Dtmh.generate.line.numbers=true &quot;-Djps.kotlin.home=C:\\Program Files\\JetBrains\\IntelliJ IDEA 2023.1.3\\plugins\\Kotlin\\kotlinc&quot; -Dkotlin.incremental.compilation=true -Dkotlin.incremental.compilation.js=true -Dkotlin.daemon.enabled -Dkotlin.daemon.client.alive.path=\\&quot;C:\\Users\\T14832\\AppData\\Local\\Temp\\kotlin-idea-12702813341039359777-is-running\\&quot; -Dide.propagate.context=false -classpath &quot;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/jps-launcher.jar&quot; org.jetbrains.jps.cmdline.Launcher &quot;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/jps-builders.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/jps-builders-6.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/jps-javac-extension.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/util.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/util-8.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/util_rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/annotations.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/3rd-party-rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/protobuf.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/jps-model.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/javac2.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/forms_rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/java/lib/aether-dependency-resolver.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/idea_rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/JavaEE/lib/jasper-v2-rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/Kotlin/lib/jps/kotlin-jps-plugin.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/lib/util.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/eclipse/lib/eclipse-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/eclipse/lib/eclipse-common.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/ant/lib/ant-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/JavaEE/lib/javaee-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/uiDesigner/lib/jps/java-guiForms-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/space/lib/space-java-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/devkit/lib/devkit-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/platform-langInjection/lib/java-langInjection-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/javaFX/lib/javaFX-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/javaFX/lib/javaFX-common.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/Groovy/lib/groovy-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/Groovy/lib/groovy-constants-rt.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/maven/lib/maven-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/gradle-java/lib/gradle-jps.jar;C:/Program Files/JetBrains/IntelliJ IDEA 2023.1.3/plugins/JPA/lib/jps/javaee-jpa-jps.jar&quot; org.jetbrains.jps.cmdline.BuildMain 127.0.0.1 61846 cd083bf2-f7fe-4805-bc19-f1d0e7163e17 C:/Users/T14832/AppData/Local/JetBrains/IntelliJIdea2023.1/compile-server\nCompiler intrinsic is defined for method [jdk.internal.misc.Unsafe.storeStoreFence()V], but the method is not annotated with @IntrinsicCandidate. Method will not be inlined.\nError occurred during initialization of VM\njava.lang.ExceptionInInitializerError\n    at jdk.internal.loader.BootLoader.&lt;clinit&gt;(java.base/BootLoader.java:62)\n    at java.lang.ClassLoader.findNative(java.base/ClassLoader.java:2437)\n    at java.lang.Thread.isAlive(java.base/Native Method)\n    at java.lang.Thread.setDaemon(java.base/Thread.java:1402)\n    at java.lang.ref.Reference.&lt;clinit&gt;(java.base/Reference.java:313)\n    at java.security.AccessController.doPrivileged(java.base/AccessController.java:318)\n    at java.lang.reflect.AccessibleObject.&lt;clinit&gt;(java.base/AccessibleObject.java:489)\nCaused by: java.lang.NullPointerException\n    at jdk.internal.util.StaticProperty.getProperty(java.base/StaticProperty.java:71)\n    at jdk.internal.util.StaticProperty.&lt;clinit&gt;(java.base/StaticProperty.java:58)\n    at jdk.internal.loader.BootLoader.&lt;clinit&gt;(java.base/BootLoader.java:62)\n    at java.lang.ClassLoader.findNative(java.base/ClassLoader.java:2437)\n    at java.lang.Thread.isAlive(java.base/Native Method)\n    at java.lang.Thread.setDaemon(java.base/Thread.java:1402)\n    at java.lang.ref.Reference.&lt;clinit&gt;(java.base/Reference.java:313)\n    at java.security.AccessController.doPrivileged(java.base/AccessController.java:318)\n    at java.lang.reflect.AccessibleObject.&lt;clinit&gt;(java.base/AccessibleObject.java:489)\n\n</code></pre>\n"},{"tags":["java","maven","timefold"],"comments":[{"owner":{"account_id":9133364,"reputation":4450,"user_id":6794063,"display_name":"Luk&#225;š Petrovick&#253;"},"score":0,"creation_date":1700039568,"post_id":77486240,"comment_id":136604812,"body_markdown":"You probably forgot to push your changes to the repo. I still see the original structure there.","body":"You probably forgot to push your changes to the repo. I still see the original structure there."},{"owner":{"account_id":29820306,"reputation":1,"user_id":22853703,"display_name":"EdoZp12"},"score":0,"creation_date":1700055847,"post_id":77486240,"comment_id":136607671,"body_markdown":"You will probably see a version of school  timetabling which is modify for my purpose, Lesson is equal to Orders, Room is equal to Machines,  Teacher is equal to Worker and Group Subject to Product Materilal (we are talking about single material productions), when i finished the constraints i will refactor the names","body":"You will probably see a version of school  timetabling which is modify for my purpose, Lesson is equal to Orders, Room is equal to Machines,  Teacher is equal to Worker and Group Subject to Product Materilal (we are talking about single material productions), when i finished the constraints i will refactor the names"},{"owner":{"account_id":216698,"reputation":26495,"user_id":472109,"accept_rate":85,"display_name":"Geoffrey De Smet"},"score":0,"creation_date":1700059134,"post_id":77486240,"comment_id":136608391,"body_markdown":"Have you seen the food packaging quickstart? That&#39;s arguably closer than school timetabling.","body":"Have you seen the food packaging quickstart? That&#39;s arguably closer than school timetabling."}],"answers":[{"comments":[{"owner":{"account_id":29820306,"reputation":1,"user_id":22853703,"display_name":"EdoZp12"},"score":0,"creation_date":1700054497,"post_id":77486456,"comment_id":136607401,"body_markdown":"Thank u for trying helping me, yeah I know this recoding could be difficult to realize but its for my degree tesis report, its sperimental and i have to at less try to do it!","body":"Thank u for trying helping me, yeah I know this recoding could be difficult to realize but its for my degree tesis report, its sperimental and i have to at less try to do it!"},{"owner":{"account_id":29820306,"reputation":1,"user_id":22853703,"display_name":"EdoZp12"},"score":0,"creation_date":1700054700,"post_id":77486456,"comment_id":136607436,"body_markdown":"Using a new hard constaint was the first try I did, didnt work... in the code on my github theres the way I implemented it... talking about JSON, i&#39;m using Quarkus, and i thougt that now my program is taking resource form the demoResource class, i was wondering if i can take for example a JSON gived by an ABP management system in which i would record my orders","body":"Using a new hard constaint was the first try I did, didnt work... in the code on my github theres the way I implemented it... talking about JSON, i&#39;m using Quarkus, and i thougt that now my program is taking resource form the demoResource class, i was wondering if i can take for example a JSON gived by an ABP management system in which i would record my orders"},{"owner":{"account_id":29820306,"reputation":1,"user_id":22853703,"display_name":"EdoZp12"},"score":0,"creation_date":1700055082,"post_id":77486456,"comment_id":136607511,"body_markdown":"as i said before, i tried to divide my orders into 15 minutes slot so that you could probably mange in a better way big time needed orders, but dont know why every orders stays like in one hour virtusal slot (for example it stays into: 00:000-00:15, 00:15-00:30, 00:30-00:45, 00:45-1:00) and in that way the orders 15 minutes slots overlap in a single time slot, theres like a 1 hour time limit per order in some way...","body":"as i said before, i tried to divide my orders into 15 minutes slot so that you could probably mange in a better way big time needed orders, but dont know why every orders stays like in one hour virtusal slot (for example it stays into: 00:000-00:15, 00:15-00:30, 00:30-00:45, 00:45-1:00) and in that way the orders 15 minutes slots overlap in a single time slot, theres like a 1 hour time limit per order in some way..."}],"tags":[],"owner":{"account_id":9133364,"reputation":4450,"user_id":6794063,"display_name":"Luk&#225;š Petrovick&#253;"},"comment_count":3,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1700039857,"creation_date":1700039857,"answer_id":77486456,"question_id":77486240,"body_markdown":"Generally, if a solver gives you a solution in which there is a situation you don&#39;t like, you need to identify the situation and write a constraint to penalize that situation. In this case, you need to write a hard constraint to penalize every time the solver puts two jobs in the same slot. Something conceptually like this:\r\n\r\n    forEach(Order.class)\r\n        .join(Order.class, Joiners.equal(Order::getSlot))\r\n        .filter((order1, order2) -&gt; order1 != order2)\r\n        .penalize(...Score.ONE_HARD)\r\n        .asConstraint(&quot;Two orders in the same slot.&quot;);\r\n\r\n(Side note: I would be very cautious in applying the School Timetabling model to job shop scheduling. You will probably run into difficulties and will need to change the model, especially as you start trying to add dependencies between jobs. Unfortunately, we do not yet have a job shop scheduling quickstart for you to use.)\r\n\r\n\r\nAs to your JSON question, this is not directly related to Timefold Solver. You are effectively asking how to deserialize a Java object from JSON, and how to supply that JSON remotely; based on whether you&#39;re using Quarkus or Spring Boot, the answer will differ. But neither of the answers will be specific to Timefold Solver; I suggest you either Google for the answer, or ask another question here on StackOverflow.","title":"TimeFold.ai working on re-coding from timefold.ai schoolt timetabling to job shop scheduling for industrial production","body":"<p>Generally, if a solver gives you a solution in which there is a situation you don't like, you need to identify the situation and write a constraint to penalize that situation. In this case, you need to write a hard constraint to penalize every time the solver puts two jobs in the same slot. Something conceptually like this:</p>\n<pre><code>forEach(Order.class)\n    .join(Order.class, Joiners.equal(Order::getSlot))\n    .filter((order1, order2) -&gt; order1 != order2)\n    .penalize(...Score.ONE_HARD)\n    .asConstraint(&quot;Two orders in the same slot.&quot;);\n</code></pre>\n<p>(Side note: I would be very cautious in applying the School Timetabling model to job shop scheduling. You will probably run into difficulties and will need to change the model, especially as you start trying to add dependencies between jobs. Unfortunately, we do not yet have a job shop scheduling quickstart for you to use.)</p>\n<p>As to your JSON question, this is not directly related to Timefold Solver. You are effectively asking how to deserialize a Java object from JSON, and how to supply that JSON remotely; based on whether you're using Quarkus or Spring Boot, the answer will differ. But neither of the answers will be specific to Timefold Solver; I suggest you either Google for the answer, or ask another question here on StackOverflow.</p>\n"}],"owner":{"account_id":29820306,"reputation":1,"user_id":22853703,"display_name":"EdoZp12"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":47,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1700039857,"creation_date":1700037660,"question_id":77486240,"body_markdown":"Goodmorning everyone, i&#39;m working on recoding of timefold.ai school time tabling to create a job shop scheduling for industrial production, i &quot;trasformed&quot; Lesson class into Orders, Teacher into working operators, and group subject into product material using the same constraintProvider class and changing timeslot from 1 hour timeslot into 15 minutes timeslot, like that when i insert a new order into the DemoResource class I divide for example 3 hours production into 15 minutes slot so like that I suppose the programe should organize the orders on that characteristics.\r\nWhen I run the program it work on 6 machine simultaneously but place in a 15 minutes slot more than one order slot.\r\nHow should I fix this problem?\r\nanother question... if i would like to pass a JSON file with my orders data to my timefold instead of using the DemoResource class, How could i do that?\r\n\r\nThis is my work so far:\r\nhttps://github.com/EdoZp1/TimeFold-IndustrialProduction-EdoardoZoppi","title":"TimeFold.ai working on re-coding from timefold.ai schoolt timetabling to job shop scheduling for industrial production","body":"<p>Goodmorning everyone, i'm working on recoding of timefold.ai school time tabling to create a job shop scheduling for industrial production, i &quot;trasformed&quot; Lesson class into Orders, Teacher into working operators, and group subject into product material using the same constraintProvider class and changing timeslot from 1 hour timeslot into 15 minutes timeslot, like that when i insert a new order into the DemoResource class I divide for example 3 hours production into 15 minutes slot so like that I suppose the programe should organize the orders on that characteristics.\nWhen I run the program it work on 6 machine simultaneously but place in a 15 minutes slot more than one order slot.\nHow should I fix this problem?\nanother question... if i would like to pass a JSON file with my orders data to my timefold instead of using the DemoResource class, How could i do that?</p>\n<p>This is my work so far:\n<a href=\"https://github.com/EdoZp1/TimeFold-IndustrialProduction-EdoardoZoppi\" rel=\"nofollow noreferrer\">https://github.com/EdoZp1/TimeFold-IndustrialProduction-EdoardoZoppi</a></p>\n"},{"tags":["java","jmeter"],"answers":[{"comments":[{"owner":{"account_id":245999,"reputation":1232,"user_id":519852,"accept_rate":93,"display_name":"Matthias"},"score":0,"creation_date":1700043270,"post_id":77486431,"comment_id":136605445,"body_markdown":"This is super helpful. I wasn&#39;t aware at all about the LoopController. But also the tip with using JSR223 Sampler for fast trials is sooo good for me, thanks for reminding on it again. I was aware about the sampler but did not think about using it for the creation of new node elements. And also Thank you for the further reading material. This is a great answer.","body":"This is super helpful. I wasn&#39;t aware at all about the LoopController. But also the tip with using JSR223 Sampler for fast trials is sooo good for me, thanks for reminding on it again. I was aware about the sampler but did not think about using it for the creation of new node elements. And also Thank you for the further reading material. This is a great answer."}],"tags":[],"owner":{"account_id":3460456,"reputation":162758,"user_id":2897748,"display_name":"Dmitri T"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1700039581,"creation_date":1700039581,"answer_id":77486431,"question_id":77486326,"body_markdown":"You&#39;re missing some obvious mandatory elements like [Loop Controller][1] which is an integral part of the Thread Group , and properties provided via [TestElement][2]. \r\n\r\n\r\nIf this is **really** what you&#39;re looking for you can use the following code:\r\n\r\n\timport org.apache.jmeter.threads.ThreadGroup;\r\n\timport org.apache.jmeter.threads.gui.ThreadGroupGui;\r\n\timport org.apache.jmeter.gui.GuiPackage\r\n\timport org.apache.jmeter.gui.tree.JMeterTreeNode\r\n\timport org.apache.jmeter.exceptions.IllegalUserActionException\r\n\timport org.apache.jmeter.control.LoopController;\r\n\timport org.apache.jmeter.control.gui.LoopControlPanel;\r\n\timport org.apache.jmeter.testelement.TestElement;\r\n\t\r\n\tGuiPackage guiPackage = GuiPackage.getInstance();\r\n\tJMeterTreeNode testPlanNode = (JMeterTreeNode) guiPackage.getTreeModel().getRoot();\r\n\t\r\n\t\r\n\tLoopController loopController = new LoopController();\r\n\tloopController.setLoops(1);\r\n\tloopController.setFirst(true);\r\n\tloopController.setProperty(TestElement.TEST_CLASS, LoopController.class.getName());\r\n\tloopController.setProperty(TestElement.GUI_CLASS, LoopControlPanel.class.getName());\r\n\tloopController.initialize();\r\n\t\r\n\t\r\n\tThreadGroup threadGroup = new ThreadGroup();\r\n\tthreadGroup.setName(&quot;Example Thread Group&quot;);\r\n\tthreadGroup.setNumThreads(1);\r\n\tthreadGroup.setRampUp(1);\r\n\tthreadGroup.setSamplerController(loopController);\r\n\tthreadGroup.setProperty(TestElement.TEST_CLASS, ThreadGroup.class.getName());\r\n\tthreadGroup.setProperty(TestElement.GUI_CLASS, ThreadGroupGui.class.getName());\r\n\t\r\n\t\r\n\t\r\n\tJMeterTreeNode threadGroupNode;\r\n\ttry {\r\n\t   threadGroupNode = guiPackage.getTreeModel().addComponent(threadGroup, testPlanNode);\r\n\t} catch (IllegalUserActionException e) {\r\n\t   e.printStackTrace();\r\n\t}\r\n\t\r\n\t// Refresh the JMeter GUI\r\n\tguiPackage.getMainFrame().repaint();\r\n\r\n\r\nDemo:\r\n\r\n[![enter image description here][3]][3]\r\n\r\n\r\nMore information:\r\n\r\n - [JMeter Command Line Overview: 5 Ways To Launch a Test][4]\r\n - [jmeter-from-code][5]\r\n\r\n\r\nHowever it&#39;s better to take a look at [Building a Test Plan Programmatically][6] user manual chapter\r\n\r\n\r\n  [1]: https://jmeter.apache.org/usermanual/component_reference.html#Loop_Controller\r\n  [2]: https://jmeter.apache.org/api/org/apache/jmeter/testelement/TestElement.html\r\n  [3]: https://i.stack.imgur.com/nCD7z.gif\r\n  [4]: https://www.blazemeter.com/blog/jmeter-command-line\r\n  [5]: https://bitbucket.org/blazemeter/jmeter-from-code/src/master/src/main/java/com/blazemeter/demo/JMeterFromScratch.java\r\n  [6]: https://jmeter.apache.org/usermanual/build-programmatic-test-plan.html","title":"JMeter Plugin development: add standard ThreadGroup to Testplan programmatically","body":"<p>You're missing some obvious mandatory elements like <a href=\"https://jmeter.apache.org/usermanual/component_reference.html#Loop_Controller\" rel=\"nofollow noreferrer\">Loop Controller</a> which is an integral part of the Thread Group , and properties provided via <a href=\"https://jmeter.apache.org/api/org/apache/jmeter/testelement/TestElement.html\" rel=\"nofollow noreferrer\">TestElement</a>.</p>\n<p>If this is <strong>really</strong> what you're looking for you can use the following code:</p>\n<pre><code>import org.apache.jmeter.threads.ThreadGroup;\nimport org.apache.jmeter.threads.gui.ThreadGroupGui;\nimport org.apache.jmeter.gui.GuiPackage\nimport org.apache.jmeter.gui.tree.JMeterTreeNode\nimport org.apache.jmeter.exceptions.IllegalUserActionException\nimport org.apache.jmeter.control.LoopController;\nimport org.apache.jmeter.control.gui.LoopControlPanel;\nimport org.apache.jmeter.testelement.TestElement;\n\nGuiPackage guiPackage = GuiPackage.getInstance();\nJMeterTreeNode testPlanNode = (JMeterTreeNode) guiPackage.getTreeModel().getRoot();\n\n\nLoopController loopController = new LoopController();\nloopController.setLoops(1);\nloopController.setFirst(true);\nloopController.setProperty(TestElement.TEST_CLASS, LoopController.class.getName());\nloopController.setProperty(TestElement.GUI_CLASS, LoopControlPanel.class.getName());\nloopController.initialize();\n\n\nThreadGroup threadGroup = new ThreadGroup();\nthreadGroup.setName(&quot;Example Thread Group&quot;);\nthreadGroup.setNumThreads(1);\nthreadGroup.setRampUp(1);\nthreadGroup.setSamplerController(loopController);\nthreadGroup.setProperty(TestElement.TEST_CLASS, ThreadGroup.class.getName());\nthreadGroup.setProperty(TestElement.GUI_CLASS, ThreadGroupGui.class.getName());\n\n\n\nJMeterTreeNode threadGroupNode;\ntry {\n   threadGroupNode = guiPackage.getTreeModel().addComponent(threadGroup, testPlanNode);\n} catch (IllegalUserActionException e) {\n   e.printStackTrace();\n}\n\n// Refresh the JMeter GUI\nguiPackage.getMainFrame().repaint();\n</code></pre>\n<p>Demo:</p>\n<p><a href=\"https://i.stack.imgur.com/nCD7z.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nCD7z.gif\" alt=\"enter image description here\" /></a></p>\n<p>More information:</p>\n<ul>\n<li><a href=\"https://www.blazemeter.com/blog/jmeter-command-line\" rel=\"nofollow noreferrer\">JMeter Command Line Overview: 5 Ways To Launch a Test</a></li>\n<li><a href=\"https://bitbucket.org/blazemeter/jmeter-from-code/src/master/src/main/java/com/blazemeter/demo/JMeterFromScratch.java\" rel=\"nofollow noreferrer\">jmeter-from-code</a></li>\n</ul>\n<p>However it's better to take a look at <a href=\"https://jmeter.apache.org/usermanual/build-programmatic-test-plan.html\" rel=\"nofollow noreferrer\">Building a Test Plan Programmatically</a> user manual chapter</p>\n"}],"owner":{"account_id":245999,"reputation":1232,"user_id":519852,"accept_rate":93,"display_name":"Matthias"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":21,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":77486431,"answer_count":1,"score":0,"last_activity_date":1700039581,"creation_date":1700038531,"question_id":77486326,"body_markdown":"I am trying to implement a new JMeter plugin myself. What I reached so far is adding a top-level menu entry and when clicking on it to start my plugin workflow.\r\n\r\nI want to achieve to add a deafult ThreadGroup to the root Testplan. I try it like this:\r\n\r\n    public void addNewThreadGroupWithSamplers() {\r\n        GuiPackage guiPackage = GuiPackage.getInstance();\r\n        JMeterTreeNode testPlanNode = (JMeterTreeNode) guiPackage.getTreeModel().getRoot();\r\n\r\n        // Create a new Thread Group\r\n        ThreadGroup threadGroup = new ThreadGroup();\r\n        threadGroup.setName(&quot;New Thread Group&quot;);\r\n\r\n        // Add the new Thread Group to the Test Plan and get its node\r\n        JMeterTreeNode threadGroupNode;\r\n        try {\r\n            threadGroupNode = guiPackage.getTreeModel().addComponent(threadGroup, testPlanNode);\r\n        } catch (IllegalUserActionException e) {\r\n            e.printStackTrace();\r\n        }\r\n\r\n        // Refresh the JMeter GUI\r\n        guiPackage.getMainFrame().repaint();\r\n    }\r\n\r\nUnfortunately I get a null pointer exception  from `JMeterTreeModel`, that states \r\n\r\n```\r\nUncaught Exception java.lang.NullPointerException: Cannot invoke &quot;org.apache.jmeter.gui.JMeterGUIComponent.clearGui()&quot; because &quot;guicomp&quot; is null in thread Thread[AWT-EventQueue-0,6,main]. See log file for details.\r\n```\r\n\r\nand the exception occurs at this line of JMeter:\r\n```\r\nJMeterGUIComponent guicomp = guiPackage.getGui(component);\r\n```\r\n\r\nof `addComponent()`\r\n\r\nSomething with the UI seems to be uninitialized or what could be the reason. Can you please pin-point me to a lcation with an example or provide a solution?","title":"JMeter Plugin development: add standard ThreadGroup to Testplan programmatically","body":"<p>I am trying to implement a new JMeter plugin myself. What I reached so far is adding a top-level menu entry and when clicking on it to start my plugin workflow.</p>\n<p>I want to achieve to add a deafult ThreadGroup to the root Testplan. I try it like this:</p>\n<pre><code>public void addNewThreadGroupWithSamplers() {\n    GuiPackage guiPackage = GuiPackage.getInstance();\n    JMeterTreeNode testPlanNode = (JMeterTreeNode) guiPackage.getTreeModel().getRoot();\n\n    // Create a new Thread Group\n    ThreadGroup threadGroup = new ThreadGroup();\n    threadGroup.setName(&quot;New Thread Group&quot;);\n\n    // Add the new Thread Group to the Test Plan and get its node\n    JMeterTreeNode threadGroupNode;\n    try {\n        threadGroupNode = guiPackage.getTreeModel().addComponent(threadGroup, testPlanNode);\n    } catch (IllegalUserActionException e) {\n        e.printStackTrace();\n    }\n\n    // Refresh the JMeter GUI\n    guiPackage.getMainFrame().repaint();\n}\n</code></pre>\n<p>Unfortunately I get a null pointer exception  from <code>JMeterTreeModel</code>, that states</p>\n<pre><code>Uncaught Exception java.lang.NullPointerException: Cannot invoke &quot;org.apache.jmeter.gui.JMeterGUIComponent.clearGui()&quot; because &quot;guicomp&quot; is null in thread Thread[AWT-EventQueue-0,6,main]. See log file for details.\n</code></pre>\n<p>and the exception occurs at this line of JMeter:</p>\n<pre><code>JMeterGUIComponent guicomp = guiPackage.getGui(component);\n</code></pre>\n<p>of <code>addComponent()</code></p>\n<p>Something with the UI seems to be uninitialized or what could be the reason. Can you please pin-point me to a lcation with an example or provide a solution?</p>\n"},{"tags":["java","spring","spring-cloud","spring-cloud-config"],"comments":[{"owner":{"account_id":1368060,"reputation":24601,"user_id":2730527,"display_name":"spencergibb"},"score":0,"creation_date":1461225986,"post_id":36763192,"comment_id":61105139,"body_markdown":"Can you give a little more detail? What have you tried? If you&#39;ve tried something, and failed, what was the error?","body":"Can you give a little more detail? What have you tried? If you&#39;ve tried something, and failed, what was the error?"},{"owner":{"account_id":6325261,"reputation":93,"user_id":4911934,"display_name":"Amir Botvinik Nadiv"},"score":0,"creation_date":1461226147,"post_id":36763192,"comment_id":61105258,"body_markdown":"I have tried using @PropertyResource and he ignored the external location and started on tomcat default port","body":"I have tried using @PropertyResource and he ignored the external location and started on tomcat default port"}],"answers":[{"comments":[{"owner":{"account_id":6325261,"reputation":93,"user_id":4911934,"display_name":"Amir Botvinik Nadiv"},"score":0,"creation_date":1461228252,"post_id":36763937,"comment_id":61106792,"body_markdown":"Thanks Spencer , yes I would like to change it&#39;s location . So should I use spring.cloud.bootstrap.location inside bootstrap.properties ?","body":"Thanks Spencer , yes I would like to change it&#39;s location . So should I use spring.cloud.bootstrap.location inside bootstrap.properties ?"},{"owner":{"account_id":1368060,"reputation":24601,"user_id":2730527,"display_name":"spencergibb"},"score":3,"creation_date":1461238061,"post_id":36763937,"comment_id":61113829,"body_markdown":"No, it needs to be a env var, cmd line arg or java system property, otherwise you get a chicken and egg problem. How can you read the location of `bootstrap.properties` if you don&#39;t know the location ahead of time.","body":"No, it needs to be a env var, cmd line arg or java system property, otherwise you get a chicken and egg problem. How can you read the location of <code>bootstrap.properties</code> if you don&#39;t know the location ahead of time."},{"owner":{"account_id":6325261,"reputation":93,"user_id":4911934,"display_name":"Amir Botvinik Nadiv"},"score":0,"creation_date":1461238454,"post_id":36763937,"comment_id":61114150,"body_markdown":"Well It can reach bootstrap.properties but I want to direct it outside my jar","body":"Well It can reach bootstrap.properties but I want to direct it outside my jar"},{"owner":{"account_id":6325261,"reputation":93,"user_id":4911934,"display_name":"Amir Botvinik Nadiv"},"score":0,"creation_date":1461244618,"post_id":36763937,"comment_id":61118936,"body_markdown":"I have tried to use as enviorment parameters spring.cloud.bootstrap.location=C:\\test\\test.. This did not work  and i have tried to do the same as cmd line param. Maybe can you link me to an example for this 2 approaches? I have tried to change location but it is not clear how. Tnx","body":"I have tried to use as enviorment parameters spring.cloud.bootstrap.location=C:\\test\\test.. This did not work  and i have tried to do the same as cmd line param. Maybe can you link me to an example for this 2 approaches? I have tried to change location but it is not clear how. Tnx"},{"owner":{"account_id":6325261,"reputation":93,"user_id":4911934,"display_name":"Amir Botvinik Nadiv"},"score":1,"creation_date":1461249298,"post_id":36763937,"comment_id":61122674,"body_markdown":"Thank you Spencer - I have solved it with environment variable :   spring.cloud.bootstrap.location    C:\\tradair\\config\\tang\\bootstrap.properties","body":"Thank you Spencer - I have solved it with environment variable :   spring.cloud.bootstrap.location    C:\\tradair\\config\\tang\\bootstrap.properties"},{"owner":{"account_id":6325261,"reputation":93,"user_id":4911934,"display_name":"Amir Botvinik Nadiv"},"score":0,"creation_date":1461249792,"post_id":36763937,"comment_id":61123044,"body_markdown":"AND also updated to 1.04 version  :                                        &lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;1.0.4.RELEASE&lt;/version&gt;\n\t\t&lt;/dependency&gt;","body":"AND also updated to 1.04 version  :                                        &lt;dependency&gt; \t\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; \t\t\t&lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt; \t\t\t&lt;version&gt;1.0.4.RELEASE&lt;/version&gt; \t\t&lt;/dependency&gt;"},{"owner":{"account_id":5837880,"reputation":431,"user_id":4600335,"accept_rate":20,"display_name":"Amit Sadafule"},"score":0,"creation_date":1565250972,"post_id":36763937,"comment_id":101296140,"body_markdown":"I solved it by adding --spring.cloud.bootstrap.location={{app_dir}}/bootstrap.properties in service file while starting application","body":"I solved it by adding --spring.cloud.bootstrap.location={{app_dir}}/bootstrap.prop&zwnj;&#8203;erties in service file while starting application"}],"tags":[],"owner":{"account_id":1368060,"reputation":24601,"user_id":2730527,"display_name":"spencergibb"},"comment_count":7,"down_vote_count":0,"up_vote_count":17,"is_accepted":true,"score":17,"last_activity_date":1461227305,"creation_date":1461227305,"answer_id":36763937,"question_id":36763192,"body_markdown":"Spring Cloud uses the the same [locations as spring boot][1] to find `bootstrap.properties` (or `.yml`). So `classpath:,classpath:/config,file:,file:config/` is the default search path, `./config/` is the highest precedence. If your file is in `./config` or `./` it should just work. The property (`spring.cloud.bootstrap.location`) to [change the location][2] is slightly different than boot.\r\n\r\n\r\n  [1]: http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config-application-property-files\r\n  [2]: https://github.com/spring-cloud/spring-cloud-commons/blob/master/docs/src/main/asciidoc/spring-cloud-commons.adoc#changing-the-location-of-bootstrap-properties","title":"spring cloud - bootstrap.properties outside my jar","body":"<p>Spring Cloud uses the the same <a href=\"http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config-application-property-files\" rel=\"noreferrer\">locations as spring boot</a> to find <code>bootstrap.properties</code> (or <code>.yml</code>). So <code>classpath:,classpath:/config,file:,file:config/</code> is the default search path, <code>./config/</code> is the highest precedence. If your file is in <code>./config</code> or <code>./</code> it should just work. The property (<code>spring.cloud.bootstrap.location</code>) to <a href=\"https://github.com/spring-cloud/spring-cloud-commons/blob/master/docs/src/main/asciidoc/spring-cloud-commons.adoc#changing-the-location-of-bootstrap-properties\" rel=\"noreferrer\">change the location</a> is slightly different than boot.</p>\n"},{"tags":[],"owner":{"account_id":100270,"reputation":127154,"user_id":270371,"accept_rate":33,"display_name":"davidxxx"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1581494883,"creation_date":1581494883,"answer_id":60183728,"question_id":36763192,"body_markdown":"`spring.cloud.bootstrap.location` behaves like `spring.config.location` (in Spring Boot 2), it replaces the location of these configuration files.    \r\n\r\nTo make it working, it has to defined as a system property.   \r\nFor example :  \r\n\r\nWith Jar : \r\n\r\n    java -jar\r\n         -Dspring.cloud.bootstrap.location=anyLocation/bootstrap.yml \r\n          ...\r\n\r\n\r\nWith Spring Boot maven plugin :\r\n\r\n    mvn spring-boot:run \r\n       -Dspring-boot.run.jvmArguments=&quot;-Dspring.cloud.bootstrap.location=anyLocation/bootstrap.yml&quot;","title":"spring cloud - bootstrap.properties outside my jar","body":"<p><code>spring.cloud.bootstrap.location</code> behaves like <code>spring.config.location</code> (in Spring Boot 2), it replaces the location of these configuration files.    </p>\n\n<p>To make it working, it has to defined as a system property.<br>\nFor example :  </p>\n\n<p>With Jar : </p>\n\n<pre><code>java -jar\n     -Dspring.cloud.bootstrap.location=anyLocation/bootstrap.yml \n      ...\n</code></pre>\n\n<p>With Spring Boot maven plugin :</p>\n\n<pre><code>mvn spring-boot:run \n   -Dspring-boot.run.jvmArguments=\"-Dspring.cloud.bootstrap.location=anyLocation/bootstrap.yml\"\n</code></pre>\n"}],"owner":{"account_id":6325261,"reputation":93,"user_id":4911934,"display_name":"Amir Botvinik Nadiv"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":14279,"favorite_count":0,"down_vote_count":0,"up_vote_count":7,"accepted_answer_id":36763937,"answer_count":2,"score":7,"last_activity_date":1700039404,"creation_date":1461225086,"question_id":36763192,"body_markdown":"I am trying to put `bootstrap.properties` from outside my jar, so it won&#39;t get overridden by other developers by mistake. Could you please advice here?\r\n\r\nThis is its&#39; content - directing to the spring server config \r\n\r\n    # application name\r\n    spring.application.name=elixium\r\n    # The server entry point\r\n    spring.cloud.config.uri=http://localhost:8888","title":"spring cloud - bootstrap.properties outside my jar","body":"<p>I am trying to put <code>bootstrap.properties</code> from outside my jar, so it won't get overridden by other developers by mistake. Could you please advice here?</p>\n\n<p>This is its' content - directing to the spring server config </p>\n\n<pre><code># application name\nspring.application.name=elixium\n# The server entry point\nspring.cloud.config.uri=http://localhost:8888\n</code></pre>\n"},{"tags":["java","spring-boot","spring-webflux","spring-test"],"comments":[{"owner":{"account_id":3192259,"reputation":117609,"user_id":2696260,"display_name":"M. Deinum"},"score":1,"creation_date":1700045374,"post_id":77486310,"comment_id":136605819,"body_markdown":"The data isn&#39;t saved, it is only visible for the current thread / transaction. As the webclient is async it cannot see the non-committed data as it runs a different transaction.","body":"The data isn&#39;t saved, it is only visible for the current thread / transaction. As the webclient is async it cannot see the non-committed data as it runs a different transaction."}],"owner":{"account_id":17206530,"reputation":106,"user_id":12456968,"display_name":"Steven Kristian"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":24,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1700038945,"creation_date":1700038364,"question_id":77486310,"body_markdown":"I have a simple integration test case where I&#39;d like to find a certain data.\r\nFirst, I use .save() to insert a data. While it works successfully (as I debugged it and also this.dataRepository.findAll() does not return null), but when I use WebTestClient to get the specific data using the same method (this.dataRepository.findAll()), it returns null\r\n\r\n```java\r\n@RequestMapping(value = &quot;/api/constant&quot;)\r\npublic class ConfigurationController {\r\n\r\n  @Autowired\r\n  private DataRepository dataRepository;\r\n\r\n  @GetMapping\r\n  public Mono&lt;Object&gt; getConstant() {\r\n    Mono.fromSupplier(() -&gt; this.dataRepository.findAll()).subscribeOn(Schedulers.single());\r\n  }\r\n}\r\n```\r\n\r\n\r\n```java\r\n@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.MOCK)\r\n@AutoConfigureWebTestClient\r\n@Transactional\r\npublic class TestITCase {\r\n\r\n  @Autowired\r\n  private DataRepository dataRepository;\r\n\r\n  @Autowired\r\n  private WebTestClient webTestClient;\r\n\r\n  @Test\r\n  public void getConstants_Valid_Success()  {\r\n    this.dataRepository.saveAndFlush(data);\r\n    this.dataRepository.findAll(); // the data exist\r\n    FluxExchangeResult&lt;String&gt; result = this.webTestClient.get()\r\n        .uri(b -&gt; b.path(&quot;/api/constant&quot;)\r\n            .build())\r\n        .header(HttpHeaders.ACCEPT, MediaType.APPLICATION_JSON_VALUE)\r\n        .exchange()\r\n        .returnResult(String.class)\r\n        .getResponseBody()\r\n        .blockFirst(); // this returns null for some reason\r\n  }\r\n}\r\n\r\n```\r\n\r\n\r\n## UPDATE\r\nApparently when using WebTestClient,\r\n\r\n&gt; This request is handled in a different thread and as such uses a new transaction.\r\nhttps://stackoverflow.com/questions/69389071/repository-inserts-dont-work-in-springboottest-with-webtestclient\r\n\r\nBut now I&#39;m wondering is there a way such that the WebTestClient is running on the same thread? Because I do not want to commit a transaction then roll it back, as it does not create idempotency within my test (for example the test failed before .delete()), then the data is accidentally saved.","title":"No data received from WebTestClient when getting data from JpaRepository","body":"<p>I have a simple integration test case where I'd like to find a certain data.\nFirst, I use .save() to insert a data. While it works successfully (as I debugged it and also this.dataRepository.findAll() does not return null), but when I use WebTestClient to get the specific data using the same method (this.dataRepository.findAll()), it returns null</p>\n<pre class=\"lang-java prettyprint-override\"><code>@RequestMapping(value = &quot;/api/constant&quot;)\npublic class ConfigurationController {\n\n  @Autowired\n  private DataRepository dataRepository;\n\n  @GetMapping\n  public Mono&lt;Object&gt; getConstant() {\n    Mono.fromSupplier(() -&gt; this.dataRepository.findAll()).subscribeOn(Schedulers.single());\n  }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.MOCK)\n@AutoConfigureWebTestClient\n@Transactional\npublic class TestITCase {\n\n  @Autowired\n  private DataRepository dataRepository;\n\n  @Autowired\n  private WebTestClient webTestClient;\n\n  @Test\n  public void getConstants_Valid_Success()  {\n    this.dataRepository.saveAndFlush(data);\n    this.dataRepository.findAll(); // the data exist\n    FluxExchangeResult&lt;String&gt; result = this.webTestClient.get()\n        .uri(b -&gt; b.path(&quot;/api/constant&quot;)\n            .build())\n        .header(HttpHeaders.ACCEPT, MediaType.APPLICATION_JSON_VALUE)\n        .exchange()\n        .returnResult(String.class)\n        .getResponseBody()\n        .blockFirst(); // this returns null for some reason\n  }\n}\n\n</code></pre>\n<h2>UPDATE</h2>\n<p>Apparently when using WebTestClient,</p>\n<blockquote>\n<p>This request is handled in a different thread and as such uses a new transaction.\n<a href=\"https://stackoverflow.com/questions/69389071/repository-inserts-dont-work-in-springboottest-with-webtestclient\">Repository inserts don&#39;t work in SpringBootTest with WebTestClient</a></p>\n</blockquote>\n<p>But now I'm wondering is there a way such that the WebTestClient is running on the same thread? Because I do not want to commit a transaction then roll it back, as it does not create idempotency within my test (for example the test failed before .delete()), then the data is accidentally saved.</p>\n"}],"has_more":true,"quota_max":10000,"quota_remaining":9857,"page":60,"page_size":100}
