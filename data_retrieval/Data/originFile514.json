{"items":[{"tags":["java","apache-arrow"],"answers":[{"tags":[],"owner":{"account_id":4382227,"reputation":2318,"user_id":3573553,"display_name":"Mark"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1680791647,"creation_date":1680791647,"answer_id":75950754,"question_id":75889522,"body_markdown":"The solution I eventually found involves placing the `UnionListWriter` and the `startList()`, `endList()` and `setRowCount()` calls in the appropriate place.\r\n\r\nThe general pattern is:\r\n\r\n```java\r\ntry (\r\n   BufferAllocator allocator = new RootAllocator(Long.MAX_VALUE);\r\n   \r\n   // create all your vectors and other closable ...\r\n\r\n   final ListVector attributes = (ListVector) SamAlignmentSchema.ATTRIBUTES_FIELD.createVector(allocator);\r\n   // create the writer for the list vector\r\n   final UnionListWriter listWriter = attributes.getWriter();\r\n\r\n   // create the vector schema root\r\n   VectorSchemaRoot samRecordBatch = new VectorSchemaRoot(\r\n       aligmentSchema.getFields(),\r\n       List.of(\r\n           // add vectors including the list vecto\r\n           attributes\r\n       )\r\n   )\r\n){\r\n    //allocate the VectorSchemaRoot\r\n    samRecordBatch.allocateNew();\r\n    \r\n    // for reach sam record (read)\r\n    samReader.iterator().stream().forEach(samRecord -&gt; {\r\n        int index = samRecordBatch.getRowCount();\r\n        System.out.println(&quot;index = &quot; + index);\r\n\r\n        // set the values of the primitive vectors using set or setSafe ...\r\n\r\n        // write a list of attributes into the attrbutes field\r\n        final List&lt;SAMRecord.SAMTagAndValue&gt; recordAttributes = samRecord.getAttributes();\r\n\r\n        // start a new list at the current index\r\n        listWriter.startList();\r\n        listWriter.setPosition(index);\r\n\r\n        if (recordAttributes != null) {\r\n            // for each attribute\r\n            IntStream.range(0, recordAttributes.size()).forEachOrdered(attributeIndex -&gt; {\r\n\r\n                // put the values of the attribute in the arrow struct\r\n                final SAMRecord.SAMTagAndValue samTagAndValue = recordAttributes.get(attributeIndex);\r\n\r\n                final BaseWriter.StructWriter structWriter = listWriter.struct();\r\n                \r\n                // start a struct to go into the list\r\n                structWriter.start();\r\n\r\n                final byte[] tagBytes = samTagAndValue.tag.getBytes(StandardCharsets.UTF_8);\r\n                final byte[] typeBytes = &quot;S&quot;.getBytes(StandardCharsets.UTF_8);\r\n                final byte[] valueBytes = samTagAndValue.value.toString().getBytes(StandardCharsets.UTF_8);\r\n\r\n                ArrowBuf tempBuf = allocator.buffer(tagBytes.length);\r\n                tempBuf.setBytes(0, tagBytes);\r\n                structWriter.varChar(&quot;AttributeTag&quot;).writeVarChar(0, tagBytes.length, tempBuf);\r\n                tempBuf.close();\r\n\r\n                tempBuf = allocator.buffer(typeBytes.length);\r\n                tempBuf.setBytes(0, typeBytes);\r\n                structWriter.varChar(&quot;AttributeType&quot;).writeVarChar(0, typeBytes.length, tempBuf);\r\n                tempBuf.close();\r\n\r\n                tempBuf = allocator.buffer(valueBytes.length);\r\n                tempBuf.setBytes(0, valueBytes);\r\n                structWriter.varChar(&quot;AttributeValue&quot;).writeVarChar(0, valueBytes.length, tempBuf);\r\n                tempBuf.close();\r\n\r\n                //finished with this struct\r\n                structWriter.end();\r\n            });\r\n        }\r\n        index++;\r\n\r\n        // finished writing the list of structs for this position\r\n        listWriter.endList();\r\n\r\n        listWriter.setValueCount(index);\r\n        samRecordBatch.setRowCount(index);\r\n});\r\n```\r\n","title":"How to populate a Java Apache Arrow Field List of Structs?","body":"<p>The solution I eventually found involves placing the <code>UnionListWriter</code> and the <code>startList()</code>, <code>endList()</code> and <code>setRowCount()</code> calls in the appropriate place.</p>\n<p>The general pattern is:</p>\n<pre class=\"lang-java prettyprint-override\"><code>try (\n   BufferAllocator allocator = new RootAllocator(Long.MAX_VALUE);\n   \n   // create all your vectors and other closable ...\n\n   final ListVector attributes = (ListVector) SamAlignmentSchema.ATTRIBUTES_FIELD.createVector(allocator);\n   // create the writer for the list vector\n   final UnionListWriter listWriter = attributes.getWriter();\n\n   // create the vector schema root\n   VectorSchemaRoot samRecordBatch = new VectorSchemaRoot(\n       aligmentSchema.getFields(),\n       List.of(\n           // add vectors including the list vecto\n           attributes\n       )\n   )\n){\n    //allocate the VectorSchemaRoot\n    samRecordBatch.allocateNew();\n    \n    // for reach sam record (read)\n    samReader.iterator().stream().forEach(samRecord -&gt; {\n        int index = samRecordBatch.getRowCount();\n        System.out.println(&quot;index = &quot; + index);\n\n        // set the values of the primitive vectors using set or setSafe ...\n\n        // write a list of attributes into the attrbutes field\n        final List&lt;SAMRecord.SAMTagAndValue&gt; recordAttributes = samRecord.getAttributes();\n\n        // start a new list at the current index\n        listWriter.startList();\n        listWriter.setPosition(index);\n\n        if (recordAttributes != null) {\n            // for each attribute\n            IntStream.range(0, recordAttributes.size()).forEachOrdered(attributeIndex -&gt; {\n\n                // put the values of the attribute in the arrow struct\n                final SAMRecord.SAMTagAndValue samTagAndValue = recordAttributes.get(attributeIndex);\n\n                final BaseWriter.StructWriter structWriter = listWriter.struct();\n                \n                // start a struct to go into the list\n                structWriter.start();\n\n                final byte[] tagBytes = samTagAndValue.tag.getBytes(StandardCharsets.UTF_8);\n                final byte[] typeBytes = &quot;S&quot;.getBytes(StandardCharsets.UTF_8);\n                final byte[] valueBytes = samTagAndValue.value.toString().getBytes(StandardCharsets.UTF_8);\n\n                ArrowBuf tempBuf = allocator.buffer(tagBytes.length);\n                tempBuf.setBytes(0, tagBytes);\n                structWriter.varChar(&quot;AttributeTag&quot;).writeVarChar(0, tagBytes.length, tempBuf);\n                tempBuf.close();\n\n                tempBuf = allocator.buffer(typeBytes.length);\n                tempBuf.setBytes(0, typeBytes);\n                structWriter.varChar(&quot;AttributeType&quot;).writeVarChar(0, typeBytes.length, tempBuf);\n                tempBuf.close();\n\n                tempBuf = allocator.buffer(valueBytes.length);\n                tempBuf.setBytes(0, valueBytes);\n                structWriter.varChar(&quot;AttributeValue&quot;).writeVarChar(0, valueBytes.length, tempBuf);\n                tempBuf.close();\n\n                //finished with this struct\n                structWriter.end();\n            });\n        }\n        index++;\n\n        // finished writing the list of structs for this position\n        listWriter.endList();\n\n        listWriter.setValueCount(index);\n        samRecordBatch.setRowCount(index);\n});\n</code></pre>\n"}],"owner":{"account_id":4382227,"reputation":2318,"user_id":3573553,"display_name":"Mark"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":226,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":75950754,"answer_count":1,"score":1,"last_activity_date":1681066192,"creation_date":1680186667,"question_id":75889522,"body_markdown":"I have a data set which is mostly a 2D table, however one column (`Field`)\r\n(called Attributes) contains a `List` of `Structs` in each cell. Each\r\n`Struct` has three `Field`s: Attribute Tag, Attribute Type and Attribute\r\nValue.\r\n\r\nThe definition of the Attributes `Field` is:\r\n\r\n```java\r\n/**\r\n * Attribute Tag - Two character tag.\r\n */\r\npublic static final Field ATTRIBUTE_TAG_FIELD =\r\n        new Field(&quot;AttributeTag&quot;, FieldType.notNullable(new ArrowType.FixedSizeBinary(2)), null);\r\n\r\n\r\n/**\r\n * Attribute Type - One character type.\r\n */\r\npublic static final Field ATTRIBUTE_TYPE_FIELD =\r\n        new Field(\r\n                &quot;AttributeType&quot;,\r\n                new FieldType(false,\r\n                new ArrowType.FixedSizeBinary(1), null),\r\n                null\r\n        );\r\n\r\n/**\r\n * String representation of the Attribute value.\r\n */\r\npublic static final Field ATTRIBUTE_VALUE_FIELD = new Field(&quot;AttributeValue&quot;, FieldType.notNullable(new ArrowType.Utf8()), null);\r\n\r\n/**\r\n * The field is a nullable List of Structs each with an attribute tag,\r\ntype and value.\r\n */\r\npublic static final Field ATTRIBUTES_FIELD =\r\n        new Field(&quot;Attributes&quot;, FieldType.nullable(new ArrowType.List()), List.of(\r\n                new Field(&quot;Attribute&quot;, FieldType.nullable(new ArrowType.Struct()), List.of(\r\n                        ATTRIBUTE_TAG_FIELD, ATTRIBUTE_TYPE_FIELD, ATTRIBUTE_VALUE_FIELD))));\r\n```\r\n\r\nI have this code that attempts to populate the Attributes from some\r\nsource data. Although this produces no errors when run, it doesn&#39;t\r\nresult in any values in the attributes vector.\r\n\r\n```java\r\nfinal ListVector attributes = (ListVector)\r\nATTRIBUTES_FIELD.createVector(allocator);\r\n\r\n// this is the source of the attributes that I will populate into the\r\nattributes vector\r\nfinal List&lt;SAMRecord.SAMTagAndValue&gt; recordAttributes =\r\nsamRecord.getAttributes();\r\n\r\nif (recordAttributes != null &amp;&amp; recordAttributes.size() &gt; 0 ) {\r\n    final UnionListWriter listWriter = attributes.getWriter();\r\n    listWriter.allocate();\r\n\r\n    IntStream.range(0, recordAttributes.size()).forEachOrdered(attributeIndex -&gt; {\r\n        listWriter.setPosition(attributeIndex);\r\n        listWriter.startList();\r\n\r\n        // put the values of the attribute in the arrow struct\r\n        final SAMRecord.SAMTagAndValue samTagAndValue recordAttributes.get(attributeIndex);\r\n\r\n        // I think the problem is here. In a debugger this seems to create a new writer not related to my Vector??\r\n        final BaseWriter.StructWriter structWriter = listWriter.struct(&quot;Attribute&quot;);\r\n        structWriter.start();\r\n\r\n        final byte[] tagBytes =\r\n            samTagAndValue.tag.getBytes(StandardCharsets.UTF_8);\r\n        // todo find out the type from the value\r\n        final byte[] typeBytes = &quot;S&quot;.getBytes(StandardCharsets.UTF_8);\r\n        final byte[] valueBytes =\r\n            samTagAndValue.value.toString().getBytes(StandardCharsets.UTF_8);\r\n\r\n        ArrowBuf tempBuf = allocator.buffer(tagBytes.length);\r\n        tempBuf.setBytes(0, tagBytes);\r\n        structWriter.varChar(&quot;AttributeTag&quot;).writeVarChar(0, tagBytes.length, tempBuf);\r\n        tempBuf.close();\r\n\r\n\r\n        tempBuf = allocator.buffer(typeBytes.length);\r\n        structWriter.varChar(&quot;AttributeType&quot;).writeVarChar(0, typeBytes.length, tempBuf);\r\n        tempBuf.close();\r\n\r\n        tempBuf = allocator.buffer(valueBytes.length);\r\n        structWriter.varChar(&quot;AttributeValue&quot;).writeVarChar(0, valueBytes.length, tempBuf);\r\n        tempBuf.close();\r\n\r\n        structWriter.end();\r\n    });\r\n\r\n    listWriter.setValueCount(recordAttributes.size());\r\n    listWriter.end();\r\n}\r\n```\r\n\r\nWhy doesn&#39;t this result in any values in the `attributes` `ListVector`? What is the correct way to do this?\r\n","title":"How to populate a Java Apache Arrow Field List of Structs?","body":"<p>I have a data set which is mostly a 2D table, however one column (<code>Field</code>)\n(called Attributes) contains a <code>List</code> of <code>Structs</code> in each cell. Each\n<code>Struct</code> has three <code>Field</code>s: Attribute Tag, Attribute Type and Attribute\nValue.</p>\n<p>The definition of the Attributes <code>Field</code> is:</p>\n<pre class=\"lang-java prettyprint-override\"><code>/**\n * Attribute Tag - Two character tag.\n */\npublic static final Field ATTRIBUTE_TAG_FIELD =\n        new Field(&quot;AttributeTag&quot;, FieldType.notNullable(new ArrowType.FixedSizeBinary(2)), null);\n\n\n/**\n * Attribute Type - One character type.\n */\npublic static final Field ATTRIBUTE_TYPE_FIELD =\n        new Field(\n                &quot;AttributeType&quot;,\n                new FieldType(false,\n                new ArrowType.FixedSizeBinary(1), null),\n                null\n        );\n\n/**\n * String representation of the Attribute value.\n */\npublic static final Field ATTRIBUTE_VALUE_FIELD = new Field(&quot;AttributeValue&quot;, FieldType.notNullable(new ArrowType.Utf8()), null);\n\n/**\n * The field is a nullable List of Structs each with an attribute tag,\ntype and value.\n */\npublic static final Field ATTRIBUTES_FIELD =\n        new Field(&quot;Attributes&quot;, FieldType.nullable(new ArrowType.List()), List.of(\n                new Field(&quot;Attribute&quot;, FieldType.nullable(new ArrowType.Struct()), List.of(\n                        ATTRIBUTE_TAG_FIELD, ATTRIBUTE_TYPE_FIELD, ATTRIBUTE_VALUE_FIELD))));\n</code></pre>\n<p>I have this code that attempts to populate the Attributes from some\nsource data. Although this produces no errors when run, it doesn't\nresult in any values in the attributes vector.</p>\n<pre class=\"lang-java prettyprint-override\"><code>final ListVector attributes = (ListVector)\nATTRIBUTES_FIELD.createVector(allocator);\n\n// this is the source of the attributes that I will populate into the\nattributes vector\nfinal List&lt;SAMRecord.SAMTagAndValue&gt; recordAttributes =\nsamRecord.getAttributes();\n\nif (recordAttributes != null &amp;&amp; recordAttributes.size() &gt; 0 ) {\n    final UnionListWriter listWriter = attributes.getWriter();\n    listWriter.allocate();\n\n    IntStream.range(0, recordAttributes.size()).forEachOrdered(attributeIndex -&gt; {\n        listWriter.setPosition(attributeIndex);\n        listWriter.startList();\n\n        // put the values of the attribute in the arrow struct\n        final SAMRecord.SAMTagAndValue samTagAndValue recordAttributes.get(attributeIndex);\n\n        // I think the problem is here. In a debugger this seems to create a new writer not related to my Vector??\n        final BaseWriter.StructWriter structWriter = listWriter.struct(&quot;Attribute&quot;);\n        structWriter.start();\n\n        final byte[] tagBytes =\n            samTagAndValue.tag.getBytes(StandardCharsets.UTF_8);\n        // todo find out the type from the value\n        final byte[] typeBytes = &quot;S&quot;.getBytes(StandardCharsets.UTF_8);\n        final byte[] valueBytes =\n            samTagAndValue.value.toString().getBytes(StandardCharsets.UTF_8);\n\n        ArrowBuf tempBuf = allocator.buffer(tagBytes.length);\n        tempBuf.setBytes(0, tagBytes);\n        structWriter.varChar(&quot;AttributeTag&quot;).writeVarChar(0, tagBytes.length, tempBuf);\n        tempBuf.close();\n\n\n        tempBuf = allocator.buffer(typeBytes.length);\n        structWriter.varChar(&quot;AttributeType&quot;).writeVarChar(0, typeBytes.length, tempBuf);\n        tempBuf.close();\n\n        tempBuf = allocator.buffer(valueBytes.length);\n        structWriter.varChar(&quot;AttributeValue&quot;).writeVarChar(0, valueBytes.length, tempBuf);\n        tempBuf.close();\n\n        structWriter.end();\n    });\n\n    listWriter.setValueCount(recordAttributes.size());\n    listWriter.end();\n}\n</code></pre>\n<p>Why doesn't this result in any values in the <code>attributes</code> <code>ListVector</code>? What is the correct way to do this?</p>\n"},{"tags":["java","tomcat","database-connection","jndi"],"answers":[{"tags":[],"owner":{"account_id":947184,"reputation":49004,"user_id":974186,"accept_rate":79,"display_name":"Ren&#233; Link"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1373604603,"creation_date":1373604603,"answer_id":17607627,"question_id":17606988,"body_markdown":"Just configure the connection pool settings (maxActive, maxWait, maxIdle, ...).\r\nTomcat comes with the apache commons-dbcp library. It is repackaged as  $CATALINA_HOME/lib/tomcat-dbcp.jar.\r\n\r\nTake a look at the tomcat doc for details: http://tomcat.apache.org/tomcat-6.0-doc/jndi-datasource-examples-howto.html#Database_Connection_Pool_%28DBCP%29_Configurations\r\n\r\n\r\n    &lt;Context&gt;\r\n\t  &lt;Resource name=&quot;jdbc/TestDB&quot; auth=&quot;Container&quot; type=&quot;javax.sql.DataSource&quot;\r\n\t\t\t\t   maxActive=&quot;100&quot; maxIdle=&quot;30&quot; maxWait=&quot;10000&quot;\r\n\t\t\t\t   username=&quot;javauser&quot; password=&quot;javadude&quot; driverClassName=&quot;com.mysql.jdbc.Driver&quot;\r\n\t\t\t\t   url=&quot;jdbc:mysql://localhost:3306/javatest&quot;/&gt;\r\n\t&lt;/Context&gt;","title":"How to get PoolingDataSource from Tomcat&#39;s JNDI","body":"<p>Just configure the connection pool settings (maxActive, maxWait, maxIdle, ...).\nTomcat comes with the apache commons-dbcp library. It is repackaged as  $CATALINA_HOME/lib/tomcat-dbcp.jar.</p>\n\n<p>Take a look at the tomcat doc for details: <a href=\"http://tomcat.apache.org/tomcat-6.0-doc/jndi-datasource-examples-howto.html#Database_Connection_Pool_%28DBCP%29_Configurations\" rel=\"nofollow\">http://tomcat.apache.org/tomcat-6.0-doc/jndi-datasource-examples-howto.html#Database_Connection_Pool_%28DBCP%29_Configurations</a></p>\n\n<pre><code>&lt;Context&gt;\n  &lt;Resource name=\"jdbc/TestDB\" auth=\"Container\" type=\"javax.sql.DataSource\"\n               maxActive=\"100\" maxIdle=\"30\" maxWait=\"10000\"\n               username=\"javauser\" password=\"javadude\" driverClassName=\"com.mysql.jdbc.Driver\"\n               url=\"jdbc:mysql://localhost:3306/javatest\"/&gt;\n&lt;/Context&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":465863,"reputation":41382,"user_id":870248,"accept_rate":100,"display_name":"Paul Vargas"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1373606277,"creation_date":1373606277,"answer_id":17607852,"question_id":17606988,"body_markdown":"&gt; &lt;p&gt;The &lt;strong&gt;JDBC Connection Pool &lt;code&gt;org.apache.tomcat.jdbc.pool&lt;/code&gt;&lt;/strong&gt; \r\n  is a replacement or an alternative to the &lt;a href=&quot;http://commons.apache.org/dbcp/&quot;&gt;commons-dbcp&lt;/a&gt;\r\n  connection pool.&lt;/p&gt;\r\n\r\n1. Add to the `server.xml` file in the `GlobalNamingResources` section something like the next:\r\n\r\n\r\n\t\r\n\t    &lt;Resource name=&quot;jdbc/TestDB&quot; \r\n\t\t\t      auth=&quot;Container&quot; \r\n\t\t\t\t  type=&quot;javax.sql.DataSource&quot; \r\n\t\t\t\t  factory=&quot;org.apache.tomcat.jdbc.pool.DataSourceFactory&quot;\r\n\t\t\t\t  testWhileIdle=&quot;true&quot;\r\n\t\t\t\t  testOnBorrow=&quot;true&quot;\r\n\t\t\t\t  testOnReturn=&quot;false&quot;\r\n\t\t\t\t  validationQuery=&quot;SELECT 1&quot;\r\n\t\t\t\t  validationInterval=&quot;30000&quot;\r\n\t\t\t\t  timeBetweenEvictionRunsMillis=&quot;30000&quot;\r\n\t\t\t\t  maxActive=&quot;100&quot; \r\n\t\t\t\t  minIdle=&quot;10&quot; \r\n\t\t\t\t  maxWait=&quot;10000&quot; \r\n\t\t\t\t  initialSize=&quot;10&quot;\r\n\t\t\t\t  removeAbandonedTimeout=&quot;60&quot;\r\n\t\t\t\t  removeAbandoned=&quot;true&quot;\r\n\t\t\t\t  logAbandoned=&quot;true&quot;\r\n\t\t\t\t  minEvictableIdleTimeMillis=&quot;30000&quot; \r\n\t\t\t\t  jmxEnabled=&quot;true&quot;\r\n\t\t\t\t  jdbcInterceptors=&quot;org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer&quot;\r\n\t\t\t\t  username=&quot;root&quot; \r\n\t\t\t\t  password=&quot;password&quot; \r\n\t\t\t\t  driverClassName=&quot;com.mysql.jdbc.Driver&quot;\r\n\t\t\t\t  url=&quot;jdbc:mysql://localhost:3306/mysql&quot;/&gt;\r\n\r\n2. Add the JDBC driver JAR into the Tomcat lib directory.\r\n\r\n3. Add in your `context.xml`:\r\n\r\n        &lt;ResourceLink global=&quot;jdbc/TestDB&quot; name=&quot;jdbc/TestDB&quot; \r\n                      type=&quot;javax.sql.DataSource&quot;/&gt;\r\n\r\nSee more in [*The Tomcat JDBC Connection Pool*][1].\r\n\r\n\r\n  [1]: http://people.apache.org/~fhanik/jdbc-pool/jdbc-pool.html","title":"How to get PoolingDataSource from Tomcat&#39;s JNDI","body":"<blockquote>\n  <p>The <strong>JDBC Connection Pool <code>org.apache.tomcat.jdbc.pool</code></strong> \n    is a replacement or an alternative to the <a href=\"http://commons.apache.org/dbcp/\" rel=\"nofollow\">commons-dbcp</a>\n    connection pool.</p>\n</blockquote>\n\n<ol>\n<li><p>Add to the <code>server.xml</code> file in the <code>GlobalNamingResources</code> section something like the next:</p>\n\n<pre><code>&lt;Resource name=\"jdbc/TestDB\" \n          auth=\"Container\" \n          type=\"javax.sql.DataSource\" \n          factory=\"org.apache.tomcat.jdbc.pool.DataSourceFactory\"\n          testWhileIdle=\"true\"\n          testOnBorrow=\"true\"\n          testOnReturn=\"false\"\n          validationQuery=\"SELECT 1\"\n          validationInterval=\"30000\"\n          timeBetweenEvictionRunsMillis=\"30000\"\n          maxActive=\"100\" \n          minIdle=\"10\" \n          maxWait=\"10000\" \n          initialSize=\"10\"\n          removeAbandonedTimeout=\"60\"\n          removeAbandoned=\"true\"\n          logAbandoned=\"true\"\n          minEvictableIdleTimeMillis=\"30000\" \n          jmxEnabled=\"true\"\n          jdbcInterceptors=\"org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer\"\n          username=\"root\" \n          password=\"password\" \n          driverClassName=\"com.mysql.jdbc.Driver\"\n          url=\"jdbc:mysql://localhost:3306/mysql\"/&gt;\n</code></pre></li>\n<li><p>Add the JDBC driver JAR into the Tomcat lib directory.</p></li>\n<li><p>Add in your <code>context.xml</code>:</p>\n\n<pre><code>&lt;ResourceLink global=\"jdbc/TestDB\" name=\"jdbc/TestDB\" \n              type=\"javax.sql.DataSource\"/&gt;\n</code></pre></li>\n</ol>\n\n<p>See more in <a href=\"http://people.apache.org/~fhanik/jdbc-pool/jdbc-pool.html\" rel=\"nofollow\"><em>The Tomcat JDBC Connection Pool</em></a>.</p>\n"}],"owner":{"account_id":490670,"reputation":55804,"user_id":892029,"accept_rate":84,"display_name":"IAmYourFaja"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":438,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1681066164,"creation_date":1373599276,"question_id":17606988,"body_markdown":"If I deploy a web app to Tomcat, and have code like this:\r\n\r\n    Context ctx = new InitialContext();\r\n    DataSource ds = (DataSource)ctx.lookup(&quot;jdbc/myDB&quot;);\r\n\r\nHow can I specify for this `DataSource` to be a `PoolingDataSource`? How do I configure the pool (`GenericObjectPool`) to inject the `PoolingDataSource` with?\r\n\r\nOr, is this the default behavior of Tomcat&#39;s JNDI implementation? \r\n","title":"How to get PoolingDataSource from Tomcat&#39;s JNDI","body":"<p>If I deploy a web app to Tomcat, and have code like this:</p>\n<pre><code>Context ctx = new InitialContext();\nDataSource ds = (DataSource)ctx.lookup(&quot;jdbc/myDB&quot;);\n</code></pre>\n<p>How can I specify for this <code>DataSource</code> to be a <code>PoolingDataSource</code>? How do I configure the pool (<code>GenericObjectPool</code>) to inject the <code>PoolingDataSource</code> with?</p>\n<p>Or, is this the default behavior of Tomcat's JNDI implementation?</p>\n"},{"tags":["java","debugging","intellij-idea","remote-debugging"],"answers":[{"tags":[],"owner":{"account_id":18124764,"reputation":1,"user_id":13180378,"display_name":"Simon Morgan"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1663221864,"creation_date":1663221864,"answer_id":73726291,"question_id":64634675,"body_markdown":"I had the exact same problem and I know this is old but in case anyone lands here after searching for this, here&#39;s what worked for me; you need to set the working directory in your run configuration to the target/classes directory of your project. e.,g, if your project is at `/Users/name/project` and your source is in  `/Users/name/project/src/main/java/` set the working directory to `/Users/name/project/target/classes/` \r\n\r\nI wasted almost an entire day searching for an answer for this problem, turns out this error is caused by the VM not finding the compiled class file of the debuggee when run via the IDE because it sets the wrong working directory.","title":"Debuggee node sends VMDeathEvent right after VMStartEvent | Java Debugging Interface","body":"<p>I had the exact same problem and I know this is old but in case anyone lands here after searching for this, here's what worked for me; you need to set the working directory in your run configuration to the target/classes directory of your project. e.,g, if your project is at <code>/Users/name/project</code> and your source is in  <code>/Users/name/project/src/main/java/</code> set the working directory to <code>/Users/name/project/target/classes/</code></p>\n<p>I wasted almost an entire day searching for an answer for this problem, turns out this error is caused by the VM not finding the compiled class file of the debuggee when run via the IDE because it sets the wrong working directory.</p>\n"},{"tags":[],"owner":{"account_id":23430651,"reputation":1,"user_id":17489559,"display_name":"ayti"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681065855,"creation_date":1680561396,"answer_id":75924222,"question_id":64634675,"body_markdown":"I found the solution by changing the working directory as [this answer](https://stackoverflow.com/a/73726291) mentioned. The only difference is that I set the working directory as `build/classes/java/main` instead of `build/classes`.","title":"Debuggee node sends VMDeathEvent right after VMStartEvent | Java Debugging Interface","body":"<p>I found the solution by changing the working directory as <a href=\"https://stackoverflow.com/a/73726291\">this answer</a> mentioned. The only difference is that I set the working directory as <code>build/classes/java/main</code> instead of <code>build/classes</code>.</p>\n"}],"owner":{"account_id":7706619,"reputation":1384,"user_id":5837376,"display_name":"Buddhika Chathuranga"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":48,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":2,"score":2,"last_activity_date":1681065855,"creation_date":1604250783,"question_id":64634675,"body_markdown":"I am developing a simple debugger using Java and Java Debugging Interface. I have two classes `Debugger` and `Debuggee`. Debugger class consists of logics for debugging. Debuggee class is the class that is being debugged. \r\n\r\n[GitHub link to the Project][1]\r\n\r\nWhen I run the application in the terminal it&#39;s working perfectly. In the `Debugger` VM it expects a few types of events.\r\n\r\n1.  VMStartEvent\r\n2.  ClassPrepareEvent\r\n3.  BreakpointEvent\r\n4.  VMDeathEvent\r\n5.  VMDisconnectEvent\r\n\r\nWhen running the application in the terminal it&#39;s working perfectly. The debuggee node sends ClassPrepareEvent and BreakPointEvents. But when run the application in IntelliJ it does not send ClassPreparationEvent and BreakPointEvent.\r\n\r\nIt sends VMDeathEvent right after VMStartEvent and then VMDisconnectEvent. \r\n\r\nWhy does this behavior happen? Is there any configuration that I should set in IntelliJ?\r\n\r\n\r\n  [1]: https://github.com/buddhikac96/remotedebugger","title":"Debuggee node sends VMDeathEvent right after VMStartEvent | Java Debugging Interface","body":"<p>I am developing a simple debugger using Java and Java Debugging Interface. I have two classes <code>Debugger</code> and <code>Debuggee</code>. Debugger class consists of logics for debugging. Debuggee class is the class that is being debugged.</p>\n<p><a href=\"https://github.com/buddhikac96/remotedebugger\" rel=\"nofollow noreferrer\">GitHub link to the Project</a></p>\n<p>When I run the application in the terminal it's working perfectly. In the <code>Debugger</code> VM it expects a few types of events.</p>\n<ol>\n<li>VMStartEvent</li>\n<li>ClassPrepareEvent</li>\n<li>BreakpointEvent</li>\n<li>VMDeathEvent</li>\n<li>VMDisconnectEvent</li>\n</ol>\n<p>When running the application in the terminal it's working perfectly. The debuggee node sends ClassPrepareEvent and BreakPointEvents. But when run the application in IntelliJ it does not send ClassPreparationEvent and BreakPointEvent.</p>\n<p>It sends VMDeathEvent right after VMStartEvent and then VMDisconnectEvent.</p>\n<p>Why does this behavior happen? Is there any configuration that I should set in IntelliJ?</p>\n"},{"tags":["java","maven","java-7","java-6","maven-toolchains-plugin"],"comments":[{"owner":{"account_id":1883916,"reputation":4243,"user_id":1703524,"accept_rate":68,"display_name":"andPat"},"score":0,"creation_date":1383039781,"post_id":19654557,"comment_id":29184837,"body_markdown":"I cannot export JAVA_HOME with java 1.7 because I cannot touch configuraton of my machine, the default version of Java must be 1.6.","body":"I cannot export JAVA_HOME with java 1.7 because I cannot touch configuraton of my machine, the default version of Java must be 1.6."},{"owner":{"account_id":1650559,"reputation":2397,"user_id":1521258,"accept_rate":79,"display_name":"Zyga"},"score":0,"creation_date":1383040043,"post_id":19654557,"comment_id":29185021,"body_markdown":"Maven uses JAVA_HOME so dont think what you want to do is possible without changing JAVA_HOME value.","body":"Maven uses JAVA_HOME so dont think what you want to do is possible without changing JAVA_HOME value."},{"owner":{"account_id":3088832,"reputation":3115,"user_id":2615437,"accept_rate":50,"display_name":"xwoker"},"score":1,"creation_date":1383040329,"post_id":19654557,"comment_id":29185226,"body_markdown":"Are you using an IDE or the command line? Are you on a *nix or windows?","body":"Are you using an IDE or the command line? Are you on a *nix or windows?"},{"owner":{"account_id":1713214,"reputation":13643,"user_id":1570834,"display_name":"DB5"},"score":1,"creation_date":1383040595,"post_id":19654557,"comment_id":29185410,"body_markdown":"Does this answer cover what you want?\nhttp://stackoverflow.com/a/4724062/1570834","body":"Does this answer cover what you want? <a href=\"http://stackoverflow.com/a/4724062/1570834\">stackoverflow.com/a/4724062/1570834</a>"},{"owner":{"account_id":1883916,"reputation":4243,"user_id":1703524,"accept_rate":68,"display_name":"andPat"},"score":0,"creation_date":1383043120,"post_id":19654557,"comment_id":29186956,"body_markdown":"Yes is useful but I cannot make chnges to pom of project, nevertheless the stuff is the same and answer is correct","body":"Yes is useful but I cannot make chnges to pom of project, nevertheless the stuff is the same and answer is correct"}],"answers":[{"comments":[{"owner":{"account_id":17835,"reputation":303905,"user_id":40342,"accept_rate":62,"display_name":"Joachim Sauer"},"score":61,"creation_date":1383040365,"post_id":19654699,"comment_id":29185249,"body_markdown":"@andPat: so? You can set `JAVA_HOME` in your local shell without changing the configuration of your machine at all (as soon as you close that shell, the change is gone). You can even change it for a single command: `JAVA_HOME=/path/to/jdk17/ mvn build`","body":"@andPat: so? You can set <code>JAVA_HOME</code> in your local shell without changing the configuration of your machine at all (as soon as you close that shell, the change is gone). You can even change it for a single command: <code>JAVA_HOME=&#47;path&#47;to&#47;jdk17&#47; mvn build</code>"},{"owner":{"account_id":2829929,"reputation":5163,"user_id":2431702,"display_name":"DanielBarbarian"},"score":1,"creation_date":1383041261,"post_id":19654699,"comment_id":29185845,"body_markdown":"@JoachimSauer: Yes, but I had also made a reference to mvn.bat, which is Windows specific.","body":"@JoachimSauer: Yes, but I had also made a reference to mvn.bat, which is Windows specific."},{"owner":{"account_id":1364460,"reputation":3729,"user_id":1301197,"accept_rate":22,"display_name":"Ronan Quillevere"},"score":3,"creation_date":1438243486,"post_id":19654699,"comment_id":51373672,"body_markdown":"On mac you can create a .mavenrc file with the JAVA_HOME inside","body":"On mac you can create a .mavenrc file with the JAVA_HOME inside"},{"owner":{"account_id":3059600,"reputation":2961,"user_id":2592585,"accept_rate":67,"display_name":"ryanlutgen"},"score":5,"creation_date":1482180403,"post_id":19654699,"comment_id":69660731,"body_markdown":"Old, but throwing in my 2cents.  I am working on a Java 8 service that is called by a Java 7 application.  To avoid having to switch constantly when building, I (on windows) created a MVN_JAVA_HOME environment variable, and then replace every occurrence of JAVA_HOME with MVN_JAVA_HOME inside mvn and mvn.cmd.","body":"Old, but throwing in my 2cents.  I am working on a Java 8 service that is called by a Java 7 application.  To avoid having to switch constantly when building, I (on windows) created a MVN_JAVA_HOME environment variable, and then replace every occurrence of JAVA_HOME with MVN_JAVA_HOME inside mvn and mvn.cmd."}],"tags":[],"owner":{"account_id":2829929,"reputation":5163,"user_id":2431702,"display_name":"DanielBarbarian"},"comment_count":4,"down_vote_count":2,"up_vote_count":248,"is_accepted":true,"score":246,"last_activity_date":1526028300,"creation_date":1383040071,"answer_id":19654699,"question_id":19654557,"body_markdown":"Maven uses the `JAVA_HOME` parameter to find which Java version it is supposed to run. I see from your comment that you can&#39;t change that in the configuration. \r\n\r\n- You can set the `JAVA_HOME` parameter just before you start maven (and change it back afterwards if need be). \r\n- You could also go into your `mvn`(non-windows)/`mvn.bat`/`mvn.cmd`(windows) and set your java version explicitly there.\r\n","title":"How to set specific Java version to Maven?","body":"<p>Maven uses the <code>JAVA_HOME</code> parameter to find which Java version it is supposed to run. I see from your comment that you can't change that in the configuration. </p>\n\n<ul>\n<li>You can set the <code>JAVA_HOME</code> parameter just before you start maven (and change it back afterwards if need be). </li>\n<li>You could also go into your <code>mvn</code>(non-windows)/<code>mvn.bat</code>/<code>mvn.cmd</code>(windows) and set your java version explicitly there.</li>\n</ul>\n"},{"comments":[{"owner":{"account_id":2745652,"reputation":1931,"user_id":2366125,"accept_rate":61,"display_name":"CKM"},"score":6,"creation_date":1493988282,"post_id":23531900,"comment_id":74649538,"body_markdown":"In maven 3.5, `mvn.bat` is renamed to `mvn.cmd`.","body":"In maven 3.5, <code>mvn.bat</code> is renamed to <code>mvn.cmd</code>."}],"tags":[],"owner":{"account_id":1395602,"reputation":2264,"user_id":1325425,"accept_rate":60,"display_name":"Jonathan"},"comment_count":1,"down_vote_count":0,"up_vote_count":37,"is_accepted":false,"score":37,"last_activity_date":1399517394,"creation_date":1399517394,"answer_id":23531900,"question_id":19654557,"body_markdown":"Adding my two cents and explicitly providing the solution.\r\n\r\nI have two JDKs installed on my Windows Machine - `JDK 1.5` and `JDK 1.6`.\r\n\r\nMy default (and set to windows system environment variable) `JAVA_HOME` is set to `JDK 1.5`.\r\n\r\nHowever, I have a maven project that I need to build (i.e., [JBehave Tutorial&#39;s Etsy.com][1]) using `JDK 1.6`.\r\n\r\nMy solution in this scenario (which worked!), is as suggested by `@DanielBarbarian` to set it in `mvn.bat`. \r\n\r\nFor some not familiar with window&#39;s batch file, I just basically added the `set JAVA_HOME=&lt;path_to_other_jdk&gt;` line after `@REM ==== START VALIDATION ====` in `mvn.bat` (i.e., `%MAVEN_HOME%\\bin\\mvn.bat`):\r\n\r\n    @REM ==== START VALIDATION ====\r\n    set JAVA_HOME=C:\\Program Files\\Java\\jdk1.6.0_45\\jre\r\n    if not &quot;%JAVA_HOME%&quot; == &quot;&quot; goto OkJHome\r\n\r\n  [1]: https://github.com/jbehave/jbehave-tutorial","title":"How to set specific Java version to Maven?","body":"<p>Adding my two cents and explicitly providing the solution.</p>\n\n<p>I have two JDKs installed on my Windows Machine - <code>JDK 1.5</code> and <code>JDK 1.6</code>.</p>\n\n<p>My default (and set to windows system environment variable) <code>JAVA_HOME</code> is set to <code>JDK 1.5</code>.</p>\n\n<p>However, I have a maven project that I need to build (i.e., <a href=\"https://github.com/jbehave/jbehave-tutorial\">JBehave Tutorial's Etsy.com</a>) using <code>JDK 1.6</code>.</p>\n\n<p>My solution in this scenario (which worked!), is as suggested by <code>@DanielBarbarian</code> to set it in <code>mvn.bat</code>. </p>\n\n<p>For some not familiar with window's batch file, I just basically added the <code>set JAVA_HOME=&lt;path_to_other_jdk&gt;</code> line after <code>@REM ==== START VALIDATION ====</code> in <code>mvn.bat</code> (i.e., <code>%MAVEN_HOME%\\bin\\mvn.bat</code>):</p>\n\n<pre><code>@REM ==== START VALIDATION ====\nset JAVA_HOME=C:\\Program Files\\Java\\jdk1.6.0_45\\jre\nif not \"%JAVA_HOME%\" == \"\" goto OkJHome\n</code></pre>\n"},{"comments":[{"owner":{"account_id":1502229,"reputation":2973,"user_id":1406510,"accept_rate":64,"display_name":"nanosoft"},"score":1,"creation_date":1453708546,"post_id":31718429,"comment_id":57703485,"body_markdown":"I set it to set JAVA_HOME=C:\\Program Files\\Java\\jdk1.7.0_45 exluded jre subfolder.","body":"I set it to set JAVA_HOME=C:\\Program Files\\Java\\jdk1.7.0_45 exluded jre subfolder."},{"owner":{"account_id":1965862,"reputation":3669,"user_id":1766166,"accept_rate":71,"display_name":"zygimantus"},"score":0,"creation_date":1601891503,"post_id":31718429,"comment_id":113536622,"body_markdown":"Yes, @nanosoft This works only if JAVA_HOME is set to JDK directory, not JRE with \\jre.","body":"Yes, @nanosoft This works only if JAVA_HOME is set to JDK directory, not JRE with \\jre."},{"owner":{"display_name":"user18154017"},"score":0,"creation_date":1644340974,"post_id":31718429,"comment_id":125579113,"body_markdown":"If you can&#39;t find ^the mvn.bat^, this might help you: https://stackoverflow.com/questions/32706000/error-in-maven-build-mvn-bat-not-recognized","body":"If you can&#39;t find ^the mvn.bat^, this might help you: <a href=\"https://stackoverflow.com/questions/32706000/error-in-maven-build-mvn-bat-not-recognized\" title=\"error in maven build mvn bat not recognized\">stackoverflow.com/questions/32706000/&hellip;</a>"},{"owner":{"account_id":2294433,"reputation":75,"user_id":2016255,"display_name":"Alvaro"},"score":0,"creation_date":1668106166,"post_id":31718429,"comment_id":131332059,"body_markdown":"This should be the accepted answer.. Just add the file ~/.mavenrc and export JAVA_HOME there pointing it to the directory where the version you want or need to use is located.. And voil&#225;..","body":"This should be the accepted answer.. Just add the file ~/.mavenrc and export JAVA_HOME there pointing it to the directory where the version you want or need to use is located.. And voil&#225;.."}],"tags":[],"owner":{"account_id":1364460,"reputation":3729,"user_id":1301197,"accept_rate":22,"display_name":"Ronan Quillevere"},"comment_count":4,"down_vote_count":0,"up_vote_count":72,"is_accepted":false,"score":72,"last_activity_date":1438244340,"creation_date":1438243882,"answer_id":31718429,"question_id":19654557,"body_markdown":"**On windows** \r\n\r\nIf you do not want to change your `JAVA_HOME` variable inside the system variables.\r\n\r\nEdit your `mvn.bat` file and add a line like this\r\n\r\n    set JAVA_HOME=C:\\Program Files\\Java\\jdk1.7.0_45\\jre\r\n\r\nThis can be done after `@REM ==== START VALIDATION ====` like mentionned by @Jonathan\r\n\r\n**On Mac (&amp; Linux ?)**\r\n\r\nIf you do not want to change your `JAVA_HOME` variable inside your `~/.bashrc` or `~/.bash_profile`\r\n\r\nyou can create a `~/.mavenrc` file and redefine your `JAVA_HOME` using the [java_home tool][1]\r\n\r\n    export JAVA_HOME=`/usr/libexec/java_home -v 1.7.0_45`\r\n\r\n\r\n**Sanity Check**\r\n\r\nYou can verify that everything is working fine by executing the following commands. The jdk version should be different.\r\n\r\n`mvn -version`\r\n\r\nthen\r\n\r\n`java -version`\r\n\r\n\r\n\r\n  [1]: https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/java_home.1.html","title":"How to set specific Java version to Maven?","body":"<p><strong>On windows</strong> </p>\n\n<p>If you do not want to change your <code>JAVA_HOME</code> variable inside the system variables.</p>\n\n<p>Edit your <code>mvn.bat</code> file and add a line like this</p>\n\n<pre><code>set JAVA_HOME=C:\\Program Files\\Java\\jdk1.7.0_45\\jre\n</code></pre>\n\n<p>This can be done after <code>@REM ==== START VALIDATION ====</code> like mentionned by @Jonathan</p>\n\n<p><strong>On Mac (&amp; Linux ?)</strong></p>\n\n<p>If you do not want to change your <code>JAVA_HOME</code> variable inside your <code>~/.bashrc</code> or <code>~/.bash_profile</code></p>\n\n<p>you can create a <code>~/.mavenrc</code> file and redefine your <code>JAVA_HOME</code> using the <a href=\"https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/java_home.1.html\" rel=\"noreferrer\">java_home tool</a></p>\n\n<pre><code>export JAVA_HOME=`/usr/libexec/java_home -v 1.7.0_45`\n</code></pre>\n\n<p><strong>Sanity Check</strong></p>\n\n<p>You can verify that everything is working fine by executing the following commands. The jdk version should be different.</p>\n\n<p><code>mvn -version</code></p>\n\n<p>then</p>\n\n<p><code>java -version</code></p>\n"},{"comments":[{"owner":{"account_id":463642,"reputation":2030,"user_id":866670,"display_name":"Soundararajan"},"score":3,"creation_date":1495796311,"post_id":35463606,"comment_id":75412374,"body_markdown":"The best answer, ! Thanks. This explains a clear situation where we want to run Maven and the project under compilation with two different java runtimes/framework.","body":"The best answer, ! Thanks. This explains a clear situation where we want to run Maven and the project under compilation with two different java runtimes/framework."},{"owner":{"account_id":2772116,"reputation":2797,"user_id":2386514,"accept_rate":100,"display_name":"Jonathan E. Landrum"},"score":1,"creation_date":1606855528,"post_id":35463606,"comment_id":115088107,"body_markdown":"This is the best solution on the page, and should have been the accepted answer.","body":"This is the best solution on the page, and should have been the accepted answer."},{"owner":{"account_id":1841316,"reputation":3282,"user_id":1670643,"accept_rate":79,"display_name":"andyf"},"score":1,"creation_date":1623426152,"post_id":35463606,"comment_id":120084502,"body_markdown":"How this config works in pom.xml in each project?  Is define &#39;&lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;&#39; in pom.xml means using `/opt/java8`?","body":"How this config works in pom.xml in each project?  Is define &#39;&lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;&#39; in pom.xml means using <code>&#47;opt&#47;java8</code>?"},{"owner":{"account_id":2159802,"reputation":493,"user_id":1914243,"accept_rate":33,"display_name":"juckky"},"score":1,"creation_date":1632221225,"post_id":35463606,"comment_id":122428337,"body_markdown":"This is the best answer and should have been the accepted answer.  Toolchains are designed for this very scenario.","body":"This is the best answer and should have been the accepted answer.  Toolchains are designed for this very scenario."},{"owner":{"account_id":7450106,"reputation":1581,"user_id":8920834,"display_name":"fram"},"score":1,"creation_date":1639536997,"post_id":35463606,"comment_id":124371849,"body_markdown":"Chiming in - best answer! And, thank you. I, too, have been using maven for over a decade now and never knew about toolchains! Cheers","body":"Chiming in - best answer! And, thank you. I, too, have been using maven for over a decade now and never knew about toolchains! Cheers"},{"owner":{"account_id":18442446,"reputation":388,"user_id":14614707,"display_name":"Zhenyria"},"score":0,"creation_date":1670177420,"post_id":35463606,"comment_id":131809618,"body_markdown":"Okay, it&#39;s good answer, but how we can make this plugin is unnecessary indepenth of machine on which u want build your program?","body":"Okay, it&#39;s good answer, but how we can make this plugin is unnecessary indepenth of machine on which u want build your program?"},{"owner":{"account_id":4206618,"reputation":808,"user_id":4180447,"accept_rate":47,"display_name":"tarekahf"},"score":1,"creation_date":1670527467,"post_id":35463606,"comment_id":131901234,"body_markdown":"I followed the steps to activate the toolchain and I can see the effect showing in the output of `mvn clean install`, but when I unzip the resulting JAR and check the file `MANIFEST.MF` I always see the JDK defined by the system `PATH`  and `JAVA_HOME`.","body":"I followed the steps to activate the toolchain and I can see the effect showing in the output of <code>mvn clean install</code>, but when I unzip the resulting JAR and check the file <code>MANIFEST.MF</code> I always see the JDK defined by the system <code>PATH</code>  and <code>JAVA_HOME</code>."}],"tags":[],"owner":{"account_id":1026421,"reputation":6747,"user_id":1035634,"display_name":"Ondrej Burkert"},"comment_count":7,"down_vote_count":0,"up_vote_count":89,"is_accepted":false,"score":89,"last_activity_date":1641060053,"creation_date":1455730034,"answer_id":35463606,"question_id":19654557,"body_markdown":"I just recently, after seven long years with Maven, learned about toolchains.xml. Maven has it even documented and supports it from 2.0.9 - [toolchains documentation][1] \r\n\r\nSo I added a toolchains.xml file to my ~/.m2/ folder with following content:\r\n\r\n&lt;!-- begin snippet: xml hide: false --&gt;\r\n\r\n&lt;!-- language: lang-xml --&gt;\r\n\r\n    &lt;toolchains xmlns=&quot;http://maven.apache.org/TOOLCHAINS/1.1.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n     xsi:schemaLocation=&quot;http://maven.apache.org/TOOLCHAINS/1.1.0 http://maven.apache.org/xsd/toolchains-1.1.0.xsd&quot;&gt;\r\n     &lt;!-- JDK toolchains --&gt;\r\n     &lt;toolchain&gt;\r\n       &lt;type&gt;jdk&lt;/type&gt;\r\n       &lt;provides&gt;\r\n         &lt;version&gt;1.8&lt;/version&gt;\r\n         &lt;vendor&gt;sun&lt;/vendor&gt;\r\n       &lt;/provides&gt;\r\n       &lt;configuration&gt;\r\n         &lt;jdkHome&gt;/opt/java8&lt;/jdkHome&gt;\r\n       &lt;/configuration&gt;\r\n     &lt;/toolchain&gt;\r\n     &lt;toolchain&gt;\r\n       &lt;type&gt;jdk&lt;/type&gt;\r\n       &lt;provides&gt;\r\n         &lt;version&gt;1.7&lt;/version&gt;\r\n         &lt;vendor&gt;sun&lt;/vendor&gt;\r\n       &lt;/provides&gt;\r\n       &lt;configuration&gt;\r\n         &lt;jdkHome&gt;/opt/java7&lt;/jdkHome&gt;\r\n       &lt;/configuration&gt;\r\n     &lt;/toolchain&gt;\r\n    &lt;/toolchains&gt;\r\n\r\n&lt;!-- end snippet --&gt;\r\n\r\nIt allows you to define what different JDKs Maven can use to build the project irrespective of the JDK Maven runs with. Sort of like when you define JDK on project level in IDE.\r\n\r\n\r\n  [1]: https://maven.apache.org/guides/mini/guide-using-toolchains.html","title":"How to set specific Java version to Maven?","body":"<p>I just recently, after seven long years with Maven, learned about toolchains.xml. Maven has it even documented and supports it from 2.0.9 - <a href=\"https://maven.apache.org/guides/mini/guide-using-toolchains.html\" rel=\"noreferrer\">toolchains documentation</a></p>\n<p>So I added a toolchains.xml file to my ~/.m2/ folder with following content:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;toolchains xmlns=&quot;http://maven.apache.org/TOOLCHAINS/1.1.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n xsi:schemaLocation=&quot;http://maven.apache.org/TOOLCHAINS/1.1.0 http://maven.apache.org/xsd/toolchains-1.1.0.xsd&quot;&gt;\n &lt;!-- JDK toolchains --&gt;\n &lt;toolchain&gt;\n   &lt;type&gt;jdk&lt;/type&gt;\n   &lt;provides&gt;\n     &lt;version&gt;1.8&lt;/version&gt;\n     &lt;vendor&gt;sun&lt;/vendor&gt;\n   &lt;/provides&gt;\n   &lt;configuration&gt;\n     &lt;jdkHome&gt;/opt/java8&lt;/jdkHome&gt;\n   &lt;/configuration&gt;\n &lt;/toolchain&gt;\n &lt;toolchain&gt;\n   &lt;type&gt;jdk&lt;/type&gt;\n   &lt;provides&gt;\n     &lt;version&gt;1.7&lt;/version&gt;\n     &lt;vendor&gt;sun&lt;/vendor&gt;\n   &lt;/provides&gt;\n   &lt;configuration&gt;\n     &lt;jdkHome&gt;/opt/java7&lt;/jdkHome&gt;\n   &lt;/configuration&gt;\n &lt;/toolchain&gt;\n&lt;/toolchains&gt;\n</code></pre>\n<p>It allows you to define what different JDKs Maven can use to build the project irrespective of the JDK Maven runs with. Sort of like when you define JDK on project level in IDE.</p>\n"},{"tags":[],"owner":{"account_id":2387357,"reputation":1147,"user_id":2088039,"display_name":"Tonino"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1486027522,"creation_date":1486027522,"answer_id":41998416,"question_id":19654557,"body_markdown":"To avoid any impact to your project and to your Environment Variables, you can configure the Maven Compiler Plugin just to the project&#39;s POM, specifying the Source and Target java version \r\n\r\n      &lt;plugins&gt;\r\n        &lt;plugin&gt;\r\n    \t\t&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n    \t\t&lt;version&gt;3.5.1&lt;/version&gt;\r\n    \t\t&lt;configuration&gt;\r\n    \t\t\t&lt;source&gt;1.7&lt;/source&gt;\r\n    \t\t\t&lt;target&gt;1.7&lt;/target&gt;\r\n    \t\t&lt;/configuration&gt;\r\n    \t&lt;/plugin&gt;\r\n        ...\r\n      &lt;/plugins&gt;","title":"How to set specific Java version to Maven?","body":"<p>To avoid any impact to your project and to your Environment Variables, you can configure the Maven Compiler Plugin just to the project's POM, specifying the Source and Target java version </p>\n\n<pre><code>  &lt;plugins&gt;\n    &lt;plugin&gt;\n        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n        &lt;version&gt;3.5.1&lt;/version&gt;\n        &lt;configuration&gt;\n            &lt;source&gt;1.7&lt;/source&gt;\n            &lt;target&gt;1.7&lt;/target&gt;\n        &lt;/configuration&gt;\n    &lt;/plugin&gt;\n    ...\n  &lt;/plugins&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4458846,"reputation":362,"user_id":3628314,"display_name":"Pankaj"},"comment_count":0,"down_vote_count":0,"up_vote_count":11,"is_accepted":false,"score":11,"last_activity_date":1488543785,"creation_date":1488543785,"answer_id":42578812,"question_id":19654557,"body_markdown":"One simple solution to the problem -\r\n\r\n&gt; JAVA_HOME=/usr/lib/jvm/java-6-sun/ mvn clean install\r\n\r\nOn Mac, it would look something like - \r\n\r\n&gt;JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.7.0_21.jdk/Contents/Home/  mvn clean install\r\n\r\nPS: One special case that i found is the above given command does not work on &#39;fish&#39; shell. I also had bash shell available and it worked fine there. just use command &#39;bash&#39; to switch to bash shell.","title":"How to set specific Java version to Maven?","body":"<p>One simple solution to the problem -</p>\n\n<blockquote>\n  <p>JAVA_HOME=/usr/lib/jvm/java-6-sun/ mvn clean install</p>\n</blockquote>\n\n<p>On Mac, it would look something like - </p>\n\n<blockquote>\n  <p>JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.7.0_21.jdk/Contents/Home/  mvn clean install</p>\n</blockquote>\n\n<p>PS: One special case that i found is the above given command does not work on 'fish' shell. I also had bash shell available and it worked fine there. just use command 'bash' to switch to bash shell.</p>\n"},{"comments":[{"owner":{"account_id":34561,"reputation":8464,"user_id":97745,"accept_rate":86,"display_name":"crowne"},"score":12,"creation_date":1505336334,"post_id":43122361,"comment_id":79376831,"body_markdown":"As of compiler-plugin version 3.7.0, the default values for source and target if left unspecified is 1.5","body":"As of compiler-plugin version 3.7.0, the default values for source and target if left unspecified is 1.5"},{"owner":{"account_id":8906759,"reputation":2159,"user_id":6648326,"accept_rate":71,"display_name":"MasterJoe"},"score":3,"creation_date":1596650044,"post_id":43122361,"comment_id":111882282,"body_markdown":"Can you use version 9, 10 11 instead of 1.X for those versions ?","body":"Can you use version 9, 10 11 instead of 1.X for those versions ?"},{"owner":{"account_id":8566752,"reputation":53339,"user_id":6419007,"accept_rate":67,"display_name":"Eric Duminil"},"score":1,"creation_date":1615218901,"post_id":43122361,"comment_id":117617152,"body_markdown":"Somehow, with Java 15 and Maven 3.6.0, I get a `package javax.xml.bind.annotation does not exist` error when I try to compile a Java 8 project, even after adding the properties you mentioned. If I set `JAVA_HOME` to the java8 folder, `mvn` works fine again.","body":"Somehow, with Java 15 and Maven 3.6.0, I get a <code>package javax.xml.bind.annotation does not exist</code> error when I try to compile a Java 8 project, even after adding the properties you mentioned. If I set <code>JAVA_HOME</code> to the java8 folder, <code>mvn</code> works fine again."},{"owner":{"account_id":434060,"reputation":654,"user_id":2708444,"display_name":"vbg"},"score":0,"creation_date":1667246773,"post_id":43122361,"comment_id":131120646,"body_markdown":"Your code won&#39;t work id JAVA_HOME=&lt;path to JDK 1.6&gt;. See the answer from @ondrej-burkert below about Toolchains plugin which helps in such cases.","body":"Your code won&#39;t work id JAVA_HOME=&lt;path to JDK 1.6&gt;. See the answer from @ondrej-burkert below about Toolchains plugin which helps in such cases."}],"tags":[],"owner":{"account_id":39793,"reputation":2684,"user_id":114944,"display_name":"Edward Ross"},"comment_count":4,"down_vote_count":2,"up_vote_count":101,"is_accepted":false,"score":99,"last_activity_date":1490888298,"creation_date":1490888298,"answer_id":43122361,"question_id":19654557,"body_markdown":"In the POM, you can set the compiler properties, e.g. for 1.8:\r\n\r\n    &lt;project&gt;\r\n    ...\r\n     &lt;properties&gt;\r\n        &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;\r\n        &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;\r\n      &lt;/properties&gt;\r\n    ...\r\n    &lt;/project&gt;","title":"How to set specific Java version to Maven?","body":"<p>In the POM, you can set the compiler properties, e.g. for 1.8:</p>\n\n<pre><code>&lt;project&gt;\n...\n &lt;properties&gt;\n    &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;\n    &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;\n  &lt;/properties&gt;\n...\n&lt;/project&gt;\n</code></pre>\n"},{"comments":[{"owner":{"account_id":104635,"reputation":10035,"user_id":279623,"accept_rate":82,"display_name":"Tomislav Nakic-Alfirevic"},"score":2,"creation_date":1547741958,"post_id":43524685,"comment_id":95304720,"body_markdown":"Unless you need maven 2 and 3 for various projects, in which case you already have `mvn2` and `mvn3` defined and the naming gets a bit funky when Java versions also come into play... :D","body":"Unless you need maven 2 and 3 for various projects, in which case you already have <code>mvn2</code> and <code>mvn3</code> defined and the naming gets a bit funky when Java versions also come into play... :D"},{"owner":{"account_id":264140,"reputation":2122,"user_id":550208,"accept_rate":75,"display_name":"ptkvsk"},"score":5,"creation_date":1555507621,"post_id":43524685,"comment_id":98136207,"body_markdown":"If you&#39;re using a Mac, your JDK comes with java_home command so you can avoid hardcoding paths, e.g. ```alias mvn8 = &quot;JAVA_HOME=`/usr/libexec/java_home -v 1.8` &amp;&amp; mvn```","body":"If you&#39;re using a Mac, your JDK comes with java_home command so you can avoid hardcoding paths, e.g. <code>alias mvn8 = &quot;JAVA_HOME=`&#47;usr&#47;libexec&#47;java_home -v 1.8` &amp;&amp; mvn</code>"},{"owner":{"account_id":11040,"reputation":6760,"user_id":21132,"accept_rate":89,"display_name":"Fabien"},"score":15,"creation_date":1562595560,"post_id":43524685,"comment_id":100414095,"body_markdown":"On (ubuntu + bash), you have to omit the `&amp;&amp;` before `mvn`. mvn does not see JAVA_HOME&#39;s value with `&amp;&amp;`.","body":"On (ubuntu + bash), you have to omit the <code>&amp;&amp;</code> before <code>mvn</code>. mvn does not see JAVA_HOME&#39;s value with <code>&amp;&amp;</code>."},{"owner":{"account_id":2772116,"reputation":2797,"user_id":2386514,"accept_rate":100,"display_name":"Jonathan E. Landrum"},"score":0,"creation_date":1562605344,"post_id":43524685,"comment_id":100419244,"body_markdown":"@Fabien good to know; I use ZSH and didn&#39;t know about the Bash differences","body":"@Fabien good to know; I use ZSH and didn&#39;t know about the Bash differences"},{"owner":{"account_id":2772116,"reputation":2797,"user_id":2386514,"accept_rate":100,"display_name":"Jonathan E. Landrum"},"score":1,"creation_date":1629981701,"post_id":43524685,"comment_id":121834753,"body_markdown":"@acabra85 see this answer from Ondrej that is even better: https://stackoverflow.com/a/35463606/2386514","body":"@acabra85 see this answer from Ondrej that is even better: <a href=\"https://stackoverflow.com/a/35463606/2386514\">stackoverflow.com/a/35463606/2386514</a>"},{"owner":{"account_id":151653,"reputation":1689,"user_id":365675,"accept_rate":48,"display_name":"yetanothercoder"},"score":1,"creation_date":1634040584,"post_id":43524685,"comment_id":122914737,"body_markdown":"@Fabien with `&amp;&amp;` that just worked fine for me now on Ubuntu 20 and default bash","body":"@Fabien with <code>&amp;&amp;</code> that just worked fine for me now on Ubuntu 20 and default bash"},{"owner":{"account_id":151394,"reputation":52351,"user_id":365237,"accept_rate":96,"display_name":"eis"},"score":3,"creation_date":1641062552,"post_id":43524685,"comment_id":124714665,"body_markdown":"I don&#39;t think toolchains answer is always better. It requires fiddling with project pom which you might not want to do if you have a lot of and/or complex maven projects. This achieves the same without the need to touch poms.","body":"I don&#39;t think toolchains answer is always better. It requires fiddling with project pom which you might not want to do if you have a lot of and/or complex maven projects. This achieves the same without the need to touch poms."}],"tags":[],"owner":{"account_id":2772116,"reputation":2797,"user_id":2386514,"accept_rate":100,"display_name":"Jonathan E. Landrum"},"comment_count":7,"down_vote_count":1,"up_vote_count":129,"is_accepted":false,"score":128,"last_activity_date":1634045283,"creation_date":1492704562,"answer_id":43524685,"question_id":19654557,"body_markdown":"## Edit:\r\n\r\nA better solution is presented by the answer from [Ondrej][1], which obviates remembering aliases.\r\n\r\n---\r\n\r\n## Original Answer:\r\n\r\n**Adding a solution for people with multiple Java versions installed**\r\n\r\nWe have a large codebase, most of which is in Java. The majority of what I work on is written in either Java 1.7 or 1.8. Since `JAVA_HOME` is static, I created aliases in my `.bashrc` for running Maven with different values:\r\n\r\n    alias mvn5=&quot;JAVA_HOME=/usr/local/java5 &amp;&amp; mvn&quot;\r\n    alias mvn6=&quot;JAVA_HOME=/usr/local/java6 &amp;&amp; mvn&quot;\r\n    alias mvn7=&quot;JAVA_HOME=/usr/local/java7 &amp;&amp; mvn&quot;\r\n    alias mvn8=&quot;JAVA_HOME=/usr/local/java8 &amp;&amp; mvn&quot;\r\n\r\nThis lets me run Maven from the command line on my development machine regardless of the JDK version used on the project.\r\n\r\n\r\n  [1]: https://stackoverflow.com/a/35463606/2386514","title":"How to set specific Java version to Maven?","body":"<h2>Edit:</h2>\n<p>A better solution is presented by the answer from <a href=\"https://stackoverflow.com/a/35463606/2386514\">Ondrej</a>, which obviates remembering aliases.</p>\n<hr />\n<h2>Original Answer:</h2>\n<p><strong>Adding a solution for people with multiple Java versions installed</strong></p>\n<p>We have a large codebase, most of which is in Java. The majority of what I work on is written in either Java 1.7 or 1.8. Since <code>JAVA_HOME</code> is static, I created aliases in my <code>.bashrc</code> for running Maven with different values:</p>\n<pre><code>alias mvn5=&quot;JAVA_HOME=/usr/local/java5 &amp;&amp; mvn&quot;\nalias mvn6=&quot;JAVA_HOME=/usr/local/java6 &amp;&amp; mvn&quot;\nalias mvn7=&quot;JAVA_HOME=/usr/local/java7 &amp;&amp; mvn&quot;\nalias mvn8=&quot;JAVA_HOME=/usr/local/java8 &amp;&amp; mvn&quot;\n</code></pre>\n<p>This lets me run Maven from the command line on my development machine regardless of the JDK version used on the project.</p>\n"},{"tags":[],"owner":{"account_id":1931337,"reputation":2684,"user_id":1740662,"display_name":"Bernhard Thalmayr"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1542808086,"creation_date":1542808086,"answer_id":53413525,"question_id":19654557,"body_markdown":"On Linux/Unix, the JAVA_HOME within &#39;mvn&#39; shell script is overridden by the settings in\r\n\r\n    $HOME/.mavenrc\r\n\r\nplease https://stackoverflow.com/questions/37905648/where-to-add-java-home-and-maven-path-variables-in-linux","title":"How to set specific Java version to Maven?","body":"<p>On Linux/Unix, the JAVA_HOME within 'mvn' shell script is overridden by the settings in</p>\n\n<pre><code>$HOME/.mavenrc\n</code></pre>\n\n<p>please <a href=\"https://stackoverflow.com/questions/37905648/where-to-add-java-home-and-maven-path-variables-in-linux\">Where to add JAVA_HOME and MAVEN path variables in linux</a></p>\n"},{"tags":[],"owner":{"account_id":3268713,"reputation":1019,"user_id":2752595,"display_name":"Alberto Perez"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1544697239,"creation_date":1544697239,"answer_id":53759859,"question_id":19654557,"body_markdown":"Also you can have **two** versions of maven installed, and edit **one** of them, editing here:\r\n\r\n&gt;  mvn(non-windows)/mvn.bat/mvn.cmd(windows) \r\n\r\nreplacing your %java_home% appearances to your java desired path. Then just execute maven from that modified path\r\n","title":"How to set specific Java version to Maven?","body":"<p>Also you can have <strong>two</strong> versions of maven installed, and edit <strong>one</strong> of them, editing here:</p>\n\n<blockquote>\n  <p>mvn(non-windows)/mvn.bat/mvn.cmd(windows) </p>\n</blockquote>\n\n<p>replacing your %java_home% appearances to your java desired path. Then just execute maven from that modified path</p>\n"},{"tags":[],"owner":{"account_id":1270164,"reputation":1062,"user_id":1226669,"display_name":"Martin Vich"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1548944421,"creation_date":1548944421,"answer_id":54462589,"question_id":19654557,"body_markdown":"I did not have success on mac with just setting `JAVA_HOME` in the console but I was successful with this approach\r\n\r\n - Create .mavenrc file at your at your home directory  (so the file will path will be `~/.mavenrc`\r\n - Into that file paste `export JAVA_HOME=$(/usr/libexec/java_home -v 1.7)`","title":"How to set specific Java version to Maven?","body":"<p>I did not have success on mac with just setting <code>JAVA_HOME</code> in the console but I was successful with this approach</p>\n\n<ul>\n<li>Create .mavenrc file at your at your home directory  (so the file will path will be <code>~/.mavenrc</code></li>\n<li>Into that file paste <code>export JAVA_HOME=$(/usr/libexec/java_home -v 1.7)</code></li>\n</ul>\n"},{"tags":[],"owner":{"account_id":6615217,"reputation":6130,"user_id":5108737,"display_name":"Ruslan"},"comment_count":0,"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1553983055,"creation_date":1553983055,"answer_id":55435998,"question_id":19654557,"body_markdown":"You could configure [compiling sources using different JDK](https://maven.apache.org/plugins/maven-compiler-plugin/examples/compile-using-different-jdk.html) with `maven-compiler-plugin`. \r\n\r\nJust specify path to `javac` in `&lt;executable&gt;` tag. E.g for java11 it looks like:\r\n\r\n    &lt;plugin&gt;\r\n        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n        &lt;version&gt;3.8.0&lt;/version&gt;\r\n        &lt;configuration&gt;\r\n            &lt;source&gt;11&lt;/source&gt;\r\n            &lt;target&gt;11&lt;/target&gt;\r\n            &lt;fork&gt;true&lt;/fork&gt;\r\n            &lt;executable&gt;C:\\Program Files\\Java\\jdk-11.0.1\\bin\\javac&lt;/executable&gt; &lt;!--PATH TO JAVAC --&gt;\r\n        &lt;/configuration&gt;\r\n    &lt;/plugin&gt;","title":"How to set specific Java version to Maven?","body":"<p>You could configure <a href=\"https://maven.apache.org/plugins/maven-compiler-plugin/examples/compile-using-different-jdk.html\" rel=\"noreferrer\">compiling sources using different JDK</a> with <code>maven-compiler-plugin</code>. </p>\n\n<p>Just specify path to <code>javac</code> in <code>&lt;executable&gt;</code> tag. E.g for java11 it looks like:</p>\n\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n    &lt;version&gt;3.8.0&lt;/version&gt;\n    &lt;configuration&gt;\n        &lt;source&gt;11&lt;/source&gt;\n        &lt;target&gt;11&lt;/target&gt;\n        &lt;fork&gt;true&lt;/fork&gt;\n        &lt;executable&gt;C:\\Program Files\\Java\\jdk-11.0.1\\bin\\javac&lt;/executable&gt; &lt;!--PATH TO JAVAC --&gt;\n    &lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre>\n"},{"comments":[{"owner":{"account_id":4904985,"reputation":388,"user_id":3951955,"accept_rate":100,"display_name":"Jesse Zhuang"},"score":1,"creation_date":1567493929,"post_id":56487374,"comment_id":101968293,"body_markdown":"like this option. jenv is like virtualenv for python","body":"like this option. jenv is like virtualenv for python"}],"tags":[],"owner":{"account_id":1608089,"reputation":773,"user_id":1487721,"display_name":"Ranuka"},"comment_count":1,"down_vote_count":0,"up_vote_count":12,"is_accepted":false,"score":12,"last_activity_date":1560257445,"creation_date":1559875555,"answer_id":56487374,"question_id":19654557,"body_markdown":"You can set Maven to use any java version following the instructions below.\r\n\r\nInstall jenv in your machine [link][1]\r\n\r\n  [1]: https://www.jenv.be/\r\n\r\nCheck the available java versions installed in your machine by issuing the following command in command line.\r\n\r\n&gt; jenv versions\r\n\r\nYou can specify global Java version using the following command.\r\n\r\n&gt; jenv global oracle64-1.6.0.39\r\n\r\nYou can specify local Java version for any directory(Project) using the following command in the directory in command line.\r\n\r\n&gt; jenv local oracle64-1.7.0.11\r\n\r\nadd the correct java version in your pom.xml\r\n\r\nif you are running maven in command line install **jenv maven plugin** using below command\r\n&gt; jenv enable-plugin maven\r\n\r\nNow you can configure any java version in your machine to any project with out any trouble.\r\n\r\n","title":"How to set specific Java version to Maven?","body":"<p>You can set Maven to use any java version following the instructions below.</p>\n\n<p>Install jenv in your machine <a href=\"https://www.jenv.be/\" rel=\"noreferrer\">link</a></p>\n\n<p>Check the available java versions installed in your machine by issuing the following command in command line.</p>\n\n<blockquote>\n  <p>jenv versions</p>\n</blockquote>\n\n<p>You can specify global Java version using the following command.</p>\n\n<blockquote>\n  <p>jenv global oracle64-1.6.0.39</p>\n</blockquote>\n\n<p>You can specify local Java version for any directory(Project) using the following command in the directory in command line.</p>\n\n<blockquote>\n  <p>jenv local oracle64-1.7.0.11</p>\n</blockquote>\n\n<p>add the correct java version in your pom.xml</p>\n\n<p>if you are running maven in command line install <strong>jenv maven plugin</strong> using below command</p>\n\n<blockquote>\n  <p>jenv enable-plugin maven</p>\n</blockquote>\n\n<p>Now you can configure any java version in your machine to any project with out any trouble.</p>\n"},{"comments":[{"owner":{"account_id":1310803,"reputation":2557,"user_id":1258838,"accept_rate":68,"display_name":"Juliyanage Silva"},"score":0,"creation_date":1613571868,"post_id":56882212,"comment_id":117115684,"body_markdown":"this is cleaner cz we know what version we run!","body":"this is cleaner cz we know what version we run!"},{"owner":{"account_id":4686541,"reputation":709,"user_id":3793824,"display_name":"Krzysztof"},"score":0,"creation_date":1634217023,"post_id":56882212,"comment_id":122969582,"body_markdown":"For setting path, you should use bin subfolder:\nset &quot;path=%JAVA_HOME%\\bin;%path%&quot;","body":"For setting path, you should use bin subfolder: set &quot;path=%JAVA_HOME%\\bin;%path%&quot;"}],"tags":[],"owner":{"account_id":13728241,"reputation":116,"user_id":9906396,"display_name":"Talis Guo"},"comment_count":2,"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1562226109,"creation_date":1562223390,"answer_id":56882212,"question_id":19654557,"body_markdown":"On windows, I just add multiple batch files for different JDK versions to the Maven bin folder like this: \r\n\r\nmvn11.cmd\r\n```cmd\r\n@echo off\r\nsetlocal\r\nset &quot;JAVA_HOME=path\\to\\jdk11&quot;\r\nset &quot;path=%JAVA_HOME%;%path%&quot;\r\nmvn %*\r\n```\r\nthen you can use ```mvn11``` to run Maven in the specified JDK.","title":"How to set specific Java version to Maven?","body":"<p>On windows, I just add multiple batch files for different JDK versions to the Maven bin folder like this: </p>\n\n<p>mvn11.cmd</p>\n\n<pre><code>@echo off\nsetlocal\nset \"JAVA_HOME=path\\to\\jdk11\"\nset \"path=%JAVA_HOME%;%path%\"\nmvn %*\n</code></pre>\n\n<p>then you can use <code>mvn11</code> to run Maven in the specified JDK.</p>\n"},{"tags":[],"owner":{"account_id":2885397,"reputation":155,"user_id":2475448,"display_name":"user2475448"},"comment_count":0,"down_vote_count":0,"up_vote_count":10,"is_accepted":false,"score":10,"last_activity_date":1566317864,"creation_date":1566317864,"answer_id":57577779,"question_id":19654557,"body_markdown":"On Macs, (assuming you have the right version installed) \r\n\r\n```JAVA_HOME=`/usr/libexec/java_home -v 1.8` mvn clean install -DskipTests```","title":"How to set specific Java version to Maven?","body":"<p>On Macs, (assuming you have the right version installed) </p>\n\n<p><code>JAVA_HOME=`/usr/libexec/java_home -v 1.8` mvn clean install -DskipTests</code></p>\n"},{"tags":[],"owner":{"account_id":3731659,"reputation":3183,"user_id":3103802,"accept_rate":73,"display_name":"Saveendra Ekanayake"},"comment_count":0,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1571734117,"creation_date":1571734117,"answer_id":58500407,"question_id":19654557,"body_markdown":"Without changing Environment Variables, You can manage java version based on the project level by using Maven Compiler Plugin.\r\n\r\n**Method 1**\r\n\r\n    &lt;properties&gt;\r\n        &lt;maven.compiler.source&gt;1.7&lt;/maven.compiler.source&gt;\r\n        &lt;maven.compiler.target&gt;1.7&lt;/maven.compiler.target&gt;\r\n    &lt;/properties&gt;\r\n    &lt;build&gt;\r\n        &lt;plugins&gt;\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\r\n            &lt;/plugin&gt;\r\n        &lt;/plugins&gt;\r\n    &lt;/build&gt;\r\n\r\n**Method 2**\r\n\r\n    &lt;build&gt;\r\n        &lt;plugins&gt;\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n                &lt;configuration&gt;\r\n                    &lt;source&gt;1.7&lt;/source&gt;\r\n                    &lt;target&gt;1.7&lt;/target&gt;\r\n                &lt;/configuration&gt;\r\n            &lt;/plugin&gt;\r\n        &lt;/plugins&gt;\r\n    &lt;/build&gt;","title":"How to set specific Java version to Maven?","body":"<p>Without changing Environment Variables, You can manage java version based on the project level by using Maven Compiler Plugin.</p>\n\n<p><strong>Method 1</strong></p>\n\n<pre><code>&lt;properties&gt;\n    &lt;maven.compiler.source&gt;1.7&lt;/maven.compiler.source&gt;\n    &lt;maven.compiler.target&gt;1.7&lt;/maven.compiler.target&gt;\n&lt;/properties&gt;\n&lt;build&gt;\n    &lt;plugins&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre>\n\n<p><strong>Method 2</strong></p>\n\n<pre><code>&lt;build&gt;\n    &lt;plugins&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n            &lt;configuration&gt;\n                &lt;source&gt;1.7&lt;/source&gt;\n                &lt;target&gt;1.7&lt;/target&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":10418328,"reputation":828,"user_id":7681696,"display_name":"GtdDev"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1602201696,"creation_date":1602201696,"answer_id":64272197,"question_id":19654557,"body_markdown":"I&#39;ve used the base idea from @Jonathan. \r\nI&#39;ve set the windows with: set JAVA_HOME=C:\\Program Files\\java\\AdoptOpenJDK-11.0.8+10\r\ncall mvn clean package -DskipTests","title":"How to set specific Java version to Maven?","body":"<p>I've used the base idea from @Jonathan.\nI've set the windows with: set JAVA_HOME=C:\\Program Files\\java\\AdoptOpenJDK-11.0.8+10\ncall mvn clean package -DskipTests</p>\n"},{"comments":[{"owner":{"account_id":5745825,"reputation":11553,"user_id":4537090,"accept_rate":79,"display_name":"WesternGun"},"score":0,"creation_date":1623336173,"post_id":66540370,"comment_id":120055839,"body_markdown":"Good approach checking the executable logic, lucky that it&#39;s a bash script. In my case it checks JAVA_HOME, if absent will be satisfied with `which java`. `which java` points me to `/usr/bin/java` which is `/etc/alternatives/java` and will update when new version is installed.","body":"Good approach checking the executable logic, lucky that it&#39;s a bash script. In my case it checks JAVA_HOME, if absent will be satisfied with <code>which java</code>. <code>which java</code> points me to <code>&#47;usr&#47;bin&#47;java</code> which is <code>&#47;etc&#47;alternatives&#47;java</code> and will update when new version is installed."}],"tags":[],"owner":{"account_id":20313790,"reputation":41,"user_id":15175895,"display_name":"new coder"},"comment_count":1,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1626801066,"creation_date":1615260339,"answer_id":66540370,"question_id":19654557,"body_markdown":"Recently installed Java10 to see whats new and fun about it. Once I did this and tried running existing projects which use java8.\r\nTo my surprise, maven began using java10 as its default java version, even though my JAVA_HOME is set to use `java8 — /usr/libexec/java_home -v 1.8`\r\n\r\nGiven, my installation was done using brew — Brew is simply a package manager for Mac OS, my M2_HOME was automatically set up. This is usually in `/usr/local/Cellar/maven/3.5.4`\r\n\r\nWith this new found knowledge, I run\r\n\r\n    nano /usr/local/Cellar/maven/3.5.4/bin/mvn\r\n\r\nThe content was\r\n\r\n    #!/bin/bash\r\n    JAVA_HOME=&quot;${JAVA_HOME:-$(/usr/libexec/java_home)}&quot; exec &quot;/usr/local/Cellar/maven/3.5.4/libexec/bin/mvn&quot; &quot;$@&quot;\r\n\r\nImportant bit being\r\n\r\n    &quot;${JAVA_HOME:-$(/usr/libexec/java_home)}&quot;\r\n\r\nTo resolve this, you will need to specify the java version you need maven to default to. So in my case, I needed java8.\r\n\r\nUpdate `/usr/local/Cellar/maven/3.5.4/bin/mvn` file as follows\r\n\r\n    #!/bin/bash\r\n    JAVA_HOME=&quot;${JAVA_HOME:-$(/usr/libexec/java_home -v 1.8)}&quot; exec &quot;/usr/local/Cellar/maven/3.5.4/libexec/bin/mvn&quot; &quot;$@&quot;\r\n\r\n","title":"How to set specific Java version to Maven?","body":"<p>Recently installed Java10 to see whats new and fun about it. Once I did this and tried running existing projects which use java8.\nTo my surprise, maven began using java10 as its default java version, even though my JAVA_HOME is set to use <code>java8 — /usr/libexec/java_home -v 1.8</code></p>\n<p>Given, my installation was done using brew — Brew is simply a package manager for Mac OS, my M2_HOME was automatically set up. This is usually in <code>/usr/local/Cellar/maven/3.5.4</code></p>\n<p>With this new found knowledge, I run</p>\n<pre><code>nano /usr/local/Cellar/maven/3.5.4/bin/mvn\n</code></pre>\n<p>The content was</p>\n<pre><code>#!/bin/bash\nJAVA_HOME=&quot;${JAVA_HOME:-$(/usr/libexec/java_home)}&quot; exec &quot;/usr/local/Cellar/maven/3.5.4/libexec/bin/mvn&quot; &quot;$@&quot;\n</code></pre>\n<p>Important bit being</p>\n<pre><code>&quot;${JAVA_HOME:-$(/usr/libexec/java_home)}&quot;\n</code></pre>\n<p>To resolve this, you will need to specify the java version you need maven to default to. So in my case, I needed java8.</p>\n<p>Update <code>/usr/local/Cellar/maven/3.5.4/bin/mvn</code> file as follows</p>\n<pre><code>#!/bin/bash\nJAVA_HOME=&quot;${JAVA_HOME:-$(/usr/libexec/java_home -v 1.8)}&quot; exec &quot;/usr/local/Cellar/maven/3.5.4/libexec/bin/mvn&quot; &quot;$@&quot;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1728290,"reputation":49,"user_id":1582473,"display_name":"Vijay Yadav"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1618249973,"creation_date":1618249973,"answer_id":67063295,"question_id":19654557,"body_markdown":"I am using jenv and was facing the compilation error for &quot;javax.xml.bind.annotation&quot; as the mvn in terminal was using openjdk 13\r\n```\r\nMaven home: /usr/local/Cellar/maven/3.6.3_1/libexec\r\nJava version: 13.0.2, vendor: N/A, runtime: /usr/local/Cellar/openjdk/13.0.2+8_2/libexec/openjdk.jdk/Contents/Home\r\n\r\n```\r\n\r\nFor me, it worked after running &#39;jenv enable-plugin maven&#39; as suggested here\r\nhttps://stackoverflow.com/a/56487374/1582473\r\n","title":"How to set specific Java version to Maven?","body":"<p>I am using jenv and was facing the compilation error for &quot;javax.xml.bind.annotation&quot; as the mvn in terminal was using openjdk 13</p>\n<pre><code>Maven home: /usr/local/Cellar/maven/3.6.3_1/libexec\nJava version: 13.0.2, vendor: N/A, runtime: /usr/local/Cellar/openjdk/13.0.2+8_2/libexec/openjdk.jdk/Contents/Home\n\n</code></pre>\n<p>For me, it worked after running 'jenv enable-plugin maven' as suggested here\n<a href=\"https://stackoverflow.com/a/56487374/1582473\">https://stackoverflow.com/a/56487374/1582473</a></p>\n"},{"comments":[{"owner":{"account_id":5745825,"reputation":11553,"user_id":4537090,"accept_rate":79,"display_name":"WesternGun"},"score":0,"creation_date":1623335792,"post_id":67715235,"comment_id":120055633,"body_markdown":"Well this is true and false. You can set it and it may work, but actually it can be null and you still can use Maven, it just picks up the latest version you installed, at least in my Ubuntu it&#39;s true. (`echo $JAVA_HOME` and it&#39;s empty), just as @new coder said.","body":"Well this is true and false. You can set it and it may work, but actually it can be null and you still can use Maven, it just picks up the latest version you installed, at least in my Ubuntu it&#39;s true. (<code>echo $JAVA_HOME</code> and it&#39;s empty), just as @new coder said."},{"owner":{"account_id":5483053,"reputation":406,"user_id":4358787,"display_name":"Gaurav"},"score":0,"creation_date":1657795503,"post_id":67715235,"comment_id":128897731,"body_markdown":"works flawlessly!","body":"works flawlessly!"}],"tags":[],"owner":{"account_id":16177754,"reputation":21,"user_id":11679986,"display_name":"JINSHUAI"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1623425554,"creation_date":1622085674,"answer_id":67715235,"question_id":19654557,"body_markdown":"1. on terminal `vi ~/.bash_profile`\r\n2. After that, paste the below path in the base profile file and save it by vim command `wq!`\r\n```\r\nexport JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_211.jdk/Contents/Home\r\nexport M2_HOME=/Users/mj/Tools/apache-maven-3.8.1\r\n```\r\n3. run `source ~/.bash_profile` to make it work forever\r\n\r\n4. after that, you can run `mvn -v` in your terminal to check\r\n```\r\nMaven home: /Users/mj/Tools/apache-maven-3.8.1\r\nJava version: 1.8.0_211, vendor: Oracle Corporation, \r\nruntime: /Users/mj/Tools/jdk1.8.0_211.jdk/Contents/Home/jre\r\nDefault locale: en_CN, platform encoding: UTF-8\r\nOS name: &quot;mac os x&quot;, version: &quot;10.16&quot;, arch: &quot;x86_64&quot;, family: &quot;mac&quot;\r\n```\r\n\r\nif you want to know why, read below\r\n\r\nJAVA_HOME is **used** by many Java-based applications to define the place of Java Runtime Environment (JRE) installation. \r\n**M2_HOME** is **used** by Maven, and again it tells the program where to find Maven installation. \r\n","title":"How to set specific Java version to Maven?","body":"<ol>\n<li>on terminal <code>vi ~/.bash_profile</code></li>\n<li>After that, paste the below path in the base profile file and save it by vim command <code>wq!</code></li>\n</ol>\n<pre><code>export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_211.jdk/Contents/Home\nexport M2_HOME=/Users/mj/Tools/apache-maven-3.8.1\n</code></pre>\n<ol start=\"3\">\n<li><p>run <code>source ~/.bash_profile</code> to make it work forever</p>\n</li>\n<li><p>after that, you can run <code>mvn -v</code> in your terminal to check</p>\n</li>\n</ol>\n<pre><code>Maven home: /Users/mj/Tools/apache-maven-3.8.1\nJava version: 1.8.0_211, vendor: Oracle Corporation, \nruntime: /Users/mj/Tools/jdk1.8.0_211.jdk/Contents/Home/jre\nDefault locale: en_CN, platform encoding: UTF-8\nOS name: &quot;mac os x&quot;, version: &quot;10.16&quot;, arch: &quot;x86_64&quot;, family: &quot;mac&quot;\n</code></pre>\n<p>if you want to know why, read below</p>\n<p>JAVA_HOME is <strong>used</strong> by many Java-based applications to define the place of Java Runtime Environment (JRE) installation.\n<strong>M2_HOME</strong> is <strong>used</strong> by Maven, and again it tells the program where to find Maven installation.</p>\n"},{"tags":[],"owner":{"account_id":3612269,"reputation":8554,"user_id":3013005,"accept_rate":100,"display_name":"Technotronic"},"comment_count":0,"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1633518063,"creation_date":1633516838,"answer_id":69464209,"question_id":19654557,"body_markdown":"I am using Mac and none of the answers above helped me. I found out that maven loads its own JAVA_HOME from the path specified in: `~/.mavenrc`\r\n\r\nI changed the content of the file to be: \r\n\r\n    JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_45.jdk/Contents/Home\r\n\r\nFor Linux it will look something like:\r\n\r\n    export JAVA_HOME=/usr/lib/jvm/java-8-oracle/jre","title":"How to set specific Java version to Maven?","body":"<p>I am using Mac and none of the answers above helped me. I found out that maven loads its own JAVA_HOME from the path specified in: <code>~/.mavenrc</code></p>\n<p>I changed the content of the file to be:</p>\n<pre><code>JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_45.jdk/Contents/Home\n</code></pre>\n<p>For Linux it will look something like:</p>\n<pre><code>export JAVA_HOME=/usr/lib/jvm/java-8-oracle/jre\n</code></pre>\n"},{"tags":[],"owner":{"account_id":18643295,"reputation":91,"user_id":15523520,"display_name":"Mohamed Ali"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1641975452,"creation_date":1641672805,"answer_id":70636054,"question_id":19654557,"body_markdown":"You just need to add your JAVA version to mvn file before the call of JAVA_HOME \r\nfor example my JAVA Version in .bashrc file is Java-17 \r\nand i want to run maven with Java-11 :\r\n\r\nin file `/usr/share/maven/bin/mvn` :\r\nI add :\r\n\r\n    JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64\r\n\r\nbefore the call of `JAVA_HOME` in the script\r\n\r\nand then it works fine with Java-11 :) ","title":"How to set specific Java version to Maven?","body":"<p>You just need to add your JAVA version to mvn file before the call of JAVA_HOME\nfor example my JAVA Version in .bashrc file is Java-17\nand i want to run maven with Java-11 :</p>\n<p>in file <code>/usr/share/maven/bin/mvn</code> :\nI add :</p>\n<pre><code>JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64\n</code></pre>\n<p>before the call of <code>JAVA_HOME</code> in the script</p>\n<p>and then it works fine with Java-11 :)</p>\n"},{"tags":[],"owner":{"account_id":6612592,"reputation":103,"user_id":5107086,"accept_rate":80,"display_name":"Imran AK"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1642439616,"creation_date":1642439616,"answer_id":70745107,"question_id":19654557,"body_markdown":"    set JAVA_HOME=C:\\Program Files\\Java\\jdk1.7.0_45\\jre\r\n\r\nAdding the above line of code as the first statement in `$MAVEN_HOME\\bin\\mvn.cmd` worked for me straight away in Windows 10.","title":"How to set specific Java version to Maven?","body":"<pre><code>set JAVA_HOME=C:\\Program Files\\Java\\jdk1.7.0_45\\jre\n</code></pre>\n<p>Adding the above line of code as the first statement in <code>$MAVEN_HOME\\bin\\mvn.cmd</code> worked for me straight away in Windows 10.</p>\n"},{"tags":[],"owner":{"account_id":24740428,"reputation":11,"user_id":18627239,"display_name":"Jaesung Shin"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1648609470,"creation_date":1648609470,"answer_id":71671039,"question_id":19654557,"body_markdown":"I couldn&#39;t solve this problem with the answers above and I tried many things to solve this and I got it. I hope someone like me could solve the problem.\r\n\r\nI am using brew to install java and maven.\r\nFor me, I wanted to use java 1.8. So I installed java 1.8\r\nbut still maven use version 17.0.2\r\n\r\n**Solution:** \\\r\ninstall java 1.8\r\nI referred to this website to install it: https://devqa.io/brew-install-java/\r\n\r\n`mvn --version` and remember the version \\\r\n\r\n    cat /usr/local/Cellar/maven/VERSION(for me 3.8.5)/bin/mvn\r\n\r\nThen you will see\r\n\r\n    #!/bin/bash\r\n    JAVA_HOME=&quot;${JAVA_HOME:-/usr/local/opt/openjdk/libexec/openjdk.jdk/Contents/Home}&quot; exec &quot;/usr/local/Cellar/maven/3.8.5/libexec/bin/mvn&quot;  &quot;$@&quot;\\\r\n\r\nCheck this directory\r\n\r\n    ls /usr/local/opt\r\n\r\nYou will see files like openjdk, openjdk@17, openjdk@8\r\n\r\nchange the directory openjdk to openjdk@8 in mvn file:\r\n\r\n    #!/bin/bash\r\n    JAVA_HOME=&quot;${JAVA_HOME:-/usr/local/opt/openjdk@8/libexec/openjdk.jdk/Contents/Home}&quot; exec &quot;/usr/local/Cellar/maven/3.8.5/libexec/bin/mvn&quot;  &quot;$@&quot;\\\r\n\r\n\r\n\r\n\r\n","title":"How to set specific Java version to Maven?","body":"<p>I couldn't solve this problem with the answers above and I tried many things to solve this and I got it. I hope someone like me could solve the problem.</p>\n<p>I am using brew to install java and maven.\nFor me, I wanted to use java 1.8. So I installed java 1.8\nbut still maven use version 17.0.2</p>\n<p><strong>Solution:</strong> <br />\ninstall java 1.8\nI referred to this website to install it: <a href=\"https://devqa.io/brew-install-java/\" rel=\"nofollow noreferrer\">https://devqa.io/brew-install-java/</a></p>\n<p><code>mvn --version</code> and remember the version \\</p>\n<pre><code>cat /usr/local/Cellar/maven/VERSION(for me 3.8.5)/bin/mvn\n</code></pre>\n<p>Then you will see</p>\n<pre><code>#!/bin/bash\nJAVA_HOME=&quot;${JAVA_HOME:-/usr/local/opt/openjdk/libexec/openjdk.jdk/Contents/Home}&quot; exec &quot;/usr/local/Cellar/maven/3.8.5/libexec/bin/mvn&quot;  &quot;$@&quot;\\\n</code></pre>\n<p>Check this directory</p>\n<pre><code>ls /usr/local/opt\n</code></pre>\n<p>You will see files like openjdk, openjdk@17, openjdk@8</p>\n<p>change the directory openjdk to openjdk@8 in mvn file:</p>\n<pre><code>#!/bin/bash\nJAVA_HOME=&quot;${JAVA_HOME:-/usr/local/opt/openjdk@8/libexec/openjdk.jdk/Contents/Home}&quot; exec &quot;/usr/local/Cellar/maven/3.8.5/libexec/bin/mvn&quot;  &quot;$@&quot;\\\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2553856,"reputation":121,"user_id":2216296,"display_name":"mikaelovi"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1649317398,"creation_date":1649317398,"answer_id":71778170,"question_id":19654557,"body_markdown":"[Ondrej&#39;s answer][1]\r\nworked perfectly. It truly solves the problem. Few other things to do though as detailed in the [toolchain documentation][2]\r\n\r\n\r\n \r\n\r\n 1. Add the maven-toolchains-plugin in your project POM\r\n 2. Configure the maven-toolchains-plugin to use a specific JDK in the toolchain as configured in your toolchains.xml file. \r\n\r\nSee sample configurations below:\r\n\r\ntoolchains.xml\r\n\r\n\r\n    &lt;toolchains xmlns=&quot;http://maven.apache.org/TOOLCHAINS/1.1.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/TOOLCHAINS/1.1.0 http://maven.apache.org/xsd/toolchains-1.1.0.xsd&quot;&gt;\r\n      &lt;!-- JDK toolchains --&gt;\r\n      &lt;toolchain&gt;\r\n        &lt;type&gt;jdk&lt;/type&gt;\r\n        &lt;provides&gt;\r\n          &lt;version&gt;1.8&lt;/version&gt;\r\n          &lt;vendor&gt;sun&lt;/vendor&gt;\r\n        &lt;/provides&gt;\r\n        &lt;configuration&gt;\r\n          &lt;jdkHome&gt;/Library/Java/JavaVirtualMachines/jdk1.8.0_301.jdk/Contents/Home&lt;/jdkHome&gt;\r\n        &lt;/configuration&gt;\r\n      &lt;/toolchain&gt;\r\n      &lt;toolchain&gt;\r\n        &lt;type&gt;jdk&lt;/type&gt;\r\n        &lt;provides&gt;\r\n          &lt;version&gt;17&lt;/version&gt;\r\n          &lt;vendor&gt;sun&lt;/vendor&gt;\r\n        &lt;/provides&gt;\r\n        &lt;configuration&gt;\r\n          &lt;jdkHome&gt;/Library/Java/JavaVirtualMachines/jdk-17.0.2.jdk/Contents/Home&lt;/jdkHome&gt;\r\n        &lt;/configuration&gt;\r\n      &lt;/toolchain&gt;\r\n      &lt;toolchain&gt;\r\n        &lt;type&gt;jdk&lt;/type&gt;\r\n        &lt;provides&gt;\r\n          &lt;version&gt;11&lt;/version&gt;\r\n          &lt;vendor&gt;sun&lt;/vendor&gt;\r\n        &lt;/provides&gt;\r\n        &lt;configuration&gt;\r\n          &lt;jdkHome&gt;/Library/Java/JavaVirtualMachines/jdk-11.0.12.jdk/Contents/Home&lt;/jdkHome&gt;\r\n        &lt;/configuration&gt;\r\n      &lt;/toolchain&gt;\r\n    &lt;/toolchains&gt;\r\n\r\nAs seen above, this works for machines having multiple java versions installed.\r\nThen in the project&#39;s POM, the maven-toolchains-plugin is configured to use one of the JDK versions defined as a toolchain.\r\n\r\n    &lt;plugin&gt;\r\n      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n      &lt;artifactId&gt;maven-toolchains-plugin&lt;/artifactId&gt;\r\n      &lt;executions&gt;\r\n        &lt;execution&gt;\r\n          &lt;goals&gt;\r\n            &lt;goal&gt;toolchain&lt;/goal&gt;\r\n          &lt;/goals&gt;\r\n        &lt;/execution&gt;\r\n      &lt;/executions&gt;\r\n      &lt;configuration&gt;\r\n        &lt;toolchains&gt;\r\n          &lt;jdk&gt;\r\n            &lt;version&gt;11&lt;/version&gt;\r\n            &lt;vendor&gt;sun&lt;/vendor&gt;\r\n          &lt;/jdk&gt;\r\n        &lt;/toolchains&gt;\r\n      &lt;/configuration&gt;\r\n    &lt;/plugin&gt;\r\n\r\n\r\n  [1]: https://stackoverflow.com/a/35463606/2216296\r\n  [2]: https://maven.apache.org/guides/mini/guide-using-toolchains.html#using-toolchains-in-your-project","title":"How to set specific Java version to Maven?","body":"<p><a href=\"https://stackoverflow.com/a/35463606/2216296\">Ondrej's answer</a>\nworked perfectly. It truly solves the problem. Few other things to do though as detailed in the <a href=\"https://maven.apache.org/guides/mini/guide-using-toolchains.html#using-toolchains-in-your-project\" rel=\"nofollow noreferrer\">toolchain documentation</a></p>\n<ol>\n<li>Add the maven-toolchains-plugin in your project POM</li>\n<li>Configure the maven-toolchains-plugin to use a specific JDK in the toolchain as configured in your toolchains.xml file.</li>\n</ol>\n<p>See sample configurations below:</p>\n<p>toolchains.xml</p>\n<pre><code>&lt;toolchains xmlns=&quot;http://maven.apache.org/TOOLCHAINS/1.1.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/TOOLCHAINS/1.1.0 http://maven.apache.org/xsd/toolchains-1.1.0.xsd&quot;&gt;\n  &lt;!-- JDK toolchains --&gt;\n  &lt;toolchain&gt;\n    &lt;type&gt;jdk&lt;/type&gt;\n    &lt;provides&gt;\n      &lt;version&gt;1.8&lt;/version&gt;\n      &lt;vendor&gt;sun&lt;/vendor&gt;\n    &lt;/provides&gt;\n    &lt;configuration&gt;\n      &lt;jdkHome&gt;/Library/Java/JavaVirtualMachines/jdk1.8.0_301.jdk/Contents/Home&lt;/jdkHome&gt;\n    &lt;/configuration&gt;\n  &lt;/toolchain&gt;\n  &lt;toolchain&gt;\n    &lt;type&gt;jdk&lt;/type&gt;\n    &lt;provides&gt;\n      &lt;version&gt;17&lt;/version&gt;\n      &lt;vendor&gt;sun&lt;/vendor&gt;\n    &lt;/provides&gt;\n    &lt;configuration&gt;\n      &lt;jdkHome&gt;/Library/Java/JavaVirtualMachines/jdk-17.0.2.jdk/Contents/Home&lt;/jdkHome&gt;\n    &lt;/configuration&gt;\n  &lt;/toolchain&gt;\n  &lt;toolchain&gt;\n    &lt;type&gt;jdk&lt;/type&gt;\n    &lt;provides&gt;\n      &lt;version&gt;11&lt;/version&gt;\n      &lt;vendor&gt;sun&lt;/vendor&gt;\n    &lt;/provides&gt;\n    &lt;configuration&gt;\n      &lt;jdkHome&gt;/Library/Java/JavaVirtualMachines/jdk-11.0.12.jdk/Contents/Home&lt;/jdkHome&gt;\n    &lt;/configuration&gt;\n  &lt;/toolchain&gt;\n&lt;/toolchains&gt;\n</code></pre>\n<p>As seen above, this works for machines having multiple java versions installed.\nThen in the project's POM, the maven-toolchains-plugin is configured to use one of the JDK versions defined as a toolchain.</p>\n<pre><code>&lt;plugin&gt;\n  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n  &lt;artifactId&gt;maven-toolchains-plugin&lt;/artifactId&gt;\n  &lt;executions&gt;\n    &lt;execution&gt;\n      &lt;goals&gt;\n        &lt;goal&gt;toolchain&lt;/goal&gt;\n      &lt;/goals&gt;\n    &lt;/execution&gt;\n  &lt;/executions&gt;\n  &lt;configuration&gt;\n    &lt;toolchains&gt;\n      &lt;jdk&gt;\n        &lt;version&gt;11&lt;/version&gt;\n        &lt;vendor&gt;sun&lt;/vendor&gt;\n      &lt;/jdk&gt;\n    &lt;/toolchains&gt;\n  &lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":14731481,"reputation":11,"user_id":10638613,"display_name":"Aman L"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1661325276,"creation_date":1661325276,"answer_id":73468894,"question_id":19654557,"body_markdown":"Mac Users,\r\nIf you have installed maven from HomeBrew(Brew),\r\nOr even if you have installed it from elsewhere,\r\nIf you want to change the default version of the Java used by the Maven,\r\nYou can use following commands to change the version that the maven uses,\r\n\r\n    vim ~/.mavenrc\r\n\r\nIn the gui that pops up enter this and save-\r\n\r\n    JAVA_HOME=&quot;(put the Home path of your desired java version package)&quot;\r\n\r\nTo verify wether the path is changed for maven you can check using -\r\n\r\n    mvn -v","title":"How to set specific Java version to Maven?","body":"<p>Mac Users,\nIf you have installed maven from HomeBrew(Brew),\nOr even if you have installed it from elsewhere,\nIf you want to change the default version of the Java used by the Maven,\nYou can use following commands to change the version that the maven uses,</p>\n<pre><code>vim ~/.mavenrc\n</code></pre>\n<p>In the gui that pops up enter this and save-</p>\n<pre><code>JAVA_HOME=&quot;(put the Home path of your desired java version package)&quot;\n</code></pre>\n<p>To verify wether the path is changed for maven you can check using -</p>\n<pre><code>mvn -v\n</code></pre>\n"},{"tags":[],"owner":{"account_id":24874208,"reputation":101,"user_id":18748312,"display_name":"Zak_Stack"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1664449912,"creation_date":1664449912,"answer_id":73894564,"question_id":19654557,"body_markdown":"Setting the Default Java Version\r\nYou might have 2 different versions of Java on your system. To set one as the default , use the command:\r\n\r\nsudo alternatives ––config java\r\n\r\nThe system displays a list of different Java versions. If you like the default, press Enter.\r\n\r\nIf you want to change it, type the number of the version you want, then press Enter.","title":"How to set specific Java version to Maven?","body":"<p>Setting the Default Java Version\nYou might have 2 different versions of Java on your system. To set one as the default , use the command:</p>\n<p>sudo alternatives ––config java</p>\n<p>The system displays a list of different Java versions. If you like the default, press Enter.</p>\n<p>If you want to change it, type the number of the version you want, then press Enter.</p>\n"},{"tags":[],"owner":{"account_id":23085267,"reputation":41,"user_id":17196881,"display_name":"Mohan Shetty"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1675177440,"creation_date":1674948368,"answer_id":75271614,"question_id":19654557,"body_markdown":"I am using MAC Mini - M1 chip, after installing maven through brew install maven I noticed it&#39;s using java 19 but I rather wanted to use java 17 version that I downloaded in to my machine. Was out of luck with specific instructions to reset the default mvn java version. Here are the steps you can follow.\r\n1. `mvn --version` #this will give where the maven is installed\r\nin my case Maven home: `/opt/homebrew/Cellar/maven/3.8.7/libexec`\r\n2. then go to `/opt/homebrew/Cellar/maven/3.8.7/bin` folder\r\n3. edit mvn file, I used `vi mvn`\r\n4. below I have edited the jdk location to point where I have java 17 jdk\r\n```\r\n#!/bin/bash\r\nJAVA_HOME=&quot;${JAVA_HOME:-/Library/Java/JavaVirtualMachines/jdk-17.0.3.1.jdk/Contents/Home}&quot; exec &quot;/opt/homebrew/Cellar/maven/3.8.7/libexec/bin/mvn&quot;  &quot;$@&quot;\r\n```\r\n5. save the mvn file after edit\r\n6. `mvn -v` will now show it&#39;s default java version is 17\r\n```\r\nApache Maven 3.8.7 (b89d5959fcde851dcb1c8946a785a163f14e1e29)\r\nMaven home: /opt/homebrew/Cellar/maven/3.8.7/libexec\r\nJava version: 17.0.3.1, vendor: Oracle Corporation, runtime: /Library/Java/JavaVirtualMachines/jdk-17.0.3.1.jdk/Contents/Home\r\nDefault locale: en_US, platform encoding: UTF-8\r\nOS name: &quot;mac os x&quot;, version: &quot;13.1&quot;, arch: &quot;aarch64&quot;, family: &quot;mac&quot;\r\n```\r\n","title":"How to set specific Java version to Maven?","body":"<p>I am using MAC Mini - M1 chip, after installing maven through brew install maven I noticed it's using java 19 but I rather wanted to use java 17 version that I downloaded in to my machine. Was out of luck with specific instructions to reset the default mvn java version. Here are the steps you can follow.</p>\n<ol>\n<li><code>mvn --version</code> #this will give where the maven is installed\nin my case Maven home: <code>/opt/homebrew/Cellar/maven/3.8.7/libexec</code></li>\n<li>then go to <code>/opt/homebrew/Cellar/maven/3.8.7/bin</code> folder</li>\n<li>edit mvn file, I used <code>vi mvn</code></li>\n<li>below I have edited the jdk location to point where I have java 17 jdk</li>\n</ol>\n<pre><code>#!/bin/bash\nJAVA_HOME=&quot;${JAVA_HOME:-/Library/Java/JavaVirtualMachines/jdk-17.0.3.1.jdk/Contents/Home}&quot; exec &quot;/opt/homebrew/Cellar/maven/3.8.7/libexec/bin/mvn&quot;  &quot;$@&quot;\n</code></pre>\n<ol start=\"5\">\n<li>save the mvn file after edit</li>\n<li><code>mvn -v</code> will now show it's default java version is 17</li>\n</ol>\n<pre><code>Apache Maven 3.8.7 (b89d5959fcde851dcb1c8946a785a163f14e1e29)\nMaven home: /opt/homebrew/Cellar/maven/3.8.7/libexec\nJava version: 17.0.3.1, vendor: Oracle Corporation, runtime: /Library/Java/JavaVirtualMachines/jdk-17.0.3.1.jdk/Contents/Home\nDefault locale: en_US, platform encoding: UTF-8\nOS name: &quot;mac os x&quot;, version: &quot;13.1&quot;, arch: &quot;aarch64&quot;, family: &quot;mac&quot;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1548558,"reputation":1083,"user_id":1441476,"accept_rate":40,"display_name":"Homayoun Behzadian"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681064235,"creation_date":1681064235,"answer_id":75972169,"question_id":19654557,"body_markdown":"I used https://stackoverflow.com/a/43524685/1441476 and created the below functions for use with Powershell:\r\n\r\n```\r\nfunction J08 { $env:JAVA_HOME = &#39;C:\\Program Files\\Java\\jdk1.8.0_161&#39;}\r\nfunction J09 { $env:JAVA_HOME = &#39;C:\\Program Files\\Java\\jdk-9&#39;}\r\nfunction J11 { $env:JAVA_HOME = &#39;C:\\Program Files\\Java\\jdk-11.0.10&#39;}\r\nfunction J15 { $env:JAVA_HOME = &#39;C:\\Program Files\\Java\\jdk-15.0.2&#39;}\r\nfunction J16 { $env:JAVA_HOME = &#39;C:\\Program Files\\Java\\jdk-16.0.1&#39;}\r\nfunction J17 { $env:JAVA_HOME = &#39;C:\\Program Files\\Java\\jdk-17&#39;}\r\nfunction J18 { $env:JAVA_HOME = &#39;C:\\Program Files\\Java\\jdk-18.0.2&#39;}\r\nfunction J19 { $env:JAVA_HOME = &#39;C:\\Program Files\\Java\\jdk-19&#39;}\r\n```\r\nThese functions must be placed in file `C:\\Program Files\\PowerShell\\7\\profile.ps1` (or any other PowerShell profile) and be called before use. for example, if you want to use maven with Java 8, you must first call `J08`, then call `mvn ...`.\r\n\r\nI found the toolchain answer so complicated and preferred this way.","title":"How to set specific Java version to Maven?","body":"<p>I used <a href=\"https://stackoverflow.com/a/43524685/1441476\">https://stackoverflow.com/a/43524685/1441476</a> and created the below functions for use with Powershell:</p>\n<pre><code>function J08 { $env:JAVA_HOME = 'C:\\Program Files\\Java\\jdk1.8.0_161'}\nfunction J09 { $env:JAVA_HOME = 'C:\\Program Files\\Java\\jdk-9'}\nfunction J11 { $env:JAVA_HOME = 'C:\\Program Files\\Java\\jdk-11.0.10'}\nfunction J15 { $env:JAVA_HOME = 'C:\\Program Files\\Java\\jdk-15.0.2'}\nfunction J16 { $env:JAVA_HOME = 'C:\\Program Files\\Java\\jdk-16.0.1'}\nfunction J17 { $env:JAVA_HOME = 'C:\\Program Files\\Java\\jdk-17'}\nfunction J18 { $env:JAVA_HOME = 'C:\\Program Files\\Java\\jdk-18.0.2'}\nfunction J19 { $env:JAVA_HOME = 'C:\\Program Files\\Java\\jdk-19'}\n</code></pre>\n<p>These functions must be placed in file <code>C:\\Program Files\\PowerShell\\7\\profile.ps1</code> (or any other PowerShell profile) and be called before use. for example, if you want to use maven with Java 8, you must first call <code>J08</code>, then call <code>mvn ...</code>.</p>\n<p>I found the toolchain answer so complicated and preferred this way.</p>\n"}],"owner":{"account_id":1883916,"reputation":4243,"user_id":1703524,"accept_rate":68,"display_name":"andPat"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":578090,"favorite_count":0,"down_vote_count":0,"up_vote_count":305,"accepted_answer_id":19654699,"answer_count":29,"score":305,"last_activity_date":1681064235,"creation_date":1383039663,"question_id":19654557,"body_markdown":"On my machine I have two Java versions installed: (1.6 and 1.7 installed manually by me).  I need both of them for different projects. But for Maven I need 1.7, but my Maven uses the 1.6 Java version.\r\n\r\nHow can I set Maven to use 1.7?\r\n","title":"How to set specific Java version to Maven?","body":"<p>On my machine I have two Java versions installed: (1.6 and 1.7 installed manually by me).  I need both of them for different projects. But for Maven I need 1.7, but my Maven uses the 1.6 Java version.</p>\n<p>How can I set Maven to use 1.7?</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":4074999,"reputation":2882,"user_id":3346914,"display_name":"MrPk"},"score":1,"creation_date":1465288678,"post_id":37606726,"comment_id":62826160,"body_markdown":"http://stackoverflow.com/questions/16405594/what-is-this-error-java-lang-illegalstateexception-at-mediaplayer-getcurrentposi","body":"<a href=\"http://stackoverflow.com/questions/16405594/what-is-this-error-java-lang-illegalstateexception-at-mediaplayer-getcurrentposi\" title=\"what is this error java lang illegalstateexception at mediaplayer getcurrentposi\">stackoverflow.com/questions/16405594/&hellip;</a>"},{"owner":{"account_id":417862,"reputation":16982,"user_id":794088,"display_name":"petey"},"score":0,"creation_date":1465407500,"post_id":37606726,"comment_id":62892551,"body_markdown":"post the full stacktrace please","body":"post the full stacktrace please"},{"owner":{"account_id":3336007,"reputation":1549,"user_id":2803557,"accept_rate":60,"display_name":"Skyyy"},"score":0,"creation_date":1465576992,"post_id":37606726,"comment_id":62976162,"body_markdown":"@petey update question","body":"@petey update question"},{"owner":{"account_id":4206646,"reputation":1564,"user_id":3445381,"accept_rate":40,"display_name":"ikhsanudinhakim"},"score":0,"creation_date":1465803803,"post_id":37606726,"comment_id":63035198,"body_markdown":"@Akash can you share your mediaplayer initialization code?","body":"@Akash can you share your mediaplayer initialization code?"},{"owner":{"account_id":3100884,"reputation":778,"user_id":2625032,"accept_rate":62,"display_name":"hello_world"},"score":0,"creation_date":1465836073,"post_id":37606726,"comment_id":63056044,"body_markdown":"the media player can only give that error for getCurrentPosition() if it happens to be in the error state (see table here - https://developer.android.com/reference/android/media/MediaPlayer.html ) add an error listener and see if it returns any error","body":"the media player can only give that error for getCurrentPosition() if it happens to be in the error state (see table here - <a href=\"https://developer.android.com/reference/android/media/MediaPlayer.html\" rel=\"nofollow noreferrer\">developer.android.com/reference/android/media/MediaPlayer.ht&zwnj;&#8203;ml</a> ) add an error listener and see if it returns any error"},{"owner":{"account_id":4206646,"reputation":1564,"user_id":3445381,"accept_rate":40,"display_name":"ikhsanudinhakim"},"score":0,"creation_date":1465873521,"post_id":37606726,"comment_id":63069884,"body_markdown":"That&#39;s because you try to play media player after it has stopped and seems there are the wrong on initialization. So please share your full media player initialization code so we can figure out the problem.","body":"That&#39;s because you try to play media player after it has stopped and seems there are the wrong on initialization. So please share your full media player initialization code so we can figure out the problem."},{"owner":{"account_id":3336007,"reputation":1549,"user_id":2803557,"accept_rate":60,"display_name":"Skyyy"},"score":0,"creation_date":1465896073,"post_id":37606726,"comment_id":63080011,"body_markdown":"@ikhsan `mediaPlayer = MediaPlayer.create(getApplicationContext(), uri);\n        mediaPlayer.start();`","body":"@ikhsan <code>mediaPlayer = MediaPlayer.create(getApplicationContext(), uri);         mediaPlayer.start();</code>"}],"answers":[{"comments":[{"owner":{"account_id":3336007,"reputation":1549,"user_id":2803557,"accept_rate":60,"display_name":"Skyyy"},"score":0,"creation_date":1465292640,"post_id":37675207,"comment_id":62828820,"body_markdown":"Now it crash in if condition at mediaPlayer.isPlaying() with same error","body":"Now it crash in if condition at mediaPlayer.isPlaying() with same error"},{"owner":{"account_id":3251487,"reputation":3147,"user_id":2741598,"accept_rate":50,"display_name":"Vickyexpert"},"score":0,"creation_date":1465292991,"post_id":37675207,"comment_id":62829079,"body_markdown":"ok then it is confirm that as you are calling this method in thread which is not UI thread and therefore it is crashing your application, so try to write your code in UI thread or handler and it will work properly.","body":"ok then it is confirm that as you are calling this method in thread which is not UI thread and therefore it is crashing your application, so try to write your code in UI thread or handler and it will work properly."},{"owner":{"account_id":3336007,"reputation":1549,"user_id":2803557,"accept_rate":60,"display_name":"Skyyy"},"score":0,"creation_date":1465294024,"post_id":37675207,"comment_id":62829789,"body_markdown":"Do i need to start handler? This code doesn&#39;t update seekBar","body":"Do i need to start handler? This code doesn&#39;t update seekBar"},{"owner":{"account_id":3251487,"reputation":3147,"user_id":2741598,"accept_rate":50,"display_name":"Vickyexpert"},"score":0,"creation_date":1465294286,"post_id":37675207,"comment_id":62829960,"body_markdown":"Actually by handler.postDelayed() it should start and perform operation, but if it is not working then first check currentPosition value as if it is 0 then also it will not update seekbar and if it is not then you need to start it.","body":"Actually by handler.postDelayed() it should start and perform operation, but if it is not working then first check currentPosition value as if it is 0 then also it will not update seekbar and if it is not then you need to start it."},{"owner":{"account_id":3336007,"reputation":1549,"user_id":2803557,"accept_rate":60,"display_name":"Skyyy"},"score":0,"creation_date":1465324892,"post_id":37675207,"comment_id":62851039,"body_markdown":"Actually i am not able to interact with application at all once this `handler.postDelayed()` start. Shows app not responding on trying to interact with app.","body":"Actually i am not able to interact with application at all once this <code>handler.postDelayed()</code> start. Shows app not responding on trying to interact with app."}],"tags":[],"owner":{"account_id":3251487,"reputation":3147,"user_id":2741598,"accept_rate":50,"display_name":"Vickyexpert"},"comment_count":5,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1465293436,"creation_date":1465290991,"answer_id":37675207,"question_id":37606726,"body_markdown":"It may be possible, when you try to get the position of media player at that time player has stopped or released, so apply below conditions for that,\r\n\r\n         if(mediaPlayer != null &amp; mediaPlayer.isPLaying())\r\n            currentPosition = mediaPlayer.getCurrentPosition();\r\n         else \r\n            currentPosition = 0;\r\n\r\ntry below code,\r\n\r\n         handler.postDelayed(new Runnable(){\r\n            @Override\r\n            public void run() {\r\n                int runtime = mediaPlayer.getDuration();\r\n                int currentPosition = 0;\r\n                while (currentPosition &lt; runtime) {\r\n                   try {\r\n                        if(mediaPlayer != null &amp; mediaPlayer.isPLaying())\r\n                            currentPosition = mediaPlayer.getCurrentPosition();\r\n                        else \r\n                           currentPosition = 0;    \r\n                   \r\n                        if (seekBar != null) {\r\n                              seekBar.setProgress(currentPosition);\r\n                        }\r\n                    } catch (InterruptedException e) {\r\n                        e.printStackTrace();\r\n                  }\r\n              }\r\n          }, 500);","title":"java.lang.illegalStateException randomly occurs when getting mediaPlayer.getCurrentPosition","body":"<p>It may be possible, when you try to get the position of media player at that time player has stopped or released, so apply below conditions for that,</p>\n\n<pre><code>     if(mediaPlayer != null &amp; mediaPlayer.isPLaying())\n        currentPosition = mediaPlayer.getCurrentPosition();\n     else \n        currentPosition = 0;\n</code></pre>\n\n<p>try below code,</p>\n\n<pre><code>     handler.postDelayed(new Runnable(){\n        @Override\n        public void run() {\n            int runtime = mediaPlayer.getDuration();\n            int currentPosition = 0;\n            while (currentPosition &lt; runtime) {\n               try {\n                    if(mediaPlayer != null &amp; mediaPlayer.isPLaying())\n                        currentPosition = mediaPlayer.getCurrentPosition();\n                    else \n                       currentPosition = 0;    \n\n                    if (seekBar != null) {\n                          seekBar.setProgress(currentPosition);\n                    }\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n              }\n          }\n      }, 500);\n</code></pre>\n"},{"comments":[{"owner":{"account_id":3336007,"reputation":1549,"user_id":2803557,"accept_rate":60,"display_name":"Skyyy"},"score":0,"creation_date":1465292722,"post_id":37675242,"comment_id":62828889,"body_markdown":"if check if mediaPlayer.isPlaying than app crash at mediaPlayer.isPlaying. I will check Timer and TimerTask.","body":"if check if mediaPlayer.isPlaying than app crash at mediaPlayer.isPlaying. I will check Timer and TimerTask."}],"tags":[],"owner":{"account_id":84015,"reputation":10943,"user_id":235123,"accept_rate":76,"display_name":"Mina Wissa"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1465291076,"creation_date":1465291076,"answer_id":37675242,"question_id":37606726,"body_markdown":"I believe the reason for this is the **thread**.sleep() line. it causes the current thread to sleep while the media player can be actually in a stopped or released state.\r\n\r\nThe docs mention that calling **getCurrentPosition()** must happen at one of the **valid** states:\r\n\r\n&gt; {Idle, Initialized, Prepared, Started, Paused, Stopped,\r\n&gt; PlaybackCompleted}\r\n\r\nBefore calling getCurrentPosition, you can check that the media player is actually playing by checking [isPlaying()][1] value.\r\n\r\nAlso you can run your thread using a [Timer][2] and a [TimerTask][3] instead of using while loops and Thread.sleep();\r\n\r\n\r\n  [1]: https://developer.android.com/reference/android/media/MediaPlayer.html#isPlaying()\r\n  [2]: https://developer.android.com/reference/java/util/Timer.html\r\n  [3]: https://developer.android.com/reference/java/util/TimerTask.html","title":"java.lang.illegalStateException randomly occurs when getting mediaPlayer.getCurrentPosition","body":"<p>I believe the reason for this is the <strong>thread</strong>.sleep() line. it causes the current thread to sleep while the media player can be actually in a stopped or released state.</p>\n\n<p>The docs mention that calling <strong>getCurrentPosition()</strong> must happen at one of the <strong>valid</strong> states:</p>\n\n<blockquote>\n  <p>{Idle, Initialized, Prepared, Started, Paused, Stopped,\n  PlaybackCompleted}</p>\n</blockquote>\n\n<p>Before calling getCurrentPosition, you can check that the media player is actually playing by checking <a href=\"https://developer.android.com/reference/android/media/MediaPlayer.html#isPlaying()\" rel=\"nofollow\">isPlaying()</a> value.</p>\n\n<p>Also you can run your thread using a <a href=\"https://developer.android.com/reference/java/util/Timer.html\" rel=\"nofollow\">Timer</a> and a <a href=\"https://developer.android.com/reference/java/util/TimerTask.html\" rel=\"nofollow\">TimerTask</a> instead of using while loops and Thread.sleep();</p>\n"},{"comments":[{"owner":{"account_id":3336007,"reputation":1549,"user_id":2803557,"accept_rate":60,"display_name":"Skyyy"},"score":0,"creation_date":1465325003,"post_id":37682113,"comment_id":62851105,"body_markdown":"I am calling `getCurrentPosition()` method after calling `start()` method. I tried you example above i am getting same exception in catch block at `mediaPlayer.reset();`","body":"I am calling <code>getCurrentPosition()</code> method after calling <code>start()</code> method. I tried you example above i am getting same exception in catch block at <code>mediaPlayer.reset();</code>"},{"owner":{"account_id":2652155,"reputation":28560,"user_id":2293534,"accept_rate":75,"display_name":"SkyWalker"},"score":0,"creation_date":1465363969,"post_id":37682113,"comment_id":62863690,"body_markdown":"@AkashKumar I have updated the answer. Would you please check and let me know if is there any update?","body":"@AkashKumar I have updated the answer. Would you please check and let me know if is there any update?"},{"owner":{"account_id":3336007,"reputation":1549,"user_id":2803557,"accept_rate":60,"display_name":"Skyyy"},"score":0,"creation_date":1465400849,"post_id":37682113,"comment_id":62888391,"body_markdown":"Didn&#39;t get the if(retry) part whats the retry?","body":"Didn&#39;t get the if(retry) part whats the retry?"},{"owner":{"account_id":2652155,"reputation":28560,"user_id":2293534,"accept_rate":75,"display_name":"SkyWalker"},"score":0,"creation_date":1465403212,"post_id":37682113,"comment_id":62889982,"body_markdown":"retry means that you can again call the method and make a counter for deadlock situation or implement your own code according to your situation @AkashKumar","body":"retry means that you can again call the method and make a counter for deadlock situation or implement your own code according to your situation @AkashKumar"},{"owner":{"account_id":2652155,"reputation":28560,"user_id":2293534,"accept_rate":75,"display_name":"SkyWalker"},"score":0,"creation_date":1465439793,"post_id":37682113,"comment_id":62905220,"body_markdown":"@AkashKumar Would you please check UPDATE2 portion? I have just updated.","body":"@AkashKumar Would you please check UPDATE2 portion? I have just updated."},{"owner":{"account_id":2652155,"reputation":28560,"user_id":2293534,"accept_rate":75,"display_name":"SkyWalker"},"score":0,"creation_date":1465879393,"post_id":37682113,"comment_id":63071282,"body_markdown":"@AkashKumar `isPlaying()` method should be checked. So check the updated4 portion.","body":"@AkashKumar <code>isPlaying()</code> method should be checked. So check the updated4 portion."}],"tags":[],"owner":{"account_id":2652155,"reputation":28560,"user_id":2293534,"accept_rate":75,"display_name":"SkyWalker"},"comment_count":6,"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1465879348,"creation_date":1465309715,"answer_id":37682113,"question_id":37606726,"body_markdown":"Actually this problem occurs if Media player is in wrong state.\r\n\r\nIf your MediaPlayer is in the `Initialized-State`, you cannot call `start()`. So you have to wait till your MediaPlayer is in the `Prepared-State` position.\r\n**You can only seek the Mediaplayer in Prepared, Started and Paused State.**\r\n\r\nFor more details you can check: [Media Player State Diagram][1]\r\n\r\n\r\nYou can also make second call for current position. As it is random issue then bypassing and again calling the method can save you.\r\n\r\n    mediaPlayer.reset();\r\n    \r\n    try {\r\n       .......\r\n       .......\r\n       currentPosition = mediaPlayer.getCurrentPosition();\r\n       ......\r\n    } catch (IllegalStateException e) {\r\n       mediaPlayer.reset();\r\n       currentPosition = mediaPlayer.getCurrentPosition();\r\n    }\r\n    \r\n    mediaPlayer.prepareAsync();\r\n\r\nResource Link:\r\nhttps://stackoverflow.com/questions/16405594/what-is-this-error-java-lang-illegalstateexception-at-mediaplayer-getcurrentposi\r\n\r\n---\r\n\r\n---\r\n\r\nUPDATE1:\r\n---\r\nYou can bypass the exception and make a second call by using it. Hope it may help you.\r\n\r\n    try {\r\n    ....\r\n    currentPosition = mediaPlayer.getCurrentPosition();\r\n    ....\r\n    } catch (final Exception e) {\r\n        e.printStackTrace();\r\n        if (e instanceof IllegalStateException) { // bypass IllegalStateException\r\n            .......\r\n            // You can again call the method and make a counter for deadlock situation or implement your own code according to your situation\r\n            if (retry) {\r\n                   mediaPlayer.reset();\r\n                   currentPosition = mediaPlayer.getCurrentPosition();\r\n            } else {\r\n                throw e;\r\n            }\r\n        }\r\n    }\r\n\r\nUPDATE2: \r\n---\r\n\r\nThis will try 3 times to get current position. If not found, then it will give exception.\r\n\r\n     try {\r\n    \t ....\r\n    \t currentPosition = mediaPlayer.getCurrentPosition();\r\n    \t ....\r\n    \t } catch (final Exception e) {\r\n    \t     e.printStackTrace();\r\n    \t     if (e instanceof IllegalStateException) { // bypass IllegalStateException\r\n    \t         .......\r\n    \t         // You can again call the method and make a counter for deadlock situation or implement your own code according to your situation\r\n    \t         boolean checkAgain = true;\r\n    \t         int counter = 0;\r\n    \t        \t for(int i = 0; i &lt; 2; i++){\r\n    \t        \t\t if (checkAgain) {\r\n    \t        \t\t     mediaPlayer.reset();\r\n     \t                     currentPosition = mediaPlayer.getCurrentPosition();\r\n     \t                     if(currentPosition &gt; 0) {\r\n     \t                    \t checkAgain = false;\r\n     \t                    \t counter++;\r\n     \t                     }\r\n    \t        \t\t } else {\r\n    \t        \t\t\t if(counter == 0){\r\n    \t        \t\t\t\t throw e;\r\n    \t        \t\t\t }\r\n    \t    \t         }\r\n    \t        \t }\r\n    \t                \r\n    \t        \r\n    \t     }\r\n    \t }\r\n\r\nUPDATE4:\r\n---\r\n\r\n 1. An `IllegalStateException` is thrown if `prepare()` or `prepareAsync()` is\r\n    called in any other state.\r\n 2. While in the Prepared state, properties such as audio/sound volume,\r\n    screenOnWhilePlaying, looping can be adjusted by invoking the\r\n    corresponding set methods.\r\n\r\n 3. To start the playback, `start()` must be called. After `start()` returns\r\n    successfully, the MediaPlayer object is in the Started state.\r\n    **isPlaying() can be called to test whether the MediaPlayer object is\r\n    in the Started state.**\r\n\r\n 4. While in the Started state, the internal player engine calls a user\r\n    supplied `OnBufferingUpdateListener.onBufferingUpdate()` callback\r\n    method if a OnBufferingUpdateListener has been registered beforehand\r\n    via `setOnBufferingUpdateListener(OnBufferingUpdateListener)`. This\r\n    callback allows applications to keep track of the buffering status\r\n    while streaming audio/video. Calling `start()` has not effect on a\r\n    MediaPlayer object that is already in the Started state.\r\n\r\nSo `isPlaying()` method should be checked. So code will be look like below:\r\n\r\n     try {\r\n    \t ....\r\n    \t currentPosition = mediaPlayer.getCurrentPosition();\r\n    \t ....\r\n    \t } catch (final Exception e) {\r\n    \t     e.printStackTrace();\r\n    \t     if (e instanceof IllegalStateException) { // bypass IllegalStateException\r\n    \t         .......\r\n    \t         // You can again call the method and make a counter for deadlock situation or implement your own code according to your situation\r\n    \t         boolean checkAgain = true;\r\n    \t         int counter = 0;\r\n    \t        \t for(int i = 0; i &lt; 2; i++){\r\n    \t        \t\t if (checkAgain) {\r\n    \t        \t\t     mediaPlayer.reset();\r\n    \t\t\t\t\t\t if(mediaPlayer != null &amp; mediaPlayer.isPLaying()) {\r\n     \t                        currentPosition = mediaPlayer.getCurrentPosition();\r\n    \t\t\t\t\t\t } else {\r\n    \t\t\t\t\t\t    currentPosition = 0; \r\n    \t\t\t\t\t\t }\r\n     \t                     if(currentPosition &gt; 0) {\r\n     \t                    \t checkAgain = false;\r\n     \t                    \t counter++;\r\n     \t                     }\r\n    \t        \t\t } else {\r\n    \t        \t\t\t if(counter == 0){\r\n    \t        \t\t\t\t throw e;\r\n    \t        \t\t\t }\r\n    \t    \t         }\r\n    \t        \t }\r\n    \t                \r\n    \t        \r\n    \t     }\r\n    \t }\r\n\t\t \r\n\r\n  [1]: https://developer.android.com/reference/android/media/MediaPlayer.html","title":"java.lang.illegalStateException randomly occurs when getting mediaPlayer.getCurrentPosition","body":"<p>Actually this problem occurs if Media player is in wrong state.</p>\n\n<p>If your MediaPlayer is in the <code>Initialized-State</code>, you cannot call <code>start()</code>. So you have to wait till your MediaPlayer is in the <code>Prepared-State</code> position.\n<strong>You can only seek the Mediaplayer in Prepared, Started and Paused State.</strong></p>\n\n<p>For more details you can check: <a href=\"https://developer.android.com/reference/android/media/MediaPlayer.html\" rel=\"nofollow noreferrer\">Media Player State Diagram</a></p>\n\n<p>You can also make second call for current position. As it is random issue then bypassing and again calling the method can save you.</p>\n\n<pre><code>mediaPlayer.reset();\n\ntry {\n   .......\n   .......\n   currentPosition = mediaPlayer.getCurrentPosition();\n   ......\n} catch (IllegalStateException e) {\n   mediaPlayer.reset();\n   currentPosition = mediaPlayer.getCurrentPosition();\n}\n\nmediaPlayer.prepareAsync();\n</code></pre>\n\n<p>Resource Link:\n<a href=\"https://stackoverflow.com/questions/16405594/what-is-this-error-java-lang-illegalstateexception-at-mediaplayer-getcurrentposi\">What is this error java.lang.IllegalStateException at MediaPlayer.getCurrentPosition</a></p>\n\n<hr>\n\n<hr>\n\n<h2>UPDATE1:</h2>\n\n<p>You can bypass the exception and make a second call by using it. Hope it may help you.</p>\n\n<pre><code>try {\n....\ncurrentPosition = mediaPlayer.getCurrentPosition();\n....\n} catch (final Exception e) {\n    e.printStackTrace();\n    if (e instanceof IllegalStateException) { // bypass IllegalStateException\n        .......\n        // You can again call the method and make a counter for deadlock situation or implement your own code according to your situation\n        if (retry) {\n               mediaPlayer.reset();\n               currentPosition = mediaPlayer.getCurrentPosition();\n        } else {\n            throw e;\n        }\n    }\n}\n</code></pre>\n\n<h2>UPDATE2:</h2>\n\n<p>This will try 3 times to get current position. If not found, then it will give exception.</p>\n\n<pre><code> try {\n     ....\n     currentPosition = mediaPlayer.getCurrentPosition();\n     ....\n     } catch (final Exception e) {\n         e.printStackTrace();\n         if (e instanceof IllegalStateException) { // bypass IllegalStateException\n             .......\n             // You can again call the method and make a counter for deadlock situation or implement your own code according to your situation\n             boolean checkAgain = true;\n             int counter = 0;\n                 for(int i = 0; i &lt; 2; i++){\n                     if (checkAgain) {\n                         mediaPlayer.reset();\n                         currentPosition = mediaPlayer.getCurrentPosition();\n                         if(currentPosition &gt; 0) {\n                             checkAgain = false;\n                             counter++;\n                         }\n                     } else {\n                         if(counter == 0){\n                             throw e;\n                         }\n                     }\n                 }\n\n\n         }\n     }\n</code></pre>\n\n<h2>UPDATE4:</h2>\n\n<ol>\n<li>An <code>IllegalStateException</code> is thrown if <code>prepare()</code> or <code>prepareAsync()</code> is\ncalled in any other state.</li>\n<li><p>While in the Prepared state, properties such as audio/sound volume,\nscreenOnWhilePlaying, looping can be adjusted by invoking the\ncorresponding set methods.</p></li>\n<li><p>To start the playback, <code>start()</code> must be called. After <code>start()</code> returns\nsuccessfully, the MediaPlayer object is in the Started state.\n<strong>isPlaying() can be called to test whether the MediaPlayer object is\nin the Started state.</strong></p></li>\n<li><p>While in the Started state, the internal player engine calls a user\nsupplied <code>OnBufferingUpdateListener.onBufferingUpdate()</code> callback\nmethod if a OnBufferingUpdateListener has been registered beforehand\nvia <code>setOnBufferingUpdateListener(OnBufferingUpdateListener)</code>. This\ncallback allows applications to keep track of the buffering status\nwhile streaming audio/video. Calling <code>start()</code> has not effect on a\nMediaPlayer object that is already in the Started state.</p></li>\n</ol>\n\n<p>So <code>isPlaying()</code> method should be checked. So code will be look like below:</p>\n\n<pre><code> try {\n     ....\n     currentPosition = mediaPlayer.getCurrentPosition();\n     ....\n     } catch (final Exception e) {\n         e.printStackTrace();\n         if (e instanceof IllegalStateException) { // bypass IllegalStateException\n             .......\n             // You can again call the method and make a counter for deadlock situation or implement your own code according to your situation\n             boolean checkAgain = true;\n             int counter = 0;\n                 for(int i = 0; i &lt; 2; i++){\n                     if (checkAgain) {\n                         mediaPlayer.reset();\n                         if(mediaPlayer != null &amp; mediaPlayer.isPLaying()) {\n                            currentPosition = mediaPlayer.getCurrentPosition();\n                         } else {\n                            currentPosition = 0; \n                         }\n                         if(currentPosition &gt; 0) {\n                             checkAgain = false;\n                             counter++;\n                         }\n                     } else {\n                         if(counter == 0){\n                             throw e;\n                         }\n                     }\n                 }\n\n\n         }\n     }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3078156,"reputation":396,"user_id":2607024,"display_name":"Zhe"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1465489583,"creation_date":1465489583,"answer_id":37731498,"question_id":37606726,"body_markdown":"I strongly suspect that these methods are not thread safe. Even with the state checking that people are suggesting, you may still run into a problem if you interleave another operation from a different thread that renders this check useless.\r\n\r\nConsider synchronizing on the media player object to prevent concurrent access. You&#39;ll have to declare the mediaPlayer to be final.\r\n\r\n    final MediaPlayer mediaPlayer = ...\r\n\r\nAnd later (with one of the suggested checks. I didn&#39;t look to see if this was the appropriate one):\r\n\r\n    synchronized (mediaPlayer) {\r\n      if (mediaPlayer != null &amp; mediaPlayer.isPlaying()) {\r\n        currentPosition = mediaPlayer.getCurrentPosition();\r\n      } else {\r\n        currentPosition = 0;\r\n      }\r\n    }","title":"java.lang.illegalStateException randomly occurs when getting mediaPlayer.getCurrentPosition","body":"<p>I strongly suspect that these methods are not thread safe. Even with the state checking that people are suggesting, you may still run into a problem if you interleave another operation from a different thread that renders this check useless.</p>\n\n<p>Consider synchronizing on the media player object to prevent concurrent access. You'll have to declare the mediaPlayer to be final.</p>\n\n<pre><code>final MediaPlayer mediaPlayer = ...\n</code></pre>\n\n<p>And later (with one of the suggested checks. I didn't look to see if this was the appropriate one):</p>\n\n<pre><code>synchronized (mediaPlayer) {\n  if (mediaPlayer != null &amp; mediaPlayer.isPlaying()) {\n    currentPosition = mediaPlayer.getCurrentPosition();\n  } else {\n    currentPosition = 0;\n  }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":2655079,"reputation":1862,"user_id":2295938,"display_name":"Kaamel"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1465841279,"creation_date":1465755124,"answer_id":37777537,"question_id":37606726,"body_markdown":"In this code checks to see if the current position is before the end, and if so it waits 500ms, by which time it might be past the end! In fact for all practical purposes, it might reach the end just a moment after the check. This is not thread safe but there are synchronization solutions to mitigate this condition. I would suggest you use a simpler solution like this:\r\n\r\n    updateSeekBar = new Thread() {\r\n            @Override\r\n            public void run() {\r\n                int runtime = mediaPlayer.getDuration();\r\n                int currentPosition = 0;\r\n                int adv = 0;\r\n                while ((adv = ((adv = runtime - currentPosition) &lt; 500)?adv:500) &gt; 2) {\r\n                    try {\r\n                        currentPosition = mediaPlayer.getCurrentPosition();\r\n                        if (seekBar != null) {\r\n                            seekBar.setProgress(currentPosition);\r\n                        }\r\n                        sleep(adv);    \r\n                    } catch (InterruptedException e) {\r\n                        e.printStackTrace();\r\n                    } catch (IllegalStateException e) {\r\n                        seekBar.setProgress(runtime);\r\n                        break;\r\n                    }\r\n    \r\n                }\r\n            }\r\n        };\r\n\r\nThis code first calculates the difference between the currentPosition and the duration and only if there is more than 2ms difference it will try to get the new current position (2ms is just an arbitrary number to add some safety margin while sacrificing 2ms of accuracy at the end.) Also sleep is moved to the end of the loop, which adds to the safety margin and also makes the display of the seekbar more inline with the current position. Lastly there is a catch statement added just in case everything else fails.\r\n\r\nBy the way, while it is not shown in your code, I am assuming seekBar is final so there is no need to check for null every time. Maybe move it to the top and exit if it is null.","title":"java.lang.illegalStateException randomly occurs when getting mediaPlayer.getCurrentPosition","body":"<p>In this code checks to see if the current position is before the end, and if so it waits 500ms, by which time it might be past the end! In fact for all practical purposes, it might reach the end just a moment after the check. This is not thread safe but there are synchronization solutions to mitigate this condition. I would suggest you use a simpler solution like this:</p>\n\n<pre><code>updateSeekBar = new Thread() {\n        @Override\n        public void run() {\n            int runtime = mediaPlayer.getDuration();\n            int currentPosition = 0;\n            int adv = 0;\n            while ((adv = ((adv = runtime - currentPosition) &lt; 500)?adv:500) &gt; 2) {\n                try {\n                    currentPosition = mediaPlayer.getCurrentPosition();\n                    if (seekBar != null) {\n                        seekBar.setProgress(currentPosition);\n                    }\n                    sleep(adv);    \n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                } catch (IllegalStateException e) {\n                    seekBar.setProgress(runtime);\n                    break;\n                }\n\n            }\n        }\n    };\n</code></pre>\n\n<p>This code first calculates the difference between the currentPosition and the duration and only if there is more than 2ms difference it will try to get the new current position (2ms is just an arbitrary number to add some safety margin while sacrificing 2ms of accuracy at the end.) Also sleep is moved to the end of the loop, which adds to the safety margin and also makes the display of the seekbar more inline with the current position. Lastly there is a catch statement added just in case everything else fails.</p>\n\n<p>By the way, while it is not shown in your code, I am assuming seekBar is final so there is no need to check for null every time. Maybe move it to the top and exit if it is null.</p>\n"},{"tags":[],"owner":{"account_id":5869143,"reputation":665,"user_id":4621980,"display_name":"Sanat Chandravanshi"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1465884589,"creation_date":1465884589,"answer_id":37804162,"question_id":37606726,"body_markdown":"Please follow the state diagram:[enter image description here][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/qnX4K.gif\r\n\r\n\r\nYou will realize that you should call reset() to get it back to the idle state. Only then can you call setDataSource()","title":"java.lang.illegalStateException randomly occurs when getting mediaPlayer.getCurrentPosition","body":"<p>Please follow the state diagram:<a href=\"https://i.stack.imgur.com/qnX4K.gif\" rel=\"nofollow\">enter image description here</a></p>\n\n<p>You will realize that you should call reset() to get it back to the idle state. Only then can you call setDataSource()</p>\n"},{"tags":[],"owner":{"account_id":14333618,"reputation":76,"user_id":10353759,"display_name":"Bonnjalal"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1588299203,"creation_date":1588299203,"answer_id":61535800,"question_id":37606726,"body_markdown":"Try this:\r\nreplace the `mMediaPlayer.start();` with this:\r\n\r\n    mMediaPlayer.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {\r\n                    @Override\r\n                    public void onPrepared(MediaPlayer mediaPlayer) {\r\n                        mMediaPlayer.start();\r\n                    }\r\n    });\r\n\r\n","title":"java.lang.illegalStateException randomly occurs when getting mediaPlayer.getCurrentPosition","body":"<p>Try this:\nreplace the <code>mMediaPlayer.start();</code> with this:</p>\n\n<pre><code>mMediaPlayer.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {\n                @Override\n                public void onPrepared(MediaPlayer mediaPlayer) {\n                    mMediaPlayer.start();\n                }\n});\n</code></pre>\n"},{"tags":[],"owner":{"account_id":21390158,"reputation":801,"user_id":15754377,"display_name":"Vivek Gupta"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681063341,"creation_date":1681063341,"answer_id":75972066,"question_id":37606726,"body_markdown":"By making my custom mediaPlayer state (based of state diagram) , I was able to call getCurrentPosition() method without any exception. \r\nFor my audio Player, I created below states. \r\n\r\n    private enum class MediaPlayerState {\r\n        IDLE,\r\n        PLAYING,\r\n        PAUSED,\r\n        COMPLETED,\r\n        PREPARED\r\n    }\r\n\r\nThen created listener to change the States of my audioPlayer\r\n\r\n    private val prepareListener = MediaPlayer.OnPreparedListener {\r\n        Log.d(&quot;MyLog&quot;, &quot;Media State = PREPARED&quot;)\r\n        mediaState = MediaPlayerState.PREPARED\r\n        \r\n       }\r\n    private val onCompletedListener = MediaPlayer.OnCompletionListener {\r\n        Log.d(&quot;MyLog&quot;, &quot;Media State = Completed&quot;)\r\n        mediaState = MediaPlayerState.COMPLETED\r\n       }\r\n\r\nSo, I was able to play media only when mediaState variable is on Prepared State\r\n  \r\n\r\n    when(mediaState)\r\n     {\r\n       MediaPlayerState.COMPLETED, MediaPlayerState.PREPARED -&gt; {\r\n    \r\n          mediaPlayer.start()\r\n          mediaState = MediaPlayerState.PLAYING\r\n         }\r\n         ... \r\n         }\r\n                  \r\nSo when I release the media player, I changed the state to Idle\r\n\r\n     override fun onDetachedFromWindow() {\r\n        super.onDetachedFromWindow()\r\n        mediaState = MediaPlayerState.IDLE\r\n        mediaPlayer.release()\r\n        Log.d(&quot;MyLog&quot;, &quot;Media State = Released&quot;)\r\n\r\n    }\r\n\r\nThen when I call  getCurrentPosition on media , I check for the state ( on background thread )\r\n\r\n     if(mediaState == MediaPlayerState.PLAYING)\r\n                    seekBar.progress = mediaPlayer.currentPosition\r\n\r\nHence, No Illegal State Exception \r\n\r\nBy thinking in compose, changed the way of doing things..","title":"java.lang.illegalStateException randomly occurs when getting mediaPlayer.getCurrentPosition","body":"<p>By making my custom mediaPlayer state (based of state diagram) , I was able to call getCurrentPosition() method without any exception.\nFor my audio Player, I created below states.</p>\n<pre><code>private enum class MediaPlayerState {\n    IDLE,\n    PLAYING,\n    PAUSED,\n    COMPLETED,\n    PREPARED\n}\n</code></pre>\n<p>Then created listener to change the States of my audioPlayer</p>\n<pre><code>private val prepareListener = MediaPlayer.OnPreparedListener {\n    Log.d(&quot;MyLog&quot;, &quot;Media State = PREPARED&quot;)\n    mediaState = MediaPlayerState.PREPARED\n    \n   }\nprivate val onCompletedListener = MediaPlayer.OnCompletionListener {\n    Log.d(&quot;MyLog&quot;, &quot;Media State = Completed&quot;)\n    mediaState = MediaPlayerState.COMPLETED\n   }\n</code></pre>\n<p>So, I was able to play media only when mediaState variable is on Prepared State</p>\n<pre><code>when(mediaState)\n {\n   MediaPlayerState.COMPLETED, MediaPlayerState.PREPARED -&gt; {\n\n      mediaPlayer.start()\n      mediaState = MediaPlayerState.PLAYING\n     }\n     ... \n     }\n              \n</code></pre>\n<p>So when I release the media player, I changed the state to Idle</p>\n<pre><code> override fun onDetachedFromWindow() {\n    super.onDetachedFromWindow()\n    mediaState = MediaPlayerState.IDLE\n    mediaPlayer.release()\n    Log.d(&quot;MyLog&quot;, &quot;Media State = Released&quot;)\n\n}\n</code></pre>\n<p>Then when I call  getCurrentPosition on media , I check for the state ( on background thread )</p>\n<pre><code> if(mediaState == MediaPlayerState.PLAYING)\n                seekBar.progress = mediaPlayer.currentPosition\n</code></pre>\n<p>Hence, No Illegal State Exception</p>\n<p>By thinking in compose, changed the way of doing things..</p>\n"}],"owner":{"account_id":3336007,"reputation":1549,"user_id":2803557,"accept_rate":60,"display_name":"Skyyy"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":7816,"favorite_count":0,"down_vote_count":0,"up_vote_count":10,"answer_count":8,"score":10,"last_activity_date":1681063341,"creation_date":1464932550,"question_id":37606726,"body_markdown":"This code works fine song play perfectly but some time randomly going to next song manually crashes application. Happens randomly\r\n\r\n        updateSeekBar = new Thread() {\r\n            @Override\r\n            public void run() {\r\n                int runtime = mediaPlayer.getDuration();\r\n                int currentPosition = 0;\r\n                while (currentPosition &lt; runtime) {\r\n                    try {\r\n                        sleep(500);\r\n                        currentPosition = mediaPlayer.getCurrentPosition();//This is where the app crash                        \r\n                        if (seekBar != null) {\r\n                            seekBar.setProgress(currentPosition);\r\n                        }\r\n                    } catch (InterruptedException e) {\r\n                        e.printStackTrace();\r\n                    }\r\n\r\n                }\r\n            }\r\n        };\r\n\r\n\r\n\r\nCrash report\r\n\r\n    06-10 22:08:53.160 15351-15560/skydeveloper.me.musicx2 E/AndroidRuntime: FATAL EXCEPTION: Thread-6875\r\n                                                                         Process: skydeveloper.me.musicx2, PID: 15351\r\n                                                                         java.lang.IllegalStateException\r\n                                                                             at android.media.MediaPlayer.getCurrentPosition(Native Method)\r\n                                                                             at skydeveloper.me.musicx2.Player$1.run(Player.java:104)\r\n","title":"java.lang.illegalStateException randomly occurs when getting mediaPlayer.getCurrentPosition","body":"<p>This code works fine song play perfectly but some time randomly going to next song manually crashes application. Happens randomly</p>\n\n<pre><code>    updateSeekBar = new Thread() {\n        @Override\n        public void run() {\n            int runtime = mediaPlayer.getDuration();\n            int currentPosition = 0;\n            while (currentPosition &lt; runtime) {\n                try {\n                    sleep(500);\n                    currentPosition = mediaPlayer.getCurrentPosition();//This is where the app crash                        \n                    if (seekBar != null) {\n                        seekBar.setProgress(currentPosition);\n                    }\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n\n            }\n        }\n    };\n</code></pre>\n\n<p>Crash report</p>\n\n<pre><code>06-10 22:08:53.160 15351-15560/skydeveloper.me.musicx2 E/AndroidRuntime: FATAL EXCEPTION: Thread-6875\n                                                                     Process: skydeveloper.me.musicx2, PID: 15351\n                                                                     java.lang.IllegalStateException\n                                                                         at android.media.MediaPlayer.getCurrentPosition(Native Method)\n                                                                         at skydeveloper.me.musicx2.Player$1.run(Player.java:104)\n</code></pre>\n"},{"tags":["java","android","android-studio","locale"],"comments":[{"owner":{"account_id":6471701,"reputation":493,"user_id":9752602,"display_name":"sneharc"},"score":1,"creation_date":1659954549,"post_id":68298424,"comment_id":129409675,"body_markdown":"did you find any solution? I&#39;m facing the same issue","body":"did you find any solution? I&#39;m facing the same issue"},{"owner":{"account_id":7626975,"reputation":309,"user_id":5783147,"display_name":"AkshayK"},"score":0,"creation_date":1660908896,"post_id":68298424,"comment_id":129650545,"body_markdown":"I think this will help you\nhttps://stackoverflow.com/a/52733674/5783147","body":"I think this will help you <a href=\"https://stackoverflow.com/a/52733674/5783147\">stackoverflow.com/a/52733674/5783147</a>"},{"owner":{"account_id":3821169,"reputation":763,"user_id":3169238,"display_name":"Sergei Kozelko"},"score":0,"creation_date":1681097881,"post_id":68298424,"comment_id":133998540,"body_markdown":"Does this answer your question? [Android App Bundle with in-app locale change](https://stackoverflow.com/questions/52731670/android-app-bundle-with-in-app-locale-change)","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/52731670/android-app-bundle-with-in-app-locale-change\">Android App Bundle with in-app locale change</a>"}],"answers":[{"tags":[],"owner":{"account_id":23396202,"reputation":1,"user_id":17460191,"display_name":"Maksudur Rahman Munif"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681063060,"creation_date":1680552224,"answer_id":75923364,"question_id":68298424,"body_markdown":"Add this to your app gradle \r\n```\r\nandroid {\r\n    bundle {\r\n        language {\r\n            enableSplit = false\r\n        }\r\n    }\r\n}\r\n```\r\nDetails at [this thread](https://stackoverflow.com/questions/52731670/android-app-bundle-with-in-app-locale-change/52733674#52733674)","title":"Android App Locale Not Working on Play Store Release","body":"<p>Add this to your app gradle</p>\n<pre><code>android {\n    bundle {\n        language {\n            enableSplit = false\n        }\n    }\n}\n</code></pre>\n<p>Details at <a href=\"https://stackoverflow.com/questions/52731670/android-app-bundle-with-in-app-locale-change/52733674#52733674\">this thread</a></p>\n"}],"owner":{"account_id":21986078,"reputation":73,"user_id":16260318,"display_name":"Jay Gunawardena"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":1128,"favorite_count":0,"down_vote_count":0,"up_vote_count":6,"answer_count":1,"score":6,"last_activity_date":1681063060,"creation_date":1625734258,"question_id":68298424,"body_markdown":"I&#39;m changing the app locale at the press of a button. Which works perfect on AVDs as well as debug &amp; release build APKs on actual devices with API 30.\r\n\r\nBut however it is not working with the Play Store version of the app once it is published. The locale never gets changed.\r\n\r\nPlease help! Thank you!\r\n\r\nThis is the code in the SettingsFragment:\r\n\r\n    private void setAppLocale(Context context, String language) {\r\n        Locale locale = new Locale(language);\r\n        Locale.setDefault(locale);\r\n        Configuration config = context.getResources().getConfiguration();\r\n        config.setLocale(locale);\r\n        context.createConfigurationContext(config);\r\n        context.getResources().updateConfiguration(config, context.getResources().getDisplayMetrics());\r\n        Intent refresh = new Intent(getActivity().getApplicationContext(), MainActivity.class);\r\n        startActivity(refresh);\r\n        getActivity().finish();\r\n    }\r\n\r\nThe above gets called once a button is pressed as well as the selections gets put in Shared Preferences. The activity gets refreshed &amp; the main activity loads but the locale is never changed.\r\n\r\nThis is how my MainActivity looks like:\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n\r\n        hideSystemUI();\r\n\r\n        sharedPref = getPreferences(Context.MODE_PRIVATE);\r\n        selectedLanguage = sharedPref.getString(&quot;Test.SL.LanguageName&quot;, language);\r\n        selectedTheme = sharedPref.getString(&quot;Test.SL.ThemeName&quot;, &quot;Light&quot;);\r\n\r\n        if (selectedTheme.equals(&quot;Light&quot;)){\r\n            AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);\r\n        } else if (selectedTheme.equals(&quot;Dark&quot;)) {\r\n            AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);\r\n        }\r\n\r\n        if (selectedLanguage.equals(&quot;Sinhala&quot;)) {\r\n            language = &quot;Sinhala&quot;;\r\n            setAppLocale(this, &quot;si&quot;);\r\n        } else {\r\n            language = &quot;English&quot;;\r\n            setAppLocale(this, &quot;en&quot;);\r\n        }\r\n\r\n        binding = ActivityMainBinding.inflate(getLayoutInflater());\r\n        setContentView(binding.getRoot());\r\n\r\n        setSupportActionBar(binding.appBarMain.toolbar);\r\n        \r\n           ......\r\n\r\n    }\r\n\r\n    public void setAppLocale(Context context, String language) {\r\n        Locale locale = new Locale(language);\r\n        Locale.setDefault(locale);\r\n        Configuration config = context.getResources().getConfiguration();\r\n        config.setLocale(locale);\r\n        context.createConfigurationContext(config);\r\n        context.getResources().updateConfiguration(config, context.getResources().getDisplayMetrics());\r\n    }\r\n\r\nAny ideas, suggestions &amp; solutions please! Thank you again!","title":"Android App Locale Not Working on Play Store Release","body":"<p>I'm changing the app locale at the press of a button. Which works perfect on AVDs as well as debug &amp; release build APKs on actual devices with API 30.</p>\n<p>But however it is not working with the Play Store version of the app once it is published. The locale never gets changed.</p>\n<p>Please help! Thank you!</p>\n<p>This is the code in the SettingsFragment:</p>\n<pre><code>private void setAppLocale(Context context, String language) {\n    Locale locale = new Locale(language);\n    Locale.setDefault(locale);\n    Configuration config = context.getResources().getConfiguration();\n    config.setLocale(locale);\n    context.createConfigurationContext(config);\n    context.getResources().updateConfiguration(config, context.getResources().getDisplayMetrics());\n    Intent refresh = new Intent(getActivity().getApplicationContext(), MainActivity.class);\n    startActivity(refresh);\n    getActivity().finish();\n}\n</code></pre>\n<p>The above gets called once a button is pressed as well as the selections gets put in Shared Preferences. The activity gets refreshed &amp; the main activity loads but the locale is never changed.</p>\n<p>This is how my MainActivity looks like:</p>\n<pre><code>@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n\n    hideSystemUI();\n\n    sharedPref = getPreferences(Context.MODE_PRIVATE);\n    selectedLanguage = sharedPref.getString(&quot;Test.SL.LanguageName&quot;, language);\n    selectedTheme = sharedPref.getString(&quot;Test.SL.ThemeName&quot;, &quot;Light&quot;);\n\n    if (selectedTheme.equals(&quot;Light&quot;)){\n        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);\n    } else if (selectedTheme.equals(&quot;Dark&quot;)) {\n        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);\n    }\n\n    if (selectedLanguage.equals(&quot;Sinhala&quot;)) {\n        language = &quot;Sinhala&quot;;\n        setAppLocale(this, &quot;si&quot;);\n    } else {\n        language = &quot;English&quot;;\n        setAppLocale(this, &quot;en&quot;);\n    }\n\n    binding = ActivityMainBinding.inflate(getLayoutInflater());\n    setContentView(binding.getRoot());\n\n    setSupportActionBar(binding.appBarMain.toolbar);\n    \n       ......\n\n}\n\npublic void setAppLocale(Context context, String language) {\n    Locale locale = new Locale(language);\n    Locale.setDefault(locale);\n    Configuration config = context.getResources().getConfiguration();\n    config.setLocale(locale);\n    context.createConfigurationContext(config);\n    context.getResources().updateConfiguration(config, context.getResources().getDisplayMetrics());\n}\n</code></pre>\n<p>Any ideas, suggestions &amp; solutions please! Thank you again!</p>\n"},{"tags":["java","android-studio","opencv","image-processing"],"comments":[{"owner":{"account_id":17547232,"reputation":5322,"user_id":12728244,"display_name":"stateMachine"},"score":0,"creation_date":1681063621,"post_id":75971996,"comment_id":133995131,"body_markdown":"Sounds like you are cropping the image you are drawing onto. Either do not draw to it before cropping or create a deep copy before drawing the info and crop that image instead.","body":"Sounds like you are cropping the image you are drawing onto. Either do not draw to it before cropping or create a deep copy before drawing the info and crop that image instead."}],"owner":{"account_id":27882245,"reputation":11,"user_id":21290464,"display_name":"UncannyHarmony"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":35,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681062221,"creation_date":1681062221,"question_id":75971996,"body_markdown":"I&#39;m unable to crop the ROI  into the original  image after finding rectangle boundaries. Instead of showing the cropped image, it displays the contour and rectangle boundary instead. My main goal is to crop inner square from the circular sample for further processing using Pythagorean Theorem: the diagonal of a square is root of 2 times the lenghth of a side. Please help as I&#39;m new to openCV\r\n\r\n```\r\n\r\n  public void imageProcessingAlgorithm (){\r\n      new Thread(new Runnable() {\r\n          @Override\r\n          public void run() {\r\n              long tStart = System.currentTimeMillis();\r\n              countWBC = 0;\r\n              countRBC = 0;\r\n\r\n              //Convert the Bitmap image to Mat\r\n              //Utils.bitmapToMat converts an Android Bitmap to an OpenCV Mat.\r\n              Mat oriImage = new Mat();\r\n              Utils.bitmapToMat(processBitmap, oriImage);\r\n              //Imgproc.cvtColor(oriImage, oriImage, Imgproc.COLOR_RGBA2RGB);\r\n\r\n              //Grayscale image\r\n              Mat grayscale = new Mat();\r\n              Imgproc.cvtColor(oriImage,grayscale, Imgproc.COLOR_RGB2GRAY);\r\n\r\n              //Otsu Thresholding (Binary Image)\r\n              Mat otsuThreshold = new Mat();\r\n              Imgproc.threshold(grayscale, otsuThreshold ,0,255, Imgproc.THRESH_OTSU);\r\n\r\n              //Contour finding\r\n              List&lt;MatOfPoint&gt; contours = new ArrayList&lt;MatOfPoint&gt;(); //list for contours\r\n              Imgproc.findContours(otsuThreshold, contours, new Mat(), Imgproc.RETR_LIST, Imgproc.CHAIN_APPROX_NONE);\r\n              //Mat drawing = new Mat(otsuThreshold.size(), CvType.CV_8UC3);\r\n\r\n              Mat hierarchy = new Mat();\r\n              Rect rect = new Rect();\r\n              int xBound =0;\r\n              int yBound =0;\r\n              int xWidth =0;\r\n              int yHeight =0;\r\n              int radius = 0;\r\n\r\n              for (int idx = 0; idx &lt; contours.size(); idx++) {\r\n                  Mat contour = contours.get(idx);\r\n                  List&lt;Double&gt; areasList = new ArrayList&lt;Double&gt;(); //list for area\r\n                  double contourarea = Imgproc.contourArea(contour);\r\n                  areasList.add(contourarea);\r\n                  //POint2f means 2D coordinates\r\n                  MatOfPoint2f approxCurve = new MatOfPoint2f();\r\n                  MatOfPoint2f contour2f = new MatOfPoint2f(contours.get(idx).toArray());\r\n                  double approxDistance = Imgproc.arcLength(contour2f, true) * 0.02;\r\n                  Imgproc.approxPolyDP(contour2f, approxCurve, approxDistance, true);\r\n                  MatOfPoint points = new MatOfPoint(approxCurve.toArray());\r\n                  rect = Imgproc.boundingRect(points);\r\n                  if (contourarea &gt; 100000) {\r\n\r\n                      //Contour Drawing + Bounding Box\r\n                      xBound = rect.x;\r\n                      yBound = rect.y;\r\n                      xWidth = rect.width;\r\n                      yHeight = rect.height;\r\n                      //to Draw contour(colour is in Red)\r\n                      Imgproc.drawContours(oriImage, contours, idx, new Scalar(255, 0, 0), 2, 8, hierarchy, 0, new Point());\r\n                      //to Draw Outer Bounding rectangle(colour is in Green)\r\n                      Imgproc.rectangle(oriImage, new Point(rect.x, rect.y),\r\n                              new Point(rect.x + rect.width, rect.y + rect.height), new Scalar(0, 255, 0), 3);\r\n                      if (rect.height &gt; rect.width)\r\n                          radius = rect.width/2;\r\n                      else\r\n                          radius = rect.height/2;\r\n                  }\r\n              }\r\n\r\n              //To find internal boundary to crop image\r\n              radius = (int)(radius*0.70711);\r\n              int xPos = xBound+(xWidth/2)-radius;\r\n              int yPos = yBound+(yHeight/2)-radius;\r\n              Rect reg_info = new Rect(xPos,yPos,radius*2,radius*2);\r\n              Mat roi = oriImage.submat(reg_info);\r\n\r\n\r\n\r\n              // CIELab conversion\r\n\r\n              long tEnd = System.currentTimeMillis();\r\n          long tDelta = tEnd - tStart;\r\n          elapsedSeconds = tDelta/1000.0 ;\r\n\r\n          //To convert the Mat object back to Bitmap\r\n          Utils.matToBitmap(roi,processBitmap);\r\n\r\n\r\n        runOnUiThread(new Runnable() {\r\n\r\n            @Override\r\n            public void run() {\r\n                invalidateOptionsMenu();\r\n                PhotoView myImage = (PhotoView) findViewById(R.id.resultImage);\r\n                myImage.setImageBitmap(processBitmap);\r\n                db.updateResult(new SampleViewList(fileName,folderName,countRBC,countWBC,String.valueOf(elapsedSeconds),getDate()));\r\n                getImage = db.getImgView(fileName);\r\n                showResult();\r\n                try{\r\n                    FileOutputStream fOut = new FileOutputStream(resultImagedir);\r\n                    processBitmap.compress(Bitmap.CompressFormat.JPEG, 100, fOut);\r\n                    try{\r\n                        fOut.flush();\r\n                        fOut.close();\r\n                    } catch (IOException E){\r\n                        E.printStackTrace();\r\n                    }\r\n                } catch (FileNotFoundException e){\r\n                    e.printStackTrace();\r\n                }\r\n\r\n  }\r\n\r\n  });\r\n          }\r\n}).start();\r\n  }\r\n```\r\n\r\n[![enter image description here](https://i.stack.imgur.com/dTf2f.png)](https://i.stack.imgur.com/dTf2f.png)\r\n\r\nresult image on RHS","title":"Unable to crop the ROI from original image","body":"<p>I'm unable to crop the ROI  into the original  image after finding rectangle boundaries. Instead of showing the cropped image, it displays the contour and rectangle boundary instead. My main goal is to crop inner square from the circular sample for further processing using Pythagorean Theorem: the diagonal of a square is root of 2 times the lenghth of a side. Please help as I'm new to openCV</p>\n<pre><code>\n  public void imageProcessingAlgorithm (){\n      new Thread(new Runnable() {\n          @Override\n          public void run() {\n              long tStart = System.currentTimeMillis();\n              countWBC = 0;\n              countRBC = 0;\n\n              //Convert the Bitmap image to Mat\n              //Utils.bitmapToMat converts an Android Bitmap to an OpenCV Mat.\n              Mat oriImage = new Mat();\n              Utils.bitmapToMat(processBitmap, oriImage);\n              //Imgproc.cvtColor(oriImage, oriImage, Imgproc.COLOR_RGBA2RGB);\n\n              //Grayscale image\n              Mat grayscale = new Mat();\n              Imgproc.cvtColor(oriImage,grayscale, Imgproc.COLOR_RGB2GRAY);\n\n              //Otsu Thresholding (Binary Image)\n              Mat otsuThreshold = new Mat();\n              Imgproc.threshold(grayscale, otsuThreshold ,0,255, Imgproc.THRESH_OTSU);\n\n              //Contour finding\n              List&lt;MatOfPoint&gt; contours = new ArrayList&lt;MatOfPoint&gt;(); //list for contours\n              Imgproc.findContours(otsuThreshold, contours, new Mat(), Imgproc.RETR_LIST, Imgproc.CHAIN_APPROX_NONE);\n              //Mat drawing = new Mat(otsuThreshold.size(), CvType.CV_8UC3);\n\n              Mat hierarchy = new Mat();\n              Rect rect = new Rect();\n              int xBound =0;\n              int yBound =0;\n              int xWidth =0;\n              int yHeight =0;\n              int radius = 0;\n\n              for (int idx = 0; idx &lt; contours.size(); idx++) {\n                  Mat contour = contours.get(idx);\n                  List&lt;Double&gt; areasList = new ArrayList&lt;Double&gt;(); //list for area\n                  double contourarea = Imgproc.contourArea(contour);\n                  areasList.add(contourarea);\n                  //POint2f means 2D coordinates\n                  MatOfPoint2f approxCurve = new MatOfPoint2f();\n                  MatOfPoint2f contour2f = new MatOfPoint2f(contours.get(idx).toArray());\n                  double approxDistance = Imgproc.arcLength(contour2f, true) * 0.02;\n                  Imgproc.approxPolyDP(contour2f, approxCurve, approxDistance, true);\n                  MatOfPoint points = new MatOfPoint(approxCurve.toArray());\n                  rect = Imgproc.boundingRect(points);\n                  if (contourarea &gt; 100000) {\n\n                      //Contour Drawing + Bounding Box\n                      xBound = rect.x;\n                      yBound = rect.y;\n                      xWidth = rect.width;\n                      yHeight = rect.height;\n                      //to Draw contour(colour is in Red)\n                      Imgproc.drawContours(oriImage, contours, idx, new Scalar(255, 0, 0), 2, 8, hierarchy, 0, new Point());\n                      //to Draw Outer Bounding rectangle(colour is in Green)\n                      Imgproc.rectangle(oriImage, new Point(rect.x, rect.y),\n                              new Point(rect.x + rect.width, rect.y + rect.height), new Scalar(0, 255, 0), 3);\n                      if (rect.height &gt; rect.width)\n                          radius = rect.width/2;\n                      else\n                          radius = rect.height/2;\n                  }\n              }\n\n              //To find internal boundary to crop image\n              radius = (int)(radius*0.70711);\n              int xPos = xBound+(xWidth/2)-radius;\n              int yPos = yBound+(yHeight/2)-radius;\n              Rect reg_info = new Rect(xPos,yPos,radius*2,radius*2);\n              Mat roi = oriImage.submat(reg_info);\n\n\n\n              // CIELab conversion\n\n              long tEnd = System.currentTimeMillis();\n          long tDelta = tEnd - tStart;\n          elapsedSeconds = tDelta/1000.0 ;\n\n          //To convert the Mat object back to Bitmap\n          Utils.matToBitmap(roi,processBitmap);\n\n\n        runOnUiThread(new Runnable() {\n\n            @Override\n            public void run() {\n                invalidateOptionsMenu();\n                PhotoView myImage = (PhotoView) findViewById(R.id.resultImage);\n                myImage.setImageBitmap(processBitmap);\n                db.updateResult(new SampleViewList(fileName,folderName,countRBC,countWBC,String.valueOf(elapsedSeconds),getDate()));\n                getImage = db.getImgView(fileName);\n                showResult();\n                try{\n                    FileOutputStream fOut = new FileOutputStream(resultImagedir);\n                    processBitmap.compress(Bitmap.CompressFormat.JPEG, 100, fOut);\n                    try{\n                        fOut.flush();\n                        fOut.close();\n                    } catch (IOException E){\n                        E.printStackTrace();\n                    }\n                } catch (FileNotFoundException e){\n                    e.printStackTrace();\n                }\n\n  }\n\n  });\n          }\n}).start();\n  }\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/dTf2f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dTf2f.png\" alt=\"enter image description here\" /></a></p>\n<p>result image on RHS</p>\n"},{"tags":["java","spring","spring-webflux"],"owner":{"account_id":26038502,"reputation":95,"user_id":19743660,"display_name":"programmer"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":100,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1681062067,"creation_date":1681062067,"question_id":75971990,"body_markdown":"I am trying to filter multipart/form-data content, but don&#39;t know how to get access to request body. I found DefaultPartHttpMessageReader class, but for now I have no idea how to parse content using it.","title":"How to read multipart/form-data content from request body in Spring WebFlux filter?","body":"<p>I am trying to filter multipart/form-data content, but don't know how to get access to request body. I found DefaultPartHttpMessageReader class, but for now I have no idea how to parse content using it.</p>\n"},{"tags":["java","lucene"],"comments":[{"owner":{"account_id":12743722,"reputation":19966,"user_id":12567365,"display_name":"andrewJames"},"score":0,"creation_date":1681003941,"post_id":75968156,"comment_id":133989227,"body_markdown":"What version of Lucene are you using? How have you created the documents you are using (so we can see what fields you have defined - and how you have defined them).","body":"What version of Lucene are you using? How have you created the documents you are using (so we can see what fields you have defined - and how you have defined them)."},{"owner":{"account_id":12743722,"reputation":19966,"user_id":12567365,"display_name":"andrewJames"},"score":0,"creation_date":1681004047,"post_id":75968156,"comment_id":133989235,"body_markdown":"I would expect you to use [`document.getFields()`](https://lucene.apache.org/core/9_5_0/core/org/apache/lucene/document/Document.html#getFields()) given you want fields for specific documents - and bear in mind that fields set to `Field.Store.NO` are _not_ stored in any specific document, in the index. It&#39;s the difference between &quot;fields for the document&quot; (what I think you are asking for) and &quot;documents for the field&quot;.","body":"I would expect you to use <a href=\"https://lucene.apache.org/core/9_5_0/core/org/apache/lucene/document/Document.html#getFields()\" rel=\"nofollow noreferrer\"><code>document.getFields()</code></a> given you want fields for specific documents - and bear in mind that fields set to <code>Field.Store.NO</code> are <i>not</i> stored in any specific document, in the index. It&#39;s the difference between &quot;fields for the document&quot; (what I think you are asking for) and &quot;documents for the field&quot;."},{"owner":{"account_id":26976979,"reputation":33,"user_id":20541994,"display_name":"David"},"score":0,"creation_date":1681033731,"post_id":75968156,"comment_id":133991529,"body_markdown":"I am using Lucene 9.4.2","body":"I am using Lucene 9.4.2"},{"owner":{"account_id":26976979,"reputation":33,"user_id":20541994,"display_name":"David"},"score":0,"creation_date":1681034032,"post_id":75968156,"comment_id":133991561,"body_markdown":"I have edited my question and added the code I use to index each document.","body":"I have edited my question and added the code I use to index each document."}],"answers":[{"tags":[],"owner":{"account_id":12743722,"reputation":19966,"user_id":12567365,"display_name":"andrewJames"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1681061326,"creation_date":1681061326,"answer_id":75971944,"question_id":75968156,"body_markdown":"You want to print specific field data:\r\n\r\n&gt; &quot;_from the documents between two docIDs_&quot;\r\n\r\nThe missing example you specifically mentioned was **&quot;file type&quot;** - for example:\r\n\r\n```java\r\ndoc.add(new StringField(&quot;type&quot;, &quot;isDirectory&quot;, Field.Store.YES));\r\n```\r\n\r\nYour code is expecting to be able to access this field using:\r\n\r\n```java\r\nFields fields = reader.getTermVectors(id);\r\n```\r\n\r\nBut the `type` field is not a term vector. It&#39;s a [StringField](https://lucene.apache.org/core/9_4_2/core/org/apache/lucene/document/StringField.html), which is:\r\n\r\n&gt; A field that is indexed but not tokenized: the entire String value is indexed as a single token.\r\n\r\nInstead you can get this field using the following:\r\n\r\n```java\r\nreader.document(id).getFields()\r\n```\r\n\r\nFor example (I chose to use a `forEach` here - but you can use your loop also):\r\n\r\n```java\r\nfor (int id = 0; id &lt; 1; id++) {\r\n    reader.document(id).getFields()\r\n        .forEach(field -&gt; System.out.println(field.name() \r\n        + &quot; - &quot; + field.stringValue()));\r\n}\r\n```\r\n\r\nFor my `type` example, the above code prints:\r\n\r\n    type - isDirectory\r\n\r\n---\r\n\r\nThank you for the edits to your question. It&#39;s difficult to use these edits, as they do not provide a [mre](https://stackoverflow.com/help/minimal-reproducible-example) - there are references to other methods, whereas some hard-coded data would probably be more helpful - for example, like my sample:\r\n\r\n    doc.add(new StringField(&quot;type&quot;, &quot;isDirectory&quot;, Field.Store.YES));\r\n\r\nThis is self-contained and does not rely on any files or other methods not shown in your question.\r\n\r\nIf there are additional missing fields in your output, you can take a look at what types of fields those are - and maybe provide a hard-coded data example.\r\n\r\nIt may even be worth asking a new, more focused question for these.","title":"How can I print all terms from a Lucene Document?","body":"<p>You want to print specific field data:</p>\n<blockquote>\n<p>&quot;<em>from the documents between two docIDs</em>&quot;</p>\n</blockquote>\n<p>The missing example you specifically mentioned was <strong>&quot;file type&quot;</strong> - for example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>doc.add(new StringField(&quot;type&quot;, &quot;isDirectory&quot;, Field.Store.YES));\n</code></pre>\n<p>Your code is expecting to be able to access this field using:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Fields fields = reader.getTermVectors(id);\n</code></pre>\n<p>But the <code>type</code> field is not a term vector. It's a <a href=\"https://lucene.apache.org/core/9_4_2/core/org/apache/lucene/document/StringField.html\" rel=\"nofollow noreferrer\">StringField</a>, which is:</p>\n<blockquote>\n<p>A field that is indexed but not tokenized: the entire String value is indexed as a single token.</p>\n</blockquote>\n<p>Instead you can get this field using the following:</p>\n<pre class=\"lang-java prettyprint-override\"><code>reader.document(id).getFields()\n</code></pre>\n<p>For example (I chose to use a <code>forEach</code> here - but you can use your loop also):</p>\n<pre class=\"lang-java prettyprint-override\"><code>for (int id = 0; id &lt; 1; id++) {\n    reader.document(id).getFields()\n        .forEach(field -&gt; System.out.println(field.name() \n        + &quot; - &quot; + field.stringValue()));\n}\n</code></pre>\n<p>For my <code>type</code> example, the above code prints:</p>\n<pre><code>type - isDirectory\n</code></pre>\n<hr />\n<p>Thank you for the edits to your question. It's difficult to use these edits, as they do not provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mre</a> - there are references to other methods, whereas some hard-coded data would probably be more helpful - for example, like my sample:</p>\n<pre><code>doc.add(new StringField(&quot;type&quot;, &quot;isDirectory&quot;, Field.Store.YES));\n</code></pre>\n<p>This is self-contained and does not rely on any files or other methods not shown in your question.</p>\n<p>If there are additional missing fields in your output, you can take a look at what types of fields those are - and maybe provide a hard-coded data example.</p>\n<p>It may even be worth asking a new, more focused question for these.</p>\n"}],"owner":{"account_id":26976979,"reputation":33,"user_id":20541994,"display_name":"David"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":215,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75971944,"answer_count":1,"score":0,"last_activity_date":1681061326,"creation_date":1680997597,"question_id":75968156,"body_markdown":"I am trying to print all terms from the documents between two docID. But some terms that I had indexed aren&#39;t printed.\r\n\r\nSorry because some things are written in Spain due to it&#39;s a project for my spanish university.\r\n\r\nI have this code:\r\n\r\n```\r\npackage simpledemo;\r\n\r\nimport java.nio.file.Paths;\r\nimport java.util.List;\r\nimport java.util.ArrayList;\r\n\r\nimport org.apache.lucene.index.IndexReader;\r\nimport org.apache.lucene.index.Term;\r\nimport org.apache.lucene.index.Terms;\r\nimport org.apache.lucene.index.TermsEnum;\r\nimport org.apache.lucene.index.Fields;\r\nimport org.apache.lucene.search.IndexSearcher;\r\nimport org.apache.lucene.search.similarities.Similarity;\r\nimport org.apache.lucene.document.Document;\r\nimport org.apache.lucene.index.DirectoryReader;\r\nimport org.apache.lucene.store.FSDirectory;\r\nimport org.apache.lucene.util.BytesRef;\r\n//import org.apache.lucene.search.similarities.DefaultSimilarity; // FIXME No se pq no detecta esto si aparece en el API de Lucene\r\n\r\npublic class TopTermsInDocs {\r\n\r\n\r\n    public static void main(String[] args) {\r\n        // TODO Poner bien el paquete al que pertenece cd ordenemos el codigo\r\n        String usage = &quot;simpledemo.TopTermsInDocs&quot;\r\n        + &quot;[-index INDEX_PATH] [-docID INT1-INT2] [-top N] [-outfile PATH]\\n&quot;\r\n        + &quot;The result will be displayed on screen and in a file to be indicated in&quot;\r\n        + &quot;the -outfile path argument, will show for each document its&quot;\r\n        + &quot;docId and the top n terms with its tf, df and tf x idflog10&quot;;\r\n\r\n        String indexPath = null; // TODO mirar si poner uno por defecto o hacer que falle\r\n        String[] range = null;\r\n        Integer docIdStart = null;\r\n        Integer docIdEnd = null;\r\n        Integer topN = null;\r\n        String outPath = null;\r\n        System.out.println(usage);\r\n\r\n        for (int i = 0; i &lt; args.length; i++) {\r\n            switch(args[i]) {\r\n                case &quot;-index&quot;: \r\n                    indexPath = args[++i];\r\n                    break;\r\n                case &quot;-docID&quot;:\r\n                    range = args[++i].split(&quot;-&quot;);\r\n                    docIdStart = Integer.parseInt(range[0]);\r\n                    docIdEnd = Integer.parseInt(range[1]);\r\n                    break;\r\n                case &quot;-top&quot;:\r\n                    topN = Integer.parseInt(args[++i]);\r\n                    break;\r\n                case &quot;-outfile&quot;:\r\n                    outPath = args[++i];\r\n            } \r\n        }\r\n        IndexReader reader = null; //Ls inicializo aqui a null pq sino no los voy a poder usar fuera del try\r\n        // FIXME descomentar cd lo reconozca       DefaultSimilarity similarity = new DefaultSimilarity();\r\n        try {\r\n            reader = DirectoryReader.open(FSDirectory.open(Paths.get(indexPath)));\r\n\r\n            int numDocs = reader.numDocs(); // Numero de documentos total\r\n\r\n            for(int id = docIdStart; id&lt;docIdEnd; id++) {\r\n                System.out.println(&quot;Voy a printear el docID: &quot; + id);\r\n                Fields fields = reader.getTermVectors(id); //Obtengo todos los terminos del documento\r\n\r\n                for (String fieldName : fields) {\r\n                    Terms terms = fields.terms(fieldName);\r\n                    TermsEnum termsEnum = terms.iterator();\r\n                    BytesRef term = null;\r\n\r\n                    while((term = termsEnum.next()) != null) {\r\n                        String termText = term.utf8ToString();\r\n                        long termFreq = termsEnum.totalTermFreq(); //Frecuencia total del termino\r\n                        int docFreq = termsEnum.docFreq(); //Frecuencia de documento\r\n                        int tf = (int) Math.round(termFreq / docFreq); //Frecuencia del termino en el documento\r\n                        // FIXME descomentar cd lo reconozca    double idf = similarity.idf(docFreq, numDocs);\r\n                        int idf = (int) Math.log(numDocs/(docFreq+1)) + 1;\r\n                        System.out.println(&quot;Campo: &quot; + fieldName + &quot; - T&#233;rmino: &quot; + termText + &quot; - tf: &quot; + tf + &quot; - idf: &quot; + idf);\r\n                        //TODO primero probar si funciona y si funciona puedo hacer una funcion que devuelva una estructura con todo\r\n                    }\r\n\r\n                }\r\n\r\n                System.out.println(&quot;\\n\\n&quot;);\r\n            }\r\n\r\n        } catch (Exception e) {\r\n            // TODO: handle exception\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    }\r\n}\r\n```\r\n\r\nI know -top and -outfile options aren&#39;t implemented for the moment. But it doesn&#39;t matter for the problem.\r\n\r\nWhen I execute it for a single document it shows:\r\n\r\n```\r\nCampo: LastModifiedTimeLucene - T&#233;rmino: 20230408150702014 - tf: 1 - idf: 2\r\nCampo: contents - T&#233;rmino: david - tf: 1 - idf: 2\r\nCampo: contents - T&#233;rmino: hola2 - tf: 1 - idf: 2\r\nCampo: contents - T&#233;rmino: txt - tf: 1 - idf: 2\r\nCampo: creationTime - T&#233;rmino: 2023-04-08 17:07:02 - tf: 1 - idf: 2\r\nCampo: creationTimeLucene - T&#233;rmino: 20230408150702014 - tf: 1 - idf: 2\r\nCampo: lastAccessTime - T&#233;rmino: 2023-04-09 01:10:26 - tf: 1 - idf: 2\r\nCampo: lastAccessTimeLucene - T&#233;rmino: 20230408231026954 - tf: 1 - idf: 2\r\nCampo: lastModifiedTime - T&#233;rmino: 2023-04-08 17:07:02 - tf: 1 - idf: 2\r\n```\r\n\r\nAbout the creation of the documents I have this function: \r\n```/** Indexes a single document */\r\n    void indexDoc(IndexWriter writer, Path file, long lastModified) throws IOException {\r\n    \tSystem.out.println(file.getFileName().toString());\r\n        // TODO A&#241;adir la funcionalidad de onlyLines\r\n        if(config.validateFile(file.getFileName().toString()))\r\n        {\r\n            try (InputStream stream = Files.newInputStream(file)) {\r\n                // make a new, empty document\r\n                Document doc = new Document();\r\n                \r\n                // Add the path of the file as a field named &quot;path&quot;. Use a\r\n                // field that is indexed (i.e. searchable), but don&#39;t tokenize\r\n                // the field into separate words and don&#39;t index term frequency\r\n                // or positional information:\r\n                Field pathField = new StringField(&quot;path&quot;, file.toString(), Field.Store.YES);\r\n                doc.add(pathField);\r\n                \r\n                String contents = obtainContents(stream);\r\n                \r\n                FieldType tmp_field_type = new FieldType();\r\n                \r\n                tmp_field_type.setTokenized(true);\r\n                tmp_field_type.setIndexOptions(IndexOptions.DOCS_AND_FREQS_AND_POSITIONS_AND_OFFSETS);\r\n                tmp_field_type.setStoreTermVectors(contentsTermVectors);\r\n                tmp_field_type.setStoreTermVectorPositions(contentsTermVectors);\r\n                tmp_field_type.setStored(contentsStored);\r\n                tmp_field_type.freeze();\r\n                \r\n                // Add the contents of the file to a field named &quot;contents&quot;. Specify a Reader,\r\n                // so that the text of the file is tokenized and indexed, but not stored.\r\n                // Note that FileReader expects the file to be in UTF-8 encoding.\r\n                // If that&#39;s not the case searching for special characters will fail.\r\n                \r\n                Field contentsField = new Field(&quot;contents&quot;, contents, tmp_field_type);\r\n                doc.add(contentsField);\r\n\r\n                // TODO Extender documentacion\r\n                Field hostnameField = new StringField(&quot;hostname&quot;, InetAddress.getLocalHost().getHostName(), Field.Store.YES);\r\n                doc.add(hostnameField);\r\n    \r\n                // TODO Extender documentacion\r\n                Field threadField = new StringField(&quot;thread&quot;, Thread.currentThread().getName(), Field.Store.YES);\r\n                doc.add(threadField);\r\n                \r\n                // TODO Extender documentacion\r\n                \r\n                BasicFileAttributes at = Files.readAttributes(file, BasicFileAttributes.class);\r\n                String type;\r\n                if (at.isDirectory()) type = &quot;isDirectory&quot;;\r\n                else if (at.isRegularFile()) type = &quot;isRegularFile&quot;;\r\n                else if (at.isSymbolicLink()) type = &quot;iSSymbolicLink&quot;;\r\n                else if (at.isOther()) type = &quot;isOther&quot;;\r\n                else type = &quot;error&quot;;\r\n\r\n                doc.add(new StringField(&quot;type&quot;, type, Field.Store.YES));\r\n                \r\n                // TODO Extender documentacion\r\n                \r\n                doc.add(new LongPoint(&quot;sizeKB&quot;, at.size())); // ! CUIDAO\r\n                doc.add(new StoredField(&quot;sizeKB&quot;, at.size()));\r\n\r\n                // Add the last modified date of the file a field named &quot;modified&quot;.\r\n                // Use a LongPoint that is indexed (i.e. efficiently filterable with\r\n                // PointRangeQuery). This indexes to milli-second resolution, which\r\n                // is often too fine. You could instead create a number based on\r\n                // year/month/day/hour/minutes/seconds, down the resolution you require.\r\n                // For example the long value 2011021714 would mean\r\n                // February 17, 2011, 2-3 PM.\r\n                doc.add(new LongPoint(&quot;modified&quot;, lastModified));\r\n                doc.add(new StoredField(&quot;modified&quot;, lastModified));\r\n    \r\n                \r\n                String dateFormat = &quot;yyyy-MM-dd HH:mm:ss&quot;;\r\n                SimpleDateFormat simpleDateFormat = new SimpleDateFormat(dateFormat);\r\n\r\n                FileTime creationTime = at.creationTime();\r\n                String creationTimeFormateado = simpleDateFormat.format(new Date(creationTime.toMillis()));\r\n                doc.add(new Field(&quot;creationTime&quot;, creationTimeFormateado, TYPE_STORED));\r\n\r\n                FileTime lastAccessTime = at.lastAccessTime();\r\n                String lastAccessTimeFormateado = simpleDateFormat.format(new Date(lastAccessTime.toMillis()));\r\n                doc.add(new Field(&quot;lastAccessTime&quot;, lastAccessTimeFormateado, TYPE_STORED));\r\n\r\n                FileTime lastModifiedTime = at.lastModifiedTime();\r\n                String lastTimeModifiedTimeFormateado = simpleDateFormat.format(new Date(lastModifiedTime.toMillis()));\r\n                doc.add(new Field(&quot;lastModifiedTime&quot;, lastTimeModifiedTimeFormateado, TYPE_STORED));\r\n\r\n                Date creationTimelucene = new Date(creationTime.toMillis());\r\n                String s1 = DateTools.dateToString(creationTimelucene, DateTools.Resolution.MILLISECOND);\r\n                doc.add(new Field(&quot;creationTimeLucene&quot;, s1, TYPE_STORED));\r\n\r\n                Date lastAccessTimelucene = new Date(lastAccessTime.toMillis());\r\n                String s2 = DateTools.dateToString(lastAccessTimelucene, DateTools.Resolution.MILLISECOND);\r\n                doc.add(new Field(&quot;lastAccessTimeLucene&quot;, s2, TYPE_STORED));\r\n\r\n                Date lastModifiedTimelucene = new Date(lastModifiedTime.toMillis());\r\n                String s3 = DateTools.dateToString(lastModifiedTimelucene, DateTools.Resolution.MILLISECOND);\r\n                doc.add(new Field(&quot;LastModifiedTimeLucene&quot;, s3, TYPE_STORED));\r\n                \r\n                if (demoEmbeddings != null) {\r\n                    try (InputStream in = Files.newInputStream(file)) {\r\n                        float[] vector = demoEmbeddings.computeEmbedding(\r\n                                new BufferedReader(new InputStreamReader(in, StandardCharsets.UTF_8)));\r\n                        doc.add(\r\n                                new KnnVectorField(&quot;contents-vector&quot;, vector, VectorSimilarityFunction.DOT_PRODUCT));\r\n                    }\r\n                }\r\n    \r\n                if (writer.getConfig().getOpenMode() == OpenMode.CREATE) {\r\n                    // New index, so we just add the document (no old document can be there):\r\n                    System.out.println(&quot;adding &quot; + file);\r\n                    writer.addDocument(doc);\r\n                } else {\r\n                    // Existing index (an old copy of this document may have been indexed) so\r\n                    // we use updateDocument instead to replace the old one matching the exact\r\n                    // path, if present:\r\n                    System.out.println(&quot;updating &quot; + file);\r\n                    writer.updateDocument(new Term(&quot;path&quot;, file.toString()), doc);\r\n                }\r\n            }\r\n        }\r\n        else\r\n            System.out.println(&quot;Este archivo va a ser ignorado&quot;);\r\n    }```\r\n\r\nBut I have indexed more fields for the document, like file type. Why are they not shown?","title":"How can I print all terms from a Lucene Document?","body":"<p>I am trying to print all terms from the documents between two docID. But some terms that I had indexed aren't printed.</p>\n<p>Sorry because some things are written in Spain due to it's a project for my spanish university.</p>\n<p>I have this code:</p>\n<pre><code>package simpledemo;\n\nimport java.nio.file.Paths;\nimport java.util.List;\nimport java.util.ArrayList;\n\nimport org.apache.lucene.index.IndexReader;\nimport org.apache.lucene.index.Term;\nimport org.apache.lucene.index.Terms;\nimport org.apache.lucene.index.TermsEnum;\nimport org.apache.lucene.index.Fields;\nimport org.apache.lucene.search.IndexSearcher;\nimport org.apache.lucene.search.similarities.Similarity;\nimport org.apache.lucene.document.Document;\nimport org.apache.lucene.index.DirectoryReader;\nimport org.apache.lucene.store.FSDirectory;\nimport org.apache.lucene.util.BytesRef;\n//import org.apache.lucene.search.similarities.DefaultSimilarity; // FIXME No se pq no detecta esto si aparece en el API de Lucene\n\npublic class TopTermsInDocs {\n\n\n    public static void main(String[] args) {\n        // TODO Poner bien el paquete al que pertenece cd ordenemos el codigo\n        String usage = &quot;simpledemo.TopTermsInDocs&quot;\n        + &quot;[-index INDEX_PATH] [-docID INT1-INT2] [-top N] [-outfile PATH]\\n&quot;\n        + &quot;The result will be displayed on screen and in a file to be indicated in&quot;\n        + &quot;the -outfile path argument, will show for each document its&quot;\n        + &quot;docId and the top n terms with its tf, df and tf x idflog10&quot;;\n\n        String indexPath = null; // TODO mirar si poner uno por defecto o hacer que falle\n        String[] range = null;\n        Integer docIdStart = null;\n        Integer docIdEnd = null;\n        Integer topN = null;\n        String outPath = null;\n        System.out.println(usage);\n\n        for (int i = 0; i &lt; args.length; i++) {\n            switch(args[i]) {\n                case &quot;-index&quot;: \n                    indexPath = args[++i];\n                    break;\n                case &quot;-docID&quot;:\n                    range = args[++i].split(&quot;-&quot;);\n                    docIdStart = Integer.parseInt(range[0]);\n                    docIdEnd = Integer.parseInt(range[1]);\n                    break;\n                case &quot;-top&quot;:\n                    topN = Integer.parseInt(args[++i]);\n                    break;\n                case &quot;-outfile&quot;:\n                    outPath = args[++i];\n            } \n        }\n        IndexReader reader = null; //Ls inicializo aqui a null pq sino no los voy a poder usar fuera del try\n        // FIXME descomentar cd lo reconozca       DefaultSimilarity similarity = new DefaultSimilarity();\n        try {\n            reader = DirectoryReader.open(FSDirectory.open(Paths.get(indexPath)));\n\n            int numDocs = reader.numDocs(); // Numero de documentos total\n\n            for(int id = docIdStart; id&lt;docIdEnd; id++) {\n                System.out.println(&quot;Voy a printear el docID: &quot; + id);\n                Fields fields = reader.getTermVectors(id); //Obtengo todos los terminos del documento\n\n                for (String fieldName : fields) {\n                    Terms terms = fields.terms(fieldName);\n                    TermsEnum termsEnum = terms.iterator();\n                    BytesRef term = null;\n\n                    while((term = termsEnum.next()) != null) {\n                        String termText = term.utf8ToString();\n                        long termFreq = termsEnum.totalTermFreq(); //Frecuencia total del termino\n                        int docFreq = termsEnum.docFreq(); //Frecuencia de documento\n                        int tf = (int) Math.round(termFreq / docFreq); //Frecuencia del termino en el documento\n                        // FIXME descomentar cd lo reconozca    double idf = similarity.idf(docFreq, numDocs);\n                        int idf = (int) Math.log(numDocs/(docFreq+1)) + 1;\n                        System.out.println(&quot;Campo: &quot; + fieldName + &quot; - Término: &quot; + termText + &quot; - tf: &quot; + tf + &quot; - idf: &quot; + idf);\n                        //TODO primero probar si funciona y si funciona puedo hacer una funcion que devuelva una estructura con todo\n                    }\n\n                }\n\n                System.out.println(&quot;\\n\\n&quot;);\n            }\n\n        } catch (Exception e) {\n            // TODO: handle exception\n        }\n\n\n\n\n\n\n    }\n}\n</code></pre>\n<p>I know -top and -outfile options aren't implemented for the moment. But it doesn't matter for the problem.</p>\n<p>When I execute it for a single document it shows:</p>\n<pre><code>Campo: LastModifiedTimeLucene - Término: 20230408150702014 - tf: 1 - idf: 2\nCampo: contents - Término: david - tf: 1 - idf: 2\nCampo: contents - Término: hola2 - tf: 1 - idf: 2\nCampo: contents - Término: txt - tf: 1 - idf: 2\nCampo: creationTime - Término: 2023-04-08 17:07:02 - tf: 1 - idf: 2\nCampo: creationTimeLucene - Término: 20230408150702014 - tf: 1 - idf: 2\nCampo: lastAccessTime - Término: 2023-04-09 01:10:26 - tf: 1 - idf: 2\nCampo: lastAccessTimeLucene - Término: 20230408231026954 - tf: 1 - idf: 2\nCampo: lastModifiedTime - Término: 2023-04-08 17:07:02 - tf: 1 - idf: 2\n</code></pre>\n<p>About the creation of the documents I have this function:</p>\n<pre><code>    void indexDoc(IndexWriter writer, Path file, long lastModified) throws IOException {\n        System.out.println(file.getFileName().toString());\n        // TODO Añadir la funcionalidad de onlyLines\n        if(config.validateFile(file.getFileName().toString()))\n        {\n            try (InputStream stream = Files.newInputStream(file)) {\n                // make a new, empty document\n                Document doc = new Document();\n                \n                // Add the path of the file as a field named &quot;path&quot;. Use a\n                // field that is indexed (i.e. searchable), but don't tokenize\n                // the field into separate words and don't index term frequency\n                // or positional information:\n                Field pathField = new StringField(&quot;path&quot;, file.toString(), Field.Store.YES);\n                doc.add(pathField);\n                \n                String contents = obtainContents(stream);\n                \n                FieldType tmp_field_type = new FieldType();\n                \n                tmp_field_type.setTokenized(true);\n                tmp_field_type.setIndexOptions(IndexOptions.DOCS_AND_FREQS_AND_POSITIONS_AND_OFFSETS);\n                tmp_field_type.setStoreTermVectors(contentsTermVectors);\n                tmp_field_type.setStoreTermVectorPositions(contentsTermVectors);\n                tmp_field_type.setStored(contentsStored);\n                tmp_field_type.freeze();\n                \n                // Add the contents of the file to a field named &quot;contents&quot;. Specify a Reader,\n                // so that the text of the file is tokenized and indexed, but not stored.\n                // Note that FileReader expects the file to be in UTF-8 encoding.\n                // If that's not the case searching for special characters will fail.\n                \n                Field contentsField = new Field(&quot;contents&quot;, contents, tmp_field_type);\n                doc.add(contentsField);\n\n                // TODO Extender documentacion\n                Field hostnameField = new StringField(&quot;hostname&quot;, InetAddress.getLocalHost().getHostName(), Field.Store.YES);\n                doc.add(hostnameField);\n    \n                // TODO Extender documentacion\n                Field threadField = new StringField(&quot;thread&quot;, Thread.currentThread().getName(), Field.Store.YES);\n                doc.add(threadField);\n                \n                // TODO Extender documentacion\n                \n                BasicFileAttributes at = Files.readAttributes(file, BasicFileAttributes.class);\n                String type;\n                if (at.isDirectory()) type = &quot;isDirectory&quot;;\n                else if (at.isRegularFile()) type = &quot;isRegularFile&quot;;\n                else if (at.isSymbolicLink()) type = &quot;iSSymbolicLink&quot;;\n                else if (at.isOther()) type = &quot;isOther&quot;;\n                else type = &quot;error&quot;;\n\n                doc.add(new StringField(&quot;type&quot;, type, Field.Store.YES));\n                \n                // TODO Extender documentacion\n                \n                doc.add(new LongPoint(&quot;sizeKB&quot;, at.size())); // ! CUIDAO\n                doc.add(new StoredField(&quot;sizeKB&quot;, at.size()));\n\n                // Add the last modified date of the file a field named &quot;modified&quot;.\n                // Use a LongPoint that is indexed (i.e. efficiently filterable with\n                // PointRangeQuery). This indexes to milli-second resolution, which\n                // is often too fine. You could instead create a number based on\n                // year/month/day/hour/minutes/seconds, down the resolution you require.\n                // For example the long value 2011021714 would mean\n                // February 17, 2011, 2-3 PM.\n                doc.add(new LongPoint(&quot;modified&quot;, lastModified));\n                doc.add(new StoredField(&quot;modified&quot;, lastModified));\n    \n                \n                String dateFormat = &quot;yyyy-MM-dd HH:mm:ss&quot;;\n                SimpleDateFormat simpleDateFormat = new SimpleDateFormat(dateFormat);\n\n                FileTime creationTime = at.creationTime();\n                String creationTimeFormateado = simpleDateFormat.format(new Date(creationTime.toMillis()));\n                doc.add(new Field(&quot;creationTime&quot;, creationTimeFormateado, TYPE_STORED));\n\n                FileTime lastAccessTime = at.lastAccessTime();\n                String lastAccessTimeFormateado = simpleDateFormat.format(new Date(lastAccessTime.toMillis()));\n                doc.add(new Field(&quot;lastAccessTime&quot;, lastAccessTimeFormateado, TYPE_STORED));\n\n                FileTime lastModifiedTime = at.lastModifiedTime();\n                String lastTimeModifiedTimeFormateado = simpleDateFormat.format(new Date(lastModifiedTime.toMillis()));\n                doc.add(new Field(&quot;lastModifiedTime&quot;, lastTimeModifiedTimeFormateado, TYPE_STORED));\n\n                Date creationTimelucene = new Date(creationTime.toMillis());\n                String s1 = DateTools.dateToString(creationTimelucene, DateTools.Resolution.MILLISECOND);\n                doc.add(new Field(&quot;creationTimeLucene&quot;, s1, TYPE_STORED));\n\n                Date lastAccessTimelucene = new Date(lastAccessTime.toMillis());\n                String s2 = DateTools.dateToString(lastAccessTimelucene, DateTools.Resolution.MILLISECOND);\n                doc.add(new Field(&quot;lastAccessTimeLucene&quot;, s2, TYPE_STORED));\n\n                Date lastModifiedTimelucene = new Date(lastModifiedTime.toMillis());\n                String s3 = DateTools.dateToString(lastModifiedTimelucene, DateTools.Resolution.MILLISECOND);\n                doc.add(new Field(&quot;LastModifiedTimeLucene&quot;, s3, TYPE_STORED));\n                \n                if (demoEmbeddings != null) {\n                    try (InputStream in = Files.newInputStream(file)) {\n                        float[] vector = demoEmbeddings.computeEmbedding(\n                                new BufferedReader(new InputStreamReader(in, StandardCharsets.UTF_8)));\n                        doc.add(\n                                new KnnVectorField(&quot;contents-vector&quot;, vector, VectorSimilarityFunction.DOT_PRODUCT));\n                    }\n                }\n    \n                if (writer.getConfig().getOpenMode() == OpenMode.CREATE) {\n                    // New index, so we just add the document (no old document can be there):\n                    System.out.println(&quot;adding &quot; + file);\n                    writer.addDocument(doc);\n                } else {\n                    // Existing index (an old copy of this document may have been indexed) so\n                    // we use updateDocument instead to replace the old one matching the exact\n                    // path, if present:\n                    System.out.println(&quot;updating &quot; + file);\n                    writer.updateDocument(new Term(&quot;path&quot;, file.toString()), doc);\n                }\n            }\n        }\n        else\n            System.out.println(&quot;Este archivo va a ser ignorado&quot;);\n    }```\n\nBut I have indexed more fields for the document, like file type. Why are they not shown?\n</code></pre>\n"},{"tags":["java","spring-boot","spring-data-jpa"],"answers":[{"tags":[],"owner":{"account_id":1111053,"reputation":1359,"user_id":1101512,"accept_rate":78,"display_name":"Sudhir"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1566915473,"creation_date":1566915473,"answer_id":57676701,"question_id":57676086,"body_markdown":"If you use JPA, object auditing frameworks like [hibernate envers][1] or [javers][2] might help\r\n\r\n\r\n  [1]: http://hibernate.org/orm/envers/\r\n  [2]: https://javers.org/","title":"How to implement history data changes with Spring Boot/Spring Data","body":"<p>If you use JPA, object auditing frameworks like <a href=\"http://hibernate.org/orm/envers/\" rel=\"nofollow noreferrer\">hibernate envers</a> or <a href=\"https://javers.org/\" rel=\"nofollow noreferrer\">javers</a> might help</p>\n"},{"tags":[],"owner":{"account_id":9774998,"reputation":3031,"user_id":7245379,"display_name":"eHayik"},"comment_count":0,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1681060825,"creation_date":1566915887,"answer_id":57676840,"question_id":57676086,"body_markdown":"You can use **Hibernate Envers** to audit and version your persistence entities changes.\r\n\r\n&gt;  The Envers project aims to enable easy auditing of persistent\r\n&gt; classes. All that you have to do is annotate your persistent class or\r\n&gt; some of its properties, that you want to audit, with @Audited. For\r\n&gt; each audited entity, a table will be created, which will hold the\r\n&gt; history of changes made to the entity. You can then retrieve and query\r\n&gt; historical data without much effort.\r\n&gt; \r\n&gt; Similarly to Subversion, the library has a concept of revisions.\r\n&gt; Basically, one transaction is one revision (unless the transaction\r\n&gt; didn&#39;t modify any audited entities). As the revisions are global,\r\n&gt; having a revision number, you can query for various entities at that\r\n&gt; revision, retrieving a (partial) view of the database at that\r\n&gt; revision. You can find a revision number having a date, and the other\r\n&gt; way round, you can get the date at which a revision was commited.\r\n&gt; \r\n&gt; The library works with Hibernate and requires Hibernate Annotations or\r\n&gt; Entity Manager. For the auditing to work properly, the entities must\r\n&gt; have immutable unique identifiers (primary keys). You can use Envers\r\n&gt; wherever Hibernate works: standalone, inside JBoss AS, with JBoss Seam\r\n&gt; or Spring. [source][1]\r\n&gt;\r\n&gt; You can query for historic data in a way similar to querying data via\r\n&gt; the Hibernate criteria API. The audit history of an entity can be\r\n&gt; accessed using the `AuditReader` interface, which can be obtained with\r\n&gt; an open `EntityManager` or `Session` via the `AuditReaderFactory`. [source][2]\r\n\r\nWith ***Hibernate Envers*** the 80% of the task is done. You can record your data changes, then access it, either using your persistence context or SQL to apply your version changes using the provide revision id.\r\n\r\nFurthermore, you may read the articles listed below:\r\n\r\n- [Setting up Hibernate Envers with Spring Boot][3]\r\n\r\n- [Auditing with JPA, Hibernate, and Spring Data JPA][2]\r\n\r\n- [Hibernate Envers: Simple Implementations][4]\r\n\r\n\r\n  [1]: https://docs.jboss.org/envers/docs/#preface\r\n  [2]: https://www.baeldung.com/database-auditing-jpa\r\n  [3]: http://progressivecoder.com/setting-hibernate-envers-spring-boot/\r\n  [4]: https://dzone.com/articles/hibernate-envers-with-simple-implementations","title":"How to implement history data changes with Spring Boot/Spring Data","body":"<p>You can use <strong>Hibernate Envers</strong> to audit and version your persistence entities changes.</p>\n<blockquote>\n<p>The Envers project aims to enable easy auditing of persistent\nclasses. All that you have to do is annotate your persistent class or\nsome of its properties, that you want to audit, with @Audited. For\neach audited entity, a table will be created, which will hold the\nhistory of changes made to the entity. You can then retrieve and query\nhistorical data without much effort.</p>\n<p>Similarly to Subversion, the library has a concept of revisions.\nBasically, one transaction is one revision (unless the transaction\ndidn't modify any audited entities). As the revisions are global,\nhaving a revision number, you can query for various entities at that\nrevision, retrieving a (partial) view of the database at that\nrevision. You can find a revision number having a date, and the other\nway round, you can get the date at which a revision was commited.</p>\n<p>The library works with Hibernate and requires Hibernate Annotations or\nEntity Manager. For the auditing to work properly, the entities must\nhave immutable unique identifiers (primary keys). You can use Envers\nwherever Hibernate works: standalone, inside JBoss AS, with JBoss Seam\nor Spring. <a href=\"https://docs.jboss.org/envers/docs/#preface\" rel=\"nofollow noreferrer\">source</a></p>\n<p>You can query for historic data in a way similar to querying data via\nthe Hibernate criteria API. The audit history of an entity can be\naccessed using the <code>AuditReader</code> interface, which can be obtained with\nan open <code>EntityManager</code> or <code>Session</code> via the <code>AuditReaderFactory</code>. <a href=\"https://www.baeldung.com/database-auditing-jpa\" rel=\"nofollow noreferrer\">source</a></p>\n</blockquote>\n<p>With <em><strong>Hibernate Envers</strong></em> the 80% of the task is done. You can record your data changes, then access it, either using your persistence context or SQL to apply your version changes using the provide revision id.</p>\n<p>Furthermore, you may read the articles listed below:</p>\n<ul>\n<li><p><a href=\"http://progressivecoder.com/setting-hibernate-envers-spring-boot/\" rel=\"nofollow noreferrer\">Setting up Hibernate Envers with Spring Boot</a></p>\n</li>\n<li><p><a href=\"https://www.baeldung.com/database-auditing-jpa\" rel=\"nofollow noreferrer\">Auditing with JPA, Hibernate, and Spring Data JPA</a></p>\n</li>\n<li><p><a href=\"https://dzone.com/articles/hibernate-envers-with-simple-implementations\" rel=\"nofollow noreferrer\">Hibernate Envers: Simple Implementations</a></p>\n</li>\n</ul>\n"}],"owner":{"account_id":1685633,"reputation":61,"user_id":5927256,"display_name":"user5927256"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":17491,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"answer_count":2,"score":3,"last_activity_date":1681060825,"creation_date":1566913606,"question_id":57676086,"body_markdown":"The problem is how to implement tracking of data changes on e.g. master detail tables i.e. two entities in one to many relationship in Spring Boot/Spring Data.\r\n\r\nAfter storing data, to be able to get the master entity with its details at specific version, and to have functionality to revert it to specific version.","title":"How to implement history data changes with Spring Boot/Spring Data","body":"<p>The problem is how to implement tracking of data changes on e.g. master detail tables i.e. two entities in one to many relationship in Spring Boot/Spring Data.</p>\n\n<p>After storing data, to be able to get the master entity with its details at specific version, and to have functionality to revert it to specific version.</p>\n"},{"tags":["java","spring","spring-data-jpa","mapstruct","apache-commons-beanutils"],"answers":[{"tags":[],"owner":{"account_id":24109083,"reputation":150,"user_id":18079889,"display_name":"Mohammed Fataka"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1680999544,"creation_date":1680999133,"answer_id":75968222,"question_id":75962053,"body_markdown":"you can avoid null checks by adding validations on the object level, spring provides ```@Valid``` annotation, you can check more [here at baeldung](https://www.baeldung.com/spring-valid-vs-validated) to make object validated and avoid null checks, other options would be using ```Preconditions```from google, or handling it on the entity level, which you annotate columns that are non null and let your method not check but rather just save and repository will throw because null was passed and you can handle the exception by returning some message or failed response, [check here](https://www.baeldung.com/hibernate-notnull-vs-nullable) for making columns non null ","title":"how to avoid null check on jpa update","body":"<p>you can avoid null checks by adding validations on the object level, spring provides <code>@Valid</code> annotation, you can check more <a href=\"https://www.baeldung.com/spring-valid-vs-validated\" rel=\"nofollow noreferrer\">here at baeldung</a> to make object validated and avoid null checks, other options would be using <code>Preconditions</code>from google, or handling it on the entity level, which you annotate columns that are non null and let your method not check but rather just save and repository will throw because null was passed and you can handle the exception by returning some message or failed response, <a href=\"https://www.baeldung.com/hibernate-notnull-vs-nullable\" rel=\"nofollow noreferrer\">check here</a> for making columns non null</p>\n"},{"tags":[],"owner":{"account_id":10467026,"reputation":534,"user_id":7716142,"display_name":"minh tri Vo"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1681017563,"creation_date":1681017563,"answer_id":75968897,"question_id":75962053,"body_markdown":"&gt; do I need to use Map structs or BeanUtils.copyProperties or what is the best way to achieve these?\r\n\r\nYes, for me, Mapstruct perfectly suits your purpose, for example:\r\n\r\n    @Mapper(uses = DateMapper.class)\r\n    public interface TestMapper {\r\n\r\n        @BeanMapping(nullValuePropertyMappingStrategy = NullValuePropertyMappingStrategy.IGNORE) // if a source&#39;s property is null, ignore it\r\n        @Mapping(source = &quot;differentValue&quot;, target = &quot;value&quot;) // Map to different property name\r\n        void updateAppearanceFromDto(@MappingTarget Test mappingTarget, TestDto appearanceRequestDto); \r\n    }\r\n \r\n    // help with different type cast\r\n    class DateMapper {\r\n       public Date asDate(String date) {\r\n          return Date.valueOf(date);\r\n       }\r\n    }\r\n\r\n\r\nOf course, if your project only requires the null-check-then-set on this entity only, manually doing it would be better because of the cost of dependency overhead.","title":"how to avoid null check on jpa update","body":"<blockquote>\n<p>do I need to use Map structs or BeanUtils.copyProperties or what is the best way to achieve these?</p>\n</blockquote>\n<p>Yes, for me, Mapstruct perfectly suits your purpose, for example:</p>\n<pre><code>@Mapper(uses = DateMapper.class)\npublic interface TestMapper {\n\n    @BeanMapping(nullValuePropertyMappingStrategy = NullValuePropertyMappingStrategy.IGNORE) // if a source's property is null, ignore it\n    @Mapping(source = &quot;differentValue&quot;, target = &quot;value&quot;) // Map to different property name\n    void updateAppearanceFromDto(@MappingTarget Test mappingTarget, TestDto appearanceRequestDto); \n}\n\n// help with different type cast\nclass DateMapper {\n   public Date asDate(String date) {\n      return Date.valueOf(date);\n   }\n}\n</code></pre>\n<p>Of course, if your project only requires the null-check-then-set on this entity only, manually doing it would be better because of the cost of dependency overhead.</p>\n"}],"owner":{"account_id":926701,"reputation":1165,"user_id":957359,"accept_rate":47,"display_name":"jcrshankar"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":69,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1681060639,"creation_date":1680902741,"question_id":75962053,"body_markdown":"I want to avoid `null check` while updating the value into `database`. but i need to update only the value that is coming from `UpdateUserRequest` object. how to avoid multiple null check? the source and destination has different name? do I need to use `Map structs` or `BeanUtils.copyProperties` or what is the best way to achieve these?\r\n\r\n    @Transactional\r\n    public void update(String userId, UpdateUserRequest updateUserRequest) {\r\n        dataRepository.findByUserId(userId)\r\n                .ifPresent(userTransaction -&gt; {\r\n                    if(updateUserRequest.getAccountId()!=null)\r\n                    {\r\n                        userTransaction.setAccountId(updateUserRequest.getAccountId());\r\n                    }\r\n                    if(updateUserRequest.getUserAmount()!=null)\r\n                    {\r\n                        userTransaction.setUserAmount(updateUserRequest.getUserAmount());\r\n                    }\r\n                    if(updateUserRequest.getSendDate() != null)\r\n                    {\r\n                        userTransaction.setUserRequestedDate(Date.valueOf(updateUserRequest.getSendDate()));\r\n                    }\r\n\r\n                    if(updateUserRequest.getDelDate() != null)\r\n                    {\r\n                        userTransaction.setDelDate(Date.valueOf(updateUserRequest.getDelDate()));\r\n                    }\r\n\r\n                    dataRepository.save(userTransaction);\r\n                });\r\n    }\r\n    \r\n   ","title":"how to avoid null check on jpa update","body":"<p>I want to avoid <code>null check</code> while updating the value into <code>database</code>. but i need to update only the value that is coming from <code>UpdateUserRequest</code> object. how to avoid multiple null check? the source and destination has different name? do I need to use <code>Map structs</code> or <code>BeanUtils.copyProperties</code> or what is the best way to achieve these?</p>\n<pre><code>@Transactional\npublic void update(String userId, UpdateUserRequest updateUserRequest) {\n    dataRepository.findByUserId(userId)\n            .ifPresent(userTransaction -&gt; {\n                if(updateUserRequest.getAccountId()!=null)\n                {\n                    userTransaction.setAccountId(updateUserRequest.getAccountId());\n                }\n                if(updateUserRequest.getUserAmount()!=null)\n                {\n                    userTransaction.setUserAmount(updateUserRequest.getUserAmount());\n                }\n                if(updateUserRequest.getSendDate() != null)\n                {\n                    userTransaction.setUserRequestedDate(Date.valueOf(updateUserRequest.getSendDate()));\n                }\n\n                if(updateUserRequest.getDelDate() != null)\n                {\n                    userTransaction.setDelDate(Date.valueOf(updateUserRequest.getDelDate()));\n                }\n\n                dataRepository.save(userTransaction);\n            });\n}\n</code></pre>\n"},{"tags":["java","multithreading","concurrency","virtual","project-loom"],"comments":[{"owner":{"account_id":318397,"reputation":203598,"user_id":635608,"display_name":"Mat"},"score":0,"creation_date":1672413172,"post_id":74963003,"comment_id":132285898,"body_markdown":"You forgot the language tag.","body":"You forgot the language tag."},{"owner":{"account_id":3211603,"reputation":289317,"user_id":2711488,"display_name":"Holger"},"score":3,"creation_date":1672738990,"post_id":74963003,"comment_id":132337486,"body_markdown":"Virtual threads do not change the fact that submitting short actions to other threads may degrade performance. Though, I can not reproduce your results with JDK&#160;19. The divergence may be caused by the actual nature of your tasks.","body":"Virtual threads do not change the fact that submitting short actions to other threads may degrade performance. Though, I can not reproduce your results with JDK 19. The divergence may be caused by the actual nature of your tasks."},{"owner":{"account_id":26599161,"reputation":41,"user_id":20221035,"display_name":"ljm599"},"score":0,"creation_date":1672762533,"post_id":74963003,"comment_id":132345185,"body_markdown":"Good to know. Increases the likelihood that something dumb is happening. If I find it out I will post ...","body":"Good to know. Increases the likelihood that something dumb is happening. If I find it out I will post ..."}],"answers":[{"tags":[],"owner":{"account_id":26599161,"reputation":41,"user_id":20221035,"display_name":"ljm599"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681060416,"creation_date":1681060416,"answer_id":75971875,"question_id":74963003,"body_markdown":"I did eventually solve this problem. It took some time because the program is moderately complex and a lot of re-writing and experimentation was required. Contention accessing a large shared object central to the calculation was the cause in some of the cases. Contention appears to approach 100% and access to this object appears to have been the limiting factor. \r\n\r\nRemoval of the contention then revealed a set of [less] contended logs and timers which were also reducing performance. Removal of contention on these objects then resulted in the expected performance improvements.\r\n\r\nThe lesson I took from this is that in that achieving performance improvements through concurrency is not straightforward in cases with significant shared resources. \r\n\r\nIn my case a partial solution required a complete re-write to remove all contention and store the results of the calculations run in each thread, to be later merged into the shared central resource. This merging had additional costs because the threads run similar calculations in parallel resulting in some data duplication that had to be dealt with.","title":"Virtual threads slower than single threads","body":"<p>I did eventually solve this problem. It took some time because the program is moderately complex and a lot of re-writing and experimentation was required. Contention accessing a large shared object central to the calculation was the cause in some of the cases. Contention appears to approach 100% and access to this object appears to have been the limiting factor.</p>\n<p>Removal of the contention then revealed a set of [less] contended logs and timers which were also reducing performance. Removal of contention on these objects then resulted in the expected performance improvements.</p>\n<p>The lesson I took from this is that in that achieving performance improvements through concurrency is not straightforward in cases with significant shared resources.</p>\n<p>In my case a partial solution required a complete re-write to remove all contention and store the results of the calculations run in each thread, to be later merged into the shared central resource. This merging had additional costs because the threads run similar calculations in parallel resulting in some data duplication that had to be dealt with.</p>\n"}],"owner":{"account_id":26599161,"reputation":41,"user_id":20221035,"display_name":"ljm599"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":270,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1681060416,"creation_date":1672413073,"question_id":74963003,"body_markdown":"I have a a number of tasks where work can be done in parallel. I have tried this single-threaded and multi-threaded. Code is as follows:\r\n\r\n```\r\nprivate MyTaskResult doTasks( ... ) {\r\n  \r\n    try ( var scope = new StructuredTaskScope.ShutdownOnFailure() ) {\r\n  \r\n      var negTask =\r\n        MyTask.create(\r\n          ...\r\n        );\r\n  \r\n      var posTask =\r\n        MyTask.create(\r\n          ...\r\n        );\r\n  \r\n      var negTaskFuture = (\r\n        CoreConfig.useMultipleThreads() ?\r\n        scope.fork( negTask::task ) :\r\n        new ImmediateFuture&lt;&gt;( negTask.task() )\r\n      );\r\n      \r\n      var posTaskFuture = (\r\n        CoreConfig.useMultipleThreads() ?\r\n        scope.fork( posTask::task) :\r\n        new ImmediateFuture&lt;&gt;( posTask.task() )\r\n      );\r\n  \r\n      scope.join();\r\n      scope.throwIfFailed();\r\n  \r\n      return new MyTaskResult(\r\n        negTaskFuture.resultNow(),\r\n        posTaskFuture.resultNow()\r\n      );\r\n  \r\n    }\r\n    catch ( InterruptedException | ExecutionException ex ) {\r\n      throw new Error( ex );\r\n    }\r\n    \r\n  }\r\n```\r\n\r\nTimings for single threaded execution are typically around 3ms for each of the two tasks, with some overhead, for 7ms total. Timings for multi-threaded execution are 9ms each task with some overhead for 11ms total. There is some inconsistency in the timings, with one task sometimes taking as little as 3ms and the other taking the usual 9ms. The task objects are created with their own data items (strictly immutable) and do not interact with other sources of data. The tasks do some calculations and create a data structure accordingly.\r\n\r\nMy expectation was that single-threaded execution time of 7ms elapsed would be accelerated to 4/5ms elapsed. This example is not important but it is not the only place where I am doing this work. I have similar results from other blocks of code. I did not present those examples because they reference a central data repository and all the spawned threads must contend for read and write access (I have used ReentrantReadWriteLock), so in that case there could be blocking. Even so the results are similar to the case I have presented above, with muti-threading taking 2-3x as long, albeit with larger number of threads. Note synchronized is not used.\r\n\r\nI must be doing something dumb. Please help ?\r\n\r\nEnvironment is IntelliJ, latest version.\r\n","title":"Virtual threads slower than single threads","body":"<p>I have a a number of tasks where work can be done in parallel. I have tried this single-threaded and multi-threaded. Code is as follows:</p>\n<pre><code>private MyTaskResult doTasks( ... ) {\n  \n    try ( var scope = new StructuredTaskScope.ShutdownOnFailure() ) {\n  \n      var negTask =\n        MyTask.create(\n          ...\n        );\n  \n      var posTask =\n        MyTask.create(\n          ...\n        );\n  \n      var negTaskFuture = (\n        CoreConfig.useMultipleThreads() ?\n        scope.fork( negTask::task ) :\n        new ImmediateFuture&lt;&gt;( negTask.task() )\n      );\n      \n      var posTaskFuture = (\n        CoreConfig.useMultipleThreads() ?\n        scope.fork( posTask::task) :\n        new ImmediateFuture&lt;&gt;( posTask.task() )\n      );\n  \n      scope.join();\n      scope.throwIfFailed();\n  \n      return new MyTaskResult(\n        negTaskFuture.resultNow(),\n        posTaskFuture.resultNow()\n      );\n  \n    }\n    catch ( InterruptedException | ExecutionException ex ) {\n      throw new Error( ex );\n    }\n    \n  }\n</code></pre>\n<p>Timings for single threaded execution are typically around 3ms for each of the two tasks, with some overhead, for 7ms total. Timings for multi-threaded execution are 9ms each task with some overhead for 11ms total. There is some inconsistency in the timings, with one task sometimes taking as little as 3ms and the other taking the usual 9ms. The task objects are created with their own data items (strictly immutable) and do not interact with other sources of data. The tasks do some calculations and create a data structure accordingly.</p>\n<p>My expectation was that single-threaded execution time of 7ms elapsed would be accelerated to 4/5ms elapsed. This example is not important but it is not the only place where I am doing this work. I have similar results from other blocks of code. I did not present those examples because they reference a central data repository and all the spawned threads must contend for read and write access (I have used ReentrantReadWriteLock), so in that case there could be blocking. Even so the results are similar to the case I have presented above, with muti-threading taking 2-3x as long, albeit with larger number of threads. Note synchronized is not used.</p>\n<p>I must be doing something dumb. Please help ?</p>\n<p>Environment is IntelliJ, latest version.</p>\n"},{"tags":["java","spring-boot","docker"],"comments":[{"owner":{"account_id":12712205,"reputation":1604,"user_id":9235482,"display_name":"Lakshitha Wisumperuma"},"score":0,"creation_date":1680959890,"post_id":75965390,"comment_id":133984185,"body_markdown":"did you verify that the container is up and running and that your application is up?","body":"did you verify that the container is up and running and that your application is up?"},{"owner":{"account_id":28247598,"reputation":11,"user_id":21594383,"display_name":"for_and_pear_max_no"},"score":0,"creation_date":1680970822,"post_id":75965390,"comment_id":133985689,"body_markdown":"Yes, everything is up and running.","body":"Yes, everything is up and running."},{"owner":{"account_id":12712205,"reputation":1604,"user_id":9235482,"display_name":"Lakshitha Wisumperuma"},"score":0,"creation_date":1681039996,"post_id":75965390,"comment_id":133992129,"body_markdown":"Can you try `docker run -p 34256:34256 -d --network=host --name java-container java-image` and test?","body":"Can you try <code>docker run -p 34256:34256 -d --network=host --name java-container java-image</code> and test?"}],"answers":[{"tags":[],"owner":{"account_id":28247598,"reputation":11,"user_id":21594383,"display_name":"for_and_pear_max_no"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1681060018,"creation_date":1681060018,"answer_id":75971856,"question_id":75965390,"body_markdown":"Solved by adding `--network=host` to the run arguments.\r\n\r\n`docker run -p 34256:34256 -d --network=host --name java-container java-image`\r\n\r\nThanks @Lakshitha Wisumperuma\r\n","title":"Can&#39;t connect to RESTful spring boot application when running as docker container","body":"<p>Solved by adding <code>--network=host</code> to the run arguments.</p>\n<p><code>docker run -p 34256:34256 -d --network=host --name java-container java-image</code></p>\n<p>Thanks @Lakshitha Wisumperuma</p>\n"}],"owner":{"account_id":28247598,"reputation":11,"user_id":21594383,"display_name":"for_and_pear_max_no"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":78,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":75971856,"answer_count":1,"score":1,"last_activity_date":1681060018,"creation_date":1680959229,"question_id":75965390,"body_markdown":"I am running a server machine which runs a spring-boot application, I am trying to dockerize the process. The server and client are two different PCs.\r\n\r\nServer:\r\n\r\n```\r\njava -jar springdemo-0.0.1-SNAPSHOT.jar\r\n```\r\n\r\nClient:\r\n\r\n`curl http://serverip:34256/api/test`\r\n\r\nI&#39;m getting the expected response\r\n\r\n```\r\n{\r\n    &quot;One&quot;: 1,\r\n    &quot;Two&quot;: 2,\r\n    &quot;Three&quot;: 3\r\n}\r\n```\r\n\r\n\r\nTrying to dockerize the process, I run on the server:\r\n\r\n`docker build -t java-image .`\r\n\r\n`docker run -p 34256:34256 --name java-container java-image`\r\n\r\nBut now I can&#39;t connect to my application from the client:\r\n\r\n```\r\ncurl: (7) Failed to connect to serverip port 34256 after 55 ms: Connection refused\r\n\r\n```\r\n\r\n\r\nSpring boot `application.properties`:\r\n\r\n```\r\nserver.address=0.0.0.0\r\nserver.port=34256\r\n```\r\n`Dockerfile`:\r\n\r\n```\r\nFROM openjdk:17-alpine\r\nARG PORT=34256\r\nMAINTAINER me\r\nEXPOSE ${PORT}\r\nCOPY ./springdemo-*.jar ./springdemo-*.jar\r\nCMD [&quot;java&quot;,&quot;-jar&quot;,&quot;springdemo-*.jar&quot;]\r\n```","title":"Can&#39;t connect to RESTful spring boot application when running as docker container","body":"<p>I am running a server machine which runs a spring-boot application, I am trying to dockerize the process. The server and client are two different PCs.</p>\n<p>Server:</p>\n<pre><code>java -jar springdemo-0.0.1-SNAPSHOT.jar\n</code></pre>\n<p>Client:</p>\n<p><code>curl http://serverip:34256/api/test</code></p>\n<p>I'm getting the expected response</p>\n<pre><code>{\n    &quot;One&quot;: 1,\n    &quot;Two&quot;: 2,\n    &quot;Three&quot;: 3\n}\n</code></pre>\n<p>Trying to dockerize the process, I run on the server:</p>\n<p><code>docker build -t java-image .</code></p>\n<p><code>docker run -p 34256:34256 --name java-container java-image</code></p>\n<p>But now I can't connect to my application from the client:</p>\n<pre><code>curl: (7) Failed to connect to serverip port 34256 after 55 ms: Connection refused\n\n</code></pre>\n<p>Spring boot <code>application.properties</code>:</p>\n<pre><code>server.address=0.0.0.0\nserver.port=34256\n</code></pre>\n<p><code>Dockerfile</code>:</p>\n<pre><code>FROM openjdk:17-alpine\nARG PORT=34256\nMAINTAINER me\nEXPOSE ${PORT}\nCOPY ./springdemo-*.jar ./springdemo-*.jar\nCMD [&quot;java&quot;,&quot;-jar&quot;,&quot;springdemo-*.jar&quot;]\n</code></pre>\n"},{"tags":["java","active-directory","ldap","unboundid-ldap-sdk"],"comments":[{"owner":{"account_id":1239958,"reputation":39024,"user_id":1202807,"display_name":"Gabriel Luci"},"score":1,"creation_date":1639151180,"post_id":70302425,"comment_id":124282717,"body_markdown":"Can you show your code?","body":"Can you show your code?"},{"owner":{"account_id":23608073,"reputation":1,"user_id":17643503,"display_name":"weclu"},"score":0,"creation_date":1639377559,"post_id":70302425,"comment_id":124324047,"body_markdown":"WhoAmIExtendedResult whoAmIResult = (WhoAmIExtendedResult)\n                            ldap.processExtendedOperation(new WhoAmIExtendedRequest());","body":"WhoAmIExtendedResult whoAmIResult = (WhoAmIExtendedResult)                             ldap.processExtendedOperation(new WhoAmIExtendedRequest());"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1639664370,"post_id":70302425,"comment_id":124410647,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."}],"answers":[{"tags":[],"owner":{"account_id":15779127,"reputation":26,"user_id":11386070,"display_name":"kqarryzada"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681059812,"creation_date":1681059812,"answer_id":75971837,"question_id":70302425,"body_markdown":"When a result (i.e., a `WhoAmIExtendedResult`) is obtained from Active Directory, you should be able to use the `WhoAmIExtendedResult.getAuthorizationID()` method to obtain the DN of the authenticated user. An example is described in the [Javadoc](https://docs.ldap.com/ldap-sdk/docs/javadoc/com/unboundid/ldap/sdk/extensions/WhoAmIExtendedRequest.html) for the class, but the authorization ID returned by the AD server could take one of the following forms:\r\n * `dn: uid=username,ou=clients,dc=example,dc=com`\r\n * `u: uid=username`\r\n * The empty string or just &quot;`dn:`&quot;, indicating an anonymous bind.","title":"LDAP/AD: How to get username or user with samaccountname?","body":"<p>When a result (i.e., a <code>WhoAmIExtendedResult</code>) is obtained from Active Directory, you should be able to use the <code>WhoAmIExtendedResult.getAuthorizationID()</code> method to obtain the DN of the authenticated user. An example is described in the <a href=\"https://docs.ldap.com/ldap-sdk/docs/javadoc/com/unboundid/ldap/sdk/extensions/WhoAmIExtendedRequest.html\" rel=\"nofollow noreferrer\">Javadoc</a> for the class, but the authorization ID returned by the AD server could take one of the following forms:</p>\n<ul>\n<li><code>dn: uid=username,ou=clients,dc=example,dc=com</code></li>\n<li><code>u: uid=username</code></li>\n<li>The empty string or just &quot;<code>dn:</code>&quot;, indicating an anonymous bind.</li>\n</ul>\n"}],"owner":{"account_id":23608073,"reputation":1,"user_id":17643503,"display_name":"weclu"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":255,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1681059812,"creation_date":1639128970,"question_id":70302425,"body_markdown":"I started to use the unboundid SDK to connect and work with LDAP/AD. With the `WhoAmIExtendedRequest` i can get the samaccountname. But who can i get the user and the full username? Is there an other request or a DN? \r\nThanks","title":"LDAP/AD: How to get username or user with samaccountname?","body":"<p>I started to use the unboundid SDK to connect and work with LDAP/AD. With the <code>WhoAmIExtendedRequest</code> i can get the samaccountname. But who can i get the user and the full username? Is there an other request or a DN?\nThanks</p>\n"},{"tags":["java","multithreading","locking"],"comments":[{"owner":{"account_id":3645282,"reputation":514,"user_id":3038456,"accept_rate":67,"display_name":"Christian O."},"score":0,"creation_date":1609082802,"post_id":65466493,"comment_id":115743459,"body_markdown":"In this case I&#39;d recommend you try a read / write lock.\nTake a look here\nhttp://tutorials.jenkov.com/java-concurrency/read-write-locks.html","body":"In this case I&#39;d recommend you try a read / write lock. Take a look here <a href=\"http://tutorials.jenkov.com/java-concurrency/read-write-locks.html\" rel=\"nofollow noreferrer\">tutorials.jenkov.com/java-concurrency/read-write-locks.html</a>"},{"owner":{"account_id":19466002,"reputation":445,"user_id":14239262,"display_name":"eof"},"score":0,"creation_date":1609083873,"post_id":65466493,"comment_id":115743794,"body_markdown":"Not sure how an RW lock will help? I have a critical section that can only be entered by one thread at a time (i.e. we don&#39;t have multiple readers that can simultaneously enter, which is the case for an RW lock). When multiple threads are waiting on the lock, I just want a specific thread to have priority over all others when entering. This is not the semantics of an RW lock.","body":"Not sure how an RW lock will help? I have a critical section that can only be entered by one thread at a time (i.e. we don&#39;t have multiple readers that can simultaneously enter, which is the case for an RW lock). When multiple threads are waiting on the lock, I just want a specific thread to have priority over all others when entering. This is not the semantics of an RW lock."},{"owner":{"account_id":17033694,"reputation":4572,"user_id":12323248,"display_name":"akuzminykh"},"score":0,"creation_date":1609084176,"post_id":65466493,"comment_id":115743866,"body_markdown":"@eof The RW lock was probably suggested because your question is hard to understand. Could you please show us some pseudocode or anything that would illustrate what you want better? Why is the special lock that signals the normal locks waiting on the same lock at all?","body":"@eof The RW lock was probably suggested because your question is hard to understand. Could you please show us some pseudocode or anything that would illustrate what you want better? Why is the special lock that signals the normal locks waiting on the same lock at all?"},{"owner":{"account_id":12285714,"reputation":983,"user_id":8965245,"display_name":"Nawnit Sen"},"score":0,"creation_date":1609084363,"post_id":65466493,"comment_id":115743912,"body_markdown":"@eof Do you have a limit on no of thread who waits for lock? is it fixed no of thread?","body":"@eof Do you have a limit on no of thread who waits for lock? is it fixed no of thread?"},{"owner":{"account_id":12285714,"reputation":983,"user_id":8965245,"display_name":"Nawnit Sen"},"score":0,"creation_date":1609084886,"post_id":65466493,"comment_id":115744074,"body_markdown":"Also do you have a way by which you can uniquely identify the thread? you would need  that to identify the thread that needs to be woken up.","body":"Also do you have a way by which you can uniquely identify the thread? you would need  that to identify the thread that needs to be woken up."},{"owner":{"account_id":5150443,"reputation":34158,"user_id":4125191,"display_name":"RealSkeptic"},"score":2,"creation_date":1609090386,"post_id":65466493,"comment_id":115745625,"body_markdown":"Could you perhaps design it differently? E.g. A single thread is in charge of doing the critical section, and it&#39;s waiting on a queue of requests from the other threads. You can then make this a priority queue.","body":"Could you perhaps design it differently? E.g. A single thread is in charge of doing the critical section, and it&#39;s waiting on a queue of requests from the other threads. You can then make this a priority queue."}],"answers":[{"tags":[],"owner":{"account_id":22604872,"reputation":2005,"user_id":16785907,"display_name":"Mikhail2048"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681059705,"creation_date":1681059229,"answer_id":75971786,"question_id":65466493,"body_markdown":"I do not think that there is an out-of-the-box solution. Both Java locks API and `synchronized` blocks do not guarantee that *some particular Thread* will be given a lock.\r\n\r\nStill, I can think of `ReentrantReadWriteLock`, for instance, you can have something like:\r\n\r\n```\r\npublic synchronized Object read() {\r\n    if (!readWriteLock.isWriteLocked()) {\r\n        ReadLock lock = null;\r\n        try {\r\n            lock = readWriteLock.readLock();\r\n            // do smth\r\n            return data;\r\n        } catch (Thrwoable t) {\r\n             return null;\r\n        } finally {\r\n            if (lock != null) lock.unlock();\r\n        }\r\n    }\r\n}\r\n\r\npublic void write() {\r\n   Lock lock = null;\r\n   try {\r\n       lock = readWriteLock.writeLock();\r\n       // do stuff\r\n   } catch (Thrwoable t) {\r\n   } finally {\r\n       if (lock != null) lock.unlock();\r\n   }\r\n}\r\n```\r\n\r\nHere, our reads synchronized and each time before acquiring the lock they check if the lock is already acquired. To make it even better, you can use a `ReadWriteLock` in fair mode. It is more costly in terms of performance, but this way you will ensure, that even if read comes before write, the next read will not acquire the lock, since the write is waiting longer.\r\n\r\nOf course it ***still does not guarantee that the write will always go first if present***, but at least there is a check for a WriteLock existence and we increase the chances, whereas just `synchronized` will choose the thread without any guarantees.","title":"Java locks and thread priority?","body":"<p>I do not think that there is an out-of-the-box solution. Both Java locks API and <code>synchronized</code> blocks do not guarantee that <em>some particular Thread</em> will be given a lock.</p>\n<p>Still, I can think of <code>ReentrantReadWriteLock</code>, for instance, you can have something like:</p>\n<pre><code>public synchronized Object read() {\n    if (!readWriteLock.isWriteLocked()) {\n        ReadLock lock = null;\n        try {\n            lock = readWriteLock.readLock();\n            // do smth\n            return data;\n        } catch (Thrwoable t) {\n             return null;\n        } finally {\n            if (lock != null) lock.unlock();\n        }\n    }\n}\n\npublic void write() {\n   Lock lock = null;\n   try {\n       lock = readWriteLock.writeLock();\n       // do stuff\n   } catch (Thrwoable t) {\n   } finally {\n       if (lock != null) lock.unlock();\n   }\n}\n</code></pre>\n<p>Here, our reads synchronized and each time before acquiring the lock they check if the lock is already acquired. To make it even better, you can use a <code>ReadWriteLock</code> in fair mode. It is more costly in terms of performance, but this way you will ensure, that even if read comes before write, the next read will not acquire the lock, since the write is waiting longer.</p>\n<p>Of course it <em><strong>still does not guarantee that the write will always go first if present</strong></em>, but at least there is a check for a WriteLock existence and we increase the chances, whereas just <code>synchronized</code> will choose the thread without any guarantees.</p>\n"}],"owner":{"account_id":19466002,"reputation":445,"user_id":14239262,"display_name":"eof"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":674,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1681059705,"creation_date":1609077402,"question_id":65466493,"body_markdown":"I have some code, where a lot of threads might be waiting on a lock while a certain Thread updates some resources at a fixed interval provided by a timer. The timed thread should ideally be the one to be woken up when the lock is unlocked in case it is waiting on the lock. Is there a lock in Java that respects thread priorities? I looked at e.g. Guava&#39;s Monitor implementation and it doesn&#39;t look at priorities at all.\r\n\r\nI know this is a research topic for real-time systems and there are many standard algorithms for this, but I don&#39;t have strict latency guarantees. I mainly just need a well-tested implementation.\r\n","title":"Java locks and thread priority?","body":"<p>I have some code, where a lot of threads might be waiting on a lock while a certain Thread updates some resources at a fixed interval provided by a timer. The timed thread should ideally be the one to be woken up when the lock is unlocked in case it is waiting on the lock. Is there a lock in Java that respects thread priorities? I looked at e.g. Guava's Monitor implementation and it doesn't look at priorities at all.</p>\n<p>I know this is a research topic for real-time systems and there are many standard algorithms for this, but I don't have strict latency guarantees. I mainly just need a well-tested implementation.</p>\n"},{"tags":["javascript","java","html","angularjs","spring-boot"],"comments":[{"owner":{"account_id":15178500,"reputation":4190,"user_id":10952503,"display_name":"Elikill58"},"score":1,"creation_date":1679910753,"post_id":75854297,"comment_id":133799388,"body_markdown":"Welcome on StackOverflow. Please do not show code as image, can you copy/paste to make a [mre] ?","body":"Welcome on StackOverflow. Please do not show code as image, can you copy/paste to make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> ?"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1679980914,"post_id":75854297,"comment_id":133813733,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."}],"answers":[{"tags":[],"owner":{"account_id":28212686,"reputation":1,"user_id":21564666,"display_name":"kempachi"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681059659,"creation_date":1680625571,"answer_id":75931714,"question_id":75854297,"body_markdown":"You should use models, for that json.\r\nIn fact, according to the image code, the `listSubCategory` is missing to have that list of `SubCategory`:\r\n\r\n    Example:\r\n    //product\r\n    export class Product {\r\n\t    productName: string = &#39;&#39;;\r\n\t    color: string = &#39;&#39;;\r\n\t    //...\r\n\t    listSubCategory: SubCategory[] = [];\r\n    }\r\n\r\n    //subCategory.ts\r\n    export class SubCategory {\r\n\t    id: string = &#39;&#39;;\r\n\t    subCategoryName: string = &#39;&#39;;\r\n    }\r\n    //ts\r\n    selectedSubCategory = new SubCategory();\r\n\r\n    //Here it depends on what you want to show.\r\n    selectedSubCategory.subCategoryName = &#39;Select ...&#39;;\r\n\r\n    //html\r\n    &lt;select class=&quot;form-select&quot; [(ngModel)]=&quot;selectedSubCategory&quot;&gt;\r\n\t    &lt;option *ngFor=&quot;let subcategory of product.listSubCategory&quot; \r\n    [ngValue]=&quot;subcategory&quot;&gt;{{subcategory.subCategoryName}}\r\n\t    &lt;/option&gt;\r\n    &lt;/select&gt;\r\n\r\n    //selectedSubCategory is going to have your option selected, remember to add \r\n    //controls.","title":"how do show data on select option when select ng-click=&quot;show({xm.id})&quot; using angular js","body":"<p>You should use models, for that json.\nIn fact, according to the image code, the <code>listSubCategory</code> is missing to have that list of <code>SubCategory</code>:</p>\n<pre><code>Example:\n//product\nexport class Product {\n    productName: string = '';\n    color: string = '';\n    //...\n    listSubCategory: SubCategory[] = [];\n}\n\n//subCategory.ts\nexport class SubCategory {\n    id: string = '';\n    subCategoryName: string = '';\n}\n//ts\nselectedSubCategory = new SubCategory();\n\n//Here it depends on what you want to show.\nselectedSubCategory.subCategoryName = 'Select ...';\n\n//html\n&lt;select class=&quot;form-select&quot; [(ngModel)]=&quot;selectedSubCategory&quot;&gt;\n    &lt;option *ngFor=&quot;let subcategory of product.listSubCategory&quot; \n[ngValue]=&quot;subcategory&quot;&gt;{{subcategory.subCategoryName}}\n    &lt;/option&gt;\n&lt;/select&gt;\n\n//selectedSubCategory is going to have your option selected, remember to add \n//controls.\n</code></pre>\n"}],"owner":{"account_id":28136351,"reputation":1,"user_id":21500066,"display_name":"ngocnn"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":25,"favorite_count":0,"down_vote_count":2,"up_vote_count":0,"answer_count":1,"score":-2,"last_activity_date":1681059659,"creation_date":1679910562,"question_id":75854297,"body_markdown":"Here is my html code to display the data ![](https://i.stack.imgur.com/3Lueg.png)\r\n\r\nI tried displaying data using angularjs\r\n\r\n![](https://i.stack.imgur.com/cbwD4.png)\r\n\r\nBut it doesn&#39;t show select options\r\n\r\n![](https://i.stack.imgur.com/R3YtO.png)","title":"how do show data on select option when select ng-click=&quot;show({xm.id})&quot; using angular js","body":"<p>Here is my html code to display the data <img src=\"https://i.stack.imgur.com/3Lueg.png\" alt=\"\" /></p>\n<p>I tried displaying data using angularjs</p>\n<p><img src=\"https://i.stack.imgur.com/cbwD4.png\" alt=\"\" /></p>\n<p>But it doesn't show select options</p>\n<p><img src=\"https://i.stack.imgur.com/R3YtO.png\" alt=\"\" /></p>\n"},{"tags":["java","android","xml"],"comments":[{"owner":{"account_id":23883416,"reputation":134,"user_id":17883851,"display_name":"TG. Kahsay"},"score":0,"creation_date":1680959825,"post_id":75964599,"comment_id":133984174,"body_markdown":"IMHO I would just do a CardView with an ImageView inside it. give it radius, and set padding to 0dp.  if you use Material CardView  you have more options to customize it.","body":"IMHO I would just do a CardView with an ImageView inside it. give it radius, and set padding to 0dp.  if you use Material CardView  you have more options to customize it."}],"answers":[{"comments":[{"owner":{"account_id":17003554,"reputation":3,"user_id":12308601,"display_name":"The Metagame"},"score":0,"creation_date":1680993698,"post_id":75965524,"comment_id":133988454,"body_markdown":"I have tried your solution but sadly the image still fills the entire layout and does not adjust to the corners :(","body":"I have tried your solution but sadly the image still fills the entire layout and does not adjust to the corners :("},{"owner":{"account_id":23883416,"reputation":134,"user_id":17883851,"display_name":"TG. Kahsay"},"score":0,"creation_date":1681058411,"post_id":75965524,"comment_id":133994457,"body_markdown":"@TheMetagame Have you closed the tags correctly? please look at the second answer for a complete layout file.","body":"@TheMetagame Have you closed the tags correctly? please look at the second answer for a complete layout file."}],"tags":[],"owner":{"account_id":23883416,"reputation":134,"user_id":17883851,"display_name":"TG. Kahsay"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681058256,"creation_date":1680960729,"answer_id":75965524,"question_id":75964599,"body_markdown":"try some thing like this \r\n\r\n``` xml\r\n\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\r\n    android:layout_width=&quot;match_parent&quot;\r\n    android:layout_height=&quot;match_parent&quot;\r\n    android:background=&quot;@color/white&quot;&gt;\r\n\r\n    &lt;!-- give a desired cardCornerRadius to CardView --&gt;\r\n    &lt;com.google.android.material.card.MaterialCardView\r\n        android:id=&quot;@+id/relLayout1&quot;\r\n        android:layout_width=&quot;match_parent&quot;\r\n        android:layout_marginTop=&quot;10dp&quot;\r\n        android:layout_height=&quot;170dp&quot;\r\n        app:cardCornerRadius=&quot;50dp&quot;&gt;\r\n\r\n        &lt;!-- margin and padding to 0dp (may not be neccessary) --&gt;\r\n        &lt;ImageView\r\n            android:id=&quot;@+id/evento_banner&quot;\r\n            android:layout_width=&quot;match_parent&quot;\r\n            android:layout_height=&quot;match_parent&quot;\r\n            android:scaleType=&quot;fitXY&quot;\r\n            android:margin =&quot;0dp&quot;\r\n            android:padding = &quot;0dp&quot;\r\n            android:src=&quot;@drawable/evento_banner&quot;/&gt;\r\n    &lt;/com.google.android.material.card.MaterialCardView&gt;\r\n\r\n&lt;!-- rest of your tags --&gt;\r\n\r\n&lt;/RelativeLayout&gt;\r\n\r\n```\r\n\r\nI hope some thing like this is what you are looking for","title":"Filling a custom RelativeLayout with an ImageView and not surpassing its limits","body":"<p>try some thing like this</p>\n<pre class=\"lang-xml prettyprint-override\"><code>\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    android:background=&quot;@color/white&quot;&gt;\n\n    &lt;!-- give a desired cardCornerRadius to CardView --&gt;\n    &lt;com.google.android.material.card.MaterialCardView\n        android:id=&quot;@+id/relLayout1&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_marginTop=&quot;10dp&quot;\n        android:layout_height=&quot;170dp&quot;\n        app:cardCornerRadius=&quot;50dp&quot;&gt;\n\n        &lt;!-- margin and padding to 0dp (may not be neccessary) --&gt;\n        &lt;ImageView\n            android:id=&quot;@+id/evento_banner&quot;\n            android:layout_width=&quot;match_parent&quot;\n            android:layout_height=&quot;match_parent&quot;\n            android:scaleType=&quot;fitXY&quot;\n            android:margin =&quot;0dp&quot;\n            android:padding = &quot;0dp&quot;\n            android:src=&quot;@drawable/evento_banner&quot;/&gt;\n    &lt;/com.google.android.material.card.MaterialCardView&gt;\n\n&lt;!-- rest of your tags --&gt;\n\n&lt;/RelativeLayout&gt;\n\n</code></pre>\n<p>I hope some thing like this is what you are looking for</p>\n"},{"comments":[{"owner":{"account_id":17003554,"reputation":3,"user_id":12308601,"display_name":"The Metagame"},"score":0,"creation_date":1681071979,"post_id":75971694,"comment_id":133996118,"body_markdown":"After setting hardware accelerated, the solution worked. Thanks!","body":"After setting hardware accelerated, the solution worked. Thanks!"}],"tags":[],"owner":{"account_id":23883416,"reputation":134,"user_id":17883851,"display_name":"TG. Kahsay"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1681058784,"creation_date":1681058032,"answer_id":75971694,"question_id":75964599,"body_markdown":"if I understand you correctly you want something like then following [![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/SmhUz.png\r\n\r\nIf so update your xml with the following,\r\n\r\n** Please not that I used a background color instead of an image, in your case use `android:src=&quot;@drawable/your_drawable&quot;`.\r\nI have tried it and it works with image too\r\n``` xml\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\r\n    android:layout_width=&quot;match_parent&quot;\r\n    android:layout_height=&quot;match_parent&quot;\r\n    android:background=&quot;@color/white&quot;&gt;\r\n\r\n    &lt;!-- give a desired cardCornerRadius to CardView --&gt;\r\n    &lt;com.google.android.material.card.MaterialCardView\r\n        android:id=&quot;@+id/relLayout1&quot;\r\n        android:layout_width=&quot;match_parent&quot;\r\n        android:layout_marginTop=&quot;10dp&quot;\r\n        android:layout_height=&quot;170dp&quot;\r\n        app:cardCornerRadius=&quot;50dp&quot;&gt;\r\n\r\n    &lt;!-- margin and padding to 0dp (may not be neccessary) --&gt;\r\n    &lt;!-- I also have not included the image here. I just used a background color --&gt;\r\n    &lt;ImageView\r\n        android:id=&quot;@+id/evento_banner&quot;\r\n        android:layout_width=&quot;match_parent&quot;\r\n        android:layout_height=&quot;match_parent&quot;\r\n        android:scaleType=&quot;fitXY&quot;\r\n        android:margin =&quot;0dp&quot;\r\n        android:padding = &quot;0dp&quot;\r\n        android:background=&quot;@color/Neon&quot;/&gt;\r\n    &lt;/com.google.android.material.card.MaterialCardView&gt;\r\n    &lt;com.google.android.material.card.MaterialCardView\r\n        android:layout_width=&quot;match_parent&quot;\r\n        android:layout_height=&quot;120dp&quot;\r\n        android:layout_alignTop=&quot;@+id/relLayout1&quot;\r\n        android:layout_marginTop=&quot;60dp&quot;\r\n        app:cardBackgroundColor=&quot;@color/white&quot;\r\n        app:cardCornerRadius=&quot;50dp&quot;\r\n        app:strokeColor=&quot;@color/lightGrey&quot;\r\n        app:strokeWidth=&quot;3dp&quot;&gt;\r\n        &lt;RelativeLayout\r\n            android:layout_width=&quot;match_parent&quot;\r\n            android:layout_height=&quot;wrap_content&quot;\r\n            android:background=&quot;@color/super_lightGrey&quot;\r\n            android:padding=&quot;5dp&quot;&gt;\r\n            &lt;TextView\r\n                android:id=&quot;@+id/evento&quot;\r\n                android:layout_width=&quot;wrap_content&quot;\r\n                android:layout_height=&quot;wrap_content&quot;\r\n                android:layout_alignParentLeft=&quot;true&quot;\r\n                android:layout_alignParentTop=&quot;true&quot;\r\n                android:layout_marginLeft=&quot;30dp&quot;\r\n                android:layout_marginTop=&quot;27dp&quot;\r\n                android:text=&quot;Evento&quot;\r\n                android:textColor=&quot;@color/black&quot;\r\n                android:textSize=&quot;16sp&quot;\r\n                android:textStyle=&quot;bold&quot;&gt;\r\n\r\n            &lt;/TextView&gt;\r\n            &lt;TextView\r\n                android:id=&quot;@+id/fechainicio&quot;\r\n                android:layout_width=&quot;wrap_content&quot;\r\n                android:layout_height=&quot;wrap_content&quot;\r\n                android:layout_alignParentTop=&quot;true&quot;\r\n                android:layout_centerHorizontal=&quot;true&quot;\r\n                android:layout_marginTop=&quot;30dp&quot;\r\n                android:text=&quot;20/10/2023&quot;\r\n                android:textColor=&quot;@color/black&quot;\r\n                android:textSize=&quot;18sp&quot;&gt;\r\n\r\n            &lt;/TextView&gt;\r\n\r\n            &lt;TextView\r\n                android:id=&quot;@+id/rating&quot;\r\n                android:layout_width=&quot;wrap_content&quot;\r\n                android:layout_height=&quot;wrap_content&quot;\r\n                android:layout_marginLeft=&quot;30dp&quot;\r\n                android:layout_marginTop=&quot;27dp&quot;\r\n                android:layout_toLeftOf=&quot;@id/ratingstar&quot;\r\n                android:text=&quot;4,7&quot;\r\n                android:textColor=&quot;@color/black&quot;\r\n                android:textSize=&quot;16sp&quot;\r\n                android:textStyle=&quot;bold&quot;/&gt;\r\n\r\n            &lt;ImageView\r\n                android:id=&quot;@+id/ratingstar&quot;\r\n                android:layout_width=&quot;23dp&quot;\r\n                android:layout_height=&quot;23dp&quot;\r\n                android:layout_alignParentTop=&quot;true&quot;\r\n                android:layout_alignParentRight=&quot;true&quot;\r\n                android:layout_marginTop=&quot;27dp&quot;\r\n                android:layout_marginRight=&quot;30dp&quot;\r\n                android:src=&quot;@drawable/calendar&quot; /&gt;\r\n            &lt;TextView\r\n                android:id=&quot;@+id/lineaseparacion&quot;\r\n                android:layout_width=&quot;wrap_content&quot;\r\n                android:layout_height=&quot;wrap_content&quot;\r\n                android:layout_centerVertical=&quot;true&quot;\r\n                android:layout_centerHorizontal=&quot;true&quot;\r\n                android:text=&quot;-&quot;\r\n                android:textColor=&quot;@color/black&quot;\r\n                android:textSize=&quot;20sp&quot;/&gt;\r\n\r\n            &lt;ImageView\r\n                android:id=&quot;@+id/locationicon&quot;\r\n                android:layout_width=&quot;20dp&quot;\r\n                android:layout_height=&quot;20dp&quot;\r\n                android:layout_alignParentLeft=&quot;true&quot;\r\n\r\n                android:layout_alignParentBottom=&quot;true&quot;\r\n                android:layout_marginLeft=&quot;27dp&quot;\r\n                android:layout_marginBottom=&quot;25dp&quot;\r\n                android:src=&quot;@drawable/settings&quot; /&gt;\r\n\r\n            &lt;TextView\r\n                android:id=&quot;@+id/localizacion&quot;\r\n                android:layout_width=&quot;wrap_content&quot;\r\n                android:layout_height=&quot;wrap_content&quot;\r\n                android:layout_alignParentBottom=&quot;true&quot;\r\n                android:layout_marginTop=&quot;15dp&quot;\r\n                android:layout_marginBottom=&quot;25dp&quot;\r\n                android:layout_toRightOf=&quot;@id/locationicon&quot;\r\n                android:text=&quot;Madrid&quot;\r\n                android:textColor=&quot;@color/black&quot;\r\n                android:textSize=&quot;14sp&quot;/&gt;\r\n            &lt;TextView\r\n                android:id=&quot;@+id/fechafin&quot;\r\n                android:layout_width=&quot;wrap_content&quot;\r\n                android:layout_height=&quot;wrap_content&quot;\r\n                android:layout_alignParentBottom=&quot;true&quot;\r\n                android:layout_centerHorizontal=&quot;true&quot;\r\n                android:layout_marginBottom=&quot;25dp&quot;\r\n                android:text=&quot;27/10/2023&quot;\r\n                android:textColor=&quot;@color/black&quot;\r\n                android:textSize=&quot;13sp&quot;/&gt;\r\n\r\n            &lt;TextView\r\n                android:id=&quot;@+id/precio&quot;\r\n                android:layout_width=&quot;wrap_content&quot;\r\n                android:layout_height=&quot;wrap_content&quot;\r\n                android:layout_alignParentRight=&quot;true&quot;\r\n                android:layout_alignParentBottom=&quot;true&quot;\r\n                android:layout_marginTop=&quot;15dp&quot;\r\n                android:layout_marginRight=&quot;38dp&quot;\r\n                android:layout_marginBottom=&quot;25dp&quot;\r\n                android:text=&quot;Gratis&quot;\r\n                android:textColor=&quot;#4CAF50&quot;\r\n                android:textSize=&quot;14sp&quot;&gt;\r\n\r\n            &lt;/TextView&gt;\r\n        &lt;/RelativeLayout&gt;\r\n    &lt;/com.google.android.material.card.MaterialCardView&gt;\r\n&lt;/RelativeLayout&gt;\r\n``` ","title":"Filling a custom RelativeLayout with an ImageView and not surpassing its limits","body":"<p>if I understand you correctly you want something like then following <a href=\"https://i.stack.imgur.com/SmhUz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SmhUz.png\" alt=\"enter image description here\" /></a></p>\n<p>If so update your xml with the following,</p>\n<p>** Please not that I used a background color instead of an image, in your case use <code>android:src=&quot;@drawable/your_drawable&quot;</code>.\nI have tried it and it works with image too</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    android:background=&quot;@color/white&quot;&gt;\n\n    &lt;!-- give a desired cardCornerRadius to CardView --&gt;\n    &lt;com.google.android.material.card.MaterialCardView\n        android:id=&quot;@+id/relLayout1&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_marginTop=&quot;10dp&quot;\n        android:layout_height=&quot;170dp&quot;\n        app:cardCornerRadius=&quot;50dp&quot;&gt;\n\n    &lt;!-- margin and padding to 0dp (may not be neccessary) --&gt;\n    &lt;!-- I also have not included the image here. I just used a background color --&gt;\n    &lt;ImageView\n        android:id=&quot;@+id/evento_banner&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;match_parent&quot;\n        android:scaleType=&quot;fitXY&quot;\n        android:margin =&quot;0dp&quot;\n        android:padding = &quot;0dp&quot;\n        android:background=&quot;@color/Neon&quot;/&gt;\n    &lt;/com.google.android.material.card.MaterialCardView&gt;\n    &lt;com.google.android.material.card.MaterialCardView\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;120dp&quot;\n        android:layout_alignTop=&quot;@+id/relLayout1&quot;\n        android:layout_marginTop=&quot;60dp&quot;\n        app:cardBackgroundColor=&quot;@color/white&quot;\n        app:cardCornerRadius=&quot;50dp&quot;\n        app:strokeColor=&quot;@color/lightGrey&quot;\n        app:strokeWidth=&quot;3dp&quot;&gt;\n        &lt;RelativeLayout\n            android:layout_width=&quot;match_parent&quot;\n            android:layout_height=&quot;wrap_content&quot;\n            android:background=&quot;@color/super_lightGrey&quot;\n            android:padding=&quot;5dp&quot;&gt;\n            &lt;TextView\n                android:id=&quot;@+id/evento&quot;\n                android:layout_width=&quot;wrap_content&quot;\n                android:layout_height=&quot;wrap_content&quot;\n                android:layout_alignParentLeft=&quot;true&quot;\n                android:layout_alignParentTop=&quot;true&quot;\n                android:layout_marginLeft=&quot;30dp&quot;\n                android:layout_marginTop=&quot;27dp&quot;\n                android:text=&quot;Evento&quot;\n                android:textColor=&quot;@color/black&quot;\n                android:textSize=&quot;16sp&quot;\n                android:textStyle=&quot;bold&quot;&gt;\n\n            &lt;/TextView&gt;\n            &lt;TextView\n                android:id=&quot;@+id/fechainicio&quot;\n                android:layout_width=&quot;wrap_content&quot;\n                android:layout_height=&quot;wrap_content&quot;\n                android:layout_alignParentTop=&quot;true&quot;\n                android:layout_centerHorizontal=&quot;true&quot;\n                android:layout_marginTop=&quot;30dp&quot;\n                android:text=&quot;20/10/2023&quot;\n                android:textColor=&quot;@color/black&quot;\n                android:textSize=&quot;18sp&quot;&gt;\n\n            &lt;/TextView&gt;\n\n            &lt;TextView\n                android:id=&quot;@+id/rating&quot;\n                android:layout_width=&quot;wrap_content&quot;\n                android:layout_height=&quot;wrap_content&quot;\n                android:layout_marginLeft=&quot;30dp&quot;\n                android:layout_marginTop=&quot;27dp&quot;\n                android:layout_toLeftOf=&quot;@id/ratingstar&quot;\n                android:text=&quot;4,7&quot;\n                android:textColor=&quot;@color/black&quot;\n                android:textSize=&quot;16sp&quot;\n                android:textStyle=&quot;bold&quot;/&gt;\n\n            &lt;ImageView\n                android:id=&quot;@+id/ratingstar&quot;\n                android:layout_width=&quot;23dp&quot;\n                android:layout_height=&quot;23dp&quot;\n                android:layout_alignParentTop=&quot;true&quot;\n                android:layout_alignParentRight=&quot;true&quot;\n                android:layout_marginTop=&quot;27dp&quot;\n                android:layout_marginRight=&quot;30dp&quot;\n                android:src=&quot;@drawable/calendar&quot; /&gt;\n            &lt;TextView\n                android:id=&quot;@+id/lineaseparacion&quot;\n                android:layout_width=&quot;wrap_content&quot;\n                android:layout_height=&quot;wrap_content&quot;\n                android:layout_centerVertical=&quot;true&quot;\n                android:layout_centerHorizontal=&quot;true&quot;\n                android:text=&quot;-&quot;\n                android:textColor=&quot;@color/black&quot;\n                android:textSize=&quot;20sp&quot;/&gt;\n\n            &lt;ImageView\n                android:id=&quot;@+id/locationicon&quot;\n                android:layout_width=&quot;20dp&quot;\n                android:layout_height=&quot;20dp&quot;\n                android:layout_alignParentLeft=&quot;true&quot;\n\n                android:layout_alignParentBottom=&quot;true&quot;\n                android:layout_marginLeft=&quot;27dp&quot;\n                android:layout_marginBottom=&quot;25dp&quot;\n                android:src=&quot;@drawable/settings&quot; /&gt;\n\n            &lt;TextView\n                android:id=&quot;@+id/localizacion&quot;\n                android:layout_width=&quot;wrap_content&quot;\n                android:layout_height=&quot;wrap_content&quot;\n                android:layout_alignParentBottom=&quot;true&quot;\n                android:layout_marginTop=&quot;15dp&quot;\n                android:layout_marginBottom=&quot;25dp&quot;\n                android:layout_toRightOf=&quot;@id/locationicon&quot;\n                android:text=&quot;Madrid&quot;\n                android:textColor=&quot;@color/black&quot;\n                android:textSize=&quot;14sp&quot;/&gt;\n            &lt;TextView\n                android:id=&quot;@+id/fechafin&quot;\n                android:layout_width=&quot;wrap_content&quot;\n                android:layout_height=&quot;wrap_content&quot;\n                android:layout_alignParentBottom=&quot;true&quot;\n                android:layout_centerHorizontal=&quot;true&quot;\n                android:layout_marginBottom=&quot;25dp&quot;\n                android:text=&quot;27/10/2023&quot;\n                android:textColor=&quot;@color/black&quot;\n                android:textSize=&quot;13sp&quot;/&gt;\n\n            &lt;TextView\n                android:id=&quot;@+id/precio&quot;\n                android:layout_width=&quot;wrap_content&quot;\n                android:layout_height=&quot;wrap_content&quot;\n                android:layout_alignParentRight=&quot;true&quot;\n                android:layout_alignParentBottom=&quot;true&quot;\n                android:layout_marginTop=&quot;15dp&quot;\n                android:layout_marginRight=&quot;38dp&quot;\n                android:layout_marginBottom=&quot;25dp&quot;\n                android:text=&quot;Gratis&quot;\n                android:textColor=&quot;#4CAF50&quot;\n                android:textSize=&quot;14sp&quot;&gt;\n\n            &lt;/TextView&gt;\n        &lt;/RelativeLayout&gt;\n    &lt;/com.google.android.material.card.MaterialCardView&gt;\n&lt;/RelativeLayout&gt;\n</code></pre>\n"}],"owner":{"account_id":17003554,"reputation":3,"user_id":12308601,"display_name":"The Metagame"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":42,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75971694,"answer_count":2,"score":0,"last_activity_date":1681058784,"creation_date":1680948594,"question_id":75964599,"body_markdown":"Im trying to create an object to populate a listview so that if i pass it a certain image, it fills its limits not surpassing the region its defined on. In order to do that, i have created a drawable file so if i reference it as background, my relativelayout converts into a round shape. The problem is that with my local images, there is not problem apparently or at least the designer does not show any problem filling it. \r\nThis is how i want each item to look like for any image dimension:\r\n\r\n[Ideal image shape](https://i.stack.imgur.com/Vp01o.png)\r\n\r\n\r\nBut whenever i try to fill it with an external image,located in firebase, the image surpasses this shape and just fill the entire region defined by the relative layout, displaying it like this:\r\n\r\n[How it looks atm](https://i.stack.imgur.com/gklTh.jpg)\r\n\r\nI have tried many different imageview settings after defining the cliptooutline in the relativelayout, height, width, scale type or even giving it the background of the shape already defined. Could someone help me correct my xml or finding a method to making my code behave as expected please?\r\n\r\nMy xml code:\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\r\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\r\n    android:layout_width=&quot;match_parent&quot;\r\n    android:layout_height=&quot;match_parent&quot;\r\n    android:background=&quot;@color/white&quot;&gt;\r\n\r\n\r\n    &lt;RelativeLayout\r\n        android:id=&quot;@+id/relLayout1&quot;\r\n        android:layout_width=&quot;match_parent&quot;\r\n        android:layout_marginTop=&quot;10dp&quot;\r\n        android:layout_height=&quot;170dp&quot;\r\n        android:background=&quot;@drawable/event_shape&quot;\r\n        android:clipToOutline=&quot;true&quot;&gt;\r\n\r\n        &lt;ImageView\r\n            android:id=&quot;@+id/evento_banner&quot;\r\n            android:layout_width=&quot;match_parent&quot;\r\n            android:layout_height=&quot;match_parent&quot;\r\n            android:scaleType=&quot;fitXY&quot;\r\n            android:src=&quot;@drawable/evento_banner&quot;/&gt;\r\n    &lt;/RelativeLayout&gt;\r\n\r\n    &lt;RelativeLayout\r\n        android:layout_width=&quot;match_parent&quot;\r\n        android:layout_height=&quot;120dp&quot;\r\n        android:layout_alignTop=&quot;@+id/relLayout1&quot;\r\n        android:layout_marginTop=&quot;60dp&quot;\r\n        android:background=&quot;@drawable/event_shape&quot;&gt;\r\n\r\n        &lt;TextView\r\n            android:id=&quot;@+id/evento&quot;\r\n            android:layout_width=&quot;wrap_content&quot;\r\n            android:layout_height=&quot;wrap_content&quot;\r\n            android:layout_alignParentLeft=&quot;true&quot;\r\n            android:layout_alignParentTop=&quot;true&quot;\r\n            android:layout_marginLeft=&quot;30dp&quot;\r\n            android:layout_marginTop=&quot;27dp&quot;\r\n            android:text=&quot;Evento&quot;\r\n            android:textColor=&quot;@color/black&quot;\r\n            android:textSize=&quot;16sp&quot;\r\n            android:textStyle=&quot;bold&quot;&gt;\r\n\r\n        &lt;/TextView&gt;\r\n        &lt;TextView\r\n            android:id=&quot;@+id/fechainicio&quot;\r\n            android:layout_width=&quot;wrap_content&quot;\r\n            android:layout_height=&quot;wrap_content&quot;\r\n            android:layout_alignParentTop=&quot;true&quot;\r\n            android:layout_centerHorizontal=&quot;true&quot;\r\n            android:layout_marginTop=&quot;30dp&quot;\r\n            android:text=&quot;20/10/2023&quot;\r\n            android:textColor=&quot;@color/black&quot;\r\n            android:textSize=&quot;13sp&quot;&gt;\r\n\r\n        &lt;/TextView&gt;\r\n\r\n        &lt;TextView\r\n            android:id=&quot;@+id/rating&quot;\r\n            android:layout_width=&quot;wrap_content&quot;\r\n            android:layout_height=&quot;wrap_content&quot;\r\n            android:layout_marginLeft=&quot;30dp&quot;\r\n            android:layout_marginTop=&quot;27dp&quot;\r\n            android:layout_toLeftOf=&quot;@id/ratingstar&quot;\r\n            android:text=&quot;4,7&quot;\r\n            android:textColor=&quot;@color/black&quot;\r\n            android:textSize=&quot;16sp&quot;\r\n            android:textStyle=&quot;bold&quot;&gt;&lt;/TextView&gt;\r\n\r\n        &lt;ImageView\r\n            android:id=&quot;@+id/ratingstar&quot;\r\n            android:layout_width=&quot;23dp&quot;\r\n            android:layout_height=&quot;23dp&quot;\r\n            android:layout_alignParentTop=&quot;true&quot;\r\n            android:layout_alignParentRight=&quot;true&quot;\r\n            android:layout_marginTop=&quot;27dp&quot;\r\n            android:layout_marginRight=&quot;30dp&quot;\r\n            android:src=&quot;@drawable/baseline_star_24&quot; /&gt;\r\n        &lt;TextView\r\n            android:id=&quot;@+id/lineaseparacion&quot;\r\n            android:layout_width=&quot;wrap_content&quot;\r\n            android:layout_height=&quot;wrap_content&quot;\r\n            android:layout_centerVertical=&quot;true&quot;\r\n            android:layout_centerHorizontal=&quot;true&quot;\r\n            android:text=&quot;-&quot;\r\n            android:textColor=&quot;@color/black&quot;\r\n            android:textSize=&quot;20sp&quot;/&gt;\r\n\r\n        &lt;ImageView\r\n            android:id=&quot;@+id/locationicon&quot;\r\n            android:layout_width=&quot;20dp&quot;\r\n            android:layout_height=&quot;20dp&quot;\r\n            android:layout_alignParentLeft=&quot;true&quot;\r\n\r\n            android:layout_alignParentBottom=&quot;true&quot;\r\n            android:layout_marginLeft=&quot;27dp&quot;\r\n            android:layout_marginBottom=&quot;25dp&quot;\r\n            android:src=&quot;@drawable/baseline_location_on_24&quot; /&gt;\r\n\r\n        &lt;TextView\r\n            android:id=&quot;@+id/localizacion&quot;\r\n            android:layout_width=&quot;wrap_content&quot;\r\n            android:layout_height=&quot;wrap_content&quot;\r\n            android:layout_alignParentBottom=&quot;true&quot;\r\n            android:layout_marginTop=&quot;15dp&quot;\r\n            android:layout_marginBottom=&quot;25dp&quot;\r\n            android:layout_toRightOf=&quot;@id/locationicon&quot;\r\n            android:text=&quot;Madrid&quot;\r\n            android:textColor=&quot;@color/black&quot;\r\n            android:textSize=&quot;14sp&quot;&gt;&lt;/TextView&gt;\r\n        &lt;TextView\r\n            android:id=&quot;@+id/fechafin&quot;\r\n            android:layout_width=&quot;wrap_content&quot;\r\n            android:layout_height=&quot;wrap_content&quot;\r\n            android:layout_alignParentBottom=&quot;true&quot;\r\n            android:layout_centerHorizontal=&quot;true&quot;\r\n            android:layout_marginBottom=&quot;25dp&quot;\r\n            android:text=&quot;27/10/2023&quot;\r\n            android:textColor=&quot;@color/black&quot;\r\n            android:textSize=&quot;13sp&quot;/&gt;\r\n\r\n        &lt;TextView\r\n            android:id=&quot;@+id/precio&quot;\r\n            android:layout_width=&quot;wrap_content&quot;\r\n            android:layout_height=&quot;wrap_content&quot;\r\n            android:layout_alignParentRight=&quot;true&quot;\r\n            android:layout_alignParentBottom=&quot;true&quot;\r\n            android:layout_marginTop=&quot;15dp&quot;\r\n            android:layout_marginRight=&quot;38dp&quot;\r\n            android:layout_marginBottom=&quot;25dp&quot;\r\n            android:text=&quot;Gratis&quot;\r\n            android:textColor=&quot;#4CAF50&quot;\r\n            android:textSize=&quot;14sp&quot;&gt;\r\n\r\n        &lt;/TextView&gt;\r\n\r\n    &lt;/RelativeLayout&gt;\r\n&lt;/RelativeLayout&gt;\r\n```\r\n\r\n\r\nThe background shape:\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\r\n&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;\r\n    &lt;item android:state_pressed=&quot;true&quot;&gt;\r\n        &lt;shape&gt;\r\n            &lt;solid android:color=&quot;#9C27B0&quot;&gt;\r\n            &lt;/solid&gt;\r\n            &lt;stroke android:color=&quot;@color/black&quot;\r\n                android:width=&quot;1dp&quot;&gt;\r\n            &lt;/stroke&gt;\r\n            &lt;corners android:radius=&quot;50dp&quot;&gt;\r\n            &lt;/corners&gt;\r\n        &lt;/shape&gt;\r\n    &lt;/item&gt;\r\n    &lt;item&gt;\r\n        &lt;shape&gt;\r\n            &lt;solid android:color=&quot;@color/grey&quot;&gt;\r\n            &lt;/solid&gt;\r\n            &lt;stroke android:color=&quot;#FFFFFF&quot;\r\n                android:width=&quot;2dp&quot;&gt;\r\n            &lt;/stroke&gt;\r\n            &lt;corners android:radius=&quot;50dp&quot;&gt;\r\n            &lt;/corners&gt;\r\n        &lt;/shape&gt;\r\n    &lt;/item&gt;\r\n&lt;/selector&gt;\r\n```\r\nUpdate: following the first answer, i have tried using a cardview, but even after adapting it to get the same preview, the image surpasses the cardview region. Is there a way to adapt the xml or at least adapt the image on the backend of the section so it doesnt surpass the region defined?\r\n\r\n\r\n","title":"Filling a custom RelativeLayout with an ImageView and not surpassing its limits","body":"<p>Im trying to create an object to populate a listview so that if i pass it a certain image, it fills its limits not surpassing the region its defined on. In order to do that, i have created a drawable file so if i reference it as background, my relativelayout converts into a round shape. The problem is that with my local images, there is not problem apparently or at least the designer does not show any problem filling it.\nThis is how i want each item to look like for any image dimension:</p>\n<p><a href=\"https://i.stack.imgur.com/Vp01o.png\" rel=\"nofollow noreferrer\">Ideal image shape</a></p>\n<p>But whenever i try to fill it with an external image,located in firebase, the image surpasses this shape and just fill the entire region defined by the relative layout, displaying it like this:</p>\n<p><a href=\"https://i.stack.imgur.com/gklTh.jpg\" rel=\"nofollow noreferrer\">How it looks atm</a></p>\n<p>I have tried many different imageview settings after defining the cliptooutline in the relativelayout, height, width, scale type or even giving it the background of the shape already defined. Could someone help me correct my xml or finding a method to making my code behave as expected please?</p>\n<p>My xml code:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    android:background=&quot;@color/white&quot;&gt;\n\n\n    &lt;RelativeLayout\n        android:id=&quot;@+id/relLayout1&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_marginTop=&quot;10dp&quot;\n        android:layout_height=&quot;170dp&quot;\n        android:background=&quot;@drawable/event_shape&quot;\n        android:clipToOutline=&quot;true&quot;&gt;\n\n        &lt;ImageView\n            android:id=&quot;@+id/evento_banner&quot;\n            android:layout_width=&quot;match_parent&quot;\n            android:layout_height=&quot;match_parent&quot;\n            android:scaleType=&quot;fitXY&quot;\n            android:src=&quot;@drawable/evento_banner&quot;/&gt;\n    &lt;/RelativeLayout&gt;\n\n    &lt;RelativeLayout\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;120dp&quot;\n        android:layout_alignTop=&quot;@+id/relLayout1&quot;\n        android:layout_marginTop=&quot;60dp&quot;\n        android:background=&quot;@drawable/event_shape&quot;&gt;\n\n        &lt;TextView\n            android:id=&quot;@+id/evento&quot;\n            android:layout_width=&quot;wrap_content&quot;\n            android:layout_height=&quot;wrap_content&quot;\n            android:layout_alignParentLeft=&quot;true&quot;\n            android:layout_alignParentTop=&quot;true&quot;\n            android:layout_marginLeft=&quot;30dp&quot;\n            android:layout_marginTop=&quot;27dp&quot;\n            android:text=&quot;Evento&quot;\n            android:textColor=&quot;@color/black&quot;\n            android:textSize=&quot;16sp&quot;\n            android:textStyle=&quot;bold&quot;&gt;\n\n        &lt;/TextView&gt;\n        &lt;TextView\n            android:id=&quot;@+id/fechainicio&quot;\n            android:layout_width=&quot;wrap_content&quot;\n            android:layout_height=&quot;wrap_content&quot;\n            android:layout_alignParentTop=&quot;true&quot;\n            android:layout_centerHorizontal=&quot;true&quot;\n            android:layout_marginTop=&quot;30dp&quot;\n            android:text=&quot;20/10/2023&quot;\n            android:textColor=&quot;@color/black&quot;\n            android:textSize=&quot;13sp&quot;&gt;\n\n        &lt;/TextView&gt;\n\n        &lt;TextView\n            android:id=&quot;@+id/rating&quot;\n            android:layout_width=&quot;wrap_content&quot;\n            android:layout_height=&quot;wrap_content&quot;\n            android:layout_marginLeft=&quot;30dp&quot;\n            android:layout_marginTop=&quot;27dp&quot;\n            android:layout_toLeftOf=&quot;@id/ratingstar&quot;\n            android:text=&quot;4,7&quot;\n            android:textColor=&quot;@color/black&quot;\n            android:textSize=&quot;16sp&quot;\n            android:textStyle=&quot;bold&quot;&gt;&lt;/TextView&gt;\n\n        &lt;ImageView\n            android:id=&quot;@+id/ratingstar&quot;\n            android:layout_width=&quot;23dp&quot;\n            android:layout_height=&quot;23dp&quot;\n            android:layout_alignParentTop=&quot;true&quot;\n            android:layout_alignParentRight=&quot;true&quot;\n            android:layout_marginTop=&quot;27dp&quot;\n            android:layout_marginRight=&quot;30dp&quot;\n            android:src=&quot;@drawable/baseline_star_24&quot; /&gt;\n        &lt;TextView\n            android:id=&quot;@+id/lineaseparacion&quot;\n            android:layout_width=&quot;wrap_content&quot;\n            android:layout_height=&quot;wrap_content&quot;\n            android:layout_centerVertical=&quot;true&quot;\n            android:layout_centerHorizontal=&quot;true&quot;\n            android:text=&quot;-&quot;\n            android:textColor=&quot;@color/black&quot;\n            android:textSize=&quot;20sp&quot;/&gt;\n\n        &lt;ImageView\n            android:id=&quot;@+id/locationicon&quot;\n            android:layout_width=&quot;20dp&quot;\n            android:layout_height=&quot;20dp&quot;\n            android:layout_alignParentLeft=&quot;true&quot;\n\n            android:layout_alignParentBottom=&quot;true&quot;\n            android:layout_marginLeft=&quot;27dp&quot;\n            android:layout_marginBottom=&quot;25dp&quot;\n            android:src=&quot;@drawable/baseline_location_on_24&quot; /&gt;\n\n        &lt;TextView\n            android:id=&quot;@+id/localizacion&quot;\n            android:layout_width=&quot;wrap_content&quot;\n            android:layout_height=&quot;wrap_content&quot;\n            android:layout_alignParentBottom=&quot;true&quot;\n            android:layout_marginTop=&quot;15dp&quot;\n            android:layout_marginBottom=&quot;25dp&quot;\n            android:layout_toRightOf=&quot;@id/locationicon&quot;\n            android:text=&quot;Madrid&quot;\n            android:textColor=&quot;@color/black&quot;\n            android:textSize=&quot;14sp&quot;&gt;&lt;/TextView&gt;\n        &lt;TextView\n            android:id=&quot;@+id/fechafin&quot;\n            android:layout_width=&quot;wrap_content&quot;\n            android:layout_height=&quot;wrap_content&quot;\n            android:layout_alignParentBottom=&quot;true&quot;\n            android:layout_centerHorizontal=&quot;true&quot;\n            android:layout_marginBottom=&quot;25dp&quot;\n            android:text=&quot;27/10/2023&quot;\n            android:textColor=&quot;@color/black&quot;\n            android:textSize=&quot;13sp&quot;/&gt;\n\n        &lt;TextView\n            android:id=&quot;@+id/precio&quot;\n            android:layout_width=&quot;wrap_content&quot;\n            android:layout_height=&quot;wrap_content&quot;\n            android:layout_alignParentRight=&quot;true&quot;\n            android:layout_alignParentBottom=&quot;true&quot;\n            android:layout_marginTop=&quot;15dp&quot;\n            android:layout_marginRight=&quot;38dp&quot;\n            android:layout_marginBottom=&quot;25dp&quot;\n            android:text=&quot;Gratis&quot;\n            android:textColor=&quot;#4CAF50&quot;\n            android:textSize=&quot;14sp&quot;&gt;\n\n        &lt;/TextView&gt;\n\n    &lt;/RelativeLayout&gt;\n&lt;/RelativeLayout&gt;\n</code></pre>\n<p>The background shape:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;\n    &lt;item android:state_pressed=&quot;true&quot;&gt;\n        &lt;shape&gt;\n            &lt;solid android:color=&quot;#9C27B0&quot;&gt;\n            &lt;/solid&gt;\n            &lt;stroke android:color=&quot;@color/black&quot;\n                android:width=&quot;1dp&quot;&gt;\n            &lt;/stroke&gt;\n            &lt;corners android:radius=&quot;50dp&quot;&gt;\n            &lt;/corners&gt;\n        &lt;/shape&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;shape&gt;\n            &lt;solid android:color=&quot;@color/grey&quot;&gt;\n            &lt;/solid&gt;\n            &lt;stroke android:color=&quot;#FFFFFF&quot;\n                android:width=&quot;2dp&quot;&gt;\n            &lt;/stroke&gt;\n            &lt;corners android:radius=&quot;50dp&quot;&gt;\n            &lt;/corners&gt;\n        &lt;/shape&gt;\n    &lt;/item&gt;\n&lt;/selector&gt;\n</code></pre>\n<p>Update: following the first answer, i have tried using a cardview, but even after adapting it to get the same preview, the image surpasses the cardview region. Is there a way to adapt the xml or at least adapt the image on the backend of the section so it doesnt surpass the region defined?</p>\n"},{"tags":["java","android","api","google-maps"],"answers":[{"comments":[{"owner":{"account_id":9955269,"reputation":27,"user_id":7366445,"display_name":"fiendishbrokeboi"},"score":0,"creation_date":1570124030,"post_id":58219234,"comment_id":102823560,"body_markdown":"I tried to first Use ProGuard to shrink the code and its returns this error:\nCould not find method android() for arguments [build_7b52k4yyeks9l2efdeec28zeo$_run_closure2@6cc7c31f] on root project &#39;Google maps Demo&#39; of type org.gradle.api.Project.","body":"I tried to first Use ProGuard to shrink the code and its returns this error: Could not find method android() for arguments [build_7b52k4yyeks9l2efdeec28zeo$_run_closure2@6cc7c31f] on root project &#39;Google maps Demo&#39; of type org.gradle.api.Project."}],"tags":[],"owner":{"account_id":9339027,"reputation":767,"user_id":6932415,"display_name":"Michiel"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1570106076,"creation_date":1570106076,"answer_id":58219234,"question_id":58219092,"body_markdown":"It&#39;s not a fault in your code, it is because of your dependency on Google Maps. \r\n\r\nThis adds a lot of methods to your app, passing the limit of 64k per dex file. There are two solutions:\r\n\r\nUse MultiDex: https://developer.android.com/studio/build/multidex\r\nAndroid Studio will generate multiple dex files, so the limit is not reached.\r\n\r\nUse ProGuard removing unused methods: https://developer.android.com/studio/build/shrink-code\r\nMethods which are not called, are not added to your dex file. This is, combined with obfuscating, always a good idea.","title":"Cannot fit requested classes in a single dex file (# methods: 86965 &gt; 65536)","body":"<p>It's not a fault in your code, it is because of your dependency on Google Maps. </p>\n\n<p>This adds a lot of methods to your app, passing the limit of 64k per dex file. There are two solutions:</p>\n\n<p>Use MultiDex: <a href=\"https://developer.android.com/studio/build/multidex\" rel=\"nofollow noreferrer\">https://developer.android.com/studio/build/multidex</a>\nAndroid Studio will generate multiple dex files, so the limit is not reached.</p>\n\n<p>Use ProGuard removing unused methods: <a href=\"https://developer.android.com/studio/build/shrink-code\" rel=\"nofollow noreferrer\">https://developer.android.com/studio/build/shrink-code</a>\nMethods which are not called, are not added to your dex file. This is, combined with obfuscating, always a good idea.</p>\n"},{"tags":[],"owner":{"account_id":21033808,"reputation":11,"user_id":15457613,"display_name":"Arka Saha"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1616478553,"creation_date":1616474058,"answer_id":66757311,"question_id":58219092,"body_markdown":"write:\r\n\r\n```\r\nmultiDexEnabled true\r\n```\r\n\r\nin build.gradle(app) file","title":"Cannot fit requested classes in a single dex file (# methods: 86965 &gt; 65536)","body":"<p>write:</p>\n<pre><code>multiDexEnabled true\n</code></pre>\n<p>in build.gradle(app) file</p>\n"},{"tags":[],"owner":{"account_id":9011142,"reputation":1135,"user_id":6715678,"display_name":"mufazmi"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1631058910,"creation_date":1631058910,"answer_id":69095599,"question_id":58219092,"body_markdown":"**Solution:**\r\n\r\nOpen your app level build.gradle file. and simply write in android-&gt;defaultConfig-&gt; `multiDexEnabled true`\r\n\r\n**Code For Better Understanding.**\r\n\r\n    android {\r\n        defaultConfig {\r\n            multiDexEnabled true\r\n        }","title":"Cannot fit requested classes in a single dex file (# methods: 86965 &gt; 65536)","body":"<p><strong>Solution:</strong></p>\n<p>Open your app level build.gradle file. and simply write in android-&gt;defaultConfig-&gt; <code>multiDexEnabled true</code></p>\n<p><strong>Code For Better Understanding.</strong></p>\n<pre><code>android {\n    defaultConfig {\n        multiDexEnabled true\n    }\n</code></pre>\n"},{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":1,"creation_date":1681450123,"post_id":75971700,"comment_id":134061126,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/75971700/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":28258413,"reputation":11,"user_id":21603534,"display_name":"Shaho Rezaie"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1681058112,"creation_date":1681058112,"answer_id":75971700,"question_id":58219092,"body_markdown":"in android&gt;app&gt;build.gradle add in defaultConfig:\r\n\r\n\r\n\r\n\r\n    defaultConfig {\r\n        \r\n        multiDexEnabled true\r\n    \r\n        }","title":"Cannot fit requested classes in a single dex file (# methods: 86965 &gt; 65536)","body":"<p>in android&gt;app&gt;build.gradle add in defaultConfig:</p>\n<pre><code>defaultConfig {\n    \n    multiDexEnabled true\n\n    }\n</code></pre>\n"}],"owner":{"account_id":9955269,"reputation":27,"user_id":7366445,"display_name":"fiendishbrokeboi"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":8147,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":4,"score":2,"last_activity_date":1681058112,"creation_date":1570103990,"question_id":58219092,"body_markdown":"*Update: After running ProGuard to lessen my resources, it seems that ProGuard may be deleting important code:\r\nErorr: Could not find method android() for arguments [build_7b52k4yyeks9l2efdeec28zeo$_run_closure2@6cc7c31f] on root project &#39;Google maps Demo&#39; of type org.gradle.api.Project.\r\nUpdated build.gradle code:\r\n```\r\n// Top-level build file where you can add configuration options common to all sub-projects/modules.\r\n\r\nbuildscript {\r\n    repositories {\r\n        google()\r\n        jcenter()\r\n        mavenLocal()\r\n\r\n    }\r\n    dependencies {\r\n        classpath &#39;com.android.tools.build:gradle:3.5.0&#39;\r\n        classpath &#39;com.google.gms:google-services:4.3.2&#39;\r\n\r\n\r\n        // NOTE: Do not place your application dependencies here; they belong\r\n        // in the individual module build.gradle files\r\n    }\r\n}\r\n\r\nallprojects {\r\n    repositories {\r\n        google()\r\n        jcenter()\r\n        maven { url &#39;https://maven.fabric.io/public&#39; }\r\n        maven {\r\n            url &quot;https://maven.google.com&quot;\r\n        }\r\n    }\r\n}\r\n\r\nandroid {\r\n    buildTypes {\r\n        release {\r\n            // Enables code shrinking, obfuscation, and optimization for only\r\n            // your project&#39;s release build type.\r\n            minifyEnabled true\r\n\r\n            // Enables resource shrinking, which is performed by the\r\n            // Android Gradle plugin.\r\n            shrinkResources true\r\n\r\n            // Includes the default ProGuard rules files that are packaged with\r\n            // the Android Gradle plugin. To learn more, go to the section about\r\n            // R8 configuration files.\r\n            proguardFiles getDefaultProguardFile(\r\n                    &#39;proguard-android-optimize.txt&#39;),\r\n                    &#39;proguard-rules.pro&#39;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\ntask clean(type: Delete) {\r\n    delete rootProject.buildDir\r\n}\r\n```\r\n\r\nI&#39;m using android studio to implement Google maps api using Android&#39;s Coding&#39;s tutorial (https://www.youtube.com/watch?v=eiexkzCI8m8). I&#39;m getting this error as a &quot;D8 errors&quot; and two errors in my Java compiler.\r\nError #1:&quot;Caused by: com.android.tools.r8.CompilationFailedException: Compilation failed to complete&quot;\r\n\r\nError #2: &quot;Caused by: com.android.tools.r8.utils.AbortException: Error: null, Cannot fit requested classes in a single dex file (# methods: 86965 &gt; 65536)&quot;\r\n\r\nAnyone see the problem?\r\n\r\nHere is my java code:\r\n```\r\npublic class MainActivity extends FragmentActivity implements OnMapReadyCallback{\r\n\r\n    GoogleMap map;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n\r\n        SupportMapFragment mapFragment = (SupportMapFragment) getSupportFragmentManager()\r\n                .findFragmentById(R.id.map);\r\n        mapFragment.getMapAsync(this);\r\n\r\n    }\r\n\r\n    @Override\r\n    public void onMapReady(GoogleMap googleMap) {\r\n        map = googleMap;\r\n\r\n        LatLng Brockton = new LatLng(42.0895988,-70.9798322);\r\n        map.addMarker(new MarkerOptions().position(Brockton).title(&quot;Brockton&quot;));\r\n        map.moveCamera(CameraUpdateFactory.newLatLng(Brockton));\r\n    }\r\n}\r\n```","title":"Cannot fit requested classes in a single dex file (# methods: 86965 &gt; 65536)","body":"<p>*Update: After running ProGuard to lessen my resources, it seems that ProGuard may be deleting important code:\nErorr: Could not find method android() for arguments [build_7b52k4yyeks9l2efdeec28zeo$_run_closure2@6cc7c31f] on root project 'Google maps Demo' of type org.gradle.api.Project.\nUpdated build.gradle code:</p>\n\n<pre><code>// Top-level build file where you can add configuration options common to all sub-projects/modules.\n\nbuildscript {\n    repositories {\n        google()\n        jcenter()\n        mavenLocal()\n\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:3.5.0'\n        classpath 'com.google.gms:google-services:4.3.2'\n\n\n        // NOTE: Do not place your application dependencies here; they belong\n        // in the individual module build.gradle files\n    }\n}\n\nallprojects {\n    repositories {\n        google()\n        jcenter()\n        maven { url 'https://maven.fabric.io/public' }\n        maven {\n            url \"https://maven.google.com\"\n        }\n    }\n}\n\nandroid {\n    buildTypes {\n        release {\n            // Enables code shrinking, obfuscation, and optimization for only\n            // your project's release build type.\n            minifyEnabled true\n\n            // Enables resource shrinking, which is performed by the\n            // Android Gradle plugin.\n            shrinkResources true\n\n            // Includes the default ProGuard rules files that are packaged with\n            // the Android Gradle plugin. To learn more, go to the section about\n            // R8 configuration files.\n            proguardFiles getDefaultProguardFile(\n                    'proguard-android-optimize.txt'),\n                    'proguard-rules.pro'\n        }\n    }\n\n}\n\n\ntask clean(type: Delete) {\n    delete rootProject.buildDir\n}\n</code></pre>\n\n<p>I'm using android studio to implement Google maps api using Android's Coding's tutorial (<a href=\"https://www.youtube.com/watch?v=eiexkzCI8m8\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=eiexkzCI8m8</a>). I'm getting this error as a \"D8 errors\" and two errors in my Java compiler.\nError #1:\"Caused by: com.android.tools.r8.CompilationFailedException: Compilation failed to complete\"</p>\n\n<p>Error #2: \"Caused by: com.android.tools.r8.utils.AbortException: Error: null, Cannot fit requested classes in a single dex file (# methods: 86965 > 65536)\"</p>\n\n<p>Anyone see the problem?</p>\n\n<p>Here is my java code:</p>\n\n<pre><code>public class MainActivity extends FragmentActivity implements OnMapReadyCallback{\n\n    GoogleMap map;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        SupportMapFragment mapFragment = (SupportMapFragment) getSupportFragmentManager()\n                .findFragmentById(R.id.map);\n        mapFragment.getMapAsync(this);\n\n    }\n\n    @Override\n    public void onMapReady(GoogleMap googleMap) {\n        map = googleMap;\n\n        LatLng Brockton = new LatLng(42.0895988,-70.9798322);\n        map.addMarker(new MarkerOptions().position(Brockton).title(\"Brockton\"));\n        map.moveCamera(CameraUpdateFactory.newLatLng(Brockton));\n    }\n}\n</code></pre>\n"},{"tags":["java","arrays","sorting","data-structures","priority-queue"],"comments":[{"owner":{"account_id":6606677,"reputation":1024,"user_id":5103317,"display_name":"Old Dog Programmer"},"score":2,"creation_date":1680974984,"post_id":75966386,"comment_id":133986258,"body_markdown":"Is one of the error messages  a compiler error message &quot;generic array creation&quot; ?  Those who update Java chose to implement generics in a way that makes them incompatible with arrays. You migth try something like `List&lt;PriorityQueue&lt;long[]&gt;&gt; arr   = new ArrayList&lt;&gt;();`","body":"Is one of the error messages  a compiler error message &quot;generic array creation&quot; ?  Those who update Java chose to implement generics in a way that makes them incompatible with arrays. You migth try something like <code>List&lt;PriorityQueue&lt;long[]&gt;&gt; arr   = new ArrayList&lt;&gt;();</code>"},{"owner":{"account_id":20846399,"reputation":121,"user_id":15311807,"display_name":"Ayush Tiwari"},"score":1,"creation_date":1681034219,"post_id":75966386,"comment_id":133991579,"body_markdown":"I added the error and full code. Can you please explain what exactly causes this error?","body":"I added the error and full code. Can you please explain what exactly causes this error?"}],"answers":[{"comments":[{"owner":{"account_id":20846399,"reputation":121,"user_id":15311807,"display_name":"Ayush Tiwari"},"score":0,"creation_date":1681034362,"post_id":75966707,"comment_id":133991591,"body_markdown":"Can you please provide some reference or some reading material on why is &quot;Mixing generics and arrays&quot; is not recommended? Also I updated the question, can you please explain what causes the error here? I try to fill array with a new PriorityQueue Object in which I passed a comparator object for each PQ object in array. What error am I making?","body":"Can you please provide some reference or some reading material on why is &quot;Mixing generics and arrays&quot; is not recommended? Also I updated the question, can you please explain what causes the error here? I try to fill array with a new PriorityQueue Object in which I passed a comparator object for each PQ object in array. What error am I making?"},{"owner":{"account_id":12743722,"reputation":19966,"user_id":12567365,"display_name":"andrewJames"},"score":1,"creation_date":1681045491,"post_id":75966707,"comment_id":133992759,"body_markdown":"OK - I have added some notes to my answer - hope they help. These are large bu(and important) topics, so I have tried to provide some pointers for more exploration.","body":"OK - I have added some notes to my answer - hope they help. These are large bu(and important) topics, so I have tried to provide some pointers for more exploration."},{"owner":{"account_id":20846399,"reputation":121,"user_id":15311807,"display_name":"Ayush Tiwari"},"score":0,"creation_date":1681564296,"post_id":75966707,"comment_id":134078693,"body_markdown":"Thanks for your time, it clears a lot of things for me.","body":"Thanks for your time, it clears a lot of things for me."}],"tags":[],"owner":{"account_id":12743722,"reputation":19966,"user_id":12567365,"display_name":"andrewJames"},"comment_count":3,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1681045439,"creation_date":1680974867,"answer_id":75966707,"question_id":75966386,"body_markdown":"To create an object with a comparator, you can use this approach:\r\n\r\n```java\r\nPriorityQueue&lt;Long[]&gt; pq = new PriorityQueue&lt;&gt;(new Comparator&lt;Long[]&gt;() {\r\n    public int compare(Long[] a, Long[] b) {\r\n        return a[1].compareTo(b[1]);\r\n    }\r\n});\r\n```\r\n\r\nBut note I have used `Long` not `long` and this allows me to also use `compareTo` instead of subtraction - to ensure you do not encounter unexpected out-of-bounds results for `Compare`&#39;s `int` return value.\r\n\r\n---\r\n\r\nThe above uses the anonymous inner class approach you were looking to use in your question, but note also the explicit type `Comparator&lt;Long[]&gt;`.\r\n\r\nAs an optional extra step, this can be simplified by replacing the inner class with a lambda expression:\r\n\r\n```java\r\nPriorityQueue&lt;Long[]&gt; pq = new PriorityQueue&lt;&gt;((Long[] a, Long[] b) -&gt; a[1].compareTo(b[1]));\r\n```\r\n\r\nTherefore you can use either of the above approaches in your `Arrays.fill`.\r\n\r\nHere is the lambda approach:\r\n\r\n```java\r\nPriorityQueue&lt;long[]&gt;[] arr = new PriorityQueue[10];\r\nArrays.fill(arr, new PriorityQueue&lt;&gt;((Long[] a, Long[] b) -&gt; a[1].compareTo(b[1])));\r\n```\r\n\r\n---\r\n\r\nJust to note - that comparator may only be an artificial example for this question, but it is a bit unusual. And I was wondering if you actually meant to compare `a[0]` with `b[0]` instead.\r\n\r\nAnd, obviously, all the queues are empty at this point.\r\n\r\n---\r\n\r\n**Update**\r\n\r\nI completely agree with the [comment](https://stackoverflow.com/questions/75966386/how-do-i-make-an-array-of-priority-queues-further-how-to-assign-comparator-func#comment133986258_75966386) from @OldDogProgrammer. Mixing generics and arrays in this way is not recommended. &quot;_Prefer lists to arrays_&quot; - Josh Bloch, _Effective Java_.\r\n\r\n---\r\n\r\n**Update 2**\r\n\r\nYou asked if I could:\r\n\r\n&gt; provide some reference or some reading material \r\n\r\nThat is why I mentioned Josh Bloch and _Effective Java_. You can do an online search for &quot;prefer lists to arrays josh bloch&quot; to see various articles discussing this topic, in depth.\r\n\r\nYou asked: \r\n\r\n&gt; what causes the error here?\r\n\r\nYou have not provided a specific type for `new Comparator&lt;&gt;()`. \r\n\r\nThat is why I mentioned &quot;_note also the explicit type `Comparator&lt;Long[]&gt;`_&quot; in my answer (see above).\r\n\r\nThe objects you want the comparator to compare are `Long[]` arrays - but you provided `int[]` in your implementation:\r\n\r\n    compare(int[] a, int[] b)\r\n\r\nYou have not provided any type at all in your `new Comparator&lt;&gt;()` constructor - therefore it defaults to `compare(Object,Object)` - which you can see in the error message.\r\n\r\nSo, there is also a mismatch between the constructor and the implementation you have provided - as well as a mismatch between the constructor and what you _should_ have provided in the implementation.\r\n\r\nThis is actually another Josh Bloch topic: \r\n\r\n&gt; Prefer generic types. \r\n\r\nThere are excellent online articles about this topic, also. I expect there are also some excellent Stack Overflow answers about this, and &quot;_Prefer lists to arrays_&quot;.\r\n\r\nYou can also search for terms _covariant_ and _invariant_ in the context of Java generics and arrays as another research topic.\r\n\r\n","title":"How do I make an array of Priority Queues? Further how to assign comparator function to each PQ in array","body":"<p>To create an object with a comparator, you can use this approach:</p>\n<pre class=\"lang-java prettyprint-override\"><code>PriorityQueue&lt;Long[]&gt; pq = new PriorityQueue&lt;&gt;(new Comparator&lt;Long[]&gt;() {\n    public int compare(Long[] a, Long[] b) {\n        return a[1].compareTo(b[1]);\n    }\n});\n</code></pre>\n<p>But note I have used <code>Long</code> not <code>long</code> and this allows me to also use <code>compareTo</code> instead of subtraction - to ensure you do not encounter unexpected out-of-bounds results for <code>Compare</code>'s <code>int</code> return value.</p>\n<hr />\n<p>The above uses the anonymous inner class approach you were looking to use in your question, but note also the explicit type <code>Comparator&lt;Long[]&gt;</code>.</p>\n<p>As an optional extra step, this can be simplified by replacing the inner class with a lambda expression:</p>\n<pre class=\"lang-java prettyprint-override\"><code>PriorityQueue&lt;Long[]&gt; pq = new PriorityQueue&lt;&gt;((Long[] a, Long[] b) -&gt; a[1].compareTo(b[1]));\n</code></pre>\n<p>Therefore you can use either of the above approaches in your <code>Arrays.fill</code>.</p>\n<p>Here is the lambda approach:</p>\n<pre class=\"lang-java prettyprint-override\"><code>PriorityQueue&lt;long[]&gt;[] arr = new PriorityQueue[10];\nArrays.fill(arr, new PriorityQueue&lt;&gt;((Long[] a, Long[] b) -&gt; a[1].compareTo(b[1])));\n</code></pre>\n<hr />\n<p>Just to note - that comparator may only be an artificial example for this question, but it is a bit unusual. And I was wondering if you actually meant to compare <code>a[0]</code> with <code>b[0]</code> instead.</p>\n<p>And, obviously, all the queues are empty at this point.</p>\n<hr />\n<p><strong>Update</strong></p>\n<p>I completely agree with the <a href=\"https://stackoverflow.com/questions/75966386/how-do-i-make-an-array-of-priority-queues-further-how-to-assign-comparator-func#comment133986258_75966386\">comment</a> from @OldDogProgrammer. Mixing generics and arrays in this way is not recommended. &quot;<em>Prefer lists to arrays</em>&quot; - Josh Bloch, <em>Effective Java</em>.</p>\n<hr />\n<p><strong>Update 2</strong></p>\n<p>You asked if I could:</p>\n<blockquote>\n<p>provide some reference or some reading material</p>\n</blockquote>\n<p>That is why I mentioned Josh Bloch and <em>Effective Java</em>. You can do an online search for &quot;prefer lists to arrays josh bloch&quot; to see various articles discussing this topic, in depth.</p>\n<p>You asked:</p>\n<blockquote>\n<p>what causes the error here?</p>\n</blockquote>\n<p>You have not provided a specific type for <code>new Comparator&lt;&gt;()</code>.</p>\n<p>That is why I mentioned &quot;<em>note also the explicit type <code>Comparator&lt;Long[]&gt;</code></em>&quot; in my answer (see above).</p>\n<p>The objects you want the comparator to compare are <code>Long[]</code> arrays - but you provided <code>int[]</code> in your implementation:</p>\n<pre><code>compare(int[] a, int[] b)\n</code></pre>\n<p>You have not provided any type at all in your <code>new Comparator&lt;&gt;()</code> constructor - therefore it defaults to <code>compare(Object,Object)</code> - which you can see in the error message.</p>\n<p>So, there is also a mismatch between the constructor and the implementation you have provided - as well as a mismatch between the constructor and what you <em>should</em> have provided in the implementation.</p>\n<p>This is actually another Josh Bloch topic:</p>\n<blockquote>\n<p>Prefer generic types.</p>\n</blockquote>\n<p>There are excellent online articles about this topic, also. I expect there are also some excellent Stack Overflow answers about this, and &quot;<em>Prefer lists to arrays</em>&quot;.</p>\n<p>You can also search for terms <em>covariant</em> and <em>invariant</em> in the context of Java generics and arrays as another research topic.</p>\n"}],"owner":{"account_id":20846399,"reputation":121,"user_id":15311807,"display_name":"Ayush Tiwari"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":75,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":75966707,"answer_count":1,"score":0,"last_activity_date":1681057189,"creation_date":1680971088,"question_id":75966386,"body_markdown":"I somehow came across a requirement to create an Array of PriorityQueues. \r\nA workaround could be to create a HashMap, but I prefered array.\r\n\r\nI declared an Array of Priority Queues as follows.\r\n\r\n`PriorityQueue&lt;long[]&gt;[] arr = new PriorityQueue[10];`\r\n\r\nI wanted each Priority Queue in `arr` to have a same comparator function that sorts elements in `PriorityQueue&lt;long[]&gt;`, in order of second element inside `long[]`.\r\n\r\nI tried to fill the array `arr` using.\r\n\r\n```\r\nArrays.fill(arr, new PriorityQueue&lt;&gt;(new Comparator&lt;&gt;(){\r\n            public int compare(int[] a, int[] b){\r\n                return b[1] - a[1];\r\n            }\r\n        }));\r\n```\r\n\r\nBut this gives me an error, can anyone help what is wrong with this approach? \r\n\r\nThe Code:\r\n```\r\nimport java.util.*;\r\npublic class Main\r\n{\r\n    public static void main(String[] args) {\r\n        PriorityQueue&lt;long[]&gt;[] arr = new PriorityQueue[10];\r\n        Arrays.fill(arr, new PriorityQueue&lt;&gt;(new Comparator&lt;&gt;(){\r\n            public int compare(int[] a, int[] b){\r\n                return b[1] - a[1];\r\n            }\r\n        }));\r\n    }\r\n}\r\n```\r\n\r\nThe Error:\r\n```\r\nMain.java:12: error: &lt;anonymous Main$1&gt; is not abstract and does not override abstract method compare(Object,Object) in Comparator\r\n        Arrays.fill(arr, new PriorityQueue&lt;&gt;(new Comparator&lt;&gt;(){\r\n                                                               ^\r\nMain.java:13: error: method does not override or implement a method from a supertype\r\n            public int compare(int[] a, int[] b){\r\n                       ^\r\n  (due to &lt;&gt;, every non-private method declared in this anonymous class must override or implement a method from a supertype)\r\n```\r\n\r\nAlso is there a better way to assign object to each element of array during declaration?","title":"How do I make an array of Priority Queues? Further how to assign comparator function to each PQ in array","body":"<p>I somehow came across a requirement to create an Array of PriorityQueues.\nA workaround could be to create a HashMap, but I prefered array.</p>\n<p>I declared an Array of Priority Queues as follows.</p>\n<p><code>PriorityQueue&lt;long[]&gt;[] arr = new PriorityQueue[10];</code></p>\n<p>I wanted each Priority Queue in <code>arr</code> to have a same comparator function that sorts elements in <code>PriorityQueue&lt;long[]&gt;</code>, in order of second element inside <code>long[]</code>.</p>\n<p>I tried to fill the array <code>arr</code> using.</p>\n<pre><code>Arrays.fill(arr, new PriorityQueue&lt;&gt;(new Comparator&lt;&gt;(){\n            public int compare(int[] a, int[] b){\n                return b[1] - a[1];\n            }\n        }));\n</code></pre>\n<p>But this gives me an error, can anyone help what is wrong with this approach?</p>\n<p>The Code:</p>\n<pre><code>import java.util.*;\npublic class Main\n{\n    public static void main(String[] args) {\n        PriorityQueue&lt;long[]&gt;[] arr = new PriorityQueue[10];\n        Arrays.fill(arr, new PriorityQueue&lt;&gt;(new Comparator&lt;&gt;(){\n            public int compare(int[] a, int[] b){\n                return b[1] - a[1];\n            }\n        }));\n    }\n}\n</code></pre>\n<p>The Error:</p>\n<pre><code>Main.java:12: error: &lt;anonymous Main$1&gt; is not abstract and does not override abstract method compare(Object,Object) in Comparator\n        Arrays.fill(arr, new PriorityQueue&lt;&gt;(new Comparator&lt;&gt;(){\n                                                               ^\nMain.java:13: error: method does not override or implement a method from a supertype\n            public int compare(int[] a, int[] b){\n                       ^\n  (due to &lt;&gt;, every non-private method declared in this anonymous class must override or implement a method from a supertype)\n</code></pre>\n<p>Also is there a better way to assign object to each element of array during declaration?</p>\n"},{"tags":["java","project-reactor"],"answers":[{"tags":[],"owner":{"account_id":10877520,"reputation":120,"user_id":7997517,"display_name":"ABHISHEK KUMAR"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1681057130,"creation_date":1681057130,"answer_id":75971600,"question_id":75957388,"body_markdown":"Consider a situation, where you are producing something from an asynchronous function and the output is being consumed multiple times by different subscribers. In normal cases, the asynchronous function would be invoked each time a new subscriber joins. \r\n\r\n```\r\n Supplier&lt;Mono&lt;String&gt;&gt; supplier = () -&gt; {\r\n        System.out.println(&quot;invoke&quot;);\r\n        return Mono.just(&quot;nothing&quot;);\r\n    };\r\n Mono&lt;String&gt; mono = Mono.defer(supplier);\r\n mono.subscribe();  //prints &#39;invoke&#39;\r\n mono.subscribe();  //again prints &#39;invoke&#39;\r\n```\r\n\r\nHowever, if you don&#39;t want to invoke the upstream publisher for subsequent subscribers and optionally want some transformation on the original Mono, you can use publish method. (See the below snippet)\r\n\r\n```\r\nMono&lt;String&gt; m2 = Mono.defer(supplier).publish(stringMono -&gt; {\r\n          // Optionally can do some transformation.\r\n            stringMono.subscribe();  // prints &#39;invoke&#39;\r\n            stringMono.subscribe();  // nothing printed\r\n            stringMono.subscribe();  // nothing printed\r\n            return stringMono;\r\n        });\r\n```\r\n\r\nHere, &#39;invoke&#39; is printed only single times although we call **subscribe** 3 times. That&#39;s because, call to the upstream is made only once. ","title":"what is the major difference between operators publish() and map in Reactor","body":"<p>Consider a situation, where you are producing something from an asynchronous function and the output is being consumed multiple times by different subscribers. In normal cases, the asynchronous function would be invoked each time a new subscriber joins.</p>\n<pre><code> Supplier&lt;Mono&lt;String&gt;&gt; supplier = () -&gt; {\n        System.out.println(&quot;invoke&quot;);\n        return Mono.just(&quot;nothing&quot;);\n    };\n Mono&lt;String&gt; mono = Mono.defer(supplier);\n mono.subscribe();  //prints 'invoke'\n mono.subscribe();  //again prints 'invoke'\n</code></pre>\n<p>However, if you don't want to invoke the upstream publisher for subsequent subscribers and optionally want some transformation on the original Mono, you can use publish method. (See the below snippet)</p>\n<pre><code>Mono&lt;String&gt; m2 = Mono.defer(supplier).publish(stringMono -&gt; {\n          // Optionally can do some transformation.\n            stringMono.subscribe();  // prints 'invoke'\n            stringMono.subscribe();  // nothing printed\n            stringMono.subscribe();  // nothing printed\n            return stringMono;\n        });\n</code></pre>\n<p>Here, 'invoke' is printed only single times although we call <strong>subscribe</strong> 3 times. That's because, call to the upstream is made only once.</p>\n"}],"owner":{"account_id":27097454,"reputation":797,"user_id":20644506,"display_name":"Peng"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":49,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":75971600,"answer_count":1,"score":1,"last_activity_date":1681057130,"creation_date":1680861564,"question_id":75957388,"body_markdown":"I had read the java doc but i have no idea about the major usage scenarios\r\n\r\nhere is  doc ;\r\n``` java\r\n\t/**\r\n\t * Share a {@link Mono} for the duration of a function that may transform it and\r\n\t * consume it as many times as necessary without causing multiple subscriptions\r\n\t * to the upstream.\r\n\t *\r\n\t * @param transform the transformation function\r\n\t * @param &lt;R&gt; the output value type\r\n\t *\r\n\t * @return a new {@link Mono}\r\n\t */\r\n\tpublic final &lt;R&gt; Mono&lt;R&gt; publish(Function&lt;? super Mono&lt;T&gt;, ? extends Mono&lt;? extends\r\n\t\t\tR&gt;&gt; transform) {\r\n\t\treturn onAssembly(new MonoPublishMulticast&lt;&gt;(this, transform));\r\n\t}\r\n```\r\nI tried the unit test  code snippet below\r\n```java\r\n    @Test\r\n    public void publish(){\r\n        Mono&lt;String&gt; publish = Mono.just(&quot;test&quot;)\r\n                .doOnNext(s -&gt; log.info(&quot;publish --- {}&quot;,s))\r\n                .publish(mo -&gt; mo.map(e-&gt;e+&quot;add String&quot;))\r\n                .doOnNext(s -&gt; log.info(&quot;publish --- {}&quot;,s))\r\n                ;\r\n\r\n        Mono&lt;String&gt; map = Mono.just(&quot;test&quot;)\r\n                .doOnNext(s -&gt; log.info(&quot;publish --- {}&quot;, s))\r\n                .publish(mo -&gt; mo.map(e -&gt; e + &quot;add String&quot;))\r\n                .map(s -&gt; s + &quot;add String&quot;);\r\n\r\n   }\r\n```\r\n\r\nThe ```publish``` seems like  no difference  with ```map``` ,  both of them usage is trans the specify object to another type or value which is in same stream ","title":"what is the major difference between operators publish() and map in Reactor","body":"<p>I had read the java doc but i have no idea about the major usage scenarios</p>\n<p>here is  doc ;</p>\n<pre class=\"lang-java prettyprint-override\"><code>    /**\n     * Share a {@link Mono} for the duration of a function that may transform it and\n     * consume it as many times as necessary without causing multiple subscriptions\n     * to the upstream.\n     *\n     * @param transform the transformation function\n     * @param &lt;R&gt; the output value type\n     *\n     * @return a new {@link Mono}\n     */\n    public final &lt;R&gt; Mono&lt;R&gt; publish(Function&lt;? super Mono&lt;T&gt;, ? extends Mono&lt;? extends\n            R&gt;&gt; transform) {\n        return onAssembly(new MonoPublishMulticast&lt;&gt;(this, transform));\n    }\n</code></pre>\n<p>I tried the unit test  code snippet below</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @Test\n    public void publish(){\n        Mono&lt;String&gt; publish = Mono.just(&quot;test&quot;)\n                .doOnNext(s -&gt; log.info(&quot;publish --- {}&quot;,s))\n                .publish(mo -&gt; mo.map(e-&gt;e+&quot;add String&quot;))\n                .doOnNext(s -&gt; log.info(&quot;publish --- {}&quot;,s))\n                ;\n\n        Mono&lt;String&gt; map = Mono.just(&quot;test&quot;)\n                .doOnNext(s -&gt; log.info(&quot;publish --- {}&quot;, s))\n                .publish(mo -&gt; mo.map(e -&gt; e + &quot;add String&quot;))\n                .map(s -&gt; s + &quot;add String&quot;);\n\n   }\n</code></pre>\n<p>The <code>publish</code> seems like  no difference  with <code>map</code> ,  both of them usage is trans the specify object to another type or value which is in same stream</p>\n"},{"tags":["java","apache-spark","elasticsearch","java-8","elasticsearch-7"],"owner":{"account_id":7380527,"reputation":1100,"user_id":6305831,"accept_rate":75,"display_name":"Ryan"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":25,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681056414,"creation_date":1681056414,"question_id":75971541,"body_markdown":"I tried creating ElasticSearch embedded nodes in my spark 3 job using the following (pseudo) code:\r\n\r\n```java\r\nimport org.elasticsearch.node.Node;\r\n\r\npublic class ESNode extends Node {\r\npublic static createNode(String randomDataPath) {\r\n//create embedded node using randomly generated temp data path set as Environment.PATH_HOME_SETTING\r\n}\r\n}\r\nDataset&lt;MyType&gt; ds;\r\nds.mapPartitions(part -&gt; {\r\nESNode.createNode(randomDataPath);\r\n//Do other stuff with ES node\r\n})\r\n```\r\n\r\nIf each executor is allocated 1 core only, i.e. only one task will be running on each executor at a time, the above code runs successfully. If each executor is allocated more than one core, multiple embedded nodes will be started with different data paths (verified using logs), however when they process requests, they seem to be all using the data path of the last node, thus resulting in:\r\n\r\n```\r\njava.lang.IllegalStateException: failed to obtain node locks, tried [[/yarn_container_dir/tmp/data_path_of_last_node]] with lock id [0]; maybe these locations are not writable or multiple nodes were started without increasing [node.max_local_storage_nodes] (was [1])?\r\n```\r\n\r\nI&#39;m wondering if running multiple embedded nodes within the same JVM (i.e. executor) would result in any interference?","title":"Run Multiple ElasticSearch Embedded Nodes in Spark Executor","body":"<p>I tried creating ElasticSearch embedded nodes in my spark 3 job using the following (pseudo) code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.elasticsearch.node.Node;\n\npublic class ESNode extends Node {\npublic static createNode(String randomDataPath) {\n//create embedded node using randomly generated temp data path set as Environment.PATH_HOME_SETTING\n}\n}\nDataset&lt;MyType&gt; ds;\nds.mapPartitions(part -&gt; {\nESNode.createNode(randomDataPath);\n//Do other stuff with ES node\n})\n</code></pre>\n<p>If each executor is allocated 1 core only, i.e. only one task will be running on each executor at a time, the above code runs successfully. If each executor is allocated more than one core, multiple embedded nodes will be started with different data paths (verified using logs), however when they process requests, they seem to be all using the data path of the last node, thus resulting in:</p>\n<pre><code>java.lang.IllegalStateException: failed to obtain node locks, tried [[/yarn_container_dir/tmp/data_path_of_last_node]] with lock id [0]; maybe these locations are not writable or multiple nodes were started without increasing [node.max_local_storage_nodes] (was [1])?\n</code></pre>\n<p>I'm wondering if running multiple embedded nodes within the same JVM (i.e. executor) would result in any interference?</p>\n"},{"tags":["java","ssl","encryption","keystore","pem"],"comments":[{"owner":{"account_id":1028935,"reputation":1706,"user_id":1037644,"accept_rate":100,"display_name":"Tino M Thomas"},"score":0,"creation_date":1599754630,"post_id":63832456,"comment_id":112878971,"body_markdown":"Try this [out](https://stackoverflow.com/questions/11787571/how-to-read-pem-file-to-get-private-and-public-key)","body":"Try this <a href=\"https://stackoverflow.com/questions/11787571/how-to-read-pem-file-to-get-private-and-public-key\">out</a>"},{"owner":{"account_id":11125108,"reputation":5965,"user_id":8166854,"display_name":"Michael Fehr"},"score":0,"creation_date":1599759094,"post_id":63832456,"comment_id":112880941,"body_markdown":"Your main problem when using native Java-classes will be this error: &quot;PBE parameter parsing error: expecting the object identifier for AES cipher&quot; as your encrypted key is encrypted using PBKDF + TripleDES (see identifier: OBJECT IDENTIFIER des-EDE3-CBC (1 2 840 113549 3 7)) that is not (longer?) support by modern Java versions (the DES-part). I believe you have to use Bouncy Castle reading this kind of keys.","body":"Your main problem when using native Java-classes will be this error: &quot;PBE parameter parsing error: expecting the object identifier for AES cipher&quot; as your encrypted key is encrypted using PBKDF + TripleDES (see identifier: OBJECT IDENTIFIER des-EDE3-CBC (1 2 840 113549 3 7)) that is not (longer?) support by modern Java versions (the DES-part). I believe you have to use Bouncy Castle reading this kind of keys."},{"owner":{"account_id":3421244,"reputation":35883,"user_id":2868801,"display_name":"dave_thompson_085"},"score":0,"creation_date":1599767677,"post_id":63832456,"comment_id":112884348,"body_markdown":"@MichaelFehr: I don&#39;t know where you&#39;re looking, but tripleDES/TDEA is still widely used in PKCS8 (and also PKCS12 but then usually in PKCS12PBE not PBES2), is secure for _short_ data like a keyfile, and is supported by Java crypto under the algorithm name DESede. Although the PKCS8+PKCS5 format _allows_ AES, I don&#39;t know anyone currently using that. _JCE_ even supports single/original DES, although it should no longer be used, and is default disabled in JSSE _for SSL/TLS_.","body":"@MichaelFehr: I don&#39;t know where you&#39;re looking, but tripleDES/TDEA is still widely used in PKCS8 (and also PKCS12 but then usually in PKCS12PBE not PBES2), is secure for <i>short</i> data like a keyfile, and is supported by Java crypto under the algorithm name DESede. Although the PKCS8+PKCS5 format <i>allows</i> AES, I don&#39;t know anyone currently using that. <i>JCE</i> even supports single/original DES, although it should no longer be used, and is default disabled in JSSE <i>for SSL/TLS</i>."},{"owner":{"account_id":11125108,"reputation":5965,"user_id":8166854,"display_name":"Michael Fehr"},"score":0,"creation_date":1599771091,"post_id":63832456,"comment_id":112885714,"body_markdown":"@dave_thompson_085: I tried to parse the PEM (after stripping off the header and footer line) with this code: &quot;EncryptedPrivateKeyInfo pkInfo = new EncryptedPrivateKeyInfo(Base64.getMimeDecoder().decode(encrypted));&quot; and received the exception &quot;java.io.IOException: PBE parameter parsing error: expecting the object identifier for AES cipher&quot;. So for EncryptedPrivateKeyInfo there seems to be no tripleDES/TDEA cipher available, although when using it &quot;stand alone&quot; it&#39;s there. As you wrote in your answer we have to do the key derivation and following decryption on our own. Thanks for clearance.","body":"@dave_thompson_085: I tried to parse the PEM (after stripping off the header and footer line) with this code: &quot;EncryptedPrivateKeyInfo pkInfo = new EncryptedPrivateKeyInfo(Base64.getMimeDecoder().decode(encry&zwnj;&#8203;pted));&quot; and received the exception &quot;java.io.IOException: PBE parameter parsing error: expecting the object identifier for AES cipher&quot;. So for EncryptedPrivateKeyInfo there seems to be no tripleDES/TDEA cipher available, although when using it &quot;stand alone&quot; it&#39;s there. As you wrote in your answer we have to do the key derivation and following decryption on our own. Thanks for clearance."},{"owner":{"account_id":3421244,"reputation":35883,"user_id":2868801,"display_name":"dave_thompson_085"},"score":1,"creation_date":1599979941,"post_id":63832456,"comment_id":112939454,"body_markdown":"@MichaelFehr: Ah! [That&#39;s a known problem but it changed.](https://bugs.openjdk.java.net/browse/JDK-8076999) It used to not handle _any_ PBES2 params; I didn&#39;t notice in 11.0.1 they fixed it to work only for AES-128 and AES-256 (presumably not coincidentally, the only PBES2 schemes JCE implements directly) so I didn&#39;t recognize the new symptom. However I see they now plan to fix it for j16 due next year. Yay!","body":"@MichaelFehr: Ah! <a href=\"https://bugs.openjdk.java.net/browse/JDK-8076999\" rel=\"nofollow noreferrer\">That&#39;s a known problem but it changed.</a> It used to not handle <i>any</i> PBES2 params; I didn&#39;t notice in 11.0.1 they fixed it to work only for AES-128 and AES-256 (presumably not coincidentally, the only PBES2 schemes JCE implements directly) so I didn&#39;t recognize the new symptom. However I see they now plan to fix it for j16 due next year. Yay!"}],"answers":[{"comments":[{"owner":{"account_id":9107988,"reputation":3190,"user_id":6777695,"display_name":"Hakan54"},"score":0,"creation_date":1599926418,"post_id":63836765,"comment_id":112929562,"body_markdown":"Thank you for giving such detailed answer with additional context by referencing to tools.ietf.org It was really helpful and by now I understand how complex this stuff really is. You are right regarding the BouncyCastle library, it is not that heavy. I actually wanted to achieve it without any additional dependency, so that was my main reason to try without BC. Based on the answer you have provided I tried to implement the java code, unfortunately I get an exception. I posted my progress on my initial question, however I am not sure if I correctly applied your suggestions. Can you have a look?","body":"Thank you for giving such detailed answer with additional context by referencing to tools.ietf.org It was really helpful and by now I understand how complex this stuff really is. You are right regarding the BouncyCastle library, it is not that heavy. I actually wanted to achieve it without any additional dependency, so that was my main reason to try without BC. Based on the answer you have provided I tried to implement the java code, unfortunately I get an exception. I posted my progress on my initial question, however I am not sure if I correctly applied your suggestions. Can you have a look?"},{"owner":{"account_id":9107988,"reputation":3190,"user_id":6777695,"display_name":"Hakan54"},"score":0,"creation_date":1599992457,"post_id":63836765,"comment_id":112942129,"body_markdown":"The updated answer looks quite amazing, a lot of magic to me. I just tried it out and it works! Awesome Dave, thank you very much. I now understand how complex it can be and how error prone it can be. I think it would me much safer for me to just go with bouncy castle","body":"The updated answer looks quite amazing, a lot of magic to me. I just tried it out and it works! Awesome Dave, thank you very much. I now understand how complex it can be and how error prone it can be. I think it would me much safer for me to just go with bouncy castle"}],"tags":[],"owner":{"account_id":3421244,"reputation":35883,"user_id":2868801,"display_name":"dave_thompson_085"},"comment_count":2,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1599980559,"creation_date":1599767480,"answer_id":63836765,"question_id":63832456,"body_markdown":"A more official reference for this PEM format is [rfc7468 section 11](https://www.rfc-editor.org/rfc/rfc7468#section-11) which specifies that the ASN.1 content (after de-PEM) is PKCS8&#39;s encrypted form defined in [rfc5208 section 6](https://www.rfc-editor.org/rfc/rfc5208#section-6) and [appendix A](https://www.rfc-editor.org/rfc/rfc5208#appendix-A) which modifies it slightly to:\r\n```\r\nEncryptedPrivateKeyInfo ::= SEQUENCE {\r\n    encryptionAlgorithm AlgorithmIdentifier {{KeyEncryptionAlgorithms}},\r\n    encryptedData EncryptedData\r\n}\r\n\r\nEncryptedData ::= OCTET STRING\r\n\r\n(redacted)\r\n\r\nKeyEncryptionAlgorithms ALGORITHM-IDENTIFIER ::= {\r\n     ... -- For local profiles\r\n}\r\n```\r\n\r\nwhich fails to explain that the key-encryption algorithms _commonly_ used for PKCS8 (except in PKCS12) are the password-based encryptions defined in PKCS5 v2 [rfc2898](https://www.rfc-editor.org/rfc/rfc289) or now v2.1 [rfc8018](https://www.rfc-editor.org/rfc/rfc8018) (the minor differences don&#39;t matter here). In particular for the key file in your Q the AlgorithmIdentifier parses (with OpenSSL) as:\r\n```\r\n    4:d=1  hl=2 l=  64 cons:  SEQUENCE\r\n    6:d=2  hl=2 l=   9 prim:   OBJECT            :PBES2\r\n   17:d=2  hl=2 l=  51 cons:   SEQUENCE\r\n   19:d=3  hl=2 l=  27 cons:    SEQUENCE\r\n   21:d=4  hl=2 l=   9 prim:     OBJECT            :PBKDF2\r\n   32:d=4  hl=2 l=  14 cons:     SEQUENCE\r\n   34:d=5  hl=2 l=   8 prim:      OCTET STRING      [HEX DUMP]:F7F1520689D469C6\r\n   44:d=5  hl=2 l=   2 prim:      INTEGER           :0800\r\n   48:d=3  hl=2 l=  20 cons:    SEQUENCE\r\n   50:d=4  hl=2 l=   8 prim:     OBJECT            :des-ede3-cbc\r\n   60:d=4  hl=2 l=   8 prim:     OCTET STRING      [HEX DUMP]:9D1A44BCC1884EA7\r\n```\r\nPBES2 is defined in [section 6.2](https://www.rfc-editor.org/rfc/rfc8018#section-6.2) to consist of PBKDF2 key derivation followed by practically any symmetric encryption/decryption. \r\nYou should be able to see that the top-level parameters match `PBES2-Params` in [appendix A.4](https://www.rfc-editor.org/rfc/rfc8018#appendix-A.4) and the parameters within the keyDerivationFunc part match `PBKDF2-Params` in [appendix A.2](https://www.rfc-editor.org/rfc/rfc8018#appendix-A.2) (salt and iterationCount present, keyLength and prf omitted), while the parameter for the encryptionScheme part is simply an OCTET STRING containing the Initialization Vector (IV), see [appendix B.2.2](https://www.rfc-editor.org/rfc/rfc8018#appendix-B.2.2).\r\n\r\nThus to decrypt this you need to implement PBKDF2 key derivation as specified in [section 5.2](https://www.rfc-editor.org/rfc/rfc8018#section-5.2) with those parameters, &lt;strike&gt;which Java crypto supports as `SecretKeyFactory.getInstance(&quot;PBKDF2withHmacSHA1&quot;)` and `PBEKeySpec`,&lt;/strike&gt; and then triple-DES aka TDEA decryption with triple-length key aka keying option 1 in CBC mode with PKCS5/7 padding, which Java crypto supports as `Cipher.getInstance(&quot;DESede/CBC/PKCS5Padding&quot;)`, using the key derived from the first step and the IV from the input data as `IVParameterSpec`. The result will be a _PKCS8-unencrypted_ key structure, which you can run through a suitable `KeyFactory` as `PKCS8EncodedKeySpec`, just as you already do for the unencrypted input format.\r\n\r\nAlthough considering that a JRE is usually upward of 100MB to begin with, while Bouncy adds about 5MB and is shedloads easier to use, I can&#39;t say I agree with your assessment.\r\n\r\n-----\r\nUPDATE: I didn&#39;t realize, but JCE&#39;s SKF for PBKDF2 doesn&#39;t actually do the key derivation, it only packages up the data elements for use by a suitable `Cipher` algorithm -- and it doesn&#39;t implement a `Cipher` algorithm for the case we need here. So you&#39;ll need to **manually code PBKDF2** which fortunately(?) I already did for https://stackoverflow.com/questions/61613286/decrypt-file-encrypted-using-openssl-with-aes-cbc-256 . Putting those together, here&#39;s tested code:\r\n\r\n\tstatic void SO63832456ManualPKCS8EPBES2 (String[] args) throws Exception {\r\n\t\tString file = args[0], pass = args[1];\r\n\t\t// I use Bouncy to read because it&#39;s much easier for me, \r\n\t\t// but you should get the same results with any ASN.1 lib\r\n\t\tPemObject obj; try(Reader rdr = new FileReader(file);\r\n\t\t\t\tPEMParser p = new PEMParser(rdr) ){ obj = p.readPemObject(); }\r\n\t\tif( ! obj.getType().equals(&quot;ENCRYPTED PRIVATE KEY&quot;) ) throw new Exception (&quot;wrong type&quot;);\r\n\t\torg.bouncycastle.asn1.pkcs.EncryptedPrivateKeyInfo eki = org.bouncycastle.asn1.pkcs.EncryptedPrivateKeyInfo.getInstance(obj.getContent());\r\n\t\tAlgorithmIdentifier algid = eki.getEncryptionAlgorithm();\r\n\t\tif( ! algid.getAlgorithm().equals(PKCSObjectIdentifiers.id_PBES2) ) throw new Exception(&quot;not PBES2&quot;);\r\n\t\tPBES2Parameters top = PBES2Parameters.getInstance(algid.getParameters());\r\n\t\tKeyDerivationFunc kdf = top.getKeyDerivationFunc();\r\n\t\tif( ! kdf.getAlgorithm().equals(PKCSObjectIdentifiers.id_PBKDF2) ) throw new Exception(&quot;not PBKDF2&quot;);\r\n\t\tPBKDF2Params kdp = PBKDF2Params.getInstance(kdf.getParameters());\r\n\t\tEncryptionScheme esa = top.getEncryptionScheme();\r\n\t\tif( ! esa.getAlgorithm().equals(PKCSObjectIdentifiers.des_EDE3_CBC) ) throw new Exception(&quot;not DES3&quot;);\r\n\t\tASN1OctetString esp = ASN1OctetString.getInstance(esa.getParameters());\r\n\t\t// these are the (only) items actually used\r\n\t\tbyte[] salt = kdp.getSalt(), iv = esp.getOctets(), edata = eki.getEncryptedData(); \r\n\t\tint iter = kdp.getIterationCount().intValueExact();\r\n\t\t\r\n\t\t//SecretKeyFactory fact = SecretKeyFactory.getInstance(&quot;PBKDF2withHmacSHA1&quot;);\r\n\t\t//SecretKey skey = fact.generateSecret(new PBEKeySpec(pass.toCharArray(), salt, iter, 24));\r\n\t\tbyte[] skey = PBKDF2 (&quot;HmacSHA1&quot;, pass.getBytes(&quot;UTF-8&quot;), salt, iter, 24);\r\n\t\tCipher ciph = Cipher.getInstance(&quot;DESEDE/CBC/PKCS5Padding&quot;); \r\n\t\tciph.init(Cipher.DECRYPT_MODE, new SecretKeySpec(skey,&quot;DESEDE&quot;), new IvParameterSpec(iv));\r\n\t\tbyte[] plain = ciph.doFinal(edata);\r\n\t\t\r\n\t\tKeyFactory fac2 = KeyFactory.getInstance(&quot;RSA&quot;);\r\n\t\tPrivateKey pkey = fac2.generatePrivate(new PKCS8EncodedKeySpec(plain));\r\n\t\tSystem.out.println ( ((java.security.interfaces.RSAPrivateKey)pkey).getModulus() );\r\n\t}\r\n\r\n\tpublic static byte[] PBKDF2 (String prf, byte[] pass, byte[] salt, int iter, int len)\r\n\t\t\tthrows NoSuchProviderException, NoSuchAlgorithmException, InvalidKeyException {\r\n\t\tbyte[] result = new byte[len];\r\n\t\tMac mac = Mac.getInstance(prf);\r\n\t\tmac.init (new SecretKeySpec (pass,prf));\r\n\t\tbyte[] saltcnt = Arrays.copyOf (salt, salt.length+4);\r\n\t\twhile( /*remaining*/len&gt;0 ){\r\n\t\t\tfor( int o = saltcnt.length; --o&gt;=saltcnt.length-4; ) if( ++saltcnt[o] != 0 ) break; \r\n\t\t\tbyte[] u = saltcnt, x = new byte[mac.getMacLength()];\r\n\t\t\tfor( int i = 1; i &lt;= iter; i++ ){\r\n\t\t\t\tu = mac.doFinal (u); \r\n\t\t\t\tfor( int o = 0; o &lt; x.length; o++ ) x[o] ^= u[o];\r\n\t\t\t}\r\n\t\t\tint len2 = Math.min (len, x.length);\r\n\t\t\tSystem.arraycopy (x,0, result,result.length-len, len2);\r\n\t\t\tlen -= len2;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n    --&gt;\r\n    18998199686208613730227071552042680566660281525162377778227794768879762338654464000476266705180956908841709177555966832423085875590556580445428066261332223955361646420713402269532603328557674453787190302285379571808527818182992417461094551685532849252957724361115461909983939654809533488667032982867230996411860328826589806804115764031480737011900431983025490936659008858316889367140757195359233313370592669605576636360123189540118611655293825465309125578750878878980002346272931570343463549347548711194000065166346537274382220211242975801253306067862461345994215674963367480607539333468674983712264803816027753559737\r\n\r\nBleah!\r\n","title":"Parsing encrypted PKCS#8 encoded pem file programatically","body":"<p>A more official reference for this PEM format is <a href=\"https://www.rfc-editor.org/rfc/rfc7468#section-11\" rel=\"nofollow noreferrer\">rfc7468 section 11</a> which specifies that the ASN.1 content (after de-PEM) is PKCS8's encrypted form defined in <a href=\"https://www.rfc-editor.org/rfc/rfc5208#section-6\" rel=\"nofollow noreferrer\">rfc5208 section 6</a> and <a href=\"https://www.rfc-editor.org/rfc/rfc5208#appendix-A\" rel=\"nofollow noreferrer\">appendix A</a> which modifies it slightly to:</p>\n<pre><code>EncryptedPrivateKeyInfo ::= SEQUENCE {\n    encryptionAlgorithm AlgorithmIdentifier {{KeyEncryptionAlgorithms}},\n    encryptedData EncryptedData\n}\n\nEncryptedData ::= OCTET STRING\n\n(redacted)\n\nKeyEncryptionAlgorithms ALGORITHM-IDENTIFIER ::= {\n     ... -- For local profiles\n}\n</code></pre>\n<p>which fails to explain that the key-encryption algorithms <em>commonly</em> used for PKCS8 (except in PKCS12) are the password-based encryptions defined in PKCS5 v2 <a href=\"https://www.rfc-editor.org/rfc/rfc289\" rel=\"nofollow noreferrer\">rfc2898</a> or now v2.1 <a href=\"https://www.rfc-editor.org/rfc/rfc8018\" rel=\"nofollow noreferrer\">rfc8018</a> (the minor differences don't matter here). In particular for the key file in your Q the AlgorithmIdentifier parses (with OpenSSL) as:</p>\n<pre><code>    4:d=1  hl=2 l=  64 cons:  SEQUENCE\n    6:d=2  hl=2 l=   9 prim:   OBJECT            :PBES2\n   17:d=2  hl=2 l=  51 cons:   SEQUENCE\n   19:d=3  hl=2 l=  27 cons:    SEQUENCE\n   21:d=4  hl=2 l=   9 prim:     OBJECT            :PBKDF2\n   32:d=4  hl=2 l=  14 cons:     SEQUENCE\n   34:d=5  hl=2 l=   8 prim:      OCTET STRING      [HEX DUMP]:F7F1520689D469C6\n   44:d=5  hl=2 l=   2 prim:      INTEGER           :0800\n   48:d=3  hl=2 l=  20 cons:    SEQUENCE\n   50:d=4  hl=2 l=   8 prim:     OBJECT            :des-ede3-cbc\n   60:d=4  hl=2 l=   8 prim:     OCTET STRING      [HEX DUMP]:9D1A44BCC1884EA7\n</code></pre>\n<p>PBES2 is defined in <a href=\"https://www.rfc-editor.org/rfc/rfc8018#section-6.2\" rel=\"nofollow noreferrer\">section 6.2</a> to consist of PBKDF2 key derivation followed by practically any symmetric encryption/decryption.\nYou should be able to see that the top-level parameters match <code>PBES2-Params</code> in <a href=\"https://www.rfc-editor.org/rfc/rfc8018#appendix-A.4\" rel=\"nofollow noreferrer\">appendix A.4</a> and the parameters within the keyDerivationFunc part match <code>PBKDF2-Params</code> in <a href=\"https://www.rfc-editor.org/rfc/rfc8018#appendix-A.2\" rel=\"nofollow noreferrer\">appendix A.2</a> (salt and iterationCount present, keyLength and prf omitted), while the parameter for the encryptionScheme part is simply an OCTET STRING containing the Initialization Vector (IV), see <a href=\"https://www.rfc-editor.org/rfc/rfc8018#appendix-B.2.2\" rel=\"nofollow noreferrer\">appendix B.2.2</a>.</p>\n<p>Thus to decrypt this you need to implement PBKDF2 key derivation as specified in <a href=\"https://www.rfc-editor.org/rfc/rfc8018#section-5.2\" rel=\"nofollow noreferrer\">section 5.2</a> with those parameters, <strike>which Java crypto supports as <code>SecretKeyFactory.getInstance(&quot;PBKDF2withHmacSHA1&quot;)</code> and <code>PBEKeySpec</code>,</strike> and then triple-DES aka TDEA decryption with triple-length key aka keying option 1 in CBC mode with PKCS5/7 padding, which Java crypto supports as <code>Cipher.getInstance(&quot;DESede/CBC/PKCS5Padding&quot;)</code>, using the key derived from the first step and the IV from the input data as <code>IVParameterSpec</code>. The result will be a <em>PKCS8-unencrypted</em> key structure, which you can run through a suitable <code>KeyFactory</code> as <code>PKCS8EncodedKeySpec</code>, just as you already do for the unencrypted input format.</p>\n<p>Although considering that a JRE is usually upward of 100MB to begin with, while Bouncy adds about 5MB and is shedloads easier to use, I can't say I agree with your assessment.</p>\n<hr />\n<p>UPDATE: I didn't realize, but JCE's SKF for PBKDF2 doesn't actually do the key derivation, it only packages up the data elements for use by a suitable <code>Cipher</code> algorithm -- and it doesn't implement a <code>Cipher</code> algorithm for the case we need here. So you'll need to <strong>manually code PBKDF2</strong> which fortunately(?) I already did for <a href=\"https://stackoverflow.com/questions/61613286/decrypt-file-encrypted-using-openssl-with-aes-cbc-256\">Decrypt file encrypted using openssl with aes-cbc-256</a> . Putting those together, here's tested code:</p>\n<pre><code>static void SO63832456ManualPKCS8EPBES2 (String[] args) throws Exception {\n    String file = args[0], pass = args[1];\n    // I use Bouncy to read because it's much easier for me, \n    // but you should get the same results with any ASN.1 lib\n    PemObject obj; try(Reader rdr = new FileReader(file);\n            PEMParser p = new PEMParser(rdr) ){ obj = p.readPemObject(); }\n    if( ! obj.getType().equals(&quot;ENCRYPTED PRIVATE KEY&quot;) ) throw new Exception (&quot;wrong type&quot;);\n    org.bouncycastle.asn1.pkcs.EncryptedPrivateKeyInfo eki = org.bouncycastle.asn1.pkcs.EncryptedPrivateKeyInfo.getInstance(obj.getContent());\n    AlgorithmIdentifier algid = eki.getEncryptionAlgorithm();\n    if( ! algid.getAlgorithm().equals(PKCSObjectIdentifiers.id_PBES2) ) throw new Exception(&quot;not PBES2&quot;);\n    PBES2Parameters top = PBES2Parameters.getInstance(algid.getParameters());\n    KeyDerivationFunc kdf = top.getKeyDerivationFunc();\n    if( ! kdf.getAlgorithm().equals(PKCSObjectIdentifiers.id_PBKDF2) ) throw new Exception(&quot;not PBKDF2&quot;);\n    PBKDF2Params kdp = PBKDF2Params.getInstance(kdf.getParameters());\n    EncryptionScheme esa = top.getEncryptionScheme();\n    if( ! esa.getAlgorithm().equals(PKCSObjectIdentifiers.des_EDE3_CBC) ) throw new Exception(&quot;not DES3&quot;);\n    ASN1OctetString esp = ASN1OctetString.getInstance(esa.getParameters());\n    // these are the (only) items actually used\n    byte[] salt = kdp.getSalt(), iv = esp.getOctets(), edata = eki.getEncryptedData(); \n    int iter = kdp.getIterationCount().intValueExact();\n    \n    //SecretKeyFactory fact = SecretKeyFactory.getInstance(&quot;PBKDF2withHmacSHA1&quot;);\n    //SecretKey skey = fact.generateSecret(new PBEKeySpec(pass.toCharArray(), salt, iter, 24));\n    byte[] skey = PBKDF2 (&quot;HmacSHA1&quot;, pass.getBytes(&quot;UTF-8&quot;), salt, iter, 24);\n    Cipher ciph = Cipher.getInstance(&quot;DESEDE/CBC/PKCS5Padding&quot;); \n    ciph.init(Cipher.DECRYPT_MODE, new SecretKeySpec(skey,&quot;DESEDE&quot;), new IvParameterSpec(iv));\n    byte[] plain = ciph.doFinal(edata);\n    \n    KeyFactory fac2 = KeyFactory.getInstance(&quot;RSA&quot;);\n    PrivateKey pkey = fac2.generatePrivate(new PKCS8EncodedKeySpec(plain));\n    System.out.println ( ((java.security.interfaces.RSAPrivateKey)pkey).getModulus() );\n}\n\npublic static byte[] PBKDF2 (String prf, byte[] pass, byte[] salt, int iter, int len)\n        throws NoSuchProviderException, NoSuchAlgorithmException, InvalidKeyException {\n    byte[] result = new byte[len];\n    Mac mac = Mac.getInstance(prf);\n    mac.init (new SecretKeySpec (pass,prf));\n    byte[] saltcnt = Arrays.copyOf (salt, salt.length+4);\n    while( /*remaining*/len&gt;0 ){\n        for( int o = saltcnt.length; --o&gt;=saltcnt.length-4; ) if( ++saltcnt[o] != 0 ) break; \n        byte[] u = saltcnt, x = new byte[mac.getMacLength()];\n        for( int i = 1; i &lt;= iter; i++ ){\n            u = mac.doFinal (u); \n            for( int o = 0; o &lt; x.length; o++ ) x[o] ^= u[o];\n        }\n        int len2 = Math.min (len, x.length);\n        System.arraycopy (x,0, result,result.length-len, len2);\n        len -= len2;\n    }\n    return result;\n}\n\n--&gt;\n18998199686208613730227071552042680566660281525162377778227794768879762338654464000476266705180956908841709177555966832423085875590556580445428066261332223955361646420713402269532603328557674453787190302285379571808527818182992417461094551685532849252957724361115461909983939654809533488667032982867230996411860328826589806804115764031480737011900431983025490936659008858316889367140757195359233313370592669605576636360123189540118611655293825465309125578750878878980002346272931570343463549347548711194000065166346537274382220211242975801253306067862461345994215674963367480607539333468674983712264803816027753559737\n</code></pre>\n<p>Bleah!</p>\n"},{"comments":[{"owner":{"account_id":9107988,"reputation":3190,"user_id":6777695,"display_name":"Hakan54"},"score":0,"creation_date":1599927388,"post_id":63838256,"comment_id":112929818,"body_markdown":"Hi Michael, thank you for the answer. With this approach I can indeed create the private key. This would be a very nice alternative, however I would prefer to not parse it with openssl before supplying it to my java code. Any idea how I could get it working without the openssl code?","body":"Hi Michael, thank you for the answer. With this approach I can indeed create the private key. This would be a very nice alternative, however I would prefer to not parse it with openssl before supplying it to my java code. Any idea how I could get it working without the openssl code?"},{"owner":{"account_id":11125108,"reputation":5965,"user_id":8166854,"display_name":"Michael Fehr"},"score":0,"creation_date":1599927925,"post_id":63838256,"comment_id":112929968,"body_markdown":"I&#39;m sorry but I tried to read an encrypted RSA private key without Bouncy Castle but got no success, sorry.","body":"I&#39;m sorry but I tried to read an encrypted RSA private key without Bouncy Castle but got no success, sorry."}],"tags":[],"owner":{"account_id":11125108,"reputation":5965,"user_id":8166854,"display_name":"Michael Fehr"},"comment_count":2,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1599775348,"creation_date":1599775348,"answer_id":63838256,"question_id":63832456,"body_markdown":"If you don&#39;t be shy to convert your given encrypted private key prior with openssl you can use the sample code for easy parsing.\r\n\r\nTo run my example I saved your Encrypted Private Key to a file &#39;so_privatekey_secret.pem&#39;.\r\n\r\nUsing this comand line in openssl I converted the (already) encrypted key with another cipher and generated the (new) keyfile &#39;so_privatekey_3des_secret.pem&#39;:\r\n\r\n    openssl pkcs8 -v1 PBE-SHA1-3DES -topk8 -in so_privatekey_secret.pem -out so_privatekey_3des_secret.pem\r\n\r\nYour encrypted private key will look like:\r\n\r\n    -----BEGIN ENCRYPTED PRIVATE KEY-----\r\n    MIIE6jAcBgoqhkiG9w0BDAEDMA4ECAdT0CV4sPOPAgIIAASCBMi3H3WjyWEiAS/G\r\n    gw6gZTHiZFmidehU8XPh1HPYVb385u36WO16CwZVIBperQoXptCaE2LRwxmrN7T/\r\n    K2l59EHlV8i8FAfGKqvc7b1DW1fqx7jvw+/iT//3uNc3GHUNXfBrwHDi/MTghII4\r\n    gEFNUm7ZO7rAqeR7pJnZxm3giCvRHFbFcZRkz6LhCif3eYF9Lx3gSe2x6SPeNG/T\r\n    p0vrierxhHyCJk+S543J3cZ4vHUOjYzOsT1xz9hTbxAxeAEPkaCpD0P9jyth8M8k\r\n    2SRedRvR1Ia6r7sAfFz6XoHz5jH/lhd47EYpOc/A7rsgWkFLObwdFwGLRIvQsgeN\r\n    VXnwg5UoxRdjE3ZXQMFgHgzc4igmoVCjwgNZW6nAMwlcTctjsQyvRnAEnQbqLUw1\r\n    kddkjDzC1LFk+NiZ7L9oKVWAQuAQnLHMOxr8kJrTlSoS8zt5x5OEnR4I7JnUEHqs\r\n    2RythkJnoAsXaslBIkIXw4Kg6wisZjr/fL7ER0D0TBdZFPMvdMw8p4TxNxEF7v/K\r\n    G97HmCe39cVl3DkYayK2Bs4T6FxqbqUzUMOQnNHpbj82+ybEhm/5duhD5Kd/Inz7\r\n    8mTpDM08P7OMG27AiJDReQJ18XQ5y3DxQJu8UgfQEtjpVW3BQIVzYRM4JqEEv72h\r\n    YLELhtmBQom1SWadMW6jzRJRS+f+ivEApVyLcKlnPj2SY7niSmDjYChDx30fHoDt\r\n    z25UYBb8LmZ6P5rwNpMgGutBYqg721ioYt86mQsDDaLYOxjlhPfwbrQ9HqUrPCyQ\r\n    0UBeP9hNYkGbZQ+erZmyJ4hhlGGXz9v1LZ4xqNelKuUUREZaLWNVO7UwX2AgUebv\r\n    V7V3ne3ZNuLo5kDQqGz3hxwI4tcHgneNMpbxwdR7/B9QTXtirgZck9QIU6zxPhIf\r\n    agyCfpqE5pE3ln5n+FfbOik1pNcQxFr0nLy6vnlcTATLHftX0JycFc9OcJ9eRnI/\r\n    zk0ekYcw7QLxzNp/ews+Krwy+2SXaacTi+fXihCks10FZ/TEMYV0wC7OMW1yC35K\r\n    jUU12u7kSccvUk4xQftyA39XYCN6g7kxDqLjCfc6pMMWZZ9anSo7rmuQ6scoMhdr\r\n    904PcX3ne9rBJLv3a3W25TolNKZx6JofCViyIipcJY4FRyIRoIfwUTZ643KLSZ4o\r\n    nAPxtWHpbgA8ucrMKwQ0kbhT/qEvz3HxliL91N7qqMfZ3RfsgK2fUXQZ4zsU1oZ2\r\n    f7UT9+D0w/Pusond7SHPFo9G68GjsE48CQ1J/l5QreZ+bLxBohs2xM1WIz2TBJX9\r\n    ghdbo+0eatoxfq0o/H0vj66xMd8fvqePrzNw3kSqSpdQiZl95vqWM8Y7xEW0PxAU\r\n    78I0koI98v/3n9abSUNDhodPsk8I3abr7MoQsKe7VSu/x+mgMcfvNOiH6j6LuUDx\r\n    Eii7nfHhC/M69hWoh8Y+a2qPdbT2WMZSgXdBC+dCQeL4o6+flht6/24Eg+HAQMyY\r\n    3X5aH2ZM4BJAyJvdtj7btMDKq6nunyMywYhIOgKTZUg8wytxDsi2F4KyNKpXXgsj\r\n    0yR2L6EUYeQ1ZLG/NcM86sHueF1x38RznpyD4rujRGslWAKRXk4D2O2GpYS4rYRk\r\n    4r4pPXltZ472q7PGBfM=\r\n    -----END ENCRYPTED PRIVATE KEY-----\r\n\r\nRunning my sample program (**that does have no exception handling**) gives an output:\r\n\r\n    pkInfo.getAlgName: PBEWithSHA1AndDESede\r\n    decryptedPrivateKey: SunRsaSign RSA private CRT key, 2048 bits\r\n      params: null\r\n      modulus: 18998199686208613730227071552042680566660281525162377778227794768879762338654464000476266705180956908841709177555966832423085875590556580445428066261332223955361646420713402269532603328557674453787190302285379571808527818182992417461094551685532849252957724361115461909983939654809533488667032982867230996411860328826589806804115764031480737011900431983025490936659008858316889367140757195359233313370592669605576636360123189540118611655293825465309125578750878878980002346272931570343463549347548711194000065166346537274382220211242975801253306067862461345994215674963367480607539333468674983712264803816027753559737\r\n      private exponent: 2470690692670644289832084636740463653655882622624760758103597888447170520657826825702415751838767348735186037205082706146786714644526202528897926495648786865000645626802269367582073915029633022103975204027927584273373553784482725392082470421529769049284506228997163157587212073758970565083984956787424047216319298607371397767542633302071090323391531162434678662485530085857362259661656308472034152915312425224731842425134593468185574918070451135641322780271191791839285884885643517240131520070881951542294552185519522325857178404160441369354693465035929601010771762928436963178293113507661955562266846499005032897533\r\n\r\ncode:\r\n\r\n    import javax.crypto.EncryptedPrivateKeyInfo;\r\n    import javax.crypto.SecretKey;\r\n    import javax.crypto.SecretKeyFactory;\r\n    import javax.crypto.spec.PBEKeySpec;\r\n    import java.io.IOException;\r\n    import java.nio.file.Files;\r\n    import java.nio.file.Paths;\r\n    import java.security.*;\r\n    import java.security.spec.InvalidKeySpecException;\r\n    import java.security.spec.PKCS8EncodedKeySpec;\r\n    import java.util.Base64;\r\n    \r\n    public class ReadPkcs8PrivateKeysSo {\r\n        public static void main(String[] args) throws IOException, NoSuchAlgorithmException, InvalidKeySpecException, InvalidKeyException {\r\n    \r\n            String encrypted = new String(Files.readAllBytes(Paths.get(&quot;so_privatekey_3des_secret.pem&quot;)));\r\n            String password = &quot;secret&quot;;\r\n    \r\n            //Create object from encrypted private key\r\n            encrypted = encrypted.replace(&quot;-----BEGIN ENCRYPTED PRIVATE KEY-----&quot;, &quot;&quot;);\r\n            encrypted = encrypted.replace(&quot;-----END ENCRYPTED PRIVATE KEY-----&quot;, &quot;&quot;);\r\n            EncryptedPrivateKeyInfo pkInfo = new EncryptedPrivateKeyInfo(Base64.getMimeDecoder().decode(encrypted));\r\n            PBEKeySpec keySpec = new PBEKeySpec(password.toCharArray()); // password\r\n            System.out.println(&quot;pkInfo.getAlgName: &quot; + pkInfo.getAlgName());\r\n            SecretKeyFactory pbeKeyFactory = SecretKeyFactory.getInstance(pkInfo.getAlgName());\r\n            SecretKey secretKey = pbeKeyFactory.generateSecret(keySpec);\r\n            PKCS8EncodedKeySpec encodedKeySpec = pkInfo.getKeySpec(secretKey);\r\n            KeyFactory keyFactory = KeyFactory.getInstance(&quot;RSA&quot;);\r\n            PrivateKey decryptedPrivateKey = keyFactory.generatePrivate(encodedKeySpec);\r\n            System.out.println(&quot;decryptedPrivateKey: &quot; + decryptedPrivateKey);\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n","title":"Parsing encrypted PKCS#8 encoded pem file programatically","body":"<p>If you don't be shy to convert your given encrypted private key prior with openssl you can use the sample code for easy parsing.</p>\n<p>To run my example I saved your Encrypted Private Key to a file 'so_privatekey_secret.pem'.</p>\n<p>Using this comand line in openssl I converted the (already) encrypted key with another cipher and generated the (new) keyfile 'so_privatekey_3des_secret.pem':</p>\n<pre><code>openssl pkcs8 -v1 PBE-SHA1-3DES -topk8 -in so_privatekey_secret.pem -out so_privatekey_3des_secret.pem\n</code></pre>\n<p>Your encrypted private key will look like:</p>\n<pre><code>-----BEGIN ENCRYPTED PRIVATE KEY-----\nMIIE6jAcBgoqhkiG9w0BDAEDMA4ECAdT0CV4sPOPAgIIAASCBMi3H3WjyWEiAS/G\ngw6gZTHiZFmidehU8XPh1HPYVb385u36WO16CwZVIBperQoXptCaE2LRwxmrN7T/\nK2l59EHlV8i8FAfGKqvc7b1DW1fqx7jvw+/iT//3uNc3GHUNXfBrwHDi/MTghII4\ngEFNUm7ZO7rAqeR7pJnZxm3giCvRHFbFcZRkz6LhCif3eYF9Lx3gSe2x6SPeNG/T\np0vrierxhHyCJk+S543J3cZ4vHUOjYzOsT1xz9hTbxAxeAEPkaCpD0P9jyth8M8k\n2SRedRvR1Ia6r7sAfFz6XoHz5jH/lhd47EYpOc/A7rsgWkFLObwdFwGLRIvQsgeN\nVXnwg5UoxRdjE3ZXQMFgHgzc4igmoVCjwgNZW6nAMwlcTctjsQyvRnAEnQbqLUw1\nkddkjDzC1LFk+NiZ7L9oKVWAQuAQnLHMOxr8kJrTlSoS8zt5x5OEnR4I7JnUEHqs\n2RythkJnoAsXaslBIkIXw4Kg6wisZjr/fL7ER0D0TBdZFPMvdMw8p4TxNxEF7v/K\nG97HmCe39cVl3DkYayK2Bs4T6FxqbqUzUMOQnNHpbj82+ybEhm/5duhD5Kd/Inz7\n8mTpDM08P7OMG27AiJDReQJ18XQ5y3DxQJu8UgfQEtjpVW3BQIVzYRM4JqEEv72h\nYLELhtmBQom1SWadMW6jzRJRS+f+ivEApVyLcKlnPj2SY7niSmDjYChDx30fHoDt\nz25UYBb8LmZ6P5rwNpMgGutBYqg721ioYt86mQsDDaLYOxjlhPfwbrQ9HqUrPCyQ\n0UBeP9hNYkGbZQ+erZmyJ4hhlGGXz9v1LZ4xqNelKuUUREZaLWNVO7UwX2AgUebv\nV7V3ne3ZNuLo5kDQqGz3hxwI4tcHgneNMpbxwdR7/B9QTXtirgZck9QIU6zxPhIf\nagyCfpqE5pE3ln5n+FfbOik1pNcQxFr0nLy6vnlcTATLHftX0JycFc9OcJ9eRnI/\nzk0ekYcw7QLxzNp/ews+Krwy+2SXaacTi+fXihCks10FZ/TEMYV0wC7OMW1yC35K\njUU12u7kSccvUk4xQftyA39XYCN6g7kxDqLjCfc6pMMWZZ9anSo7rmuQ6scoMhdr\n904PcX3ne9rBJLv3a3W25TolNKZx6JofCViyIipcJY4FRyIRoIfwUTZ643KLSZ4o\nnAPxtWHpbgA8ucrMKwQ0kbhT/qEvz3HxliL91N7qqMfZ3RfsgK2fUXQZ4zsU1oZ2\nf7UT9+D0w/Pusond7SHPFo9G68GjsE48CQ1J/l5QreZ+bLxBohs2xM1WIz2TBJX9\nghdbo+0eatoxfq0o/H0vj66xMd8fvqePrzNw3kSqSpdQiZl95vqWM8Y7xEW0PxAU\n78I0koI98v/3n9abSUNDhodPsk8I3abr7MoQsKe7VSu/x+mgMcfvNOiH6j6LuUDx\nEii7nfHhC/M69hWoh8Y+a2qPdbT2WMZSgXdBC+dCQeL4o6+flht6/24Eg+HAQMyY\n3X5aH2ZM4BJAyJvdtj7btMDKq6nunyMywYhIOgKTZUg8wytxDsi2F4KyNKpXXgsj\n0yR2L6EUYeQ1ZLG/NcM86sHueF1x38RznpyD4rujRGslWAKRXk4D2O2GpYS4rYRk\n4r4pPXltZ472q7PGBfM=\n-----END ENCRYPTED PRIVATE KEY-----\n</code></pre>\n<p>Running my sample program (<strong>that does have no exception handling</strong>) gives an output:</p>\n<pre><code>pkInfo.getAlgName: PBEWithSHA1AndDESede\ndecryptedPrivateKey: SunRsaSign RSA private CRT key, 2048 bits\n  params: null\n  modulus: 18998199686208613730227071552042680566660281525162377778227794768879762338654464000476266705180956908841709177555966832423085875590556580445428066261332223955361646420713402269532603328557674453787190302285379571808527818182992417461094551685532849252957724361115461909983939654809533488667032982867230996411860328826589806804115764031480737011900431983025490936659008858316889367140757195359233313370592669605576636360123189540118611655293825465309125578750878878980002346272931570343463549347548711194000065166346537274382220211242975801253306067862461345994215674963367480607539333468674983712264803816027753559737\n  private exponent: 2470690692670644289832084636740463653655882622624760758103597888447170520657826825702415751838767348735186037205082706146786714644526202528897926495648786865000645626802269367582073915029633022103975204027927584273373553784482725392082470421529769049284506228997163157587212073758970565083984956787424047216319298607371397767542633302071090323391531162434678662485530085857362259661656308472034152915312425224731842425134593468185574918070451135641322780271191791839285884885643517240131520070881951542294552185519522325857178404160441369354693465035929601010771762928436963178293113507661955562266846499005032897533\n</code></pre>\n<p>code:</p>\n<pre><code>import javax.crypto.EncryptedPrivateKeyInfo;\nimport javax.crypto.SecretKey;\nimport javax.crypto.SecretKeyFactory;\nimport javax.crypto.spec.PBEKeySpec;\nimport java.io.IOException;\nimport java.nio.file.Files;\nimport java.nio.file.Paths;\nimport java.security.*;\nimport java.security.spec.InvalidKeySpecException;\nimport java.security.spec.PKCS8EncodedKeySpec;\nimport java.util.Base64;\n\npublic class ReadPkcs8PrivateKeysSo {\n    public static void main(String[] args) throws IOException, NoSuchAlgorithmException, InvalidKeySpecException, InvalidKeyException {\n\n        String encrypted = new String(Files.readAllBytes(Paths.get(&quot;so_privatekey_3des_secret.pem&quot;)));\n        String password = &quot;secret&quot;;\n\n        //Create object from encrypted private key\n        encrypted = encrypted.replace(&quot;-----BEGIN ENCRYPTED PRIVATE KEY-----&quot;, &quot;&quot;);\n        encrypted = encrypted.replace(&quot;-----END ENCRYPTED PRIVATE KEY-----&quot;, &quot;&quot;);\n        EncryptedPrivateKeyInfo pkInfo = new EncryptedPrivateKeyInfo(Base64.getMimeDecoder().decode(encrypted));\n        PBEKeySpec keySpec = new PBEKeySpec(password.toCharArray()); // password\n        System.out.println(&quot;pkInfo.getAlgName: &quot; + pkInfo.getAlgName());\n        SecretKeyFactory pbeKeyFactory = SecretKeyFactory.getInstance(pkInfo.getAlgName());\n        SecretKey secretKey = pbeKeyFactory.generateSecret(keySpec);\n        PKCS8EncodedKeySpec encodedKeySpec = pkInfo.getKeySpec(secretKey);\n        KeyFactory keyFactory = KeyFactory.getInstance(&quot;RSA&quot;);\n        PrivateKey decryptedPrivateKey = keyFactory.generatePrivate(encodedKeySpec);\n        System.out.println(&quot;decryptedPrivateKey: &quot; + decryptedPrivateKey);\n    }\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":9107988,"reputation":3190,"user_id":6777695,"display_name":"Hakan54"},"score":0,"creation_date":1599992332,"post_id":63864963,"comment_id":112942096,"body_markdown":"Thank you very much for pointing out my mistakes and also providing the correct adjustments to get it working! Why is the key length fixed and especially to that size, or is that by default? And also interesting to see that you needed to create the second secret key out of the first secret key","body":"Thank you very much for pointing out my mistakes and also providing the correct adjustments to get it working! Why is the key length fixed and especially to that size, or is that by default? And also interesting to see that you needed to create the second secret key out of the first secret key"},{"owner":{"account_id":11125108,"reputation":5965,"user_id":8166854,"display_name":"Michael Fehr"},"score":1,"creation_date":1599996637,"post_id":63864963,"comment_id":112943098,"body_markdown":"To get this peace of code running with the key given we knew that the key encryption was done using the &quot;old&quot; TripleDES-encryption (and not the AES-one that may be supported by Java &quot;out of the box&quot;). The TripleDES do need 3 keys of size &quot;8&quot; so I fixed the keyLength to &quot;24&quot; - now the code will NOT run with newer AES-encryption who will need a 16/24/32 keyLength. You don&#39;t need the 2 SecretKey&#39;s, I used it for clarification that may go away when nesting results.","body":"To get this peace of code running with the key given we knew that the key encryption was done using the &quot;old&quot; TripleDES-encryption (and not the AES-one that may be supported by Java &quot;out of the box&quot;). The TripleDES do need 3 keys of size &quot;8&quot; so I fixed the keyLength to &quot;24&quot; - now the code will NOT run with newer AES-encryption who will need a 16/24/32 keyLength. You don&#39;t need the 2 SecretKey&#39;s, I used it for clarification that may go away when nesting results."}],"tags":[],"owner":{"account_id":11125108,"reputation":5965,"user_id":8166854,"display_name":"Michael Fehr"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1599944773,"creation_date":1599944773,"answer_id":63864963,"question_id":63832456,"body_markdown":"Your edited code gives an error &quot;java.security.InvalidKeyException: Wrong key size&quot; and that&#39;s because you &quot;read&quot; the keyLength with this line:\r\n\r\n    int keyLength = encryptedPrivateKeyInfo.getEncoded().length;\r\n\r\nWith the given private key the length would be 1247 bits and that is not an allowed TripleDES length. You can fix it to (hardcoded):\r\n\r\n    int keyLength = 24 * 8;\r\n\r\nNow we get a keyLength of 192 bit = 24 byte and that&#39;s ok for an TripleDES-key but we receive a new error:\r\n\r\n    java.security.InvalidKeyException: Wrong algorithm: DESede or TripleDES required\r\n\r\nThe reason for this behavior is the following line (commented out) that can get fixed with the 2 additional lines:\r\n\r\n    // SecretKey secretKey = secretKeyFactory.generateSecret(pbeKeySpec); // ### old routine\r\n    SecretKey secretKeyPbkdf = secretKeyFactory.generateSecret(pbeKeySpec); // ### new\r\n    SecretKey secretKey = new SecretKeySpec(secretKeyPbkdf.getEncoded(), &quot;DESede&quot;); // ### new\r\n\r\nNow your code is successfully running and print outs the private key and the certificate:\r\n\r\n    original keyLength:  1247\r\n    fixed keyLength(bit): 192\r\n    \r\n    privateKey:\r\n    SunRsaSign RSA private CRT key, 2048 bits\r\n      params: null\r\n      modulus: 18998199686208613730227071552042680566660281525162377778227794768879762338654464000476266705180956908841709177555966832423085875590556580445428066261332223955361646420713402269532603328557674453787190302285379571808527818182992417461094551685532849252957724361115461909983939654809533488667032982867230996411860328826589806804115764031480737011900431983025490936659008858316889367140757195359233313370592669605576636360123189540118611655293825465309125578750878878980002346272931570343463549347548711194000065166346537274382220211242975801253306067862461345994215674963367480607539333468674983712264803816027753559737\r\n      private exponent: 2470690692670644289832084636740463653655882622624760758103597888447170520657826825702415751838767348735186037205082706146786714644526202528897926495648786865000645626802269367582073915029633022103975204027927584273373553784482725392082470421529769049284506228997163157587212073758970565083984956787424047216319298607371397767542633302071090323391531162434678662485530085857362259661656308472034152915312425224731842425134593468185574918070451135641322780271191791839285884885643517240131520070881951542294552185519522325857178404160441369354693465035929601010771762928436963178293113507661955562266846499005032897533\r\n    \r\n    number of certificates: 1\r\n    \r\n    certificate: 0 data:\r\n    [\r\n    [\r\n      Version: V3\r\n      Subject: CN=Hakan, OU=Amsterdam, O=Thunderberry, C=NL\r\n      Signature Algorithm: SHA256withRSA, OID = 1.2.840.113549.1.1.11\r\n    \r\n      Key:  Sun RSA public key, 2048 bits\r\n      params: null\r\n      modulus: 18998199686208613730227071552042680566660281525162377778227794768879762338654464000476266705180956908841709177555966832423085875590556580445428066261332223955361646420713402269532603328557674453787190302285379571808527818182992417461094551685532849252957724361115461909983939654809533488667032982867230996411860328826589806804115764031480737011900431983025490936659008858316889367140757195359233313370592669605576636360123189540118611655293825465309125578750878878980002346272931570343463549347548711194000065166346537274382220211242975801253306067862461345994215674963367480607539333468674983712264803816027753559737\r\n      public exponent: 65537\r\n      Validity: [From: Mon Aug 31 10:07:39 CEST 2020,\r\n                   To: Thu Aug 29 10:07:39 CEST 2030]\r\n      Issuer: CN=Hakan, OU=Amsterdam, O=Thunderberry, C=NL\r\n      SerialNumber: [    5671c8dd]\r\n    \r\n    Certificate Extensions: 2\r\n    [1]: ObjectId: 2.5.29.17 Criticality=true\r\n    SubjectAlternativeName [\r\n      DNSName: localhost\r\n      IPAddress: 127.0.0.1\r\n    ]\r\n    \r\n    [2]: ObjectId: 2.5.29.14 Criticality=false\r\n    SubjectKeyIdentifier [\r\n    KeyIdentifier [\r\n    0000: 78 53 EC 04 E0 A1 55 45   22 C8 25 C4 3F F5 89 40  xS....UE&quot;.%.?..@\r\n    0010: 51 07 A8 03                                        Q...\r\n    ]\r\n    ]\r\n    \r\n    ]\r\n      Algorithm: [SHA256withRSA]\r\n      Signature:\r\n    0000: 85 55 87 FC 28 19 D1 93   66 4D F8 85 00 E9 D6 75  .U..(...fM.....u\r\n    0010: A6 55 69 AE EF 00 53 D3   D9 86 D7 BA F9 58 60 84  .Ui...S......X`.\r\n    0020: 65 AE ED 01 FF 39 F6 31   FC 26 9F 95 B6 A3 50 AA  e....9.1.&amp;....P.\r\n    0030: A0 1B A1 C9 F1 2B 92 41   78 69 13 35 BD DB 88 8A  .....+.Axi.5....\r\n    0040: B5 23 95 C1 F8 F9 C1 57   AD 5D A0 B6 59 DF 79 64  .#.....W.]..Y.yd\r\n    0050: E0 FE C2 49 99 8C E4 25   31 9E 38 8A 91 94 1D 47  ...I...%1.8....G\r\n    0060: 28 2A A8 78 D0 AB CA 49   1C B2 29 04 09 0D 67 0A  (*.x...I..)...g.\r\n    0070: AA F5 A8 B8 7D 0D 7B 14   81 65 56 E7 B6 16 AA F3  .........eV.....\r\n    0080: F5 3F CC 4E 3B 6F C9 F6   C8 4C 07 A9 4E 85 FB 69  .?.N;o...L..N..i\r\n    0090: 6B 0A EA 67 68 4D 1B C7   EA 30 A8 D5 56 E5 29 14  k..ghM...0..V.).\r\n    00A0: 13 51 F9 63 83 43 FA D1   46 DA 9A EA E5 36 57 C6  .Q.c.C..F....6W.\r\n    00B0: 8E 39 9C 75 40 95 24 4D   D3 7B E9 83 82 B8 61 13  .9.u@.$M......a.\r\n    00C0: ED E7 5E BE 3A 5D 6D 15   DD 7B E1 D0 37 A9 9B 4F  ..^.:]m.....7..O\r\n    00D0: D3 8B C5 26 47 3B 46 90   AC 3C 83 98 D8 69 69 51  ...&amp;G;F..&lt;...iiQ\r\n    00E0: EE 42 7F CA B5 83 56 09   9E FC 5C A2 BC C2 D5 67  .B....V...\\....g\r\n    00F0: 7E 59 9F A8 4F DC F7 13   B5 9F F1 1C 56 F2 C2 76  .Y..O.......V..v\r\n    \r\n    ]\r\n\r\nHere is the full code that is running on Open Java 11:\r\n\r\n    import com.hierynomus.asn1.ASN1InputStream;\r\n    import com.hierynomus.asn1.encodingrules.der.DERDecoder;\r\n    import com.hierynomus.asn1.types.ASN1Object;\r\n    import com.hierynomus.asn1.types.constructed.ASN1Sequence;\r\n    import com.hierynomus.asn1.types.primitive.ASN1Integer;\r\n    import com.hierynomus.asn1.types.string.ASN1OctetString;\r\n    \r\n    import javax.crypto.*;\r\n    import javax.crypto.spec.IvParameterSpec;\r\n    import javax.crypto.spec.PBEKeySpec;\r\n    import javax.crypto.spec.SecretKeySpec;\r\n    import java.io.ByteArrayInputStream;\r\n    import java.io.IOException;\r\n    import java.math.BigInteger;\r\n    import java.security.*;\r\n    import java.security.cert.Certificate;\r\n    import java.security.cert.CertificateException;\r\n    import java.security.cert.CertificateFactory;\r\n    import java.security.spec.InvalidKeySpecException;\r\n    import java.security.spec.KeySpec;\r\n    import java.security.spec.PKCS8EncodedKeySpec;\r\n    import java.security.spec.RSAPrivateCrtKeySpec;\r\n    import java.util.*;\r\n    import java.util.regex.Matcher;\r\n    import java.util.regex.Pattern;\r\n    // https://mvnrepository.com/artifact/com.hierynomus/asn-one/0.4.0\r\n    // additionally you need https://mvnrepository.com/artifact/org.slf4j/slf4j-api/1.7.30\r\n    // and https://mvnrepository.com/artifact/org.slf4j/slf4j-log4j12/1.7.30\r\n    // https://mvnrepository.com/artifact/org.eclipse.equinox/org.apache.log4j/1.2.13.v200706111418\r\n    \r\n    class MainOrg3 {\r\n    \r\n        private static final String KEYSTORE_TYPE = &quot;PKCS12&quot;;\r\n        private static final String KEY_FACTORY_ALGORITHM = &quot;RSA&quot;;\r\n        private static final String CERTIFICATE_TYPE = &quot;X.509&quot;;\r\n    \r\n        private static final Pattern CERTIFICATE_PATTERN = Pattern.compile(&quot;-----BEGIN CERTIFICATE-----(.*?)-----END CERTIFICATE-----&quot;, Pattern.DOTALL);\r\n        private static final Pattern PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN PRIVATE KEY-----(.*?)-----END PRIVATE KEY-----&quot;, Pattern.DOTALL);\r\n        private static final Pattern ENCRYPTED_PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN ENCRYPTED PRIVATE KEY-----(.*?)-----END ENCRYPTED PRIVATE KEY-----&quot;, Pattern.DOTALL);\r\n        private static final Pattern RSA_PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN RSA PRIVATE KEY-----(.*?)-----END RSA PRIVATE KEY-----&quot;, Pattern.DOTALL);\r\n    \r\n        private static final String NEW_LINE = &quot;\\n&quot;;\r\n        private static final String EMPTY = &quot;&quot;;\r\n    \r\n        static char[] keyPassword = &quot;secret&quot;.toCharArray();\r\n    \r\n        public static void main(String[] args) throws CertificateException, NoSuchAlgorithmException, KeyStoreException, IOException, InvalidKeySpecException {\r\n            String privateKeyContent = &quot;-----BEGIN ENCRYPTED PRIVATE KEY-----\\n&quot; +\r\n                    &quot;MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQI9/FSBonUacYCAggA\\n&quot; +\r\n                    &quot;MBQGCCqGSIb3DQMHBAidGkS8wYhOpwSCBMi8JaSYOKudMNNFRpzL7QMIZgFtzDay\\n&quot; +\r\n                    &quot;MmOroy3lW34dOa7dusqDl4d2gklKcHCpbEaTYxm5aQJ1LuiOdGtFy7HwxOvKU5xz\\n&quot; +\r\n                    &quot;4qsJoeBIpE0eCTKjQW7/I38DzLXx2wUURqhMWOtFsWZEyR5Dqok3N9mIKKKBXAFG\\n&quot; +\r\n                    &quot;AwNjlTRW2LyPSttiIUGN01lthjifMWoLTWB1aSGOmGeJRBdSZeqZ15xKneR4H5ja\\n&quot; +\r\n                    &quot;yE88YcpOHCDKMIxi6ZVoKs7jDQhu8bBKqS8NsYyh1AlP9QkvWNal36jWSzhqYNzk\\n&quot; +\r\n                    &quot;NRWUOZngfkdbMALVfRtbrC215jHGWVwosPIIs8rkoarRv8s6QWS1Rg3YfQ3qgcRf\\n&quot; +\r\n                    &quot;s7hkDFKJf3TUXr+askfamV5hc300ZG64+ldX1YxWXY8Vd/wIvHAc/YE/lTyCgYrY\\n&quot; +\r\n                    &quot;19Am6MNBfp8/kXvzKj+PizB8oNDO4S8sSShEEzOQ5a/+MTC6bqB0DLWYGUqRbjLc\\n&quot; +\r\n                    &quot;PyYTC2C4i9Agx/GeGVE3c1UdtXiwwnt2XUn7Y1YGqABk0xGIY4J1NFTbSOxKl9hO\\n&quot; +\r\n                    &quot;arwopAFrZU5nsjjFzv1DJvhfQWnYX18kPSKNHDlia019M118qZ8ERwD9tH8ix9Fa\\n&quot; +\r\n                    &quot;R2tQdxn1aRGmvXSw+zFkbWD8aWs9n/B+QN1yllJqVoWypOld1yj+fVYYnYOtV1gK\\n&quot; +\r\n                    &quot;eiygrtrh3JJCvLbEQl4nOgJM3PlEtfBHSaunehIXQMD1z/NDUqgBYjuDPyqRxJeH\\n&quot; +\r\n                    &quot;Va5k72Nds5PeySKJJnICB3nZKjqgfLhNUrXa1SAQ4vqr0Ik/Lu9P7T+B1XiYwuUT\\n&quot; +\r\n                    &quot;a20+bxi/x89ZZqwp3jnDuHup7XcO1MtqsoOKP/JgkjVMesb8Q1W8i2dXzg+l4gkk\\n&quot; +\r\n                    &quot;l1ipreEGtT1YfFTq0DFelz6CjZFLDlGGeGWob94sW94DWTW0nsLPhQWEnwW1CcyJ\\n&quot; +\r\n                    &quot;oJbJdDEgdiIbRJoABDkTuVXLwTlgzHSHh6zeJvNvcojI7UI3nWYCVYvD3kwghXiP\\n&quot; +\r\n                    &quot;67sKGL3ug7PFDqLia46AudGY7CFh4+wpxyH+fidLC3FMdkDBA6xR6mGgEjRLXR9M\\n&quot; +\r\n                    &quot;TnJ/eSYP7eqYZeKn9EarcI7v1zM2IG0/PDQCetiI0ABiHpdKyRQuuiEavp3xC5Vi\\n&quot; +\r\n                    &quot;h7UmJNYt8Zsz3rwqAQ4FR2+Su5R34OOdRmxTaYLe96PXTpLcLef5TkYixSY7Tzgd\\n&quot; +\r\n                    &quot;PMyRxRPrywklUEFe4KK/KOcdolxybfsIsxQnupLAMEsO7/Cs7mouNHISK51haDRc\\n&quot; +\r\n                    &quot;vNbKQ5E4xOq1U4ThW5dHR29cGZillfmMzj05ZQh3ZX2TQJP45ahFET3v9kInWCwQ\\n&quot; +\r\n                    &quot;8atqclVPOSnASsJZ0PxjYgKZuY8QWYM6zpfWyWnfu/CHhWbRS/qX8T1ow2SMyPBL\\n&quot; +\r\n                    &quot;CQbZ+MhcdP0IrjoXhDFQsns16i/BPK5TTVqtEC2ywDf5P4/BOEZkySG9YNOd6THp\\n&quot; +\r\n                    &quot;VA/dVPafzmLy3ltqH+jG8ZH2+RtWx7kwBjiDWs5cF33BFrPS7AZlzMzZoCHLXD/r\\n&quot; +\r\n                    &quot;T/SmisybUKHMqri0x0RHeIByW0hogSByWiyIn8POabDzJV6Df9nQPziDGcSsvWfG\\n&quot; +\r\n                    &quot;7q+hizh6+nnXOY+GZx3ptwg9mA9R4QyCiFNQradOaXSPxyEL2IC77/srFfVEIaU4\\n&quot; +\r\n                    &quot;SRo=\\n&quot; +\r\n                    &quot;-----END ENCRYPTED PRIVATE KEY-----&quot;;\r\n    \r\n            String certificateContent = &quot;-----BEGIN CERTIFICATE-----\\n&quot; +\r\n                    &quot;MIIDTjCCAjagAwIBAgIEVnHI3TANBgkqhkiG9w0BAQsFADBIMQswCQYDVQQGEwJO\\n&quot; +\r\n                    &quot;TDEVMBMGA1UEChMMVGh1bmRlcmJlcnJ5MRIwEAYDVQQLEwlBbXN0ZXJkYW0xDjAM\\n&quot; +\r\n                    &quot;BgNVBAMTBUhha2FuMB4XDTIwMDgzMTA4MDczOVoXDTMwMDgyOTA4MDczOVowSDEL\\n&quot; +\r\n                    &quot;MAkGA1UEBhMCTkwxFTATBgNVBAoTDFRodW5kZXJiZXJyeTESMBAGA1UECxMJQW1z\\n&quot; +\r\n                    &quot;dGVyZGFtMQ4wDAYDVQQDEwVIYWthbjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC\\n&quot; +\r\n                    &quot;AQoCggEBAJZ+pqirEqEk4k1ow8vryld79oCO4P/1y+v60CkLpS2MpeHE3BogTr7g\\n&quot; +\r\n                    &quot;WWP5HdHBMU5l8yT5tXuyVZZqgyzo0q2Sdm7GGrNunHf6Z8vPQFu69sQC1utDM9u8\\n&quot; +\r\n                    &quot;ZFKiKsTNJ+5QS6KsOtlACyhaLoaPAWVjtvueMjVwmM9hfv/Gq6VyyuBm2x1C4HTj\\n&quot; +\r\n                    &quot;zPCLHE2G1D13EJaWsvyZLGSbl0GGXZGPhaDd/vnw5TW36mvNTWW+37ZIEk4kXANa\\n&quot; +\r\n                    &quot;FUNsJemm8HjB/PzHs3/SXGxuD8NKobg3+cNXYwAz2s2DI0W6Xw2g5bbrMQAdBRvn\\n&quot; +\r\n                    &quot;9/kNftMymDORw3RGwDM2ld4zQfIkNrkCAwEAAaNAMD4wHQYDVR0OBBYEFHhT7ATg\\n&quot; +\r\n                    &quot;oVVFIsglxD/1iUBRB6gDMB0GA1UdEQEB/wQTMBGCCWxvY2FsaG9zdIcEfwAAATAN\\n&quot; +\r\n                    &quot;BgkqhkiG9w0BAQsFAAOCAQEAhVWH/CgZ0ZNmTfiFAOnWdaZVaa7vAFPT2YbXuvlY\\n&quot; +\r\n                    &quot;YIRlru0B/zn2Mfwmn5W2o1CqoBuhyfErkkF4aRM1vduIirUjlcH4+cFXrV2gtlnf\\n&quot; +\r\n                    &quot;eWTg/sJJmYzkJTGeOIqRlB1HKCqoeNCrykkcsikECQ1nCqr1qLh9DXsUgWVW57YW\\n&quot; +\r\n                    &quot;qvP1P8xOO2/J9shMB6lOhftpawrqZ2hNG8fqMKjVVuUpFBNR+WODQ/rRRtqa6uU2\\n&quot; +\r\n                    &quot;V8aOOZx1QJUkTdN76YOCuGET7edevjpdbRXde+HQN6mbT9OLxSZHO0aQrDyDmNhp\\n&quot; +\r\n                    &quot;aVHuQn/KtYNWCZ78XKK8wtVnflmfqE/c9xO1n/EcVvLCdg==\\n&quot; +\r\n                    &quot;-----END CERTIFICATE-----&quot;;\r\n    \r\n            PrivateKey privateKey = parsePrivateKey(privateKeyContent);\r\n            Certificate[] certificates = parseCertificate(certificateContent).values()\r\n                    .toArray(new Certificate[]{});\r\n    \r\n            KeyStore keyStore = createEmptyKeyStore();\r\n            keyStore.setKeyEntry(&quot;client&quot;, privateKey, null, certificates);\r\n            System.out.println(&quot;\\nprivateKey:\\n&quot; + privateKey);\r\n            int certificatesLength = certificates.length;\r\n            System.out.println(&quot;\\nnumber of certificates: &quot; + certificatesLength);\r\n            for (int i = 0; i &lt; certificatesLength; i++) {\r\n                System.out.println(&quot;\\ncertificate: &quot; + i + &quot; data:\\n&quot; + certificates[i]);\r\n            }\r\n        }\r\n    \r\n        private static KeyStore createEmptyKeyStore() throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException {\r\n            KeyStore keyStore = KeyStore.getInstance(KEYSTORE_TYPE);\r\n            keyStore.load(null, null);\r\n            return keyStore;\r\n        }\r\n    \r\n        private static PrivateKey parsePrivateKey(String identityContent) throws NoSuchAlgorithmException, InvalidKeySpecException, IOException {\r\n            KeySpec keySpec = null;\r\n    \r\n            Matcher privateKeyMatcher = PRIVATE_KEY_PATTERN.matcher(identityContent);\r\n            if (privateKeyMatcher.find()) {\r\n                String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\r\n                byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\r\n                keySpec = new PKCS8EncodedKeySpec(decodedPrivateKeyContent);\r\n            }\r\n    \r\n            privateKeyMatcher = RSA_PRIVATE_KEY_PATTERN.matcher(identityContent);\r\n            if (privateKeyMatcher.find()) {\r\n                String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\r\n                byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\r\n                keySpec = getKeySpecFromAsn1StructuredData(decodedPrivateKeyContent);\r\n            }\r\n    \r\n            privateKeyMatcher = ENCRYPTED_PRIVATE_KEY_PATTERN.matcher(identityContent);\r\n            if (privateKeyMatcher.find()) {\r\n                String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\r\n                byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\r\n                try (ByteArrayInputStream privateKeyAsInputStream = new ByteArrayInputStream(decodedPrivateKeyContent)) {\r\n                    ASN1InputStream stream = new ASN1InputStream(new DERDecoder(), privateKeyAsInputStream);\r\n                    ASN1Sequence asn1Sequence = stream.readObject();\r\n                    ASN1OctetString privateKeyAsOctetString = (ASN1OctetString) asn1Sequence.get(1);\r\n                    ASN1OctetString saltAsOctetString = (ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(0);\r\n                    ASN1OctetString initializationVectorAsOctec = ((ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(1)).get(1));\r\n                    ASN1Integer iterationCount = (ASN1Integer) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(1);\r\n                    IvParameterSpec ivParameterSpec = new IvParameterSpec(initializationVectorAsOctec.getValue());\r\n                    SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(&quot;PBKDF2withHmacSHA1&quot;);\r\n                    EncryptedPrivateKeyInfo encryptedPrivateKeyInfo = new EncryptedPrivateKeyInfo(secretKeyFactory.getAlgorithm(), privateKeyAsOctetString.getValue());\r\n                    int keyLength = encryptedPrivateKeyInfo.getEncoded().length;\r\n                    System.out.println(&quot;original keyLength:  &quot; + keyLength);\r\n                    keyLength = 24 * 8; // ### fixed\r\n                    System.out.println(&quot;fixed keyLength(bit): &quot; + keyLength);\r\n                    PBEKeySpec pbeKeySpec = new PBEKeySpec(keyPassword, saltAsOctetString.getValue(), iterationCount.getValue().intValue(), keyLength);\r\n                    Cipher cipher = Cipher.getInstance(&quot;DESede/CBC/PKCS5Padding/&quot;);\r\n    \r\n                    // SecretKey secretKey = secretKeyFactory.generateSecret(pbeKeySpec); // ### old routine\r\n                    SecretKey secretKeyPbkdf = secretKeyFactory.generateSecret(pbeKeySpec); // ### new\r\n                    SecretKey secretKey = new SecretKeySpec(secretKeyPbkdf.getEncoded(), &quot;DESede&quot;); // ### new\r\n    \r\n                    cipher.init(Cipher.DECRYPT_MODE, secretKey, ivParameterSpec);\r\n                    keySpec = encryptedPrivateKeyInfo.getKeySpec(cipher);\r\n                    //PKCS8EncodedKeySpec keySpec = encryptedPrivateKeyInfo.getKeySpec(cipher);\r\n                } catch (NoSuchPaddingException | InvalidKeyException | InvalidAlgorithmParameterException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }\r\n    \r\n            Objects.requireNonNull(keySpec);\r\n    \r\n            KeyFactory keyFactory = KeyFactory.getInstance(KEY_FACTORY_ALGORITHM);\r\n            return keyFactory.generatePrivate(keySpec);\r\n        }\r\n    \r\n        private static KeySpec getKeySpecFromAsn1StructuredData(byte[] decodedPrivateKeyContent) throws IOException {\r\n            try(ByteArrayInputStream privateKeyAsInputStream = new ByteArrayInputStream(decodedPrivateKeyContent)) {\r\n                ASN1InputStream stream = new ASN1InputStream(new DERDecoder(), privateKeyAsInputStream);\r\n                ASN1Sequence asn1Sequence = stream.readObject();\r\n    \r\n                if (asn1Sequence.getValue().size() &lt; 9) {\r\n                    throw new RuntimeException(&quot;Parsed key content doesn&#39;t have the minimum required sequence size of 9&quot;);\r\n                }\r\n    \r\n                BigInteger modulus = extractIntValueFrom(asn1Sequence.get(1));\r\n                BigInteger publicExponent = extractIntValueFrom(asn1Sequence.get(2));\r\n                BigInteger privateExponent = extractIntValueFrom(asn1Sequence.get(3));\r\n                BigInteger primeP = extractIntValueFrom(asn1Sequence.get(4));\r\n                BigInteger primeQ = extractIntValueFrom(asn1Sequence.get(5));\r\n                BigInteger primeExponentP = extractIntValueFrom(asn1Sequence.get(6));\r\n                BigInteger primeExponentQ = extractIntValueFrom(asn1Sequence.get(7));\r\n                BigInteger crtCoefficient = extractIntValueFrom(asn1Sequence.get(8));\r\n    \r\n                return new RSAPrivateCrtKeySpec(\r\n                        modulus, publicExponent, privateExponent,\r\n                        primeP, primeQ, primeExponentP, primeExponentQ, crtCoefficient\r\n                );\r\n            }\r\n        }\r\n    \r\n        private static BigInteger extractIntValueFrom(ASN1Object&lt;?&gt; asn1Object) {\r\n            if (asn1Object instanceof ASN1Integer) {\r\n                return ((ASN1Integer) asn1Object).getValue();\r\n            } else {\r\n                throw new RuntimeException(String.format(\r\n                        &quot;Unable to parse the provided value of the object type [%s]. The type should be an instance of [%s]&quot;,\r\n                        asn1Object.getClass().getName(), ASN1Integer.class.getName())\r\n                );\r\n            }\r\n        }\r\n    \r\n        private static Map&lt;String, Certificate&gt; parseCertificate(String certificateContent) throws IOException, CertificateException {\r\n            Map&lt;String, Certificate&gt; certificates = new HashMap&lt;&gt;();\r\n            Matcher certificateMatcher = CERTIFICATE_PATTERN.matcher(certificateContent);\r\n    \r\n            while (certificateMatcher.find()) {\r\n                String sanitizedCertificate = certificateMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\r\n                byte[] decodedCertificate = Base64.getDecoder().decode(sanitizedCertificate);\r\n                try(ByteArrayInputStream certificateAsInputStream = new ByteArrayInputStream(decodedCertificate)) {\r\n                    CertificateFactory certificateFactory = CertificateFactory.getInstance(CERTIFICATE_TYPE);\r\n                    Certificate certificate = certificateFactory.generateCertificate(certificateAsInputStream);\r\n                    certificates.put(UUID.randomUUID().toString(), certificate);\r\n                }\r\n            }\r\n            return certificates;\r\n        }\r\n    }\r\n\r\n\r\n\r\n","title":"Parsing encrypted PKCS#8 encoded pem file programatically","body":"<p>Your edited code gives an error &quot;java.security.InvalidKeyException: Wrong key size&quot; and that's because you &quot;read&quot; the keyLength with this line:</p>\n<pre><code>int keyLength = encryptedPrivateKeyInfo.getEncoded().length;\n</code></pre>\n<p>With the given private key the length would be 1247 bits and that is not an allowed TripleDES length. You can fix it to (hardcoded):</p>\n<pre><code>int keyLength = 24 * 8;\n</code></pre>\n<p>Now we get a keyLength of 192 bit = 24 byte and that's ok for an TripleDES-key but we receive a new error:</p>\n<pre><code>java.security.InvalidKeyException: Wrong algorithm: DESede or TripleDES required\n</code></pre>\n<p>The reason for this behavior is the following line (commented out) that can get fixed with the 2 additional lines:</p>\n<pre><code>// SecretKey secretKey = secretKeyFactory.generateSecret(pbeKeySpec); // ### old routine\nSecretKey secretKeyPbkdf = secretKeyFactory.generateSecret(pbeKeySpec); // ### new\nSecretKey secretKey = new SecretKeySpec(secretKeyPbkdf.getEncoded(), &quot;DESede&quot;); // ### new\n</code></pre>\n<p>Now your code is successfully running and print outs the private key and the certificate:</p>\n<pre><code>original keyLength:  1247\nfixed keyLength(bit): 192\n\nprivateKey:\nSunRsaSign RSA private CRT key, 2048 bits\n  params: null\n  modulus: 18998199686208613730227071552042680566660281525162377778227794768879762338654464000476266705180956908841709177555966832423085875590556580445428066261332223955361646420713402269532603328557674453787190302285379571808527818182992417461094551685532849252957724361115461909983939654809533488667032982867230996411860328826589806804115764031480737011900431983025490936659008858316889367140757195359233313370592669605576636360123189540118611655293825465309125578750878878980002346272931570343463549347548711194000065166346537274382220211242975801253306067862461345994215674963367480607539333468674983712264803816027753559737\n  private exponent: 2470690692670644289832084636740463653655882622624760758103597888447170520657826825702415751838767348735186037205082706146786714644526202528897926495648786865000645626802269367582073915029633022103975204027927584273373553784482725392082470421529769049284506228997163157587212073758970565083984956787424047216319298607371397767542633302071090323391531162434678662485530085857362259661656308472034152915312425224731842425134593468185574918070451135641322780271191791839285884885643517240131520070881951542294552185519522325857178404160441369354693465035929601010771762928436963178293113507661955562266846499005032897533\n\nnumber of certificates: 1\n\ncertificate: 0 data:\n[\n[\n  Version: V3\n  Subject: CN=Hakan, OU=Amsterdam, O=Thunderberry, C=NL\n  Signature Algorithm: SHA256withRSA, OID = 1.2.840.113549.1.1.11\n\n  Key:  Sun RSA public key, 2048 bits\n  params: null\n  modulus: 18998199686208613730227071552042680566660281525162377778227794768879762338654464000476266705180956908841709177555966832423085875590556580445428066261332223955361646420713402269532603328557674453787190302285379571808527818182992417461094551685532849252957724361115461909983939654809533488667032982867230996411860328826589806804115764031480737011900431983025490936659008858316889367140757195359233313370592669605576636360123189540118611655293825465309125578750878878980002346272931570343463549347548711194000065166346537274382220211242975801253306067862461345994215674963367480607539333468674983712264803816027753559737\n  public exponent: 65537\n  Validity: [From: Mon Aug 31 10:07:39 CEST 2020,\n               To: Thu Aug 29 10:07:39 CEST 2030]\n  Issuer: CN=Hakan, OU=Amsterdam, O=Thunderberry, C=NL\n  SerialNumber: [    5671c8dd]\n\nCertificate Extensions: 2\n[1]: ObjectId: 2.5.29.17 Criticality=true\nSubjectAlternativeName [\n  DNSName: localhost\n  IPAddress: 127.0.0.1\n]\n\n[2]: ObjectId: 2.5.29.14 Criticality=false\nSubjectKeyIdentifier [\nKeyIdentifier [\n0000: 78 53 EC 04 E0 A1 55 45   22 C8 25 C4 3F F5 89 40  xS....UE&quot;.%.?..@\n0010: 51 07 A8 03                                        Q...\n]\n]\n\n]\n  Algorithm: [SHA256withRSA]\n  Signature:\n0000: 85 55 87 FC 28 19 D1 93   66 4D F8 85 00 E9 D6 75  .U..(...fM.....u\n0010: A6 55 69 AE EF 00 53 D3   D9 86 D7 BA F9 58 60 84  .Ui...S......X`.\n0020: 65 AE ED 01 FF 39 F6 31   FC 26 9F 95 B6 A3 50 AA  e....9.1.&amp;....P.\n0030: A0 1B A1 C9 F1 2B 92 41   78 69 13 35 BD DB 88 8A  .....+.Axi.5....\n0040: B5 23 95 C1 F8 F9 C1 57   AD 5D A0 B6 59 DF 79 64  .#.....W.]..Y.yd\n0050: E0 FE C2 49 99 8C E4 25   31 9E 38 8A 91 94 1D 47  ...I...%1.8....G\n0060: 28 2A A8 78 D0 AB CA 49   1C B2 29 04 09 0D 67 0A  (*.x...I..)...g.\n0070: AA F5 A8 B8 7D 0D 7B 14   81 65 56 E7 B6 16 AA F3  .........eV.....\n0080: F5 3F CC 4E 3B 6F C9 F6   C8 4C 07 A9 4E 85 FB 69  .?.N;o...L..N..i\n0090: 6B 0A EA 67 68 4D 1B C7   EA 30 A8 D5 56 E5 29 14  k..ghM...0..V.).\n00A0: 13 51 F9 63 83 43 FA D1   46 DA 9A EA E5 36 57 C6  .Q.c.C..F....6W.\n00B0: 8E 39 9C 75 40 95 24 4D   D3 7B E9 83 82 B8 61 13  .9.u@.$M......a.\n00C0: ED E7 5E BE 3A 5D 6D 15   DD 7B E1 D0 37 A9 9B 4F  ..^.:]m.....7..O\n00D0: D3 8B C5 26 47 3B 46 90   AC 3C 83 98 D8 69 69 51  ...&amp;G;F..&lt;...iiQ\n00E0: EE 42 7F CA B5 83 56 09   9E FC 5C A2 BC C2 D5 67  .B....V...\\....g\n00F0: 7E 59 9F A8 4F DC F7 13   B5 9F F1 1C 56 F2 C2 76  .Y..O.......V..v\n\n]\n</code></pre>\n<p>Here is the full code that is running on Open Java 11:</p>\n<pre><code>import com.hierynomus.asn1.ASN1InputStream;\nimport com.hierynomus.asn1.encodingrules.der.DERDecoder;\nimport com.hierynomus.asn1.types.ASN1Object;\nimport com.hierynomus.asn1.types.constructed.ASN1Sequence;\nimport com.hierynomus.asn1.types.primitive.ASN1Integer;\nimport com.hierynomus.asn1.types.string.ASN1OctetString;\n\nimport javax.crypto.*;\nimport javax.crypto.spec.IvParameterSpec;\nimport javax.crypto.spec.PBEKeySpec;\nimport javax.crypto.spec.SecretKeySpec;\nimport java.io.ByteArrayInputStream;\nimport java.io.IOException;\nimport java.math.BigInteger;\nimport java.security.*;\nimport java.security.cert.Certificate;\nimport java.security.cert.CertificateException;\nimport java.security.cert.CertificateFactory;\nimport java.security.spec.InvalidKeySpecException;\nimport java.security.spec.KeySpec;\nimport java.security.spec.PKCS8EncodedKeySpec;\nimport java.security.spec.RSAPrivateCrtKeySpec;\nimport java.util.*;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\n// https://mvnrepository.com/artifact/com.hierynomus/asn-one/0.4.0\n// additionally you need https://mvnrepository.com/artifact/org.slf4j/slf4j-api/1.7.30\n// and https://mvnrepository.com/artifact/org.slf4j/slf4j-log4j12/1.7.30\n// https://mvnrepository.com/artifact/org.eclipse.equinox/org.apache.log4j/1.2.13.v200706111418\n\nclass MainOrg3 {\n\n    private static final String KEYSTORE_TYPE = &quot;PKCS12&quot;;\n    private static final String KEY_FACTORY_ALGORITHM = &quot;RSA&quot;;\n    private static final String CERTIFICATE_TYPE = &quot;X.509&quot;;\n\n    private static final Pattern CERTIFICATE_PATTERN = Pattern.compile(&quot;-----BEGIN CERTIFICATE-----(.*?)-----END CERTIFICATE-----&quot;, Pattern.DOTALL);\n    private static final Pattern PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN PRIVATE KEY-----(.*?)-----END PRIVATE KEY-----&quot;, Pattern.DOTALL);\n    private static final Pattern ENCRYPTED_PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN ENCRYPTED PRIVATE KEY-----(.*?)-----END ENCRYPTED PRIVATE KEY-----&quot;, Pattern.DOTALL);\n    private static final Pattern RSA_PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN RSA PRIVATE KEY-----(.*?)-----END RSA PRIVATE KEY-----&quot;, Pattern.DOTALL);\n\n    private static final String NEW_LINE = &quot;\\n&quot;;\n    private static final String EMPTY = &quot;&quot;;\n\n    static char[] keyPassword = &quot;secret&quot;.toCharArray();\n\n    public static void main(String[] args) throws CertificateException, NoSuchAlgorithmException, KeyStoreException, IOException, InvalidKeySpecException {\n        String privateKeyContent = &quot;-----BEGIN ENCRYPTED PRIVATE KEY-----\\n&quot; +\n                &quot;MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQI9/FSBonUacYCAggA\\n&quot; +\n                &quot;MBQGCCqGSIb3DQMHBAidGkS8wYhOpwSCBMi8JaSYOKudMNNFRpzL7QMIZgFtzDay\\n&quot; +\n                &quot;MmOroy3lW34dOa7dusqDl4d2gklKcHCpbEaTYxm5aQJ1LuiOdGtFy7HwxOvKU5xz\\n&quot; +\n                &quot;4qsJoeBIpE0eCTKjQW7/I38DzLXx2wUURqhMWOtFsWZEyR5Dqok3N9mIKKKBXAFG\\n&quot; +\n                &quot;AwNjlTRW2LyPSttiIUGN01lthjifMWoLTWB1aSGOmGeJRBdSZeqZ15xKneR4H5ja\\n&quot; +\n                &quot;yE88YcpOHCDKMIxi6ZVoKs7jDQhu8bBKqS8NsYyh1AlP9QkvWNal36jWSzhqYNzk\\n&quot; +\n                &quot;NRWUOZngfkdbMALVfRtbrC215jHGWVwosPIIs8rkoarRv8s6QWS1Rg3YfQ3qgcRf\\n&quot; +\n                &quot;s7hkDFKJf3TUXr+askfamV5hc300ZG64+ldX1YxWXY8Vd/wIvHAc/YE/lTyCgYrY\\n&quot; +\n                &quot;19Am6MNBfp8/kXvzKj+PizB8oNDO4S8sSShEEzOQ5a/+MTC6bqB0DLWYGUqRbjLc\\n&quot; +\n                &quot;PyYTC2C4i9Agx/GeGVE3c1UdtXiwwnt2XUn7Y1YGqABk0xGIY4J1NFTbSOxKl9hO\\n&quot; +\n                &quot;arwopAFrZU5nsjjFzv1DJvhfQWnYX18kPSKNHDlia019M118qZ8ERwD9tH8ix9Fa\\n&quot; +\n                &quot;R2tQdxn1aRGmvXSw+zFkbWD8aWs9n/B+QN1yllJqVoWypOld1yj+fVYYnYOtV1gK\\n&quot; +\n                &quot;eiygrtrh3JJCvLbEQl4nOgJM3PlEtfBHSaunehIXQMD1z/NDUqgBYjuDPyqRxJeH\\n&quot; +\n                &quot;Va5k72Nds5PeySKJJnICB3nZKjqgfLhNUrXa1SAQ4vqr0Ik/Lu9P7T+B1XiYwuUT\\n&quot; +\n                &quot;a20+bxi/x89ZZqwp3jnDuHup7XcO1MtqsoOKP/JgkjVMesb8Q1W8i2dXzg+l4gkk\\n&quot; +\n                &quot;l1ipreEGtT1YfFTq0DFelz6CjZFLDlGGeGWob94sW94DWTW0nsLPhQWEnwW1CcyJ\\n&quot; +\n                &quot;oJbJdDEgdiIbRJoABDkTuVXLwTlgzHSHh6zeJvNvcojI7UI3nWYCVYvD3kwghXiP\\n&quot; +\n                &quot;67sKGL3ug7PFDqLia46AudGY7CFh4+wpxyH+fidLC3FMdkDBA6xR6mGgEjRLXR9M\\n&quot; +\n                &quot;TnJ/eSYP7eqYZeKn9EarcI7v1zM2IG0/PDQCetiI0ABiHpdKyRQuuiEavp3xC5Vi\\n&quot; +\n                &quot;h7UmJNYt8Zsz3rwqAQ4FR2+Su5R34OOdRmxTaYLe96PXTpLcLef5TkYixSY7Tzgd\\n&quot; +\n                &quot;PMyRxRPrywklUEFe4KK/KOcdolxybfsIsxQnupLAMEsO7/Cs7mouNHISK51haDRc\\n&quot; +\n                &quot;vNbKQ5E4xOq1U4ThW5dHR29cGZillfmMzj05ZQh3ZX2TQJP45ahFET3v9kInWCwQ\\n&quot; +\n                &quot;8atqclVPOSnASsJZ0PxjYgKZuY8QWYM6zpfWyWnfu/CHhWbRS/qX8T1ow2SMyPBL\\n&quot; +\n                &quot;CQbZ+MhcdP0IrjoXhDFQsns16i/BPK5TTVqtEC2ywDf5P4/BOEZkySG9YNOd6THp\\n&quot; +\n                &quot;VA/dVPafzmLy3ltqH+jG8ZH2+RtWx7kwBjiDWs5cF33BFrPS7AZlzMzZoCHLXD/r\\n&quot; +\n                &quot;T/SmisybUKHMqri0x0RHeIByW0hogSByWiyIn8POabDzJV6Df9nQPziDGcSsvWfG\\n&quot; +\n                &quot;7q+hizh6+nnXOY+GZx3ptwg9mA9R4QyCiFNQradOaXSPxyEL2IC77/srFfVEIaU4\\n&quot; +\n                &quot;SRo=\\n&quot; +\n                &quot;-----END ENCRYPTED PRIVATE KEY-----&quot;;\n\n        String certificateContent = &quot;-----BEGIN CERTIFICATE-----\\n&quot; +\n                &quot;MIIDTjCCAjagAwIBAgIEVnHI3TANBgkqhkiG9w0BAQsFADBIMQswCQYDVQQGEwJO\\n&quot; +\n                &quot;TDEVMBMGA1UEChMMVGh1bmRlcmJlcnJ5MRIwEAYDVQQLEwlBbXN0ZXJkYW0xDjAM\\n&quot; +\n                &quot;BgNVBAMTBUhha2FuMB4XDTIwMDgzMTA4MDczOVoXDTMwMDgyOTA4MDczOVowSDEL\\n&quot; +\n                &quot;MAkGA1UEBhMCTkwxFTATBgNVBAoTDFRodW5kZXJiZXJyeTESMBAGA1UECxMJQW1z\\n&quot; +\n                &quot;dGVyZGFtMQ4wDAYDVQQDEwVIYWthbjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC\\n&quot; +\n                &quot;AQoCggEBAJZ+pqirEqEk4k1ow8vryld79oCO4P/1y+v60CkLpS2MpeHE3BogTr7g\\n&quot; +\n                &quot;WWP5HdHBMU5l8yT5tXuyVZZqgyzo0q2Sdm7GGrNunHf6Z8vPQFu69sQC1utDM9u8\\n&quot; +\n                &quot;ZFKiKsTNJ+5QS6KsOtlACyhaLoaPAWVjtvueMjVwmM9hfv/Gq6VyyuBm2x1C4HTj\\n&quot; +\n                &quot;zPCLHE2G1D13EJaWsvyZLGSbl0GGXZGPhaDd/vnw5TW36mvNTWW+37ZIEk4kXANa\\n&quot; +\n                &quot;FUNsJemm8HjB/PzHs3/SXGxuD8NKobg3+cNXYwAz2s2DI0W6Xw2g5bbrMQAdBRvn\\n&quot; +\n                &quot;9/kNftMymDORw3RGwDM2ld4zQfIkNrkCAwEAAaNAMD4wHQYDVR0OBBYEFHhT7ATg\\n&quot; +\n                &quot;oVVFIsglxD/1iUBRB6gDMB0GA1UdEQEB/wQTMBGCCWxvY2FsaG9zdIcEfwAAATAN\\n&quot; +\n                &quot;BgkqhkiG9w0BAQsFAAOCAQEAhVWH/CgZ0ZNmTfiFAOnWdaZVaa7vAFPT2YbXuvlY\\n&quot; +\n                &quot;YIRlru0B/zn2Mfwmn5W2o1CqoBuhyfErkkF4aRM1vduIirUjlcH4+cFXrV2gtlnf\\n&quot; +\n                &quot;eWTg/sJJmYzkJTGeOIqRlB1HKCqoeNCrykkcsikECQ1nCqr1qLh9DXsUgWVW57YW\\n&quot; +\n                &quot;qvP1P8xOO2/J9shMB6lOhftpawrqZ2hNG8fqMKjVVuUpFBNR+WODQ/rRRtqa6uU2\\n&quot; +\n                &quot;V8aOOZx1QJUkTdN76YOCuGET7edevjpdbRXde+HQN6mbT9OLxSZHO0aQrDyDmNhp\\n&quot; +\n                &quot;aVHuQn/KtYNWCZ78XKK8wtVnflmfqE/c9xO1n/EcVvLCdg==\\n&quot; +\n                &quot;-----END CERTIFICATE-----&quot;;\n\n        PrivateKey privateKey = parsePrivateKey(privateKeyContent);\n        Certificate[] certificates = parseCertificate(certificateContent).values()\n                .toArray(new Certificate[]{});\n\n        KeyStore keyStore = createEmptyKeyStore();\n        keyStore.setKeyEntry(&quot;client&quot;, privateKey, null, certificates);\n        System.out.println(&quot;\\nprivateKey:\\n&quot; + privateKey);\n        int certificatesLength = certificates.length;\n        System.out.println(&quot;\\nnumber of certificates: &quot; + certificatesLength);\n        for (int i = 0; i &lt; certificatesLength; i++) {\n            System.out.println(&quot;\\ncertificate: &quot; + i + &quot; data:\\n&quot; + certificates[i]);\n        }\n    }\n\n    private static KeyStore createEmptyKeyStore() throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException {\n        KeyStore keyStore = KeyStore.getInstance(KEYSTORE_TYPE);\n        keyStore.load(null, null);\n        return keyStore;\n    }\n\n    private static PrivateKey parsePrivateKey(String identityContent) throws NoSuchAlgorithmException, InvalidKeySpecException, IOException {\n        KeySpec keySpec = null;\n\n        Matcher privateKeyMatcher = PRIVATE_KEY_PATTERN.matcher(identityContent);\n        if (privateKeyMatcher.find()) {\n            String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\n            byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\n            keySpec = new PKCS8EncodedKeySpec(decodedPrivateKeyContent);\n        }\n\n        privateKeyMatcher = RSA_PRIVATE_KEY_PATTERN.matcher(identityContent);\n        if (privateKeyMatcher.find()) {\n            String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\n            byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\n            keySpec = getKeySpecFromAsn1StructuredData(decodedPrivateKeyContent);\n        }\n\n        privateKeyMatcher = ENCRYPTED_PRIVATE_KEY_PATTERN.matcher(identityContent);\n        if (privateKeyMatcher.find()) {\n            String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\n            byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\n            try (ByteArrayInputStream privateKeyAsInputStream = new ByteArrayInputStream(decodedPrivateKeyContent)) {\n                ASN1InputStream stream = new ASN1InputStream(new DERDecoder(), privateKeyAsInputStream);\n                ASN1Sequence asn1Sequence = stream.readObject();\n                ASN1OctetString privateKeyAsOctetString = (ASN1OctetString) asn1Sequence.get(1);\n                ASN1OctetString saltAsOctetString = (ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(0);\n                ASN1OctetString initializationVectorAsOctec = ((ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(1)).get(1));\n                ASN1Integer iterationCount = (ASN1Integer) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(1);\n                IvParameterSpec ivParameterSpec = new IvParameterSpec(initializationVectorAsOctec.getValue());\n                SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(&quot;PBKDF2withHmacSHA1&quot;);\n                EncryptedPrivateKeyInfo encryptedPrivateKeyInfo = new EncryptedPrivateKeyInfo(secretKeyFactory.getAlgorithm(), privateKeyAsOctetString.getValue());\n                int keyLength = encryptedPrivateKeyInfo.getEncoded().length;\n                System.out.println(&quot;original keyLength:  &quot; + keyLength);\n                keyLength = 24 * 8; // ### fixed\n                System.out.println(&quot;fixed keyLength(bit): &quot; + keyLength);\n                PBEKeySpec pbeKeySpec = new PBEKeySpec(keyPassword, saltAsOctetString.getValue(), iterationCount.getValue().intValue(), keyLength);\n                Cipher cipher = Cipher.getInstance(&quot;DESede/CBC/PKCS5Padding/&quot;);\n\n                // SecretKey secretKey = secretKeyFactory.generateSecret(pbeKeySpec); // ### old routine\n                SecretKey secretKeyPbkdf = secretKeyFactory.generateSecret(pbeKeySpec); // ### new\n                SecretKey secretKey = new SecretKeySpec(secretKeyPbkdf.getEncoded(), &quot;DESede&quot;); // ### new\n\n                cipher.init(Cipher.DECRYPT_MODE, secretKey, ivParameterSpec);\n                keySpec = encryptedPrivateKeyInfo.getKeySpec(cipher);\n                //PKCS8EncodedKeySpec keySpec = encryptedPrivateKeyInfo.getKeySpec(cipher);\n            } catch (NoSuchPaddingException | InvalidKeyException | InvalidAlgorithmParameterException e) {\n                e.printStackTrace();\n            }\n        }\n\n        Objects.requireNonNull(keySpec);\n\n        KeyFactory keyFactory = KeyFactory.getInstance(KEY_FACTORY_ALGORITHM);\n        return keyFactory.generatePrivate(keySpec);\n    }\n\n    private static KeySpec getKeySpecFromAsn1StructuredData(byte[] decodedPrivateKeyContent) throws IOException {\n        try(ByteArrayInputStream privateKeyAsInputStream = new ByteArrayInputStream(decodedPrivateKeyContent)) {\n            ASN1InputStream stream = new ASN1InputStream(new DERDecoder(), privateKeyAsInputStream);\n            ASN1Sequence asn1Sequence = stream.readObject();\n\n            if (asn1Sequence.getValue().size() &lt; 9) {\n                throw new RuntimeException(&quot;Parsed key content doesn't have the minimum required sequence size of 9&quot;);\n            }\n\n            BigInteger modulus = extractIntValueFrom(asn1Sequence.get(1));\n            BigInteger publicExponent = extractIntValueFrom(asn1Sequence.get(2));\n            BigInteger privateExponent = extractIntValueFrom(asn1Sequence.get(3));\n            BigInteger primeP = extractIntValueFrom(asn1Sequence.get(4));\n            BigInteger primeQ = extractIntValueFrom(asn1Sequence.get(5));\n            BigInteger primeExponentP = extractIntValueFrom(asn1Sequence.get(6));\n            BigInteger primeExponentQ = extractIntValueFrom(asn1Sequence.get(7));\n            BigInteger crtCoefficient = extractIntValueFrom(asn1Sequence.get(8));\n\n            return new RSAPrivateCrtKeySpec(\n                    modulus, publicExponent, privateExponent,\n                    primeP, primeQ, primeExponentP, primeExponentQ, crtCoefficient\n            );\n        }\n    }\n\n    private static BigInteger extractIntValueFrom(ASN1Object&lt;?&gt; asn1Object) {\n        if (asn1Object instanceof ASN1Integer) {\n            return ((ASN1Integer) asn1Object).getValue();\n        } else {\n            throw new RuntimeException(String.format(\n                    &quot;Unable to parse the provided value of the object type [%s]. The type should be an instance of [%s]&quot;,\n                    asn1Object.getClass().getName(), ASN1Integer.class.getName())\n            );\n        }\n    }\n\n    private static Map&lt;String, Certificate&gt; parseCertificate(String certificateContent) throws IOException, CertificateException {\n        Map&lt;String, Certificate&gt; certificates = new HashMap&lt;&gt;();\n        Matcher certificateMatcher = CERTIFICATE_PATTERN.matcher(certificateContent);\n\n        while (certificateMatcher.find()) {\n            String sanitizedCertificate = certificateMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\n            byte[] decodedCertificate = Base64.getDecoder().decode(sanitizedCertificate);\n            try(ByteArrayInputStream certificateAsInputStream = new ByteArrayInputStream(decodedCertificate)) {\n                CertificateFactory certificateFactory = CertificateFactory.getInstance(CERTIFICATE_TYPE);\n                Certificate certificate = certificateFactory.generateCertificate(certificateAsInputStream);\n                certificates.put(UUID.randomUUID().toString(), certificate);\n            }\n        }\n        return certificates;\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":593875,"reputation":20381,"user_id":276232,"accept_rate":50,"display_name":"Christopher Schultz"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1651613049,"creation_date":1651613049,"answer_id":72105611,"question_id":63832456,"body_markdown":"I spent a number of weeks working on my [pem-utils](https://github.com/ChristopherSchultz/pem-utils/) project on GitHub and I now have pure-Java code with no external libraries that seems to be able to load anything I throw at it.\r\n\r\nI hope this helps the original poster (from 18 months ago!) as well as anyone else following in our footsteps.","title":"Parsing encrypted PKCS#8 encoded pem file programatically","body":"<p>I spent a number of weeks working on my <a href=\"https://github.com/ChristopherSchultz/pem-utils/\" rel=\"nofollow noreferrer\">pem-utils</a> project on GitHub and I now have pure-Java code with no external libraries that seems to be able to load anything I throw at it.</p>\n<p>I hope this helps the original poster (from 18 months ago!) as well as anyone else following in our footsteps.</p>\n"},{"tags":[],"owner":{"account_id":9107988,"reputation":3190,"user_id":6777695,"display_name":"Hakan54"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1681056320,"creation_date":1651617940,"answer_id":72106194,"question_id":63832456,"body_markdown":"In the end I decided to use BC to parse the PEM files for certificates and private keys. In my use case I needed to handle all different kind of private keys and therefor the complexity also grew, but I wanted to make it as easy as possible for my self and others, so I simplified it by creating a library out of it, see below for an example usage. The library is available here: [GitHub - SSLContext Kickstart][1]\r\n\r\n```java\r\nimport javax.net.ssl.SSLContext;\r\nimport java.security.PrivateKey;\r\nimport java.security.cert.X509Certificate;\r\nimport java.util.List;\r\n\r\nimport nl.altindag.ssl.SSLFactory;\r\nimport nl.altindag.ssl.util.PemUtils;\r\n\r\nclass App {\r\n\r\n    public static void main(String[] args) {\r\n        PrivateKey privateKey = PemUtils.parsePrivateKey(privateKeyContent, privateKeyPassword);\r\n        List&lt;X509Certificate&gt; certificateChain = PemUtils.parseCertificate(certificateChainContent);\r\n\r\n        SSLFactory sslFactory = SSLFactory.builder()\r\n                .withIdentityMaterial(privateKey, privateKeyPassword, certificateChain)\r\n                .build();\r\n\r\n        SSLContext sslContext = sslFactory.getSslContext();\r\n    }\r\n\r\n    private static char[] privateKeyPassword = &quot;secret&quot;.toCharArray();\r\n    private static String privateKeyContent = &quot;&quot;&quot;\r\n                -----BEGIN ENCRYPTED PRIVATE KEY-----\r\n                MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQI9/FSBonUacYCAggA\r\n                MBQGCCqGSIb3DQMHBAidGkS8wYhOpwSCBMi8JaSYOKudMNNFRpzL7QMIZgFtzDay\r\n                MmOroy3lW34dOa7dusqDl4d2gklKcHCpbEaTYxm5aQJ1LuiOdGtFy7HwxOvKU5xz\r\n                4qsJoeBIpE0eCTKjQW7/I38DzLXx2wUURqhMWOtFsWZEyR5Dqok3N9mIKKKBXAFG\r\n                AwNjlTRW2LyPSttiIUGN01lthjifMWoLTWB1aSGOmGeJRBdSZeqZ15xKneR4H5ja\r\n                yE88YcpOHCDKMIxi6ZVoKs7jDQhu8bBKqS8NsYyh1AlP9QkvWNal36jWSzhqYNzk\r\n                NRWUOZngfkdbMALVfRtbrC215jHGWVwosPIIs8rkoarRv8s6QWS1Rg3YfQ3qgcRf\r\n                s7hkDFKJf3TUXr+askfamV5hc300ZG64+ldX1YxWXY8Vd/wIvHAc/YE/lTyCgYrY\r\n                19Am6MNBfp8/kXvzKj+PizB8oNDO4S8sSShEEzOQ5a/+MTC6bqB0DLWYGUqRbjLc\r\n                PyYTC2C4i9Agx/GeGVE3c1UdtXiwwnt2XUn7Y1YGqABk0xGIY4J1NFTbSOxKl9hO\r\n                arwopAFrZU5nsjjFzv1DJvhfQWnYX18kPSKNHDlia019M118qZ8ERwD9tH8ix9Fa\r\n                R2tQdxn1aRGmvXSw+zFkbWD8aWs9n/B+QN1yllJqVoWypOld1yj+fVYYnYOtV1gK\r\n                eiygrtrh3JJCvLbEQl4nOgJM3PlEtfBHSaunehIXQMD1z/NDUqgBYjuDPyqRxJeH\r\n                Va5k72Nds5PeySKJJnICB3nZKjqgfLhNUrXa1SAQ4vqr0Ik/Lu9P7T+B1XiYwuUT\r\n                a20+bxi/x89ZZqwp3jnDuHup7XcO1MtqsoOKP/JgkjVMesb8Q1W8i2dXzg+l4gkk\r\n                l1ipreEGtT1YfFTq0DFelz6CjZFLDlGGeGWob94sW94DWTW0nsLPhQWEnwW1CcyJ\r\n                oJbJdDEgdiIbRJoABDkTuVXLwTlgzHSHh6zeJvNvcojI7UI3nWYCVYvD3kwghXiP\r\n                67sKGL3ug7PFDqLia46AudGY7CFh4+wpxyH+fidLC3FMdkDBA6xR6mGgEjRLXR9M\r\n                TnJ/eSYP7eqYZeKn9EarcI7v1zM2IG0/PDQCetiI0ABiHpdKyRQuuiEavp3xC5Vi\r\n                h7UmJNYt8Zsz3rwqAQ4FR2+Su5R34OOdRmxTaYLe96PXTpLcLef5TkYixSY7Tzgd\r\n                PMyRxRPrywklUEFe4KK/KOcdolxybfsIsxQnupLAMEsO7/Cs7mouNHISK51haDRc\r\n                vNbKQ5E4xOq1U4ThW5dHR29cGZillfmMzj05ZQh3ZX2TQJP45ahFET3v9kInWCwQ\r\n                8atqclVPOSnASsJZ0PxjYgKZuY8QWYM6zpfWyWnfu/CHhWbRS/qX8T1ow2SMyPBL\r\n                CQbZ+MhcdP0IrjoXhDFQsns16i/BPK5TTVqtEC2ywDf5P4/BOEZkySG9YNOd6THp\r\n                VA/dVPafzmLy3ltqH+jG8ZH2+RtWx7kwBjiDWs5cF33BFrPS7AZlzMzZoCHLXD/r\r\n                T/SmisybUKHMqri0x0RHeIByW0hogSByWiyIn8POabDzJV6Df9nQPziDGcSsvWfG\r\n                7q+hizh6+nnXOY+GZx3ptwg9mA9R4QyCiFNQradOaXSPxyEL2IC77/srFfVEIaU4\r\n                SRo=\r\n                -----END ENCRYPTED PRIVATE KEY-----\r\n                &quot;&quot;&quot;;\r\n    private static String certificateChainContent = &quot;&quot;&quot;\r\n                -----BEGIN CERTIFICATE-----\r\n                MIIDTjCCAjagAwIBAgIEVnHI3TANBgkqhkiG9w0BAQsFADBIMQswCQYDVQQGEwJO\r\n                TDEVMBMGA1UEChMMVGh1bmRlcmJlcnJ5MRIwEAYDVQQLEwlBbXN0ZXJkYW0xDjAM\r\n                BgNVBAMTBUhha2FuMB4XDTIwMDgzMTA4MDczOVoXDTMwMDgyOTA4MDczOVowSDEL\r\n                MAkGA1UEBhMCTkwxFTATBgNVBAoTDFRodW5kZXJiZXJyeTESMBAGA1UECxMJQW1z\r\n                dGVyZGFtMQ4wDAYDVQQDEwVIYWthbjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC\r\n                AQoCggEBAJZ+pqirEqEk4k1ow8vryld79oCO4P/1y+v60CkLpS2MpeHE3BogTr7g\r\n                WWP5HdHBMU5l8yT5tXuyVZZqgyzo0q2Sdm7GGrNunHf6Z8vPQFu69sQC1utDM9u8\r\n                ZFKiKsTNJ+5QS6KsOtlACyhaLoaPAWVjtvueMjVwmM9hfv/Gq6VyyuBm2x1C4HTj\r\n                zPCLHE2G1D13EJaWsvyZLGSbl0GGXZGPhaDd/vnw5TW36mvNTWW+37ZIEk4kXANa\r\n                FUNsJemm8HjB/PzHs3/SXGxuD8NKobg3+cNXYwAz2s2DI0W6Xw2g5bbrMQAdBRvn\r\n                9/kNftMymDORw3RGwDM2ld4zQfIkNrkCAwEAAaNAMD4wHQYDVR0OBBYEFHhT7ATg\r\n                oVVFIsglxD/1iUBRB6gDMB0GA1UdEQEB/wQTMBGCCWxvY2FsaG9zdIcEfwAAATAN\r\n                BgkqhkiG9w0BAQsFAAOCAQEAhVWH/CgZ0ZNmTfiFAOnWdaZVaa7vAFPT2YbXuvlY\r\n                YIRlru0B/zn2Mfwmn5W2o1CqoBuhyfErkkF4aRM1vduIirUjlcH4+cFXrV2gtlnf\r\n                eWTg/sJJmYzkJTGeOIqRlB1HKCqoeNCrykkcsikECQ1nCqr1qLh9DXsUgWVW57YW\r\n                qvP1P8xOO2/J9shMB6lOhftpawrqZ2hNG8fqMKjVVuUpFBNR+WODQ/rRRtqa6uU2\r\n                V8aOOZx1QJUkTdN76YOCuGET7edevjpdbRXde+HQN6mbT9OLxSZHO0aQrDyDmNhp\r\n                aVHuQn/KtYNWCZ78XKK8wtVnflmfqE/c9xO1n/EcVvLCdg==\r\n                -----END CERTIFICATE-----\r\n                &quot;&quot;&quot;;\r\n\r\n}\r\n```\r\n\r\n\r\n  [1]: https://github.com/Hakky54/sslcontext-kickstart","title":"Parsing encrypted PKCS#8 encoded pem file programatically","body":"<p>In the end I decided to use BC to parse the PEM files for certificates and private keys. In my use case I needed to handle all different kind of private keys and therefor the complexity also grew, but I wanted to make it as easy as possible for my self and others, so I simplified it by creating a library out of it, see below for an example usage. The library is available here: <a href=\"https://github.com/Hakky54/sslcontext-kickstart\" rel=\"nofollow noreferrer\">GitHub - SSLContext Kickstart</a></p>\n<pre class=\"lang-java prettyprint-override\"><code>import javax.net.ssl.SSLContext;\nimport java.security.PrivateKey;\nimport java.security.cert.X509Certificate;\nimport java.util.List;\n\nimport nl.altindag.ssl.SSLFactory;\nimport nl.altindag.ssl.util.PemUtils;\n\nclass App {\n\n    public static void main(String[] args) {\n        PrivateKey privateKey = PemUtils.parsePrivateKey(privateKeyContent, privateKeyPassword);\n        List&lt;X509Certificate&gt; certificateChain = PemUtils.parseCertificate(certificateChainContent);\n\n        SSLFactory sslFactory = SSLFactory.builder()\n                .withIdentityMaterial(privateKey, privateKeyPassword, certificateChain)\n                .build();\n\n        SSLContext sslContext = sslFactory.getSslContext();\n    }\n\n    private static char[] privateKeyPassword = &quot;secret&quot;.toCharArray();\n    private static String privateKeyContent = &quot;&quot;&quot;\n                -----BEGIN ENCRYPTED PRIVATE KEY-----\n                MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQI9/FSBonUacYCAggA\n                MBQGCCqGSIb3DQMHBAidGkS8wYhOpwSCBMi8JaSYOKudMNNFRpzL7QMIZgFtzDay\n                MmOroy3lW34dOa7dusqDl4d2gklKcHCpbEaTYxm5aQJ1LuiOdGtFy7HwxOvKU5xz\n                4qsJoeBIpE0eCTKjQW7/I38DzLXx2wUURqhMWOtFsWZEyR5Dqok3N9mIKKKBXAFG\n                AwNjlTRW2LyPSttiIUGN01lthjifMWoLTWB1aSGOmGeJRBdSZeqZ15xKneR4H5ja\n                yE88YcpOHCDKMIxi6ZVoKs7jDQhu8bBKqS8NsYyh1AlP9QkvWNal36jWSzhqYNzk\n                NRWUOZngfkdbMALVfRtbrC215jHGWVwosPIIs8rkoarRv8s6QWS1Rg3YfQ3qgcRf\n                s7hkDFKJf3TUXr+askfamV5hc300ZG64+ldX1YxWXY8Vd/wIvHAc/YE/lTyCgYrY\n                19Am6MNBfp8/kXvzKj+PizB8oNDO4S8sSShEEzOQ5a/+MTC6bqB0DLWYGUqRbjLc\n                PyYTC2C4i9Agx/GeGVE3c1UdtXiwwnt2XUn7Y1YGqABk0xGIY4J1NFTbSOxKl9hO\n                arwopAFrZU5nsjjFzv1DJvhfQWnYX18kPSKNHDlia019M118qZ8ERwD9tH8ix9Fa\n                R2tQdxn1aRGmvXSw+zFkbWD8aWs9n/B+QN1yllJqVoWypOld1yj+fVYYnYOtV1gK\n                eiygrtrh3JJCvLbEQl4nOgJM3PlEtfBHSaunehIXQMD1z/NDUqgBYjuDPyqRxJeH\n                Va5k72Nds5PeySKJJnICB3nZKjqgfLhNUrXa1SAQ4vqr0Ik/Lu9P7T+B1XiYwuUT\n                a20+bxi/x89ZZqwp3jnDuHup7XcO1MtqsoOKP/JgkjVMesb8Q1W8i2dXzg+l4gkk\n                l1ipreEGtT1YfFTq0DFelz6CjZFLDlGGeGWob94sW94DWTW0nsLPhQWEnwW1CcyJ\n                oJbJdDEgdiIbRJoABDkTuVXLwTlgzHSHh6zeJvNvcojI7UI3nWYCVYvD3kwghXiP\n                67sKGL3ug7PFDqLia46AudGY7CFh4+wpxyH+fidLC3FMdkDBA6xR6mGgEjRLXR9M\n                TnJ/eSYP7eqYZeKn9EarcI7v1zM2IG0/PDQCetiI0ABiHpdKyRQuuiEavp3xC5Vi\n                h7UmJNYt8Zsz3rwqAQ4FR2+Su5R34OOdRmxTaYLe96PXTpLcLef5TkYixSY7Tzgd\n                PMyRxRPrywklUEFe4KK/KOcdolxybfsIsxQnupLAMEsO7/Cs7mouNHISK51haDRc\n                vNbKQ5E4xOq1U4ThW5dHR29cGZillfmMzj05ZQh3ZX2TQJP45ahFET3v9kInWCwQ\n                8atqclVPOSnASsJZ0PxjYgKZuY8QWYM6zpfWyWnfu/CHhWbRS/qX8T1ow2SMyPBL\n                CQbZ+MhcdP0IrjoXhDFQsns16i/BPK5TTVqtEC2ywDf5P4/BOEZkySG9YNOd6THp\n                VA/dVPafzmLy3ltqH+jG8ZH2+RtWx7kwBjiDWs5cF33BFrPS7AZlzMzZoCHLXD/r\n                T/SmisybUKHMqri0x0RHeIByW0hogSByWiyIn8POabDzJV6Df9nQPziDGcSsvWfG\n                7q+hizh6+nnXOY+GZx3ptwg9mA9R4QyCiFNQradOaXSPxyEL2IC77/srFfVEIaU4\n                SRo=\n                -----END ENCRYPTED PRIVATE KEY-----\n                &quot;&quot;&quot;;\n    private static String certificateChainContent = &quot;&quot;&quot;\n                -----BEGIN CERTIFICATE-----\n                MIIDTjCCAjagAwIBAgIEVnHI3TANBgkqhkiG9w0BAQsFADBIMQswCQYDVQQGEwJO\n                TDEVMBMGA1UEChMMVGh1bmRlcmJlcnJ5MRIwEAYDVQQLEwlBbXN0ZXJkYW0xDjAM\n                BgNVBAMTBUhha2FuMB4XDTIwMDgzMTA4MDczOVoXDTMwMDgyOTA4MDczOVowSDEL\n                MAkGA1UEBhMCTkwxFTATBgNVBAoTDFRodW5kZXJiZXJyeTESMBAGA1UECxMJQW1z\n                dGVyZGFtMQ4wDAYDVQQDEwVIYWthbjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC\n                AQoCggEBAJZ+pqirEqEk4k1ow8vryld79oCO4P/1y+v60CkLpS2MpeHE3BogTr7g\n                WWP5HdHBMU5l8yT5tXuyVZZqgyzo0q2Sdm7GGrNunHf6Z8vPQFu69sQC1utDM9u8\n                ZFKiKsTNJ+5QS6KsOtlACyhaLoaPAWVjtvueMjVwmM9hfv/Gq6VyyuBm2x1C4HTj\n                zPCLHE2G1D13EJaWsvyZLGSbl0GGXZGPhaDd/vnw5TW36mvNTWW+37ZIEk4kXANa\n                FUNsJemm8HjB/PzHs3/SXGxuD8NKobg3+cNXYwAz2s2DI0W6Xw2g5bbrMQAdBRvn\n                9/kNftMymDORw3RGwDM2ld4zQfIkNrkCAwEAAaNAMD4wHQYDVR0OBBYEFHhT7ATg\n                oVVFIsglxD/1iUBRB6gDMB0GA1UdEQEB/wQTMBGCCWxvY2FsaG9zdIcEfwAAATAN\n                BgkqhkiG9w0BAQsFAAOCAQEAhVWH/CgZ0ZNmTfiFAOnWdaZVaa7vAFPT2YbXuvlY\n                YIRlru0B/zn2Mfwmn5W2o1CqoBuhyfErkkF4aRM1vduIirUjlcH4+cFXrV2gtlnf\n                eWTg/sJJmYzkJTGeOIqRlB1HKCqoeNCrykkcsikECQ1nCqr1qLh9DXsUgWVW57YW\n                qvP1P8xOO2/J9shMB6lOhftpawrqZ2hNG8fqMKjVVuUpFBNR+WODQ/rRRtqa6uU2\n                V8aOOZx1QJUkTdN76YOCuGET7edevjpdbRXde+HQN6mbT9OLxSZHO0aQrDyDmNhp\n                aVHuQn/KtYNWCZ78XKK8wtVnflmfqE/c9xO1n/EcVvLCdg==\n                -----END CERTIFICATE-----\n                &quot;&quot;&quot;;\n\n}\n</code></pre>\n"}],"owner":{"account_id":9107988,"reputation":3190,"user_id":6777695,"display_name":"Hakan54"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":9309,"favorite_count":0,"down_vote_count":0,"up_vote_count":5,"accepted_answer_id":63864963,"answer_count":5,"score":5,"last_activity_date":1681056320,"creation_date":1599750006,"question_id":63832456,"body_markdown":"I am having trouble figuring out how to properly read a private key of a pem file. I have gone through different topics on stackoverflow, but I couldn&#39;t find the solution for it. What I want to achieve is reading an encrypted private key in pkcs#8 encoding file from a classpath and load it as a key-entry in a in memory keystore. Below is an example private key which I try to parse, the password is `secret`. It is purely created for sharing here, so it is not a private key which is used on a production machine.\r\n\r\nI created it from a p12 file with the following command: `openssl pkcs12 -in key-pair.p12 -out key-pair.pem`\r\n\r\n**Valid example (throw-away) key-pair**\r\n```\r\n-----BEGIN ENCRYPTED PRIVATE KEY-----\r\nMIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQI9/FSBonUacYCAggA\r\nMBQGCCqGSIb3DQMHBAidGkS8wYhOpwSCBMi8JaSYOKudMNNFRpzL7QMIZgFtzDay\r\nMmOroy3lW34dOa7dusqDl4d2gklKcHCpbEaTYxm5aQJ1LuiOdGtFy7HwxOvKU5xz\r\n4qsJoeBIpE0eCTKjQW7/I38DzLXx2wUURqhMWOtFsWZEyR5Dqok3N9mIKKKBXAFG\r\nAwNjlTRW2LyPSttiIUGN01lthjifMWoLTWB1aSGOmGeJRBdSZeqZ15xKneR4H5ja\r\nyE88YcpOHCDKMIxi6ZVoKs7jDQhu8bBKqS8NsYyh1AlP9QkvWNal36jWSzhqYNzk\r\nNRWUOZngfkdbMALVfRtbrC215jHGWVwosPIIs8rkoarRv8s6QWS1Rg3YfQ3qgcRf\r\ns7hkDFKJf3TUXr+askfamV5hc300ZG64+ldX1YxWXY8Vd/wIvHAc/YE/lTyCgYrY\r\n19Am6MNBfp8/kXvzKj+PizB8oNDO4S8sSShEEzOQ5a/+MTC6bqB0DLWYGUqRbjLc\r\nPyYTC2C4i9Agx/GeGVE3c1UdtXiwwnt2XUn7Y1YGqABk0xGIY4J1NFTbSOxKl9hO\r\narwopAFrZU5nsjjFzv1DJvhfQWnYX18kPSKNHDlia019M118qZ8ERwD9tH8ix9Fa\r\nR2tQdxn1aRGmvXSw+zFkbWD8aWs9n/B+QN1yllJqVoWypOld1yj+fVYYnYOtV1gK\r\neiygrtrh3JJCvLbEQl4nOgJM3PlEtfBHSaunehIXQMD1z/NDUqgBYjuDPyqRxJeH\r\nVa5k72Nds5PeySKJJnICB3nZKjqgfLhNUrXa1SAQ4vqr0Ik/Lu9P7T+B1XiYwuUT\r\na20+bxi/x89ZZqwp3jnDuHup7XcO1MtqsoOKP/JgkjVMesb8Q1W8i2dXzg+l4gkk\r\nl1ipreEGtT1YfFTq0DFelz6CjZFLDlGGeGWob94sW94DWTW0nsLPhQWEnwW1CcyJ\r\noJbJdDEgdiIbRJoABDkTuVXLwTlgzHSHh6zeJvNvcojI7UI3nWYCVYvD3kwghXiP\r\n67sKGL3ug7PFDqLia46AudGY7CFh4+wpxyH+fidLC3FMdkDBA6xR6mGgEjRLXR9M\r\nTnJ/eSYP7eqYZeKn9EarcI7v1zM2IG0/PDQCetiI0ABiHpdKyRQuuiEavp3xC5Vi\r\nh7UmJNYt8Zsz3rwqAQ4FR2+Su5R34OOdRmxTaYLe96PXTpLcLef5TkYixSY7Tzgd\r\nPMyRxRPrywklUEFe4KK/KOcdolxybfsIsxQnupLAMEsO7/Cs7mouNHISK51haDRc\r\nvNbKQ5E4xOq1U4ThW5dHR29cGZillfmMzj05ZQh3ZX2TQJP45ahFET3v9kInWCwQ\r\n8atqclVPOSnASsJZ0PxjYgKZuY8QWYM6zpfWyWnfu/CHhWbRS/qX8T1ow2SMyPBL\r\nCQbZ+MhcdP0IrjoXhDFQsns16i/BPK5TTVqtEC2ywDf5P4/BOEZkySG9YNOd6THp\r\nVA/dVPafzmLy3ltqH+jG8ZH2+RtWx7kwBjiDWs5cF33BFrPS7AZlzMzZoCHLXD/r\r\nT/SmisybUKHMqri0x0RHeIByW0hogSByWiyIn8POabDzJV6Df9nQPziDGcSsvWfG\r\n7q+hizh6+nnXOY+GZx3ptwg9mA9R4QyCiFNQradOaXSPxyEL2IC77/srFfVEIaU4\r\nSRo=\r\n-----END ENCRYPTED PRIVATE KEY-----\r\n\r\n-----BEGIN CERTIFICATE-----\r\nMIIDTjCCAjagAwIBAgIEVnHI3TANBgkqhkiG9w0BAQsFADBIMQswCQYDVQQGEwJO\r\nTDEVMBMGA1UEChMMVGh1bmRlcmJlcnJ5MRIwEAYDVQQLEwlBbXN0ZXJkYW0xDjAM\r\nBgNVBAMTBUhha2FuMB4XDTIwMDgzMTA4MDczOVoXDTMwMDgyOTA4MDczOVowSDEL\r\nMAkGA1UEBhMCTkwxFTATBgNVBAoTDFRodW5kZXJiZXJyeTESMBAGA1UECxMJQW1z\r\ndGVyZGFtMQ4wDAYDVQQDEwVIYWthbjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC\r\nAQoCggEBAJZ+pqirEqEk4k1ow8vryld79oCO4P/1y+v60CkLpS2MpeHE3BogTr7g\r\nWWP5HdHBMU5l8yT5tXuyVZZqgyzo0q2Sdm7GGrNunHf6Z8vPQFu69sQC1utDM9u8\r\nZFKiKsTNJ+5QS6KsOtlACyhaLoaPAWVjtvueMjVwmM9hfv/Gq6VyyuBm2x1C4HTj\r\nzPCLHE2G1D13EJaWsvyZLGSbl0GGXZGPhaDd/vnw5TW36mvNTWW+37ZIEk4kXANa\r\nFUNsJemm8HjB/PzHs3/SXGxuD8NKobg3+cNXYwAz2s2DI0W6Xw2g5bbrMQAdBRvn\r\n9/kNftMymDORw3RGwDM2ld4zQfIkNrkCAwEAAaNAMD4wHQYDVR0OBBYEFHhT7ATg\r\noVVFIsglxD/1iUBRB6gDMB0GA1UdEQEB/wQTMBGCCWxvY2FsaG9zdIcEfwAAATAN\r\nBgkqhkiG9w0BAQsFAAOCAQEAhVWH/CgZ0ZNmTfiFAOnWdaZVaa7vAFPT2YbXuvlY\r\nYIRlru0B/zn2Mfwmn5W2o1CqoBuhyfErkkF4aRM1vduIirUjlcH4+cFXrV2gtlnf\r\neWTg/sJJmYzkJTGeOIqRlB1HKCqoeNCrykkcsikECQ1nCqr1qLh9DXsUgWVW57YW\r\nqvP1P8xOO2/J9shMB6lOhftpawrqZ2hNG8fqMKjVVuUpFBNR+WODQ/rRRtqa6uU2\r\nV8aOOZx1QJUkTdN76YOCuGET7edevjpdbRXde+HQN6mbT9OLxSZHO0aQrDyDmNhp\r\naVHuQn/KtYNWCZ78XKK8wtVnflmfqE/c9xO1n/EcVvLCdg==\r\n-----END CERTIFICATE-----\r\n```\r\n\r\nI know **BouncyCastle** is able to parse it, but I want to avoid using additional libraries. So I am wondering if it is possible with just plain jdk or with some other lightweight libraries.\r\n\r\nI am already able to parse private key with the following header/footer: \r\n```\r\n-----BEGIN PRIVATE KEY-----\r\n           *\r\n-----END PRIVATE KEY-----\r\n```\r\n\r\nand\r\n\r\n```\r\n-----BEGIN RSA PRIVATE KEY-----\r\n           *\r\n-----END RSA PRIVATE KEY-----\r\n```\r\n\r\nI already use the following snippet to accomplish that:\r\n\r\n```java\r\nimport com.hierynomus.asn1.ASN1InputStream;\r\nimport com.hierynomus.asn1.encodingrules.der.DERDecoder;\r\nimport com.hierynomus.asn1.types.ASN1Object;\r\nimport com.hierynomus.asn1.types.constructed.ASN1Sequence;\r\nimport com.hierynomus.asn1.types.primitive.ASN1Integer;\r\n\r\nimport java.io.ByteArrayInputStream;\r\nimport java.io.IOException;\r\nimport java.math.BigInteger;\r\nimport java.security.KeyFactory;\r\nimport java.security.KeyStore;\r\nimport java.security.KeyStoreException;\r\nimport java.security.NoSuchAlgorithmException;\r\nimport java.security.PrivateKey;\r\nimport java.security.cert.Certificate;\r\nimport java.security.cert.CertificateException;\r\nimport java.security.cert.CertificateFactory;\r\nimport java.security.spec.InvalidKeySpecException;\r\nimport java.security.spec.KeySpec;\r\nimport java.security.spec.PKCS8EncodedKeySpec;\r\nimport java.security.spec.RSAPrivateCrtKeySpec;\r\nimport java.util.Base64;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\nimport java.util.Objects;\r\nimport java.util.UUID;\r\nimport java.util.regex.Matcher;\r\nimport java.util.regex.Pattern;\r\n\r\nclass App {\r\n\r\n    private static final String KEYSTORE_TYPE = &quot;PKCS12&quot;;\r\n    private static final String KEY_FACTORY_ALGORITHM = &quot;RSA&quot;;\r\n    private static final String CERTIFICATE_TYPE = &quot;X.509&quot;;\r\n\r\n    private static final Pattern CERTIFICATE_PATTERN = Pattern.compile(&quot;-----BEGIN CERTIFICATE-----(.*?)-----END CERTIFICATE-----&quot;, Pattern.DOTALL);\r\n    private static final Pattern PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN PRIVATE KEY-----(.*?)-----END PRIVATE KEY-----&quot;, Pattern.DOTALL);\r\n    private static final Pattern ENCRYPTED_PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN ENCRYPTED PRIVATE KEY-----(.*?)-----END ENCRYPTED PRIVATE KEY-----&quot;, Pattern.DOTALL);\r\n    private static final Pattern RSA_PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN RSA PRIVATE KEY-----(.*?)-----END RSA PRIVATE KEY-----&quot;, Pattern.DOTALL);\r\n\r\n    private static final String NEW_LINE = &quot;\\n&quot;;\r\n    private static final String EMPTY = &quot;&quot;;\r\n\r\n    public static void main(String[] args) throws CertificateException, NoSuchAlgorithmException, KeyStoreException, IOException, InvalidKeySpecException {\r\n        String privateKeyContent = &quot;&quot;;\r\n        String certificateContent = &quot;&quot;;\r\n\r\n        PrivateKey privateKey = parsePrivateKey(privateKeyContent);\r\n        Certificate[] certificates = parseCertificate(certificateContent).values()\r\n                .toArray(new Certificate[]{});\r\n\r\n        KeyStore keyStore = createEmptyKeyStore();\r\n        keyStore.setKeyEntry(&quot;client&quot;, privateKey, null, certificates);\r\n    }\r\n\r\n    private static KeyStore createEmptyKeyStore() throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException {\r\n        KeyStore keyStore = KeyStore.getInstance(KEYSTORE_TYPE);\r\n        keyStore.load(null, null);\r\n        return keyStore;\r\n    }\r\n\r\n    private static PrivateKey parsePrivateKey(String identityContent) throws NoSuchAlgorithmException, InvalidKeySpecException, IOException {\r\n        KeySpec keySpec = null;\r\n\r\n        Matcher privateKeyMatcher = PRIVATE_KEY_PATTERN.matcher(identityContent);\r\n        if (privateKeyMatcher.find()) {\r\n            String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\r\n            byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\r\n            keySpec = new PKCS8EncodedKeySpec(decodedPrivateKeyContent);\r\n        }\r\n\r\n        privateKeyMatcher = RSA_PRIVATE_KEY_PATTERN.matcher(identityContent);\r\n        if (privateKeyMatcher.find()) {\r\n            String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\r\n            byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\r\n            keySpec = getKeySpecFromAsn1StructuredData(decodedPrivateKeyContent);\r\n        }\r\n\r\n        privateKeyMatcher = ENCRYPTED_PRIVATE_KEY_PATTERN.matcher(identityContent);\r\n        if (privateKeyMatcher.find()) {\r\n            String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\r\n            byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\r\n            keySpec = null; //TODO\r\n        }\r\n\r\n        Objects.requireNonNull(keySpec);\r\n\r\n        KeyFactory keyFactory = KeyFactory.getInstance(KEY_FACTORY_ALGORITHM);\r\n        return keyFactory.generatePrivate(keySpec);\r\n    }\r\n\r\n    private static KeySpec getKeySpecFromAsn1StructuredData(byte[] decodedPrivateKeyContent) throws IOException {\r\n        try(ByteArrayInputStream privateKeyAsInputStream = new ByteArrayInputStream(decodedPrivateKeyContent)) {\r\n            ASN1InputStream stream = new ASN1InputStream(new DERDecoder(), privateKeyAsInputStream);\r\n            ASN1Sequence asn1Sequence = stream.readObject();\r\n\r\n            if (asn1Sequence.getValue().size() &lt; 9) {\r\n                throw new RuntimeException(&quot;Parsed key content doesn&#39;t have the minimum required sequence size of 9&quot;);\r\n            }\r\n\r\n            BigInteger modulus = extractIntValueFrom(asn1Sequence.get(1));\r\n            BigInteger publicExponent = extractIntValueFrom(asn1Sequence.get(2));\r\n            BigInteger privateExponent = extractIntValueFrom(asn1Sequence.get(3));\r\n            BigInteger primeP = extractIntValueFrom(asn1Sequence.get(4));\r\n            BigInteger primeQ = extractIntValueFrom(asn1Sequence.get(5));\r\n            BigInteger primeExponentP = extractIntValueFrom(asn1Sequence.get(6));\r\n            BigInteger primeExponentQ = extractIntValueFrom(asn1Sequence.get(7));\r\n            BigInteger crtCoefficient = extractIntValueFrom(asn1Sequence.get(8));\r\n\r\n            return new RSAPrivateCrtKeySpec(\r\n                    modulus, publicExponent, privateExponent,\r\n                    primeP, primeQ, primeExponentP, primeExponentQ, crtCoefficient\r\n            );\r\n        }\r\n    }\r\n\r\n    private static BigInteger extractIntValueFrom(ASN1Object&lt;?&gt; asn1Object) {\r\n        if (asn1Object instanceof ASN1Integer) {\r\n            return ((ASN1Integer) asn1Object).getValue();\r\n        } else {\r\n            throw new RuntimeException(String.format(\r\n                    &quot;Unable to parse the provided value of the object type [%s]. The type should be an instance of [%s]&quot;,\r\n                    asn1Object.getClass().getName(), ASN1Integer.class.getName())\r\n            );\r\n        }\r\n    }\r\n\r\n    private static Map&lt;String, Certificate&gt; parseCertificate(String certificateContent) throws IOException, CertificateException {\r\n        Map&lt;String, Certificate&gt; certificates = new HashMap&lt;&gt;();\r\n        Matcher certificateMatcher = CERTIFICATE_PATTERN.matcher(certificateContent);\r\n\r\n        while (certificateMatcher.find()) {\r\n            String sanitizedCertificate = certificateMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\r\n            byte[] decodedCertificate = Base64.getDecoder().decode(sanitizedCertificate);\r\n            try(ByteArrayInputStream certificateAsInputStream = new ByteArrayInputStream(decodedCertificate)) {\r\n                CertificateFactory certificateFactory = CertificateFactory.getInstance(CERTIFICATE_TYPE);\r\n                Certificate certificate = certificateFactory.generateCertificate(certificateAsInputStream);\r\n                certificates.put(UUID.randomUUID().toString(), certificate);\r\n            }\r\n        }\r\n\r\n        return certificates;\r\n    }\r\n\r\n}\r\n```\r\n\r\nI also am required to handle asn.1 encoded private key. I could use BouncyCastle, but again I wanted to avoid it because I am curious for alternatives. I got inspired from this topic: https://stackoverflow.com/a/42733858/6777695 but [DerInputStream][1] and [DerValue][2] aren&#39;t accessible anymore from jdk 11 onwards. And the sun packages should be avoided... So I discovered [asn-one java library][3] to parse asn.1 encoded private key, and it works quite well.\r\n\r\nI have shared my full snippet of handling the other cases, so it will be easier to try out when someone wants to help me. \r\n\r\nFrom the following article: [ASN.1 key structures in DER and PEM][4] I learned that a private key having the following header/footer: `-----BEGIN ENCRYPTED PRIVATE KEY----- * -----END ENCRYPTED PRIVATE KEY-----` is also an asn.1 encoded private key with the following structure:\r\n\r\n```\r\nEncryptedPrivateKeyInfo ::= SEQUENCE {\r\n  encryptionAlgorithm  EncryptionAlgorithmIdentifier,\r\n  encryptedData        EncryptedData\r\n}\r\n\r\nEncryptionAlgorithmIdentifier ::= AlgorithmIdentifier\r\n\r\nEncryptedData ::= OCTET STRING\r\n```\r\n\r\nI also tried the answers provided here https://stackoverflow.com/questions/2654949/how-to-read-a-password-encrypted-key-with-java but those also didn&#39;t work. However I am not quite sure how to parse it correctly to a java object and load it as a KeySpec. So any help is welcome!\r\n\r\n======&gt;\r\nUpdated progress at 12-09-2020 based on the input of `dave_thompson_085`\r\n\r\n```\r\nMatcher privateKeyMatcher = Pattern.compile(&quot;-----BEGIN ENCRYPTED PRIVATE KEY-----(.*?)-----END ENCRYPTED PRIVATE KEY-----&quot;, Pattern.DOTALL)\r\n        .matcher(identityContent);\r\n\r\nif (privateKeyMatcher.find()) {\r\n    String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\r\n    byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\r\n    try (ByteArrayInputStream privateKeyAsInputStream = new ByteArrayInputStream(decodedPrivateKeyContent)) {\r\n        ASN1InputStream stream = new ASN1InputStream(new DERDecoder(), privateKeyAsInputStream);\r\n        ASN1Sequence asn1Sequence = stream.readObject();\r\n\r\n        ASN1OctetString privateKeyAsOctetString = (ASN1OctetString) asn1Sequence.get(1);\r\n        ASN1OctetString saltAsOctetString = (ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(0);\r\n        ASN1OctetString initializationVectorAsOctec = ((ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(1)).get(1));\r\n        ASN1Integer iterationCount = (ASN1Integer) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(1);\r\n\r\n        IvParameterSpec ivParameterSpec = new IvParameterSpec(initializationVectorAsOctec.getValue());\r\n\r\n        SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(&quot;PBKDF2withHmacSHA1&quot;);\r\n        EncryptedPrivateKeyInfo encryptedPrivateKeyInfo = new EncryptedPrivateKeyInfo(secretKeyFactory.getAlgorithm(), privateKeyAsOctetString.getValue());\r\n\r\n        int keyLength = encryptedPrivateKeyInfo.getEncoded().length;\r\n        PBEKeySpec pbeKeySpec = new PBEKeySpec(keyPassword, saltAsOctetString.getValue(), iterationCount.getValue().intValue(), keyLength);\r\n\r\n        Cipher cipher = Cipher.getInstance(&quot;DESede/CBC/PKCS5Padding/&quot;);\r\n\r\n        SecretKey secretKey = secretKeyFactory.generateSecret(pbeKeySpec);\r\n\r\n        cipher.init(Cipher.DECRYPT_MODE, secretKey, ivParameterSpec);\r\n        PKCS8EncodedKeySpec keySpec = encryptedPrivateKeyInfo.getKeySpec(cipher);\r\n    }\r\n}\r\n```\r\n\r\nResults into the following exception: `java.security.InvalidKeyException: Wrong algorithm: DESede or TripleDES required` on the statement `cipher.init(Cipher.DECRYPT_MODE, secretKey, ivParameterSpec);`\r\n\r\n======&gt;\r\nUpdated progress at 13-09-2020 based on the input of `Michael Fehr`\r\n\r\n```\r\nMatcher privateKeyMatcher = Pattern.compile(&quot;-----BEGIN ENCRYPTED PRIVATE KEY-----(.*?)-----END ENCRYPTED PRIVATE KEY-----&quot;, Pattern.DOTALL)\r\n        .matcher(identityContent);\r\n\r\nif (privateKeyMatcher.find()) {\r\n    String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\r\n    byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\r\n    try (ByteArrayInputStream privateKeyAsInputStream = new ByteArrayInputStream(decodedPrivateKeyContent)) {\r\n        ASN1InputStream stream = new ASN1InputStream(new DERDecoder(), privateKeyAsInputStream);\r\n        ASN1Sequence asn1Sequence = stream.readObject();\r\n\r\n        ASN1OctetString privateKeyAsOctetString = (ASN1OctetString) asn1Sequence.get(1);\r\n        ASN1OctetString saltAsOctetString = (ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(0);\r\n        ASN1OctetString initializationVectorAsOctec = ((ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(1)).get(1));\r\n        ASN1Integer iterationCount = (ASN1Integer) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(1);\r\n\r\n        IvParameterSpec ivParameterSpec = new IvParameterSpec(initializationVectorAsOctec.getValue());\r\n\r\n        SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(&quot;PBKDF2withHmacSHA1&quot;);\r\n        EncryptedPrivateKeyInfo encryptedPrivateKeyInfo = new EncryptedPrivateKeyInfo(secretKeyFactory.getAlgorithm(), privateKeyAsOctetString.getValue());\r\n\r\n        int keyLength = 24 * 8;\r\n        PBEKeySpec pbeKeySpec = new PBEKeySpec(keyPassword, saltAsOctetString.getValue(), iterationCount.getValue().intValue(), keyLength);\r\n\r\n        Cipher cipher = Cipher.getInstance(&quot;DESede/CBC/PKCS5Padding/&quot;);\r\n\r\n        SecretKey secretKeyPbkdf = secretKeyFactory.generateSecret(pbeKeySpec);\r\n        SecretKey secretKey = new SecretKeySpec(secretKeyPbkdf.getEncoded(), &quot;DESede&quot;);\r\n\r\n        cipher.init(Cipher.DECRYPT_MODE, secretKey, ivParameterSpec);\r\n        PKCS8EncodedKeySpec keySpec = encryptedPrivateKeyInfo.getKeySpec(cipher);\r\n    }\r\n}\r\n```\r\n\r\n\r\n\r\n  [1]: http://www.docjar.com/docs/api/sun/security/util/DerInputStream.html\r\n  [2]: http://www.docjar.com/docs/api/sun/security/util/DerValue.html\r\n  [3]: https://github.com/hierynomus/asn-one\r\n  [4]: https://tls.mbed.org/kb/cryptography/asn1-key-structures-in-der-and-pem","title":"Parsing encrypted PKCS#8 encoded pem file programatically","body":"<p>I am having trouble figuring out how to properly read a private key of a pem file. I have gone through different topics on stackoverflow, but I couldn't find the solution for it. What I want to achieve is reading an encrypted private key in pkcs#8 encoding file from a classpath and load it as a key-entry in a in memory keystore. Below is an example private key which I try to parse, the password is <code>secret</code>. It is purely created for sharing here, so it is not a private key which is used on a production machine.</p>\n<p>I created it from a p12 file with the following command: <code>openssl pkcs12 -in key-pair.p12 -out key-pair.pem</code></p>\n<p><strong>Valid example (throw-away) key-pair</strong></p>\n<pre><code>-----BEGIN ENCRYPTED PRIVATE KEY-----\nMIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQI9/FSBonUacYCAggA\nMBQGCCqGSIb3DQMHBAidGkS8wYhOpwSCBMi8JaSYOKudMNNFRpzL7QMIZgFtzDay\nMmOroy3lW34dOa7dusqDl4d2gklKcHCpbEaTYxm5aQJ1LuiOdGtFy7HwxOvKU5xz\n4qsJoeBIpE0eCTKjQW7/I38DzLXx2wUURqhMWOtFsWZEyR5Dqok3N9mIKKKBXAFG\nAwNjlTRW2LyPSttiIUGN01lthjifMWoLTWB1aSGOmGeJRBdSZeqZ15xKneR4H5ja\nyE88YcpOHCDKMIxi6ZVoKs7jDQhu8bBKqS8NsYyh1AlP9QkvWNal36jWSzhqYNzk\nNRWUOZngfkdbMALVfRtbrC215jHGWVwosPIIs8rkoarRv8s6QWS1Rg3YfQ3qgcRf\ns7hkDFKJf3TUXr+askfamV5hc300ZG64+ldX1YxWXY8Vd/wIvHAc/YE/lTyCgYrY\n19Am6MNBfp8/kXvzKj+PizB8oNDO4S8sSShEEzOQ5a/+MTC6bqB0DLWYGUqRbjLc\nPyYTC2C4i9Agx/GeGVE3c1UdtXiwwnt2XUn7Y1YGqABk0xGIY4J1NFTbSOxKl9hO\narwopAFrZU5nsjjFzv1DJvhfQWnYX18kPSKNHDlia019M118qZ8ERwD9tH8ix9Fa\nR2tQdxn1aRGmvXSw+zFkbWD8aWs9n/B+QN1yllJqVoWypOld1yj+fVYYnYOtV1gK\neiygrtrh3JJCvLbEQl4nOgJM3PlEtfBHSaunehIXQMD1z/NDUqgBYjuDPyqRxJeH\nVa5k72Nds5PeySKJJnICB3nZKjqgfLhNUrXa1SAQ4vqr0Ik/Lu9P7T+B1XiYwuUT\na20+bxi/x89ZZqwp3jnDuHup7XcO1MtqsoOKP/JgkjVMesb8Q1W8i2dXzg+l4gkk\nl1ipreEGtT1YfFTq0DFelz6CjZFLDlGGeGWob94sW94DWTW0nsLPhQWEnwW1CcyJ\noJbJdDEgdiIbRJoABDkTuVXLwTlgzHSHh6zeJvNvcojI7UI3nWYCVYvD3kwghXiP\n67sKGL3ug7PFDqLia46AudGY7CFh4+wpxyH+fidLC3FMdkDBA6xR6mGgEjRLXR9M\nTnJ/eSYP7eqYZeKn9EarcI7v1zM2IG0/PDQCetiI0ABiHpdKyRQuuiEavp3xC5Vi\nh7UmJNYt8Zsz3rwqAQ4FR2+Su5R34OOdRmxTaYLe96PXTpLcLef5TkYixSY7Tzgd\nPMyRxRPrywklUEFe4KK/KOcdolxybfsIsxQnupLAMEsO7/Cs7mouNHISK51haDRc\nvNbKQ5E4xOq1U4ThW5dHR29cGZillfmMzj05ZQh3ZX2TQJP45ahFET3v9kInWCwQ\n8atqclVPOSnASsJZ0PxjYgKZuY8QWYM6zpfWyWnfu/CHhWbRS/qX8T1ow2SMyPBL\nCQbZ+MhcdP0IrjoXhDFQsns16i/BPK5TTVqtEC2ywDf5P4/BOEZkySG9YNOd6THp\nVA/dVPafzmLy3ltqH+jG8ZH2+RtWx7kwBjiDWs5cF33BFrPS7AZlzMzZoCHLXD/r\nT/SmisybUKHMqri0x0RHeIByW0hogSByWiyIn8POabDzJV6Df9nQPziDGcSsvWfG\n7q+hizh6+nnXOY+GZx3ptwg9mA9R4QyCiFNQradOaXSPxyEL2IC77/srFfVEIaU4\nSRo=\n-----END ENCRYPTED PRIVATE KEY-----\n\n-----BEGIN CERTIFICATE-----\nMIIDTjCCAjagAwIBAgIEVnHI3TANBgkqhkiG9w0BAQsFADBIMQswCQYDVQQGEwJO\nTDEVMBMGA1UEChMMVGh1bmRlcmJlcnJ5MRIwEAYDVQQLEwlBbXN0ZXJkYW0xDjAM\nBgNVBAMTBUhha2FuMB4XDTIwMDgzMTA4MDczOVoXDTMwMDgyOTA4MDczOVowSDEL\nMAkGA1UEBhMCTkwxFTATBgNVBAoTDFRodW5kZXJiZXJyeTESMBAGA1UECxMJQW1z\ndGVyZGFtMQ4wDAYDVQQDEwVIYWthbjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC\nAQoCggEBAJZ+pqirEqEk4k1ow8vryld79oCO4P/1y+v60CkLpS2MpeHE3BogTr7g\nWWP5HdHBMU5l8yT5tXuyVZZqgyzo0q2Sdm7GGrNunHf6Z8vPQFu69sQC1utDM9u8\nZFKiKsTNJ+5QS6KsOtlACyhaLoaPAWVjtvueMjVwmM9hfv/Gq6VyyuBm2x1C4HTj\nzPCLHE2G1D13EJaWsvyZLGSbl0GGXZGPhaDd/vnw5TW36mvNTWW+37ZIEk4kXANa\nFUNsJemm8HjB/PzHs3/SXGxuD8NKobg3+cNXYwAz2s2DI0W6Xw2g5bbrMQAdBRvn\n9/kNftMymDORw3RGwDM2ld4zQfIkNrkCAwEAAaNAMD4wHQYDVR0OBBYEFHhT7ATg\noVVFIsglxD/1iUBRB6gDMB0GA1UdEQEB/wQTMBGCCWxvY2FsaG9zdIcEfwAAATAN\nBgkqhkiG9w0BAQsFAAOCAQEAhVWH/CgZ0ZNmTfiFAOnWdaZVaa7vAFPT2YbXuvlY\nYIRlru0B/zn2Mfwmn5W2o1CqoBuhyfErkkF4aRM1vduIirUjlcH4+cFXrV2gtlnf\neWTg/sJJmYzkJTGeOIqRlB1HKCqoeNCrykkcsikECQ1nCqr1qLh9DXsUgWVW57YW\nqvP1P8xOO2/J9shMB6lOhftpawrqZ2hNG8fqMKjVVuUpFBNR+WODQ/rRRtqa6uU2\nV8aOOZx1QJUkTdN76YOCuGET7edevjpdbRXde+HQN6mbT9OLxSZHO0aQrDyDmNhp\naVHuQn/KtYNWCZ78XKK8wtVnflmfqE/c9xO1n/EcVvLCdg==\n-----END CERTIFICATE-----\n</code></pre>\n<p>I know <strong>BouncyCastle</strong> is able to parse it, but I want to avoid using additional libraries. So I am wondering if it is possible with just plain jdk or with some other lightweight libraries.</p>\n<p>I am already able to parse private key with the following header/footer:</p>\n<pre><code>-----BEGIN PRIVATE KEY-----\n           *\n-----END PRIVATE KEY-----\n</code></pre>\n<p>and</p>\n<pre><code>-----BEGIN RSA PRIVATE KEY-----\n           *\n-----END RSA PRIVATE KEY-----\n</code></pre>\n<p>I already use the following snippet to accomplish that:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import com.hierynomus.asn1.ASN1InputStream;\nimport com.hierynomus.asn1.encodingrules.der.DERDecoder;\nimport com.hierynomus.asn1.types.ASN1Object;\nimport com.hierynomus.asn1.types.constructed.ASN1Sequence;\nimport com.hierynomus.asn1.types.primitive.ASN1Integer;\n\nimport java.io.ByteArrayInputStream;\nimport java.io.IOException;\nimport java.math.BigInteger;\nimport java.security.KeyFactory;\nimport java.security.KeyStore;\nimport java.security.KeyStoreException;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.PrivateKey;\nimport java.security.cert.Certificate;\nimport java.security.cert.CertificateException;\nimport java.security.cert.CertificateFactory;\nimport java.security.spec.InvalidKeySpecException;\nimport java.security.spec.KeySpec;\nimport java.security.spec.PKCS8EncodedKeySpec;\nimport java.security.spec.RSAPrivateCrtKeySpec;\nimport java.util.Base64;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.Objects;\nimport java.util.UUID;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\n\nclass App {\n\n    private static final String KEYSTORE_TYPE = &quot;PKCS12&quot;;\n    private static final String KEY_FACTORY_ALGORITHM = &quot;RSA&quot;;\n    private static final String CERTIFICATE_TYPE = &quot;X.509&quot;;\n\n    private static final Pattern CERTIFICATE_PATTERN = Pattern.compile(&quot;-----BEGIN CERTIFICATE-----(.*?)-----END CERTIFICATE-----&quot;, Pattern.DOTALL);\n    private static final Pattern PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN PRIVATE KEY-----(.*?)-----END PRIVATE KEY-----&quot;, Pattern.DOTALL);\n    private static final Pattern ENCRYPTED_PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN ENCRYPTED PRIVATE KEY-----(.*?)-----END ENCRYPTED PRIVATE KEY-----&quot;, Pattern.DOTALL);\n    private static final Pattern RSA_PRIVATE_KEY_PATTERN = Pattern.compile(&quot;-----BEGIN RSA PRIVATE KEY-----(.*?)-----END RSA PRIVATE KEY-----&quot;, Pattern.DOTALL);\n\n    private static final String NEW_LINE = &quot;\\n&quot;;\n    private static final String EMPTY = &quot;&quot;;\n\n    public static void main(String[] args) throws CertificateException, NoSuchAlgorithmException, KeyStoreException, IOException, InvalidKeySpecException {\n        String privateKeyContent = &quot;&quot;;\n        String certificateContent = &quot;&quot;;\n\n        PrivateKey privateKey = parsePrivateKey(privateKeyContent);\n        Certificate[] certificates = parseCertificate(certificateContent).values()\n                .toArray(new Certificate[]{});\n\n        KeyStore keyStore = createEmptyKeyStore();\n        keyStore.setKeyEntry(&quot;client&quot;, privateKey, null, certificates);\n    }\n\n    private static KeyStore createEmptyKeyStore() throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException {\n        KeyStore keyStore = KeyStore.getInstance(KEYSTORE_TYPE);\n        keyStore.load(null, null);\n        return keyStore;\n    }\n\n    private static PrivateKey parsePrivateKey(String identityContent) throws NoSuchAlgorithmException, InvalidKeySpecException, IOException {\n        KeySpec keySpec = null;\n\n        Matcher privateKeyMatcher = PRIVATE_KEY_PATTERN.matcher(identityContent);\n        if (privateKeyMatcher.find()) {\n            String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\n            byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\n            keySpec = new PKCS8EncodedKeySpec(decodedPrivateKeyContent);\n        }\n\n        privateKeyMatcher = RSA_PRIVATE_KEY_PATTERN.matcher(identityContent);\n        if (privateKeyMatcher.find()) {\n            String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\n            byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\n            keySpec = getKeySpecFromAsn1StructuredData(decodedPrivateKeyContent);\n        }\n\n        privateKeyMatcher = ENCRYPTED_PRIVATE_KEY_PATTERN.matcher(identityContent);\n        if (privateKeyMatcher.find()) {\n            String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\n            byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\n            keySpec = null; //TODO\n        }\n\n        Objects.requireNonNull(keySpec);\n\n        KeyFactory keyFactory = KeyFactory.getInstance(KEY_FACTORY_ALGORITHM);\n        return keyFactory.generatePrivate(keySpec);\n    }\n\n    private static KeySpec getKeySpecFromAsn1StructuredData(byte[] decodedPrivateKeyContent) throws IOException {\n        try(ByteArrayInputStream privateKeyAsInputStream = new ByteArrayInputStream(decodedPrivateKeyContent)) {\n            ASN1InputStream stream = new ASN1InputStream(new DERDecoder(), privateKeyAsInputStream);\n            ASN1Sequence asn1Sequence = stream.readObject();\n\n            if (asn1Sequence.getValue().size() &lt; 9) {\n                throw new RuntimeException(&quot;Parsed key content doesn't have the minimum required sequence size of 9&quot;);\n            }\n\n            BigInteger modulus = extractIntValueFrom(asn1Sequence.get(1));\n            BigInteger publicExponent = extractIntValueFrom(asn1Sequence.get(2));\n            BigInteger privateExponent = extractIntValueFrom(asn1Sequence.get(3));\n            BigInteger primeP = extractIntValueFrom(asn1Sequence.get(4));\n            BigInteger primeQ = extractIntValueFrom(asn1Sequence.get(5));\n            BigInteger primeExponentP = extractIntValueFrom(asn1Sequence.get(6));\n            BigInteger primeExponentQ = extractIntValueFrom(asn1Sequence.get(7));\n            BigInteger crtCoefficient = extractIntValueFrom(asn1Sequence.get(8));\n\n            return new RSAPrivateCrtKeySpec(\n                    modulus, publicExponent, privateExponent,\n                    primeP, primeQ, primeExponentP, primeExponentQ, crtCoefficient\n            );\n        }\n    }\n\n    private static BigInteger extractIntValueFrom(ASN1Object&lt;?&gt; asn1Object) {\n        if (asn1Object instanceof ASN1Integer) {\n            return ((ASN1Integer) asn1Object).getValue();\n        } else {\n            throw new RuntimeException(String.format(\n                    &quot;Unable to parse the provided value of the object type [%s]. The type should be an instance of [%s]&quot;,\n                    asn1Object.getClass().getName(), ASN1Integer.class.getName())\n            );\n        }\n    }\n\n    private static Map&lt;String, Certificate&gt; parseCertificate(String certificateContent) throws IOException, CertificateException {\n        Map&lt;String, Certificate&gt; certificates = new HashMap&lt;&gt;();\n        Matcher certificateMatcher = CERTIFICATE_PATTERN.matcher(certificateContent);\n\n        while (certificateMatcher.find()) {\n            String sanitizedCertificate = certificateMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\n            byte[] decodedCertificate = Base64.getDecoder().decode(sanitizedCertificate);\n            try(ByteArrayInputStream certificateAsInputStream = new ByteArrayInputStream(decodedCertificate)) {\n                CertificateFactory certificateFactory = CertificateFactory.getInstance(CERTIFICATE_TYPE);\n                Certificate certificate = certificateFactory.generateCertificate(certificateAsInputStream);\n                certificates.put(UUID.randomUUID().toString(), certificate);\n            }\n        }\n\n        return certificates;\n    }\n\n}\n</code></pre>\n<p>I also am required to handle asn.1 encoded private key. I could use BouncyCastle, but again I wanted to avoid it because I am curious for alternatives. I got inspired from this topic: <a href=\"https://stackoverflow.com/a/42733858/6777695\">https://stackoverflow.com/a/42733858/6777695</a> but <a href=\"http://www.docjar.com/docs/api/sun/security/util/DerInputStream.html\" rel=\"nofollow noreferrer\">DerInputStream</a> and <a href=\"http://www.docjar.com/docs/api/sun/security/util/DerValue.html\" rel=\"nofollow noreferrer\">DerValue</a> aren't accessible anymore from jdk 11 onwards. And the sun packages should be avoided... So I discovered <a href=\"https://github.com/hierynomus/asn-one\" rel=\"nofollow noreferrer\">asn-one java library</a> to parse asn.1 encoded private key, and it works quite well.</p>\n<p>I have shared my full snippet of handling the other cases, so it will be easier to try out when someone wants to help me.</p>\n<p>From the following article: <a href=\"https://tls.mbed.org/kb/cryptography/asn1-key-structures-in-der-and-pem\" rel=\"nofollow noreferrer\">ASN.1 key structures in DER and PEM</a> I learned that a private key having the following header/footer: <code>-----BEGIN ENCRYPTED PRIVATE KEY----- * -----END ENCRYPTED PRIVATE KEY-----</code> is also an asn.1 encoded private key with the following structure:</p>\n<pre><code>EncryptedPrivateKeyInfo ::= SEQUENCE {\n  encryptionAlgorithm  EncryptionAlgorithmIdentifier,\n  encryptedData        EncryptedData\n}\n\nEncryptionAlgorithmIdentifier ::= AlgorithmIdentifier\n\nEncryptedData ::= OCTET STRING\n</code></pre>\n<p>I also tried the answers provided here <a href=\"https://stackoverflow.com/questions/2654949/how-to-read-a-password-encrypted-key-with-java\">How to read a password encrypted key with java?</a> but those also didn't work. However I am not quite sure how to parse it correctly to a java object and load it as a KeySpec. So any help is welcome!</p>\n<p>======&gt;\nUpdated progress at 12-09-2020 based on the input of <code>dave_thompson_085</code></p>\n<pre><code>Matcher privateKeyMatcher = Pattern.compile(&quot;-----BEGIN ENCRYPTED PRIVATE KEY-----(.*?)-----END ENCRYPTED PRIVATE KEY-----&quot;, Pattern.DOTALL)\n        .matcher(identityContent);\n\nif (privateKeyMatcher.find()) {\n    String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\n    byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\n    try (ByteArrayInputStream privateKeyAsInputStream = new ByteArrayInputStream(decodedPrivateKeyContent)) {\n        ASN1InputStream stream = new ASN1InputStream(new DERDecoder(), privateKeyAsInputStream);\n        ASN1Sequence asn1Sequence = stream.readObject();\n\n        ASN1OctetString privateKeyAsOctetString = (ASN1OctetString) asn1Sequence.get(1);\n        ASN1OctetString saltAsOctetString = (ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(0);\n        ASN1OctetString initializationVectorAsOctec = ((ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(1)).get(1));\n        ASN1Integer iterationCount = (ASN1Integer) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(1);\n\n        IvParameterSpec ivParameterSpec = new IvParameterSpec(initializationVectorAsOctec.getValue());\n\n        SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(&quot;PBKDF2withHmacSHA1&quot;);\n        EncryptedPrivateKeyInfo encryptedPrivateKeyInfo = new EncryptedPrivateKeyInfo(secretKeyFactory.getAlgorithm(), privateKeyAsOctetString.getValue());\n\n        int keyLength = encryptedPrivateKeyInfo.getEncoded().length;\n        PBEKeySpec pbeKeySpec = new PBEKeySpec(keyPassword, saltAsOctetString.getValue(), iterationCount.getValue().intValue(), keyLength);\n\n        Cipher cipher = Cipher.getInstance(&quot;DESede/CBC/PKCS5Padding/&quot;);\n\n        SecretKey secretKey = secretKeyFactory.generateSecret(pbeKeySpec);\n\n        cipher.init(Cipher.DECRYPT_MODE, secretKey, ivParameterSpec);\n        PKCS8EncodedKeySpec keySpec = encryptedPrivateKeyInfo.getKeySpec(cipher);\n    }\n}\n</code></pre>\n<p>Results into the following exception: <code>java.security.InvalidKeyException: Wrong algorithm: DESede or TripleDES required</code> on the statement <code>cipher.init(Cipher.DECRYPT_MODE, secretKey, ivParameterSpec);</code></p>\n<p>======&gt;\nUpdated progress at 13-09-2020 based on the input of <code>Michael Fehr</code></p>\n<pre><code>Matcher privateKeyMatcher = Pattern.compile(&quot;-----BEGIN ENCRYPTED PRIVATE KEY-----(.*?)-----END ENCRYPTED PRIVATE KEY-----&quot;, Pattern.DOTALL)\n        .matcher(identityContent);\n\nif (privateKeyMatcher.find()) {\n    String privateKeyContent = privateKeyMatcher.group(1).replace(NEW_LINE, EMPTY).trim();\n    byte[] decodedPrivateKeyContent = Base64.getDecoder().decode(privateKeyContent);\n    try (ByteArrayInputStream privateKeyAsInputStream = new ByteArrayInputStream(decodedPrivateKeyContent)) {\n        ASN1InputStream stream = new ASN1InputStream(new DERDecoder(), privateKeyAsInputStream);\n        ASN1Sequence asn1Sequence = stream.readObject();\n\n        ASN1OctetString privateKeyAsOctetString = (ASN1OctetString) asn1Sequence.get(1);\n        ASN1OctetString saltAsOctetString = (ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(0);\n        ASN1OctetString initializationVectorAsOctec = ((ASN1OctetString) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(1)).get(1));\n        ASN1Integer iterationCount = (ASN1Integer) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) ((ASN1Sequence) asn1Sequence.get(0)).get(1)).get(0)).get(1)).get(1);\n\n        IvParameterSpec ivParameterSpec = new IvParameterSpec(initializationVectorAsOctec.getValue());\n\n        SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(&quot;PBKDF2withHmacSHA1&quot;);\n        EncryptedPrivateKeyInfo encryptedPrivateKeyInfo = new EncryptedPrivateKeyInfo(secretKeyFactory.getAlgorithm(), privateKeyAsOctetString.getValue());\n\n        int keyLength = 24 * 8;\n        PBEKeySpec pbeKeySpec = new PBEKeySpec(keyPassword, saltAsOctetString.getValue(), iterationCount.getValue().intValue(), keyLength);\n\n        Cipher cipher = Cipher.getInstance(&quot;DESede/CBC/PKCS5Padding/&quot;);\n\n        SecretKey secretKeyPbkdf = secretKeyFactory.generateSecret(pbeKeySpec);\n        SecretKey secretKey = new SecretKeySpec(secretKeyPbkdf.getEncoded(), &quot;DESede&quot;);\n\n        cipher.init(Cipher.DECRYPT_MODE, secretKey, ivParameterSpec);\n        PKCS8EncodedKeySpec keySpec = encryptedPrivateKeyInfo.getKeySpec(cipher);\n    }\n}\n</code></pre>\n"},{"tags":["java","reactjs","twilio","twilio-video"],"owner":{"account_id":3197891,"reputation":157,"user_id":2700673,"accept_rate":47,"display_name":"The Old County"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":117,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1681056248,"creation_date":1681054904,"question_id":75971443,"body_markdown":"I am building a Java Springboot and react platform with twilio-video 2.27.0 - to allow to logged in members to video chat to each other.\r\n\r\n[![enter image description here][1]][1]\r\n\r\nI am getting what could look like a malfunction if its not fixed - that when leaving the room - the web cam light remains on -- I&#39;ve tried to follow various references but nothing seems to work - the web cam light only stops on a hard refresh.\r\n\r\nhttps://stackoverflow.com/questions/48402533/twilio-video-how-to-destroy-video-room-when-user-who-created-it-leaves-it\r\n\r\nhttps://stackoverflow.com/questions/51947368/twilio-room-does-not-disconnect-webcam-led-remains-on\r\n\r\nhttps://stackoverflow.com/questions/69829699/track-stop-is-not-turning-the-camera-off-anymore\r\n\r\n[![enter image description here][2]][2]\r\n\r\n\r\nI&#39;ve tried stopping tracks, unpublishing, disable etc..\r\n\r\nAlso I get an error if a user clicks off the page without &quot;leaving the room&quot; and then they try and join the conference again - its like the room becomes unusable and a conference between them cant come back - the only way is to leave the room and re-create it again\r\n\r\n------------\r\n\r\n\r\n    import React, { Component } from &#39;react&#39;;\r\n    import Video from &#39;twilio-video&#39;;\r\n    import Button from &#39;@mui/material/Button&#39;;\r\n    //import TextField from &#39;@mui/material/TextField&#39;;\r\n    import { getToken, getUserDetails } from &#39;../_globals/UserFunctions/UserFunctions&#39;;\r\n    \r\n    class VideoChat extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n      \r\n        this.state = {\r\n          identity: &quot;&quot;,\r\n          roomId: null,\r\n          username: &#39;&#39;,\r\n          localMediaAvailable: true,\r\n          hasJoinedRoom: false,\r\n          remoteMediaAvailable: false,\r\n          remoteTracks: []\r\n        };\r\n      \r\n        this.joinRoom = this.joinRoom.bind(this);\r\n        this.leaveRoom = this.leaveRoom.bind(this);\r\n        this.handleUsernameChange = this.handleUsernameChange.bind(this);\r\n        this.handleRoomChange = this.handleRoomChange.bind(this);\r\n    \r\n        this.localMediaRef = React.createRef();\r\n        this.remoteMediaRef = React.createRef();    \r\n      }  \r\n    \r\n      handleUsernameChange(event) {\r\n        this.setState({ username: event.target.value });\r\n      }\r\n      handleRoomChange(event) {\r\n        this.setState({ roomId: event.target.value });\r\n      }\r\n      \r\n      startComponent() {\r\n        const userId = getUserDetails().id;\r\n        fetch(`http://localhost:9000/api/twilio/token?userId=${userId}`, {\r\n          headers: {\r\n            &#39;Authorization&#39;: &#39;Bearer &#39; + getToken()\r\n            }})\r\n          .then(res =&gt; res.json())\r\n          .then(data =&gt; {\r\n            Video.connect(data.token, { name: this.state.roomId }).then(this.joinRoom, error =&gt; console.error(`Unable to connect to Room: ${error.message}`));\r\n            this.setState({ identity: userId });\r\n          });\r\n      }\r\n    \r\n      componentWillUnmount() {\r\n        if (this.state.room) {\r\n          this.state.room.disconnect();\r\n        }\r\n      }\r\n    \r\n      joinRoom(room) {\r\n        this.setState({\r\n          room: room,\r\n          localMediaAvailable: true,\r\n          hasJoinedRoom: true\r\n        });\r\n    \r\n        Video.createLocalVideoTrack().then(track =&gt; {\r\n          const localMedia = this.localMediaRef.current;\r\n          localMedia.appendChild(track.attach());\r\n          localMedia.querySelector(&quot;div.label&quot;).innerHTML = room.localParticipant.identity;\r\n        });\r\n    \r\n        console.log(`Joined as ${this.state.identity}`);\r\n    \r\n        room.on(&#39;participantConnected&#39;, participant =&gt; {\r\n          console.log(`Participant ${participant.identity} has joined the room.`);\r\n          this.setState({ remoteMediaAvailable: true });\r\n          participant.tracks.forEach(publication =&gt; {\r\n            if (publication.isSubscribed) {\r\n              this.trackSubscribed(publication.track);\r\n            }\r\n          });\r\n          participant.on(&#39;trackSubscribed&#39;, track =&gt; {\r\n            this.trackSubscribed(track);\r\n          });\r\n        });\r\n    \r\n        room.on(&#39;participantDisconnected&#39;, participant =&gt; {\r\n          console.log(`Participant ${participant.identity} has left the room.`);\r\n          this.setState({ hasJoinedRoom: false, localMediaAvailable: false, remoteMediaAvailable: false, remoteTracks: [] });\r\n          const remoteMedia = this.remoteMediaRef.current;\r\n          remoteMedia.innerHTML = &#39;&#39;; // Clear the container when a participant leaves\r\n    \r\n          console.log(&quot;---------participantDisconnected&quot;, participant)\r\n        });\r\n        \r\n    \r\n        room.participants.forEach(participant =&gt; {\r\n          console.log(`Participant ${participant.identity} is connected to the room.`);\r\n          this.setState({ remoteMediaAvailable: true });\r\n          participant.tracks.forEach(publication =&gt; {\r\n            if (publication.isSubscribed) {\r\n              this.trackSubscribed(publication.track);\r\n            }\r\n          });\r\n          participant.on(&#39;trackSubscribed&#39;, track =&gt; {\r\n            // this.trackSubscribed(track);\r\n    \r\n            const remoteMedia = this.remoteMediaRef.current;\r\n            remoteMedia.appendChild(track.attach());\r\n            remoteMedia.querySelector(&quot;div.label&quot;).innerHTML = this.getRemoteLabel(room);\r\n          });\r\n        });\r\n    \r\n        room.on(&#39;disconnected&#39;, () =&gt; {\r\n          console.log(`Disconnected from Room ${room.name}`);\r\n          this.setState({ hasJoinedRoom: false, localMediaAvailable: false, remoteMediaAvailable: false, remoteTracks: [] });\r\n          \r\n          //room.localParticipant.stop()\r\n          console.log(&quot;---------participantDisconnected&quot;, room.localParticipant)\r\n    \r\n          // Detach the local media elements\r\n          //room.localParticipant.tracks.forEach(publication =&gt; {\r\n          //  const attachedElements = publication.track.detach();\r\n          //  attachedElements.forEach(element =&gt; element.remove());\r\n          //});\r\n    \r\n    \r\n          room.localParticipant.tracks.forEach(function(track) {\r\n    //        track.stop();\r\n    //        track.detach();\r\n          });\r\n    \r\n          //localTrack.mediaStreamTrack.stop()\r\n    \r\n    \r\n          room.localParticipant.tracks.forEach((track) =&gt; {\r\n            console.log(&quot;---track&quot;, track.track)\r\n    \r\n            room.localParticipant.unpublishTrack(track.track);\r\n            track.track.stop();\r\n          });\r\n    \r\n    \r\n    /*\r\n          room.localParticipant.tracks.forEach(publication =&gt; {\r\n              publication.track.stop();\r\n    \r\n              const attachedElements = publication.track.detach();\r\n              console.log(&quot;unsubscribed from: &quot; + publication.track)\r\n              attachedElements.forEach(element =&gt; element.remove());\r\n          });\r\n    */\r\n    \r\n          room.localParticipant.tracks.forEach(track =&gt; {\r\n            console.log(&quot;xxxxxx track&quot;, track)\r\n            //track.track.stop();\r\n            //track.mediaStreamTrack.stop()\r\n          })\r\n    \r\n          room.localParticipant.videoTracks.forEach(video =&gt; {\r\n            console.log(&quot;xxxxxx video&quot;, video)\r\n    \r\n    \r\n    \r\n            //const trackConst = [video][0].track;\r\n            //trackConst.stop();\r\n    \r\n            //trackConst.detach().forEach(element =&gt; element.remove());\r\n    \r\n            //room.localParticipant.unpublishTrack(trackConst);\r\n    \r\n          });\r\n          \r\n    \r\n    \r\n        //room.participants.forEach(participantDisconnected);\r\n    //    room.localParticipant.tracks.forEach((publication: Video.LocalTrackPublication) =&gt; {\r\n    //      console.log(&quot;---------publication&quot;, publication)\r\n    \r\n     //     publication.unpublish();\r\n          //if (publication.track.kind !== &#39;data&#39;) trackUnsubscribed(publication.track);\r\n     //   });\r\n    \r\n        });\r\n      }\r\n    \r\n      getRemoteLabel(room) {\r\n        let identity = &quot;&quot;;\r\n        for (let [key] of room.participants) {\r\n          identity = room.participants.get(key).identity;\r\n        }\r\n        return identity;\r\n      }\r\n    \r\n      trackSubscribed(track) {\r\n        // Check if an HTML element for this track and participant already exists\r\n        const existingMediaElement = document.getElementById(`${track.kind}-${track.sid}`);\r\n        if (existingMediaElement) {\r\n          existingMediaElement.appendChild(track.attach());\r\n        } else {\r\n          // Create a new HTML element for the new media track\r\n          const mediaElement = document.createElement(&#39;div&#39;);\r\n          mediaElement.id = `${track.kind}-${track.sid}`;\r\n          mediaElement.appendChild(track.attach());\r\n      \r\n          // Append the new element to the remote-media-div\r\n          const remoteMedia = this.remoteMediaRef.current;\r\n          remoteMedia.appendChild(mediaElement);\r\n          remoteMedia.querySelector(&quot;div.label&quot;).innerHTML = this.getRemoteLabel(this.state.room);\r\n      \r\n          // Add the new track to the remoteTracks array in the state\r\n          this.setState({\r\n            remoteTracks: [...this.state.remoteTracks, track]\r\n          });\r\n        }\r\n      }\r\n      \r\n    \r\n      leaveRoom() {\r\n        const userId = getUserDetails().id;\r\n        const url = `http://localhost:9000/api/twilio/room?userId=${userId}`;\r\n      \r\n        fetch(url, {\r\n          method: &#39;PATCH&#39;,\r\n          headers: {\r\n            &#39;Authorization&#39;: `Bearer ${getToken()}`\r\n          }\r\n        })\r\n        .then(res =&gt; res.json())\r\n        .then(() =&gt; {\r\n          this.state.room.disconnect();\r\n          this.setState({\r\n            hasJoinedRoom: false,\r\n            localMediaAvailable: false,\r\n            remoteMediaAvailable: false,\r\n            remoteTracks: []\r\n          });\r\n        });\r\n      }\r\n      \r\n    \r\n      render() {\r\n        return (\r\n          &lt;div&gt;\r\n    \r\n            {/*\r\n            &lt;TextField id=&quot;username&quot; label=&quot;Username&quot; value={this.state.username} onChange={this.handleUsernameChange}/&gt;\r\n            &lt;TextField id=&quot;roomId&quot; label=&quot;roomId&quot; value={this.state.roomId} onChange={this.handleRoomChange}/&gt;\r\n            */}\r\n    \r\n            &lt;Button\r\n              variant={&quot;contained&quot;}\r\n              color={&quot;primary&quot;}\r\n              onClick={() =&gt; this.startComponent()}&gt;\r\n                Join Room\r\n            &lt;/Button&gt;\r\n    \r\n            {this.state.hasJoinedRoom ? (\r\n              &lt;div&gt;\r\n                &lt;Button \r\n                  variant={&quot;contained&quot;}\r\n                  color={&quot;primary&quot;}\r\n                  onClick={this.leaveRoom}&gt;\r\n                    Leave Room\r\n                &lt;/Button&gt;\r\n    \r\n                &lt;div className=&quot;feed feed1&quot; id=&quot;remote-media-div&quot; ref={this.remoteMediaRef}&gt;&lt;div className=&quot;label&quot;&gt;&lt;/div&gt;&lt;/div&gt;\r\n    \r\n                {this.state.localMediaAvailable ? (\r\n                  &lt;div className=&quot;feed feed2&quot; id=&quot;local-media-div&quot; ref={this.localMediaRef}&gt;&lt;div className=&quot;label&quot;&gt;&lt;/div&gt;&lt;/div&gt;\r\n                ) : (\r\n                  &lt;p&gt;Local media not available.&lt;/p&gt;\r\n                )}\r\n              \r\n              &lt;/div&gt;\r\n            ) : (\r\n              &lt;p&gt;Joining room...&lt;/p&gt;\r\n            )}\r\n          &lt;/div&gt;\r\n        );\r\n      }\r\n    }\r\n    export default VideoChat;\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/UWzL1.png\r\n  [2]: https://i.stack.imgur.com/N2zxl.png","title":"Twilio - twilio-video&quot;: &quot;^2.27.0 on leaving the room cant turn the web cam light off","body":"<p>I am building a Java Springboot and react platform with twilio-video 2.27.0 - to allow to logged in members to video chat to each other.</p>\n<p><a href=\"https://i.stack.imgur.com/UWzL1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UWzL1.png\" alt=\"enter image description here\" /></a></p>\n<p>I am getting what could look like a malfunction if its not fixed - that when leaving the room - the web cam light remains on -- I've tried to follow various references but nothing seems to work - the web cam light only stops on a hard refresh.</p>\n<p><a href=\"https://stackoverflow.com/questions/48402533/twilio-video-how-to-destroy-video-room-when-user-who-created-it-leaves-it\">Twilio Video :How to destroy video room when user who created it leaves it?</a></p>\n<p><a href=\"https://stackoverflow.com/questions/51947368/twilio-room-does-not-disconnect-webcam-led-remains-on\">Twilio room does not disconnect / Webcam LED remains on</a></p>\n<p><a href=\"https://stackoverflow.com/questions/69829699/track-stop-is-not-turning-the-camera-off-anymore\">track.stop is not turning the camera off anymore</a></p>\n<p><a href=\"https://i.stack.imgur.com/N2zxl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N2zxl.png\" alt=\"enter image description here\" /></a></p>\n<p>I've tried stopping tracks, unpublishing, disable etc..</p>\n<p>Also I get an error if a user clicks off the page without &quot;leaving the room&quot; and then they try and join the conference again - its like the room becomes unusable and a conference between them cant come back - the only way is to leave the room and re-create it again</p>\n<hr />\n<pre><code>import React, { Component } from 'react';\nimport Video from 'twilio-video';\nimport Button from '@mui/material/Button';\n//import TextField from '@mui/material/TextField';\nimport { getToken, getUserDetails } from '../_globals/UserFunctions/UserFunctions';\n\nclass VideoChat extends Component {\n  constructor(props) {\n    super(props);\n  \n    this.state = {\n      identity: &quot;&quot;,\n      roomId: null,\n      username: '',\n      localMediaAvailable: true,\n      hasJoinedRoom: false,\n      remoteMediaAvailable: false,\n      remoteTracks: []\n    };\n  \n    this.joinRoom = this.joinRoom.bind(this);\n    this.leaveRoom = this.leaveRoom.bind(this);\n    this.handleUsernameChange = this.handleUsernameChange.bind(this);\n    this.handleRoomChange = this.handleRoomChange.bind(this);\n\n    this.localMediaRef = React.createRef();\n    this.remoteMediaRef = React.createRef();    \n  }  \n\n  handleUsernameChange(event) {\n    this.setState({ username: event.target.value });\n  }\n  handleRoomChange(event) {\n    this.setState({ roomId: event.target.value });\n  }\n  \n  startComponent() {\n    const userId = getUserDetails().id;\n    fetch(`http://localhost:9000/api/twilio/token?userId=${userId}`, {\n      headers: {\n        'Authorization': 'Bearer ' + getToken()\n        }})\n      .then(res =&gt; res.json())\n      .then(data =&gt; {\n        Video.connect(data.token, { name: this.state.roomId }).then(this.joinRoom, error =&gt; console.error(`Unable to connect to Room: ${error.message}`));\n        this.setState({ identity: userId });\n      });\n  }\n\n  componentWillUnmount() {\n    if (this.state.room) {\n      this.state.room.disconnect();\n    }\n  }\n\n  joinRoom(room) {\n    this.setState({\n      room: room,\n      localMediaAvailable: true,\n      hasJoinedRoom: true\n    });\n\n    Video.createLocalVideoTrack().then(track =&gt; {\n      const localMedia = this.localMediaRef.current;\n      localMedia.appendChild(track.attach());\n      localMedia.querySelector(&quot;div.label&quot;).innerHTML = room.localParticipant.identity;\n    });\n\n    console.log(`Joined as ${this.state.identity}`);\n\n    room.on('participantConnected', participant =&gt; {\n      console.log(`Participant ${participant.identity} has joined the room.`);\n      this.setState({ remoteMediaAvailable: true });\n      participant.tracks.forEach(publication =&gt; {\n        if (publication.isSubscribed) {\n          this.trackSubscribed(publication.track);\n        }\n      });\n      participant.on('trackSubscribed', track =&gt; {\n        this.trackSubscribed(track);\n      });\n    });\n\n    room.on('participantDisconnected', participant =&gt; {\n      console.log(`Participant ${participant.identity} has left the room.`);\n      this.setState({ hasJoinedRoom: false, localMediaAvailable: false, remoteMediaAvailable: false, remoteTracks: [] });\n      const remoteMedia = this.remoteMediaRef.current;\n      remoteMedia.innerHTML = ''; // Clear the container when a participant leaves\n\n      console.log(&quot;---------participantDisconnected&quot;, participant)\n    });\n    \n\n    room.participants.forEach(participant =&gt; {\n      console.log(`Participant ${participant.identity} is connected to the room.`);\n      this.setState({ remoteMediaAvailable: true });\n      participant.tracks.forEach(publication =&gt; {\n        if (publication.isSubscribed) {\n          this.trackSubscribed(publication.track);\n        }\n      });\n      participant.on('trackSubscribed', track =&gt; {\n        // this.trackSubscribed(track);\n\n        const remoteMedia = this.remoteMediaRef.current;\n        remoteMedia.appendChild(track.attach());\n        remoteMedia.querySelector(&quot;div.label&quot;).innerHTML = this.getRemoteLabel(room);\n      });\n    });\n\n    room.on('disconnected', () =&gt; {\n      console.log(`Disconnected from Room ${room.name}`);\n      this.setState({ hasJoinedRoom: false, localMediaAvailable: false, remoteMediaAvailable: false, remoteTracks: [] });\n      \n      //room.localParticipant.stop()\n      console.log(&quot;---------participantDisconnected&quot;, room.localParticipant)\n\n      // Detach the local media elements\n      //room.localParticipant.tracks.forEach(publication =&gt; {\n      //  const attachedElements = publication.track.detach();\n      //  attachedElements.forEach(element =&gt; element.remove());\n      //});\n\n\n      room.localParticipant.tracks.forEach(function(track) {\n//        track.stop();\n//        track.detach();\n      });\n\n      //localTrack.mediaStreamTrack.stop()\n\n\n      room.localParticipant.tracks.forEach((track) =&gt; {\n        console.log(&quot;---track&quot;, track.track)\n\n        room.localParticipant.unpublishTrack(track.track);\n        track.track.stop();\n      });\n\n\n/*\n      room.localParticipant.tracks.forEach(publication =&gt; {\n          publication.track.stop();\n\n          const attachedElements = publication.track.detach();\n          console.log(&quot;unsubscribed from: &quot; + publication.track)\n          attachedElements.forEach(element =&gt; element.remove());\n      });\n*/\n\n      room.localParticipant.tracks.forEach(track =&gt; {\n        console.log(&quot;xxxxxx track&quot;, track)\n        //track.track.stop();\n        //track.mediaStreamTrack.stop()\n      })\n\n      room.localParticipant.videoTracks.forEach(video =&gt; {\n        console.log(&quot;xxxxxx video&quot;, video)\n\n\n\n        //const trackConst = [video][0].track;\n        //trackConst.stop();\n\n        //trackConst.detach().forEach(element =&gt; element.remove());\n\n        //room.localParticipant.unpublishTrack(trackConst);\n\n      });\n      \n\n\n    //room.participants.forEach(participantDisconnected);\n//    room.localParticipant.tracks.forEach((publication: Video.LocalTrackPublication) =&gt; {\n//      console.log(&quot;---------publication&quot;, publication)\n\n //     publication.unpublish();\n      //if (publication.track.kind !== 'data') trackUnsubscribed(publication.track);\n //   });\n\n    });\n  }\n\n  getRemoteLabel(room) {\n    let identity = &quot;&quot;;\n    for (let [key] of room.participants) {\n      identity = room.participants.get(key).identity;\n    }\n    return identity;\n  }\n\n  trackSubscribed(track) {\n    // Check if an HTML element for this track and participant already exists\n    const existingMediaElement = document.getElementById(`${track.kind}-${track.sid}`);\n    if (existingMediaElement) {\n      existingMediaElement.appendChild(track.attach());\n    } else {\n      // Create a new HTML element for the new media track\n      const mediaElement = document.createElement('div');\n      mediaElement.id = `${track.kind}-${track.sid}`;\n      mediaElement.appendChild(track.attach());\n  \n      // Append the new element to the remote-media-div\n      const remoteMedia = this.remoteMediaRef.current;\n      remoteMedia.appendChild(mediaElement);\n      remoteMedia.querySelector(&quot;div.label&quot;).innerHTML = this.getRemoteLabel(this.state.room);\n  \n      // Add the new track to the remoteTracks array in the state\n      this.setState({\n        remoteTracks: [...this.state.remoteTracks, track]\n      });\n    }\n  }\n  \n\n  leaveRoom() {\n    const userId = getUserDetails().id;\n    const url = `http://localhost:9000/api/twilio/room?userId=${userId}`;\n  \n    fetch(url, {\n      method: 'PATCH',\n      headers: {\n        'Authorization': `Bearer ${getToken()}`\n      }\n    })\n    .then(res =&gt; res.json())\n    .then(() =&gt; {\n      this.state.room.disconnect();\n      this.setState({\n        hasJoinedRoom: false,\n        localMediaAvailable: false,\n        remoteMediaAvailable: false,\n        remoteTracks: []\n      });\n    });\n  }\n  \n\n  render() {\n    return (\n      &lt;div&gt;\n\n        {/*\n        &lt;TextField id=&quot;username&quot; label=&quot;Username&quot; value={this.state.username} onChange={this.handleUsernameChange}/&gt;\n        &lt;TextField id=&quot;roomId&quot; label=&quot;roomId&quot; value={this.state.roomId} onChange={this.handleRoomChange}/&gt;\n        */}\n\n        &lt;Button\n          variant={&quot;contained&quot;}\n          color={&quot;primary&quot;}\n          onClick={() =&gt; this.startComponent()}&gt;\n            Join Room\n        &lt;/Button&gt;\n\n        {this.state.hasJoinedRoom ? (\n          &lt;div&gt;\n            &lt;Button \n              variant={&quot;contained&quot;}\n              color={&quot;primary&quot;}\n              onClick={this.leaveRoom}&gt;\n                Leave Room\n            &lt;/Button&gt;\n\n            &lt;div className=&quot;feed feed1&quot; id=&quot;remote-media-div&quot; ref={this.remoteMediaRef}&gt;&lt;div className=&quot;label&quot;&gt;&lt;/div&gt;&lt;/div&gt;\n\n            {this.state.localMediaAvailable ? (\n              &lt;div className=&quot;feed feed2&quot; id=&quot;local-media-div&quot; ref={this.localMediaRef}&gt;&lt;div className=&quot;label&quot;&gt;&lt;/div&gt;&lt;/div&gt;\n            ) : (\n              &lt;p&gt;Local media not available.&lt;/p&gt;\n            )}\n          \n          &lt;/div&gt;\n        ) : (\n          &lt;p&gt;Joining room...&lt;/p&gt;\n        )}\n      &lt;/div&gt;\n    );\n  }\n}\nexport default VideoChat;\n</code></pre>\n"},{"tags":["java","arrays","object","methods","insert"],"comments":[{"owner":{"account_id":6520,"reputation":10523,"user_id":11002,"accept_rate":75,"display_name":"tgdavies"},"score":0,"creation_date":1680869179,"post_id":75957986,"comment_id":133972645,"body_markdown":"What is your question exactly?","body":"What is your question exactly?"},{"owner":{"account_id":213468,"reputation":103500,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1680963057,"post_id":75957986,"comment_id":133984601,"body_markdown":"You should ask your teacher what you should do instead.","body":"You should ask your teacher what you should do instead."}],"answers":[{"comments":[{"owner":{"account_id":6520,"reputation":10523,"user_id":11002,"accept_rate":75,"display_name":"tgdavies"},"score":0,"creation_date":1680869082,"post_id":75958109,"comment_id":133972632,"body_markdown":"As you always replace `projectTasks[i]` with a newly created object, your `if` statements have no effect.","body":"As you always replace <code>projectTasks[i]</code> with a newly created object, your <code>if</code> statements have no effect."}],"tags":[],"owner":{"account_id":25100879,"reputation":1,"user_id":21508914,"display_name":"Barbara Riga"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681055697,"creation_date":1680867887,"answer_id":75958109,"question_id":75957986,"body_markdown":"I tried this too and I think is better for my purpose:\r\n\r\n```java\r\nprivate void updateTask(String tID, String title, Date newFrom, Date newTo, status stat) {\r\n\t\t\r\n\tfor(int i=0; i&lt;this.numOfTasks; i++) {\r\n\t\tif(projectTasks[i]!=null) {\r\n\t\t\tif(tID!=null) {\r\n\t\t\t\tprojectTasks[i].setTaskID(tID);\r\n\t\t\t} else if(tID ==null) {\r\n\t\t\t\tprojectTasks[i].getTaskID();\r\n\t\t\t}\r\n\t\t\tif(title!=null) {\r\n\t\t\t\tprojectTasks[i].setTaskTitle(title);\r\n\t\t\t} else if(title==null) {\r\n\t\t\t\tprojectTasks[i].getTaskTitle();\r\n\t\t\t}\r\n\t\t\tif(newFrom!=null) {\r\n\t\t\t\tprojectTasks[i].setTaskFromDate(newTo);\r\n\t\t\t} else if(newFrom==null) {\r\n\t\t\t\tprojectTasks[i].getTaskFromDate();\r\n\t\t\t}\r\n\t\t\tif(newTo!=null) {\r\n\t\t\t\tprojectTasks[i].setTaskEndDate(newTo);\r\n\t\t\t} else if(newTo==null) {\r\n\t\t\t\tprojectTasks[i].getTaskEndDate();\r\n\t\t\t}\r\n\t\t\tif(stat!=null) {\r\n\t\t\t\tprojectTasks[i].setTaskStatus(stat);\r\n\t\t\t} else if(stat==null) {\r\n\t\t\t\tprojectTasks[i].getTaskStatus();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tprojectTasks[i] = new Task(tID, title, newFrom, newTo, stat);\r\n\t\t}\r\n\t }\r\n\t}\r\n```","title":"Change only a specific element of an array of objects","body":"<p>I tried this too and I think is better for my purpose:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private void updateTask(String tID, String title, Date newFrom, Date newTo, status stat) {\n        \n    for(int i=0; i&lt;this.numOfTasks; i++) {\n        if(projectTasks[i]!=null) {\n            if(tID!=null) {\n                projectTasks[i].setTaskID(tID);\n            } else if(tID ==null) {\n                projectTasks[i].getTaskID();\n            }\n            if(title!=null) {\n                projectTasks[i].setTaskTitle(title);\n            } else if(title==null) {\n                projectTasks[i].getTaskTitle();\n            }\n            if(newFrom!=null) {\n                projectTasks[i].setTaskFromDate(newTo);\n            } else if(newFrom==null) {\n                projectTasks[i].getTaskFromDate();\n            }\n            if(newTo!=null) {\n                projectTasks[i].setTaskEndDate(newTo);\n            } else if(newTo==null) {\n                projectTasks[i].getTaskEndDate();\n            }\n            if(stat!=null) {\n                projectTasks[i].setTaskStatus(stat);\n            } else if(stat==null) {\n                projectTasks[i].getTaskStatus();\n            }\n            \n            projectTasks[i] = new Task(tID, title, newFrom, newTo, stat);\n        }\n     }\n    }\n</code></pre>\n"}],"owner":{"account_id":25100879,"reputation":1,"user_id":21508914,"display_name":"Barbara Riga"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":57,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1681055697,"creation_date":1680866803,"question_id":75957986,"body_markdown":"I am trying to create a method that changes/updates specific elements of an array of objects by telling the user to insert &#39;null&#39; for Strings and &#39;0&#39; for ints, meaning the default values and not changing the already existing values in my array. I tried this code, but my teacher said that I shouldn&#39;t use StandardInputRead for reading user&#39;s input. What should I do?\r\n\r\n```\r\nprivate void updateTask(String tID, String title, Date newFrom, Date newTo, status stat) \r\n{\r\n\t\t\r\n\t\tStandardInputRead sir = new StandardInputRead();\r\n\t\tint i;\r\n\t\tdisplayTasks();\r\n\t\ti = sir.readPositiveInt(&quot;Give task&#39;s index: \\n&quot;);\r\n\t\tif(projectTasks[i]!=null) \r\n{\r\n\t\t\tSystem.out.println(&quot;Submit only the fields you want to change.&quot;);\r\n\t\t\tSystem.out.println(&quot;In any other case, type &#39;null&#39; or &#39;0&#39; .&quot;);\r\n\t\t\ttID = sir.readString(&quot;Change the task&#39;s ID. \\n&quot;);\r\n\t\t\tprojectTasks[i].setTaskID(tID);\r\n\t\t\ttitle = sir.readString(&quot;Change the task&#39;s title. \\n&quot;);\r\n\t\t\tprojectTasks[i].setTaskTitle(title);\r\n\t\t\tnewFrom = sir.readDate(&quot;Edit the starting date (DD/MM/YY). \\n&quot;);\r\n\t\t\tprojectTasks[i].setTaskFromDate(newFrom);\r\n\t\t\tnewTo = sir.readDate(&quot;Edit the submission date (DD/MM/YY). \\n&quot;);\r\n\t\t\tprojectTasks[i].setTaskEndDate(newTo);\r\n\t\t\t//stat = Globals.status;\r\n\t\t\tprojectTasks[i] = new Task(tID, title, newFrom, newTo, stat);\r\n\t\t}\r\n\t\telse \r\n\t\t\tSystem.out.println(&quot;There is no such task in our list.&quot;);\r\n\t\t\r\n\t}\r\n```","title":"Change only a specific element of an array of objects","body":"<p>I am trying to create a method that changes/updates specific elements of an array of objects by telling the user to insert 'null' for Strings and '0' for ints, meaning the default values and not changing the already existing values in my array. I tried this code, but my teacher said that I shouldn't use StandardInputRead for reading user's input. What should I do?</p>\n<pre><code>private void updateTask(String tID, String title, Date newFrom, Date newTo, status stat) \n{\n        \n        StandardInputRead sir = new StandardInputRead();\n        int i;\n        displayTasks();\n        i = sir.readPositiveInt(&quot;Give task's index: \\n&quot;);\n        if(projectTasks[i]!=null) \n{\n            System.out.println(&quot;Submit only the fields you want to change.&quot;);\n            System.out.println(&quot;In any other case, type 'null' or '0' .&quot;);\n            tID = sir.readString(&quot;Change the task's ID. \\n&quot;);\n            projectTasks[i].setTaskID(tID);\n            title = sir.readString(&quot;Change the task's title. \\n&quot;);\n            projectTasks[i].setTaskTitle(title);\n            newFrom = sir.readDate(&quot;Edit the starting date (DD/MM/YY). \\n&quot;);\n            projectTasks[i].setTaskFromDate(newFrom);\n            newTo = sir.readDate(&quot;Edit the submission date (DD/MM/YY). \\n&quot;);\n            projectTasks[i].setTaskEndDate(newTo);\n            //stat = Globals.status;\n            projectTasks[i] = new Task(tID, title, newFrom, newTo, stat);\n        }\n        else \n            System.out.println(&quot;There is no such task in our list.&quot;);\n        \n    }\n</code></pre>\n"},{"tags":["java","pytorch","djl"],"comments":[{"owner":{"account_id":1684984,"reputation":27030,"user_id":1548468,"display_name":"Botje"},"score":0,"creation_date":1680250771,"post_id":75881496,"comment_id":133869714,"body_markdown":"You will need to inspect the maven build system to see how the file is supposed to be generated.","body":"You will need to inspect the maven build system to see how the file is supposed to be generated."}],"answers":[{"tags":[],"owner":{"account_id":18054922,"reputation":281,"user_id":13123639,"display_name":"Frank Liu"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681055226,"creation_date":1681055226,"answer_id":75971463,"question_id":75881496,"body_markdown":"I noticed a few issues in your `pom.xml`:\r\n\r\n1. You included `org.pytorch:pytorch_java_only`, this has nothing to do with DJL, and `pytorch_jni.dll` seems related to this library.\r\n2. You djl-springboot package is using 0.20, but your pytorch-engine is using 0.21.0. This may causing dependency mismatch. Please using matching version.","title":"UnsatisfiedLinkError: no pytorch_jni in java.library.path","body":"<p>I noticed a few issues in your <code>pom.xml</code>:</p>\n<ol>\n<li>You included <code>org.pytorch:pytorch_java_only</code>, this has nothing to do with DJL, and <code>pytorch_jni.dll</code> seems related to this library.</li>\n<li>You djl-springboot package is using 0.20, but your pytorch-engine is using 0.21.0. This may causing dependency mismatch. Please using matching version.</li>\n</ol>\n"}],"owner":{"account_id":20632808,"reputation":43,"user_id":15147264,"display_name":"Daria Mihăilă"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":256,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1681055226,"creation_date":1680118663,"question_id":75881496,"body_markdown":"I am trying to load a pytorch model file, ```model.pt```, that I trained into my Java Spring Boot application by using the DJL Framework on Windows 11. After adding all the dependencies and writing my `RestController` and running the application I get &quot;java.lang.UnsatisfiedLinkError: no pytorch_jni in java.library.path&quot; \r\n\r\nThese are my pom.xml dependencies\r\n```\r\n&lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;net.java.dev.jna&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;jna-platform&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;${jna.version}&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;!-- https://mvnrepository.com/artifact/ai.djl.spring/djl-spring-boot-starter-pytorch-auto --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;ai.djl.spring&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;djl-spring-boot-starter-pytorch-auto&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;0.20&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;ai.djl.pytorch&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;pytorch-native-cpu&lt;/artifactId&gt;\r\n\t\t\t&lt;classifier&gt;win-x86_64&lt;/classifier&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t\t&lt;version&gt;1.13.1&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;ai.djl.pytorch&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;pytorch-jni&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;1.13.1-0.21.0&lt;/version&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;!-- https://mvnrepository.com/artifact/ai.djl.pytorch/pytorch-engine --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;ai.djl.pytorch&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;pytorch-engine&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;0.21.0&lt;/version&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;!-- https://mvnrepository.com/artifact/org.pytorch/pytorch_java_only --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.pytorch&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;pytorch_java_only&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;1.13.1&lt;/version&gt;\r\n\t\t\t&lt;scope&gt;provided&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.3.0&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;jjwt&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;0.9.1&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.postgresql&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;postgresql&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;lombok&lt;/artifactId&gt;\r\n\t\t\t&lt;optional&gt;true&lt;/optional&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.mapstruct&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;mapstruct&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;1.5.3.Final&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t&lt;/dependencies&gt;\r\n```\r\n\r\nand this is my Controller\r\n```\r\npackage com.example.MyShroom_backend.controller;\r\n\r\nimport com.example.MyShroom_backend.dto.ClassifierRequestDto;\r\nimport com.example.MyShroom_backend.dto.ClassifierResponseDto;\r\nimport org.springframework.http.ResponseEntity;\r\nimport org.springframework.web.bind.annotation.*;\r\n\r\nimport java.util.Arrays;\r\nimport java.util.Base64;\r\n\r\nimport org.pytorch.IValue;\r\nimport org.pytorch.Module;\r\nimport org.pytorch.Tensor;\r\n@RestController\r\n@RequestMapping(&quot;/api/classifier&quot;)\r\npublic class ClassifierController {\r\n\r\n    @PostMapping(&quot;/predict&quot;)\r\n    public ResponseEntity&lt;?&gt; predict(@RequestBody ClassifierRequestDto dto) {\r\n        // Load the PyTorch model from a file\r\n        Module module = Module.load(&quot;path/to/myModels/model.pt&quot;);\r\n\r\n        // Define the normalization parameters for the ResNet34 model\r\n        float[] mean = new float[]{0.485f, 0.456f, 0.406f};\r\n        float[] std = new float[]{0.229f, 0.224f, 0.225f};\r\n\r\n        // Convert the input image to a tensor\r\n        byte[] imageBytes = Base64.getDecoder().decode(dto.getBase64Img());\r\n        Tensor inputTensor = Tensor.fromBlob(imageBytes, new long[]{1, 3, 224, 224});\r\n\r\n        float[] inputValues = inputTensor.getDataAsFloatArray();\r\n        // Normalize the input tensor\r\n        for (int i = 0; i &lt; inputValues.length; i++) {\r\n            inputValues[i] = (inputValues[i] - mean[i]) / std[i];\r\n        }\r\n\r\n        Tensor newInputTensor = Tensor.fromBlob(inputValues,new long[]{1, 3, 224, 224});\r\n        // Make a prediction using the PyTorch model\r\n        IValue output = module.forward(IValue.from(newInputTensor));\r\n        Tensor outputTensor = output.toTensor();\r\n        float[] scores = outputTensor.getDataAsFloatArray();\r\n\r\n        // Return the prediction as a JSON string\r\n        return ResponseEntity.ok(new ClassifierResponseDto(&quot;{\\&quot;scores\\&quot;: &quot; + Arrays.toString(scores) + &quot;}&quot;));\r\n    }\r\n\r\n}\r\n\r\n```\r\nand the error appears at this line ```Module module = Module.load(&quot;path/to/myModels/model.pt&quot;);```\r\n\r\nAfter I did some digging in my project I found the pytorch_jni.dll file in the ```target/classes/lib/``` folder and also in the application.jar, so that means that the mvn dependencies generate it but the file has size 0 KB, so even if I try to copy it in one of the ```java.library.path``` paths it generates another error:\r\n\r\n```\r\njava.lang.UnsatisfiedLinkError: C:\\Program Files\\Java\\jdk-17\\bin\\pytorch_jni.dll: %1 is not a valid Win32 application\r\n\tat java.base/jdk.internal.loader.NativeLibraries.load(Native Method) ~[na:na]\r\n\tat java.base/jdk.internal.loader.NativeLibraries$NativeLibraryImpl.open(NativeLibraries.java:384) ~[na:na]\r\n\tat java.base/jdk.internal.loader.NativeLibraries.loadLibrary(NativeLibraries.java:228) ~[na:na]\r\n\tat java.base/jdk.internal.loader.NativeLibraries.loadLibrary(NativeLibraries.java:170) ~[na:na]\r\n\tat java.base/jdk.internal.loader.NativeLibraries.findFromPaths(NativeLibraries.java:311) ~[na:na]\r\n\tat java.base/jdk.internal.loader.NativeLibraries.loadLibrary(NativeLibraries.java:281) ~[na:na]\r\n\tat java.base/java.lang.ClassLoader.loadLibrary(ClassLoader.java:2422) ~[na:na]\r\n\tat java.base/java.lang.Runtime.loadLibrary0(Runtime.java:818) ~[na:na]\r\n\tat java.base/java.lang.System.loadLibrary(System.java:1989) ~[na:na]\r\n\tat com.facebook.soloader.nativeloader.SystemDelegate.loadLibrary(SystemDelegate.java:24) ~[nativeloader-0.10.1.jar:na]\r\n\tat com.facebook.soloader.nativeloader.NativeLoader.loadLibrary(NativeLoader.java:51) ~[nativeloader-0.10.1.jar:na]\r\n\tat com.facebook.soloader.nativeloader.NativeLoader.loadLibrary(NativeLoader.java:30) ~[nativeloader-0.10.1.jar:na]\r\n\tat org.pytorch.NativePeer.&lt;clinit&gt;(NativePeer.java:10) ~[pytorch_java_only-1.13.1.jar:na]\r\n\tat org.pytorch.Module.load(Module.java:28) ~[pytorch_java_only-1.13.1.jar:na]\r\n\tat org.pytorch.Module.load(Module.java:38) ~[pytorch_java_only-1.13.1.jar:na]\r\n\tat com.example.MyShroom_backend.controller.ClassifierController.predict(ClassifierController.java:21) ~[classes/:na]\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]\r\n\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1080) ~[spring-webmvc-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:973) ~[spring-webmvc-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1003) ~[spring-webmvc-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:906) ~[spring-webmvc-6.0.2.jar:6.0.2]\r\n\tat jakarta.servlet.http.HttpServlet.service(HttpServlet.java:731) ~[tomcat-embed-core-10.1.1.jar:6.0]\r\n\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:880) ~[spring-webmvc-6.0.2.jar:6.0.2]\r\n\tat jakarta.servlet.http.HttpServlet.service(HttpServlet.java:814) ~[tomcat-embed-core-10.1.1.jar:6.0]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:223) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat com.example.MyShroom_backend.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:46) ~[classes/:na]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:219) ~[spring-security-web-6.0.0.jar:6.0.0]\r\n\tat org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.0.0.jar:6.0.0]\r\n\tat org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:351) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:119) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:400) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1739) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\r\n\tat java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]\r\n```\r\n\r\nand this would technically be caused by the .dll file being 64-bit and the JVM being only 32-bit but that is not the case, it&#39;s just the fact that the file is empty. I cannot figure why this is, maybe someone more experienced can help me? \r\n\r\n","title":"UnsatisfiedLinkError: no pytorch_jni in java.library.path","body":"<p>I am trying to load a pytorch model file, <code>model.pt</code>, that I trained into my Java Spring Boot application by using the DJL Framework on Windows 11. After adding all the dependencies and writing my <code>RestController</code> and running the application I get &quot;java.lang.UnsatisfiedLinkError: no pytorch_jni in java.library.path&quot;</p>\n<p>These are my pom.xml dependencies</p>\n<pre><code>&lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;net.java.dev.jna&lt;/groupId&gt;\n            &lt;artifactId&gt;jna-platform&lt;/artifactId&gt;\n            &lt;version&gt;${jna.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/ai.djl.spring/djl-spring-boot-starter-pytorch-auto --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;ai.djl.spring&lt;/groupId&gt;\n            &lt;artifactId&gt;djl-spring-boot-starter-pytorch-auto&lt;/artifactId&gt;\n            &lt;version&gt;0.20&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;ai.djl.pytorch&lt;/groupId&gt;\n            &lt;artifactId&gt;pytorch-native-cpu&lt;/artifactId&gt;\n            &lt;classifier&gt;win-x86_64&lt;/classifier&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n            &lt;version&gt;1.13.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;ai.djl.pytorch&lt;/groupId&gt;\n            &lt;artifactId&gt;pytorch-jni&lt;/artifactId&gt;\n            &lt;version&gt;1.13.1-0.21.0&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- https://mvnrepository.com/artifact/ai.djl.pytorch/pytorch-engine --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;ai.djl.pytorch&lt;/groupId&gt;\n            &lt;artifactId&gt;pytorch-engine&lt;/artifactId&gt;\n            &lt;version&gt;0.21.0&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- https://mvnrepository.com/artifact/org.pytorch/pytorch_java_only --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.pytorch&lt;/groupId&gt;\n            &lt;artifactId&gt;pytorch_java_only&lt;/artifactId&gt;\n            &lt;version&gt;1.13.1&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;\n            &lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;\n            &lt;version&gt;2.3.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;\n            &lt;artifactId&gt;jjwt&lt;/artifactId&gt;\n            &lt;version&gt;0.9.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.mapstruct&lt;/groupId&gt;\n            &lt;artifactId&gt;mapstruct&lt;/artifactId&gt;\n            &lt;version&gt;1.5.3.Final&lt;/version&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n</code></pre>\n<p>and this is my Controller</p>\n<pre><code>package com.example.MyShroom_backend.controller;\n\nimport com.example.MyShroom_backend.dto.ClassifierRequestDto;\nimport com.example.MyShroom_backend.dto.ClassifierResponseDto;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.*;\n\nimport java.util.Arrays;\nimport java.util.Base64;\n\nimport org.pytorch.IValue;\nimport org.pytorch.Module;\nimport org.pytorch.Tensor;\n@RestController\n@RequestMapping(&quot;/api/classifier&quot;)\npublic class ClassifierController {\n\n    @PostMapping(&quot;/predict&quot;)\n    public ResponseEntity&lt;?&gt; predict(@RequestBody ClassifierRequestDto dto) {\n        // Load the PyTorch model from a file\n        Module module = Module.load(&quot;path/to/myModels/model.pt&quot;);\n\n        // Define the normalization parameters for the ResNet34 model\n        float[] mean = new float[]{0.485f, 0.456f, 0.406f};\n        float[] std = new float[]{0.229f, 0.224f, 0.225f};\n\n        // Convert the input image to a tensor\n        byte[] imageBytes = Base64.getDecoder().decode(dto.getBase64Img());\n        Tensor inputTensor = Tensor.fromBlob(imageBytes, new long[]{1, 3, 224, 224});\n\n        float[] inputValues = inputTensor.getDataAsFloatArray();\n        // Normalize the input tensor\n        for (int i = 0; i &lt; inputValues.length; i++) {\n            inputValues[i] = (inputValues[i] - mean[i]) / std[i];\n        }\n\n        Tensor newInputTensor = Tensor.fromBlob(inputValues,new long[]{1, 3, 224, 224});\n        // Make a prediction using the PyTorch model\n        IValue output = module.forward(IValue.from(newInputTensor));\n        Tensor outputTensor = output.toTensor();\n        float[] scores = outputTensor.getDataAsFloatArray();\n\n        // Return the prediction as a JSON string\n        return ResponseEntity.ok(new ClassifierResponseDto(&quot;{\\&quot;scores\\&quot;: &quot; + Arrays.toString(scores) + &quot;}&quot;));\n    }\n\n}\n\n</code></pre>\n<p>and the error appears at this line <code>Module module = Module.load(&quot;path/to/myModels/model.pt&quot;);</code></p>\n<p>After I did some digging in my project I found the pytorch_jni.dll file in the <code>target/classes/lib/</code> folder and also in the application.jar, so that means that the mvn dependencies generate it but the file has size 0 KB, so even if I try to copy it in one of the <code>java.library.path</code> paths it generates another error:</p>\n<pre><code>java.lang.UnsatisfiedLinkError: C:\\Program Files\\Java\\jdk-17\\bin\\pytorch_jni.dll: %1 is not a valid Win32 application\n    at java.base/jdk.internal.loader.NativeLibraries.load(Native Method) ~[na:na]\n    at java.base/jdk.internal.loader.NativeLibraries$NativeLibraryImpl.open(NativeLibraries.java:384) ~[na:na]\n    at java.base/jdk.internal.loader.NativeLibraries.loadLibrary(NativeLibraries.java:228) ~[na:na]\n    at java.base/jdk.internal.loader.NativeLibraries.loadLibrary(NativeLibraries.java:170) ~[na:na]\n    at java.base/jdk.internal.loader.NativeLibraries.findFromPaths(NativeLibraries.java:311) ~[na:na]\n    at java.base/jdk.internal.loader.NativeLibraries.loadLibrary(NativeLibraries.java:281) ~[na:na]\n    at java.base/java.lang.ClassLoader.loadLibrary(ClassLoader.java:2422) ~[na:na]\n    at java.base/java.lang.Runtime.loadLibrary0(Runtime.java:818) ~[na:na]\n    at java.base/java.lang.System.loadLibrary(System.java:1989) ~[na:na]\n    at com.facebook.soloader.nativeloader.SystemDelegate.loadLibrary(SystemDelegate.java:24) ~[nativeloader-0.10.1.jar:na]\n    at com.facebook.soloader.nativeloader.NativeLoader.loadLibrary(NativeLoader.java:51) ~[nativeloader-0.10.1.jar:na]\n    at com.facebook.soloader.nativeloader.NativeLoader.loadLibrary(NativeLoader.java:30) ~[nativeloader-0.10.1.jar:na]\n    at org.pytorch.NativePeer.&lt;clinit&gt;(NativePeer.java:10) ~[pytorch_java_only-1.13.1.jar:na]\n    at org.pytorch.Module.load(Module.java:28) ~[pytorch_java_only-1.13.1.jar:na]\n    at org.pytorch.Module.load(Module.java:38) ~[pytorch_java_only-1.13.1.jar:na]\n    at com.example.MyShroom_backend.controller.ClassifierController.predict(ClassifierController.java:21) ~[classes/:na]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\n    at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]\n    at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.2.jar:6.0.2]\n    at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.2.jar:6.0.2]\n    at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-6.0.2.jar:6.0.2]\n    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.2.jar:6.0.2]\n    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.2.jar:6.0.2]\n    at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.2.jar:6.0.2]\n    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1080) ~[spring-webmvc-6.0.2.jar:6.0.2]\n    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:973) ~[spring-webmvc-6.0.2.jar:6.0.2]\n    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1003) ~[spring-webmvc-6.0.2.jar:6.0.2]\n    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:906) ~[spring-webmvc-6.0.2.jar:6.0.2]\n    at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:731) ~[tomcat-embed-core-10.1.1.jar:6.0]\n    at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:880) ~[spring-webmvc-6.0.2.jar:6.0.2]\n    at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:814) ~[tomcat-embed-core-10.1.1.jar:6.0]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:223) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at com.example.MyShroom_backend.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:46) ~[classes/:na]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.2.jar:6.0.2]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:219) ~[spring-security-web-6.0.0.jar:6.0.0]\n    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.0.0.jar:6.0.0]\n    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:351) ~[spring-web-6.0.2.jar:6.0.2]\n    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267) ~[spring-web-6.0.2.jar:6.0.2]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.2.jar:6.0.2]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.2.jar:6.0.2]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.2.jar:6.0.2]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.2.jar:6.0.2]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.2.jar:6.0.2]\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.2.jar:6.0.2]\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:119) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:400) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1739) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.1.jar:10.1.1]\n    at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]\n</code></pre>\n<p>and this would technically be caused by the .dll file being 64-bit and the JVM being only 32-bit but that is not the case, it's just the fact that the file is empty. I cannot figure why this is, maybe someone more experienced can help me?</p>\n"},{"tags":["java","java-stream","collectors"],"answers":[{"tags":[],"owner":{"account_id":17520379,"reputation":1536,"user_id":12706564,"display_name":"Emanuel Trandafir"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1681055097,"creation_date":1681044649,"answer_id":75970613,"question_id":75966399,"body_markdown":"there are 2 problems: firstly, these collectors do not have the same return type. Even if you use a *DoubleStream* or a *LongStream* you&#39;ll get closer, but you still won&#39;t have exactly the same return type. Therefore, we&#39;ll need to do a bit of extra work to make them return the same thing. For instance, this can be one option:\r\n\r\n    private double collectValues(AggregatorType agg, List&lt;Long&gt; values) {\r\n        DoubleStream stream = values.stream().mapToDouble(x -&gt; x + 0.0d);\r\n        return switch (agg) {\r\n            case AVG -&gt; stream.average().orElseThrow();\r\n            case SUM -&gt; stream.sum();\r\n            case MAX -&gt; stream.max().orElseThrow();\r\n            case MIN -&gt; stream.min().orElseThrow();\r\n            default -&gt; throw new IllegalArgumentException();\r\n        };\r\n    }\r\n\r\nThe second problem will be that we can not easily use different collectors for the elements of the same stream. Therefore, you need to do it a bit differently - for example, you can do it in 2 steps. Initially, collect all the B.value by the *Aggegator.Type* :\r\n\r\n    public Map&lt;AggregatorType, Double&gt; aggregate(Map&lt;A, B&gt; fields) {\r\n        Map&lt;AggregatorType, List&lt;Long&gt;&gt; valuesByType = fields.entrySet()\r\n            .stream()\r\n            .collect(Collectors.groupingBy(\r\n                entry -&gt; entry.getKey().type(),\r\n                Collectors.mapping(\r\n                    entry -&gt; entry.getValue().value(),\r\n                    Collectors.toList())\r\n            ));\r\n        // return valuesByType.stream()...\r\n    }    \r\n\r\nAnd then, collect each *List&lt;Long&gt;* using the function from the first code snippet:\r\n\r\n     return valuesByType.entrySet()\r\n         .stream()\r\n         .collect(Collectors.toMap(\r\n                entry -&gt; entry.getKey(),\r\n                entry -&gt; collectValues(entry.getKey(), entry.getValue())\r\n         ));\r\n\r\nHere is the full story:\r\n\r\n    @Test\r\n    void test() {\r\n        //given\r\n        Map&lt;A, B&gt; values = Map.of(\r\n            new A(1L, AggregatorType.AVG), new B(10L),\r\n            new A(2L, AggregatorType.AVG), new B(20L),\r\n            new A(3L, AggregatorType.SUM), new B(30L),\r\n            new A(4L, AggregatorType.SUM), new B(40L),\r\n            new A(5L, AggregatorType.MAX), new B(50L),\r\n            new A(6L, AggregatorType.MAX), new B(60L),\r\n            new A(7L, AggregatorType.MIN), new B(70L),\r\n            new A(8L, AggregatorType.MIN), new B(80L)\r\n        );\r\n    \r\n        // when\r\n        Map&lt;AggregatorType, Double&gt; result = aggregate(values);\r\n    \r\n        //then\r\n        assertThat(result).isEqualTo(Map.of(\r\n            AggregatorType.AVG, 15d,\r\n            AggregatorType.SUM, 70d,\r\n            AggregatorType.MAX, 60d,\r\n            AggregatorType.MIN, 70d\r\n        ));\r\n    }\r\n    \r\n    public Map&lt;AggregatorType, Double&gt; aggregate(Map&lt;A, B&gt; fields) {\r\n        Map&lt;AggregatorType, List&lt;Long&gt;&gt; valuesByType = fields.entrySet()\r\n            .stream()\r\n            .collect(Collectors.groupingBy(\r\n                entry -&gt; entry.getKey().type(),\r\n                Collectors.mapping(\r\n                    entry -&gt; entry.getValue().value(),\r\n                    Collectors.toList())\r\n            ));\r\n        return valuesByType.entrySet()\r\n            .stream()\r\n            .collect(Collectors.toMap(\r\n                entry -&gt; entry.getKey(),\r\n                entry -&gt; collectValues(entry.getKey(), entry.getValue())\r\n            ));\r\n    }\r\n    \r\n    private double collectValues(AggregatorType aggregator, List&lt;Long&gt; values) {\r\n        DoubleStream stream = values.stream().mapToDouble(x -&gt; x + 0.0d);\r\n        return switch (aggregator) {\r\n            case AVG -&gt; stream.average().orElseThrow();\r\n            case SUM -&gt; stream.sum();\r\n            case MAX -&gt; stream.max().orElseThrow();\r\n            case MIN -&gt; stream.min().orElseThrow();\r\n            default -&gt; throw new IllegalArgumentException();\r\n        };\r\n    }\r\n\r\nif you want to see how I did it, step-by-step, feel free to read through this article: https://medium.com/javarevisited/polymorphic-stream-collector-in-java-44f9008bf043?sk=b92590ad1c65a3731746404dbd53b0f7\r\n","title":"Apply custom aggregation on Collectors.groupingBy","body":"<p>there are 2 problems: firstly, these collectors do not have the same return type. Even if you use a <em>DoubleStream</em> or a <em>LongStream</em> you'll get closer, but you still won't have exactly the same return type. Therefore, we'll need to do a bit of extra work to make them return the same thing. For instance, this can be one option:</p>\n<pre><code>private double collectValues(AggregatorType agg, List&lt;Long&gt; values) {\n    DoubleStream stream = values.stream().mapToDouble(x -&gt; x + 0.0d);\n    return switch (agg) {\n        case AVG -&gt; stream.average().orElseThrow();\n        case SUM -&gt; stream.sum();\n        case MAX -&gt; stream.max().orElseThrow();\n        case MIN -&gt; stream.min().orElseThrow();\n        default -&gt; throw new IllegalArgumentException();\n    };\n}\n</code></pre>\n<p>The second problem will be that we can not easily use different collectors for the elements of the same stream. Therefore, you need to do it a bit differently - for example, you can do it in 2 steps. Initially, collect all the B.value by the <em>Aggegator.Type</em> :</p>\n<pre><code>public Map&lt;AggregatorType, Double&gt; aggregate(Map&lt;A, B&gt; fields) {\n    Map&lt;AggregatorType, List&lt;Long&gt;&gt; valuesByType = fields.entrySet()\n        .stream()\n        .collect(Collectors.groupingBy(\n            entry -&gt; entry.getKey().type(),\n            Collectors.mapping(\n                entry -&gt; entry.getValue().value(),\n                Collectors.toList())\n        ));\n    // return valuesByType.stream()...\n}    \n</code></pre>\n<p>And then, collect each <em>List</em> using the function from the first code snippet:</p>\n<pre><code> return valuesByType.entrySet()\n     .stream()\n     .collect(Collectors.toMap(\n            entry -&gt; entry.getKey(),\n            entry -&gt; collectValues(entry.getKey(), entry.getValue())\n     ));\n</code></pre>\n<p>Here is the full story:</p>\n<pre><code>@Test\nvoid test() {\n    //given\n    Map&lt;A, B&gt; values = Map.of(\n        new A(1L, AggregatorType.AVG), new B(10L),\n        new A(2L, AggregatorType.AVG), new B(20L),\n        new A(3L, AggregatorType.SUM), new B(30L),\n        new A(4L, AggregatorType.SUM), new B(40L),\n        new A(5L, AggregatorType.MAX), new B(50L),\n        new A(6L, AggregatorType.MAX), new B(60L),\n        new A(7L, AggregatorType.MIN), new B(70L),\n        new A(8L, AggregatorType.MIN), new B(80L)\n    );\n\n    // when\n    Map&lt;AggregatorType, Double&gt; result = aggregate(values);\n\n    //then\n    assertThat(result).isEqualTo(Map.of(\n        AggregatorType.AVG, 15d,\n        AggregatorType.SUM, 70d,\n        AggregatorType.MAX, 60d,\n        AggregatorType.MIN, 70d\n    ));\n}\n\npublic Map&lt;AggregatorType, Double&gt; aggregate(Map&lt;A, B&gt; fields) {\n    Map&lt;AggregatorType, List&lt;Long&gt;&gt; valuesByType = fields.entrySet()\n        .stream()\n        .collect(Collectors.groupingBy(\n            entry -&gt; entry.getKey().type(),\n            Collectors.mapping(\n                entry -&gt; entry.getValue().value(),\n                Collectors.toList())\n        ));\n    return valuesByType.entrySet()\n        .stream()\n        .collect(Collectors.toMap(\n            entry -&gt; entry.getKey(),\n            entry -&gt; collectValues(entry.getKey(), entry.getValue())\n        ));\n}\n\nprivate double collectValues(AggregatorType aggregator, List&lt;Long&gt; values) {\n    DoubleStream stream = values.stream().mapToDouble(x -&gt; x + 0.0d);\n    return switch (aggregator) {\n        case AVG -&gt; stream.average().orElseThrow();\n        case SUM -&gt; stream.sum();\n        case MAX -&gt; stream.max().orElseThrow();\n        case MIN -&gt; stream.min().orElseThrow();\n        default -&gt; throw new IllegalArgumentException();\n    };\n}\n</code></pre>\n<p>if you want to see how I did it, step-by-step, feel free to read through this article: <a href=\"https://medium.com/javarevisited/polymorphic-stream-collector-in-java-44f9008bf043?sk=b92590ad1c65a3731746404dbd53b0f7\" rel=\"nofollow noreferrer\">https://medium.com/javarevisited/polymorphic-stream-collector-in-java-44f9008bf043?sk=b92590ad1c65a3731746404dbd53b0f7</a></p>\n"}],"owner":{"account_id":12824976,"reputation":159,"user_id":9622343,"display_name":"Aravindh Vasu"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":73,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":75970613,"answer_count":1,"score":1,"last_activity_date":1681055097,"creation_date":1680971282,"question_id":75966399,"body_markdown":"I&#39;ve a `Map&lt;A,B&gt; AvsB` where `A` and `B` are,\r\n\r\n    class A {\r\n        Long id;\r\n        AggregationType aggr;\r\n    }\r\n\r\n    class B {\r\n        Long value;\r\n    }\r\n\r\nwhere AggregationType is an enum that contains (`SUM, AVG, MIN, MAX`).\r\n\r\nI created a stream from the entry set and I want to group this list of entries by A.id and apply custom aggregation on B.value from the resulting downstream. \r\n\r\n    Map&lt;Long, Double&gt; aggregatedMap = AvsB.entrySet().stream().groupingBy(\r\n        entry -&gt; entry.getKey().getId(),\r\n        Collectors.summingDouble(entry-&gt; (double)entry.getValue().getValue())\r\n    )\r\n\r\nI&#39;m able to solve this for a single aggregation, like sum in this case, but I don&#39;t know how to solve it with the aggregation being fetched from A (i.e.) I need a switch case for each enum, so for example, for `AVG` I&#39;ll use `Collectors.averagingDouble` instead of `Collectors.summingDouble`.\r\nCan someone please help? Thank you.\r\n","title":"Apply custom aggregation on Collectors.groupingBy","body":"<p>I've a <code>Map&lt;A,B&gt; AvsB</code> where <code>A</code> and <code>B</code> are,</p>\n<pre><code>class A {\n    Long id;\n    AggregationType aggr;\n}\n\nclass B {\n    Long value;\n}\n</code></pre>\n<p>where AggregationType is an enum that contains (<code>SUM, AVG, MIN, MAX</code>).</p>\n<p>I created a stream from the entry set and I want to group this list of entries by A.id and apply custom aggregation on B.value from the resulting downstream.</p>\n<pre><code>Map&lt;Long, Double&gt; aggregatedMap = AvsB.entrySet().stream().groupingBy(\n    entry -&gt; entry.getKey().getId(),\n    Collectors.summingDouble(entry-&gt; (double)entry.getValue().getValue())\n)\n</code></pre>\n<p>I'm able to solve this for a single aggregation, like sum in this case, but I don't know how to solve it with the aggregation being fetched from A (i.e.) I need a switch case for each enum, so for example, for <code>AVG</code> I'll use <code>Collectors.averagingDouble</code> instead of <code>Collectors.summingDouble</code>.\nCan someone please help? Thank you.</p>\n"},{"tags":["java","android","permissions","network-traffic","android-13"],"owner":{"account_id":4927062,"reputation":13,"user_id":3968036,"display_name":"Alireza Amirkhani"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":58,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681055054,"creation_date":1681055054,"question_id":75971453,"body_markdown":"Dear Stack Overflow community,\r\n\r\nI&#39;m having an issue with my Android Java code where I&#39;m unable to get mobile data usage using the following code, but I&#39;m able to get Wi-Fi usage. I&#39;m using API 33, and I have also included the requested permission in my code.\r\n\r\nHere&#39;s the code I&#39;m using:\r\n\r\n        Intent intent = new Intent(Settings.ACTION_USAGE_ACCESS_SETTINGS);\r\n                startActivity(intent);\r\n\r\n```\r\n protected boolean hasUserPermission() {\r\n        try {\r\n            PackageManager packageManager = getContext().getPackageManager();\r\n            ApplicationInfo applicationInfo = packageManager.getApplicationInfo(getContext().getPackageName(), 0);\r\n            AppOpsManager appOpsManager = (AppOpsManager) getContext().getSystemService(Context.APP_OPS_SERVICE);\r\n            int mode = appOpsManager.checkOpNoThrow(AppOpsManager.OPSTR_GET_USAGE_STATS, applicationInfo.uid, applicationInfo.packageName);\r\n            return (mode == AppOpsManager.MODE_ALLOWED);\r\n\r\n        } catch (PackageManager.NameNotFoundException e) {\r\n            return false;\r\n        }\r\n    }\r\n```\r\n\r\n\r\n```\r\nprotected List&lt;InternetUsage&gt; getNetworkUsageByDay() {\r\n        NetworkStatsManager networkStatsManager = (NetworkStatsManager) getContext().getSystemService(Context.NETWORK_STATS_SERVICE);\r\n\r\n        int[] networkTypes = new int[]{NetworkCapabilities.TRANSPORT_WIFI, NetworkCapabilities.TRANSPORT_CELLULAR};\r\n\r\n        List&lt;InternetUsage&gt; networkUsageList = new ArrayList&lt;&gt;();\r\n\r\n        for (int i = -29; i &lt;= 0; i++) {\r\n\r\n            Calendar cal = Calendar.getInstance();\r\n            cal.add(Calendar.DATE, i);\r\n            Date date = cal.getTime();\r\n            String dateString = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;, Locale.getDefault()).format(date);\r\n\r\n\r\n            long wifiRx = 0;\r\n            long wifiTx = 0;\r\n            long mobileRx = 0;\r\n            long mobileTx = 0;\r\n\r\n\r\n            for (int networkType : networkTypes) {\r\n                NetworkStats.Bucket bucket = null;\r\n                try {\r\n                    bucket = networkStatsManager.querySummaryForDevice(networkType, &quot;&quot;, getStartTimeForDay(date), getEndTimeForDay(date));\r\n                } catch (Exception e) {\r\n                    Log.e(TAG, &quot;getNetworkUsageByDay: &quot;, e);\r\n                }\r\n\r\n                if (bucket != null) {\r\n                    if (networkType == NetworkCapabilities.TRANSPORT_WIFI) {\r\n                        wifiRx = bucket.getRxBytes();\r\n                        wifiTx = bucket.getTxBytes();\r\n                    } else if (networkType == NetworkCapabilities.TRANSPORT_CELLULAR) {\r\n                        mobileRx = bucket.getRxBytes();\r\n                        mobileTx = bucket.getTxBytes();\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            InternetUsage networkUsage = new InternetUsage(formatFileSize(wifiRx+wifiTx), formatFileSize(mobileRx+mobileTx),dateString);\r\n\r\n            networkUsageList.add(networkUsage);\r\n        }\r\n        Collections.reverse(networkUsageList);\r\n        return networkUsageList;\r\n    }\r\n\r\n\r\n    private long getStartTimeForDay(Date date) {\r\n        Calendar cal = Calendar.getInstance();\r\n        cal.setTime(date);\r\n        cal.set(Calendar.HOUR_OF_DAY, 0);\r\n        cal.set(Calendar.MINUTE, 0);\r\n        cal.set(Calendar.SECOND, 0);\r\n        return cal.getTimeInMillis();\r\n    }\r\n\r\n    private long getEndTimeForDay(Date date) {\r\n        Calendar cal = Calendar.getInstance();\r\n        cal.setTime(date);\r\n        cal.set(Calendar.HOUR_OF_DAY, 23);\r\n        cal.set(Calendar.MINUTE, 59);\r\n        cal.set(Calendar.SECOND, 59);\r\n        return cal.getTimeInMillis();\r\n    }\r\n```\r\n\r\n\r\n```\r\n  &lt;uses-permission android:name=&quot;android.permission.READ_PHONE_STATE&quot;/&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.PACKAGE_USAGE_STATS&quot;\r\n        tools:ignore=&quot;ProtectedPermissions&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.READ_PRIVILEGED_PHONE_STATE&quot;\r\n        tools:ignore=&quot;ProtectedPermissions&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.USE_FULL_SCREEN_INTENT&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.POST_NOTIFICATIONS&quot;/&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.FOREGROUND_SERVICE&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NOTIFICATION_POLICY&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.ACCESS_WIFI_STATE&quot; /&gt;\r\n    &lt;uses-permission android:name=&quot;android.permission.READ_NETWORK_USAGE_HISTORY&quot;\r\n        tools:ignore=&quot;ProtectedPermissions&quot; /&gt;\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\nI have tried to debug it myself, but I couldn&#39;t find a solution. Can someone please help me understand what I&#39;m doing wrong?\r\n\r\nThank you so much for your time and help in advance.","title":"NetworkStatsManager not returning mobile data usage (API 33)","body":"<p>Dear Stack Overflow community,</p>\n<p>I'm having an issue with my Android Java code where I'm unable to get mobile data usage using the following code, but I'm able to get Wi-Fi usage. I'm using API 33, and I have also included the requested permission in my code.</p>\n<p>Here's the code I'm using:</p>\n<pre><code>    Intent intent = new Intent(Settings.ACTION_USAGE_ACCESS_SETTINGS);\n            startActivity(intent);\n</code></pre>\n<pre><code> protected boolean hasUserPermission() {\n        try {\n            PackageManager packageManager = getContext().getPackageManager();\n            ApplicationInfo applicationInfo = packageManager.getApplicationInfo(getContext().getPackageName(), 0);\n            AppOpsManager appOpsManager = (AppOpsManager) getContext().getSystemService(Context.APP_OPS_SERVICE);\n            int mode = appOpsManager.checkOpNoThrow(AppOpsManager.OPSTR_GET_USAGE_STATS, applicationInfo.uid, applicationInfo.packageName);\n            return (mode == AppOpsManager.MODE_ALLOWED);\n\n        } catch (PackageManager.NameNotFoundException e) {\n            return false;\n        }\n    }\n</code></pre>\n<pre><code>protected List&lt;InternetUsage&gt; getNetworkUsageByDay() {\n        NetworkStatsManager networkStatsManager = (NetworkStatsManager) getContext().getSystemService(Context.NETWORK_STATS_SERVICE);\n\n        int[] networkTypes = new int[]{NetworkCapabilities.TRANSPORT_WIFI, NetworkCapabilities.TRANSPORT_CELLULAR};\n\n        List&lt;InternetUsage&gt; networkUsageList = new ArrayList&lt;&gt;();\n\n        for (int i = -29; i &lt;= 0; i++) {\n\n            Calendar cal = Calendar.getInstance();\n            cal.add(Calendar.DATE, i);\n            Date date = cal.getTime();\n            String dateString = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;, Locale.getDefault()).format(date);\n\n\n            long wifiRx = 0;\n            long wifiTx = 0;\n            long mobileRx = 0;\n            long mobileTx = 0;\n\n\n            for (int networkType : networkTypes) {\n                NetworkStats.Bucket bucket = null;\n                try {\n                    bucket = networkStatsManager.querySummaryForDevice(networkType, &quot;&quot;, getStartTimeForDay(date), getEndTimeForDay(date));\n                } catch (Exception e) {\n                    Log.e(TAG, &quot;getNetworkUsageByDay: &quot;, e);\n                }\n\n                if (bucket != null) {\n                    if (networkType == NetworkCapabilities.TRANSPORT_WIFI) {\n                        wifiRx = bucket.getRxBytes();\n                        wifiTx = bucket.getTxBytes();\n                    } else if (networkType == NetworkCapabilities.TRANSPORT_CELLULAR) {\n                        mobileRx = bucket.getRxBytes();\n                        mobileTx = bucket.getTxBytes();\n                    }\n                }\n            }\n\n\n            InternetUsage networkUsage = new InternetUsage(formatFileSize(wifiRx+wifiTx), formatFileSize(mobileRx+mobileTx),dateString);\n\n            networkUsageList.add(networkUsage);\n        }\n        Collections.reverse(networkUsageList);\n        return networkUsageList;\n    }\n\n\n    private long getStartTimeForDay(Date date) {\n        Calendar cal = Calendar.getInstance();\n        cal.setTime(date);\n        cal.set(Calendar.HOUR_OF_DAY, 0);\n        cal.set(Calendar.MINUTE, 0);\n        cal.set(Calendar.SECOND, 0);\n        return cal.getTimeInMillis();\n    }\n\n    private long getEndTimeForDay(Date date) {\n        Calendar cal = Calendar.getInstance();\n        cal.setTime(date);\n        cal.set(Calendar.HOUR_OF_DAY, 23);\n        cal.set(Calendar.MINUTE, 59);\n        cal.set(Calendar.SECOND, 59);\n        return cal.getTimeInMillis();\n    }\n</code></pre>\n<pre><code>  &lt;uses-permission android:name=&quot;android.permission.READ_PHONE_STATE&quot;/&gt;\n    &lt;uses-permission android:name=&quot;android.permission.PACKAGE_USAGE_STATS&quot;\n        tools:ignore=&quot;ProtectedPermissions&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.READ_PRIVILEGED_PHONE_STATE&quot;\n        tools:ignore=&quot;ProtectedPermissions&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.USE_FULL_SCREEN_INTENT&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.POST_NOTIFICATIONS&quot;/&gt;\n    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.FOREGROUND_SERVICE&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NOTIFICATION_POLICY&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.ACCESS_WIFI_STATE&quot; /&gt;\n    &lt;uses-permission android:name=&quot;android.permission.READ_NETWORK_USAGE_HISTORY&quot;\n        tools:ignore=&quot;ProtectedPermissions&quot; /&gt;\n</code></pre>\n<p>I have tried to debug it myself, but I couldn't find a solution. Can someone please help me understand what I'm doing wrong?</p>\n<p>Thank you so much for your time and help in advance.</p>\n"},{"tags":["java","project-reactor","reactive"],"answers":[{"tags":[],"owner":{"account_id":10877520,"reputation":120,"user_id":7997517,"display_name":"ABHISHEK KUMAR"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1681053972,"creation_date":1681053972,"answer_id":75971362,"question_id":75963361,"body_markdown":"I guess that is not possible. Please note that any error in a reactive stream is considered a terminal event. So, when your flux returned a first error, it terminates without actually proceeding any further. **DelayError** will only wait for other publishers to terminate (with success or error).\r\n\r\nAlso, note that if multiple publishers throw their individual exception, the reactor would throw special **CompositeException** which wraps the exceptions thrown by the individual publisher.","title":"Flux.mergeDelayError get all errors","body":"<p>I guess that is not possible. Please note that any error in a reactive stream is considered a terminal event. So, when your flux returned a first error, it terminates without actually proceeding any further. <strong>DelayError</strong> will only wait for other publishers to terminate (with success or error).</p>\n<p>Also, note that if multiple publishers throw their individual exception, the reactor would throw special <strong>CompositeException</strong> which wraps the exceptions thrown by the individual publisher.</p>\n"}],"owner":{"account_id":2497389,"reputation":70,"user_id":2173468,"display_name":"Timothy"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":220,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":75971362,"answer_count":1,"score":2,"last_activity_date":1681053972,"creation_date":1680929367,"question_id":75963361,"body_markdown":"\r\nWhen using mergeDelayError of Reactor, if more than 1 error is being emitted, is there a way to get all of them instead of just the first error?\r\n\r\n\r\n```\r\nFlux.mergeDelayError(10,\r\n                     Flux.fromStream(Stream.of(1, 2, 3))\r\n                         .flatMap(i -&gt; Mono.error(new Exception(i.toString()))),\r\n                     Mono.just(1),\r\n                     Mono.just(2))\r\n    .doOnError(error -&gt; log.error(&quot;error, {}&quot;, error.getMessage()))\r\n    .collectList()\r\n    .flatMap(Mono::just) .block();\r\n```\r\nIn the example above, it only prints `error 1` and exits without printing `error 2`, `error 3`","title":"Flux.mergeDelayError get all errors","body":"<p>When using mergeDelayError of Reactor, if more than 1 error is being emitted, is there a way to get all of them instead of just the first error?</p>\n<pre><code>Flux.mergeDelayError(10,\n                     Flux.fromStream(Stream.of(1, 2, 3))\n                         .flatMap(i -&gt; Mono.error(new Exception(i.toString()))),\n                     Mono.just(1),\n                     Mono.just(2))\n    .doOnError(error -&gt; log.error(&quot;error, {}&quot;, error.getMessage()))\n    .collectList()\n    .flatMap(Mono::just) .block();\n</code></pre>\n<p>In the example above, it only prints <code>error 1</code> and exits without printing <code>error 2</code>, <code>error 3</code></p>\n"},{"tags":["java","android","image","android-fragments","gridview"],"owner":{"account_id":28256757,"reputation":11,"user_id":21602108,"display_name":"Yoav Hofstein"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":15,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681053857,"creation_date":1681049376,"question_id":75971018,"body_markdown":"I&#39;m trying to update a grid view using a custom adapter inside a fragment, but it just doesn&#39;t work. The idea is that upon clicking a button, a picture of a tree should be put inside the gridview\r\n\r\n```\r\nprivate void addPicture(View view){\r\n       gridView=view.findViewById(R.id.imageSlot);\r\n       galleryArrayList.add(new PictureClass(R.drawable.tree));\r\n       adaptor=new ImageAdaptor(requireContext(),galleryArrayList);\r\n       gridView.setAdapter(adaptor);\r\n\r\n   }\r\n```\r\nthis is the function that adds the picture to the gridview\r\n\r\n\r\n                   public View getView(int position, @Nullable View convertView, @NonNull ViewGroup parent) {\r\n\r\n                       View listItemView = convertView;\r\n                       if (listItemView == null) {\r\n                           // Layout Inflater inflates each item to be displayed in GridView.\r\n                           listItemView = LayoutInflater.from(getContext()).inflate(R.layout.item, parent, false);\r\n                       }\r\n\r\n                       PictureClass pictureClass = getItem(position);\r\n\r\n                       ImageView courseIV = listItemView.findViewById(R.id.imageSlot);\r\n\r\n\r\n                       courseIV.setImageResource(pictureClass.getImageID());\r\n                       return listItemView;\r\n                   }\r\n               }\r\n\r\n\r\n this is the adapter code\r\n\r\nI was expecting it to just insert the tree photo in to the grid upon clicking a button, but instead it is collapsed. Is there a way to make it work, ideally without having to remake the adaptor?","title":"how to update a gridview with photos inside a fragment","body":"<p>I'm trying to update a grid view using a custom adapter inside a fragment, but it just doesn't work. The idea is that upon clicking a button, a picture of a tree should be put inside the gridview</p>\n<pre><code>private void addPicture(View view){\n       gridView=view.findViewById(R.id.imageSlot);\n       galleryArrayList.add(new PictureClass(R.drawable.tree));\n       adaptor=new ImageAdaptor(requireContext(),galleryArrayList);\n       gridView.setAdapter(adaptor);\n\n   }\n</code></pre>\n<p>this is the function that adds the picture to the gridview</p>\n<pre><code>               public View getView(int position, @Nullable View convertView, @NonNull ViewGroup parent) {\n\n                   View listItemView = convertView;\n                   if (listItemView == null) {\n                       // Layout Inflater inflates each item to be displayed in GridView.\n                       listItemView = LayoutInflater.from(getContext()).inflate(R.layout.item, parent, false);\n                   }\n\n                   PictureClass pictureClass = getItem(position);\n\n                   ImageView courseIV = listItemView.findViewById(R.id.imageSlot);\n\n\n                   courseIV.setImageResource(pictureClass.getImageID());\n                   return listItemView;\n               }\n           }\n</code></pre>\n<p>this is the adapter code</p>\n<p>I was expecting it to just insert the tree photo in to the grid upon clicking a button, but instead it is collapsed. Is there a way to make it work, ideally without having to remake the adaptor?</p>\n"},{"tags":["java","swing","layout","jbutton"],"comments":[{"owner":{"account_id":44852,"reputation":322224,"user_id":131872,"accept_rate":100,"display_name":"camickr"},"score":2,"creation_date":1681048127,"post_id":75970807,"comment_id":133993071,"body_markdown":"*I also tried putting revalidate()* - validate() or revalidate() are not needed. Those methods are only used if you add components to a visible frame. *...but it covers the whole window...* - because the panel uses a BorderLayout. The default constraint is the CENTER which will resize the button to fill the entire space. The default layout manager of a panel is a FlowLayout. Leave it like that. Note a layout manger should be set BEFORE you add components to the panel. Setting the size/location should NOT be used. It is the job of the layout manager to set these properties.","body":"<i>I also tried putting revalidate()</i> - validate() or revalidate() are not needed. Those methods are only used if you add components to a visible frame. <i>...but it covers the whole window...</i> - because the panel uses a BorderLayout. The default constraint is the CENTER which will resize the button to fill the entire space. The default layout manager of a panel is a FlowLayout. Leave it like that. Note a layout manger should be set BEFORE you add components to the panel. Setting the size/location should NOT be used. It is the job of the layout manager to set these properties."},{"owner":{"account_id":44852,"reputation":322224,"user_id":131872,"accept_rate":100,"display_name":"camickr"},"score":0,"creation_date":1681048168,"post_id":75970807,"comment_id":133993078,"body_markdown":"Read the section from the Swing tutorial on [Layout Manager](https://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html) to better understand how to use layout managers.","body":"Read the section from the Swing tutorial on <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html\" rel=\"nofollow noreferrer\">Layout Manager</a> to better understand how to use layout managers."},{"owner":{"account_id":44852,"reputation":322224,"user_id":131872,"accept_rate":100,"display_name":"camickr"},"score":0,"creation_date":1681048555,"post_id":75970807,"comment_id":133993131,"body_markdown":"Also, maybe your Thread needs to &quot;sleep&quot; for a period of time to allow the frame to repaint itself.","body":"Also, maybe your Thread needs to &quot;sleep&quot; for a period of time to allow the frame to repaint itself."},{"owner":{"account_id":70123,"reputation":51175,"user_id":203657,"accept_rate":53,"display_name":"kleopatra"},"score":2,"creation_date":1681050693,"post_id":75970807,"comment_id":133993426,"body_markdown":"in addition to the comments by @camickr - you __must not__ dispose the graphics that&#39;s passed into paintComponent, see https://stackoverflow.com/questions/13911743/why-does-calling-dispose-on-graphics-object-cause-jpanel-to-not-render-any-com","body":"in addition to the comments by @camickr - you <b>must not</b> dispose the graphics that&#39;s passed into paintComponent, see <a href=\"https://stackoverflow.com/questions/13911743/why-does-calling-dispose-on-graphics-object-cause-jpanel-to-not-render-any-com\" title=\"why does calling dispose on graphics object cause jpanel to not render any com\">stackoverflow.com/questions/13911743/&hellip;</a>"},{"owner":{"account_id":20552806,"reputation":1,"user_id":15085130,"display_name":"V07R0N"},"score":0,"creation_date":1681052679,"post_id":75970807,"comment_id":133993708,"body_markdown":"Ok it was the dispose that caused the error, thanks @kleopatra","body":"Ok it was the dispose that caused the error, thanks @kleopatra"}],"answers":[{"tags":[],"owner":{"account_id":20552806,"reputation":1,"user_id":15085130,"display_name":"V07R0N"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681053086,"creation_date":1681053086,"answer_id":75971288,"question_id":75970807,"body_markdown":"The problems were caused by calling g2d.dispose() in the PaintComponent() method of the Scene class. This mistake was found by kleopatra in the comments.","title":"JButton only appears after hovered over, while using CardLayout for handeling scenes","body":"<p>The problems were caused by calling g2d.dispose() in the PaintComponent() method of the Scene class. This mistake was found by kleopatra in the comments.</p>\n"}],"owner":{"account_id":20552806,"reputation":1,"user_id":15085130,"display_name":"V07R0N"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":30,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1681077528,"answer_count":1,"score":0,"last_activity_date":1681053086,"creation_date":1681046860,"question_id":75970807,"body_markdown":"I am trying to create a simple game in Java, but I got stuck on creating a system for handeling the different scenes and the trasitioning between them.\r\n\r\nThese are my classes:\r\n\r\nThe scene manager that controls what scene is currently shown by using the cardLayout.\r\n\r\n```\r\nimport javax.swing.*;\r\nimport java.awt.*;\r\n\r\npublic class SceneManager extends JFrame{\r\n    private static SceneManager single_instance = null;\r\n\r\n    public final CardLayout cardLayout;\r\n    private final Scene mainMenuScene;\r\n    private final Scene gameScene;\r\n\r\n    private SceneManager() {\r\n        super(&quot;My Game&quot;);\r\n        setSize(new Dimension(1000,350));\r\n        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\r\n\r\n        cardLayout = new CardLayout();\r\n        this.setLayout(cardLayout);\r\n\r\n        mainMenuScene = new MainMenuScene(this);\r\n        mainMenuScene.setName(&quot;mainMenuScene&quot;);\r\n        this.add(mainMenuScene, &quot;mainMenuScene&quot;);\r\n\r\n        gameScene = new GameScene(this);\r\n        gameScene.setName(&quot;gameScene&quot;);\r\n        this.add(gameScene, &quot;gameScene&quot;);\r\n\r\n        setVisible(true);\r\n    }\r\n\r\n    public static synchronized SceneManager getInstance()\r\n    {\r\n        if (single_instance == null)\r\n            single_instance = new SceneManager();\r\n\r\n        return single_instance;\r\n    }\r\n\r\n    public void switchToMainMenu() {\r\n        cardLayout.show(getContentPane(), &quot;mainMenuScene&quot;);\r\n    }\r\n\r\n    public void switchToGame() {\r\n        cardLayout.show(getContentPane(), &quot;gameScene&quot;);\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        SceneManager sc = SceneManager.getInstance();\r\n    }\r\n}\r\n```\r\n\r\nThe Scene parent class serving as a template for all the scenes. It uses a thread game loop system, because i want to have animations even the seemingly static scenes, such as the main menu. However, i dont know if im doing this the right way as it is my first time working with threads and with java in general.\r\n\r\n```\r\nimport javax.swing.*;\r\nimport java.awt.*;\r\nimport java.awt.event.ComponentAdapter;\r\nimport java.awt.event.ComponentEvent;\r\n\r\npublic abstract class Scene extends JPanel implements Runnable{\r\n    private boolean isPaused = true;\r\n    private int FPS;\r\n    protected SceneManager sceneManager;\r\n\r\n    private Thread thread;\r\n\r\n    public Scene(SceneManager sceneManager){\r\n        this.FPS = 30;\r\n\r\n        this.sceneManager = sceneManager;\r\n\r\n        this.setPreferredSize(new Dimension(1000, 350));\r\n        this.setBackground(Color.black);\r\n        this.setDoubleBuffered(true);\r\n        this.setFocusable(true);\r\n        this.setVisible(true);\r\n        addComponentListener(new ComponentAdapter() {\r\n            @Override\r\n            public void componentHidden(ComponentEvent evt) {\r\n                pause();\r\n            }\r\n            @Override\r\n            public void componentShown(ComponentEvent evt) {\r\n                resume();\r\n            }\r\n        });\r\n\r\n        startThread();\r\n    }\r\n\r\n    public void startThread(){\r\n        this.thread = new Thread(this);\r\n        this.thread.start();\r\n    }\r\n\r\n    public void pause() {\r\n        this.isPaused = true;\r\n    }\r\n\r\n    public void resume() {\r\n        this.isPaused = false;\r\n    }\r\n\r\n    public boolean isPaused(){\r\n        return isPaused;\r\n    }\r\n\r\n    @Override\r\n    public void run() {\r\n        double drawInterval = 1_000_000_000. / FPS;\r\n        double delta = 0;\r\n        long lastTime = System.nanoTime();\r\n        long currentTime;\r\n        long timer = 0;\r\n\r\n        while (thread != null){\r\n            currentTime = System.nanoTime();\r\n            delta += (currentTime - lastTime) / drawInterval;\r\n            timer += (currentTime - lastTime);\r\n            lastTime = currentTime;\r\n\r\n            if (delta &gt;= 1) {\r\n                // Only update and repaint if the game is not paused\r\n                if(!isPaused) {\r\n                    repaint();\r\n                    update();\r\n                }\r\n                delta --;\r\n            }\r\n            if(timer &gt;= 1_000_000_000){\r\n                timer = 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    public abstract void update();\r\n\r\n    public abstract void draw(Graphics2D g2d);\r\n\r\n    @Override\r\n    public void paintComponent(Graphics g){\r\n        super.paintComponent(g);\r\n        Graphics2D g2d = (Graphics2D) g;\r\n        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);\r\n        g2d.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);\r\n\r\n        draw(g2d);\r\n\r\n        g2d.dispose();\r\n    }\r\n}\r\n```\r\n\r\nAnd then there are the two scenes:\r\n\r\nMain menu:\r\n\r\n```\r\nimport javax.swing.*;\r\nimport java.awt.*;\r\nimport java.awt.event.ActionEvent;\r\n\r\npublic class MainMenuScene extends Scene {\r\n    private JButton button;\r\n\r\n    public MainMenuScene(SceneManager sceneManager) {\r\n        super(sceneManager);\r\n        button = new JButton(&quot;Click Me&quot;);\r\n        button.addActionListener(this::onButtonClick);\r\n        button.setLocation(100,100);\r\n        button.setSize(200,100);\r\n        this.add(button, &quot;button1&quot;);\r\n        this.validate();\r\n        this.setLayout(new BorderLayout());\r\n    }\r\n\r\n    public void update() {}\r\n\r\n    public void draw(Graphics2D g2d) {}\r\n\r\n    private void onButtonClick(ActionEvent event) {\r\n        sceneManager.switchToGame();\r\n    }\r\n}\r\n```\r\n\r\nAnd the game scene:\r\n\r\n```\r\nimport javax.swing.*;\r\nimport java.awt.*;\r\nimport java.awt.event.ActionEvent;\r\n\r\npublic class GameScene extends Scene {\r\n\r\n    private int x;\r\n\r\n    JButton button;\r\n\r\n    public GameScene(SceneManager sceneManager) {\r\n        super(sceneManager);\r\n        button = new JButton(&quot;Click Me&quot;);\r\n        button.addActionListener(this::onButtonClick);\r\n        button.setLocation(100,100);\r\n        button.setSize(200,100);\r\n        this.add(button, &quot;button1&quot;);\r\n        this.validate();\r\n        this.setLayout(new BorderLayout());\r\n    }\r\n\r\n    public void update(){\r\n        x += 2;\r\n    }\r\n\r\n    public void draw(Graphics2D g2d) {\r\n        g2d.fillRect(x,50,200,200);\r\n    }\r\n\r\n\r\n    private void onButtonClick(ActionEvent event) {\r\n        sceneManager.switchToMainMenu();\r\n    }\r\n}\r\n```\r\n\r\nThe problem i&#39;m experiencing is that when i launch the program, the button is invisible until i hover over it. Then, if i call resume(), the button flickers when hovered over (it becomes visible the moment i touch it and then the next &#39;frame&#39; it becomes invisible again until i move my mouse again). I have no idea what is causing this behavior, so any help would be much appreciated.\r\n\r\nP.S.: One thing i discovered is that when i set the layout of the mainMenu to the cardLayout of the SceneManager (I call this.setLayout(sceneManager.cardLayout); in the MainMenu constructor), the button shows straight up form the beggining, but it covers the whole window, instead of being of the specified size.\r\n\r\nP.P.S: I also tried putting revalidate() in all sorts of places in the code (the update() method, the menu constructor, both...), but with no success. It might be because im not really sure what it does, so i might have benn using it incorrectly the whole time.","title":"JButton only appears after hovered over, while using CardLayout for handeling scenes","body":"<p>I am trying to create a simple game in Java, but I got stuck on creating a system for handeling the different scenes and the trasitioning between them.</p>\n<p>These are my classes:</p>\n<p>The scene manager that controls what scene is currently shown by using the cardLayout.</p>\n<pre><code>import javax.swing.*;\nimport java.awt.*;\n\npublic class SceneManager extends JFrame{\n    private static SceneManager single_instance = null;\n\n    public final CardLayout cardLayout;\n    private final Scene mainMenuScene;\n    private final Scene gameScene;\n\n    private SceneManager() {\n        super(&quot;My Game&quot;);\n        setSize(new Dimension(1000,350));\n        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n\n        cardLayout = new CardLayout();\n        this.setLayout(cardLayout);\n\n        mainMenuScene = new MainMenuScene(this);\n        mainMenuScene.setName(&quot;mainMenuScene&quot;);\n        this.add(mainMenuScene, &quot;mainMenuScene&quot;);\n\n        gameScene = new GameScene(this);\n        gameScene.setName(&quot;gameScene&quot;);\n        this.add(gameScene, &quot;gameScene&quot;);\n\n        setVisible(true);\n    }\n\n    public static synchronized SceneManager getInstance()\n    {\n        if (single_instance == null)\n            single_instance = new SceneManager();\n\n        return single_instance;\n    }\n\n    public void switchToMainMenu() {\n        cardLayout.show(getContentPane(), &quot;mainMenuScene&quot;);\n    }\n\n    public void switchToGame() {\n        cardLayout.show(getContentPane(), &quot;gameScene&quot;);\n    }\n\n    public static void main(String[] args) {\n        SceneManager sc = SceneManager.getInstance();\n    }\n}\n</code></pre>\n<p>The Scene parent class serving as a template for all the scenes. It uses a thread game loop system, because i want to have animations even the seemingly static scenes, such as the main menu. However, i dont know if im doing this the right way as it is my first time working with threads and with java in general.</p>\n<pre><code>import javax.swing.*;\nimport java.awt.*;\nimport java.awt.event.ComponentAdapter;\nimport java.awt.event.ComponentEvent;\n\npublic abstract class Scene extends JPanel implements Runnable{\n    private boolean isPaused = true;\n    private int FPS;\n    protected SceneManager sceneManager;\n\n    private Thread thread;\n\n    public Scene(SceneManager sceneManager){\n        this.FPS = 30;\n\n        this.sceneManager = sceneManager;\n\n        this.setPreferredSize(new Dimension(1000, 350));\n        this.setBackground(Color.black);\n        this.setDoubleBuffered(true);\n        this.setFocusable(true);\n        this.setVisible(true);\n        addComponentListener(new ComponentAdapter() {\n            @Override\n            public void componentHidden(ComponentEvent evt) {\n                pause();\n            }\n            @Override\n            public void componentShown(ComponentEvent evt) {\n                resume();\n            }\n        });\n\n        startThread();\n    }\n\n    public void startThread(){\n        this.thread = new Thread(this);\n        this.thread.start();\n    }\n\n    public void pause() {\n        this.isPaused = true;\n    }\n\n    public void resume() {\n        this.isPaused = false;\n    }\n\n    public boolean isPaused(){\n        return isPaused;\n    }\n\n    @Override\n    public void run() {\n        double drawInterval = 1_000_000_000. / FPS;\n        double delta = 0;\n        long lastTime = System.nanoTime();\n        long currentTime;\n        long timer = 0;\n\n        while (thread != null){\n            currentTime = System.nanoTime();\n            delta += (currentTime - lastTime) / drawInterval;\n            timer += (currentTime - lastTime);\n            lastTime = currentTime;\n\n            if (delta &gt;= 1) {\n                // Only update and repaint if the game is not paused\n                if(!isPaused) {\n                    repaint();\n                    update();\n                }\n                delta --;\n            }\n            if(timer &gt;= 1_000_000_000){\n                timer = 0;\n            }\n        }\n    }\n\n    public abstract void update();\n\n    public abstract void draw(Graphics2D g2d);\n\n    @Override\n    public void paintComponent(Graphics g){\n        super.paintComponent(g);\n        Graphics2D g2d = (Graphics2D) g;\n        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);\n        g2d.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);\n\n        draw(g2d);\n\n        g2d.dispose();\n    }\n}\n</code></pre>\n<p>And then there are the two scenes:</p>\n<p>Main menu:</p>\n<pre><code>import javax.swing.*;\nimport java.awt.*;\nimport java.awt.event.ActionEvent;\n\npublic class MainMenuScene extends Scene {\n    private JButton button;\n\n    public MainMenuScene(SceneManager sceneManager) {\n        super(sceneManager);\n        button = new JButton(&quot;Click Me&quot;);\n        button.addActionListener(this::onButtonClick);\n        button.setLocation(100,100);\n        button.setSize(200,100);\n        this.add(button, &quot;button1&quot;);\n        this.validate();\n        this.setLayout(new BorderLayout());\n    }\n\n    public void update() {}\n\n    public void draw(Graphics2D g2d) {}\n\n    private void onButtonClick(ActionEvent event) {\n        sceneManager.switchToGame();\n    }\n}\n</code></pre>\n<p>And the game scene:</p>\n<pre><code>import javax.swing.*;\nimport java.awt.*;\nimport java.awt.event.ActionEvent;\n\npublic class GameScene extends Scene {\n\n    private int x;\n\n    JButton button;\n\n    public GameScene(SceneManager sceneManager) {\n        super(sceneManager);\n        button = new JButton(&quot;Click Me&quot;);\n        button.addActionListener(this::onButtonClick);\n        button.setLocation(100,100);\n        button.setSize(200,100);\n        this.add(button, &quot;button1&quot;);\n        this.validate();\n        this.setLayout(new BorderLayout());\n    }\n\n    public void update(){\n        x += 2;\n    }\n\n    public void draw(Graphics2D g2d) {\n        g2d.fillRect(x,50,200,200);\n    }\n\n\n    private void onButtonClick(ActionEvent event) {\n        sceneManager.switchToMainMenu();\n    }\n}\n</code></pre>\n<p>The problem i'm experiencing is that when i launch the program, the button is invisible until i hover over it. Then, if i call resume(), the button flickers when hovered over (it becomes visible the moment i touch it and then the next 'frame' it becomes invisible again until i move my mouse again). I have no idea what is causing this behavior, so any help would be much appreciated.</p>\n<p>P.S.: One thing i discovered is that when i set the layout of the mainMenu to the cardLayout of the SceneManager (I call this.setLayout(sceneManager.cardLayout); in the MainMenu constructor), the button shows straight up form the beggining, but it covers the whole window, instead of being of the specified size.</p>\n<p>P.P.S: I also tried putting revalidate() in all sorts of places in the code (the update() method, the menu constructor, both...), but with no success. It might be because im not really sure what it does, so i might have benn using it incorrectly the whole time.</p>\n"},{"tags":["java","sql-server","micronaut","jdbi"],"comments":[{"owner":{"account_id":166167,"reputation":8075,"user_id":390122,"accept_rate":75,"display_name":"AlwaysLearning"},"score":1,"creation_date":1679477334,"post_id":75809883,"comment_id":133727506,"body_markdown":"The output from print statements are effectively warnings with a 0 severity. Given JDBI layers on top of JDBC, have you tried to walk through the classes to [PreparedStatement.getWarnings()](https://docs.oracle.com/javase/8/docs/api/java/sql/Statement.html#getWarnings--)?","body":"The output from print statements are effectively warnings with a 0 severity. Given JDBI layers on top of JDBC, have you tried to walk through the classes to <a href=\"https://docs.oracle.com/javase/8/docs/api/java/sql/Statement.html#getWarnings--\" rel=\"nofollow noreferrer\">PreparedStatement.getWarnings()</a>?"},{"owner":{"account_id":17972905,"reputation":5290,"user_id":13061224,"display_name":"siggemannen"},"score":1,"creation_date":1679477599,"post_id":75809883,"comment_id":133727562,"body_markdown":"It&#39;s kinda of a mess, cause warning could also be bound to ResultSets.","body":"It&#39;s kinda of a mess, cause warning could also be bound to ResultSets."},{"owner":{"account_id":274409,"reputation":455,"user_id":566629,"accept_rate":100,"display_name":"maborg"},"score":0,"creation_date":1679491578,"post_id":75809883,"comment_id":133731221,"body_markdown":"The trick can be done by using .setSqlLogger(new SqlLogger() { and implementing the logAfterExecution method and using getWarnings on  the statement) \n\nNow the problem is I get the some messages but not all of them, I suppose what @siggemannen was lamenting.  When I have a better solution I will try to post an answer","body":"The trick can be done by using .setSqlLogger(new SqlLogger() { and implementing the logAfterExecution method and using getWarnings on  the statement)   Now the problem is I get the some messages but not all of them, I suppose what @siggemannen was lamenting.  When I have a better solution I will try to post an answer"},{"owner":{"account_id":17972905,"reputation":5290,"user_id":13061224,"display_name":"siggemannen"},"score":1,"creation_date":1679492237,"post_id":75809883,"comment_id":133731400,"body_markdown":"@maborg, yeah, the exact correct order of fetching warnings vs getUpdateCount vs hasNextResult is a black box (actually, i suspect that m$ jdbc driver doesn&#39;t handle it correctly either, because i have never been able to re-implement ssms warning order exactly in java)","body":"@maborg, yeah, the exact correct order of fetching warnings vs getUpdateCount vs hasNextResult is a black box (actually, i suspect that m$ jdbc driver doesn&#39;t handle it correctly either, because i have never been able to re-implement ssms warning order exactly in java)"},{"owner":{"account_id":17972905,"reputation":5290,"user_id":13061224,"display_name":"siggemannen"},"score":1,"creation_date":1679492315,"post_id":75809883,"comment_id":133731431,"body_markdown":"Also, i think you should execute Statement.clearWarnings after you&#39;re done with them","body":"Also, i think you should execute Statement.clearWarnings after you&#39;re done with them"}],"answers":[{"comments":[{"owner":{"account_id":4571603,"reputation":44060,"user_id":3711162,"display_name":"Dan Guzman"},"score":0,"creation_date":1679914927,"post_id":75832524,"comment_id":133800497,"body_markdown":"I believe you need `getNextWarning` to handle multiple info messasges. See https://stackoverflow.com/questions/1759801/is-there-a-way-to-display-print-results-with-sql-server-jdbc-driver","body":"I believe you need <code>getNextWarning</code> to handle multiple info messasges. See <a href=\"https://stackoverflow.com/questions/1759801/is-there-a-way-to-display-print-results-with-sql-server-jdbc-driver\" title=\"is there a way to display print results with sql server jdbc driver\">stackoverflow.com/questions/1759801/&hellip;</a>"},{"owner":{"account_id":274409,"reputation":455,"user_id":566629,"accept_rate":100,"display_name":"maborg"},"score":0,"creation_date":1680077577,"post_id":75832524,"comment_id":133834060,"body_markdown":"@DanGuzman my first version was using getNextWarning but I was still getting only one message :/","body":"@DanGuzman my first version was using getNextWarning but I was still getting only one message :/"},{"owner":{"account_id":17972905,"reputation":5290,"user_id":13061224,"display_name":"siggemannen"},"score":0,"creation_date":1680091383,"post_id":75832524,"comment_id":133837563,"body_markdown":"don&#39;t see that you cleared any warnings from statement...","body":"don&#39;t see that you cleared any warnings from statement..."},{"owner":{"account_id":274409,"reputation":455,"user_id":566629,"accept_rate":100,"display_name":"maborg"},"score":0,"creation_date":1680257909,"post_id":75832524,"comment_id":133871419,"body_markdown":"@siggemannen I have added the clear warnings but I still see only the first print.\nprobably I should try to understand how the driver work by looking at the code.... \n\nhttps://github.com/microsoft/mssql-jdbc/blob/17625f26f0fdd3db0d67fbb964563e684d876bb4/src/main/java/com/microsoft/sqlserver/jdbc/SQLServerStatement.java#L1270","body":"@siggemannen I have added the clear warnings but I still see only the first print. probably I should try to understand how the driver work by looking at the code....   <a href=\"https://github.com/microsoft/mssql-jdbc/blob/17625f26f0fdd3db0d67fbb964563e684d876bb4/src/main/java/com/microsoft/sqlserver/jdbc/SQLServerStatement.java#L1270\" rel=\"nofollow noreferrer\">github.com/microsoft/mssql-jdbc/blob/&hellip;</a>"}],"tags":[],"owner":{"account_id":274409,"reputation":455,"user_id":566629,"accept_rate":100,"display_name":"maborg"},"comment_count":4,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1680257652,"creation_date":1679653886,"answer_id":75832524,"question_id":75809883,"body_markdown":"I have found this incomplete solution, overriding JDBI SqlLogger .\r\n \r\nI get only the first &quot;print&quot; and I&#39;m using the ugly *rSql.contains(&quot;CALL &quot;)* to find only stored procedure call.\r\n\r\nProbably I&#39;m not fully understanding the internals workings of the SQL-server driver\r\n```java\r\n@Factory\r\npublic class JdbiFactory {\r\n    @Inject\r\n    DataSource dataSource;\r\n    private static final Logger LOG = LoggerFactory.getLogger(JdbiFactory.class);\r\n\r\n    @Bean\r\n    @Singleton\r\n    public Jdbi jdbi(ResourceResolver resourceResolver) {\r\n        return Jdbi.create(dataSource)\r\n            .installPlugin(new SqlObjectPlugin())\r\n            .setSqlLogger(new SqlLogger() {\r\n            @Override\r\n            public void logAfterExecution(StatementContext context) {\r\n                try {\r\n                    var rSql = context.getRenderedSql();\r\n                    LOG.debug(&quot;RenderedSql: [{}] &quot;, rSql);\r\n                    if (rSql.contains(&quot;CALL &quot;)) {\r\n                        // get warnings\r\n                        final var warningSt = context.getStatement().getWarnings();\r\n                        logThrowables(warningSt);\r\n                        context.getStatement().clearWarnings();\r\n                        // get warnings on results\r\n                        do {\r\n                            ResultSet resultSet = context.getStatement().getResultSet();\r\n                            if (resultSet != null) {\r\n                                final var warningRs = resultSet.getWarnings();\r\n                                logThrowables(warningRs);\r\n                                resultSet.clearWarnings();\r\n                            }\r\n                        } while ( context.getStatement().getMoreResults());\r\n                    }\r\n                } catch (SQLException e) {\r\n                    LOG.error(&quot;Inside logAfterExecution error &quot;, e);\r\n                    e.printStackTrace();\r\n                }\r\n                SqlLogger.super.logAfterExecution(context);\r\n            }\r\n        });\r\n    }\r\n\r\n    private static void logThrowables(SQLException warning) {\r\n        var iterator = warning.iterator();\r\n        do {\r\n            Throwable next = iterator.next();\r\n            LOG.info(&quot;Print: [{}]&quot;, next.getMessage());\r\n        }while(iterator.hasNext());\r\n\r\n    }\r\n}\r\n```","title":"Log &quot;print&quot; inside stored procedure called from JDBI @SqlCall?","body":"<p>I have found this incomplete solution, overriding JDBI SqlLogger .</p>\n<p>I get only the first &quot;print&quot; and I'm using the ugly <em>rSql.contains(&quot;CALL &quot;)</em> to find only stored procedure call.</p>\n<p>Probably I'm not fully understanding the internals workings of the SQL-server driver</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Factory\npublic class JdbiFactory {\n    @Inject\n    DataSource dataSource;\n    private static final Logger LOG = LoggerFactory.getLogger(JdbiFactory.class);\n\n    @Bean\n    @Singleton\n    public Jdbi jdbi(ResourceResolver resourceResolver) {\n        return Jdbi.create(dataSource)\n            .installPlugin(new SqlObjectPlugin())\n            .setSqlLogger(new SqlLogger() {\n            @Override\n            public void logAfterExecution(StatementContext context) {\n                try {\n                    var rSql = context.getRenderedSql();\n                    LOG.debug(&quot;RenderedSql: [{}] &quot;, rSql);\n                    if (rSql.contains(&quot;CALL &quot;)) {\n                        // get warnings\n                        final var warningSt = context.getStatement().getWarnings();\n                        logThrowables(warningSt);\n                        context.getStatement().clearWarnings();\n                        // get warnings on results\n                        do {\n                            ResultSet resultSet = context.getStatement().getResultSet();\n                            if (resultSet != null) {\n                                final var warningRs = resultSet.getWarnings();\n                                logThrowables(warningRs);\n                                resultSet.clearWarnings();\n                            }\n                        } while ( context.getStatement().getMoreResults());\n                    }\n                } catch (SQLException e) {\n                    LOG.error(&quot;Inside logAfterExecution error &quot;, e);\n                    e.printStackTrace();\n                }\n                SqlLogger.super.logAfterExecution(context);\n            }\n        });\n    }\n\n    private static void logThrowables(SQLException warning) {\n        var iterator = warning.iterator();\n        do {\n            Throwable next = iterator.next();\n            LOG.info(&quot;Print: [{}]&quot;, next.getMessage());\n        }while(iterator.hasNext());\n\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":274409,"reputation":455,"user_id":566629,"accept_rate":100,"display_name":"maborg"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":291,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":75832524,"answer_count":1,"score":1,"last_activity_date":1681052501,"creation_date":1679473698,"question_id":75809883,"body_markdown":"I&#39;m using JBDI from a Java Micronaut application to call various stored procedures from a legacy SQL Server database application. I use the `@SqlCall` attribute.\r\n\r\nFor debugging purpose would be really useful to have the &quot;print&quot; statement inside the stored procedure logged to the Java application log.\r\n\r\nDbeaver is doing something similar in his output tab and I know that there is some &quot;warning&quot; procedure at the JBDC driver level but I don&#39;t know to use it with JDBI.","title":"Log &quot;print&quot; inside stored procedure called from JDBI @SqlCall?","body":"<p>I'm using JBDI from a Java Micronaut application to call various stored procedures from a legacy SQL Server database application. I use the <code>@SqlCall</code> attribute.</p>\n<p>For debugging purpose would be really useful to have the &quot;print&quot; statement inside the stored procedure logged to the Java application log.</p>\n<p>Dbeaver is doing something similar in his output tab and I know that there is some &quot;warning&quot; procedure at the JBDC driver level but I don't know to use it with JDBI.</p>\n"},{"tags":["java","git","spring-boot","pcf"],"answers":[{"tags":[],"owner":{"account_id":18463307,"reputation":1,"user_id":13450202,"display_name":"Hakunamatata"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681051824,"creation_date":1680541148,"answer_id":75921968,"question_id":62799154,"body_markdown":"I had a similar issue and found out that the problem was in the `SwaggerConfig` class. Any Configuration class which is currently implementing `WebMvcConfigurer` and removing the `@EnableWebMvc` annotation fixed the problem.\r\n\r\n    @EnableWebMvc // &lt;--- remove\r\n    @EnableSwagger2\r\n    @Configuration\r\n    public class SwaggerConfig implements WebMvcConfigurer {\r\n    //Your configuration code block\r\n    }\r\n\r\nRemoving the above configuration fixed the epoch date format to a timestamps format i.e:\r\n\r\n    &quot;time&quot;:1679082325.495000000    to--&gt;    &quot;time&quot;: &quot;2023-04-03T16:40:22.801Z&quot;\r\n\r\nHope this helps.","title":"Springboot 2.1 Actuator /info shows build and git time as timestamp","body":"<p>I had a similar issue and found out that the problem was in the <code>SwaggerConfig</code> class. Any Configuration class which is currently implementing <code>WebMvcConfigurer</code> and removing the <code>@EnableWebMvc</code> annotation fixed the problem.</p>\n<pre><code>@EnableWebMvc // &lt;--- remove\n@EnableSwagger2\n@Configuration\npublic class SwaggerConfig implements WebMvcConfigurer {\n//Your configuration code block\n}\n</code></pre>\n<p>Removing the above configuration fixed the epoch date format to a timestamps format i.e:</p>\n<pre><code>&quot;time&quot;:1679082325.495000000    to--&gt;    &quot;time&quot;: &quot;2023-04-03T16:40:22.801Z&quot;\n</code></pre>\n<p>Hope this helps.</p>\n"}],"owner":{"account_id":12915666,"reputation":121,"user_id":9340015,"display_name":"Patheek Chokshi"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":782,"favorite_count":0,"down_vote_count":0,"up_vote_count":4,"answer_count":1,"score":4,"last_activity_date":1681051824,"creation_date":1594225138,"question_id":62799154,"body_markdown":"I have included build info and git info file in my jar file. So, calling springboot actuator&#39;s /info returns the build and git info in json. However, the build time and commit time are all represented in epoch timestamp.\r\n\r\n  &quot;build&quot;: \r\n    {\r\n        &quot;version&quot;: &quot;1.1.5&quot;,\r\n        &quot;artifact&quot;: &quot;service-artifact&quot;,\r\n        &quot;name&quot;: &quot;Service name&quot;,\r\n        &quot;group&quot;: &quot;some group&quot;,\r\n        &quot;time&quot;: 1594218235.671000000\r\n    }\r\n\r\n\r\nI tried setting the following but same result.\r\n\r\n    spring.jackson.time-zone=GMT\r\n    spring.jackson.serialization.write-dates-as-timestamps=false\r\n    spring.jackson.date-format=yyyy-MM-dd\r\n\r\nTime when converted from epoch to GMT shows correct time. We use the application to deploy to PCF and when looking from PCF AppManager, settings tab, the time incorrectly converts to \r\nTime:  01/19/70 09:59AM UTC\r\n\r\nIf the time is sent in ISO 8601 format in /info call, all seem to work.\r\nLooking for help and suggestion as to how to configure this correctly to send ISO 8601 formatted date and time from actuator /info call.\r\n\r\nThanks.\r\n","title":"Springboot 2.1 Actuator /info shows build and git time as timestamp","body":"<p>I have included build info and git info file in my jar file. So, calling springboot actuator's /info returns the build and git info in json. However, the build time and commit time are all represented in epoch timestamp.</p>\n<p>&quot;build&quot;:\n{\n&quot;version&quot;: &quot;1.1.5&quot;,\n&quot;artifact&quot;: &quot;service-artifact&quot;,\n&quot;name&quot;: &quot;Service name&quot;,\n&quot;group&quot;: &quot;some group&quot;,\n&quot;time&quot;: 1594218235.671000000\n}</p>\n<p>I tried setting the following but same result.</p>\n<pre><code>spring.jackson.time-zone=GMT\nspring.jackson.serialization.write-dates-as-timestamps=false\nspring.jackson.date-format=yyyy-MM-dd\n</code></pre>\n<p>Time when converted from epoch to GMT shows correct time. We use the application to deploy to PCF and when looking from PCF AppManager, settings tab, the time incorrectly converts to\nTime:  01/19/70 09:59AM UTC</p>\n<p>If the time is sent in ISO 8601 format in /info call, all seem to work.\nLooking for help and suggestion as to how to configure this correctly to send ISO 8601 formatted date and time from actuator /info call.</p>\n<p>Thanks.</p>\n"},{"tags":["java","memory","jvm","virtual-memory","virtual-member-manager"],"comments":[{"owner":{"account_id":28104689,"reputation":512,"user_id":21473475,"display_name":"Arfur Narf"},"score":0,"creation_date":1681052376,"post_id":75971170,"comment_id":133993662,"body_markdown":"&#39;Virtual memory&#39; does not mean &#39;disk&#39;. All programs in Windows execute in &#39;virtual memory&#39;.  Some of that virtual memory is mapped to physical memory; the mapping can change dynamically.","body":"&#39;Virtual memory&#39; does not mean &#39;disk&#39;. All programs in Windows execute in &#39;virtual memory&#39;.  Some of that virtual memory is mapped to physical memory; the mapping can change dynamically."},{"owner":{"account_id":5150443,"reputation":34158,"user_id":4125191,"display_name":"RealSkeptic"},"score":0,"creation_date":1681052388,"post_id":75971170,"comment_id":133993665,"body_markdown":"You should probably read up about virtual memory. Almost nothing allocates directly in physical memory. The requests for allocation go to virtual memory, and a part (or all) of virtual memory is mapped to physical memory at any time.","body":"You should probably read up about virtual memory. Almost nothing allocates directly in physical memory. The requests for allocation go to virtual memory, and a part (or all) of virtual memory is mapped to physical memory at any time."}],"owner":{"account_id":25746919,"reputation":9,"user_id":19499999,"display_name":"xiaoqiang deng"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":159,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681051663,"creation_date":1681051663,"question_id":75971170,"body_markdown":"[![enter image description here](https://i.stack.imgur.com/frUuc.png)](https://i.stack.imgur.com/frUuc.png)\r\nAs shown in the figure, Windows displays that my physical machine has enough memory, including mem reduct showing that physical memory is sufficient. However, the virtual machine&#39;s memory has been consistently high, which caused an error when running the program. The error message is as follows, indicating that the JVM heap memory is insufficient.\r\n\r\n` Unable to allocate 130176KB bitmaps for parallel garbage collection for the requested 4165632KB heap.`\r\n\r\nMy question is, when the physical memory is sufficient, why isn&#39;t the heap memory allocated for the program or the so-called `parallel garbage collection` allocated physical memory? It seems like it is allocating virtual memory.\r\n\r\nThen, in my case, there were indeed a large number of programs running in the background, and the RAM of the entire machine was 16G. When I closed some applications, the virtual memory usage also decreased, and I was able to run the program normally. By the way, I also want to ask, when I have many programs running, are there any methods to reduce the computer&#39;s virtual memory usage?\r\n\r\nI couldn&#39;t find any information saying that JVM heap memory is only allocated in virtual memory. In fact, it definitely occupies physical memory, so I am confused.","title":"Is this due to insufficient virtual memory that the java program cannot run?","body":"<p><a href=\"https://i.stack.imgur.com/frUuc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/frUuc.png\" alt=\"enter image description here\" /></a>\nAs shown in the figure, Windows displays that my physical machine has enough memory, including mem reduct showing that physical memory is sufficient. However, the virtual machine's memory has been consistently high, which caused an error when running the program. The error message is as follows, indicating that the JVM heap memory is insufficient.</p>\n<p><code> Unable to allocate 130176KB bitmaps for parallel garbage collection for the requested 4165632KB heap.</code></p>\n<p>My question is, when the physical memory is sufficient, why isn't the heap memory allocated for the program or the so-called <code>parallel garbage collection</code> allocated physical memory? It seems like it is allocating virtual memory.</p>\n<p>Then, in my case, there were indeed a large number of programs running in the background, and the RAM of the entire machine was 16G. When I closed some applications, the virtual memory usage also decreased, and I was able to run the program normally. By the way, I also want to ask, when I have many programs running, are there any methods to reduce the computer's virtual memory usage?</p>\n<p>I couldn't find any information saying that JVM heap memory is only allocated in virtual memory. In fact, it definitely occupies physical memory, so I am confused.</p>\n"},{"tags":["java","hashmap","file-handling"],"comments":[{"owner":{"display_name":"user20716279"},"score":0,"creation_date":1680699231,"post_id":75939342,"comment_id":133941992,"body_markdown":"this file.createNewFile(); will create new file if each file line contain something like that ganesh kale  then you can use [split(&quot; &quot;)](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html#split(java.lang.String)) and put first element the returned array in the key and the second one into the value","body":"this file.createNewFile(); will create new file if each file line contain something like that ganesh kale  then you can use <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html#split(java.lang.String)\" rel=\"nofollow noreferrer\">split(&quot; &quot;)</a> and put first element the returned array in the key and the second one into the value"}],"answers":[{"tags":[],"owner":{"account_id":27608552,"reputation":1,"user_id":21072165,"display_name":"Ruslan Komissarov"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681051090,"creation_date":1680699007,"answer_id":75939642,"question_id":75939342,"body_markdown":"To split a string you can use the `split()` function.\r\n\r\nTo set the first part of split string as a key and assign the second part of a split string as a value, you can do following:\r\n```\r\nHashMap&lt;String,String&gt; map = new HashMap&lt;String, String&gt;();\r\nString s = &quot;John Doe&quot;;\r\nmap.put(s.split(&quot; &quot;)[0], s.split(&quot; &quot;)[1]);\r\n```\r\n\r\nAlso, as far as I know, you can&#39;t have duplicate keys in a map. When trying to add an entry with duplicate key, the value of an existing entry will be overwritten.","title":"Read Data from txt file and store it in hashmap keys and values","body":"<p>To split a string you can use the <code>split()</code> function.</p>\n<p>To set the first part of split string as a key and assign the second part of a split string as a value, you can do following:</p>\n<pre><code>HashMap&lt;String,String&gt; map = new HashMap&lt;String, String&gt;();\nString s = &quot;John Doe&quot;;\nmap.put(s.split(&quot; &quot;)[0], s.split(&quot; &quot;)[1]);\n</code></pre>\n<p>Also, as far as I know, you can't have duplicate keys in a map. When trying to add an entry with duplicate key, the value of an existing entry will be overwritten.</p>\n"}],"owner":{"account_id":27663288,"reputation":23,"user_id":21115611,"display_name":"Siddhiraj Ranaware"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":35,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1681051090,"creation_date":1680697066,"question_id":75939342,"body_markdown":"I have data which is full name  for eg. ganesh kale , abhi nale , etc.  This Data is in txt file which I have to read the file by file handling and store Data in HashMap in format of key should first name and value should be last name.\r\n\r\nI tried something but  I dont get how to split string (eg. Ganesh kale) how I put &quot;ganesh&quot; in key and put &quot;kale&quot; in values so when I print HashMap I should get First name as a key and last name as a value\r\n\r\n    package javap;\r\n    import java.io.*;\r\n    import java.util.*;\r\n    import java.util.Map.Entry;\r\n    import java.util.Scanner;\r\n    \r\n    public class Datainput {\r\n    \r\n        public static void main(String[] args) throws IOException {\r\n    \r\n            File file = new File(&quot;E:\\\\Data.txt&quot;);\r\n            file.createNewFile();\r\n    \r\n            HashMap &lt; String, String &gt; map = new HashMap &lt; String, String &gt; ();\r\n    \r\n            BufferedReader br = new BufferedReader(new FileReader(file));\r\n            String s;\r\n            while ((s = br.readLine()) != null) {\r\n                String key = s.substring(s.indexOf(&quot; &quot;)).trim();\r\n                String value = s.substring(s.indexOf(&quot; &quot;)).trim();\r\n                map.put(key, value);\r\n                //System.out.println(s);\r\n    \r\n            }\r\n            for (String a: map.KeySet()) {\r\n                System.out.println(a + map.get(a));\r\n            }\r\n        }\r\n    }","title":"Read Data from txt file and store it in hashmap keys and values","body":"<p>I have data which is full name  for eg. ganesh kale , abhi nale , etc.  This Data is in txt file which I have to read the file by file handling and store Data in HashMap in format of key should first name and value should be last name.</p>\n<p>I tried something but  I dont get how to split string (eg. Ganesh kale) how I put &quot;ganesh&quot; in key and put &quot;kale&quot; in values so when I print HashMap I should get First name as a key and last name as a value</p>\n<pre><code>package javap;\nimport java.io.*;\nimport java.util.*;\nimport java.util.Map.Entry;\nimport java.util.Scanner;\n\npublic class Datainput {\n\n    public static void main(String[] args) throws IOException {\n\n        File file = new File(&quot;E:\\\\Data.txt&quot;);\n        file.createNewFile();\n\n        HashMap &lt; String, String &gt; map = new HashMap &lt; String, String &gt; ();\n\n        BufferedReader br = new BufferedReader(new FileReader(file));\n        String s;\n        while ((s = br.readLine()) != null) {\n            String key = s.substring(s.indexOf(&quot; &quot;)).trim();\n            String value = s.substring(s.indexOf(&quot; &quot;)).trim();\n            map.put(key, value);\n            //System.out.println(s);\n\n        }\n        for (String a: map.KeySet()) {\n            System.out.println(a + map.get(a));\n        }\n    }\n}\n</code></pre>\n"},{"tags":["java","spring","spring-boot","hibernate","jpa"],"comments":[{"owner":{"account_id":24109083,"reputation":150,"user_id":18079889,"display_name":"Mohammed Fataka"},"score":0,"creation_date":1681046894,"post_id":75970150,"comment_id":133992920,"body_markdown":"would you please define where specifically you are facing the issue? there are so many relationships defined in your code! perhaps make it shorter and cleaner? or check [how to ask](https://stackoverflow.com/help/how-to-ask) for better improvment","body":"would you please define where specifically you are facing the issue? there are so many relationships defined in your code! perhaps make it shorter and cleaner? or check <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask</a> for better improvment"},{"owner":{"account_id":27060677,"reputation":3,"user_id":20612741,"display_name":"참직김"},"score":0,"creation_date":1681050830,"post_id":75970150,"comment_id":133993444,"body_markdown":"@MohammedFataka I&#39;m sorry. I think you must have been embarrassed by my poor English and questioning skills.I modified the post and added some more code. If you have a chance, please check it out. thank you very much","body":"@MohammedFataka I&#39;m sorry. I think you must have been embarrassed by my poor English and questioning skills.I modified the post and added some more code. If you have a chance, please check it out. thank you very much"}],"owner":{"account_id":27060677,"reputation":3,"user_id":20612741,"display_name":"참직김"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":57,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681050728,"creation_date":1681038546,"question_id":75970150,"body_markdown":"I use Spring Boot, JPA, Spring Data JPA, QueryDSL and I am using Thymeleaf as the template engine. The logic I came up with is, like YouTube comments, when I added BigComments and then I look up PostInfo, I wanted to look up BigComments in the List&lt;BigComments&gt;BigCommentsList field of the BigComments class. However, once I added BigComments, it seems to work properly, but if I added it several times, it is not saved in the List&lt;BigComments&gt;BigCommentsList field of the BigComments class. And curiously, when saving a new PostComments entity, the object that I tried to saved the previously BigComments entity in the first PostComments object, it is being saved in the List&lt;BigComments&gt; bigCommentsList field that second object of PostComments. It&#39;s working really weirdly. I need your help.\r\n\r\n\r\n\r\n\r\n---\r\n**Entity codes**\r\n\r\n**PostInfo**\r\n```\r\npackage My_Project.integration.entity;\r\n\r\nimport My_Project.integration.entity.Dto.PostInfoDto;\r\nimport com.fasterxml.jackson.annotation.JsonIgnore;\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\nimport org.hibernate.annotations.BatchSize;\r\n\r\nimport javax.persistence.*;\r\nimport java.time.LocalDateTime;\r\nimport java.util.HashSet;\r\nimport java.util.Set;\r\n\r\n@Entity\r\n@Getter\r\n@Setter\r\npublic class PostInfo {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = &quot;post_number&quot;)\r\n    private Long postNumber;\r\n\r\n    @ManyToOne(fetch = FetchType.LAZY)\r\n    @JoinColumn(name = &quot;id&quot;)\r\n    private Users postedUser;\r\n\r\n    @Column(name = &quot;post_title&quot;, length = 50, nullable = false)\r\n    public String postTitle;\r\n\r\n    @Column(name = &quot;post_content&quot;, nullable = false)\r\n    public String postContent;\r\n\r\n    @Embedded\r\n    public Dates dates;\r\n\r\n    @OneToMany(\r\n            mappedBy = &quot;postInfo&quot;,\r\n            orphanRemoval = true,\r\n            cascade = CascadeType.ALL\r\n    )\r\n    @BatchSize(size = 100)\r\n    private Set&lt;Photo&gt; photo = new HashSet&lt;&gt;();\r\n\r\n    @OneToMany(\r\n            orphanRemoval = true,\r\n            cascade = CascadeType.ALL,\r\n            mappedBy = &quot;postInfo&quot;\r\n    )\r\n    @BatchSize(size = 1000)\r\n    private Set&lt;PostComments&gt; comments;\r\n\r\n    @OneToOne(fetch = FetchType.LAZY,\r\n            cascade = CascadeType.ALL,\r\n            orphanRemoval = true)\r\n    @JoinColumn\r\n    @JsonIgnore\r\n    private PostLikeAndDislike postLikeAndDislike;\r\n\r\n    public PostInfo(Long postNumber, Users postedUser, String postTitle, String postContent, Dates dates, Set&lt;Photo&gt; photo, Set&lt;PostComments&gt; comments, PostLikeAndDislike postLikeAndDislike) {\r\n        this.postNumber = postNumber;\r\n        this.postedUser = postedUser;\r\n        this.postTitle = postTitle;\r\n        this.postContent = postContent;\r\n        this.dates = dates;\r\n        this.photo = photo;\r\n        this.comments = comments;\r\n        this.postLikeAndDislike = postLikeAndDislike;\r\n    }\r\n\r\n    public PostInfo() {\r\n    }\r\n\r\n    public void addPhoto(Photo photo) {\r\n        this.photo.add(photo);\r\n\r\n        if(photo.getPostInfo() != this)\r\n            photo.setPostInfoByPostInfo(this);\r\n    }\r\n\r\n    public PostInfo(Users users, PostInfoDto postInfo,PostLikeAndDislike postLikeAndDislike) {\r\n        Dates dates = new Dates(\r\n                LocalDateTime.now(),LocalDateTime.now()\r\n        );\r\n        this.postedUser = users;\r\n        this.postTitle = postInfo.getPostTitle();\r\n        this.postContent = postInfo.getPostContent();\r\n        this.dates = dates;\r\n        this.comments = new HashSet&lt;&gt;();\r\n        setPostLikeAndDislike(postLikeAndDislike);\r\n    }\r\n\r\n    public void addComments(PostComments postComments) {\r\n        this.comments.add(postComments);\r\n        postComments.setPostInfo(this);\r\n    }\r\n}\r\n\r\n```\r\n\r\n\r\n**PostComments** \r\n```\r\npackage My_Project.integration.entity;\r\n\r\nimport My_Project.integration.entity.Dto.CommentDto;\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\n\r\nimport javax.persistence.*;\r\nimport java.time.LocalDateTime;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\n@Entity\r\n@Getter\r\n@Setter\r\npublic class PostComments {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = &quot;post_comments_number&quot;)\r\n    private Long commentNumber;\r\n\r\n    @ManyToOne(fetch = FetchType.LAZY)\r\n    @JoinColumn\r\n    private PostInfo postInfo;\r\n\r\n    @Column(name = &quot;post_commented_users_email&quot;)\r\n    private String postCommentedUsersEmail;\r\n\r\n    @Column(name = &quot;post_comments_contents&quot;, nullable = false)\r\n    private String postCommentsContents;\r\n\r\n    @Embedded\r\n    private Dates dates;\r\n\r\n    @OneToMany(\r\n            mappedBy = &quot;bigCommentsNumber&quot;,\r\n            cascade = CascadeType.ALL,\r\n            orphanRemoval = true\r\n    )\r\n    private List&lt;BigComments&gt; bigCommentsList = new ArrayList&lt;&gt;();\r\n\r\n    @OneToOne(\r\n            orphanRemoval = true,\r\n            cascade = CascadeType.ALL,\r\n            fetch = FetchType.LAZY\r\n    )\r\n    @JoinColumn\r\n    private PostLikeAndDislike postLikeAndDislike;\r\n\r\n    public PostComments(CommentDto commentDto,PostInfo postInfo,PostLikeAndDislike postLikeAndDislike) {\r\n        this.postInfo = postInfo;\r\n        this.postCommentedUsersEmail = commentDto.getUsers_email();\r\n        this.postCommentsContents = commentDto.getComment();\r\n        this.postLikeAndDislike = new PostLikeAndDislike();\r\n\r\n        Dates dates1 = new Dates(LocalDateTime.now(),LocalDateTime.now());\r\n        this.dates = dates1;\r\n    }\r\n\r\n    public PostComments(Long commentNumber, PostInfo postInfo, String postCommentedUsersEmail, String postCommentsContents, Dates dates, List&lt;BigComments&gt; bigCommentsList, PostLikeAndDislike postLikeAndDislike) {\r\n        this.commentNumber = commentNumber;\r\n        this.postInfo = postInfo;\r\n        this.postCommentedUsersEmail = postCommentedUsersEmail;\r\n        this.postCommentsContents = postCommentsContents;\r\n        this.dates = dates;\r\n        this.bigCommentsList = new ArrayList&lt;&gt;(bigCommentsList);\r\n        this.postLikeAndDislike = postLikeAndDislike;\r\n    }\r\n\r\n    public PostComments() {\r\n        this.bigCommentsList = new ArrayList&lt;&gt;();\r\n    }\r\n\r\n    public Integer bigCommentSize() {\r\n        return getBigCommentsList().size();\r\n    }\r\n\r\n    public void addBigComments(BigComments bigComments) {\r\n        this.bigCommentsList.add(bigComments);\r\n        bigComments.setPostComments(this);\r\n    }\r\n}\r\n```\r\n\r\n\r\n\r\n\r\n**BigComments**\r\n```\r\npackage My_Project.integration.entity;\r\n\r\nimport lombok.*;\r\n\r\nimport javax.persistence.*;\r\n\r\n@Entity\r\n@Getter\r\n@AllArgsConstructor\r\n@NoArgsConstructor\r\n@Builder\r\n@Setter\r\npublic class BigComments {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = &quot;big_comments_number&quot;)\r\n    private Long bigCommentsNumber;\r\n\r\n    @OneToOne(fetch = FetchType.LAZY)\r\n    @JoinColumn(name = &quot;users&quot;)\r\n    private Users bigCommentedUser;\r\n\r\n    @ManyToOne(fetch = FetchType.LAZY)\r\n    @JoinColumn(name = &quot;post_comments_number&quot;)\r\n    private PostComments postComments;\r\n\r\n    @Column(name = &quot;big_comments_content&quot;,nullable = false)\r\n    private String content;\r\n\r\n    @OneToOne(\r\n            orphanRemoval = true,\r\n            cascade = CascadeType.ALL,\r\n            fetch = FetchType.LAZY\r\n    )\r\n    @JoinColumn(name=&quot;lidi&quot;)\r\n    private PostLikeAndDislike postLikeAndDislike;\r\n\r\n    @Embedded\r\n    private Dates dates;\r\n\r\n    @OneToOne(fetch = FetchType.LAZY)\r\n    @JoinColumn(name=&quot;postInfo&quot;)\r\n    private PostInfo postInfo;\r\n}\r\n```\r\n\r\n**PostLikeAndDislike**\r\n```\r\npackage My_Project.integration.entity;\r\n\r\nimport lombok.*;\r\n\r\nimport javax.persistence.*;\r\nimport java.util.HashSet;\r\nimport java.util.Set;\r\n\r\n@Entity\r\n@Getter\r\n@Setter\r\n@AllArgsConstructor\r\n@NoArgsConstructor\r\n@Builder\r\npublic class PostLikeAndDislike {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n\r\n    @OneToOne(\r\n            fetch = FetchType.LAZY,\r\n            mappedBy = &quot;postLikeAndDislike&quot;)\r\n    PostInfo postInfo;\r\n\r\n    @OneToMany(\r\n            mappedBy = &quot;postLikeAndDislike&quot;,\r\n            cascade = CascadeType.ALL,\r\n            orphanRemoval = true\r\n    )\r\n    private Set&lt;Liked&gt; liked = new HashSet&lt;&gt;();\r\n\r\n    @OneToMany(\r\n            mappedBy = &quot;postLikeAndDislike&quot;,\r\n            cascade = CascadeType.ALL,\r\n            orphanRemoval = true\r\n    )\r\n    private Set&lt;DisLiked&gt; disLiked = new HashSet&lt;&gt;();\r\n\r\n    public void setPostInfo1(PostInfo postInfo) {\r\n        this.postInfo = postInfo;\r\n        postInfo.setPostLikeAndDislike(this);\r\n    }\r\n}\r\n```\r\n\r\n**Liked**\r\n```\r\npackage My_Project.integration.entity;\r\n\r\nimport lombok.*;\r\n\r\nimport javax.persistence.*;\r\n\r\n@Entity\r\n@Getter\r\n@Setter\r\n@NoArgsConstructor\r\n@AllArgsConstructor\r\n@Builder\r\npublic class Liked {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n\r\n    @ManyToOne(fetch = FetchType.LAZY)\r\n    @JoinColumn\r\n    private Users users;\r\n\r\n    @ManyToOne(\r\n            fetch = FetchType.LAZY\r\n    )\r\n    @JoinColumn\r\n    private PostLikeAndDislike postLikeAndDislike;\r\n}\r\n```\r\n\r\n**DisLiked**\r\n```\r\npackage My_Project.integration.entity;\r\n\r\nimport lombok.*;\r\n\r\nimport javax.persistence.*;\r\n\r\n@Entity\r\n@Getter\r\n@Setter\r\n@NoArgsConstructor\r\n@AllArgsConstructor\r\n@Builder\r\npublic class DisLiked {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n\r\n    @ManyToOne(fetch = FetchType.LAZY)\r\n    @JoinColumn\r\n    private Users users;\r\n\r\n    @ManyToOne(fetch = FetchType.LAZY)\r\n    @JoinColumn\r\n    private PostLikeAndDislike postLikeAndDislike;\r\n}\r\n```\r\n\r\n**Users**\r\n```\r\npackage My_Project.integration.entity;\r\n\r\n\r\nimport My_Project.integration.entity.Dto.UserInfoDto;\r\nimport lombok.AllArgsConstructor;\r\nimport lombok.Getter;\r\nimport lombok.NoArgsConstructor;\r\nimport lombok.Setter;\r\nimport org.hibernate.annotations.GenericGenerator;\r\n\r\nimport javax.persistence.*;\r\nimport java.time.LocalDateTime;\r\nimport java.util.ArrayList;\r\nimport java.util.HashSet;\r\nimport java.util.List;\r\nimport java.util.Set;\r\n\r\n@Setter\r\n@Entity\r\n@Getter\r\n@NoArgsConstructor\r\n@AllArgsConstructor\r\n@Table(uniqueConstraints = {@UniqueConstraint(columnNames = {&quot;ssn&quot;,&quot;phone_number&quot;})})\r\npublic class Users {\r\n\r\n    @Column(name = &quot;email&quot;, length = 40, updatable = false, nullable = false)\r\n    @Id\r\n    private String email;\r\n\r\n    @Column(name = &quot;password&quot;, length = 20, nullable = false)\r\n    private String password;\r\n\r\n    @Column(name = &quot;name&quot;, length = 25, nullable = false)\r\n    private String name;\r\n\r\n    @Column(name = &quot;phone_number&quot;, length = 12, nullable = false)\r\n    private String phoneNumber;\r\n\r\n    @Column(name =  &quot;ssn&quot;, length = 13, nullable = false, updatable = false)\r\n    private String ssn;\r\n\r\n    @Embedded\r\n    private Address address;\r\n\r\n    @Column(name = &quot;point&quot;)\r\n    private Long point;\r\n\r\n    @OneToMany(mappedBy = &quot;postedUser&quot;)\r\n    private List&lt;PostInfo&gt; uploadedPost = new ArrayList&lt;&gt;();\r\n\r\n    @OneToMany(mappedBy = &quot;userId&quot;)\r\n    private List&lt;PointHistory&gt; pointHistories = new ArrayList&lt;&gt;();\r\n\r\n    @Embedded\r\n    private Dates dates;\r\n\r\n    @OneToMany(\r\n            mappedBy = &quot;users&quot;\r\n    )\r\n    private Set&lt;Liked&gt; liked = new HashSet&lt;&gt;();\r\n\r\n    @OneToMany(\r\n            mappedBy = &quot;users&quot;\r\n    )\r\n    private Set&lt;DisLiked&gt; disLiked = new HashSet&lt;&gt;();\r\n\r\n\r\n    public Users(UserInfoDto userInfoDto){\r\n        this.setEmail(userInfoDto.getEmail());\r\n        this.setPassword(userInfoDto.getPassword());\r\n        this.setPhoneNumber(userInfoDto.getPhone_number());\r\n        this.setSsn(userInfoDto.getSsn());\r\n        this.setPoint(0L);\r\n        this.setName(userInfoDto.getName());\r\n\r\n        Address address = new Address(\r\n                userInfoDto.getCity_name(),\r\n                userInfoDto.getTown_name(),\r\n                userInfoDto.getStreet_name(),\r\n                userInfoDto.getZip_code(),\r\n                userInfoDto.getDetails()\r\n        );\r\n\r\n        this.setAddress(address);\r\n\r\n        List&lt;PostInfo&gt; postInfoList = new ArrayList&lt;&gt;();\r\n        List&lt;PointHistory&gt; pointHistoryList = new ArrayList&lt;&gt;();\r\n\r\n        this.setUploadedPost(postInfoList);\r\n        this.setPointHistories(pointHistoryList);\r\n\r\n        Dates dates = new Dates(LocalDateTime.now(), LocalDateTime.now());\r\n\r\n        this.setDates(dates);\r\n    }\r\n\r\n}\r\n\r\n```\r\n\r\n---\r\n\r\n**Controller code**\r\n```\r\n@PostMapping(&quot;/find_post/addBigComments&quot;)\r\n    @ResponseBody\r\n    public String addBigComments(\r\n            @RequestBody addBigCommentsDto addBigCommentsDto,\r\n            @CookieValue(&quot;users&quot;) Optional&lt;Cookie&gt; cookie) {\r\n        if (!cookie.isPresent()) {\r\n            return &quot;not_logined&quot;;\r\n        }\r\n\r\n        postService.addBigComments(addBigCommentsDto, cookie.get().getValue());\r\n        return &quot;success&quot;;\r\n    }\r\n```\r\n\r\n---\r\n**Service code**\r\n```\r\n @Transactional\r\n    public void addBigComments(addBigCommentsDto addBigCommentsDto, String s) {\r\n        try {\r\n            PostComments postCommentsV3 = postCommentsRepository.findPostCommentsV3(addBigCommentsDto.getComment_number()).get();\r\n            Users users = usersRepository.findUsersByEmail(s).get();\r\n            PostLikeAndDislike postLikeAndDislike =\r\n                    PostLikeAndDislike\r\n                            .builder()\r\n                            .postInfo(postCommentsV3.getPostInfo())\r\n                            .disLiked(new HashSet&lt;&gt;())\r\n                            .liked(new HashSet&lt;&gt;())\r\n                            .build();\r\n\r\n            postLikeAndDislikeRepository.save(postLikeAndDislike);\r\n\r\n            BigComments build = BigComments.builder()\r\n                    .dates(new Dates(LocalDateTime.now(), LocalDateTime.now()))\r\n                    .bigCommentedUser(users)\r\n                    .postComments(postCommentsV3)\r\n                    .content(addBigCommentsDto.getComment())\r\n                    .postLikeAndDislike(postLikeAndDislike)\r\n                    .postInfo(postCommentsV3.getPostInfo())\r\n                    .build();\r\n            postCommentsV3.addBigComments(build);\r\n\r\n\r\n            bigCommentsRepository.save(build);\r\n        } catch (NullPointerException e) {\r\n            e.printStackTrace();\r\n            System.out.println(&quot;NPE 발생, 회원 조회 or 댓글 조회 실패&quot;);\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n```\r\n\r\n---\r\n\r\n**Repository Code**\r\n```\r\n public Optional&lt;PostComments&gt; findPostCommentsV3(Long id) {\r\n        return Optional.ofNullable(jpaQueryFactory\r\n                .selectFrom(postComments)\r\n                .join(postComments.postInfo, postInfo).fetchJoin()\r\n                .join(postComments.postLikeAndDislike, postLikeAndDislike).fetchJoin()\r\n                .leftJoin(postComments.bigCommentsList, bigComments).fetchJoin()\r\n                .leftJoin(bigComments.postLikeAndDislike).fetchJoin()\r\n                .leftJoin(bigComments.postInfo).fetchJoin()\r\n                .leftJoin(bigComments.postComments).fetchJoin()\r\n                .leftJoin(bigComments.bigCommentedUser, users).fetchJoin()\r\n                .where(postComments.commentNumber.eq(id))\r\n                .fetchOne());\r\n    }\r\n```\r\n\r\n---\r\n**PostComments saving code (Controller + Service)**\r\n```\r\n@RequestMapping(value = &quot;/register_comments&quot;, method = {RequestMethod.POST, RequestMethod.GET})\r\n    public String registerComments(\r\n            @RequestBody CommentDto commentDto,\r\n            @CookieValue(name = &quot;users&quot;) Optional&lt;Cookie&gt; cookie,\r\n            RedirectAttributes attr) {\r\n        try {\r\n            postService.registerComments(commentDto, cookie);\r\n            attr.addAttribute(&quot;id&quot;, commentDto.getPost_number());\r\n            return &quot;redirect:/find_post&quot;;\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n            attr.addAttribute(&quot;string&quot;, &quot;로그인 후 댓글을 작성 해 주세요&quot;);\r\n            return &quot;redirect:/alert&quot;;\r\n        }\r\n```\r\n\r\n```\r\n@Transactional\r\n    public Boolean registerComments(CommentDto commentDto, Optional&lt;Cookie&gt; cookie) throws Exception{\r\n        try {\r\n            Optional&lt;PostInfo&gt; post = findPostV2(commentDto.getPost_number());\r\n            PostLikeAndDislike postLikeAndDislike = PostLikeAndDislike.builder().postInfo(post.get()).build();\r\n            postLikeAndDislikeRepository.save(postLikeAndDislike);\r\n\r\n            PostComments postComments = new PostComments(commentDto, post.get(),postLikeAndDislike);\r\n            postCommentsRepository.save(postComments);\r\n\r\n            return true;\r\n        } catch (NoSuchElementException e) {\r\n            throw new NoSuchElementException(&quot;로그인 되어있지 않습니다 or 조회 불가능&quot;);\r\n        } catch (NullPointerException e) {\r\n            throw new NullPointerException(&quot;NPE 발생&quot;);\r\n        } catch (Exception e) {\r\n            throw new Exception(&quot;에러 발생&quot;);\r\n        }\r\n    }\r\n```\r\n---\r\n\r\n**the part of the problem occurs**\r\n**The part that looks up PostInfo (Controller + Service + Repository)**\r\n```\r\n@GetMapping(&quot;/find_post&quot;)\r\n    public String findPost(@RequestParam(&quot;id&quot;) Long id, Model model, @CookieValue(&quot;users&quot;) Optional&lt;Cookie&gt; cookie) {\r\n        try {\r\n            PageRequest of = PageRequest.of(0, 10);\r\n\r\n            PostInfo postInfo = postService.findPostV2(id).get();\r\n            Slice&lt;PostCommentsResponseDto&gt; commentsV2 = postService.findCommentsV2(postInfo, of);\r\n            PostDto post = new PostDto(postInfo);\r\n\r\n            if (cookie.isPresent()) { // 로그인 되어 있을 시\r\n                Optional&lt;Users&gt; usersOptional = userService.findById(cookie.get().getValue());\r\n                model.addAttribute(&quot;checked&quot;, post.checkLikeAndDisLike(usersOptional));\r\n            }\r\n\r\n            model.addAttribute(&quot;post&quot;, post);\r\n            model.addAttribute(&quot;time&quot;, LocalDateTime.now());\r\n            return &quot;copy_post&quot;;\r\n        } catch (NoSuchElementException e) {\r\n            model.addAttribute(&quot;string&quot;, e.toString());\r\n            return &quot;alert&quot;;\r\n        }\r\n    }\r\n```\r\n```\r\n@Transactional\r\n    public Optional&lt;PostInfo&gt; findPostV2(Long id) throws NoSuchElementException {\r\n        return postRepository.findPostInfo(id);\r\n    }\r\n```\r\n```\r\n@Transactional\r\n    public Slice&lt;PostCommentsResponseDto&gt; findCommentsV2(PostInfo postInfo,Pageable pageable) throws NoSuchElementException{\r\n\r\n        return postCommentsRepository.findCommentsWithPaging(postInfo, pageable);\r\n    }\r\n\r\n```\r\n```\r\npublic Slice&lt;PostCommentsResponseDto&gt; findCommentsWithPaging(PostInfo postInfo1, Pageable pageable) {\r\n           List&lt;PostCommentsResponseDto&gt; fetch = jpaQueryFactory\r\n                    .select(Projections.constructor(\r\n                            PostCommentsResponseDto.class,\r\n                            postComments\r\n                    ))\r\n                .from(postComments)\r\n                .leftJoin(postComments.postInfo, postInfo).fetchJoin()\r\n                .leftJoin(postComments.postLikeAndDislike, postLikeAndDislike).fetchJoin()\r\n                .leftJoin(postLikeAndDislike.disLiked, disLiked).fetchJoin()\r\n                .leftJoin(postLikeAndDislike.liked, liked).fetchJoin()\r\n                .leftJoin(postLikeAndDislike.postInfo).fetchJoin()\r\n                .leftJoin(postComments.bigCommentsList, bigComments).fetchJoin()\r\n                .leftJoin(bigComments.bigCommentedUser).fetchJoin()\r\n                .leftJoin(bigComments.postComments).fetchJoin()\r\n                .leftJoin(bigComments.postInfo).fetchJoin()\r\n                .leftJoin(bigComments.postLikeAndDislike).fetchJoin()\r\n                .where(postComments.postInfo.eq(postInfo1))\r\n                .fetch();\r\n\r\n        return checkEndPage(pageable,fetch);\r\n    }\r\n\r\n    public Slice&lt;PostCommentsResponseDto&gt; checkEndPage(Pageable pageable, List&lt;PostCommentsResponseDto&gt; results) {\r\n        boolean hasNext = false;\r\n\r\n        if (results.size() &gt; pageable.getPageSize()) {\r\n            hasNext = true;\r\n            results.remove(pageable.getPageSize());\r\n        }\r\n        return new SliceImpl&lt;&gt;(results,pageable,hasNext);\r\n    }\r\n```\r\n\r\n```\r\n@Override\r\n    public Optional&lt;PostInfo&gt; findPostInfo(Long id) {\r\n        return Optional.ofNullable(\r\n                jpaQueryFactory\r\n                        .selectFrom(postInfo)\r\n                        .join(postInfo.postedUser, users).fetchJoin()\r\n                        .join(postInfo.photo, photo).fetchJoin()\r\n                        .leftJoin(photo.postInfo).fetchJoin()\r\n                        .join(postInfo.postLikeAndDislike, postLikeAndDislike).fetchJoin()\r\n                        .leftJoin(postLikeAndDislike.liked, liked).fetchJoin()\r\n                        .leftJoin(postLikeAndDislike.disLiked, disLiked).fetchJoin()\r\n                        .leftJoin(postLikeAndDislike.postInfo).fetchJoin()\r\n                        .where(postInfo.postNumber.eq(id))\r\n                        .fetchOne()\r\n        );\r\n    }\r\n```\r\n\r\nI think the queryDSL part is going well. However, the problem is that when I run the find_post method (when looking up PostInfo), when I save bigComments, it seems that several sizes are saved as 2 in the bigCommentsList, but when looking up, postComments1.bigCommentsList().size() = 1, postComments2.bigCommentsList().size() = 1\r\nSo cannot be saved multiple times.","title":"Multiple entities are not added to fields that are entity collection data types","body":"<p>I use Spring Boot, JPA, Spring Data JPA, QueryDSL and I am using Thymeleaf as the template engine. The logic I came up with is, like YouTube comments, when I added BigComments and then I look up PostInfo, I wanted to look up BigComments in the ListBigCommentsList field of the BigComments class. However, once I added BigComments, it seems to work properly, but if I added it several times, it is not saved in the ListBigCommentsList field of the BigComments class. And curiously, when saving a new PostComments entity, the object that I tried to saved the previously BigComments entity in the first PostComments object, it is being saved in the List bigCommentsList field that second object of PostComments. It's working really weirdly. I need your help.</p>\n<hr />\n<p><strong>Entity codes</strong></p>\n<p><strong>PostInfo</strong></p>\n<pre><code>package My_Project.integration.entity;\n\nimport My_Project.integration.entity.Dto.PostInfoDto;\nimport com.fasterxml.jackson.annotation.JsonIgnore;\nimport lombok.Getter;\nimport lombok.Setter;\nimport org.hibernate.annotations.BatchSize;\n\nimport javax.persistence.*;\nimport java.time.LocalDateTime;\nimport java.util.HashSet;\nimport java.util.Set;\n\n@Entity\n@Getter\n@Setter\npublic class PostInfo {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name = &quot;post_number&quot;)\n    private Long postNumber;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = &quot;id&quot;)\n    private Users postedUser;\n\n    @Column(name = &quot;post_title&quot;, length = 50, nullable = false)\n    public String postTitle;\n\n    @Column(name = &quot;post_content&quot;, nullable = false)\n    public String postContent;\n\n    @Embedded\n    public Dates dates;\n\n    @OneToMany(\n            mappedBy = &quot;postInfo&quot;,\n            orphanRemoval = true,\n            cascade = CascadeType.ALL\n    )\n    @BatchSize(size = 100)\n    private Set&lt;Photo&gt; photo = new HashSet&lt;&gt;();\n\n    @OneToMany(\n            orphanRemoval = true,\n            cascade = CascadeType.ALL,\n            mappedBy = &quot;postInfo&quot;\n    )\n    @BatchSize(size = 1000)\n    private Set&lt;PostComments&gt; comments;\n\n    @OneToOne(fetch = FetchType.LAZY,\n            cascade = CascadeType.ALL,\n            orphanRemoval = true)\n    @JoinColumn\n    @JsonIgnore\n    private PostLikeAndDislike postLikeAndDislike;\n\n    public PostInfo(Long postNumber, Users postedUser, String postTitle, String postContent, Dates dates, Set&lt;Photo&gt; photo, Set&lt;PostComments&gt; comments, PostLikeAndDislike postLikeAndDislike) {\n        this.postNumber = postNumber;\n        this.postedUser = postedUser;\n        this.postTitle = postTitle;\n        this.postContent = postContent;\n        this.dates = dates;\n        this.photo = photo;\n        this.comments = comments;\n        this.postLikeAndDislike = postLikeAndDislike;\n    }\n\n    public PostInfo() {\n    }\n\n    public void addPhoto(Photo photo) {\n        this.photo.add(photo);\n\n        if(photo.getPostInfo() != this)\n            photo.setPostInfoByPostInfo(this);\n    }\n\n    public PostInfo(Users users, PostInfoDto postInfo,PostLikeAndDislike postLikeAndDislike) {\n        Dates dates = new Dates(\n                LocalDateTime.now(),LocalDateTime.now()\n        );\n        this.postedUser = users;\n        this.postTitle = postInfo.getPostTitle();\n        this.postContent = postInfo.getPostContent();\n        this.dates = dates;\n        this.comments = new HashSet&lt;&gt;();\n        setPostLikeAndDislike(postLikeAndDislike);\n    }\n\n    public void addComments(PostComments postComments) {\n        this.comments.add(postComments);\n        postComments.setPostInfo(this);\n    }\n}\n\n</code></pre>\n<p><strong>PostComments</strong></p>\n<pre><code>package My_Project.integration.entity;\n\nimport My_Project.integration.entity.Dto.CommentDto;\nimport lombok.Getter;\nimport lombok.Setter;\n\nimport javax.persistence.*;\nimport java.time.LocalDateTime;\nimport java.util.ArrayList;\nimport java.util.List;\n\n@Entity\n@Getter\n@Setter\npublic class PostComments {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name = &quot;post_comments_number&quot;)\n    private Long commentNumber;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn\n    private PostInfo postInfo;\n\n    @Column(name = &quot;post_commented_users_email&quot;)\n    private String postCommentedUsersEmail;\n\n    @Column(name = &quot;post_comments_contents&quot;, nullable = false)\n    private String postCommentsContents;\n\n    @Embedded\n    private Dates dates;\n\n    @OneToMany(\n            mappedBy = &quot;bigCommentsNumber&quot;,\n            cascade = CascadeType.ALL,\n            orphanRemoval = true\n    )\n    private List&lt;BigComments&gt; bigCommentsList = new ArrayList&lt;&gt;();\n\n    @OneToOne(\n            orphanRemoval = true,\n            cascade = CascadeType.ALL,\n            fetch = FetchType.LAZY\n    )\n    @JoinColumn\n    private PostLikeAndDislike postLikeAndDislike;\n\n    public PostComments(CommentDto commentDto,PostInfo postInfo,PostLikeAndDislike postLikeAndDislike) {\n        this.postInfo = postInfo;\n        this.postCommentedUsersEmail = commentDto.getUsers_email();\n        this.postCommentsContents = commentDto.getComment();\n        this.postLikeAndDislike = new PostLikeAndDislike();\n\n        Dates dates1 = new Dates(LocalDateTime.now(),LocalDateTime.now());\n        this.dates = dates1;\n    }\n\n    public PostComments(Long commentNumber, PostInfo postInfo, String postCommentedUsersEmail, String postCommentsContents, Dates dates, List&lt;BigComments&gt; bigCommentsList, PostLikeAndDislike postLikeAndDislike) {\n        this.commentNumber = commentNumber;\n        this.postInfo = postInfo;\n        this.postCommentedUsersEmail = postCommentedUsersEmail;\n        this.postCommentsContents = postCommentsContents;\n        this.dates = dates;\n        this.bigCommentsList = new ArrayList&lt;&gt;(bigCommentsList);\n        this.postLikeAndDislike = postLikeAndDislike;\n    }\n\n    public PostComments() {\n        this.bigCommentsList = new ArrayList&lt;&gt;();\n    }\n\n    public Integer bigCommentSize() {\n        return getBigCommentsList().size();\n    }\n\n    public void addBigComments(BigComments bigComments) {\n        this.bigCommentsList.add(bigComments);\n        bigComments.setPostComments(this);\n    }\n}\n</code></pre>\n<p><strong>BigComments</strong></p>\n<pre><code>package My_Project.integration.entity;\n\nimport lombok.*;\n\nimport javax.persistence.*;\n\n@Entity\n@Getter\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\n@Setter\npublic class BigComments {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name = &quot;big_comments_number&quot;)\n    private Long bigCommentsNumber;\n\n    @OneToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = &quot;users&quot;)\n    private Users bigCommentedUser;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = &quot;post_comments_number&quot;)\n    private PostComments postComments;\n\n    @Column(name = &quot;big_comments_content&quot;,nullable = false)\n    private String content;\n\n    @OneToOne(\n            orphanRemoval = true,\n            cascade = CascadeType.ALL,\n            fetch = FetchType.LAZY\n    )\n    @JoinColumn(name=&quot;lidi&quot;)\n    private PostLikeAndDislike postLikeAndDislike;\n\n    @Embedded\n    private Dates dates;\n\n    @OneToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name=&quot;postInfo&quot;)\n    private PostInfo postInfo;\n}\n</code></pre>\n<p><strong>PostLikeAndDislike</strong></p>\n<pre><code>package My_Project.integration.entity;\n\nimport lombok.*;\n\nimport javax.persistence.*;\nimport java.util.HashSet;\nimport java.util.Set;\n\n@Entity\n@Getter\n@Setter\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\npublic class PostLikeAndDislike {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @OneToOne(\n            fetch = FetchType.LAZY,\n            mappedBy = &quot;postLikeAndDislike&quot;)\n    PostInfo postInfo;\n\n    @OneToMany(\n            mappedBy = &quot;postLikeAndDislike&quot;,\n            cascade = CascadeType.ALL,\n            orphanRemoval = true\n    )\n    private Set&lt;Liked&gt; liked = new HashSet&lt;&gt;();\n\n    @OneToMany(\n            mappedBy = &quot;postLikeAndDislike&quot;,\n            cascade = CascadeType.ALL,\n            orphanRemoval = true\n    )\n    private Set&lt;DisLiked&gt; disLiked = new HashSet&lt;&gt;();\n\n    public void setPostInfo1(PostInfo postInfo) {\n        this.postInfo = postInfo;\n        postInfo.setPostLikeAndDislike(this);\n    }\n}\n</code></pre>\n<p><strong>Liked</strong></p>\n<pre><code>package My_Project.integration.entity;\n\nimport lombok.*;\n\nimport javax.persistence.*;\n\n@Entity\n@Getter\n@Setter\n@NoArgsConstructor\n@AllArgsConstructor\n@Builder\npublic class Liked {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn\n    private Users users;\n\n    @ManyToOne(\n            fetch = FetchType.LAZY\n    )\n    @JoinColumn\n    private PostLikeAndDislike postLikeAndDislike;\n}\n</code></pre>\n<p><strong>DisLiked</strong></p>\n<pre><code>package My_Project.integration.entity;\n\nimport lombok.*;\n\nimport javax.persistence.*;\n\n@Entity\n@Getter\n@Setter\n@NoArgsConstructor\n@AllArgsConstructor\n@Builder\npublic class DisLiked {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn\n    private Users users;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn\n    private PostLikeAndDislike postLikeAndDislike;\n}\n</code></pre>\n<p><strong>Users</strong></p>\n<pre><code>package My_Project.integration.entity;\n\n\nimport My_Project.integration.entity.Dto.UserInfoDto;\nimport lombok.AllArgsConstructor;\nimport lombok.Getter;\nimport lombok.NoArgsConstructor;\nimport lombok.Setter;\nimport org.hibernate.annotations.GenericGenerator;\n\nimport javax.persistence.*;\nimport java.time.LocalDateTime;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.List;\nimport java.util.Set;\n\n@Setter\n@Entity\n@Getter\n@NoArgsConstructor\n@AllArgsConstructor\n@Table(uniqueConstraints = {@UniqueConstraint(columnNames = {&quot;ssn&quot;,&quot;phone_number&quot;})})\npublic class Users {\n\n    @Column(name = &quot;email&quot;, length = 40, updatable = false, nullable = false)\n    @Id\n    private String email;\n\n    @Column(name = &quot;password&quot;, length = 20, nullable = false)\n    private String password;\n\n    @Column(name = &quot;name&quot;, length = 25, nullable = false)\n    private String name;\n\n    @Column(name = &quot;phone_number&quot;, length = 12, nullable = false)\n    private String phoneNumber;\n\n    @Column(name =  &quot;ssn&quot;, length = 13, nullable = false, updatable = false)\n    private String ssn;\n\n    @Embedded\n    private Address address;\n\n    @Column(name = &quot;point&quot;)\n    private Long point;\n\n    @OneToMany(mappedBy = &quot;postedUser&quot;)\n    private List&lt;PostInfo&gt; uploadedPost = new ArrayList&lt;&gt;();\n\n    @OneToMany(mappedBy = &quot;userId&quot;)\n    private List&lt;PointHistory&gt; pointHistories = new ArrayList&lt;&gt;();\n\n    @Embedded\n    private Dates dates;\n\n    @OneToMany(\n            mappedBy = &quot;users&quot;\n    )\n    private Set&lt;Liked&gt; liked = new HashSet&lt;&gt;();\n\n    @OneToMany(\n            mappedBy = &quot;users&quot;\n    )\n    private Set&lt;DisLiked&gt; disLiked = new HashSet&lt;&gt;();\n\n\n    public Users(UserInfoDto userInfoDto){\n        this.setEmail(userInfoDto.getEmail());\n        this.setPassword(userInfoDto.getPassword());\n        this.setPhoneNumber(userInfoDto.getPhone_number());\n        this.setSsn(userInfoDto.getSsn());\n        this.setPoint(0L);\n        this.setName(userInfoDto.getName());\n\n        Address address = new Address(\n                userInfoDto.getCity_name(),\n                userInfoDto.getTown_name(),\n                userInfoDto.getStreet_name(),\n                userInfoDto.getZip_code(),\n                userInfoDto.getDetails()\n        );\n\n        this.setAddress(address);\n\n        List&lt;PostInfo&gt; postInfoList = new ArrayList&lt;&gt;();\n        List&lt;PointHistory&gt; pointHistoryList = new ArrayList&lt;&gt;();\n\n        this.setUploadedPost(postInfoList);\n        this.setPointHistories(pointHistoryList);\n\n        Dates dates = new Dates(LocalDateTime.now(), LocalDateTime.now());\n\n        this.setDates(dates);\n    }\n\n}\n\n</code></pre>\n<hr />\n<p><strong>Controller code</strong></p>\n<pre><code>@PostMapping(&quot;/find_post/addBigComments&quot;)\n    @ResponseBody\n    public String addBigComments(\n            @RequestBody addBigCommentsDto addBigCommentsDto,\n            @CookieValue(&quot;users&quot;) Optional&lt;Cookie&gt; cookie) {\n        if (!cookie.isPresent()) {\n            return &quot;not_logined&quot;;\n        }\n\n        postService.addBigComments(addBigCommentsDto, cookie.get().getValue());\n        return &quot;success&quot;;\n    }\n</code></pre>\n<hr />\n<p><strong>Service code</strong></p>\n<pre><code> @Transactional\n    public void addBigComments(addBigCommentsDto addBigCommentsDto, String s) {\n        try {\n            PostComments postCommentsV3 = postCommentsRepository.findPostCommentsV3(addBigCommentsDto.getComment_number()).get();\n            Users users = usersRepository.findUsersByEmail(s).get();\n            PostLikeAndDislike postLikeAndDislike =\n                    PostLikeAndDislike\n                            .builder()\n                            .postInfo(postCommentsV3.getPostInfo())\n                            .disLiked(new HashSet&lt;&gt;())\n                            .liked(new HashSet&lt;&gt;())\n                            .build();\n\n            postLikeAndDislikeRepository.save(postLikeAndDislike);\n\n            BigComments build = BigComments.builder()\n                    .dates(new Dates(LocalDateTime.now(), LocalDateTime.now()))\n                    .bigCommentedUser(users)\n                    .postComments(postCommentsV3)\n                    .content(addBigCommentsDto.getComment())\n                    .postLikeAndDislike(postLikeAndDislike)\n                    .postInfo(postCommentsV3.getPostInfo())\n                    .build();\n            postCommentsV3.addBigComments(build);\n\n\n            bigCommentsRepository.save(build);\n        } catch (NullPointerException e) {\n            e.printStackTrace();\n            System.out.println(&quot;NPE 발생, 회원 조회 or 댓글 조회 실패&quot;);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n</code></pre>\n<hr />\n<p><strong>Repository Code</strong></p>\n<pre><code> public Optional&lt;PostComments&gt; findPostCommentsV3(Long id) {\n        return Optional.ofNullable(jpaQueryFactory\n                .selectFrom(postComments)\n                .join(postComments.postInfo, postInfo).fetchJoin()\n                .join(postComments.postLikeAndDislike, postLikeAndDislike).fetchJoin()\n                .leftJoin(postComments.bigCommentsList, bigComments).fetchJoin()\n                .leftJoin(bigComments.postLikeAndDislike).fetchJoin()\n                .leftJoin(bigComments.postInfo).fetchJoin()\n                .leftJoin(bigComments.postComments).fetchJoin()\n                .leftJoin(bigComments.bigCommentedUser, users).fetchJoin()\n                .where(postComments.commentNumber.eq(id))\n                .fetchOne());\n    }\n</code></pre>\n<hr />\n<p><strong>PostComments saving code (Controller + Service)</strong></p>\n<pre><code>@RequestMapping(value = &quot;/register_comments&quot;, method = {RequestMethod.POST, RequestMethod.GET})\n    public String registerComments(\n            @RequestBody CommentDto commentDto,\n            @CookieValue(name = &quot;users&quot;) Optional&lt;Cookie&gt; cookie,\n            RedirectAttributes attr) {\n        try {\n            postService.registerComments(commentDto, cookie);\n            attr.addAttribute(&quot;id&quot;, commentDto.getPost_number());\n            return &quot;redirect:/find_post&quot;;\n        } catch (Exception e) {\n            e.printStackTrace();\n            attr.addAttribute(&quot;string&quot;, &quot;로그인 후 댓글을 작성 해 주세요&quot;);\n            return &quot;redirect:/alert&quot;;\n        }\n</code></pre>\n<pre><code>@Transactional\n    public Boolean registerComments(CommentDto commentDto, Optional&lt;Cookie&gt; cookie) throws Exception{\n        try {\n            Optional&lt;PostInfo&gt; post = findPostV2(commentDto.getPost_number());\n            PostLikeAndDislike postLikeAndDislike = PostLikeAndDislike.builder().postInfo(post.get()).build();\n            postLikeAndDislikeRepository.save(postLikeAndDislike);\n\n            PostComments postComments = new PostComments(commentDto, post.get(),postLikeAndDislike);\n            postCommentsRepository.save(postComments);\n\n            return true;\n        } catch (NoSuchElementException e) {\n            throw new NoSuchElementException(&quot;로그인 되어있지 않습니다 or 조회 불가능&quot;);\n        } catch (NullPointerException e) {\n            throw new NullPointerException(&quot;NPE 발생&quot;);\n        } catch (Exception e) {\n            throw new Exception(&quot;에러 발생&quot;);\n        }\n    }\n</code></pre>\n<hr />\n<p><strong>the part of the problem occurs</strong>\n<strong>The part that looks up PostInfo (Controller + Service + Repository)</strong></p>\n<pre><code>@GetMapping(&quot;/find_post&quot;)\n    public String findPost(@RequestParam(&quot;id&quot;) Long id, Model model, @CookieValue(&quot;users&quot;) Optional&lt;Cookie&gt; cookie) {\n        try {\n            PageRequest of = PageRequest.of(0, 10);\n\n            PostInfo postInfo = postService.findPostV2(id).get();\n            Slice&lt;PostCommentsResponseDto&gt; commentsV2 = postService.findCommentsV2(postInfo, of);\n            PostDto post = new PostDto(postInfo);\n\n            if (cookie.isPresent()) { // 로그인 되어 있을 시\n                Optional&lt;Users&gt; usersOptional = userService.findById(cookie.get().getValue());\n                model.addAttribute(&quot;checked&quot;, post.checkLikeAndDisLike(usersOptional));\n            }\n\n            model.addAttribute(&quot;post&quot;, post);\n            model.addAttribute(&quot;time&quot;, LocalDateTime.now());\n            return &quot;copy_post&quot;;\n        } catch (NoSuchElementException e) {\n            model.addAttribute(&quot;string&quot;, e.toString());\n            return &quot;alert&quot;;\n        }\n    }\n</code></pre>\n<pre><code>@Transactional\n    public Optional&lt;PostInfo&gt; findPostV2(Long id) throws NoSuchElementException {\n        return postRepository.findPostInfo(id);\n    }\n</code></pre>\n<pre><code>@Transactional\n    public Slice&lt;PostCommentsResponseDto&gt; findCommentsV2(PostInfo postInfo,Pageable pageable) throws NoSuchElementException{\n\n        return postCommentsRepository.findCommentsWithPaging(postInfo, pageable);\n    }\n\n</code></pre>\n<pre><code>public Slice&lt;PostCommentsResponseDto&gt; findCommentsWithPaging(PostInfo postInfo1, Pageable pageable) {\n           List&lt;PostCommentsResponseDto&gt; fetch = jpaQueryFactory\n                    .select(Projections.constructor(\n                            PostCommentsResponseDto.class,\n                            postComments\n                    ))\n                .from(postComments)\n                .leftJoin(postComments.postInfo, postInfo).fetchJoin()\n                .leftJoin(postComments.postLikeAndDislike, postLikeAndDislike).fetchJoin()\n                .leftJoin(postLikeAndDislike.disLiked, disLiked).fetchJoin()\n                .leftJoin(postLikeAndDislike.liked, liked).fetchJoin()\n                .leftJoin(postLikeAndDislike.postInfo).fetchJoin()\n                .leftJoin(postComments.bigCommentsList, bigComments).fetchJoin()\n                .leftJoin(bigComments.bigCommentedUser).fetchJoin()\n                .leftJoin(bigComments.postComments).fetchJoin()\n                .leftJoin(bigComments.postInfo).fetchJoin()\n                .leftJoin(bigComments.postLikeAndDislike).fetchJoin()\n                .where(postComments.postInfo.eq(postInfo1))\n                .fetch();\n\n        return checkEndPage(pageable,fetch);\n    }\n\n    public Slice&lt;PostCommentsResponseDto&gt; checkEndPage(Pageable pageable, List&lt;PostCommentsResponseDto&gt; results) {\n        boolean hasNext = false;\n\n        if (results.size() &gt; pageable.getPageSize()) {\n            hasNext = true;\n            results.remove(pageable.getPageSize());\n        }\n        return new SliceImpl&lt;&gt;(results,pageable,hasNext);\n    }\n</code></pre>\n<pre><code>@Override\n    public Optional&lt;PostInfo&gt; findPostInfo(Long id) {\n        return Optional.ofNullable(\n                jpaQueryFactory\n                        .selectFrom(postInfo)\n                        .join(postInfo.postedUser, users).fetchJoin()\n                        .join(postInfo.photo, photo).fetchJoin()\n                        .leftJoin(photo.postInfo).fetchJoin()\n                        .join(postInfo.postLikeAndDislike, postLikeAndDislike).fetchJoin()\n                        .leftJoin(postLikeAndDislike.liked, liked).fetchJoin()\n                        .leftJoin(postLikeAndDislike.disLiked, disLiked).fetchJoin()\n                        .leftJoin(postLikeAndDislike.postInfo).fetchJoin()\n                        .where(postInfo.postNumber.eq(id))\n                        .fetchOne()\n        );\n    }\n</code></pre>\n<p>I think the queryDSL part is going well. However, the problem is that when I run the find_post method (when looking up PostInfo), when I save bigComments, it seems that several sizes are saved as 2 in the bigCommentsList, but when looking up, postComments1.bigCommentsList().size() = 1, postComments2.bigCommentsList().size() = 1\nSo cannot be saved multiple times.</p>\n"},{"tags":["java","oracle","spring-boot","stored-procedures","spring-jdbc"],"comments":[{"owner":{"account_id":6389739,"reputation":2892,"user_id":4956336,"display_name":"p3consulting"},"score":0,"creation_date":1681023158,"post_id":75969035,"comment_id":133990465,"body_markdown":"May be Jackson doesn&#39;t like your &quot;country_volumes         CTRY_INT_VOLTYPE_TAB&quot;: is it a a TABLE OF inside a TABLE OF ?\nWhy didn&#39;t you try to return directly a JSON payload from your procedure?","body":"May be Jackson doesn&#39;t like your &quot;country_volumes         CTRY_INT_VOLTYPE_TAB&quot;: is it a a TABLE OF inside a TABLE OF ? Why didn&#39;t you try to return directly a JSON payload from your procedure?"},{"owner":{"account_id":21883869,"reputation":21,"user_id":16171752,"display_name":"Aishwarya B"},"score":0,"creation_date":1681024398,"post_id":75969035,"comment_id":133990570,"body_markdown":"@p3consulting I have edited the question with CTRY_INT_VOLTYPE_TAB type..Unfortunately I cannot make any changes to procedure","body":"@p3consulting I have edited the question with CTRY_INT_VOLTYPE_TAB type..Unfortunately I cannot make any changes to procedure"},{"owner":{"account_id":6389739,"reputation":2892,"user_id":4956336,"display_name":"p3consulting"},"score":0,"creation_date":1681029155,"post_id":75969035,"comment_id":133991037,"body_markdown":"So you have at least 3 levels of nested TABLE OF... &quot;Rms_volume_points      ds_rms_vol_obj_tab&quot; being another erTABLE OF... If you can&#39;t change the procedure, could you create a new new one calling the original one and converting into JSON in PL/SQL ?","body":"So you have at least 3 levels of nested TABLE OF... &quot;Rms_volume_points      ds_rms_vol_obj_tab&quot; being another erTABLE OF... If you can&#39;t change the procedure, could you create a new new one calling the original one and converting into JSON in PL/SQL ?"},{"owner":{"account_id":1635690,"reputation":150157,"user_id":1509264,"accept_rate":58,"display_name":"MT0"},"score":0,"creation_date":1681029765,"post_id":75969035,"comment_id":133991090,"body_markdown":"Possible duplicate of https://stackoverflow.com/q/54344166/1509264","body":"Possible duplicate of <a href=\"https://stackoverflow.com/q/54344166/1509264\">stackoverflow.com/q/54344166/1509264</a>"},{"owner":{"account_id":6389739,"reputation":2892,"user_id":4956336,"display_name":"p3consulting"},"score":0,"creation_date":1681033333,"post_id":75969035,"comment_id":133991493,"body_markdown":"@MTO, not exactly a dup but same family of question indeed, here he needs a TABLE OF OBJECT not a simple OBJECT, but that make me think that Types.ARRAY is inappropriate here, I will not be surprised that a TABLE OF OBJECT is returned as a OracleTypes.CURSOR.","body":"@MTO, not exactly a dup but same family of question indeed, here he needs a TABLE OF OBJECT not a simple OBJECT, but that make me think that Types.ARRAY is inappropriate here, I will not be surprised that a TABLE OF OBJECT is returned as a OracleTypes.CURSOR."},{"owner":{"account_id":6389739,"reputation":2892,"user_id":4956336,"display_name":"p3consulting"},"score":0,"creation_date":1681042074,"post_id":75969035,"comment_id":133992349,"body_markdown":"Or go the JDBC, uses OracleCallableStatement and registerOutParameter(…, OracleTypes.ARRAY,…)","body":"Or go the JDBC, uses OracleCallableStatement and registerOutParameter(…, OracleTypes.ARRAY,…)"},{"owner":{"account_id":21883869,"reputation":21,"user_id":16171752,"display_name":"Aishwarya B"},"score":0,"creation_date":1681050222,"post_id":75969035,"comment_id":133993365,"body_markdown":"I used \n`StructMapper&lt;DsIntRmsVolumeObj&gt; MAPPER =BeanPropertyStructMapper.newInstance(DsIntRmsVolumeObj.class);`\n\n`new SqlOutParameter(&quot;out_ds_volume_tab&quot;, Types.ARRAY,&quot;DS_INT_RMS_VOLUME_TBL&quot;,new SqlReturnStructArray(MAPPER))`\n\nI created class **DsIntRmsVolumeObj  implements SQLData**\n\nand overridden getSQLTypeName(),readSQL(SQLInput stream, String typeName),writeSQL(SQLOutput stream)\nI am able to get all the out parameters except rms_volumes and country_volumes","body":"I used  <code>StructMapper&lt;DsIntRmsVolumeObj&gt; MAPPER =BeanPropertyStructMapper.newInstance(DsIntRmsVolumeObj.clas&zwnj;&#8203;s);</code>  <code>new SqlOutParameter(&quot;out_ds_volume_tab&quot;, Types.ARRAY,&quot;DS_INT_RMS_VOLUME_TBL&quot;,new SqlReturnStructArray(MAPPER))</code>  I created class <b>DsIntRmsVolumeObj  implements SQLData</b>  and overridden getSQLTypeName(),readSQL(SQLInput stream, String typeName),writeSQL(SQLOutput stream) I am able to get all the out parameters except rms_volumes and country_volumes"}],"owner":{"account_id":21883869,"reputation":21,"user_id":16171752,"display_name":"Aishwarya B"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":376,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1681049987,"creation_date":1681020765,"question_id":75969035,"body_markdown":"From Spring boot application I am trying to call Oracle Procedure with multiple IN and OUT parameters. One of the OUT parameters is of nested custom Object type. I&#39;m looking for a  way to call the procedure from Java code and return all the output parameters.\r\n\r\n    create or replace TYPE  DS_INT_RMS_VOLUME_TBL IS TABLE OF PUB.DS_INT_RMS_VOLUME_OBJ;\r\n    create or replace TYPE     DS_INT_RMS_VOLUME_OBJ AS OBJECT\r\n    (\r\n     order_month         VARCHAR2(20),\r\n     ds_ppv              NUMBER,\r\n     ds_dlv              NUMBER,\r\n     ds_pv               NUMBER,\r\n     ds_gv               NUMBER,\r\n     ds_tv               NUMBER,\r\n     ds_ro               NUMBER,\r\n     ds_mpv              NUMBER,\r\n     ds_mtv              NUMBER,\r\n     ds_3ppv             NUMBER,\r\n     ds_12ppv            NUMBER,\r\n     ds_cv               NUMBER,\r\n     chr_attribute1      NUMBER,\r\n     chr_attribute2      NUMBER,\r\n     dte_attribute2      DATE,\r\n     ds_3dlv             NUMBER,\r\n     ds_12dlv            NUMBER,\r\n     ds_6ppv             NUMBER,\r\n     ds_6dlv             NUMBER,\r\n     ds_2ppv             NUMBER,\r\n     mb_points           NUMBER,\r\n     rms_volumes         ds_rms_vol_obj_tab,\r\n     country_volumes         CTRY_INT_VOLTYPE_TAB,\r\n     cdlv           NUMBER,\r\n        CONSTRUCTOR FUNCTION DS_INT_RMS_VOLUME_OBJ\r\n          RETURN SELF AS RESULT\r\n    )\r\n\r\n    create or replace TYPE     CTRY_INT_VOLUMES_TAB IS TABLE OF CTRY_INT_VOLUMES_OBJ;\r\n\r\n    create or replace TYPE     CTRY_INT_VOLUMES_OBJ AS OBJECT\r\n    (\r\n     Country_code            VARCHAR2(100),\r\n     Rms_volume_points      ds_rms_vol_obj_tab,\r\n        CONSTRUCTOR FUNCTION CTRY_INT_VOLUMES_OBJ\r\n          RETURN SELF AS RESULT\r\n    );\r\n\r\n\r\nThe above code is custom type in oracle db\r\n\r\nThe procedure inside  a package is below:\r\n\r\n    PROCEDURE get_rms_volumes_info (\r\n          out_chr_err_code               OUT VARCHAR2,\r\n          out_chr_err_msg                OUT VARCHAR2,\r\n          out_chr_ds_id                  OUT VARCHAR2,\r\n          out_ds_volume_tab              OUT DS_INT_RMS_VOLUME_TBL,\r\n          out_ds_primary_volume          OUT NUMBER,\r\n          ...some more out paramter of type number....\r\n          in_chr_debug                IN     VARCHAR2 DEFAULT g_chr_no,\r\n          in_chr_service_consumer     IN     VARCHAR2,\r\n          in_chr_ds_id                IN     VARCHAR2,\r\n          in_chr_from_month           IN     VARCHAR2,\r\n          in_chr_to_month             IN     VARCHAR2,\r\n          include_Order_purpose       IN     VARCHAR2,\r\n          inventory_order_month       IN     VARCHAR2);\r\n\r\n\r\nCode I tried\r\n\r\n\r\n    public Map&lt;String, Object&gt; getVolumesInfo() {\r\n            SqlReturnArray sqlReturnArray=new SqlReturnArray();\r\n            SimpleJdbcCall simpleJdbcCall=new SimpleJdbcCall(jdbcTemplate)\r\n                    .withProcedureName(&quot;get_rms_volumes_info&quot;)\r\n                    .withCatalogName(&quot;DS_INT_COMMON_PKG&quot;)\r\n                    .withoutProcedureColumnMetaDataAccess()\r\n                    .declareParameters(new SqlParameter[]{\r\n                            new SqlOutParameter(&quot;out_chr_err_code&quot;, Types.VARCHAR),\r\n                            new SqlOutParameter(&quot;out_chr_err_msg&quot;, Types.VARCHAR),\r\n                            new SqlOutParameter(&quot;out_chr_ds_id&quot;, Types.VARCHAR),\r\n                            new SqlOutParameter(&quot;out_ds_volume_tab&quot;, Types.ARRAY,&quot;DS_INT_RMS_VOLUME_TBL&quot;,sqlReturnArray),\r\n                            .....some more out parameters.....,\r\n                            new SqlParameter(&quot;in_chr_debug&quot;, Types.VARCHAR),\r\n                            new SqlParameter(&quot;in_chr_service_consumer&quot;, Types.VARCHAR),\r\n                            new SqlParameter(&quot;in_chr_ds_id&quot;, Types.VARCHAR),\r\n                            new SqlParameter(&quot;in_chr_from_month&quot;, Types.VARCHAR),\r\n                            new SqlParameter(&quot;in_chr_to_month&quot;, Types.VARCHAR),\r\n                            new SqlParameter(&quot;include_Order_purpose&quot;, Types.VARCHAR),\r\n                            new SqlParameter(&quot;inventory_order_month&quot;, Types.VARCHAR),\r\n    \r\n                            }\r\n                    );\r\n            Map&lt;String,String&gt; in = new HashMap&lt;&gt;();\r\n            in.put(&quot;in_chr_debug&quot;,&quot;N&quot;);\r\n            in.put(&quot;in_chr_service_consumer&quot;,&quot;MYHL&quot;);\r\n            in.put(&quot;in_chr_ds_id&quot;,&quot;STAFF&quot;);\r\n            in.put(&quot;in_chr_from_month&quot;,&quot;202208&quot;);\r\n            in.put(&quot;in_chr_to_month&quot;,&quot;202208&quot;);\r\n            in.put(&quot;include_Order_purpose&quot;,&quot;Y&quot;);\r\n            in.put(&quot;inventory_order_month&quot;,&quot;Y&quot;);\r\n            Map&lt;String,Object&gt; out=new HashMap&lt;&gt;();\r\n            out=simpleJdbcCall.execute(in);\r\n            return out;\r\n        }\r\n\r\n\r\n\r\nThe above code gives error &quot;**com.fasterxml.jackson.databind.exc.InvalidDefinitionException: \r\nDirect self-reference leading to cycle (through reference chain: java.util.LinkedHashMap[&quot;out_ds_volume_tab&quot;]-&gt;\r\noracle.sql.STRUCT[0]-&gt;oracle.sql.STRUCT[&quot;physicalConnection&quot;]-&gt;oracle.jdbc.driver.T4CConnection[&quot;wrapper&quot;])**&quot;\r\n\r\n\r\n\r\n\r\n\r\n\r\n","title":"How to call an Oracle PL-SQL procedure which has a custom defined complex Object type as OUTPUT parameter from Java Spring boot application","body":"<p>From Spring boot application I am trying to call Oracle Procedure with multiple IN and OUT parameters. One of the OUT parameters is of nested custom Object type. I'm looking for a  way to call the procedure from Java code and return all the output parameters.</p>\n<pre><code>create or replace TYPE  DS_INT_RMS_VOLUME_TBL IS TABLE OF PUB.DS_INT_RMS_VOLUME_OBJ;\ncreate or replace TYPE     DS_INT_RMS_VOLUME_OBJ AS OBJECT\n(\n order_month         VARCHAR2(20),\n ds_ppv              NUMBER,\n ds_dlv              NUMBER,\n ds_pv               NUMBER,\n ds_gv               NUMBER,\n ds_tv               NUMBER,\n ds_ro               NUMBER,\n ds_mpv              NUMBER,\n ds_mtv              NUMBER,\n ds_3ppv             NUMBER,\n ds_12ppv            NUMBER,\n ds_cv               NUMBER,\n chr_attribute1      NUMBER,\n chr_attribute2      NUMBER,\n dte_attribute2      DATE,\n ds_3dlv             NUMBER,\n ds_12dlv            NUMBER,\n ds_6ppv             NUMBER,\n ds_6dlv             NUMBER,\n ds_2ppv             NUMBER,\n mb_points           NUMBER,\n rms_volumes         ds_rms_vol_obj_tab,\n country_volumes         CTRY_INT_VOLTYPE_TAB,\n cdlv           NUMBER,\n    CONSTRUCTOR FUNCTION DS_INT_RMS_VOLUME_OBJ\n      RETURN SELF AS RESULT\n)\n\ncreate or replace TYPE     CTRY_INT_VOLUMES_TAB IS TABLE OF CTRY_INT_VOLUMES_OBJ;\n\ncreate or replace TYPE     CTRY_INT_VOLUMES_OBJ AS OBJECT\n(\n Country_code            VARCHAR2(100),\n Rms_volume_points      ds_rms_vol_obj_tab,\n    CONSTRUCTOR FUNCTION CTRY_INT_VOLUMES_OBJ\n      RETURN SELF AS RESULT\n);\n</code></pre>\n<p>The above code is custom type in oracle db</p>\n<p>The procedure inside  a package is below:</p>\n<pre><code>PROCEDURE get_rms_volumes_info (\n      out_chr_err_code               OUT VARCHAR2,\n      out_chr_err_msg                OUT VARCHAR2,\n      out_chr_ds_id                  OUT VARCHAR2,\n      out_ds_volume_tab              OUT DS_INT_RMS_VOLUME_TBL,\n      out_ds_primary_volume          OUT NUMBER,\n      ...some more out paramter of type number....\n      in_chr_debug                IN     VARCHAR2 DEFAULT g_chr_no,\n      in_chr_service_consumer     IN     VARCHAR2,\n      in_chr_ds_id                IN     VARCHAR2,\n      in_chr_from_month           IN     VARCHAR2,\n      in_chr_to_month             IN     VARCHAR2,\n      include_Order_purpose       IN     VARCHAR2,\n      inventory_order_month       IN     VARCHAR2);\n</code></pre>\n<p>Code I tried</p>\n<pre><code>public Map&lt;String, Object&gt; getVolumesInfo() {\n        SqlReturnArray sqlReturnArray=new SqlReturnArray();\n        SimpleJdbcCall simpleJdbcCall=new SimpleJdbcCall(jdbcTemplate)\n                .withProcedureName(&quot;get_rms_volumes_info&quot;)\n                .withCatalogName(&quot;DS_INT_COMMON_PKG&quot;)\n                .withoutProcedureColumnMetaDataAccess()\n                .declareParameters(new SqlParameter[]{\n                        new SqlOutParameter(&quot;out_chr_err_code&quot;, Types.VARCHAR),\n                        new SqlOutParameter(&quot;out_chr_err_msg&quot;, Types.VARCHAR),\n                        new SqlOutParameter(&quot;out_chr_ds_id&quot;, Types.VARCHAR),\n                        new SqlOutParameter(&quot;out_ds_volume_tab&quot;, Types.ARRAY,&quot;DS_INT_RMS_VOLUME_TBL&quot;,sqlReturnArray),\n                        .....some more out parameters.....,\n                        new SqlParameter(&quot;in_chr_debug&quot;, Types.VARCHAR),\n                        new SqlParameter(&quot;in_chr_service_consumer&quot;, Types.VARCHAR),\n                        new SqlParameter(&quot;in_chr_ds_id&quot;, Types.VARCHAR),\n                        new SqlParameter(&quot;in_chr_from_month&quot;, Types.VARCHAR),\n                        new SqlParameter(&quot;in_chr_to_month&quot;, Types.VARCHAR),\n                        new SqlParameter(&quot;include_Order_purpose&quot;, Types.VARCHAR),\n                        new SqlParameter(&quot;inventory_order_month&quot;, Types.VARCHAR),\n\n                        }\n                );\n        Map&lt;String,String&gt; in = new HashMap&lt;&gt;();\n        in.put(&quot;in_chr_debug&quot;,&quot;N&quot;);\n        in.put(&quot;in_chr_service_consumer&quot;,&quot;MYHL&quot;);\n        in.put(&quot;in_chr_ds_id&quot;,&quot;STAFF&quot;);\n        in.put(&quot;in_chr_from_month&quot;,&quot;202208&quot;);\n        in.put(&quot;in_chr_to_month&quot;,&quot;202208&quot;);\n        in.put(&quot;include_Order_purpose&quot;,&quot;Y&quot;);\n        in.put(&quot;inventory_order_month&quot;,&quot;Y&quot;);\n        Map&lt;String,Object&gt; out=new HashMap&lt;&gt;();\n        out=simpleJdbcCall.execute(in);\n        return out;\n    }\n</code></pre>\n<p>The above code gives error &quot;<strong>com.fasterxml.jackson.databind.exc.InvalidDefinitionException:\nDirect self-reference leading to cycle (through reference chain: java.util.LinkedHashMap[&quot;out_ds_volume_tab&quot;]-&gt;\noracle.sql.STRUCT[0]-&gt;oracle.sql.STRUCT[&quot;physicalConnection&quot;]-&gt;oracle.jdbc.driver.T4CConnection[&quot;wrapper&quot;])</strong>&quot;</p>\n"},{"tags":["java","spring-boot","spring-mvc","resttemplate","requestfactory"],"owner":{"account_id":16710393,"reputation":21,"user_id":12077736,"display_name":"Hasuni"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":25,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681049625,"creation_date":1681049625,"question_id":75971032,"body_markdown":"Using Spring RestTemplate I try to send a large stream to a server.\r\nThan I receive **getBody not supported** error.\r\nIf I do it with SimpleClientHttpRequestFactory it works normally, but I can&#39;t make my own sslcontext, that I need. What am I doing wrong and how can I fix it?\r\n\r\nI use spring boot 2.6.4, if it&#39;s important.\r\n\r\nCode samples:\r\n\r\nRestTemplate creation:\r\n\r\n    public RestTemplate configureSSLRestTemplate(final String keystoreLocation,\r\n                                                     final String keystorePassword,\r\n                                                     final String keyPassword,\r\n                                                     final int requestTimeout) throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException, UnrecoverableKeyException, KeyManagementException {\r\n            final HttpClient httpClient = httpClientConfiguration(keystoreLocation, keystorePassword, keyPassword);\r\n    \r\n            final HttpComponentsClientHttpRequestFactory customRequestFactory = new HttpComponentsClientHttpRequestFactory(httpClient);\r\n    \r\n                customRequestFactory.setBufferRequestBody(false);\r\n                customRequestFactory.setConnectTimeout(requestTimeout);\r\n                customRequestFactory.setReadTimeout(requestTimeout);\r\n                customRequestFactory.setConnectionRequestTimeout(requestTimeout);\r\n            \r\n    \r\n            return new RestTemplate(customRequestFactory);\r\n    \r\n        }\r\n    \r\n        private CloseableHttpClient httpClientConfiguration(final String keystoreLocation,\r\n                                                            final String keystorePassword,\r\n                                                            final String keyPassword) throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException, UnrecoverableKeyException, KeyManagementException {\r\n            final TrustManager[] trustCheckedCertificates = new TrustManager[]{new X509TrustManager() {\r\n                public X509Certificate[] getAcceptedIssuers() {\r\n                    return new X509Certificate[0];\r\n                }\r\n    \r\n                public void checkClientTrusted(final X509Certificate[] certs, String authType) {\r\n                }\r\n    \r\n                public void checkServerTrusted(final X509Certificate[] certs, String authType) throws CertificateException {\r\n    \r\n                    if (!certificateValidatorService.validateCertificate(certs[0], false)) {\r\n                        throw new CertificateException(&quot;Server certificate is wrong&quot;); //TODO\r\n                    }\r\n                }\r\n            }};\r\n    \r\n            final SSLContext sslContext = configureSSLContext(keystoreLocation, keystorePassword, keyPassword, trustCheckedCertificates);\r\n    \r\n            return HttpClients.custom().setSSLContext(sslContext)\r\n                    .setSSLHostnameVerifier(NoopHostnameVerifier.INSTANCE).build();\r\n        }\r\n    \r\n        public SSLContext configureSSLContext(final String keystoreLocation,\r\n                                              final String keystorePassword,\r\n                                              final String keyPassword,\r\n                                              final TrustManager[] trustCheckedCertificates) throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException, UnrecoverableKeyException, KeyManagementException {\r\n            final KeyStore keystore = KeyStore.getInstance(KeyStore.getDefaultType());\r\n            try (InputStream in = new FileInputStream(keystoreLocation)) {\r\n                keystore.load(in, keystorePassword.toCharArray());\r\n            }\r\n            final KeyManagerFactory keyManagerFactory =\r\n                    KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());\r\n            keyManagerFactory.init(keystore, keyPassword.toCharArray());\r\n    \r\n            final SSLContext sslContext = SSLContext.getInstance(&quot;TLS&quot;);\r\n            sslContext.init(keyManagerFactory.getKeyManagers(), trustCheckedCertificates, new SecureRandom());\r\n    \r\n            return sslContext;\r\n        }\r\n\r\n\r\nMessage sending:\r\n\r\n \r\n\r\n    final RequestCallback requestCallback = new RequestCallback() {\r\n                    @Override\r\n                    public void doWithRequest(ClientHttpRequest clientHttpRequest) throws IOException {\r\n                        IOUtils.copy(request.getInputStream(), clientHttpRequest.getBody());\r\n    \r\n                    }\r\n                };\r\n    \r\n                ResponseEntity&lt;String&gt; responseEntity;\r\n    \r\n                    responseEntity = restTemplate.execute(clientApi, HttpMethod.POST,\r\n                            requestCallback, restTemplate.responseEntityExtractor(String.class));\r\n    }\r\n\r\n","title":"POST request with unbuffered RestTemplate and sslcontext customization","body":"<p>Using Spring RestTemplate I try to send a large stream to a server.\nThan I receive <strong>getBody not supported</strong> error.\nIf I do it with SimpleClientHttpRequestFactory it works normally, but I can't make my own sslcontext, that I need. What am I doing wrong and how can I fix it?</p>\n<p>I use spring boot 2.6.4, if it's important.</p>\n<p>Code samples:</p>\n<p>RestTemplate creation:</p>\n<pre><code>public RestTemplate configureSSLRestTemplate(final String keystoreLocation,\n                                                 final String keystorePassword,\n                                                 final String keyPassword,\n                                                 final int requestTimeout) throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException, UnrecoverableKeyException, KeyManagementException {\n        final HttpClient httpClient = httpClientConfiguration(keystoreLocation, keystorePassword, keyPassword);\n\n        final HttpComponentsClientHttpRequestFactory customRequestFactory = new HttpComponentsClientHttpRequestFactory(httpClient);\n\n            customRequestFactory.setBufferRequestBody(false);\n            customRequestFactory.setConnectTimeout(requestTimeout);\n            customRequestFactory.setReadTimeout(requestTimeout);\n            customRequestFactory.setConnectionRequestTimeout(requestTimeout);\n        \n\n        return new RestTemplate(customRequestFactory);\n\n    }\n\n    private CloseableHttpClient httpClientConfiguration(final String keystoreLocation,\n                                                        final String keystorePassword,\n                                                        final String keyPassword) throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException, UnrecoverableKeyException, KeyManagementException {\n        final TrustManager[] trustCheckedCertificates = new TrustManager[]{new X509TrustManager() {\n            public X509Certificate[] getAcceptedIssuers() {\n                return new X509Certificate[0];\n            }\n\n            public void checkClientTrusted(final X509Certificate[] certs, String authType) {\n            }\n\n            public void checkServerTrusted(final X509Certificate[] certs, String authType) throws CertificateException {\n\n                if (!certificateValidatorService.validateCertificate(certs[0], false)) {\n                    throw new CertificateException(&quot;Server certificate is wrong&quot;); //TODO\n                }\n            }\n        }};\n\n        final SSLContext sslContext = configureSSLContext(keystoreLocation, keystorePassword, keyPassword, trustCheckedCertificates);\n\n        return HttpClients.custom().setSSLContext(sslContext)\n                .setSSLHostnameVerifier(NoopHostnameVerifier.INSTANCE).build();\n    }\n\n    public SSLContext configureSSLContext(final String keystoreLocation,\n                                          final String keystorePassword,\n                                          final String keyPassword,\n                                          final TrustManager[] trustCheckedCertificates) throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException, UnrecoverableKeyException, KeyManagementException {\n        final KeyStore keystore = KeyStore.getInstance(KeyStore.getDefaultType());\n        try (InputStream in = new FileInputStream(keystoreLocation)) {\n            keystore.load(in, keystorePassword.toCharArray());\n        }\n        final KeyManagerFactory keyManagerFactory =\n                KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());\n        keyManagerFactory.init(keystore, keyPassword.toCharArray());\n\n        final SSLContext sslContext = SSLContext.getInstance(&quot;TLS&quot;);\n        sslContext.init(keyManagerFactory.getKeyManagers(), trustCheckedCertificates, new SecureRandom());\n\n        return sslContext;\n    }\n</code></pre>\n<p>Message sending:</p>\n<pre><code>final RequestCallback requestCallback = new RequestCallback() {\n                @Override\n                public void doWithRequest(ClientHttpRequest clientHttpRequest) throws IOException {\n                    IOUtils.copy(request.getInputStream(), clientHttpRequest.getBody());\n\n                }\n            };\n\n            ResponseEntity&lt;String&gt; responseEntity;\n\n                responseEntity = restTemplate.execute(clientApi, HttpMethod.POST,\n                        requestCallback, restTemplate.responseEntityExtractor(String.class));\n}\n</code></pre>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":108033,"reputation":17201,"user_id":286934,"display_name":"Progman"},"score":2,"creation_date":1681048483,"post_id":75970922,"comment_id":133993119,"body_markdown":"Class names should begin in uppercase, so they don&#39;t get confused with variable names, which start in lowercase.","body":"Class names should begin in uppercase, so they don&#39;t get confused with variable names, which start in lowercase."},{"owner":{"account_id":22604872,"reputation":2005,"user_id":16785907,"display_name":"Mikhail2048"},"score":0,"creation_date":1681055892,"post_id":75970922,"comment_id":133994123,"body_markdown":"What JDBC driver are you using?","body":"What JDBC driver are you using?"},{"owner":{"account_id":28257257,"reputation":1,"user_id":21602534,"display_name":"java player"},"score":0,"creation_date":1681313454,"post_id":75970922,"comment_id":134037116,"body_markdown":"&quot;org.postgresql.Driver&quot; type4 driver of postgres","body":"&quot;org.postgresql.Driver&quot; type4 driver of postgres"}],"owner":{"account_id":28257257,"reputation":1,"user_id":21602534,"display_name":"java player"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":22,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681049250,"creation_date":1681048259,"question_id":75970922,"body_markdown":"```\r\npackage jdbc1;\r\n\r\nimport java.sql.Connection;\r\nimport java.sql.DriverManager;\r\nimport java.sql.ResultSet;\r\nimport java.sql.SQLException;\r\nimport java.sql.Statement;\r\nimport java.util.concurrent.CountDownLatch;\r\n\r\n\r\npublic class scrollable extends Thread{\r\n\t \r\n\r\n\t   \r\n\tpublic void run()\r\n\t{\r\n\t\ttry {\r\n\t\t\tClass.forName(&quot;org.postgresql.Driver&quot;);\r\n\t\t} catch (ClassNotFoundException e) {\r\n\t\t\t// TODO Auto-generated catch block\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t\t\r\n\t\ttry {\r\n\t\t\tConnection cn1 = DriverManager.getConnection(&quot;jdbc:postgresql://localhost:5432/postgres&quot;,&quot;postgres&quot;,&quot;123456&quot;);\r\n\t\t\tStatement st=cn1.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);\r\n\t\t\tst.executeUpdate(&quot;update emp set ename=&#39;BLAKE2&#39; where empno=7698&quot;);\r\n\t\t\t\r\n\t\t\tst.close();\r\n\t\t} catch (SQLException e) {\r\n\t\t\t// TODO Auto-generated catch block\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\r\n\t\t\r\n\t}\r\n\tpublic static void main(String[] args) throws ClassNotFoundException, SQLException, InterruptedException {\r\n\t\t\r\n\t\tClass.forName(&quot;org.postgresql.Driver&quot;);\r\n\t\tConnection cn=DriverManager.getConnection(&quot;jdbc:postgresql://localhost:5432/postgres&quot;,&quot;postgres&quot;,&quot;123456&quot;);\r\n\t\tStatement st=cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);\t\r\n\t\tResultSet rs1=st.executeQuery(&quot;select * from emp&quot;);\r\n\t\tint i=0;\r\n\t\twhile(rs1.next())\r\n\t\t{\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tif(i==5)\r\n\t\t\t{\r\n\t\t\t\t\r\n\t\t\tscrollable obj=new scrollable();\r\n\t\t\tobj.start();\r\n\t\t\tobj.join();\r\n\t\t\trs1.last();\r\n\t\t\trs1.refreshRow();\r\n\t\t\t\r\n\t\t\t}\r\n\t\t\tSystem.out.println(rs1.getObject(1)+&quot; &quot;+rs1.getString(2));\r\n\t\t\ti++;\r\n\t\t}\r\n\t\trs1.close();\r\n    }\r\n}\r\n```\r\n\r\nI used `ResultSet.TYPE_SCROLL_INSENSITIVE` in my code and updated the table. Now after refreshing row I should get old values right? But I am getting new values. Here thread is updating table after that I refreshed the row as per insensitive it should not get refreshed and give old values right?\r\n\r\n\r\n\r\n\r\n\r\n","title":"why am i getting updated values of table even after using scroll insensitive?","body":"<pre><code>package jdbc1;\n\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.sql.Statement;\nimport java.util.concurrent.CountDownLatch;\n\n\npublic class scrollable extends Thread{\n     \n\n       \n    public void run()\n    {\n        try {\n            Class.forName(&quot;org.postgresql.Driver&quot;);\n        } catch (ClassNotFoundException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n        \n        try {\n            Connection cn1 = DriverManager.getConnection(&quot;jdbc:postgresql://localhost:5432/postgres&quot;,&quot;postgres&quot;,&quot;123456&quot;);\n            Statement st=cn1.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);\n            st.executeUpdate(&quot;update emp set ename='BLAKE2' where empno=7698&quot;);\n            \n            st.close();\n        } catch (SQLException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n\n        \n    }\n    public static void main(String[] args) throws ClassNotFoundException, SQLException, InterruptedException {\n        \n        Class.forName(&quot;org.postgresql.Driver&quot;);\n        Connection cn=DriverManager.getConnection(&quot;jdbc:postgresql://localhost:5432/postgres&quot;,&quot;postgres&quot;,&quot;123456&quot;);\n        Statement st=cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);  \n        ResultSet rs1=st.executeQuery(&quot;select * from emp&quot;);\n        int i=0;\n        while(rs1.next())\n        {\n            \n            \n            if(i==5)\n            {\n                \n            scrollable obj=new scrollable();\n            obj.start();\n            obj.join();\n            rs1.last();\n            rs1.refreshRow();\n            \n            }\n            System.out.println(rs1.getObject(1)+&quot; &quot;+rs1.getString(2));\n            i++;\n        }\n        rs1.close();\n    }\n}\n</code></pre>\n<p>I used <code>ResultSet.TYPE_SCROLL_INSENSITIVE</code> in my code and updated the table. Now after refreshing row I should get old values right? But I am getting new values. Here thread is updating table after that I refreshed the row as per insensitive it should not get refreshed and give old values right?</p>\n"},{"tags":["java","unit-testing","mockito","testng"],"answers":[{"tags":[],"owner":{"account_id":17520379,"reputation":1536,"user_id":12706564,"display_name":"Emanuel Trandafir"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1681049249,"creation_date":1681049249,"answer_id":75971009,"question_id":75970925,"body_markdown":"the problem is that you are not passing the mocked `externalApiConfig` to the  tested class `CisRestBaseService`. To fix this, you can, for example, define it it as a constructor argument (you can keep the current constructor as well if needed). \r\n\r\n    public CisRestBaseService(CisApiConfig config) {\r\n        JacksonJsonProvider jacksonJsonProvider = new JacksonJaxbJsonProvider()\r\n                .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false)\r\n                .configure(DeserializationFeature.ADJUST_DATES_TO_CONTEXT_TIME_ZONE, false);\r\n    \r\n        Client jaxRsClient = ClientBuilder.newClient().register(jacksonJsonProvider);\r\n        this.externalApiConfig = config;\r\n        this.rootWebTarget = jaxRsClient.target(externalApiConfig.getExternalUrl());\r\n    }\r\n\r\n    public CisRestBaseService() {\r\n        this(new CisApiConfig());\r\n    }\r\n\r\nNot, from the test, you can instantiate the service like this:\r\n\r\n    Mockito.when(externalApiConfig.getExternalUrl()).thenReturn(&quot;http://localhost:8080/serviceURI/&quot;);\r\n    cisAccoutService = new CisAccountServiceImpl(externalApiConfig);\r\n\r\nAs a result, your service under test will use the mock instead of creating a real config object.This technique is called &quot;dependency injection&quot;, you can read more about it here: https://www.digitalocean.com/community/tutorials/java-dependency-injection-design-pattern-example-tutorial\r\n","title":"Mockito mock a method calls actual method","body":"<p>the problem is that you are not passing the mocked <code>externalApiConfig</code> to the  tested class <code>CisRestBaseService</code>. To fix this, you can, for example, define it it as a constructor argument (you can keep the current constructor as well if needed).</p>\n<pre><code>public CisRestBaseService(CisApiConfig config) {\n    JacksonJsonProvider jacksonJsonProvider = new JacksonJaxbJsonProvider()\n            .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false)\n            .configure(DeserializationFeature.ADJUST_DATES_TO_CONTEXT_TIME_ZONE, false);\n\n    Client jaxRsClient = ClientBuilder.newClient().register(jacksonJsonProvider);\n    this.externalApiConfig = config;\n    this.rootWebTarget = jaxRsClient.target(externalApiConfig.getExternalUrl());\n}\n\npublic CisRestBaseService() {\n    this(new CisApiConfig());\n}\n</code></pre>\n<p>Not, from the test, you can instantiate the service like this:</p>\n<pre><code>Mockito.when(externalApiConfig.getExternalUrl()).thenReturn(&quot;http://localhost:8080/serviceURI/&quot;);\ncisAccoutService = new CisAccountServiceImpl(externalApiConfig);\n</code></pre>\n<p>As a result, your service under test will use the mock instead of creating a real config object.This technique is called &quot;dependency injection&quot;, you can read more about it here: <a href=\"https://www.digitalocean.com/community/tutorials/java-dependency-injection-design-pattern-example-tutorial\" rel=\"nofollow noreferrer\">https://www.digitalocean.com/community/tutorials/java-dependency-injection-design-pattern-example-tutorial</a></p>\n"}],"owner":{"account_id":503016,"reputation":111,"user_id":1049141,"accept_rate":50,"display_name":"user82504"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":82,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75971009,"answer_count":1,"score":0,"last_activity_date":1681049249,"creation_date":1681048297,"question_id":75970925,"body_markdown":"I have been trying to mock a method of a class. The method is reading a configuration from file. The file consists of a URI of a service. Method is reading URI from file and creating a WebTarget object. I have been running a testng mockito test case and I am trying to return a string from a mock method when this method is called. Problem is whenever this method is called then actual method is called and it tries to read the file. However, (Correct me if I am wrong) it should not call the actual method and returns the mocked response. Somehow, it is not working. Below is the code for the test\r\n\r\n    @Mock\r\n    private ExternalApiConfig externalApiConfig = null;\r\n    public CisAccountServiceImpl cisAccoutService;\r\n    \r\n    @BeforeMethod\r\n    public void init() {\r\n        MockitoAnnotations.initMocks(this);\r\n        externalApiConfig = Mockito.mock(CisApiConfig.class);\r\n    }\r\n\r\n    private void testUpdateServiceAddressCoordinates(Account account) throws IOException {\r\n\t\tMockito.when(externalApiConfig.getExternalUrl()).thenReturn(&quot;http://localhost:8080/serviceURI/&quot;);\r\n\t\tcisAccoutService = new CisAccountServiceImpl();\r\n\t\tassertThat(account, is(notNullValue()));\r\n\t\tList&lt;PremiseExtension&gt; premiseExtensions = account.getPremise().getPremiseExtension();\r\n\t\tassertThat(premiseExtensions.size(), is(30));\r\n\t\tString geoXSettingName = &quot;value2&quot;;\r\n\t\tString geoYSettingName = &quot;value3&quot;;\r\n\t\tDouble lat = 24.0;\r\n\t\tDouble lng = -98.0;\r\n\t\tboolean updated = cisAccoutService.updateAccountGeoLocation(accountId,\r\n\t\t\t\tlat, lng, geoXSettingName, geoYSettingName);\r\n\t\tassertThat(true, is(updated));\r\n\t\tAccount updatedAccount = getAccountById();\r\n\t\tassertThat(Double.parseDouble(updatedAccount.getPremise().getPremiseExtension().get(2).getValue()), is(equals(lat)));\r\n\t\tassertThat(Double.parseDouble(updatedAccount.getPremise().getPremiseExtension().get(3).getValue()), is(equals(lng)));\r\n\t\t//rollback the change\r\n\t\tupdatedAccount.getPremise().setPremiseExtension(premiseExtensions);\r\n\t\tupdateAccountWithValues(updatedAccount);\r\n\t}\r\n\r\nThe method I want to mock is externalApiConfig.getExternalUrl() in following code\r\n\r\n    public class CisRestBaseService {\r\n\r\n    protected WebTarget rootWebTarget;\r\n    protected ExternalApiConfig externalApiConfig;\r\n\r\n    public CisRestBaseService() {\r\n        JacksonJsonProvider jacksonJsonProvider = new JacksonJaxbJsonProvider()\r\n                .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false)\r\n                .configure(DeserializationFeature.ADJUST_DATES_TO_CONTEXT_TIME_ZONE, false);\r\n\r\n        Client jaxRsClient = ClientBuilder.newClient().register(jacksonJsonProvider);\r\n        this.externalApiConfig = new CisApiConfig();\r\n        this.rootWebTarget = jaxRsClient.target(externalApiConfig.getExternalUrl());\r\n    }\r\n}\r\n\r\nAny help would be much appreciated.","title":"Mockito mock a method calls actual method","body":"<p>I have been trying to mock a method of a class. The method is reading a configuration from file. The file consists of a URI of a service. Method is reading URI from file and creating a WebTarget object. I have been running a testng mockito test case and I am trying to return a string from a mock method when this method is called. Problem is whenever this method is called then actual method is called and it tries to read the file. However, (Correct me if I am wrong) it should not call the actual method and returns the mocked response. Somehow, it is not working. Below is the code for the test</p>\n<pre><code>@Mock\nprivate ExternalApiConfig externalApiConfig = null;\npublic CisAccountServiceImpl cisAccoutService;\n\n@BeforeMethod\npublic void init() {\n    MockitoAnnotations.initMocks(this);\n    externalApiConfig = Mockito.mock(CisApiConfig.class);\n}\n\nprivate void testUpdateServiceAddressCoordinates(Account account) throws IOException {\n    Mockito.when(externalApiConfig.getExternalUrl()).thenReturn(&quot;http://localhost:8080/serviceURI/&quot;);\n    cisAccoutService = new CisAccountServiceImpl();\n    assertThat(account, is(notNullValue()));\n    List&lt;PremiseExtension&gt; premiseExtensions = account.getPremise().getPremiseExtension();\n    assertThat(premiseExtensions.size(), is(30));\n    String geoXSettingName = &quot;value2&quot;;\n    String geoYSettingName = &quot;value3&quot;;\n    Double lat = 24.0;\n    Double lng = -98.0;\n    boolean updated = cisAccoutService.updateAccountGeoLocation(accountId,\n            lat, lng, geoXSettingName, geoYSettingName);\n    assertThat(true, is(updated));\n    Account updatedAccount = getAccountById();\n    assertThat(Double.parseDouble(updatedAccount.getPremise().getPremiseExtension().get(2).getValue()), is(equals(lat)));\n    assertThat(Double.parseDouble(updatedAccount.getPremise().getPremiseExtension().get(3).getValue()), is(equals(lng)));\n    //rollback the change\n    updatedAccount.getPremise().setPremiseExtension(premiseExtensions);\n    updateAccountWithValues(updatedAccount);\n}\n</code></pre>\n<p>The method I want to mock is externalApiConfig.getExternalUrl() in following code</p>\n<pre><code>public class CisRestBaseService {\n\nprotected WebTarget rootWebTarget;\nprotected ExternalApiConfig externalApiConfig;\n\npublic CisRestBaseService() {\n    JacksonJsonProvider jacksonJsonProvider = new JacksonJaxbJsonProvider()\n            .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false)\n            .configure(DeserializationFeature.ADJUST_DATES_TO_CONTEXT_TIME_ZONE, false);\n\n    Client jaxRsClient = ClientBuilder.newClient().register(jacksonJsonProvider);\n    this.externalApiConfig = new CisApiConfig();\n    this.rootWebTarget = jaxRsClient.target(externalApiConfig.getExternalUrl());\n}\n</code></pre>\n<p>}</p>\n<p>Any help would be much appreciated.</p>\n"},{"tags":["java","rest","jakarta-ee","jax-rs"],"comments":[{"owner":{"account_id":16878,"reputation":306143,"user_id":37213,"accept_rate":81,"display_name":"duffymo"},"score":1,"creation_date":1681048136,"post_id":75970894,"comment_id":133993074,"body_markdown":"HTTP 404 means your URL isn&#39;t correct.  Check each contribution carefully.  Ask Tomcat what endpoints it exposes.","body":"HTTP 404 means your URL isn&#39;t correct.  Check each contribution carefully.  Ask Tomcat what endpoints it exposes."},{"owner":{"account_id":12743722,"reputation":19966,"user_id":12567365,"display_name":"andrewJames"},"score":1,"creation_date":1681071414,"post_id":75970894,"comment_id":133996052,"body_markdown":"You are using Tomcat 9. That expects to use the Servlet 4.0 specification (required by the Java EE 8 platform). However, your POM is using the Jakarta EE 10 artifact, so you have downloaded the Servlet 6.0 specification. For this you need to be using Tomcat 10.1.x. See the [Apache Tomcat Versions](https://tomcat.apache.org/whichversion.html) guide. Upgrade your Tomcat. (I&#39;m not claiming this will fix your 404 error, though.)","body":"You are using Tomcat 9. That expects to use the Servlet 4.0 specification (required by the Java EE 8 platform). However, your POM is using the Jakarta EE 10 artifact, so you have downloaded the Servlet 6.0 specification. For this you need to be using Tomcat 10.1.x. See the <a href=\"https://tomcat.apache.org/whichversion.html\" rel=\"nofollow noreferrer\">Apache Tomcat Versions</a> guide. Upgrade your Tomcat. (I&#39;m not claiming this will fix your 404 error, though.)"},{"owner":{"account_id":12743722,"reputation":19966,"user_id":12567365,"display_name":"andrewJames"},"score":0,"creation_date":1681072263,"post_id":75970894,"comment_id":133996161,"body_markdown":"One other thing: Do you actually want to use the RESTEasy implementation of JAX-RS (given the title of your project)? I don&#39;t see that in your POM.","body":"One other thing: Do you actually want to use the RESTEasy implementation of JAX-RS (given the title of your project)? I don&#39;t see that in your POM."},{"owner":{"account_id":3013228,"reputation":205797,"user_id":2587435,"accept_rate":88,"display_name":"Paul Samsotha"},"score":0,"creation_date":1681137945,"post_id":75970894,"comment_id":134004350,"body_markdown":"Apart from the Jakarta/Tomcat9 issue, you don&#39;t even have a JAX-RS _implementation_. Tomcat is not an EE server. It will not have an implementation. So you need to add one.","body":"Apart from the Jakarta/Tomcat9 issue, you don&#39;t even have a JAX-RS <i>implementation</i>. Tomcat is not an EE server. It will not have an implementation. So you need to add one."},{"owner":{"account_id":3013228,"reputation":205797,"user_id":2587435,"accept_rate":88,"display_name":"Paul Samsotha"},"score":0,"creation_date":1681137961,"post_id":75970894,"comment_id":134004354,"body_markdown":"Also, whet does this even mean? _&quot;when i do the same example for resteasy-jaxrs 3.1.3.final it works but that doesn&#39;t work.&quot;_","body":"Also, whet does this even mean? <i>&quot;when i do the same example for resteasy-jaxrs 3.1.3.final it works but that doesn&#39;t work.&quot;</i>"}],"owner":{"account_id":20554757,"reputation":21,"user_id":15086619,"display_name":"batchu"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":614,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":0,"score":2,"last_activity_date":1681047958,"creation_date":1681047914,"question_id":75970894,"body_markdown":"MyApplication.java\r\n\r\n```\r\npackage service;\r\n\r\nimport java.util.HashSet;\r\nimport java.util.Set;\r\n\r\nimport jakarta.ws.rs.ApplicationPath;\r\nimport jakarta.ws.rs.core.Application;\r\n\r\n@ApplicationPath(&quot;/app&quot;)\r\npublic class MyApplication extends Application{\r\n\r\n\tSet&lt;Object&gt; singletons = new HashSet&lt;&gt;();\r\n\t\r\n\tpublic MyApplication(){\r\n\t\tsingletons.add(new HelloResource());\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic Set&lt;Object&gt; getSingletons() {\r\n\t\treturn singletons;\r\n\t}\r\n}\r\n```\r\n\r\nHelloResource.java\r\n\r\n```\r\npackage service;\r\n\r\nimport jakarta.ws.rs.GET;\r\nimport jakarta.ws.rs.Path;\r\nimport jakarta.ws.rs.Produces;\r\nimport jakarta.ws.rs.core.MediaType;\r\n\r\n@Path(&quot;/hello&quot;)\r\npublic class HelloResource {\r\n\r\n\t@GET\r\n\t@Produces(MediaType.TEXT_PLAIN)\r\n\tpublic String getHello() {\r\n\t\treturn &quot;HELLO&quot;;\r\n\t}\r\n}\r\n```\r\n\r\npom.xml\r\n\r\n```\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n  &lt;groupId&gt;Resteasy-examples&lt;/groupId&gt;\r\n  &lt;artifactId&gt;Resteasy-examples&lt;/artifactId&gt;\r\n  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\r\n  &lt;packaging&gt;war&lt;/packaging&gt;\r\n  \r\n  &lt;dependencies&gt;\r\n\t  \t&lt;dependency&gt;\r\n\t\t    &lt;groupId&gt;jakarta.platform&lt;/groupId&gt;\r\n\t\t    &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt;\r\n\t\t    &lt;version&gt;10.0.0&lt;/version&gt;\r\n\t\t    &lt;scope&gt;provided&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n  &lt;/dependencies&gt;\r\n  \r\n  &lt;build&gt;\r\n    &lt;plugins&gt;\r\n      &lt;plugin&gt;\r\n        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\r\n        &lt;version&gt;3.8.1&lt;/version&gt;\r\n        &lt;configuration&gt;\r\n          &lt;release&gt;17&lt;/release&gt;\r\n        &lt;/configuration&gt;\r\n      &lt;/plugin&gt;\r\n      &lt;plugin&gt;\r\n        &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;\r\n        &lt;version&gt;3.2.3&lt;/version&gt;\r\n      &lt;/plugin&gt;\r\n    &lt;/plugins&gt;\r\n  &lt;/build&gt;\r\n&lt;/project&gt;\r\n```\r\n\r\nI go to this address http://localhost:8080/Resteasy-examples/app/hello and\r\n\r\n# HTTP Status 404 – Not Found\r\n\r\n----------\r\n\r\n**Type** Status Report\r\n\r\n**Message** The requested resource \\[/Resteasy-examples/app/hello\\] is not available\r\n\r\n**Description** The origin server did not find a current representation for the target resource or is not willing to disclose that one exists.\r\n\r\n----------\r\n\r\n### Apache Tomcat/9.0.73\r\n\r\nwhen i do the same example for resteasy-jaxrs 3.1.3.final it works but that doesn&#39;t work.\r\n","title":"Jakarta EE 10 REST API returns 404 not found error","body":"<p>MyApplication.java</p>\n<pre><code>package service;\n\nimport java.util.HashSet;\nimport java.util.Set;\n\nimport jakarta.ws.rs.ApplicationPath;\nimport jakarta.ws.rs.core.Application;\n\n@ApplicationPath(&quot;/app&quot;)\npublic class MyApplication extends Application{\n\n    Set&lt;Object&gt; singletons = new HashSet&lt;&gt;();\n    \n    public MyApplication(){\n        singletons.add(new HelloResource());\n    }\n    \n    @Override\n    public Set&lt;Object&gt; getSingletons() {\n        return singletons;\n    }\n}\n</code></pre>\n<p>HelloResource.java</p>\n<pre><code>package service;\n\nimport jakarta.ws.rs.GET;\nimport jakarta.ws.rs.Path;\nimport jakarta.ws.rs.Produces;\nimport jakarta.ws.rs.core.MediaType;\n\n@Path(&quot;/hello&quot;)\npublic class HelloResource {\n\n    @GET\n    @Produces(MediaType.TEXT_PLAIN)\n    public String getHello() {\n        return &quot;HELLO&quot;;\n    }\n}\n</code></pre>\n<p>pom.xml</p>\n<pre><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n  &lt;groupId&gt;Resteasy-examples&lt;/groupId&gt;\n  &lt;artifactId&gt;Resteasy-examples&lt;/artifactId&gt;\n  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n  &lt;packaging&gt;war&lt;/packaging&gt;\n  \n  &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;jakarta.platform&lt;/groupId&gt;\n            &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt;\n            &lt;version&gt;10.0.0&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n  &lt;/dependencies&gt;\n  \n  &lt;build&gt;\n    &lt;plugins&gt;\n      &lt;plugin&gt;\n        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n        &lt;version&gt;3.8.1&lt;/version&gt;\n        &lt;configuration&gt;\n          &lt;release&gt;17&lt;/release&gt;\n        &lt;/configuration&gt;\n      &lt;/plugin&gt;\n      &lt;plugin&gt;\n        &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;\n        &lt;version&gt;3.2.3&lt;/version&gt;\n      &lt;/plugin&gt;\n    &lt;/plugins&gt;\n  &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n<p>I go to this address http://localhost:8080/Resteasy-examples/app/hello and</p>\n<h1>HTTP Status 404 – Not Found</h1>\n<hr />\n<p><strong>Type</strong> Status Report</p>\n<p><strong>Message</strong> The requested resource [/Resteasy-examples/app/hello] is not available</p>\n<p><strong>Description</strong> The origin server did not find a current representation for the target resource or is not willing to disclose that one exists.</p>\n<hr />\n<h3>Apache Tomcat/9.0.73</h3>\n<p>when i do the same example for resteasy-jaxrs 3.1.3.final it works but that doesn't work.</p>\n"},{"tags":["java","stream","java-stream"],"comments":[{"owner":{"account_id":21724606,"reputation":722,"user_id":16034206,"display_name":"experiment unit 1998X"},"score":0,"creation_date":1680598705,"post_id":75926572,"comment_id":133921309,"body_markdown":"Can I ask `class.stream()` is your original &#39;class&#39; variable a Map or is it a list?","body":"Can I ask <code>class.stream()</code> is your original &#39;class&#39; variable a Map or is it a list?"}],"answers":[{"tags":[],"owner":{"account_id":22141394,"reputation":21,"user_id":16391366,"display_name":"Abdelilah Razzouk"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681047944,"creation_date":1680594736,"answer_id":75926803,"question_id":75926572,"body_markdown":"Just like @Sametcey suggested you can use `flatMap`.&lt;br&gt; Whenever you encounter something that uses nested lists (just like your `Map&lt;String, List&lt;List&gt;&gt;`, but it&#39;s possible to use it on deeper level like `Map&lt;String, List&lt;List&lt;List&gt;&gt;&gt;`) `flatMap` will help you with that.\r\n\r\nIt will transform your stream into a single flattened stream. In other words: one list that you can access and manipulate.","title":"How to Convert a Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt; to Map&lt;String, List&lt;String&gt;&gt; in java 8 functional APIs","body":"<p>Just like @Sametcey suggested you can use <code>flatMap</code>.<br> Whenever you encounter something that uses nested lists (just like your <code>Map&lt;String, List&lt;List&gt;&gt;</code>, but it's possible to use it on deeper level like <code>Map&lt;String, List&lt;List&lt;List&gt;&gt;&gt;</code>) <code>flatMap</code> will help you with that.</p>\n<p>It will transform your stream into a single flattened stream. In other words: one list that you can access and manipulate.</p>\n"},{"tags":[],"owner":{"account_id":1251686,"reputation":29348,"user_id":1531054,"accept_rate":95,"display_name":"s.d"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1680600470,"creation_date":1680600470,"answer_id":75927724,"question_id":75926572,"body_markdown":"You can use the `Map` collector to group by keys and merge the values.\r\n\r\nExample (Java 14 &amp; above):\r\n```java\r\nclass Test {\r\n\r\n\t// sample data types\r\n\trecord Sub ( int type, String value ){}\r\n    record Clazz (String id, List&lt;Sub&gt; sub){}\r\n\r\n\tpublic static void main(String[] args)\r\n\t{\r\n\t\t// sample data\r\n\t\tList&lt;Clazz&gt; classes = List.of(\r\n\t\t\tnew Clazz(&quot;id1&quot;,List.of(new Sub(1,&quot;A&quot;),new Sub(2,&quot;B&quot;))),\r\n\t\t\tnew Clazz(&quot;id2&quot;,List.of(new Sub(3,&quot;C&quot;),new Sub(4,&quot;D&quot;))),\r\n\t\t\tnew Clazz(&quot;id1&quot;,List.of(new Sub(5,&quot;E&quot;),new Sub(6,&quot;A&quot;)))\r\n\t\t);\r\n\r\n\t\tMap&lt;String, List&lt;String&gt;&gt; map = classes.stream()\r\n\t\t\t.collect(Collectors.toMap(\r\n\t\t\t\t// key for new map: c.id\r\n\t\t\t\tc -&gt; c.id,\r\n\t\t\t\t\r\n\t\t\t\t// value for new map: c.sub[].value as a list\r\n\t\t\t\tc -&gt; c.sub.stream().map(s -&gt; s.value).toList(),\r\n\t\t\t\t\r\n\t\t\t\t// duplicate value merging (grouping) : merge two value lists, no duplicates\r\n\t\t\t\t(v1, v2) -&gt; Stream.concat(v1.stream(), v2.stream()).distinct().toList()\r\n\t\t\t));\r\n\r\n\t\t// print resulting data\r\n\t\tmap.forEach((k,v) -&gt; System.out.println(k + &quot;\\t-&gt;\\t&quot; + String.join(&quot;,&quot;, v)));\r\n\t}\r\n}\r\n\r\n```\r\n\r\nOutput:\r\n```text\r\nid2\t-&gt;\tC,D\r\nid1\t-&gt;\tA,B,E\r\n```","title":"How to Convert a Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt; to Map&lt;String, List&lt;String&gt;&gt; in java 8 functional APIs","body":"<p>You can use the <code>Map</code> collector to group by keys and merge the values.</p>\n<p>Example (Java 14 &amp; above):</p>\n<pre class=\"lang-java prettyprint-override\"><code>class Test {\n\n    // sample data types\n    record Sub ( int type, String value ){}\n    record Clazz (String id, List&lt;Sub&gt; sub){}\n\n    public static void main(String[] args)\n    {\n        // sample data\n        List&lt;Clazz&gt; classes = List.of(\n            new Clazz(&quot;id1&quot;,List.of(new Sub(1,&quot;A&quot;),new Sub(2,&quot;B&quot;))),\n            new Clazz(&quot;id2&quot;,List.of(new Sub(3,&quot;C&quot;),new Sub(4,&quot;D&quot;))),\n            new Clazz(&quot;id1&quot;,List.of(new Sub(5,&quot;E&quot;),new Sub(6,&quot;A&quot;)))\n        );\n\n        Map&lt;String, List&lt;String&gt;&gt; map = classes.stream()\n            .collect(Collectors.toMap(\n                // key for new map: c.id\n                c -&gt; c.id,\n                \n                // value for new map: c.sub[].value as a list\n                c -&gt; c.sub.stream().map(s -&gt; s.value).toList(),\n                \n                // duplicate value merging (grouping) : merge two value lists, no duplicates\n                (v1, v2) -&gt; Stream.concat(v1.stream(), v2.stream()).distinct().toList()\n            ));\n\n        // print resulting data\n        map.forEach((k,v) -&gt; System.out.println(k + &quot;\\t-&gt;\\t&quot; + String.join(&quot;,&quot;, v)));\n    }\n}\n\n</code></pre>\n<p>Output:</p>\n<pre><code>id2 -&gt;  C,D\nid1 -&gt;  A,B,E\n</code></pre>\n"}],"owner":{"account_id":28210376,"reputation":1,"user_id":21562759,"display_name":"Alex"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":204,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1681047944,"creation_date":1680593138,"question_id":75926572,"body_markdown":"I have a class like this;\r\n\r\n```\r\nclass: {\r\n   id: &quot;&quot;,\r\n   sub: [{\r\n       type: 1,\r\n       value: &quot;&quot;\r\n   }]\r\n}\r\n```\r\n\r\nNow, I want group class first by id;\r\n\r\n\r\n```java\r\nclass.stream().collect(Collectors.groupingBy(class::id))\r\n```\r\n\r\nThen I want flat sub-value to a `List&lt;String&gt;`, I have the following:\r\n\r\n\r\n```java\r\nclass.stream().collect(Collectors.groupingBy(class::id,\r\n  Collectors.mapping(e -&gt;\r\n    e.sub().stream()\r\n      .filter(v -&gt; v.type().equals(1))\r\n       .map(sub::value),\r\n    Collectors.toList()\r\n  )))\r\n```\r\n\r\nIt returns a `Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt;`\r\n\r\nSo, how can I convert a `Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt;` to `Map&lt;String, List&lt;String&gt;&gt;` using the Java 8 functional API?","title":"How to Convert a Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt; to Map&lt;String, List&lt;String&gt;&gt; in java 8 functional APIs","body":"<p>I have a class like this;</p>\n<pre><code>class: {\n   id: &quot;&quot;,\n   sub: [{\n       type: 1,\n       value: &quot;&quot;\n   }]\n}\n</code></pre>\n<p>Now, I want group class first by id;</p>\n<pre class=\"lang-java prettyprint-override\"><code>class.stream().collect(Collectors.groupingBy(class::id))\n</code></pre>\n<p>Then I want flat sub-value to a <code>List&lt;String&gt;</code>, I have the following:</p>\n<pre class=\"lang-java prettyprint-override\"><code>class.stream().collect(Collectors.groupingBy(class::id,\n  Collectors.mapping(e -&gt;\n    e.sub().stream()\n      .filter(v -&gt; v.type().equals(1))\n       .map(sub::value),\n    Collectors.toList()\n  )))\n</code></pre>\n<p>It returns a <code>Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt;</code></p>\n<p>So, how can I convert a <code>Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt;</code> to <code>Map&lt;String, List&lt;String&gt;&gt;</code> using the Java 8 functional API?</p>\n"},{"tags":["java","maven","aws-sdk"],"comments":[{"owner":{"account_id":100740,"reputation":73227,"user_id":271415,"accept_rate":91,"display_name":"jarmod"},"score":1,"creation_date":1680710771,"post_id":75941645,"comment_id":133945518,"body_markdown":"Be aware of [BOM recommendation](https://github.com/aws/aws-sdk-java-v2#importing-the-bom) and [issues/884](https://github.com/awsdocs/aws-doc-sdk-examples/issues/884).","body":"Be aware of <a href=\"https://github.com/aws/aws-sdk-java-v2#importing-the-bom\" rel=\"nofollow noreferrer\">BOM recommendation</a> and <a href=\"https://github.com/awsdocs/aws-doc-sdk-examples/issues/884\" rel=\"nofollow noreferrer\">issues/884</a>."}],"answers":[{"tags":[],"owner":{"account_id":4853784,"reputation":195,"user_id":3915399,"accept_rate":33,"display_name":"BlueBucket7"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681047512,"creation_date":1681047512,"answer_id":75970865,"question_id":75941645,"body_markdown":"What ended up helping me was the `maven-assembly-plugin`. This will create a JAR with all of the dependencies bundled.\r\n\r\n```\r\n           &lt;plugin&gt;\r\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n                &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\r\n                &lt;executions&gt;\r\n                    &lt;execution&gt;\r\n                        &lt;phase&gt;package&lt;/phase&gt;\r\n                        &lt;goals&gt;\r\n                            &lt;goal&gt;single&lt;/goal&gt;\r\n                        &lt;/goals&gt;\r\n                    &lt;/execution&gt;\r\n                &lt;/executions&gt;\r\n                &lt;configuration&gt;\r\n                    &lt;descriptorRefs&gt;\r\n                        &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;\r\n                    &lt;/descriptorRefs&gt;\r\n                &lt;/configuration&gt;\r\n            &lt;/plugin&gt;\r\n```","title":"&quot;java.lang.ClassNotFoundException: software.amazon.awssdk.regions.Region&quot; error for JAR built via IntelliJ","body":"<p>What ended up helping me was the <code>maven-assembly-plugin</code>. This will create a JAR with all of the dependencies bundled.</p>\n<pre><code>           &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;phase&gt;package&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;single&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n                &lt;configuration&gt;\n                    &lt;descriptorRefs&gt;\n                        &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;\n                    &lt;/descriptorRefs&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n</code></pre>\n"}],"owner":{"account_id":4853784,"reputation":195,"user_id":3915399,"accept_rate":33,"display_name":"BlueBucket7"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":795,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1681047512,"creation_date":1680710405,"question_id":75941645,"body_markdown":"I&#39;m using IntelliJ to develop an AWS app (simply retrieves from SecretsManager). I&#39;m able to run the app fine in IntelliJ, but when I build a JAR artifact via IntelliJ and try to execute the JAR, I get `java.lang.ClassNotFoundException: software.amazon.awssdk.regions.Region`.\r\n\r\nI built the JAR via IntelliJ, but I use a `pom.xml` to specify the dependencies. When I try to execute the JAR, I get `java.lang.ClassNotFoundException: software.amazon.awssdk.regions.Region` error. I&#39;ve included this dependency as part of my `pom.xml`, and I have also verified that the JAR is extracting the &quot;software.amazon.awssdk.regions&quot; library.\r\n\r\nI have no idea why the JAR complains about &quot;ClassNotFoundException&quot;, when the class it&#39;s looking for is literally in the JAR?\r\n\r\nAny guidance is greatly appreciated!\r\n\r\nI&#39;ve included my `pom.xml` below:\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\r\n    &lt;groupId&gt;com.chronoslabs&lt;/groupId&gt;\r\n    &lt;artifactId&gt;chronos-trader&lt;/artifactId&gt;\r\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\r\n\r\n    &lt;dependencyManagement&gt;\r\n        &lt;dependencies&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n                &lt;artifactId&gt;bom&lt;/artifactId&gt;\r\n                &lt;version&gt;${aws.java.sdk.version}&lt;/version&gt;\r\n                &lt;type&gt;pom&lt;/type&gt;\r\n                &lt;scope&gt;import&lt;/scope&gt;\r\n            &lt;/dependency&gt;\r\n        &lt;/dependencies&gt;\r\n    &lt;/dependencyManagement&gt;\r\n    &lt;dependencies&gt;\r\n        &lt;!-- https://mvnrepository.com/artifact/org.jmockit/jmockit --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.jmockit&lt;/groupId&gt;\r\n            &lt;artifactId&gt;jmockit&lt;/artifactId&gt;\r\n            &lt;version&gt;1.49&lt;/version&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;io.github.binance&lt;/groupId&gt;\r\n            &lt;artifactId&gt;binance-connector-java&lt;/artifactId&gt;\r\n            &lt;version&gt;1.12.0&lt;/version&gt;\r\n            &lt;scope&gt;compile&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;!-- https://mvnrepository.com/artifact/com.google.code.gson/gson --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;\r\n            &lt;artifactId&gt;gson&lt;/artifactId&gt;\r\n            &lt;version&gt;2.9.1&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\r\n            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\r\n            &lt;version&gt;1.18.24&lt;/version&gt;\r\n            &lt;scope&gt;provided&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\r\n            &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;\r\n            &lt;version&gt;5.7.0&lt;/version&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.jmockit&lt;/groupId&gt;\r\n            &lt;artifactId&gt;jmockit&lt;/artifactId&gt;\r\n            &lt;version&gt;1.49&lt;/version&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;!-- https://mvnrepository.com/artifact/com.google.guava/guava --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;com.google.guava&lt;/groupId&gt;\r\n            &lt;artifactId&gt;guava&lt;/artifactId&gt;\r\n            &lt;version&gt;31.1-jre&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;!-- https://mvnrepository.com/artifact/org.knowm.xchange/xchange-core --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.knowm.xchange&lt;/groupId&gt;\r\n            &lt;artifactId&gt;xchange-core&lt;/artifactId&gt;\r\n            &lt;version&gt;5.0.14&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;!-- https://mvnrepository.com/artifact/org.knowm.xchange/xchange-stream-core --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.knowm.xchange&lt;/groupId&gt;\r\n            &lt;artifactId&gt;xchange-stream-core&lt;/artifactId&gt;\r\n            &lt;version&gt;5.0.14&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;!-- https://mvnrepository.com/artifact/org.knowm.xchange/xchange-stream-service-netty --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.knowm.xchange&lt;/groupId&gt;\r\n            &lt;artifactId&gt;xchange-stream-service-netty&lt;/artifactId&gt;\r\n            &lt;version&gt;5.0.14&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;!-- https://mvnrepository.com/artifact/org.knowm.xchange/xchange-binance --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.knowm.xchange&lt;/groupId&gt;\r\n            &lt;artifactId&gt;xchange-binance&lt;/artifactId&gt;\r\n            &lt;version&gt;5.0.14&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\r\n            &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;\r\n            &lt;version&gt;2.19.0&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\r\n            &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\r\n            &lt;version&gt;2.19.0&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;!-- https://logging.apache.org/log4j/2.x/manual/async.html --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;com.lmax&lt;/groupId&gt;\r\n            &lt;artifactId&gt;disruptor&lt;/artifactId&gt;\r\n            &lt;version&gt;3.4.4&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;!-- https://mvnrepository.com/artifact/software.amazon.awssdk/secretsmanager --&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n            &lt;artifactId&gt;secretsmanager&lt;/artifactId&gt;\r\n            &lt;version&gt;2.20.38&lt;/version&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\r\n            &lt;artifactId&gt;regions&lt;/artifactId&gt;\r\n            &lt;version&gt;2.20.38&lt;/version&gt;\r\n            &lt;scope&gt;provided&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n    &lt;/dependencies&gt;\r\n\r\n    &lt;properties&gt;\r\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\r\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\r\n\r\n        &lt;aws.java.sdk.version&gt;2.20.38&lt;/aws.java.sdk.version&gt;\r\n    &lt;/properties&gt;\r\n\r\n&lt;/project&gt;\r\n```","title":"&quot;java.lang.ClassNotFoundException: software.amazon.awssdk.regions.Region&quot; error for JAR built via IntelliJ","body":"<p>I'm using IntelliJ to develop an AWS app (simply retrieves from SecretsManager). I'm able to run the app fine in IntelliJ, but when I build a JAR artifact via IntelliJ and try to execute the JAR, I get <code>java.lang.ClassNotFoundException: software.amazon.awssdk.regions.Region</code>.</p>\n<p>I built the JAR via IntelliJ, but I use a <code>pom.xml</code> to specify the dependencies. When I try to execute the JAR, I get <code>java.lang.ClassNotFoundException: software.amazon.awssdk.regions.Region</code> error. I've included this dependency as part of my <code>pom.xml</code>, and I have also verified that the JAR is extracting the &quot;software.amazon.awssdk.regions&quot; library.</p>\n<p>I have no idea why the JAR complains about &quot;ClassNotFoundException&quot;, when the class it's looking for is literally in the JAR?</p>\n<p>Any guidance is greatly appreciated!</p>\n<p>I've included my <code>pom.xml</code> below:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;com.chronoslabs&lt;/groupId&gt;\n    &lt;artifactId&gt;chronos-trader&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n                &lt;artifactId&gt;bom&lt;/artifactId&gt;\n                &lt;version&gt;${aws.java.sdk.version}&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n    &lt;dependencies&gt;\n        &lt;!-- https://mvnrepository.com/artifact/org.jmockit/jmockit --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jmockit&lt;/groupId&gt;\n            &lt;artifactId&gt;jmockit&lt;/artifactId&gt;\n            &lt;version&gt;1.49&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.github.binance&lt;/groupId&gt;\n            &lt;artifactId&gt;binance-connector-java&lt;/artifactId&gt;\n            &lt;version&gt;1.12.0&lt;/version&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/com.google.code.gson/gson --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;\n            &lt;artifactId&gt;gson&lt;/artifactId&gt;\n            &lt;version&gt;2.9.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n            &lt;version&gt;1.18.24&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;\n            &lt;version&gt;5.7.0&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jmockit&lt;/groupId&gt;\n            &lt;artifactId&gt;jmockit&lt;/artifactId&gt;\n            &lt;version&gt;1.49&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/com.google.guava/guava --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.google.guava&lt;/groupId&gt;\n            &lt;artifactId&gt;guava&lt;/artifactId&gt;\n            &lt;version&gt;31.1-jre&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/org.knowm.xchange/xchange-core --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.knowm.xchange&lt;/groupId&gt;\n            &lt;artifactId&gt;xchange-core&lt;/artifactId&gt;\n            &lt;version&gt;5.0.14&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/org.knowm.xchange/xchange-stream-core --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.knowm.xchange&lt;/groupId&gt;\n            &lt;artifactId&gt;xchange-stream-core&lt;/artifactId&gt;\n            &lt;version&gt;5.0.14&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/org.knowm.xchange/xchange-stream-service-netty --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.knowm.xchange&lt;/groupId&gt;\n            &lt;artifactId&gt;xchange-stream-service-netty&lt;/artifactId&gt;\n            &lt;version&gt;5.0.14&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/org.knowm.xchange/xchange-binance --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.knowm.xchange&lt;/groupId&gt;\n            &lt;artifactId&gt;xchange-binance&lt;/artifactId&gt;\n            &lt;version&gt;5.0.14&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;\n            &lt;version&gt;2.19.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\n            &lt;version&gt;2.19.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://logging.apache.org/log4j/2.x/manual/async.html --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.lmax&lt;/groupId&gt;\n            &lt;artifactId&gt;disruptor&lt;/artifactId&gt;\n            &lt;version&gt;3.4.4&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/software.amazon.awssdk/secretsmanager --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;secretsmanager&lt;/artifactId&gt;\n            &lt;version&gt;2.20.38&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;regions&lt;/artifactId&gt;\n            &lt;version&gt;2.20.38&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n\n        &lt;aws.java.sdk.version&gt;2.20.38&lt;/aws.java.sdk.version&gt;\n    &lt;/properties&gt;\n\n&lt;/project&gt;\n</code></pre>\n"},{"tags":["java","spring","debugging","testing","build.gradle"],"comments":[{"owner":{"account_id":19535095,"reputation":2874,"user_id":14294053,"display_name":"Mar-Z"},"score":1,"creation_date":1681051416,"post_id":75970851,"comment_id":133993537,"body_markdown":"I would remove the spring-test dependency. spring-boot-starter-test should be enough.","body":"I would remove the spring-test dependency. spring-boot-starter-test should be enough."}],"owner":{"account_id":28109607,"reputation":29,"user_id":21477593,"display_name":"Micu Bogdan"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":114,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681047402,"creation_date":1681047402,"question_id":75970851,"body_markdown":"I added an extra functionality to my project that required adding some extra dependencies in the build.gradle file and suddenly all server-side tests fail with the same error. I think it is caused by some dependency overlap from the added feature as nothing else should be influencing the tests (I think?). This is the error message that I&#39;m getting for every test:\r\n```\r\njava.lang.IllegalStateException: Failed to load ApplicationContext\r\n\tat org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:132)\r\n\tat org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:124)\r\n\tat org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:190)\r\n\tat org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:132)\r\n\tat org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:244)\r\n\tat org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:138)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$8(ClassBasedTestDescriptor.java:363)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:368)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$9(ClassBasedTestDescriptor.java:363)\r\n\tat java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)\r\n\tat java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)\r\n\tat java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)\r\n\tat java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)\r\n\tat java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)\r\n\tat java.base/java.util.stream.StreamSpliterators$WrappingSpliterator.forEachRemaining(StreamSpliterators.java:310)\r\n\tat java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:735)\r\n\tat java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:734)\r\n\tat java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:362)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$6(ClassBasedTestDescriptor.java:283)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:282)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$4(ClassBasedTestDescriptor.java:272)\r\n\tat java.base/java.util.Optional.orElseGet(Optional.java:364)\r\n\tat org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:271)\r\n\tat org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31)\r\n\tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$0(TestMethodTestDescriptor.java:102)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:101)\r\n\tat org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:66)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:123)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:123)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:90)\r\n\tat java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\r\n\tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\r\n\tat java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\r\n\tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)\r\n\tat org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)\r\n\tat org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)\r\n\tat org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)\r\n\tat org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:99)\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:79)\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:75)\r\n\tat org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:62)\r\n\tat java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:578)\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n\tat org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n\tat org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n\tat jdk.proxy2/jdk.proxy2.$Proxy5.stop(Unknown Source)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:193)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n\tat org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n\tat org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:113)\r\n\tat org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:65)\r\n\tat worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n\tat worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;fileController&#39;: Unsatisfied dependency expressed through field &#39;service&#39;; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &#39;server.services.StorageService&#39; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}\r\n\tat app//org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:659)\r\n\tat app//org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:639)\r\n\tat app//org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:119)\r\n\tat app//org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:399)\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1431)\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619)\r\n\tat app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)\r\n\tat app//org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\r\n\tat app//org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\r\n\tat app//org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\r\n\tat app//org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)\r\n\tat app//org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:953)\r\n\tat app//org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)\r\n\tat app//org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583)\r\n\tat app//org.springframework.boot.SpringApplication.refresh(SpringApplication.java:732)\r\n\tat app//org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:414)\r\n\tat app//org.springframework.boot.SpringApplication.run(SpringApplication.java:302)\r\n\tat app//org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:136)\r\n\tat app//org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:99)\r\n\tat app//org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)\r\n\t... 85 more\r\nCaused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &#39;server.services.StorageService&#39; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}\r\n\tat app//org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoMatchingBeanFound(DefaultListableBeanFactory.java:1799)\r\n\tat app//org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1355)\r\n\tat app//org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1309)\r\n\tat app//org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:656)\r\n\t... 104 more\r\n```\r\nThis is the &#39;working&#39; build.gradle:\r\n```\r\nplugins {\r\n\tid &#39;org.springframework.boot&#39; version &#39;2.6.3&#39;\r\n\tid &#39;io.spring.dependency-management&#39; version &#39;1.0.11.RELEASE&#39;\r\n}\r\n\r\ndependencies {\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-web&#39;\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-websocket&#39;\r\n\r\n\ttestImplementation &#39;org.springframework.boot:spring-boot-starter-test&#39;\r\n\truntimeOnly &#39;com.h2database:h2&#39;\r\n\timplementation project(&quot;:commons&quot;)\r\n}\r\n```\r\nThis is the current build.gradle that&#39;s failing:\r\n```\r\nplugins {\r\n\tid &#39;org.springframework.boot&#39; version &#39;2.6.3&#39;\r\n\tid &#39;io.spring.dependency-management&#39; version &#39;1.0.11.RELEASE&#39;\r\n}\r\n\r\ndependencies {\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-web&#39;\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;\r\n\timplementation &#39;org.springframework.boot:spring-boot-starter-websocket&#39;\r\n\timplementation &#39;org.springframework:spring-test:5.3.9&#39;\r\n\timplementation &#39;org.glassfish.jersey.core:jersey-client:2.39.1&#39;\r\n\timplementation &#39;org.glassfish.jersey.media:jersey-media-multipart:2.39.1&#39;\r\n\ttestImplementation &#39;org.springframework.boot:spring-boot-starter-test&#39;\r\n\truntimeOnly &#39;com.h2database:h2&#39;\r\n\timplementation project(&quot;:commons&quot;)\r\n}\r\n```\r\nAnd this is the application.properties:\r\n```\r\nspring.datasource.driverClassName=org.h2.Driver\r\nspring.datasource.username=sa\r\nspring.datasource.password=\r\nspring.jpa.database-platform=org.hibernate.dialect.H2Dialect\r\n\r\n# use one of these alternatives...\r\n# ... purely in-memory, wiped on restart, but great for testing\r\nspring.datasource.url=jdbc:h2:mem:testdb\r\n# ... persisted on disk (in project directory)\r\n#spring.datasource.url=jdbc:h2:file:./databs\r\n\r\n# enable DB view on http://localhost:8080/h2-console\r\nspring.h2.console.enabled=true\r\n# Max file size.\r\nspring.servlet.multipart.max-file-size=20MB\r\n# Max request size.\r\nspring.servlet.multipart.max-request-size=20MB\r\n# strategy for table (re-)generation\r\nspring.jpa.hibernate.ddl-auto=update\r\n# show auto-generated SQL commands\r\n#spring.jpa.hibernate.show_sql=true\r\n```\r\nI could also be mistaken and have something completely different as the cause, so please let me know if that&#39;s the case.","title":"Dependency incompatibility from an added feature causes the tests in my springboot/gradle project to fail","body":"<p>I added an extra functionality to my project that required adding some extra dependencies in the build.gradle file and suddenly all server-side tests fail with the same error. I think it is caused by some dependency overlap from the added feature as nothing else should be influencing the tests (I think?). This is the error message that I'm getting for every test:</p>\n<pre><code>java.lang.IllegalStateException: Failed to load ApplicationContext\n    at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:132)\n    at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:124)\n    at org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:190)\n    at org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:132)\n    at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:244)\n    at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:138)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$8(ClassBasedTestDescriptor.java:363)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:368)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$9(ClassBasedTestDescriptor.java:363)\n    at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)\n    at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)\n    at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)\n    at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)\n    at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)\n    at java.base/java.util.stream.StreamSpliterators$WrappingSpliterator.forEachRemaining(StreamSpliterators.java:310)\n    at java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:735)\n    at java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:734)\n    at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:362)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$6(ClassBasedTestDescriptor.java:283)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:282)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$4(ClassBasedTestDescriptor.java:272)\n    at java.base/java.util.Optional.orElseGet(Optional.java:364)\n    at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:271)\n    at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31)\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$0(TestMethodTestDescriptor.java:102)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:101)\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:66)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:123)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:123)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:90)\n    at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\n    at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)\n    at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)\n    at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)\n    at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:99)\n    at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:79)\n    at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:75)\n    at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:62)\n    at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:578)\n    at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\n    at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\n    at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\n    at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\n    at jdk.proxy2/jdk.proxy2.$Proxy5.stop(Unknown Source)\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:193)\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\n    at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\n    at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\n    at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:113)\n    at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:65)\n    at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\n    at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'fileController': Unsatisfied dependency expressed through field 'service'; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'server.services.StorageService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}\n    at app//org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:659)\n    at app//org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:639)\n    at app//org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:119)\n    at app//org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:399)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1431)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\n    at app//org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)\n    at app//org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:953)\n    at app//org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)\n    at app//org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583)\n    at app//org.springframework.boot.SpringApplication.refresh(SpringApplication.java:732)\n    at app//org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:414)\n    at app//org.springframework.boot.SpringApplication.run(SpringApplication.java:302)\n    at app//org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:136)\n    at app//org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:99)\n    at app//org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:124)\n    ... 85 more\nCaused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'server.services.StorageService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}\n    at app//org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoMatchingBeanFound(DefaultListableBeanFactory.java:1799)\n    at app//org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1355)\n    at app//org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1309)\n    at app//org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:656)\n    ... 104 more\n</code></pre>\n<p>This is the 'working' build.gradle:</p>\n<pre><code>plugins {\n    id 'org.springframework.boot' version '2.6.3'\n    id 'io.spring.dependency-management' version '1.0.11.RELEASE'\n}\n\ndependencies {\n    implementation 'org.springframework.boot:spring-boot-starter-web'\n    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'\n    implementation 'org.springframework.boot:spring-boot-starter-websocket'\n\n    testImplementation 'org.springframework.boot:spring-boot-starter-test'\n    runtimeOnly 'com.h2database:h2'\n    implementation project(&quot;:commons&quot;)\n}\n</code></pre>\n<p>This is the current build.gradle that's failing:</p>\n<pre><code>plugins {\n    id 'org.springframework.boot' version '2.6.3'\n    id 'io.spring.dependency-management' version '1.0.11.RELEASE'\n}\n\ndependencies {\n    implementation 'org.springframework.boot:spring-boot-starter-web'\n    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'\n    implementation 'org.springframework.boot:spring-boot-starter-websocket'\n    implementation 'org.springframework:spring-test:5.3.9'\n    implementation 'org.glassfish.jersey.core:jersey-client:2.39.1'\n    implementation 'org.glassfish.jersey.media:jersey-media-multipart:2.39.1'\n    testImplementation 'org.springframework.boot:spring-boot-starter-test'\n    runtimeOnly 'com.h2database:h2'\n    implementation project(&quot;:commons&quot;)\n}\n</code></pre>\n<p>And this is the application.properties:</p>\n<pre><code>spring.datasource.driverClassName=org.h2.Driver\nspring.datasource.username=sa\nspring.datasource.password=\nspring.jpa.database-platform=org.hibernate.dialect.H2Dialect\n\n# use one of these alternatives...\n# ... purely in-memory, wiped on restart, but great for testing\nspring.datasource.url=jdbc:h2:mem:testdb\n# ... persisted on disk (in project directory)\n#spring.datasource.url=jdbc:h2:file:./databs\n\n# enable DB view on http://localhost:8080/h2-console\nspring.h2.console.enabled=true\n# Max file size.\nspring.servlet.multipart.max-file-size=20MB\n# Max request size.\nspring.servlet.multipart.max-request-size=20MB\n# strategy for table (re-)generation\nspring.jpa.hibernate.ddl-auto=update\n# show auto-generated SQL commands\n#spring.jpa.hibernate.show_sql=true\n</code></pre>\n<p>I could also be mistaken and have something completely different as the cause, so please let me know if that's the case.</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"account_id":50585,"reputation":39940,"user_id":150978,"accept_rate":78,"display_name":"Robert"},"score":0,"creation_date":1681045381,"post_id":75970638,"comment_id":133992747,"body_markdown":"Are you sure the code in `onClick` is executed at all? Add a `Log.d(..)` statement and check logcat or set a breakpoint when debugging with Android Studio.","body":"Are you sure the code in <code>onClick</code> is executed at all? Add a <code>Log.d(..)</code> statement and check logcat or set a breakpoint when debugging with Android Studio."},{"owner":{"account_id":7464777,"reputation":1,"user_id":5674793,"display_name":"Thiago"},"score":0,"creation_date":1681046378,"post_id":75970638,"comment_id":133992863,"body_markdown":"Yes, works. The problem is with SharedPreferences","body":"Yes, works. The problem is with SharedPreferences"},{"owner":{"account_id":23118939,"reputation":67,"user_id":17225742,"display_name":"Rifaldi"},"score":0,"creation_date":1681108239,"post_id":75970638,"comment_id":133999423,"body_markdown":"I think your SharedPreferences not get context anything inside onclick. This mention at https://developer.android.com/training/data-storage/shared-preferences","body":"I think your SharedPreferences not get context anything inside onclick. This mention at <a href=\"https://developer.android.com/training/data-storage/shared-preferences\" rel=\"nofollow noreferrer\">developer.android.com/training/data-storage/shared-preferenc&zwnj;&#8203;es</a>"}],"owner":{"account_id":7464777,"reputation":1,"user_id":5674793,"display_name":"Thiago"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":26,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681047341,"creation_date":1681044934,"question_id":75970638,"body_markdown":"A simple example that doesn&#39;t work:\r\n\r\n```\r\nButton btn_validate = (Button) findViewById(R.id.btn_verify_validate);\r\n    btn_validate.setOnClickListener(new View.OnClickListener() {\r\n    @Override\r\n    public void onClick(View view) {\r\n        SharedPreferences sp = getSharedPreferences(&quot;CONFIG&quot;, MODE_PRIVATE);\r\n        SharedPreferences.Editor spe = sp.edit();\r\n        spe.putInt(&quot;GL_ID_CLASS&quot;, 34);\r\n        spe.commit();`\r\n    }\r\n}\r\n```\r\n\r\n\r\nBut if I put it in OnCreate, for example, thats works.","title":"Why SharedPreferences doesn&#39;t works inside a OnClick event?","body":"<p>A simple example that doesn't work:</p>\n<pre><code>Button btn_validate = (Button) findViewById(R.id.btn_verify_validate);\n    btn_validate.setOnClickListener(new View.OnClickListener() {\n    @Override\n    public void onClick(View view) {\n        SharedPreferences sp = getSharedPreferences(&quot;CONFIG&quot;, MODE_PRIVATE);\n        SharedPreferences.Editor spe = sp.edit();\n        spe.putInt(&quot;GL_ID_CLASS&quot;, 34);\n        spe.commit();`\n    }\n}\n</code></pre>\n<p>But if I put it in OnCreate, for example, thats works.</p>\n"},{"tags":["java","hibernate","jpa"],"comments":[{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1401972279,"post_id":24060498,"comment_id":37099414,"body_markdown":"Can you please add  stacktrace and code?","body":"Can you please add  stacktrace and code?"},{"owner":{"account_id":1212717,"reputation":11317,"user_id":1180968,"accept_rate":100,"display_name":"Sajan Chandran"},"score":0,"creation_date":1401972694,"post_id":24060498,"comment_id":37099706,"body_markdown":"show you `GenericDAOImpl`","body":"show you <code>GenericDAOImpl</code>"},{"owner":{"account_id":4470050,"reputation":68258,"user_id":3636601,"accept_rate":75,"display_name":"Jens"},"score":0,"creation_date":1401973024,"post_id":24060498,"comment_id":37099912,"body_markdown":"@user3706420 please add the `GenericDAOImpl` too.","body":"@user3706420 please add the <code>GenericDAOImpl</code> too."},{"owner":{"account_id":3260426,"reputation":11579,"user_id":2746110,"accept_rate":67,"display_name":"Arefe"},"score":0,"creation_date":1604663493,"post_id":24060498,"comment_id":114422358,"body_markdown":"You should only put the important parts of the error stack in the question.","body":"You should only put the important parts of the error stack in the question."}],"answers":[{"comments":[{"owner":{"account_id":160350,"reputation":11421,"user_id":380338,"display_name":"Neil Stockton"},"score":1,"creation_date":1401989906,"post_id":24060905,"comment_id":37111107,"body_markdown":"some other JPA implementations will cope with that situation without any need to change such things...","body":"some other JPA implementations will cope with that situation without any need to change such things..."}],"tags":[],"owner":{"account_id":1212717,"reputation":11317,"user_id":1180968,"accept_rate":100,"display_name":"Sajan Chandran"},"comment_count":1,"down_vote_count":0,"up_vote_count":26,"is_accepted":true,"score":26,"last_activity_date":1535579264,"creation_date":1401973192,"answer_id":24060905,"question_id":24060498,"body_markdown":"The table name you used, `GROUP`, is a reserved keyword for h2 databases.\nRename your table with a name like `ADMIN_GROUP`.\n\nHere&#39;s an extract from [the h2 documentation][1]:\n\n&gt; Keywords / Reserved Words\n&gt;\n&gt; There is a list of keywords that can&#39;t be used as identifiers (table names, column  names and so on), unless they are quoted (surrounded with double quotes). The list is currently:\n&gt;\n&gt; `CROSS, CURRENT_DATE, CURRENT_TIME, CURRENT_TIMESTAMP, DISTINCT, EXCEPT, EXISTS, FALSE, FOR, FROM, FULL, GROUP, HAVING, INNER, INTERSECT, IS, JOIN, LIKE, LIMIT, MINUS, NATURAL, NOT, NULL, ON, ORDER, PRIMARY, ROWNUM, SELECT, SYSDATE, SYSTIME, SYSTIMESTAMP, TODAY, TRUE, UNION, UNIQUE, WHERE`\n&gt;\n&gt; Certain words of this list are keywords because they are functions that can be used without &#39;()&#39; for compatibility, for example `CURRENT_TIMESTAMP`.\n\n\n  [1]: http://www.h2database.com/html/advanced.html#compatibility","title":"org.hibernate.exception.SQLGrammarException: could not prepare statement","body":"<p>The table name you used, <code>GROUP</code>, is a reserved keyword for h2 databases.\nRename your table with a name like <code>ADMIN_GROUP</code>.</p>\n<p>Here's an extract from <a href=\"http://www.h2database.com/html/advanced.html#compatibility\" rel=\"noreferrer\">the h2 documentation</a>:</p>\n<blockquote>\n<p>Keywords / Reserved Words</p>\n<p>There is a list of keywords that can't be used as identifiers (table names, column  names and so on), unless they are quoted (surrounded with double quotes). The list is currently:</p>\n<p><code>CROSS, CURRENT_DATE, CURRENT_TIME, CURRENT_TIMESTAMP, DISTINCT, EXCEPT, EXISTS, FALSE, FOR, FROM, FULL, GROUP, HAVING, INNER, INTERSECT, IS, JOIN, LIKE, LIMIT, MINUS, NATURAL, NOT, NULL, ON, ORDER, PRIMARY, ROWNUM, SELECT, SYSDATE, SYSTIME, SYSTIMESTAMP, TODAY, TRUE, UNION, UNIQUE, WHERE</code></p>\n<p>Certain words of this list are keywords because they are functions that can be used without '()' for compatibility, for example <code>CURRENT_TIMESTAMP</code>.</p>\n</blockquote>\n"},{"comments":[{"owner":{"account_id":9781391,"reputation":358,"user_id":7249306,"display_name":"Denis Abakumov"},"score":2,"creation_date":1655347477,"post_id":52895775,"comment_id":128312940,"body_markdown":"PostgreSQL also doesn&#39;t like the word &quot;value&quot; as a field name.","body":"PostgreSQL also doesn&#39;t like the word &quot;value&quot; as a field name."}],"tags":[],"owner":{"account_id":7364659,"reputation":515,"user_id":5606736,"display_name":"Philippe"},"comment_count":1,"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1539964197,"creation_date":1539963774,"answer_id":52895775,"question_id":24060498,"body_markdown":"after about 40 minutes I found that **user** and **currentUser** should not be used as well \r\n\r\n    //this cause error\r\n    @Column()\r\n    private String user; \r\n\r\nthis causes: `could not prepare statement; SQL [insert into table_progress (id, created, user, progress, updated, xdip) values (default, ?, ?, ?, ?, ?)]`\r\n \r\n\r\n    //changed to this and works    \r\n    @Column()\r\n    private String userP;","title":"org.hibernate.exception.SQLGrammarException: could not prepare statement","body":"<p>after about 40 minutes I found that <strong>user</strong> and <strong>currentUser</strong> should not be used as well </p>\n\n<pre><code>//this cause error\n@Column()\nprivate String user; \n</code></pre>\n\n<p>this causes: <code>could not prepare statement; SQL [insert into table_progress (id, created, user, progress, updated, xdip) values (default, ?, ?, ?, ?, ?)]</code></p>\n\n<pre><code>//changed to this and works    \n@Column()\nprivate String userP;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6541515,"reputation":115,"user_id":5058908,"display_name":"Muhammad Waqar"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1552498858,"creation_date":1552498858,"answer_id":55148167,"question_id":24060498,"body_markdown":"I used **desc** for description, **desc** and **asc** are also reserved words for ascending and descending order.","title":"org.hibernate.exception.SQLGrammarException: could not prepare statement","body":"<p>I used <strong>desc</strong> for description, <strong>desc</strong> and <strong>asc</strong> are also reserved words for ascending and descending order.</p>\n"},{"tags":[],"owner":{"account_id":2758735,"reputation":540,"user_id":2376071,"display_name":"ranjeet"},"comment_count":0,"down_vote_count":0,"up_vote_count":6,"is_accepted":false,"score":6,"last_activity_date":1568905749,"creation_date":1568902554,"answer_id":58013062,"question_id":24060498,"body_markdown":"In case of Spring-boot with H2 Database, need to use properties,\r\n\r\n    spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl\r\n\r\n\r\nError was becoz Tables name and columns converted to UpperCase with underscore.\r\n\r\nFor example \r\n\r\n    createdOn -&gt; CREATED_ON.","title":"org.hibernate.exception.SQLGrammarException: could not prepare statement","body":"<p>In case of Spring-boot with H2 Database, need to use properties,</p>\n\n<pre><code>spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl\n</code></pre>\n\n<p>Error was becoz Tables name and columns converted to UpperCase with underscore.</p>\n\n<p>For example </p>\n\n<pre><code>createdOn -&gt; CREATED_ON.\n</code></pre>\n"},{"tags":[],"owner":{"account_id":10977736,"reputation":71,"user_id":8065933,"display_name":"Bruke"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1572455411,"creation_date":1572455411,"answer_id":58630542,"question_id":24060498,"body_markdown":"Here is the list of reserved key words for Apache Derby:\r\nhttps://db.apache.org/derby/docs/10.2/ref/rrefkeywords29722.html\r\n\r\nHaving any of these will cause an Exception!","title":"org.hibernate.exception.SQLGrammarException: could not prepare statement","body":"<p>Here is the list of reserved key words for Apache Derby:\n<a href=\"https://db.apache.org/derby/docs/10.2/ref/rrefkeywords29722.html\" rel=\"nofollow noreferrer\">https://db.apache.org/derby/docs/10.2/ref/rrefkeywords29722.html</a></p>\n\n<p>Having any of these will cause an Exception!</p>\n"},{"tags":[],"owner":{"account_id":1979652,"reputation":7771,"user_id":2161118,"display_name":"S34N"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1604169878,"creation_date":1604169878,"answer_id":64625272,"question_id":24060498,"body_markdown":"In my case, it was the fact that the test-service user was not authorized to perform that HTTP.POST operation. Fixed it by assigning ROLE_ADMIN to the spring test-user.\r\n\r\n    //Has @Profile(&quot;test&quot;) as the active profile at the top of the class\r\n\r\n    @PostConstruct\r\n    public void check1stRecord() {\r\n        SecurityUtility.createSecurityContext(&quot;spring&quot;, &quot;spring_password&quot;, &quot;ROLE_SERVICE&quot;, &quot;ROLE_ADMIN&quot;);\r\n        personRepo.save(createRecord());\r\n        SecurityContextHolder.clearContext();\r\n    }\r\n\r\n\r\nCurrently this my Spring Security Configuration:\r\n\r\n    package io.swagger.config.security;\r\n    \r\n    import lombok.extern.log4j.Log4j2;\r\n    import org.springframework.context.annotation.Bean;\r\n    import org.springframework.context.annotation.Configuration;\r\n    import org.springframework.http.HttpMethod;\r\n    import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;\r\n    import org.springframework.security.config.annotation.web.builders.HttpSecurity;\r\n    import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\r\n    import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\r\n    import org.springframework.security.core.userdetails.User;\r\n    import org.springframework.security.core.userdetails.UserDetails;\r\n    import org.springframework.security.crypto.factory.PasswordEncoderFactories;\r\n    import org.springframework.security.crypto.password.PasswordEncoder;\r\n    import org.springframework.security.provisioning.InMemoryUserDetailsManager;\r\n    \r\n    @Log4j2\r\n    @Configuration\r\n    @EnableGlobalMethodSecurity(prePostEnabled = true)\r\n    @EnableWebSecurity\r\n    public class SecurityConfig extends WebSecurityConfigurerAdapter {\r\n    \r\n        private static final String adminUsername = &quot;admin&quot;;\r\n        private static final String adminPassword = &quot;admin_password&quot;;\r\n        private static final String serviceUsername = &quot;service&quot;;\r\n        private static final String servicePassword = &quot;service_password&quot;;\r\n    \r\n        @Bean\r\n        InMemoryUserDetailsManager inMemoryUserDetailsManager() {\r\n    \r\n            PasswordEncoder encoder = PasswordEncoderFactories.createDelegatingPasswordEncoder();\r\n            UserDetails adminUser = User.withUsername(adminUsername).password(encoder.encode(adminPassword)).roles(&quot;SERVICE&quot;, &quot;ADMIN&quot;).build();\r\n            UserDetails demoUser = User.withUsername(serviceUsername).password(encoder.encode(servicePassword)).roles(&quot;SERVICE&quot;).build();\r\n    \r\n            // remember the password that is printed out and use in the next step\r\n            log.debug(&quot;Username: {}, Password: {}&quot;, adminUsername, adminPassword);\r\n            log.debug(&quot;Username: {}, Password: {}&quot;, serviceUsername, servicePassword);\r\n    \r\n            return new InMemoryUserDetailsManager(adminUser, demoUser);\r\n        }\r\n    \r\n        /**\r\n         * Override this method to configure the {@link HttpSecurity}. Typically subclasses\r\n         * should not invoke this method by calling super as it may override their\r\n         * configuration. The default configuration is:\r\n         *\r\n         * &lt;pre&gt;\r\n         * http.authorizeRequests().anyRequest().authenticated().and().formLogin().and().httpBasic();\r\n         * &lt;/pre&gt;\r\n         * &lt;p&gt;\r\n         * Any endpoint that requires defense against common vulnerabilities can be specified\r\n         * here, including public ones. See {@link HttpSecurity#authorizeRequests} and the\r\n         * `permitAll()` authorization rule for more details on public endpoints.\r\n         *\r\n         * @param http the {@link HttpSecurity} to modify\r\n         * @throws Exception if an error occurs\r\n         */\r\n        @Override\r\n        protected void configure(HttpSecurity http) throws Exception {\r\n    \r\n            http.httpBasic().and()\r\n                    .authorizeRequests()//\r\n                    .antMatchers(HttpMethod.POST, &quot;/people&quot;).hasRole(&quot;ADMIN&quot;)//\r\n                    .antMatchers(HttpMethod.PUT, &quot;/people/**&quot;).hasRole(&quot;SERVICE&quot;)//\r\n                    .antMatchers(HttpMethod.PATCH, &quot;/people/**&quot;).hasRole(&quot;SERVICE&quot;)//\r\n                    .antMatchers(HttpMethod.DELETE, &quot;/people/**&quot;).hasRole(&quot;ADMIN&quot;).and()\r\n                    .csrf().disable()\r\n                    .antMatcher(&quot;**/h2-console/**&quot;).authorizeRequests().anyRequest().permitAll();\r\n        }\r\n    }\r\n\r\n","title":"org.hibernate.exception.SQLGrammarException: could not prepare statement","body":"<p>In my case, it was the fact that the test-service user was not authorized to perform that HTTP.POST operation. Fixed it by assigning ROLE_ADMIN to the spring test-user.</p>\n<pre><code>//Has @Profile(&quot;test&quot;) as the active profile at the top of the class\n\n@PostConstruct\npublic void check1stRecord() {\n    SecurityUtility.createSecurityContext(&quot;spring&quot;, &quot;spring_password&quot;, &quot;ROLE_SERVICE&quot;, &quot;ROLE_ADMIN&quot;);\n    personRepo.save(createRecord());\n    SecurityContextHolder.clearContext();\n}\n</code></pre>\n<p>Currently this my Spring Security Configuration:</p>\n<pre><code>package io.swagger.config.security;\n\nimport lombok.extern.log4j.Log4j2;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.http.HttpMethod;\nimport org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\nimport org.springframework.security.core.userdetails.User;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.security.crypto.factory.PasswordEncoderFactories;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.security.provisioning.InMemoryUserDetailsManager;\n\n@Log4j2\n@Configuration\n@EnableGlobalMethodSecurity(prePostEnabled = true)\n@EnableWebSecurity\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n    private static final String adminUsername = &quot;admin&quot;;\n    private static final String adminPassword = &quot;admin_password&quot;;\n    private static final String serviceUsername = &quot;service&quot;;\n    private static final String servicePassword = &quot;service_password&quot;;\n\n    @Bean\n    InMemoryUserDetailsManager inMemoryUserDetailsManager() {\n\n        PasswordEncoder encoder = PasswordEncoderFactories.createDelegatingPasswordEncoder();\n        UserDetails adminUser = User.withUsername(adminUsername).password(encoder.encode(adminPassword)).roles(&quot;SERVICE&quot;, &quot;ADMIN&quot;).build();\n        UserDetails demoUser = User.withUsername(serviceUsername).password(encoder.encode(servicePassword)).roles(&quot;SERVICE&quot;).build();\n\n        // remember the password that is printed out and use in the next step\n        log.debug(&quot;Username: {}, Password: {}&quot;, adminUsername, adminPassword);\n        log.debug(&quot;Username: {}, Password: {}&quot;, serviceUsername, servicePassword);\n\n        return new InMemoryUserDetailsManager(adminUser, demoUser);\n    }\n\n    /**\n     * Override this method to configure the {@link HttpSecurity}. Typically subclasses\n     * should not invoke this method by calling super as it may override their\n     * configuration. The default configuration is:\n     *\n     * &lt;pre&gt;\n     * http.authorizeRequests().anyRequest().authenticated().and().formLogin().and().httpBasic();\n     * &lt;/pre&gt;\n     * &lt;p&gt;\n     * Any endpoint that requires defense against common vulnerabilities can be specified\n     * here, including public ones. See {@link HttpSecurity#authorizeRequests} and the\n     * `permitAll()` authorization rule for more details on public endpoints.\n     *\n     * @param http the {@link HttpSecurity} to modify\n     * @throws Exception if an error occurs\n     */\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n\n        http.httpBasic().and()\n                .authorizeRequests()//\n                .antMatchers(HttpMethod.POST, &quot;/people&quot;).hasRole(&quot;ADMIN&quot;)//\n                .antMatchers(HttpMethod.PUT, &quot;/people/**&quot;).hasRole(&quot;SERVICE&quot;)//\n                .antMatchers(HttpMethod.PATCH, &quot;/people/**&quot;).hasRole(&quot;SERVICE&quot;)//\n                .antMatchers(HttpMethod.DELETE, &quot;/people/**&quot;).hasRole(&quot;ADMIN&quot;).and()\n                .csrf().disable()\n                .antMatcher(&quot;**/h2-console/**&quot;).authorizeRequests().anyRequest().permitAll();\n    }\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":7335122,"reputation":490,"user_id":5586793,"display_name":"Naveen"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1626411301,"creation_date":1626410958,"answer_id":68403570,"question_id":24060498,"body_markdown":"follow this steps&#39; assuming you have the bean class \r\n\r\n    @Entity\r\n    public class Question {\r\n        @Id\r\n        private int qId;\r\n        @Column\r\n        private String question;\r\n        private int userId;\r\n        private int votes;\r\n    }\r\n\r\nthe hibernate generate the code to insert is \r\n\r\n     insert \r\n        into\r\n            question\r\n            (question, user_id, votes, q_id) \r\n        values\r\n            (?, ?, ?, ?)\r\n\r\n\r\nensure to check qId to q_id. \r\n\r\nto connect to repository(I&#39;m using spring boot) \r\n\r\n\r\n \r\n\r\n     @Query(value = &quot;select votes from question where q_id=?1&quot;, nativeQuery = true)\r\n        public int findVotesForQuestion(int qId);","title":"org.hibernate.exception.SQLGrammarException: could not prepare statement","body":"<p>follow this steps' assuming you have the bean class</p>\n<pre><code>@Entity\npublic class Question {\n    @Id\n    private int qId;\n    @Column\n    private String question;\n    private int userId;\n    private int votes;\n}\n</code></pre>\n<p>the hibernate generate the code to insert is</p>\n<pre><code> insert \n    into\n        question\n        (question, user_id, votes, q_id) \n    values\n        (?, ?, ?, ?)\n</code></pre>\n<p>ensure to check qId to q_id.</p>\n<p>to connect to repository(I'm using spring boot)</p>\n<pre><code> @Query(value = &quot;select votes from question where q_id=?1&quot;, nativeQuery = true)\n    public int findVotesForQuestion(int qId);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1986826,"reputation":2226,"user_id":4175822,"display_name":"spacether"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1649396095,"creation_date":1649376914,"answer_id":71790303,"question_id":24060498,"body_markdown":"When writing @Queries with nativeQuery=true in Kotlin, (and maybe also Java?)\r\none must include the correct sql table name and column names on the queries.\r\n\r\nThis Fails:&lt;br&gt;\r\n`\r\n@Query(nativeQuery = true, value =&quot;SELECT u from PriceTier u WHERE u.startTime &lt; :now and (u.endTime is null or u.endTime &gt; :now) and u.amount &lt;= :amount and u.currency = :currency and u.tierLevel &gt;= :tierLevel order by u.tierLevel desc LIMIT 1&quot;)\r\n`\r\n\r\nAnd this works:&lt;br&gt;\r\n`\r\n@Query(nativeQuery = true, value =&quot;SELECT * from price_tier u WHERE u.start_time &lt; :now and (u.end_time is null or u.end_time &gt; :now) and u.amount &lt;= :amount and u.currency = :currency and u.tier_level &gt;= :tierLevel ORDER BY u.tier_level DESC LIMIT 1&quot;)\r\n`\r\n","title":"org.hibernate.exception.SQLGrammarException: could not prepare statement","body":"<p>When writing @Queries with nativeQuery=true in Kotlin, (and maybe also Java?)\none must include the correct sql table name and column names on the queries.</p>\n<p>This Fails:<br>\n<code>@Query(nativeQuery = true, value =&quot;SELECT u from PriceTier u WHERE u.startTime &lt; :now and (u.endTime is null or u.endTime &gt; :now) and u.amount &lt;= :amount and u.currency = :currency and u.tierLevel &gt;= :tierLevel order by u.tierLevel desc LIMIT 1&quot;)</code></p>\n<p>And this works:<br>\n<code>@Query(nativeQuery = true, value =&quot;SELECT * from price_tier u WHERE u.start_time &lt; :now and (u.end_time is null or u.end_time &gt; :now) and u.amount &lt;= :amount and u.currency = :currency and u.tier_level &gt;= :tierLevel ORDER BY u.tier_level DESC LIMIT 1&quot;)</code></p>\n"},{"tags":[],"owner":{"account_id":2676799,"reputation":286,"user_id":2313019,"display_name":"Hampus"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1649944564,"creation_date":1649944564,"answer_id":71872835,"question_id":24060498,"body_markdown":"For anyone who might be experiencing this but none of the solutions above helped. \r\nI got it working by setting these three parameters:\r\n\r\n    spring.datasource.url=jdbc:h2:file:ABSOLUTE_PATH_TO_DIR_IN_RESOURCES/db;AUTO_SERVER=true\r\n    spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl\r\n    spring.jpa.hibernate.ddl-auto=create-drop\r\n\r\nddl-auto needs to be create drop in order for it to actually create the tables on start. (If you have not specified an schema.sql that is)","title":"org.hibernate.exception.SQLGrammarException: could not prepare statement","body":"<p>For anyone who might be experiencing this but none of the solutions above helped.\nI got it working by setting these three parameters:</p>\n<pre><code>spring.datasource.url=jdbc:h2:file:ABSOLUTE_PATH_TO_DIR_IN_RESOURCES/db;AUTO_SERVER=true\nspring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl\nspring.jpa.hibernate.ddl-auto=create-drop\n</code></pre>\n<p>ddl-auto needs to be create drop in order for it to actually create the tables on start. (If you have not specified an schema.sql that is)</p>\n"},{"tags":[],"owner":{"account_id":6599951,"reputation":596,"user_id":5098570,"display_name":"Md. Nowshad Hasan"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681047223,"creation_date":1681047223,"answer_id":75970838,"question_id":24060498,"body_markdown":"I was using h2 database for Spring Boot testing using @DataJpaTest. \r\nI created another application.properties under test/resources folder and add below properties - \r\n```\r\nspring.datasource.driver-class-name=org.h2.Driver\r\nspring.datasource.url=jdbc:h2:mem:db;DB_CLOSE_DELAY=-1\r\n#spring.datasource.username=\r\n#spring.datasource.password=\r\nspring.jpa.hibernate.ddl-auto=create-drop\r\n```\r\nMy configuration was `ddl.auto = none`. But making `create-drop` solved the problem.\r\n","title":"org.hibernate.exception.SQLGrammarException: could not prepare statement","body":"<p>I was using h2 database for Spring Boot testing using @DataJpaTest.\nI created another application.properties under test/resources folder and add below properties -</p>\n<pre><code>spring.datasource.driver-class-name=org.h2.Driver\nspring.datasource.url=jdbc:h2:mem:db;DB_CLOSE_DELAY=-1\n#spring.datasource.username=\n#spring.datasource.password=\nspring.jpa.hibernate.ddl-auto=create-drop\n</code></pre>\n<p>My configuration was <code>ddl.auto = none</code>. But making <code>create-drop</code> solved the problem.</p>\n"}],"owner":{"account_id":4565243,"reputation":1311,"user_id":3706420,"accept_rate":73,"display_name":"Dunken"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":140980,"favorite_count":0,"down_vote_count":1,"up_vote_count":13,"accepted_answer_id":24060905,"answer_count":10,"score":12,"last_activity_date":1681047223,"creation_date":1401972026,"question_id":24060498,"body_markdown":"I have created two entities and am trying to fill one with data after loading it, to show it as a drop down list.\r\n\r\nI got the error\r\n\r\n&gt; org.hibernate.exception.SQLGrammarException: could not prepare statement\r\n\r\nThe `Group` entity that must be in the drop down list is:\r\n\r\n    @Entity\r\n    @Table(name=&quot;GROUP&quot;)\r\n    public class Group implements Serializable,Lifecycle{\r\n    \r\n    \t/**\r\n    \t * \r\n    \t */\r\n    \tprivate static final long serialVersionUID = 5551707547269388327L;\r\n    \t@Id\r\n    \t@Column(name=&quot;ID&quot;)\r\n    \t@GeneratedValue\r\n    \tprivate int id;\r\n    \t@Column(name=&quot;E_NAME&quot;)\r\n        private String eName;\r\n    \t@Column(name=&quot;A_NAME&quot;)\r\n        private String aName;\r\n    \t\r\n    \tpublic int getId() {\r\n    \t\treturn id;\r\n    \t}\r\n    \tpublic void setId(int id) {\r\n    \t\tthis.id = id;\r\n    \t}\r\n    \tpublic String geteName() {\r\n    \t\treturn eName;\r\n    \t}\r\n    \tpublic void seteName(String eName) {\r\n    \t\tthis.eName = eName;\r\n    \t}\r\n    \tpublic String getaName() {\r\n    \t\treturn aName;\r\n    \t}\r\n    \tpublic void setaName(String aName) {\r\n    \t\tthis.aName = aName;\r\n    \t}\r\n    \t\r\n    \t\r\n    \t\r\n    \t\r\n    \t\r\n    \t@Override\r\n    \tpublic boolean onDelete(Session arg0) throws CallbackException {\r\n    \t\t// TODO Auto-generated method stub\r\n    \t\treturn false;\r\n    \t}\r\n    \t@Override\r\n    \tpublic void onLoad(Session session, Serializable arg1) {\r\n    \t\t// TODO Auto-generated method stub\r\n    \t\tGroup adminGroup =new Group();\r\n    \t\tGroup sectionAdminGroup =new Group();\r\n    \t\tGroup userGroup =new Group();\r\n    \t\t\r\n    \t\t\r\n    \t\t\r\n    \t\tadminGroup.seteName(&quot;Admin&quot;);\r\n    \t\tsectionAdminGroup.seteName(&quot;Section Admin&quot;);\r\n    \t\tuserGroup.seteName(&quot;User&quot;);\r\n    \t\t\r\n    \t\tadminGroup.setaName(&quot;مسشرف عام&quot;);\r\n    \t\tsectionAdminGroup.setaName(&quot;مشرف قطاع&quot;);\r\n    \t\tuserGroup.setaName(&quot;مستخدم&quot;);\r\n    \t\t\r\n    \t\tsession.save(adminGroup);\r\n    \t\tsession.save(sectionAdminGroup);\r\n    \t\tsession.save(userGroup);\r\n    \t}\r\n    \t@Override\r\n    \tpublic boolean onSave(Session arg0) throws CallbackException {\r\n    \t\t// TODO Auto-generated method stub\r\n    \t\treturn false;\r\n    \t}\r\n    \t@Override\r\n    \tpublic boolean onUpdate(Session arg0) throws CallbackException {\r\n    \t\t// TODO Auto-generated method stub\r\n    \t\treturn false;\r\n    \t}\r\n    \t\r\n    }\r\n\r\nThe stack trace is:\r\n\r\n&gt; Caused by:\r\n&gt; \r\n&gt; org.hibernate.exception.SQLGrammarException: could not prepare\r\n&gt; statement \tat\r\n&gt; org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:123)\r\n&gt; \tat\r\n&gt; org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:49)\r\n&gt; \tat\r\n&gt; org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:126)\r\n&gt; \tat\r\n&gt; org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:196)\r\n&gt; \tat\r\n&gt; org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareQueryStatement(StatementPreparerImpl.java:160)\r\n&gt; \tat\r\n&gt; org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1884)\r\n&gt; \tat\r\n&gt; org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1861)\r\n&gt; \tat\r\n&gt; org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1838)\r\n&gt; \tat org.hibernate.loader.Loader.doQuery(Loader.java:909) \tat\r\n&gt; org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:354)\r\n&gt; \tat org.hibernate.loader.Loader.doList(Loader.java:2551) \tat\r\n&gt; org.hibernate.loader.Loader.doList(Loader.java:2537) \tat\r\n&gt; org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2367) \tat\r\n&gt; org.hibernate.loader.Loader.list(Loader.java:2362) \tat\r\n&gt; org.hibernate.loader.criteria.CriteriaLoader.list(CriteriaLoader.java:126)\r\n&gt; \tat org.hibernate.internal.SessionImpl.list(SessionImpl.java:1678) \tat\r\n&gt; org.hibernate.internal.CriteriaImpl.list(CriteriaImpl.java:380) \tat\r\n&gt; org.gaca.gms.dao.GenericDAOImpl.getAll(GenericDAOImpl.java:56) \tat\r\n&gt; org.gaca.gms.services.GenericServiceImpl.getAllObjects(GenericServiceImpl.java:61)\r\n&gt; \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) \tat\r\n&gt; sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n&gt; \tat\r\n&gt; sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n&gt; \tat java.lang.reflect.Method.invoke(Method.java:483) \tat\r\n&gt; org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)\r\n&gt; \tat com.sun.proxy.$Proxy39.getAllObjects(Unknown Source) \tat\r\n&gt; org.gaca.gms.controllers.UsersController.listUsers(UsersController.java:43)\r\n&gt; \tat\r\n&gt; org.gaca.gms.controllers.UsersController$$FastClassBySpringCGLIB$$29260f80.invoke()\r\n&gt; \tat\r\n&gt; org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:708)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:644)\r\n&gt; \tat\r\n&gt; org.gaca.gms.controllers.UsersController$$EnhancerBySpringCGLIB$$de07b585.listUsers()\r\n&gt; \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) \tat\r\n&gt; sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n&gt; \tat\r\n&gt; sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n&gt; \tat java.lang.reflect.Method.invoke(Method.java:483) \tat\r\n&gt; org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:215)\r\n&gt; \tat\r\n&gt; org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:132)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:104)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandleMethod(RequestMappingHandlerAdapter.java:749)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:689)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:83)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:938)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:870)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:961)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:852)\r\n&gt; \tat javax.servlet.http.HttpServlet.service(HttpServlet.java:707) \tat\r\n&gt; org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:837)\r\n&gt; \tat javax.servlet.http.HttpServlet.service(HttpServlet.java:820) \tat\r\n&gt; org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:362)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:726)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:206)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\r\n&gt; \tat org.mortbay.jetty.Server.handle(Server.java:324) \tat\r\n&gt; org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:829)\r\n&gt; \tat org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:514) \tat\r\n&gt; org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211) \tat\r\n&gt; org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380) \tat\r\n&gt; org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395)\r\n&gt; \tat\r\n&gt; org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:488)\r\n&gt; Caused by: org.h2.jdbc.JdbcSQLException: Syntax error in SQL statement\r\n&gt; &quot;SELECT THIS_.ID AS ID1_0_0_, THIS_.A_NAME AS A_NAME2_0_0_,\r\n&gt; THIS_.E_NAME AS E_NAME3_0_0_ FROM GROUP[*] THIS_ &quot;; expected\r\n&gt; &quot;identifier&quot;; SQL statement: select this_.ID as ID1_0_0_, this_.A_NAME\r\n&gt; as A_NAME2_0_0_, this_.E_NAME as E_NAME3_0_0_ from GROUP this_\r\n&gt; [42001-178] \tat\r\n&gt; org.h2.message.DbException.getJdbcSQLException(DbException.java:344)\r\n&gt; \tat org.h2.message.DbException.getSyntaxError(DbException.java:204)\r\n&gt; \tat org.h2.command.Parser.readIdentifierWithSchema(Parser.java:3024)\r\n&gt; \tat org.h2.command.Parser.readTableFilter(Parser.java:1185) \tat\r\n&gt; org.h2.command.Parser.parseSelectSimpleFromPart(Parser.java:1859) \tat\r\n&gt; org.h2.command.Parser.parseSelectSimple(Parser.java:1968) \tat\r\n&gt; org.h2.command.Parser.parseSelectSub(Parser.java:1853) \tat\r\n&gt; org.h2.command.Parser.parseSelectUnion(Parser.java:1674) \tat\r\n&gt; org.h2.command.Parser.parseSelect(Parser.java:1662) \tat\r\n&gt; org.h2.command.Parser.parsePrepared(Parser.java:434) \tat\r\n&gt; org.h2.command.Parser.parse(Parser.java:306) \tat\r\n&gt; org.h2.command.Parser.parse(Parser.java:278) \tat\r\n&gt; org.h2.command.Parser.prepareCommand(Parser.java:243) \tat\r\n&gt; org.h2.engine.Session.prepareLocal(Session.java:442) \tat\r\n&gt; org.h2.engine.Session.prepareCommand(Session.java:384) \tat\r\n&gt; org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1188)\r\n&gt; \tat org.h2.jdbc.JdbcPreparedStatement.(JdbcPreparedStatement.java:73)\r\n&gt; \tat\r\n&gt; org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:276)\r\n&gt; \tat\r\n&gt; org.apache.commons.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:281)\r\n&gt; \tat\r\n&gt; org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.prepareStatement(PoolingDataSource.java:313)\r\n&gt; \tat\r\n&gt; org.hibernate.engine.jdbc.internal.StatementPreparerImpl$5.doPrepare(StatementPreparerImpl.java:162)\r\n&gt; \tat\r\n&gt; org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:186)\r\n&gt; \t... 73 more\r\n&gt; \r\n&gt; Caused by:\r\n&gt; \r\n&gt; org.h2.jdbc.JdbcSQLException: Syntax error in SQL statement &quot;SELECT\r\n&gt; THIS_.ID AS ID1_0_0_, THIS_.A_NAME AS A_NAME2_0_0_, THIS_.E_NAME AS\r\n&gt; E_NAME3_0_0_ FROM GROUP[*] THIS_ &quot;; expected &quot;identifier&quot;; SQL\r\n&gt; statement: select this_.ID as ID1_0_0_, this_.A_NAME as A_NAME2_0_0_,\r\n&gt; this_.E_NAME as E_NAME3_0_0_ from GROUP this_ [42001-178] \tat\r\n&gt; org.h2.message.DbException.getJdbcSQLException(DbException.java:344)\r\n&gt; \tat org.h2.message.DbException.getSyntaxError(DbException.java:204)\r\n&gt; \tat org.h2.command.Parser.readIdentifierWithSchema(Parser.java:3024)\r\n&gt; \tat org.h2.command.Parser.readTableFilter(Parser.java:1185) \tat\r\n&gt; org.h2.command.Parser.parseSelectSimpleFromPart(Parser.java:1859) \tat\r\n&gt; org.h2.command.Parser.parseSelectSimple(Parser.java:1968) \tat\r\n&gt; org.h2.command.Parser.parseSelectSub(Parser.java:1853) \tat\r\n&gt; org.h2.command.Parser.parseSelectUnion(Parser.java:1674) \tat\r\n&gt; org.h2.command.Parser.parseSelect(Parser.java:1662) \tat\r\n&gt; org.h2.command.Parser.parsePrepared(Parser.java:434) \tat\r\n&gt; org.h2.command.Parser.parse(Parser.java:306) \tat\r\n&gt; org.h2.command.Parser.parse(Parser.java:278) \tat\r\n&gt; org.h2.command.Parser.prepareCommand(Parser.java:243) \tat\r\n&gt; org.h2.engine.Session.prepareLocal(Session.java:442) \tat\r\n&gt; org.h2.engine.Session.prepareCommand(Session.java:384) \tat\r\n&gt; org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1188)\r\n&gt; \tat org.h2.jdbc.JdbcPreparedStatement.(JdbcPreparedStatement.java:73)\r\n&gt; \tat\r\n&gt; org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:276)\r\n&gt; \tat\r\n&gt; org.apache.commons.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:281)\r\n&gt; \tat\r\n&gt; org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.prepareStatement(PoolingDataSource.java:313)\r\n&gt; \tat\r\n&gt; org.hibernate.engine.jdbc.internal.StatementPreparerImpl$5.doPrepare(StatementPreparerImpl.java:162)\r\n&gt; \tat\r\n&gt; org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:186)\r\n&gt; \tat\r\n&gt; org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareQueryStatement(StatementPreparerImpl.java:160)\r\n&gt; \tat\r\n&gt; org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1884)\r\n&gt; \tat\r\n&gt; org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1861)\r\n&gt; \tat\r\n&gt; org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1838)\r\n&gt; \tat org.hibernate.loader.Loader.doQuery(Loader.java:909) \tat\r\n&gt; org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:354)\r\n&gt; \tat org.hibernate.loader.Loader.doList(Loader.java:2551) \tat\r\n&gt; org.hibernate.loader.Loader.doList(Loader.java:2537) \tat\r\n&gt; org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2367) \tat\r\n&gt; org.hibernate.loader.Loader.list(Loader.java:2362) \tat\r\n&gt; org.hibernate.loader.criteria.CriteriaLoader.list(CriteriaLoader.java:126)\r\n&gt; \tat org.hibernate.internal.SessionImpl.list(SessionImpl.java:1678) \tat\r\n&gt; org.hibernate.internal.CriteriaImpl.list(CriteriaImpl.java:380) \tat\r\n&gt; org.gaca.gms.dao.GenericDAOImpl.getAll(GenericDAOImpl.java:56) \tat\r\n&gt; org.gaca.gms.services.GenericServiceImpl.getAllObjects(GenericServiceImpl.java:61)\r\n&gt; \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) \tat\r\n&gt; sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n&gt; \tat\r\n&gt; sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n&gt; \tat java.lang.reflect.Method.invoke(Method.java:483) \tat\r\n&gt; org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)\r\n&gt; \tat com.sun.proxy.$Proxy39.getAllObjects(Unknown Source) \tat\r\n&gt; org.gaca.gms.controllers.UsersController.listUsers(UsersController.java:43)\r\n&gt; \tat\r\n&gt; org.gaca.gms.controllers.UsersController$$FastClassBySpringCGLIB$$29260f80.invoke()\r\n&gt; \tat\r\n&gt; org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:708)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)\r\n&gt; \tat\r\n&gt; org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\r\n&gt; \tat\r\n&gt; org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:644)\r\n&gt; \tat\r\n&gt; org.gaca.gms.controllers.UsersController$$EnhancerBySpringCGLIB$$de07b585.listUsers()\r\n&gt; \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) \tat\r\n&gt; sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n&gt; \tat\r\n&gt; sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n&gt; \tat java.lang.reflect.Method.invoke(Method.java:483) \tat\r\n&gt; org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:215)\r\n&gt; \tat\r\n&gt; org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:132)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:104)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandleMethod(RequestMappingHandlerAdapter.java:749)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:689)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:83)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:938)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:870)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:961)\r\n&gt; \tat\r\n&gt; org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:852)\r\n&gt; \tat javax.servlet.http.HttpServlet.service(HttpServlet.java:707) \tat\r\n&gt; org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:837)\r\n&gt; \tat javax.servlet.http.HttpServlet.service(HttpServlet.java:820) \tat\r\n&gt; org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:362)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:726)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:206)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\r\n&gt; \tat org.mortbay.jetty.Server.handle(Server.java:324) \tat\r\n&gt; org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)\r\n&gt; \tat\r\n&gt; org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:829)\r\n&gt; \tat org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:514) \tat\r\n&gt; org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211) \tat\r\n&gt; org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380) \tat\r\n&gt; org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395)\r\n&gt; \tat\r\n&gt; org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:488)\r\n\r\nThis is my Spring controller:\r\n\r\n    @SuppressWarnings(&quot;unchecked&quot;)\r\n    \t\t@RequestMapping(method=RequestMethod.GET)\r\n    \t\t  public String listUsers(Map&lt;String, Object&gt; map) {\r\n    \t \r\n    \t        map.put(&quot;user&quot;, new User());\r\n    \t        map.put(&quot;usersList&quot;, usersService.getAllObjects(User.class));\r\n    \t        map.put(&quot;groupsList&quot;, usersService.getAllObjects(Group.class));\r\n    \t        return &quot;index&quot;;\r\n    \t    }\r\n\r\nThis is my JSP page:\r\n \r\n\r\n    &lt;tr&gt;\r\n                      &lt;td&gt;groups&lt;/td&gt;\r\n                      &lt;td&gt;&lt;form:select path=&quot;selectedGroup&quot;&gt;\r\n                      &lt;form:options items=&quot;${groupsList}&quot;/&gt; \r\n                      &lt;/form:select&gt;&lt;/td&gt;\r\n                      &lt;/tr&gt;\r\n\r\n\r\n\r\nI am new to this. Can anybody help?","title":"org.hibernate.exception.SQLGrammarException: could not prepare statement","body":"<p>I have created two entities and am trying to fill one with data after loading it, to show it as a drop down list.</p>\n\n<p>I got the error</p>\n\n<blockquote>\n  <p>org.hibernate.exception.SQLGrammarException: could not prepare statement</p>\n</blockquote>\n\n<p>The <code>Group</code> entity that must be in the drop down list is:</p>\n\n<pre><code>@Entity\n@Table(name=\"GROUP\")\npublic class Group implements Serializable,Lifecycle{\n\n    /**\n     * \n     */\n    private static final long serialVersionUID = 5551707547269388327L;\n    @Id\n    @Column(name=\"ID\")\n    @GeneratedValue\n    private int id;\n    @Column(name=\"E_NAME\")\n    private String eName;\n    @Column(name=\"A_NAME\")\n    private String aName;\n\n    public int getId() {\n        return id;\n    }\n    public void setId(int id) {\n        this.id = id;\n    }\n    public String geteName() {\n        return eName;\n    }\n    public void seteName(String eName) {\n        this.eName = eName;\n    }\n    public String getaName() {\n        return aName;\n    }\n    public void setaName(String aName) {\n        this.aName = aName;\n    }\n\n\n\n\n\n    @Override\n    public boolean onDelete(Session arg0) throws CallbackException {\n        // TODO Auto-generated method stub\n        return false;\n    }\n    @Override\n    public void onLoad(Session session, Serializable arg1) {\n        // TODO Auto-generated method stub\n        Group adminGroup =new Group();\n        Group sectionAdminGroup =new Group();\n        Group userGroup =new Group();\n\n\n\n        adminGroup.seteName(\"Admin\");\n        sectionAdminGroup.seteName(\"Section Admin\");\n        userGroup.seteName(\"User\");\n\n        adminGroup.setaName(\"مسشرف عام\");\n        sectionAdminGroup.setaName(\"مشرف قطاع\");\n        userGroup.setaName(\"مستخدم\");\n\n        session.save(adminGroup);\n        session.save(sectionAdminGroup);\n        session.save(userGroup);\n    }\n    @Override\n    public boolean onSave(Session arg0) throws CallbackException {\n        // TODO Auto-generated method stub\n        return false;\n    }\n    @Override\n    public boolean onUpdate(Session arg0) throws CallbackException {\n        // TODO Auto-generated method stub\n        return false;\n    }\n\n}\n</code></pre>\n\n<p>The stack trace is:</p>\n\n<blockquote>\n  <p>Caused by:</p>\n  \n  <p>org.hibernate.exception.SQLGrammarException: could not prepare\n  statement     at\n  org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:123)\n    at\n  org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:49)\n    at\n  org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:126)\n    at\n  org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:196)\n    at\n  org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareQueryStatement(StatementPreparerImpl.java:160)\n    at\n  org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1884)\n    at\n  org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1861)\n    at\n  org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1838)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:909)     at\n  org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:354)\n    at org.hibernate.loader.Loader.doList(Loader.java:2551)     at\n  org.hibernate.loader.Loader.doList(Loader.java:2537)  at\n  org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2367)    at\n  org.hibernate.loader.Loader.list(Loader.java:2362)    at\n  org.hibernate.loader.criteria.CriteriaLoader.list(CriteriaLoader.java:126)\n    at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1678)   at\n  org.hibernate.internal.CriteriaImpl.list(CriteriaImpl.java:380)   at\n  org.gaca.gms.dao.GenericDAOImpl.getAll(GenericDAOImpl.java:56)    at\n  org.gaca.gms.services.GenericServiceImpl.getAllObjects(GenericServiceImpl.java:61)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)  at\n  sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at\n  sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:483)     at\n  org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)\n    at\n  org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)\n    at\n  org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\n    at\n  org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)\n    at\n  org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)\n    at\n  org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)\n    at\n  org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\n    at\n  org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)\n    at com.sun.proxy.$Proxy39.getAllObjects(Unknown Source)     at\n  org.gaca.gms.controllers.UsersController.listUsers(UsersController.java:43)\n    at\n  org.gaca.gms.controllers.UsersController$$FastClassBySpringCGLIB$$29260f80.invoke()\n    at\n  org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\n    at\n  org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:708)\n    at\n  org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\n    at\n  org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)\n    at\n  org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)\n    at\n  org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)\n    at\n  org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\n    at\n  org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:644)\n    at\n  org.gaca.gms.controllers.UsersController$$EnhancerBySpringCGLIB$$de07b585.listUsers()\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)  at\n  sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at\n  sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:483)     at\n  org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:215)\n    at\n  org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:132)\n    at\n  org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:104)\n    at\n  org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandleMethod(RequestMappingHandlerAdapter.java:749)\n    at\n  org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:689)\n    at\n  org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:83)\n    at\n  org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:938)\n    at\n  org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:870)\n    at\n  org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:961)\n    at\n  org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:852)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)     at\n  org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:837)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)     at\n  org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)\n    at\n  org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:362)\n    at\n  org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\n    at\n  org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)\n    at\n  org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:726)\n    at\n  org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)\n    at\n  org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:206)\n    at\n  org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)\n    at\n  org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n    at org.mortbay.jetty.Server.handle(Server.java:324)     at\n  org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)\n    at\n  org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:829)\n    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:514)  at\n  org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211)  at\n  org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380)  at\n  org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395)\n    at\n  org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:488)\n  Caused by: org.h2.jdbc.JdbcSQLException: Syntax error in SQL statement\n  \"SELECT THIS_.ID AS ID1_0_0_, THIS_.A_NAME AS A_NAME2_0_0_,\n  THIS_.E_NAME AS E_NAME3_0_0_ FROM GROUP[*] THIS_ \"; expected\n  \"identifier\"; SQL statement: select this_.ID as ID1_0_0_, this_.A_NAME\n  as A_NAME2_0_0_, this_.E_NAME as E_NAME3_0_0_ from GROUP this_\n  [42001-178]   at\n  org.h2.message.DbException.getJdbcSQLException(DbException.java:344)\n    at org.h2.message.DbException.getSyntaxError(DbException.java:204)\n    at org.h2.command.Parser.readIdentifierWithSchema(Parser.java:3024)\n    at org.h2.command.Parser.readTableFilter(Parser.java:1185)  at\n  org.h2.command.Parser.parseSelectSimpleFromPart(Parser.java:1859)     at\n  org.h2.command.Parser.parseSelectSimple(Parser.java:1968)     at\n  org.h2.command.Parser.parseSelectSub(Parser.java:1853)    at\n  org.h2.command.Parser.parseSelectUnion(Parser.java:1674)  at\n  org.h2.command.Parser.parseSelect(Parser.java:1662)   at\n  org.h2.command.Parser.parsePrepared(Parser.java:434)  at\n  org.h2.command.Parser.parse(Parser.java:306)  at\n  org.h2.command.Parser.parse(Parser.java:278)  at\n  org.h2.command.Parser.prepareCommand(Parser.java:243)     at\n  org.h2.engine.Session.prepareLocal(Session.java:442)  at\n  org.h2.engine.Session.prepareCommand(Session.java:384)    at\n  org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1188)\n    at org.h2.jdbc.JdbcPreparedStatement.(JdbcPreparedStatement.java:73)\n    at\n  org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:276)\n    at\n  org.apache.commons.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:281)\n    at\n  org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.prepareStatement(PoolingDataSource.java:313)\n    at\n  org.hibernate.engine.jdbc.internal.StatementPreparerImpl$5.doPrepare(StatementPreparerImpl.java:162)\n    at\n  org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:186)\n    ... 73 more</p>\n  \n  <p>Caused by:</p>\n  \n  <p>org.h2.jdbc.JdbcSQLException: Syntax error in SQL statement \"SELECT\n  THIS_.ID AS ID1_0_0_, THIS_.A_NAME AS A_NAME2_0_0_, THIS_.E_NAME AS\n  E_NAME3_0_0_ FROM GROUP[*] THIS_ \"; expected \"identifier\"; SQL\n  statement: select this_.ID as ID1_0_0_, this_.A_NAME as A_NAME2_0_0_,\n  this_.E_NAME as E_NAME3_0_0_ from GROUP this_ [42001-178]     at\n  org.h2.message.DbException.getJdbcSQLException(DbException.java:344)\n    at org.h2.message.DbException.getSyntaxError(DbException.java:204)\n    at org.h2.command.Parser.readIdentifierWithSchema(Parser.java:3024)\n    at org.h2.command.Parser.readTableFilter(Parser.java:1185)  at\n  org.h2.command.Parser.parseSelectSimpleFromPart(Parser.java:1859)     at\n  org.h2.command.Parser.parseSelectSimple(Parser.java:1968)     at\n  org.h2.command.Parser.parseSelectSub(Parser.java:1853)    at\n  org.h2.command.Parser.parseSelectUnion(Parser.java:1674)  at\n  org.h2.command.Parser.parseSelect(Parser.java:1662)   at\n  org.h2.command.Parser.parsePrepared(Parser.java:434)  at\n  org.h2.command.Parser.parse(Parser.java:306)  at\n  org.h2.command.Parser.parse(Parser.java:278)  at\n  org.h2.command.Parser.prepareCommand(Parser.java:243)     at\n  org.h2.engine.Session.prepareLocal(Session.java:442)  at\n  org.h2.engine.Session.prepareCommand(Session.java:384)    at\n  org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1188)\n    at org.h2.jdbc.JdbcPreparedStatement.(JdbcPreparedStatement.java:73)\n    at\n  org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:276)\n    at\n  org.apache.commons.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:281)\n    at\n  org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.prepareStatement(PoolingDataSource.java:313)\n    at\n  org.hibernate.engine.jdbc.internal.StatementPreparerImpl$5.doPrepare(StatementPreparerImpl.java:162)\n    at\n  org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:186)\n    at\n  org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareQueryStatement(StatementPreparerImpl.java:160)\n    at\n  org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1884)\n    at\n  org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1861)\n    at\n  org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1838)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:909)     at\n  org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:354)\n    at org.hibernate.loader.Loader.doList(Loader.java:2551)     at\n  org.hibernate.loader.Loader.doList(Loader.java:2537)  at\n  org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2367)    at\n  org.hibernate.loader.Loader.list(Loader.java:2362)    at\n  org.hibernate.loader.criteria.CriteriaLoader.list(CriteriaLoader.java:126)\n    at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1678)   at\n  org.hibernate.internal.CriteriaImpl.list(CriteriaImpl.java:380)   at\n  org.gaca.gms.dao.GenericDAOImpl.getAll(GenericDAOImpl.java:56)    at\n  org.gaca.gms.services.GenericServiceImpl.getAllObjects(GenericServiceImpl.java:61)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)  at\n  sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at\n  sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:483)     at\n  org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)\n    at\n  org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)\n    at\n  org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\n    at\n  org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)\n    at\n  org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)\n    at\n  org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)\n    at\n  org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\n    at\n  org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)\n    at com.sun.proxy.$Proxy39.getAllObjects(Unknown Source)     at\n  org.gaca.gms.controllers.UsersController.listUsers(UsersController.java:43)\n    at\n  org.gaca.gms.controllers.UsersController$$FastClassBySpringCGLIB$$29260f80.invoke()\n    at\n  org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\n    at\n  org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:708)\n    at\n  org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\n    at\n  org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)\n    at\n  org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)\n    at\n  org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)\n    at\n  org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\n    at\n  org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:644)\n    at\n  org.gaca.gms.controllers.UsersController$$EnhancerBySpringCGLIB$$de07b585.listUsers()\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)  at\n  sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at\n  sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:483)     at\n  org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:215)\n    at\n  org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:132)\n    at\n  org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:104)\n    at\n  org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandleMethod(RequestMappingHandlerAdapter.java:749)\n    at\n  org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:689)\n    at\n  org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:83)\n    at\n  org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:938)\n    at\n  org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:870)\n    at\n  org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:961)\n    at\n  org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:852)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)     at\n  org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:837)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)     at\n  org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)\n    at\n  org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:362)\n    at\n  org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\n    at\n  org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)\n    at\n  org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:726)\n    at\n  org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)\n    at\n  org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:206)\n    at\n  org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)\n    at\n  org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n    at org.mortbay.jetty.Server.handle(Server.java:324)     at\n  org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)\n    at\n  org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:829)\n    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:514)  at\n  org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211)  at\n  org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380)  at\n  org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395)\n    at\n  org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:488)</p>\n</blockquote>\n\n<p>This is my Spring controller:</p>\n\n<pre><code>@SuppressWarnings(\"unchecked\")\n        @RequestMapping(method=RequestMethod.GET)\n          public String listUsers(Map&lt;String, Object&gt; map) {\n\n            map.put(\"user\", new User());\n            map.put(\"usersList\", usersService.getAllObjects(User.class));\n            map.put(\"groupsList\", usersService.getAllObjects(Group.class));\n            return \"index\";\n        }\n</code></pre>\n\n<p>This is my JSP page:</p>\n\n<pre><code>&lt;tr&gt;\n                  &lt;td&gt;groups&lt;/td&gt;\n                  &lt;td&gt;&lt;form:select path=\"selectedGroup\"&gt;\n                  &lt;form:options items=\"${groupsList}\"/&gt; \n                  &lt;/form:select&gt;&lt;/td&gt;\n                  &lt;/tr&gt;\n</code></pre>\n\n<p>I am new to this. Can anybody help?</p>\n"},{"tags":["java","spring","environment-variables"],"owner":{"display_name":"user4654707"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":30,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681047186,"creation_date":1681047186,"question_id":75970833,"body_markdown":"I have the following configuration in my spring xml:\r\n\r\n```\r\n    &lt;jee:jndi-lookup expected-type=&quot;java.lang.String&quot; id=&quot;isTestSystem&quot; jndi-name=&quot;java:comp/env/isTestSystem&quot; /&gt;\r\n    &lt;jee:jndi-lookup expected-type=&quot;java.lang.String&quot; id=&quot;webURL&quot; jndi-name=&quot;java:comp/env/webURL&quot; /&gt;\r\n```\r\n\r\nAnd those are ```@Autowired``` into the code:\r\n\r\n```\r\n@Autowired private String webURL = null;\r\n@Autowired private String isTestSystem = null;\r\n```\r\n\r\nTheir getters and setters are standard get() and set(). I&#39;m getting the following message:\r\n\r\n```\r\n[Time: 09 Apr 2023 09:29:17,438][Thread: main][Log: org.springframework.web.context.support.XmlWebApplicationContext][Level: WARN ] - [File: AbstractApplicationContext.java:591] - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;org.springframework.web.context.support.ServletContextAttributeExporter#0&#39; defined in class path resource [eSolutions/eSolutions-servlet.xml]: Cannot resolve reference to bean &#39;appConfig&#39; while setting bean property &#39;attributes&#39; with key [TypedStringValue: value [appBean], target type [null]]; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;appConfig&#39;: Unsatisfied dependency expressed through field &#39;homePage&#39;; nested exception is org.springframework.beans.factory.NoUniqueBeanDefinitionException: No qualifying bean of type &#39;java.lang.String&#39; available: expected single matching bean but found 2: isTestSystem,webURL\r\n```\r\n\r\nIt appears to be complaining that there are 2 string values available in the naming environment but I can&#39;t understand why. Any ideas?\r\n","title":"Multiple string environment variables and Spriing jee:jndi-lookup","body":"<p>I have the following configuration in my spring xml:</p>\n<pre><code>    &lt;jee:jndi-lookup expected-type=&quot;java.lang.String&quot; id=&quot;isTestSystem&quot; jndi-name=&quot;java:comp/env/isTestSystem&quot; /&gt;\n    &lt;jee:jndi-lookup expected-type=&quot;java.lang.String&quot; id=&quot;webURL&quot; jndi-name=&quot;java:comp/env/webURL&quot; /&gt;\n</code></pre>\n<p>And those are <code>@Autowired</code> into the code:</p>\n<pre><code>@Autowired private String webURL = null;\n@Autowired private String isTestSystem = null;\n</code></pre>\n<p>Their getters and setters are standard get() and set(). I'm getting the following message:</p>\n<pre><code>[Time: 09 Apr 2023 09:29:17,438][Thread: main][Log: org.springframework.web.context.support.XmlWebApplicationContext][Level: WARN ] - [File: AbstractApplicationContext.java:591] - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.web.context.support.ServletContextAttributeExporter#0' defined in class path resource [eSolutions/eSolutions-servlet.xml]: Cannot resolve reference to bean 'appConfig' while setting bean property 'attributes' with key [TypedStringValue: value [appBean], target type [null]]; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'appConfig': Unsatisfied dependency expressed through field 'homePage'; nested exception is org.springframework.beans.factory.NoUniqueBeanDefinitionException: No qualifying bean of type 'java.lang.String' available: expected single matching bean but found 2: isTestSystem,webURL\n</code></pre>\n<p>It appears to be complaining that there are 2 string values available in the naming environment but I can't understand why. Any ideas?</p>\n"},{"tags":["java","spring","oop","design-patterns"],"comments":[{"owner":{"account_id":17520379,"reputation":1536,"user_id":12706564,"display_name":"Emanuel Trandafir"},"score":1,"creation_date":1681050054,"post_id":75970809,"comment_id":133993348,"body_markdown":"why can&#39;t you just create a new instance: ```IClassA c = new ClassAImpl(new ClientServerImpl(key));``` ? If you don&#39;t have access to the class/constructor and inly to the interface, maybe the interface should expose a static factory method. Or use the abstract factory pattern for instantiating it","body":"why can&#39;t you just create a new instance: <code>IClassA c = new ClassAImpl(new ClientServerImpl(key));</code> ? If you don&#39;t have access to the class/constructor and inly to the interface, maybe the interface should expose a static factory method. Or use the abstract factory pattern for instantiating it"}],"owner":{"account_id":15757876,"reputation":119,"user_id":11370492,"display_name":"underachiever"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":55,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681046867,"creation_date":1681046867,"question_id":75970809,"body_markdown":"I have an interface named IClientServer.java\r\n```\r\ninterface IClientServer {\r\n   void save(String fileName);\r\n}\r\n```\r\n\r\nIt&#39;s Impl looks this way:\r\n\r\n```\r\npublic class ClientServerImpl implements IClientServer {\r\n\r\n    private final String key;\r\n    private final Client client;\r\n\r\n    public ClientServerImpl(final String key1, final String key2) {\r\n        this.key = key1 + key2;\r\n        this.client = openConnection(key);\r\n    }\r\n\r\n    @Override\r\n    public void save(String fileName) {\r\n    client.save(fileName);\r\n....\r\n  }\r\n}\r\n```\r\n\r\nNote that the above Interface and Impl are in a common project accessible to all projects and every project currently using this initialize the bean per their own keys at the configuration level and use them directly.\r\n\r\nI now have to create an API that is also in a common project that will need to access the ClientServer\r\n\r\nNew class: IClassA.java\r\n\r\n``` \r\npublic interface IClassA {\r\n   void save(boolean validate, String fileName);\r\n}\r\n```\r\n\r\nIt&#39;s Impl:\r\n```\r\npublic class classA implements IClassA {\r\n\r\n    private final IClientServer clientServer;\r\n\r\n    public classA(IClientServer clientServer) {\r\n        this.clientServer = clientServer;\r\n    }\r\n\r\n    @Override\r\n    public void save(boolean validate, String fileName) {\r\n    //perform computation and then proceed to save\r\n    clientServer.save(fileName);\r\n....\r\n  }\r\n}\r\n```\r\n\r\nNow, `classA.save()` is invoked after consuming a Kafka Record from the topic.\r\n\r\nSince IClassA is also in the common library, how do I initialize `ClientServerImpl` with dynamic keys specific to the caller? \r\n\r\nPS: I can have both the keys as part of the kafka record if it&#39;s needed. ","title":"Java Design Pattern for initializing dynamic private variable","body":"<p>I have an interface named IClientServer.java</p>\n<pre><code>interface IClientServer {\n   void save(String fileName);\n}\n</code></pre>\n<p>It's Impl looks this way:</p>\n<pre><code>public class ClientServerImpl implements IClientServer {\n\n    private final String key;\n    private final Client client;\n\n    public ClientServerImpl(final String key1, final String key2) {\n        this.key = key1 + key2;\n        this.client = openConnection(key);\n    }\n\n    @Override\n    public void save(String fileName) {\n    client.save(fileName);\n....\n  }\n}\n</code></pre>\n<p>Note that the above Interface and Impl are in a common project accessible to all projects and every project currently using this initialize the bean per their own keys at the configuration level and use them directly.</p>\n<p>I now have to create an API that is also in a common project that will need to access the ClientServer</p>\n<p>New class: IClassA.java</p>\n<pre><code>public interface IClassA {\n   void save(boolean validate, String fileName);\n}\n</code></pre>\n<p>It's Impl:</p>\n<pre><code>public class classA implements IClassA {\n\n    private final IClientServer clientServer;\n\n    public classA(IClientServer clientServer) {\n        this.clientServer = clientServer;\n    }\n\n    @Override\n    public void save(boolean validate, String fileName) {\n    //perform computation and then proceed to save\n    clientServer.save(fileName);\n....\n  }\n}\n</code></pre>\n<p>Now, <code>classA.save()</code> is invoked after consuming a Kafka Record from the topic.</p>\n<p>Since IClassA is also in the common library, how do I initialize <code>ClientServerImpl</code> with dynamic keys specific to the caller?</p>\n<p>PS: I can have both the keys as part of the kafka record if it's needed.</p>\n"},{"tags":["java","flask","httpurlconnection","keep-alive","persistent-connection"],"comments":[{"owner":{"account_id":28104689,"reputation":512,"user_id":21473475,"display_name":"Arfur Narf"},"score":0,"creation_date":1680913434,"post_id":75962438,"comment_id":133980137,"body_markdown":"It looks to me like your client code creates a new connection each time through the loop.  I&#39;d explore putting &#39;openConnection&#39; before the loop. That means you&#39;ll need a solution to finding end-of-response other than reading until the end.  Oh, and &#39;connection: keep-alive&#39; is not an HTTP/1.1 thing. The assumption is that it&#39;s kept open unless &#39;connection: close&#39;, i.e., the reverse of HTTP/1.0.","body":"It looks to me like your client code creates a new connection each time through the loop.  I&#39;d explore putting &#39;openConnection&#39; before the loop. That means you&#39;ll need a solution to finding end-of-response other than reading until the end.  Oh, and &#39;connection: keep-alive&#39; is not an HTTP/1.1 thing. The assumption is that it&#39;s kept open unless &#39;connection: close&#39;, i.e., the reverse of HTTP/1.0."},{"owner":{"account_id":28244935,"reputation":23,"user_id":21592144,"display_name":"capalloc"},"score":0,"creation_date":1680950860,"post_id":75962438,"comment_id":133983179,"body_markdown":"@ArfurNarf I&#39;ve tried it and it sounds like a solution to mimic persistent unidirectional server-to-client communication (Flask waits for the entire message before entering the &#39;hello_world&#39; routine so only works for response side) but in my setup, I intend to also send multiple requests along with their responses. Does Java still send &#39;Connection: keep-alive&#39; for backward compatibility, even if its using HTTP/1.1?","body":"@ArfurNarf I&#39;ve tried it and it sounds like a solution to mimic persistent unidirectional server-to-client communication (Flask waits for the entire message before entering the &#39;hello_world&#39; routine so only works for response side) but in my setup, I intend to also send multiple requests along with their responses. Does Java still send &#39;Connection: keep-alive&#39; for backward compatibility, even if its using HTTP/1.1?"},{"owner":{"account_id":28104689,"reputation":512,"user_id":21473475,"display_name":"Arfur Narf"},"score":0,"creation_date":1680961793,"post_id":75962438,"comment_id":133984446,"body_markdown":"I don&#39;t follow what you mean.  But, to be clear, I have no trouble maintaining persistent connections to a Flask server.  In my case, the client code is also Python (using http.client).","body":"I don&#39;t follow what you mean.  But, to be clear, I have no trouble maintaining persistent connections to a Flask server.  In my case, the client code is also Python (using http.client)."},{"owner":{"account_id":28244935,"reputation":23,"user_id":21592144,"display_name":"capalloc"},"score":0,"creation_date":1681046243,"post_id":75962438,"comment_id":133992846,"body_markdown":"@ArfurNarf Werkzeug dropped support for persistent connections in early 2022, which explains the issues I had because I have been using the development WSGI server. Maybe you were using an earlier version of Werkzeug or using a deployment WSGI server. See my answer below.","body":"@ArfurNarf Werkzeug dropped support for persistent connections in early 2022, which explains the issues I had because I have been using the development WSGI server. Maybe you were using an earlier version of Werkzeug or using a deployment WSGI server. See my answer below."},{"owner":{"account_id":28104689,"reputation":512,"user_id":21473475,"display_name":"Arfur Narf"},"score":0,"creation_date":1681048983,"post_id":75962438,"comment_id":133993207,"body_markdown":"Hmm, I suppose I never noticed that change in werkzeug; but I no longer use it. Thanks.","body":"Hmm, I suppose I never noticed that change in werkzeug; but I no longer use it. Thanks."}],"answers":[{"comments":[{"owner":{"account_id":28104689,"reputation":512,"user_id":21473475,"display_name":"Arfur Narf"},"score":1,"creation_date":1681049288,"post_id":75970736,"comment_id":133993250,"body_markdown":"It&#39;s a shame they removed it.  Some time back, I moved to code based directly on http.server, and it was absolutely clear to me from the http.server documentation that you must read the request body even if you did not need to see it (say, if status != success).  Removing useful functionality from werkzeug because people can&#39;t read documentation seems like a good way to get people to not be using werkzeug.","body":"It&#39;s a shame they removed it.  Some time back, I moved to code based directly on http.server, and it was absolutely clear to me from the http.server documentation that you must read the request body even if you did not need to see it (say, if status != success).  Removing useful functionality from werkzeug because people can&#39;t read documentation seems like a good way to get people to not be using werkzeug."}],"tags":[],"owner":{"account_id":28244935,"reputation":23,"user_id":21592144,"display_name":"capalloc"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1681046045,"creation_date":1681046045,"answer_id":75970736,"question_id":75962438,"body_markdown":"I had been trying to achieve persistent connection using the WSGI server Flask comes packaged with called Werkzeug. When I switched to a deployment WSGI server, in my case Waitress, `keep-alive` started to work and TCP connections stopped being dropped. The issue was being caused by a change in Werkzeug implementation. Their change log for `Version 2.1.2` released in 2022-04-28 states:\r\n\r\n&gt; Disable keep-alive connections in the development server, which are not supported sufficiently by Python’s `http.server`. [#2397][1]\r\n\r\nWerkzeug team removed the persistent connection support due to the shortcomings of `http.server` which it extends. While it is understandable that the lack of `keep-alive` function may not be essential in a development environment, it is frustrating that there is very little to no communication about this in the Internet.\r\n\r\n  [1]: https://github.com/pallets/werkzeug/issues/2397","title":"Why doesn&#39;t Flask establish persistent HTTP connection with multiple requests from Java application using HttpURLConnection?","body":"<p>I had been trying to achieve persistent connection using the WSGI server Flask comes packaged with called Werkzeug. When I switched to a deployment WSGI server, in my case Waitress, <code>keep-alive</code> started to work and TCP connections stopped being dropped. The issue was being caused by a change in Werkzeug implementation. Their change log for <code>Version 2.1.2</code> released in 2022-04-28 states:</p>\n<blockquote>\n<p>Disable keep-alive connections in the development server, which are not supported sufficiently by Python’s <code>http.server</code>. <a href=\"https://github.com/pallets/werkzeug/issues/2397\" rel=\"nofollow noreferrer\">#2397</a></p>\n</blockquote>\n<p>Werkzeug team removed the persistent connection support due to the shortcomings of <code>http.server</code> which it extends. While it is understandable that the lack of <code>keep-alive</code> function may not be essential in a development environment, it is frustrating that there is very little to no communication about this in the Internet.</p>\n"}],"owner":{"account_id":28244935,"reputation":23,"user_id":21592144,"display_name":"capalloc"},"comment_count":5,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":151,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"accepted_answer_id":75970736,"answer_count":1,"score":2,"last_activity_date":1681046045,"creation_date":1680907836,"question_id":75962438,"body_markdown":"I have a minor project which will involve repeated HTTPS communication between a Java application and a Flask web server such that keeping the TCP connection alive is important. In order to test and understand the capabilities of these technologies, I have set up a simple GET request generator which sends multiple GET requests with time invertals to my simple Flask web server application and return a response. In such a setup, I would expect the TCP connection to be cached but I think my Flask application disconnects the connection after each response. Beware that I am quite rusty with Java and it is my first time getting acquainted with Flask.\r\n\r\nMy Java GET request generator is like below:\r\n\r\n\r\n```lang-java\r\npackage com.deu;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.IOException;\r\nimport java.io.InputStreamReader;\r\nimport java.net.HttpURLConnection;\r\nimport java.net.URL;\r\n\r\npublic class Main {\r\n\r\n    public static void main(String[] args) {\r\n        try {\r\n            sendHttpRequests(&quot;http://127.0.0.1:5000&quot;, 1000, 5);\r\n        } catch (IOException | InterruptedException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n    public static void sendHttpRequests(String url, int interval, int count) throws IOException, InterruptedException {\r\n        URL hostURL = new URL(url);\r\n\r\n        for (int i = 0; i &lt; count; i++) {\r\n            HttpURLConnection httpConn = (HttpURLConnection) hostURL.openConnection();\r\n            httpConn.setRequestMethod(&quot;GET&quot;);\r\n\r\n            BufferedReader reader = new BufferedReader(new InputStreamReader(httpConn.getInputStream()));\r\n            StringBuilder response = new StringBuilder();\r\n            String line;\r\n\r\n            while ((line = reader.readLine()) != null)\r\n                response.append(line);\r\n\r\n            System.out.println(&quot;Response to i=&quot;+i+&quot; &quot;+response.toString());\r\n            reader.close();\r\n\r\n            Thread.sleep(interval);\r\n        }\r\n    }\r\n\r\n}\r\n\r\n```\r\nMy Flask web server application is like below:\r\n\r\n\r\n```lang-python\r\nimport flask\r\nfrom flask import Flask, request\r\nfrom werkzeug.serving import WSGIRequestHandler\r\n\r\napp = Flask(__name__)\r\n\r\n\r\n@app.route(&#39;/&#39;, methods=[&#39;GET&#39;])\r\ndef hello_world():\r\n    resp = flask.Response(&quot;Hello World!&quot;)\r\n    print(request.headers)\r\n    print(resp.headers)\r\n\r\n    return resp\r\n\r\n\r\nif __name__ == &#39;__main__&#39;:\r\n    WSGIRequestHandler.protocol_version = &quot;HTTP/1.1&quot;\r\n    app.run()\r\n\r\n```\r\n\r\nAfter the Java application terminates, the outputs I get for Java and Flask applications respectively are:\r\n\r\n```lang-none\r\nResponse to i=0 Hello World!\r\nResponse to i=1 Hello World!\r\nResponse to i=2 Hello World!\r\nResponse to i=3 Hello World!\r\nResponse to i=4 Hello World!\r\n```\r\n\r\n\r\n```lang-none\r\nFLASK_APP = app.py\r\nFLASK_ENV = development\r\nFLASK_DEBUG = 0\r\nIn folder B:/Development/Projects/Python/ProjectABC\r\nB:\\Development\\Projects\\Python\\ProjectABC\\venv\\Scripts\\python.exe -m flask run\r\n * Serving Flask app &#39;app.py&#39;\r\n * Debug mode: off\r\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\r\n * Running on http://127.0.0.1:5000\r\nPress CTRL+C to quit\r\nUser-Agent: Java/17.0.1\r\nHost: 127.0.0.1:5000\r\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\r\nConnection: keep-alive\r\n\r\n\r\nContent-Type: text/html; charset=utf-8\r\nContent-Length: 12\r\n\r\n\r\n127.0.0.1 - - [08/Apr/2023 01:26:28] &quot;GET / HTTP/1.1&quot; 200 -\r\n127.0.0.1 - - [08/Apr/2023 01:26:29] &quot;GET / HTTP/1.1&quot; 200 -\r\nUser-Agent: Java/17.0.1\r\nHost: 127.0.0.1:5000\r\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\r\nConnection: keep-alive\r\n\r\n\r\nContent-Type: text/html; charset=utf-8\r\nContent-Length: 12\r\n\r\n\r\nUser-Agent: Java/17.0.1\r\nHost: 127.0.0.1:5000\r\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\r\nConnection: keep-alive\r\n\r\n\r\nContent-Type: text/html; charset=utf-8\r\nContent-Length: 12\r\n\r\n\r\n127.0.0.1 - - [08/Apr/2023 01:26:30] &quot;GET / HTTP/1.1&quot; 200 -\r\nUser-Agent: Java/17.0.1\r\nHost: 127.0.0.1:5000\r\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\r\nConnection: keep-alive\r\n\r\n\r\nContent-Type: text/html; charset=utf-8\r\nContent-Length: 12\r\n\r\n\r\n127.0.0.1 - - [08/Apr/2023 01:26:31] &quot;GET / HTTP/1.1&quot; 200 -\r\nUser-Agent: Java/17.0.1\r\nHost: 127.0.0.1:5000\r\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\r\nConnection: keep-alive\r\n\r\n\r\nContent-Type: text/html; charset=utf-8\r\nContent-Length: 12\r\n\r\n\r\n127.0.0.1 - - [08/Apr/2023 01:26:32] &quot;GET / HTTP/1.1&quot; 200 -\r\n\r\n```\r\nAs can be seen, the requests receive responses as expected and even the request headers Flask application received shows the presence of `Connection: keep-alive`. But the reason I think a new TCP connection is created each time are that the response headers do not contain `Connection: keep-alive` and the output of `netstat` cmd command:\r\n\r\n\r\n```lang-none\r\nActive Connections\r\n\r\n  Proto  Local Address          Foreign Address        State\r\n  TCP    127.0.0.1:5000         DESKTOP-XXXXXXX:52821  TIME_WAIT\r\n  TCP    127.0.0.1:5000         DESKTOP-XXXXXXX:52823  TIME_WAIT\r\n  TCP    127.0.0.1:5000         DESKTOP-XXXXXXX:52824  TIME_WAIT\r\n  TCP    127.0.0.1:5000         DESKTOP-XXXXXXX:52830  TIME_WAIT\r\n  TCP    127.0.0.1:5000         DESKTOP-XXXXXXX:52831  TIME_WAIT\r\n```\r\n\r\nIf my understanding of the output is correct (please correct me if I am wrong), 5 different TCP connections were made and now the OS is waiting to clear them, indicating `keep-alive` has failed. I searched other questions for answers and tried putting `WSGIRequestHandler.protocol_version = &quot;HTTP/1.1&quot;` but to no avail.\r\n\r\nNote: I am trying to achieve persistent connection using HTTP first, after which I will apply it to HTTPS.\r\n","title":"Why doesn&#39;t Flask establish persistent HTTP connection with multiple requests from Java application using HttpURLConnection?","body":"<p>I have a minor project which will involve repeated HTTPS communication between a Java application and a Flask web server such that keeping the TCP connection alive is important. In order to test and understand the capabilities of these technologies, I have set up a simple GET request generator which sends multiple GET requests with time invertals to my simple Flask web server application and return a response. In such a setup, I would expect the TCP connection to be cached but I think my Flask application disconnects the connection after each response. Beware that I am quite rusty with Java and it is my first time getting acquainted with Flask.</p>\n<p>My Java GET request generator is like below:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.deu;\n\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.net.HttpURLConnection;\nimport java.net.URL;\n\npublic class Main {\n\n    public static void main(String[] args) {\n        try {\n            sendHttpRequests(&quot;http://127.0.0.1:5000&quot;, 1000, 5);\n        } catch (IOException | InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n\n    public static void sendHttpRequests(String url, int interval, int count) throws IOException, InterruptedException {\n        URL hostURL = new URL(url);\n\n        for (int i = 0; i &lt; count; i++) {\n            HttpURLConnection httpConn = (HttpURLConnection) hostURL.openConnection();\n            httpConn.setRequestMethod(&quot;GET&quot;);\n\n            BufferedReader reader = new BufferedReader(new InputStreamReader(httpConn.getInputStream()));\n            StringBuilder response = new StringBuilder();\n            String line;\n\n            while ((line = reader.readLine()) != null)\n                response.append(line);\n\n            System.out.println(&quot;Response to i=&quot;+i+&quot; &quot;+response.toString());\n            reader.close();\n\n            Thread.sleep(interval);\n        }\n    }\n\n}\n\n</code></pre>\n<p>My Flask web server application is like below:</p>\n<pre class=\"lang-python prettyprint-override\"><code>import flask\nfrom flask import Flask, request\nfrom werkzeug.serving import WSGIRequestHandler\n\napp = Flask(__name__)\n\n\n@app.route('/', methods=['GET'])\ndef hello_world():\n    resp = flask.Response(&quot;Hello World!&quot;)\n    print(request.headers)\n    print(resp.headers)\n\n    return resp\n\n\nif __name__ == '__main__':\n    WSGIRequestHandler.protocol_version = &quot;HTTP/1.1&quot;\n    app.run()\n\n</code></pre>\n<p>After the Java application terminates, the outputs I get for Java and Flask applications respectively are:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Response to i=0 Hello World!\nResponse to i=1 Hello World!\nResponse to i=2 Hello World!\nResponse to i=3 Hello World!\nResponse to i=4 Hello World!\n</code></pre>\n<pre class=\"lang-none prettyprint-override\"><code>FLASK_APP = app.py\nFLASK_ENV = development\nFLASK_DEBUG = 0\nIn folder B:/Development/Projects/Python/ProjectABC\nB:\\Development\\Projects\\Python\\ProjectABC\\venv\\Scripts\\python.exe -m flask run\n * Serving Flask app 'app.py'\n * Debug mode: off\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\n * Running on http://127.0.0.1:5000\nPress CTRL+C to quit\nUser-Agent: Java/17.0.1\nHost: 127.0.0.1:5000\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\nConnection: keep-alive\n\n\nContent-Type: text/html; charset=utf-8\nContent-Length: 12\n\n\n127.0.0.1 - - [08/Apr/2023 01:26:28] &quot;GET / HTTP/1.1&quot; 200 -\n127.0.0.1 - - [08/Apr/2023 01:26:29] &quot;GET / HTTP/1.1&quot; 200 -\nUser-Agent: Java/17.0.1\nHost: 127.0.0.1:5000\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\nConnection: keep-alive\n\n\nContent-Type: text/html; charset=utf-8\nContent-Length: 12\n\n\nUser-Agent: Java/17.0.1\nHost: 127.0.0.1:5000\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\nConnection: keep-alive\n\n\nContent-Type: text/html; charset=utf-8\nContent-Length: 12\n\n\n127.0.0.1 - - [08/Apr/2023 01:26:30] &quot;GET / HTTP/1.1&quot; 200 -\nUser-Agent: Java/17.0.1\nHost: 127.0.0.1:5000\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\nConnection: keep-alive\n\n\nContent-Type: text/html; charset=utf-8\nContent-Length: 12\n\n\n127.0.0.1 - - [08/Apr/2023 01:26:31] &quot;GET / HTTP/1.1&quot; 200 -\nUser-Agent: Java/17.0.1\nHost: 127.0.0.1:5000\nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\nConnection: keep-alive\n\n\nContent-Type: text/html; charset=utf-8\nContent-Length: 12\n\n\n127.0.0.1 - - [08/Apr/2023 01:26:32] &quot;GET / HTTP/1.1&quot; 200 -\n\n</code></pre>\n<p>As can be seen, the requests receive responses as expected and even the request headers Flask application received shows the presence of <code>Connection: keep-alive</code>. But the reason I think a new TCP connection is created each time are that the response headers do not contain <code>Connection: keep-alive</code> and the output of <code>netstat</code> cmd command:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Active Connections\n\n  Proto  Local Address          Foreign Address        State\n  TCP    127.0.0.1:5000         DESKTOP-XXXXXXX:52821  TIME_WAIT\n  TCP    127.0.0.1:5000         DESKTOP-XXXXXXX:52823  TIME_WAIT\n  TCP    127.0.0.1:5000         DESKTOP-XXXXXXX:52824  TIME_WAIT\n  TCP    127.0.0.1:5000         DESKTOP-XXXXXXX:52830  TIME_WAIT\n  TCP    127.0.0.1:5000         DESKTOP-XXXXXXX:52831  TIME_WAIT\n</code></pre>\n<p>If my understanding of the output is correct (please correct me if I am wrong), 5 different TCP connections were made and now the OS is waiting to clear them, indicating <code>keep-alive</code> has failed. I searched other questions for answers and tried putting <code>WSGIRequestHandler.protocol_version = &quot;HTTP/1.1&quot;</code> but to no avail.</p>\n<p>Note: I am trying to achieve persistent connection using HTTP first, after which I will apply it to HTTPS.</p>\n"},{"tags":["java","eclipse"],"comments":[{"owner":{"account_id":3159259,"reputation":109678,"user_id":2670892,"display_name":"greg-449"},"score":1,"creation_date":1681050526,"post_id":75970672,"comment_id":133993396,"body_markdown":"Probably &quot;Preferences &gt; Java &gt; Installed JREs &gt; Execution Environments&quot; Select JavaSE-19 and choose the appropriate JRE.","body":"Probably &quot;Preferences &gt; Java &gt; Installed JREs &gt; Execution Environments&quot; Select JavaSE-19 and choose the appropriate JRE."}],"owner":{"account_id":14919577,"reputation":11,"user_id":10772349,"display_name":"Juan Hern&#225;ndez"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":250,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681045433,"creation_date":1681045433,"question_id":75970672,"body_markdown":"I&#39;m working on a new computer and I`m getting an error I never had before when creating a Java project on Eclipse (The one in the title).\r\n\r\n I&#39;ve done a little research and the error can be fixed by going to Project &gt; Properties &gt; Java Build Path &gt; Libraries, then remove the one is causing the error and adding JRE System Library (I don&#39;t really understand why it works in the first place).\r\n\r\nBut this only fixes the problem for this project, if I were to create a new one it will happen again.\r\n\r\nIs there any global configuration I can apply to fix it? Thanks :)\r\n\r\n[![this is the error I get](https://i.stack.imgur.com/6sjno.png)](https://i.stack.imgur.com/6sjno.png)","title":"Unbound classpasth container: &#39;JRE System Library[JavaSE-19]&#39; in project &#39;name&#39;","body":"<p>I'm working on a new computer and I`m getting an error I never had before when creating a Java project on Eclipse (The one in the title).</p>\n<p>I've done a little research and the error can be fixed by going to Project &gt; Properties &gt; Java Build Path &gt; Libraries, then remove the one is causing the error and adding JRE System Library (I don't really understand why it works in the first place).</p>\n<p>But this only fixes the problem for this project, if I were to create a new one it will happen again.</p>\n<p>Is there any global configuration I can apply to fix it? Thanks :)</p>\n<p><a href=\"https://i.stack.imgur.com/6sjno.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6sjno.png\" alt=\"this is the error I get\" /></a></p>\n"},{"tags":["python","java","firebase","firebase-cloud-messaging"],"comments":[{"owner":{"account_id":24401476,"reputation":1704,"user_id":18400908,"display_name":"Сергей Кох"},"score":0,"creation_date":1681023274,"post_id":75967302,"comment_id":133990475,"body_markdown":"Please trim your code to make it easier to find your problem. Follow these guidelines to create a [minimal reproducible example](https://stackoverflow.com/help/minimal-reproducible-example).","body":"Please trim your code to make it easier to find your problem. Follow these guidelines to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}],"owner":{"account_id":26684041,"reputation":59,"user_id":20293622,"display_name":"ASD"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":169,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1681045015,"creation_date":1680982303,"question_id":75967302,"body_markdown":"I am developing an app with kivy framework(on python), and i use [pushyy](https://github.com/Fox520/pushyy), its a library that let me to recieve and show up notifications when app is in background, but i dont know how to make them showing up when app is in foreground, docs below:\r\n\r\nP.S.: I am very new at java so can you please answer with more details if it wont be difficult for you, Thanl you!\r\n\r\nContextHolder.java:\r\n\r\n```\r\n// Copyright 2020 The Chromium Authors. All rights reserved.\r\npackage org.kivy.plugins.messaging;\r\n\r\nimport android.content.Context;\r\nimport android.util.Log;\r\n\r\npublic class ContextHolder {\r\n    private static Context applicationContext;\r\n\r\n    public static Context getApplicationContext() {\r\n        return applicationContext;\r\n    }\r\n\r\n    public static void setApplicationContext(Context applicationContext) {\r\n        Log.d(&quot;KVFireContextHolder&quot;, &quot;received application context.&quot;);\r\n        ContextHolder.applicationContext = applicationContext;\r\n    }\r\n}\r\n```\r\n\r\nKivyFirebaseMessagingBackgroundExecutor.java:\r\n\r\n```\r\n// Copyright 2020 The Chromium Authors. All rights reserved.\r\npackage org.kivy.plugins.messaging;\r\n\r\nimport android.util.Log;\r\n\r\nimport java.util.concurrent.atomic.AtomicBoolean;\r\n\r\npublic class KivyFirebaseMessagingBackgroundExecutor {\r\nprivate static AtomicBoolean started = new AtomicBoolean(false);\r\n    public static void startBackgroundPythonService() {\r\n\r\n        Log.d(&quot;BackgroundExecutor&quot;, &quot;Starting background service&quot;);\r\n        ru.asoms.myapp.ServicePythonnotificationhandler.start(ContextHolder.getApplicationContext(), &quot;&quot;);\r\n        Log.d(&quot;BackgroundExecutor&quot;, &quot;Background service started&quot;);\r\n\r\n    }\r\n\r\n}\r\n```\r\n\r\nKivyFirebaseMessagingBackgroundService.java:\r\n\r\n```\r\n// Copyright 2020 The Chromium Authors. All rights reserved.\r\npackage org.kivy.plugins.messaging;\r\n\r\n\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.os.Handler;\r\nimport android.util.Log;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.core.app.JobIntentService;\r\n\r\nimport com.google.firebase.messaging.RemoteMessage;\r\n\r\nimport java.util.Map;\r\nimport java.util.concurrent.CountDownLatch;\r\n\r\npublic class KivyFirebaseMessagingBackgroundService extends JobIntentService {\r\n    private static final String TAG = &quot;KVFireMsgService&quot;;\r\n\r\n    /**\r\n     * Schedule the message to be handled by the {@link KivyFirebaseMessagingBackgroundService}.\r\n     */\r\n    public static void enqueueMessageProcessing(Context context, Intent messageIntent) {\r\n        enqueueWork(\r\n                context,\r\n                KivyFirebaseMessagingBackgroundService.class,\r\n                KivyFirebaseMessagingUtils.JOB_ID,\r\n                messageIntent);\r\n    }\r\n\r\n    @Override\r\n    public void onCreate() {\r\n        super.onCreate();\r\n        KivyFirebaseMessagingBackgroundExecutor.startBackgroundPythonService();\r\n    }\r\n\r\n    @Override\r\n    protected void onHandleWork(@NonNull final Intent intent) {\r\n\r\n\r\n        // There were no pre-existing callback requests. Execute the callback\r\n        // specified by the incoming intent.\r\n        final CountDownLatch latch = new CountDownLatch(1);\r\n\r\n        new Handler(getMainLooper())\r\n                .post(new Runnable() {\r\n                          @Override\r\n                          public void run() {\r\n                              RemoteMessage remoteMessage =\r\n                                      intent.getParcelableExtra(KivyFirebaseMessagingUtils.EXTRA_REMOTE_MESSAGE);\r\n                              if (remoteMessage != null) {\r\n                                  Map&lt;String, Object&gt; remoteMessageMap =\r\n                                          KivyFirebaseMessagingUtils.remoteMessageToMap(remoteMessage);\r\n                                  remoteMessageMap.put(&quot;unique_key&quot;, Math.random() + &quot;&quot;);\r\n                                  PlatformIntermediate.addbackroundMessage(remoteMessageMap, ContextHolder.getApplicationContext());\r\n                              }\r\n                              // End\r\n                              latch.countDown();\r\n                          }\r\n                      }\r\n                );\r\n\r\n        try {\r\n            latch.await();\r\n        } catch (InterruptedException ex) {\r\n            Log.i(TAG, &quot;Exception waiting to execute Python callback&quot;, ex);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nKivyFireBaseMessagingReceiver.java:\r\n\r\n```\r\n// Copyright 2020 The Chromium Authors. All rights reserved.\r\npackage org.kivy.plugins.messaging;\r\n\r\n\r\nimport android.content.BroadcastReceiver;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.util.Log;\r\nimport com.google.firebase.messaging.RemoteMessage;\r\nimport java.util.HashMap;\r\n\r\n\r\npublic class KivyFirebaseMessagingReceiver extends BroadcastReceiver {\r\n    private static final String TAG = &quot;FLTFireMsgReceiver&quot;;\r\n    static HashMap&lt;String, RemoteMessage&gt; notifications = new HashMap&lt;&gt;();\r\n\r\n    @Override\r\n    public void onReceive(Context context, Intent intent) {\r\n        Log.d(TAG, &quot;broadcast received for message&quot;);\r\n        if (ContextHolder.getApplicationContext() == null) {\r\n            ContextHolder.setApplicationContext(context.getApplicationContext());\r\n        }\r\n\r\n        RemoteMessage remoteMessage = new RemoteMessage(intent.getExtras());\r\n\r\n        // Store the RemoteMessage if the message contains a notification payload.\r\n        if (remoteMessage.getNotification() != null) {\r\n            notifications.put(remoteMessage.getMessageId(), remoteMessage);\r\n            KivyFirebaseMessagingStore.getInstance().storeFirebaseMessage(remoteMessage);\r\n        }\r\n\r\n        //  |-&gt; ---------------------\r\n        //      App in Foreground\r\n        //   ------------------------\r\n        if (KivyFirebaseMessagingUtils.isApplicationForeground(context)) {\r\n            Log.d(TAG, &quot;Setting the foreground. BTW, title is &quot; + remoteMessage.getNotification().getTitle());\r\n            PlatformIntermediate.setForegroundMessage(KivyFirebaseMessagingUtils.remoteMessageToMap(remoteMessage));\r\n            return;\r\n        }\r\n\r\n\r\n\r\n        //  |-&gt; ---------------------\r\n        //    App in Background/Quit\r\n        //   ------------------------\r\n        Log.d(TAG, &quot;App in Background/Quit &quot; + remoteMessage.getNotification().getTitle());\r\n//        HashMap&lt;String, Object&gt; payload = new HashMap&lt;&gt;();\r\n//        payload.put(&quot;unique_key&quot;, Math.random());\r\n//        payload.put(&quot;payload_type&quot;, &quot;BACKGROUND_MSG&quot;);\r\n//        payload.put(&quot;data&quot;, KivyFirebaseMessagingUtils.remoteMessageToMap(remoteMessage));\r\n//        Gson gson = new Gson();\r\n//        String json = gson.toJson(payload);\r\n//        backgroundMessages.put(Math.random()+&quot;&quot;,json);\r\n//        com.waterfall.youtube.ServicePythonnotificationhandler.start(org.kivy.android.PythonActivity.mActivity, json);\r\n        // Issue with above is it relies on the Python service to be not running. Moment it&#39;s already running and you try starting\r\n        // it, Android won&#39;t allow that.\r\n\r\n        Intent onBackgroundMessageIntent =\r\n                new Intent(context, org.kivy.plugins.messaging.KivyFirebaseMessagingBackgroundService.class);\r\n        onBackgroundMessageIntent.putExtra(\r\n                KivyFirebaseMessagingUtils.EXTRA_REMOTE_MESSAGE, remoteMessage);\r\n        org.kivy.plugins.messaging.KivyFirebaseMessagingBackgroundService.enqueueMessageProcessing(\r\n                context, onBackgroundMessageIntent);\r\n    }\r\n}\r\n```\r\n\r\nKivyFirebaseMessagingService.java:\r\n\r\n```\r\n// Copyright 2020 The Chromium Authors. All rights reserved.\r\npackage org.kivy.plugins.messaging;\r\n\r\n\r\n\r\nimport androidx.annotation.NonNull;\r\n\r\nimport com.google.firebase.messaging.FirebaseMessagingService;\r\nimport com.google.firebase.messaging.RemoteMessage;\r\n\r\npublic class KivyFirebaseMessagingService extends FirebaseMessagingService {\r\n    @Override\r\n    public void onNewToken(@NonNull String token) {\r\n        PlatformIntermediate.token = token;\r\n    }\r\n\r\n    @Override\r\n    public void onMessageReceived(@NonNull RemoteMessage remoteMessage) {\r\n        // Added for commenting purposes;\r\n        // We don&#39;t handle the message here as we already handle it in the receiver and don&#39;t want to duplicate.\r\n    }\r\n}\r\n```\r\n\r\nKivyFirebaseMessagingStore.java:\r\n\r\n```\r\n// Copyright 2020 The Chromium Authors. All rights reserved.\r\npackage org.kivy.plugins.messaging;\r\n\r\n\r\nimport android.content.Context;\r\nimport android.content.SharedPreferences;\r\nimport com.google.firebase.messaging.RemoteMessage;\r\nimport java.util.ArrayList;\r\nimport java.util.Arrays;\r\nimport java.util.HashMap;\r\nimport java.util.Iterator;\r\nimport java.util.List;\r\nimport java.util.Map;\r\nimport org.json.JSONArray;\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\npublic class KivyFirebaseMessagingStore {\r\n    private static final String PREFERENCES_FILE = &quot;io.flutter.plugins.firebase.messaging&quot;;\r\n    private static final String KEY_NOTIFICATION_IDS = &quot;notification_ids&quot;;\r\n    private static final int MAX_SIZE_NOTIFICATIONS = 20;\r\n    private static KivyFirebaseMessagingStore instance;\r\n    private final String DELIMITER = &quot;,&quot;;\r\n    private SharedPreferences preferences;\r\n\r\n    public static KivyFirebaseMessagingStore getInstance() {\r\n        if (instance == null) {\r\n            instance = new KivyFirebaseMessagingStore();\r\n        }\r\n        return instance;\r\n    }\r\n\r\n    private SharedPreferences getPreferences() {\r\n        if (preferences == null) {\r\n            preferences =\r\n                    ContextHolder.getApplicationContext()\r\n                            .getSharedPreferences(PREFERENCES_FILE, Context.MODE_PRIVATE);\r\n        }\r\n        return preferences;\r\n    }\r\n\r\n    public void setPreferencesStringValue(String key, String value) {\r\n        getPreferences().edit().putString(key, value).apply();\r\n    }\r\n\r\n    public String getPreferencesStringValue(String key, String defaultValue) {\r\n        return getPreferences().getString(key, defaultValue);\r\n    }\r\n\r\n    public void storeFirebaseMessage(RemoteMessage remoteMessage) {\r\n        String remoteMessageString =\r\n                new JSONObject(KivyFirebaseMessagingUtils.remoteMessageToMap(remoteMessage)).toString();\r\n        setPreferencesStringValue(remoteMessage.getMessageId(), remoteMessageString);\r\n\r\n        // Save new notification id.\r\n        // Note that this is using a comma delimited string to preserve ordering. We could use a String Set\r\n        // on SharedPreferences but this won&#39;t guarantee ordering when we want to remove the oldest added ids.\r\n        String notifications = getPreferencesStringValue(KEY_NOTIFICATION_IDS, &quot;&quot;);\r\n        notifications += remoteMessage.getMessageId() + DELIMITER; // append to last\r\n\r\n        // Check and remove old notification messages.\r\n        List&lt;String&gt; allNotificationList =\r\n                new ArrayList&lt;&gt;(Arrays.asList(notifications.split(DELIMITER)));\r\n        if (allNotificationList.size() &gt; MAX_SIZE_NOTIFICATIONS) {\r\n            String firstRemoteMessageId = allNotificationList.get(0);\r\n            getPreferences().edit().remove(firstRemoteMessageId).apply();\r\n            notifications = notifications.replace(firstRemoteMessageId + DELIMITER, &quot;&quot;);\r\n        }\r\n\r\n        setPreferencesStringValue(KEY_NOTIFICATION_IDS, notifications);\r\n    }\r\n\r\n    public RemoteMessage getFirebaseMessage(String remoteMessageId) {\r\n        String remoteMessageString = getPreferencesStringValue(remoteMessageId, null);\r\n        if (remoteMessageString != null) {\r\n            try {\r\n                Map&lt;String, Object&gt; argumentsMap = new HashMap&lt;&gt;(1);\r\n                Map&lt;String, Object&gt; messageOutMap = jsonObjectToMap(new JSONObject(remoteMessageString));\r\n                // Add a fake &#39;to&#39; - as it&#39;s required to construct a RemoteMessage instance.\r\n                messageOutMap.put(&quot;to&quot;, remoteMessageId);\r\n                argumentsMap.put(&quot;message&quot;, messageOutMap);\r\n                return KivyFirebaseMessagingUtils.getRemoteMessageForArguments(argumentsMap);\r\n            } catch (JSONException e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    public void removeFirebaseMessage(String remoteMessageId) {\r\n        getPreferences().edit().remove(remoteMessageId).apply();\r\n        String notifications = getPreferencesStringValue(KEY_NOTIFICATION_IDS, &quot;&quot;);\r\n        if (!notifications.isEmpty()) {\r\n            notifications = notifications.replace(remoteMessageId + DELIMITER, &quot;&quot;);\r\n            setPreferencesStringValue(KEY_NOTIFICATION_IDS, notifications);\r\n        }\r\n    }\r\n\r\n    private Map&lt;String, Object&gt; jsonObjectToMap(JSONObject jsonObject) throws JSONException {\r\n        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\r\n        Iterator&lt;String&gt; keys = jsonObject.keys();\r\n        while (keys.hasNext()) {\r\n            String key = keys.next();\r\n            Object value = jsonObject.get(key);\r\n            if (value instanceof JSONArray) {\r\n                value = jsonArrayToList((JSONArray) value);\r\n            } else if (value instanceof JSONObject) {\r\n                value = jsonObjectToMap((JSONObject) value);\r\n            }\r\n            map.put(key, value);\r\n        }\r\n        return map;\r\n    }\r\n\r\n    public List&lt;Object&gt; jsonArrayToList(JSONArray array) throws JSONException {\r\n        List&lt;Object&gt; list = new ArrayList&lt;&gt;();\r\n        for (int i = 0; i &lt; array.length(); i++) {\r\n            Object value = array.get(i);\r\n            if (value instanceof JSONArray) {\r\n                value = jsonArrayToList((JSONArray) value);\r\n            } else if (value instanceof JSONObject) {\r\n                value = jsonObjectToMap((JSONObject) value);\r\n            }\r\n            list.add(value);\r\n        }\r\n        return list;\r\n    }\r\n}\r\n```\r\n\r\nKivyFirebaseMessagingUtils.java:\r\n\r\n```\r\n// Copyright 2020 The Chromium Authors. All rights reserved.\r\npackage org.kivy.plugins.messaging;\r\n\r\nimport android.app.ActivityManager;\r\nimport android.app.KeyguardManager;\r\nimport android.content.Context;\r\nimport com.google.firebase.messaging.FirebaseMessaging;\r\nimport com.google.firebase.messaging.RemoteMessage;\r\nimport java.util.Arrays;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\nimport java.util.Objects;\r\nimport java.util.Set;\r\n\r\nclass KivyFirebaseMessagingUtils {\r\n    static final String IS_AUTO_INIT_ENABLED = &quot;isAutoInitEnabled&quot;;\r\n    static final String SHARED_PREFERENCES_KEY = &quot;io.flutter.firebase.messaging.callback&quot;;\r\n    static final String ACTION_REMOTE_MESSAGE = &quot;io.flutter.plugins.firebase.messaging.NOTIFICATION&quot;;\r\n    static final String EXTRA_REMOTE_MESSAGE = &quot;notification&quot;;\r\n    static final String ACTION_TOKEN = &quot;io.flutter.plugins.firebase.messaging.TOKEN&quot;;\r\n    static final String EXTRA_TOKEN = &quot;token&quot;;\r\n    static final int JOB_ID = 2020;\r\n    private static final String KEY_COLLAPSE_KEY = &quot;collapseKey&quot;;\r\n    private static final String KEY_DATA = &quot;data&quot;;\r\n    private static final String KEY_FROM = &quot;from&quot;;\r\n    private static final String KEY_MESSAGE_ID = &quot;messageId&quot;;\r\n    private static final String KEY_MESSAGE_TYPE = &quot;messageType&quot;;\r\n    private static final String KEY_SENT_TIME = &quot;sentTime&quot;;\r\n    private static final String KEY_TO = &quot;to&quot;;\r\n    private static final String KEY_TTL = &quot;ttl&quot;;\r\n\r\n    static Map&lt;String, Object&gt; remoteMessageToMap(RemoteMessage remoteMessage) {\r\n        Map&lt;String, Object&gt; messageMap = new HashMap&lt;&gt;();\r\n        Map&lt;String, Object&gt; dataMap = new HashMap&lt;&gt;();\r\n\r\n        if (remoteMessage.getCollapseKey() != null) {\r\n            messageMap.put(KEY_COLLAPSE_KEY, remoteMessage.getCollapseKey());\r\n        }\r\n\r\n        if (remoteMessage.getFrom() != null) {\r\n            messageMap.put(KEY_FROM, remoteMessage.getFrom());\r\n        }\r\n\r\n        if (remoteMessage.getTo() != null) {\r\n            messageMap.put(KEY_TO, remoteMessage.getTo());\r\n        }\r\n\r\n        if (remoteMessage.getMessageId() != null) {\r\n            messageMap.put(KEY_MESSAGE_ID, remoteMessage.getMessageId());\r\n        }\r\n\r\n        if (remoteMessage.getMessageType() != null) {\r\n            messageMap.put(KEY_MESSAGE_TYPE, remoteMessage.getMessageType());\r\n        }\r\n\r\n        if (remoteMessage.getData().size() &gt; 0) {\r\n            Set&lt;Map.Entry&lt;String, String&gt;&gt; entries = remoteMessage.getData().entrySet();\r\n            for (Map.Entry&lt;String, String&gt; entry : entries) {\r\n                dataMap.put(entry.getKey(), entry.getValue());\r\n            }\r\n        }\r\n\r\n        messageMap.put(KEY_DATA, dataMap);\r\n        messageMap.put(KEY_TTL, remoteMessage.getTtl());\r\n        messageMap.put(KEY_SENT_TIME, remoteMessage.getSentTime());\r\n\r\n        if (remoteMessage.getNotification() != null) {\r\n            messageMap.put(\r\n                    &quot;notification&quot;, remoteMessageNotificationToMap(remoteMessage.getNotification()));\r\n        }\r\n\r\n        return messageMap;\r\n    }\r\n\r\n    private static Map&lt;String, Object&gt; remoteMessageNotificationToMap(\r\n            RemoteMessage.Notification notification) {\r\n        Map&lt;String, Object&gt; notificationMap = new HashMap&lt;&gt;();\r\n        Map&lt;String, Object&gt; androidNotificationMap = new HashMap&lt;&gt;();\r\n\r\n        if (notification.getTitle() != null) {\r\n            notificationMap.put(&quot;title&quot;, notification.getTitle());\r\n        }\r\n\r\n        if (notification.getTitleLocalizationKey() != null) {\r\n            notificationMap.put(&quot;titleLocKey&quot;, notification.getTitleLocalizationKey());\r\n        }\r\n\r\n        if (notification.getTitleLocalizationArgs() != null) {\r\n            notificationMap.put(&quot;titleLocArgs&quot;, Arrays.asList(notification.getTitleLocalizationArgs()));\r\n        }\r\n\r\n        if (notification.getBody() != null) {\r\n            notificationMap.put(&quot;body&quot;, notification.getBody());\r\n        }\r\n\r\n        if (notification.getBodyLocalizationKey() != null) {\r\n            notificationMap.put(&quot;bodyLocKey&quot;, notification.getBodyLocalizationKey());\r\n        }\r\n\r\n        if (notification.getBodyLocalizationArgs() != null) {\r\n            notificationMap.put(&quot;bodyLocArgs&quot;, Arrays.asList(notification.getBodyLocalizationArgs()));\r\n        }\r\n\r\n        if (notification.getChannelId() != null) {\r\n            androidNotificationMap.put(&quot;channelId&quot;, notification.getChannelId());\r\n        }\r\n\r\n        if (notification.getClickAction() != null) {\r\n            androidNotificationMap.put(&quot;clickAction&quot;, notification.getClickAction());\r\n        }\r\n\r\n        if (notification.getColor() != null) {\r\n            androidNotificationMap.put(&quot;color&quot;, notification.getColor());\r\n        }\r\n\r\n        if (notification.getIcon() != null) {\r\n            androidNotificationMap.put(&quot;smallIcon&quot;, notification.getIcon());\r\n        }\r\n\r\n        if (notification.getImageUrl() != null) {\r\n            androidNotificationMap.put(&quot;imageUrl&quot;, notification.getImageUrl().toString());\r\n        }\r\n\r\n        if (notification.getLink() != null) {\r\n            androidNotificationMap.put(&quot;link&quot;, notification.getLink().toString());\r\n        }\r\n\r\n        if (notification.getNotificationCount() != null) {\r\n            androidNotificationMap.put(&quot;count&quot;, notification.getNotificationCount());\r\n        }\r\n\r\n        if (notification.getNotificationPriority() != null) {\r\n            androidNotificationMap.put(&quot;priority&quot;, notification.getNotificationPriority());\r\n        }\r\n\r\n        if (notification.getSound() != null) {\r\n            androidNotificationMap.put(&quot;sound&quot;, notification.getSound());\r\n        }\r\n\r\n        if (notification.getTicker() != null) {\r\n            androidNotificationMap.put(&quot;ticker&quot;, notification.getTicker());\r\n        }\r\n\r\n        if (notification.getVisibility() != null) {\r\n            androidNotificationMap.put(&quot;visibility&quot;, notification.getVisibility());\r\n        }\r\n\r\n        if (notification.getTag() != null) {\r\n            androidNotificationMap.put(&quot;tag&quot;, notification.getTag());\r\n        }\r\n\r\n        notificationMap.put(&quot;android&quot;, androidNotificationMap);\r\n        return notificationMap;\r\n    }\r\n\r\n    /**\r\n     * Identify if the application is currently in a state where user interaction is possible. This\r\n     * method is called when a remote message is received to determine how the incoming message should\r\n     * be handled.\r\n     *\r\n     * @param context context.\r\n     * @return True if the application is currently in a state where user interaction is possible,\r\n     *     false otherwise.\r\n     */\r\n    static boolean isApplicationForeground(Context context) {\r\n        KeyguardManager keyguardManager =\r\n                (KeyguardManager) context.getSystemService(Context.KEYGUARD_SERVICE);\r\n\r\n        if (keyguardManager != null &amp;&amp; keyguardManager.isKeyguardLocked()) {\r\n            return false;\r\n        }\r\n\r\n        ActivityManager activityManager =\r\n                (ActivityManager) context.getSystemService(Context.ACTIVITY_SERVICE);\r\n        if (activityManager == null) return false;\r\n\r\n        List&lt;ActivityManager.RunningAppProcessInfo&gt; appProcesses =\r\n                activityManager.getRunningAppProcesses();\r\n        if (appProcesses == null) return false;\r\n\r\n        final String packageName = context.getPackageName();\r\n        for (ActivityManager.RunningAppProcessInfo appProcess : appProcesses) {\r\n            if (appProcess.importance == ActivityManager.RunningAppProcessInfo.IMPORTANCE_FOREGROUND\r\n                    &amp;&amp; appProcess.processName.equals(packageName)) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    // Extracted to handle multi-app support in the future.\r\n    // arguments.get(&quot;appName&quot;) - to get the Firebase app name.\r\n    static FirebaseMessaging getFirebaseMessagingForArguments(Map&lt;String, Object&gt; arguments) {\r\n        return FirebaseMessaging.getInstance();\r\n    }\r\n\r\n    /**\r\n     * Builds an instance of {@link RemoteMessage} from Flutter method channel call arguments.\r\n     *\r\n     * @param arguments Method channel call arguments.\r\n     * @return RemoteMessage\r\n     */\r\n    static RemoteMessage getRemoteMessageForArguments(Map&lt;String, Object&gt; arguments) {\r\n        @SuppressWarnings(&quot;unchecked&quot;)\r\n        Map&lt;String, Object&gt; messageMap =\r\n                (Map&lt;String, Object&gt;) Objects.requireNonNull(arguments.get(&quot;message&quot;));\r\n\r\n        String to = (String) Objects.requireNonNull(messageMap.get(&quot;to&quot;));\r\n        RemoteMessage.Builder builder = new RemoteMessage.Builder(to);\r\n\r\n        String collapseKey = (String) messageMap.get(&quot;collapseKey&quot;);\r\n        String messageId = (String) messageMap.get(&quot;messageId&quot;);\r\n        String messageType = (String) messageMap.get(&quot;messageType&quot;);\r\n        Integer ttl = (Integer) messageMap.get(&quot;ttl&quot;);\r\n\r\n        @SuppressWarnings(&quot;unchecked&quot;)\r\n        Map&lt;String, String&gt; data = (Map&lt;String, String&gt;) messageMap.get(&quot;data&quot;);\r\n\r\n        if (collapseKey != null) {\r\n            builder.setCollapseKey(collapseKey);\r\n        }\r\n\r\n        if (messageType != null) {\r\n            builder.setMessageType(messageType);\r\n        }\r\n\r\n        if (messageId != null) {\r\n            builder.setMessageId(messageId);\r\n        }\r\n\r\n        if (ttl != null) {\r\n            builder.setTtl(ttl);\r\n        }\r\n\r\n        if (data != null) {\r\n            builder.setData(data);\r\n        }\r\n\r\n        return builder.build();\r\n    }\r\n}\r\n```\r\n\r\nPlatformIntermediate.java:\r\n\r\n```\r\npackage org.kivy.plugins.messaging;\r\n\r\nimport android.content.Context;\r\nimport android.util.Log;\r\n\r\nimport com.google.gson.Gson;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.BufferedWriter;\r\nimport java.io.FileNotFoundException;\r\nimport java.io.FileOutputStream;\r\nimport java.io.FileReader;\r\nimport java.io.IOException;\r\nimport java.io.OutputStreamWriter;\r\nimport java.io.UnsupportedEncodingException;\r\nimport java.io.Writer;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic class PlatformIntermediate {\r\n    private static HashMap&lt;String, Object&gt; _foregroundMessage = new HashMap&lt;String, Object&gt;();\r\n    final public static HashMap&lt;String, Object&gt; backgroundMessages = new HashMap&lt;String, Object&gt;();\r\n    public static String token = &quot;&quot;;\r\n    private static final String BACKGROUND_MSG_FILE_NAME = &quot;/background_messages.json&quot;;\r\n\r\n    public static String getForegroundMessage() {\r\n        return new Gson().toJson(_foregroundMessage);\r\n    }\r\n\r\n    public static void setForegroundMessage(Map&lt;String, Object&gt; msg) {\r\n        HashMap&lt;String, Object&gt; copy = new HashMap&lt;String, Object&gt;(msg);\r\n        _foregroundMessage = copy;\r\n\r\n        _foregroundMessage.put(&quot;unique_key&quot;, Math.random());\r\n        Log.d(&quot;PlatformIntermediate&quot;, &quot;setForegroundMessage worked &quot; + _foregroundMessage.toString());\r\n    }\r\n\r\n    public static void addbackroundMessage(Map&lt;String, Object&gt; remoteMessageMap, Context context) {\r\n        try {\r\n            ru.asoms.myapp.ServicePythonnotificationhandler.start(org.kivy.android.PythonActivity.mActivity, &quot;&quot;);\r\n        } catch (Exception e) {\r\n            Log.d(&quot;PlatformIntermediate&quot;, &quot;Exception occurred while trying to start service: &quot; + e.getMessage());\r\n        }\r\n        backgroundMessages.put(remoteMessageMap.get(&quot;unique_key&quot;).toString(), remoteMessageMap);\r\n\r\n        // Read stored json\r\n        String jsonText = readBackgroundFile(context);\r\n\r\n        Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();\r\n        if (jsonText.length() &gt; 0) {\r\n            map = (Map&lt;String, Object&gt;) new Gson().fromJson(jsonText, map.getClass());\r\n        }\r\n        boolean shouldRecreateFile = false;\r\n        // Merge with map where key does not exist or create file if map size is 0\r\n        if (map.size() == 0) {\r\n            shouldRecreateFile = true;\r\n        } else {\r\n            for (String key : map.keySet()) {\r\n                if (backgroundMessages.get(key) == null) {\r\n                    backgroundMessages.put(key, map.get(key));\r\n                    shouldRecreateFile = true;\r\n                }\r\n            }\r\n        }\r\n        // Write to file\r\n        if (shouldRecreateFile) {\r\n//            deleteBackgroundFile(context);\r\n            writeBackgroundFile(new Gson().toJson(backgroundMessages), context);\r\n\r\n        }\r\n        Log.d(&quot;PlatformIntermediate&quot;, &quot;New message added, recreated: &quot;+shouldRecreateFile +&quot; &quot;+context.getFilesDir().getPath());\r\n        if(shouldRecreateFile == false){\r\n            Log.d(&quot;PlatformIntermediate&quot;, map.toString());\r\n\r\n        }\r\n    }\r\n\r\n    public static void writeBackgroundFile(String data, Context context) {\r\n        try (Writer writer = new BufferedWriter(new OutputStreamWriter(\r\n                new FileOutputStream(context.getFilesDir().getPath()+BACKGROUND_MSG_FILE_NAME), &quot;utf-8&quot;))) {\r\n            writer.write(data);\r\n        } catch (UnsupportedEncodingException e) {\r\n            e.printStackTrace();\r\n        } catch (FileNotFoundException e) {\r\n            e.printStackTrace();\r\n        } catch (IOException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n    public static String readBackgroundFile(Context context) {\r\n        String ret = &quot;&quot;;\r\n        try (BufferedReader br = new BufferedReader(new FileReader(context.getFilesDir().getPath()+BACKGROUND_MSG_FILE_NAME))) {\r\n            StringBuilder sb = new StringBuilder();\r\n            String line = br.readLine();\r\n            while (line != null) {\r\n                sb.append(line);\r\n                sb.append(&quot;\\n&quot;);\r\n                line = br.readLine();\r\n            }\r\n            ret = sb.toString();\r\n        } catch (IOException e) {\r\n            e.printStackTrace();\r\n        }\r\n        return ret;\r\n    }\r\n}\r\n```\r\n\r\nI am new to java so i google about firebase notifications in foreground but they all doing it in main class of the app so i clearly dont understand it","title":"How to recieve and show up notifications from firebase when app is on foreground?","body":"<p>I am developing an app with kivy framework(on python), and i use <a href=\"https://github.com/Fox520/pushyy\" rel=\"nofollow noreferrer\">pushyy</a>, its a library that let me to recieve and show up notifications when app is in background, but i dont know how to make them showing up when app is in foreground, docs below:</p>\n<p>P.S.: I am very new at java so can you please answer with more details if it wont be difficult for you, Thanl you!</p>\n<p>ContextHolder.java:</p>\n<pre><code>// Copyright 2020 The Chromium Authors. All rights reserved.\npackage org.kivy.plugins.messaging;\n\nimport android.content.Context;\nimport android.util.Log;\n\npublic class ContextHolder {\n    private static Context applicationContext;\n\n    public static Context getApplicationContext() {\n        return applicationContext;\n    }\n\n    public static void setApplicationContext(Context applicationContext) {\n        Log.d(&quot;KVFireContextHolder&quot;, &quot;received application context.&quot;);\n        ContextHolder.applicationContext = applicationContext;\n    }\n}\n</code></pre>\n<p>KivyFirebaseMessagingBackgroundExecutor.java:</p>\n<pre><code>// Copyright 2020 The Chromium Authors. All rights reserved.\npackage org.kivy.plugins.messaging;\n\nimport android.util.Log;\n\nimport java.util.concurrent.atomic.AtomicBoolean;\n\npublic class KivyFirebaseMessagingBackgroundExecutor {\nprivate static AtomicBoolean started = new AtomicBoolean(false);\n    public static void startBackgroundPythonService() {\n\n        Log.d(&quot;BackgroundExecutor&quot;, &quot;Starting background service&quot;);\n        ru.asoms.myapp.ServicePythonnotificationhandler.start(ContextHolder.getApplicationContext(), &quot;&quot;);\n        Log.d(&quot;BackgroundExecutor&quot;, &quot;Background service started&quot;);\n\n    }\n\n}\n</code></pre>\n<p>KivyFirebaseMessagingBackgroundService.java:</p>\n<pre><code>// Copyright 2020 The Chromium Authors. All rights reserved.\npackage org.kivy.plugins.messaging;\n\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.os.Handler;\nimport android.util.Log;\n\nimport androidx.annotation.NonNull;\nimport androidx.core.app.JobIntentService;\n\nimport com.google.firebase.messaging.RemoteMessage;\n\nimport java.util.Map;\nimport java.util.concurrent.CountDownLatch;\n\npublic class KivyFirebaseMessagingBackgroundService extends JobIntentService {\n    private static final String TAG = &quot;KVFireMsgService&quot;;\n\n    /**\n     * Schedule the message to be handled by the {@link KivyFirebaseMessagingBackgroundService}.\n     */\n    public static void enqueueMessageProcessing(Context context, Intent messageIntent) {\n        enqueueWork(\n                context,\n                KivyFirebaseMessagingBackgroundService.class,\n                KivyFirebaseMessagingUtils.JOB_ID,\n                messageIntent);\n    }\n\n    @Override\n    public void onCreate() {\n        super.onCreate();\n        KivyFirebaseMessagingBackgroundExecutor.startBackgroundPythonService();\n    }\n\n    @Override\n    protected void onHandleWork(@NonNull final Intent intent) {\n\n\n        // There were no pre-existing callback requests. Execute the callback\n        // specified by the incoming intent.\n        final CountDownLatch latch = new CountDownLatch(1);\n\n        new Handler(getMainLooper())\n                .post(new Runnable() {\n                          @Override\n                          public void run() {\n                              RemoteMessage remoteMessage =\n                                      intent.getParcelableExtra(KivyFirebaseMessagingUtils.EXTRA_REMOTE_MESSAGE);\n                              if (remoteMessage != null) {\n                                  Map&lt;String, Object&gt; remoteMessageMap =\n                                          KivyFirebaseMessagingUtils.remoteMessageToMap(remoteMessage);\n                                  remoteMessageMap.put(&quot;unique_key&quot;, Math.random() + &quot;&quot;);\n                                  PlatformIntermediate.addbackroundMessage(remoteMessageMap, ContextHolder.getApplicationContext());\n                              }\n                              // End\n                              latch.countDown();\n                          }\n                      }\n                );\n\n        try {\n            latch.await();\n        } catch (InterruptedException ex) {\n            Log.i(TAG, &quot;Exception waiting to execute Python callback&quot;, ex);\n        }\n    }\n}\n</code></pre>\n<p>KivyFireBaseMessagingReceiver.java:</p>\n<pre><code>// Copyright 2020 The Chromium Authors. All rights reserved.\npackage org.kivy.plugins.messaging;\n\n\nimport android.content.BroadcastReceiver;\nimport android.content.Context;\nimport android.content.Intent;\nimport android.util.Log;\nimport com.google.firebase.messaging.RemoteMessage;\nimport java.util.HashMap;\n\n\npublic class KivyFirebaseMessagingReceiver extends BroadcastReceiver {\n    private static final String TAG = &quot;FLTFireMsgReceiver&quot;;\n    static HashMap&lt;String, RemoteMessage&gt; notifications = new HashMap&lt;&gt;();\n\n    @Override\n    public void onReceive(Context context, Intent intent) {\n        Log.d(TAG, &quot;broadcast received for message&quot;);\n        if (ContextHolder.getApplicationContext() == null) {\n            ContextHolder.setApplicationContext(context.getApplicationContext());\n        }\n\n        RemoteMessage remoteMessage = new RemoteMessage(intent.getExtras());\n\n        // Store the RemoteMessage if the message contains a notification payload.\n        if (remoteMessage.getNotification() != null) {\n            notifications.put(remoteMessage.getMessageId(), remoteMessage);\n            KivyFirebaseMessagingStore.getInstance().storeFirebaseMessage(remoteMessage);\n        }\n\n        //  |-&gt; ---------------------\n        //      App in Foreground\n        //   ------------------------\n        if (KivyFirebaseMessagingUtils.isApplicationForeground(context)) {\n            Log.d(TAG, &quot;Setting the foreground. BTW, title is &quot; + remoteMessage.getNotification().getTitle());\n            PlatformIntermediate.setForegroundMessage(KivyFirebaseMessagingUtils.remoteMessageToMap(remoteMessage));\n            return;\n        }\n\n\n\n        //  |-&gt; ---------------------\n        //    App in Background/Quit\n        //   ------------------------\n        Log.d(TAG, &quot;App in Background/Quit &quot; + remoteMessage.getNotification().getTitle());\n//        HashMap&lt;String, Object&gt; payload = new HashMap&lt;&gt;();\n//        payload.put(&quot;unique_key&quot;, Math.random());\n//        payload.put(&quot;payload_type&quot;, &quot;BACKGROUND_MSG&quot;);\n//        payload.put(&quot;data&quot;, KivyFirebaseMessagingUtils.remoteMessageToMap(remoteMessage));\n//        Gson gson = new Gson();\n//        String json = gson.toJson(payload);\n//        backgroundMessages.put(Math.random()+&quot;&quot;,json);\n//        com.waterfall.youtube.ServicePythonnotificationhandler.start(org.kivy.android.PythonActivity.mActivity, json);\n        // Issue with above is it relies on the Python service to be not running. Moment it's already running and you try starting\n        // it, Android won't allow that.\n\n        Intent onBackgroundMessageIntent =\n                new Intent(context, org.kivy.plugins.messaging.KivyFirebaseMessagingBackgroundService.class);\n        onBackgroundMessageIntent.putExtra(\n                KivyFirebaseMessagingUtils.EXTRA_REMOTE_MESSAGE, remoteMessage);\n        org.kivy.plugins.messaging.KivyFirebaseMessagingBackgroundService.enqueueMessageProcessing(\n                context, onBackgroundMessageIntent);\n    }\n}\n</code></pre>\n<p>KivyFirebaseMessagingService.java:</p>\n<pre><code>// Copyright 2020 The Chromium Authors. All rights reserved.\npackage org.kivy.plugins.messaging;\n\n\n\nimport androidx.annotation.NonNull;\n\nimport com.google.firebase.messaging.FirebaseMessagingService;\nimport com.google.firebase.messaging.RemoteMessage;\n\npublic class KivyFirebaseMessagingService extends FirebaseMessagingService {\n    @Override\n    public void onNewToken(@NonNull String token) {\n        PlatformIntermediate.token = token;\n    }\n\n    @Override\n    public void onMessageReceived(@NonNull RemoteMessage remoteMessage) {\n        // Added for commenting purposes;\n        // We don't handle the message here as we already handle it in the receiver and don't want to duplicate.\n    }\n}\n</code></pre>\n<p>KivyFirebaseMessagingStore.java:</p>\n<pre><code>// Copyright 2020 The Chromium Authors. All rights reserved.\npackage org.kivy.plugins.messaging;\n\n\nimport android.content.Context;\nimport android.content.SharedPreferences;\nimport com.google.firebase.messaging.RemoteMessage;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.HashMap;\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.Map;\nimport org.json.JSONArray;\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\npublic class KivyFirebaseMessagingStore {\n    private static final String PREFERENCES_FILE = &quot;io.flutter.plugins.firebase.messaging&quot;;\n    private static final String KEY_NOTIFICATION_IDS = &quot;notification_ids&quot;;\n    private static final int MAX_SIZE_NOTIFICATIONS = 20;\n    private static KivyFirebaseMessagingStore instance;\n    private final String DELIMITER = &quot;,&quot;;\n    private SharedPreferences preferences;\n\n    public static KivyFirebaseMessagingStore getInstance() {\n        if (instance == null) {\n            instance = new KivyFirebaseMessagingStore();\n        }\n        return instance;\n    }\n\n    private SharedPreferences getPreferences() {\n        if (preferences == null) {\n            preferences =\n                    ContextHolder.getApplicationContext()\n                            .getSharedPreferences(PREFERENCES_FILE, Context.MODE_PRIVATE);\n        }\n        return preferences;\n    }\n\n    public void setPreferencesStringValue(String key, String value) {\n        getPreferences().edit().putString(key, value).apply();\n    }\n\n    public String getPreferencesStringValue(String key, String defaultValue) {\n        return getPreferences().getString(key, defaultValue);\n    }\n\n    public void storeFirebaseMessage(RemoteMessage remoteMessage) {\n        String remoteMessageString =\n                new JSONObject(KivyFirebaseMessagingUtils.remoteMessageToMap(remoteMessage)).toString();\n        setPreferencesStringValue(remoteMessage.getMessageId(), remoteMessageString);\n\n        // Save new notification id.\n        // Note that this is using a comma delimited string to preserve ordering. We could use a String Set\n        // on SharedPreferences but this won't guarantee ordering when we want to remove the oldest added ids.\n        String notifications = getPreferencesStringValue(KEY_NOTIFICATION_IDS, &quot;&quot;);\n        notifications += remoteMessage.getMessageId() + DELIMITER; // append to last\n\n        // Check and remove old notification messages.\n        List&lt;String&gt; allNotificationList =\n                new ArrayList&lt;&gt;(Arrays.asList(notifications.split(DELIMITER)));\n        if (allNotificationList.size() &gt; MAX_SIZE_NOTIFICATIONS) {\n            String firstRemoteMessageId = allNotificationList.get(0);\n            getPreferences().edit().remove(firstRemoteMessageId).apply();\n            notifications = notifications.replace(firstRemoteMessageId + DELIMITER, &quot;&quot;);\n        }\n\n        setPreferencesStringValue(KEY_NOTIFICATION_IDS, notifications);\n    }\n\n    public RemoteMessage getFirebaseMessage(String remoteMessageId) {\n        String remoteMessageString = getPreferencesStringValue(remoteMessageId, null);\n        if (remoteMessageString != null) {\n            try {\n                Map&lt;String, Object&gt; argumentsMap = new HashMap&lt;&gt;(1);\n                Map&lt;String, Object&gt; messageOutMap = jsonObjectToMap(new JSONObject(remoteMessageString));\n                // Add a fake 'to' - as it's required to construct a RemoteMessage instance.\n                messageOutMap.put(&quot;to&quot;, remoteMessageId);\n                argumentsMap.put(&quot;message&quot;, messageOutMap);\n                return KivyFirebaseMessagingUtils.getRemoteMessageForArguments(argumentsMap);\n            } catch (JSONException e) {\n                e.printStackTrace();\n            }\n        }\n        return null;\n    }\n\n    public void removeFirebaseMessage(String remoteMessageId) {\n        getPreferences().edit().remove(remoteMessageId).apply();\n        String notifications = getPreferencesStringValue(KEY_NOTIFICATION_IDS, &quot;&quot;);\n        if (!notifications.isEmpty()) {\n            notifications = notifications.replace(remoteMessageId + DELIMITER, &quot;&quot;);\n            setPreferencesStringValue(KEY_NOTIFICATION_IDS, notifications);\n        }\n    }\n\n    private Map&lt;String, Object&gt; jsonObjectToMap(JSONObject jsonObject) throws JSONException {\n        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n        Iterator&lt;String&gt; keys = jsonObject.keys();\n        while (keys.hasNext()) {\n            String key = keys.next();\n            Object value = jsonObject.get(key);\n            if (value instanceof JSONArray) {\n                value = jsonArrayToList((JSONArray) value);\n            } else if (value instanceof JSONObject) {\n                value = jsonObjectToMap((JSONObject) value);\n            }\n            map.put(key, value);\n        }\n        return map;\n    }\n\n    public List&lt;Object&gt; jsonArrayToList(JSONArray array) throws JSONException {\n        List&lt;Object&gt; list = new ArrayList&lt;&gt;();\n        for (int i = 0; i &lt; array.length(); i++) {\n            Object value = array.get(i);\n            if (value instanceof JSONArray) {\n                value = jsonArrayToList((JSONArray) value);\n            } else if (value instanceof JSONObject) {\n                value = jsonObjectToMap((JSONObject) value);\n            }\n            list.add(value);\n        }\n        return list;\n    }\n}\n</code></pre>\n<p>KivyFirebaseMessagingUtils.java:</p>\n<pre><code>// Copyright 2020 The Chromium Authors. All rights reserved.\npackage org.kivy.plugins.messaging;\n\nimport android.app.ActivityManager;\nimport android.app.KeyguardManager;\nimport android.content.Context;\nimport com.google.firebase.messaging.FirebaseMessaging;\nimport com.google.firebase.messaging.RemoteMessage;\nimport java.util.Arrays;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Objects;\nimport java.util.Set;\n\nclass KivyFirebaseMessagingUtils {\n    static final String IS_AUTO_INIT_ENABLED = &quot;isAutoInitEnabled&quot;;\n    static final String SHARED_PREFERENCES_KEY = &quot;io.flutter.firebase.messaging.callback&quot;;\n    static final String ACTION_REMOTE_MESSAGE = &quot;io.flutter.plugins.firebase.messaging.NOTIFICATION&quot;;\n    static final String EXTRA_REMOTE_MESSAGE = &quot;notification&quot;;\n    static final String ACTION_TOKEN = &quot;io.flutter.plugins.firebase.messaging.TOKEN&quot;;\n    static final String EXTRA_TOKEN = &quot;token&quot;;\n    static final int JOB_ID = 2020;\n    private static final String KEY_COLLAPSE_KEY = &quot;collapseKey&quot;;\n    private static final String KEY_DATA = &quot;data&quot;;\n    private static final String KEY_FROM = &quot;from&quot;;\n    private static final String KEY_MESSAGE_ID = &quot;messageId&quot;;\n    private static final String KEY_MESSAGE_TYPE = &quot;messageType&quot;;\n    private static final String KEY_SENT_TIME = &quot;sentTime&quot;;\n    private static final String KEY_TO = &quot;to&quot;;\n    private static final String KEY_TTL = &quot;ttl&quot;;\n\n    static Map&lt;String, Object&gt; remoteMessageToMap(RemoteMessage remoteMessage) {\n        Map&lt;String, Object&gt; messageMap = new HashMap&lt;&gt;();\n        Map&lt;String, Object&gt; dataMap = new HashMap&lt;&gt;();\n\n        if (remoteMessage.getCollapseKey() != null) {\n            messageMap.put(KEY_COLLAPSE_KEY, remoteMessage.getCollapseKey());\n        }\n\n        if (remoteMessage.getFrom() != null) {\n            messageMap.put(KEY_FROM, remoteMessage.getFrom());\n        }\n\n        if (remoteMessage.getTo() != null) {\n            messageMap.put(KEY_TO, remoteMessage.getTo());\n        }\n\n        if (remoteMessage.getMessageId() != null) {\n            messageMap.put(KEY_MESSAGE_ID, remoteMessage.getMessageId());\n        }\n\n        if (remoteMessage.getMessageType() != null) {\n            messageMap.put(KEY_MESSAGE_TYPE, remoteMessage.getMessageType());\n        }\n\n        if (remoteMessage.getData().size() &gt; 0) {\n            Set&lt;Map.Entry&lt;String, String&gt;&gt; entries = remoteMessage.getData().entrySet();\n            for (Map.Entry&lt;String, String&gt; entry : entries) {\n                dataMap.put(entry.getKey(), entry.getValue());\n            }\n        }\n\n        messageMap.put(KEY_DATA, dataMap);\n        messageMap.put(KEY_TTL, remoteMessage.getTtl());\n        messageMap.put(KEY_SENT_TIME, remoteMessage.getSentTime());\n\n        if (remoteMessage.getNotification() != null) {\n            messageMap.put(\n                    &quot;notification&quot;, remoteMessageNotificationToMap(remoteMessage.getNotification()));\n        }\n\n        return messageMap;\n    }\n\n    private static Map&lt;String, Object&gt; remoteMessageNotificationToMap(\n            RemoteMessage.Notification notification) {\n        Map&lt;String, Object&gt; notificationMap = new HashMap&lt;&gt;();\n        Map&lt;String, Object&gt; androidNotificationMap = new HashMap&lt;&gt;();\n\n        if (notification.getTitle() != null) {\n            notificationMap.put(&quot;title&quot;, notification.getTitle());\n        }\n\n        if (notification.getTitleLocalizationKey() != null) {\n            notificationMap.put(&quot;titleLocKey&quot;, notification.getTitleLocalizationKey());\n        }\n\n        if (notification.getTitleLocalizationArgs() != null) {\n            notificationMap.put(&quot;titleLocArgs&quot;, Arrays.asList(notification.getTitleLocalizationArgs()));\n        }\n\n        if (notification.getBody() != null) {\n            notificationMap.put(&quot;body&quot;, notification.getBody());\n        }\n\n        if (notification.getBodyLocalizationKey() != null) {\n            notificationMap.put(&quot;bodyLocKey&quot;, notification.getBodyLocalizationKey());\n        }\n\n        if (notification.getBodyLocalizationArgs() != null) {\n            notificationMap.put(&quot;bodyLocArgs&quot;, Arrays.asList(notification.getBodyLocalizationArgs()));\n        }\n\n        if (notification.getChannelId() != null) {\n            androidNotificationMap.put(&quot;channelId&quot;, notification.getChannelId());\n        }\n\n        if (notification.getClickAction() != null) {\n            androidNotificationMap.put(&quot;clickAction&quot;, notification.getClickAction());\n        }\n\n        if (notification.getColor() != null) {\n            androidNotificationMap.put(&quot;color&quot;, notification.getColor());\n        }\n\n        if (notification.getIcon() != null) {\n            androidNotificationMap.put(&quot;smallIcon&quot;, notification.getIcon());\n        }\n\n        if (notification.getImageUrl() != null) {\n            androidNotificationMap.put(&quot;imageUrl&quot;, notification.getImageUrl().toString());\n        }\n\n        if (notification.getLink() != null) {\n            androidNotificationMap.put(&quot;link&quot;, notification.getLink().toString());\n        }\n\n        if (notification.getNotificationCount() != null) {\n            androidNotificationMap.put(&quot;count&quot;, notification.getNotificationCount());\n        }\n\n        if (notification.getNotificationPriority() != null) {\n            androidNotificationMap.put(&quot;priority&quot;, notification.getNotificationPriority());\n        }\n\n        if (notification.getSound() != null) {\n            androidNotificationMap.put(&quot;sound&quot;, notification.getSound());\n        }\n\n        if (notification.getTicker() != null) {\n            androidNotificationMap.put(&quot;ticker&quot;, notification.getTicker());\n        }\n\n        if (notification.getVisibility() != null) {\n            androidNotificationMap.put(&quot;visibility&quot;, notification.getVisibility());\n        }\n\n        if (notification.getTag() != null) {\n            androidNotificationMap.put(&quot;tag&quot;, notification.getTag());\n        }\n\n        notificationMap.put(&quot;android&quot;, androidNotificationMap);\n        return notificationMap;\n    }\n\n    /**\n     * Identify if the application is currently in a state where user interaction is possible. This\n     * method is called when a remote message is received to determine how the incoming message should\n     * be handled.\n     *\n     * @param context context.\n     * @return True if the application is currently in a state where user interaction is possible,\n     *     false otherwise.\n     */\n    static boolean isApplicationForeground(Context context) {\n        KeyguardManager keyguardManager =\n                (KeyguardManager) context.getSystemService(Context.KEYGUARD_SERVICE);\n\n        if (keyguardManager != null &amp;&amp; keyguardManager.isKeyguardLocked()) {\n            return false;\n        }\n\n        ActivityManager activityManager =\n                (ActivityManager) context.getSystemService(Context.ACTIVITY_SERVICE);\n        if (activityManager == null) return false;\n\n        List&lt;ActivityManager.RunningAppProcessInfo&gt; appProcesses =\n                activityManager.getRunningAppProcesses();\n        if (appProcesses == null) return false;\n\n        final String packageName = context.getPackageName();\n        for (ActivityManager.RunningAppProcessInfo appProcess : appProcesses) {\n            if (appProcess.importance == ActivityManager.RunningAppProcessInfo.IMPORTANCE_FOREGROUND\n                    &amp;&amp; appProcess.processName.equals(packageName)) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    // Extracted to handle multi-app support in the future.\n    // arguments.get(&quot;appName&quot;) - to get the Firebase app name.\n    static FirebaseMessaging getFirebaseMessagingForArguments(Map&lt;String, Object&gt; arguments) {\n        return FirebaseMessaging.getInstance();\n    }\n\n    /**\n     * Builds an instance of {@link RemoteMessage} from Flutter method channel call arguments.\n     *\n     * @param arguments Method channel call arguments.\n     * @return RemoteMessage\n     */\n    static RemoteMessage getRemoteMessageForArguments(Map&lt;String, Object&gt; arguments) {\n        @SuppressWarnings(&quot;unchecked&quot;)\n        Map&lt;String, Object&gt; messageMap =\n                (Map&lt;String, Object&gt;) Objects.requireNonNull(arguments.get(&quot;message&quot;));\n\n        String to = (String) Objects.requireNonNull(messageMap.get(&quot;to&quot;));\n        RemoteMessage.Builder builder = new RemoteMessage.Builder(to);\n\n        String collapseKey = (String) messageMap.get(&quot;collapseKey&quot;);\n        String messageId = (String) messageMap.get(&quot;messageId&quot;);\n        String messageType = (String) messageMap.get(&quot;messageType&quot;);\n        Integer ttl = (Integer) messageMap.get(&quot;ttl&quot;);\n\n        @SuppressWarnings(&quot;unchecked&quot;)\n        Map&lt;String, String&gt; data = (Map&lt;String, String&gt;) messageMap.get(&quot;data&quot;);\n\n        if (collapseKey != null) {\n            builder.setCollapseKey(collapseKey);\n        }\n\n        if (messageType != null) {\n            builder.setMessageType(messageType);\n        }\n\n        if (messageId != null) {\n            builder.setMessageId(messageId);\n        }\n\n        if (ttl != null) {\n            builder.setTtl(ttl);\n        }\n\n        if (data != null) {\n            builder.setData(data);\n        }\n\n        return builder.build();\n    }\n}\n</code></pre>\n<p>PlatformIntermediate.java:</p>\n<pre><code>package org.kivy.plugins.messaging;\n\nimport android.content.Context;\nimport android.util.Log;\n\nimport com.google.gson.Gson;\n\nimport java.io.BufferedReader;\nimport java.io.BufferedWriter;\nimport java.io.FileNotFoundException;\nimport java.io.FileOutputStream;\nimport java.io.FileReader;\nimport java.io.IOException;\nimport java.io.OutputStreamWriter;\nimport java.io.UnsupportedEncodingException;\nimport java.io.Writer;\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class PlatformIntermediate {\n    private static HashMap&lt;String, Object&gt; _foregroundMessage = new HashMap&lt;String, Object&gt;();\n    final public static HashMap&lt;String, Object&gt; backgroundMessages = new HashMap&lt;String, Object&gt;();\n    public static String token = &quot;&quot;;\n    private static final String BACKGROUND_MSG_FILE_NAME = &quot;/background_messages.json&quot;;\n\n    public static String getForegroundMessage() {\n        return new Gson().toJson(_foregroundMessage);\n    }\n\n    public static void setForegroundMessage(Map&lt;String, Object&gt; msg) {\n        HashMap&lt;String, Object&gt; copy = new HashMap&lt;String, Object&gt;(msg);\n        _foregroundMessage = copy;\n\n        _foregroundMessage.put(&quot;unique_key&quot;, Math.random());\n        Log.d(&quot;PlatformIntermediate&quot;, &quot;setForegroundMessage worked &quot; + _foregroundMessage.toString());\n    }\n\n    public static void addbackroundMessage(Map&lt;String, Object&gt; remoteMessageMap, Context context) {\n        try {\n            ru.asoms.myapp.ServicePythonnotificationhandler.start(org.kivy.android.PythonActivity.mActivity, &quot;&quot;);\n        } catch (Exception e) {\n            Log.d(&quot;PlatformIntermediate&quot;, &quot;Exception occurred while trying to start service: &quot; + e.getMessage());\n        }\n        backgroundMessages.put(remoteMessageMap.get(&quot;unique_key&quot;).toString(), remoteMessageMap);\n\n        // Read stored json\n        String jsonText = readBackgroundFile(context);\n\n        Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();\n        if (jsonText.length() &gt; 0) {\n            map = (Map&lt;String, Object&gt;) new Gson().fromJson(jsonText, map.getClass());\n        }\n        boolean shouldRecreateFile = false;\n        // Merge with map where key does not exist or create file if map size is 0\n        if (map.size() == 0) {\n            shouldRecreateFile = true;\n        } else {\n            for (String key : map.keySet()) {\n                if (backgroundMessages.get(key) == null) {\n                    backgroundMessages.put(key, map.get(key));\n                    shouldRecreateFile = true;\n                }\n            }\n        }\n        // Write to file\n        if (shouldRecreateFile) {\n//            deleteBackgroundFile(context);\n            writeBackgroundFile(new Gson().toJson(backgroundMessages), context);\n\n        }\n        Log.d(&quot;PlatformIntermediate&quot;, &quot;New message added, recreated: &quot;+shouldRecreateFile +&quot; &quot;+context.getFilesDir().getPath());\n        if(shouldRecreateFile == false){\n            Log.d(&quot;PlatformIntermediate&quot;, map.toString());\n\n        }\n    }\n\n    public static void writeBackgroundFile(String data, Context context) {\n        try (Writer writer = new BufferedWriter(new OutputStreamWriter(\n                new FileOutputStream(context.getFilesDir().getPath()+BACKGROUND_MSG_FILE_NAME), &quot;utf-8&quot;))) {\n            writer.write(data);\n        } catch (UnsupportedEncodingException e) {\n            e.printStackTrace();\n        } catch (FileNotFoundException e) {\n            e.printStackTrace();\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n\n    public static String readBackgroundFile(Context context) {\n        String ret = &quot;&quot;;\n        try (BufferedReader br = new BufferedReader(new FileReader(context.getFilesDir().getPath()+BACKGROUND_MSG_FILE_NAME))) {\n            StringBuilder sb = new StringBuilder();\n            String line = br.readLine();\n            while (line != null) {\n                sb.append(line);\n                sb.append(&quot;\\n&quot;);\n                line = br.readLine();\n            }\n            ret = sb.toString();\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        return ret;\n    }\n}\n</code></pre>\n<p>I am new to java so i google about firebase notifications in foreground but they all doing it in main class of the app so i clearly dont understand it</p>\n"},{"tags":["java","json","spring","jackson"],"answers":[{"comments":[{"owner":{"account_id":1428986,"reputation":584,"user_id":1351827,"accept_rate":45,"display_name":"Patrick Aquilone"},"score":0,"creation_date":1681137527,"post_id":75970563,"comment_id":134004282,"body_markdown":"It is technically the write to string that fails.  Using the methods above.  I am wondering if my setup for ObjectMapper is messing it up somehow.","body":"It is technically the write to string that fails.  Using the methods above.  I am wondering if my setup for ObjectMapper is messing it up somehow."},{"owner":{"account_id":24109083,"reputation":150,"user_id":18079889,"display_name":"Mohammed Fataka"},"score":0,"creation_date":1681154468,"post_id":75970563,"comment_id":134007813,"body_markdown":"I use the same method to convert the object to JSON, but I do not have the same configuration for the mapper instead I just have `findAndAddModules()`, probably one or more of your mapper configurations may be the cause","body":"I use the same method to convert the object to JSON, but I do not have the same configuration for the mapper instead I just have <code>findAndAddModules()</code>, probably one or more of your mapper configurations may be the cause"}],"tags":[],"owner":{"account_id":24109083,"reputation":150,"user_id":18079889,"display_name":"Mohammed Fataka"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681043977,"creation_date":1681043977,"answer_id":75970563,"question_id":75959984,"body_markdown":"i tested with my JsonUtils and it works just fine, try to test it with this\r\n\r\n```\r\npublic class JsonUtils {\r\n\r\n    private static final ObjectMapper mapper = JsonMapper.builder()\r\n            .findAndAddModules()\r\n            .build();\r\n    public static &lt;T&gt; T jsonToObject(String json, Class&lt;? extends T&gt; type) {\r\n\r\n        try {\r\n            return mapper.readValue(json, type);\r\n        } catch (Exception e) {\r\n            log.error(&quot;error parsing json, message[{}]&quot;, e.getMessage(), e);\r\n            throw new RuntimeException(e);\r\n        }\r\n    }\r\n```\r\n\r\n\r\nps: i needed to modify some fields for making mapper to ignore when null was passed, use ```@JsonIgnore``` for ignoring and ```@JsonProperty``` for naming fields with symbols like &#39;-&#39;","title":"Java ObjectMapper Causes StackOverflow Infinite Loop Exceptipn","body":"<p>i tested with my JsonUtils and it works just fine, try to test it with this</p>\n<pre><code>public class JsonUtils {\n\n    private static final ObjectMapper mapper = JsonMapper.builder()\n            .findAndAddModules()\n            .build();\n    public static &lt;T&gt; T jsonToObject(String json, Class&lt;? extends T&gt; type) {\n\n        try {\n            return mapper.readValue(json, type);\n        } catch (Exception e) {\n            log.error(&quot;error parsing json, message[{}]&quot;, e.getMessage(), e);\n            throw new RuntimeException(e);\n        }\n    }\n</code></pre>\n<p>ps: i needed to modify some fields for making mapper to ignore when null was passed, use <code>@JsonIgnore</code> for ignoring and <code>@JsonProperty</code> for naming fields with symbols like '-'</p>\n"}],"owner":{"account_id":1428986,"reputation":584,"user_id":1351827,"accept_rate":45,"display_name":"Patrick Aquilone"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":288,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1681043977,"creation_date":1680882519,"question_id":75959984,"body_markdown":"I am getting an infinite loop stack overflow and I am having trouble determining what the issue is that is causing it.  Here is part of the stack trace (because it just keeps repeating)\r\n\r\nNote some code and stack trace removed because it is greater than allowed characters.\r\n\r\n```\r\n2023-04-07 10:33:07.446 ERROR 53488 --- [nio-8443-exec-2] c.s.c.c.e.tools.support.ModelMapper      : Infinite recursion (StackOverflowError) (through reference chain: sun.reflect.annotation.AnnotatedTypeFactory$AnnotatedTypeBaseImpl[&quot;decl&quot;]-&gt;java.lang.reflect.Method[&quot;parameters&quot;]-&gt;java.lang.reflect.Parameter[0]-&gt;java.lang.reflect.Parameter[&quot;annotatedType&quot;]-&gt;sun.reflect.annotation.AnnotatedTypeFactory$AnnotatedTypeBaseImpl[&quot;decl&quot;]-&gt;java.lang.reflect.Method[&quot;parameters&quot;]-&gt;java.lang.reflect.Parameter[0]-&gt;java.lang.reflect.Parameter[&quot;annotatedType&quot;]-&gt;sun.reflect.annotation.AnnotatedTypeFactory$AnnotatedTypeBaseImpl[&quot;decl&quot;]-&gt;java.lang.reflect.Method[&quot;parameters&quot;]-&gt;java.lang.reflect.Parameter[0]-&gt;java.lang.reflect.Parameter[&quot;annotatedType&quot;]-\r\n...\r\n&gt;java.lang.reflect.Method[&quot;parameters&quot;]-&gt;java.lang.reflect.Parameter[0]-&gt;java.lang.reflect.Parameter[&quot;annotatedType&quot;])\r\n\tat com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:789) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serializeContents(ObjectArraySerializer.java:253) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serialize(ObjectArraySerializer.java:214) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serialize(ObjectArraySerializer.java:23) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:733) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:774) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:733) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:774) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:733) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:774) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serializeContents(ObjectArraySerializer.java:253) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serialize(ObjectArraySerializer.java:214) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serialize(ObjectArraySerializer.java:23) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:733) ~[cst-exodus-tools-1.0.0.jar:na]\r\n\tat com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:774) ~[cst-exodus-tools-1.0.0.jar:na]\r\n```\r\n\r\nHere is the object mapper wrapper class that I created that is throwing this error (officially is when the object mapper write is executed not this code but provided in case there is something broke here)\r\n\r\n```\r\n@Slf4j\r\n@NoArgsConstructor(access = AccessLevel.PRIVATE)\r\npublic class ModelMapper {\r\n\r\n\r\n    public static &lt;T&gt; T fromString(String json, Class&lt;T&gt; clazz) {\r\n        return ModelMapper.convertJsonToObjectString(json, clazz);\r\n    }\r\n\r\n    public static ObjectMapper getMapper() {\r\n        ObjectMapper mapper = new ObjectMapper();\r\n        mapper.registerModule(new Jdk8Module());\r\n        mapper.registerModule(new JavaTimeModule());\r\n        mapper.setVisibility(PropertyAccessor.FIELD, JsonAutoDetect.Visibility.ANY);\r\n        mapper.writer(new DefaultPrettyPrinter());\r\n        mapper.disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);\r\n        mapper.registerModule(new CustomSimpleModule());\r\n        mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\r\n        mapper.findAndRegisterModules();\r\n        return mapper;\r\n    }\r\n\r\n    public static String toString(Object obj) {\r\n        return ModelMapper.convertObjectToJsonString(obj);\r\n    }\r\n\r\n    private static &lt;T&gt; T convertJsonToObjectString(String json, Class&lt;T&gt; clazz) {\r\n        T returnValue = null;\r\n        if (StringUtils.isNoneBlank(json)) {\r\n            try {\r\n                returnValue = ModelMapper.getMapper().readValue(json, clazz);\r\n            } catch (Exception ignored) {\r\n                log.error(ignored.getMessage(), ignored);\r\n            }\r\n        }\r\n        return returnValue;\r\n    }\r\n\r\n    private static String convertObjectToJsonString(Object obj) {\r\n        String returnValue = null;\r\n        if (Optional.ofNullable(obj).isPresent()) {\r\n            try {\r\n                returnValue = ModelMapper.getMapper().writeValueAsString(obj);\r\n            } catch (Exception ignored) {\r\n                log.error(ignored.getMessage(), ignored);\r\n            }\r\n        }\r\n        return returnValue;\r\n    }\r\n\r\n}\r\n```\r\n\r\nAnd this is the object that when has data is throwing the exception:\r\n\r\n```\r\n@SuppressWarnings({ &quot;unused&quot;, &quot;UnusedReturnValue&quot; })\r\n@JsonInclude(JsonInclude.Include.NON_NULL)\r\n@Data\r\n@With\r\n@EqualsAndHashCode(callSuper = false)\r\n@SuperBuilder\r\n@AllArgsConstructor\r\n@NoArgsConstructor\r\npublic class ErrorDetails implements Serializable {\r\n\r\n    public static final String RESPONSE_BODY_KEY = &quot;Response_Body&quot;;\r\n    public static final String REQUEST_BODY_KEY = &quot;Request_Body&quot;;\r\n    public static final String REQUEST_HEADER_KEY = &quot;Request_Header&quot;;\r\n    public static final String RESPONSE_HEADER_KEY = &quot;Response_Header&quot;;\r\n    public static final String ADDITIONAL_FIELDS_KEY = &quot;Additional Fields&quot;;\r\n    public static final String STATUS_KEY = &quot;status&quot;;\r\n    public static final ZoneId ZONE_ID = ExodusDateAndTimePatterns.DEFAULT_TIME_ZONE;\r\n    public static final String ERROR_STATUS = &quot;ErrorStatus&quot;;\r\n    public static final String ERROR_TIMESTAMP = &quot;ErrorTimestamp&quot;;\r\n    public static final String ERROR_MESSAGE = &quot;ErrorMessage&quot;;\r\n    public static final String ERROR_DEBUG_MESSAGE = &quot;ErrorDebugMessage&quot;;\r\n    public static final String ERROR_TYPE = &quot;ErrorType&quot;;\r\n    private static final long serialVersionUID = 3135141341712621098L;\r\n    private boolean doNotLog;\r\n    private boolean secureData;\r\n    private Boolean external;\r\n    private ResultsTraceLevel traceLevel;\r\n    private HttpStatus status;\r\n    private String message;\r\n    private Class clazz;\r\n    private String correlationId;\r\n    private AdditionalProperties additionalProperties;\r\n    private ExceptionDetails exceptionDetails;\r\n    private HeaderType headerType;\r\n    @JsonFormat(shape = JsonFormat.Shape.STRING, pattern = &quot;dd-MM-yyyy hh:mm:ss&quot;)\r\n    private LocalDateTime timeStamp;\r\n\r\n    public static ErrorDetails getInstance() {\r\n        ErrorDetails details = new ErrorDetails();\r\n        details.setTimeStamp(LocalDateTime.now());\r\n        details.addStatus(HttpStatus.INTERNAL_SERVER_ERROR);\r\n        details.addTraceLevelData(ResultsTraceLevel.ERROR);\r\n        return details;\r\n    }\r\n\r\n    public AdditionalProperties getAdditionalProperties() {\r\n        additionalProperties = Optional.ofNullable(additionalProperties).orElse(AdditionalProperties.getInstance());\r\n        return additionalProperties;\r\n    }\r\n\r\n    public Object getAdditionalProperty(String key) {\r\n        additionalProperties = Optional.ofNullable(additionalProperties).orElse(AdditionalProperties.getInstance());\r\n        return additionalProperties.getAdditionalProperty(key);\r\n    }\r\n\r\n}\r\n```\r\n\r\nHere is example of the data in the object when it is throwing the exception.\r\n\r\n```\r\nErrorDetails(doNotLog=false,\r\n secureData=false,\r\n external=null,\r\n traceLevel=null,\r\n status=400 BAD_REQUEST,\r\n message=Required request header &#39;Nuance-Session-ID&#39; for method parameter type String is not present,\r\n clazz=null,\r\n correlationId=null,\r\n additionalProperties=AdditionalProperties(properties={Exception=ExceptionDetails(name=org.springframework.web.bind.MissingRequestHeaderException,\r\n message=Required request header &#39;Nuance-Session-ID&#39; for method parameter type String is not present,\r\n methodName=wrapRequestWithLogging,\r\n lineNumber=HttpInboundLoggingSpringWebFilter.java:155,\r\n rootCause=null),\r\n Headers={Content-Type=application/json,\r\n accept-encoding=gzip,\r\n deflate,\r\n br,\r\n connection=keep-alive,\r\n host=localhost:8443,\r\n postman-token=beccc42e-9c48-4573-840b-20dd65a70913,\r\n user-agent=PostmanRuntime/7.31.3},\r\n MissingParameter=method &#39;getProfiles&#39; parameter 2,\r\n Request=ServletWebRequest: uri=/MoneyLink/MLGetRequestList;client=0:0:0:0:0:0:0:1,\r\n Request Parameters=org.apache.catalina.util.ParameterMap@50d193b7}),\r\n exceptionDetails=ExceptionDetails(name=org.springframework.web.bind.MissingRequestHeaderException,\r\n message=Required request header &#39;Nuance-Session-ID&#39; for method parameter type String is not present,\r\n methodName=wrapRequestWithLogging,\r\n lineNumber=HttpInboundLoggingSpringWebFilter.java:155,\r\n rootCause=null),\r\n header=Header(accept=null,\r\n authorization=null,\r\n contentType=application/json,\r\n nvpSessionId=null,\r\n nuanceSessionId=null,\r\n sessionId=null,\r\n headerType=null,\r\n additionalProperties=AdditionalProperties(properties={accept-encoding=gzip,\r\n deflate,\r\n br,\r\n connection=keep-alive,\r\n host=localhost:8443,\r\n postman-token=beccc42e-9c48-4573-840b-20dd65a70913,\r\n user-agent=PostmanRuntime/7.31.3})),\r\n headerType=null,\r\n timeStamp=null)\r\n```\r\n\r\nNote that if the object is empty (I just create an instance and try to convert) it works fine.  ","title":"Java ObjectMapper Causes StackOverflow Infinite Loop Exceptipn","body":"<p>I am getting an infinite loop stack overflow and I am having trouble determining what the issue is that is causing it.  Here is part of the stack trace (because it just keeps repeating)</p>\n<p>Note some code and stack trace removed because it is greater than allowed characters.</p>\n<pre><code>2023-04-07 10:33:07.446 ERROR 53488 --- [nio-8443-exec-2] c.s.c.c.e.tools.support.ModelMapper      : Infinite recursion (StackOverflowError) (through reference chain: sun.reflect.annotation.AnnotatedTypeFactory$AnnotatedTypeBaseImpl[&quot;decl&quot;]-&gt;java.lang.reflect.Method[&quot;parameters&quot;]-&gt;java.lang.reflect.Parameter[0]-&gt;java.lang.reflect.Parameter[&quot;annotatedType&quot;]-&gt;sun.reflect.annotation.AnnotatedTypeFactory$AnnotatedTypeBaseImpl[&quot;decl&quot;]-&gt;java.lang.reflect.Method[&quot;parameters&quot;]-&gt;java.lang.reflect.Parameter[0]-&gt;java.lang.reflect.Parameter[&quot;annotatedType&quot;]-&gt;sun.reflect.annotation.AnnotatedTypeFactory$AnnotatedTypeBaseImpl[&quot;decl&quot;]-&gt;java.lang.reflect.Method[&quot;parameters&quot;]-&gt;java.lang.reflect.Parameter[0]-&gt;java.lang.reflect.Parameter[&quot;annotatedType&quot;]-\n...\n&gt;java.lang.reflect.Method[&quot;parameters&quot;]-&gt;java.lang.reflect.Parameter[0]-&gt;java.lang.reflect.Parameter[&quot;annotatedType&quot;])\n    at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:789) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serializeContents(ObjectArraySerializer.java:253) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serialize(ObjectArraySerializer.java:214) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serialize(ObjectArraySerializer.java:23) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:733) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:774) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:733) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:774) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:733) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:774) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:178) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serializeContents(ObjectArraySerializer.java:253) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serialize(ObjectArraySerializer.java:214) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.std.ObjectArraySerializer.serialize(ObjectArraySerializer.java:23) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:733) ~[cst-exodus-tools-1.0.0.jar:na]\n    at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:774) ~[cst-exodus-tools-1.0.0.jar:na]\n</code></pre>\n<p>Here is the object mapper wrapper class that I created that is throwing this error (officially is when the object mapper write is executed not this code but provided in case there is something broke here)</p>\n<pre><code>@Slf4j\n@NoArgsConstructor(access = AccessLevel.PRIVATE)\npublic class ModelMapper {\n\n\n    public static &lt;T&gt; T fromString(String json, Class&lt;T&gt; clazz) {\n        return ModelMapper.convertJsonToObjectString(json, clazz);\n    }\n\n    public static ObjectMapper getMapper() {\n        ObjectMapper mapper = new ObjectMapper();\n        mapper.registerModule(new Jdk8Module());\n        mapper.registerModule(new JavaTimeModule());\n        mapper.setVisibility(PropertyAccessor.FIELD, JsonAutoDetect.Visibility.ANY);\n        mapper.writer(new DefaultPrettyPrinter());\n        mapper.disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);\n        mapper.registerModule(new CustomSimpleModule());\n        mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n        mapper.findAndRegisterModules();\n        return mapper;\n    }\n\n    public static String toString(Object obj) {\n        return ModelMapper.convertObjectToJsonString(obj);\n    }\n\n    private static &lt;T&gt; T convertJsonToObjectString(String json, Class&lt;T&gt; clazz) {\n        T returnValue = null;\n        if (StringUtils.isNoneBlank(json)) {\n            try {\n                returnValue = ModelMapper.getMapper().readValue(json, clazz);\n            } catch (Exception ignored) {\n                log.error(ignored.getMessage(), ignored);\n            }\n        }\n        return returnValue;\n    }\n\n    private static String convertObjectToJsonString(Object obj) {\n        String returnValue = null;\n        if (Optional.ofNullable(obj).isPresent()) {\n            try {\n                returnValue = ModelMapper.getMapper().writeValueAsString(obj);\n            } catch (Exception ignored) {\n                log.error(ignored.getMessage(), ignored);\n            }\n        }\n        return returnValue;\n    }\n\n}\n</code></pre>\n<p>And this is the object that when has data is throwing the exception:</p>\n<pre><code>@SuppressWarnings({ &quot;unused&quot;, &quot;UnusedReturnValue&quot; })\n@JsonInclude(JsonInclude.Include.NON_NULL)\n@Data\n@With\n@EqualsAndHashCode(callSuper = false)\n@SuperBuilder\n@AllArgsConstructor\n@NoArgsConstructor\npublic class ErrorDetails implements Serializable {\n\n    public static final String RESPONSE_BODY_KEY = &quot;Response_Body&quot;;\n    public static final String REQUEST_BODY_KEY = &quot;Request_Body&quot;;\n    public static final String REQUEST_HEADER_KEY = &quot;Request_Header&quot;;\n    public static final String RESPONSE_HEADER_KEY = &quot;Response_Header&quot;;\n    public static final String ADDITIONAL_FIELDS_KEY = &quot;Additional Fields&quot;;\n    public static final String STATUS_KEY = &quot;status&quot;;\n    public static final ZoneId ZONE_ID = ExodusDateAndTimePatterns.DEFAULT_TIME_ZONE;\n    public static final String ERROR_STATUS = &quot;ErrorStatus&quot;;\n    public static final String ERROR_TIMESTAMP = &quot;ErrorTimestamp&quot;;\n    public static final String ERROR_MESSAGE = &quot;ErrorMessage&quot;;\n    public static final String ERROR_DEBUG_MESSAGE = &quot;ErrorDebugMessage&quot;;\n    public static final String ERROR_TYPE = &quot;ErrorType&quot;;\n    private static final long serialVersionUID = 3135141341712621098L;\n    private boolean doNotLog;\n    private boolean secureData;\n    private Boolean external;\n    private ResultsTraceLevel traceLevel;\n    private HttpStatus status;\n    private String message;\n    private Class clazz;\n    private String correlationId;\n    private AdditionalProperties additionalProperties;\n    private ExceptionDetails exceptionDetails;\n    private HeaderType headerType;\n    @JsonFormat(shape = JsonFormat.Shape.STRING, pattern = &quot;dd-MM-yyyy hh:mm:ss&quot;)\n    private LocalDateTime timeStamp;\n\n    public static ErrorDetails getInstance() {\n        ErrorDetails details = new ErrorDetails();\n        details.setTimeStamp(LocalDateTime.now());\n        details.addStatus(HttpStatus.INTERNAL_SERVER_ERROR);\n        details.addTraceLevelData(ResultsTraceLevel.ERROR);\n        return details;\n    }\n\n    public AdditionalProperties getAdditionalProperties() {\n        additionalProperties = Optional.ofNullable(additionalProperties).orElse(AdditionalProperties.getInstance());\n        return additionalProperties;\n    }\n\n    public Object getAdditionalProperty(String key) {\n        additionalProperties = Optional.ofNullable(additionalProperties).orElse(AdditionalProperties.getInstance());\n        return additionalProperties.getAdditionalProperty(key);\n    }\n\n}\n</code></pre>\n<p>Here is example of the data in the object when it is throwing the exception.</p>\n<pre><code>ErrorDetails(doNotLog=false,\n secureData=false,\n external=null,\n traceLevel=null,\n status=400 BAD_REQUEST,\n message=Required request header 'Nuance-Session-ID' for method parameter type String is not present,\n clazz=null,\n correlationId=null,\n additionalProperties=AdditionalProperties(properties={Exception=ExceptionDetails(name=org.springframework.web.bind.MissingRequestHeaderException,\n message=Required request header 'Nuance-Session-ID' for method parameter type String is not present,\n methodName=wrapRequestWithLogging,\n lineNumber=HttpInboundLoggingSpringWebFilter.java:155,\n rootCause=null),\n Headers={Content-Type=application/json,\n accept-encoding=gzip,\n deflate,\n br,\n connection=keep-alive,\n host=localhost:8443,\n postman-token=beccc42e-9c48-4573-840b-20dd65a70913,\n user-agent=PostmanRuntime/7.31.3},\n MissingParameter=method 'getProfiles' parameter 2,\n Request=ServletWebRequest: uri=/MoneyLink/MLGetRequestList;client=0:0:0:0:0:0:0:1,\n Request Parameters=org.apache.catalina.util.ParameterMap@50d193b7}),\n exceptionDetails=ExceptionDetails(name=org.springframework.web.bind.MissingRequestHeaderException,\n message=Required request header 'Nuance-Session-ID' for method parameter type String is not present,\n methodName=wrapRequestWithLogging,\n lineNumber=HttpInboundLoggingSpringWebFilter.java:155,\n rootCause=null),\n header=Header(accept=null,\n authorization=null,\n contentType=application/json,\n nvpSessionId=null,\n nuanceSessionId=null,\n sessionId=null,\n headerType=null,\n additionalProperties=AdditionalProperties(properties={accept-encoding=gzip,\n deflate,\n br,\n connection=keep-alive,\n host=localhost:8443,\n postman-token=beccc42e-9c48-4573-840b-20dd65a70913,\n user-agent=PostmanRuntime/7.31.3})),\n headerType=null,\n timeStamp=null)\n</code></pre>\n<p>Note that if the object is empty (I just create an instance and try to convert) it works fine.</p>\n"},{"tags":["java","android","android-custom-view","android-progressbar","android-seekbar"],"owner":{"account_id":26231890,"reputation":1,"user_id":19907667,"display_name":"Ahmed Masoud"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":37,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681043665,"creation_date":1681043665,"question_id":75970537,"body_markdown":"I am currently working on a custom Seekbar class called &quot;ArcSlider&quot; and I&#39;m facing an issue with the arc direction. I want to draw an arc that opens upward, but I&#39;m not very good at math, and I can only get it to open downward.\r\n\r\nI have tried to adjust the sweepAngle and startAngle parameters, but when I do that, the view doesn&#39;t display the Seekbar anymore. I&#39;m not interested in customizing the Seekbar shape from XML, I want to build this class programmatically.\r\n\r\nCan anyone help me with the math required to draw an upward arc? Any tips or guidance would be greatly appreciated. Here is my code so far:\r\n\r\n\r\n```\r\n\r\n\r\npackage com.am.app.amplayer.archslider;\r\n\r\nimport android.content.res.TypedArray;\r\n\r\nimport android.graphics.Color;\r\n\r\nimport android.graphics.Paint;\r\n\r\nimport android.graphics.RectF;\r\n\r\nimport android.graphics.Canvas;\r\n\r\nimport android.graphics.drawable.Drawable;\r\n\r\nimport android.util.AttributeSet;\r\n\r\nimport android.util.DisplayMetrics;\r\n\r\nimport android.view.View;\r\n\r\nimport androidx.core.content.ContextCompat;\r\n\r\nimport com.am.app.amplayer.R;\r\n\r\nimport android.content.Context;\r\n\r\nimport android.widget.SeekBar;\r\n\r\nimport com.am.app.amplayer.helper.AppHelper;\r\n\r\nimport static java.lang.Math.*;\r\n\r\npublic class ArchSlider extends View {\r\n\r\n\t/**\r\n\r\n\t * value : progress of slider\r\n\r\n\t * max : max value of slider\r\n\r\n\t */\r\n\r\n\tprivate int value;\r\n\r\n\tprivate int max;\r\n\r\n\t// thumb\r\n\r\n\tprivate final Drawable thumb;\r\n\r\n\t// slider thikness\r\n\r\n\tprivate float thikness;\r\n\r\n\t/**\r\n\r\n\t * track &amp; progress properties\r\n\r\n\t */\r\n\r\n\tprivate Paint track;\r\n\r\n\tprivate Paint progress;\r\n\r\n\tprivate int color;\r\n\r\n\tprivate int trackColor;\r\n\r\n\t// slider rect\r\n\r\n\tprivate RectF rect;\r\n\r\n\t// slider properties\r\n\r\n\tprivate float radius;\r\n\r\n\tprivate float centerX, centerY;\r\n\r\n\tprivate float alphaRad;\r\n\r\n\tpublic ArchSlider(Context context) {\r\n\r\n\t\tthis(context, null);\r\n\r\n\t}\r\n\r\n\tpublic ArchSlider(Context context, AttributeSet attrs) {\r\n\r\n\t\tthis(context, attrs, 0);\r\n\r\n\t}\r\n\r\n\tpublic ArchSlider(Context context, AttributeSet attrs, int defStyle) {\r\n\r\n\t\tsuper(context, attrs, defStyle, R.style.archSliderStyle);\r\n\r\n\t\tTypedArray array = context.getTheme().obtainStyledAttributes(attrs, R.styleable.ArchSlider, defStyle,\r\n\r\n\t\t\t\tR.style.archSliderStyle);\r\n\r\n\t\tvalue = array.getInt(R.styleable.ArchSlider_value, 14);\r\n\r\n\t\tmax = array.getInt(R.styleable.ArchSlider_max, 100);\r\n\r\n\t\tcolor = array.getColor(R.styleable.ArchSlider_color, AppHelper.getColor(R.attr.colorPrimary));\r\n\r\n\t\ttrackColor = array.getColor(R.styleable.ArchSlider_trackColor, AppHelper.getColor(R.attr.colorSurfaceVariant));\r\n\r\n\t\tthikness = array.getDimension(R.styleable.ArchSlider_thikness, getDisplayMetrics().density * 6);\r\n\r\n\t\tarray.recycle();\r\n\r\n\t\tthumb = ContextCompat.getDrawable(context, R.drawable.arch_slider_thumb);\r\n\r\n\t\ttrack = getPaint(trackColor);\r\n\r\n\t\tprogress = getPaint(color);\r\n\r\n\t}\r\n\r\n\t@Override\r\n\r\n\tprotected void onMeasure(int w, int h) {\r\n\r\n\t\tfloat padding = max(thumb.getIntrinsicHeight() / 2.0f, thikness) + 2;\r\n\r\n\t\tfloat width = View.getDefaultSize(getSuggestedMinimumWidth(), w) - 2 * padding - getPaddingStart()\r\n\r\n\t\t\t\t- getPaddingEnd();\r\n\r\n\t\tfloat height = min(View.getDefaultSize(getSuggestedMinimumHeight(), h) - 2 * padding - getPaddingTop()\r\n\r\n\t\t\t\t- getPaddingBottom(), width / 2);\r\n\r\n\t\tfloat maxPaddingX = max(getPaddingStart(), getPaddingEnd());\r\n\r\n\t\tfloat maxPaddingY = max(getPaddingTop(), getPaddingBottom());\r\n\r\n\t\tthis.radius = (height / 2) + ((float) pow(width, 2.0) / (8 * height));\r\n\r\n\t\tthis.centerX = width / 2 + (padding + maxPaddingY);\r\n\r\n\t\tthis.centerY = radius + (padding + maxPaddingX);\r\n\r\n\t\tthis.rect = new RectF(centerX - radius, centerY - radius, radius + centerX, centerY + radius);\r\n\r\n\t\tthis.alphaRad = bound(0, (float) (acos((radius - height) / radius)), (float) (2 * PI));\r\n\r\n\t\tsuper.onMeasure(w, h);\r\n\r\n\t}\r\n\r\n\t@Override\r\n\r\n\tprotected void onDraw(Canvas canvas) {\r\n\r\n\t\tfloat startAngle = bound(180f, (float)(270-alphaRad/2/PI*360), 360f);\r\n\r\n\t\tfloat sweepAngle = bound(0, (float)((2*alphaRad)/2/PI*360), 180f);\r\n\r\n\t\tfloat progressSweepRad = max == 0 ? 0.0f : bound(0.0f,((float)value / (float)max * 2 * alphaRad), (float)(2f * PI)); \r\n\r\n\t\tfloat progressSweepAngle = progressSweepRad / 2.0f / (float)PI * 360.0f;\r\n\r\n\t\tcanvas.drawArc(rect, startAngle, sweepAngle, false, track);\r\n\r\n\t\tcanvas.drawArc(rect, startAngle, progressSweepAngle, false, progress);\r\n\r\n\t\tAppHelper.toast(&quot;max:\\t&quot; + max + &quot;,\\tvalue:\\t&quot; + value, 1);\r\n\r\n\t}\r\n\r\n\tprivate DisplayMetrics getDisplayMetrics() {\r\n\r\n\t\treturn getResources().getDisplayMetrics();\r\n\r\n\t}\r\n\r\n\tprivate Paint getPaint(int color) {\r\n\r\n\t\tPaint paint = new Paint();\r\n\r\n\t\tpaint.setColor(color);\r\n\r\n\t\tpaint.setStrokeWidth(thikness);\r\n\r\n\t\tpaint.setStyle(Paint.Style.STROKE);\r\n\r\n\t\tpaint.setStrokeCap(Paint.Cap.ROUND);\r\n\r\n\t\tpaint.setAntiAlias(true);\r\n\r\n\t\treturn paint;\r\n\r\n\t}\r\n\r\n\tprivate final Float bound(float min, float value, float max) {\r\n\r\n\t\treturn max(min, min(value, max));\r\n\r\n\t}\r\n\r\n}\r\n```\r\n\r\n\r\n\r\nThank you in advance for your help!\r\n\r\nI have tried to adjust the `sweepAngle` and `startAngle` parameters,\r\n\r\n```\r\n\r\n\r\nfloat startAngle = bound(0f, (float) (90 - alphaRad / 2 / PI * 360), 180f);\r\n\r\n        float sweepAngle = bound(0, (float) ((2 * alphaRad) / 2 / PI * 360), 180f);\r\n\r\n        float progressSweepRad = max == 0 ? 0.0f : bound(0.0f, ((float) value / (float) max * 2 * alphaRad), (float) (2f * PI));\r\n\r\n        float progressSweepAngle = progressSweepRad / 2.0f / (float) PI * 360.0f;\r\n\r\n        canvas.drawArc(rect, startAngle, sweepAngle, false, track);\r\n\r\n        canvas.drawArc(rect, startAngle, progressSweepAngle, false, progress);\r\n```\r\n\r\nbut i get empty view\r\n","title":"How to draw an upward arc Seekbar in a custom Seekbar class (ArcSlider)","body":"<p>I am currently working on a custom Seekbar class called &quot;ArcSlider&quot; and I'm facing an issue with the arc direction. I want to draw an arc that opens upward, but I'm not very good at math, and I can only get it to open downward.</p>\n<p>I have tried to adjust the sweepAngle and startAngle parameters, but when I do that, the view doesn't display the Seekbar anymore. I'm not interested in customizing the Seekbar shape from XML, I want to build this class programmatically.</p>\n<p>Can anyone help me with the math required to draw an upward arc? Any tips or guidance would be greatly appreciated. Here is my code so far:</p>\n<pre><code>\n\npackage com.am.app.amplayer.archslider;\n\nimport android.content.res.TypedArray;\n\nimport android.graphics.Color;\n\nimport android.graphics.Paint;\n\nimport android.graphics.RectF;\n\nimport android.graphics.Canvas;\n\nimport android.graphics.drawable.Drawable;\n\nimport android.util.AttributeSet;\n\nimport android.util.DisplayMetrics;\n\nimport android.view.View;\n\nimport androidx.core.content.ContextCompat;\n\nimport com.am.app.amplayer.R;\n\nimport android.content.Context;\n\nimport android.widget.SeekBar;\n\nimport com.am.app.amplayer.helper.AppHelper;\n\nimport static java.lang.Math.*;\n\npublic class ArchSlider extends View {\n\n    /**\n\n     * value : progress of slider\n\n     * max : max value of slider\n\n     */\n\n    private int value;\n\n    private int max;\n\n    // thumb\n\n    private final Drawable thumb;\n\n    // slider thikness\n\n    private float thikness;\n\n    /**\n\n     * track &amp; progress properties\n\n     */\n\n    private Paint track;\n\n    private Paint progress;\n\n    private int color;\n\n    private int trackColor;\n\n    // slider rect\n\n    private RectF rect;\n\n    // slider properties\n\n    private float radius;\n\n    private float centerX, centerY;\n\n    private float alphaRad;\n\n    public ArchSlider(Context context) {\n\n        this(context, null);\n\n    }\n\n    public ArchSlider(Context context, AttributeSet attrs) {\n\n        this(context, attrs, 0);\n\n    }\n\n    public ArchSlider(Context context, AttributeSet attrs, int defStyle) {\n\n        super(context, attrs, defStyle, R.style.archSliderStyle);\n\n        TypedArray array = context.getTheme().obtainStyledAttributes(attrs, R.styleable.ArchSlider, defStyle,\n\n                R.style.archSliderStyle);\n\n        value = array.getInt(R.styleable.ArchSlider_value, 14);\n\n        max = array.getInt(R.styleable.ArchSlider_max, 100);\n\n        color = array.getColor(R.styleable.ArchSlider_color, AppHelper.getColor(R.attr.colorPrimary));\n\n        trackColor = array.getColor(R.styleable.ArchSlider_trackColor, AppHelper.getColor(R.attr.colorSurfaceVariant));\n\n        thikness = array.getDimension(R.styleable.ArchSlider_thikness, getDisplayMetrics().density * 6);\n\n        array.recycle();\n\n        thumb = ContextCompat.getDrawable(context, R.drawable.arch_slider_thumb);\n\n        track = getPaint(trackColor);\n\n        progress = getPaint(color);\n\n    }\n\n    @Override\n\n    protected void onMeasure(int w, int h) {\n\n        float padding = max(thumb.getIntrinsicHeight() / 2.0f, thikness) + 2;\n\n        float width = View.getDefaultSize(getSuggestedMinimumWidth(), w) - 2 * padding - getPaddingStart()\n\n                - getPaddingEnd();\n\n        float height = min(View.getDefaultSize(getSuggestedMinimumHeight(), h) - 2 * padding - getPaddingTop()\n\n                - getPaddingBottom(), width / 2);\n\n        float maxPaddingX = max(getPaddingStart(), getPaddingEnd());\n\n        float maxPaddingY = max(getPaddingTop(), getPaddingBottom());\n\n        this.radius = (height / 2) + ((float) pow(width, 2.0) / (8 * height));\n\n        this.centerX = width / 2 + (padding + maxPaddingY);\n\n        this.centerY = radius + (padding + maxPaddingX);\n\n        this.rect = new RectF(centerX - radius, centerY - radius, radius + centerX, centerY + radius);\n\n        this.alphaRad = bound(0, (float) (acos((radius - height) / radius)), (float) (2 * PI));\n\n        super.onMeasure(w, h);\n\n    }\n\n    @Override\n\n    protected void onDraw(Canvas canvas) {\n\n        float startAngle = bound(180f, (float)(270-alphaRad/2/PI*360), 360f);\n\n        float sweepAngle = bound(0, (float)((2*alphaRad)/2/PI*360), 180f);\n\n        float progressSweepRad = max == 0 ? 0.0f : bound(0.0f,((float)value / (float)max * 2 * alphaRad), (float)(2f * PI)); \n\n        float progressSweepAngle = progressSweepRad / 2.0f / (float)PI * 360.0f;\n\n        canvas.drawArc(rect, startAngle, sweepAngle, false, track);\n\n        canvas.drawArc(rect, startAngle, progressSweepAngle, false, progress);\n\n        AppHelper.toast(&quot;max:\\t&quot; + max + &quot;,\\tvalue:\\t&quot; + value, 1);\n\n    }\n\n    private DisplayMetrics getDisplayMetrics() {\n\n        return getResources().getDisplayMetrics();\n\n    }\n\n    private Paint getPaint(int color) {\n\n        Paint paint = new Paint();\n\n        paint.setColor(color);\n\n        paint.setStrokeWidth(thikness);\n\n        paint.setStyle(Paint.Style.STROKE);\n\n        paint.setStrokeCap(Paint.Cap.ROUND);\n\n        paint.setAntiAlias(true);\n\n        return paint;\n\n    }\n\n    private final Float bound(float min, float value, float max) {\n\n        return max(min, min(value, max));\n\n    }\n\n}\n</code></pre>\n<p>Thank you in advance for your help!</p>\n<p>I have tried to adjust the <code>sweepAngle</code> and <code>startAngle</code> parameters,</p>\n<pre><code>\n\nfloat startAngle = bound(0f, (float) (90 - alphaRad / 2 / PI * 360), 180f);\n\n        float sweepAngle = bound(0, (float) ((2 * alphaRad) / 2 / PI * 360), 180f);\n\n        float progressSweepRad = max == 0 ? 0.0f : bound(0.0f, ((float) value / (float) max * 2 * alphaRad), (float) (2f * PI));\n\n        float progressSweepAngle = progressSweepRad / 2.0f / (float) PI * 360.0f;\n\n        canvas.drawArc(rect, startAngle, sweepAngle, false, track);\n\n        canvas.drawArc(rect, startAngle, progressSweepAngle, false, progress);\n</code></pre>\n<p>but i get empty view</p>\n"},{"tags":["java","spring","spring-batch"],"comments":[{"owner":{"account_id":3930229,"reputation":2278,"user_id":4412979,"accept_rate":50,"display_name":"Vasily Liaskovsky"},"score":0,"creation_date":1680957793,"post_id":75965259,"comment_id":133983950,"body_markdown":"Return `Map&lt;String, Object&gt;`","body":"Return <code>Map&lt;String, Object&gt;</code>"},{"owner":{"account_id":6446678,"reputation":75,"user_id":4994983,"display_name":"mdanish98"},"score":1,"creation_date":1680958067,"post_id":75965259,"comment_id":133983982,"body_markdown":"Yes that&#39;s an option, but how this Map&lt;String, Object&gt; be accessed back to the runner from where I am launching the job? so that I can serialize and return it as a response? By putting it in execution context?","body":"Yes that&#39;s an option, but how this Map&lt;String, Object&gt; be accessed back to the runner from where I am launching the job? so that I can serialize and return it as a response? By putting it in execution context?"},{"owner":{"account_id":6482932,"reputation":29552,"user_id":5019386,"display_name":"Mahmoud Ben Hassine"},"score":0,"creation_date":1681212175,"post_id":75965259,"comment_id":134016616,"body_markdown":"This means your web controller will have to wait for the job to finish to return a response to the caller. Is that really what you want? What if the job takes minutes or hours to run? This is possible from a technical point of view, but no a good choice IMO from a design perspective. If you really know what you do and you want to do it that way, then the answer by `Mohammed Fataka` is the way to go.","body":"This means your web controller will have to wait for the job to finish to return a response to the caller. Is that really what you want? What if the job takes minutes or hours to run? This is possible from a technical point of view, but no a good choice IMO from a design perspective. If you really know what you do and you want to do it that way, then the answer by <code>Mohammed Fataka</code> is the way to go."},{"owner":{"account_id":6446678,"reputation":75,"user_id":4994983,"display_name":"mdanish98"},"score":0,"creation_date":1681304877,"post_id":75965259,"comment_id":134034634,"body_markdown":"Actually, the requirement is like this only, there is a threshold set for the response. The job would be in such a way that it should not take more time than expected. What&#39;s your suggestion on this?","body":"Actually, the requirement is like this only, there is a threshold set for the response. The job would be in such a way that it should not take more time than expected. What&#39;s your suggestion on this?"}],"answers":[{"comments":[{"owner":{"account_id":6446678,"reputation":75,"user_id":4994983,"display_name":"mdanish98"},"score":0,"creation_date":1681029529,"post_id":75968136,"comment_id":133991073,"body_markdown":"Yes thanks for this, but this option I am trying to avoid as of now. Because it persists the data, may be some other better option?","body":"Yes thanks for this, but this option I am trying to avoid as of now. Because it persists the data, may be some other better option?"}],"tags":[],"owner":{"account_id":24109083,"reputation":150,"user_id":18079889,"display_name":"Mohammed Fataka"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1680996735,"creation_date":1680996735,"answer_id":75968136,"question_id":75965259,"body_markdown":"you can put an object in ExecutionContext, then retrieve it from \r\n```\r\nfinal var executionContext = jobExplorer.getJobExecution(id_of_job).getExecutionContext();\r\nfinal var object = executionContext.get(&quot;key&quot;);\r\n```\r\n\r\nor \r\n\r\nuse job launcher to lunch it and then get it from execution context again.\r\n```\r\nfinal var runJob = launcher.run(job.job(), jobParameters);\r\nfinal var object = runJob.getExecutionContext().get(&quot;key&quot;);\r\n``` \r\nalthough this is not recommended for huge response types, but in your case this might be useful ","title":"Best way to return an object as a response in Spring Batch?","body":"<p>you can put an object in ExecutionContext, then retrieve it from</p>\n<pre><code>final var executionContext = jobExplorer.getJobExecution(id_of_job).getExecutionContext();\nfinal var object = executionContext.get(&quot;key&quot;);\n</code></pre>\n<p>or</p>\n<p>use job launcher to lunch it and then get it from execution context again.</p>\n<pre><code>final var runJob = launcher.run(job.job(), jobParameters);\nfinal var object = runJob.getExecutionContext().get(&quot;key&quot;);\n</code></pre>\n<p>although this is not recommended for huge response types, but in your case this might be useful</p>\n"}],"owner":{"account_id":6446678,"reputation":75,"user_id":4994983,"display_name":"mdanish98"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":389,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1681042569,"creation_date":1680957639,"question_id":75965259,"body_markdown":"I am using `Spring batch` to run a job. I have created a `RestController` that executes this job. However I want this job to be synchronous so I didn&#39;t annotate my job execution by `@Async`. It is working fine I am getting the response after job completion only.\r\n\r\nThe scenario is when writing of this Job is finished, i.e. in the `ItemWriter` I am creating an `object` and setting its values, so when this writer is finished I want to return this `object` as a response body.\r\n\r\nI know I can do this by creating a shared structure but I don&#39;t want to do this.\r\n\r\n**What is the best and standard way to do this?**","title":"Best way to return an object as a response in Spring Batch?","body":"<p>I am using <code>Spring batch</code> to run a job. I have created a <code>RestController</code> that executes this job. However I want this job to be synchronous so I didn't annotate my job execution by <code>@Async</code>. It is working fine I am getting the response after job completion only.</p>\n<p>The scenario is when writing of this Job is finished, i.e. in the <code>ItemWriter</code> I am creating an <code>object</code> and setting its values, so when this writer is finished I want to return this <code>object</code> as a response body.</p>\n<p>I know I can do this by creating a shared structure but I don't want to do this.</p>\n<p><strong>What is the best and standard way to do this?</strong></p>\n"},{"tags":["java","android","kotlin"],"comments":[{"owner":{"account_id":39846,"reputation":991173,"user_id":115145,"accept_rate":84,"display_name":"CommonsWare"},"score":0,"creation_date":1681050853,"post_id":75970418,"comment_id":133993451,"body_markdown":"You cannot launch activities from the background, such as via `AlarmManager`, on modern versions of Android. &quot;my application is supposed to run indefinitely for long hours&quot; -- generally speaking, that is an anti-pattern on battery-powered devices. My recommendation is that you reconsider this plan.","body":"You cannot launch activities from the background, such as via <code>AlarmManager</code>, on modern versions of Android. &quot;my application is supposed to run indefinitely for long hours&quot; -- generally speaking, that is an anti-pattern on battery-powered devices. My recommendation is that you reconsider this plan."},{"owner":{"account_id":442058,"reputation":57,"user_id":832490,"accept_rate":100,"display_name":"Rodrigo"},"score":0,"creation_date":1681053899,"post_id":75970418,"comment_id":133993859,"body_markdown":"It is targeted at TV devices, not mobile","body":"It is targeted at TV devices, not mobile"},{"owner":{"account_id":39846,"reputation":991173,"user_id":115145,"accept_rate":84,"display_name":"CommonsWare"},"score":0,"creation_date":1681054696,"post_id":75970418,"comment_id":133993956,"body_markdown":"AFAIK, that does not change the nature of Android.","body":"AFAIK, that does not change the nature of Android."}],"owner":{"account_id":442058,"reputation":57,"user_id":832490,"accept_rate":100,"display_name":"Rodrigo"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":18,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681042276,"creation_date":1681042276,"question_id":75970418,"body_markdown":"I have a REST API that considers the day of the week:\r\n\r\n```\r\nCalendar calendar = Calendar.getInstance();\r\nint day = calendar.get(Calendar.DAY_OF_WEEK);\r\nObservable&lt;List&lt;String&gt;&gt; playlistObservable = playlistService.getPlaylist(id, day);\r\n```\r\n\r\nWhich works fine. However, my application is supposed to run indefinitely for long hours.\r\n\r\nSince I can not change where this code is, I was wondering if I could have an AlarmManager restart my &quot;controller&quot; after midnight.\r\n\r\nIf yes, how can I do this?\r\n\r\n","title":"Use AlarmManager to restart Activity periodically","body":"<p>I have a REST API that considers the day of the week:</p>\n<pre><code>Calendar calendar = Calendar.getInstance();\nint day = calendar.get(Calendar.DAY_OF_WEEK);\nObservable&lt;List&lt;String&gt;&gt; playlistObservable = playlistService.getPlaylist(id, day);\n</code></pre>\n<p>Which works fine. However, my application is supposed to run indefinitely for long hours.</p>\n<p>Since I can not change where this code is, I was wondering if I could have an AlarmManager restart my &quot;controller&quot; after midnight.</p>\n<p>If yes, how can I do this?</p>\n"},{"tags":["java","jsp","servlets"],"comments":[{"owner":{"account_id":14357,"reputation":9128,"user_id":29470,"display_name":"Tim Moore"},"score":1,"creation_date":1681037861,"post_id":75969926,"comment_id":133991932,"body_markdown":"There’s an extra space character in the front","body":"There’s an extra space character in the front"},{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1681037978,"post_id":75969926,"comment_id":133991941,"body_markdown":"Yup.  The error message says `For input string: &quot; 1&quot;`.  Note the space.","body":"Yup.  The error message says <code>For input string: &quot; 1&quot;</code>.  Note the space."},{"owner":{"account_id":22854500,"reputation":5,"user_id":16999552,"display_name":"Wonjun Jo"},"score":0,"creation_date":1681040749,"post_id":75969926,"comment_id":133992210,"body_markdown":"I can&#39;t really figure it out where the space from","body":"I can&#39;t really figure it out where the space from"},{"owner":{"account_id":19435569,"reputation":1567,"user_id":21105992,"display_name":"teapot418"},"score":1,"creation_date":1681040845,"post_id":75969926,"comment_id":133992222,"body_markdown":"`&lt;input type=&quot;hidden&quot; name=&quot;foo&quot; value=&quot; &lt;%= foo.getValue() %&gt;&quot;` &lt;- how about here inside `value`?","body":"<code>&lt;input type=&quot;hidden&quot; name=&quot;foo&quot; value=&quot; &lt;%= foo.getValue() %&gt;&quot;</code> &lt;- how about here inside <code>value</code>?"}],"answers":[{"comments":[{"owner":{"account_id":698222,"reputation":50202,"user_id":573032,"accept_rate":77,"display_name":"Roman C"},"score":0,"creation_date":1681056269,"post_id":75970309,"comment_id":133994173,"body_markdown":"This answer doesn&#39;t help. The changes are useless if the user submits wrong values. The problem should be resolved on the server and notify the user about error.","body":"This answer doesn&#39;t help. The changes are useless if the user submits wrong values. The problem should be resolved on the server and notify the user about error."}],"tags":[],"owner":{"account_id":8361573,"reputation":573,"user_id":6279677,"display_name":"Suchandra T"},"comment_count":1,"down_vote_count":1,"up_vote_count":1,"is_accepted":false,"score":0,"last_activity_date":1681041385,"creation_date":1681040960,"answer_id":75970309,"question_id":75969926,"body_markdown":"Little correction in your JSP code:\r\n   \r\n     &lt;input type=&quot;hidden&quot; name=&quot;minimum&quot; value=&quot; &lt;%= minimum.getValue() %&gt;&quot; /&gt;\r\n\r\nShould be (Space between value= tag):\r\n\r\n       \r\n\r\n     &lt;input type=&quot;hidden&quot; name=&quot;minimum&quot; value=&quot;&lt;%= minimum.getValue() %&gt;&quot; /&gt;\r\n\r\nLittle explanation:\r\nAssuming an Integer value- &#39; 1&#39; is not a valid Integer right? &#39;1&#39; is thus the changes.\r\n\r\nCorrect it for every Input tag.\r\n\r\nHope this helps. Thanks.\r\n\r\n\r\n","title":"why servlet shows internal errors 500","body":"<p>Little correction in your JSP code:</p>\n<pre><code> &lt;input type=&quot;hidden&quot; name=&quot;minimum&quot; value=&quot; &lt;%= minimum.getValue() %&gt;&quot; /&gt;\n</code></pre>\n<p>Should be (Space between value= tag):</p>\n<pre><code> &lt;input type=&quot;hidden&quot; name=&quot;minimum&quot; value=&quot;&lt;%= minimum.getValue() %&gt;&quot; /&gt;\n</code></pre>\n<p>Little explanation:\nAssuming an Integer value- ' 1' is not a valid Integer right? '1' is thus the changes.</p>\n<p>Correct it for every Input tag.</p>\n<p>Hope this helps. Thanks.</p>\n"}],"owner":{"account_id":22854500,"reputation":5,"user_id":16999552,"display_name":"Wonjun Jo"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":53,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1681055870,"answer_count":1,"score":0,"last_activity_date":1681041385,"creation_date":1681035439,"question_id":75969926,"body_markdown":"pass the value from jsp to servlet.while bring me internal error 500. When passing the value between jsp and servlet.\r\njava.lang.NumberFormatException: For input string: &quot; 1&quot;\r\n\tjava.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\r\n\tjava.base/java.lang.Integer.parseInt(Integer.java:638)\r\n\tjava.base/java.lang.Integer.parseInt(Integer.java:770)\r\n\tservlets.guessGame.doPost(guessGame.java:20)\r\n\tservlets.guessGame.doGet(guessGame.java:81)\r\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:502)\r\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:596)\r\n\torg.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\r\nI don&#39;t know why it happens Is there any way to fix these errors?\r\n```\r\n&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=US-ASCII&quot;\r\n    pageEncoding=&quot;US-ASCII&quot;%&gt;\r\n&lt;%@ page import=&quot;model.GuessNumber&quot; %&gt;\r\n&lt;%\r\n\tGuessNumber minimum = new GuessNumber(1);\r\n\tGuessNumber maximum = new GuessNumber(11);\r\n\r\n\tGuessNumber guessNum = new GuessNumber();\r\n\tguessNum.setRandom(minimum.getValue(), maximum.getValue());\r\n\r\n\tGuessNumber guesses = new GuessNumber(1);\r\n%&gt;\r\n\r\n&lt;html&gt;\r\n&lt;body&gt;\r\n\t&lt;h1&gt;Guessing Game&lt;/h1&gt;\r\n\t&lt;p&gt;Welcome! Lets begin the game!&lt;/p&gt;\r\n\t&lt;p&gt;Please guess a number between &lt;%= minimum.getValue() %&gt; and  &lt;%= maximum.getValue() %&gt;.&lt;/p&gt;\r\n\t\t&lt;form name=&quot;GuessNumForm&quot; action=&quot;guessGame&quot; method=&quot;get&quot;&gt;\r\n    \t\t&lt;label&gt;\r\n    \t\t\tGuess &lt;%= guesses.getValue() %&gt; :\r\n    \t\t&lt;/label&gt;\r\n    \t\t&lt;input type=&quot;text&quot; name=&quot;guess&quot; value=&quot;&quot;/&gt;\r\n    \t\t&lt;input type=&quot;submit&quot; name=&quot;guessButton&quot; value=&quot;Guess&quot;/&gt;\r\n    \t\t&lt;input type=&quot;hidden&quot; name=&quot;minimum&quot; value=&quot; &lt;%= minimum.getValue() %&gt;&quot; /&gt;\r\n            &lt;input type=&quot;hidden&quot; name=&quot;maximum&quot; value=&quot; &lt;%= maximum.getValue() %&gt;&quot; /&gt;\r\n            &lt;input type=&quot;hidden&quot; name=&quot;guessNum&quot; value=&quot; &lt;%= guessNum.getValue() %&gt;&quot; /&gt;\r\n            &lt;input type=&quot;hidden&quot; name=&quot;guesses&quot; value=&quot; &lt;%= guesses.getValue() %&gt;&quot; /&gt;\r\n    \t&lt;/form&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n\r\npackage servlets;\r\n\r\nimport java.io.IOException;\r\nimport java.io.PrintWriter;\r\nimport model.GuessNumber;\r\n\r\nimport javax.servlet.ServletException;\r\nimport javax.servlet.annotation.WebServlet;\r\nimport javax.servlet.http.HttpServlet;\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport javax.servlet.http.HttpServletResponse;\r\n\r\n@WebServlet(urlPatterns = {&quot;/guessGame&quot;})\r\npublic class guessGame extends HttpServlet {\r\n    private static final long serialVersionUID = 1L;\r\n    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\r\n        int guessInt = Integer.parseInt(request.getParameter(&quot;guess&quot;));\r\n        GuessNumber guess = new GuessNumber(guessInt);\r\n\r\n        GuessNumber minimum = new GuessNumber(Integer.parseInt(request.getParameter(&quot;minimum&quot;)));\r\n        GuessNumber maximum = new GuessNumber(Integer.parseInt(request.getParameter(&quot;maximum&quot;)));\r\n\r\n        int guessNumInt = Integer.parseInt(request.getParameter(&quot;guessNum&quot;));\r\n        GuessNumber guessNum = new GuessNumber(guessNumInt);\r\n        int guessesInt = Integer.parseInt(request.getParameter(&quot;guesses&quot;));\r\n        GuessNumber guesses = new GuessNumber(guessesInt);\r\n\r\n        int score = 100;\r\n        int decrement = 10;\r\n        //int totalScore = 0;\r\n        String msg = &quot; &quot;;\r\n\r\n        if(guess.getValue() == guessNum.getValue()) {\r\n            msg = &quot;Congratulations, you got it in&quot; + guesses.getValue() + &quot;tries. Your score is&quot; ;\r\n\r\n        } else {\r\n            guesses.increment();\r\n            //totalScore = score - decrement;\r\n            if(guesses.getValue() &lt; 10) {\r\n                if(guess.getValue()&lt; guessNum.getValue()) {\r\n                    msg =&quot;Incorrect. the number is higher than &quot; + guess.getValue();\r\n                }else {\r\n                    msg =&quot;Incorrect. the number is lower than &quot; + guess.getValue();\r\n                }\r\n            } else {\r\n                msg =&quot;You lose game.&quot; + &quot;Your score is &quot;;\r\n            }\r\n        }\r\n        response.setContentType(&quot;text/html&quot;);\r\n        PrintWriter out = response.getWriter();\r\n\r\n        out.println(&quot;&lt;!DOC-TYPE html&gt;&quot;);\r\n        out.println(&quot;&lt;html&gt;&quot;);\r\n        out.println(&quot;&lt;head&gt;&quot;);\r\n        out.println(&quot;&lt;meta charset=&#39;US-ASCII&#39;&gt;&quot;);\r\n        out.println(&quot;&lt;title&gt;Guessing number Game&lt;/title&gt;&quot;);\r\n        out.println(&quot;&lt;/head&gt;&quot;);\r\n\r\n        out.println(&quot;&lt;body&gt;&quot;);\r\n        out.println(&quot;&lt;h1&gt;Guessing Game&lt;/h1&gt;&quot;);\r\n        out.println(&quot;&lt;p&gt;&quot;+ msg +&quot;&lt;/p&gt;&quot;);\r\n\r\n        if(guess.getValue() == guessNum.getValue()) {\r\n            out.println(&quot;&lt;a href=&#39;index.jsp&#39;&gt;Play again!&lt;/a&gt;&quot;);\r\n        } else {\r\n            out.println(&quot;&lt;p&gt;Please guess a number between&quot; + minimum.getValue() + &quot;and&quot; + maximum.getValue() + &quot;&gt;.&lt;/p&gt;&quot;);\r\n            out.println(&quot;&lt;form name=&#39;GuessNumForm&#39; action=&#39;/GuessGame&#39; method=&#39;post&#39;&gt;&quot;);\r\n            out.println(&quot;&lt;label&gt;Guess&quot; + guesses.getValue() + &quot;:&lt;/label&gt;&quot;);\r\n            out.println(&quot;&lt;input type=&#39;text&#39; name=&#39;guess&#39; value=&#39;&#39;/&gt;&quot;);\r\n            out.println(&quot;&lt;input type=&#39;submit&#39; name=&#39;guessButton&#39; value=&#39;Guess&#39;/&gt;&quot;);\r\n            out.println(&quot;&lt;input type=&#39;hidden&#39; name=&#39;minimum&#39; value=&quot; + minimum.getValue() + &quot; /&gt;&quot;);\r\n            out.println(&quot;&lt;input type=&#39;hidden&#39; name=&#39;maximum&#39; value=&quot; + maximum.getValue() + &quot; /&gt;&quot;);\r\n            out.println(&quot;&lt;input type=&#39;hidden&#39; name=&#39;guessNum&#39; value=&quot; + guessNum.getValue() + &quot; /&gt;&quot;);\r\n            out.println(&quot;&lt;input type=&#39;hidden&#39; name=&#39;guesses&#39; value=&quot; + guesses.getValue() + &quot;/&gt;&quot;);\r\n            out.println(&quot;&lt;/form&gt;&quot;);\r\n        }\r\n        out.println(&quot;&lt;/body&gt;&quot;);\r\n        out.println(&quot;&lt;/html&gt;&quot;);\r\n    }\r\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\r\n        this.doPost(request, response);\r\n    }\r\n}\r\n\r\n```\r\n","title":"why servlet shows internal errors 500","body":"<p>pass the value from jsp to servlet.while bring me internal error 500. When passing the value between jsp and servlet.\njava.lang.NumberFormatException: For input string: &quot; 1&quot;\njava.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\njava.base/java.lang.Integer.parseInt(Integer.java:638)\njava.base/java.lang.Integer.parseInt(Integer.java:770)\nservlets.guessGame.doPost(guessGame.java:20)\nservlets.guessGame.doGet(guessGame.java:81)\njavax.servlet.http.HttpServlet.service(HttpServlet.java:502)\njavax.servlet.http.HttpServlet.service(HttpServlet.java:596)\norg.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\nI don't know why it happens Is there any way to fix these errors?</p>\n<pre><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=US-ASCII&quot;\n    pageEncoding=&quot;US-ASCII&quot;%&gt;\n&lt;%@ page import=&quot;model.GuessNumber&quot; %&gt;\n&lt;%\n    GuessNumber minimum = new GuessNumber(1);\n    GuessNumber maximum = new GuessNumber(11);\n\n    GuessNumber guessNum = new GuessNumber();\n    guessNum.setRandom(minimum.getValue(), maximum.getValue());\n\n    GuessNumber guesses = new GuessNumber(1);\n%&gt;\n\n&lt;html&gt;\n&lt;body&gt;\n    &lt;h1&gt;Guessing Game&lt;/h1&gt;\n    &lt;p&gt;Welcome! Lets begin the game!&lt;/p&gt;\n    &lt;p&gt;Please guess a number between &lt;%= minimum.getValue() %&gt; and  &lt;%= maximum.getValue() %&gt;.&lt;/p&gt;\n        &lt;form name=&quot;GuessNumForm&quot; action=&quot;guessGame&quot; method=&quot;get&quot;&gt;\n            &lt;label&gt;\n                Guess &lt;%= guesses.getValue() %&gt; :\n            &lt;/label&gt;\n            &lt;input type=&quot;text&quot; name=&quot;guess&quot; value=&quot;&quot;/&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;guessButton&quot; value=&quot;Guess&quot;/&gt;\n            &lt;input type=&quot;hidden&quot; name=&quot;minimum&quot; value=&quot; &lt;%= minimum.getValue() %&gt;&quot; /&gt;\n            &lt;input type=&quot;hidden&quot; name=&quot;maximum&quot; value=&quot; &lt;%= maximum.getValue() %&gt;&quot; /&gt;\n            &lt;input type=&quot;hidden&quot; name=&quot;guessNum&quot; value=&quot; &lt;%= guessNum.getValue() %&gt;&quot; /&gt;\n            &lt;input type=&quot;hidden&quot; name=&quot;guesses&quot; value=&quot; &lt;%= guesses.getValue() %&gt;&quot; /&gt;\n        &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\npackage servlets;\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport model.GuessNumber;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n@WebServlet(urlPatterns = {&quot;/guessGame&quot;})\npublic class guessGame extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        int guessInt = Integer.parseInt(request.getParameter(&quot;guess&quot;));\n        GuessNumber guess = new GuessNumber(guessInt);\n\n        GuessNumber minimum = new GuessNumber(Integer.parseInt(request.getParameter(&quot;minimum&quot;)));\n        GuessNumber maximum = new GuessNumber(Integer.parseInt(request.getParameter(&quot;maximum&quot;)));\n\n        int guessNumInt = Integer.parseInt(request.getParameter(&quot;guessNum&quot;));\n        GuessNumber guessNum = new GuessNumber(guessNumInt);\n        int guessesInt = Integer.parseInt(request.getParameter(&quot;guesses&quot;));\n        GuessNumber guesses = new GuessNumber(guessesInt);\n\n        int score = 100;\n        int decrement = 10;\n        //int totalScore = 0;\n        String msg = &quot; &quot;;\n\n        if(guess.getValue() == guessNum.getValue()) {\n            msg = &quot;Congratulations, you got it in&quot; + guesses.getValue() + &quot;tries. Your score is&quot; ;\n\n        } else {\n            guesses.increment();\n            //totalScore = score - decrement;\n            if(guesses.getValue() &lt; 10) {\n                if(guess.getValue()&lt; guessNum.getValue()) {\n                    msg =&quot;Incorrect. the number is higher than &quot; + guess.getValue();\n                }else {\n                    msg =&quot;Incorrect. the number is lower than &quot; + guess.getValue();\n                }\n            } else {\n                msg =&quot;You lose game.&quot; + &quot;Your score is &quot;;\n            }\n        }\n        response.setContentType(&quot;text/html&quot;);\n        PrintWriter out = response.getWriter();\n\n        out.println(&quot;&lt;!DOC-TYPE html&gt;&quot;);\n        out.println(&quot;&lt;html&gt;&quot;);\n        out.println(&quot;&lt;head&gt;&quot;);\n        out.println(&quot;&lt;meta charset='US-ASCII'&gt;&quot;);\n        out.println(&quot;&lt;title&gt;Guessing number Game&lt;/title&gt;&quot;);\n        out.println(&quot;&lt;/head&gt;&quot;);\n\n        out.println(&quot;&lt;body&gt;&quot;);\n        out.println(&quot;&lt;h1&gt;Guessing Game&lt;/h1&gt;&quot;);\n        out.println(&quot;&lt;p&gt;&quot;+ msg +&quot;&lt;/p&gt;&quot;);\n\n        if(guess.getValue() == guessNum.getValue()) {\n            out.println(&quot;&lt;a href='index.jsp'&gt;Play again!&lt;/a&gt;&quot;);\n        } else {\n            out.println(&quot;&lt;p&gt;Please guess a number between&quot; + minimum.getValue() + &quot;and&quot; + maximum.getValue() + &quot;&gt;.&lt;/p&gt;&quot;);\n            out.println(&quot;&lt;form name='GuessNumForm' action='/GuessGame' method='post'&gt;&quot;);\n            out.println(&quot;&lt;label&gt;Guess&quot; + guesses.getValue() + &quot;:&lt;/label&gt;&quot;);\n            out.println(&quot;&lt;input type='text' name='guess' value=''/&gt;&quot;);\n            out.println(&quot;&lt;input type='submit' name='guessButton' value='Guess'/&gt;&quot;);\n            out.println(&quot;&lt;input type='hidden' name='minimum' value=&quot; + minimum.getValue() + &quot; /&gt;&quot;);\n            out.println(&quot;&lt;input type='hidden' name='maximum' value=&quot; + maximum.getValue() + &quot; /&gt;&quot;);\n            out.println(&quot;&lt;input type='hidden' name='guessNum' value=&quot; + guessNum.getValue() + &quot; /&gt;&quot;);\n            out.println(&quot;&lt;input type='hidden' name='guesses' value=&quot; + guesses.getValue() + &quot;/&gt;&quot;);\n            out.println(&quot;&lt;/form&gt;&quot;);\n        }\n        out.println(&quot;&lt;/body&gt;&quot;);\n        out.println(&quot;&lt;/html&gt;&quot;);\n    }\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        this.doPost(request, response);\n    }\n}\n\n</code></pre>\n"},{"tags":["java","java-8","stream","hashmap"],"owner":{"account_id":28221592,"reputation":11,"user_id":21572230,"display_name":"Gowraw"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":71,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681040529,"creation_date":1681040529,"question_id":75970273,"body_markdown":"I want to filter map&lt;String,Object&gt; using the outer and inner key values\r\n\r\nmy map as below\r\n\r\n```\r\n`Map&lt;String,Object&gt; dataMap = new HashMap&lt;&gt;();\r\ndataMap.put(&quot;account&quot;,account);\r\ndataMap.put(&quot;productDetails&quot;,listOfProductDetails);\r\n\r\n\r\n{\r\n  &quot;account&quot;: &quot;JV-013&quot;,\r\n  &quot;productDetails&quot;: [\r\n    {\r\n      &quot;productId&quot;: 1,\r\n      &quot;productName&quot;: &quot;birew&quot;,\r\n      &quot;productVersion&quot;: [\r\n        &quot;v1.0&quot;,\r\n        &quot;v2.0&quot;\r\n      ],\r\n      &quot;productOwner&quot;: [\r\n        {\r\n          &quot;ownerName&quot;: &quot;John&quot;,\r\n          &quot;ownerMail&quot;: &quot;john34@yahoo.com&quot;\r\n        },\r\n        {\r\n          &quot;ownerName&quot;: &quot;Pav&quot;,\r\n          &quot;ownerMail&quot;: &quot;pavghig@yahoo.com&quot;\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      &quot;productId&quot;: 1,\r\n      &quot;productName&quot;: &quot;rowa&quot;,\r\n      &quot;productVersion&quot;: [\r\n        &quot;v1.0&quot;,\r\n        &quot;v2.0&quot;\r\n      ],\r\n      &quot;productOwner&quot;: [\r\n        {\r\n          &quot;ownerName&quot;: &quot;John&quot;,\r\n          &quot;ownerMail&quot;: &quot;john34@yahoo.com&quot;\r\n        },\r\n        {\r\n          &quot;ownerName&quot;: &quot;Rias&quot;,\r\n          &quot;ownerMail&quot;: &quot;rias765@yahoo.com&quot;\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}`\r\n\r\n```\r\nI want to filter &quot;account&quot; which is outer key, and &quot;productName&quot;,&quot;ownerName&quot; which are the inner keys for the list of items in the Map, as below,\r\n\r\n```\r\n`{\r\n  &quot;account&quot;: &quot;JV-013&quot;,\r\n  &quot;productDetails&quot;: [\r\n    {\r\n      &quot;productName&quot;: &quot;birew&quot;,\r\n      &quot;productOwner&quot;: [\r\n        {\r\n          &quot;ownerName&quot;: &quot;John&quot;\r\n        },\r\n        {\r\n          &quot;ownerName&quot;: &quot;Pav&quot;\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      &quot;productName&quot;: &quot;rowa&quot;,\r\n      &quot;productOwner&quot;: [\r\n        {\r\n          &quot;ownerName&quot;: &quot;John&quot;\r\n        },\r\n        {\r\n          &quot;ownerName&quot;: &quot;Rias&quot;\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}`\r\n```\r\nand the filtering keys are not fixed, time to time it can change.\r\n\r\n\r\n\r\nI tried the below,\r\n\r\n```\r\n`public Map&lt;String, Object&gt; filterUsingMap(String filterKeys) throws IOException {\r\n       Map&lt;String, Object&gt; dataMap = new HashMap&lt;&gt;();\r\n\t dataMap.put(&quot;account&quot;,account);\r\n       dataMap.put(&quot;productDetails&quot;,listOfProductDetails);\r\n\r\n\tfilterKeys = account,productDetails.productName,productDetails.productOwner.ownerName\r\n//nestedkeys are using Dot to differentiate\r\n\r\n       List&lt;String&gt; str = Arrays.asList(filterKeys .split(&quot;,&quot;));\r\n\r\n       //filter map with fields\r\n        Map&lt;String, Object&gt; filteredMap1 = dataMap.entrySet()\r\n                .stream()\r\n                .filter(entry -&gt; str.contains(entry.getKey()))\r\n                .collect(Collectors.toConcurrentMap(Map.Entry::getKey, Map.Entry::getValue));\r\n\r\n\r\n        return filteredMap1;\r\n\r\n    }`\r\n```\r\n\r\n\r\nthis only filters the outer keys, can someone help to filter the nestedKeys also\r\n","title":"Filter Map&lt;String,Object&gt; by outer key and also usibg inner key using stream java 8","body":"<p>I want to filter map&lt;String,Object&gt; using the outer and inner key values</p>\n<p>my map as below</p>\n<pre><code>`Map&lt;String,Object&gt; dataMap = new HashMap&lt;&gt;();\ndataMap.put(&quot;account&quot;,account);\ndataMap.put(&quot;productDetails&quot;,listOfProductDetails);\n\n\n{\n  &quot;account&quot;: &quot;JV-013&quot;,\n  &quot;productDetails&quot;: [\n    {\n      &quot;productId&quot;: 1,\n      &quot;productName&quot;: &quot;birew&quot;,\n      &quot;productVersion&quot;: [\n        &quot;v1.0&quot;,\n        &quot;v2.0&quot;\n      ],\n      &quot;productOwner&quot;: [\n        {\n          &quot;ownerName&quot;: &quot;John&quot;,\n          &quot;ownerMail&quot;: &quot;john34@yahoo.com&quot;\n        },\n        {\n          &quot;ownerName&quot;: &quot;Pav&quot;,\n          &quot;ownerMail&quot;: &quot;pavghig@yahoo.com&quot;\n        }\n      ]\n    },\n    {\n      &quot;productId&quot;: 1,\n      &quot;productName&quot;: &quot;rowa&quot;,\n      &quot;productVersion&quot;: [\n        &quot;v1.0&quot;,\n        &quot;v2.0&quot;\n      ],\n      &quot;productOwner&quot;: [\n        {\n          &quot;ownerName&quot;: &quot;John&quot;,\n          &quot;ownerMail&quot;: &quot;john34@yahoo.com&quot;\n        },\n        {\n          &quot;ownerName&quot;: &quot;Rias&quot;,\n          &quot;ownerMail&quot;: &quot;rias765@yahoo.com&quot;\n        }\n      ]\n    }\n  ]\n}`\n\n</code></pre>\n<p>I want to filter &quot;account&quot; which is outer key, and &quot;productName&quot;,&quot;ownerName&quot; which are the inner keys for the list of items in the Map, as below,</p>\n<pre><code>`{\n  &quot;account&quot;: &quot;JV-013&quot;,\n  &quot;productDetails&quot;: [\n    {\n      &quot;productName&quot;: &quot;birew&quot;,\n      &quot;productOwner&quot;: [\n        {\n          &quot;ownerName&quot;: &quot;John&quot;\n        },\n        {\n          &quot;ownerName&quot;: &quot;Pav&quot;\n        }\n      ]\n    },\n    {\n      &quot;productName&quot;: &quot;rowa&quot;,\n      &quot;productOwner&quot;: [\n        {\n          &quot;ownerName&quot;: &quot;John&quot;\n        },\n        {\n          &quot;ownerName&quot;: &quot;Rias&quot;\n        }\n      ]\n    }\n  ]\n}`\n</code></pre>\n<p>and the filtering keys are not fixed, time to time it can change.</p>\n<p>I tried the below,</p>\n<pre><code>`public Map&lt;String, Object&gt; filterUsingMap(String filterKeys) throws IOException {\n       Map&lt;String, Object&gt; dataMap = new HashMap&lt;&gt;();\n     dataMap.put(&quot;account&quot;,account);\n       dataMap.put(&quot;productDetails&quot;,listOfProductDetails);\n\n    filterKeys = account,productDetails.productName,productDetails.productOwner.ownerName\n//nestedkeys are using Dot to differentiate\n\n       List&lt;String&gt; str = Arrays.asList(filterKeys .split(&quot;,&quot;));\n\n       //filter map with fields\n        Map&lt;String, Object&gt; filteredMap1 = dataMap.entrySet()\n                .stream()\n                .filter(entry -&gt; str.contains(entry.getKey()))\n                .collect(Collectors.toConcurrentMap(Map.Entry::getKey, Map.Entry::getValue));\n\n\n        return filteredMap1;\n\n    }`\n</code></pre>\n<p>this only filters the outer keys, can someone help to filter the nestedKeys also</p>\n"},{"tags":["java","json","log4j"],"answers":[{"tags":[],"owner":{"account_id":16269349,"reputation":13452,"user_id":11748454,"display_name":"Piotr P. Karwasz"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681040502,"creation_date":1681040502,"answer_id":75970272,"question_id":75956483,"body_markdown":"[The `IllegalStateException` is due to a bug introduced in version 2.15.0 and solved in 2.19.0 (cf. [LOG4J2-3614](https://issues.apache.org/jira/browse/LOG4J2-3614)). Upgrade to version 2.20.0 to get rid of it]\r\n\r\nLog4j2 uses multiple date formatters: Apache Commons&#39; [`FastDateFormat`](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/time/FastDateFormat.html), Log4j&#39;s [`FixedDateFormat`](https://logging.apache.org/log4j/2.x/log4j-core/apidocs/org/apache/logging/log4j/core/util/datetime/FixedDateFormat.html) (an optimalized version of the first one) and Java&#39;s [`DateTimeFormatter`](https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html).\r\n\r\nThe default JSON Template Layout is `yyyy-MM-dd&#39;T&#39;HH:mm:ss.SSSZZZ`, where the time zone part is interpreted as:\r\n\r\n * sign + 2 digits + colon + 2 digits by `FastDateFormat`\r\n * sign + 4 digits by `DateTimeFormatter`.\r\n\r\nDue to some changes in version 2.15.0 the semantics of the pattern switched from `FastDateFormat` to `DateTimeFormatter`. I have reported it as [Github issue #1420](https://github.com/apache/logging-log4j2/issues/1420).\r\n\r\nTo maintain the previous behavior you need to use:\r\n\r\n```json\r\n&quot;timestamp&quot;: {\r\n    &quot;$resolver&quot;: &quot;timestamp&quot;,\r\n    &quot;pattern&quot;: {\r\n      &quot;format&quot;: &quot;yyyy-MM-dd&#39;T&#39;HH:mm:ss.SSSxxx&quot;\r\n    }\r\n}\r\n```\r\n\r\nAn `XXX` pattern would output `Z` instead of `+00:00`.","title":"Log4J2: JsonTemplateLayout timestamp format problem","body":"<p>[The <code>IllegalStateException</code> is due to a bug introduced in version 2.15.0 and solved in 2.19.0 (cf. <a href=\"https://issues.apache.org/jira/browse/LOG4J2-3614\" rel=\"nofollow noreferrer\">LOG4J2-3614</a>). Upgrade to version 2.20.0 to get rid of it]</p>\n<p>Log4j2 uses multiple date formatters: Apache Commons' <a href=\"https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/time/FastDateFormat.html\" rel=\"nofollow noreferrer\"><code>FastDateFormat</code></a>, Log4j's <a href=\"https://logging.apache.org/log4j/2.x/log4j-core/apidocs/org/apache/logging/log4j/core/util/datetime/FixedDateFormat.html\" rel=\"nofollow noreferrer\"><code>FixedDateFormat</code></a> (an optimalized version of the first one) and Java's <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html\" rel=\"nofollow noreferrer\"><code>DateTimeFormatter</code></a>.</p>\n<p>The default JSON Template Layout is <code>yyyy-MM-dd'T'HH:mm:ss.SSSZZZ</code>, where the time zone part is interpreted as:</p>\n<ul>\n<li>sign + 2 digits + colon + 2 digits by <code>FastDateFormat</code></li>\n<li>sign + 4 digits by <code>DateTimeFormatter</code>.</li>\n</ul>\n<p>Due to some changes in version 2.15.0 the semantics of the pattern switched from <code>FastDateFormat</code> to <code>DateTimeFormatter</code>. I have reported it as <a href=\"https://github.com/apache/logging-log4j2/issues/1420\" rel=\"nofollow noreferrer\">Github issue #1420</a>.</p>\n<p>To maintain the previous behavior you need to use:</p>\n<pre class=\"lang-json prettyprint-override\"><code>&quot;timestamp&quot;: {\n    &quot;$resolver&quot;: &quot;timestamp&quot;,\n    &quot;pattern&quot;: {\n      &quot;format&quot;: &quot;yyyy-MM-dd'T'HH:mm:ss.SSSxxx&quot;\n    }\n}\n</code></pre>\n<p>An <code>XXX</code> pattern would output <code>Z</code> instead of <code>+00:00</code>.</p>\n"}],"owner":{"account_id":14593176,"reputation":115,"user_id":10539722,"display_name":"3AKOBAH"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":447,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1681040502,"creation_date":1680853637,"question_id":75956483,"body_markdown":"\r\nI jave a log4j timestamp formatting problem, any help will be appreciated.\r\n\r\nUsing ```JsonTemplateLayout``` and following xml config, I am trying, with no success, to achieve timestamp formatting like so:\r\n```2020-02-07T13:38:47.098+02:00```(Notice the ```:``` char at +02:00):\r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;Configuration status=&quot;INFO&quot;&gt;\r\n    &lt;Appenders&gt;\r\n        &lt;Console name=&quot;ConsoleJSONAppender&quot; target=&quot;SYSTEM_OUT&quot;&gt;\r\n          &lt;JsonTemplateLayout eventTemplateUri=&quot;classpath:log4j2.json&quot;/&gt;\r\n        &lt;/Console&gt;\r\n    &lt;/Appenders&gt;\r\n    &lt;Loggers&gt;\r\n        &lt;Logger name=&quot;com.my.logger&quot; additivity=&quot;false&quot; level=&quot;debug&quot;&gt;\r\n            &lt;AppenderRef ref=&quot;ConsoleJSONAppender&quot;/&gt;\r\n        &lt;/Logger&gt;\r\n    &lt;/Loggers&gt;\r\n&lt;/Configuration&gt;\r\n```\r\n\r\nAccording to the [Timestamp Resolver manual](https://logging.apache.org/log4j/2.x/manual/json-template-layout.html#event-template-resolver-timestamp) the default format is the one I need,\r\nbut the parsed format looks like this:\r\n\r\n```2020-02-07T13:38:47.098+0200```. (Notice the missing colon char at +0200)\r\n\r\nFollowing is a snippet from my eventTemplate JSON using default formatting and resulting to the format above.\r\n```\r\n  &quot;timestamp&quot;: {\r\n    &quot;$resolver&quot;: &quot;timestamp&quot;\r\n  }\r\n```\r\n\r\nUsing the ```ISO8601_OFFSET_DATE_TIME_HHCMM``` of [FixedDateFormat.FixedFormat](https://logging.apache.org/log4j/2.x/log4j-core/apidocs/org/apache/logging/log4j/core/util/datetime/FixedDateFormat.FixedFormat.html#ISO8601_OFFSET_DATE_TIME_HHCMM) enum also leads to formatting without ```:``` at +02:00:\r\n```\r\n&quot;timestamp&quot;: {\r\n    &quot;$resolver&quot;: &quot;timestamp&quot;,\r\n    &quot;format&quot;: &quot;%d{ISO8601_OFFSET_DATE_TIME_HHCMM}&quot;\r\n  }\r\n```\r\n\r\nStrangely, using the format from ```ISO8601_OFFSET_DATE_TIME_HHCMM``` which is ```yyyy-MM-dd&#39;T&#39;HH:mm:ss,SSSXXX```, I get exception:\r\n```\r\nUnable to invoke factory method in class org.apache.logging.log4j.layout.template.json.JsonTemplateLayout for element JsonTemplateLayout:\r\njava.lang.IllegalStateException:\r\nNo factory method found for class org.apache.logging.log4j.layout.template.json.JsonTemplateLayout java.lang.IllegalStateException:\r\nNo factory method found for class org.apache.logging.log4j.layout.template.json.JsonTemplateLayout\r\n```\r\n```\r\n&quot;timestamp&quot;: {\r\n    &quot;$resolver&quot;: &quot;timestamp&quot;,\r\n    &quot;pattern&quot;: {\r\n      &quot;format&quot;: &quot;yyyy-MM-dd&#39;T&#39;HH:mm:ss,SSSXXX&quot;,\r\n      &quot;timeZone&quot;: &quot;UTC&quot;\r\n    }\r\n  }\r\n```\r\n","title":"Log4J2: JsonTemplateLayout timestamp format problem","body":"<p>I jave a log4j timestamp formatting problem, any help will be appreciated.</p>\n<p>Using <code>JsonTemplateLayout</code> and following xml config, I am trying, with no success, to achieve timestamp formatting like so:\n<code>2020-02-07T13:38:47.098+02:00</code>(Notice the <code>:</code> char at +02:00):</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;Configuration status=&quot;INFO&quot;&gt;\n    &lt;Appenders&gt;\n        &lt;Console name=&quot;ConsoleJSONAppender&quot; target=&quot;SYSTEM_OUT&quot;&gt;\n          &lt;JsonTemplateLayout eventTemplateUri=&quot;classpath:log4j2.json&quot;/&gt;\n        &lt;/Console&gt;\n    &lt;/Appenders&gt;\n    &lt;Loggers&gt;\n        &lt;Logger name=&quot;com.my.logger&quot; additivity=&quot;false&quot; level=&quot;debug&quot;&gt;\n            &lt;AppenderRef ref=&quot;ConsoleJSONAppender&quot;/&gt;\n        &lt;/Logger&gt;\n    &lt;/Loggers&gt;\n&lt;/Configuration&gt;\n</code></pre>\n<p>According to the <a href=\"https://logging.apache.org/log4j/2.x/manual/json-template-layout.html#event-template-resolver-timestamp\" rel=\"nofollow noreferrer\">Timestamp Resolver manual</a> the default format is the one I need,\nbut the parsed format looks like this:</p>\n<p><code>2020-02-07T13:38:47.098+0200</code>. (Notice the missing colon char at +0200)</p>\n<p>Following is a snippet from my eventTemplate JSON using default formatting and resulting to the format above.</p>\n<pre><code>  &quot;timestamp&quot;: {\n    &quot;$resolver&quot;: &quot;timestamp&quot;\n  }\n</code></pre>\n<p>Using the <code>ISO8601_OFFSET_DATE_TIME_HHCMM</code> of <a href=\"https://logging.apache.org/log4j/2.x/log4j-core/apidocs/org/apache/logging/log4j/core/util/datetime/FixedDateFormat.FixedFormat.html#ISO8601_OFFSET_DATE_TIME_HHCMM\" rel=\"nofollow noreferrer\">FixedDateFormat.FixedFormat</a> enum also leads to formatting without <code>:</code> at +02:00:</p>\n<pre><code>&quot;timestamp&quot;: {\n    &quot;$resolver&quot;: &quot;timestamp&quot;,\n    &quot;format&quot;: &quot;%d{ISO8601_OFFSET_DATE_TIME_HHCMM}&quot;\n  }\n</code></pre>\n<p>Strangely, using the format from <code>ISO8601_OFFSET_DATE_TIME_HHCMM</code> which is <code>yyyy-MM-dd'T'HH:mm:ss,SSSXXX</code>, I get exception:</p>\n<pre><code>Unable to invoke factory method in class org.apache.logging.log4j.layout.template.json.JsonTemplateLayout for element JsonTemplateLayout:\njava.lang.IllegalStateException:\nNo factory method found for class org.apache.logging.log4j.layout.template.json.JsonTemplateLayout java.lang.IllegalStateException:\nNo factory method found for class org.apache.logging.log4j.layout.template.json.JsonTemplateLayout\n</code></pre>\n<pre><code>&quot;timestamp&quot;: {\n    &quot;$resolver&quot;: &quot;timestamp&quot;,\n    &quot;pattern&quot;: {\n      &quot;format&quot;: &quot;yyyy-MM-dd'T'HH:mm:ss,SSSXXX&quot;,\n      &quot;timeZone&quot;: &quot;UTC&quot;\n    }\n  }\n</code></pre>\n"},{"tags":["java","spring-boot","spring-security","dependencies","thymeleaf"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1681140164,"post_id":75970248,"comment_id":134004804,"body_markdown":"Please trim your code to make it easier to find your problem. Follow these guidelines to create a [minimal reproducible example](https://stackoverflow.com/help/minimal-reproducible-example).","body":"Please trim your code to make it easier to find your problem. Follow these guidelines to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}],"owner":{"account_id":25595519,"reputation":1,"user_id":20401763,"display_name":"Andrew"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":127,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681040190,"creation_date":1681040142,"question_id":75970248,"body_markdown":"When I want to run my application on Java, I have following problem:\r\n\r\n```\r\n2023-04-09 13:12:24.474  INFO 10620 --- [           main] c.e.a.SportsManagementSystemApplication  : Starting SportsManagementSystemApplication using Java 11.0.18 on Quizer with PID 10620 (C:\\Users\\akiri\\IdeaProjects\\SportsManagementSystemApplication\\target\\classes started by akiri in C:\\Users\\akiri\\IdeaProjects\\SportsManagementSystemApplication)\r\n2023-04-09 13:12:24.477  INFO 10620 --- [           main] c.e.a.SportsManagementSystemApplication  : No active profile set, falling back to 1 default profile: &quot;default&quot;\r\n2023-04-09 13:12:24.792  INFO 10620 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.\r\n2023-04-09 13:12:24.826  INFO 10620 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 27 ms. Found 1 JPA repository interfaces.\r\n2023-04-09 13:12:25.276  INFO 10620 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)\r\n2023-04-09 13:12:25.281  INFO 10620 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]\r\n2023-04-09 13:12:25.281  INFO 10620 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]\r\n2023-04-09 13:12:25.369  INFO 10620 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext\r\n2023-04-09 13:12:25.369  INFO 10620 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 864 ms\r\n2023-04-09 13:12:25.441  WARN 10620 --- [           main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;dataSourceScriptDatabaseInitializer&#39; defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Unsatisfied dependency expressed through method &#39;dataSourceScriptDatabaseInitializer&#39; parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;springSecurity&#39;: Unsatisfied dependency expressed through method &#39;setUserDetailsService&#39; parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;customUserDetailsService&#39; defined in file [C:\\Users\\akiri\\IdeaProjects\\SportsManagementSystemApplication\\target\\classes\\com\\example\\application\\Security\\CustomUserDetailsService.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;users&#39; defined in com.example.application.UserRepository.UserRepository defined in @EnableJpaRepositories declared on SpringSecurity: Cannot create inner bean &#39;(inner bean)#712ac7e6&#39; of type [org.springframework.orm.jpa.SharedEntityManagerCreator] while setting bean property &#39;entityManager&#39;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;(inner bean)#712ac7e6&#39;: Cannot resolve reference to bean &#39;entityManagerFactory&#39; while setting constructor argument; nested exception is org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name &#39;dataSourceScriptDatabaseInitializer&#39;: Requested bean is currently in creation: Is there an unresolvable circular reference?\r\n2023-04-09 13:12:25.443  INFO 10620 --- [           main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]\r\n2023-04-09 13:12:25.453  INFO 10620 --- [           main] ConditionEvaluationReportLoggingListener : \r\n\r\nError starting ApplicationContext. To display the conditions report re-run your application with &#39;debug&#39; enabled.\r\n2023-04-09 13:12:25.462 ERROR 10620 --- [           main] o.s.b.d.LoggingFailureAnalysisReporter   : \r\n\r\n***************************\r\nAPPLICATION FAILED TO START\r\n***************************\r\n\r\nDescription:\r\n\r\nThe dependencies of some of the beans in the application context form a cycle:\r\n\r\n┌─────┐\r\n|  dataSourceScriptDatabaseInitializer defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]\r\n↑     ↓\r\n|  springSecurity\r\n↑     ↓\r\n|  customUserDetailsService defined in file [C:\\Users\\akiri\\IdeaProjects\\SportsManagementSystemApplication\\target\\classes\\com\\example\\application\\Security\\CustomUserDetailsService.class]\r\n↑     ↓\r\n|  users defined in com.example.application.UserRepository.UserRepository defined in @EnableJpaRepositories declared on SpringSecurity\r\n↑     ↓\r\n|  (inner bean)#712ac7e6\r\n└─────┘\r\n\r\n\r\nAction:\r\n\r\nRelying upon circular references is discouraged and they are prohibited by default. Update your application to remove the dependency cycle between beans. As a last resort, it may be possible to break the cycle automatically by setting spring.main.allow-circular-references to true.\r\n\r\n\r\nProcess finished with exit code 1\r\n```\r\n\r\nThis is my pom.xml:  \r\n\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n\t\t xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n\t\t xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n\t&lt;parent&gt;\r\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;2.7.5&lt;/version&gt;\r\n\t\t&lt;relativePath/&gt;\r\n\t&lt;/parent&gt;\r\n\t&lt;groupId&gt;org.example&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;SportApiDemo&lt;/artifactId&gt;\r\n\t&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\r\n\r\n\t&lt;properties&gt;\r\n\t\t&lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;\r\n\t\t&lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;\r\n\t\t&lt;org.projectlombok.version&gt;1.18.26&lt;/org.projectlombok.version&gt;\r\n\t&lt;/properties&gt;\r\n\r\n\t&lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.postgresql&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;postgresql&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;42.5.4&lt;/version&gt;\r\n\t\t\t&lt;scope&gt;runtime&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\r\n\t\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;xml-apis&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;xml-apis&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.0.2&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.hibernate&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;6.1.7.Final&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t\t&lt;dependency&gt;\r\n\t\t\t\t&lt;groupId&gt;javax.validation&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;validation-api&lt;/artifactId&gt;\r\n\t\t\t\t&lt;version&gt;2.0.1.Final&lt;/version&gt;\r\n\t\t\t&lt;/dependency&gt;\r\n\t\t\t&lt;dependency&gt;\r\n\t\t\t\t&lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\r\n\t\t\t\t&lt;version&gt;8.0.0.Final&lt;/version&gt;\r\n\t\t\t&lt;/dependency&gt;\r\n\t\t\t&lt;dependency&gt;\r\n\t\t\t\t&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\r\n\t\t\t\t&lt;artifactId&gt;lombok&lt;/artifactId&gt;\r\n\t\t\t\t&lt;version&gt;1.18.26&lt;/version&gt;\r\n\t\t\t\t&lt;scope&gt;provided&lt;/scope&gt;\r\n\t\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.jetbrains&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;annotations&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;24.0.1&lt;/version&gt;\r\n\t\t\t&lt;scope&gt;compile&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t&lt;/dependencies&gt;\r\n\r\n&lt;/project&gt;\r\n```\r\n\r\nThis is my Spring Security:\r\n\r\n```\r\npackage com.example.application.Config;\r\n\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.data.jpa.repository.config.EnableJpaRepositories;\r\nimport org.springframework.jdbc.datasource.DriverManagerDataSource;\r\nimport org.springframework.orm.jpa.JpaVendorAdapter;\r\nimport org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\r\nimport org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;\r\nimport org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;\r\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\r\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\r\nimport org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\r\nimport org.springframework.security.core.userdetails.UserDetailsService;\r\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\r\nimport org.springframework.security.crypto.password.PasswordEncoder;\r\nimport org.springframework.security.web.util.matcher.AntPathRequestMatcher;\r\n\r\nimport javax.sql.DataSource;\r\nimport java.util.Properties;\r\n\r\n@Configuration\r\n@EnableJpaRepositories(basePackages = &quot;com.example.application.UserRepository&quot;)\r\n@EnableWebSecurity\r\npublic class SpringSecurity extends WebSecurityConfigurerAdapter {\r\n\r\n    private UserDetailsService userDetailsService;\r\n\r\n    @Autowired\r\n    public void setUserDetailsService(UserDetailsService userDetailsService) {\r\n        this.userDetailsService = userDetailsService;\r\n    }\r\n\r\n    @Bean\r\n    public PasswordEncoder passwordEncoder() {\r\n        return new BCryptPasswordEncoder();\r\n    }\r\n\r\n    @Bean\r\n    public LocalContainerEntityManagerFactoryBean entityManagerFactory() {\r\n        LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();\r\n        em.setDataSource(dataSource());\r\n        em.setPackagesToScan(&quot;com.example.application&quot;);\r\n\r\n        JpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();\r\n        em.setJpaVendorAdapter(vendorAdapter);\r\n        em.setJpaProperties(additionalProperties());\r\n\r\n        return em;\r\n    }\r\n\r\n    @Bean\r\n    public DataSource dataSource() {\r\n        DriverManagerDataSource dataSource = new DriverManagerDataSource();\r\n        dataSource.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;);\r\n        dataSource.setUrl(&quot;jdbc:mysql://localhost:5432/User&quot;);\r\n        dataSource.setUsername(&quot;postgres&quot;);\r\n        dataSource.setPassword(&quot;75801&quot;);\r\n\r\n        return dataSource;\r\n    }\r\n\r\n    private Properties additionalProperties() {\r\n        Properties properties = new Properties();\r\n        properties.setProperty(&quot;hibernate.hbm2ddl.auto&quot;, &quot;update&quot;);\r\n        properties.setProperty(&quot;hibernate.dialect&quot;, &quot;org.hibernate.dialect.MySQL5InnoDBDialect&quot;);\r\n        properties.setProperty(&quot;hibernate.show_sql&quot;, &quot;true&quot;);\r\n\r\n        return properties;\r\n    }\r\n\r\n    @Override\r\n    protected void configure(HttpSecurity http) throws Exception {\r\n        http\r\n                .authorizeRequests()\r\n                .antMatchers(&quot;/register/**&quot;).permitAll()\r\n                .antMatchers(&quot;/index&quot;).permitAll()\r\n                .antMatchers(&quot;/users&quot;).hasRole(&quot;ADMIN&quot;)\r\n                .and()\r\n                .formLogin()\r\n                .loginPage(&quot;/login&quot;)\r\n                .loginProcessingUrl(&quot;/login&quot;)\r\n                .defaultSuccessUrl(&quot;/users&quot;)\r\n                .permitAll()\r\n                .and()\r\n                .logout()\r\n                .logoutRequestMatcher(new AntPathRequestMatcher(&quot;/logout&quot;))\r\n                .permitAll();\r\n    }\r\n\r\n    @Override\r\n    public void configure(AuthenticationManagerBuilder auth) throws Exception {\r\n        auth\r\n                .userDetailsService(userDetailsService)\r\n                .passwordEncoder(passwordEncoder());\r\n    }\r\n}\r\n```\r\n\r\nThis is my CustomUserDetailsService:\r\n\r\n```\r\npackage com.example.application.Security;\r\n\r\nimport com.example.application.Role.Role;\r\nimport com.example.application.User.User;\r\nimport com.example.application.UserRepository.UserRepository;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.security.core.GrantedAuthority;\r\nimport org.springframework.security.core.authority.SimpleGrantedAuthority;\r\nimport org.springframework.security.core.userdetails.UserDetails;\r\nimport org.springframework.security.core.userdetails.UserDetailsService;\r\nimport org.springframework.security.core.userdetails.UsernameNotFoundException;\r\nimport org.springframework.stereotype.Service;\r\n\r\nimport java.util.Collection;\r\nimport java.util.stream.Collectors;\r\n\r\n@Service\r\npublic class CustomUserDetailsService implements UserDetailsService {\r\n\r\n    @Autowired\r\n    private UserRepository userRepository;\r\n\r\n    public CustomUserDetailsService(UserRepository userRepository) {\r\n        this.userRepository = userRepository;\r\n    }\r\n\r\n    @Override\r\n    public UserDetails loadUserByUsername(String email) throws UsernameNotFoundException {\r\n        User user = userRepository.findByEmail(email);\r\n\r\n        if (user != null) {\r\n            return new org.springframework.security.core.userdetails.User(user.getEmail(),\r\n                    user.getPassword(),\r\n                    mapRolesToAuthorities(user.getRoles()));\r\n        }else{\r\n            throw new UsernameNotFoundException(&quot;Invalid username or password.&quot;);\r\n        }\r\n    }\r\n\r\n    private Collection&lt; ? extends GrantedAuthority&gt; mapRolesToAuthorities(Collection &lt;Role&gt; roles) {\r\n        Collection &lt; ? extends GrantedAuthority&gt; mapRoles = roles.stream()\r\n                .map(role -&gt; new SimpleGrantedAuthority(role.getName()))\r\n                .collect(Collectors.toList());\r\n        return mapRoles;\r\n    }\r\n}\r\n```\r\n\r\nThis is my UserRepository:\r\n\r\n```\r\npackage com.example.application.UserRepository;\r\n\r\nimport com.example.application.User.User;\r\nimport org.springframework.data.jpa.repository.JpaRepository;\r\nimport org.springframework.data.jpa.repository.JpaSpecificationExecutor;\r\nimport org.springframework.stereotype.Repository;\r\n\r\n\r\n@Repository(value=&quot;users&quot;)\r\npublic interface UserRepository extends JpaRepository&lt;User, Long&gt;, JpaSpecificationExecutor&lt;User&gt; {\r\n\r\n    User findByEmail(String email);\r\n\r\n}\r\n```\r\n\r\nThis is my User:\r\n\r\n```\r\npackage com.example.application.User;\r\n\r\n\r\nimport com.example.application.Role.Role;\r\nimport lombok.Getter;\r\nimport lombok.NoArgsConstructor;\r\nimport lombok.Setter;\r\nimport org.hibernate.annotations.Table;\r\n\r\nimport javax.persistence.*;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\n@Getter\r\n@Table(appliesTo = &quot;users&quot;)\r\n@Setter\r\n@NoArgsConstructor\r\n@Entity\r\npublic class User {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n\r\n    @Column(nullable = false)\r\n    private String name;\r\n\r\n    @Column(nullable = false, unique = true)\r\n    private String email;\r\n\r\n    @Column(nullable = false)\r\n    private String password;\r\n\r\n    @ManyToMany(fetch = FetchType.EAGER, cascade = CascadeType.ALL)\r\n    @JoinTable(\r\n            name = &quot;users_roles&quot;,\r\n            joinColumns = {@JoinColumn(name = &quot;USERS_ID&quot;, referencedColumnName = &quot;ID&quot;)},\r\n            inverseJoinColumns = {@JoinColumn(name = &quot;ROLES_ID&quot;, referencedColumnName = &quot;ID&quot;)})\r\n    private List&lt;Role&gt; roles = new ArrayList&lt;&gt;();\r\n\r\n}\r\n\r\n```\r\n\r\nThis is my Role:\r\n\r\n```\r\npackage com.example.application.Role;\r\n\r\n\r\nimport com.example.application.User.User;\r\nimport lombok.AllArgsConstructor;\r\nimport lombok.Getter;\r\nimport lombok.NoArgsConstructor;\r\nimport lombok.Setter;\r\nimport org.hibernate.annotations.Table;\r\n\r\nimport javax.persistence.*;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\n@Setter\r\n@Getter\r\n@NoArgsConstructor\r\n@AllArgsConstructor\r\n@Table(appliesTo = &quot;roles&quot;)\r\n@Entity\r\npublic class Role\r\n{\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n\r\n    @Column(nullable=false, unique=true)\r\n    private String name;\r\n\r\n    @ManyToMany(mappedBy = &quot;roles&quot;)\r\n    private List&lt;User&gt; users = new ArrayList&lt;&gt;();\r\n}\r\n```\r\n\r\nActually, I have already tried to add lazy annotation in my class but unfortunately it hasn&#39;t work.However I have already added permission in application.properties for spring that he can allow circular references in project and this is too hasn&#39;t helping me.","title":"Spring boot and ThymeLeaf:The dependencies of some of the beans in the application context form a cycle","body":"<p>When I want to run my application on Java, I have following problem:</p>\n<pre><code>2023-04-09 13:12:24.474  INFO 10620 --- [           main] c.e.a.SportsManagementSystemApplication  : Starting SportsManagementSystemApplication using Java 11.0.18 on Quizer with PID 10620 (C:\\Users\\akiri\\IdeaProjects\\SportsManagementSystemApplication\\target\\classes started by akiri in C:\\Users\\akiri\\IdeaProjects\\SportsManagementSystemApplication)\n2023-04-09 13:12:24.477  INFO 10620 --- [           main] c.e.a.SportsManagementSystemApplication  : No active profile set, falling back to 1 default profile: &quot;default&quot;\n2023-04-09 13:12:24.792  INFO 10620 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.\n2023-04-09 13:12:24.826  INFO 10620 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 27 ms. Found 1 JPA repository interfaces.\n2023-04-09 13:12:25.276  INFO 10620 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)\n2023-04-09 13:12:25.281  INFO 10620 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]\n2023-04-09 13:12:25.281  INFO 10620 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.68]\n2023-04-09 13:12:25.369  INFO 10620 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext\n2023-04-09 13:12:25.369  INFO 10620 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 864 ms\n2023-04-09 13:12:25.441  WARN 10620 --- [           main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Unsatisfied dependency expressed through method 'dataSourceScriptDatabaseInitializer' parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'springSecurity': Unsatisfied dependency expressed through method 'setUserDetailsService' parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'customUserDetailsService' defined in file [C:\\Users\\akiri\\IdeaProjects\\SportsManagementSystemApplication\\target\\classes\\com\\example\\application\\Security\\CustomUserDetailsService.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'users' defined in com.example.application.UserRepository.UserRepository defined in @EnableJpaRepositories declared on SpringSecurity: Cannot create inner bean '(inner bean)#712ac7e6' of type [org.springframework.orm.jpa.SharedEntityManagerCreator] while setting bean property 'entityManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name '(inner bean)#712ac7e6': Cannot resolve reference to bean 'entityManagerFactory' while setting constructor argument; nested exception is org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer': Requested bean is currently in creation: Is there an unresolvable circular reference?\n2023-04-09 13:12:25.443  INFO 10620 --- [           main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]\n2023-04-09 13:12:25.453  INFO 10620 --- [           main] ConditionEvaluationReportLoggingListener : \n\nError starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.\n2023-04-09 13:12:25.462 ERROR 10620 --- [           main] o.s.b.d.LoggingFailureAnalysisReporter   : \n\n***************************\nAPPLICATION FAILED TO START\n***************************\n\nDescription:\n\nThe dependencies of some of the beans in the application context form a cycle:\n\n┌─────┐\n|  dataSourceScriptDatabaseInitializer defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]\n↑     ↓\n|  springSecurity\n↑     ↓\n|  customUserDetailsService defined in file [C:\\Users\\akiri\\IdeaProjects\\SportsManagementSystemApplication\\target\\classes\\com\\example\\application\\Security\\CustomUserDetailsService.class]\n↑     ↓\n|  users defined in com.example.application.UserRepository.UserRepository defined in @EnableJpaRepositories declared on SpringSecurity\n↑     ↓\n|  (inner bean)#712ac7e6\n└─────┘\n\n\nAction:\n\nRelying upon circular references is discouraged and they are prohibited by default. Update your application to remove the dependency cycle between beans. As a last resort, it may be possible to break the cycle automatically by setting spring.main.allow-circular-references to true.\n\n\nProcess finished with exit code 1\n</code></pre>\n<p>This is my pom.xml:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.7.5&lt;/version&gt;\n        &lt;relativePath/&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;org.example&lt;/groupId&gt;\n    &lt;artifactId&gt;SportApiDemo&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;\n        &lt;org.projectlombok.version&gt;1.18.26&lt;/org.projectlombok.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n            &lt;version&gt;42.5.4&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n            &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n            &lt;artifactId&gt;xml-apis&lt;/artifactId&gt;\n            &lt;version&gt;2.0.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n            &lt;version&gt;6.1.7.Final&lt;/version&gt;\n        &lt;/dependency&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;javax.validation&lt;/groupId&gt;\n                &lt;artifactId&gt;validation-api&lt;/artifactId&gt;\n                &lt;version&gt;2.0.1.Final&lt;/version&gt;\n            &lt;/dependency&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;\n                &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\n                &lt;version&gt;8.0.0.Final&lt;/version&gt;\n            &lt;/dependency&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n                &lt;version&gt;1.18.26&lt;/version&gt;\n                &lt;scope&gt;provided&lt;/scope&gt;\n            &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jetbrains&lt;/groupId&gt;\n            &lt;artifactId&gt;annotations&lt;/artifactId&gt;\n            &lt;version&gt;24.0.1&lt;/version&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p>This is my Spring Security:</p>\n<pre><code>package com.example.application.Config;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.data.jpa.repository.config.EnableJpaRepositories;\nimport org.springframework.jdbc.datasource.DriverManagerDataSource;\nimport org.springframework.orm.jpa.JpaVendorAdapter;\nimport org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\nimport org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;\nimport org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.security.web.util.matcher.AntPathRequestMatcher;\n\nimport javax.sql.DataSource;\nimport java.util.Properties;\n\n@Configuration\n@EnableJpaRepositories(basePackages = &quot;com.example.application.UserRepository&quot;)\n@EnableWebSecurity\npublic class SpringSecurity extends WebSecurityConfigurerAdapter {\n\n    private UserDetailsService userDetailsService;\n\n    @Autowired\n    public void setUserDetailsService(UserDetailsService userDetailsService) {\n        this.userDetailsService = userDetailsService;\n    }\n\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n\n    @Bean\n    public LocalContainerEntityManagerFactoryBean entityManagerFactory() {\n        LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();\n        em.setDataSource(dataSource());\n        em.setPackagesToScan(&quot;com.example.application&quot;);\n\n        JpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();\n        em.setJpaVendorAdapter(vendorAdapter);\n        em.setJpaProperties(additionalProperties());\n\n        return em;\n    }\n\n    @Bean\n    public DataSource dataSource() {\n        DriverManagerDataSource dataSource = new DriverManagerDataSource();\n        dataSource.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;);\n        dataSource.setUrl(&quot;jdbc:mysql://localhost:5432/User&quot;);\n        dataSource.setUsername(&quot;postgres&quot;);\n        dataSource.setPassword(&quot;75801&quot;);\n\n        return dataSource;\n    }\n\n    private Properties additionalProperties() {\n        Properties properties = new Properties();\n        properties.setProperty(&quot;hibernate.hbm2ddl.auto&quot;, &quot;update&quot;);\n        properties.setProperty(&quot;hibernate.dialect&quot;, &quot;org.hibernate.dialect.MySQL5InnoDBDialect&quot;);\n        properties.setProperty(&quot;hibernate.show_sql&quot;, &quot;true&quot;);\n\n        return properties;\n    }\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http\n                .authorizeRequests()\n                .antMatchers(&quot;/register/**&quot;).permitAll()\n                .antMatchers(&quot;/index&quot;).permitAll()\n                .antMatchers(&quot;/users&quot;).hasRole(&quot;ADMIN&quot;)\n                .and()\n                .formLogin()\n                .loginPage(&quot;/login&quot;)\n                .loginProcessingUrl(&quot;/login&quot;)\n                .defaultSuccessUrl(&quot;/users&quot;)\n                .permitAll()\n                .and()\n                .logout()\n                .logoutRequestMatcher(new AntPathRequestMatcher(&quot;/logout&quot;))\n                .permitAll();\n    }\n\n    @Override\n    public void configure(AuthenticationManagerBuilder auth) throws Exception {\n        auth\n                .userDetailsService(userDetailsService)\n                .passwordEncoder(passwordEncoder());\n    }\n}\n</code></pre>\n<p>This is my CustomUserDetailsService:</p>\n<pre><code>package com.example.application.Security;\n\nimport com.example.application.Role.Role;\nimport com.example.application.User.User;\nimport com.example.application.UserRepository.UserRepository;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.security.core.GrantedAuthority;\nimport org.springframework.security.core.authority.SimpleGrantedAuthority;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.core.userdetails.UsernameNotFoundException;\nimport org.springframework.stereotype.Service;\n\nimport java.util.Collection;\nimport java.util.stream.Collectors;\n\n@Service\npublic class CustomUserDetailsService implements UserDetailsService {\n\n    @Autowired\n    private UserRepository userRepository;\n\n    public CustomUserDetailsService(UserRepository userRepository) {\n        this.userRepository = userRepository;\n    }\n\n    @Override\n    public UserDetails loadUserByUsername(String email) throws UsernameNotFoundException {\n        User user = userRepository.findByEmail(email);\n\n        if (user != null) {\n            return new org.springframework.security.core.userdetails.User(user.getEmail(),\n                    user.getPassword(),\n                    mapRolesToAuthorities(user.getRoles()));\n        }else{\n            throw new UsernameNotFoundException(&quot;Invalid username or password.&quot;);\n        }\n    }\n\n    private Collection&lt; ? extends GrantedAuthority&gt; mapRolesToAuthorities(Collection &lt;Role&gt; roles) {\n        Collection &lt; ? extends GrantedAuthority&gt; mapRoles = roles.stream()\n                .map(role -&gt; new SimpleGrantedAuthority(role.getName()))\n                .collect(Collectors.toList());\n        return mapRoles;\n    }\n}\n</code></pre>\n<p>This is my UserRepository:</p>\n<pre><code>package com.example.application.UserRepository;\n\nimport com.example.application.User.User;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.data.jpa.repository.JpaSpecificationExecutor;\nimport org.springframework.stereotype.Repository;\n\n\n@Repository(value=&quot;users&quot;)\npublic interface UserRepository extends JpaRepository&lt;User, Long&gt;, JpaSpecificationExecutor&lt;User&gt; {\n\n    User findByEmail(String email);\n\n}\n</code></pre>\n<p>This is my User:</p>\n<pre><code>package com.example.application.User;\n\n\nimport com.example.application.Role.Role;\nimport lombok.Getter;\nimport lombok.NoArgsConstructor;\nimport lombok.Setter;\nimport org.hibernate.annotations.Table;\n\nimport javax.persistence.*;\nimport java.util.ArrayList;\nimport java.util.List;\n\n@Getter\n@Table(appliesTo = &quot;users&quot;)\n@Setter\n@NoArgsConstructor\n@Entity\npublic class User {\n    private static final long serialVersionUID = 1L;\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column(nullable = false)\n    private String name;\n\n    @Column(nullable = false, unique = true)\n    private String email;\n\n    @Column(nullable = false)\n    private String password;\n\n    @ManyToMany(fetch = FetchType.EAGER, cascade = CascadeType.ALL)\n    @JoinTable(\n            name = &quot;users_roles&quot;,\n            joinColumns = {@JoinColumn(name = &quot;USERS_ID&quot;, referencedColumnName = &quot;ID&quot;)},\n            inverseJoinColumns = {@JoinColumn(name = &quot;ROLES_ID&quot;, referencedColumnName = &quot;ID&quot;)})\n    private List&lt;Role&gt; roles = new ArrayList&lt;&gt;();\n\n}\n\n</code></pre>\n<p>This is my Role:</p>\n<pre><code>package com.example.application.Role;\n\n\nimport com.example.application.User.User;\nimport lombok.AllArgsConstructor;\nimport lombok.Getter;\nimport lombok.NoArgsConstructor;\nimport lombok.Setter;\nimport org.hibernate.annotations.Table;\n\nimport javax.persistence.*;\nimport java.util.ArrayList;\nimport java.util.List;\n\n@Setter\n@Getter\n@NoArgsConstructor\n@AllArgsConstructor\n@Table(appliesTo = &quot;roles&quot;)\n@Entity\npublic class Role\n{\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column(nullable=false, unique=true)\n    private String name;\n\n    @ManyToMany(mappedBy = &quot;roles&quot;)\n    private List&lt;User&gt; users = new ArrayList&lt;&gt;();\n}\n</code></pre>\n<p>Actually, I have already tried to add lazy annotation in my class but unfortunately it hasn't work.However I have already added permission in application.properties for spring that he can allow circular references in project and this is too hasn't helping me.</p>\n"},{"tags":["java","spring-cloud","spring-cloud-config","spring-cloud-vault-config"],"answers":[{"tags":[],"owner":{"account_id":9651180,"reputation":1,"user_id":7162302,"display_name":"jmc"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681039198,"creation_date":1681039198,"answer_id":75970194,"question_id":74433132,"body_markdown":"I got the same issue and solved loading on VAULT the default properties in the \r\n&quot;application&quot; (licensing-server in your case) path without trailing slash and default profile.\r\nSo on VAULT I have the path &quot;application&quot; for default values and &quot;application/dev&quot; for the dev profile","title":"Spring Cloud Config Vault does not work with the default profile","body":"<p>I got the same issue and solved loading on VAULT the default properties in the\n&quot;application&quot; (licensing-server in your case) path without trailing slash and default profile.\nSo on VAULT I have the path &quot;application&quot; for default values and &quot;application/dev&quot; for the dev profile</p>\n"}],"owner":{"account_id":11732873,"reputation":734,"user_id":8587732,"display_name":"Vitaly Chura"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":343,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":1,"score":1,"last_activity_date":1681039198,"creation_date":1668435672,"question_id":74433132,"body_markdown":"I&#39;m working on an implementation of config-server as per Manning&#39;s book [Spring microservices in action 2e][1] and I encountered a problem that the config server doesn&#39;t read properties from the default profile.\r\n\r\nMy vault path is `secret/licensing-service/default`, I&#39;m able to read the vault config for a default profile via this command\r\n```\r\ncurl -X GET -H &quot;X-Vault-Token:myroot&quot; http://127.0.0.1:8200/v1/secret/data/licensing-service/default | jq\r\n```\r\nHowever when I enable debug logging and issue a request:\r\n```\r\ncurl -X &quot;GET&quot; &quot;http://localhost:8071/licensing-service/default&quot; -H &quot;X-Config-Token: myroot&quot; | jq                    \r\n{\r\n  &quot;name&quot;: &quot;licensing-service&quot;,\r\n  &quot;profiles&quot;: [\r\n    &quot;default&quot;\r\n  ],\r\n  &quot;label&quot;: null,\r\n  &quot;version&quot;: null,\r\n  &quot;state&quot;: null,\r\n  &quot;propertySources&quot;: []\r\n}\r\n```\r\nI see that spring tries to issue the following HTTP requests:\r\n```\r\n2022-11-13 15:41:41.272 DEBUG 92277 --- [nio-8071-exec-9] o.s.web.client.RestTemplate\r\n              : HTTP GET http://127.0.0.1:8200/v1/secret/data/licensing-service\r\n2022-11-13 15:41:42.100 DEBUG 92277 --- [nio-8071-exec-9] o.s.web.client.RestTemplate\r\n              : HTTP GET http://127.0.0.1:8200/v1/secret/data/application\r\n```\r\n\r\nAs can be seen it strips a default keyword from the URL, I found that it does so in the following class - https://github.com/spring-cloud/spring-cloud-config/blob/main/spring-cloud-config-server/src/main/java/org/springframework/cloud/config/server/environment/AbstractVaultEnvironmentRepository.java\r\nIn particular here:\r\n```\r\nprivate List&lt;String&gt; scrubProfiles(String[] profiles) {\r\n\t\tList&lt;String&gt; scrubbedProfiles = new ArrayList&lt;&gt;(Arrays.asList(profiles));\r\n\t\tscrubbedProfiles.remove(&quot;default&quot;);\r\n\t\treturn scrubbedProfiles;\r\n\t}\r\n\r\n```\r\nWhat am I doing wrong and how do I make it read data from the default profile? Everything described above works for dev profile with vault path `secret/licensing-service/dev`\r\nThis is the config of my configuration server:\r\n```\r\nspring:\r\n  application:\r\n    name: config-server\r\n  profiles:\r\n    active: vault\r\n  cloud:\r\n    config:\r\n      server:\r\n        vault:\r\n          port: 8200\r\n          host: 127.0.0.1\r\n          kv-version: 2\r\n          profile-separator: /\r\n\r\n\r\nserver:\r\n  port: 8071\r\n```\r\n  [1]: https://www.manning.com/books/spring-microservices-in-action-second-edition","title":"Spring Cloud Config Vault does not work with the default profile","body":"<p>I'm working on an implementation of config-server as per Manning's book <a href=\"https://www.manning.com/books/spring-microservices-in-action-second-edition\" rel=\"nofollow noreferrer\">Spring microservices in action 2e</a> and I encountered a problem that the config server doesn't read properties from the default profile.</p>\n<p>My vault path is <code>secret/licensing-service/default</code>, I'm able to read the vault config for a default profile via this command</p>\n<pre><code>curl -X GET -H &quot;X-Vault-Token:myroot&quot; http://127.0.0.1:8200/v1/secret/data/licensing-service/default | jq\n</code></pre>\n<p>However when I enable debug logging and issue a request:</p>\n<pre><code>curl -X &quot;GET&quot; &quot;http://localhost:8071/licensing-service/default&quot; -H &quot;X-Config-Token: myroot&quot; | jq                    \n{\n  &quot;name&quot;: &quot;licensing-service&quot;,\n  &quot;profiles&quot;: [\n    &quot;default&quot;\n  ],\n  &quot;label&quot;: null,\n  &quot;version&quot;: null,\n  &quot;state&quot;: null,\n  &quot;propertySources&quot;: []\n}\n</code></pre>\n<p>I see that spring tries to issue the following HTTP requests:</p>\n<pre><code>2022-11-13 15:41:41.272 DEBUG 92277 --- [nio-8071-exec-9] o.s.web.client.RestTemplate\n              : HTTP GET http://127.0.0.1:8200/v1/secret/data/licensing-service\n2022-11-13 15:41:42.100 DEBUG 92277 --- [nio-8071-exec-9] o.s.web.client.RestTemplate\n              : HTTP GET http://127.0.0.1:8200/v1/secret/data/application\n</code></pre>\n<p>As can be seen it strips a default keyword from the URL, I found that it does so in the following class - <a href=\"https://github.com/spring-cloud/spring-cloud-config/blob/main/spring-cloud-config-server/src/main/java/org/springframework/cloud/config/server/environment/AbstractVaultEnvironmentRepository.java\" rel=\"nofollow noreferrer\">https://github.com/spring-cloud/spring-cloud-config/blob/main/spring-cloud-config-server/src/main/java/org/springframework/cloud/config/server/environment/AbstractVaultEnvironmentRepository.java</a>\nIn particular here:</p>\n<pre><code>private List&lt;String&gt; scrubProfiles(String[] profiles) {\n        List&lt;String&gt; scrubbedProfiles = new ArrayList&lt;&gt;(Arrays.asList(profiles));\n        scrubbedProfiles.remove(&quot;default&quot;);\n        return scrubbedProfiles;\n    }\n\n</code></pre>\n<p>What am I doing wrong and how do I make it read data from the default profile? Everything described above works for dev profile with vault path <code>secret/licensing-service/dev</code>\nThis is the config of my configuration server:</p>\n<pre><code>spring:\n  application:\n    name: config-server\n  profiles:\n    active: vault\n  cloud:\n    config:\n      server:\n        vault:\n          port: 8200\n          host: 127.0.0.1\n          kv-version: 2\n          profile-separator: /\n\n\nserver:\n  port: 8071\n</code></pre>\n"},{"tags":["java","spring","authentication","spring-security"],"owner":{"account_id":20804262,"reputation":1,"user_id":15279523,"display_name":"OlalalaO"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":34,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1681038044,"answer_count":0,"score":0,"last_activity_date":1681038901,"creation_date":1680930186,"question_id":75963393,"body_markdown":"The official documentation is as follows:\r\n\r\n```java\r\npublic class MyFilterSecurityMetadataSource implements FilterInvocationSecurityMetadataSource {\r\n\r\n\tpublic List&lt;ConfigAttribute&gt; getAttributes(Object object) {\r\n\t\tFilterInvocation fi = (FilterInvocation) object;\r\n\t\t\tString url = fi.getRequestUrl();\r\n\t\t\tString httpMethod = fi.getRequest().getMethod();\r\n\t\t\tList&lt;ConfigAttribute&gt; attributes = new ArrayList&lt;ConfigAttribute&gt;();\r\n\r\n\t\t\t// Lookup your database (or other source) using this information and populate the\r\n\t\t\t// list of attributes\r\n\r\n\t\t\treturn attributes;\r\n\t}\r\n\r\n\tpublic Collection&lt;ConfigAttribute&gt; getAllConfigAttributes() {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tpublic boolean supports(Class&lt;?&gt; clazz) {\r\n\t\treturn FilterInvocation.class.isAssignableFrom(clazz);\r\n\t}\r\n}\r\n```\r\nI have written the code required for the commented section.\r\n\r\nHow to use MyFilterSecurityMetadataSource? I have no idea about it.\r\n\r\nI have been looking for clues in the official documentation and samples, but found none.","title":"How to dynamically define secured URLs within an application in Spring Security 6.0.2","body":"<p>The official documentation is as follows:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class MyFilterSecurityMetadataSource implements FilterInvocationSecurityMetadataSource {\n\n    public List&lt;ConfigAttribute&gt; getAttributes(Object object) {\n        FilterInvocation fi = (FilterInvocation) object;\n            String url = fi.getRequestUrl();\n            String httpMethod = fi.getRequest().getMethod();\n            List&lt;ConfigAttribute&gt; attributes = new ArrayList&lt;ConfigAttribute&gt;();\n\n            // Lookup your database (or other source) using this information and populate the\n            // list of attributes\n\n            return attributes;\n    }\n\n    public Collection&lt;ConfigAttribute&gt; getAllConfigAttributes() {\n        return null;\n    }\n\n    public boolean supports(Class&lt;?&gt; clazz) {\n        return FilterInvocation.class.isAssignableFrom(clazz);\n    }\n}\n</code></pre>\n<p>I have written the code required for the commented section.</p>\n<p>How to use MyFilterSecurityMetadataSource? I have no idea about it.</p>\n<p>I have been looking for clues in the official documentation and samples, but found none.</p>\n"},{"tags":["java","regex"],"answers":[{"tags":[],"owner":{"account_id":5359864,"reputation":2962,"user_id":4271479,"display_name":"mastov"},"comment_count":0,"down_vote_count":0,"up_vote_count":9,"is_accepted":false,"score":9,"last_activity_date":1461949213,"creation_date":1461949213,"answer_id":36943840,"question_id":36943806,"body_markdown":"Groups aren&#39;t thought to find several matches. They are thought to identify several subparts in a single match, e.g. the expression `&quot;([A-Za-z]*):([A-Za-z]*)&quot;` would match a key-value pair and you could get the key as group 1 and the value as group 2.\r\n\r\nThere is only 1 group (= one brackets pair) in your expression and therefore only the groups 0 (always the whole matched expression, independently of your manually defined groups) and 1 (the single group you defined) are returned.\r\n\r\nIn your case, try calling `find` iteratively, if you want more matches.\r\n\r\n    int i = 0;\r\n    while (matcher.find()) {\r\n        System.out.println(&quot;Match &quot; + i + &quot;: &quot; + matcher.group(1));\r\n        i++;\r\n    }","title":"Get all captured groups in Java","body":"<p>Groups aren't thought to find several matches. They are thought to identify several subparts in a single match, e.g. the expression <code>\"([A-Za-z]*):([A-Za-z]*)\"</code> would match a key-value pair and you could get the key as group 1 and the value as group 2.</p>\n\n<p>There is only 1 group (= one brackets pair) in your expression and therefore only the groups 0 (always the whole matched expression, independently of your manually defined groups) and 1 (the single group you defined) are returned.</p>\n\n<p>In your case, try calling <code>find</code> iteratively, if you want more matches.</p>\n\n<pre><code>int i = 0;\nwhile (matcher.find()) {\n    System.out.println(\"Match \" + i + \": \" + matcher.group(1));\n    i++;\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":6325135,"reputation":24446,"user_id":4911842,"accept_rate":76,"display_name":"developer033"},"score":0,"creation_date":1461954319,"post_id":36943847,"comment_id":61448898,"body_markdown":"Hmm, I got it, my intention was to get the captured groups in reverse, in other words, from the last to the first, do you know a way to do this?","body":"Hmm, I got it, my intention was to get the captured groups in reverse, in other words, from the last to the first, do you know a way to do this?"},{"owner":{"account_id":2268336,"reputation":10952,"user_id":1996394,"accept_rate":80,"display_name":"rock321987"},"score":0,"creation_date":1461954410,"post_id":36943847,"comment_id":61448951,"body_markdown":"@developer033 do you want `sample` and then `[sample]`?","body":"@developer033 do you want <code>sample</code> and then <code>[sample]</code>?"},{"owner":{"account_id":6325135,"reputation":24446,"user_id":4911842,"accept_rate":76,"display_name":"developer033"},"score":0,"creation_date":1461954475,"post_id":36943847,"comment_id":61448984,"body_markdown":"I want `notworking`, `[notworking]`, `sample` and `[sample]`. That&#39;s why I want collect all the captured groups, understand me now?","body":"I want <code>notworking</code>, <code>[notworking]</code>, <code>sample</code> and <code>[sample]</code>. That&#39;s why I want collect all the captured groups, understand me now?"},{"owner":{"account_id":2268336,"reputation":10952,"user_id":1996394,"accept_rate":80,"display_name":"rock321987"},"score":1,"creation_date":1461954532,"post_id":36943847,"comment_id":61449005,"body_markdown":"@developer033 put all the results in an arraylist or array and reverse it..that will be most simple approach","body":"@developer033 put all the results in an arraylist or array and reverse it..that will be most simple approach"},{"owner":{"account_id":2268336,"reputation":10952,"user_id":1996394,"accept_rate":80,"display_name":"rock321987"},"score":0,"creation_date":1461954761,"post_id":36943847,"comment_id":61449098,"body_markdown":"@developer033 by default, regex engine searches from left to right.it will be tricky to match from right to left..the approach of reversing will be most simplest one","body":"@developer033 by default, regex engine searches from left to right.it will be tricky to match from right to left..the approach of reversing will be most simplest one"},{"owner":{"account_id":6325135,"reputation":24446,"user_id":4911842,"accept_rate":76,"display_name":"developer033"},"score":1,"creation_date":1461954869,"post_id":36943847,"comment_id":61449140,"body_markdown":"Yes, I thought about using List before.. Thanks.","body":"Yes, I thought about using List before.. Thanks."},{"owner":{"account_id":3440955,"reputation":943,"user_id":2882939,"display_name":"Tihamer"},"score":0,"creation_date":1644370673,"post_id":36943847,"comment_id":125587633,"body_markdown":"Note that using the &quot;If&quot; (instead of &quot;while) will only work for the first match.","body":"Note that using the &quot;If&quot; (instead of &quot;while) will only work for the first match."}],"tags":[],"owner":{"account_id":2268336,"reputation":10952,"user_id":1996394,"accept_rate":80,"display_name":"rock321987"},"comment_count":7,"down_vote_count":0,"up_vote_count":26,"is_accepted":true,"score":26,"last_activity_date":1461950016,"creation_date":1461949227,"answer_id":36943847,"question_id":36943806,"body_markdown":"JAVA does not offer fancy global option to find all the matches at once. So, you need `while loop` here\r\n\r\n    int i = 0;\r\n    while (matcher.find()) {\r\n       for (int j = 0; j &lt;= matcher.groupCount(); j++) {\r\n          System.out.println(&quot;------------------------------------&quot;);\r\n          System.out.println(&quot;Group &quot; + i + &quot;: &quot; + matcher.group(j));\r\n          i++;\r\n       }\r\n    }\r\n\r\n**[Ideone Demo][1]**\r\n\r\n\r\n  [1]: http://ideone.com/5kKXiA","title":"Get all captured groups in Java","body":"<p>JAVA does not offer fancy global option to find all the matches at once. So, you need <code>while loop</code> here</p>\n\n<pre><code>int i = 0;\nwhile (matcher.find()) {\n   for (int j = 0; j &lt;= matcher.groupCount(); j++) {\n      System.out.println(\"------------------------------------\");\n      System.out.println(\"Group \" + i + \": \" + matcher.group(j));\n      i++;\n   }\n}\n</code></pre>\n\n<p><strong><a href=\"http://ideone.com/5kKXiA\" rel=\"noreferrer\">Ideone Demo</a></strong></p>\n"},{"tags":[],"owner":{"account_id":17318932,"reputation":117,"user_id":12544798,"display_name":"Artjom Prozorov"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1580731116,"creation_date":1580731116,"answer_id":60038818,"question_id":36943806,"body_markdown":"Also if you know the amount of matches you will get, you can find groups and add them to list then just take values from list when needed to assigned them somewhere else \r\n\r\n\r\n\r\n     public static List&lt;String&gt; groupList(String text, Pattern pattern) {\r\n        List&lt;String&gt; list = new ArrayList&lt;&gt;();\r\n        Matcher matcher = pattern.matcher(text);\r\n        while (matcher.find()) {\r\n            for (int i = 1; i &lt;= matcher.groupCount(); i++) {\r\n            list.add(matcher.group(i));\r\n                }\r\n            }\r\n        return list;","title":"Get all captured groups in Java","body":"<p>Also if you know the amount of matches you will get, you can find groups and add them to list then just take values from list when needed to assigned them somewhere else </p>\n\n<pre><code> public static List&lt;String&gt; groupList(String text, Pattern pattern) {\n    List&lt;String&gt; list = new ArrayList&lt;&gt;();\n    Matcher matcher = pattern.matcher(text);\n    while (matcher.find()) {\n        for (int i = 1; i &lt;= matcher.groupCount(); i++) {\n        list.add(matcher.group(i));\n            }\n        }\n    return list;\n</code></pre>\n"},{"tags":[],"owner":{"account_id":11337137,"reputation":838,"user_id":8312604,"display_name":"Alexandr Arhipov"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681037689,"creation_date":1681037689,"answer_id":75970088,"question_id":36943806,"body_markdown":"If you know the exact amount of matching groups, with java 9 or later it could be done like this:\r\n\r\n        String text = &quot;This_is_a_[sample]_text[notworking]&quot;;\r\n\t\tPattern pattern = Pattern.compile(&quot;\\\\[(\\\\w*)\\\\]&quot;);\r\n\t\tList&lt;Pair&lt;String, String&gt;&gt; result = pattern.matcher(text).results()\r\n\t\t\t\t.map(matchResult -&gt; Pair.of(matchResult.group(0), matchResult.group(1)))\r\n\t\t\t\t.toList();\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/7bZX9.png","title":"Get all captured groups in Java","body":"<p>If you know the exact amount of matching groups, with java 9 or later it could be done like this:</p>\n<pre><code>    String text = &quot;This_is_a_[sample]_text[notworking]&quot;;\n    Pattern pattern = Pattern.compile(&quot;\\\\[(\\\\w*)\\\\]&quot;);\n    List&lt;Pair&lt;String, String&gt;&gt; result = pattern.matcher(text).results()\n            .map(matchResult -&gt; Pair.of(matchResult.group(0), matchResult.group(1)))\n            .toList();\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/7bZX9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7bZX9.png\" alt=\"enter image description here\" /></a></p>\n"}],"owner":{"account_id":6325135,"reputation":24446,"user_id":4911842,"accept_rate":76,"display_name":"developer033"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":19144,"favorite_count":0,"down_vote_count":0,"up_vote_count":21,"accepted_answer_id":36943847,"answer_count":4,"score":21,"last_activity_date":1681037689,"creation_date":1461949067,"question_id":36943806,"body_markdown":"I want to match a single word inside brackets(including the brackets), my `Regex` below is working but it&#39;s not returning me all groups.\r\n\r\nHere&#39;s my **code:**\r\n\r\n    String text = &quot;This_is_a_[sample]_text[notworking]&quot;;\r\n    Matcher matcher = Pattern.compile(&quot;\\\\[([a-zA-Z_]+)\\\\]&quot;).matcher(text);                                     \r\n    if (matcher.find()) {\r\n        for (int i = 0; i &lt;= matcher.groupCount(); i++) {\r\n        System.out.println(&quot;------------------------------------&quot;);\r\n        System.out.println(&quot;Group &quot; + i + &quot;: &quot; + matcher.group(i));\r\n    }\r\n\r\nAlso I&#39;ve tested it in [Regex Planet][1] and it seems to work.\r\n\r\nIt must return 4 groups:\r\n\r\n    ------------------------------------\r\n    Group 0: [sample]\r\n    ------------------------------------\r\n    Group 1: sample\r\n    ------------------------------------\r\n    Group 2: [notworking]\r\n    ------------------------------------\r\n    Group 3: notworking\r\n\r\nBut it&#39;s returning just it:\r\n\r\n    ------------------------------------\r\n    Group 0: [sample]\r\n    ------------------------------------\r\n    Group 1: sample\r\n\r\nWhat&#39;s wrong?\r\n\r\n[1]: http://www.regexplanet.com/cookbook/ahJzfnJlZ2V4cGxhbmV0LWhyZHNyDwsSBlJlY2lwZRjqst8hDA/index.html","title":"Get all captured groups in Java","body":"<p>I want to match a single word inside brackets(including the brackets), my <code>Regex</code> below is working but it's not returning me all groups.</p>\n\n<p>Here's my <strong>code:</strong></p>\n\n<pre><code>String text = \"This_is_a_[sample]_text[notworking]\";\nMatcher matcher = Pattern.compile(\"\\\\[([a-zA-Z_]+)\\\\]\").matcher(text);                                     \nif (matcher.find()) {\n    for (int i = 0; i &lt;= matcher.groupCount(); i++) {\n    System.out.println(\"------------------------------------\");\n    System.out.println(\"Group \" + i + \": \" + matcher.group(i));\n}\n</code></pre>\n\n<p>Also I've tested it in <a href=\"http://www.regexplanet.com/cookbook/ahJzfnJlZ2V4cGxhbmV0LWhyZHNyDwsSBlJlY2lwZRjqst8hDA/index.html\" rel=\"noreferrer\">Regex Planet</a> and it seems to work.</p>\n\n<p>It must return 4 groups:</p>\n\n<pre><code>------------------------------------\nGroup 0: [sample]\n------------------------------------\nGroup 1: sample\n------------------------------------\nGroup 2: [notworking]\n------------------------------------\nGroup 3: notworking\n</code></pre>\n\n<p>But it's returning just it:</p>\n\n<pre><code>------------------------------------\nGroup 0: [sample]\n------------------------------------\nGroup 1: sample\n</code></pre>\n\n<p>What's wrong?</p>\n"},{"tags":["java"],"comments":[{"owner":{"account_id":3253096,"reputation":4401,"user_id":2987755,"accept_rate":50,"display_name":"dkb"},"score":0,"creation_date":1681101719,"post_id":69041383,"comment_id":133998808,"body_markdown":"Working example and steps to solve it for your reference: https://stackoverflow.com/a/75970036/2987755","body":"Working example and steps to solve it for your reference: <a href=\"https://stackoverflow.com/a/75970036/2987755\">stackoverflow.com/a/75970036/2987755</a>"}],"answers":[{"comments":[{"owner":{"account_id":455809,"reputation":12993,"user_id":854207,"accept_rate":62,"display_name":"paul"},"score":1,"creation_date":1630656563,"post_id":69041442,"comment_id":122021143,"body_markdown":"Yeah I did that already. But I want to run a unit test using Intellij. But it seems it’s not possible yet","body":"Yeah I did that already. But I want to run a unit test using Intellij. But it seems it’s not possible yet"},{"owner":{"account_id":1010971,"reputation":11524,"user_id":1023553,"accept_rate":59,"display_name":"NoDataFound"},"score":0,"creation_date":1630657257,"post_id":69041442,"comment_id":122021367,"body_markdown":"I don&#39;t use IntelliJ, but the principle behind IntelliJ and Eclipse are no so far: you must configure the JDK for the project to be the one provided by Loom. Setting the correct Java version might also help (Java 18). In Eclipse, it could be done using Build Environment rather than explicit JRE, but you can still enforce a specific JRE while running the test. The same probably apply to IntelliJ and if you use Maven, the toolchains completely does that (you only need to use a property that specialize your JDK, eg: use a version such as 1.8.LOOM in both pom.xml and toolchains.xml).","body":"I don&#39;t use IntelliJ, but the principle behind IntelliJ and Eclipse are no so far: you must configure the JDK for the project to be the one provided by Loom. Setting the correct Java version might also help (Java 18). In Eclipse, it could be done using Build Environment rather than explicit JRE, but you can still enforce a specific JRE while running the test. The same probably apply to IntelliJ and if you use Maven, the toolchains completely does that (you only need to use a property that specialize your JDK, eg: use a version such as 1.8.LOOM in both pom.xml and toolchains.xml)."}],"tags":[],"owner":{"account_id":1010971,"reputation":11524,"user_id":1023553,"accept_rate":59,"display_name":"NoDataFound"},"comment_count":2,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1630656015,"creation_date":1630656015,"answer_id":69041442,"question_id":69041383,"body_markdown":"You have access to tar.gz (for non Windows OS) and ZIP (for Windows OS):\r\n\r\n[![enter image description here][1]][1]\r\n\r\nYou have to download it, extract it and then reference in your IDE a new JRE pointing to the extracted folder. \r\n\r\nNote however that IDE will most likely not recognize any new syntax and you will be better to use a build tool such as Maven or Gradle with [Toolchain](https://maven.apache.org/plugins/maven-toolchains-plugin/plugin-info.html) enabled to select this particular JDK 18.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/n7uHs.png","title":"Project Loom early access IDE","body":"<p>You have access to tar.gz (for non Windows OS) and ZIP (for Windows OS):</p>\n<p><a href=\"https://i.stack.imgur.com/n7uHs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n7uHs.png\" alt=\"enter image description here\" /></a></p>\n<p>You have to download it, extract it and then reference in your IDE a new JRE pointing to the extracted folder.</p>\n<p>Note however that IDE will most likely not recognize any new syntax and you will be better to use a build tool such as Maven or Gradle with <a href=\"https://maven.apache.org/plugins/maven-toolchains-plugin/plugin-info.html\" rel=\"nofollow noreferrer\">Toolchain</a> enabled to select this particular JDK 18.</p>\n"}],"owner":{"account_id":455809,"reputation":12993,"user_id":854207,"accept_rate":62,"display_name":"paul"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":318,"favorite_count":0,"down_vote_count":1,"up_vote_count":3,"answer_count":1,"score":2,"last_activity_date":1681037039,"creation_date":1630655744,"question_id":69041383,"body_markdown":"We have early access of project loom https://jdk.java.net/loom/\r\n\r\nBut I&#39;m not able to find an IDE(Intellij, VSCode) Compatible with this JDK to compile the code inside.\r\n\r\nAnybody knows a way to do it?","title":"Project Loom early access IDE","body":"<p>We have early access of project loom <a href=\"https://jdk.java.net/loom/\" rel=\"nofollow noreferrer\">https://jdk.java.net/loom/</a></p>\n<p>But I'm not able to find an IDE(Intellij, VSCode) Compatible with this JDK to compile the code inside.</p>\n<p>Anybody knows a way to do it?</p>\n"},{"tags":["java","jpa","kotlin","quarkus"],"comments":[{"owner":{"account_id":4211474,"reputation":463,"user_id":3449039,"display_name":"lucsbelt"},"score":0,"creation_date":1586880025,"post_id":61211391,"comment_id":108288505,"body_markdown":"As the error says you can&#39;t have Id annotation twice, if Property has a composite key then you must create a new class for it","body":"As the error says you can&#39;t have Id annotation twice, if Property has a composite key then you must create a new class for it"},{"owner":{"account_id":12203316,"reputation":2298,"user_id":9652640,"display_name":"Min-Soo Pipefeet"},"score":0,"creation_date":1586927308,"post_id":61211391,"comment_id":108305168,"body_markdown":"@lucsbelt But the new class still would have the Id annotation twice. So, how that could be a solution?","body":"@lucsbelt But the new class still would have the Id annotation twice. So, how that could be a solution?"},{"owner":{"account_id":4211474,"reputation":463,"user_id":3449039,"display_name":"lucsbelt"},"score":0,"creation_date":1586943760,"post_id":61211391,"comment_id":108312191,"body_markdown":"You have two alternatives: use an Embeddable (i prefer this one) or use the IdClass annotation check out this examples https://www.objectdb.com/java/jpa/entity/id#Composite_Primary_Key","body":"You have two alternatives: use an Embeddable (i prefer this one) or use the IdClass annotation check out this examples <a href=\"https://www.objectdb.com/java/jpa/entity/id#Composite_Primary_Key\" rel=\"nofollow noreferrer\">objectdb.com/java/jpa/entity/id#Composite_Primary_Key</a>"},{"owner":{"account_id":12203316,"reputation":2298,"user_id":9652640,"display_name":"Min-Soo Pipefeet"},"score":0,"creation_date":1586946956,"post_id":61211391,"comment_id":108313925,"body_markdown":"@lucsbelt None of these alternatives works with Quarkus. See the addition to my question.","body":"@lucsbelt None of these alternatives works with Quarkus. See the addition to my question."},{"owner":{"account_id":2922228,"reputation":61034,"user_id":2504224,"display_name":"geoand"},"score":2,"creation_date":1587731064,"post_id":61211391,"comment_id":108631413,"body_markdown":"This is a missing feature. Can you please open a ticket so we can address it?","body":"This is a missing feature. Can you please open a ticket so we can address it?"},{"owner":{"account_id":235103,"reputation":156444,"user_id":501696,"accept_rate":91,"display_name":"Blackbelt"},"score":0,"creation_date":1632479706,"post_id":61211391,"comment_id":122509659,"body_markdown":"@geoand do you have the link to the ticked?","body":"@geoand do you have the link to the ticked?"},{"owner":{"account_id":2922228,"reputation":61034,"user_id":2504224,"display_name":"geoand"},"score":0,"creation_date":1632485429,"post_id":61211391,"comment_id":122511930,"body_markdown":"I don&#39;t know if a ticket was ever opened for this","body":"I don&#39;t know if a ticket was ever opened for this"},{"owner":{"account_id":12203316,"reputation":2298,"user_id":9652640,"display_name":"Min-Soo Pipefeet"},"score":0,"creation_date":1632512626,"post_id":61211391,"comment_id":122522246,"body_markdown":"@geoand I didn&#39;t open a ticket.","body":"@geoand I didn&#39;t open a ticket."}],"answers":[{"comments":[{"owner":{"account_id":9259591,"reputation":248,"user_id":6877157,"display_name":"nkmuturi"},"score":0,"creation_date":1681034741,"post_id":63698641,"comment_id":133991623,"body_markdown":"This could well be a solution for the Hibernate ORM Panache provider. However, the problem (at least in my case, which is similar to the OP&#39;s) is with the Quarkus Spring Data JPA extension.","body":"This could well be a solution for the Hibernate ORM Panache provider. However, the problem (at least in my case, which is similar to the OP&#39;s) is with the Quarkus Spring Data JPA extension."},{"owner":{"account_id":4540045,"reputation":1159,"user_id":3688170,"display_name":"Salvatore Pannozzo Capodiferro"},"score":0,"creation_date":1681125524,"post_id":63698641,"comment_id":134002017,"body_markdown":"Sure, the solution provided was for the first versions of quarkus where the hibernate extension was still experimental.  At that time it was more stable and well documented using panache","body":"Sure, the solution provided was for the first versions of quarkus where the hibernate extension was still experimental.  At that time it was more stable and well documented using panache"}],"tags":[],"owner":{"account_id":4540045,"reputation":1159,"user_id":3688170,"display_name":"Salvatore Pannozzo Capodiferro"},"comment_count":2,"down_vote_count":0,"up_vote_count":8,"is_accepted":false,"score":8,"last_activity_date":1599020354,"creation_date":1599020354,"answer_id":63698641,"question_id":61211391,"body_markdown":"it is possible, your entity must extend PanacheEntityBase and use class level annotation @Table,@Entity,@IdClass(PK.class), where Pk is a POJO with fields of the composite primary key, then you have to declare the same fields with @Id annotation in your entity. eg:\r\n\r\n    @Entity()\r\n    @Table(name = &quot;agent&quot;)\r\n    @IdClass(AgentPK.class)\r\n    public class AgentBRA extends PanacheEntityBase {\r\n\r\n\t   @Id\r\n\t   public Integer idUsuario;\r\n\t   @Id\r\n\t   public Integer idAgent;\r\n\r\nand AgentPk:\r\n\r\n    public class AgentPK implements Serializable{\r\n\r\n\t   protected Integer idUsuario;\r\n\t\r\n\t   protected Integer idAgent;\r\n       // getters setters and hascode and equals methods\r\n      \r\n\r\n\r\n\r\n\r\n","title":"Are composite primary keys in JPA with Quarkus possible?","body":"<p>it is possible, your entity must extend PanacheEntityBase and use class level annotation @Table,@Entity,@IdClass(PK.class), where Pk is a POJO with fields of the composite primary key, then you have to declare the same fields with @Id annotation in your entity. eg:</p>\n<pre><code>@Entity()\n@Table(name = &quot;agent&quot;)\n@IdClass(AgentPK.class)\npublic class AgentBRA extends PanacheEntityBase {\n\n   @Id\n   public Integer idUsuario;\n   @Id\n   public Integer idAgent;\n</code></pre>\n<p>and AgentPk:</p>\n<pre><code>public class AgentPK implements Serializable{\n\n   protected Integer idUsuario;\n\n   protected Integer idAgent;\n   // getters setters and hascode and equals methods\n  \n</code></pre>\n"},{"tags":[],"owner":{"account_id":17804992,"reputation":307,"user_id":12930883,"display_name":"RED-ONE"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1665652370,"creation_date":1665652370,"answer_id":74053254,"question_id":61211391,"body_markdown":"If you want to use a repository with a composite key, do not use the Id annotation\r\n\r\n\r\n\t\t\t\t@Getter\r\n\t\t\t\t@Setter\r\n\t\t\t\t@NoArgsConstructor\r\n\t\t\t\t@AllArgsConstructor\r\n\t\t\t\t@ToString\r\n\t\t\t\t@Entity\r\n\t\t\t\t@Table(schema = &quot;dbo&quot;, name = &quot;PERSON&quot;)\r\n\t\t\t\tpublic class Person  extends PanacheEntityBase {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t@GeneratedValue(strategy = GenerationType.IDENTITY)\r\n\t\t\t\t\t@Column(name = &quot;ID&quot;, unique = true, nullable = false, insertable = false)\r\n\t\t\t\t\tprivate Integer id;\r\n\t\t\t\t\t\r\n\t\t\t\t\t@EmbeddedId\r\n\t\t\t\t\tprivate PersonId personId;\r\n\t\t\t\t \r\n\t\t\t\t\t@Column(name = &quot;ADDRESS&quot;)\r\n\t\t\t\t\tprivate String address;\r\n\t\t\t\t\t\r\n\t\t\t\t\t@Column(name = &quot;EMAIL&quot;)\r\n\t\t\t\t\tprivate String email;\r\n\t\t\t\t\t\r\n\t\t\t\t\t@Column(name = &quot;PHONE_NUMBER&quot;)\r\n\t\t\t\t\tprivate String phoneNumber;\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t@Getter\r\n\t\t\t\t\t@Setter\r\n\t\t\t\t\t@NoArgsConstructor\r\n\t\t\t\t\t@AllArgsConstructor\r\n\t\t\t\t\t@ToString\r\n\t\t\t\t\t@Embeddable\r\n\t\t\t\t\tpublic static class PersonId implements Serializable {\r\n\r\n\t\t\t\t\t\t@Column(name = &quot;FIRST_NAME&quot;)\r\n\t\t\t\t\t\tprivate String firstName;\r\n\r\n\t\t\t\t\t\t@Column(name = &quot;LAST_NAME&quot;)\r\n\t\t\t\t\t\tprivate String lastName;\r\n\r\n\t\t\t\t\t\t@Column(name = &quot;DATE_OF_BIRTH&quot;)\r\n\t\t\t\t\t\tprivate String dateOfBirth;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\nRepository \r\n\r\n\r\n\t\t\t\tpublic interface PersonRepository extends CrudRepository&lt;Person, Person.PersonId&gt; {\r\n\t\t\t\t}","title":"Are composite primary keys in JPA with Quarkus possible?","body":"<p>If you want to use a repository with a composite key, do not use the Id annotation</p>\n<pre><code>            @Getter\n            @Setter\n            @NoArgsConstructor\n            @AllArgsConstructor\n            @ToString\n            @Entity\n            @Table(schema = &quot;dbo&quot;, name = &quot;PERSON&quot;)\n            public class Person  extends PanacheEntityBase {\n                \n                \n                @GeneratedValue(strategy = GenerationType.IDENTITY)\n                @Column(name = &quot;ID&quot;, unique = true, nullable = false, insertable = false)\n                private Integer id;\n                \n                @EmbeddedId\n                private PersonId personId;\n             \n                @Column(name = &quot;ADDRESS&quot;)\n                private String address;\n                \n                @Column(name = &quot;EMAIL&quot;)\n                private String email;\n                \n                @Column(name = &quot;PHONE_NUMBER&quot;)\n                private String phoneNumber;\n                \n                \n                @Getter\n                @Setter\n                @NoArgsConstructor\n                @AllArgsConstructor\n                @ToString\n                @Embeddable\n                public static class PersonId implements Serializable {\n\n                    @Column(name = &quot;FIRST_NAME&quot;)\n                    private String firstName;\n\n                    @Column(name = &quot;LAST_NAME&quot;)\n                    private String lastName;\n\n                    @Column(name = &quot;DATE_OF_BIRTH&quot;)\n                    private String dateOfBirth;\n\n                }\n            }\n</code></pre>\n<p>Repository</p>\n<pre><code>            public interface PersonRepository extends CrudRepository&lt;Person, Person.PersonId&gt; {\n            }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":9259591,"reputation":248,"user_id":6877157,"display_name":"nkmuturi"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1681037032,"creation_date":1681037032,"answer_id":75970044,"question_id":61211391,"body_markdown":"For Quarkus Spring Data JPA, the solution is to switch from using @IdClass to @Embeddable, which is supported by the extension, contrary to OP&#39;s comment that &quot;Quarkus currently doesn&#39;t allow other annotations than @Id&quot; (that is if OP is using this extension, rather than Panache, which is not quite clear).\r\n\r\nSimply annotate the primary key class with &quot;@Embeddable&quot;:\r\n\r\n    @Embeddable\r\n    public class FooPK implements Serializable {\r\n    \r\n        @Column(name = &quot;fooId&quot;)\r\n        private String fooId;\r\n    \r\n        @Column(name = &quot;barId&quot;)\r\n        private String barId;\r\n        ...\r\n\r\nThen use &quot;@EmbeddedId&quot; in the entity class (replacing the traditional multiple @Id definitions used with @IdClass method):\r\n\r\n    public class Foo implements Serializable {\r\n    \r\n        @EmbeddedId\r\n        protected FooPK id;\r\n        ...","title":"Are composite primary keys in JPA with Quarkus possible?","body":"<p>For Quarkus Spring Data JPA, the solution is to switch from using @IdClass to @Embeddable, which is supported by the extension, contrary to OP's comment that &quot;Quarkus currently doesn't allow other annotations than @Id&quot; (that is if OP is using this extension, rather than Panache, which is not quite clear).</p>\n<p>Simply annotate the primary key class with &quot;@Embeddable&quot;:</p>\n<pre><code>@Embeddable\npublic class FooPK implements Serializable {\n\n    @Column(name = &quot;fooId&quot;)\n    private String fooId;\n\n    @Column(name = &quot;barId&quot;)\n    private String barId;\n    ...\n</code></pre>\n<p>Then use &quot;@EmbeddedId&quot; in the entity class (replacing the traditional multiple @Id definitions used with @IdClass method):</p>\n<pre><code>public class Foo implements Serializable {\n\n    @EmbeddedId\n    protected FooPK id;\n    ...\n</code></pre>\n"}],"owner":{"account_id":12203316,"reputation":2298,"user_id":9652640,"display_name":"Min-Soo Pipefeet"},"comment_count":8,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":4741,"favorite_count":0,"down_vote_count":0,"up_vote_count":10,"answer_count":3,"score":10,"last_activity_date":1681037032,"creation_date":1586878024,"question_id":61211391,"body_markdown":"**How to JPA-declare a composite key with Quarkus?**\r\n\r\nTrying to use multiple `@Id` annotations in an `@Entity` class with Quarkus, results in the error:  \r\n```\r\nCurrently the @Id annotation can only be placed on a single field or method. Offending class is abc.model.Property\r\n   \tat io.quarkus.spring.data.deployment.generate.StockMethodsAdder.getIdAnnotationTargetRec(StockMethodsAdder.java:940)\r\n```\r\n\r\nBut first, after declaring  \r\n```\r\ninterface PropertyRepository : CrudRepository&lt;Property, Pair&lt;String, abc.model.Entity&gt;&gt;\r\n```\r\n\r\nWithout the declaration above, there are no complaints, but no possibility to actively manage instances of `Property`.\r\n\r\n**How to circumvent this error?**\r\n\r\nI&#39;m dealing with two JPA Entities:  \r\n1. the first one named `Entity` (don&#39;t mistake for the annotation)  \r\n2. the second one named `Property`\r\n\r\nAn `Entity` can have 0..n instances of `Property`. The code is as follows:\r\n\r\n```\r\n@Entity\r\ndata class Entity (\r\n        @Id\r\n        @Column(name = &quot;entity_id&quot;, updatable = false)\r\n        var entityId: String? = null,\r\n\r\n        @Column(nullable = true)\r\n        var type: String? = null\r\n) {\r\n    @OneToMany(mappedBy = &quot;entity&quot;)\r\n    var properties: List&lt;Property&gt;? = null\r\n}\r\n```\r\n\r\n```\r\n@Entity\r\ndata class Property (\r\n        @Id\r\n        @Column(name = &quot;type&quot;)\r\n        var type: String? = null,\r\n\r\n        @Id\r\n        @ManyToOne\r\n        @JoinColumn(name = &quot;entity_id&quot;)\r\n        private var entity: abc.model.Entity? = null\r\n) : Serializable\r\n```\r\n\r\n-----\r\n\r\nDeclaring the composite primary key as an `@EmbeddedId` as follows, does not solve the problem, as Quarkus currently doesn&#39;t allow other annotations than `@Id` in this case:\r\n\r\n```\r\n@Entity\r\ndata class Entity (\r\n        @Id\r\n        @Column(name = &quot;entity_id&quot;, updatable = false)\r\n        var entityId: String? = null,\r\n\r\n        @Column(nullable = true)\r\n        var type: String? = null\r\n) {\r\n    @OneToMany(mappedBy = &quot;propertyId.entityId&quot;)\r\n    var properties: List&lt;Property&gt;? = null\r\n}\r\n\r\ninterface PropertyRepository : CrudRepository&lt;Property, PropertyId&gt;\r\n\r\n@Embeddable\r\ndata class PropertyId (\r\n        var type: String? = null,\r\n\r\n        @Column(name = &quot;entity_id&quot;)\r\n        private var entityId: String? = null\r\n) : Serializable\r\n\r\n@Entity\r\ndata class Property (\r\n        @EmbeddedId\r\n        var propertyId: PropertyId? = null,\r\n\r\n        @Column(name = &quot;constant_value&quot;)\r\n        var constantValue: String? = null\r\n)\r\n```\r\n\r\n```\r\njava.lang.IllegalArgumentException: Currently only Entities with the @Id annotation are supported. Offending class is abc.model.Property\r\n\tat io.quarkus.spring.data.deployment.generate.StockMethodsAdder.getIdAnnotationTargetRec(StockMethodsAdder.java:932)\r\n```","title":"Are composite primary keys in JPA with Quarkus possible?","body":"<p><strong>How to JPA-declare a composite key with Quarkus?</strong></p>\n\n<p>Trying to use multiple <code>@Id</code> annotations in an <code>@Entity</code> class with Quarkus, results in the error:  </p>\n\n<pre><code>Currently the @Id annotation can only be placed on a single field or method. Offending class is abc.model.Property\n    at io.quarkus.spring.data.deployment.generate.StockMethodsAdder.getIdAnnotationTargetRec(StockMethodsAdder.java:940)\n</code></pre>\n\n<p>But first, after declaring  </p>\n\n<pre><code>interface PropertyRepository : CrudRepository&lt;Property, Pair&lt;String, abc.model.Entity&gt;&gt;\n</code></pre>\n\n<p>Without the declaration above, there are no complaints, but no possibility to actively manage instances of <code>Property</code>.</p>\n\n<p><strong>How to circumvent this error?</strong></p>\n\n<p>I'm dealing with two JPA Entities:<br>\n1. the first one named <code>Entity</code> (don't mistake for the annotation)<br>\n2. the second one named <code>Property</code></p>\n\n<p>An <code>Entity</code> can have 0..n instances of <code>Property</code>. The code is as follows:</p>\n\n<pre><code>@Entity\ndata class Entity (\n        @Id\n        @Column(name = \"entity_id\", updatable = false)\n        var entityId: String? = null,\n\n        @Column(nullable = true)\n        var type: String? = null\n) {\n    @OneToMany(mappedBy = \"entity\")\n    var properties: List&lt;Property&gt;? = null\n}\n</code></pre>\n\n<pre><code>@Entity\ndata class Property (\n        @Id\n        @Column(name = \"type\")\n        var type: String? = null,\n\n        @Id\n        @ManyToOne\n        @JoinColumn(name = \"entity_id\")\n        private var entity: abc.model.Entity? = null\n) : Serializable\n</code></pre>\n\n<hr>\n\n<p>Declaring the composite primary key as an <code>@EmbeddedId</code> as follows, does not solve the problem, as Quarkus currently doesn't allow other annotations than <code>@Id</code> in this case:</p>\n\n<pre><code>@Entity\ndata class Entity (\n        @Id\n        @Column(name = \"entity_id\", updatable = false)\n        var entityId: String? = null,\n\n        @Column(nullable = true)\n        var type: String? = null\n) {\n    @OneToMany(mappedBy = \"propertyId.entityId\")\n    var properties: List&lt;Property&gt;? = null\n}\n\ninterface PropertyRepository : CrudRepository&lt;Property, PropertyId&gt;\n\n@Embeddable\ndata class PropertyId (\n        var type: String? = null,\n\n        @Column(name = \"entity_id\")\n        private var entityId: String? = null\n) : Serializable\n\n@Entity\ndata class Property (\n        @EmbeddedId\n        var propertyId: PropertyId? = null,\n\n        @Column(name = \"constant_value\")\n        var constantValue: String? = null\n)\n</code></pre>\n\n<pre><code>java.lang.IllegalArgumentException: Currently only Entities with the @Id annotation are supported. Offending class is abc.model.Property\n    at io.quarkus.spring.data.deployment.generate.StockMethodsAdder.getIdAnnotationTargetRec(StockMethodsAdder.java:932)\n</code></pre>\n"},{"tags":["java","spring-boot","rest"],"answers":[{"tags":[],"owner":{"account_id":7980951,"reputation":2013,"user_id":6022333,"accept_rate":100,"display_name":"Matley"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681036328,"creation_date":1681036328,"answer_id":75969996,"question_id":75967519,"body_markdown":"I had to add some mapper in my project:\r\n\r\n```\r\n@Component\r\n@RequiredArgsConstructor\r\npublic class StringToWarehouseSearchSimpleDto implements Converter&lt;String, WarehouseSearchFilterSimpleDto&gt; {\r\n\r\n    private final ObjectMapper objectMapper;\r\n\r\n    @Override\r\n    @SneakyThrows({IOException.class})\r\n    public WarehouseSearchFilterSimpleDto convert(String source) {\r\n        return objectMapper.readValue(source, WarehouseSearchFilterSimpleDto.class);\r\n    }\r\n}\r\n```","title":"Spring GET Rest - Reason: Expected to find an object with property [&#39;id&#39;] in path $ but found &#39;net.minidev.json.JSONArray&#39;","body":"<p>I had to add some mapper in my project:</p>\n<pre><code>@Component\n@RequiredArgsConstructor\npublic class StringToWarehouseSearchSimpleDto implements Converter&lt;String, WarehouseSearchFilterSimpleDto&gt; {\n\n    private final ObjectMapper objectMapper;\n\n    @Override\n    @SneakyThrows({IOException.class})\n    public WarehouseSearchFilterSimpleDto convert(String source) {\n        return objectMapper.readValue(source, WarehouseSearchFilterSimpleDto.class);\n    }\n}\n</code></pre>\n"}],"owner":{"account_id":7980951,"reputation":2013,"user_id":6022333,"accept_rate":100,"display_name":"Matley"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":118,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1681036328,"creation_date":1680985448,"question_id":75967519,"body_markdown":"My controller:\r\n\r\n```\r\n@RequestMapping(value = &quot;/api/rest&quot;)\r\n@RestController\r\n@RequiredArgsConstructor\r\n@Validated\r\npublic class WarehouseController {\r\n....\r\n\r\n\r\n@GetMapping(path = &quot;v2/warehouses/limited&quot;)\r\n public List&lt;WarehouseSimpleListDto&gt; getRestrictedWarehouses(\r\n            @RequestParam(required = false, defaultValue = &quot;{}&quot;) WarehouseSearchFilterSimpleDto filter\r\n    ) {\r\n```\r\n\r\nMy cucumber test:\r\n\r\n```\r\n Given I request GET at endpoint:\r\n    &quot;&quot;&quot;\r\n    /api/rest/v2/warehouses/limited?filter={&quot;shipper_ids&quot;:[333444]}\r\n    &quot;&quot;&quot;\r\n    Then the response status code should be 200\r\n```\r\n\r\nwhere:\r\n\r\n```\r\nimport com.fasterxml.jackson.annotation.JsonProperty;\r\nimport lombok.Data;\r\n\r\nimport java.util.Set;\r\n\r\n@Data\r\npublic class WarehouseSearchFilterSimpleDto {\r\n    @JsonProperty(&quot;shipper_ids&quot;)\r\n    private Set&lt;Long&gt; shipperIds;\r\n    @JsonProperty(&quot;carrier_ids&quot;)\r\n    private Set&lt;Long&gt; carrierIds;\r\n}\r\n\r\n```\r\n\r\n\r\n\r\nWhat is going on? I have very similar endpoint that works! When I change filter dto to the working on (identical!) then its OK. Magic for me\r\n\r\n\r\n\r\nError:\r\n\r\n    . Reason: Expected to find an object with property [&#39;id&#39;] in path $ but found &#39;net.minidev.json.JSONArray&#39;. This is not a json object according to the JsonProvider: &#39;com.jayway.jsonpath.spi.json.JsonSmartJsonProvider&#39;.\r\n    2023-04-08 22:17:50.908  INFO 13016 --- [nio-8080-exec-2] e.t.c.l.CustomRequestLoggingFilter       : F1BE16AC5518488DA1B0FBF90CE1C38B RQ BEGIN [GET /api/rest/v2/warehouses/limited?filter=%7B%22shipper_ids%22:%5B1057128%5D%7D];headers=[user-agent:&quot;cucumber/tests&quot;, host:&quot;localhost:8080&quot;, connection:&quot;Keep-Alive&quot;, accept-encoding:&quot;gzip&quot;]\r\n    2023-04-08 22:17:50.941  INFO 13016 --- [nio-8080-exec-2] e.t.c.l.CustomRequestLoggingFilter       : F1BE16AC5518488DA1B0FBF90CE1C38B RQ END [GET /api/rest/v2/warehouses/limited?filter=%7B%22shipper_ids%22:%5B1057128%5D%7D]\r\n    2023-04-08 22:17:50.958  INFO 13016 --- [           main] p.a.common.integration.ApiStepdefs       :  Cannot extract ID from body &lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;title&gt;HTTP Status 500 – Internal Server Error&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;body {\r\n    font-family:Tahoma,Arial,sans-serif;}\r\n     h1, h2, h3, b {\r\n    color:white;background-color:#525D76;}\r\n     h1 {\r\n    font-size:22px;}\r\n     h2 {\r\n    font-size:16px;}\r\n     h3 {\r\n    font-size:14px;}\r\n     p {\r\n    font-size:12px;}\r\n     a {\r\n    color:black;}\r\n     .line {\r\n    height:1px;background-color:#525D76;border:none;}\r\n    &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 500 – Internal Server Error&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;. Reason: Expected to find an object with property [&#39;id&#39;] in path $ but found &#39;java.lang.String&#39;. This is not a json object according to the JsonProvider: &#39;com.jayway.jsonpath.spi.json.JsonSmartJsonProvider&#39;.\r\n\r\n\r\n\r\n**UPDATE**  mapping in object works ONLY for String fields!\r\n","title":"Spring GET Rest - Reason: Expected to find an object with property [&#39;id&#39;] in path $ but found &#39;net.minidev.json.JSONArray&#39;","body":"<p>My controller:</p>\n<pre><code>@RequestMapping(value = &quot;/api/rest&quot;)\n@RestController\n@RequiredArgsConstructor\n@Validated\npublic class WarehouseController {\n....\n\n\n@GetMapping(path = &quot;v2/warehouses/limited&quot;)\n public List&lt;WarehouseSimpleListDto&gt; getRestrictedWarehouses(\n            @RequestParam(required = false, defaultValue = &quot;{}&quot;) WarehouseSearchFilterSimpleDto filter\n    ) {\n</code></pre>\n<p>My cucumber test:</p>\n<pre><code> Given I request GET at endpoint:\n    &quot;&quot;&quot;\n    /api/rest/v2/warehouses/limited?filter={&quot;shipper_ids&quot;:[333444]}\n    &quot;&quot;&quot;\n    Then the response status code should be 200\n</code></pre>\n<p>where:</p>\n<pre><code>import com.fasterxml.jackson.annotation.JsonProperty;\nimport lombok.Data;\n\nimport java.util.Set;\n\n@Data\npublic class WarehouseSearchFilterSimpleDto {\n    @JsonProperty(&quot;shipper_ids&quot;)\n    private Set&lt;Long&gt; shipperIds;\n    @JsonProperty(&quot;carrier_ids&quot;)\n    private Set&lt;Long&gt; carrierIds;\n}\n\n</code></pre>\n<p>What is going on? I have very similar endpoint that works! When I change filter dto to the working on (identical!) then its OK. Magic for me</p>\n<p>Error:</p>\n<pre><code>. Reason: Expected to find an object with property ['id'] in path $ but found 'net.minidev.json.JSONArray'. This is not a json object according to the JsonProvider: 'com.jayway.jsonpath.spi.json.JsonSmartJsonProvider'.\n2023-04-08 22:17:50.908  INFO 13016 --- [nio-8080-exec-2] e.t.c.l.CustomRequestLoggingFilter       : F1BE16AC5518488DA1B0FBF90CE1C38B RQ BEGIN [GET /api/rest/v2/warehouses/limited?filter=%7B%22shipper_ids%22:%5B1057128%5D%7D];headers=[user-agent:&quot;cucumber/tests&quot;, host:&quot;localhost:8080&quot;, connection:&quot;Keep-Alive&quot;, accept-encoding:&quot;gzip&quot;]\n2023-04-08 22:17:50.941  INFO 13016 --- [nio-8080-exec-2] e.t.c.l.CustomRequestLoggingFilter       : F1BE16AC5518488DA1B0FBF90CE1C38B RQ END [GET /api/rest/v2/warehouses/limited?filter=%7B%22shipper_ids%22:%5B1057128%5D%7D]\n2023-04-08 22:17:50.958  INFO 13016 --- [           main] p.a.common.integration.ApiStepdefs       :  Cannot extract ID from body &lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;title&gt;HTTP Status 500 – Internal Server Error&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;body {\nfont-family:Tahoma,Arial,sans-serif;}\n h1, h2, h3, b {\ncolor:white;background-color:#525D76;}\n h1 {\nfont-size:22px;}\n h2 {\nfont-size:16px;}\n h3 {\nfont-size:14px;}\n p {\nfont-size:12px;}\n a {\ncolor:black;}\n .line {\nheight:1px;background-color:#525D76;border:none;}\n&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 500 – Internal Server Error&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;. Reason: Expected to find an object with property ['id'] in path $ but found 'java.lang.String'. This is not a json object according to the JsonProvider: 'com.jayway.jsonpath.spi.json.JsonSmartJsonProvider'.\n</code></pre>\n<p><strong>UPDATE</strong>  mapping in object works ONLY for String fields!</p>\n"},{"tags":["java","payment-gateway","sap-commerce-cloud","cybersource"],"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1665922888,"post_id":74086138,"comment_id":130807981,"body_markdown":"Please provide enough code so others can better understand or reproduce the problem.","body":"Please provide enough code so others can better understand or reproduce the problem."}],"answers":[{"tags":[],"owner":{"account_id":3834647,"reputation":46,"user_id":3179303,"display_name":"Michael L"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1666377952,"creation_date":1666376762,"answer_id":74157809,"question_id":74086138,"body_markdown":"I would double check field names and order. Those field names look like they are for SCMP. You may need to use the following fields for secure acceptance: bill_to_address_line1, bill_to_address_city, bill_to_address_country, bill_to_email, bill_to_surname.\r\n\r\nI would also make sure the data you are sending is valid for those fields. For example, the country field takes only 2 characters. \r\n\r\n[Secure Acceptance Documentation][1]\r\n\r\n[SCMP Documentation][2]\r\n\r\n\r\n  [1]: https://developer.cybersource.com/library/documentation/dev_guides/Secure_Acceptance_Checkout_API/Secure_Acceptance_Checkout_API.pdf\r\n  [2]: https://developer.cybersource.com/library/documentation/dev_guides/Payer_Authentication_SCMP_API/Payer_Authentication_SCMP_API.pdf","title":"Payment getting declined Cybersource HOP","body":"<p>I would double check field names and order. Those field names look like they are for SCMP. You may need to use the following fields for secure acceptance: bill_to_address_line1, bill_to_address_city, bill_to_address_country, bill_to_email, bill_to_surname.</p>\n<p>I would also make sure the data you are sending is valid for those fields. For example, the country field takes only 2 characters.</p>\n<p><a href=\"https://developer.cybersource.com/library/documentation/dev_guides/Secure_Acceptance_Checkout_API/Secure_Acceptance_Checkout_API.pdf\" rel=\"nofollow noreferrer\">Secure Acceptance Documentation</a></p>\n<p><a href=\"https://developer.cybersource.com/library/documentation/dev_guides/Payer_Authentication_SCMP_API/Payer_Authentication_SCMP_API.pdf\" rel=\"nofollow noreferrer\">SCMP Documentation</a></p>\n"},{"comments":[{"owner":{"account_id":7788702,"reputation":836,"user_id":5892518,"display_name":"Harsh"},"score":1,"creation_date":1681364406,"post_id":75969950,"comment_id":134044948,"body_markdown":"An example or code snippet could help here","body":"An example or code snippet could help here"}],"tags":[],"owner":{"account_id":28256118,"reputation":1,"user_id":21601550,"display_name":"Ahmed"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681035759,"creation_date":1681035759,"answer_id":75969950,"question_id":74086138,"body_markdown":"you should add the above missing data to Signed fields\r\n\r\n&lt;input type=&quot;hidden&quot; name=&quot;signed_field_names&quot; value=&quot;access_key,profile_id,transaction_uuid,signed_field_names,unsigned_field_names,signed_date_time,locale,transaction_type,reference_number,amount,currency&quot;&gt;","title":"Payment getting declined Cybersource HOP","body":"<p>you should add the above missing data to Signed fields</p>\n\n"}],"owner":{"account_id":26638518,"reputation":1,"user_id":20254574,"display_name":"Kim Rose"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":435,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1681035759,"creation_date":1665914397,"question_id":74086138,"body_markdown":"I am able to successfully redirect user to Cybersource payment gateway. But after filling out all the details, I am getting an error &quot;The request data did not pass the required fields check for this application: [bill_address1, bill_city, bill_country, customer_email, customer_lastname]&quot;. This is resolved when I change the Secured Acceptance settings from the Cybersource account and allow the user to enter the billing details. But I want to send this details to Cybersource as user is already entering this details in the website. I added the fields in hidden fields and have also mentioned them in signed_field_names and have used them also in generating the signature. Till I am getting this error. Am I passing this fields in wrong way?\r\n\r\nAlso is there any way to pass custom attributes which I get back in return from Cybersource after payment processing?","title":"Payment getting declined Cybersource HOP","body":"<p>I am able to successfully redirect user to Cybersource payment gateway. But after filling out all the details, I am getting an error &quot;The request data did not pass the required fields check for this application: [bill_address1, bill_city, bill_country, customer_email, customer_lastname]&quot;. This is resolved when I change the Secured Acceptance settings from the Cybersource account and allow the user to enter the billing details. But I want to send this details to Cybersource as user is already entering this details in the website. I added the fields in hidden fields and have also mentioned them in signed_field_names and have used them also in generating the signature. Till I am getting this error. Am I passing this fields in wrong way?</p>\n<p>Also is there any way to pass custom attributes which I get back in return from Cybersource after payment processing?</p>\n"},{"tags":["java","json","jakarta-ee","apache-tomee","java-ee-8"],"answers":[{"comments":[{"owner":{"account_id":1442958,"reputation":1329,"user_id":1362485,"accept_rate":91,"display_name":"ps0604"},"score":0,"creation_date":1681009119,"post_id":75968531,"comment_id":133989552,"body_markdown":"No, the only annotation is at the field name level `@JsonbProperty(&quot;field_name&quot;)`, and nothing at the class level.","body":"No, the only annotation is at the field name level <code>@JsonbProperty(&quot;field_name&quot;)</code>, and nothing at the class level."},{"owner":{"account_id":14738,"reputation":1687,"user_id":30581,"accept_rate":67,"display_name":"Emrah Diril"},"score":0,"creation_date":1681104777,"post_id":75968531,"comment_id":133999044,"body_markdown":"So @JsonProperty is the issue after all, just like I said :D","body":"So @JsonProperty is the issue after all, just like I said :D"}],"tags":[],"owner":{"account_id":14738,"reputation":1687,"user_id":30581,"accept_rate":67,"display_name":"Emrah Diril"},"comment_count":2,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1681008473,"creation_date":1681007787,"answer_id":75968531,"question_id":75954555,"body_markdown":"Is it possible there are annotations on the fields of `inputObj` you are serializing that are overriding the `.withNullValues(true)` setting?\r\n\r\nRef: https://jakarta.ee/specifications/jsonb/3.0/jakarta-jsonb-spec-3.0.html#customizing-null-handling\r\n\r\nI also found this: https://github.com/jakartaee/jsonb-api/issues/169#issuecomment-525387593\r\n\r\nYou didn&#39;t share the class for `inputObj` but it seems to me like the only way this won&#39;t work is if there are annotations on the fields in the class overriding the global setting in `config`.","title":"Jakarta JSON excludes null fields even though withNullValues is set to true","body":"<p>Is it possible there are annotations on the fields of <code>inputObj</code> you are serializing that are overriding the <code>.withNullValues(true)</code> setting?</p>\n<p>Ref: <a href=\"https://jakarta.ee/specifications/jsonb/3.0/jakarta-jsonb-spec-3.0.html#customizing-null-handling\" rel=\"nofollow noreferrer\">https://jakarta.ee/specifications/jsonb/3.0/jakarta-jsonb-spec-3.0.html#customizing-null-handling</a></p>\n<p>I also found this: <a href=\"https://github.com/jakartaee/jsonb-api/issues/169#issuecomment-525387593\" rel=\"nofollow noreferrer\">https://github.com/jakartaee/jsonb-api/issues/169#issuecomment-525387593</a></p>\n<p>You didn't share the class for <code>inputObj</code> but it seems to me like the only way this won't work is if there are annotations on the fields in the class overriding the global setting in <code>config</code>.</p>\n"},{"comments":[{"owner":{"account_id":1442958,"reputation":1329,"user_id":1362485,"accept_rate":91,"display_name":"ps0604"},"score":0,"creation_date":1681016784,"post_id":75968660,"comment_id":133989988,"body_markdown":"Sorry, I have getter and setter, still the field is not in the resulting json when the value is null","body":"Sorry, I have getter and setter, still the field is not in the resulting json when the value is null"},{"owner":{"account_id":20261619,"reputation":727,"user_id":14859847,"display_name":"Junhyunny"},"score":1,"creation_date":1681017713,"post_id":75968660,"comment_id":133990043,"body_markdown":"Can you show us more details? How does Input class implement and what are values set up in object?","body":"Can you show us more details? How does Input class implement and what are values set up in object?"},{"owner":{"account_id":6440480,"reputation":19239,"user_id":4990642,"accept_rate":53,"display_name":"Soner from The Ottoman Empire"},"score":1,"creation_date":1681033269,"post_id":75968660,"comment_id":133991486,"body_markdown":"it has nothing to do with getter etc. at all.","body":"it has nothing to do with getter etc. at all."}],"tags":[],"owner":{"account_id":20261619,"reputation":727,"user_id":14859847,"display_name":"Junhyunny"},"comment_count":3,"down_vote_count":1,"up_vote_count":2,"is_accepted":false,"score":1,"last_activity_date":1681011419,"creation_date":1681011419,"answer_id":75968660,"question_id":75954555,"body_markdown":"I don&#39;t know your full code, so this is my guess. If you don&#39;t declare `getter` method for properties in class, `Json-B` skips to serialize fields. Here is my example. \r\n\r\n#### Without Getter\r\n\r\n```java\r\npackage action.in.blog;\r\n\r\nimport jakarta.json.bind.Jsonb;\r\nimport jakarta.json.bind.JsonbBuilder;\r\nimport jakarta.json.bind.JsonbConfig;\r\nimport org.junit.jupiter.api.Test;\r\n\r\npublic class JsonbTest {\r\n\r\n    @Test\r\n    void test() throws Exception {\r\n        JsonbConfig config = new JsonbConfig().withNullValues(true);\r\n\r\n        Input inputObj = new Input();\r\n\r\n        try (Jsonb jsonb = JsonbBuilder.create(config)) {\r\n            System.out.println(jsonb.toJson(inputObj));\r\n        }\r\n    }\r\n\r\n    public static class Input {\r\n        private String value;\r\n    }\r\n}\r\n```\r\n\r\n#### Result when without getter\r\n\r\n```\r\n{}\r\n```\r\n\r\n#### With Getter\r\n\r\n```java\r\npackage action.in.blog;\r\n\r\nimport jakarta.json.bind.Jsonb;\r\nimport jakarta.json.bind.JsonbBuilder;\r\nimport jakarta.json.bind.JsonbConfig;\r\nimport org.junit.jupiter.api.Test;\r\n\r\npublic class JsonbTest {\r\n\r\n    @Test\r\n    void test() throws Exception {\r\n        JsonbConfig config = new JsonbConfig().withNullValues(true);\r\n\r\n        Input inputObj = new Input();\r\n\r\n        try (Jsonb jsonb = JsonbBuilder.create(config)) {\r\n            System.out.println(jsonb.toJson(inputObj));\r\n        }\r\n    }\r\n\r\n    public static class Input {\r\n        private String value;\r\n\r\n        public String getValue() {\r\n            return value;\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n#### Result when with getter\r\n\r\n```\r\n{&quot;value&quot;:null}\r\n```\r\n\r\n#### With public keyword\r\n\r\nIf you don&#39;t use getter method for fields, fields should be public. \r\n\r\n```java\r\npackage action.in.blog;\r\n\r\nimport jakarta.json.bind.Jsonb;\r\nimport jakarta.json.bind.JsonbBuilder;\r\nimport jakarta.json.bind.JsonbConfig;\r\nimport org.junit.jupiter.api.Test;\r\n\r\npublic class JsonbTest {\r\n\r\n    @Test\r\n    void test() throws Exception {\r\n        JsonbConfig config = new JsonbConfig().withNullValues(true);\r\n\r\n        Input inputObj = new Input();\r\n\r\n        try (Jsonb jsonb = JsonbBuilder.create(config)) {\r\n            System.out.println(jsonb.toJson(inputObj));\r\n        }\r\n    }\r\n\r\n    public static class Input {\r\n        public String value;\r\n    }\r\n}\r\n```\r\n\r\n#### Result when with public \r\n\r\n```\r\n{&quot;value&quot;:null}\r\n```\r\n\r\nI hope this is helpful for you. \r\n","title":"Jakarta JSON excludes null fields even though withNullValues is set to true","body":"<p>I don't know your full code, so this is my guess. If you don't declare <code>getter</code> method for properties in class, <code>Json-B</code> skips to serialize fields. Here is my example.</p>\n<h4>Without Getter</h4>\n<pre class=\"lang-java prettyprint-override\"><code>package action.in.blog;\n\nimport jakarta.json.bind.Jsonb;\nimport jakarta.json.bind.JsonbBuilder;\nimport jakarta.json.bind.JsonbConfig;\nimport org.junit.jupiter.api.Test;\n\npublic class JsonbTest {\n\n    @Test\n    void test() throws Exception {\n        JsonbConfig config = new JsonbConfig().withNullValues(true);\n\n        Input inputObj = new Input();\n\n        try (Jsonb jsonb = JsonbBuilder.create(config)) {\n            System.out.println(jsonb.toJson(inputObj));\n        }\n    }\n\n    public static class Input {\n        private String value;\n    }\n}\n</code></pre>\n<h4>Result when without getter</h4>\n<pre><code>{}\n</code></pre>\n<h4>With Getter</h4>\n<pre class=\"lang-java prettyprint-override\"><code>package action.in.blog;\n\nimport jakarta.json.bind.Jsonb;\nimport jakarta.json.bind.JsonbBuilder;\nimport jakarta.json.bind.JsonbConfig;\nimport org.junit.jupiter.api.Test;\n\npublic class JsonbTest {\n\n    @Test\n    void test() throws Exception {\n        JsonbConfig config = new JsonbConfig().withNullValues(true);\n\n        Input inputObj = new Input();\n\n        try (Jsonb jsonb = JsonbBuilder.create(config)) {\n            System.out.println(jsonb.toJson(inputObj));\n        }\n    }\n\n    public static class Input {\n        private String value;\n\n        public String getValue() {\n            return value;\n        }\n    }\n}\n</code></pre>\n<h4>Result when with getter</h4>\n<pre><code>{&quot;value&quot;:null}\n</code></pre>\n<h4>With public keyword</h4>\n<p>If you don't use getter method for fields, fields should be public.</p>\n<pre class=\"lang-java prettyprint-override\"><code>package action.in.blog;\n\nimport jakarta.json.bind.Jsonb;\nimport jakarta.json.bind.JsonbBuilder;\nimport jakarta.json.bind.JsonbConfig;\nimport org.junit.jupiter.api.Test;\n\npublic class JsonbTest {\n\n    @Test\n    void test() throws Exception {\n        JsonbConfig config = new JsonbConfig().withNullValues(true);\n\n        Input inputObj = new Input();\n\n        try (Jsonb jsonb = JsonbBuilder.create(config)) {\n            System.out.println(jsonb.toJson(inputObj));\n        }\n    }\n\n    public static class Input {\n        public String value;\n    }\n}\n</code></pre>\n<h4>Result when with public</h4>\n<pre><code>{&quot;value&quot;:null}\n</code></pre>\n<p>I hope this is helpful for you.</p>\n"},{"tags":[],"owner":{"account_id":6440480,"reputation":19239,"user_id":4990642,"accept_rate":53,"display_name":"Soner from The Ottoman Empire"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1681035053,"creation_date":1681033800,"answer_id":75969800,"question_id":75954555,"body_markdown":"tl;dr; solved.\r\n----------------\r\n\r\n----------\r\n\r\nAfter I had read from your following comment, I solved your issue.\r\n\r\n&gt; No, the only annotation is at the field name level\r\n&gt; @JsonbProperty(&quot;field_name&quot;), and nothing at the class level.\r\n\r\nThe annotation&#39;s default `nillable` value is `false` . To accomplish your request you need to make it `true` as following.\r\n\r\n    @JsonbProperty(value = &quot;test&quot;, nillable = true)\r\n    public String your_field_name;\r\n\r\nIt yields something like `{... your other json fields, &quot;test&quot;:null}`\r\n\r\n----------\r\n\r\n\r\nTo begin, I have never used before this post JSON-B API. For you, I have installed it and its dependencies via [its official webpage][1].\r\n\r\nI have started a simple console app and created `pom.xml` to leverage its Maven dependencies as written on the webpage.\r\n\r\n*I think your problem is as to the versions either that of its dependencies or directly its own version.*\r\n\r\n**Don&#39;t forget to *reload project* after changing any settings related to Maven.**\r\n\r\nWhat my `pom.xml` includes is \r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n    &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\r\n             xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\r\n             xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\r\n        &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\r\n    \r\n        &lt;groupId&gt;groupId&lt;/groupId&gt;\r\n        &lt;artifactId&gt;RefUrself&lt;/artifactId&gt;\r\n        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\r\n    \r\n        &lt;properties&gt;\r\n            &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\r\n            &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\r\n            &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\r\n        &lt;/properties&gt;\r\n    \r\n         &lt;!-- ** The rest is for JSON-B API ** --&gt;\r\n\r\n        &lt;repositories&gt;\r\n            &lt;!-- Needed for JSON-B API --&gt;\r\n            &lt;repository&gt;\r\n                &lt;id&gt;java.net-Public&lt;/id&gt;\r\n                &lt;name&gt;Maven Java Net Snapshots and Releases&lt;/name&gt;\r\n                &lt;url&gt;https://maven.java.net/content/groups/public/&lt;/url&gt;\r\n            &lt;/repository&gt;\r\n        &lt;/repositories&gt;\r\n    \r\n        &lt;dependencies&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;javax.json.bind&lt;/groupId&gt;\r\n                &lt;artifactId&gt;javax.json.bind-api&lt;/artifactId&gt;\r\n                &lt;version&gt;1.0&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n    \r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.eclipse&lt;/groupId&gt;\r\n                &lt;artifactId&gt;yasson&lt;/artifactId&gt;\r\n                &lt;version&gt;1.0&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n    \r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.glassfish&lt;/groupId&gt;\r\n                &lt;artifactId&gt;javax.json&lt;/artifactId&gt;\r\n                &lt;version&gt;1.1&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n        &lt;/dependencies&gt;\r\n        \r\n    &lt;/project&gt;\r\n\r\nAnd, when I run its official example which is `Dog` class in which I changed name of the dog to `null`, it works like a charm.\r\n\r\n`Dog` class\r\n\r\n    public class Dog {\r\n        public String name;\r\n        public int age;\r\n        public boolean bitable;\r\n    }\r\n\r\nThe `Test` class in which the program begins to run\r\n\r\n    import javax.json.bind.Jsonb;\r\n    import javax.json.bind.JsonbBuilder;\r\n    import javax.json.bind.JsonbConfig;\r\n    \r\n    public class Test {\r\n        // Create a dog instance\r\n        public static void main(String[] args) {\r\n            Dog dog = new Dog();\r\n            dog.name = null; // --&gt; null as you see\r\n            dog.age = 4;\r\n            dog.bitable = false;\r\n    \r\n            JsonbConfig config = new JsonbConfig().withNullValues(true);\r\n            // Create Jsonb and serialize\r\n            try (Jsonb jsonb = JsonbBuilder.create(config)) {\r\n                String result = jsonb.toJson(dog);\r\n                System.out.println(result);\r\n                //{&quot;age&quot;:4,&quot;bitable&quot;:false,&quot;name&quot;:null}\r\n            } catch (Exception e) {\r\n                throw new RuntimeException(e);\r\n            }\r\n        }\r\n    }\r\n\r\n[![enter image description here][2]][2]\r\n\r\n\r\n  [1]: https://javaee.github.io/jsonb-spec/getting-started.html\r\n  [2]: https://i.stack.imgur.com/0ck68.png","title":"Jakarta JSON excludes null fields even though withNullValues is set to true","body":"<h2>tl;dr; solved.</h2>\n<hr />\n<p>After I had read from your following comment, I solved your issue.</p>\n<blockquote>\n<p>No, the only annotation is at the field name level\n@JsonbProperty(&quot;field_name&quot;), and nothing at the class level.</p>\n</blockquote>\n<p>The annotation's default <code>nillable</code> value is <code>false</code> . To accomplish your request you need to make it <code>true</code> as following.</p>\n<pre><code>@JsonbProperty(value = &quot;test&quot;, nillable = true)\npublic String your_field_name;\n</code></pre>\n<p>It yields something like <code>{... your other json fields, &quot;test&quot;:null}</code></p>\n<hr />\n<p>To begin, I have never used before this post JSON-B API. For you, I have installed it and its dependencies via <a href=\"https://javaee.github.io/jsonb-spec/getting-started.html\" rel=\"nofollow noreferrer\">its official webpage</a>.</p>\n<p>I have started a simple console app and created <code>pom.xml</code> to leverage its Maven dependencies as written on the webpage.</p>\n<p><em>I think your problem is as to the versions either that of its dependencies or directly its own version.</em></p>\n<p><strong>Don't forget to <em>reload project</em> after changing any settings related to Maven.</strong></p>\n<p>What my <code>pom.xml</code> includes is</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;groupId&lt;/groupId&gt;\n    &lt;artifactId&gt;RefUrself&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;/properties&gt;\n\n     &lt;!-- ** The rest is for JSON-B API ** --&gt;\n\n    &lt;repositories&gt;\n        &lt;!-- Needed for JSON-B API --&gt;\n        &lt;repository&gt;\n            &lt;id&gt;java.net-Public&lt;/id&gt;\n            &lt;name&gt;Maven Java Net Snapshots and Releases&lt;/name&gt;\n            &lt;url&gt;https://maven.java.net/content/groups/public/&lt;/url&gt;\n        &lt;/repository&gt;\n    &lt;/repositories&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.json.bind&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.json.bind-api&lt;/artifactId&gt;\n            &lt;version&gt;1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.eclipse&lt;/groupId&gt;\n            &lt;artifactId&gt;yasson&lt;/artifactId&gt;\n            &lt;version&gt;1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.glassfish&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.json&lt;/artifactId&gt;\n            &lt;version&gt;1.1&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n    \n&lt;/project&gt;\n</code></pre>\n<p>And, when I run its official example which is <code>Dog</code> class in which I changed name of the dog to <code>null</code>, it works like a charm.</p>\n<p><code>Dog</code> class</p>\n<pre><code>public class Dog {\n    public String name;\n    public int age;\n    public boolean bitable;\n}\n</code></pre>\n<p>The <code>Test</code> class in which the program begins to run</p>\n<pre><code>import javax.json.bind.Jsonb;\nimport javax.json.bind.JsonbBuilder;\nimport javax.json.bind.JsonbConfig;\n\npublic class Test {\n    // Create a dog instance\n    public static void main(String[] args) {\n        Dog dog = new Dog();\n        dog.name = null; // --&gt; null as you see\n        dog.age = 4;\n        dog.bitable = false;\n\n        JsonbConfig config = new JsonbConfig().withNullValues(true);\n        // Create Jsonb and serialize\n        try (Jsonb jsonb = JsonbBuilder.create(config)) {\n            String result = jsonb.toJson(dog);\n            System.out.println(result);\n            //{&quot;age&quot;:4,&quot;bitable&quot;:false,&quot;name&quot;:null}\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n    }\n}\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/0ck68.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0ck68.png\" alt=\"enter image description here\" /></a></p>\n"}],"owner":{"account_id":1442958,"reputation":1329,"user_id":1362485,"accept_rate":91,"display_name":"ps0604"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":574,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":75969800,"answer_count":3,"score":0,"last_activity_date":1681035053,"creation_date":1680825432,"question_id":75954555,"body_markdown":"I have this code that runs on Tomee with Jakarta EE 9.1, it is supposed to generate a JSON string taking the data from `inputObj`. Problem is that there are fields with null values that are omitted from the resulting JSON even though `withNullValues` is set to true. Any ideas what could be wrong?\r\n\r\n```java\r\nJsonbConfig config = new JsonbConfig().withNullValues(true);\r\n                    \r\nString json;\r\ntry (Jsonb jsonb = JsonbBuilder.create(config)) {\r\n    json = jsonb.toJson(inputObj);\r\n}\r\n```\r\n","title":"Jakarta JSON excludes null fields even though withNullValues is set to true","body":"<p>I have this code that runs on Tomee with Jakarta EE 9.1, it is supposed to generate a JSON string taking the data from <code>inputObj</code>. Problem is that there are fields with null values that are omitted from the resulting JSON even though <code>withNullValues</code> is set to true. Any ideas what could be wrong?</p>\n<pre class=\"lang-java prettyprint-override\"><code>JsonbConfig config = new JsonbConfig().withNullValues(true);\n                    \nString json;\ntry (Jsonb jsonb = JsonbBuilder.create(config)) {\n    json = jsonb.toJson(inputObj);\n}\n</code></pre>\n"},{"tags":["java","arrays"],"comments":[{"owner":{"account_id":1485367,"reputation":122993,"user_id":1393766,"display_name":"Pshemo"},"score":2,"creation_date":1680901855,"post_id":75961930,"comment_id":133978896,"body_markdown":"Do you know how to swap content of two variables? Lets say you have `String a = &quot;foo&quot;; String b = &quot;bar&quot;;`, how would you swap their content?","body":"Do you know how to swap content of two variables? Lets say you have <code>String a = &quot;foo&quot;; String b = &quot;bar&quot;;</code>, how would you swap their content?"}],"answers":[{"comments":[{"owner":{"account_id":13170666,"reputation":78679,"user_id":9513184,"display_name":"Unmitigated"},"score":0,"creation_date":1680906548,"post_id":75961952,"comment_id":133979530,"body_markdown":"@user16320675 Good point. Updated.","body":"@user16320675 Good point. Updated."},{"owner":{"account_id":1689973,"reputation":37330,"user_id":1552534,"display_name":"WJS"},"score":0,"creation_date":1680906937,"post_id":75961952,"comment_id":133979581,"body_markdown":"Wouldn&#39;t it be better to do `i &lt; array.length-1`.  Not certain if it compiles differently or not.  The results are the same.","body":"Wouldn&#39;t it be better to do <code>i &lt; array.length-1</code>.  Not certain if it compiles differently or not.  The results are the same."}],"tags":[],"owner":{"account_id":13170666,"reputation":78679,"user_id":9513184,"display_name":"Unmitigated"},"comment_count":2,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1680906540,"creation_date":1680901673,"answer_id":75961952,"question_id":75961930,"body_markdown":"You can iterate over every pair of adjacent elements (by incrementing the index by 2 each time), then swap them.\r\n\r\n```java\r\nfor (int i = 0; i + 1 &lt; array.length; i += 2) {\r\n\tvar temp = array[i];\r\n\tarray[i] = array[i + 1];\r\n\tarray[i + 1] = temp;\r\n}\r\n```\r\n\r\nAlternatively:\r\n\r\n```java\r\nfor (int i = 0; i &lt; array.length / 2; i++) {\r\n\tvar temp = array[2 * i];\r\n\tarray[2 * i] = array[2 * i + 1];\r\n\tarray[2 * i + 1] = temp;\r\n}\r\n```","title":"How do I create a string array with switched pairs?","body":"<p>You can iterate over every pair of adjacent elements (by incrementing the index by 2 each time), then swap them.</p>\n<pre class=\"lang-java prettyprint-override\"><code>for (int i = 0; i + 1 &lt; array.length; i += 2) {\n    var temp = array[i];\n    array[i] = array[i + 1];\n    array[i + 1] = temp;\n}\n</code></pre>\n<p>Alternatively:</p>\n<pre class=\"lang-java prettyprint-override\"><code>for (int i = 0; i &lt; array.length / 2; i++) {\n    var temp = array[2 * i];\n    array[2 * i] = array[2 * i + 1];\n    array[2 * i + 1] = temp;\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":23090314,"reputation":385,"user_id":20607467,"display_name":"ﾓｷｬﾃﾞ"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1680903032,"creation_date":1680903032,"answer_id":75962078,"question_id":75961930,"body_markdown":"You can use Stream to achieve that.\r\n\r\n    String[] switched1 = IntStream.range(0, array.length / 2)\r\n        .flatMap(i -&gt; IntStream.of(i * 2 + 1, i * 2))\r\n        .mapToObj(i -&gt; array[i])\r\n        .toArray(String[]::new);\r\n\r\nor\r\n\r\n    String[] switched2 = IntStream.range(0, array.length / 2)\r\n        .mapToObj(i -&gt; 2 * i)\r\n        .flatMap(i -&gt; Stream.of(array[i + 1], array[i]))\r\n        .toArray(String[]::new);\r\n","title":"How do I create a string array with switched pairs?","body":"<p>You can use Stream to achieve that.</p>\n<pre><code>String[] switched1 = IntStream.range(0, array.length / 2)\n    .flatMap(i -&gt; IntStream.of(i * 2 + 1, i * 2))\n    .mapToObj(i -&gt; array[i])\n    .toArray(String[]::new);\n</code></pre>\n<p>or</p>\n<pre><code>String[] switched2 = IntStream.range(0, array.length / 2)\n    .mapToObj(i -&gt; 2 * i)\n    .flatMap(i -&gt; Stream.of(array[i + 1], array[i]))\n    .toArray(String[]::new);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1689973,"reputation":37330,"user_id":1552534,"display_name":"WJS"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1680905741,"creation_date":1680905741,"answer_id":75962306,"question_id":75961930,"body_markdown":"Here is how I would do it. This has the advantage that if there are an odd number of values, it won&#39;t throw an exception.  As the loop iterates, it simply swaps adjacent values.\r\n```\r\nString [] array = {&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;,&quot;G&quot;,&quot;H&quot;,&quot;I&quot;,&quot;J&quot;};\r\nfor (int i = 1; i &lt; array.length; i+=2) {\r\n    String save = array[i-1];\r\n    array[i-1] = array[i];\r\n    array[i] = save;\r\n}\r\nSystem.out.println(Arrays.toString(array));\r\n```\r\nprints\r\n```\r\n[B, A, D, C, F, E, H, G, J, I]","title":"How do I create a string array with switched pairs?","body":"<p>Here is how I would do it. This has the advantage that if there are an odd number of values, it won't throw an exception.  As the loop iterates, it simply swaps adjacent values.</p>\n<pre><code>String [] array = {&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;,&quot;G&quot;,&quot;H&quot;,&quot;I&quot;,&quot;J&quot;};\nfor (int i = 1; i &lt; array.length; i+=2) {\n    String save = array[i-1];\n    array[i-1] = array[i];\n    array[i] = save;\n}\nSystem.out.println(Arrays.toString(array));\n</code></pre>\n<p>prints</p>\n<pre><code>[B, A, D, C, F, E, H, G, J, I]\n</code></pre>\n"},{"tags":[],"owner":{"account_id":28210811,"reputation":1,"user_id":21563114,"display_name":"Shirish Gund"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681034953,"creation_date":1681034953,"answer_id":75969890,"question_id":75961930,"body_markdown":"To switch between pairs you can traverse a string and swap adjacent characters and then move to the next of next characters (basically skip the immediate char) and make sure that while performing [i+1] make sure that index doesn&#39;t get out of bound\r\n\r\nhere I&#39;m providing Java code for it  :)\r\n\r\n\r\n```\r\n    String [] array = {&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;,&quot;G&quot;,&quot;H&quot;,&quot;I&quot;,&quot;J&quot;};\r\n\r\n    for (int i=0; i&lt; array.length-1; i+=2) {\r\n        String temp=array[i];  //store the current string in temp variable\r\n        array[i]=array[i+1];\r\n        array[i+1]=temp;\r\n    }\r\n\r\n```","title":"How do I create a string array with switched pairs?","body":"<p>To switch between pairs you can traverse a string and swap adjacent characters and then move to the next of next characters (basically skip the immediate char) and make sure that while performing [i+1] make sure that index doesn't get out of bound</p>\n<p>here I'm providing Java code for it  :)</p>\n<pre><code>    String [] array = {&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;,&quot;G&quot;,&quot;H&quot;,&quot;I&quot;,&quot;J&quot;};\n\n    for (int i=0; i&lt; array.length-1; i+=2) {\n        String temp=array[i];  //store the current string in temp variable\n        array[i]=array[i+1];\n        array[i+1]=temp;\n    }\n\n</code></pre>\n"}],"owner":{"account_id":28244698,"reputation":1,"user_id":21591939,"display_name":"Don"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":67,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":4,"score":0,"last_activity_date":1681034953,"creation_date":1680901526,"question_id":75961930,"body_markdown":"How do I switch pairs? for ex i have String [] array = {A,B,C,D,E,F,G,H,I,J}; and I&#39;m trying to pair and switch their orders like this array {B,A,D,C,F,E,H,G,J,I};\r\n\r\n","title":"How do I create a string array with switched pairs?","body":"<p>How do I switch pairs? for ex i have String [] array = {A,B,C,D,E,F,G,H,I,J}; and I'm trying to pair and switch their orders like this array {B,A,D,C,F,E,H,G,J,I};</p>\n"},{"tags":["java","rest","spring-data-jpa","many-to-many","composite-primary-key"],"comments":[{"owner":{"account_id":10941198,"reputation":4394,"user_id":8041003,"display_name":"John Williams"},"score":0,"creation_date":1679815250,"post_id":75845864,"comment_id":133785711,"body_markdown":"This sort of error is often because of a cycle in a hierarchy, eg mother - daughter - mother. Narrow down your search by setting a local variable for the result of findStats before passing to buildProfileStat - buildProfileStat(findStats(profileDTO.getLanguages()), profile))","body":"This sort of error is often because of a cycle in a hierarchy, eg mother - daughter - mother. Narrow down your search by setting a local variable for the result of findStats before passing to buildProfileStat - buildProfileStat(findStats(profileDTO.getLanguages()), profile))"},{"owner":{"account_id":14618034,"reputation":197,"user_id":10707177,"display_name":"Alfredo Marin"},"score":0,"creation_date":1679869845,"post_id":75845864,"comment_id":133793674,"body_markdown":"Yeah, the problem is when it tries to populate the ```new ProfileStat(stat, profile, false)```, it gets into a loop since the &quot;profile&quot; that it needs it&#39;s the same profile that is receiving the ProfileStat object. The problem is, what can I do to work around this issue? Like, how can we save this type of entity?","body":"Yeah, the problem is when it tries to populate the <code>new ProfileStat(stat, profile, false)</code>, it gets into a loop since the &quot;profile&quot; that it needs it&#39;s the same profile that is receiving the ProfileStat object. The problem is, what can I do to work around this issue? Like, how can we save this type of entity?"}],"answers":[{"tags":[],"owner":{"account_id":14618034,"reputation":197,"user_id":10707177,"display_name":"Alfredo Marin"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1681034516,"creation_date":1681033306,"answer_id":75969758,"question_id":75845864,"body_markdown":"I solved this using [this][1]. I built a [Github repository][2] with a simple example.\r\n\r\nMy method that populates the object saves it but with a different structure:\r\n\r\n    private Set&lt;ProfileStat&gt; buildProfileStat(Collection&lt;Stat&gt; stats, Profile profile) {\r\n        Set&lt;ProfileStat&gt; profileStats = new HashSet&lt;&gt;();\r\n        for(Stat stat : stats) {\r\n            ProfileStatId profileStatId = new ProfileStatId(stat.getId(), profile.getId());\r\n            ProfileStat profileStat = new ProfileStat(profileStatId, fals e);\r\n            profileStat.setProfile(profile);\r\n            profileStat.setStat(stat);\r\n            profileStats.add(profileStatService.save(profileStat));\r\n        }\r\n        return profileStats;\r\n    }\r\n\r\n    private Set&lt;ProfileInterest&gt; buildProfileInterest(Collection&lt;Interest&gt; interests, Profile profile) {\r\n        Set&lt;ProfileInterest&gt; profileInterests = new HashSet&lt;&gt;();\r\n        for(Interest interest : interests) {\r\n            ProfileInterestId profileInterestId = new ProfileInterestId(interest.getId(), profile.getId());\r\n            ProfileInterest profileInterest = new ProfileInterest(profileInterestId, false);\r\n            profileInterest.setProfile(profile);\r\n            profileInterest.setInterest(interest);\r\n            profileInterests.add(profileInterestService.save(profileInterest));\r\n        }\r\n        return profileInterests;\r\n    }\r\n\r\nI had to add a constructor on the `ProfileStat` entity that accepts the ID class and the extra columns but doesn&#39;t need the objects; you&#39;ll add them later. I don&#39;t know if you can add them.\r\n\r\nI also had to change how I populate back the &quot;Profile&quot;, from\r\n`profile.setLanguages(buildProfileStat(findStats(profileDTO.getLanguages()), profile));` to `buildProfileStat(findStats(profileDTO.getLanguages()), profile);`.\r\n\r\nI couldn&#39;t set back the saved list to its main object instance, Profile; it throws a Stackoverflow Exception. Probably there&#39;s some workaround.\r\n\r\n  [1]: https://github.com/tericcabrel/blog-tutorials/blob/main/springboot-many-to-many-2/src/main/java/com/tericcabrel/movie/entities/UserMovie.java\r\n  [2]: https://github.com/SakamotoLfe/bookstore","title":"Spring JPA Many To Many with extra colum and Embedded ID","body":"<p>I solved this using <a href=\"https://github.com/tericcabrel/blog-tutorials/blob/main/springboot-many-to-many-2/src/main/java/com/tericcabrel/movie/entities/UserMovie.java\" rel=\"nofollow noreferrer\">this</a>. I built a <a href=\"https://github.com/SakamotoLfe/bookstore\" rel=\"nofollow noreferrer\">Github repository</a> with a simple example.</p>\n<p>My method that populates the object saves it but with a different structure:</p>\n<pre><code>private Set&lt;ProfileStat&gt; buildProfileStat(Collection&lt;Stat&gt; stats, Profile profile) {\n    Set&lt;ProfileStat&gt; profileStats = new HashSet&lt;&gt;();\n    for(Stat stat : stats) {\n        ProfileStatId profileStatId = new ProfileStatId(stat.getId(), profile.getId());\n        ProfileStat profileStat = new ProfileStat(profileStatId, fals e);\n        profileStat.setProfile(profile);\n        profileStat.setStat(stat);\n        profileStats.add(profileStatService.save(profileStat));\n    }\n    return profileStats;\n}\n\nprivate Set&lt;ProfileInterest&gt; buildProfileInterest(Collection&lt;Interest&gt; interests, Profile profile) {\n    Set&lt;ProfileInterest&gt; profileInterests = new HashSet&lt;&gt;();\n    for(Interest interest : interests) {\n        ProfileInterestId profileInterestId = new ProfileInterestId(interest.getId(), profile.getId());\n        ProfileInterest profileInterest = new ProfileInterest(profileInterestId, false);\n        profileInterest.setProfile(profile);\n        profileInterest.setInterest(interest);\n        profileInterests.add(profileInterestService.save(profileInterest));\n    }\n    return profileInterests;\n}\n</code></pre>\n<p>I had to add a constructor on the <code>ProfileStat</code> entity that accepts the ID class and the extra columns but doesn't need the objects; you'll add them later. I don't know if you can add them.</p>\n<p>I also had to change how I populate back the &quot;Profile&quot;, from\n<code>profile.setLanguages(buildProfileStat(findStats(profileDTO.getLanguages()), profile));</code> to <code>buildProfileStat(findStats(profileDTO.getLanguages()), profile);</code>.</p>\n<p>I couldn't set back the saved list to its main object instance, Profile; it throws a Stackoverflow Exception. Probably there's some workaround.</p>\n"}],"owner":{"account_id":14618034,"reputation":197,"user_id":10707177,"display_name":"Alfredo Marin"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":343,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75969758,"answer_count":1,"score":0,"last_activity_date":1681034927,"creation_date":1679804902,"question_id":75845864,"body_markdown":"I have a model that has many-to-many relations with two other entities multiple times and when I try to save them I get a stack overflow error.\r\n\r\nMy relation is Profile with multiple Stat and Interest, so a Profile can have multiple Stats and a Stat can be in multiple Profiles, so a Profile can have multiple Interests and an Interest can be in multiple Profiles. Classes ProfileStat and ProfileInterest have the ProfileStatId and ProfileInterestId as IDClass respectively:\r\n\r\n    @Entity\r\n    public class Profile extends GenericEntity {\r\n\r\n        @Column(nullable = false, length = 100)\r\n        private String name;\r\n\r\n        @OneToOne(mappedBy = &quot;stat&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\r\n        private ProfileStat smokes;\r\n\r\n        @OneToMany(mappedBy = &quot;stat&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\r\n        private Set&lt;ProfileStat&gt; languages;\r\n\r\n        @OneToMany(mappedBy = &quot;interest&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\r\n        private Set&lt;ProfileInterest&gt; relationshipInterests;\r\n    }\r\n\r\n    @Entity\r\n    public class ProfileStat {\r\n\r\n        @EmbeddedId\r\n        private ProfileStatId profileStatId = new ProfileStatId();\r\n\r\n        @ManyToOne\r\n        @MapsId(&quot;statId&quot;)\r\n        @JoinColumn(name = &quot;stat_id&quot;)\r\n        private Stat stat;\r\n\r\n        @ManyToOne\r\n        @MapsId(&quot;profileId&quot;)\r\n        @JoinColumn(name = &quot;profile_id&quot;)\r\n        private Profile profile;\r\n\r\n        @Column\r\n        private boolean displayable;\r\n    }\r\n\r\n    @Embeddable\r\n    public class ProfileStatId implements Serializable {\r\n\r\n        private static final long serialVersionUID = 1L;\r\n\r\n        private UUID statId;\r\n\r\n        private UUID profileId;\r\n    }\r\n\r\n    @Entity\r\n    public class ProfileInterest {\r\n\r\n        @EmbeddedId\r\n        private ProfileInterestId profileInterestId = new ProfileInterestId();\r\n\r\n        @ManyToOne\r\n        @MapsId(&quot;interestId&quot;)\r\n        @JoinColumn(name = &quot;interest_id&quot;)\r\n        private Interest interest;\r\n\r\n        @ManyToOne\r\n        @MapsId(&quot;profileId&quot;)\r\n        @JoinColumn(name = &quot;profile_id&quot;)\r\n        private Profile profile;\r\n\r\n        @Column\r\n        private boolean displayable;\r\n    }\r\n\r\n    @Embeddable\r\n    public class ProfileInterestId implements Serializable {\r\n\r\n        private static final long serialVersionUID = 1L;\r\n\r\n        private UUID interestId;\r\n\r\n        private UUID profileId;\r\n    }\r\n\r\nI have an endpoint that saves the profile without the Stats and Interests, but when I try to save the Stats and Interests it gives me an stack overflow exception. I save the profiles and create the Stats and Interests instances, but it can&#39;t finish creating the objects, let alone save them. The method that creates those objects:\r\n\r\n    public Profile enrichProfile(Profile profile, ProfileDTO profileDTO) throws RestRequestException {\r\n\r\n        // There&#39;s some code here that works, the problem is with the next line\r\n        profile.setLanguages(buildProfileStat(findStats(profileDTO.getLanguages()), profile));        \r\n        profile.setRelationshipInterests(buildProfileInterest(findInterests(profileDTO.getRelationshipInterestsId()), profile));\r\n        return profile;\r\n    }\r\n\r\n    private Set&lt;ProfileStat&gt; buildProfileStat(Collection&lt;Stat&gt; stats, Profile profile) {\r\n        Set&lt;ProfileStat&gt; profileStats = new HashSet&lt;&gt;();\r\n        for(Stat stat : stats) {\r\n            profileStats.add(new ProfileStat(stat, profile, false));\r\n        }\r\n        return profileStats;\r\n    }\r\n\r\n    private Set&lt;Stat&gt; findStats(Collection&lt;UUID&gt; ids) throws RestRequestException {\r\n        Set&lt;Stat&gt; stats = new HashSet&lt;&gt;();\r\n        for (UUID id : ids) {\r\n            stats.add(statService.findById(id)\r\n                    .orElseThrow(() -&gt; new RestRequestException(HttpStatus.NOT_FOUND, ErrorIndicator.ERROR_CPRAPI_0012_D.getMessage())));\r\n        }\r\n        return stats;\r\n    }\r\n\r\n    private Set&lt;ProfileInterest&gt; buildProfileInterest(Collection&lt;Interest&gt; interests, Profile profile) {\r\n        Set&lt;ProfileInterest&gt; profileInterest = new HashSet&lt;&gt;();\r\n        for(Interest interest : interests) {\r\n            profileInterest.add(new ProfileInterest(interest, profile, false));\r\n        }\r\n        return profileInterest;\r\n    }\r\n\r\n    private Set&lt;Interest&gt; findInterests(Collection&lt;UUID&gt; ids) throws RestRequestException {\r\n        Set&lt;Interest&gt; interests = new HashSet&lt;&gt;();\r\n        for (UUID id : ids) {\r\n            interests.add(interestService.findById(id)\r\n                    .orElseThrow(() -&gt; new RestRequestException(HttpStatus.NOT_FOUND, ErrorIndicator.ERROR_CPRAPI_0012_E.getMessage())));\r\n        }\r\n        return interests;\r\n    }\r\n\r\nHow I&#39;m calling the method that creates the Stats and Interests, right after executing a `repository.save()` on the Profile entity:\r\n\r\n        @ApiOperation(&quot;Endpoint to register/save a new profile.&quot;)\r\n        @PostMapping(value = &quot;/save&quot;)\r\n        public Profile saveProfile(@RequestBody ProfileDTO profileDTO) throws RestRequestException, CouplerPlanLimitationException {\r\n            profileService.verifyUserCanSaveProfile(profileDTO.getUserId());\r\n            Profile profile = profileService.save(profileFactory.newProfileDtoToProfile(profileDTO));\r\n            profile = profileFactory.enrichProfile(profile, profileDTO);\r\n            return profile;\r\n        }\r\n","title":"Spring JPA Many To Many with extra colum and Embedded ID","body":"<p>I have a model that has many-to-many relations with two other entities multiple times and when I try to save them I get a stack overflow error.</p>\n<p>My relation is Profile with multiple Stat and Interest, so a Profile can have multiple Stats and a Stat can be in multiple Profiles, so a Profile can have multiple Interests and an Interest can be in multiple Profiles. Classes ProfileStat and ProfileInterest have the ProfileStatId and ProfileInterestId as IDClass respectively:</p>\n<pre><code>@Entity\npublic class Profile extends GenericEntity {\n\n    @Column(nullable = false, length = 100)\n    private String name;\n\n    @OneToOne(mappedBy = &quot;stat&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\n    private ProfileStat smokes;\n\n    @OneToMany(mappedBy = &quot;stat&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\n    private Set&lt;ProfileStat&gt; languages;\n\n    @OneToMany(mappedBy = &quot;interest&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\n    private Set&lt;ProfileInterest&gt; relationshipInterests;\n}\n\n@Entity\npublic class ProfileStat {\n\n    @EmbeddedId\n    private ProfileStatId profileStatId = new ProfileStatId();\n\n    @ManyToOne\n    @MapsId(&quot;statId&quot;)\n    @JoinColumn(name = &quot;stat_id&quot;)\n    private Stat stat;\n\n    @ManyToOne\n    @MapsId(&quot;profileId&quot;)\n    @JoinColumn(name = &quot;profile_id&quot;)\n    private Profile profile;\n\n    @Column\n    private boolean displayable;\n}\n\n@Embeddable\npublic class ProfileStatId implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n\n    private UUID statId;\n\n    private UUID profileId;\n}\n\n@Entity\npublic class ProfileInterest {\n\n    @EmbeddedId\n    private ProfileInterestId profileInterestId = new ProfileInterestId();\n\n    @ManyToOne\n    @MapsId(&quot;interestId&quot;)\n    @JoinColumn(name = &quot;interest_id&quot;)\n    private Interest interest;\n\n    @ManyToOne\n    @MapsId(&quot;profileId&quot;)\n    @JoinColumn(name = &quot;profile_id&quot;)\n    private Profile profile;\n\n    @Column\n    private boolean displayable;\n}\n\n@Embeddable\npublic class ProfileInterestId implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n\n    private UUID interestId;\n\n    private UUID profileId;\n}\n</code></pre>\n<p>I have an endpoint that saves the profile without the Stats and Interests, but when I try to save the Stats and Interests it gives me an stack overflow exception. I save the profiles and create the Stats and Interests instances, but it can't finish creating the objects, let alone save them. The method that creates those objects:</p>\n<pre><code>public Profile enrichProfile(Profile profile, ProfileDTO profileDTO) throws RestRequestException {\n\n    // There's some code here that works, the problem is with the next line\n    profile.setLanguages(buildProfileStat(findStats(profileDTO.getLanguages()), profile));        \n    profile.setRelationshipInterests(buildProfileInterest(findInterests(profileDTO.getRelationshipInterestsId()), profile));\n    return profile;\n}\n\nprivate Set&lt;ProfileStat&gt; buildProfileStat(Collection&lt;Stat&gt; stats, Profile profile) {\n    Set&lt;ProfileStat&gt; profileStats = new HashSet&lt;&gt;();\n    for(Stat stat : stats) {\n        profileStats.add(new ProfileStat(stat, profile, false));\n    }\n    return profileStats;\n}\n\nprivate Set&lt;Stat&gt; findStats(Collection&lt;UUID&gt; ids) throws RestRequestException {\n    Set&lt;Stat&gt; stats = new HashSet&lt;&gt;();\n    for (UUID id : ids) {\n        stats.add(statService.findById(id)\n                .orElseThrow(() -&gt; new RestRequestException(HttpStatus.NOT_FOUND, ErrorIndicator.ERROR_CPRAPI_0012_D.getMessage())));\n    }\n    return stats;\n}\n\nprivate Set&lt;ProfileInterest&gt; buildProfileInterest(Collection&lt;Interest&gt; interests, Profile profile) {\n    Set&lt;ProfileInterest&gt; profileInterest = new HashSet&lt;&gt;();\n    for(Interest interest : interests) {\n        profileInterest.add(new ProfileInterest(interest, profile, false));\n    }\n    return profileInterest;\n}\n\nprivate Set&lt;Interest&gt; findInterests(Collection&lt;UUID&gt; ids) throws RestRequestException {\n    Set&lt;Interest&gt; interests = new HashSet&lt;&gt;();\n    for (UUID id : ids) {\n        interests.add(interestService.findById(id)\n                .orElseThrow(() -&gt; new RestRequestException(HttpStatus.NOT_FOUND, ErrorIndicator.ERROR_CPRAPI_0012_E.getMessage())));\n    }\n    return interests;\n}\n</code></pre>\n<p>How I'm calling the method that creates the Stats and Interests, right after executing a <code>repository.save()</code> on the Profile entity:</p>\n<pre><code>    @ApiOperation(&quot;Endpoint to register/save a new profile.&quot;)\n    @PostMapping(value = &quot;/save&quot;)\n    public Profile saveProfile(@RequestBody ProfileDTO profileDTO) throws RestRequestException, CouplerPlanLimitationException {\n        profileService.verifyUserCanSaveProfile(profileDTO.getUserId());\n        Profile profile = profileService.save(profileFactory.newProfileDtoToProfile(profileDTO));\n        profile = profileFactory.enrichProfile(profile, profileDTO);\n        return profile;\n    }\n</code></pre>\n"},{"tags":["java","docker","maven","continuous-integration","github-actions"],"comments":[{"owner":{"account_id":152743,"reputation":194462,"user_id":367456,"accept_rate":71,"display_name":"hakre"},"score":0,"creation_date":1681049954,"post_id":75969721,"comment_id":133993339,"body_markdown":"Are you sure you&#39;re pulling the latest revision stored in the registry under the now re-tagged tag? Please add the instructions on how you compare the image revision for the new tag to your question so that it becomes more **concrete** what you ask about here.","body":"Are you sure you&#39;re pulling the latest revision stored in the registry under the now re-tagged tag? Please add the instructions on how you compare the image revision for the new tag to your question so that it becomes more <b>concrete</b> what you ask about here."},{"owner":{"account_id":21023381,"reputation":23,"user_id":15449203,"display_name":"Johni"},"score":0,"creation_date":1681062031,"post_id":75969721,"comment_id":133994945,"body_markdown":"pull_policy: always is not working as well","body":"pull_policy: always is not working as well"},{"owner":{"account_id":152743,"reputation":194462,"user_id":367456,"accept_rate":71,"display_name":"hakre"},"score":0,"creation_date":1681065673,"post_id":75969721,"comment_id":133995428,"body_markdown":"Please add all relevant information to your question, like the docker-compose.yml file. That works by [edit]ing the quesiton, the [help] has more detailed information. Possible duplicate of: https://stackoverflow.com/q/37685581/367456","body":"Please add all relevant information to your question, like the docker-compose.yml file. That works by <a href=\"https://stackoverflow.com/posts/75969721/edit\">edit</a>ing the quesiton, the <a href=\"https://stackoverflow.com/help\">help center</a> has more detailed information. Possible duplicate of: <a href=\"https://stackoverflow.com/q/37685581/367456\">stackoverflow.com/q/37685581/367456</a>"}],"owner":{"account_id":21023381,"reputation":23,"user_id":15449203,"display_name":"Johni"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":49,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681033090,"creation_date":1681032779,"question_id":75969721,"body_markdown":"When I make changes to my code and push the changes, the CI pipeline is triggered, and it builds and pushes the Docker image to the GitHub Container Registry. However, it seems that when I pull the image, the changes are not present. Am I doing something wrong in my CI workflow? Here&#39;s my file:    \r\n\r\n\r\n    name: Continuous Integration\r\n    \r\n    on:\r\n      push:\r\n        branches:\r\n          - main\r\n    \r\n    env:\r\n      REGISTRY: ghcr.io\r\n      IMAGE_NAME: ${{ github.repository }}\r\n    \r\n    jobs:\r\n      build-and-push-image:\r\n        runs-on: ubuntu-latest\r\n        permissions:\r\n          contents: read\r\n          packages: write\r\n        steps:\r\n          - name: Checkout repository\r\n            uses: actions/checkout@v3\r\n    \r\n          - name: Log in to the Container registry\r\n            uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9\r\n            with:\r\n              registry: ${{ env.REGISTRY }}\r\n              username: ${{ github.actor }}\r\n              password: ${{ secrets.GITHUB_TOKEN }}\r\n    \r\n          - name: Set up Docker Buildx\r\n            uses: docker/setup-buildx-action@v1\r\n    \r\n          - name: Build and push Docker image\r\n            uses: docker/build-push-action@v2\r\n            with:\r\n              context: .\r\n              push: true\r\n              tags: ghcr.io/${{ github.repository_owner }}/myreponame:new\r\n\r\n\r\nWhen I first change the tag of the image (here I have it set to &quot;new&quot;),  I can see my new changes in my newly built image, but if I don&#39;t modify the tag, the changes don&#39;t get applied.\r\n\r\nHere&#39;s my dockerfile if it can help:\r\n\r\n    # Build stage\r\n    FROM maven:3-openjdk-17-slim AS build\r\n    COPY src /home/app/src\r\n    COPY pom.xml /home/app/pom.xml\r\n    COPY wait-for-it.sh /home/app/wait-for-it.sh\r\n    RUN chmod +x /home/app/wait-for-it.sh\r\n    RUN mvn -f /home/app/pom.xml clean package\r\n    \r\n    # Package stage\r\n    FROM openjdk:17-alpine\r\n    RUN apk add --no-cache bash\r\n    COPY --from=build /home/app/target/api.jar /usr/local/lib/api.jar\r\n    COPY --from=build /home/app/wait-for-it.sh /usr/local/bin/wait-for-it.sh\r\n    ENTRYPOINT [&quot;/usr/local/bin/wait-for-it.sh&quot;, &quot;db:5432&quot;, &quot;--&quot;, &quot;java&quot;, &quot;-jar&quot;, &quot;/usr/local/lib/api.jar&quot;]\r\n\r\n","title":"Troubleshooting CI Pipeline: Changes Not Reflected in Docker Imager","body":"<p>When I make changes to my code and push the changes, the CI pipeline is triggered, and it builds and pushes the Docker image to the GitHub Container Registry. However, it seems that when I pull the image, the changes are not present. Am I doing something wrong in my CI workflow? Here's my file:</p>\n<pre><code>name: Continuous Integration\n\non:\n  push:\n    branches:\n      - main\n\nenv:\n  REGISTRY: ghcr.io\n  IMAGE_NAME: ${{ github.repository }}\n\njobs:\n  build-and-push-image:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: read\n      packages: write\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v3\n\n      - name: Log in to the Container registry\n        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9\n        with:\n          registry: ${{ env.REGISTRY }}\n          username: ${{ github.actor }}\n          password: ${{ secrets.GITHUB_TOKEN }}\n\n      - name: Set up Docker Buildx\n        uses: docker/setup-buildx-action@v1\n\n      - name: Build and push Docker image\n        uses: docker/build-push-action@v2\n        with:\n          context: .\n          push: true\n          tags: ghcr.io/${{ github.repository_owner }}/myreponame:new\n</code></pre>\n<p>When I first change the tag of the image (here I have it set to &quot;new&quot;),  I can see my new changes in my newly built image, but if I don't modify the tag, the changes don't get applied.</p>\n<p>Here's my dockerfile if it can help:</p>\n<pre><code># Build stage\nFROM maven:3-openjdk-17-slim AS build\nCOPY src /home/app/src\nCOPY pom.xml /home/app/pom.xml\nCOPY wait-for-it.sh /home/app/wait-for-it.sh\nRUN chmod +x /home/app/wait-for-it.sh\nRUN mvn -f /home/app/pom.xml clean package\n\n# Package stage\nFROM openjdk:17-alpine\nRUN apk add --no-cache bash\nCOPY --from=build /home/app/target/api.jar /usr/local/lib/api.jar\nCOPY --from=build /home/app/wait-for-it.sh /usr/local/bin/wait-for-it.sh\nENTRYPOINT [&quot;/usr/local/bin/wait-for-it.sh&quot;, &quot;db:5432&quot;, &quot;--&quot;, &quot;java&quot;, &quot;-jar&quot;, &quot;/usr/local/lib/api.jar&quot;]\n</code></pre>\n"},{"tags":["java","set","comparator","treeset"],"comments":[{"owner":{"account_id":1888781,"reputation":2007,"user_id":1707427,"display_name":"S&#246;ren"},"score":1,"creation_date":1681032561,"post_id":75969664,"comment_id":133991413,"body_markdown":"&quot;but somehow it is using the comparator to decide which value to be inserted&quot; Yes, that&#39;s how TreeSet works.","body":"&quot;but somehow it is using the comparator to decide which value to be inserted&quot; Yes, that&#39;s how TreeSet works."},{"owner":{"account_id":213468,"reputation":103500,"user_id":466862,"display_name":"Mark Rotteveel"},"score":2,"creation_date":1681032624,"post_id":75969664,"comment_id":133991425,"body_markdown":"Have you read the documentation of [`TreeSet`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/TreeSet.html)? Specifically: _&quot;[..], but a `TreeSet` instance performs all element comparisons using its `compareTo` (or `compare`) method, so two elements that are deemed equal by this method are, from the standpoint of the set, equal.&quot;_ It also says: _&quot;Note that the ordering maintained by a set (whether or not an explicit comparator is provided) must be **consistent with equals** if it is to correctly implement the Set interface.&quot;_","body":"Have you read the documentation of <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/TreeSet.html\" rel=\"nofollow noreferrer\"><code>TreeSet</code></a>? Specifically: <i>&quot;[..], but a <code>TreeSet</code> instance performs all element comparisons using its <code>compareTo</code> (or <code>compare</code>) method, so two elements that are deemed equal by this method are, from the standpoint of the set, equal.&quot;</i> It also says: <i>&quot;Note that the ordering maintained by a set (whether or not an explicit comparator is provided) must be <b>consistent with equals</b> if it is to correctly implement the Set interface.&quot;</i>"}],"owner":{"account_id":16579822,"reputation":9,"user_id":11980710,"display_name":"luke__skywalkrrr"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":30,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"closed_date":1681032771,"answer_count":0,"score":0,"last_activity_date":1681032858,"creation_date":1681031777,"question_id":75969664,"body_markdown":"I am trying to add elements of pair in TreeSet, but somehow it is using the comparator to decide which value to be inserted.\r\n\r\n```java\r\nclass pair{\r\n    int i;\r\n    int j;\r\n    int w;\r\n\r\n    pair(int i,int j,int w){\r\n        this.i=i;\r\n        this.j=j;\r\n        this.w=w;\r\n    }\r\n\r\n    public boolean equals(Object o){\r\n        if(this==o) return true;\r\n        if(o==null || this.getClass()!=o.getClass()) return false;\r\n        pair p=(pair)o;\r\n        boolean a=i==p.i;\r\n        boolean b=j==p.j;\r\n            boolean c=w==p.w;\r\n        return (a &amp;&amp; b &amp;&amp; c);\r\n    }\r\n\r\n    public int hashCode(Object o){\r\n        return Objects.hash(i,j,w);\r\n    } \r\n\r\n    @Override\r\n    public String toString(){\r\n        return i + &quot;-&quot; + j + &quot;-&quot; + w;\r\n    }\r\n\r\n}\r\n```\r\n```\r\npublic class CodeExample {\r\n    \r\n    public static void main(String[] arg) {\r\n        TreeSet&lt;pair&gt; s = new TreeSet&lt;&gt;(new Comparator&lt;&gt;(){\r\n            public int compare(pair a , pair b){\r\n                return a.w-b.w;\r\n             }\r\n         });\r\n         pair p1 =new pair(1,3,3);\r\n         pair p2 =new pair(1,2,3);\r\n         pair p3 =new pair(2,2,3);\r\n         pair p4 =new pair(2,2,4);\r\n\r\n         if(p1.equals(p2))\r\n             System.out.println(&quot;P1 and P2 are equal&quot;);\r\n         \r\n         s.add(p1);\r\n         s.add(p2);\r\n         s.add(p3);\r\n         s.add(p4);\r\n\r\n         System.out.println(s.size()); // OUTPUT = 2\r\n         while(!s.isEmpty()){\r\n             pair t = s.first();\r\n             System.out.println(t); //\r\n             s.remove(t);\r\n         }\r\n    }\r\n}\r\n```\r\nOutput\r\n```none\r\n2 \r\n1-3-3\r\n2-2-4\r\n```\r\nI am not sure why the p2 and p3 are not being inserted.\r\n\r\nIf I update the comparator to\r\n\r\n```java\r\nTreeSet&lt;pair&gt; s = new TreeSet&lt;&gt;(new Comparator&lt;&gt;(){\r\n\r\n    public int compare(pair a , pair b){\r\n        if(a.w==b.w ){\r\n            if(a.i==b.i)\r\n                return a.j-b.j;\r\n            return a.i-b.i; \r\n        }\r\n        return a.w-b.w;\r\n     }\r\n});\r\n```\r\nIt is now adding all 4 elements. I thought comparator is only used while removing elements from the Set and the Set uses `equals` and `hashcode` to check if the Objects are duplicate, so why it is not inserting p2 and p3 (Same W value )in the first case?\r\n\r\nI&#39;m now sure why it is happening.\r\n","title":"Using Tree Set in java with user defined class","body":"<p>I am trying to add elements of pair in TreeSet, but somehow it is using the comparator to decide which value to be inserted.</p>\n<pre class=\"lang-java prettyprint-override\"><code>class pair{\n    int i;\n    int j;\n    int w;\n\n    pair(int i,int j,int w){\n        this.i=i;\n        this.j=j;\n        this.w=w;\n    }\n\n    public boolean equals(Object o){\n        if(this==o) return true;\n        if(o==null || this.getClass()!=o.getClass()) return false;\n        pair p=(pair)o;\n        boolean a=i==p.i;\n        boolean b=j==p.j;\n            boolean c=w==p.w;\n        return (a &amp;&amp; b &amp;&amp; c);\n    }\n\n    public int hashCode(Object o){\n        return Objects.hash(i,j,w);\n    } \n\n    @Override\n    public String toString(){\n        return i + &quot;-&quot; + j + &quot;-&quot; + w;\n    }\n\n}\n</code></pre>\n<pre><code>public class CodeExample {\n    \n    public static void main(String[] arg) {\n        TreeSet&lt;pair&gt; s = new TreeSet&lt;&gt;(new Comparator&lt;&gt;(){\n            public int compare(pair a , pair b){\n                return a.w-b.w;\n             }\n         });\n         pair p1 =new pair(1,3,3);\n         pair p2 =new pair(1,2,3);\n         pair p3 =new pair(2,2,3);\n         pair p4 =new pair(2,2,4);\n\n         if(p1.equals(p2))\n             System.out.println(&quot;P1 and P2 are equal&quot;);\n         \n         s.add(p1);\n         s.add(p2);\n         s.add(p3);\n         s.add(p4);\n\n         System.out.println(s.size()); // OUTPUT = 2\n         while(!s.isEmpty()){\n             pair t = s.first();\n             System.out.println(t); //\n             s.remove(t);\n         }\n    }\n}\n</code></pre>\n<p>Output</p>\n<pre class=\"lang-none prettyprint-override\"><code>2 \n1-3-3\n2-2-4\n</code></pre>\n<p>I am not sure why the p2 and p3 are not being inserted.</p>\n<p>If I update the comparator to</p>\n<pre class=\"lang-java prettyprint-override\"><code>TreeSet&lt;pair&gt; s = new TreeSet&lt;&gt;(new Comparator&lt;&gt;(){\n\n    public int compare(pair a , pair b){\n        if(a.w==b.w ){\n            if(a.i==b.i)\n                return a.j-b.j;\n            return a.i-b.i; \n        }\n        return a.w-b.w;\n     }\n});\n</code></pre>\n<p>It is now adding all 4 elements. I thought comparator is only used while removing elements from the Set and the Set uses <code>equals</code> and <code>hashcode</code> to check if the Objects are duplicate, so why it is not inserting p2 and p3 (Same W value )in the first case?</p>\n<p>I'm now sure why it is happening.</p>\n"},{"tags":["java","http","request","apache-httpasyncclient"],"answers":[{"tags":[],"owner":{"account_id":1281728,"reputation":73134,"user_id":1235698,"accept_rate":100,"display_name":"Marcin Orlowski"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1681032174,"creation_date":1681028398,"answer_id":75969459,"question_id":75969443,"body_markdown":"There&#39;s no requirement for `Host` header to match target URL, otherwise shared hosting would not work. But there&#39;s more - your `host` variable holds full URL string, while host name should be just what it says `example.com`:\r\n\r\n```java\r\nString host = &quot;example.com&quot;;\r\nString destination_address = &quot;https://8.8.8.8&quot;;\r\n```\r\n\r\nOnce that is corrected, create custom header and use it while building request:\r\n\r\n```java\r\nHeader hostHeader = new BasicHeader(HttpHeaders.HOST, host);\r\n\r\nhttp_request = SimpleRequestBuilder.post(destination_address + &quot;/something&quot;)\r\n                        .setBody(request_body, ContentType.TEXT_PLAIN)\r\n                        .addHeader(hostHeader) // Add the custom &#39;Host&#39; header\r\n                        .setHeaders(request_headers)\r\n                        .build();\r\n```\r\n\r\nI am using Apache HttpClient&#39;s `BasicHeader` class.","title":"Java: Http request with different Host Header and destination","body":"<p>There's no requirement for <code>Host</code> header to match target URL, otherwise shared hosting would not work. But there's more - your <code>host</code> variable holds full URL string, while host name should be just what it says <code>example.com</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>String host = &quot;example.com&quot;;\nString destination_address = &quot;https://8.8.8.8&quot;;\n</code></pre>\n<p>Once that is corrected, create custom header and use it while building request:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Header hostHeader = new BasicHeader(HttpHeaders.HOST, host);\n\nhttp_request = SimpleRequestBuilder.post(destination_address + &quot;/something&quot;)\n                        .setBody(request_body, ContentType.TEXT_PLAIN)\n                        .addHeader(hostHeader) // Add the custom 'Host' header\n                        .setHeaders(request_headers)\n                        .build();\n</code></pre>\n<p>I am using Apache HttpClient's <code>BasicHeader</code> class.</p>\n"}],"owner":{"account_id":27534826,"reputation":29,"user_id":21012691,"display_name":"netcat_dd"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":146,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75969459,"answer_count":1,"score":0,"last_activity_date":1681032174,"creation_date":1681028041,"question_id":75969443,"body_markdown":"I need to make an HTTP request with specific Host header that may differ from destination address. What are my options?\r\n\r\nLet&#39;s say we have these variables already defined.\r\n```java\r\nString host = &quot;https://example.com/something&quot;;\r\nString destination_address = &quot;https://8.8.8.8&quot;;\r\nString http_version = &quot;HTTP/2&quot;;\r\nString http_method = &quot;POST&quot;;\r\nboolean follow_redirects = true;\r\n```\r\n\r\nHere is my code. Currently i am using Apache Http-Client-5, but i don&#39;t mind hearing any other suggestions.\r\n\r\n```java\r\nH2AsyncClientBuilder builder_2 = HttpAsyncClients.customHttp2();\r\n\r\nif (follow_redirects) {\r\n    builder_2.setRedirectStrategy(new DefaultRedirectStrategy());\r\n    }\r\n\r\nif (!(Objects.equals(destination_address, host))) {\r\n            builder_1.setProxy(HttpHost.create(destination_address));\r\n            }\r\n\r\nCloseableHttpAsyncClient client = HttpAsyncClients.createDefault();\r\nclient = builder_2.build();\r\nclient.start();\r\n\r\n// Here i have long &quot;case&quot; statement for each Http method, i desided to not enclude it here. \r\n// Here is the version for post request.\r\nhttp_request = SimpleRequestBuilder.post(host)\r\n                        .setBody(request_body, ContentType.TEXT_PLAIN)\r\n                        .setHeaders(request_headers)\r\n                        .build();\r\n\r\nFuture&lt;SimpleHttpResponse&gt; future = client.execute(http_request, null);\r\n            SimpleHttpResponse http_response = future.get();\r\n            client.close(CloseMode.GRACEFUL);\r\n```","title":"Java: Http request with different Host Header and destination","body":"<p>I need to make an HTTP request with specific Host header that may differ from destination address. What are my options?</p>\n<p>Let's say we have these variables already defined.</p>\n<pre class=\"lang-java prettyprint-override\"><code>String host = &quot;https://example.com/something&quot;;\nString destination_address = &quot;https://8.8.8.8&quot;;\nString http_version = &quot;HTTP/2&quot;;\nString http_method = &quot;POST&quot;;\nboolean follow_redirects = true;\n</code></pre>\n<p>Here is my code. Currently i am using Apache Http-Client-5, but i don't mind hearing any other suggestions.</p>\n<pre class=\"lang-java prettyprint-override\"><code>H2AsyncClientBuilder builder_2 = HttpAsyncClients.customHttp2();\n\nif (follow_redirects) {\n    builder_2.setRedirectStrategy(new DefaultRedirectStrategy());\n    }\n\nif (!(Objects.equals(destination_address, host))) {\n            builder_1.setProxy(HttpHost.create(destination_address));\n            }\n\nCloseableHttpAsyncClient client = HttpAsyncClients.createDefault();\nclient = builder_2.build();\nclient.start();\n\n// Here i have long &quot;case&quot; statement for each Http method, i desided to not enclude it here. \n// Here is the version for post request.\nhttp_request = SimpleRequestBuilder.post(host)\n                        .setBody(request_body, ContentType.TEXT_PLAIN)\n                        .setHeaders(request_headers)\n                        .build();\n\nFuture&lt;SimpleHttpResponse&gt; future = client.execute(http_request, null);\n            SimpleHttpResponse http_response = future.get();\n            client.close(CloseMode.GRACEFUL);\n</code></pre>\n"},{"tags":["java","hashmap","equals"],"comments":[{"owner":{"account_id":213468,"reputation":103500,"user_id":466862,"display_name":"Mark Rotteveel"},"score":2,"creation_date":1681031435,"post_id":75969618,"comment_id":133991304,"body_markdown":"`Integer` is an object type, not a primitive type. Integers in the range -128, 127 might be cached, and then `==` happens to work. When comparing object, you should always use `equals` (unless you want to check object identity).","body":"<code>Integer</code> is an object type, not a primitive type. Integers in the range -128, 127 might be cached, and then <code>==</code> happens to work. When comparing object, you should always use <code>equals</code> (unless you want to check object identity)."}],"owner":{"account_id":25649992,"reputation":1,"user_id":19417414,"display_name":"Hubert Huang"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":37,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1681031538,"answer_count":0,"score":0,"last_activity_date":1681031558,"creation_date":1681030917,"question_id":75969618,"body_markdown":"Link:https://leetcode.com/problems/robot-return-to-origin/\r\n\r\nQuestion: There is a robot starting at the position (0, 0), the origin, on a 2D plane. Given a sequence of its moves, judge if this robot ends up at (0, 0) after it completes its moves.\r\n\r\nYou are given a string moves that represents the move sequence of the robot where moves[i] represents its ith move. Valid moves are &#39;R&#39; (right), &#39;L&#39; (left), &#39;U&#39; (up), and &#39;D&#39; (down).\r\n\r\nReturn true if the robot returns to the origin after it finishes all of its moves, or false otherwise.\r\n\r\nMy approach was to make a haskmap that record how many times the U, D, L, and R moves occured in the string. If the number of U equals the number the D and the number of L equals the number of R, we return true since it means that the robot would be back at the origin. Else, we return false. I&#39;m confused why my code only worked for some testcases when I used == to compare the number of each letter. If I change == to .equals, my code passes all the testcases. Why is this the case? Since we are comparing integer objects, shouldn&#39;t both == and .equals just check if the memory locations are the same? Here is my code (the commented code is what I had initially):\r\n\r\n    class Solution {\r\n    public boolean judgeCircle(String moves) {\r\n        HashMap&lt;Character,Integer&gt; map = new HashMap&lt;Character,Integer&gt;();\r\n        char[] move=moves.toCharArray();\r\n        map.put(&#39;R&#39;,0);\r\n        map.put(&#39;L&#39;,0);\r\n        map.put(&#39;U&#39;,0);\r\n        map.put(&#39;D&#39;,0);\r\n        for (char i : move){\r\n            if(!map.containsKey(i)) return false;\r\n            map.put(i,map.get(i)+1);\r\n        }\r\n        if(map.get(&#39;R&#39;).equals(map.get(&#39;L&#39;))&amp;&amp;map.get(&#39;U&#39;).equals(map.get(&#39;D&#39;))){\r\n            return true;\r\n        }\r\n        /*\r\n        if(map.get(&#39;R&#39;)==map.get(&#39;L&#39;)&amp;&amp;map.get(&#39;U&#39;)==map.get(&#39;D&#39;)){\r\n            return true;\r\n        }\r\n        */\r\n        return false;\r\n    }\r\n}","title":"Difference between using == and equals to compare hashmap values (Leetcode question 657)","body":"<p>Link:<a href=\"https://leetcode.com/problems/robot-return-to-origin/\" rel=\"nofollow noreferrer\">https://leetcode.com/problems/robot-return-to-origin/</a></p>\n<p>Question: There is a robot starting at the position (0, 0), the origin, on a 2D plane. Given a sequence of its moves, judge if this robot ends up at (0, 0) after it completes its moves.</p>\n<p>You are given a string moves that represents the move sequence of the robot where moves[i] represents its ith move. Valid moves are 'R' (right), 'L' (left), 'U' (up), and 'D' (down).</p>\n<p>Return true if the robot returns to the origin after it finishes all of its moves, or false otherwise.</p>\n<p>My approach was to make a haskmap that record how many times the U, D, L, and R moves occured in the string. If the number of U equals the number the D and the number of L equals the number of R, we return true since it means that the robot would be back at the origin. Else, we return false. I'm confused why my code only worked for some testcases when I used == to compare the number of each letter. If I change == to .equals, my code passes all the testcases. Why is this the case? Since we are comparing integer objects, shouldn't both == and .equals just check if the memory locations are the same? Here is my code (the commented code is what I had initially):</p>\n<pre><code>class Solution {\npublic boolean judgeCircle(String moves) {\n    HashMap&lt;Character,Integer&gt; map = new HashMap&lt;Character,Integer&gt;();\n    char[] move=moves.toCharArray();\n    map.put('R',0);\n    map.put('L',0);\n    map.put('U',0);\n    map.put('D',0);\n    for (char i : move){\n        if(!map.containsKey(i)) return false;\n        map.put(i,map.get(i)+1);\n    }\n    if(map.get('R').equals(map.get('L'))&amp;&amp;map.get('U').equals(map.get('D'))){\n        return true;\n    }\n    /*\n    if(map.get('R')==map.get('L')&amp;&amp;map.get('U')==map.get('D')){\n        return true;\n    }\n    */\n    return false;\n}\n</code></pre>\n<p>}</p>\n"},{"tags":["java","visual-studio-code"],"answers":[{"comments":[{"owner":{"account_id":1398261,"reputation":3758,"user_id":1327585,"accept_rate":74,"display_name":"Anil Bhaskar"},"score":0,"creation_date":1566799067,"post_id":57148184,"comment_id":101755018,"body_markdown":"Can&#39;t believe it just worked, microsoft should see this and fix the reason behind it.","body":"Can&#39;t believe it just worked, microsoft should see this and fix the reason behind it."},{"owner":{"account_id":345234,"reputation":3288,"user_id":678016,"accept_rate":76,"display_name":"Rich S"},"score":0,"creation_date":1568276416,"post_id":57148184,"comment_id":102225263,"body_markdown":"&quot;turn it off and on again&quot; - it shouldn&#39;t work, but it does!","body":"&quot;turn it off and on again&quot; - it shouldn&#39;t work, but it does!"},{"owner":{"account_id":4773526,"reputation":844,"user_id":4357087,"accept_rate":55,"display_name":"Joseph Tesfaye"},"score":1,"creation_date":1575875202,"post_id":57148184,"comment_id":104698357,"body_markdown":"Got a similar issue on Emacs lsp-java. Would be better if the exact reason is known...","body":"Got a similar issue on Emacs lsp-java. Would be better if the exact reason is known..."},{"owner":{"account_id":15462527,"reputation":7563,"user_id":11154841,"display_name":"questionto42"},"score":0,"creation_date":1592499324,"post_id":57148184,"comment_id":110454550,"body_markdown":"@Rich S and probably against all forum rules. Thank you for the ideal link to IT Crowd: &quot;Have you tried turning it off and on again.&quot; :) But to anyone who does not know it yet, at best, do not start watching it.","body":"@Rich S and probably against all forum rules. Thank you for the ideal link to IT Crowd: &quot;Have you tried turning it off and on again.&quot; :) But to anyone who does not know it yet, at best, do not start watching it."},{"owner":{"account_id":343790,"reputation":10859,"user_id":675721,"accept_rate":75,"display_name":"Codebling"},"score":1,"creation_date":1637710118,"post_id":57148184,"comment_id":123898401,"body_markdown":"Didn&#39;t work for me.","body":"Didn&#39;t work for me."},{"owner":{"account_id":3598397,"reputation":1231,"user_id":3002377,"accept_rate":50,"display_name":"nashter"},"score":0,"creation_date":1686221244,"post_id":57148184,"comment_id":134770659,"body_markdown":"Did not work for me either.","body":"Did not work for me either."}],"tags":[],"owner":{"account_id":2329893,"reputation":741,"user_id":2043575,"accept_rate":86,"display_name":"Daniel M&#252;ller"},"comment_count":6,"down_vote_count":0,"up_vote_count":44,"is_accepted":true,"score":44,"last_activity_date":1563805720,"creation_date":1563805720,"answer_id":57148184,"question_id":57148090,"body_markdown":"Restarting Visual Studio Code solved this issue...","title":"Java Project in VS-Code, &quot;No delegateCommandHandler for vscode.java.validateLaunchConfig&quot; Error","body":"<p>Restarting Visual Studio Code solved this issue...</p>\n"},{"tags":[],"owner":{"account_id":24493291,"reputation":1,"user_id":18410025,"display_name":"Ana"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1650988553,"creation_date":1650988553,"answer_id":72016998,"question_id":57148090,"body_markdown":"In my case, some of them (Test Runner for Java and Debugger for Java) had a &quot;reload required&quot; button next to the uninstall button. After I pressed them, the error you mentioned disappeared and it worked well. Maybe it helps.:)","title":"Java Project in VS-Code, &quot;No delegateCommandHandler for vscode.java.validateLaunchConfig&quot; Error","body":"<p>In my case, some of them (Test Runner for Java and Debugger for Java) had a &quot;reload required&quot; button next to the uninstall button. After I pressed them, the error you mentioned disappeared and it worked well. Maybe it helps.:)</p>\n"},{"tags":[],"owner":{"account_id":27937278,"reputation":1,"user_id":21334011,"display_name":"Ricardo Pardim Silva"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681030472,"creation_date":1681008365,"answer_id":75968545,"question_id":57148090,"body_markdown":"if nothing of the other solutions work for you, go to your Extensions and press the button &quot;revert to pre-release&quot; to all java extensions, reload VS Code and *voil&#225;*","title":"Java Project in VS-Code, &quot;No delegateCommandHandler for vscode.java.validateLaunchConfig&quot; Error","body":"<p>if nothing of the other solutions work for you, go to your Extensions and press the button &quot;revert to pre-release&quot; to all java extensions, reload VS Code and <em>voilá</em></p>\n"}],"owner":{"account_id":2329893,"reputation":741,"user_id":2043575,"accept_rate":86,"display_name":"Daniel M&#252;ller"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":15302,"favorite_count":0,"down_vote_count":1,"up_vote_count":15,"accepted_answer_id":57148184,"answer_count":3,"score":14,"last_activity_date":1681030472,"creation_date":1563805360,"question_id":57148090,"body_markdown":"I&#39;m new to Java in Visual Studio Code and trying to implement small application, which is using our SDK, which is located in our internal Git Repository.\r\n\r\nWhen trying to Debug my application I get following Error:\r\n\r\n&gt; No delegateCommandHandler for vscode.java.validateLaunchConfig\r\n\r\nMy Configurationfile looks pretty simple:\r\n\r\n    {\r\n        &quot;configurations&quot;: [\r\n            \r\n            {\r\n                &quot;type&quot;: &quot;java&quot;,\r\n                &quot;name&quot;: &quot;CodeLens (Launch) - App&quot;,\r\n                &quot;request&quot;: &quot;launch&quot;,\r\n                &quot;mainClass&quot;: &quot;com.my.first.class&quot;,\r\n                &quot;projectName&quot;: &quot;dummyproject&quot;\r\n            }\r\n        ]\r\n    }\r\n\r\nI&#39;m using following Extensions for Visual Studio Code:\r\n\r\n - Debugger for Java (0.20.0)\r\n - Gitlens (9.9.0)\r\n - Java Dependency Viewer (0.5.1)\r\n - Java Test Runner (0.18.1)\r\n - Maven for Java (0.18.1)\r\n - Java Extension Pack (0.7.1)\r\n - Language Support for Java (0.47.0)\r\n - Visual Studio IntelliCode (1.1.8)","title":"Java Project in VS-Code, &quot;No delegateCommandHandler for vscode.java.validateLaunchConfig&quot; Error","body":"<p>I'm new to Java in Visual Studio Code and trying to implement small application, which is using our SDK, which is located in our internal Git Repository.</p>\n\n<p>When trying to Debug my application I get following Error:</p>\n\n<blockquote>\n  <p>No delegateCommandHandler for vscode.java.validateLaunchConfig</p>\n</blockquote>\n\n<p>My Configurationfile looks pretty simple:</p>\n\n<pre><code>{\n    \"configurations\": [\n\n        {\n            \"type\": \"java\",\n            \"name\": \"CodeLens (Launch) - App\",\n            \"request\": \"launch\",\n            \"mainClass\": \"com.my.first.class\",\n            \"projectName\": \"dummyproject\"\n        }\n    ]\n}\n</code></pre>\n\n<p>I'm using following Extensions for Visual Studio Code:</p>\n\n<ul>\n<li>Debugger for Java (0.20.0)</li>\n<li>Gitlens (9.9.0)</li>\n<li>Java Dependency Viewer (0.5.1)</li>\n<li>Java Test Runner (0.18.1)</li>\n<li>Maven for Java (0.18.1)</li>\n<li>Java Extension Pack (0.7.1)</li>\n<li>Language Support for Java (0.47.0)</li>\n<li>Visual Studio IntelliCode (1.1.8)</li>\n</ul>\n"},{"tags":["java","c++","java-native-interface"],"owner":{"account_id":28033958,"reputation":1,"user_id":21412686,"display_name":"Zaitsev Ilya"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":46,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"closed_date":1681028914,"answer_count":0,"score":0,"last_activity_date":1681029006,"creation_date":1681028389,"question_id":75969458,"body_markdown":"I tried starting a new activity from C++ with help of JNI and it was started successfully. But now I need to get result of the started Activity.\r\n\r\nStarting activity:\r\n```\r\njobject activity = helper-&gt;GetActivity();\r\njclass activity_class = env-&gt;GetObjectClass(activity);\r\n\r\njclass class_intent = env-&gt;FindClass(&quot;android/content/Intent&quot;);\r\njmethodID newIntent = env-&gt;GetMethodID(class_intent, &quot;&lt;init&gt;&quot;, &quot;()V&quot;);\r\njobject intent = env-&gt;NewObject(class_intent, newIntent);\r\n\r\njmethodID startActivityMethod = env-&gt;GetMethodID(activity_class, &quot;startActivityForResult&quot;, &quot;(Landroid/content/Intent;I)V&quot;);\r\n\r\njint callid = (jint)  1001;\r\nenv-&gt;CallVoidMethod(activity, startActivityMethod, intent, callid);\r\n```\r\n\r\nSo, i understand that Java calls &quot;onActivityResult&quot; function, but i don&#39;t understand how to override this function in C++ using JNI.\r\n\r\nOr may be there are some other ways to take result of started activity?\r\n\r\nI tried to get result with help of JNI function:\r\n\r\n\r\n```\r\nextern &quot;C&quot; JNIEXPORT void JNICALL Java_package_class_onActivityResult(JNIEnv * env, jobject, jobject activity, jint requestCode, jint resultCode, jobject intentObject) {\r\n    Logger::Instance().LogInfo(L&quot;Java_package_class_onActivityResult&quot;);\r\n}\r\n```\r\nBut this function has not called (mb not overridden?)\r\n\r\nAlso I tried to call a new function create\r\n\r\nC++ Code:\r\n```\r\nextern &quot;C&quot; JNIEXPORT void JNICALL Java_iboxPro1C_iboxProActivity_nativeActivityResult(JNIEnv* env, jobject obj, jobject data) {\r\n\r\n    Logger::Instance().LogInfo(L&quot;&gt;&gt;&gt;JNIEnv.Java_iboxPro1C_iboxProActivity_onActivityResult&quot;);\r\n    Logger::Instance().LogInfo(L&quot;&lt;&lt;&lt;JNIEnv.Java_iboxPro1C_iboxProActivity_onActivityResult&quot;);\r\n\r\n}\r\n```\r\n\r\nJava Code:\r\n\r\n```\r\npublic class myActivity extends AppCompatActivity implements PaymentControllerListener {\r\n    static native void nativeActivityResult(Intent data);\r\n    \r\n    //called when activity have to be finished.\r\n    public void FinishActivity(boolean success, Intent intent) {\r\n        Log(&quot;FinishActivity&quot;);\r\n        setResult(success ? RESULT_OK : RESULT_CANCELED, intent);\r\n        if (mService != null)\r\n            mService.stopSelf();\r\n        try {\r\n            nativeActivityResult(intent);\r\n            Log(&quot;nativeActivityResult NO exception.&quot;);\r\n        }catch(Exception exc){\r\n            Log(&quot;nativeActivityResult exception.&quot;);\r\n            Log(exc.toString());\r\n        }\r\n\r\n        finish();\r\n    }\r\n}\r\n```\r\nProcess just crash while FinishActivity (it isn&#39;t log anything).\r\n","title":"JNI C++ Callback from started activity","body":"<p>I tried starting a new activity from C++ with help of JNI and it was started successfully. But now I need to get result of the started Activity.</p>\n<p>Starting activity:</p>\n<pre><code>jobject activity = helper-&gt;GetActivity();\njclass activity_class = env-&gt;GetObjectClass(activity);\n\njclass class_intent = env-&gt;FindClass(&quot;android/content/Intent&quot;);\njmethodID newIntent = env-&gt;GetMethodID(class_intent, &quot;&lt;init&gt;&quot;, &quot;()V&quot;);\njobject intent = env-&gt;NewObject(class_intent, newIntent);\n\njmethodID startActivityMethod = env-&gt;GetMethodID(activity_class, &quot;startActivityForResult&quot;, &quot;(Landroid/content/Intent;I)V&quot;);\n\njint callid = (jint)  1001;\nenv-&gt;CallVoidMethod(activity, startActivityMethod, intent, callid);\n</code></pre>\n<p>So, i understand that Java calls &quot;onActivityResult&quot; function, but i don't understand how to override this function in C++ using JNI.</p>\n<p>Or may be there are some other ways to take result of started activity?</p>\n<p>I tried to get result with help of JNI function:</p>\n<pre><code>extern &quot;C&quot; JNIEXPORT void JNICALL Java_package_class_onActivityResult(JNIEnv * env, jobject, jobject activity, jint requestCode, jint resultCode, jobject intentObject) {\n    Logger::Instance().LogInfo(L&quot;Java_package_class_onActivityResult&quot;);\n}\n</code></pre>\n<p>But this function has not called (mb not overridden?)</p>\n<p>Also I tried to call a new function create</p>\n<p>C++ Code:</p>\n<pre><code>extern &quot;C&quot; JNIEXPORT void JNICALL Java_iboxPro1C_iboxProActivity_nativeActivityResult(JNIEnv* env, jobject obj, jobject data) {\n\n    Logger::Instance().LogInfo(L&quot;&gt;&gt;&gt;JNIEnv.Java_iboxPro1C_iboxProActivity_onActivityResult&quot;);\n    Logger::Instance().LogInfo(L&quot;&lt;&lt;&lt;JNIEnv.Java_iboxPro1C_iboxProActivity_onActivityResult&quot;);\n\n}\n</code></pre>\n<p>Java Code:</p>\n<pre><code>public class myActivity extends AppCompatActivity implements PaymentControllerListener {\n    static native void nativeActivityResult(Intent data);\n    \n    //called when activity have to be finished.\n    public void FinishActivity(boolean success, Intent intent) {\n        Log(&quot;FinishActivity&quot;);\n        setResult(success ? RESULT_OK : RESULT_CANCELED, intent);\n        if (mService != null)\n            mService.stopSelf();\n        try {\n            nativeActivityResult(intent);\n            Log(&quot;nativeActivityResult NO exception.&quot;);\n        }catch(Exception exc){\n            Log(&quot;nativeActivityResult exception.&quot;);\n            Log(exc.toString());\n        }\n\n        finish();\n    }\n}\n</code></pre>\n<p>Process just crash while FinishActivity (it isn't log anything).</p>\n"},{"tags":["java","spring","spring-boot"],"comments":[{"owner":{"account_id":9865473,"reputation":67,"user_id":7307093,"display_name":"pbuzulan"},"score":1,"creation_date":1551953920,"post_id":55041244,"comment_id":96833491,"body_markdown":"Check this duplicated [post](https://stackoverflow.com/questions/21083170/how-to-configure-port-for-a-spring-boot-application)\nYou can do it via application.properties","body":"Check this duplicated <a href=\"https://stackoverflow.com/questions/21083170/how-to-configure-port-for-a-spring-boot-application\">post</a> You can do it via application.properties"},{"owner":{"account_id":15476185,"reputation":83,"user_id":11164784,"display_name":"Alessio Pascucci"},"score":1,"creation_date":1551954058,"post_id":55041244,"comment_id":96833587,"body_markdown":"I&#39;ve seen that but i need to put one service in 8080 and another in 8081 with the same application","body":"I&#39;ve seen that but i need to put one service in 8080 and another in 8081 with the same application"},{"owner":{"account_id":2162777,"reputation":4478,"user_id":4536811,"display_name":"Mickael"},"score":1,"creation_date":1551954093,"post_id":55041244,"comment_id":96833607,"body_markdown":"Possible duplicate of [How to configure port for a Spring Boot application](https://stackoverflow.com/questions/21083170/how-to-configure-port-for-a-spring-boot-application)","body":"Possible duplicate of <a href=\"https://stackoverflow.com/questions/21083170/how-to-configure-port-for-a-spring-boot-application\">How to configure port for a Spring Boot application</a>"},{"owner":{"account_id":1967946,"reputation":121,"user_id":1767676,"display_name":"Karmakulov Kirill"},"score":1,"creation_date":1631698499,"post_id":55041244,"comment_id":122290458,"body_markdown":"It is discussed here: https://stackoverflow.com/questions/36357135/configure-spring-boot-with-two-ports/69190413","body":"It is discussed here: <a href=\"https://stackoverflow.com/questions/36357135/configure-spring-boot-with-two-ports/69190413\" title=\"configure spring boot with two ports\">stackoverflow.com/questions/36357135/&hellip;</a>"}],"answers":[{"comments":[{"owner":{"account_id":15476185,"reputation":83,"user_id":11164784,"display_name":"Alessio Pascucci"},"score":0,"creation_date":1551955205,"post_id":55041311,"comment_id":96834339,"body_markdown":"So, if i need to access two different ports i need to run the application on two server placed on two different ports?","body":"So, if i need to access two different ports i need to run the application on two server placed on two different ports?"},{"owner":{"account_id":5559956,"reputation":13829,"user_id":9840318,"display_name":"Madhu Bhat"},"score":1,"creation_date":1551956757,"post_id":55041311,"comment_id":96835326,"body_markdown":"@AlessioPascucci in case you must have two services on different ports, you need to run it as two different applications, each with it&#39;s own different port.","body":"@AlessioPascucci in case you must have two services on different ports, you need to run it as two different applications, each with it&#39;s own different port."}],"tags":[],"owner":{"account_id":5559956,"reputation":13829,"user_id":9840318,"display_name":"Madhu Bhat"},"comment_count":2,"down_vote_count":1,"up_vote_count":0,"is_accepted":false,"score":-1,"last_activity_date":1551962802,"creation_date":1551953935,"answer_id":55041311,"question_id":55041244,"body_markdown":"The port can be defined on the `application.properties` or the `application.yaml` configuration file that you use.\r\n\r\nIn `application.properties` file, define it as below:\r\n\r\n    server.port=8090\r\n\r\nOr in case you are using a `application.yaml` config, define it as below:\r\n\r\n    server:\r\n    \tport: 8090\r\n","title":"Spring boot application with two services on two different ports","body":"<p>The port can be defined on the <code>application.properties</code> or the <code>application.yaml</code> configuration file that you use.</p>\n\n<p>In <code>application.properties</code> file, define it as below:</p>\n\n<pre><code>server.port=8090\n</code></pre>\n\n<p>Or in case you are using a <code>application.yaml</code> config, define it as below:</p>\n\n<pre><code>server:\n    port: 8090\n</code></pre>\n"},{"tags":[],"owner":{"account_id":14996604,"reputation":482,"user_id":10825746,"display_name":"vivekdubey"},"comment_count":0,"down_vote_count":3,"up_vote_count":0,"is_accepted":false,"score":-3,"last_activity_date":1551953997,"creation_date":1551953997,"answer_id":55041334,"question_id":55041244,"body_markdown":"you can write below line in application.properties or application.yml\r\n\r\n\r\nserver.port=8080","title":"Spring boot application with two services on two different ports","body":"<p>you can write below line in application.properties or application.yml</p>\n\n<p>server.port=8080</p>\n"},{"tags":[],"owner":{"account_id":1215015,"reputation":140,"user_id":1863534,"display_name":"Emin Javadov"},"comment_count":0,"down_vote_count":3,"up_vote_count":0,"is_accepted":false,"score":-3,"last_activity_date":1551954211,"creation_date":1551954211,"answer_id":55041417,"question_id":55041244,"body_markdown":"Sure. You can do it in the application.properties file of spring boot project via setting server.port=number for each service.","title":"Spring boot application with two services on two different ports","body":"<p>Sure. You can do it in the application.properties file of spring boot project via setting server.port=number for each service.</p>\n"},{"comments":[{"owner":{"account_id":9845313,"reputation":105,"user_id":7293057,"display_name":"Manohar Bhat"},"score":1,"creation_date":1679516489,"post_id":55042622,"comment_id":133738131,"body_markdown":"from this [baeldung article](https://www.baeldung.com/spring-boot-context-hierarchy), it seems to be possible to do, using SpringApplicationBuilder API. I have added it as answer also.","body":"from this <a href=\"https://www.baeldung.com/spring-boot-context-hierarchy\" rel=\"nofollow noreferrer\">baeldung article</a>, it seems to be possible to do, using SpringApplicationBuilder API. I have added it as answer also."}],"tags":[],"owner":{"account_id":2126013,"reputation":384,"user_id":1888159,"accept_rate":0,"display_name":"Pearl"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1551957745,"creation_date":1551957745,"answer_id":55042622,"question_id":55041244,"body_markdown":"You can&#39;t run two different services under the same spring boot application in two different ports. If you want you can move one service to another spring boot application.\r\nBut port number will not be same for both services.","title":"Spring boot application with two services on two different ports","body":"<p>You can't run two different services under the same spring boot application in two different ports. If you want you can move one service to another spring boot application.\nBut port number will not be same for both services.</p>\n"},{"comments":[{"owner":{"account_id":15476185,"reputation":83,"user_id":11164784,"display_name":"Alessio Pascucci"},"score":1,"creation_date":1551969745,"post_id":55043430,"comment_id":96843198,"body_markdown":"But this need to run two different application onto two different ports?","body":"But this need to run two different application onto two different ports?"}],"tags":[],"owner":{"account_id":8503655,"reputation":1414,"user_id":6375917,"display_name":"TongChen"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1551960527,"creation_date":1551960527,"answer_id":55043430,"question_id":55041244,"body_markdown":"you can configure SprintBoot support two ports.The common method configure is use `application.properties` or the `application.yaml` as @Madhu Bhat answer. In SprintBoot to configure another port code like this:\r\n\r\ncreate a connector\r\n\r\n            int port = Integer.parseInt(probePort);\r\n            Connector httpConnector = new Connector(HTTP_PROTOCOL);\r\n            httpConnector.setPort(port);\r\n            Http11NioProtocol handler = (Http11NioProtocol) httpConnector.getProtocolHandler();\r\n            handler.setMaxThreads(10);\r\n            handler.setMinSpareThreads(4);\r\n            //handler.setAddress(InetAddress.getLocalHost());\r\n            handler.setAddress(StringTool.getInetAddress());\r\n            return httpConnector;\r\n\r\nconfigure connector to \r\n\r\n    ((TomcatEmbeddedServletContainerFactory) container).addAdditionalTomcatConnectors(connector);","title":"Spring boot application with two services on two different ports","body":"<p>you can configure SprintBoot support two ports.The common method configure is use <code>application.properties</code> or the <code>application.yaml</code> as @Madhu Bhat answer. In SprintBoot to configure another port code like this:</p>\n\n<p>create a connector</p>\n\n<pre><code>        int port = Integer.parseInt(probePort);\n        Connector httpConnector = new Connector(HTTP_PROTOCOL);\n        httpConnector.setPort(port);\n        Http11NioProtocol handler = (Http11NioProtocol) httpConnector.getProtocolHandler();\n        handler.setMaxThreads(10);\n        handler.setMinSpareThreads(4);\n        //handler.setAddress(InetAddress.getLocalHost());\n        handler.setAddress(StringTool.getInetAddress());\n        return httpConnector;\n</code></pre>\n\n<p>configure connector to </p>\n\n<pre><code>((TomcatEmbeddedServletContainerFactory) container).addAdditionalTomcatConnectors(connector);\n</code></pre>\n"},{"tags":[],"owner":{"account_id":17592216,"reputation":346,"user_id":12763842,"display_name":"Mateusz Niedbal"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1617747744,"creation_date":1617747744,"answer_id":66977219,"question_id":55041244,"body_markdown":"If you use Docker (most common solution), you can add the port or its full address as an Environment Variable\r\n\r\n`docker-compose.yml` file like this:\r\n\r\n    application1:\r\n        image: &#39;application1:latest&#39;\r\n        build:\r\n          context: ./\r\n        container_name: application\r\n        environment:\r\n          - HOST-APP2=localhost:8082\r\n        ports:\r\n          - 8091:8080\r\n    \r\n    application2:\r\n        image: &#39;application2:latest&#39;\r\n        build:\r\n          context: ./\r\n        container_name: application\r\n        environment:\r\n          - HOST-APP1=localhost:8081\r\n        ports:\r\n          - 8092:8080\r\n\r\nor straight in the Dockerfile while building containers\r\n\r\ncheck out here : [https://vsupalov.com/docker-arg-env-variable-guide/][1]\r\nit&#39;s a good article\r\n\r\n\r\n  [1]: https://vsupalov.com/docker-arg-env-variable-guide/","title":"Spring boot application with two services on two different ports","body":"<p>If you use Docker (most common solution), you can add the port or its full address as an Environment Variable</p>\n<p><code>docker-compose.yml</code> file like this:</p>\n<pre><code>application1:\n    image: 'application1:latest'\n    build:\n      context: ./\n    container_name: application\n    environment:\n      - HOST-APP2=localhost:8082\n    ports:\n      - 8091:8080\n\napplication2:\n    image: 'application2:latest'\n    build:\n      context: ./\n    container_name: application\n    environment:\n      - HOST-APP1=localhost:8081\n    ports:\n      - 8092:8080\n</code></pre>\n<p>or straight in the Dockerfile while building containers</p>\n<p>check out here : <a href=\"https://vsupalov.com/docker-arg-env-variable-guide/\" rel=\"nofollow noreferrer\">https://vsupalov.com/docker-arg-env-variable-guide/</a>\nit's a good article</p>\n"},{"tags":[],"owner":{"account_id":9845313,"reputation":105,"user_id":7293057,"display_name":"Manohar Bhat"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1679516401,"creation_date":1679516401,"answer_id":75816932,"question_id":55041244,"body_markdown":"I have not tried this, but from this [baeldung article](https://www.baeldung.com/spring-boot-context-hierarchy), it seems to be possible using SpringApplicationBuilder API.\r\n\r\nIn summary, following are the high level steps\r\n- Create 2 properties file with different ports. Refer [github repo](https://github.com/eugenp/tutorials/tree/master/spring-boot-modules/spring-boot-ctx-fluent/src/main/resources) from article.\r\n- Create 2 separate configurations by injecting these properties file.\r\n- Use SpringApplicationBuilder to create parent, child or sibling context hierarchy.","title":"Spring boot application with two services on two different ports","body":"<p>I have not tried this, but from this <a href=\"https://www.baeldung.com/spring-boot-context-hierarchy\" rel=\"nofollow noreferrer\">baeldung article</a>, it seems to be possible using SpringApplicationBuilder API.</p>\n<p>In summary, following are the high level steps</p>\n<ul>\n<li>Create 2 properties file with different ports. Refer <a href=\"https://github.com/eugenp/tutorials/tree/master/spring-boot-modules/spring-boot-ctx-fluent/src/main/resources\" rel=\"nofollow noreferrer\">github repo</a> from article.</li>\n<li>Create 2 separate configurations by injecting these properties file.</li>\n<li>Use SpringApplicationBuilder to create parent, child or sibling context hierarchy.</li>\n</ul>\n"},{"comments":[{"owner":{"account_id":1435254,"reputation":29439,"user_id":4826457,"display_name":"Suraj Rao"},"score":0,"creation_date":1680940483,"post_id":75963885,"comment_id":133982082,"body_markdown":"Please add code and data as text ([using code formatting](/editing-help#code)), not images. Images: A) don&#39;t allow us to copy-&amp;-paste the code/errors/data for testing; B) don&#39;t permit searching based on the code/error/data contents; and [many more reasons](//meta.stackoverflow.com/a/285557). Images should only be used, in addition to text in code format, if having the image adds something significant that is not conveyed by just the text code/error/data.","body":"Please add code and data as text (<a href=\"/editing-help#code\">using code formatting</a>), not images. Images: A) don&#39;t allow us to copy-&amp;-paste the code/errors/data for testing; B) don&#39;t permit searching based on the code/error/data contents; and <a href=\"//meta.stackoverflow.com/a/285557\">many more reasons</a>. Images should only be used, in addition to text in code format, if having the image adds something significant that is not conveyed by just the text code/error/data."}],"tags":[],"owner":{"account_id":8281147,"reputation":420,"user_id":6225803,"display_name":"krishna T"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681028542,"creation_date":1680938872,"answer_id":75963885,"question_id":55041244,"body_markdown":"You can create two different child application context&#39;s in single application and run two different ports with different services on those ports.\r\nReference : https://www.baeldung.com/spring-boot-context-hierarchy\r\n\r\nFollowing is a sample I used in one of my application.\r\n\r\nMain Class of parent context.\r\n\r\n    package com.kst.gateway;\r\n    \r\n    import org.springframework.boot.WebApplicationType;\r\n    import org.springframework.boot.builder.SpringApplicationBuilder;\r\n    \r\n    import com.kst.gateway.inbound.InboundConfig;\r\n    import com.kst.gateway.outbound.OutboundConfig;\r\n    \r\n    //@formatter:off\r\n    public class GatewayApplication {\r\n    \r\n    \tpublic static void main(String[] args) {\r\n    \t\tnew SpringApplicationBuilder()\r\n    \t\t.parent(GatewayConfig.class)\r\n            .web(WebApplicationType.NONE)\r\n            .child(OutboundConfig.class)\r\n            .web(WebApplicationType.REACTIVE)\r\n            .sibling(InboundConfig.class)\r\n            .web(WebApplicationType.REACTIVE)\r\n            .run(args);\r\n    \t}\r\n    }\r\n\r\nChild 1 Configuration :\r\n\r\n    package com.kst.gateway.inbound;\r\n    \r\n    @Configuration\r\n    @ComponentScan(&quot;com.kst.gateway.inbound&quot;)\r\n    @PropertySource(&quot;classpath:inbound.properties&quot;)\r\n    @EnableAutoConfiguration\r\n    public class InboundConfig {\r\n    \t\r\n    \t@Autowired\r\n    \tpublic GatewayConfig config;\r\n    \t\r\n    \t@Value(&quot;${server.port}&quot;)\r\n    \tpublic Integer serverPort;\r\n    \t\r\n    \t@Bean(name = &quot;issuer_routes&quot;)\r\n    \tpublic RouteLocator routes(RouteLocatorBuilder routeLocatorBuilder) {\r\n    \t\tString issuerUri = config.switchDestinationScheme+&quot;://&quot;+config.switchDestinationIp+&quot;:&quot;+config.switchDestinationPort;\r\n    \t\treturn routeLocatorBuilder.routes()\r\n    \t\t\t.route(&quot;issuer_request&quot;, routeSpec -&gt; routeSpec\r\n    \t\t\t\t.remoteAddr(config.npciSourceIps.toArray(new String[0]))\r\n    \t\t\t\t.and().path(&quot;/Req**&quot;)\r\n    \t\t\t\t.uri(issuerUri)\r\n    \t\t\t).route(&quot;acquirer_response&quot;, routeSpec -&gt; routeSpec\r\n    \t\t\t\t.remoteAddr(config.npciSourceIps.toArray(new String[0]))\r\n    \t\t\t\t.and().path(&quot;/Resp**&quot;)\r\n    \t\t\t\t.uri(issuerUri)\r\n    \t\t\t).build();\r\n    \t}\r\n    }\r\n\r\nChild 2 configuration :\r\n\r\n    package com.kst.gateway.outbound;\r\n    \r\n    @Configuration\r\n    @ComponentScan(&quot;com.kst.gateway.outbound&quot;)\r\n    @PropertySource(&quot;classpath:outbound.properties&quot;)\r\n    @EnableAutoConfiguration\r\n    public class OutboundConfig {\r\n    \r\n    \t@Autowired\r\n    \tpublic GatewayConfig config;\r\n    \t\r\n    \t@Autowired\r\n    \tpublic OutboundRequestUrlFilter acqReqUrlFilter;\r\n    \t\r\n    \t@Autowired\r\n    \tpublic OutboundResponseUrlFilter acqRespUrlFilter;\r\n    \t\r\n    \t@Value(&quot;${server.port}&quot;)\r\n    \tpublic Integer serverPort;\r\n    \t\r\n    \t@Bean(name = &quot;acquirer_routes&quot;)\r\n    \tpublic RouteLocator routes(RouteLocatorBuilder routeLocatorBuilder, NpciEndpointProvider npciEndpointProvider) {\r\n    \t\treturn routeLocatorBuilder.routes()\r\n    \t\t\t.route(&quot;acquirer_request&quot;, routeSpec -&gt; routeSpec\r\n    \t\t\t\t.remoteAddr(config.switchSourceIps.toArray(new String[0]))\r\n    \t\t\t\t.and().path(&quot;/Req**&quot;)\r\n    \t\t\t\t.filters(fs -&gt; fs.filter(acqReqUrlFilter.apply(npciEndpointProvider)))\r\n    \t\t\t\t.uri(&quot;no:/op&quot;)\r\n    \t\t\t).route(&quot;issuer_response&quot;, routeSpec -&gt; routeSpec\r\n    \t\t\t\t.remoteAddr(config.switchSourceIps.toArray(new String[0]))\r\n    \t\t\t\t.and().path(&quot;/Resp**&quot;)\r\n    \t\t\t\t.filters(fs -&gt; fs.filter(acqRespUrlFilter.apply(npciEndpointProvider)))\r\n    \t\t\t\t.uri(&quot;no:/op&quot;)\r\n    \t\t\t)\r\n    \t\t\t.build();\r\n    \t}\r\n    }\r\n\r\n\r\nParent application.properties which will be inherited by both the child context&#39;s\r\n\r\n    spring.application.name=gateway\r\n    server.ssl.key-store=classpath:ssl.pfx\r\n    server.ssl.key-store-password=Ippb@2023\r\n    server.ssl.key-store-type=pkcs12\r\n    server.ssl.key-alias=ssl\r\n    spring.cloud.gateway.httpclient.ssl.use-insecure-trust-manager=true\r\n    spring.cloud.service-registry.auto-registration.enabled=false\r\n    spring.cloud.discovery.enabled=false\r\n    spring.cloud.config.discovery.enabled=false\r\n\r\nChild 1 inbound.properties file\r\n\r\n    spring.application.name=inbound\r\n    server.port=8443\r\nChild 2 outbound.properties file\r\n\r\n    spring.application.name=outbound\r\n    server.port=443","title":"Spring boot application with two services on two different ports","body":"<p>You can create two different child application context's in single application and run two different ports with different services on those ports.\nReference : <a href=\"https://www.baeldung.com/spring-boot-context-hierarchy\" rel=\"nofollow noreferrer\">https://www.baeldung.com/spring-boot-context-hierarchy</a></p>\n<p>Following is a sample I used in one of my application.</p>\n<p>Main Class of parent context.</p>\n<pre><code>package com.kst.gateway;\n\nimport org.springframework.boot.WebApplicationType;\nimport org.springframework.boot.builder.SpringApplicationBuilder;\n\nimport com.kst.gateway.inbound.InboundConfig;\nimport com.kst.gateway.outbound.OutboundConfig;\n\n//@formatter:off\npublic class GatewayApplication {\n\n    public static void main(String[] args) {\n        new SpringApplicationBuilder()\n        .parent(GatewayConfig.class)\n        .web(WebApplicationType.NONE)\n        .child(OutboundConfig.class)\n        .web(WebApplicationType.REACTIVE)\n        .sibling(InboundConfig.class)\n        .web(WebApplicationType.REACTIVE)\n        .run(args);\n    }\n}\n</code></pre>\n<p>Child 1 Configuration :</p>\n<pre><code>package com.kst.gateway.inbound;\n\n@Configuration\n@ComponentScan(&quot;com.kst.gateway.inbound&quot;)\n@PropertySource(&quot;classpath:inbound.properties&quot;)\n@EnableAutoConfiguration\npublic class InboundConfig {\n    \n    @Autowired\n    public GatewayConfig config;\n    \n    @Value(&quot;${server.port}&quot;)\n    public Integer serverPort;\n    \n    @Bean(name = &quot;issuer_routes&quot;)\n    public RouteLocator routes(RouteLocatorBuilder routeLocatorBuilder) {\n        String issuerUri = config.switchDestinationScheme+&quot;://&quot;+config.switchDestinationIp+&quot;:&quot;+config.switchDestinationPort;\n        return routeLocatorBuilder.routes()\n            .route(&quot;issuer_request&quot;, routeSpec -&gt; routeSpec\n                .remoteAddr(config.npciSourceIps.toArray(new String[0]))\n                .and().path(&quot;/Req**&quot;)\n                .uri(issuerUri)\n            ).route(&quot;acquirer_response&quot;, routeSpec -&gt; routeSpec\n                .remoteAddr(config.npciSourceIps.toArray(new String[0]))\n                .and().path(&quot;/Resp**&quot;)\n                .uri(issuerUri)\n            ).build();\n    }\n}\n</code></pre>\n<p>Child 2 configuration :</p>\n<pre><code>package com.kst.gateway.outbound;\n\n@Configuration\n@ComponentScan(&quot;com.kst.gateway.outbound&quot;)\n@PropertySource(&quot;classpath:outbound.properties&quot;)\n@EnableAutoConfiguration\npublic class OutboundConfig {\n\n    @Autowired\n    public GatewayConfig config;\n    \n    @Autowired\n    public OutboundRequestUrlFilter acqReqUrlFilter;\n    \n    @Autowired\n    public OutboundResponseUrlFilter acqRespUrlFilter;\n    \n    @Value(&quot;${server.port}&quot;)\n    public Integer serverPort;\n    \n    @Bean(name = &quot;acquirer_routes&quot;)\n    public RouteLocator routes(RouteLocatorBuilder routeLocatorBuilder, NpciEndpointProvider npciEndpointProvider) {\n        return routeLocatorBuilder.routes()\n            .route(&quot;acquirer_request&quot;, routeSpec -&gt; routeSpec\n                .remoteAddr(config.switchSourceIps.toArray(new String[0]))\n                .and().path(&quot;/Req**&quot;)\n                .filters(fs -&gt; fs.filter(acqReqUrlFilter.apply(npciEndpointProvider)))\n                .uri(&quot;no:/op&quot;)\n            ).route(&quot;issuer_response&quot;, routeSpec -&gt; routeSpec\n                .remoteAddr(config.switchSourceIps.toArray(new String[0]))\n                .and().path(&quot;/Resp**&quot;)\n                .filters(fs -&gt; fs.filter(acqRespUrlFilter.apply(npciEndpointProvider)))\n                .uri(&quot;no:/op&quot;)\n            )\n            .build();\n    }\n}\n</code></pre>\n<p>Parent application.properties which will be inherited by both the child context's</p>\n<pre><code>spring.application.name=gateway\nserver.ssl.key-store=classpath:ssl.pfx\nserver.ssl.key-store-password=Ippb@2023\nserver.ssl.key-store-type=pkcs12\nserver.ssl.key-alias=ssl\nspring.cloud.gateway.httpclient.ssl.use-insecure-trust-manager=true\nspring.cloud.service-registry.auto-registration.enabled=false\nspring.cloud.discovery.enabled=false\nspring.cloud.config.discovery.enabled=false\n</code></pre>\n<p>Child 1 inbound.properties file</p>\n<pre><code>spring.application.name=inbound\nserver.port=8443\n</code></pre>\n<p>Child 2 outbound.properties file</p>\n<pre><code>spring.application.name=outbound\nserver.port=443\n</code></pre>\n"}],"owner":{"account_id":15476185,"reputation":83,"user_id":11164784,"display_name":"Alessio Pascucci"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":6829,"favorite_count":0,"down_vote_count":0,"up_vote_count":3,"accepted_answer_id":55042622,"answer_count":8,"score":3,"last_activity_date":1681028542,"creation_date":1551953733,"question_id":55041244,"body_markdown":"I have a spring boot application with two services but i need to run one on port 8080 and the other on 8081. Now i&#39;m developing with sts (Spring tool suite) and i run the application with the option &quot;Run as spring boot app&quot;, so i don&#39;t know where change server configurations. Someone can help me?\r\n","title":"Spring boot application with two services on two different ports","body":"<p>I have a spring boot application with two services but i need to run one on port 8080 and the other on 8081. Now i'm developing with sts (Spring tool suite) and i run the application with the option \"Run as spring boot app\", so i don't know where change server configurations. Someone can help me?</p>\n"},{"tags":["java","fingerprint","biometrics"],"comments":[{"owner":{"account_id":5778425,"reputation":7525,"user_id":4559849,"accept_rate":67,"display_name":"LaurentY"},"score":0,"creation_date":1559738093,"post_id":56432110,"comment_id":99512552,"body_markdown":"Please share more info: SDK used, code","body":"Please share more info: SDK used, code"}],"answers":[{"comments":[{"owner":{"account_id":10901166,"reputation":117,"user_id":8013393,"display_name":"Eidris"},"score":0,"creation_date":1559826958,"post_id":56460630,"comment_id":99547118,"body_markdown":"Work like charm using SDK v2.3, although i was using SDK v1.6 when i wrote this post.","body":"Work like charm using SDK v2.3, although i was using SDK v1.6 when i wrote this post."}],"tags":[],"owner":{"account_id":5778425,"reputation":7525,"user_id":4559849,"accept_rate":67,"display_name":"LaurentY"},"comment_count":1,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1559829979,"creation_date":1559738231,"answer_id":56460630,"question_id":56432110,"body_markdown":"Missing code from you, but maybe you could try something like this:\r\n\r\n    Fmd fmd = UareUGlobal.GetEngine().CreateFmd(fid, \r\n             Fid.Format.ANSI_381_2004);","title":"How to set uareu digitalpersona fingerprint format to ansi378-2004 or ISO19794-2005","body":"<p>Missing code from you, but maybe you could try something like this:</p>\n\n<pre><code>Fmd fmd = UareUGlobal.GetEngine().CreateFmd(fid, \n         Fid.Format.ANSI_381_2004);\n</code></pre>\n"}],"owner":{"account_id":10901166,"reputation":117,"user_id":8013393,"display_name":"Eidris"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":397,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":56460630,"answer_count":1,"score":1,"last_activity_date":1681028293,"creation_date":1559583482,"question_id":56432110,"body_markdown":"I&#39;m new to fingerprint implementation and am working on a project that requires the use of biometrics of which I chose the DigitalPersona fingerprint devices.\r\n\r\nI tested with their sample code for java and everything seem to work, but I need the fingerprint templates in ANSI 378 standard format which the device is said to support.\r\n\r\nHow can I do this? The fingerprint device is uareu 4500.","title":"How to set uareu digitalpersona fingerprint format to ansi378-2004 or ISO19794-2005","body":"<p>I'm new to fingerprint implementation and am working on a project that requires the use of biometrics of which I chose the DigitalPersona fingerprint devices.</p>\n<p>I tested with their sample code for java and everything seem to work, but I need the fingerprint templates in ANSI 378 standard format which the device is said to support.</p>\n<p>How can I do this? The fingerprint device is uareu 4500.</p>\n"},{"tags":["java","date","datetime","timezone","utc"],"comments":[{"owner":{"account_id":1056871,"reputation":117749,"user_id":1059372,"accept_rate":97,"display_name":"Eugene"},"score":0,"creation_date":1611351398,"post_id":65853063,"comment_id":116433458,"body_markdown":"what happens when you do `System.out.println(Instant.now().toString())`?","body":"what happens when you do <code>System.out.println(Instant.now().toString())</code>?"},{"owner":{"account_id":7430214,"reputation":1253,"user_id":5651468,"accept_rate":100,"display_name":"Sandeep"},"score":0,"creation_date":1611351805,"post_id":65853063,"comment_id":116433593,"body_markdown":"@Eugene it gives the same output.","body":"@Eugene it gives the same output."},{"owner":{"account_id":5281408,"reputation":18797,"user_id":4216641,"display_name":"Turing85"},"score":1,"creation_date":1611351886,"post_id":65853063,"comment_id":116433610,"body_markdown":"There is something fishy... `MST` is `GMT-7` (`UTC-7`), not `GMT-6`.","body":"There is something fishy... <code>MST</code> is <code>GMT-7</code> (<code>UTC-7</code>), not <code>GMT-6</code>."},{"owner":{"account_id":1056871,"reputation":117749,"user_id":1059372,"accept_rate":97,"display_name":"Eugene"},"score":3,"creation_date":1611352577,"post_id":65853063,"comment_id":116433809,"body_markdown":"I guess what you are looking for is `System.out.println(Instant.now().atOffset(ZoneOffset.UTC))`","body":"I guess what you are looking for is <code>System.out.println(Instant.now().atOffset(ZoneOffset.UTC))</code>"},{"owner":{"account_id":2360785,"reputation":11123,"user_id":2067492,"display_name":"matt"},"score":0,"creation_date":1611352784,"post_id":65853063,"comment_id":116433875,"body_markdown":"Or maybe you want this? `System.out.println(Instant.now().atZone(ZoneId.of(&quot;UTC&quot;)));`","body":"Or maybe you want this? <code>System.out.println(Instant.now().atZone(ZoneId.of(&quot;UTC&quot;)));</code>"},{"owner":{"account_id":7612423,"reputation":82506,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1611512618,"post_id":65853063,"comment_id":116469929,"body_markdown":"Does this answer your question? [TimeZone problem …](https://stackoverflow.com/questions/1812700/timezone-problem-in-java). [This](https://stackoverflow.com/questions/16107898/simpledateformat-returns-wrong-time-zone-during-parse), [this](https://stackoverflow.com/questions/47307909/dateformat-parse-not-return-date-in-utc), [this](https://stackoverflow.com/questions/59671609/simpledateformat-with-timezone-displaying-dates-in-my-timezone-how-do-i-fix-thi) or [this](https://stackoverflow.com/questions/52475409/getting-the-current-time-millis-from-device-and-converting-it-into-a-new-date-wi)?","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/1812700/timezone-problem-in-java\">TimeZone problem …</a>. <a href=\"https://stackoverflow.com/questions/16107898/simpledateformat-returns-wrong-time-zone-during-parse\">This</a>, <a href=\"https://stackoverflow.com/questions/47307909/dateformat-parse-not-return-date-in-utc\">this</a>, <a href=\"https://stackoverflow.com/questions/59671609/simpledateformat-with-timezone-displaying-dates-in-my-timezone-how-do-i-fix-thi\">this</a> or <a href=\"https://stackoverflow.com/questions/52475409/getting-the-current-time-millis-from-device-and-converting-it-into-a-new-date-wi\">this</a>?"}],"answers":[{"tags":[],"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"comment_count":0,"down_vote_count":0,"up_vote_count":13,"is_accepted":true,"score":13,"last_activity_date":1611354039,"creation_date":1611352190,"answer_id":65853216,"question_id":65853063,"body_markdown":"Your code:\r\n\r\n    Date.from(Instant.now())\r\n\r\nYou are mixing the terrible legacy classes with their replacement, the modern *java.time* classes. \r\n\r\nDon’t. \r\n\r\nNever use `Date`. Certainly no need to mix with `java.time.Instant`.\r\n\r\nTo explain your particular example, understand that among the `Date` class’ many poor design choices is the anti-feature of its **`Date#toString` method implicitly applying the JVM’s current default time zone** while generating its text. \r\n\r\nYou ran your code on two different JVMs that had different current default time zones. So you got different outputs.\r\n\r\nSun, Oracle, and the JCP gave up on the legacy date-time classes. So should we all. I recommend you not spend time trying understand `Date`, `Calendar`, `SimpleDateFormat`, and such. \r\n\r\n\r\nYou asked:\r\n\r\n&gt; Question: How do we display the UTC timestamp in a Java program?\r\n\r\n\r\n    Instant.now().toString()\r\n\r\nSee that [code run live at IdeOne.com](https://ideone.com/B8CDdY).\r\n\r\n&gt; 2021-01-22T21:50:18.887335Z\r\n\r\nYou said:\r\n\r\n&gt; On Windows: …\r\n&gt;\r\n&gt;On Linux: …\r\n\r\nYou’ll get the same consistent results from `Instant.now().toString()` across Windows, Linux, BSD, macOS, iOS, Android, AIX, and so on.\r\n\r\n----- \r\nHere is a table I made to guide you in transitioning from the legacy classes. \r\n\r\n\r\n![enter image description here](https://i.stack.imgur.com/QPhGW.png)","title":"Getting the UTC timestamp","body":"<p>Your code:</p>\n<pre><code>Date.from(Instant.now())\n</code></pre>\n<p>You are mixing the terrible legacy classes with their replacement, the modern <em>java.time</em> classes.</p>\n<p>Don’t.</p>\n<p>Never use <code>Date</code>. Certainly no need to mix with <code>java.time.Instant</code>.</p>\n<p>To explain your particular example, understand that among the <code>Date</code> class’ many poor design choices is the anti-feature of its <strong><code>Date#toString</code> method implicitly applying the JVM’s current default time zone</strong> while generating its text.</p>\n<p>You ran your code on two different JVMs that had different current default time zones. So you got different outputs.</p>\n<p>Sun, Oracle, and the JCP gave up on the legacy date-time classes. So should we all. I recommend you not spend time trying understand <code>Date</code>, <code>Calendar</code>, <code>SimpleDateFormat</code>, and such.</p>\n<p>You asked:</p>\n<blockquote>\n<p>Question: How do we display the UTC timestamp in a Java program?</p>\n</blockquote>\n<pre><code>Instant.now().toString()\n</code></pre>\n<p>See that <a href=\"https://ideone.com/B8CDdY\" rel=\"noreferrer\">code run live at IdeOne.com</a>.</p>\n<blockquote>\n<p>2021-01-22T21:50:18.887335Z</p>\n</blockquote>\n<p>You said:</p>\n<blockquote>\n<p>On Windows: …</p>\n<p>On Linux: …</p>\n</blockquote>\n<p>You’ll get the same consistent results from <code>Instant.now().toString()</code> across Windows, Linux, BSD, macOS, iOS, Android, AIX, and so on.</p>\n<hr />\n<p>Here is a table I made to guide you in transitioning from the legacy classes.</p>\n<p><img src=\"https://i.stack.imgur.com/QPhGW.png\" alt=\"enter image description here\" /></p>\n"},{"tags":[],"owner":{"account_id":2179728,"reputation":73077,"user_id":10819573,"display_name":"Arvind Kumar Avinash"},"comment_count":0,"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1611352220,"creation_date":1611352220,"answer_id":65853220,"question_id":65853063,"body_markdown":"The `java.util.Date` object is not a real date-time object like the [modern date-time types](https://docs.oracle.com/javase/tutorial/datetime/iso/overview.html); rather, it represents the number of milliseconds since the standard base time known as &quot;the epoch&quot;, namely `January 1, 1970, 00:00:00 GMT` (or UTC). When you print an object of `java.util.Date`, its `toString` method returns the date-time in the JVM&#39;s timezone, calculated from this milliseconds value. If you need to print the date-time in a different timezone, you will need to set the timezone to `SimpleDateFormat` and obtain the formatted string from it.\r\n\r\nI would suggest you simply use `Instant.now()` which you can convert to other *java.time* type.\r\n\r\nThe date-time API of `java.util` and their formatting API, `SimpleDateFormat` are outdated and error-prone. It is recommended to stop using them completely and switch to the [modern date-time API](https://www.oracle.com/technical-resources/articles/java/jf14-date-time.html).\r\n  - For any reason, if you have to stick to Java 6 or Java 7, you can use [***ThreeTen-Backport***](http://www.threeten.org/threetenbp/) which backports most of the *java.time* functionality to Java 6 &amp; 7.\r\n  - If you are working for an Android project and your Android API level is still not compliant with Java-8, check [Java 8+ APIs available through desugaring](https://developer.android.com/studio/write/java8-support-table) and [How to use ThreeTenABP in Android Project](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project).\r\n\r\n\r\nHowever, if you still want to use `java.util.Date`, use `SimpleDateFormat` as mentioned above.\r\n\r\n**Demo:**\r\n\r\n    import java.text.SimpleDateFormat;\r\n    import java.time.Instant;\r\n    import java.util.Date;\r\n    import java.util.TimeZone;\r\n    \r\n    public class Main {\r\n    \tpublic static void main(String[] args) {\r\n    \t\tDate currentUtcTime = Date.from(Instant.now());\r\n    \t\tSimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss z&quot;);\r\n    \t\tsdf.setTimeZone(TimeZone.getTimeZone(&quot;Etc/UTC&quot;));\r\n    \t\tSystem.out.println(&quot;Current UTC time is &quot; + sdf.format(currentUtcTime));\r\n    \t}\r\n    }\r\n**Output:**\r\n\r\n    Current UTC time is 2021-01-22 21:53:07 UTC\r\n\r\n","title":"Getting the UTC timestamp","body":"<p>The <code>java.util.Date</code> object is not a real date-time object like the <a href=\"https://docs.oracle.com/javase/tutorial/datetime/iso/overview.html\" rel=\"noreferrer\">modern date-time types</a>; rather, it represents the number of milliseconds since the standard base time known as &quot;the epoch&quot;, namely <code>January 1, 1970, 00:00:00 GMT</code> (or UTC). When you print an object of <code>java.util.Date</code>, its <code>toString</code> method returns the date-time in the JVM's timezone, calculated from this milliseconds value. If you need to print the date-time in a different timezone, you will need to set the timezone to <code>SimpleDateFormat</code> and obtain the formatted string from it.</p>\n<p>I would suggest you simply use <code>Instant.now()</code> which you can convert to other <em>java.time</em> type.</p>\n<p>The date-time API of <code>java.util</code> and their formatting API, <code>SimpleDateFormat</code> are outdated and error-prone. It is recommended to stop using them completely and switch to the <a href=\"https://www.oracle.com/technical-resources/articles/java/jf14-date-time.html\" rel=\"noreferrer\">modern date-time API</a>.</p>\n<ul>\n<li>For any reason, if you have to stick to Java 6 or Java 7, you can use <a href=\"http://www.threeten.org/threetenbp/\" rel=\"noreferrer\"><em><strong>ThreeTen-Backport</strong></em></a> which backports most of the <em>java.time</em> functionality to Java 6 &amp; 7.</li>\n<li>If you are working for an Android project and your Android API level is still not compliant with Java-8, check <a href=\"https://developer.android.com/studio/write/java8-support-table\" rel=\"noreferrer\">Java 8+ APIs available through desugaring</a> and <a href=\"https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project\">How to use ThreeTenABP in Android Project</a>.</li>\n</ul>\n<p>However, if you still want to use <code>java.util.Date</code>, use <code>SimpleDateFormat</code> as mentioned above.</p>\n<p><strong>Demo:</strong></p>\n<pre><code>import java.text.SimpleDateFormat;\nimport java.time.Instant;\nimport java.util.Date;\nimport java.util.TimeZone;\n\npublic class Main {\n    public static void main(String[] args) {\n        Date currentUtcTime = Date.from(Instant.now());\n        SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss z&quot;);\n        sdf.setTimeZone(TimeZone.getTimeZone(&quot;Etc/UTC&quot;));\n        System.out.println(&quot;Current UTC time is &quot; + sdf.format(currentUtcTime));\n    }\n}\n</code></pre>\n<p><strong>Output:</strong></p>\n<pre><code>Current UTC time is 2021-01-22 21:53:07 UTC\n</code></pre>\n"},{"tags":[],"owner":{"account_id":3029291,"reputation":1704,"user_id":2568649,"display_name":"Chris"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1611611234,"creation_date":1611352616,"answer_id":65853290,"question_id":65853063,"body_markdown":"Instant.now()  is essentially the period of time since the epoch, (midnight 1 January 1970 in UTC), but you are using a Date to present that instant. Date is a reflection of the instant with millisecond precision, but as explained in the documentation at https://docs.oracle.com/javase/8/docs/api/java/util/Date.html, presenting a date should be done using a Calendar, as the presentation of a Date depends on the host. Essentially Date wraps the instant but is displayed according to other factors.\n\nThe simplest approach now if you want to output the instant is to use OffsetDateTime so that you can elect to present the instant in your desired timezone - UTC in your case. Use either `OffsetDateTime.now()` or `OffsetDateTime.ofInstant()` but if you are using the instant within your application logic then just stick with Instant.","title":"Getting the UTC timestamp","body":"<p>Instant.now()  is essentially the period of time since the epoch, (midnight 1 January 1970 in UTC), but you are using a Date to present that instant. Date is a reflection of the instant with millisecond precision, but as explained in the documentation at <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Date.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/8/docs/api/java/util/Date.html</a>, presenting a date should be done using a Calendar, as the presentation of a Date depends on the host. Essentially Date wraps the instant but is displayed according to other factors.</p>\n<p>The simplest approach now if you want to output the instant is to use OffsetDateTime so that you can elect to present the instant in your desired timezone - UTC in your case. Use either <code>OffsetDateTime.now()</code> or <code>OffsetDateTime.ofInstant()</code> but if you are using the instant within your application logic then just stick with Instant.</p>\n"},{"comments":[{"owner":{"account_id":3029291,"reputation":1704,"user_id":2568649,"display_name":"Chris"},"score":0,"creation_date":1611610941,"post_id":65853806,"comment_id":116503276,"body_markdown":"Nice comprehensive discussion. My understanding is that UTC does unfortunately intrude because instant is measured relative to the Unix epoch, and while the epoch isn&#39;t tied to UTC or any timezone or calendar or any human naming, it is just a point in time, the fact is that it can only be described in commonly understood human terms and as such it needs a date label and a location for that label so midnight 1Jan 1970 UTC is as good as any other but it the most sensible chosen way to describe it.","body":"Nice comprehensive discussion. My understanding is that UTC does unfortunately intrude because instant is measured relative to the Unix epoch, and while the epoch isn&#39;t tied to UTC or any timezone or calendar or any human naming, it is just a point in time, the fact is that it can only be described in commonly understood human terms and as such it needs a date label and a location for that label so midnight 1Jan 1970 UTC is as good as any other but it the most sensible chosen way to describe it."},{"owner":{"account_id":3029291,"reputation":1704,"user_id":2568649,"display_name":"Chris"},"score":0,"creation_date":1611611105,"post_id":65853806,"comment_id":116503325,"body_markdown":"Though I think you said the same in your paragraph starting &#39;Yeah, internally ...&#39;","body":"Though I think you said the same in your paragraph starting &#39;Yeah, internally ...&#39;"}],"tags":[],"owner":{"account_id":401843,"reputation":89863,"user_id":768644,"display_name":"rzwitserloot"},"comment_count":2,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1611355835,"creation_date":1611355835,"answer_id":65853806,"question_id":65853063,"body_markdown":"&gt; suggests that the way to get the UTC timestamp in Java is the following:\r\n\r\n&gt; `Instant.now()   // Capture the current moment in UTC.`\r\n\r\nThis, and most answers in this thread, are __misleading__.\r\n\r\nInstant represents an instant in time. It&#39;s &#39;solarflares&#39; time: Absolutely not one iota about it represents anything that is invented by human brains, and UTC is a timezone: A human invention. The cosmos, the sun, astronomy - they have no idea what UTC is, and don&#39;t care - and that&#39;s what Instant is all about. Instants are devoid of such human concepts as &#39;hours&#39; or &#39;days&#39; or &#39;timezones&#39;. It makes no sense to ask an instant what day it happened on. It cannot tell you; some event occurred: If I ask a russian from the 19th century when that happened, they&#39;ll likely give a completely different answer vs. if I ask someone living a mere 100 miles west, for example. Instant doesn&#39;t know which localization to apply and thus doesn&#39;t let you ask it this question - that&#39;s a good thing, objects should not expose methods to which any answer it gives is either gobbledygook or at least requires knowing about all sorts of surprising caveats.\r\n\r\nCrucially, if you tell me &#39;... in UTC&#39;, you surely can tell with exacting detail which month, which day, etcetera. __And Instant does not do this__, which is why it is misleading to say that a `java.time.Instant` represents a moment of time in UTC. __It doesn&#39;t. It represents a moment in time (not in any particular timezone).__\r\n\r\nYeah, internally Instant, just like Date, is just a light wrapper around what `System.currentTimeMillis()` returns: &quot;millis since epoch&quot;, but the crucial thing to understand about it, is that &#39;UTC&#39; is not part of what it _means_, and therefore, when you give an Instant instance to some other method (such as System.out.println, to a database via JDBC, etc), that method is under absolutely no obligation to assume that UTC is semantically relevant.\r\n\r\nWhen you want to mix human notions of time keeping (years, days, months, hours, minutes, milliseconds, and, yeah, timezones) with the notion of a more or less absolute* time, the right answer is `java.time.ZonedDateTime`. Note that any representation of time in something that isn&#39;t `java.time.*` based is by definition broken, as it is in most programming languages - turns out time is a lot more complex than most takes on a library to represent it realize. The fact that `java.time` is in effect the 4th attempt at writing a time library should be ample indication that it&#39;s hard to get it right.\r\n\r\n```\r\nZonedDateTime zdt = ZonedDateTime.now(ZoneOffset.UTC);\r\n```\r\n\r\n_THAT_ is what you want - that isn&#39;t just implementation-detail-wise what you want, but it is code that exactly describes what you __mean__: Right now, at the UTC time zone, stored in an object that semantically doesn&#39;t just store the right time but also stores, and tightly entangles into its very identity, that it is specifically in UTC and is not to be re-interpreted, moved to the local zone, or any other such shenanigans - at least, not unless you explicitly ask it to do so.\r\n\r\n&gt; `Date currentUtcTime = Date.from(Instant.now());`\r\n\r\nNote that Date is the old API and therefore necessarily broken. In this case, Date is a lying liar who lies - it doesn&#39;t represent a date, it represents an instant; it is badly named. (The second API is Calendar, also broken. For example, that is also a lying liar who lies: It doesn&#39;t represent a Calendar whatsoever. It represents some bizarre amalgamation of a zoned datetime and an instant and is fit to represent neither as a consequence). Any time you go to the Date API weirdness ensues, and something as simple as &#39;I just want the concept of the time, at some specific moment, in UTC&#39; isn&#39;t possible in these APIs. You are now dependent on barely defined behaviour of all the various libraries up and down the chain - you&#39;re effectively stuck praying that they do the right thing, or delving into exotic settings to try to cajole these libraries into doing what you want.\r\n\r\nTL;DR: Use `java.time`.\r\n\r\n*) Note that ZonedDateTime is __not__ absolute. For example, if you have the time `January 20th, 2023, 8 in the morning, at Europe/Amsterdam`, in the form of a `ZonedDateTime` object, then the amount of seconds that will pass between now and that moment sure seems like it does not change and will not change when e.g. amsterdam goes through an hour change due daylight savings. However, if the dutch government decrees that henceforth The Netherlands will no longer move the clocks at all and will stay in summer time forever (which is __likely__ - EU directive is already in place, it&#39;s now just a matter of when), then at the moment the gavel lands, your appointment shifts by 1 hour exactly.\r\n\r\nThat hopefully provides crucial insight in the difference: Instant, representing events (hence why I like to call it &#39;solarflares time&#39;, to disentangle it from human time keeping concepts as much as possible), doesn&#39;t even understand the very concept of such a decision having an effect on things. ZonedDateTime on the other hand is inherently bound up in it - hence the `Zone` in `ZonedDateTime`.\r\n\r\nIf you want to store barber appointments and use `Instant` to do it, you _WILL_ be an hour late or early sooner rather than later.\r\n","title":"Getting the UTC timestamp","body":"<blockquote>\n<p>suggests that the way to get the UTC timestamp in Java is the following:</p>\n</blockquote>\n<blockquote>\n<p><code>Instant.now()   // Capture the current moment in UTC.</code></p>\n</blockquote>\n<p>This, and most answers in this thread, are <strong>misleading</strong>.</p>\n<p>Instant represents an instant in time. It's 'solarflares' time: Absolutely not one iota about it represents anything that is invented by human brains, and UTC is a timezone: A human invention. The cosmos, the sun, astronomy - they have no idea what UTC is, and don't care - and that's what Instant is all about. Instants are devoid of such human concepts as 'hours' or 'days' or 'timezones'. It makes no sense to ask an instant what day it happened on. It cannot tell you; some event occurred: If I ask a russian from the 19th century when that happened, they'll likely give a completely different answer vs. if I ask someone living a mere 100 miles west, for example. Instant doesn't know which localization to apply and thus doesn't let you ask it this question - that's a good thing, objects should not expose methods to which any answer it gives is either gobbledygook or at least requires knowing about all sorts of surprising caveats.</p>\n<p>Crucially, if you tell me '... in UTC', you surely can tell with exacting detail which month, which day, etcetera. <strong>And Instant does not do this</strong>, which is why it is misleading to say that a <code>java.time.Instant</code> represents a moment of time in UTC. <strong>It doesn't. It represents a moment in time (not in any particular timezone).</strong></p>\n<p>Yeah, internally Instant, just like Date, is just a light wrapper around what <code>System.currentTimeMillis()</code> returns: &quot;millis since epoch&quot;, but the crucial thing to understand about it, is that 'UTC' is not part of what it <em>means</em>, and therefore, when you give an Instant instance to some other method (such as System.out.println, to a database via JDBC, etc), that method is under absolutely no obligation to assume that UTC is semantically relevant.</p>\n<p>When you want to mix human notions of time keeping (years, days, months, hours, minutes, milliseconds, and, yeah, timezones) with the notion of a more or less absolute* time, the right answer is <code>java.time.ZonedDateTime</code>. Note that any representation of time in something that isn't <code>java.time.*</code> based is by definition broken, as it is in most programming languages - turns out time is a lot more complex than most takes on a library to represent it realize. The fact that <code>java.time</code> is in effect the 4th attempt at writing a time library should be ample indication that it's hard to get it right.</p>\n<pre><code>ZonedDateTime zdt = ZonedDateTime.now(ZoneOffset.UTC);\n</code></pre>\n<p><em>THAT</em> is what you want - that isn't just implementation-detail-wise what you want, but it is code that exactly describes what you <strong>mean</strong>: Right now, at the UTC time zone, stored in an object that semantically doesn't just store the right time but also stores, and tightly entangles into its very identity, that it is specifically in UTC and is not to be re-interpreted, moved to the local zone, or any other such shenanigans - at least, not unless you explicitly ask it to do so.</p>\n<blockquote>\n<p><code>Date currentUtcTime = Date.from(Instant.now());</code></p>\n</blockquote>\n<p>Note that Date is the old API and therefore necessarily broken. In this case, Date is a lying liar who lies - it doesn't represent a date, it represents an instant; it is badly named. (The second API is Calendar, also broken. For example, that is also a lying liar who lies: It doesn't represent a Calendar whatsoever. It represents some bizarre amalgamation of a zoned datetime and an instant and is fit to represent neither as a consequence). Any time you go to the Date API weirdness ensues, and something as simple as 'I just want the concept of the time, at some specific moment, in UTC' isn't possible in these APIs. You are now dependent on barely defined behaviour of all the various libraries up and down the chain - you're effectively stuck praying that they do the right thing, or delving into exotic settings to try to cajole these libraries into doing what you want.</p>\n<p>TL;DR: Use <code>java.time</code>.</p>\n<p>*) Note that ZonedDateTime is <strong>not</strong> absolute. For example, if you have the time <code>January 20th, 2023, 8 in the morning, at Europe/Amsterdam</code>, in the form of a <code>ZonedDateTime</code> object, then the amount of seconds that will pass between now and that moment sure seems like it does not change and will not change when e.g. amsterdam goes through an hour change due daylight savings. However, if the dutch government decrees that henceforth The Netherlands will no longer move the clocks at all and will stay in summer time forever (which is <strong>likely</strong> - EU directive is already in place, it's now just a matter of when), then at the moment the gavel lands, your appointment shifts by 1 hour exactly.</p>\n<p>That hopefully provides crucial insight in the difference: Instant, representing events (hence why I like to call it 'solarflares time', to disentangle it from human time keeping concepts as much as possible), doesn't even understand the very concept of such a decision having an effect on things. ZonedDateTime on the other hand is inherently bound up in it - hence the <code>Zone</code> in <code>ZonedDateTime</code>.</p>\n<p>If you want to store barber appointments and use <code>Instant</code> to do it, you <em>WILL</em> be an hour late or early sooner rather than later.</p>\n"},{"tags":[],"owner":{"account_id":9779820,"reputation":9719,"user_id":7248342,"display_name":"Thomas Fritsch"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1611364223,"creation_date":1611356677,"answer_id":65853931,"question_id":65853063,"body_markdown":"An [`Instant`][1] object and also a [`Date`][2] object by themselves\r\nonly contain a point in time, but no timezone information.\r\nFurthermore, the [`toString()`][3] method of the `Date` class\r\nimplicitly chooses the timezone provided by the system environment,\r\nwhich is not what you want.\r\n\r\nTherefore you need to chose the timezone (in your case UTC) explicitly.\r\nFor example like this:\r\n\r\n    Instant instant = Instant.now();\r\n    OffsetDateTime offsetDateTime = instant.atOffset(ZoneOffset.UTC);\r\n    System.out.println(&quot;Current UTC time is &quot; + offsetDateTime);\r\n\t\r\nThis will (independently from the operation system) print\r\n\r\n\tCurrent UTC time is 2021-01-22T22:37:21.950354100Z\r\n\t\r\nwhere the trailing `Z` denotes the zero timezone offset (i.e. UTC).\r\n\t\r\n [1]: https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html\r\n [2]: https://docs.oracle.com/javase/8/docs/api/java/util/Date.html\r\n [3]: https://docs.oracle.com/javase/8/docs/api/java/util/Date.html#toString--\r\n","title":"Getting the UTC timestamp","body":"<p>An <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html\" rel=\"nofollow noreferrer\"><code>Instant</code></a> object and also a <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Date.html\" rel=\"nofollow noreferrer\"><code>Date</code></a> object by themselves\nonly contain a point in time, but no timezone information.\nFurthermore, the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Date.html#toString--\" rel=\"nofollow noreferrer\"><code>toString()</code></a> method of the <code>Date</code> class\nimplicitly chooses the timezone provided by the system environment,\nwhich is not what you want.</p>\n<p>Therefore you need to chose the timezone (in your case UTC) explicitly.\nFor example like this:</p>\n<pre><code>Instant instant = Instant.now();\nOffsetDateTime offsetDateTime = instant.atOffset(ZoneOffset.UTC);\nSystem.out.println(&quot;Current UTC time is &quot; + offsetDateTime);\n</code></pre>\n<p>This will (independently from the operation system) print</p>\n<pre><code>Current UTC time is 2021-01-22T22:37:21.950354100Z\n</code></pre>\n<p>where the trailing <code>Z</code> denotes the zero timezone offset (i.e. UTC).</p>\n"},{"comments":[{"owner":{"account_id":7612423,"reputation":82506,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1611512337,"post_id":65870797,"comment_id":116469849,"body_markdown":"For Java 1.5 I would suggest (1) upgrading to a newer java version (2) if changing Java version is out of the question on the short sight, use Joda-Time for date and time work.","body":"For Java 1.5 I would suggest (1) upgrading to a newer java version (2) if changing Java version is out of the question on the short sight, use Joda-Time for date and time work."},{"owner":{"account_id":2455794,"reputation":1764,"user_id":2141064,"display_name":"Lorinczy Zsigmond"},"score":0,"creation_date":1611516233,"post_id":65870797,"comment_id":116471098,"body_markdown":"Yes, those are very good suggestions. Also you can just use the solution I&#39;ve written which works without upgrading or using external component.","body":"Yes, those are very good suggestions. Also you can just use the solution I&#39;ve written which works without upgrading or using external component."}],"tags":[],"owner":{"account_id":2455794,"reputation":1764,"user_id":2141064,"display_name":"Lorinczy Zsigmond"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1611493090,"creation_date":1611493090,"answer_id":65870797,"question_id":65853063,"body_markdown":"Sometimes your program has to work with older java versions, so here is an example for 1.5:\r\n\r\n        java.text.SimpleDateFormat tfGMT = new java.text.SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);\r\n        java.util.Calendar cUTC = java.util.Calendar.getInstance (java.util.TimeZone.getTimeZone (&quot;GMT+0&quot;));\r\n        tfGMT.setCalendar (cUTC);\r\n        java.util.Date d= new java.util.Date ();\r\n        String s= tfGMT.format (d);\r\n        System.out.printf (&quot;now=%s [unix ts=%d.%03d]\\n&quot;, s, d.getTime()/1000, d.getTime()%1000);\r\n\r\nMind you, the first three lines don&#39;t have to be repeat at every call, but keep in mind that `SimpleDateFormat` is not thread-safe. (Simple solution: create one for each thread.)\r\n\r\nExample usage (it shows that setting `TZ` doesn&#39;t affect UTC-timestamp):\r\n\r\n    $ TZ=GMT+3 java5 now_utc; TZ=GMT-3 java5 now_utc\r\n    now=2021-01-24 12:56:14 [unix ts=1611492974.264]\r\n    now=2021-01-24 12:56:14 [unix ts=1611492974.726]\r\n","title":"Getting the UTC timestamp","body":"<p>Sometimes your program has to work with older java versions, so here is an example for 1.5:</p>\n<pre><code>    java.text.SimpleDateFormat tfGMT = new java.text.SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);\n    java.util.Calendar cUTC = java.util.Calendar.getInstance (java.util.TimeZone.getTimeZone (&quot;GMT+0&quot;));\n    tfGMT.setCalendar (cUTC);\n    java.util.Date d= new java.util.Date ();\n    String s= tfGMT.format (d);\n    System.out.printf (&quot;now=%s [unix ts=%d.%03d]\\n&quot;, s, d.getTime()/1000, d.getTime()%1000);\n</code></pre>\n<p>Mind you, the first three lines don't have to be repeat at every call, but keep in mind that <code>SimpleDateFormat</code> is not thread-safe. (Simple solution: create one for each thread.)</p>\n<p>Example usage (it shows that setting <code>TZ</code> doesn't affect UTC-timestamp):</p>\n<pre><code>$ TZ=GMT+3 java5 now_utc; TZ=GMT-3 java5 now_utc\nnow=2021-01-24 12:56:14 [unix ts=1611492974.264]\nnow=2021-01-24 12:56:14 [unix ts=1611492974.726]\n</code></pre>\n"},{"tags":[],"owner":{"account_id":6615151,"reputation":7343,"user_id":5108695,"display_name":"Dupinder Singh"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1637909736,"creation_date":1637909736,"answer_id":70120559,"question_id":65853063,"body_markdown":"A simple method that could work!\r\n\r\nMy requirement was date time with milliseconds \r\n\r\n`2021-11-25 19:55:00.743`\r\n\r\n\r\n\r\n    private String getUTCTimestamp() {\r\n    \t\tZonedDateTime utc = ZonedDateTime.now(ZoneOffset.UTC);\r\n    \t\treturn utc.format(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss.SSS&quot;));\r\n    \t}\r\n\r\n","title":"Getting the UTC timestamp","body":"<p>A simple method that could work!</p>\n<p>My requirement was date time with milliseconds</p>\n<p><code>2021-11-25 19:55:00.743</code></p>\n<pre><code>private String getUTCTimestamp() {\n        ZonedDateTime utc = ZonedDateTime.now(ZoneOffset.UTC);\n        return utc.format(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss.SSS&quot;));\n    }\n</code></pre>\n"}],"owner":{"account_id":7430214,"reputation":1253,"user_id":5651468,"accept_rate":100,"display_name":"Sandeep"},"comment_count":6,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":19388,"favorite_count":0,"down_vote_count":0,"up_vote_count":6,"accepted_answer_id":65853216,"answer_count":7,"score":6,"last_activity_date":1681026736,"creation_date":1611351272,"question_id":65853063,"body_markdown":"An [old Stack Overflow posting][1] suggests that the way to get the UTC timestamp in Java is the following:\r\n\r\n    Instant.now()   // Capture the current moment in UTC.\r\n  \r\nUnfortunately, this does not work for me.  I have a very simple program (reproduced below) which demonstrates different behaviour.  \r\n  \r\n\r\n**On Windows**: the time is the local time and it is labelled with the offset with GMT  \r\n  \r\n**On Linux**: the time is again the local time, and it is labelled correctly for the local timezone\r\n\r\n\r\n----------\r\n**Question:** How do we display the UTC timestamp in a Java program?\r\n\r\n\r\n----------\r\nMy sample source code is as follows:\r\n\r\n    import java.time.Instant;\r\n    import java.util.Date;\r\n    \r\n    public class UTCTimeDisplayer {\r\n    \tpublic static void main(String[] args) {\r\n    \t\tSystem.out.println(System.getProperty(&quot;os.name&quot;));\r\n    \t\tDate currentUtcTime = Date.from(Instant.now());\r\n    \t\tSystem.out.println(&quot;Current UTC time is &quot; + currentUtcTime);\r\n    \t}\r\n    }  \r\n  \r\n\r\n**Windows Output:**\r\n\r\n    C:\\tmp&gt;java UTCTimeDisplayer\r\n    Windows 10\r\n    Current UTC time is Fri Jan 22 14:28:59 GMT-06:00 2021\r\n\r\n  [1]: https://stackoverflow.com/questions/308683\r\n  \r\n  \r\n**Linux Output:**\r\n\r\n    /tmp&gt; java UTCTimeDisplayer\r\n    Linux\r\n    Current UTC time is Fri Jan 22 14:31:10 MST 2021\r\n\r\n","title":"Getting the UTC timestamp","body":"<p>An <a href=\"https://stackoverflow.com/questions/308683\">old Stack Overflow posting</a> suggests that the way to get the UTC timestamp in Java is the following:</p>\n<pre><code>Instant.now()   // Capture the current moment in UTC.\n</code></pre>\n<p>Unfortunately, this does not work for me.  I have a very simple program (reproduced below) which demonstrates different behaviour.</p>\n<p><strong>On Windows</strong>: the time is the local time and it is labelled with the offset with GMT</p>\n<p><strong>On Linux</strong>: the time is again the local time, and it is labelled correctly for the local timezone</p>\n<hr />\n<p><strong>Question:</strong> How do we display the UTC timestamp in a Java program?</p>\n<hr />\n<p>My sample source code is as follows:</p>\n<pre><code>import java.time.Instant;\nimport java.util.Date;\n\npublic class UTCTimeDisplayer {\n    public static void main(String[] args) {\n        System.out.println(System.getProperty(&quot;os.name&quot;));\n        Date currentUtcTime = Date.from(Instant.now());\n        System.out.println(&quot;Current UTC time is &quot; + currentUtcTime);\n    }\n}  \n</code></pre>\n<p><strong>Windows Output:</strong></p>\n<pre><code>C:\\tmp&gt;java UTCTimeDisplayer\nWindows 10\nCurrent UTC time is Fri Jan 22 14:28:59 GMT-06:00 2021\n</code></pre>\n<p><strong>Linux Output:</strong></p>\n<pre><code>/tmp&gt; java UTCTimeDisplayer\nLinux\nCurrent UTC time is Fri Jan 22 14:31:10 MST 2021\n</code></pre>\n"},{"tags":["java","file","sorting"],"comments":[{"owner":{"account_id":23121,"reputation":527376,"user_id":57695,"accept_rate":75,"display_name":"Peter Lawrey"},"score":0,"creation_date":1319728571,"post_id":7918060,"comment_id":9671120,"body_markdown":"If you use a recent version of Java 6 you will need about 4 GB of memory.  I assume you don&#39;t have that much ??","body":"If you use a recent version of Java 6 you will need about 4 GB of memory.  I assume you don&#39;t have that much ??"},{"owner":{"account_id":383107,"reputation":50638,"user_id":738746,"accept_rate":97,"display_name":"Bhesh Gurung"},"score":2,"creation_date":1319729349,"post_id":7918060,"comment_id":9671406,"body_markdown":"What if you read just the ids into the `ArrayList` and sort them?","body":"What if you read just the ids into the <code>ArrayList</code> and sort them?"}],"answers":[{"tags":[],"owner":{"account_id":71001,"reputation":24097,"user_id":205426,"accept_rate":60,"display_name":"Woot4Moo"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1319728436,"creation_date":1319728436,"answer_id":7918121,"question_id":7918060,"body_markdown":"What you need to do is to chunk the files in via a stream and process them separately.  Then you can merge the files together as they will already be sorted, this is similar to how merge sort works. \r\n\r\nThe answer from this SO question will be of value: [Stream large files][1]\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/55709/streaming-large-files-in-a-java-servlet/55788#55788","title":"How do I sort very large files","body":"<p>What you need to do is to chunk the files in via a stream and process them separately.  Then you can merge the files together as they will already be sorted, this is similar to how merge sort works. </p>\n\n<p>The answer from this SO question will be of value: <a href=\"https://stackoverflow.com/questions/55709/streaming-large-files-in-a-java-servlet/55788#55788\">Stream large files</a></p>\n"},{"comments":[{"owner":{"account_id":87165,"reputation":3549,"user_id":241899,"accept_rate":92,"display_name":"Vitaly Olegovitch"},"score":0,"creation_date":1333391850,"post_id":7918144,"comment_id":12754884,"body_markdown":"It seems to be the only available Java library that has this functionality. Have you used it in a production environment?","body":"It seems to be the only available Java library that has this functionality. Have you used it in a production environment?"},{"owner":{"account_id":9042085,"reputation":8178,"user_id":6735980,"accept_rate":100,"display_name":"Dennis Soemers"},"score":2,"creation_date":1487086513,"post_id":7918144,"comment_id":71619783,"body_markdown":"I have just used this library to sort a 24GB csv file (roughly 850 million lines of text-data), and it worked very well. Straightforward to use with a custom comparator to specify how I want it to sort as well. So, I can definitely recommend this implementation","body":"I have just used this library to sort a 24GB csv file (roughly 850 million lines of text-data), and it worked very well. Straightforward to use with a custom comparator to specify how I want it to sort as well. So, I can definitely recommend this implementation"}],"tags":[],"owner":{"account_id":900581,"reputation":46749,"user_id":936832,"accept_rate":75,"display_name":"Ingo Kegel"},"comment_count":2,"down_vote_count":0,"up_vote_count":19,"is_accepted":false,"score":19,"last_activity_date":1437025933,"creation_date":1319728512,"answer_id":7918144,"question_id":7918060,"body_markdown":"You need an external merge sort to do that. [Here][1] is a Java implementation of it that sorts very large files.\r\n\r\n\r\n  [1]: https://github.com/lemire/externalsortinginjava","title":"How do I sort very large files","body":"<p>You need an external merge sort to do that. <a href=\"https://github.com/lemire/externalsortinginjava\" rel=\"noreferrer\">Here</a> is a Java implementation of it that sorts very large files.</p>\n"},{"comments":[{"owner":{"account_id":1384705,"reputation":765,"user_id":1316967,"accept_rate":63,"display_name":"sunny_dev"},"score":0,"creation_date":1490090872,"post_id":7918145,"comment_id":72945262,"body_markdown":"1) Are you saying that we sort each individual smaller files and write the sorted data back into each of them, then later read from each of these files again and write into a new bigger final file?\n2) Will this scale for a 16GB flat file on a 8GB RAM or would we run into Memory issues in any scenario in this above solution?","body":"1) Are you saying that we sort each individual smaller files and write the sorted data back into each of them, then later read from each of these files again and write into a new bigger final file? 2) Will this scale for a 16GB flat file on a 8GB RAM or would we run into Memory issues in any scenario in this above solution?"},{"owner":{"account_id":191938,"reputation":15835,"user_id":432806,"accept_rate":100,"display_name":"pcalcao"},"score":0,"creation_date":1490203807,"post_id":7918145,"comment_id":73011927,"body_markdown":"Yes, that&#39;s the basic idea. It&#39;ll work, since you&#39;ll never load all the files into memory, you just need to look at the start of each file (similar to a merge sort).","body":"Yes, that&#39;s the basic idea. It&#39;ll work, since you&#39;ll never load all the files into memory, you just need to look at the start of each file (similar to a merge sort)."},{"owner":{"account_id":8085618,"reputation":422,"user_id":6093274,"accept_rate":33,"display_name":"priyanka"},"score":0,"creation_date":1696667878,"post_id":7918145,"comment_id":136185197,"body_markdown":"@pcalcao Suppose i have a file which 1 GB size and i want to split the file in MB, How can i do that in java??","body":"@pcalcao Suppose i have a file which 1 GB size and i want to split the file in MB, How can i do that in java??"}],"tags":[],"owner":{"account_id":191938,"reputation":15835,"user_id":432806,"accept_rate":100,"display_name":"pcalcao"},"comment_count":3,"down_vote_count":0,"up_vote_count":39,"is_accepted":true,"score":39,"last_activity_date":1319728512,"creation_date":1319728512,"answer_id":7918145,"question_id":7918060,"body_markdown":"That isn&#39;t exactly a Java problem. You need to look into an efficient algorithm for sorting data that isn&#39;t completely read into memory. A few adaptations to Merge-Sort can achieve this.\r\n\r\nTake a look at this:\r\nhttp://en.wikipedia.org/wiki/Merge_sort\r\n\r\nand:\r\nhttp://en.wikipedia.org/wiki/External_sorting\r\n\r\nBasically the idea here is to break the file into smaller pieces, sort them (either with merge sort or another method), and then use the Merge from merge-sort to create the new, sorted file.\r\n","title":"How do I sort very large files","body":"<p>That isn't exactly a Java problem. You need to look into an efficient algorithm for sorting data that isn't completely read into memory. A few adaptations to Merge-Sort can achieve this.</p>\n\n<p>Take a look at this:\n<a href=\"http://en.wikipedia.org/wiki/Merge_sort\" rel=\"noreferrer\">http://en.wikipedia.org/wiki/Merge_sort</a></p>\n\n<p>and:\n<a href=\"http://en.wikipedia.org/wiki/External_sorting\" rel=\"noreferrer\">http://en.wikipedia.org/wiki/External_sorting</a></p>\n\n<p>Basically the idea here is to break the file into smaller pieces, sort them (either with merge sort or another method), and then use the Merge from merge-sort to create the new, sorted file.</p>\n"},{"tags":[],"owner":{"account_id":23121,"reputation":527376,"user_id":57695,"accept_rate":75,"display_name":"Peter Lawrey"},"comment_count":0,"down_vote_count":0,"up_vote_count":7,"is_accepted":false,"score":7,"last_activity_date":1319729471,"creation_date":1319729471,"answer_id":7918381,"question_id":7918060,"body_markdown":"Instead of loading all the data into memory at once, you could read just the keys and an index to where the line starts (and possibly the length as well) e.g.\r\n\r\n    class Line {\r\n       int key, length;\r\n       long start;\r\n    }\r\n\r\nThis would use about 40 bytes per line.\r\n\r\nOnce you have sorted this array, you can use RandomAccessFile to read the lines in the order they appear.\r\n\r\nNote: since you will be randomly hitting the disk, instead of using memory this could be very slow.  A typical disk takes 8 ms to randomly access data and if you have 10 million lines this will take about one day. (This is absolute worst case) In memory it would take about 10 seconds.\r\n","title":"How do I sort very large files","body":"<p>Instead of loading all the data into memory at once, you could read just the keys and an index to where the line starts (and possibly the length as well) e.g.</p>\n\n<pre><code>class Line {\n   int key, length;\n   long start;\n}\n</code></pre>\n\n<p>This would use about 40 bytes per line.</p>\n\n<p>Once you have sorted this array, you can use RandomAccessFile to read the lines in the order they appear.</p>\n\n<p>Note: since you will be randomly hitting the disk, instead of using memory this could be very slow.  A typical disk takes 8 ms to randomly access data and if you have 10 million lines this will take about one day. (This is absolute worst case) In memory it would take about 10 seconds.</p>\n"},{"tags":[],"owner":{"account_id":2366038,"reputation":305,"user_id":2071703,"display_name":"user2071703"},"comment_count":0,"down_vote_count":1,"up_vote_count":3,"is_accepted":false,"score":2,"last_activity_date":1360839611,"creation_date":1360839611,"answer_id":14873275,"question_id":7918060,"body_markdown":"You can use SQL Lite file db, load the data to the db and then let it sort and return the results for you.\r\n\r\nAdvantages: No need to worry about writing the best sorting algorithm. \r\n\r\nDisadvantage: You will need disk space, slower processing.\r\n\r\n\r\nhttps://sites.google.com/site/arjunwebworld/Home/programming/sorting-large-data-files","title":"How do I sort very large files","body":"<p>You can use SQL Lite file db, load the data to the db and then let it sort and return the results for you.</p>\n\n<p>Advantages: No need to worry about writing the best sorting algorithm. </p>\n\n<p>Disadvantage: You will need disk space, slower processing.</p>\n\n<p><a href=\"https://sites.google.com/site/arjunwebworld/Home/programming/sorting-large-data-files\" rel=\"nofollow\">https://sites.google.com/site/arjunwebworld/Home/programming/sorting-large-data-files</a></p>\n"},{"comments":[{"owner":{"account_id":1448228,"reputation":3218,"user_id":1366016,"accept_rate":60,"display_name":"Wheezil"},"score":0,"creation_date":1516546432,"post_id":24837198,"comment_id":83722708,"body_markdown":"The main problems with external sort are: (1) lack of OS portability (2) it is hard to sort java objects, even using serialization.","body":"The main problems with external sort are: (1) lack of OS portability (2) it is hard to sort java objects, even using serialization."}],"tags":[],"owner":{"account_id":2097759,"reputation":2294,"user_id":1866159,"accept_rate":100,"display_name":"Rishi Dua"},"comment_count":1,"down_vote_count":2,"up_vote_count":2,"is_accepted":false,"score":0,"last_activity_date":1405770465,"creation_date":1405749046,"answer_id":24837198,"question_id":7918060,"body_markdown":"Operating systems come with powerful file sorting utility. A simple function that calls a bash script should help.\r\n\r\n    public static void runScript(final Logger log, final String scriptFile) throws IOException, InterruptedException {\r\n    \tfinal String command = scriptFile;\r\n    \tif (!new File (command).exists() || !new File(command).canRead() || !new File(command).canExecute()) {\r\n    \t\tlog.log(Level.SEVERE, &quot;Cannot find or read &quot; + command);\r\n    \t\tlog.log(Level.WARNING, &quot;Make sure the file is executable and you have permissions to execute it. Hint: use \\&quot;chmod +x filename\\&quot; to make it executable&quot;);\r\n    \t\tthrow new IOException(&quot;Cannot find or read &quot; + command);\r\n    \t}\r\n    \tfinal int returncode = Runtime.getRuntime().exec(new String[] {&quot;bash&quot;, &quot;-c&quot;, command}).waitFor();\r\n    \tif (returncode!=0) {\r\n    \t\tlog.log(Level.SEVERE, &quot;The script returned an Error with exit code: &quot; + returncode);\r\n    \t\tthrow new IOException();\r\n    \t}\r\n    \r\n    }","title":"How do I sort very large files","body":"<p>Operating systems come with powerful file sorting utility. A simple function that calls a bash script should help.</p>\n\n<pre><code>public static void runScript(final Logger log, final String scriptFile) throws IOException, InterruptedException {\n    final String command = scriptFile;\n    if (!new File (command).exists() || !new File(command).canRead() || !new File(command).canExecute()) {\n        log.log(Level.SEVERE, \"Cannot find or read \" + command);\n        log.log(Level.WARNING, \"Make sure the file is executable and you have permissions to execute it. Hint: use \\\"chmod +x filename\\\" to make it executable\");\n        throw new IOException(\"Cannot find or read \" + command);\n    }\n    final int returncode = Runtime.getRuntime().exec(new String[] {\"bash\", \"-c\", command}).waitFor();\n    if (returncode!=0) {\n        log.log(Level.SEVERE, \"The script returned an Error with exit code: \" + returncode);\n        throw new IOException();\n    }\n\n}\n</code></pre>\n"},{"comments":[{"owner":{"account_id":4695391,"reputation":3568,"user_id":3800377,"accept_rate":89,"display_name":"Vladislav Kysliy"},"score":1,"creation_date":1473004849,"post_id":39003309,"comment_id":65969650,"body_markdown":"sorry for downvoting but original question has tag java and there is no information about using *nix","body":"sorry for downvoting but original question has tag java and there is no information about using *nix"},{"owner":{"account_id":5924880,"reputation":309,"user_id":4661077,"accept_rate":100,"display_name":"jimpudar"},"score":7,"creation_date":1474550929,"post_id":39003309,"comment_id":66584430,"body_markdown":"I think this is the best answer here, even considering the Java tag. OP mentioned that he needs to sort some files, not that he is required to do it with Java. Even if OP is on Windows, he can still easily get the `sort` executable.","body":"I think this is the best answer here, even considering the Java tag. OP mentioned that he needs to sort some files, not that he is required to do it with Java. Even if OP is on Windows, he can still easily get the <code>sort</code> executable."}],"tags":[],"owner":{"account_id":28042,"reputation":49432,"user_id":74496,"accept_rate":100,"display_name":"rjh"},"comment_count":2,"down_vote_count":3,"up_vote_count":27,"is_accepted":false,"score":24,"last_activity_date":1471456424,"creation_date":1471456424,"answer_id":39003309,"question_id":7918060,"body_markdown":"Since your records are already in flat file text format, you can pipe them into UNIX `sort(1)` e.g. `sort -n -t&#39; &#39; -k1,1 &lt; input &gt; output`. It will automatically chunk the data and perform merge sort using available memory and `/tmp`. If you need more space than you have memory available, add `-T /tmpdir` to the command.\r\n\r\nIt&#39;s quite funny that everyone is telling you to download huge C# or Java libraries or implement merge-sort yourself when you can use a tool that is available on every platform and has been around for decades.","title":"How do I sort very large files","body":"<p>Since your records are already in flat file text format, you can pipe them into UNIX <code>sort(1)</code> e.g. <code>sort -n -t' ' -k1,1 &lt; input &gt; output</code>. It will automatically chunk the data and perform merge sort using available memory and <code>/tmp</code>. If you need more space than you have memory available, add <code>-T /tmpdir</code> to the command.</p>\n\n<p>It's quite funny that everyone is telling you to download huge C# or Java libraries or implement merge-sort yourself when you can use a tool that is available on every platform and has been around for decades.</p>\n"},{"tags":[],"owner":{"account_id":1811316,"reputation":9110,"user_id":1647320,"accept_rate":85,"display_name":"sapy"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1523826366,"creation_date":1523779545,"answer_id":49839773,"question_id":7918060,"body_markdown":"You need to perform an external sort. It&#39;s kind the driving idea behind Hadoop/MapReduce , just that it doesn&#39;t take distributed cluster into account and works on a single node.\r\n\r\nFor better performance, you should use Hadoop/Spark.\r\n\r\n[![enter image description here][1]][1]\r\nChange this lines according to your system . `fpath` is your one big input file (tested with 20GB). `shared` path is where the execution log is stored. `fdir` is where the intermediate files will be stored and merged. Change these paths according to your machine.\r\n\r\n    public static final String fdir = &quot;/tmp/&quot;;\r\n        public static final String shared = &quot;/exports/home/schatterjee/cs553-pa2a/&quot;;\r\n        public static final String fPath = &quot;/input/data-20GB.in&quot;;\r\n        public static final String opLog = shared+&quot;Mysort20GB.log&quot;;\r\nThen run the following programme. Your final sorted file will be created with the name op401 in `fdir` path. the last line ` Runtime.getRuntime().exec(&quot;valsort  &quot; + fdir + &quot;op&quot; + (treeHeight*100)+1 + &quot; &gt; &quot; + opLog);` checks the output is sorted or not . Remove this line if you dont have valsort installed or the input file is not generated using gensort(http://www.ordinal.com/gensort.html) .\r\n\r\nAlso dont forget to change `int totalLines = 200000000;` to the total lines in your file. and thread count (`int threadCount = 16`) should be always in power of 2 and large enough so that (total size * 2 / no of thread) amount of data can reside in memory. Changing Thread count will change the name of final output file. Like for 16, it will be op401, for 32 it will be op501, for 8 it will be op301 etc.\r\n\r\nEnjoy.\r\n\r\n        import java.io.*;\r\n        import java.nio.file.Files;\r\n        import java.nio.file.Paths;\r\n        import java.util.ArrayList;\r\n        import java.util.Comparator;\r\n        import java.util.stream.Stream;\r\n        \r\n        \r\n        class SplitFile extends Thread {\r\n            String fileName;\r\n            int startLine, endLine;\r\n        \r\n            SplitFile(String fileName, int startLine, int endLine) {\r\n                this.fileName = fileName;\r\n                this.startLine = startLine;\r\n                this.endLine = endLine;\r\n            }\r\n        \r\n            public static void writeToFile(BufferedWriter writer, String line) {\r\n                try {\r\n                    writer.write(line + &quot;\\r\\n&quot;);\r\n                } catch (Exception e) {\r\n                    throw new RuntimeException(e);\r\n                }\r\n            }\r\n        \r\n            public void run() {\r\n                try {\r\n                    BufferedWriter writer = Files.newBufferedWriter(Paths.get(fileName));\r\n                    int totalLines = endLine + 1 - startLine;\r\n                    Stream&lt;String&gt; chunks =\r\n                            Files.lines(Paths.get(Mysort20GB.fPath))\r\n                                    .skip(startLine - 1)\r\n                                    .limit(totalLines)\r\n                                    .sorted(Comparator.naturalOrder());\r\n        \r\n                    chunks.forEach(line -&gt; {\r\n                        writeToFile(writer, line);\r\n                    });\r\n                    System.out.println(&quot; Done Writing &quot; + Thread.currentThread().getName());\r\n                    writer.close();\r\n                } catch (Exception e) {\r\n                    System.out.println(e);\r\n                }\r\n            }\r\n        }\r\n        \r\n        class MergeFiles extends Thread {\r\n            String file1, file2, file3;\r\n            MergeFiles(String file1, String file2, String file3) {\r\n                this.file1 = file1;\r\n                this.file2 = file2;\r\n                this.file3 = file3;\r\n            }\r\n        \r\n            public void run() {\r\n                try {\r\n                    System.out.println(file1 + &quot; Started Merging &quot; + file2 );\r\n                    FileReader fileReader1 = new FileReader(file1);\r\n                    FileReader fileReader2 = new FileReader(file2);\r\n                    FileWriter writer = new FileWriter(file3);\r\n                    BufferedReader bufferedReader1 = new BufferedReader(fileReader1);\r\n                    BufferedReader bufferedReader2 = new BufferedReader(fileReader2);\r\n                    String line1 = bufferedReader1.readLine();\r\n                    String line2 = bufferedReader2.readLine();\r\n                    //Merge 2 files based on which string is greater.\r\n                    while (line1 != null || line2 != null) {\r\n                        if (line1 == null || (line2 != null &amp;&amp; line1.compareTo(line2) &gt; 0)) {\r\n                            writer.write(line2 + &quot;\\r\\n&quot;);\r\n                            line2 = bufferedReader2.readLine();\r\n                        } else {\r\n                            writer.write(line1 + &quot;\\r\\n&quot;);\r\n                            line1 = bufferedReader1.readLine();\r\n                        }\r\n                    }\r\n                    System.out.println(file1 + &quot; Done Merging &quot; + file2 );\r\n                    new File(file1).delete();\r\n                    new File(file2).delete();\r\n                    writer.close();\r\n                } catch (Exception e) {\r\n                    System.out.println(e);\r\n                }\r\n            }\r\n        }\r\n        \r\n        public class Mysort20GB {\r\n            //public static final String fdir = &quot;/Users/diesel/Desktop/&quot;;\r\n            public static final String fdir = &quot;/tmp/&quot;;\r\n            public static final String shared = &quot;/exports/home/schatterjee/cs553-pa2a/&quot;;\r\n            public static final String fPath = &quot;/input/data-20GB.in&quot;;\r\n            public static final String opLog = shared+&quot;Mysort20GB.log&quot;;\r\n        \r\n            public static void main(String[] args) throws Exception{\r\n                long startTime = System.nanoTime();\r\n                int threadCount = 16; // Number of threads\r\n                int totalLines = 200000000;\r\n                int linesPerFile = totalLines / threadCount;\r\n                ArrayList&lt;Thread&gt; activeThreads = new ArrayList&lt;Thread&gt;();\r\n        \r\n                for (int i = 1; i &lt;= threadCount; i++) {\r\n                    int startLine = i == 1 ? i : (i - 1) * linesPerFile + 1;\r\n                    int endLine = i * linesPerFile;\r\n                    SplitFile mapThreads = new SplitFile(fdir + &quot;op&quot; + i, startLine, endLine);\r\n                    activeThreads.add(mapThreads);\r\n                    mapThreads.start();\r\n                }\r\n                activeThreads.stream().forEach(t -&gt; {\r\n                    try {\r\n                        t.join();\r\n                    } catch (Exception e) {\r\n                    }\r\n                });\r\n        \r\n                int treeHeight = (int) (Math.log(threadCount) / Math.log(2));\r\n        \r\n                for (int i = 0; i &lt; treeHeight; i++) {\r\n                    ArrayList&lt;Thread&gt; actvThreads = new ArrayList&lt;Thread&gt;();\r\n                                    \r\n    for (int j = 1, itr = 1; j &lt;= threadCount / (i + 1); j += 2, itr++) {\r\n                        int offset = i * 100;\r\n                        String tempFile1 = fdir + &quot;op&quot; + (j + offset);\r\n                        String tempFile2 = fdir + &quot;op&quot; + ((j + 1) + offset);\r\n                        String opFile = fdir + &quot;op&quot; + (itr + ((i + 1) * 100));\r\n                      \r\n                        MergeFiles reduceThreads =\r\n                                new MergeFiles(tempFile1,tempFile2,opFile);\r\n                        actvThreads.add(reduceThreads);\r\n                        reduceThreads.start();\r\n                    }\r\n                    actvThreads.stream().forEach(t -&gt; {\r\n                        try {\r\n                            t.join();\r\n                        } catch (Exception e) {\r\n                        }\r\n                    });\r\n                }\r\n                long endTime = System.nanoTime();\r\n                double timeTaken = (endTime - startTime)/1e9;\r\n                System.out.println(timeTaken);\r\n                BufferedWriter logFile = new BufferedWriter(new FileWriter(opLog, true));\r\n                logFile.write(&quot;Time Taken in seconds:&quot; + timeTaken);\r\n                Runtime.getRuntime().exec(&quot;valsort  &quot; + fdir + &quot;op&quot; + (treeHeight*100)+1 + &quot; &gt; &quot; + opLog);\r\n                logFile.close();\r\n            }\r\n        }\r\n\r\n  [1]: https://i.stack.imgur.com/TcP6z.jpg\r\n","title":"How do I sort very large files","body":"<p>You need to perform an external sort. It's kind the driving idea behind Hadoop/MapReduce , just that it doesn't take distributed cluster into account and works on a single node.</p>\n\n<p>For better performance, you should use Hadoop/Spark.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TcP6z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TcP6z.jpg\" alt=\"enter image description here\"></a>\nChange this lines according to your system . <code>fpath</code> is your one big input file (tested with 20GB). <code>shared</code> path is where the execution log is stored. <code>fdir</code> is where the intermediate files will be stored and merged. Change these paths according to your machine.</p>\n\n<pre><code>public static final String fdir = \"/tmp/\";\n    public static final String shared = \"/exports/home/schatterjee/cs553-pa2a/\";\n    public static final String fPath = \"/input/data-20GB.in\";\n    public static final String opLog = shared+\"Mysort20GB.log\";\n</code></pre>\n\n<p>Then run the following programme. Your final sorted file will be created with the name op401 in <code>fdir</code> path. the last line <code>Runtime.getRuntime().exec(\"valsort  \" + fdir + \"op\" + (treeHeight*100)+1 + \" &gt; \" + opLog);</code> checks the output is sorted or not . Remove this line if you dont have valsort installed or the input file is not generated using gensort(<a href=\"http://www.ordinal.com/gensort.html\" rel=\"nofollow noreferrer\">http://www.ordinal.com/gensort.html</a>) .</p>\n\n<p>Also dont forget to change <code>int totalLines = 200000000;</code> to the total lines in your file. and thread count (<code>int threadCount = 16</code>) should be always in power of 2 and large enough so that (total size * 2 / no of thread) amount of data can reside in memory. Changing Thread count will change the name of final output file. Like for 16, it will be op401, for 32 it will be op501, for 8 it will be op301 etc.</p>\n\n<p>Enjoy.</p>\n\n<pre><code>    import java.io.*;\n    import java.nio.file.Files;\n    import java.nio.file.Paths;\n    import java.util.ArrayList;\n    import java.util.Comparator;\n    import java.util.stream.Stream;\n\n\n    class SplitFile extends Thread {\n        String fileName;\n        int startLine, endLine;\n\n        SplitFile(String fileName, int startLine, int endLine) {\n            this.fileName = fileName;\n            this.startLine = startLine;\n            this.endLine = endLine;\n        }\n\n        public static void writeToFile(BufferedWriter writer, String line) {\n            try {\n                writer.write(line + \"\\r\\n\");\n            } catch (Exception e) {\n                throw new RuntimeException(e);\n            }\n        }\n\n        public void run() {\n            try {\n                BufferedWriter writer = Files.newBufferedWriter(Paths.get(fileName));\n                int totalLines = endLine + 1 - startLine;\n                Stream&lt;String&gt; chunks =\n                        Files.lines(Paths.get(Mysort20GB.fPath))\n                                .skip(startLine - 1)\n                                .limit(totalLines)\n                                .sorted(Comparator.naturalOrder());\n\n                chunks.forEach(line -&gt; {\n                    writeToFile(writer, line);\n                });\n                System.out.println(\" Done Writing \" + Thread.currentThread().getName());\n                writer.close();\n            } catch (Exception e) {\n                System.out.println(e);\n            }\n        }\n    }\n\n    class MergeFiles extends Thread {\n        String file1, file2, file3;\n        MergeFiles(String file1, String file2, String file3) {\n            this.file1 = file1;\n            this.file2 = file2;\n            this.file3 = file3;\n        }\n\n        public void run() {\n            try {\n                System.out.println(file1 + \" Started Merging \" + file2 );\n                FileReader fileReader1 = new FileReader(file1);\n                FileReader fileReader2 = new FileReader(file2);\n                FileWriter writer = new FileWriter(file3);\n                BufferedReader bufferedReader1 = new BufferedReader(fileReader1);\n                BufferedReader bufferedReader2 = new BufferedReader(fileReader2);\n                String line1 = bufferedReader1.readLine();\n                String line2 = bufferedReader2.readLine();\n                //Merge 2 files based on which string is greater.\n                while (line1 != null || line2 != null) {\n                    if (line1 == null || (line2 != null &amp;&amp; line1.compareTo(line2) &gt; 0)) {\n                        writer.write(line2 + \"\\r\\n\");\n                        line2 = bufferedReader2.readLine();\n                    } else {\n                        writer.write(line1 + \"\\r\\n\");\n                        line1 = bufferedReader1.readLine();\n                    }\n                }\n                System.out.println(file1 + \" Done Merging \" + file2 );\n                new File(file1).delete();\n                new File(file2).delete();\n                writer.close();\n            } catch (Exception e) {\n                System.out.println(e);\n            }\n        }\n    }\n\n    public class Mysort20GB {\n        //public static final String fdir = \"/Users/diesel/Desktop/\";\n        public static final String fdir = \"/tmp/\";\n        public static final String shared = \"/exports/home/schatterjee/cs553-pa2a/\";\n        public static final String fPath = \"/input/data-20GB.in\";\n        public static final String opLog = shared+\"Mysort20GB.log\";\n\n        public static void main(String[] args) throws Exception{\n            long startTime = System.nanoTime();\n            int threadCount = 16; // Number of threads\n            int totalLines = 200000000;\n            int linesPerFile = totalLines / threadCount;\n            ArrayList&lt;Thread&gt; activeThreads = new ArrayList&lt;Thread&gt;();\n\n            for (int i = 1; i &lt;= threadCount; i++) {\n                int startLine = i == 1 ? i : (i - 1) * linesPerFile + 1;\n                int endLine = i * linesPerFile;\n                SplitFile mapThreads = new SplitFile(fdir + \"op\" + i, startLine, endLine);\n                activeThreads.add(mapThreads);\n                mapThreads.start();\n            }\n            activeThreads.stream().forEach(t -&gt; {\n                try {\n                    t.join();\n                } catch (Exception e) {\n                }\n            });\n\n            int treeHeight = (int) (Math.log(threadCount) / Math.log(2));\n\n            for (int i = 0; i &lt; treeHeight; i++) {\n                ArrayList&lt;Thread&gt; actvThreads = new ArrayList&lt;Thread&gt;();\n\nfor (int j = 1, itr = 1; j &lt;= threadCount / (i + 1); j += 2, itr++) {\n                    int offset = i * 100;\n                    String tempFile1 = fdir + \"op\" + (j + offset);\n                    String tempFile2 = fdir + \"op\" + ((j + 1) + offset);\n                    String opFile = fdir + \"op\" + (itr + ((i + 1) * 100));\n\n                    MergeFiles reduceThreads =\n                            new MergeFiles(tempFile1,tempFile2,opFile);\n                    actvThreads.add(reduceThreads);\n                    reduceThreads.start();\n                }\n                actvThreads.stream().forEach(t -&gt; {\n                    try {\n                        t.join();\n                    } catch (Exception e) {\n                    }\n                });\n            }\n            long endTime = System.nanoTime();\n            double timeTaken = (endTime - startTime)/1e9;\n            System.out.println(timeTaken);\n            BufferedWriter logFile = new BufferedWriter(new FileWriter(opLog, true));\n            logFile.write(\"Time Taken in seconds:\" + timeTaken);\n            Runtime.getRuntime().exec(\"valsort  \" + fdir + \"op\" + (treeHeight*100)+1 + \" &gt; \" + opLog);\n            logFile.close();\n        }\n    }\n</code></pre>\n"},{"tags":[],"owner":{"account_id":216605,"reputation":11967,"user_id":471955,"accept_rate":0,"display_name":"Dave Moten"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":false,"score":3,"last_activity_date":1559095746,"creation_date":1559095746,"answer_id":56352174,"question_id":7918060,"body_markdown":"Use the java library [big-sorter][1] which can be used for sorting very large text or binary files.\r\n\r\nHere&#39;s how your exact problem would be implemented:\r\n\r\n```java\r\n// write the input to a file\r\nString s = &quot;0052304 0000004000000000000000000000000000000041   John Teddy   000023\\n&quot;\r\n        + &quot;0022024 0000004000000000000000000000000000000041   George Clan 00013&quot;;\r\nFile input = new File(&quot;target/input&quot;);\r\nFiles.write(input.toPath(),s.getBytes(StandardCharsets.UTF_8), StandardOpenOption.WRITE);\r\n\r\nFile output = new File(&quot;target/output&quot;);\r\n\r\n\r\n//sort the input\r\nSorter\r\n    .serializerLinesUtf8()\r\n    .comparator((a,b) -&gt; {\r\n        String ida = a.substring(0, a.indexOf(&#39; &#39;));\r\n        String idb = b.substring(0, b.indexOf(&#39; &#39;));\r\n        return ida.compareTo(idb);\r\n    }) \r\n    .input(input) \r\n    .output(output) \r\n    .sort();\r\n\r\n// display the output\r\nFiles.readAllLines(output.toPath()).forEach(System.out::println);\r\n```\r\noutput:\r\n```\r\n0022024 0000004000000000000000000000000000000041   George Clan 00013\r\n0052304 0000004000000000000000000000000000000041   John Teddy   000023\r\n```\r\n\r\n  [1]: https://github.com/davidmoten/big-sorter","title":"How do I sort very large files","body":"<p>Use the java library <a href=\"https://github.com/davidmoten/big-sorter\" rel=\"nofollow noreferrer\">big-sorter</a> which can be used for sorting very large text or binary files.</p>\n\n<p>Here's how your exact problem would be implemented:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>// write the input to a file\nString s = \"0052304 0000004000000000000000000000000000000041   John Teddy   000023\\n\"\n        + \"0022024 0000004000000000000000000000000000000041   George Clan 00013\";\nFile input = new File(\"target/input\");\nFiles.write(input.toPath(),s.getBytes(StandardCharsets.UTF_8), StandardOpenOption.WRITE);\n\nFile output = new File(\"target/output\");\n\n\n//sort the input\nSorter\n    .serializerLinesUtf8()\n    .comparator((a,b) -&gt; {\n        String ida = a.substring(0, a.indexOf(' '));\n        String idb = b.substring(0, b.indexOf(' '));\n        return ida.compareTo(idb);\n    }) \n    .input(input) \n    .output(output) \n    .sort();\n\n// display the output\nFiles.readAllLines(output.toPath()).forEach(System.out::println);\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>0022024 0000004000000000000000000000000000000041   George Clan 00013\n0052304 0000004000000000000000000000000000000041   John Teddy   000023\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1330960,"reputation":1383,"user_id":1274890,"display_name":"R Sun"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1635876473,"creation_date":1635876473,"answer_id":69815059,"question_id":7918060,"body_markdown":"I used my own logic and sorted a BIG JSON file in format \r\n\r\n```\r\n{&quot;name&quot;:&quot;hoge.finance&quot;,&quot;address&quot;:&quot;0xfAd45E47083e4607302aa43c65fB3106F1cd7607&quot;}\r\n```\r\n\r\nFull source code is available on https://github.com/sitetester/token-sorter along with test case. Code is well documented, so easy to understand.\r\n\r\nIt splits input file into multiple smaller SORTED files (configurable) and then compare data. \r\n\r\nPasting some comments here...\r\n\r\n```\r\n// at this point, we have sorted data sets in respective files\r\n// next, we will take first token from first file and compare it with tokens of all other files\r\n// during comparison, if some token from other file is in sorted order, then we make it default/initial sorted token\r\n// &amp; jump to next file, since all remaining tokens in THAT file are already in sorted form\r\n// at end of comparisons with all files, we remove it from specific file (so it&#39;s not compared next time) and put/append in final sorted file\r\n// this process continues, until all entries are matched\r\n// if some file has no entries, then we simply delete it (so it&#39;s not compared next time)\r\n```\r\n\r\n\r\n","title":"How do I sort very large files","body":"<p>I used my own logic and sorted a BIG JSON file in format</p>\n<pre><code>{&quot;name&quot;:&quot;hoge.finance&quot;,&quot;address&quot;:&quot;0xfAd45E47083e4607302aa43c65fB3106F1cd7607&quot;}\n</code></pre>\n<p>Full source code is available on <a href=\"https://github.com/sitetester/token-sorter\" rel=\"nofollow noreferrer\">https://github.com/sitetester/token-sorter</a> along with test case. Code is well documented, so easy to understand.</p>\n<p>It splits input file into multiple smaller SORTED files (configurable) and then compare data.</p>\n<p>Pasting some comments here...</p>\n<pre><code>// at this point, we have sorted data sets in respective files\n// next, we will take first token from first file and compare it with tokens of all other files\n// during comparison, if some token from other file is in sorted order, then we make it default/initial sorted token\n// &amp; jump to next file, since all remaining tokens in THAT file are already in sorted form\n// at end of comparisons with all files, we remove it from specific file (so it's not compared next time) and put/append in final sorted file\n// this process continues, until all entries are matched\n// if some file has no entries, then we simply delete it (so it's not compared next time)\n</code></pre>\n"}],"owner":{"account_id":323326,"reputation":6604,"user_id":643271,"accept_rate":74,"display_name":"Kayser"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":55890,"favorite_count":0,"down_vote_count":1,"up_vote_count":35,"accepted_answer_id":7918145,"answer_count":10,"score":34,"last_activity_date":1681026660,"creation_date":1319728222,"question_id":7918060,"body_markdown":"I have some files that should be sorted according to id at the beginning of each line.\r\nThe files are about 2-3 gb. &lt;p&gt;I tried to read all data into an `ArrayList` and sort them. But memory is not enough to keep them all. It does not work.&lt;br&gt;\r\n\r\n\r\nLines look like&lt;p&gt; \r\n`0052304 0000004000000000000000000000000000000041   John Teddy   000023`&lt;br&gt;\r\n`0022024 0000004000000000000000000000000000000041   George Clan 00013`&lt;p&gt;\r\n\r\n\r\nHow can I sort the files??","title":"How do I sort very large files","body":"<p>I have some files that should be sorted according to id at the beginning of each line.\nThe files are about 2-3 gb. <p>I tried to read all data into an <code>ArrayList</code> and sort them. But memory is not enough to keep them all. It does not work.<br></p>\n\n<p>Lines look like<p> \n<code>0052304 0000004000000000000000000000000000000041   John Teddy   000023</code><br>\n<code>0022024 0000004000000000000000000000000000000041   George Clan 00013</code><p></p>\n\n<p>How can I sort the files??</p>\n"},{"tags":["java","generics","api-design"],"comments":[{"owner":{"account_id":10941198,"reputation":4394,"user_id":8041003,"display_name":"John Williams"},"score":0,"creation_date":1680458231,"post_id":75913358,"comment_id":133898099,"body_markdown":"I think you are using generics superfluously - this is better suited to old-fashioned inheritance. Unless you can tell us more about the problem being addressed.","body":"I think you are using generics superfluously - this is better suited to old-fashioned inheritance. Unless you can tell us more about the problem being addressed."},{"owner":{"account_id":9026259,"reputation":1316,"user_id":6725459,"display_name":"jjazzboss"},"score":0,"creation_date":1680458547,"post_id":75913358,"comment_id":133898156,"body_markdown":"I don&#39;t understand your comment. You mean make the Item class not generic ?","body":"I don&#39;t understand your comment. You mean make the Item class not generic ?"},{"owner":{"account_id":465573,"reputation":192703,"user_id":869736,"accept_rate":82,"display_name":"Louis Wasserman"},"score":0,"creation_date":1680463947,"post_id":75913358,"comment_id":133898995,"body_markdown":"It isn&#39;t clear what the `T` is being used for in any of these places, yeah.","body":"It isn&#39;t clear what the <code>T</code> is being used for in any of these places, yeah."},{"owner":{"account_id":9026259,"reputation":1316,"user_id":6725459,"display_name":"jjazzboss"},"score":0,"creation_date":1680505827,"post_id":75913358,"comment_id":133903708,"body_markdown":"I added some context","body":"I added some context"}],"answers":[{"tags":[],"owner":{"account_id":9026259,"reputation":1316,"user_id":6725459,"display_name":"jjazzboss"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1681026259,"creation_date":1680506980,"answer_id":75916966,"question_id":75913358,"body_markdown":"Not sure it&#39;s the best solution but I ended up using the following getItems() method:\r\n\r\n     &lt;T extends Item&lt;?&gt;&gt; T getItems(Class&lt;T&gt; itemClass);\r\n\r\nwhich makes the 2 lines work:\r\n\r\n    NoteItem item = getItems(NoteItem.class).get(0);  // Compiles OK\r\n    Item&lt;?&gt; item2= getItems(Item.class).get(0); // Compiles OK\r\n\r\nThe only minor drawback is that I get a rawtypes warning when I use `getItems(Item.class)` because return value is `List&lt;Item&gt;`, not `List&lt;Item&lt;?&gt;&gt;`.","title":"API design question, generic method with generic class","body":"<p>Not sure it's the best solution but I ended up using the following getItems() method:</p>\n<pre><code> &lt;T extends Item&lt;?&gt;&gt; T getItems(Class&lt;T&gt; itemClass);\n</code></pre>\n<p>which makes the 2 lines work:</p>\n<pre><code>NoteItem item = getItems(NoteItem.class).get(0);  // Compiles OK\nItem&lt;?&gt; item2= getItems(Item.class).get(0); // Compiles OK\n</code></pre>\n<p>The only minor drawback is that I get a rawtypes warning when I use <code>getItems(Item.class)</code> because return value is <code>List&lt;Item&gt;</code>, not <code>List&lt;Item&lt;?&gt;&gt;</code>.</p>\n"}],"owner":{"account_id":9026259,"reputation":1316,"user_id":6725459,"display_name":"jjazzboss"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":66,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75916966,"answer_count":1,"score":0,"last_activity_date":1681026259,"creation_date":1680454001,"question_id":75913358,"body_markdown":"A musical score contains Item objects. All Items have a Position and associated data. Data can be anything, a note, lyrics, etc.\r\n\r\n    interface Item&lt;T&gt;\r\n    {\r\n         Position getPosition();\r\n         T getData();\r\n         ...\r\n    }\r\n    \r\n    class NoteItem implements Item&lt;Note&gt;\r\n    {        \r\n        Note getData() { .... }\r\n        ...\r\n    }\r\n\r\n    class LyricsItem implements Item&lt;Lyrics&gt;\r\n    {\r\n        Lyrics getData { ... }\r\n        ...\r\n    }\r\n\r\nThe Score class has a method to get Items of a specific class:\r\n\r\n    public &lt;T extends Item&lt;E&gt;, E&gt; List&lt;T&gt; getItems(Class&lt;T&gt; itemClass)\r\n    {\r\n      //\r\n    }\r\n\r\nAs shown below, `getItems()` works if parameter is a subclass of Item. But if it&#39;s Item.class, return value is a list of objects, I expected a list of Items...\r\n\r\n    NoteItem item = getItems(NoteItem.class).get(0);  // Compiles OK\r\n    Item&lt;?&gt; item2= getItems(Item.class).get(0); // Compiles KO, return value is Object, not Item&lt;Object&gt; as I expected\r\n\r\nI can fix the 2nd line by explicitly casting the result to (Item&lt;?&gt;), but is there a better way to avoid the casting ? \r\n\r\nOne solution to avoid the casting is to change the `getItems()` method to:\r\n\r\n     &lt;T&gt; List&lt;T&gt; getItems(Class&lt;T&gt; aClass)\r\n\r\nbut then the user of the method has no way (besides doc) to know that the method only accepts Item classes. What would be the best way to handle this ?","title":"API design question, generic method with generic class","body":"<p>A musical score contains Item objects. All Items have a Position and associated data. Data can be anything, a note, lyrics, etc.</p>\n<pre><code>interface Item&lt;T&gt;\n{\n     Position getPosition();\n     T getData();\n     ...\n}\n\nclass NoteItem implements Item&lt;Note&gt;\n{        \n    Note getData() { .... }\n    ...\n}\n\nclass LyricsItem implements Item&lt;Lyrics&gt;\n{\n    Lyrics getData { ... }\n    ...\n}\n</code></pre>\n<p>The Score class has a method to get Items of a specific class:</p>\n<pre><code>public &lt;T extends Item&lt;E&gt;, E&gt; List&lt;T&gt; getItems(Class&lt;T&gt; itemClass)\n{\n  //\n}\n</code></pre>\n<p>As shown below, <code>getItems()</code> works if parameter is a subclass of Item. But if it's Item.class, return value is a list of objects, I expected a list of Items...</p>\n<pre><code>NoteItem item = getItems(NoteItem.class).get(0);  // Compiles OK\nItem&lt;?&gt; item2= getItems(Item.class).get(0); // Compiles KO, return value is Object, not Item&lt;Object&gt; as I expected\n</code></pre>\n<p>I can fix the 2nd line by explicitly casting the result to (Item&lt;?&gt;), but is there a better way to avoid the casting ?</p>\n<p>One solution to avoid the casting is to change the <code>getItems()</code> method to:</p>\n<pre><code> &lt;T&gt; List&lt;T&gt; getItems(Class&lt;T&gt; aClass)\n</code></pre>\n<p>but then the user of the method has no way (besides doc) to know that the method only accepts Item classes. What would be the best way to handle this ?</p>\n"},{"tags":["java","spring-boot","azure","azure-functions","azure-eventhub"],"owner":{"account_id":17394740,"reputation":21,"user_id":12604607,"display_name":"javadeveloper"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":104,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"answer_count":0,"score":0,"last_activity_date":1681025389,"creation_date":1681025389,"question_id":75969285,"body_markdown":"I have an Spring Boot Azure Function configured using `@Eventhubtrigger`\r\n\r\n\r\n    public class MyHandler extends FunctionInvoker&lt;Object, Object&gt; {\r\n    \r\n    \tprivate static final Logger LOGGER = LoggerFactory.getLogger(MyHandler.class);\r\n    \r\n    \t@FunctionName(&quot;myFunction&quot;)\r\n    \tpublic void execute(\r\n    \t\t@EventHubTrigger(\r\n    \t\t\tname=&quot;myEventHubTrigger&quot;,\r\n    \t\t\teventHubName=&quot;my-event-hub-sample&quot;\r\n    \t\t\tcardinality=Cardinality.ONE,\r\n    \t\t\tconsumerGroup=&quot;cg-my-event-hub-sample&quot;,\r\n    \t\t\tconnection = &quot;EVENT_HUB_CONNECTION_STRING&quot;\r\n    \t\t) String event, ExecutionContext context) {\r\n    \r\n    \t\ttry {\r\n    \t\t\tcontext.getLogger().log(new Record(LEVEL.INFO, &quot;Event read&quot;+event));\r\n    \t\t\tLOGGER.info(&quot;Application : Event Read &quot;+event);\r\n    \r\n    \r\n    \t\t\t//this writes event to Blob Location\r\n    \t\t\thandleRequest(event, context);\r\n    \r\n    \t\t\tLOGGER.info(&quot;Application : Event processed successfully&quot;);\r\n    \r\n    \t\t} catch (Exception e) {\r\n    \t\t\tLOGGER.error(&quot;Application : Event processed with error&quot;,e);\r\n    \t\t\tthrow new RuntimeException(e);\r\n    \t\t}\r\n    \t}\r\n    }\r\n\r\n\r\nIn this case, the `handleRequest(event, context)`, writes to Azure Blob storage with `yyyy-mm-dd-timestamp` format.\r\n\r\nAlso I dont see any exceptions and can see in log message like : `Application : Event processed successfully` . Inspite of this, again the event is consumed and again the whole processing is done and again all messages are printed in log\r\n\r\nDue to this behavior, I can see multiple files with different timestamps created at blob location for one single event dropped in eventhub. I just dropped one event in eventhub and 30 files were created at blob location. Sometimes its 15, sometimes its 30. Ideally only one file should be created at blob location.\r\n\r\nWhat is missing here ? ","title":"Why is Spring Boot Azure Function is replaying events?","body":"<p>I have an Spring Boot Azure Function configured using <code>@Eventhubtrigger</code></p>\n<pre><code>public class MyHandler extends FunctionInvoker&lt;Object, Object&gt; {\n\n    private static final Logger LOGGER = LoggerFactory.getLogger(MyHandler.class);\n\n    @FunctionName(&quot;myFunction&quot;)\n    public void execute(\n        @EventHubTrigger(\n            name=&quot;myEventHubTrigger&quot;,\n            eventHubName=&quot;my-event-hub-sample&quot;\n            cardinality=Cardinality.ONE,\n            consumerGroup=&quot;cg-my-event-hub-sample&quot;,\n            connection = &quot;EVENT_HUB_CONNECTION_STRING&quot;\n        ) String event, ExecutionContext context) {\n\n        try {\n            context.getLogger().log(new Record(LEVEL.INFO, &quot;Event read&quot;+event));\n            LOGGER.info(&quot;Application : Event Read &quot;+event);\n\n\n            //this writes event to Blob Location\n            handleRequest(event, context);\n\n            LOGGER.info(&quot;Application : Event processed successfully&quot;);\n\n        } catch (Exception e) {\n            LOGGER.error(&quot;Application : Event processed with error&quot;,e);\n            throw new RuntimeException(e);\n        }\n    }\n}\n</code></pre>\n<p>In this case, the <code>handleRequest(event, context)</code>, writes to Azure Blob storage with <code>yyyy-mm-dd-timestamp</code> format.</p>\n<p>Also I dont see any exceptions and can see in log message like : <code>Application : Event processed successfully</code> . Inspite of this, again the event is consumed and again the whole processing is done and again all messages are printed in log</p>\n<p>Due to this behavior, I can see multiple files with different timestamps created at blob location for one single event dropped in eventhub. I just dropped one event in eventhub and 30 files were created at blob location. Sometimes its 15, sometimes its 30. Ideally only one file should be created at blob location.</p>\n<p>What is missing here ?</p>\n"},{"tags":["java","string","escaping","string-formatting"],"answers":[{"tags":[],"owner":{"account_id":9945780,"reputation":490,"user_id":7360568,"display_name":"cardouken"},"comment_count":0,"down_vote_count":0,"up_vote_count":2,"is_accepted":false,"score":2,"last_activity_date":1680964196,"creation_date":1680964196,"answer_id":75965807,"question_id":75965746,"body_markdown":"Apache commons has a library for what you seem to be looking for: https://commons.apache.org/proper/commons-text/javadocs/api-release/org/apache/commons/text/StringEscapeUtils.html#escapeJava(java.lang.String)\r\n\r\nIf you can&#39;t use Maven/Gradle then you&#39;ll most likely have to resort to rolling your own by escaping all special characters with a backslash i.e. something like:\r\n\r\n```java\r\npublic static void main(String[] args) {\r\n    String text = &quot;Hello\\nWorld!&quot;;\r\n    String escapedText = escapeSpecialChars(text);\r\n    System.out.println(escapedText);\r\n}\r\n\r\nprivate static String escapeSpecialChars(String text) {\r\n    StringBuilder sb = new StringBuilder();\r\n    for (char c : text.toCharArray()) {\r\n        switch (c) {\r\n            case &#39;\\\\&#39; -&gt; sb.append(&quot;\\\\\\\\&quot;);\r\n            case &#39;\\n&#39; -&gt; sb.append(&quot;\\\\n&quot;);\r\n            case &#39;\\t&#39; -&gt; sb.append(&quot;\\\\t&quot;);\r\n            case &#39;\\&#39;&#39; -&gt; sb.append(&quot;\\\\&#39;&quot;);\r\n            case &#39;\\&quot;&#39; -&gt; sb.append(&quot;\\\\\\&quot;&quot;);\r\n            default -&gt; sb.append(c);\r\n        }\r\n    }\r\n    return sb.toString();\r\n}\r\n```","title":"How to display string formatters as plain text in Java?","body":"<p>Apache commons has a library for what you seem to be looking for: <a href=\"https://commons.apache.org/proper/commons-text/javadocs/api-release/org/apache/commons/text/StringEscapeUtils.html#escapeJava(java.lang.String)\" rel=\"nofollow noreferrer\">https://commons.apache.org/proper/commons-text/javadocs/api-release/org/apache/commons/text/StringEscapeUtils.html#escapeJava(java.lang.String)</a></p>\n<p>If you can't use Maven/Gradle then you'll most likely have to resort to rolling your own by escaping all special characters with a backslash i.e. something like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static void main(String[] args) {\n    String text = &quot;Hello\\nWorld!&quot;;\n    String escapedText = escapeSpecialChars(text);\n    System.out.println(escapedText);\n}\n\nprivate static String escapeSpecialChars(String text) {\n    StringBuilder sb = new StringBuilder();\n    for (char c : text.toCharArray()) {\n        switch (c) {\n            case '\\\\' -&gt; sb.append(&quot;\\\\\\\\&quot;);\n            case '\\n' -&gt; sb.append(&quot;\\\\n&quot;);\n            case '\\t' -&gt; sb.append(&quot;\\\\t&quot;);\n            case '\\'' -&gt; sb.append(&quot;\\\\'&quot;);\n            case '\\&quot;' -&gt; sb.append(&quot;\\\\\\&quot;&quot;);\n            default -&gt; sb.append(c);\n        }\n    }\n    return sb.toString();\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":1689973,"reputation":37330,"user_id":1552534,"display_name":"WJS"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1680971618,"creation_date":1680971147,"answer_id":75966391,"question_id":75965746,"body_markdown":"Here is an one way using streams.\r\n```\r\nString text = &quot;He\\f\\bllo\\nWor\\rld!&quot;;\r\ntext = translate(text);\r\n```\r\nprints\r\n```\r\nHe\\f\\bllo\\nWor\\rld!\r\n```\r\n- this splits the string and then replaces the proper control character with its escaped outerpart.\r\n```\r\nprivate static Map&lt;Character, String&gt; map = Map.of(&#39;\\t&#39;, &quot;\\\\t&quot;, &#39;\\b&#39;, &quot;\\\\b&quot;, &#39;\\n&#39;,\r\n        &quot;\\\\n&quot;, &#39;\\f&#39;, &quot;\\\\f&quot;, &#39;\\\\&#39;, &quot;\\\\\\&#39;&quot;, &#39;&quot;&#39;, &quot;\\\\\\&quot;&quot;, &#39;\\r&#39;, &quot;\\\\r&quot;);\r\npublic static String translate(String text) {\r\n    return text.chars()\r\n            .mapToObj(ch -&gt; map.getOrDefault((char)ch, Character.toString(ch)))\r\n            .collect(Collectors.joining());    \r\n}\r\n","title":"How to display string formatters as plain text in Java?","body":"<p>Here is an one way using streams.</p>\n<pre><code>String text = &quot;He\\f\\bllo\\nWor\\rld!&quot;;\ntext = translate(text);\n</code></pre>\n<p>prints</p>\n<pre><code>He\\f\\bllo\\nWor\\rld!\n</code></pre>\n<ul>\n<li>this splits the string and then replaces the proper control character with its escaped outerpart.</li>\n</ul>\n<pre><code>private static Map&lt;Character, String&gt; map = Map.of('\\t', &quot;\\\\t&quot;, '\\b', &quot;\\\\b&quot;, '\\n',\n        &quot;\\\\n&quot;, '\\f', &quot;\\\\f&quot;, '\\\\', &quot;\\\\\\'&quot;, '&quot;', &quot;\\\\\\&quot;&quot;, '\\r', &quot;\\\\r&quot;);\npublic static String translate(String text) {\n    return text.chars()\n            .mapToObj(ch -&gt; map.getOrDefault((char)ch, Character.toString(ch)))\n            .collect(Collectors.joining());    \n}\n</code></pre>\n"}],"owner":{"account_id":20963346,"reputation":51,"user_id":15402266,"display_name":"user123123"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":68,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75966391,"answer_count":2,"score":0,"last_activity_date":1681024499,"creation_date":1680963471,"question_id":75965746,"body_markdown":"I have a string in Java that contains special characters like \\n and \\t which are interpreted as control characters and produce new lines and tabs when displayed. I want to display these special characters as plain text, for example, to display &quot;\\n&quot; as \\n and not as a new line. The string may also contain single or double quotation marks(&#39;)(&quot;) to be concise it can contain any possible character. \r\n\r\n```\r\nString text = &quot;Hello\\nWorld!&quot;;\r\ntext = text.replace(&quot;\\\\&quot;, &quot;\\\\\\\\&quot;);\r\ntext = text.replace(&quot;\\n&quot;, &quot;\\\\n&quot;);\r\nSystem.out.println(text);\r\n\r\n```\r\n\r\nIs there a way to achieve this in Java?","title":"How to display string formatters as plain text in Java?","body":"<p>I have a string in Java that contains special characters like \\n and \\t which are interpreted as control characters and produce new lines and tabs when displayed. I want to display these special characters as plain text, for example, to display &quot;\\n&quot; as \\n and not as a new line. The string may also contain single or double quotation marks(')(&quot;) to be concise it can contain any possible character.</p>\n<pre><code>String text = &quot;Hello\\nWorld!&quot;;\ntext = text.replace(&quot;\\\\&quot;, &quot;\\\\\\\\&quot;);\ntext = text.replace(&quot;\\n&quot;, &quot;\\\\n&quot;);\nSystem.out.println(text);\n\n</code></pre>\n<p>Is there a way to achieve this in Java?</p>\n"},{"tags":["java","picocli"],"answers":[{"comments":[{"owner":{"account_id":4068081,"reputation":10971,"user_id":3342253,"accept_rate":94,"display_name":"Jan Nielsen"},"score":0,"creation_date":1680933147,"post_id":75962464,"comment_id":133981417,"body_markdown":"Thanks, @Remko -- that&#39;s what I ended up doing. It works just fine. My trip-up was the result of the output of $DEFAULT-VALUES without the `split`...since the output cannot be used for input.","body":"Thanks, @Remko -- that&#39;s what I ended up doing. It works just fine. My trip-up was the result of the output of $DEFAULT-VALUES without the <code>split</code>...since the output cannot be used for input."}],"tags":[],"owner":{"account_id":1555751,"reputation":35615,"user_id":1446916,"display_name":"Remko Popma"},"comment_count":1,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1681022914,"creation_date":1680908289,"answer_id":75962464,"question_id":75955369,"body_markdown":"### Status as of picocli 4.7.1\r\n\r\nAs of version 4.7.1, picocli does not have direct support for setting default values for multi-value options or positional parameters. (&quot;Multi-value&quot; meaning: options/positional parameters that can be specified multiple times and have an array, a Collection or a Map as the underlying data type.)\r\n\r\n### Roadmap \r\n\r\nThere is a feature request for this on the picocli issue tracker: https://github.com/remkop/picocli/issues/879\r\nThe proposal is to add new API, that will allow option definitions like this:\r\n\r\n```java\r\n@Option(names = &quot;-x&quot;, defaultValues = { &quot;1.1&quot;, &quot;2.2&quot;, &quot;3.3&quot; })\r\ndouble[] values;\r\n```\r\n\r\nWhen implemented, that will also cover primitive arrays: default values are specified as Strings (just like command line values are) and are converted to the target data type by the type converter for that data type.\r\n\r\nPull requests are always welcome! &#128517;\r\n\r\n### Workaround \r\n\r\nWith the current version of picocli you may be able to work around this by defining the option with a [`split` regex](https://picocli.info/#_split_regex) to allow users to specify multiple comma-separated values after the option name. For example:\r\n\r\n```java\r\n@Option(\r\n    names        = {&quot;-m&quot;, &quot;--multiple-values&quot;},\r\n    defaultValue = &quot;0.00,0.25,0.50,1.25&quot;,\r\n    split        = &quot;,&quot;,\r\n    paramLabels  = &quot;values&quot;,\r\n    description  = &quot;multiple values (default: ${DEFAULT-VALUE})&quot;)\r\nprivate double[] values;\r\n```\r\n\r\nThat has a multi-value default, but will also allow users to specify command lines like this:\r\n\r\n```\r\nmycommand -m 1.1,2.2,3,3 -m 4.4 -m 5.5,6.6\r\n```\r\n\r\nThis may not be exactly what you want, but may be the closest we can get with the current version of picocli.","title":"PicoCLI &quot;defaultValue&quot; and option values for primitive arrays","body":"<h3>Status as of picocli 4.7.1</h3>\n<p>As of version 4.7.1, picocli does not have direct support for setting default values for multi-value options or positional parameters. (&quot;Multi-value&quot; meaning: options/positional parameters that can be specified multiple times and have an array, a Collection or a Map as the underlying data type.)</p>\n<h3>Roadmap</h3>\n<p>There is a feature request for this on the picocli issue tracker: <a href=\"https://github.com/remkop/picocli/issues/879\" rel=\"nofollow noreferrer\">https://github.com/remkop/picocli/issues/879</a>\nThe proposal is to add new API, that will allow option definitions like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Option(names = &quot;-x&quot;, defaultValues = { &quot;1.1&quot;, &quot;2.2&quot;, &quot;3.3&quot; })\ndouble[] values;\n</code></pre>\n<p>When implemented, that will also cover primitive arrays: default values are specified as Strings (just like command line values are) and are converted to the target data type by the type converter for that data type.</p>\n<p>Pull requests are always welcome! 😅</p>\n<h3>Workaround</h3>\n<p>With the current version of picocli you may be able to work around this by defining the option with a <a href=\"https://picocli.info/#_split_regex\" rel=\"nofollow noreferrer\"><code>split</code> regex</a> to allow users to specify multiple comma-separated values after the option name. For example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Option(\n    names        = {&quot;-m&quot;, &quot;--multiple-values&quot;},\n    defaultValue = &quot;0.00,0.25,0.50,1.25&quot;,\n    split        = &quot;,&quot;,\n    paramLabels  = &quot;values&quot;,\n    description  = &quot;multiple values (default: ${DEFAULT-VALUE})&quot;)\nprivate double[] values;\n</code></pre>\n<p>That has a multi-value default, but will also allow users to specify command lines like this:</p>\n<pre><code>mycommand -m 1.1,2.2,3,3 -m 4.4 -m 5.5,6.6\n</code></pre>\n<p>This may not be exactly what you want, but may be the closest we can get with the current version of picocli.</p>\n"}],"owner":{"account_id":4068081,"reputation":10971,"user_id":3342253,"accept_rate":94,"display_name":"Jan Nielsen"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":239,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":75962464,"answer_count":1,"score":1,"last_activity_date":1681022914,"creation_date":1680840020,"question_id":75955369,"body_markdown":"How are default values and option values for primitive arrays properly specified in PicoCli?\r\n\r\nA primitive value can be annotated with a `defaultValue` string value:\r\n\r\n```\r\n@Option(\r\n    names        = {&quot;--one-value&quot;},\r\n    defaultValue = &quot;1.25&quot;,\r\n    description  = &quot;one value (default: ${DEFAULT-VALUE})&quot;)\r\nprivate double oneValue;\r\n```\r\n\r\nor set with on the field:\r\n\r\n```\r\n@Option(\r\n    names        = {&quot;--one-value&quot;},\r\n    description  = &quot;one value (default: ${DEFAULT-VALUE})&quot;)\r\nprivate double oneValue = 1.25;\r\n```\r\n\r\nIn both cases `oneValue=1.25`; the description correctly reads as `one value (default: 1.25)`; and, the values can be overridden on the command line with:\r\n\r\n```\r\n--one-value=1.23\r\n```\r\n\r\nAn array of primitive values, however:\r\n\r\n```\r\n@Option(\r\n    names        = {&quot;--multiple-values&quot;},\r\n    defaultValue = &quot;[0.00, 0.25, 0.50, 1.25]&quot;,\r\n    paramLabels  = &quot;values&quot;,\r\n    description  = &quot;multiple values (default: ${DEFAULT-VALUE})&quot;)\r\nprivate double[] values;\r\n```\r\n\r\nfails with:\r\n\r\n```\r\nInvalid value for option &#39;--multiple-values&#39; (&lt;values&gt;): &#39;[0.00, 0.25, 0.50, 1.25]&#39; is not a double\r\n```\r\n\r\neven though the `${DEFAULT-VALUE}` help says:\r\n\r\n```\r\n--multiple-values=&lt;values&gt;  multiple values (default: &quot;[0.00, 0.25, 0.50, 1.25]&quot;)\r\n```\r\n\r\nThe default values can be set on the field:\r\n\r\n```\r\n@Option(\r\n    names        = {&quot;--multiple-values&quot;},\r\n    defaultValue = &quot;[0.00, 0.25, 0.50, 1.25]&quot;,\r\n    paramLabels  = &quot;values&quot;,\r\n    description  = &quot;one value (default: ${DEFAULT-VALUE})&quot;)\r\nprivate double[] values; = new double[] {0.00, 0.25, 0.50, 1.25};\r\n```\r\n\r\nbut in both cases these command line options fail:\r\n\r\n```\r\n--multiple-values=&quot;[0.10, 0.20]&quot;\r\n--multiple-values=&quot;0.10, 0.20&quot;\r\n--multiple-values=0.10,0.20\r\n```\r\n\r\nwith:\r\n\r\n```\r\n&#39;...&#39; is not a double\r\n```\r\n\r\nSo, what the right way to set the `defaultValues` and command line option for a primitive array?","title":"PicoCLI &quot;defaultValue&quot; and option values for primitive arrays","body":"<p>How are default values and option values for primitive arrays properly specified in PicoCli?</p>\n<p>A primitive value can be annotated with a <code>defaultValue</code> string value:</p>\n<pre><code>@Option(\n    names        = {&quot;--one-value&quot;},\n    defaultValue = &quot;1.25&quot;,\n    description  = &quot;one value (default: ${DEFAULT-VALUE})&quot;)\nprivate double oneValue;\n</code></pre>\n<p>or set with on the field:</p>\n<pre><code>@Option(\n    names        = {&quot;--one-value&quot;},\n    description  = &quot;one value (default: ${DEFAULT-VALUE})&quot;)\nprivate double oneValue = 1.25;\n</code></pre>\n<p>In both cases <code>oneValue=1.25</code>; the description correctly reads as <code>one value (default: 1.25)</code>; and, the values can be overridden on the command line with:</p>\n<pre><code>--one-value=1.23\n</code></pre>\n<p>An array of primitive values, however:</p>\n<pre><code>@Option(\n    names        = {&quot;--multiple-values&quot;},\n    defaultValue = &quot;[0.00, 0.25, 0.50, 1.25]&quot;,\n    paramLabels  = &quot;values&quot;,\n    description  = &quot;multiple values (default: ${DEFAULT-VALUE})&quot;)\nprivate double[] values;\n</code></pre>\n<p>fails with:</p>\n<pre><code>Invalid value for option '--multiple-values' (&lt;values&gt;): '[0.00, 0.25, 0.50, 1.25]' is not a double\n</code></pre>\n<p>even though the <code>${DEFAULT-VALUE}</code> help says:</p>\n<pre><code>--multiple-values=&lt;values&gt;  multiple values (default: &quot;[0.00, 0.25, 0.50, 1.25]&quot;)\n</code></pre>\n<p>The default values can be set on the field:</p>\n<pre><code>@Option(\n    names        = {&quot;--multiple-values&quot;},\n    defaultValue = &quot;[0.00, 0.25, 0.50, 1.25]&quot;,\n    paramLabels  = &quot;values&quot;,\n    description  = &quot;one value (default: ${DEFAULT-VALUE})&quot;)\nprivate double[] values; = new double[] {0.00, 0.25, 0.50, 1.25};\n</code></pre>\n<p>but in both cases these command line options fail:</p>\n<pre><code>--multiple-values=&quot;[0.10, 0.20]&quot;\n--multiple-values=&quot;0.10, 0.20&quot;\n--multiple-values=0.10,0.20\n</code></pre>\n<p>with:</p>\n<pre><code>'...' is not a double\n</code></pre>\n<p>So, what the right way to set the <code>defaultValues</code> and command line option for a primitive array?</p>\n"},{"tags":["java","vectorization"],"comments":[{"owner":{"account_id":2124329,"reputation":612,"user_id":1886904,"display_name":"egeorge"},"score":0,"creation_date":1680214254,"post_id":75893275,"comment_id":133865069,"body_markdown":"Maybe `.mul(2)` and `.div(2)` would do the trick.","body":"Maybe <code>.mul(2)</code> and <code>.div(2)</code> would do the trick."}],"answers":[{"tags":[],"owner":{"account_id":465573,"reputation":192703,"user_id":869736,"accept_rate":82,"display_name":"Louis Wasserman"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":true,"score":1,"last_activity_date":1681022908,"creation_date":1680219559,"answer_id":75893743,"question_id":75893275,"body_markdown":"The behavior is _correct_: pure `&lt;&lt;` for `int`s _also_ performs an `&amp;` operation on the shift amount.  The `&amp;` correctly does the appropriate `&amp;` operation for the values being operated on.\r\n\r\nASHR is _correctly_ equivalent to `&gt;&gt;`.  LSHR is equivalent to `&gt;&gt;&gt;`.  LSHL is equivalent to `&lt;&lt;`.  These all do the same thing as the normal operators do.\r\n\r\nSee [JLS 15.19](https://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.19) for details.","title":"Bitshifting a Java IntVector","body":"<p>The behavior is <em>correct</em>: pure <code>&lt;&lt;</code> for <code>int</code>s <em>also</em> performs an <code>&amp;</code> operation on the shift amount.  The <code>&amp;</code> correctly does the appropriate <code>&amp;</code> operation for the values being operated on.</p>\n<p>ASHR is <em>correctly</em> equivalent to <code>&gt;&gt;</code>.  LSHR is equivalent to <code>&gt;&gt;&gt;</code>.  LSHL is equivalent to <code>&lt;&lt;</code>.  These all do the same thing as the normal operators do.</p>\n<p>See <a href=\"https://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.19\" rel=\"nofollow noreferrer\">JLS 15.19</a> for details.</p>\n"}],"owner":{"account_id":13597048,"reputation":3428,"user_id":9808792,"display_name":"micycle"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":80,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75893743,"answer_count":1,"score":0,"last_activity_date":1681022908,"creation_date":1680213011,"question_id":75893275,"body_markdown":"How can I perform a bitwise shift operation (&lt;&lt; or &gt;&gt;) directly on an [`IntVector`][1] using the Java Vector API?\r\n\r\nI haven&#39;t been able to find anything obvious in the API to do this; the closest I&#39;ve found is `myIntVec.lanewise(VectorOperators.ASHR, shiftAmt)` but this performs an additional `AND` operation on the shift amount.\r\n\r\n\r\n  [1]: https://docs.oracle.com/en/java/javase/17/docs/api/jdk.incubator.vector/jdk/incubator/vector/IntVector.html","title":"Bitshifting a Java IntVector","body":"<p>How can I perform a bitwise shift operation (&lt;&lt; or &gt;&gt;) directly on an <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/jdk.incubator.vector/jdk/incubator/vector/IntVector.html\" rel=\"nofollow noreferrer\"><code>IntVector</code></a> using the Java Vector API?</p>\n<p>I haven't been able to find anything obvious in the API to do this; the closest I've found is <code>myIntVec.lanewise(VectorOperators.ASHR, shiftAmt)</code> but this performs an additional <code>AND</code> operation on the shift amount.</p>\n"},{"tags":["java","parsing","constructor","timestamp","delimiter"],"comments":[{"owner":{"account_id":12743722,"reputation":19966,"user_id":12567365,"display_name":"andrewJames"},"score":2,"creation_date":1679878391,"post_id":75851120,"comment_id":133794663,"body_markdown":"First suggestion: Do not use `SimpleDateFormat`. Instead use the modern [`DateTimeFormatter`](https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html). Second suggestion: &quot;_how to use the delimiter_&quot; Not 100% sure what you mean... But to include a tab in a Java `String` use `\\t` as in `&quot;foo\\tbar&quot;`","body":"First suggestion: Do not use <code>SimpleDateFormat</code>. Instead use the modern <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html\" rel=\"nofollow noreferrer\"><code>DateTimeFormatter</code></a>. Second suggestion: &quot;<i>how to use the delimiter</i>&quot; Not 100% sure what you mean... But to include a tab in a Java <code>String</code> use <code>\\t</code> as in <code>&quot;foo\\tbar&quot;</code>"},{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":0,"creation_date":1679889813,"post_id":75851120,"comment_id":133795799,"body_markdown":"`MST` is not a [real time zone name](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones). Time zone names are in a format of `Continent/Region` such as `America/Edmonton`. Those 2-4 character pseudo-zones are not standardized, and are not even unique.","body":"<code>MST</code> is not a <a href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\" rel=\"nofollow noreferrer\">real time zone name</a>. Time zone names are in a format of <code>Continent&#47;Region</code> such as <code>America&#47;Edmonton</code>. Those 2-4 character pseudo-zones are not standardized, and are not even unique."},{"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"score":0,"creation_date":1679889909,"post_id":75851120,"comment_id":133795808,"body_markdown":"Before posting here, search Stack Overflow thoroughly. Parsing tab-delimited text has been covered many times already. Ditto for parsing date-time text.","body":"Before posting here, search Stack Overflow thoroughly. Parsing tab-delimited text has been covered many times already. Ditto for parsing date-time text."},{"owner":{"account_id":7612423,"reputation":82506,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1679958478,"post_id":75851120,"comment_id":133811210,"body_markdown":"It doesn’t show from the question text, but the input line is equal to a string of `&quot;USGS\\t13206000\\t2021-12-30 14:30\\tMST\\t226\\tP&quot;`.","body":"It doesn’t show from the question text, but the input line is equal to a string of <code>&quot;USGS\\t13206000\\t2021-12-30 14:30\\tMST\\t226\\tP&quot;</code>."},{"owner":{"account_id":7612423,"reputation":82506,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1679959641,"post_id":75851120,"comment_id":133811338,"body_markdown":"I would use an intermediate step so you get three constructors in all (they need not be public all of them). In your `FlowSample(String line)` constructor simply call `this(line.split(&quot;\\t&quot;));`. This will pass an array of strings to the next constructor. Declare it as `FlowSample(String[] splitLine)` and implement as `this(splitLine[0], splitLine[1], splitLine[3], splitLine[5], splitLine[2], Double.parseDouble(splitLine[4]));`, which in turn calls the constructor you already have.","body":"I would use an intermediate step so you get three constructors in all (they need not be public all of them). In your <code>FlowSample(String line)</code> constructor simply call <code>this(line.split(&quot;\\t&quot;));</code>. This will pass an array of strings to the next constructor. Declare it as <code>FlowSample(String[] splitLine)</code> and implement as <code>this(splitLine[0], splitLine[1], splitLine[3], splitLine[5], splitLine[2], Double.parseDouble(splitLine[4]));</code>, which in turn calls the constructor you already have."},{"owner":{"account_id":7612423,"reputation":82506,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1679961220,"post_id":75851120,"comment_id":133811564,"body_markdown":"Handling local and UTC timestamp: In `FlowSample` declare `timestamp` a `ZonedDateTime`. To initialize it concatenate timestamp and time zone and parse using `this.timestamp = ZonedDateTime.parse(timestamp + timeZone, DateTimeFormatter.ofPattern(&quot;uuuu-MM-dd HH:mmz&quot;, Locale.ROOT));`. For formatting for output use a `DateTimeFormatter fmt = DateTimeFormatter.ofPattern(&quot;EEE dd MMM yyyy hh:mm:ss a zzz&quot;, Locale.US);`. Get your formatted strings from `timestamp.format(fmt)` (local) and `timestamp.withZoneSameInstant(ZoneId.of(&quot;Etc/UTC&quot;)).format(fmt)` (UTC).","body":"Handling local and UTC timestamp: In <code>FlowSample</code> declare <code>timestamp</code> a <code>ZonedDateTime</code>. To initialize it concatenate timestamp and time zone and parse using <code>this.timestamp = ZonedDateTime.parse(timestamp + timeZone, DateTimeFormatter.ofPattern(&quot;uuuu-MM-dd HH:mmz&quot;, Locale.ROOT));</code>. For formatting for output use a <code>DateTimeFormatter fmt = DateTimeFormatter.ofPattern(&quot;EEE dd MMM yyyy hh:mm:ss a zzz&quot;, Locale.US);</code>. Get your formatted strings from <code>timestamp.format(fmt)</code> (local) and <code>timestamp.withZoneSameInstant(ZoneId.of(&quot;Etc&#47;UTC&quot;)).format(f&zwnj;&#8203;mt)</code> (UTC)."},{"owner":{"account_id":7612423,"reputation":82506,"user_id":5772882,"display_name":"Anonymous"},"score":0,"creation_date":1679961365,"post_id":75851120,"comment_id":133811585,"body_markdown":"I also would not initialize the timestamp to epoch in case of a parse error but rather throw an exception. You know your use case and requirements the best, though.","body":"I also would not initialize the timestamp to epoch in case of a parse error but rather throw an exception. You know your use case and requirements the best, though."}],"answers":[{"tags":[],"owner":{"account_id":322981,"reputation":310755,"user_id":642706,"accept_rate":58,"display_name":"Basil Bourque"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681022574,"creation_date":1680995544,"answer_id":75968086,"question_id":75851120,"body_markdown":"Create some sample data.\r\n\r\n    String input = &quot;USGS\\t13206000\\t2021-12-30 14:30\\tMST\\t226\\tP&quot;;\r\n\r\nDefine a class as a [record][1] to represent your flow sample. \r\n\r\n    record FlowSample( String agency , String siteNumber , ZonedDateTime when , int flowRate , String qualityCode ) { }\r\n\r\nNotice that we use field for our final desired fields. A record’s default constructor directly assigns a value to each field. That is a good thing. You should &#128073; keep your constructors as short, simple, and sweet as possible. Parsing should be done *outside* the constructor. So let&#39;s add a `static` factory method to mediate between our textual input and our desired object.\r\n\r\nBefore we can write that factory method, we have to deal with a flaw in your input data. Your input uses `MST` as a time zone. Unfortunately, such 2-4 letter pseudo-zones are not standard. They are not even unique! Does `MST` mean *Malaysia Standard Time*? Or *Mountain Standard Time (North America)*? Even then, those values may refer to any of several multiple real time zones, each zone having its own history of past, present, and future changes to its offset-from-UTC. For example, [Mountain Standard Time][2] implies any of several time zones in Canada, United States, and Mexico.\r\n\r\nThese pseudo-zones should be used only in localized text for presentation to users (if that), and &#128073; never used when exchanging date-time values. \r\n\r\nSo are stuck with two possible ways to address your input-data flaw:\r\n\r\n - Convince the publisher of your data to use [real time zone][3] identifiers (`Continent/Region`) rather than these 2-4 character strings.\r\n - Write a method that takes a guess at parsing such inputs.\r\n\r\nLet&#39;s write that method.\r\n\r\n```java\r\nstatic ZoneId guessAtParsingPseudoTimeZone ( String pseudoZone )\r\n{\r\n    return switch ( pseudoZone )\r\n    {\r\n        case &quot;MST&quot; -&gt; ZoneId.of( &quot;America/Denver&quot; );\r\n        case &quot;PST&quot; -&gt; ZoneId.of( &quot;America/Los_Angeles&quot; );\r\n        default -&gt; throw new IllegalStateException( &quot;Unexpected pseudo time zone: &quot; + pseudoZone );\r\n    };\r\n}\r\n```\r\n\r\nNow we can complete that `static` parsing method.\r\n\r\nNote that we are *not* using the terribly flawed date-time classes seen in the Question. Those legacy classes were years ago supplanted by &#128073; the modern *java.time* classes defined in JSR 310. A date with time-of-day should be parsed as a `LocalDateTime`. However, a `LocalDateTime` is ambiguous as it cannot represent a point on the timeline. To pinpoint a point on the timeline, we need to apply a time zone (`ZoneId`) to get a `ZonedDateTime` object. \r\n\r\n```java\r\nstatic FlowSample parse ( String input )\r\n{\r\n    String[] parts = input.split( &quot;\\t&quot; );\r\n    String a = parts[ 0 ];\r\n    String s = parts[ 1 ];\r\n    LocalDateTime ldt = LocalDateTime.parse( parts[ 2 ].replace( &quot; &quot; , &quot;T&quot; ) );\r\n    ZoneId z = FlowSample.guessAtParsingPseudoTimeZone( parts[ 3 ] ); // Take a guess as to what the non-standard non-unique pseudo time zone might mean. CAUTION: This is faulty data. You should convince your data publisher to use real time zone names.\r\n    ZonedDateTime zdt = ldt.atZone( z );\r\n    int f = Integer.parseInt( parts[ 4 ] );\r\n    String q = parts[ 5 ];\r\n    return new FlowSample( a , s , zdt , f , q );\r\n}\r\n```\r\n\r\nWrite a complete example demo app to exercise our `FlowSample` record.\r\n\r\n```java\r\npackage work.basil.example.parsing;\r\n\r\nimport java.time.*;\r\n\r\npublic class App\r\n{\r\n    public static void main ( String[] args )\r\n    {\r\n        App app = new App();\r\n        app.demo();\r\n    }\r\n\r\n    private void demo ( )\r\n    {\r\n\r\n        String input = &quot;USGS\\t13206000\\t2021-12-30 14:30\\tMST\\t226\\tP&quot;; // Agency, Site number, Date-time, Pseudo-time-zone, Flow rate, Quality code.\r\n\r\n        record FlowSample( String agency , String siteNumber , ZonedDateTime when , int flowRate , String qualityCode )\r\n        {\r\n            static FlowSample parse ( String input )\r\n            {\r\n                String[] parts = input.split( &quot;\\t&quot; );\r\n                String a = parts[ 0 ];\r\n                String s = parts[ 1 ];\r\n                LocalDateTime ldt = LocalDateTime.parse( parts[ 2 ].replace( &quot; &quot; , &quot;T&quot; ) );\r\n                ZoneId z = FlowSample.guessAtParsingPseudoTimeZone( parts[ 3 ] ); // Take a guess as to what the non-standard non-unique pseudo time zone might mean. CAUTION: This is faulty data. You should convince your data publisher to use real time zone names.\r\n                ZonedDateTime zdt = ldt.atZone( z );\r\n                int f = Integer.parseInt( parts[ 4 ] );\r\n                String q = parts[ 5 ];\r\n                return new FlowSample( a , s , zdt , f , q );\r\n            }\r\n\r\n            static ZoneId guessAtParsingPseudoTimeZone ( String pseudoZone )\r\n            {\r\n                return switch ( pseudoZone )\r\n                {\r\n                    case &quot;MST&quot; -&gt; ZoneId.of( &quot;America/Denver&quot; );\r\n                    case &quot;PST&quot; -&gt; ZoneId.of( &quot;America/Los_Angeles&quot; );\r\n                    default -&gt; throw new IllegalStateException( &quot;Unexpected pseudo time zone: &quot; + pseudoZone );\r\n                };\r\n            }\r\n        }\r\n\r\n        FlowSample flowSample = FlowSample.parse( input );\r\n        System.out.println( &quot;flowSample = &quot; + flowSample );\r\n    }\r\n}\r\n```\r\n\r\nWhen run.\r\n\r\n&gt;flowSample = FlowSample[agency=USGS, siteNumber=13206000, when=2021-12-30T14:30-07:00[America/Denver], flowRate=226, qualityCode=P]\r\n\r\nTo report that moment as seen in UTC (an offset of zero), just call `ZonedDateTime#toInstant`. \r\n\r\n    String utc = flowSample.when().toInstant().toString() ;\r\n\r\n----------\r\n\r\n\r\nBy the way, that `qualityCode` field should likely be a custom-defined enum rather than a mere string. Perhaps also the `agency`. I will leave that as an exercise for the reader.\r\n\r\n\r\n  [1]: https://openjdk.org/jeps/395\r\n  [2]: https://en.wikipedia.org/wiki/Mountain_Time_Zone\r\n  [3]: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones","title":"How do you use parse for timestamp data?","body":"<p>Create some sample data.</p>\n<pre><code>String input = &quot;USGS\\t13206000\\t2021-12-30 14:30\\tMST\\t226\\tP&quot;;\n</code></pre>\n<p>Define a class as a <a href=\"https://openjdk.org/jeps/395\" rel=\"nofollow noreferrer\">record</a> to represent your flow sample.</p>\n<pre><code>record FlowSample( String agency , String siteNumber , ZonedDateTime when , int flowRate , String qualityCode ) { }\n</code></pre>\n<p>Notice that we use field for our final desired fields. A record’s default constructor directly assigns a value to each field. That is a good thing. You should 👉 keep your constructors as short, simple, and sweet as possible. Parsing should be done <em>outside</em> the constructor. So let's add a <code>static</code> factory method to mediate between our textual input and our desired object.</p>\n<p>Before we can write that factory method, we have to deal with a flaw in your input data. Your input uses <code>MST</code> as a time zone. Unfortunately, such 2-4 letter pseudo-zones are not standard. They are not even unique! Does <code>MST</code> mean <em>Malaysia Standard Time</em>? Or <em>Mountain Standard Time (North America)</em>? Even then, those values may refer to any of several multiple real time zones, each zone having its own history of past, present, and future changes to its offset-from-UTC. For example, <a href=\"https://en.wikipedia.org/wiki/Mountain_Time_Zone\" rel=\"nofollow noreferrer\">Mountain Standard Time</a> implies any of several time zones in Canada, United States, and Mexico.</p>\n<p>These pseudo-zones should be used only in localized text for presentation to users (if that), and 👉 never used when exchanging date-time values.</p>\n<p>So are stuck with two possible ways to address your input-data flaw:</p>\n<ul>\n<li>Convince the publisher of your data to use <a href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\" rel=\"nofollow noreferrer\">real time zone</a> identifiers (<code>Continent/Region</code>) rather than these 2-4 character strings.</li>\n<li>Write a method that takes a guess at parsing such inputs.</li>\n</ul>\n<p>Let's write that method.</p>\n<pre class=\"lang-java prettyprint-override\"><code>static ZoneId guessAtParsingPseudoTimeZone ( String pseudoZone )\n{\n    return switch ( pseudoZone )\n    {\n        case &quot;MST&quot; -&gt; ZoneId.of( &quot;America/Denver&quot; );\n        case &quot;PST&quot; -&gt; ZoneId.of( &quot;America/Los_Angeles&quot; );\n        default -&gt; throw new IllegalStateException( &quot;Unexpected pseudo time zone: &quot; + pseudoZone );\n    };\n}\n</code></pre>\n<p>Now we can complete that <code>static</code> parsing method.</p>\n<p>Note that we are <em>not</em> using the terribly flawed date-time classes seen in the Question. Those legacy classes were years ago supplanted by 👉 the modern <em>java.time</em> classes defined in JSR 310. A date with time-of-day should be parsed as a <code>LocalDateTime</code>. However, a <code>LocalDateTime</code> is ambiguous as it cannot represent a point on the timeline. To pinpoint a point on the timeline, we need to apply a time zone (<code>ZoneId</code>) to get a <code>ZonedDateTime</code> object.</p>\n<pre class=\"lang-java prettyprint-override\"><code>static FlowSample parse ( String input )\n{\n    String[] parts = input.split( &quot;\\t&quot; );\n    String a = parts[ 0 ];\n    String s = parts[ 1 ];\n    LocalDateTime ldt = LocalDateTime.parse( parts[ 2 ].replace( &quot; &quot; , &quot;T&quot; ) );\n    ZoneId z = FlowSample.guessAtParsingPseudoTimeZone( parts[ 3 ] ); // Take a guess as to what the non-standard non-unique pseudo time zone might mean. CAUTION: This is faulty data. You should convince your data publisher to use real time zone names.\n    ZonedDateTime zdt = ldt.atZone( z );\n    int f = Integer.parseInt( parts[ 4 ] );\n    String q = parts[ 5 ];\n    return new FlowSample( a , s , zdt , f , q );\n}\n</code></pre>\n<p>Write a complete example demo app to exercise our <code>FlowSample</code> record.</p>\n<pre class=\"lang-java prettyprint-override\"><code>package work.basil.example.parsing;\n\nimport java.time.*;\n\npublic class App\n{\n    public static void main ( String[] args )\n    {\n        App app = new App();\n        app.demo();\n    }\n\n    private void demo ( )\n    {\n\n        String input = &quot;USGS\\t13206000\\t2021-12-30 14:30\\tMST\\t226\\tP&quot;; // Agency, Site number, Date-time, Pseudo-time-zone, Flow rate, Quality code.\n\n        record FlowSample( String agency , String siteNumber , ZonedDateTime when , int flowRate , String qualityCode )\n        {\n            static FlowSample parse ( String input )\n            {\n                String[] parts = input.split( &quot;\\t&quot; );\n                String a = parts[ 0 ];\n                String s = parts[ 1 ];\n                LocalDateTime ldt = LocalDateTime.parse( parts[ 2 ].replace( &quot; &quot; , &quot;T&quot; ) );\n                ZoneId z = FlowSample.guessAtParsingPseudoTimeZone( parts[ 3 ] ); // Take a guess as to what the non-standard non-unique pseudo time zone might mean. CAUTION: This is faulty data. You should convince your data publisher to use real time zone names.\n                ZonedDateTime zdt = ldt.atZone( z );\n                int f = Integer.parseInt( parts[ 4 ] );\n                String q = parts[ 5 ];\n                return new FlowSample( a , s , zdt , f , q );\n            }\n\n            static ZoneId guessAtParsingPseudoTimeZone ( String pseudoZone )\n            {\n                return switch ( pseudoZone )\n                {\n                    case &quot;MST&quot; -&gt; ZoneId.of( &quot;America/Denver&quot; );\n                    case &quot;PST&quot; -&gt; ZoneId.of( &quot;America/Los_Angeles&quot; );\n                    default -&gt; throw new IllegalStateException( &quot;Unexpected pseudo time zone: &quot; + pseudoZone );\n                };\n            }\n        }\n\n        FlowSample flowSample = FlowSample.parse( input );\n        System.out.println( &quot;flowSample = &quot; + flowSample );\n    }\n}\n</code></pre>\n<p>When run.</p>\n<blockquote>\n<p>flowSample = FlowSample[agency=USGS, siteNumber=13206000, when=2021-12-30T14:30-07:00[America/Denver], flowRate=226, qualityCode=P]</p>\n</blockquote>\n<p>To report that moment as seen in UTC (an offset of zero), just call <code>ZonedDateTime#toInstant</code>.</p>\n<pre><code>String utc = flowSample.when().toInstant().toString() ;\n</code></pre>\n<hr />\n<p>By the way, that <code>qualityCode</code> field should likely be a custom-defined enum rather than a mere string. Perhaps also the <code>agency</code>. I will leave that as an exercise for the reader.</p>\n"}],"owner":{"account_id":21324968,"reputation":17,"user_id":15697489,"display_name":"chriscondreay"},"comment_count":7,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":62,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"answer_count":1,"score":-1,"last_activity_date":1681022574,"creation_date":1679873003,"question_id":75851120,"body_markdown":"I need to be able to print Flow Sample data in tab-delimited lines of text where each data field is separated by tabs. Using the tab-delimited lines I need to be able to type data in like:\r\n```terminal\r\nPlease enter the line of tab-separated data:\r\nUSGS\t13206000\t2021-12-30 14:30\tMST\t226\tP\r\n```\r\nand have it printed out like:\r\n```console\r\n---------------------\r\n|     Data Entry    |\r\n---------------------\r\nPlease enter the line of tab separated data:\r\nUSGS\t13206000\t2021-12-30 14:30\tMST\t226\tP\r\n\r\n---------------------\r\n| Data Confirmation |\r\n---------------------\r\nYou entered the following: \r\nAgency: USGS\r\nSite Number: 13206000\r\nLocal Timestamp: Thu 30 Dec 2021 02:30:00 PM MST\r\nUTC Timestamp: Thu 30 Dec 2021 09:30:00 PM UTC\r\nFlow Rate: 226.0\r\nQualification Code: P\r\n\r\n---------------------\r\n|  Sample Summary   |\r\n---------------------\r\n### USGS - 13206000 ###\r\nTimestamp: Thu 30 Dec 2021 09:30:00 PM UTC\r\nFlow Rate: 226.0\r\n```\r\nI need to be able to use another constructor class called FlowSample that takes in a single String value as a parameter\r\n\r\n    public FlowSample(String line) {...}\r\n\r\nI have created one FlowSample constructor:\r\n```\r\npublic FlowSample(String agency, String siteNumber, String timeZone, String qualCode, String timestamp, double flowRate) \r\n    {\r\n        this.agency = agency;\r\n        this.siteNumber = siteNumber;\r\n        this.qualCode = qualCode;\r\n        this.flowRate = flowRate;\r\n\r\n        /* Create date formatter and parse */\r\n        // 2021-12-20 14:30\r\n        SimpleDateFormat myFormatter = new SimpleDateFormat(&quot;yyy-MM-dd HH:mm&quot;);  // Format is same as data from USGS data\r\n\r\n        // Creating new timezone method and passes TimeZone object into myFormatter\r\n        myFormatter.setTimeZone(TimeZone.getTimeZone(timeZone));\r\n\r\n        try \r\n        {\r\n            // passing in timestamp from constructor\r\n            this.timestamp = myFormatter.parse(timestamp);\r\n        } \r\n        catch (ParseException e) \r\n        {\r\n            System.out.println(&quot;Error: Unable to parse timestamp: &quot; + timestamp);\r\n            /* Initialize timestamp with the epoch, January 1, 1970, 00:00:000 GMT */\r\n            this.timestamp = new Date(0);\r\n        }\r\n    }\r\n```\r\nI am unsure how to use the delimiter to print the data like this and I need help. Does anyone know how to help me and how the constructor should look and how to call it?","title":"How do you use parse for timestamp data?","body":"<p>I need to be able to print Flow Sample data in tab-delimited lines of text where each data field is separated by tabs. Using the tab-delimited lines I need to be able to type data in like:</p>\n<pre><code>Please enter the line of tab-separated data:\nUSGS    13206000    2021-12-30 14:30    MST 226 P\n</code></pre>\n<p>and have it printed out like:</p>\n<pre><code>---------------------\n|     Data Entry    |\n---------------------\nPlease enter the line of tab separated data:\nUSGS    13206000    2021-12-30 14:30    MST 226 P\n\n---------------------\n| Data Confirmation |\n---------------------\nYou entered the following: \nAgency: USGS\nSite Number: 13206000\nLocal Timestamp: Thu 30 Dec 2021 02:30:00 PM MST\nUTC Timestamp: Thu 30 Dec 2021 09:30:00 PM UTC\nFlow Rate: 226.0\nQualification Code: P\n\n---------------------\n|  Sample Summary   |\n---------------------\n### USGS - 13206000 ###\nTimestamp: Thu 30 Dec 2021 09:30:00 PM UTC\nFlow Rate: 226.0\n</code></pre>\n<p>I need to be able to use another constructor class called FlowSample that takes in a single String value as a parameter</p>\n<pre><code>public FlowSample(String line) {...}\n</code></pre>\n<p>I have created one FlowSample constructor:</p>\n<pre><code>public FlowSample(String agency, String siteNumber, String timeZone, String qualCode, String timestamp, double flowRate) \n    {\n        this.agency = agency;\n        this.siteNumber = siteNumber;\n        this.qualCode = qualCode;\n        this.flowRate = flowRate;\n\n        /* Create date formatter and parse */\n        // 2021-12-20 14:30\n        SimpleDateFormat myFormatter = new SimpleDateFormat(&quot;yyy-MM-dd HH:mm&quot;);  // Format is same as data from USGS data\n\n        // Creating new timezone method and passes TimeZone object into myFormatter\n        myFormatter.setTimeZone(TimeZone.getTimeZone(timeZone));\n\n        try \n        {\n            // passing in timestamp from constructor\n            this.timestamp = myFormatter.parse(timestamp);\n        } \n        catch (ParseException e) \n        {\n            System.out.println(&quot;Error: Unable to parse timestamp: &quot; + timestamp);\n            /* Initialize timestamp with the epoch, January 1, 1970, 00:00:000 GMT */\n            this.timestamp = new Date(0);\n        }\n    }\n</code></pre>\n<p>I am unsure how to use the delimiter to print the data like this and I need help. Does anyone know how to help me and how the constructor should look and how to call it?</p>\n"},{"tags":["java","mysql","hibernate"],"answers":[{"tags":[],"owner":{"account_id":3449881,"reputation":3520,"user_id":2889760,"display_name":"Gavin King"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1680863995,"creation_date":1680863995,"answer_id":75957681,"question_id":75951854,"body_markdown":"Hibernate does not send those queries. It is the JDBC driver which sends them. The relevant JDBC API is `java.sql.Connection.setAutoCommit()`, and in a container environment that method is usually called by your connection pool.","title":"How to see the SQL queries Hibernate issuing for setting transaction level and autocommit","body":"<p>Hibernate does not send those queries. It is the JDBC driver which sends them. The relevant JDBC API is <code>java.sql.Connection.setAutoCommit()</code>, and in a container environment that method is usually called by your connection pool.</p>\n"},{"tags":[],"owner":{"account_id":3171905,"reputation":10222,"user_id":2680640,"display_name":"sendon1982"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681021911,"creation_date":1681021911,"answer_id":75969096,"question_id":75951854,"body_markdown":"Hibernate config like is like this to enable auto commit:\r\n\r\n`&lt;property name=&quot;connection.autocommit&quot;&gt;true&lt;/property&gt;`\r\n\r\nTransaction Level can be set in the code\r\n\r\n```\r\nEntityManagerFactory emFactory = Persistence.createEntityManagerFactory(&quot;sampleUnit&quot;);\r\nEntityManager em1 = emFactory.createEntityManager();\r\nEntityTransaction t1 = em1.getTransaction();\r\nt1.begin();\r\ntry {\r\n  Query query = em1.createQuery(&quot;SELECT p FROM Product p WHERE name = :name&quot;);\r\n  query.setParameter(&quot;name&quot;, &quot;cherry&quot;);\r\n  List&lt;Product&gt; products = query.getResultList();\r\n  System.out.println(&quot;Got product size: &quot;+products.size());\r\n} finally {\r\n  t1.rollback();\r\n}\r\n```","title":"How to see the SQL queries Hibernate issuing for setting transaction level and autocommit","body":"<p>Hibernate config like is like this to enable auto commit:</p>\n<p><code>&lt;property name=&quot;connection.autocommit&quot;&gt;true&lt;/property&gt;</code></p>\n<p>Transaction Level can be set in the code</p>\n<pre><code>EntityManagerFactory emFactory = Persistence.createEntityManagerFactory(&quot;sampleUnit&quot;);\nEntityManager em1 = emFactory.createEntityManager();\nEntityTransaction t1 = em1.getTransaction();\nt1.begin();\ntry {\n  Query query = em1.createQuery(&quot;SELECT p FROM Product p WHERE name = :name&quot;);\n  query.setParameter(&quot;name&quot;, &quot;cherry&quot;);\n  List&lt;Product&gt; products = query.getResultList();\n  System.out.println(&quot;Got product size: &quot;+products.size());\n} finally {\n  t1.rollback();\n}\n</code></pre>\n"}],"owner":{"account_id":6328358,"reputation":21,"user_id":4914067,"display_name":"stevenchusm"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":34,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":2,"score":0,"last_activity_date":1681021911,"creation_date":1680799233,"question_id":75951854,"body_markdown":"On my MySQL server, in the general log I see a ton of logs that look like:\r\n```bash\r\n2023-03-31T09:31:23.208-07:00\t2023-03-31T16:31:23.208345Z37028 Query SET autocommit=0\r\n2023-03-31T09:31:23.211-07:00\t2023-03-31T16:31:23.211201Z36956 Query set session transaction read write\r\n2023-03-31T09:31:23.211-07:00\t2023-03-31T16:31:23.211807Z36957 Query /* dynamic native SQL query */ select now() /*app health check*/\r\n2023-03-31T09:31:23.255-07:00\t2023-03-31T16:31:23.255990Z36995 Query set session transaction read write\r\n2023-03-31T09:31:23.273-07:00\t2023-03-31T16:31:23.273013Z36957 Query set session transaction read write\r\n2023-03-31T09:31:23.276-07:00\t2023-03-31T16:31:23.276323Z36956 Query SET autocommit=0\r\n2023-03-31T09:31:23.320-07:00\t2023-03-31T16:31:23.320214Z36995 Query SET autocommit=0\r\n2023-03-31T09:31:23.334-07:00\t2023-03-31T16:31:23.334801Z36957 Query SET autocommit=0\r\n2023-03-31T09:31:23.461-07:00\t2023-03-31T16:31:23.461897Z37056 Query rollback\r\n```\r\n\r\nI would like to see them on the clientside logs, however. My Java is very rusty so please be patient. In case it&#39;s helpful, the question I&#39;m asking looks very similar to [this one](https://stackoverflow.com/questions/30576385/how-to-log-the-start-and-the-completion-of-db-transactions-in-hibernate), though the accepted answer there didn&#39;t actually end up working out for me either (this is a separate issue) :/\r\n\r\nI have a YAML file and have tried enabling the following:\r\n```yaml\r\nlogging:\r\n  levels:\r\n  - path: org.hibernate\r\n    value: trace\r\n  - path: org.hibernate.SQL\r\n    value: debug\r\n  - path: org.jooq\r\n    value: trace\r\n  - path: com.amazonaws\r\n    value: debug\r\n  - path: com.zaxxer\r\n    value: debug\r\n  - path: com.mysql\r\n    value: debug\r\n  - path: org.hibernate.engine.transaction.internal.TransactionImpl\r\n    value: debug\r\n  - path: com.mysql.clusterj.core.TransactionImpl\r\n    value: debug\r\n  - path: org.hibernate.jpa.internal.TransactionImpl\r\n    value: debug\r\n```","title":"How to see the SQL queries Hibernate issuing for setting transaction level and autocommit","body":"<p>On my MySQL server, in the general log I see a ton of logs that look like:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>2023-03-31T09:31:23.208-07:00   2023-03-31T16:31:23.208345Z37028 Query SET autocommit=0\n2023-03-31T09:31:23.211-07:00   2023-03-31T16:31:23.211201Z36956 Query set session transaction read write\n2023-03-31T09:31:23.211-07:00   2023-03-31T16:31:23.211807Z36957 Query /* dynamic native SQL query */ select now() /*app health check*/\n2023-03-31T09:31:23.255-07:00   2023-03-31T16:31:23.255990Z36995 Query set session transaction read write\n2023-03-31T09:31:23.273-07:00   2023-03-31T16:31:23.273013Z36957 Query set session transaction read write\n2023-03-31T09:31:23.276-07:00   2023-03-31T16:31:23.276323Z36956 Query SET autocommit=0\n2023-03-31T09:31:23.320-07:00   2023-03-31T16:31:23.320214Z36995 Query SET autocommit=0\n2023-03-31T09:31:23.334-07:00   2023-03-31T16:31:23.334801Z36957 Query SET autocommit=0\n2023-03-31T09:31:23.461-07:00   2023-03-31T16:31:23.461897Z37056 Query rollback\n</code></pre>\n<p>I would like to see them on the clientside logs, however. My Java is very rusty so please be patient. In case it's helpful, the question I'm asking looks very similar to <a href=\"https://stackoverflow.com/questions/30576385/how-to-log-the-start-and-the-completion-of-db-transactions-in-hibernate\">this one</a>, though the accepted answer there didn't actually end up working out for me either (this is a separate issue) :/</p>\n<p>I have a YAML file and have tried enabling the following:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>logging:\n  levels:\n  - path: org.hibernate\n    value: trace\n  - path: org.hibernate.SQL\n    value: debug\n  - path: org.jooq\n    value: trace\n  - path: com.amazonaws\n    value: debug\n  - path: com.zaxxer\n    value: debug\n  - path: com.mysql\n    value: debug\n  - path: org.hibernate.engine.transaction.internal.TransactionImpl\n    value: debug\n  - path: com.mysql.clusterj.core.TransactionImpl\n    value: debug\n  - path: org.hibernate.jpa.internal.TransactionImpl\n    value: debug\n</code></pre>\n"},{"tags":["java","eclipse"],"comments":[{"owner":{"account_id":22640093,"reputation":15,"user_id":16816391,"display_name":"nipeng"},"score":0,"creation_date":1681019974,"post_id":75968961,"comment_id":133990212,"body_markdown":"It will give some error `Unhandled exception type IOException` If I put it outside after the `catch` block and if I create another `try catch` after the `catch` it still return the same error","body":"It will give some error <code>Unhandled exception type IOException</code> If I put it outside after the <code>catch</code> block and if I create another <code>try catch</code> after the <code>catch</code> it still return the same error"},{"owner":{"account_id":5998820,"reputation":12676,"user_id":4712734,"display_name":"DuncG"},"score":0,"creation_date":1681027262,"post_id":75968961,"comment_id":133990831,"body_markdown":"Looks like you didn&#39;t copy your answer here: [Java delete file function is not working, my file not deleting and not throwing any errors](https://stackoverflow.com/questions/75966704/java-delete-file-function-is-not-working-my-file-not-deleting-and-not-throwing)","body":"Looks like you didn&#39;t copy your answer here: <a href=\"https://stackoverflow.com/questions/75966704/java-delete-file-function-is-not-working-my-file-not-deleting-and-not-throwing\">Java delete file function is not working, my file not deleting and not throwing any errors</a>"},{"owner":{"account_id":213468,"reputation":103500,"user_id":466862,"display_name":"Mark Rotteveel"},"score":0,"creation_date":1681122196,"post_id":75968961,"comment_id":134001549,"body_markdown":"Move the `Files.delete` and `Files.move` outside the try-with-resources, so that both the reader and the writer are already closed.","body":"Move the <code>Files.delete</code> and <code>Files.move</code> outside the try-with-resources, so that both the reader and the writer are already closed."}],"answers":[{"comments":[{"owner":{"account_id":22640093,"reputation":15,"user_id":16816391,"display_name":"nipeng"},"score":0,"creation_date":1681020269,"post_id":75968993,"comment_id":133990237,"body_markdown":"I think I already close it using the AutoClosable in the `try catch` block. I already try close it manually `fw.close()` and `br.close()`, It still return the same problem","body":"I think I already close it using the AutoClosable in the <code>try catch</code> block. I already try close it manually <code>fw.close()</code> and <code>br.close()</code>, It still return the same problem"},{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1681366785,"post_id":75968993,"comment_id":134045303,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/75968993/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":15459133,"reputation":1,"user_id":11152232,"display_name":"Pradheep Raaj"},"comment_count":2,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681019877,"creation_date":1681019877,"answer_id":75968993,"question_id":75968961,"body_markdown":"Try closing the writer which builds the file. Until it is closed, process consider the file as opened, so it wont allow you to delete","title":"Java: The process cannot access the file because it is being used by another process when deleting file","body":"<p>Try closing the writer which builds the file. Until it is closed, process consider the file as opened, so it wont allow you to delete</p>\n"},{"tags":[],"owner":{"account_id":2485939,"reputation":19426,"user_id":2164365,"accept_rate":40,"display_name":"Abra"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1681021901,"creation_date":1681021519,"answer_id":75969081,"question_id":75968961,"body_markdown":"You can&#39;t delete the file until it is closed and it is closed after exiting the [try-with-resources][1] block.\r\n\r\nI suggest using a nested `try`.\r\n```java\r\nimport java.io.BufferedReader;\r\nimport java.io.IOException;\r\nimport java.io.Writer;\r\nimport java.nio.file.Files;\r\nimport java.nio.file.Path;\r\nimport java.nio.file.Paths;\r\nimport java.nio.file.StandardOpenOption;\r\n\r\npublic class MyGame {\r\n\r\n    public static void main(String[] args) {\r\n        Path tempFile = Paths.get(&quot;temp.txt&quot;);\r\n        Path saveFile = Paths.get(&quot;save.txt&quot;);\r\n        Path playerFile = Paths.get(player.username + &quot;.txt&quot;);\r\n        try {\r\n            try (Writer fw = Files.newBufferedWriter(tempFile,\r\n                                                     StandardOpenOption.CREATE,\r\n                                                     StandardOpenOption.APPEND);\r\n                 BufferedReader br = Files.newBufferedReader(saveFile)) {\r\n                String line;\r\n                while ((line = br.readLine()) != null) {\r\n                    if (line.equals(player.username))\r\n                        continue;\r\n                    fw.write(line);\r\n                    fw.write(&quot;\\n&quot;);\r\n                }\r\n            }\r\n            Files.delete(saveFile);\r\n            Files.delete(playerFile);\r\n            Files.move(tempFile, saveFile);\r\n        }\r\n        catch (IOException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n}\r\n```\r\nNote that there is no need to explicitly create the &quot;temp&quot; file before writing to it. Besides which [CREATE_NEW][2] will throw an exception if the &quot;temp&quot; file already exists and I assume that this is not what you want.\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html\r\n  [2]: https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/file/StandardOpenOption.html#CREATE_NEW","title":"Java: The process cannot access the file because it is being used by another process when deleting file","body":"<p>You can't delete the file until it is closed and it is closed after exiting the <a href=\"https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html\" rel=\"nofollow noreferrer\">try-with-resources</a> block.</p>\n<p>I suggest using a nested <code>try</code>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.Writer;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.nio.file.Paths;\nimport java.nio.file.StandardOpenOption;\n\npublic class MyGame {\n\n    public static void main(String[] args) {\n        Path tempFile = Paths.get(&quot;temp.txt&quot;);\n        Path saveFile = Paths.get(&quot;save.txt&quot;);\n        Path playerFile = Paths.get(player.username + &quot;.txt&quot;);\n        try {\n            try (Writer fw = Files.newBufferedWriter(tempFile,\n                                                     StandardOpenOption.CREATE,\n                                                     StandardOpenOption.APPEND);\n                 BufferedReader br = Files.newBufferedReader(saveFile)) {\n                String line;\n                while ((line = br.readLine()) != null) {\n                    if (line.equals(player.username))\n                        continue;\n                    fw.write(line);\n                    fw.write(&quot;\\n&quot;);\n                }\n            }\n            Files.delete(saveFile);\n            Files.delete(playerFile);\n            Files.move(tempFile, saveFile);\n        }\n        catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<p>Note that there is no need to explicitly create the &quot;temp&quot; file before writing to it. Besides which <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/nio/file/StandardOpenOption.html#CREATE_NEW\" rel=\"nofollow noreferrer\">CREATE_NEW</a> will throw an exception if the &quot;temp&quot; file already exists and I assume that this is not what you want.</p>\n"}],"owner":{"account_id":22640093,"reputation":15,"user_id":16816391,"display_name":"nipeng"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":282,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":75969081,"answer_count":2,"score":0,"last_activity_date":1681021901,"creation_date":1681018906,"question_id":75968961,"body_markdown":"I want to delete some file in my device but I keep getting throws that the file is being used in another process. I&#39;m pretty sure I already terminate all the debug process and not opening any file expect my Eclipse IDE, which I did not open the file in the IDE either.\r\n\r\nHere&#39;s my code:\r\n\r\n```java\r\nPath tempFile = Paths.get(&quot;temp.txt&quot;);\r\ntry {\r\n    Files.newBufferedWriter(tempFile, StandardOpenOption.CREATE_NEW);\r\n} catch (IOException e) {\r\n    // TODO: handle exception\r\n}\r\nPath saveFile = Paths.get(&quot;save.txt&quot;);\r\nPath playerFile = Paths.get(player.username + &quot;.txt&quot;);\r\ntry (\r\n        Writer fw = Files.newBufferedWriter(tempFile, StandardOpenOption.APPEND);\r\n        BufferedReader br = Files.newBufferedReader(saveFile);\r\n    ) {\r\n    String line;\r\n    while ((line = br.readLine()) != null) {\r\n        if (line.equals(player.username))\r\n            continue;\r\n        fw.write(line);\r\n        fw.write(&quot;\\n&quot;);\r\n    }\r\n    Files.delete(saveFile);\r\n    Files.delete(playerFile);\r\n    Files.move(tempFile, saveFile);\r\n} catch (IOException e) {\r\n    e.printStackTrace();\r\n}\r\n```\r\nThe error is thrown when I reach the `Files.delete(saveFile)` line.\r\n","title":"Java: The process cannot access the file because it is being used by another process when deleting file","body":"<p>I want to delete some file in my device but I keep getting throws that the file is being used in another process. I'm pretty sure I already terminate all the debug process and not opening any file expect my Eclipse IDE, which I did not open the file in the IDE either.</p>\n<p>Here's my code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Path tempFile = Paths.get(&quot;temp.txt&quot;);\ntry {\n    Files.newBufferedWriter(tempFile, StandardOpenOption.CREATE_NEW);\n} catch (IOException e) {\n    // TODO: handle exception\n}\nPath saveFile = Paths.get(&quot;save.txt&quot;);\nPath playerFile = Paths.get(player.username + &quot;.txt&quot;);\ntry (\n        Writer fw = Files.newBufferedWriter(tempFile, StandardOpenOption.APPEND);\n        BufferedReader br = Files.newBufferedReader(saveFile);\n    ) {\n    String line;\n    while ((line = br.readLine()) != null) {\n        if (line.equals(player.username))\n            continue;\n        fw.write(line);\n        fw.write(&quot;\\n&quot;);\n    }\n    Files.delete(saveFile);\n    Files.delete(playerFile);\n    Files.move(tempFile, saveFile);\n} catch (IOException e) {\n    e.printStackTrace();\n}\n</code></pre>\n<p>The error is thrown when I reach the <code>Files.delete(saveFile)</code> line.</p>\n"},{"tags":["java","linked-list"],"comments":[{"owner":{"account_id":4726205,"reputation":12248,"user_id":4420967,"display_name":"James Z"},"score":1,"creation_date":1681018027,"post_id":75968865,"comment_id":133990067,"body_markdown":"Well, you&#39;re using `StudentAdd` for all the printing, which I guess is the last student you added. `current` is not used for anything else than just going through the list.","body":"Well, you&#39;re using <code>StudentAdd</code> for all the printing, which I guess is the last student you added. <code>current</code> is not used for anything else than just going through the list."},{"owner":{"account_id":11874421,"reputation":39,"user_id":19835998,"display_name":"Alex"},"score":0,"creation_date":1681115934,"post_id":75968865,"comment_id":134000481,"body_markdown":"@JamesZ, in `StudentAdd.java` will be the getter and setter for storing and getting the StudentID, groups, and Priority. \nIn `LinkedList.java` will be `add` for being `AddToHead` or `AddToTail`. \n\nAlso a `toString()` program will be stored in `LinkedList.java`.","body":"@JamesZ, in <code>StudentAdd.java</code> will be the getter and setter for storing and getting the StudentID, groups, and Priority.  In <code>LinkedList.java</code> will be <code>add</code> for being <code>AddToHead</code> or <code>AddToTail</code>.   Also a <code>toString()</code> program will be stored in <code>LinkedList.java</code>."}],"answers":[{"comments":[{"owner":{"account_id":11874421,"reputation":39,"user_id":19835998,"display_name":"Alex"},"score":0,"creation_date":1681115587,"post_id":75969086,"comment_id":134000429,"body_markdown":"Well, I had tried to get the data, while it displayed as `StudentAdd@5fd0d5ae` , which can&#39;t displays the value which I would like to get. How could I get the value in the class?","body":"Well, I had tried to get the data, while it displayed as <code>StudentAdd@5fd0d5ae</code> , which can&#39;t displays the value which I would like to get. How could I get the value in the class?"}],"tags":[],"owner":{"account_id":5512797,"reputation":72,"user_id":4378540,"display_name":"Jinendra"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1681021729,"creation_date":1681021729,"answer_id":75969086,"question_id":75968865,"body_markdown":"refer &quot;current&quot; node in the while loop instead of &quot;StudentAdd&quot;, something like below\r\n\r\n    while (current != null) {\r\n        str += &quot;StudentID: &quot; + current.getStudentID() + &quot; is in Group &quot; +\r\n            current.getGroup().toUpperCase() + &quot; with priority &quot; + \r\n            current.getPriority();\r\n            str += &quot;]\\n&quot;;\r\n            current = current.getNext();\r\n\r\n        }","title":"How to get value in LinkedList which have two values","body":"<p>refer &quot;current&quot; node in the while loop instead of &quot;StudentAdd&quot;, something like below</p>\n<pre><code>while (current != null) {\n    str += &quot;StudentID: &quot; + current.getStudentID() + &quot; is in Group &quot; +\n        current.getGroup().toUpperCase() + &quot; with priority &quot; + \n        current.getPriority();\n        str += &quot;]\\n&quot;;\n        current = current.getNext();\n\n    }\n</code></pre>\n"}],"owner":{"account_id":11874421,"reputation":39,"user_id":19835998,"display_name":"Alex"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":48,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"accepted_answer_id":75969086,"answer_count":1,"score":1,"last_activity_date":1681021729,"creation_date":1681016994,"question_id":75968865,"body_markdown":"I have three variables in the linked list (take an example, StudentID, Group, Priority)\r\n\r\nI have used the following codes for the program:\r\n\r\n```\r\npublic String toString() {\r\n\tSystem.out.println(&quot;--------------------------------------&quot;);\r\n\tString str = &quot; &quot;;\r\n\r\n\tListNode current = head;\r\n\twhile (current != null) {\r\n\t\tstr += &quot;StudentID: &quot; + StudentAdd.getStudentID() + &quot; is in Group &quot; +\r\n \t\t\tStudentAdd.getGroup().toUpperCase() + &quot; with priority &quot; + \r\n\t\t\tStudentAdd.getPriority();\r\n\t\t\tstr += &quot;]\\n&quot;;\r\n\t\t\tcurrent = current.getNext();\r\n\r\n\t\t}\r\n\t\t\r\n\t\treturn str;\r\n\t}\r\n```\r\n\r\nI would like to get the following outputs\r\n\r\n```\r\n[StudentID:0001 is in Group A with Priority 1]\r\n[StudentID:0005 is in Group C with Priority 1]\r\n[StudentID:0220 is in Group B with Priority 2]\r\n[StudentID:0200 is in Group B with Priority 2]\r\n[StudentID:0215 is in Group B with Priority 2]\r\n[StudentID:0315 is in Group B with Priority 3]\r\n[StudentID:0301 is in Group B with Priority 3]\r\n[StudentID:0350 is in Group B with Priority 3]\r\n```\r\n\r\n\r\nHowever, the I only got the following output\r\n```\r\n[StudentID:0350 is in Group B with Priority 3]\r\n[StudentID:0350 is in Group B with Priority 3]\r\n[StudentID:0350 is in Group B with Priority 3]\r\n[StudentID:0350 is in Group B with Priority 3]\r\n[StudentID:0350 is in Group B with Priority 3]\r\n[StudentID:0350 is in Group B with Priority 3]\r\n[StudentID:0350 is in Group B with Priority 3]\r\n[StudentID:0350 is in Group B with Priority 3]\r\n```\r\n\r\nIt just displayed the last input of the student.\r\n\r\nSo how could I update it?","title":"How to get value in LinkedList which have two values","body":"<p>I have three variables in the linked list (take an example, StudentID, Group, Priority)</p>\n<p>I have used the following codes for the program:</p>\n<pre><code>public String toString() {\n    System.out.println(&quot;--------------------------------------&quot;);\n    String str = &quot; &quot;;\n\n    ListNode current = head;\n    while (current != null) {\n        str += &quot;StudentID: &quot; + StudentAdd.getStudentID() + &quot; is in Group &quot; +\n            StudentAdd.getGroup().toUpperCase() + &quot; with priority &quot; + \n            StudentAdd.getPriority();\n            str += &quot;]\\n&quot;;\n            current = current.getNext();\n\n        }\n        \n        return str;\n    }\n</code></pre>\n<p>I would like to get the following outputs</p>\n<pre><code>[StudentID:0001 is in Group A with Priority 1]\n[StudentID:0005 is in Group C with Priority 1]\n[StudentID:0220 is in Group B with Priority 2]\n[StudentID:0200 is in Group B with Priority 2]\n[StudentID:0215 is in Group B with Priority 2]\n[StudentID:0315 is in Group B with Priority 3]\n[StudentID:0301 is in Group B with Priority 3]\n[StudentID:0350 is in Group B with Priority 3]\n</code></pre>\n<p>However, the I only got the following output</p>\n<pre><code>[StudentID:0350 is in Group B with Priority 3]\n[StudentID:0350 is in Group B with Priority 3]\n[StudentID:0350 is in Group B with Priority 3]\n[StudentID:0350 is in Group B with Priority 3]\n[StudentID:0350 is in Group B with Priority 3]\n[StudentID:0350 is in Group B with Priority 3]\n[StudentID:0350 is in Group B with Priority 3]\n[StudentID:0350 is in Group B with Priority 3]\n</code></pre>\n<p>It just displayed the last input of the student.</p>\n<p>So how could I update it?</p>\n"},{"tags":["java","xuggle"],"comments":[{"owner":{"account_id":7019748,"reputation":1984,"user_id":5379668,"accept_rate":59,"display_name":"Davide"},"score":0,"creation_date":1681020979,"post_id":19523935,"comment_id":133990305,"body_markdown":"Same problem here after 10 years! Mac and Windows works, Raspbian not working. Project is compiled by maven","body":"Same problem here after 10 years! Mac and Windows works, Raspbian not working. Project is compiled by maven"}],"owner":{"account_id":987807,"reputation":85,"user_id":1005904,"display_name":"Andrei Baidoc"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":264,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1681020958,"creation_date":1382461023,"question_id":19523935,"body_markdown":"I have a problem running Xuggler on linux:\r\n&lt;!-- language: lang-none --&gt;\r\n\r\n    08:43:05.550 [main] WARN  com.xuggle.ferry.JNILibrary - Failure: library load of library: xuggle; url: /tmp/xuggle/xuggle2624685369771797713.tmp; error: java.lang.UnsatisfiedLinkError: /tmp/xuggle/xuggle2624685369771797713.tmp: /tmp/xuggle/xuggle2624685369771797713.tmp: failed to map segment from shared object: Operation not permitted\r\n    08:43:05.565 [main] ERROR com.xuggle.ferry.JNILibraryLoader - Could not load library: xuggle; version: 5; Visit http://www.xuggle.com/xuggler/faq/ to find common solutions to this problem\r\n    Exception in thread &quot;main&quot; java.lang.UnsatisfiedLinkError: no xuggle in java.library.path\r\n\r\nSame JAR works fine on Windows.\r\n\r\nI tried to include xuggler-5.4.jar, 5.2.jar, I also tried to make maven project and to compile with maven, the problem persists.\r\n\r\nHere is the CLASSPATH, so you can see I also included lately in the classpath the jar\r\n/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.25.x86_64//jre/lib/ext:/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.25.x86_64//lib/tools.jar:/home/baidoc/libs/xuggle-xuggler-5.4.jar\r\n","title":"Cannot run Xuggler on linux","body":"<p>I have a problem running Xuggler on linux:\n</p>\n\n<pre><code>08:43:05.550 [main] WARN  com.xuggle.ferry.JNILibrary - Failure: library load of library: xuggle; url: /tmp/xuggle/xuggle2624685369771797713.tmp; error: java.lang.UnsatisfiedLinkError: /tmp/xuggle/xuggle2624685369771797713.tmp: /tmp/xuggle/xuggle2624685369771797713.tmp: failed to map segment from shared object: Operation not permitted\n08:43:05.565 [main] ERROR com.xuggle.ferry.JNILibraryLoader - Could not load library: xuggle; version: 5; Visit http://www.xuggle.com/xuggler/faq/ to find common solutions to this problem\nException in thread \"main\" java.lang.UnsatisfiedLinkError: no xuggle in java.library.path\n</code></pre>\n\n<p>Same JAR works fine on Windows.</p>\n\n<p>I tried to include xuggler-5.4.jar, 5.2.jar, I also tried to make maven project and to compile with maven, the problem persists.</p>\n\n<p>Here is the CLASSPATH, so you can see I also included lately in the classpath the jar\n/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.25.x86_64//jre/lib/ext:/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.25.x86_64//lib/tools.jar:/home/baidoc/libs/xuggle-xuggler-5.4.jar</p>\n"},{"tags":["java","gerrit"],"owner":{"account_id":5318745,"reputation":721,"user_id":4242765,"accept_rate":30,"display_name":"Ram Kowsu"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":32,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"answer_count":0,"score":1,"last_activity_date":1681020492,"creation_date":1681020492,"question_id":75969023,"body_markdown":"I am implementing some automation framework on gerrit server\r\n\r\nI was trying to pull all the users using the below api\r\n\r\n`gerritApi.accounts().query()` // it is giving not implemented exception\r\n\r\n`gerritApi.accounts().suggestAccounts().get()` // it is giving static list of 100 users whereas the requirement is to fetch all the users in gerrit server\r\n\r\n\r\nIs there anyway to get all the users under Gerrit server\r\nI am even fine with that project level, meaning if fetching all the users which are working under project/group.\r\n\r\nFYI: I am using below gradle dependency \r\n\r\n    implementation &#39;com.urswolfer.gerrit.client.rest:gerrit-rest-java-client:0.9.5&#39;\r\n\r\n","title":"Access all accounts in which are in Gerrit server","body":"<p>I am implementing some automation framework on gerrit server</p>\n<p>I was trying to pull all the users using the below api</p>\n<p><code>gerritApi.accounts().query()</code> // it is giving not implemented exception</p>\n<p><code>gerritApi.accounts().suggestAccounts().get()</code> // it is giving static list of 100 users whereas the requirement is to fetch all the users in gerrit server</p>\n<p>Is there anyway to get all the users under Gerrit server\nI am even fine with that project level, meaning if fetching all the users which are working under project/group.</p>\n<p>FYI: I am using below gradle dependency</p>\n<pre><code>implementation 'com.urswolfer.gerrit.client.rest:gerrit-rest-java-client:0.9.5'\n</code></pre>\n"},{"tags":["java","java-8","comparator"],"answers":[{"comments":[{"owner":{"account_id":319581,"reputation":3587,"user_id":637423,"display_name":"Geert"},"score":3,"creation_date":1601390888,"post_id":28500970,"comment_id":113389686,"body_markdown":"So the reason this solution works is because of the order of nesting of comparators. In your question the innermost comparator (and therefore the first to be executed) was `ToSort::getSortBy` and the `nullsFirst` was wrapped around it. In this answer the `nullsFirst` comparator is now executed first, providing safety before the null-returning `getSortBy` calls","body":"So the reason this solution works is because of the order of nesting of comparators. In your question the innermost comparator (and therefore the first to be executed) was <code>ToSort::getSortBy</code> and the <code>nullsFirst</code> was wrapped around it. In this answer the <code>nullsFirst</code> comparator is now executed first, providing safety before the null-returning <code>getSortBy</code> calls"}],"tags":[],"owner":{"account_id":5368841,"reputation":9821,"user_id":4277915,"display_name":"flo"},"comment_count":1,"down_vote_count":0,"up_vote_count":208,"is_accepted":true,"score":208,"last_activity_date":1423834863,"creation_date":1423834863,"answer_id":28500970,"question_id":28499846,"body_markdown":"Found a possible solution:\r\n\r\n    Comparator.comparing(ToSort::getSortBy, \r\n          Comparator.nullsFirst(Comparator.naturalOrder())\r\n    )","title":"null-safe mapping Comparator using default implementations","body":"<p>Found a possible solution:</p>\n\n<pre><code>Comparator.comparing(ToSort::getSortBy, \n      Comparator.nullsFirst(Comparator.naturalOrder())\n)\n</code></pre>\n"},{"tags":[],"owner":{"account_id":4503853,"reputation":536,"user_id":3661748,"display_name":"cody.tv.weber"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1681018772,"creation_date":1680636567,"answer_id":75933143,"question_id":28499846,"body_markdown":"Snippet for streams:\r\n\r\n    somePersonList\r\n        .stream()\r\n        .sorted(\r\n            Comparator.comparing(SomePerson::getName,\r\n            Comparator.nullsLast(String::compareTo))\r\n        )\r\n        .collect(Collectors.toList())","title":"null-safe mapping Comparator using default implementations","body":"<p>Snippet for streams:</p>\n<pre><code>somePersonList\n    .stream()\n    .sorted(\n        Comparator.comparing(SomePerson::getName,\n        Comparator.nullsLast(String::compareTo))\n    )\n    .collect(Collectors.toList())\n</code></pre>\n"}],"owner":{"account_id":5368841,"reputation":9821,"user_id":4277915,"display_name":"flo"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":32811,"favorite_count":0,"down_vote_count":0,"up_vote_count":113,"accepted_answer_id":28500970,"answer_count":2,"score":113,"last_activity_date":1681018772,"creation_date":1423831242,"question_id":28499846,"body_markdown":"Is there a build-in possibility to create a null-safe mapping comparator in Java 8 without writing a own implementation of `Comparator`?\r\n\r\nWhen running the following code, it causes a NPE because the `keyExtractor` argument of `Comparator.comparing()` may return a `null` value:\r\n\r\n    public class ToSort\r\n    {\r\n    \r\n        private String sortBy;\r\n    \r\n        public ToSort(String sortBy)\r\n        {\r\n            this.sortBy = sortBy;\r\n        }\r\n    \r\n        public String getSortBy()\r\n        {\r\n            return sortBy;\r\n        }\r\n    \r\n        public static void main(String[] args)\r\n        {\r\n            // mapping comparator\r\n            Comparator&lt;ToSort&gt; comp = Comparator.comparing(ToSort::getSortBy);                          \r\n            SortedSet&lt;ToSort&gt; set = new TreeSet&lt;&gt;(comp);\r\n            ToSort o1 = new ToSort(&quot;1&quot;);\r\n            ToSort o2 = new ToSort(null);\r\n            \r\n            set.add(o1);\r\n            \r\n            System.out.println(set.contains(o2)); //NPE because o2.getSortBy() == null\r\n            \r\n        }\r\n    }\r\n\r\n&gt; Exception in thread &quot;main&quot; java.lang.NullPointerException\r\n\tat java.util.Comparator.lambda$comparing$77a9974f$1(Comparator.java:469)\r\n\tat java.util.Comparator$$Lambda$2/1480010240.compare(Unknown Source)\r\n\tat java.util.Comparators$NullComparator.compare(Comparators.java:83)\r\n\tat java.util.TreeMap.getEntryUsingComparator(TreeMap.java:376)\r\n\tat java.util.TreeMap.getEntry(TreeMap.java:345)\r\n\tat java.util.TreeMap.containsKey(TreeMap.java:232)\r\n\tat java.util.TreeSet.contains(TreeSet.java:234)\r\n\tat test.ToSort.main(ToSort.java:48)\r\n\r\nUsing \r\n\r\n    Comparator&lt;ToSort&gt; comp = Comparator.nullsFirst(Comparator.comparing(ToSort::getSortBy));\r\n\r\ndoes not work either as only `ToSort` objects that are `null` are treaded properly.\r\n\r\nI know how to write my own `Comparator` implementation, I`m just searching a more &quot;elegant&quot; solution like\r\n\r\n    Comparator.comparingNullsFirst(ToSort::getSortBy)","title":"null-safe mapping Comparator using default implementations","body":"<p>Is there a build-in possibility to create a null-safe mapping comparator in Java 8 without writing a own implementation of <code>Comparator</code>?</p>\n\n<p>When running the following code, it causes a NPE because the <code>keyExtractor</code> argument of <code>Comparator.comparing()</code> may return a <code>null</code> value:</p>\n\n<pre><code>public class ToSort\n{\n\n    private String sortBy;\n\n    public ToSort(String sortBy)\n    {\n        this.sortBy = sortBy;\n    }\n\n    public String getSortBy()\n    {\n        return sortBy;\n    }\n\n    public static void main(String[] args)\n    {\n        // mapping comparator\n        Comparator&lt;ToSort&gt; comp = Comparator.comparing(ToSort::getSortBy);                          \n        SortedSet&lt;ToSort&gt; set = new TreeSet&lt;&gt;(comp);\n        ToSort o1 = new ToSort(\"1\");\n        ToSort o2 = new ToSort(null);\n\n        set.add(o1);\n\n        System.out.println(set.contains(o2)); //NPE because o2.getSortBy() == null\n\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>Exception in thread \"main\" java.lang.NullPointerException\n      at java.util.Comparator.lambda$comparing$77a9974f$1(Comparator.java:469)\n      at java.util.Comparator$$Lambda$2/1480010240.compare(Unknown Source)\n      at java.util.Comparators$NullComparator.compare(Comparators.java:83)\n      at java.util.TreeMap.getEntryUsingComparator(TreeMap.java:376)\n      at java.util.TreeMap.getEntry(TreeMap.java:345)\n      at java.util.TreeMap.containsKey(TreeMap.java:232)\n      at java.util.TreeSet.contains(TreeSet.java:234)\n      at test.ToSort.main(ToSort.java:48)</p>\n</blockquote>\n\n<p>Using </p>\n\n<pre><code>Comparator&lt;ToSort&gt; comp = Comparator.nullsFirst(Comparator.comparing(ToSort::getSortBy));\n</code></pre>\n\n<p>does not work either as only <code>ToSort</code> objects that are <code>null</code> are treaded properly.</p>\n\n<p>I know how to write my own <code>Comparator</code> implementation, I`m just searching a more \"elegant\" solution like</p>\n\n<pre><code>Comparator.comparingNullsFirst(ToSort::getSortBy)\n</code></pre>\n"},{"tags":["java","android","gradle"],"answers":[{"comments":[{"owner":{"account_id":13060317,"reputation":580,"user_id":9437740,"display_name":"VanessaF"},"score":0,"creation_date":1680579470,"post_id":75916764,"comment_id":133918094,"body_markdown":"Thanks Jeeva for your answer. I tried what you suggested but still get the error message `Could not find com.android.tools.build:gradle:7.6.`. I think the problem might be in the line ``classpath &#39;com.android.tools.build:gradle:7.6&#39;` of the build.gradle file, because when I for example use `classpath &#39;com.android.tools.build:gradle:7.4&#39;` I get the error message `Could not find com.android.tools.build:gradle:7.4.`","body":"Thanks Jeeva for your answer. I tried what you suggested but still get the error message <code>Could not find com.android.tools.build:gradle:7.6.</code>. I think the problem might be in the line ``classpath &#39;com.android.tools.build:gradle:7.6&#39;` of the build.gradle file, because when I for example use <code>classpath &#39;com.android.tools.build:gradle:7.4&#39;</code> I get the error message <code>Could not find com.android.tools.build:gradle:7.4.</code>"},{"owner":{"account_id":7758137,"reputation":1831,"user_id":6059583,"accept_rate":62,"display_name":"Jeeva"},"score":0,"creation_date":1680599938,"post_id":75916764,"comment_id":133921601,"body_markdown":"@VanessaF https://stackoverflow.com/a/73968815/6059583 Please follow this answer.","body":"@VanessaF <a href=\"https://stackoverflow.com/a/73968815/6059583\">stackoverflow.com/a/73968815/6059583</a> Please follow this answer."},{"owner":{"account_id":7758137,"reputation":1831,"user_id":6059583,"accept_rate":62,"display_name":"Jeeva"},"score":0,"creation_date":1680600127,"post_id":75916764,"comment_id":133921649,"body_markdown":"https://stackoverflow.com/a/75728038/6059583","body":"<a href=\"https://stackoverflow.com/a/75728038/6059583\">stackoverflow.com/a/75728038/6059583</a>"},{"owner":{"account_id":13060317,"reputation":580,"user_id":9437740,"display_name":"VanessaF"},"score":0,"creation_date":1680674942,"post_id":75916764,"comment_id":133936172,"body_markdown":"Thanks Jeeva for your comment. When trying what is said in your suggested links I get the following error message `The Android Gradle plugin supports only Kotlin Gradle plugin version 1.5.20 and higher.\nThe following dependencies do not satisfy the required version:\nroot project &#39;DServer&#39; -&gt; androidx.navigation:navigation-safe-args-gradle-plugin:2.3.0 -&gt; org.jetbrains.kotlin:kotlin-gradle-plugin:1.3.20`.","body":"Thanks Jeeva for your comment. When trying what is said in your suggested links I get the following error message <code>The Android Gradle plugin supports only Kotlin Gradle plugin version 1.5.20 and higher. The following dependencies do not satisfy the required version: root project &#39;DServer&#39; -&gt; androidx.navigation:navigation-safe-args-gradle-plugin:2.3.0 -&gt; org.jetbrains.kotlin:kotlin-gradle-plugin:1.3.20</code>."},{"owner":{"account_id":13060317,"reputation":580,"user_id":9437740,"display_name":"VanessaF"},"score":0,"creation_date":1680761641,"post_id":75916764,"comment_id":133953588,"body_markdown":"Any comments to my last comment? I&#39;ll highly appreciate every further comment from you","body":"Any comments to my last comment? I&#39;ll highly appreciate every further comment from you"},{"owner":{"account_id":7758137,"reputation":1831,"user_id":6059583,"accept_rate":62,"display_name":"Jeeva"},"score":0,"creation_date":1680762346,"post_id":75916764,"comment_id":133953722,"body_markdown":"@VanessaF im not sure what you have tried in build.gradle i tried the steps in link and it worked for me","body":"@VanessaF im not sure what you have tried in build.gradle i tried the steps in link and it worked for me"},{"owner":{"account_id":7758137,"reputation":1831,"user_id":6059583,"accept_rate":62,"display_name":"Jeeva"},"score":0,"creation_date":1680762507,"post_id":75916764,"comment_id":133953758,"body_markdown":"@VanessaF i have updated my answer hope you have done the same","body":"@VanessaF i have updated my answer hope you have done the same"},{"owner":{"account_id":13060317,"reputation":580,"user_id":9437740,"display_name":"VanessaF"},"score":0,"creation_date":1680845135,"post_id":75916764,"comment_id":133968806,"body_markdown":"Thanks for your comments. I tried what you suggested but still get an error message. I updated my question with the new files.","body":"Thanks for your comments. I tried what you suggested but still get an error message. I updated my question with the new files."},{"owner":{"account_id":13060317,"reputation":580,"user_id":9437740,"display_name":"VanessaF"},"score":0,"creation_date":1681089571,"post_id":75916764,"comment_id":133997891,"body_markdown":"Now I get the error `Execution failed for task &#39;:app:extractDeepLinksDebug&#39;.\n&gt; Unable to make field private final java.lang.String java.io.File.path accessible: module java.base does not &quot;opens java.io&quot; to unnamed module @5710727a\n`","body":"Now I get the error <code>Execution failed for task &#39;:app:extractDeepLinksDebug&#39;. &gt; Unable to make field private final java.lang.String java.io.File.path accessible: module java.base does not &quot;opens java.io&quot; to unnamed module @5710727a </code>"}],"tags":[],"owner":{"account_id":7758137,"reputation":1831,"user_id":6059583,"accept_rate":62,"display_name":"Jeeva"},"comment_count":9,"down_vote_count":0,"up_vote_count":4,"is_accepted":false,"score":4,"last_activity_date":1680762481,"creation_date":1680505190,"answer_id":75916764,"question_id":75916545,"body_markdown":"I could not see any  gradle version 7.6 in distribution.&lt;br&gt;\r\n[gradle distribution snapshot][1]&lt;br&gt;\r\nCan you change \r\n\r\n    distributionUrl=https\\://services.gradle.org/distributions/gradle-7.6.1-bin.zip\r\n&lt;br/&gt;\r\n\r\n    dependencies {\r\n            classpath (&#39;com.android.tools.build:gradle:7.4.2&#39;)\r\n        }\r\n\r\nPlease add this in your build.gradle\r\nMake sure distribution gradle url is 7.6.1 and in dependancies its like 7.4.2\r\n&lt;br&gt;\r\n[![Graddlewrapper][2]][2]\r\n&lt;br/&gt;\r\n[![Build.gradle][3]][3]\r\n\r\n\r\n  [1]: https://services.gradle.org/distributions-snapshots/\r\n  [2]: https://i.stack.imgur.com/6e72Z.png\r\n  [3]: https://i.stack.imgur.com/YJzQT.png","title":"Could not find com.android.tools.build:gradle:7.6","body":"<p>I could not see any  gradle version 7.6 in distribution.<br>\n<a href=\"https://services.gradle.org/distributions-snapshots/\" rel=\"nofollow noreferrer\">gradle distribution snapshot</a><br>\nCan you change</p>\n<pre><code>distributionUrl=https\\://services.gradle.org/distributions/gradle-7.6.1-bin.zip\n</code></pre>\n<br/>\n<pre><code>dependencies {\n        classpath ('com.android.tools.build:gradle:7.4.2')\n    }\n</code></pre>\n<p>Please add this in your build.gradle\nMake sure distribution gradle url is 7.6.1 and in dependancies its like 7.4.2\n<br>\n<a href=\"https://i.stack.imgur.com/6e72Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6e72Z.png\" alt=\"Graddlewrapper\" /></a>\n<br/>\n<a href=\"https://i.stack.imgur.com/YJzQT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YJzQT.png\" alt=\"Build.gradle\" /></a></p>\n"}],"owner":{"account_id":13060317,"reputation":580,"user_id":9437740,"display_name":"VanessaF"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":5487,"favorite_count":0,"down_vote_count":0,"up_vote_count":2,"answer_count":1,"score":2,"last_activity_date":1681018345,"creation_date":1680503104,"question_id":75916545,"body_markdown":"I have an error that I don&#39;t understand and I don&#39;t know how to solve it, altough having tried a lot. The error is:\r\n\r\n    Could not find com.android.tools.build:gradle:7.6.\r\n    Searched in the following locations:\r\n      - https://dl.google.com/dl/android/maven2/com/android/tools/build/gradle/7.6/gradle-7.6.pom\r\n      - https://repo.maven.apache.org/maven2/com/android/tools/build/gradle/7.6/gradle-7.6.pom\r\n    Required by:\r\n        project :\r\n    Add google Maven repository and sync project\r\n    Open File\r\n\r\nSo something is wrong with my Java edition or the connection to the build.grandle file. I have Java JDK 19. Here is the code of the build.gradle file\r\n\r\n    // Top-level build file where you can add configuration options common to all sub-projects/modules.\r\n    buildscript {\r\n        repositories {\r\n            google()\r\n            mavenCentral()\r\n        }\r\n        dependencies {\r\n            def nav_version = &quot;2.3.0&quot;\r\n            classpath &#39;com.android.tools.build:gradle:7.6&#39;\r\n            classpath &quot;androidx.navigation:navigation-safe-args-gradle-plugin:$nav_version&quot;\r\n            classpath &#39;com.google.gms:google-services:4.3.10&#39;\r\n    \r\n            // NOTE: Do not place your application dependencies here; they belong\r\n            // in the individual module build.gradle files\r\n        }\r\n    }\r\n    \r\n    allprojects {\r\n        repositories {\r\n            google()\r\n            mavenCentral()\r\n            maven {\r\n                url &#39;https://dl.google.com/android/maven2&#39;\r\n            }\r\n        }\r\n    }\r\n    \r\n    task clean(type: Delete) {\r\n        delete rootProject.buildDir\r\n    }\r\n\r\nAnd here is the gradle.wrapper-properties\r\n\r\n    distributionBase=GRADLE_USER_HOME\r\n    distributionPath=wrapper/dists\r\n    distributionUrl=https\\://services.gradle.org/distributions/gradle-7.6-bin.zip\r\n    zipStoreBase=GRADLE_USER_HOME\r\n    zipStorePath=wrapper/dists\r\n\r\nAccording to this website https://docs.gradle.org/current/userguide/compatibility.html, Java 19 is compatible with gradle-7.6. So I dont understand why I still get the error.\r\n\r\n**Update**: I tried what is suggested but still get an error message. Here are my files\r\n\r\nbuild.gradle (DrinkServer):\r\n\r\n    // Top-level build file where you can add configuration options common to all sub-projects/modules.\r\n    buildscript {\r\n        repositories {\r\n            google()\r\n            mavenCentral()\r\n        }\r\n        dependencies {\r\n            def nav_version = &quot;2.3.0&quot;\r\n            classpath (&quot;com.android.tools.build:gradle:7.4.2&quot;)\r\n            classpath &quot;androidx.navigation:navigation-safe-args-gradle-plugin:$nav_version&quot;\r\n            classpath &#39;com.google.gms:google-services:4.3.10&#39;\r\n    \r\n            // NOTE: Do not place your application dependencies here; they belong\r\n            // in the individual module build.gradle files\r\n        }\r\n    }\r\n    \r\n    allprojects {\r\n        repositories {\r\n            google()\r\n            mavenCentral()\r\n            maven {\r\n                url &#39;https://dl.google.com/android/maven2&#39;\r\n            }\r\n        }\r\n    }\r\n    \r\n    task clean(type: Delete) {\r\n        delete rootProject.buildDir\r\n    }\r\n\r\nbuild.gradle (app):\r\n\r\n    plugins {\r\n        id &#39;com.android.application&#39;\r\n    }\r\n    \r\n    apply plugin: &quot;androidx.navigation.safeargs&quot;\r\n    apply plugin: &#39;com.google.gms.google-services&#39;\r\n    \r\n    \r\n    android {\r\n        compileSdkVersion 31\r\n        buildToolsVersion &quot;30.0.3&quot;\r\n    \r\n    \r\n        defaultConfig {\r\n            applicationId &quot;com.example.drinkserver&quot;\r\n            minSdkVersion 21\r\n            targetSdkVersion 31\r\n            versionCode 1\r\n            versionName &quot;1.1&quot;\r\n            resConfigs &quot;en&quot;, &quot;de&quot;\r\n            viewBinding {\r\n                enabled = true\r\n            }\r\n    \r\n            testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;\r\n        }\r\n    \r\n        buildTypes {\r\n            release {\r\n                minifyEnabled false\r\n                proguardFiles getDefaultProguardFile(&#39;proguard-android-optimize.txt&#39;), &#39;proguard-rules.pro&#39;\r\n    \r\n            }\r\n        }\r\n        compileOptions {\r\n            sourceCompatibility JavaVersion.VERSION_1_8\r\n            targetCompatibility JavaVersion.VERSION_1_8\r\n        }\r\n    }\r\n    \r\n    dependencies {\r\n        implementation &#39;androidx.navigation:navigation-runtime:2.3.5&#39;\r\n        implementation &#39;androidx.lifecycle:lifecycle-extensions:2.2.0&#39;\r\n        def nav_version = &quot;2.3.0&quot;\r\n        implementation &#39;androidx.appcompat:appcompat:1.3.0&#39;\r\n        implementation &#39;com.google.android.material:material:1.3.0&#39;\r\n        implementation &#39;androidx.constraintlayout:constraintlayout:2.0.4&#39;\r\n        testImplementation &#39;junit:junit:4.+&#39;\r\n        androidTestImplementation &#39;androidx.test.ext:junit:1.1.2&#39;\r\n        androidTestImplementation &#39;androidx.test.espresso:espresso-core:3.3.0&#39;\r\n        testImplementation &#39;org.robolectric:robolectric:3.0&#39;\r\n        androidTestImplementation &#39;androidx.test:runner:1.2.0&#39;\r\n        androidTestImplementation &#39;android.arch.core:core-testing:1.2.1&#39;\r\n        implementation &#39;androidx.legacy:legacy-support-v4:1.0.0&#39;\r\n        implementation &quot;androidx.recyclerview:recyclerview:1.1.0&quot;\r\n        implementation &#39;androidx.cardview:cardview:1.0.0&#39;\r\n        implementation &quot;androidx.navigation:navigation-fragment:$nav_version&quot;\r\n        implementation &quot;androidx.navigation:navigation-ui:$nav_version&quot;\r\n        implementation &#39;com.intuit.sdp:sdp-android:1.0.6&#39;\r\n        implementation &#39;com.intuit.ssp:ssp-android:1.0.6&#39;\r\n        implementation &#39;com.github.bumptech.glide:glide:4.12.0&#39;\r\n        annotationProcessor &#39;com.github.bumptech.glide:compiler:4.12.0&#39;\r\n        implementation platform(&#39;com.google.firebase:firebase-bom:29.0.3&#39;)\r\n        implementation &#39;com.google.firebase:firebase-database&#39;\r\n    \r\n    \r\n    }\r\n\r\n    gradle-wrapper. properties:\r\n    distributionBase=GRADLE_USER_HOME\r\n    distributionPath=wrapper/dists\r\n    distributionUrl=https\\://services.gradle.org/distributions/gradle-7.6.1-bin.zip\r\n    zipStoreBase=GRADLE_USER_HOME\r\n    zipStorePath=wrapper/dists\r\n\r\nI get the error message &quot;The Android Gradle plugin supports only Kotlin Gradle plugin version 1.5.20 and higher.\r\nThe following dependencies do not satisfy the required version:\r\nroot project &#39;DrinkServer&#39; -&gt; androidx.navigation:navigation-safe-args-gradle-plugin:2.3.0 -&gt; org.jetbrains.kotlin:kotlin-gradle-plugin:1.3.20\r\n&quot; \r\n\r\nThis is kind of strange as I don&#39;t use Kotlin at all (only Java)\r\n\r\n**Reminder**: As I still have this problem (altough having spent quite some time on it) I would like to remind you on this question. Does anyone have a suggestion as to why this is happening and how to solve this issue? I&#39;ll appreciate every comment.\r\n","title":"Could not find com.android.tools.build:gradle:7.6","body":"<p>I have an error that I don't understand and I don't know how to solve it, altough having tried a lot. The error is:</p>\n<pre><code>Could not find com.android.tools.build:gradle:7.6.\nSearched in the following locations:\n  - https://dl.google.com/dl/android/maven2/com/android/tools/build/gradle/7.6/gradle-7.6.pom\n  - https://repo.maven.apache.org/maven2/com/android/tools/build/gradle/7.6/gradle-7.6.pom\nRequired by:\n    project :\nAdd google Maven repository and sync project\nOpen File\n</code></pre>\n<p>So something is wrong with my Java edition or the connection to the build.grandle file. I have Java JDK 19. Here is the code of the build.gradle file</p>\n<pre><code>// Top-level build file where you can add configuration options common to all sub-projects/modules.\nbuildscript {\n    repositories {\n        google()\n        mavenCentral()\n    }\n    dependencies {\n        def nav_version = &quot;2.3.0&quot;\n        classpath 'com.android.tools.build:gradle:7.6'\n        classpath &quot;androidx.navigation:navigation-safe-args-gradle-plugin:$nav_version&quot;\n        classpath 'com.google.gms:google-services:4.3.10'\n\n        // NOTE: Do not place your application dependencies here; they belong\n        // in the individual module build.gradle files\n    }\n}\n\nallprojects {\n    repositories {\n        google()\n        mavenCentral()\n        maven {\n            url 'https://dl.google.com/android/maven2'\n        }\n    }\n}\n\ntask clean(type: Delete) {\n    delete rootProject.buildDir\n}\n</code></pre>\n<p>And here is the gradle.wrapper-properties</p>\n<pre><code>distributionBase=GRADLE_USER_HOME\ndistributionPath=wrapper/dists\ndistributionUrl=https\\://services.gradle.org/distributions/gradle-7.6-bin.zip\nzipStoreBase=GRADLE_USER_HOME\nzipStorePath=wrapper/dists\n</code></pre>\n<p>According to this website <a href=\"https://docs.gradle.org/current/userguide/compatibility.html\" rel=\"nofollow noreferrer\">https://docs.gradle.org/current/userguide/compatibility.html</a>, Java 19 is compatible with gradle-7.6. So I dont understand why I still get the error.</p>\n<p><strong>Update</strong>: I tried what is suggested but still get an error message. Here are my files</p>\n<p>build.gradle (DrinkServer):</p>\n<pre><code>// Top-level build file where you can add configuration options common to all sub-projects/modules.\nbuildscript {\n    repositories {\n        google()\n        mavenCentral()\n    }\n    dependencies {\n        def nav_version = &quot;2.3.0&quot;\n        classpath (&quot;com.android.tools.build:gradle:7.4.2&quot;)\n        classpath &quot;androidx.navigation:navigation-safe-args-gradle-plugin:$nav_version&quot;\n        classpath 'com.google.gms:google-services:4.3.10'\n\n        // NOTE: Do not place your application dependencies here; they belong\n        // in the individual module build.gradle files\n    }\n}\n\nallprojects {\n    repositories {\n        google()\n        mavenCentral()\n        maven {\n            url 'https://dl.google.com/android/maven2'\n        }\n    }\n}\n\ntask clean(type: Delete) {\n    delete rootProject.buildDir\n}\n</code></pre>\n<p>build.gradle (app):</p>\n<pre><code>plugins {\n    id 'com.android.application'\n}\n\napply plugin: &quot;androidx.navigation.safeargs&quot;\napply plugin: 'com.google.gms.google-services'\n\n\nandroid {\n    compileSdkVersion 31\n    buildToolsVersion &quot;30.0.3&quot;\n\n\n    defaultConfig {\n        applicationId &quot;com.example.drinkserver&quot;\n        minSdkVersion 21\n        targetSdkVersion 31\n        versionCode 1\n        versionName &quot;1.1&quot;\n        resConfigs &quot;en&quot;, &quot;de&quot;\n        viewBinding {\n            enabled = true\n        }\n\n        testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;\n    }\n\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\n\n        }\n    }\n    compileOptions {\n        sourceCompatibility JavaVersion.VERSION_1_8\n        targetCompatibility JavaVersion.VERSION_1_8\n    }\n}\n\ndependencies {\n    implementation 'androidx.navigation:navigation-runtime:2.3.5'\n    implementation 'androidx.lifecycle:lifecycle-extensions:2.2.0'\n    def nav_version = &quot;2.3.0&quot;\n    implementation 'androidx.appcompat:appcompat:1.3.0'\n    implementation 'com.google.android.material:material:1.3.0'\n    implementation 'androidx.constraintlayout:constraintlayout:2.0.4'\n    testImplementation 'junit:junit:4.+'\n    androidTestImplementation 'androidx.test.ext:junit:1.1.2'\n    androidTestImplementation 'androidx.test.espresso:espresso-core:3.3.0'\n    testImplementation 'org.robolectric:robolectric:3.0'\n    androidTestImplementation 'androidx.test:runner:1.2.0'\n    androidTestImplementation 'android.arch.core:core-testing:1.2.1'\n    implementation 'androidx.legacy:legacy-support-v4:1.0.0'\n    implementation &quot;androidx.recyclerview:recyclerview:1.1.0&quot;\n    implementation 'androidx.cardview:cardview:1.0.0'\n    implementation &quot;androidx.navigation:navigation-fragment:$nav_version&quot;\n    implementation &quot;androidx.navigation:navigation-ui:$nav_version&quot;\n    implementation 'com.intuit.sdp:sdp-android:1.0.6'\n    implementation 'com.intuit.ssp:ssp-android:1.0.6'\n    implementation 'com.github.bumptech.glide:glide:4.12.0'\n    annotationProcessor 'com.github.bumptech.glide:compiler:4.12.0'\n    implementation platform('com.google.firebase:firebase-bom:29.0.3')\n    implementation 'com.google.firebase:firebase-database'\n\n\n}\n\ngradle-wrapper. properties:\ndistributionBase=GRADLE_USER_HOME\ndistributionPath=wrapper/dists\ndistributionUrl=https\\://services.gradle.org/distributions/gradle-7.6.1-bin.zip\nzipStoreBase=GRADLE_USER_HOME\nzipStorePath=wrapper/dists\n</code></pre>\n<p>I get the error message &quot;The Android Gradle plugin supports only Kotlin Gradle plugin version 1.5.20 and higher.\nThe following dependencies do not satisfy the required version:\nroot project 'DrinkServer' -&gt; androidx.navigation:navigation-safe-args-gradle-plugin:2.3.0 -&gt; org.jetbrains.kotlin:kotlin-gradle-plugin:1.3.20\n&quot;</p>\n<p>This is kind of strange as I don't use Kotlin at all (only Java)</p>\n<p><strong>Reminder</strong>: As I still have this problem (altough having spent quite some time on it) I would like to remind you on this question. Does anyone have a suggestion as to why this is happening and how to solve this issue? I'll appreciate every comment.</p>\n"},{"tags":["java","exception","try-catch","throwable"],"comments":[{"owner":{"account_id":732315,"reputation":4996,"user_id":681444,"display_name":"racraman"},"score":1,"creation_date":1681018714,"post_id":75968919,"comment_id":133990115,"body_markdown":"I don’t know what you mean by “reduce the severity of throwable”.   When a throwable (typically an Exception) is thrown, execution jumps immediately to the applicable `catch` or `finally`;  there is no changing that to make it “less severe”.","body":"I don’t know what you mean by “reduce the severity of throwable”.   When a throwable (typically an Exception) is thrown, execution jumps immediately to the applicable <code>catch</code> or <code>finally</code>;  there is no changing that to make it “less severe”."},{"owner":{"account_id":25667013,"reputation":48,"user_id":19431798,"display_name":"Trriger"},"score":0,"creation_date":1681018944,"post_id":75968919,"comment_id":133990135,"body_markdown":"but if there were no catch or finally an exception is as severe as an error, does that change if its a throwable instead, and if not how is a throwable different than an exception. thanks for the comment... @racraman","body":"but if there were no catch or finally an exception is as severe as an error, does that change if its a throwable instead, and if not how is a throwable different than an exception. thanks for the comment... @racraman"},{"owner":{"account_id":25667013,"reputation":48,"user_id":19431798,"display_name":"Trriger"},"score":0,"creation_date":1681021571,"post_id":75968919,"comment_id":133990342,"body_markdown":"actually that was a part of what stemmed my doubt. let me rephrase my question in this context, so errors and exceptions are broad classification of throwables. But since i&#39;m not aware of any break commands in java to break a block of code and not a loop i could do that using throwables. but while writing this comment i realized... catching throwables makes us lose errors, so shall i make another question or you help me-\n Can i make a throwable extension with some difference like errors and exception have just in the spirit of knowledge, cuz i have no real use case right now?? thanks a lot","body":"actually that was a part of what stemmed my doubt. let me rephrase my question in this context, so errors and exceptions are broad classification of throwables. But since i&#39;m not aware of any break commands in java to break a block of code and not a loop i could do that using throwables. but while writing this comment i realized... catching throwables makes us lose errors, so shall i make another question or you help me-  Can i make a throwable extension with some difference like errors and exception have just in the spirit of knowledge, cuz i have no real use case right now?? thanks a lot"},{"owner":{"account_id":732315,"reputation":4996,"user_id":681444,"display_name":"racraman"},"score":0,"creation_date":1681021586,"post_id":75968919,"comment_id":133990344,"body_markdown":"`Error` and `Exception` both extend from ` Throwable `.  The difference is basically intent - `Error` is typically thrown by the system, and should be taken as always being fatal - don’t try to catch it or carry on afterwards.  At most, all you would do is log it (in some top-level catch) before allowing the application to die.  `Exception ` denotes an error in the application - typically recoverable after a `catch`.  In short, as a programmer (and especially a beginner) don’t worry about `Error`, you will overwhelmingly be using `Exception`.","body":"<code>Error</code> and <code>Exception</code> both extend from ` Throwable <code>.  The difference is basically intent - </code>Error` is typically thrown by the system, and should be taken as always being fatal - don’t try to catch it or carry on afterwards.  At most, all you would do is log it (in some top-level catch) before allowing the application to die.  <code>Exception </code> denotes an error in the application - typically recoverable after a <code>catch</code>.  In short, as a programmer (and especially a beginner) don’t worry about <code>Error</code>, you will overwhelmingly be using <code>Exception</code>."}],"owner":{"account_id":25667013,"reputation":48,"user_id":19431798,"display_name":"Trriger"},"comment_count":4,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":25,"favorite_count":0,"down_vote_count":0,"up_vote_count":1,"closed_date":1681021618,"answer_count":0,"score":1,"last_activity_date":1681017897,"creation_date":1681017897,"question_id":75968919,"body_markdown":"Exceptions are extensions of throwables and throwables are defined as implementing serializers in the java packages so can we create throwables in and use try catch and reduce the severity of throwable as exceptions are more threatening. will this allow my code to run smoothly when the throwable is not handled but some communication shall be created between try block code and catch or finally block code.\r\n\r\nsorry i do not have any code to share! it&#39;s a theoritical doubt as i&#39;m still a beginner learning java.","title":"In java we use try catch with exceptions in the try block. can we use this for throwables or can we create even throwables as implements serializers?","body":"<p>Exceptions are extensions of throwables and throwables are defined as implementing serializers in the java packages so can we create throwables in and use try catch and reduce the severity of throwable as exceptions are more threatening. will this allow my code to run smoothly when the throwable is not handled but some communication shall be created between try block code and catch or finally block code.</p>\n<p>sorry i do not have any code to share! it's a theoritical doubt as i'm still a beginner learning java.</p>\n"},{"tags":["java","android","kotlin"],"answers":[{"tags":[],"owner":{"account_id":9906633,"reputation":1075,"user_id":7334951,"display_name":"Younes Charfaoui"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681017855,"creation_date":1681017855,"answer_id":75968915,"question_id":75967598,"body_markdown":"I think the idea is not to provide a drawable! But something that acts as a drawable and also knows about the checked and unchecked versions. For that you can use the `StateListDrawable`.\r\n\r\nBasically, you define the different states for your drawable; you can give it the different drawable with the corresponding states, like the following:\r\n\r\n```kotlin\r\n\r\nval uncheckedDrawable = // create your drawable for the unchecked version\r\nval checkedDrawable = // create your drawable for the checked\r\n\r\nval stateListDrawable = StateListDrawable()\r\nstateListDrawable.addState(intArrayOf(android.R.attr.state_checked), checkedDrawable)\r\nstateListDrawable.addState(intArrayOf(-android.R.attr.state_checked), uncheckedDrawable)\r\n```\r\n\r\nAnd you can use the new `stateListDrawable` with the code you shared like the following:\r\n\r\n```kotlin\r\nbottomNavigationView.menu.findItem(R.id.tab1).setIcon(stateListDrawable);\r\n```\r\n\r\nI hope this helps &#128161;!","title":"Programmatically set the un-checked drawable in BottomNavigationView","body":"<p>I think the idea is not to provide a drawable! But something that acts as a drawable and also knows about the checked and unchecked versions. For that you can use the <code>StateListDrawable</code>.</p>\n<p>Basically, you define the different states for your drawable; you can give it the different drawable with the corresponding states, like the following:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>\nval uncheckedDrawable = // create your drawable for the unchecked version\nval checkedDrawable = // create your drawable for the checked\n\nval stateListDrawable = StateListDrawable()\nstateListDrawable.addState(intArrayOf(android.R.attr.state_checked), checkedDrawable)\nstateListDrawable.addState(intArrayOf(-android.R.attr.state_checked), uncheckedDrawable)\n</code></pre>\n<p>And you can use the new <code>stateListDrawable</code> with the code you shared like the following:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>bottomNavigationView.menu.findItem(R.id.tab1).setIcon(stateListDrawable);\n</code></pre>\n<p>I hope this helps 💡!</p>\n"}],"owner":{"account_id":3147269,"reputation":10469,"user_id":3075340,"accept_rate":70,"display_name":"Micro"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":26,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":1,"score":0,"last_activity_date":1681017855,"creation_date":1680986734,"question_id":75967598,"body_markdown":"Is there a way to programmatically set an un-checked drawable in a BottomNavigationView?\r\n\r\nIt is possible to set the checked drawable of a tab like this:\r\n\r\n`BottomNavigationView.getMenu().findItem(R.id.tab1).setIcon(drawable);`\r\n\r\nbut I can&#39;t find how to set the un-checked version of this tab.","title":"Programmatically set the un-checked drawable in BottomNavigationView","body":"<p>Is there a way to programmatically set an un-checked drawable in a BottomNavigationView?</p>\n<p>It is possible to set the checked drawable of a tab like this:</p>\n<p><code>BottomNavigationView.getMenu().findItem(R.id.tab1).setIcon(drawable);</code></p>\n<p>but I can't find how to set the un-checked version of this tab.</p>\n"},{"tags":["java","recursion","multidimensional-array","quadtree"],"owner":{"account_id":22663357,"reputation":1,"user_id":16836113,"display_name":"Mauthoor Motasim"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":false,"view_count":96,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"answer_count":0,"score":0,"last_activity_date":1681017739,"creation_date":1681017739,"question_id":75968908,"body_markdown":"I&#39;m trying to create a game that uses a quad tree.[Block game](https://i.stack.imgur.com/ItE0X.jpg). As shown in the picture, the blocks are elements of the tree and they can have either 0 or 4 children. The biggest block is at level 0 and its children is at level 1 and so on. For every game, there is a maxLevel at which you cannot subdivide the block any further. Let&#39;s call the blocks that cannot be divided *unit cells*. Only the leaves have colors while non-leaf elements have color equal to *null*.\r\n\r\nFurthermore, the children of a block is stored in an array in this order [upperRight,upperLeft,lowerLeft,lowerRight]. My goal is to flatten the tree to a 2D array of colors (arr[i] represents the row and arr[i][j] represents the color of that *unit cell* at the corresponding position on the board). For example, the element at arr[0][0] should have the color of the *unit cell* at the upper left corner of the biggest block. \r\n\r\n\r\n\r\n\r\nHere&#39;s what I got so far:\r\n\r\n```\r\n    private Color[][] flatten(Color[][] arr) {\r\n  //base case\r\n   if(this.children.length != 0 &amp;&amp; this.level == maxDepth - 1) {\r\n    for (int i = 0; i &lt; arr.length; i++) {\r\n     for (int j = 0; j &lt; arr.length; j++) {\r\n\r\n      //I don&#39;t know which indices to use. I tried doing some calculations to convert the           coordinates into indices but I coudn&#39;t do it.\r\n      arr[?][?] = this.children[j].color;\r\n\r\n     }\r\n    }\r\n   }\r\n\r\n  //if the current block doesn&#39;t have children and it is at maxLevel-1\r\n\r\n   else if(this.children.length==0 &amp;&amp; this.level == maxDepth - 1){\r\n    for(int i = 0; i &lt; arr.length ; i++){\r\n     for(int j = 0; j &lt; arr.length; j++){\r\n\r\n    //same indices problem here\r\n      arr[?][?] = this.color;\r\n\r\n     }\r\n    }\r\n   }\r\n  //recursive step\r\n  //I&#39;m doing the recursive call in the order 1,0,2,3 because of the way the children are ordered\r\n   else if(this.children.length != 0 &amp;&amp; this.level != maxDepth - 1){\r\n    this.children[1].flatten(arr);\r\n    this.children[0].flatten(arr);\r\n    this.children[2].flatten(arr);\r\n    this.children[3].flatten(arr);\r\n   }\r\n\r\n  return arr;\r\n}\r\n```","title":"Flattening a quad tree to a 2D array","body":"<p>I'm trying to create a game that uses a quad tree.<a href=\"https://i.stack.imgur.com/ItE0X.jpg\" rel=\"nofollow noreferrer\">Block game</a>. As shown in the picture, the blocks are elements of the tree and they can have either 0 or 4 children. The biggest block is at level 0 and its children is at level 1 and so on. For every game, there is a maxLevel at which you cannot subdivide the block any further. Let's call the blocks that cannot be divided <em>unit cells</em>. Only the leaves have colors while non-leaf elements have color equal to <em>null</em>.</p>\n<p>Furthermore, the children of a block is stored in an array in this order [upperRight,upperLeft,lowerLeft,lowerRight]. My goal is to flatten the tree to a 2D array of colors (arr[i] represents the row and arr[i][j] represents the color of that <em>unit cell</em> at the corresponding position on the board). For example, the element at arr[0][0] should have the color of the <em>unit cell</em> at the upper left corner of the biggest block.</p>\n<p>Here's what I got so far:</p>\n<pre><code>    private Color[][] flatten(Color[][] arr) {\n  //base case\n   if(this.children.length != 0 &amp;&amp; this.level == maxDepth - 1) {\n    for (int i = 0; i &lt; arr.length; i++) {\n     for (int j = 0; j &lt; arr.length; j++) {\n\n      //I don't know which indices to use. I tried doing some calculations to convert the           coordinates into indices but I coudn't do it.\n      arr[?][?] = this.children[j].color;\n\n     }\n    }\n   }\n\n  //if the current block doesn't have children and it is at maxLevel-1\n\n   else if(this.children.length==0 &amp;&amp; this.level == maxDepth - 1){\n    for(int i = 0; i &lt; arr.length ; i++){\n     for(int j = 0; j &lt; arr.length; j++){\n\n    //same indices problem here\n      arr[?][?] = this.color;\n\n     }\n    }\n   }\n  //recursive step\n  //I'm doing the recursive call in the order 1,0,2,3 because of the way the children are ordered\n   else if(this.children.length != 0 &amp;&amp; this.level != maxDepth - 1){\n    this.children[1].flatten(arr);\n    this.children[0].flatten(arr);\n    this.children[2].flatten(arr);\n    this.children[3].flatten(arr);\n   }\n\n  return arr;\n}\n</code></pre>\n"},{"tags":["java","kotlin","class","methods","interface"],"answers":[{"comments":[{"owner":{"account_id":23857726,"reputation":25,"user_id":17861057,"display_name":"HariKrishnan V K"},"score":0,"creation_date":1681360416,"post_id":75968831,"comment_id":134044556,"body_markdown":"Thanks for the answer Tenfour04 one follow up question. You said &quot;It is typically used for reflection&quot;. What does reflection mean here and what is its use? :)","body":"Thanks for the answer Tenfour04 one follow up question. You said &quot;It is typically used for reflection&quot;. What does reflection mean here and what is its use? :)"},{"owner":{"account_id":238127,"reputation":86162,"user_id":506796,"accept_rate":83,"display_name":"Tenfour04"},"score":1,"creation_date":1681387011,"post_id":75968831,"comment_id":134049895,"body_markdown":"I linked to a description of what reflection is in my answer. It lets you inspect code at runtime. For example, get a list of methods in a class by their names as Strings. It’s commonly used in serialization libraries that convert between classes and Strings so you can save data easily or work with data from the Web easily.","body":"I linked to a description of what reflection is in my answer. It lets you inspect code at runtime. For example, get a list of methods in a class by their names as Strings. It’s commonly used in serialization libraries that convert between classes and Strings so you can save data easily or work with data from the Web easily."}],"tags":[],"owner":{"account_id":238127,"reputation":86162,"user_id":506796,"accept_rate":83,"display_name":"Tenfour04"},"comment_count":2,"down_vote_count":0,"up_vote_count":2,"is_accepted":true,"score":2,"last_activity_date":1681016368,"creation_date":1681016043,"answer_id":75968831,"question_id":75968665,"body_markdown":"`bal` is an instance of [`Class&lt;Host&gt;`](https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html), not an instance of `Host`. `Class` is a class that contains information about the definition of a class or interface, and does not represent an instance of that class or interface. It is typically used for [reflection](https://www.oracle.com/technical-resources/articles/java/javareflection.html). No class implementation of your interface has been created in your code. ","title":"How interface::class.java works for umimplemented methods in that interface","body":"<p><code>bal</code> is an instance of <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html\" rel=\"nofollow noreferrer\"><code>Class&lt;Host&gt;</code></a>, not an instance of <code>Host</code>. <code>Class</code> is a class that contains information about the definition of a class or interface, and does not represent an instance of that class or interface. It is typically used for <a href=\"https://www.oracle.com/technical-resources/articles/java/javareflection.html\" rel=\"nofollow noreferrer\">reflection</a>. No class implementation of your interface has been created in your code.</p>\n"}],"owner":{"account_id":23857726,"reputation":25,"user_id":17861057,"display_name":"HariKrishnan V K"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":54,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75968831,"answer_count":1,"score":0,"last_activity_date":1681016368,"creation_date":1681011532,"question_id":75968665,"body_markdown":"```\r\nfun main(){\r\n    val bal = Host::class.java\r\n}\r\n\r\ninterface Host{\r\n    fun void()\r\n}\r\n```\r\nI have created simple code here,\r\nOne Interface that was instantiated here with a class like Host::class.java. I see bal take the type as Class&lt;Host&gt;. Its creating a class from interface thats ok but how it can create class from interface without the methods that need to be implemented as a contract between interface.\r\nAlso when i call bal. i couldn&#39;t find void() method from bal instance.\r\n\r\n\r\nWhat is the reason it differs from normal implementation of interface in a class? I&#39;m really for any kind of answers :)","title":"How interface::class.java works for umimplemented methods in that interface","body":"<pre><code>fun main(){\n    val bal = Host::class.java\n}\n\ninterface Host{\n    fun void()\n}\n</code></pre>\n<p>I have created simple code here,\nOne Interface that was instantiated here with a class like Host::class.java. I see bal take the type as Class. Its creating a class from interface thats ok but how it can create class from interface without the methods that need to be implemented as a contract between interface.\nAlso when i call bal. i couldn't find void() method from bal instance.</p>\n<p>What is the reason it differs from normal implementation of interface in a class? I'm really for any kind of answers :)</p>\n"},{"tags":["java","serialization","reflection","type-conversion","deserialization"],"answers":[{"tags":[],"owner":{"account_id":24733817,"reputation":56,"user_id":18621464,"display_name":"Kamii0909"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1680923535,"creation_date":1680923146,"answer_id":75963118,"question_id":75963002,"body_markdown":"You are kinda reinventing the wheel. \r\n\r\nFor your question first, you need to know which `User` class you want to deserialize. Your stringified form should look somewhat like this: \r\n```\r\nmy.package.name.User(java.lang.String, int)\r\nmy.package.name.User: variables...\r\n```\r\n\r\nOtherwise, how would you know is it `my.package.User` or `my.package.name.User`? Of course, you could write a custom adapter for this &quot;figuring out&quot; phase to get the full class name but I guess you shouldn&#39;t.\r\n\r\n```java\r\n// You can directly parse the parameter classes, technically you don&#39;t need it\r\n// at method parameter. You can include it if you feel like it&#39;s easier to work\r\n// with predefined values.\r\npublic Object toObject(String string) throws Exception {\r\n  // get your full class name here first\r\n  // parse it first or whatever \r\n  String className = getConstructorClass(params1);\r\n  String[] parameterClassName = getConstructorParameterClassNames(params2);\r\n  String[] parameterStringifiedValue = getParameterValues(params3);\r\n  \r\n  Class&lt;?&gt; clz = Class.forName(className);\r\n  @SurpressWarning(&quot;unchecked&quot;) // List&lt;Class&lt;?&gt;&gt; is the same anyway\r\n  Class[] parameterClasses = // repeat Class.forName()...\r\n  Object[] parameters = // An example, for(int i=...\r\n  // parameterClasses[i]\r\n  //  .getDeclaredConstructor(String.class)\r\n  //  .newInstance(parameterStringifiedValue[i]);\r\n  return clz\r\n    .getDeclaredConstructor(constructorParamClasses)\r\n    .newInstance(parameters);\r\n\r\n}\r\n```\r\n\r\nThis whole parsing is so painful ngl. You probably want to use Java built-in serialization support or parse from a well-supported format (xml, json...) and let libraries do all the intricacies.\r\n\r\nYou can use generic for as a more type-safe approach, but requires more knowledge from calling context.\r\n```java\r\npublic &lt;T&gt; T toObject(Class&lt;T&gt; objectType, String string) {\r\n  return objectType.getDeclaredConstructor(...).newInstance(...);\r\n}\r\n```","title":"Converting a String into a Constructor to make a new Object","body":"<p>You are kinda reinventing the wheel.</p>\n<p>For your question first, you need to know which <code>User</code> class you want to deserialize. Your stringified form should look somewhat like this:</p>\n<pre><code>my.package.name.User(java.lang.String, int)\nmy.package.name.User: variables...\n</code></pre>\n<p>Otherwise, how would you know is it <code>my.package.User</code> or <code>my.package.name.User</code>? Of course, you could write a custom adapter for this &quot;figuring out&quot; phase to get the full class name but I guess you shouldn't.</p>\n<pre class=\"lang-java prettyprint-override\"><code>// You can directly parse the parameter classes, technically you don't need it\n// at method parameter. You can include it if you feel like it's easier to work\n// with predefined values.\npublic Object toObject(String string) throws Exception {\n  // get your full class name here first\n  // parse it first or whatever \n  String className = getConstructorClass(params1);\n  String[] parameterClassName = getConstructorParameterClassNames(params2);\n  String[] parameterStringifiedValue = getParameterValues(params3);\n  \n  Class&lt;?&gt; clz = Class.forName(className);\n  @SurpressWarning(&quot;unchecked&quot;) // List&lt;Class&lt;?&gt;&gt; is the same anyway\n  Class[] parameterClasses = // repeat Class.forName()...\n  Object[] parameters = // An example, for(int i=...\n  // parameterClasses[i]\n  //  .getDeclaredConstructor(String.class)\n  //  .newInstance(parameterStringifiedValue[i]);\n  return clz\n    .getDeclaredConstructor(constructorParamClasses)\n    .newInstance(parameters);\n\n}\n</code></pre>\n<p>This whole parsing is so painful ngl. You probably want to use Java built-in serialization support or parse from a well-supported format (xml, json...) and let libraries do all the intricacies.</p>\n<p>You can use generic for as a more type-safe approach, but requires more knowledge from calling context.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public &lt;T&gt; T toObject(Class&lt;T&gt; objectType, String string) {\n  return objectType.getDeclaredConstructor(...).newInstance(...);\n}\n</code></pre>\n"},{"tags":[],"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"comment_count":0,"down_vote_count":0,"up_vote_count":3,"is_accepted":true,"score":3,"last_activity_date":1680962978,"creation_date":1680925306,"answer_id":75963192,"question_id":75963002,"body_markdown":"You are *definitely* reinventing the wheel\r\n\r\n  - Java Object Serialization already does this, albeit that the serialization format is binary (and opaque).\r\n\r\n  - Various JSON (or XML) &lt;-&gt; POJO binding mechanisms already do this, albeit that the serialization format can be verbose.\r\n\r\n(Now there are limits to what these schemes can do.  For example, they cannot serialize a `Thread` or a `Socket`.  But neither can your proposal ... for the same reasons.   These classes have state that simply cannot be captured in a serialization.)\r\n\r\nBut if you really want to invent the wheel, you can do it. \r\n\r\n  - As noted, you can use reflection to access and call a public or private constructor on a non-abstract type.   \r\n\r\n  - There is also an &quot;under the hood&quot; `Unsafe` mechanism that JOS uses to create objects without invoking any constructor.  Combine this with `Unsafe` methods for assigning values to fields.\r\n\r\nHowever, your approach implicitly assumes that the `toString` method returns a string that can be used later to reconstruct the object.  This is not true, in general.  \r\n\r\n  - The default implementation returns a string consisting of the object&#39;s class name and its identity hashcode.  (An example of the types affected by this is any array type.)  You can&#39;t reconstruct an object from that.\r\n  - And even for cases where the `toString` result *does* include the information needed for deserialization, the string format is rarely standardized.  (The `Collection` APIs are the exception ...)\r\n\r\nIn short, `toString` is not the answer.","title":"Converting a String into a Constructor to make a new Object","body":"<p>You are <em>definitely</em> reinventing the wheel</p>\n<ul>\n<li><p>Java Object Serialization already does this, albeit that the serialization format is binary (and opaque).</p>\n</li>\n<li><p>Various JSON (or XML) &lt;-&gt; POJO binding mechanisms already do this, albeit that the serialization format can be verbose.</p>\n</li>\n</ul>\n<p>(Now there are limits to what these schemes can do.  For example, they cannot serialize a <code>Thread</code> or a <code>Socket</code>.  But neither can your proposal ... for the same reasons.   These classes have state that simply cannot be captured in a serialization.)</p>\n<p>But if you really want to invent the wheel, you can do it.</p>\n<ul>\n<li><p>As noted, you can use reflection to access and call a public or private constructor on a non-abstract type.</p>\n</li>\n<li><p>There is also an &quot;under the hood&quot; <code>Unsafe</code> mechanism that JOS uses to create objects without invoking any constructor.  Combine this with <code>Unsafe</code> methods for assigning values to fields.</p>\n</li>\n</ul>\n<p>However, your approach implicitly assumes that the <code>toString</code> method returns a string that can be used later to reconstruct the object.  This is not true, in general.</p>\n<ul>\n<li>The default implementation returns a string consisting of the object's class name and its identity hashcode.  (An example of the types affected by this is any array type.)  You can't reconstruct an object from that.</li>\n<li>And even for cases where the <code>toString</code> result <em>does</em> include the information needed for deserialization, the string format is rarely standardized.  (The <code>Collection</code> APIs are the exception ...)</li>\n</ul>\n<p>In short, <code>toString</code> is not the answer.</p>\n"}],"owner":{"account_id":28170386,"reputation":3,"user_id":21529049,"display_name":"Alexandrite2000"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":262,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":75963192,"answer_count":2,"score":0,"last_activity_date":1681014342,"creation_date":1680920050,"question_id":75963002,"body_markdown":"```\r\n@NotNull\r\npublic static String toString(@NotNull Object object, @NotNull Object[] variables, Class&lt;?&gt;... parameters) throws NoSuchMethodException {\r\n    StringBuilder sb = new StringBuilder();\r\n    sb.append(object.getClass().getConstructor(parameters)).append(&#39;\\n&#39;);\r\n    sb.append(object.getClass()).append(&quot;:&quot;);\r\n    for (Object variable : variables){\r\n        sb.append(&quot; | &quot;).append(variable.toString());\r\n    }\r\n    return sb.toString();\r\n}\r\n```\r\n\r\nA brief explanation of the code, the toString() method uses an object, the variables of the constructor that the user wants to save, and the parameters of a constructor. This method would form the parameters in a way like this:\r\n\r\n```\r\npublic User(java.lang.String,int)\r\nclass User: | username | 369172\r\n```\r\n\r\nI want to use this String format to convert the above into a new instance of the Object that was taken in using the method below:\r\n\r\n```\r\npublic static Object toObject(@NotNull String formattedObject, @NotNull Object object, Class&lt;?&gt;... parameters){\r\n    // The code I need to figure out.\r\n}\r\n```\r\n\r\nI want to figure out: how to get all the variables cast into a form where I could use them to make a new instance of the object if I didn&#39;t know how many variables/parameters there are, how to use the method in the event the constructor of the Object is private, and if one of the parameters is an Object that prints out the default Object toString() method. How could I do this?\r\n\r\nEDIT: I want to avoid using the Serialization interface","title":"Converting a String into a Constructor to make a new Object","body":"<pre><code>@NotNull\npublic static String toString(@NotNull Object object, @NotNull Object[] variables, Class&lt;?&gt;... parameters) throws NoSuchMethodException {\n    StringBuilder sb = new StringBuilder();\n    sb.append(object.getClass().getConstructor(parameters)).append('\\n');\n    sb.append(object.getClass()).append(&quot;:&quot;);\n    for (Object variable : variables){\n        sb.append(&quot; | &quot;).append(variable.toString());\n    }\n    return sb.toString();\n}\n</code></pre>\n<p>A brief explanation of the code, the toString() method uses an object, the variables of the constructor that the user wants to save, and the parameters of a constructor. This method would form the parameters in a way like this:</p>\n<pre><code>public User(java.lang.String,int)\nclass User: | username | 369172\n</code></pre>\n<p>I want to use this String format to convert the above into a new instance of the Object that was taken in using the method below:</p>\n<pre><code>public static Object toObject(@NotNull String formattedObject, @NotNull Object object, Class&lt;?&gt;... parameters){\n    // The code I need to figure out.\n}\n</code></pre>\n<p>I want to figure out: how to get all the variables cast into a form where I could use them to make a new instance of the object if I didn't know how many variables/parameters there are, how to use the method in the event the constructor of the Object is private, and if one of the parameters is an Object that prints out the default Object toString() method. How could I do this?</p>\n<p>EDIT: I want to avoid using the Serialization interface</p>\n"},{"tags":["java","spring","spring-mvc","parameters","bean-validation"],"answers":[{"comments":[{"owner":{"account_id":2509521,"reputation":3294,"user_id":2182351,"accept_rate":25,"display_name":"Mani"},"score":0,"creation_date":1389388230,"post_id":21040382,"comment_id":31657554,"body_markdown":"Just suggestion, it would be great if you add information along with your solution as &quot; why he is not getting any error while omitting @RequestParam and getting error while adding back.&quot; - that might help him to understand the basis behind how spring handling model Object as Request like http://stackoverflow.com/questions/8372957/how-does-spring-mvc-controller-method-parameter-work","body":"Just suggestion, it would be great if you add information along with your solution as &quot; why he is not getting any error while omitting @RequestParam and getting error while adding back.&quot; - that might help him to understand the basis behind how spring handling model Object as Request like <a href=\"http://stackoverflow.com/questions/8372957/how-does-spring-mvc-controller-method-parameter-work\" title=\"how does spring mvc controller method parameter work\">stackoverflow.com/questions/8372957/&hellip;</a>"},{"owner":{"account_id":1062360,"reputation":37721,"user_id":1063716,"accept_rate":94,"display_name":"Steve Chambers"},"score":0,"creation_date":1389709684,"post_id":21040382,"comment_id":31770701,"body_markdown":"@MDeinum Many thanks for the solution - am quite new to this type of thing and hadn&#39;t come across JSR-303 before. Nice compact syntax and works a treat!","body":"@MDeinum Many thanks for the solution - am quite new to this type of thing and hadn&#39;t come across JSR-303 before. Nice compact syntax and works a treat!"}],"tags":[],"owner":{"account_id":3192259,"reputation":117619,"user_id":2696260,"display_name":"M. Deinum"},"comment_count":2,"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1389346193,"creation_date":1389345858,"answer_id":21040382,"question_id":21040198,"body_markdown":"Use JSR-303 annotations to validate the object (and don&#39;t use primitives but the Object representations in that case).\r\n\r\n    public class MyObject {\r\n        @NotNull\r\n        private Integer param1;\r\n\r\n        @NotNull\r\n        private Integer param2;\r\n\r\n        // Getters / Setters\r\n\r\n    }\r\n\r\nController method.\r\n\r\n    @RequestMapping(value = &quot;/method&quot;)\r\n    public void method(@Valid MyObject obj) { /*...*/ }\r\n\r\nIf you don&#39;t have a JSR-303 provider (hibernate-validator for instance) on your classpath create a `Validator` and use this to validate your object.\r\n\r\nLinks.\r\n\r\n1. Spring MVC [reference guide][1]\r\n2. Spring Validation [reference guide][2]\r\n\r\n[1]: http://docs.spring.io/spring/docs/current/spring-framework-reference/html/mvc.html\r\n[2]: http://docs.spring.io/spring/docs/current/spring-framework-reference/html/validation.html","title":"How to ensure mandatory parameters are passed into a Spring MVC controller method?","body":"<p>Use JSR-303 annotations to validate the object (and don't use primitives but the Object representations in that case).</p>\n\n<pre><code>public class MyObject {\n    @NotNull\n    private Integer param1;\n\n    @NotNull\n    private Integer param2;\n\n    // Getters / Setters\n\n}\n</code></pre>\n\n<p>Controller method.</p>\n\n<pre><code>@RequestMapping(value = \"/method\")\npublic void method(@Valid MyObject obj) { /*...*/ }\n</code></pre>\n\n<p>If you don't have a JSR-303 provider (hibernate-validator for instance) on your classpath create a <code>Validator</code> and use this to validate your object.</p>\n\n<p>Links.</p>\n\n<ol>\n<li>Spring MVC <a href=\"http://docs.spring.io/spring/docs/current/spring-framework-reference/html/mvc.html\" rel=\"nofollow\">reference guide</a></li>\n<li>Spring Validation <a href=\"http://docs.spring.io/spring/docs/current/spring-framework-reference/html/validation.html\" rel=\"nofollow\">reference guide</a></li>\n</ol>\n"},{"comments":[{"owner":{"account_id":1062360,"reputation":37721,"user_id":1063716,"accept_rate":94,"display_name":"Steve Chambers"},"score":0,"creation_date":1389347553,"post_id":21040631,"comment_id":31632728,"body_markdown":"Hi, thanks for the answer. The actual method has to be a GET request and is returning JSON data (so the JSP bit isn&#39;t relevant). Have tried using `@ModelAttribute` but it doesn&#39;t seem to make any difference - the missing parameter error doesn&#39;t get reported.","body":"Hi, thanks for the answer. The actual method has to be a GET request and is returning JSON data (so the JSP bit isn&#39;t relevant). Have tried using <code>@ModelAttribute</code> but it doesn&#39;t seem to make any difference - the missing parameter error doesn&#39;t get reported."}],"tags":[],"owner":{"account_id":3623564,"reputation":272,"user_id":3021768,"display_name":"Afshar"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1389346957,"creation_date":1389346530,"answer_id":21040631,"question_id":21040198,"body_markdown":"You can try @ModelAttribute and method=RequestMethod.POST:\r\nIn your controller:\r\n\r\n    //...\r\n    @RequestMapping(value=&quot;/method&quot;, method=RequestMethod.POST)\r\n    public String add(@ModelAttribute(&quot;modelName&quot;) ModelClass form)\r\n    {\r\n       //.. your code\r\n    }\r\n    \r\n    //..\r\n\r\nIn your JSP:\r\n\r\n    &lt;%@ taglib uri=&quot;http://www.springframework.org/tags/form&quot; prefix=&quot;f&quot; %&gt;\r\n    \r\n    //.. some code \r\n    \r\n    &lt;f:form action=&quot;method&quot; method=&quot;post&quot; modelAttribute=&quot;modelName&quot;&gt;\r\n    \r\n    &lt;/f:form&gt;\r\n\r\n If you are restricted to GET requests only, you might not be able to use a separate ModelClass. You need to resort to request parameters in that case. ","title":"How to ensure mandatory parameters are passed into a Spring MVC controller method?","body":"<p>You can try @ModelAttribute and method=RequestMethod.POST:\nIn your controller:</p>\n\n<pre><code>//...\n@RequestMapping(value=\"/method\", method=RequestMethod.POST)\npublic String add(@ModelAttribute(\"modelName\") ModelClass form)\n{\n   //.. your code\n}\n\n//..\n</code></pre>\n\n<p>In your JSP:</p>\n\n<pre><code>&lt;%@ taglib uri=\"http://www.springframework.org/tags/form\" prefix=\"f\" %&gt;\n\n//.. some code \n\n&lt;f:form action=\"method\" method=\"post\" modelAttribute=\"modelName\"&gt;\n\n&lt;/f:form&gt;\n</code></pre>\n\n<p>If you are restricted to GET requests only, you might not be able to use a separate ModelClass. You need to resort to request parameters in that case. </p>\n"},{"comments":[{"owner":{"account_id":-1,"reputation":1,"user_id":-1,"display_name":"Community"},"score":0,"creation_date":1681378909,"post_id":75968674,"comment_id":134047934,"body_markdown":"As it’s currently written, your answer is unclear. Please [edit] to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","body":"As it’s currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/75968674/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"tags":[],"owner":{"account_id":7693294,"reputation":1,"user_id":5828784,"display_name":"Nano Yulian"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681011891,"creation_date":1681011891,"answer_id":75968674,"question_id":21040198,"body_markdown":"add ( ,@BindingResult result) in your parameter to bind the errors to all parameter. And you can check if the error exist using result.hasErrors()","title":"How to ensure mandatory parameters are passed into a Spring MVC controller method?","body":"<p>add ( ,@BindingResult result) in your parameter to bind the errors to all parameter. And you can check if the error exist using result.hasErrors()</p>\n"}],"owner":{"account_id":1062360,"reputation":37721,"user_id":1063716,"accept_rate":94,"display_name":"Steve Chambers"},"comment_count":0,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":2653,"favorite_count":0,"down_vote_count":0,"up_vote_count":0,"accepted_answer_id":21040382,"answer_count":3,"score":0,"last_activity_date":1681011891,"creation_date":1389345257,"question_id":21040198,"body_markdown":"Given a Spring-MVC controller method:\r\n\r\n    @RequestMapping(value = &quot;/method&quot;)\r\n    public void method(@RequestParam int param1,\r\n                       @RequestParam int param2) { /*...*/ }\r\n\r\nIf parameters are missing in the request URL, an error is reported, e.g:\r\n\r\n&gt; JBWEB000068: message Required int parameter &#39;param1&#39; is not present\r\n\r\nI need to move the parameters into a single model class yet keep exactly the same GET request URL. So have modified `method`&#39;s parameter to `MyModel model`, which contains `param1` and `param2`.\r\n\r\nThis works if `@RequestParam` is omitted but the snag is **no error is reported if parameters are missing**. If, on the other hand `@RequestParam` is included, a parameter named &quot;model&quot; is expected in the GET request. Is there a way to make model parameters mandatory yet keep the same request URL?","title":"How to ensure mandatory parameters are passed into a Spring MVC controller method?","body":"<p>Given a Spring-MVC controller method:</p>\n\n<pre><code>@RequestMapping(value = \"/method\")\npublic void method(@RequestParam int param1,\n                   @RequestParam int param2) { /*...*/ }\n</code></pre>\n\n<p>If parameters are missing in the request URL, an error is reported, e.g:</p>\n\n<blockquote>\n  <p>JBWEB000068: message Required int parameter 'param1' is not present</p>\n</blockquote>\n\n<p>I need to move the parameters into a single model class yet keep exactly the same GET request URL. So have modified <code>method</code>'s parameter to <code>MyModel model</code>, which contains <code>param1</code> and <code>param2</code>.</p>\n\n<p>This works if <code>@RequestParam</code> is omitted but the snag is <strong>no error is reported if parameters are missing</strong>. If, on the other hand <code>@RequestParam</code> is included, a parameter named \"model\" is expected in the GET request. Is there a way to make model parameters mandatory yet keep the same request URL?</p>\n"},{"tags":["java","generics","list"],"comments":[{"owner":{"account_id":99169,"reputation":2517,"user_id":268016,"accept_rate":100,"display_name":"Yuri Ghensev"},"score":7,"creation_date":1338842486,"post_id":1351299,"comment_id":14191715,"body_markdown":"Reading `Effective Java` chapter 5 helps a lot understanding everything about generics.","body":"Reading <code>Effective Java</code> chapter 5 helps a lot understanding everything about generics."},{"owner":{"account_id":1289950,"reputation":2671,"user_id":1242236,"display_name":"Rugal"},"score":1,"creation_date":1499279273,"post_id":1351299,"comment_id":76842868,"body_markdown":"You can check [unbounded](https://docs.oracle.com/javase/tutorial/java/generics/unboundedWildcards.html). This is called a list of unknown type.","body":"You can check <a href=\"https://docs.oracle.com/javase/tutorial/java/generics/unboundedWildcards.html\" rel=\"nofollow noreferrer\">unbounded</a>. This is called a list of unknown type."}],"answers":[{"comments":[{"owner":{"account_id":45445,"reputation":6225,"user_id":133943,"accept_rate":100,"display_name":"Ashish Agarwal"},"score":0,"creation_date":1251548872,"post_id":1351319,"comment_id":1187485,"body_markdown":"can you please elaborate the second part of the answer it will be very helpful if you do so..","body":"can you please elaborate the second part of the answer it will be very helpful if you do so.."},{"owner":{"account_id":47283,"reputation":703927,"user_id":139985,"accept_rate":69,"display_name":"Stephen C"},"score":0,"creation_date":1251549184,"post_id":1351319,"comment_id":1187498,"body_markdown":"@akf: I don&#39;t think that the risk of exceptions is any different.  It is just that an explicit cast makes the risk a bit more obvious at the source-code level.","body":"@akf: I don&#39;t think that the risk of exceptions is any different.  It is just that an explicit cast makes the risk a bit more obvious at the source-code level."}],"tags":[],"owner":{"account_id":36166,"reputation":38849,"user_id":103043,"display_name":"akf"},"comment_count":2,"down_vote_count":0,"up_vote_count":5,"is_accepted":false,"score":5,"last_activity_date":1251550358,"creation_date":1251548581,"answer_id":1351319,"question_id":1351299,"body_markdown":"On your first question, the difference between `List` and `List&lt;?&gt;`:\r\n\r\nOne significant difference between the two is that when you have an wildcard as the type, the type of the `Collection` is unknown, so the `add` method will throw a compile time error.  \r\n\r\nYou can still get values out of the `List&lt;?&gt;`, but you need an explicit cast.\r\n\r\n","title":"What&#39;s the difference between unbounded wildcard type List&lt;?&gt; and raw type List?","body":"<p>On your first question, the difference between <code>List</code> and <code>List&lt;?&gt;</code>:</p>\n\n<p>One significant difference between the two is that when you have an wildcard as the type, the type of the <code>Collection</code> is unknown, so the <code>add</code> method will throw a compile time error.  </p>\n\n<p>You can still get values out of the <code>List&lt;?&gt;</code>, but you need an explicit cast.</p>\n"},{"comments":[{"owner":{"account_id":45445,"reputation":6225,"user_id":133943,"accept_rate":100,"display_name":"Ashish Agarwal"},"score":0,"creation_date":1251549064,"post_id":1351321,"comment_id":1187492,"body_markdown":"@List&lt;?&gt;: will the type will be defined with the insertion of 1st element??","body":"@List&lt;?&gt;: will the type will be defined with the insertion of 1st element??"},{"owner":{"account_id":37982,"reputation":65378,"user_id":108796,"accept_rate":64,"display_name":"Blindy"},"score":2,"creation_date":1251550996,"post_id":1351321,"comment_id":1187563,"body_markdown":"From what I understand, Java loses all information about generic types when you compile your program, so they all end up as `List`. There is no type inference going on there, they&#39;re all Objects.","body":"From what I understand, Java loses all information about generic types when you compile your program, so they all end up as <code>List</code>. There is no type inference going on there, they&#39;re all Objects."},{"owner":{"account_id":31908,"reputation":21538,"user_id":87979,"accept_rate":83,"display_name":"Tom"},"score":1,"creation_date":1251553059,"post_id":1351321,"comment_id":1187633,"body_markdown":"@Blindy: You are correct that there is no type inference going on and that List&lt;?&gt; basically means &quot;Any generic List&quot;. But it really has nothing to do with losing type information at runtime. What you are referring to is known as &quot;erasure&quot;.","body":"@Blindy: You are correct that there is no type inference going on and that List&lt;?&gt; basically means &quot;Any generic List&quot;. But it really has nothing to do with losing type information at runtime. What you are referring to is known as &quot;erasure&quot;."},{"owner":{"account_id":31622,"reputation":120351,"user_id":86989,"display_name":"newacct"},"score":8,"creation_date":1251571456,"post_id":1351321,"comment_id":1188293,"body_markdown":"&quot;the elements must all be the same type&quot; this distinction does not exist. the type parameter could be Object, in which case the elements can be any type","body":"&quot;the elements must all be the same type&quot; this distinction does not exist. the type parameter could be Object, in which case the elements can be any type"},{"owner":{"account_id":2113203,"reputation":9798,"user_id":1878022,"accept_rate":96,"display_name":"VedantK"},"score":1,"creation_date":1441272582,"post_id":1351321,"comment_id":52615088,"body_markdown":"List&lt;? extends E&gt; what about this?","body":"List&lt;? extends E&gt; what about this?"},{"owner":{"account_id":1691630,"reputation":49583,"user_id":1553851,"accept_rate":73,"display_name":"shmosel"},"score":0,"creation_date":1542657116,"post_id":1351321,"comment_id":93639095,"body_markdown":"@newacct A more accurate phrasing: *the elements must all be instances of some particular type*.","body":"@newacct A more accurate phrasing: <i>the elements must all be instances of some particular type</i>."},{"owner":{"account_id":535477,"reputation":1551,"user_id":904963,"accept_rate":80,"display_name":"user904963"},"score":0,"creation_date":1635890531,"post_id":1351321,"comment_id":123412600,"body_markdown":"The type `T` doesn&#39;t have to extend `E` necessarily. For example, it can be `E` itself.","body":"The type <code>T</code> doesn&#39;t have to extend <code>E</code> necessarily. For example, it can be <code>E</code> itself."}],"tags":[],"owner":{"account_id":28214,"reputation":305280,"user_id":75170,"accept_rate":72,"display_name":"John Feminella"},"comment_count":7,"down_vote_count":3,"up_vote_count":42,"is_accepted":true,"score":39,"last_activity_date":1681011495,"creation_date":1251548604,"answer_id":1351321,"question_id":1351299,"body_markdown":"Here&#39;s a summary of the three:\r\n\r\n* `List`: A list with no type parameter. It is a list whose elements are of any type -- **the elements may be of different types**.\r\n\r\n* `List&lt;?&gt;`: A list with an unbounded type parameter. Its elements are of a specific, but unknown, type; **the elements must all be instances of some specific type**.\r\n\r\n* `List&lt;T extends E&gt;`: A list with a type parameter called `T`. The supplied type for `T` must be of a type that extends `E`, or it is not a valid type for the parameter.","title":"What&#39;s the difference between unbounded wildcard type List&lt;?&gt; and raw type List?","body":"<p>Here's a summary of the three:</p>\n<ul>\n<li><p><code>List</code>: A list with no type parameter. It is a list whose elements are of any type -- <strong>the elements may be of different types</strong>.</p>\n</li>\n<li><p><code>List&lt;?&gt;</code>: A list with an unbounded type parameter. Its elements are of a specific, but unknown, type; <strong>the elements must all be instances of some specific type</strong>.</p>\n</li>\n<li><p><code>List&lt;T extends E&gt;</code>: A list with a type parameter called <code>T</code>. The supplied type for <code>T</code> must be of a type that extends <code>E</code>, or it is not a valid type for the parameter.</p>\n</li>\n</ul>\n"},{"tags":[],"owner":{"account_id":31908,"reputation":21538,"user_id":87979,"accept_rate":83,"display_name":"Tom"},"comment_count":0,"down_vote_count":0,"up_vote_count":20,"is_accepted":false,"score":20,"last_activity_date":1356852916,"creation_date":1251550809,"answer_id":1351384,"question_id":1351299,"body_markdown":"You should really look at Effective Java, Item 23: Don&#39;t use raw types in new code.\r\n\r\nTo use the example from that book, consider the following example... what if you have a collection where you do not care what types of elements are in it. For example, you want to see how many elements are in common between two sets. You might come up with the following:\r\n\r\n    public static int numElementsInCommon(Set s1, Set s2) {\r\n      int result = 0;\r\n      for (Object o : s1) {\r\n        if (s2.contains(o)) {\r\n          ++result;\r\n        }\r\n      }\r\n      return result;\r\n    }\r\n\r\nThis example, while it works, is not a good idea to use because of the use of raw types. Raw types just aren&#39;t type safe at all... you could end up modifying the set in a way that is not type safe and corrupt your program. Instead, err on the side of caution and use the type safe alternative:\r\n\r\n    public static int numElementsInCommon(Set&lt;?&gt; s1, Set&lt;?&gt; s2) {\r\n      int result = 0;\r\n      for (Object o : s1) {\r\n        if (s2.contains(o)) {\r\n          ++result;\r\n        }\r\n      }\r\n      return result;\r\n    }\r\n\r\nThe difference is that you can only add `null` to a `Set&lt;?&gt;`, and you CANNOT assume anything about the element you take out of a `Set&lt;?&gt;`. If you use a raw `Set`, you can add anything you want to it. The `numElementsInCommon` method is a good example where you don&#39;t even need to add anything and you don&#39;t need to assume anything about what is in the set. That&#39;s why it&#39;s a good candidate for using the `?` wildcard.\r\n\r\nHope this helps. Read that whole Item in Effective Java and it will really become clear.\r\n\r\nTo answer the second part of your question... remember that I said when you use the `?` wildcard, you cannot assume anything about the element you take out of the set? What if you do need to make an assumption about the interface of the object you removed from the set. For example, suppose you want to keep track of a set of `Cool` things.\r\n\r\n    public interface Cool {\r\n      // Reports why the object is cool\r\n      void cool();\r\n    }\r\n\r\nThen you might have some code like this:\r\n\r\n    public static void reportCoolness(Set s) {\r\n      for (Object item : s) {\r\n        Cool coolItem = (Cool) item;\r\n        coolItem.cool();\r\n      }\r\n    }\r\n\r\nThis is not type safe... you need to make sure you passed in a set with only `Cool` objects. To fix it, you might say:\r\n\r\n    public static void reportCoolness(Set&lt;Cool&gt; s) {\r\n      for (Cool coolItem : s) {\r\n        coolItem.cool();\r\n      }\r\n    }\r\n\r\nThis is great! Does exactly what you want and is type safe. But what if later you have this:\r\n\r\n    public interface ReallyCool extends Cool {\r\n      // Reports why the object is beyond cool\r\n      void reallyCool();\r\n    }\r\n\r\nSince all `ReallyCool` objects are `Cool`, you ought to be able to do the following:\r\n\r\n    Set&lt;ReallyCool&gt; s = new HashSet&lt;ReallyCool&gt;();\r\n    // populate s\r\n    reportCoolness(s);\r\n\r\nBut you can&#39;t do that because generics have the following property: Suppose `B` is a subclass of `A`, then `Set&lt;B&gt;` is NOT a subclass of `Set&lt;A&gt;`. The technical talk for this is &quot;Generic types are invariant.&quot; (As opposed to covariant).\r\n\r\nTo get the last example to work you would need to create a `Set&lt;Cool&gt;` by casting (safely) every element in the `Set&lt;ReallyCool&gt;`. To avoid letting clients of your api go through this nasty, unnecessary code, you can just make the `reportCoolness` method more flexible like this:\r\n\r\n    public static void reportCoolness(Set&lt;? extends Cool&gt; s) {\r\n      for (Cool coolItem : s) {\r\n        coolItem.cool();\r\n      }\r\n    }\r\n\r\nNow your method takes any `Set` that contains elements that are `Cool` or any subclass of `Cool`. All of these types adhere to the `Cool` api... so we can safely call the `cool()` method on any element\r\n\r\nMake sense? Hope this helps.","title":"What&#39;s the difference between unbounded wildcard type List&lt;?&gt; and raw type List?","body":"<p>You should really look at Effective Java, Item 23: Don't use raw types in new code.</p>\n\n<p>To use the example from that book, consider the following example... what if you have a collection where you do not care what types of elements are in it. For example, you want to see how many elements are in common between two sets. You might come up with the following:</p>\n\n<pre><code>public static int numElementsInCommon(Set s1, Set s2) {\n  int result = 0;\n  for (Object o : s1) {\n    if (s2.contains(o)) {\n      ++result;\n    }\n  }\n  return result;\n}\n</code></pre>\n\n<p>This example, while it works, is not a good idea to use because of the use of raw types. Raw types just aren't type safe at all... you could end up modifying the set in a way that is not type safe and corrupt your program. Instead, err on the side of caution and use the type safe alternative:</p>\n\n<pre><code>public static int numElementsInCommon(Set&lt;?&gt; s1, Set&lt;?&gt; s2) {\n  int result = 0;\n  for (Object o : s1) {\n    if (s2.contains(o)) {\n      ++result;\n    }\n  }\n  return result;\n}\n</code></pre>\n\n<p>The difference is that you can only add <code>null</code> to a <code>Set&lt;?&gt;</code>, and you CANNOT assume anything about the element you take out of a <code>Set&lt;?&gt;</code>. If you use a raw <code>Set</code>, you can add anything you want to it. The <code>numElementsInCommon</code> method is a good example where you don't even need to add anything and you don't need to assume anything about what is in the set. That's why it's a good candidate for using the <code>?</code> wildcard.</p>\n\n<p>Hope this helps. Read that whole Item in Effective Java and it will really become clear.</p>\n\n<p>To answer the second part of your question... remember that I said when you use the <code>?</code> wildcard, you cannot assume anything about the element you take out of the set? What if you do need to make an assumption about the interface of the object you removed from the set. For example, suppose you want to keep track of a set of <code>Cool</code> things.</p>\n\n<pre><code>public interface Cool {\n  // Reports why the object is cool\n  void cool();\n}\n</code></pre>\n\n<p>Then you might have some code like this:</p>\n\n<pre><code>public static void reportCoolness(Set s) {\n  for (Object item : s) {\n    Cool coolItem = (Cool) item;\n    coolItem.cool();\n  }\n}\n</code></pre>\n\n<p>This is not type safe... you need to make sure you passed in a set with only <code>Cool</code> objects. To fix it, you might say:</p>\n\n<pre><code>public static void reportCoolness(Set&lt;Cool&gt; s) {\n  for (Cool coolItem : s) {\n    coolItem.cool();\n  }\n}\n</code></pre>\n\n<p>This is great! Does exactly what you want and is type safe. But what if later you have this:</p>\n\n<pre><code>public interface ReallyCool extends Cool {\n  // Reports why the object is beyond cool\n  void reallyCool();\n}\n</code></pre>\n\n<p>Since all <code>ReallyCool</code> objects are <code>Cool</code>, you ought to be able to do the following:</p>\n\n<pre><code>Set&lt;ReallyCool&gt; s = new HashSet&lt;ReallyCool&gt;();\n// populate s\nreportCoolness(s);\n</code></pre>\n\n<p>But you can't do that because generics have the following property: Suppose <code>B</code> is a subclass of <code>A</code>, then <code>Set&lt;B&gt;</code> is NOT a subclass of <code>Set&lt;A&gt;</code>. The technical talk for this is \"Generic types are invariant.\" (As opposed to covariant).</p>\n\n<p>To get the last example to work you would need to create a <code>Set&lt;Cool&gt;</code> by casting (safely) every element in the <code>Set&lt;ReallyCool&gt;</code>. To avoid letting clients of your api go through this nasty, unnecessary code, you can just make the <code>reportCoolness</code> method more flexible like this:</p>\n\n<pre><code>public static void reportCoolness(Set&lt;? extends Cool&gt; s) {\n  for (Cool coolItem : s) {\n    coolItem.cool();\n  }\n}\n</code></pre>\n\n<p>Now your method takes any <code>Set</code> that contains elements that are <code>Cool</code> or any subclass of <code>Cool</code>. All of these types adhere to the <code>Cool</code> api... so we can safely call the <code>cool()</code> method on any element</p>\n\n<p>Make sense? Hope this helps.</p>\n"},{"tags":[],"owner":{"account_id":11475553,"reputation":301,"user_id":8411174,"display_name":"Maria Pomazkina-Karpikova"},"comment_count":0,"down_vote_count":0,"up_vote_count":1,"is_accepted":false,"score":1,"last_activity_date":1594868848,"creation_date":1563851009,"answer_id":57156092,"question_id":1351299,"body_markdown":"Both cases let us put into this variable any type of list:\r\n\r\n    List nothing1 = new ArrayList&lt;String&gt;();\r\n    List nothing2 = new ArrayList();\r\n    List nothing3 = new ArrayList&lt;&gt;();\r\n    List nothing4 = new ArrayList&lt;Integer&gt;();\r\n\r\n    List&lt;?&gt; wildcard1 = new ArrayList&lt;String&gt;();\r\n    List&lt;?&gt; wildcard2 = new ArrayList();\r\n    List&lt;?&gt; wildcard3 = new ArrayList&lt;&gt;();\r\n    List&lt;?&gt; wildcard4 = new ArrayList&lt;Integer&gt;();\r\n\r\nBut what elements can we put into this objects?\r\n\r\nWe can put only String into `List&lt;String&gt;`:\r\n\r\n    List&lt;String&gt; strings = new ArrayList&lt;&gt;();\r\n    strings.add(&quot;A new string&quot;);\r\n\r\nWe can put any object into List:\r\n\r\n    List nothing = new ArrayList&lt;&gt;();\r\n    nothing.add(&quot;A new string&quot;);\r\n    nothing.add(1);\r\n    nothing.add(new Object());\r\n\r\nAnd we can&#39;t add anything (but for *null*) into `List&lt;?&gt;`! Because we use generic. And Java knows that it is typed List but doesn&#39;t know what type it is exact. And doesn&#39;t let us make a mistake.\r\n\r\nConclusion: `List&lt;?&gt;`, which is generic List, **gives us type safety**.\r\n\r\nP.S. Never use raw types in your code.","title":"What&#39;s the difference between unbounded wildcard type List&lt;?&gt; and raw type List?","body":"<p>Both cases let us put into this variable any type of list:</p>\n<pre><code>List nothing1 = new ArrayList&lt;String&gt;();\nList nothing2 = new ArrayList();\nList nothing3 = new ArrayList&lt;&gt;();\nList nothing4 = new ArrayList&lt;Integer&gt;();\n\nList&lt;?&gt; wildcard1 = new ArrayList&lt;String&gt;();\nList&lt;?&gt; wildcard2 = new ArrayList();\nList&lt;?&gt; wildcard3 = new ArrayList&lt;&gt;();\nList&lt;?&gt; wildcard4 = new ArrayList&lt;Integer&gt;();\n</code></pre>\n<p>But what elements can we put into this objects?</p>\n<p>We can put only String into <code>List&lt;String&gt;</code>:</p>\n<pre><code>List&lt;String&gt; strings = new ArrayList&lt;&gt;();\nstrings.add(&quot;A new string&quot;);\n</code></pre>\n<p>We can put any object into List:</p>\n<pre><code>List nothing = new ArrayList&lt;&gt;();\nnothing.add(&quot;A new string&quot;);\nnothing.add(1);\nnothing.add(new Object());\n</code></pre>\n<p>And we can't add anything (but for <em>null</em>) into <code>List&lt;?&gt;</code>! Because we use generic. And Java knows that it is typed List but doesn't know what type it is exact. And doesn't let us make a mistake.</p>\n<p>Conclusion: <code>List&lt;?&gt;</code>, which is generic List, <strong>gives us type safety</strong>.</p>\n<p>P.S. Never use raw types in your code.</p>\n"}],"owner":{"account_id":45445,"reputation":6225,"user_id":133943,"accept_rate":100,"display_name":"Ashish Agarwal"},"comment_count":2,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":7000,"favorite_count":0,"down_vote_count":1,"up_vote_count":25,"accepted_answer_id":1351321,"answer_count":4,"score":24,"last_activity_date":1681011495,"creation_date":1251547976,"question_id":1351299,"body_markdown":"Could you help me understand the difference between *unbounded wildcard type List&lt;?&gt;* and *raw type List*?\r\n\r\n    List&lt;?&gt; b;    // unbounded wildcard type\r\n    List a;       // raw type\r\n&lt;br&gt;\r\nAlong with this can anybody help me understand what is a *bounded type parameter list*?\r\n\r\n    List&lt;E extends Number&gt; c;","title":"What&#39;s the difference between unbounded wildcard type List&lt;?&gt; and raw type List?","body":"<p>Could you help me understand the difference between <em>unbounded wildcard type List</em> and <em>raw type List</em>?</p>\n\n<pre><code>List&lt;?&gt; b;    // unbounded wildcard type\nList a;       // raw type\n</code></pre>\n\n<p><br>\nAlong with this can anybody help me understand what is a <em>bounded type parameter list</em>?</p>\n\n<pre><code>List&lt;E extends Number&gt; c;\n</code></pre>\n"},{"tags":["java","functional-programming"],"comments":[{"owner":{"account_id":71739,"reputation":307163,"user_id":207421,"accept_rate":82,"display_name":"user207421"},"score":0,"creation_date":1681278644,"post_id":75960435,"comment_id":134028697,"body_markdown":"`List.of(&quot;abc&quot;,&quot;def&quot;).forEach(System.out::println);` would be more idiomatic.","body":"<code>List.of(&quot;abc&quot;,&quot;def&quot;).forEach(System.out::println);</code> would be more idiomatic."}],"answers":[{"tags":[],"owner":{"account_id":401843,"reputation":89863,"user_id":768644,"display_name":"rzwitserloot"},"comment_count":0,"down_vote_count":0,"up_vote_count":4,"is_accepted":true,"score":4,"last_activity_date":1680887044,"creation_date":1680887044,"answer_id":75960545,"question_id":75960435,"body_markdown":"&gt; My question is do we need stream ?\r\n\r\nNot for this example. `forEach` is a unique snowflake; it&#39;s the only one that is on list directly, most other stream things (`map`, `filter`, `max`, that sort of thing) is only on stream.\r\n\r\nMore generally, `forEach` should never be used. It&#39;s strictly inferior to a normal for loop. It isn&#39;t transparent in 3 ways:\r\n\r\n* It is not control flow transparent (you cannot break/continue a loop defined outside a lambda from inside it; you also cannot return the method that contains the lambda from inside one).\r\n* It is not checked exception transparent (you cannot `throw` checked exceptions inside a lambda even if the context around the lambda catches them).\r\n* It is not mutable local variable transparent: You cannot read or write to any local variable defined outside the lambda, unless that variable is (effectively) `final`.\r\n\r\nThese are significant downsides. There are situations where all 3 are irrelevant, but there isn&#39;t an upside to lambdas either, hence, don&#39;t use `list.forEach` with a lambda.\r\n\r\n`forEach` on list itself is _only_ to be used when you have a `Consumer&lt;T&gt;` already from elsewhere, say, in a field perhaps.\r\n\r\nThe `forEach` method on streams can be used, but it doesn&#39;t make any sense unless you have applied a series of stream operations. For example, this:\r\n\r\n```\r\nlist.stream()\r\n  .filter(x -&gt; x.length() &gt; 6)\r\n  .map(String::toLowerCase()\r\n  .forEach(System.out::println)\r\n  ;\r\n```\r\n\r\nIs probably still not a good idea (just use a for loop) but it&#39;s less egregiously &quot;Must... use... shiny... new... hammer!&quot; as `list.forEach(x -&gt;...)`.\r\n\r\n&gt; In functional programming, functions can be used similar to how data is used.\r\n\r\nBit of a nebulous statement. It&#39;s generally referring to the notion that functions can be passed around like variables. You can write a function that logs how many elements are removed from a string, for example, and you want the caller to pass to this function &quot;how can I tell if an element should be removed?&quot;. Which you can do:\r\n\r\n```\r\npublic static &lt;T&gt; int removeIfCount(List&lt;T&gt; elems, Predicate&lt;T&gt; filter) {\r\n  int a = elems.size();\r\n  elems.removeIf(filter);\r\n  int b = elems.size();\r\n  return b - a;\r\n}\r\n```\r\n\r\nHere calling code could e.g. call:\r\n\r\n```java\r\nList&lt;String&gt; names = ...;\r\nint count = removeIfCount(names, x -&gt; x.length() &gt; 6);\r\n```\r\n\r\nWhich removes all names longer than 6 characters long and gives you a count of how many were removed. Here we pass the function around like data - our `removeIfCount` code just accepts the function as a `Predicate&lt;T&gt;` variable and passes it along. Exactly like how one might pass data around.\r\n","title":"Java functional programming","body":"<blockquote>\n<p>My question is do we need stream ?</p>\n</blockquote>\n<p>Not for this example. <code>forEach</code> is a unique snowflake; it's the only one that is on list directly, most other stream things (<code>map</code>, <code>filter</code>, <code>max</code>, that sort of thing) is only on stream.</p>\n<p>More generally, <code>forEach</code> should never be used. It's strictly inferior to a normal for loop. It isn't transparent in 3 ways:</p>\n<ul>\n<li>It is not control flow transparent (you cannot break/continue a loop defined outside a lambda from inside it; you also cannot return the method that contains the lambda from inside one).</li>\n<li>It is not checked exception transparent (you cannot <code>throw</code> checked exceptions inside a lambda even if the context around the lambda catches them).</li>\n<li>It is not mutable local variable transparent: You cannot read or write to any local variable defined outside the lambda, unless that variable is (effectively) <code>final</code>.</li>\n</ul>\n<p>These are significant downsides. There are situations where all 3 are irrelevant, but there isn't an upside to lambdas either, hence, don't use <code>list.forEach</code> with a lambda.</p>\n<p><code>forEach</code> on list itself is <em>only</em> to be used when you have a <code>Consumer&lt;T&gt;</code> already from elsewhere, say, in a field perhaps.</p>\n<p>The <code>forEach</code> method on streams can be used, but it doesn't make any sense unless you have applied a series of stream operations. For example, this:</p>\n<pre><code>list.stream()\n  .filter(x -&gt; x.length() &gt; 6)\n  .map(String::toLowerCase()\n  .forEach(System.out::println)\n  ;\n</code></pre>\n<p>Is probably still not a good idea (just use a for loop) but it's less egregiously &quot;Must... use... shiny... new... hammer!&quot; as <code>list.forEach(x -&gt;...)</code>.</p>\n<blockquote>\n<p>In functional programming, functions can be used similar to how data is used.</p>\n</blockquote>\n<p>Bit of a nebulous statement. It's generally referring to the notion that functions can be passed around like variables. You can write a function that logs how many elements are removed from a string, for example, and you want the caller to pass to this function &quot;how can I tell if an element should be removed?&quot;. Which you can do:</p>\n<pre><code>public static &lt;T&gt; int removeIfCount(List&lt;T&gt; elems, Predicate&lt;T&gt; filter) {\n  int a = elems.size();\n  elems.removeIf(filter);\n  int b = elems.size();\n  return b - a;\n}\n</code></pre>\n<p>Here calling code could e.g. call:</p>\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;String&gt; names = ...;\nint count = removeIfCount(names, x -&gt; x.length() &gt; 6);\n</code></pre>\n<p>Which removes all names longer than 6 characters long and gives you a count of how many were removed. Here we pass the function around like data - our <code>removeIfCount</code> code just accepts the function as a <code>Predicate&lt;T&gt;</code> variable and passes it along. Exactly like how one might pass data around.</p>\n"},{"tags":[],"owner":{"account_id":15138451,"reputation":460,"user_id":12083015,"display_name":"Erwin"},"comment_count":0,"down_vote_count":0,"up_vote_count":0,"is_accepted":false,"score":0,"last_activity_date":1681011440,"creation_date":1681010343,"answer_id":75968614,"question_id":75960435,"body_markdown":"I&#39;ll just try to explain difference between `Collections` and `Streams`, which explained [here][1]\r\n\r\n&gt; Collections and streams, while bearing some superficial similarities, have different goals. Collections are primarily concerned with the efficient management of, and access to, their elements. By contrast, streams do not provide a means to directly access or manipulate their elements, and are instead concerned with declaratively describing their source and the computational operations which will be performed in aggregate on that source.\r\n\r\nAlso if we check [here][2], it can be help to understand what is `Stream`, and why it said \r\n\r\n&gt; It was mentioned that stream() is to generate a source of objects.\r\n\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html\r\n  [2]: https://www.baeldung.com/java-8-streams#referencing","title":"Java functional programming","body":"<p>I'll just try to explain difference between <code>Collections</code> and <code>Streams</code>, which explained <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html\" rel=\"nofollow noreferrer\">here</a></p>\n<blockquote>\n<p>Collections and streams, while bearing some superficial similarities, have different goals. Collections are primarily concerned with the efficient management of, and access to, their elements. By contrast, streams do not provide a means to directly access or manipulate their elements, and are instead concerned with declaratively describing their source and the computational operations which will be performed in aggregate on that source.</p>\n</blockquote>\n<p>Also if we check <a href=\"https://www.baeldung.com/java-8-streams#referencing\" rel=\"nofollow noreferrer\">here</a>, it can be help to understand what is <code>Stream</code>, and why it said</p>\n<blockquote>\n<p>It was mentioned that stream() is to generate a source of objects.</p>\n</blockquote>\n"}],"owner":{"account_id":25795866,"reputation":167,"user_id":19539055,"display_name":"Theju112"},"comment_count":1,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":90,"favorite_count":0,"down_vote_count":1,"up_vote_count":1,"accepted_answer_id":75960545,"answer_count":2,"score":0,"last_activity_date":1681011440,"creation_date":1680886321,"question_id":75960435,"body_markdown":"In a beginner course about Functional programming in Java, I saw examples such as below:\r\n\r\n    List.of(&quot;abc&quot;,&quot;def&quot;).stream().forEach(element -&gt; System.out.println(element));\r\n\r\nThis is the most basic example. In all the other examples, the pattern is almost the same where the stream() function is used. It was mentioned that stream() is to generate a source of objects.\r\n\r\nMy question is do we need stream ?\r\n\r\nCant it be ? :\r\n\r\n    List.of(&quot;abc&quot;,&quot;def&quot;).forEach(element -&gt; System.out.println(element));\r\n\r\nThe other thing I need help to understand is the statement: &quot;In functional programming, functions can be used similar to how data is used.&quot;\r\n\r\nIn the above example, what does that mean?\r\n\r\nDoes it refer to how the section, `element -&gt; System.out.println(element)` is being used in a way similar to data?","title":"Java functional programming","body":"<p>In a beginner course about Functional programming in Java, I saw examples such as below:</p>\n<pre><code>List.of(&quot;abc&quot;,&quot;def&quot;).stream().forEach(element -&gt; System.out.println(element));\n</code></pre>\n<p>This is the most basic example. In all the other examples, the pattern is almost the same where the stream() function is used. It was mentioned that stream() is to generate a source of objects.</p>\n<p>My question is do we need stream ?</p>\n<p>Cant it be ? :</p>\n<pre><code>List.of(&quot;abc&quot;,&quot;def&quot;).forEach(element -&gt; System.out.println(element));\n</code></pre>\n<p>The other thing I need help to understand is the statement: &quot;In functional programming, functions can be used similar to how data is used.&quot;</p>\n<p>In the above example, what does that mean?</p>\n<p>Does it refer to how the section, <code>element -&gt; System.out.println(element)</code> is being used in a way similar to data?</p>\n"},{"tags":["java","selenium-webdriver","selenium-chromedriver"],"comments":[{"owner":{"account_id":2772450,"reputation":22416,"user_id":2386774,"display_name":"JeffC"},"score":1,"creation_date":1680928689,"post_id":75961794,"comment_id":133981080,"body_markdown":"We can&#39;t help you with a locator without the HTML of the element you are trying to click. Edit the question and post the relevant HTML as text, properly formatted and we will try to help you.","body":"We can&#39;t help you with a locator without the HTML of the element you are trying to click. Edit the question and post the relevant HTML as text, properly formatted and we will try to help you."},{"owner":{"account_id":25265391,"reputation":39,"user_id":19095666,"display_name":"Narj"},"score":0,"creation_date":1680956334,"post_id":75961794,"comment_id":133983786,"body_markdown":"You are right, sorry.","body":"You are right, sorry."},{"owner":{"account_id":25265391,"reputation":39,"user_id":19095666,"display_name":"Narj"},"score":0,"creation_date":1681007488,"post_id":75961794,"comment_id":133989455,"body_markdown":"Why is this such a hard task? \nWhen I&#39;m searching the internet for answers, none of the solutions are working. Has the two sites put something on to make it harder for selenium to work?","body":"Why is this such a hard task?  When I&#39;m searching the internet for answers, none of the solutions are working. Has the two sites put something on to make it harder for selenium to work?"}],"answers":[{"comments":[{"owner":{"account_id":25265391,"reputation":39,"user_id":19095666,"display_name":"Narj"},"score":0,"creation_date":1681014508,"post_id":75968637,"comment_id":133989875,"body_markdown":"Ahh TY - I did try to put in some sleep and/or wait, but it didn&#39;t help I can see you also changed it to .elementToBeClickable and it is working perfecktly on instagram!\n\nNow I&#39;m just wondering why the same approach can&#39;t be used on Facebook? Do you know the technical reason for this, thanks in advance.","body":"Ahh TY - I did try to put in some sleep and/or wait, but it didn&#39;t help I can see you also changed it to .elementToBeClickable and it is working perfecktly on instagram!  Now I&#39;m just wondering why the same approach can&#39;t be used on Facebook? Do you know the technical reason for this, thanks in advance."}],"tags":[],"owner":{"account_id":2772450,"reputation":22416,"user_id":2386774,"display_name":"JeffC"},"comment_count":1,"down_vote_count":0,"up_vote_count":0,"is_accepted":true,"score":0,"last_activity_date":1681010842,"creation_date":1681010842,"answer_id":75968637,"question_id":75961794,"body_markdown":"For Instagram, you need a wait before clicking the SVG because it takes the page a moment to load. Here&#39;s working code.\r\n\r\n    WebDriver driver = new ChromeDriver();\r\n    driver.manage().window().maximize();\r\n    driver.get(&quot;https://www.instagram.com/twitter/&quot;);\r\n    WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));\r\n    wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector(&quot;svg[aria-label=&#39;Search&#39;]&quot;))).click();\r\n    driver.findElement(By.cssSelector(&quot;input[aria-label=&#39;Search input&#39;]&quot;)).sendKeys(&quot;Test\\n&quot;);\r\n\r\n    driver.quit();\r\n\r\n","title":"I can&#39;t get selenium (java) to click the search bar in neither facebook or instagram","body":"<p>For Instagram, you need a wait before clicking the SVG because it takes the page a moment to load. Here's working code.</p>\n<pre><code>WebDriver driver = new ChromeDriver();\ndriver.manage().window().maximize();\ndriver.get(&quot;https://www.instagram.com/twitter/&quot;);\nWebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));\nwait.until(ExpectedConditions.elementToBeClickable(By.cssSelector(&quot;svg[aria-label='Search']&quot;))).click();\ndriver.findElement(By.cssSelector(&quot;input[aria-label='Search input']&quot;)).sendKeys(&quot;Test\\n&quot;);\n\ndriver.quit();\n</code></pre>\n"}],"owner":{"account_id":25265391,"reputation":39,"user_id":19095666,"display_name":"Narj"},"comment_count":3,"delete_vote_count":0,"reopen_vote_count":0,"close_vote_count":0,"is_answered":true,"view_count":157,"favorite_count":0,"down_vote_count":1,"up_vote_count":0,"accepted_answer_id":75968637,"answer_count":1,"score":-1,"last_activity_date":1681010842,"creation_date":1680900178,"question_id":75961794,"body_markdown":"I&#39;m fooling around with selenium to try to make my account search for a specific hashtag, but I&#39;m stuck on why I can&#39;t get it to push the search button.\r\n\r\ninstagram&#39;s buttons seems to be made with SVG, and this makes it harder for me to get it to work and with facebook it is just not accepting my approach, which is working with the login.\r\n\r\nHere is my example with instagram at the moment.\r\n\r\n    // Find the SVG element using XPath\r\n    WebElement svgElement = driver.findElement(By.xpath(&quot;//svg[@aria-label=&#39;Search&#39;]&quot;));\r\n\r\n    // Create an instance of the Actions class\r\n    Actions actions = new Actions(driver);\r\n\r\n    // Move to the SVG element and click it\r\n    actions.moveToElement(svgElement).click().build().perform();\r\n\r\nI have also tried this:\r\n\r\n    // Find the SVG element using XPath\r\n    WebElement search = driver.findElement(By.xpath(&quot;//*[local-name()=&#39;svg&#39; and @aria-label=&#39;Search&#39;]/*[localname()=&#39;path&#39;]&quot;));\r\n    // clicking on SVG element\r\n    Actions actions = new Actions(driver);\r\n    actions.moveToElement(search).click().build().perform();\r\n\r\nHere is the source for instagram:\r\n\r\n    &lt;div class=&quot;x9f619 x3nfvp2 xr9ek0c xjpr12u xo237n4 x6pnmvc x7nr27j x12dmmrz xz9dl7a xn6708d xsag5q8 x1ye3gou x1l895ks x159b3zp xdoji71 x1dejxi8 x9k3k5o xs3sg5q x11hdxyr x12ldp4w x1wj20lx x1dn74xm xif99yt x172qv1o x10djquj x1lhsz42 xzauu7c x1z11no5 xjy5m1g x1mnwbp6 x4pb5v6&quot;&gt;\r\n      &lt;div&gt;\r\n        &lt;div class=&quot;x9f619 xjbqb8w x78zum5 x168nmei x13lgxp2 x5pf9jr xo71vjh x1n2onr6 x1plvlek xryxfnj x1c4vz4f x2lah0s xdt5ytf xqjyukv x1qjc9v5 x1oa3qoh x1nhvcw1&quot;&gt;\r\n          &lt;div class=&quot;x9f619 xxk0z11 xvy4d1p x11xpdln xii2z7h x19c4wfv&quot;&gt;\r\n            &lt;svg aria-label=&quot;Search&quot; class=&quot;_ab6-&quot; color=&quot;rgb(245, 245, 245)&quot; fill=&quot;rgb(245, 245, 245)&quot; height=&quot;24&quot; role=&quot;img&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;24&quot;&gt;\r\n              &lt;path d=&quot;M19 10.5A8.5 8.5 0 1 1 10.5 2a8.5 8.5 0 0 1 8.5 8.5Z&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; stroke-width=&quot;2&quot;&gt;&lt;/path&gt;\r\n              &lt;line fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-linecap=&quot;round&quot; stroke- linejoin=&quot;round&quot; stroke-width=&quot;2&quot; x1=&quot;16.511&quot; x2=&quot;22&quot; y1=&quot;16.511&quot; y2=&quot;22&quot;&gt;&lt;/line&gt;\r\n            &lt;/svg&gt;\r\n          &lt;/div&gt;\r\n        &lt;/div&gt;\r\n      &lt;/div&gt;\r\n      &lt;div class=&quot;x6s0dn4 x9f619 xxk0z11 x6ikm8r xeq5yr9 x1s85apg x1swvt13 xzzcqpx&quot; style=&quot;opacity: 1;&quot;&gt;\r\n        &lt;div style=&quot;width: 100%;&quot;&gt;\r\n          &lt;div class=&quot;_aacl _aacp _aacu _aacx _aada&quot;&gt;Search&lt;/div&gt;\r\n        &lt;/div&gt;\r\n      &lt;/div&gt;\r\n    &lt;/div&gt;\r\n\r\nHere is my current code for facebook:\r\n\r\n    WebElement searchbar = wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(&quot;//input[@dir=&#39;ltr&#39;]&quot;)));\r\n    searchbar.click();\r\n    searchbar.sendKeys(&quot;hello&quot;);\r\n\r\nHere is the sourcecode from facebook:\r\n\r\n    &lt;input dir=&quot;ltr&quot; aria-autocomplete=&quot;list&quot; aria-expanded=&quot;true&quot; aria-label=&quot;S&#248;g p&#229; Facebook&quot; role=&quot;combobox&quot; placeholder=&quot;S&#248;g p&#229; Facebook&quot; autocomplete=&quot;off&quot; spellcheck=&quot;false&quot; aria-invalid=&quot;false&quot; class=&quot;x1i10hfl xggy1nq x1s07b3s x1kdt53j x1yc453h xhb22t3 xb5gni xcj1dhv x2s2ed0 xq33zhf xjyslct xjbqb8w x6umtig x1b1mbwd xaqea5y xav7gou xnwf7zb x40j3uw x1s7lred x15gyhx8 x9f619 xzsf02u xdl72j9 x1iyjqo2 xs83m0k xjb2p0i x6prxxf xeuugli x1a2a7pz x1n2onr6 x15h3p50 xm7lytj x1sxyh0 xdvlbce xurb0ha x1vqgdyp xo6swyp x1ad04t7 x1glnyev x1ix68h3 x19gujb8&quot; type=&quot;search&quot; value=&quot;&quot; aria-controls=&quot;jsc_c_2t&quot;&gt;","title":"I can&#39;t get selenium (java) to click the search bar in neither facebook or instagram","body":"<p>I'm fooling around with selenium to try to make my account search for a specific hashtag, but I'm stuck on why I can't get it to push the search button.</p>\n<p>instagram's buttons seems to be made with SVG, and this makes it harder for me to get it to work and with facebook it is just not accepting my approach, which is working with the login.</p>\n<p>Here is my example with instagram at the moment.</p>\n<pre><code>// Find the SVG element using XPath\nWebElement svgElement = driver.findElement(By.xpath(&quot;//svg[@aria-label='Search']&quot;));\n\n// Create an instance of the Actions class\nActions actions = new Actions(driver);\n\n// Move to the SVG element and click it\nactions.moveToElement(svgElement).click().build().perform();\n</code></pre>\n<p>I have also tried this:</p>\n<pre><code>// Find the SVG element using XPath\nWebElement search = driver.findElement(By.xpath(&quot;//*[local-name()='svg' and @aria-label='Search']/*[localname()='path']&quot;));\n// clicking on SVG element\nActions actions = new Actions(driver);\nactions.moveToElement(search).click().build().perform();\n</code></pre>\n<p>Here is the source for instagram:</p>\n<pre><code>&lt;div class=&quot;x9f619 x3nfvp2 xr9ek0c xjpr12u xo237n4 x6pnmvc x7nr27j x12dmmrz xz9dl7a xn6708d xsag5q8 x1ye3gou x1l895ks x159b3zp xdoji71 x1dejxi8 x9k3k5o xs3sg5q x11hdxyr x12ldp4w x1wj20lx x1dn74xm xif99yt x172qv1o x10djquj x1lhsz42 xzauu7c x1z11no5 xjy5m1g x1mnwbp6 x4pb5v6&quot;&gt;\n  &lt;div&gt;\n    &lt;div class=&quot;x9f619 xjbqb8w x78zum5 x168nmei x13lgxp2 x5pf9jr xo71vjh x1n2onr6 x1plvlek xryxfnj x1c4vz4f x2lah0s xdt5ytf xqjyukv x1qjc9v5 x1oa3qoh x1nhvcw1&quot;&gt;\n      &lt;div class=&quot;x9f619 xxk0z11 xvy4d1p x11xpdln xii2z7h x19c4wfv&quot;&gt;\n        &lt;svg aria-label=&quot;Search&quot; class=&quot;_ab6-&quot; color=&quot;rgb(245, 245, 245)&quot; fill=&quot;rgb(245, 245, 245)&quot; height=&quot;24&quot; role=&quot;img&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;24&quot;&gt;\n          &lt;path d=&quot;M19 10.5A8.5 8.5 0 1 1 10.5 2a8.5 8.5 0 0 1 8.5 8.5Z&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; stroke-width=&quot;2&quot;&gt;&lt;/path&gt;\n          &lt;line fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-linecap=&quot;round&quot; stroke- linejoin=&quot;round&quot; stroke-width=&quot;2&quot; x1=&quot;16.511&quot; x2=&quot;22&quot; y1=&quot;16.511&quot; y2=&quot;22&quot;&gt;&lt;/line&gt;\n        &lt;/svg&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=&quot;x6s0dn4 x9f619 xxk0z11 x6ikm8r xeq5yr9 x1s85apg x1swvt13 xzzcqpx&quot; style=&quot;opacity: 1;&quot;&gt;\n    &lt;div style=&quot;width: 100%;&quot;&gt;\n      &lt;div class=&quot;_aacl _aacp _aacu _aacx _aada&quot;&gt;Search&lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n<p>Here is my current code for facebook:</p>\n<pre><code>WebElement searchbar = wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(&quot;//input[@dir='ltr']&quot;)));\nsearchbar.click();\nsearchbar.sendKeys(&quot;hello&quot;);\n</code></pre>\n<p>Here is the sourcecode from facebook:</p>\n<pre><code>&lt;input dir=&quot;ltr&quot; aria-autocomplete=&quot;list&quot; aria-expanded=&quot;true&quot; aria-label=&quot;Søg på Facebook&quot; role=&quot;combobox&quot; placeholder=&quot;Søg på Facebook&quot; autocomplete=&quot;off&quot; spellcheck=&quot;false&quot; aria-invalid=&quot;false&quot; class=&quot;x1i10hfl xggy1nq x1s07b3s x1kdt53j x1yc453h xhb22t3 xb5gni xcj1dhv x2s2ed0 xq33zhf xjyslct xjbqb8w x6umtig x1b1mbwd xaqea5y xav7gou xnwf7zb x40j3uw x1s7lred x15gyhx8 x9f619 xzsf02u xdl72j9 x1iyjqo2 xs83m0k xjb2p0i x6prxxf xeuugli x1a2a7pz x1n2onr6 x15h3p50 xm7lytj x1sxyh0 xdvlbce xurb0ha x1vqgdyp xo6swyp x1ad04t7 x1glnyev x1ix68h3 x19gujb8&quot; type=&quot;search&quot; value=&quot;&quot; aria-controls=&quot;jsc_c_2t&quot;&gt;\n</code></pre>\n"}],"has_more":true,"quota_max":10000,"quota_remaining":9711,"page":514,"page_size":100}
